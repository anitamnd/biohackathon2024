<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.2 20190208//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.2?>
<?ConverterInfo.XSLTName jats2jats3.xsl?>
<?ConverterInfo.Version 1?>
<?properties open_access?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Genetics</journal-id>
    <journal-id journal-id-type="iso-abbrev">Genetics</journal-id>
    <journal-id journal-id-type="publisher-id">genetics</journal-id>
    <journal-title-group>
      <journal-title>Genetics</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">0016-6731</issn>
    <issn pub-type="epub">1943-2631</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">9630982</article-id>
    <article-id pub-id-type="pmid">36173327</article-id>
    <article-id pub-id-type="doi">10.1093/genetics/iyac131</article-id>
    <article-id pub-id-type="publisher-id">iyac131</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Investigation</subject>
        <subj-group subj-group-type="category-toc-heading">
          <subject>Computational Resources, Software, &amp; Databases</subject>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="category-oup-series">
        <subject>Featured</subject>
      </subj-group>
      <subj-group subj-group-type="category-taxonomy-collection">
        <subject>AcademicSubjects/SCI01180</subject>
        <subject>AcademicSubjects/SCI01140</subject>
        <subject>AcademicSubjects/SCI00010</subject>
        <subject>AcademicSubjects/SCI00960</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Demes: a standard format for demographic models</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0002-6197-3872</contrib-id>
        <name>
          <surname>Gower</surname>
          <given-names>Graham</given-names>
        </name>
        <aff><institution>Section for Molecular Ecology and Evolution, Globe Institute, University of Copenhagen</institution>, 1350 Copenhagen K, <country country="DK">Denmark</country></aff>
        <xref rid="iyac131-FM1" ref-type="author-notes"/>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0003-0715-3432</contrib-id>
        <name>
          <surname>Ragsdale</surname>
          <given-names>Aaron P</given-names>
        </name>
        <aff><institution>Department of Integrative Biology, University of Wisconsin–Madison</institution>, Madison, WI 53706, <country country="US">USA</country></aff>
        <xref rid="iyac131-FM1" ref-type="author-notes"/>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0001-8327-0142</contrib-id>
        <name>
          <surname>Bisschop</surname>
          <given-names>Gertjan</given-names>
        </name>
        <aff><institution>Institute of Ecology and Evolution, The University of Edinburgh</institution>, Edinburgh EH9 3FL, <country country="GB">UK</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0002-8659-0579</contrib-id>
        <name>
          <surname>Gutenkunst</surname>
          <given-names>Ryan N</given-names>
        </name>
        <aff><institution>Department of Molecular and Cellular Biology, University of Arizona</institution>, Tucson, AZ 85721, <country country="US">USA</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0001-6941-0647</contrib-id>
        <name>
          <surname>Hartfield</surname>
          <given-names>Matthew</given-names>
        </name>
        <aff><institution>Institute of Ecology and Evolution, The University of Edinburgh</institution>, Edinburgh EH9 3FL, <country country="GB">UK</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0003-1168-0497</contrib-id>
        <name>
          <surname>Noskova</surname>
          <given-names>Ekaterina</given-names>
        </name>
        <aff><institution>Computer Technologies Laboratory, ITMO University</institution>, 197101 Saint-Petersburg, <country country="RU">Russia</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0002-1017-9150</contrib-id>
        <name>
          <surname>Schiffels</surname>
          <given-names>Stephan</given-names>
        </name>
        <aff><institution>Max Planck Institute for Evolutionary Anthropology</institution>, 04103 Leipzig, <country country="DE">Germany</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0001-7161-5107</contrib-id>
        <name>
          <surname>Struck</surname>
          <given-names>Travis J</given-names>
        </name>
        <aff><institution>Department of Molecular and Cellular Biology, University of Arizona</institution>, Tucson, AZ 85721, <country country="US">USA</country></aff>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0002-7894-5253</contrib-id>
        <name>
          <surname>Kelleher</surname>
          <given-names>Jerome</given-names>
        </name>
        <aff><institution>Big Data Institute, Li Ka Shing Centre for Health Information and Discovery, University of Oxford</institution>, Oxford OX3 7LF, <country country="GB">UK</country></aff>
        <xref rid="iyac131-cor1" ref-type="corresp"/>
        <xref rid="iyac131-FM2" ref-type="author-notes"/>
        <!--jerome.kelleher@bdi.ox.ac.uk-->
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0003-0743-4445</contrib-id>
        <name>
          <surname>Thornton</surname>
          <given-names>Kevin R</given-names>
        </name>
        <aff><institution>Department of Ecology and Evolutionary Biology, University of California</institution>, Irvine, CA 92697, <country country="US">USA</country></aff>
        <xref rid="iyac131-FM2" ref-type="author-notes"/>
      </contrib>
    </contrib-group>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Coop</surname>
          <given-names>G</given-names>
        </name>
        <role>Editor</role>
      </contrib>
    </contrib-group>
    <author-notes>
      <corresp id="iyac131-cor1">Corresponding author: Big Data Institute, Li Ka Shing Centre for Health Information and Discovery, University of Oxford, Oxford OX3 7LF, UK. Email: <email>jerome.kelleher@bdi.ox.ac.uk</email></corresp>
      <fn id="iyac131-FM1">
        <label>†</label>
        <p>Graham Gower and Aaron P. Ragsdale contributed equally to this work, as joint first authors.</p>
      </fn>
      <fn id="iyac131-FM2">
        <label>‡</label>
        <p>Jerome Kelleher and Kevin R. Thornton contributed equally to this work, as joint last authors.</p>
      </fn>
    </author-notes>
    <pub-date pub-type="collection">
      <month>11</month>
      <year>2022</year>
    </pub-date>
    <pub-date pub-type="epub" iso-8601-date="2022-09-29">
      <day>29</day>
      <month>9</month>
      <year>2022</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>29</day>
      <month>9</month>
      <year>2022</year>
    </pub-date>
    <volume>222</volume>
    <issue>3</issue>
    <elocation-id>iyac131</elocation-id>
    <history>
      <date date-type="received">
        <day>13</day>
        <month>6</month>
        <year>2022</year>
      </date>
      <date date-type="accepted">
        <day>23</day>
        <month>8</month>
        <year>2022</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2022. Published by Oxford University Press on behalf of Genetics Society of America.</copyright-statement>
      <copyright-year>2022</copyright-year>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">https://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted reuse, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <self-uri xlink:href="iyac131.pdf"/>
    <abstract>
      <title>Abstract</title>
      <p>Understanding the demographic history of populations is a key goal in population genetics, and with improving methods and data, ever more complex models are being proposed and tested. Demographic models of current interest typically consist of a set of discrete populations, their sizes and growth rates, and continuous and pulse migrations between those populations over a number of epochs, which can require dozens of parameters to fully describe. There is currently no standard format to define such models, significantly hampering progress in the field. In particular, the important task of translating the model descriptions in published work into input suitable for population genetic simulators is labor intensive and error prone. We propose the Demes data model and file format, built on widely used technologies, to alleviate these issues. Demes provide a well-defined and unambiguous model of populations and their properties that is straightforward to implement in software, and a text file format that is designed for simplicity and clarity. We provide thoroughly tested implementations of Demes parsers in multiple languages including Python and C, and showcase initial support in several simulators and inference methods. An introduction to the file format and a detailed specification are available at <ext-link xlink:href="https://popsim-consortium.github.io/demes-spec-docs/" ext-link-type="uri">https://popsim-consortium.github.io/demes-spec-docs/</ext-link>.</p>
    </abstract>
    <abstract abstract-type="teaser">
      <p>Demographic models of increasing complexity are being inferred and simulated, yet there is no agreed-upon data format for describing these models. Gower, Ragsdale <italic toggle="yes">et al</italic>. present the Demes specification, a data model and file format definition built on standard technologies which provides a description of complex demographics that is both human-readable and machine-parsable. They provide thoroughly tested software components using this specification and demonstrate Demes support in several popular simulation and inference methods.</p>
    </abstract>
    <kwd-group>
      <kwd>demographic models</kwd>
      <kwd>inference</kwd>
      <kwd>simulation</kwd>
    </kwd-group>
    <funding-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>Villum Fonden Young Investigator award to Fernando Racimo</institution>
          </institution-wrap>
        </funding-source>
        <award-id>00025300</award-id>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>National Institute of General Medical Sciences of the National Institutes of Health</institution>
          </institution-wrap>
        </funding-source>
        <award-id>R01GM127348</award-id>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>Natural Environment Research Council Independent Research Fellowship</institution>
          </institution-wrap>
        </funding-source>
        <award-id>NE/R015686/1</award-id>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>Robertson Foundation</institution>
            <institution-id institution-id-type="DOI">10.13039/100013961</institution-id>
          </institution-wrap>
        </funding-source>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>European Research Council under the European Union’s Horizon 2020 research and innovation program</institution>
          </institution-wrap>
        </funding-source>
        <award-id>851511</award-id>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>European Research Council (ModelGenomLand</institution>
          </institution-wrap>
        </funding-source>
        <award-id>757648</award-id>
      </award-group>
    </funding-group>
    <counts>
      <page-count count="9"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec sec-type="intro">
    <title>Introduction</title>
    <p>The ever-increasing amount of genetic sequencing data from genetically and geographically diverse species and populations has allowed us to infer complex demography and study life history at fine scales. An integral component to such population genetics studies is simulation. Software to either simulate whole-genome sequences (<xref rid="iyac131-B59" ref-type="bibr">Thornton 2014</xref>, <xref rid="iyac131-B60" ref-type="bibr">2019</xref>; <xref rid="iyac131-B56" ref-type="bibr">Staab <italic toggle="yes">et al.</italic> 2015</xref>; <xref rid="iyac131-B36" ref-type="bibr">Kelleher <italic toggle="yes">et al.</italic> 2016</xref>; <xref rid="iyac131-B27" ref-type="bibr">Haller and Messer 2019</xref>; <xref rid="iyac131-B8" ref-type="bibr">Baumdicker <italic toggle="yes">et al.</italic> 2022</xref>) or informative summary statistics of diversity (<xref rid="iyac131-B26" ref-type="bibr">Gutenkunst <italic toggle="yes">et al.</italic> 2009</xref>; <xref rid="iyac131-B34" ref-type="bibr">Jouganous <italic toggle="yes">et al.</italic> 2017</xref>; <xref rid="iyac131-B35" ref-type="bibr">Kamm <italic toggle="yes">et al.</italic> 2017</xref>) have enabled the increasing complexity of genomic studies, with several software packages capable of handling large sample sizes, many interacting populations, and deviations from panmictic random-mating assumptions. This ability to infer and simulate such complex demographic scenarios, however, has highlighted a major shortcoming in community standards: the fragmented landscape of different ways to describe demographic models makes it difficult to compare inferences made by different methods and to reliably simulate from previously inferred models. Inference results are typically reported in publications via a combination of visual depiction, a list of key parameters in tabular form and a discussion within the text. Unfortunately, these descriptions are often ambiguous, and implementing the precise model inferred for later simulation is at best tedious and error prone (<xref rid="iyac131-B1" ref-type="bibr">Adrion <italic toggle="yes">et al.</italic> 2020</xref>; <xref rid="iyac131-B50" ref-type="bibr">Ragsdale <italic toggle="yes">et al.</italic> 2020</xref>), and occasionally impossible because of missing information.</p>
    <p>Simulation is a core tool in population genetics, and many methods have been developed over the past 3 decades (<xref rid="iyac131-B15" ref-type="bibr">Carvajal-Rodríguez 2008</xref>; <xref rid="iyac131-B42" ref-type="bibr">Liu <italic toggle="yes">et al.</italic> 2008</xref>; <xref rid="iyac131-B3" ref-type="bibr">Arenas 2012</xref>; <xref rid="iyac131-B31" ref-type="bibr">Hoban <italic toggle="yes">et al.</italic> 2012</xref>; <xref rid="iyac131-B64" ref-type="bibr">Yuan <italic toggle="yes">et al.</italic> 2012</xref>). Simulations are based on highly idealized population models, and one of the key uses of inferred demographic histories is to make simulations more realistic. Simulation methods take three broad approaches to specifying the demographic model to simulate, using either a command line interface (e.g. <xref rid="iyac131-B33" ref-type="bibr">Hudson 2002</xref>; <xref rid="iyac131-B29" ref-type="bibr">Hernandez 2008</xref>; <xref rid="iyac131-B38" ref-type="bibr">Kern and Schrider 2016</xref>), a custom input file format (e.g. <xref rid="iyac131-B25" ref-type="bibr">Guillaume and Rougemont 2006</xref>; <xref rid="iyac131-B20" ref-type="bibr">Excoffier and Foll 2011</xref>; <xref rid="iyac131-B55" ref-type="bibr">Shlyakhter <italic toggle="yes">et al.</italic> 2014</xref>), or an Application Programming Interface (API) to allow models to be defined programmatically (e.g. <xref rid="iyac131-B59" ref-type="bibr">Thornton 2014</xref>; <xref rid="iyac131-B30" ref-type="bibr">Hernandez and Uricchio 2015</xref>; <xref rid="iyac131-B36" ref-type="bibr">Kelleher <italic toggle="yes">et al.</italic> 2016</xref>; <xref rid="iyac131-B10" ref-type="bibr">Becheler <italic toggle="yes">et al.</italic> 2019</xref>; <xref rid="iyac131-B27" ref-type="bibr">Haller and Messer 2019</xref>; <xref rid="iyac131-B60" ref-type="bibr">Thornton 2019</xref>; <xref rid="iyac131-B8" ref-type="bibr">Baumdicker <italic toggle="yes">et al.</italic> 2022</xref>). Command line interfaces are a concise way of expressing demographic models, and the syntax defined by <monospace>ms</monospace> (<xref rid="iyac131-B33" ref-type="bibr">Hudson 2002</xref>) is used by several simulators (e.g. <xref rid="iyac131-B16" ref-type="bibr">Chen <italic toggle="yes">et al.</italic> 2009</xref>; <xref rid="iyac131-B19" ref-type="bibr">Ewing and Hermisson 2010</xref>; <xref rid="iyac131-B56" ref-type="bibr">Staab <italic toggle="yes">et al.</italic> 2015</xref>). However, this conciseness means that models of even intermediate complexity are difficult for humans to understand, making errors likely. APIs are more verbose, but require a substantial time investment to learn, and as they are tied to a specific tool this knowledge is not portable to other simulators. Like APIs, input parameter file formats for simulators allow the model specification to be less terse and allow for documentation in the form of comments. Several graphical user interfaces and visualization methods have been developed, which greatly facilitate interpretation (<xref rid="iyac131-B43" ref-type="bibr">Mailund <italic toggle="yes">et al.</italic> 2005</xref>; <xref rid="iyac131-B2" ref-type="bibr">Antao <italic toggle="yes">et al.</italic> 2007</xref>; <xref rid="iyac131-B48" ref-type="bibr">Parreira <italic toggle="yes">et al.</italic> 2009</xref>; <xref rid="iyac131-B19" ref-type="bibr">Ewing and Hermisson 2010</xref>; <xref rid="iyac131-B47" ref-type="bibr">Parobek <italic toggle="yes">et al.</italic> 2017</xref>; <xref rid="iyac131-B65" ref-type="bibr">Zhou <italic toggle="yes">et al.</italic> 2018</xref>). However, these methods currently have little traction as they are all either directly coupled to an internal simulation method or to the syntax of a specific simulator. There is currently no way in which demographic models inferred by different packages can be simulated or visualized by downstream software.</p>
    <p>Here, we present “Demes,” a data model and file format specification for complex demographic models developed by the PopSim Consortium (<xref rid="iyac131-B1" ref-type="bibr">Adrion <italic toggle="yes">et al.</italic> 2020</xref>). The Demes data model precisely defines the sizes and relationships of populations, and it provides a way to explicitly encode the information relevant to demography while avoiding repetition. This data model is implemented in the widely used YAML format (<xref rid="iyac131-B11" ref-type="bibr">Ben-Kiki <italic toggle="yes">et al.</italic> 2009</xref>), which is a data serialization language that provides a good balance between human and machine readability. The specification precisely defines the required behavior of implementations, ensuring that there is no ambiguity of interpretation, and includes both a reference implementation and an extensive suite of test examples and their expected output. The initial software ecosystem includes high-quality Python and C parser implementations, as well as utilities for verification and visualization of Demes models, and has been implemented in several popular inference and simulation methods (<xref rid="iyac131-T1" ref-type="table">Table 1</xref>). We hope that this data model and file format will be widely adopted by the community, such that users can expect to simulate directly from inferred models with little to no programming effort.</p>
    <table-wrap position="float" id="iyac131-T1">
      <label>Table 1.</label>
      <caption>
        <p>Software support for Demes.</p>
      </caption>
      <table frame="hsides" rules="groups">
        <colgroup span="1">
          <col valign="top" align="left" span="1"/>
          <col valign="top" align="left" span="1"/>
        </colgroup>
        <thead>
          <tr>
            <th colspan="2" rowspan="1">Software infrastructure</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td rowspan="1" colspan="1">
              <monospace> </monospace>
              <monospace>demes-python</monospace>
            </td>
            <td rowspan="1" colspan="1">A Python library for loading, saving, and working with Demes models. Includes support for converting to and from <monospace>ms</monospace> (<xref rid="iyac131-B33" ref-type="bibr">Hudson 2002</xref>; <ext-link xlink:href="https://github.com/popsim-consortium/demes-python" ext-link-type="uri">https://github.com/popsim-consortium/demes-python</ext-link>).</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">
              <monospace> </monospace>
              <monospace>demes-c</monospace>
            </td>
            <td rowspan="1" colspan="1">A C library for parsing Demes YAML descriptions (<ext-link xlink:href="https://github.com/grahamgower/demes-c" ext-link-type="uri">https://github.com/grahamgower/demes-c</ext-link>).</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">
              <monospace> </monospace>
              <monospace>demes-rust</monospace>
            </td>
            <td rowspan="1" colspan="1">A Demes parser in Rust (<ext-link xlink:href="https://github.com/molpopgen/demes-rs" ext-link-type="uri">https://github.com/molpopgen/demes-rs</ext-link>).</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">
              <monospace> </monospace>
              <monospace>demes-julia</monospace>
            </td>
            <td rowspan="1" colspan="1">A parser in Julia (<ext-link xlink:href="https://github.com/apragsdale/Demes.jl" ext-link-type="uri">https://github.com/apragsdale/Demes.jl</ext-link>).</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">
              <monospace> </monospace>
              <monospace>demesdraw</monospace>
            </td>
            <td rowspan="1" colspan="1">A Python library for visualizing Demes models (<ext-link xlink:href="https://github.com/grahamgower/demesdraw" ext-link-type="uri">https://github.com/grahamgower/demesdraw</ext-link>).</td>
          </tr>
          <tr>
            <td colspan="2" rowspan="1">Methods using Demes as input/output format</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">
              <monospace> </monospace>
              <monospace>dadi</monospace>
            </td>
            <td rowspan="1" colspan="1">Optimizes parameters in models of demographic history and distributions of fitness effects using SFS (<xref rid="iyac131-B26" ref-type="bibr">Gutenkunst <italic toggle="yes">et al.</italic> 2009</xref>). Can simulate SFS from Demes models.</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">
              <monospace> </monospace>
              <monospace>demes-slim</monospace>
            </td>
            <td rowspan="1" colspan="1">Loads Demes models into the <monospace>SLiM</monospace> forward simulator (<xref rid="iyac131-B27" ref-type="bibr">Haller and Messer 2019</xref>).</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">
              <monospace> </monospace>
              <monospace>fwdpy11</monospace>
            </td>
            <td rowspan="1" colspan="1">Simulates the Wright–Fisher model forward in time (<xref rid="iyac131-B59" ref-type="bibr">Thornton 2014</xref>, <xref rid="iyac131-B60" ref-type="bibr">2019</xref>). Demes are the preferred format for specifying a demographic model.</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">
              <monospace> </monospace>
              <monospace>GADMA</monospace>
            </td>
            <td rowspan="1" colspan="1">Infers models of demographic history (<xref rid="iyac131-B46" ref-type="bibr">Noskova <italic toggle="yes">et al.</italic> 2020</xref>). Outputs Demes models and visualizations.</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">
              <monospace> </monospace>
              <monospace>gIMble</monospace>
            </td>
            <td rowspan="1" colspan="1">Fits IM-type demographic models and infers genomic barriers to geneflow (<xref rid="iyac131-B40" ref-type="bibr">Laetsch <italic toggle="yes">et al.</italic> 2022</xref>). Outputs inferred models in Demes format.</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">
              <monospace> </monospace>
              <monospace>moments</monospace>
            </td>
            <td rowspan="1" colspan="1">Optimizes parameters in models of demographic history using SFS and linkage disequilibrium statistics (<xref rid="iyac131-B34" ref-type="bibr">Jouganous <italic toggle="yes">et al.</italic> 2017</xref>; <xref rid="iyac131-B49" ref-type="bibr">Ragsdale and Gravel 2019</xref>). Models to be optimized can be specified in Demes.</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">
              <monospace> </monospace>
              <monospace>MSMC</monospace>
            </td>
            <td rowspan="1" colspan="1">A script provided in the MSMC-tools repository (<ext-link xlink:href="https://github.com/stschiff/msmc-tools" ext-link-type="uri">https://github.com/stschiff/msmc-tools</ext-link>) converts MSMC (<xref rid="iyac131-B53" ref-type="bibr">Schiffels and Durbin 2014</xref>; <xref rid="iyac131-B54" ref-type="bibr">Schiffels and Wang 2020</xref>) output to the demes format.</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">
              <monospace> </monospace>
              <monospace>msprime</monospace>
            </td>
            <td rowspan="1" colspan="1">Simulates population genetic models using tree sequences (<xref rid="iyac131-B36" ref-type="bibr">Kelleher <italic toggle="yes">et al.</italic> 2016</xref>; <xref rid="iyac131-B37" ref-type="bibr">Kelleher and Lohse 2020</xref>; <xref rid="iyac131-B8" ref-type="bibr">Baumdicker <italic toggle="yes">et al.</italic> 2022</xref>). Demographic history models can be specified using Demes.</td>
          </tr>
        </tbody>
      </table>
      <table-wrap-foot>
        <fn id="tblfn1">
          <p>We have included software infrastructure developed for working with Demes models (such as parsing, validation, and visualization) as well as downstream software that implement the specification, at the time of writing.</p>
        </fn>
      </table-wrap-foot>
    </table-wrap>
  </sec>
  <sec>
    <title>Demes</title>
    <p>The design of Demes is a balance between two partially competing requirements: that (a) models should be easy for humans to understand and manipulate; and (b) software processing Demes models should be provided with an unambiguous representation that is straightforward to process. For efficiency of understanding and avoidance of model specification error, we require a data representation without redundancy (i.e. repetition of values). However, for the simplicity of software working with the Demes model (and the avoidance of programming error, or divergence in interpretations of the specification), it is preferable to have an explicit representation, in which all relevant values are readily available. Thus, Demes are composed of three entities: the Human Data Model (HDM) designed for human readability; the Machine Data Model (MDM) designed for programmatic input and processing; and the parser, which is responsible for transforming the former into the latter.</p>
    <p>Here, we provide a brief overview of the population genetics models that Demes supports and the components of the Demes infrastructure. Complete technical details of the MDM and HDM, and the responsibilities of the parser are provided in the online Demes specification (<ext-link xlink:href="https://popsim-consortium.github.io/demes-spec-docs/" ext-link-type="uri">https://popsim-consortium.github.io/demes-spec-docs/</ext-link>; accessed 2022 September 12). This specification rigorously defines the data model, fully describing the entities and their relationships, and the required behavior of implementations. Since the online specification is definitive, we will not recapitulate the details here, but instead focus on the high-level properties of the model and the rationale behind key design decisions.</p>
    <sec>
      <title>Population genetics model</title>
      <p>For inference and simulation software to meaningfully interoperate, there must be a shared understanding of what a demographic model <italic toggle="yes">is</italic>. Population genetics is a large field, and rather than attempting to capture all possible within- and between-population processes, we have instead adopted a pragmatic approach of identifying a common set of assumptions shared by many methods. We outline the processes and assumptions briefly here and in the Appendix.</p>
      <p>Demographic models consist of one or more populations (or “demes”) defined by their size histories and the time intervals of their existence. Individuals can move between populations based on their ancestor-descendant relationships or by continuous or discrete migration events. Within a population, we assume Wright–Fisher dynamics (see the Appendix for more precise details). As described in the Scope of the Specification section below, the demographic model does not, as a deliberate simplification and separation of duties, include any information about genome biology or selection.</p>
      <p>These basic assumptions of discrete Wright–Fisher populations connected by instantaneous or continuous migrations are shared by many inference methods (e.g. <xref rid="iyac131-B26" ref-type="bibr">Gutenkunst <italic toggle="yes">et al.</italic> 2009</xref>; <xref rid="iyac131-B41" ref-type="bibr">Li and Durbin 2011</xref>; <xref rid="iyac131-B24" ref-type="bibr">Gravel 2012</xref>; <xref rid="iyac131-B53" ref-type="bibr">Schiffels and Durbin 2014</xref>; <xref rid="iyac131-B34" ref-type="bibr">Jouganous <italic toggle="yes">et al.</italic> 2017</xref>; <xref rid="iyac131-B35" ref-type="bibr">Kamm <italic toggle="yes">et al.</italic> 2017</xref>; <xref rid="iyac131-B49" ref-type="bibr">Ragsdale and Gravel 2019</xref>; <xref rid="iyac131-B21" ref-type="bibr">Excoffier <italic toggle="yes">et al.</italic> 2021</xref>), and forwards- and backwards-time simulators (e.g. <xref rid="iyac131-B33" ref-type="bibr">Hudson 2002</xref>; <xref rid="iyac131-B26" ref-type="bibr">Gutenkunst <italic toggle="yes">et al.</italic> 2009</xref>; <xref rid="iyac131-B20" ref-type="bibr">Excoffier and Foll 2011</xref>; <xref rid="iyac131-B36" ref-type="bibr">Kelleher <italic toggle="yes">et al.</italic> 2016</xref>; <xref rid="iyac131-B34" ref-type="bibr">Jouganous <italic toggle="yes">et al.</italic> 2017</xref>; <xref rid="iyac131-B27" ref-type="bibr">Haller and Messer 2019</xref>; <xref rid="iyac131-B60" ref-type="bibr">Thornton 2019</xref>). Demes therefore serves as “middleware” between inference methods and simulation software, capturing these common assumptions.</p>
      <p>It is important to note that the goal of describing the basic population processes precisely is not to be proscriptive about what methods may or may not use the specification, but so that we can be clear on what situations we can expect methods to agree exactly. Arbitrary population processes—for example, within-deme continuous spatial structure (<xref rid="iyac131-B63" ref-type="bibr">Wright 1943</xref>; <xref rid="iyac131-B5" ref-type="bibr">Barton <italic toggle="yes">et al.</italic> 2002</xref>, <xref rid="iyac131-B6" ref-type="bibr">2010</xref>; <xref rid="iyac131-B52" ref-type="bibr">Ringbauer <italic toggle="yes">et al.</italic> 2017</xref>; <xref rid="iyac131-B7" ref-type="bibr">Battey <italic toggle="yes">et al.</italic> 2020</xref>)—may be layered on top of this basic description, but as dynamics diverge from the core assumptions, then of course we can expect results to differ accordingly.</p>
    </sec>
    <sec>
      <title>Human data model</title>
      <p>The Demes HDM is focused on efficient human understanding and avoiding errors. We have adopted the widely used YAML format (<xref rid="iyac131-B11" ref-type="bibr">Ben-Kiki <italic toggle="yes">et al.</italic> 2009</xref>) as the primary interface for writing and interchanging demographic models (see the Appendix for rationale). Demographic models provide information about global features of the model (such as time units and generation times), populations (as “demes”) and their existence intervals (as “epochs”), and gene flow between populations (as continuous “migrations” or instantaneous “pulse” events). <xref rid="iyac131-F1" ref-type="fig">Figure 1</xref> shows an example isolation-with-migration model in HDM format.</p>
      <fig position="float" id="iyac131-F1">
        <label>Fig. 1.</label>
        <caption>
          <p>Example isolation-with-migration Demes model. a) The HDM representation expressed as YAML. b) A visual representation of the model using <monospace>demesdraw</monospace>. The same model in the MDM form is provided in <xref rid="iyac131-F3" ref-type="fig">Fig. A1</xref>.</p>
        </caption>
        <graphic xlink:href="iyac131f1" position="float"/>
      </fig>
      <p>Structurally, the HDM encourages human understanding by avoiding redundancy in the description where possible and by providing a mechanism for specifying default values that are inherited hierarchically. For values that repeat across fields, the “defaults” mechanism may be used to implicitly assign default values to fields of the given type. A default is superseded by an explicitly provided value if given. Size values are inherited naturally following the progression of time. For example, if an epoch <monospace><monospace>start_size</monospace></monospace> is not provided (either directly, or via a defaults section), it is assumed to be equal to the <monospace><monospace>end_size</monospace></monospace> of the previous epoch. This also means that the first epoch of each population must specify the initial size (or it must be provided in a defaults section).</p>
      <p>Avoiding redundancy in this way reduces the cognitive load on readers, by highlighting necessary parameters which may be otherwise be obscured. It is not necessary—or indeed recommended—that all models are expressed in a maximally concise form, and we wholeheartedly endorse the explicit statement of parameters where it increases model legibility.</p>
    </sec>
    <sec>
      <title>Parsers</title>
      <p>While the HDM is designed for human readability and conciseness, the underlying data model suitable for software implementation (the MDM) is redundant and exhaustive. Translation from the HDM to the MDM requires resolving hierarchically defined default values and verifying relationships between populations and the validity of specified parameter values. Because this translation and validation require significant programming effort, we define a standard software entity as part of the specification to perform this task (the parser), which is intended to be shared by programs that support Demes as input. The Demes specification precisely defines the required behavior of parsers, and we provide a reference implementation written in Python to resolve any potential ambiguities, as well as an extensive test suite of examples and the expected outputs. In addition, we have high-quality parser implementations in the Python, C, Rust, and Julia languages (<xref rid="iyac131-T1" ref-type="table">Table 1</xref>) providing a solid foundation for the software ecosystem. By maintaining high-quality Demes parsers available as libraries, we ensure consistency across simulation and inference software. Having common parsers also benefits users by providing consistent and informative error messages for missing values or issues in formatting.</p>
    </sec>
    <sec>
      <title>Scope of the specification</title>
      <p>A primary design goal of Demes is to provide a means of unambiguously communicating the results of demographic model inferences to population genetic simulators. Since demography is defined in terms of groups of individuals and these groupings are influenced by genetics, it is difficult to find a simple definition that separates the two. Thus, we have attempted to be pragmatic, limiting the features that we include in Demes to those that are in practise regarded as part of a demographic model.</p>
      <p>The model is therefore limited to features that we can expect many different demographic inference and simulation methods to share. The specification only describes demographic features at the population level. Features of genome biology are out of scope, including mutation and recombination rates, genome annotations, ploidy, and so on. Selection and dominance models are absent, as discussed in the Appendix. It is important to note, however, that Demes may be used in applications that include additional population genetic processes outside of what is explicitly modeled in the specification, such as interpreting population sizes as carrying capacities, implementations of hard selection, or layering more complicated mating or spatial structure. The Demes specification is intended to provide a basic model that can be elaborated on where necessary.</p>
      <p>Demes are not a standard population genetic simulation specification, although it could be <italic toggle="yes">part</italic> of one. Since the standard is based on JSON, and JSON documents can be arbitrarily nested, we can imagine a simple specification of genome features such as mutation and recombination rates in which the demography is defined by an embedded Demes specification. Features of the simulation specification (such as defining the time and location of samples) can then <italic toggle="yes">refer to</italic> the Demes model. This design, in which we embed the demographic model <italic toggle="yes">within</italic> a larger specification rather than adding arbitrary and unrelated complexities <italic toggle="yes">to</italic> the demography is an essential simplification and separation of duties.</p>
      <p>The Demes specification is static by design—we wish to unambiguously describe a demographic model with a concrete set of parameters. This simplicity means that we cannot directly specify parameter distributions or estimated confidence intervals for those parameters. While it is not difficult to imagine extending the specification in ways that would allow this, it is not clear that the benefits are worth the greatly increased parser complexity (see the Appendix).</p>
    </sec>
  </sec>
  <sec>
    <title>Example: an isolation-with-migration model</title>
    <p>In <xref rid="iyac131-F1" ref-type="fig">Fig. 1</xref>, we provide an example isolation-with-migration model. Models typically start with a concise description, followed by the mandatory <monospace><monospace>time_units</monospace></monospace> field. This model uses the <monospace>defaults</monospace> section to provide a default <monospace><monospace>start_size</monospace></monospace> of 1,000 individuals for each epoch of each deme. There are 3 demes in the model, an ancestral deme named “A” which exists arbitrarily far back into the past then ceases to exist at 100 generations ago, and demes “X” and “Y” that derive their ancestry from A when it goes extinct. Demes A and X have only one epoch, in which the population sizes are constant, whereas deme Y has 2 epochs. Deme Y’s second epoch has a different <monospace><monospace>end_size</monospace></monospace> than its <monospace><monospace>start_size</monospace></monospace>, which indicates the size grows exponentially from 1,000 individuals at 50 generations ago to 3,000 individuals at time 0 (the present). The migration section lists one migration stanza, between demes X and Y. This migration stanza does not indicate a source or destination deme, so the migration is symmetric. No migration times are specified, so migrations occur continuously at the given rate during the time interval over which both demes exist (from 100 generations ago until the present). We do not attempt a detailed explanation of all Demes features here, and readers are instead directed to the tutorial and detailed specification in the online documentation (<ext-link xlink:href="https://popsim-consortium.github.io/demes-spec-docs/" ext-link-type="uri">https://popsim-consortium.github.io/demes-spec-docs/</ext-link>; accessed 2022 September 12).</p>
  </sec>
  <sec>
    <title>Application: simulation using Demes</title>
    <p>Here, we highlight the interaction between Demes and other software, including simulation and model illustration tools. Demes allow us to specify a demographic model which can be used as the input for a growing number of simulation packages (<xref rid="iyac131-T1" ref-type="table">Table 1</xref>). We implemented the human two-population demographic model from <xref rid="iyac131-B58" ref-type="bibr">Tennessen <italic toggle="yes">et al.</italic> (2012)</xref> inferred from European and African-American sequencing data. This model (shown in Demes format in <xref rid="iyac131-F4" ref-type="fig">Fig. A2</xref>) is parameterized by an ancestral population with an ancient growth, divergence into “AFR” and “EUR” that each has multiple-epoch size histories, and multiple epochs of continuous migration between the two branches (illustrated using <monospace><monospace>demesdraw</monospace></monospace> in <xref rid="iyac131-F2" ref-type="fig">Fig. 2a</xref>). The large final sizes (<inline-formula id="IE1"><mml:math id="IM1" display="inline" overflow="scroll"><mml:mrow><mml:mo>≈</mml:mo><mml:mn>500</mml:mn><mml:mo>,</mml:mo><mml:mn>000</mml:mn></mml:mrow></mml:math></inline-formula> individuals each) are one to three orders of magnitude larger than ancestral population sizes, reflecting the recent explosive population size increase in humans.</p>
    <fig position="float" id="iyac131-F2">
      <label>Fig. 2.</label>
      <caption>
        <p>Illustration and simulation using Demes. a) Using an inferred demographic model from <xref rid="iyac131-B58" ref-type="bibr">Tennessen <italic toggle="yes">et al.</italic> (2012)</xref> specified as a YAML file in Demes format (<xref rid="iyac131-F4" ref-type="fig">Fig. A2</xref>), we used <monospace><monospace>demesdraw</monospace></monospace> to visualize the demographic model (note the recent exponential growth resulting in present-day population sizes that greatly exceed those in the past). We then used <monospace><monospace>msprime</monospace></monospace> to simulate genomic data for 20 genome copies sampled from the two contemporary populations, and we used <monospace>moments</monospace> to compute the expected joint site-frequency spectrum for the same sample sizes (<xref rid="iyac131-F5" ref-type="fig">Fig. A3</xref>). b, c) We compared the single-population SFS in each population, showing agreement between the simulation methods. d) Python code snippets of the interactions between <monospace>demes</monospace> and the simulation software. An extended script to compute the SFS shown in (b) and (c) is given in <xref rid="iyac131-F5" ref-type="fig">Fig. A3</xref>.</p>
      </caption>
      <graphic xlink:href="iyac131f2" position="float"/>
    </fig>
    <p>We used this model to simulate 20 haploid genome copies from EUR and AFR at time zero (i.e. present day) to obtain the joint site-frequency spectrum (SFS), a summary of observed allele frequencies widely used in evolutionary inference (<xref rid="iyac131-B14" ref-type="bibr">Bustamante <italic toggle="yes">et al.</italic> 2001</xref>; <xref rid="iyac131-B26" ref-type="bibr">Gutenkunst <italic toggle="yes">et al.</italic> 2009</xref>; <xref rid="iyac131-B58" ref-type="bibr">Tennessen <italic toggle="yes">et al.</italic> 2012</xref>; <xref rid="iyac131-B34" ref-type="bibr">Jouganous <italic toggle="yes">et al.</italic> 2017</xref>; <xref rid="iyac131-B35" ref-type="bibr">Kamm <italic toggle="yes">et al.</italic> 2017</xref>; <xref rid="iyac131-B39" ref-type="bibr">Kim <italic toggle="yes">et al.</italic> 2017</xref>). The Demes model (<xref rid="iyac131-F2" ref-type="fig">Figs. 2a</xref> and <xref rid="iyac131-F4" ref-type="fig">A2</xref>) was provided as the input demography to <monospace><monospace>msprime</monospace></monospace> (<xref rid="iyac131-B8" ref-type="bibr">Baumdicker <italic toggle="yes">et al.</italic> 2022</xref>) to simulate a large recombining region under the mutation rate assumed in <xref rid="iyac131-B58" ref-type="bibr">Tennessen <italic toggle="yes">et al.</italic> (2012)</xref>, and we computed the observed SFS using <monospace>tskit</monospace> (<xref rid="iyac131-B51" ref-type="bibr">Ralph <italic toggle="yes">et al.</italic> 2020</xref>). Using the same Demes model as input to <monospace><monospace>moments</monospace></monospace> (<xref rid="iyac131-B34" ref-type="bibr">Jouganous <italic toggle="yes">et al.</italic> 2017</xref>), we computed the expectation of the joint SFS and compared to the <monospace><monospace>msprime</monospace></monospace> simulated data (<xref rid="iyac131-F2" ref-type="fig">Fig. 2, b and c</xref>). <xref rid="iyac131-F2" ref-type="fig">Figure 2d</xref> shows the code required to run the simulations in <monospace><monospace>msprime</monospace></monospace> and <monospace><monospace>moments</monospace></monospace>, and demonstrates that precisely the same input model, without modification, was provided to both packages. Such interoperability is a major gain for researchers, which we hope will become the expected norm as more packages adopt the Demes format.</p>
  </sec>
  <sec sec-type="discussion">
    <title>Discussion</title>
    <p>Stable and healthy software ecosystems require standard interchange formats, allowing for the development of high-quality and long-lasting tools that produce and consume the standard. Demographic models are a key part of population genetics research, and to date, the transfer of inferred models to downstream simulations has been ad hoc, and conversions between the many different ways of expressing such models are both labor intensive and error-prone. The proposed Demes standard is an attempt to bridge this gap between inference and simulation, and also to provide the foundations for a sustainable ecosystem of tools built around this data model. <xref rid="iyac131-T1" ref-type="table">Table 1</xref> shows some initial infrastructure that we have built as part of developing Demes, but many other useful tools can be envisaged that produce, consume, or transform this format.</p>
    <p>Reproducibility is a significant problem throughout the sciences (<xref rid="iyac131-B4" ref-type="bibr">Baker 2016</xref>), and various measures have been proposed to increase the likelihood of researchers being able to replicate results in the literature (<xref rid="iyac131-B44" ref-type="bibr">Munafò <italic toggle="yes">et al.</italic> 2017</xref>). The most basic requirement for reproducibility is that we must be able to state precisely what the result in question <italic toggle="yes">is</italic>. The lack of standardization in how complex demographic models are communicated today, and the lack of precision in the published model descriptions means that it is difficult to replicate analyses, or reproduce those models for later simulation. Thus, we hope that the Demes standard introduced here will be widely adopted by simulation and inference methods and be used for reporting results in publications, either as supplemental material or uploaded to a data repository.</p>
  </sec>
</body>
<back>
  <ack id="ack1">
    <title>Acknowledgments</title>
    <p>The authors would like to thank the editor and reviewers for helpful comments that have significantly improved this manuscript.</p>
    <sec>
      <title>Funding</title>
      <p>GG was supported by a Villum Fonden Young Investigator award to Fernando Racimo (project no. 00025300). RG and TS were supported by the National Institute of General Medical Sciences of the National Institutes of Health (R01GM127348 to RNG). MH was supported by a Natural Environment Research Council Independent Research Fellowship (NE/R015686/1). JK was supported by the Robertson Foundation. SS was supported by funding from the European Research Council under the European Union’s Horizon 2020 research and innovation program (grant agreement No 851511). GB was supported by funding from the European Research Council (ModelGenomLand, 757648).</p>
    </sec>
    <sec>
      <title>Conflicts of interest</title>
      <p>None declared.</p>
    </sec>
  </ack>
  <sec sec-type="data-availability">
    <title>Data Availability</title>
    <p>The Demes specification and documentation are available at <ext-link xlink:href="https://popsim-consortium.github.io/demes-spec-docs/" ext-link-type="uri">https://popsim-consortium.github.io/demes-spec-docs/</ext-link></p>
  </sec>
  <ref-list id="ref1">
    <title>Literature cited</title>
    <ref id="iyac131-B1">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Adrion</surname><given-names>JR</given-names></string-name>, <string-name><surname>Cole</surname><given-names>CB</given-names></string-name>, <string-name><surname>Dukler</surname><given-names>N</given-names></string-name>, <string-name><surname>Galloway</surname><given-names>JG</given-names></string-name>, <string-name><surname>Gladstein</surname><given-names>AL</given-names></string-name>, <string-name><surname>Gower</surname><given-names>G</given-names></string-name>, <string-name><surname>Kyriazis</surname><given-names>CC</given-names></string-name>, <string-name><surname>Ragsdale</surname><given-names>AP</given-names></string-name>, <string-name><surname>Tsambos</surname><given-names>G</given-names></string-name>, <string-name><surname>Baumdicker</surname><given-names>F</given-names></string-name></person-group>, <etal>et al</etal><article-title>A community-maintained standard library of population genetic models</article-title>. <source>eLife</source>. <year>2020</year>;<volume>9</volume>:<fpage>e54967</fpage>.<pub-id pub-id-type="pmid">32573438</pub-id></mixed-citation>
    </ref>
    <ref id="iyac131-B2">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Antao</surname><given-names>T</given-names></string-name>, <string-name><surname>Beja-Pereira</surname><given-names>A</given-names></string-name>, <string-name><surname>Luikart</surname><given-names>G.</given-names></string-name></person-group><article-title>MODELER4SIMCOAL2: a user-friendly, extensible modeler of demography and linked loci for coalescent simulations</article-title>. <source>Bioinformatics</source>. <year>2007</year>;<volume>23</volume>(<issue>14</issue>):<fpage>1848</fpage>–<lpage>1850</lpage>.<pub-id pub-id-type="pmid">17488756</pub-id></mixed-citation>
    </ref>
    <ref id="iyac131-B3">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Arenas</surname><given-names>M.</given-names></string-name></person-group><article-title>Simulation of molecular data under diverse evolutionary scenarios</article-title>. <source>PLoS Comput Biol</source>. <year>2012</year>;<volume>8</volume>(<issue>5</issue>):<fpage>e1002495</fpage>.<pub-id pub-id-type="pmid">22693434</pub-id></mixed-citation>
    </ref>
    <ref id="iyac131-B4">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Baker</surname><given-names>M.</given-names></string-name></person-group><article-title>1,500 scientists lift the lid on reproducibility</article-title>. <source>Nat News</source>. <year>2016</year>;<volume>533</volume>(<issue>7604</issue>):<fpage>452</fpage>–<lpage>454</lpage>.</mixed-citation>
    </ref>
    <ref id="iyac131-B5">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Barton</surname><given-names>NH</given-names></string-name>, <string-name><surname>Depaulis</surname><given-names>F</given-names></string-name>, <string-name><surname>Etheridge</surname><given-names>AM.</given-names></string-name></person-group><article-title>Neutral evolution in spatially continuous populations</article-title>. <source>Theor Popul Biol</source>. <year>2002</year>;<volume>61</volume>(<issue>1</issue>):<fpage>31</fpage>–<lpage>48</lpage>.<pub-id pub-id-type="pmid">11895381</pub-id></mixed-citation>
    </ref>
    <ref id="iyac131-B6">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Barton</surname><given-names>NH</given-names></string-name>, <string-name><surname>Kelleher</surname><given-names>J</given-names></string-name>, <string-name><surname>Etheridge</surname><given-names>AM.</given-names></string-name></person-group><article-title>A new model for extinction and recolonization in two dimensions: quantifying phylogeography</article-title>. <source>Evolution</source>. <year>2010</year>;<volume>64</volume>(<issue>9</issue>):<fpage>2701</fpage>–<lpage>2715</lpage>.<pub-id pub-id-type="pmid">20408876</pub-id></mixed-citation>
    </ref>
    <ref id="iyac131-B7">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Battey</surname><given-names>C</given-names></string-name>, <string-name><surname>Ralph</surname><given-names>PL</given-names></string-name>, <string-name><surname>Kern</surname><given-names>AD.</given-names></string-name></person-group><article-title>Space is the place: effects of continuous spatial structure on analysis of population genetic data</article-title>. <source>Genetics</source>. <year>2020</year>;<volume>215</volume>(<issue>1</issue>):<fpage>193</fpage>–<lpage>214</lpage>.<pub-id pub-id-type="pmid">32209569</pub-id></mixed-citation>
    </ref>
    <ref id="iyac131-B8">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Baumdicker</surname><given-names>F</given-names></string-name>, <string-name><surname>Bisschop</surname><given-names>G</given-names></string-name>, <string-name><surname>Goldstein</surname><given-names>D</given-names></string-name>, <string-name><surname>Gower</surname><given-names>G</given-names></string-name>, <string-name><surname>Ragsdale</surname><given-names>AP</given-names></string-name>, <string-name><surname>Tsambos</surname><given-names>G</given-names></string-name>, <string-name><surname>Zhu</surname><given-names>S</given-names></string-name>, <string-name><surname>Eldon</surname><given-names>B</given-names></string-name>, <string-name><surname>Ellerman</surname><given-names>EC</given-names></string-name>, <string-name><surname>Galloway</surname><given-names>JG</given-names></string-name></person-group>, <etal>et al</etal><article-title>Efficient ancestry and mutation simulation with msprime 1.0</article-title>. <source>Genetics</source>. <year>2022</year>;<volume>220</volume>(<issue>3</issue>):<fpage>iyab229</fpage>.<pub-id pub-id-type="pmid">34897427</pub-id></mixed-citation>
    </ref>
    <ref id="iyac131-B9">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Beaumont</surname><given-names>MA</given-names></string-name>, <string-name><surname>Zhang</surname><given-names>W</given-names></string-name>, <string-name><surname>Balding</surname><given-names>DJ.</given-names></string-name></person-group><article-title>Approximate Bayesian computation in population genetics</article-title>. <source>Genetics</source>. <year>2002</year>;<volume>162</volume>(<issue>4</issue>):<fpage>2025</fpage>–<lpage>2035</lpage>.<pub-id pub-id-type="pmid">12524368</pub-id></mixed-citation>
    </ref>
    <ref id="iyac131-B10">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Becheler</surname><given-names>A</given-names></string-name>, <string-name><surname>Coron</surname><given-names>C</given-names></string-name>, <string-name><surname>Dupas</surname><given-names>S.</given-names></string-name></person-group><article-title>The quetzal coalescence template library: a C++ programmers resource for integrating distributional, demographic and coalescent models</article-title>. <source>Mol Ecol Resour</source>. <year>2019</year>;<volume>19</volume>(<issue>3</issue>):<fpage>788</fpage>–<lpage>793</lpage>.<pub-id pub-id-type="pmid">30637945</pub-id></mixed-citation>
    </ref>
    <ref id="iyac131-B11">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><string-name><surname>Ben-Kiki</surname><given-names>O</given-names></string-name>, <string-name><surname>Evans</surname><given-names>C</given-names></string-name>, <string-name><surname>Ingerson</surname><given-names>B.</given-names></string-name></person-group> YAML Ain’t Markup Language (yaml™) version 1.1. Working Draft 2008-0511. <year>2009</year>. <ext-link xlink:href="https://yaml.org/spec/1.2.2/" ext-link-type="uri">https://yaml.org/spec/1.2.2/</ext-link></mixed-citation>
    </ref>
    <ref id="iyac131-B12">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><string-name><surname>Bray</surname><given-names>T.</given-names></string-name></person-group> The JavaScript Object Notation (JSON) Data Interchange Format. RFC 8259. <year>2017</year>. <ext-link xlink:href="https://www.rfc-editor.org/rfc/rfc8259" ext-link-type="uri">https://www.rfc-editor.org/rfc/rfc8259</ext-link></mixed-citation>
    </ref>
    <ref id="iyac131-B13">
      <mixed-citation publication-type="book"><person-group person-group-type="author"><string-name><surname>Bürger</surname><given-names>R.</given-names></string-name></person-group><source>The Mathematical Theory of Selection, Recombination, and Mutation</source>. Chichester (UK): <publisher-name>Wiley</publisher-name>; <year>2000</year>.</mixed-citation>
    </ref>
    <ref id="iyac131-B14">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Bustamante</surname><given-names>CD</given-names></string-name>, <string-name><surname>Wakeley</surname><given-names>J</given-names></string-name>, <string-name><surname>Sawyer</surname><given-names>S</given-names></string-name>, <string-name><surname>Hartl</surname><given-names>DL.</given-names></string-name></person-group><article-title>Directional selection and the site-frequency spectrum</article-title>. <source>Genetics</source>. <year>2001</year>;<volume>159</volume>(<issue>4</issue>):<fpage>1779</fpage>–<lpage>1788</lpage>.<pub-id pub-id-type="pmid">11779814</pub-id></mixed-citation>
    </ref>
    <ref id="iyac131-B15">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Carvajal-Rodríguez</surname><given-names>A.</given-names></string-name></person-group><article-title>Simulation of genomes: a review</article-title>. <source>Curr Genomics</source>. <year>2008</year>;<volume>9</volume>(<issue>3</issue>):<fpage>155</fpage>–<lpage>159</lpage>.<pub-id pub-id-type="pmid">19440512</pub-id></mixed-citation>
    </ref>
    <ref id="iyac131-B16">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Chen</surname><given-names>GK</given-names></string-name>, <string-name><surname>Marjoram</surname><given-names>P</given-names></string-name>, <string-name><surname>Wall</surname><given-names>JD.</given-names></string-name></person-group><article-title>Fast and flexible simulation of DNA sequence data</article-title>. <source>Genome Res</source>. <year>2009</year>;<volume>19</volume>(<issue>1</issue>):<fpage>136</fpage>–<lpage>142</lpage>.<pub-id pub-id-type="pmid">19029539</pub-id></mixed-citation>
    </ref>
    <ref id="iyac131-B17">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Christiansen</surname><given-names>FB.</given-names></string-name></person-group><article-title>Hard and soft selection in a subdivided population</article-title>. <source>Am Nat</source>. <year>1975</year>;<volume>109</volume>(<issue>965</issue>):<fpage>11</fpage>–<lpage>16</lpage>.</mixed-citation>
    </ref>
    <ref id="iyac131-B18">
      <mixed-citation publication-type="book"><person-group person-group-type="author"><string-name><surname>Crow</surname><given-names>JF</given-names></string-name>, <string-name><surname>Kimura</surname><given-names>M.</given-names></string-name></person-group><source>An Introduction to Population Genetics Theory</source>. <publisher-name>Caldwell</publisher-name> NJ: Blackburn press; <year>1970</year>.</mixed-citation>
    </ref>
    <ref id="iyac131-B19">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Ewing</surname><given-names>G</given-names></string-name>, <string-name><surname>Hermisson</surname><given-names>J.</given-names></string-name></person-group><article-title>MSMS: a coalescent simulation program including recombination, demographic structure, and selection at a single locus</article-title>. <source>Bioinformatics</source>. <year>2010</year>;<volume>26</volume>(<issue>16</issue>):<fpage>2064</fpage>–<lpage>2065</lpage>.<pub-id pub-id-type="pmid">20591904</pub-id></mixed-citation>
    </ref>
    <ref id="iyac131-B20">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Excoffier</surname><given-names>L</given-names></string-name>, <string-name><surname>Foll</surname><given-names>M.</given-names></string-name></person-group><article-title>Fastsimcoal: a continuous-time coalescent simulator of genomic diversity under arbitrarily complex evolutionary scenarios</article-title>. <source>Bioinformatics</source>. <year>2011</year>;<volume>27</volume>(<issue>9</issue>):<fpage>1332</fpage>–<lpage>1334</lpage>.<pub-id pub-id-type="pmid">21398675</pub-id></mixed-citation>
    </ref>
    <ref id="iyac131-B21">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Excoffier</surname><given-names>L</given-names></string-name>, <string-name><surname>Marchi</surname><given-names>N</given-names></string-name>, <string-name><surname>Marques</surname><given-names>DA</given-names></string-name>, <string-name><surname>Matthey-Doret</surname><given-names>R</given-names></string-name>, <string-name><surname>Gouy</surname><given-names>A</given-names></string-name>, <string-name><surname>Sousa</surname><given-names>VC.</given-names></string-name></person-group><article-title>fastsimcoal2: demographic inference under complex evolutionary scenarios</article-title>. <source>Bioinformatics</source>. <year>2021</year>;<volume>37</volume>(<issue>24</issue>):<fpage>4882</fpage>–<lpage>4885</lpage>.</mixed-citation>
    </ref>
    <ref id="iyac131-B22">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Gilmour</surname><given-names>JSL</given-names></string-name>, <string-name><surname>Gregor</surname><given-names>JW.</given-names></string-name></person-group><article-title>Demes: a suggested new terminology</article-title>. <source>Nature</source>. <year>1939</year>;<volume>144</volume>(<issue>3642</issue>):<fpage>333</fpage>.</mixed-citation>
    </ref>
    <ref id="iyac131-B23">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Gilmour</surname><given-names>JSL</given-names></string-name>, <string-name><surname>Heslop-Harrison</surname><given-names>J.</given-names></string-name></person-group><article-title>The deme terminology and the units of micro-evolutionary change</article-title>. <source>Genetica</source>. <year>1954</year>;<volume>27</volume>(<issue>1–2</issue>):<fpage>147</fpage>–<lpage>161</lpage>.<pub-id pub-id-type="pmid">13183346</pub-id></mixed-citation>
    </ref>
    <ref id="iyac131-B24">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Gravel</surname><given-names>S.</given-names></string-name></person-group><article-title>Population genetics models of local ancestry</article-title>. <source>Genetics</source>. <year>2012</year>;<volume>191</volume>(<issue>2</issue>):<fpage>607</fpage>–<lpage>619</lpage>.<pub-id pub-id-type="pmid">22491189</pub-id></mixed-citation>
    </ref>
    <ref id="iyac131-B25">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Guillaume</surname><given-names>F</given-names></string-name>, <string-name><surname>Rougemont</surname><given-names>J.</given-names></string-name></person-group><article-title>Nemo: an evolutionary and population genetics programming framework</article-title>. <source>Bioinformatics</source>. <year>2006</year>;<volume>22</volume>(<issue>20</issue>):<fpage>2556</fpage>–<lpage>2557</lpage>.<pub-id pub-id-type="pmid">16882649</pub-id></mixed-citation>
    </ref>
    <ref id="iyac131-B26">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Gutenkunst</surname><given-names>RN</given-names></string-name>, <string-name><surname>Hernandez</surname><given-names>RD</given-names></string-name>, <string-name><surname>Williamson</surname><given-names>SH</given-names></string-name>, <string-name><surname>Bustamante</surname><given-names>CD.</given-names></string-name></person-group><article-title>Inferring the joint demographic history of multiple populations from multidimensional SNP frequency data</article-title>. <source>PLoS Genetics</source>. <year>2009</year>;<volume>5</volume>(<issue>10</issue>):<fpage>e1000695</fpage>.<pub-id pub-id-type="pmid">19851460</pub-id></mixed-citation>
    </ref>
    <ref id="iyac131-B27">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Haller</surname><given-names>BC</given-names></string-name>, <string-name><surname>Messer</surname><given-names>PW.</given-names></string-name></person-group><article-title>SLiM 3: forward genetic simulations beyond the Wright–Fisher model</article-title>. <source>Mol Biol Evol</source>. <year>2019</year>;<volume>36</volume>(<issue>3</issue>):<fpage>632</fpage>–<lpage>637</lpage>.<pub-id pub-id-type="pmid">30517680</pub-id></mixed-citation>
    </ref>
    <ref id="iyac131-B28">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Hartfield</surname><given-names>M</given-names></string-name>, <string-name><surname>Wright</surname><given-names>SI</given-names></string-name>, <string-name><surname>Agrawal</surname><given-names>AF.</given-names></string-name></person-group><article-title>Coalescent times and patterns of genetic diversity in species with facultative sex: effects of gene conversion, population structure, and heterogeneity</article-title>. <source>Genetics</source>. <year>2016</year>;<volume>202</volume>(<issue>1</issue>):<fpage>297</fpage>–<lpage>312</lpage>.<pub-id pub-id-type="pmid">26584902</pub-id></mixed-citation>
    </ref>
    <ref id="iyac131-B29">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Hernandez</surname><given-names>RD.</given-names></string-name></person-group><article-title>A flexible forward simulator for populations subject to selection and demography</article-title>. <source>Bioinformatics</source>. <year>2008</year>;<volume>24</volume>(<issue>23</issue>):<fpage>2786</fpage>–<lpage>2787</lpage>.<pub-id pub-id-type="pmid">18842601</pub-id></mixed-citation>
    </ref>
    <ref id="iyac131-B30">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><string-name><surname>Hernandez</surname><given-names>RD</given-names></string-name>, <string-name><surname>Uricchio</surname><given-names>LH.</given-names></string-name></person-group> SFS_code: more Efficient and Flexible Forward Simulations. Technical report, bioRxiv. <year>2015</year>. <pub-id pub-id-type="doi">10.1101/025064</pub-id></mixed-citation>
    </ref>
    <ref id="iyac131-B31">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Hoban</surname><given-names>S</given-names></string-name>, <string-name><surname>Bertorelle</surname><given-names>G</given-names></string-name>, <string-name><surname>Gaggiotti</surname><given-names>OE.</given-names></string-name></person-group><article-title>Computer simulations: tools for population and evolutionary genetics</article-title>. <source>Nat Rev Genet</source>. <year>2012</year>;<volume>13</volume>(<issue>2</issue>):<fpage>110</fpage>–<lpage>122</lpage>.<pub-id pub-id-type="pmid">22230817</pub-id></mixed-citation>
    </ref>
    <ref id="iyac131-B32">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Hudson</surname><given-names>RR.</given-names></string-name></person-group><article-title>Testing the constant-rate neutral allele model with protein sequence data</article-title>. <source>Evolution</source>. <year>1983</year>;<volume>37</volume>(<issue>1</issue>):<fpage>203</fpage>–<lpage>217</lpage>.<pub-id pub-id-type="pmid">28568026</pub-id></mixed-citation>
    </ref>
    <ref id="iyac131-B33">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Hudson</surname><given-names>RR.</given-names></string-name></person-group><article-title>Generating samples under a Wright-Fisher neutral model of genetic variation</article-title>. <source>Bioinformatics</source>. <year>2002</year>;<volume>18</volume>(<issue>2</issue>):<fpage>337</fpage>–<lpage>338</lpage>.<pub-id pub-id-type="pmid">11847089</pub-id></mixed-citation>
    </ref>
    <ref id="iyac131-B34">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Jouganous</surname><given-names>J</given-names></string-name>, <string-name><surname>Long</surname><given-names>W</given-names></string-name>, <string-name><surname>Ragsdale</surname><given-names>AP</given-names></string-name>, <string-name><surname>Gravel</surname><given-names>S.</given-names></string-name></person-group><article-title>Inferring the joint demographic history of multiple populations: beyond the diffusion approximation</article-title>. <source>Genetics</source>. <year>2017</year>;<volume>206</volume>(<issue>3</issue>):<fpage>1549</fpage>–<lpage>1567</lpage>.<pub-id pub-id-type="pmid">28495960</pub-id></mixed-citation>
    </ref>
    <ref id="iyac131-B35">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Kamm</surname><given-names>JA</given-names></string-name>, <string-name><surname>Terhorst</surname><given-names>J</given-names></string-name>, <string-name><surname>Song</surname><given-names>YS.</given-names></string-name></person-group><article-title>Efficient computation of the joint sample frequency spectra for multiple populations</article-title>. <source>J Comput Graph Stat</source>. <year>2017</year>;<volume>26</volume>(<issue>1</issue>):<fpage>182</fpage>–<lpage>194</lpage>.<pub-id pub-id-type="pmid">28239248</pub-id></mixed-citation>
    </ref>
    <ref id="iyac131-B36">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Kelleher</surname><given-names>J</given-names></string-name>, <string-name><surname>Etheridge</surname><given-names>AM</given-names></string-name>, <string-name><surname>McVean</surname><given-names>G.</given-names></string-name></person-group><article-title>Efficient coalescent simulation and genealogical analysis for large sample sizes</article-title>. <source>PLoS Comput Biol</source>. <year>2016</year>;<volume>12</volume>(<issue>5</issue>):<fpage>e1004842</fpage>.<pub-id pub-id-type="pmid">27145223</pub-id></mixed-citation>
    </ref>
    <ref id="iyac131-B37">
      <mixed-citation publication-type="book"><person-group person-group-type="author"><string-name><surname>Kelleher</surname><given-names>J</given-names></string-name>, <string-name><surname>Lohse</surname><given-names>K.</given-names></string-name></person-group><part-title>Coalescent simulation with msprime</part-title>. In: <person-group person-group-type="editor"><string-name><surname>Dutheil</surname><given-names>JY</given-names></string-name></person-group>, editor. <source>Statistical Population Genomics</source>. <publisher-loc>New York (NY</publisher-loc>): <publisher-name>Springer US</publisher-name>; <year>2020</year>. p. <fpage>191</fpage>–<lpage>230</lpage>.</mixed-citation>
    </ref>
    <ref id="iyac131-B38">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Kern</surname><given-names>AD</given-names></string-name>, <string-name><surname>Schrider</surname><given-names>DR.</given-names></string-name></person-group><article-title>Discoal: flexible coalescent simulations with selection</article-title>. <source>Bioinformatics</source>. <year>2016</year>;<volume>32</volume>(<issue>24</issue>):<fpage>3839</fpage>–<lpage>3841</lpage>.<pub-id pub-id-type="pmid">27559153</pub-id></mixed-citation>
    </ref>
    <ref id="iyac131-B39">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Kim</surname><given-names>BY</given-names></string-name>, <string-name><surname>Huber</surname><given-names>CD</given-names></string-name>, <string-name><surname>Lohmueller</surname><given-names>KE.</given-names></string-name></person-group><article-title>Inference of the distribution of selection coefficients for new nonsynonymous mutations using large samples</article-title>. <source>Genetics</source>. <year>2017</year>;<volume>206</volume>(<issue>1</issue>):<fpage>345</fpage>–<lpage>361</lpage>.<pub-id pub-id-type="pmid">28249985</pub-id></mixed-citation>
    </ref>
    <ref id="iyac131-B40">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><string-name><surname>Laetsch</surname><given-names>D. R</given-names></string-name>, <string-name><surname>Bisschop</surname><given-names>G</given-names></string-name>, <string-name><surname>Martin</surname><given-names>S</given-names></string-name>, <string-name><surname>Aeschbacher</surname><given-names>S</given-names></string-name>, <string-name><surname>Setter</surname><given-names>D</given-names></string-name>, <string-name><surname>Lohse</surname><given-names>K</given-names></string-name></person-group>. Demographically explicit scans for barriers to gene flow using genome-wide IM blockwise likelihood estimation: gIMble. In prep<italic toggle="yes">.</italic><year>2022</year>.</mixed-citation>
    </ref>
    <ref id="iyac131-B41">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Li</surname><given-names>H</given-names></string-name>, <string-name><surname>Durbin</surname><given-names>R.</given-names></string-name></person-group><article-title>Inference of human population history from individual whole-genome sequences</article-title>. <source>Nature</source>. <year>2011</year>;<volume>475</volume>(<issue>7357</issue>):<fpage>493</fpage>–<lpage>496</lpage>.<pub-id pub-id-type="pmid">21753753</pub-id></mixed-citation>
    </ref>
    <ref id="iyac131-B42">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Liu</surname><given-names>Y</given-names></string-name>, <string-name><surname>Athanasiadis</surname><given-names>G</given-names></string-name>, <string-name><surname>Weale</surname><given-names>ME.</given-names></string-name></person-group><article-title>A survey of genetic simulation software for population and epidemiological studies</article-title>. <source>Hum Genomics</source>. <year>2008</year>;<volume>3</volume>(<issue>1</issue>):<fpage>79</fpage>–<lpage>86</lpage>.<pub-id pub-id-type="pmid">19129092</pub-id></mixed-citation>
    </ref>
    <ref id="iyac131-B43">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Mailund</surname><given-names>T</given-names></string-name>, <string-name><surname>Schierup</surname><given-names>MH</given-names></string-name>, <string-name><surname>Pedersen</surname><given-names>CNS</given-names></string-name>, <string-name><surname>Mechlenborg</surname><given-names>PJM</given-names></string-name>, <string-name><surname>Madsen</surname><given-names>JN</given-names></string-name>, <string-name><surname>Schauser</surname><given-names>L.</given-names></string-name></person-group><article-title>CoaSim: a flexible environment for simulating genetic data under coalescent models</article-title>. <source>BMC Bioinformatics</source>. <year>2005</year>;<volume>6</volume>:<fpage>252</fpage>–<lpage>256</lpage>.<pub-id pub-id-type="pmid">16225674</pub-id></mixed-citation>
    </ref>
    <ref id="iyac131-B44">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Munafò</surname><given-names>MR</given-names></string-name>, <string-name><surname>Nosek</surname><given-names>BA</given-names></string-name>, <string-name><surname>Bishop</surname><given-names>DVM</given-names></string-name>, <string-name><surname>Button</surname><given-names>KS</given-names></string-name>, <string-name><surname>Chambers</surname><given-names>CD</given-names></string-name>, <string-name><surname>du Sert</surname><given-names>NP</given-names></string-name>, <string-name><surname>Simonsohn</surname><given-names>U</given-names></string-name>, <string-name><surname>Wagenmakers</surname><given-names>E-J</given-names></string-name>, <string-name><surname>Ware</surname><given-names>JJ</given-names></string-name>, <string-name><surname>Ioannidis</surname><given-names>JPA</given-names></string-name></person-group>, <etal>et al</etal><article-title>A manifesto for reproducible science</article-title>. <source>Nat Hum Behav</source>. <year>2017</year>;<volume>1</volume>:<fpage>0021</fpage>.<pub-id pub-id-type="pmid">33954258</pub-id></mixed-citation>
    </ref>
    <ref id="iyac131-B45">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Nordborg</surname><given-names>M</given-names></string-name>, <string-name><surname>Donnelly</surname><given-names>P.</given-names></string-name></person-group><article-title>The coalescent process with selfing</article-title>. <source>Genetics</source>. <year>1997</year>;<volume>146</volume>(<issue>3</issue>):<fpage>1185</fpage>–<lpage>1195</lpage>.<pub-id pub-id-type="pmid">9215919</pub-id></mixed-citation>
    </ref>
    <ref id="iyac131-B46">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Noskova</surname><given-names>E</given-names></string-name>, <string-name><surname>Ulyantsev</surname><given-names>V</given-names></string-name>, <string-name><surname>Koepfli</surname><given-names>K-P</given-names></string-name>, <string-name><surname>O’Brien</surname><given-names>SJ</given-names></string-name>, <string-name><surname>Dobrynin</surname><given-names>P.</given-names></string-name></person-group><article-title>GADMA: genetic algorithm for inferring demographic history of multiple populations from allele frequency spectrum data</article-title>. <source>GigaScience</source>. <year>2020</year>;<volume>9</volume>(<issue>3</issue>):<fpage>giaa005</fpage>.<pub-id pub-id-type="pmid">32112099</pub-id></mixed-citation>
    </ref>
    <ref id="iyac131-B47">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Parobek</surname><given-names>CM</given-names></string-name>, <string-name><surname>Archer</surname><given-names>FI</given-names></string-name>, <string-name><surname>DePrenger-Levin</surname><given-names>ME</given-names></string-name>, <string-name><surname>Hoban</surname><given-names>SM</given-names></string-name>, <string-name><surname>Liggins</surname><given-names>L</given-names></string-name>, <string-name><surname>Strand</surname><given-names>AE.</given-names></string-name></person-group><article-title>skeleSim: an extensible, general framework for population genetic simulation in R</article-title>. <source>Mol Ecol Resour</source>. <year>2017</year>;<volume>17</volume>(<issue>1</issue>):<fpage>101</fpage>–<lpage>109</lpage>.<pub-id pub-id-type="pmid">27736016</pub-id></mixed-citation>
    </ref>
    <ref id="iyac131-B48">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Parreira</surname><given-names>B</given-names></string-name>, <string-name><surname>Trussart</surname><given-names>M</given-names></string-name>, <string-name><surname>Sousa</surname><given-names>V</given-names></string-name>, <string-name><surname>Hudson</surname><given-names>R</given-names></string-name>, <string-name><surname>Chikhi</surname><given-names>L.</given-names></string-name></person-group><article-title>SPAms: a user-friendly software to simulate population genetics data under complex demographic models</article-title>. <source>Mol Ecol Resour</source>. <year>2009</year>;<volume>9</volume>(<issue>3</issue>):<fpage>749</fpage>–<lpage>753</lpage>.<pub-id pub-id-type="pmid">21564735</pub-id></mixed-citation>
    </ref>
    <ref id="iyac131-B49">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Ragsdale</surname><given-names>AP</given-names></string-name>, <string-name><surname>Gravel</surname><given-names>S.</given-names></string-name></person-group><article-title>Models of archaic admixture and recent history from two-locus statistics</article-title>. <source>PLoS Genet</source>. <year>2019</year>;<volume>15</volume>(<issue>6</issue>):<fpage>e1008204</fpage>.<pub-id pub-id-type="pmid">31181058</pub-id></mixed-citation>
    </ref>
    <ref id="iyac131-B50">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Ragsdale</surname><given-names>AP</given-names></string-name>, <string-name><surname>Nelson</surname><given-names>D</given-names></string-name>, <string-name><surname>Gravel</surname><given-names>S</given-names></string-name>, <string-name><surname>Kelleher</surname><given-names>J.</given-names></string-name></person-group><article-title>Lessons learned from bugs in models of human history</article-title>. <source>Am J Hum Genet</source>. <year>2020</year>;<volume>107</volume>(<issue>4</issue>):<fpage>583</fpage>–<lpage>588</lpage>.<pub-id pub-id-type="pmid">33007197</pub-id></mixed-citation>
    </ref>
    <ref id="iyac131-B51">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Ralph</surname><given-names>P</given-names></string-name>, <string-name><surname>Thornton</surname><given-names>K</given-names></string-name>, <string-name><surname>Kelleher</surname><given-names>J.</given-names></string-name></person-group><article-title>Efficiently summarizing relationships in large samples: a general duality between statistics of genealogies and genomes</article-title>. <source>Genetics</source>. <year>2020</year>;<volume>215</volume>(<issue>3</issue>):<fpage>779</fpage>–<lpage>797</lpage>.<pub-id pub-id-type="pmid">32357960</pub-id></mixed-citation>
    </ref>
    <ref id="iyac131-B52">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Ringbauer</surname><given-names>H</given-names></string-name>, <string-name><surname>Coop</surname><given-names>G</given-names></string-name>, <string-name><surname>Barton</surname><given-names>NH.</given-names></string-name></person-group><article-title>Inferring recent demography from isolation by distance of long shared sequence blocks</article-title>. <source>Genetics</source>. <year>2017</year>;<volume>205</volume>(<issue>3</issue>):<fpage>1335</fpage>–<lpage>1351</lpage>.<pub-id pub-id-type="pmid">28108588</pub-id></mixed-citation>
    </ref>
    <ref id="iyac131-B53">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Schiffels</surname><given-names>S</given-names></string-name>, <string-name><surname>Durbin</surname><given-names>R.</given-names></string-name></person-group><article-title>Inferring human population size and separation history from multiple genome sequences</article-title>. <source>Nat Genet</source>. <year>2014</year>;<volume>46</volume>(<issue>8</issue>):<fpage>919</fpage>–<lpage>925</lpage>.<pub-id pub-id-type="pmid">24952747</pub-id></mixed-citation>
    </ref>
    <ref id="iyac131-B54">
      <mixed-citation publication-type="book"><person-group person-group-type="author"><string-name><surname>Schiffels</surname><given-names>S</given-names></string-name>, <string-name><surname>Wang</surname><given-names>K.</given-names></string-name></person-group><part-title>MSMC and MSMC2: the multiple sequentially Markovian coalescent</part-title>. In: <person-group person-group-type="editor"><string-name><surname>Dutheil</surname><given-names>JY</given-names></string-name></person-group>, editor. <source>Statistical Population Genomics. Vol 2090 of Methods in Molecular Biology</source>. <publisher-loc>New York (NY</publisher-loc>): <publisher-name>Springer US</publisher-name>; <year>2020</year>. p. <fpage>147</fpage>–<lpage>166</lpage>.</mixed-citation>
    </ref>
    <ref id="iyac131-B55">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Shlyakhter</surname><given-names>I</given-names></string-name>, <string-name><surname>Sabeti</surname><given-names>PC</given-names></string-name>, <string-name><surname>Schaffner</surname><given-names>SF.</given-names></string-name></person-group><article-title>Cosi2: an efficient simulator of exact and approximate coalescent with selection</article-title>. <source>Bioinformatics</source>. <year>2014</year>;<volume>30</volume>(<issue>23</issue>):<fpage>3427</fpage>–<lpage>3429</lpage>.<pub-id pub-id-type="pmid">25150247</pub-id></mixed-citation>
    </ref>
    <ref id="iyac131-B56">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Staab</surname><given-names>PR</given-names></string-name>, <string-name><surname>Zhu</surname><given-names>S</given-names></string-name>, <string-name><surname>Metzler</surname><given-names>D</given-names></string-name>, <string-name><surname>Lunter</surname><given-names>G.</given-names></string-name></person-group><article-title>scrm: efficiently simulating long sequences using the approximated coalescent with recombination</article-title>. <source>Bioinformatics</source>. <year>2015</year>;<volume>31</volume>(<issue>10</issue>):<fpage>1680</fpage>–<lpage>1682</lpage>.<pub-id pub-id-type="pmid">25596205</pub-id></mixed-citation>
    </ref>
    <ref id="iyac131-B57">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Tajima</surname><given-names>F.</given-names></string-name></person-group><article-title>Evolutionary relationship of DNA sequences in finite populations</article-title>. <source>Genetics</source>. <year>1983</year>;<volume>105</volume>(<issue>2</issue>):<fpage>437</fpage>–<lpage>460</lpage>.<pub-id pub-id-type="pmid">6628982</pub-id></mixed-citation>
    </ref>
    <ref id="iyac131-B58">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Tennessen</surname><given-names>JA</given-names></string-name>, <string-name><surname>Bigham</surname><given-names>AW</given-names></string-name>, <string-name><surname>O'Connor</surname><given-names>TD</given-names></string-name>, <string-name><surname>Fu</surname><given-names>W</given-names></string-name>, <string-name><surname>Kenny</surname><given-names>EE</given-names></string-name>, <string-name><surname>Gravel</surname><given-names>S</given-names></string-name>, <string-name><surname>McGee</surname><given-names>S</given-names></string-name>, <string-name><surname>Do</surname><given-names>R</given-names></string-name>, <string-name><surname>Liu</surname><given-names>X</given-names></string-name>, <string-name><surname>Jun</surname><given-names>G</given-names></string-name></person-group>, <etal>et al</etal>; <collab>NHLBI Exome Sequencing Project</collab>. <article-title>Evolution and functional impact of rare coding variation from deep sequencing of human exomes</article-title>. <source>Science</source>. <year>2012</year>;<volume>337</volume>(<issue>6090</issue>):<fpage>64</fpage>–<lpage>69</lpage>.<pub-id pub-id-type="pmid">22604720</pub-id></mixed-citation>
    </ref>
    <ref id="iyac131-B59">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Thornton</surname><given-names>KR.</given-names></string-name></person-group><article-title>A C++ template library for efficient forward-time population genetic simulation of large populations</article-title>. <source>Genetics</source>. <year>2014</year>;<volume>198</volume>(<issue>1</issue>):<fpage>157</fpage>–<lpage>166</lpage>.<pub-id pub-id-type="pmid">24950894</pub-id></mixed-citation>
    </ref>
    <ref id="iyac131-B60">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Thornton</surname><given-names>KR.</given-names></string-name></person-group><article-title>Polygenic adaptation to an environmental shift: temporal dynamics of variation under Gaussian stabilizing selection and additive effects on a single trait</article-title>. <source>Genetics</source>. <year>2019</year>;<volume>213</volume>(<issue>4</issue>):<fpage>1513</fpage>–<lpage>1530</lpage>.<pub-id pub-id-type="pmid">31653678</pub-id></mixed-citation>
    </ref>
    <ref id="iyac131-B61">
      <mixed-citation publication-type="book"><person-group person-group-type="author"><string-name><surname>Wakeley</surname><given-names>J.</given-names></string-name></person-group><source>Coalescent Theory: An Introduction</source>. Englewood, CO: Roberts and Company<publisher-name>Oxford University Press</publisher-name>; <year>2008</year>.</mixed-citation>
    </ref>
    <ref id="iyac131-B62">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><string-name><surname>Wright</surname><given-names>A</given-names></string-name>, <string-name><surname>Andrews</surname><given-names>H</given-names></string-name>, <string-name><surname>Hutton</surname><given-names>B</given-names></string-name>, <string-name><surname>Dennis</surname><given-names>G.</given-names></string-name></person-group> JSON schema: a media type for describing JSON documents. <year>2020</year>. <ext-link xlink:href="https://json-schema.org/" ext-link-type="uri">https://json-schema.org/</ext-link></mixed-citation>
    </ref>
    <ref id="iyac131-B63">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Wright</surname><given-names>S.</given-names></string-name></person-group><article-title>Isolation by distance</article-title>. <source>Genetics</source>. <year>1943</year>;<volume>28</volume>(<issue>2</issue>):<fpage>114</fpage>–<lpage>138</lpage>.<pub-id pub-id-type="pmid">17247074</pub-id></mixed-citation>
    </ref>
    <ref id="iyac131-B64">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Yuan</surname><given-names>X</given-names></string-name>, <string-name><surname>Miller</surname><given-names>DJ</given-names></string-name>, <string-name><surname>Zhang</surname><given-names>J</given-names></string-name>, <string-name><surname>Herrington</surname><given-names>D</given-names></string-name>, <string-name><surname>Wang</surname><given-names>Y.</given-names></string-name></person-group><article-title>An overview of population genetic data simulation</article-title>. <source>J Comput Biol</source>. <year>2012</year>;<volume>19</volume>(<issue>1</issue>):<fpage>42</fpage>–<lpage>54</lpage>.<pub-id pub-id-type="pmid">22149682</pub-id></mixed-citation>
    </ref>
    <ref id="iyac131-B65">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Zhou</surname><given-names>Y</given-names></string-name>, <string-name><surname>Tian</surname><given-names>X</given-names></string-name>, <string-name><surname>Browning</surname><given-names>BL</given-names></string-name>, <string-name><surname>Browning</surname><given-names>SR.</given-names></string-name></person-group><article-title>POPdemog: visualizing population demographic history from simulation scripts</article-title>. <source>Bioinformatics</source>. <year>2018</year>;<volume>34</volume>(<issue>16</issue>):<fpage>2854</fpage>–<lpage>2855</lpage>.<pub-id pub-id-type="pmid">29590339</pub-id></mixed-citation>
    </ref>
  </ref-list>
  <app-group>
    <app id="app1">
      <title>Appendix</title>
      <p>The Demes specification is a formal data model for describing the properties of populations over time, along with some metadata and provenance information. The data model is based on the ubiquitous JSON (<xref rid="iyac131-B12" ref-type="bibr">Bray 2017</xref>) standard, and formally defined using JSON Schema (<xref rid="iyac131-B62" ref-type="bibr">Wright <italic toggle="yes">et al.</italic> 2020</xref>). Along with the schema, full technical details of the model are provided in the online specification document (<ext-link xlink:href="https://popsim-consortium.github.io/demes-spec-docs/" ext-link-type="uri">https://popsim-consortium.github.io/demes-spec-docs/</ext-link>).</p>
      <sec>
        <title>Population genetics model details</title>
        <p>In Demes, demographic models consist of one or more interacting populations, or “demes,” understood to be a collection of individuals that can be conveniently modeled using a defined set of rules and parameters (<xref rid="iyac131-B22" ref-type="bibr">Gilmour and Gregor 1939</xref>; <xref rid="iyac131-B23" ref-type="bibr">Gilmour and Heslop-Harrison 1954</xref>). To avoid confusion with the name of the specification itself, we will use the term “population” in this discussion, with the understanding that the terms are interchangeable. A population is defined as some collection of individuals that exists for some period of time, and has a well-defined size (i.e. number of individuals) during that time period. Individuals can move between populations either according to their ancestor–descendant relationships or through processes involving migrations. Few other properties of the populations are specified in the model: we are concerned primarily with defining the populations, their sizes, and the movement of individuals between those populations.</p>
        <sec>
          <title>Time units</title>
          <p>Population and event times are written as units in the past, so that time zero corresponds to the final generation or “now,” and event times in the past are values greater than zero with larger values corresponding to times in the more distant past. By having time values increase into the past, we avoid the need to choose an arbitrary point in history as “time zero.” A natural specification for time units is in generations, although other time units are permitted, such as years, accompanied by the generation time so that downstream software may convert times into generations as required.</p>
          <p>There must be at least one population with an infinite <monospace><monospace>start_time</monospace></monospace>. An infinite start time may be interpreted differently depending on the simulator. In a coalescent setting, there is no upper bound for the coalescent time of lineages in this population. In a forwards-time setting, the interval of time between infinity and the oldest noninfinite model time (i.e. the “first event”) is approximated by the simulator’s burn-in phase—detailed guidance is provided in the online specification.</p>
        </sec>
        <sec>
          <title>Sizes and epochs</title>
          <p>Population sizes are given as numbers of individuals, and details such as ploidy levels are considered external to the model. We therefore focus on the number of individuals as opposed to the number of genome copies. Sizes and mating system details are specified for each population within population-specific epochs. Epochs are contiguous time intervals that define the existence interval of the population. Each epoch specifies the population size over that interval, which can be a constant value or a function defined by start and end sizes that must remain positive. Only exponential population size changes are currently supported, but other functions may be added to the specification over time.</p>
        </sec>
        <sec>
          <title>Population dynamics</title>
          <p>Within a population, we assume that allele frequency dynamics can be described by the Wright–Fisher model. Briefly, generations are nonoverlapping (all parents reproduce and die simultaneously), and for allele <italic toggle="yes">i</italic> currently at frequency <italic toggle="yes">p<sub>i</sub></italic>, its frequency in the next generation (at birth) is expected to be <inline-formula id="IE2"><mml:math id="IM2" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:msub><mml:mi>w</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>/</mml:mo><mml:mrow><mml:mover accent="true"><mml:mi>w</mml:mi><mml:mo>¯</mml:mo></mml:mover></mml:mrow></mml:mrow></mml:math></inline-formula>, where <italic toggle="yes">w<sub>i</sub></italic> and <inline-formula id="IE3"><mml:math id="IM3" display="inline" overflow="scroll"><mml:mrow><mml:mover accent="true"><mml:mi>w</mml:mi><mml:mo>¯</mml:mo></mml:mover></mml:mrow></mml:math></inline-formula> are the marginal and mean fitnesses, respectively, properly weighted according to ancestry proportions. In this framework, a forward-time simulation of finite populations is equivalent to multinomial sampling of allele frequencies each generation (<xref rid="iyac131-B13" ref-type="bibr">Bürger 2000</xref>, pp. 29–31; <xref rid="iyac131-B18" ref-type="bibr">Crow and Kimura 1970</xref>, pp. 179–181), and a backwards-time (coalescent) simulation follows the approximations described in <xref rid="iyac131-B57" ref-type="bibr">Tajima (1983)</xref>, <xref rid="iyac131-B32" ref-type="bibr">Hudson (1983)</xref>, and <xref rid="iyac131-B61" ref-type="bibr">Wakeley (2008</xref>, Chapter 3). Furthermore, this model assumes “soft” selection (<xref rid="iyac131-B17" ref-type="bibr">Christiansen 1975</xref>), meaning that the dynamics of population sizes changes are independent of the details of individual fitnesses. As such, this model excludes scenarios such as “hard selection,” in which population sizes are dependent on a population’s mean fitness, or stochastic fluctuations in population size, such as interpreting population sizes as carrying capacities. Many forwards and backwards time simulators currently implement this model (e.g. <xref rid="iyac131-B33" ref-type="bibr">Hudson 2002</xref>; <xref rid="iyac131-B26" ref-type="bibr">Gutenkunst <italic toggle="yes">et al.</italic> 2009</xref>; <xref rid="iyac131-B20" ref-type="bibr">Excoffier and Foll 2011</xref>; <xref rid="iyac131-B36" ref-type="bibr">Kelleher <italic toggle="yes">et al.</italic> 2016</xref>; <xref rid="iyac131-B34" ref-type="bibr">Jouganous <italic toggle="yes">et al.</italic> 2017</xref>; <xref rid="iyac131-B27" ref-type="bibr">Haller and Messer 2019</xref>; <xref rid="iyac131-B60" ref-type="bibr">Thornton 2019</xref>).</p>
        </sec>
        <sec>
          <title>Selfing and cloning</title>
          <p>Each population has an assigned selfing rate and cloning rate, where each defines the probability that offspring are generated from one generation to the next by either self-fertilization or cloning of an individual. More specifically, for a given epoch within a population denote the clonal rate by <italic toggle="yes">σ</italic> and the selfing rate by <italic toggle="yes">S</italic>. <italic toggle="yes">S</italic> and <italic toggle="yes">σ</italic> can take any value between zero and one and can sum to more than one. Each generation a proportion of offspring <italic toggle="yes">σ</italic> are expected to be generated through clonal reproduction, while <inline-formula id="IE4"><mml:math id="IM4" display="inline" overflow="scroll"><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mo>σ</mml:mo></mml:mrow></mml:math></inline-formula> are expected to arise through sexual reproduction. Within the sexually reproduced offspring, a proportion <italic toggle="yes">S</italic> is born via self-fertilization while the rest have parents drawn at random from the previous generation. Depending on the simulator, this random drawing of parent may occur either with or without replacement. When drawing occurs with replacement, a small amount of “residual” selfing is expected, so that the realized selfing probability is <inline-formula id="IE5"><mml:math id="IM5" display="inline" overflow="scroll"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mo>σ</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>S</mml:mi><mml:mo>+</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>S</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>/</mml:mo><mml:mi>N</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> instead of <inline-formula id="IE6"><mml:math id="IM6" display="inline" overflow="scroll"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mo>σ</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:mi>S</mml:mi></mml:mrow></mml:math></inline-formula> (so that even with <italic toggle="yes">σ</italic> = 0 and <italic toggle="yes">S </italic>=<italic toggle="yes"> </italic>0, selfing may still occur with probability <inline-formula id="IE7"><mml:math id="IM7" display="inline" overflow="scroll"><mml:mrow><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:mi>N</mml:mi></mml:mrow></mml:math></inline-formula>), although this effect is negligible in large populations (<xref rid="iyac131-B45" ref-type="bibr">Nordborg and Donnelly 1997</xref>).</p>
          <p>By allowing the definition of selfing and cloning probabilities, we allow many standard models to be defined. However, by parameterizing selfing and cloning as we have, we assume that these properties of populations can be specified independently from the genetics. In other words, mutations that cause selfing probabilities to fluctuate within an epoch are not considered. More details of the mathematical properties of selfing and cloning rates in a coalescent context can be found in <xref rid="iyac131-B45" ref-type="bibr">Nordborg and Donnelly (1997)</xref> and <xref rid="iyac131-B28" ref-type="bibr">Hartfield <italic toggle="yes">et al.</italic> (2016)</xref>.</p>
        </sec>
        <sec>
          <title>Relationships between populations</title>
          <p>A population may have one or more ancestors, which are other populations that exist at the population’s start time. If one ancestor is specified, the first generation is constructed by randomly sampling parents from the ancestral population to contribute to offspring in the newly generated population. If more than one ancestor is specified, the proportions of ancestry from each contributing population must be provided, and those proportions must sum to one. In this case, parents are chosen randomly from each ancestral population with probability given by those proportions.</p>
          <p>Individuals in a population may have parents from a different population through migrations. These can be defined as continuous migration rates over time intervals for which populations coexist or through instantaneous (or pulse) migration events at a given time. Continuous migration rates are defined as the probability that parents in the “destination” population are chosen from the “source” population. On the other hand, pulse migration events specify the instantaneous replacement of a given fraction of individuals in a destination population by individuals with parents from a source population.</p>
        </sec>
      </sec>
      <sec>
        <title>Rationale for YAML</title>
        <p>We have adopted the widely used YAML format (<xref rid="iyac131-B11" ref-type="bibr">Ben-Kiki <italic toggle="yes">et al.</italic> 2009</xref>) as the recommended means of interchanging Demes models (e.g. <xref rid="iyac131-F1" ref-type="fig">Figs. 1</xref> and <xref rid="iyac131-F4" ref-type="fig">A2</xref>). YAML is a data serialization language with an emphasis on simplicity and which interoperates well with JSON (indeed, YAML 1.2 is a superset of JSON). We chose YAML over JSON because although JSON is an excellent format for data interchange, it is ill-suited for human understanding and manipulation. We also considered other declarative data exchange formats such as TOML, but chose YAML because of its equivalence with JSON, popularity, and good software support. Since the Demes data model is defined in JSON Schema, however, there is no formal dependency on YAML and implementations may choose to use JSON directly if they wish (e.g. for greater efficiency).</p>
      </sec>
      <sec>
        <title>Rationale for static models</title>
        <p>The Demes specification is designed to describe demographic models defined by a fixed set of model parameters. As described in the main text, it does not include information about estimated confidence intervals or the joint distribution of parameter values. In this section, we describe the rationale for this design decision.</p>
        <p>The parameters of demographic models are typically tightly coupled, and cases in which distributions for different parameters can be simply described are rare. In this situation, the simplest way to describe an estimated distribution is to list a large number of samples from the posterior. While writing out a large number of Demes models in YAML format may seem inefficient, it can in fact be a compact way to describe these distributions. For example, consider a one-population model with piecewise-constant sizes over 20 epochs which has ∼40 free parameters: the <monospace><monospace>start_size</monospace></monospace> and <monospace><monospace>end_time</monospace></monospace> values for each epoch. If we sample 50,000 models from the posterior distribution, the resulting multidocument YAML file is 45 MiB. This format compresses down to 8.4 MiB when gzipped or 6.2 MiB when compressed with LZMA2, which is on par with an equivalent binary representation of the free parameters (<inline-formula id="IE8"><mml:math id="IM8" display="inline" overflow="scroll"><mml:mrow><mml:mn>40</mml:mn><mml:mo>×</mml:mo><mml:mn>50000</mml:mn><mml:mo>×</mml:mo><mml:mn>4</mml:mn><mml:mo> </mml:mo><mml:mtext>bytes</mml:mtext><mml:mo>≈</mml:mo><mml:mn>7.6</mml:mn><mml:mo> </mml:mo><mml:mtext>MiB</mml:mtext></mml:mrow></mml:math></inline-formula>).</p>
        <p>Similarly, one might be interested in running simulations in which the demographic model parameters are drawn from a distribution, e.g. in ABC inference (<xref rid="iyac131-B9" ref-type="bibr">Beaumont <italic toggle="yes">et al.</italic> 2002</xref>). Other inference procedures based on optimizing a loss function (<xref rid="iyac131-B26" ref-type="bibr">Gutenkunst <italic toggle="yes">et al.</italic> 2009</xref>; <xref rid="iyac131-B34" ref-type="bibr">Jouganous <italic toggle="yes">et al.</italic> 2017</xref>; <xref rid="iyac131-B35" ref-type="bibr">Kamm <italic toggle="yes">et al.</italic> 2017</xref>; <xref rid="iyac131-B49" ref-type="bibr">Ragsdale and Gravel 2019</xref>; <xref rid="iyac131-B21" ref-type="bibr">Excoffier <italic toggle="yes">et al.</italic> 2021</xref>) need users to specify parameter bounds, and possibly nonlinear or conditional constraints between parameters. Indeed, the choice of how to parameterize a model could be important for some inference methods (e.g. absolute times vs relative times between events).</p>
        <p>Implementing the many distributions of interest and supporting a general way to describe a model’s free parameters would greatly increase the complexity of parsers, with relatively limited benefit to most users. It is unlikely that Demes could be made sufficiently flexible without implementing many features of general-purpose programming languages, such as variables, arithmetic, and flow control. Such use cases are therefore better served by writing model-generating functions in an existing programming language, for example using the Demes Python API (e.g. as implemented in <monospace>moments</monospace>; <xref rid="iyac131-B34" ref-type="bibr">Jouganous <italic toggle="yes">et al.</italic> 2017</xref>; <xref rid="iyac131-B49" ref-type="bibr">Ragsdale and Gravel 2019</xref>). As an intriguing possibility for developments in this direction, there exist many templating solutions for YAML and JSON that are specifically designed for extending static data in arbitrarily complex ways (e.g. <monospace>YTT</monospace>, <monospace>Jsonnet</monospace>, <monospace>CUE</monospace>, and <monospace>Dhall</monospace>).</p>
        <fig position="anchor" id="iyac131-F3">
          <label>Fig. A1.</label>
          <caption>
            <p>Isolation-with-migration example model from <xref rid="iyac131-F1" ref-type="fig">Fig. 1</xref> in MDM form. The MDM form of the model is complete and explicit, but contains much redundant information that is omitted in the HDM form.</p>
          </caption>
          <graphic xlink:href="iyac131f3" position="float"/>
        </fig>
        <fig position="anchor" id="iyac131-F4">
          <label>Fig. A2.</label>
          <caption>
            <p>The <xref rid="iyac131-B58" ref-type="bibr">Tennessen <italic toggle="yes">et al.</italic> (2012)</xref> two-population demographic model in Demes format. This model includes a single ancestral population that expands in size in the past, followed by divergence between AFR- and EUR-labeled populations. The two-population phase of the model includes multiple epochs of varying size, and rapid exponential growth over the past 5,000 years in each population.</p>
          </caption>
          <graphic xlink:href="iyac131f4" position="float"/>
        </fig>
        <fig position="anchor" id="iyac131-F5">
          <label>Fig. A3.</label>
          <caption>
            <p>Simulation of SFS for the Tennessen model. We first load the demographic model using <monospace><monospace>demes</monospace></monospace> (as <monospace>graph</monospace>), which can then be used by <monospace><monospace>msprime</monospace></monospace> to create the demographic model used in <monospace><monospace>msprime.sim_ancestry()</monospace></monospace>. The same loaded graph can also be passed to <monospace><monospace>moments</monospace></monospace> to compute the expected joint SFS. To compare the SFS in <xref rid="iyac131-F2" ref-type="fig">Fig. 2</xref>, we marginalize the joint SFS to obtain the single-population SFS for both AFR and EUR populations. Lines interfacing <monospace>demes</monospace> and other software are highlighted.</p>
          </caption>
          <graphic xlink:href="iyac131f5" position="float"/>
        </fig>
      </sec>
    </app>
  </app-group>
</back>
