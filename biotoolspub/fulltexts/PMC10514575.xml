<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.2 20190208//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.2?>
<?ConverterInfo.XSLTName jats2jats3.xsl?>
<?ConverterInfo.Version 1?>
<?subarticle report202079?>
<?properties open_access?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">F1000Res</journal-id>
    <journal-id journal-id-type="iso-abbrev">F1000Res</journal-id>
    <journal-title-group>
      <journal-title>F1000Research</journal-title>
    </journal-title-group>
    <issn pub-type="epub">2046-1402</issn>
    <publisher>
      <publisher-name>F1000 Research Limited</publisher-name>
      <publisher-loc>London, UK</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">10514575</article-id>
    <article-id pub-id-type="doi">10.12688/f1000research.104368.3</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Software Tool Article</subject>
      </subj-group>
      <subj-group>
        <subject>Articles</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>ngsJulia: population genetic analysis of next-generation DNA sequencing data with Julia language</article-title>
      <fn-group content-type="pub-status">
        <fn>
          <p>[version 3; peer review: 1 approved</p>
        </fn>
      </fn-group>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Mas-Sandoval</surname>
          <given-names>Alex</given-names>
        </name>
        <role content-type="http://credit.niso.org/">Investigation</role>
        <role content-type="http://credit.niso.org/">Visualization</role>
        <role content-type="http://credit.niso.org/">Writing – Review &amp; Editing</role>
        <contrib-id contrib-id-type="orcid">https://orcid.org/0000-0002-1712-9404</contrib-id>
        <xref rid="a1" ref-type="aff">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Jin</surname>
          <given-names>Chenyu</given-names>
        </name>
        <role content-type="http://credit.niso.org/">Investigation</role>
        <role content-type="http://credit.niso.org/">Software</role>
        <role content-type="http://credit.niso.org/">Writing – Review &amp; Editing</role>
        <xref rid="a1" ref-type="aff">1</xref>
        <xref rid="a2" ref-type="aff">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Fracassetti</surname>
          <given-names>Marco</given-names>
        </name>
        <role content-type="http://credit.niso.org/">Data Curation</role>
        <role content-type="http://credit.niso.org/">Writing – Review &amp; Editing</role>
        <contrib-id contrib-id-type="orcid">https://orcid.org/0000-0002-2962-2669</contrib-id>
        <xref rid="a3" ref-type="aff">3</xref>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <name>
          <surname>Fumagalli</surname>
          <given-names>Matteo</given-names>
        </name>
        <role content-type="http://credit.niso.org/">Conceptualization</role>
        <role content-type="http://credit.niso.org/">Formal Analysis</role>
        <role content-type="http://credit.niso.org/">Funding Acquisition</role>
        <role content-type="http://credit.niso.org/">Investigation</role>
        <role content-type="http://credit.niso.org/">Methodology</role>
        <role content-type="http://credit.niso.org/">Project Administration</role>
        <role content-type="http://credit.niso.org/">Software</role>
        <role content-type="http://credit.niso.org/">Visualization</role>
        <role content-type="http://credit.niso.org/">Writing – Original Draft Preparation</role>
        <contrib-id contrib-id-type="orcid">https://orcid.org/0000-0002-4084-2953</contrib-id>
        <xref rid="c1" ref-type="corresp">a</xref>
        <xref rid="a1" ref-type="aff">1</xref>
        <xref rid="a4" ref-type="aff">4</xref>
      </contrib>
      <aff id="a1"><label>1</label>Department of Life Sciences, Imperial College London, London, UK</aff>
      <aff id="a2"><label>2</label>Institute of population genetics, University of Veterinary Medicine Vienna, Vienna, Austria</aff>
      <aff id="a3"><label>3</label>Department of Ecology, Environment and Plant Sciences, Stockholm University, Stockholm, Sweden</aff>
      <aff id="a4"><label>4</label>School of Biological and Behavioural Science, Queen Mary, University of London, London, UK</aff>
    </contrib-group>
    <author-notes>
      <corresp id="c1">
        <label>a</label>
        <email xlink:href="mailto:m.fumagalli@qmul.ac.uk">m.fumagalli@qmul.ac.uk</email>
      </corresp>
      <fn fn-type="COI-statement">
        <p>No competing interests were disclosed.</p>
      </fn>
    </author-notes>
    <pub-date pub-type="epub">
      <day>14</day>
      <month>7</month>
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2022</year>
    </pub-date>
    <volume>11</volume>
    <elocation-id>126</elocation-id>
    <history>
      <date date-type="accepted">
        <day>29</day>
        <month>6</month>
        <year>2023</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>Copyright: © 2023 Mas-Sandoval A et al.</copyright-statement>
      <copyright-year>2023</copyright-year>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p>This is an open access article distributed under the terms of the Creative Commons Attribution Licence, which permits unrestricted use, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <self-uri content-type="pdf" xlink:href="f1000research-11-150492.pdf"/>
    <abstract>
      <p>A sound analysis of DNA sequencing data is important to extract meaningful information and infer quantities of interest. Sequencing and mapping errors coupled with low and variable coverage hamper the identification of genotypes and variants and the estimation of population genetic parameters. Methods and implementations to estimate population genetic parameters from sequencing data available nowadays either are suitable for the analysis of genomes from model organisms only, require moderate sequencing coverage, or are not easily adaptable to specific applications. To address these issues, we introduce ngsJulia, a collection of templates and functions in Julia language to process short-read sequencing data for population genetic analysis. We further describe two implementations, ngsPool and ngsPloidy, for the analysis of pooled sequencing data and polyploid genomes, respectively. Through simulations, we illustrate the performance of estimating various population genetic parameters using these implementations, using both established and novel statistical methods. These results inform on optimal experimental design and demonstrate the applicability of methods in ngsJulia to estimate parameters of interest even from low coverage sequencing data. ngsJulia provide users with a flexible and efficient framework for ad hoc analysis of sequencing data.ngsJulia is available from: https://github.com/mfumagalli/ngsJulia</p>
    </abstract>
    <kwd-group kwd-group-type="author">
      <kwd>high-throughput sequencing data</kwd>
      <kwd>population genetics</kwd>
      <kwd>genotype likelihoods</kwd>
      <kwd>Julia language</kwd>
      <kwd>pooled sequencing</kwd>
      <kwd>polyploidy</kwd>
      <kwd>aneuploidy</kwd>
    </kwd-group>
    <funding-group>
      <award-group id="fund-1">
        <funding-source>The Leverhulme Trust</funding-source>
        <award-id>RPG-2018-208</award-id>
      </award-group>
      <funding-statement>MF and AMS are funded The Leverhulme Research Project Grant RPG-2018-208.</funding-statement>
      <funding-statement>
        <italic toggle="yes">The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.</italic>
      </funding-statement>
    </funding-group>
  </article-meta>
  <notes notes-type="version-changes">
    <sec sec-type="version-changes">
      <label>Revised</label>
      <title>Amendments from Version 2</title>
      <p>In the revised version, we provide users with a comprehensive online documentation of APIs and CLIs at
<ext-link xlink:href="https://ngsjulia.readthedocs.io" ext-link-type="uri">https://ngsjulia.readthedocs.io</ext-link>. Additionally, all functions have docstring documentation. The methodology behind some of the implementations has been clarified and references on the applicability of said methods have been added. We also rephrased few sentences for clarity as suggested by the reviewer, and fixed few typos. We believe that these changes significantly enhance the user’s experience and simplify the interpretation of results obtained using ngsJulia.</p>
    </sec>
  </notes>
</front>
<body>
  <sec sec-type="intro" id="sec1">
    <title>Introduction</title>
    <p>Population genetics, i.e., the study of genetic variation within and between groups, plays a central role in evolutionary inferences. The quantification of genetic diversity serves the basis for the inference of neutral
<sup><xref rid="ref1" ref-type="bibr">1</xref></sup> and adaptive
<sup><xref rid="ref2" ref-type="bibr">2</xref></sup> events that characterised the history of different populations. Additionally, the comparison of allele frequencies between groups (i.e. cases and controls) is an important aspect in biomedical and clinical sciences.
<sup><xref rid="ref3" ref-type="bibr">3</xref></sup>
</p>
    <p>In the last 20 years, next-generation sequencing (NGS) technologies allowed researchers to generate unprecedented amount of genomic data for a wide range of organisms.
<sup><xref rid="ref4" ref-type="bibr">4</xref></sup> This revolution transformed population genetics (therefore also labelled as population genomics) to a data-driven discipline. Data produced by short-read sequencing machines (still the most accessible platform worldwide) consist of a collection of relatively short (approx. 100 base pairs) fragments of DNA which are then mapped or
<italic toggle="yes">de novo</italic> assembled to form a contiguous sequence.
<sup><xref rid="ref4" ref-type="bibr">4</xref></sup> At each genomic position, all observed sequenced reads are used to infer the per-sample genotype (an operation called ‘genotype calling’) and the inter-samples variability, i.e., whether a particular site is polymorphic (an operation called ‘single-nucleotide polymorphism (SNP) calling’).
<sup><xref rid="ref5" ref-type="bibr">5</xref></sup>
</p>
    <p>To this end, several software packages have been implemented to perform genotype and SNP calling from NGS data, the most popular ones being
<monospace>samtools/bcftools</monospace>,
<sup><xref rid="ref6" ref-type="bibr">6</xref></sup>
<monospace>GATK</monospace>,
<sup><xref rid="ref7" ref-type="bibr">7</xref></sup> and
<monospace>freeBayes</monospace>.
<sup><xref rid="ref8" ref-type="bibr">8</xref></sup> When, on average, few reads map at each genomic position (a scenario referred to as ‘low-coverage’ or ‘low-depth’), genotypes and SNPs cannot be assigned with confidence due to the high data uncertainty.
<sup><xref rid="ref9" ref-type="bibr">9</xref></sup>
<sup>,</sup>
<sup><xref rid="ref10" ref-type="bibr">10</xref></sup> Under these circumstances, statistical methods that integrate data uncertainty into genotype likelihoods and propagate it to downstream analyses have been proposed.
<sup><xref rid="ref5" ref-type="bibr">5</xref></sup> Software packages like
<monospace>ANGSD</monospace>
<sup><xref rid="ref11" ref-type="bibr">11</xref></sup> and
<monospace>ngsTools,</monospace>
<sup><xref rid="ref12" ref-type="bibr">12</xref></sup> among others reviewed by Lou
<italic toggle="yes">et al.,</italic>
<sup><xref rid="ref13" ref-type="bibr">13</xref></sup> implement a statistical framework to estimate population genetic metrics from low-coverage sequencing data. Similarly, an affordable generation of sequencing data from large sample sizes can be obtained via pooled sequencing experiments, where assignment of individual samples is typically not retained.
<sup><xref rid="ref14" ref-type="bibr">14</xref></sup> Several new and popular software for the analysis of pooled sequencing have been proposed in recent years.
<sup><xref rid="ref15" ref-type="bibr">15</xref></sup>
<sup>,</sup>
<sup><xref rid="ref16" ref-type="bibr">16</xref></sup>
</p>
    <p>Despite these advances, most of these implementations are either tuned and suitable for model organisms only (e.g., with haploid or diploid genomes) or not easily adaptable to novel applications. Therefore, an accessible computational framework for building and testing
<italic toggle="yes">ad hoc</italic> population genetic analyses from NGS data is in dire need. Among programming languages,
<monospace>Julia</monospace>
<sup><xref rid="ref17" ref-type="bibr">17</xref></sup> has emerged as both a powerful and easy-to-use dynamically typed language that is widely used in many fields of data sciences, including genomics.
<sup><xref rid="ref18" ref-type="bibr">18</xref></sup> While several
<monospace>Julia</monospace> packages are currently available for both population genetic and bioinformatic analyses (e.g.,
<ext-link xlink:href="https://github.com/BioJulia" ext-link-type="uri">BioJulia</ext-link>), to our knowledge, a suitable framework for custom population genetic analysis from NGS data is not available yet.</p>
    <p>Here we present
<monospace>ngsJulia</monospace>, a set of templates and functions in
<monospace>Julia</monospace> language to process NGS data and create custom analyses in population genetics. To illustrate its applicability, we further introduce two implementations,
<monospace>ngsPool</monospace> and
<monospace>ngsPloidy</monospace>, for the analysis of pooled sequencing data and polyploid genomes, respectively. By extensive simulations, we show the performance of several methods implemented in these programs under various experimental conditions. We also introduce novel statistical methods to estimate population genetic parameters from NGS data and demonstrate their applicability and suggest optimal experimental design. We finally discuss further directions and purposes for
<monospace>ngsJulia</monospace> and bioinformatics for NGS data analysis.</p>
  </sec>
  <sec sec-type="methods" id="sec2">
    <title>Methods</title>
    <sec id="sec3">
      <title>Implementation</title>
      <p><monospace>ngsJulia</monospace> was built in
<monospace>Julia</monospace> language (Julia Programming Language, RRID:SCR_021666) and requires the packages ‘GZip’, ‘Combinatorics’, and ‘ArgParse’. Auxiliary scripts to process output files were built in
<monospace>R</monospace> (
<monospace>R</monospace> Project for Statistical Computing, RRID:SCR_001905) version 3.6.3 and require the package ‘getopt’.
<monospace>ngsJulia</monospace> receives gzipped mpileup input files which can be generated using
<monospace>samtools</monospace>.
<sup><xref rid="ref19" ref-type="bibr">19</xref></sup> Output files are in text file format and can be easily parsed for producing summary plots and for further analyses. Scripts for some downstream analyses are provided in
<monospace>ngsJulia</monospace>.</p>
    </sec>
    <sec id="sec4">
      <title>Operation</title>
      <p><monospace>ngsJulia</monospace> is compatible with all major operating systems and is maintained at
<ext-link xlink:href="https://github.com/mfumagalli/ngsJulia" ext-link-type="uri">https://github.com/mfumagalli/ngsJulia</ext-link>. Documentation and tutorials are available via this GitHub repository and archived at Zenodo
<sup><xref rid="ref20" ref-type="bibr">20</xref></sup> at the time of writing. All analyses in the manuscript are performed in
<monospace>Julia</monospace> language and
<monospace>R</monospace>.</p>
      <p><monospace>ngsJulia</monospace> implements functions to read and parse gzipped mpileup files and to output gzipped text files on various calculations (e.g., genotype and allele frequency likelihoods) and estimations (e.g., allele frequencies), as requested by the user.
<monospace>ngsJulia</monospace> also allows for several data filtering options, including on global and per-sample depth, proportion or count of minor allele, and base quality. Finally, several options for SNP and biallelic and triallelic polymorphisms calling are available.</p>
    </sec>
    <sec id="sec5">
      <title>Nucleotide, genotype and allele frequency likelihoods</title>
      <p><monospace>ngsJulia</monospace> provides utilities to calculate nucleotide and genotype likelihoods, i.e., the probability of observed sequencing data given a specific nucleotide or genotype,
<sup><xref rid="ref21" ref-type="bibr">21</xref></sup> for an arbitrary ploidy level, as in Soraggi
<italic toggle="yes">et al.</italic>
<sup><xref rid="ref22" ref-type="bibr">22</xref></sup> We now describe how such quantities are calculated in
<monospace>ngsJulia</monospace>.</p>
      <p>Following the notation in Soraggi
<italic toggle="yes">et al.,</italic>
<sup><xref rid="ref22" ref-type="bibr">22</xref></sup> for one sample and one site, we let
<inline-formula><mml:math id="M1" display="inline" overflow="scroll"><mml:mi>O</mml:mi></mml:math></inline-formula> be the observed NGS data,
<inline-formula><mml:math id="M2" display="inline" overflow="scroll"><mml:mi>Y</mml:mi></mml:math></inline-formula> the ploidy, and
<inline-formula><mml:math id="M3" display="inline" overflow="scroll"><mml:mi>G</mml:mi></mml:math></inline-formula> the genotype. Therefore,
<inline-formula><mml:math id="M4" display="inline" overflow="scroll"><mml:mi>G</mml:mi></mml:math></inline-formula> has values in
<inline-formula><mml:math id="M5" display="inline" overflow="scroll"><mml:mfenced close="}" open="{" separators=",,,"><mml:mn>0</mml:mn><mml:mn>1</mml:mn><mml:mo>…</mml:mo><mml:mi>Y</mml:mi></mml:mfenced></mml:math></inline-formula>, i.e., the number of derived (or alternate) alleles.</p>
      <p>In the simplest form, genotype likelihoods can be calculated by considering individual base qualities as probabilities of observing an incorrect nucleotide.
<sup><xref rid="ref21" ref-type="bibr">21</xref></sup> We adopt the calculation of genotype likelihoods for an arbitrary ploidy level
<inline-formula><mml:math id="M6" display="inline" overflow="scroll"><mml:mi>P</mml:mi><mml:mfenced close=")" open="(" separators="|,"><mml:mi>O</mml:mi><mml:mi>G</mml:mi><mml:mi>Y</mml:mi></mml:mfenced></mml:math></inline-formula> as proposed in Soraggi
<italic toggle="yes">et al.</italic>
<sup><xref rid="ref22" ref-type="bibr">22</xref></sup> From the genotype likelihoods with
<inline-formula><mml:math id="M7" display="inline" overflow="scroll"><mml:mi>P</mml:mi><mml:mfenced close=")" open="(" separators="|,"><mml:mi>O</mml:mi><mml:mi>G</mml:mi><mml:mrow><mml:mi>Y</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfenced></mml:math></inline-formula>, the two most likely alleles are identified by sorting
<inline-formula><mml:math id="M8" display="inline" overflow="scroll"><mml:mi>P</mml:mi><mml:mfenced close=")" open="(" separators="|,"><mml:mi>O</mml:mi><mml:mi>G</mml:mi><mml:mrow><mml:mi>Y</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfenced></mml:math></inline-formula> values after pooling all sequencing reads together across all samples. This operation will restrict the range of possible genotypes to biallelic variation only. Note that this calculation is still valid for monomorphic sites, although the actual assignment of the minor allele is meaningless.</p>
      <p>We now describe how to estimate
<inline-formula><mml:math id="M9" display="inline" overflow="scroll"><mml:msub><mml:mi>F</mml:mi><mml:mrow><mml:mi>a</mml:mi><mml:mo>,</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>, the frequency of allele
<inline-formula><mml:math id="M10" display="inline" overflow="scroll"><mml:mi>a</mml:mi><mml:mo>∈</mml:mo><mml:mfenced close="}" open="{" separators=",,,"><mml:mi>A</mml:mi><mml:mi>C</mml:mi><mml:mi>G</mml:mi><mml:mi>T</mml:mi></mml:mfenced></mml:math></inline-formula> at site
<inline-formula><mml:math id="M11" display="inline" overflow="scroll"><mml:mi>n</mml:mi></mml:math></inline-formula>. Similarly to Kim
<italic toggle="yes">et al.</italic>,
<sup><xref rid="ref23" ref-type="bibr">23</xref></sup> the log-likelihood function for
<inline-formula><mml:math id="M12" display="inline" overflow="scroll"><mml:msub><mml:mi>F</mml:mi><mml:mrow><mml:mi>a</mml:mi><mml:mo>,</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> is given by:
<disp-formula id="e1"><mml:math id="M13" display="block" overflow="scroll"><mml:mo>log</mml:mo><mml:mfenced close=")" open="("><mml:mrow><mml:mi>P</mml:mi><mml:mfenced close=")" open="(" separators="|"><mml:msub><mml:mi>O</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:msub><mml:mi>F</mml:mi><mml:mrow><mml:mi>a</mml:mi><mml:mo>,</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:msub></mml:mfenced></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:munderover><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:msub><mml:mi>C</mml:mi><mml:mi>n</mml:mi></mml:msub></mml:munderover><mml:mi>P</mml:mi><mml:mfenced close=")" open="(" separators="|,"><mml:msub><mml:mi>O</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mrow><mml:msub><mml:mi>c</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>a</mml:mi></mml:mrow><mml:mrow><mml:mi>Y</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfenced><mml:msub><mml:mi>F</mml:mi><mml:mi>n</mml:mi></mml:msub></mml:math><label>(1)</label></disp-formula>where
<inline-formula><mml:math id="M14" display="inline" overflow="scroll"><mml:msub><mml:mi>c</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> is the
<inline-formula><mml:math id="M15" display="inline" overflow="scroll"><mml:mi>i</mml:mi><mml:mo>−</mml:mo><mml:mi mathvariant="italic">th</mml:mi></mml:math></inline-formula> read at site
<inline-formula><mml:math id="M16" display="inline" overflow="scroll"><mml:mi>n</mml:mi></mml:math></inline-formula>, and
<inline-formula><mml:math id="M17" display="inline" overflow="scroll"><mml:msub><mml:mi>C</mml:mi><mml:mi>n</mml:mi></mml:msub></mml:math></inline-formula> is the total depth across all samples.
<xref rid="e1" ref-type="disp-formula">Function 1</xref> is maximised to obtain a maximum likelihood estimate (MLE) of the sample allele frequency,
<inline-formula><mml:math id="M18" display="inline" overflow="scroll"><mml:msub><mml:mover accent="true"><mml:mi>F</mml:mi><mml:mo stretchy="true">^</mml:mo></mml:mover><mml:mi>n</mml:mi></mml:msub></mml:math></inline-formula>, either with a grid- or golden-section- search algorithm.</p>
    </sec>
    <sec id="sec6">
      <title>SNP calling</title>
      <p>To perform SNP calling, we implement a likelihood-ratio test (LRT) with one degree of freedom with null hypothesis
<inline-formula><mml:math id="M19" display="inline" overflow="scroll"><mml:msub><mml:mi>H</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>:</mml:mo><mml:msub><mml:mi>F</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:math></inline-formula> and alternate hypothesis
<inline-formula><mml:math id="M20" display="inline" overflow="scroll"><mml:msub><mml:mi>H</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>:</mml:mo><mml:msub><mml:mi>F</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>F</mml:mi><mml:mo stretchy="true">^</mml:mo></mml:mover><mml:mi>n</mml:mi></mml:msub></mml:math></inline-formula>, as described by Kim
<italic toggle="yes">et al.</italic>
<sup><xref rid="ref23" ref-type="bibr">23</xref></sup> Additionally, we develop a test for a site being biallelic or triallelic. The former can be interpreted as a further evidence of polymorphism, while the latter as a condition not to be met for the site being included in further estimations, as our models assume at most two alleles. The log-likelihood of site
<inline-formula><mml:math id="M21" display="inline" overflow="scroll"><mml:mi>n</mml:mi></mml:math></inline-formula> being biallelic is equal to
<inline-formula><mml:math id="M22" display="inline" overflow="scroll"><mml:mi>P</mml:mi><mml:mfenced close=")" open="(" separators="|,"><mml:msub><mml:mi>O</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mrow><mml:msub><mml:mi>G</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mfenced close="}" open="{" separators=","><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mfenced></mml:mrow><mml:mrow><mml:mi>Y</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfenced></mml:math></inline-formula> while the log-likelihood being triallelic is equal to
<inline-formula><mml:math id="M23" display="inline" overflow="scroll"><mml:mi>P</mml:mi><mml:mfenced close=")" open="(" separators="|,"><mml:msub><mml:mi>O</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mrow><mml:msub><mml:mi>G</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mfenced close="}" open="{" separators=",,"><mml:mi>i</mml:mi><mml:mi>j</mml:mi><mml:mi>z</mml:mi></mml:mfenced></mml:mrow><mml:mrow><mml:mi>Y</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfenced></mml:math></inline-formula>, with
<inline-formula><mml:math id="M24" display="inline" overflow="scroll"><mml:mi>i</mml:mi></mml:math></inline-formula>,
<inline-formula><mml:math id="M25" display="inline" overflow="scroll"><mml:mi>j</mml:mi></mml:math></inline-formula>, and
<inline-formula><mml:math id="M26" display="inline" overflow="scroll"><mml:mi>z</mml:mi></mml:math></inline-formula> being the most, second most, and third most likely allele with
<inline-formula><mml:math id="M27" display="inline" overflow="scroll"><mml:mi>Y</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:math></inline-formula> (i.e. haploid genotype
<inline-formula><mml:math id="M28" display="inline" overflow="scroll"><mml:mi>G</mml:mi></mml:math></inline-formula>), respectively. An LRT with one degree of freedom can be conducted to assess whether
<inline-formula><mml:math id="M29" display="inline" overflow="scroll"><mml:mi>P</mml:mi><mml:mfenced close=")" open="(" separators="|,"><mml:msub><mml:mi>O</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mrow><mml:msub><mml:mi>G</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>Y</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfenced></mml:math></inline-formula> is significantly greater than
<inline-formula><mml:math id="M30" display="inline" overflow="scroll"><mml:mi>P</mml:mi><mml:mfenced close=")" open="(" separators="|,"><mml:msub><mml:mi>O</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mrow><mml:msub><mml:mi>G</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mfenced close="}" open="{" separators=","><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mfenced></mml:mrow><mml:mrow><mml:mi>Y</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfenced></mml:math></inline-formula>, or the latter is significantly greater than
<inline-formula><mml:math id="M31" display="inline" overflow="scroll"><mml:mi>P</mml:mi><mml:mfenced close=")" open="(" separators="|,"><mml:msub><mml:mi>O</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mrow><mml:msub><mml:mi>G</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mfenced close="}" open="{" separators=",,"><mml:mi>i</mml:mi><mml:mi>j</mml:mi><mml:mi>z</mml:mi></mml:mfenced></mml:mrow><mml:mrow><mml:mi>Y</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfenced></mml:math></inline-formula>.</p>
    </sec>
    <sec id="sec7">
      <title>Allele frequency, site frequency spectrum and association test from pooled sequencing data</title>
      <p>Several estimators of population parameters from pooled sequencing data are implemented in
<monospace>ngsPool</monospace>, a separate program which uses functions in
<monospace>ngsJulia</monospace>. We now describe the statistical framework for the analysis of pooled sequencing data.</p>
      <p>In case of data with unknown sample size, the MLE of the population allele frequency
<inline-formula><mml:math id="M32" display="inline" overflow="scroll"><mml:msub><mml:mi>F</mml:mi><mml:mi>n</mml:mi></mml:msub></mml:math></inline-formula> is calculated as in
<xref rid="e1" ref-type="disp-formula">Equation 1</xref> with
<inline-formula><mml:math id="M33" display="inline" overflow="scroll"><mml:mi>F</mml:mi><mml:mo>∈</mml:mo><mml:mfenced close=")" open="(" separators=","><mml:mn>0</mml:mn><mml:mn>1</mml:mn></mml:mfenced></mml:math></inline-formula>. With known sample size, the same equation is used to calculate sample allele frequency likelihoods
<inline-formula><mml:math id="M34" display="inline" overflow="scroll"><mml:mi>P</mml:mi><mml:mfenced close=")" open="(" separators="|"><mml:msub><mml:mi>O</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mrow><mml:msub><mml:mi>F</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mi>f</mml:mi></mml:mrow></mml:mfenced></mml:math></inline-formula>
<sub>,</sub>
<sup><xref rid="ref24" ref-type="bibr">24</xref></sup> for instance with
<inline-formula><mml:math id="M35" display="inline" overflow="scroll"><mml:mi>f</mml:mi><mml:mo>∈</mml:mo><mml:mfenced close="}" open="{" separators=",,,"><mml:mn>0</mml:mn><mml:mn>1</mml:mn><mml:mo>…</mml:mo><mml:mrow><mml:mi>M</mml:mi><mml:mo>×</mml:mo><mml:mi>Y</mml:mi></mml:mrow></mml:mfenced></mml:math></inline-formula> for
<inline-formula><mml:math id="M36" display="inline" overflow="scroll"><mml:mi>M</mml:mi></mml:math></inline-formula> samples of equal ploidy
<inline-formula><mml:math id="M37" display="inline" overflow="scroll"><mml:mi>Y</mml:mi></mml:math></inline-formula>. From these likelihoods, we can calculate both the MLE and the expected value with uniform prior probability as estimators of
<inline-formula><mml:math id="M38" display="inline" overflow="scroll"><mml:msub><mml:mi>F</mml:mi><mml:mi>n</mml:mi></mml:msub></mml:math></inline-formula>.</p>
      <p>A simple estimator of the site frequency spectrum (SFS) from pooled sequencing data is obtained by counting point-estimates of
<inline-formula><mml:math id="M39" display="inline" overflow="scroll"><mml:msub><mml:mi>F</mml:mi><mml:mi>n</mml:mi></mml:msub></mml:math></inline-formula> across all sites. We propose a novel estimator of the SFS implemented in
<monospace>ngsPool</monospace>. Under the standard coalescent model with infinite sites mutations, we let the probability of derived allele frequency
<inline-formula><mml:math id="M40" display="inline" overflow="scroll"><mml:mi>F</mml:mi></mml:math></inline-formula> in a sample of
<inline-formula><mml:math id="M41" display="inline" overflow="scroll"><mml:mi>N</mml:mi></mml:math></inline-formula> genomes
<inline-formula><mml:math id="M42" display="inline" overflow="scroll"><mml:mi>P</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:mi>F</mml:mi><mml:mo>=</mml:mo><mml:mi>f</mml:mi></mml:mrow></mml:mfenced></mml:math></inline-formula> to be proportional to
<inline-formula><mml:math id="M43" display="inline" overflow="scroll"><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:msup><mml:mi>f</mml:mi><mml:mi>K</mml:mi></mml:msup></mml:math></inline-formula> with
<inline-formula><mml:math id="M44" display="inline" overflow="scroll"><mml:mi>f</mml:mi><mml:mo>∈</mml:mo><mml:mfenced close="}" open="{" separators=",,"><mml:mn>1</mml:mn><mml:mo>…</mml:mo><mml:mrow><mml:mi>N</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfenced></mml:math></inline-formula>
<sub>.</sub>
<sup><xref rid="ref25" ref-type="bibr">25</xref></sup> The parameter
<inline-formula><mml:math id="M45" display="inline" overflow="scroll"><mml:mi>K</mml:mi></mml:math></inline-formula> determines whether the population is deviating from a model of constant effective population size. For instance,
<inline-formula><mml:math id="M46" display="inline" overflow="scroll"><mml:mi>K</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:math></inline-formula> is equal to the expected distribution of
<inline-formula><mml:math id="M47" display="inline" overflow="scroll"><mml:mi>P</mml:mi><mml:mfenced close=")" open="("><mml:mi>F</mml:mi></mml:mfenced></mml:math></inline-formula> under constant population size, while
<inline-formula><mml:math id="M48" display="inline" overflow="scroll"><mml:mi>K</mml:mi><mml:mo>&gt;</mml:mo><mml:mn>1</mml:mn></mml:math></inline-formula> models a population shrinking and
<inline-formula><mml:math id="M49" display="inline" overflow="scroll"><mml:mi>K</mml:mi><mml:mo>&lt;</mml:mo><mml:mn>1</mml:mn></mml:math></inline-formula> population growth.</p>
      <p>We optimise the value of
<inline-formula><mml:math id="M50" display="inline" overflow="scroll"><mml:mi>K</mml:mi></mml:math></inline-formula> to minimise the Kullback-Liebrel divergence between the expected distribution of
<inline-formula><mml:math id="M51" display="inline" overflow="scroll"><mml:mi>P</mml:mi><mml:mfenced close=")" open="(" separators="|"><mml:mi>F</mml:mi><mml:mi>K</mml:mi></mml:mfenced></mml:math></inline-formula> and the observed SFS. The latter can be obtained by either counting
<inline-formula><mml:math id="M52" display="inline" overflow="scroll"><mml:msub><mml:mover accent="true"><mml:mi>F</mml:mi><mml:mo stretchy="true">^</mml:mo></mml:mover><mml:mi>n</mml:mi></mml:msub></mml:math></inline-formula> across all sites or by integrating over the sample allele frequency probabilities
<inline-formula><mml:math id="M53" display="inline" overflow="scroll"><mml:mi>P</mml:mi><mml:mfenced close=")" open="(" separators="|"><mml:mrow><mml:msub><mml:mi>F</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mi>f</mml:mi></mml:mrow><mml:msub><mml:mi>O</mml:mi><mml:mi>n</mml:mi></mml:msub></mml:mfenced><mml:mo>∝</mml:mo><mml:mi>P</mml:mi><mml:mfenced close=")" open="(" separators="|"><mml:msub><mml:mi>O</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mrow><mml:msub><mml:mi>F</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mi>f</mml:mi></mml:mrow></mml:mfenced></mml:math></inline-formula> (
<italic toggle="yes">i.e.</italic> with a uniform prior distribution). A threshold can be set to ignore allele frequencies with low probability to improve computing efficiency and reduce noise. Within this framework, folding spectra can be generated in case of unknown allelic polarisation.</p>
      <p>Finally, we introduce a strategy to perform association tests from pooled sequencing data. Similarly to Kim
<italic toggle="yes">et al.,</italic>
<sup><xref rid="ref23" ref-type="bibr">23</xref></sup> we propose an LRT with one degree of freedom for null hypothesis
<inline-formula><mml:math id="M54" display="inline" overflow="scroll"><mml:msub><mml:mi>H</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>:</mml:mo><mml:msub><mml:mi>f</mml:mi><mml:mtext mathvariant="italic">cases</mml:mtext></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>f</mml:mi><mml:mtext mathvariant="italic">controls</mml:mtext></mml:msub></mml:math></inline-formula> and alternate hypothesis
<inline-formula><mml:math id="M55" display="inline" overflow="scroll"><mml:msub><mml:mi>H</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>:</mml:mo><mml:msub><mml:mi>f</mml:mi><mml:mtext mathvariant="italic">cases</mml:mtext></mml:msub><mml:mo>≠</mml:mo><mml:msub><mml:mi>f</mml:mi><mml:mtext mathvariant="italic">controls</mml:mtext></mml:msub></mml:math></inline-formula>. The likelihood of each hypothesis is calculated from
<inline-formula><mml:math id="M56" display="inline" overflow="scroll"><mml:mi>P</mml:mi><mml:mfenced close=")" open="(" separators="|"><mml:msub><mml:mi>O</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mrow><mml:msub><mml:mi>F</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mi>f</mml:mi></mml:mrow></mml:mfenced></mml:math></inline-formula> and, therefore, this strategy avoids the assignment of counts or per-site allele frequencies. A statistically significant LRT with one degree of freedom suggests a difference in allele frequencies between cases and controls, and possible association between the tested phenotype and alleles.</p>
    </sec>
    <sec id="sec8">
      <title>Ploidy levels and test for multiploidy</title>
      <p>We now describe the statistical framework implemented in the program
<monospace>ngsPloidy</monospace> to estimate ploidy levels and test for multiploidy. When multiple samples are available, two scenarios can be envisaged: (i) all samples have the same ploidy, (ii) each sample can have a different ploidy (multiploidy, i.e. as in tumor genomes).
<sup><xref rid="ref26" ref-type="bibr">26</xref></sup>
</p>
      <p>The log-likelihood function for a vector of ploidy levels
<inline-formula><mml:math id="M57" display="inline" overflow="scroll"><mml:msub><mml:mover accent="true"><mml:mi>Y</mml:mi><mml:mo stretchy="true">→</mml:mo></mml:mover><mml:mi>M</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mfenced close="}" open="{" separators=",,,"><mml:mrow><mml:msub><mml:mi>Y</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mi>Y</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow><mml:mo>…</mml:mo><mml:mrow><mml:msub><mml:mi>Y</mml:mi><mml:mi>M</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mi>M</mml:mi></mml:msub></mml:mrow></mml:mfenced></mml:math></inline-formula> for
<inline-formula><mml:math id="M58" display="inline" overflow="scroll"><mml:mi>M</mml:mi></mml:math></inline-formula> samples and
<inline-formula><mml:math id="M59" display="inline" overflow="scroll"><mml:mi>N</mml:mi></mml:math></inline-formula> sites is defined as:
<disp-formula id="e2"><mml:math id="M60" display="block" overflow="scroll"><mml:mo>log</mml:mo><mml:mo stretchy="true">(</mml:mo><mml:mi>P</mml:mi><mml:mfenced close=")" open="(" separators="|"><mml:mi>O</mml:mi><mml:mrow><mml:mi>Y</mml:mi><mml:mo>=</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>Y</mml:mi><mml:mo stretchy="true">→</mml:mo></mml:mover><mml:mi>M</mml:mi></mml:msub></mml:mrow></mml:mfenced><mml:mo stretchy="true">)</mml:mo><mml:mo>=</mml:mo><mml:munderover><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mi>m</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>M</mml:mi></mml:munderover><mml:munderover><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>N</mml:mi></mml:munderover><mml:mo>log</mml:mo><mml:mfenced close=")" open="("><mml:mrow><mml:munder><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>∈</mml:mo><mml:mfenced close="}" open="{" separators=",,,"><mml:mn>0</mml:mn><mml:mn>1</mml:mn><mml:mo>…</mml:mo><mml:msub><mml:mi>Y</mml:mi><mml:mi>m</mml:mi></mml:msub></mml:mfenced></mml:mrow></mml:munder><mml:mi>P</mml:mi><mml:mfenced close=")" open="(" separators="|,"><mml:msub><mml:mi>O</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mrow><mml:msub><mml:mi>G</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mi>Y</mml:mi><mml:mi>m</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mi>m</mml:mi></mml:msub></mml:mrow></mml:mfenced><mml:mi>P</mml:mi><mml:mfenced close=")" open="(" separators="|,"><mml:mrow><mml:msub><mml:mi>G</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mi>Y</mml:mi><mml:mi>m</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mi>m</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mi>F</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>F</mml:mi><mml:mo stretchy="true">^</mml:mo></mml:mover><mml:mi>n</mml:mi></mml:msub></mml:mrow></mml:mfenced></mml:mrow></mml:mfenced></mml:math><label>(2)</label></disp-formula>
</p>
      <p>With
<inline-formula><mml:math id="M61" display="inline" overflow="scroll"><mml:msub><mml:mover accent="true"><mml:mi>F</mml:mi><mml:mo stretchy="true">^</mml:mo></mml:mover><mml:mi>n</mml:mi></mml:msub></mml:math></inline-formula> being the MLE of allele frequency at site
<inline-formula><mml:math id="M62" display="inline" overflow="scroll"><mml:mi>n</mml:mi></mml:math></inline-formula>.
<inline-formula><mml:math id="M63" display="inline" overflow="scroll"><mml:mi>P</mml:mi><mml:mfenced close=")" open="(" separators="|,"><mml:msub><mml:mi>O</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mrow><mml:msub><mml:mi>G</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mi>Y</mml:mi><mml:mi>m</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mi>m</mml:mi></mml:msub></mml:mrow></mml:mfenced></mml:math></inline-formula> is the genotype likelihood while
<inline-formula><mml:math id="M64" display="inline" overflow="scroll"><mml:mi>P</mml:mi><mml:mfenced close=")" open="(" separators="|,"><mml:mrow><mml:msub><mml:mi>G</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mi>Y</mml:mi><mml:mi>m</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mi>m</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mi>F</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>F</mml:mi><mml:mo stretchy="true">^</mml:mo></mml:mover><mml:mi>n</mml:mi></mml:msub></mml:mrow></mml:mfenced></mml:math></inline-formula> is the genotype probability given the ploidy and allele frequency at site
<inline-formula><mml:math id="M65" display="inline" overflow="scroll"><mml:mi>n</mml:mi></mml:math></inline-formula>.</p>
      <p>Once
<inline-formula><mml:math id="M66" display="inline" overflow="scroll"><mml:msub><mml:mover accent="true"><mml:mi>F</mml:mi><mml:mo stretchy="true">^</mml:mo></mml:mover><mml:mi>n</mml:mi></mml:msub></mml:math></inline-formula> is estimated and the inbreeding is known (or under the assumption of Hardy-Weinberg Equilibrium (HWE)), then genotype probabilities are fully defined.
<xref rid="e2" ref-type="disp-formula">Equation 2</xref> is optimised by maximising the marginal likelihood of each sample separately, assuming independence among samples and sites.</p>
      <p>With limited sample size,
<inline-formula><mml:math id="M67" display="inline" overflow="scroll"><mml:msub><mml:mover accent="true"><mml:mi>F</mml:mi><mml:mo stretchy="true">^</mml:mo></mml:mover><mml:mi>n</mml:mi></mml:msub></mml:math></inline-formula> is not a good estimator of the population allele frequency and therefore genotype probabilities may not be well defined. In the simplest scenario, genotype probabilities can be set as uniformly distributed, with all genotypes being equally probable. However, the assignment of alleles into ancestral (e.g., wild-type) and derived (e.g., mutant) states is particularly useful to inform on genotype probabilities. Recalling
<xref rid="e2" ref-type="disp-formula">Equation 2</xref>, we can substitute
<inline-formula><mml:math id="M68" display="inline" overflow="scroll"><mml:mi>P</mml:mi><mml:mfenced close=")" open="(" separators="|,"><mml:mrow><mml:msub><mml:mi>G</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mi>Y</mml:mi><mml:mi>m</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mi>m</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mi>F</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>F</mml:mi><mml:mo stretchy="true">^</mml:mo></mml:mover><mml:mi>n</mml:mi></mml:msub></mml:mrow></mml:mfenced></mml:math></inline-formula> with
<inline-formula><mml:math id="M69" display="inline" overflow="scroll"><mml:mi>P</mml:mi><mml:mfenced close=")" open="(" separators="|,"><mml:mrow><mml:msub><mml:mi>G</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mi>Y</mml:mi><mml:mi>m</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mi>m</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mi>F</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mi mathvariant="bold">E</mml:mi><mml:mfenced close="]" open="[" separators="|"><mml:mi>F</mml:mi><mml:mi>K</mml:mi></mml:mfenced></mml:mrow></mml:mfenced><mml:mo stretchy="true">)</mml:mo></mml:math></inline-formula>, where
<inline-formula><mml:math id="M70" display="inline" overflow="scroll"><mml:mi mathvariant="bold">E</mml:mi><mml:mfenced close="]" open="[" separators="|"><mml:mi>F</mml:mi><mml:mi>K</mml:mi></mml:mfenced></mml:math></inline-formula> is the expected allele frequency of
<inline-formula><mml:math id="M71" display="inline" overflow="scroll"><mml:mi>P</mml:mi><mml:mfenced close=")" open="(" separators="|"><mml:mrow><mml:mi>F</mml:mi><mml:mo>=</mml:mo><mml:mi>f</mml:mi></mml:mrow><mml:mi>K</mml:mi></mml:mfenced><mml:mo>∝</mml:mo><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:msup><mml:mi>f</mml:mi><mml:mi>K</mml:mi></mml:msup></mml:math></inline-formula>, as introduced previously. Note that
<inline-formula><mml:math id="M72" display="inline" overflow="scroll"><mml:mi mathvariant="bold">E</mml:mi><mml:mfenced close="]" open="[" separators="|"><mml:mi>F</mml:mi><mml:mi>K</mml:mi></mml:mfenced></mml:math></inline-formula> does not depend on the sequencing data for each specific site
<inline-formula><mml:math id="M73" display="inline" overflow="scroll"><mml:mi>n</mml:mi></mml:math></inline-formula>.</p>
      <p>Note that, in practice,
<xref rid="e2" ref-type="disp-formula">Equation 2</xref> is a composite likelihood function, as samples and sites are not independent observations due to shared population history and linkage disequilibrium, respectively. A solution to circumvent this issue is to perform a bootstrapping procedure, by sampling with replacement segments of the chromosome and estimate ploidy for each bootstrapped chromosome. The distribution of inferred ploidy levels from bootstrapped chromosomes provides a quantitative measurement of confidence in determining the chromosomal ploidy. It is not possible to calculate the likelihood of ploidy equal to one after SNP calling. Nevertheless, the identification of haploid genomes from sequencing data is typically trivial.</p>
    </sec>
    <sec id="sec9">
      <title>Unknown or uncertain ancestral allelic state</title>
      <p>So far, we assumed to know which allele can be assigned to an ancestral state, and which one to a derived state. However, in some cases, such assignment is either not possible or associated with a certain level of uncertainty due to, for instance, ancestral polymorphisms or outgroup sequence genome from a closely related species not being available. Under these circumstances, we extend our formulation by adding a parameter underlying the probability that the assigned ancestral state is incorrectly identified.</p>
      <p>Let us define
<inline-formula><mml:math id="M74" display="inline" overflow="scroll"><mml:mi>R</mml:mi></mml:math></inline-formula> as the ancestral state and
<inline-formula><mml:math id="M75" display="inline" overflow="scroll"><mml:mi>a</mml:mi></mml:math></inline-formula> as any possible allele in
<inline-formula><mml:math id="M76" display="inline" overflow="scroll"><mml:mfenced close="}" open="{" separators=",,,"><mml:mi>A</mml:mi><mml:mi>C</mml:mi><mml:mi>G</mml:mi><mml:mi>T</mml:mi></mml:mfenced></mml:math></inline-formula>. In practice,
<inline-formula><mml:math id="M77" display="inline" overflow="scroll"><mml:mi>a</mml:mi></mml:math></inline-formula> can take only two possible values as we select only the two most likely alleles. We label this set of the two most common alleles as
<inline-formula><mml:math id="M78" display="inline" overflow="scroll"><mml:mi>A</mml:mi></mml:math></inline-formula> and we assume that the true ancestral state is included in such set. The log-likelihood function of ploidy for a single sample
<inline-formula><mml:math id="M79" display="inline" overflow="scroll"><mml:mi>m</mml:mi></mml:math></inline-formula> under unknown ancestral state is:
<disp-formula id="e3"><mml:math id="M80" display="block" overflow="scroll"><mml:mo>log</mml:mo><mml:mo stretchy="true">(</mml:mo><mml:mi>P</mml:mi><mml:mfenced close=")" open="(" separators="|"><mml:mi>O</mml:mi><mml:mrow><mml:msub><mml:mi>Y</mml:mi><mml:mi>M</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mi>m</mml:mi></mml:msub></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:munderover><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>N</mml:mi></mml:munderover><mml:mo>log</mml:mo><mml:mfenced close=")" open="("><mml:mrow><mml:munder><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mi>a</mml:mi><mml:mo>∈</mml:mo><mml:mi>A</mml:mi></mml:mrow></mml:munder><mml:munder><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>∈</mml:mo><mml:mfenced close="}" open="{" separators=",,,"><mml:mn>0</mml:mn><mml:mn>1</mml:mn><mml:mo>…</mml:mo><mml:msub><mml:mi>Y</mml:mi><mml:mi>m</mml:mi></mml:msub></mml:mfenced></mml:mrow></mml:munder><mml:mi>P</mml:mi><mml:mfenced close=")" open="(" separators="|,"><mml:msub><mml:mi>O</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mrow><mml:msub><mml:mi>G</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mi>Y</mml:mi><mml:mi>m</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mi>m</mml:mi></mml:msub></mml:mrow></mml:mfenced><mml:mi>P</mml:mi><mml:mfenced close=")" open="(" separators="|,,"><mml:mrow><mml:msub><mml:mi>G</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mi>Y</mml:mi><mml:mi>m</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mi>m</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:mi>R</mml:mi><mml:mo>=</mml:mo><mml:mi>a</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mi>F</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>F</mml:mi><mml:mo stretchy="true">^</mml:mo></mml:mover><mml:mi>n</mml:mi></mml:msub></mml:mrow></mml:mfenced><mml:mi>P</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:mi>R</mml:mi><mml:mo>=</mml:mo><mml:mi>a</mml:mi></mml:mrow></mml:mfenced></mml:mrow></mml:mfenced></mml:math><label>(3)</label></disp-formula>
</p>
      <p>Where
<inline-formula><mml:math id="M81" display="inline" overflow="scroll"><mml:mi>P</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:mi>R</mml:mi><mml:mo>=</mml:mo><mml:mi>a</mml:mi></mml:mrow></mml:mfenced></mml:math></inline-formula> indicates the probability that allele
<inline-formula><mml:math id="M82" display="inline" overflow="scroll"><mml:mi>a</mml:mi></mml:math></inline-formula> is the ancestral state, and it is invariant across sites. If
<inline-formula><mml:math id="M83" display="inline" overflow="scroll"><mml:mi>P</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:mi>R</mml:mi><mml:mo>=</mml:mo><mml:mi>a</mml:mi></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:mn>0.5</mml:mn></mml:math></inline-formula>, then the equation refers to the scenario of folded allele frequencies, where each allele is equally probable to be the ancestral state.</p>
      <p>Finally, note that in a sufficiently large sample size, the major allele is more probable to represent the ancestral state. This probability depends on the shape of the site frequency spectrum, and it is equal to the cumulative distribution of
<inline-formula><mml:math id="M84" display="inline" overflow="scroll"><mml:mi>P</mml:mi><mml:mfenced close=")" open="(" separators="|"><mml:mi>F</mml:mi><mml:mi>K</mml:mi></mml:mfenced></mml:math></inline-formula> evaluated at
<inline-formula><mml:math id="M85" display="inline" overflow="scroll"><mml:mi>F</mml:mi><mml:mo>=</mml:mo><mml:mi>N</mml:mi><mml:mo>/</mml:mo><mml:mn>2</mml:mn></mml:math></inline-formula>. We can extend
<xref rid="e3" ref-type="disp-formula">Equation 3</xref> to reflect this parameter uncertainty with
<inline-formula><mml:math id="M86" display="inline" overflow="scroll"><mml:mi>a</mml:mi></mml:math></inline-formula> being the major allele in
<inline-formula><mml:math id="M87" display="inline" overflow="scroll"><mml:mi>P</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:mi>R</mml:mi><mml:mo>=</mml:mo><mml:mi>a</mml:mi></mml:mrow></mml:mfenced></mml:math></inline-formula>.</p>
    </sec>
    <sec id="sec10">
      <title>Test for multiploidy</title>
      <p>We introduce a novel test for multiploidy. If all samples have the same ploidy
<inline-formula><mml:math id="M88" display="inline" overflow="scroll"><mml:mi>y</mml:mi><mml:mo>∈</mml:mo><mml:mi>Y</mml:mi></mml:math></inline-formula>, then
<inline-formula><mml:math id="M89" display="inline" overflow="scroll"><mml:msub><mml:mi>Y</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>Y</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mi>y</mml:mi></mml:math></inline-formula> is true for all
<inline-formula><mml:math id="M90" display="inline" overflow="scroll"><mml:mfenced close=")" open="(" separators=","><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mfenced><mml:mo>∈</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mi mathvariant="normal">M</mml:mi></mml:math></inline-formula>. We propose an LRT for multiploidy with null hypothesis
<inline-formula><mml:math id="M91" display="inline" overflow="scroll"><mml:msub><mml:mi>H</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>:</mml:mo><mml:mo>sup</mml:mo><mml:mover accent="true"><mml:mi>Y</mml:mi><mml:mo stretchy="true">→</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:mfenced close="}" open="{" separators=",,,"><mml:mrow><mml:msub><mml:mi>y</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mi>y</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mi>y</mml:mi></mml:mrow><mml:mo>…</mml:mo><mml:mrow><mml:msub><mml:mi>y</mml:mi><mml:mi>M</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mi>y</mml:mi></mml:mrow></mml:mfenced></mml:math></inline-formula> and alternate hypothesis
<inline-formula><mml:math id="M92" display="inline" overflow="scroll"><mml:msub><mml:mi>H</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>:</mml:mo><mml:mover accent="true"><mml:mi>Y</mml:mi><mml:mo stretchy="true">→</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>Y</mml:mi><mml:mo stretchy="true">→</mml:mo></mml:mover><mml:mi mathvariant="italic">MLE</mml:mi></mml:msub></mml:math></inline-formula> A large value of LRT is suggestive of multiploidy. Statistical significance can be assessed with the LRT and
<inline-formula><mml:math id="M93" display="inline" overflow="scroll"><mml:mfenced close=")" open="("><mml:mrow><mml:mi>M</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfenced></mml:math></inline-formula> degrees of freedom.</p>
    </sec>
    <sec id="sec11">
      <title>Data simulation</title>
      <p>To benchmark the performance of methods implemented in
<monospace>ngsJulia</monospace>, we simulated NGS data following a strategy previously proposed by Fumagalli
<italic toggle="yes">et al</italic>.
<sup><xref rid="ref27" ref-type="bibr">27</xref></sup> available as a stand-alone R script. Briefly, individual genotypes are drawn according to probabilities depending on input parameters. The number of mapped reads at each position is modelled with a Poisson distribution and sequenced bases are sampled with replacement with a probability given by the quality score. As an illustration, the following code
<preformat preformat-type="computer code" position="float" xml:space="preserve">Rscript simulMpileup. R --out test.txt --copy 2x10 --sites 1000 \\--depth 20 --qual 20 ---pool|gzip &gt; test.mpileup.gz</preformat>
</p>
      <p>will simulate 10 diploid genomes
<monospace>(--copy 2x10</monospace>),
<inline-formula><mml:math id="M94" display="inline" overflow="scroll"><mml:mn>1000</mml:mn></mml:math></inline-formula> base pairs each (
<monospace>--sites 1000</monospace>) with an average sequencing depth of
<inline-formula><mml:math id="M95" display="inline" overflow="scroll"><mml:mn>20</mml:mn></mml:math></inline-formula> and base quality of
<inline-formula><mml:math id="M96" display="inline" overflow="scroll"><mml:mn>20</mml:mn></mml:math></inline-formula> in
<italic toggle="yes">Phred</italic> score (
<monospace>--depth 20 --qual 20</monospace>) from pooled sequencing (
<monospace>--pool</monospace>) with results stored in
<monospace>test.mpileup.gz file</monospace>.</p>
      <p>For the analysis of pooled sequencing data, we simulated
<inline-formula><mml:math id="M97" display="inline" overflow="scroll"><mml:mn>100,000</mml:mn></mml:math></inline-formula> independent sites at sample sizes
<inline-formula><mml:math id="M98" display="inline" overflow="scroll"><mml:mn>20</mml:mn></mml:math></inline-formula>,
<inline-formula><mml:math id="M99" display="inline" overflow="scroll"><mml:mn>50</mml:mn></mml:math></inline-formula>, and
<inline-formula><mml:math id="M100" display="inline" overflow="scroll"><mml:mn>100</mml:mn></mml:math></inline-formula> from a diploid population with a constant effective population size of
<inline-formula><mml:math id="M101" display="inline" overflow="scroll"><mml:mn>10,000</mml:mn></mml:math></inline-formula>. We imposed the average per-sample sequencing depth to be
<inline-formula><mml:math id="M102" display="inline" overflow="scroll"><mml:mn>0.5</mml:mn></mml:math></inline-formula>,
<inline-formula><mml:math id="M103" display="inline" overflow="scroll"><mml:mn>1</mml:mn></mml:math></inline-formula>,
<inline-formula><mml:math id="M104" display="inline" overflow="scroll"><mml:mn>2</mml:mn></mml:math></inline-formula>, or
<inline-formula><mml:math id="M105" display="inline" overflow="scroll"><mml:mn>5</mml:mn></mml:math></inline-formula> with an average base quality of
<inline-formula><mml:math id="M106" display="inline" overflow="scroll"><mml:mn>20</mml:mn></mml:math></inline-formula> in
<italic toggle="yes">Phred</italic> score. To assess the performance of
<monospace>ngsPool</monospace>, we calculated bias and root mean squared error (RMSE) between the estimated value of the true value, either from the sample or the whole population. While both metrics measure the distance with the true value, the bias retains the direction of the error (i.e. over- or under-estimation). To quantify the accuracy of SNP calling, we calculated F1 scores (the harmonic mean of precision and recall rates).</p>
      <p>To simulate data for association test, we assumed an equal number of cases and controls (equal to
<inline-formula><mml:math id="M107" display="inline" overflow="scroll"><mml:mn>150</mml:mn></mml:math></inline-formula>) and 200 SNPs, either causal or non causal. For non causal sites, cases and controls have the same population allele frequency of
<inline-formula><mml:math id="M108" display="inline" overflow="scroll"><mml:mn>0.10</mml:mn></mml:math></inline-formula>. For causal sites, cases and controls have a population allele frequency of
<inline-formula><mml:math id="M109" display="inline" overflow="scroll"><mml:mn>0.09</mml:mn></mml:math></inline-formula> and
<inline-formula><mml:math id="M110" display="inline" overflow="scroll"><mml:mn>0.04</mml:mn></mml:math></inline-formula>, respectively. These conditions are derived assuming a high risk allele frequency of
<inline-formula><mml:math id="M111" display="inline" overflow="scroll"><mml:mn>0.1</mml:mn></mml:math></inline-formula>, prevalence of
<inline-formula><mml:math id="M112" display="inline" overflow="scroll"><mml:mn>0.2</mml:mn></mml:math></inline-formula>, genotypic relative risk for the heterozygote of
<inline-formula><mml:math id="M113" display="inline" overflow="scroll"><mml:mn>2</mml:mn></mml:math></inline-formula>, genotypic relative risk for the homozygous state of
<inline-formula><mml:math id="M114" display="inline" overflow="scroll"><mml:mn>4</mml:mn></mml:math></inline-formula>. The sample size simulated guarantees at least
<inline-formula><mml:math id="M115" display="inline" overflow="scroll"><mml:mn>80</mml:mn><mml:mo>%</mml:mo></mml:math></inline-formula> power with a false positive rate of
<inline-formula><mml:math id="M116" display="inline" overflow="scroll"><mml:mn>0.10</mml:mn></mml:math></inline-formula>.</p>
      <p>To illustrate the usage of
<monospace>ngsPloidy</monospace>, we simulated NGS data of genomes with different ploidy levels (one haploid, eight triploids, one tetraploid) at
<inline-formula><mml:math id="M117" display="inline" overflow="scroll"><mml:mn>1000</mml:mn></mml:math></inline-formula> sites. NGS data was simulated assuming an average depth of
<inline-formula><mml:math id="M118" display="inline" overflow="scroll"><mml:mn>10</mml:mn></mml:math></inline-formula> at the haploid level. Code and simulated data sets analysed are available in
<monospace><ext-link xlink:href="https://github.com/mfumagalli/ngsJulia" ext-link-type="uri">ngsJulia</ext-link></monospace> GitHub repository.</p>
    </sec>
  </sec>
  <sec sec-type="results" id="sec912">
    <title>Empirical data</title>
    <p>To showcase the applicability of
<monospace>ngsJulia</monospace> to real data, we deployed to two distinct empirical data sests. To test
<monospace>ngsPool</monospace>, we used mapped reads of
<italic toggle="yes">Arabidopsis lyrata</italic> produced in a previous study.
<sup><xref rid="ref28" ref-type="bibr">28</xref></sup> Specifically, We used data belonging to the population B where 25 individuals of A.
<italic toggle="yes">lyrata</italic> have been sequenced by both pool-sequencing and genotyping-by-sequencing. Since GBS harbours data on a fraction of the genome and Pool-seq is whole genome, We restricted the analysis to the base pairs (bp) sequenced by both techniques, for a total of 15202 bp. The mpileup files have been generated with samtools
<sup><xref rid="ref6" ref-type="bibr">6</xref></sup> (v1.14) and SNP calling in GBS data has been performed with Varscan
<sup><xref rid="ref29" ref-type="bibr">29</xref></sup> (v2.4.2), resulting in 333 SNPs.</p>
    <p>To test
<monospace>ngsPloidy</monospace>, we reanalysed whole-genome sequencing data of the human fungal pathogen
<italic toggle="yes">Candida auris</italic> from a previous study.
<sup><xref rid="ref30" ref-type="bibr">30</xref></sup> We processed data for 21 samples, each one consisting of 17 contigs. As the null hypotheses is that these samples are haploid, we tested ploidy levels from 1 to 4. We filtered out sites with a minimum depth lower than 5 and a proportion of minor alleles lower than 0.15. The number of sites analysed per contig ranged from 555 to 754.</p>
  </sec>
  <sec sec-type="results" id="sec12">
    <title>Results</title>
    <p><monospace>ngsJulia</monospace> implements data structures and functions for an easy calculation of nucleotide and genotype likelihoods (of arbitrary ploidy) which serve the basis of genotype and SNP calling and for the estimation of allele frequencies and other summary statistics. It is particularly suitable for low-coverage sequencing data and for cases when there is high data uncertainty. To demonstrate the use of
<monospace>ngsJulia</monospace>, we provide two custom applications from its templates and functions.</p>
    <sec id="sec13">
      <title>ngsPool: analysis of pooled sequencing data</title>
      <p>We used
<monospace>ngsJulia</monospace> to implement a separate program, called
<monospace>ngsPool</monospace>, to perform population genetic analysis from pooled sequencing data. Specifically,
<monospace>ngsPool</monospace> implements established and novel statistical methods to estimate allele frequencies and site frequency spectra (SFS) and perform association tests from pooled sequencing data.</p>
      <p><monospace>ngsPool</monospace> uses functions in
<monospace>ngsJulia</monospace> to parse mpileup files as input. As an illustration, the following code</p>
      <p>
        <preformat preformat-type="computer code" position="float" xml:space="preserve">julia ngsPool.jl --fin test.mpileup.gz --fout test.out.gz --lrtSnp 6.64</preformat>
      </p>
      <p>will parse
<monospace>test.mpileup.gz</monospace> file and write estimates of allele frequencies in
<monospace>test.out.gz</monospace> file from unknwon sample size after performing SNP calling with an LRT value of 6.64
<monospace>(--lrtSnp 6.64</monospace>, equivalent to a
<italic toggle="yes">p</italic>-value of
<inline-formula><mml:math id="M119" display="inline" overflow="scroll"><mml:mn>0.01</mml:mn></mml:math></inline-formula>).</p>
      <p>Depending on the options selected by the user, output files contain, various results are printed on the screen, including
<list list-type="simple"><list-item><label>•</label><p>inferred major allele,</p></list-item><list-item><label>•</label><p>inferred minor allele,</p></list-item><list-item><label>•</label><p>LRT statistic for SNP calling,</p></list-item><list-item><label>•</label><p>LRT for bi- and tri-allelic calling,</p></list-item><list-item><label>•</label><p>three estimators of the minor allele frequency at each site.</p></list-item></list>
</p>
      <p>Additionally,
<monospace>ngsPool</monospace> can output a file with per-site sample allele frequency likelihoods. The following code</p>
      <p>
        <preformat preformat-type="computer code" position="float" xml:space="preserve">julia ngsPool.jl --fin test.mpileup.gz --fout test.out.gz \\--nChroms 20 --fsaf test.saf.gz</preformat>
      </p>
      <p>will produce estimates of allele frequencies from the known sample size (specified by
<monospace>--nChroms 20</monospace>) and allele frequency likelihoods in
<monospace>test.saf.gz file</monospace>.</p>
      <p>These files can then be used to estimate the SFS and perform an association test using two scripts provided in
<monospace>ngsPool</monospace>. For instance, the code</p>
      <p>
        <preformat preformat-type="computer code" position="float" xml:space="preserve">Rscript poolSFS. R test.saf.gz &gt; sfs.txt</preformat>
      </p>
      <p>will estimate the SFS, while the code</p>
      <p>
        <preformat preformat-type="computer code" position="float" xml:space="preserve">Rscript poolAssoc. R test.cases.saf.gz test.controls.saf.gz &gt; assoc.txt</preformat>
      </p>
      <p>will perform an association test assuming two sets of allele frequency likelihood files, one from cases (
<monospace>test.cases.saf.gz</monospace>) and one from controls (
<monospace>test.controls.saf.gz</monospace>).</p>
    </sec>
    <sec id="sec14">
      <title>Estimation of allele frequencies</title>
      <p>To illustrate the usage of
<monospace>ngsPool</monospace>, we estimated allele frequencies based on simulated data at different experimental conditions. We sought to compare the performance among different estimators implemented in the program. If the sample size is not provided,
<monospace>ngsPool</monospace> provides a simple MLE of the population allele frequency assuming haploidy. Alternatively, if the sample size is provided by the user,
<monospace>ngsPool</monospace> calculates sample allele frequency likelihoods and returns both the MLE and the expected value of the allele frequency using a uniform prior probability.</p>
      <p>Results show that the error of estimating allele frequencies decreases with increasing depth and sample size, as expected (
<xref rid="f1" ref-type="fig">Figure 1</xref>). Likewise, the error for estimating the population allele frequency is more pronounced for lower sample sizes. MLE values tend to be less biased than expected values and sample estimates appear to be unbiased even at depth 1 for moderate sample size (
<xref rid="f1" ref-type="fig">Figure 1</xref>).</p>
      <fig position="float" fig-type="figure" id="f1">
        <label>Figure 1. </label>
        <caption>
          <title>Estimation of minor allele frequencies from pooled sequencing data.</title>
          <p>Bias and root mean square error (RMSE) against the reference true value from either the population or sample are provided for each value of depth
<inline-formula><mml:math id="M120" display="inline" overflow="scroll"><mml:mi>D</mml:mi></mml:math></inline-formula> (the average number of sequenced reads per base pair) and sample size (on column panels) tested. Three estimators of allele frequencies are considered: a population maximum likelihood estimate (MLE) from unknown sample size and the expected value and MLE from known sample size.</p>
        </caption>
        <graphic xlink:href="f1000research-11-150492-g0000" id="gr1" position="float"/>
      </fig>
      <p>Furthermore, we simulated NGS data at fixed population allele frequency and compared the distribution of true sample allele frequencies and estimated values using a MLE approach from known sample size.
<xref rid="f2" ref-type="fig">Figure 2</xref> shows that most of the deviation from the true population allele frequencies occurs at intermediate frequencies (
<inline-formula><mml:math id="M121" display="inline" overflow="scroll"><mml:mi>F</mml:mi></mml:math></inline-formula> equal to 0.5). This effect is more evident for low depth and low sample size (
<xref rid="f2" ref-type="fig">Figure 2</xref>).</p>
      <fig position="float" fig-type="figure" id="f2">
        <label>Figure 2. </label>
        <caption>
          <title>Distribution of estimated minor allele frequencies from pooled sequencing data.</title>
          <p>True sample allele frequencies (SAF) and maximum likelihood estimates (MLE) are shown at different fixed population allele frequencies
<italic toggle="yes">F</italic> and sample sizes (on rows, 20 and 50) and depths (the average number of sequenced reads per base pair, on columns, 0.5, 1, 2, and 5).</p>
        </caption>
        <graphic xlink:href="f1000research-11-150492-g0001" id="gr2" position="float"/>
      </fig>
      <p>We then assessed the effect of low-frequency variants on SNP calling. Specifically, we calculated F1 scores for SNP calling when the population allele frequency is 0 (not a SNP) or greater than 0 (a SNP).
<xref rid="f3" ref-type="fig">Figure 3</xref> shows how the prediction performance increases with the population allele frequency (
<inline-formula><mml:math id="M122" display="inline" overflow="scroll"><mml:mi>F</mml:mi></mml:math></inline-formula>), sample size, and depth (
<inline-formula><mml:math id="M123" display="inline" overflow="scroll"><mml:mi>D</mml:mi></mml:math></inline-formula>). For instance, an F1 score greater than 0.75 is obtained with 20 samples only for
<inline-formula><mml:math id="M124" display="inline" overflow="scroll"><mml:mi>F</mml:mi><mml:mo>=</mml:mo><mml:mn>0.05</mml:mn></mml:math></inline-formula> and
<inline-formula><mml:math id="M125" display="inline" overflow="scroll"><mml:mi>D</mml:mi><mml:mo>&gt;</mml:mo><mml:mn>0.5</mml:mn></mml:math></inline-formula>. On the other hand, the same F1 score is achieved with 50 samples even with
<inline-formula><mml:math id="M126" display="inline" overflow="scroll"><mml:mi>F</mml:mi><mml:mo>=</mml:mo><mml:mn>0.025</mml:mn></mml:math></inline-formula> and also at
<inline-formula><mml:math id="M127" display="inline" overflow="scroll"><mml:mi>F</mml:mi><mml:mo>=</mml:mo><mml:mn>0.02</mml:mn></mml:math></inline-formula> but only if
<inline-formula><mml:math id="M128" display="inline" overflow="scroll"><mml:mi>D</mml:mi><mml:mo>&gt;</mml:mo><mml:mn>1</mml:mn></mml:math></inline-formula>.</p>
      <fig position="float" fig-type="figure" id="f3">
        <label>Figure 3. </label>
        <caption>
          <title>Performance of single nucleotide polymorphism (SNP) calling from pooled sequencing data.</title>
          <p>F1 scores (harmonic means of precision and recall rates) for predicting either a SNP (true population allele frequency
<inline-formula><mml:math id="M129" display="inline" overflow="scroll"><mml:mi>F</mml:mi></mml:math></inline-formula> greater than 0) or not (
<inline-formula><mml:math id="M130" display="inline" overflow="scroll"><mml:mi>F</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:math></inline-formula>) are reported are various values of
<inline-formula><mml:math id="M131" display="inline" overflow="scroll"><mml:mi>F</mml:mi></mml:math></inline-formula>, sample sizes (on columns, 20 and 50) and depths
<inline-formula><mml:math id="M132" display="inline" overflow="scroll"><mml:mi>D</mml:mi></mml:math></inline-formula> (the average number of sequenced reads per base pair).</p>
        </caption>
        <graphic xlink:href="f1000research-11-150492-g0002" id="gr3" position="float"/>
      </fig>
      <p>SNP calling under-performs when there is no variation in the population (
<inline-formula><mml:math id="M133" display="inline" overflow="scroll"><mml:mi>F</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:math></inline-formula>), with sequencing errors and sampling statistical uncertainty generating estimates of
<inline-formula><mml:math id="M134" display="inline" overflow="scroll"><mml:mi>F</mml:mi></mml:math></inline-formula> greater than 0.</p>
      <p><monospace>ngsPool</monospace> implements several methods to estimate the SFS from sample allele frequencies. As described in the methods, a simpler estimator is based on assigning the most likely sample allele frequency at each site (labelled count).
<monospace>ngsPool</monospace> implements novel estimators of SFS from pooled sequencing data as described in the method section. A script implements an algorithm to fit the theoretical SFS to the observed SFS. The latter can be calculated either by assigning per-site MLE of allele frequencies (labelled
<monospace>Fit_count</monospace>) or by integrating the uncertainties across all sample allele frequency likelihoods (labelled
<monospace>Fit_afl</monospace>).</p>
      <p><xref rid="f4" ref-type="fig">Figure 4</xref> shows the error in estimating either the population or sample SFS at various settings with different methods. The error decreases with increasing depth and sample size. Estimating SFS by fitting the theoretical SFS without assignment of allele frequencies generally outperforms other tested strategies (
<xref rid="f4" ref-type="fig">Figure 4</xref>).</p>
      <fig position="float" fig-type="figure" id="f4">
        <label>Figure 4. </label>
        <caption>
          <title>Estimation of site frequency spectrum (SFS) from pooled sequencing data.</title>
          <p>Estimates based on counting allele frequencies (Count) or fitting from counted allele frequencies (
<monospace>Fit Count</monospace>) or from allele frequency likelihoods (
<monospace>Fit afl</monospace>) are calculated. Root mean square error (RMSE) values between true (either population or sample, on rows) and estimated SFS are reported at various depths
<italic toggle="yes">D</italic> and sample sizes (on columns).</p>
        </caption>
        <graphic xlink:href="f1000research-11-150492-g0003" id="gr4" position="float"/>
      </fig>
      <p>Notably, the novel approach implemented in
<monospace>ngsPool</monospace> to estimate the parameter
<inline-formula><mml:math id="M135" display="inline" overflow="scroll"><mml:mi>K</mml:mi></mml:math></inline-formula> of the SFS distribution (see Methods) allow us to directly quantify the error in inferring demographic events. In fact, all simulations assumed constant population size, equivalent to
<inline-formula><mml:math id="M136" display="inline" overflow="scroll"><mml:mi>K</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:math></inline-formula>.
<xref rid="f5" ref-type="fig">Figure 5</xref> shows the estimated values of
<inline-formula><mml:math id="M137" display="inline" overflow="scroll"><mml:mi>K</mml:mi></mml:math></inline-formula> by fitting the SFS either by assigning (counting) allele frequencies (
<monospace>Fit_count</monospace>) or by using allele frequency likelihoods (
<monospace>Fit_afl</monospace>). For low-to-moderate depth and sample size, estimates of
<inline-formula><mml:math id="M138" display="inline" overflow="scroll"><mml:mi>K</mml:mi></mml:math></inline-formula> tend to suggest population expansion (
<inline-formula><mml:math id="M139" display="inline" overflow="scroll"><mml:mi>K</mml:mi><mml:mo>&lt;</mml:mo><mml:mn>1</mml:mn></mml:math></inline-formula>), possibly due to an over-estimation of the abundance of low-frequency alleles. However, the error is reduced when integrating the data uncertainty with sample allele frequency likelihoods, as estimates of
<inline-formula><mml:math id="M140" display="inline" overflow="scroll"><mml:mi>K</mml:mi></mml:math></inline-formula> values tend to be closer to the true simulated value of
<inline-formula><mml:math id="M141" display="inline" overflow="scroll"><mml:mn>1</mml:mn></mml:math></inline-formula> (
<xref rid="f5" ref-type="fig">Figure 5</xref>).</p>
      <fig position="float" fig-type="figure" id="f5">
        <label>Figure 5. </label>
        <caption>
          <title>Estimation of parameter
<italic toggle="yes">K</italic> (used to determine if the population is deviating from constant effective population size) of the site frequency spectrum at different depths D and sample sizes (on rows) from pooled sequencing data.</title>
          <p>Estimates based on fitting from counted allele frequencies (
<monospace>Fit count</monospace>) and from allele frequency likelihoods (
<monospace>Fit afl</monospace>) are reported. Note that the true simulated value of
<italic toggle="yes">K</italic> is 1.</p>
        </caption>
        <graphic xlink:href="f1000research-11-150492-g0004" id="gr5" position="float"/>
      </fig>
      <p><monospace>ngsPool</monospace> implements a script to perform association tests from pooled sequencing data. Specifically, the script calculates an LRT statistic, with null hypothesis being that allele frequencies of cases and controls (or any two groups) are the same, as used by Kim
<italic toggle="yes">et al.</italic>
<sup><xref rid="ref23" ref-type="bibr">23</xref></sup> It uses sample allele frequency likelihoods and, therefore, it maintains data uncertainty and avoids the assignment of counts or per-site allele frequencies. An LRT statistics significantly greater than 0 indicates a difference in allele frequencies between cases and controls.</p>
      <p><xref rid="f6" ref-type="fig">Figure 6</xref> compares the distribution of LRT statistics between causal and non causal sites at different experimental scenarios. The distribution of LRT at causal SNPs is skewed towards higher values for increasing depth, indicating more support to find phenptype-SNP association. Nevertheless, a clear separation between the distributions of causal and non causal SNPs is observed at low depth (
<xref rid="f6" ref-type="fig">Figure 6</xref>).</p>
      <fig position="float" fig-type="figure" id="f6">
        <label>Figure 6. </label>
        <caption>
          <title>Performance of association test from pooled sequencing data.</title>
          <p> The distribution of likelihood-ratio test (LRT) statistics for casual and non causal single-nucleotide polymorphism (SNP) is reported at different depths (the average number of sequenced reads per base pair, on columns).</p>
        </caption>
        <graphic xlink:href="f1000research-11-150492-g0005" id="gr6" position="float"/>
      </fig>
      <p>To illustrate the application of ngsPool to real data, we reanalysed genomic data from
<italic toggle="yes">Arabidopsis lyrata</italic>.
<sup><xref rid="ref28" ref-type="bibr">28</xref></sup> In this study, authors generated data both by genotype-by-sequencing and by pooled-sequencing, with the former providing ground-truth values for genotype and allele calls. Estimates of minor allele frequencies using
<monospace>ngsPool</monospace> yield a lower RMSE (0.09372) than estimates from Varscan (0.09783) across all SNPs analysed.</p>
    </sec>
    <sec id="sec15">
      <title>ngsPloidy: analysis of sequencing data from polyploid genomes</title>
      <p>We further utilised
<monospace>ngsJulia</monospace> to implement an additional program,
<monospace>ngsPloidy</monospace>, for the estimation of ploidy from unknown genotypes. The method implemented is similar to the one proposed by Soraggi
<italic toggle="yes">et al.</italic>
<sup><xref rid="ref22" ref-type="bibr">22</xref></sup> with some notable differences on the calculation of genotype probabilities (see Methods). Additionally,
<monospace>ngsPloidy</monospace> includes a novel method to test for multiploidy in the sample. As an illustration, the following code</p>
      <p>
        <preformat preformat-type="computer code" position="float" xml:space="preserve">julia ngsPloidy.jl --fin test.mpileup.gz --nSamples 20 &gt; test.outRscript ploidyLRT. R test.out</preformat>
      </p>
      <p>will estimate ploidy levels for
<inline-formula><mml:math id="M142" display="inline" overflow="scroll"><mml:mn>20</mml:mn></mml:math></inline-formula> genomes (
<monospace>--nSamples 20</monospace>) from
<monospace>test.mpileup.gz</monospace> file and return LRT values.</p>
      <p>Following
<xref rid="e2" ref-type="disp-formula">Equation 2</xref>, the genotype probabilities for each tested ploidy are pre-calculated using a script provided in
<monospace>ngsPloidy</monospace>. This script takes as input the value of parameter
<inline-formula><mml:math id="M143" display="inline" overflow="scroll"><mml:mi>K</mml:mi></mml:math></inline-formula> (the shape of the expected SFS), the effective population size, and the probability that the major allele is the ancestral allele. The latter can be either set by the user (e.g., a value of 0.5 would be equivalent to unknown polarisation, as in a folded SFS) or be calculated from the expected population SFS itself. If genotype probabilities are not set, a uniform distribution is assigned. Further options allow for estimation only on called SNPs and/or genotypes.</p>
      <p><monospace>ngsPloidy</monospace> uses functions in
<monospace>ngsJulia</monospace> to parse mpileup files as input. At the end of the computation, various results are printed on the screen, including
<list list-type="simple"><list-item><label>•</label><p>the number of analysed sites that passed filtering for each sample,</p></list-item><list-item><label>•</label><p>a matrix of ploidy log-likelihoods for each sample,</p></list-item><list-item><label>•</label><p>the log-likelihood and MLE of the ploidy vector (i.e., the individually estimated ploidy for each sample),</p></list-item><list-item><label>•</label><p>LRT scores for the test of multiploidy against all tested ploidy levels.</p></list-item></list>
</p>
      <p>Additionally, if requested by the user,
<monospace>ngsPloidy</monospace> can generate output files with several statistics for each site (e.g., estimate allele frequency), and all per-site genotype likelihoods for each sample and the tested ploidy.</p>
      <p>To illustrate the usage of
<monospace>ngsPloidy</monospace>, we deployed it to simulated data of an multiploid sample consisting of one diploid, eight triploid and one tetraploid genomes. We compared the performance of ploidy and multiploidy inference among different choices of genotype probabilities. The latter were derived either from the expected folded population site frequency, from the estimated ancestral population allele frequency, or from the calculated sample allele frequency.</p>
      <p>In all tested cases, we inferred the correct vector of marginal ploidy levels. We therefore assessed the confidence in such inference by calculating the LRT statistics of ploidy and multiploidy inferences. Both were calculated by comparing the most against the second most likely vector of ploidy levels or the most likely vector of equal ploidy levels, respectively.</p>
      <p>Results show that using the per-site estimate sampled allele frequency yields higher LRT statistics (and therefore confidence) than using expected population allele frequencies (
<xref rid="T1" ref-type="table">Table 1</xref>). We reiterate that for all three cases we correctly identified the patterns of multiploidy. However, we should caution that with lower sample sizes we do not expect inferences using estimated sample allele frequencies to perform well.</p>
      <table-wrap position="float" id="T1">
        <label>Table 1. </label>
        <caption>
          <title>Confidence values to the correctly assigned ploidy vector and test for multiploidy.</title>
          <p>Likelihood-ratio test (LRT) statistics using different methods of incorporating allele frequencies are reported.</p>
        </caption>
        <table frame="hsides" rules="groups" content-type="article-table">
          <thead>
            <tr>
              <th align="left" colspan="1" rowspan="1" valign="top">Allele frequency</th>
              <th align="left" colspan="1" rowspan="1" valign="top">LRT – ploidy</th>
              <th align="left" colspan="1" rowspan="1" valign="top">LRT - multiploidy</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td align="left" colspan="1" rowspan="1" valign="top">Folded</td>
              <td align="left" colspan="1" rowspan="1" valign="top">34.19</td>
              <td align="left" colspan="1" rowspan="1" valign="top">252.72</td>
            </tr>
            <tr>
              <td align="left" colspan="1" rowspan="1" valign="top">Ancestral</td>
              <td align="left" colspan="1" rowspan="1" valign="top">31.49</td>
              <td align="left" colspan="1" rowspan="1" valign="top">277.91</td>
            </tr>
            <tr>
              <td align="left" colspan="1" rowspan="1" valign="top">Sample</td>
              <td align="left" colspan="1" rowspan="1" valign="top">37.83</td>
              <td align="left" colspan="1" rowspan="1" valign="top">373.07</td>
            </tr>
          </tbody>
        </table>
      </table-wrap>
      <p>To illustrate the applicability of
<monospace>ngsPloidy</monospace> to real empirical data, we inferred ploidy levels on 21 isolates from an outbreak of
<italic toggle="yes">Candida auris</italic>.
<sup><xref rid="ref30" ref-type="bibr">30</xref></sup> In all contigs analysed, haploid was inferred as the most likely ploidy and multiploidy was rejected in all samples. These results are consistent with findings from the original study, although the identification of polyploidy in other isolates may be associated with multidrug-resistant phenotypes.
<sup><xref rid="ref31" ref-type="bibr">31</xref></sup>
</p>
    </sec>
  </sec>
  <sec sec-type="discussion" id="sec16">
    <title>Discussion</title>
    <p>Analyses presented here provide further support for the use of genotype and allele frequency likelihoods in the analysis of NGS data.
<sup><xref rid="ref5" ref-type="bibr">5</xref></sup> Notably, we demonstrated how probabilistic estimates of population genetic parameters can be obtained in case of pooled sequencing data and short-read data from polyploid genomes. Additionally, we motivated the inference of SFS from allele frequency likelihoods as a direct way to infer demography from raw sequencing data.</p>
    <p><monospace>ngsJulia</monospace> offers new possibilities of software prototyping for custom analyses of NGS data for population genetic applications. Furthermore, it facilitates experimental design as it provides a platform to benchmark the efficacy of population genetic analysis from competing sequencing experiments. Finally,
<monospace>ngsJulia</monospace> has accessible documentation and tutorials to inform users on the theory underpinning the implemented methods. We envisage that further improvements in
<monospace>ngsJulia</monospace> will include the expansion of suitable input formats and data file types, and the compatibility with additional NGS data type, including from long-read sequencing experiments.
<sup><xref rid="ref32" ref-type="bibr">32</xref></sup>
</p>
  </sec>
  <sec sec-type="conclusions" id="sec17">
    <title>Conclusions</title>
    <p>In this study, we introduce
<monospace>ngsJulia</monospace>, a series of templates and functions in
<monospace>Julia</monospace> language to analyse NGS data for population genetic purposes. We present two implementations for the analysis of pooled sequencing data and polyploid genomes, with the inclusion of novel methods.
<monospace>ngsJulia</monospace> is a suitable framework for prototyping new software and for custom population genetic analyses from NGS data.</p>
  </sec>
  <sec sec-type="data-availability" id="sec18">
    <title>Data availability</title>
    <sec id="sec19">
      <title>Underlying data</title>
      <p>Simulated data and pipeline to reproduce all results presented here are available at
<ext-link xlink:href="https://doi.org/10.5281/zenodo.5886879" ext-link-type="uri">https://doi.org/10.5281/zenodo.5886879</ext-link>.
<sup><xref rid="ref20" ref-type="bibr">20</xref></sup>
</p>
      <p>Data are available under the terms of the
<ext-link xlink:href="https://creativecommons.org/licenses/by/4.0/" ext-link-type="uri">Creative Commons Attribution 4.0 International Public License</ext-link>.</p>
    </sec>
  </sec>
  <sec id="sec20">
    <title>Software availability</title>
    <p>
      <list list-type="simple">
        <list-item>
          <label>•</label>
          <p>Source code available from:
<ext-link xlink:href="https://github.com/mfumagalli/ngsJulia" ext-link-type="uri">https://github.com/mfumagalli/ngsJulia</ext-link>
</p>
        </list-item>
        <list-item>
          <label>•</label>
          <p>Archived source code at time of publication:
<ext-link xlink:href="https://doi.org/10.5281/zenodo.5886879" ext-link-type="uri">https://doi.org/10.5281/zenodo.5886879</ext-link>
<sup><xref rid="ref20" ref-type="bibr">20</xref></sup>
</p>
        </list-item>
        <list-item>
          <label>•</label>
          <p>License:
<ext-link xlink:href="https://creativecommons.org/licenses/by/4.0/" ext-link-type="uri">Creative Commons Attribution 4.0 International Public License</ext-link>
</p>
        </list-item>
      </list>
    </p>
  </sec>
</body>
<back>
  <ack>
    <title>Acknowledgements</title>
    <p>We are thankful to Johanna Rhodes for assistance gathering sequencing data for
<italic toggle="yes">Candida auris</italic>.</p>
  </ack>
  <ref-list>
    <title>References</title>
    <ref id="ref1">
      <label>1</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Marchi</surname><given-names>N</given-names></name><name><surname>Schlichta</surname><given-names>F</given-names></name><name><surname>Excoffier</surname><given-names>L</given-names></name></person-group>:
<article-title>Demographic inference.</article-title><source><italic toggle="yes">Curr. Biol.</italic></source><year>2021</year>;<volume>31</volume>(<issue>6</issue>):<fpage>R276</fpage>–<lpage>R279</lpage>.
<pub-id pub-id-type="doi">10.1016/j.cub.2021.01.053</pub-id><ext-link xlink:href="https://www.sciencedirect.com/science/article/pii/S0960982221001184" ext-link-type="uri">Reference Source</ext-link><pub-id pub-id-type="pmid">33756135</pub-id></mixed-citation>
    </ref>
    <ref id="ref2">
      <label>2</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Vitti</surname><given-names>JJ</given-names></name><name><surname>Grossman</surname><given-names>SR</given-names></name><name><surname>Sabeti</surname><given-names>PC</given-names></name></person-group>:
<article-title>Detecting natural selection in genomic data.</article-title><source><italic toggle="yes">Annu. Rev. Genet.</italic></source><year>2013</year>;<volume>47</volume>(<issue>1</issue>):<fpage>97</fpage>–<lpage>120</lpage>.
<pub-id pub-id-type="doi">10.1146/annurev-genet-111212-133526</pub-id><?supplied-pmid 24274750?><pub-id pub-id-type="pmid">24274750</pub-id></mixed-citation>
    </ref>
    <ref id="ref3">
      <label>3</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Uffelmann</surname><given-names>E</given-names></name><name><surname>Huang</surname><given-names>QQ</given-names></name><name><surname>Munung</surname><given-names>NS</given-names></name><etal/></person-group>:
<article-title>Genome-wide association studies.</article-title><source><italic toggle="yes">Nature Reviews Methods Primers.</italic></source><year>Aug 2021</year>;<volume>1</volume>(<issue>1</issue>):<fpage>59</fpage>.
<pub-id pub-id-type="doi">10.1038/s43586-021-00056-9</pub-id></mixed-citation>
    </ref>
    <ref id="ref4">
      <label>4</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Levy</surname><given-names>SE</given-names></name><name><surname>Myers</surname><given-names>RM</given-names></name></person-group>:
<article-title>Advancements in next-generation sequencing.</article-title><source><italic toggle="yes">Annu. Rev. Genomics Hum. Genet.</italic></source><year>2016</year>;<volume>17</volume>(<issue>1</issue>):<fpage>95</fpage>–<lpage>115</lpage>.
<pub-id pub-id-type="doi">10.1146/annurev-genom-083115-022413</pub-id><?supplied-pmid 27362342?><pub-id pub-id-type="pmid">27362342</pub-id></mixed-citation>
    </ref>
    <ref id="ref5">
      <label>5</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Nielsen</surname><given-names>R</given-names></name><name><surname>Paul</surname><given-names>JS</given-names></name><name><surname>Albrechtsen</surname><given-names>A</given-names></name><etal/></person-group>:
<article-title>Genotype and snp calling from next-generation sequencing data.</article-title><source><italic toggle="yes">Nat. Rev. Genet.</italic></source><year>June 2011</year>;<volume>12</volume>(<issue>6</issue>):<fpage>443</fpage>–<lpage>451</lpage>.
<pub-id pub-id-type="doi">10.1038/nrg2986</pub-id><ext-link xlink:href="https://europepmc.org/articles/PMC3593722" ext-link-type="uri">Reference Source</ext-link><?supplied-pmid 21587300?><pub-id pub-id-type="pmid">21587300</pub-id></mixed-citation>
    </ref>
    <ref id="ref6">
      <label>6</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Li</surname><given-names>H</given-names></name></person-group>:
<article-title>A statistical framework for SNP calling, mutation discovery, association mapping and population genetical parameter estimation from sequencing data.</article-title><source><italic toggle="yes">Bioinformatics.</italic></source><year>09 2011</year>;<volume>27</volume>(<issue>21</issue>):<fpage>2987</fpage>–<lpage>2993</lpage>.
<pub-id pub-id-type="doi">10.1093/bioinformatics/btr509</pub-id><?supplied-pmid 21903627?><pub-id pub-id-type="pmid">21903627</pub-id></mixed-citation>
    </ref>
    <ref id="ref7">
      <label>7</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Van der Auwera</surname><given-names>GA</given-names></name><name><surname>Carneiro</surname><given-names>MO</given-names></name><name><surname>Hartl</surname><given-names>C</given-names></name><etal/></person-group>:
<article-title>From fastq data to high-confidence variant calls: The genome analysis toolkit best practices pipeline.</article-title><source><italic toggle="yes">Curr. Protoc. Bioinformatics.</italic></source><year>2013</year>;<volume>43</volume>(<issue>1</issue>):<fpage>11.10.1</fpage>–<lpage>11.10.33</lpage>.
<pub-id pub-id-type="doi">10.1002/0471250953.bi1110s43</pub-id><?supplied-pmid 25431634?><pub-id pub-id-type="pmid">25431634</pub-id></mixed-citation>
    </ref>
    <ref id="ref8">
      <label>8</label>
      <mixed-citation publication-type="other"><person-group person-group-type="author"><name><surname>Garrison</surname><given-names>E</given-names></name><name><surname>Marth</surname><given-names>G</given-names></name></person-group>:
<article-title>Haplotype-based variant detection from short-read sequencing.</article-title><year>2012</year>.
<ext-link xlink:href="https://github.com/freebayes/freebayes" ext-link-type="uri">Reference Source</ext-link></mixed-citation>
    </ref>
    <ref id="ref9">
      <label>9</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Crawford</surname><given-names>J</given-names></name><name><surname>Lazzaro</surname><given-names>B</given-names></name></person-group>:
<article-title>Assessing the accuracy and power of population genetic inference from low-pass next-generation sequencing data.</article-title><source><italic toggle="yes">Front. Genet.</italic></source><year>2012</year>;<volume>3</volume>:<fpage>66</fpage>.
<issn>1664-8021</issn>.
<pub-id pub-id-type="doi">10.3389/fgene.2012.00066</pub-id><?supplied-pmid 22536207?><pub-id pub-id-type="pmid">22536207</pub-id></mixed-citation>
    </ref>
    <ref id="ref10">
      <label>10</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Fumagalli</surname><given-names>M</given-names></name></person-group>:
<article-title>Assessing the effect of sequencing depth and sample size in population genetics inferences.</article-title><source><italic toggle="yes">PLoS One.</italic></source><year>11 2013</year>;<volume>8</volume>(<issue>11</issue>):<fpage>1</fpage>–<lpage>11</lpage>.
<pub-id pub-id-type="doi">10.1371/journal.pone.0079667</pub-id><?supplied-pmid 24260275?><pub-id pub-id-type="pmid">24260275</pub-id></mixed-citation>
    </ref>
    <ref id="ref11">
      <label>11</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Korneliussen</surname><given-names>TS</given-names></name><name><surname>Albrechtsen</surname><given-names>A</given-names></name><name><surname>Nielsen</surname><given-names>R</given-names></name></person-group>:
<article-title>Angsd: analysis of next generation sequencing data.</article-title><source><italic toggle="yes">BMC Bioinformatics.</italic></source><year>2014</year>;<volume>15</volume>(<issue>1</issue>):<fpage>356</fpage>.
<pub-id pub-id-type="doi">10.1186/s12859-014-0356-4</pub-id><?supplied-pmid 25420514?><pub-id pub-id-type="pmid">25420514</pub-id></mixed-citation>
    </ref>
    <ref id="ref12">
      <label>12</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Fumagalli</surname><given-names>M</given-names></name><name><surname>Vieira</surname><given-names>FG</given-names></name><name><surname>Linderoth</surname><given-names>T</given-names></name><etal/></person-group>:
<article-title>ngsTools: methods for population genetics analyses from next-generation sequencing data.</article-title><source><italic toggle="yes">Bioinformatics.</italic></source><year>May 2014</year>;<volume>30</volume>(<issue>10</issue>):<fpage>1486</fpage>–<lpage>1487</lpage>.
<pub-id pub-id-type="doi">10.1093/bioinformatics/btu041</pub-id><ext-link xlink:href="https://academic.oup.com/bioinformatics/article/30/10/1486/267009" ext-link-type="uri">Reference Source</ext-link><?supplied-pmid 24458950?><pub-id pub-id-type="pmid">24458950</pub-id></mixed-citation>
    </ref>
    <ref id="ref13">
      <label>13</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lou</surname><given-names>RN</given-names></name><name><surname>Jacobs</surname><given-names>A</given-names></name><name><surname>Wilder</surname><given-names>A</given-names></name><name><surname>Therkildsen</surname><given-names>NO</given-names></name></person-group>:
<article-title>A beginner’s guide to low-coverage whole genome sequencing for population genomics.</article-title><source><italic toggle="yes">Mol. Ecol.</italic></source><year>2021</year>;<volume>30</volume>:<fpage>5966</fpage>–<lpage>5993</lpage><pub-id pub-id-type="doi">10.1111/mec.16077</pub-id><pub-id pub-id-type="pmid">34250668</pub-id></mixed-citation>
    </ref>
    <ref id="ref14">
      <label>14</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Schlötterer</surname><given-names>C</given-names></name><name><surname>Tobler</surname><given-names>R</given-names></name><name><surname>Kofler</surname><given-names>R</given-names></name><name><surname>Nolte</surname><given-names>V</given-names></name></person-group>:
<article-title>Sequencing pools of individuals — mining genome-wide polymorphism data without big funding.</article-title><source><italic toggle="yes">Nat. Rev. Genet.</italic></source><year>Nov 2014</year>;<volume>15</volume>(<issue>11</issue>):<fpage>749</fpage>–<lpage>763</lpage>.
<pub-id pub-id-type="doi">10.1038/nrg3803</pub-id><?supplied-pmid 25246196?><pub-id pub-id-type="pmid">25246196</pub-id></mixed-citation>
    </ref>
    <ref id="ref15">
      <label>15</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kofler</surname><given-names>R</given-names></name><name><surname>Pandey</surname><given-names>RV</given-names></name><name><surname>Schlötterer</surname><given-names>C</given-names></name></person-group>:
<article-title>PoPoolation2: identifying differentiation between populations using sequencing of pooled DNA samples (Pool-Seq).</article-title><source><italic toggle="yes">Bioinformatics.</italic></source><year>10 2011</year>;<volume>27</volume>(<issue>24</issue>):<fpage>3435</fpage>–<lpage>3436</lpage>.
<pub-id pub-id-type="doi">10.1093/bioinformatics/btr589</pub-id><?supplied-pmid 22025480?><pub-id pub-id-type="pmid">22025480</pub-id></mixed-citation>
    </ref>
    <ref id="ref16">
      <label>16</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Raineri</surname><given-names>E</given-names></name><name><surname>Ferretti</surname><given-names>L</given-names></name><name><surname>Esteve-Codina</surname><given-names>A</given-names></name><etal/></person-group>:
<article-title>Snp calling by sequencing pooled samples.</article-title><source><italic toggle="yes">BMC Bioinformatics.</italic></source><year>Sep 2012</year>;<volume>13</volume>(<issue>1</issue>):<fpage>239</fpage>.
<pub-id pub-id-type="doi">10.1186/1471-2105-13-239</pub-id><?supplied-pmid 22992255?><pub-id pub-id-type="pmid">22992255</pub-id></mixed-citation>
    </ref>
    <ref id="ref17">
      <label>17</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bezanson</surname><given-names>J</given-names></name><name><surname>Edelman</surname><given-names>A</given-names></name><name><surname>Karpinski</surname><given-names>S</given-names></name><etal/></person-group>:
<article-title>Julia: A fresh approach to numerical computing.</article-title><source><italic toggle="yes">SIAM Rev.</italic></source><year>2017</year>;<volume>59</volume>(<issue>1</issue>):<fpage>65</fpage>–<lpage>98</lpage>.
<pub-id pub-id-type="doi">10.1137/141000671</pub-id></mixed-citation>
    </ref>
    <ref id="ref18">
      <label>18</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Sato</surname><given-names>K</given-names></name><name><surname>Tsuyuzaki</surname><given-names>K</given-names></name><name><surname>Shimizu</surname><given-names>K</given-names></name><etal/></person-group>:
<article-title>Cellfishing.jl: an ultrafast and scalable cell search method for single-cell rna sequencing.</article-title><source><italic toggle="yes">Genome Biol.</italic></source><year>Feb 2019</year>;<volume>20</volume>(<issue>1</issue>):<fpage>31</fpage>.
<pub-id pub-id-type="doi">10.1186/s13059-019-1639-x</pub-id><?supplied-pmid 30744683?><pub-id pub-id-type="pmid">30744683</pub-id></mixed-citation>
    </ref>
    <ref id="ref19">
      <label>19</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Li</surname><given-names>H</given-names></name><name><surname>Handsaker</surname><given-names>B</given-names></name><name><surname>Wysoker</surname><given-names>A</given-names></name><etal/></person-group>:
<article-title>The Sequence Alignment/Map format and SAMtools.</article-title><source><italic toggle="yes">Bioinformatics.</italic></source><year>06 2009</year>;<volume>25</volume>(<issue>16</issue>):<fpage>2078</fpage>–<lpage>2079</lpage>.
<pub-id pub-id-type="doi">10.1093/bioinformatics/btp352</pub-id><?supplied-pmid 19505943?><pub-id pub-id-type="pmid">19505943</pub-id></mixed-citation>
    </ref>
    <ref id="ref20">
      <label>20</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Fumagalli</surname><given-names>M</given-names></name></person-group>:
<article-title>ngsjulia: population genetic analysis of next-generation dna sequencing data with julia language.</article-title><source><italic toggle="yes">Zenodo.</italic></source><year>2022</year>.
<pub-id pub-id-type="doi">10.5281/zenodo.5886879</pub-id></mixed-citation>
    </ref>
    <ref id="ref21">
      <label>21</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>McKenna</surname><given-names>A</given-names></name><name><surname>Hanna</surname><given-names>M</given-names></name><name><surname>Banks</surname><given-names>E</given-names></name><etal/></person-group>:
<article-title>The Genome Analysis Toolkit: a MapReduce framework for analyzing next-generation DNA sequencing data.</article-title><source><italic toggle="yes">Genome Res.</italic></source><year>sep 2010</year>;<volume>20</volume>(<issue>9</issue>):<fpage>1297</fpage>–<lpage>303</lpage>.
<pub-id pub-id-type="doi">10.1101/gr.107524.110</pub-id><ext-link xlink:href="http://www.ncbi.nlm.nih.gov/pubmed/20644199" ext-link-type="uri">Reference Source</ext-link><pub-id pub-id-type="pmid">20644199</pub-id></mixed-citation>
    </ref>
    <ref id="ref22">
      <label>22</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Soraggi</surname><given-names>S</given-names></name><name><surname>Rhodes</surname><given-names>J</given-names></name><name><surname>Altinkaya</surname><given-names>I</given-names></name><etal/></person-group>:
<article-title>Hmmploidy: inference of ploidy levels from short-read sequencing data.</article-title><source><italic toggle="yes">Peer Commun J</italic></source>.<year>2022</year>;<volume>2</volume>: e60.
<pub-id pub-id-type="doi">10.24072/pcjournal.178</pub-id><ext-link xlink:href="https://peercommunityjournal.org/articles/10.24072/pcjournal.178/" ext-link-type="uri">Reference Source</ext-link></mixed-citation>
    </ref>
    <ref id="ref23">
      <label>23</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kim</surname><given-names>SY</given-names></name><name><surname>Lohmueller</surname><given-names>KE</given-names></name><name><surname>Albrechtsen</surname><given-names>A</given-names></name><etal/></person-group>:
<article-title>Estimation of allele frequency and association mapping using next-generation sequencing data.</article-title><source><italic toggle="yes">BMC Bioinformatics.</italic></source><year>Jun 2011</year>;<volume>12</volume>(<issue>1</issue>):<fpage>231</fpage>.
<pub-id pub-id-type="doi">10.1186/1471-2105-12-231</pub-id><?supplied-pmid 21663684?><pub-id pub-id-type="pmid">21663684</pub-id></mixed-citation>
    </ref>
    <ref id="ref24">
      <label>24</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Nielsen</surname><given-names>R</given-names></name><name><surname>Korneliussen</surname><given-names>T</given-names></name><name><surname>Albrechtsen</surname><given-names>A</given-names></name><etal/></person-group>:
<article-title>Snp calling, genotype calling, and sample allele frequency estimation from new-generation sequencing data.</article-title><source><italic toggle="yes">PLoS One.</italic></source><year>07 2012</year>;<volume>7</volume>(<issue>7</issue>):<fpage>1</fpage>–<lpage>10</lpage>.
<pub-id pub-id-type="doi">10.1371/journal.pone.0037558</pub-id><?supplied-pmid 22911679?><pub-id pub-id-type="pmid">22911679</pub-id></mixed-citation>
    </ref>
    <ref id="ref25">
      <label>25</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ewens</surname><given-names>WJ</given-names></name></person-group>:
<article-title>The sampling theory of selectively neutral alleles.</article-title><source><italic toggle="yes">Theor. Popul. Biol.</italic></source><year>1972</year>;<volume>3</volume>(<issue>1</issue>):<fpage>87</fpage>–<lpage>112</lpage>.
<pub-id pub-id-type="doi">10.1016/0040-5809(72)90035-4</pub-id><ext-link xlink:href="https://www.sciencedirect.com/science/article/pii/0040580972900354" ext-link-type="uri">Reference Source</ext-link><?supplied-pmid 4667078?><pub-id pub-id-type="pmid">4667078</pub-id></mixed-citation>
    </ref>
    <ref id="ref26">
      <label>26</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bielski</surname><given-names>CM</given-names></name><name><surname>Zehir</surname><given-names>A</given-names></name><name><surname>Penson</surname><given-names>AV</given-names></name><etal/></person-group>:
<article-title>Genome doubling shapes the evolution and prognosis of advanced cancers.</article-title><source><italic toggle="yes">Nature Genetics.</italic></source><year>Aug 2018</year>;<volume>50</volume>(<issue>8</issue>):<fpage>1189</fpage>–<lpage>1195</lpage>.
<pub-id pub-id-type="doi">10.1038/s41588-018-0165-1</pub-id><pub-id pub-id-type="pmid">30013179</pub-id></mixed-citation>
    </ref>
    <ref id="ref27">
      <label>27</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Fumagalli</surname><given-names>M</given-names></name><name><surname>Vieira</surname><given-names>FG</given-names></name><name><surname>Korneliussen</surname><given-names>TS</given-names></name><etal/></person-group>:
<article-title>Quantifying population genetic differentiation from next-generation sequencing data.</article-title><source><italic toggle="yes">Genetics.</italic></source><year>2013</year>;<volume>195</volume>(<issue>3</issue>):<fpage>979</fpage>–<lpage>992</lpage>.
<pub-id pub-id-type="doi">10.1534/genetics.113.154740</pub-id><ext-link xlink:href="https://www.genetics.org/content/195/3/979" ext-link-type="uri">Reference Source</ext-link><?supplied-pmid 23979584?><pub-id pub-id-type="pmid">23979584</pub-id></mixed-citation>
    </ref>
    <ref id="ref28">
      <label>28</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Fracassetti</surname><given-names>M</given-names></name><name><surname>Griffin</surname><given-names>P. C</given-names></name><name><surname>Willi</surname><given-names>Y.</given-names></name><etal/></person-group>:
<article-title>Validation of pooled whole-genome re-sequencing in arabidopsis lyrata.</article-title><source><italic toggle="yes">PLoS One</italic></source>.<year>2015</year>;<volume>10</volume>(<issue>10</issue>):<fpage>1</fpage>–<lpage>15</lpage>.
<pub-id pub-id-type="doi">10.1371/journal.pone.0140462</pub-id><pub-id pub-id-type="doi">10.1371/journal.pone.0140462</pub-id></mixed-citation>
    </ref>
    <ref id="ref29">
      <label>29</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Koboldt</surname><given-names>D. C</given-names></name><name><surname>Zhang</surname><given-names>Q</given-names></name><name><surname>Larson</surname><given-names>D. E</given-names></name><etal/></person-group>:
<article-title>Varscan 2: Somatic mutation and copy number alteration discovery in cancer by exome sequencing.</article-title><source><italic toggle="yes">Genome Research.</italic></source><year>2012</year>;<volume>22</volume>(<issue>3</issue>):<fpage>568</fpage>–<lpage>576</lpage>.
<pub-id pub-id-type="doi">10.1101/gr.129684.111</pub-id><ext-link xlink:href="http://genome.cshlporg/content/22/3/568.abstract" ext-link-type="uri">Reference Source</ext-link><pub-id pub-id-type="pmid">22300766</pub-id></mixed-citation>
    </ref>
    <ref id="ref30">
      <label>30</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Rhodes</surname><given-names>J.</given-names></name><name><surname>Abdolrasouli</surname><given-names>A.</given-names></name><name><surname>Farrer</surname><given-names>R. A</given-names></name><etal/></person-group><article-title>Genomic epidemiology of the uk outbreak of the emerging human fungal pathogen candida auris</article-title>.
<source><italic toggle="yes">Emerging Microbes &amp; Infections</italic></source>.<year>2018</year>;<volume>7</volume>(<issue>1</issue>):<fpage>1</fpage>–<lpage>12</lpage>.
<pub-id pub-id-type="doi">10.1038/s41426-018-0045-x</pub-id><pub-id pub-id-type="doi">10.1038/s41426-018-0045-x</pub-id><?supplied-pmid 29593275?><pub-id pub-id-type="pmid">29323102</pub-id></mixed-citation>
    </ref>
    <ref id="ref31">
      <label>31</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Navalkele</surname><given-names>B. D</given-names></name><name><surname>Revankar</surname><given-names>S</given-names></name><name><surname>Chandrasekar</surname><given-names>P.</given-names></name></person-group>:
<article-title>Candida auris: a worrisome, globally emerging pathogen.</article-title><source><italic toggle="yes">Expert Review of Anti-infective Therapy</italic></source>.<year>2017</year>;<volume>15</volume>(<issue>9</issue>):<fpage>819</fpage>–<lpage>827</lpage>.
<pub-id pub-id-type="doi">10.1080/14787210.2017.1364992</pub-id><pub-id pub-id-type="doi">10.1080/14787210.2017.1364992</pub-id><?supplied-pmid 28783385?><pub-id pub-id-type="pmid">28783385</pub-id></mixed-citation>
    </ref>
    <ref id="ref32">
      <label>32</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Logsdon</surname><given-names>GA</given-names></name><name><surname>Vollger</surname><given-names>MR</given-names></name><name><surname>Eichler</surname><given-names>EE</given-names></name></person-group>:
<article-title>Long-read human genome sequencing and its applications.</article-title><source><italic toggle="yes">Nat. Rev. Genet.</italic></source><year>Oct 2020</year>;<volume>21</volume>(<issue>10</issue>):<fpage>597</fpage>–<lpage>614</lpage>.
<pub-id pub-id-type="doi">10.1038/s41576-020-0236-x</pub-id><?supplied-pmid 32504078?><pub-id pub-id-type="pmid">32504078</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
<sub-article article-type="reviewer-report" id="report202079">
  <front-stub>
    <article-id pub-id-type="doi">10.5256/f1000research.150492.r202079</article-id>
    <title-group>
      <article-title>Reviewer response for version 3</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Léon</surname>
          <given-names>Jens</given-names>
        </name>
        <xref rid="r202079a1" ref-type="aff">1</xref>
        <role>Referee</role>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Schneider</surname>
          <given-names>Michael</given-names>
        </name>
        <xref rid="r202079a2" ref-type="aff">2</xref>
        <role>Co-referee</role>
      </contrib>
      <aff id="r202079a1"><label>1</label>University of Bonn, Bonn, Germany</aff>
      <aff id="r202079a2"><label>2</label>Forschungsinstitut fur Biologischen Landbau, Frick, Aargau, Switzerland</aff>
    </contrib-group>
    <author-notes>
      <fn fn-type="COI-statement">
        <p><bold>Competing interests: </bold>No competing interests were disclosed.</p>
      </fn>
    </author-notes>
    <pub-date pub-type="epub">
      <day>11</day>
      <month>10</month>
      <year>2023</year>
    </pub-date>
    <permissions>
      <copyright-statement>Copyright: © 2023 Léon J and Schneider M</copyright-statement>
      <copyright-year>2023</copyright-year>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p>This is an open access peer review report distributed under the terms of the Creative Commons Attribution Licence, which permits unrestricted use, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <related-article related-article-type="peer-reviewed-article" ext-link-type="doi" id="relatedArticleReport202079" xlink:href="10.12688/f1000research.104368.3">Version 3</related-article>
    <custom-meta-group>
      <custom-meta>
        <meta-name>recommendation</meta-name>
        <meta-value>approve-with-reservations</meta-value>
      </custom-meta>
    </custom-meta-group>
  </front-stub>
  <body>
    <p>First of all, I have to write that we are working on a method to estimate the allele frequency in crops by pool sequencing. Therefore, we are very interested in this new methodology. In this review our research group have a look on the manuscript. We are researchers dealing with population and quantitative genetics of plants and other are dealing with bioinformatics.</p>
    <p> We recognized that the examples and sources for the testing are rather complex. The authors explain their probes to be haploid, usually diploid but also polyploid. They state that the samples of the organisms are mostly biallelic but sometimes also tri-allelic. We expect that in a population we usually have multiple alleles. The authors are also dealing with pooled samples. But for researches dealing with theses probes, it is rather confusing to understand the restrictions. Regarding a divers readership, I would like to recommend that the authors clearly define their samples first (haploid, diploid or polyploid and whether biallelic or multi-allelic loci are expected). When dealing with pooled samples the readership should know about the expectation of the samples (e.g. pool of sperms or pollen grains are different from a pool of cells from an individuum). Analysing populations with pooled NGS, it would be important to know how the software deals with a highly heterogenous material, as several individuals in a population. Although the authors tried to group their methods, it is still unclear which expectations the authors have to the samples.</p>
    <p> It would be helpful to provide a code example of creating the mpileup file.</p>
    <p> Why do you need to provide a new tool to call SNPs? The three tools in the introduction are all solid options</p>
    <p> and can give allele frequency calls, too. Adding the info on the expected allele frequency is helpful - but the effect of this additional information</p>
    <p> would be worth demonstrating. E.g., by showing the accuracy of recalling the correct allele frequency with and without this term. Besides,</p>
    <p> how would someone with a heterogeneous population set this value?</p>
    <p> It would be helpful to illustrate the actual distribution of reads across the genome. It is hard to imagine that with a uniform coverage of 0.5,</p>
    <p> which is not uncommon these days to receive from a WGS run, a good recall rate of the allele frequency can be achieved. It would, therefore, be helpful to understand the assumed input data better and provide the lambda value of the Poisson model for read simulations.</p>
    <p> There is no information provided about the recall rate of simulated SNPs. How many SNPs were detected on the different sequencing depth levels,</p>
    <p> and how many were falsely discovered? This is a major problem in the other named variant callers at very low sequencing depth levels, as discussed</p>
    <p> in this manuscript, and it would be of high value to compare the accuracy and sensitivity of the new ngsPool approach and the "old" once, like bcftools</p>
    <p> and GATK.</p>
    <p> Real Arabidopsis data comparing ngsPool to VarScan. As previously mentioned, why not compare also to GATK, FreeBayes, and bcftools? VarScan to my knowledge is not one of the top tools in terms of variant detection.</p>
    <p> To give this manuscript more relevance and make the decision to use it or not more accessible for the reader, I would encourage the authors to provide the information if this new package performs more precisely than common tools, if not, or under which circumstances it does. If the accuracy is not improved, what are the other benefits? Time-saving, user-friendly output.</p>
    <p> Figure caption of Figure 1: the order in the graphics is not the same as the one in the description. That can be changed easily and helps the reader.</p>
    <p>Are the conclusions about the tool and its performance adequately supported by the findings presented in the article?</p>
    <p>Yes</p>
    <p>Is the rationale for developing the new software tool clearly explained?</p>
    <p>Yes</p>
    <p>Is the description of the software tool technically sound?</p>
    <p>Partly</p>
    <p>Are sufficient details of the code, methods and analysis (if applicable) provided to allow replication of the software development and its use by others?</p>
    <p>Partly</p>
    <p>Is sufficient information provided to allow interpretation of the expected output datasets and any results generated using the tool?</p>
    <p>Partly</p>
    <p>Reviewer Expertise:</p>
    <p>Population and quantitative genetics of crops, Plant breeding, cereals</p>
    <p>We confirm that we have read this submission and believe that we have an appropriate level of expertise to confirm that it is of an acceptable scientific standard, however we have significant reservations, as outlined above.</p>
  </body>
</sub-article>
<sub-article article-type="reviewer-report" id="report202073">
  <front-stub>
    <article-id pub-id-type="doi">10.5256/f1000research.150492.r202073</article-id>
    <title-group>
      <article-title>Reviewer response for version 3</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Oskolkov</surname>
          <given-names>Nikolay</given-names>
        </name>
        <xref rid="r202073a1" ref-type="aff">1</xref>
        <role>Referee</role>
        <contrib-id contrib-id-type="orcid">https://orcid.org/0000-0001-5326-8893</contrib-id>
      </contrib>
      <aff id="r202073a1"><label>1</label>Department of Biology, National Bioinformatics Infrastructure Sweden, Science for Life Laboratory, Lund University, Lund, Sweden</aff>
    </contrib-group>
    <author-notes>
      <fn fn-type="COI-statement">
        <p><bold>Competing interests: </bold>No competing interests were disclosed.</p>
      </fn>
    </author-notes>
    <pub-date pub-type="epub">
      <day>21</day>
      <month>9</month>
      <year>2023</year>
    </pub-date>
    <permissions>
      <copyright-statement>Copyright: © 2023 Oskolkov N</copyright-statement>
      <copyright-year>2023</copyright-year>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p>This is an open access peer review report distributed under the terms of the Creative Commons Attribution Licence, which permits unrestricted use, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <related-article related-article-type="peer-reviewed-article" ext-link-type="doi" id="relatedArticleReport202073" xlink:href="10.12688/f1000research.104368.3">Version 3</related-article>
    <custom-meta-group>
      <custom-meta>
        <meta-name>recommendation</meta-name>
        <meta-value>approve-with-reservations</meta-value>
      </custom-meta>
    </custom-meta-group>
  </front-stub>
  <body>
    <p>The authors suggest a population genomics tool written in Julia programming language. They demonstrate the performance of the tool on simulated and real pooled sequencing data. The manuscript is well written and technical details of the tool are well explained. In addition, documentation is provided together with the tool.</p>
    <p> I believe, it is potentially interesting to approach some bioinformatics analyses (such as population genomics) with Julia. However, I am still missing a clear motivation for re-writing e.g. genotype likelihoods and SFS computation in Julia. There are many popgen tools that are fast and accurate enough, e.g. ANGSD, so there should be a clear advantage of ngsJulia in some way compared to other tools. If the motivation is the outstanding speed or accuracy of ngsJulia, it should be clearly demonstrated. So my main concern is the lack of comparison of ngsJulia with other popgen tools.</p>
    <p> Next, I would not advertise ngsJulia as a “
<italic toggle="yes">population genetic analysis of next-generation sequencing data</italic>”, as from the text I got an impression that this was a quite pool-seq-specific tool. If ngsJulia is more general than a pool-seq data tool, it should be demonstrated and compared with other tools. Otherwise, I would suggest to change the title of the manuscript and make it less general and more specific. For example, accounting for polyploidy is a strength of ngsJulia, perhaps this should be emphasized more in the manuscript.</p>
    <p> I found it interesting and novel to determine the optimal K in the 1/f^K approximation of SFS profile with Kullback-Leibler optimization. However, as it seems to me from the Figure 5, this implementation in ngsJulia only works for D ~ 5 and large sample sizes. Perhaps other tools will not do a great job either, but as I mentioned above, I am missing the comparison with other tools.</p>
    <p> Minor comment:</p>
    <p> Page 7 I would encourage the authors to make the command line for ngsPool.jl more self-explanatory. More specifically, the “
<italic toggle="yes">–lrtSnp 6.64</italic>” flag is hard to grasp. Perhaps re-writing it in a way so that it becomes clear that 6.64 corresponds to p-value = 0.01, and replacing the flag “–lrtSnp 6.64” with “--pvalue 0.01” would be possible?</p>
    <p>Are the conclusions about the tool and its performance adequately supported by the findings presented in the article?</p>
    <p>Partly</p>
    <p>Is the rationale for developing the new software tool clearly explained?</p>
    <p>Partly</p>
    <p>Is the description of the software tool technically sound?</p>
    <p>Yes</p>
    <p>Are sufficient details of the code, methods and analysis (if applicable) provided to allow replication of the software development and its use by others?</p>
    <p>Yes</p>
    <p>Is sufficient information provided to allow interpretation of the expected output datasets and any results generated using the tool?</p>
    <p>Yes</p>
    <p>Reviewer Expertise:</p>
    <p>bioinformatics, genomics, medical genetics, ancient DNA</p>
    <p>I confirm that I have read this submission and believe that I have an appropriate level of expertise to confirm that it is of an acceptable scientific standard, however I have significant reservations, as outlined above.</p>
  </body>
</sub-article>
<sub-article article-type="reviewer-report" id="report187509">
  <front-stub>
    <article-id pub-id-type="doi">10.5256/f1000research.150492.r187509</article-id>
    <title-group>
      <article-title>Reviewer response for version 3</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>De Mita</surname>
          <given-names>Stéphane</given-names>
        </name>
        <xref rid="r187509a1" ref-type="aff">1</xref>
        <role>Referee</role>
        <contrib-id contrib-id-type="orcid">https://orcid.org/0000-0003-2752-865X</contrib-id>
      </contrib>
      <aff id="r187509a1"><label>1</label>Institut national de la recherche agronomique (INRAE), Paris, France</aff>
    </contrib-group>
    <author-notes>
      <fn fn-type="COI-statement">
        <p><bold>Competing interests: </bold>No competing interests were disclosed.</p>
      </fn>
    </author-notes>
    <pub-date pub-type="epub">
      <day>14</day>
      <month>8</month>
      <year>2023</year>
    </pub-date>
    <permissions>
      <copyright-statement>Copyright: © 2023 De Mita S</copyright-statement>
      <copyright-year>2023</copyright-year>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p>This is an open access peer review report distributed under the terms of the Creative Commons Attribution Licence, which permits unrestricted use, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <related-article related-article-type="peer-reviewed-article" ext-link-type="doi" id="relatedArticleReport187509" xlink:href="10.12688/f1000research.104368.3">Version 3</related-article>
    <custom-meta-group>
      <custom-meta>
        <meta-name>recommendation</meta-name>
        <meta-value>approve</meta-value>
      </custom-meta>
    </custom-meta-group>
  </front-stub>
  <body>
    <p>After considering the updated version and using the new documentation, I managed to run some tests successfully. However, I couldn't understand the return value of calcGenoLike without extrapolating from what it done in the triploid case in the tutorial.</p>
    <p>Are the conclusions about the tool and its performance adequately supported by the findings presented in the article?</p>
    <p>Yes</p>
    <p>Is the rationale for developing the new software tool clearly explained?</p>
    <p>Yes</p>
    <p>Is the description of the software tool technically sound?</p>
    <p>Yes</p>
    <p>Are sufficient details of the code, methods and analysis (if applicable) provided to allow replication of the software development and its use by others?</p>
    <p>Partly</p>
    <p>Is sufficient information provided to allow interpretation of the expected output datasets and any results generated using the tool?</p>
    <p>Partly</p>
    <p>Reviewer Expertise:</p>
    <p>Population genomics, phytopathology, programming (Python, C, C++).</p>
    <p>I confirm that I have read this submission and believe that I have an appropriate level of expertise to confirm that it is of an acceptable scientific standard.</p>
  </body>
</sub-article>
<sub-article article-type="reviewer-report" id="report160519">
  <front-stub>
    <article-id pub-id-type="doi">10.5256/f1000research.141471.r160519</article-id>
    <title-group>
      <article-title>Reviewer response for version 2</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>De Mita</surname>
          <given-names>Stéphane</given-names>
        </name>
        <xref rid="r160519a1" ref-type="aff">1</xref>
        <role>Referee</role>
        <contrib-id contrib-id-type="orcid">https://orcid.org/0000-0003-2752-865X</contrib-id>
      </contrib>
      <aff id="r160519a1"><label>1</label>Institut national de la recherche agronomique (INRAE), Paris, France</aff>
    </contrib-group>
    <author-notes>
      <fn fn-type="COI-statement">
        <p><bold>Competing interests: </bold>No competing interests were disclosed.</p>
      </fn>
    </author-notes>
    <pub-date pub-type="epub">
      <day>21</day>
      <month>2</month>
      <year>2023</year>
    </pub-date>
    <permissions>
      <copyright-statement>Copyright: © 2023 De Mita S</copyright-statement>
      <copyright-year>2023</copyright-year>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p>This is an open access peer review report distributed under the terms of the Creative Commons Attribution Licence, which permits unrestricted use, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <related-article related-article-type="peer-reviewed-article" ext-link-type="doi" id="relatedArticleReport160519" xlink:href="10.12688/f1000research.104368.2">Version 2</related-article>
    <custom-meta-group>
      <custom-meta>
        <meta-name>recommendation</meta-name>
        <meta-value>approve-with-reservations</meta-value>
      </custom-meta>
    </custom-meta-group>
  </front-stub>
  <body>
    <p>The article "ngsJulia: population genetic analysis of next-generation DNA sequencing data with Julia language" by Alex Mas-Sandoval and colleagues provides a library for the Julia addressing management of NGS data (provided in the PileUp format), SNP and genotype calling allowing for arbritary and dataset-varying ploidy, and maximum-likelihood parameter estimation.</p>
    <p> I've really discovered the Julia language while reviewing this article and I agree that it makes sense to use this language for developing tools for the analysis of NGS data. Providing a toolkit to perfom SNP and genotype calling under a probabilistic models makes much sense and can be useful for the community. The ngsPool application provided can be of widespread use while ngsPloidy can be a very precious tool for specific systems which lack proper software right now.</p>
    <p> Here is a list of random typos or detail-level suggestions:
<list list-type="bullet"><list-item><p>"polidy" in the "Revision" box.</p></list-item><list-item><p>Methods: you should add Combinatorics as a requirement.</p></list-item><list-item><p>I am not sure to understand the header "Operation".</p></list-item><list-item><p>One or two sentences, presenting biological systems where the study of multiploidy (or in general MLE of ploidy) is relevant, would help.</p></list-item><list-item><p>I am not sure giving an example of a R command line for simulating data is a good choice. For a Julia package I'd like to see some Julia code example, although it is not absolutely necessary.</p></list-item><list-item><p>Discussion: rewrite: "is highly applicable in educational contexts"</p></list-item></list> I do not get this sentence at all: "
<italic toggle="yes">[ngsJulia] allows for efficient testing of experimental designs and, therefore, would be beneficial for initial planning of any sequencing experiments.</italic>"</p>
    <p> My big issue with the paper, which is confirmed by a first look at the package, is that the content of the ngsJulia library isn't described, even succinctly. There should be an API and the article should point to it.</p>
    <p> In my view there is still need for more documentation. Tutorials are great and (speaking by experience) they are often essential, but at some point you need for some more rigourous reference documentation (API for the library, CLI for the applications). The Application Programmer Interface should be documented so that the reading planning to write a script using the library can know what functions are available, what input they expect, and if possible what errors can be expected. This remark also applies to the Command Line Interface of the two applications ngsPloidy and ngsPool. The help page produces an option summary, which is fine, but the meaning of the options isn't documented.</p>
    <p> Below I report the results of my testing of the three components of the software.</p>
    <p> *** ngsPloidy ***</p>
    <p> The tutorial is a good resource to start, but some points need clarification, and a more rigourous reference manual of the command-line interface would help a lot.</p>
    <p> I am not sure that it is a good idea to start by defining environment variables, which make the commands much less friendly. At least, do mention that you are defining environment variables so that unaware users can know where to look at if they need more information. Anyway the julia command should be available is it is installed in the environment which should be considered to be the default. By the way, "Julia language" is a poor choice of words.</p>
    <p> I am sorry, but I didn't get at all what "genotype probabilities" where and whether and why would I need to to create them. I have no idea what writePars is doing and -p and -s arguments aren't clearly documented.</p>
    <p> There is a "variabile" (instead of "variable") in the in simulMpileup.R manual. The simulation script needs its own documentation.</p>
    <p> Personally, I would think that either bam files containing aligned reads, or VCF, would be a better choice than PileUp, because users are more likely to already have those.</p>
    <p> Suggestions: you could print progress information while running, and displays error messages in stdout instead of stderr (especially useful since you advice users to redirect results which are printed in stdout.</p>
    <p> I tested ngsPloidy using data from my own read simulator. I thought it was a good idea to bring data from an independent source, and also I am more comfortable using it. It generated data from diploid and tetraploid organisms, using a coalescent model to draw allelic frequencies.</p>
    <p> Then I ran this type of commands:</p>
    <p> $ julia ../ngsJulia/ngsPloidy/ngsPloidy.jl --fin diplo.plp.gz --nSamples 20 &gt; diplo.out</p>
    <p> Running times were (tens of minutes up to an hour for rather small simulated datasets). I suspect that I should have dropped non-varying sites from the PileUp (since I didn't incorporate errors, 90% of my sites are completely fixed).</p>
    <p> When I simulated only diploid or tetraploid individuals, they are completely inferred (although in some parameter settings I had tetraploid individuals estimated as a mixture of tetra- and pentaploid individuals). When I merge diploid and tetraploid individuals in a single PileUp, the software tended to estimate a mixture of diploid and triploid individuals. So I suspect that I am doing something wrong. Most likely I miss an important step of the procedure and the documentation might be to blame.</p>
    <p> *** ngsPool ***</p>
    <p> Among the command line arguments, by "LRT", do you mean "threshold"?</p>
    <p> I got an exception when the pileup file didn't contain reference bases. I understand that this should be an error but it could be displayed in a more accessible manner.</p>
    <p> Some test results are reported as "Inf" or "-Inf" which is also not necessarily clear.</p>
    <p> I was not totally clear when --lrt* arguments should be used.</p>
    <p> I got a problem to understand the difference between maf, saf_MLE and saf_E? It is also a problem with the article, where the logic is mentioned by not really explained.</p>
    <p> I ran a simulation with a 20,000 bp genome, 20 diploid individuals, 10% of sites with diallelic polymorphism, 10,000 reads of 50 bp (so an average depth of 25X).</p>
    <p> I ran:</p>
    <p> # julia ../ngsJulia/ngsPool/ngsPool.jl --fin data.plp.gz \</p>
    <p>             --fout results.txt.gz  --lrtSnp 6.64 </p>
    <p> It took ~ 4:30 minutes and the results are fitting the simulation parameters. All sites called as SNPs are correct and only occasionnaly a few number (~1/1000) of "real" SNPs aren't called, and whose are always singletons. There is also a good agreement between the 'real' and estimated maf.</p>
    <p> Using the --nChroms option gives similar results and all estimated frequencies are correct.</p>
    <p> *** ngsJulia ***</p>
    <p> An API reference  was badly needed. I tried to start writing a Julia script analysing one of the datasets used for previous testing and didn't get very far. My lack of knowledge of Julia didn't help, for sure.</p>
    <p> The last paragraph of the readme "In general, ngsJulia provides templates..." should come first.</p>
    <p> Is it normal that we need to import Combinatorics even if we are not directly using it (i.e. I reckon that ngsJulia should import it itself).</p>
    <p> Almost instantly, I have the following line crashing:</p>
    <p>   nucleoLikes = [calcGenoLike(myReads, [i], 1) for i=1:4]</p>
    <p> The error message is: ERROR: LoadError: BoundsError: attempt to access SubString{String}</p>
    <p>   at index [2]</p>
    <p> I thought it was because I was trying to pass a site (represented by a Reads object, I assume), containing a single read base. But in the end it is not this (sites with more bases are not accepted either). Obviously I am making a very basic error but the lack of documentation doesn't help me.</p>
    <p>Are the conclusions about the tool and its performance adequately supported by the findings presented in the article?</p>
    <p>Yes</p>
    <p>Is the rationale for developing the new software tool clearly explained?</p>
    <p>Yes</p>
    <p>Is the description of the software tool technically sound?</p>
    <p>Yes</p>
    <p>Are sufficient details of the code, methods and analysis (if applicable) provided to allow replication of the software development and its use by others?</p>
    <p>Partly</p>
    <p>Is sufficient information provided to allow interpretation of the expected output datasets and any results generated using the tool?</p>
    <p>Partly</p>
    <p>Reviewer Expertise:</p>
    <p>Population genomics, phytopathology, programming (Python, C, C++).</p>
    <p>I confirm that I have read this submission and believe that I have an appropriate level of expertise to confirm that it is of an acceptable scientific standard, however I have significant reservations, as outlined above.</p>
  </body>
</sub-article>
<sub-article article-type="reviewer-report" id="report128232">
  <front-stub>
    <article-id pub-id-type="doi">10.5256/f1000research.114499.r128232</article-id>
    <title-group>
      <article-title>Reviewer response for version 1</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Clark</surname>
          <given-names>Lindsay V.</given-names>
        </name>
        <xref rid="r128232a1" ref-type="aff">1</xref>
        <role>Referee</role>
        <contrib-id contrib-id-type="orcid">https://orcid.org/0000-0002-3881-9252</contrib-id>
      </contrib>
      <aff id="r128232a1"><label>1</label>Roy J. Carver Biotechnology Center, University of Illinois at Urbana-Champaign, Urbana, IL, USA</aff>
    </contrib-group>
    <author-notes>
      <fn fn-type="COI-statement">
        <p><bold>Competing interests: </bold>No competing interests were disclosed.</p>
      </fn>
    </author-notes>
    <pub-date pub-type="epub">
      <day>13</day>
      <month>4</month>
      <year>2022</year>
    </pub-date>
    <permissions>
      <copyright-statement>Copyright: © 2022 Clark LV</copyright-statement>
      <copyright-year>2022</copyright-year>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p>This is an open access peer review report distributed under the terms of the Creative Commons Attribution Licence, which permits unrestricted use, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <related-article related-article-type="peer-reviewed-article" ext-link-type="doi" id="relatedArticleReport128232" xlink:href="10.12688/f1000research.104368.1">Version 1</related-article>
    <custom-meta-group>
      <custom-meta>
        <meta-name>recommendation</meta-name>
        <meta-value>approve-with-reservations</meta-value>
      </custom-meta>
    </custom-meta-group>
  </front-stub>
  <body>
    <p>The manuscript by Mas-Sandoval et al. describes ngsJulia, a collection of functions and scripts in Julia and R for estimating genotype likelihoods from short read DNA sequencing data, as well as estimating allele frequencies in pooled samples, and estimating ploidy where it is unknown. It seems that the goal is also to enable biologists proficient in Julia to develop their own custom genotype calling and population genetic analysis scripts starting with the provided functions for estimating genotype likelihoods. As it is, the manuscript and software suffer from two major flaws: (1) the software and its outputs are not well documented for users or developers, and (2) testing is only performed on simulated data, not empirical data.</p>
    <p> The software documentation is not very approachable as it currently is. End-to-end tutorials with a real dataset (or something closely resembling a real dataset) are needed for all applications. How are the output files formatted and how might the user further process those files to address biological questions? For example, it seems that one could use ngsJulia to generate a matrix of genotype calls across samples and loci, starting from a set of mpileup files, but from the documentation I have no idea how to accomplish this task.</p>
    <p> There are eleven different functions for estimating genotype log likelihoods, depending on ploidy, with four different functions for haploids. This strikes me as poor software design. At minimum the eight calcGenoLogLikeX_MajorMinor functions could be collapsed into one, with ploidy as an added argument to the function. Having a single function would make it much easier to update the code and ensure that there aren’t any bugs that prevent it from working consistently across ploidy levels. The hard-coding of tuples for every possible genotype, and the repetitive if-else statements, could be replaced with a more programmatic approach. The programmatic approach with ploidy as a function argument would also enable the software to be used for organisms with ploidy greater than octoploid.</p>
    <p> If I understand correctly, the SNP calling algorithm only seems to work on haploid samples, which would exclude it from being used in most studies. Please clarify.</p>
    <p> The estimation of ploidy from sequencing data using the ngsPloidy is a valuable addition. As an author of other software for marker analysis in polyploids, I frequently hear requests for such functionality, so I expect ngsPloidy to get a lot of use. It would be helpful to include a comparison to other tools such as ploidyNGS, ConPADE, and/or SuperMASSA. Additionally, the algorithm is only tested on a simulated dataset, and I would like to see it tested on an empirical dataset (with flow cytometry used as ground truth), both to see how well it scales up to thousands of markers, and how well it deals with potentially messy data.</p>
    <p> The authors use the term “aneuploidy” incorrectly. Aneuploidy refers to different chromosomes having different copy numbers within one individual. The authors seem to mean different individuals within a population having different ploidies. “Multiploid” is one term for this although depending on the field it is sometimes used as a synonym for “polyploid”.</p>
    <p> How should the user estimate the shape of the site frequency spectrum and the effective population size, which are required inputs for ngsPloidy?</p>
    <p> I tried “Case A” in the ngsPloidy tutorial. It took me a few minutes to figure out the (undocumented) contents of test.A.txt. I assume that columns 6-25 are the true genotypes, column 5 is the allele frequency, and column 26 is the sample allele frequency. The tutorial otherwise worked. However, I didn’t get anything useful when I added the --callGeno flag.</p>
    <p> Similarly to ngsPloidy, ngsPool is only tested on simulated data.</p>
    <p> Minor comments:
<list list-type="bullet"><list-item><p>There seems to be a missing right bracket on the left side of equation 2.</p></list-item><list-item><p>The Figure 2 caption needs to more explicitly define the abbreviations MLE and SAF.</p></list-item><list-item><p>All of the code to reproduce the analysis in the paper is provided, although there is no documentation explaining the code or indicating which scripts go with which figures.</p></list-item></list>
</p>
    <p>Are the conclusions about the tool and its performance adequately supported by the findings presented in the article?</p>
    <p>Partly</p>
    <p>Is the rationale for developing the new software tool clearly explained?</p>
    <p>Partly</p>
    <p>Is the description of the software tool technically sound?</p>
    <p>Partly</p>
    <p>Are sufficient details of the code, methods and analysis (if applicable) provided to allow replication of the software development and its use by others?</p>
    <p>Partly</p>
    <p>Is sufficient information provided to allow interpretation of the expected output datasets and any results generated using the tool?</p>
    <p>Partly</p>
    <p>Reviewer Expertise:</p>
    <p>Bioinformatics, polyploidy, population genetics</p>
    <p>I confirm that I have read this submission and believe that I have an appropriate level of expertise to confirm that it is of an acceptable scientific standard, however I have significant reservations, as outlined above.</p>
  </body>
  <sub-article article-type="response" id="comment9050-128232">
    <front-stub>
      <contrib-group>
        <contrib contrib-type="author">
          <name>
            <surname>Fumagalli</surname>
            <given-names>Matteo</given-names>
          </name>
          <aff>Queen Mary, University of London, UK</aff>
        </contrib>
      </contrib-group>
      <author-notes>
        <fn fn-type="COI-statement">
          <p><bold>Competing interests: </bold>No competing interests were disclosed.</p>
        </fn>
      </author-notes>
      <pub-date pub-type="epub">
        <day>22</day>
        <month>11</month>
        <year>2022</year>
      </pub-date>
    </front-stub>
    <body>
      <p>
        <bold>The manuscript by Mas-Sandoval et al. describes ngsJulia, a collection of functions and scripts in Julia and R for estimating genotype likelihoods from short read DNA sequencing data, as well as estimating allele frequencies in pooled samples, and estimating ploidy where it is unknown. It seems that the goal is also to enable biologists proficient in Julia to develop their own custom genotype calling and population genetic analysis scripts starting with the provided functions for estimating genotype likelihoods. As it is, the manuscript and software suffer from two major flaws: (1) the software and its outputs are not well documented for users or developers, and (2) testing is only performed on simulated data, not empirical data.</bold>
      </p>
      <p> Thank you for reviewing our manuscript. We addressed all concerns by improving the applicability and documentation of our software and by applying it to empirical data.</p>
      <p>
        <bold>The software documentation is not very approachable as it currently is. End-to-end tutorials with a real dataset (or something closely resembling a real dataset) are needed for all applications. How are the output files formatted and how might the user further process those files to address biological questions? For example, it seems that one could use ngsJulia to generate a matrix of genotype calls across samples and loci, starting from a set of mpileup files, but from the documentation I have no idea how to accomplish this task.</bold>
      </p>
      <p> We improved the documentation as requested in the specific comments (see below). Examples from simulated mpileup files under various conditions are provided and now clarified. In our response, we clarified that ngsPloidy does not provide a matrix of genotype calls but rather estimates ploidy levels.</p>
      <p>
        <bold>There are eleven different functions for estimating genotype log likelihoods, depending on ploidy, with four different functions for haploids. This strikes me as poor software design. At minimum the eight calcGenoLogLikeX_MajorMinor functions could be collapsed into one, with ploidy as an added argument to the function. Having a single function would make it much easier to update the code and ensure that there aren’t any bugs that prevent it from working consistently across ploidy levels. The hard-coding of tuples for every possible genotype, and the repetitive if-else statements, could be replaced with a more programmatic approach. The programmatic approach with ploidy as a function argument would also enable the software to be used for organisms with ploidy greater than octoploid.</bold>
      </p>
      <p> We agree with this comment and we now replace all those functions into a unique one that takes ploidy as input parameter (see calcGenoLike function in file functions.jl). We also replaced all if-else statements with a more programmatic approach which makes ngsPloidy (see file ngsPloidy.jl).</p>
      <p>
        <bold>If I understand correctly, the SNP calling algorithm only seems to work on haploid samples, which would exclude it from being used in most studies. Please clarify.</bold>
      </p>
      <p> The SNP calling algorithm relies on either a likelihood ratio test with the null hypothesis being the pooled allele frequency equal to 0 (similar to Kim et al. 2011 Bioinformatics), or from setting a threshold on the estimated pooled allele frequency. Therefore, it is applicable to all ploidy levels.</p>
      <p>
        <bold>The estimation of ploidy from sequencing data using the ngsPloidy is a valuable addition. As an author of other software for marker analysis in polyploids, I frequently hear requests for such functionality, so I expect ngsPloidy to get a lot of use. It would be helpful to include a comparison to other tools such as ploidyNGS, ConPADE, and/or SuperMASSA. Additionally, the algorithm is only tested on a simulated dataset, and I would like to see it tested on an empirical dataset (with flow cytometry used as ground truth), both to see how well it scales up to thousands of markers, and how well it deals with potentially messy data.</bold>
      </p>
      <p> This manuscript (submitted as Software Tool Article) aims at proposing a new implementation rather than a new methodology. Additionally, the likelihood function to estimate ploidy levels partly mirrors the approach taken by a parallel study (
<ext-link xlink:href="https://www.biorxiv.org/content/10.1101/2021.06.29.450340v3" ext-link-type="uri">https://www.biorxiv.org/content/10.1101/2021.06.29.450340</ext-link>) where we provide extensive comparisons with competing algorithms (including ngsPloidy). Therefore, a comprehensive benchmarking of ngsPloidy against alternative software would be outside the scope of this paper.</p>
      <p> As suggested, we applied ngsPloidy to a real empirical data of isolates from an outbreak of
<italic toggle="yes">Candida auris</italic> (Rhodes et al. 2018). Whilst polyploidy could be associated with multidrug-resistant phenotypes, we inferred haploidy for all samples and contigs, in line with findings from the original study. We added a paragraph on both methods and results sections to describe this new analysis.</p>
      <p>
        <bold>The authors use the term “aneuploidy” incorrectly. Aneuploidy refers to different chromosomes having different copy numbers within one individual. The authors seem to mean different individuals within a population having different ploidies. “Multiploid” is one term for this although depending on the field it is sometimes used as a synonym for “polyploid”.</bold>
      </p>
      <p> We replaced all occurrences of “aneuploidy” in the text and documentation with “multiploidy”.</p>
      <p>
        <bold>How should the user estimate the shape of the site frequency spectrum and the effective population size, which are required inputs for ngsPloidy?</bold>
      </p>
      <p> The need to specify the shape of the site frequency spectrum and the effective population size is only required when the sample size is too low to have a meaningful estimate of the population allele frequency. Whilst these parameters are not known a prior for nonmodel species, in practice we found that, as long as values are within a reasonable range and the coverage is sufficient, there is not a significant bias associated with inaccurate settings of these parameters. In fact, they simply determine the prior probability of sampling allele frequencies and, for most species and populations, this distribution tends to have more mass at lower frequency values.</p>
      <p>
        <bold>I tried “Case A” in the ngsPloidy tutorial. It took me a few minutes to figure out the (undocumented) contents of test.A.txt. I assume that columns 6-25 are the true genotypes, column 5 is the allele frequency, and column 26 is the sample allele frequency. The tutorial otherwise worked. However, I didn’t get anything useful when I added the --callGeno flag.</bold>
      </p>
      <p> We now indicate the contents of all columns of the simulated file. The -callGeno flag does not output called genotypes but rather estimate ploidy by first assigning (calling) genotypes, and thus disabling the integrating over unknown genotypes. This is now clarified in the documentation.</p>
      <p>
        <bold>Similarly to ngsPloidy, ngsPool is only tested on simulated data.</bold>
      </p>
      <p> We now also present an application of ngsPool to empirical data. We reanalysed genomic data from
<italic toggle="yes">Arabidopsis</italic>
<italic toggle="yes"> lyrata</italic> (Fracassetti et al. 2015). In this study, authors generated data both by genotype-by-sequencing and by pooled-sequencing, with the former providing ground-truth values for genotype and allele calls. We found that estimates of minor allele frequencies using ngsPool yield a lower RMSE (root mean squared error) than estimates from Varscan across all SNPs analysed. We added a paragraph both in the methods and results sections to describe these new analyses.</p>
      <p>
        <bold>Minor comments: </bold>
      </p>
      <p>
        <bold>There seems to be a missing right bracket on the left side of equation 2.</bold>
      </p>
      <p> Fixed.</p>
      <p>
        <bold>The Figure 2 caption needs to more explicitly define the abbreviations MLE and SAF.</bold>
      </p>
      <p> We added the acronyms SAF and MLE in the caption.</p>
      <p>
        <bold>All of the code to reproduce the analysis in the paper is provided, although there is no documentation explaining the code or indicating which scripts go with which figures. </bold>
      </p>
      <p> In
<ext-link xlink:href="https://github.com/mfumagalli/ngsJulia/tree/master/paper" ext-link-type="uri">https://github.com/mfumagalli/ngsJulia/tree/master/paper</ext-link> we provide all code to replicate the analyses in the paper. As now indicated, ploidy/do.sh would replicate the simulations and estimation of ploidy variation. We now clarify that in the pool and pool/plots folder each folder/script corresponds to the specific figure in the paper.</p>
    </body>
  </sub-article>
</sub-article>
<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.2 20190208//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.2?>
<?ConverterInfo.XSLTName jats2jats3.xsl?>
<?ConverterInfo.Version 1?>
<?subarticle report202079?>
<?properties open_access?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">F1000Res</journal-id>
    <journal-id journal-id-type="iso-abbrev">F1000Res</journal-id>
    <journal-title-group>
      <journal-title>F1000Research</journal-title>
    </journal-title-group>
    <issn pub-type="epub">2046-1402</issn>
    <publisher>
      <publisher-name>F1000 Research Limited</publisher-name>
      <publisher-loc>London, UK</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">10514575</article-id>
    <article-id pub-id-type="doi">10.12688/f1000research.104368.3</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Software Tool Article</subject>
      </subj-group>
      <subj-group>
        <subject>Articles</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>ngsJulia: population genetic analysis of next-generation DNA sequencing data with Julia language</article-title>
      <fn-group content-type="pub-status">
        <fn>
          <p>[version 3; peer review: 1 approved</p>
        </fn>
      </fn-group>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Mas-Sandoval</surname>
          <given-names>Alex</given-names>
        </name>
        <role content-type="http://credit.niso.org/">Investigation</role>
        <role content-type="http://credit.niso.org/">Visualization</role>
        <role content-type="http://credit.niso.org/">Writing – Review &amp; Editing</role>
        <contrib-id contrib-id-type="orcid">https://orcid.org/0000-0002-1712-9404</contrib-id>
        <xref rid="a1" ref-type="aff">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Jin</surname>
          <given-names>Chenyu</given-names>
        </name>
        <role content-type="http://credit.niso.org/">Investigation</role>
        <role content-type="http://credit.niso.org/">Software</role>
        <role content-type="http://credit.niso.org/">Writing – Review &amp; Editing</role>
        <xref rid="a1" ref-type="aff">1</xref>
        <xref rid="a2" ref-type="aff">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Fracassetti</surname>
          <given-names>Marco</given-names>
        </name>
        <role content-type="http://credit.niso.org/">Data Curation</role>
        <role content-type="http://credit.niso.org/">Writing – Review &amp; Editing</role>
        <contrib-id contrib-id-type="orcid">https://orcid.org/0000-0002-2962-2669</contrib-id>
        <xref rid="a3" ref-type="aff">3</xref>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <name>
          <surname>Fumagalli</surname>
          <given-names>Matteo</given-names>
        </name>
        <role content-type="http://credit.niso.org/">Conceptualization</role>
        <role content-type="http://credit.niso.org/">Formal Analysis</role>
        <role content-type="http://credit.niso.org/">Funding Acquisition</role>
        <role content-type="http://credit.niso.org/">Investigation</role>
        <role content-type="http://credit.niso.org/">Methodology</role>
        <role content-type="http://credit.niso.org/">Project Administration</role>
        <role content-type="http://credit.niso.org/">Software</role>
        <role content-type="http://credit.niso.org/">Visualization</role>
        <role content-type="http://credit.niso.org/">Writing – Original Draft Preparation</role>
        <contrib-id contrib-id-type="orcid">https://orcid.org/0000-0002-4084-2953</contrib-id>
        <xref rid="c1" ref-type="corresp">a</xref>
        <xref rid="a1" ref-type="aff">1</xref>
        <xref rid="a4" ref-type="aff">4</xref>
      </contrib>
      <aff id="a1"><label>1</label>Department of Life Sciences, Imperial College London, London, UK</aff>
      <aff id="a2"><label>2</label>Institute of population genetics, University of Veterinary Medicine Vienna, Vienna, Austria</aff>
      <aff id="a3"><label>3</label>Department of Ecology, Environment and Plant Sciences, Stockholm University, Stockholm, Sweden</aff>
      <aff id="a4"><label>4</label>School of Biological and Behavioural Science, Queen Mary, University of London, London, UK</aff>
    </contrib-group>
    <author-notes>
      <corresp id="c1">
        <label>a</label>
        <email xlink:href="mailto:m.fumagalli@qmul.ac.uk">m.fumagalli@qmul.ac.uk</email>
      </corresp>
      <fn fn-type="COI-statement">
        <p>No competing interests were disclosed.</p>
      </fn>
    </author-notes>
    <pub-date pub-type="epub">
      <day>14</day>
      <month>7</month>
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2022</year>
    </pub-date>
    <volume>11</volume>
    <elocation-id>126</elocation-id>
    <history>
      <date date-type="accepted">
        <day>29</day>
        <month>6</month>
        <year>2023</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>Copyright: © 2023 Mas-Sandoval A et al.</copyright-statement>
      <copyright-year>2023</copyright-year>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p>This is an open access article distributed under the terms of the Creative Commons Attribution Licence, which permits unrestricted use, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <self-uri content-type="pdf" xlink:href="f1000research-11-150492.pdf"/>
    <abstract>
      <p>A sound analysis of DNA sequencing data is important to extract meaningful information and infer quantities of interest. Sequencing and mapping errors coupled with low and variable coverage hamper the identification of genotypes and variants and the estimation of population genetic parameters. Methods and implementations to estimate population genetic parameters from sequencing data available nowadays either are suitable for the analysis of genomes from model organisms only, require moderate sequencing coverage, or are not easily adaptable to specific applications. To address these issues, we introduce ngsJulia, a collection of templates and functions in Julia language to process short-read sequencing data for population genetic analysis. We further describe two implementations, ngsPool and ngsPloidy, for the analysis of pooled sequencing data and polyploid genomes, respectively. Through simulations, we illustrate the performance of estimating various population genetic parameters using these implementations, using both established and novel statistical methods. These results inform on optimal experimental design and demonstrate the applicability of methods in ngsJulia to estimate parameters of interest even from low coverage sequencing data. ngsJulia provide users with a flexible and efficient framework for ad hoc analysis of sequencing data.ngsJulia is available from: https://github.com/mfumagalli/ngsJulia</p>
    </abstract>
    <kwd-group kwd-group-type="author">
      <kwd>high-throughput sequencing data</kwd>
      <kwd>population genetics</kwd>
      <kwd>genotype likelihoods</kwd>
      <kwd>Julia language</kwd>
      <kwd>pooled sequencing</kwd>
      <kwd>polyploidy</kwd>
      <kwd>aneuploidy</kwd>
    </kwd-group>
    <funding-group>
      <award-group id="fund-1">
        <funding-source>The Leverhulme Trust</funding-source>
        <award-id>RPG-2018-208</award-id>
      </award-group>
      <funding-statement>MF and AMS are funded The Leverhulme Research Project Grant RPG-2018-208.</funding-statement>
      <funding-statement>
        <italic toggle="yes">The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.</italic>
      </funding-statement>
    </funding-group>
  </article-meta>
  <notes notes-type="version-changes">
    <sec sec-type="version-changes">
      <label>Revised</label>
      <title>Amendments from Version 2</title>
      <p>In the revised version, we provide users with a comprehensive online documentation of APIs and CLIs at
<ext-link xlink:href="https://ngsjulia.readthedocs.io" ext-link-type="uri">https://ngsjulia.readthedocs.io</ext-link>. Additionally, all functions have docstring documentation. The methodology behind some of the implementations has been clarified and references on the applicability of said methods have been added. We also rephrased few sentences for clarity as suggested by the reviewer, and fixed few typos. We believe that these changes significantly enhance the user’s experience and simplify the interpretation of results obtained using ngsJulia.</p>
    </sec>
  </notes>
</front>
<body>
  <sec sec-type="intro" id="sec1">
    <title>Introduction</title>
    <p>Population genetics, i.e., the study of genetic variation within and between groups, plays a central role in evolutionary inferences. The quantification of genetic diversity serves the basis for the inference of neutral
<sup><xref rid="ref1" ref-type="bibr">1</xref></sup> and adaptive
<sup><xref rid="ref2" ref-type="bibr">2</xref></sup> events that characterised the history of different populations. Additionally, the comparison of allele frequencies between groups (i.e. cases and controls) is an important aspect in biomedical and clinical sciences.
<sup><xref rid="ref3" ref-type="bibr">3</xref></sup>
</p>
    <p>In the last 20 years, next-generation sequencing (NGS) technologies allowed researchers to generate unprecedented amount of genomic data for a wide range of organisms.
<sup><xref rid="ref4" ref-type="bibr">4</xref></sup> This revolution transformed population genetics (therefore also labelled as population genomics) to a data-driven discipline. Data produced by short-read sequencing machines (still the most accessible platform worldwide) consist of a collection of relatively short (approx. 100 base pairs) fragments of DNA which are then mapped or
<italic toggle="yes">de novo</italic> assembled to form a contiguous sequence.
<sup><xref rid="ref4" ref-type="bibr">4</xref></sup> At each genomic position, all observed sequenced reads are used to infer the per-sample genotype (an operation called ‘genotype calling’) and the inter-samples variability, i.e., whether a particular site is polymorphic (an operation called ‘single-nucleotide polymorphism (SNP) calling’).
<sup><xref rid="ref5" ref-type="bibr">5</xref></sup>
</p>
    <p>To this end, several software packages have been implemented to perform genotype and SNP calling from NGS data, the most popular ones being
<monospace>samtools/bcftools</monospace>,
<sup><xref rid="ref6" ref-type="bibr">6</xref></sup>
<monospace>GATK</monospace>,
<sup><xref rid="ref7" ref-type="bibr">7</xref></sup> and
<monospace>freeBayes</monospace>.
<sup><xref rid="ref8" ref-type="bibr">8</xref></sup> When, on average, few reads map at each genomic position (a scenario referred to as ‘low-coverage’ or ‘low-depth’), genotypes and SNPs cannot be assigned with confidence due to the high data uncertainty.
<sup><xref rid="ref9" ref-type="bibr">9</xref></sup>
<sup>,</sup>
<sup><xref rid="ref10" ref-type="bibr">10</xref></sup> Under these circumstances, statistical methods that integrate data uncertainty into genotype likelihoods and propagate it to downstream analyses have been proposed.
<sup><xref rid="ref5" ref-type="bibr">5</xref></sup> Software packages like
<monospace>ANGSD</monospace>
<sup><xref rid="ref11" ref-type="bibr">11</xref></sup> and
<monospace>ngsTools,</monospace>
<sup><xref rid="ref12" ref-type="bibr">12</xref></sup> among others reviewed by Lou
<italic toggle="yes">et al.,</italic>
<sup><xref rid="ref13" ref-type="bibr">13</xref></sup> implement a statistical framework to estimate population genetic metrics from low-coverage sequencing data. Similarly, an affordable generation of sequencing data from large sample sizes can be obtained via pooled sequencing experiments, where assignment of individual samples is typically not retained.
<sup><xref rid="ref14" ref-type="bibr">14</xref></sup> Several new and popular software for the analysis of pooled sequencing have been proposed in recent years.
<sup><xref rid="ref15" ref-type="bibr">15</xref></sup>
<sup>,</sup>
<sup><xref rid="ref16" ref-type="bibr">16</xref></sup>
</p>
    <p>Despite these advances, most of these implementations are either tuned and suitable for model organisms only (e.g., with haploid or diploid genomes) or not easily adaptable to novel applications. Therefore, an accessible computational framework for building and testing
<italic toggle="yes">ad hoc</italic> population genetic analyses from NGS data is in dire need. Among programming languages,
<monospace>Julia</monospace>
<sup><xref rid="ref17" ref-type="bibr">17</xref></sup> has emerged as both a powerful and easy-to-use dynamically typed language that is widely used in many fields of data sciences, including genomics.
<sup><xref rid="ref18" ref-type="bibr">18</xref></sup> While several
<monospace>Julia</monospace> packages are currently available for both population genetic and bioinformatic analyses (e.g.,
<ext-link xlink:href="https://github.com/BioJulia" ext-link-type="uri">BioJulia</ext-link>), to our knowledge, a suitable framework for custom population genetic analysis from NGS data is not available yet.</p>
    <p>Here we present
<monospace>ngsJulia</monospace>, a set of templates and functions in
<monospace>Julia</monospace> language to process NGS data and create custom analyses in population genetics. To illustrate its applicability, we further introduce two implementations,
<monospace>ngsPool</monospace> and
<monospace>ngsPloidy</monospace>, for the analysis of pooled sequencing data and polyploid genomes, respectively. By extensive simulations, we show the performance of several methods implemented in these programs under various experimental conditions. We also introduce novel statistical methods to estimate population genetic parameters from NGS data and demonstrate their applicability and suggest optimal experimental design. We finally discuss further directions and purposes for
<monospace>ngsJulia</monospace> and bioinformatics for NGS data analysis.</p>
  </sec>
  <sec sec-type="methods" id="sec2">
    <title>Methods</title>
    <sec id="sec3">
      <title>Implementation</title>
      <p><monospace>ngsJulia</monospace> was built in
<monospace>Julia</monospace> language (Julia Programming Language, RRID:SCR_021666) and requires the packages ‘GZip’, ‘Combinatorics’, and ‘ArgParse’. Auxiliary scripts to process output files were built in
<monospace>R</monospace> (
<monospace>R</monospace> Project for Statistical Computing, RRID:SCR_001905) version 3.6.3 and require the package ‘getopt’.
<monospace>ngsJulia</monospace> receives gzipped mpileup input files which can be generated using
<monospace>samtools</monospace>.
<sup><xref rid="ref19" ref-type="bibr">19</xref></sup> Output files are in text file format and can be easily parsed for producing summary plots and for further analyses. Scripts for some downstream analyses are provided in
<monospace>ngsJulia</monospace>.</p>
    </sec>
    <sec id="sec4">
      <title>Operation</title>
      <p><monospace>ngsJulia</monospace> is compatible with all major operating systems and is maintained at
<ext-link xlink:href="https://github.com/mfumagalli/ngsJulia" ext-link-type="uri">https://github.com/mfumagalli/ngsJulia</ext-link>. Documentation and tutorials are available via this GitHub repository and archived at Zenodo
<sup><xref rid="ref20" ref-type="bibr">20</xref></sup> at the time of writing. All analyses in the manuscript are performed in
<monospace>Julia</monospace> language and
<monospace>R</monospace>.</p>
      <p><monospace>ngsJulia</monospace> implements functions to read and parse gzipped mpileup files and to output gzipped text files on various calculations (e.g., genotype and allele frequency likelihoods) and estimations (e.g., allele frequencies), as requested by the user.
<monospace>ngsJulia</monospace> also allows for several data filtering options, including on global and per-sample depth, proportion or count of minor allele, and base quality. Finally, several options for SNP and biallelic and triallelic polymorphisms calling are available.</p>
    </sec>
    <sec id="sec5">
      <title>Nucleotide, genotype and allele frequency likelihoods</title>
      <p><monospace>ngsJulia</monospace> provides utilities to calculate nucleotide and genotype likelihoods, i.e., the probability of observed sequencing data given a specific nucleotide or genotype,
<sup><xref rid="ref21" ref-type="bibr">21</xref></sup> for an arbitrary ploidy level, as in Soraggi
<italic toggle="yes">et al.</italic>
<sup><xref rid="ref22" ref-type="bibr">22</xref></sup> We now describe how such quantities are calculated in
<monospace>ngsJulia</monospace>.</p>
      <p>Following the notation in Soraggi
<italic toggle="yes">et al.,</italic>
<sup><xref rid="ref22" ref-type="bibr">22</xref></sup> for one sample and one site, we let
<inline-formula><mml:math id="M1" display="inline" overflow="scroll"><mml:mi>O</mml:mi></mml:math></inline-formula> be the observed NGS data,
<inline-formula><mml:math id="M2" display="inline" overflow="scroll"><mml:mi>Y</mml:mi></mml:math></inline-formula> the ploidy, and
<inline-formula><mml:math id="M3" display="inline" overflow="scroll"><mml:mi>G</mml:mi></mml:math></inline-formula> the genotype. Therefore,
<inline-formula><mml:math id="M4" display="inline" overflow="scroll"><mml:mi>G</mml:mi></mml:math></inline-formula> has values in
<inline-formula><mml:math id="M5" display="inline" overflow="scroll"><mml:mfenced close="}" open="{" separators=",,,"><mml:mn>0</mml:mn><mml:mn>1</mml:mn><mml:mo>…</mml:mo><mml:mi>Y</mml:mi></mml:mfenced></mml:math></inline-formula>, i.e., the number of derived (or alternate) alleles.</p>
      <p>In the simplest form, genotype likelihoods can be calculated by considering individual base qualities as probabilities of observing an incorrect nucleotide.
<sup><xref rid="ref21" ref-type="bibr">21</xref></sup> We adopt the calculation of genotype likelihoods for an arbitrary ploidy level
<inline-formula><mml:math id="M6" display="inline" overflow="scroll"><mml:mi>P</mml:mi><mml:mfenced close=")" open="(" separators="|,"><mml:mi>O</mml:mi><mml:mi>G</mml:mi><mml:mi>Y</mml:mi></mml:mfenced></mml:math></inline-formula> as proposed in Soraggi
<italic toggle="yes">et al.</italic>
<sup><xref rid="ref22" ref-type="bibr">22</xref></sup> From the genotype likelihoods with
<inline-formula><mml:math id="M7" display="inline" overflow="scroll"><mml:mi>P</mml:mi><mml:mfenced close=")" open="(" separators="|,"><mml:mi>O</mml:mi><mml:mi>G</mml:mi><mml:mrow><mml:mi>Y</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfenced></mml:math></inline-formula>, the two most likely alleles are identified by sorting
<inline-formula><mml:math id="M8" display="inline" overflow="scroll"><mml:mi>P</mml:mi><mml:mfenced close=")" open="(" separators="|,"><mml:mi>O</mml:mi><mml:mi>G</mml:mi><mml:mrow><mml:mi>Y</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfenced></mml:math></inline-formula> values after pooling all sequencing reads together across all samples. This operation will restrict the range of possible genotypes to biallelic variation only. Note that this calculation is still valid for monomorphic sites, although the actual assignment of the minor allele is meaningless.</p>
      <p>We now describe how to estimate
<inline-formula><mml:math id="M9" display="inline" overflow="scroll"><mml:msub><mml:mi>F</mml:mi><mml:mrow><mml:mi>a</mml:mi><mml:mo>,</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>, the frequency of allele
<inline-formula><mml:math id="M10" display="inline" overflow="scroll"><mml:mi>a</mml:mi><mml:mo>∈</mml:mo><mml:mfenced close="}" open="{" separators=",,,"><mml:mi>A</mml:mi><mml:mi>C</mml:mi><mml:mi>G</mml:mi><mml:mi>T</mml:mi></mml:mfenced></mml:math></inline-formula> at site
<inline-formula><mml:math id="M11" display="inline" overflow="scroll"><mml:mi>n</mml:mi></mml:math></inline-formula>. Similarly to Kim
<italic toggle="yes">et al.</italic>,
<sup><xref rid="ref23" ref-type="bibr">23</xref></sup> the log-likelihood function for
<inline-formula><mml:math id="M12" display="inline" overflow="scroll"><mml:msub><mml:mi>F</mml:mi><mml:mrow><mml:mi>a</mml:mi><mml:mo>,</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> is given by:
<disp-formula id="e1"><mml:math id="M13" display="block" overflow="scroll"><mml:mo>log</mml:mo><mml:mfenced close=")" open="("><mml:mrow><mml:mi>P</mml:mi><mml:mfenced close=")" open="(" separators="|"><mml:msub><mml:mi>O</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:msub><mml:mi>F</mml:mi><mml:mrow><mml:mi>a</mml:mi><mml:mo>,</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:msub></mml:mfenced></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:munderover><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:msub><mml:mi>C</mml:mi><mml:mi>n</mml:mi></mml:msub></mml:munderover><mml:mi>P</mml:mi><mml:mfenced close=")" open="(" separators="|,"><mml:msub><mml:mi>O</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mrow><mml:msub><mml:mi>c</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>a</mml:mi></mml:mrow><mml:mrow><mml:mi>Y</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfenced><mml:msub><mml:mi>F</mml:mi><mml:mi>n</mml:mi></mml:msub></mml:math><label>(1)</label></disp-formula>where
<inline-formula><mml:math id="M14" display="inline" overflow="scroll"><mml:msub><mml:mi>c</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> is the
<inline-formula><mml:math id="M15" display="inline" overflow="scroll"><mml:mi>i</mml:mi><mml:mo>−</mml:mo><mml:mi mathvariant="italic">th</mml:mi></mml:math></inline-formula> read at site
<inline-formula><mml:math id="M16" display="inline" overflow="scroll"><mml:mi>n</mml:mi></mml:math></inline-formula>, and
<inline-formula><mml:math id="M17" display="inline" overflow="scroll"><mml:msub><mml:mi>C</mml:mi><mml:mi>n</mml:mi></mml:msub></mml:math></inline-formula> is the total depth across all samples.
<xref rid="e1" ref-type="disp-formula">Function 1</xref> is maximised to obtain a maximum likelihood estimate (MLE) of the sample allele frequency,
<inline-formula><mml:math id="M18" display="inline" overflow="scroll"><mml:msub><mml:mover accent="true"><mml:mi>F</mml:mi><mml:mo stretchy="true">^</mml:mo></mml:mover><mml:mi>n</mml:mi></mml:msub></mml:math></inline-formula>, either with a grid- or golden-section- search algorithm.</p>
    </sec>
    <sec id="sec6">
      <title>SNP calling</title>
      <p>To perform SNP calling, we implement a likelihood-ratio test (LRT) with one degree of freedom with null hypothesis
<inline-formula><mml:math id="M19" display="inline" overflow="scroll"><mml:msub><mml:mi>H</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>:</mml:mo><mml:msub><mml:mi>F</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:math></inline-formula> and alternate hypothesis
<inline-formula><mml:math id="M20" display="inline" overflow="scroll"><mml:msub><mml:mi>H</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>:</mml:mo><mml:msub><mml:mi>F</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>F</mml:mi><mml:mo stretchy="true">^</mml:mo></mml:mover><mml:mi>n</mml:mi></mml:msub></mml:math></inline-formula>, as described by Kim
<italic toggle="yes">et al.</italic>
<sup><xref rid="ref23" ref-type="bibr">23</xref></sup> Additionally, we develop a test for a site being biallelic or triallelic. The former can be interpreted as a further evidence of polymorphism, while the latter as a condition not to be met for the site being included in further estimations, as our models assume at most two alleles. The log-likelihood of site
<inline-formula><mml:math id="M21" display="inline" overflow="scroll"><mml:mi>n</mml:mi></mml:math></inline-formula> being biallelic is equal to
<inline-formula><mml:math id="M22" display="inline" overflow="scroll"><mml:mi>P</mml:mi><mml:mfenced close=")" open="(" separators="|,"><mml:msub><mml:mi>O</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mrow><mml:msub><mml:mi>G</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mfenced close="}" open="{" separators=","><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mfenced></mml:mrow><mml:mrow><mml:mi>Y</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfenced></mml:math></inline-formula> while the log-likelihood being triallelic is equal to
<inline-formula><mml:math id="M23" display="inline" overflow="scroll"><mml:mi>P</mml:mi><mml:mfenced close=")" open="(" separators="|,"><mml:msub><mml:mi>O</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mrow><mml:msub><mml:mi>G</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mfenced close="}" open="{" separators=",,"><mml:mi>i</mml:mi><mml:mi>j</mml:mi><mml:mi>z</mml:mi></mml:mfenced></mml:mrow><mml:mrow><mml:mi>Y</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfenced></mml:math></inline-formula>, with
<inline-formula><mml:math id="M24" display="inline" overflow="scroll"><mml:mi>i</mml:mi></mml:math></inline-formula>,
<inline-formula><mml:math id="M25" display="inline" overflow="scroll"><mml:mi>j</mml:mi></mml:math></inline-formula>, and
<inline-formula><mml:math id="M26" display="inline" overflow="scroll"><mml:mi>z</mml:mi></mml:math></inline-formula> being the most, second most, and third most likely allele with
<inline-formula><mml:math id="M27" display="inline" overflow="scroll"><mml:mi>Y</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:math></inline-formula> (i.e. haploid genotype
<inline-formula><mml:math id="M28" display="inline" overflow="scroll"><mml:mi>G</mml:mi></mml:math></inline-formula>), respectively. An LRT with one degree of freedom can be conducted to assess whether
<inline-formula><mml:math id="M29" display="inline" overflow="scroll"><mml:mi>P</mml:mi><mml:mfenced close=")" open="(" separators="|,"><mml:msub><mml:mi>O</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mrow><mml:msub><mml:mi>G</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>Y</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfenced></mml:math></inline-formula> is significantly greater than
<inline-formula><mml:math id="M30" display="inline" overflow="scroll"><mml:mi>P</mml:mi><mml:mfenced close=")" open="(" separators="|,"><mml:msub><mml:mi>O</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mrow><mml:msub><mml:mi>G</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mfenced close="}" open="{" separators=","><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mfenced></mml:mrow><mml:mrow><mml:mi>Y</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfenced></mml:math></inline-formula>, or the latter is significantly greater than
<inline-formula><mml:math id="M31" display="inline" overflow="scroll"><mml:mi>P</mml:mi><mml:mfenced close=")" open="(" separators="|,"><mml:msub><mml:mi>O</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mrow><mml:msub><mml:mi>G</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mfenced close="}" open="{" separators=",,"><mml:mi>i</mml:mi><mml:mi>j</mml:mi><mml:mi>z</mml:mi></mml:mfenced></mml:mrow><mml:mrow><mml:mi>Y</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfenced></mml:math></inline-formula>.</p>
    </sec>
    <sec id="sec7">
      <title>Allele frequency, site frequency spectrum and association test from pooled sequencing data</title>
      <p>Several estimators of population parameters from pooled sequencing data are implemented in
<monospace>ngsPool</monospace>, a separate program which uses functions in
<monospace>ngsJulia</monospace>. We now describe the statistical framework for the analysis of pooled sequencing data.</p>
      <p>In case of data with unknown sample size, the MLE of the population allele frequency
<inline-formula><mml:math id="M32" display="inline" overflow="scroll"><mml:msub><mml:mi>F</mml:mi><mml:mi>n</mml:mi></mml:msub></mml:math></inline-formula> is calculated as in
<xref rid="e1" ref-type="disp-formula">Equation 1</xref> with
<inline-formula><mml:math id="M33" display="inline" overflow="scroll"><mml:mi>F</mml:mi><mml:mo>∈</mml:mo><mml:mfenced close=")" open="(" separators=","><mml:mn>0</mml:mn><mml:mn>1</mml:mn></mml:mfenced></mml:math></inline-formula>. With known sample size, the same equation is used to calculate sample allele frequency likelihoods
<inline-formula><mml:math id="M34" display="inline" overflow="scroll"><mml:mi>P</mml:mi><mml:mfenced close=")" open="(" separators="|"><mml:msub><mml:mi>O</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mrow><mml:msub><mml:mi>F</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mi>f</mml:mi></mml:mrow></mml:mfenced></mml:math></inline-formula>
<sub>,</sub>
<sup><xref rid="ref24" ref-type="bibr">24</xref></sup> for instance with
<inline-formula><mml:math id="M35" display="inline" overflow="scroll"><mml:mi>f</mml:mi><mml:mo>∈</mml:mo><mml:mfenced close="}" open="{" separators=",,,"><mml:mn>0</mml:mn><mml:mn>1</mml:mn><mml:mo>…</mml:mo><mml:mrow><mml:mi>M</mml:mi><mml:mo>×</mml:mo><mml:mi>Y</mml:mi></mml:mrow></mml:mfenced></mml:math></inline-formula> for
<inline-formula><mml:math id="M36" display="inline" overflow="scroll"><mml:mi>M</mml:mi></mml:math></inline-formula> samples of equal ploidy
<inline-formula><mml:math id="M37" display="inline" overflow="scroll"><mml:mi>Y</mml:mi></mml:math></inline-formula>. From these likelihoods, we can calculate both the MLE and the expected value with uniform prior probability as estimators of
<inline-formula><mml:math id="M38" display="inline" overflow="scroll"><mml:msub><mml:mi>F</mml:mi><mml:mi>n</mml:mi></mml:msub></mml:math></inline-formula>.</p>
      <p>A simple estimator of the site frequency spectrum (SFS) from pooled sequencing data is obtained by counting point-estimates of
<inline-formula><mml:math id="M39" display="inline" overflow="scroll"><mml:msub><mml:mi>F</mml:mi><mml:mi>n</mml:mi></mml:msub></mml:math></inline-formula> across all sites. We propose a novel estimator of the SFS implemented in
<monospace>ngsPool</monospace>. Under the standard coalescent model with infinite sites mutations, we let the probability of derived allele frequency
<inline-formula><mml:math id="M40" display="inline" overflow="scroll"><mml:mi>F</mml:mi></mml:math></inline-formula> in a sample of
<inline-formula><mml:math id="M41" display="inline" overflow="scroll"><mml:mi>N</mml:mi></mml:math></inline-formula> genomes
<inline-formula><mml:math id="M42" display="inline" overflow="scroll"><mml:mi>P</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:mi>F</mml:mi><mml:mo>=</mml:mo><mml:mi>f</mml:mi></mml:mrow></mml:mfenced></mml:math></inline-formula> to be proportional to
<inline-formula><mml:math id="M43" display="inline" overflow="scroll"><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:msup><mml:mi>f</mml:mi><mml:mi>K</mml:mi></mml:msup></mml:math></inline-formula> with
<inline-formula><mml:math id="M44" display="inline" overflow="scroll"><mml:mi>f</mml:mi><mml:mo>∈</mml:mo><mml:mfenced close="}" open="{" separators=",,"><mml:mn>1</mml:mn><mml:mo>…</mml:mo><mml:mrow><mml:mi>N</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfenced></mml:math></inline-formula>
<sub>.</sub>
<sup><xref rid="ref25" ref-type="bibr">25</xref></sup> The parameter
<inline-formula><mml:math id="M45" display="inline" overflow="scroll"><mml:mi>K</mml:mi></mml:math></inline-formula> determines whether the population is deviating from a model of constant effective population size. For instance,
<inline-formula><mml:math id="M46" display="inline" overflow="scroll"><mml:mi>K</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:math></inline-formula> is equal to the expected distribution of
<inline-formula><mml:math id="M47" display="inline" overflow="scroll"><mml:mi>P</mml:mi><mml:mfenced close=")" open="("><mml:mi>F</mml:mi></mml:mfenced></mml:math></inline-formula> under constant population size, while
<inline-formula><mml:math id="M48" display="inline" overflow="scroll"><mml:mi>K</mml:mi><mml:mo>&gt;</mml:mo><mml:mn>1</mml:mn></mml:math></inline-formula> models a population shrinking and
<inline-formula><mml:math id="M49" display="inline" overflow="scroll"><mml:mi>K</mml:mi><mml:mo>&lt;</mml:mo><mml:mn>1</mml:mn></mml:math></inline-formula> population growth.</p>
      <p>We optimise the value of
<inline-formula><mml:math id="M50" display="inline" overflow="scroll"><mml:mi>K</mml:mi></mml:math></inline-formula> to minimise the Kullback-Liebrel divergence between the expected distribution of
<inline-formula><mml:math id="M51" display="inline" overflow="scroll"><mml:mi>P</mml:mi><mml:mfenced close=")" open="(" separators="|"><mml:mi>F</mml:mi><mml:mi>K</mml:mi></mml:mfenced></mml:math></inline-formula> and the observed SFS. The latter can be obtained by either counting
<inline-formula><mml:math id="M52" display="inline" overflow="scroll"><mml:msub><mml:mover accent="true"><mml:mi>F</mml:mi><mml:mo stretchy="true">^</mml:mo></mml:mover><mml:mi>n</mml:mi></mml:msub></mml:math></inline-formula> across all sites or by integrating over the sample allele frequency probabilities
<inline-formula><mml:math id="M53" display="inline" overflow="scroll"><mml:mi>P</mml:mi><mml:mfenced close=")" open="(" separators="|"><mml:mrow><mml:msub><mml:mi>F</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mi>f</mml:mi></mml:mrow><mml:msub><mml:mi>O</mml:mi><mml:mi>n</mml:mi></mml:msub></mml:mfenced><mml:mo>∝</mml:mo><mml:mi>P</mml:mi><mml:mfenced close=")" open="(" separators="|"><mml:msub><mml:mi>O</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mrow><mml:msub><mml:mi>F</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mi>f</mml:mi></mml:mrow></mml:mfenced></mml:math></inline-formula> (
<italic toggle="yes">i.e.</italic> with a uniform prior distribution). A threshold can be set to ignore allele frequencies with low probability to improve computing efficiency and reduce noise. Within this framework, folding spectra can be generated in case of unknown allelic polarisation.</p>
      <p>Finally, we introduce a strategy to perform association tests from pooled sequencing data. Similarly to Kim
<italic toggle="yes">et al.,</italic>
<sup><xref rid="ref23" ref-type="bibr">23</xref></sup> we propose an LRT with one degree of freedom for null hypothesis
<inline-formula><mml:math id="M54" display="inline" overflow="scroll"><mml:msub><mml:mi>H</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>:</mml:mo><mml:msub><mml:mi>f</mml:mi><mml:mtext mathvariant="italic">cases</mml:mtext></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>f</mml:mi><mml:mtext mathvariant="italic">controls</mml:mtext></mml:msub></mml:math></inline-formula> and alternate hypothesis
<inline-formula><mml:math id="M55" display="inline" overflow="scroll"><mml:msub><mml:mi>H</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>:</mml:mo><mml:msub><mml:mi>f</mml:mi><mml:mtext mathvariant="italic">cases</mml:mtext></mml:msub><mml:mo>≠</mml:mo><mml:msub><mml:mi>f</mml:mi><mml:mtext mathvariant="italic">controls</mml:mtext></mml:msub></mml:math></inline-formula>. The likelihood of each hypothesis is calculated from
<inline-formula><mml:math id="M56" display="inline" overflow="scroll"><mml:mi>P</mml:mi><mml:mfenced close=")" open="(" separators="|"><mml:msub><mml:mi>O</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mrow><mml:msub><mml:mi>F</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mi>f</mml:mi></mml:mrow></mml:mfenced></mml:math></inline-formula> and, therefore, this strategy avoids the assignment of counts or per-site allele frequencies. A statistically significant LRT with one degree of freedom suggests a difference in allele frequencies between cases and controls, and possible association between the tested phenotype and alleles.</p>
    </sec>
    <sec id="sec8">
      <title>Ploidy levels and test for multiploidy</title>
      <p>We now describe the statistical framework implemented in the program
<monospace>ngsPloidy</monospace> to estimate ploidy levels and test for multiploidy. When multiple samples are available, two scenarios can be envisaged: (i) all samples have the same ploidy, (ii) each sample can have a different ploidy (multiploidy, i.e. as in tumor genomes).
<sup><xref rid="ref26" ref-type="bibr">26</xref></sup>
</p>
      <p>The log-likelihood function for a vector of ploidy levels
<inline-formula><mml:math id="M57" display="inline" overflow="scroll"><mml:msub><mml:mover accent="true"><mml:mi>Y</mml:mi><mml:mo stretchy="true">→</mml:mo></mml:mover><mml:mi>M</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mfenced close="}" open="{" separators=",,,"><mml:mrow><mml:msub><mml:mi>Y</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mi>Y</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow><mml:mo>…</mml:mo><mml:mrow><mml:msub><mml:mi>Y</mml:mi><mml:mi>M</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mi>M</mml:mi></mml:msub></mml:mrow></mml:mfenced></mml:math></inline-formula> for
<inline-formula><mml:math id="M58" display="inline" overflow="scroll"><mml:mi>M</mml:mi></mml:math></inline-formula> samples and
<inline-formula><mml:math id="M59" display="inline" overflow="scroll"><mml:mi>N</mml:mi></mml:math></inline-formula> sites is defined as:
<disp-formula id="e2"><mml:math id="M60" display="block" overflow="scroll"><mml:mo>log</mml:mo><mml:mo stretchy="true">(</mml:mo><mml:mi>P</mml:mi><mml:mfenced close=")" open="(" separators="|"><mml:mi>O</mml:mi><mml:mrow><mml:mi>Y</mml:mi><mml:mo>=</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>Y</mml:mi><mml:mo stretchy="true">→</mml:mo></mml:mover><mml:mi>M</mml:mi></mml:msub></mml:mrow></mml:mfenced><mml:mo stretchy="true">)</mml:mo><mml:mo>=</mml:mo><mml:munderover><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mi>m</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>M</mml:mi></mml:munderover><mml:munderover><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>N</mml:mi></mml:munderover><mml:mo>log</mml:mo><mml:mfenced close=")" open="("><mml:mrow><mml:munder><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>∈</mml:mo><mml:mfenced close="}" open="{" separators=",,,"><mml:mn>0</mml:mn><mml:mn>1</mml:mn><mml:mo>…</mml:mo><mml:msub><mml:mi>Y</mml:mi><mml:mi>m</mml:mi></mml:msub></mml:mfenced></mml:mrow></mml:munder><mml:mi>P</mml:mi><mml:mfenced close=")" open="(" separators="|,"><mml:msub><mml:mi>O</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mrow><mml:msub><mml:mi>G</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mi>Y</mml:mi><mml:mi>m</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mi>m</mml:mi></mml:msub></mml:mrow></mml:mfenced><mml:mi>P</mml:mi><mml:mfenced close=")" open="(" separators="|,"><mml:mrow><mml:msub><mml:mi>G</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mi>Y</mml:mi><mml:mi>m</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mi>m</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mi>F</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>F</mml:mi><mml:mo stretchy="true">^</mml:mo></mml:mover><mml:mi>n</mml:mi></mml:msub></mml:mrow></mml:mfenced></mml:mrow></mml:mfenced></mml:math><label>(2)</label></disp-formula>
</p>
      <p>With
<inline-formula><mml:math id="M61" display="inline" overflow="scroll"><mml:msub><mml:mover accent="true"><mml:mi>F</mml:mi><mml:mo stretchy="true">^</mml:mo></mml:mover><mml:mi>n</mml:mi></mml:msub></mml:math></inline-formula> being the MLE of allele frequency at site
<inline-formula><mml:math id="M62" display="inline" overflow="scroll"><mml:mi>n</mml:mi></mml:math></inline-formula>.
<inline-formula><mml:math id="M63" display="inline" overflow="scroll"><mml:mi>P</mml:mi><mml:mfenced close=")" open="(" separators="|,"><mml:msub><mml:mi>O</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mrow><mml:msub><mml:mi>G</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mi>Y</mml:mi><mml:mi>m</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mi>m</mml:mi></mml:msub></mml:mrow></mml:mfenced></mml:math></inline-formula> is the genotype likelihood while
<inline-formula><mml:math id="M64" display="inline" overflow="scroll"><mml:mi>P</mml:mi><mml:mfenced close=")" open="(" separators="|,"><mml:mrow><mml:msub><mml:mi>G</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mi>Y</mml:mi><mml:mi>m</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mi>m</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mi>F</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>F</mml:mi><mml:mo stretchy="true">^</mml:mo></mml:mover><mml:mi>n</mml:mi></mml:msub></mml:mrow></mml:mfenced></mml:math></inline-formula> is the genotype probability given the ploidy and allele frequency at site
<inline-formula><mml:math id="M65" display="inline" overflow="scroll"><mml:mi>n</mml:mi></mml:math></inline-formula>.</p>
      <p>Once
<inline-formula><mml:math id="M66" display="inline" overflow="scroll"><mml:msub><mml:mover accent="true"><mml:mi>F</mml:mi><mml:mo stretchy="true">^</mml:mo></mml:mover><mml:mi>n</mml:mi></mml:msub></mml:math></inline-formula> is estimated and the inbreeding is known (or under the assumption of Hardy-Weinberg Equilibrium (HWE)), then genotype probabilities are fully defined.
<xref rid="e2" ref-type="disp-formula">Equation 2</xref> is optimised by maximising the marginal likelihood of each sample separately, assuming independence among samples and sites.</p>
      <p>With limited sample size,
<inline-formula><mml:math id="M67" display="inline" overflow="scroll"><mml:msub><mml:mover accent="true"><mml:mi>F</mml:mi><mml:mo stretchy="true">^</mml:mo></mml:mover><mml:mi>n</mml:mi></mml:msub></mml:math></inline-formula> is not a good estimator of the population allele frequency and therefore genotype probabilities may not be well defined. In the simplest scenario, genotype probabilities can be set as uniformly distributed, with all genotypes being equally probable. However, the assignment of alleles into ancestral (e.g., wild-type) and derived (e.g., mutant) states is particularly useful to inform on genotype probabilities. Recalling
<xref rid="e2" ref-type="disp-formula">Equation 2</xref>, we can substitute
<inline-formula><mml:math id="M68" display="inline" overflow="scroll"><mml:mi>P</mml:mi><mml:mfenced close=")" open="(" separators="|,"><mml:mrow><mml:msub><mml:mi>G</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mi>Y</mml:mi><mml:mi>m</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mi>m</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mi>F</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>F</mml:mi><mml:mo stretchy="true">^</mml:mo></mml:mover><mml:mi>n</mml:mi></mml:msub></mml:mrow></mml:mfenced></mml:math></inline-formula> with
<inline-formula><mml:math id="M69" display="inline" overflow="scroll"><mml:mi>P</mml:mi><mml:mfenced close=")" open="(" separators="|,"><mml:mrow><mml:msub><mml:mi>G</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mi>Y</mml:mi><mml:mi>m</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mi>m</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mi>F</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mi mathvariant="bold">E</mml:mi><mml:mfenced close="]" open="[" separators="|"><mml:mi>F</mml:mi><mml:mi>K</mml:mi></mml:mfenced></mml:mrow></mml:mfenced><mml:mo stretchy="true">)</mml:mo></mml:math></inline-formula>, where
<inline-formula><mml:math id="M70" display="inline" overflow="scroll"><mml:mi mathvariant="bold">E</mml:mi><mml:mfenced close="]" open="[" separators="|"><mml:mi>F</mml:mi><mml:mi>K</mml:mi></mml:mfenced></mml:math></inline-formula> is the expected allele frequency of
<inline-formula><mml:math id="M71" display="inline" overflow="scroll"><mml:mi>P</mml:mi><mml:mfenced close=")" open="(" separators="|"><mml:mrow><mml:mi>F</mml:mi><mml:mo>=</mml:mo><mml:mi>f</mml:mi></mml:mrow><mml:mi>K</mml:mi></mml:mfenced><mml:mo>∝</mml:mo><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:msup><mml:mi>f</mml:mi><mml:mi>K</mml:mi></mml:msup></mml:math></inline-formula>, as introduced previously. Note that
<inline-formula><mml:math id="M72" display="inline" overflow="scroll"><mml:mi mathvariant="bold">E</mml:mi><mml:mfenced close="]" open="[" separators="|"><mml:mi>F</mml:mi><mml:mi>K</mml:mi></mml:mfenced></mml:math></inline-formula> does not depend on the sequencing data for each specific site
<inline-formula><mml:math id="M73" display="inline" overflow="scroll"><mml:mi>n</mml:mi></mml:math></inline-formula>.</p>
      <p>Note that, in practice,
<xref rid="e2" ref-type="disp-formula">Equation 2</xref> is a composite likelihood function, as samples and sites are not independent observations due to shared population history and linkage disequilibrium, respectively. A solution to circumvent this issue is to perform a bootstrapping procedure, by sampling with replacement segments of the chromosome and estimate ploidy for each bootstrapped chromosome. The distribution of inferred ploidy levels from bootstrapped chromosomes provides a quantitative measurement of confidence in determining the chromosomal ploidy. It is not possible to calculate the likelihood of ploidy equal to one after SNP calling. Nevertheless, the identification of haploid genomes from sequencing data is typically trivial.</p>
    </sec>
    <sec id="sec9">
      <title>Unknown or uncertain ancestral allelic state</title>
      <p>So far, we assumed to know which allele can be assigned to an ancestral state, and which one to a derived state. However, in some cases, such assignment is either not possible or associated with a certain level of uncertainty due to, for instance, ancestral polymorphisms or outgroup sequence genome from a closely related species not being available. Under these circumstances, we extend our formulation by adding a parameter underlying the probability that the assigned ancestral state is incorrectly identified.</p>
      <p>Let us define
<inline-formula><mml:math id="M74" display="inline" overflow="scroll"><mml:mi>R</mml:mi></mml:math></inline-formula> as the ancestral state and
<inline-formula><mml:math id="M75" display="inline" overflow="scroll"><mml:mi>a</mml:mi></mml:math></inline-formula> as any possible allele in
<inline-formula><mml:math id="M76" display="inline" overflow="scroll"><mml:mfenced close="}" open="{" separators=",,,"><mml:mi>A</mml:mi><mml:mi>C</mml:mi><mml:mi>G</mml:mi><mml:mi>T</mml:mi></mml:mfenced></mml:math></inline-formula>. In practice,
<inline-formula><mml:math id="M77" display="inline" overflow="scroll"><mml:mi>a</mml:mi></mml:math></inline-formula> can take only two possible values as we select only the two most likely alleles. We label this set of the two most common alleles as
<inline-formula><mml:math id="M78" display="inline" overflow="scroll"><mml:mi>A</mml:mi></mml:math></inline-formula> and we assume that the true ancestral state is included in such set. The log-likelihood function of ploidy for a single sample
<inline-formula><mml:math id="M79" display="inline" overflow="scroll"><mml:mi>m</mml:mi></mml:math></inline-formula> under unknown ancestral state is:
<disp-formula id="e3"><mml:math id="M80" display="block" overflow="scroll"><mml:mo>log</mml:mo><mml:mo stretchy="true">(</mml:mo><mml:mi>P</mml:mi><mml:mfenced close=")" open="(" separators="|"><mml:mi>O</mml:mi><mml:mrow><mml:msub><mml:mi>Y</mml:mi><mml:mi>M</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mi>m</mml:mi></mml:msub></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:munderover><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>N</mml:mi></mml:munderover><mml:mo>log</mml:mo><mml:mfenced close=")" open="("><mml:mrow><mml:munder><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mi>a</mml:mi><mml:mo>∈</mml:mo><mml:mi>A</mml:mi></mml:mrow></mml:munder><mml:munder><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>∈</mml:mo><mml:mfenced close="}" open="{" separators=",,,"><mml:mn>0</mml:mn><mml:mn>1</mml:mn><mml:mo>…</mml:mo><mml:msub><mml:mi>Y</mml:mi><mml:mi>m</mml:mi></mml:msub></mml:mfenced></mml:mrow></mml:munder><mml:mi>P</mml:mi><mml:mfenced close=")" open="(" separators="|,"><mml:msub><mml:mi>O</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mrow><mml:msub><mml:mi>G</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mi>Y</mml:mi><mml:mi>m</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mi>m</mml:mi></mml:msub></mml:mrow></mml:mfenced><mml:mi>P</mml:mi><mml:mfenced close=")" open="(" separators="|,,"><mml:mrow><mml:msub><mml:mi>G</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mi>Y</mml:mi><mml:mi>m</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mi>m</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:mi>R</mml:mi><mml:mo>=</mml:mo><mml:mi>a</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mi>F</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>F</mml:mi><mml:mo stretchy="true">^</mml:mo></mml:mover><mml:mi>n</mml:mi></mml:msub></mml:mrow></mml:mfenced><mml:mi>P</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:mi>R</mml:mi><mml:mo>=</mml:mo><mml:mi>a</mml:mi></mml:mrow></mml:mfenced></mml:mrow></mml:mfenced></mml:math><label>(3)</label></disp-formula>
</p>
      <p>Where
<inline-formula><mml:math id="M81" display="inline" overflow="scroll"><mml:mi>P</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:mi>R</mml:mi><mml:mo>=</mml:mo><mml:mi>a</mml:mi></mml:mrow></mml:mfenced></mml:math></inline-formula> indicates the probability that allele
<inline-formula><mml:math id="M82" display="inline" overflow="scroll"><mml:mi>a</mml:mi></mml:math></inline-formula> is the ancestral state, and it is invariant across sites. If
<inline-formula><mml:math id="M83" display="inline" overflow="scroll"><mml:mi>P</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:mi>R</mml:mi><mml:mo>=</mml:mo><mml:mi>a</mml:mi></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:mn>0.5</mml:mn></mml:math></inline-formula>, then the equation refers to the scenario of folded allele frequencies, where each allele is equally probable to be the ancestral state.</p>
      <p>Finally, note that in a sufficiently large sample size, the major allele is more probable to represent the ancestral state. This probability depends on the shape of the site frequency spectrum, and it is equal to the cumulative distribution of
<inline-formula><mml:math id="M84" display="inline" overflow="scroll"><mml:mi>P</mml:mi><mml:mfenced close=")" open="(" separators="|"><mml:mi>F</mml:mi><mml:mi>K</mml:mi></mml:mfenced></mml:math></inline-formula> evaluated at
<inline-formula><mml:math id="M85" display="inline" overflow="scroll"><mml:mi>F</mml:mi><mml:mo>=</mml:mo><mml:mi>N</mml:mi><mml:mo>/</mml:mo><mml:mn>2</mml:mn></mml:math></inline-formula>. We can extend
<xref rid="e3" ref-type="disp-formula">Equation 3</xref> to reflect this parameter uncertainty with
<inline-formula><mml:math id="M86" display="inline" overflow="scroll"><mml:mi>a</mml:mi></mml:math></inline-formula> being the major allele in
<inline-formula><mml:math id="M87" display="inline" overflow="scroll"><mml:mi>P</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:mi>R</mml:mi><mml:mo>=</mml:mo><mml:mi>a</mml:mi></mml:mrow></mml:mfenced></mml:math></inline-formula>.</p>
    </sec>
    <sec id="sec10">
      <title>Test for multiploidy</title>
      <p>We introduce a novel test for multiploidy. If all samples have the same ploidy
<inline-formula><mml:math id="M88" display="inline" overflow="scroll"><mml:mi>y</mml:mi><mml:mo>∈</mml:mo><mml:mi>Y</mml:mi></mml:math></inline-formula>, then
<inline-formula><mml:math id="M89" display="inline" overflow="scroll"><mml:msub><mml:mi>Y</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>Y</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mi>y</mml:mi></mml:math></inline-formula> is true for all
<inline-formula><mml:math id="M90" display="inline" overflow="scroll"><mml:mfenced close=")" open="(" separators=","><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mfenced><mml:mo>∈</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mi mathvariant="normal">M</mml:mi></mml:math></inline-formula>. We propose an LRT for multiploidy with null hypothesis
<inline-formula><mml:math id="M91" display="inline" overflow="scroll"><mml:msub><mml:mi>H</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>:</mml:mo><mml:mo>sup</mml:mo><mml:mover accent="true"><mml:mi>Y</mml:mi><mml:mo stretchy="true">→</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:mfenced close="}" open="{" separators=",,,"><mml:mrow><mml:msub><mml:mi>y</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mi>y</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mi>y</mml:mi></mml:mrow><mml:mo>…</mml:mo><mml:mrow><mml:msub><mml:mi>y</mml:mi><mml:mi>M</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mi>y</mml:mi></mml:mrow></mml:mfenced></mml:math></inline-formula> and alternate hypothesis
<inline-formula><mml:math id="M92" display="inline" overflow="scroll"><mml:msub><mml:mi>H</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>:</mml:mo><mml:mover accent="true"><mml:mi>Y</mml:mi><mml:mo stretchy="true">→</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>Y</mml:mi><mml:mo stretchy="true">→</mml:mo></mml:mover><mml:mi mathvariant="italic">MLE</mml:mi></mml:msub></mml:math></inline-formula> A large value of LRT is suggestive of multiploidy. Statistical significance can be assessed with the LRT and
<inline-formula><mml:math id="M93" display="inline" overflow="scroll"><mml:mfenced close=")" open="("><mml:mrow><mml:mi>M</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfenced></mml:math></inline-formula> degrees of freedom.</p>
    </sec>
    <sec id="sec11">
      <title>Data simulation</title>
      <p>To benchmark the performance of methods implemented in
<monospace>ngsJulia</monospace>, we simulated NGS data following a strategy previously proposed by Fumagalli
<italic toggle="yes">et al</italic>.
<sup><xref rid="ref27" ref-type="bibr">27</xref></sup> available as a stand-alone R script. Briefly, individual genotypes are drawn according to probabilities depending on input parameters. The number of mapped reads at each position is modelled with a Poisson distribution and sequenced bases are sampled with replacement with a probability given by the quality score. As an illustration, the following code
<preformat preformat-type="computer code" position="float" xml:space="preserve">Rscript simulMpileup. R --out test.txt --copy 2x10 --sites 1000 \\--depth 20 --qual 20 ---pool|gzip &gt; test.mpileup.gz</preformat>
</p>
      <p>will simulate 10 diploid genomes
<monospace>(--copy 2x10</monospace>),
<inline-formula><mml:math id="M94" display="inline" overflow="scroll"><mml:mn>1000</mml:mn></mml:math></inline-formula> base pairs each (
<monospace>--sites 1000</monospace>) with an average sequencing depth of
<inline-formula><mml:math id="M95" display="inline" overflow="scroll"><mml:mn>20</mml:mn></mml:math></inline-formula> and base quality of
<inline-formula><mml:math id="M96" display="inline" overflow="scroll"><mml:mn>20</mml:mn></mml:math></inline-formula> in
<italic toggle="yes">Phred</italic> score (
<monospace>--depth 20 --qual 20</monospace>) from pooled sequencing (
<monospace>--pool</monospace>) with results stored in
<monospace>test.mpileup.gz file</monospace>.</p>
      <p>For the analysis of pooled sequencing data, we simulated
<inline-formula><mml:math id="M97" display="inline" overflow="scroll"><mml:mn>100,000</mml:mn></mml:math></inline-formula> independent sites at sample sizes
<inline-formula><mml:math id="M98" display="inline" overflow="scroll"><mml:mn>20</mml:mn></mml:math></inline-formula>,
<inline-formula><mml:math id="M99" display="inline" overflow="scroll"><mml:mn>50</mml:mn></mml:math></inline-formula>, and
<inline-formula><mml:math id="M100" display="inline" overflow="scroll"><mml:mn>100</mml:mn></mml:math></inline-formula> from a diploid population with a constant effective population size of
<inline-formula><mml:math id="M101" display="inline" overflow="scroll"><mml:mn>10,000</mml:mn></mml:math></inline-formula>. We imposed the average per-sample sequencing depth to be
<inline-formula><mml:math id="M102" display="inline" overflow="scroll"><mml:mn>0.5</mml:mn></mml:math></inline-formula>,
<inline-formula><mml:math id="M103" display="inline" overflow="scroll"><mml:mn>1</mml:mn></mml:math></inline-formula>,
<inline-formula><mml:math id="M104" display="inline" overflow="scroll"><mml:mn>2</mml:mn></mml:math></inline-formula>, or
<inline-formula><mml:math id="M105" display="inline" overflow="scroll"><mml:mn>5</mml:mn></mml:math></inline-formula> with an average base quality of
<inline-formula><mml:math id="M106" display="inline" overflow="scroll"><mml:mn>20</mml:mn></mml:math></inline-formula> in
<italic toggle="yes">Phred</italic> score. To assess the performance of
<monospace>ngsPool</monospace>, we calculated bias and root mean squared error (RMSE) between the estimated value of the true value, either from the sample or the whole population. While both metrics measure the distance with the true value, the bias retains the direction of the error (i.e. over- or under-estimation). To quantify the accuracy of SNP calling, we calculated F1 scores (the harmonic mean of precision and recall rates).</p>
      <p>To simulate data for association test, we assumed an equal number of cases and controls (equal to
<inline-formula><mml:math id="M107" display="inline" overflow="scroll"><mml:mn>150</mml:mn></mml:math></inline-formula>) and 200 SNPs, either causal or non causal. For non causal sites, cases and controls have the same population allele frequency of
<inline-formula><mml:math id="M108" display="inline" overflow="scroll"><mml:mn>0.10</mml:mn></mml:math></inline-formula>. For causal sites, cases and controls have a population allele frequency of
<inline-formula><mml:math id="M109" display="inline" overflow="scroll"><mml:mn>0.09</mml:mn></mml:math></inline-formula> and
<inline-formula><mml:math id="M110" display="inline" overflow="scroll"><mml:mn>0.04</mml:mn></mml:math></inline-formula>, respectively. These conditions are derived assuming a high risk allele frequency of
<inline-formula><mml:math id="M111" display="inline" overflow="scroll"><mml:mn>0.1</mml:mn></mml:math></inline-formula>, prevalence of
<inline-formula><mml:math id="M112" display="inline" overflow="scroll"><mml:mn>0.2</mml:mn></mml:math></inline-formula>, genotypic relative risk for the heterozygote of
<inline-formula><mml:math id="M113" display="inline" overflow="scroll"><mml:mn>2</mml:mn></mml:math></inline-formula>, genotypic relative risk for the homozygous state of
<inline-formula><mml:math id="M114" display="inline" overflow="scroll"><mml:mn>4</mml:mn></mml:math></inline-formula>. The sample size simulated guarantees at least
<inline-formula><mml:math id="M115" display="inline" overflow="scroll"><mml:mn>80</mml:mn><mml:mo>%</mml:mo></mml:math></inline-formula> power with a false positive rate of
<inline-formula><mml:math id="M116" display="inline" overflow="scroll"><mml:mn>0.10</mml:mn></mml:math></inline-formula>.</p>
      <p>To illustrate the usage of
<monospace>ngsPloidy</monospace>, we simulated NGS data of genomes with different ploidy levels (one haploid, eight triploids, one tetraploid) at
<inline-formula><mml:math id="M117" display="inline" overflow="scroll"><mml:mn>1000</mml:mn></mml:math></inline-formula> sites. NGS data was simulated assuming an average depth of
<inline-formula><mml:math id="M118" display="inline" overflow="scroll"><mml:mn>10</mml:mn></mml:math></inline-formula> at the haploid level. Code and simulated data sets analysed are available in
<monospace><ext-link xlink:href="https://github.com/mfumagalli/ngsJulia" ext-link-type="uri">ngsJulia</ext-link></monospace> GitHub repository.</p>
    </sec>
  </sec>
  <sec sec-type="results" id="sec912">
    <title>Empirical data</title>
    <p>To showcase the applicability of
<monospace>ngsJulia</monospace> to real data, we deployed to two distinct empirical data sests. To test
<monospace>ngsPool</monospace>, we used mapped reads of
<italic toggle="yes">Arabidopsis lyrata</italic> produced in a previous study.
<sup><xref rid="ref28" ref-type="bibr">28</xref></sup> Specifically, We used data belonging to the population B where 25 individuals of A.
<italic toggle="yes">lyrata</italic> have been sequenced by both pool-sequencing and genotyping-by-sequencing. Since GBS harbours data on a fraction of the genome and Pool-seq is whole genome, We restricted the analysis to the base pairs (bp) sequenced by both techniques, for a total of 15202 bp. The mpileup files have been generated with samtools
<sup><xref rid="ref6" ref-type="bibr">6</xref></sup> (v1.14) and SNP calling in GBS data has been performed with Varscan
<sup><xref rid="ref29" ref-type="bibr">29</xref></sup> (v2.4.2), resulting in 333 SNPs.</p>
    <p>To test
<monospace>ngsPloidy</monospace>, we reanalysed whole-genome sequencing data of the human fungal pathogen
<italic toggle="yes">Candida auris</italic> from a previous study.
<sup><xref rid="ref30" ref-type="bibr">30</xref></sup> We processed data for 21 samples, each one consisting of 17 contigs. As the null hypotheses is that these samples are haploid, we tested ploidy levels from 1 to 4. We filtered out sites with a minimum depth lower than 5 and a proportion of minor alleles lower than 0.15. The number of sites analysed per contig ranged from 555 to 754.</p>
  </sec>
  <sec sec-type="results" id="sec12">
    <title>Results</title>
    <p><monospace>ngsJulia</monospace> implements data structures and functions for an easy calculation of nucleotide and genotype likelihoods (of arbitrary ploidy) which serve the basis of genotype and SNP calling and for the estimation of allele frequencies and other summary statistics. It is particularly suitable for low-coverage sequencing data and for cases when there is high data uncertainty. To demonstrate the use of
<monospace>ngsJulia</monospace>, we provide two custom applications from its templates and functions.</p>
    <sec id="sec13">
      <title>ngsPool: analysis of pooled sequencing data</title>
      <p>We used
<monospace>ngsJulia</monospace> to implement a separate program, called
<monospace>ngsPool</monospace>, to perform population genetic analysis from pooled sequencing data. Specifically,
<monospace>ngsPool</monospace> implements established and novel statistical methods to estimate allele frequencies and site frequency spectra (SFS) and perform association tests from pooled sequencing data.</p>
      <p><monospace>ngsPool</monospace> uses functions in
<monospace>ngsJulia</monospace> to parse mpileup files as input. As an illustration, the following code</p>
      <p>
        <preformat preformat-type="computer code" position="float" xml:space="preserve">julia ngsPool.jl --fin test.mpileup.gz --fout test.out.gz --lrtSnp 6.64</preformat>
      </p>
      <p>will parse
<monospace>test.mpileup.gz</monospace> file and write estimates of allele frequencies in
<monospace>test.out.gz</monospace> file from unknwon sample size after performing SNP calling with an LRT value of 6.64
<monospace>(--lrtSnp 6.64</monospace>, equivalent to a
<italic toggle="yes">p</italic>-value of
<inline-formula><mml:math id="M119" display="inline" overflow="scroll"><mml:mn>0.01</mml:mn></mml:math></inline-formula>).</p>
      <p>Depending on the options selected by the user, output files contain, various results are printed on the screen, including
<list list-type="simple"><list-item><label>•</label><p>inferred major allele,</p></list-item><list-item><label>•</label><p>inferred minor allele,</p></list-item><list-item><label>•</label><p>LRT statistic for SNP calling,</p></list-item><list-item><label>•</label><p>LRT for bi- and tri-allelic calling,</p></list-item><list-item><label>•</label><p>three estimators of the minor allele frequency at each site.</p></list-item></list>
</p>
      <p>Additionally,
<monospace>ngsPool</monospace> can output a file with per-site sample allele frequency likelihoods. The following code</p>
      <p>
        <preformat preformat-type="computer code" position="float" xml:space="preserve">julia ngsPool.jl --fin test.mpileup.gz --fout test.out.gz \\--nChroms 20 --fsaf test.saf.gz</preformat>
      </p>
      <p>will produce estimates of allele frequencies from the known sample size (specified by
<monospace>--nChroms 20</monospace>) and allele frequency likelihoods in
<monospace>test.saf.gz file</monospace>.</p>
      <p>These files can then be used to estimate the SFS and perform an association test using two scripts provided in
<monospace>ngsPool</monospace>. For instance, the code</p>
      <p>
        <preformat preformat-type="computer code" position="float" xml:space="preserve">Rscript poolSFS. R test.saf.gz &gt; sfs.txt</preformat>
      </p>
      <p>will estimate the SFS, while the code</p>
      <p>
        <preformat preformat-type="computer code" position="float" xml:space="preserve">Rscript poolAssoc. R test.cases.saf.gz test.controls.saf.gz &gt; assoc.txt</preformat>
      </p>
      <p>will perform an association test assuming two sets of allele frequency likelihood files, one from cases (
<monospace>test.cases.saf.gz</monospace>) and one from controls (
<monospace>test.controls.saf.gz</monospace>).</p>
    </sec>
    <sec id="sec14">
      <title>Estimation of allele frequencies</title>
      <p>To illustrate the usage of
<monospace>ngsPool</monospace>, we estimated allele frequencies based on simulated data at different experimental conditions. We sought to compare the performance among different estimators implemented in the program. If the sample size is not provided,
<monospace>ngsPool</monospace> provides a simple MLE of the population allele frequency assuming haploidy. Alternatively, if the sample size is provided by the user,
<monospace>ngsPool</monospace> calculates sample allele frequency likelihoods and returns both the MLE and the expected value of the allele frequency using a uniform prior probability.</p>
      <p>Results show that the error of estimating allele frequencies decreases with increasing depth and sample size, as expected (
<xref rid="f1" ref-type="fig">Figure 1</xref>). Likewise, the error for estimating the population allele frequency is more pronounced for lower sample sizes. MLE values tend to be less biased than expected values and sample estimates appear to be unbiased even at depth 1 for moderate sample size (
<xref rid="f1" ref-type="fig">Figure 1</xref>).</p>
      <fig position="float" fig-type="figure" id="f1">
        <label>Figure 1. </label>
        <caption>
          <title>Estimation of minor allele frequencies from pooled sequencing data.</title>
          <p>Bias and root mean square error (RMSE) against the reference true value from either the population or sample are provided for each value of depth
<inline-formula><mml:math id="M120" display="inline" overflow="scroll"><mml:mi>D</mml:mi></mml:math></inline-formula> (the average number of sequenced reads per base pair) and sample size (on column panels) tested. Three estimators of allele frequencies are considered: a population maximum likelihood estimate (MLE) from unknown sample size and the expected value and MLE from known sample size.</p>
        </caption>
        <graphic xlink:href="f1000research-11-150492-g0000" id="gr1" position="float"/>
      </fig>
      <p>Furthermore, we simulated NGS data at fixed population allele frequency and compared the distribution of true sample allele frequencies and estimated values using a MLE approach from known sample size.
<xref rid="f2" ref-type="fig">Figure 2</xref> shows that most of the deviation from the true population allele frequencies occurs at intermediate frequencies (
<inline-formula><mml:math id="M121" display="inline" overflow="scroll"><mml:mi>F</mml:mi></mml:math></inline-formula> equal to 0.5). This effect is more evident for low depth and low sample size (
<xref rid="f2" ref-type="fig">Figure 2</xref>).</p>
      <fig position="float" fig-type="figure" id="f2">
        <label>Figure 2. </label>
        <caption>
          <title>Distribution of estimated minor allele frequencies from pooled sequencing data.</title>
          <p>True sample allele frequencies (SAF) and maximum likelihood estimates (MLE) are shown at different fixed population allele frequencies
<italic toggle="yes">F</italic> and sample sizes (on rows, 20 and 50) and depths (the average number of sequenced reads per base pair, on columns, 0.5, 1, 2, and 5).</p>
        </caption>
        <graphic xlink:href="f1000research-11-150492-g0001" id="gr2" position="float"/>
      </fig>
      <p>We then assessed the effect of low-frequency variants on SNP calling. Specifically, we calculated F1 scores for SNP calling when the population allele frequency is 0 (not a SNP) or greater than 0 (a SNP).
<xref rid="f3" ref-type="fig">Figure 3</xref> shows how the prediction performance increases with the population allele frequency (
<inline-formula><mml:math id="M122" display="inline" overflow="scroll"><mml:mi>F</mml:mi></mml:math></inline-formula>), sample size, and depth (
<inline-formula><mml:math id="M123" display="inline" overflow="scroll"><mml:mi>D</mml:mi></mml:math></inline-formula>). For instance, an F1 score greater than 0.75 is obtained with 20 samples only for
<inline-formula><mml:math id="M124" display="inline" overflow="scroll"><mml:mi>F</mml:mi><mml:mo>=</mml:mo><mml:mn>0.05</mml:mn></mml:math></inline-formula> and
<inline-formula><mml:math id="M125" display="inline" overflow="scroll"><mml:mi>D</mml:mi><mml:mo>&gt;</mml:mo><mml:mn>0.5</mml:mn></mml:math></inline-formula>. On the other hand, the same F1 score is achieved with 50 samples even with
<inline-formula><mml:math id="M126" display="inline" overflow="scroll"><mml:mi>F</mml:mi><mml:mo>=</mml:mo><mml:mn>0.025</mml:mn></mml:math></inline-formula> and also at
<inline-formula><mml:math id="M127" display="inline" overflow="scroll"><mml:mi>F</mml:mi><mml:mo>=</mml:mo><mml:mn>0.02</mml:mn></mml:math></inline-formula> but only if
<inline-formula><mml:math id="M128" display="inline" overflow="scroll"><mml:mi>D</mml:mi><mml:mo>&gt;</mml:mo><mml:mn>1</mml:mn></mml:math></inline-formula>.</p>
      <fig position="float" fig-type="figure" id="f3">
        <label>Figure 3. </label>
        <caption>
          <title>Performance of single nucleotide polymorphism (SNP) calling from pooled sequencing data.</title>
          <p>F1 scores (harmonic means of precision and recall rates) for predicting either a SNP (true population allele frequency
<inline-formula><mml:math id="M129" display="inline" overflow="scroll"><mml:mi>F</mml:mi></mml:math></inline-formula> greater than 0) or not (
<inline-formula><mml:math id="M130" display="inline" overflow="scroll"><mml:mi>F</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:math></inline-formula>) are reported are various values of
<inline-formula><mml:math id="M131" display="inline" overflow="scroll"><mml:mi>F</mml:mi></mml:math></inline-formula>, sample sizes (on columns, 20 and 50) and depths
<inline-formula><mml:math id="M132" display="inline" overflow="scroll"><mml:mi>D</mml:mi></mml:math></inline-formula> (the average number of sequenced reads per base pair).</p>
        </caption>
        <graphic xlink:href="f1000research-11-150492-g0002" id="gr3" position="float"/>
      </fig>
      <p>SNP calling under-performs when there is no variation in the population (
<inline-formula><mml:math id="M133" display="inline" overflow="scroll"><mml:mi>F</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:math></inline-formula>), with sequencing errors and sampling statistical uncertainty generating estimates of
<inline-formula><mml:math id="M134" display="inline" overflow="scroll"><mml:mi>F</mml:mi></mml:math></inline-formula> greater than 0.</p>
      <p><monospace>ngsPool</monospace> implements several methods to estimate the SFS from sample allele frequencies. As described in the methods, a simpler estimator is based on assigning the most likely sample allele frequency at each site (labelled count).
<monospace>ngsPool</monospace> implements novel estimators of SFS from pooled sequencing data as described in the method section. A script implements an algorithm to fit the theoretical SFS to the observed SFS. The latter can be calculated either by assigning per-site MLE of allele frequencies (labelled
<monospace>Fit_count</monospace>) or by integrating the uncertainties across all sample allele frequency likelihoods (labelled
<monospace>Fit_afl</monospace>).</p>
      <p><xref rid="f4" ref-type="fig">Figure 4</xref> shows the error in estimating either the population or sample SFS at various settings with different methods. The error decreases with increasing depth and sample size. Estimating SFS by fitting the theoretical SFS without assignment of allele frequencies generally outperforms other tested strategies (
<xref rid="f4" ref-type="fig">Figure 4</xref>).</p>
      <fig position="float" fig-type="figure" id="f4">
        <label>Figure 4. </label>
        <caption>
          <title>Estimation of site frequency spectrum (SFS) from pooled sequencing data.</title>
          <p>Estimates based on counting allele frequencies (Count) or fitting from counted allele frequencies (
<monospace>Fit Count</monospace>) or from allele frequency likelihoods (
<monospace>Fit afl</monospace>) are calculated. Root mean square error (RMSE) values between true (either population or sample, on rows) and estimated SFS are reported at various depths
<italic toggle="yes">D</italic> and sample sizes (on columns).</p>
        </caption>
        <graphic xlink:href="f1000research-11-150492-g0003" id="gr4" position="float"/>
      </fig>
      <p>Notably, the novel approach implemented in
<monospace>ngsPool</monospace> to estimate the parameter
<inline-formula><mml:math id="M135" display="inline" overflow="scroll"><mml:mi>K</mml:mi></mml:math></inline-formula> of the SFS distribution (see Methods) allow us to directly quantify the error in inferring demographic events. In fact, all simulations assumed constant population size, equivalent to
<inline-formula><mml:math id="M136" display="inline" overflow="scroll"><mml:mi>K</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:math></inline-formula>.
<xref rid="f5" ref-type="fig">Figure 5</xref> shows the estimated values of
<inline-formula><mml:math id="M137" display="inline" overflow="scroll"><mml:mi>K</mml:mi></mml:math></inline-formula> by fitting the SFS either by assigning (counting) allele frequencies (
<monospace>Fit_count</monospace>) or by using allele frequency likelihoods (
<monospace>Fit_afl</monospace>). For low-to-moderate depth and sample size, estimates of
<inline-formula><mml:math id="M138" display="inline" overflow="scroll"><mml:mi>K</mml:mi></mml:math></inline-formula> tend to suggest population expansion (
<inline-formula><mml:math id="M139" display="inline" overflow="scroll"><mml:mi>K</mml:mi><mml:mo>&lt;</mml:mo><mml:mn>1</mml:mn></mml:math></inline-formula>), possibly due to an over-estimation of the abundance of low-frequency alleles. However, the error is reduced when integrating the data uncertainty with sample allele frequency likelihoods, as estimates of
<inline-formula><mml:math id="M140" display="inline" overflow="scroll"><mml:mi>K</mml:mi></mml:math></inline-formula> values tend to be closer to the true simulated value of
<inline-formula><mml:math id="M141" display="inline" overflow="scroll"><mml:mn>1</mml:mn></mml:math></inline-formula> (
<xref rid="f5" ref-type="fig">Figure 5</xref>).</p>
      <fig position="float" fig-type="figure" id="f5">
        <label>Figure 5. </label>
        <caption>
          <title>Estimation of parameter
<italic toggle="yes">K</italic> (used to determine if the population is deviating from constant effective population size) of the site frequency spectrum at different depths D and sample sizes (on rows) from pooled sequencing data.</title>
          <p>Estimates based on fitting from counted allele frequencies (
<monospace>Fit count</monospace>) and from allele frequency likelihoods (
<monospace>Fit afl</monospace>) are reported. Note that the true simulated value of
<italic toggle="yes">K</italic> is 1.</p>
        </caption>
        <graphic xlink:href="f1000research-11-150492-g0004" id="gr5" position="float"/>
      </fig>
      <p><monospace>ngsPool</monospace> implements a script to perform association tests from pooled sequencing data. Specifically, the script calculates an LRT statistic, with null hypothesis being that allele frequencies of cases and controls (or any two groups) are the same, as used by Kim
<italic toggle="yes">et al.</italic>
<sup><xref rid="ref23" ref-type="bibr">23</xref></sup> It uses sample allele frequency likelihoods and, therefore, it maintains data uncertainty and avoids the assignment of counts or per-site allele frequencies. An LRT statistics significantly greater than 0 indicates a difference in allele frequencies between cases and controls.</p>
      <p><xref rid="f6" ref-type="fig">Figure 6</xref> compares the distribution of LRT statistics between causal and non causal sites at different experimental scenarios. The distribution of LRT at causal SNPs is skewed towards higher values for increasing depth, indicating more support to find phenptype-SNP association. Nevertheless, a clear separation between the distributions of causal and non causal SNPs is observed at low depth (
<xref rid="f6" ref-type="fig">Figure 6</xref>).</p>
      <fig position="float" fig-type="figure" id="f6">
        <label>Figure 6. </label>
        <caption>
          <title>Performance of association test from pooled sequencing data.</title>
          <p> The distribution of likelihood-ratio test (LRT) statistics for casual and non causal single-nucleotide polymorphism (SNP) is reported at different depths (the average number of sequenced reads per base pair, on columns).</p>
        </caption>
        <graphic xlink:href="f1000research-11-150492-g0005" id="gr6" position="float"/>
      </fig>
      <p>To illustrate the application of ngsPool to real data, we reanalysed genomic data from
<italic toggle="yes">Arabidopsis lyrata</italic>.
<sup><xref rid="ref28" ref-type="bibr">28</xref></sup> In this study, authors generated data both by genotype-by-sequencing and by pooled-sequencing, with the former providing ground-truth values for genotype and allele calls. Estimates of minor allele frequencies using
<monospace>ngsPool</monospace> yield a lower RMSE (0.09372) than estimates from Varscan (0.09783) across all SNPs analysed.</p>
    </sec>
    <sec id="sec15">
      <title>ngsPloidy: analysis of sequencing data from polyploid genomes</title>
      <p>We further utilised
<monospace>ngsJulia</monospace> to implement an additional program,
<monospace>ngsPloidy</monospace>, for the estimation of ploidy from unknown genotypes. The method implemented is similar to the one proposed by Soraggi
<italic toggle="yes">et al.</italic>
<sup><xref rid="ref22" ref-type="bibr">22</xref></sup> with some notable differences on the calculation of genotype probabilities (see Methods). Additionally,
<monospace>ngsPloidy</monospace> includes a novel method to test for multiploidy in the sample. As an illustration, the following code</p>
      <p>
        <preformat preformat-type="computer code" position="float" xml:space="preserve">julia ngsPloidy.jl --fin test.mpileup.gz --nSamples 20 &gt; test.outRscript ploidyLRT. R test.out</preformat>
      </p>
      <p>will estimate ploidy levels for
<inline-formula><mml:math id="M142" display="inline" overflow="scroll"><mml:mn>20</mml:mn></mml:math></inline-formula> genomes (
<monospace>--nSamples 20</monospace>) from
<monospace>test.mpileup.gz</monospace> file and return LRT values.</p>
      <p>Following
<xref rid="e2" ref-type="disp-formula">Equation 2</xref>, the genotype probabilities for each tested ploidy are pre-calculated using a script provided in
<monospace>ngsPloidy</monospace>. This script takes as input the value of parameter
<inline-formula><mml:math id="M143" display="inline" overflow="scroll"><mml:mi>K</mml:mi></mml:math></inline-formula> (the shape of the expected SFS), the effective population size, and the probability that the major allele is the ancestral allele. The latter can be either set by the user (e.g., a value of 0.5 would be equivalent to unknown polarisation, as in a folded SFS) or be calculated from the expected population SFS itself. If genotype probabilities are not set, a uniform distribution is assigned. Further options allow for estimation only on called SNPs and/or genotypes.</p>
      <p><monospace>ngsPloidy</monospace> uses functions in
<monospace>ngsJulia</monospace> to parse mpileup files as input. At the end of the computation, various results are printed on the screen, including
<list list-type="simple"><list-item><label>•</label><p>the number of analysed sites that passed filtering for each sample,</p></list-item><list-item><label>•</label><p>a matrix of ploidy log-likelihoods for each sample,</p></list-item><list-item><label>•</label><p>the log-likelihood and MLE of the ploidy vector (i.e., the individually estimated ploidy for each sample),</p></list-item><list-item><label>•</label><p>LRT scores for the test of multiploidy against all tested ploidy levels.</p></list-item></list>
</p>
      <p>Additionally, if requested by the user,
<monospace>ngsPloidy</monospace> can generate output files with several statistics for each site (e.g., estimate allele frequency), and all per-site genotype likelihoods for each sample and the tested ploidy.</p>
      <p>To illustrate the usage of
<monospace>ngsPloidy</monospace>, we deployed it to simulated data of an multiploid sample consisting of one diploid, eight triploid and one tetraploid genomes. We compared the performance of ploidy and multiploidy inference among different choices of genotype probabilities. The latter were derived either from the expected folded population site frequency, from the estimated ancestral population allele frequency, or from the calculated sample allele frequency.</p>
      <p>In all tested cases, we inferred the correct vector of marginal ploidy levels. We therefore assessed the confidence in such inference by calculating the LRT statistics of ploidy and multiploidy inferences. Both were calculated by comparing the most against the second most likely vector of ploidy levels or the most likely vector of equal ploidy levels, respectively.</p>
      <p>Results show that using the per-site estimate sampled allele frequency yields higher LRT statistics (and therefore confidence) than using expected population allele frequencies (
<xref rid="T1" ref-type="table">Table 1</xref>). We reiterate that for all three cases we correctly identified the patterns of multiploidy. However, we should caution that with lower sample sizes we do not expect inferences using estimated sample allele frequencies to perform well.</p>
      <table-wrap position="float" id="T1">
        <label>Table 1. </label>
        <caption>
          <title>Confidence values to the correctly assigned ploidy vector and test for multiploidy.</title>
          <p>Likelihood-ratio test (LRT) statistics using different methods of incorporating allele frequencies are reported.</p>
        </caption>
        <table frame="hsides" rules="groups" content-type="article-table">
          <thead>
            <tr>
              <th align="left" colspan="1" rowspan="1" valign="top">Allele frequency</th>
              <th align="left" colspan="1" rowspan="1" valign="top">LRT – ploidy</th>
              <th align="left" colspan="1" rowspan="1" valign="top">LRT - multiploidy</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td align="left" colspan="1" rowspan="1" valign="top">Folded</td>
              <td align="left" colspan="1" rowspan="1" valign="top">34.19</td>
              <td align="left" colspan="1" rowspan="1" valign="top">252.72</td>
            </tr>
            <tr>
              <td align="left" colspan="1" rowspan="1" valign="top">Ancestral</td>
              <td align="left" colspan="1" rowspan="1" valign="top">31.49</td>
              <td align="left" colspan="1" rowspan="1" valign="top">277.91</td>
            </tr>
            <tr>
              <td align="left" colspan="1" rowspan="1" valign="top">Sample</td>
              <td align="left" colspan="1" rowspan="1" valign="top">37.83</td>
              <td align="left" colspan="1" rowspan="1" valign="top">373.07</td>
            </tr>
          </tbody>
        </table>
      </table-wrap>
      <p>To illustrate the applicability of
<monospace>ngsPloidy</monospace> to real empirical data, we inferred ploidy levels on 21 isolates from an outbreak of
<italic toggle="yes">Candida auris</italic>.
<sup><xref rid="ref30" ref-type="bibr">30</xref></sup> In all contigs analysed, haploid was inferred as the most likely ploidy and multiploidy was rejected in all samples. These results are consistent with findings from the original study, although the identification of polyploidy in other isolates may be associated with multidrug-resistant phenotypes.
<sup><xref rid="ref31" ref-type="bibr">31</xref></sup>
</p>
    </sec>
  </sec>
  <sec sec-type="discussion" id="sec16">
    <title>Discussion</title>
    <p>Analyses presented here provide further support for the use of genotype and allele frequency likelihoods in the analysis of NGS data.
<sup><xref rid="ref5" ref-type="bibr">5</xref></sup> Notably, we demonstrated how probabilistic estimates of population genetic parameters can be obtained in case of pooled sequencing data and short-read data from polyploid genomes. Additionally, we motivated the inference of SFS from allele frequency likelihoods as a direct way to infer demography from raw sequencing data.</p>
    <p><monospace>ngsJulia</monospace> offers new possibilities of software prototyping for custom analyses of NGS data for population genetic applications. Furthermore, it facilitates experimental design as it provides a platform to benchmark the efficacy of population genetic analysis from competing sequencing experiments. Finally,
<monospace>ngsJulia</monospace> has accessible documentation and tutorials to inform users on the theory underpinning the implemented methods. We envisage that further improvements in
<monospace>ngsJulia</monospace> will include the expansion of suitable input formats and data file types, and the compatibility with additional NGS data type, including from long-read sequencing experiments.
<sup><xref rid="ref32" ref-type="bibr">32</xref></sup>
</p>
  </sec>
  <sec sec-type="conclusions" id="sec17">
    <title>Conclusions</title>
    <p>In this study, we introduce
<monospace>ngsJulia</monospace>, a series of templates and functions in
<monospace>Julia</monospace> language to analyse NGS data for population genetic purposes. We present two implementations for the analysis of pooled sequencing data and polyploid genomes, with the inclusion of novel methods.
<monospace>ngsJulia</monospace> is a suitable framework for prototyping new software and for custom population genetic analyses from NGS data.</p>
  </sec>
  <sec sec-type="data-availability" id="sec18">
    <title>Data availability</title>
    <sec id="sec19">
      <title>Underlying data</title>
      <p>Simulated data and pipeline to reproduce all results presented here are available at
<ext-link xlink:href="https://doi.org/10.5281/zenodo.5886879" ext-link-type="uri">https://doi.org/10.5281/zenodo.5886879</ext-link>.
<sup><xref rid="ref20" ref-type="bibr">20</xref></sup>
</p>
      <p>Data are available under the terms of the
<ext-link xlink:href="https://creativecommons.org/licenses/by/4.0/" ext-link-type="uri">Creative Commons Attribution 4.0 International Public License</ext-link>.</p>
    </sec>
  </sec>
  <sec id="sec20">
    <title>Software availability</title>
    <p>
      <list list-type="simple">
        <list-item>
          <label>•</label>
          <p>Source code available from:
<ext-link xlink:href="https://github.com/mfumagalli/ngsJulia" ext-link-type="uri">https://github.com/mfumagalli/ngsJulia</ext-link>
</p>
        </list-item>
        <list-item>
          <label>•</label>
          <p>Archived source code at time of publication:
<ext-link xlink:href="https://doi.org/10.5281/zenodo.5886879" ext-link-type="uri">https://doi.org/10.5281/zenodo.5886879</ext-link>
<sup><xref rid="ref20" ref-type="bibr">20</xref></sup>
</p>
        </list-item>
        <list-item>
          <label>•</label>
          <p>License:
<ext-link xlink:href="https://creativecommons.org/licenses/by/4.0/" ext-link-type="uri">Creative Commons Attribution 4.0 International Public License</ext-link>
</p>
        </list-item>
      </list>
    </p>
  </sec>
</body>
<back>
  <ack>
    <title>Acknowledgements</title>
    <p>We are thankful to Johanna Rhodes for assistance gathering sequencing data for
<italic toggle="yes">Candida auris</italic>.</p>
  </ack>
  <ref-list>
    <title>References</title>
    <ref id="ref1">
      <label>1</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Marchi</surname><given-names>N</given-names></name><name><surname>Schlichta</surname><given-names>F</given-names></name><name><surname>Excoffier</surname><given-names>L</given-names></name></person-group>:
<article-title>Demographic inference.</article-title><source><italic toggle="yes">Curr. Biol.</italic></source><year>2021</year>;<volume>31</volume>(<issue>6</issue>):<fpage>R276</fpage>–<lpage>R279</lpage>.
<pub-id pub-id-type="doi">10.1016/j.cub.2021.01.053</pub-id><ext-link xlink:href="https://www.sciencedirect.com/science/article/pii/S0960982221001184" ext-link-type="uri">Reference Source</ext-link><pub-id pub-id-type="pmid">33756135</pub-id></mixed-citation>
    </ref>
    <ref id="ref2">
      <label>2</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Vitti</surname><given-names>JJ</given-names></name><name><surname>Grossman</surname><given-names>SR</given-names></name><name><surname>Sabeti</surname><given-names>PC</given-names></name></person-group>:
<article-title>Detecting natural selection in genomic data.</article-title><source><italic toggle="yes">Annu. Rev. Genet.</italic></source><year>2013</year>;<volume>47</volume>(<issue>1</issue>):<fpage>97</fpage>–<lpage>120</lpage>.
<pub-id pub-id-type="doi">10.1146/annurev-genet-111212-133526</pub-id><?supplied-pmid 24274750?><pub-id pub-id-type="pmid">24274750</pub-id></mixed-citation>
    </ref>
    <ref id="ref3">
      <label>3</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Uffelmann</surname><given-names>E</given-names></name><name><surname>Huang</surname><given-names>QQ</given-names></name><name><surname>Munung</surname><given-names>NS</given-names></name><etal/></person-group>:
<article-title>Genome-wide association studies.</article-title><source><italic toggle="yes">Nature Reviews Methods Primers.</italic></source><year>Aug 2021</year>;<volume>1</volume>(<issue>1</issue>):<fpage>59</fpage>.
<pub-id pub-id-type="doi">10.1038/s43586-021-00056-9</pub-id></mixed-citation>
    </ref>
    <ref id="ref4">
      <label>4</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Levy</surname><given-names>SE</given-names></name><name><surname>Myers</surname><given-names>RM</given-names></name></person-group>:
<article-title>Advancements in next-generation sequencing.</article-title><source><italic toggle="yes">Annu. Rev. Genomics Hum. Genet.</italic></source><year>2016</year>;<volume>17</volume>(<issue>1</issue>):<fpage>95</fpage>–<lpage>115</lpage>.
<pub-id pub-id-type="doi">10.1146/annurev-genom-083115-022413</pub-id><?supplied-pmid 27362342?><pub-id pub-id-type="pmid">27362342</pub-id></mixed-citation>
    </ref>
    <ref id="ref5">
      <label>5</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Nielsen</surname><given-names>R</given-names></name><name><surname>Paul</surname><given-names>JS</given-names></name><name><surname>Albrechtsen</surname><given-names>A</given-names></name><etal/></person-group>:
<article-title>Genotype and snp calling from next-generation sequencing data.</article-title><source><italic toggle="yes">Nat. Rev. Genet.</italic></source><year>June 2011</year>;<volume>12</volume>(<issue>6</issue>):<fpage>443</fpage>–<lpage>451</lpage>.
<pub-id pub-id-type="doi">10.1038/nrg2986</pub-id><ext-link xlink:href="https://europepmc.org/articles/PMC3593722" ext-link-type="uri">Reference Source</ext-link><?supplied-pmid 21587300?><pub-id pub-id-type="pmid">21587300</pub-id></mixed-citation>
    </ref>
    <ref id="ref6">
      <label>6</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Li</surname><given-names>H</given-names></name></person-group>:
<article-title>A statistical framework for SNP calling, mutation discovery, association mapping and population genetical parameter estimation from sequencing data.</article-title><source><italic toggle="yes">Bioinformatics.</italic></source><year>09 2011</year>;<volume>27</volume>(<issue>21</issue>):<fpage>2987</fpage>–<lpage>2993</lpage>.
<pub-id pub-id-type="doi">10.1093/bioinformatics/btr509</pub-id><?supplied-pmid 21903627?><pub-id pub-id-type="pmid">21903627</pub-id></mixed-citation>
    </ref>
    <ref id="ref7">
      <label>7</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Van der Auwera</surname><given-names>GA</given-names></name><name><surname>Carneiro</surname><given-names>MO</given-names></name><name><surname>Hartl</surname><given-names>C</given-names></name><etal/></person-group>:
<article-title>From fastq data to high-confidence variant calls: The genome analysis toolkit best practices pipeline.</article-title><source><italic toggle="yes">Curr. Protoc. Bioinformatics.</italic></source><year>2013</year>;<volume>43</volume>(<issue>1</issue>):<fpage>11.10.1</fpage>–<lpage>11.10.33</lpage>.
<pub-id pub-id-type="doi">10.1002/0471250953.bi1110s43</pub-id><?supplied-pmid 25431634?><pub-id pub-id-type="pmid">25431634</pub-id></mixed-citation>
    </ref>
    <ref id="ref8">
      <label>8</label>
      <mixed-citation publication-type="other"><person-group person-group-type="author"><name><surname>Garrison</surname><given-names>E</given-names></name><name><surname>Marth</surname><given-names>G</given-names></name></person-group>:
<article-title>Haplotype-based variant detection from short-read sequencing.</article-title><year>2012</year>.
<ext-link xlink:href="https://github.com/freebayes/freebayes" ext-link-type="uri">Reference Source</ext-link></mixed-citation>
    </ref>
    <ref id="ref9">
      <label>9</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Crawford</surname><given-names>J</given-names></name><name><surname>Lazzaro</surname><given-names>B</given-names></name></person-group>:
<article-title>Assessing the accuracy and power of population genetic inference from low-pass next-generation sequencing data.</article-title><source><italic toggle="yes">Front. Genet.</italic></source><year>2012</year>;<volume>3</volume>:<fpage>66</fpage>.
<issn>1664-8021</issn>.
<pub-id pub-id-type="doi">10.3389/fgene.2012.00066</pub-id><?supplied-pmid 22536207?><pub-id pub-id-type="pmid">22536207</pub-id></mixed-citation>
    </ref>
    <ref id="ref10">
      <label>10</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Fumagalli</surname><given-names>M</given-names></name></person-group>:
<article-title>Assessing the effect of sequencing depth and sample size in population genetics inferences.</article-title><source><italic toggle="yes">PLoS One.</italic></source><year>11 2013</year>;<volume>8</volume>(<issue>11</issue>):<fpage>1</fpage>–<lpage>11</lpage>.
<pub-id pub-id-type="doi">10.1371/journal.pone.0079667</pub-id><?supplied-pmid 24260275?><pub-id pub-id-type="pmid">24260275</pub-id></mixed-citation>
    </ref>
    <ref id="ref11">
      <label>11</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Korneliussen</surname><given-names>TS</given-names></name><name><surname>Albrechtsen</surname><given-names>A</given-names></name><name><surname>Nielsen</surname><given-names>R</given-names></name></person-group>:
<article-title>Angsd: analysis of next generation sequencing data.</article-title><source><italic toggle="yes">BMC Bioinformatics.</italic></source><year>2014</year>;<volume>15</volume>(<issue>1</issue>):<fpage>356</fpage>.
<pub-id pub-id-type="doi">10.1186/s12859-014-0356-4</pub-id><?supplied-pmid 25420514?><pub-id pub-id-type="pmid">25420514</pub-id></mixed-citation>
    </ref>
    <ref id="ref12">
      <label>12</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Fumagalli</surname><given-names>M</given-names></name><name><surname>Vieira</surname><given-names>FG</given-names></name><name><surname>Linderoth</surname><given-names>T</given-names></name><etal/></person-group>:
<article-title>ngsTools: methods for population genetics analyses from next-generation sequencing data.</article-title><source><italic toggle="yes">Bioinformatics.</italic></source><year>May 2014</year>;<volume>30</volume>(<issue>10</issue>):<fpage>1486</fpage>–<lpage>1487</lpage>.
<pub-id pub-id-type="doi">10.1093/bioinformatics/btu041</pub-id><ext-link xlink:href="https://academic.oup.com/bioinformatics/article/30/10/1486/267009" ext-link-type="uri">Reference Source</ext-link><?supplied-pmid 24458950?><pub-id pub-id-type="pmid">24458950</pub-id></mixed-citation>
    </ref>
    <ref id="ref13">
      <label>13</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lou</surname><given-names>RN</given-names></name><name><surname>Jacobs</surname><given-names>A</given-names></name><name><surname>Wilder</surname><given-names>A</given-names></name><name><surname>Therkildsen</surname><given-names>NO</given-names></name></person-group>:
<article-title>A beginner’s guide to low-coverage whole genome sequencing for population genomics.</article-title><source><italic toggle="yes">Mol. Ecol.</italic></source><year>2021</year>;<volume>30</volume>:<fpage>5966</fpage>–<lpage>5993</lpage><pub-id pub-id-type="doi">10.1111/mec.16077</pub-id><pub-id pub-id-type="pmid">34250668</pub-id></mixed-citation>
    </ref>
    <ref id="ref14">
      <label>14</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Schlötterer</surname><given-names>C</given-names></name><name><surname>Tobler</surname><given-names>R</given-names></name><name><surname>Kofler</surname><given-names>R</given-names></name><name><surname>Nolte</surname><given-names>V</given-names></name></person-group>:
<article-title>Sequencing pools of individuals — mining genome-wide polymorphism data without big funding.</article-title><source><italic toggle="yes">Nat. Rev. Genet.</italic></source><year>Nov 2014</year>;<volume>15</volume>(<issue>11</issue>):<fpage>749</fpage>–<lpage>763</lpage>.
<pub-id pub-id-type="doi">10.1038/nrg3803</pub-id><?supplied-pmid 25246196?><pub-id pub-id-type="pmid">25246196</pub-id></mixed-citation>
    </ref>
    <ref id="ref15">
      <label>15</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kofler</surname><given-names>R</given-names></name><name><surname>Pandey</surname><given-names>RV</given-names></name><name><surname>Schlötterer</surname><given-names>C</given-names></name></person-group>:
<article-title>PoPoolation2: identifying differentiation between populations using sequencing of pooled DNA samples (Pool-Seq).</article-title><source><italic toggle="yes">Bioinformatics.</italic></source><year>10 2011</year>;<volume>27</volume>(<issue>24</issue>):<fpage>3435</fpage>–<lpage>3436</lpage>.
<pub-id pub-id-type="doi">10.1093/bioinformatics/btr589</pub-id><?supplied-pmid 22025480?><pub-id pub-id-type="pmid">22025480</pub-id></mixed-citation>
    </ref>
    <ref id="ref16">
      <label>16</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Raineri</surname><given-names>E</given-names></name><name><surname>Ferretti</surname><given-names>L</given-names></name><name><surname>Esteve-Codina</surname><given-names>A</given-names></name><etal/></person-group>:
<article-title>Snp calling by sequencing pooled samples.</article-title><source><italic toggle="yes">BMC Bioinformatics.</italic></source><year>Sep 2012</year>;<volume>13</volume>(<issue>1</issue>):<fpage>239</fpage>.
<pub-id pub-id-type="doi">10.1186/1471-2105-13-239</pub-id><?supplied-pmid 22992255?><pub-id pub-id-type="pmid">22992255</pub-id></mixed-citation>
    </ref>
    <ref id="ref17">
      <label>17</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bezanson</surname><given-names>J</given-names></name><name><surname>Edelman</surname><given-names>A</given-names></name><name><surname>Karpinski</surname><given-names>S</given-names></name><etal/></person-group>:
<article-title>Julia: A fresh approach to numerical computing.</article-title><source><italic toggle="yes">SIAM Rev.</italic></source><year>2017</year>;<volume>59</volume>(<issue>1</issue>):<fpage>65</fpage>–<lpage>98</lpage>.
<pub-id pub-id-type="doi">10.1137/141000671</pub-id></mixed-citation>
    </ref>
    <ref id="ref18">
      <label>18</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Sato</surname><given-names>K</given-names></name><name><surname>Tsuyuzaki</surname><given-names>K</given-names></name><name><surname>Shimizu</surname><given-names>K</given-names></name><etal/></person-group>:
<article-title>Cellfishing.jl: an ultrafast and scalable cell search method for single-cell rna sequencing.</article-title><source><italic toggle="yes">Genome Biol.</italic></source><year>Feb 2019</year>;<volume>20</volume>(<issue>1</issue>):<fpage>31</fpage>.
<pub-id pub-id-type="doi">10.1186/s13059-019-1639-x</pub-id><?supplied-pmid 30744683?><pub-id pub-id-type="pmid">30744683</pub-id></mixed-citation>
    </ref>
    <ref id="ref19">
      <label>19</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Li</surname><given-names>H</given-names></name><name><surname>Handsaker</surname><given-names>B</given-names></name><name><surname>Wysoker</surname><given-names>A</given-names></name><etal/></person-group>:
<article-title>The Sequence Alignment/Map format and SAMtools.</article-title><source><italic toggle="yes">Bioinformatics.</italic></source><year>06 2009</year>;<volume>25</volume>(<issue>16</issue>):<fpage>2078</fpage>–<lpage>2079</lpage>.
<pub-id pub-id-type="doi">10.1093/bioinformatics/btp352</pub-id><?supplied-pmid 19505943?><pub-id pub-id-type="pmid">19505943</pub-id></mixed-citation>
    </ref>
    <ref id="ref20">
      <label>20</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Fumagalli</surname><given-names>M</given-names></name></person-group>:
<article-title>ngsjulia: population genetic analysis of next-generation dna sequencing data with julia language.</article-title><source><italic toggle="yes">Zenodo.</italic></source><year>2022</year>.
<pub-id pub-id-type="doi">10.5281/zenodo.5886879</pub-id></mixed-citation>
    </ref>
    <ref id="ref21">
      <label>21</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>McKenna</surname><given-names>A</given-names></name><name><surname>Hanna</surname><given-names>M</given-names></name><name><surname>Banks</surname><given-names>E</given-names></name><etal/></person-group>:
<article-title>The Genome Analysis Toolkit: a MapReduce framework for analyzing next-generation DNA sequencing data.</article-title><source><italic toggle="yes">Genome Res.</italic></source><year>sep 2010</year>;<volume>20</volume>(<issue>9</issue>):<fpage>1297</fpage>–<lpage>303</lpage>.
<pub-id pub-id-type="doi">10.1101/gr.107524.110</pub-id><ext-link xlink:href="http://www.ncbi.nlm.nih.gov/pubmed/20644199" ext-link-type="uri">Reference Source</ext-link><pub-id pub-id-type="pmid">20644199</pub-id></mixed-citation>
    </ref>
    <ref id="ref22">
      <label>22</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Soraggi</surname><given-names>S</given-names></name><name><surname>Rhodes</surname><given-names>J</given-names></name><name><surname>Altinkaya</surname><given-names>I</given-names></name><etal/></person-group>:
<article-title>Hmmploidy: inference of ploidy levels from short-read sequencing data.</article-title><source><italic toggle="yes">Peer Commun J</italic></source>.<year>2022</year>;<volume>2</volume>: e60.
<pub-id pub-id-type="doi">10.24072/pcjournal.178</pub-id><ext-link xlink:href="https://peercommunityjournal.org/articles/10.24072/pcjournal.178/" ext-link-type="uri">Reference Source</ext-link></mixed-citation>
    </ref>
    <ref id="ref23">
      <label>23</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kim</surname><given-names>SY</given-names></name><name><surname>Lohmueller</surname><given-names>KE</given-names></name><name><surname>Albrechtsen</surname><given-names>A</given-names></name><etal/></person-group>:
<article-title>Estimation of allele frequency and association mapping using next-generation sequencing data.</article-title><source><italic toggle="yes">BMC Bioinformatics.</italic></source><year>Jun 2011</year>;<volume>12</volume>(<issue>1</issue>):<fpage>231</fpage>.
<pub-id pub-id-type="doi">10.1186/1471-2105-12-231</pub-id><?supplied-pmid 21663684?><pub-id pub-id-type="pmid">21663684</pub-id></mixed-citation>
    </ref>
    <ref id="ref24">
      <label>24</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Nielsen</surname><given-names>R</given-names></name><name><surname>Korneliussen</surname><given-names>T</given-names></name><name><surname>Albrechtsen</surname><given-names>A</given-names></name><etal/></person-group>:
<article-title>Snp calling, genotype calling, and sample allele frequency estimation from new-generation sequencing data.</article-title><source><italic toggle="yes">PLoS One.</italic></source><year>07 2012</year>;<volume>7</volume>(<issue>7</issue>):<fpage>1</fpage>–<lpage>10</lpage>.
<pub-id pub-id-type="doi">10.1371/journal.pone.0037558</pub-id><?supplied-pmid 22911679?><pub-id pub-id-type="pmid">22911679</pub-id></mixed-citation>
    </ref>
    <ref id="ref25">
      <label>25</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ewens</surname><given-names>WJ</given-names></name></person-group>:
<article-title>The sampling theory of selectively neutral alleles.</article-title><source><italic toggle="yes">Theor. Popul. Biol.</italic></source><year>1972</year>;<volume>3</volume>(<issue>1</issue>):<fpage>87</fpage>–<lpage>112</lpage>.
<pub-id pub-id-type="doi">10.1016/0040-5809(72)90035-4</pub-id><ext-link xlink:href="https://www.sciencedirect.com/science/article/pii/0040580972900354" ext-link-type="uri">Reference Source</ext-link><?supplied-pmid 4667078?><pub-id pub-id-type="pmid">4667078</pub-id></mixed-citation>
    </ref>
    <ref id="ref26">
      <label>26</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bielski</surname><given-names>CM</given-names></name><name><surname>Zehir</surname><given-names>A</given-names></name><name><surname>Penson</surname><given-names>AV</given-names></name><etal/></person-group>:
<article-title>Genome doubling shapes the evolution and prognosis of advanced cancers.</article-title><source><italic toggle="yes">Nature Genetics.</italic></source><year>Aug 2018</year>;<volume>50</volume>(<issue>8</issue>):<fpage>1189</fpage>–<lpage>1195</lpage>.
<pub-id pub-id-type="doi">10.1038/s41588-018-0165-1</pub-id><pub-id pub-id-type="pmid">30013179</pub-id></mixed-citation>
    </ref>
    <ref id="ref27">
      <label>27</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Fumagalli</surname><given-names>M</given-names></name><name><surname>Vieira</surname><given-names>FG</given-names></name><name><surname>Korneliussen</surname><given-names>TS</given-names></name><etal/></person-group>:
<article-title>Quantifying population genetic differentiation from next-generation sequencing data.</article-title><source><italic toggle="yes">Genetics.</italic></source><year>2013</year>;<volume>195</volume>(<issue>3</issue>):<fpage>979</fpage>–<lpage>992</lpage>.
<pub-id pub-id-type="doi">10.1534/genetics.113.154740</pub-id><ext-link xlink:href="https://www.genetics.org/content/195/3/979" ext-link-type="uri">Reference Source</ext-link><?supplied-pmid 23979584?><pub-id pub-id-type="pmid">23979584</pub-id></mixed-citation>
    </ref>
    <ref id="ref28">
      <label>28</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Fracassetti</surname><given-names>M</given-names></name><name><surname>Griffin</surname><given-names>P. C</given-names></name><name><surname>Willi</surname><given-names>Y.</given-names></name><etal/></person-group>:
<article-title>Validation of pooled whole-genome re-sequencing in arabidopsis lyrata.</article-title><source><italic toggle="yes">PLoS One</italic></source>.<year>2015</year>;<volume>10</volume>(<issue>10</issue>):<fpage>1</fpage>–<lpage>15</lpage>.
<pub-id pub-id-type="doi">10.1371/journal.pone.0140462</pub-id><pub-id pub-id-type="doi">10.1371/journal.pone.0140462</pub-id></mixed-citation>
    </ref>
    <ref id="ref29">
      <label>29</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Koboldt</surname><given-names>D. C</given-names></name><name><surname>Zhang</surname><given-names>Q</given-names></name><name><surname>Larson</surname><given-names>D. E</given-names></name><etal/></person-group>:
<article-title>Varscan 2: Somatic mutation and copy number alteration discovery in cancer by exome sequencing.</article-title><source><italic toggle="yes">Genome Research.</italic></source><year>2012</year>;<volume>22</volume>(<issue>3</issue>):<fpage>568</fpage>–<lpage>576</lpage>.
<pub-id pub-id-type="doi">10.1101/gr.129684.111</pub-id><ext-link xlink:href="http://genome.cshlporg/content/22/3/568.abstract" ext-link-type="uri">Reference Source</ext-link><pub-id pub-id-type="pmid">22300766</pub-id></mixed-citation>
    </ref>
    <ref id="ref30">
      <label>30</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Rhodes</surname><given-names>J.</given-names></name><name><surname>Abdolrasouli</surname><given-names>A.</given-names></name><name><surname>Farrer</surname><given-names>R. A</given-names></name><etal/></person-group><article-title>Genomic epidemiology of the uk outbreak of the emerging human fungal pathogen candida auris</article-title>.
<source><italic toggle="yes">Emerging Microbes &amp; Infections</italic></source>.<year>2018</year>;<volume>7</volume>(<issue>1</issue>):<fpage>1</fpage>–<lpage>12</lpage>.
<pub-id pub-id-type="doi">10.1038/s41426-018-0045-x</pub-id><pub-id pub-id-type="doi">10.1038/s41426-018-0045-x</pub-id><?supplied-pmid 29593275?><pub-id pub-id-type="pmid">29323102</pub-id></mixed-citation>
    </ref>
    <ref id="ref31">
      <label>31</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Navalkele</surname><given-names>B. D</given-names></name><name><surname>Revankar</surname><given-names>S</given-names></name><name><surname>Chandrasekar</surname><given-names>P.</given-names></name></person-group>:
<article-title>Candida auris: a worrisome, globally emerging pathogen.</article-title><source><italic toggle="yes">Expert Review of Anti-infective Therapy</italic></source>.<year>2017</year>;<volume>15</volume>(<issue>9</issue>):<fpage>819</fpage>–<lpage>827</lpage>.
<pub-id pub-id-type="doi">10.1080/14787210.2017.1364992</pub-id><pub-id pub-id-type="doi">10.1080/14787210.2017.1364992</pub-id><?supplied-pmid 28783385?><pub-id pub-id-type="pmid">28783385</pub-id></mixed-citation>
    </ref>
    <ref id="ref32">
      <label>32</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Logsdon</surname><given-names>GA</given-names></name><name><surname>Vollger</surname><given-names>MR</given-names></name><name><surname>Eichler</surname><given-names>EE</given-names></name></person-group>:
<article-title>Long-read human genome sequencing and its applications.</article-title><source><italic toggle="yes">Nat. Rev. Genet.</italic></source><year>Oct 2020</year>;<volume>21</volume>(<issue>10</issue>):<fpage>597</fpage>–<lpage>614</lpage>.
<pub-id pub-id-type="doi">10.1038/s41576-020-0236-x</pub-id><?supplied-pmid 32504078?><pub-id pub-id-type="pmid">32504078</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
<sub-article article-type="reviewer-report" id="report202079">
  <front-stub>
    <article-id pub-id-type="doi">10.5256/f1000research.150492.r202079</article-id>
    <title-group>
      <article-title>Reviewer response for version 3</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Léon</surname>
          <given-names>Jens</given-names>
        </name>
        <xref rid="r202079a1" ref-type="aff">1</xref>
        <role>Referee</role>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Schneider</surname>
          <given-names>Michael</given-names>
        </name>
        <xref rid="r202079a2" ref-type="aff">2</xref>
        <role>Co-referee</role>
      </contrib>
      <aff id="r202079a1"><label>1</label>University of Bonn, Bonn, Germany</aff>
      <aff id="r202079a2"><label>2</label>Forschungsinstitut fur Biologischen Landbau, Frick, Aargau, Switzerland</aff>
    </contrib-group>
    <author-notes>
      <fn fn-type="COI-statement">
        <p><bold>Competing interests: </bold>No competing interests were disclosed.</p>
      </fn>
    </author-notes>
    <pub-date pub-type="epub">
      <day>11</day>
      <month>10</month>
      <year>2023</year>
    </pub-date>
    <permissions>
      <copyright-statement>Copyright: © 2023 Léon J and Schneider M</copyright-statement>
      <copyright-year>2023</copyright-year>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p>This is an open access peer review report distributed under the terms of the Creative Commons Attribution Licence, which permits unrestricted use, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <related-article related-article-type="peer-reviewed-article" ext-link-type="doi" id="relatedArticleReport202079" xlink:href="10.12688/f1000research.104368.3">Version 3</related-article>
    <custom-meta-group>
      <custom-meta>
        <meta-name>recommendation</meta-name>
        <meta-value>approve-with-reservations</meta-value>
      </custom-meta>
    </custom-meta-group>
  </front-stub>
  <body>
    <p>First of all, I have to write that we are working on a method to estimate the allele frequency in crops by pool sequencing. Therefore, we are very interested in this new methodology. In this review our research group have a look on the manuscript. We are researchers dealing with population and quantitative genetics of plants and other are dealing with bioinformatics.</p>
    <p> We recognized that the examples and sources for the testing are rather complex. The authors explain their probes to be haploid, usually diploid but also polyploid. They state that the samples of the organisms are mostly biallelic but sometimes also tri-allelic. We expect that in a population we usually have multiple alleles. The authors are also dealing with pooled samples. But for researches dealing with theses probes, it is rather confusing to understand the restrictions. Regarding a divers readership, I would like to recommend that the authors clearly define their samples first (haploid, diploid or polyploid and whether biallelic or multi-allelic loci are expected). When dealing with pooled samples the readership should know about the expectation of the samples (e.g. pool of sperms or pollen grains are different from a pool of cells from an individuum). Analysing populations with pooled NGS, it would be important to know how the software deals with a highly heterogenous material, as several individuals in a population. Although the authors tried to group their methods, it is still unclear which expectations the authors have to the samples.</p>
    <p> It would be helpful to provide a code example of creating the mpileup file.</p>
    <p> Why do you need to provide a new tool to call SNPs? The three tools in the introduction are all solid options</p>
    <p> and can give allele frequency calls, too. Adding the info on the expected allele frequency is helpful - but the effect of this additional information</p>
    <p> would be worth demonstrating. E.g., by showing the accuracy of recalling the correct allele frequency with and without this term. Besides,</p>
    <p> how would someone with a heterogeneous population set this value?</p>
    <p> It would be helpful to illustrate the actual distribution of reads across the genome. It is hard to imagine that with a uniform coverage of 0.5,</p>
    <p> which is not uncommon these days to receive from a WGS run, a good recall rate of the allele frequency can be achieved. It would, therefore, be helpful to understand the assumed input data better and provide the lambda value of the Poisson model for read simulations.</p>
    <p> There is no information provided about the recall rate of simulated SNPs. How many SNPs were detected on the different sequencing depth levels,</p>
    <p> and how many were falsely discovered? This is a major problem in the other named variant callers at very low sequencing depth levels, as discussed</p>
    <p> in this manuscript, and it would be of high value to compare the accuracy and sensitivity of the new ngsPool approach and the "old" once, like bcftools</p>
    <p> and GATK.</p>
    <p> Real Arabidopsis data comparing ngsPool to VarScan. As previously mentioned, why not compare also to GATK, FreeBayes, and bcftools? VarScan to my knowledge is not one of the top tools in terms of variant detection.</p>
    <p> To give this manuscript more relevance and make the decision to use it or not more accessible for the reader, I would encourage the authors to provide the information if this new package performs more precisely than common tools, if not, or under which circumstances it does. If the accuracy is not improved, what are the other benefits? Time-saving, user-friendly output.</p>
    <p> Figure caption of Figure 1: the order in the graphics is not the same as the one in the description. That can be changed easily and helps the reader.</p>
    <p>Are the conclusions about the tool and its performance adequately supported by the findings presented in the article?</p>
    <p>Yes</p>
    <p>Is the rationale for developing the new software tool clearly explained?</p>
    <p>Yes</p>
    <p>Is the description of the software tool technically sound?</p>
    <p>Partly</p>
    <p>Are sufficient details of the code, methods and analysis (if applicable) provided to allow replication of the software development and its use by others?</p>
    <p>Partly</p>
    <p>Is sufficient information provided to allow interpretation of the expected output datasets and any results generated using the tool?</p>
    <p>Partly</p>
    <p>Reviewer Expertise:</p>
    <p>Population and quantitative genetics of crops, Plant breeding, cereals</p>
    <p>We confirm that we have read this submission and believe that we have an appropriate level of expertise to confirm that it is of an acceptable scientific standard, however we have significant reservations, as outlined above.</p>
  </body>
</sub-article>
<sub-article article-type="reviewer-report" id="report202073">
  <front-stub>
    <article-id pub-id-type="doi">10.5256/f1000research.150492.r202073</article-id>
    <title-group>
      <article-title>Reviewer response for version 3</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Oskolkov</surname>
          <given-names>Nikolay</given-names>
        </name>
        <xref rid="r202073a1" ref-type="aff">1</xref>
        <role>Referee</role>
        <contrib-id contrib-id-type="orcid">https://orcid.org/0000-0001-5326-8893</contrib-id>
      </contrib>
      <aff id="r202073a1"><label>1</label>Department of Biology, National Bioinformatics Infrastructure Sweden, Science for Life Laboratory, Lund University, Lund, Sweden</aff>
    </contrib-group>
    <author-notes>
      <fn fn-type="COI-statement">
        <p><bold>Competing interests: </bold>No competing interests were disclosed.</p>
      </fn>
    </author-notes>
    <pub-date pub-type="epub">
      <day>21</day>
      <month>9</month>
      <year>2023</year>
    </pub-date>
    <permissions>
      <copyright-statement>Copyright: © 2023 Oskolkov N</copyright-statement>
      <copyright-year>2023</copyright-year>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p>This is an open access peer review report distributed under the terms of the Creative Commons Attribution Licence, which permits unrestricted use, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <related-article related-article-type="peer-reviewed-article" ext-link-type="doi" id="relatedArticleReport202073" xlink:href="10.12688/f1000research.104368.3">Version 3</related-article>
    <custom-meta-group>
      <custom-meta>
        <meta-name>recommendation</meta-name>
        <meta-value>approve-with-reservations</meta-value>
      </custom-meta>
    </custom-meta-group>
  </front-stub>
  <body>
    <p>The authors suggest a population genomics tool written in Julia programming language. They demonstrate the performance of the tool on simulated and real pooled sequencing data. The manuscript is well written and technical details of the tool are well explained. In addition, documentation is provided together with the tool.</p>
    <p> I believe, it is potentially interesting to approach some bioinformatics analyses (such as population genomics) with Julia. However, I am still missing a clear motivation for re-writing e.g. genotype likelihoods and SFS computation in Julia. There are many popgen tools that are fast and accurate enough, e.g. ANGSD, so there should be a clear advantage of ngsJulia in some way compared to other tools. If the motivation is the outstanding speed or accuracy of ngsJulia, it should be clearly demonstrated. So my main concern is the lack of comparison of ngsJulia with other popgen tools.</p>
    <p> Next, I would not advertise ngsJulia as a “
<italic toggle="yes">population genetic analysis of next-generation sequencing data</italic>”, as from the text I got an impression that this was a quite pool-seq-specific tool. If ngsJulia is more general than a pool-seq data tool, it should be demonstrated and compared with other tools. Otherwise, I would suggest to change the title of the manuscript and make it less general and more specific. For example, accounting for polyploidy is a strength of ngsJulia, perhaps this should be emphasized more in the manuscript.</p>
    <p> I found it interesting and novel to determine the optimal K in the 1/f^K approximation of SFS profile with Kullback-Leibler optimization. However, as it seems to me from the Figure 5, this implementation in ngsJulia only works for D ~ 5 and large sample sizes. Perhaps other tools will not do a great job either, but as I mentioned above, I am missing the comparison with other tools.</p>
    <p> Minor comment:</p>
    <p> Page 7 I would encourage the authors to make the command line for ngsPool.jl more self-explanatory. More specifically, the “
<italic toggle="yes">–lrtSnp 6.64</italic>” flag is hard to grasp. Perhaps re-writing it in a way so that it becomes clear that 6.64 corresponds to p-value = 0.01, and replacing the flag “–lrtSnp 6.64” with “--pvalue 0.01” would be possible?</p>
    <p>Are the conclusions about the tool and its performance adequately supported by the findings presented in the article?</p>
    <p>Partly</p>
    <p>Is the rationale for developing the new software tool clearly explained?</p>
    <p>Partly</p>
    <p>Is the description of the software tool technically sound?</p>
    <p>Yes</p>
    <p>Are sufficient details of the code, methods and analysis (if applicable) provided to allow replication of the software development and its use by others?</p>
    <p>Yes</p>
    <p>Is sufficient information provided to allow interpretation of the expected output datasets and any results generated using the tool?</p>
    <p>Yes</p>
    <p>Reviewer Expertise:</p>
    <p>bioinformatics, genomics, medical genetics, ancient DNA</p>
    <p>I confirm that I have read this submission and believe that I have an appropriate level of expertise to confirm that it is of an acceptable scientific standard, however I have significant reservations, as outlined above.</p>
  </body>
</sub-article>
<sub-article article-type="reviewer-report" id="report187509">
  <front-stub>
    <article-id pub-id-type="doi">10.5256/f1000research.150492.r187509</article-id>
    <title-group>
      <article-title>Reviewer response for version 3</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>De Mita</surname>
          <given-names>Stéphane</given-names>
        </name>
        <xref rid="r187509a1" ref-type="aff">1</xref>
        <role>Referee</role>
        <contrib-id contrib-id-type="orcid">https://orcid.org/0000-0003-2752-865X</contrib-id>
      </contrib>
      <aff id="r187509a1"><label>1</label>Institut national de la recherche agronomique (INRAE), Paris, France</aff>
    </contrib-group>
    <author-notes>
      <fn fn-type="COI-statement">
        <p><bold>Competing interests: </bold>No competing interests were disclosed.</p>
      </fn>
    </author-notes>
    <pub-date pub-type="epub">
      <day>14</day>
      <month>8</month>
      <year>2023</year>
    </pub-date>
    <permissions>
      <copyright-statement>Copyright: © 2023 De Mita S</copyright-statement>
      <copyright-year>2023</copyright-year>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p>This is an open access peer review report distributed under the terms of the Creative Commons Attribution Licence, which permits unrestricted use, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <related-article related-article-type="peer-reviewed-article" ext-link-type="doi" id="relatedArticleReport187509" xlink:href="10.12688/f1000research.104368.3">Version 3</related-article>
    <custom-meta-group>
      <custom-meta>
        <meta-name>recommendation</meta-name>
        <meta-value>approve</meta-value>
      </custom-meta>
    </custom-meta-group>
  </front-stub>
  <body>
    <p>After considering the updated version and using the new documentation, I managed to run some tests successfully. However, I couldn't understand the return value of calcGenoLike without extrapolating from what it done in the triploid case in the tutorial.</p>
    <p>Are the conclusions about the tool and its performance adequately supported by the findings presented in the article?</p>
    <p>Yes</p>
    <p>Is the rationale for developing the new software tool clearly explained?</p>
    <p>Yes</p>
    <p>Is the description of the software tool technically sound?</p>
    <p>Yes</p>
    <p>Are sufficient details of the code, methods and analysis (if applicable) provided to allow replication of the software development and its use by others?</p>
    <p>Partly</p>
    <p>Is sufficient information provided to allow interpretation of the expected output datasets and any results generated using the tool?</p>
    <p>Partly</p>
    <p>Reviewer Expertise:</p>
    <p>Population genomics, phytopathology, programming (Python, C, C++).</p>
    <p>I confirm that I have read this submission and believe that I have an appropriate level of expertise to confirm that it is of an acceptable scientific standard.</p>
  </body>
</sub-article>
<sub-article article-type="reviewer-report" id="report160519">
  <front-stub>
    <article-id pub-id-type="doi">10.5256/f1000research.141471.r160519</article-id>
    <title-group>
      <article-title>Reviewer response for version 2</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>De Mita</surname>
          <given-names>Stéphane</given-names>
        </name>
        <xref rid="r160519a1" ref-type="aff">1</xref>
        <role>Referee</role>
        <contrib-id contrib-id-type="orcid">https://orcid.org/0000-0003-2752-865X</contrib-id>
      </contrib>
      <aff id="r160519a1"><label>1</label>Institut national de la recherche agronomique (INRAE), Paris, France</aff>
    </contrib-group>
    <author-notes>
      <fn fn-type="COI-statement">
        <p><bold>Competing interests: </bold>No competing interests were disclosed.</p>
      </fn>
    </author-notes>
    <pub-date pub-type="epub">
      <day>21</day>
      <month>2</month>
      <year>2023</year>
    </pub-date>
    <permissions>
      <copyright-statement>Copyright: © 2023 De Mita S</copyright-statement>
      <copyright-year>2023</copyright-year>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p>This is an open access peer review report distributed under the terms of the Creative Commons Attribution Licence, which permits unrestricted use, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <related-article related-article-type="peer-reviewed-article" ext-link-type="doi" id="relatedArticleReport160519" xlink:href="10.12688/f1000research.104368.2">Version 2</related-article>
    <custom-meta-group>
      <custom-meta>
        <meta-name>recommendation</meta-name>
        <meta-value>approve-with-reservations</meta-value>
      </custom-meta>
    </custom-meta-group>
  </front-stub>
  <body>
    <p>The article "ngsJulia: population genetic analysis of next-generation DNA sequencing data with Julia language" by Alex Mas-Sandoval and colleagues provides a library for the Julia addressing management of NGS data (provided in the PileUp format), SNP and genotype calling allowing for arbritary and dataset-varying ploidy, and maximum-likelihood parameter estimation.</p>
    <p> I've really discovered the Julia language while reviewing this article and I agree that it makes sense to use this language for developing tools for the analysis of NGS data. Providing a toolkit to perfom SNP and genotype calling under a probabilistic models makes much sense and can be useful for the community. The ngsPool application provided can be of widespread use while ngsPloidy can be a very precious tool for specific systems which lack proper software right now.</p>
    <p> Here is a list of random typos or detail-level suggestions:
<list list-type="bullet"><list-item><p>"polidy" in the "Revision" box.</p></list-item><list-item><p>Methods: you should add Combinatorics as a requirement.</p></list-item><list-item><p>I am not sure to understand the header "Operation".</p></list-item><list-item><p>One or two sentences, presenting biological systems where the study of multiploidy (or in general MLE of ploidy) is relevant, would help.</p></list-item><list-item><p>I am not sure giving an example of a R command line for simulating data is a good choice. For a Julia package I'd like to see some Julia code example, although it is not absolutely necessary.</p></list-item><list-item><p>Discussion: rewrite: "is highly applicable in educational contexts"</p></list-item></list> I do not get this sentence at all: "
<italic toggle="yes">[ngsJulia] allows for efficient testing of experimental designs and, therefore, would be beneficial for initial planning of any sequencing experiments.</italic>"</p>
    <p> My big issue with the paper, which is confirmed by a first look at the package, is that the content of the ngsJulia library isn't described, even succinctly. There should be an API and the article should point to it.</p>
    <p> In my view there is still need for more documentation. Tutorials are great and (speaking by experience) they are often essential, but at some point you need for some more rigourous reference documentation (API for the library, CLI for the applications). The Application Programmer Interface should be documented so that the reading planning to write a script using the library can know what functions are available, what input they expect, and if possible what errors can be expected. This remark also applies to the Command Line Interface of the two applications ngsPloidy and ngsPool. The help page produces an option summary, which is fine, but the meaning of the options isn't documented.</p>
    <p> Below I report the results of my testing of the three components of the software.</p>
    <p> *** ngsPloidy ***</p>
    <p> The tutorial is a good resource to start, but some points need clarification, and a more rigourous reference manual of the command-line interface would help a lot.</p>
    <p> I am not sure that it is a good idea to start by defining environment variables, which make the commands much less friendly. At least, do mention that you are defining environment variables so that unaware users can know where to look at if they need more information. Anyway the julia command should be available is it is installed in the environment which should be considered to be the default. By the way, "Julia language" is a poor choice of words.</p>
    <p> I am sorry, but I didn't get at all what "genotype probabilities" where and whether and why would I need to to create them. I have no idea what writePars is doing and -p and -s arguments aren't clearly documented.</p>
    <p> There is a "variabile" (instead of "variable") in the in simulMpileup.R manual. The simulation script needs its own documentation.</p>
    <p> Personally, I would think that either bam files containing aligned reads, or VCF, would be a better choice than PileUp, because users are more likely to already have those.</p>
    <p> Suggestions: you could print progress information while running, and displays error messages in stdout instead of stderr (especially useful since you advice users to redirect results which are printed in stdout.</p>
    <p> I tested ngsPloidy using data from my own read simulator. I thought it was a good idea to bring data from an independent source, and also I am more comfortable using it. It generated data from diploid and tetraploid organisms, using a coalescent model to draw allelic frequencies.</p>
    <p> Then I ran this type of commands:</p>
    <p> $ julia ../ngsJulia/ngsPloidy/ngsPloidy.jl --fin diplo.plp.gz --nSamples 20 &gt; diplo.out</p>
    <p> Running times were (tens of minutes up to an hour for rather small simulated datasets). I suspect that I should have dropped non-varying sites from the PileUp (since I didn't incorporate errors, 90% of my sites are completely fixed).</p>
    <p> When I simulated only diploid or tetraploid individuals, they are completely inferred (although in some parameter settings I had tetraploid individuals estimated as a mixture of tetra- and pentaploid individuals). When I merge diploid and tetraploid individuals in a single PileUp, the software tended to estimate a mixture of diploid and triploid individuals. So I suspect that I am doing something wrong. Most likely I miss an important step of the procedure and the documentation might be to blame.</p>
    <p> *** ngsPool ***</p>
    <p> Among the command line arguments, by "LRT", do you mean "threshold"?</p>
    <p> I got an exception when the pileup file didn't contain reference bases. I understand that this should be an error but it could be displayed in a more accessible manner.</p>
    <p> Some test results are reported as "Inf" or "-Inf" which is also not necessarily clear.</p>
    <p> I was not totally clear when --lrt* arguments should be used.</p>
    <p> I got a problem to understand the difference between maf, saf_MLE and saf_E? It is also a problem with the article, where the logic is mentioned by not really explained.</p>
    <p> I ran a simulation with a 20,000 bp genome, 20 diploid individuals, 10% of sites with diallelic polymorphism, 10,000 reads of 50 bp (so an average depth of 25X).</p>
    <p> I ran:</p>
    <p> # julia ../ngsJulia/ngsPool/ngsPool.jl --fin data.plp.gz \</p>
    <p>             --fout results.txt.gz  --lrtSnp 6.64 </p>
    <p> It took ~ 4:30 minutes and the results are fitting the simulation parameters. All sites called as SNPs are correct and only occasionnaly a few number (~1/1000) of "real" SNPs aren't called, and whose are always singletons. There is also a good agreement between the 'real' and estimated maf.</p>
    <p> Using the --nChroms option gives similar results and all estimated frequencies are correct.</p>
    <p> *** ngsJulia ***</p>
    <p> An API reference  was badly needed. I tried to start writing a Julia script analysing one of the datasets used for previous testing and didn't get very far. My lack of knowledge of Julia didn't help, for sure.</p>
    <p> The last paragraph of the readme "In general, ngsJulia provides templates..." should come first.</p>
    <p> Is it normal that we need to import Combinatorics even if we are not directly using it (i.e. I reckon that ngsJulia should import it itself).</p>
    <p> Almost instantly, I have the following line crashing:</p>
    <p>   nucleoLikes = [calcGenoLike(myReads, [i], 1) for i=1:4]</p>
    <p> The error message is: ERROR: LoadError: BoundsError: attempt to access SubString{String}</p>
    <p>   at index [2]</p>
    <p> I thought it was because I was trying to pass a site (represented by a Reads object, I assume), containing a single read base. But in the end it is not this (sites with more bases are not accepted either). Obviously I am making a very basic error but the lack of documentation doesn't help me.</p>
    <p>Are the conclusions about the tool and its performance adequately supported by the findings presented in the article?</p>
    <p>Yes</p>
    <p>Is the rationale for developing the new software tool clearly explained?</p>
    <p>Yes</p>
    <p>Is the description of the software tool technically sound?</p>
    <p>Yes</p>
    <p>Are sufficient details of the code, methods and analysis (if applicable) provided to allow replication of the software development and its use by others?</p>
    <p>Partly</p>
    <p>Is sufficient information provided to allow interpretation of the expected output datasets and any results generated using the tool?</p>
    <p>Partly</p>
    <p>Reviewer Expertise:</p>
    <p>Population genomics, phytopathology, programming (Python, C, C++).</p>
    <p>I confirm that I have read this submission and believe that I have an appropriate level of expertise to confirm that it is of an acceptable scientific standard, however I have significant reservations, as outlined above.</p>
  </body>
</sub-article>
<sub-article article-type="reviewer-report" id="report128232">
  <front-stub>
    <article-id pub-id-type="doi">10.5256/f1000research.114499.r128232</article-id>
    <title-group>
      <article-title>Reviewer response for version 1</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Clark</surname>
          <given-names>Lindsay V.</given-names>
        </name>
        <xref rid="r128232a1" ref-type="aff">1</xref>
        <role>Referee</role>
        <contrib-id contrib-id-type="orcid">https://orcid.org/0000-0002-3881-9252</contrib-id>
      </contrib>
      <aff id="r128232a1"><label>1</label>Roy J. Carver Biotechnology Center, University of Illinois at Urbana-Champaign, Urbana, IL, USA</aff>
    </contrib-group>
    <author-notes>
      <fn fn-type="COI-statement">
        <p><bold>Competing interests: </bold>No competing interests were disclosed.</p>
      </fn>
    </author-notes>
    <pub-date pub-type="epub">
      <day>13</day>
      <month>4</month>
      <year>2022</year>
    </pub-date>
    <permissions>
      <copyright-statement>Copyright: © 2022 Clark LV</copyright-statement>
      <copyright-year>2022</copyright-year>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p>This is an open access peer review report distributed under the terms of the Creative Commons Attribution Licence, which permits unrestricted use, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <related-article related-article-type="peer-reviewed-article" ext-link-type="doi" id="relatedArticleReport128232" xlink:href="10.12688/f1000research.104368.1">Version 1</related-article>
    <custom-meta-group>
      <custom-meta>
        <meta-name>recommendation</meta-name>
        <meta-value>approve-with-reservations</meta-value>
      </custom-meta>
    </custom-meta-group>
  </front-stub>
  <body>
    <p>The manuscript by Mas-Sandoval et al. describes ngsJulia, a collection of functions and scripts in Julia and R for estimating genotype likelihoods from short read DNA sequencing data, as well as estimating allele frequencies in pooled samples, and estimating ploidy where it is unknown. It seems that the goal is also to enable biologists proficient in Julia to develop their own custom genotype calling and population genetic analysis scripts starting with the provided functions for estimating genotype likelihoods. As it is, the manuscript and software suffer from two major flaws: (1) the software and its outputs are not well documented for users or developers, and (2) testing is only performed on simulated data, not empirical data.</p>
    <p> The software documentation is not very approachable as it currently is. End-to-end tutorials with a real dataset (or something closely resembling a real dataset) are needed for all applications. How are the output files formatted and how might the user further process those files to address biological questions? For example, it seems that one could use ngsJulia to generate a matrix of genotype calls across samples and loci, starting from a set of mpileup files, but from the documentation I have no idea how to accomplish this task.</p>
    <p> There are eleven different functions for estimating genotype log likelihoods, depending on ploidy, with four different functions for haploids. This strikes me as poor software design. At minimum the eight calcGenoLogLikeX_MajorMinor functions could be collapsed into one, with ploidy as an added argument to the function. Having a single function would make it much easier to update the code and ensure that there aren’t any bugs that prevent it from working consistently across ploidy levels. The hard-coding of tuples for every possible genotype, and the repetitive if-else statements, could be replaced with a more programmatic approach. The programmatic approach with ploidy as a function argument would also enable the software to be used for organisms with ploidy greater than octoploid.</p>
    <p> If I understand correctly, the SNP calling algorithm only seems to work on haploid samples, which would exclude it from being used in most studies. Please clarify.</p>
    <p> The estimation of ploidy from sequencing data using the ngsPloidy is a valuable addition. As an author of other software for marker analysis in polyploids, I frequently hear requests for such functionality, so I expect ngsPloidy to get a lot of use. It would be helpful to include a comparison to other tools such as ploidyNGS, ConPADE, and/or SuperMASSA. Additionally, the algorithm is only tested on a simulated dataset, and I would like to see it tested on an empirical dataset (with flow cytometry used as ground truth), both to see how well it scales up to thousands of markers, and how well it deals with potentially messy data.</p>
    <p> The authors use the term “aneuploidy” incorrectly. Aneuploidy refers to different chromosomes having different copy numbers within one individual. The authors seem to mean different individuals within a population having different ploidies. “Multiploid” is one term for this although depending on the field it is sometimes used as a synonym for “polyploid”.</p>
    <p> How should the user estimate the shape of the site frequency spectrum and the effective population size, which are required inputs for ngsPloidy?</p>
    <p> I tried “Case A” in the ngsPloidy tutorial. It took me a few minutes to figure out the (undocumented) contents of test.A.txt. I assume that columns 6-25 are the true genotypes, column 5 is the allele frequency, and column 26 is the sample allele frequency. The tutorial otherwise worked. However, I didn’t get anything useful when I added the --callGeno flag.</p>
    <p> Similarly to ngsPloidy, ngsPool is only tested on simulated data.</p>
    <p> Minor comments:
<list list-type="bullet"><list-item><p>There seems to be a missing right bracket on the left side of equation 2.</p></list-item><list-item><p>The Figure 2 caption needs to more explicitly define the abbreviations MLE and SAF.</p></list-item><list-item><p>All of the code to reproduce the analysis in the paper is provided, although there is no documentation explaining the code or indicating which scripts go with which figures.</p></list-item></list>
</p>
    <p>Are the conclusions about the tool and its performance adequately supported by the findings presented in the article?</p>
    <p>Partly</p>
    <p>Is the rationale for developing the new software tool clearly explained?</p>
    <p>Partly</p>
    <p>Is the description of the software tool technically sound?</p>
    <p>Partly</p>
    <p>Are sufficient details of the code, methods and analysis (if applicable) provided to allow replication of the software development and its use by others?</p>
    <p>Partly</p>
    <p>Is sufficient information provided to allow interpretation of the expected output datasets and any results generated using the tool?</p>
    <p>Partly</p>
    <p>Reviewer Expertise:</p>
    <p>Bioinformatics, polyploidy, population genetics</p>
    <p>I confirm that I have read this submission and believe that I have an appropriate level of expertise to confirm that it is of an acceptable scientific standard, however I have significant reservations, as outlined above.</p>
  </body>
  <sub-article article-type="response" id="comment9050-128232">
    <front-stub>
      <contrib-group>
        <contrib contrib-type="author">
          <name>
            <surname>Fumagalli</surname>
            <given-names>Matteo</given-names>
          </name>
          <aff>Queen Mary, University of London, UK</aff>
        </contrib>
      </contrib-group>
      <author-notes>
        <fn fn-type="COI-statement">
          <p><bold>Competing interests: </bold>No competing interests were disclosed.</p>
        </fn>
      </author-notes>
      <pub-date pub-type="epub">
        <day>22</day>
        <month>11</month>
        <year>2022</year>
      </pub-date>
    </front-stub>
    <body>
      <p>
        <bold>The manuscript by Mas-Sandoval et al. describes ngsJulia, a collection of functions and scripts in Julia and R for estimating genotype likelihoods from short read DNA sequencing data, as well as estimating allele frequencies in pooled samples, and estimating ploidy where it is unknown. It seems that the goal is also to enable biologists proficient in Julia to develop their own custom genotype calling and population genetic analysis scripts starting with the provided functions for estimating genotype likelihoods. As it is, the manuscript and software suffer from two major flaws: (1) the software and its outputs are not well documented for users or developers, and (2) testing is only performed on simulated data, not empirical data.</bold>
      </p>
      <p> Thank you for reviewing our manuscript. We addressed all concerns by improving the applicability and documentation of our software and by applying it to empirical data.</p>
      <p>
        <bold>The software documentation is not very approachable as it currently is. End-to-end tutorials with a real dataset (or something closely resembling a real dataset) are needed for all applications. How are the output files formatted and how might the user further process those files to address biological questions? For example, it seems that one could use ngsJulia to generate a matrix of genotype calls across samples and loci, starting from a set of mpileup files, but from the documentation I have no idea how to accomplish this task.</bold>
      </p>
      <p> We improved the documentation as requested in the specific comments (see below). Examples from simulated mpileup files under various conditions are provided and now clarified. In our response, we clarified that ngsPloidy does not provide a matrix of genotype calls but rather estimates ploidy levels.</p>
      <p>
        <bold>There are eleven different functions for estimating genotype log likelihoods, depending on ploidy, with four different functions for haploids. This strikes me as poor software design. At minimum the eight calcGenoLogLikeX_MajorMinor functions could be collapsed into one, with ploidy as an added argument to the function. Having a single function would make it much easier to update the code and ensure that there aren’t any bugs that prevent it from working consistently across ploidy levels. The hard-coding of tuples for every possible genotype, and the repetitive if-else statements, could be replaced with a more programmatic approach. The programmatic approach with ploidy as a function argument would also enable the software to be used for organisms with ploidy greater than octoploid.</bold>
      </p>
      <p> We agree with this comment and we now replace all those functions into a unique one that takes ploidy as input parameter (see calcGenoLike function in file functions.jl). We also replaced all if-else statements with a more programmatic approach which makes ngsPloidy (see file ngsPloidy.jl).</p>
      <p>
        <bold>If I understand correctly, the SNP calling algorithm only seems to work on haploid samples, which would exclude it from being used in most studies. Please clarify.</bold>
      </p>
      <p> The SNP calling algorithm relies on either a likelihood ratio test with the null hypothesis being the pooled allele frequency equal to 0 (similar to Kim et al. 2011 Bioinformatics), or from setting a threshold on the estimated pooled allele frequency. Therefore, it is applicable to all ploidy levels.</p>
      <p>
        <bold>The estimation of ploidy from sequencing data using the ngsPloidy is a valuable addition. As an author of other software for marker analysis in polyploids, I frequently hear requests for such functionality, so I expect ngsPloidy to get a lot of use. It would be helpful to include a comparison to other tools such as ploidyNGS, ConPADE, and/or SuperMASSA. Additionally, the algorithm is only tested on a simulated dataset, and I would like to see it tested on an empirical dataset (with flow cytometry used as ground truth), both to see how well it scales up to thousands of markers, and how well it deals with potentially messy data.</bold>
      </p>
      <p> This manuscript (submitted as Software Tool Article) aims at proposing a new implementation rather than a new methodology. Additionally, the likelihood function to estimate ploidy levels partly mirrors the approach taken by a parallel study (
<ext-link xlink:href="https://www.biorxiv.org/content/10.1101/2021.06.29.450340v3" ext-link-type="uri">https://www.biorxiv.org/content/10.1101/2021.06.29.450340</ext-link>) where we provide extensive comparisons with competing algorithms (including ngsPloidy). Therefore, a comprehensive benchmarking of ngsPloidy against alternative software would be outside the scope of this paper.</p>
      <p> As suggested, we applied ngsPloidy to a real empirical data of isolates from an outbreak of
<italic toggle="yes">Candida auris</italic> (Rhodes et al. 2018). Whilst polyploidy could be associated with multidrug-resistant phenotypes, we inferred haploidy for all samples and contigs, in line with findings from the original study. We added a paragraph on both methods and results sections to describe this new analysis.</p>
      <p>
        <bold>The authors use the term “aneuploidy” incorrectly. Aneuploidy refers to different chromosomes having different copy numbers within one individual. The authors seem to mean different individuals within a population having different ploidies. “Multiploid” is one term for this although depending on the field it is sometimes used as a synonym for “polyploid”.</bold>
      </p>
      <p> We replaced all occurrences of “aneuploidy” in the text and documentation with “multiploidy”.</p>
      <p>
        <bold>How should the user estimate the shape of the site frequency spectrum and the effective population size, which are required inputs for ngsPloidy?</bold>
      </p>
      <p> The need to specify the shape of the site frequency spectrum and the effective population size is only required when the sample size is too low to have a meaningful estimate of the population allele frequency. Whilst these parameters are not known a prior for nonmodel species, in practice we found that, as long as values are within a reasonable range and the coverage is sufficient, there is not a significant bias associated with inaccurate settings of these parameters. In fact, they simply determine the prior probability of sampling allele frequencies and, for most species and populations, this distribution tends to have more mass at lower frequency values.</p>
      <p>
        <bold>I tried “Case A” in the ngsPloidy tutorial. It took me a few minutes to figure out the (undocumented) contents of test.A.txt. I assume that columns 6-25 are the true genotypes, column 5 is the allele frequency, and column 26 is the sample allele frequency. The tutorial otherwise worked. However, I didn’t get anything useful when I added the --callGeno flag.</bold>
      </p>
      <p> We now indicate the contents of all columns of the simulated file. The -callGeno flag does not output called genotypes but rather estimate ploidy by first assigning (calling) genotypes, and thus disabling the integrating over unknown genotypes. This is now clarified in the documentation.</p>
      <p>
        <bold>Similarly to ngsPloidy, ngsPool is only tested on simulated data.</bold>
      </p>
      <p> We now also present an application of ngsPool to empirical data. We reanalysed genomic data from
<italic toggle="yes">Arabidopsis</italic>
<italic toggle="yes"> lyrata</italic> (Fracassetti et al. 2015). In this study, authors generated data both by genotype-by-sequencing and by pooled-sequencing, with the former providing ground-truth values for genotype and allele calls. We found that estimates of minor allele frequencies using ngsPool yield a lower RMSE (root mean squared error) than estimates from Varscan across all SNPs analysed. We added a paragraph both in the methods and results sections to describe these new analyses.</p>
      <p>
        <bold>Minor comments: </bold>
      </p>
      <p>
        <bold>There seems to be a missing right bracket on the left side of equation 2.</bold>
      </p>
      <p> Fixed.</p>
      <p>
        <bold>The Figure 2 caption needs to more explicitly define the abbreviations MLE and SAF.</bold>
      </p>
      <p> We added the acronyms SAF and MLE in the caption.</p>
      <p>
        <bold>All of the code to reproduce the analysis in the paper is provided, although there is no documentation explaining the code or indicating which scripts go with which figures. </bold>
      </p>
      <p> In
<ext-link xlink:href="https://github.com/mfumagalli/ngsJulia/tree/master/paper" ext-link-type="uri">https://github.com/mfumagalli/ngsJulia/tree/master/paper</ext-link> we provide all code to replicate the analyses in the paper. As now indicated, ploidy/do.sh would replicate the simulations and estimation of ploidy variation. We now clarify that in the pool and pool/plots folder each folder/script corresponds to the specific figure in the paper.</p>
    </body>
  </sub-article>
</sub-article>
