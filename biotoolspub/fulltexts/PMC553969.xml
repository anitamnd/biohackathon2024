<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">BMC Bioinformatics</journal-id>
    <journal-title>BMC Bioinformatics</journal-title>
    <issn pub-type="epub">1471-2105</issn>
    <publisher>
      <publisher-name>BioMed Central</publisher-name>
      <publisher-loc>London</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">553969</article-id>
    <article-id pub-id-type="publisher-id">1471-2105-6-31</article-id>
    <article-id pub-id-type="pmid">15713233</article-id>
    <article-id pub-id-type="doi">10.1186/1471-2105-6-31</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Research Article</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Automated generation of heuristics for biological sequence comparison</article-title>
    </title-group>
    <contrib-group>
      <contrib id="A1" corresp="yes" contrib-type="author">
        <name>
          <surname> Slater</surname>
          <given-names>Guy St C</given-names>
        </name>
        <xref ref-type="aff" rid="I1">1</xref>
        <email>guy@ebi.ac.uk</email>
      </contrib>
      <contrib id="A2" contrib-type="author">
        <name>
          <surname>Birney</surname>
          <given-names>Ewan</given-names>
        </name>
        <xref ref-type="aff" rid="I1">1</xref>
        <email>birney@ebi.ac.uk</email>
      </contrib>
    </contrib-group>
    <aff id="I1"><label>1</label>The Ensembl Group, EMBL – European Bioinformatics Institute, Wellcome Trust Genome Campus, Hinxton, Cambridge, CB10 1SD, UK</aff>
    <pub-date pub-type="collection">
      <year>2005</year>
    </pub-date>
    <pub-date pub-type="epub">
      <day>15</day>
      <month>2</month>
      <year>2005</year>
    </pub-date>
    <volume>6</volume>
    <fpage>31</fpage>
    <lpage>31</lpage>
    <ext-link ext-link-type="uri" xlink:href="http://www.biomedcentral.com/1471-2105/6/31"/>
    <history>
      <date date-type="received">
        <day>15</day>
        <month>9</month>
        <year>2004</year>
      </date>
      <date date-type="accepted">
        <day>15</day>
        <month>2</month>
        <year>2005</year>
      </date>
    </history>
    <copyright-statement>Copyright © 2005 Slater and Birney; licensee BioMed Central Ltd.</copyright-statement>
    <license license-type="open-access" xlink:href="http://creativecommons.org/licenses/by/2.0">
      <p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/2.0"/>), which permits unrestricted use, distribution, and reproduction in any medium, provided the original work is properly cited.</p>
    </license>
    <abstract>
      <sec>
        <title>Background</title>
        <p>Exhaustive methods of sequence alignment are accurate but slow, whereas heuristic approaches run quickly, but their complexity makes them more difficult to implement. We introduce bounded sparse dynamic programming (BSDP) to allow rapid approximation to exhaustive alignment. This is used within a framework whereby the alignment algorithms are described in terms of their underlying model, to allow automated development of efficient heuristic implementations which may be applied to a general set of sequence comparison problems.</p>
      </sec>
      <sec>
        <title>Results</title>
        <p>The speed and accuracy of this approach compares favourably with existing methods. Examples of its use in the context of genome annotation are given.</p>
      </sec>
      <sec>
        <title>Conclusions</title>
        <p>This system allows rapid implementation of heuristics approximating to many complex alignment models, and has been incorporated into the freely available sequence alignment program, exonerate.</p>
      </sec>
    </abstract>
  </article-meta>
</front>
<body>
  <sec>
    <title>Background</title>
    <p>George Box [<xref ref-type="bibr" rid="B1">1</xref>] once remarked that,</p>
    <p>"All models are wrong, but some are useful."</p>
    <p>This statement bears much relevance to biological sequence alignment, where there is no guarantee that the alignment model will accurately represent the evolutionary (or other) processes which separated the two sequences. All that is certain is that exhaustive dynamic programming (DP) algorithms (such as Smith-Waterman [<xref ref-type="bibr" rid="B2">2</xref>]) will yield the optimally scoring path in terms of the given model. Heuristics for sequence comparison (such as BLAST [<xref ref-type="bibr" rid="B3">3</xref>]) generate alignments which are valid paths through the underlying alignment model, but are not guaranteed to be optimal. Alignments generated by these heuristics can be calculated much more rapidly, and often closely match alignments which would be generated by exhaustive methods. Furthermore, many problems in the context of genome analysis consist simply of alignment of gene products (cDNA or protein) back onto the gene from which they were produced, and consequently do not require very sensitive alignment. Hence the aim here is not to attempt to develop models which are correct, but to facilitate development of models which are more <italic>useful </italic>in the context of large scale analyses.</p>
    <p>Transformation between a finite state automata describing an alignment model and the recurrence relations used in DP is a powerful technique [<xref ref-type="bibr" rid="B4">4</xref>,<xref ref-type="bibr" rid="B5">5</xref>] as it allows modification of the alignment algorithm by direct manipulation of the alignment model. The Dynamite compiler [<xref ref-type="bibr" rid="B6">6</xref>] allows automated implementation of alignment algorithms from a description of the alignment model. This allows development of complex models which can be used to generate accurate alignments. However, calculation of alignments using these models always requires quadratic time, which is prohibitively slow for many large scale applications. This method can be applied to any alignment problem which can be represented by a regular grammar (or the equivalent finite state machine). This includes the simple three state model required for affine gaps in the Smith-Waterman-Gotoh algorithm [<xref ref-type="bibr" rid="B2">2</xref>,<xref ref-type="bibr" rid="B7">7</xref>], but also more complex models such as that used by EST_GENOME [<xref ref-type="bibr" rid="B8">8</xref>], where splice site prediction is integrated into the DP, allowing alignments to include introns. Other alignment models which may be expressed by a regular grammar include those allowing non-equivalenced regions such as the ABC model [<xref ref-type="bibr" rid="B9">9</xref>] for improved modelling of divergent loops regions in protein alignments, and DNA Block Aligner [<xref ref-type="bibr" rid="B10">10</xref>] which finds co-linear conserved blocks in the alignment of genomic sequences. This framework also allows models such as that used by PairWise [<xref ref-type="bibr" rid="B11">11</xref>] where the sequences are translated during alignment allowing for frameshifts, and GeneWise [<xref ref-type="bibr" rid="B12">12</xref>] which integrates translated alignments with modelling of introns for alignment of proteins against genomic DNA.</p>
    <p>The availability of vast amounts of sequence data has generated a need for faster alignment algorithms [<xref ref-type="bibr" rid="B13">13</xref>]. Many of these approaches use fast algorithms to identify closely matching words which seed un-gapped alignments that are subsequently joined to form the final gapped alignment. For example, BLAST [<xref ref-type="bibr" rid="B3">3</xref>], FASTA [<xref ref-type="bibr" rid="B14">14</xref>], and sim4 [<xref ref-type="bibr" rid="B15">15</xref>] all operate by first finding matching words before building alignments. Such word finding can be done by a multitude of techniques, such as finite state machines used in BLAST [<xref ref-type="bibr" rid="B3">3</xref>], table-lookup used in SSAHA [<xref ref-type="bibr" rid="B16">16</xref>], or by suffix arrays as used in QUASAR [<xref ref-type="bibr" rid="B17">17</xref>]. Novel methods for word-based seeding of these alignments are not presented here, but rather a general system of joining these seeds to produce gapped alignments.</p>
    <p>The alignment program FASTA [<xref ref-type="bibr" rid="B14">14</xref>], generates alignments from sets of seeds by performing DP confined to a diagonal band surrounding the initial matches [<xref ref-type="bibr" rid="B18">18</xref>]. In contrast, when building alignments, Gapped BLAST [<xref ref-type="bibr" rid="B19">19</xref>] permits gapped extension which allows the DP to be applied to an arbitrary high-scoring region surrounding the HSP seeds. Such heuristics allow very fast sequence alignment, but it is difficult to apply to more complex models. Furthermore, features such as introns cannot easily be incorporated into the resulting alignments without necessitating a large amount of DP to ensure that both very short exons and large introns can be included in alignments.</p>
    <p>The aim here is to combine the strengths of Gapped BLAST and Dynamite, in a system which allows <italic>automated generation of heuristics in terms of the underlying model. </italic>This allows the development of heuristics for complex models such as those used in GeneWise.</p>
    <p>Firstly, we describe bounded sparse dynamic programming (BSDP), a novel heuristic for sequence alignment, then we describe the system for automated implementation of the complex alignment algorithms required. We present proof of principle results, but this paper is primarily focussed on developing a framework for the general case.</p>
  </sec>
  <sec>
    <title>Implementation</title>
    <p>The basic strategy of seeding alignments used here is the same as for BLAST, in that alignments seeds are generated, and then extended to form High-scoring Segment Pairs (HSPs), which are then joined together to form the alignments. The alignments are seeded using an Aho and Corasick [<xref ref-type="bibr" rid="B20">20</xref>] type finite state machine (FSM) built using the word neighbourhood of the query sequence. This generates the seeds which are extended to form the HSPs. For large scale analyses, the FSM is multiplexed using word neighbourhoods from multiple sequences. This allows analysis of multiple queries during a single pass of a genomic database, in a manner similar to that used in MPBLAST [<xref ref-type="bibr" rid="B21">21</xref>].</p>
    <p>However the methods for seeding HSPs are independent from those used for building the alignments, and this paper only deals with algorithms involved in the generation of gapped alignments from sets of HSPs, and not in the calculation of the HSPs themselves.</p>
    <p>The following strategies are employed to enable alignments to be built efficiently from sets of HSPs:</p>
    <p>• To connect the underlying alignment model to the heuristics, a <italic>portal </italic>describes a set of states in the model which correspond to a set of HSPs, a <italic>span </italic>refers to a looping state for large alignment features such as introns, and a <italic>SAR (Sub-Alignment Region) </italic>describes a rectangular region on an HSP to which DP is applied.</p>
    <p>• To avoid DP in every SAR, <italic>upper bounds </italic>are generated for the best alignment score for each SAR, and <italic>BSDP (Bounded Sparse Dynamic Programming) </italic>exploits these bounds to yield alignments in an efficient manner.</p>
    <p>• To perform various types of DP in these SARs, the required models are generated automati cally, including C code to produce an efficient viterbi implementation for each model.</p>
    <sec>
      <title>Bounded sparse dynamic programming</title>
      <p>Dynamic programming (for any alignment model which can be represented by a regular grammar) requires quadratic time, and hence is the most computationally expensive part of building an alignment. For pairs of sequences more than a few kilobases long, DP becomes prohibitively slow. The approach used here is similar to <italic>sparse dynamic programming </italic>[<xref ref-type="bibr" rid="B22">22</xref>], and the fragment chaining approaches used in the program sim2 [<xref ref-type="bibr" rid="B23">23</xref>], in that DP is applied to rectangular regions surrounding alignment seeds. However, there are two major differences in our approach. Firstly, DP is only applied to two small discrete regions on each HSP, as it is assumed that most of the HSP itself should appear in the alignment. These <italic>sub-alignments </italic>improve the quality of the overall alignments, and they allow complex alignment models, and large gaps such as introns to be integrated into a sparse DP framework. Secondly, as it would take too long to apply DP to every sub-alignment region (SAR), upper bounds are calculated for the DP scores for each of these SARs. This allows the sub-alignment DP to be avoided in cases where it joins HSPs which cannot feature in the final alignment, so that alignments can still be generated very rapidly even when large numbers of HSPs and SARs are involved.</p>
      <p>Before the BSDP can be performed, a single point on each HSP is selected which will feature in any alignment generated using that HSP. This point corresponds to a pair of equivalenced symbols which must feature in any alignment to include that HSP. A point is chosen where half the HSP score is generated by equivalenced symbols on either side of it, as this is likely to be in the highest quality portion of the HSP. As shown in the example in Figure <xref ref-type="fig" rid="F1">1</xref>, this strategy is particularly beneficial where one end of the HSP has a much lower quality than the other.</p>
      <p>The five types of region used for sub-alignments are classified in Figure <xref ref-type="fig" rid="F2">2</xref>. Each of these require a slightly different alignment algorithm. The alignment path must meet corners of the SARs that contain an HSP, so that the sub-alignments can be integrated with the HSPs to produce the final alignment. This approach has been primarily designed for local models, but BSDP may also be used for global and semi-global models, in which case constraints are added such that both the terminal regions (cases A and E in Figure <xref ref-type="fig" rid="F2">2</xref>) and the resulting sub-alignments must contain the relevant sequence ends. In the case of C and D, the two HSPs and their SARs are separated by a span, allowing large gaps or introns in the alignment. In these cases DP must be applied to the SAR before the span, and the end state scores must be integrated in an intermediate matrix before being provided as start state scores for the DP in the SAR after the span.</p>
      <p>Regions for the sub-alignments are selected within the area between the centre points of the two HSPs to be joined, or in the case of terminal HSPs, between the HSP and the ends of the sequences. In addition, the positions of the SARs must be constrained to limit their size, and so that the HSPs correctly intersect with the corners of the SAR. In the case of overlapping HSPs, where there is a choice of positions for placement of the SAR, the position is chosen such that the highest scoring parts of the HSPs are outside the SARs.</p>
      <p>Once the SARs have been selected, an upper bound is placed on the score for each sub-alignment. The calculation of these bounds is described in a later section describing automation of this method. The BSDP approach can then utilise these upper bounds to avoid application of DP in some SARs, as demonstrated by the example in Figure <xref ref-type="fig" rid="F3">3</xref>. In the case of a real alignment, a much greater number of HSPs will be involved, so the amount of DP avoided will be larger.</p>
      <p>The BSDP is mediated through a set of priority queues, one of which is associated with each HSP, and will contain an entry for each partial alignment that ends at the HSP. The key for these priority queues is the highest score for any partial alignment ending in that HSP. Additionally, there is one global priority queue containing the highest scores from each of the other priority queues. The upper bound scores are confirmed by DP in the SARs in the current highest scoring putative alignment path. The highest scoring path will change as the scores are updated during this process. DP is applied to SARs in this way until the highest scoring path does not contain any bound scores, and then the alignment may be extracted. Upper bounds dictate that there can be no better alignment using these HSPs.</p>
      <p>This algorithm is similar to A* search, (but differs in that many different points may be the start or end of the search), and retains the <italic>admissibility </italic>property of A* search, such that the result of the BSDP computation is guaranteed to be the same as if DP had been performed on every candidate SAR prior to calculation of the alignment. This is because no alignment can be extracted until all the alternative sub-alignments (which have upper bounds that indicate they could contribute to a higher-score) have been eliminated.</p>
      <sec>
        <title>Suboptimal alignments</title>
        <p>The BSDP alignment process can be iterated to generate sub-optimal alignments similar to those generated by the Waterman-Eggert algorithm [<xref ref-type="bibr" rid="B24">24</xref>], with only minimal recalculation of the partial alignments in the SARs. Each HSP may only appear in a single alignment, but further constraints are required to prevent overlapping alignments arising from overlapping SARs. The likelihood of this is occurring is greatly increased during translated alignments when HSPs in different reading frames may overlap each other.</p>
        <p>After the first alignment has been reported, the scores for any SARs which have already been confirmed by DP, but which are not yet included in a reported alignment, are then considered as an upper bound. SARs are disallowed before recalculation when the region between the centre of the HSP and its SARs overlaps with a previously reported HSP, in which case, the SARs are disallowed. Otherwise the DP is recomputed for SARs which contain part of an alignment which has been reported since the DP for the SAR was last calculated.</p>
      </sec>
    </sec>
    <sec>
      <title>Automated model generation</title>
      <p>As illustrated in the previous section, BSDP becomes quite complex and requires a large number of DP algorithms for computation of the alignment through the SARs. We have build a system to facilitate implementation of these models and the integration of the sub-alignments which they produce. To allow generalisation of the BSDP, everything must be defined in terms of the underlying alignment models. The alignment models are described as finite state machines, consisting of states and transitions, similar to those used in Dynamite [<xref ref-type="bibr" rid="B6">6</xref>].</p>
      <p>Briefly, to convert these models into DP implementations, each state must correspond to a score in each cell of the DP matrix, and the scores for each cell are calculated by taking the maximum of the score from transitions arriving at each cell. In addition, a topological sort is required to satisfy dependency ordering for silent states.</p>
      <p>However, in addition to automated generation of code from alignment models, the generation of the models required for DP in the SARs is also automated, as described below.</p>
      <sec>
        <title>Building simple models</title>
        <p>Table <xref ref-type="table" rid="T1">1</xref> shows a few example alignment models which are generated by this system. The models are built in a modular fashion, allowing reuse of common components such as intron models and gap models. These models may be used for exhaustive alignment in quadratic time, but in order to use them for heuristic alignment, manipulations of the models are necessary to perform DP in the SARs, as detailed in the following sections.</p>
      </sec>
      <sec>
        <title>Building the heuristic model</title>
        <p>To enable DP in the SARs for the BSDP, a heuristic model is generated from the original alignment model. This model is not used directly for calculation of alignments, but a derived model is generated corresponding to each transition in the heuristic model. Each of these derived models correspond to a type of SAR used in the BSDP.</p>
        <p>The model is first annotated, labelling certain states as either <italic>portal states </italic>or <italic>span states. </italic>A <italic>portal </italic>defines a group of states which can share a set of HSPs (High-scoring Segment Pairs); these are the match states. A <italic>span </italic>is a state which has sequence independent looping transitions (<italic>e.g. </italic>states for introns, or non-equivalenced regions).</p>
        <p>The heuristic model is build using states corresponding to each portal and span state, with transitions between these states in cases where there is a valid path between the corresponding states in the original model. An example model is shown in Figure <xref ref-type="fig" rid="F4">4</xref> for alignment of ESTs to genomic DNA. In this example, there is a <italic>portal </italic>which corresponds to the <italic>match forward </italic>and <italic>match reverse </italic>states, and the <italic>intron forward </italic>and <italic>intron reverse </italic>states are <italic>span </italic>states.</p>
      </sec>
      <sec>
        <title>Building derived models</title>
        <p>Derived models are produced for the DP in SARs automatically from each transition in the heuristic model. The source and destination states from each transition in the heuristic model become the start and end states in each derived model. All reachable states and transitions from these states in the original model are recursively copied to the derived model. An example of this process is shown in Figure <xref ref-type="fig" rid="F5">5</xref>. The relationships between the states and transitions in the derived model and the original model are tracked to allow conversion of the partial alignments from the derived models back to complete alignment in the original model. Terminal models (case A and E in Figure <xref ref-type="fig" rid="F2">2</xref>) are generated between portal states and a start or end state. Join models (case B in Figure <xref ref-type="fig" rid="F2">2</xref>) are generated between portal states, including from a portal state to itself. Span models (case C and D in Figure <xref ref-type="fig" rid="F2">2</xref>) are generated from a portal state to a span state, and vice versa. These allow incorporation of a large feature such as an intron into an alignment. The span models require a special end state in the model at the start of the span, and a special start start in the model at the end of a span, so that scores can be transferred from one DP matrix to the other via an intermediary score matrix.</p>
        <p>For some cases, such as between the <italic>match forward </italic>and <italic>match reverse </italic>states, shown in Figure <xref ref-type="fig" rid="F4">4</xref>, there is no possible path, and no corresponding transition in the heuristic model, in which case, a derived model is not produced.</p>
        <p>Ten different derived models are generated from the model shown for cDNA to genomic alignment in Figure <xref ref-type="fig" rid="F4">4</xref>, because there are two <italic>portal </italic>states and two <italic>span </italic>states in this model, and therefore, a derived model is generated for each of the five cases in Figure <xref ref-type="fig" rid="F2">2</xref> for both the forward and reversed genes.</p>
      </sec>
      <sec>
        <title>Building models for calculation of upper bounds</title>
        <p>For each derived model, an additional model is created which is used for the pre-calculation of upper bounds for all possible sizes of SARs. For each transition in the model which has a position dependent score associated with it, the upper bound is also supplied. For example, in a match transition, the upper bound is the maximum value from the substitution matrix. A special model is created using these transition upper bounds, instead of the normal sequence-dependent transition weights. As this removes the sequence-dependent components of the algorithm, it allows pre-calculation of the upper bound for alignment score of any sequences up to the maximum permitted size of SARs. These bounds are then stored in a table for retrieval during the BSDP.</p>
      </sec>
    </sec>
  </sec>
  <sec>
    <title>Results</title>
    <p>The model used in Figure <xref ref-type="fig" rid="F4">4</xref> was used with this system in the program exonerate for rapid comparison of cDNAs and genomic DNA. This model was used to compare a test set of genomic sequences to mRNAs extracted according to the Ensembl annotations. exonerate was compared to sim4 [<xref ref-type="bibr" rid="B15">15</xref>], another heuristic for comparing cDNAs to genomic DNA, and EST_GENOME [<xref ref-type="bibr" rid="B8">8</xref>], which is implements the exhaustive DP for essentially the same underlying model. As can be seen from the results of this comparison are shown in Table <xref ref-type="table" rid="T2">2</xref>, similar results are produced by this method, but in much less time.</p>
    <p>This system is used for alignment of ESTs within the Ensembl gene-building pipeline [<xref ref-type="bibr" rid="B25">25</xref>], and a prototype implementation of this system has been used in comparison mouse and human sequences [<xref ref-type="bibr" rid="B26">26</xref>]. In this analysis, 13 million raw shotgun mouse reads were aligned as part of the comparative analysis of chromosome 20.</p>
    <p>Figure <xref ref-type="fig" rid="F6">6</xref> shows an example the SARs generated by BSDP. Only a small proportion of these SARs will require confirmation by DP. This approach scales well – in a larger example using Titin, 27346 candidate SARs are generated, of which only 236 are confirmed and 206 appear in the final alignment. In many cases, BSDP obviates the use of DP altogether as there will be no candidate alignment with a total upper bound score over the threshold. This is especially likely to be true in cases when a high score threshold is used, such as searching for an alignment covering a certain percentage of the query, or when a dynamic score threshold is used in the search for the best few hits from a particular query to a database. Such dynamic thresholds can actually cause the search to speed up as it progresses, once good matches to the query have been found.</p>
    <p>Another example is the alignment of the Collagen alpha 1(IX) precursor to a region of chromosome 6 containing the corresponding gene. This is a large gene, containing 38 exons over about a 90 Kb region of the genome. Using GeneWise, the alignnment required 4260 seconds (about 1 hour, 11 minutes) using exonerate to perform full DP alignment required 2700 seconds (about 45 minutes), and using exonerate with the heuristic BSDP approach required only 7 seconds, with all three methods generating identical alignments.</p>
  </sec>
  <sec>
    <title>Conclusion</title>
    <p>This approach represents an advance from previous methods for automatic implementation of sequence alignment algorithms [<xref ref-type="bibr" rid="B4">4</xref>-<xref ref-type="bibr" rid="B6">6</xref>], in that it is not just the generation of code from the models which is automated, but also the generation of many of the models themselves.</p>
    <p>This has allowed development of heuristics with sub-quadratic running times. This makes their application practical to a much larger set of problems, while retaining the much of the simplicity of their implementation.</p>
    <p>We recognise that this approach is limited to the subset of sequence comparison problems which can be represented by a regular grammar. For example, it is not possible to use this system to model stochastic context free grammars as used in some types of RNA secondary structure such as pseudo-knots [<xref ref-type="bibr" rid="B27">27</xref>]. This approach is also unsuitable for the types of DP algorithms used for determining optimal segmentation in gene finding algorithms [<xref ref-type="bibr" rid="B28">28</xref>], however for these types of problems running time of the algorithm is not an issue.</p>
    <p>This framework has already been used for many different alignment models ranging from simple models such as Smith-Waterman-Gotoh, to more complex models such as those for protein to genome alignment as used by GeneWise [<xref ref-type="bibr" rid="B12">12</xref>]. It is also well suited to problems requiring comparison of very long sequences, and we are currently extending this system to accommodate syntenic pairwise comparisons of genomic sequences of the type tackled by MUMmer [<xref ref-type="bibr" rid="B29">29</xref>].</p>
    <p>Although this method is useful in many cases, for some types of distantly related sequences, the method can breakdown. For example, when long regions of the correct alignment contain many gaps with intervening sequences too short to be an alignment seed, the alignment cannot be extended beyond the boundary of the SAR, and the correct alignment may be missed. These cases can be avoided by increasing the size of the SARs, but this results in higher bound scores, so DP become necessary in more of the SARs. Such gap rich alignment are the type where the gapped HSP extension used by Gapped BLAST excels, however such gapped extension necessitates DP surrounding all HSPs, which becomes time consuming when allowing both short exons and long introns during alignments of cDNAs or proteins to genomic sequences.</p>
    <p>As this system separates the development of the underlying alignment model from the heuristics which are built on top of them, we expect that this framework will prove useful for evaluation of the quality of the heuristics, as comparison between the alignments from the two techniques can be automated, and training may be performed to select optimal parameter sets.</p>
  </sec>
  <sec>
    <title>Availability</title>
    <p>The implementation of the system described here is called C4 (to reflect the aim of producing something more powerful than Dynamite [<xref ref-type="bibr" rid="B6">6</xref>]), and is implemented in C programming language. It is available as part of the exonerate sequence alignment package available from <ext-link ext-link-type="uri" xlink:href="http://www.ebi.ac.uk/~guy/exonerate/"/>, and in the exonerate module of the Ensembl CVS repository from <ext-link ext-link-type="uri" xlink:href="http://www.ensembl.org/"/>. It is built using the glib portabilility library available from <ext-link ext-link-type="uri" xlink:href="http://www.gtk.org/"/> Both exonerate and glib are available under the GNU lesser general public license. The code has been tested extensively on Linux and OSF1/alpha but has been written to be portable to many UNIX systems.</p>
    <p>Code generation for the DP is performed to exploit compile time optimisations such as loop un- rolling and and efficient handling of edge conditions in the viterbi matrix, which is particularly beneficial for the small DP calculations required by SARs. This generated code is typically about five times faster than using a generic viterbi implementation, but produces about a million lines of code for the current set of models used by exonerate, and hence compilation takes longer.</p>
  </sec>
</body>
<back>
  <ack>
    <sec>
      <title>Acknowledgements</title>
      <p>GSS would like to thank Ian Holmes and Roger Sayle for invaluable discussions (some several years ago), which have been a big influence on this work.</p>
      <p>Also, we would like to thank all members of the Ensembl group, in particular Steve Searle contributed some code to an early version of exonerate.</p>
    </sec>
  </ack>
  <ref-list>
    <ref id="B1">
      <citation citation-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Box</surname>
            <given-names>GE</given-names>
          </name>
        </person-group>
        <person-group person-group-type="editor">
          <name>
            <surname>Launer R, Wilkinson G</surname>
          </name>
        </person-group>
        <article-title>Robustness in the Strategy of Scientific Model Building</article-title>
        <source>Robustness in Statistics</source>
        <year>1979</year>
        <publisher-name>Academic Press New York</publisher-name>
      </citation>
    </ref>
    <ref id="B2">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Smith</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Waterman</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>Identification of Common Molecular Subsequences</article-title>
        <source>Journal of Molecular Biology</source>
        <year>1981</year>
        <volume>147</volume>
        <fpage>195</fpage>
        <lpage>197</lpage>
        <pub-id pub-id-type="pmid">7265238</pub-id>
      </citation>
    </ref>
    <ref id="B3">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Altschul</surname>
            <given-names>SF</given-names>
          </name>
          <name>
            <surname>Gish</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Miller</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Myers</surname>
            <given-names>EW</given-names>
          </name>
          <name>
            <surname>Lipman</surname>
            <given-names>DJ</given-names>
          </name>
        </person-group>
        <article-title>Basic Local Alignment Search Tool</article-title>
        <source>Journal of Molecular Biology</source>
        <year>1990</year>
        <volume>215</volume>
        <fpage>403</fpage>
        <lpage>410</lpage>
        <pub-id pub-id-type="pmid">2231712</pub-id>
      </citation>
    </ref>
    <ref id="B4">
      <citation citation-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Searls</surname>
            <given-names>DB</given-names>
          </name>
          <name>
            <surname>Murphy</surname>
            <given-names>KP</given-names>
          </name>
        </person-group>
        <article-title>Automata-Theoretic Models of Mutation and Alignment</article-title>
        <source>Proceedings of the Third International Conference On Intelligent Systems for Molecular Biology</source>
        <year>1995</year>
        <publisher-name>The AAAI Press</publisher-name>
        <fpage>341</fpage>
        <lpage>349</lpage>
      </citation>
    </ref>
    <ref id="B5">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Searls</surname>
            <given-names>DB</given-names>
          </name>
        </person-group>
        <article-title>Sequence alignment through pictures</article-title>
        <source>Trends in Genetics</source>
        <year>1996</year>
        <volume>12</volume>
        <fpage>35</fpage>
        <lpage>37</lpage>
        <pub-id pub-id-type="pmid">8741859</pub-id>
      </citation>
    </ref>
    <ref id="B6">
      <citation citation-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Birney</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Durbin</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>Dynamite: A flexible code generating language for dynamic programming methods used in sequence comparison</article-title>
        <source>Proceedings of the Fifth International Conference On Intelligent Systems for Molecular Biology</source>
        <year>1997</year>
        <publisher-name>The AAAI Press</publisher-name>
        <fpage>56</fpage>
        <lpage>64</lpage>
      </citation>
    </ref>
    <ref id="B7">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Gotoh</surname>
            <given-names>O</given-names>
          </name>
        </person-group>
        <article-title>An Improved Algorithm for Matching Biological Sequences</article-title>
        <source>Journal of Molecular Biology</source>
        <year>1982</year>
        <volume>162</volume>
        <fpage>705</fpage>
        <lpage>708</lpage>
        <pub-id pub-id-type="pmid">7166760</pub-id>
      </citation>
    </ref>
    <ref id="B8">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Mott</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>EST_GENOME: a program to align spliced DNA sequences to unspliced genomic DNA</article-title>
        <source>CABIOS</source>
        <year>1997</year>
        <volume>13</volume>
        <fpage>477</fpage>
        <lpage>478</lpage>
        <pub-id pub-id-type="pmid">9283765</pub-id>
      </citation>
    </ref>
    <ref id="B9">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Altschul</surname>
            <given-names>SF</given-names>
          </name>
        </person-group>
        <article-title>Generalized Affine Gap Costs for Protein Sequence Alignment</article-title>
        <source>PROTEINS: Structure, Function and Genetics</source>
        <year>1998</year>
        <volume>32</volume>
        <fpage>88</fpage>
        <lpage>96</lpage>
      </citation>
    </ref>
    <ref id="B10">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Jareborg</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Birney</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Durbin</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>Comparative Analysis of Noncoding Regions of 77 Orthologous Mouse and Human Gene Pairs</article-title>
        <source>Genome Research</source>
        <year>1999</year>
        <volume>9</volume>
        <fpage>815</fpage>
        <lpage>824</lpage>
        <pub-id pub-id-type="pmid">10508839</pub-id>
      </citation>
    </ref>
    <ref id="B11">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Birney</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Thompson</surname>
            <given-names>JD</given-names>
          </name>
          <name>
            <surname>Gibson</surname>
            <given-names>TJ</given-names>
          </name>
        </person-group>
        <article-title>PairWise and SearchWise: finding the optimal alignment in a simultaneous comparison of a protein profile against all DNA translation frames</article-title>
        <source>Nucleic Acids Research</source>
        <year>1996</year>
        <volume>24</volume>
        <fpage>2730</fpage>
        <lpage>2739</lpage>
        <pub-id pub-id-type="pmid">8759004</pub-id>
      </citation>
    </ref>
    <ref id="B12">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Birney</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Clamp</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Durbin</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>GeneWise and Genomewise</article-title>
        <source>Genome Research</source>
        <year>2004</year>
        <volume>14</volume>
        <fpage>988</fpage>
        <lpage>995</lpage>
        <pub-id pub-id-type="pmid">15123596</pub-id>
      </citation>
    </ref>
    <ref id="B13">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Smith</surname>
            <given-names>RF</given-names>
          </name>
        </person-group>
        <article-title>Perspectives: Sequence Data Base Searching in the Era of Large-scale Genomic Sequencing</article-title>
        <source>Genome Research</source>
        <year>1996</year>
        <volume>6</volume>
        <fpage>653</fpage>
        <lpage>660</lpage>
        <pub-id pub-id-type="pmid">8858340</pub-id>
      </citation>
    </ref>
    <ref id="B14">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lipman</surname>
            <given-names>DJ</given-names>
          </name>
          <name>
            <surname>Pearson</surname>
            <given-names>WR</given-names>
          </name>
        </person-group>
        <article-title>Rapid and Sensitive Protein Similarity Searches</article-title>
        <source>Science</source>
        <year>1985</year>
        <volume>277</volume>
        <fpage>1435</fpage>
        <lpage>1441</lpage>
        <pub-id pub-id-type="pmid">2983426</pub-id>
      </citation>
    </ref>
    <ref id="B15">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Florea</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Hartzell</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Rubin</surname>
            <given-names>GM</given-names>
          </name>
          <name>
            <surname>Miller</surname>
            <given-names>W</given-names>
          </name>
        </person-group>
        <article-title>A Computer Program for Aligning a cDNA Sequence with a Genomic DNA Sequence</article-title>
        <source>Genome Research</source>
        <year>1998</year>
        <volume>8</volume>
        <fpage>967</fpage>
        <lpage>974</lpage>
        <pub-id pub-id-type="pmid">9750195</pub-id>
      </citation>
    </ref>
    <ref id="B16">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ning</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Cox</surname>
            <given-names>AJ</given-names>
          </name>
          <name>
            <surname>Mullikin</surname>
            <given-names>JC</given-names>
          </name>
        </person-group>
        <article-title>SSAHA: A Fast Search Method for Large DNA Databases</article-title>
        <source>Genome Research</source>
        <year>2001</year>
        <volume>11</volume>
        <fpage>1725</fpage>
        <lpage>1729</lpage>
        <pub-id pub-id-type="pmid">11591649</pub-id>
      </citation>
    </ref>
    <ref id="B17">
      <citation citation-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Burkhardt</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Crauser</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Ferragina</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Lenhof</surname>
            <given-names>HP</given-names>
          </name>
          <name>
            <surname>Rivals</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Vingron</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title><italic>q</italic>-gram Based Database Searching Using a Suffix Array (QUASAR)</article-title>
        <source>Proceedings of the Third Annual International Conference on Computational Molecular Biology</source>
        <year>1999</year>
        <publisher-name>The ACM Press</publisher-name>
        <fpage>77</fpage>
        <lpage>83</lpage>
      </citation>
    </ref>
    <ref id="B18">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Chao</surname>
            <given-names>KM</given-names>
          </name>
          <name>
            <surname>Pearson</surname>
            <given-names>WR</given-names>
          </name>
          <name>
            <surname>Miller</surname>
            <given-names>W</given-names>
          </name>
        </person-group>
        <article-title>Aligning two sequences within a specified diagonal band</article-title>
        <source>CABIOS</source>
        <year>1992</year>
        <volume>8</volume>
        <fpage>481</fpage>
        <lpage>487</lpage>
        <pub-id pub-id-type="pmid">1422882</pub-id>
      </citation>
    </ref>
    <ref id="B19">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Altschul</surname>
            <given-names>SF</given-names>
          </name>
          <name>
            <surname>Madden</surname>
            <given-names>TL</given-names>
          </name>
          <name>
            <surname>Schäffer</surname>
            <given-names>AA</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Miller</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Lipman</surname>
            <given-names>DJ</given-names>
          </name>
        </person-group>
        <article-title>Gapped BLAST and PSI-BLAST: a new generation of protein database search programs</article-title>
        <source>Nucleic Acids Research</source>
        <year>1997</year>
        <volume>25</volume>
        <fpage>3389</fpage>
        <lpage>3402</lpage>
        <pub-id pub-id-type="pmid">9254694</pub-id>
      </citation>
    </ref>
    <ref id="B20">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Aho</surname>
            <given-names>AV</given-names>
          </name>
          <name>
            <surname>Corasick</surname>
            <given-names>MJ</given-names>
          </name>
        </person-group>
        <article-title>Efficient String Matching: An Aid to Bibiographic Search</article-title>
        <source>Communications of the ACM</source>
        <year>1975</year>
        <volume>18</volume>
        <fpage>333</fpage>
        <lpage>340</lpage>
      </citation>
    </ref>
    <ref id="B21">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Korf</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Gish</surname>
            <given-names>W</given-names>
          </name>
        </person-group>
        <article-title>MPBLAST: improved BLAST performance with multiplexed queries</article-title>
        <source>Bioinformatics</source>
        <year>2000</year>
        <volume>16</volume>
        <fpage>1052</fpage>
        <lpage>1053</lpage>
        <pub-id pub-id-type="pmid">11159321</pub-id>
      </citation>
    </ref>
    <ref id="B22">
      <citation citation-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Eppstein</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Galil</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Giancarlo</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Italiano</surname>
            <given-names>GF</given-names>
          </name>
        </person-group>
        <article-title>Sparse Dynamic Programming</article-title>
        <source>Proc 1st Symp Discrete Algorithms</source>
        <year>1990</year>
        <publisher-name>ACM and SIAM</publisher-name>
        <fpage>513</fpage>
        <lpage>522</lpage>
      </citation>
    </ref>
    <ref id="B23">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Chao</surname>
            <given-names>KM</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Ostell</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Miller</surname>
            <given-names>W</given-names>
          </name>
        </person-group>
        <article-title>A local alignment tool for very long DNA sequences</article-title>
        <source>CABIOS</source>
        <year>1995</year>
        <volume>11</volume>
        <fpage>147</fpage>
        <lpage>153</lpage>
        <pub-id pub-id-type="pmid">7620986</pub-id>
      </citation>
    </ref>
    <ref id="B24">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Waterman</surname>
            <given-names>MS</given-names>
          </name>
          <name>
            <surname>Eggert</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>A New Algorithm for Best Subsequence Alignments with Application to tRNA-rRNA Comparisons</article-title>
        <source>Journal of Molecular Biology</source>
        <year>1987</year>
        <volume>197</volume>
        <fpage>723</fpage>
        <lpage>728</lpage>
        <pub-id pub-id-type="pmid">2448477</pub-id>
      </citation>
    </ref>
    <ref id="B25">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Curwen</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Eyras</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Andrews</surname>
            <given-names>TD</given-names>
          </name>
          <name>
            <surname>Clarke</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Mongin</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Searle</surname>
            <given-names>SM</given-names>
          </name>
          <name>
            <surname>Clamp</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>The Ensembl Automatic Gene Annotation System</article-title>
        <source>Genome Research</source>
        <year>2004</year>
        <volume>14</volume>
        <fpage>942</fpage>
        <lpage>950</lpage>
        <pub-id pub-id-type="pmid">15123590</pub-id>
      </citation>
    </ref>
    <ref id="B26">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Deloukas</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Matthews</surname>
            <given-names>LH</given-names>
          </name>
          <name>
            <surname>Ashurst</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Burton</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Gilbert</surname>
            <given-names>JGR</given-names>
          </name>
          <name>
            <surname>Jones</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Stavrides</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Almeida</surname>
            <given-names>JP</given-names>
          </name>
          <name>
            <surname>Babbage</surname>
            <given-names>AK</given-names>
          </name>
          <name>
            <surname>Bagguley</surname>
            <given-names>CL</given-names>
          </name>
          <name>
            <surname>Bailey</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Barlow</surname>
            <given-names>KF</given-names>
          </name>
          <name>
            <surname>Bates</surname>
            <given-names>KN</given-names>
          </name>
          <name>
            <surname>Beard</surname>
            <given-names>LM</given-names>
          </name>
          <name>
            <surname>Beare</surname>
            <given-names>DM</given-names>
          </name>
          <name>
            <surname>Beasley</surname>
            <given-names>OP</given-names>
          </name>
          <name>
            <surname>Bird</surname>
            <given-names>CP</given-names>
          </name>
          <name>
            <surname>Blakey</surname>
            <given-names>SE</given-names>
          </name>
          <name>
            <surname>Bridgeman</surname>
            <given-names>AM</given-names>
          </name>
          <name>
            <surname>Brown</surname>
            <given-names>AJ</given-names>
          </name>
          <name>
            <surname>Buck</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Burrill</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Butler</surname>
            <given-names>AP</given-names>
          </name>
          <name>
            <surname>Carder</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Carter</surname>
            <given-names>NP</given-names>
          </name>
          <name>
            <surname>Chapman</surname>
            <given-names>JC</given-names>
          </name>
          <name>
            <surname>Clamp</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Clark</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Clark</surname>
            <given-names>LN</given-names>
          </name>
          <name>
            <surname>Clark</surname>
            <given-names>SY</given-names>
          </name>
          <name>
            <surname>Clee</surname>
            <given-names>CM</given-names>
          </name>
          <name>
            <surname>Clegg</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Cobley</surname>
            <given-names>VE</given-names>
          </name>
          <name>
            <surname>Collier</surname>
            <given-names>RE</given-names>
          </name>
          <name>
            <surname>Connor</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Corby</surname>
            <given-names>NR</given-names>
          </name>
          <name>
            <surname>Coulson</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Coville</surname>
            <given-names>GJ</given-names>
          </name>
          <name>
            <surname>Dead-man</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Dhami</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Dunn</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Ellington</surname>
            <given-names>AG</given-names>
          </name>
          <name>
            <surname>Frankland</surname>
            <given-names>JA</given-names>
          </name>
          <name>
            <surname>Fraser</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>French</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Garner</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Grafham</surname>
            <given-names>DV</given-names>
          </name>
          <name>
            <surname>Griffiths</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Griffiths</surname>
            <given-names>MND</given-names>
          </name>
          <name>
            <surname>Gwilliam</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Hall</surname>
            <given-names>RE</given-names>
          </name>
          <name>
            <surname>Hammond</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Harley</surname>
            <given-names>JL</given-names>
          </name>
          <name>
            <surname>Heath</surname>
            <given-names>PD</given-names>
          </name>
          <name>
            <surname>Ho</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Holden</surname>
            <given-names>JL</given-names>
          </name>
          <name>
            <surname>Howden</surname>
            <given-names>PJ</given-names>
          </name>
          <name>
            <surname>Huckle</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Hunt</surname>
            <given-names>AR</given-names>
          </name>
          <name>
            <surname>Hunt</surname>
            <given-names>SE</given-names>
          </name>
          <name>
            <surname>Jekosch</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Johnson</surname>
            <given-names>CM</given-names>
          </name>
          <name>
            <surname>Johnson</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Kay</surname>
            <given-names>MP</given-names>
          </name>
          <name>
            <surname>Kimberley</surname>
            <given-names>AM</given-names>
          </name>
          <name>
            <surname>King</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Knights</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Laird</surname>
            <given-names>GK</given-names>
          </name>
          <name>
            <surname>Lawlor</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Lehvaslaiho</surname>
            <given-names>MH</given-names>
          </name>
          <name>
            <surname>Leversha</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Lloyd</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Lloyd</surname>
            <given-names>DM</given-names>
          </name>
          <name>
            <surname>Lovell</surname>
            <given-names>JD</given-names>
          </name>
          <name>
            <surname>Marsh</surname>
            <given-names>VL</given-names>
          </name>
          <name>
            <surname>Martin</surname>
            <given-names>SL</given-names>
          </name>
          <name>
            <surname>McConnachie</surname>
            <given-names>LJ</given-names>
          </name>
          <name>
            <surname>McLay</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>McMurray</surname>
            <given-names>AA</given-names>
          </name>
          <name>
            <surname>Milne</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Mistry</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Moore</surname>
            <given-names>MJF</given-names>
          </name>
          <name>
            <surname>Mullikin</surname>
            <given-names>JC</given-names>
          </name>
          <name>
            <surname>Nickerson</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Oliver</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Parker</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Patel</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Pearce</surname>
            <given-names>TAV</given-names>
          </name>
          <name>
            <surname>Peck</surname>
            <given-names>AI</given-names>
          </name>
          <name>
            <surname>Phillimore</surname>
            <given-names>BJCT</given-names>
          </name>
          <name>
            <surname>Prathalingam</surname>
            <given-names>SR</given-names>
          </name>
          <name>
            <surname>Plumb</surname>
            <given-names>RW</given-names>
          </name>
          <name>
            <surname>Ramsay</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Rice</surname>
            <given-names>CM</given-names>
          </name>
          <name>
            <surname>Ross</surname>
            <given-names>MT</given-names>
          </name>
          <name>
            <surname>Scott</surname>
            <given-names>CE</given-names>
          </name>
          <name>
            <surname>Sehra</surname>
            <given-names>HK</given-names>
          </name>
          <name>
            <surname>Shownkeen</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Sims</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Skuce</surname>
            <given-names>CD</given-names>
          </name>
          <name>
            <surname>Smith</surname>
            <given-names>ML</given-names>
          </name>
          <name>
            <surname>Soderlund</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Steward</surname>
            <given-names>CA</given-names>
          </name>
          <name>
            <surname>Sulston</surname>
            <given-names>JE</given-names>
          </name>
          <name>
            <surname>Swann</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Sycamore</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Taylor</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Tee</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Thomas</surname>
            <given-names>DW</given-names>
          </name>
          <name>
            <surname>Thorpe</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Tracey</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Tromans</surname>
            <given-names>AC</given-names>
          </name>
          <name>
            <surname>Vaudin</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Wall</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Wallis</surname>
            <given-names>JM</given-names>
          </name>
          <name>
            <surname>Whitehead</surname>
            <given-names>SL</given-names>
          </name>
          <name>
            <surname>Whittaker</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Willey</surname>
            <given-names>DL</given-names>
          </name>
          <name>
            <surname>Williams</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Williams</surname>
            <given-names>SA</given-names>
          </name>
          <name>
            <surname>Wilming</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Wray</surname>
            <given-names>PW</given-names>
          </name>
          <name>
            <surname>Hubbard</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Durbin</surname>
            <given-names>RM</given-names>
          </name>
          <name>
            <surname>Bentley</surname>
            <given-names>DR</given-names>
          </name>
          <name>
            <surname>Beck</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Rogers</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>The DNA sequence and comparative analysis of human chromosome 20</article-title>
        <source>Nature</source>
        <year>2001</year>
        <volume>414</volume>
        <fpage>865</fpage>
        <lpage>871</lpage>
        <pub-id pub-id-type="pmid">11780052</pub-id>
      </citation>
    </ref>
    <ref id="B27">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Rivas</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Eddy</surname>
            <given-names>SR</given-names>
          </name>
        </person-group>
        <article-title>The language of RNA: a formal grammar that includes pseudoknots</article-title>
        <source>Bioinformatics</source>
        <year>2000</year>
        <volume>16</volume>
        <fpage>334</fpage>
        <lpage>340</lpage>
        <pub-id pub-id-type="pmid">10869031</pub-id>
      </citation>
    </ref>
    <ref id="B28">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Snyder</surname>
            <given-names>EE</given-names>
          </name>
          <name>
            <surname>Stormo</surname>
            <given-names>GD</given-names>
          </name>
        </person-group>
        <article-title>Identification of coding regions in genomic DNA sequences: an application of dynamic programming and neural networks</article-title>
        <source>Nucleic Acids Research</source>
        <year>1993</year>
        <volume>21</volume>
        <fpage>607</fpage>
        <lpage>613</lpage>
        <pub-id pub-id-type="pmid">8441672</pub-id>
      </citation>
    </ref>
    <ref id="B29">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Delcher</surname>
            <given-names>AL</given-names>
          </name>
          <name>
            <surname>Kasif</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Fleischmann</surname>
            <given-names>RD</given-names>
          </name>
          <name>
            <surname>Peterson</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>White</surname>
            <given-names>O</given-names>
          </name>
          <name>
            <surname>Salzberg</surname>
            <given-names>SL</given-names>
          </name>
        </person-group>
        <article-title>Alignment of whole genomes</article-title>
        <source>Nucleic Acids Research</source>
        <year>1999</year>
        <volume>27</volume>
        <fpage>2369</fpage>
        <lpage>2376</lpage>
        <pub-id pub-id-type="pmid">10325427</pub-id>
      </citation>
    </ref>
  </ref-list>
  <sec sec-type="display-objects">
    <title>Figures and Tables</title>
    <fig position="float" id="F1">
      <label>Figure 1</label>
      <caption>
        <p>Example of joining two HSPs. A single point on each HSP is chosen to be be included in the alignment. This is the centre of the HSP according to the scores, such that equivalenced bases on either side contribute to half of the HSP score. As shown in this example, if the centre of the HSPs according to their length had been chosen instead, it would not have been possible to join them to form an alignment.</p>
      </caption>
      <graphic xlink:href="1471-2105-6-31-1"/>
    </fig>
    <fig position="float" id="F2">
      <label>Figure 2</label>
      <caption>
        <p>The five types of sub-alignment region around HSPs in which dynamic programming may be applied. The start of an HSP (A), handling small gaps by joining two adjacent ends of HSPs (B), handling large gaps by joining two distant HSPs via a span (C,D) and the end of an HSP (E). Other features, such as splice sites are incorporated into the alignment within the SARs.</p>
      </caption>
      <graphic xlink:href="1471-2105-6-31-2"/>
    </fig>
    <fig position="float" id="F3">
      <label>Figure 3</label>
      <caption>
        <p>A toy example of bounded sparse dynamic programming. In this example the bounds indicate that if the overall alignment threshold is greater than 280, no sub-alignment DP is required. Otherwise, the region between A and B is confirmed first, and the bounds obviate DP between A and C. For clarity, terminal bounds are not included in this example.</p>
      </caption>
      <graphic xlink:href="1471-2105-6-31-3"/>
    </fig>
    <fig position="float" id="F4">
      <label>Figure 4</label>
      <caption>
        <p>Models for alignment of an EST to genomic sequnce. The exhaustive model for aligning ESTs to genome DNA, showing portal states and span states is shown in Figure 4 (a). The portal states are <italic>match forward </italic>and <italic>match reverse</italic>, and these share a set of HSPs. The span states are <italic>intron forward </italic>and <italic>intron reverse</italic>, and may accommodate large gaps. These portal and span states are represented in the heuristic model shown in Figure 4 (b), with each transition represented by a different derived model, labelled A to E, corresponding to the SAR types show in Figure 2.</p>
      </caption>
      <graphic xlink:href="1471-2105-6-31-4"/>
    </fig>
    <fig position="float" id="F5">
      <label>Figure 5</label>
      <caption>
        <p>Example of generation of a derived model. The original model on the left (for Smith-Waterman-Gotoh) is used to generate the derived model on the right for joining two adjacent HSPs. Extra transitions are allowed from the START state to the INSERT and DELETE states and onto the END state, as the derived model must allow gaps to open directly from the HSPs (in contrast to Smith-Waterman-Gotoh where an alignment cannot start with a gap). Additionally, the original model is local, but in this case the derived model is global, as it must start and end on the HSP.</p>
      </caption>
      <graphic xlink:href="1471-2105-6-31-5"/>
    </fig>
    <fig position="float" id="F6">
      <label>Figure 6</label>
      <caption>
        <p>Example of BSDP during alignment of a protein sequence to genomic DNA. Figure 6 (a) shows 912 candidate SARs positioned on the HSPs. Figure 6 (b) shows the 109 SARs to which DP is applied during BSDP, and Figure 6 (c) shows the 18 SARs which appear in the final alignment.</p>
      </caption>
      <graphic xlink:href="1471-2105-6-31-6"/>
    </fig>
    <table-wrap position="float" id="T1">
      <label>Table 1</label>
      <caption>
        <p>Examples of hierarchical model building in C4. Instead of building each model from scratch, most models are created in a modular fashion by making adaptions and additions to other models. This facilitates the building of complex models.</p>
      </caption>
      <table frame="hsides" rules="groups">
        <thead>
          <tr>
            <td align="left">
              <bold>Model</bold>
            </td>
            <td align="right">
              <bold>Components</bold>
            </td>
            <td align="right">
              <bold>States</bold>
            </td>
            <td align="right">
              <bold>Transitions</bold>
            </td>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td align="left">ungapped</td>
            <td align="right">substitution matrix</td>
            <td align="right">3</td>
            <td align="right">3</td>
          </tr>
          <tr>
            <td align="left">Needleman-Wunsch (NW)</td>
            <td align="right">ungapped with gap penalties</td>
            <td align="right">3</td>
            <td align="right">5</td>
          </tr>
          <tr>
            <td align="left">Smith-Waterman (SW)</td>
            <td align="right">NW + local alignment scope</td>
            <td align="right">3</td>
            <td align="right">5</td>
          </tr>
          <tr>
            <td align="left">Smith-Waterman-Gotoh (SWG)</td>
            <td align="right">SW + affine gap costs</td>
            <td align="right">5</td>
            <td align="right">9</td>
          </tr>
          <tr>
            <td align="left">est2genome</td>
            <td align="right">SWG + intron models</td>
            <td align="right">10</td>
            <td align="right">24</td>
          </tr>
          <tr>
            <td align="left">protein2dna</td>
            <td align="right">SWG + translation + frameshifts</td>
            <td align="right">6</td>
            <td align="right">13</td>
          </tr>
          <tr>
            <td align="left">protein2genome</td>
            <td align="right">p2d + intron model</td>
            <td align="right">13</td>
            <td align="right">33</td>
          </tr>
        </tbody>
      </table>
    </table-wrap>
    <table-wrap position="float" id="T2">
      <label>Table 2</label>
      <caption>
        <p>Results of an evaluation comparing exonerate (using the methods presented here), with sim4 and est2genome. A subset of the ensembl database was used, containing 1,827 genes, 9,917 exons and 2,387,971 bases. Times are given for alignment of all cDNAs to all contigs. The CPU time for est2genome was estimated from a smaller number of alignments. The accuracies are comparable, but the times are much faster for the heuristic methods.</p>
      </caption>
      <table frame="hsides" rules="groups">
        <thead>
          <tr>
            <td align="left">
              <bold>Method</bold>
            </td>
            <td align="right">
              <bold>Base Accuracy</bold>
            </td>
            <td align="right">
              <bold>Exon Accuracy</bold>
            </td>
            <td align="right">
              <bold>CPU Time (seconds)</bold>
            </td>
            <td align="right">
              <bold>x-fold</bold>
            </td>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td align="left">est2genome</td>
            <td align="right">99.99% (2,387,648)</td>
            <td align="right">99.90% (9,907)</td>
            <td align="right">≅ 7.2 years (226,637,523)</td>
            <td align="right">1</td>
          </tr>
          <tr>
            <td align="left">sim4</td>
            <td align="right">98.97% (2,363,438)</td>
            <td align="right">98.12% (9,731)</td>
            <td align="right">≅ 60 hours (216,956)</td>
            <td align="right">1045</td>
          </tr>
          <tr>
            <td align="left">exonerate</td>
            <td align="right">99.88% (2,384,988)</td>
            <td align="right">99.98% (9,916)</td>
            <td align="right">≅ 46 minutes (2,577)</td>
            <td align="right">87946</td>
          </tr>
        </tbody>
      </table>
    </table-wrap>
  </sec>
</back>
