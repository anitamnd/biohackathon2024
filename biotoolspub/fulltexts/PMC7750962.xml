<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.2 20190208//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.2?>
<?ConverterInfo.XSLTName jats2jats3.xsl?>
<?ConverterInfo.Version 1?>
<?properties open_access?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">Bioinformatics</journal-id>
    <journal-id journal-id-type="publisher-id">bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1367-4803</issn>
    <issn pub-type="epub">1367-4811</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">7750962</article-id>
    <article-id pub-id-type="pmid">33123738</article-id>
    <article-id pub-id-type="doi">10.1093/bioinformatics/btaa616</article-id>
    <article-id pub-id-type="publisher-id">btaa616</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Applications Notes</subject>
        <subj-group subj-group-type="category-toc-heading">
          <subject>Genome Analysis</subject>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="category-taxonomy-collection">
        <subject>AcademicSubjects/SCI01060</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Neoantimon: a multifunctional R package for identification of tumor-specific neoantigens</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author" corresp="yes">
        <name>
          <surname>Hasegawa</surname>
          <given-names>Takanori</given-names>
        </name>
        <xref rid="btaa616-cor1" ref-type="corresp"/>
        <aff>
          <institution>Division of Health Medical Data Science, Health Intelligence Center, The Institute of Medical Science, The University of Tokyo, Tokyo 108-8639, Japan</institution>
        </aff>
        <!--t-hasegw@u-tokyo.ims.ac.jp-->
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Hayashi</surname>
          <given-names>Shuto</given-names>
        </name>
        <aff>
          <institution>Laboratory of DNA Information Analysis, Human Genome Center, The Institute of Medical Science, The University of Tokyo, Tokyo 108-8639, Japan</institution>
        </aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Shimizu</surname>
          <given-names>Eigo</given-names>
        </name>
        <aff>
          <institution>Laboratory of DNA Information Analysis, Human Genome Center, The Institute of Medical Science, The University of Tokyo, Tokyo 108-8639, Japan</institution>
        </aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Mizuno</surname>
          <given-names>Shinichi</given-names>
        </name>
        <aff>
          <institution>Devision of Cancer Research, Center for Advanced Medical Innovation, Kyushu University, Fukuoka 812-8582, Japan</institution>
        </aff>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">http://orcid.org/0000-0002-6851-8004</contrib-id>
        <name>
          <surname>Niida</surname>
          <given-names>Atsushi</given-names>
        </name>
        <aff>
          <institution>Division of Health Medical Data Science, Health Intelligence Center, The Institute of Medical Science, The University of Tokyo, Tokyo 108-8639, Japan</institution>
        </aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Yamaguchi</surname>
          <given-names>Rui</given-names>
        </name>
        <aff>
          <institution>Laboratory of DNA Information Analysis, Human Genome Center, The Institute of Medical Science, The University of Tokyo, Tokyo 108-8639, Japan</institution>
        </aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Miyano</surname>
          <given-names>Satoru</given-names>
        </name>
        <aff>
          <institution>Laboratory of DNA Information Analysis, Human Genome Center, The Institute of Medical Science, The University of Tokyo, Tokyo 108-8639, Japan</institution>
        </aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Nakagawa</surname>
          <given-names>Hidewaki</given-names>
        </name>
        <aff><institution>Laboratory for Cancer Genomics, RIKEN Center for Integrative Medical Sciences</institution>, Yokohama 230-0045, <country country="JP">Japan</country></aff>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid" authenticated="false">http://orcid.org/0000-0002-2989-308X</contrib-id>
        <name>
          <surname>Imoto</surname>
          <given-names>Seiya</given-names>
        </name>
        <xref rid="btaa616-cor1" ref-type="corresp"/>
        <aff>
          <institution>Division of Health Medical Data Science, Health Intelligence Center, The Institute of Medical Science, The University of Tokyo, Tokyo 108-8639, Japan</institution>
        </aff>
        <!--t-hasegw@u-tokyo.ims.ac.jp-->
      </contrib>
    </contrib-group>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Mathelier</surname>
          <given-names>Anthony</given-names>
        </name>
        <role>Associate Editor</role>
      </contrib>
    </contrib-group>
    <author-notes>
      <corresp id="btaa616-cor1">To whom correspondence should be addressed. E-mail: <email>t-hasegw@u-tokyo.ims.ac.jp</email></corresp>
    </author-notes>
    <pub-date pub-type="collection">
      <day>15</day>
      <month>9</month>
      <year>2020</year>
    </pub-date>
    <pub-date pub-type="epub" iso-8601-date="2020-09-16">
      <day>16</day>
      <month>9</month>
      <year>2020</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>16</day>
      <month>9</month>
      <year>2020</year>
    </pub-date>
    <volume>36</volume>
    <issue>18</issue>
    <fpage>4813</fpage>
    <lpage>4816</lpage>
    <history>
      <date date-type="received">
        <day>18</day>
        <month>12</month>
        <year>2019</year>
      </date>
      <date date-type="rev-recd">
        <day>23</day>
        <month>6</month>
        <year>2020</year>
      </date>
      <date date-type="accepted">
        <day>02</day>
        <month>7</month>
        <year>2020</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>Â© The Author(s) 2020. Published by Oxford University Press.</copyright-statement>
      <copyright-year>2020</copyright-year>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted reuse, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <self-uri xlink:href="btaa616.pdf"/>
    <abstract>
      <title>Abstract</title>
      <sec id="s1">
        <title>Summary</title>
        <p>It is known that some mutant peptides, such as those resulting from missense mutations and frameshift insertions, can bind to the major histocompatibility complex and be presented to antitumor T cells on the surface of a tumor cell. These peptides are termed neoantigen, and it is important to understand this process for cancer immunotherapy. Here, we introduce an R package termed Neoantimon that can predict a list of potential neoantigens from a variety of mutations, which include not only somatic point mutations but insertions, deletions and structural variants. Beyond the existing applications, Neoantimon is capable of attaching and reflecting several additional information, e.g. wild-type binding capability, allele specific RNA expression levels, single nucleotide polymorphism information and combinations of mutations to filter out infeasible peptides as neoantigen.</p>
      </sec>
      <sec id="s2">
        <title>Availability and implementation</title>
        <p>The R package is available at <ext-link xlink:href="http://github/hase62/Neoantimon" ext-link-type="uri">http://github/hase62/Neoantimon</ext-link>.</p>
      </sec>
    </abstract>
    <funding-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>Grant-in-Aid for Scientific Research(B)</institution>
          </institution-wrap>
        </funding-source>
        <award-id>18H03328</award-id>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>Japan Society for the Promotion of Science</institution>
            <institution-id institution-id-type="DOI">10.13039/501100001691</institution-id>
          </institution-wrap>
        </funding-source>
      </award-group>
    </funding-group>
    <counts>
      <page-count count="4"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec>
    <title>1 Introduction</title>
    <p>Recent technological advances in massively parallel sequencing have enabled the identification of genetic variants, e.g. single nucleotide variants (SNVs) and insertions or deletions (indels), in individual cancer patients. Furthermore, substantial evidence indicates that tumor-specific peptides that result from such variations can bind to a major histocompatibility complex (MHC) molecule and be presented to antitumor T cells on the surface of a tumor cell. Identification of such tumor-specific peptides, termed neoantigens, has been receiving increasing attention because of its numerous potential applications in cancer immunotherapy (<xref rid="btaa616-B3" ref-type="bibr">Carreno <italic toggle="yes">et al.</italic>, 2015</xref>; <xref rid="btaa616-B8" ref-type="bibr">Matsushita <italic toggle="yes">et al.</italic>, 2012</xref>; <xref rid="btaa616-B10" ref-type="bibr">Mizuno <italic toggle="yes">et al.</italic>, 2018</xref>).</p>
    <p>To identify the possible presence of neoantigens in individual tumor, we have to predict whether mutant peptides can bind to the patientâs human leukocyte antigens (HLAs). Several computational methods such as netMHCpan (<xref rid="btaa616-B6" ref-type="bibr">Jurtz <italic toggle="yes">et al.</italic>, 2017</xref>) and MHCflurry (<xref rid="btaa616-B11" ref-type="bibr">OâDonnell <italic toggle="yes">et al.</italic>, 2018</xref>) have been proposed to predict the binding capability, including binding affinity and percentage rank of affinity. To apply these methodologies, we need to determine the patientâs HLA types and prepare a list of tumor-specific peptides obtained from sequencing data. Designing such peptides requires not only mutation information, but also the reference sequences with their coding protein information because they are fractions of expressed mutant proteins. Even after the prediction of the binding capability of such mutant peptides, further classification filters should be applied to the selection, e.g. a comparison in binding affinity between wild-type and mutant peptides and the evaluation of allele-specific RNA expression levels.</p>
    <p>To automate this process and easily identify tumor-specific neoantigens, some computational tools have been developed (<xref rid="btaa616-B2" ref-type="bibr">Bjerregaard <italic toggle="yes">et al.</italic>, 2017</xref>; <xref rid="btaa616-B5" ref-type="bibr">Hundal <italic toggle="yes">et al.</italic>, 2016</xref>). These tools greatly help to obtain predicted results; however, a few tools can use mutation data [such as variant call format (vcf) files] in a local analytical environment such as the R. In addition, the existing tools are applicable only for the prediction of HLA Class I binding and for handling of SNVs and indels at best, but not for the prediction of HLA Class II binding and handling of structural variants (SVs) and mutant RNA sequences such as fusion transcript. Moreover, they lack detailed considerations, e.g. reflecting SNVs on the frameshift regions and single nucleotide polymorphisms (SNPs) to generated peptides. To address these requirements, we developed an easy and multifunctional R package termed Neoantimon that can produce a list of candidate neoantigens (for HLA Class I and II) caused by SNVs, indels and SVs. It can automatically construct mutant peptides from vcf files or mutant RNA sequences and calculate their binding capability to the corresponding HLAs with some information for filtering. This tool has been used in the Mitochondrial Genome and Immunogenomics Working Group in the PanCancer Analysis of Whole Genomes (PCAWG) project (<xref rid="btaa616-B10" ref-type="bibr">Mizuno <italic toggle="yes">et al.</italic>, 2018</xref>).</p>
  </sec>
  <sec>
    <title>2 Implementation</title>
    <sec>
      <title>2.1 Required input files</title>
      <p>This package requires the two following inputs: (i) a text file storing gene sequence variations and (ii) a list of HLA types identified by, e.g. ALPHLARD (<xref rid="btaa616-B4" ref-type="bibr">Hayashi <italic toggle="yes">et al.</italic>, 2018</xref>). (i) can be either one of the following files: (a) an annotated vcf file generated by ANNOVAR (<xref rid="btaa616-B13" ref-type="bibr">Wang <italic toggle="yes">et al.</italic>, 2010</xref>) or Ensembl Variant Effect Predictor (VEP) (<xref rid="btaa616-B9" ref-type="bibr">McLaren <italic toggle="yes">et al.</italic>, 2016</xref>), (b) non-annotated vcf file with using annotation option in this package or (c) a list of mutant RNA sequences in association with the corresponding gene symbols or NM IDs to filter out wild-type peptides. Only non-synonymous substitutions, in-frame and out-of-frame indels are extracted from SNVs and indels described in vcf files to generate mutant peptides. For the evaluation of potential fusion transcripts on the basis of SVs, vcf files must conform to the break-end (BND) format. A sample procedure to generate mutant peptides is illustrated in <xref rid="btaa616-F1" ref-type="fig">FiguresÂ 1â4</xref>.
</p>
      <fig position="float" id="btaa616-F1">
        <label>Fig. 1.</label>
        <caption>
          <p>A sample procedure to generate mutant peptides from SNVs described in the input vcf file. Mutant and wild-type peptides are generated through the construction of the corresponding RNA sequences using Reference Sequence Database (RefSeq). Reference and alternative alleles, and wild-type and mutant amino acids are colored red.</p>
        </caption>
        <graphic xlink:href="btaa616f1" position="float"/>
      </fig>
      <fig position="float" id="btaa616-F2">
        <label>Fig. 2.</label>
        <caption>
          <p>A sample procedure to generate mutant peptides from indels described in the input vcf file. In contrast to generate mutant peptides based on SNVs, indels are separated to (<bold>a</bold>) out-of-frame and (<bold>b</bold>) in-frame indels. In the former case, mutant peptides are generated from the mutation position to the stop codon. In the latter case, it is similar to the case of non-synonymous SNVs, as illustrated in <xref rid="btaa616-F1" ref-type="fig">FigureÂ 1</xref>. The original peptide sequences are colored black, and mutant peptide and deleted peptide regions are colored red</p>
        </caption>
        <graphic xlink:href="btaa616f2" position="float"/>
      </fig>
      <fig position="float" id="btaa616-F3">
        <label>Fig. 3.</label>
        <caption>
          <p>A sample procedure to generate mutant peptides from SVs described in the input vcf file following BND format. As same as indels, it can generate out-of-frame and in-frame potential fusion transcripts. By referring to the original protein sequences, peptides included in the original genes are removed for the evaluation. Here, RNA sequences and peptides generated from SLC25A12 and NFASC are colored red and green, respectively</p>
        </caption>
        <graphic xlink:href="btaa616f3" position="float"/>
      </fig>
      <fig position="float" id="btaa616-F4">
        <label>Fig. 4.</label>
        <caption>
          <p>A sample procedure to generate mutant peptides directly from an RNA sequence. By referring to the original peptide sequences, peptides included in the original genes are removed for the evaluation. Here, peptides sequence included in NFKB are colored red. Note that, in this case, we assume that the input RNA sequence is a fusion transcript generated from NFKB</p>
        </caption>
        <graphic xlink:href="btaa616f4" position="float"/>
      </fig>
    </sec>
    <sec>
      <title>2.2 Optional input files and considerations</title>
      <p>Users can optionally provide (a) RNA expression data with and without (b) the corresponding Binary Alignment Map (BAM) file to attach total and allele-specific RNA expression levels and (c) copy number variation data to calculate the posterior probability distribution over cancer-cell fraction (CCFP) to evaluate tumor subclonality (<xref rid="btaa616-B7" ref-type="bibr">Lohr <italic toggle="yes">et al.</italic>, 2014</xref>). Considering a somatic mutation observed in <italic toggle="yes">a</italic> of <italic toggle="yes">N</italic> sequencing reads on a locus of absolute somatic copy-number <italic toggle="yes">q</italic> in a sample of purity <italic toggle="yes">Î±</italic>, CCFP is calculated as <italic toggle="yes">P</italic>(<italic toggle="yes">c</italic>) <inline-formula id="IE1"><mml:math id="IM1" display="inline" overflow="scroll"><mml:mo>â</mml:mo></mml:math></inline-formula> Binom(<italic toggle="yes">a</italic>/<italic toggle="yes">N</italic>, <italic toggle="yes">f</italic>(<italic toggle="yes">c</italic>)), where <inline-formula id="IE2"><mml:math id="IM2" display="inline" overflow="scroll"><mml:mrow><mml:mi>f</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>c</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mo>Î±</mml:mo><mml:mi>c</mml:mi><mml:mo>/</mml:mo><mml:mn>2</mml:mn><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>â</mml:mo><mml:mo>Î±</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:mo>Î±</mml:mo><mml:mi>q</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> and <italic toggle="yes">c</italic> corresponds to a uniform prior. They are attached to the output, as illustrated in <xref rid="btaa616-F5" ref-type="fig">FigureÂ 5</xref>. Note that, (c) should be according to the output format of ASCAT (Allele-Specific Copy Number Analysis of Tumors) (<xref rid="btaa616-B12" ref-type="bibr">Van Loo <italic toggle="yes">et al.</italic>, 2010</xref>) or include locus, #copy of Allele A and B, variant allele frequency (VAF), total read depth and tumor purity (VAF and total read depth can be automatically assigned from the input file).
</p>
      <fig position="float" id="btaa616-F5">
        <label>Fig. 5.</label>
        <caption>
          <p>An explanation of attaching total and allele-specific RNA expressions, and CCFP. Additional information can be attached to the standard annotation in the output using (a) RNA expression data with and without (b) the corresponding Binary Alignment Map (BAM) file and (c) copy number variation data. Total and allele-specific RNA expression based on DNA alleles (VAF/total read depth Ã total RNA expression level), VAF and allele-specific RNA expression based on RNA sequences using samtools, and CCFP are attached given (a), (a) and (b) and (c)</p>
        </caption>
        <graphic xlink:href="btaa616f5" position="float"/>
      </fig>
      <p>In addition, users can consider specific cases of existing SNPs on the mutant peptide by providing (c) SNPs data, and multiple SNVs on the same mutant peptides and among the frameshift region caused by indels. These cases are explained in <xref rid="btaa616-F6" ref-type="fig">FigureÂ 6</xref>.
</p>
      <fig position="float" id="btaa616-F6">
        <label>Fig. 6.</label>
        <caption>
          <p>The consideration of the following cases; (<bold>a</bold>) multiple SNVs exist on the same peptide, (<bold>b</bold>) SNVs exist among the frameshift region generated by indels and (<bold>c</bold>) SNPs exist on the mutant peptide. In these cases, the package can optionally generate all patterns of mutant peptides and evaluate them</p>
        </caption>
        <graphic xlink:href="btaa616f6" position="float"/>
      </fig>
      <p>The comparison of the functions among pVACseq (<xref rid="btaa616-B5" ref-type="bibr">Hundal <italic toggle="yes">et al.</italic>, 2016</xref>) and MuPeXI (<xref rid="btaa616-B2" ref-type="bibr">Bjerregaard <italic toggle="yes">et al.</italic>, 2017</xref>), and our R package (neoantimon) is displayed in <xref rid="btaa616-T1" ref-type="table">TableÂ 1</xref>. One can install this package from a GitHub repository and use it in the R environment on Mac/Linux.
</p>
      <table-wrap position="float" id="btaa616-T1">
        <label>Table 1.</label>
        <caption>
          <p>A comparison table of the functions among pVACseq, MuPeXI and Neoantimon</p>
        </caption>
        <table frame="hsides" rules="groups">
          <colgroup span="1">
            <col valign="top" align="left" span="1"/>
            <col valign="top" align="left" span="1"/>
            <col valign="top" align="left" span="1"/>
            <col valign="top" align="left" span="1"/>
          </colgroup>
          <thead>
            <tr>
              <th rowspan="1" colspan="1"/>
              <th rowspan="1" colspan="1">Neoantimon</th>
              <th rowspan="1" colspan="1">pVACseq</th>
              <th rowspan="1" colspan="1">MuPeXI</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td rowspan="1" colspan="1">Input file format</td>
              <td rowspan="1" colspan="1">vcf file</td>
              <td rowspan="1" colspan="1">vcf file</td>
              <td rowspan="1" colspan="1">vcf file</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">Variant annotation</td>
              <td rowspan="1" colspan="1">YES</td>
              <td rowspan="1" colspan="1">YES</td>
              <td rowspan="1" colspan="1">YES</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">SNV support</td>
              <td rowspan="1" colspan="1">YES</td>
              <td rowspan="1" colspan="1">YES</td>
              <td rowspan="1" colspan="1">YES</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">Indel support</td>
              <td rowspan="1" colspan="1">YES</td>
              <td rowspan="1" colspan="1">YES</td>
              <td rowspan="1" colspan="1">YES</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">SV support</td>
              <td rowspan="1" colspan="1">YES</td>
              <td rowspan="1" colspan="1">NO</td>
              <td rowspan="1" colspan="1">NO</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">RNA seq. support</td>
              <td rowspan="1" colspan="1">YES</td>
              <td rowspan="1" colspan="1">NO</td>
              <td rowspan="1" colspan="1">NO</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">Output wild-type</td>
              <td rowspan="1" colspan="1">YES</td>
              <td rowspan="1" colspan="1">YES</td>
              <td rowspan="1" colspan="1">YES</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">Total RNA exp.</td>
              <td rowspan="1" colspan="1">Manual</td>
              <td rowspan="1" colspan="1">Manual</td>
              <td rowspan="1" colspan="1">Manual</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">Allelic RNA exp.</td>
              <td rowspan="1" colspan="1">BAM required</td>
              <td rowspan="1" colspan="1">BAM required</td>
              <td rowspan="1" colspan="1">NO</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">Subclonal filter</td>
              <td rowspan="1" colspan="1">YES</td>
              <td rowspan="1" colspan="1">NO</td>
              <td rowspan="1" colspan="1">NO</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">Multiple SNVs</td>
              <td rowspan="1" colspan="1">YES</td>
              <td rowspan="1" colspan="1">NO</td>
              <td rowspan="1" colspan="1">NO</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">SNVs on frameshift</td>
              <td rowspan="1" colspan="1">YES</td>
              <td rowspan="1" colspan="1">NO</td>
              <td rowspan="1" colspan="1">NO</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">SNPs integration</td>
              <td rowspan="1" colspan="1">YES</td>
              <td rowspan="1" colspan="1">NO</td>
              <td rowspan="1" colspan="1">NO</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">Prediction software</td>
              <td rowspan="1" colspan="1">netMHCpan/</td>
              <td rowspan="1" colspan="1">netMHCpan/</td>
              <td rowspan="1" colspan="1">netMHCpan</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1">MHCflurry</td>
              <td rowspan="1" colspan="1">MHCflurry, etc.</td>
              <td rowspan="1" colspan="1"/>
            </tr>
          </tbody>
        </table>
        <table-wrap-foot>
          <fn id="tblfn1">
            <p><italic toggle="yes">Note</italic>: âmanualâ means that users manually upload RNA expression files.</p>
          </fn>
        </table-wrap-foot>
      </table-wrap>
    </sec>
    <sec>
      <title>2.3 Output files</title>
      <p>This package generates FASTA files consisting of mutant and corresponding wild-type (for SNVs) peptides according to the RefSeq trasncript sequences, and an integrated output file including peptideâMHC binding capability estimated by NetMHCpan4.0 (<xref rid="btaa616-B6" ref-type="bibr">Jurtz <italic toggle="yes">et al.</italic>, 2017</xref>) or MHCflurry (<xref rid="btaa616-B11" ref-type="bibr">OâDonnell <italic toggle="yes">et al.</italic>, 2018</xref>), and NetMHCIIpan3.2 (<xref rid="btaa616-B1" ref-type="bibr">Andreatta <italic toggle="yes">et al.</italic>, 2015</xref>). In the application to frameshift indels and potential fusion transcripts, all mutant peptides generated from the mutation position to the stop codon are constructed. The output file includes (i) the HLA type, (ii) gene symbol, (iii) wild-type (if exists) and mutant peptide sequences, (iv) their IC<sub>50</sub> and percentages of rank affinity calculated by either NetMHCpan or MHCflurry (user selected), (v) chromosome number, (vi) NM_ID, (vii) amino acid changes (AAchages), (viii) reference and alternative alleles, (xi) exon start and end positions, (x) mutation position, (xi) total read depth and VAF, (xii) corresponding total and allele specific RNA expression (optional), (xiii) tumor subclonality represented by CCFP and the priority score defined in the next subsection. From the output file, users can extract a plausible set of peptides for neoantigen by setting any threshold for binding capability, RNA expressions and CCFP (such functions are also implemented). A simple overview of the package is illustrated in <xref rid="btaa616-F7" ref-type="fig">FigureÂ 7</xref>.
</p>
      <fig position="float" id="btaa616-F7">
        <label>Fig. 7.</label>
        <caption>
          <p>An overview of the input and output file information of the package. Green circles with and without dotted rectangles are optional and required inputs, respectively. Red rectangles and yellow circles are intermediate processes and the output files, respectively</p>
        </caption>
        <graphic xlink:href="btaa616f7" position="float"/>
      </fig>
    </sec>
    <sec>
      <title>2.4 Calculation of priority score</title>
      <p>For the evaluation of generated mutant peptides, we propose priority scores to roughly predict their immunogenicity. Based on the previous research (<xref rid="btaa616-B2" ref-type="bibr">Bjerregaard <italic toggle="yes">et al.</italic>, 2017</xref>), we calculate the priority scores <italic toggle="yes">P<sub>I</sub></italic> and <italic toggle="yes">P<sub>R</sub></italic> for using IC<sub>50</sub> and percentage of rank affinity, respectively, as follows.
<disp-formula id="E1"><label>(1)</label><mml:math id="M1" display="block" overflow="scroll"><mml:msub><mml:mi>P</mml:mi><mml:mi>I</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mo>[</mml:mo><mml:msub><mml:mi>L</mml:mi><mml:mi>I</mml:mi></mml:msub><mml:mo>(</mml:mo><mml:msub><mml:mi>I</mml:mi><mml:mi>m</mml:mi></mml:msub><mml:mo>)</mml:mo><mml:mi>f</mml:mi><mml:mo>(</mml:mo><mml:mi>A</mml:mi><mml:mo>,</mml:mo><mml:mi>E</mml:mi><mml:mo>)</mml:mo><mml:mo>]</mml:mo><mml:mo>[</mml:mo><mml:mo>(</mml:mo><mml:mn>1</mml:mn><mml:mo>â</mml:mo><mml:msup><mml:mn>2</mml:mn><mml:mrow><mml:mo>-</mml:mo><mml:mi>M</mml:mi></mml:mrow></mml:msup><mml:msub><mml:mi>L</mml:mi><mml:mi>I</mml:mi></mml:msub><mml:mo>(</mml:mo><mml:msub><mml:mi>I</mml:mi><mml:mi>w</mml:mi></mml:msub><mml:mo>)</mml:mo><mml:mo>]</mml:mo><mml:mi>C</mml:mi><mml:mo>,</mml:mo></mml:math></disp-formula>
Â <disp-formula id="E2"><label>(2)</label><mml:math id="M2" display="block" overflow="scroll"><mml:msub><mml:mi>P</mml:mi><mml:mi>R</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mo>[</mml:mo><mml:msub><mml:mi>L</mml:mi><mml:mi>R</mml:mi></mml:msub><mml:mo>(</mml:mo><mml:msub><mml:mi>R</mml:mi><mml:mi>m</mml:mi></mml:msub><mml:mo>)</mml:mo><mml:mi>f</mml:mi><mml:mo>(</mml:mo><mml:mi>A</mml:mi><mml:mo>,</mml:mo><mml:mi>E</mml:mi><mml:mo>)</mml:mo><mml:mo>]</mml:mo><mml:mo>[</mml:mo><mml:mo>(</mml:mo><mml:mn>1</mml:mn><mml:mo>â</mml:mo><mml:msup><mml:mn>2</mml:mn><mml:mrow><mml:mo>-</mml:mo><mml:mi>M</mml:mi></mml:mrow></mml:msup><mml:msub><mml:mi>L</mml:mi><mml:mi>R</mml:mi></mml:msub><mml:mo>(</mml:mo><mml:msub><mml:mi>R</mml:mi><mml:mi>w</mml:mi></mml:msub><mml:mo>)</mml:mo><mml:mo>]</mml:mo><mml:mi>C</mml:mi><mml:mo>,</mml:mo></mml:math></disp-formula>
Â <disp-formula id="E3"><label>(3)</label><mml:math id="M3" display="block" overflow="scroll"><mml:mrow><mml:mi>f</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>A</mml:mi><mml:mo>,</mml:mo><mml:mi>E</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mtext>tanh</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mi>g</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>A</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mi>E</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>
Â <disp-formula id="E4"><label>(4)</label><mml:math id="M4" display="block" overflow="scroll"><mml:mrow><mml:mi>g</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>A</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mtext>tanh</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mn>5</mml:mn><mml:mi>A</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>
Â <disp-formula id="E5"><label>(5)</label><mml:math id="M5" display="block" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mi>I</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mo>â</mml:mo><mml:mtext>exp</mml:mtext><mml:mo>â</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mn>0.015</mml:mn><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo>â</mml:mo><mml:mn>500</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:mfrac><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>
Â <disp-formula id="E6"><label>(6)</label><mml:math id="M6" display="block" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mi>R</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mo>â</mml:mo><mml:mtext>exp</mml:mtext><mml:mo>â</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mn>5</mml:mn><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo>â</mml:mo><mml:mn>2</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:mfrac><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>
Â <disp-formula id="E7"><label>(7)</label><mml:math id="M7" display="block" overflow="scroll"><mml:mrow><mml:mi>C</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mn>1</mml:mn><mml:mo>â</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mo>â</mml:mo><mml:mtext>exp</mml:mtext><mml:mo>â</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mo>â</mml:mo><mml:mn>30</mml:mn><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo>â</mml:mo><mml:mn>0.8</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:mfrac><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>where <italic toggle="yes">I<sub>m</sub></italic> and <italic toggle="yes">R<sub>m</sub></italic> are IC<sub>50</sub> and percentage of rank affinity of the mutant peptide, respectively, and <italic toggle="yes">I<sub>w</sub></italic> and <italic toggle="yes">R<sub>w</sub></italic> are IC<sub>50</sub> and percentage of rank affinity of the wild-type peptide, respectively. <italic toggle="yes">E</italic> is the expression level of the corresponding gene, <italic toggle="yes">A</italic> is the variant allele frequency, <italic toggle="yes">M</italic> is the number of mismatches between the mutant and wild-type peptides and <italic toggle="yes">C</italic> is the median value of CCFP. In contrast to the previous research (<xref rid="btaa616-B2" ref-type="bibr">Bjerregaard <italic toggle="yes">et al.</italic>, 2017</xref>), the output does not include any peptide that perfectly matches to wild-type peptides. For the comparison, output file also includes the previous score.</p>
    </sec>
  </sec>
  <sec>
    <title>3 Conclusions</title>
    <p>We developed an R package generating candidate neoantigens from variety of mutations, i.e. SNVs, indels and SVs and mutant RNA sequences. In particular, this package can cover specific cases such as multiple SNVs on the same mutant peptide and among frameshift region, as explained in <xref rid="btaa616-F6" ref-type="fig">FigureÂ 6</xref>, and include RNA expression and tumor subclonality data to filter-out implausible peptides for neoantigen. Thus, as compared in <xref rid="btaa616-T1" ref-type="table">TableÂ 1</xref>, it enables us to more finely select the candidate neoantigens beyond previously developed platforms. For the use of tumor immunotherapy, it can be attractive because it requires a great deal of cost to evaluate candidate mutant peptides to be neoantigen. Thanks to our package, one can easily complete the evaluation processes of candidate neoantigens by integrating several information. The package, documentation and sample analysis are available at <ext-link xlink:href="http://github/hase62/Neoantimon" ext-link-type="uri">http://github/hase62/Neoantimon</ext-link>, and an analysis result in PCAWG project is also available (<xref rid="btaa616-B10" ref-type="bibr">Mizuno <italic toggle="yes">et al.</italic>, 2018</xref>).</p>
  </sec>
  <sec>
    <title>Funding</title>
    <p>SI received Grant-in-Aid for Scientific Research(B) Grant Number 18H03328 from Japan Society for the Promotion of Science (https://www.jsps.go.jp/ english/).</p>
    <p><italic toggle="yes">Financial Support</italic>: none declared.</p>
    <p><italic toggle="yes">Conflict of Interest</italic>: none declared.</p>
  </sec>
</body>
<back>
  <ref-list id="ref1">
    <title>References</title>
    <ref id="btaa616-B1">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Andreatta</surname><given-names>M.</given-names></string-name></person-group> Â <etal>et al</etal> (<year>2015</year>) 
<article-title>Accurate pan-specific prediction of peptideâMHC class II binding affinity with improved binding core identification</article-title>. <source>Immunogenetics</source>, <volume>67</volume>, <fpage>641</fpage>â<lpage>650</lpage>.<pub-id pub-id-type="pmid">26416257</pub-id></mixed-citation>
    </ref>
    <ref id="btaa616-B2">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Bjerregaard</surname><given-names>A.-M.</given-names></string-name></person-group> Â <etal>et al</etal> (<year>2017</year>) 
<article-title>MuPeXI: prediction of neo-epitopes from tumor sequencing data</article-title>. <source>Cancer Immunol. Immunother</source>., <volume>66</volume>, <fpage>1123</fpage>â<lpage>1130</lpage>.<pub-id pub-id-type="pmid">28429069</pub-id></mixed-citation>
    </ref>
    <ref id="btaa616-B3">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Carreno</surname><given-names>B.M.</given-names></string-name></person-group> Â <etal>et al</etal> (<year>2015</year>) 
<article-title>Cancer immunotherapy. A dendritic cell vaccine increases the breadth and diversity of melanoma neoantigen-specific T cells</article-title>. <source>Science</source>, <volume>348</volume>, <fpage>803</fpage>â<lpage>808</lpage>.<pub-id pub-id-type="pmid">25837513</pub-id></mixed-citation>
    </ref>
    <ref id="btaa616-B4">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Hayashi</surname><given-names>S.</given-names></string-name></person-group> Â <etal>et al</etal> (<year>2018</year>) 
<article-title>ALPHLARD: a Bayesian method for analyzing HLA genes from whole genome sequence data</article-title>. <source>BMC Genomics</source>, <volume>19</volume>, <fpage>790</fpage>.<pub-id pub-id-type="pmid">30384854</pub-id></mixed-citation>
    </ref>
    <ref id="btaa616-B5">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Hundal</surname><given-names>J.</given-names></string-name></person-group> Â <etal>et al</etal> (<year>2016</year>) 
<article-title>pVAC-Seq: a genome-guided in silico approach to identifying tumor neoantigens</article-title>. <source>Genome Med</source>., <volume>8</volume>, <fpage>1</fpage>â<lpage>11</lpage>.<pub-id pub-id-type="pmid">26750923</pub-id></mixed-citation>
    </ref>
    <ref id="btaa616-B6">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Jurtz</surname><given-names>V.</given-names></string-name></person-group> Â <etal>et al</etal> (<year>2017</year>) 
<article-title>NetMHCpan-4.0: improved peptideâMHC class I interaction predictions integrating eluted ligand and peptide binding affinity data</article-title>. <source>J. Immunol</source>., <volume>199</volume>, <fpage>3360</fpage>â<lpage>3368</lpage>.<pub-id pub-id-type="pmid">28978689</pub-id></mixed-citation>
    </ref>
    <ref id="btaa616-B7">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Lohr</surname><given-names>J.G.</given-names></string-name></person-group> Â <etal>et al</etal> (<year>2014</year>) 
<article-title>Widespread genetic heterogeneity in multiple myeloma: implications for targeted therapy</article-title>. <source>Cancer Cell</source>, <volume>25</volume>, <fpage>91</fpage>â<lpage>101</lpage>.<pub-id pub-id-type="pmid">24434212</pub-id></mixed-citation>
    </ref>
    <ref id="btaa616-B8">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Matsushita</surname><given-names>H.</given-names></string-name></person-group> Â <etal>et al</etal> (<year>2012</year>) 
<article-title>Cancer exome analysis reveals a T-cell-dependent mechanism of cancer immunoediting</article-title>. <source>Nature</source>, <volume>482</volume>, <fpage>400</fpage>â<lpage>404</lpage>.<pub-id pub-id-type="pmid">22318521</pub-id></mixed-citation>
    </ref>
    <ref id="btaa616-B9">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>McLaren</surname><given-names>W.</given-names></string-name></person-group> Â <etal>et al</etal> (<year>2016</year>) 
<article-title>The ensembl variant effect predictor</article-title>. <source>Genome Biol</source>., <volume>17</volume>, <fpage>122</fpage>.<pub-id pub-id-type="pmid">27268795</pub-id></mixed-citation>
    </ref>
    <ref id="btaa616-B10">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><string-name><surname>Mizuno</surname><given-names>S.</given-names></string-name></person-group> Â <etal>et al</etal> (<year>2018</year>) Immuno-genomic pancancer landscape reveals diverse immune escape mechanisms and immuno-editing histories. <italic toggle="yes">bioRxiv, 285338.</italic></mixed-citation>
    </ref>
    <ref id="btaa616-B11">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>OâDonnell</surname><given-names>T.J.</given-names></string-name></person-group> Â <etal>et al</etal> (<year>2018</year>) 
<article-title>MHCflurry: open-source class I MHC binding affinity prediction</article-title>. <source>Cell Syst</source>., <volume>7</volume>, <fpage>129</fpage>â<lpage>132.e4</lpage>.<pub-id pub-id-type="pmid">29960884</pub-id></mixed-citation>
    </ref>
    <ref id="btaa616-B12">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Van Loo</surname><given-names>P.</given-names></string-name></person-group> Â <etal>et al</etal> (<year>2010</year>) 
<article-title>Allele-specific copy number analysis of tumors</article-title>. <source>Proc. Natl. Acad. Sci. USA</source>, <volume>107</volume>, <fpage>16910</fpage>â<lpage>16915</lpage>.<pub-id pub-id-type="pmid">20837533</pub-id></mixed-citation>
    </ref>
    <ref id="btaa616-B13">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Wang</surname><given-names>K.</given-names></string-name></person-group> Â <etal>et al</etal> (<year>2010</year>) 
<article-title>ANNOVAR: functional annotation of genetic variants from high-throughput sequencing data</article-title>. <source>Nucleic Acids Res</source>., <volume>38</volume>, <fpage>e164</fpage>.<pub-id pub-id-type="pmid">20601685</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
