<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.0 20120330//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.0?>
<?ConverterInfo.XSLTName jp2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Genome Res</journal-id>
    <journal-id journal-id-type="iso-abbrev">Genome Res</journal-id>
    <journal-id journal-id-type="hwp">genome</journal-id>
    <journal-id journal-id-type="pmc">genome</journal-id>
    <journal-id journal-id-type="publisher-id">GENOME</journal-id>
    <journal-title-group>
      <journal-title>Genome Research</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1088-9051</issn>
    <issn pub-type="epub">1549-5469</issn>
    <publisher>
      <publisher-name>Cold Spring Harbor Laboratory Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">7263188</article-id>
    <article-id pub-id-type="pmid">32430339</article-id>
    <article-id pub-id-type="medline">9509184</article-id>
    <article-id pub-id-type="doi">10.1101/gr.251447.119</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Method</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Exploring dimension-reduced embeddings with Sleepwalk</article-title>
      <alt-title alt-title-type="left-running">Ovchinnikova and Anders</alt-title>
      <alt-title alt-title-type="right-running">Sleepwalk</alt-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">http://orcid.org/0000-0001-9157-2634</contrib-id>
        <name>
          <surname>Ovchinnikova</surname>
          <given-names>Svetlana</given-names>
        </name>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">http://orcid.org/0000-0003-4868-1805</contrib-id>
        <name>
          <surname>Anders</surname>
          <given-names>Simon</given-names>
        </name>
      </contrib>
    </contrib-group>
    <aff>Center for Molecular Biology of the University of Heidelberg (ZMBH), 69120 Heidelberg, Germany</aff>
    <author-notes>
      <corresp>Corresponding author: <email>s.anders@zmbh.uni-heidelberg.de</email></corresp>
    </author-notes>
    <pub-date pub-type="ppub">
      <month>5</month>
      <year>2020</year>
    </pub-date>
    <volume>30</volume>
    <issue>5</issue>
    <fpage>749</fpage>
    <lpage>756</lpage>
    <history>
      <date date-type="received">
        <day>12</day>
        <month>4</month>
        <year>2019</year>
      </date>
      <date date-type="accepted">
        <day>1</day>
        <month>5</month>
        <year>2020</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>
        <ext-link ext-link-type="uri" xlink:href="http://genome.cshlp.org/site/misc/terms.xhtml">© 2020 Ovchinnikova and Anders; Published by Cold Spring Harbor Laboratory Press</ext-link>
      </copyright-statement>
      <copyright-year>2020</copyright-year>
      <license license-type="creative-commons" xlink:href="http://creativecommons.org/licenses/by-nc/4.0/">
        <license-p>This article is distributed exclusively by Cold Spring Harbor Laboratory Press for the first six months after the full-issue publication date (see <ext-link ext-link-type="uri" xlink:href="http://genome.cshlp.org/site/misc/terms.xhtml">http://genome.cshlp.org/site/misc/terms.xhtml</ext-link>). After six months, it is available under a Creative Commons License (Attribution-NonCommercial 4.0 International), as described at <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by-nc/4.0/">http://creativecommons.org/licenses/by-nc/4.0/</ext-link>.</license-p>
      </license>
    </permissions>
    <self-uri content-type="pdf" xlink:href="749.pdf"/>
    <abstract>
      <p>Dimension-reduction methods, such as t-SNE or UMAP, are widely used when exploring high-dimensional data describing many entities, for example, RNA-seq data for many single cells. However, dimension reduction is commonly prone to introducing artifacts, and we hence need means to see where a dimension-reduced embedding is a faithful representation of the local neighborhood and where it is not. We present Sleepwalk, a simple but powerful tool that allows the user to interactively explore an embedding, using color to depict original or any other distances from all points to the cell under the mouse cursor. We show how this approach not only highlights distortions but also reveals otherwise hidden characteristics of the data, and how Sleepwalk's comparative modes help integrate multisample data and understand differences between embedding and preprocessing methods. Sleepwalk is a versatile and intuitive tool that unlocks the full power of dimension reduction and will be of value not only in single-cell RNA-seq but also in any other area with matrix-shaped big data.</p>
    </abstract>
    <funding-group>
      <award-group id="funding-1">
        <funding-source>
          <institution-wrap>
            <institution>Deutsche Forschungsgemeinschaft </institution>
            <institution-id institution-id-type="open-funder-registry">10.13039/501100001659</institution-id>
          </institution-wrap>
        </funding-source>
        <award-id>201348542</award-id>
        <award-id>394046768</award-id>
      </award-group>
    </funding-group>
    <counts>
      <page-count count="8"/>
    </counts>
  </article-meta>
</front>
<body>
  <p>Whenever one is presented with large amounts of data, producing a suitable plot to get an overview is an important first step. So-called dimension-reduction methods are commonly used. For example, in high-throughput transcriptomics projects using expression microarrays or RNA-seq, it is common practice, especially when working with many samples, to perform principal component analysis (PCA) on a suitably normalized and transformed expression matrix and then plot the samples’ first two principal components as a scatter plot. Of course, PCA has more uses than just providing such an overview plot (see <xref rid="GR251447OVCC33" ref-type="bibr">Ringnér 2008</xref> for a primer), but nevertheless, the user's expectation is often simply that samples with a similar expression profile should appear close together (“cluster together”), while samples with strong differences should appear farther apart. PCA's popularity in biology notwithstanding, the literature offers many methods designed specifically with this goal in mind, with the best-known classic examples perhaps being classical multidimensional scaling (classical MDS, also known as principal coordinate analysis, PCoA), Kruskall's nonmetric multidimensional scaling (<xref rid="GR251447OVCC22" ref-type="bibr">Kruskal 1964</xref>), and Kohonen's self-organizing maps (SOM) (<xref rid="GR251447OVCC20" ref-type="bibr">Kohonen 1982</xref>).</p>
  <p>The recent rapid progress of single-cell RNA-seq methods, now enabling the measurement of expression profiles of thousands of individual cells in a sample, has renewed biologists’ interest in dimension-reduction methods. Here, t-Distributed Stochastic Neighbor Embedding (t-SNE) (<xref ref-type="fig" rid="GR251447OVCF1">Fig. 1</xref>; <xref rid="GR251447OVCC40" ref-type="bibr">van der Maaten and Hinton 2008</xref>) has become a de facto standard, with Uniform Manifold Approximation and Projection (UMAP) (<xref rid="GR251447OVCC25" ref-type="bibr">McInnes et al. 2018</xref>) currently gaining popularity as an alternative. Other dimension-reduction methods, developed specifically for single-cell RNA-seq, include <italic>destiny</italic> (<xref rid="GR251447OVCC1" ref-type="bibr">Angerer et al. 2016</xref>) (a method based on diffusion maps [<xref rid="GR251447OVCC14" ref-type="bibr">Coifman and Lafon 2006</xref>]), the Monocle methods (<xref rid="GR251447OVCC37" ref-type="bibr">Trapnell et al. 2014</xref>; <xref rid="GR251447OVCC31" ref-type="bibr">Qiu et al. 2017</xref>), DDRTree (<xref rid="GR251447OVCC24" ref-type="bibr">Mao et al. 2015</xref>), and more. (See <xref rid="GR251447OVCC28" ref-type="bibr">Nguyen and Holmes 2019</xref> for a recent review.)</p>
  <fig id="GR251447OVCF1" orientation="portrait" position="float">
    <label>Figure 1.</label>
    <caption>
      <p>Example of a t-SNE plot: These are cord-blood mononuclear cells studied by <xref rid="GR251447OVCC36" ref-type="bibr">Stoeckius et al. (2017)</xref>. The embedding and the assignment of cell types have been taken from the Seurat (<xref rid="GR251447OVCC10" ref-type="bibr">Butler et al. 2018</xref>) tutorial that uses this data set as an example (<xref rid="GR251447OVCC34" ref-type="bibr">Satija Lab 2018</xref>).</p>
    </caption>
    <graphic xlink:href="749f01"/>
  </fig>
  <p>These varied methods have been developed with different design goals: For example, some methods strive to primarily preserve neighborhood; others, to represent the overall structure or larger-scale relations. Nevertheless, when using any of them in the field of single-cell transcriptomics, practitioners’ primary expectation is usually that cells depicted close to each other or within the same apparent structure or cluster have more or less similar expression profiles, while cells depicted in different regions of the plot or in different structures are more different. In other words, it is the preservation of neighborhood relationships that is of importance. The term “neighborhood” should here be understood as follows: We consider a high-dimensional space, the so-called feature space, in which each dimension corresponds to one gene and each cell is represented by a point, whose coordinates along the many dimensions are given by the expression strength of the corresponding gene. Two cells with a similar expression profile will hence have similar coordinates and thus will be close to each other in feature space. Around each cell, we can imagine a hypersphere of nearby points, and consider all cells within the hypersphere as neighbors.</p>
  <p>Any attempt to provide a two-dimensional representation of the neighborhood relations in this high-dimensional space will have to face what <xref rid="GR251447OVCC40" ref-type="bibr">van der Maaten and Hinton (2008)</xref> called the “crowding problem.” The volume of a high-dimensional sphere is exponentially larger than the area of a two-dimensional circle, and therefore, a cell can easily have many more close neighbors in feature space than cells can be drawn within a sufficiently small circle around the point representing the cell in two-dimensional space.</p>
  <p>This is, of course, not the only obstacle in achieving a faithful two-dimensional representation of feature space, and the many possible kinds of distortions have been widely discussed in the literature (see, e.g., <xref rid="GR251447OVCC2" ref-type="bibr">Aupetit 2007</xref> and <xref rid="GR251447OVCC19" ref-type="bibr">Kaski et al. 2003</xref>). In single-cell sequencing, it is, however, of particular relevance: Given a dimension-reduced representation such as a t-SNE or UMAP embedding, how can we know for a specific cell of interest how far its neighborhood reaches? Knowing this is of paramount importance for correctly interpreting an embedding.</p>
  <sec sec-type="results" id="s1">
    <title>Results</title>
    <sec id="s1a">
      <title>The Sleepwalk app</title>
      <p>Here, we present Sleepwalk, an interactive tool that provides an intuitive solution to the task just outlined.</p>
      <p>It works as follows: The user provides an embedding, that is, the two-dimensional coordinates output by a dimension-reducing method, as well as information on the distances between cells in feature space in some suitable metric or their coordinates in an appropriately transformed feature space. Whenever the user moves the mouse cursor over a cell, all cells are colored according to their distance to this cell in feature space, thus indicating the cell's closest neighbors with the strongest color (<xref ref-type="fig" rid="GR251447OVCF2">Fig. 2</xref>A–C). By moving the mouse over all the cells in the plot, the user can hence quickly obtain an intuitive overview of how neighborhood may have been rendered differently in different regions of the plot. Buttons are provided to adjust the color scale so that the user can choose which feature space distance should be considered as “close neighborhood” and hence given the strong (dark, green) colors.</p>
      <fig id="GR251447OVCF2" orientation="portrait" position="float">
        <label>Figure 2.</label>
        <caption>
          <p>The Sleepwalk app, being used to explore the t-SNE rendition of the cord-blood data set from <xref ref-type="fig" rid="GR251447OVCF1">Figure 1</xref>. The plots here are snapshots of a running Sleepwalk app; a live version can be found at <uri xlink:href="https://anders-biostat.github.io/sleepwalk/supplementary/">https://anders-biostat.github.io/sleepwalk/supplementary/</uri>. The red arrow shows the current mouse position. (<italic>A</italic>) By moving the mouse cursor through the embedding, we find, for example, that the CD4<sup>+</sup> T cell cluster is very tight and homogeneous, as can be seen from the fact that all cells show a color indicating that they are all close to each other. (<italic>B</italic>) The monocyte cluster, in contrast, shows much more heterogeneity, when comparing the coloring at the same color scale: Now only a few monocytes are colored green and are hence as similar to the cell under the mouse cursor as most of the T cells were in <italic>A</italic>. (<italic>C</italic>) Placing the mouse on this small tip of the monocyte cluster reveals that the cells there are more similar to the T cells than to the other monocytes, indicating that the cluster boundary might be inaccurate in both the t-SNE rendition and the SNN clustering (<xref rid="GR251447OVCC41" ref-type="bibr">Waltman and van Eck 2013</xref>) on which the Seurat workflow's cell-type assignment is based. (<italic>D</italic>) With the color scale set to a wider distance range, we can assess similarities between clusters: As expected, B cells are somewhat similar to T cells, less so to NK cells and monocytes, and distant to erythrocytes and the spiked-in mouse cells.</p>
        </caption>
        <graphic xlink:href="749f02"/>
      </fig>
      <p>We invite the reader to pause here and try Sleepwalk himself or herself. At <uri xlink:href="https://anders-biostat.github.io/sleepwalk/supplementary/">https://anders-biostat.github.io/sleepwalk/supplementary/</uri> (and also in this paper's <ext-link ext-link-type="uri" xlink:href="http://genome.cshlp.org/lookup/suppl/doi:10.1101/gr.251447.119/-/DC1">Supplemental HTML</ext-link>), live interactive Sleepwalk renditions of <xref ref-type="fig" rid="GR251447OVCF2">Figure 2</xref> (and also of all the subsequent figures discussed below) are given. The Sleepwalk app runs in any Javascript-enabled web browser; that is, it suffices to open the page or file in a browser, without the need to install anything.</p>
    </sec>
    <sec id="s1b">
      <title>Exploring an embedding</title>
      <p>Sleepwalk makes aspects visible that are not apparent from a dimension reduction alone. For example, the two large clusters under the cursor in <xref ref-type="fig" rid="GR251447OVCF2">Figure 2</xref>, A and B, have quite different characteristics. In the T cell cluster (<xref ref-type="fig" rid="GR251447OVCF2">Fig. 2</xref>A), most of the cells are very close to each other: The cluster shows up as a large green cloud no matter where one points the mouse. The monocyte cluster (<xref ref-type="fig" rid="GR251447OVCF2">Fig. 2</xref>B), however, spreads over larger distances: Only a part shows up in green, which “follows” the mouse. In a static t-SNE plot (such as <xref ref-type="fig" rid="GR251447OVCF1">Fig. 1</xref>), this cannot be seen.</p>
      <p>We can also check the cluster borders and discover, for instance (<xref ref-type="fig" rid="GR251447OVCF2">Fig. 2</xref>C), that some cells in the monocyte cluster are more similar to those in the T cell cluster than to those in their own cluster. They may have been assigned the wrong cell type or might be doublets. Thus, the Sleepwalk exploration can alert the analyst to the need for further investigation of possibly misleading features of a dimension-reduced embedding.</p>
      <p>In <xref ref-type="fig" rid="GR251447OVCF2">Figure 2</xref>, A through C, the color scale was left at the automatically chosen range of only very small distances. When switching the color scale to a wider distance range, we can also see here how relationships <italic>between</italic> clusters (<xref ref-type="fig" rid="GR251447OVCF2">Fig. 2</xref>D) appear in the supplied distance values: We see which clusters are more and which are less similar to each other—information that a static t-SNE does not show, due to the method's design focus on faithful representation only of neighborhoods. Care is needed here, however: Once the considered distances exceed what one might consider as “close neighborhood,” the choice of distance metric used will strongly influence interpretability of the visualization, as we discuss below.</p>
    </sec>
    <sec id="s1c">
      <title>Feature space distances</title>
      <p>The colors in Sleepwalk are meant to indicate similarity or dissimilarity between the cells’ expression profiles, quantified as distances. There are multiple suggestions for useful distance measures in the literature, and the users can provide whichever they prefer. To produce the t-SNE embedding in <xref ref-type="fig" rid="GR251447OVCF1">Figure 1</xref>, we followed the Seurat workflow (<xref rid="GR251447OVCC34" ref-type="bibr">Satija Lab 2018</xref>), which calculates distances in a specific manner (Methods), and these are then also used by the t-SNE routine. We have also used these same distances to color the points in the Sleepwalk rendition (<xref ref-type="fig" rid="GR251447OVCF2">Fig. 2</xref>), thus allowing us to see directly where t-SNE succeeded and where it failed in its design goal of preserving the neighborhood relation in its input data.</p>
      <p>t-SNE uses a flexible approach to define the distance scale over which cells are considered neighbors: It adjusts the distance scale for each cell such that all cells have approximately the same number of neighbors (the so-called perplexity). Sleepwalk, in contrast, uses a fixed distance scale. This is on purpose: It allows us to note where the neighborhood has longer or shorter range (as shown in the comparison of <xref ref-type="fig" rid="GR251447OVCF2">Fig. 2</xref>, A and B). The app offers two buttons to increase or decrease the scale of the distance-to-color mapping, allowing the user to manually choose what distance should be considered as close.</p>
    </sec>
    <sec id="s1d">
      <title>Comparing embeddings</title>
      <p>With the availability of choice in dimension-reduction methods, the question arises of which one to use. Benchmark comparisons may address this question in general; see, for example, <xref rid="GR251447OVCC5" ref-type="bibr">Becht et al. (2019)</xref> for a comparison of UMAP with t-SNE and related methods. When working on a specific data set, however, simply calculating multiple embeddings and comparing them side by side might be even more helpful. We demonstrate this here using data from a study of the development of the mouse cerebellum (<xref rid="GR251447OVCC11" ref-type="bibr">Carter et al. 2018</xref>). In <xref ref-type="fig" rid="GR251447OVCF3">Figure 3</xref>, we show cells from development time point E13.5, first visualized with t-SNE (<xref ref-type="fig" rid="GR251447OVCF3">Fig. 3</xref>A), then with UMAP (<xref ref-type="fig" rid="GR251447OVCF3">Fig. 3</xref>B). The live apps in the <ext-link ext-link-type="uri" xlink:href="http://genome.cshlp.org/lookup/suppl/doi:10.1101/gr.251447.119/-/DC1">Supplemental HTML</ext-link> show, in addition to this, the same comparison for the cord-blood data of <xref ref-type="fig" rid="GR251447OVCF1">Figures 1</xref> and <xref ref-type="fig" rid="GR251447OVCF2">2</xref>.</p>
      <fig id="GR251447OVCF3" orientation="portrait" position="float">
        <label>Figure 3.</label>
        <caption>
          <p>Sleepwalk being used to compare two embeddings of the same single-cell data of a developing murine cerebellum at embryonal time point E13.5 (<xref rid="GR251447OVCC11" ref-type="bibr">Carter et al. 2018</xref>): t-SNE (<italic>A</italic>) and UMAP (<italic>B</italic>). The user can explore one embedding in the same way as in <xref ref-type="fig" rid="GR251447OVCF2">Figure 2</xref>, while all other embeddings that are displayed concurrently are “slaved” to the one under the mouse cursor: Each cell has the same color in all embeddings. The red arrow shows the current mouse position. A live version (for these data and for the cord-blood data) can be found in the <ext-link ext-link-type="uri" xlink:href="http://genome.cshlp.org/lookup/suppl/doi:10.1101/gr.251447.119/-/DC1">Supplemental HTML</ext-link> file.</p>
        </caption>
        <graphic xlink:href="749f03"/>
      </fig>
      <p>To compare the two embeddings, we need, at minimum, a way to see which points in the two plots correspond to the same cells. A classical approach is “brushing” (<xref rid="GR251447OVCC6" ref-type="bibr">Becker and Cleveland 1987</xref>): Selecting with the mouse, a group of adjacently depicted cells in one plot causes them to be highlighted in the other one, too. Sleepwalk adapts this idea, but instead of the usual brush, we simply use in all embeddings the same color for points corresponding to the same cell. Moving the mouse over points in one plot then highlights the neighborhood structure induced by the feature space distance chosen for that embedding not only there but also in all displayed embeddings and so links them. This allows us to see, for a structure in one embedding, whether there are corresponding structures in the other embeddings.</p>
      <p>In the example shown in <xref ref-type="fig" rid="GR251447OVCF3">Figure 3</xref>, we see a clear correspondence between the major structures generated by t-SNE and by UMAP. Even the arrangement of cells within these structures is the same, which one can follow in the live version of the app. There are, however, also differences: The cells at the mouse position in <xref ref-type="fig" rid="GR251447OVCF3">Figure 3</xref> are part of the connecting “filament” in the t-SNE embedding but lie in an external “protrusion” in the UMAP. Further exploration in the live version of <xref ref-type="fig" rid="GR251447OVCF3">Figure 3</xref> can suggest that UMAP forced the two branches to intersect while still trying to repel cells of different lineages away from each other (note the gap between cells in the highlighted branch in <xref ref-type="fig" rid="GR251447OVCF3">Fig. 3</xref>B). This is another example of the dimensionality reduction artifacts that are hard to notice from a static image but can be uncovered with Sleepwalk.</p>
    </sec>
    <sec id="s1e">
      <title>Comparing samples</title>
      <p>Until recently, most single-cell RNA-seq studies analyzed only a single sample comprising many cells. Yet, the full value of the technique might become apparent only when it is used to compare many samples. One currently popular approach to do so visually is to simply combine the data from the cells of all samples into one large expression matrix and perform t-SNE or UMAP on this. Often, global differences between samples, typically due to technical effects (<xref rid="GR251447OVCC38" ref-type="bibr">Tung et al. 2017</xref>), will prevent similar cells from different samples from appearing in the same cluster or structure in the dimension-reduced embedding. Methods to automatically remove such sample-to-sample differences (e.g., the CCA-based method in <xref rid="GR251447OVCC10" ref-type="bibr">Butler et al. 2018</xref> and the MNN method in <xref rid="GR251447OVCC18" ref-type="bibr">Haghverdi et al. 2018</xref>) address this issue but will not work always and may risk also removing the biological signal.</p>
      <p>A visual alternative is to produce a dimension-reduced embedding separately for each sample and then try to find correspondences between the features in these. In <xref ref-type="fig" rid="GR251447OVCF4">Figure 4</xref>, we show how Sleepwalk allows one to perform such an exploration comparing UMAP renderings for the two E13.5 and one of the E14.5 samples of the mouse cerebellum data set. Exploring the data with the mouse shows the two replicas of E13.5 samples (<xref ref-type="fig" rid="GR251447OVCF4">Fig. 4</xref>A,B) are almost identical. The two branches (GABAergic and glutamatergic neurons) can be easily followed from the early progenitor cells up to the most differentiated ones. Comparing between the two E13.5 replicates reveals which aspects of the peculiar two-pronged shape of the glutamatergic branch are simply due to random variation and what seems reproducible. In the later E14.5 sample (<xref ref-type="fig" rid="GR251447OVCF4">Fig. 4</xref>C), the branches have disconnected from the progenitor cells, but Sleepwalk allows us to still identify corresponding cells. Sleepwalk can show that the GABAergic lineage is differentiated further in the E14.5 than in E13.5 samples, as the endpoint of the branch in E14.5 corresponds to an intermediate point in E13.5. Sleepwalk allows one to discover such details immediately, with minimal effort. Of course, such a visual exploration cannot replace a tailored detailed analysis, but it does provide a starting point and a first overview.</p>
      <fig id="GR251447OVCF4" orientation="portrait" position="float">
        <label>Figure 4.</label>
        <caption>
          <p>Sleepwalk in multisample mode, comparing three samples of a developing murine cerebellum: two samples of two different mice embryos at time point E13.5 (<italic>A</italic>,<italic>B</italic>) and the third (<italic>C</italic>) from E14.5. The red arrow shows the current mouse position. The dashed gray lines roughly indicate two different lineages and their common progenitor cells (expression of the marker genes that we used to draw the boundaries is shown in <ext-link ext-link-type="uri" xlink:href="http://genome.cshlp.org/lookup/suppl/doi:10.1101/gr.251447.119/-/DC1">Supplemental Fig. S1</ext-link>). By following the GABAergic branch, one can notice that its very tip in the E13.5 samples corresponds to cells in the middle of the branch in E14.5, indicating that the cells have differentiated further during the elapsed day.</p>
        </caption>
        <graphic xlink:href="749f04"/>
      </fig>
      <p>Crucially, using Sleepwalk's multisample comparison mode does not require any removal of global sample-to-sample differences with batch-effect correction methods. If the user selects a cell with the mouse in one sample, the cells that are similar to it will be highlighted, both in the same sample as well as in all other samples. This works even if the cells in the other samples seem more distant, due to the additional sample-to-sample distance; we might only need to increase the scale of the distance-to-color mapping for the cross-sample comparisons.</p>
    </sec>
    <sec id="s1f">
      <title>Comparing distance metrics</title>
      <p>In the examples discussed so far, we have always colored cells according to the default distance calculated by the Seurat workflow, namely the Euclidean distance in the space spanned by the first few principal components according to a PCA performed after certain preprocessing. The reason for this was not that this specific distance metric should be considered more correct or more “true” than any of the alternatives discussed in the literature but simply because it is the distance metric that has been used as input to t-SNE and UMAP when calculating the discussed embeddings.</p>
      <p>While this specific distance metric is popular due to its appearing in standard workflows such as Seurat's, this is, of course, no reason to consider it as more correct or “true” than possible alternatives or modifications. For instance, we may either choose to use all genes in the distance calculation or only some genes, which may either be chosen for having high expression or high signal-to-noise ratio, or perhaps chosen, via manual curation, as especially informative with respect to cell type or state. We may use the genes as they are or aggregate them before into meta- or eigen-genes, for example, by a principal component analysis (as done in the Seurat workflow). The way the expression data have been transformed, normalized, or preprocessed can be understood as part of the choice of distance metric. The last, but not the least, choice is, of course, the metric itself. There are numerous ways to calculate distances from the selected and possibly preprocessed set of features. Besides Euclidean, one can calculate angular (“cosine”) or correlation distance or use kernel functions (<xref rid="GR251447OVCC30" ref-type="bibr">Phillips and Venkatasubramanian 2011</xref>), as has been done, for instance, in <xref rid="GR251447OVCC42" ref-type="bibr">Wang et al. (2017)</xref>. Metrics can even be learned to suit the specific task the researcher has in mind (<xref rid="GR251447OVCC44" ref-type="bibr">Yang and Jin 2006</xref>). Dimensionality reduction techniques are typically based on the assumption that, in feature space, cells are located on the surface of a smooth manifold. The methods attempt to learn the manifold and then to replace the original distance with the geodesic one (i.e., distance within the manifold) (<xref rid="GR251447OVCC12" ref-type="bibr">Cayton 2005</xref>; <xref rid="GR251447OVCC27" ref-type="bibr">Moon et al. 2018</xref>). Diffusion distances (<xref rid="GR251447OVCC14" ref-type="bibr">Coifman and Lafon 2006</xref>) are a popular way of obtaining a manifold-following distance in a simple and efficient manner.</p>
      <p>Some of these metrics may yield similar results; others can drastically change cell-to-cell distances. In order to account for the choice of metric, Sleepwalk offers a variant to the mode for comparing embeddings described above, in which points that correspond to the same cell will get different colors in different panels of the app, each showing the same embedding but having a different distance matrix assigned to it. By hovering the mouse over a cell, the user can see how the cell neighborhoods differ between the distance metrics.</p>
      <p><xref ref-type="fig" rid="GR251447OVCF5">Figure 5</xref> shows Sleepwalk in the distance comparison mode. The live version of this figure can be found in the <ext-link ext-link-type="uri" xlink:href="http://genome.cshlp.org/lookup/suppl/doi:10.1101/gr.251447.119/-/DC1">Supplemental Material</ext-link>. Once again, we use the murine cerebellum data set (specifically, stage E13.5, visualized with UMAP) as an example. As before, we used the 2131 genes chosen by the Seurat workflow as “variable,” and then calculated distance matrices using four metrics: (1) Euclidean distance based directly on the normalized and logarithmized expressions of these genes (<xref ref-type="fig" rid="GR251447OVCF5">Fig. 5</xref>A); (2) Euclidean distance in the space spanned by the first 50 principal components of a PCA performed using the variable genes (<xref ref-type="fig" rid="GR251447OVCF5">Fig. 5</xref>B); (3) diffusion distance based directly on the genes’ expression (<xref ref-type="fig" rid="GR251447OVCF5">Fig. 5</xref>C); or (4) on the first 50 principal components (<xref ref-type="fig" rid="GR251447OVCF5">Fig. 5</xref>D). As expected, Euclidean distance calculated on all variable genes (<xref ref-type="fig" rid="GR251447OVCF5">Fig. 5</xref>A) is almost useless when applied to so many dimensions. Most of the distances are condensed around some median value, making it almost impossible to distinguish any patterns in the data. However, all other distances (<xref ref-type="fig" rid="GR251447OVCF5">Fig. 5</xref>B–D) are already good enough to see the two developmental branches, with perhaps the diffusion distance separating them most clearly.</p>
      <fig id="GR251447OVCF5" orientation="portrait" position="float">
        <label>Figure 5.</label>
        <caption>
          <p>Metric comparison using Sleepwalk. All four panels now show the same embedding: a UMAP visualization of the E13.5 sample of murine cerebellum. The cells are now colored based on four different metrics: Euclidean distance based directly on the normalized and logarithmized genes’ expressions (<italic>A</italic>); Euclidean distance in the space spanned by the first 50 principal components of a PCA performed using the variable genes (<italic>B</italic>); diffusion distance based directly on the genes’ expression (<italic>C</italic>) or on the first 50 principal components (<italic>D</italic>). The red arrow shows the current mouse position, which is on the intersection of GABAergic and glutamatergic lineages. Color scales were adjusted so that they roughly stretch along the entire selected branch. The spread of coloring onto the other developmental branch shows how good the metric is in separating the two lineages.</p>
        </caption>
        <graphic xlink:href="749f05"/>
      </fig>
      <p>In the live version in the <ext-link ext-link-type="uri" xlink:href="http://genome.cshlp.org/lookup/suppl/doi:10.1101/gr.251447.119/-/DC1">Supplemental HTML</ext-link> file, we also demonstrate a metric comparison using the cord-blood data set. There, the difference in the metrics does not lie in the details of its calculation but stems from using different input data, as each cell has been assessed in two modalities, and distances are calculated either from the single-cell RNA-seq or from the single-cell proteomics (CITE-Seq epitome) aspect of the data.</p>
      <p>One should keep in mind that, in the example of <xref ref-type="fig" rid="GR251447OVCF5">Figure 5</xref>, we are comparing the four metrics not just to each other but also to the fifth one: the distance that was used to generate the embedding. UMAP is one of the manifold learning dimensionality reduction techniques, and as such it might be more similar to diffusion distances than to the Euclidean metric, even though the Euclidean distance in PCA space (distance [2]) was used as input for the UMAP process. Taking this together, one might expect the combination of diffusion distance and PCA to correspond especially well with the embedding. Which of the four metrics, however, should be considered “best” is a completely different question, as the suitability of metric will depend on the task at hand. While a metric can be effective in separating specific cell types, it might at the same time fail to arrange cells by their cell cycle stage (<xref rid="GR251447OVCC9" ref-type="bibr">Buettner et al. 2015</xref>), and this can be considered a good or a bad thing, depending on whether differences due to cell cycle are considered a nuisance or a topic of interest in one's experiment. We therefore do not wish to provide opinions or guidance on this question in the present paper. What Sleepwalk does offer here is a means to explore differences between metrics and embeddings and understand them, not necessarily to perform benchmarks. Once a researcher is aware of such differences, it is up to him or her to decide if they affect data interpretation.</p>
    </sec>
    <sec id="s1g">
      <title>Beyond single-cell transcriptomics</title>
      <p>In all the examples discussed so far, the points correspond to individual cells in samples assessed with single-cell transcriptomics. Another important use for dimension-reduction methods is for large-scale studies comprising dozens or even hundreds of samples. <xref rid="GR251447OVCC8" ref-type="bibr">Brawand et al. (2011)</xref>, for example, describe a collection of 131 bulk RNA-seq data sets comparing organ samples from several species and provide an overview PCA plot as their <xref ref-type="fig" rid="GR251447OVCF1">Figure 1</xref>; <xref rid="GR251447OVCC15" ref-type="bibr">Dietrich et al. (2018)</xref> use a t-SNE plot to illustrate similarities and differences between their 246 blood cancer samples. Clearly, Sleepwalk can also be useful to explore dimension-reduced embeddings arising in such applications.</p>
      <p>Research on dimension reduction originated in the machine learning field, with the original applications being the study of training data for machine learning applications. Of course, in this area, as well as in other applications of dimension reduction, Sleepwalk should also prove useful.</p>
    </sec>
    <sec id="s1h">
      <title>Usage</title>
      <p>Sleepwalk is provided as a package for the statistical programming language R (<xref rid="GR251447OVCC32" ref-type="bibr">R Core Team 2019</xref>). The main function of the package is also called “sleepwalk.” The user provides it with the 2D coordinates for each object (cell) in the embedding and a square matrix of cell-to-cell distances, or, alternative to the latter, a data matrix from which sleepwalk can calculate Euclidean or angular distances. For both these parameters, the user can also supply multiple matrices in order to display multiple embeddings concurrently for comparison. This can be done either such that each embedding represents the same objects (as in <xref ref-type="fig" rid="GR251447OVCF3">Fig. 3</xref>) or that each embedding represents a different set of objects but distances are given also between objects in different embeddings (as in <xref ref-type="fig" rid="GR251447OVCF4">Fig. 4</xref>).</p>
      <p>Sleepwalk can easily be used in combination with other single-cell analysis frameworks. Visualizing, for example, a Seurat data object can be done with one line of code, as explained on the documentation web page.</p>
      <p>By default, the sleepwalk function displays the visualization app in a web browser. Alternatively, it can also write it into an HTML file, which can then be opened with any web browser without the need of having R or the Sleepwalk package running or even installed. This is useful when an analyst wishes to share a Sleepwalk visualization with colleagues or provide it on a web page or in a paper supplement.</p>
      <p>For a description of further options of the function, please see the documentation.</p>
      <p>The app offers a “lasso” functionality: The user can encircle a group of points with the mouse, and the indices of these points are then reported back to the R session, where they can be queried with a callback function. This is helpful if the analyst spots an interesting set of cells while exploring an embedding and wishes to perform further analysis on them.</p>
      <p>We also mention the “slw_snapshot” function, which produces static plots, like the figures in this paper.</p>
    </sec>
  </sec>
  <sec sec-type="discussion" id="s2">
    <title>Discussion</title>
    <p>Dimension-reduced embeddings such as those provided by t-SNE and UMAP have become a core tool in single-cell transcriptomics. They provide an overview of a study, help to check for expected and unexpected features in the data, and allow researchers to form new hypotheses and to plan and organize the subsequent analysis. As they generally contain artifacts, a common concern is that these plots may be overinterpreted.</p>
    <p>Dimension reduction is a research area with a rich history, long predating the use of these techniques for single-cell biology. The issue with distortions has long been discussed, with the possible distortions being classified (e.g., <xref rid="GR251447OVCC2" ref-type="bibr">Aupetit 2007</xref>) and quantified (e.g., <xref rid="GR251447OVCC19" ref-type="bibr">Kaski et al. 2003</xref>), and advice on careful interpretation derived from these (e.g., <xref rid="GR251447OVCC43" ref-type="bibr">Wattenberg et al. 2016</xref>). To visually alert the viewer to distortions, some authors have suggested to color each point by its so-called stress, that is, the deviation of the point's on-screen distance to the other points from the distances in feature space (<xref rid="GR251447OVCC35" ref-type="bibr">Seifert et al. 2010</xref>) and others to color the area around the points according to the amount of compression or stretching that the manifold underwent locally due to projection (<xref rid="GR251447OVCC23" ref-type="bibr">Lespinats and Aupetit 2011</xref>).</p>
    <p>Such visualizations are useful tools for developing and improving dimension-reducing methods. Our approach, however, offers a novel aspect that is crucial: Rather than merely alerting the user to distortions, Sleepwalk allows the user to directly see the underlying “truth” for the selected cell. This is possible due to our use of interactivity: By allowing the user to rapidly move focus from cell to cell and the app instantly following in redrawing the colors, we are effectively escaping the confines of a two-dimensional representation (or, three-dimensional, if we also count static coloring as a dimension).</p>
    <p>We have shown how this novel approach gives insights into dimension-reduced embeddings that would otherwise stay hidden and thus solves a core problem in the practical use of dimension reduction methods. We envision that Sleepwalk will be used in two manners: first, as a tool of exploratory data analysis, helping researchers to better understand their data; and second, as a reporting and communication tool, allowing researchers to present their results in a more transparent way. For this latter application, Sleepwalk's ability to produce stand-alone HTML pages is crucial, as these pages can then be used, for example, as supplements to publications, where they allow readers to check embeddings themselves, without the need to install any software.</p>
    <p>We should be clear that a visual, interactive data exploration with Sleepwalk does not replace formal inference but complements or typically precedes it. Once one has formed a hypothesis about one's data using Sleepwalk, one should employ suitable formal analysis methods, such as statistical hypotheses tests, to confirm them. That analysis will then typically be done on the full, high-dimensional data. Dimension reduction methods are data reduction methods: This sacrifice of data is done to allow for visual inspection but is a hindrance for any numerical analysis.</p>
    <p>The principle of Sleepwalk is useful not only for inspection of a single data set but also lends itself for generalization to comparative tasks. We have shown several possible modes of comparison: between different embeddings of the same data; between embeddings from several samples; and between different ways of preprocessing the data and obtaining distances. The comparison between samples will find direct application in any study working with multiple samples; the other two are useful in method selection and in method development, as they allow for comparison of data processing pipelines.</p>
    <p>We therefore expect that Sleepwalk will find broad use, not only in single-cell transcriptomics, but essentially in all instances of big data where experimental units (cells, samples, or the like) are described in a high-dimensional feature space.</p>
  </sec>
  <sec sec-type="methods" id="s3">
    <title>Methods</title>
    <sec id="s3a">
      <title>Sleepwalk implementation</title>
      <p>Sleepwalk is written in JavaScript, using the D3.js data visualization framework (<xref rid="GR251447OVCC7" ref-type="bibr">Bostock et al. 2011</xref>). JavaScript was chosen because it is available on all common platforms, usually without the need to install anything, thus enabling the standalone HTML feature, because writing the app with D3.js was convenient, and because the JavaScript engines of most web browsers offer very good performance, enabling smooth rendering of the color changes and thus the instant interactive feedback that is required to provide an intuitive user experience.</p>
      <p>A thin wrapper of R code around the JavaScript code turns Sleepwalk into an R package, allowing for convenient integration into currently popular workflows for single-cell analysis like Seurat. We use the <uri xlink:href="httpuv">httpuv</uri> R package (<uri xlink:href="https://CRAN.R-project.org/package=httpuv">https://CRAN.R-project.org/package=httpuv</uri>) to bridge between the R session and the web browser. It sets up a simple local server to serve the app to the browser and then uses its implementation of the WebSocket protocol (<xref rid="GR251447OVCC16" ref-type="bibr">Fette and Melnikov 2011</xref>) to keep open a communication channel between the R session and web browser. This allows the app to report back to the R session when the user has selected points using the lasso feature or to make snapshots and change the state of the app from an R session.</p>
      <p>The color scheme used to depict distances is the “cubehelix” palette, a color map originally developed for astronomy and optimized for good visual separation between levels throughout its dynamic range (<xref rid="GR251447OVCC17" ref-type="bibr">Green 2011</xref>).</p>
    </sec>
    <sec id="s3b">
      <title>Example data</title>
      <sec id="s3b1">
        <title>Cord-blood data set</title>
        <p>The cord-blood data from <xref rid="GR251447OVCC36" ref-type="bibr">Stoeckius et al. (2017)</xref> are available at the NCBI Gene Expression Omnibus (GEO; <uri xlink:href="https://www.ncbi.nlm.nih.gov/geo/">https://www.ncbi.nlm.nih.gov/geo/</uri>) via accession number GSE100866. The raw UMI counts were processed following the Seurat workflow proposed for exactly this data set (<xref rid="GR251447OVCC34" ref-type="bibr">Satija Lab 2018</xref>). Data were normalized and log-transformed, and 976 variable genes were detected with y.cutoff = 0.5. These genes were scaled and used for principle component analysis. For further analysis, the first 13 principal components were used, which explain around 23% of the total variance. The t-SNE (<xref ref-type="fig" rid="GR251447OVCF1">Figs. 1</xref>, <xref ref-type="fig" rid="GR251447OVCF2">2</xref>; <ext-link ext-link-type="uri" xlink:href="http://genome.cshlp.org/lookup/suppl/doi:10.1101/gr.251447.119/-/DC1">Supplemental HTML</ext-link>) and UMAP (<xref ref-type="fig" rid="GR251447OVCF2">Fig. 2</xref>; <ext-link ext-link-type="uri" xlink:href="http://genome.cshlp.org/lookup/suppl/doi:10.1101/gr.251447.119/-/DC1">Supplemental HTML</ext-link>) embeddings were calculated using the default functions from the Seurat package, which used for clustering the algorithm by <xref rid="GR251447OVCC41" ref-type="bibr">Waltman and van Eck (2013)</xref>. The assignments of cell types to clusters were taken, too, from the Seurat tutorial workflow (<xref rid="GR251447OVCC34" ref-type="bibr">Satija Lab 2018</xref>). Normalized and log-transformed epitome data were used to calculate Euclidean distances for the distance comparison (see <ext-link ext-link-type="uri" xlink:href="http://genome.cshlp.org/lookup/suppl/doi:10.1101/gr.251447.119/-/DC1">Supplemental Code</ext-link>). The resulting Seurat object can be downloaded from Figshare (doi:10.6084/m9.figshare.7908059).</p>
      </sec>
      <sec id="s3b2">
        <title>Murine cerebellum data set</title>
        <p>The raw sequence data from <xref rid="GR251447OVCC11" ref-type="bibr">Carter et al. (2018)</xref> were downloaded from the European Nucleotide Archive (ENA; <uri xlink:href="https://www.ebi.ac.uk/ena">https://www.ebi.ac.uk/ena</uri>) under accession number PRJEB23051. The reads were aligned and counted using the Cell Ranger (10x Genomics, 2019; <uri xlink:href="https://support.10xgenomics.com/single-cell-gene-expression/software/pipelines/latest/what-is-cell-ranger">https://support.10xgenomics.com/single-cell-gene-expression/software/pipelines/latest/what-is-cell-ranger</uri>) software (output files are accessible from Figshare, doi:10.6084/m9.fig share.7910483). Some genes and droplets were filtered out following the Methods section of <xref rid="GR251447OVCC11" ref-type="bibr">Carter et al. (2018)</xref>. We removed all the cells with more than 10% of all UMIs coming from mitochondrial genes. We then removed all ribosomal and mitochondrial genes. Finally, only cells that contain from 3500 to 15,000 UMIs were kept. Lastly, we omitted all genes with zero expression in all the cells. The filtered raw data were then used to create Seurat objects that can be found at Figshare, doi:10.6084/m9.figshare.7910483, or on GitHub, <uri xlink:href="https://github.com/anders-biostat/sleepwalk/tree/paper">https://github.com/anders-biostat/sleepwalk/tree/paper</uri>, in the “data” folder. We used Seurat to normalize and log-transform raw counts and find variable genes. The irlba R package (<xref rid="GR251447OVCC3" ref-type="bibr">Baglama and Reichel 2005</xref>; <uri xlink:href="https://CRAN.R-project.org/package=irlba">https://CRAN.R-project.org/package=irlba</uri>) was used to generate a PCA embedding of the data (each sample separately, only variable genes). The first 50 principal components were used for further analysis. To render a t-SNE embedding, we used the Rtsne package (<uri xlink:href="https://github.com/jkrijthe/Rtsne">https://github.com/jkrijthe/Rtsne</uri>), a wrapper around the code by <xref rid="GR251447OVCC39" ref-type="bibr">van der Maaten (2014)</xref>. The uwot package (<uri xlink:href="https://CRAN.R-project.org/package=uwot">https://CRAN.R-project.org/package=uwot</uri>) was used for UMAP embeddings. To calculate distances between cells from different samples (<xref ref-type="fig" rid="GR251447OVCF4">Fig. 4</xref>), we used the variable genes shared between all the samples and produced a PCA embedding for all the cells. Euclidean distances in the space defined by the first 50 principal components were used to color the points. To distinguish early progenitors from further differentiated cells of glutamatergic and GABAergic we used the following marker genes: <italic>Msx3</italic> for early progenitors, <italic>Meis2</italic> for the glutamatergic lineage, and <italic>Lhx5</italic> for the GABAergic lineage (<ext-link ext-link-type="uri" xlink:href="http://genome.cshlp.org/lookup/suppl/doi:10.1101/gr.251447.119/-/DC1">Supplemental Fig. S1</ext-link>). Contours in <xref ref-type="fig" rid="GR251447OVCF4">Figure 4</xref> are drawn to include around 90% of cells that express each of the markers above a certain threshold using the “geom_mark_ellipse” function of the ggforce package (<uri xlink:href="https://CRAN.R-project.org/package=ggforce">https://CRAN.R-project.org/package=ggforce</uri>).</p>
        <p>Calculation of diffusion distance in <xref ref-type="fig" rid="GR251447OVCF5">Figure 5</xref> is based on the <italic>destiny</italic> package by <xref rid="GR251447OVCC1" ref-type="bibr">Angerer et al. (2016)</xref>. We used internal functions of the package to find nearest neighbors, to calculate local diffusion scale parameters “sigma,” and to get initial transition probabilities. Then, we manually propagated the diffusion with 16 time steps and calculated resulting distances. All the related code is provided in the <ext-link ext-link-type="uri" xlink:href="http://genome.cshlp.org/lookup/suppl/doi:10.1101/gr.251447.119/-/DC1">Supplemental Material</ext-link>.</p>
      </sec>
    </sec>
  </sec>
  <sec id="s4">
    <title>Data access</title>
    <p>All data sets used in this paper were taken from published works and can be downloaded from the cited references (<xref rid="GR251447OVCC36" ref-type="bibr">Stoeckius et al. 2017</xref>; <xref rid="GR251447OVCC11" ref-type="bibr">Carter et al. 2018</xref>). While processing the data, we also stored intermediate steps that are now available at doi:<uri xlink:href="https://doi.org/10.6084/m9.figshare.7908059.v1">10.6084/m9.figshare.7908059.v1</uri> (CiteSeq data), doi:<uri xlink:href="https://doi.org/10.6084/m9.figshare.7910483.v1">10.6084/m9.figshare.7910483.v1</uri> (three single-cell samples of developing murine cerebellum), and doi:<uri xlink:href="https://doi.org/10.6084/m9.figshare.7910504.v2">10.6084/m9.figshare.7910504.v2</uri> (some of the 2D embeddings calculated for the Sleepwalk examples). Scripts to generate these files, all the figures in the paper, and interactive apps are available in the <ext-link ext-link-type="uri" xlink:href="http://genome.cshlp.org/lookup/suppl/doi:10.1101/gr.251447.119/-/DC1">Supplemental Material</ext-link> and on GitHub at <uri xlink:href="https://github.com/anders-biostat/sleepwalk/tree/paper">https://github.com/anders-biostat/sleepwalk/tree/paper</uri>. A demonstration HTML file is available in the <ext-link ext-link-type="uri" xlink:href="http://genome.cshlp.org/lookup/suppl/doi:10.1101/gr.251447.119/-/DC1">Supplemental Material</ext-link> and at <uri xlink:href="https://anders-biostat.github.io/sleepwalk/supplementary/">https://anders-biostat.github.io/sleepwalk/supplementary/</uri>. The “sleepwalk” R package is available on the Comprehensive R Archive Network (CRAN) at <uri xlink:href="https://cran.r-project.org/package=sleepwalk">https://cran.r-project.org/package=sleepwalk</uri>, released as open-source software under the GNU General Public License v3 (or later). Documentation, installation instructions, and examples for Sleepwalk can be found on the project web page at <uri xlink:href="https://anders-biostat.github.io/sleepwalk/">https://anders-biostat.github.io/sleepwalk/</uri>. The source code is available on GitHub (<uri xlink:href="https://github.com/anders-biostat/sleepwalk">https://github.com/anders-biostat/sleepwalk</uri>) and also in the <ext-link ext-link-type="uri" xlink:href="http://genome.cshlp.org/lookup/suppl/doi:10.1101/gr.251447.119/-/DC1">Supplemental Material</ext-link>.</p>
  </sec>
  <sec id="s5">
    <title>Competing interest statement</title>
    <p>The authors declare no competing interests.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material id="PMC_1" content-type="local-data">
      <caption>
        <title>Supplemental Material</title>
      </caption>
      <media mimetype="text" mime-subtype="html" xlink:href="supp_30_5_749__index.html"/>
      <media xlink:role="associated-file" mimetype="application" mime-subtype="x-zip-compressed" xlink:href="supp_gr.251447.119_Supplemental_HTML.zip"/>
      <media xlink:role="associated-file" mimetype="application" mime-subtype="msword" xlink:href="supp_gr.251447.119_Supplemental_Figure_S1.docx"/>
      <media xlink:role="associated-file" mimetype="application" mime-subtype="x-zip-compressed" xlink:href="supp_gr.251447.119_Supplemental_Code.zip"/>
      <media xlink:role="associated-file" mimetype="application" mime-subtype="x-zip-compressed" xlink:href="supp_gr.251447.119_Supplemental_tar.gz"/>
    </supplementary-material>
  </sec>
</body>
<back>
  <ack>
    <title>Acknowledgments</title>
    <p>We thank Kevin Leiss for helpful discussions and assistance in preprocessing the cerebellum data with CellRanger. This work was funded by the Deutsche Forschungsgemeinschaft (DFG) via the collaborative research centres SFB 1036 (project no. 201348542) and SFB 1366 (project no. 394046768).</p>
  </ack>
  <fn-group>
    <fn fn-type="supplementary-material">
      <p>[Supplemental material is available for this article.]</p>
    </fn>
    <fn>
      <p>Article published online before print. Article, supplemental material, and publication date are at <ext-link ext-link-type="uri" xlink:href="http://www.genome.org/cgi/doi/10.1101/gr.251447.119">http://www.genome.org/cgi/doi/10.1101/gr.251447.119</ext-link>.</p>
    </fn>
  </fn-group>
  <ref-list>
    <title>References</title>
    <ref id="GR251447OVCC1">
      <mixed-citation publication-type="journal"><string-name><surname>Angerer</surname><given-names>P</given-names></string-name>, <string-name><surname>Haghverdi</surname><given-names>L</given-names></string-name>, <string-name><surname>Büttner</surname><given-names>M</given-names></string-name>, <string-name><surname>Theis</surname><given-names>FJ</given-names></string-name>, <string-name><surname>Marr</surname><given-names>C</given-names></string-name>, <string-name><surname>Buettner</surname><given-names>F</given-names></string-name>. <year>2016</year><article-title><italic>destiny</italic>: diffusion maps for large-scale single-cell data in R</article-title>. <source>Bioinformatics</source><volume>32</volume>: <fpage>1241</fpage>–<lpage>1243</lpage>. <pub-id pub-id-type="doi">10.1093/bioinformatics/btv715</pub-id><pub-id pub-id-type="pmid">26668002</pub-id></mixed-citation>
    </ref>
    <ref id="GR251447OVCC2">
      <mixed-citation publication-type="journal"><string-name><surname>Aupetit</surname><given-names>M</given-names></string-name>. <year>2007</year><article-title>Visualizing distortions and recovering topology in continuous projection techniques</article-title>. <source>Neurocomputing</source><volume>70</volume>: <fpage>1304</fpage>–<lpage>1330</lpage>. <pub-id pub-id-type="doi">10.1016/j.neucom.2006.11.018</pub-id></mixed-citation>
    </ref>
    <ref id="GR251447OVCC3">
      <mixed-citation publication-type="journal"><string-name><surname>Baglama</surname><given-names>J</given-names></string-name>, <string-name><surname>Reichel</surname><given-names>L</given-names></string-name>. <year>2005</year><article-title>Augmented implicitly restarted Lanczos bidiagonalization methods</article-title>. <source>SIAM</source><volume>27</volume>: <fpage>19</fpage>–<lpage>42</lpage>. <pub-id pub-id-type="doi">10.1137/04060593X</pub-id></mixed-citation>
    </ref>
    <ref id="GR251447OVCC5">
      <mixed-citation publication-type="journal"><string-name><surname>Becht</surname><given-names>E</given-names></string-name>, <string-name><surname>McInnes</surname><given-names>L</given-names></string-name>, <string-name><surname>Healy</surname><given-names>J</given-names></string-name>, <string-name><surname>Dutertre</surname><given-names>CA</given-names></string-name>, <string-name><surname>Kwok</surname><given-names>IW</given-names></string-name>, <string-name><surname>Ng</surname><given-names>LG</given-names></string-name>, <string-name><surname>Ginhoux</surname><given-names>F</given-names></string-name>, <string-name><surname>Newell</surname><given-names>EW</given-names></string-name>. <year>2019</year><article-title>Dimensionality reduction for visualizing single-cell data using UMAP</article-title>. <source>Nat Biotechnol</source><volume>37</volume>: <fpage>38</fpage>–<lpage>44</lpage>. <pub-id pub-id-type="doi">10.1038/nbt.4314</pub-id></mixed-citation>
    </ref>
    <ref id="GR251447OVCC6">
      <mixed-citation publication-type="journal"><string-name><surname>Becker</surname><given-names>RA</given-names></string-name>, <string-name><surname>Cleveland</surname><given-names>WS</given-names></string-name>. <year>1987</year><article-title>Brushing scatterplots</article-title>. <source>Technometrics</source><volume>29</volume>: <fpage>127</fpage>–<lpage>142</lpage>. <pub-id pub-id-type="doi">10.1080/00401706.1987.10488204</pub-id></mixed-citation>
    </ref>
    <ref id="GR251447OVCC7">
      <mixed-citation publication-type="journal"><string-name><surname>Bostock</surname><given-names>M</given-names></string-name>, <string-name><surname>Ogievetsky</surname><given-names>V</given-names></string-name>, <string-name><surname>Heer</surname><given-names>J</given-names></string-name>. <year>2011</year><article-title>D<sup>3</sup> data-driven documents</article-title>. <source>IEEE TransVisComput Graph</source><volume>17</volume>: <fpage>2301</fpage>–<lpage>2309</lpage>. <pub-id pub-id-type="doi">10.1109/TVCG.2011.185</pub-id></mixed-citation>
    </ref>
    <ref id="GR251447OVCC8">
      <mixed-citation publication-type="journal"><string-name><surname>Brawand</surname><given-names>D</given-names></string-name>, <string-name><surname>Soumillon</surname><given-names>M</given-names></string-name>, <string-name><surname>Necsulea</surname><given-names>A</given-names></string-name>, <string-name><surname>Julien</surname><given-names>P</given-names></string-name>, <string-name><surname>Csárdi</surname><given-names>G</given-names></string-name>, <string-name><surname>Harrigan</surname><given-names>P</given-names></string-name>, <string-name><surname>Weier</surname><given-names>M</given-names></string-name>, <string-name><surname>Liechti</surname><given-names>A</given-names></string-name>, <string-name><surname>Aximu-Petri</surname><given-names>A</given-names></string-name>, <string-name><surname>Kircher</surname><given-names>M</given-names></string-name>, <etal/><year>2011</year><article-title>The evolution of gene expression levels in mammalian organs</article-title>. <source>Nature</source><volume>478</volume>: <fpage>343</fpage>–<lpage>348</lpage>. <pub-id pub-id-type="doi">10.1038/nature10532</pub-id><pub-id pub-id-type="pmid">22012392</pub-id></mixed-citation>
    </ref>
    <ref id="GR251447OVCC9">
      <mixed-citation publication-type="journal"><string-name><surname>Buettner</surname><given-names>F</given-names></string-name>, <string-name><surname>Natarajan</surname><given-names>KN</given-names></string-name>, <string-name><surname>Casale</surname><given-names>FP</given-names></string-name>, <string-name><surname>Proserpio</surname><given-names>V</given-names></string-name>, <string-name><surname>Scialdone</surname><given-names>A</given-names></string-name>, <string-name><surname>Theis</surname><given-names>FJ</given-names></string-name>, <string-name><surname>Teichmann</surname><given-names>SA</given-names></string-name>, <string-name><surname>Marioni</surname><given-names>JC</given-names></string-name>, <string-name><surname>Stegle</surname><given-names>O</given-names></string-name>. <year>2015</year><article-title>Computational analysis of cell-to-cell heterogeneity in single-cell RNA-sequencing data reveals hidden subpopulations of cells</article-title>. <source>Nat Biotechnol</source><volume>33</volume>: <fpage>155</fpage>–<lpage>160</lpage>. <pub-id pub-id-type="doi">10.1038/nbt.3102</pub-id><pub-id pub-id-type="pmid">25599176</pub-id></mixed-citation>
    </ref>
    <ref id="GR251447OVCC10">
      <mixed-citation publication-type="journal"><string-name><surname>Butler</surname><given-names>A</given-names></string-name>, <string-name><surname>Hoffman</surname><given-names>P</given-names></string-name>, <string-name><surname>Smibert</surname><given-names>P</given-names></string-name>, <string-name><surname>Papalexi</surname><given-names>E</given-names></string-name>, <string-name><surname>Satija</surname><given-names>R</given-names></string-name>. <year>2018</year><article-title>Integrating single-cell transcriptomic data across different conditions, technologies, and species</article-title>. <source>Nat Biotechnol</source><volume>36</volume>: <fpage>411</fpage>–<lpage>420</lpage>. <pub-id pub-id-type="doi">10.1038/nbt.4096</pub-id><pub-id pub-id-type="pmid">29608179</pub-id></mixed-citation>
    </ref>
    <ref id="GR251447OVCC11">
      <mixed-citation publication-type="journal"><string-name><surname>Carter</surname><given-names>RA</given-names></string-name>, <string-name><surname>Bihannic</surname><given-names>L</given-names></string-name>, <string-name><surname>Rosencrance</surname><given-names>C</given-names></string-name>, <string-name><surname>Hadley</surname><given-names>JL</given-names></string-name>, <string-name><surname>Tong</surname><given-names>Y</given-names></string-name>, <string-name><surname>Phoenix</surname><given-names>TN</given-names></string-name>, <string-name><surname>Natarajan</surname><given-names>S</given-names></string-name>, <string-name><surname>Easton</surname><given-names>J</given-names></string-name>, <string-name><surname>Northcott</surname><given-names>PA</given-names></string-name>, <string-name><surname>Gawad</surname><given-names>C</given-names></string-name>. <year>2018</year><article-title>A single-cell transcriptional atlas of the developing murine cerebellum</article-title>. <source>Curr Biol</source><volume>28</volume>: <fpage>2910</fpage>–<lpage>2920.e2</lpage>. <pub-id pub-id-type="doi">10.1016/j.cub.2018.07.062</pub-id><pub-id pub-id-type="pmid">30220501</pub-id></mixed-citation>
    </ref>
    <ref id="GR251447OVCC12">
      <mixed-citation publication-type="other"><string-name><surname>Cayton</surname><given-names>L</given-names></string-name>. <year>2005</year><article-title>Algorithms for manifold learning. Technical report CS2008-0923, University of California at San Diego</article-title>. <comment><uri xlink:href="http://cseweb.ucsd.edu/~lcayton/resexam.pdf">http://cseweb.ucsd.edu/~lcayton/resexam.pdf</uri></comment></mixed-citation>
    </ref>
    <ref id="GR251447OVCC14">
      <mixed-citation publication-type="journal"><string-name><surname>Coifman</surname><given-names>RR</given-names></string-name>, <string-name><surname>Lafon</surname><given-names>S</given-names></string-name>. <year>2006</year><article-title>Diffusion maps</article-title>. <source>Appl Comput Harmon Anal</source><volume>21</volume>: <fpage>5</fpage>–<lpage>30</lpage>. <pub-id pub-id-type="doi">10.1016/j.acha.2006.04.006</pub-id></mixed-citation>
    </ref>
    <ref id="GR251447OVCC15">
      <mixed-citation publication-type="journal"><string-name><surname>Dietrich</surname><given-names>S</given-names></string-name>, <string-name><surname>Oleś</surname><given-names>M</given-names></string-name>, <string-name><surname>Lu</surname><given-names>J</given-names></string-name>, <string-name><surname>Sellner</surname><given-names>L</given-names></string-name>, <string-name><surname>Anders</surname><given-names>S</given-names></string-name>, <string-name><surname>Velten</surname><given-names>B</given-names></string-name>, <string-name><surname>Wu</surname><given-names>B</given-names></string-name>, <string-name><surname>Hüllein</surname><given-names>J</given-names></string-name>, <string-name><surname>da Silva Liberio</surname><given-names>M</given-names></string-name>, <string-name><surname>Walther</surname><given-names>T</given-names></string-name>, <etal/><year>2018</year><article-title>Drug-perturbation-based stratification of blood cancer</article-title>. <source>J Clin Invest</source><volume>128</volume>: <fpage>427</fpage>–<lpage>445</lpage>. <pub-id pub-id-type="doi">10.1172/JCI93801</pub-id><pub-id pub-id-type="pmid">29227286</pub-id></mixed-citation>
    </ref>
    <ref id="GR251447OVCC16">
      <mixed-citation publication-type="other"><string-name><surname>Fette</surname><given-names>I</given-names></string-name>, <string-name><surname>Melnikov</surname><given-names>A</given-names></string-name>. <year>2011</year><article-title>RFC 6455: The WebSocket protocol</article-title>. <source>Internet Engineering Task Force</source>. <comment><uri xlink:href="https://tools.ietf.org/html/rfc6455">https://tools.ietf.org/html/rfc6455</uri></comment></mixed-citation>
    </ref>
    <ref id="GR251447OVCC17">
      <mixed-citation publication-type="journal"><string-name><surname>Green</surname><given-names>DA</given-names></string-name>. <year>2011</year><article-title>A colour scheme for the display of astronomical intensity images</article-title>. <source>Bull Astr Soc India</source><volume>39</volume>: <fpage>289</fpage>–<lpage>295</lpage>.</mixed-citation>
    </ref>
    <ref id="GR251447OVCC18">
      <mixed-citation publication-type="journal"><string-name><surname>Haghverdi</surname><given-names>L</given-names></string-name>, <string-name><surname>Lun</surname><given-names>ATL</given-names></string-name>, <string-name><surname>Morgan</surname><given-names>MD</given-names></string-name>, <string-name><surname>Marioni</surname><given-names>JC</given-names></string-name>. <year>2018</year><article-title>Batch effects in single-cell RNA-sequencing data are corrected by matching mutual nearest neighbors</article-title>. <source>Nat Biotechnol</source><volume>36</volume>: <fpage>421</fpage>–<lpage>427</lpage>. <pub-id pub-id-type="doi">10.1038/nbt.4091</pub-id><pub-id pub-id-type="pmid">29608177</pub-id></mixed-citation>
    </ref>
    <ref id="GR251447OVCC19">
      <mixed-citation publication-type="journal"><string-name><surname>Kaski</surname><given-names>S</given-names></string-name>, <string-name><surname>Nikkilä</surname><given-names>J</given-names></string-name>, <string-name><surname>Oja</surname><given-names>M</given-names></string-name>, <string-name><surname>Venna</surname><given-names>J</given-names></string-name>, <string-name><surname>Törönen</surname><given-names>P</given-names></string-name>, <string-name><surname>Castrén</surname><given-names>E</given-names></string-name>. <year>2003</year><article-title>Trustworthiness and metrics in visualizing similarity of gene expression</article-title>. <source>BMC Bioinformatics</source><volume>4</volume>: <fpage>48</fpage><pub-id pub-id-type="doi">10.1186/1471-2105-4-48</pub-id><pub-id pub-id-type="pmid">14552657</pub-id></mixed-citation>
    </ref>
    <ref id="GR251447OVCC20">
      <mixed-citation publication-type="journal"><string-name><surname>Kohonen</surname><given-names>T</given-names></string-name>. <year>1982</year><article-title>Self-organized formation of topologically correct feature maps</article-title>. <source>Biol Cybern</source><volume>43</volume>: <fpage>59</fpage>–<lpage>69</lpage>. <pub-id pub-id-type="doi">10.1007/BF00337288</pub-id></mixed-citation>
    </ref>
    <ref id="GR251447OVCC22">
      <mixed-citation publication-type="journal"><string-name><surname>Kruskal</surname><given-names>JB</given-names></string-name>. <year>1964</year><article-title>Multidimensional scaling by optimizing goodness of fit to a nonmetric hypothesis</article-title>. <source>Psychometrika</source><volume>29</volume>: <fpage>1</fpage>–<lpage>27</lpage>. <pub-id pub-id-type="doi">10.1007/BF02289565</pub-id></mixed-citation>
    </ref>
    <ref id="GR251447OVCC23">
      <mixed-citation publication-type="journal"><string-name><surname>Lespinats</surname><given-names>S</given-names></string-name>, <string-name><surname>Aupetit</surname><given-names>M</given-names></string-name>. <year>2011</year><article-title>CheckViz: sanity check and topological clues for linear and non-linear mappings</article-title>. <source>Comput Graph Forum</source><volume>30</volume>: <fpage>113</fpage>–<lpage>125</lpage>. <pub-id pub-id-type="doi">10.1111/j.1467-8659.2010.01835.x</pub-id></mixed-citation>
    </ref>
    <ref id="GR251447OVCC24">
      <mixed-citation publication-type="confproc"><string-name><surname>Mao</surname><given-names>Q</given-names></string-name>, <string-name><surname>Wang</surname><given-names>L</given-names></string-name>, <string-name><surname>Goodison</surname><given-names>S</given-names></string-name>, <string-name><surname>Sun</surname><given-names>Y</given-names></string-name>. <year>2015</year><article-title>Dimensionality reduction via graph structure learning</article-title>. In <conf-name>Proceedings of the 21st ACM SIGKDD International Conference on Knowledge Discovery and Data Mining</conf-name>, pp. <fpage>765</fpage>–<lpage>774</lpage>. <conf-loc>ACM, New York</conf-loc>.</mixed-citation>
    </ref>
    <ref id="GR251447OVCC25">
      <mixed-citation publication-type="other"><string-name><surname>McInnes</surname><given-names>L</given-names></string-name>, <string-name><surname>Healy</surname><given-names>J</given-names></string-name>, <string-name><surname>Melville</surname><given-names>J</given-names></string-name>. <year>2018</year><article-title>UMAP: Uniform</article-title><article-title>Manifold Approximation and Projection for dimension reduction</article-title>. <source>arXiv:1802.03426 [stat.ML]</source>.</mixed-citation>
    </ref>
    <ref id="GR251447OVCC27">
      <mixed-citation publication-type="journal"><string-name><surname>Moon</surname><given-names>KR</given-names></string-name>, <string-name><surname>Stanley</surname><given-names>JS</given-names><suffix>III</suffix></string-name>, <string-name><surname>Burkhardt</surname><given-names>D</given-names></string-name>, <string-name><surname>van Dijk</surname><given-names>D</given-names></string-name>, <string-name><surname>Wolf</surname><given-names>G</given-names></string-name>, <string-name><surname>Krishnaswamy</surname><given-names>S</given-names></string-name>. <year>2018</year><article-title>Manifold learning-based methods for analyzing single-cell RNA-sequencing data</article-title>. <source>Curr Opin Syst Biol</source><volume>7</volume>: <fpage>36</fpage>–<lpage>46</lpage>. <pub-id pub-id-type="doi">10.1016/j.coisb.2017.12.008</pub-id></mixed-citation>
    </ref>
    <ref id="GR251447OVCC28">
      <mixed-citation publication-type="journal"><string-name><surname>Nguyen</surname><given-names>LH</given-names></string-name>, <string-name><surname>Holmes</surname><given-names>S</given-names></string-name>. <year>2019</year><article-title>Ten quick tips for effective dimensionality reduction</article-title>. <source>PLoS Comput Biol</source><volume>15</volume>: <fpage>e1006907</fpage><pub-id pub-id-type="doi">10.1371/journal.pcbi.1006907</pub-id><pub-id pub-id-type="pmid">31220072</pub-id></mixed-citation>
    </ref>
    <ref id="GR251447OVCC30">
      <mixed-citation publication-type="other"><string-name><surname>Phillips</surname><given-names>JM</given-names></string-name>, <string-name><surname>Venkatasubramanian</surname><given-names>S</given-names></string-name>. <year>2011</year><article-title>A gentle introduction to the kernel distance</article-title>. <source>arXiv:1103.1625 [cs.CG]</source>.</mixed-citation>
    </ref>
    <ref id="GR251447OVCC31">
      <mixed-citation publication-type="journal"><string-name><surname>Qiu</surname><given-names>X</given-names></string-name>, <string-name><surname>Mao</surname><given-names>Q</given-names></string-name>, <string-name><surname>Tang</surname><given-names>Y</given-names></string-name>, <string-name><surname>Wang</surname><given-names>L</given-names></string-name>, <string-name><surname>Chawla</surname><given-names>R</given-names></string-name>, <string-name><surname>Pliner</surname><given-names>HA</given-names></string-name>, <string-name><surname>Trapnell</surname><given-names>C</given-names></string-name>. <year>2017</year><article-title>Reversed graph embedding resolves complex single-cell trajectories</article-title>. <source>Nat Methods</source><volume>14</volume>: <fpage>979</fpage>–<lpage>982</lpage>. <pub-id pub-id-type="doi">10.1038/nmeth.4402</pub-id><pub-id pub-id-type="pmid">28825705</pub-id></mixed-citation>
    </ref>
    <ref id="GR251447OVCC32">
      <mixed-citation publication-type="book"><collab>R Core Team</collab>. <year>2019</year><source>R: a language and environment for statistical computing</source>. <publisher-name>R Foundation for Statistical Computing</publisher-name>, <publisher-loc>Vienna</publisher-loc><comment><uri xlink:href="https://www.R-project.org/">https://www.R-project.org/</uri></comment>.</mixed-citation>
    </ref>
    <ref id="GR251447OVCC33">
      <mixed-citation publication-type="journal"><string-name><surname>Ringnér</surname><given-names>M</given-names></string-name>. <year>2008</year><article-title>What is principal component analysis?</article-title><source>Nat Biotechnol</source><volume>26</volume>: <fpage>303</fpage>–<lpage>304</lpage>. <pub-id pub-id-type="doi">10.1038/nbt0308-303</pub-id><pub-id pub-id-type="pmid">18327243</pub-id></mixed-citation>
    </ref>
    <ref id="GR251447OVCC34">
      <mixed-citation publication-type="other"><collab>Satija Lab</collab>. <year>2018</year><article-title>Using Seurat with multi-modal data</article-title>. <comment><uri xlink:href="https://satijalab.org/seurat/v3.1/multimodal_vignette.html">https://satijalab.org/seurat/v3.1/multimodal_vignette.html</uri></comment></mixed-citation>
    </ref>
    <ref id="GR251447OVCC35">
      <mixed-citation publication-type="book"><string-name><surname>Seifert</surname><given-names>C</given-names></string-name>, <string-name><surname>Sabol</surname><given-names>V</given-names></string-name>, <string-name><surname>Kienreich</surname><given-names>W</given-names></string-name>. <year>2010</year><article-title>Stress maps: analysing local phenomena in dimensionality reduction based visualisations</article-title>. In <source>IEEE Symposium on Visual Analytics Science and Technology</source> (ed. <string-name><surname>Kohlmahher J</surname></string-name>, <string-name><surname>Keim</surname><given-names>D</given-names></string-name>), pp. <fpage>13</fpage>–<lpage>18</lpage>. <publisher-name>IEEE</publisher-name>, <publisher-loc>Salt Lake City</publisher-loc>, <publisher-loc>Utah</publisher-loc>.</mixed-citation>
    </ref>
    <ref id="GR251447OVCC36">
      <mixed-citation publication-type="journal"><string-name><surname>Stoeckius</surname><given-names>M</given-names></string-name>, <string-name><surname>Hafemeister</surname><given-names>C</given-names></string-name>, <string-name><surname>Stephenson</surname><given-names>W</given-names></string-name>, <string-name><surname>Houck-Loomis</surname><given-names>B</given-names></string-name>, <string-name><surname>Chattopadhyay</surname><given-names>PK</given-names></string-name>, <string-name><surname>Swerdlow</surname><given-names>H</given-names></string-name>, <string-name><surname>Satija</surname><given-names>R</given-names></string-name>, <string-name><surname>Smibert</surname><given-names>P</given-names></string-name>. <year>2017</year><article-title>Simultaneous epitope and transcriptome measurement in single cells</article-title>. <source>Nat Methods</source><volume>14</volume>: <fpage>865</fpage>–<lpage>868</lpage>. <pub-id pub-id-type="doi">10.1038/nmeth.4380</pub-id><pub-id pub-id-type="pmid">28759029</pub-id></mixed-citation>
    </ref>
    <ref id="GR251447OVCC37">
      <mixed-citation publication-type="journal"><string-name><surname>Trapnell</surname><given-names>C</given-names></string-name>, <string-name><surname>Cacchiarelli</surname><given-names>D</given-names></string-name>, <string-name><surname>Grimsby</surname><given-names>J</given-names></string-name>, <string-name><surname>Pokharel</surname><given-names>P</given-names></string-name>, <string-name><surname>Li</surname><given-names>S</given-names></string-name>, <string-name><surname>Morse</surname><given-names>M</given-names></string-name>, <string-name><surname>Lennon</surname><given-names>NJ</given-names></string-name>, <string-name><surname>Livak</surname><given-names>KJ</given-names></string-name>, <string-name><surname>Mikkelsen</surname><given-names>TS</given-names></string-name>, <string-name><surname>Rinn</surname><given-names>JL</given-names></string-name>. <year>2014</year><article-title>The dynamics and regulators of cell fate decisions are revealed by pseudotemporal ordering of single cells</article-title>. <source>Nat Biotechnol</source><volume>32</volume>: <fpage>381</fpage>–<lpage>386</lpage>. <pub-id pub-id-type="doi">10.1038/nbt.2859</pub-id><pub-id pub-id-type="pmid">24658644</pub-id></mixed-citation>
    </ref>
    <ref id="GR251447OVCC38">
      <mixed-citation publication-type="journal"><string-name><surname>Tung</surname><given-names>PY</given-names></string-name>, <string-name><surname>Blischak</surname><given-names>JD</given-names></string-name>, <string-name><surname>Hsiao</surname><given-names>CJ</given-names></string-name>, <string-name><surname>Knowles</surname><given-names>DA</given-names></string-name>, <string-name><surname>Burnett</surname><given-names>JE</given-names></string-name>, <string-name><surname>Pritchard</surname><given-names>JK</given-names></string-name>, <string-name><surname>Gilad</surname><given-names>Y</given-names></string-name>. <year>2017</year><article-title>Batch effects and the effective design of single-cell gene expression studies</article-title>. <source>Sci Rep</source><volume>7</volume>: <fpage>39921</fpage><pub-id pub-id-type="doi">10.1038/srep39921</pub-id><pub-id pub-id-type="pmid">28045081</pub-id></mixed-citation>
    </ref>
    <ref id="GR251447OVCC39">
      <mixed-citation publication-type="journal"><string-name><surname>van der Maaten</surname><given-names>L</given-names></string-name>. <year>2014</year><article-title>Accelerating t-SNE using tree-based algorithms</article-title>. <source>J Mach Learn Res</source><volume>15</volume>: <fpage>3221</fpage>–<lpage>3245</lpage>.</mixed-citation>
    </ref>
    <ref id="GR251447OVCC40">
      <mixed-citation publication-type="journal"><string-name><surname>van der Maaten</surname><given-names>LJP</given-names></string-name>, <string-name><surname>Hinton</surname></string-name>. <year>2008</year><article-title>Visualizing high-dimensional data using t-SNE</article-title>. <source>J Mach Learn Res</source><volume>9</volume>: <fpage>2579</fpage>–<lpage>2605</lpage>.</mixed-citation>
    </ref>
    <ref id="GR251447OVCC41">
      <mixed-citation publication-type="journal"><string-name><surname>Waltman</surname><given-names>L</given-names></string-name>, <string-name><surname>van Eck</surname><given-names>NJ</given-names></string-name>. <year>2013</year><article-title>A smart local moving algorithm for large-scale modularity-based community detection</article-title>. <source>Eur Phys J B</source><volume>86</volume>: <fpage>471</fpage><pub-id pub-id-type="doi">10.1140/epjb/e2013-40829-0</pub-id></mixed-citation>
    </ref>
    <ref id="GR251447OVCC42">
      <mixed-citation publication-type="journal"><string-name><surname>Wang</surname><given-names>B</given-names></string-name>, <string-name><surname>Zhu</surname><given-names>J</given-names></string-name>, <string-name><surname>Pierson</surname><given-names>E</given-names></string-name>, <string-name><surname>Ramazzotti</surname><given-names>D</given-names></string-name>, <string-name><surname>Batzoglou</surname><given-names>S</given-names></string-name>. <year>2017</year><article-title>Visualization and analysis of single-cell RNA-seq data by kernel-based similarity learning</article-title>. <source>Nat Methods</source><volume>14</volume>: <fpage>414</fpage>–<lpage>416</lpage>. <pub-id pub-id-type="doi">10.1038/nmeth.4207</pub-id><pub-id pub-id-type="pmid">28263960</pub-id></mixed-citation>
    </ref>
    <ref id="GR251447OVCC43">
      <mixed-citation publication-type="journal"><string-name><surname>Wattenberg</surname><given-names>M</given-names></string-name>, <string-name><surname>Viégas</surname><given-names>F</given-names></string-name>, <string-name><surname>Johnson</surname><given-names>I</given-names></string-name>. <year>2016</year><article-title>How to use t-SNE effectively</article-title>. <source>Distill</source><bold>1:</bold> e2. <pub-id pub-id-type="doi">10.23915/distill.00002</pub-id></mixed-citation>
    </ref>
    <ref id="GR251447OVCC44">
      <mixed-citation publication-type="other"><string-name><surname>Yang</surname><given-names>L</given-names></string-name>, <string-name><surname>Jin</surname><given-names>R</given-names></string-name>. <year>2006</year><source>Distance metric learning: a comprehensive survey</source>. <comment>Technical report, Michigan State University. <uri xlink:href="http://www.cs.cmu.edu/~./liuy/frame_survey_v2.pdf">http://www.cs.cmu.edu/~./liuy/frame_survey_v2.pdf</uri></comment></mixed-citation>
    </ref>
  </ref-list>
</back>
