<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName A++V2.4.dtd?>
<?SourceDTD.Version 2.4?>
<?ConverterInfo.XSLTName springer2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Sci Rep</journal-id>
    <journal-id journal-id-type="iso-abbrev">Sci Rep</journal-id>
    <journal-title-group>
      <journal-title>Scientific Reports</journal-title>
    </journal-title-group>
    <issn pub-type="epub">2045-2322</issn>
    <publisher>
      <publisher-name>Nature Publishing Group UK</publisher-name>
      <publisher-loc>London</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">8766435</article-id>
    <article-id pub-id-type="publisher-id">4473</article-id>
    <article-id pub-id-type="doi">10.1038/s41598-021-04473-4</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Article</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>A neural network-based method for exhaustive cell label assignment using single cell RNA-seq data</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Li</surname>
          <given-names>Ziyi</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <name>
          <surname>Feng</surname>
          <given-names>Hao</given-names>
        </name>
        <address>
          <email>hxf155@case.edu</email>
        </address>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <aff id="Aff1"><label>1</label><institution-wrap><institution-id institution-id-type="GRID">grid.240145.6</institution-id><institution-id institution-id-type="ISNI">0000 0001 2291 4776</institution-id><institution>Department of Biostatistics, </institution><institution>The University of Texas MD Anderson Cancer Center, </institution></institution-wrap>Houston, TX 77030 USA </aff>
      <aff id="Aff2"><label>2</label><institution-wrap><institution-id institution-id-type="GRID">grid.67105.35</institution-id><institution-id institution-id-type="ISNI">0000 0001 2164 3847</institution-id><institution>Department of Population and Quantitative Health Sciences, </institution><institution>Case Western Reserve University, </institution></institution-wrap>Cleveland, OH 44106 USA </aff>
    </contrib-group>
    <pub-date pub-type="epub">
      <day>18</day>
      <month>1</month>
      <year>2022</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>18</day>
      <month>1</month>
      <year>2022</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2022</year>
    </pub-date>
    <volume>12</volume>
    <elocation-id>910</elocation-id>
    <history>
      <date date-type="received">
        <day>21</day>
        <month>7</month>
        <year>2021</year>
      </date>
      <date date-type="accepted">
        <day>21</day>
        <month>12</month>
        <year>2021</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2022</copyright-statement>
      <license>
        <ali:license_ref specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p><bold>Open Access</bold>This article is licensed under a Creative Commons Attribution 4.0 International License, which permits use, sharing, adaptation, distribution and reproduction in any medium or format, as long as you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons licence, and indicate if changes were made. The images or other third party material in this article are included in the article's Creative Commons licence, unless indicated otherwise in a credit line to the material. If material is not included in the article's Creative Commons licence and your intended use is not permitted by statutory regulation or exceeds the permitted use, you will need to obtain permission directly from the copyright holder. To view a copy of this licence, visit <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>.</license-p>
      </license>
    </permissions>
    <abstract id="Abs1">
      <p id="Par1">The fast-advancing single cell RNA sequencing (scRNA-seq) technology enables researchers to study the transcriptome of heterogeneous tissues at a single cell level. The initial important step of analyzing scRNA-seq data is usually to accurately annotate cells. The traditional approach of annotating cell types based on unsupervised clustering and marker genes is time-consuming and laborious. Taking advantage of the numerous existing scRNA-seq databases, many supervised label assignment methods have been developed. One feature that many label assignment methods shares is to label cells with low confidence as “unassigned.” These unassigned cells can be the result of assignment difficulties due to highly similar cell types or caused by the presence of unknown cell types. However, when unknown cell types are not expected, existing methods still label a considerable number of cells as unassigned, which is not desirable. In this work, we develop a neural network-based cell annotation method called NeuCA (Neural network-based Cell Annotation) for scRNA-seq data obtained from well-studied tissues. NeuCA can utilize the hierarchical structure information of the cell types to improve the annotation accuracy, which is especially helpful when data contain closely correlated cell types. We show that NeuCA can achieve more accurate cell annotation results compared with existing methods. Additionally, the applications on eight real datasets show that NeuCA has stable performance for intra- and inter-study annotation, as well as cross-condition annotation. NeuCA is freely available as an R/Bioconductor package at <ext-link ext-link-type="uri" xlink:href="https://bioconductor.org/packages/NeuCA">https://bioconductor.org/packages/NeuCA</ext-link>.</p>
    </abstract>
    <kwd-group kwd-group-type="npg-subject">
      <title>Subject terms</title>
      <kwd>Bioinformatics</kwd>
      <kwd>RNA sequencing</kwd>
      <kwd>Statistical methods</kwd>
      <kwd>Software</kwd>
      <kwd>Machine learning</kwd>
      <kwd>Gene expression</kwd>
    </kwd-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100007313</institution-id>
            <institution>University of Texas MD Anderson Cancer Center</institution>
          </institution-wrap>
        </funding-source>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100008136</institution-id>
            <institution>Case Western Reserve University</institution>
          </institution-wrap>
        </funding-source>
      </award-group>
    </funding-group>
    <custom-meta-group>
      <custom-meta>
        <meta-name>issue-copyright-statement</meta-name>
        <meta-value>© The Author(s) 2022</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec id="Sec1">
    <title>Introduction</title>
    <p id="Par2">Single-cell RNA sequencing (scRNA-seq) provides an unprecedented ability to characterize the transcriptome heterogeneity at the single cell level. This technology has been applied in many research areas including evolutionary<sup><xref ref-type="bibr" rid="CR1">1</xref></sup>, immunology<sup><xref ref-type="bibr" rid="CR2">2</xref></sup>, neurodegenerative diseases<sup><xref ref-type="bibr" rid="CR3">3</xref></sup>, and cancer<sup><xref ref-type="bibr" rid="CR4">4</xref>,<xref ref-type="bibr" rid="CR5">5</xref></sup>. With the fast-evolving technology and the growing interests of scRNA-seq applications, a vast number of datasets have been collected and annotated by domain experts in the past decade. These data deepened our understanding of the intrinsic characteristics of transcriptomics, as well as the phenotypes associated. Simultaneously, there also are community efforts that work towards a comprehensive collection of single cell profiling, such as the Human Cell Atlas<sup><xref ref-type="bibr" rid="CR6">6</xref>–<xref ref-type="bibr" rid="CR8">8</xref></sup> and Mouse Cell Atlas<sup><xref ref-type="bibr" rid="CR9">9</xref></sup>. From these joint efforts, massive amounts of scRNA-seq data were generated to provide excellent cell type references for understanding and annotating new data.</p>
    <p id="Par3">Because the sequencing output of scRNA-seq is anonymous in terms of cell identities, annotating the sequenced cells is usually the initial step in single cell data analysis. Traditionally, researchers adopted a two-step approach: first, applying unsupervised methods to cluster the cells; second, identifying the cell labels using known cell type markers. Many single cell clustering methods were proposed, including Seurat<sup><xref ref-type="bibr" rid="CR10">10</xref></sup>, SC3<sup><xref ref-type="bibr" rid="CR11">11</xref></sup>, TSCAN<sup><xref ref-type="bibr" rid="CR12">12</xref></sup>. However, this two-step approach is a time-consuming and laborious procedure, which becomes even more challenging if good marker genes are unavailable to researchers. Recognizing the limitations, a number of supervised approaches were proposed to utilize existing single cell datasets and directly annotate cells without the clustering step. Popular methods in this category include scmap<sup><xref ref-type="bibr" rid="CR13">13</xref></sup>, CHETAH<sup><xref ref-type="bibr" rid="CR14">14</xref></sup>, CellAssign<sup><xref ref-type="bibr" rid="CR15">15</xref></sup>, and others. In addition, there are semi-supervised methods available to label cells. Popular methods in this category include SCINA<sup><xref ref-type="bibr" rid="CR16">16</xref></sup>, Garnett<sup><xref ref-type="bibr" rid="CR17">17</xref></sup>, scSorter<sup><xref ref-type="bibr" rid="CR18">18</xref></sup>, transfer-learning based method ItClust<sup><xref ref-type="bibr" rid="CR19">19</xref></sup> and meta-learning based method MARS<sup><xref ref-type="bibr" rid="CR20">20</xref></sup>. Methods in this category are especially useful when marker gene names are available while their expression values are not. Some of their unique features include novel cell type discovery<sup><xref ref-type="bibr" rid="CR20">20</xref></sup>, robust to marker gene inconsistency<sup><xref ref-type="bibr" rid="CR18">18</xref></sup>, and improved sensitivity to testing data structure<sup><xref ref-type="bibr" rid="CR19">19</xref></sup>. They typically have improved clustering and accuracy compared with previously developed methods. In general, if the tissue type of interest has never been studied before, there will be no existing dataset available for training supervised methods. An unsupervised method becomes the only viable solution in such circumstance. However, when training data are available, the improved accuracy, speed, and reproducibility of supervised methods easily outperform unsupervised ones.</p>
    <p id="Par4">Supervised methods can be categorized into three different groups: marker based, correlation based, and tree structure based. Marker-based methods, as the name indicates, assign cell labels based on the provided marker genes<sup><xref ref-type="bibr" rid="CR15">15</xref>,<xref ref-type="bibr" rid="CR21">21</xref></sup>. Methods in this category require known knowledge of cell type-specific marker genes, and they thereby could be prone to marker misspecification. Correlation-based methods assign cell labels by cell-to-cell correlations or other similarity metrics<sup><xref ref-type="bibr" rid="CR13">13</xref>,<xref ref-type="bibr" rid="CR22">22</xref></sup>. For cell types that are closely correlated, the pairwise correlations of several cell types could be high simultaneously. The methods in this category may have difficulty accurately assigning labels under these high correlation settings. Tree structure-based methods take the advantage of tree structures of cell types. This method type selects different sets of features at each classification bifurcation, which coincides with the idea of several recent publications that the cell types in a tissue form a hierarchical structure<sup><xref ref-type="bibr" rid="CR23">23</xref>–<xref ref-type="bibr" rid="CR25">25</xref></sup>. Such information could be used to improve classification accuracy of closely correlated cell types. For example, A popular use of this approach is the CHETAH method<sup><xref ref-type="bibr" rid="CR14">14</xref></sup>. It is specifically designed for the situation when unknown cell types (e.g., tumor cells) present in the data. However, when researchers expect a tiny portion or no unknown cell types from a dataset of interest, CHETAH still produces an unignorable amount of unassigned/intermediate cell labels, as shown in our simulation study and real data analysis later.</p>
    <p id="Par5">Recognizing the limitations of existing methods, we developed a new method for exhaustively annotating cells in scRNA-seq data. We utilized well-studied tissues from existing scRNA-seq datasets with known labels as the training data. Of note, we are targeting at scenarios where tissues are well-studied. In other words, data containing cell-types-of-interest are available from previous studies, to serve as the training data. Although this is not a ubiquitous assumption, it holds for many tissue types, including human brain<sup><xref ref-type="bibr" rid="CR3">3</xref></sup>, human pancreas<sup><xref ref-type="bibr" rid="CR26">26</xref></sup>, mouse brain<sup><xref ref-type="bibr" rid="CR27">27</xref></sup>, mouse retina<sup><xref ref-type="bibr" rid="CR28">28</xref></sup>, and many other tissue types under normal conditions<sup><xref ref-type="bibr" rid="CR29">29</xref></sup>. Studies with well-annotated cell types are also increasing, thanks to community efforts that work towards a comprehensive collection of single cell profiling, such as the Human Cell Atlas<sup><xref ref-type="bibr" rid="CR6">6</xref>–<xref ref-type="bibr" rid="CR8">8</xref></sup> and Mouse Cell Atlas<sup><xref ref-type="bibr" rid="CR9">9</xref></sup>. In our method, when closely correlated cell types exist, it uses the tree structure of the cell types through a hierarchy of neural networks to improve annotation accuracy. At the same time, feature selection is performed in the hierarchical structure to further improve classification accuracy. In situations where cell type correlations are not high, we adopt a feed-forward neural network. We call our whole pipeline the Neural network-based Cell Annotation (NeuCA). Leveraging well-understood tissues, NeuCA annotates cells in an exhaustive way to avoid loss of cells for downstream analysis.</p>
    <p id="Par6">Through a series of simulations based on real data, we comprehensively evaluated NeuCA in different settings and compared its performance with several popular existing supervised/unsupervised methods. Our applications on eight real datasets showed that NeuCA maintained stable performance in inter- and intra-data annotation, as well as cross-condition annotation. Our proposed method NeuCA is available through a freely available R/Bioconductor package at <ext-link ext-link-type="uri" xlink:href="https://bioconductor.org/packages/NeuCA/">https://bioconductor.org/packages/NeuCA/</ext-link>.</p>
  </sec>
  <sec id="Sec2">
    <title>Results</title>
    <sec id="Sec3">
      <title>Method overview</title>
      <p id="Par7">NeuCA is a supervised cell label assignment method. It uses existing scRNA-seq data with known labels to train a neural network-based classifier and then predict cell labels in new data of interest. Figure <xref rid="Fig1" ref-type="fig">1</xref> provides a schematic overview of the proposed method. Based on the training data, NeuCA first obtains the mean gene expression profile for each cell type and calculates the correlation matrix across cell types. NeuCA then will choose one out of the two approaches as described. If the correlation matrix contains highly correlated cell types (defined as cell types with Pearson’s correlation coefficient <inline-formula id="IEq1"><alternatives><tex-math id="M1">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\ge$$\end{document}</tex-math><mml:math id="M2"><mml:mo>≥</mml:mo></mml:math><inline-graphic xlink:href="41598_2021_4473_Article_IEq1.gif"/></alternatives></inline-formula>
<inline-formula id="IEq2"><alternatives><tex-math id="M3">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\tau$$\end{document}</tex-math><mml:math id="M4"><mml:mi>τ</mml:mi></mml:math><inline-graphic xlink:href="41598_2021_4473_Article_IEq2.gif"/></alternatives></inline-formula>), NeuCA constructs a tree structure by hierarchical clustering and trains a series of neural networks based on this tree structure. We used <inline-formula id="IEq3"><alternatives><tex-math id="M5">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\tau = 0.95$$\end{document}</tex-math><mml:math id="M6"><mml:mrow><mml:mi>τ</mml:mi><mml:mo>=</mml:mo><mml:mn>0.95</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="41598_2021_4473_Article_IEq3.gif"/></alternatives></inline-formula> for the following experiments, but users can specify this value in the R package. Predicted labels are obtained by applying the trained hierarchical neural network model to the testing data. In constructing the hierarchical neural network, different sets of features(genes) are selected at each iteration to accommodate the differences between cell types. If the correlation matrix does not show the existence of highly correlated cell types, NeuCA will train a feed-forward neural network for cell type prediction. This simplified approach is motivated by the fact that a tree structure is unnecessarily expensive when cell types are not similar. In this case, a feed-forward neural network can achieve satisfactory prediction accuracy. Collectively, NeuCA calculates the correlation matrix first and determines its adopted approach from the two strategies described above.<fig id="Fig1"><label>Figure 1</label><caption><p>A schematic overview of the proposed method. Based on the correlation matrix of the training data, NeuCA will detect if highly correlated cell types exist, and decide between the following two routes: (1) with the presence of highly correlated cell types, NeuCA will adopt a hierarchical model with neural networks for cell label identification (right, pink panel); (2) in the absence of highly correlated cell types, a feed-forward neural network will be adopted for cell label identification (lower-left, cyan panel).</p></caption><graphic xlink:href="41598_2021_4473_Fig1_HTML" id="MO1"/></fig></p>
      <p id="Par8">The advantages of the proposed method are threefold. First, NeuCA can recognize whether the cell types are highly correlated or not, and adjust its strategy. The presence of highly correlated cell types is usually an indicator for the increased complexity of the prediction task. Under an increased difficulty level, the combined approach of a tree structure and neural network model will show its merits. Under the scenario where high correlation is absent, the feed-forward neural network usually works well. Second, the adoption of a cell type hierarchical tree and stepwise feature selection in NeuCA help further improve accuracy. The hierarchical structures of cell types have been identified and used in several previous works<sup><xref ref-type="bibr" rid="CR14">14</xref>,<xref ref-type="bibr" rid="CR24">24</xref>,<xref ref-type="bibr" rid="CR30">30</xref></sup> for their advantage in analyzing cell types with high similarities. When numerous cell types are available, the hierarchical approach of cell annotation disassembles a complicated problem to a series of simple binary classification problems. For example, among peripheral blood mononuclear cells, it is easier to distinguish CD4T cells from CD8T cells, given only the mixture of these two cell types, than mixing them with all other peripheral blood cell types. In addition to hierarchical classification, we select the most distinguishable features at each step, which further improves similar cell type separation accuracy. Third, NeuCA assignments are exhaustive, in that they do not allow cells to stagnate at the intermediate node of the tree. This idea is supported by the assumption that most or all cell types in the new testing data have been included and correctly labeled in the training data. This eliminates the unnecessarily high unassignment rate in well-studied tissues. In the following numerical and real data experiments, we showed this would improve assignment accuracy.</p>
    </sec>
    <sec id="Sec4">
      <title>Numerical experiments with cell-sorted PBMC data</title>
      <p id="Par9">We first applied our proposed method, NeuCA, and other existing methods on a series of peripheral blood mononuclear cell (PBMC) datasets. All the experimental datasets generated in this section are based on the 10X PBMC scRNA-seq data<sup><xref ref-type="bibr" rid="CR31">31</xref></sup>. This dataset contains single cell transcriptome data of more than 60,000 cells from fluorescence-activated cell sorting (FACS). The FACS experiment provided the gold standard of cell labels for all the sequenced cells, making it a reliable resource for benchmarking. We designed a series of experiments with randomly drawn cells from this dataset to serve as Monte Carlo simulation studies. This allowed us to fully evaluate the proposed and existing methods under various scenarios.</p>
      <p id="Par10">The methods benchmarked here included three supervised cell annotation methods, NeuCA, scmap, and CHETAH, and two unsupervised clustering methods, Seurat and SC3. We tested NeuCA with three different numbers of nodes: relatively large, medium, and small (see the “<xref rid="Sec9" ref-type="sec">Method</xref>” section for details), denoted as NeuCA-big, NeuCA-med, and NeuCA-small, respectively. We also compared two versions of scmap, scmap-cluster, and scmap-cell, representing cluster-wise and cell-wise approaches for cell annotation. The two evaluation metrics were accurately assigned rate, calculated as the proportion of correctly classified cells over total cells, and adjusted Rand index (ARI), an indicator of the similarities between two clustering results. For unsupervised methods, we reported ARI only since matched cell labels are not directly available. Additionally, we benchmarked NeuCA with other neural network based methods (neural-network, scDeepSort<sup><xref ref-type="bibr" rid="CR32">32</xref></sup>), and presented the results in Supplementary Fig. <xref rid="MOESM1" ref-type="media">S16</xref>.</p>
      <sec id="Sec5">
        <title>Overall comparisons</title>
        <p id="Par11">We provided an overall comparison between NeuCA and existing methods across various scenarios. These scenarios included various training sets using 10%, 20%, 50%, or 80% of all PBMC data and the testing sets using 800, 1600, or 4000 randomly selected PBMC cells. Figure <xref rid="Fig2" ref-type="fig">2</xref>A,B present the overall accurately assigned rate and ARI of the evaluated methods. All three versions of NeuCA ranked at the top, indicating high overall accuracy and high consistency with the truth. With NeuCA-med, we achieved a 10% improvement in accuracy, compared with the best existing approach, scmap-cluster. We achieved at least 5% accuracy gain compared with scmap-cluster, even with NeuCA-small. Results of ARI indicate a highest concordance between our predicted cell clustering labels and the true labels. These results show that NeuCA outperforms both unsupervised and supervised methods that are currently available.</p>
        <p id="Par12">We then explored in detail how NeuCA outperforms existing methods, and in what cell types the advantage is prominent. Figure <xref rid="Fig2" ref-type="fig">2</xref>C provides an illustration of the correlation and hierarchical structure of the cell types and Fig. <xref rid="Fig2" ref-type="fig">2</xref>D presents a detailed breakdown of the frequency counts of the predicted labels from all of the methods. The true label is shown on the left-most bar in each sub-panel of Fig. <xref rid="Fig2" ref-type="fig">2</xref>D. Combining Fig. <xref rid="Fig2" ref-type="fig">2</xref>C,D, we found CD56 natural killer (NK) and CD14 monocytes are the two distinct cell types that are less correlated with other cell types. This makes them easy to be correctly predicted. As expected, all of the methods work well in annotating CD56 NK and CD14 monocytes (the last two sub-panels in Fig. <xref rid="Fig2" ref-type="fig">2</xref>D). For closely correlated cell types, for example, naive cytotoxic T and memory T, existing methods annotate part of the cells as “unassigned” or incorrectly assign them cell labels. NeuCA demonstrates exceptional accuracy in annotating both naive cytotoxic T and memory T with few mistakes. Lastly, naive T, CD4 T helper, and regulatory T are the three most challenging cell types to predict, because the correlation between them is higher than 0.95. For these three cell types, existing methods produced more than 50% “unassigned” labels owing to uncertainty. In contrast, NeuCA can accurately annotate the majority of cells with a small portion of incorrect labels for these three cell types. These findings show that adopting hierarchical structure and step-specific feature selection improves the classification, especially in closely correlated cell types.<fig id="Fig2"><label>Figure 2</label><caption><p>Cell classification accuracy results in the numerical study of the 10X PBMC dataset. The presented results were summarized over 160 Monte Carlo simulations. (<bold>A</bold>) and (<bold>B</bold>) show the accurately assigned rate and the adjusted Rand index (ARI) of the proposed and existing methods. (<bold>C</bold>) shows the hierarchical clustering results and correlations of the cell types. (<bold>D</bold>) is a detailed breakdown of the frequency counts of predicted labels using the proposed and existing methods, for each of the eight cell types, respectively.</p></caption><graphic xlink:href="41598_2021_4473_Fig2_HTML" id="MO2"/></fig></p>
      </sec>
      <sec id="Sec90">
        <title>Effect of training and testing sample sizes</title>
        <p id="Par13">One potential concern of adopting NeuCA is whether the model needs a large training dataset to achieve satisfactory performance. Therefore, we evaluated NeuCA and existing methods with different amounts of training data. Note that unsupervised methods Seurat and SC3 do not use training sets at all, and thus their performance stays similar over various settings. Supplementary Fig. <xref rid="MOESM1" ref-type="media">S1</xref> shows the accuracy and ARI with training sizes ranging from 10%, 20%, 50%, and 80% of all cells. Training sets with <inline-formula id="IEq4"><alternatives><tex-math id="M7">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$10\%$$\end{document}</tex-math><mml:math id="M8"><mml:mrow><mml:mn>10</mml:mn><mml:mo>%</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="41598_2021_4473_Article_IEq4.gif"/></alternatives></inline-formula> correspond to <inline-formula id="IEq5"><alternatives><tex-math id="M9">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\sim$$\end{document}</tex-math><mml:math id="M10"><mml:mo>∼</mml:mo></mml:math><inline-graphic xlink:href="41598_2021_4473_Article_IEq5.gif"/></alternatives></inline-formula> 6000 cells (<inline-formula id="IEq6"><alternatives><tex-math id="M11">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\sim$$\end{document}</tex-math><mml:math id="M12"><mml:mo>∼</mml:mo></mml:math><inline-graphic xlink:href="41598_2021_4473_Article_IEq6.gif"/></alternatives></inline-formula> 750 cells per cell type), which is feasible in many real-world experiments. For experiments that are conducted using sequencing platforms that generate moderate number of cells, such as non-droplet-based platforms, it is advisable to let NeuCA take training datasets from alternative sequencing platforms that has larger cell/sample numbers. NeuCA can still have robust performance, as shown later in human pancreas datasets cross-platform experiments. Here, the testing dataset stays at 4000 randomly selected cells. These results show the high accuracy of NeuCA with only 10% cells used as the training data. NeuCA also consistently outperforms existing methods using 20% (and more) of cells for training. The accurately assigned rate increases from 0.86 to 0.90, which indicates the advantage of using a large training set of around 50,000 cells, although the improvement is marginal. From these experiments, we found that a training set with around 1000 cells per cell type is sufficient to provide a reasonably high annotation accuracy. In general, this is attainable in real-world single-cell RNA-seq experiments.</p>
        <p id="Par14">We also evaluated the impact of testing sample size on the performance of all methods. Supplementary Fig. <xref rid="MOESM1" ref-type="media">S2</xref> reports the accurately assigned rate and ARI under different testing sample sizes (i.e., 800, 1600, and 4000 cells). As expected, changing the test sample size has little impact on the relative accuracy of supervised methods. The unsupervised methods have some performance improvements, with ARI increasing from 0.45 to 0.5 for Seurat and 0.60 to 0.65 for SC3. This also is within our expectation because increased sample size means more information for use. Nevertheless, NeuCA demonstrated a higher accuracy and ARI than the compared existing methods.</p>
      </sec>
      <sec id="Sec7">
        <title>Effect of highly and lowly correlated cell types</title>
        <p id="Par15">Last, we evaluated all of the methods under different prediction difficulty levels. As discussed in the “<xref rid="Sec1" ref-type="sec">Introduction</xref>” section, the cell annotation becomes challenging when cell types are highly correlated. Using the PBMC data, we specifically designed two settings: one with highly correlated cell types only, and another one with lowly-correlated cell types only. These two scenarios correspond to difficult and easy prediction task, respectively.</p>
        <p id="Par16">For difficult prediction task, we only retained the five T-cell types from the PBMC data. We tested under different training and testing proportions as described in the “<xref rid="Sec90" ref-type="sec">Effect of training and testing sample sizes</xref>” section. Supplementary Fig. <xref rid="MOESM1" ref-type="media">S3</xref> shows an overall summary of the performance. All methods have decreased performance under this difficult setting. With the adoption of a hierarchical structure and step-specific feature selection, NeuCA still outperforms all existing methods in both accuracy and ARI. Interestingly, we find SC3 achieves the highest ARI over all existing methods. The high unassigned rate due to the high correlations of cell types lowers the accuracy and ARI of existing supervised methods. Supplementary Figs. <xref rid="MOESM1" ref-type="media">S4</xref> and <xref rid="MOESM1" ref-type="media">S5</xref> demonstrate the desirable performance of NeuCA under different training and testing sizes. Similar conclusions can be drawn from the experiments in the easy prediction setting (Supplementary Figs. <xref rid="MOESM1" ref-type="media">S6</xref>–<xref rid="MOESM1" ref-type="media">S8</xref>). In this relatively easy cell labeling problem, all methods yield reasonable performance. Our method still leads the competing ones, with almost perfect accuracy on average even when using only 10% of the data to train the model.</p>
      </sec>
    </sec>
    <sec id="Sec8">
      <title>Applications on cell sorted human PBMC datasets</title>
      <p id="Par17">Next, we evaluated our proposed method, NeuCA, along with other existing methods, on three additional PBMC-related real datasets: PBMC_8ct_random500 is a subset of the aforementioned FACS-sorted PBMC data with 500 cells randomly drawn for each cell type for a total of 4000 cells<sup><xref ref-type="bibr" rid="CR31">31</xref></sup>; Zhengmix_8ct_PBMC is also from the 10X platform<sup><xref ref-type="bibr" rid="CR31">31</xref></sup> and has been used in several benchmarking studies<sup><xref ref-type="bibr" rid="CR33">33</xref></sup>; FACmix_NK_Mono is a two-component mixture of FACS-sorted NK cells<sup><xref ref-type="bibr" rid="CR34">34</xref></sup> and FACS-sorted monocytes<sup><xref ref-type="bibr" rid="CR35">35</xref></sup>, with a total of 12,700 cells. Compared with the first two datasets that include eight distinct PBMC cell types, the third one only has two cell types. However, the third dataset is obtained from two independent studies, and thus valuable in evaluating the inter-study performance of all of the methods.</p>
      <p id="Par18">To evaluate the robustness of the proposed method, we trained NeuCA using one dataset and tested on another one, with various combinations of the datasets described above. The third dataset was not used as a training set due to smaller cell type number. The same training and testing strategy is adopted on other existing supervised methods (i.e., scmap-cluster, scmap-cell, and CHETAH) for benchmarking purposes. The results for all supervised methods are presented in Fig. <xref rid="Fig3" ref-type="fig">3</xref>. Consistent with our findings in the previous numerical studies, NeuCA achieves more accurate label assignment than existing methods in intra-study predictions (the first and third panels in Fig. <xref rid="Fig3" ref-type="fig">3</xref>A). NeuCA also has outstanding performance in correctly annotating the inter-study dataset and obtained more than 98% accuracy (second and fourth panels in Fig. <xref rid="Fig3" ref-type="fig">3</xref>A). The misclassification rate for all methods on PBMC datasets are reported in Supplementary Fig. <xref rid="MOESM1" ref-type="media">S9</xref>. In comparison, the performance of existing supervised methods is less stable in the inter- and intra-study experiments. We found that scmap-cluster and CHETAH have good performance in the intra-study experiments, but they fare worse in the inter-study settings, while scmap-cell has a reverse pattern.<fig id="Fig3"><label>Figure 3</label><caption><p>Results from applying NeuCA and existing methods on three PBMC datasets. (<bold>A</bold>) shows the accurately assigned cell number for different methods. (<bold>B</bold>) shows the <italic>t</italic>-SNE clustering plot of the cells, using <inline-formula id="IEq7"><alternatives><tex-math id="M13">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$PBMC\_8ct\_random500$$\end{document}</tex-math><mml:math id="M14"><mml:mrow><mml:mi>P</mml:mi><mml:mi>B</mml:mi><mml:mi>M</mml:mi><mml:mi>C</mml:mi><mml:mi>_</mml:mi><mml:mn>8</mml:mn><mml:mi>c</mml:mi><mml:mi>t</mml:mi><mml:mi>_</mml:mi><mml:mi>r</mml:mi><mml:mi>a</mml:mi><mml:mi>n</mml:mi><mml:mi>d</mml:mi><mml:mi>o</mml:mi><mml:mi>m</mml:mi><mml:mn>500</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="41598_2021_4473_Article_IEq7.gif"/></alternatives></inline-formula> as the training data and <inline-formula id="IEq8"><alternatives><tex-math id="M15">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$Zhengmix\_8ct\_PBMC$$\end{document}</tex-math><mml:math id="M16"><mml:mrow><mml:mi>Z</mml:mi><mml:mi>h</mml:mi><mml:mi>e</mml:mi><mml:mi>n</mml:mi><mml:mi>g</mml:mi><mml:mi>m</mml:mi><mml:mi>i</mml:mi><mml:mi>x</mml:mi><mml:mi>_</mml:mi><mml:mn>8</mml:mn><mml:mi>c</mml:mi><mml:mi>t</mml:mi><mml:mi>_</mml:mi><mml:mi>P</mml:mi><mml:mi>B</mml:mi><mml:mi>M</mml:mi><mml:mi>C</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="41598_2021_4473_Article_IEq8.gif"/></alternatives></inline-formula> as the testing data. Note NeuCA has high concordance with the ground truth, with very few unassigned cells (grey color cells).</p></caption><graphic xlink:href="41598_2021_4473_Fig3_HTML" id="MO3"/></fig></p>
      <p id="Par19">We presented the low dimension t-distributed stochastic neighbor embedding (<italic>t</italic>-SNE) visualization of the true and predicted cell types for NeuCA, scmap-cluster, and CHETAH in Fig. <xref rid="Fig3" ref-type="fig">3</xref>B to provide additional insights into the performance differences. The results are based on a specific scenario where <inline-formula id="IEq9"><alternatives><tex-math id="M17">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$PBMC\_8ct\_random500$$\end{document}</tex-math><mml:math id="M18"><mml:mrow><mml:mi>P</mml:mi><mml:mi>B</mml:mi><mml:mi>M</mml:mi><mml:mi>C</mml:mi><mml:mi>_</mml:mi><mml:mn>8</mml:mn><mml:mi>c</mml:mi><mml:mi>t</mml:mi><mml:mi>_</mml:mi><mml:mi>r</mml:mi><mml:mi>a</mml:mi><mml:mi>n</mml:mi><mml:mi>d</mml:mi><mml:mi>o</mml:mi><mml:mi>m</mml:mi><mml:mn>500</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="41598_2021_4473_Article_IEq9.gif"/></alternatives></inline-formula> was used as the training data and <inline-formula id="IEq10"><alternatives><tex-math id="M19">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$Zhengmix\_8ct\_PBMC$$\end{document}</tex-math><mml:math id="M20"><mml:mrow><mml:mi>Z</mml:mi><mml:mi>h</mml:mi><mml:mi>e</mml:mi><mml:mi>n</mml:mi><mml:mi>g</mml:mi><mml:mi>m</mml:mi><mml:mi>i</mml:mi><mml:mi>x</mml:mi><mml:mi>_</mml:mi><mml:mn>8</mml:mn><mml:mi>c</mml:mi><mml:mi>t</mml:mi><mml:mi>_</mml:mi><mml:mi>P</mml:mi><mml:mi>B</mml:mi><mml:mi>M</mml:mi><mml:mi>C</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="41598_2021_4473_Article_IEq10.gif"/></alternatives></inline-formula> as the testing data. Both scmap-cluster and CHETAH have a mixture of correct and incorrect predictions for the cloud of T cells with a considerable proportion of unassigned cells. In comparison, NeuCA has more similar patterns to the true labels in all major cell lineages. Additional visualizations for scmap-cell and the two unsupervised methods, Seurat and SC3, are presented in Supplementary Fig. <xref rid="MOESM1" ref-type="media">S10</xref>.</p>
    </sec>
    <sec id="Sec9">
      <title>Applications on human pancreas datasets</title>
      <p id="Par20">We applied NeuCA and other methods on four human pancreas datasets to specifically evaluate the inter-study classification performance. The four real datasets are: Baron<sup><xref ref-type="bibr" rid="CR26">26</xref></sup> data, Muraro<sup><xref ref-type="bibr" rid="CR36">36</xref></sup> data, Seg<sup><xref ref-type="bibr" rid="CR37">37</xref></sup> data, and Xin<sup><xref ref-type="bibr" rid="CR38">38</xref></sup> data. These four studies contained different numbers of cells, were obtained from different numbers of subjects, and were sequenced using different sequencing protocols. The number of subjects ranges from 4 to 18, and the number of cells ranges from 700 to &gt; 8000. Baron, Muraro, Seg, and Xin used inDrop, CEL-Seq2, Smart-Seq2, and SMARTer, respectively. To comprehensively evaluate the inter-study annotation accuracy, we iteratively used each of the four as the training set and examined the performance in the remaining three datasets. We used the published cell labels as the gold standard annotations. We processed the four datasets by first removing rare cell types, to have true labels consistency in all major cell types among these four studies. This allows for inter-study comparisons, among all available shared cell types. The four processed datasets had 1600, 2038, 8569, and 2126 cells in Xin, Seg, Baron, and Muraro datasets, respectively.</p>
      <p id="Par21">Figure <xref rid="Fig4" ref-type="fig">4</xref>A–D shows that NeuCA achieves the highest accuracy among 9 of the 12 scenarios, and comparable accuracies for the remainder. Their corresponding misclassification rates are reported in Supplementary Fig. <xref rid="MOESM1" ref-type="media">S11</xref>. In several settings, the advantage of NeuCA is substantial compared with other methods. For example, when using Baron for training and Seg for testing, NeuCA accurately assigned labels for more than 90% of the cells, while the competing methods only annotated 80% or less cells correctly. The scmap-cell method was the second-best performer in general, which gave stable performance across the scenarios.<fig id="Fig4"><label>Figure 4</label><caption><p>Cell label prediction results from applying the proposed method on four human pancreas datasets. The total cell numbers for the four datasets are 1600, 2038, 8569, and 2126. (<bold>A</bold>)–(<bold>D</bold>) show the accurately assigned cell numbers from proposed and existing methods, alternating training and testing dataset selections. (<bold>E</bold>) and (<bold>F</bold>) show the comparison of true labels (left column) and the estimated labels (right column) from NeuCA and scmap-cell, using Sankey diagrams, with Seg data as the training and Baron data as the testing dataset.</p></caption><graphic xlink:href="41598_2021_4473_Fig4_HTML" id="MO4"/></fig></p>
      <p id="Par22">Figure <xref rid="Fig4" ref-type="fig">4</xref>E,F are detailed examinations of the classification results of NeuCA and scmap-cell using Sankey diagrams. In the diagram, the width of the flows reflects the frequency of cells in each cell type. For both diagrams, we trained the model using the Seg data and tested the model using Baron data. The box column on the left shows the true frequencies of cells, while the box column on the right shows the predicted frequencies of cells. A one-to-one mapping relationship is shown in the flow in-between. NeuCA has higher overall accuracy than scmap-cell. Although the relative proportions of NeuCA and scmap-cell are similar, scmap-cell suffers from a high proportion of unassigned cells. scmap-cluster and CHETAH also suffer from high proportions of unassigned cells, leading to lower accurately assigned cells numbers (Supplementary Fig. <xref rid="MOESM1" ref-type="media">S12</xref>). Similar conclusions can be drawn from Sankey diagrams of the unsupervised learning methods Seurat and SC3 (Supplementary Fig. <xref rid="MOESM1" ref-type="media">S13</xref>).</p>
    </sec>
    <sec id="Sec10">
      <title>Applications on ASD data</title>
      <p id="Par23">Lastly, we benchmarked all methods on a cross-condition annotation problem. We obtained a set of single nucleus RNA-seq data from a study for Autism spectrum disorder (ASD)<sup><xref ref-type="bibr" rid="CR39">39</xref></sup>, a group of cognitive developmental disabilities that cause significant social, communication, and behavioral challenges<sup><xref ref-type="bibr" rid="CR40">40</xref></sup> for patients. This study contains snRNA-seq data from 15 ASD patients and 16 controls. Compared with the previous datasets, this is a much larger dataset with 52,003 cells in the ASD group and 52,556 cells in the control group. We were interested in evaluating the methods across the disease conditions, i.e., accurately predict cell types in the ASD group using the control data as the training set or vice versa. This evaluation is motivated by the pragmatic consideration that often the existing single cell data only contain normal samples, while researchers are interested in using the information in annotating the diseased subjects.</p>
      <p id="Par24">Figure <xref rid="Fig5" ref-type="fig">5</xref> shows the accuracy and ARI for two scenarios: ASD samples as the training set and control samples as the testing set (Fig. <xref rid="Fig5" ref-type="fig">5</xref>A); control samples as the training set and ASD samples as the testing set (Fig. <xref rid="Fig5" ref-type="fig">5</xref>B). NeuCA achieves the highest accuracy and ARI among all methods. The corresponding misclassification rates, for both scenarios, are reported in Supplementary Fig. <xref rid="MOESM1" ref-type="media">S14</xref>. Interestingly, NeuCA has better performance in predicting control samples than predicting ASD samples. We suspect that ASD-related molecular changes might be associated with such performance change, e.g., the differentially expressed genes make it harder to accurately annotate cells in ASD samples. scmap-cell is the second-best method in the supervised category with an accurately assigned rate around 0.7. Unsupervised methods Seurat and SC3 also have good performance, due to the large number of cells. This experiment shows that NeuCA stably outperforms existing methods in cross-condition annotations.<fig id="Fig5"><label>Figure 5</label><caption><p>Accurately assigned rate and ARI of the proposed and existing methods on the ASD data, containing both ASD disease samples and control samples. (<bold>A</bold>) shows the accuracies using ASD disease samples as the training set and control samples as the testing set. (<bold>B</bold>) shows the results using control samples as the training set and ASD disease samples as the testing set. NeuCA stably outperforms existing methods in cross-condition annotation tasks.</p></caption><graphic xlink:href="41598_2021_4473_Fig5_HTML" id="MO5"/></fig></p>
    </sec>
  </sec>
  <sec id="Sec11">
    <title>Discussion</title>
    <p id="Par25">We have developed a supervised learning method, NeuCA, for cell label assignment in single cell RNA-seq data analysis. Our method uses existing scRNA-seq data with known labels to train a neural network based classifier, adopting different strategies for highly correlated and average cell types. In situations where highly correlated cell types are absent, NeuCA adopts a feed-forward neural network for cell type classification. In situations where highly correlated cell types exist, NeuCA adjusts itself to a hierarchical neural network with an inferred cell lineage tree structure and stepwise feature selections. This flexible approach is accurate and efficient compared with existing methods, as shown in the series of numerical simulations and eight real data applications.</p>
    <p id="Par26">NeuCA aims to alleviate two problems in existing cell type annotation methods. First, data analysis using unsupervised clustering methods involves identifying cell type-specific markers and manually assigning labels. Such a step is usually laborious and time-consuming. Also, the lower dimensional projection of clusters does not necessarily represent the biologically-meaningful cell types. Moreover, manual labeling could be subjective and lack reproducibility. Second, many existing supervised approaches, such as scmap-cluster, scmap-cell, and CHETAH, fail to distinguish uncertain assignment from unknown cells, resulting in a high proportion of unassigned cells. When the cell types are well-studied, such as in PBMC and human pancreas tissues, these unassigned labels lead to an unwelcomed loss of cells in downstream analysis. Our investigation shows that existing methods tend to have difficulty in distinguishing highly correlated cell types, which leads to the unassignment problem. NeuCA’s flexible and efficient two-step approach offers solutions to both aspects.</p>
    <p id="Par27">It is worth noting that NeuCA is designed to fit the situations where cell types are well-studied, i.e., the situations where all the cell types in the new sample already exist in the reference/training data. This may appear to be very restrictive at first glance, but NeuCA is still widely applicable. First, as shown in our real data experiments, many tissue types have already been comprehensively sequenced and labeled in previous scRNA-seq studies. For example, the Human Cell Atlas (HCA) is on track to create reference maps of all human cells, providing a rich resource for obtaining comprehensive reference data. Currently HCA has curated more than 12 million cells from 55 human organs. Another example is the Mouse Cell Atlas (MCA), where over 1.2 million single cells from more than 28 mouse tissues are available. These collections provide rich resources for reference/training data for NeuCA. Second, when one expects the existence of unknown cell types in the collected samples, there are tools available for identifying those rare or unknown cells from the data<sup><xref ref-type="bibr" rid="CR41">41</xref>,<xref ref-type="bibr" rid="CR42">42</xref></sup>. This can be done as the first step prior to applying NeuCA. After unknown cells are identified, we can use NeuCA on the rest of the cells to assign labels. One example is with tumor samples, where alternative methods, such as inferCNV<sup><xref ref-type="bibr" rid="CR4">4</xref></sup> and copyKAT<sup><xref ref-type="bibr" rid="CR43">43</xref></sup>, could be applied to identify malignant cells first and NeuCA at the second step. Third, it may not be easy to decide whether unknown or novel cell types exist in the data. Although our application to ASD data shows that NeuCA can be applied to cross-condition predictions, this may not hold in other scenarios. For example, previous studies have reported that certain types of hematopoietic stem and progenitor cells (HSPC) play an important role in myelodysplastic syndromes (MDS) and that the presence of HSPC subtypes varies considerably in MDS patients<sup><xref ref-type="bibr" rid="CR44">44</xref>,<xref ref-type="bibr" rid="CR45">45</xref></sup>. We recommend consulting biological/clinical experts to make related decisions when analyzing tissues from novel conditions.</p>
    <p id="Par28">We have implemented NeuCA in an R/Bioconductor package. NeuCA uses <italic>keras</italic> as the application programming interface (API) to enable fast high-level neural network implementation. The software builds and deploys TensorFlow within R programming, and it can run on either CPU or GPU devices. Additionally, we provide a trained classifier for human PBMC data that can be directly applied. Our proposed NeuCA method is available at <ext-link ext-link-type="uri" xlink:href="https://bioconductor.org/packages/NeuCA/">https://bioconductor.org/packages/NeuCA/</ext-link> with a detailed user manual document.</p>
  </sec>
  <sec id="Sec12">
    <title>Methods</title>
    <p id="Par29">Suppose the training data consist of scRNA-seq expression matrix <inline-formula id="IEq11"><alternatives><tex-math id="M21">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathbf {X}}_{0}$$\end{document}</tex-math><mml:math id="M22"><mml:msub><mml:mi mathvariant="bold">X</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="41598_2021_4473_Article_IEq11.gif"/></alternatives></inline-formula> and the known cell type labels <inline-formula id="IEq12"><alternatives><tex-math id="M23">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\varvec{y}}_{0}$$\end{document}</tex-math><mml:math id="M24"><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">y</mml:mi></mml:mrow><mml:mn>0</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="41598_2021_4473_Article_IEq12.gif"/></alternatives></inline-formula>. Each row of <inline-formula id="IEq13"><alternatives><tex-math id="M25">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\varvec{X}}_{0}$$\end{document}</tex-math><mml:math id="M26"><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">X</mml:mi></mml:mrow><mml:mn>0</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="41598_2021_4473_Article_IEq13.gif"/></alternatives></inline-formula> is a gene and each column is a cell. <inline-formula id="IEq14"><alternatives><tex-math id="M27">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\varvec{y}}_0$$\end{document}</tex-math><mml:math id="M28"><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">y</mml:mi></mml:mrow><mml:mn>0</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="41598_2021_4473_Article_IEq14.gif"/></alternatives></inline-formula> is a vector with the same length as the total cell number (column number) in the training data. Suppose there are <italic>K</italic> distinct cell types. Given a testing scRNA-seq expression matrix <inline-formula id="IEq15"><alternatives><tex-math id="M29">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathbf {X}}_{1}$$\end{document}</tex-math><mml:math id="M30"><mml:msub><mml:mi mathvariant="bold">X</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="41598_2021_4473_Article_IEq15.gif"/></alternatives></inline-formula>, the goal of NeuCA is to predict the cell labels <inline-formula id="IEq16"><alternatives><tex-math id="M31">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\varvec{y}}_{1}$$\end{document}</tex-math><mml:math id="M32"><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">y</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="41598_2021_4473_Article_IEq16.gif"/></alternatives></inline-formula> based on <inline-formula id="IEq17"><alternatives><tex-math id="M33">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathbf {X}}_{0}$$\end{document}</tex-math><mml:math id="M34"><mml:msub><mml:mi mathvariant="bold">X</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="41598_2021_4473_Article_IEq17.gif"/></alternatives></inline-formula>, <inline-formula id="IEq18"><alternatives><tex-math id="M35">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathbf {X}}_{1}$$\end{document}</tex-math><mml:math id="M36"><mml:msub><mml:mi mathvariant="bold">X</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="41598_2021_4473_Article_IEq18.gif"/></alternatives></inline-formula>, and <inline-formula id="IEq19"><alternatives><tex-math id="M37">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\varvec{y}}_{0}$$\end{document}</tex-math><mml:math id="M38"><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">y</mml:mi></mml:mrow><mml:mn>0</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="41598_2021_4473_Article_IEq19.gif"/></alternatives></inline-formula>. After the preprocessing steps, such as normalizing the expression matrix and taking subsets of <inline-formula id="IEq20"><alternatives><tex-math id="M39">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\varvec{X}}_0$$\end{document}</tex-math><mml:math id="M40"><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">X</mml:mi></mml:mrow><mml:mn>0</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="41598_2021_4473_Article_IEq20.gif"/></alternatives></inline-formula> and <inline-formula id="IEq21"><alternatives><tex-math id="M41">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\varvec{X}}_1$$\end{document}</tex-math><mml:math id="M42"><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">X</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="41598_2021_4473_Article_IEq21.gif"/></alternatives></inline-formula> by their overlapped genes, NeuCA will train a classifier using a feed-forward neural network or a hierarchical neural network, depending on the absence or presence of highly correlated cell types. The detailed steps are described next.</p>
    <sec id="Sec13">
      <title>Correlation and NeuCA strategy</title>
      <p id="Par30">NeuCA first computes the averaged expression profile matrix for all the cell types in the training data. This is a straightforward averaging step, using the mean expression values of the cells for each cell type. Next, with the cell type-specific averaged expression profiles available, we compute the correlation matrix, <inline-formula id="IEq22"><alternatives><tex-math id="M43">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\varvec{P}} = (p_{i,j})$$\end{document}</tex-math><mml:math id="M44"><mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">P</mml:mi></mml:mrow><mml:mo>=</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="41598_2021_4473_Article_IEq22.gif"/></alternatives></inline-formula>, where <inline-formula id="IEq23"><alternatives><tex-math id="M45">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$p_{i,j}$$\end{document}</tex-math><mml:math id="M46"><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41598_2021_4473_Article_IEq23.gif"/></alternatives></inline-formula> is the Pearson’s correlation coefficient of cell type <italic>i</italic> and <italic>j</italic>. In the cases where all the off-diagonal elements in <inline-formula id="IEq24"><alternatives><tex-math id="M47">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\varvec{P}}$$\end{document}</tex-math><mml:math id="M48"><mml:mrow><mml:mi mathvariant="bold-italic">P</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="41598_2021_4473_Article_IEq24.gif"/></alternatives></inline-formula> are smaller than a threshold of <inline-formula id="IEq25"><alternatives><tex-math id="M49">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\tau$$\end{document}</tex-math><mml:math id="M50"><mml:mi>τ</mml:mi></mml:math><inline-graphic xlink:href="41598_2021_4473_Article_IEq25.gif"/></alternatives></inline-formula>, NeuCA trains a feed-forward neural network using the training data and predicts the labels in the testing data. Otherwise, when highly correlated cell types exist, it uses a hierarchical neural network tree as the classifier. The threshold <inline-formula id="IEq26"><alternatives><tex-math id="M51">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\tau$$\end{document}</tex-math><mml:math id="M52"><mml:mi>τ</mml:mi></mml:math><inline-graphic xlink:href="41598_2021_4473_Article_IEq26.gif"/></alternatives></inline-formula> quantifies the cut-off level of correlations of highly correlated cell types. We used <inline-formula id="IEq27"><alternatives><tex-math id="M53">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\tau = 0.95$$\end{document}</tex-math><mml:math id="M54"><mml:mrow><mml:mi>τ</mml:mi><mml:mo>=</mml:mo><mml:mn>0.95</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="41598_2021_4473_Article_IEq27.gif"/></alternatives></inline-formula> across all of the numerical simulations and real data experiments. Intuitively, we believe the hierarchical-based cell annotation is more beneficial for scenarios with more cell types and more complicated structures. And thus, users may choose smaller <inline-formula id="IEq28"><alternatives><tex-math id="M55">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\tau$$\end{document}</tex-math><mml:math id="M56"><mml:mi>τ</mml:mi></mml:math><inline-graphic xlink:href="41598_2021_4473_Article_IEq28.gif"/></alternatives></inline-formula> for these scenarios to encourage the usage of hierarchical annotation. Biological knowledge may also be helpful to evaluate whether the cell type structure is complicated or not.</p>
    </sec>
    <sec id="Sec14">
      <title>Feed-forward neural network</title>
      <p id="Par31">Given the training scRNA-seq matrix <inline-formula id="IEq29"><alternatives><tex-math id="M57">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\varvec{X}}_0$$\end{document}</tex-math><mml:math id="M58"><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">X</mml:mi></mml:mrow><mml:mn>0</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="41598_2021_4473_Article_IEq29.gif"/></alternatives></inline-formula> and the cell label vector <inline-formula id="IEq30"><alternatives><tex-math id="M59">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\varvec{y}}_0$$\end{document}</tex-math><mml:math id="M60"><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">y</mml:mi></mml:mrow><mml:mn>0</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="41598_2021_4473_Article_IEq30.gif"/></alternatives></inline-formula>, the feed-forward neural network with <italic>L</italic> hidden layers has a standard architecture<disp-formula id="Equ1"><alternatives><tex-math id="M61">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} Pr({\varvec{y_0}}|{\varvec{X}}, {\varvec{\Theta }})&amp;= g({\varvec{Z}}_{out}{\varvec{W}}_{out} + {\varvec{\beta }}_{out}) \\ {\varvec{Z}}_{out}&amp;= \sigma ({\varvec{Z}}_L{\varvec{W}}_L + {\varvec{\beta }}_{L})\\&amp;\cdots \\ {\varvec{Z}}_{l+1}&amp;= \sigma ({\varvec{Z}}_l{\varvec{W}}_l + {\varvec{\beta }}_{l})\\&amp;\cdots \\ {\varvec{Z}}_{1}&amp;= \sigma ({\varvec{X}}_0{\varvec{W}}_0 + {\varvec{\beta }}_{0}), \end{aligned}$$\end{document}</tex-math><mml:math id="M62" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>P</mml:mi><mml:mi>r</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mi mathvariant="bold-italic">y</mml:mi><mml:mn mathvariant="bold">0</mml:mn></mml:msub></mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">X</mml:mi></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:mi mathvariant="bold">Θ</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo><mml:mi>g</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">Z</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">out</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">W</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">out</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">β</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">out</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mrow/><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">Z</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">out</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo><mml:mi>σ</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">Z</mml:mi></mml:mrow><mml:mi>L</mml:mi></mml:msub><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">W</mml:mi></mml:mrow><mml:mi>L</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">β</mml:mi></mml:mrow><mml:mi>L</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow/></mml:mtd><mml:mtd columnalign="left"><mml:mo>⋯</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mrow/><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">Z</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo><mml:mi>σ</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">Z</mml:mi></mml:mrow><mml:mi>l</mml:mi></mml:msub><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">W</mml:mi></mml:mrow><mml:mi>l</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">β</mml:mi></mml:mrow><mml:mi>l</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow/></mml:mtd><mml:mtd columnalign="left"><mml:mo>⋯</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mrow/><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">Z</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo><mml:mi>σ</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">X</mml:mi></mml:mrow><mml:mn>0</mml:mn></mml:msub><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">W</mml:mi></mml:mrow><mml:mn>0</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">β</mml:mi></mml:mrow><mml:mn>0</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="41598_2021_4473_Article_Equ1.gif" position="anchor"/></alternatives></disp-formula>where <inline-formula id="IEq31"><alternatives><tex-math id="M63">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\varvec{\Theta }} = \{{\varvec{W}}_0, \ldots , {\varvec{W}}_l, \ldots , {\varvec{W}}_L, {\varvec{\beta }}_0, \ldots , {\varvec{\beta }}_l, \ldots , {\varvec{\beta }}_L, {\varvec{W}}_{out}, {\varvec{\beta }}_{out}\}. {\varvec{Z}}_l$$\end{document}</tex-math><mml:math id="M64"><mml:mrow><mml:mrow><mml:mi mathvariant="bold">Θ</mml:mi></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">W</mml:mi></mml:mrow><mml:mn>0</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">W</mml:mi></mml:mrow><mml:mi>l</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">W</mml:mi></mml:mrow><mml:mi>L</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">β</mml:mi></mml:mrow><mml:mn>0</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">β</mml:mi></mml:mrow><mml:mi>l</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">β</mml:mi></mml:mrow><mml:mi>L</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">W</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">out</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">β</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">out</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">}</mml:mo></mml:mrow><mml:mo>.</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">Z</mml:mi></mml:mrow><mml:mi>l</mml:mi></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="41598_2021_4473_Article_IEq31.gif"/></alternatives></inline-formula>, for <inline-formula id="IEq32"><alternatives><tex-math id="M65">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$l = 1, \ldots , L-1$$\end{document}</tex-math><mml:math id="M66"><mml:mrow><mml:mi>l</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mi>L</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="41598_2021_4473_Article_IEq32.gif"/></alternatives></inline-formula>, are the hidden neurons with corresponding weight matrices <inline-formula id="IEq33"><alternatives><tex-math id="M67">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$W_l$$\end{document}</tex-math><mml:math id="M68"><mml:msub><mml:mi>W</mml:mi><mml:mi>l</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="41598_2021_4473_Article_IEq33.gif"/></alternatives></inline-formula> and bias vectors <inline-formula id="IEq34"><alternatives><tex-math id="M69">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\varvec{\beta }}_l$$\end{document}</tex-math><mml:math id="M70"><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">β</mml:mi></mml:mrow><mml:mi>l</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="41598_2021_4473_Article_IEq34.gif"/></alternatives></inline-formula>. The dimensions of <inline-formula id="IEq35"><alternatives><tex-math id="M71">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\varvec{Z}}$$\end{document}</tex-math><mml:math id="M72"><mml:mrow><mml:mi mathvariant="bold-italic">Z</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="41598_2021_4473_Article_IEq35.gif"/></alternatives></inline-formula> and <inline-formula id="IEq36"><alternatives><tex-math id="M73">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\varvec{W}}$$\end{document}</tex-math><mml:math id="M74"><mml:mrow><mml:mi mathvariant="bold-italic">W</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="41598_2021_4473_Article_IEq36.gif"/></alternatives></inline-formula> depend on the number of hidden neurons, the input dimension, and the number of cell types <italic>K</italic>. <inline-formula id="IEq37"><alternatives><tex-math id="M75">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\sigma (\cdot )$$\end{document}</tex-math><mml:math id="M76"><mml:mrow><mml:mi>σ</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mo>·</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="41598_2021_4473_Article_IEq37.gif"/></alternatives></inline-formula> is the activation function such as sigmoid, hyperbolic tangent, or rectifiers. <inline-formula id="IEq38"><alternatives><tex-math id="M77">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$g(\cdot )$$\end{document}</tex-math><mml:math id="M78"><mml:mrow><mml:mi>g</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mo>·</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="41598_2021_4473_Article_IEq38.gif"/></alternatives></inline-formula> is the softmax function that converts the values of the output layer into predicted probabilities. For example, for the <italic>i</italic>-th cell in the training set,<disp-formula id="Equ2"><alternatives><tex-math id="M79">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} p_{ik} = g(\eta _{ik}) = \frac{\exp (\eta _{ik})}{\Sigma _{j = 1}^{K}\exp (\eta _{ij})}, \end{aligned}$$\end{document}</tex-math><mml:math id="M80" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi mathvariant="italic">ik</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>g</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>η</mml:mi><mml:mrow><mml:mi mathvariant="italic">ik</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mo>exp</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>η</mml:mi><mml:mrow><mml:mi mathvariant="italic">ik</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:msubsup><mml:mi mathvariant="normal">Σ</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>K</mml:mi></mml:msubsup><mml:mo>exp</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>η</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mfrac><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="41598_2021_4473_Article_Equ2.gif" position="anchor"/></alternatives></disp-formula>where <inline-formula id="IEq39"><alternatives><tex-math id="M81">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$p_{ik} = \Pr (y_i = k | {\varvec{x}}_i)$$\end{document}</tex-math><mml:math id="M82"><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi mathvariant="italic">ik</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mo>Pr</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">|</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="41598_2021_4473_Article_IEq39.gif"/></alternatives></inline-formula>, <inline-formula id="IEq40"><alternatives><tex-math id="M83">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\eta _{ik} = [{\varvec{z}}_i^{(out)}]^T {\varvec{w}}_k^{(out)} + b_i^{(out)}$$\end{document}</tex-math><mml:math id="M84"><mml:mrow><mml:msub><mml:mi>η</mml:mi><mml:mrow><mml:mi mathvariant="italic">ik</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:msubsup><mml:mrow><mml:mi mathvariant="bold-italic">z</mml:mi></mml:mrow><mml:mi>i</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>o</mml:mi><mml:mi>u</mml:mi><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo stretchy="false">]</mml:mo></mml:mrow><mml:mi>T</mml:mi></mml:msup><mml:msubsup><mml:mrow><mml:mi mathvariant="bold-italic">w</mml:mi></mml:mrow><mml:mi>k</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>o</mml:mi><mml:mi>u</mml:mi><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo>+</mml:mo><mml:msubsup><mml:mi>b</mml:mi><mml:mi>i</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>o</mml:mi><mml:mi>u</mml:mi><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:math><inline-graphic xlink:href="41598_2021_4473_Article_IEq40.gif"/></alternatives></inline-formula> and <inline-formula id="IEq41"><alternatives><tex-math id="M85">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$i = 1, \ldots , n$$\end{document}</tex-math><mml:math id="M86"><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="41598_2021_4473_Article_IEq41.gif"/></alternatives></inline-formula>. The parameters to be estimated in the feed-forward neural network are all the weights and biases, i.e., <inline-formula id="IEq42"><alternatives><tex-math id="M87">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\varvec{\Theta }}$$\end{document}</tex-math><mml:math id="M88"><mml:mrow><mml:mi mathvariant="bold">Θ</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="41598_2021_4473_Article_IEq42.gif"/></alternatives></inline-formula>. We train the model using a Stochastic Gradient Descent (SGD) based algorithm with the following categorical cross-entropy loss as the objective function:<disp-formula id="Equ3"><alternatives><tex-math id="M89">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} \mathrm {L}({\varvec{\Theta }}) = -\frac{1}{n} \sum _{i = 1}^{n}{{\varvec{1}}(y_i = k)\log ({\widehat{p}}_{ik})}, \end{aligned}$$\end{document}</tex-math><mml:math id="M90" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi mathvariant="normal">L</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi mathvariant="bold">Θ</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mo>-</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mi>n</mml:mi></mml:mfrac><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>n</mml:mi></mml:munderover><mml:mrow><mml:mrow><mml:mn mathvariant="bold">1</mml:mn></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>log</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>p</mml:mi><mml:mo stretchy="true">^</mml:mo></mml:mover><mml:mrow><mml:mi mathvariant="italic">ik</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="41598_2021_4473_Article_Equ3.gif" position="anchor"/></alternatives></disp-formula><inline-formula id="IEq43"><alternatives><tex-math id="M91">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\varvec{1}}(\cdot )$$\end{document}</tex-math><mml:math id="M92"><mml:mrow><mml:mrow><mml:mn mathvariant="bold">1</mml:mn></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mo>·</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="41598_2021_4473_Article_IEq43.gif"/></alternatives></inline-formula> is an indicator function, and equals 1 only when the expression inside the bracket holds.</p>
      <p id="Par32">The activation functions used here were the rectified linear unit (ReLU), <inline-formula id="IEq44"><alternatives><tex-math id="M93">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\sigma _{ReLU}(z) = max(z, 0)$$\end{document}</tex-math><mml:math id="M94"><mml:mrow><mml:msub><mml:mi>σ</mml:mi><mml:mrow><mml:mi mathvariant="italic">ReLU</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>z</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mi>m</mml:mi><mml:mi>a</mml:mi><mml:mi>x</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>z</mml:mi><mml:mo>,</mml:mo><mml:mn>0</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="41598_2021_4473_Article_IEq44.gif"/></alternatives></inline-formula>, for a scaler variable <italic>z</italic>. The ReLU activation function has become the default activation for many types of neural networks because the model using ReLU is generally easier to train and often achieves better performance than alternative functions<sup><xref ref-type="bibr" rid="CR46">46</xref></sup>. In addition, ReLU can avoid the vanishing gradient problem during optimization, which is an advantage over sigmoid and hyperbolic tangent functions<sup><xref ref-type="bibr" rid="CR47">47</xref></sup>. For the optimization algorithm, we chose to use the RMSprop optimizer, as a recent comparison study shows the top accuracy using RMSprop over Momentem or AdaGrad, among others<sup><xref ref-type="bibr" rid="CR48">48</xref></sup>. We also used the mini-batch training strategy that randomly trains a small proportion of the samples in each iteration<sup><xref ref-type="bibr" rid="CR48">48</xref></sup>. We additionally have tried applying recent deep learning techniques on the training feed-forward neural network, such as batch normalization and dropout, and found the performance stayed similar with and without these techniques (data not shown).</p>
      <p id="Par33">In neural networks, the numbers of layers and nodes are also tunable parameters. Instead of changing these parameters in each and every application, we stratified them as three sets of choices in our experiments. We used 2, 3, and 4 hidden layers, respectively, for small, medium, and big model sizes. The number of nodes in the hidden layers are provided in Table <xref rid="Tab1" ref-type="table">1</xref>. Although these choices may not be optimal over the full sets of parameter combinations, we found the current model setup can generate good performance in practice.<table-wrap id="Tab1"><label>Table 1</label><caption><p>Three different model sizes that can be selected in the feed-forward neural network classifier training.</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left">Neural network model size</th><th align="left">No. of layers</th><th align="left">No. of nodes in the hidden layers</th></tr></thead><tbody><tr><td align="left">Small</td><td align="left">3</td><td align="left">64</td></tr><tr><td align="left">Medium</td><td align="left">4</td><td align="left">64, 128</td></tr><tr><td align="left">Big</td><td align="left">5</td><td align="left">64, 128, 256</td></tr></tbody></table></table-wrap></p>
    </sec>
    <sec id="Sec15">
      <title>Cell lineage-based hierarchical neural network</title>
      <p id="Par34">Our cell lineage-based hierarchical neural network is specially designed to handle the situation where highly correlated cell types exist. The training stage consists of four major steps. First, we construct a cell lineage hierarchical tree based on the average cell type profiles. Using the training dataset containing known cell labels, we calculate the averaged gene expression profile for each cell type. The averaged gene expression profile is denoted as a <inline-formula id="IEq45"><alternatives><tex-math id="M95">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$G \times K$$\end{document}</tex-math><mml:math id="M96"><mml:mrow><mml:mi>G</mml:mi><mml:mo>×</mml:mo><mml:mi>K</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="41598_2021_4473_Article_IEq45.gif"/></alternatives></inline-formula> matrix <inline-formula id="IEq46"><alternatives><tex-math id="M97">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\varvec{A}}$$\end{document}</tex-math><mml:math id="M98"><mml:mrow><mml:mi mathvariant="bold-italic">A</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="41598_2021_4473_Article_IEq46.gif"/></alternatives></inline-formula>, where <italic>G</italic> is the number of genes and <italic>K</italic> is the number of cell types. On the columns of <inline-formula id="IEq47"><alternatives><tex-math id="M99">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\varvec{A}}$$\end{document}</tex-math><mml:math id="M100"><mml:mrow><mml:mi mathvariant="bold-italic">A</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="41598_2021_4473_Article_IEq47.gif"/></alternatives></inline-formula>, we conduct a hierarchical clustering using complete linkage. Now we obtain a hierarchical tree, visible using dendrogram, with each leaf node representing one cell type. This hierarchical tree will be used in the following step as a road map. In the second step, we label the regular correlated cell types using highly sensitive markers. We compute the highly sensitive marker genes for cell type <italic>k</italic> by<disp-formula id="Equ4"><alternatives><tex-math id="M101">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} \text {Sen}_{gk} = \sum _{c \in \{1, \ldots , n\}} {\varvec{1}}(X_{gc}&gt;0 \wedge y_{c} = k)/ {\varvec{1}}(X_{gc}&gt;0). \end{aligned}$$\end{document}</tex-math><mml:math id="M102" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mtext>Sen</mml:mtext><mml:mrow><mml:mi mathvariant="italic">gk</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>c</mml:mi><mml:mo>∈</mml:mo><mml:mo stretchy="false">{</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:munder><mml:mrow><mml:mn mathvariant="bold">1</mml:mn></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:mi mathvariant="italic">gc</mml:mi></mml:mrow></mml:msub><mml:mo>&gt;</mml:mo><mml:mn>0</mml:mn><mml:mo>∧</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mi>c</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo stretchy="false">/</mml:mo><mml:mrow><mml:mn mathvariant="bold">1</mml:mn></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:mi mathvariant="italic">gc</mml:mi></mml:mrow></mml:msub><mml:mo>&gt;</mml:mo><mml:mn>0</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="41598_2021_4473_Article_Equ4.gif" position="anchor"/></alternatives></disp-formula>The genes with <inline-formula id="IEq48"><alternatives><tex-math id="M103">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\text {Sen}_{gk}&gt;0.95$$\end{document}</tex-math><mml:math id="M104"><mml:mrow><mml:msub><mml:mtext>Sen</mml:mtext><mml:mrow><mml:mi mathvariant="italic">gk</mml:mi></mml:mrow></mml:msub><mml:mo>&gt;</mml:mo><mml:mn>0.95</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="41598_2021_4473_Article_IEq48.gif"/></alternatives></inline-formula> for each cell type were deemed as the cell type specific genes. For cell types with more than <inline-formula id="IEq49"><alternatives><tex-math id="M105">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\nu _1$$\end{document}</tex-math><mml:math id="M106"><mml:msub><mml:mi>ν</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="41598_2021_4473_Article_IEq49.gif"/></alternatives></inline-formula> highly sensitive markers, we identify the cells expressing more than <inline-formula id="IEq50"><alternatives><tex-math id="M107">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\nu _2$$\end{document}</tex-math><mml:math id="M108"><mml:msub><mml:mi>ν</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="41598_2021_4473_Article_IEq50.gif"/></alternatives></inline-formula> cell type-specific genes and assigned the corresponding cell labels. <inline-formula id="IEq51"><alternatives><tex-math id="M109">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\nu _1$$\end{document}</tex-math><mml:math id="M110"><mml:msub><mml:mi>ν</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="41598_2021_4473_Article_IEq51.gif"/></alternatives></inline-formula> controls the number of cell types that can be decided by the highly sensitive markers and <inline-formula id="IEq52"><alternatives><tex-math id="M111">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\nu _2$$\end{document}</tex-math><mml:math id="M112"><mml:msub><mml:mi>ν</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="41598_2021_4473_Article_IEq52.gif"/></alternatives></inline-formula> decides the quality of this marker-based assignment. We explore the impacts of <inline-formula id="IEq53"><alternatives><tex-math id="M113">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\nu _1$$\end{document}</tex-math><mml:math id="M114"><mml:msub><mml:mi>ν</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="41598_2021_4473_Article_IEq53.gif"/></alternatives></inline-formula> and <inline-formula id="IEq54"><alternatives><tex-math id="M115">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\nu _2$$\end{document}</tex-math><mml:math id="M116"><mml:msub><mml:mi>ν</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="41598_2021_4473_Article_IEq54.gif"/></alternatives></inline-formula> selection on the annotation accuracy (Supplementary Fig. <xref rid="MOESM1" ref-type="media">S15</xref>) and find that the impact is small under the current setting. As a result, we use <inline-formula id="IEq55"><alternatives><tex-math id="M117">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\nu _1 = 10$$\end{document}</tex-math><mml:math id="M118"><mml:mrow><mml:msub><mml:mi>ν</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mn>10</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="41598_2021_4473_Article_IEq55.gif"/></alternatives></inline-formula> and <inline-formula id="IEq56"><alternatives><tex-math id="M119">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\nu _2 = 3$$\end{document}</tex-math><mml:math id="M120"><mml:mrow><mml:msub><mml:mi>ν</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="41598_2021_4473_Article_IEq56.gif"/></alternatives></inline-formula> for all of our experiments. We find that highly sensitive markers alone are already accurate in labeling regular cell types, but they cannot address highly correlated cell types. Third, we iterate the rest of the cells through the hierarchical tree and performed additional feature selection. At each bifurcation, we perform the differential analysis provided in limma<sup><xref ref-type="bibr" rid="CR49">49</xref></sup> to compare the cells from the left and right branches and select the top <italic>M</italic> genes as the bifurcation-specific features. As shown by our parameter exploration in Supplementary Fig. <xref rid="MOESM1" ref-type="media">S15</xref>, the results are robust to different selection of marker numbers. We use <inline-formula id="IEq57"><alternatives><tex-math id="M121">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$M=1000$$\end{document}</tex-math><mml:math id="M122"><mml:mrow><mml:mi>M</mml:mi><mml:mo>=</mml:mo><mml:mn>1000</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="41598_2021_4473_Article_IEq57.gif"/></alternatives></inline-formula> in all of our experiments. Finally, at each bifurcation along the hierarchical tree, we train a feed-forward neural network to classify the cells from the upstream to binary outcomes (“left” or “right”). In each bifurcation node, we use the same feed-forward neural network setting and training as described in the “<xref rid="Sec11" ref-type="sec">Feed-forward neural network</xref>” section above. The only difference is that we replace the categorical cross-entropy by a binary cross-entropy, defined as<disp-formula id="Equ5"><alternatives><tex-math id="M123">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} \mathrm {L}({\varvec{\Theta }}) = -\frac{1}{n} \sum _{i = 1}^{n}{{\widetilde{y}}_i\log ({\widehat{p}}_{i}) + (1-{\widetilde{y}}_i)\log (1-{\widehat{p}}_{i})}, \end{aligned}$$\end{document}</tex-math><mml:math id="M124" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi mathvariant="normal">L</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi mathvariant="bold">Θ</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mo>-</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mi>n</mml:mi></mml:mfrac><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>n</mml:mi></mml:munderover><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>y</mml:mi><mml:mo stretchy="true">~</mml:mo></mml:mover><mml:mi>i</mml:mi></mml:msub><mml:mo>log</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>p</mml:mi><mml:mo stretchy="true">^</mml:mo></mml:mover><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>y</mml:mi><mml:mo stretchy="true">~</mml:mo></mml:mover><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>log</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>p</mml:mi><mml:mo stretchy="true">^</mml:mo></mml:mover><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="41598_2021_4473_Article_Equ5.gif" position="anchor"/></alternatives></disp-formula>where <inline-formula id="IEq58"><alternatives><tex-math id="M125">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\widetilde{y}}_i = 1$$\end{document}</tex-math><mml:math id="M126"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>y</mml:mi><mml:mo stretchy="true">~</mml:mo></mml:mover><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="41598_2021_4473_Article_IEq58.gif"/></alternatives></inline-formula> if <inline-formula id="IEq59"><alternatives><tex-math id="M127">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$y_i$$\end{document}</tex-math><mml:math id="M128"><mml:msub><mml:mi>y</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="41598_2021_4473_Article_IEq59.gif"/></alternatives></inline-formula> belongs to the right branch and 0 otherwise. When the classification reaches the output layer, the corresponding cell labels are assigned.</p>
    </sec>
    <sec id="Sec16">
      <title>Numerical simulations using real PBMC data</title>
      <p id="Par35">Real PBMC data from the 10X Genomics website (<ext-link ext-link-type="uri" xlink:href="https://support.10xgenomics.com/">https://support.10xgenomics.com/</ext-link>)<sup><xref ref-type="bibr" rid="CR31">31</xref></sup> were downloaded and processed to generate our simulation datasets. The cells in the real PBMC data were FACS-sorted and consisted of 9139 CD4 T helper cells, 7959 B cells, 718 CD14 monocytes, 7601 natural killer cells, 9338 memory T cells, 10,993 naive cytotoxic T cells, 7700 naive T cells, and 7861 regulatory T cells. We designed three simulation settings to evaluate the methods under different scenarios. In the first setting, we randomly drew <italic>p</italic> proportion of cells as the training set. Among the rest of <inline-formula id="IEq60"><alternatives><tex-math id="M129">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$1-p$$\end{document}</tex-math><mml:math id="M130"><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mi>p</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="41598_2021_4473_Article_IEq60.gif"/></alternatives></inline-formula> proportion of cells, we drew <italic>n</italic> cells as the testing set. We consider <inline-formula id="IEq61"><alternatives><tex-math id="M131">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$p = 10\%, 20\%, 50\%, 80\%$$\end{document}</tex-math><mml:math id="M132"><mml:mrow><mml:mi>p</mml:mi><mml:mo>=</mml:mo><mml:mn>10</mml:mn><mml:mo>%</mml:mo><mml:mo>,</mml:mo><mml:mn>20</mml:mn><mml:mo>%</mml:mo><mml:mo>,</mml:mo><mml:mn>50</mml:mn><mml:mo>%</mml:mo><mml:mo>,</mml:mo><mml:mn>80</mml:mn><mml:mo>%</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="41598_2021_4473_Article_IEq61.gif"/></alternatives></inline-formula> and <inline-formula id="IEq62"><alternatives><tex-math id="M133">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$n = 800, 1600, 4000$$\end{document}</tex-math><mml:math id="M134"><mml:mrow><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:mn>800</mml:mn><mml:mo>,</mml:mo><mml:mn>1600</mml:mn><mml:mo>,</mml:mo><mml:mn>4000</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="41598_2021_4473_Article_IEq62.gif"/></alternatives></inline-formula>. In the second setting, we focused the experiment on the T cells only. This aims to evaluate the performance of methods when all cell types are moderately or highly correlated. Thus, the five T cell types (i.e., CD4 T helper, memory T, naive cytotoxic T, naive T, and regulatory T) were considered here. In the third setting, we considered the major cell types and merged all of the five T cell types into one cell type: “T cells”. We used the same set of <italic>p</italic> and <italic>n</italic> in the second and third settings to evaluate the impacts of varying training and testing sample sizes.</p>
    </sec>
    <sec id="Sec17">
      <title>Real data analysis</title>
      <p id="Par36">In addition to the PBMC data used in the numerical simulation, we obtained another eight real datasets to validate the methods. The <italic>Zheng_8ct_PBMC</italic> data were downloaded from the R/Bioconductor package <italic>DuoClustering2018</italic>. The FACS sorted natural killer dataset was originally sequenced by<sup><xref ref-type="bibr" rid="CR34">34</xref></sup> and downloaded from the Gene Expression Omnibus (GEO, accession number: GSE130430). The FACS-sorted monocytes dataset was sequenced by<sup><xref ref-type="bibr" rid="CR35">35</xref></sup> and downloaded from GEO (GSE103544). The Xin<sup><xref ref-type="bibr" rid="CR38">38</xref></sup>, Baron<sup><xref ref-type="bibr" rid="CR26">26</xref></sup>, and Muraro<sup><xref ref-type="bibr" rid="CR36">36</xref></sup> datasets were also downloaded from GEO with accession GSE81608, GSE84133, and GSE85241, respectively. The Seg dataset<sup><xref ref-type="bibr" rid="CR37">37</xref></sup> was downloaded from the European Molecular Biology Laboratory (EMBL-EBI, <ext-link ext-link-type="uri" xlink:href="https://www.ebi.ac.uk/">https://www.ebi.ac.uk/</ext-link>, accession number E-MTAB-5061). Published cell labels were obtained for each study and used as true cell type labels.</p>
    </sec>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Information</title>
    <sec id="Sec18">
      <p>
        <supplementary-material content-type="local-data" id="MOESM1">
          <media xlink:href="41598_2021_4473_MOESM1_ESM.pdf">
            <caption>
              <p>Supplementary Figures.</p>
            </caption>
          </media>
        </supplementary-material>
      </p>
    </sec>
  </sec>
</body>
<back>
  <fn-group>
    <fn>
      <p>
        <bold>Publisher's note</bold>
      </p>
      <p>Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p>
    </fn>
  </fn-group>
  <sec>
    <title>Supplementary Information</title>
    <p>The online version contains supplementary material available at 10.1038/s41598-021-04473-4.</p>
  </sec>
  <ack>
    <title>Acknowledgements</title>
    <p>This study was supported by intramural funding from The University of Texas MD Anderson Cancer Center and Case Western Reserve University.</p>
  </ack>
  <notes notes-type="author-contribution">
    <title>Author contributions</title>
    <p>Z.L. and H.F. conceived the models, conducted simulation and real data experiments, and wrote and reviewed the manuscript. H.F. developed the software package.</p>
  </notes>
  <notes id="FPar1" notes-type="COI-statement">
    <title>Competing interests</title>
    <p id="Par37">The authors declare no competing interests.</p>
  </notes>
  <ref-list id="Bib1">
    <title>References</title>
    <ref id="CR1">
      <label>1.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Andor</surname>
            <given-names>N</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Joint single cell DNA-seq and RNA-seq of gastric cancer cell lines reveals rules of in vitro evolution</article-title>
        <source>NAR Genomics Bioinform.</source>
        <year>2020</year>
        <volume>2</volume>
        <fpage>lqaa016</fpage>
      </element-citation>
    </ref>
    <ref id="CR2">
      <label>2.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>van Galen</surname>
            <given-names>P</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Single-cell RNA-seq reveals AML hierarchies relevant to disease progression and immunity</article-title>
        <source>Cell</source>
        <year>2019</year>
        <volume>176</volume>
        <fpage>1265</fpage>
        <lpage>1281</lpage>
        <?supplied-pmid 30827681?>
        <pub-id pub-id-type="pmid">30827681</pub-id>
      </element-citation>
    </ref>
    <ref id="CR3">
      <label>3.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Mathys</surname>
            <given-names>H</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Single-cell transcriptomic analysis of Alzheimer’s disease</article-title>
        <source>Nature</source>
        <year>2019</year>
        <volume>570</volume>
        <fpage>332</fpage>
        <lpage>337</lpage>
        <?supplied-pmid 6865822?>
        <pub-id pub-id-type="pmid">31042697</pub-id>
      </element-citation>
    </ref>
    <ref id="CR4">
      <label>4.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Patel</surname>
            <given-names>AP</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Single-cell RNA-seq highlights intratumoral heterogeneity in primary glioblastoma</article-title>
        <source>Science</source>
        <year>2014</year>
        <volume>344</volume>
        <fpage>1396</fpage>
        <lpage>1401</lpage>
        <?supplied-pmid 24925914?>
        <pub-id pub-id-type="pmid">24925914</pub-id>
      </element-citation>
    </ref>
    <ref id="CR5">
      <label>5.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Chung</surname>
            <given-names>W</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Single-cell RNA-seq enables comprehensive tumour and immune cell profiling in primary breast cancer</article-title>
        <source>Nat. Commun.</source>
        <year>2017</year>
        <volume>8</volume>
        <fpage>1</fpage>
        <lpage>12</lpage>
        <pub-id pub-id-type="pmid">28232747</pub-id>
      </element-citation>
    </ref>
    <ref id="CR6">
      <label>6.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Rozenblatt-Rosen</surname>
            <given-names>O</given-names>
          </name>
          <name>
            <surname>Stubbington</surname>
            <given-names>MJ</given-names>
          </name>
          <name>
            <surname>Regev</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Teichmann</surname>
            <given-names>SA</given-names>
          </name>
        </person-group>
        <article-title>The human cell atlas: From vision to reality</article-title>
        <source>Nat. News</source>
        <year>2017</year>
        <volume>550</volume>
        <fpage>451</fpage>
      </element-citation>
    </ref>
    <ref id="CR7">
      <label>7.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Regev</surname>
            <given-names>A</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Science forum: The human cell atlas</article-title>
        <source>Elife</source>
        <year>2017</year>
        <volume>6</volume>
        <fpage>e27041</fpage>
        <?supplied-pmid 29206104?>
        <pub-id pub-id-type="pmid">29206104</pub-id>
      </element-citation>
    </ref>
    <ref id="CR8">
      <label>8.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <collab>Consortium</collab>
          <etal/>
        </person-group>
        <article-title>Single-cell transcriptomics of 20 mouse organs creates a tabula muris</article-title>
        <source>Nature</source>
        <year>2018</year>
        <volume>562</volume>
        <fpage>367</fpage>
        <lpage>372</lpage>
        <pub-id pub-id-type="pmid">30283141</pub-id>
      </element-citation>
    </ref>
    <ref id="CR9">
      <label>9.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Han</surname>
            <given-names>X</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Mapping the mouse cell atlas by microwell-seq</article-title>
        <source>Cell</source>
        <year>2018</year>
        <volume>172</volume>
        <fpage>1091</fpage>
        <lpage>1107</lpage>
        <?supplied-pmid 29474909?>
        <pub-id pub-id-type="pmid">29474909</pub-id>
      </element-citation>
    </ref>
    <ref id="CR10">
      <label>10.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Satija</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Farrell</surname>
            <given-names>JA</given-names>
          </name>
          <name>
            <surname>Gennert</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Schier</surname>
            <given-names>AF</given-names>
          </name>
          <name>
            <surname>Regev</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>Spatial reconstruction of single-cell gene expression data</article-title>
        <source>Nat. Biotechnol.</source>
        <year>2015</year>
        <volume>33</volume>
        <fpage>495</fpage>
        <lpage>502</lpage>
        <?supplied-pmid 25867923?>
        <pub-id pub-id-type="pmid">25867923</pub-id>
      </element-citation>
    </ref>
    <ref id="CR11">
      <label>11.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kiselev</surname>
            <given-names>VY</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Sc3: Consensus clustering of single-cell RNA-seq data</article-title>
        <source>Nat. Methods</source>
        <year>2017</year>
        <volume>14</volume>
        <fpage>483</fpage>
        <lpage>486</lpage>
        <?supplied-pmid 28346451?>
        <pub-id pub-id-type="pmid">28346451</pub-id>
      </element-citation>
    </ref>
    <ref id="CR12">
      <label>12.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ji</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Ji</surname>
            <given-names>H</given-names>
          </name>
        </person-group>
        <article-title>Tscan: Pseudo-time reconstruction and evaluation in single-cell RNA-seq analysis</article-title>
        <source>Nucleic Acids Res.</source>
        <year>2016</year>
        <volume>44</volume>
        <fpage>e117</fpage>
        <lpage>e117</lpage>
        <?supplied-pmid 27179027?>
        <pub-id pub-id-type="pmid">27179027</pub-id>
      </element-citation>
    </ref>
    <ref id="CR13">
      <label>13.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kiselev</surname>
            <given-names>VY</given-names>
          </name>
          <name>
            <surname>Yiu</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Hemberg</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>scmap: Projection of single-cell RNA-seq data across data sets</article-title>
        <source>Nat. Methods</source>
        <year>2018</year>
        <volume>15</volume>
        <fpage>359</fpage>
        <lpage>362</lpage>
        <?supplied-pmid 29608555?>
        <pub-id pub-id-type="pmid">29608555</pub-id>
      </element-citation>
    </ref>
    <ref id="CR14">
      <label>14.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>de Kanter</surname>
            <given-names>JK</given-names>
          </name>
          <name>
            <surname>Lijnzaad</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Candelli</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Margaritis</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Holstege</surname>
            <given-names>FC</given-names>
          </name>
        </person-group>
        <article-title>Chetah: A selective, hierarchical cell type identification method for single-cell RNA sequencing</article-title>
        <source>Nucleic Acids Res.</source>
        <year>2019</year>
        <volume>47</volume>
        <fpage>e95</fpage>
        <lpage>e95</lpage>
        <?supplied-pmid 31226206?>
        <pub-id pub-id-type="pmid">31226206</pub-id>
      </element-citation>
    </ref>
    <ref id="CR15">
      <label>15.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zhang</surname>
            <given-names>AW</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Probabilistic cell-type assignment of single-cell RNA-seq for tumor microenvironment profiling</article-title>
        <source>Nat. Methods</source>
        <year>2019</year>
        <volume>16</volume>
        <fpage>1007</fpage>
        <lpage>1015</lpage>
        <?supplied-pmid 31501550?>
        <pub-id pub-id-type="pmid">31501550</pub-id>
      </element-citation>
    </ref>
    <ref id="CR16">
      <label>16.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zhang</surname>
            <given-names>Z</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Scina: A semi-supervised subtyping algorithm of single cells and bulk samples</article-title>
        <source>Genes</source>
        <year>2019</year>
        <volume>10</volume>
        <fpage>531</fpage>
      </element-citation>
    </ref>
    <ref id="CR17">
      <label>17.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Pliner</surname>
            <given-names>HA</given-names>
          </name>
          <name>
            <surname>Shendure</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Trapnell</surname>
            <given-names>C</given-names>
          </name>
        </person-group>
        <article-title>Supervised classification enables rapid annotation of cell atlases</article-title>
        <source>Nat. Methods</source>
        <year>2019</year>
        <volume>16</volume>
        <fpage>983</fpage>
        <lpage>986</lpage>
        <?supplied-pmid 31501545?>
        <pub-id pub-id-type="pmid">31501545</pub-id>
      </element-citation>
    </ref>
    <ref id="CR18">
      <label>18.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Guo</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>scsorter: Assigning cells to known cell types according to marker genes</article-title>
        <source>Genome Biol.</source>
        <year>2021</year>
        <volume>22</volume>
        <fpage>1</fpage>
        <lpage>18</lpage>
        <pub-id pub-id-type="pmid">33397451</pub-id>
      </element-citation>
    </ref>
    <ref id="CR19">
      <label>19.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hu</surname>
            <given-names>J</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Iterative transfer learning with neural network for clustering and cell type classification in single-cell RNA-seq analysis</article-title>
        <source>Nat. Mach. Intell.</source>
        <year>2020</year>
        <volume>2</volume>
        <fpage>607</fpage>
        <lpage>618</lpage>
        <?supplied-pmid 33817554?>
        <pub-id pub-id-type="pmid">33817554</pub-id>
      </element-citation>
    </ref>
    <ref id="CR20">
      <label>20.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Brbić</surname>
            <given-names>M</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Mars: Discovering novel cell types across heterogeneous single-cell experiments</article-title>
        <source>Nat. Methods</source>
        <year>2020</year>
        <volume>17</volume>
        <fpage>1200</fpage>
        <lpage>1206</lpage>
        <?supplied-pmid 33077966?>
        <pub-id pub-id-type="pmid">33077966</pub-id>
      </element-citation>
    </ref>
    <ref id="CR21">
      <label>21.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Domanskyi</surname>
            <given-names>S</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Polled digital cell sorter (p-DCS): Automatic identification of hematological cell types from single cell RNA-sequencing clusters</article-title>
        <source>BMC Bioinform.</source>
        <year>2019</year>
        <volume>20</volume>
        <fpage>1</fpage>
        <lpage>16</lpage>
      </element-citation>
    </ref>
    <ref id="CR22">
      <label>22.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Aran</surname>
            <given-names>D</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Reference-based analysis of lung single-cell sequencing reveals a transitional profibrotic macrophage</article-title>
        <source>Nat. Immunol.</source>
        <year>2019</year>
        <volume>20</volume>
        <fpage>163</fpage>
        <lpage>172</lpage>
        <?supplied-pmid 30643263?>
        <pub-id pub-id-type="pmid">30643263</pub-id>
      </element-citation>
    </ref>
    <ref id="CR23">
      <label>23.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Yotsukura</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Nomura</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Aburatani</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Tsuda</surname>
            <given-names>K</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Celltree: An R/bioconductor package to infer the hierarchical structure of cell populations from single-cell RNA-seq data</article-title>
        <source>BMC bioinformatics</source>
        <year>2016</year>
        <volume>17</volume>
        <fpage>1</fpage>
        <lpage>17</lpage>
        <pub-id pub-id-type="pmid">26817711</pub-id>
      </element-citation>
    </ref>
    <ref id="CR24">
      <label>24.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wu</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Wu</surname>
            <given-names>H</given-names>
          </name>
        </person-group>
        <article-title>Accounting for cell type hierarchy in evaluating single cell RNA-seq clustering</article-title>
        <source>Genome Biol.</source>
        <year>2020</year>
        <volume>21</volume>
        <fpage>1</fpage>
        <lpage>14</lpage>
      </element-citation>
    </ref>
    <ref id="CR25">
      <label>25.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Michielsen</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Reinders</surname>
            <given-names>MJ</given-names>
          </name>
          <name>
            <surname>Mahfouz</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>Hierarchical progressive learning of cell identities in single-cell data</article-title>
        <source>Nat. Commun.</source>
        <year>2021</year>
        <volume>12</volume>
        <fpage>1</fpage>
        <lpage>12</lpage>
        <pub-id pub-id-type="pmid">33397941</pub-id>
      </element-citation>
    </ref>
    <ref id="CR26">
      <label>26.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Baron</surname>
            <given-names>M</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>A single-cell transcriptomic map of the human and mouse pancreas reveals inter-and intra-cell population structure</article-title>
        <source>Cell Syst.</source>
        <year>2016</year>
        <volume>3</volume>
        <fpage>346</fpage>
        <lpage>360</lpage>
        <?supplied-pmid 27667365?>
        <pub-id pub-id-type="pmid">27667365</pub-id>
      </element-citation>
    </ref>
    <ref id="CR27">
      <label>27.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Campbell</surname>
            <given-names>JN</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>A molecular census of arcuate hypothalamus and median eminence cell types</article-title>
        <source>Nat. Neurosci.</source>
        <year>2017</year>
        <volume>20</volume>
        <fpage>484</fpage>
        <lpage>496</lpage>
        <?supplied-pmid 28166221?>
        <pub-id pub-id-type="pmid">28166221</pub-id>
      </element-citation>
    </ref>
    <ref id="CR28">
      <label>28.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Macosko</surname>
            <given-names>EZ</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Highly parallel genome-wide expression profiling of individual cells using nanoliter droplets</article-title>
        <source>Cell</source>
        <year>2015</year>
        <volume>161</volume>
        <fpage>1202</fpage>
        <lpage>1214</lpage>
        <?supplied-pmid 26000488?>
        <pub-id pub-id-type="pmid">26000488</pub-id>
      </element-citation>
    </ref>
    <ref id="CR29">
      <label>29.</label>
      <mixed-citation publication-type="other">Hemberg lab collection of single cell datasets. <ext-link ext-link-type="uri" xlink:href="https://hemberg-lab.github.io/scRNA.seq.datasets/">https://hemberg-lab.github.io/scRNA.seq.datasets/</ext-link>. Accessed 04 Feb 2021.</mixed-citation>
    </ref>
    <ref id="CR30">
      <label>30.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zheng</surname>
            <given-names>SC</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>A novel cell-type deconvolution algorithm reveals substantial contamination by immune cells in saliva, buccal and cervix</article-title>
        <source>Epigenomics</source>
        <year>2018</year>
        <volume>10</volume>
        <fpage>925</fpage>
        <lpage>940</lpage>
        <?supplied-pmid 29693419?>
        <pub-id pub-id-type="pmid">29693419</pub-id>
      </element-citation>
    </ref>
    <ref id="CR31">
      <label>31.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zheng</surname>
            <given-names>GX</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Massively parallel digital transcriptional profiling of single cells</article-title>
        <source>Nat. Commun.</source>
        <year>2017</year>
        <volume>8</volume>
        <fpage>1</fpage>
        <lpage>12</lpage>
        <pub-id pub-id-type="pmid">28232747</pub-id>
      </element-citation>
    </ref>
    <ref id="CR32">
      <label>32.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Shao</surname>
            <given-names>X</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>scDeepSort: A pre-trained cell-type annotation method for single-cell transcriptomics using deep learning with a weighted graph neural network</article-title>
        <source>Nucleic Acids Res.</source>
        <year>2021</year>
        <volume>49</volume>
        <issue>21</issue>
        <fpage>e122</fpage>
        <?supplied-pmid 34500471?>
        <pub-id pub-id-type="pmid">34500471</pub-id>
      </element-citation>
    </ref>
    <ref id="CR33">
      <label>33.</label>
      <mixed-citation publication-type="other">Duò, A., Robinson, M. D. &amp; Soneson, C. A systematic performance evaluation of clustering methods for single-cell RNA-seq data. <italic>F1000Research</italic><bold>7</bold>, 1141 10.12688/f1000research.15666.1 (2018).</mixed-citation>
    </ref>
    <ref id="CR34">
      <label>34.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Yang</surname>
            <given-names>C</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Heterogeneity of human bone marrow and blood natural killer cells defined by single-cell transcriptome</article-title>
        <source>Nat. Commun.</source>
        <year>2019</year>
        <volume>10</volume>
        <fpage>1</fpage>
        <lpage>16</lpage>
        <pub-id pub-id-type="pmid">30602773</pub-id>
      </element-citation>
    </ref>
    <ref id="CR35">
      <label>35.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Goudot</surname>
            <given-names>C</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Aryl hydrocarbon receptor controls monocyte differentiation into dendritic cells versus macrophages</article-title>
        <source>Immunity</source>
        <year>2017</year>
        <volume>47</volume>
        <fpage>582</fpage>
        <lpage>596</lpage>
        <?supplied-pmid 28930664?>
        <pub-id pub-id-type="pmid">28930664</pub-id>
      </element-citation>
    </ref>
    <ref id="CR36">
      <label>36.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Muraro</surname>
            <given-names>MJ</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>A single-cell transcriptome atlas of the human pancreas</article-title>
        <source>Cell Syst.</source>
        <year>2016</year>
        <volume>3</volume>
        <fpage>385</fpage>
        <lpage>394</lpage>
        <?supplied-pmid 27693023?>
        <pub-id pub-id-type="pmid">27693023</pub-id>
      </element-citation>
    </ref>
    <ref id="CR37">
      <label>37.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Segerstolpe</surname>
            <given-names>Å</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Single-cell transcriptome profiling of human pancreatic islets in health and type 2 diabetes</article-title>
        <source>Cell Metab.</source>
        <year>2016</year>
        <volume>24</volume>
        <fpage>593</fpage>
        <lpage>607</lpage>
        <?supplied-pmid 27667667?>
        <pub-id pub-id-type="pmid">27667667</pub-id>
      </element-citation>
    </ref>
    <ref id="CR38">
      <label>38.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Xin</surname>
            <given-names>Y</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>RNA sequencing of single human islet cells reveals type 2 diabetes genes</article-title>
        <source>Cell Metab.</source>
        <year>2016</year>
        <volume>24</volume>
        <fpage>608</fpage>
        <lpage>615</lpage>
        <?supplied-pmid 27667665?>
        <pub-id pub-id-type="pmid">27667665</pub-id>
      </element-citation>
    </ref>
    <ref id="CR39">
      <label>39.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Velmeshev</surname>
            <given-names>D</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Single-cell genomics identifies cell type-specific molecular changes in autism</article-title>
        <source>Science</source>
        <year>2019</year>
        <volume>364</volume>
        <fpage>685</fpage>
        <lpage>689</lpage>
        <?supplied-pmid 31097668?>
        <pub-id pub-id-type="pmid">31097668</pub-id>
      </element-citation>
    </ref>
    <ref id="CR40">
      <label>40.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lord</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Elsabbagh</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Baird</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Veenstra-Vanderweele</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>Autism spectrum disorder</article-title>
        <source>Lancet</source>
        <year>2018</year>
        <volume>392</volume>
        <fpage>508</fpage>
        <lpage>520</lpage>
        <?supplied-pmid 7398158?>
        <pub-id pub-id-type="pmid">30078460</pub-id>
      </element-citation>
    </ref>
    <ref id="CR41">
      <label>41.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Grün</surname>
            <given-names>D</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Single-cell messenger RNA sequencing reveals rare intestinal cell types</article-title>
        <source>Nature</source>
        <year>2015</year>
        <volume>525</volume>
        <fpage>251</fpage>
        <lpage>255</lpage>
        <?supplied-pmid 26287467?>
        <pub-id pub-id-type="pmid">26287467</pub-id>
      </element-citation>
    </ref>
    <ref id="CR42">
      <label>42.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Jindal</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Gupta</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Sengupta</surname>
            <given-names>D</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Discovery of rare cells from voluminous single cell expression data</article-title>
        <source>Nat. Commun.</source>
        <year>2018</year>
        <volume>9</volume>
        <fpage>1</fpage>
        <lpage>9</lpage>
        <pub-id pub-id-type="pmid">29317637</pub-id>
      </element-citation>
    </ref>
    <ref id="CR43">
      <label>43.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Gao</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Bai</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Henderson</surname>
            <given-names>YC</given-names>
          </name>
          <name>
            <surname>Lin</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Schalck</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Yan</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Kumar</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Hu</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Sei</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Davis</surname>
            <given-names>A</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Delineating copy number and clonal substructure in human tumors from single-cell transcriptomes</article-title>
        <source>Nat. Biotechnol.</source>
        <year>2021</year>
        <volume>39</volume>
        <issue>5</issue>
        <fpage>599</fpage>
        <lpage>608</lpage>
        <?supplied-pmid 33462507?>
        <pub-id pub-id-type="pmid">33462507</pub-id>
      </element-citation>
    </ref>
    <ref id="CR44">
      <label>44.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Barreyro</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Chlon</surname>
            <given-names>TM</given-names>
          </name>
          <name>
            <surname>Starczynowski</surname>
            <given-names>DT</given-names>
          </name>
        </person-group>
        <article-title>Chronic immune response dysregulation in MDS pathogenesis</article-title>
        <source>Blood</source>
        <year>2018</year>
        <volume>132</volume>
        <fpage>1553</fpage>
        <lpage>1560</lpage>
        <?supplied-pmid 30104218?>
        <pub-id pub-id-type="pmid">30104218</pub-id>
      </element-citation>
    </ref>
    <ref id="CR45">
      <label>45.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Behbehani</surname>
            <given-names>GK</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Profiling myelodysplastic syndromes by mass cytometry demonstrates abnormal progenitor cell phenotype and differentiation</article-title>
        <source>Cytom. Part B Clin. Cytom.</source>
        <year>2020</year>
        <volume>98</volume>
        <fpage>131</fpage>
        <lpage>145</lpage>
      </element-citation>
    </ref>
    <ref id="CR46">
      <label>46.</label>
      <mixed-citation publication-type="other">Agarap, A. F. Deep learning using rectified linear units (relu). arXiv preprint <ext-link ext-link-type="uri" xlink:href="http://arxiv.org/abs/1803.08375">arXiv:1803.08375</ext-link> (2018).</mixed-citation>
    </ref>
    <ref id="CR47">
      <label>47.</label>
      <mixed-citation publication-type="other">Talathi, S. S. &amp; Vartak, A. Improving performance of recurrent neural network with relu nonlinearity. arXiv preprint <ext-link ext-link-type="uri" xlink:href="http://arxiv.org/abs/1511.03771">arXiv:1511.03771</ext-link> (2015).</mixed-citation>
    </ref>
    <ref id="CR48">
      <label>48.</label>
      <mixed-citation publication-type="other">Wibowo, A., Wiryawan, P. &amp; Nuqoyati, N. Optimization of neural network for cancer microrna biomarkers classification. In <italic>Journal of Physics: Conference Series</italic>, vol. 1217, 012124 (IOP Publishing, 2019).</mixed-citation>
    </ref>
    <ref id="CR49">
      <label>49.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ritchie</surname>
            <given-names>ME</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>limma powers differential expression analyses for RNA-sequencing and microarray studies</article-title>
        <source>Nucleic Acids Res.</source>
        <year>2015</year>
        <volume>43</volume>
        <fpage>e47</fpage>
        <?supplied-pmid 25605792?>
        <pub-id pub-id-type="pmid">25605792</pub-id>
      </element-citation>
    </ref>
  </ref-list>
</back>
