<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName A++V2.4.dtd?>
<?SourceDTD.Version 2.4?>
<?ConverterInfo.XSLTName springer2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">BMC Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">BMC Bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>BMC Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="epub">1471-2105</issn>
    <publisher>
      <publisher-name>BioMed Central</publisher-name>
      <publisher-loc>London</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">7379353</article-id>
    <article-id pub-id-type="publisher-id">3589</article-id>
    <article-id pub-id-type="doi">10.1186/s12859-020-03589-0</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Software</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>imputeqc: an R package for assessing imputation quality of genotypes and optimizing imputation parameters</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author" corresp="yes">
        <name>
          <surname>Khvorykh</surname>
          <given-names>Gennady V.</given-names>
        </name>
        <address>
          <email>khvorykh@img.ras.ru</email>
        </address>
        <xref ref-type="aff" rid="Aff1"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Khrunin</surname>
          <given-names>Andrey V.</given-names>
        </name>
        <address>
          <email>khrunin@img.ras.ru</email>
        </address>
        <xref ref-type="aff" rid="Aff1"/>
      </contrib>
      <aff id="Aff1"><institution-wrap><institution-id institution-id-type="GRID">grid.418826.1</institution-id><institution-id institution-id-type="ISNI">0000 0004 0619 6278</institution-id><institution>Department of Molecular Bases of Human Genetics, Institute of Molecular Genetics of Russian Academy of Sciences, </institution></institution-wrap>2 Kurchatov sq., Moscow, 123182 Russia </aff>
    </contrib-group>
    <pub-date pub-type="epub">
      <day>24</day>
      <month>7</month>
      <year>2020</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>24</day>
      <month>7</month>
      <year>2020</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2020</year>
    </pub-date>
    <volume>21</volume>
    <issue>Suppl 12</issue>
    <issue-sponsor>Publication charges for this supplement were funded by the Bioinformatics: from Algorithms to Applications 2019 (BiATA 2019) conference. The articles have undergone the journal's standard peer review process for supplements. Supplement Editors were not responsible for the review of papers they had authored. No other competing interests were declared.</issue-sponsor>
    <elocation-id>304</elocation-id>
    <history>
      <date date-type="received">
        <day>2</day>
        <month>6</month>
        <year>2020</year>
      </date>
      <date date-type="accepted">
        <day>8</day>
        <month>6</month>
        <year>2020</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2020</copyright-statement>
      <license license-type="OpenAccess">
        <license-p><bold>Open Access</bold> This article is licensed under a Creative Commons Attribution 4.0 International License, which permits use, sharing, adaptation, distribution and reproduction in any medium or format, as long as you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons licence, and indicate if changes were made. The images or other third party material in this article are included in the article’s Creative Commons licence, unless indicated otherwise in a credit line to the material. If material is not included in the article’s Creative Commons licence and your intended use is not permitted by statutory regulation or exceeds the permitted use, you will need to obtain permission directly from the copyright holder. To view a copy of this licence, visit <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>. The Creative Commons Public Domain Dedication waiver (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/publicdomain/zero/1.0/">http://creativecommons.org/publicdomain/zero/1.0/</ext-link>) applies to the data made available in this article, unless otherwise stated in a credit line to the data.</license-p>
      </license>
    </permissions>
    <abstract id="Abs1">
      <sec>
        <title>Background</title>
        <p id="Par1">The imputation of genotypes increases the power of genome-wide association studies. However, the imputation quality should be assessed in each particular case. Nevertheless, not all imputation softwares control the error of output, e.g., the last release of fastPHASE program (1.4.8) lacks such an option. In this particular software there is also an uncertainty in choosing the model parameters. fastPHASE is based on haplotype clusters, which size should be set a priori. The parameter influences the results of imputation and downstream analysis.</p>
      </sec>
      <sec>
        <title>Results</title>
        <p id="Par2">We present a software toolkit <italic>imputeqc</italic> to assess the imputation quality and/or to choose the model parameters for imputation. We demonstrate the efficacy of toolkit for evaluation of imputations made with both fastPHASE and BEAGLE software for HapMap and 1000 Genomes data. The discordance of genotypes received correlated well in both methods. Using <italic>imputeqc</italic>, we also shown how to choose the optimal number of haplotype clusters and expectation-maximization cycles for fastPHASE program. The found number of haplotype clusters of 25 was further applied for hapFLK testing that revealed signatures of selection at LCT region on chromosome 2. We also demonstrated how to decrease the computational time in the case of hapFLK testing from 3 days to 20 h.</p>
      </sec>
      <sec>
        <title>Conclusions</title>
        <p id="Par3">The toolkit is implemented as an R package <italic>imputeqc</italic> and command line scripts. The code is freely available at <ext-link ext-link-type="uri" xlink:href="https://github.com/inzilico/imputeqc">https://github.com/inzilico/imputeqc</ext-link>under the MIT license.</p>
      </sec>
    </abstract>
    <kwd-group xml:lang="en">
      <title>Keywords</title>
      <kwd>Imputation quality</kwd>
      <kwd>Genotype</kwd>
      <kwd>Haplotype</kwd>
      <kwd>Cluster</kwd>
    </kwd-group>
    <conference xlink:href="http://biata2019.spbu.ru/">
      <conf-name>Bioinformatics: from Algorithms to Applications 2019 (BiATA 2019) conference</conf-name>
      <conf-acronym>BiATA 2019</conf-acronym>
      <conf-loc>Saint Petersburg, Russia</conf-loc>
      <conf-date>20-22 June 2019</conf-date>
    </conference>
    <custom-meta-group>
      <custom-meta>
        <meta-name>issue-copyright-statement</meta-name>
        <meta-value>© The Author(s) 2020</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec id="Sec1">
    <title>Background</title>
    <p>Imputation is an in silico method that infers genotypes for undetermined or missed markers in study samples. It results both in harmonizing data sets and increasing the overall number of markers available for testing. The situation is common for genome wide association studies based on microarrays for genotyping portions of the genome variation. To increase the sample number and the power of the study, the datasets from different arrays are combined. Since they have different number of single-nucleotide polymorphism (SNPs), the joined dataset misses a lot of them. However, the missing genotypes can be replaced for their estimates provided with imputation.</p>
    <p>The strategies of imputation are based on a heuristic, expectation-maximization (EM) algorithm or coalescent models [<xref ref-type="bibr" rid="CR1">1</xref>]. They are implemented in the following softwares: fastPHASE [<xref ref-type="bibr" rid="CR2">2</xref>], MaCH [<xref ref-type="bibr" rid="CR3">3</xref>], IMPUTE2 [<xref ref-type="bibr" rid="CR4">4</xref>], BEAGLE [<xref ref-type="bibr" rid="CR5">5</xref>], and others. Imputation tackles two obstacles: time and accuracy. To balance the increase in computational burden necessary for large reference panels, two-step imputation procedure has been proposed. It includes an initial pre-phasing (i.e., haplotype estimation) of the studied genotypes with a subsequent imputation of reference panel markers into the estimated haplotypes.</p>
    <p>The effect of imputation depends heavily on what is missing [<xref ref-type="bibr" rid="CR6">6</xref>]. In each particular case one needs to control the quality of genotype reconstruction. A standard approach here is to apply masked data analysis, which involves three steps: genotype masking (making some known genotypes to be unknown), imputation, and comparison of the results obtained with the original ones. In general imputation touches either “hole filling” or reconstruction of entire SNP. Therefore two ways of masking is possible. We can either hide a proportion of genotypes or remove the whole SNP. Besides, the genetic markers can be masked randomly or intentionally.</p>
    <p>Some softwares estimate the quality of replacement of missing genotypes. They have built-in options. However, the methods of assessing the quality are different. Thus, MaCH allows masking a certain portion of genotypes at random. Users apply the –mask option. The program estimates the allelic and genotypic error rates. The allelic rate is expected to be less than 5%. Authors of the program also advice to check the ratio of allelic to genotypic errors. It should be 2:1 since a small proportion of errors seems to be caused by imputation of one homozygote as the other one. It is also possible to estimate the imputation errors of MaCH by masking the whole SNPs, but extra scripts to generate the masked input files and count the errors after imputation will be required in this case. BEAGLE software provides <italic>r</italic><sup>2</sup> metric for each SNP and IMPUTE2 has INFO score, a metric for imputation quality for each SNP scaled from 0 to 1. Both reflects the correlation between imputed and true genotypes.</p>
    <p>Other softwares, for example, last release of fastPHASE program (1.4.8), do not provide the users with built-in option to evaluate the quality of imputation. Additionally the users of this program meet a problem of choosing the optimal number of haplotype clusters (K). Scheet and Stephens called it a tricky statistical problem because Akaike and Bayesian information criteria did not work well [<xref ref-type="bibr" rid="CR2">2</xref>]. They proposed to apply a masked data analysis to select K.</p>
    <p>The number of haplotype clusters is also required for recently introduced hapFLK software [<xref ref-type="bibr" rid="CR7">7</xref>]. It exploits haplotype cluster model for detection of signals of natural selection in genomes. The authors of hapFLK statistic emphasized that the distribution of hapFLK values can depend on the number of clusters thus pointing out the importance of choosing this parameter. At the same time, users of hapFLK cannot utilize information about the number of haplotype clusters from other software, for example, from BEAGLE, because the numbers identified varies along the genome [<xref ref-type="bibr" rid="CR8">8</xref>]. Since such variation itself may be due to natural selection, hapFLK requires a fixed number of clusters for calculations.</p>
    <p>The absence of ready-to-use solution for assessing the quality of genotype imputation in the case of fastPHASE pushed us to create a toolkit that would allow to estimate the error of imputation and select the optimal model parameters. Our research resulted in R package <italic>imputeqc</italic>. It utilizes the masked data analysis. The results of <italic>imputeqc</italic> testing demonstrated that it can be applied not only with fastPHASE but also with BEAGLE and other imputation softwares.</p>
    <p>Below is the description of the package as well as its demonstration for datasets from HapMap [<xref ref-type="bibr" rid="CR9">9</xref>] and 1000 Genomes Projects [<xref ref-type="bibr" rid="CR10">10</xref>]. The quality of imputation made with fastPHASE was estimated and compared to that of performed with the most versatile tool BEAGLE. Both fastPHASE and BEAGLE are based on cluster models but of different implementation. The optimal numbers of haplotype clusters (K) and EM cycles were determined for fastPHASE. The K value was further applied for hapFLK test.</p>
  </sec>
  <sec id="Sec2">
    <title>Implementation</title>
    <sec id="Sec3">
      <title>The <italic>imputeqc</italic> project</title>
      <p><italic>imputeqc</italic> is an R package and accompanied scripts to estimate the quality of imputation of genotypes of diploid organisms. We approach the imputation quality as discordance between the imputed and true genotypes. The package supports two formats of input files: *.inp and Variant Call Format (VCF). The first one is applied in fastPHASE tool, while the second one is widely used for storing the DNA sequence variations.</p>
      <p><italic>imputeqc</italic> is based on masked data analysis that allows to estimate the imputation error. Comparing the errors over several calculations made with different inputs, the user can identify the imputation parameters statistically rather than heuristically. The examples of such parameters are the numbers of haplotype clusters and EM cycles.</p>
      <p>The key functions of <italic>imputeqc</italic> are as follow:
<list list-type="order"><list-item><p><bold>ReadfastPHASE()</bold> parses fastPHASE *.inp files. There are two types of them: with ids of samples provided or not. The function loads both types. The alleles can be coded as letters or numbers, but the missing ones should be “?”. The function returns a character vector with strings representing the haplotypes. Two strings per individual.</p></list-item><list-item><p><bold>ReadVCF()</bold> loads data from VCF files and returns a character vector with haplotypes. The function is built on top of <italic>readVcf()</italic> function from <italic>VariantAnnotation</italic> R package [<xref ref-type="bibr" rid="CR11">11</xref>].</p></list-item><list-item><p><bold>GenerateMaskSet()</bold> samples a set of masks, given a proportion of genotypes to be masked at each loci or the proportion of markers to be masked completely (<italic>p</italic>) and the number of masks (<italic>n</italic>). The masks are generated without replacement. This allows studying the space of possible variants of missing genotypes. Such an approach can be regarded as a general case of cross-validation method. The difference is in that <italic>GenerateMaskSet()</italic> allows to chose the number of data partitions (<italic>n</italic>), while the traditional cross-validation fixes this number. Before masking the function determines already existing missing genotypes. Thus, in the case of masking the genotypes, the overall missingness will be higher than <italic>p</italic>. The return value is a list of matrices with binary masks. The length of the list equals to <italic>n</italic>.</p></list-item><list-item><p><bold>ApplyMasks()</bold> applies a set of masks to vector of haplotypes obtained with <italic>ReadfastPHASE()</italic> or <italic>ReadVCF()</italic> functions. The output is saved as *.inp or VCF files, correspondingly. The number of files created equals to the number of masks generated. The output files are ready for imputation with fastPHASE, BEAGLE or other appropriate tools.</p></list-item><list-item><p><bold>EstimateQuality()</bold> counts the discordance between imputed and true genotypes as a proportion of genotypes imputed wrongly. By wrongly imputed genotypes we mean that either one or both alleles did not coincide with the original ones. Function returns a data frame for one set of test files with two columns: “discordance” and “id”. The first column contains the value of discordance. The second one has a user defined id. It is useful for a subsequent visualization. For example, there are several computations distinguishing by a model parameter. In this case, one can assign a value of model parameter to id argument of the function and build a graphic showing the descordance vs. model parameter. The second column is optional.</p></list-item></list></p>
      <p>Besides R functions <italic>imputeqc</italic> project includes also some useful scripts:
<list list-type="bullet"><list-item><p><italic>make_test_files.R</italic> automates creation of files with hidden genotypes or whole SNPs. It takes fastPHASE or VCF files, the desired number of different masks (<italic>n</italic>), the proportion of genotypes or SNPs to be hidden (<italic>p</italic>). The script outputs <italic>n</italic> files with artificially missed data.</p></list-item><list-item><p><italic>hapmap2fastphase.R</italic> converts HapMap data into fastPHASE format.</p></list-item><list-item><p><italic>hapmap2plink.R</italic> converts HapMap data into Plink format.</p></list-item></list></p>
      <p>To access the scripts, install the <italic>imputeqc</italic> package. Then retrieve the path to the scripts by the command from R: system.file(“extdata”, package=“imputeqc”).</p>
    </sec>
    <sec id="Sec4">
      <title>Masked data analysis</title>
      <p>Assume you have Plink files with genotypes and want to estimate the imputation quality as well as the optimal model parameters for fastPHASE program. The workflow proposed is as follow.
<list list-type="order"><list-item><p>Convert Plink files to fastPHASE *.inp files, using Plink tool.</p></list-item><list-item><p>Generate a set of test files with <italic>make_test_files.R</italic> script which is enclosed to the package.</p></list-item><list-item><p>Impute the missing genotypes in each test file with fastPHASE.</p></list-item><list-item><p>Estimate the imputation quality with <italic>EstimateQuality()</italic> function in R.</p></list-item><list-item><p>Repeat steps 3 and 4 by varying one model parameter to be optimized.</p></list-item><list-item><p>Chose the parameter that minimizes the imputation error.</p></list-item></list></p>
    </sec>
  </sec>
  <sec id="Sec5" sec-type="results">
    <title>Results</title>
    <sec id="Sec6">
      <title>Data preprocess</title>
      <p>We used the same release of HapMap Project (Phase I, March 2005) as the authors of fastPHASE tool. Non-redundant genotypes were downloaded from ftp://ftp.ncbi.nlm.nih.gov/hapmap/genotypes/2005-03_16a_phaseI/full/non-redundant/. The data were converted into Plink format with a custom script <italic>hapmap2plink.R</italic>, which is also available within <italic>imputeqc</italic> toolkit. Having the file with pedigree information, we left 60 unrelated individuals from CEPH population. To be processed the genotype datasets should meet some thresholds (call rate, minor allele frequency, Hardy-Weinberg equilibrium). Using Plink v1.90b5.2 [<xref ref-type="bibr" rid="CR12">12</xref>], we removed markers with MAF less than 0.01, not fitting Hardy-Weinberg equilibrium (<italic>p</italic>-value &lt;10<sup>−5</sup>), and having genotype call rate less than 0.95. The duplicated by position markers were also removed. The number of SNPs thus left are given in Table <xref rid="Tab1" ref-type="table">1</xref>.
<table-wrap id="Tab1"><label>Table 1</label><caption><p>Dataset attributes and the discordances of genotypes imputated by fastPHASE and BEAGLE softwares</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left">Population</th><th align="left">Size</th><th align="left">Chrom</th><th align="left">SNPs</th><th align="left">fastPHASE</th><th align="left">BEAGLE</th></tr></thead><tbody><tr><td align="left">CEPH</td><td align="left">60</td><td align="left">7</td><td align="left">28900</td><td align="left">0.031 (0.004)</td><td align="left">0.033 (0.003)</td></tr><tr><td align="left">CEPH</td><td align="left">60</td><td align="left">22</td><td align="left">13653</td><td align="left">0.020 (0.001)</td><td align="left">0.023 (0.001)</td></tr><tr><td align="left">CEU, TSI, CHB, JPT</td><td align="left">401</td><td align="left">1</td><td align="left">41524</td><td align="left">0.0188 (0.0001)</td><td align="left">0.020 (0.001)</td></tr><tr><td align="left">CEU, TSI, CHB, JPT</td><td align="left">401</td><td align="left">22</td><td align="left">7441</td><td align="left">0.029 (0.001)</td><td align="left">0.030 (0.001)</td></tr></tbody></table></table-wrap></p>
      <p>Genotypes of CEU, TSI, CHB, JPT and YRI populations were extracted with VCFtools 0.1.15 [<xref ref-type="bibr" rid="CR13">13</xref>] from the archive Omni25_genotypes_2141_samples.b36.v2.vcf.gz downloaded from ftp://ftp.1000genomes.ebi.ac.uk/vol1/ftp/technical/working/. The list of SNPs containing 2384646 observations was filtered similar to HapMap data. Sex and mitochondrial chromosomes were removed. Only markers having “rs” in their id had been saved as Plink files. The number of SNPs and individuals filtered are given in Table <xref rid="Tab2" ref-type="table">2</xref>.
<table-wrap id="Tab2"><label>Table 2</label><caption><p>The number of SNPs and sample size for populations from 1000 Genomes Project after filtration</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left">Population</th><th align="left">Individuals</th><th align="left">SNPs</th></tr></thead><tbody><tr><td align="left">CEU</td><td align="left">102</td><td align="left">613498</td></tr><tr><td align="left">TSI</td><td align="left">99</td><td align="left">622338</td></tr><tr><td align="left">CHB</td><td align="left">100</td><td align="left">581985</td></tr><tr><td align="left">JPT</td><td align="left">100</td><td align="left">575606</td></tr><tr><td align="left">YRI</td><td align="left">101</td><td align="left">632448</td></tr></tbody></table></table-wrap></p>
      <p>Five datasets were then merged by applying custom R scripts and Plink. The resulted file contained 512476 SNPs and 502 individuals. The Reynolds distances required for hapFLK calculations were further computed in R as follow:
<disp-formula id="Equa"><alternatives><tex-math id="M1">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$\begin{array}{*{20}l} \Theta = \frac{\sum_{j=1}^{m}\sum_{i=1}^{a_{i}}\left(p_{ij} - q_{ij}\right)^{2}}{2 \sum_{j=1}^{m}\left(1 - \sum_{i=1}^{a_{i}}p_{ij}q_{ij}\right)} \end{array} $$ \end{document}</tex-math><mml:math id="M2"><mml:mtable class="align" columnalign="left"><mml:mtr><mml:mtd class="align-1"><mml:mi>Θ</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:munderover accent="false" accentunder="false"><mml:mrow><mml:mo mathsize="big">∑</mml:mo></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:munderover><mml:munderover accent="false" accentunder="false"><mml:mrow><mml:mo mathsize="big">∑</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>a</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:munderover><mml:msup><mml:mrow><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ij</mml:mtext></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi>q</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ij</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:munderover accent="false" accentunder="false"><mml:mrow><mml:mo mathsize="big">∑</mml:mo></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:munderover><mml:mfenced close=")" open="("><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:munderover accent="false" accentunder="false"><mml:mrow><mml:mo mathsize="big">∑</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>a</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:munderover><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ij</mml:mtext></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>q</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ij</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:mrow></mml:mfrac></mml:mtd></mml:mtr></mml:mtable></mml:math><graphic xlink:href="12859_2020_3589_Article_Equa.gif" position="anchor"/></alternatives></disp-formula></p>
      <p>where <italic>p</italic><sub><italic>ij</italic></sub> and <italic>q</italic><sub><italic>ij</italic></sub> are the frequencies of <italic>i-th</italic> allele at <italic>j-th</italic> loci of two populations considered. They were estimated with Plink. For biallelic model <italic>a</italic><sub><italic>i</italic></sub>=2. The obtained Reynolds distances are presented in Table <xref rid="Tab3" ref-type="table">3</xref>. As it is seen from the table, the YRI population has the largest values of about 0.15 with CEU, TSI, CHB, JPT whereas these four populations are closer to each other as compared to YRI. Therefore, the YRI was chosen as outgroup for hapFLK testing. It was removed from the dataset, thus leaving 401 individuals for subsequent computations.
<table-wrap id="Tab3"><label>Table 3</label><caption><p>The Reynolds distances for the populations from 1000 Genomes Project</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left"/><th align="left">YRI</th><th align="left">CEU</th><th align="left">TSI</th><th align="left">CHB</th><th align="left">JPT</th></tr></thead><tbody><tr><td align="left">YRI</td><td align="left">0.0</td><td align="left">0.1515256</td><td align="left">0.1473879</td><td align="left">0.1745052</td><td align="left">0.1758466</td></tr><tr><td align="left">CEU</td><td align="left">0.1515256</td><td align="left">0.0</td><td align="left">0.008708298</td><td align="left">0.1095429</td><td align="left">0.111366</td></tr><tr><td align="left">TSI</td><td align="left">0.1473879</td><td align="left">0.008708298</td><td align="left">0.0</td><td align="left">0.1094925</td><td align="left">0.1113009</td></tr><tr><td align="left">CHB</td><td align="left">0.1745052</td><td align="left">0.1095429</td><td align="left">0.1094925</td><td align="left">0.0</td><td align="left">0.01185164</td></tr><tr><td align="left">JPT</td><td align="left">0.1758466</td><td align="left">0.111366</td><td align="left">0.1113009</td><td align="left">0.01185164</td><td align="left">0.0</td></tr></tbody></table></table-wrap></p>
      <p>The kinship matrix was generated with <italic>reynolds2kinship.R</italic> script provided by hapFLK toolkit. The dataset was split into 22 files according to the number of autosomes. The chromosomes 1 and 22 were chosen for masked data analysis. The number of markers in the chromosomes are given in Table <xref rid="Tab1" ref-type="table">1</xref>. To estimate the quality of imputation made with BEAGLE, we used the same files as for fastPHASE, while converting them into VCF format with Plink.</p>
      <p>For each chromosome under consideration a set of 5 different test files containing artificially missing genotypes was generated with <italic>make_test_files.R</italic> script. It is a command line script built on <italic>imputeqc</italic> functions to automate the creation of files with missing genotypes. Ten percent of genotypes at each loci was randomly marked to be missing. The masks in a set do not repeat themselves, the script keeps a track of positions masked.</p>
      <p>The VCF files containing 10% of missing genotypes were also generated with <italic>make_test_files.R</italic>, which recognizes automatically *.inp (fastPHASE format), *.vcf, and *.vcf.gz files.</p>
    </sec>
    <sec id="Sec7">
      <title>Demonstration</title>
      <p>To test <italic>imputeqc</italic> efficacy we compared the results obtained by this tool with those published by the authors of fastPHASE. We ran the toolkit with fastPHASE (1.4.8) software on genotypes of 60 unrelated individuals from CEPH population of HapMap project by masking 10 and 25% of genotypes. In the case of 10% masked genotypes Paul Scheet and Matthew Stephens found the imputation errors to be 0.034 and 0.033 for chromosome 7 and 22, respectively. Using <italic>imputeqc</italic>, we obtained similar imputation error for chromosome 7 (0.031, SD 0.004) and lower value for chromosome 22 (0.020, SD 0.001) (Fig. <xref rid="Fig1" ref-type="fig">1</xref>). In the case of 25% masked data we also received discordances close to those of published by the authors of fastPHASE who reported 0.041 for chromosome 7 and 0.039 for chromosome 22 (Fig. <xref rid="Fig2" ref-type="fig">2</xref>).
<fig id="Fig1"><label>Fig. 1</label><caption><p>Discordance of CEPH genotypes from HapMap imputed with fastPHASE applying different number of haplotype clusters under 10% of missing genotypes</p></caption><graphic xlink:href="12859_2020_3589_Fig1_HTML" id="MO1"/></fig><fig id="Fig2"><label>Fig. 2</label><caption><p>Discordance of CEPH genotypes from HapMap imputed with fastPHASE applying different number of haplotype clusters under 25% of missing genotypes</p></caption><graphic xlink:href="12859_2020_3589_Fig2_HTML" id="MO2"/></fig></p>
      <p>Both chromosome 7 and 22 showed similar values of optimal K. But they differ depending on the missigness of genotypes. The discordance was minimal at K = 15 for 10% of masked data (Fig. <xref rid="Fig1" ref-type="fig">1</xref>) and at K = 10 for 25% of masked data (Fig. <xref rid="Fig2" ref-type="fig">2</xref>).</p>
      <p>Since the haplotype cluster model is often applied to the pool of populations, we also demonstrated <italic>imputeqc</italic> for a dataset composed of genotypes from CEU, TSI, CHB and JPT populations of 1000 Genomes Project.</p>
      <p>Firstly, we estimated the optimal numbers of haplotype clusters and EM cycles. Following the approach related to the “elbow” method (see Discussion), we found K to be 25 (Fig. <xref rid="Fig3" ref-type="fig">3</xref>), while the number of EM cycles to be 20 (Fig. <xref rid="Fig6" ref-type="fig">6</xref>). Then, applying these model parameters, we found the genotype discordance to be 0.0188 (SD 0.0001) and 0.029 (SD 0.001) for chromosome 1 and 22, respectively. Testing four other chromosomes (3, 8, 13 and 18) resulted in similar optimal K values. The discordances of genotypes were between those estimated for chromosome 1 and 22 (Figs. <xref rid="Fig4" ref-type="fig">4</xref> and <xref rid="Fig5" ref-type="fig">5</xref>)
<fig id="Fig3"><label>Fig. 3</label><caption><p>Discordance of pooled CEU, TSI, JPT, and CHB genotypes of chromosomes 1 and 22 imputed with fastPHASE applying different number of haplotype clusters</p></caption><graphic xlink:href="12859_2020_3589_Fig3_HTML" id="MO3"/></fig><fig id="Fig4"><label>Fig. 4</label><caption><p>Discordance of pooled CEU, TSI, JPT, and CHB genotypes of chromosomes 3, 8, 13, and 18 imputed with fastPHASE applying different number of haplotype clusters</p></caption><graphic xlink:href="12859_2020_3589_Fig4_HTML" id="MO4"/></fig><fig id="Fig5"><label>Fig. 5</label><caption><p>Medians of discordances of pooled CEU, TSI, JPT, and CHB genotypes of chromosomes 1, 3, 8, 13, 18, and 22 imputed with fastPHASE applying different number of haplotype clusters</p></caption><graphic xlink:href="12859_2020_3589_Fig5_HTML" id="MO5"/></fig><fig id="Fig6"><label>Fig. 6</label><caption><p>Discordance of pooled CEU, TSI, JPT, and CHB genotypes of chromosome 22 imputed with fastPHASE with different number of EM cycles</p></caption><graphic xlink:href="12859_2020_3589_Fig6_HTML" id="MO6"/></fig></p>
      <p>We also demonstrated the usage of <italic>imputeqc</italic> toolkit with BEAGLE (4.1) software. As fastPHASE it is based on cluster model, but the number of haplotypes clusters is adjusted dynamically. There is no need to optimize this parameter with extra calculations. BEAGLE showed similar to fastPHASE genotype discordance estimated with <italic>imputeqc</italic> for all datasets tested. The discordance is given as median followed by standard deviation in parentheses. Each value is calculated from five imputations of genotypes masked uniquely (Table <xref rid="Tab1" ref-type="table">1</xref>).</p>
      <p>The optimal number of haplotype cluster being known, hapFLK test for the search of footprints of selection can be performed. We ran it for a pool of CEU, TSI, CHB and JPT populations. YRI was chosen as outgroup. The <italic>p</italic>-values of hapFLK metric thus obtained are given in Fig. <xref rid="Fig7" ref-type="fig">7</xref>. They showed a strong signal at chromosome 2, position 137 Mb, which is known to be associated with a regulation of <italic>LCT</italic> gene. The analysis of haplotype cluster frequencies of 4Mb region around this signal indicated CEU population contributing essentially to the signal (Fig. <xref rid="Fig8" ref-type="fig">8</xref>).
<fig id="Fig7"><label>Fig. 7</label><caption><p>Manhattan plot of hapFLK <italic>p</italic>-values for the pool of CEU, TSI, CHB and JPT populations. Red horizontal line corresponds to 0.999-th percentile of <italic>p</italic>-values</p></caption><graphic xlink:href="12859_2020_3589_Fig7_HTML" id="MO7"/></fig><fig id="Fig8"><label>Fig. 8</label><caption><p>Haplotype cluster frequencies in 4 Mb region at chromosome 2 (LCT region)</p></caption><graphic xlink:href="12859_2020_3589_Fig8_HTML" id="MO8"/></fig></p>
    </sec>
    <sec id="Sec8">
      <title>Imputation</title>
      <p>Missing genotypes were imputed with fastPHASE 1.4.8 program applying the parameters as follow. The number of EM starts with different seeds was 10 in all calculations. The number of EM iterations was fixed to 20, while the K value varied from 5 to 40 with a step of 5. The K was fixed to 20, while the number of EM varied from 5 to 35 with a step of 5. Missing genotypes were also imputed with BEAGLE 4.1 program applying default parameters without reference genome.</p>
    </sec>
    <sec id="Sec9">
      <title>hapFLK calculations</title>
      <p>hapFLK values were obtained with hapFLK (1.3.0) tool [<xref ref-type="bibr" rid="CR7">7</xref>]. Ten model fit iterations, 25 haplotype clusters, and YRI population as outgroup were applied. <italic>P</italic>-values of hapFLK were estimated with <italic>scaling_chi2_hapflk.py</italic> available at hapFLK website [<xref ref-type="bibr" rid="CR14">14</xref>]. The haplotype cluster frequencies were analysed and visualized with custom scripts in R. All plots in the paper were made with <italic>ggplot2</italic> R package [<xref ref-type="bibr" rid="CR15">15</xref>].</p>
    </sec>
    <sec id="Sec10">
      <title>Computational time</title>
      <p>We ran computations on Intel(R) Core(TM) i7-6800K CPU @ 3.40GHz machine with 64Gb RAM and 12 CPUs. Below are computation times in the case of a pool of CEU, TSI, CHB, and JPT populations. The creation of 5 masked files with <italic>make_test_files.R</italic> script took 5 minutes for chromosome 22 and 2 h for chromosome 1. The imputation with fastPHASE was quite time consuming. Thus, the imputation of 8 sets (K = 5, 10, 15, 20, 15, 30, 35, and 40) each having 5 masked files took 6 days for chromosome 22. In contrast, the imputation of 5 masked files with k = 35 took 6 days for chromosome 1.</p>
      <p>We noticed that fastPHASE utilizes only one CPU. Therefore several runs of this program can be made in parallel. The GNU <italic>parallel</italic> [<xref ref-type="bibr" rid="CR16">16</xref>] utility allows to do it. When it was applied, the imputation at K = 40 (5 masks) took 48 h for chromosome 1. The calculation of hapFLK metric required about 20 h.</p>
    </sec>
  </sec>
  <sec id="Sec11" sec-type="discussion">
    <title>Discussion</title>
    <p>An R package <italic>imputeqc</italic> is proposed and demonstrated for masked data analysis to estimate the quality of imputation and to select the optimal parameters for imputation and downstream analysis. Firstly, we wanted to be sure that the imputation error estimated by us was in agreement with literature data. For the purpose we reproduced the results published by the authors of fastPHASE tool. We masked 10 and 25% of genotypes. For both cases the estimated genotype imputation errors were similar to those obtained by Scheet and Stephens [<xref ref-type="bibr" rid="CR2">2</xref>]. The same seemed to be also true regarding the optimum number of haplotype clusters. We estimated this parameter to be 15 and 10 for 10 and 25% of masked genotypes, respectively. However, the authors of fastPHASE made accent on its lower value (K = 8) that probably reflected their desire to keep the computational burden low.</p>
    <p>Secondly, we demonstrated the application of <italic>imputeqc</italic> for the search of signatures of selection. It can be easily incorporated in a pipeline with hapFLK test. Here one needs to answer the question how many clusters should be considered in haplotype cluster model to perform hapFLK calculations in a particular pool of populations. That is why we merged datasets from 1000 Genomes Project (CEU, TSI, CHB, and JPT), generated several files with artificially missing genotypes, and imputed them with fastPHASE under different K values.</p>
    <p>As seen from Fig. <xref rid="Fig5" ref-type="fig">5</xref>, the median of genotype imputation error decreases from 0.029 to 0.018, when K increases from 5 to 40 in the case of chromosome 1. Other chromosomes tested showed similar behavior but the discordance was higher. The shorter the chromosome was, the higher the discordance became.</p>
    <p>We also found here that the error curve had an asymptotic shape at the range of K values studied, whereas in the case of one population it showed a clear minimum (Figs. <xref rid="Fig1" ref-type="fig">1</xref> and <xref rid="Fig2" ref-type="fig">2</xref>). The change of the shape can be attributed to the bias-variance trade-off [<xref ref-type="bibr" rid="CR17">17</xref>].</p>
    <p>The higher the number of haplotype cluster, the more complex the model becomes. On the one hand, the raise in complexity drops the bias of the model. It tends to predict the outcome variable more accurately. On the other hand, the variance of predicted values becomes higher with increasing the error. The counter-play of two tendencies (bias and variance) results in a minimum of imputation error that we observed in the case of one population imputed (CEPH from HapMap).</p>
    <p>When the object became more complex (e.g., four different populations were mixed), the minimum was not observed at the range of K values considered (Fig. <xref rid="Fig3" ref-type="fig">3</xref>). It is probably shifted to a higher number with K greater than 40. The positive influence of reduced bias predominates the imputation error observed. The error curve shows the permanent decrease. The question is how to choose the optimal K value in this case?</p>
    <p>Determining the optimal number of clusters is a fundamental problem in Data Science. For example, the R package NbClust [<xref ref-type="bibr" rid="CR18">18</xref>] provides 30 different indexes for estimating the best number of clusters. The authors of fastPHASE tested Akaike and Bayesian information criteria and found them to be inappropriate. To select K for fastPHASE, we propose an approach similar to “elbow” method [<xref ref-type="bibr" rid="CR19">19</xref>]. The location of a bend in a plot of error against K indicates the optimal number of clusters. More clusters will not make the model better but will increase dramatically the computational time. Following this way, we found the optimal number of haplotype clusters to be 25.</p>
    <p>To estimate the optimal K in the case of asymptotic behavior of the discordance curve, users can also apply more profound approach. For example, one can load the table with discordances created with EstimateQuality() function from <italic>imputeqc</italic> and process it with the function <italic>elbow()</italic> from GMD R package [<xref ref-type="bibr" rid="CR20">20</xref>].</p>
    <p>Package <italic>imputeqc</italic> has a practical benefit. There is a trade-off between accuracy and computational time, which depends on the model parameters. The computational complexity of fastPHASE algorithm is <inline-formula id="IEq1"><alternatives><tex-math id="M3">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\mathcal {O}\left (nMK^{2}\right)$\end{document}</tex-math><mml:math id="M4"><mml:mi mathvariant="script">O</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:mtext mathvariant="italic">nM</mml:mtext><mml:msup><mml:mrow><mml:mi>K</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mfenced></mml:math><inline-graphic xlink:href="12859_2020_3589_Article_IEq1.gif"/></alternatives></inline-formula>, which means that it is liner dependable on the number of individuals and markers but square dependable on the number of clusters [<xref ref-type="bibr" rid="CR2">2</xref>]. The optimization of K allows to reduce essentially the computational cost.</p>
    <p>The toolkit proposed is designed in such a way as to optimize not only the number of haplotype clusters but also other parameters of the model. As illustration we considered the optimization of the number of EM steps. It should be enough for the likelihood to converge at its maximum value. The convergence can be estimated visually by plotting likelihoods or by assessing imputation quality with <italic>imputeqc</italic> at different values of EM steps.</p>
    <p>The genotype imputation error demonstrated similar dependence on the number of EM cycles as that of haplotype cluster did (Fig. <xref rid="Fig6" ref-type="fig">6</xref>). Using “elbow” approach, we can conclude that the model converged in 20 iterations.</p>
    <p>Thus, we demonstrated the usage of <italic>imputeqc</italic> not only for the estimation of genotype imputation error but also for the selection of optimal values of K and EM parameters to secure the computational time. Using the optimal values of K and EM steps, we further applied them for hapFLK testing of populations from 1000 Genomes Project.</p>
    <p>The Manhattan plot of <italic>p</italic>-values estimated for hapFLK statistic showed a strong signal near <italic>LCT</italic> gene (Fig. <xref rid="Fig7" ref-type="fig">7</xref>). According to haplotype cluster frequencies, it is accounted by CEU population (Fig. <xref rid="Fig8" ref-type="fig">8</xref>). This observation is in a good agreement with the studies of haplotype diversity around <italic>LCT</italic> gene in human populations made with fastPHASE [<xref ref-type="bibr" rid="CR21">21</xref>] and BEAGLE [<xref ref-type="bibr" rid="CR22">22</xref>]. It should be also mentioned that hapFLK test has not yet been applied to the populations of humans. Our results showed its potential for the search of signatures of selection among humans.</p>
    <p>Thirdly, <italic>imputeqc</italic> is flexible regarding the input files of different formats. Potentially it can be used to estimate the quality of genotypes inferred by any imputation program. To illustrate this, we estimated the quality of imputation made by BEAGLE software. We applied it to the same set of populations and found the errors to be close to those obtained with fastPHASE (Table <xref rid="Tab1" ref-type="table">1</xref>).</p>
    <p>Thus, <italic>imputeqc</italic> can be used for the estimation of imputation quality on real data sets, with the imputation softwares being different. It also provides a way to optimize the parameters of imputation models or test different inputs of the program applied. For example, the user can run imputation with different reference panels and compare the discordance of genotypes reconstructed.</p>
    <p>To conclude, the <italic>imputeqc</italic> core functions are based on the standard R data classes [<xref ref-type="bibr" rid="CR23">23</xref>]. Therefore, for deeper analysis of imputation quality it can be extended with functions available at other R packages. We validated our toolkit for fastPHASE and BEAGLE softwares but it is quite adaptive and can be used with other imputations tools allowing the users to assess the imputation quality independently by self-designing tests. However, in this case the scripts to make the input files may be required. We consider the toolkit as especially useful for the developers of new imputation algorithms as well as for those who study the factors influencing the quality of reconstruction of missing genotypes.</p>
  </sec>
  <sec id="Sec12" sec-type="conclusion">
    <title>Conclusions</title>
    <p>A new open-source software toolkit, which includes an R package <italic>imputeqc</italic> and accompanied scripts, is proposed. It allows to estimate the quality of genotype imputation made with different tools as well as to determine the appropriate number of haplotype clusters for searching footprints of selection with hapFLK software. Other model parameters can be also optimized with <italic>imputeqc</italic>. The toolkit is freely available from GitHub repository by the link <ext-link ext-link-type="uri" xlink:href="https://github.com/inzilico/imputeqc">https://github.com/inzilico/imputeqc</ext-link>.</p>
  </sec>
  <sec id="Sec13">
    <title>Availability and requirements</title>
    <p><bold>Project name:</bold> imputeqc<bold>Project home page:</bold><ext-link ext-link-type="uri" xlink:href="https://github.com/inzilico/imputeqc">https://github.com/inzilico/imputeqc</ext-link><bold>Operating system(s):</bold> Platform independent<bold>Programming language:</bold> R<bold>Other requirements:</bold> R packages ggplot2, plyr, VariantAnnotation<bold>License:</bold> MIT License<bold>Any restrictions to use by non-academics:</bold> no restrictions</p>
  </sec>
</body>
<back>
  <glossary>
    <title>Abbreviations</title>
    <def-list>
      <def-item>
        <term>EM</term>
        <def>
          <p>Expectation-maximization</p>
        </def>
      </def-item>
      <def-item>
        <term>MAF</term>
        <def>
          <p>Minor allele frequencies</p>
        </def>
      </def-item>
      <def-item>
        <term>SNP</term>
        <def>
          <p>Single-nucleotide polymorphism</p>
        </def>
      </def-item>
      <def-item>
        <term>VCF</term>
        <def>
          <p>Variant call format</p>
        </def>
      </def-item>
    </def-list>
  </glossary>
  <fn-group>
    <fn>
      <p>
        <bold>Publisher’s Note</bold>
      </p>
      <p>Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p>
    </fn>
  </fn-group>
  <ack>
    <p>Not applicable.</p>
    <sec id="d30e1484">
      <title>About this supplement</title>
      <p>This article has been published as part of [BMC Bioinformatics, Volume 21 Supplement 12, 2020: Selected abstracts and papers of Bioinformatics: from Algorithms to Applications 2019 conference. The full contents of the supplement are available at <ext-link ext-link-type="uri" xlink:href="https://bmcbioinformatics.biomedcentral.com/articles/supplements/volume-21-supplement-12">https://bmcbioinformatics.biomedcentral.com/articles/supplements/volume-21-supplement-12</ext-link>].</p>
    </sec>
  </ack>
  <notes notes-type="author-contribution">
    <title>Authors’ contributions</title>
    <p>GVK designed and wrote the software, wrote the paper. AVK conceived the study and wrote the paper. The author(s) read and approved the final manuscript.</p>
  </notes>
  <notes notes-type="funding-information">
    <title>Funding</title>
    <p>The study and publication of this supplement was funded by RFBR (Russian Foundation for Basic Research) according to the research project No 19-29-01151. The foundation had no role in study design, data collection and analysis, writing the manuscript, and decision to publish.</p>
  </notes>
  <notes notes-type="data-availability">
    <title>Availability of data and materials</title>
    <p><italic>imputeqc</italic> is freely available under the MIT license by the link <ext-link ext-link-type="uri" xlink:href="https://github.com/inzilico/imputeqc">https://github.com/inzilico/imputeqc</ext-link>.</p>
  </notes>
  <notes id="FPar1">
    <title>Ethics approval and consent to participate</title>
    <p>Not applicable.</p>
  </notes>
  <notes id="FPar2">
    <title>Consent for publication</title>
    <p>Not applicable.</p>
  </notes>
  <notes id="FPar3" notes-type="COI-statement">
    <title>Competing interests</title>
    <p>The authors declare that they have no competing interests.</p>
  </notes>
  <ref-list id="Bib1">
    <title>References</title>
    <ref id="CR1">
      <label>1</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Spiliopoulou</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Colombo</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Orchard</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Agakov</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>McKeigue</surname>
            <given-names>P</given-names>
          </name>
        </person-group>
        <article-title>GeneImp: Fast imputation to large reference panels using genotype likelihoods from ultralow coverage sequencing</article-title>
        <source>Genetics</source>
        <year>2017</year>
        <volume>206</volume>
        <issue>1</issue>
        <fpage>91</fpage>
        <lpage>104</lpage>
        <pub-id pub-id-type="doi">10.1534/genetics.117.200063</pub-id>
        <?supplied-pmid 28348060?>
        <pub-id pub-id-type="pmid">28348060</pub-id>
      </element-citation>
    </ref>
    <ref id="CR2">
      <label>2</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Scheet</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Stephens</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>A fast and flexible statistical model for large-scale population genotype data: Applications to inferring missing genotypes and haplotypic phase</article-title>
        <source>Am J Hum Genet</source>
        <year>2006</year>
        <volume>78</volume>
        <issue>4</issue>
        <fpage>629</fpage>
        <lpage>44</lpage>
        <pub-id pub-id-type="doi">10.1086/502802</pub-id>
        <?supplied-pmid 16532393?>
        <pub-id pub-id-type="pmid">16532393</pub-id>
      </element-citation>
    </ref>
    <ref id="CR3">
      <label>3</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Li</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Willer</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Sanna</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Abecasis</surname>
            <given-names>G</given-names>
          </name>
        </person-group>
        <article-title>Genotype imputation</article-title>
        <source>Annu Rev Genomics Hum Genet</source>
        <year>2009</year>
        <volume>10</volume>
        <issue>1</issue>
        <fpage>387</fpage>
        <lpage>406</lpage>
        <pub-id pub-id-type="doi">10.1146/annurev.genom.9.081307.164242</pub-id>
        <?supplied-pmid 19715440?>
        <pub-id pub-id-type="pmid">19715440</pub-id>
      </element-citation>
    </ref>
    <ref id="CR4">
      <label>4</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Howie</surname>
            <given-names>BN</given-names>
          </name>
          <name>
            <surname>Donnelly</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Marchini</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>A flexible and accurate genotype imputation method for the next generation of genome-wide association studies</article-title>
        <source>PLoS Genet</source>
        <year>2009</year>
        <volume>5</volume>
        <issue>6</issue>
        <fpage>1000529</fpage>
        <pub-id pub-id-type="doi">10.1371/journal.pgen.1000529</pub-id>
      </element-citation>
    </ref>
    <ref id="CR5">
      <label>5</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Browning</surname>
            <given-names>BL</given-names>
          </name>
          <name>
            <surname>Browning</surname>
            <given-names>SR</given-names>
          </name>
        </person-group>
        <article-title>A unified approach to genotype imputation and haplotype-phase inference for large data sets of trios and unrelated individuals</article-title>
        <source>Am J Hum Genet</source>
        <year>2009</year>
        <volume>84</volume>
        <issue>2</issue>
        <fpage>210</fpage>
        <lpage>23</lpage>
        <pub-id pub-id-type="doi">10.1016/j.ajhg.2009.01.005</pub-id>
        <?supplied-pmid 19200528?>
        <pub-id pub-id-type="pmid">19200528</pub-id>
      </element-citation>
    </ref>
    <ref id="CR6">
      <label>6</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bak</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Hansen</surname>
            <given-names>LK</given-names>
          </name>
        </person-group>
        <article-title>Data driven estimation of imputation error—a strategy for imputation with a reject option</article-title>
        <source>PLOS ONE</source>
        <year>2016</year>
        <volume>11</volume>
        <issue>10</issue>
        <fpage>0164464</fpage>
      </element-citation>
    </ref>
    <ref id="CR7">
      <label>7</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Fariello</surname>
            <given-names>MI</given-names>
          </name>
          <name>
            <surname>Boitard</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Naya</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>SanCristobal</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Servin</surname>
            <given-names>B</given-names>
          </name>
        </person-group>
        <article-title>Detecting signatures of selection through haplotype differentiation among hierarchically structured populations</article-title>
        <source>Genetics</source>
        <year>2013</year>
        <volume>193</volume>
        <issue>3</issue>
        <fpage>929</fpage>
        <lpage>41</lpage>
        <pub-id pub-id-type="doi">10.1534/genetics.112.147231</pub-id>
        <?supplied-pmid 23307896?>
        <pub-id pub-id-type="pmid">23307896</pub-id>
      </element-citation>
    </ref>
    <ref id="CR8">
      <label>8</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Browning</surname>
            <given-names>SR</given-names>
          </name>
          <name>
            <surname>Weir</surname>
            <given-names>BS</given-names>
          </name>
        </person-group>
        <article-title>Population structure with localized haplotype clusters</article-title>
        <source>Genetics</source>
        <year>2010</year>
        <volume>185</volume>
        <issue>4</issue>
        <fpage>1337</fpage>
        <lpage>44</lpage>
        <pub-id pub-id-type="doi">10.1534/genetics.110.116681</pub-id>
        <?supplied-pmid 20457877?>
        <pub-id pub-id-type="pmid">20457877</pub-id>
      </element-citation>
    </ref>
    <ref id="CR9">
      <label>9</label>
      <mixed-citation publication-type="other">Integrating common and rare genetic variation in diverse human populations. Nature. 2010; 467(7311):52–58. 10.1038/nature09298.</mixed-citation>
    </ref>
    <ref id="CR10">
      <label>10</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Durbin</surname>
            <given-names>RM</given-names>
          </name>
          <name>
            <surname>Altshuler</surname>
            <given-names>DL</given-names>
          </name>
          <name>
            <surname>Durbin</surname>
            <given-names>RM</given-names>
          </name>
          <name>
            <surname>Abecasis</surname>
            <given-names>GR</given-names>
          </name>
          <name>
            <surname>Bentley</surname>
            <given-names>DR</given-names>
          </name>
          <name>
            <surname>Chakravarti</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Clark</surname>
            <given-names>AG</given-names>
          </name>
          <name>
            <surname>Collins</surname>
            <given-names>FS</given-names>
          </name>
          <name>
            <surname>Vega</surname>
            <given-names>FMDL</given-names>
          </name>
          <name>
            <surname>Donnelly</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Egholm</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Flicek</surname>
            <given-names>P</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>A map of human genome variation from population-scale sequencing</article-title>
        <source>Nature</source>
        <year>2010</year>
        <volume>467</volume>
        <issue>7319</issue>
        <fpage>1061</fpage>
        <lpage>73</lpage>
        <pub-id pub-id-type="doi">10.1038/nature09534</pub-id>
        <?supplied-pmid 20981092?>
        <pub-id pub-id-type="pmid">20981092</pub-id>
      </element-citation>
    </ref>
    <ref id="CR11">
      <label>11</label>
      <mixed-citation publication-type="other">Obenchain V, Lawrence M, Carey V, Gogarten S, Shannon P, Morgan M. VariantAnnotation: a bioconductor package for exploration and annotation of genetic variants. Bioinformatics. 2014; 30(14):2076–8. https://10.1093/bioinformatics/btu168.</mixed-citation>
    </ref>
    <ref id="CR12">
      <label>12</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Purcell</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Neale</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Todd-Brown</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Thomas</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Ferreira</surname>
            <given-names>MAR</given-names>
          </name>
          <name>
            <surname>Bender</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Maller</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Sklar</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>de Bakker</surname>
            <given-names>PIW</given-names>
          </name>
          <name>
            <surname>Daly</surname>
            <given-names>MJ</given-names>
          </name>
          <name>
            <surname>Sham</surname>
            <given-names>PC</given-names>
          </name>
        </person-group>
        <article-title>PLINK: A tool set for whole-genome association and population-based linkage analyses</article-title>
        <source>Am J Hum Genet</source>
        <year>2007</year>
        <volume>81</volume>
        <issue>3</issue>
        <fpage>559</fpage>
        <lpage>75</lpage>
        <pub-id pub-id-type="doi">10.1086/519795</pub-id>
        <?supplied-pmid 17701901?>
        <pub-id pub-id-type="pmid">17701901</pub-id>
      </element-citation>
    </ref>
    <ref id="CR13">
      <label>13</label>
      <mixed-citation publication-type="other">Danecek P, Auton A, Abecasis G, Albers CA, Banks E, DePristo MA, Handsaker RE, Lunter G, Marth GT, Sherry ST, McVean G, and RD. The variant call format and VCFtools. Bioinformatics. 2011; 27(15):2156–8. https://10.1093/bioinformatics/btr330.</mixed-citation>
    </ref>
    <ref id="CR14">
      <label>14</label>
      <mixed-citation publication-type="other">hapFLK. <ext-link ext-link-type="uri" xlink:href="https://forge-dga.jouy.inra.fr/projects/hapflk/">https://forge-dga.jouy.inra.fr/projects/hapflk/</ext-link>. Accessed 21 Aug 2017.</mixed-citation>
    </ref>
    <ref id="CR15">
      <label>15</label>
      <mixed-citation publication-type="other">Wickham H. Ggplot2: Elegant Graphics for Data Analysis: Springer; 2016. <ext-link ext-link-type="uri" xlink:href="https://ggplot2.tidyverse.org">https://ggplot2.tidyverse.org</ext-link>. Accessed 17 Dec 2019.</mixed-citation>
    </ref>
    <ref id="CR16">
      <label>16</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Tange</surname>
            <given-names>O</given-names>
          </name>
        </person-group>
        <article-title>Gnu parallel - the command-line power tool</article-title>
        <source>login USENIX Mag</source>
        <year>2011</year>
        <volume>36</volume>
        <issue>1</issue>
        <fpage>42</fpage>
        <lpage>47</lpage>
      </element-citation>
    </ref>
    <ref id="CR17">
      <label>17</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Hastie</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Tibshirani</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Friedman</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>The Elements of Statistical Learning</article-title>
        <source>Springer Series in Statistics</source>
        <year>2001</year>
        <publisher-loc>New York</publisher-loc>
        <publisher-name>Springer</publisher-name>
      </element-citation>
    </ref>
    <ref id="CR18">
      <label>18</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Charrad</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Ghazzali</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Boiteau</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Niknafs</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>Nbclust: An r package for determining the relevant number of clusters in a data set</article-title>
        <source>J Stat Softw Artic</source>
        <year>2014</year>
        <volume>61</volume>
        <issue>6</issue>
        <fpage>1</fpage>
        <lpage>36</lpage>
      </element-citation>
    </ref>
    <ref id="CR19">
      <label>19</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Thorndike</surname>
            <given-names>RL</given-names>
          </name>
        </person-group>
        <article-title>Who belongs in the family?</article-title>
        <source>Psychometrika</source>
        <year>1953</year>
        <volume>18</volume>
        <issue>4</issue>
        <fpage>267</fpage>
        <lpage>76</lpage>
        <pub-id pub-id-type="doi">10.1007/BF02289263</pub-id>
      </element-citation>
    </ref>
    <ref id="CR20">
      <label>20</label>
      <mixed-citation publication-type="other">GMD. <ext-link ext-link-type="uri" xlink:href="https://cran.r-project.org/src/contrib/Archive/GMD/">https://cran.r-project.org/src/contrib/Archive/GMD/</ext-link>. Accessed 24 Dec 2019.</mixed-citation>
    </ref>
    <ref id="CR21">
      <label>21</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Jakobsson</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Scholz</surname>
            <given-names>SW</given-names>
          </name>
          <name>
            <surname>Scheet</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Gibbs</surname>
            <given-names>JR</given-names>
          </name>
          <name>
            <surname>VanLiere</surname>
            <given-names>JM</given-names>
          </name>
          <name>
            <surname>Fung</surname>
            <given-names>H-C</given-names>
          </name>
          <name>
            <surname>Szpiech</surname>
            <given-names>ZA</given-names>
          </name>
          <name>
            <surname>Degnan</surname>
            <given-names>JH</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Guerreiro</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Bras</surname>
            <given-names>JM</given-names>
          </name>
          <name>
            <surname>Schymick</surname>
            <given-names>JC</given-names>
          </name>
          <name>
            <surname>Hernandez</surname>
            <given-names>DG</given-names>
          </name>
          <name>
            <surname>Traynor</surname>
            <given-names>BJ</given-names>
          </name>
          <name>
            <surname>Simon-Sanchez</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Matarin</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Britton</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>van de Leemput</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Rafferty</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Bucan</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Cann</surname>
            <given-names>HM</given-names>
          </name>
          <name>
            <surname>Hardy</surname>
            <given-names>JA</given-names>
          </name>
          <name>
            <surname>Rosenberg</surname>
            <given-names>NA</given-names>
          </name>
          <name>
            <surname>Singleton</surname>
            <given-names>AB</given-names>
          </name>
        </person-group>
        <article-title>Genotype, haplotype and copy-number variation in worldwide human populations</article-title>
        <source>Nature</source>
        <year>2008</year>
        <volume>451</volume>
        <issue>7181</issue>
        <fpage>998</fpage>
        <lpage>1003</lpage>
        <pub-id pub-id-type="doi">10.1038/nature06742</pub-id>
        <?supplied-pmid 18288195?>
        <pub-id pub-id-type="pmid">18288195</pub-id>
      </element-citation>
    </ref>
    <ref id="CR22">
      <label>22</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Browning</surname>
            <given-names>SR</given-names>
          </name>
          <name>
            <surname>Weir</surname>
            <given-names>BS</given-names>
          </name>
        </person-group>
        <article-title>Population structure with localized haplotype clusters</article-title>
        <source>Genetics</source>
        <year>2010</year>
        <volume>185</volume>
        <issue>4</issue>
        <fpage>1337</fpage>
        <lpage>44</lpage>
        <pub-id pub-id-type="doi">10.1534/genetics.110.116681</pub-id>
        <?supplied-pmid 20457877?>
        <pub-id pub-id-type="pmid">20457877</pub-id>
      </element-citation>
    </ref>
    <ref id="CR23">
      <label>23</label>
      <mixed-citation publication-type="other">R Core Team. R: A Language and Environment for Statistical Computing. Vienna: R Foundation for Statistical Computing; 2013. R Foundation for Statistical Computing <ext-link ext-link-type="uri" xlink:href="http://www.R-project.org/">http://www.R-project.org/</ext-link>. Accessed 11 June 2019.</mixed-citation>
    </ref>
  </ref-list>
</back>
