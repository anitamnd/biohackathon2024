<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName A++V2.4.dtd?>
<?SourceDTD.Version 2.4?>
<?ConverterInfo.XSLTName springer2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">BMC Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">BMC Bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>BMC Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="epub">1471-2105</issn>
    <publisher>
      <publisher-name>BioMed Central</publisher-name>
      <publisher-loc>London</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">5606221</article-id>
    <article-id pub-id-type="publisher-id">1790</article-id>
    <article-id pub-id-type="doi">10.1186/s12859-017-1790-x</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Research</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Bayesian Unidimensional Scaling for visualizing uncertainty in high dimensional datasets with latent ordering of observations</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author" corresp="yes">
        <name>
          <surname>Nguyen</surname>
          <given-names>Lan Huong</given-names>
        </name>
        <address>
          <email>lanhuong@stanford.edu</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Holmes</surname>
          <given-names>Susan</given-names>
        </name>
        <address>
          <email>susan@stat.stanford.edu</email>
        </address>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <aff id="Aff1"><label>1</label><institution-wrap><institution-id institution-id-type="ISNI">0000000419368956</institution-id><institution-id institution-id-type="GRID">grid.168010.e</institution-id><institution>Institute for Computational and Mathematical Engineering, </institution><institution>Stanford University, </institution></institution-wrap>Stanford, 94305 USA </aff>
      <aff id="Aff2"><label>2</label><institution-wrap><institution-id institution-id-type="ISNI">0000000419368956</institution-id><institution-id institution-id-type="GRID">grid.168010.e</institution-id><institution>Department of Statistics, </institution><institution>Stanford University, </institution></institution-wrap>Stanford, 94305 USA </aff>
    </contrib-group>
    <pub-date pub-type="epub">
      <day>13</day>
      <month>9</month>
      <year>2017</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>13</day>
      <month>9</month>
      <year>2017</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2017</year>
    </pub-date>
    <volume>18</volume>
    <issue>Suppl 10</issue>
    <issue-sponsor>Publication of this supplement has not been supported by sponsorship. Information about the source of funding for publication charges can be found in the individual articles. The articles have undergone the journal's standard peer review process for supplements. The Supplement Editors declare that they have no competing interests.</issue-sponsor>
    <elocation-id>394</elocation-id>
    <permissions>
      <copyright-statement>© The Author(s) 2017</copyright-statement>
      <license license-type="OpenAccess">
        <license-p><bold>Open Access</bold> This article is distributed under the terms of the Creative Commons Attribution 4.0 International License(<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted use, distribution, and reproduction in any medium, provided you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons license, and indicate if changes were made. The Creative Commons Public Domain Dedication waiver(<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/publicdomain/zero/1.0/">http://creativecommons.org/publicdomain/zero/1.0/</ext-link>) applies to the data made available in this article, unless otherwise stated.</license-p>
      </license>
    </permissions>
    <abstract id="Abs1">
      <sec>
        <title>Background</title>
        <p>Detecting patterns in high-dimensional multivariate datasets is non-trivial. Clustering and dimensionality reduction techniques often help in discerning inherent structures. In biological datasets such as microbial community composition or gene expression data, observations can be generated from a continuous process, often unknown. Estimating data points’ ‘natural ordering’ and their corresponding uncertainties can help researchers draw insights about the mechanisms involved.</p>
      </sec>
      <sec>
        <title>Results</title>
        <p>We introduce a Bayesian Unidimensional Scaling (BUDS) technique which extracts dominant sources of variation in high dimensional datasets and produces their visual data summaries, facilitating the exploration of a hidden continuum. The method maps multivariate data points to latent one-dimensional coordinates along their underlying trajectory, and provides estimated uncertainty bounds. By statistically modeling dissimilarities and applying a DiSTATIS registration method to their posterior samples, we are able to incorporate visualizations of uncertainties in the estimated data trajectory across different regions using confidence contours for individual data points. We also illustrate the estimated overall data density across different areas by including density clouds. One-dimensional coordinates recovered by BUDS help researchers discover sample attributes or covariates that are factors driving the main variability in a dataset. We demonstrated usefulness and accuracy of BUDS on a set of published microbiome 16S and RNA-seq and roll call data.</p>
      </sec>
      <sec>
        <title>Conclusions</title>
        <p>Our method effectively recovers and visualizes natural orderings present in datasets. Automatic visualization tools for data exploration and analysis are available at: <ext-link ext-link-type="uri" xlink:href="https://nlhuong.shinyapps.io/visTrajectory/">https://nlhuong.shinyapps.io/visTrajectory/</ext-link>.</p>
      </sec>
      <sec>
        <title>Electronic supplementary material</title>
        <p>The online version of this article (doi:10.1186/s12859-017-1790-x) contains supplementary material, which is available to authorized users.</p>
      </sec>
    </abstract>
    <kwd-group xml:lang="en">
      <title>Keywords</title>
      <kwd>Bayesian model</kwd>
      <kwd>Ordering</kwd>
      <kwd>Uncertainty</kwd>
      <kwd>Pseudotime</kwd>
      <kwd>Dimensionality reduction</kwd>
      <kwd>Microbiome</kwd>
      <kwd>Single cell</kwd>
    </kwd-group>
    <conference xlink:href="http://biovis.net/2017/">
      <conf-name>Symposium on Biological Data Visualization (BioVis) 2017</conf-name>
      <conf-loc>Prague, Czech Republic</conf-loc>
      <conf-date>24 July 17</conf-date>
    </conference>
    <custom-meta-group>
      <custom-meta>
        <meta-name>issue-copyright-statement</meta-name>
        <meta-value>© The Author(s) 2017</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec id="Sec1">
    <title>Background</title>
    <p>Multivariate, biological data is usually represented in the form of matrices, where features (e.g. genes, species) represent one dimension and observations (e.g. samples, cells) the other. In practice, these matrices have too many features to be visualized without pre-processing. Since a human brain can perceive no more than three dimensions, a large number of methods have been developed to collapse multivariate data to their low-dimensional representations; examples include standard principal component analysis, (PCA), classical, metric and non-metric multidimensional scaling (MDS), as well as more recent diffusion maps, and t-distributed Stochastic Neighbor Embedding (t-SNE). While simple 2 and 3D scatter plots of reduced data are visually appealing, alone they do not provide a clear view of what a “natural ordering” of data points should be nor the precision with which such an ordering is known. Continuous processes or gradients often induce “horseshoe” effects in low-dimensional linear projections of datasets involved. Diaconis et al. [<xref ref-type="bibr" rid="CR1">1</xref>] discuss in detail the horseshoe phenomenon in multidimensional scaling using an example of voting data. Making an assumption that legislators (observations) are uniformly spaced in a latent ideological left-right interval, they showed mathematically why horseshoes are observed. In practice, observations can be collected unevenly along their underlying gradient. Therefore, sampling density differences should be incorporated in an improved model.</p>
    <p>In this article, we propose Bayesian Unidimensional Scaling (BUDS), a class of models that maps observations to their latent one-dimensional coordinates and gives measures of uncertainty for the estimated quantities while taking into account varying data density across regions. These coordinates constitute summaries for high-dimensional data vectors, and can be used to explore and to discover the association between the data and various external covariates which might be available. BUDS includes a new statistical model for inter-point dissimilarities, which is used to infer data points’ latent locations. The Bayesian framework allows us to generate visualizations of the estimated uncertainties. Our method produces simple and easy to interpret plots, providing insights to the structure of the data.</p>
    <sec id="Sec2">
      <title>Related work</title>
      <p>Recovering data points’ ordering has recently become important in the single cell literature for studying cellular differentiation processes. A number of new algorithms have been proposed to estimate a pseudo-temporal ordering, or pseudotime, of cells from their gene expression profiles. Most of the methods are two-stage procedures, where the first step is designed to reduce large RNA-seq data to its k-dimensional representation, and the second to recover the ordering of the cells. The second step is performed by computing a minimum spanning tree (MST) or a principal curve on the reduced dataset, [<xref ref-type="bibr" rid="CR2">2</xref>–<xref ref-type="bibr" rid="CR5">5</xref>]. The methods listed are algorithmic and provide only point estimates of the cells’ positions along their transition trajectory.</p>
      <p>Very recently, new methods for pseudotime inference have been proposed that incorporate measures of uncertainty. However, they are based on a Gaussian Process Latent Variable Model (GPLVM) [<xref ref-type="bibr" rid="CR6">6</xref>–<xref ref-type="bibr" rid="CR8">8</xref>]. These methods make an assumption, which is not always applicable, that either features or components of a k-dimensional projection of the data can be represented by Gaussian Processes. Applying GPLVM to components of reduced data is often more effective as high-dimensional biological data tend to be very noisy. For example, Campbell et al. [<xref ref-type="bibr" rid="CR7">7</xref>] perform pseudotime fitting only on 2D embeddings of gene expression data. Unfortunately, this means that their uncertainty estimates for the inferred pseudotimes do not account for the uncertainties related to the dimensionality reduction step applied previously, and hence might be largely imprecise as the reduced representations might not capture enough of structure in the data. Reid and Wernich [<xref ref-type="bibr" rid="CR8">8</xref>] on the other hand implemented BGPLVM method directly to the data features (genes), but their method seems practical only when applied to a subset of genes, usually not more than 100. Thus, the method requires the user to choose which features to include in the analysis. Reid and Wernich’s method is semi-supervised as it requires capture times, which are a proxy for the latent parameters they want to recover. While this approach is suitable for studying cell states, as it encourages pseudotime estimates to be consistent with capture times, it is not appropriate for fully unsupervised problems, where no prior information on the relative ordering of observations is known.</p>
      <p>BUDS models pairwise dissimilarities on the original data directly. This means that BUDS can incorporate information from all features in the data, and can account for all uncertainties involved in the estimation process. Moreover, BUDS is flexible because it gives the user freedom to choose the most suitable dissimilarity metric for the application and type of data under study.</p>
    </sec>
  </sec>
  <sec id="Sec3">
    <title>Methods</title>
    <p>In this section, we discuss how we model, analyze and visualize datasets in which a hidden ordering of observations is present. We first give details on our generative Bayesian model and then describe the procedure for constructing visualizations based on the estimated latent variables.</p>
    <sec id="Sec4">
      <title>The model</title>
      <p>Biological data is represented as a matrix, <inline-formula id="IEq1"><alternatives><tex-math id="M1">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$X \in \mathbb {R}^{p \times n}$\end{document}</tex-math><mml:math id="M2"><mml:mi>X</mml:mi><mml:mo>∈</mml:mo><mml:msup><mml:mrow><mml:mi>ℝ</mml:mi></mml:mrow><mml:mrow><mml:mi>p</mml:mi><mml:mo>×</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:msup></mml:math><inline-graphic xlink:href="12859_2017_1790_Article_IEq1.gif"/></alternatives></inline-formula>. Corresponding pairwise dissimilarities, <italic>d</italic>
<sub><italic>ij</italic></sub>=<italic>d</italic>(<bold>x</bold>
<sub><italic>i</italic></sub>,<bold>x</bold>
<sub><italic>j</italic></sub>), can be computed where <inline-formula id="IEq2"><alternatives><tex-math id="M3">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\mathbf {x}_{i} \in \mathbb {R}^{p}$\end{document}</tex-math><mml:math id="M4"><mml:msub><mml:mrow><mml:mi mathvariant="bold">x</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>∈</mml:mo><mml:msup><mml:mrow><mml:mi>ℝ</mml:mi></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msup></mml:math><inline-graphic xlink:href="12859_2017_1790_Article_IEq2.gif"/></alternatives></inline-formula> is an <italic>i</italic>th-column of <italic>X</italic> representing the <italic>i</italic>th-observation. Dissimilarities quantify interactions between observations, and can be used to infer datapoints’ ordering. Since our method targets datasets with latent continua, we can assume that observations within these datasets lie approximately on one-dimensional manifolds (linear or non-linear) embedded in a higher dimensional space. As a result, the inter-point dissimilarities in the original space should be closely related to the distances along the latent data trajectory. Our model recovers the latent positions (1D coordinates) of the datapoints along that unknown trajectory. We take a parametric Bayesian approach and model original dissimilarities as random variables centered at distances in the latent 1D space. This allows us to to draw posterior samples of datapoints’ latent locations. These estimates specify the ordering of the observation according to the most dominant gradient in the data.</p>
      <p>The choice of dissimilarity measures in the original space should depend on the type and the distribution of the data. We observed that Jaccard distance seems robust to noise and allows for effective recovery of gradients hidden in 16S rRNA-seq microbial composition data. For gene expression data, we usually use a correlation-based distance, applied to normalized and log-transformed counts, <italic>d</italic>(<bold>x</bold>
<sub><italic>i</italic></sub>,<bold>x</bold>
<sub><italic>j</italic></sub>)=(1−<italic>ρ</italic>(<bold>x</bold>
<sub><italic>i</italic></sub>,<bold>x</bold>
<sub><italic>j</italic></sub>))/2 where <italic>ρ</italic>(<bold>x</bold>
<sub><italic>i</italic></sub>,<bold>x</bold>
<sub><italic>j</italic></sub>) is a Pearson correlation between <bold>x</bold>
<sub><italic>i</italic></sub> and <bold>x</bold>
<sub><italic>j</italic></sub>. On the voting (binary) data we used a kernel <italic>L</italic>
<sub>1</sub> data.</p>
      <p>Mathematically, we want to use these pairwise dissimilarities to map high dimensional datapoints, <bold>x</bold>
<sub><italic>i</italic></sub>, to their latent coordinates, <italic>τ</italic>
<sub><italic>i</italic></sub>∈[0,1]. These coordinates represent positions of the observations along their unknown trajectory. The more similar the <italic>i</italic>th and the <italic>j</italic>th observation are, the closer <italic>τ</italic>
<sub><italic>i</italic></sub> and <italic>τ</italic>
<sub><italic>j</italic></sub> should be. It follows that <bold><italic>τ</italic></bold> can also be used for database indexing, where it is of interest to store similar objects closer together for faster lookup. With <bold><italic>τ</italic></bold> one can generate many useful visualizations that help understand and discover patterns in the data. To infer <bold><italic>τ</italic></bold>, we model dissimilarities on high-dimensional data, <italic>d</italic>
<sub><italic>ij</italic></sub>, as noisy realizations of the true underlying distances <italic>δ</italic>
<sub><italic>ij</italic></sub>=|<italic>τ</italic>
<sub><italic>i</italic></sub>−<italic>τ</italic>
<sub><italic>j</italic></sub>|.</p>
      <p>Overall, our method can be thought of as a special case of Bayesian Multidimensional Scaling technique, whose objective is to recover from a set of pairwise dissimilarities a <italic>k</italic>-dimensional representation of the original data together with associated measures of uncertainty. Previously, Bayesian MDS methods have been implemented in [<xref ref-type="bibr" rid="CR9">9</xref>, <xref ref-type="bibr" rid="CR10">10</xref>], where authors used models based on truncated-normal, and log-normal distributions. These models, however, do not allow for varying levels of noise across different regions of the data. We believe that when modeling dissimilarities one needs to accommodate for heteroscedastic noise, whose scale should be estimated from the data itself. We, thus, developed a model based on a Gamma distribution with a varying scale factor for the noise term: 
<disp-formula id="Equ1"><label>1</label><alternatives><tex-math id="M5">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$\begin{array}{*{20}l} d_{ij} | \delta_{ij} &amp; \sim \text{Gamma}\left[\mu_{ij} = \delta_{ij}, \, \sigma_{ij}^{2} = s_{ij}^{2}\sigma_{\epsilon}^{2}\right], \\ \delta_{ij} &amp; = |\tau_{i} - \tau_{j}|,  \\ \tau_{i} | \alpha_{\tau}, \beta_{\tau} &amp; \sim \text{Beta}(\alpha_{\tau}, \beta_{\tau}), \\ \alpha_{\tau} &amp; \sim \text{Cauchy}^{+}(1, \gamma_{\tau}), \\ \beta_{\tau} &amp; \sim \text{Cauchy}^{+}(1, \gamma_{\tau}), \\ \sigma_{\epsilon} &amp; \sim \text{Cauchy}^{+}(0, \gamma_{\epsilon}), \\  \end{array} $$ \end{document}</tex-math><mml:math id="M6"><mml:mtable class="align" columnalign="left"><mml:mtr><mml:mtd class="align-1"><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ij</mml:mtext></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>δ</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ij</mml:mtext></mml:mrow></mml:msub></mml:mtd><mml:mtd class="align-2"><mml:mo>∼</mml:mo><mml:mtext>Gamma</mml:mtext><mml:mfenced close="]" open="[" separators=""><mml:mrow><mml:msub><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ij</mml:mtext></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>δ</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ij</mml:mtext></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mspace width="0.3em"/><mml:msubsup><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ij</mml:mtext></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:msubsup><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ij</mml:mtext></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:msubsup><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mi>ε</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:mrow></mml:mfenced><mml:mo>,</mml:mo><mml:mspace width="2em"/></mml:mtd></mml:mtr><mml:mtr><mml:mtd class="align-1"><mml:msub><mml:mrow><mml:mi>δ</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ij</mml:mtext></mml:mrow></mml:msub></mml:mtd><mml:mtd class="align-2"><mml:mo>=</mml:mo><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>τ</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi>τ</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:mo>,</mml:mo><mml:mspace width="2em"/></mml:mtd><mml:mtd><mml:mspace width="2em"/></mml:mtd></mml:mtr><mml:mtr><mml:mtd class="align-1"><mml:msub><mml:mrow><mml:mi>τ</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mi>τ</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:mi>τ</mml:mi></mml:mrow></mml:msub></mml:mtd><mml:mtd class="align-2"><mml:mo>∼</mml:mo><mml:mtext>Beta</mml:mtext><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mi>τ</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:mi>τ</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo><mml:mo>,</mml:mo><mml:mspace width="2em"/></mml:mtd><mml:mtd><mml:mspace width="2em"/></mml:mtd></mml:mtr><mml:mtr><mml:mtd class="align-1"><mml:msub><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mi>τ</mml:mi></mml:mrow></mml:msub></mml:mtd><mml:mtd class="align-2"><mml:mo>∼</mml:mo><mml:msup><mml:mrow><mml:mtext>Cauchy</mml:mtext></mml:mrow><mml:mrow><mml:mo>+</mml:mo></mml:mrow></mml:msup><mml:mo>(</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>γ</mml:mi></mml:mrow><mml:mrow><mml:mi>τ</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo><mml:mo>,</mml:mo><mml:mspace width="2em"/></mml:mtd><mml:mtd><mml:mspace width="2em"/></mml:mtd></mml:mtr><mml:mtr><mml:mtd class="align-1"><mml:msub><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:mi>τ</mml:mi></mml:mrow></mml:msub></mml:mtd><mml:mtd class="align-2"><mml:mo>∼</mml:mo><mml:msup><mml:mrow><mml:mtext>Cauchy</mml:mtext></mml:mrow><mml:mrow><mml:mo>+</mml:mo></mml:mrow></mml:msup><mml:mo>(</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>γ</mml:mi></mml:mrow><mml:mrow><mml:mi>τ</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo><mml:mo>,</mml:mo><mml:mspace width="2em"/></mml:mtd><mml:mtd><mml:mspace width="2em"/></mml:mtd></mml:mtr><mml:mtr><mml:mtd class="align-1"><mml:msub><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mi>ε</mml:mi></mml:mrow></mml:msub></mml:mtd><mml:mtd class="align-2"><mml:mo>∼</mml:mo><mml:msup><mml:mrow><mml:mtext>Cauchy</mml:mtext></mml:mrow><mml:mrow><mml:mo>+</mml:mo></mml:mrow></mml:msup><mml:mo>(</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>γ</mml:mi></mml:mrow><mml:mrow><mml:mi>ε</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo><mml:mo>,</mml:mo><mml:mspace width="2em"/></mml:mtd><mml:mtd><mml:mspace width="2em"/></mml:mtd></mml:mtr><mml:mtr><mml:mtd class="align-1"/></mml:mtr></mml:mtable></mml:math><graphic xlink:href="12859_2017_1790_Article_Equ1.gif" position="anchor"/></alternatives></disp-formula>
</p>
      <p>where <inline-formula id="IEq3"><alternatives><tex-math id="M7">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$s_{ij} \propto \hat {s}(d_{ij})$\end{document}</tex-math><mml:math id="M8"><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ij</mml:mtext></mml:mrow></mml:msub><mml:mo>∝</mml:mo><mml:mi>ŝ</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ij</mml:mtext></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:math><inline-graphic xlink:href="12859_2017_1790_Article_IEq3.gif"/></alternatives></inline-formula> and <inline-formula id="IEq4"><alternatives><tex-math id="M9">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\hat {s}^{2}(d_{ij})$\end{document}</tex-math><mml:math id="M10"><mml:msup><mml:mrow><mml:mi>ŝ</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ij</mml:mtext></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:math><inline-graphic xlink:href="12859_2017_1790_Article_IEq4.gif"/></alternatives></inline-formula> is an empirical estimate of the variance of <italic>d</italic>
<sub><italic>ij</italic></sub> discussed in the next section. Note that the Gamma distribution is usually parametrized with shape and rate (<italic>α</italic>,<italic>β</italic>) parameters rather than mean and variance (<italic>μ</italic>,<italic>σ</italic>
<sup>2</sup>). The shape and the rate parameter for <italic>d</italic>
<sub><italic>ij</italic></sub> can be easily obtained using the following conversion: <inline-formula id="IEq5"><alternatives><tex-math id="M11">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\alpha _{ij} = \mu _{ij}^{2}/\sigma _{ij}^{2}$\end{document}</tex-math><mml:math id="M12"><mml:msub><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ij</mml:mtext></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msubsup><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ij</mml:mtext></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo>/</mml:mo><mml:msubsup><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ij</mml:mtext></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="12859_2017_1790_Article_IEq5.gif"/></alternatives></inline-formula>, <inline-formula id="IEq6"><alternatives><tex-math id="M13">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\beta _{ij} = \mu _{ij}/\sigma _{ij}^{2}$\end{document}</tex-math><mml:math id="M14"><mml:msub><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ij</mml:mtext></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ij</mml:mtext></mml:mrow></mml:msub><mml:mo>/</mml:mo><mml:msubsup><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ij</mml:mtext></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="12859_2017_1790_Article_IEq6.gif"/></alternatives></inline-formula>. Note that <italic>α</italic>
<sub><italic>τ</italic></sub>,<italic>β</italic>
<sub><italic>τ</italic></sub> are centered around 1, as Beta(1, 1) is similar to the uniform distribution which is the assumed distribution of <italic>τ</italic>
<sub><italic>i</italic></sub>’s if no prior knowledge of the sampling density is available. However, since <italic>α</italic>
<sub><italic>τ</italic></sub> and <italic>β</italic>
<sub><italic>τ</italic></sub> are treated as random variables, the BUDS can infer unequal values for the parameters that are away from 1, which means it can model datasets where the sampling density is higher on one or both ends of the data trajectory.</p>
      <p>In general, our model postulates a one dimensional gradient along which the true underlying distances are measured with noise. Distances are assumed to have a Gamma distribution, a fairly flexible distribution with a positive support. As dissimilarities are inherently non-negative quantities, Gamma seems to be a reasonable choice. Dissimilarities can be more or less reliable depending on their range and the density or sparsity of the data region, therefore our model incorporates a varying scale factor for the noise term. We estimate the variance of individual <italic>d</italic>
<sub><italic>ij</italic></sub>’s using the nearest neighbors of the two datapoints <bold>x</bold>
<sub><italic>i</italic></sub> and <bold>x</bold>
<sub><italic>j</italic></sub> associated with the dissimilarity. The details on how to estimate the scale of the noise term are included in the next section.</p>
      <p>Since dissimilarities on high dimensional vectors can have a different range than the ones on 1D coordinates, we incorporate the following shift and scale transformation within our model to bring the distributions of the dissimilarities closer together: 
<disp-formula id="Equ2"><label>2</label><alternatives><tex-math id="M15">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$\begin{array}{*{20}l} \tilde \delta_{ij} &amp; = b + \rho|\tau_{i} - \tau_{j}|, \\ b &amp; \sim \text{Cauchy}^{+}(0, \gamma_{b}), \\ \rho &amp; \sim \text{Cauchy}^{+}(1, \gamma_{\rho}) \\  \end{array} $$ \end{document}</tex-math><mml:math id="M16"><mml:mtable class="align" columnalign="left"><mml:mtr><mml:mtd class="align-1"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>δ</mml:mi></mml:mrow><mml:mo>~</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ij</mml:mtext></mml:mrow></mml:msub></mml:mtd><mml:mtd class="align-2"><mml:mo>=</mml:mo><mml:mi>b</mml:mi><mml:mo>+</mml:mo><mml:mi>ρ</mml:mi><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>τ</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi>τ</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:mo>,</mml:mo><mml:mspace width="2em"/></mml:mtd></mml:mtr><mml:mtr><mml:mtd class="align-1"><mml:mi>b</mml:mi></mml:mtd><mml:mtd class="align-2"><mml:mo>∼</mml:mo><mml:msup><mml:mrow><mml:mtext>Cauchy</mml:mtext></mml:mrow><mml:mrow><mml:mo>+</mml:mo></mml:mrow></mml:msup><mml:mo>(</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>γ</mml:mi></mml:mrow><mml:mrow><mml:mi>b</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo><mml:mo>,</mml:mo><mml:mspace width="2em"/></mml:mtd><mml:mtd><mml:mspace width="2em"/></mml:mtd></mml:mtr><mml:mtr><mml:mtd class="align-1"><mml:mi>ρ</mml:mi></mml:mtd><mml:mtd class="align-2"><mml:mo>∼</mml:mo><mml:msup><mml:mrow><mml:mtext>Cauchy</mml:mtext></mml:mrow><mml:mrow><mml:mo>+</mml:mo></mml:mrow></mml:msup><mml:mo>(</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>γ</mml:mi></mml:mrow><mml:mrow><mml:mi>ρ</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo><mml:mspace width="2em"/></mml:mtd><mml:mtd><mml:mspace width="2em"/></mml:mtd></mml:mtr><mml:mtr><mml:mtd class="align-1"/></mml:mtr></mml:mtable></mml:math><graphic xlink:href="12859_2017_1790_Article_Equ2.gif" position="anchor"/></alternatives></disp-formula>
</p>
      <p>where <italic>b</italic> and <italic>ρ</italic> are treated latent variables, inferred together with <bold><italic>τ</italic></bold> from the posterior. Now <inline-formula id="IEq7"><alternatives><tex-math id="M17">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\tilde \delta _{ij}$\end{document}</tex-math><mml:math id="M18"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>δ</mml:mi></mml:mrow><mml:mo>~</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ij</mml:mtext></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12859_2017_1790_Article_IEq7.gif"/></alternatives></inline-formula> can be substituted for <italic>δ</italic>
<sub><italic>ij</italic></sub> in the main model.</p>
      <p>In some cases the dissimilarities in high-dimensional settings can be concentrated far away from zero, and provide insufficient contrast between large and small scale interactions between datapoints. The following rank-based transformation can help alleviate the issue and bring the distribution of <italic>d</italic>
<sub><italic>ij</italic></sub>’s closer to the one of <inline-formula id="IEq8"><alternatives><tex-math id="M19">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\tilde \delta _{ij}$\end{document}</tex-math><mml:math id="M20"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>δ</mml:mi></mml:mrow><mml:mo>~</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ij</mml:mtext></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12859_2017_1790_Article_IEq8.gif"/></alternatives></inline-formula>’s, 
<disp-formula id="Equa"><alternatives><tex-math id="M21">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$\tilde d_{ij} = 1 - \sqrt{1 - \text{rank}(d_{ij})/m} $$ \end{document}</tex-math><mml:math id="M22"><mml:mrow><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mo>~</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ij</mml:mtext></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msqrt><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mtext>rank</mml:mtext><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ij</mml:mtext></mml:mrow></mml:msub><mml:mo>)</mml:mo><mml:mo>/</mml:mo><mml:mi>m</mml:mi></mml:mrow></mml:msqrt></mml:mrow></mml:math><graphic xlink:href="12859_2017_1790_Article_Equa.gif" position="anchor"/></alternatives></disp-formula> where <italic>m</italic>=<italic>n</italic>(<italic>n</italic>−1)/2 is the number of distinct pairwise dissimilarities, assumed symmetric. The rank-based transformation is similar to techniques used in ordinal Multidimensional Scaling which are aimed at preserving only the ordering of observed dissimilarities [<xref ref-type="bibr" rid="CR11">11</xref>] and not their values.</p>
    </sec>
    <sec id="Sec5">
      <title>Variance of dissimilarities</title>
      <p>Pairwise dissimilarities, either directly observed or computed from the original data can be noisy. The accuracy of dissimilarities in measuring interactions between pairs of observations does not need to be constant across all observations. For example, a dataset might be imbalanced, and some parts of the its latent trajectory might be more densely represented than others. We expect dissimilarities to contain less noise in data-rich regions than in the ones where only a few observations have been collected.</p>
      <p>A data-driven approach is taken to estimate scale factors for the noise. We use local information to estimate the variance of individual <italic>d</italic>
<sub><italic>ij</italic></sub>’s, as illustrated in Fig. <xref rid="Fig1" ref-type="fig">1</xref>. First, for each <italic>d</italic>
<sub><italic>ij</italic></sub>, we gather a set of <italic>K</italic>-nearest neighbors of <bold>x</bold>
<sub><italic>i</italic></sub> and <bold>x</bold>
<sub><italic>j</italic></sub>, denoted <italic>Γ</italic>
<sub><italic>K</italic></sub>(<bold>x</bold>
<sub><italic>i</italic></sub>) and <italic>Γ</italic>
<sub><italic>K</italic></sub>(<bold>x</bold>
<sub><italic>j</italic></sub>) respectively. We then estimate the variance of <italic>d</italic>
<sub><italic>ij</italic></sub> as the empirical variance of distances between <bold>x</bold>
<sub><italic>o</italic></sub> and the <italic>K</italic>-nearest-neighbors of <bold>x</bold>
<sub><italic>j</italic></sub> and between <bold>x</bold>
<sub><italic>j</italic></sub> and the <italic>K</italic>-nearest-neighbors of <bold>x</bold>
<sub><italic>i</italic></sub>. More precisely, 
<disp-formula id="Equb"><alternatives><tex-math id="M23">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$\begin{array}{*{20}l} \hat{s}^{2}(d_{ij}) &amp;= \frac{1}{|\mathcal{D}^{K}_{ij}|- 1}\sum\limits_{d \in \mathcal{D}^{K}_{ij}} \left(d - \bar{d^{K}_{ij}}\right)^{2} \end{array} $$ \end{document}</tex-math><mml:math id="M24"><mml:mtable class="align" columnalign="left"><mml:mtr><mml:mtd class="align-1"><mml:msup><mml:mrow><mml:mi>ŝ</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ij</mml:mtext></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mtd><mml:mtd class="align-2"><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mo>|</mml:mo><mml:msubsup><mml:mrow><mml:mi mathvariant="script">D</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ij</mml:mtext></mml:mrow><mml:mrow><mml:mi>K</mml:mi></mml:mrow></mml:msubsup><mml:mo>|</mml:mo><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfrac><mml:munder><mml:mrow><mml:mo mathsize="big">∑</mml:mo></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mo>∈</mml:mo><mml:msubsup><mml:mrow><mml:mi mathvariant="script">D</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ij</mml:mtext></mml:mrow><mml:mrow><mml:mi>K</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:munder><mml:msup><mml:mrow><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mi>d</mml:mi><mml:mo>−</mml:mo><mml:mover accent="true"><mml:mrow><mml:msubsup><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ij</mml:mtext></mml:mrow><mml:mrow><mml:mi>K</mml:mi></mml:mrow></mml:msubsup></mml:mrow><mml:mo>¯</mml:mo></mml:mover></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mspace width="2em"/></mml:mtd><mml:mtd><mml:mspace width="2em"/></mml:mtd></mml:mtr></mml:mtable></mml:math><graphic xlink:href="12859_2017_1790_Article_Equb.gif" position="anchor"/></alternatives></disp-formula>
<fig id="Fig1"><label>Fig. 1</label><caption><p>Graphical representation of points <bold>x</bold>
<sub><italic>i</italic></sub> and <bold>x</bold>
<sub><italic>j</italic></sub> together with their neighbors. The set of (dashed) distances from <bold>x</bold>
<sub><italic>i</italic></sub> to the <italic>K</italic>-nearest-neighbors of <bold>x</bold>
<sub><italic>j</italic></sub>, and from <bold>x</bold>
<sub><italic>i</italic></sub> to the <italic>K</italic>-nearest-neighbors of <bold>x</bold>
<sub><italic>i</italic></sub> is used to compute <inline-formula id="IEq9"><alternatives><tex-math id="M25">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\hat {s}^{2}(d_{ij})$\end{document}</tex-math><mml:math id="M26"><mml:msup><mml:mrow><mml:mi>ŝ</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ij</mml:mtext></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:math><inline-graphic xlink:href="12859_2017_1790_Article_IEq9.gif"/></alternatives></inline-formula>, the estimate of the variance of <italic>d</italic>
<sub><italic>ij</italic></sub>. Here we chose <italic>K</italic>=5</p></caption><graphic xlink:href="12859_2017_1790_Fig1_HTML" id="MO1"/></fig>
</p>
      <p>where <inline-formula id="IEq10"><alternatives><tex-math id="M27">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\bar {d^{K}_{ij}} := \frac {1}{|\mathcal {D}^{K}_{ij}|} \sum \limits _{d \in \mathcal {D}^{K}_{ij}} d$\end{document}</tex-math><mml:math id="M28"><mml:mover accent="true"><mml:mrow><mml:msubsup><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ij</mml:mtext></mml:mrow><mml:mrow><mml:mi>K</mml:mi></mml:mrow></mml:msubsup></mml:mrow><mml:mo>¯</mml:mo></mml:mover><mml:mo>:</mml:mo><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mo>|</mml:mo><mml:msubsup><mml:mrow><mml:mi mathvariant="script">D</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ij</mml:mtext></mml:mrow><mml:mrow><mml:mi>K</mml:mi></mml:mrow></mml:msubsup><mml:mo>|</mml:mo></mml:mrow></mml:mfrac><mml:munder><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mo>∈</mml:mo><mml:msubsup><mml:mrow><mml:mi mathvariant="script">D</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ij</mml:mtext></mml:mrow><mml:mrow><mml:mi>K</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:munder><mml:mi>d</mml:mi></mml:math><inline-graphic xlink:href="12859_2017_1790_Article_IEq10.gif"/></alternatives></inline-formula> is the average distance over the set <inline-formula id="IEq11"><alternatives><tex-math id="M29">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\mathcal {D}^{K}_{ij}$\end{document}</tex-math><mml:math id="M30"><mml:msubsup><mml:mrow><mml:mi mathvariant="script">D</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ij</mml:mtext></mml:mrow><mml:mrow><mml:mi>K</mml:mi></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="12859_2017_1790_Article_IEq11.gif"/></alternatives></inline-formula> defined as: 
<disp-formula id="Equc"><alternatives><tex-math id="M31">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$\begin{array}{*{20}l} \mathcal{D}^{K}_{ij} &amp; := \{d(\mathbf{x_{i}}, \mathbf{x_{k}}) \;| \; \mathbf{x_{k}} \in \Gamma_{K} (\mathbf{x_{j}})\ \backslash \left.\left.\{{\mathbf{x}_{i}}\right\}\right\} \\ &amp; \quad \quad \cup \{d(\mathbf{x_{j}}, \mathbf{x_{l}}) \;| \; \mathbf{x_{1}} \in \Gamma_{K} (\mathbf{x_{j}})\ \backslash \left.\left.\{{\mathbf{x}_{j}}\right\}\right\} \end{array} $$ \end{document}</tex-math><mml:math id="M32"><mml:mtable class="align" columnalign="left"><mml:mtr><mml:mtd class="align-1"><mml:msubsup><mml:mrow><mml:mi mathvariant="script">D</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ij</mml:mtext></mml:mrow><mml:mrow><mml:mi>K</mml:mi></mml:mrow></mml:msubsup></mml:mtd><mml:mtd class="align-2"><mml:mo>:</mml:mo><mml:mo>=</mml:mo><mml:mo>{</mml:mo><mml:mi>d</mml:mi><mml:mo>(</mml:mo><mml:mstyle mathvariant="bold"><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mstyle><mml:mo>,</mml:mo><mml:mstyle mathvariant="bold"><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mstyle><mml:mo>)</mml:mo><mml:mspace width="2.77626pt"/><mml:mo>|</mml:mo><mml:mspace width="2.77626pt"/><mml:mstyle mathvariant="bold"><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mstyle><mml:mo>∈</mml:mo><mml:msub><mml:mrow><mml:mi>Γ</mml:mi></mml:mrow><mml:mrow><mml:mi>K</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mstyle mathvariant="bold"><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mstyle><mml:mo>)</mml:mo><mml:mspace width="1em"/><mml:mo>∖</mml:mo><mml:mfenced close="}" open="" separators=""><mml:mrow><mml:mfenced close="}" open="" separators=""><mml:mrow><mml:mo>{</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold">x</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:mrow></mml:mfenced><mml:mspace width="2em"/></mml:mtd><mml:mtd><mml:mspace width="2em"/></mml:mtd></mml:mtr><mml:mtr><mml:mtd class="align-1"/><mml:mtd class="align-2"><mml:mspace width="1em"/><mml:mspace width="1em"/><mml:mo>∪</mml:mo><mml:mo>{</mml:mo><mml:mi>d</mml:mi><mml:mo>(</mml:mo><mml:mstyle mathvariant="bold"><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mstyle><mml:mo>,</mml:mo><mml:mstyle mathvariant="bold"><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:msub></mml:mstyle><mml:mo>)</mml:mo><mml:mspace width="2.77626pt"/><mml:mo>|</mml:mo><mml:mspace width="2.77626pt"/><mml:mstyle mathvariant="bold"><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mstyle><mml:mo>∈</mml:mo><mml:msub><mml:mrow><mml:mi>Γ</mml:mi></mml:mrow><mml:mrow><mml:mi>K</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mstyle mathvariant="bold"><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mstyle><mml:mo>)</mml:mo><mml:mspace width="1em"/><mml:mo>∖</mml:mo><mml:mfenced close="}" open="" separators=""><mml:mrow><mml:mfenced close="}" open="" separators=""><mml:mrow><mml:mo>{</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold">x</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:mrow></mml:mfenced><mml:mspace width="2em"/></mml:mtd><mml:mtd><mml:mspace width="2em"/></mml:mtd></mml:mtr></mml:mtable></mml:math><graphic xlink:href="12859_2017_1790_Article_Equc.gif" position="anchor"/></alternatives></disp-formula>
</p>
      <p>Note that we exclude the <bold>x</bold>
<sub><italic>i</italic></sub> from the set of neighbors of <bold>x</bold>
<sub><italic>j</italic></sub> and vice versa when gathering the distances in the set <inline-formula id="IEq12"><alternatives><tex-math id="M33">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\mathcal {D}^{K}_{ij}$\end{document}</tex-math><mml:math id="M34"><mml:msubsup><mml:mrow><mml:mi mathvariant="script">D</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ij</mml:mtext></mml:mrow><mml:mrow><mml:mi>K</mml:mi></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="12859_2017_1790_Article_IEq12.gif"/></alternatives></inline-formula>. This, is useful in cases when <bold>x</bold>
<sub><italic>i</italic></sub> and <bold>x</bold>
<sub><italic>j</italic></sub> are within each other’s <italic>K</italic>-nearest-neighborhoods. Without exclusion the set <inline-formula id="IEq13"><alternatives><tex-math id="M35">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\mathcal {D}^{K}_{ij}$\end{document}</tex-math><mml:math id="M36"><mml:msubsup><mml:mrow><mml:mi mathvariant="script">D</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ij</mml:mtext></mml:mrow><mml:mrow><mml:mi>K</mml:mi></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="12859_2017_1790_Article_IEq13.gif"/></alternatives></inline-formula> would contain zero-distances <italic>d</italic>(<bold>x</bold>
<sub><italic>i</italic></sub>,<bold>x</bold>
<sub><italic>i</italic></sub>) or <italic>d</italic>(<bold>x</bold>
<sub><italic>j</italic></sub>,<bold>x</bold>
<sub><italic>j</italic></sub>) which would have an undesirable effect of largely overestimating the variance of <italic>d</italic>
<sub><italic>ij</italic></sub>.</p>
      <p>We use <inline-formula id="IEq14"><alternatives><tex-math id="M37">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\hat {s}^{2}(d_{ij})$\end{document}</tex-math><mml:math id="M38"><mml:msup><mml:mrow><mml:mi>ŝ</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ij</mml:mtext></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:math><inline-graphic xlink:href="12859_2017_1790_Article_IEq14.gif"/></alternatives></inline-formula> only as a relative estimate, and then compute the scale parameter for the noise term as follows: 
<disp-formula id="Equd"><alternatives><tex-math id="M39">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$s^{2}_{ij} = \hat{s}^{2}(d_{ij}) / \overline{\hat{s}^{2}(d_{ij})} $$ \end{document}</tex-math><mml:math id="M40"><mml:mrow><mml:msubsup><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ij</mml:mtext></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mi>ŝ</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ij</mml:mtext></mml:mrow></mml:msub><mml:mo>)</mml:mo><mml:mo>/</mml:mo><mml:mover accent="false"><mml:mrow><mml:msup><mml:mrow><mml:mi>ŝ</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ij</mml:mtext></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mo accent="true">¯</mml:mo></mml:mover></mml:mrow></mml:math><graphic xlink:href="12859_2017_1790_Article_Equd.gif" position="anchor"/></alternatives></disp-formula> where the bar notation represents the empirical mean over all <inline-formula id="IEq15"><alternatives><tex-math id="M41">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\hat {s}(d_{ij})$\end{document}</tex-math><mml:math id="M42"><mml:mi>ŝ</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ij</mml:mtext></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:math><inline-graphic xlink:href="12859_2017_1790_Article_IEq15.gif"/></alternatives></inline-formula>’s. The mean variance for all dissimilarities, <inline-formula id="IEq16"><alternatives><tex-math id="M43">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\sigma ^{2}_{\epsilon }$\end{document}</tex-math><mml:math id="M44"><mml:msubsup><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mi>ε</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="12859_2017_1790_Article_IEq16.gif"/></alternatives></inline-formula> is treated as a latent variable and is estimated together with all other parameters.</p>
      <p>The tuning parameter <italic>K</italic> should be set to a small number such that local differences in variances of <italic>d</italic>
<sub><italic>ij</italic></sub>’s and the data density can be captured. In this paper we used <italic>K</italic>=10 for all examples, and noticed that the estimates of <bold><italic>τ</italic></bold> are robust to different (reasonable) choices of <italic>K</italic>.</p>
    </sec>
    <sec id="Sec6">
      <title>Statistical Inference</title>
      <p>Our model is implemented using the STAN probabilistic language for statistical modeling [<xref ref-type="bibr" rid="CR12">12</xref>]. In particular we use the RStan R package [<xref ref-type="bibr" rid="CR13">13</xref>] which provides various inference algorithms. In this article we used Automatic Differentiation Variational Inference (ADVI) [<xref ref-type="bibr" rid="CR14">14</xref>]. ADVI is a “black-box” variational inference program, much faster than automatic inference approaches based on Markov Chain Monte Carlo (MCMC) algorithms. Even though the solutions to variational inference optimization problems are only approximations to the posterior, the algorithm is fast and effective for our applications.</p>
      <p>Our model requires a choice of a few hyperparameters <italic>γ</italic>
<sub><italic>τ</italic></sub>,<italic>γ</italic>
<sub><italic>b</italic></sub>,<italic>γ</italic>
<sub><italic>ρ</italic></sub> and <italic>γ</italic>
<sub><italic>ε</italic></sub>, which are scale parameters of the half-Cauchy distribution. The half-Cauchy distribution is recommended by Gelman et al. [<xref ref-type="bibr" rid="CR15">15</xref>, <xref ref-type="bibr" rid="CR16">16</xref>] as a weakly informative prior for scale parameters, and a default prior for routine applied use in regression models. It has a broad peak at zero and allows for occasional large coefficients while still performing a reasonable amount of shrinkage for coefficients near the central value [<xref ref-type="bibr" rid="CR16">16</xref>]. The scale hyperparameters were set at 2.5, as we do not expect very large deviations from the mean values. The value 2.5 is also recommended by Gelman in [<xref ref-type="bibr" rid="CR16">16</xref>], and is a default choice for positive scale parameters in many models described in the RStan software manual [<xref ref-type="bibr" rid="CR13">13</xref>].</p>
    </sec>
    <sec id="Sec7">
      <title>Visual representations of data ordering</title>
      <p>We developed visual tools for inferring and studying patterns related to the natural ordering in the data. Our visualizations uncover hidden trajectories with corresponding uncertainties. They also show how sampling density varies along a latent curve, i.e. how well a dataset covers different regions of an underlying gradient. We implemented a multi-view design with a set of visual components: 1) a plot of latent <bold><italic>τ</italic></bold> against its ranking, 2) a plot of <bold><italic>τ</italic></bold> against a sample covariate, 3) a heatmap of reordered data, 4) a 2D and a 3D posterior trajectory plot, 5) a data density plot, 7) a datapoint location confidence contour plot, 8) a feature curves plot. The settings panel and the visualization interface are depicted in Figs. <xref rid="Fig2" ref-type="fig">2</xref> and <xref rid="Fig3" ref-type="fig">3</xref>).
<fig id="Fig2"><label>Fig. 2</label><caption><p>The settings panel for BUDS visualization interface, where the data and the supplementary sample covariates can be uploaded, and specific features and samples as well as other parameters can be selected</p></caption><graphic xlink:href="12859_2017_1790_Fig2_HTML" id="MO2"/></fig>
<fig id="Fig3"><label>Fig. 3</label><caption><p>The visualization interface for latent data ordering. The plots are shown for the frog embryo gene expression dataset collected by Owens et al. [<xref ref-type="bibr" rid="CR27">27</xref>]. First row, left to right: a plot of <bold><italic>τ</italic></bold> against its ranking, a plot of <bold><italic>τ</italic></bold> against a sample covariate, a heatmap of reordered data. Second row, left to right: 2D posterior trajectory plot, data density plot, datapoint location condition confidence contour plot. Third row: 3D data trajectory plot and features curves plot</p></caption><graphic xlink:href="12859_2017_1790_Fig3_HTML" id="MO3"/></fig>
</p>
      <p>For our visualizations we chose a recently developed viridis color map, designed analytically to “perfectly perceptually-uniform” as well as color-blind friendly [<xref ref-type="bibr" rid="CR17">17</xref>]. This color palette is effective for heatmaps and other visualizations and has now been implemented as a default choice in many visualization packages such as plotly [<xref ref-type="bibr" rid="CR18">18</xref>] or heatmaply [<xref ref-type="bibr" rid="CR19">19</xref>].</p>
      <sec id="Sec8">
        <title>Latent ordering plot view</title>
        <p>The most direct way to explore the ordering in the data is through a scatter plot of <bold><italic>τ</italic></bold>-coordinates against their ranking (Fig. <xref rid="Fig4" ref-type="fig">4</xref>), which includes measures of uncertainty. This view depicts the arrangement of the datapoints along their hidden trajectory, and shows how confident we are in their estimated location along the path.
<fig id="Fig4"><label>Fig. 4</label><caption><p>Latent ordering in TARA Oceans dataset shown with uncertainties. The differences in the slope of plot (<bold>a</bold>) indicate varying data coverage along the underlying gradient. Correlation between the water depth and the latent ordering in microbial composition data is shown in (<bold>b</bold>). Coloring corresponds to log10 of the water depth (in meters) at which the ocean sample was collected</p></caption><graphic xlink:href="12859_2017_1790_Fig4_HTML" id="MO4"/></fig>
</p>
        <p>Despite its simple form, the plot provides useful information about the data. For example, the variability in the slope of the plot indicates how well covered the corresponding region of the trajectory is, i.e. if the slope is steep and the value of <bold><italic>τ</italic></bold> changes faster than its rank, then the data is sparse in that region.</p>
        <p>Color-coding can be also used to explore which sample attributes are associated with the natural ordering recovered, e.g. in the results section we show that samples ordering is associated with the water depth in TARA Oceans dataset, and with the age of the infant in the DIABIMMUNE dataset. One can also plot the estimates of <bold><italic>τ</italic></bold> against the ranking of a selected covariate to examine the correlation between the two more directly. If a high correlation is observed, one might further test whether the feature is indeed an important factor driving the main source of variability in the data. For example, when analyzing microbiome data one might discover environmental or clinical factors differentiating collected samples.</p>
      </sec>
      <sec id="Sec9">
        <title>Reordered heatmaps</title>
        <p>Heatmaps are frequently used to visualize data matrices, <italic>X</italic>. It is a common practice to perform hierarchical clustering on features and observations (rows and columns of <italic>X</italic>) to group similar objects together and allow hidden block patterns to emerge. However, clustering only suggests which rows and columns to bundle together; it does not provide information on how to order them within a group. Thus, it is not a straightforward matter how to arrange features and samples in a heatmap. Matrix reordering techniques, sometimes called seriation, are discussed in a comprehensive review by Innar Liiv [<xref ref-type="bibr" rid="CR20">20</xref>]. Many software programs are also available for generating heatmaps, among which NeatMap [<xref ref-type="bibr" rid="CR21">21</xref>] is a non-clustering one, designed to respect data topology, and intended for genomic data. Here we describe our own take on matrix reordering for heatmaps.</p>
        <p>As our method deals with situations which involve a continuous process rather than discrete classes, hierarchical clustering approach for organizing data matrices might be suboptimal. Instead, since our method estimates <bold><italic>τ</italic></bold>, which corresponds to a natural ordering of the samples, we can use it to arrange the columns of a heatmap. To reorder the rows of <italic>X</italic>, we use an inner product between features and <bold><italic>τ</italic></bold>. More specifically, we compute a vector, <inline-formula id="IEq17"><alternatives><tex-math id="M45">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\mathbf {z} \in \mathbb {R}^{p}$\end{document}</tex-math><mml:math id="M46"><mml:mi mathvariant="bold">z</mml:mi><mml:mo>∈</mml:mo><mml:msup><mml:mrow><mml:mi>ℝ</mml:mi></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msup></mml:math><inline-graphic xlink:href="12859_2017_1790_Article_IEq17.gif"/></alternatives></inline-formula>, whose elements are dot products equal to <inline-formula id="IEq18"><alternatives><tex-math id="M47">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$z_{k} = \tilde {\mathbf {x}}_{k}^{T} \boldsymbol {\tau }, \; k = 1, \dots, p$\end{document}</tex-math><mml:math id="M48"><mml:msub><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msubsup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold">x</mml:mi></mml:mrow><mml:mo>~</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msubsup><mml:mi mathvariant="bold-italic">τ</mml:mi><mml:mo>,</mml:mo><mml:mspace width="2.77626pt"/><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mi>p</mml:mi></mml:math><inline-graphic xlink:href="12859_2017_1790_Article_IEq18.gif"/></alternatives></inline-formula> where <inline-formula id="IEq19"><alternatives><tex-math id="M49">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\tilde {\mathbf {x}}_{k}^{T}$\end{document}</tex-math><mml:math id="M50"><mml:msubsup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold">x</mml:mi></mml:mrow><mml:mo>~</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="12859_2017_1790_Article_IEq19.gif"/></alternatives></inline-formula> is the <italic>k</italic>th row of <inline-formula id="IEq20"><alternatives><tex-math id="M51">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\tilde {X}$\end{document}</tex-math><mml:math id="M52"><mml:mover accent="true"><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mo>~</mml:mo></mml:mover></mml:math><inline-graphic xlink:href="12859_2017_1790_Article_IEq20.gif"/></alternatives></inline-formula>, a (column) normalized data matrix. The dot product is used for row-ordering as it reflects the mean <italic>τ</italic> value for the corresponding feature. In other words <italic>z</italic>
<sub><italic>k</italic></sub> indicates the mean location along the latent trajectory (expected <italic>τ</italic>) where feature <italic>k</italic> “resides”. Using this value for ordering seems natural, as the features with similar “ <italic>τ</italic>-utility” levels are placed close together. Figure <xref rid="Fig5" ref-type="fig">5</xref> shows example heatmaps produced by our procedure when applied to real microbial data.
<fig id="Fig5"><label>Fig. 5</label><caption><p>Reordered heatmaps for two microbial composition datasets</p></caption><graphic xlink:href="12859_2017_1790_Fig5_HTML" id="MO5"/></fig>
</p>
        <p>We include the comparison of our heatmaps with the ones generated by NeatMaps in Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figures S1 and S2. NeatMaps computes an ordering for rows and columns of an input data matrix, however it does not provide any uncertainty estimates. Moreover, the method is not optimized for cases where the data lies on a non-linear 1D manifold. BUDS heatmaps often display smooth data structures such as banded or triangular matrices. These, structures help users discover which groups of variables (genes, species or other features) have higher or lower values in which part of the underlying dominant gradient in the data.</p>
      </sec>
      <sec id="Sec10">
        <title>Feature dynamics</title>
        <p>The ordering of observations can also be used to explore the trends in variability of individual data features with respect to the discovered latent gradient. For example, when studying cell development processes, we might be interested in changes of expression of particular genes. The expression levels plotted against the pseudo-temporal ordering estimated with <bold><italic>τ</italic></bold> along with the corresponding smoothing curves, can provide insights into when specific genes are switched on and off (see Fig. <xref rid="Fig6" ref-type="fig">6</xref>
<xref rid="Fig6" ref-type="fig">a</xref>). Similarly, when analyzing microbiome data one can find out which species are more or less abundant at which regions of the underlying continuous gradient (see Fig. <xref rid="Fig6" ref-type="fig">6</xref>
<xref rid="Fig6" ref-type="fig">b</xref>). Both of the plots are discussed more in detail in the results section.
<fig id="Fig6"><label>Fig. 6</label><caption><p>Feature dynamics along inferred data trajectory. Frog embryo gene expression levels follow smooth trends over time (<bold>a</bold>). Selected bacteria are more abundant in TARA Oceans samples corresponding to the right end of the latent interval representing deeper ocean waters (<bold>b</bold>)</p></caption><graphic xlink:href="12859_2017_1790_Fig6_HTML" id="MO6"/></fig>
</p>
      </sec>
      <sec id="Sec11">
        <title>Trajectory plots</title>
        <p>Often it is also useful to visualize a data trajectory in 2 or 3D. We use dimensional reduction methods such as principal coordinate analysis (PCoA) and t-distributed stochastic neighbor embedding (t-SNE) [<xref ref-type="bibr" rid="CR22">22</xref>] on computed dissimilarities to display low-dimensional representations of the data. PCoA is a linear projection method, while t-SNE is a non-convex and non-linear technique.</p>
        <p>After plotting datapoints in the reduced two or three dimensional space, we superimpose the estimated trajectories, i.e. we add paths which connect observations according to the ordering specified by posterior samples of <bold><italic>τ</italic></bold>. We usually show 50 posterior trajectories (see blue lines in Fig. <xref rid="Fig7" ref-type="fig">7</xref>), and one highlighted trajectory that corresponds to the posterior mode- <bold><italic>τ</italic></bold> estimate. To avoid a crowded view, the mode-trajectory is shown as a path connecting only a subset of points evenly distributed along the gradient, i.e. corresponding to <italic>τ</italic>
<sub><italic>i</italic></sub>’s evenly spaced in [0,1]. We also include a 3D plot of the trajectory as the first two principal axes sometimes do not explain all the variability of interest. The third axis might provide additional information. The 3D plot provides an interactive view of the ‘mode-trajectory’; it allows the user to rotate the graph to obtain an optimal view of the estimated path. The rotation feature also facilitates generating 2D plots with any combination of two out of three principal components (0PC1, PC2, PC3), which is an efficient alternative to including three separate plots.
<fig id="Fig7"><label>Fig. 7</label><caption><p>Posterior trajectory plots for TARA Oceans dataset; 50 paths are plotted in blue to show uncertainties in the inferred ordering. “Mode”-trajectory is shown in black for a subset of highlighted (bigger) datapoints evenly spaced along the <italic>τ</italic>−interval (<bold>a</bold>). The same mode-trajectory is show in a 3D (<bold>b</bold>). The axis are labeled by the principal component index and the corresponding percent variance explained</p></caption><graphic xlink:href="12859_2017_1790_Fig7_HTML" id="MO7"/></fig>
</p>
      </sec>
      <sec id="Sec12">
        <title>Data density and uncertainty plots</title>
        <p>Since it might be also of interest to visualize data density along its trajectory, we also provide 2D plots with density clouds. We use posterior samples of <bold><italic>τ</italic></bold>
<sup>∗</sup> to obtain copies of latent distance matrices, <inline-formula id="IEq21"><alternatives><tex-math id="M53">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\Delta ^{*} = \left (\delta _{ij}^{*}\right)$\end{document}</tex-math><mml:math id="M54"><mml:msup><mml:mrow><mml:mi>Δ</mml:mi></mml:mrow><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msubsup><mml:mrow><mml:mi>δ</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ij</mml:mtext></mml:mrow><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:mfenced></mml:math><inline-graphic xlink:href="12859_2017_1790_Article_IEq21.gif"/></alternatives></inline-formula>. Then we generate copies of noisy dissimilarity matrices, <italic>D</italic>
<sup>∗</sup>, by drawing from a Gamma distribution centered at elements of <italic>Δ</italic>
<sup>∗</sup> according to our model. We combine posterior dissimilarity matrices in a data cube (<inline-formula id="IEq22"><alternatives><tex-math id="M55">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$T \in \mathbb {R}^{n \times n \times t}$\end{document}</tex-math><mml:math id="M56"><mml:mi>T</mml:mi><mml:mo>∈</mml:mo><mml:msup><mml:mrow><mml:mi>ℝ</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mo>×</mml:mo><mml:mi>n</mml:mi><mml:mo>×</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msup></mml:math><inline-graphic xlink:href="12859_2017_1790_Article_IEq22.gif"/></alternatives></inline-formula>) where <italic>t</italic> is the number of posterior samples, and then apply DiSTATIS, a three-way metric multidimensional scaling method, [<xref ref-type="bibr" rid="CR23">23</xref>] to obtain data projections together with their uncertainty and density estimates.</p>
        <p>Our visualization interface includes two plots displaying the data configuration computed with DiSTATIS. The first depicts the overall data density across the regions, and the second shows confidence contours for selected individual datapoints. Contour lines and color shading are commonly used for visualizing non-parametrically estimated multivariate-data density [<xref ref-type="bibr" rid="CR24">24</xref>, <xref ref-type="bibr" rid="CR25">25</xref>]. Contour lines, also called isolines, joint points of equal data density estimated from the frequency of the datapoints across the studied region. Apart from visualizing data density, we use isolines also to display our confidence in the estimated datapoints’ locations. BUDS can generate posterior draws of dissimilarity matrices which are used by DiSTATIS to obtain posterior samples of data coordinates in 2D. These coordinates are used for non-parametric estimation of the probability density function (pdf) of the true underlying position of an individual observation. Contour lines are then used delineate levels of the estimated pdf. These contours have a similar interpretation as the 1D error bars included in <italic>τ</italic>-scatter-plots and visualize the reliability of our estimates</p>
        <p>Figure <xref rid="Fig8" ref-type="fig">8</xref> (<xref rid="Fig8" ref-type="fig">a</xref>) shows density clouds for DiSTATIS projections and the consensus points representing the center of agreement between coordinates estimated from each posterior dissimilarity matrix <italic>D</italic>
<sup>∗</sup>. From the density plot one can read which regions of the trajectory are denser or sparser than the others. Figure <xref rid="Fig8" ref-type="fig">8</xref> (<xref rid="Fig8" ref-type="fig">b</xref>) gives an example of a contour plot for four selected datapoints using TARA Oceans dataset discussed in the results section. The size of the contours indicate the confidence we have in the location estimate, the large the area covered by the isolines, the less confident we are in the position of the observation.
<fig id="Fig8"><label>Fig. 8</label><caption><p>Overall data density plot (<bold>a</bold>) and confidence contours for location estimates of selected datapoints (<bold>b</bold>) for TARA Oceans dataset. Colored points denote DiSTATIS consensus coordinates, and gray ones the original data</p></caption><graphic xlink:href="12859_2017_1790_Fig8_HTML" id="MO8"/></fig>
</p>
        <p>Our visualization interface is implemented as a Shiny Application [<xref ref-type="bibr" rid="CR26">26</xref>] and 3D plots were rendered using the Plotly R library [<xref ref-type="bibr" rid="CR18">18</xref>].</p>
      </sec>
    </sec>
  </sec>
  <sec id="Sec13" sec-type="results">
    <title>Results</title>
    <p>We demonstrate the effectiveness of our modeling and visualization methods on four publicly available datasets. Bayesian Unidimensional Scaling is applied to uncover trajectories of samples in two microbial 16S, one gene expression and one roll call dataset.</p>
    <p>
      <bold>Frog embryo gene expression</bold>
    </p>
    <p>In this section we demonstrate BUDS performance on gene expression data from a study on transcript kinetics during embryonic development by Owens et al. [<xref ref-type="bibr" rid="CR27">27</xref>]. Transcript kinetics is the rate of change in transcript abundance with time. The dataset has been collected at a very high temporal resolution, and clearly displays the dynamics of gene expression levels, which makes it well suited for testing the effectiveness of our method in detecting and recovering continuous gradient effects.</p>
    <p>The authors of this study collected eggs of Xenopus tropicalis and obtained their gene expression profiles at 30-min intervals for the first 24 hrs after an in vitro fertilization, and then hourly sampling up to 66 hr (90 samples in total). The data was collected for two clutches; here we only analyze samples from Clutch A for which poly(A)+ RNA was sequenced. For our analysis, we used the published transcript per million (TPM) data, from which we remove the ERCC spike-ins and rescale accordingly. A log base 10 transformation (plus a pseudocount of one) is then applied to avoid heteroscedasticity related to high variability in noise levels among genes with different mean expression levels. This is a common practice for variance stabilization of RNA-seq data. As inputs to BUDS, we used Pearson correlation based dissimilarities defined in the methods section.</p>
    <p>As shown in Figs. <xref rid="Fig3" ref-type="fig">3</xref> and <xref rid="Fig9" ref-type="fig">9</xref>, BUDS accurately recovered the temporal ordering of the samples using only the dissimilarities computed on the log-expression data. We also observe that samples collected in the later half have more similar gene expression profiles, than the ones sequenced immediately post fertilization, as BUDS tend to place the samples sequenced 30 + h after fertilization (HPF) closer together on the latent interval, than the ones from the first 24h. In other words gene expressions undergo rapid changes in the early stages of the frog embryonic development, and slow down later on.
<fig id="Fig9"><label>Fig. 9</label><caption><p>Frog embryonic development trajectory. Correlation between inferred location on the latent trajectory and time in hours post fertilization (HPF). Latent coordinates computed using BUDS on untransformed Pearson correlation distances. (<bold>a</bold>) Frog embryo trajectory (<bold>b</bold>) Frog embryo trajectory, subsampled data</p></caption><graphic xlink:href="12859_2017_1790_Fig9_HTML" id="MO9"/></fig>
</p>
    <p>To show that our method is robust to differences in sampling density along data trajectory, we subsampled the dataset keeping only every fourth datapoint from the period between 10 and 40 HPF, and all samples from the remaining time periods. We observed that the samples’ ordering recovered stays consistent with the actual time (in terms of HPF). As desired, the 95%-HPDI are wider in sparser regions, i.e. samples 24hr+ after fertilization, as they were collected in 1hr intervals instead of 30-min. In particular, the downsampled region [10-40 HPF], involves estimates with clearly larger uncertainty bounds.</p>
    <p>Additionally, the visual interface was used to show the trends in expression levels of selected individual genes. Figure <xref rid="Fig6" ref-type="fig">6</xref> depicts how expression levels of five selected genes vary along the recovered data trajectory, which in this case corresponds to time post fertilization. We can see that the expression drops for three genes and increases for two others.</p>
    <p>
      <bold>TARA Oceans microbiome</bold>
    </p>
    <p>The second microbial dataset comes from a study by Sunagawa et al. [<xref ref-type="bibr" rid="CR28">28</xref>] conducted as a part of TARA Oceans expedition, whose aim was to characterize the structure of the global ocean microbiome; 139 samples were collected from 68 locations in epipelagic and mesopelagic waters across the globe. Illumina DNA shotgun metagenomic sequencing was performed on each prokaryote-enriched samples, and the taxonomic profiles were obtained from merged reads (miTAGs) that contained signatures of 16S rRNA gene, which were then mapped to the sequences in the SILVA reference database and clustered into 97% OTUs. The paper reported that the ocean microbiome composition and diversity was stratified according to the depth at which the samples were collected rather than the geographical location. Microbial composition was thus found to be ordered along a gradient associated with the water depth.</p>
    <p>BUDS was used to estimate a natural ordering of samples from Jaccard pairwise distances computed on bacterial composition data. Figure <xref rid="Fig4" ref-type="fig">4</xref> shows resulting <italic>τ</italic>-coordinates plots. We detected a high correlation of the latent coordinates with the depth of water at which a sample was collected (Spearman rank correlation <italic>ρ</italic>≈0.79). This result is consistent with the trends observed in the original study. In Fig. <xref rid="Fig4" ref-type="fig">4</xref> (<xref rid="Fig4" ref-type="fig">a</xref>), we can see that the samples were not collected evenly along their trajectory. Some intervals such as <italic>τ</italic>∈[0.75,1.0] and <italic>τ</italic>∈[0.2,0.45] have a much steeper slope than others indicating sparser sampling in the corresponding region. A similar conclusion can be reached by looking at the 2D density plot, Fig. <xref rid="Fig7" ref-type="fig">7</xref> (<xref rid="Fig7" ref-type="fig">a</xref>)), where certain parts of TARA Oceans data trajectory are much sparser than the rest. Identifying sparsities along the data trajectory might be of interest to researchers, who might like to determine whether the sparsity stems from the absolute rarity of certain type of samples or from the flaws of the data collection procedure which include physical restrictions (e.g. the ocean stations were located at specific depth). We observed that all 63 surface water layer samples had been recorded water depth of 5m, which suggests that either the depth measurements were not be very precise, or the study by design did not cover a variety (in terms of water depth) of surface samples. In Fig. <xref rid="Fig7" ref-type="fig">7</xref> (<xref rid="Fig7" ref-type="fig">b</xref>) the surface samples are all grouped in a single column on the left side; however the BUDS estimates of their location still suggests some biological variability within the group. Collecting more observations in sparse regions researchers can gain a more comprehensive understanding of the underlying process and potentially discover the cause of the rarity.</p>
    <p>
      <bold>Infant gut microbiome</bold>
    </p>
    <p>Under the DIABIMMUNE project, Kostic et al. [<xref ref-type="bibr" rid="CR29">29</xref>] studied the dynamics of the human gut microbiome in its early stage and the progression toward type 1 diabetes (T1D). Their cohort consisted of 33 infants from Finland and Estonia, genetically predisposed to T1D. Children were followed from birth until 3 years of age, and their stool samples were collected monthly by their parents. Amplicon sequencing was done on the V4 region of the 16S rDNA and taxonomic profiling performed with QIIME [<xref ref-type="bibr" rid="CR30">30</xref>]. Additionally, Kostic et al. performed functional analysis using shotgun metagenomic sequencing. Here we are only interested in the progression of the gut microbiome to ‘maturity’, and want to estimate its developmental trajectory. Similarly to the approach taken in section of the original paper discussing microbial community dynamics, we exclude T1D cases. To further reduce the biological variability related to factors other than time, we limit our analysis to the 14 infants in the control group from Finland, who are in the same T1D HLA risk group (HLA = 3, the biggest risk group), leaving 327 samples in total.</p>
    <p>We analyzed the bacterial composition dynamics using the published operational taxonomic unit (OTU) count table. We filtered OTU at prevalence level of 5 (present in ≥5 samples) and total count of 300 (sum in all samples ≥300), leaving 1341 OTUs. As we wanted to show change in the bacterial composition related to new bacterial species acquisition, we used as input Jaccard distances which use species presence/absence information.</p>
    <p>We showed that the gut microbiome follows a clear developmental gradient, and that the ordering of samples according to the posterior mode of <bold><italic>τ</italic></bold> is correlated with the infant’s age at time of collection (with Spearman rank correlation <italic>ρ</italic>≈0.74). Moreover, we observed that the location estimates were more variable for samples collected early after birth, see Fig. <xref rid="Fig10" ref-type="fig">10</xref>. For example, notice that the first 100 samples (corresponding to the earliest period after birth) take up the same space on the latent <bold><italic>τ</italic></bold> [0, 1]-interval as more than 200 remaining ones. This indicates that observations collected later in the study are more similar to each other than the ones gathered right after birth.
<fig id="Fig10"><label>Fig. 10</label><caption><p>Gut microbiome development trajectory. Latent 1D coordinates along the estimated BUDS trajectory shown with colored intervals indicating the 95% highest posterior density intervals (HPDI) (<bold>a</bold>), Jaccard dissimilarity between samples within each quarter after birth (<bold>b</bold>)</p></caption><graphic xlink:href="12859_2017_1790_Fig10_HTML" id="MO10"/></fig>
</p>
    <p>To confirm our hypothesis that the bacterial composition is more similar among samples collected later in the study than right after birth, we computed and compared the average Jaccard distance between each sample pairs collected in the same quarter (across all individuals). As shown in Fig. <xref rid="Fig10" ref-type="fig">10</xref>(), Jaccard dissimilarity displays a decreasing trend over time. Samples from the first few quarters just after birth are more variable than the ones collected closer to the end of the study. This agrees with our guess that bacterial composition seems to progress to a ‘mature’ gut microbiome state, and that while after birth the gut micro-flora might vary a lot across subjects, infants seem to acquire a shared ‘microbial base’ during the first three years.</p>
    <p>Additionally, looking at the reordered data heatmap, we see a triangular structure appearing. This suggests that while there are some bacteria, that are present in the gut microbiome from the beginning or appear early after birth, there are other which are acquire later in the infant’s life. This pattern is visible in Fig. <xref rid="Fig5" ref-type="fig">5</xref> (a) where the top rows show bacteria which are present almost in every samples, while the bottom rows represent taxa which appear in the infant gut in later stages corresponding to the right side of the heatmap.</p>
    <p>
      <bold>Roll Call Data</bold>
    </p>
    <p>So far we have presented only biological data examples. However, our method is general enough not to be limited to a specific type of data. To show this, we applied BUDS to voting data similar to Diaconis et al. in [<xref ref-type="bibr" rid="CR1">1</xref>]. We obtained the 114th U.S. Congress Roll Call data containing votes of 100 senators on a total of 502 bills within the period between January 3, 2015 and January 3, 2017. We computed a kernel <italic>L</italic>
<sub>1</sub> distance on the binary “yea” vs “nay” data, and applied BUDS to estimate the ordering of the senators related to their voting pattens.</p>
    <p>Figure <xref rid="Fig11" ref-type="fig">11</xref> shows the ordering obtained with our procedure. We see that without any knowledge of senators’ party membership and only using the binary voting data, BUDS was able to separate Democrats from Republicans on a left-right political spectrum. It is interesting that senator Bernie Sanders was ranked in this ordering as the most liberal one (the first on the left). This seems to be plausible, given his proposed policies during 2016 U.S. election campaign. Overall, the ordering computed by BUDS seems to reflect senators’ optimal “ideological utility” position, which is a rather abstract concept. The accuracy of our results could be evaluated further using outside information and domain knowledge.
<fig id="Fig11"><label>Fig. 11</label><caption><p>Ordering of 100 Senators based on 114th U.S. Congress Roll Call data</p></caption><graphic xlink:href="12859_2017_1790_Fig11_HTML" id="MO11"/></fig>
</p>
  </sec>
  <sec id="Sec14">
    <title>Discussion and Conclusions</title>
    <p>In biology, we often encounter situations where a gradual change or a progression between data points can be observed. The analysis of datasets originating from these processes requires different sets of tools than standard machine learning, and pattern recognition techniques such as simple clustering. Here we presented our new visualization interface developed specifically for exploring datasets which involve a latent continuum. We designed visual representations of the data which clearly illustrate the natural ordering of data points. While tools exist which support the tasks, existing approaches are not comprehensive, lack measures of uncertainty or involve unrealistic assumptions.</p>
    <p>Our novel modeling approach is based on a Bayesian framework, model observed inter-point dissimilarities with latent distances on a one-dimensional interval representing the underlying data trajectory. Thus, it is highly different from the current pseudotime inference methods which rely on an assumption that either the features or the low-dimensional representation components of the data come from a Gaussian process. We impose no such restrictions, and only require that the observed dissimilarities are noisy realizations of distances between latent coordinates in a one-dimensional space. This is a reasonable condition, as it is our objective to find an ordering of observations that respects the interactions observed in the original data.</p>
    <p>Using the estimated natural arrangement of observations, our program generates a set of plots that facilitate understanding of an underlying process that shapes the data. We include plots of the latent coordinates, reordered heatmaps, smooth curve plots showing dynamics of individual features (e.g. specific gene expression or species abundance) as well as 2 and 3D visualizations of the data which incorporate measures of uncertainty.</p>
    <p>We demonstrated the effectiveness of our visualizations on publicly available datasets. Our plots showed that the infant gut microbiome changes with time throughout the first three years after birth, which is consistent with the findings of the original study by Kostic et al. [<xref ref-type="bibr" rid="CR29">29</xref>]. Moreover, by inspecting the plot of the inferred latent coordinates against its ranking we found that the bacterial composition stabilizes, after rapid changes during the first year of life. The estimated coordinates represent a pseudo-temporal ordering, and provide a better ordering than the real time, as the gut bacterial flora develops at various rates within different infants. Similar trends were observed on the frog embryo development dataset from a study by Owens et al. [<xref ref-type="bibr" rid="CR27">27</xref>]. For TARA Oceans dataset published by Sunagawa et al. [<xref ref-type="bibr" rid="CR28">28</xref>] we showed that the collected samples do not cover the microbial composition gradient evenly. Some types of ocean samples were more sparsely represented than others. Our method was also successful at mapping senators on the left-right political spectrum based on 114th U.S. Congress voting data. BUDS has clearly separated Democrats from Republicans without any knowledge of the legislators’ party affiliations.</p>
    <p>In conclusion, we have developed a useful tool for analyzing datasets in which latent orderings occur. Our program is automatic and user friendly. Using our interactive visualization interface, researchers can generate illustrative plots which facilitate the process of data exploration and understanding.</p>
  </sec>
</body>
<back>
  <app-group>
    <app id="App1">
      <sec id="Sec15">
        <title>Additional file</title>
        <p>
          <media position="anchor" xlink:href="12859_2017_1790_MOESM1_ESM.pdf" id="MOESM1">
            <label>Additional file 1</label>
            <caption>
              <p>Supplementary figures showing comparison between heatmaps reordered with BUDS and NeatMaps. <bold>Figure S1.</bold> Comparison of BUDS and NeatMap for matrix ordering applied to three biological datasets. The heatmaps are shown for 500 randomly selected features (the same for BUDS and Neatmap). A default color scheme setting was for NeatMap heatmaps. BUDS ordering gives a much clearer visualization of the continuous patterns present in the data. <bold>Figure S2.</bold> Comparison of BUDS and NeatMap for matrix ordering applied to three biological datasets. The heatmaps are shown for 500 randomly selected features (the same for BUDS and Neatmap). A viridis color scheme setting was for NeatMap heatmaps. (PDF 321 kb)</p>
            </caption>
          </media>
        </p>
      </sec>
    </app>
  </app-group>
  <glossary>
    <title>Abbreviations</title>
    <def-list>
      <def-item>
        <term>BUDS</term>
        <def>
          <p>Bayesian Unidimensional Scaling, MDS: Multidimensional scaling, tSNE: t-distributed stochastic neighbor embedding, HPDI: Highest posterior density interval</p>
        </def>
      </def-item>
    </def-list>
  </glossary>
  <fn-group>
    <fn>
      <p>
        <bold>Electronic supplementary material</bold>
      </p>
      <p>The online version of this article (doi:10.1186/s12859-017-1790-x) contains supplementary material, which is available to authorized users.</p>
    </fn>
  </fn-group>
  <ack>
    <title>Acknowledgements</title>
    <p>Not applicable.</p>
    <sec id="d29e2992">
      <title>Funding</title>
      <p>Publication of this article was funded by NIH Transformative Research Grant number 1R01AI112401.</p>
    </sec>
    <sec id="d29e2997">
      <title>Availability of data and materials</title>
      <p><bold>BUDS Rstan package</bold> for fitting and drawing posteriors from the specified Bayesian model: <ext-link ext-link-type="uri" xlink:href="https://github.com/nlhuong/buds">https://github.com/nlhuong/buds</ext-link>.</p>
      <p><bold>visTrajectory Shiny App</bold> for generating associated visualizations: <ext-link ext-link-type="uri" xlink:href="https://github.com/nlhuong/visTrajectory">https://github.com/nlhuong/visTrajectory</ext-link>.</p>
      <p>Additionally, a web-based application, not requiring any installations, is available at <ext-link ext-link-type="uri" xlink:href="https://nlhuong.shinyapps.io/visTrajectory/">https://nlhuong.shinyapps.io/visTrajectory/</ext-link>.</p>
      <p><bold>Instructional demo video</bold> explaining BUDS’ interactive visualization interface: <ext-link ext-link-type="uri" xlink:href="https://github.com/nlhuong/visTrajectory/tree/master/video_demo">https://github.com/nlhuong/visTrajectory/tree/master/video_demo</ext-link>.</p>
    </sec>
    <sec id="d29e3037">
      <title>About this supplement</title>
      <p>This article has been published as part of BMC Bioinformatics Volume 18 Supplement 10, 2017: Proceedings of the Symposium on Biological Data Visualization (BioVis) at ISMB 2017. The full contents of the supplement are available online at <ext-link ext-link-type="uri" xlink:href="https://bmcbioinformatics.biomedcentral.com/articles/supplements/volume-18-supplement-10">https://bmcbioinformatics.biomedcentral.com/articles/supplements/volume-18-supplement-10</ext-link>. 2</p>
    </sec>
  </ack>
  <notes notes-type="author-contribution">
    <title>Authors’ contributions</title>
    <p>LHN designed, developed and implemented the method, as well as applied it to the data examples provided. SH gave the general idea of the problem, and provided theoretical and practical guidance. Both authors read and approved the final manuscript.</p>
  </notes>
  <notes notes-type="COI-statement">
    <sec id="d29e3053">
      <title>Ethics approval and consent to participate</title>
      <p>Not applicable.</p>
    </sec>
    <sec id="d29e3058">
      <title>Consent for publication</title>
      <p>Not applicable.</p>
    </sec>
    <sec id="d29e3063">
      <title>Competing interests</title>
      <p>The authors declare that they have no competing interests.</p>
    </sec>
  </notes>
  <ref-list id="Bib1">
    <title>References</title>
    <ref id="CR1">
      <label>1</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Diaconis</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Goel</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Holmes</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>Horseshoes in multidimensional scaling and local kernel methods</article-title>
        <source>Ann Appl Stat</source>
        <year>2008</year>
        <volume>2</volume>
        <issue>3</issue>
        <fpage>777</fpage>
        <lpage>807</lpage>
        <pub-id pub-id-type="doi">10.1214/08-AOAS165</pub-id>
      </element-citation>
    </ref>
    <ref id="CR2">
      <label>2</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Trapnell</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Cacchiarelli</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Grimsby</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Pokharel</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Morse</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Lennon</surname>
            <given-names>NJ</given-names>
          </name>
          <name>
            <surname>Livak</surname>
            <given-names>KJ</given-names>
          </name>
          <name>
            <surname>Mikkelsen</surname>
            <given-names>TS</given-names>
          </name>
          <name>
            <surname>Rinn</surname>
            <given-names>JL</given-names>
          </name>
        </person-group>
        <article-title>The dynamics and regulators of cell fate decisions are revealed by pseudotemporal ordering of single cells</article-title>
        <source>Nat Biotech</source>
        <year>2014</year>
        <volume>32</volume>
        <issue>4</issue>
        <fpage>381</fpage>
        <lpage>6</lpage>
        <pub-id pub-id-type="doi">10.1038/nbt.2859</pub-id>
      </element-citation>
    </ref>
    <ref id="CR3">
      <label>3</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ji</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Ji</surname>
            <given-names>H</given-names>
          </name>
        </person-group>
        <article-title>TSCAN: Pseudo-time reconstruction and evaluation in single-cell RNA-seq analysis</article-title>
        <source>Nucleic Acids Res</source>
        <year>2016</year>
        <volume>44</volume>
        <fpage>e117</fpage>
        <pub-id pub-id-type="doi">10.1093/nar/gkw430</pub-id>
        <?supplied-pmid 27179027?>
        <pub-id pub-id-type="pmid">27179027</pub-id>
      </element-citation>
    </ref>
    <ref id="CR4">
      <label>4</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Shin</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Berg</surname>
            <given-names>DA</given-names>
          </name>
          <name>
            <surname>Zhu</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Shin</surname>
            <given-names>JY</given-names>
          </name>
          <name>
            <surname>Song</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Bonaguidi</surname>
            <given-names>MA</given-names>
          </name>
          <name>
            <surname>Enikolopov</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Nauen</surname>
            <given-names>DW</given-names>
          </name>
          <name>
            <surname>Christian</surname>
            <given-names>KM</given-names>
          </name>
          <name>
            <surname>Ming</surname>
            <given-names>G-L</given-names>
          </name>
          <name>
            <surname>Song</surname>
            <given-names>H</given-names>
          </name>
        </person-group>
        <article-title>Single-Cell RNA-seq with waterfall reveals molecular cascades underlying adult neurogenesis</article-title>
        <source>Cell Stem Cell</source>
        <year>2015</year>
        <volume>17</volume>
        <issue>3</issue>
        <fpage>360</fpage>
        <lpage>72</lpage>
        <pub-id pub-id-type="doi">10.1016/j.stem.2015.07.013</pub-id>
        <?supplied-pmid 26299571?>
        <pub-id pub-id-type="pmid">26299571</pub-id>
      </element-citation>
    </ref>
    <ref id="CR5">
      <label>5</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Petropoulos</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Edsgard</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Reinius</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Deng</surname>
            <given-names>Q</given-names>
          </name>
          <name>
            <surname>Panula</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Codeluppi</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Reyes</surname>
            <given-names>AP</given-names>
          </name>
          <name>
            <surname>Linnarsson</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Sandberg</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Lanner</surname>
            <given-names>F</given-names>
          </name>
        </person-group>
        <article-title>Single-Cell RNA-Seq Reveals Lineage and X Chromosome Dynamics in Human Preimplantation Embryos</article-title>
        <source>Cell</source>
        <year>2016</year>
        <volume>165</volume>
        <issue>4</issue>
        <fpage>1012</fpage>
        <lpage>26</lpage>
        <pub-id pub-id-type="doi">10.1016/j.cell.2016.03.023</pub-id>
        <?supplied-pmid 27062923?>
        <pub-id pub-id-type="pmid">27062923</pub-id>
      </element-citation>
    </ref>
    <ref id="CR6">
      <label>6</label>
      <mixed-citation publication-type="other">Campbell K, Yau C. Bayesian Gaussian Process Latent Variable Models for pseudotime inference in single-cell RNA-seq data. bioRxiv. 2015. doi:<ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1101/026872">10.1101/026872</ext-link>. <ext-link ext-link-type="uri" xlink:href="http://www.biorxiv.org/content/early/2015/09/15/026872">http://www.biorxiv.org/content/early/2015/09/15/026872</ext-link>.</mixed-citation>
    </ref>
    <ref id="CR7">
      <label>7</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Campbell</surname>
            <given-names>KR</given-names>
          </name>
          <name>
            <surname>Yau</surname>
            <given-names>C</given-names>
          </name>
        </person-group>
        <article-title>Order Under Uncertainty: Robust Differential Expression Analysis Using Probabilistic Models for Pseudotime Inference</article-title>
        <source>PLOS Comput Biol</source>
        <year>2016</year>
        <volume>12</volume>
        <issue>11</issue>
        <fpage>1</fpage>
        <lpage>20</lpage>
        <pub-id pub-id-type="doi">10.1371/journal.pcbi.1005212</pub-id>
      </element-citation>
    </ref>
    <ref id="CR8">
      <label>8</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Reid</surname>
            <given-names>JE</given-names>
          </name>
          <name>
            <surname>Wernisch</surname>
            <given-names>L</given-names>
          </name>
        </person-group>
        <article-title>Pseudotime estimation: deconfounding single cell time series</article-title>
        <source>Bioinformatics</source>
        <year>2016</year>
        <volume>32</volume>
        <issue>19</issue>
        <fpage>2973</fpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btw372</pub-id>
        <?supplied-pmid 27318198?>
        <pub-id pub-id-type="pmid">27318198</pub-id>
      </element-citation>
    </ref>
    <ref id="CR9">
      <label>9</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Oh</surname>
            <given-names>MS</given-names>
          </name>
          <name>
            <surname>Raftery</surname>
            <given-names>AE</given-names>
          </name>
        </person-group>
        <article-title>Bayesian Multidimensional Scaling and Choice of Dimension</article-title>
        <source>J Am Stat Assoc</source>
        <year>2001</year>
        <volume>96</volume>
        <issue>455</issue>
        <fpage>1031</fpage>
        <lpage>44</lpage>
        <pub-id pub-id-type="doi">10.1198/016214501753208690</pub-id>
      </element-citation>
    </ref>
    <ref id="CR10">
      <label>10</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bakker</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Poole</surname>
            <given-names>KT</given-names>
          </name>
        </person-group>
        <article-title>Bayesian metric multidimensional scaling</article-title>
        <source>Polit Anal</source>
        <year>2013</year>
        <volume>21</volume>
        <issue>1</issue>
        <fpage>125</fpage>
        <pub-id pub-id-type="doi">10.1093/pan/mps039</pub-id>
      </element-citation>
    </ref>
    <ref id="CR11">
      <label>11</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Borg</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Groenen</surname>
            <given-names>PJF</given-names>
          </name>
        </person-group>
        <source>Modern Multidimensional Scaling: Theory and Applications</source>
        <year>1997</year>
        <publisher-loc>USA</publisher-loc>
        <publisher-name>Springer</publisher-name>
      </element-citation>
    </ref>
    <ref id="CR12">
      <label>12</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Carpenter</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Gelman</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Hoffman</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Lee</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Goodrich</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Betancourt</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Brubaker</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Guo</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Riddell</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>Stan: A Probabilistic Programming Language</article-title>
        <source>J Stat Softw</source>
        <year>2017</year>
        <volume>76</volume>
        <issue>1</issue>
        <fpage>1</fpage>
        <lpage>32</lpage>
        <pub-id pub-id-type="doi">10.18637/jss.v076.i01</pub-id>
      </element-citation>
    </ref>
    <ref id="CR13">
      <label>13</label>
      <mixed-citation publication-type="other">Stan Development Team. RStan: the R interface to Stan. R package version 2.14.1. 2016. <ext-link ext-link-type="uri" xlink:href="http://mc-stan.org/">http://mc-stan.org/</ext-link>. Accessed 25 July 2017.</mixed-citation>
    </ref>
    <ref id="CR14">
      <label>14</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Kucukelbir</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Ranganath</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Gelman</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Blei</surname>
            <given-names>DM</given-names>
          </name>
        </person-group>
        <article-title>Automatic Variational Inference in Stan</article-title>
        <source>Proceedings of the 28th International Conference on Neural Information Processing Systems. NIPS’15</source>
        <year>2015</year>
        <publisher-loc>Cambridge</publisher-loc>
        <publisher-name>MIT Press</publisher-name>
      </element-citation>
    </ref>
    <ref id="CR15">
      <label>15</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Gelman</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>Prior distributions for variance parameters in hierarchical models (comment on article by Browne and Draper)</article-title>
        <source>Bayesian Anal</source>
        <year>2006</year>
        <volume>1</volume>
        <issue>3</issue>
        <fpage>515</fpage>
        <lpage>34</lpage>
        <pub-id pub-id-type="doi">10.1214/06-BA117A</pub-id>
      </element-citation>
    </ref>
    <ref id="CR16">
      <label>16</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Gelman</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Jakulin</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Pittau</surname>
            <given-names>MG</given-names>
          </name>
          <name>
            <surname>Su</surname>
            <given-names>YS</given-names>
          </name>
        </person-group>
        <article-title>A weakly informative default prior distribution for logistic and other regression models</article-title>
        <source>Ann Appl Stat</source>
        <year>2008</year>
        <volume>2</volume>
        <issue>4</issue>
        <fpage>1360</fpage>
        <lpage>83</lpage>
        <pub-id pub-id-type="doi">10.1214/08-AOAS191</pub-id>
      </element-citation>
    </ref>
    <ref id="CR17">
      <label>17</label>
      <mixed-citation publication-type="other">Garnier S. viridis: Default Color Maps from ‘matplotlib’. 2016. R package version 0.3.4. <ext-link ext-link-type="uri" xlink:href="https://CRAN.R-project.org/package=viridis">https://CRAN.R-project.org/package=viridis</ext-link>. Accessed 25 July 2017.</mixed-citation>
    </ref>
    <ref id="CR18">
      <label>18</label>
      <mixed-citation publication-type="other">Sievert C, Parmer C, Hocking T, Chamberlain S, Ram K, Corvellec M, Despouy P. plotly: Create Interactive Web Graphics Via ‘plotly.js’. 2016. R package version 4.5.6. <ext-link ext-link-type="uri" xlink:href="https://CRAN.R-project.org/package=plotly">https://CRAN.R-project.org/package=plotly</ext-link>. Accessed 25 July 2017.</mixed-citation>
    </ref>
    <ref id="CR19">
      <label>19</label>
      <mixed-citation publication-type="other">Galili T. heatmaply: Interactive Cluster Heat Maps Using ‘plotly’. 2017. R package version 0.10.1. <ext-link ext-link-type="uri" xlink:href="https://CRAN.R-project.org/package=heatmaply">https://CRAN.R-project.org/package=heatmaply</ext-link>. Accessed 25 July 2017.</mixed-citation>
    </ref>
    <ref id="CR20">
      <label>20</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Liiv</surname>
            <given-names>I</given-names>
          </name>
        </person-group>
        <article-title>Seriation and matrix reordering methods: An historical overview</article-title>
        <source>Stat Anal Data Mining</source>
        <year>2010</year>
        <volume>3</volume>
        <issue>2</issue>
        <fpage>70</fpage>
        <lpage>91</lpage>
      </element-citation>
    </ref>
    <ref id="CR21">
      <label>21</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Rajaram</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Oono</surname>
            <given-names>Y</given-names>
          </name>
        </person-group>
        <article-title>NeatMap - non-clustering heat map alternatives in R</article-title>
        <source>BMC Bioinforma</source>
        <year>2010</year>
        <volume>11</volume>
        <issue>1</issue>
        <fpage>45</fpage>
        <pub-id pub-id-type="doi">10.1186/1471-2105-11-45</pub-id>
      </element-citation>
    </ref>
    <ref id="CR22">
      <label>22</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>van der Maaten</surname>
            <given-names>LJP</given-names>
          </name>
          <name>
            <surname>Hinton</surname>
            <given-names>GE</given-names>
          </name>
        </person-group>
        <article-title>Visualizing high-dimensional data using t-sne</article-title>
        <source>J Mach Learn Res</source>
        <year>2008</year>
        <volume>9</volume>
        <fpage>2579</fpage>
        <lpage>605</lpage>
      </element-citation>
    </ref>
    <ref id="CR23">
      <label>23</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Abdi</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Williams</surname>
            <given-names>LJ</given-names>
          </name>
          <name>
            <surname>Valentin</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Bennani-Dosse</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>STATIS and DISTATIS: optimum multitable principal component analysis and three way metric multidimensional scaling</article-title>
        <source>Wiley Interdiscip Rev Comput Stat</source>
        <year>2012</year>
        <volume>4</volume>
        <issue>2</issue>
        <fpage>124</fpage>
        <lpage>67</lpage>
        <pub-id pub-id-type="doi">10.1002/wics.198</pub-id>
      </element-citation>
    </ref>
    <ref id="CR24">
      <label>24</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Scott</surname>
            <given-names>DW</given-names>
          </name>
          <name>
            <surname>Sain</surname>
            <given-names>SR</given-names>
          </name>
        </person-group>
        <article-title>Multidimensional Density Estimation</article-title>
        <source>Handb Stat</source>
        <year>2005</year>
        <volume>24</volume>
        <fpage>229</fpage>
        <lpage>61</lpage>
        <pub-id pub-id-type="doi">10.1016/S0169-7161(04)24009-3</pub-id>
      </element-citation>
    </ref>
    <ref id="CR25">
      <label>25</label>
      <element-citation publication-type="book">
        <person-group person-group-type="editor">
          <name>
            <surname>Gentle</surname>
            <given-names>JE</given-names>
          </name>
          <name>
            <surname>Härdle</surname>
            <given-names>WK</given-names>
          </name>
          <name>
            <surname>Mori</surname>
            <given-names>Y</given-names>
          </name>
        </person-group>
        <source>Multivariate Density Estimation and Visualization</source>
        <year>2012</year>
        <publisher-loc>Berlin, Heidelberg</publisher-loc>
        <publisher-name>Springer</publisher-name>
      </element-citation>
    </ref>
    <ref id="CR26">
      <label>26</label>
      <mixed-citation publication-type="other">Chang W, Cheng J, Allaire J, Xie Y, McPherson J. shiny: Web Application Framework for R. 2017. R package version 1.0.3. <ext-link ext-link-type="uri" xlink:href="https://CRAN.R-project.org/package=shiny">https://CRAN.R-project.org/package=shiny</ext-link>. Accessed 25 July 2017.</mixed-citation>
    </ref>
    <ref id="CR27">
      <label>27</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Owens</surname>
            <given-names>NDL</given-names>
          </name>
          <name>
            <surname>Blitz</surname>
            <given-names>IL</given-names>
          </name>
          <name>
            <surname>Lane</surname>
            <given-names>MA</given-names>
          </name>
          <name>
            <surname>Patrushev</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Overton</surname>
            <given-names>JD</given-names>
          </name>
          <name>
            <surname>Gilchrist</surname>
            <given-names>MJ</given-names>
          </name>
          <name>
            <surname>Cho</surname>
            <given-names>KWY</given-names>
          </name>
          <name>
            <surname>Khokha</surname>
            <given-names>MK</given-names>
          </name>
        </person-group>
        <article-title>Measuring Absolute RNA Copy Numbers at High Temporal Resolution Reveals Transcriptome Kinetics in Development</article-title>
        <source>Cell Rep</source>
        <year>2016</year>
        <volume>14</volume>
        <issue>3</issue>
        <fpage>632</fpage>
        <lpage>47</lpage>
        <pub-id pub-id-type="doi">10.1016/j.celrep.2015.12.050</pub-id>
        <?supplied-pmid 26774488?>
        <pub-id pub-id-type="pmid">26774488</pub-id>
      </element-citation>
    </ref>
    <ref id="CR28">
      <label>28</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Sunagawa</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Coelho</surname>
            <given-names>LP</given-names>
          </name>
          <name>
            <surname>Chaffron</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Kultima</surname>
            <given-names>JR</given-names>
          </name>
          <name>
            <surname>Labadie</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Salazar</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Djahanschiri</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Zeller</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Mende</surname>
            <given-names>DR</given-names>
          </name>
          <name>
            <surname>Alberti</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Cornejo-Castillo</surname>
            <given-names>FM</given-names>
          </name>
          <name>
            <surname>Costea</surname>
            <given-names>PI</given-names>
          </name>
          <name>
            <surname>Cruaud</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>d’Ovidio</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Engelen</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Ferrera</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Gasol</surname>
            <given-names>JM</given-names>
          </name>
          <name>
            <surname>Guidi</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Hildebrand</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Kokoszka</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Lepoivre</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Lima-Mendez</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Poulain</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Poulos</surname>
            <given-names>BT</given-names>
          </name>
          <name>
            <surname>Royo-Llonch</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Sarmento</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Vieira-Silva</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Dimier</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Picheral</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Searson</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Kandels-Lewis</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Bowler</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>de Vargas</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Gorsky</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Grimsley</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Hingamp</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Iudicone</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Jaillon</surname>
            <given-names>O</given-names>
          </name>
          <name>
            <surname>Not</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Ogata</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Pesant</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Speich</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Stemmann</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Sullivan</surname>
            <given-names>MB</given-names>
          </name>
          <name>
            <surname>Weissenbach</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Wincker</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Karsenti</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Raes</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Acinas</surname>
            <given-names>SG</given-names>
          </name>
          <name>
            <surname>Bork</surname>
            <given-names>P</given-names>
          </name>
        </person-group>
        <article-title>Structure and function of the global ocean microbiome</article-title>
        <source>Science</source>
        <year>2015</year>
        <volume>348</volume>
        <issue>6237</issue>
        <fpage>1261359–1–1261359</fpage>
        <lpage>9</lpage>
        <pub-id pub-id-type="doi">10.1126/science.1261359</pub-id>
        <pub-id pub-id-type="pmid">25999513</pub-id>
      </element-citation>
    </ref>
    <ref id="CR29">
      <label>29</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kostic</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Gevers</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Siljander</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Vatanen</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Hyotylainen</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Hamalainen</surname>
            <given-names>AM</given-names>
          </name>
          <name>
            <surname>Peet</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Tillmann</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Poho</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Mattila</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Lahdesmaki</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Franzosa</surname>
            <given-names>EA</given-names>
          </name>
          <name>
            <surname>Vaarala</surname>
            <given-names>O</given-names>
          </name>
          <name>
            <surname>de Goffau</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Harmsen</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Ilonen</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Virtanen</surname>
            <given-names>SM</given-names>
          </name>
          <name>
            <surname>Clish</surname>
            <given-names>CB</given-names>
          </name>
          <name>
            <surname>Oresic</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Huttenhower</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Knip</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Xavier</surname>
            <given-names>RJ</given-names>
          </name>
        </person-group>
        <article-title>The Dynamics of the Human Infant Gut Microbiome in Development and in Progression toward Type 1 Diabetes</article-title>
        <source>Cell Host Microbe</source>
        <year>2016</year>
        <volume>17</volume>
        <issue>2</issue>
        <fpage>260</fpage>
        <lpage>73</lpage>
        <pub-id pub-id-type="doi">10.1016/j.chom.2015.01.001</pub-id>
      </element-citation>
    </ref>
    <ref id="CR30">
      <label>30</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Caporaso</surname>
            <given-names>JG</given-names>
          </name>
          <name>
            <surname>Kuczynski</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Stombaugh</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Bittinger</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Bushman</surname>
            <given-names>FD</given-names>
          </name>
          <name>
            <surname>Costello</surname>
            <given-names>EK</given-names>
          </name>
          <name>
            <surname>Fierer</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Pena</surname>
            <given-names>AG</given-names>
          </name>
          <name>
            <surname>Goodrich</surname>
            <given-names>JK</given-names>
          </name>
          <name>
            <surname>Gordon</surname>
            <given-names>JI</given-names>
          </name>
          <name>
            <surname>Huttley</surname>
            <given-names>GA</given-names>
          </name>
          <name>
            <surname>Kelley</surname>
            <given-names>ST</given-names>
          </name>
          <name>
            <surname>Knights</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Koenig</surname>
            <given-names>JE</given-names>
          </name>
          <name>
            <surname>Ley</surname>
            <given-names>RE</given-names>
          </name>
          <name>
            <surname>Lozupone</surname>
            <given-names>CA</given-names>
          </name>
          <name>
            <surname>McDonald</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Muegge</surname>
            <given-names>BD</given-names>
          </name>
          <name>
            <surname>Pirrung</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Reeder</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Sevinsky</surname>
            <given-names>JR</given-names>
          </name>
          <name>
            <surname>Turnbaugh</surname>
            <given-names>PJ</given-names>
          </name>
          <name>
            <surname>Walters</surname>
            <given-names>WA</given-names>
          </name>
          <name>
            <surname>Widmann</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Yatsunenko</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Zaneveld</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Knight</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>QIIME allows analysis of high-throughput community sequencing data</article-title>
        <source>Nat Meth</source>
        <year>2010</year>
        <volume>7</volume>
        <issue>5</issue>
        <fpage>335</fpage>
        <lpage>6</lpage>
        <pub-id pub-id-type="doi">10.1038/nmeth.f.303</pub-id>
      </element-citation>
    </ref>
  </ref-list>
</back>
