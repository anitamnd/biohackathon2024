<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName A++V2.4.dtd?>
<?SourceDTD.Version 2.4?>
<?ConverterInfo.XSLTName springer2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Genome Med</journal-id>
    <journal-id journal-id-type="iso-abbrev">Genome Med</journal-id>
    <journal-title-group>
      <journal-title>Genome Medicine</journal-title>
    </journal-title-group>
    <issn pub-type="epub">1756-994X</issn>
    <publisher>
      <publisher-name>BioMed Central</publisher-name>
      <publisher-loc>London</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">7988935</article-id>
    <article-id pub-id-type="publisher-id">842</article-id>
    <article-id pub-id-type="doi">10.1186/s13073-021-00842-w</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Research</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>CACTUS: integrating clonal architecture with genomic clustering and transcriptome profiling of single tumor cells</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author" equal-contrib="yes">
        <name>
          <surname>Shafighi</surname>
          <given-names>Shadi Darvish</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author" equal-contrib="yes">
        <name>
          <surname>Kiełbasa</surname>
          <given-names>Szymon M.</given-names>
        </name>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Sepúlveda-Yáñez</surname>
          <given-names>Julieta</given-names>
        </name>
        <address>
          <email>j.h.sepulveda_yanez@lumc.nl</email>
        </address>
        <xref ref-type="aff" rid="Aff3">3</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Monajemi</surname>
          <given-names>Ramin</given-names>
        </name>
        <address>
          <email>r.monajemi@lumc.nl</email>
        </address>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Cats</surname>
          <given-names>Davy</given-names>
        </name>
        <address>
          <email>d.cats@lumc.nl</email>
        </address>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Mei</surname>
          <given-names>Hailiang</given-names>
        </name>
        <address>
          <email>h.mei@lumc.nl</email>
        </address>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Menafra</surname>
          <given-names>Roberta</given-names>
        </name>
        <address>
          <email>r.menafra@lumc.nl</email>
        </address>
        <xref ref-type="aff" rid="Aff4">4</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Kloet</surname>
          <given-names>Susan</given-names>
        </name>
        <address>
          <email>s.kloet@lumc.nl</email>
        </address>
        <xref ref-type="aff" rid="Aff4">4</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Veelken</surname>
          <given-names>Hendrik</given-names>
        </name>
        <address>
          <email>j.h.veelken@lumc.nl</email>
        </address>
        <xref ref-type="aff" rid="Aff3">3</xref>
      </contrib>
      <contrib contrib-type="author" equal-contrib="yes">
        <name>
          <surname>van Bergen</surname>
          <given-names>Cornelis A.M.</given-names>
        </name>
        <xref ref-type="aff" rid="Aff3">3</xref>
      </contrib>
      <contrib contrib-type="author" corresp="yes" equal-contrib="yes">
        <name>
          <surname>Szczurek</surname>
          <given-names>Ewa</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <aff id="Aff1"><label>1</label><institution-wrap><institution-id institution-id-type="GRID">grid.12847.38</institution-id><institution-id institution-id-type="ISNI">0000 0004 1937 1290</institution-id><institution>Faculty of Mathematics, Informatics, and Mechanics, </institution><institution>University of Warsaw, </institution></institution-wrap>Stefana Banacha 2, Warsaw, 02-097 Poland </aff>
      <aff id="Aff2"><label>2</label><institution-wrap><institution-id institution-id-type="GRID">grid.10419.3d</institution-id><institution-id institution-id-type="ISNI">0000000089452978</institution-id><institution>Department of Biomedical Data Sciences, </institution><institution>Leiden University Medical Center, </institution></institution-wrap>Einthovenweg 20, Leiden, 2333 ZC The Netherlands </aff>
      <aff id="Aff3"><label>3</label><institution-wrap><institution-id institution-id-type="GRID">grid.10419.3d</institution-id><institution-id institution-id-type="ISNI">0000000089452978</institution-id><institution>Department of Hematology, </institution><institution>Leiden University Medical Center, </institution></institution-wrap>Albinusdreef 2, Leiden, 2333 ZA The Netherlands </aff>
      <aff id="Aff4"><label>4</label><institution-wrap><institution-id institution-id-type="GRID">grid.10419.3d</institution-id><institution-id institution-id-type="ISNI">0000000089452978</institution-id><institution>Leiden Genome Technology Center, </institution><institution>Leiden University Medical Center, </institution></institution-wrap>Einthovenweg 20, Leiden, 2333 ZC The Netherlands </aff>
    </contrib-group>
    <pub-date pub-type="epub">
      <day>24</day>
      <month>3</month>
      <year>2021</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>24</day>
      <month>3</month>
      <year>2021</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2021</year>
    </pub-date>
    <volume>13</volume>
    <elocation-id>45</elocation-id>
    <history>
      <date date-type="received">
        <day>15</day>
        <month>6</month>
        <year>2020</year>
      </date>
      <date date-type="accepted">
        <day>3</day>
        <month>2</month>
        <year>2021</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2021</copyright-statement>
      <license license-type="OpenAccess">
        <license-p><bold>Open Access</bold> This article is licensed under a Creative Commons Attribution 4.0 International License, which permits use, sharing, adaptation, distribution and reproduction in any medium or format, as long as you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons licence, and indicate if changes were made. The images or other third party material in this article are included in the article’s Creative Commons licence, unless indicated otherwise in a credit line to the material. If material is not included in the article’s Creative Commons licence and your intended use is not permitted by statutory regulation or exceeds the permitted use, you will need to obtain permission directly from the copyright holder. To view a copy of this licence, visit <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>. The Creative Commons Public Domain Dedication waiver (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/publicdomain/zero/1.0/">http://creativecommons.org/publicdomain/zero/1.0/</ext-link>) applies to the data made available in this article, unless otherwise stated in a credit line to the data.</license-p>
      </license>
    </permissions>
    <abstract id="Abs1">
      <sec>
        <title>Background</title>
        <p id="Par1">Drawing genotype-to-phenotype maps in tumors is of paramount importance for understanding tumor heterogeneity. Assignment of single cells to their tumor clones of origin can be approached by matching the genotypes of the clones to the mutations found in RNA sequencing of the cells. The confidence of the cell-to-clone mapping can be increased by accounting for additional measurements. Follicular lymphoma, a malignancy of mature B cells that continuously acquire mutations in parallel in the exome and in B cell receptor loci, presents a unique opportunity to join exome-derived mutations with B cell receptor sequences as independent sources of evidence for clonal evolution.</p>
      </sec>
      <sec>
        <title>Methods</title>
        <p id="Par2">Here, we propose CACTUS, a probabilistic model that leverages the information from an independent genomic clustering of cells and exploits the scarce single cell RNA sequencing data to map single cells to given imperfect genotypes of tumor clones.</p>
      </sec>
      <sec>
        <title>Results</title>
        <p id="Par3">We apply CACTUS to two follicular lymphoma patient samples, integrating three measurements: whole exome, single-cell RNA, and B cell receptor sequencing. CACTUS outperforms a predecessor model by confidently assigning cells and B cell receptor-based clusters to the tumor clones.</p>
      </sec>
      <sec>
        <title>Conclusions</title>
        <p id="Par4">The integration of independent measurements increases model certainty and is the key to improving model performance in the challenging task of charting the genotype-to-phenotype maps in tumors. CACTUS opens the avenue to study the functional implications of tumor heterogeneity, and origins of resistance to targeted therapies. CACTUS is written in R and source code, along with all supporting files, are available on GitHub (<ext-link ext-link-type="uri" xlink:href="https://github.com/LUMC/CACTUS">https://github.com/LUMC/CACTUS</ext-link>).</p>
      </sec>
      <sec>
        <title>Supplementary Information</title>
        <p>The online version contains supplementary material available at (10.1186/s13073-021-00842-w).</p>
      </sec>
    </abstract>
    <kwd-group xml:lang="en">
      <title>Keywords</title>
      <kwd>Single-cell sequencing</kwd>
      <kwd>Follicular lymphoma</kwd>
      <kwd>B cell receptor</kwd>
      <kwd>Clonal evolution</kwd>
      <kwd>Somatic mutations</kwd>
      <kwd>Probabilistic graphical model</kwd>
    </kwd-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/501100007601</institution-id>
            <institution>Horizon 2020</institution>
          </institution-wrap>
        </funding-source>
        <award-id>766030</award-id>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution>The Polish National Science Centre OPUS grant</institution>
        </funding-source>
        <award-id>2019/33/B/NZ2/00956</award-id>
      </award-group>
    </funding-group>
    <custom-meta-group>
      <custom-meta>
        <meta-name>issue-copyright-statement</meta-name>
        <meta-value>© The Author(s) 2021</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec id="Sec1">
    <title>Background</title>
    <p>Tumor heterogeneity and clonal evolution present a major challenge for cancer therapy [<xref ref-type="bibr" rid="CR1">1</xref>]. Tumor cells carry founder and subsequently acquired driver mutations that cause transformation of the healthy cell into an expanding population of malignant cells. Continuous acquisition of mutations creates populations of tumor cells with divergent mutational profiles. Diverging cells with acquired driver mutations result in preferential clonal expansion leading to intraclonal diversity. Given that distinct genotypes induce key phenotypic differences between the clones [<xref ref-type="bibr" rid="CR2">2</xref>], gene expression variation between the clones is expected. Measuring the phenotypes of tumor clones, however, is challenged by the difficulties in resolving the clonal genotype-to-phenotype maps in tumors [<xref ref-type="bibr" rid="CR3">3</xref>].</p>
    <p>Follicular lymphoma (FL) is a common type of malignant B cell lymphoma with characteristics of normal germinal center (GC) B cells. FL cells maintain the typical follicle-like structure of normal GC reactions in response to pathogens. FL pathogenesis is founded by the paradigmatic translocation (14;18)(q32;q21) that places BCL-2 under transcriptional control of the IGH@ locus enhancer. Secondary drivers affect genetic modifiers that enhance germinal center (GC) formation, reduce B cell differentiation, and freeze FL cells in the GC stage [<xref ref-type="bibr" rid="CR4">4</xref>, <xref ref-type="bibr" rid="CR5">5</xref>]. Despite commonly observed pathogenic genomic events, clinical behavior of FL is unpredictable and ranges from spontaneous remission over long-term stable disease to transformation to aggressive B cell lymphoma.</p>
    <p>In addition, FL cells are continuously exposed to a physiological mutator mechanism, i.e., expression and action of activation induced cytidine deamidase (AID) [<xref ref-type="bibr" rid="CR6">6</xref>]. AID focuses on B cell receptor (BCR) loci and results in highly mutated BCR heavy and light chain genes in FL [<xref ref-type="bibr" rid="CR7">7</xref>]. Whereas BCR mutations intrinsically may lead to a proliferative signal by acquisition of N-linked glycosylation [<xref ref-type="bibr" rid="CR8">8</xref>], preferential expansion of clones with identical BCR can also be explained by co-acquisition of underlying driver mutations that enhance their proliferation. In addition to grouping of individual cells into evolutionary clones by exome-wide mutations and structural variants, single FL cells can also be clustered based on the expression of identical BCR sequences. BCR mutations can therefore be considered events in clonal evolution in FL and present suitable markers that may allow a more accurate reconstruction of clonal evolution than based on exome mutations only.</p>
    <p>Elucidation of tumor evolution and reconstruction of the tumor clonal architecture are possible from bulk DNA sequencing [<xref ref-type="bibr" rid="CR9">9</xref>–<xref ref-type="bibr" rid="CR12">12</xref>] and from single-cell (sc) DNA sequencing data [<xref ref-type="bibr" rid="CR13">13</xref>–<xref ref-type="bibr" rid="CR16">16</xref>]. The outcome of such evolutionary analysis is a set of tumor clones, defined by their genotypes and frequencies. The genotype indicates which mutations are present in each clone, and the frequency indicates the fraction of cells from that clone in the entire tumor cell population. The task of identifying the tumor clones and their genotypes is computationally very difficult [<xref ref-type="bibr" rid="CR12">12</xref>], and thus, the tumor clone genotypes inferred from DNA sequencing alone are likely to be imperfect.</p>
    <p>Recent efforts into the direction of mapping genotypes to phenotypes in tumors include characterizing gene expression profiles of tumor clones based on matching the single-cell RNA sequencing (scRNA-seq) readouts to copy number variants in the clones [<xref ref-type="bibr" rid="CR17">17</xref>–<xref ref-type="bibr" rid="CR19">19</xref>]. Poirion et al. [<xref ref-type="bibr" rid="CR20">20</xref>] proposed a linear model detecting association of single nucleotide variants from scRNA-seq with gene expression. This approach, however, ignores the evolutionary history of the tumor, which can be resolved to determine the genotypes of the tumor clones. Such obtained genotypes can then be matched to mutations observable in scRNA-seq. Recently introduced cardelino [<xref ref-type="bibr" rid="CR21">21</xref>] is the first approach to successfully utilize the mutation mapping between the clone genotypes and the variants in scRNA-seq data. The performance of this approach, however, can be hampered by the fact that single-cell transcripts contain only information on 5 <sup>′</sup> part of the RNA and that the data are sparse. With such limited data, the confidence of assigning single cells to clones, and thus also of clonal genotype to gene expression phenotype mapping, is also limited. Here, we define the confidence as the concentration of the probability distribution of the cell-to-clone assignment, with high confidence corresponding to a high probability of assignment to one clone and low confidence corresponding to a uniform probability over clones. To increase the confidence, additional available evidence should be integrated into the inference. One such evidence is a given clustering of cells, such as the grouping of cells by their similar BCR sequences in FL evolution. Combining multiple data sources has the potential to increase the resolution of tumor heterogeneity analysis [<xref ref-type="bibr" rid="CR22">22</xref>], but is computationally challenging [<xref ref-type="bibr" rid="CR23">23</xref>] and calls for a dedicated probabilistic model.</p>
    <p>Here, we propose a probabilistic graphical model for integrating Clonal Architecture with genomic Clustering and Transcriptome profiling of single tUmor cellS (CACTUS). The model extends cardelino [<xref ref-type="bibr" rid="CR21">21</xref>] and maps single cells to their clones based on comparing the allele-specific transcript counts on mutated positions to given clonal genotypes, leveraging additional information about evolutionary cell clusters. As part of the model inference, CACTUS corrects the input clone genotypes and adjusts the input cell clustering using all available data. The input clusters should be defined based on additional evolutionary information, in such a way that the model can assume that cells in the same cluster tend also to belong to the same tumor clone.</p>
    <p>We apply CACTUS to newly generated whole-exome sequencing (WES), scRNA-seq, and single-cell BCR sequencing data of FL tumor samples from excised malignant lymph nodes of two subjects. As a result, the single cells are assigned to their clones of origin, accounting for the similarities of their BCR sequences (Fig. <xref rid="Fig1" ref-type="fig">1</xref>). We demonstrate that guided by the BCR sequence information, CACTUS assigns single cells to tumor clones in agreement with independent gene expression clustering. For both subjects, CACTUS maps cells and BCR clusters with substantially higher confidence than cardelino. These results indicate that the important challenge of tumor genotype-to-phenotype mapping can successfully be approached by probabilistic integration of multiple measurements.
<fig id="Fig1"><label>Fig. 1</label><caption><p>Overview of the patient data analysis and the CACTUS model. Whole-exome sequencing and single-cell sequencing of all transcripts, as well as single-cell sequencing of BCR, were performed on samples from two FL patients. Using WES, imperfect clonal evolution could be inferred and given as a prior to the model (C1, C2, …). From scRNA-seq, allele-specific transcript counts (mutated/total) were extracted at mutated positions (M1,M2, …). Input BCR clusters were defined as clusters of cells with identical BCR heavy chain sequences. The data of input tumor clones, mutation transcript counts, and given single-cell clusters (here, the BCR clusters) are combined in the CACTUS model for inference of the clonal assignment of the clusters. Both the input clone genotypes and clustering are considered potentially imperfect and are corrected during the inference using all available data. Image created with Biorender.com</p></caption><graphic xlink:href="13073_2021_842_Fig1_HTML" id="MO1"/></fig></p>
  </sec>
  <sec id="Sec2">
    <title>Methods</title>
    <sec id="Sec3">
      <title>Follicular Lymphoma sample preparation</title>
      <p>Samples with histologically confirmed infiltration of follicular lymphoma were collected with approval by the institutional review board of Leiden University Medical Center according to the Declaration of Helsinki and with written informed consent. Single-cell suspensions were obtained by gentle mechanical disruption and mesh filtration and were cryopreserved using 10% DMSO as cryoprotectant. The remaining tissue was cultured in low-glucose DMEM to obtain stromal cell cultures for isolation of DNA of non-malignant cells. Thawed single FL cells were purified by flow cytometry using fluorescently labeled antibodies specific for CD19 and CD10 and rested overnight followed by removal of dead cells using the MACS dead cell removal kit. Cells of different patients were pooled and loaded on a 10X Genomics chip to obtain single-cell cDNA libraries for an expected 1500 cells per patient. Following single-cell cDNA library generation and amplification, one fraction was directly sequenced for 5 <sup>′</sup> gene expression profiling. The second fraction was enriched for BCR transcripts by seminested amplification using 3 <sup>′</sup> constant domain primers for all BCR genes, partially digested and sequenced. Both single cell libraries were sequenced in paired-end mode on Illumina (2 × 150 bp).</p>
    </sec>
    <sec id="Sec4">
      <title>WES sequencing and mutation calling</title>
      <p>FL single cells were purified by flow cytometry as described above to obtain bulk purified FL cells for immediate isolation of DNA. Whole-exome sequencing (WES) was performed on paired FL and normal DNA at 200 × and 50 × coverage, respectively. Genomic DNA was isolated using the QIAamp DNA Mini kit (Qiagen). Samples were sequenced (HiSeq 4000 instrument, Illumina Inc.) in paired-end mode on Illumina (2×101 bp) using TrueSeq DNA exome kit (v.6) (Illumina Inc.). Paired-end reads were aligned to the human reference genome sequence GRCh38 using BWA–MEM (V0.715-r1140) [<xref ref-type="bibr" rid="CR24">24</xref>]. Deduplication and alignment metrics were performed using Picard tools (v2.12.1). Local realignment was performed around indels to improve SNP calling in these conflicting areas with the IndelRealigner tool. Recalibration to avoid biases was performed following the Genome Analysis Toolkit (GATK) Best Practices [<xref ref-type="bibr" rid="CR25">25</xref>]. Single mpileup files were generated from paired bam normal/tumor using samtools mpileup (v1.6). Mutation calling and computation of somatic <italic>p</italic> values (SPV) was performed on mpileup output files using Varscan (v2.3.9)[<xref ref-type="bibr" rid="CR26">26</xref>] to WES data from tumor and patient-matched normal samples with a minimum coverage of 10 ×. Quality control metrics were assessed using FastQC (v0.11.2)[<xref ref-type="bibr" rid="CR27">27</xref>] before and after the alignment workflow and reviewed to identify potential low-quality data files.</p>
    </sec>
    <sec id="Sec5">
      <title>Single-cell data processing</title>
      <p>Sequencing data was processed with 10X Genomics Cell Ranger v2.1.1 with respect to GRCh38-1.2.0 genome reference to obtain UMI-corrected transcript raw gene expression count tables, BAM files, and BCR all_contig.fasta files.</p>
      <p>To generate single-cell allelic transcript counts, we used a custom-made script to identify reads intersecting with WES-based mutated positions. For each read, to classify the allele, we identified the single nucleotide overlapping the mutated base. To obtain transcript counts, we used the unique molecular identifiers (UMIs) associated with the reads.</p>
      <p>We used the vireo function from cardelino package v0.4.2 to construct clusters of cells sharing the same germline genotype. As input, we provided allelic counts for the positions likely to differ between the subjects and not mutated between FL and stromal cells. For further processing, we selected cells assigned to a single subject at minimum probability threshold of 0.75. Once the clusters of cells sharing the same germline genotype were identified, we assigned them to patients by comparing the cluster consensus genotype with the patient-labeled genotypes obtained from WES.</p>
      <p>IMGT/HighV-Quest [<xref ref-type="bibr" rid="CR28">28</xref>] was used for high-throughput BCR analysis and annotation of the BCR all_contig.fasta file [<xref ref-type="bibr" rid="CR28">28</xref>]. IMGT/HighV-Quest output data was filtered for productive and rearranged sequences, and FL cells with identical BCR heavy chains were considered unique BCR clusters within the malignant cell population and were annotated with unique identifiers. R-package “vegan” was used to calculate Pielou’s index of evenness for BCR cluster size distribution.</p>
    </sec>
    <sec id="Sec6">
      <title>Phylogenetic analysis</title>
      <p>For each subject, we first identified common mutations that can be found in both WES data and scRNA-seq data. Next, we used FALCON-X with default parameters for estimation of allele-specific copy numbers from WES data. As a verification, we compared the results of FALCON-X with those of GATK CNV analysis pipeline, and confirmed that the two approaches gave similar results. Finally, we run Canopy [<xref ref-type="bibr" rid="CR9">9</xref>], providing the estimated major and minor copy number, as well as the allele-specific read counts in the tumor and matched normal WES data as input. Taking advantage of a Bayesian framework, Canopy estimates the clonal structure of the tumor for a pre-specified number of clones. Choosing between trees with the number of clones from 2 to 4, for both subjects, the BIC criterion used by Canopy suggested trees with 4 clones as the best solution. For further analysis, for each subject, we selected the top tree returned by Canopy (see Additional file <xref rid="MOESM1" ref-type="media">1</xref> for the posterior likelihood and BIC plots of Canopy for subjects S144 and S12118, respectively).</p>
    </sec>
    <sec id="Sec7">
      <title>Mapping BCR clusters to tumor clones using CACTUS</title>
      <p>Below, we introduce a probabilistic model, CACTUS, for mapping a given set of cell clusters to tumor clones based on the mutation matching between the cells in clusters and the clone genotypes (Fig. <xref rid="Fig2" ref-type="fig">2</xref>). In this analysis, the input clusters corresponded to sets of cells with identical BCR sequences. The input clustering and input clone genotypes were corrected during the inference process, taking into account all available data. Both CACTUS and cardelino are inferred using Gibbs sampling. For each subject, CACTUS was run for the top Canopy tree for a maximum of 20,000 iterations of the Gibbs sampler, with 10 different starting points. For the sake of comparison, cardelino was applied with the same setup.
<fig id="Fig2"><label>Fig. 2</label><caption><p>The graphical model representation of CACTUS. Circle nodes are labeled with random variables in the model. Arrows correspond to local conditional probability distributions of the child variables given the parent variables. Observed variables are shown as grayed nodes. Double-circled nodes are deterministically obtained from their parent variables. Small filled circles correspond to hyperparameters. <italic>C</italic><sub><italic>i</italic>,<italic>k</italic></sub> denotes the true (corrected) genotype of clone <italic>k</italic> at variant position <italic>i</italic>. <italic>Ω</italic><sub><italic>i</italic>,<italic>k</italic></sub> denotes the input clone genotypes, with <italic>Ω</italic><sub><italic>i</italic>,<italic>k</italic></sub>=1 if the mutation <italic>i</italic> is present in clone <italic>k</italic> and 0 otherwise. <italic>G</italic><sub><italic>j</italic>,<italic>q</italic></sub> denotes the distance of the cell <italic>j</italic> to cluster <italic>q</italic>, computed based on the input clustering of cells. <italic>T</italic><sub><italic>j</italic></sub>=<italic>q</italic> indicates that cell <italic>j</italic> is in cluster <italic>q</italic>. <italic>p</italic><sub><italic>j</italic>,<italic>q</italic></sub> is interpreted as the success probability for cell <italic>j</italic> to switch to cluster <italic>q</italic>. <italic>A</italic><sub><italic>i</italic>,<italic>j</italic></sub> denotes the observed count of unique transcripts with alternative (mutated) nucleotide mapped to position <italic>i</italic> in cell <italic>j</italic>. <italic>D</italic><sub><italic>i</italic>,<italic>j</italic></sub> denotes the total unique transcripts count mapped to that position in that cell. <italic>I</italic><sub><italic>q</italic></sub>=<italic>k</italic> represents the assignment of cluster <italic>q</italic> to clone <italic>k</italic>. <italic>θ</italic><sub><italic>i</italic></sub> denotes the success probability of observing a transcript with the alternative nucleotide at a position <italic>i</italic> in a cell that carries this mutation, and <italic>θ</italic><sub>0</sub> the success probability of observing a transcript with the alternative nucleotide in a position that is not present in the cell. <italic>ξ</italic> is the error rate for the genotypes. {<italic>ν</italic><sub>0</sub>,<italic>ν</italic><sub>1</sub>,<italic>κ</italic>} constitutes the set of hyperparameters in the model</p></caption><graphic xlink:href="13073_2021_842_Fig2_HTML" id="MO2"/></fig></p>
      <p>CACTUS is a direct extension of cardelino [<xref ref-type="bibr" rid="CR21">21</xref>], accounting for cell clustering, with the assumption that cells in the same cluster belong to the same clone. Let <italic>i</italic>∈{1,…,<italic>N</italic>} index mutation positions, which can be identified both in bulk DNA sequencing and single-cell RNA-seq data (see above). We assume we are given at input a set of <italic>K</italic> tumor clones, indexed by <italic>k</italic>∈{1,…,<italic>K</italic>}. Each tumor clone is represented by its genotype and prevalence in the tumor population. The input clone genotypes are represented by a binary matrix <italic>Ω</italic><sub><italic>i</italic>,<italic>k</italic></sub> with entries equal 1 if the mutation <italic>i</italic> is present in clone <italic>k</italic> and 0 otherwise.</p>
      <p>We are also given an independent clustering of single cells, where each cluster <italic>q</italic>∈{1,…<italic>Q</italic>} contains a number of cells and the clusters are assumed not to overlap. Let <italic>j</italic>∈{1,…,<italic>M</italic>} index cells. We assume that the input clustering is imperfect, and thus, we define the true (corrected) clustering by a set of hidden categorical variables <bold>T</bold>={<italic>T</italic><sub>1</sub>,…,<italic>T</italic><sub><italic>M</italic></sub>}, with each <italic>T</italic><sub><italic>j</italic></sub> taking values in {1,…,<italic>Q</italic>} and <italic>T</italic><sub><italic>j</italic></sub>=<italic>q</italic> indicating that cell <italic>j</italic> is in cluster <italic>q</italic>. We assume a categorical distribution for <italic>T</italic><sub><italic>j</italic></sub>: 
<disp-formula id="Equa"><alternatives><tex-math id="M1">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$P(T_{j} = q|p_{j,1},\ldots,p_{j,Q}) = p_{j,q}, $$ \end{document}</tex-math><mml:math id="M2"><mml:mrow><mml:mi>P</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>q</mml:mi><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>Q</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>q</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo></mml:mrow></mml:math><graphic xlink:href="13073_2021_842_Article_Equa.gif" position="anchor"/></alternatives></disp-formula></p>
      <p>where <inline-formula id="IEq1"><alternatives><tex-math id="M3">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\sum _{q} p_{j,q}=1$\end{document}</tex-math><mml:math id="M4"><mml:munder><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>q</mml:mi></mml:mrow></mml:munder><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>q</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:math><inline-graphic xlink:href="13073_2021_842_Article_IEq1.gif"/></alternatives></inline-formula>. The parameters of the categorical distribution <italic>p</italic><sub><italic>j</italic>,<italic>q</italic></sub> are interpreted as the success probabilities for cell <italic>j</italic> to switch to cluster <italic>q</italic>. We assume these success probabilities are dependent on the input clustering of cells. Denote <bold>p</bold> the matrix with elements <italic>p</italic><sub><italic>j</italic>,<italic>q</italic></sub>,<bold>p</bold>=(<italic>p</italic><sub><italic>j</italic>,<italic>q</italic></sub>)<sub><italic>j</italic>=1,…,<italic>M</italic>,<italic>q</italic>=1,…,<italic>Q</italic></sub>. Let <italic>G</italic><sub><italic>j</italic>,<italic>q</italic></sub> denote the distance of the cell <italic>j</italic> to cluster <italic>q</italic>, obtained from the input clustering. Based on <italic>G</italic><sub><italic>j</italic>,<italic>q</italic></sub>, the probability <italic>p</italic><sub><italic>j</italic>,<italic>q</italic></sub> is defined as: 
<disp-formula id="Equb"><alternatives><tex-math id="M5">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$p_{j,q} = \frac{e^{- cG_{j,q}}}{\sum_{q^{\prime}}{e^{- cG_{j,{q^{\prime}}}}}}, $$ \end{document}</tex-math><mml:math id="M6"><mml:mrow><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>q</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msup><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mi>c</mml:mi><mml:msub><mml:mrow><mml:mi>G</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>q</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:munder><mml:mrow><mml:mo mathsize="big">∑</mml:mo></mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:mi>q</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:munder><mml:msup><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mi>c</mml:mi><mml:msub><mml:mrow><mml:mi>G</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:msup><mml:mrow><mml:mi>q</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:msub></mml:mrow></mml:msup></mml:mrow></mml:mfrac><mml:mo>,</mml:mo></mml:mrow></mml:math><graphic xlink:href="13073_2021_842_Article_Equb.gif" position="anchor"/></alternatives></disp-formula> where <italic>c</italic> is a constant determining the strength of the prior. This parameter should be defined by the user. Here, we set <italic>c</italic>=2. In this application, the input clustering is defined as sets of cells with identical BCR sequences. Therefore, each input cluster is represented by the shared BCR sequence of its cells. Based on such input clustering, for each cell <italic>j</italic> and cluster <italic>q</italic>, the distance <italic>G</italic><sub><italic>j</italic>,<italic>q</italic></sub> is computed as the number of different mutations between BCR sequence of cell <italic>j</italic> and the representative BCR sequence of cluster <italic>q</italic>. Thus, the distance of <italic>q</italic> to its own cluster equals 0. For cells which did not have its BCR sequenced, we set their distance to their own cluster to 0, and their distance to all other clusters as equal to the mean of all known distances of cells to clusters.</p>
      <p>We are interested in assignment of the cell clusters to the clones. The clone assignment of each cluster <italic>q</italic> is represented in the model by a hidden variable <italic>I</italic><sub><italic>q</italic></sub> with values in {1,…,<italic>K</italic>}. We assume a uniform prior for <italic>I</italic><sub><italic>q</italic></sub> and set <inline-formula id="IEq2"><alternatives><tex-math id="M7">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$P(I_{q}=k) = \frac {1}{K}$\end{document}</tex-math><mml:math id="M8"><mml:mi>P</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>I</mml:mi></mml:mrow><mml:mrow><mml:mi>q</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>k</mml:mi><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>K</mml:mi></mml:mrow></mml:mfrac></mml:math><inline-graphic xlink:href="13073_2021_842_Article_IEq2.gif"/></alternatives></inline-formula>. Alternatively, the prior could depend on the prevalences derived from the evolutionary model. The probability of cluster-to-clone assignment returned by CACTUS is computed from the Gibbs sampling iterations, as the posterior probability distribution of <italic>I</italic><sub><italic>q</italic></sub>. The single cells are assigned to each clone with the same probability as their cluster. Thus, for each cluster <italic>q</italic> and each cell <italic>j</italic> in <italic>q</italic>, the assignment probability of <italic>j</italic> to clone <italic>k</italic> equals the probability of assignment of <italic>q</italic> to <italic>k</italic>.</p>
      <p>We assume that the input clone genotypes can contain errors with error rate <italic>ξ</italic>. The prior distribution for the error rate is parametrized by <italic>κ</italic>=(<italic>κ</italic><sub>0</sub>,<italic>κ</italic><sub>1</sub>) and is set to <italic>P</italic>(<italic>ξ</italic>|<italic>κ</italic>)=Beta(<italic>ξ</italic>;<italic>κ</italic><sub>0</sub>,<italic>κ</italic><sub>1</sub>). We define a hidden random variable <italic>C</italic><sub><italic>i</italic>,<italic>k</italic></sub> denoting the true (corrected) genotype of clone <italic>k</italic> at variant position <italic>i</italic>, with: 
<disp-formula id="Equc"><alternatives><tex-math id="M9">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$P(C_{i,k}=1|\Omega_{i,k},\xi) = \xi^{1-\Omega_{i,k}} \times (1-\xi)^{\Omega_{i,k}}.  $$ \end{document}</tex-math><mml:math id="M10"><mml:mrow><mml:mi>P</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>Ω</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>ξ</mml:mi><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mi>ξ</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi>Ω</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msup><mml:mo>×</mml:mo><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>ξ</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>Ω</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msup><mml:mi>.</mml:mi></mml:mrow></mml:math><graphic xlink:href="13073_2021_842_Article_Equc.gif" position="anchor"/></alternatives></disp-formula></p>
      <p>Let matrix <bold>A</bold> with elements <italic>A</italic><sub><italic>i</italic>,<italic>j</italic></sub> denote the observed count of unique transcripts with the alternative (mutated) nucleotide mapped to position <italic>i</italic> in cell <italic>j</italic>, and matrix <bold>D</bold> with elements <italic>D</italic><sub><italic>i</italic>,<italic>j</italic></sub> denote the total unique transcripts count mapped to that position in that cell. Let <italic>θ</italic><sub><italic>i</italic></sub> denote the success probability of observing a transcript with the alternative nucleotide at a position <italic>i</italic> in a cell that carries this mutation, and <italic>θ</italic><sub>0</sub> the success probability of observing a transcript with the alternative nucleotide in a cell that does not carry this mutation genotype of the cell. The distribution of the observed read counts then becomes: 
<disp-formula id="Equd"><alternatives><tex-math id="M11">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$\begin{aligned} P(A_{i,j}|D_{i,j},I_{q},C_{i,I_{q}},\theta, T_{j}=q) = \left\{ \begin{array}{ll} \texttt{Binom}(A_{i,j}|D_{i,j},\theta_{0}) &amp; \text{if}\ C_{i,I_{q}}=0 \\ \texttt{Binom}(A_{i,j}|D_{i,j},\theta_{i}) &amp; \text{if}\ C_{i,I_{q}}=1. \end{array} \right. \end{aligned}  $$ \end{document}</tex-math><mml:math id="M12"><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mi>P</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>D</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>I</mml:mi></mml:mrow><mml:mrow><mml:mi>q</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>I</mml:mi></mml:mrow><mml:mrow><mml:mi>q</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>θ</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>q</mml:mi><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:mfenced open="{"><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mtext mathvariant="monospace">Binom</mml:mtext><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>D</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>θ</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mtd><mml:mtd><mml:mtext>if</mml:mtext><mml:mspace width="1em"/><mml:msub><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>I</mml:mi></mml:mrow><mml:mrow><mml:mi>q</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mtext mathvariant="monospace">Binom</mml:mtext><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>D</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>θ</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mtd><mml:mtd><mml:mtext>if</mml:mtext><mml:mspace width="1em"/><mml:msub><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>I</mml:mi></mml:mrow><mml:mrow><mml:mi>q</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mi>.</mml:mi></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mfenced></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="13073_2021_842_Article_Equd.gif" position="anchor"/></alternatives></disp-formula></p>
      <p>We assume beta priors on the <italic>θ</italic> parameters: 
<disp-formula id="Eque"><alternatives><tex-math id="M13">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$\begin{array}{@{}rcl@{}} P(\theta_{i}|v_{1}) &amp;=&amp; \texttt{Beta}(\theta_{i}|\alpha_{1},\beta_{1})\\ P(\theta_{0}|v_{0}) &amp;=&amp; \texttt{Beta}(\theta_{0}|\alpha_{0},\beta_{0}),  \end{array} $$ \end{document}</tex-math><mml:math id="M14"><mml:mtable class="eqnarray" columnalign="left center right"><mml:mtr><mml:mtd class="eqnarray-1"><mml:mi>P</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>θ</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>v</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mtd><mml:mtd class="eqnarray-2"><mml:mo>=</mml:mo></mml:mtd><mml:mtd class="eqnarray-3"><mml:mtext mathvariant="monospace">Beta</mml:mtext><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>θ</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mtd><mml:mtd><mml:mtext/></mml:mtd></mml:mtr><mml:mtr><mml:mtd class="eqnarray-1"><mml:mi>P</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>θ</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>v</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mtd><mml:mtd class="eqnarray-2"><mml:mo>=</mml:mo></mml:mtd><mml:mtd class="eqnarray-3"><mml:mtext mathvariant="monospace">Beta</mml:mtext><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>θ</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>)</mml:mo><mml:mo>,</mml:mo></mml:mtd><mml:mtd><mml:mtext/></mml:mtd></mml:mtr></mml:mtable></mml:math><graphic xlink:href="13073_2021_842_Article_Eque.gif" position="anchor"/></alternatives></disp-formula></p>
      <p>where <italic>v</italic><sub>1</sub>=(<italic>α</italic><sub>1</sub>,<italic>β</italic><sub>1</sub>) and <italic>v</italic><sub>0</sub>=(<italic>α</italic><sub>0</sub>,<italic>β</italic><sub>0</sub>). We denote <italic>v</italic>=(<italic>v</italic><sub>0</sub>,<italic>v</italic><sub>1</sub>).</p>
      <p>Let <italic>A</italic><sub><italic>q</italic></sub> be the matrix of alternative allele counts for cells contained in cluster <italic>q</italic>, at mutated positions, i.e., <italic>A</italic><sub><italic>q</italic></sub>=(<italic>A</italic><sub><italic>i</italic>,<italic>j</italic></sub>)<sub><italic>j</italic>∈<italic>q</italic>,<italic>i</italic>=1,…,<italic>N</italic></sub>, and let <italic>D</italic><sub><italic>q</italic></sub>=(<italic>D</italic><sub><italic>i</italic>,<italic>j</italic></sub>)<sub><italic>j</italic>∈<italic>q</italic>,<italic>i</italic>=1,…,<italic>N</italic></sub>. Since we assume the observed read counts at the different positions and different cells are independent, we have: 
<disp-formula id="Equf"><alternatives><tex-math id="M15">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$\begin{array}{@{}rcl@{}} P(A_{q}|D_{q}, I_{q}, \mathbf{C}, \theta, \mathbf{T}) &amp;\,=\,&amp; \prod_{j \in q} \prod_{i=1}^{N} P(A_{i,j}|D_{i,j},I_{q}, C_{i,I_{q}},\theta, T_{j}\,=\,q).  \end{array} $$ \end{document}</tex-math><mml:math id="M16"><mml:mtable class="eqnarray" columnalign="left center right"><mml:mtr><mml:mtd class="eqnarray-1"><mml:mi>P</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mi>q</mml:mi></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>D</mml:mi></mml:mrow><mml:mrow><mml:mi>q</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>I</mml:mi></mml:mrow><mml:mrow><mml:mi>q</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi mathvariant="bold">C</mml:mi><mml:mo>,</mml:mo><mml:mi>θ</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold">T</mml:mi><mml:mo>)</mml:mo></mml:mtd><mml:mtd class="eqnarray-2"><mml:mspace width="0.3em"/><mml:mo>=</mml:mo><mml:mspace width="0.3em"/></mml:mtd><mml:mtd class="eqnarray-3"><mml:munder><mml:mrow><mml:mo>∏</mml:mo></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mo>∈</mml:mo><mml:mi>q</mml:mi></mml:mrow></mml:munder><mml:munderover><mml:mrow><mml:mo>∏</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:munderover><mml:mi>P</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>D</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>I</mml:mi></mml:mrow><mml:mrow><mml:mi>q</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>I</mml:mi></mml:mrow><mml:mrow><mml:mi>q</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>θ</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mspace width="0.3em"/><mml:mo>=</mml:mo><mml:mspace width="0.3em"/><mml:mi>q</mml:mi><mml:mo>)</mml:mo><mml:mi>.</mml:mi></mml:mtd><mml:mtd><mml:mtext/></mml:mtd></mml:mtr></mml:mtable></mml:math><graphic xlink:href="13073_2021_842_Article_Equf.gif" position="anchor"/></alternatives></disp-formula></p>
    </sec>
    <sec id="Sec8">
      <title>CACTUS model inference</title>
      <p>We use Gibbs sampler, a Markov chain Monte Carlo (MCMC) algorithm for generating samples from the posterior distribution. We iteratively sample each hidden variable which is conditionally independent given the rest of the hidden variables in the model. The hidden variables in CACTUS include the cluster assignment matrix <bold>I</bold>, the success probabilities of observing a transcript <bold>θ</bold>=(<italic>θ</italic><sub>0</sub>,<italic>θ</italic><sub>1</sub>,…,<italic>θ</italic><sub><italic>N</italic></sub>), the corrected clustering matrix <bold>T</bold>, the corrected genotype matrix <bold>C</bold>, and its error rate <italic>ξ</italic>. We describe the sampling steps for the full joint distribution of these hidden variables in the following.</p>
      <sec id="Sec9">
        <title>Sampling clone assignment of clusters <italic>I</italic><sub><italic>q</italic></sub></title>
        <p>We sample cluster-to-clone assignment variable <italic>I</italic><sub><italic>q</italic></sub>, given the Markov blanket of <italic>I</italic><sub><italic>q</italic></sub> in the graphical model (Fig. <xref rid="Fig2" ref-type="fig">2</xref>): 
<disp-formula id="Equ1"><label>1</label><alternatives><tex-math id="M17">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$ \begin{aligned} &amp;P(I_{q}=k|\mathbf{A},\mathbf{D},\mathbf{C},\mathbf{T},\mathbf{\theta})\propto P(I_{q}=k)P(A_{q}|D_{q},I_{q} = k, \mathbf{C},\theta,\mathbf{T})\\ &amp;\propto \prod_{j \in q}\prod_{i=1}^{N} \left\{\texttt{Binom}(A_{i,j}|D_{i,j},\theta_{i})^{C_{i,k}} \times \texttt{Binom}(A_{i,j}|D_{i,j},\theta_{0})^{(1-C_{i,k})} \right\}.  \end{aligned}  $$ \end{document}</tex-math><mml:math id="M18"><mml:mtable><mml:mtr><mml:mtd><mml:mi>P</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>I</mml:mi></mml:mrow><mml:mrow><mml:mi>q</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>k</mml:mi><mml:mo>|</mml:mo><mml:mi mathvariant="bold">A</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold">D</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold">C</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold">T</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold">θ</mml:mi><mml:mo>)</mml:mo><mml:mo>∝</mml:mo><mml:mi>P</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>I</mml:mi></mml:mrow><mml:mrow><mml:mi>q</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>k</mml:mi><mml:mo>)</mml:mo><mml:mi>P</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mi>q</mml:mi></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>D</mml:mi></mml:mrow><mml:mrow><mml:mi>q</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>I</mml:mi></mml:mrow><mml:mrow><mml:mi>q</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold">C</mml:mi><mml:mo>,</mml:mo><mml:mi>θ</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold">T</mml:mi><mml:mo>)</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mo>∝</mml:mo><mml:munder><mml:mrow><mml:mo>∏</mml:mo></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mo>∈</mml:mo><mml:mi>q</mml:mi></mml:mrow></mml:munder><mml:munderover><mml:mrow><mml:mo>∏</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:munderover><mml:mfenced close="}" open="{"><mml:mrow><mml:mtext mathvariant="monospace">Binom</mml:mtext><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>D</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>θ</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msup><mml:mo>×</mml:mo><mml:mtext mathvariant="monospace">Binom</mml:mtext><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>D</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>θ</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:mfenced><mml:mi>.</mml:mi></mml:mtd></mml:mtr></mml:mtable></mml:math><graphic xlink:href="13073_2021_842_Article_Equ1.gif" position="anchor"/></alternatives></disp-formula></p>
      </sec>
      <sec id="Sec10">
        <title>Sampling success probabilities of observing a transcript <bold>θ</bold></title>
        <p>Similarly, we sample <italic>θ</italic> from the posterior probability: 
<disp-formula id="Equg"><alternatives><tex-math id="M19">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$\begin{aligned} &amp;P(\theta|\mathbf{A},\mathbf{D},\mathbf{C},\mathbf{I},\mathbf{T},v) \propto P(\theta|v) \prod_{q =1}^{Q}\prod_{j \in q} \prod_{i=1}^{N} P(A_{i,j}|D_{i,j}, I_{q}, C_{i,I_{q}},\theta, T_{j} = q)\\ &amp;\propto \texttt{Beta}(\theta_{0}|\alpha_{0},\beta_{0}) \prod_{i=1}^{N} Beta(\theta_{i}|\alpha_{1},\beta_{1}) \end{aligned} $$ \end{document}</tex-math><mml:math id="M20"><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mi>P</mml:mi><mml:mo>(</mml:mo><mml:mi>θ</mml:mi><mml:mo>|</mml:mo><mml:mi mathvariant="bold">A</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold">D</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold">C</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold">I</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold">T</mml:mi><mml:mo>,</mml:mo><mml:mi>v</mml:mi><mml:mo>)</mml:mo><mml:mo>∝</mml:mo><mml:mi>P</mml:mi><mml:mo>(</mml:mo><mml:mi>θ</mml:mi><mml:mo>|</mml:mo><mml:mi>v</mml:mi><mml:mo>)</mml:mo><mml:munderover accent="false" accentunder="false"><mml:mrow><mml:mo mathsize="big">∏</mml:mo></mml:mrow><mml:mrow><mml:mi>q</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>Q</mml:mi></mml:mrow></mml:munderover><mml:munder><mml:mrow><mml:mo mathsize="big">∏</mml:mo></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mo>∈</mml:mo><mml:mi>q</mml:mi></mml:mrow></mml:munder><mml:munderover accent="false" accentunder="false"><mml:mrow><mml:mo mathsize="big">∏</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:munderover><mml:mi>P</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>D</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>I</mml:mi></mml:mrow><mml:mrow><mml:mi>q</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>I</mml:mi></mml:mrow><mml:mrow><mml:mi>q</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>θ</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>q</mml:mi><mml:mo>)</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mo>∝</mml:mo><mml:mtext mathvariant="monospace">Beta</mml:mtext><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>θ</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>)</mml:mo><mml:munderover accent="false" accentunder="false"><mml:mrow><mml:mo mathsize="big">∏</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:munderover><mml:mtext mathvariant="italic">Beta</mml:mtext><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>θ</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="13073_2021_842_Article_Equg.gif" position="anchor"/></alternatives></disp-formula><disp-formula id="Equ2"><label>2</label><alternatives><tex-math id="M21">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$ \begin{aligned} &amp;\times \prod_{q =1}^{Q}\prod_{j \in q} \prod_{i=1}^{N} \left\{\texttt{Binom}\left(A_{i,j}|D_{i,j},\theta_{i}\right)^{C_{i,I_{q}}} \texttt{Binom}\left(A_{i,j}|D_{i,j},\theta_{0}\right)^{1-C_{i,I_{q}}} \right\}\\ &amp;=\left\{\texttt{Beta}\left(\theta_{0}|\alpha_{0},\beta_{0}\right)\prod_{q =1}^{Q}\prod_{j \in q} \prod_{i=1}^{N}\texttt{Binom}\left(A_{i,j}|D_{i,j},\theta_{0}\right)^{\left(1-C_{i,I_{q}}\right)}\right\} \\ &amp;\times \left\{ \prod_{i=1}^{N} \texttt{Beta}\left(\theta_{i}|\alpha_{1},\beta_{1}\right) \prod_{q=1}^{Q}\prod_{j \in q} \texttt{Binom}\left(A_{i,j}|D_{i,j},\theta_{i}\right)^{C_{i,I_{q}}} \right\}.  \end{aligned}  $$ \end{document}</tex-math><mml:math id="M22"><mml:mtable><mml:mtr><mml:mtd><mml:mo>×</mml:mo><mml:munderover><mml:mrow><mml:mo>∏</mml:mo></mml:mrow><mml:mrow><mml:mi>q</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>Q</mml:mi></mml:mrow></mml:munderover><mml:munder><mml:mrow><mml:mo>∏</mml:mo></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mo>∈</mml:mo><mml:mi>q</mml:mi></mml:mrow></mml:munder><mml:munderover><mml:mrow><mml:mo>∏</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:munderover><mml:mfenced close="}" open="{"><mml:mrow><mml:mtext mathvariant="monospace">Binom</mml:mtext><mml:msup><mml:mrow><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>D</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>θ</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>I</mml:mi></mml:mrow><mml:mrow><mml:mi>q</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub></mml:mrow></mml:msup><mml:mtext mathvariant="monospace">Binom</mml:mtext><mml:msup><mml:mrow><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>D</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>θ</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>I</mml:mi></mml:mrow><mml:mrow><mml:mi>q</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub></mml:mrow></mml:msup></mml:mrow></mml:mfenced></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mo>=</mml:mo><mml:mfenced close="}" open="{"><mml:mrow><mml:mtext mathvariant="monospace">Beta</mml:mtext><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mrow><mml:mi>θ</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mfenced><mml:munderover><mml:mrow><mml:mo>∏</mml:mo></mml:mrow><mml:mrow><mml:mi>q</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>Q</mml:mi></mml:mrow></mml:munderover><mml:munder><mml:mrow><mml:mo>∏</mml:mo></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mo>∈</mml:mo><mml:mi>q</mml:mi></mml:mrow></mml:munder><mml:munderover><mml:mrow><mml:mo>∏</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:munderover><mml:mtext mathvariant="monospace">Binom</mml:mtext><mml:msup><mml:mrow><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>D</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>θ</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mfenced close=")" open="("><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>I</mml:mi></mml:mrow><mml:mrow><mml:mi>q</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:mrow></mml:msup></mml:mrow></mml:mfenced></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mo>×</mml:mo><mml:mfenced close="}" open="{"><mml:mrow><mml:munderover><mml:mrow><mml:mo>∏</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:munderover><mml:mtext mathvariant="monospace">Beta</mml:mtext><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mrow><mml:mi>θ</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mfenced><mml:munderover><mml:mrow><mml:mo>∏</mml:mo></mml:mrow><mml:mrow><mml:mi>q</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>Q</mml:mi></mml:mrow></mml:munderover><mml:munder><mml:mrow><mml:mo>∏</mml:mo></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mo>∈</mml:mo><mml:mi>q</mml:mi></mml:mrow></mml:munder><mml:mtext mathvariant="monospace">Binom</mml:mtext><mml:msup><mml:mrow><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>D</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>θ</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>I</mml:mi></mml:mrow><mml:mrow><mml:mi>q</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub></mml:mrow></mml:msup></mml:mrow></mml:mfenced><mml:mi>.</mml:mi></mml:mtd></mml:mtr></mml:mtable></mml:math><graphic xlink:href="13073_2021_842_Article_Equ2.gif" position="anchor"/></alternatives></disp-formula></p>
        <p>Using the beta-binomial conjugacy, <italic>θ</italic><sub>0</sub> and <italic>θ</italic><sub><italic>i</italic></sub>, for 0&lt;<italic>i</italic>&lt;<italic>N</italic> are sampled from the beta distribution: 
<disp-formula id="Equ3"><label>3</label><alternatives><tex-math id="M23">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$\begin{array}{@{}rcl@{}} &amp;&amp;\theta_{0}|\mathbf{A},\mathbf{C}, \mathbf{I}, \mathbf{T} \sim \texttt{Beta}(\alpha_{0}+u_{0},\beta_{0} + v_{0}),\\ &amp;&amp;\theta_{i}|\mathbf{A},\mathbf{C}, \mathbf{D}, \mathbf{I}, \mathbf{T} \sim \texttt{Beta}(\alpha_{1}+u_{i},\beta_{1} + v_{i}),  \end{array} $$ \end{document}</tex-math><mml:math id="M24"><mml:mtable class="eqnarray" columnalign="left center right"><mml:mtr><mml:mtd class="eqnarray-1"/><mml:mtd class="eqnarray-2"/><mml:mtd class="eqnarray-3"><mml:msub><mml:mrow><mml:mi>θ</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:mi mathvariant="bold">A</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold">C</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold">I</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold">T</mml:mi><mml:mo>∼</mml:mo><mml:mtext mathvariant="monospace">Beta</mml:mtext><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>u</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>v</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>)</mml:mo><mml:mo>,</mml:mo></mml:mtd><mml:mtd><mml:mtext/></mml:mtd></mml:mtr><mml:mtr><mml:mtd class="eqnarray-1"/><mml:mtd class="eqnarray-2"/><mml:mtd class="eqnarray-3"><mml:msub><mml:mrow><mml:mi>θ</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:mi mathvariant="bold">A</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold">C</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold">D</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold">I</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold">T</mml:mi><mml:mo>∼</mml:mo><mml:mtext mathvariant="monospace">Beta</mml:mtext><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>u</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>v</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo><mml:mo>,</mml:mo></mml:mtd><mml:mtd/></mml:mtr></mml:mtable></mml:math><graphic xlink:href="13073_2021_842_Article_Equ3.gif" position="anchor"/></alternatives></disp-formula></p>
        <p>where 
<disp-formula id="Equh"><alternatives><tex-math id="M25">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$\begin{aligned} &amp;u_{0} \!= \sum_{q=1}^{Q}\sum_{j \in q} \sum_{i=1}^{N} A_{i,j} (1\,-\,C_{i,I_{q}}), \quad v_{0} = \sum_{q=1}^{Q}\sum_{j \in q} \sum_{i=1}^{N} (D_{i,j}\,-\,A_{i,j})(1-C_{i,I_{q}}),\\ &amp;u_{i} = \sum_{q=1}^{Q}\sum_{j \in q} A_{i,j}C_{i,I_{q}}, \quad \quad \quad \quad v_{i} = \sum_{q=1}^{Q}\sum_{j \in q} (D_{i,j}-A_{i,j})C_{i,I_{q}}. \end{aligned} $$ \end{document}</tex-math><mml:math id="M26"><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:msub><mml:mrow><mml:mi>u</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mspace width="0.3em"/><mml:mo>=</mml:mo><mml:munderover accent="false" accentunder="false"><mml:mrow><mml:mo mathsize="big">∑</mml:mo></mml:mrow><mml:mrow><mml:mi>q</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>Q</mml:mi></mml:mrow></mml:munderover><mml:munder><mml:mrow><mml:mo mathsize="big">∑</mml:mo></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mo>∈</mml:mo><mml:mi>q</mml:mi></mml:mrow></mml:munder><mml:munderover accent="false" accentunder="false"><mml:mrow><mml:mo mathsize="big">∑</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:munderover><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mn>1</mml:mn><mml:mspace width="0.3em"/><mml:mo>−</mml:mo><mml:mspace width="0.3em"/><mml:msub><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>I</mml:mi></mml:mrow><mml:mrow><mml:mi>q</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo>)</mml:mo><mml:mo>,</mml:mo><mml:mspace width="1em"/><mml:msub><mml:mrow><mml:mi>v</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:munderover accent="false" accentunder="false"><mml:mrow><mml:mo mathsize="big">∑</mml:mo></mml:mrow><mml:mrow><mml:mi>q</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>Q</mml:mi></mml:mrow></mml:munderover><mml:munder><mml:mrow><mml:mo mathsize="big">∑</mml:mo></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mo>∈</mml:mo><mml:mi>q</mml:mi></mml:mrow></mml:munder><mml:munderover accent="false" accentunder="false"><mml:mrow><mml:mo mathsize="big">∑</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:munderover><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>D</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mspace width="0.3em"/><mml:mo>−</mml:mo><mml:mspace width="0.3em"/><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo><mml:mo>(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>I</mml:mi></mml:mrow><mml:mrow><mml:mi>q</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo>)</mml:mo><mml:mo>,</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msub><mml:mrow><mml:mi>u</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:munderover accent="false" accentunder="false"><mml:mrow><mml:mo mathsize="big">∑</mml:mo></mml:mrow><mml:mrow><mml:mi>q</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>Q</mml:mi></mml:mrow></mml:munderover><mml:munder><mml:mrow><mml:mo mathsize="big">∑</mml:mo></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mo>∈</mml:mo><mml:mi>q</mml:mi></mml:mrow></mml:munder><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>I</mml:mi></mml:mrow><mml:mrow><mml:mi>q</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mspace width="1em"/><mml:mspace width="1em"/><mml:mspace width="1em"/><mml:mspace width="1em"/><mml:msub><mml:mrow><mml:mi>v</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:munderover accent="false" accentunder="false"><mml:mrow><mml:mo mathsize="big">∑</mml:mo></mml:mrow><mml:mrow><mml:mi>q</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>Q</mml:mi></mml:mrow></mml:munderover><mml:munder><mml:mrow><mml:mo mathsize="big">∑</mml:mo></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mo>∈</mml:mo><mml:mi>q</mml:mi></mml:mrow></mml:munder><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>D</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo><mml:msub><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>I</mml:mi></mml:mrow><mml:mrow><mml:mi>q</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mi>.</mml:mi></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="13073_2021_842_Article_Equh.gif" position="anchor"/></alternatives></disp-formula></p>
      </sec>
      <sec id="Sec11">
        <title>Sampling the corrected clustering matrix <bold>T</bold></title>
        <p>The corrected sampling matrix <bold>T</bold> is sampled based on the Markov blanket of <bold>T</bold> in the graphical model (Fig. <xref rid="Fig2" ref-type="fig">2</xref>):</p>
        <p><disp-formula id="Equi"><alternatives><tex-math id="M27">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$\begin{aligned} P(T_{j}=\ &amp; q|\mathbf{p},\mathbf{A},\mathbf{C},\mathbf{D},\mathbf{I},\theta)\\ =&amp; \frac{P\left(T_{j}=q|p_{j,1},\ldots,p_{j,Q}\right)\prod_{i=1}^{N}P\left(A_{i,j}|D_{i,j}, I_{q}, C_{i,I_{q}}, \theta, T_{j}=q\right)}{\sum_{q^{\prime}=1}^{Q} \!P\!\left(T_{j}\,=\, q^{\prime}|p_{j,1},\ldots\!,p_{j,Q}\right)\! \prod_{i=1}^{N} {\!P\!\left(A_{i,j}|D_{i,j},I_{q},\!C_{i,I_{q^{\prime}}},\theta, T_{j} \,=\, q^{\prime}\!\right)}}, \end{aligned} $$ \end{document}</tex-math><mml:math id="M28"><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mi>P</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mspace width="1em"/></mml:mtd><mml:mtd><mml:mi>q</mml:mi><mml:mo>|</mml:mo><mml:mi mathvariant="bold">p</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold">A</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold">C</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold">D</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold">I</mml:mi><mml:mo>,</mml:mo><mml:mi>θ</mml:mi><mml:mo>)</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mo>=</mml:mo></mml:mtd><mml:mtd><mml:mfrac><mml:mrow><mml:mi>P</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>q</mml:mi><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>Q</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced><mml:munderover accent="false" accentunder="false"><mml:mrow><mml:mo mathsize="big">∏</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:munderover><mml:mi>P</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>D</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>I</mml:mi></mml:mrow><mml:mrow><mml:mi>q</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>I</mml:mi></mml:mrow><mml:mrow><mml:mi>q</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>θ</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>q</mml:mi></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:munderover accent="false" accentunder="false"><mml:mrow><mml:mo mathsize="big">∑</mml:mo></mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:mi>q</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>Q</mml:mi></mml:mrow></mml:munderover><mml:mspace width="0.3em"/><mml:mi>P</mml:mi><mml:mspace width="0.3em"/><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mspace width="0.3em"/><mml:mo>=</mml:mo><mml:mspace width="0.3em"/><mml:msup><mml:mrow><mml:mi>q</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mspace width="0.3em"/><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>Q</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced><mml:mspace width="0.3em"/><mml:munderover accent="false" accentunder="false"><mml:mrow><mml:mo mathsize="big">∏</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:munderover><mml:mspace width="0.3em"/><mml:mi>P</mml:mi><mml:mspace width="0.3em"/><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>D</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>I</mml:mi></mml:mrow><mml:mrow><mml:mi>q</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mspace width="0.3em"/><mml:msub><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>I</mml:mi></mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:mi>q</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>θ</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mspace width="0.3em"/><mml:mo>=</mml:mo><mml:mspace width="0.3em"/><mml:msup><mml:mrow><mml:mi>q</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup><mml:mspace width="0.3em"/></mml:mrow></mml:mfenced></mml:mrow></mml:mfrac><mml:mo>,</mml:mo></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="13073_2021_842_Article_Equi.gif" position="anchor"/></alternatives></disp-formula> where we assume the categorical prior over <italic>T</italic>: 
<disp-formula id="Equ4"><label>4</label><alternatives><tex-math id="M29">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$ \begin{aligned} P(T_{j}=&amp;q|\mathbf{p},\mathbf{A},\mathbf{D},\mathbf{C},\mathbf{I},\theta)\\ =&amp; \frac{ p_{j,q} \prod_{i=1}^{N} {P\left(A_{i,j}|D_{i,j},I_{q},C_{i,I_{q}},\theta, T_{j} = q\right)}} { \sum_{q^{\prime}=1}^{Q} p_{j,q^{\prime} }\prod_{i=1}^{N} {P\left(A_{i,j}|D_{i,j},I_{q},C_{i,I_{q^{\prime}}},\theta,T_{j} = q^{\prime} \right)}}.  \end{aligned}  $$ \end{document}</tex-math><mml:math id="M30"><mml:mtable><mml:mtr><mml:mtd><mml:mi>P</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo></mml:mtd><mml:mtd><mml:mi>q</mml:mi><mml:mo>|</mml:mo><mml:mi mathvariant="bold">p</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold">A</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold">D</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold">C</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold">I</mml:mi><mml:mo>,</mml:mo><mml:mi>θ</mml:mi><mml:mo>)</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mo>=</mml:mo></mml:mtd><mml:mtd><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>q</mml:mi></mml:mrow></mml:msub><mml:munderover><mml:mrow><mml:mo>∏</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:munderover><mml:mi>P</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>D</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>I</mml:mi></mml:mrow><mml:mrow><mml:mi>q</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>I</mml:mi></mml:mrow><mml:mrow><mml:mi>q</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>θ</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>q</mml:mi></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:munderover><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:mi>q</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>Q</mml:mi></mml:mrow></mml:munderover><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:msup><mml:mrow><mml:mi>q</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:msub><mml:munderover><mml:mrow><mml:mo>∏</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:munderover><mml:mi>P</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>D</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>I</mml:mi></mml:mrow><mml:mrow><mml:mi>q</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>I</mml:mi></mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:mi>q</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>θ</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mi>q</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:mfenced></mml:mrow></mml:mfrac><mml:mi>.</mml:mi></mml:mtd></mml:mtr></mml:mtable></mml:math><graphic xlink:href="13073_2021_842_Article_Equ4.gif" position="anchor"/></alternatives></disp-formula></p>
      </sec>
      <sec id="Sec12">
        <title>Sampling the corrected genotype matrix <bold>C</bold></title>
        <p>Similarly, the corrected genotype matrix <bold>C</bold> is sampled using the Markov blanket of <bold>C</bold> in the graphical model: 
<disp-formula id="Equ5"><label>5</label><alternatives><tex-math id="M31">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$ \begin{aligned} &amp;P(C_{i,k}=1|C_{-(i,k)},\mathbf{A},\mathbf{D},\theta,\mathbf{I},\xi,\Omega_{i,k},\mathbf{T}) =\\ &amp;\frac{ {|\Omega_{i,k}-\xi|}\prod\limits_{q=1}^{Q}\prod\limits_{j\in q} \texttt{Binom}(A_{i,j}|D_{i,j},\theta_{i})^{\mathbbm{1}_{(I_{q}=k)}}}{|\Omega_{i,k}\,-\,\xi|\!\prod\limits_{q=1}^{Q}\prod\limits_{j\in q} \!\texttt{Binom}(A_{i,j}|D_{i,j},\theta_{i})^{\mathbbm{1}_{(I_{q}=k)}} \!+ \!(1\,-\,|\Omega_{i,k\!}-\!\xi|)\prod\limits_{q=1}^{Q}\prod\limits_{j\in q} \texttt{\!Binom}(A_{i,j}|D_{i,j},\theta_{0})^{\mathbbm{1}_{(I_{q}=k)}}},\\  \end{aligned}  $$ \end{document}</tex-math><mml:math id="M32"><mml:mtable><mml:mtr><mml:mtd><mml:mi>P</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mo>(</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi mathvariant="bold">A</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold">D</mml:mi><mml:mo>,</mml:mo><mml:mi>θ</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold">I</mml:mi><mml:mo>,</mml:mo><mml:mi>ξ</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>Ω</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi mathvariant="bold">T</mml:mi><mml:mo>)</mml:mo><mml:mo>=</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mfrac><mml:mrow><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>Ω</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mi>ξ</mml:mi><mml:mo>|</mml:mo><mml:munderover accent="false" accentunder="false"><mml:mrow><mml:mo>∏</mml:mo></mml:mrow><mml:mrow><mml:mi>q</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>Q</mml:mi></mml:mrow></mml:munderover><mml:munder><mml:mrow><mml:mo>∏</mml:mo></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mo>∈</mml:mo><mml:mi>q</mml:mi></mml:mrow></mml:munder><mml:mtext mathvariant="monospace">Binom</mml:mtext><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>D</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>θ</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>1</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>I</mml:mi></mml:mrow><mml:mrow><mml:mi>q</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>k</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msub></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>Ω</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mspace width="0.3em"/><mml:mo>−</mml:mo><mml:mspace width="0.3em"/><mml:mi>ξ</mml:mi><mml:mo>|</mml:mo><mml:mspace width="0.3em"/><mml:munderover accent="false" accentunder="false"><mml:mrow><mml:mo>∏</mml:mo></mml:mrow><mml:mrow><mml:mi>q</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>Q</mml:mi></mml:mrow></mml:munderover><mml:munder><mml:mrow><mml:mo>∏</mml:mo></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mo>∈</mml:mo><mml:mi>q</mml:mi></mml:mrow></mml:munder><mml:mspace width="0.3em"/><mml:mtext mathvariant="monospace">Binom</mml:mtext><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>D</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>θ</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>1</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>I</mml:mi></mml:mrow><mml:mrow><mml:mi>q</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>k</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msub></mml:mrow></mml:msup><mml:mspace width="0.3em"/><mml:mo>+</mml:mo><mml:mspace width="0.3em"/><mml:mo>(</mml:mo><mml:mn>1</mml:mn><mml:mspace width="0.3em"/><mml:mo>−</mml:mo><mml:mspace width="0.3em"/><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>Ω</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mspace width="0.3em"/></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mspace width="0.3em"/><mml:mi>ξ</mml:mi><mml:mo>|</mml:mo><mml:mo>)</mml:mo><mml:munderover accent="false" accentunder="false"><mml:mrow><mml:mo>∏</mml:mo></mml:mrow><mml:mrow><mml:mi>q</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>Q</mml:mi></mml:mrow></mml:munderover><mml:munder><mml:mrow><mml:mo>∏</mml:mo></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mo>∈</mml:mo><mml:mi>q</mml:mi></mml:mrow></mml:munder><mml:mtext mathvariant="monospace">Binom</mml:mtext><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>D</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>θ</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>1</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>I</mml:mi></mml:mrow><mml:mrow><mml:mi>q</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>k</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msub></mml:mrow></mml:msup></mml:mrow></mml:mfrac><mml:mo>,</mml:mo></mml:mtd></mml:mtr><mml:mtr/></mml:mtable></mml:math><graphic xlink:href="13073_2021_842_Article_Equ5.gif" position="anchor"/></alternatives></disp-formula></p>
        <p>where 
<disp-formula id="Equj"><alternatives><tex-math id="M33">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$\begin{aligned} |\Omega_{i,k}&amp;-\xi|\prod\limits_{q=1}^{Q}\prod\limits_{j\in q} \texttt{Binom}(A_{i,j}|D_{i,j},\theta_{i})^{\mathbbm{1}_{(I_{q}=k)}}\\ =&amp; P(C_{i,k}=1|\Omega_{i,k},\xi)\prod\limits_{q=1}^{Q}\prod\limits_{j\in q} P(A_{i,j}|D_{i,j},I_{q},C_{i,I_{q}}=1,\theta, T_{j} = q) \end{aligned} $$ \end{document}</tex-math><mml:math id="M34"><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>Ω</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mtd><mml:mtd><mml:mo>−</mml:mo><mml:mi>ξ</mml:mi><mml:mo>|</mml:mo><mml:munderover accent="false" accentunder="false"><mml:mrow><mml:mo mathsize="big">∏</mml:mo></mml:mrow><mml:mrow><mml:mi>q</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>Q</mml:mi></mml:mrow></mml:munderover><mml:munder><mml:mrow><mml:mo mathsize="big">∏</mml:mo></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mo>∈</mml:mo><mml:mi>q</mml:mi></mml:mrow></mml:munder><mml:mtext mathvariant="monospace">Binom</mml:mtext><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>D</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>θ</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>1</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>I</mml:mi></mml:mrow><mml:mrow><mml:mi>q</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>k</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msub></mml:mrow></mml:msup></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mo>=</mml:mo></mml:mtd><mml:mtd><mml:mi>P</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>Ω</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>ξ</mml:mi><mml:mo>)</mml:mo><mml:munderover accent="false" accentunder="false"><mml:mrow><mml:mo mathsize="big">∏</mml:mo></mml:mrow><mml:mrow><mml:mi>q</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>Q</mml:mi></mml:mrow></mml:munderover><mml:munder><mml:mrow><mml:mo mathsize="big">∏</mml:mo></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mo>∈</mml:mo><mml:mi>q</mml:mi></mml:mrow></mml:munder><mml:mi>P</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>D</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>I</mml:mi></mml:mrow><mml:mrow><mml:mi>q</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>I</mml:mi></mml:mrow><mml:mrow><mml:mi>q</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>θ</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>q</mml:mi><mml:mo>)</mml:mo></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="13073_2021_842_Article_Equj.gif" position="anchor"/></alternatives></disp-formula> and 
<disp-formula id="Equk"><alternatives><tex-math id="M35">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$\begin{aligned} (1&amp;-|\Omega_{i,k}-\xi|)\prod\limits_{q=1}^{Q}\prod\limits_{j\in q} \texttt{Binom}(A_{i,j}|D_{i,j},\theta_{0})^{\mathbbm{1}_{(I_{q}=k)}} \\=&amp; P(C_{i,k}=0|\Omega_{i,k},\xi)\prod\limits_{q=1}^{Q}\prod\limits_{j\in q} P(A_{i,j}|D_{i,j},I_{q},C_{i,I_{q}}=0,\theta, T_{j} = q). \end{aligned} $$ \end{document}</tex-math><mml:math id="M36"><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mo>(</mml:mo><mml:mn>1</mml:mn></mml:mtd><mml:mtd><mml:mo>−</mml:mo><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>Ω</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mi>ξ</mml:mi><mml:mo>|</mml:mo><mml:mo>)</mml:mo><mml:munderover accent="false" accentunder="false"><mml:mrow><mml:mo mathsize="big">∏</mml:mo></mml:mrow><mml:mrow><mml:mi>q</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>Q</mml:mi></mml:mrow></mml:munderover><mml:munder><mml:mrow><mml:mo mathsize="big">∏</mml:mo></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mo>∈</mml:mo><mml:mi>q</mml:mi></mml:mrow></mml:munder><mml:mtext mathvariant="monospace">Binom</mml:mtext><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>D</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>θ</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>1</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>I</mml:mi></mml:mrow><mml:mrow><mml:mi>q</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>k</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msub></mml:mrow></mml:msup></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mo>=</mml:mo></mml:mtd><mml:mtd><mml:mi>P</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>Ω</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>ξ</mml:mi><mml:mo>)</mml:mo><mml:munderover accent="false" accentunder="false"><mml:mrow><mml:mo mathsize="big">∏</mml:mo></mml:mrow><mml:mrow><mml:mi>q</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>Q</mml:mi></mml:mrow></mml:munderover><mml:munder><mml:mrow><mml:mo mathsize="big">∏</mml:mo></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mo>∈</mml:mo><mml:mi>q</mml:mi></mml:mrow></mml:munder><mml:mi>P</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>D</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>I</mml:mi></mml:mrow><mml:mrow><mml:mi>q</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>I</mml:mi></mml:mrow><mml:mrow><mml:mi>q</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi>θ</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>q</mml:mi><mml:mo>)</mml:mo><mml:mi>.</mml:mi></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="13073_2021_842_Article_Equk.gif" position="anchor"/></alternatives></disp-formula></p>
        <p>Here, we assume Bernoulli distribution over <bold>C</bold><sub><italic>i</italic>,<italic>k</italic></sub>: 
<disp-formula id="Equl"><alternatives><tex-math id="M37">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$P(C_{i,k}=1|\Omega_{i,k},\xi) = \xi^{1-\Omega_{i,k}} \times (1-\xi)^{\Omega_{i,k}}$$ \end{document}</tex-math><mml:math id="M38"><mml:mrow><mml:mi>P</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>Ω</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>ξ</mml:mi><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mi>ξ</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi>Ω</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msup><mml:mo>×</mml:mo><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>ξ</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>Ω</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msup></mml:mrow></mml:math><graphic xlink:href="13073_2021_842_Article_Equl.gif" position="anchor"/></alternatives></disp-formula> Indeed, we have <italic>P</italic>(<italic>C</italic><sub><italic>i</italic>,<italic>k</italic></sub>=1|<italic>Ω</italic><sub><italic>i</italic>,<italic>k</italic></sub>=1,<italic>ξ</italic>)=1−<italic>ξ</italic> and <italic>P</italic>(<italic>C</italic><sub><italic>i</italic>,<italic>k</italic></sub>=1|<italic>Ω</italic><sub><italic>i</italic>,<italic>k</italic></sub>=0,<italic>ξ</italic>)=<italic>ξ</italic>. Thus, we can shortly write <italic>P</italic>(<italic>C</italic><sub><italic>i</italic>,<italic>k</italic></sub>=1|<italic>Ω</italic><sub><italic>i</italic>,<italic>k</italic></sub>,<italic>ξ</italic>)=|<italic>Ω</italic><sub><italic>i</italic>,<italic>k</italic></sub>−<italic>ξ</italic>|. Similarly, for <italic>C</italic><sub><italic>i</italic>,<italic>k</italic></sub>=0, we can write <italic>P</italic>(<italic>C</italic><sub><italic>i</italic>,<italic>k</italic></sub>=0|<italic>Ω</italic><sub><italic>i</italic>,<italic>k</italic></sub>,<italic>ξ</italic>)=1−|<italic>Ω</italic><sub><italic>i</italic>,<italic>k</italic></sub>−<italic>ξ</italic>|.</p>
      </sec>
      <sec id="Sec13">
        <title>Sampling the error rate <italic>ξ</italic></title>
        <p>We can compute the distribution of the error rate <italic>ξ</italic> having the corrected genotype matrix <italic>C</italic>, as well as the input clone genotype matrix <italic>Ω</italic> and hyperparameters <italic>κ</italic> as follows: 
<disp-formula id="Equm"><alternatives><tex-math id="M39">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$\begin{array}{@{}rcl@{}} P(\xi|C,\Omega,\kappa) = P(\xi | \kappa)\prod_{i}^{N}\prod_{k}^{K} P(C_{i,k}=1|\Omega_{i,k},\xi)\\ = \texttt{Beta}(\xi;\kappa_{0},\kappa_{1}) \times \xi^{1-\Omega_{i,k}} (1-\xi)^{\Omega_{i,k}}. \end{array} $$ \end{document}</tex-math><mml:math id="M40"><mml:mtable class="eqnarray" columnalign="left center right"><mml:mtr><mml:mtd class="eqnarray-1"><mml:mi>P</mml:mi><mml:mo>(</mml:mo><mml:mi>ξ</mml:mi><mml:mo>|</mml:mo><mml:mi>C</mml:mi><mml:mo>,</mml:mo><mml:mi>Ω</mml:mi><mml:mo>,</mml:mo><mml:mi>κ</mml:mi><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:mi>P</mml:mi><mml:mo>(</mml:mo><mml:mi>ξ</mml:mi><mml:mo>|</mml:mo><mml:mi>κ</mml:mi><mml:mo>)</mml:mo><mml:munderover><mml:mrow><mml:mo>∏</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:munderover><mml:munderover><mml:mrow><mml:mo>∏</mml:mo></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mi>K</mml:mi></mml:mrow></mml:munderover><mml:mi>P</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>Ω</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>ξ</mml:mi><mml:mo>)</mml:mo></mml:mtd><mml:mtd class="eqnarray-2"/><mml:mtd class="eqnarray-3"/><mml:mtd><mml:mtext/></mml:mtd></mml:mtr><mml:mtr><mml:mtd class="eqnarray-1"><mml:mo>=</mml:mo><mml:mtext mathvariant="monospace">Beta</mml:mtext><mml:mo>(</mml:mo><mml:mi>ξ</mml:mi><mml:mo>;</mml:mo><mml:msub><mml:mrow><mml:mi>κ</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>κ</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>)</mml:mo><mml:mo>×</mml:mo><mml:msup><mml:mrow><mml:mi>ξ</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi>Ω</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msup><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>ξ</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>Ω</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msup><mml:mi>.</mml:mi></mml:mtd><mml:mtd class="eqnarray-2"/><mml:mtd class="eqnarray-3"/><mml:mtd><mml:mtext/></mml:mtd></mml:mtr></mml:mtable></mml:math><graphic xlink:href="13073_2021_842_Article_Equm.gif" position="anchor"/></alternatives></disp-formula></p>
        <p>From the beta-Bernoulli conjugacy we obtain: 
<disp-formula id="Equ6"><label>6</label><alternatives><tex-math id="M41">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$ \begin{aligned} P(\xi|\mathbf{C},\Omega,\kappa)\! = \!\texttt{Beta} \left(\kappa_{0} \,+\, \sum_{i,k}\mathbbm{1}(\Omega_{i,k} \neq C_{i,k}),\kappa_{1} \,+\, \sum_{i,k}\mathbbm{1}(\Omega_{i,k} \,=\, C_{i,k}) \right).  \end{aligned}  $$ \end{document}</tex-math><mml:math id="M42"><mml:mtable><mml:mtr><mml:mtd><mml:mi>P</mml:mi><mml:mo>(</mml:mo><mml:mi>ξ</mml:mi><mml:mo>|</mml:mo><mml:mi mathvariant="bold">C</mml:mi><mml:mo>,</mml:mo><mml:mi>Ω</mml:mi><mml:mo>,</mml:mo><mml:mi>κ</mml:mi><mml:mo>)</mml:mo><mml:mspace width="0.3em"/><mml:mo>=</mml:mo><mml:mspace width="0.3em"/><mml:mtext mathvariant="monospace">Beta</mml:mtext><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mrow><mml:mi>κ</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mspace width="0.3em"/><mml:mo>+</mml:mo><mml:mspace width="0.3em"/><mml:munder><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:munder><mml:mi>1</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>Ω</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>≠</mml:mo><mml:msub><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>κ</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mspace width="0.3em"/><mml:mo>+</mml:mo><mml:mspace width="0.3em"/><mml:munder><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:munder><mml:mi>1</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>Ω</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mspace width="0.3em"/><mml:mo>=</mml:mo><mml:mspace width="0.3em"/><mml:msub><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow></mml:mfenced><mml:mi>.</mml:mi></mml:mtd></mml:mtr></mml:mtable></mml:math><graphic xlink:href="13073_2021_842_Article_Equ6.gif" position="anchor"/></alternatives></disp-formula></p>
        <p>Finally, the Gibbs sampling algorithm for CACTUS was derived as a straightforward modification of the algorithm used for cardelino [<xref ref-type="bibr" rid="CR21">21</xref>]. In the algorithm, <italic>I</italic><sub><italic>q</italic></sub> is iteratively sampled using Eq. (<xref rid="Equ1" ref-type="">1</xref>) for <italic>q</italic>=1,…<italic>Q</italic>,<italic>θ</italic><sub><italic>i</italic></sub> for <italic>i</italic>=1,…,<italic>N</italic> is sampled using Eq. (<xref rid="Equ3" ref-type="">3</xref>), <italic>T</italic><sub><italic>j</italic></sub> is sampled for <italic>j</italic>=1,…,<italic>M</italic> using Eq. (<xref rid="Equ4" ref-type="">4</xref>), <italic>C</italic><sub><italic>i</italic>,<italic>k</italic></sub> for <italic>i</italic>=1,…,<italic>N</italic> and <italic>k</italic>=1,…<italic>K</italic> is sampled using Eq. (<xref rid="Equ5" ref-type="">5</xref>), and <italic>ξ</italic> is sampled using Eq. (<xref rid="Equ6" ref-type="">6</xref>).</p>
      </sec>
    </sec>
  </sec>
  <sec id="Sec14" sec-type="results">
    <title>Results</title>
    <sec id="Sec15">
      <title>Single cell and WES profiling of two FL patients</title>
      <p>The analyzed tumor cell populations were collected from lymph nodes of two FL patients: a male patient (S144) at the age of 37, who was diagnosed with an IgM expressing FL stage IV and a female patient (S12118) at the age of 51, who was diagnosed with an IgG expressing FL stage IV. To detect (sub-)clonal mutations, we performed WES at 200 × coverage and called mutations between FL cells and paired stromal non-hematopoietic cells. We detected 398 somatic mutations for patient S144 and 1034 somatic mutations for patient S12118 with somatic <italic>p</italic> value (SPV) &lt;0.1.</p>
      <p>Next, for pooled samples of both subjects, we performed single-cell sequencing of purified FL cells for full transcriptomes and BCR enriched libraries. We used the Vireo method [<xref ref-type="bibr" rid="CR29">29</xref>] to group single cells back to the patients based on matching of alleles expressed in the single cells with germline mutations detected by bulk WES. Deconvolution of the whole transcriptome data yielded 1524 cells of subject S144 and 874 cells of subject S12118, respectively. BCR sequencing yielded BCR heavy chain sequences for approx. 70% of cells in both patients. Both samples were dominated by a limited number of larger BCR clusters (further referred to as multiplet BCR clusters), with many BCR clusters containing only one element (singleton BCR clusters). The “Pielou evenness index” was 0.59 for S144 and 0.53 for S12118, indicating moderate intraclonal diversification [<xref ref-type="bibr" rid="CR30">30</xref>]. For generality, cells without BCR heavy chain sequences were considered to form a separate singleton cluster (see Additional file <xref rid="MOESM1" ref-type="media">1</xref> for BCR cluster size distribution).</p>
    </sec>
    <sec id="Sec16">
      <title>A probabilistic model for assigning cell clusters to evolutionary tumor clones.</title>
      <p>CACTUS is a Bayesian method that integrates three different sources of prior knowledge: (1) a set of tumor clones with their genotypes, (2) independently obtained non-overlapping cell clusters, and (3) scRNA-seq transcripts at mutated sites, to map each cell cluster to its corresponding tumor clone (the “<xref rid="Sec2" ref-type="sec">Methods</xref>” section). Cells of the same cluster are assumed to come from the same tumor clone. Since the clusters are non-overlapping sets of cells, the cluster assignment to clones defines also the cell assignment (each cell in a given cluster is assigned to the same clone as its cluster).</p>
      <p>Here, the input cell clustering was defined by the BCR sequences. Cells with the same BCR sequence are expected to be more likely to come from the same tumor clone. Thus, here CACTUS takes advantage of the extra information of BCR sequences to gain power and confidence of the assignment. During model inference, both the input clone genotypes and the input cell clustering are corrected, taking into account all available data. Thus, although the input clusters are defined as sets of cells with identical BCR sequences, during model inference, the cells may swap between clusters, based not only on BCR sequence similarity but also based on shared sets of mutations.</p>
      <p>CACTUS yields the posterior probability estimate for each given cell cluster to be mapped to each given clone. This probability is defined using a beta-binomial model for the allele-specific transcript counts for each mutation and cell in this cluster. The model estimates the error rate for the given imperfect genotypes of the clones and outputs corrected genotypes. Similarly, the corrected clustering of single cells is returned. The likelihood of assigning a cluster to a given clone increases with the similarity of the mutation signal observed in the cells of the corrected cluster to the corrected genotype of that clone. Overall, the three most important hidden variables in the model are the corrected clone genotypes, the corrected clusters, and the assignment of corrected clusters to the clones by matching to their corrected genotypes. The final assignment of the clusters (and thus also their contained single cells) is obtained by selecting the most probable tumor clone for each corrected cluster (Fig. <xref rid="Fig1" ref-type="fig">1</xref>).</p>
      <p>For both subjects, to define the input clonal structures, we first identified a set of mutations that could be identified both in WES and scRNA-seq data. We consider the mutation to be present in scRNA-seq if at least one variant read is observed. From the identified 398 mutations with SPV &lt;0.1 for subject S144 and 1034 mutations for subject S12118, for further analysis, we selected only these mutations, for which any transcript expression was observed in scRNA-seq. Despite the relaxed significance level of 0.1 for the somatic <italic>p</italic> values, we consider the common mutations as reliable, since they have evidence in both data sources. Only 5 out of 95 total resulting common mutations for subject S144, and 5 out of 133 common mutations for subject S12118, had somatic <italic>p</italic> value in the (0.05,0.1) interval (Additional file <xref rid="MOESM1" ref-type="media">1</xref>). Numbers of the common mutations vary in different cells (Additional file <xref rid="MOESM1" ref-type="media">1</xref>). For further analysis, we considered only cells which contain at least one of the common mutations. This included 1262 out of 1524 cells in subject S144 and 799 out of 874 cells in subject S12118.</p>
      <p>We next applied Canopy to the WES data for the common mutations and extracted the top tree and its corresponding clones, with their genotypes. To obtain the cell-to-clone assignment, CACTUS was applied to the obtained clonal structure, with a clustering of single cells defined by identical BCR sequences and scRNA-seq transcript counts as input. To demonstrate how the addition of the BCR clustering information improves the assignment of cells to clones, we applied cardelino [<xref ref-type="bibr" rid="CR21">21</xref>] to the same Canopy trees and the scRNA-seq transcript counts. From these data, cardelino derived cell assignment to tumor clones. The two models (CACTUS and cardelino) are similar, but CACTUS can exploit the data more fully as it additionally takes into account the cell clustering (here, by BCR sequence) information into account. In fact, for the specific case of such uninformative clusters that contain exactly one cell, CACTUS reduces to cardelino. Thus, naturally, the advantage of CACTUS should be visible for such cells that are contained in clusters of more than one cell. It is important to note that both CACTUS and cardelino correct the input clone genotypes in their own way. Thus, the final genotypes of the clones might be similar, but obtained by correcting different initial clone genotypes. Therefore, keeping original labels of the clones would introduce artificial differences between the outputs of the two methods. To make a comparison of CACTUS to cardelino feasible, we first adjust the clone labels in such a way that clones with most similar corrected genotypes between the two methods share the same label (Additional file <xref rid="MOESM1" ref-type="media">1</xref>).</p>
    </sec>
    <sec id="Sec17">
      <title>CACTUS solution verified by an independent gene expression analysis</title>
      <p>To validate the returned cluster-to-clone assignment and the induced cell assignment, we performed independent analysis of transcript expression levels obtained from scRNA-seq of the same cells. Note that here, we describe gene expression as independent data since the transcript counts across all sites in the gene sequences are not used by CACTUS during inference. In contrast, CACTUS uses specific counts of those reads that map to the variant sites. Gene expression information is thus not used for model inference, only the signal for existence of mutations. We investigated whether the grouping of cells into the inferred clones tends to coincide with similarity of their expression profiles visually (Figs. <xref rid="Fig3" ref-type="fig">3</xref> and <xref rid="Fig4" ref-type="fig">4</xref>). To this end, we reduced the dimensionality of expression data using UMAP [<xref ref-type="bibr" rid="CR31">31</xref>] provided in the Seurat package [<xref ref-type="bibr" rid="CR32">32</xref>] and colored each cell with its corresponding clone inferred using CACTUS, and for a comparison, cardelino [<xref ref-type="bibr" rid="CR21">21</xref>].
<fig id="Fig3"><label>Fig. 3</label><caption><p>Validation of cell-to-clone assignment with gene expression for subject S144. <bold>a, b, c, d</bold> Transcript expression of the cells reduced to two dimensions using UMAP, shown separately for the cells in multiplet BCR clusters (<bold>a</bold>, <bold>b</bold>) and for cells belonging to singleton BCR clusters (<bold>c,d</bold>). Each point corresponding to a cell is colored by its clone assigned by CACTUS (<bold>a</bold>, <bold>c</bold>) and by cardelino [<xref ref-type="bibr" rid="CR21">21</xref>] (<bold>b</bold>, <bold>d</bold>). The advantage of CACTUS in terms of agreement with gene expression is more pronounced for cells in multiplet BCR clusters</p></caption><graphic xlink:href="13073_2021_842_Fig3_HTML" id="MO3"/></fig><fig id="Fig4"><label>Fig. 4</label><caption><p>Validation of cell-to-clone assignment with gene expression for subject S12118. Figure panels as for subject S144 in Fig. <xref rid="Fig3" ref-type="fig">3</xref>. Also for subject S12118, assignment to clones for cells in multiplet BCR clusters using CACTUS (<bold>a</bold>) improves agreement with gene expression data compared to assignment of cells in singleton BCR clusters (<bold>d</bold>) and assignment using cardelino [<xref ref-type="bibr" rid="CR21">21</xref>] (<bold>b</bold>), as quantified using connectivity measure (<bold>c</bold>). For singleton BCR clusters, CACTUS performs comparably well as cardelino</p></caption><graphic xlink:href="13073_2021_842_Fig4_HTML" id="MO4"/></fig></p>
      <p>As expected, CACTUS leverages information obtained from the multiplet BCR clusters. For cells in such BCR clusters, the results of CACTUS are more consistent with gene expression (visualized for UMAP in Figs. <xref rid="Fig3" ref-type="fig">3</xref>a and <xref rid="Fig4" ref-type="fig">4</xref>a) than the results of cardelino (Figs. <xref rid="Fig3" ref-type="fig">3</xref>b and <xref rid="Fig4" ref-type="fig">4</xref>b). For subject S144 and cells contained in the multiplet BCR clusters, CACTUS identifies clone C2 as a set of cells that is separated in gene expression space from a large cluster of cells, which is populated mostly by clone C4 and in part by clone C3. In contrast, cardelino finds clones which are mixed in the reduced gene expression space (Fig. <xref rid="Fig3" ref-type="fig">3</xref>a,b). For subject S12118, both methods associate clone C3 with one gene expression cluster and clone C4 with another, with the two gene expression clusters clearly separated in the reduced space. For CACTUS, the identified clones are slightly less intermixed with others than for cardelino (Fig. <xref rid="Fig4" ref-type="fig">4</xref>). For CACTUS, the clone assignments of cells in the singleton BCR clusters show less agreement with expression than assignments of cells in multiplet clusters (Figs. <xref rid="Fig3" ref-type="fig">3</xref>c and <xref rid="Fig4" ref-type="fig">4</xref>c). The agreement for those cells is comparably low for cardelino (Figs. <xref rid="Fig3" ref-type="fig">3</xref>d and <xref rid="Fig4" ref-type="fig">4</xref>d).</p>
      <p>To quantify the agreement of the obtained assignment of cells to the clones with gene expression, we used several quality measures [<xref ref-type="bibr" rid="CR33">33</xref>]. To this end, for each cell and each subject, we first reduced the dimension of the normalised expression measurement to 25 using PCA. Next, we computed the root mean square standard deviation (RMSSTD), connectivity, Dunn index, and Calinski-Harabasz (CH) index for the reduced gene expression vectors, grouped according to the assignment of cells to the clones [<xref ref-type="bibr" rid="CR34">34</xref>–<xref ref-type="bibr" rid="CR38">38</xref>] (Table <xref rid="Tab1" ref-type="table">1</xref>). In this way, we measured to what extent the gene expression of the cells inside each clone is homogeneous and differs between the clones. A RMSSTD is a measure of compactness—a low value of RMSSTD indicates low variance of gene expression in each set of cells assigned to the same clone. The connectivity measure takes values between 0 and infinity and uses the <italic>k</italic>-nearest neighbors to indicate the degree of connectedness of the clusters. We used <italic>k</italic>=10 for the computation, but we noted that other values of <italic>k</italic> gave similar results. If the cells assigned to the same clone would also be close in terms of Euclidean distance in the reduced 25-dimensional expression space, the connectivity would be minimized. High Dunn index values imply increased compactness of each clone and better separation between the clones, computed for the reduced expression profiles of cells assigned to the clones. The CH index is another measure for evaluating both compactness and separation simultaneously, using average between and within clone sum of squares. The higher CH score indicates more agreement of the assignment of cells into clones with their gene expression values. For cells in the multiplet BCR clusters, these quality measures clearly indicate that CACTUS obtains better agreement between cell-to-clone assignment and gene expression than cardelino (Table <xref rid="Tab1" ref-type="table">1</xref>). In contrast, for cells in singleton clusters, CACTUS obtains similar quality measures as cardelino.
<table-wrap id="Tab1"><label>Table 1</label><caption><p>Quantification of the agreement of the cell-to-clone assignment with gene expression profiles of the cells</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left">Subject</th><th align="left">Type</th><th align="left">Method</th><th align="left">Dunn index</th><th align="left">RMSSTD</th><th align="left">CH</th><th align="left">Connectivity</th></tr></thead><tbody><tr><td align="left">S144</td><td align="left">Multiplet</td><td align="left">CACTUS</td><td align="left"><bold>0.066</bold></td><td align="left"><bold>57.0</bold></td><td align="left"><bold>15.6</bold></td><td align="left"><bold>898.9</bold></td></tr><tr><td align="left"/><td align="left"/><td align="left">cardelino</td><td align="left">0.057</td><td align="left">77.1</td><td align="left">3.2</td><td align="left">1250.9</td></tr><tr><td align="left"/><td align="left">Singleton</td><td align="left">CACTUS</td><td align="left"><bold>0.054</bold></td><td align="left">110.9</td><td align="left"><bold>3.2</bold></td><td align="left">839.5</td></tr><tr><td align="left"/><td align="left"/><td align="left">cardelino</td><td align="left">0.052</td><td align="left"><bold>109.5</bold></td><td align="left">1.9</td><td align="left"><bold>711.9</bold></td></tr><tr><td align="left">S12118</td><td align="left">Multiplet</td><td align="left">CACTUS</td><td align="left"><bold>0.098</bold></td><td align="left"><bold>79.2</bold></td><td align="left"><bold>11.9</bold></td><td align="left"><bold>169.6</bold></td></tr><tr><td align="left"/><td align="left"/><td align="left">cardelino</td><td align="left">0.084</td><td align="left">96.2</td><td align="left">10.0</td><td align="left">495.0</td></tr><tr><td align="left"/><td align="left">Singleton</td><td align="left">CACTUS</td><td align="left">0.085</td><td align="left">105.4</td><td align="left"><bold>4.1</bold></td><td align="left"><bold>285.4</bold></td></tr><tr><td align="left"/><td align="left"/><td align="left">cardelino</td><td align="left"><bold>0.092</bold></td><td align="left"><bold>99.4</bold></td><td align="left">3.9</td><td align="left">396.5</td></tr></tbody></table><table-wrap-foot><p>Bolded values indicate which method (CACTUS or cardelino) obtained better agreement for the given subject and type of cluster that the cells assigned to the clones come from. High values of the Dunn index and the Calinski-Harabasz (CH) index, as well as low values of the root mean square standard deviation (RMSSTD) and connectivity quantify to what extent the gene expression of the cells is homogeneous inside each clone and differs between the clones</p></table-wrap-foot></table-wrap></p>
      <p>We performed independent clustering of cells by their normalised expression using Seurat [<xref ref-type="bibr" rid="CR32">32</xref>]. Then, we compared the resulting clustering of cells by expression to the grouping of cells to clones inferred by CACTUS and by cardelino using the adjusted Rand index (ARI; [<xref ref-type="bibr" rid="CR39">39</xref>]). The index, with values in the [ − 1,1] interval, is a corrected-for-chance version of the Rand index, measuring similarity between two given clusterings. ARI is negative when the agreement is lower than expected by chance and is maximized when the compared clusterings are identical. For subject S144 and the cells that are in the singleton BCR clusters, both clones inferred by CACTUS and by cardelino show very low similarity to expression clusters (with ARI 0.03 and 0.02, respectively). Compared to cardelino (ARI 0.01), CACTUS achieves a higher agreement with the gene expression clustering for cells contained in the multiplet BCR clusters (ARI 0.13). For subject S12118, the CACTUS clones have the same similarity to expression clusters as cardelino. For cells that are in the singleton BCR clusters, both CACTUS and cardelino yield ARI of 0.12. Finally, for the cells in the multiplet BCR clusters, the ARI for both CACTUS and cardelino is 0.21.</p>
      <p>Overall, these results indicate that by accounting for the BCR sequence similarity, CACTUS improves the genotype-to-gene expression phenotype mapping.</p>
    </sec>
    <sec id="Sec18">
      <title>CACTUS enhances the confidence of cell-to-clone assignment</title>
      <p>[For both subjects, the top identified evolutionary trees consisted of four clones (Fig. <xref rid="Fig5" ref-type="fig">5</xref>a, b). The number of mutations acquired along the branches of the trees ranges from 0 to 57. The genotype of each input clone is defined as the set of the mutations acquired on the path from the root of the tree to the leaf corresponding to the clone (Additional file <xref rid="MOESM2" ref-type="media">2</xref>). Notably, the clone genotypes and frequencies derived by Canopy (Fig. <xref rid="Fig5" ref-type="fig">5</xref>a, b) were corrected both by CACTUS (Fig. <xref rid="Fig5" ref-type="fig">5</xref>c, g, e, i) and cardelino (Fig. <xref rid="Fig5" ref-type="fig">5</xref>d, h, f, j). CACTUS, in addition, corrected the input BCR clustering. All results discussed below are for the corrected genotypes and corrected clusters.
<fig id="Fig5"><label>Fig. 5</label><caption><p>Confidence of cell assignment to the tumor clones. <bold>a, b</bold> Evolutionary trees inferred by Canopy [<xref ref-type="bibr" rid="CR9">9</xref>] for subject S144 (<bold>a</bold>) and S12118 (<bold>b</bold>). Leaf labels: clone prevalences. Branch labels: numbers of acquired mutations. Canopy considers also CNVs, but they are not used for cell-to-clone mapping and hence not visualized here. Thus, the branch labels can be zero when the alterations acquired along that branch are copy number changes. Clone 1 corresponds to the base, normal clone. In tree <bold>a</bold>, clone 4 (C4) differs from clone 3 (C3) by the 12 SNVs acquired on the branch leading to the leaf C3. <bold>c–j</bold> Shades of brown indicate the probability of assignment of cells (y axis) to the clones (x axis; labeled with corrected prevalences, computed as the fraction of single cells assigned to the clones) by CACTUS (<bold>c, g, e, i</bold>) and cardelino [<xref ref-type="bibr" rid="CR21">21</xref>] (<bold>d, h, f, j</bold>). For cells in multiplet BCR clusters (second row), CACTUS yields higher confidence of cell-to-clone assignment (<bold>c, e</bold>) than cardelino (<bold>d, f</bold>). For cells in singleton BCR clusters (third row) for subject S144, the confidence of cell-to-clone assignment by CACTUS (<bold>g</bold>) is similarly weak as by cardelino (<bold>h</bold>), while for S12118 and for CACTUS (<bold>i</bold>), the confidence is higher than for cardelino (<bold>j</bold>)</p></caption><graphic xlink:href="13073_2021_842_Fig5_HTML" id="MO5"/></fig></p>
      <p>We investigated the confidence of assignment of cells to the tumor clones for both subjects (Fig. <xref rid="Fig5" ref-type="fig">5</xref>). The assignment of cells to the clones was directly derived from the assignment of their BCR clusters. In general, thanks to the additional information from the BCR clusters, CACTUS assigns cells to clones with a clearly higher confidence than cardelino [<xref ref-type="bibr" rid="CR21">21</xref>]. From both methods, the probability of assigning each cell to each clone can be derived as output. For subject S144 and a majority of cells, the probability of assignment by cardelino is almost uniform across the clones (Fig. <xref rid="Fig5" ref-type="fig">5</xref>d, h). In contrast, for the subset of cells in the multiplet BCR clusters, the probability of assignment by CACTUS makes confident assignments (Fig. <xref rid="Fig5" ref-type="fig">5</xref>c). For the cells in the singleton BCR clusters, CACTUS assigns cells with similar confidence to cardelino (Fig. <xref rid="Fig5" ref-type="fig">5</xref>g).</p>
      <p>Compared to S144, for subject S12118 the confidence of assignment is larger for both methods (Fig. <xref rid="Fig5" ref-type="fig">5</xref>). Again, CACTUS has an advantage over cardelino, especially for cells in the multiplet BCR clusters, assigning majority of those cells to one clone with high probability (Fig. <xref rid="Fig5" ref-type="fig">5</xref>e, i). In contrast, for a majority of cells, cardelino yields similar probabilities of assignment to clones C2 and C4 (Fig. <xref rid="Fig5" ref-type="fig">5</xref>f, j).</p>
      <p>Overall, the confidence of the assignment is clearly higher for CACTUS than for cardelino, for both subjects (Table <xref rid="Tab2" ref-type="table">2</xref>). Here, we quantified confidence as the concentration of the assignment probability distribution over the clones, averaged over the cells, using the measures of entropy and the Gini index [<xref ref-type="bibr" rid="CR40">40</xref>, <xref ref-type="bibr" rid="CR41">41</xref>]. Both entropy and Gini index should be lower for larger concentration of the probability distribution (equivalently, smaller dispersion).
<table-wrap id="Tab2"><label>Table 2</label><caption><p>Quantification of the confidence of cell-to-clone assignment</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left">Subject</th><th align="left">Type</th><th align="left">Method</th><th align="left">Entropy</th><th align="left">Gini index</th></tr></thead><tbody><tr><td align="left">S144</td><td align="left">Multiplet</td><td align="left">CACTUS</td><td align="left"><bold>0.42</bold></td><td align="left"><bold>0.46</bold></td></tr><tr><td align="left"/><td align="left"/><td align="left">cardelino</td><td align="left">0.85</td><td align="left">0.90</td></tr><tr><td align="left"/><td align="left">Singleton</td><td align="left">CACTUS</td><td align="left"><bold>0.79</bold></td><td align="left"><bold>0.84</bold></td></tr><tr><td align="left"/><td align="left"/><td align="left">cardelino</td><td align="left">0.87</td><td align="left">0.90</td></tr><tr><td align="left">S12118</td><td align="left">Multiplet</td><td align="left">CACTUS</td><td align="left"><bold>0.04</bold></td><td align="left"><bold>0.04</bold></td></tr><tr><td align="left"/><td align="left"/><td align="left">cardelino</td><td align="left">0.39</td><td align="left">0.45</td></tr><tr><td align="left"/><td align="left">Singleton</td><td align="left">CACTUS</td><td align="left"><bold>0.36</bold></td><td align="left"><bold>0.38</bold></td></tr><tr><td align="left"/><td align="left"/><td align="left">cardelino</td><td align="left">0.47</td><td align="left">0.54</td></tr></tbody></table><table-wrap-foot><p>Confidence is measured as the concentration of the probability distribution of assigning a cell to clones, averaged across cells. Bolded values indicate which method (CACTUS or cardelino) obtained higher confidence. Both normalized entropy (entropy divided by the maximum possible value) and the Gini index are supposed to have lower values for more concentrated distributions, and larger values for more dispersed ones</p></table-wrap-foot></table-wrap></p>
    </sec>
    <sec id="Sec19">
      <title>Assignment of BCR clusters to tumor clones</title>
      <p>Finally, we inspected the assignment of BCR clusters to clones by CACTUS. For a comparison, for each clone, we computed the proportion of each multiplet BCR cluster (the fraction of cells in that BCR cluster) that were assigned to this clone using cardelino (Fig. <xref rid="Fig6" ref-type="fig">6</xref>). In the case of ties in the highest proportions across clones, we assumed the BCR cluster was assigned to the same clone as by CACTUS.
<fig id="Fig6"><label>Fig. 6</label><caption><p>BCR cluster assignment to tumor clones, for both subjects. S144 (<bold>a, b</bold>) and S12118 (<bold>c, d</bold>), using CACTUS (<bold>a, c</bold>) and cardelino [<xref ref-type="bibr" rid="CR21">21</xref>] (<bold>b, d</bold>). Heatmaps with shades of green indicate the proportion of cells in multiplet cluster (y axis) assigned to clones (x axis). Each number in a green entry indicates the non-zero number of cells of the corresponding BCR clusters assigned to the corresponding clone. Only BCR clusters of at least two cells are featured. As expected, for both subjects, CACTUS assigns entire BCR clusters to single clones (<bold>a, c</bold>). For cardelino, the proportions of BCR clusters are more distributed across the clones (<bold>b, d</bold>)</p></caption><graphic xlink:href="13073_2021_842_Fig6_HTML" id="MO6"/></fig></p>
      <p>As expected by construction of the underlying probabilistic model, for both subjects, CACTUS assigns entire BCR clusters to single clones (Fig. <xref rid="Fig6" ref-type="fig">6</xref>a, c). For cardelino, the proportions of BCR clusters are more distributed across the clones (Fig. <xref rid="Fig6" ref-type="fig">6</xref>b, d). Given the uncertainty of assignment of cells to clones by cardelino for subject S144 (Fig. <xref rid="Fig5" ref-type="fig">5</xref>), it is not surprising that for some of the BCR clusters, the clone assigned by CACTUS does not agree with the clone with the highest proportion of cells assigned by cardelino. CACTUS did not assign any BCR cluster to clone C1, while cardelino assigned cluster U to that clone. All of 11 BCR clusters assigned to clone C2 by CACTUS were assigned to the same clone by cardelino. Out of 15 BCR clusters assigned to clone C3 by CACTUS, however, none was assigned to clone C3 also by cardelino. This large disagreement comes mainly from the fact that cardelino assigned the highest proportion of cells contained in 13 of these 15 clusters again to clone C2. Finally, out of 11 BCR clusters assigned to clone C4 by CACTUS, 4 were assigned in the highest proportion to the same clone also by cardelino.</p>
      <p>For subject S12118, the assignment of cluster agrees between the two methods, with the only exception of cluster O. This is in accordance with the increased confidence of assignment of cells to clones by both methods for that subject (compare Fig. <xref rid="Fig5" ref-type="fig">5</xref>).</p>
      <p>In summary, the agreement of both cell-to-clone and BCR cluster-to-clone mapping between the CACTUS and cardelino increases with the confidence of assignment. For subject S144, for which cardelino yielded low-confidence assignments, 736 out of 1262 cells in total (58%) and 22 out of 37 multiplet BCR clusters (59%) were assigned to different clones by the two methods. Here, we assume cardelino assigns a BCR cluster to the clone to which it assigned the highest proportion of cells. For subject S12118, where both methods increased confidence of assignment, only 123 cells out of 799 (15%) and only one BCR cluster out of 26 multiplet BCR clusters (4%) was assigned differently.</p>
    </sec>
  </sec>
  <sec id="Sec20" sec-type="discussion">
    <title>Discussion</title>
    <p>Here, we propose a probabilistic model for accurate and confident mapping of single tumor cells to their evolutionary clones of origin. In this way, it allows clone-specific gene expression profiling, opening the possibility to reconstruct genotype-to-phenotype maps. The task of cell-to-clone mapping is challenged by multiple technical obstacles. First, although multiple methods exist for the inference of tumor evolution, resolving tumor clones and their genotypes is in itself a difficult computational problem and errors are expected [<xref ref-type="bibr" rid="CR12">12</xref>]. Thus, CACTUS uses the additional signal both in the scRNA-seq and in clustering data to correct the given genotypes of the clones. Second, the information in scRNA-seq data is only sparse, prone to errors such as dropout and uneven coverage, and biased to mutations observable in typically sequenced first 150 nt of transcripts. It is thus important to realize that the analysed tumor history is limited only to the mutations measurable in single cells and is potentially more coarse-grained than the true clonal structure of the tumor. These limitations are purely technical, and in this respect analysis using CACTUS would benefit from full-length transcript sequencing with high depth, as well as further developments increasing the quality of scRNA-seq technology.</p>
    <p>The key aspect of our model is the ability to borrow information across different measurements (both of DNA and RNA) of the cells in the sample. In particular, in addition to clone genotypes derived from WES, and allele-specific transcript counts measured using scRNA-seq, the model leverages information given by independent clustering of single cells. Our results show that this additional evidence is crucial to overcome the challenges of the cell-to-clone assignment problem. Not any given cell clustering, however, can empower CACTUS to deliver more confident results. The assumption that cells contained in the same cluster tend to belong to the same clone is critical for model performance. In particular, such cell clustering, where the cells in the same cluster are not expected to belong to the same clone, can misguide model inference. Apart from clustering by genomic features, which is expected to agree with the clonal structure of the tumor cell population, for example, clustering by location in the tissue could be provided as input to CACTUS. Here, we used single-cell BCR heavy chain sequences to define the input clustering. As would other relevant genomic features, mutations in BCR loci bring evolutionary information. On a general level, they indicate whether a subpopulation of tumor cells sharing a BCR sequence with a low number of BCR mutations evolved relatively early, or if it has more recently evolved and carries a higher number of mutations. Similar BCR sequences indicate common evolutionary origin, as otherwise they would be disrupted by acquisition of additional mutations. Importantly, although the input clustering is defined by identical BCR sequences, cells are shifted between clusters during the model inference process, both re-distributing cells among multiplet clusters and joining singleton clusters to multiplets. This process is influenced by all available data, i.e., not only the similarity of BCR sequences, but also the variants found in scRNA-seq and in the genotypes derived from WES. Here, the quality of additional information brought in by the BCR clusters is assured by the complete and deep sequencing coverage of BCR loci in the applied scRNA-seq strategy. Errors in sequencing, however, may still occur, which further supports the need for updating the input cell clusters.</p>
    <p>CACTUS could be extended in the future to further broaden its functionality and to account for even more additional measurements. The input clone genotypes and the number of clones are corrected, but need to be inferred a priori to applying the model, and the evolutionary tree structure is not utilized by the model. The possible errors in the prior tree inference, or a wrong assumption about the number of clones, can potentially hamper the model performance. To some extent, this problem is avoided by the fact that CACTUS corrects the input clone genotypes during inference. Instead, CACTUS could be extended to simultaneously infer the evolutionary tree, yielding the clones and their genotypes, together with the cell assignment to the clones. Finally, other measurements could be incorporated to statistically strengthen model inference. For example, gene expression similarities between cells, here used for model validation, could be used as input, as cells with similar expression profiles are expected to come from the same clone.</p>
    <p>The model is applied to newly generated FL patient data, for the first time shedding light on how clonal evolution in this cancer type induces clone-specific gene expression and agrees with BCR clusters. Accurate mapping of clonal structures with gene expression patterns allows detection of potential therapy-resistant clones, which is essential for effective personalized treatment. Our results demonstrate applicability of CACTUS to the complex cancer samples. The model, however, is more generally applicable and can describe somatic evolution also in other diseases or in the healthy tissue.</p>
  </sec>
  <sec id="Sec21" sec-type="conclusion">
    <title>Conclusions</title>
    <p>Here, we deal with the task of gene expression profiling of tumor clones by matching the genotypes of the clones to the mutations found by RNA sequencing in the single cells. As applied here, CACTUS benefits from the additional information contained in clusters of single cells sharing similar BCR sequences to assign cells to clones, to successfully deal with errors and dropouts in single-cell RNA sequencing, and the difficulty of inferring the correct clonal structure. In summary, this contribution is a step forward in establishing computational tools for resolving the tumor heterogeneity and, by combining genotype with gene expression profiles, its impact on functional diversification of the tumor cell subpopulations.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Information</title>
    <sec id="Sec22">
      <p>
        <supplementary-material content-type="local-data" id="MOESM1">
          <media xlink:href="13073_2021_842_MOESM1_ESM.pdf">
            <caption>
              <p><bold>Additional file 1</bold> Figures S1-S6</p>
            </caption>
          </media>
        </supplementary-material>
      </p>
      <p>
        <supplementary-material content-type="local-data" id="MOESM2">
          <media xlink:href="13073_2021_842_MOESM2_ESM.xlsx">
            <caption>
              <p><bold>Additional file 2</bold> Table S1</p>
            </caption>
          </media>
        </supplementary-material>
      </p>
    </sec>
  </sec>
</body>
<back>
  <fn-group>
    <fn>
      <p>
        <bold>Publisher’s Note</bold>
      </p>
      <p>Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p>
    </fn>
    <fn>
      <p>Shadi Darvish Shafighi, Szymon M Kie{\l}basa, Cornelis A.M. van Bergen and Ewa Szczurek contributed equally to this work.</p>
    </fn>
  </fn-group>
  <ack>
    <title>Acknowledgements</title>
    <p>The authors wish to thank the Flow Core Facility operators Guido de Roo and Edwin de Haas for the exquisite flow cytometric cell sorting and Emile Meijer of the Leiden Genome Technology Center for the excellent preparation of single-cell sequencing libraries.</p>
  </ack>
  <notes notes-type="author-contribution">
    <title>Authors’ contributions</title>
    <p>S.D.S and E.S. developed the probabilistic model. S.D.S implemented the model and phylogenetic analysis, carried out the application of the model, and benchmarked an alternative method, supervised by E.S. S.D.S, D.C., and H.M. performed the copy number calling in WES data. S.M.K. performed the clustering of single cells to subjects and supervised primary data analyses. J.S. conducted mutation calling in WES data. R.Mo. performed the single-cell data sample deconvolution. R.Me. conducted the alignment of scRNA reads. S.K. carried out the exome and scRNA sequencing. H.V. provided the patient samples and data. C.A.M.v.B. conceived and planned the experiments and carried out the sample preparation and identification of input BCR clusters. E.S., C.A.M.v.B., S.M.K., and S.D.S. conceived the study and wrote the paper. All authors read and approved the final manuscript.</p>
  </notes>
  <notes notes-type="funding-information">
    <title>Funding</title>
    <p>This project has received funding from the European Union’s Horizon 2020 research and innovation programme under the Marie Skłodowska-Curie grant agreement No 766030. ES acknowledges the support from the Polish National Science Centre OPUS grant no 2019/33/B/NZ2/00956.</p>
  </notes>
  <notes notes-type="data-availability">
    <title>Availability of data and materials</title>
    <p>CACTUS is freely available as an R code at our GitHub repository [<xref ref-type="bibr" rid="CR42">42</xref>]. The results were plotted using <italic>ggplot2</italic> and <italic>ComplexHeatmap</italic> packages[<xref ref-type="bibr" rid="CR43">43</xref>, <xref ref-type="bibr" rid="CR44">44</xref>]. The dataset supporting the conclusions of this article is available at our GitHub repository [<xref ref-type="bibr" rid="CR45">45</xref>].</p>
  </notes>
  <notes id="FPar1">
    <title>Ethics approval and consent to participate</title>
    <p>Lymph node biopsies were collected from patients after approval by the institutional review board (IRB, no. B16.039) of the “Medical Ethical Committee Leiden |Den Haag |Delft,” Albinusdreef 2, 2333 ZA Leiden, The Netherlands, according to the Declaration of Helsinki. Prior written informed consent was obtained from all patients to investigate materials and to publish data and case details.</p>
  </notes>
  <notes id="FPar2">
    <title>Consent for publication</title>
    <p>Abovementioned IRB no. B16.039 includes consent to publish data and case details.</p>
  </notes>
  <notes id="FPar3" notes-type="COI-statement">
    <title>Competing interests</title>
    <p>The authors declare that they have no competing interests.</p>
  </notes>
  <ref-list id="Bib1">
    <title>References</title>
    <ref id="CR1">
      <label>1</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Fittall</surname>
            <given-names>MW</given-names>
          </name>
          <name>
            <surname>Van Loo</surname>
            <given-names>P</given-names>
          </name>
        </person-group>
        <article-title>Translating insights into tumor evolution to clinical practice: promises and challenges</article-title>
        <source>Genome Med</source>
        <year>2019</year>
        <volume>11</volume>
        <issue>1</issue>
        <fpage>20</fpage>
        <pub-id pub-id-type="doi">10.1186/s13073-019-0632-z</pub-id>
        <pub-id pub-id-type="pmid">30925887</pub-id>
      </element-citation>
    </ref>
    <ref id="CR2">
      <label>2</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Yi</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Lin</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Zhao</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Mills</surname>
            <given-names>GB</given-names>
          </name>
          <name>
            <surname>Sahni</surname>
            <given-names>N</given-names>
          </name>
        </person-group>
        <article-title>Functional variomics and network perturbation: connecting genotype to phenotype in cancer</article-title>
        <source>Nat Rev Genet</source>
        <year>2017</year>
        <volume>18</volume>
        <issue>7</issue>
        <fpage>395</fpage>
        <pub-id pub-id-type="doi">10.1038/nrg.2017.8</pub-id>
        <pub-id pub-id-type="pmid">28344341</pub-id>
      </element-citation>
    </ref>
    <ref id="CR3">
      <label>3</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Turajlic</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Sottoriva</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Graham</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Swanton</surname>
            <given-names>C</given-names>
          </name>
        </person-group>
        <article-title>Resolving genetic heterogeneity in cancer</article-title>
        <source>Nat Rev Genet</source>
        <year>2019</year>
        <volume>20</volume>
        <issue>7</issue>
        <fpage>404</fpage>
        <lpage>16</lpage>
        <pub-id pub-id-type="doi">10.1038/s41576-019-0114-6</pub-id>
        <pub-id pub-id-type="pmid">30918367</pub-id>
      </element-citation>
    </ref>
    <ref id="CR4">
      <label>4</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kridel</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Sehn</surname>
            <given-names>LH</given-names>
          </name>
          <name>
            <surname>Gascoyne</surname>
            <given-names>RD</given-names>
          </name>
        </person-group>
        <article-title>Pathogenesis of follicular lymphoma</article-title>
        <source>J Clin Investig</source>
        <year>2012</year>
        <volume>122</volume>
        <issue>10</issue>
        <fpage>3424</fpage>
        <lpage>31</lpage>
        <pub-id pub-id-type="doi">10.1172/JCI63186</pub-id>
        <pub-id pub-id-type="pmid">23023713</pub-id>
      </element-citation>
    </ref>
    <ref id="CR5">
      <label>5</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Pasqualucci</surname>
            <given-names>L</given-names>
          </name>
        </person-group>
        <article-title>Molecular pathogenesis of germinal center-derived b cell lymphomas</article-title>
        <source>Immunol Rev</source>
        <year>2019</year>
        <volume>288</volume>
        <issue>1</issue>
        <fpage>240</fpage>
        <lpage>61</lpage>
        <pub-id pub-id-type="doi">10.1111/imr.12745</pub-id>
        <pub-id pub-id-type="pmid">30874347</pub-id>
      </element-citation>
    </ref>
    <ref id="CR6">
      <label>6</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Scherer</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Navarrete</surname>
            <given-names>MA</given-names>
          </name>
          <name>
            <surname>Bertinetti-Lapatki</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Boehm</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Schmitt-Graeff</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Veelken</surname>
            <given-names>H</given-names>
          </name>
        </person-group>
        <article-title>Isotype-switched follicular lymphoma displays dissociation between activation-induced cytidine deaminase expression and somatic hypermutation</article-title>
        <source>Leuk Lymphoma</source>
        <year>2016</year>
        <volume>57</volume>
        <issue>1</issue>
        <fpage>151</fpage>
        <lpage>60</lpage>
        <pub-id pub-id-type="doi">10.3109/10428194.2015.1037758</pub-id>
        <pub-id pub-id-type="pmid">25860234</pub-id>
      </element-citation>
    </ref>
    <ref id="CR7">
      <label>7</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Scherer</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>van der Burgt</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Kiełbasa</surname>
            <given-names>SM</given-names>
          </name>
          <name>
            <surname>Bertinetti-Lapatki</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Dühren</surname>
            <given-names>VMM</given-names>
          </name>
          <name>
            <surname>Mikesch</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Zirlik</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>de Wreede</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Veelken</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Navarrete</surname>
            <given-names>MA</given-names>
          </name>
        </person-group>
        <article-title>Selection patterns of b-cell receptors and the natural history of follicular lymphoma</article-title>
        <source>Br J Haematol</source>
        <year>2016</year>
        <volume>175</volume>
        <issue>5</issue>
        <fpage>972</fpage>
        <pub-id pub-id-type="doi">10.1111/bjh.13901</pub-id>
        <pub-id pub-id-type="pmid">26687432</pub-id>
      </element-citation>
    </ref>
    <ref id="CR8">
      <label>8</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Schneider</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Dühren-von Minden</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Alkhatib</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Setz</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>van Bergen</surname>
            <given-names>CA</given-names>
          </name>
          <name>
            <surname>Benkißer-Petersen</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Wilhelm</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Villringer</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Krysov</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Packham</surname>
            <given-names>G</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Lectins from opportunistic bacteria interact with acquired variable-region glycans of surface immunoglobulin in follicular lymphoma</article-title>
        <source>Blood J Am Soc Hematol</source>
        <year>2015</year>
        <volume>125</volume>
        <issue>21</issue>
        <fpage>3287</fpage>
        <lpage>96</lpage>
      </element-citation>
    </ref>
    <ref id="CR9">
      <label>9</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Jiang</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Qiu</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Minn</surname>
            <given-names>AJ</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>NR</given-names>
          </name>
        </person-group>
        <article-title>Assessing intratumor heterogeneity and tracking longitudinal and spatial clonal evolutionary history by next-generation sequencing</article-title>
        <source>Proc Natl Acad Sci</source>
        <year>2016</year>
        <volume>113</volume>
        <issue>37</issue>
        <fpage>5528</fpage>
        <lpage>37</lpage>
        <pub-id pub-id-type="doi">10.1073/pnas.1522203113</pub-id>
      </element-citation>
    </ref>
    <ref id="CR10">
      <label>10</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Deshwar</surname>
            <given-names>AG</given-names>
          </name>
          <name>
            <surname>Vembu</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Yung</surname>
            <given-names>CK</given-names>
          </name>
          <name>
            <surname>Jang</surname>
            <given-names>GH</given-names>
          </name>
          <name>
            <surname>Stein</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Morris</surname>
            <given-names>Q</given-names>
          </name>
        </person-group>
        <article-title>Phylowgs: reconstructing subclonal composition and evolution from whole-genome sequencing of tumors</article-title>
        <source>Genome Biol</source>
        <year>2015</year>
        <volume>16</volume>
        <issue>1</issue>
        <fpage>35</fpage>
        <pub-id pub-id-type="doi">10.1186/s13059-015-0602-8</pub-id>
        <pub-id pub-id-type="pmid">25786235</pub-id>
      </element-citation>
    </ref>
    <ref id="CR11">
      <label>11</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Roth</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Khattra</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Yap</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Wan</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Laks</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Biele</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Ha</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Aparicio</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Bouchard-Côté</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Shah</surname>
            <given-names>SP</given-names>
          </name>
        </person-group>
        <article-title>Pyclone: statistical inference of clonal population structure in cancer</article-title>
        <source>Nat Methods</source>
        <year>2014</year>
        <volume>11</volume>
        <issue>4</issue>
        <fpage>396</fpage>
        <pub-id pub-id-type="doi">10.1038/nmeth.2883</pub-id>
        <pub-id pub-id-type="pmid">24633410</pub-id>
      </element-citation>
    </ref>
    <ref id="CR12">
      <label>12</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Beerenwinkel</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Schwarz</surname>
            <given-names>RF</given-names>
          </name>
          <name>
            <surname>Gerstung</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Markowetz</surname>
            <given-names>F</given-names>
          </name>
        </person-group>
        <article-title>Cancer evolution: mathematical models and computational inference</article-title>
        <source>Syst Biol</source>
        <year>2015</year>
        <volume>64</volume>
        <issue>1</issue>
        <fpage>1</fpage>
        <lpage>25</lpage>
        <pub-id pub-id-type="doi">10.1093/sysbio/syu081</pub-id>
        <pub-id pub-id-type="pmid">25504791</pub-id>
      </element-citation>
    </ref>
    <ref id="CR13">
      <label>13</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ross</surname>
            <given-names>EM</given-names>
          </name>
          <name>
            <surname>Markowetz</surname>
            <given-names>F</given-names>
          </name>
        </person-group>
        <article-title>Onconem: inferring tumor evolution from single-cell sequencing data</article-title>
        <source>Genome Biol</source>
        <year>2016</year>
        <volume>17</volume>
        <issue>1</issue>
        <fpage>1</fpage>
        <lpage>14</lpage>
        <pub-id pub-id-type="doi">10.1186/s13059-016-0929-9</pub-id>
        <pub-id pub-id-type="pmid">26753840</pub-id>
      </element-citation>
    </ref>
    <ref id="CR14">
      <label>14</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Jahn</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Kuipers</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Beerenwinkel</surname>
            <given-names>N</given-names>
          </name>
        </person-group>
        <article-title>Tree inference for single-cell data</article-title>
        <source>Genome Biol</source>
        <year>2016</year>
        <volume>17</volume>
        <issue>1</issue>
        <fpage>86</fpage>
        <pub-id pub-id-type="doi">10.1186/s13059-016-0936-x</pub-id>
        <pub-id pub-id-type="pmid">27149953</pub-id>
      </element-citation>
    </ref>
    <ref id="CR15">
      <label>15</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Gawad</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Koh</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Quake</surname>
            <given-names>SR</given-names>
          </name>
        </person-group>
        <article-title>Dissecting the clonal origins of childhood acute lymphoblastic leukemia by single-cell genomics</article-title>
        <source>Proc Natl Acad Sci</source>
        <year>2014</year>
        <volume>111</volume>
        <issue>50</issue>
        <fpage>17947</fpage>
        <lpage>52</lpage>
        <pub-id pub-id-type="doi">10.1073/pnas.1420822111</pub-id>
        <pub-id pub-id-type="pmid">25425670</pub-id>
      </element-citation>
    </ref>
    <ref id="CR16">
      <label>16</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kuipers</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Jahn</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Beerenwinkel</surname>
            <given-names>N</given-names>
          </name>
        </person-group>
        <article-title>Advances in understanding tumour evolution through single-cell sequencing</article-title>
        <source>Biochim Biophys Acta Rev Cancer</source>
        <year>2017</year>
        <volume>1867</volume>
        <issue>2</issue>
        <fpage>127</fpage>
        <lpage>38</lpage>
        <pub-id pub-id-type="doi">10.1016/j.bbcan.2017.02.001</pub-id>
        <pub-id pub-id-type="pmid">28193548</pub-id>
      </element-citation>
    </ref>
    <ref id="CR17">
      <label>17</label>
      <mixed-citation publication-type="other">Müller S, Liu SJ, Di Lullo E, Malatesta M, Pollen AA, Nowakowski TJ, Kohanbash G, Aghi M, Kriegstein AR, Lim DA, et al.Single-cell sequencing maps gene expression to mutational phylogenies in pdgf-and egf-driven gliomas. Mol Syst Biol. 2016; 12(11).</mixed-citation>
    </ref>
    <ref id="CR18">
      <label>18</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Tirosh</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Venteicher</surname>
            <given-names>AS</given-names>
          </name>
          <name>
            <surname>Hebert</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Escalante</surname>
            <given-names>LE</given-names>
          </name>
          <name>
            <surname>Patel</surname>
            <given-names>AP</given-names>
          </name>
          <name>
            <surname>Yizhak</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Fisher</surname>
            <given-names>JM</given-names>
          </name>
          <name>
            <surname>Rodman</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Mount</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Filbin</surname>
            <given-names>MG</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Single-cell rna-seq supports a developmental hierarchy in human oligodendroglioma</article-title>
        <source>Nat</source>
        <year>2016</year>
        <volume>539</volume>
        <issue>7628</issue>
        <fpage>309</fpage>
        <lpage>13</lpage>
        <pub-id pub-id-type="doi">10.1038/nature20123</pub-id>
      </element-citation>
    </ref>
    <ref id="CR19">
      <label>19</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Fan</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Lee</surname>
            <given-names>H-O</given-names>
          </name>
          <name>
            <surname>Lee</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Ryu</surname>
            <given-names>D-e</given-names>
          </name>
          <name>
            <surname>Lee</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Xue</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Kim</surname>
            <given-names>SJ</given-names>
          </name>
          <name>
            <surname>Kim</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Barkas</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Park</surname>
            <given-names>PJ</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Linking transcriptional and genetic tumor heterogeneity through allele analysis of single-cell rna-seq data</article-title>
        <source>Genome Res</source>
        <year>2018</year>
        <volume>28</volume>
        <issue>8</issue>
        <fpage>1217</fpage>
        <lpage>27</lpage>
        <pub-id pub-id-type="doi">10.1101/gr.228080.117</pub-id>
        <pub-id pub-id-type="pmid">29898899</pub-id>
      </element-citation>
    </ref>
    <ref id="CR20">
      <label>20</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Poirion</surname>
            <given-names>O</given-names>
          </name>
          <name>
            <surname>Zhu</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Ching</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Garmire</surname>
            <given-names>LX</given-names>
          </name>
        </person-group>
        <article-title>Using single nucleotide variations in single-cell rna-seq to identify subpopulations and genotype-phenotype linkage</article-title>
        <source>Nat Commun</source>
        <year>2018</year>
        <volume>9</volume>
        <issue>1</issue>
        <fpage>1</fpage>
        <lpage>13</lpage>
        <pub-id pub-id-type="doi">10.1038/s41467-018-07170-5</pub-id>
        <pub-id pub-id-type="pmid">29317637</pub-id>
      </element-citation>
    </ref>
    <ref id="CR21">
      <label>21</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>McCarthy</surname>
            <given-names>DJ</given-names>
          </name>
          <name>
            <surname>Rostom</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Huang</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Kunz</surname>
            <given-names>DJ</given-names>
          </name>
          <name>
            <surname>Danecek</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Bonder</surname>
            <given-names>MJ</given-names>
          </name>
          <name>
            <surname>Hagai</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Lyu</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Gaffney</surname>
            <given-names>DJ</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Cardelino: computational integration of somatic clonal substructure and single-cell transcriptomes</article-title>
        <source>Nat Methods</source>
        <year>2020</year>
        <volume>17</volume>
        <issue>4</issue>
        <fpage>414</fpage>
        <lpage>21</lpage>
        <pub-id pub-id-type="doi">10.1038/s41592-020-0766-3</pub-id>
        <pub-id pub-id-type="pmid">32203388</pub-id>
      </element-citation>
    </ref>
    <ref id="CR22">
      <label>22</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ortega</surname>
            <given-names>MA</given-names>
          </name>
          <name>
            <surname>Poirion</surname>
            <given-names>O</given-names>
          </name>
          <name>
            <surname>Zhu</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Huang</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Wolfgruber</surname>
            <given-names>TK</given-names>
          </name>
          <name>
            <surname>Sebra</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Garmire</surname>
            <given-names>LX</given-names>
          </name>
        </person-group>
        <article-title>Using single-cell multiple omics approaches to resolve tumor heterogeneity</article-title>
        <source>Clin Transl Med</source>
        <year>2017</year>
        <volume>6</volume>
        <issue>1</issue>
        <fpage>46</fpage>
        <pub-id pub-id-type="doi">10.1186/s40169-017-0177-y</pub-id>
        <pub-id pub-id-type="pmid">29285690</pub-id>
      </element-citation>
    </ref>
    <ref id="CR23">
      <label>23</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lähnemann</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Köster</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Szczurek</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>McCarthy</surname>
            <given-names>DJ</given-names>
          </name>
          <name>
            <surname>Hicks</surname>
            <given-names>SC</given-names>
          </name>
          <name>
            <surname>Robinson</surname>
            <given-names>MD</given-names>
          </name>
          <name>
            <surname>Vallejos</surname>
            <given-names>CA</given-names>
          </name>
          <name>
            <surname>Campbell</surname>
            <given-names>KR</given-names>
          </name>
          <name>
            <surname>Beerenwinkel</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Mahfouz</surname>
            <given-names>A</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Eleven grand challenges in single-cell data science</article-title>
        <source>Genome Biol</source>
        <year>2020</year>
        <volume>21</volume>
        <issue>1</issue>
        <fpage>1</fpage>
        <lpage>35</lpage>
        <pub-id pub-id-type="doi">10.1186/s13059-020-1926-6</pub-id>
      </element-citation>
    </ref>
    <ref id="CR24">
      <label>24</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Li</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Durbin</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>Fast and accurate short read alignment with Burrows–Wheeler transform</article-title>
        <source>Bioinforma</source>
        <year>2009</year>
        <volume>25</volume>
        <issue>14</issue>
        <fpage>1754</fpage>
        <lpage>60</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btp324</pub-id>
      </element-citation>
    </ref>
    <ref id="CR25">
      <label>25</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>McKenna</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Hanna</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Banks</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Sivachenko</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Cibulskis</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Kernytsky</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Garimella</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Altshuler</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Gabriel</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Daly</surname>
            <given-names>M</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>The genome analysis toolkit: a mapreduce framework for analyzing next-generation dna sequencing data</article-title>
        <source>Genome Res</source>
        <year>2010</year>
        <volume>20</volume>
        <issue>9</issue>
        <fpage>1297</fpage>
        <lpage>303</lpage>
        <pub-id pub-id-type="doi">10.1101/gr.107524.110</pub-id>
        <pub-id pub-id-type="pmid">20644199</pub-id>
      </element-citation>
    </ref>
    <ref id="CR26">
      <label>26</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Koboldt</surname>
            <given-names>DC</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>Q</given-names>
          </name>
          <name>
            <surname>Larson</surname>
            <given-names>DE</given-names>
          </name>
          <name>
            <surname>Shen</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>McLellan</surname>
            <given-names>MD</given-names>
          </name>
          <name>
            <surname>Lin</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Miller</surname>
            <given-names>CA</given-names>
          </name>
          <name>
            <surname>Mardis</surname>
            <given-names>ER</given-names>
          </name>
          <name>
            <surname>Ding</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Wilson</surname>
            <given-names>RK</given-names>
          </name>
        </person-group>
        <article-title>Varscan 2: somatic mutation and copy number alteration discovery in cancer by exome sequencing</article-title>
        <source>Genome Res</source>
        <year>2012</year>
        <volume>22</volume>
        <issue>3</issue>
        <fpage>568</fpage>
        <lpage>76</lpage>
        <pub-id pub-id-type="doi">10.1101/gr.129684.111</pub-id>
        <pub-id pub-id-type="pmid">22300766</pub-id>
      </element-citation>
    </ref>
    <ref id="CR27">
      <label>27</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Andrews</surname>
            <given-names>S</given-names>
          </name>
          <etal/>
        </person-group>
        <source>FastQC: a quality control tool for high throughput sequence data</source>
        <year>2010</year>
        <publisher-loc>United Kingdom</publisher-loc>
        <publisher-name>Babraham Bioinformatics, Babraham Institute, Cambridge</publisher-name>
      </element-citation>
    </ref>
    <ref id="CR28">
      <label>28</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lefranc</surname>
            <given-names>M-P</given-names>
          </name>
          <name>
            <surname>Giudicelli</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Ginestoux</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Jabado-Michaloud</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Folch</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Bellahcene</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Wu</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Gemrot</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Brochet</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Lane</surname>
            <given-names>J</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Imgt®, the international immunogenetics information system®</article-title>
        <source>Nucleic Acids Res</source>
        <year>2009</year>
        <volume>37</volume>
        <issue>suppl_1</issue>
        <fpage>1006</fpage>
        <lpage>12</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/gkn838</pub-id>
      </element-citation>
    </ref>
    <ref id="CR29">
      <label>29</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Huang</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>McCarthy</surname>
            <given-names>DJ</given-names>
          </name>
          <name>
            <surname>Stegle</surname>
            <given-names>O</given-names>
          </name>
        </person-group>
        <article-title>Vireo: Bayesian demultiplexing of pooled single-cell rna-seq data without genotype reference</article-title>
        <source>Genome Biol</source>
        <year>2019</year>
        <volume>20</volume>
        <issue>1</issue>
        <fpage>273</fpage>
        <pub-id pub-id-type="doi">10.1186/s13059-019-1865-2</pub-id>
        <pub-id pub-id-type="pmid">31836005</pub-id>
      </element-citation>
    </ref>
    <ref id="CR30">
      <label>30</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Pielou</surname>
            <given-names>EC</given-names>
          </name>
        </person-group>
        <article-title>The measurement of diversity in different types of biological collections</article-title>
        <source>J Theor Biol</source>
        <year>1966</year>
        <volume>13</volume>
        <fpage>131</fpage>
        <lpage>44</lpage>
        <pub-id pub-id-type="doi">10.1016/0022-5193(66)90013-0</pub-id>
      </element-citation>
    </ref>
    <ref id="CR31">
      <label>31</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>McInnes</surname>
            <given-names>L</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>UMAP: Uniform Manifold Approximation and Projection</article-title>
        <source>J Open Source Softw</source>
        <year>2018</year>
        <volume>3</volume>
        <issue>29</issue>
        <fpage>861</fpage>
        <pub-id pub-id-type="doi">10.21105/joss.00861</pub-id>
      </element-citation>
    </ref>
    <ref id="CR32">
      <label>32</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Stuart</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Butler</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Hoffman</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Hafemeister</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Papalexi</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Mauck III</surname>
            <given-names>WM</given-names>
          </name>
          <name>
            <surname>Hao</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Stoeckius</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Smibert</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Satija</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>Comprehensive integration of single-cell data</article-title>
        <source>Cell</source>
        <year>2019</year>
        <volume>177</volume>
        <issue>7</issue>
        <fpage>1888</fpage>
        <lpage>902</lpage>
        <pub-id pub-id-type="doi">10.1016/j.cell.2019.05.031</pub-id>
        <pub-id pub-id-type="pmid">31178118</pub-id>
      </element-citation>
    </ref>
    <ref id="CR33">
      <label>33</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Handl</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Knowles</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Kell</surname>
            <given-names>DB</given-names>
          </name>
        </person-group>
        <article-title>Computational cluster validation in post-genomic data analysis</article-title>
        <source>Bioinforma</source>
        <year>2005</year>
        <volume>21</volume>
        <issue>15</issue>
        <fpage>3201</fpage>
        <lpage>12</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/bti517</pub-id>
      </element-citation>
    </ref>
    <ref id="CR34">
      <label>34</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Caliński</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Harabasz</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>A dendrite method for cluster analysis</article-title>
        <source>Commun Statistics-theory Methods</source>
        <year>1974</year>
        <volume>3</volume>
        <issue>1</issue>
        <fpage>1</fpage>
        <lpage>27</lpage>
        <pub-id pub-id-type="doi">10.1080/03610927408827101</pub-id>
      </element-citation>
    </ref>
    <ref id="CR35">
      <label>35</label>
      <mixed-citation publication-type="other">Halkidi M, Vazirgiannis M. Clustering validity assessment: finding the optimal partitioning of a data set. In: Proceedings of the First IEEE International Conference on Data Mining (ICDM’01). California: 2001. p. 187–94.</mixed-citation>
    </ref>
    <ref id="CR36">
      <label>36</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Dunn</surname>
            <given-names>JC</given-names>
          </name>
        </person-group>
        <article-title>Well-separated clusters and optimal fuzzy partitions</article-title>
        <source>J Cybern</source>
        <year>1974</year>
        <volume>4</volume>
        <issue>1</issue>
        <fpage>95</fpage>
        <lpage>104</lpage>
        <pub-id pub-id-type="doi">10.1080/01969727408546059</pub-id>
      </element-citation>
    </ref>
    <ref id="CR37">
      <label>37</label>
      <mixed-citation publication-type="other">Handl J, Knowles JD. Exploiting the trade-off— the benefits of multiple objectives in data clustering. In: Proceedings of the Third international conference on Evolutionary Multi-Criterion Optimization (EMO’05). Berlin: Springer-Verlag: 2005a. p. 547–60.</mixed-citation>
    </ref>
    <ref id="CR38">
      <label>38</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hassani</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Seidl</surname>
            <given-names>T</given-names>
          </name>
        </person-group>
        <article-title>Using internal evaluation measures to validate the quality of diverse stream clustering algorithms</article-title>
        <source>Vietnam J Comput Sci</source>
        <year>2017</year>
        <volume>4</volume>
        <issue>3</issue>
        <fpage>171</fpage>
        <lpage>83</lpage>
        <pub-id pub-id-type="doi">10.1007/s40595-016-0086-9</pub-id>
      </element-citation>
    </ref>
    <ref id="CR39">
      <label>39</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hubert</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Arabie</surname>
            <given-names>P</given-names>
          </name>
        </person-group>
        <article-title>Comparing partitions</article-title>
        <source>J Classif</source>
        <year>1985</year>
        <volume>2</volume>
        <issue>1</issue>
        <fpage>193</fpage>
        <lpage>218</lpage>
        <pub-id pub-id-type="doi">10.1007/BF01908075</pub-id>
      </element-citation>
    </ref>
    <ref id="CR40">
      <label>40</label>
      <mixed-citation publication-type="other">Cowell FA, Flachaire E. Statistical methods for distributional analysis. In: Handbook of income distribution, vol. 2. Elsevier: 2015. p. 359–465.</mixed-citation>
    </ref>
    <ref id="CR41">
      <label>41</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Shannon</surname>
            <given-names>CE</given-names>
          </name>
        </person-group>
        <article-title>A mathematical theory of communication</article-title>
        <source>Bell Syst Tech J</source>
        <year>1948</year>
        <volume>27</volume>
        <issue>3</issue>
        <fpage>379</fpage>
        <lpage>423</lpage>
        <pub-id pub-id-type="doi">10.1002/j.1538-7305.1948.tb01338.x</pub-id>
      </element-citation>
    </ref>
    <ref id="CR42">
      <label>42</label>
      <mixed-citation publication-type="other">Darvish Shafighi S, Kielbasa SM, Sepulveda-Yanez J, Monajemi R, Cats D, Mei H, Menafra R, Kloet S, Veelken H, van Bergen CAM, Szczure E. CACTUS source code. 2021. 10.5281/zenodo.4436176.</mixed-citation>
    </ref>
    <ref id="CR43">
      <label>43</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Villanueva</surname>
            <given-names>RAM</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>ZJ</given-names>
          </name>
        </person-group>
        <article-title>ggplot2: elegant graphics for data analysis, 2nd edition</article-title>
        <source>Meas-Interdiscip Res</source>
        <year>2019</year>
        <volume>17</volume>
        <fpage>160</fpage>
        <lpage>7</lpage>
      </element-citation>
    </ref>
    <ref id="CR44">
      <label>44</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Gu</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Eils</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Schlesner</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>Complex heatmaps reveal patterns and correlations in multidimensional genomic data</article-title>
        <source>Bioinforma</source>
        <year>2016</year>
        <volume>32</volume>
        <issue>18</issue>
        <fpage>2847</fpage>
        <lpage>9</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btw313</pub-id>
      </element-citation>
    </ref>
    <ref id="CR45">
      <label>45</label>
      <mixed-citation publication-type="other">Darvish Shafighi S, Kielbasa SM, Sepulveda-Yanez J, Monajemi R, Cats D, Mei H, Menafra R, Kloet S, Veelken H, van Bergen CAM, Szczure E. CACTUS input data. 2021. 10.5281/zenodo.4435061.</mixed-citation>
    </ref>
  </ref-list>
</back>
