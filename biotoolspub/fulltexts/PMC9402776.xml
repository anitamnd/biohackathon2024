<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName A++V2.4.dtd?>
<?SourceDTD.Version 2.4?>
<?ConverterInfo.XSLTName springer2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Drug Saf</journal-id>
    <journal-id journal-id-type="iso-abbrev">Drug Saf</journal-id>
    <journal-title-group>
      <journal-title>Drug Safety</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">0114-5916</issn>
    <issn pub-type="epub">1179-1942</issn>
    <publisher>
      <publisher-name>Springer International Publishing</publisher-name>
      <publisher-loc>Cham</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">9402776</article-id>
    <article-id pub-id-type="pmid">35840802</article-id>
    <article-id pub-id-type="publisher-id">1208</article-id>
    <article-id pub-id-type="doi">10.1007/s40264-022-01208-w</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Original Research Article</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>BAHAMA: A Bayesian Hierarchical Model for the Detection of MedDRA<sup>®</sup>-Coded Adverse Events in Randomized Controlled Trials</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-6295-7153</contrib-id>
        <name>
          <surname>Revers</surname>
          <given-names>Alma</given-names>
        </name>
        <address>
          <email>a.revers@amsterdamumc.nl</email>
        </address>
        <xref ref-type="aff" rid="Aff1"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Hof</surname>
          <given-names>Michel H.</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Zwinderman</surname>
          <given-names>Aeilko H.</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1"/>
      </contrib>
      <aff id="Aff1"><institution-wrap><institution-id institution-id-type="GRID">grid.7177.6</institution-id><institution-id institution-id-type="ISNI">0000000084992262</institution-id><institution>Epidemiology and Data Science (EDS), </institution><institution>Amsterdam UMC location University of Amsterdam, </institution></institution-wrap>Meibergdreef 9, Amsterdam, The Netherlands </aff>
    </contrib-group>
    <pub-date pub-type="epub">
      <day>15</day>
      <month>7</month>
      <year>2022</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>15</day>
      <month>7</month>
      <year>2022</year>
    </pub-date>
    <pub-date pub-type="ppub">
      <year>2022</year>
    </pub-date>
    <volume>45</volume>
    <issue>9</issue>
    <fpage>961</fpage>
    <lpage>970</lpage>
    <history>
      <date date-type="accepted">
        <day>29</day>
        <month>6</month>
        <year>2022</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2022</copyright-statement>
      <license>
        <ali:license_ref specific-use="textmining" content-type="ccbynclicense">https://creativecommons.org/licenses/by-nc/4.0/</ali:license_ref>
        <license-p><bold>Open Access</bold>This article is licensed under a Creative Commons Attribution-NonCommercial 4.0 International License, which permits any non-commercial use, sharing, adaptation, distribution and reproduction in any medium or format, as long as you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons licence, and indicate if changes were made. The images or other third party material in this article are included in the article's Creative Commons licence, unless indicated otherwise in a credit line to the material. If material is not included in the article's Creative Commons licence and your intended use is not permitted by statutory regulation or exceeds the permitted use, you will need to obtain permission directly from the copyright holder. To view a copy of this licence, visit <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by-nc/4.0/">http://creativecommons.org/licenses/by-nc/4.0/</ext-link>.</license-p>
      </license>
    </permissions>
    <abstract id="Abs1">
      <sec>
        <title>Introduction</title>
        <p id="Par1">Patients participating in randomized controlled trials (RCTs) are susceptible to a wide range of different adverse events (AE) during the RCT. MedDRA<sup><bold>®</bold></sup> is a hierarchical standardization terminology to structure the AEs reported in an RCT. The lowest level in the MedDRA hierarchy is a single medical event, and every higher level is the aggregation of the lower levels.</p>
      </sec>
      <sec>
        <title>Method</title>
        <p id="Par2">We propose a multi-stage Bayesian hierarchical Poisson model for estimating MedDRA<bold>-</bold>coded AE rate ratios (RRs). To deal with rare AEs, we introduce data aggregation at a higher level within the MedDRA structure and based on thresholds on incidence and MedDRA structure.</p>
      </sec>
      <sec>
        <title>Results</title>
        <p id="Par3">With simulations, we showed the effects of this data aggregation process and the method's performance. Furthermore, an application to a real example is provided and compared with other methods.</p>
      </sec>
      <sec>
        <title>Conclusion</title>
        <p id="Par4">We showed the benefit of using the full MedDRA structure and using aggregated data. The proposed model, as well as the pre-processing, is implemented in an R-package: BAHAMA.</p>
      </sec>
    </abstract>
    <custom-meta-group>
      <custom-meta>
        <meta-name>issue-copyright-statement</meta-name>
        <meta-value>© Springer Nature Switzerland AG 2022</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec id="d32e232">
    <title>Key Points</title>
    <p id="Par5">
      <table-wrap id="Taba">
        <table frame="hsides" rules="groups">
          <tbody>
            <tr>
              <td align="left">Introduction of a novel method for detecting safety signals for MedDRA-coded adverse events (AEs) in a randomized controlled trial.</td>
            </tr>
            <tr>
              <td align="left">BAHAMA can use the complete MedDRA structure to borrow strength between closely related AEs.</td>
            </tr>
          </tbody>
        </table>
      </table-wrap>
    </p>
  </sec>
  <sec id="Sec2">
    <title>Introduction</title>
    <p id="Par6">Randomized controlled trials (RCTs) are primarily designed and conducted to provide reliable estimates of the efficacy of an intervention. During an RCT, adverse events (AEs) are often collected along with the primary outcome. An AE is defined as “any untoward medical occurrence that may occur during treatment with a pharmaceutical product but does not necessarily have a causal relationship with this treatment” [<xref ref-type="bibr" rid="CR1">1</xref>]. It is important to identify/detect AEs with a higher incidence in the treatment group compared with the control population. In addition, AEs with a lower incidence in the treatment group compared with the control population are also important.</p>
    <p id="Par7">To structure the AEs, the Medical Dictionary for Regulatory Activities® (MedDRA) has been developed. MedDRA is a hierarchical standardization terminology reporting AEs in four levels [<xref ref-type="bibr" rid="CR2">2</xref>]. The lowest level, Preferred Terms (PTs), is a single type of medical event. PTs are aggregated into higher levels (i.e. Higher Level Terms [HLT], Higher Level Group Terms [HLGT] and System Organ Classes [SOC]). MedDRA has a multiaxial structure where a single lower level could be aggregated in multiple higher levels. The levels provide a grouping of the AEs based on anatomical, pathological, physiological, etiological, or functional similarities [<xref ref-type="bibr" rid="CR3">3</xref>]. It is therefore reasonable to assume that AEs closely related to each other by this MedDRA structure are affected similarly by a treatment or decease [<xref ref-type="bibr" rid="CR4">4</xref>].</p>
    <p id="Par8">The analysis of AEs is less straightforward than the single primary outcome. In general, the power calculations to determine the sample size of RCTs are not focused on AEs, and AEs are observed with low incidence rates. As a result, there is usually limited statistical power to detect rare AEs, leading to a high rate of false negatives. Moreover, testing many different AEs independently leads to a multiple testing problem. Corrections for the multiple testing such as the Bonferroni correction increases the false-negative rate, but this approach can be overly conservative [<xref ref-type="bibr" rid="CR5">5</xref>].</p>
    <p id="Par9">To deal with the multiple testing problem, Mehrotra and Heyse [<xref ref-type="bibr" rid="CR6">6</xref>] developed the double false discovery rate (Double FDR) approach. This approach uses two-step adjusted <italic>p</italic>-values based on the Benjamini and Hochberg FDR. A simplified explanation of the Double FDR approach is first to adjust the <italic>p</italic>-values of the SOCs and then to adjust the <italic>p</italic>-values within a SOC.</p>
    <p id="Par10">As an RCT is often not powered to detect AEs, we hypothesize that a Bayesian approach is useful. A Bayesian approach testing the null hypothesis of no difference between the treatment groups is based on the posterior probability of the incidence rate being higher than one [<xref ref-type="bibr" rid="CR4">4</xref>]. Several authors have proposed Bayesian methods but currently use only two MedDRA levels, the PT level and the primary SOC level, and a third prior level. The other MedDRA levels (mainly HLT and HLGT) are only used for data visualization, even though they may provide a clinically relevant grouping of PTs [<xref ref-type="bibr" rid="CR1">1</xref>, <xref ref-type="bibr" rid="CR4">4</xref>, <xref ref-type="bibr" rid="CR7">7</xref>–<xref ref-type="bibr" rid="CR9">9</xref>]. Berry and Berry [<xref ref-type="bibr" rid="CR10">10</xref>] proposed a three-stage Bayesian hierarchical model for analyzing AE data in clinical trials. They treat AE data as binary since most AEs occur so infrequently that a dichotomization per patient is reasonable. Next, they model AEs with a hierarchical structure under the condition that AEs under the same SOC are more similar and medically related than those under distinct SOCs. Xia et al. [<xref ref-type="bibr" rid="CR11">11</xref>] extended the Bayesian hierarchical model to a Poisson model to account for differences in treatment duration between treatment groups [<xref ref-type="bibr" rid="CR9">9</xref>].</p>
    <p id="Par11">A drawback of using only the PT and SOC levels in the hierarchical model is that with an increasing number of PTs, the performance of these three-stage Bayesian hierarchical models deteriorates [<xref ref-type="bibr" rid="CR11">11</xref>, <xref ref-type="bibr" rid="CR12">12</xref>]. The SOC covers many PTs, and these PTs are not necessarily strongly medically related. Another drawback of the model proposed by Berry and Berry [<xref ref-type="bibr" rid="CR10">10</xref>] is that recurring AEs within the same patient are excluded. To account for the recurring AEs, we propose using a Poisson distribution to model the AEs, using the total number of patients within a treatment group as an offset in the Poisson model. Furthermore, we propose using data aggregation for uncommon AEs at a higher level within the MedDRA structure. By using aggregated AE counts, even AEs with a very low incidence are taken into account. Furthermore, we propose to include the complete hierarchy.</p>
    <p id="Par12">In summary, we propose extending the hierarchy used by others to group the AEs to the complete hierarchy of the MedDRA. We developed our multi-stage hierarchical model, including the complete multiaxial MedDRA structure and developed a Bayesian algorithm to estimate posterior probabilities. We illustrated our model with AE data from a large RCT, and we compared results with other methods for analyzing AEs.</p>
  </sec>
  <sec id="Sec3">
    <title>Method</title>
    <p id="Par13">The MedDRA structure has four levels; the PT level, HLT level, HLGT level and the SOC level. Now, consider that we have count data from <inline-formula id="IEq1"><alternatives><tex-math id="M1">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$N_{4}$$\end{document}</tex-math><mml:math id="M2"><mml:msub><mml:mi>N</mml:mi><mml:mn>4</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="40264_2022_1208_Article_IEq1.gif"/></alternatives></inline-formula> AEs at the PT level (4th MedDRA level). The numbers of AEs in the control group are given by <inline-formula id="IEq2"><alternatives><tex-math id="M3">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$Y^{{\left( {0,4} \right)}} = \left( {y_{1}^{{\left( {0,4} \right)}} \ldots y_{i}^{{\left( {0,4} \right)}} \ldots .y_{{N_{4} }}^{{\left( {0,4} \right)}} } \right)$$\end{document}</tex-math><mml:math id="M4"><mml:mrow><mml:msup><mml:mi>Y</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>4</mml:mn></mml:mrow></mml:mfenced></mml:msup><mml:mo>=</mml:mo><mml:mfenced close=")" open="("><mml:mrow><mml:msubsup><mml:mi>y</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mfenced close=")" open="("><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>4</mml:mn></mml:mrow></mml:mfenced></mml:msubsup><mml:mo>…</mml:mo><mml:msubsup><mml:mi>y</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mfenced close=")" open="("><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>4</mml:mn></mml:mrow></mml:mfenced></mml:msubsup><mml:mo>…</mml:mo><mml:mo>.</mml:mo><mml:msubsup><mml:mi>y</mml:mi><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mn>4</mml:mn></mml:msub></mml:mrow><mml:mfenced close=")" open="("><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>4</mml:mn></mml:mrow></mml:mfenced></mml:msubsup></mml:mrow></mml:mfenced></mml:mrow></mml:math><inline-graphic xlink:href="40264_2022_1208_Article_IEq2.gif"/></alternatives></inline-formula> and AEs in the treatment group by <inline-formula id="IEq3"><alternatives><tex-math id="M5">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$Y^{{\left( {1,4} \right)}} = \left( {y_{1}^{{\left( {1,4} \right)}} \ldots y_{i}^{{\left( {1,4} \right)}} \ldots . y_{{N_{4} }}^{{\left( {1,4} \right)}} } \right)$$\end{document}</tex-math><mml:math id="M6"><mml:mrow><mml:msup><mml:mi>Y</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>4</mml:mn></mml:mrow></mml:mfenced></mml:msup><mml:mo>=</mml:mo><mml:mfenced close=")" open="("><mml:mrow><mml:msubsup><mml:mi>y</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mfenced close=")" open="("><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>4</mml:mn></mml:mrow></mml:mfenced></mml:msubsup><mml:mo>…</mml:mo><mml:msubsup><mml:mi>y</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mfenced close=")" open="("><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>4</mml:mn></mml:mrow></mml:mfenced></mml:msubsup><mml:mo>…</mml:mo><mml:mo>.</mml:mo><mml:msubsup><mml:mi>y</mml:mi><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mn>4</mml:mn></mml:msub></mml:mrow><mml:mfenced close=")" open="("><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>4</mml:mn></mml:mrow></mml:mfenced></mml:msubsup></mml:mrow></mml:mfenced></mml:mrow></mml:math><inline-graphic xlink:href="40264_2022_1208_Article_IEq3.gif"/></alternatives></inline-formula>. We assume that the PT-level AE count <inline-formula id="IEq4"><alternatives><tex-math id="M7">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$y_{i}^{{\left( {x,4} \right)}}$$\end{document}</tex-math><mml:math id="M8"><mml:msubsup><mml:mi>y</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mfenced close=")" open="("><mml:mrow><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mn>4</mml:mn></mml:mrow></mml:mfenced></mml:msubsup></mml:math><inline-graphic xlink:href="40264_2022_1208_Article_IEq4.gif"/></alternatives></inline-formula>, where <inline-formula id="IEq5"><alternatives><tex-math id="M9">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$x \in 0,1$$\end{document}</tex-math><mml:math id="M10"><mml:mrow><mml:mi>x</mml:mi><mml:mo>∈</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="40264_2022_1208_Article_IEq5.gif"/></alternatives></inline-formula> and <inline-formula id="IEq6"><alternatives><tex-math id="M11">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$i = 1 \ldots N_{4}$$\end{document}</tex-math><mml:math id="M12"><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>…</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mn>4</mml:mn></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="40264_2022_1208_Article_IEq6.gif"/></alternatives></inline-formula>, follows a Poisson distribution, that is,<disp-formula id="Equa"><alternatives><tex-math id="M13">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$y_{i}^{{\left( {x,4} \right)}} \sim {\text{Poisson}}\left( {\lambda_{i}^{{\left( {x,4} \right)}} } \right),$$\end{document}</tex-math><mml:math id="M14" display="block"><mml:mrow><mml:msubsup><mml:mi>y</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mfenced close=")" open="("><mml:mrow><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mn>4</mml:mn></mml:mrow></mml:mfenced></mml:msubsup><mml:mo>∼</mml:mo><mml:mtext>Poisson</mml:mtext><mml:mfenced close=")" open="("><mml:msubsup><mml:mi>λ</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mfenced close=")" open="("><mml:mrow><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mn>4</mml:mn></mml:mrow></mml:mfenced></mml:msubsup></mml:mfenced><mml:mo>,</mml:mo></mml:mrow></mml:math><graphic xlink:href="40264_2022_1208_Article_Equa.gif" position="anchor"/></alternatives></disp-formula> where the intensity parameter <inline-formula id="IEq7"><alternatives><tex-math id="M15">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\lambda_{i}^{{\left( {x,4} \right)}}$$\end{document}</tex-math><mml:math id="M16"><mml:msubsup><mml:mi>λ</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mfenced close=")" open="("><mml:mrow><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mn>4</mml:mn></mml:mrow></mml:mfenced></mml:msubsup></mml:math><inline-graphic xlink:href="40264_2022_1208_Article_IEq7.gif"/></alternatives></inline-formula> is a function of a treatment-indicator variable <inline-formula id="IEq8"><alternatives><tex-math id="M17">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$x$$\end{document}</tex-math><mml:math id="M18"><mml:mi>x</mml:mi></mml:math><inline-graphic xlink:href="40264_2022_1208_Article_IEq8.gif"/></alternatives></inline-formula> and, if necessary, possible other covariates. The log intensity is given by<disp-formula id="Equb"><alternatives><tex-math id="M19">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\text{log}}\left( {\lambda_{i}^{{\left( {x,4} \right)}} } \right) = a_{i} + b_{i} \times x + {\text{log}}\left( {N^{x} } \right),$$\end{document}</tex-math><mml:math id="M20" display="block"><mml:mrow><mml:mtext>log</mml:mtext><mml:mfenced close=")" open="("><mml:msubsup><mml:mi>λ</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mfenced close=")" open="("><mml:mrow><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mn>4</mml:mn></mml:mrow></mml:mfenced></mml:msubsup></mml:mfenced><mml:mo>=</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>b</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>×</mml:mo><mml:mi>x</mml:mi><mml:mo>+</mml:mo><mml:mtext>log</mml:mtext><mml:mfenced close=")" open="("><mml:msup><mml:mi>N</mml:mi><mml:mi>x</mml:mi></mml:msup></mml:mfenced><mml:mo>,</mml:mo></mml:mrow></mml:math><graphic xlink:href="40264_2022_1208_Article_Equb.gif" position="anchor"/></alternatives></disp-formula>
where the parameter <inline-formula id="IEq9"><alternatives><tex-math id="M21">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$a_{i}$$\end{document}</tex-math><mml:math id="M22"><mml:msub><mml:mi>a</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="40264_2022_1208_Article_IEq9.gif"/></alternatives></inline-formula> describes the log intensity of PT <inline-formula id="IEq10"><alternatives><tex-math id="M23">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$i$$\end{document}</tex-math><mml:math id="M24"><mml:mi>i</mml:mi></mml:math><inline-graphic xlink:href="40264_2022_1208_Article_IEq10.gif"/></alternatives></inline-formula> in the control group and <inline-formula id="IEq11"><alternatives><tex-math id="M25">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$a_{i} + b_{i}$$\end{document}</tex-math><mml:math id="M26"><mml:mrow><mml:msub><mml:mi>a</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>b</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="40264_2022_1208_Article_IEq11.gif"/></alternatives></inline-formula> similarly in the treatment group. Note that <inline-formula id="IEq12"><alternatives><tex-math id="M27">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$b_{i}$$\end{document}</tex-math><mml:math id="M28"><mml:msub><mml:mi>b</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="40264_2022_1208_Article_IEq12.gif"/></alternatives></inline-formula> is the log rate ratio (log RR). To adjust for an unequal number of subjects within each treatment group, an offset log(<inline-formula id="IEq13"><alternatives><tex-math id="M29">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$N^{x} )$$\end{document}</tex-math><mml:math id="M30"><mml:mrow><mml:msup><mml:mi>N</mml:mi><mml:mi>x</mml:mi></mml:msup><mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="40264_2022_1208_Article_IEq13.gif"/></alternatives></inline-formula> is used, where <inline-formula id="IEq14"><alternatives><tex-math id="M31">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$N^{x}$$\end{document}</tex-math><mml:math id="M32"><mml:msup><mml:mi>N</mml:mi><mml:mi>x</mml:mi></mml:msup></mml:math><inline-graphic xlink:href="40264_2022_1208_Article_IEq14.gif"/></alternatives></inline-formula> is the number of subjects within each group.</p>
    <p id="Par16">The PT-level adverse events are clustered at the HLT level (3rd MedDRA level). To use this clustering of AEs, we define a random-effects model for parameters <inline-formula id="IEq15"><alternatives><tex-math id="M33">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$a_{i}$$\end{document}</tex-math><mml:math id="M34"><mml:msub><mml:mi>a</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="40264_2022_1208_Article_IEq15.gif"/></alternatives></inline-formula> and <inline-formula id="IEq16"><alternatives><tex-math id="M35">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$b_{i}$$\end{document}</tex-math><mml:math id="M36"><mml:msub><mml:mi>b</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="40264_2022_1208_Article_IEq16.gif"/></alternatives></inline-formula>. We assume that the parameters from adverse event <inline-formula id="IEq17"><alternatives><tex-math id="M37">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$i$$\end{document}</tex-math><mml:math id="M38"><mml:mi>i</mml:mi></mml:math><inline-graphic xlink:href="40264_2022_1208_Article_IEq17.gif"/></alternatives></inline-formula> follow a bivariate normal distribution with mean and covariance matrix depending on the HLT level, that is,<disp-formula id="Equc"><alternatives><tex-math id="M39">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\left( {a_{i} , b_{i} } \right)\sim N\left( {\mathop \sum \limits_{j = 1}^{{N_{3} }} W_{ij}^{\left( 3 \right)} \mu_{j}^{\left( 3 \right)} , \mathop \sum \limits_{j = 1}^{{N_{3} }} W_{ij}^{\left( 3 \right)} {\Sigma }_{j}^{\left( 3 \right)} } \right),$$\end{document}</tex-math><mml:math id="M40" display="block"><mml:mrow><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mi>a</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>b</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mfenced><mml:mo>∼</mml:mo><mml:mi>N</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:munderover><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mn>3</mml:mn></mml:msub></mml:munderover><mml:msubsup><mml:mi>W</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow><mml:mfenced close=")" open="("><mml:mn>3</mml:mn></mml:mfenced></mml:msubsup><mml:msubsup><mml:mi>μ</mml:mi><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mfenced close=")" open="("><mml:mn>3</mml:mn></mml:mfenced></mml:msubsup><mml:mo>,</mml:mo><mml:munderover><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mn>3</mml:mn></mml:msub></mml:munderover><mml:msubsup><mml:mi>W</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow><mml:mfenced close=")" open="("><mml:mn>3</mml:mn></mml:mfenced></mml:msubsup><mml:msubsup><mml:mi mathvariant="normal">Σ</mml:mi><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mfenced close=")" open="("><mml:mn>3</mml:mn></mml:mfenced></mml:msubsup></mml:mrow></mml:mfenced><mml:mo>,</mml:mo></mml:mrow></mml:math><graphic xlink:href="40264_2022_1208_Article_Equc.gif" position="anchor"/></alternatives></disp-formula>
where <inline-formula id="IEq18"><alternatives><tex-math id="M41">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$W_{ij}^{\left( 3 \right)}$$\end{document}</tex-math><mml:math id="M42"><mml:msubsup><mml:mi>W</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow><mml:mfenced close=")" open="("><mml:mn>3</mml:mn></mml:mfenced></mml:msubsup></mml:math><inline-graphic xlink:href="40264_2022_1208_Article_IEq18.gif"/></alternatives></inline-formula> is a (fixed) weight indicating membership of PT <inline-formula id="IEq19"><alternatives><tex-math id="M43">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$i$$\end{document}</tex-math><mml:math id="M44"><mml:mi>i</mml:mi></mml:math><inline-graphic xlink:href="40264_2022_1208_Article_IEq19.gif"/></alternatives></inline-formula> in HLT <inline-formula id="IEq20"><alternatives><tex-math id="M45">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$j$$\end{document}</tex-math><mml:math id="M46"><mml:mi>j</mml:mi></mml:math><inline-graphic xlink:href="40264_2022_1208_Article_IEq20.gif"/></alternatives></inline-formula>
<inline-formula id="IEq21"><alternatives><tex-math id="M47">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\left( {j = 1 \ldots N_{3} } \right)$$\end{document}</tex-math><mml:math id="M48"><mml:mfenced close=")" open="("><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>…</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mn>3</mml:mn></mml:msub></mml:mrow></mml:mfenced></mml:math><inline-graphic xlink:href="40264_2022_1208_Article_IEq21.gif"/></alternatives></inline-formula>. In addition, <inline-formula id="IEq22"><alternatives><tex-math id="M49">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mu_{j}^{\left( 3 \right)}$$\end{document}</tex-math><mml:math id="M50"><mml:msubsup><mml:mi>μ</mml:mi><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mfenced close=")" open="("><mml:mn>3</mml:mn></mml:mfenced></mml:msubsup></mml:math><inline-graphic xlink:href="40264_2022_1208_Article_IEq22.gif"/></alternatives></inline-formula> are the average log intensity of the control group and log RR of the PTs in the same HLT category and <inline-formula id="IEq23"><alternatives><tex-math id="M51">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\Sigma }_{j}^{\left( 3 \right)}$$\end{document}</tex-math><mml:math id="M52"><mml:msubsup><mml:mi mathvariant="normal">Σ</mml:mi><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mfenced close=")" open="("><mml:mn>3</mml:mn></mml:mfenced></mml:msubsup></mml:math><inline-graphic xlink:href="40264_2022_1208_Article_IEq23.gif"/></alternatives></inline-formula> is the dispersion of PTs in the same HLT category.</p>
    <p id="Par18">For the higher MedDRA levels (HLGT and SOC MedDRA levels), we repeat the same procedure:<disp-formula id="Equd"><alternatives><tex-math id="M53">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mu_{j}^{\left( 3 \right)} \sim N\left( {\mathop \sum \limits_{k = 1}^{{N_{2} }} W_{jk}^{\left( 2 \right)} \mu_{k}^{\left( 2 \right)} , \mathop \sum \limits_{k = 1}^{{N_{2} }} W_{jk}^{\left( 2 \right)} {\Sigma }_{k}^{\left( 2 \right)} } \right),$$\end{document}</tex-math><mml:math id="M54" display="block"><mml:mrow><mml:msubsup><mml:mi>μ</mml:mi><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mfenced close=")" open="("><mml:mn>3</mml:mn></mml:mfenced></mml:msubsup><mml:mo>∼</mml:mo><mml:mi>N</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:munderover><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:munderover><mml:msubsup><mml:mi>W</mml:mi><mml:mrow><mml:mi mathvariant="italic">jk</mml:mi></mml:mrow><mml:mfenced close=")" open="("><mml:mn>2</mml:mn></mml:mfenced></mml:msubsup><mml:msubsup><mml:mi>μ</mml:mi><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mfenced close=")" open="("><mml:mn>2</mml:mn></mml:mfenced></mml:msubsup><mml:mo>,</mml:mo><mml:munderover><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:munderover><mml:msubsup><mml:mi>W</mml:mi><mml:mrow><mml:mi mathvariant="italic">jk</mml:mi></mml:mrow><mml:mfenced close=")" open="("><mml:mn>2</mml:mn></mml:mfenced></mml:msubsup><mml:msubsup><mml:mi mathvariant="normal">Σ</mml:mi><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mfenced close=")" open="("><mml:mn>2</mml:mn></mml:mfenced></mml:msubsup></mml:mrow></mml:mfenced><mml:mo>,</mml:mo></mml:mrow></mml:math><graphic xlink:href="40264_2022_1208_Article_Equd.gif" position="anchor"/></alternatives></disp-formula>
where <inline-formula id="IEq24"><alternatives><tex-math id="M55">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$W_{jk}^{\left( 2 \right)}$$\end{document}</tex-math><mml:math id="M56"><mml:msubsup><mml:mi>W</mml:mi><mml:mrow><mml:mi mathvariant="italic">jk</mml:mi></mml:mrow><mml:mfenced close=")" open="("><mml:mn>2</mml:mn></mml:mfenced></mml:msubsup></mml:math><inline-graphic xlink:href="40264_2022_1208_Article_IEq24.gif"/></alternatives></inline-formula> is a (fixed) weight indicating membership of HLT <inline-formula id="IEq25"><alternatives><tex-math id="M57">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$j$$\end{document}</tex-math><mml:math id="M58"><mml:mi>j</mml:mi></mml:math><inline-graphic xlink:href="40264_2022_1208_Article_IEq25.gif"/></alternatives></inline-formula> in HLGT <inline-formula id="IEq26"><alternatives><tex-math id="M59">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$k$$\end{document}</tex-math><mml:math id="M60"><mml:mi>k</mml:mi></mml:math><inline-graphic xlink:href="40264_2022_1208_Article_IEq26.gif"/></alternatives></inline-formula> (<inline-formula id="IEq27"><alternatives><tex-math id="M61">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$k = 1 \ldots N_{2} )$$\end{document}</tex-math><mml:math id="M62"><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>…</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="40264_2022_1208_Article_IEq27.gif"/></alternatives></inline-formula>. The parameters <inline-formula id="IEq28"><alternatives><tex-math id="M63">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mu_{k}^{\left( 2 \right)}$$\end{document}</tex-math><mml:math id="M64"><mml:msubsup><mml:mi>μ</mml:mi><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mfenced close=")" open="("><mml:mn>2</mml:mn></mml:mfenced></mml:msubsup></mml:math><inline-graphic xlink:href="40264_2022_1208_Article_IEq28.gif"/></alternatives></inline-formula> and <inline-formula id="IEq29"><alternatives><tex-math id="M65">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\Sigma }_{k}^{\left( 2 \right)}$$\end{document}</tex-math><mml:math id="M66"><mml:msubsup><mml:mi mathvariant="normal">Σ</mml:mi><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mfenced close=")" open="("><mml:mn>2</mml:mn></mml:mfenced></mml:msubsup></mml:math><inline-graphic xlink:href="40264_2022_1208_Article_IEq29.gif"/></alternatives></inline-formula> are the averages and dispersion of HLTs in the same HLGT category and are given by<disp-formula id="Eque"><alternatives><tex-math id="M67">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mu_{k}^{\left( 2 \right)} \sim N\left( {\mathop \sum \limits_{l = 1}^{{N_{1} }} W_{kl}^{\left( 1 \right)} \mu_{l}^{\left( 1 \right)} , \mathop \sum \limits_{l = 1}^{{N_{1} }} W_{kl}^{\left( 1 \right)} {\Sigma }_{l}^{\left( 1 \right)} } \right),$$\end{document}</tex-math><mml:math id="M68" display="block"><mml:mrow><mml:msubsup><mml:mi>μ</mml:mi><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mfenced close=")" open="("><mml:mn>2</mml:mn></mml:mfenced></mml:msubsup><mml:mo>∼</mml:mo><mml:mi>N</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:munderover><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mi>l</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:munderover><mml:msubsup><mml:mi>W</mml:mi><mml:mrow><mml:mi mathvariant="italic">kl</mml:mi></mml:mrow><mml:mfenced close=")" open="("><mml:mn>1</mml:mn></mml:mfenced></mml:msubsup><mml:msubsup><mml:mi>μ</mml:mi><mml:mrow><mml:mi>l</mml:mi></mml:mrow><mml:mfenced close=")" open="("><mml:mn>1</mml:mn></mml:mfenced></mml:msubsup><mml:mo>,</mml:mo><mml:munderover><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mi>l</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:munderover><mml:msubsup><mml:mi>W</mml:mi><mml:mrow><mml:mi mathvariant="italic">kl</mml:mi></mml:mrow><mml:mfenced close=")" open="("><mml:mn>1</mml:mn></mml:mfenced></mml:msubsup><mml:msubsup><mml:mi mathvariant="normal">Σ</mml:mi><mml:mrow><mml:mi>l</mml:mi></mml:mrow><mml:mfenced close=")" open="("><mml:mn>1</mml:mn></mml:mfenced></mml:msubsup></mml:mrow></mml:mfenced><mml:mo>,</mml:mo></mml:mrow></mml:math><graphic xlink:href="40264_2022_1208_Article_Eque.gif" position="anchor"/></alternatives></disp-formula>
where <inline-formula id="IEq30"><alternatives><tex-math id="M69">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$W_{kl}^{\left( 1 \right)}$$\end{document}</tex-math><mml:math id="M70"><mml:msubsup><mml:mi>W</mml:mi><mml:mrow><mml:mi mathvariant="italic">kl</mml:mi></mml:mrow><mml:mfenced close=")" open="("><mml:mn>1</mml:mn></mml:mfenced></mml:msubsup></mml:math><inline-graphic xlink:href="40264_2022_1208_Article_IEq30.gif"/></alternatives></inline-formula> is a (fixed) weight indicating membership of HLGT <inline-formula id="IEq31"><alternatives><tex-math id="M71">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$k$$\end{document}</tex-math><mml:math id="M72"><mml:mi>k</mml:mi></mml:math><inline-graphic xlink:href="40264_2022_1208_Article_IEq31.gif"/></alternatives></inline-formula> in SOC <inline-formula id="IEq32"><alternatives><tex-math id="M73">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$l$$\end{document}</tex-math><mml:math id="M74"><mml:mi>l</mml:mi></mml:math><inline-graphic xlink:href="40264_2022_1208_Article_IEq32.gif"/></alternatives></inline-formula> (<inline-formula id="IEq33"><alternatives><tex-math id="M75">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\text{l}} = 1 \ldots N_{1} )$$\end{document}</tex-math><mml:math id="M76"><mml:mrow><mml:mtext>l</mml:mtext><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>…</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="40264_2022_1208_Article_IEq33.gif"/></alternatives></inline-formula>. In addition, <inline-formula id="IEq34"><alternatives><tex-math id="M77">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mu_{l}^{\left( 1 \right)}$$\end{document}</tex-math><mml:math id="M78"><mml:msubsup><mml:mi>μ</mml:mi><mml:mrow><mml:mi>l</mml:mi></mml:mrow><mml:mfenced close=")" open="("><mml:mn>1</mml:mn></mml:mfenced></mml:msubsup></mml:math><inline-graphic xlink:href="40264_2022_1208_Article_IEq34.gif"/></alternatives></inline-formula> and <inline-formula id="IEq35"><alternatives><tex-math id="M79">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\Sigma }_{l}^{\left( 1 \right)}$$\end{document}</tex-math><mml:math id="M80"><mml:msubsup><mml:mi mathvariant="normal">Σ</mml:mi><mml:mrow><mml:mi>l</mml:mi></mml:mrow><mml:mfenced close=")" open="("><mml:mn>1</mml:mn></mml:mfenced></mml:msubsup></mml:math><inline-graphic xlink:href="40264_2022_1208_Article_IEq35.gif"/></alternatives></inline-formula> are the averages and dispersion of HLGTs in the same SOC category.</p>
    <p id="Par21">For the SOC-level log intensity of the control group and log RR we assume a bivariate normal distribution <inline-formula id="IEq36"><alternatives><tex-math id="M81">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mu_{l}^{\left( 1 \right)} \sim N\left( {\mu^{\left( 0 \right)} ,{\Sigma }^{\left( 0 \right)} } \right)$$\end{document}</tex-math><mml:math id="M82"><mml:mrow><mml:msubsup><mml:mi>μ</mml:mi><mml:mrow><mml:mi>l</mml:mi></mml:mrow><mml:mfenced close=")" open="("><mml:mn>1</mml:mn></mml:mfenced></mml:msubsup><mml:mo>∼</mml:mo><mml:mi>N</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:msup><mml:mi>μ</mml:mi><mml:mfenced close=")" open="("><mml:mn>0</mml:mn></mml:mfenced></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="normal">Σ</mml:mi></mml:mrow><mml:mfenced close=")" open="("><mml:mn>0</mml:mn></mml:mfenced></mml:msup></mml:mrow></mml:mfenced></mml:mrow></mml:math><inline-graphic xlink:href="40264_2022_1208_Article_IEq36.gif"/></alternatives></inline-formula>. We assume <inline-formula id="IEq37"><alternatives><tex-math id="M83">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\Sigma }_{j}^{\left( 3 \right)} , {\Sigma }_{k}^{\left( 2 \right)}$$\end{document}</tex-math><mml:math id="M84"><mml:mrow><mml:msubsup><mml:mi mathvariant="normal">Σ</mml:mi><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mfenced close=")" open="("><mml:mn>3</mml:mn></mml:mfenced></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi mathvariant="normal">Σ</mml:mi><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mfenced close=")" open="("><mml:mn>2</mml:mn></mml:mfenced></mml:msubsup></mml:mrow></mml:math><inline-graphic xlink:href="40264_2022_1208_Article_IEq37.gif"/></alternatives></inline-formula> and <inline-formula id="IEq38"><alternatives><tex-math id="M85">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\Sigma }_{l}^{\left( 1 \right)}$$\end{document}</tex-math><mml:math id="M86"><mml:msubsup><mml:mi mathvariant="normal">Σ</mml:mi><mml:mrow><mml:mi>l</mml:mi></mml:mrow><mml:mfenced close=")" open="("><mml:mn>1</mml:mn></mml:mfenced></mml:msubsup></mml:math><inline-graphic xlink:href="40264_2022_1208_Article_IEq38.gif"/></alternatives></inline-formula> to be diagonal, and therefore do not model the correlation between log intensity parameters and all elements to have weakly informative exponential prior distribution <inline-formula id="IEq39"><alternatives><tex-math id="M87">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\left( {{\text{Exp}}\left( 1 \right)} \right)$$\end{document}</tex-math><mml:math id="M88"><mml:mfenced close=")" open="("><mml:mrow><mml:mtext>Exp</mml:mtext><mml:mfenced close=")" open="("><mml:mn>1</mml:mn></mml:mfenced></mml:mrow></mml:mfenced></mml:math><inline-graphic xlink:href="40264_2022_1208_Article_IEq39.gif"/></alternatives></inline-formula>.</p>
    <p id="Par22">We use a Bayesian estimation framework and therefore specified prior distributions of the <inline-formula id="IEq40"><alternatives><tex-math id="M89">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mu^{\left( 0 \right)}$$\end{document}</tex-math><mml:math id="M90"><mml:msup><mml:mi>μ</mml:mi><mml:mfenced close=")" open="("><mml:mn>0</mml:mn></mml:mfenced></mml:msup></mml:math><inline-graphic xlink:href="40264_2022_1208_Article_IEq40.gif"/></alternatives></inline-formula>
<inline-formula id="IEq41"><alternatives><tex-math id="M91">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$( N\left( {0,1} \right)$$\end{document}</tex-math><mml:math id="M92"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>N</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfenced></mml:mrow></mml:math><inline-graphic xlink:href="40264_2022_1208_Article_IEq41.gif"/></alternatives></inline-formula>) and again, we assume <inline-formula id="IEq42"><alternatives><tex-math id="M93">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\Sigma }^{\left( 0 \right)}$$\end{document}</tex-math><mml:math id="M94"><mml:msup><mml:mrow><mml:mi mathvariant="normal">Σ</mml:mi></mml:mrow><mml:mfenced close=")" open="("><mml:mn>0</mml:mn></mml:mfenced></mml:msup></mml:math><inline-graphic xlink:href="40264_2022_1208_Article_IEq42.gif"/></alternatives></inline-formula> to be diagonal and all elements to have an exponential prior distribution <inline-formula id="IEq43"><alternatives><tex-math id="M95">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\left( {{\text{Exp}}\left( 1 \right)} \right)$$\end{document}</tex-math><mml:math id="M96"><mml:mfenced close=")" open="("><mml:mrow><mml:mtext>Exp</mml:mtext><mml:mfenced close=")" open="("><mml:mn>1</mml:mn></mml:mfenced></mml:mrow></mml:mfenced></mml:math><inline-graphic xlink:href="40264_2022_1208_Article_IEq43.gif"/></alternatives></inline-formula>.</p>
  </sec>
  <sec id="Sec4">
    <title>Extensions for More Complex Data</title>
    <p id="Par23">We extend the model to include the multiaxiality of the MedDRA structure, and to deal with the low incidence of some PTs, we introduce data aggregation.</p>
    <sec id="Sec5">
      <title>Multiaxiality of the MedDRA Structure</title>
      <p id="Par24">In section 2 we defined the hierarchical MedDRA structure with the three matrices <inline-formula id="IEq44"><alternatives><tex-math id="M97">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$W_{{}}^{\left( 3 \right)} , W_{{}}^{\left( 2 \right)}$$\end{document}</tex-math><mml:math id="M98"><mml:mrow><mml:msubsup><mml:mi>W</mml:mi><mml:mrow><mml:mrow/></mml:mrow><mml:mfenced close=")" open="("><mml:mn>3</mml:mn></mml:mfenced></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>W</mml:mi><mml:mrow><mml:mrow/></mml:mrow><mml:mfenced close=")" open="("><mml:mn>2</mml:mn></mml:mfenced></mml:msubsup></mml:mrow></mml:math><inline-graphic xlink:href="40264_2022_1208_Article_IEq44.gif"/></alternatives></inline-formula>, and <inline-formula id="IEq45"><alternatives><tex-math id="M99">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$W_{{}}^{\left( 1 \right)}$$\end{document}</tex-math><mml:math id="M100"><mml:msubsup><mml:mi>W</mml:mi><mml:mrow><mml:mrow/></mml:mrow><mml:mfenced close=")" open="("><mml:mn>1</mml:mn></mml:mfenced></mml:msubsup></mml:math><inline-graphic xlink:href="40264_2022_1208_Article_IEq45.gif"/></alternatives></inline-formula>. When no multiaxiality is present, all PTs, HLTs, and HLGTs can only belong to a single HLT, HLGT, or SOC, respectively. In this case, the three corresponding weight matrices consist of binary indicators. The sum of all rows of these matrices must be one.</p>
      <p id="Par25">To deal with multiaxiality, we propose to modify the matrices <inline-formula id="IEq46"><alternatives><tex-math id="M101">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$W_{{}}^{\left( 3 \right)} , W_{{}}^{\left( 2 \right)}$$\end{document}</tex-math><mml:math id="M102"><mml:mrow><mml:msubsup><mml:mi>W</mml:mi><mml:mrow><mml:mrow/></mml:mrow><mml:mfenced close=")" open="("><mml:mn>3</mml:mn></mml:mfenced></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>W</mml:mi><mml:mrow><mml:mrow/></mml:mrow><mml:mfenced close=")" open="("><mml:mn>2</mml:mn></mml:mfenced></mml:msubsup></mml:mrow></mml:math><inline-graphic xlink:href="40264_2022_1208_Article_IEq46.gif"/></alternatives></inline-formula>, and <inline-formula id="IEq47"><alternatives><tex-math id="M103">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$W_{{}}^{\left( 1 \right)}$$\end{document}</tex-math><mml:math id="M104"><mml:msubsup><mml:mi>W</mml:mi><mml:mrow><mml:mrow/></mml:mrow><mml:mfenced close=")" open="("><mml:mn>1</mml:mn></mml:mfenced></mml:msubsup></mml:math><inline-graphic xlink:href="40264_2022_1208_Article_IEq47.gif"/></alternatives></inline-formula> such that PTs, HLTs, and HLGTs can belong to multiple parents. Instead of binary indicators, we allow all matrices to contain weights between zero and one. The sums of memberships of all PTs, HLTs, and HLGTs must still sum up to one. A simple example of a weight matrix is:<disp-formula id="Equf"><alternatives><tex-math id="M105">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{array}{*{20}c} {} &amp; {{\text{HLT}}\;1} &amp; {{\text{HLT}}\;2} &amp; {{\text{HLT}}\;3} &amp; {{\text{HLT}}\;4} \\ {{\text{PT}}\;1} &amp; 1 &amp; 0 &amp; 0 &amp; 0 \\ {{\text{PT}}\;2} &amp; 1 &amp; 0 &amp; 0 &amp; 0 \\ {{\text{PT}}\;3} &amp; 0 &amp; 1 &amp; 0 &amp; 0 \\ {{\text{PT}}\;4} &amp; 0 &amp; 0 &amp; 1 &amp; 0 \\ {PT\;5} &amp; 0 &amp; 0 &amp; {0.5} &amp; {0.5} \\ {{\text{PT }}\;6} &amp; 0 &amp; 0 &amp; 0 &amp; 1 \\ \end{array}$$\end{document}</tex-math><mml:math id="M106" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow/></mml:mtd><mml:mtd><mml:mrow><mml:mtext>HLT</mml:mtext><mml:mspace width="0.277778em"/><mml:mn>1</mml:mn></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mtext>HLT</mml:mtext><mml:mspace width="0.277778em"/><mml:mn>2</mml:mn></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mtext>HLT</mml:mtext><mml:mspace width="0.277778em"/><mml:mn>3</mml:mn></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mtext>HLT</mml:mtext><mml:mspace width="0.277778em"/><mml:mn>4</mml:mn></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mrow/><mml:mrow><mml:mtext>PT</mml:mtext><mml:mspace width="0.277778em"/><mml:mn>1</mml:mn></mml:mrow></mml:mrow></mml:mtd><mml:mtd><mml:mn>1</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mrow/><mml:mrow><mml:mtext>PT</mml:mtext><mml:mspace width="0.277778em"/><mml:mn>2</mml:mn></mml:mrow></mml:mrow></mml:mtd><mml:mtd><mml:mn>1</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mrow/><mml:mrow><mml:mtext>PT</mml:mtext><mml:mspace width="0.277778em"/><mml:mn>3</mml:mn></mml:mrow></mml:mrow></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>1</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mrow/><mml:mrow><mml:mtext>PT</mml:mtext><mml:mspace width="0.277778em"/><mml:mn>4</mml:mn></mml:mrow></mml:mrow></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>1</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mrow/><mml:mrow><mml:mi>P</mml:mi><mml:mi>T</mml:mi><mml:mspace width="0.277778em"/><mml:mn>5</mml:mn></mml:mrow></mml:mrow></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mrow><mml:mn>0.5</mml:mn></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mn>0.5</mml:mn></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mrow/><mml:mrow><mml:mrow><mml:mtext>PT</mml:mtext><mml:mspace width="0.333333em"/></mml:mrow><mml:mspace width="0.277778em"/><mml:mn>6</mml:mn></mml:mrow></mml:mrow></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>1</mml:mn></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="40264_2022_1208_Article_Equf.gif" position="anchor"/></alternatives></disp-formula></p>
      <p id="Par26">In this example, PT 5 belongs to HLT 3 and HLT 4. A natural choice of weights is to assign half of the weight to HLT 3 and the other half to HLT 4. If necessary, however, it is possible to change the weight such that the primary parent has more weight compared with the secondary parent. Within the current implementation of BAHAMA in an R-package, weights can be specified by the user, as long as the sum of the weights of a single PT, HLT, or HLGT is 1.</p>
    </sec>
    <sec id="Sec6">
      <title>Data Aggregation</title>
      <p id="Par27">In cases where the incidence of a PT is very low, estimating the log RR might not be possible without the use of strong prior knowledge. To increase the accuracy of the estimated log RR we propose to aggregate these very low incidence PTs to their corresponding HLTs. We set a threshold on the incidence of PTs within our proposed model of 5, meaning if the PT is recorded 5 times or less in the RCT, combined in the control and treatment group, the PTs are aggregated into the HLT. Let <inline-formula id="IEq48"><alternatives><tex-math id="M107">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$y_{{}}^{{\left( {x,3} \right)}}$$\end{document}</tex-math><mml:math id="M108"><mml:msubsup><mml:mi>y</mml:mi><mml:mrow><mml:mrow/></mml:mrow><mml:mfenced close=")" open="("><mml:mrow><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:mfenced></mml:msubsup></mml:math><inline-graphic xlink:href="40264_2022_1208_Article_IEq48.gif"/></alternatives></inline-formula> be vectors of the HLT counts of the treatment and control group of these aggregated PTs.</p>
      <p id="Par28">Apart from the low incidence of PTs, the number of siblings is also an essential restriction in our model. A single PT does not allow borrowing of information from other PTs, as there is no other PT to borrow information from. If a PT does not have any siblings, or is below a threshold, the counts will also be aggregated to their corresponding HLT.</p>
      <p id="Par29">Even on the HLT level, the incidence can be below the threshold, or a HLT can have too few siblings, so aggregating to the HLGT level might also be needed. The counts of the HLT level are summarized in their HLGT level, in <inline-formula id="IEq49"><alternatives><tex-math id="M109">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$y_{{}}^{{\left( {x,2} \right)}}$$\end{document}</tex-math><mml:math id="M110"><mml:msubsup><mml:mi>y</mml:mi><mml:mrow><mml:mrow/></mml:mrow><mml:mfenced close=")" open="("><mml:mrow><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:mfenced></mml:msubsup></mml:math><inline-graphic xlink:href="40264_2022_1208_Article_IEq49.gif"/></alternatives></inline-formula> for the treatment and control group.</p>
      <p id="Par30">An illustration of the filtering process can be seen in Fig. <xref rid="Fig1" ref-type="fig">1</xref>. In this example, PT 5 and PT 6 are low-incidence PTs. They are first aggregated into HLT 4. However, even HLT 4 is below the threshold and is aggregated into HLGT 2. PT 3 does not have any siblings, and therefore is aggregated into HLT 2. PT 4 did have a sibling, PT 5, but PT 5 was removed based on low incidence, so PT 4 is also aggregated in HLT 3. HLT 3 also includes the counts of PT 5.<fig id="Fig1"><label>Fig. 1</label><caption><p>Illustration of the data aggregation based on two selections; red: incidence, green: structure</p></caption><graphic xlink:href="40264_2022_1208_Fig1_HTML" id="MO1"/></fig></p>
      <p id="Par31">For the HLTs that are not modeled at the PT level, we again assume a Poisson distribution to model the counts. To make the scale comparable across the stages, the average incidence is adjusted by multiplying by the number of PTs of the HLT <inline-formula id="IEq50"><alternatives><tex-math id="M111">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$j$$\end{document}</tex-math><mml:math id="M112"><mml:mi>j</mml:mi></mml:math><inline-graphic xlink:href="40264_2022_1208_Article_IEq50.gif"/></alternatives></inline-formula>.<disp-formula id="Equg"><alternatives><tex-math id="M113">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$y_{j}^{{\left( {x,3} \right)}} \sim {\text{Poisson}}\left( {\lambda_{j}^{{\left( {x,3} \right)}} \times N_{j}^{{{\text{PT}}}} } \right)$$\end{document}</tex-math><mml:math id="M114" display="block"><mml:mrow><mml:msubsup><mml:mi>y</mml:mi><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mfenced close=")" open="("><mml:mrow><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:mfenced></mml:msubsup><mml:mo>∼</mml:mo><mml:mtext>Poisson</mml:mtext><mml:mfenced close=")" open="("><mml:mrow><mml:msubsup><mml:mi>λ</mml:mi><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mfenced close=")" open="("><mml:mrow><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:mfenced></mml:msubsup><mml:mo>×</mml:mo><mml:msubsup><mml:mi>N</mml:mi><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mtext>PT</mml:mtext></mml:msubsup></mml:mrow></mml:mfenced></mml:mrow></mml:math><graphic xlink:href="40264_2022_1208_Article_Equg.gif" position="anchor"/></alternatives></disp-formula><disp-formula id="Equh"><alternatives><tex-math id="M115">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\log \left( {\lambda_{j}^{\left( 3 \right)} } \right) = \mu_{j}^{{\left( {0,3} \right)}} + \mu_{j}^{{\left( {1,3} \right)}} \times x + \log \left( {N^{x} } \right)$$\end{document}</tex-math><mml:math id="M116" display="block"><mml:mrow><mml:mo>log</mml:mo><mml:mfenced close=")" open="("><mml:msubsup><mml:mi>λ</mml:mi><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mfenced close=")" open="("><mml:mn>3</mml:mn></mml:mfenced></mml:msubsup></mml:mfenced><mml:mo>=</mml:mo><mml:msubsup><mml:mi>μ</mml:mi><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mfenced close=")" open="("><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:mfenced></mml:msubsup><mml:mo>+</mml:mo><mml:msubsup><mml:mi>μ</mml:mi><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mfenced close=")" open="("><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:mfenced></mml:msubsup><mml:mo>×</mml:mo><mml:mi>x</mml:mi><mml:mo>+</mml:mo><mml:mo>log</mml:mo><mml:mfenced close=")" open="("><mml:msup><mml:mi>N</mml:mi><mml:mi>x</mml:mi></mml:msup></mml:mfenced></mml:mrow></mml:math><graphic xlink:href="40264_2022_1208_Article_Equh.gif" position="anchor"/></alternatives></disp-formula>
For the HLGTs that are not included in the PT or HLT level:<disp-formula id="Equi"><alternatives><tex-math id="M117">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$y_{j}^{{\left( {x,2} \right)}} \sim {\text{Poisson}}\left( {\lambda_{k}^{{\left( {x,2} \right)}} \times N_{k}^{{{\text{PT}}}} } \right)$$\end{document}</tex-math><mml:math id="M118" display="block"><mml:mrow><mml:msubsup><mml:mi>y</mml:mi><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mfenced close=")" open="("><mml:mrow><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:mfenced></mml:msubsup><mml:mo>∼</mml:mo><mml:mtext>Poisson</mml:mtext><mml:mfenced close=")" open="("><mml:mrow><mml:msubsup><mml:mi>λ</mml:mi><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mfenced close=")" open="("><mml:mrow><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:mfenced></mml:msubsup><mml:mo>×</mml:mo><mml:msubsup><mml:mi>N</mml:mi><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mtext>PT</mml:mtext></mml:msubsup></mml:mrow></mml:mfenced></mml:mrow></mml:math><graphic xlink:href="40264_2022_1208_Article_Equi.gif" position="anchor"/></alternatives></disp-formula><disp-formula id="Equj"><alternatives><tex-math id="M119">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\log \left( {\lambda_{k}^{\left( 2 \right)} } \right) = \mu_{k}^{{\left( {0,2} \right)}} + \mu_{k}^{{\left( {1,2} \right)}} \times x + \log \left( {N^{x} } \right)$$\end{document}</tex-math><mml:math id="M120" display="block"><mml:mrow><mml:mo>log</mml:mo><mml:mfenced close=")" open="("><mml:msubsup><mml:mi>λ</mml:mi><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mfenced close=")" open="("><mml:mn>2</mml:mn></mml:mfenced></mml:msubsup></mml:mfenced><mml:mo>=</mml:mo><mml:msubsup><mml:mi>μ</mml:mi><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mfenced close=")" open="("><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:mfenced></mml:msubsup><mml:mo>+</mml:mo><mml:msubsup><mml:mi>μ</mml:mi><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mfenced close=")" open="("><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:mfenced></mml:msubsup><mml:mo>×</mml:mo><mml:mi>x</mml:mi><mml:mo>+</mml:mo><mml:mo>log</mml:mo><mml:mfenced close=")" open="("><mml:msup><mml:mi>N</mml:mi><mml:mi>x</mml:mi></mml:msup></mml:mfenced></mml:mrow></mml:math><graphic xlink:href="40264_2022_1208_Article_Equj.gif" position="anchor"/></alternatives></disp-formula></p>
    </sec>
  </sec>
  <sec id="Sec7">
    <title>Data Analysis</title>
    <sec id="Sec8">
      <title>Simulation Study</title>
      <p id="Par33">We simulated AE data for <italic>p</italic> = <inline-formula id="IEq51"><alternatives><tex-math id="M121">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$1 \ldots N^{{{\text{pat}}}}$$\end{document}</tex-math><mml:math id="M122"><mml:mrow><mml:mn>1</mml:mn><mml:mo>…</mml:mo><mml:msup><mml:mi>N</mml:mi><mml:mtext>pat</mml:mtext></mml:msup></mml:mrow></mml:math><inline-graphic xlink:href="40264_2022_1208_Article_IEq51.gif"/></alternatives></inline-formula> patients and <inline-formula id="IEq52"><alternatives><tex-math id="M123">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$N$$\end{document}</tex-math><mml:math id="M124"><mml:mi>N</mml:mi></mml:math><inline-graphic xlink:href="40264_2022_1208_Article_IEq52.gif"/></alternatives></inline-formula> PTs. We started by simulating a vector <inline-formula id="IEq53"><alternatives><tex-math id="M125">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$x$$\end{document}</tex-math><mml:math id="M126"><mml:mi>x</mml:mi></mml:math><inline-graphic xlink:href="40264_2022_1208_Article_IEq53.gif"/></alternatives></inline-formula> of length <inline-formula id="IEq54"><alternatives><tex-math id="M127">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$N^{{{\text{pat}}}}$$\end{document}</tex-math><mml:math id="M128"><mml:msup><mml:mi>N</mml:mi><mml:mtext>pat</mml:mtext></mml:msup></mml:math><inline-graphic xlink:href="40264_2022_1208_Article_IEq54.gif"/></alternatives></inline-formula>, assigning every patient to the simulated control (<inline-formula id="IEq55"><alternatives><tex-math id="M129">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$x = 0$$\end{document}</tex-math><mml:math id="M130"><mml:mrow><mml:mi>x</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="40264_2022_1208_Article_IEq55.gif"/></alternatives></inline-formula>) or treatment (<inline-formula id="IEq56"><alternatives><tex-math id="M131">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$x = 1$$\end{document}</tex-math><mml:math id="M132"><mml:mrow><mml:mi>x</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="40264_2022_1208_Article_IEq56.gif"/></alternatives></inline-formula>) group. A MedDRA structure was randomly sampled from the real MedDRA structure of the RCT of the case study. PTs were drawn from a Poisson distribution with parameters drawn from the distributions of HLT, HLGT and SOC levels according to the hierarchical Bayesian model.<disp-formula id="Equk"><alternatives><tex-math id="M133">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{gathered} x\left[ p \right]\sim {\text{Bernoulli}}\left( {0.5} \right) \hfill \\ \mu_{k}^{{\left( {0,2} \right)}} \sim N\left( {\mu_{l}^{{\left( {0,1} \right)}} ,\sigma^{2} } \right) \hfill \\ \end{gathered}$$\end{document}</tex-math><mml:math id="M134" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:mi>x</mml:mi><mml:mfenced close="]" open="["><mml:mi>p</mml:mi></mml:mfenced><mml:mo>∼</mml:mo><mml:mtext>Bernoulli</mml:mtext><mml:mfenced close=")" open="("><mml:mrow><mml:mn>0.5</mml:mn></mml:mrow></mml:mfenced></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mrow/><mml:msubsup><mml:mi>μ</mml:mi><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mfenced close=")" open="("><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:mfenced></mml:msubsup><mml:mo>∼</mml:mo><mml:mi>N</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:msubsup><mml:mi>μ</mml:mi><mml:mrow><mml:mi>l</mml:mi></mml:mrow><mml:mfenced close=")" open="("><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfenced></mml:msubsup><mml:mo>,</mml:mo><mml:msup><mml:mi>σ</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mfenced></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow/></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="40264_2022_1208_Article_Equk.gif" position="anchor"/></alternatives></disp-formula><disp-formula id="Equl"><alternatives><tex-math id="M135">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{gathered} \mu_{k}^{{\left( {1,2} \right)}} \sim N\left( {{\text{log}}\left( {RR} \right),\sigma^{2} } \right) \hfill \\ \mu_{j}^{{\left( {x,3} \right)}} \sim N\left( {\mu_{k}^{{\left( {x,2} \right)}} ,\sigma^{2} } \right) \hfill \\ \end{gathered}$$\end{document}</tex-math><mml:math id="M136" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:msubsup><mml:mi>μ</mml:mi><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mfenced close=")" open="("><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:mfenced></mml:msubsup><mml:mo>∼</mml:mo><mml:mi>N</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:mtext>log</mml:mtext><mml:mfenced close=")" open="("><mml:mrow><mml:mi mathvariant="italic">RR</mml:mi></mml:mrow></mml:mfenced><mml:mo>,</mml:mo><mml:msup><mml:mi>σ</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mfenced></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mrow/><mml:msubsup><mml:mi>μ</mml:mi><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mfenced close=")" open="("><mml:mrow><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:mfenced></mml:msubsup><mml:mo>∼</mml:mo><mml:mi>N</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:msubsup><mml:mi>μ</mml:mi><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mfenced close=")" open="("><mml:mrow><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:mfenced></mml:msubsup><mml:mo>,</mml:mo><mml:msup><mml:mi>σ</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mfenced></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow/></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="40264_2022_1208_Article_Equl.gif" position="anchor"/></alternatives></disp-formula><disp-formula id="Equm"><alternatives><tex-math id="M137">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{gathered} a_{i} \sim N\left( {\mu_{j}^{{\left( {0,3} \right)}} ,\sigma^{2} } \right) \hfill \\ b_{i} \sim N\left( {\mu_{j}^{{\left( {1,3} \right)}} ,\sigma^{2} } \right) \hfill \\ \end{gathered}$$\end{document}</tex-math><mml:math id="M138" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:msub><mml:mi>a</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>∼</mml:mo><mml:mi>N</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:msubsup><mml:mi>μ</mml:mi><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mfenced close=")" open="("><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:mfenced></mml:msubsup><mml:mo>,</mml:mo><mml:msup><mml:mi>σ</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mfenced></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mrow/><mml:msub><mml:mi>b</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>∼</mml:mo><mml:mi>N</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:msubsup><mml:mi>μ</mml:mi><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mfenced close=")" open="("><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:mfenced></mml:msubsup><mml:mo>,</mml:mo><mml:msup><mml:mi>σ</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mfenced></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow/></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="40264_2022_1208_Article_Equm.gif" position="anchor"/></alternatives></disp-formula><disp-formula id="Equn"><alternatives><tex-math id="M139">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{gathered} a_{i} \sim N\left( {\mu_{j}^{{\left( {0,3} \right)}} ,\sigma^{2} } \right) \hfill \\ {\text{log}}\left( {\uptau } \right)\left[ p \right] = a\_i + b\_i \times x\left[ p \right]) \hfill \\ y\left[ {p,i} \right]\sim {\text{Poisson}}\left( {{\uptau }\left[ {p,i} \right]} \right) \hfill \\ \end{gathered}$$\end{document}</tex-math><mml:math id="M140" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:msub><mml:mi>a</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>∼</mml:mo><mml:mi>N</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:msubsup><mml:mi>μ</mml:mi><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mfenced close=")" open="("><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:mfenced></mml:msubsup><mml:mo>,</mml:mo><mml:msup><mml:mi>σ</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mfenced></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mrow/><mml:mtext>log</mml:mtext><mml:mfenced close=")" open="("><mml:mi mathvariant="normal">τ</mml:mi></mml:mfenced><mml:mfenced close="]" open="["><mml:mi>p</mml:mi></mml:mfenced><mml:mo>=</mml:mo><mml:mi>a</mml:mi><mml:mi>_</mml:mi><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mi>b</mml:mi><mml:mi>_</mml:mi><mml:mi>i</mml:mi><mml:mo>×</mml:mo><mml:mi>x</mml:mi><mml:mfenced close="]" open="["><mml:mi>p</mml:mi></mml:mfenced><mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mrow/><mml:mi>y</mml:mi><mml:mfenced close="]" open="["><mml:mrow><mml:mi>p</mml:mi><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:mfenced><mml:mo>∼</mml:mo><mml:mtext>Poisson</mml:mtext><mml:mfenced close=")" open="("><mml:mrow><mml:mi mathvariant="normal">τ</mml:mi><mml:mfenced close="]" open="["><mml:mrow><mml:mi>p</mml:mi><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:mfenced></mml:mrow></mml:mfenced></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow/></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="40264_2022_1208_Article_Equn.gif" position="anchor"/></alternatives></disp-formula></p>
      <p id="Par34">We simulated 72 scenarios varying the number of patients (<inline-formula id="IEq57"><alternatives><tex-math id="M141">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$N^{{{\text{pat}}}} \; = \;1000, \;2000$$\end{document}</tex-math><mml:math id="M142"><mml:mrow><mml:msup><mml:mi>N</mml:mi><mml:mtext>pat</mml:mtext></mml:msup><mml:mspace width="0.277778em"/><mml:mo>=</mml:mo><mml:mspace width="0.277778em"/><mml:mn>1000</mml:mn><mml:mo>,</mml:mo><mml:mspace width="0.277778em"/><mml:mn>2000</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="40264_2022_1208_Article_IEq57.gif"/></alternatives></inline-formula>), the number of PTs (<inline-formula id="IEq58"><alternatives><tex-math id="M143">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$N\; = \;1000,\; 2000,\; 4000$$\end{document}</tex-math><mml:math id="M144"><mml:mrow><mml:mi>N</mml:mi><mml:mspace width="0.277778em"/><mml:mo>=</mml:mo><mml:mspace width="0.277778em"/><mml:mn>1000</mml:mn><mml:mo>,</mml:mo><mml:mspace width="0.277778em"/><mml:mn>2000</mml:mn><mml:mo>,</mml:mo><mml:mspace width="0.277778em"/><mml:mn>4000</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="40264_2022_1208_Article_IEq58.gif"/></alternatives></inline-formula>), the average incidence PT within a SOC (<inline-formula id="IEq59"><alternatives><tex-math id="M145">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\text{exp}}\left( {{\upmu }_{l}^{{\left( {0,1} \right)}} } \right)\; = \;0.01,1,5$$\end{document}</tex-math><mml:math id="M146"><mml:mrow><mml:mtext>exp</mml:mtext><mml:mfenced close=")" open="("><mml:msubsup><mml:mi mathvariant="normal">μ</mml:mi><mml:mrow><mml:mi>l</mml:mi></mml:mrow><mml:mfenced close=")" open="("><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfenced></mml:msubsup></mml:mfenced><mml:mspace width="0.277778em"/><mml:mo>=</mml:mo><mml:mspace width="0.277778em"/><mml:mn>0.01</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>5</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="40264_2022_1208_Article_IEq59.gif"/></alternatives></inline-formula>), and the effect of a treatment by varying the log RR (log(RR) = 0.01, 1, 0.5, 0.1) and all small variances (<inline-formula id="IEq60"><alternatives><tex-math id="M147">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\sigma^{2}$$\end{document}</tex-math><mml:math id="M148"><mml:msup><mml:mi>σ</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:math><inline-graphic xlink:href="40264_2022_1208_Article_IEq60.gif"/></alternatives></inline-formula> = 0.1). For each scenario we simulated 500 datasets.</p>
      <p id="Par35">For all scenarios, we used the default thresholds for incidence of 5 and number of siblings of 2. For the scenario of an average incidence of 0.01 and log RR of 1, we varied the thresholds for incidence between 1 and 10 and for the number of siblings between 2 or 5.</p>
      <p id="Par36">Performance of our model was quantified with (1) the mean squared error (MSE) between the true log RR and the posterior mean log RR by the various methods, (2) the bias between the true log RR and the posterior mean log RR, (3 the coverage of the 95% credibility intervals (CI) defined as the number of times the true log RR was within the 95% CI of the posterior log RR. Simulations with non-converging posterior samples were excluded from calculation of the performance measures.</p>
    </sec>
    <sec id="Sec9">
      <title>Case Study</title>
      <p id="Par37">For our case study we compared results of our five-stage hierarchical Bayesian model with the existing implementation of the Double FDR approach proposed by Mehrotra and Heyse [<xref ref-type="bibr" rid="CR6">6</xref>] and an implementation of the three-stage hierarchical Bayesian model by Berry and Berry [<xref ref-type="bibr" rid="CR10">10</xref>]. For the model by Berry and Berry [<xref ref-type="bibr" rid="CR10">10</xref>], PT counts were dichotomized as zero or ≥ 1.</p>
    </sec>
    <sec id="Sec10">
      <title>Bayesian Computation</title>
      <p id="Par38">We implemented our model in the Stan probabilistic programming language, which estimates the posterior distributions for the parameters of interest by using Hamiltonian Markov Chain Monte Carlo (HMC) [<xref ref-type="bibr" rid="CR13">13</xref>]. Stan was used with the default settings: four chains with 1000 warm-up iterations, 1000 samples of the posterior distributions per chain to calculate summarizing statistics. No alterations on the default values of the maximum allowed tree-depth or adapt delta parameters were needed for our analyses as they all reached convergence with these settings. Convergence was assessed by visual inspection of traceplots as well as the <inline-formula id="IEq61"><alternatives><tex-math id="M149">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\widehat{R}$$\end{document}</tex-math><mml:math id="M150"><mml:mover accent="true"><mml:mi>R</mml:mi><mml:mo stretchy="true">^</mml:mo></mml:mover></mml:math><inline-graphic xlink:href="40264_2022_1208_Article_IEq61.gif"/></alternatives></inline-formula> convergence diagnostic (1.1 in case study, 1.4 in simulation study).</p>
      <p id="Par39">We implemented the three-stage hierarchical Bayesian model by Berry and Berry [<xref ref-type="bibr" rid="CR10">10</xref>] in the programming language JAGS [<xref ref-type="bibr" rid="CR14">14</xref>], with four chains, 10,000 sample warm-up iterations, 10,000 samples of the posterior distributions per chain, with a thinning of 10, to calculate summarizing statistics.</p>
    </sec>
  </sec>
  <sec id="Sec11">
    <title>Results</title>
    <p id="Par40">Figure <xref rid="Fig2" ref-type="fig">2</xref> gives a summary of the results of the simulation study of the PT level. Overall, the average bias between the true log RRs and the posterior mean of the log RRs of our model was around 0. The MSE between the true log RRs and the posterior mean log RRs of our model decreased with an increasing average incidence of PTs. There was no difference in the outcome performance with an increasing RR; the results per true log RR are in the electronic supplementary material (ESM). The coverage of the 95% credibility intervals on the PT level was on average 94%, and this did not vary with an increasing average incidence.<fig id="Fig2"><label>Fig. 2</label><caption><p>Bias and the mean square error (MSE) between the true log rate ratio (RR) and the posterior mean log RR for different scenarios of the simulation study. <italic>AE</italic> adverse events, <italic>PTs</italic> Preferred Terms</p></caption><graphic xlink:href="40264_2022_1208_Fig2_HTML" id="MO2"/></fig></p>
    <p id="Par41">We introduced a data aggregation process as a preprocessing step with this method. Within this data aggregation process, two thresholds were set. The first threshold is on the minimal incidence and the second on the number of siblings within the MedDRA structure. This preprocessing step is needed because the model runs into convergence issues with the default settings of the HMC. To illustrate these issues, Fig. <xref rid="Fig3" ref-type="fig">3</xref> gives the convergency statistic <inline-formula id="IEq62"><alternatives><tex-math id="M151">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\widehat{R}$$\end{document}</tex-math><mml:math id="M152"><mml:mover accent="true"><mml:mi>R</mml:mi><mml:mo stretchy="true">^</mml:mo></mml:mover></mml:math><inline-graphic xlink:href="40264_2022_1208_Article_IEq62.gif"/></alternatives></inline-formula>, a measure for how well the chains have mixed per parameter, for the posterior mean log RRs of our model for multiple threshold settings of the data aggregation process. The number of parameters without fully mixed chains increased with lower thresholds on the number of siblings and the incidence. There were fewer not fully mixed chains with higher thresholds on the number of siblings.<fig id="Fig3"><label>Fig. 3</label><caption><p>An indication of the convergence issues with varying thresholds on the Preferred Term (PT) level (Rhat &lt; 1.1 indicates fully mixed chains)</p></caption><graphic xlink:href="40264_2022_1208_Fig3_HTML" id="MO3"/></fig></p>
    <p id="Par42">As for the performance measures with a varying threshold, Fig. <xref rid="Fig4" ref-type="fig">4</xref> shows the performance measures given different threshold settings. The bias of the posterior mean log RRs was close to zero for all thresholds. The MSE of the posterior mean log RRs decreased with increasing thresholds on the PT level. For the HLT level, the MSE was less affected by the threshold settings in the aggregation process.<fig id="Fig4"><label>Fig. 4</label><caption><p>The bias and mean square error (MSE) for the posterior mean log rate ratios (RRs) for the same simulation dataset for different thresholds (PT-level and HLT-level). <italic>HLT</italic> Higher Level Terms, <italic>PT</italic> Preferred Terms</p></caption><graphic xlink:href="40264_2022_1208_Fig4_HTML" id="MO4"/></fig></p>
    <sec id="Sec12">
      <title>Case Study</title>
      <p id="Par43">An RCT was conducted to examine the use of statins in patients undergoing hemodialysis. Details of the RCT can be found in the original manuscript by Fellström et al. [<xref ref-type="bibr" rid="CR15">15</xref>]. In short, 2776 patients were followed for an average of 3.2 years. Half of these patients were treated with a statin and half received a placebo. In total, 36,821 different AEs were recorded in 2658 patients, grouped into 2195 PTs, 724 HLTs, 244 HLGTs and 24 SOCs. The most common AE being diarrhea, reported 1000 times by 616 patients.</p>
      <p id="Par44">After applying the two thresholds on the data, a total of 574 PTs (<inline-formula id="IEq63"><alternatives><tex-math id="M153">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${y}^{\left(x,4\right)}$$\end{document}</tex-math><mml:math id="M154"><mml:msup><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mfenced close=")" open="("><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mn>4</mml:mn></mml:mfenced></mml:msup></mml:math><inline-graphic xlink:href="40264_2022_1208_Article_IEq63.gif"/></alternatives></inline-formula>), 167 HLTs (<inline-formula id="IEq64"><alternatives><tex-math id="M155">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${y}^{\left(x,3\right)}$$\end{document}</tex-math><mml:math id="M156"><mml:msup><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mfenced close=")" open="("><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mn>3</mml:mn></mml:mfenced></mml:msup></mml:math><inline-graphic xlink:href="40264_2022_1208_Article_IEq64.gif"/></alternatives></inline-formula>), 127 HLGTs (<inline-formula id="IEq65"><alternatives><tex-math id="M157">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${y}^{\left(x,2\right)}$$\end{document}</tex-math><mml:math id="M158"><mml:msup><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mfenced close=")" open="("><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mn>2</mml:mn></mml:mfenced></mml:msup></mml:math><inline-graphic xlink:href="40264_2022_1208_Article_IEq65.gif"/></alternatives></inline-formula>) remained. Of the 574 PTs, 9 had multiple HLTs, 8 out of the 327 HLTs were clustered into multiple HLGTs, and 5 out of the 244 HLGTs clustered into multiple SOCs. Convergence was reached using the default settings in Stan; the highest <inline-formula id="IEq66"><alternatives><tex-math id="M159">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\widehat{R}$$\end{document}</tex-math><mml:math id="M160"><mml:mover accent="true"><mml:mi>R</mml:mi><mml:mo stretchy="true">^</mml:mo></mml:mover></mml:math><inline-graphic xlink:href="40264_2022_1208_Article_IEq66.gif"/></alternatives></inline-formula> was 1.099.</p>
      <p id="Par45">In Fig. <xref rid="Fig5" ref-type="fig">5</xref>, the posterior mean log RRs are shown for the four MedDRA levels. A table with the posterior mean and standard deviation (SD) of the log RRs is in the ESM. On the PT level, the most notable PTs were ‘discomfort’ and ‘pulmonary oedema’. Both of these PT incidences were increased in the treatment group. On the HLT level; the HLTs of 'muscle weakness conditions' and 'heart failure signs' were both increased in the treatment group.<fig id="Fig5"><label>Fig. 5</label><caption><p>The posterior probability of an effect between the statin treatment group and placebo group and its magnitude as the posterior mean of the log rate ratio (RR) divided by the posterior standard deviation per MedDRA levels. <italic>HLGT</italic> Higher Level Group Terms, <italic>HLT</italic> Higher Level Terms, <italic>PT</italic> Preferred Terms, <italic>SD</italic> standard deviation, <italic>SOC</italic> System Organ Classes</p></caption><graphic xlink:href="40264_2022_1208_Fig5_HTML" id="MO5"/></fig></p>
    </sec>
    <sec id="Sec13">
      <title>Comparison</title>
      <p id="Par46">To illustrate the effect of shrinkage we compared the posterior mean log RRs of the PTs of our model with the observed log RRs and log odds ratios in Fig. <xref rid="Fig6" ref-type="fig">6</xref>A, B. Some posterior mean log RRs were closer to zero than the observed log RRs, thereby decreasing the false discovery rate, whereas other posterior mean log RRs were drawn away from zero, due to borrowing strength from closely related PTs.<fig id="Fig6"><label>Fig. 6</label><caption><p>Comparison between <bold>A</bold> observed log RR and <bold>B</bold> log OR of the PTs, <bold>C</bold>, <bold>D</bold> the posterior mean log ORs as estimated by the model of Berry and Berry [<xref ref-type="bibr" rid="CR10">10</xref>], <bold>E</bold> the DFDR and the posterior mean log RRs (1, Pulmonary oedema; 2, Basal Cell Carcinoma; 3, Discomfort). <italic>DFDR</italic> double false discovery rate, <italic>OR</italic> odds ratio, <italic>PTs</italic> Preferred Terms, <italic>RR</italic> rate ratio, <italic>SD</italic> standard deviation, <italic>SOC</italic> System Organ Classes</p></caption><graphic xlink:href="40264_2022_1208_Fig6_HTML" id="MO6"/></fig></p>
      <p id="Par47">To support the findings of our five-stage hierarchical model, we compared the results on the PT level with other methods developed for AE analyses. We compared our posterior mean log RRs with the posterior mean log odds ratios (OR) given by the model as proposed by Berry and Berry [<xref ref-type="bibr" rid="CR10">10</xref>] (Fig. <xref rid="Fig6" ref-type="fig">6</xref>). The PT with the highest log OR is ‘Basal cell carcinoma’; this finding was also supported by the five-stage model. The log OR of the PT ‘discomfort’, the PT with the highest log RR, was close to zero. The occurrence of this PT is high, especially in the treatment group, but occurred in relatively few patients (29 times in 6 patients in the treatment group versus 3 times in 3 patients in the control group); this aspect is lost when PTs are dichotomized as is done with Berry and Berry’s model.</p>
      <p id="Par48">The PT ‘pulmonary oedema’ is an example of the benefit of using all MedDRA levels (91 times in 61 patients in the treatment group vs 43 times in 41 patients in the control group). This PT is part of HLT ‘pulmonary oedemas’ together with the PTs ‘Acute pulmonary oedema’ (39 in 31 and 24 in 20) and ‘Pulmonary congestion’ (9 in 8 and 12 in 11). Both the PTs ‘pulmonary oedema’ and ‘acute pulmonary oedema’ were more common in the treatment group, but based on the observed individual incidences were not signaled out. With the shrinkage that was enforced by a Bayesian model only based on the SOC level, the PTs were also not signaled out.</p>
      <p id="Par49">Another method especially developed for AE data is the double FDR procedure. We compared double FDR <italic>p</italic>-values at the PT level with <italic>p</italic>-values from the five-stage model, if possible (Fig. <xref rid="Fig6" ref-type="fig">6</xref>E). The double FDR procedure was performed for 538 of the 574 PTs, and those 538 PTs were from 21 SOCs. All PTs with a significant <italic>p</italic>-value of &lt; 0.05 according to the double FDR procedure were also found by the five-stage model. The five-stage model signaled 12 additional PTs, in comparison with the double FDR.</p>
    </sec>
  </sec>
  <sec id="Sec14">
    <title>Discussion</title>
    <p id="Par50">This paper introduces a novel approach using a Bayesian hierarchical model for analyzing MedDRA-coded AEs collected during an RCT. The use of a Bayesian hierarchical model has some advantages. The first is that by using the existing MedDRA structure to borrow strength between closely related AEs, more stable estimations of incidence parameters are obtained. In comparison with other methods, we use the complete MedDRA structure, making it more likely that the effect of treatment is comparable between the AEs. Second, we propose aggregating the data to a higher MedDRA level if not enough data is available. By aggregating the PTs into higher levels, all available data is still included in the model, even when the incidence of a specific PT is too low to estimate the difference between the treatment and control group. The 'borrowing' of information on the higher levels is more complete by using this form of aggregating than by not including this data in the data analysis.</p>
    <p id="Par51">A limitation of methods like the one we propose here is that they are not used in practice, as there is little to no guidance in using the methods nor is there user-friendly software [<xref ref-type="bibr" rid="CR1">1</xref>, <xref ref-type="bibr" rid="CR7">7</xref>]. Therefore, we made this model and the data aggregation into the R package Bayesian Hierarchical Analyses of MedDRA-coded Adverse Events (BAHAMA). This R package and a tutorial is available on <ext-link ext-link-type="uri" xlink:href="https://github.com/Alma-Revers/BAHAMA">https://github.com/Alma-Revers/BAHAMA</ext-link>.</p>
    <p id="Par52">A hierarchical Bayesian approach applies shrinkage to the effect of treatment on the incidence of the AEs. The direction and the amount of shrinkage is determined by the weight matrices and is based on the MedDRA structure. This shrinkage is sub-optimal when the interest is in specific outlying AEs, as the shrinkage smooths the effect of the outlier, making it less likely to be detected. We argue that this shrinkage is mostly beneficial as it increases the probability of detecting a true effect overall. However, the proposed model might not be the optimal choice if a specified AE is of particular interest.</p>
    <p id="Par53">With our multi-level hierarchical Bayesian model, convergence issues may occur. In our case study we did not encounter any convergence issues with the thresholds that we used for the incidence and the number of MedDRA siblings. Our simulation study had some convergence issues that could be avoided by increasing these thresholds and by drawing more samples from the posterior distributions. Other solutions are changing the settings of the HMC sampling or use an alternative parameterization of the model such as models in which the intensity of the treatment group is independent of the intensity of the control group.</p>
    <p id="Par54">With a full Bayesian framework, the conclusion might change based on the priors. We choose to use weakly informative priors instead of relying on medical knowledge. In order to evaluate the effect of the prior specifications, we carried out a sensitivity analysis in which we used more informative and less informative priors. In summary, with less informative priors, we had more convergence issues. However, the difference in results was small. Therefore, we concluded that with the proposed priors, results are robust.</p>
    <p id="Par55">In the models by Berry and Berry (2004) and Xia et al. (2011), a zero-point mass was added to the log OR [<xref ref-type="bibr" rid="CR10">10</xref>, <xref ref-type="bibr" rid="CR16">16</xref>]. The intuition behind this is that there will be no difference between the treatment groups for most AE/PTs. We did this for our model as well. However, this did perform worse in terms of convergence with our case data. Therefore, we did not pursue this approach any further.</p>
  </sec>
  <sec id="Sec15">
    <title>Conclusion</title>
    <p id="Par56">This paper introduces a new approach to analyzing AE data from an RCT, by using the MedDRA structure and by borrowing strength from closely related AEs and data aggregation. With our case study we showed that this new approach could detect more AEs compared with other approaches. We implemented the new method in the R package BAHAMA. We have currently only implemented this method for RCTs comparing two interventions. In the future this will be extended for multi-arm RCTs.</p>
  </sec>
</body>
<back>
  <notes>
    <title>Declarations</title>
    <notes id="FPar1" notes-type="funding">
      <title>Funding</title>
      <p id="Par61">None.</p>
    </notes>
    <notes id="FPar2" notes-type="COI-statement">
      <title>Conflict of Interest Statement</title>
      <p id="Par59">The authors declare that the research was conducted in the absence of any commercial or financial relationships that could be construed as a potential conflict of interest.</p>
    </notes>
    <notes id="FPar3">
      <title>Ethics Approval</title>
      <p id="Par63">Not applicable, no new patient data was used in this research.</p>
    </notes>
    <notes id="FPar4">
      <title>Consent to Participate</title>
      <p id="Par71">Not applicable, safety data used is publicly available and consent was obtained during the original research.</p>
    </notes>
    <notes id="FPar5">
      <title>Consent for Publication</title>
      <p id="Par73">Not applicable, safety data used is publicly available and consent was obtained during the original research.</p>
    </notes>
    <notes id="FPar6">
      <title>Data Availability Statement</title>
      <p id="Par69">The case study data has been deposited at ClinicalTrials.gov under study number NCT00240331. The R-package, a tutorial and the simulation study code can be found at <ext-link ext-link-type="uri" xlink:href="https://github.com/Alma-Revers/BAHAMA">https://github.com/Alma-Revers/BAHAMA</ext-link>.</p>
    </notes>
    <notes id="FPar7">
      <title>Code Availability</title>
      <p id="Par65">Simulation study code and the implementation of the models can be found at <ext-link ext-link-type="uri" xlink:href="https://github.com/Alma-Revers/BAHAMA">https://github.com/Alma-Revers/BAHAMA</ext-link>.</p>
    </notes>
    <notes id="FPar8" notes-type="author-contribution">
      <title>Author Contributions</title>
      <p id="Par67">AR, MH and AZ developed the statistical model and simulation framework. AR conducted the simulation study and data analysis; she also prepared the first draft. MH and AZ edited the manuscript. All authors read and approved this manuscript.</p>
    </notes>
  </notes>
  <ref-list id="Bib1">
    <title>References</title>
    <ref id="CR1">
      <label>1.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Phillips</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Cornelius</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Sauzet</surname>
            <given-names>O</given-names>
          </name>
          <name>
            <surname>Cornelius</surname>
            <given-names>V</given-names>
          </name>
        </person-group>
        <article-title>Statistical methods for the analysis of adverse event data in randomised controlled trials: a scoping review and taxonomy</article-title>
        <source>BMC Med Res Methodol</source>
        <year>2020</year>
        <volume>20</volume>
        <issue>1</issue>
        <fpage>288</fpage>
        <pub-id pub-id-type="doi">10.1186/s12874-020-01167-9</pub-id>
        <?supplied-pmid 33256641?>
        <pub-id pub-id-type="pmid">33256641</pub-id>
      </element-citation>
    </ref>
    <ref id="CR2">
      <label>2.</label>
      <mixed-citation publication-type="other">MedDRA MSSO. Medical Dictionary for Regulatory Activities Terminology (MedDRA). 2022. <ext-link ext-link-type="uri" xlink:href="http://www.meddramsso.com">http://www.meddramsso.com</ext-link>.</mixed-citation>
    </ref>
    <ref id="CR3">
      <label>3.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Pearson</surname>
            <given-names>RK</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Influence of the MedDRA hierarchy on pharmacovigilance data mining results</article-title>
        <source>Int J Med Inform</source>
        <year>2009</year>
        <volume>78</volume>
        <issue>12</issue>
        <fpage>e97</fpage>
        <lpage>e103</lpage>
        <pub-id pub-id-type="doi">10.1016/j.ijmedinf.2009.01.001</pub-id>
        <?supplied-pmid 19230751?>
        <pub-id pub-id-type="pmid">19230751</pub-id>
      </element-citation>
    </ref>
    <ref id="CR4">
      <label>4.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Chen</surname>
            <given-names>W</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>A Bayesian group sequential approach to safety signal detection</article-title>
        <source>J Biopharm Stat</source>
        <year>2013</year>
        <volume>23</volume>
        <issue>1</issue>
        <fpage>213</fpage>
        <lpage>230</lpage>
        <pub-id pub-id-type="doi">10.1080/10543406.2013.736813</pub-id>
        <?supplied-pmid 23331232?>
        <pub-id pub-id-type="pmid">23331232</pub-id>
      </element-citation>
    </ref>
    <ref id="CR5">
      <label>5.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wang</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Heyse</surname>
            <given-names>JF</given-names>
          </name>
          <name>
            <surname>Ibrahim</surname>
            <given-names>JG</given-names>
          </name>
        </person-group>
        <article-title>Efficient methods for signal detection from correlated adverse</article-title>
        <source>Biometrics</source>
        <year>2019</year>
        <pub-id pub-id-type="doi">10.1111/biom.13031</pub-id>
        <?supplied-pmid 31863595?>
        <pub-id pub-id-type="pmid">31863595</pub-id>
      </element-citation>
    </ref>
    <ref id="CR6">
      <label>6.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Mehrotra</surname>
            <given-names>DV</given-names>
          </name>
          <name>
            <surname>Heyse</surname>
            <given-names>JF</given-names>
          </name>
        </person-group>
        <article-title>Use of the false discovery rate for evaluating</article-title>
        <source>Stat Methods Med Res</source>
        <year>2004</year>
        <volume>13</volume>
        <fpage>227</fpage>
        <lpage>238</lpage>
        <pub-id pub-id-type="doi">10.1191/0962280204sm363ra</pub-id>
        <?supplied-pmid 15198488?>
        <pub-id pub-id-type="pmid">15198488</pub-id>
      </element-citation>
    </ref>
    <ref id="CR7">
      <label>7.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Phillips</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Hazell</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Sauzet</surname>
            <given-names>O</given-names>
          </name>
          <name>
            <surname>Cornelius</surname>
            <given-names>V</given-names>
          </name>
        </person-group>
        <article-title>Analysis and reporting of adverse events in randomised controlled trials: a review</article-title>
        <source>BMJ Open</source>
        <year>2019</year>
        <volume>9</volume>
        <issue>2</issue>
        <fpage>e024537</fpage>
        <pub-id pub-id-type="doi">10.1136/bmjopen-2018-024537</pub-id>
        <?supplied-pmid 30826796?>
        <pub-id pub-id-type="pmid">30826796</pub-id>
      </element-citation>
    </ref>
    <ref id="CR8">
      <label>8.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Crowe</surname>
            <given-names>BJ</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Recommendations for safety planning, data collection, evaluation and reporting during drug, biologic and vaccine development: a report of the safety planning, evaluation, and reporting team</article-title>
        <source>Clin Trials</source>
        <year>2009</year>
        <volume>6</volume>
        <issue>5</issue>
        <fpage>430</fpage>
        <lpage>440</lpage>
        <pub-id pub-id-type="doi">10.1177/1740774509344101</pub-id>
        <?supplied-pmid 19846894?>
        <pub-id pub-id-type="pmid">19846894</pub-id>
      </element-citation>
    </ref>
    <ref id="CR9">
      <label>9.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Odani</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Fukimbara</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Sato</surname>
            <given-names>T</given-names>
          </name>
        </person-group>
        <article-title>A Bayesian meta-analytic approach for safety signal detection in randomized clinical trials</article-title>
        <source>Clin Trials</source>
        <year>2017</year>
        <volume>14</volume>
        <issue>2</issue>
        <fpage>192</fpage>
        <lpage>200</lpage>
        <pub-id pub-id-type="doi">10.1177/1740774516683920</pub-id>
        <?supplied-pmid 28059578?>
        <pub-id pub-id-type="pmid">28059578</pub-id>
      </element-citation>
    </ref>
    <ref id="CR10">
      <label>10.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Berry</surname>
            <given-names>SM</given-names>
          </name>
          <name>
            <surname>Berry</surname>
            <given-names>DA</given-names>
          </name>
        </person-group>
        <article-title>Accounting for multiplicities in assessing drug safety: a three-level hierarchical mixture model</article-title>
        <source>Biometrics</source>
        <year>2004</year>
        <volume>60</volume>
        <issue>2</issue>
        <fpage>418</fpage>
        <lpage>426</lpage>
        <pub-id pub-id-type="doi">10.1111/j.0006-341X.2004.00186.x</pub-id>
        <?supplied-pmid 15180667?>
        <pub-id pub-id-type="pmid">15180667</pub-id>
      </element-citation>
    </ref>
    <ref id="CR11">
      <label>11.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Xia</surname>
            <given-names>HA</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Bayesian hierarchical modeling for detecting safety signals in clinical trials</article-title>
        <source>J Biopharm Stat</source>
        <year>2011</year>
        <volume>21</volume>
        <issue>5</issue>
        <fpage>1006</fpage>
        <lpage>1029</lpage>
        <pub-id pub-id-type="doi">10.1080/10543406.2010.520181</pub-id>
        <?supplied-pmid 21830928?>
        <pub-id pub-id-type="pmid">21830928</pub-id>
      </element-citation>
    </ref>
    <ref id="CR12">
      <label>12.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zhang</surname>
            <given-names>Y</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Bayesian hierarchical model for safety signal detection in multiple clinical trials</article-title>
        <source>Contemp Clin Trials</source>
        <year>2020</year>
        <volume>99</volume>
        <fpage>106183</fpage>
        <pub-id pub-id-type="doi">10.1016/j.cct.2020.106183</pub-id>
        <?supplied-pmid 33091588?>
        <pub-id pub-id-type="pmid">33091588</pub-id>
      </element-citation>
    </ref>
    <ref id="CR13">
      <label>13.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Carpenter</surname>
            <given-names>B</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Stan: a probabilistic programming language</article-title>
        <source>J Stat Softw</source>
        <year>2017</year>
        <volume>76</volume>
        <issue>1</issue>
        <fpage>1</fpage>
        <lpage>32</lpage>
        <pub-id pub-id-type="doi">10.18637/jss.v076.i01</pub-id>
      </element-citation>
    </ref>
    <ref id="CR14">
      <label>14.</label>
      <mixed-citation publication-type="other">Plummer M. JAGS: a program for analysis of Bayesian graphical models using Gibbs sampling. In: Proc 3rd Int Work Distrib Stat Comput, vol. 124, pp. 1–10; 2003.</mixed-citation>
    </ref>
    <ref id="CR15">
      <label>15.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Fellström</surname>
            <given-names>BC</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Rosuvastatin and cardiovascular events in patients undergoing hemodialysis</article-title>
        <source>N Engl J Med</source>
        <year>2009</year>
        <volume>360</volume>
        <issue>14</issue>
        <fpage>1395</fpage>
        <lpage>1407</lpage>
        <pub-id pub-id-type="doi">10.1056/NEJMoa0810177</pub-id>
        <?supplied-pmid 19332456?>
        <pub-id pub-id-type="pmid">19332456</pub-id>
      </element-citation>
    </ref>
    <ref id="CR16">
      <label>16.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Price</surname>
            <given-names>KL</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Bayesian methods for design and analysis of safety trials</article-title>
        <source>Pharm Stat</source>
        <year>2014</year>
        <volume>13</volume>
        <issue>1</issue>
        <fpage>13</fpage>
        <lpage>24</lpage>
        <pub-id pub-id-type="doi">10.1002/pst.1586</pub-id>
        <?supplied-pmid 23897858?>
        <pub-id pub-id-type="pmid">23897858</pub-id>
      </element-citation>
    </ref>
  </ref-list>
</back>
