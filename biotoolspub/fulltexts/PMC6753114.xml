<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName A++V2.4.dtd?>
<?SourceDTD.Version 2.4?>
<?ConverterInfo.XSLTName springer2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Nat Commun</journal-id>
    <journal-id journal-id-type="iso-abbrev">Nat Commun</journal-id>
    <journal-title-group>
      <journal-title>Nature Communications</journal-title>
    </journal-title-group>
    <issn pub-type="epub">2041-1723</issn>
    <publisher>
      <publisher-name>Nature Publishing Group UK</publisher-name>
      <publisher-loc>London</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">6753114</article-id>
    <article-id pub-id-type="publisher-id">12281</article-id>
    <article-id pub-id-type="doi">10.1038/s41467-019-12281-8</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Article</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Optimized CRISPR guide RNA design for two high-fidelity Cas9 variants by deep learning</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author" equal-contrib="yes">
        <name>
          <surname>Wang</surname>
          <given-names>Daqi</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author" equal-contrib="yes">
        <name>
          <surname>Zhang</surname>
          <given-names>Chengdong</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Wang</surname>
          <given-names>Bei</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Li</surname>
          <given-names>Bin</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Wang</surname>
          <given-names>Qiang</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Liu</surname>
          <given-names>Dong</given-names>
        </name>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Wang</surname>
          <given-names>Hongyan</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff3">3</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Zhou</surname>
          <given-names>Yan</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Shi</surname>
          <given-names>Leming</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff4">4</xref>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-9038-4014</contrib-id>
        <name>
          <surname>Lan</surname>
          <given-names>Feng</given-names>
        </name>
        <address>
          <email>fenglan@ccmu.edu.cn</email>
        </address>
        <xref ref-type="aff" rid="Aff5">5</xref>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0001-8269-5296</contrib-id>
        <name>
          <surname>Wang</surname>
          <given-names>Yongming</given-names>
        </name>
        <address>
          <email>ymw@fudan.edu.cn</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <aff id="Aff1"><label>1</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0001 0125 2443</institution-id><institution-id institution-id-type="GRID">grid.8547.e</institution-id><institution>State Key Laboratory of Genetic Engineering, School of Life Sciences, Zhongshan Hospital, </institution><institution>Fudan University, </institution></institution-wrap>Shanghai, 200432 China </aff>
      <aff id="Aff2"><label>2</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0000 9530 8833</institution-id><institution-id institution-id-type="GRID">grid.260483.b</institution-id><institution>Co-innovation Center of Neuroregeneration, Jiangsu Key Laboratory of Neuroregeneration, </institution><institution>Nantong University, </institution></institution-wrap>Nantong, 226001 China </aff>
      <aff id="Aff3"><label>3</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0001 0125 2443</institution-id><institution-id institution-id-type="GRID">grid.8547.e</institution-id><institution>Hospital of Obstetrics and Gynecology, </institution><institution>Fudan University, </institution></institution-wrap>Shanghai, 200011 China </aff>
      <aff id="Aff4"><label>4</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0001 0125 2443</institution-id><institution-id institution-id-type="GRID">grid.8547.e</institution-id><institution>Human Phenome Institute, </institution><institution>Fudan University, </institution></institution-wrap>Shanghai, 200438 China </aff>
      <aff id="Aff5"><label>5</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0004 0369 153X</institution-id><institution-id institution-id-type="GRID">grid.24696.3f</institution-id><institution>Beijing Anzhen Hospital, Beijing Institute of Heart Lung and Blood Vessel Disease, </institution><institution>Capital Medical University, </institution></institution-wrap>Beijing, 100029 China </aff>
    </contrib-group>
    <pub-date pub-type="epub">
      <day>19</day>
      <month>9</month>
      <year>2019</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>19</day>
      <month>9</month>
      <year>2019</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2019</year>
    </pub-date>
    <volume>10</volume>
    <elocation-id>4284</elocation-id>
    <history>
      <date date-type="received">
        <day>5</day>
        <month>10</month>
        <year>2018</year>
      </date>
      <date date-type="accepted">
        <day>24</day>
        <month>7</month>
        <year>2019</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2019</copyright-statement>
      <license license-type="OpenAccess">
        <license-p><bold>Open Access</bold> This article is licensed under a Creative Commons Attribution 4.0 International License, which permits use, sharing, adaptation, distribution and reproduction in any medium or format, as long as you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons license, and indicate if changes were made. The images or other third party material in this article are included in the article’s Creative Commons license, unless indicated otherwise in a credit line to the material. If material is not included in the article’s Creative Commons license and your intended use is not permitted by statutory regulation or exceeds the permitted use, you will need to obtain permission directly from the copyright holder. To view a copy of this license, visit <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>.</license-p>
      </license>
    </permissions>
    <abstract id="Abs1">
      <p id="Par1">Highly specific Cas9 nucleases derived from SpCas9 are valuable tools for genome editing, but their wide applications are hampered by a lack of knowledge governing guide RNA (gRNA) activity. Here, we perform a genome-scale screen to measure gRNA activity for two highly specific SpCas9 variants (eSpCas9(1.1) and SpCas9-HF1) and wild-type SpCas9 (WT-SpCas9) in human cells, and obtain indel rates of over 50,000 gRNAs for each nuclease, covering ~20,000 genes. We evaluate the contribution of 1,031 features to gRNA activity and develope models for activity prediction. Our data reveals that a combination of RNN with important biological features outperforms other models for activity prediction. We further demonstrate that our model outperforms other popular gRNA design tools. Finally, we develop an online design tool DeepHF for the three Cas9 nucleases. The database, as well as the designer tool, is freely accessible via a web server, <ext-link ext-link-type="uri" xlink:href="http://www.DeepHF.com/">http://www.DeepHF.com/</ext-link>.</p>
    </abstract>
    <abstract id="Abs2" abstract-type="web-summary">
      <p id="Par2">Application of highly specific Cas9 variants can be restricted by the design of the guide RNA. Here the authors present DeepHF, a gRNA activity prediction tool built from genome-scale screens of 50,000 guides covering 20,000 genes.</p>
    </abstract>
    <kwd-group kwd-group-type="npg-subject">
      <title>Subject terms</title>
      <kwd>Bioinformatics</kwd>
      <kwd>CRISPR-Cas9 genome editing</kwd>
      <kwd>Machine learning</kwd>
    </kwd-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">https://doi.org/10.13039/501100001809</institution-id>
            <institution>National Natural Science Foundation of China (National Science Foundation of China)</institution>
          </institution-wrap>
        </funding-source>
        <award-id>31720103909</award-id>
        <award-id>31471239</award-id>
        <principal-award-recipient>
          <name>
            <surname>Wang</surname>
            <given-names>Yongming</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
    </funding-group>
    <custom-meta-group>
      <custom-meta>
        <meta-name>issue-copyright-statement</meta-name>
        <meta-value>© The Author(s) 2019</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec id="Sec1" sec-type="introduction">
    <title>Introduction</title>
    <p id="Par3">The CRISPR/Cas9 system derived from <italic>Streptococcus pyogenes</italic> (<italic>Sp</italic>Cas9) is currently considered a state-of-the-art tool for genome editing, and is used in a wide variety of organisms and cell types<sup><xref ref-type="bibr" rid="CR1">1</xref>–<xref ref-type="bibr" rid="CR6">6</xref></sup>. Despite significant advances in our understanding of the CRISPR/Cas9 system, concerns remain over the potential for off-target effects, which enormously impede clinical application of the technology<sup><xref ref-type="bibr" rid="CR7">7</xref>–<xref ref-type="bibr" rid="CR14">14</xref></sup>. One solution to address off-target limitations is to engineer SpCas9 with higher specificities. In a search for better genome editing, two SpCas9 variants, enhanced SpCas9 (eSpCas9(1.1)) and Cas9-High Fidelity (SpCas9-HF1), have been first generated by hypothesis that amino acid substitutions predicted to weaken nonspecific interactions between a Cas9-RNA complex and its substrate DNA would reduce off-target cleavage in cells<sup><xref ref-type="bibr" rid="CR15">15</xref>,<xref ref-type="bibr" rid="CR16">16</xref></sup>. By analysis of crystal structures of Cas9 variants, Chen et al. have generated a new hyper-accurate Cas9 variant (HypaCas9)<sup><xref ref-type="bibr" rid="CR17">17</xref></sup>. There are now three additional highly specific Cas9 nucleases that have been developed using mutational library or directed evolution strategies<sup><xref ref-type="bibr" rid="CR18">18</xref>–<xref ref-type="bibr" rid="CR20">20</xref></sup>.</p>
    <p id="Par4">The CRISPR/Cas9 system consists of a Cas9 nuclease and a 100 nucleotides guide RNA (gRNA), which form a Cas9-gRNA complex, recognizing a 20 nucleotides target sequence with an NGG downstream protospacer adjacent motif (PAM, N<sub>20</sub>NGG) and induces a site-specific double-strand break (DSB)<sup><xref ref-type="bibr" rid="CR1">1</xref>–<xref ref-type="bibr" rid="CR3">3</xref></sup>. The success of genome editing depends on the choice of the gRNA sequence. Some gRNAs are capable of disrupting almost every target allele in a population of cells, while others display no detectable activity. This has led to development of several gRNA design tools for wild-type SpCas9 (WT-SpCas9) by using various algorithms, including linear regression model<sup><xref ref-type="bibr" rid="CR21">21</xref></sup>, penalized linear regression model<sup><xref ref-type="bibr" rid="CR22">22</xref></sup>, support vector machine (SVM) model<sup><xref ref-type="bibr" rid="CR23">23</xref>,<xref ref-type="bibr" rid="CR24">24</xref></sup>, and gradient-boosted regression model<sup><xref ref-type="bibr" rid="CR25">25</xref></sup>. Intriguingly, two groups have recently shown that a convolutional neural network (CNN), a class of deep learning, improves gRNA design<sup><xref ref-type="bibr" rid="CR26">26</xref>,<xref ref-type="bibr" rid="CR27">27</xref></sup>.</p>
    <p id="Par5">The extensive applications of highly specific SpCas9 variants have been limited by the lack of knowledge that governs gRNA activity. Existing evidence reveals that some highly active gRNAs for WT-SpCas9 are poorly active for the highly specific Cas9 variants<sup><xref ref-type="bibr" rid="CR15">15</xref>,<xref ref-type="bibr" rid="CR16">16</xref>,<xref ref-type="bibr" rid="CR18">18</xref></sup>. A recent genome-wide activity profiling study in bacteria reveals the differences in the profile of important features between WT-SpCas9 and eSpCas9<sup><xref ref-type="bibr" rid="CR28">28</xref></sup>. In this study, we perform a genome-scale screen in human cells to measure gRNA activity for WT-SpCas9, eSpCas9(1.1), and SpCas9-HF1 by using a high-throughput method and obtain an activity data set of over 50,000 gRNAs, covering ~20,000 genes. Finally, we develop a deep-learning-based online design tool for the three Cas9 nucleases.</p>
  </sec>
  <sec id="Sec2" sec-type="results">
    <title>Results</title>
    <sec id="Sec3">
      <title>A mouse U6 (mU6) promoter expands genomic targeting sites</title>
      <p id="Par6">An optimal gRNA library design requires a large number of accessible genomic target sites. The gRNA transcription is commonly driven by human U6 (hU6) promoter that is believed to require guanine (G) as the first nucleotide of its transcript<sup><xref ref-type="bibr" rid="CR1">1</xref>–<xref ref-type="bibr" rid="CR3">3</xref></sup>. In the event that the first nucleotide is not a G, it is possible to replace the first nucleotide with a G or add an extra G to the 5′ end of gRNA, resulting in a gRNA–DNA mismatch at 5′ end. WT-SpCas9 can tolerate gRNA–DNA mismatches at 5′ end, so it can target any N<sub>20</sub>NGG sequence with hU6 promoter<sup><xref ref-type="bibr" rid="CR1">1</xref>–<xref ref-type="bibr" rid="CR3">3</xref></sup>. However, highly specific Cas9 nucleases such as eSpCas9(1.1) and SpCas9-HF1 are sensitive to gRNA–DNA mismatches at 5′ end<sup><xref ref-type="bibr" rid="CR29">29</xref></sup>. They can only target GN<sub>19</sub>NGG sequence when the hU6 promoter is used, limiting target site selection.</p>
      <p id="Par7">A previous study has shown that the mouse U6 (mU6) promoter can initiate either adenine (A) or G transcript<sup><xref ref-type="bibr" rid="CR30">30</xref></sup>, which could potentially expand target selection. We compared the activity of mU6 promoter and hU6 promoter by transient expression of gRNAs for genome editing in WT-SpCas9-expressing HEK293T cells (Fig. <xref rid="Fig1" ref-type="fig">1a</xref>). The mU6 promoter showed activity similar to hU6 promoter for 12 tested gRNAs initiated with G (Fig. <xref rid="Fig1" ref-type="fig">1b, c</xref>, Table <xref rid="Tab1" ref-type="table">1</xref>; Supplementary Fig. <xref rid="MOESM1" ref-type="media">1a</xref>). We tested nine gRNAs initiated with A but free of G at 1–4 nucleotides, avoiding functional truncated gRNAs transcribed from G (Table <xref rid="Tab1" ref-type="table">1</xref>). To our surprise, both promoters could promote genome editing with gRNAs initiated with A (Fig. <xref rid="Fig1" ref-type="fig">1d, e</xref>; Supplementary Fig. <xref rid="MOESM1" ref-type="media">1b</xref>). Among all nine tested gRNAs, only one gRNA (A8) driven by hU6 displayed low efficiency. We tested additional nine gRNAs initiated with A, but contained G at 1–5 nucleotides. In this case, mU6 promoter showed generally higher activity than hU6 promoter (Supplementary Fig. <xref rid="MOESM1" ref-type="media">2a–c</xref>). Next, we compared the activity of mU6 promoter and hU6 promoter in HeLa cells, and they showed similar activity (Supplementary Fig. <xref rid="MOESM1" ref-type="media">3a–f</xref>). Furthermore, we compared the activity of mU6 promoter and hU6 promoter in a lentivirus vector, and they showed similar activity at two time points, day 3 and day 5, after transduction (Supplementary Fig. <xref rid="MOESM1" ref-type="media">4a, b</xref>). Our results are consistent with a very recent study that hU6 promoter can transcribe small RNAs initiated with A<sup><xref ref-type="bibr" rid="CR31">31</xref></sup>.<fig id="Fig1"><label>Fig. 1</label><caption><p>Both mU6 promoter and hU6 promoter enable to transcript gRNAs initiated with A or G for genome editing. <bold>a</bold> Schematic diagram of mU6 and hU6 comparison. These two promoters were used to transcript gRNAs initiated with A or G nucleotide. <bold>b</bold>, <bold>c</bold> Comparison of mU6 and hU6 promoters for genome editing with gRNAs initiated with G. The data are shown as mean ± s.d. (<italic>n</italic> = 2). <bold>d</bold>, <bold>e</bold> Comparison of mU6 promoter for genome editing with gRNAs initiated with A. The data are shown as mean ± s.d. (<italic>n</italic> = 2). <bold>f</bold> Comparison of the mU6 promoter for genome editing with gRNAs initiated with A or G three days post transfection. <bold>g</bold> Comparison of the mU6 promoter for genome editing with gRNAs initiated with A or G 5 days post transfection. The data are shown as mean ± s.d. <italic>P</italic> &gt; 0.05; <italic>P</italic> &lt; 0.05 by two-way ANOVA (<italic>n</italic> = 2). Source data are provided as a Source Data file</p></caption><graphic xlink:href="41467_2019_12281_Fig1_HTML" id="d29e569"/></fig><table-wrap id="Tab1"><label>Table 1</label><caption><p>gRNAs used in Fig. <xref rid="Fig1" ref-type="fig">1</xref></p></caption><table frame="hsides" rules="groups"><thead><tr><th colspan="2">Name</th><th>Sequences</th></tr></thead><tbody><tr><td rowspan="9">AN<sub>19</sub></td><td>A1</td><td>ACCTTCACCTGGGCCAGGGA</td></tr><tr><td>A2</td><td>ACCCACGGCTACAAAGCGCA</td></tr><tr><td>A3</td><td>ACTACAGAAAGCCAAACAAA</td></tr><tr><td>A4</td><td>ACCTGGCCTACTGTACACCG</td></tr><tr><td>A5</td><td>AACCGCTCTATGTCCAGCTG</td></tr><tr><td>A6</td><td>ATCTGGACTTTCACAATCAG</td></tr><tr><td>A7</td><td>ACCTTGGCTTGGCTTTGCTG</td></tr><tr><td>A8</td><td>ACACAGTGGGCCAGAGAGAA</td></tr><tr><td>A9</td><td>ATTCACAGAAGGGGATGGCA</td></tr><tr><td rowspan="5">C/TN<sub>19</sub></td><td>S1</td><td>a/gTCTTCTTCTGCTCGGACTC</td></tr><tr><td>S2</td><td>a/gTCCCCATTGGCCTGCTTCG</td></tr><tr><td>S3</td><td>a/gCCAGCTTGGGCCCACGCAG</td></tr><tr><td>S4</td><td>a/gCACCTCCAATGACTAGGGT</td></tr><tr><td>S5</td><td>a/gAAACGGCAGAAGCTGGAGG</td></tr><tr><td rowspan="12">GN<sub>19</sub></td><td>G1</td><td>GACACAGTGGGCCAGAGAGA</td></tr><tr><td>G2</td><td>GTAGCCTCAGTCTTCCCATC</td></tr><tr><td>G3</td><td>GCTCCCATCACATCAACCGG</td></tr><tr><td>G4</td><td>GTACAAACGGCAGAAGCTGG</td></tr><tr><td>G5</td><td>GAGGCCCCCAGAGCAGCCAC</td></tr><tr><td>G6</td><td>GCACAGATGAGAAACTCAGG</td></tr><tr><td>G7</td><td>GAGTCCGAGCAGAAGAAGAA</td></tr><tr><td>G8</td><td>GGGTTAGGGGCCCCAGGCCG</td></tr><tr><td>G9</td><td>GTCACCTCCAATGACTAGGG</td></tr><tr><td>G10</td><td>GCCTCCCCAAAGCCTGGCCA</td></tr><tr><td>G11</td><td>GCCCCGGGCTTCAAGCCCTG</td></tr><tr><td>G12</td><td>GCTTGTCCCTCTGTCAATGG</td></tr></tbody></table></table-wrap></p>
      <p id="Par8">Next, we tested the activity of the mU6 promoter for genome editing with gRNAs initiated with C or T, but changed them to A or G (Table <xref rid="Tab1" ref-type="table">1</xref>). After 3 days of genome editing, gRNAs initiated with G showed higher activity for three of five tested gRNAs (Fig. <xref rid="Fig1" ref-type="fig">1f</xref>; Supplementary Fig. <xref rid="MOESM1" ref-type="media">5a</xref>), but the difference was eliminated after 5 days (Fig. <xref rid="Fig1" ref-type="fig">1g</xref>; Supplementary Fig. <xref rid="MOESM1" ref-type="media">5b</xref>). The mU6 promoter was chosen in the following study.</p>
    </sec>
    <sec id="Sec4">
      <title>A strategy for high-throughput test of gRNA activity</title>
      <p id="Par9">A recent study has shown that a guide RNA–target pair strategy enables high-throughput test of gRNA activity for Cpf1<sup><xref ref-type="bibr" rid="CR32">32</xref></sup>. In this strategy, the synthesized guide RNA–target sequences are delivered into Cas9-expressing cells by lentiviruses (Fig. <xref rid="Fig2" ref-type="fig">2a</xref>). After genome editing, the target sequences are PCR-amplified for deep sequencing, allowing direct measurement of insertion/deletion (indel) rates induced by Cas9 nucleases. An additional advantage is that lentiviruses preferentially integrate into transcriptionally active regions which are much more accessible for the CRISPR/Cas9 machinery<sup><xref ref-type="bibr" rid="CR32">32</xref>–<xref ref-type="bibr" rid="CR34">34</xref></sup>, minimizing the influence of genome editing by chromatin accessibility. Therefore, the data set obtained by this strategy provides the opportunity to elucidate the inherent activity of gRNAs based exclusively on their sequence features.<fig id="Fig2"><label>Fig. 2</label><caption><p>A guide RNA–target pair strategy for high-throughput screen of gRNA activity in human cells. <bold>a</bold> Schematic diagram of the guide RNA–target pair strategy for gRNA activity test. A lentiviral vector contains a mU6 promoter, and a guide RNA–target pair. The vector was used to transduce cells expressing Cas9 nucleases. Indels would be induced at integrated targets by the corresponding gRNAs. <bold>b</bold> Schematic diagram of design and high-throughput screen of a gRNA library. A library of 80,263 guide RNA–target pairs was designed and synthesized by microarray. Oligonucleotides were PCR-amplified and cloned into lentiviral vectors by Gibson assembly. The library was packed into viruses and transduced into cells expressing Cas9 nucleases for genome editing. The integrated target sites were PCR-amplified for deep-sequencing analysis. <bold>c</bold> The Pearson correlation of indel frequency among different experiment repeats. <bold>d</bold> The distribution of gRNA activity for the three Cas9 nucleases</p></caption><graphic xlink:href="41467_2019_12281_Fig2_HTML" id="d29e847"/></fig></p>
      <p id="Par10">Doench et al. developed an online tool that allows designing gRNAs for gene knockout with WT-SpCas9<sup><xref ref-type="bibr" rid="CR25">25</xref></sup>. This tool scans a whole gene-coding sequence and ranks all gRNAs based on activity and off-target effects. We used this tool to design gRNAs for the library screening. Four top-ranked gRNAs initiated with either A or G were selected for each gene (Fig. <xref rid="Fig2" ref-type="fig">2b</xref>). We also designed gRNAs targeting microRNAs. As the lengths of microRNA coding sequences are much shorter than the gene-coding regions, we typically designed three gRNAs for each microRNA. A total of 80,263 oligonucleotides that contain gRNAs and corresponding target sequences (75,312 gRNAs for 19,037 coding genes; 4951 gRNAs for 1549 microRNAs) were synthesized by microarray (Supplementary Data <xref rid="MOESM2" ref-type="media">1</xref>). The oligonucleotides were PCR amplified and cloned into the lentivirus vectors via Gibson assembly. Analysis of the plasmid library by deep sequencing revealed that the error rate (A read contains any mutation was considered as an error) induced by oligonucleotide synthesis or PCR amplification at guide RNA–target sequence region was 36.5%. This plasmid library was used in the following pooled screening experiments to profile gRNA activity for WT-SpCas9, eSpCas9(1.1), and SpCas9-HF1.</p>
      <p id="Par11">The library was packaged into lentiviruses and transduced into HEK293T cells expressing WT-SpCas9, eSpCas9(1.1), or SpCas9-HF1 at an MOI of 0.3. After 5 days of genome editing, genomic DNA was extracted, and the integrated target regions were PCR amplified for deep sequencing (Fig. <xref rid="Fig2" ref-type="fig">2b</xref>). The mutations at guide RNA–target sequence regions can be induced either by Cas9 nucleases or by library construction. If a mutation can be found in the original library, it was considered as a mutation induced by library construction and excluded from indel analysis. Indels could be detected by deep sequencing at the integrated target sites (Supplementary Fig. <xref rid="MOESM1" ref-type="media">6a</xref>). We obtained valid gRNA indel rates (reads number &gt; 100) of 55,604 (covering 20,211 genes), 58,167 (covering 20,315 genes), and 56,888 (covering 20,270 genes) for WT-SpCas9, eSpCas9(1.1), and SpCas9-HF1, respectively (Supplementary Data <xref rid="MOESM3" ref-type="media">2</xref>). To the best of our knowledge, this is the largest gRNA on-target activity sets reported so far in mammalian cells.</p>
      <p id="Par12">The screening assay was experimentally repeated twice, and two independent replicates showed a high level of correlation for indel rate (<italic>R</italic> = 0.92 for WT-SpCas9; <italic>R</italic> = 0.89 for eSpCas9(1.1); <italic>R</italic> = 0.91 for SpCas9-HF1, Fig. <xref rid="Fig2" ref-type="fig">2c</xref>). The indel rate of individual gRNAs also has a strong correlation among three Cas9 nucleases (Fig. <xref rid="Fig2" ref-type="fig">2c</xref>), indicating that some sequence features are favored for these three Cas9 nucleases. The distribution of gRNA activities varied remarkably, from no activity to 100% indel rates for these three Cas9 nucleases (Fig. <xref rid="Fig2" ref-type="fig">2d</xref>). WT-SpCas9 showed higher efficiency of editing than eSpCas9(1.1) and SpCas9-HF1 in our screening (Supplementary Fig. <xref rid="MOESM1" ref-type="media">6b</xref>). Since these were single-cell-derived clones that could influence efficiencies, we selected five gRNAs and transfected them together with individual Cas9 nuclease into cells. WT-SpCas9 and SpCas9-HF1 showed similar activity, but eSpCas9(1.1) showed lower activity at day 3 (Supplementary Fig. <xref rid="MOESM1" ref-type="media">6c</xref>), consistent with previous studies<sup><xref ref-type="bibr" rid="CR15">15</xref>,<xref ref-type="bibr" rid="CR16">16</xref></sup>.</p>
      <p id="Par13">It has been reported that residual plasmid DNA from viral packaging procedures can contaminate transduced cells<sup><xref ref-type="bibr" rid="CR35">35</xref></sup>, resulting in potential inaccuracies in measurement of gRNA activity. We designed a pair of primers specific for the backbone of plasmids to detect residual plasmids, and a pair of primers specific for the lentivirus genomic DNA to detect both residual plasmids and lentiviruses integrated into the genome (Supplementary Fig. <xref rid="MOESM1" ref-type="media">7a</xref>). These two pairs of primers displayed similar efficiency of amplification when plasmid DNA was used as templates (Supplementary Fig. <xref rid="MOESM1" ref-type="media">7b</xref>). The residual plasmid DNA could be detected in both unconcentrated viruses and concentrated viruses during virus packaging (Supplementary Fig. <xref rid="MOESM1" ref-type="media">7b</xref>). We transduced HEK293T cells and extracted genomic DNA at day 1 and day 5 after transduction, respectively. The residual plasmid DNA could be detected in both samples, but the PCR bands were very weak at day 5 with primer specific for backbone, indicating that the residual plasmid degraded over time (Supplementary Fig. <xref rid="MOESM1" ref-type="media">7b</xref>). In contrast, very strong bands could be detected with primers specific for the viruses at day 5, indicating that the more and more lentiviruses integrated into genome. These results suggested that the residual plasmid DNA only had minimal influence on the library screen.</p>
    </sec>
    <sec id="Sec5">
      <title>Sequence features associated with gRNA activity</title>
      <p id="Par14">Characterization of sequence features associated with gRNA activity is crucial for the development of gRNA design tools. This large-scale data set generated here allows us to better evaluate which features contributed most to gRNA activity. Algorithms including gradient-boosted regression trees and lasso regression have been used to assess feature importance<sup><xref ref-type="bibr" rid="CR36">36</xref></sup>. However, gradient-boosted regression trees provide Gini importance scores that only reflect the absolute value of feature contribution, causing the loss of information regarding the direction of the effect; lasso regression displays poor descriptive ability. Fortunately, a recently developed algorithm SHAP (SHapley Additive exPlanation), a unified approach to explain the output of any machine-learning model, can potentially address these limitations<sup><xref ref-type="bibr" rid="CR37">37</xref></sup>.</p>
      <p id="Par15">We connected XGBoost with SHAP (called Tree SHAP) to evaluate the importance of 1031 features, including features identified by Doench and Wong et al.<sup><xref ref-type="bibr" rid="CR25">25</xref>,<xref ref-type="bibr" rid="CR38">38</xref></sup>, and all of the position accessibilities of gRNA secondary structure features (Supplementary Data <xref rid="MOESM4" ref-type="media">3</xref>, <xref rid="MOESM5" ref-type="media">4</xref>). Overall, the predicted scores were strongly influenced by position-dependent nucleotide composition for three Cas9 nucleases (Fig. <xref rid="Fig3" ref-type="fig">3a–c</xref>; Supplementary Data <xref rid="MOESM5" ref-type="media">4</xref>). The most favored nucleotide was G at position 20 (G_20), the nucleotide immediately adjacent to the PAM sequence. Other important features overlapped in the top 20 for three nucleases are melting temperature (<italic>T</italic><sub>m</sub>, favored), number of TT dimers (disfavored), C_18 (favored), self-folding free energy (favored), and G_14 (disfavored).<fig id="Fig3"><label>Fig. 3</label><caption><p>Analysis of feature importance associated with gRNA activity by Tree SHAP. <bold>a</bold>–<bold>c</bold> Top 20% important features identified by Tree SHAP for WT-SpCas9, eSpCas9(1.1), and SpCas9-HF1, respectively. The nucleotides, as well as their position, were shown on the left. GG_19 means GG dimer start at position 19. <italic>T</italic><sub>m</sub> means melting temperature</p></caption><graphic xlink:href="41467_2019_12281_Fig3_HTML" id="d29e982"/></fig></p>
      <p id="Par16">We next evaluated position-dependent nucleotide composition of the highest 25% active gRNAs versus lowest 25% active gRNAs. The results revealed that G was generally favored, and T was generally disfavored (Fig. <xref rid="Fig4" ref-type="fig">4a–c;</xref> Supplementary Data <xref rid="MOESM6" ref-type="media">5</xref>). G_20 was strongly favored for all three Cas9 nucleases, consistent with Tree SHAP analysis. The differences of nucleotide preference between WT-SpCas9 and SpCas9 variants were also observed. The differences of favored nucleotide at position 3 (C/G vs G), 9 (G vs C/G), 10 (A/G vs A/C), 14 (C vs A/T), 16 (A/C vs C), 17 (G vs A), and 18 (C/G vs C) were observed between WT-SpCas9 and eSpCas9(1.1). The differences of favored nucleotide at position 3 (C/G vs G), 5 (G vs C/T), 7 (C/G vs G), 9 (G vs C/G), 10 (A/G vs C), 12 (A/G vs A), 14 (C vs A/T), 17 (G vs A/C), and 18 (C/G vs C) were observed between WT-SpCas9 and SpCas9-HF1. In addition, we analyzed position-independent nucleotide composition with top 20% active gRNAs (Fig. <xref rid="Fig4" ref-type="fig">4d–f</xref>). G (favored) and T (disfavored) content strongly influenced gRNA activity, while A and C content mildly influenced gRNA activity for three Cas9 nucleases, consistent with Tree SHAP values.<fig id="Fig4"><label>Fig. 4</label><caption><p>Influence of nucleotide composition on gRNA activity. <bold>a</bold>–<bold>c</bold> The position-dependent nucleotide composition of the highest 25% active gRNAs versus lowest 25% active gRNAs. Bars showed log-odds scores of nucleotide frequency for each position. The numbers below indicated the position of the nucleotides on-target DNA. <bold>d</bold>–<bold>f</bold> The association of each nucleotide number with gRNA activity. The size of the circles indicated indel frequency</p></caption><graphic xlink:href="41467_2019_12281_Fig4_HTML" id="d29e1014"/></fig></p>
    </sec>
    <sec id="Sec6">
      <title>Performance of conventional algorithms</title>
      <p id="Par17">In addition to generating data sets of gRNA activity, another goal of this work was to develop prediction tools for gRNA design. We evaluated the performance of four conventional gRNA activity prediction algorithms, including Linear regression, L2-regularized linear regression (Ridge regression), XGBoost regression, and multilayer perceptron (MLP) models with data sets generated in this study. To prevent over-fitting, we randomly separated the data set into two subgroups with 85% of the data used as the training data set to train the models, and the remaining 15% held out used to test the generalization capacity of the trained models (Fig. <xref rid="Fig5" ref-type="fig">5a</xref>). To achieve optimal performance, the features with high Tree SHAP values were modeled in the algorithms (Supplementary Data <xref rid="MOESM5" ref-type="media">4</xref>).<fig id="Fig5"><label>Fig. 5</label><caption><p>Performance of different algorithms for gRNA activity prediction. <bold>a</bold> Schematic of data set and conventional algorithms. Four conventional algorithms including linear regression, ridge regression, XGBoost regression, and MLP were constructed, respectively. In all, 85% of the relevant data set was used as the training set, and the reserved 15% of the data set in each set as the test set to measure the generalization ability of each model to predict unseen data. <bold>b</bold> Schematic of the data set and deep-learning algorithms. Deep-learning algorithms including CNN, RNN, and RNN + biofeature were constructed, respectively. In total, 76.5% of the relevant data set was used as the training set, 8.5% of the data set in each set was used as the validation set, and the reserved 15% of the data set in each set was used as the test set to measure the generalization ability of each model to predict unseen data. <bold>c</bold>–<bold>e</bold> Performance of different algorithms for gRNA activity prediction revealed by Spearman correlation for WT-SpCas9, eSpCas9(1.1), and SpCas9-HF1, respectively. The bar plot shows the mean ± s.d. for the Spearman correlation coefficient between predicted and measured gRNA activity scores (<italic>n</italic> = 10)</p></caption><graphic xlink:href="41467_2019_12281_Fig5_HTML" id="d29e1049"/></fig></p>
      <p id="Par18">Of four algorithms tested here, MLP is the most predictive, with Spearman correlation coefficients of 0.8416, 0.8457, and 0.8440 for WT-SpCas9, eSpCas9(1.1), and SpCas9-HF1, respectively (Fig. <xref rid="Fig5" ref-type="fig">5c–e;</xref> Supplementary Data <xref rid="MOESM7" ref-type="media">6</xref>–<xref rid="MOESM9" ref-type="media">8</xref>). XGBoost is the second most predictive, with Spearman correlation coefficients of 0.8454, 0.8310, and 0.8184 for WT-SpCas9, eSpCas9(1.1), and SpCas9-HF1, respectively. Linear regression and ridge regression also performed well, but with relatively lower correlation score. We also tried lasso regression and SVM regression. But the penalty coefficient for lasso regression is nearly zero, which made it equivalent to linear model. SVM regression failed to finish the benchmarking on the current scale of data set within a reasonable time (3 weeks). They were dropped in the final comparison.</p>
    </sec>
    <sec id="Sec7">
      <title>Performance of deep-learning algorithms</title>
      <p id="Par19">Recent studies have shown that two deep-learning-based algorithms, convolutional neural network (CNN) and recurrent neural network (RNN), are powerful tools for DNA/protein sequence-related analysis<sup><xref ref-type="bibr" rid="CR39">39</xref>–<xref ref-type="bibr" rid="CR43">43</xref></sup>. They could obtain useful features from raw DNA/protein sequence automatically without requirement of feature engineering. CNN has been used to predict gRNA activity for Cpf1 and WT-SpCas9<sup><xref ref-type="bibr" rid="CR26">26</xref>,<xref ref-type="bibr" rid="CR27">27</xref></sup>, while RNN has not been used for gRNA activity prediction so far. We trained both CNN and RNN for gRNA activity prediction. To prevent over-fitting, we randomly separated the data set into three subgroups with 76.5% of the data used as the training data set to train the models, 8.5% used as validation data set, and the remaining 15% held out used to test the generalization capacity of the trained models (Fig. <xref rid="Fig5" ref-type="fig">5b</xref>).</p>
      <p id="Par20">RNN outperformed CNN and other algorithms for gRNA activity prediction with Spearman correlation coefficients of 0.8555, 0.8491, and 0.8512 for WT-SpCas9, eSpCas9(1.1), and SpCas9-HF1, respectively (Fig. <xref rid="Fig5" ref-type="fig">5c–e</xref>; Supplementary Data <xref rid="MOESM7" ref-type="media">6</xref>–<xref rid="MOESM9" ref-type="media">8</xref>). CNN obtained similar performance to XGBoost with Spearman correlation coefficients of 0.8455, 0.8313, and 0.8343 for WT-SpCas9, eSpCas9(1.1), and SpCas9-HF1, respectively.</p>
    </sec>
    <sec id="Sec8">
      <title>An integrated model improves predictive power</title>
      <p id="Par21">The backbone of the deep-learning algorithms (CNN or RNN) can only exploit k-mer composition or its dependencies<sup><xref ref-type="bibr" rid="CR39">39</xref>,<xref ref-type="bibr" rid="CR44">44</xref></sup>. Recent studies on protein-related prediction have shown that the prediction ability of deep-learning models could be boosted by addition of other features, such as molecular weight, hydrophobicity, and absolute charge, which could not be automatically obtained by deep-learning models<sup><xref ref-type="bibr" rid="CR45">45</xref>,<xref ref-type="bibr" rid="CR46">46</xref></sup>. In our work, indirect sequence features including position accessibilities of secondary structure, stem–loop of secondary structure, melting temperature, and GC content are strongly associated with gRNA activity (Supplementary Data <xref rid="MOESM5" ref-type="media">4</xref>), but they could not be obtained by deep learning. Considering that the RNN model achieved the best performance of all the algorithms, we thus combined these biological features with RNN for gRNA activity prediction. Interestingly, addition of these features to RNN increased prediction power, with Spearman correlation coefficients of 0.8670, 0.8624, and 0.8603 for WT-SpCas9, eSpCas9(1.1), and SpCas9-HF1, respectively (Fig. <xref rid="Fig5" ref-type="fig">5c–e</xref>). Therefore, RNN integrated with biological features (hereafter referred to as RNN + Biofeature) was used as the final model for gRNA activity prediction (Fig. <xref rid="Fig6" ref-type="fig">6</xref>).<fig id="Fig6"><label>Fig. 6</label><caption><p>DeepHF model for gRNA activity prediction. The original gRNA sequence is first encoded and then embedded to get a new representation. This new representation is further processed by a BiLSTM to get the final representation which is then concatenated with hand-crafted features to serve as the input of the fully connected layer to be nonlinearly transformed. Finally, a linear transformation is performed to get the prediction score</p></caption><graphic xlink:href="41467_2019_12281_Fig6_HTML" id="d29e1131"/></fig></p>
      <p id="Par22">To further test the performance of seven models used in this study, we generated a list of gRNA indel rates for endogenous sites (85 sites for WT-SpCas9, 81 sites for eSpCas9(1.1), and 82 sites for SpCas9-HF1) (Supplementary Data <xref rid="MOESM10" ref-type="media">9</xref>). All seven models worked considerably well, but linear regression and ridge regression were less predictive based on Spearman correlation metrics (Supplementary Figs. <xref rid="MOESM1" ref-type="media">8</xref>–<xref rid="MOESM1" ref-type="media">10</xref>). Due to the limited data set here, we could not conclude which algorithm was statistically better than other algorithms on endogenous sites. We also investigated the correlation of the indel frequency at the synthetic targets with that at the corresponding endogenous targets. The Spearman correlation is 0.722, 0.767, and 0.730 for WT-SpCas9, eSpCas9(1.1), and SpCas9-HF1, respectively (Supplementary Fig. <xref rid="MOESM1" ref-type="media">11a–c</xref>).</p>
    </sec>
    <sec id="Sec9">
      <title>Comparison of the RNN + Biofeature model with existing models</title>
      <p id="Par23">There are several publicly available data sets of gRNA efficiency for WT-SpCas9, which allows us to compare the performance of the RNN + Biofeature model for WT-SpCas9 (hereafter referred to as DeepWt) with existing prediction models. We tested DeepWt against 18 endogenous data sets collected by Haeussler et al.<sup><xref ref-type="bibr" rid="CR47">47</xref></sup>, and obtained Spearman correlation coefficients varied from 0.129 to 0.594 (Supplementary Data <xref rid="MOESM11" ref-type="media">10</xref>). It has been reported that the prediction model strongly depends on whether the gRNA is expressed from a U6 promoter in cells or from a T7 promoter in vitro<sup><xref ref-type="bibr" rid="CR47">47</xref>,<xref ref-type="bibr" rid="CR48">48</xref></sup>. Therefore, the transfer learning strategy was used to improve the prediction ability of our model under different expression conditions. For U6 promoter expression, the performance was improved by fine-tuning of the last hidden layer of DeepWt with XuKBM data set (Supplementary Data <xref rid="MOESM11" ref-type="media">10</xref>). Our final optimized model, named DeepWt_U6, outperformed other seven popular gRNA design tools (Fig. <xref rid="Fig7" ref-type="fig">7a</xref>). Notably, since our gRNA library was designed, in part, by RuleSet2 which was developed by Doench data sets, this comparison may had a bias for DeepWt_U6 on Doench datasets. For T7 promoter expression, we developed another model named DeepWt_T7 by fine-tuning of RNN + biofeature algorithm with Moreno-Mateos2015 data set. This model outperformed other models for design of gRNAs expressed in vitro (Fig. <xref rid="Fig7" ref-type="fig">7b</xref>).<fig id="Fig7"><label>Fig. 7</label><caption><p>Heatmap of Spearman rank correlation coefficients between efficiency scores and data sets. <bold>a</bold> gRNAs transcribed in cells from a U6 promoter. <bold>b</bold> gRNAs transcribed in vitro from a T7 promoter. Cell type, the number of gRNAs, and species are shown on the left. Scores are shown along the horizontal axis, data sets on the vertical. Correlations of an algorithm against its own training data set are shown in gray as they are likely to be overestimated due to over-fitting. The highest scores are in bold</p></caption><graphic xlink:href="41467_2019_12281_Fig7_HTML" id="d29e1189"/></fig></p>
      <p id="Par24">It has been reported that integration of target site accessibility metrics into the model could improve prediction power<sup><xref ref-type="bibr" rid="CR26">26</xref>,<xref ref-type="bibr" rid="CR27">27</xref></sup>. For WT-SpCas9, we fine-tuned the DeepWt_U6 model with DNase I data of KBM-7 cell line obtained from ENCODE, resulting in the DeepWt_Chromatin model. Wang/Xu HL60 and Hart Hct116-2 Lib 1 data sets as well as the corresponding DNase I data were used to test the performance of DeepWt_ Chromatin. However, the Spearman correlation scores were not improved (Supplementary Data <xref rid="MOESM12" ref-type="media">11</xref>). We also retrieved DNase I data of HEK293T cells from ENCODE database and tested whether integration of metrics into the models could improve prediction power for eSpCas9(1.1) and SpCas9-HF1. The DNase I data were processed following the method described by Kim et al.<sup><xref ref-type="bibr" rid="CR26">26</xref></sup>. However, incorporation of these data could not significantly increase the prediction ability (tenfold shuffled validation) for eSpCas9(1.1) and SpCas9-HF1 (Supplementary Data <xref rid="MOESM13" ref-type="media">12</xref>).</p>
    </sec>
    <sec id="Sec10">
      <title>Nucleotide contributions revealed by Deep SHAP</title>
      <p id="Par25">In addition to the prediction accuracy, we are also interested in understanding the mechanisms of the deep-learning model. Lundberg and Lee<sup><xref ref-type="bibr" rid="CR49">49</xref></sup> developed an algorithm called Deep SHAP, which is a high-speed approximation algorithm for SHAP values in deep-learning models. We used Deep SHAP to estimate the position-dependent nucleotide contribution to the deep-learning model. The contribution of each position-dependent nucleotide to gRNA activity was computed from the average value of that position across all the training gRNAs. To make the contribution of nucleotides comparable among WT-SpCas9, eSpCas9(1.1), and SpCas9-HF1, Deep SHAP values were rescaled by the Z-score (i.e., standardization). The nucleotide with a Z-score above 1 or below −1 was considered to have a significant contribution to gRNA activity (Supplementary Fig. <xref rid="MOESM1" ref-type="media">12a</xref>).</p>
      <p id="Par26">There were 16, 21, and 26 significant nucleotides in WT-SpCas9, eSpCas9(1.1), and SpCas9-HF1, respectively. The result revealed that G typically had a positive contribution and T typically had a negative contribution, in agreement with previous observation that Cas9 preferentially binds gRNAs containing purines but not pyrimidines<sup><xref ref-type="bibr" rid="CR50">50</xref></sup>. In addition, multiple Ts in the spacer caused low gRNA expression<sup><xref ref-type="bibr" rid="CR51">51</xref></sup>. We found that most of the significant nucleotides had the same direction of contribution to gRNA activity in all three Cas9 nucleases. Consistent with several previous reports<sup><xref ref-type="bibr" rid="CR38">38</xref>,<xref ref-type="bibr" rid="CR52">52</xref></sup>, the most influential was the nucleotides at position 20, where G_20 had a strong positive contribution and C_20/T_20 had a strong negative contribution. Compared with WT-SpCas9, eSpCas9(1.1)-specific motifs included A_15 (favored), A_17 (favored), G_6-8 (favored), G_14 (disfavored), G_16 (disfavored), T_6 (disfavored), T_11-12 (disfavored); SpCas9-HF1-specific motifs included A_11 (favored), A_13 (disfavored), A_14-15 (favored), A_19-20 (disfavored), G_6-7 (favored), G_14 (disfavored), G_16 (disfavored), T_4 (disfavored), T_6 (disfavored), and T_11 (disfavored) (Supplementary Fig. <xref rid="MOESM1" ref-type="media">12a</xref>).</p>
      <p id="Par27">In addition, the difference of Z-score between Cas9 variants and WT-SpCas9 was calculated to assess changes in nucleotide contributions. The difference above 1 or below −1 was considered to have a significant change (Supplementary Fig. <xref rid="MOESM1" ref-type="media">12b</xref>). Several differences in the contribution direction of the significant nucleotides were observed. Specifically, A_13 contributed negatively to SpCas9-HF1 but not to WT-SpCas9, G_17 contributed positively to WT-SpCas9 but not to eSpCas9(1.1) and HF1-SpCas9, G_18 contributed positively to WT-SpCas9 but contributed negatively to eSpCas9(1.1) (also to HF1-SpCas9, but not significant).</p>
      <p id="Par28">The contribution of repetitive nucleotides to gRNA activities were also investigated based on the sum of Deep SHAP values. For WT-SpCas9, previous study has shown that a stretch of adjacent identical nucleotides (repetitive nucleotides, such as GGGG or TTTT) could be associated with poor efficiency of a sgRNA<sup><xref ref-type="bibr" rid="CR38">38</xref></sup>. However, they did not consider position effects. Therefore, we calculated the average Deep SHAP values of the four repeat nucleotides including AAAA, CCCC, GGGG, and TTTT from position 1 to 18 (Supplementary Data <xref rid="MOESM14" ref-type="media">13</xref>). Our results demonstrated that the repetitive nucleotides generally decreased indel efficiency, consistent with Wong et al.’s study<sup><xref ref-type="bibr" rid="CR38">38</xref></sup>. However, the positive contribution of repeat nucleotides at some positions were observed, including GGGG starting from position 1–5 and 16–18, AAAA starting from position 14, CCCC starting from position 1–2 and 15–18 (Supplementary Data <xref rid="MOESM14" ref-type="media">13</xref>). The positive contribution of repeat nucleotides at some positions was also observed for eSpCas9 (1.1) and SpCas9-HF1. For example, AAAA starting from position 14–15 contributed positively to gRNA activities for both Cas9 nucleases (Supplementary Data <xref rid="MOESM14" ref-type="media">13</xref>).</p>
    </sec>
    <sec id="Sec11">
      <title>The correlation of indel frequency to phenotype</title>
      <p id="Par29">In this study, we used indel rate as the gRNA activity label, which is not equal to real gene knockout efficiency. We tested the correlation between indel frequency and actual gene disruption with a protein-based assay. We designed a total of nine gRNAs targeting SIRT1, SIRT2, and SIRT6 with three gRNAs for each. The gRNAs and Cas9 nucleases were introduced into HEK293T cells with an episomal vector which allowed long-term genome editing<sup><xref ref-type="bibr" rid="CR5">5</xref></sup>. The indel frequency and protein expression was analyzed at day 9 after transfection. The results revealed that indel frequencies had a good correlation to protein expression (<italic>r</italic> = 0.82; Supplementary Fig. <xref rid="MOESM1" ref-type="media">13a, b</xref>). In addition, the correlation between indel frequency and actual gene disruption was tested by a luciferase reporter assay. We designed a total of 11 gRNAs targeting luciferase gene. Five days after genome editing, indel frequency and luciferase activity was analyzed. The results revealed that indel frequencies had a good correlation to luciferase activity (<italic>r</italic> = 0.70, Supplementary Fig. <xref rid="MOESM1" ref-type="media">13c–e</xref>).</p>
    </sec>
    <sec id="Sec12">
      <title>The correlation between on-target and off-target efficiency</title>
      <p id="Par30">The goal of this work is to design gRNAs with better on-target activity, but such gRNAs may be greater tolerance for mismatches and thus induce higher off-target mutations. To test this hypothesis, we selected three sgRNAs with different activity and designed guide–target pairs with double mismatches (Supplementary Fig. <xref rid="MOESM1" ref-type="media">14a</xref>). Off-target cleavage occurred efficiently with target sequences containing mismatches at position 1–8 for WT-SpCas9 (Supplementary Fig. <xref rid="MOESM1" ref-type="media">14b</xref>). As expected, higher on-target activity generally led to higher off-target activity. For eSpCas9(1.1) and SpCas9-HF1, however, the off-target cleavage was at background level except mismatches at position 7–8, where site1-gRNA displayed high off-target cleavage (Supplementary Fig. <xref rid="MOESM1" ref-type="media">14b</xref>). Similar mismatch tolerance was also observed by Slaymaker et al.<sup><xref ref-type="bibr" rid="CR15">15</xref></sup>. Site2-gRNA had comparable activity to site1-gRNA, but its off-target cleavage was at the background level, indicating that mismatch tolerance depends on gRNA sequences.</p>
    </sec>
    <sec id="Sec13">
      <title>Online service</title>
      <p id="Par31">We finally developed an online tool called DeepHF (<underline>Deep</underline> learning for <underline>H</underline>igh-<underline>F</underline>idelity Cas9) based on RNN + biofeature model for gRNA design for WT-SpCas9, eSpCas9(1.1), and SpCas9-HF1. The online tool contains three functional modules, namely prediction module, verified gRNAs module, and design module. Prediction module allows users to get predicted activities for all gRNAs with an input DNA sequence. Verified gRNAs module provides all gRNA indel rates generated in this study. Design module provides gRNAs that are suitable for gene knockout with eSpCas9(1.1) and SpCas9-HF1 in human cells. In this module, gRNAs were chosen from common transcripts of each gene (Genome Reference Consortium Human Build 38). The off-target information (1–3 mismatches considered as off-target) and targeting location (whether in the 5–65% of coding sequence) were also annotated. Users can obtain the predesigned gRNAs by inputting a gene ID or a gene symbol. The website is freely available at <ext-link ext-link-type="uri" xlink:href="http://www.DeepHF.com/">http://www.DeepHF.com/</ext-link>.</p>
    </sec>
  </sec>
  <sec id="Sec14" sec-type="discussion">
    <title>Discussion</title>
    <p id="Par32">Broader application of highly specific Cas9 nucleases has been hampered by lack of knowledge for gRNA design. Our study filled the gap by generating a database of over 50,000 gRNAs covering ~20,000 human genes for eSpCas9(1.1) and SpCas9-HF1. Users can pick efficient gRNAs from the database for gene knockout. In addition, we have shown here that the Tree SHAP algorithm is a powerful tool for evaluation of feature importance. Based on large data set and important features, we optimized seven models for gRNA activity prediction. Importantly, we have demonstrated that RNN + biofeature is to the best of our knowledge, a state-of-the-art model for activity prediction for the three Cas9 nucleases. These useful clues will facilitate the development of optimal computer models for gRNA design for other Cas9 nucleases. We finally developed an online tool for gRNA design for WT-SpCas9, eSpCas9(1.1), and SpCas9-HF1. Taken together, our study will facilitate application of highly specific cas9 nucleases for genome editing.</p>
  </sec>
  <sec id="Sec15">
    <title>Methods</title>
    <sec id="Sec16">
      <title>Cell culture and transfection</title>
      <p id="Par33">HEK293T and HeLa cells (ATCC) were maintained in the Dulbecco’s Modified Eagle Medium (DMEM) supplemented with 10% FBS (Gibco), 100 U/ml penicillin, and 100 mg/ml streptomycin at 37 °C and 5% CO<sub>2</sub>. For transfection, HEK293T or HeLa cells were plated into 24-well or 12-well plates, DNA mixed with Lipofectamine 2000 (Life Technologies) in Opti-MEM according to the manufacturer’s instructions. HEK293T and HeLa cells were used to test the indel efficiency and tested negative for mycoplasma; and cells identities were validated by STR profiling (ATCC).</p>
    </sec>
    <sec id="Sec17">
      <title>Plasmid construction</title>
      <p id="Par34">To compare the activity of hU6 and mU6 promoters for genome editing, plasmids expressing gRNAs were modified from epiCRISPR vectors<sup><xref ref-type="bibr" rid="CR5">5</xref></sup>. Briefly, the EF1-Cas9 fragment (AgeI-NheI) on epiCRISPR was replaced by a CMV promoter, resulting in epiCRISPR-hU6-gRNA vector; the hU6 promoter was replaced by an mU6 promoter using Gibson Assembly (NEB), resulting in epiCRISPR-mU6-gRNA vector. The gRNA oligonucleotide pairs were annealed and cloned into BspQI sites.</p>
      <p id="Par35">To compare the activity of hU6 and mU6 promoters in lentivirus system, we replaced the hU6 promoter (linearization by PCR) on lentiGuide-Puro vector (addgene # 52963) with mU6 promoter by using Gibson Assembly (NEB), resulting in lentiGuide-Puro-mU6. The gRNA oligonucleotide pairs were annealed and cloned into BsmBI sites.</p>
      <p id="Par36">Lenti-gRNA–target vector constructed as follows. First, we replaced the EF1a promoter (AsiSI-XbaI site) on pCDH_EF1_MCS_T2A_Puro vector (SBI, Palo Alto, CA, USA) with CMV promoter, resulting in pCDH_CMV_MCS_T2A_Puro (pCP); second, the mU6 promoter was cloned into XbaI-BstBI site of pCP, resulting in pCP-mU6 (pCmP); third, the eGFP coding sequence was cloned into the BstBI-BamHI site of pCmP, resulting in pCmP-eGFP (pCmeP); finally, the “Filler” fragment was PCR amplified from plentiCRISPR<sup><xref ref-type="bibr" rid="CR53">53</xref></sup> and cloned into pCmeP (BstBI-XhoI site), resulting Lenti-gRNA–target vector (Supplementary Fig. <xref rid="MOESM1" ref-type="media">15</xref>).</p>
    </sec>
    <sec id="Sec18">
      <title>Lentivirus production</title>
      <p id="Par37">For individual sgRNA packaging, HEK293T cells were seeded at ~40% confluency in a six-well dish the day before transfection. For each well, 1.2 μg of gRNA expressing plasmid, 0.9 μg of psPAX2, and 0.3 μg of pMD2.G (Addgene) were transfected using 5 μl of Lipofectamine 2000 (Life Technologies). Media was changed 8 h after transfection. After 48 h, virus supernatants were collected and filtered with a 0.45 μm polyvinylidene fluoride filter and stored at −80 °C.</p>
      <p id="Par38">For library packaging, HEK293T cells were seeded at ~40% confluency in five 10-cm dishes the day before transfection. For each dish, 12 μg of plasmid library, 9 μg of psPAX2, and 3 μg of pMD2.G (Addgene) were transfected with 60 μl of Lipofectamine 2000 (Life Technologies). Virus was harvested twice at 48 h and 72 h post transfection. The virus was concentrated using PEG8000 (no. LV810A-1, SBI, Palo Alto, CA) dissolved in PBS and stored at −80 °C.</p>
    </sec>
    <sec id="Sec19">
      <title>Cell line expressing Cas9 generation</title>
      <p id="Par39">We introduced mutations on Cas9 nucleases on the LentiCas9-blast<sup><xref ref-type="bibr" rid="CR54">54</xref></sup> plasmid and generated plasmid expressing eSpCas9 (1.1) and SpCas9-HF1, respectively. LentiCas9-blast plasmid was packaged and transduced into HEK293T and HeLa cells. After 24 h, cells were selected with 10 μg/ml of blasticidin for 14 days. Single cells were sorted into 96-well plates for colony formation. Western blot with Anti-flag antibody was performed to screen cell clones with high levels of Cas9 expression (Supplementary Fig. <xref rid="MOESM1" ref-type="media">16</xref>). Western blots were incubated overnight at 4 °C with anti-FLAG antibody (14793 S, CST) at 1:1000 dilution.</p>
    </sec>
    <sec id="Sec20">
      <title>The gRNA library design</title>
      <p id="Par40">The gRNAs targeting microRNAs were designed using an in-house Python script. The gRNAs were selected if they satisfied the following criteria: (1) initiated with either A or G; (2) without four consecutive thymines (T). For each microRNA, we chose four gRNAs if possible or all of them if the number of gRNAs was less than four. Consequently, we designed a total of 4951 gRNAs covering 1549 human microRNAs.</p>
      <p id="Par41">The gRNAs targeting coding sequences in the library were designed by an online tool (<ext-link ext-link-type="uri" xlink:href="https://portals.broadinstitute.org/gpp/public/analysis-tools/sgrna-design">https://portals.broadinstitute.org/gpp/public/analysis-tools/sgrna-design</ext-link>) developed by Doench et al.<sup><xref ref-type="bibr" rid="CR25">25</xref></sup>. We selected ~four top-ranked gRNAs for each gene. A total of 75,312 gRNAs covering 19,037 human coding genes was designed. DNA oligonucleotides were synthesized and purchased from CustomArray, Inc. (Bothell, WA). The sequences of the oligonucleotides are listed in Supplementary Data <xref rid="MOESM2" ref-type="media">1</xref>.</p>
    </sec>
    <sec id="Sec21">
      <title>The gRNA library construction</title>
      <p id="Par42">Full-length oligonucleotides were PCR-amplified using Q5 High-Fidelity 2X Master Mix (NEB), size-selected using a 2% agarose EGel EX (Life Technologies, Qiagen), and purified using MinElute Gel Extraction Kit (Qiagen). PCR products were cloned into Lentiviral vector (Supplementary Fig. <xref rid="MOESM1" ref-type="media">15</xref>) by Gibson Assembly (NEB) and purified with Agencourt AMPure XP SPRI beads according to the manufacturer’s instructions (Beckman Coulter). The Gibson Assembly products were electroporated into MegaX DH10B<sup>TM</sup> T1<sup>R</sup> Electrocomp<sup>TM</sup> Cells (Invitrogen) according to the manufacturer’s protocol using a GenePulser (BioRad) and grown at 32 °C, 225 rpm for 16 h. The bacterial clones covered the library at least 25-fold. The plasmid DNA was extracted from bacterial cells using Endotoxin-Free Plasmid Maxiprep (Qiagen).</p>
    </sec>
    <sec id="Sec22">
      <title>Screening experiments in human cells</title>
      <p id="Par43">HEK293T cells were plated into 15 cm dish at ~30% confluence. After 24 h, cells were infected with gRNA library with at least 1000-fold coverage of each gRNAs. After 24 h, the cells were cultured in the media supplemented with 2 µg/ml of puromycin for 4 days. Cells were harvested and the genomic DNA was isolated using Blood &amp; Cell Culture DNA Kits (Qiagen) following the manufacturer’s instructions. The integrated region containing the gRNA coding sequences and target sequences were PCR amplified using primers Deep-seq-library-F/R with Q5 High-Fidelity 2X Master Mix (NEB). We performed 66 PCR reactions using 10 µg of genomic DNA as a template per reaction for deep-sequencing analysis; we took eight independent PCR reactions using 20 ng of plasmid DNA as a template per reaction. The PCR conditions: 98 °C for 2 min, 25 cycles of 98 °C for 7 s, 67 °C for 15 s, and 72 °C for 10 s, and the final extension, 72 °C for 2 min. The PCR products were mixed and purified using the Gel Extraction Kit (Qiagen). The purified products were sequenced on Illumina HiSeq X by 150-bp paired-end sequencing.</p>
    </sec>
    <sec id="Sec23">
      <title>PCR assay to detect residual plasmid</title>
      <p id="Par44">A pair of primers were designed in the outer and inner regions of the lentivirus packaging sequence to detect the residual plasmids and the integration of lentivirus (PF1: gtcggggctggcttaactat, PR1: taatcgccttgcagcacatc; LF1: tttccgggactttcgctttc, LR1: aagggacgtagcagaaggac). Then seven different templets were tested (H20; Blank genome DNA, 200 ng; pasmid, 10 ng; unconcentrated virus, 2 µl; concentrated virus, 2 µl; isolated genomic DNA, 1 day after lentivirus transduction, 200 ng; isolated genomic DNA, 5 day after lentivirus transduction, 200 ng). PCR conditions: 98 °C for 2 min, 25 cycles of 98 °C for 7 s, 65 °C for 15 s, and 72 °C for 15 s, and the final extension, 72 °C for 2 min. The PCR products were detected using a 2% agarose EGel EX (Life Technologies, Qiagen).</p>
    </sec>
    <sec id="Sec24">
      <title>Analysis of indel frequencies from deep-sequencing data</title>
      <p id="Par45">Illumina sequencing raw reads were processed using in-house Python scripts which combine a series of analysis tools. To avoid the influence of low-quality reads, FASTQ Masker (FASTX-Toolkit Version 0.0.13) was used to mask nucleotides with character “N” based on a quality score &lt;10. Reads exactly matching scaffold sequence (gttttagagctagaaatagcaagttaaaataaggctagtccgttatcaacttgaaaaagtggcaccgagtcggtgcttttt) were extracted using AWK. Designed gRNA sequences were used as barcodes to demultiplexed the validated reads (reads contain less than 4 “N” nucleotides, barcode, and target region contains no “N”). Target regions were then extracted, and aligned to the index which was built from the designed gRNA sequences using Bowtie (version 1.2). For the plasmid library without genome editing, the target sequences not identical to the corresponding gRNA sequence were considered as synthesis/PCR errors. The target sequences in the edited library identical to the synthesis/PCR errors were removed from the edited library data. The remaining sequences not identical to the corresponding gRNA sequence were considered as edited sequences. Thus, the indel frequency of a gRNA was calculated by the following formula:<disp-formula id="Equa"><alternatives><tex-math id="M1">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathrm{indel}}\,{\mathrm{frequency}} = \frac{{{\mathrm{Number}}\,{\mathrm{of}}\,{\mathrm{edited}}\,{\mathrm{reads}}\,{\mathrm{per}}\,{\mathrm{gRNA}}}}{{{\mathrm{Number}}\,{\mathrm{of}}\,{\mathrm{total}}\,{\mathrm{reads}}\,{\mathrm{per}}\,{\mathrm{gRNA}}}}$$\end{document}</tex-math><mml:math id="M2"><mml:mi mathvariant="normal">indel</mml:mi><mml:mspace width="0.25em"/><mml:mi mathvariant="normal">frequency</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi mathvariant="normal">Number</mml:mi><mml:mspace width="0.25em"/><mml:mi mathvariant="normal">of</mml:mi><mml:mspace width="0.25em"/><mml:mi mathvariant="normal">edited</mml:mi><mml:mspace width="0.25em"/><mml:mi mathvariant="normal">reads</mml:mi><mml:mspace width="0.25em"/><mml:mi mathvariant="normal">per</mml:mi><mml:mspace width="0.25em"/><mml:mi mathvariant="normal">gRNA</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">Number</mml:mi><mml:mspace width="0.25em"/><mml:mi mathvariant="normal">of</mml:mi><mml:mspace width="0.25em"/><mml:mi mathvariant="normal">total</mml:mi><mml:mspace width="0.25em"/><mml:mi mathvariant="normal">reads</mml:mi><mml:mspace width="0.25em"/><mml:mi mathvariant="normal">per</mml:mi><mml:mspace width="0.25em"/><mml:mi mathvariant="normal">gRNA</mml:mi></mml:mrow></mml:mfrac></mml:math><graphic xlink:href="41467_2019_12281_Article_Equa.gif" position="anchor"/></alternatives></disp-formula></p>
    </sec>
    <sec id="Sec25">
      <title>Model summary of deep learning</title>
      <p id="Par46">The task of gRNA indel frequency prediction can be phrased as a regression problem. A mapping function was built to input the representations of gRNA sequence and outputs the indel frequency score in the range [0,1]. The mapping function here is Bidirectional long short-term memory neural network (BiLSTM) (a particular subclass of RNN, i.e., recurrent neural network). Unlike convolutional neural network (CNN) which treats DNA input as a grayscale image with only two possible values for each pixel rather than on real continuous-valued images in computer vision field, RNN is a special type of neural network designed for ordered sequence problems<sup><xref ref-type="bibr" rid="CR55">55</xref></sup>. RNN is considered more natural to regard one DNA sequence as a sentence with four types of characters, namely A, C, G, and T, rather than an image, and thus related research work in natural language processing has offered valuable experience for DNA sequence modeling<sup><xref ref-type="bibr" rid="CR56">56</xref></sup>. RNN have connections that have loops, adding feedback and memory to the networks over time or spatial sequences. This memory allows this type of network to learn and generalize across sequences of inputs rather than individual patterns. LSTM further takes the advantage of “gates” to control the degree of influence from the previous sequence features, which made it more flexible in controlling the memory. A BiLSTM exploits the order sensitivity of RNNs: it consists of using two LSTM layers, each of which processes the input sequence in one direction (chronologically and anti-chronologically), and then merging their representations. By processing a sequence both ways, a BiLSTM can catch patterns that may be overlooked by a unidirectional RNN. Borrowed from the natural language processing applications<sup><xref ref-type="bibr" rid="CR57">57</xref></sup>, the gRNA sequence input was transformed to a matrix <bold>x</bold> = (<bold><italic>x</italic></bold><sub>1</sub>, <bold><italic>x</italic></bold><sub>2</sub>, …, <bold><italic>x</italic></bold><sub><italic>i</italic></sub>, <bold><italic>x</italic></bold><sub><italic>l</italic></sub>), which was a <bold><italic>l</italic></bold> × 4 matrix (<italic>l</italic> = 21 means gRNA sequence length is 21 here, and <bold><italic>x</italic></bold><sub><italic>i</italic></sub> means binary vector of four A, T, C, G nucleotides).</p>
    </sec>
    <sec id="Sec26">
      <title>Embedding</title>
      <p id="Par47">Embedding is quite useful for mapping a sparse matrix from input vector to a dense real-valued high-dimensional space, which can facilitate the training process. In natural language processing problems, typical model uses a word as its smallest input entity or a character level uses the character of alphabets as the smallest entity. Thus, we can consider the nucleotides in the gRNA sequence as word (naturally a character, too), and the gRNA sequence itself as a sentence. For this research, the input matrix <inline-formula id="IEq1"><alternatives><tex-math id="M3">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathbf{x}} \in {\Bbb R}^{L \times 4}$$\end{document}</tex-math><mml:math id="M4"><mml:mi mathvariant="bold">x</mml:mi><mml:mo>∈</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow><mml:mrow><mml:mi>L</mml:mi><mml:mo>×</mml:mo><mml:mn>4</mml:mn></mml:mrow></mml:msup></mml:math><inline-graphic xlink:href="41467_2019_12281_Article_IEq1.gif"/></alternatives></inline-formula> (<italic>L</italic> here is 21, the sequence length of gRNA) is projected to the dense real-valued space <inline-formula id="IEq2"><alternatives><tex-math id="M5">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathbf{E}} \in {\Bbb R}^{L \times m}$$\end{document}</tex-math><mml:math id="M6"><mml:mi mathvariant="bold">E</mml:mi><mml:mo>∈</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow><mml:mrow><mml:mi>L</mml:mi><mml:mo>×</mml:mo><mml:mi>m</mml:mi></mml:mrow></mml:msup></mml:math><inline-graphic xlink:href="41467_2019_12281_Article_IEq2.gif"/></alternatives></inline-formula> (<bold>E</bold> is embedding matrix, <italic>m</italic> is a hyperparameter corresponds to the embedding dimension) by the lookup matrix (embedding weight matrix) <bold>W</bold><sub><italic>m</italic></sub> (i.e., <bold>E</bold> = <bold>x</bold><bold><italic>W</italic></bold><sub><italic>m</italic></sub>). Then, the embedding matrix <bold>E</bold> will be the input matrix of RNN.</p>
    </sec>
    <sec id="Sec27">
      <title>BiLSTM</title>
      <p id="Par48">As a de facto standard of RNN architectures, LSTM has achieved a very significant results in a variety of sequence-based tasks. However, the recently proposed Gated Recurrent Unit (GRU) architecture (a simplified LSTM architecture) mostly used in the context of machine translation<sup><xref ref-type="bibr" rid="CR58">58</xref></sup>, did not show any significant improvement upon standard LSTM. The difference between the standard LSTM and simple RNN is the hidden layer. For example, given the input matrix <inline-formula id="IEq3"><alternatives><tex-math id="M7">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathbf{E}} \in {\Bbb R}^{L \times m}$$\end{document}</tex-math><mml:math id="M8"><mml:mi mathvariant="bold">E</mml:mi><mml:mo>∈</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow><mml:mrow><mml:mi>L</mml:mi><mml:mo>×</mml:mo><mml:mi>m</mml:mi></mml:mrow></mml:msup></mml:math><inline-graphic xlink:href="41467_2019_12281_Article_IEq3.gif"/></alternatives></inline-formula>, a simple RNN produces matrix <bold>H</bold> of size <italic>L</italic> × <italic>n</italic> (where <italic>n</italic> is the RNN units). At each time step <italic>l</italic>, let <inline-formula id="IEq4"><alternatives><tex-math id="M9">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\boldsymbol{e}}_l \in {\Bbb R}^m$$\end{document}</tex-math><mml:math id="M10"><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">e</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:msub><mml:mo>∈</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msup></mml:math><inline-graphic xlink:href="41467_2019_12281_Article_IEq4.gif"/></alternatives></inline-formula> as the input column vector, <inline-formula id="IEq5"><alternatives><tex-math id="M11">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\boldsymbol{h}}_{l - 1} \in {\Bbb R}^n$$\end{document}</tex-math><mml:math id="M12"><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">h</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>∈</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msup></mml:math><inline-graphic xlink:href="41467_2019_12281_Article_IEq5.gif"/></alternatives></inline-formula> as the previous hidden state vector, the current state <bold><italic>h</italic></bold><sub><italic>l</italic></sub> by the following way:<disp-formula id="Equ1"><label>1</label><alternatives><tex-math id="M13">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\boldsymbol{h}}_l = \sigma \left( {{\boldsymbol{e}}_{\boldsymbol{l}}{\mathbf{W}} + {\boldsymbol{h}}_{l - 1}{\mathbf{U}} + {\boldsymbol{b}}} \right)$$\end{document}</tex-math><mml:math id="M14"><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">h</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>σ</mml:mi><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">e</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">l</mml:mi></mml:mrow></mml:msub><mml:mi mathvariant="bold">W</mml:mi><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">h</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mi mathvariant="bold">U</mml:mi><mml:mo>+</mml:mo><mml:mi mathvariant="bold-italic">b</mml:mi></mml:mrow></mml:mfenced></mml:math><graphic xlink:href="41467_2019_12281_Article_Equ1.gif" position="anchor"/></alternatives></disp-formula></p>
      <p id="Par49">where <bold>W</bold>, <bold>U</bold>, and <bold>b</bold> are the trainable parameters, and <bold>σ</bold> is the nonlinear activation function. However, in LSTM, a well-designed gating mechanism avoids the “vanishing gradients” problem which made it more applicable on relatively long sequences. These gates can be trained to control the information flow of hidden neurons. The LSTM unit used in this research is implemented by replacing the aforementioned Eq. <xref rid="Equ1" ref-type="">(1)</xref>, which contains <bold>e</bold><sub><italic>l</italic></sub>, <bold>h</bold><sub><italic>l</italic>−1</sub>, <bold>c</bold><sub><italic>l</italic>−1</sub> as input, and produce <bold>h</bold><sub><italic>l</italic></sub>, <bold>c</bold><sub><italic>l</italic></sub> (<bold>c</bold><sub><italic>l</italic></sub> is candidate state,):<disp-formula id="Equ2"><label>2</label><alternatives><tex-math id="M15">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathbf{i}}_l = {\mathrm{\sigma }}\left( {{\mathbf{e}}_l{\mathbf{W}}^{\mathrm{i}} + {\mathbf{h}}_{l - 1}{\mathbf{U}}^{\mathrm{i}} + {\mathbf{b}}^{\mathrm{i}}} \right)$$\end{document}</tex-math><mml:math id="M16"><mml:msub><mml:mrow><mml:mi mathvariant="bold">i</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi mathvariant="normal">σ</mml:mi><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold">e</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:msub><mml:msup><mml:mrow><mml:mi mathvariant="bold">W</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">i</mml:mi></mml:mrow></mml:msup><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold">h</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:msup><mml:mrow><mml:mi mathvariant="bold">U</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">i</mml:mi></mml:mrow></mml:msup><mml:mo>+</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="bold">b</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">i</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mfenced></mml:math><graphic xlink:href="41467_2019_12281_Article_Equ2.gif" position="anchor"/></alternatives></disp-formula><disp-formula id="Equ3"><label>3</label><alternatives><tex-math id="M17">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathbf{f}}_l = {\mathrm{\sigma }}\left( {{\mathbf{e}}_l{\mathbf{W}}^{\mathrm{f}} + {\mathbf{h}}_{l - 1}{\mathbf{U}}^{\mathrm{f}} + {\mathbf{b}}^{\mathrm{f}}} \right)$$\end{document}</tex-math><mml:math id="M18"><mml:msub><mml:mrow><mml:mi mathvariant="bold">f</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi mathvariant="normal">σ</mml:mi><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold">e</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:msub><mml:msup><mml:mrow><mml:mi mathvariant="bold">W</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">f</mml:mi></mml:mrow></mml:msup><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold">h</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:msup><mml:mrow><mml:mi mathvariant="bold">U</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">f</mml:mi></mml:mrow></mml:msup><mml:mo>+</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="bold">b</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">f</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mfenced></mml:math><graphic xlink:href="41467_2019_12281_Article_Equ3.gif" position="anchor"/></alternatives></disp-formula><disp-formula id="Equ4"><label>4</label><alternatives><tex-math id="M19">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathbf{c}}_l = {\mathbf{f}}_l \odot {\mathbf{c}}_{l - 1} + {\mathbf{i}}_l \odot {\mathrm{tanh}}\left( {{\mathbf{e}}_l{\mathbf{W}}^{\mathrm{c}} + {\mathbf{h}}_{l - 1}{\mathbf{U}}^{\mathrm{c}} + {\mathbf{b}}^{\mathrm{c}}} \right)$$\end{document}</tex-math><mml:math id="M20"><mml:msub><mml:mrow><mml:mi mathvariant="bold">c</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold">f</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:msub><mml:mo>⊙</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold">c</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold">i</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:msub><mml:mo>⊙</mml:mo><mml:mi mathvariant="normal">tanh</mml:mi><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold">e</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:msub><mml:msup><mml:mrow><mml:mi mathvariant="bold">W</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">c</mml:mi></mml:mrow></mml:msup><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold">h</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:msup><mml:mrow><mml:mi mathvariant="bold">U</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">c</mml:mi></mml:mrow></mml:msup><mml:mo>+</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="bold">b</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">c</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mfenced></mml:math><graphic xlink:href="41467_2019_12281_Article_Equ4.gif" position="anchor"/></alternatives></disp-formula><disp-formula id="Equ5"><label>5</label><alternatives><tex-math id="M21">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathbf{o}}_l = {\mathrm{\sigma }}\left( {{\mathbf{e}}_l{\mathbf{W}}^{\mathrm{o}} + {\mathbf{h}}_{l - 1}{\mathbf{U}}^{\mathrm{o}} + {\mathbf{b}}^{\mathrm{o}}} \right)$$\end{document}</tex-math><mml:math id="M22"><mml:msub><mml:mrow><mml:mi mathvariant="bold">o</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi mathvariant="normal">σ</mml:mi><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold">e</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:msub><mml:msup><mml:mrow><mml:mi mathvariant="bold">W</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">o</mml:mi></mml:mrow></mml:msup><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold">h</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:msup><mml:mrow><mml:mi mathvariant="bold">U</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">o</mml:mi></mml:mrow></mml:msup><mml:mo>+</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="bold">b</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">o</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mfenced></mml:math><graphic xlink:href="41467_2019_12281_Article_Equ5.gif" position="anchor"/></alternatives></disp-formula><disp-formula id="Equ6"><label>6</label><alternatives><tex-math id="M23">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathbf{h}}_l = {\mathbf{o}}_l \odot {\mathrm{tanh}}(c_l)$$\end{document}</tex-math><mml:math id="M24"><mml:msub><mml:mrow><mml:mi mathvariant="bold">h</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold">o</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:msub><mml:mo>⊙</mml:mo><mml:mi mathvariant="normal">tanh</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:math><graphic xlink:href="41467_2019_12281_Article_Equ6.gif" position="anchor"/></alternatives></disp-formula>where <bold>W</bold>, <bold>U</bold>, <bold>V</bold>, and <bold>b</bold> are the trainable parameters, σ(·),tanh(·), and ⊙ are element-wise sigmoid, hyperbolic tangent, and multiplication functions, respectively. <bold>i</bold><sub><italic>l</italic></sub>, <bold>f</bold><sub><italic>l</italic></sub>, and <bold>o</bold><sub><italic>l</italic></sub> are the input, forget, and output gates.</p>
      <p id="Par50">Due to the bidirectional reason, the model processes input data both in the forward and backward orders, allowing to combine the 5′ and 3′ gRNA sequence information in every time step. In parallel, one output is in forward order which is defined as <inline-formula id="IEq6"><alternatives><tex-math id="M25">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{\mathop{\boldsymbol{h}}\limits^{\rightharpoonup} }}$$\end{document}</tex-math><mml:math id="M26"><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold-italic">h</mml:mi></mml:mrow><mml:mrow><mml:mo>⇀</mml:mo></mml:mrow></mml:mover></mml:math><inline-graphic xlink:href="41467_2019_12281_Article_IEq6.gif"/></alternatives></inline-formula>, the other output is in reverse order which defined as <inline-formula id="IEq7"><alternatives><tex-math id="M27">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\overleftarrow {\boldsymbol{h}}$$\end{document}</tex-math><mml:math id="M28"><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold-italic">h</mml:mi></mml:mrow><mml:mo>⃖</mml:mo></mml:mover></mml:math><inline-graphic xlink:href="41467_2019_12281_Article_IEq7.gif"/></alternatives></inline-formula>. Then, two hidden states are combined and generates an output vector <bold>h</bold><sub><italic>bi</italic>_<italic>l</italic></sub>:<disp-formula id="Equ7"><label>7</label><alternatives><tex-math id="M29">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathbf{h}}_{{bi}\_{l}} = {\rm{{Bidirectional}}}\,({{\mathop{\mathbf{h}}\limits^{\rightharpoonup} }}_l,{{\mathop{\boldsymbol{h}}\limits^{\leftharpoonup} }}_l)$$\end{document}</tex-math><mml:math id="M30"><mml:msub><mml:mrow><mml:mi mathvariant="bold">h</mml:mi></mml:mrow><mml:mrow><mml:mi>b</mml:mi><mml:mi>i</mml:mi><mml:mstyle><mml:mtext>_</mml:mtext></mml:mstyle><mml:mi>l</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi mathvariant="normal">Bidirectional</mml:mi><mml:mspace width="0.25em"/><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold">h</mml:mi></mml:mrow><mml:mrow><mml:mo>⇀</mml:mo></mml:mrow></mml:mover></mml:mrow><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold-italic">h</mml:mi></mml:mrow><mml:mrow><mml:mo>↼</mml:mo></mml:mrow></mml:mover></mml:mrow><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:math><graphic xlink:href="41467_2019_12281_Article_Equ7.gif" position="anchor"/></alternatives></disp-formula>where Bidirectional(·) is a function used to combine the two output sequences. It can be a concatenating function, a summation function, an average function or a multiplication function. In this research, a concatenating function was adopted to get a <bold>2n</bold> output vector <bold>h</bold><sub><italic>bi</italic>_<italic>l</italic></sub> as the learned feature representation of gRNA sequence.</p>
    </sec>
    <sec id="Sec28">
      <title>Hand-crafted biological features</title>
      <p id="Par51">A lot of studies have shown that hand-crafted features may provide complementary information with CNN or RNN, which may give improved performance than only using the features automatically generated from the representation learning process. Motivated by this, we combined the secondary structural feature, GC content features, and thermodynamics features together with feature representations obtained from RNN to enhance the predictive capability of LSTM. Detailed hand-crafted features are shown in Supplementary Table <xref rid="MOESM1" ref-type="media">1</xref>. Here, we concatenate the biological feature vector <inline-formula id="IEq8"><alternatives><tex-math id="M31">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathbf{h}}_{\mathbf{bio}} \in {\Bbb R}^p$$\end{document}</tex-math><mml:math id="M32"><mml:msub><mml:mrow><mml:mi mathvariant="bold">h</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold">bio</mml:mi></mml:mrow></mml:msub><mml:mo>∈</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msup></mml:math><inline-graphic xlink:href="41467_2019_12281_Article_IEq8.gif"/></alternatives></inline-formula>, with <bold>h</bold><sub><italic>bi</italic>_<italic>l</italic></sub> from the previous BiLSTM stage and get <bold>h</bold><sub>new</sub> = concat ([<bold>h</bold><sub>bio</sub>, <bold>h</bold><sub><italic>bi</italic>_<italic>l</italic></sub>]) as the final representations of the gRNA sequence. The dimension of <bold>h</bold><sub>new</sub> is <bold><italic>l</italic></bold> × 2<italic>n</italic> + <italic>p</italic>.</p>
    </sec>
    <sec id="Sec29">
      <title>Fully connected layers</title>
      <p id="Par52">The previous concatenated feature representation <bold>h</bold><sub>new</sub> is the input of the fully connected layers. The number of layers, the hidden units, the activation function, and the dropout rate of each layer were determined by hyperparameter searching (described in the following Model training section). These layers are used to create final nonlinear combinations of features and for making predictions by the network.</p>
    </sec>
    <sec id="Sec30">
      <title>Model training</title>
      <p id="Par53">The number of validated deep-sequencing gRNAs is 55,604, 58,167, and 56,888 for eSpCas9(1.1) and SpCas9-HF1, respectively. Because of lacking appropriate third-party validation data sets and in order to get a more reliable training result, the data set were split into three subsets: 76.5% (42,537 for WT-SpCas9, 44,842 for eSpCas9(1.1), and 43,518 for SpCas9-HF1) for training, 8.5% (4726 for WT-SpCas9, 4982 for eSpCas9(1.1), and 4835 for SpCas9-HF1) for validation, and 15% (8341 for WT-SpCas9, 8793 for eSpCas9(1.1), and 8534 for SpCas9-HF1) for testing, respectively. The training data set was used to tune the parameters, the validation set was used to avoid over-fitting, and the testing set was used for the evaluation of the model performance. The performance metrics of the trained model are mean-squared error and Spearman correlation score. The hyperparameter searching space included 12 different hyperparameters, formed more than 237 billion parameter combinations. It is too large for a traditional grid search manner to get the optimized parameters. We, therefore, implemented a Bayesian optimization process to reduce the searching time, which has been confirmed to be more reliable than randomized grid search. The optimization program GpyOpt was developed by the machine-learning group of the University of Sheffield<sup><xref ref-type="bibr" rid="CR59">59</xref></sup>. The number of initial random searching points was 30, which provided a clue for the best parameter, and then 300 acquisitions were implemented to attempt to get a global optimum within specified iterations. After getting the optimized hyperparameters of the models, a tenfold shuffled validation was implemented to evaluate the stability of the performance. The mean and standard deviation of the performance measures were obtained. The detailed hyperparameters are described in supplementary notes.</p>
    </sec>
    <sec id="Sec31">
      <title>Feature engineering and model comparisons</title>
      <p id="Par54">For the benchmark purpose, we trained simple Linear regression, L1-regularized linear regression (lasso regression), L2-regularized linear regression (Ridge regression), SVM regression, XGBoost regression, multilayer perceptron (MLP), CNN, and RNN models as baseline models. Like the deep-learning models, the hyperparameters were searched and determined by GpyOpt. The detailed hyperparameter configurations are shown in Supplementary Data <xref rid="MOESM15" ref-type="media">14</xref>–<xref rid="MOESM19" ref-type="media">18</xref>.</p>
      <p id="Par55">Feature engineering was implemented by a recently developed method called Tree SHAP (SHapley Additive exPlanations), which combined SHAP value with XGBoost algorithm. Previously, feature selection for gRNA activity was usually implemented by tree ensemble methods<sup><xref ref-type="bibr" rid="CR25">25</xref>,<xref ref-type="bibr" rid="CR28">28</xref></sup>. However, the metrics of these methods (such as Gini importance or weight) lack of consistency (their value should not decrease when the true impact of that feature is increased) and accuracy (the sum of all the feature importance should sum up to the total importance)<sup><xref ref-type="bibr" rid="CR49">49</xref>,<xref ref-type="bibr" rid="CR60">60</xref></sup>. Tree SHAP addresses it by recent applications of game theory and develop fast exact tree solutions for SHAP values, which are the unique consistent and locally accurate additive feature attribution method based on expectations<sup><xref ref-type="bibr" rid="CR60">60</xref></sup>. The final features adopted in the conventional algorithms were determined by the top 70% of the most important features which measured by SHAP value.</p>
    </sec>
    <sec id="Sec32">
      <title>Model interpretability</title>
      <p id="Par56">In addition to the prediction accuracy, we are also interested in the mechanisms of the deep-learning model. However, the multilayer nonlinear hidden units lead to a trade-off between the complexity and interpretability of deep neural network. The community has made a lot of efforts to understand the black box nature of the deep-learning model, which can be roughly divided into perturbation-based methods (suffers from the unacceptable computation cost) and backpropagation-based methods (may face problems of vanishing gradient and gradient discontinuity)<sup><xref ref-type="bibr" rid="CR61">61</xref></sup>. A recently proposed method called DeepLift had proved especially useful in Recurrent Neural Networks where saturating activations like sigmoid or tanh are popular<sup><xref ref-type="bibr" rid="CR62">62</xref></sup>, and was adopted by Lundberg and Lee to adapt DeepLIFT as a compositional approximation of SHAP values (introduced in the previous section, indicates the feature importance), leading to Deep SHAP. We use Deep SHAP to calculate the SHAP values to estimate the feature importance of sequence input into the best model.</p>
    </sec>
    <sec id="Sec33">
      <title>Tools used in the study</title>
      <p id="Par57">RNAfold 2.4.5<sup><xref ref-type="bibr" rid="CR63">63</xref></sup> was used to generate secondary structure features and thermodynamic features. Scikit-learn 0.19.1<sup><xref ref-type="bibr" rid="CR64">64</xref></sup> and Keras 2.1.6<sup><xref ref-type="bibr" rid="CR65">65</xref></sup> (<ext-link ext-link-type="uri" xlink:href="https://github.com/fchollet/keras">https://github.com/fchollet/keras</ext-link>.) with TensorFlow 1.8.0<sup><xref ref-type="bibr" rid="CR66">66</xref></sup> as backend were used for conventional machine-learning algorithms and deep-learning models, respectively.</p>
    </sec>
    <sec id="Sec34">
      <title>Detection of indel frequency on endogenous target sites</title>
      <p id="Par58">To test the performance of seven algorithms for endogenous sites, we edited endogenous sites with randomly selected 100 gRNAs from the library (Supplementary Data <xref rid="MOESM10" ref-type="media">9</xref>). The epiCRISPR plasmid was modified to express gRNAs. Briefly, the EF1-Cas9 fragment (AgeI-NheI) on epiCRISPR was replaced by CMV promoter, resulting in epiCRISPR-hU6-gRNA vector; then, hU6 promoter from epiCRISPR-hU6-gRNA vecotor was replaced by mU6 promoter using Gibson Assembly (NEB), resulting in epiCRISPR-mU6-gRNA vector. The gRNA oligonucleotide pairs were annealed and cloned into BspQI sites of the epiCRISPR-mU6-gRNA vector. The plasmids were transfected into HEK293T cells expressing eSpCas9 or SpCas9-HF1, respectively. After 24 h of transfection, cells were selected with 2 µg/ml puromycin for the 4 days.</p>
    </sec>
    <sec id="Sec35">
      <title>Analysis of individual gRNA indel frequency</title>
      <p id="Par59">All PCR primers for T7EI and TIDE analysis are listed in Supplementary Data <xref rid="MOESM21" ref-type="media">20</xref>. Genomic DNA was extracted from cells at suitable time points after transfection or infection using QuickExtract DNA Extraction Solution (Epicentre) according to the manufacturer’s instructions. We amplified the target sequence by PCR with Q5 High-Fidelity 2X Master Mix (NEB) following the manufacturer’s instructions. PCR products were purified with Gel Extraction Kit (Qiagen) and cleavage by T7EI (NEB). Digested DNA was run on TBE gel. To calculate the indel efficiency, the intensity of band was analyzed using the ImageJ software. For TIDE, the purified PCR products were Sanger-sequenced, and each sequence was analyzed with the online TIDE software available at <ext-link ext-link-type="uri" xlink:href="http://tide.nki.nl">http://tide.nki.nl</ext-link><sup><xref ref-type="bibr" rid="CR67">67</xref></sup>.</p>
    </sec>
    <sec id="Sec36">
      <title>Detection of genotype and phenotype</title>
      <p id="Par60">We selected nine sgRNAs for three genes (SIRT1, SIRT2, and SIRT6) to examine the relationship between indel frequency and actual gene disruption. epiCRISPR-mU6-gRNA were transfected into 293T-SpCas9-HF1 cells, the gDNA and protein were extracted at 9 days after puromycin screening. The indel frequency detected by TIDE software, the gene disruption detected by western blot.</p>
    </sec>
    <sec id="Sec37">
      <title>Luciferase reporter assay</title>
      <p id="Par61">To establish luciferase reporter cell line, HEK293T cells in six-wells plates were transfected with 2 μg of mixed plasmids (pX458-AAVS1-gRNA and pAAVS1-luciferase-donnor) using Lipofectamine 2000 (Life Technologies) based on the manufacturer’s instruction. After 24 h, cells were selected with 10 μg/ml of blasticidin for 14 days. The cells expressing luciferase were plated in 48-wells plates and transfected with 0.2 μg plasmids expressing Cas9 nucleases and firefly gRNAs. After 5 days, cells were harvested, and luciferase activity was measured using Dual-Luciferase<sup>®</sup> Reporter Assay System (Promega). Firefly luciferase activity was detected and normalized to renilla luciferase activity measured in the same samples. The levels of the normalized reporter luciferase activity were calculated relative to the levels in mock transfected cells expressing the same reporter.</p>
    </sec>
    <sec id="Sec38">
      <title>Statistical analysis</title>
      <p id="Par62">All the data are shown as the mean ± S.D. Statistical analyses were conducted using Microsoft Excel. Two-tailed, paired Student’s <italic>t</italic> tests were used to determine statistical significance when comparing two groups. A value of <italic>p</italic> &lt; 0.05 was considered to be statistically significant.</p>
    </sec>
    <sec id="Sec39">
      <title>Reporting summary</title>
      <p id="Par63">Further information on research design is available in the <xref rid="MOESM22" ref-type="media">Nature Research Reporting Summary</xref> linked to this article.</p>
    </sec>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary information</title>
    <sec id="Sec40">
      <p>
        <supplementary-material content-type="local-data" id="MOESM1">
          <media xlink:href="41467_2019_12281_MOESM1_ESM.pdf">
            <caption>
              <p>Supplementary Information</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM2">
          <media xlink:href="41467_2019_12281_MOESM2_ESM.xlsx">
            <caption>
              <p>Supplementary Data 1</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM3">
          <media xlink:href="41467_2019_12281_MOESM3_ESM.xlsx">
            <caption>
              <p>Supplementary Data 2</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM4">
          <media xlink:href="41467_2019_12281_MOESM4_ESM.xlsx">
            <caption>
              <p>Supplementary Data 3</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM5">
          <media xlink:href="41467_2019_12281_MOESM5_ESM.xlsx">
            <caption>
              <p>Supplementary Data 4</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM6">
          <media xlink:href="41467_2019_12281_MOESM6_ESM.xlsx">
            <caption>
              <p>Supplementary Data 5</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM7">
          <media xlink:href="41467_2019_12281_MOESM7_ESM.xlsx">
            <caption>
              <p>Supplementary Data 6</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM8">
          <media xlink:href="41467_2019_12281_MOESM8_ESM.xlsx">
            <caption>
              <p>Supplementary Data 7</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM9">
          <media xlink:href="41467_2019_12281_MOESM9_ESM.xlsx">
            <caption>
              <p>Supplementary Data 8</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM10">
          <media xlink:href="41467_2019_12281_MOESM10_ESM.xlsx">
            <caption>
              <p>Supplementary Data 9</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM11">
          <media xlink:href="41467_2019_12281_MOESM11_ESM.xlsx">
            <caption>
              <p>Supplementary Data 10</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM12">
          <media xlink:href="41467_2019_12281_MOESM12_ESM.xlsx">
            <caption>
              <p>Supplementary Data 11</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM13">
          <media xlink:href="41467_2019_12281_MOESM13_ESM.xlsx">
            <caption>
              <p>Supplementary Data 12</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM14">
          <media xlink:href="41467_2019_12281_MOESM14_ESM.xlsx">
            <caption>
              <p>Supplementary Data 13</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM15">
          <media xlink:href="41467_2019_12281_MOESM15_ESM.xlsx">
            <caption>
              <p>Supplementary Data 14</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM16">
          <media xlink:href="41467_2019_12281_MOESM16_ESM.xlsx">
            <caption>
              <p>Supplementary Data 15</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM17">
          <media xlink:href="41467_2019_12281_MOESM17_ESM.xlsx">
            <caption>
              <p>Supplementary Data 16</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM18">
          <media xlink:href="41467_2019_12281_MOESM18_ESM.xlsx">
            <caption>
              <p>Supplementary Data 17</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM19">
          <media xlink:href="41467_2019_12281_MOESM19_ESM.xlsx">
            <caption>
              <p>Supplementary Data 18</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM20">
          <media xlink:href="41467_2019_12281_MOESM20_ESM.xlsx">
            <caption>
              <p>Supplementary Data 19</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM21">
          <media xlink:href="41467_2019_12281_MOESM21_ESM.xlsx">
            <caption>
              <p>Supplementary Data 20</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM22">
          <media xlink:href="41467_2019_12281_MOESM22_ESM.pdf">
            <caption>
              <p>Reporting Summary</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM23">
          <media xlink:href="41467_2019_12281_MOESM23_ESM.pdf">
            <caption>
              <p>Description of Additional Supplementary Files</p>
            </caption>
          </media>
        </supplementary-material>
      </p>
      <p>
        <supplementary-material content-type="local-data" id="MOESM24">
          <media xlink:href="41467_2019_12281_MOESM24_ESM.xlsx">
            <caption>
              <p>Source Data</p>
            </caption>
          </media>
        </supplementary-material>
      </p>
    </sec>
  </sec>
</body>
<back>
  <fn-group>
    <fn>
      <p><bold>Peer review information</bold><italic>Nature Communications</italic> thanks the anonymous reviewers for their contribution to the peer review of this work.</p>
    </fn>
    <fn>
      <p><bold>Publisher’s note</bold> Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p>
    </fn>
    <fn>
      <p>These authors contributed equally: Daqi Wang, Chengdong Zhang.</p>
    </fn>
  </fn-group>
  <sec>
    <title>Supplementary information</title>
    <p><bold>Supplementary Information</bold> accompanies this paper at 10.1038/s41467-019-12281-8.</p>
  </sec>
  <ack>
    <title>Acknowledgements</title>
    <p>We thank Professor Q. Huang for maintenance of high-performance computing cluster, S.-G. Ong for revision of the paper. This work was supported by grants from the National Natural Science Foundation of China (81870199, 31720103909, and 31471239), the National Basic Research Program of China (2015CB943300), the Foundation for Innovative Research Group of the National Natural Science Foundation of China (31521003), the National Key R&amp;D Project of China (2016YFC0901704 and 2017YFC0907502), the Shanghai Municipal Science and Technology Major Project (2017SHZDZX01), and State Key Laboratory Opening Program SKLGE1809.</p>
  </ack>
  <notes notes-type="author-contribution">
    <title>Author contributions</title>
    <p>D.-Q.W. designed and performed experiments; C.-D.Z. analyzed the data, built the prediction model, and created the website; B.W. compared hU6 and mU6 promoter activity; B.L. designed gRNAs for microRNA; Q.W. analyzed the data; D.L., H.-Y.W., and Y.Z. supervised the project; F.L. and Y.-M.W. designed the project and wrote the paper; L.-M.S. supervised data analysis and revised the paper. All authors read and approved the final paper.</p>
  </notes>
  <notes notes-type="data-availability">
    <title>Data availability</title>
    <p>The full data sets of the indel rate can also be obtained in Supplementary Data <xref rid="MOESM3" ref-type="media">2</xref>. The raw sequencing data have been submitted to the NCBI Sequence Read Archive (SRA PRJNA522677 (<ext-link ext-link-type="uri" xlink:href="https://www.ncbi.nlm.nih.gov/bioproject/522677">https://www.ncbi.nlm.nih.gov/bioproject/522677</ext-link>)). The raw read counts can be obtained in Supplementary Data <xref rid="MOESM20" ref-type="media">19</xref>. The source data underlying Fig. <xref rid="MOESM24" ref-type="media">1b–g</xref> and Supplementary Figs. <xref rid="MOESM24" ref-type="media">1</xref>–<xref rid="MOESM24" ref-type="media">5</xref>, <xref rid="MOESM24" ref-type="media">6</xref>c, <xref rid="MOESM24" ref-type="media">7</xref>b, <xref rid="MOESM24" ref-type="media">13</xref>, and <xref rid="MOESM24" ref-type="media">14</xref> are provided as a Source Data file. The other data for this study are available from the corresponding author upon reasonable request.</p>
  </notes>
  <notes notes-type="data-availability">
    <title>Code availability</title>
    <p>All software codes of the study are available in GitHub (<ext-link ext-link-type="uri" xlink:href="https://github.com/izhangcd/DeepHF">https://github.com/izhangcd/DeepHF</ext-link>). We built a website DeepHF for the access of all indel rate data (<ext-link ext-link-type="uri" xlink:href="http://www.DeepHF.com/">http://www.DeepHF.com/</ext-link>). One can input an Entrez Gene ID or official gene symbol to query the validated gRNA efficiencies for eSpCas9(1.1) and SpCas9-HF1.</p>
  </notes>
  <notes notes-type="COI-statement">
    <title>Competing interests</title>
    <p id="Par64">The authors declare no competing interests.</p>
  </notes>
  <ref-list id="Bib1">
    <title>References</title>
    <ref id="CR1">
      <label>1.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Cong</surname>
            <given-names>L</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Multiplex genome engineering using CRISPR/Cas systems</article-title>
        <source>Science</source>
        <year>2013</year>
        <volume>339</volume>
        <fpage>819</fpage>
        <lpage>823</lpage>
        <pub-id pub-id-type="doi">10.1126/science.1231143</pub-id>
        <pub-id pub-id-type="pmid">23287718</pub-id>
      </element-citation>
    </ref>
    <ref id="CR2">
      <label>2.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Mali</surname>
            <given-names>P</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>RNA-guided human genome engineering via Cas9</article-title>
        <source>Science</source>
        <year>2013</year>
        <volume>339</volume>
        <fpage>823</fpage>
        <lpage>826</lpage>
        <pub-id pub-id-type="doi">10.1126/science.1232033</pub-id>
        <pub-id pub-id-type="pmid">23287722</pub-id>
      </element-citation>
    </ref>
    <ref id="CR3">
      <label>3.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Jinek</surname>
            <given-names>M</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>A programmable dual-RNA-guided DNA endonuclease in adaptive bacterial immunity</article-title>
        <source>Science</source>
        <year>2012</year>
        <volume>337</volume>
        <fpage>816</fpage>
        <lpage>821</lpage>
        <pub-id pub-id-type="doi">10.1126/science.1225829</pub-id>
        <pub-id pub-id-type="pmid">22745249</pub-id>
      </element-citation>
    </ref>
    <ref id="CR4">
      <label>4.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wang</surname>
            <given-names>HY</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>One-step generation of mice carrying mutations in multiple genes by CRISPR/Cas-mediated genome engineering</article-title>
        <source>Cell</source>
        <year>2013</year>
        <volume>153</volume>
        <fpage>910</fpage>
        <lpage>918</lpage>
        <pub-id pub-id-type="doi">10.1016/j.cell.2013.04.025</pub-id>
        <pub-id pub-id-type="pmid">23643243</pub-id>
      </element-citation>
    </ref>
    <ref id="CR5">
      <label>5.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Xie</surname>
            <given-names>Y</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>An episomal vector-based CRISPR/Cas9 system for highly efficient gene knockout in human pluripotent stem cells</article-title>
        <source>Sci. Rep.</source>
        <year>2017</year>
        <volume>7</volume>
        <fpage>2320</fpage>
        <pub-id pub-id-type="doi">10.1038/s41598-017-02456-y</pub-id>
        <pub-id pub-id-type="pmid">28539611</pub-id>
      </element-citation>
    </ref>
    <ref id="CR6">
      <label>6.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Fu</surname>
            <given-names>Y</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Improving CRISPR-Cas nuclease specificity using truncated guide RNAs</article-title>
        <source>Nat. Biotechnol.</source>
        <year>2014</year>
        <volume>32</volume>
        <fpage>279</fpage>
        <lpage>284</lpage>
        <pub-id pub-id-type="doi">10.1038/nbt.2808</pub-id>
        <pub-id pub-id-type="pmid">24463574</pub-id>
      </element-citation>
    </ref>
    <ref id="CR7">
      <label>7.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lareau</surname>
            <given-names>CA</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Response to “unexpected mutations after CRISPR-Cas9 editing in vivo”</article-title>
        <source>Nat. Methods</source>
        <year>2018</year>
        <volume>15</volume>
        <fpage>238</fpage>
        <lpage>239</lpage>
        <pub-id pub-id-type="doi">10.1038/nmeth.4541</pub-id>
        <pub-id pub-id-type="pmid">29600992</pub-id>
      </element-citation>
    </ref>
    <ref id="CR8">
      <label>8.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Nutter</surname>
            <given-names>LMJ</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Response to “unexpected mutations after CRISPR-Cas9 editing in vivo”</article-title>
        <source>Nat. Methods</source>
        <year>2018</year>
        <volume>15</volume>
        <fpage>235</fpage>
        <lpage>236</lpage>
        <pub-id pub-id-type="doi">10.1038/nmeth.4559</pub-id>
        <pub-id pub-id-type="pmid">29600991</pub-id>
      </element-citation>
    </ref>
    <ref id="CR9">
      <label>9.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kim</surname>
            <given-names>ST</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Response to “unexpected mutations after CRISPR-Cas9 editing in vivo”</article-title>
        <source>Nat. Methods</source>
        <year>2018</year>
        <volume>15</volume>
        <fpage>239</fpage>
        <lpage>240</lpage>
        <pub-id pub-id-type="doi">10.1038/nmeth.4554</pub-id>
        <pub-id pub-id-type="pmid">29600990</pub-id>
      </element-citation>
    </ref>
    <ref id="CR10">
      <label>10.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wilson</surname>
            <given-names>CJ</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Response to “unexpected mutations after CRISPR-Cas9 editing in vivo”</article-title>
        <source>Nat. Methods</source>
        <year>2018</year>
        <volume>15</volume>
        <fpage>236</fpage>
        <lpage>237</lpage>
        <pub-id pub-id-type="doi">10.1038/nmeth.4552</pub-id>
        <pub-id pub-id-type="pmid">29600989</pub-id>
      </element-citation>
    </ref>
    <ref id="CR11">
      <label>11.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lescarbeau</surname>
            <given-names>RM</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Response to “unexpected mutations after CRISPR-Cas9 editing in vivo”</article-title>
        <source>Nat. Methods</source>
        <year>2018</year>
        <volume>15</volume>
        <fpage>237</fpage>
        <pub-id pub-id-type="doi">10.1038/nmeth.4553</pub-id>
        <pub-id pub-id-type="pmid">29600988</pub-id>
      </element-citation>
    </ref>
    <ref id="CR12">
      <label>12.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Schaefer</surname>
            <given-names>KA</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Unexpected mutations after CRISPR-Cas9 editing in vivo</article-title>
        <source>Nat. Methods</source>
        <year>2017</year>
        <volume>14</volume>
        <fpage>547</fpage>
        <lpage>548</lpage>
        <pub-id pub-id-type="doi">10.1038/nmeth.4293</pub-id>
        <pub-id pub-id-type="pmid">28557981</pub-id>
      </element-citation>
    </ref>
    <ref id="CR13">
      <label>13.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Duan</surname>
            <given-names>J</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Genome-wide identification of CRISPR/Cas9 off-targets in human genome</article-title>
        <source>Cell Res.</source>
        <year>2014</year>
        <volume>24</volume>
        <fpage>1009</fpage>
        <lpage>1012</lpage>
        <pub-id pub-id-type="doi">10.1038/cr.2014.87</pub-id>
        <pub-id pub-id-type="pmid">24980957</pub-id>
      </element-citation>
    </ref>
    <ref id="CR14">
      <label>14.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zhang</surname>
            <given-names>XH</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Off-target effects in CRISPR/Cas9-mediated genome engineering</article-title>
        <source>Mol. Ther. Nucleic Acids</source>
        <year>2015</year>
        <volume>4</volume>
        <fpage>e264</fpage>
        <pub-id pub-id-type="doi">10.1038/mtna.2015.37</pub-id>
        <pub-id pub-id-type="pmid">26575098</pub-id>
      </element-citation>
    </ref>
    <ref id="CR15">
      <label>15.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Slaymaker</surname>
            <given-names>IM</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Rationally engineered Cas9 nucleases with improved specificity</article-title>
        <source>Science</source>
        <year>2016</year>
        <volume>351</volume>
        <fpage>84</fpage>
        <lpage>88</lpage>
        <pub-id pub-id-type="doi">10.1126/science.aad5227</pub-id>
        <pub-id pub-id-type="pmid">26628643</pub-id>
      </element-citation>
    </ref>
    <ref id="CR16">
      <label>16.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kleinstiver</surname>
            <given-names>BP</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>High-fidelity CRISPR-Cas9 nucleases with no detectable genome-wide off-target effects</article-title>
        <source>Nature</source>
        <year>2016</year>
        <volume>529</volume>
        <fpage>490</fpage>
        <lpage>495</lpage>
        <pub-id pub-id-type="doi">10.1038/nature16526</pub-id>
        <pub-id pub-id-type="pmid">26735016</pub-id>
      </element-citation>
    </ref>
    <ref id="CR17">
      <label>17.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Chen</surname>
            <given-names>JS</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Enhanced proofreading governs CRISPR-Cas9 targeting accuracy</article-title>
        <source>Nature</source>
        <year>2017</year>
        <volume>550</volume>
        <fpage>407</fpage>
        <lpage>410</lpage>
        <pub-id pub-id-type="doi">10.1038/nature24268</pub-id>
        <pub-id pub-id-type="pmid">28931002</pub-id>
      </element-citation>
    </ref>
    <ref id="CR18">
      <label>18.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Casini</surname>
            <given-names>A</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>A highly specific SpCas9 variant is identified by in vivo screening in yeast</article-title>
        <source>Nat. Biotechnol.</source>
        <year>2018</year>
        <volume>36</volume>
        <fpage>265</fpage>
        <lpage>271</lpage>
        <pub-id pub-id-type="doi">10.1038/nbt.4066</pub-id>
        <pub-id pub-id-type="pmid">29431739</pub-id>
      </element-citation>
    </ref>
    <ref id="CR19">
      <label>19.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lee</surname>
            <given-names>JK</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Directed evolution of CRISPR-Cas9 to increase its specificity</article-title>
        <source>Nat. Commun.</source>
        <year>2018</year>
        <volume>9</volume>
        <fpage>3048</fpage>
        <pub-id pub-id-type="doi">10.1038/s41467-018-05477-x</pub-id>
        <pub-id pub-id-type="pmid">30082838</pub-id>
      </element-citation>
    </ref>
    <ref id="CR20">
      <label>20.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Vakulskas</surname>
            <given-names>CA</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>A high-fidelity Cas9 mutant delivered as a ribonucleoprotein complex enables efficient gene editing in human hematopoietic stem and progenitor cells</article-title>
        <source>Nat. Med.</source>
        <year>2018</year>
        <volume>24</volume>
        <fpage>1216</fpage>
        <lpage>1224</lpage>
        <pub-id pub-id-type="doi">10.1038/s41591-018-0137-0</pub-id>
        <pub-id pub-id-type="pmid">30082871</pub-id>
      </element-citation>
    </ref>
    <ref id="CR21">
      <label>21.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Moreno-Mateos</surname>
            <given-names>MA</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>CRISPRscan: designing highly efficient sgRNAs for CRISPR-Cas9 targeting in vivo</article-title>
        <source>Nat. Methods</source>
        <year>2015</year>
        <volume>12</volume>
        <fpage>982</fpage>
        <lpage>988</lpage>
        <pub-id pub-id-type="doi">10.1038/nmeth.3543</pub-id>
        <pub-id pub-id-type="pmid">26322839</pub-id>
      </element-citation>
    </ref>
    <ref id="CR22">
      <label>22.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Xu</surname>
            <given-names>H</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Sequence determinants of improved CRISPR sgRNA design</article-title>
        <source>Genome Res.</source>
        <year>2015</year>
        <volume>25</volume>
        <fpage>1147</fpage>
        <lpage>1157</lpage>
        <pub-id pub-id-type="doi">10.1101/gr.191452.115</pub-id>
        <pub-id pub-id-type="pmid">26063738</pub-id>
      </element-citation>
    </ref>
    <ref id="CR23">
      <label>23.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Rahman</surname>
            <given-names>MK</given-names>
          </name>
          <name>
            <surname>Rahman</surname>
            <given-names>MS</given-names>
          </name>
        </person-group>
        <article-title>CRISPRpred: a flexible and efficient tool for sgRNAs on-target activity prediction in CRISPR/Cas9 systems</article-title>
        <source>PLoS ONE</source>
        <year>2017</year>
        <volume>12</volume>
        <fpage>e0181943</fpage>
        <pub-id pub-id-type="doi">10.1371/journal.pone.0181943</pub-id>
        <pub-id pub-id-type="pmid">28767689</pub-id>
      </element-citation>
    </ref>
    <ref id="CR24">
      <label>24.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Chari</surname>
            <given-names>R</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>sgRNA scorer 2.0: a species-independent model to predict CRISPR/Cas9 activity</article-title>
        <source>ACS Synth Biol</source>
        <year>2017</year>
        <volume>6</volume>
        <fpage>902</fpage>
        <lpage>904</lpage>
        <pub-id pub-id-type="doi">10.1021/acssynbio.6b00343</pub-id>
        <pub-id pub-id-type="pmid">28146356</pub-id>
      </element-citation>
    </ref>
    <ref id="CR25">
      <label>25.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Doench</surname>
            <given-names>JG</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Optimized sgRNA design to maximize activity and minimize off-target effects of CRISPR-Cas9</article-title>
        <source>Nat. Biotechnol.</source>
        <year>2016</year>
        <volume>34</volume>
        <fpage>184</fpage>
        <lpage>191</lpage>
        <pub-id pub-id-type="doi">10.1038/nbt.3437</pub-id>
        <pub-id pub-id-type="pmid">26780180</pub-id>
      </element-citation>
    </ref>
    <ref id="CR26">
      <label>26.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kim</surname>
            <given-names>HK</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Deep learning improves prediction of CRISPR-Cpf1 guide RNA activity</article-title>
        <source>Nat. Biotechnol.</source>
        <year>2018</year>
        <volume>36</volume>
        <fpage>239</fpage>
        <lpage>241</lpage>
        <pub-id pub-id-type="doi">10.1038/nbt.4061</pub-id>
        <pub-id pub-id-type="pmid">29431740</pub-id>
      </element-citation>
    </ref>
    <ref id="CR27">
      <label>27.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Chuai</surname>
            <given-names>G</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>DeepCRISPR: optimized CRISPR guide RNA design by deep learning</article-title>
        <source>Genome. Biol.</source>
        <year>2018</year>
        <volume>19</volume>
        <fpage>80</fpage>
        <pub-id pub-id-type="doi">10.1186/s13059-018-1459-4</pub-id>
        <pub-id pub-id-type="pmid">29945655</pub-id>
      </element-citation>
    </ref>
    <ref id="CR28">
      <label>28.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Guo</surname>
            <given-names>J</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Improved sgRNA design in bacteria via genome-wide activity profiling</article-title>
        <source>Nucleic Acids Res.</source>
        <year>2018</year>
        <volume>46</volume>
        <fpage>7052</fpage>
        <lpage>7069</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/gky572</pub-id>
        <pub-id pub-id-type="pmid">29982721</pub-id>
      </element-citation>
    </ref>
    <ref id="CR29">
      <label>29.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zhang</surname>
            <given-names>D</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Perfectly matched 20-nucleotide guide RNA sequences enable robust genome editing using high-fidelity SpCas9 nucleases</article-title>
        <source>Genome. Biol.</source>
        <year>2017</year>
        <volume>18</volume>
        <fpage>191</fpage>
        <pub-id pub-id-type="doi">10.1186/s13059-017-1325-9</pub-id>
        <pub-id pub-id-type="pmid">29020979</pub-id>
      </element-citation>
    </ref>
    <ref id="CR30">
      <label>30.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ma</surname>
            <given-names>H</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Pol III promoters to express small RNAs: delineation of transcription initiation</article-title>
        <source>Mol. Ther. Nucleic Acids</source>
        <year>2014</year>
        <volume>3</volume>
        <fpage>e161</fpage>
        <pub-id pub-id-type="doi">10.1038/mtna.2014.12</pub-id>
        <pub-id pub-id-type="pmid">24803291</pub-id>
      </element-citation>
    </ref>
    <ref id="CR31">
      <label>31.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Gao</surname>
            <given-names>Z</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Mutation of nucleotides around the +1 position of type 3 polymerase III promoters: the effect on transcriptional activity and start site usage</article-title>
        <source>Transcription</source>
        <year>2017</year>
        <volume>8</volume>
        <fpage>275</fpage>
        <lpage>287</lpage>
        <pub-id pub-id-type="doi">10.1080/21541264.2017.1322170</pub-id>
        <pub-id pub-id-type="pmid">28598252</pub-id>
      </element-citation>
    </ref>
    <ref id="CR32">
      <label>32.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kim</surname>
            <given-names>HK</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>In vivo high-throughput profiling of CRISPR-Cpf1 activity</article-title>
        <source>Nat. Methods</source>
        <year>2017</year>
        <volume>14</volume>
        <fpage>153</fpage>
        <lpage>159</lpage>
        <pub-id pub-id-type="doi">10.1038/nmeth.4104</pub-id>
        <pub-id pub-id-type="pmid">27992409</pub-id>
      </element-citation>
    </ref>
    <ref id="CR33">
      <label>33.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Schroder</surname>
            <given-names>AR</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>HIV-1 integration in the human genome favors active genes and local hotspots</article-title>
        <source>Cell</source>
        <year>2002</year>
        <volume>110</volume>
        <fpage>521</fpage>
        <lpage>529</lpage>
        <pub-id pub-id-type="doi">10.1016/S0092-8674(02)00864-4</pub-id>
        <pub-id pub-id-type="pmid">12202041</pub-id>
      </element-citation>
    </ref>
    <ref id="CR34">
      <label>34.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Mitchell</surname>
            <given-names>RS</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Retroviral DNA integration: ASLV, HIV, and MLV show distinct target site preferences</article-title>
        <source>PLoS Biol.</source>
        <year>2004</year>
        <volume>2</volume>
        <fpage>E234</fpage>
        <pub-id pub-id-type="doi">10.1371/journal.pbio.0020234</pub-id>
        <pub-id pub-id-type="pmid">15314653</pub-id>
      </element-citation>
    </ref>
    <ref id="CR35">
      <label>35.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Sack</surname>
            <given-names>LM</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Sources of error in mammalian genetic screens</article-title>
        <source>G3 (Bethesda)</source>
        <year>2016</year>
        <volume>6</volume>
        <fpage>2781</fpage>
        <lpage>2790</lpage>
        <pub-id pub-id-type="doi">10.1534/g3.116.030973</pub-id>
        <pub-id pub-id-type="pmid">27402361</pub-id>
      </element-citation>
    </ref>
    <ref id="CR36">
      <label>36.</label>
      <mixed-citation publication-type="other">Fusi, N. et al. In silico predictive modeling of CRISPR/Cas9 guide efficiency. Preprint at: <ext-link ext-link-type="uri" xlink:href="https://www.biorxiv.org/content/10.1101/021568v1">https://www.biorxiv.org/content/10.1101/021568v1</ext-link> (2015).</mixed-citation>
    </ref>
    <ref id="CR37">
      <label>37.</label>
      <mixed-citation publication-type="other">Ziqi, L. et al. GeniePath: graph neural networks with adaptive receptive paths. Preprint at: <ext-link ext-link-type="uri" xlink:href="https://arxiv.org/abs/1802.00910">https://arxiv.org/abs/1802.00910</ext-link> (2018).</mixed-citation>
    </ref>
    <ref id="CR38">
      <label>38.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wong</surname>
            <given-names>N</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>WU-CRISPR: characteristics of functional guide RNAs for the CRISPR/Cas9 system</article-title>
        <source>Genome. Biol.</source>
        <year>2015</year>
        <volume>16</volume>
        <fpage>218</fpage>
        <pub-id pub-id-type="doi">10.1186/s13059-015-0784-0</pub-id>
        <pub-id pub-id-type="pmid">26521937</pub-id>
      </element-citation>
    </ref>
    <ref id="CR39">
      <label>39.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Khurana</surname>
            <given-names>S</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>DeepSol: a deep learning framework for sequence-based protein solubility prediction</article-title>
        <source>Bioinformatics</source>
        <year>2018</year>
        <volume>34</volume>
        <fpage>2605</fpage>
        <lpage>2613</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/bty166</pub-id>
        <pub-id pub-id-type="pmid">29554211</pub-id>
      </element-citation>
    </ref>
    <ref id="CR40">
      <label>40.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Alipanahi</surname>
            <given-names>B</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Predicting the sequence specificities of DNA- and RNA-binding proteins by deep learning</article-title>
        <source>Nat. Biotechnol.</source>
        <year>2015</year>
        <volume>33</volume>
        <fpage>831</fpage>
        <lpage>838</lpage>
        <pub-id pub-id-type="doi">10.1038/nbt.3300</pub-id>
        <pub-id pub-id-type="pmid">26213851</pub-id>
      </element-citation>
    </ref>
    <ref id="CR41">
      <label>41.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zeng</surname>
            <given-names>H</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Convolutional neural network architectures for predicting DNA-protein binding</article-title>
        <source>Bioinformatics</source>
        <year>2016</year>
        <volume>32</volume>
        <fpage>i121</fpage>
        <lpage>i127</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btw255</pub-id>
        <pub-id pub-id-type="pmid">27307608</pub-id>
      </element-citation>
    </ref>
    <ref id="CR42">
      <label>42.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Boza</surname>
            <given-names>V</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>DeepNano: deep recurrent neural networks for base calling in MinION nanopore reads</article-title>
        <source>PLoS. ONE</source>
        <year>2017</year>
        <volume>12</volume>
        <fpage>e0178751</fpage>
        <pub-id pub-id-type="doi">10.1371/journal.pone.0178751</pub-id>
        <pub-id pub-id-type="pmid">28582401</pub-id>
      </element-citation>
    </ref>
    <ref id="CR43">
      <label>43.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Quang</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Xie</surname>
            <given-names>X</given-names>
          </name>
        </person-group>
        <article-title>DanQ: a hybrid convolutional and recurrent deep neural network for quantifying the function of DNA sequences</article-title>
        <source>Nucleic Acids Res.</source>
        <year>2016</year>
        <volume>44</volume>
        <fpage>e107</fpage>
        <pub-id pub-id-type="doi">10.1093/nar/gkw226</pub-id>
        <pub-id pub-id-type="pmid">27084946</pub-id>
      </element-citation>
    </ref>
    <ref id="CR44">
      <label>44.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Adhikari</surname>
            <given-names>B</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>DNCON2: improved protein contact prediction using two-level deep convolutional neural networks</article-title>
        <source>Bioinformatics</source>
        <year>2018</year>
        <volume>34</volume>
        <fpage>1466</fpage>
        <lpage>1472</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btx781</pub-id>
        <pub-id pub-id-type="pmid">29228185</pub-id>
      </element-citation>
    </ref>
    <ref id="CR45">
      <label>45.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wang</surname>
            <given-names>S</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Protein secondary structure prediction using deep convolutional neural fields</article-title>
        <source>Sci. Rep.</source>
        <year>2016</year>
        <volume>6</volume>
        <fpage>18962</fpage>
        <pub-id pub-id-type="doi">10.1038/srep18962</pub-id>
        <pub-id pub-id-type="pmid">26752681</pub-id>
      </element-citation>
    </ref>
    <ref id="CR46">
      <label>46.</label>
      <mixed-citation publication-type="other">Li, Z. &amp; Yu, Y. Protein secondary structure prediction using cascaded convolutional and recurrent neural networks. <ext-link ext-link-type="uri" xlink:href="https://arxiv.org/abs/1604.07176">https://arxiv.org/abs/1604.07176</ext-link> (2016).</mixed-citation>
    </ref>
    <ref id="CR47">
      <label>47.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Haeussler</surname>
            <given-names>M</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Evaluation of off-target and on-target scoring algorithms and integration into the guide RNA selection tool CRISPOR</article-title>
        <source>Genome. Biol.</source>
        <year>2016</year>
        <volume>17</volume>
        <fpage>148</fpage>
        <pub-id pub-id-type="doi">10.1186/s13059-016-1012-2</pub-id>
        <pub-id pub-id-type="pmid">27380939</pub-id>
      </element-citation>
    </ref>
    <ref id="CR48">
      <label>48.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Peng</surname>
            <given-names>H</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>CRISPR/Cas9 cleavage efficiency regression through boosting algorithms and Markov sequence profiling</article-title>
        <source>Bioinformatics</source>
        <year>2018</year>
        <volume>34</volume>
        <fpage>3069</fpage>
        <lpage>3077</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/bty298</pub-id>
        <pub-id pub-id-type="pmid">29672669</pub-id>
      </element-citation>
    </ref>
    <ref id="CR49">
      <label>49.</label>
      <mixed-citation publication-type="other">Scott, L. &amp; Lee., S.-I. A unified approach to interpreting model predictions. Preprint at: <ext-link ext-link-type="uri" xlink:href="https://arxiv.org/abs/1705.07874">https://arxiv.org/abs/1705.07874</ext-link> (2017).</mixed-citation>
    </ref>
    <ref id="CR50">
      <label>50.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wang</surname>
            <given-names>T</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Genetic screens in human cells using the CRISPR-Cas9 system</article-title>
        <source>Science</source>
        <year>2014</year>
        <volume>343</volume>
        <fpage>80</fpage>
        <lpage>84</lpage>
        <pub-id pub-id-type="doi">10.1126/science.1246981</pub-id>
        <pub-id pub-id-type="pmid">24336569</pub-id>
      </element-citation>
    </ref>
    <ref id="CR51">
      <label>51.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wu</surname>
            <given-names>X</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Genome-wide binding of the CRISPR endonuclease Cas9 in mammalian cells</article-title>
        <source>Nat. Biotechnol.</source>
        <year>2014</year>
        <volume>32</volume>
        <fpage>670</fpage>
        <lpage>676</lpage>
        <pub-id pub-id-type="doi">10.1038/nbt.2889</pub-id>
        <pub-id pub-id-type="pmid">24752079</pub-id>
      </element-citation>
    </ref>
    <ref id="CR52">
      <label>52.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Doench</surname>
            <given-names>JG</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Rational design of highly active sgRNAs for CRISPR-Cas9-mediated gene inactivation</article-title>
        <source>Nat. Biotechnol.</source>
        <year>2014</year>
        <volume>32</volume>
        <fpage>1262</fpage>
        <lpage>1267</lpage>
        <pub-id pub-id-type="doi">10.1038/nbt.3026</pub-id>
        <pub-id pub-id-type="pmid">25184501</pub-id>
      </element-citation>
    </ref>
    <ref id="CR53">
      <label>53.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Shalem</surname>
            <given-names>O</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Genome-scale CRISPR-Cas9 knockout screening in human cells</article-title>
        <source>Science</source>
        <year>2014</year>
        <volume>343</volume>
        <fpage>84</fpage>
        <lpage>87</lpage>
        <pub-id pub-id-type="doi">10.1126/science.1247005</pub-id>
        <pub-id pub-id-type="pmid">24336571</pub-id>
      </element-citation>
    </ref>
    <ref id="CR54">
      <label>54.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Sanjana</surname>
            <given-names>NE</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Improved vectors and genome-wide libraries for CRISPR screening</article-title>
        <source>Nat. Methods</source>
        <year>2014</year>
        <volume>11</volume>
        <fpage>783</fpage>
        <lpage>784</lpage>
        <pub-id pub-id-type="doi">10.1038/nmeth.3047</pub-id>
        <pub-id pub-id-type="pmid">25075903</pub-id>
      </element-citation>
    </ref>
    <ref id="CR55">
      <label>55.</label>
      <mixed-citation publication-type="other">Krizhevsky, A. et al. in <italic>Advances in Neural Information Processing Systems</italic>, Pereira, F., Burges, C.J.C., Bottou, L., Weinberger, K.Q. (eds.) Vol. 25, 1097–1105 (Curran Associates, Inc., 2012).</mixed-citation>
    </ref>
    <ref id="CR56">
      <label>56.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Min</surname>
            <given-names>X</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Chromatin accessibility prediction via convolutional long short-term memory networks with k-mer embedding</article-title>
        <source>Bioinformatics</source>
        <year>2017</year>
        <volume>33</volume>
        <fpage>i92</fpage>
        <lpage>i101</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btx234</pub-id>
        <pub-id pub-id-type="pmid">28881969</pub-id>
      </element-citation>
    </ref>
    <ref id="CR57">
      <label>57.</label>
      <mixed-citation publication-type="other">Tomas Mikolov et al. Distributed representations of words and phrases and their compositionality. Preprint at: <ext-link ext-link-type="uri" xlink:href="https://arxiv.org/abs/1310.4546">https://arxiv.org/abs/1310.4546</ext-link> (2013).</mixed-citation>
    </ref>
    <ref id="CR58">
      <label>58.</label>
      <mixed-citation publication-type="other">Kyunghyun, C. et al. On the properties of neural machine translation: encoder-decoder approaches. Preprint at: <ext-link ext-link-type="uri" xlink:href="https://arxiv.org/abs/1409.1259">https://arxiv.org/abs/1409.1259</ext-link> (2014).</mixed-citation>
    </ref>
    <ref id="CR59">
      <label>59.</label>
      <mixed-citation publication-type="other">GPyOpt: A Bayesian optimization framework in python. <ext-link ext-link-type="uri" xlink:href="https://sheffieldml.github.io/GPyOpt/">https://sheffieldml.github.io/GPyOpt/</ext-link> (2016).</mixed-citation>
    </ref>
    <ref id="CR60">
      <label>60.</label>
      <mixed-citation publication-type="other">Scott M. L. et al. Consistent individualized feature attribution for Tree Ensembles. Preprint at: <ext-link ext-link-type="uri" xlink:href="https://arxiv.org/abs/1802.03888">https://arxiv.org/abs/1802.03888</ext-link> (2018).</mixed-citation>
    </ref>
    <ref id="CR61">
      <label>61.</label>
      <mixed-citation publication-type="other">Marco, A. et al. A unified view of gradient-based attribution methods for deep neural networks. Preprint at: <ext-link ext-link-type="uri" xlink:href="https://arxiv.org/abs/1711.06104">https://arxiv.org/abs/1711.06104</ext-link> (2017).</mixed-citation>
    </ref>
    <ref id="CR62">
      <label>62.</label>
      <mixed-citation publication-type="other">Avanti S. et al. Learning important features through propagating activation differences. Preprint at: <ext-link ext-link-type="uri" xlink:href="https://arxiv.org/abs/1704.02685">https://arxiv.org/abs/1704.02685</ext-link> (2017).</mixed-citation>
    </ref>
    <ref id="CR63">
      <label>63.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lorenz</surname>
            <given-names>R</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>ViennaRNA package 2.0</article-title>
        <source>Algorithm. Mol. Biol.</source>
        <year>2011</year>
        <volume>6</volume>
        <fpage>26</fpage>
        <pub-id pub-id-type="doi">10.1186/1748-7188-6-26</pub-id>
      </element-citation>
    </ref>
    <ref id="CR64">
      <label>64.</label>
      <mixed-citation publication-type="other">Fabian P. et al. Scikit-learn: machine learning in Python. Preprint at: <ext-link ext-link-type="uri" xlink:href="https://arxiv.org/abs/1201.0490">https://arxiv.org/abs/1201.0490</ext-link> (2012).</mixed-citation>
    </ref>
    <ref id="CR65">
      <label>65.</label>
      <mixed-citation publication-type="other">Chollet, F. Keras. <ext-link ext-link-type="uri" xlink:href="https://keras.io">https://keras.io</ext-link> (2017).</mixed-citation>
    </ref>
    <ref id="CR66">
      <label>66.</label>
      <mixed-citation publication-type="other">Martín A. et al. TensorFlow: a system for large-scale machine learning. Preprint at: <ext-link ext-link-type="uri" xlink:href="https://arxiv.org/abs/1605.08695">https://arxiv.org/abs/1605.08695</ext-link> (2016).</mixed-citation>
    </ref>
    <ref id="CR67">
      <label>67.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Brinkman</surname>
            <given-names>EK</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Easy quantitative assessment of genome editing by sequence trace decomposition</article-title>
        <source>Nucleic Acids Res.</source>
        <year>2014</year>
        <volume>42</volume>
        <fpage>e168</fpage>
        <pub-id pub-id-type="doi">10.1093/nar/gku936</pub-id>
        <pub-id pub-id-type="pmid">25300484</pub-id>
      </element-citation>
    </ref>
  </ref-list>
</back>
