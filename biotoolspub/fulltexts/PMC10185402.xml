<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.2 20190208//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.2?>
<?ConverterInfo.XSLTName jats2jats3.xsl?>
<?ConverterInfo.Version 1?>
<?properties open_access?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">Bioinformatics</journal-id>
    <journal-id journal-id-type="publisher-id">bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1367-4803</issn>
    <issn pub-type="epub">1367-4811</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">10185402</article-id>
    <article-id pub-id-type="pmid">37137228</article-id>
    <article-id pub-id-type="doi">10.1093/bioinformatics/btad296</article-id>
    <article-id pub-id-type="publisher-id">btad296</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Applications Note</subject>
        <subj-group subj-group-type="category-toc-heading">
          <subject>Genome Analysis</subject>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="category-taxonomy-collection">
        <subject>AcademicSubjects/SCI01060</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>PascalX: a Python library for GWAS gene and pathway enrichment tests</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0001-8554-2498</contrib-id>
        <name>
          <surname>Krefl</surname>
          <given-names>Daniel</given-names>
        </name>
        <aff><institution>Department of Computational Biology, University of Lausanne</institution>, Lausanne, <country country="CH">Switzerland</country></aff>
        <aff><institution>Swiss Institute of Bioinformatics</institution>, Lausanne, <country country="CH">Switzerland</country></aff>
        <xref rid="btad296-cor1" ref-type="corresp"/>
        <!--daniel.krefl@unil.ch-->
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Brandulas Cammarata</surname>
          <given-names>Alessandro</given-names>
        </name>
        <aff><institution>Department of Computational Biology, University of Lausanne</institution>, Lausanne, <country country="CH">Switzerland</country></aff>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <name>
          <surname>Bergmann</surname>
          <given-names>Sven</given-names>
        </name>
        <aff><institution>Department of Computational Biology, University of Lausanne</institution>, Lausanne, <country country="CH">Switzerland</country></aff>
        <aff><institution>Swiss Institute of Bioinformatics</institution>, Lausanne, <country country="CH">Switzerland</country></aff>
        <aff><institution>Department of Integrative Biomedical Sciences, University of Cape Town</institution>, Cape Town, <country country="ZA">South Africa</country></aff>
        <xref rid="btad296-cor1" ref-type="corresp"/>
        <!--sven.bergmann@unil.ch-->
      </contrib>
    </contrib-group>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Kendziorski</surname>
          <given-names>Christina</given-names>
        </name>
        <role>Associate Editor</role>
      </contrib>
    </contrib-group>
    <author-notes>
      <corresp id="btad296-cor1">Corresponding authors. Department of Computational Biology, University of Lausanne, Génopode, 1015 Lausanne, Switzerland. E-mail: <email>daniel.krefl@unil.ch</email> (D.K.); E-mail: <email>sven.bergmann@unil.ch</email> (S.B.)</corresp>
    </author-notes>
    <pub-date pub-type="collection">
      <month>5</month>
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="epub" iso-8601-date="2023-05-03">
      <day>03</day>
      <month>5</month>
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>03</day>
      <month>5</month>
      <year>2023</year>
    </pub-date>
    <volume>39</volume>
    <issue>5</issue>
    <elocation-id>btad296</elocation-id>
    <history>
      <date date-type="received">
        <day>28</day>
        <month>10</month>
        <year>2022</year>
      </date>
      <date date-type="rev-recd">
        <day>05</day>
        <month>2</month>
        <year>2023</year>
      </date>
      <date date-type="accepted">
        <day>25</day>
        <month>4</month>
        <year>2023</year>
      </date>
      <date date-type="corrected-typeset">
        <day>15</day>
        <month>5</month>
        <year>2023</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2023. Published by Oxford University Press.</copyright-statement>
      <copyright-year>2023</copyright-year>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">https://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted reuse, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <self-uri xlink:href="btad296.pdf"/>
    <abstract>
      <title>Abstract</title>
      <sec id="s1">
        <title>Summary</title>
        <p>‘PascalX’ is a Python library providing fast and accurate tools for mapping SNP-wise GWAS summary statistics. Specifically, it allows for scoring genes and annotated gene sets for enrichment signals based on data from, both, single GWAS and pairs of GWAS. The gene scores take into account the correlation pattern between SNPs. They are based on the cumulative density function of a linear combination of <inline-formula id="IE1"><mml:math id="IM1" display="inline" overflow="scroll"><mml:mrow><mml:msup><mml:mrow><mml:mo>χ</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:math></inline-formula> distributed random variables, which can be calculated either approximately or exactly to high precision. Acceleration via multithreading and GPU is supported. The code of PascalX is fully open source and well suited as a base for method development in the GWAS enrichment test context.</p>
      </sec>
      <sec id="s2">
        <title>Availability and implementation</title>
        <p>The source code is available at <ext-link xlink:href="https://github.com/BergmannLab/PascalX" ext-link-type="uri">https://github.com/BergmannLab/PascalX</ext-link> and archived under doi:<ext-link xlink:href="https://dx.doi.org//10.5281/zenodo.4429922" ext-link-type="uri">//10.5281/zenodo.4429922</ext-link>. A user manual with usage examples is available at <ext-link xlink:href="https://bergmannlab.github.io/PascalX/" ext-link-type="uri">https://bergmannlab.github.io/PascalX/</ext-link>.</p>
      </sec>
    </abstract>
    <funding-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>Swiss National Science Foundation</institution>
            <institution-id institution-id-type="DOI">10.13039/501100001711</institution-id>
          </institution-wrap>
        </funding-source>
        <award-id>FN 310030_176138</award-id>
      </award-group>
    </funding-group>
    <counts>
      <page-count count="3"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec>
    <title>1 Introduction</title>
    <p>Genome-wide association studies (GWASs) are well established for identifying links between genotypes and phenotypes. The results of such studies are usually freely shared in terms of summary statistics containing single SNP effect sizes. Aggregating such effects at the level of genes or pathways (i.e. annotated gene sets) map potential signals to biologically relevant entities, reducing the burden of multiple hypotheses testing and increasing power. There exist many aggregation methods, which differ by their statistical method, required input, approximation, and computational needs, c.f. <xref rid="btad296-B4" ref-type="bibr">de Leeuw et al. (2016)</xref> for a review.</p>
    <p>Our original pathway scoring algorithm ‘Pascal’ (<xref rid="btad296-B10" ref-type="bibr">Lamparter et al. 2016</xref>) used sum of squared (normalized) effect sizes to score genes or pathways. In general, the cumulative distribution function (CDF) of such scores is a linear combination of <inline-formula id="IE2"><mml:math id="IM2" display="inline" overflow="scroll"><mml:mrow><mml:msup><mml:mrow><mml:mo>χ</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:math></inline-formula> variables under the null hypothesis, which can be computed efficiently. The linear combination coefficients are the eigenvalues of the SNP–SNP covariance matrix, whose off-diagonal elements are due to linkage disequilibrium, potentially inducing correlated individual SNP effects. The advantage of this method is that, like MAGMA (<xref rid="btad296-B3" ref-type="bibr">de Leeuw et al. 2015</xref>), its underlying statistic can be computed relatively fast and quasi-analytically, not requiring any approximations or perturbation-based estimates. Yet, in contrast to some other methods like ACAT (<xref rid="btad296-B11" ref-type="bibr">Liu et al. 2019</xref>), it does require an estimate of the SNP–SNP covariance matrix.</p>
    <p>With the ever growing sample sizes used in current GWAS, also the signal strengths have been increasing. This can give rise to scores whose significance is so high that they cannot be computed accurately anymore with the double precision algorithms implemented in the original ‘Pascal’ software, resulting in unresolved rankings between the top genes.</p>
    <p>The software described in this application note, called ‘PascalX’, solves this issue through a C++ multi-precision implementation of the CDF calculation (making use of the boost libraries, <ext-link xlink:href="http://www.boost.org" ext-link-type="uri">www.boost.org</ext-link>), interfaced via C Foreign Function Interface with a re-implementation of the original exact gene and pathway scoring of <xref rid="btad296-B10" ref-type="bibr">Lamparter et al. (2016)</xref> in Python. We also show that a saddle-point approximation (<xref rid="btad296-B9" ref-type="bibr">Kuonen 1999</xref>) is a viable alternative with an acceptable loss of accuracy (see <xref rid="sup1" ref-type="supplementary-material">online supplementary material</xref>), in particular if computation time is relevant. Our ‘PascalX’ implementation offers several further technical improvements over the original ‘Pascal’, namely intrinsic parallelization, possibility for GPU acceleration of linear algebra operations, and a new data storage model with fast random access. A detailed performance comparison to the original Pascal software can be found in the <xref rid="sup1" ref-type="supplementary-material">online supplementary material</xref>.</p>
    <p>Furthermore, ‘PascalX’ also includes several new gene and pathway scoring methods. Specifically, it allow for cross-scoring using two sets of GWAS summary statistics using our recently proposed gene coherence and ratio enrichment tests (<xref rid="btad296-B8" ref-type="bibr">Krefl and Bergmann 2022</xref>). It also implements the possibility of not only selecting SNPs by window around gene transcription sites, but also for selecting SNPs by additional marker data. For instance, using the SNP to gene linking of <xref rid="btad296-B6" ref-type="bibr">Gazal et al. (2022)</xref>, as demonstrated in <xref rid="sup1" ref-type="supplementary-material">Supplementary Figs S5–S7</xref>.</p>
    <p>We provide ‘PascalX’ as fully open source python library, with a modern modular structure, extensive documentation, and a permissive AGPL-3.0 license. Our code components can easily be modified or replaced, making ‘PascalX’ an ideal code base for research on high-level analysis of GWAS summary statistics, including alternative scoring schemes, such as e.g. ACAT (<xref rid="btad296-B11" ref-type="bibr">Liu et al. 2019</xref>). We also provide a direct command line interface covering core functionalities, facilitating easy integration into production pipelines.</p>
  </sec>
  <sec>
    <title>2 Features</title>
    <sec>
      <title>2.1 CDF calculation</title>
      <p>‘PascalX’ implements two common algorithms for the exact (up to a requested precision) calculation of the CDF of a linear combination of <italic toggle="yes">N</italic> random variables following a <inline-formula id="IE3"><mml:math id="IM3" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:mrow><mml:mo>χ</mml:mo></mml:mrow><mml:mn>1</mml:mn><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:mrow></mml:math></inline-formula> distribution, namely Ruben’s (<xref rid="btad296-B14" ref-type="bibr">Ruben 1962</xref>; <xref rid="btad296-B16" ref-type="bibr">Sheil and O’Muircheartaigh 1977</xref>; <xref rid="btad296-B5" ref-type="bibr">Farebrother 1984</xref>) and Davies’ algorithm (<xref rid="btad296-B2" ref-type="bibr">Davies 1973</xref>). While Ruben’s algorithm only supports positive coefficients, Davies’ algorithm also works for linear combinations with negative coefficients. For approximate calculation of the CDF, ‘PascalX’ offers the moment-based methods of Satterthwaite–Welch (<xref rid="btad296-B17" ref-type="bibr">Welch 1938</xref>; <xref rid="btad296-B15" ref-type="bibr">Satterthwaite 1946</xref>) and Imhof–Pearson (<xref rid="btad296-B13" ref-type="bibr">Pearson 1959</xref>; <xref rid="btad296-B7" ref-type="bibr">Imhof 1961</xref>), and calculation via saddle-point approximation (<xref rid="btad296-B9" ref-type="bibr">Kuonen 1999</xref>).</p>
      <p>To the best of our knowledge, ‘PascalX’ is the first pathway scoring method using multi-precision arithmetic to achieve sufficient precision for application to modern GWAS data. Specifically, ‘PascalX’ can compute the CDF exactly up to a precision of 100 digits. We confirmed the correctness of the CDF calculations at high precision by cross-verifying Ruben’s and Davies’ algorithm against each other, see <xref rid="sup1" ref-type="supplementary-material">Supplementary Figs S1 and S2</xref>. Depending on the parameters of the linear combination, one of the algorithms may be strongly preferred over the other in run-time. In particular, multi-precision arithmetic is computationally expensive, and we do not know the needed precision for a particular CDF evaluation before-hand. Therefore, ‘PascalX’ utilizes a simple heuristic, switching automatically between algorithm and level of precision, to evaluate the CDF usually much faster than employing only one of the algorithms at fixed high precision (see <xref rid="sup1" ref-type="supplementary-material">Supplementary Section S1.4</xref> for more details).</p>
      <p>Both algorithms compute the CDF exactly up to a desired precision. This differs from a more commonly applied approximate calculation. So far the quality of such approximations has only been studied at low precision in <xref rid="btad296-B1" ref-type="bibr">Bodenham and Adams (2016)</xref>, but there are no equivalent published results for the high-precision setting (i.e. beyond double precision). Using our high-precision implementation of the exact solution, we showed that the two moment-based approximations lead to substantial overestimation of significance in several parameter regimes, in particular for small <italic toggle="yes">N</italic>. In contrast, the saddle-point method yields a very good approximation, also for small <italic toggle="yes">N</italic> (see <xref rid="sup1" ref-type="supplementary-material">Supplementary Figs S3 and S4</xref>). Therefore, the saddle-point method is in general a good choice due to its superior performance and high accuracy (see <xref rid="sup1" ref-type="supplementary-material">Supplementary Figs S9–S12</xref>). ‘PascalX’ uses the saddle-point approximation as default.</p>
    </sec>
    <sec>
      <title>2.2 Gene scoring</title>
      <p>The gene scoring algorithm employed to test for GWAS gene enrichment has been originally introduced in <xref rid="btad296-B10" ref-type="bibr">Lamparter et al. (2016)</xref>. ‘PascalX’ exclusively uses the sum of <inline-formula id="IE4"><mml:math id="IM4" display="inline" overflow="scroll"><mml:mrow><mml:msup><mml:mrow><mml:mo>χ</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:math></inline-formula> method, which is based on the test statistic for a gene <italic toggle="yes">G</italic>
under the null assumption that <inline-formula id="IE5"><mml:math id="IM5" display="inline" overflow="scroll"><mml:mrow><mml:mi>z</mml:mi><mml:mo>∼</mml:mo><mml:mi mathvariant="script" class="calligraphy">N</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mo>Σ</mml:mo></mml:mrow><mml:mi>G</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>. Here, <inline-formula id="IE6"><mml:math id="IM6" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mi>G</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> denotes the number of SNPs in the gene region, <inline-formula id="IE7"><mml:math id="IM7" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> the inverse normal transformed GWAS effect size <italic toggle="yes">P</italic>-value of the <italic toggle="yes">i</italic>th SNP and <inline-formula id="IE8"><mml:math id="IM8" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mo>Σ</mml:mo></mml:mrow><mml:mi>G</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> the SNP–SNP covariance matrix inferred from the genotype of a reference population. It can be shown that
with <inline-formula id="IE9"><mml:math id="IM9" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mo>λ</mml:mo></mml:mrow><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> the <italic toggle="yes">i</italic>th eigenvalue of <inline-formula id="IE10"><mml:math id="IM10" display="inline" overflow="scroll"><mml:mo>Σ</mml:mo></mml:math></inline-formula>. Hence, <italic toggle="yes">T</italic> follows a linear combination of <inline-formula id="IE11"><mml:math id="IM11" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:mrow><mml:mo>χ</mml:mo></mml:mrow><mml:mn>1</mml:mn><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:mrow></mml:math></inline-formula> distributions, and gene enrichment can therefore be tested for via the <italic toggle="yes">P</italic>-value <inline-formula id="IE12"><mml:math id="IM12" display="inline" overflow="scroll"><mml:mrow><mml:mi>P</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mrow><mml:mtext>CDF</mml:mtext></mml:mrow></mml:mrow><mml:mo>Ξ</mml:mo></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>T</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>. The calculation of the CDF is described in Section 2.1. Benchmarking results for a set of standard GWAS and different choices of method to calculate the CDF are shown in <xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S13</xref>. Note that one can introduce an additional weighting of SNPs into the test statistic defined in <xref rid="E1" ref-type="disp-formula">Equation (1)</xref>. The corresponding null distribution still follows a linear combination of <inline-formula id="IE13"><mml:math id="IM13" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:mrow><mml:mo>χ</mml:mo></mml:mrow><mml:mn>1</mml:mn><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:mrow></mml:math></inline-formula> distributions. Details are given in <xref rid="sup1" ref-type="supplementary-material">Supplementary Section S2</xref>.</p>
      <disp-formula id="E1">
        <label>(1)</label>
        <mml:math id="M1" display="block" overflow="scroll">
          <mml:mrow>
            <mml:msub>
              <mml:mrow>
                <mml:mi>T</mml:mi>
              </mml:mrow>
              <mml:mi>G</mml:mi>
            </mml:msub>
            <mml:mo>=</mml:mo>
            <mml:munderover>
              <mml:mo>∑</mml:mo>
              <mml:mrow>
                <mml:mi>i</mml:mi>
                <mml:mo>=</mml:mo>
                <mml:mn>1</mml:mn>
              </mml:mrow>
              <mml:mrow>
                <mml:msub>
                  <mml:mrow>
                    <mml:mi>N</mml:mi>
                  </mml:mrow>
                  <mml:mi>G</mml:mi>
                </mml:msub>
              </mml:mrow>
            </mml:munderover>
            <mml:mrow>
              <mml:msubsup>
                <mml:mrow>
                  <mml:mi>z</mml:mi>
                </mml:mrow>
                <mml:mi>i</mml:mi>
                <mml:mn>2</mml:mn>
              </mml:msubsup>
            </mml:mrow>
            <mml:mo>,</mml:mo>
          </mml:mrow>
        </mml:math>
      </disp-formula>
      <disp-formula id="E2">
        <mml:math id="M2" display="block" overflow="scroll">
          <mml:mrow>
            <mml:mi>T</mml:mi>
            <mml:mo>∼</mml:mo>
            <mml:munder>
              <mml:mo>∑</mml:mo>
              <mml:mi>i</mml:mi>
            </mml:munder>
            <mml:mrow>
              <mml:msub>
                <mml:mrow>
                  <mml:mo>λ</mml:mo>
                </mml:mrow>
                <mml:mi>i</mml:mi>
              </mml:msub>
            </mml:mrow>
            <mml:mo stretchy="false">[</mml:mo>
            <mml:msubsup>
              <mml:mrow>
                <mml:mo>χ</mml:mo>
              </mml:mrow>
              <mml:mi>i</mml:mi>
              <mml:mn>2</mml:mn>
            </mml:msubsup>
            <mml:mo stretchy="false">]</mml:mo>
            <mml:mo>=</mml:mo>
            <mml:mo>:</mml:mo>
            <mml:mo stretchy="false">[</mml:mo>
            <mml:mo>Ξ</mml:mo>
            <mml:mo stretchy="false">]</mml:mo>
            <mml:mo>,</mml:mo>
          </mml:mrow>
        </mml:math>
      </disp-formula>
    </sec>
    <sec>
      <title>2.3 Cross-scoring</title>
      <p>PascalX implements two novel cross GWAS gene coherence enrichment tests based on the product-normal distribution, described in detail in <xref rid="btad296-B8" ref-type="bibr">Krefl and Bergmann (2022)</xref>. The first test, referred to as coherence test, is the statistics
with <italic toggle="yes">z</italic> and <italic toggle="yes">w</italic> effect sizes of two different GWAS, both assumed to be following <inline-formula id="IE14"><mml:math id="IM14" display="inline" overflow="scroll"><mml:mrow><mml:mi mathvariant="script" class="calligraphy">N</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mo>Σ</mml:mo></mml:mrow><mml:mi>G</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> under the null. The second test, called ratio test, is given by
or with <italic toggle="yes">z</italic> and <italic toggle="yes">w</italic> interchanged. As derived in <xref rid="btad296-B8" ref-type="bibr">Krefl and Bergmann (2022)</xref>, the null distribution of these two new statistical tests can also be expressed in terms of a linear combination of <inline-formula id="IE15"><mml:math id="IM15" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:mrow><mml:mo>χ</mml:mo></mml:mrow><mml:mn>1</mml:mn><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:mrow></mml:math></inline-formula> distributions, albeit for these tests the linear combination contains also negative coefficients, such that only Davies’ algorithm can be applied for calculation of the corresponding CDF, see <xref rid="sup1" ref-type="supplementary-material">Supplementary Section S1</xref>.</p>
      <disp-formula id="E3">
        <mml:math id="M3" display="block" overflow="scroll">
          <mml:mrow>
            <mml:msub>
              <mml:mrow>
                <mml:mi>X</mml:mi>
              </mml:mrow>
              <mml:mi>G</mml:mi>
            </mml:msub>
            <mml:mo>=</mml:mo>
            <mml:munderover>
              <mml:mo>∑</mml:mo>
              <mml:mrow>
                <mml:mi>i</mml:mi>
                <mml:mo>=</mml:mo>
                <mml:mn>1</mml:mn>
              </mml:mrow>
              <mml:mrow>
                <mml:msub>
                  <mml:mrow>
                    <mml:mi>N</mml:mi>
                  </mml:mrow>
                  <mml:mi>G</mml:mi>
                </mml:msub>
              </mml:mrow>
            </mml:munderover>
            <mml:mrow>
              <mml:msub>
                <mml:mrow>
                  <mml:mi>z</mml:mi>
                </mml:mrow>
                <mml:mi>i</mml:mi>
              </mml:msub>
            </mml:mrow>
            <mml:msub>
              <mml:mrow>
                <mml:mi>w</mml:mi>
              </mml:mrow>
              <mml:mi>i</mml:mi>
            </mml:msub>
            <mml:mo>,</mml:mo>
          </mml:mrow>
        </mml:math>
      </disp-formula>
      <disp-formula id="E4">
        <mml:math id="M4" display="block" overflow="scroll">
          <mml:mrow>
            <mml:msub>
              <mml:mrow>
                <mml:mi>R</mml:mi>
              </mml:mrow>
              <mml:mi>G</mml:mi>
            </mml:msub>
            <mml:mo>=</mml:mo>
            <mml:mfrac>
              <mml:mrow>
                <mml:msubsup>
                  <mml:mo>∑</mml:mo>
                  <mml:mrow>
                    <mml:mi>i</mml:mi>
                    <mml:mo>=</mml:mo>
                    <mml:mn>1</mml:mn>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:msub>
                      <mml:mrow>
                        <mml:mi>N</mml:mi>
                      </mml:mrow>
                      <mml:mi>G</mml:mi>
                    </mml:msub>
                  </mml:mrow>
                </mml:msubsup>
                <mml:mrow>
                  <mml:msub>
                    <mml:mrow>
                      <mml:mi>z</mml:mi>
                    </mml:mrow>
                    <mml:mi>i</mml:mi>
                  </mml:msub>
                </mml:mrow>
                <mml:msub>
                  <mml:mrow>
                    <mml:mi>w</mml:mi>
                  </mml:mrow>
                  <mml:mi>i</mml:mi>
                </mml:msub>
              </mml:mrow>
              <mml:mrow>
                <mml:msubsup>
                  <mml:mo>∑</mml:mo>
                  <mml:mrow>
                    <mml:mi>i</mml:mi>
                    <mml:mo>=</mml:mo>
                    <mml:mn>1</mml:mn>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:msub>
                      <mml:mrow>
                        <mml:mi>N</mml:mi>
                      </mml:mrow>
                      <mml:mi>G</mml:mi>
                    </mml:msub>
                  </mml:mrow>
                </mml:msubsup>
                <mml:mrow>
                  <mml:msubsup>
                    <mml:mrow>
                      <mml:mi>z</mml:mi>
                    </mml:mrow>
                    <mml:mi>i</mml:mi>
                    <mml:mn>2</mml:mn>
                  </mml:msubsup>
                </mml:mrow>
              </mml:mrow>
            </mml:mfrac>
            <mml:mo>,</mml:mo>
          </mml:mrow>
        </mml:math>
      </disp-formula>
    </sec>
    <sec>
      <title>2.4 Pathway scoring</title>
      <p>The pathway scoring algorithm PascalX makes use of to aggregate individual gene scores to pathway level scores is the gene fusion-based algorithm of <xref rid="btad296-B10" ref-type="bibr">Lamparter et al. (2016)</xref>. In detail, genes in a pathway, which are in close proximity to each other, are fused to form a so-called meta-gene, and a corresponding gene score is calculated as for ordinary genes described in Section 2.2. This corrects for LD induced dependencies between the individual gene scores, such that one can test for pathway enrichment against a <inline-formula id="IE16"><mml:math id="IM16" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:mrow><mml:mo>χ</mml:mo></mml:mrow><mml:mi>N</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:math></inline-formula> distribution under ranking and inverse transforming the individual gene <italic toggle="yes">P</italic>-values to <inline-formula id="IE17"><mml:math id="IM17" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:mrow><mml:mo>χ</mml:mo></mml:mrow><mml:mn>1</mml:mn><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:mrow></mml:math></inline-formula> distributed random variables. Since the main ingredient are the gene scores described in Section 2.2, the improvements in the original genescoring PascalX offers are directly inherited to the pathway scoring.</p>
      <p>Since the pathway scoring is independent on the origin of the gene scores, pathway enrichment can also be tested for the cross-enrichment scores of Section 2.3.</p>
    </sec>
    <sec>
      <title>2.5 Acceleration</title>
      <sec>
        <title>2.5.1 Multithreading</title>
        <p>Computations on individual gene level with GWAS data are ideally suited for acceleration via parallelization, as computations for each gene can be performed independently from other genes. PascalX makes use of this and offers the option to parallelize computations via python multiprocessing. The performance gain achievable is illustrated in the <xref rid="sup1" ref-type="supplementary-material">Supplementary Figs S13–S15</xref>.</p>
      </sec>
      <sec>
        <title>2.5.2 GPU</title>
        <p>The PascalX methodology requires the computation of large genotypic covariance matrices, and eigenvalue decompositions thereof. It is well known that such basic linear algebra matrix operations can be significantly speedup on specialized hardware, like graphic processor units. Therefore, PascalX supports GPU acceleration of these operations, making use of the ‘cupy’ library (<xref rid="btad296-B12" ref-type="bibr">Okuta et al. 2017</xref>). The performance gain is significant, as is illustrated in <xref rid="sup1" ref-type="supplementary-material">Supplementary Figs S13–S15</xref>.</p>
      </sec>
      <sec>
        <title>2.5.3 Storage</title>
        <p>PascalX requires fast random access to SNP level genotypes of a reference population. Therefore, PascalX stores the genotypes in its own format, indexed by genomic position and variant id. Only indices are kept in memory and the genotypes are read on the fly from storage. In detail, the data for each individual SNP are stored serialized via pickle with additional zlib compression. The corresponding position on disk is stored in indices for genomic position and variant id for fast random access retrieval.</p>
      </sec>
    </sec>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material id="sup1" position="float" content-type="local-data">
      <label>btad296_Supplementary_Data</label>
      <media xlink:href="btad296_supplementary_data.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <ack id="ack1">
    <title>Acknowledgements</title>
    <p>We thank the reviewers for their comments and suggestions to improve the manuscript and functionality of PascalX.</p>
  </ack>
  <sec>
    <title>Supplementary data</title>
    <p><xref rid="sup1" ref-type="supplementary-material">Supplementary data</xref> is available at <italic toggle="yes">Bioinformatics</italic> online.</p>
  </sec>
  <sec sec-type="COI-statement">
    <title>Conflict of interest</title>
    <p>None declared.</p>
  </sec>
  <sec>
    <title>Funding</title>
    <p>This work was supported by the Swiss National Science Foundation [grant FN 310030_176138].</p>
  </sec>
  <sec sec-type="data-availability">
    <title>Data availability</title>
    <p>As the data has been only used for the supplementary analysis in the supplement, the (rather long) data availability statement can be found in the <xref rid="sup1" ref-type="supplementary-material">Supplementary Material</xref>.</p>
  </sec>
  <ref-list id="ref1">
    <title>References</title>
    <ref id="btad296-B1">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Bodenham</surname><given-names>DA</given-names></string-name>, <string-name><surname>Adams</surname><given-names>NM.</given-names></string-name></person-group><article-title>A comparison of efficient approximations for a weighted sum of chi-squared random variables</article-title>. <source>Stat Comput</source><year>2016</year>;<volume>26</volume>:<fpage>917</fpage>–<lpage>28</lpage>.</mixed-citation>
    </ref>
    <ref id="btad296-B2">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Davies</surname><given-names>RB.</given-names></string-name></person-group><article-title>Numerical inversion of a characteristic function</article-title>. <source>Biometrika</source><year>1973</year>;<volume>60</volume>:<fpage>415</fpage>–<lpage>7</lpage>.</mixed-citation>
    </ref>
    <ref id="btad296-B3">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>de Leeuw</surname><given-names>CA</given-names></string-name>, <string-name><surname>Mooij</surname><given-names>JM</given-names></string-name>, <string-name><surname>Heskes</surname><given-names>T</given-names></string-name></person-group><etal>et al</etal><article-title>MAGMA: generalized gene-set analysis of GWAS data</article-title>. <source>PLoS Comput Biol</source><year>2015</year>;<volume>11</volume>:<fpage>e1004219</fpage>.<pub-id pub-id-type="pmid">25885710</pub-id></mixed-citation>
    </ref>
    <ref id="btad296-B4">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>de Leeuw</surname><given-names>CA</given-names></string-name>, <string-name><surname>Neale</surname><given-names>BM</given-names></string-name>, <string-name><surname>Heskes</surname><given-names>T</given-names></string-name></person-group><etal>et al</etal><article-title>The statistical properties of gene-set analysis</article-title>. <source>Nat Rev Genet</source><year>2016</year>;<volume>17</volume>:<fpage>353</fpage>–<lpage>64</lpage>.<pub-id pub-id-type="pmid">27070863</pub-id></mixed-citation>
    </ref>
    <ref id="btad296-B5">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Farebrother</surname><given-names>RW.</given-names></string-name></person-group><article-title>Algorithm as 204: the distribution of a positive linear combination of <inline-formula id="IE18"><mml:math id="IM18" display="inline" overflow="scroll"><mml:mrow><mml:msup><mml:mrow><mml:mo>χ</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:math></inline-formula> random variables</article-title>. <source>J R Stat Soc Ser C Appl Stat</source><year>1984</year>;<volume>33</volume>:<fpage>332</fpage>–<lpage>9</lpage>.</mixed-citation>
    </ref>
    <ref id="btad296-B6">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Gazal</surname><given-names>S</given-names></string-name>, <string-name><surname>Weissbrod</surname><given-names>O</given-names></string-name>, <string-name><surname>Hormozdiari</surname><given-names>F</given-names></string-name></person-group><etal>et al</etal><article-title>Combining SNP-to-gene linking strategies to identify disease genes and assess disease omnigenicity</article-title>. <source>Nat Genet</source><year>2022</year>;<volume>54</volume>:<fpage>827</fpage>–<lpage>36</lpage>.<pub-id pub-id-type="pmid">35668300</pub-id></mixed-citation>
    </ref>
    <ref id="btad296-B7">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Imhof</surname><given-names>JP.</given-names></string-name></person-group><article-title>Computing the distribution of quadratic forms in normal variables</article-title>. <source>Biometrika</source><year>1961</year>;<volume>48</volume>:<fpage>419</fpage>–<lpage>26</lpage>.</mixed-citation>
    </ref>
    <ref id="btad296-B8">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Krefl</surname><given-names>D</given-names></string-name>, <string-name><surname>Bergmann</surname><given-names>S.</given-names></string-name></person-group><article-title>Cross-GWAS coherence test at the gene and pathway level</article-title>. <source>PLoS Comput Biol</source><year>2022</year>;<volume>18</volume>:<fpage>e1010517</fpage>.<pub-id pub-id-type="pmid">36156592</pub-id></mixed-citation>
    </ref>
    <ref id="btad296-B9">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Kuonen</surname><given-names>D.</given-names></string-name></person-group><article-title>Saddlepoint approximations for distributions of quadratic forms in normal variables</article-title>. <source>Biometrika</source><year>1999</year>;<volume>86</volume>:<fpage>929</fpage>–<lpage>35</lpage>.</mixed-citation>
    </ref>
    <ref id="btad296-B10">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Lamparter</surname><given-names>D</given-names></string-name>, <string-name><surname>Marbach</surname><given-names>D</given-names></string-name>, <string-name><surname>Rueedi</surname><given-names>R</given-names></string-name></person-group><etal>et al</etal><article-title>Fast and rigorous computation of gene and pathway scores from SNP-based summary statistics</article-title>. <source>PLoS Comput Biol</source><year>2016</year>;<volume>12</volume>:<fpage>e1004714</fpage>.<pub-id pub-id-type="pmid">26808494</pub-id></mixed-citation>
    </ref>
    <ref id="btad296-B11">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Liu</surname><given-names>Y</given-names></string-name>, <string-name><surname>Chen</surname><given-names>S</given-names></string-name>, <string-name><surname>Li</surname><given-names>Z</given-names></string-name></person-group><etal>et al</etal><article-title>ACAT: a fast and powerful p value combination method for rare-variant analysis in sequencing studies</article-title>. <source>Am J Hum Genet</source><year>2019</year>;<volume>104</volume>:<fpage>410</fpage>–<lpage>21</lpage>.<pub-id pub-id-type="pmid">30849328</pub-id></mixed-citation>
    </ref>
    <ref id="btad296-B12">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><string-name><surname>Okuta</surname><given-names>R, Yuya U, Daisuke N.</given-names></string-name></person-group><etal>et al</etal> CuPy: a NumPy-compatible library for NVIDIA GPU calculations. In: <italic toggle="yes">Proceedings of Workshop on Machine Learning Systems (LearningSys) in The Thirty-first Annual Conference on Neural Information Processing Systems (NIPS)</italic>. <year>2017</year>.</mixed-citation>
    </ref>
    <ref id="btad296-B13">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Pearson</surname><given-names>ES.</given-names></string-name></person-group><article-title>Note on an approximation to the distribution of non-central</article-title><inline-formula id="IE19"><mml:math id="IM19" display="inline" overflow="scroll"><mml:mrow><mml:msup><mml:mrow><mml:mo>χ</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:math></inline-formula>. <source>Biometrika</source><year>1959</year>;<volume>46</volume>:<fpage>364</fpage>.</mixed-citation>
    </ref>
    <ref id="btad296-B14">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Ruben</surname><given-names>H.</given-names></string-name></person-group><article-title>Probability content of regions under spherical normal distributions, IV: the distribution of homogeneous and non-homogeneous quadratic functions of normal variables</article-title>. <source>Ann Math Statist</source><year>1962</year>;<volume>33</volume>:<fpage>542</fpage>–<lpage>70</lpage>.</mixed-citation>
    </ref>
    <ref id="btad296-B15">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Satterthwaite</surname><given-names>FE.</given-names></string-name></person-group><article-title>An approximate distribution of estimates of variance components</article-title>. <source>Biometrics Bull</source><year>1946</year>;<volume>2</volume>:<fpage>110</fpage>–<lpage>4</lpage>.</mixed-citation>
    </ref>
    <ref id="btad296-B16">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Sheil</surname><given-names>J</given-names></string-name>, <string-name><surname>O'Muircheartaigh</surname><given-names>I.</given-names></string-name></person-group><article-title>The distribution of non-negative quadratic forms in normal variables</article-title>. <source>J R Stat Soc Ser C Appl Stat</source><year>1977</year>;<volume>26</volume>:<fpage>92</fpage>–<lpage>8</lpage>.</mixed-citation>
    </ref>
    <ref id="btad296-B17">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Welch</surname><given-names>BL.</given-names></string-name></person-group><article-title>The significance of the difference between two means when the population variances are unequal</article-title>. <source>Biometrika</source><year>1938</year>;<volume>29</volume>:<fpage>350</fpage>–<lpage>62</lpage>.</mixed-citation>
    </ref>
  </ref-list>
</back>
