<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.1d3 20150301//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 39.96?>
<?ConverterInfo.XSLTName jats2jats3.xsl?>
<?ConverterInfo.Version 1?>
<?properties open_access?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">PLoS Comput Biol</journal-id>
    <journal-id journal-id-type="iso-abbrev">PLoS Comput Biol</journal-id>
    <journal-id journal-id-type="publisher-id">plos</journal-id>
    <journal-title-group>
      <journal-title>PLOS Computational Biology</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1553-734X</issn>
    <issn pub-type="epub">1553-7358</issn>
    <publisher>
      <publisher-name>Public Library of Science</publisher-name>
      <publisher-loc>San Francisco, CA USA</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">9754607</article-id>
    <article-id pub-id-type="pmid">36469540</article-id>
    <article-id pub-id-type="publisher-id">PCOMPBIOL-D-22-00219</article-id>
    <article-id pub-id-type="doi">10.1371/journal.pcbi.1010732</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Research Article</subject>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Medicine and Health Sciences</subject>
        <subj-group>
          <subject>Oncology</subject>
          <subj-group>
            <subject>Cancers and Neoplasms</subject>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Medicine and Health Sciences</subject>
        <subj-group>
          <subject>Oncology</subject>
          <subj-group>
            <subject>Cancers and Neoplasms</subject>
            <subj-group>
              <subject>Colorectal Cancer</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Physical Sciences</subject>
        <subj-group>
          <subject>Mathematics</subject>
          <subj-group>
            <subject>Applied Mathematics</subject>
            <subj-group>
              <subject>Algorithms</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Research and Analysis Methods</subject>
        <subj-group>
          <subject>Simulation and Modeling</subject>
          <subj-group>
            <subject>Algorithms</subject>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Medicine and Health Sciences</subject>
        <subj-group>
          <subject>Oncology</subject>
          <subj-group>
            <subject>Cancers and Neoplasms</subject>
            <subj-group>
              <subject>Malignant Tumors</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Medicine and Health Sciences</subject>
        <subj-group>
          <subject>Oncology</subject>
          <subj-group>
            <subject>Cancers and Neoplasms</subject>
            <subj-group>
              <subject>Blastoma</subject>
              <subj-group>
                <subject>Glioblastoma Multiforme</subject>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Medicine and Health Sciences</subject>
        <subj-group>
          <subject>Oncology</subject>
          <subj-group>
            <subject>Cancers and Neoplasms</subject>
            <subj-group>
              <subject>Neurological Tumors</subject>
              <subj-group>
                <subject>Glioblastoma Multiforme</subject>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Medicine and Health Sciences</subject>
        <subj-group>
          <subject>Neurology</subject>
          <subj-group>
            <subject>Neurological Tumors</subject>
            <subj-group>
              <subject>Glioblastoma Multiforme</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Genetics</subject>
          <subj-group>
            <subject>Mutation</subject>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Medicine and Health Sciences</subject>
        <subj-group>
          <subject>Oncology</subject>
          <subj-group>
            <subject>Cancers and Neoplasms</subject>
            <subj-group>
              <subject>Gastrointestinal Tumors</subject>
              <subj-group>
                <subject>Pancreatic Cancer</subject>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Medicine and Health Sciences</subject>
        <subj-group>
          <subject>Oncology</subject>
          <subj-group>
            <subject>Carcinogenesis</subject>
          </subj-group>
        </subj-group>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>ToMExO: A probabilistic tree-structured model for cancer progression</article-title>
      <alt-title alt-title-type="running-head">ToMExO: A probabilistic tree-structured model for cancer progression</alt-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0002-0782-8308</contrib-id>
        <name>
          <surname>Mohaghegh Neyshabouri</surname>
          <given-names>Mohammadreza</given-names>
        </name>
        <role content-type="http://credit.niso.org/contributor-roles/conceptualization/">Conceptualization</role>
        <role content-type="http://credit.niso.org/contributor-roles/data-curation/">Data curation</role>
        <role content-type="http://credit.niso.org/contributor-roles/formal-analysis/">Formal analysis</role>
        <role content-type="http://credit.niso.org/contributor-roles/investigation/">Investigation</role>
        <role content-type="http://credit.niso.org/contributor-roles/methodology/">Methodology</role>
        <role content-type="http://credit.niso.org/contributor-roles/project-administration/">Project administration</role>
        <role content-type="http://credit.niso.org/contributor-roles/resources/">Resources</role>
        <role content-type="http://credit.niso.org/contributor-roles/software/">Software</role>
        <role content-type="http://credit.niso.org/contributor-roles/validation/">Validation</role>
        <role content-type="http://credit.niso.org/contributor-roles/visualization/">Visualization</role>
        <role content-type="http://credit.niso.org/contributor-roles/writing-original-draft/">Writing – original draft</role>
        <role content-type="http://credit.niso.org/contributor-roles/writing-review-editing/">Writing – review &amp; editing</role>
        <xref rid="aff001" ref-type="aff">
          <sup>1</sup>
        </xref>
        <xref rid="aff002" ref-type="aff">
          <sup>2</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0002-4552-0240</contrib-id>
        <name>
          <surname>Lagergren</surname>
          <given-names>Jens</given-names>
        </name>
        <role content-type="http://credit.niso.org/contributor-roles/conceptualization/">Conceptualization</role>
        <role content-type="http://credit.niso.org/contributor-roles/funding-acquisition/">Funding acquisition</role>
        <role content-type="http://credit.niso.org/contributor-roles/supervision/">Supervision</role>
        <role content-type="http://credit.niso.org/contributor-roles/writing-review-editing/">Writing – review &amp; editing</role>
        <xref rid="aff001" ref-type="aff">
          <sup>1</sup>
        </xref>
        <xref rid="aff002" ref-type="aff">
          <sup>2</sup>
        </xref>
        <xref rid="cor001" ref-type="corresp">*</xref>
      </contrib>
    </contrib-group>
    <aff id="aff001">
      <label>1</label>
      <addr-line>Department of Electrical Engineering and Computer Science, KTH Royal Institute of Technology, Stockholm, Sweden</addr-line>
    </aff>
    <aff id="aff002">
      <label>2</label>
      <addr-line>Science for Life Laboratory, Stockholm, Sweden</addr-line>
    </aff>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Przytycka</surname>
          <given-names>Teresa M.</given-names>
        </name>
        <role>Editor</role>
        <xref rid="edit1" ref-type="aff"/>
      </contrib>
    </contrib-group>
    <aff id="edit1">
      <addr-line>National Center for Biotechnology Information (NCBI), UNITED STATES</addr-line>
    </aff>
    <author-notes>
      <fn fn-type="COI-statement" id="coi001">
        <p>The authors have declared that no competing interests exist.</p>
      </fn>
      <corresp id="cor001">* E-mail: <email>jens.lagergren@scilifelab.se</email></corresp>
    </author-notes>
    <pub-date pub-type="collection">
      <month>12</month>
      <year>2022</year>
    </pub-date>
    <pub-date pub-type="epub">
      <day>5</day>
      <month>12</month>
      <year>2022</year>
    </pub-date>
    <volume>18</volume>
    <issue>12</issue>
    <elocation-id>e1010732</elocation-id>
    <history>
      <date date-type="received">
        <day>14</day>
        <month>2</month>
        <year>2022</year>
      </date>
      <date date-type="accepted">
        <day>14</day>
        <month>11</month>
        <year>2022</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© 2022 Mohaghegh Neyshabouri, Lagergren</copyright-statement>
      <copyright-year>2022</copyright-year>
      <copyright-holder>Mohaghegh Neyshabouri, Lagergren</copyright-holder>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
      </license>
    </permissions>
    <self-uri content-type="pdf" xlink:href="pcbi.1010732.pdf"/>
    <abstract>
      <p>Identifying the interrelations among cancer driver genes and the patterns in which the driver genes get mutated is critical for understanding cancer. In this paper, we study cross-sectional data from cohorts of tumors to identify the cancer-type (or subtype) specific process in which the cancer driver genes accumulate critical mutations. We model this mutation accumulation process using a tree, where each node includes a driver gene or a set of driver genes. A mutation in each node enables its children to have a chance of mutating. This model simultaneously explains the mutual exclusivity patterns observed in mutations in specific cancer genes (by its nodes) and the temporal order of events (by its edges). We introduce a computationally efficient dynamic programming procedure for calculating the likelihood of our noisy datasets and use it to build our Markov Chain Monte Carlo (MCMC) inference algorithm, ToMExO. Together with a set of engineered MCMC moves, our fast likelihood calculations enable us to work with datasets with hundreds of genes and thousands of tumors, which cannot be dealt with using available cancer progression analysis methods. We demonstrate our method’s performance on several synthetic datasets covering various scenarios for cancer progression dynamics. Then, a comparison against two state-of-the-art methods on a moderate-size biological dataset shows the merits of our algorithm in identifying significant and valid patterns. Finally, we present our analyses of several large biological datasets, including colorectal cancer, glioblastoma, and pancreatic cancer. In all the analyses, we validate the results using a set of method-independent metrics testing the causality and significance of the relations identified by ToMExO or competing methods.</p>
    </abstract>
    <abstract abstract-type="summary">
      <title>Author summary</title>
      <p>Cancer progression is an evolutionary process where somatic mutations in so-called driver genes provide the harboring cells with certain selective advantages. Identifying the interplay among the driver genes is critical for understanding how cancer evolves. In this paper, we introduce a method for analyzing cohorts of tumors. Our approach is based on a novel probabilistic model, which can identify the temporal order of mutations in driver genes, and how they may exhaust each other’s selective advantages. We introduce an efficient likelihood calculation procedure and build an MCMC algorithm for making inferences based on our model. Our computationally efficient inference algorithm enables us to work with hundreds of genes and thousands of tumors. Using a broad set of synthetic data experiments, we demonstrate the performance of our inference algorithm in various scenarios. We also present our analyses of several biological datasets. Our results agree with a set of well-known relations among the driver genes and suggest new interesting such relationships.</p>
    </abstract>
    <funding-group>
      <award-group id="award001">
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="funder-id">http://dx.doi.org/10.13039/501100007601</institution-id>
            <institution>Horizon 2020</institution>
          </institution-wrap>
        </funding-source>
        <award-id>MSCA-ITN-2017-766030</award-id>
      </award-group>
      <award-group id="award002">
        <funding-source>
          <institution>Swedish Foundation for Strategic Research</institution>
        </funding-source>
        <award-id>BD15-0043</award-id>
      </award-group>
      <funding-statement>This project has received funding from the European Union’s Horizon 2020 research and innovation programme under the Marie Skłodowska-Curie grant agreement MSCA-ITN-2017-766030 and from the Swedish Foundation for Strategic Research grant BD15-0043. The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.</funding-statement>
    </funding-group>
    <counts>
      <fig-count count="11"/>
      <table-count count="0"/>
      <page-count count="22"/>
    </counts>
    <custom-meta-group>
      <custom-meta>
        <meta-name>PLOS Publication Stage</meta-name>
        <meta-value>vor-update-to-uncorrected-proof</meta-value>
      </custom-meta>
      <custom-meta>
        <meta-name>Publication Update</meta-name>
        <meta-value>2022-12-15</meta-value>
      </custom-meta>
      <custom-meta id="data-availability">
        <meta-name>Data Availability</meta-name>
        <meta-value>The Code and data links are available at: <ext-link xlink:href="https://github.com/mrmohaghegh/tomexo" ext-link-type="uri">https://github.com/mrmohaghegh/tomexo</ext-link>.</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
  <notes>
    <title>Data Availability</title>
    <p>The Code and data links are available at: <ext-link xlink:href="https://github.com/mrmohaghegh/tomexo" ext-link-type="uri">https://github.com/mrmohaghegh/tomexo</ext-link>.</p>
  </notes>
</front>
<body>
  <disp-quote>
    <p>This is a <italic toggle="yes">PLOS Computational Biology</italic> Methods paper.</p>
  </disp-quote>
  <sec sec-type="intro" id="sec001">
    <title>Introduction</title>
    <p>Cancer is a disease caused by evolutionary processes involving the accumulation of somatic mutations in the genome [<xref rid="pcbi.1010732.ref001" ref-type="bibr">1</xref>]. Some mutations in so-called cancer driver genes confer selective advantages to the cells harboring them. Each driver mutation can potentially affect the chances of happening or fixation for the rest of the driver genes by, for example, exhausting or boosting the selective advantage of mutations in specific genes. Identifying the interplay between driver mutations is crucial for a broad set of research and clinical applications, including choosing targets for new drugs, the prognosis of individual tumors, and designing patient-specific treatment plans. The rapidly increasing amount of publicly available genomics data encourages the development of computational methods to use the rich co-occurrence patterns among the driver mutations to gain a deeper understanding of their effects on each other. In this paper, we introduce a probabilistic cancer progression model for analyzing cross-sectional data from large cohorts of tumors and identifying the mutual exclusivity and chronological patterns among cancer driver genes.</p>
    <p>The cancer progression models generally focus on inferring the interactions among the driver mutations. Two main types of such interactions, which have been of particular interest, are the progression and mutual exclusivity relations [<xref rid="pcbi.1010732.ref002" ref-type="bibr">2</xref>]. The progression relation refers to a situation when a mutation, e.g., a loss-of-function mutation in a tumor suppressor gene, increases the chance of occurrence or fixation of another mutation. The studies on the progression relations among driver event have used various types of structural models including oncogenetic trees [<xref rid="pcbi.1010732.ref003" ref-type="bibr">3</xref>–<xref rid="pcbi.1010732.ref009" ref-type="bibr">9</xref>] and conjunctive Bayesian networks (CBN) [<xref rid="pcbi.1010732.ref010" ref-type="bibr">10</xref>–<xref rid="pcbi.1010732.ref013" ref-type="bibr">13</xref>]. On the other hand, the mutual exclusivity relation refers to when two mutations are observed together less frequently than expected by chance. This can happen due to the roles of the genes in a particular pathway or protein complex, where a mutation in one of the genes disrupts the functionality of the pathway or protein complex and exhaust the selective advantage of mutation in the rest of the group [<xref rid="pcbi.1010732.ref014" ref-type="bibr">14</xref>]. Another underlying reason for the mutual exclusivity patterns is a phenomenon called synthetic lethality [<xref rid="pcbi.1010732.ref015" ref-type="bibr">15</xref>], where the cells can live with mutations in one of the genes in a particular group, but mutations in two or more of the group members lead to the cell death. The mutual exclusivity relations are also studied using various methods, including integer linear programming (ILP) [<xref rid="pcbi.1010732.ref016" ref-type="bibr">16</xref>], sampling-based methods involving statistical tests [<xref rid="pcbi.1010732.ref017" ref-type="bibr">17</xref>], and generative probabilistic models [<xref rid="pcbi.1010732.ref014" ref-type="bibr">14</xref>, <xref rid="pcbi.1010732.ref018" ref-type="bibr">18</xref>]. As a set of mutually exclusive driver genes may have the same effect on another gene through disruption of the same biological pathway, simultaneous inference of sets of mutually exclusive drive genes and the progression patterns among these sets can provide a better understanding of cancer’s progression dynamics [<xref rid="pcbi.1010732.ref002" ref-type="bibr">2</xref>]. An ILP-based algorithm in [<xref rid="pcbi.1010732.ref019" ref-type="bibr">19</xref>], called PLPM, simultaneously infers mutually exclusive sets of genes called <italic toggle="yes">driver pathways</italic> and a linear progression structure over these pathways. In [<xref rid="pcbi.1010732.ref020" ref-type="bibr">20</xref>], a probabilistic counterpart of PLPM is introduced. An efficient likelihood calculation procedure within a Markov chain Monte Carlo algorithm enables the probabilistic PLPM [<xref rid="pcbi.1010732.ref020" ref-type="bibr">20</xref>] to analyze larger datasets. In [<xref rid="pcbi.1010732.ref002" ref-type="bibr">2</xref>], a method called pathTiMEx is introduced. In pathTiMEx, the cancer progression dynamics are modeled using a CBN with sets of mutually exclusive genes (driver pathways) in its nodes. An iterative EM-like [<xref rid="pcbi.1010732.ref021" ref-type="bibr">21</xref>] algorithm is used for training the model. Some other studies, including the network aberration model (NAM) [<xref rid="pcbi.1010732.ref022" ref-type="bibr">22</xref>] and mutual hazard networks (MHN) [<xref rid="pcbi.1010732.ref023" ref-type="bibr">23</xref>], have taken a rather different approach. In these papers, the cancer progression dynamics are modeled using a base mutation rate for each driver gene and a set of pairwise relations in the form of multiplicative effects that the genes may impose on each other’s mutation rates. While the NAM model [<xref rid="pcbi.1010732.ref022" ref-type="bibr">22</xref>] only considers the positive (enabling) effects of mutations on each other, the MHN model handles the negative (inhibiting) effects as well.</p>
    <p>With the increasing amount of available data, there is a demand for progression models that can handle hundreds of genes and thousands of tumors. The state-of-the-art methods, including pathTiMEx [<xref rid="pcbi.1010732.ref002" ref-type="bibr">2</xref>] and MHN [<xref rid="pcbi.1010732.ref023" ref-type="bibr">23</xref>], cannot take more than around 20 genes in the data as their computational complexity grows exponentially with the number of genes. On the other hand, scalable methods such as probabilistic PLPM [<xref rid="pcbi.1010732.ref020" ref-type="bibr">20</xref>] that can work with many genes have limited modeling abilities. This paper introduces a method called ToMExO (Tree of Mutually Exclusive Oncogenes), which is more scalable than probabilistic PLPM while enjoying a significantly richer modeling ability. Our method ToMExO is still limited compared to pathTiMEx and MHN in the sense of the modeling power. However, as shown in our comparisons in the paper, the progression model found by our algorithm can be better validated even against pathTiMEx and MHN on a dataset feasible to be analyzed by them.</p>
    <p>ToMExO is a probabilistic cancer progression method working with datasets including information on the presence/absence of mutations in a set of genes in a cohort of tumors. We simultaneously identify critical driver genes, group them as sets of mutually exclusive genes (driver pathways), and arrange them in a tree structure representing the order in which they get mutated. We introduce a computationally efficient dynamic programming procedure for likelihood calculations, used as the core of a Markov Chain Monte Carlo (MCMC) algorithm to make inferences based on our model. We have also designed a set of novel structural moves, enabling us to explore our model space efficiently. This work improves the probabilistic PLPM method [<xref rid="pcbi.1010732.ref020" ref-type="bibr">20</xref>] in several ways. Firstly, the modeling power is improved from a single linear chain to a tree-like structure. Furthermore, while [<xref rid="pcbi.1010732.ref020" ref-type="bibr">20</xref>] uses a grid search strategy for selecting the model complexity (length of the linear structure in their model), ToMExO resolves the model selection issues by introducing flexible MCMC moves that split and merge nodes in various ways. As a result, ToMExO samples can get more or less complex on the fly. Similar to the model used in [<xref rid="pcbi.1010732.ref020" ref-type="bibr">20</xref>], our model in this paper allows for false positive and false negative errors in the dataset. Although the parameters for the probability of each of these error types can be sampled in the MCMC iterations (the way [<xref rid="pcbi.1010732.ref020" ref-type="bibr">20</xref>] does it), we introduce a dynamic programming procedure to find the minimum possible values for these parameters, given a fixed structure. We use this procedure inside the MCMC iterations to speed up the training algorithm. After finding the proper structure, we fine-tune the parameters using gradient descent. This approach for dealing with the noise in ToMExO leads to an improved computational complexity compared to the probabilistic PLPM.</p>
    <p>The paper is organized into two main sections as follows. Section 1 describes the method, where we start with introducing our cancer progression model in section 1.1. We continue with describing the probabilistic model for our data generation process in section 1.2 and introducing our likelihood calculation algorithm in section 1.3. We finish the method section by explaining our inference algorithm in section 1.4. Section 2 presents our results on a set of synthetic and biological data experiments. In section 2.1 we demonstrate our performance in a set of synthetic data simulations. We present our biological data analyses in section 2.2. In this section, after comparing ToMExO against two state-of-the-art methods on a moderate-size dataset, we extend our experiments to a set of larger biological datasets that the competitor algorithms couldn’t analyze due to the larger number of genes.</p>
  </sec>
  <sec id="sec002">
    <title>1 Method</title>
    <p>In this section, we start with introducing our model for cancer progression using an example in section 1.1. In section 1.2 we explain how such a progression model, together with a noise injection procedure can form a <italic toggle="yes">generative process</italic> for our cancer dataset. Our objective is to <italic toggle="yes">learn</italic> a progression model from the datasets. To this end, we start with introducing a likelihood calculation algorithm in section 1.3. This algorithm can be seen as a way to evaluate how well each progression model explains the dataset. In section 1.4 we introduce our inference algorithm, which uses our efficient likelihood calculation procedure as the heart of an MCMC sampling scheme to generate samples from the posterior distribution and <italic toggle="yes">learn</italic> the maximum a posteriori (MAP) estimate of the progression model for the input dataset.</p>
    <sec id="sec003">
      <title>1.1 Cancer progression model</title>
      <p>We model cancer progression using a driver tree (<italic toggle="yes">V</italic>, <italic toggle="yes">E</italic>). Except for the root, the nodes include non-overlapping non-empty subsets of the driver genes. We denote the set of genes in node <italic toggle="yes">v</italic> ∈ <italic toggle="yes">V</italic> by <italic toggle="yes">D</italic><sub><italic toggle="yes">v</italic></sub>. Each edge (<italic toggle="yes">u</italic>, <italic toggle="yes">v</italic>) ∈ <italic toggle="yes">E</italic> has a <italic toggle="yes">firing</italic> probability denoted by <italic toggle="yes">f</italic><sub><italic toggle="yes">v</italic></sub> ∈ (0, 1). <xref rid="pcbi.1010732.g001" ref-type="fig">Fig 1A</xref> shows an example of a progression model.</p>
      <fig position="float" id="pcbi.1010732.g001">
        <object-id pub-id-type="doi">10.1371/journal.pcbi.1010732.g001</object-id>
        <label>Fig 1</label>
        <caption>
          <p><bold>A</bold>. An example cancer progression model. <bold>B</bold>. Three tumors evolved following the model. The <italic toggle="yes">firing</italic> edges are shown in red. The mutated nodes are filled in red, and the genes with driver mutations are shown in bold red font. <bold>C</bold>. The binary matrix representation of the driver mutations in the example tumors. The blocks filled in red represent the 1’s. <bold>D</bold>. The observed dataset including errors in the forms of false positives (light red) and false negatives (gray).</p>
        </caption>
        <graphic xlink:href="pcbi.1010732.g001" position="float"/>
      </fig>
      <p>The model explains the tumor progressions as follows. Starting from the root, each node has a chance to get <italic toggle="yes">mutated</italic> according to its firing probability. All the mutated nodes get a driver mutation in one and only one of their genes, chosen according to a categorical distribution with parameters proportional to the overall mutation rates of the genes. The children of the mutated nodes may get mutated according to their firing probabilities, and the tumor progresses this way. For example, consider the model shown in <xref rid="pcbi.1010732.g001" ref-type="fig">Fig 1A</xref>. Three tumors that evolved according to this model are shown in <xref rid="pcbi.1010732.g001" ref-type="fig">Fig 1B</xref>. In these example tumors, the mutated nodes are colored in red, and the mutated driver genes are shown using the bold red font.</p>
      <p>Given a list of mutations identified in a set of tumors, we can represent the data using a binary matrix with the tumors in the rows and the genes in the columns. Each element (<italic toggle="yes">m</italic>, <italic toggle="yes">n</italic>) is set to one if tumor <italic toggle="yes">m</italic> has a mutation in gene <italic toggle="yes">n</italic>. Following our example scenario in <xref rid="pcbi.1010732.g001" ref-type="fig">Fig 1</xref>, the tumors shown in <xref rid="pcbi.1010732.g001" ref-type="fig">Fig 1B</xref> would result in the matrix shown in <xref rid="pcbi.1010732.g001" ref-type="fig">Fig 1C</xref>, in the absence of any false positives and false negatives. However, the observed data is generally very noisy. The data typically includes many background mutations, which can even happen in the driver genes. Note that when the selective advantage of a mutation in a driver gene is already exhausted by earlier events, we count it as a background mutation. The background mutations and technical errors lead to <italic toggle="yes">false positives</italic> in our data. On the other hand, some driver mutations may be lost due to technical issues such as low coverage of the reads covering those mutations, resulting in <italic toggle="yes">false negatives</italic> in our data. Adding the false positives and false negatives in our example scenario leads to the observed matrix shown in <xref rid="pcbi.1010732.g001" ref-type="fig">Fig 1D</xref>.</p>
    </sec>
    <sec id="sec004">
      <title>1.2 Generative process</title>
      <p>Let <italic toggle="yes">B</italic> be our binary matrix of shape <italic toggle="yes">M</italic> × <italic toggle="yes">N</italic>, including information on <italic toggle="yes">N</italic>
<italic toggle="yes">potentially</italic> driver genes in <italic toggle="yes">M</italic> tumors. The element in the <italic toggle="yes">m</italic><sup>th</sup> row and the <italic toggle="yes">n</italic><sup>th</sup> column of the matrix, denoted by <italic toggle="yes">B</italic><sub><italic toggle="yes">m</italic>,<italic toggle="yes">n</italic></sub>, is equal to one if and only if the <italic toggle="yes">m</italic><sup>th</sup> tumor has at least one mutation in the <italic toggle="yes">n</italic><sup>th</sup> gene. We denote the <italic toggle="yes">m</italic><sup>th</sup> row and the <italic toggle="yes">n</italic><sup>th</sup> column of the matrix by <italic toggle="yes">B</italic><sub><italic toggle="yes">m</italic>,:</sub> and <italic toggle="yes">B</italic><sub>:,<italic toggle="yes">n</italic></sub>, respectively.</p>
      <p>We call the genes not placed into the driver tree as passenger genes and denote the set of passenger genes by <italic toggle="yes">P</italic>. Each progression model is composed of a driver tree (<italic toggle="yes">V</italic>, <italic toggle="yes">E</italic>), the set of genes in each node {<italic toggle="yes">D</italic><sub><italic toggle="yes">v</italic></sub>}<sub><italic toggle="yes">v</italic>∈<italic toggle="yes">V</italic></sub>, the firing probabilities {<italic toggle="yes">f</italic><sub><italic toggle="yes">v</italic></sub>}<sub><italic toggle="yes">v</italic>∈<italic toggle="yes">V</italic></sub>, and the set of passengers <italic toggle="yes">P</italic>. We use the notation <italic toggle="yes">T</italic> to refer to the complete set of all variables above, i.e.,
<disp-formula id="pcbi.1010732.e001"><alternatives><graphic xlink:href="pcbi.1010732.e001.jpg" id="pcbi.1010732.e001g" position="anchor"/><mml:math id="M1" display="block" overflow="scroll"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>T</mml:mi><mml:mo>≜</mml:mo><mml:mo>(</mml:mo><mml:mi>V</mml:mi><mml:mo>,</mml:mo><mml:mi>E</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mo>{</mml:mo><mml:msub><mml:mi>f</mml:mi><mml:mi>v</mml:mi></mml:msub><mml:mo>}</mml:mo></mml:mrow><mml:mrow><mml:mi>v</mml:mi><mml:mo>∈</mml:mo><mml:mi>V</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mo>{</mml:mo><mml:msub><mml:mi>D</mml:mi><mml:mi>v</mml:mi></mml:msub><mml:mo>}</mml:mo></mml:mrow><mml:mrow><mml:mi>v</mml:mi><mml:mo>∈</mml:mo><mml:mi>V</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>P</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives></disp-formula></p>
      <p>A progression model <italic toggle="yes">T</italic>, with false positive probability <italic toggle="yes">ϵ</italic> and false negative probability <italic toggle="yes">δ</italic> form a probabilistic generative model with a graphical model shown in <xref rid="pcbi.1010732.g002" ref-type="fig">Fig 2A</xref>. The matrix <italic toggle="yes">B</italic>* is the unobserved noise-free dataset. Adding false positives and false negatives to <italic toggle="yes">B</italic>* results in the observed matrix <italic toggle="yes">B</italic>. To assess how well the dataset conforms with the progression model <italic toggle="yes">T</italic>, <italic toggle="yes">ϵ</italic>, and <italic toggle="yes">δ</italic>, we need to calculate the likelihood <italic toggle="yes">p</italic>(<italic toggle="yes">B</italic>|<italic toggle="yes">T</italic>, <italic toggle="yes">ϵ</italic>, <italic toggle="yes">δ</italic>). The dataset likelihood can be written as the product of the likelihood of the individual tumors, i.e.,
<disp-formula id="pcbi.1010732.e002"><alternatives><graphic xlink:href="pcbi.1010732.e002.jpg" id="pcbi.1010732.e002g" position="anchor"/><mml:math id="M2" display="block" overflow="scroll"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>B</mml:mi><mml:mo>|</mml:mo><mml:mi>T</mml:mi><mml:mo>,</mml:mo><mml:mi>ϵ</mml:mi><mml:mo>,</mml:mo><mml:mi>δ</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:munder><mml:mo>∏</mml:mo><mml:mrow><mml:mi>m</mml:mi><mml:mo>∈</mml:mo><mml:mo>{</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mi>M</mml:mi><mml:mo>}</mml:mo></mml:mrow></mml:munder><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi>B</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:mo>:</mml:mo></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:mi>T</mml:mi><mml:mo>,</mml:mo><mml:mi>ϵ</mml:mi><mml:mo>,</mml:mo><mml:mi>δ</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives><label>(1)</label></disp-formula></p>
      <fig position="float" id="pcbi.1010732.g002">
        <object-id pub-id-type="doi">10.1371/journal.pcbi.1010732.g002</object-id>
        <label>Fig 2</label>
        <caption>
          <p><bold>A</bold>. Graphical model of the generative process, where <italic toggle="yes">T</italic> is the progression model and <italic toggle="yes">ϵ</italic> and <italic toggle="yes">δ</italic> are the probabilities of false positive and false negative, respectively. The latent and observed mutation matrices are denoted by <italic toggle="yes">B</italic>* and <italic toggle="yes">B</italic>, respectively. <bold>B</bold>. Graphical model of the variables in the nodes of the driver tree. The binary variable <italic toggle="yes">s</italic><sub><italic toggle="yes">m</italic>,<italic toggle="yes">u</italic></sub> is equal to one if and only if node <italic toggle="yes">u</italic> is mutated in tumor <italic toggle="yes">m</italic>.</p>
        </caption>
        <graphic xlink:href="pcbi.1010732.g002" position="float"/>
      </fig>
      <p>In order to calculate <italic toggle="yes">p</italic>(<italic toggle="yes">B</italic><sub><italic toggle="yes">m</italic>,:</sub>|<italic toggle="yes">T</italic>, <italic toggle="yes">ϵ</italic>, <italic toggle="yes">δ</italic>), we have to marginalize out the unobserved <inline-formula id="pcbi.1010732.e003"><alternatives><graphic xlink:href="pcbi.1010732.e003.jpg" id="pcbi.1010732.e003g" position="anchor"/><mml:math id="M3" display="inline" overflow="scroll"><mml:msubsup><mml:mi>B</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:mo>:</mml:mo></mml:mrow><mml:mo>*</mml:mo></mml:msubsup></mml:math></alternatives></inline-formula> vector. We have
<disp-formula id="pcbi.1010732.e004"><alternatives><graphic xlink:href="pcbi.1010732.e004.jpg" id="pcbi.1010732.e004g" position="anchor"/><mml:math id="M4" display="block" overflow="scroll"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi>B</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:mo>:</mml:mo></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:mi>T</mml:mi><mml:mo>,</mml:mo><mml:mi>ϵ</mml:mi><mml:mo>,</mml:mo><mml:mi>δ</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:munder><mml:mo>∑</mml:mo><mml:msubsup><mml:mi>B</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:mo>:</mml:mo></mml:mrow><mml:mo>*</mml:mo></mml:msubsup></mml:munder><mml:mspace width="2pt"/><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi>B</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:mo>:</mml:mo></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msubsup><mml:mi>B</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:mo>:</mml:mo></mml:mrow><mml:mo>*</mml:mo></mml:msubsup><mml:mo>|</mml:mo><mml:mi>T</mml:mi><mml:mo>,</mml:mo><mml:mi>ϵ</mml:mi><mml:mo>,</mml:mo><mml:mi>δ</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:munder><mml:mo>∑</mml:mo><mml:msubsup><mml:mi>B</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:mo>:</mml:mo></mml:mrow><mml:mo>*</mml:mo></mml:msubsup></mml:munder><mml:mspace width="2pt"/><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msubsup><mml:mi>B</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:mo>:</mml:mo></mml:mrow><mml:mo>*</mml:mo></mml:msubsup><mml:mo>|</mml:mo><mml:mi>T</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi>B</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:mo>:</mml:mo></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:msubsup><mml:mi>B</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:mo>:</mml:mo></mml:mrow><mml:mo>*</mml:mo></mml:msubsup><mml:mo>,</mml:mo><mml:mi>ϵ</mml:mi><mml:mo>,</mml:mo><mml:mi>δ</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives><label>(2)</label></disp-formula>
While the summation is to be taken over all 2<sup><italic toggle="yes">N</italic></sup> states of <inline-formula id="pcbi.1010732.e005"><alternatives><graphic xlink:href="pcbi.1010732.e005.jpg" id="pcbi.1010732.e005g" position="anchor"/><mml:math id="M5" display="inline" overflow="scroll"><mml:msubsup><mml:mi>B</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:mo>:</mml:mo></mml:mrow><mml:mo>*</mml:mo></mml:msubsup></mml:math></alternatives></inline-formula>, not all of these states have non-zero <inline-formula id="pcbi.1010732.e006"><alternatives><graphic xlink:href="pcbi.1010732.e006.jpg" id="pcbi.1010732.e006g" position="anchor"/><mml:math id="M6" display="inline" overflow="scroll"><mml:mrow><mml:mi>p</mml:mi><mml:mo>(</mml:mo><mml:msubsup><mml:mi>B</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:mo>:</mml:mo></mml:mrow><mml:mo>*</mml:mo></mml:msubsup><mml:mo>|</mml:mo><mml:mi>T</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>. In the following section, we use this property to introduce an efficient likelihood calculation procedure.</p>
    </sec>
    <sec id="sec005">
      <title>1.3 Dynamic programming for likelihood calculations</title>
      <p>We use a dynamic programming algorithm over the tree to calculate the dataset likelihood in a computationally efficient manner. To this end, we introduce an auxiliary variables <italic toggle="yes">s</italic><sub><italic toggle="yes">m</italic>,<italic toggle="yes">v</italic></sub> ∈ {0, 1} in each node <italic toggle="yes">v</italic> to represent the state of <italic toggle="yes">v</italic> in tumor <italic toggle="yes">m</italic> (healthy/mutated). These variables are the ones forming the connection between two nodes <italic toggle="yes">u</italic> and <italic toggle="yes">v</italic> along an edge (<italic toggle="yes">u</italic>, <italic toggle="yes">v</italic>), where we have
<disp-formula id="pcbi.1010732.e007"><alternatives><graphic xlink:href="pcbi.1010732.e007.jpg" id="pcbi.1010732.e007g" position="anchor"/><mml:math id="M7" display="block" overflow="scroll"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:mi>v</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>|</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:mi>u</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mo>{</mml:mo><mml:mtable><mml:mtr><mml:mtd columnalign="left"><mml:msub><mml:mi>f</mml:mi><mml:mi>v</mml:mi></mml:msub></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>,</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:mi>u</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:mn>0</mml:mn></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>,</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:mi>u</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:mtd></mml:mtr></mml:mtable><mml:mo/><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives><label>(3)</label></disp-formula>
The graphical model in <xref rid="pcbi.1010732.g002" ref-type="fig">Fig 2B</xref> shows the dependencies between the variables inside the nodes of a driver tree.</p>
      <p>Let <inline-formula id="pcbi.1010732.e008"><alternatives><graphic xlink:href="pcbi.1010732.e008.jpg" id="pcbi.1010732.e008g" position="anchor"/><mml:math id="M8" display="inline" overflow="scroll"><mml:msub><mml:mi>B</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>D</mml:mi><mml:mi>v</mml:mi></mml:msub></mml:mrow></mml:msub></mml:math></alternatives></inline-formula> denote the bits corresponding to the genes in <italic toggle="yes">v</italic>. Similarly, we use <inline-formula id="pcbi.1010732.e009"><alternatives><graphic xlink:href="pcbi.1010732.e009.jpg" id="pcbi.1010732.e009g" position="anchor"/><mml:math id="M9" display="inline" overflow="scroll"><mml:msub><mml:mi>B</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:mi>v</mml:mi><mml:mo>↓</mml:mo></mml:mrow></mml:msub></mml:mrow></mml:msub></mml:math></alternatives></inline-formula> to show the bits corresponding to the genes in <italic toggle="yes">v</italic> and its descendant nodes. In each node <italic toggle="yes">v</italic>, we can calculate the likelihood of <inline-formula id="pcbi.1010732.e010"><alternatives><graphic xlink:href="pcbi.1010732.e010.jpg" id="pcbi.1010732.e010g" position="anchor"/><mml:math id="M10" display="inline" overflow="scroll"><mml:msub><mml:mi>B</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>D</mml:mi><mml:mi>v</mml:mi></mml:msub></mml:mrow></mml:msub></mml:math></alternatives></inline-formula> given both possible states of <italic toggle="yes">s</italic><sub><italic toggle="yes">m</italic>,<italic toggle="yes">v</italic></sub> as
<disp-formula id="pcbi.1010732.e011"><alternatives><graphic xlink:href="pcbi.1010732.e011.jpg" id="pcbi.1010732.e011g" position="anchor"/><mml:math id="M11" display="block" overflow="scroll"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:msub><mml:mo>Λ</mml:mo><mml:mrow><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:mi>v</mml:mi></mml:mrow></mml:msub></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>≜</mml:mo><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi>B</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>D</mml:mi><mml:mi>v</mml:mi></mml:msub></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:mi>v</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:munder><mml:mo>∑</mml:mo><mml:msubsup><mml:mi>B</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>D</mml:mi><mml:mi>v</mml:mi></mml:msub></mml:mrow><mml:mo>*</mml:mo></mml:msubsup></mml:munder><mml:mspace width="2pt"/><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msubsup><mml:mi>B</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>D</mml:mi><mml:mi>v</mml:mi></mml:msub></mml:mrow><mml:mo>*</mml:mo></mml:msubsup><mml:mo>|</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:mi>v</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>)</mml:mo></mml:mrow><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi>B</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>D</mml:mi><mml:mi>v</mml:mi></mml:msub></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:msubsup><mml:mi>B</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>D</mml:mi><mml:mi>v</mml:mi></mml:msub></mml:mrow><mml:mo>*</mml:mo></mml:msubsup><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd/><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mo>∑</mml:mo><mml:mrow><mml:mi>g</mml:mi><mml:mo>∈</mml:mo><mml:msub><mml:mi>D</mml:mi><mml:mi>v</mml:mi></mml:msub><mml:mo>:</mml:mo><mml:msub><mml:mi>B</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:mi>g</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:msub><mml:mi>α</mml:mi><mml:mi>g</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mo>∑</mml:mo><mml:mrow><mml:mi>g</mml:mi><mml:mo>∈</mml:mo><mml:msub><mml:mi>D</mml:mi><mml:mi>v</mml:mi></mml:msub></mml:mrow></mml:msub><mml:msub><mml:mi>α</mml:mi><mml:mi>g</mml:mi></mml:msub></mml:mrow></mml:mfrac><mml:mrow><mml:mo>(</mml:mo><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mi>δ</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:msup><mml:mi>ϵ</mml:mi><mml:mrow><mml:msub><mml:mi>o</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:mi>v</mml:mi></mml:mrow></mml:msub><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mi>ϵ</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:mi>v</mml:mi></mml:mrow></mml:msub></mml:msup></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd/><mml:mtd columnalign="left"><mml:mrow><mml:mo>+</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mo>∑</mml:mo><mml:mrow><mml:mi>g</mml:mi><mml:mo>∈</mml:mo><mml:msub><mml:mi>D</mml:mi><mml:mi>v</mml:mi></mml:msub><mml:mo>:</mml:mo><mml:msub><mml:mi>B</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:mi>g</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:msub><mml:mi>α</mml:mi><mml:mi>g</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mo>∑</mml:mo><mml:mrow><mml:mi>g</mml:mi><mml:mo>∈</mml:mo><mml:msub><mml:mi>D</mml:mi><mml:mi>v</mml:mi></mml:msub></mml:mrow></mml:msub><mml:msub><mml:mi>α</mml:mi><mml:mi>g</mml:mi></mml:msub></mml:mrow></mml:mfrac><mml:mi>δ</mml:mi><mml:msup><mml:mi>ϵ</mml:mi><mml:msub><mml:mi>o</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:mi>v</mml:mi></mml:mrow></mml:msub></mml:msup><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mi>ϵ</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:mi>v</mml:mi></mml:mrow></mml:msub><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives><label>(4)</label></disp-formula>
<disp-formula id="pcbi.1010732.e012"><alternatives><graphic xlink:href="pcbi.1010732.e012.jpg" id="pcbi.1010732.e012g" position="anchor"/><mml:math id="M12" display="block" overflow="scroll"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:msub><mml:mo>Γ</mml:mo><mml:mrow><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:mi>v</mml:mi></mml:mrow></mml:msub></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>≜</mml:mo><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi>B</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>D</mml:mi><mml:mi>v</mml:mi></mml:msub></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:mi>v</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:munder><mml:mo>∑</mml:mo><mml:msubsup><mml:mi>B</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>D</mml:mi><mml:mi>v</mml:mi></mml:msub></mml:mrow><mml:mo>*</mml:mo></mml:msubsup></mml:munder><mml:mspace width="2pt"/><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msubsup><mml:mi>B</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>D</mml:mi><mml:mi>v</mml:mi></mml:msub></mml:mrow><mml:mo>*</mml:mo></mml:msubsup><mml:mo>|</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:mi>v</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mo>)</mml:mo></mml:mrow><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi>B</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>D</mml:mi><mml:mi>v</mml:mi></mml:msub></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:msubsup><mml:mi>B</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>D</mml:mi><mml:mi>v</mml:mi></mml:msub></mml:mrow><mml:mo>*</mml:mo></mml:msubsup><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd/><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo><mml:msup><mml:mi>ϵ</mml:mi><mml:msub><mml:mi>o</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:mi>v</mml:mi></mml:mrow></mml:msub></mml:msup><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mi>ϵ</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:mi>v</mml:mi></mml:mrow></mml:msub></mml:msup><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives><label>(5)</label></disp-formula>
where <italic toggle="yes">o</italic><sub><italic toggle="yes">m</italic>,<italic toggle="yes">v</italic></sub> and <italic toggle="yes">z</italic><sub><italic toggle="yes">m</italic>,<italic toggle="yes">v</italic></sub> are the number of ones and zeros observed in <inline-formula id="pcbi.1010732.e013"><alternatives><graphic xlink:href="pcbi.1010732.e013.jpg" id="pcbi.1010732.e013g" position="anchor"/><mml:math id="M13" display="inline" overflow="scroll"><mml:msub><mml:mi>B</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>D</mml:mi><mml:mi>v</mml:mi></mml:msub></mml:mrow></mml:msub></mml:math></alternatives></inline-formula>, and <italic toggle="yes">α</italic><sub><italic toggle="yes">g</italic></sub> is the mutation rate of <italic toggle="yes">g</italic>. The key part of our algorithm is to calculate the likelihood of <inline-formula id="pcbi.1010732.e014"><alternatives><graphic xlink:href="pcbi.1010732.e014.jpg" id="pcbi.1010732.e014g" position="anchor"/><mml:math id="M14" display="inline" overflow="scroll"><mml:msub><mml:mi>B</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:mi>v</mml:mi><mml:mo>↓</mml:mo></mml:mrow></mml:msub></mml:mrow></mml:msub></mml:math></alternatives></inline-formula> given the state <italic toggle="yes">s</italic><sub><italic toggle="yes">m</italic>,<italic toggle="yes">v</italic></sub>. Let <inline-formula id="pcbi.1010732.e015"><alternatives><graphic xlink:href="pcbi.1010732.e015.jpg" id="pcbi.1010732.e015g" position="anchor"/><mml:math id="M15" display="inline" overflow="scroll"><mml:mrow><mml:mi mathvariant="script">C</mml:mi><mml:mo>(</mml:mo><mml:mi>v</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> denote the children set of node <italic toggle="yes">v</italic>. Following a post-order traversal of the tree, we can calculate the likelihoods of type <inline-formula id="pcbi.1010732.e016"><alternatives><graphic xlink:href="pcbi.1010732.e016.jpg" id="pcbi.1010732.e016g" position="anchor"/><mml:math id="M16" display="inline" overflow="scroll"><mml:msub><mml:mi>B</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:mi>v</mml:mi><mml:mo>↓</mml:mo></mml:mrow></mml:msub></mml:mrow></mml:msub></mml:math></alternatives></inline-formula> in each node <italic toggle="yes">v</italic> based on their values in <inline-formula id="pcbi.1010732.e017"><alternatives><graphic xlink:href="pcbi.1010732.e017.jpg" id="pcbi.1010732.e017g" position="anchor"/><mml:math id="M17" display="inline" overflow="scroll"><mml:mrow><mml:mi mathvariant="script">C</mml:mi><mml:mo>(</mml:mo><mml:mi>v</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>. We have:
<disp-formula id="pcbi.1010732.e018"><alternatives><graphic xlink:href="pcbi.1010732.e018.jpg" id="pcbi.1010732.e018g" position="anchor"/><mml:math id="M18" display="block" overflow="scroll"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:msub><mml:mo>Ψ</mml:mo><mml:mrow><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:mi>v</mml:mi></mml:mrow></mml:msub></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>≜</mml:mo><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi>B</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:mi>v</mml:mi><mml:mo>↓</mml:mo></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:mi>v</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi>B</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>D</mml:mi><mml:mi>v</mml:mi></mml:msub></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:mi>v</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>)</mml:mo></mml:mrow><mml:munder><mml:mo>∏</mml:mo><mml:mrow><mml:mi>c</mml:mi><mml:mo>∈</mml:mo><mml:mi mathvariant="script">C</mml:mi><mml:mo>(</mml:mo><mml:mi>v</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:munder><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi>B</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:mi>c</mml:mi><mml:mo>↓</mml:mo></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:mi>v</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd/><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mo>Λ</mml:mo><mml:mrow><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:mi>v</mml:mi></mml:mrow></mml:msub><mml:munder><mml:mo>∏</mml:mo><mml:mrow><mml:mi>c</mml:mi><mml:mo>∈</mml:mo><mml:mi mathvariant="script">C</mml:mi><mml:mo>(</mml:mo><mml:mi>v</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:munder><mml:mo>(</mml:mo><mml:msub><mml:mi>f</mml:mi><mml:mi>c</mml:mi></mml:msub><mml:msub><mml:mo>Ψ</mml:mo><mml:mrow><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:mi>c</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:msub><mml:mi>f</mml:mi><mml:mi>c</mml:mi></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:msub><mml:mo>Ω</mml:mo><mml:mrow><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:mi>c</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives><label>(6)</label></disp-formula>
<disp-formula id="pcbi.1010732.e019"><alternatives><graphic xlink:href="pcbi.1010732.e019.jpg" id="pcbi.1010732.e019g" position="anchor"/><mml:math id="M19" display="block" overflow="scroll"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:msub><mml:mo>Ω</mml:mo><mml:mrow><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:mi>v</mml:mi></mml:mrow></mml:msub></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>≜</mml:mo><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi>B</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:mi>v</mml:mi><mml:mo>↓</mml:mo></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:mi>v</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi>B</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>D</mml:mi><mml:mi>v</mml:mi></mml:msub></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:mi>v</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mo>)</mml:mo></mml:mrow><mml:munder><mml:mo>∏</mml:mo><mml:mrow><mml:mi>c</mml:mi><mml:mo>∈</mml:mo><mml:mi mathvariant="script">C</mml:mi><mml:mo>(</mml:mo><mml:mi>v</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:munder><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi>B</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:mi>c</mml:mi><mml:mo>↓</mml:mo></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:mi>v</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd/><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mo>Γ</mml:mo><mml:mrow><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:mi>v</mml:mi></mml:mrow></mml:msub><mml:munder><mml:mo>∏</mml:mo><mml:mrow><mml:mi>c</mml:mi><mml:mo>∈</mml:mo><mml:mi mathvariant="script">C</mml:mi><mml:mo>(</mml:mo><mml:mi>v</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:munder><mml:msub><mml:mo>Ω</mml:mo><mml:mrow><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:mi>c</mml:mi></mml:mrow></mml:msub><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives><label>(7)</label></disp-formula>
Finally, denoting the numbers of ones and zeros observed in <italic toggle="yes">B</italic><sub><italic toggle="yes">m</italic>,<italic toggle="yes">P</italic></sub> by <italic toggle="yes">o</italic><sub><italic toggle="yes">m</italic>,<italic toggle="yes">P</italic></sub> and <italic toggle="yes">z</italic><sub><italic toggle="yes">m</italic>,<italic toggle="yes">P</italic></sub>, the likelihood of the <italic toggle="yes">m</italic><sup>th</sup> tumor will be:
<disp-formula id="pcbi.1010732.e020"><alternatives><graphic xlink:href="pcbi.1010732.e020.jpg" id="pcbi.1010732.e020g" position="anchor"/><mml:math id="M20" display="block" overflow="scroll"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi>B</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:mo>:</mml:mo></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:mi>T</mml:mi><mml:mo>,</mml:mo><mml:mi>δ</mml:mi><mml:mo>,</mml:mo><mml:mi>ϵ</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mo>Ψ</mml:mo><mml:mrow><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:mtext>root</mml:mtext></mml:mrow></mml:msub><mml:msup><mml:mi>ϵ</mml:mi><mml:msub><mml:mi>o</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:mi>P</mml:mi></mml:mrow></mml:msub></mml:msup><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mi>ϵ</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:mi>P</mml:mi></mml:mrow></mml:msub></mml:msup><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives><label>(8)</label></disp-formula>
which concludes our dynamic programming procedure.</p>
      <p>We emphasize that only a single post-order traversal of the driver tree is sufficient for calculating the likelihood, as described in this section. As a result, the computational complexity of our likelihood calculation procedure is linear in the number of driver tree nodes. As the number of nodes cannot exceed the number of genes <italic toggle="yes">N</italic>, our computational complexity is linear in the number of genes in the worst-case scenario. As we calculate the likelihood of our <italic toggle="yes">M</italic> tumors separately, we have a likelihood calculation algorithm with a computational complexity of <inline-formula id="pcbi.1010732.e021"><alternatives><graphic xlink:href="pcbi.1010732.e021.jpg" id="pcbi.1010732.e021g" position="anchor"/><mml:math id="M21" display="inline" overflow="scroll"><mml:mrow><mml:mi mathvariant="script">O</mml:mi><mml:mo>(</mml:mo><mml:mi>M</mml:mi><mml:mi>N</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>.</p>
    </sec>
    <sec id="sec006">
      <title>1.4 Inference algorithm</title>
      <p>In this section, we introduce our Markov Chain Monte Carlo algorithm for making inferences using our model. Given a dataset <italic toggle="yes">B</italic>, the objective is to find a maximum a posteriori (MAP) estimate of the model <italic toggle="yes">T</italic> and error parameters <italic toggle="yes">ϵ</italic> and <italic toggle="yes">δ</italic>. In this paper, we restrict ourselves to models <italic toggle="yes">T</italic> = (<italic toggle="yes">V</italic>, <italic toggle="yes">E</italic>, {<italic toggle="yes">f</italic><sub><italic toggle="yes">v</italic></sub>}<sub><italic toggle="yes">v</italic>∈<italic toggle="yes">V</italic></sub>, {<italic toggle="yes">D</italic><sub><italic toggle="yes">v</italic></sub>}<sub><italic toggle="yes">v</italic>∈<italic toggle="yes">V</italic></sub>, <italic toggle="yes">P</italic>) with firing probabilities {<italic toggle="yes">f</italic><sub><italic toggle="yes">v</italic></sub>}<sub><italic toggle="yes">v</italic>∈<italic toggle="yes">V</italic></sub> matching the <italic toggle="yes">empirical estimations</italic>, as explained in the following. Let the topology (<italic toggle="yes">V</italic>, <italic toggle="yes">E</italic>) and the gene assignments ({<italic toggle="yes">D</italic><sub><italic toggle="yes">v</italic></sub>}<sub><italic toggle="yes">v</italic>∈<italic toggle="yes">V</italic></sub> and <italic toggle="yes">P</italic>) be given. To estimate the firing probability of an edge (<italic toggle="yes">u</italic>, <italic toggle="yes">v</italic>), denoted by <italic toggle="yes">f</italic><sub><italic toggle="yes">v</italic></sub>, we denote the number of tumors with mutations in <italic toggle="yes">u</italic> by <inline-formula id="pcbi.1010732.e022"><alternatives><graphic xlink:href="pcbi.1010732.e022.jpg" id="pcbi.1010732.e022g" position="anchor"/><mml:math id="M22" display="inline" overflow="scroll"><mml:msub><mml:mi mathvariant="script">X</mml:mi><mml:mrow><mml:mi>B</mml:mi><mml:mo>,</mml:mo><mml:mi>u</mml:mi></mml:mrow></mml:msub></mml:math></alternatives></inline-formula>. Similarly, we denote the number of tumors with mutations in both <italic toggle="yes">v</italic> and its parent <italic toggle="yes">u</italic> by <inline-formula id="pcbi.1010732.e023"><alternatives><graphic xlink:href="pcbi.1010732.e023.jpg" id="pcbi.1010732.e023g" position="anchor"/><mml:math id="M23" display="inline" overflow="scroll"><mml:msub><mml:mi mathvariant="script">Y</mml:mi><mml:mrow><mml:mi>B</mml:mi><mml:mo>,</mml:mo><mml:mi>v</mml:mi></mml:mrow></mml:msub></mml:math></alternatives></inline-formula>. We set
<disp-formula id="pcbi.1010732.e024"><alternatives><graphic xlink:href="pcbi.1010732.e024.jpg" id="pcbi.1010732.e024g" position="anchor"/><mml:math id="M24" display="block" overflow="scroll"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>f</mml:mi><mml:mi>v</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mspace width="2pt"/><mml:mtext>max</mml:mtext><mml:mspace width="2pt"/><mml:mo>{</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi mathvariant="script">Y</mml:mi><mml:mrow><mml:mi>B</mml:mi><mml:mo>,</mml:mo><mml:mi>v</mml:mi></mml:mrow></mml:msub><mml:mo>-</mml:mo><mml:mi>ϵ</mml:mi><mml:msub><mml:mi mathvariant="script">X</mml:mi><mml:mrow><mml:mi>B</mml:mi><mml:mo>,</mml:mo><mml:mi>u</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mi>ϵ</mml:mi><mml:mo>-</mml:mo><mml:mi>δ</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:msub><mml:mi mathvariant="script">X</mml:mi><mml:mrow><mml:mi>B</mml:mi><mml:mo>,</mml:mo><mml:mi>u</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:mo>,</mml:mo><mml:mn>0</mml:mn><mml:mo>}</mml:mo><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives><label>(9)</label></disp-formula>
which corresponds to a maximum likelihood estimate of the firing probability value. Note that in case of small <italic toggle="yes">ϵ</italic> and <italic toggle="yes">δ</italic>, we have <inline-formula id="pcbi.1010732.e025"><alternatives><graphic xlink:href="pcbi.1010732.e025.jpg" id="pcbi.1010732.e025g" position="anchor"/><mml:math id="M25" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mi>f</mml:mi><mml:mi>v</mml:mi></mml:msub><mml:mo>≈</mml:mo><mml:msub><mml:mi mathvariant="script">Y</mml:mi><mml:mrow><mml:mi>B</mml:mi><mml:mo>,</mml:mo><mml:mi>v</mml:mi></mml:mrow></mml:msub><mml:mo>/</mml:mo><mml:msub><mml:mi mathvariant="script">X</mml:mi><mml:mrow><mml:mi>B</mml:mi><mml:mo>,</mml:mo><mml:mi>u</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></alternatives></inline-formula>. The derivations for this formula can be found in Section 1.4 in <xref rid="pcbi.1010732.s001" ref-type="supplementary-material">S1 Text</xref>.</p>
      <p>To have a computationally efficient inference algorithm, we further restrict ourselves to error parameters <italic toggle="yes">ϵ</italic> and <italic toggle="yes">δ</italic> tuned to the model <italic toggle="yes">T</italic>. To this end, we use a dynamic programming procedure to calculate the minimum number of false positive and false negative events in the data, given a fixed progression structure. In this way, we can calculate an <italic toggle="yes">empirical estimation</italic> of the parameters <italic toggle="yes">ϵ</italic> and <italic toggle="yes">δ</italic> with a single post-order traversal of the driver tree. Our empirical error estimation algorithm is described in detail in Section 1.1 in <xref rid="pcbi.1010732.s001" ref-type="supplementary-material">S1 Text</xref>.</p>
      <p>Following a Bayesian inference framework, we use a prior of the form
<disp-formula id="pcbi.1010732.e026"><alternatives><graphic xlink:href="pcbi.1010732.e026.jpg" id="pcbi.1010732.e026g" position="anchor"/><mml:math id="M26" display="block" overflow="scroll"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>T</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mrow><mml:mo>|</mml:mo></mml:mrow><mml:msub><mml:mi mathvariant="script">S</mml:mi><mml:msup><mml:mi>B</mml:mi><mml:mo>*</mml:mo></mml:msup></mml:msub><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>T</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>|</mml:mo></mml:mrow></mml:mrow></mml:mfrac><mml:mo>)</mml:mo></mml:mrow><mml:mi>ζ</mml:mi></mml:msup><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives><label>(10)</label></disp-formula>
where <inline-formula id="pcbi.1010732.e027"><alternatives><graphic xlink:href="pcbi.1010732.e027.jpg" id="pcbi.1010732.e027g" position="anchor"/><mml:math id="M27" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mi mathvariant="script">S</mml:mi><mml:msup><mml:mi>B</mml:mi><mml:mo>*</mml:mo></mml:msup></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>T</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> is the set of possible <italic toggle="yes">noise-free</italic> tumor vectors, i.e., <inline-formula id="pcbi.1010732.e028"><alternatives><graphic xlink:href="pcbi.1010732.e028.jpg" id="pcbi.1010732.e028g" position="anchor"/><mml:math id="M28" display="inline" overflow="scroll"><mml:msubsup><mml:mi>B</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:mo>:</mml:mo></mml:mrow><mml:mo>*</mml:mo></mml:msubsup></mml:math></alternatives></inline-formula>, which can be constructed using <italic toggle="yes">T</italic>, and <inline-formula id="pcbi.1010732.e029"><alternatives><graphic xlink:href="pcbi.1010732.e029.jpg" id="pcbi.1010732.e029g" position="anchor"/><mml:math id="M29" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:mo>|</mml:mo></mml:mrow><mml:msub><mml:mi mathvariant="script">S</mml:mi><mml:msup><mml:mi>B</mml:mi><mml:mo>*</mml:mo></mml:msup></mml:msub><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>T</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>|</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> is the cardinality of this set. The parameter <italic toggle="yes">ζ</italic> can adjust our penalty for higher <inline-formula id="pcbi.1010732.e030"><alternatives><graphic xlink:href="pcbi.1010732.e030.jpg" id="pcbi.1010732.e030g" position="anchor"/><mml:math id="M30" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:mo>|</mml:mo></mml:mrow><mml:msub><mml:mi mathvariant="script">S</mml:mi><mml:msup><mml:mi>B</mml:mi><mml:mo>*</mml:mo></mml:msup></mml:msub><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>T</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>|</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> values. We have used <italic toggle="yes">ζ</italic> = 5 as a default parameter in all the synthetic and biological data analyses presented in the paper.</p>
      <p>We initialize our MCMC sampler to a star tree, where each gene has its own node in the first layer of the driver tree. We call such single-gene nodes in the first layer of the driver tree as <italic toggle="yes">simple nodes</italic>. Following a Metropolis-Hasting framework, we use a set of possible structural moves to propose new candidate trees. The proposed trees may then get accepted based on their Metropolis-Hasting acceptance ratio. To explore the space of progression models in an efficient way, we have designed several types of structural moves, including various topological moves, as well as gene assignment modifications. <xref rid="pcbi.1010732.g003" ref-type="fig">Fig 3</xref> shows a few example moves. Our structural moves include:</p>
      <list list-type="bullet">
        <list-item>
          <p>“Vertical merge”, merging a leaf node into its parent (<xref rid="pcbi.1010732.g003" ref-type="fig">Fig 3B</xref>), and its reverse move called “vertical split”,</p>
        </list-item>
        <list-item>
          <p>“Horizontal merge”, merging two sibling leaves (<xref rid="pcbi.1010732.g003" ref-type="fig">Fig 3C</xref>), and its reverse move called “horizontal split”,</p>
        </list-item>
        <list-item>
          <p>“Attach from passengers”, attaching a new node containing a subset of the passenger genes to the driver tree (<xref rid="pcbi.1010732.g003" ref-type="fig">Fig 3D</xref>), and its reverse move called “detach into passengers”,</p>
        </list-item>
        <list-item>
          <p>“Attach from simple nodes”, attaching a new node containing the genes from a subset of the simple nodes to the driver tree (<xref rid="pcbi.1010732.g003" ref-type="fig">Fig 3E</xref>), and its reverse move called “detach into simple nodes”,</p>
        </list-item>
        <list-item>
          <p>“P2D gene move”, moving a single gene from the set of passengers to an existing node in the driver tree (<xref rid="pcbi.1010732.g003" ref-type="fig">Fig 3F</xref>), and its reverse move called “D2P gene move”,</p>
        </list-item>
        <list-item>
          <p>“S2D gene move”, moving the gene in a simple node into an existing node of the driver tree (<xref rid="pcbi.1010732.g003" ref-type="fig">Fig 3G</xref>), and its reverse move called “D2S gene move”,</p>
        </list-item>
        <list-item>
          <p>“Gene swap”, swapping the genes between a node and its parent (<xref rid="pcbi.1010732.g003" ref-type="fig">Fig 3H</xref>),</p>
        </list-item>
        <list-item>
          <p>“SPR”, subtree pruning and regrafting to modify the driver tree structure (<xref rid="pcbi.1010732.g003" ref-type="fig">Fig 3I</xref>).</p>
        </list-item>
      </list>
      <fig position="float" id="pcbi.1010732.g003">
        <object-id pub-id-type="doi">10.1371/journal.pcbi.1010732.g003</object-id>
        <label>Fig 3</label>
        <caption>
          <title>Different types of structural moves used in our MCMC inference algorithm.</title>
        </caption>
        <graphic xlink:href="pcbi.1010732.g003" position="float"/>
      </fig>
      <p>After generating a set of samples, we select the sample with the maximum posterior. We fine-tune the error parameters <italic toggle="yes">ϵ</italic> and <italic toggle="yes">δ</italic> using gradient descent with a few iterations over the selected driver tree. A pseudo-code of the inference algorithm, together with detailed explanations of the components of our algorithm, are included in Section 1 in <xref rid="pcbi.1010732.s001" ref-type="supplementary-material">S1 Text</xref>. We emphasize that as the individual components within each of our MCMC iterations have linear computational complexities in the size of the dataset, we have an inference algorithm with linear per-iteration computational complexity.</p>
    </sec>
  </sec>
  <sec sec-type="results" id="sec007">
    <title>2 Results</title>
    <sec id="sec008">
      <title>2.1 Synthetic data experiments</title>
      <p>In this section, we use synthetic data simulations to demonstrate the efficiency of our inference algorithm in three example scenarios with generative progression models shown in <xref rid="pcbi.1010732.g004" ref-type="fig">Fig 4</xref>. The linear model shown in <xref rid="pcbi.1010732.g004" ref-type="fig">Fig 4A</xref> is an example of models called <italic toggle="yes">Pathway Linear Progression Models</italic> studied in [<xref rid="pcbi.1010732.ref019" ref-type="bibr">19</xref>] and [<xref rid="pcbi.1010732.ref020" ref-type="bibr">20</xref>], where the progression follows a linear evolutionary path over so-called driver pathways. The single-seeded tree model shown in <xref rid="pcbi.1010732.g004" ref-type="fig">Fig 4B</xref> represents the scenarios where the cancer is always initiated from a single critical driver pathway but can progress along different trajectories in a tree-like structure. The multi-seeded tree model shown in <xref rid="pcbi.1010732.g004" ref-type="fig">Fig 4C</xref> represents a further generalization, where different driver pathways can independently initiate and drive the cancer progression.</p>
      <fig position="float" id="pcbi.1010732.g004">
        <object-id pub-id-type="doi">10.1371/journal.pcbi.1010732.g004</object-id>
        <label>Fig 4</label>
        <caption>
          <p>Generative progression model for the synthetic data experiments with <bold>A</bold>. linear model <bold>B</bold>. single-seeded tree model <bold>C</bold>. multi-seeded tree model.</p>
        </caption>
        <graphic xlink:href="pcbi.1010732.g004" position="float"/>
      </fig>
      <p>For each generative progression model, we explored 16 settings, with equal false positive and false negative probabilities in {0.001, 0.01, 0.05, 0.1} and the number of tumors in {50, 100, 200, 500}. We sampled 10 datasets for each setting using the generative process explained in section 1.2. We have used our inference algorithm with 100<italic toggle="yes">k</italic> iterations throughout our synthetic data experiments.</p>
      <sec id="sec009">
        <title>Evaluation metrics for synthetic data analysis</title>
        <p>We can compare our results against the known generative progression models to evaluate our performance during the synthetic data experiments. To this end, we focus on the sets of mutual exclusivity and progression relations implied by the models. If two genes <italic toggle="yes">g</italic><sub>1</sub> and <italic toggle="yes">g</italic><sub>2</sub> are placed together in a common node of a model <italic toggle="yes">T</italic>, we say the pair (<italic toggle="yes">g</italic><sub>1</sub>, <italic toggle="yes">g</italic><sub>2</sub>) is in the set of mutual exclusivity relations implied by <italic toggle="yes">T</italic>. Similarly, if the node including <italic toggle="yes">g</italic><sub>1</sub> is an ancestor of the node including <italic toggle="yes">g</italic><sub>2</sub>, we say (<italic toggle="yes">g</italic><sub>1</sub>, <italic toggle="yes">g</italic><sub>2</sub>) is in the set of progression relations implied by <italic toggle="yes">T</italic>. We calculate our precision and recall in recovering these two sets of relations and calculate two F-scores. Let <italic toggle="yes">F</italic><sub>ME</sub> be our F-score for identifying the mutual exclusivity relations. Similarly, let <italic toggle="yes">F</italic><sub>PR</sub> be our F-score for identifying the progression relations. We define our overall score, denoted by <italic toggle="yes">F</italic><sub>overall</sub>, as the harmonic mean of <italic toggle="yes">F</italic><sub>ME</sub> and <italic toggle="yes">F</italic><sub>PR</sub>, i.e.,
<disp-formula id="pcbi.1010732.e031"><alternatives><graphic xlink:href="pcbi.1010732.e031.jpg" id="pcbi.1010732.e031g" position="anchor"/><mml:math id="M31" display="block" overflow="scroll"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>F</mml:mi><mml:mtext>overall</mml:mtext></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mn>2</mml:mn><mml:mo>*</mml:mo><mml:msub><mml:mi>F</mml:mi><mml:mtext>ME</mml:mtext></mml:msub><mml:mo>*</mml:mo><mml:msub><mml:mi>F</mml:mi><mml:mtext>PR</mml:mtext></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mi>F</mml:mi><mml:mtext>ME</mml:mtext></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>F</mml:mi><mml:mtext>PR</mml:mtext></mml:msub></mml:mrow></mml:mfrac><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives><label>(11)</label></disp-formula>
Note that <italic toggle="yes">F</italic><sub>overall</sub> ∈ [0, 1] and <italic toggle="yes">F</italic><sub>overall</sub> = 1 implies perfect identification of the generative model, while the star tree (which is our initial state) has <italic toggle="yes">F</italic><sub>overall</sub> = 0, as its recall is zero for both mutual exclusivity and progression relations.</p>
      </sec>
      <sec id="sec010">
        <title>Performance on synthetic data</title>
        <p><xref rid="pcbi.1010732.g005" ref-type="fig">Fig 5</xref> shows the F-scores achieved by our inference algorithm (averaged over our 10 datasets for each case). As shown in this figure, our inference algorithm finds the exact generative model, or a very similar one, for all the cases with error probabilities up to 0.05 and at least 100 tumors in the dataset. The figure shows that the performance improves with increments in the number of tumors and reductions in noise. These analyses also show our method’s limitations in dealing with datasets having an error probability of 0.1. We have provided an extensive supplementary analysis of the synthetic experiments in Section 2 in <xref rid="pcbi.1010732.s001" ref-type="supplementary-material">S1 Text</xref>. Our analyses suggest two plausible explanations for our poor <italic toggle="yes">F</italic><sub>overall</sub> scores in the cases with <italic toggle="yes">ϵ</italic> = <italic toggle="yes">δ</italic> = 0.1. Firstly, when the error rate is this high, the star tree (our MCMC initial state) provides a competitive posterior against the generative model. As a result, it’s much harder to improve the posterior with small modifications, leading to the chains getting stuck close to the initial state. We also observe that the <italic toggle="yes">F</italic><sub>overall</sub> score is a very fragile metric that can easily drop with the slightest errors in the recovered progression model.</p>
        <fig position="float" id="pcbi.1010732.g005">
          <object-id pub-id-type="doi">10.1371/journal.pcbi.1010732.g005</object-id>
          <label>Fig 5</label>
          <caption>
            <p>The averaged <italic toggle="yes">F</italic><sub>overall</sub> scores achieved in the synthetic data experiments in the case of <bold>A</bold>. linear model <bold>B</bold>. single-seeded tree model <bold>C</bold>. multi-seeded tree model.</p>
          </caption>
          <graphic xlink:href="pcbi.1010732.g005" position="float"/>
        </fig>
        <p>Further details on our evaluation metrics, the individual precision and recall values, the performance in terms of likelihoods, and the inferred error values are provided in Section 2 in <xref rid="pcbi.1010732.s001" ref-type="supplementary-material">S1 Text</xref>. We have also included our performance measured by two distance metrics designed for phylogenetic trees (DISC and CASET), introduced in [<xref rid="pcbi.1010732.ref024" ref-type="bibr">24</xref>]. This section in the supplementary document also includes information on the run-times of our synthetic data experiments, reaffirming that our computational complexity barely depends on the noise level or the driver tree structure and increases linearly with the size of the dataset.</p>
      </sec>
    </sec>
    <sec id="sec011">
      <title>2.2 Biological data analysis</title>
      <p>In this section, we present our experiments on several biological datasets. We start this section by explaining our metrics to assess the results. We then compare our method ToMExO against two state-of-the-art methods, pathTiMEx [<xref rid="pcbi.1010732.ref002" ref-type="bibr">2</xref>] and MHN [<xref rid="pcbi.1010732.ref023" ref-type="bibr">23</xref>] on a moderate-size glioblastoma dataset. Finally, we present our analysis on larger biological datasets, which are not practical to study using pathTiMEx or MHN.</p>
      <sec id="sec012">
        <title>Evaluation metrics for biological data analysis</title>
        <p>To have a method-independent metric to assess the progression models, we use probabilistic causation tests introduced in [<xref rid="pcbi.1010732.ref008" ref-type="bibr">8</xref>] as explained in the following:</p>
        <list list-type="bullet">
          <list-item>
            <p><bold>Progression scores</bold>: if node <italic toggle="yes">u</italic> is a parent of node <italic toggle="yes">v</italic>, mutation in <italic toggle="yes">u</italic> should increase the chance of mutation in <italic toggle="yes">v</italic>. We define our progression score as
<disp-formula id="pcbi.1010732.e032"><alternatives><graphic xlink:href="pcbi.1010732.e032.jpg" id="pcbi.1010732.e032g" position="anchor"/><mml:math id="M32" display="block" overflow="scroll"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mo>λ</mml:mo><mml:mtext>PR</mml:mtext></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>u</mml:mi><mml:mo>,</mml:mo><mml:mi>v</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>v</mml:mi><mml:mo>|</mml:mo><mml:mi>u</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>-</mml:mo><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>v</mml:mi><mml:mo>|</mml:mo><mml:mover accent="true"><mml:mi>u</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>v</mml:mi><mml:mo>|</mml:mo><mml:mi>u</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>v</mml:mi><mml:mo>|</mml:mo><mml:mover accent="true"><mml:mi>u</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mfrac><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives><label>(12)</label></disp-formula>
where <italic toggle="yes">p</italic>(<italic toggle="yes">v</italic>|<italic toggle="yes">u</italic>) and <inline-formula id="pcbi.1010732.e033"><alternatives><graphic xlink:href="pcbi.1010732.e033.jpg" id="pcbi.1010732.e033g" position="anchor"/><mml:math id="M33" display="inline" overflow="scroll"><mml:mrow><mml:mi>p</mml:mi><mml:mo>(</mml:mo><mml:mi>v</mml:mi><mml:mo>|</mml:mo><mml:mover accent="true"><mml:mi>u</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> are the rates of observing a mutation in <italic toggle="yes">v</italic>, among the tumors with and without mutation in <italic toggle="yes">u</italic>, respectively. Note that if a mutation in <italic toggle="yes">u</italic> increases the chance of mutation in <italic toggle="yes">v</italic>, then a mutation in <italic toggle="yes">v</italic> also increases the chance of mutation in <italic toggle="yes">u</italic>. The progression score defined in <xref rid="pcbi.1010732.e032" ref-type="disp-formula">Eq (12)</xref> can be used to find the causation direction for such a relationship between <italic toggle="yes">u</italic> and <italic toggle="yes">v</italic> [<xref rid="pcbi.1010732.ref008" ref-type="bibr">8</xref>]. We have λ<sub>PR</sub>(<italic toggle="yes">u</italic>, <italic toggle="yes">v</italic>) ∈ [−1, 1] and in the case of λ<sub>PR</sub>(<italic toggle="yes">u</italic>, <italic toggle="yes">v</italic>) &gt; 0, a mutation in <italic toggle="yes">u</italic> or <italic toggle="yes">v</italic> increase the chance of mutation in the other one. As discussed in [<xref rid="pcbi.1010732.ref008" ref-type="bibr">8</xref>], the amplitude of λ<sub>PR</sub> shows the strength of the relationship and when λ<sub>PR</sub>(<italic toggle="yes">u</italic>, <italic toggle="yes">v</italic>) &gt; λ<sub>PR</sub>(<italic toggle="yes">v</italic>, <italic toggle="yes">u</italic>), it’s more plausible to say <italic toggle="yes">u</italic> is the cause of <italic toggle="yes">v</italic> than the other way around.</p>
          </list-item>
          <list-item>
            <p><bold>Mutual exclusivity scores</bold>: Following the same idea as the progression score, if two genes <italic toggle="yes">g</italic><sub>1</sub> and <italic toggle="yes">g</italic><sub>2</sub> are mutually exclusive, they should reduce each other’s chance of mutation. We define the mutual exclusivity score of a pair of genes (<italic toggle="yes">g</italic>, <italic toggle="yes">w</italic>) as the average strength of the mutual exclusivity signal in both directions:
<disp-formula id="pcbi.1010732.e034"><alternatives><graphic xlink:href="pcbi.1010732.e034.jpg" id="pcbi.1010732.e034g" position="anchor"/><mml:math id="M34" display="block" overflow="scroll"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mo>λ</mml:mo><mml:mtext>ME</mml:mtext></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>g</mml:mi><mml:mo>,</mml:mo><mml:mi>w</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mo>.</mml:mo><mml:mn>5</mml:mn><mml:mo>*</mml:mo><mml:mo>(</mml:mo><mml:mfrac><mml:mrow><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>g</mml:mi><mml:mo>|</mml:mo><mml:mover accent="true"><mml:mi>w</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mo>)</mml:mo></mml:mrow><mml:mo>-</mml:mo><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>g</mml:mi><mml:mo>|</mml:mo><mml:mi>w</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>g</mml:mi><mml:mo>|</mml:mo><mml:mover accent="true"><mml:mi>w</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>g</mml:mi><mml:mo>|</mml:mo><mml:mi>w</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mfrac><mml:mo>+</mml:mo><mml:mfrac><mml:mrow><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>w</mml:mi><mml:mo>|</mml:mo><mml:mover accent="true"><mml:mi>g</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mo>)</mml:mo></mml:mrow><mml:mo>-</mml:mo><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>w</mml:mi><mml:mo>|</mml:mo><mml:mi>g</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>w</mml:mi><mml:mo>|</mml:mo><mml:mover accent="true"><mml:mi>g</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>w</mml:mi><mml:mo>|</mml:mo><mml:mi>g</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mfrac><mml:mo>)</mml:mo><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives><label>(13)</label></disp-formula>
We define the score of a node <italic toggle="yes">u</italic> (including mutually exclusive genes) as the average λ<sub>ME</sub> among the pairs of genes in <italic toggle="yes">u</italic> and denote it by λ<sub>ME</sub>(<italic toggle="yes">u</italic>). Note that λ<sub>ME</sub>(<italic toggle="yes">u</italic>) ∈ [−1, 1] and if λ<sub>ME</sub>(<italic toggle="yes">u</italic>) &gt; 0, the genes in <italic toggle="yes">u</italic> have some levels of mutual exclusivity, depending on how high λ<sub>ME</sub>(<italic toggle="yes">u</italic>) is.</p>
          </list-item>
        </list>
        <p>In the following, we define p-values for the progression and mutual exclusivity signals to check how likely it is that the observed patterns have happened by chance. Starting from the progression patterns, let (<italic toggle="yes">u</italic>, <italic toggle="yes">v</italic>) be an edge with positive λ<sub>PR</sub>, where λ<sub>PR</sub>(<italic toggle="yes">u</italic>, <italic toggle="yes">v</italic>) &gt; λ<sub>PR</sub>(<italic toggle="yes">v</italic>, <italic toggle="yes">u</italic>). Consider a null hypothesis that says <italic toggle="yes">v</italic> is independent of <italic toggle="yes">u</italic> and gets mutated with a probability equal to <italic toggle="yes">p</italic>(<italic toggle="yes">v</italic>) in each tumor (<italic toggle="yes">p</italic>(<italic toggle="yes">v</italic>) is the empirical mutation rate of <italic toggle="yes">v</italic> across all tumors). Having observed <italic toggle="yes">n</italic><sub><italic toggle="yes">u</italic>,<italic toggle="yes">v</italic></sub> tumors with mutations in both <italic toggle="yes">u</italic> and <italic toggle="yes">v</italic>, we can calculate how likely it is that the null hypothesis generates <italic toggle="yes">n</italic><sub><italic toggle="yes">u</italic>,<italic toggle="yes">v</italic></sub> or more tumors with a mutation in <italic toggle="yes">v</italic>, among the tumors which have a mutation in <italic toggle="yes">u</italic>, i.e.,
<disp-formula id="pcbi.1010732.e035"><alternatives><graphic xlink:href="pcbi.1010732.e035.jpg" id="pcbi.1010732.e035g" position="anchor"/><mml:math id="M35" display="block" overflow="scroll"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mtext>PR</mml:mtext></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>u</mml:mi><mml:mo>,</mml:mo><mml:mi>v</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>≜</mml:mo><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>u</mml:mi><mml:mo>,</mml:mo><mml:mi>v</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mi>u</mml:mi></mml:msub></mml:munderover><mml:mo>(</mml:mo><mml:mfrac linethickness="0pt"><mml:msub><mml:mi>n</mml:mi><mml:mi>u</mml:mi></mml:msub><mml:mi>i</mml:mi></mml:mfrac><mml:mo>)</mml:mo><mml:mi>p</mml:mi><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mi>v</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mi>i</mml:mi></mml:msup><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>v</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mi>u</mml:mi></mml:msub><mml:mo>-</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msup><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives><label>(14)</label></disp-formula></p>
        <p>For the mutual exclusivity relation among a pair of genes, we consider the two directions of the relation separately. Assume that a mutation in gene <italic toggle="yes">g</italic> reduces the chance of mutation in gene <italic toggle="yes">w</italic>. Consider a null hypothesis that <italic toggle="yes">w</italic> gets mutated independently with a probability equal to <italic toggle="yes">p</italic>(<italic toggle="yes">w</italic>). Having <italic toggle="yes">n</italic><sub><italic toggle="yes">g</italic>,<italic toggle="yes">w</italic></sub> tumors with mutations in both <italic toggle="yes">g</italic> and <italic toggle="yes">w</italic>, we can calculate how likely it is that the null hypothesis generates <italic toggle="yes">n</italic><sub><italic toggle="yes">g</italic>,<italic toggle="yes">w</italic></sub> or fewer tumors with a mutation in <italic toggle="yes">w</italic> among the tumors which have a mutation in <italic toggle="yes">g</italic>:
<disp-formula id="pcbi.1010732.e036"><alternatives><graphic xlink:href="pcbi.1010732.e036.jpg" id="pcbi.1010732.e036g" position="anchor"/><mml:math id="M36" display="block" overflow="scroll"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mtext>ME</mml:mtext></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>g</mml:mi><mml:mo>,</mml:mo><mml:mi>w</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>≜</mml:mo><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>g</mml:mi><mml:mo>,</mml:mo><mml:mi>w</mml:mi></mml:mrow></mml:msub></mml:munderover><mml:mo>(</mml:mo><mml:mfrac linethickness="0pt"><mml:msub><mml:mi>n</mml:mi><mml:mi>g</mml:mi></mml:msub><mml:mi>i</mml:mi></mml:mfrac><mml:mo>)</mml:mo><mml:mi>p</mml:mi><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mi>w</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mi>i</mml:mi></mml:msup><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>w</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mi>g</mml:mi></mml:msub><mml:mo>-</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msup><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives><label>(15)</label></disp-formula>
We define the p-value of the mutual exclusivity relation to be the average of the p-values in both directions. We also define the p-value of a mutually exclusive set of genes as the average of the p-values among its pairs of genes.</p>
      </sec>
      <sec id="sec013">
        <title>Comparison against pathTiMEx and MHN</title>
        <p>We used ToMExO to analyze a glioblastoma dataset previously analyzed by pathTiMEx [<xref rid="pcbi.1010732.ref002" ref-type="bibr">2</xref>] and MHN [<xref rid="pcbi.1010732.ref023" ref-type="bibr">23</xref>]. This dataset is originally from The Cancer Genome Atlas (TCGA) [<xref rid="pcbi.1010732.ref025" ref-type="bibr">25</xref>], pre-processed as explained in [<xref rid="pcbi.1010732.ref014" ref-type="bibr">14</xref>]. The dataset includes 261 tumors and 20 events, including point mutations, amplifications, and deletions. We downloaded the pre-processed dataset from the MHN public repository [<xref rid="pcbi.1010732.ref023" ref-type="bibr">23</xref>]. We ran ToMExO with 10 MCMC chains and 100<italic toggle="yes">k</italic> samples and reported the sample with the maximum posterior among all visited samples.</p>
        <p><xref rid="pcbi.1010732.g006" ref-type="fig">Fig 6A</xref> shows the Mutual Hazard Network (MHN) produced by the MHN method. In the MHN model, each event has a base rate of occurrence (shown in the diagonal). Some events have specific multiplicative effects on a set of other events. Such effects can be inhibition, with a factor smaller than one, or promotion, otherwise. In the MHN matrix shown in <xref rid="pcbi.1010732.g006" ref-type="fig">Fig 6A</xref>, the number shown in row <italic toggle="yes">r</italic> and column <italic toggle="yes">c</italic> shows the effect of event <italic toggle="yes">c</italic> on event <italic toggle="yes">r</italic>. The interrelations coded by the MHN can be shown using a graph. <xref rid="pcbi.1010732.g006" ref-type="fig">Fig 6B</xref> shows the graph corresponding to the MHN in <xref rid="pcbi.1010732.g006" ref-type="fig">Fig 6A</xref>. In this graph, the normal arrowheads represent the promoting effects (multiplicative factors higher than one), and the inverted arrowheads represent the inhibiting effects (factors less than one). We evaluated the MHN edges by the progression score discussed above. The one-directional edges that are reported in a wrong direction are colored in red (see <xref rid="pcbi.1010732.g006" ref-type="fig">Fig 6B</xref>). The figure shows that 4 edges (out of 16 one-directional edges) are reported in the reverse direction. We emphasize that the edges colored in red are not invalid. For instance, observing the event MDM2(A) does increase the chance of observing CDK4(A) (see the positive progression score). However, if we were to report a single direction for this relationship, it is more plausible to say CDK4(A) promotes MDM2(A) than the other way around.</p>
        <fig position="float" id="pcbi.1010732.g006">
          <object-id pub-id-type="doi">10.1371/journal.pcbi.1010732.g006</object-id>
          <label>Fig 6</label>
          <caption>
            <title>MHN result for the pathTiMEx Glioblastoma dataset.</title>
            <p><bold>A</bold>. The matrix of base rates and multiplicative factors. <bold>B</bold>. The corresponding graph. Note that the disconnected nodes are not plotted.</p>
          </caption>
          <graphic xlink:href="pcbi.1010732.g006" position="float"/>
        </fig>
        <p><xref rid="pcbi.1010732.g007" ref-type="fig">Fig 7</xref> shows the results of analyzing the same dataset using pathTiMEx and ToMExO. The nodes’ mutual exclusivity scores and the edges’ progression scores are shown in blue. The p-value of the mutual exclusivity and progression scores are shown in green below the corresponding scores. Comparing the mutually exclusive sets reported by ToMExO and pathTiMEx, we can see that ToMExO sets have significantly higher mutual exclusivity scores and better p-values on average. As shown in <xref rid="pcbi.1010732.g007" ref-type="fig">Fig 7A</xref>, one of the edges reported by pathTiMEx (colored in red) has a negative progression score. This means that a parent mutation actually decreases the child’s chance of mutation. The other edges reported by pathTiMEx are valid (the parent promotes the child) and in the correct direction. Unlike our model, the model used in pathTiMEx allows for more than one parent for each node. The pathTiMEx model implies that all the parents of a node have to get mutated before the node gets a mutation. As shown in the figure, one of the nodes in the pathTiMEx result has three parents. We checked the progression relation between the parents’ product (logical AND) and this multi-parent node. Interestingly, the resulting progression score is 0.27 from the parents to the child, but 0.32 in the reverse direction, which suggests that the child node is the cause of the parents. We refer to [<xref rid="pcbi.1010732.ref026" ref-type="bibr">26</xref>] for a comprehensive discussion on these kinds of hypothesis testings on causation relations. Our method, ToMExO, only reports one progression relation, which is very strong (λ<sub><italic toggle="yes">PR</italic></sub> = 0.93), in the correct direction, with a pretty significant p-value. Note that the same relation, but in the opposite direction, was reported by the MHN.</p>
        <fig position="float" id="pcbi.1010732.g007">
          <object-id pub-id-type="doi">10.1371/journal.pcbi.1010732.g007</object-id>
          <label>Fig 7</label>
          <caption>
            <p><bold>A</bold>. PathTiMEx result for the pathTiMEx Glioblastoma dataset. <bold>B</bold>. ToMExO result for the pathTiMEx Glioblastoma dataset.</p>
          </caption>
          <graphic xlink:href="pcbi.1010732.g007" position="float"/>
        </fig>
      </sec>
      <sec id="sec014">
        <title>Analysis of somatic mutations in TCGA datasets</title>
        <p>In the following, we present a selection of our analysis on a set of larger TCGA datasets, which are impossible to investigate by MHN or pathTiMEx due to the large numbers of genes (mutation events) in the data. We downloaded mutation-called TCGA data from the GDAC firehose and limited our focus to the somatic mutations in the cancer-type specific lists of driver genes suggested by IntOGen [<xref rid="pcbi.1010732.ref027" ref-type="bibr">27</xref>]. Note that the IntOGen pipeline selects the list of driver genes considering a broad set of features, including the rate of mutations, linear and 3D clustering of mutations in individual genes, trinucleotide-specific biases, and functional impacts of individual mutations.</p>
        <p>To construct our binary input matrix, we consider a tumor mutated in a gene if it has at least one non-silent mutation. Similar to the previous section, we ran ToMExO with 10 MCMC chains and 100<italic toggle="yes">k</italic> samples and reported the maximum a posteriori sample in all the following analyses. We analyzed all the 30 cancer types available in GDAC firehose. <xref rid="pcbi.1010732.g008" ref-type="fig">Fig 8</xref> shows the computation time for all of our datasets in this part. As shown in this figure, our computational complexity is linear in the size of the dataset, as expected. In the following, we present a selection of our results, while the rest are available in our GitHub repository.</p>
        <fig position="float" id="pcbi.1010732.g008">
          <object-id pub-id-type="doi">10.1371/journal.pcbi.1010732.g008</object-id>
          <label>Fig 8</label>
          <caption>
            <title>The per-iteration computational complexity of ToMExO with respect to the dataset size (number of tumors × number of events).</title>
          </caption>
          <graphic xlink:href="pcbi.1010732.g008" position="float"/>
        </fig>
      </sec>
      <sec id="sec015">
        <title>Glioblastoma multiforme (GBM)</title>
        <p>Our GBM dataset includes 290 tumors and 26 genes. The resulting progression model is shown in <xref rid="pcbi.1010732.g009" ref-type="fig">Fig 9</xref>. Our inferred values for false positive and false negative probabilities are 0.016 and 0.040, respectively. The posterior ratio of the resulting model to the star tree is 3.49 * 10<sup>37</sup>, corresponding to a per-tumor ratio of 1.347. The GBM dataset with more than 7.5 thousand bits can fully conform with our progression model, assuming only 17 false positives and 77 false negatives.</p>
        <fig position="float" id="pcbi.1010732.g009">
          <object-id pub-id-type="doi">10.1371/journal.pcbi.1010732.g009</object-id>
          <label>Fig 9</label>
          <caption>
            <title>Inferred progression model for Glioblastoma multiforme (GBM).</title>
            <p>The figure shows the mutual exclusivity score of the nodes (with at least two genes) and the progression score of the edges in blue. Below each score, we show the p-value for the corresponding signal in green. The darker node beside the driver tree represents the set of passenger genes.</p>
          </caption>
          <graphic xlink:href="pcbi.1010732.g009" position="float"/>
        </fig>
        <p>As shown in <xref rid="pcbi.1010732.g009" ref-type="fig">Fig 9</xref>, our progression model for glioblastoma has PTEN and PIK3CA together in the first layer of the driver tree. These two genes are known to play essential roles in the so-called PTEN–PI3K axis [<xref rid="pcbi.1010732.ref028" ref-type="bibr">28</xref>] balancing the cell growth. As a mutation in either of these genes can break the balance, it seems plausible that they exhaust each other’s selective advantage, leading to the observed mutual exclusivity pattern between them. Interestingly, the discussions in [<xref rid="pcbi.1010732.ref028" ref-type="bibr">28</xref>] suggest different treatment approaches for tumors with mutations in PTEN or PIK3CA. Mutations in STAG2 are known to be selected during tumorigenesis [<xref rid="pcbi.1010732.ref029" ref-type="bibr">29</xref>]. We identified a significant over-representation of STAG2 mutations among the tumors with mutated PTEN. This relation is encoded by the edge from PTEN/PIK3CA to STAG2 in the progression model.</p>
        <p>The other multi-gene node in the first layer includes EGFR and NF1, which are considered the main drivers of the classical and mesenchymal subtypes of GBM, respectively [<xref rid="pcbi.1010732.ref030" ref-type="bibr">30</xref>]. These two genes are expected to show patterns of mutual exclusivity as the classical subtype usually lacks mutations in NF1. The other subtype, proneural, is associated with mutations in TP53 and IDH1 [<xref rid="pcbi.1010732.ref031" ref-type="bibr">31</xref>]. Mutations in these two genes are also common in the mesenchymal subtype but not in the classical [<xref rid="pcbi.1010732.ref032" ref-type="bibr">32</xref>]. The progression relation from TP53 to IDH1 is a well-known relation with clinical significance [<xref rid="pcbi.1010732.ref033" ref-type="bibr">33</xref>]. The timeline of GBM tumor development introduced in [<xref rid="pcbi.1010732.ref034" ref-type="bibr">34</xref>] suggests mutations in TP53 and EGFR as early clonal events, followed later by IDH1. In the following, we explain how the ToMExO model resolves an important ambiguity in this interpretation. Our progression model for GBM recovers the perfect progression relation (λ<sub><italic toggle="yes">PR</italic></sub> = 1) from TP53 to IDH1. However, EGFR is placed in a separate first-layer node. We tested the progression relation from EGFR to IDH1 and found a significant negative progression score (λ<sub><italic toggle="yes">PR</italic></sub> = −0.67), which means that mutations in EGFR highly reduce the chance of mutation in IDH1. This was expected since mutations in TP53 and IDH1 are not common in the classical subtype, where EGFR is highly mutated, as mentioned above. We emphasize that the other significant progression relation of our model, from TP53 to RB1, is also interesting as these two tumor suppressors are known to cooperate in glioblastoma tumorigenesis [<xref rid="pcbi.1010732.ref035" ref-type="bibr">35</xref>].</p>
      </sec>
      <sec id="sec016">
        <title>Colorectal Adenocarcinoma (COADREAD)</title>
        <p>Our COADREAD dataset includes 223 tumors and 43 genes. The resulting progression model is shown in <xref rid="pcbi.1010732.g010" ref-type="fig">Fig 10</xref>. Our inferred false positive and false negative probabilities are 0.022 and 0.076, respectively. The posterior ratio of the resulting model to the star tree is 2.41 * 10<sup>78</sup>, corresponding to a per-tumor ratio of 2.246. The dataset with more than 9.5 thousand bits can fully conform with our progression assuming 67 false positives and 107 false negatives.</p>
        <fig position="float" id="pcbi.1010732.g010">
          <object-id pub-id-type="doi">10.1371/journal.pcbi.1010732.g010</object-id>
          <label>Fig 10</label>
          <caption>
            <title>Inferred progression model for Colorectal Adenocarcinoma (COADREAD).</title>
          </caption>
          <graphic xlink:href="pcbi.1010732.g010" position="float"/>
        </fig>
        <p>As recovered by our progression model, KRAS mutations in colorectal cancer are known to happen after mutations in APC [<xref rid="pcbi.1010732.ref036" ref-type="bibr">36</xref>]. Mutations in TP53 are also shown to play important oncogenetic roles in colorectal cancers [<xref rid="pcbi.1010732.ref037" ref-type="bibr">37</xref>]. ToMExO puts TP53 in a node separated from APC → KRAS → PIK3CA chain. The interrelations between TP53, APC and KRAS in colorectal cancer have been of particular interest and investigated using various models starting from the classical Fearon and Vogelstein’s model [<xref rid="pcbi.1010732.ref038" ref-type="bibr">38</xref>], suggesting APC → KRAS → TP53 progression pattern. We tested the progression scores between TP53 and both APC and KRAS. We see that in our dataset, we have λ<sub><italic toggle="yes">PR</italic></sub>(KRAS → TP53) = −0.06 and λ<sub><italic toggle="yes">PR</italic></sub>(APC → TP53) = 0.02. Therefore, TP53 is <italic toggle="yes">almost</italic> independent of APC and KRAS, as suggested by our progression model.</p>
        <p>Our progression model for colorectal cancer (<xref rid="pcbi.1010732.g010" ref-type="fig">Fig 10</xref>) includes many interesting mutual exclusivity and progression patterns, including the mutual exclusivity of (TP53, BRAF, SOX9) and progression relations from (ARID1A,SMAD2,MTOR) to MYH9 to BCL9, which is a repeated pattern in the data.</p>
      </sec>
      <sec id="sec017">
        <title>Pancreatic adenocarcinoma (PAAD)</title>
        <p>Our PAAD dataset includes 150 tumors and 18 genes. The resulting progression model is shown in <xref rid="pcbi.1010732.g011" ref-type="fig">Fig 11</xref>. Our inferred false positive and false negative probabilities are 0.025 and 0.072, respectively. The posterior ratio of the resulting model to the star tree is 1.11 * 10<sup>21</sup>, corresponding to a per-tumor ratio of 1.381. The dataset with 2.7 thousand bits can fully conform with our progression, assuming 26 false positives and 40 false negatives.</p>
        <fig position="float" id="pcbi.1010732.g011">
          <object-id pub-id-type="doi">10.1371/journal.pcbi.1010732.g011</object-id>
          <label>Fig 11</label>
          <caption>
            <title>Inferred progression model for Pancreatic adenocarcinoma (PAAD).</title>
          </caption>
          <graphic xlink:href="pcbi.1010732.g011" position="float"/>
        </fig>
        <p>Mutations in KRAS and TP53 are present in 91 and 69 percent of our samples, respectively. These two genes are known to be highly associated with oncogenesis in pancreatic cancer [<xref rid="pcbi.1010732.ref039" ref-type="bibr">39</xref>]. We have CDKN2A later in the chain, which agrees with the tumor development timeline suggested by [<xref rid="pcbi.1010732.ref034" ref-type="bibr">34</xref>], where KRAS and TP53 are shown to be early clonal events with CDKN2A following later.</p>
        <p>In another branch independent from KRAS and TP53, we have SMAD4. We calculated a progression score of 0.08 from KRAS to SMAD4, which agrees with the separated branch for SMAD4. The mutations in SMAD4 are well-known to be important in pancreatic cancer [<xref rid="pcbi.1010732.ref040" ref-type="bibr">40</xref>]. Our model suggests interesting progression relations from SMAD4 to RNF43 and from NF43 to ATM, which might be interesting for further studies.</p>
      </sec>
    </sec>
  </sec>
  <sec sec-type="conclusions" id="sec018">
    <title>Discussion</title>
    <p>In this paper, we introduced ToMExO, a probabilistic method for analyzing cross-sectional mutation data from cohorts of tumors. Our method is designed to simultaneously infer the mutual exclusivity patterns among the driver genes and place them into a tree-like structure coding the temporal order of events. We introduced a computationally efficient inference algorithm for investigating huge datasets with hundreds of genes and thousands of tumors. After an extensive set of synthetic data experiments, we presented our results on a dataset previously analyzed by two state-of-the-art methods, showing our superior performance. Finally, we presented our analyses on larger TCGA datasets that the opponents cannot approach due to the large numbers of genes in the datasets. Our inferred progression models for glioblastoma, colorectal, and pancreatic cancers presented in this paper recover several well-known mutual exclusivity and progression patterns among specific genes and suggest a broad set of new such relations. ToMExO is publicly available in our GitHub repository (<ext-link xlink:href="https://github.com/mrmohaghegh/tomexo" ext-link-type="uri">https://github.com/mrmohaghegh/tomexo</ext-link>). Our complementary analyses of another set of 27 cancer types can be found in our repository.</p>
    <p>While this paper was focused on inferring the progression and mutual exclusivity patterns at the level of tumors, it’s worth mentioning that our method is also applicable at the level of individual clones. The mutually exclusive mutations may happen in different clones of a single tumor. Moreover, various clones of a tumor may follow different evolutionary paths. Therefore, considering the clonal structure of the tumors seems appealing for further investigations in future studies.</p>
  </sec>
  <sec id="sec019" sec-type="supplementary-material">
    <title>Supporting information</title>
    <supplementary-material id="pcbi.1010732.s001" position="float" content-type="local-data">
      <label>S1 Text</label>
      <caption>
        <title>Supplementary details.</title>
        <p>(PDF)</p>
      </caption>
      <media xlink:href="pcbi.1010732.s001.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <ref-list>
    <title>References</title>
    <ref id="pcbi.1010732.ref001">
      <label>1</label>
      <mixed-citation publication-type="journal"><name><surname>Beerenwinkel</surname><given-names>N</given-names></name>, <name><surname>Schwarz</surname><given-names>RF</given-names></name>, <name><surname>Gerstung</surname><given-names>M</given-names></name>, <name><surname>Markowetz</surname><given-names>F</given-names></name>. <article-title>Cancer evolution: mathematical models and computational inference</article-title>. <source>Systematic biology</source>. <year>2015</year>;<volume>64</volume>(<issue>1</issue>):<fpage>e1</fpage>–<lpage>e25</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1093/sysbio/syu081</pub-id><?supplied-pmid 25293804?><pub-id pub-id-type="pmid">25293804</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1010732.ref002">
      <label>2</label>
      <mixed-citation publication-type="journal"><name><surname>Cristea</surname><given-names>S</given-names></name>, <name><surname>Kuipers</surname><given-names>J</given-names></name>, <name><surname>Beerenwinkel</surname><given-names>N</given-names></name>. <article-title>pathTiMEx: joint inference of mutually exclusive cancer pathways and their progression dynamics</article-title>. <source>Journal of Computational Biology</source>. <year>2017</year>;<volume>24</volume>(<issue>6</issue>):<fpage>603</fpage>–<lpage>615</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1089/cmb.2016.0171</pub-id><?supplied-pmid 27936934?><pub-id pub-id-type="pmid">27936934</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1010732.ref003">
      <label>3</label>
      <mixed-citation publication-type="journal"><name><surname>Desper</surname><given-names>R</given-names></name>, <name><surname>Jiang</surname><given-names>F</given-names></name>, <name><surname>Kallioniemi</surname><given-names>OP</given-names></name>, <name><surname>Moch</surname><given-names>H</given-names></name>, <name><surname>Papadimitriou</surname><given-names>CH</given-names></name>, <name><surname>Schäffer</surname><given-names>AA</given-names></name>. <article-title>Inferring tree models for oncogenesis from comparative genome hybridization data</article-title>. <source>Journal of computational biology</source>. <year>1999</year>;<volume>6</volume>(<issue>1</issue>):<fpage>37</fpage>–<lpage>51</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1089/cmb.1999.6.37</pub-id><?supplied-pmid 10223663?><pub-id pub-id-type="pmid">10223663</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1010732.ref004">
      <label>4</label>
      <mixed-citation publication-type="journal"><name><surname>Desper</surname><given-names>R</given-names></name>, <name><surname>Jiang</surname><given-names>F</given-names></name>, <name><surname>Kallioniemi</surname><given-names>OP</given-names></name>, <name><surname>Moch</surname><given-names>H</given-names></name>, <name><surname>Papadimitriou</surname><given-names>CH</given-names></name>, <name><surname>Schäffer</surname><given-names>AA</given-names></name>. <article-title>Distance-based reconstruction of tree models for oncogenesis</article-title>. <source>Journal of Computational Biology</source>. <year>2000</year>;<volume>7</volume>(<issue>6</issue>):<fpage>789</fpage>–<lpage>803</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1089/10665270050514936</pub-id><?supplied-pmid 11382362?><pub-id pub-id-type="pmid">11382362</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1010732.ref005">
      <label>5</label>
      <mixed-citation publication-type="journal"><name><surname>Heydebreck</surname><given-names>Av</given-names></name>, <name><surname>Gunawan</surname><given-names>B</given-names></name>, <name><surname>Füzesi</surname><given-names>L</given-names></name>. <article-title>Maximum likelihood estimation of oncogenetic tree models</article-title>. <source>Biostatistics</source>. <year>2004</year>;<volume>5</volume>(<issue>4</issue>):<fpage>545</fpage>–<lpage>556</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1093/biostatistics/kxh007</pub-id><pub-id pub-id-type="pmid">15475418</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1010732.ref006">
      <label>6</label>
      <mixed-citation publication-type="journal"><name><surname>Szabo</surname><given-names>A</given-names></name>, <name><surname>Boucher</surname><given-names>K</given-names></name>. <article-title>Estimating an oncogenetic tree when false negatives and positives are present</article-title>. <source>Mathematical biosciences</source>. <year>2002</year>;<volume>176</volume>(<issue>2</issue>):<fpage>219</fpage>–<lpage>236</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1016/S0025-5564(02)00086-X</pub-id><?supplied-pmid 11916510?><pub-id pub-id-type="pmid">11916510</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1010732.ref007">
      <label>7</label>
      <mixed-citation publication-type="journal"><name><surname>Beerenwinkel</surname><given-names>N</given-names></name>, <name><surname>Rahnenführer</surname><given-names>J</given-names></name>, <name><surname>Kaiser</surname><given-names>R</given-names></name>, <name><surname>Hoffmann</surname><given-names>D</given-names></name>, <name><surname>Selbig</surname><given-names>J</given-names></name>, <name><surname>Lengauer</surname><given-names>T</given-names></name>. <article-title>Mtreemix: a software package for learning and using mixture models of mutagenetic trees</article-title>. <source>Bioinformatics</source>. <year>2005</year>;<volume>21</volume>(<issue>9</issue>):<fpage>2106</fpage>–<lpage>2107</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1093/bioinformatics/bti274</pub-id><?supplied-pmid 15657098?><pub-id pub-id-type="pmid">15657098</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1010732.ref008">
      <label>8</label>
      <mixed-citation publication-type="journal"><name><surname>Loohuis</surname><given-names>LO</given-names></name>, <name><surname>Caravagna</surname><given-names>G</given-names></name>, <name><surname>Graudenzi</surname><given-names>A</given-names></name>, <name><surname>Ramazzotti</surname><given-names>D</given-names></name>, <name><surname>Mauri</surname><given-names>G</given-names></name>, <name><surname>Antoniotti</surname><given-names>M</given-names></name>, <etal>et al</etal>. <article-title>Inferring tree causal models of cancer progression with probability raising</article-title>. <source>PloS one</source>. <year>2014</year>;<volume>9</volume>(<issue>10</issue>):<fpage>e108358</fpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1371/journal.pone.0108358</pub-id><pub-id pub-id-type="pmid">25299648</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1010732.ref009">
      <label>9</label>
      <mixed-citation publication-type="other">Tofigh A, Sjolund E, Hoglund M, Lagergren J. A global structural EM algorithm for a model of cancer progression. In: Proceedings of the 24th International Conference on Neural Information Processing Systems; 2011. p. 163–171.</mixed-citation>
    </ref>
    <ref id="pcbi.1010732.ref010">
      <label>10</label>
      <mixed-citation publication-type="journal"><name><surname>Gerstung</surname><given-names>M</given-names></name>, <name><surname>Baudis</surname><given-names>M</given-names></name>, <name><surname>Moch</surname><given-names>H</given-names></name>, <name><surname>Beerenwinkel</surname><given-names>N</given-names></name>. <article-title>Quantifying cancer progression with conjunctive Bayesian networks</article-title>. <source>Bioinformatics</source>. <year>2009</year>;<volume>25</volume>(<issue>21</issue>):<fpage>2809</fpage>–<lpage>2815</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1093/bioinformatics/btp505</pub-id><?supplied-pmid 19692554?><pub-id pub-id-type="pmid">19692554</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1010732.ref011">
      <label>11</label>
      <mixed-citation publication-type="journal"><name><surname>Beerenwinkel</surname><given-names>N</given-names></name>, <name><surname>Eriksson</surname><given-names>N</given-names></name>, <name><surname>Sturmfels</surname><given-names>B</given-names></name>. <article-title>Conjunctive bayesian networks</article-title>. <source>Bernoulli</source>. <year>2007</year>;<volume>13</volume>(<issue>4</issue>):<fpage>893</fpage>–<lpage>909</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.3150/07-BEJ6133</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1010732.ref012">
      <label>12</label>
      <mixed-citation publication-type="journal"><name><surname>Beerenwinkel</surname><given-names>N</given-names></name>, <name><surname>Sullivant</surname><given-names>S</given-names></name>. <article-title>Markov models for accumulating mutations</article-title>. <source>Biometrika</source>. <year>2009</year>;<volume>96</volume>(<issue>3</issue>):<fpage>645</fpage>–<lpage>661</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1093/biomet/asp023</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1010732.ref013">
      <label>13</label>
      <mixed-citation publication-type="journal"><name><surname>Sakoparnig</surname><given-names>T</given-names></name>, <name><surname>Beerenwinkel</surname><given-names>N</given-names></name>. <article-title>Efficient sampling for Bayesian inference of conjunctive Bayesian networks</article-title>. <source>Bioinformatics</source>. <year>2012</year>;<volume>28</volume>(<issue>18</issue>):<fpage>2318</fpage>–<lpage>2324</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1093/bioinformatics/bts433</pub-id><?supplied-pmid 22782551?><pub-id pub-id-type="pmid">22782551</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1010732.ref014">
      <label>14</label>
      <mixed-citation publication-type="journal"><name><surname>Constantinescu</surname><given-names>S</given-names></name>, <name><surname>Szczurek</surname><given-names>E</given-names></name>, <name><surname>Mohammadi</surname><given-names>P</given-names></name>, <name><surname>Rahnenführer</surname><given-names>J</given-names></name>, <name><surname>Beerenwinkel</surname><given-names>N</given-names></name>. <article-title>TiMEx: a waiting time model for mutually exclusive cancer alterations</article-title>. <source>Bioinformatics</source>. <year>2016</year>;<volume>32</volume>(<issue>7</issue>):<fpage>968</fpage>–<lpage>975</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1093/bioinformatics/btv400</pub-id><?supplied-pmid 26163509?><pub-id pub-id-type="pmid">26163509</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1010732.ref015">
      <label>15</label>
      <mixed-citation publication-type="journal"><name><surname>Jerby-Arnon</surname><given-names>L</given-names></name>, <name><surname>Pfetzer</surname><given-names>N</given-names></name>, <name><surname>Waldman</surname><given-names>YY</given-names></name>, <name><surname>McGarry</surname><given-names>L</given-names></name>, <name><surname>James</surname><given-names>D</given-names></name>, <name><surname>Shanks</surname><given-names>E</given-names></name>, <etal>et al</etal>. <article-title>Predicting cancer-specific vulnerability via data-driven detection of synthetic lethality</article-title>. <source>Cell</source>. <year>2014</year>;<volume>158</volume>(<issue>5</issue>):<fpage>1199</fpage>–<lpage>1209</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1016/j.cell.2014.07.027</pub-id><?supplied-pmid 25171417?><pub-id pub-id-type="pmid">25171417</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1010732.ref016">
      <label>16</label>
      <mixed-citation publication-type="journal"><name><surname>Leiserson</surname><given-names>MD</given-names></name>, <name><surname>Blokh</surname><given-names>D</given-names></name>, <name><surname>Sharan</surname><given-names>R</given-names></name>, <name><surname>Raphael</surname><given-names>BJ</given-names></name>. <article-title>Simultaneous identification of multiple driver pathways in cancer</article-title>. <source>PLoS computational biology</source>. <year>2013</year>;<volume>9</volume>(<issue>5</issue>):<fpage>e1003054</fpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1371/journal.pcbi.1003054</pub-id><?supplied-pmid 23717195?><pub-id pub-id-type="pmid">23717195</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1010732.ref017">
      <label>17</label>
      <mixed-citation publication-type="journal"><name><surname>Leiserson</surname><given-names>MD</given-names></name>, <name><surname>Wu</surname><given-names>HT</given-names></name>, <name><surname>Vandin</surname><given-names>F</given-names></name>, <name><surname>Raphael</surname><given-names>BJ</given-names></name>. <article-title>CoMEt: a statistical approach to identify combinations of mutually exclusive alterations in cancer</article-title>. <source>Genome biology</source>. <year>2015</year>;<volume>16</volume>(<issue>1</issue>):<fpage>1</fpage>–<lpage>20</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1186/s13059-015-0700-7</pub-id><pub-id pub-id-type="pmid">25583448</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1010732.ref018">
      <label>18</label>
      <mixed-citation publication-type="journal"><name><surname>Szczurek</surname><given-names>E</given-names></name>, <name><surname>Beerenwinkel</surname><given-names>N</given-names></name>. <article-title>Modeling mutual exclusivity of cancer mutations</article-title>. <source>PLoS computational biology</source>. <year>2014</year>;<volume>10</volume>(<issue>3</issue>):<fpage>e1003503</fpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1371/journal.pcbi.1003503</pub-id><?supplied-pmid 24675718?><pub-id pub-id-type="pmid">24675718</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1010732.ref019">
      <label>19</label>
      <mixed-citation publication-type="journal"><name><surname>Raphael</surname><given-names>BJ</given-names></name>, <name><surname>Vandin</surname><given-names>F</given-names></name>. <article-title>Simultaneous inference of cancer pathways and tumor progression from cross-sectional mutation data</article-title>. <source>Journal of Computational Biology</source>. <year>2015</year>;<volume>22</volume>(<issue>6</issue>):<fpage>510</fpage>–<lpage>527</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1089/cmb.2014.0161</pub-id><?supplied-pmid 25785493?><pub-id pub-id-type="pmid">25785493</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1010732.ref020">
      <label>20</label>
      <mixed-citation publication-type="journal"><name><surname>Mohaghegh Neyshabouri</surname><given-names>M</given-names></name>, <name><surname>Jun</surname><given-names>SH</given-names></name>, <name><surname>Lagergren</surname><given-names>J</given-names></name>. <article-title>Inferring tumor progression in large datasets</article-title>. <source>PLoS computational biology</source>. <year>2020</year>;<volume>16</volume>(<issue>10</issue>):<fpage>e1008183</fpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1371/journal.pcbi.1008183</pub-id><?supplied-pmid 33035204?><pub-id pub-id-type="pmid">33035204</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1010732.ref021">
      <label>21</label>
      <mixed-citation publication-type="journal"><name><surname>Dempster</surname><given-names>AP</given-names></name>, <name><surname>Laird</surname><given-names>NM</given-names></name>, <name><surname>Rubin</surname><given-names>DB</given-names></name>. <article-title>Maximum likelihood from incomplete data via the EM algorithm</article-title>. <source>Journal of the Royal Statistical Society: Series B (Methodological)</source>. <year>1977</year>;<volume>39</volume>(<issue>1</issue>):<fpage>1</fpage>–<lpage>22</lpage>.</mixed-citation>
    </ref>
    <ref id="pcbi.1010732.ref022">
      <label>22</label>
      <mixed-citation publication-type="journal"><name><surname>Hjelm</surname><given-names>M</given-names></name>, <name><surname>Höglund</surname><given-names>M</given-names></name>, <name><surname>Lagergren</surname><given-names>J</given-names></name>. <article-title>New probabilistic network models and algorithms for oncogenesis</article-title>. <source>Journal of Computational Biology</source>. <year>2006</year>;<volume>13</volume>(<issue>4</issue>):<fpage>853</fpage>–<lpage>865</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1089/cmb.2006.13.853</pub-id><?supplied-pmid 16761915?><pub-id pub-id-type="pmid">16761915</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1010732.ref023">
      <label>23</label>
      <mixed-citation publication-type="journal"><name><surname>Schill</surname><given-names>R</given-names></name>, <name><surname>Solbrig</surname><given-names>S</given-names></name>, <name><surname>Wettig</surname><given-names>T</given-names></name>, <name><surname>Spang</surname><given-names>R</given-names></name>. <article-title>Modelling cancer progression using mutual hazard networks</article-title>. <source>Bioinformatics</source>. <year>2020</year>;<volume>36</volume>(<issue>1</issue>):<fpage>241</fpage>–<lpage>249</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1093/bioinformatics/btz513</pub-id><?supplied-pmid 31250881?><pub-id pub-id-type="pmid">31250881</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1010732.ref024">
      <label>24</label>
      <mixed-citation publication-type="journal"><name><surname>DiNardo</surname><given-names>Z</given-names></name>, <name><surname>Tomlinson</surname><given-names>K</given-names></name>, <name><surname>Ritz</surname><given-names>A</given-names></name>, <name><surname>Oesper</surname><given-names>L</given-names></name>. <article-title>Distance measures for tumor evolutionary trees</article-title>. <source>Bioinformatics</source>. <year>2020</year>;<volume>36</volume>(<issue>7</issue>):<fpage>2090</fpage>–<lpage>2097</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1093/bioinformatics/btz869</pub-id><?supplied-pmid 31750900?><pub-id pub-id-type="pmid">31750900</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1010732.ref025">
      <label>25</label>
      <mixed-citation publication-type="journal"><name><surname>Cerami</surname><given-names>E</given-names></name>, <name><surname>Gao</surname><given-names>J</given-names></name>, <name><surname>Dogrusoz</surname><given-names>U</given-names></name>, <name><surname>Gross</surname><given-names>BE</given-names></name>, <name><surname>Sumer</surname><given-names>SO</given-names></name>, <name><surname>Aksoy</surname><given-names>BA</given-names></name>, <etal>et al</etal>. <article-title>The cBio cancer genomics portal: an open platform for exploring multidimensional cancer genomics data</article-title>. <source>Cancer discovery</source>. <year>2012</year>;<volume>2</volume>(<issue>5</issue>):<fpage>401</fpage>–<lpage>404</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1158/2159-8290.CD-12-0095</pub-id><?supplied-pmid 22588877?><pub-id pub-id-type="pmid">22588877</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1010732.ref026">
      <label>26</label>
      <mixed-citation publication-type="journal"><name><surname>Ramazzotti</surname><given-names>D</given-names></name>, <name><surname>Caravagna</surname><given-names>G</given-names></name>, <name><surname>Olde Loohuis</surname><given-names>L</given-names></name>, <name><surname>Graudenzi</surname><given-names>A</given-names></name>, <name><surname>Korsunsky</surname><given-names>I</given-names></name>, <name><surname>Mauri</surname><given-names>G</given-names></name>, <etal>et al</etal>. <article-title>CAPRI: efficient inference of cancer progression models from cross-sectional data</article-title>. <source>Bioinformatics</source>. <year>2015</year>;<volume>31</volume>(<issue>18</issue>):<fpage>3016</fpage>–<lpage>3026</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1093/bioinformatics/btv296</pub-id><?supplied-pmid 25971740?><pub-id pub-id-type="pmid">25971740</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1010732.ref027">
      <label>27</label>
      <mixed-citation publication-type="journal"><name><surname>Martínez-Jiménez</surname><given-names>F</given-names></name>, <name><surname>Muiños</surname><given-names>F</given-names></name>, <name><surname>Sentís</surname><given-names>I</given-names></name>, <name><surname>Deu-Pons</surname><given-names>J</given-names></name>, <name><surname>Reyes-Salazar</surname><given-names>I</given-names></name>, <name><surname>Arnedo-Pac</surname><given-names>C</given-names></name>, <etal>et al</etal>. <article-title>A compendium of mutational cancer driver genes</article-title>. <source>Nature Reviews Cancer</source>. <year>2020</year>;<volume>20</volume>(<issue>10</issue>):<fpage>555</fpage>–<lpage>572</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1038/s41568-020-0290-x</pub-id><?supplied-pmid 32778778?><pub-id pub-id-type="pmid">32778778</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1010732.ref028">
      <label>28</label>
      <mixed-citation publication-type="journal"><name><surname>Papa</surname><given-names>A</given-names></name>, <name><surname>Pandolfi</surname><given-names>PP</given-names></name>. <article-title>The PTEN–PI3K axis in cancer</article-title>. <source>Biomolecules</source>. <year>2019</year>;<volume>9</volume>(<issue>4</issue>):<fpage>153</fpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.3390/biom9040153</pub-id><?supplied-pmid 30999672?><pub-id pub-id-type="pmid">30999672</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1010732.ref029">
      <label>29</label>
      <mixed-citation publication-type="journal"><name><surname>Mondal</surname><given-names>G</given-names></name>, <name><surname>Stevers</surname><given-names>M</given-names></name>, <name><surname>Goode</surname><given-names>B</given-names></name>, <name><surname>Ashworth</surname><given-names>A</given-names></name>, <name><surname>Solomon</surname><given-names>DA</given-names></name>. <article-title>A requirement for STAG2 in replication fork progression creates a targetable synthetic lethality in cohesin-mutant cancers</article-title>. <source>Nature communications</source>. <year>2019</year>;<volume>10</volume>(<issue>1</issue>):<fpage>1</fpage>–<lpage>16</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1038/s41467-019-09659-z</pub-id><?supplied-pmid 30975996?><pub-id pub-id-type="pmid">30975996</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1010732.ref030">
      <label>30</label>
      <mixed-citation publication-type="journal"><name><surname>Behnan</surname><given-names>J</given-names></name>, <name><surname>Finocchiaro</surname><given-names>G</given-names></name>, <name><surname>Hanna</surname><given-names>G</given-names></name>. <article-title>The landscape of the mesenchymal signature in brain tumours</article-title>. <source>Brain</source>. <year>2019</year>;<volume>142</volume>(<issue>4</issue>):<fpage>847</fpage>–<lpage>866</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1093/brain/awz044</pub-id><?supplied-pmid 30946477?><pub-id pub-id-type="pmid">30946477</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1010732.ref031">
      <label>31</label>
      <mixed-citation publication-type="journal"><name><surname>Noushmehr</surname><given-names>H</given-names></name>, <name><surname>Weisenberger</surname><given-names>DJ</given-names></name>, <name><surname>Diefes</surname><given-names>K</given-names></name>, <name><surname>Phillips</surname><given-names>HS</given-names></name>, <name><surname>Pujara</surname><given-names>K</given-names></name>, <name><surname>Berman</surname><given-names>BP</given-names></name>, <etal>et al</etal>. <article-title>Identification of a CpG island methylator phenotype that defines a distinct subgroup of glioma</article-title>. <source>Cancer cell</source>. <year>2010</year>;<volume>17</volume>(<issue>5</issue>):<fpage>510</fpage>–<lpage>522</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1016/j.ccr.2010.03.017</pub-id><?supplied-pmid 20399149?><pub-id pub-id-type="pmid">20399149</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1010732.ref032">
      <label>32</label>
      <mixed-citation publication-type="journal"><name><surname>Verhaak</surname><given-names>RG</given-names></name>, <name><surname>Hoadley</surname><given-names>KA</given-names></name>, <name><surname>Purdom</surname><given-names>E</given-names></name>, <name><surname>Wang</surname><given-names>V</given-names></name>, <name><surname>Qi</surname><given-names>Y</given-names></name>, <name><surname>Wilkerson</surname><given-names>MD</given-names></name>, <etal>et al</etal>. <article-title>Integrated genomic analysis identifies clinically relevant subtypes of glioblastoma characterized by abnormalities in PDGFRA, IDH1, EGFR, and NF1</article-title>. <source>Cancer cell</source>. <year>2010</year>;<volume>17</volume>(<issue>1</issue>):<fpage>98</fpage>–<lpage>110</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1016/j.ccr.2009.12.020</pub-id><?supplied-pmid 20129251?><pub-id pub-id-type="pmid">20129251</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1010732.ref033">
      <label>33</label>
      <mixed-citation publication-type="journal"><name><surname>Sturm</surname><given-names>D</given-names></name>, <name><surname>Witt</surname><given-names>H</given-names></name>, <name><surname>Hovestadt</surname><given-names>V</given-names></name>, <name><surname>Khuong-Quang</surname><given-names>DA</given-names></name>, <name><surname>Jones</surname><given-names>DT</given-names></name>, <name><surname>Konermann</surname><given-names>C</given-names></name>, <etal>et al</etal>. <article-title>Hotspot mutations in H3F3A and IDH1 define distinct epigenetic and biological subgroups of glioblastoma</article-title>. <source>Cancer cell</source>. <year>2012</year>;<volume>22</volume>(<issue>4</issue>):<fpage>425</fpage>–<lpage>437</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1016/j.ccr.2012.08.024</pub-id><?supplied-pmid 23079654?><pub-id pub-id-type="pmid">23079654</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1010732.ref034">
      <label>34</label>
      <mixed-citation publication-type="journal"><name><surname>Gerstung</surname><given-names>M</given-names></name>, <name><surname>Jolly</surname><given-names>C</given-names></name>, <name><surname>Leshchiner</surname><given-names>I</given-names></name>, <name><surname>Dentro</surname><given-names>SC</given-names></name>, <name><surname>Gonzalez</surname><given-names>S</given-names></name>, <name><surname>Rosebrock</surname><given-names>D</given-names></name>, <etal>et al</etal>. <article-title>The evolutionary history of 2,658 cancers</article-title>. <source>Nature</source>. <year>2020</year>;<volume>578</volume>(<issue>7793</issue>):<fpage>122</fpage>–<lpage>128</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1038/s41586-019-1907-7</pub-id><?supplied-pmid 32025013?><pub-id pub-id-type="pmid">32025013</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1010732.ref035">
      <label>35</label>
      <mixed-citation publication-type="journal"><name><surname>Chow</surname><given-names>LM</given-names></name>, <name><surname>Endersby</surname><given-names>R</given-names></name>, <name><surname>Zhu</surname><given-names>X</given-names></name>, <name><surname>Rankin</surname><given-names>S</given-names></name>, <name><surname>Qu</surname><given-names>C</given-names></name>, <name><surname>Zhang</surname><given-names>J</given-names></name>, <etal>et al</etal>. <article-title>Cooperativity within and among Pten, p53, and Rb pathways induces high-grade astrocytoma in adult brain</article-title>. <source>Cancer cell</source>. <year>2011</year>;<volume>19</volume>(<issue>3</issue>):<fpage>305</fpage>–<lpage>316</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1016/j.ccr.2011.01.039</pub-id><?supplied-pmid 21397855?><pub-id pub-id-type="pmid">21397855</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1010732.ref036">
      <label>36</label>
      <mixed-citation publication-type="journal"><name><surname>Boutin</surname><given-names>AT</given-names></name>, <name><surname>Liao</surname><given-names>WT</given-names></name>, <name><surname>Wang</surname><given-names>M</given-names></name>, <name><surname>Hwang</surname><given-names>SS</given-names></name>, <name><surname>Karpinets</surname><given-names>TV</given-names></name>, <name><surname>Cheung</surname><given-names>H</given-names></name>, <etal>et al</etal>. <article-title>Oncogenic Kras drives invasion and maintains metastases in colorectal cancer</article-title>. <source>Genes &amp; development</source>. <year>2017</year>;<volume>31</volume>(<issue>4</issue>):<fpage>370</fpage>–<lpage>382</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1101/gad.293449.116</pub-id><?supplied-pmid 28289141?><pub-id pub-id-type="pmid">28289141</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1010732.ref037">
      <label>37</label>
      <mixed-citation publication-type="journal"><name><surname>Nakayama</surname><given-names>M</given-names></name>, <name><surname>Oshima</surname><given-names>M</given-names></name>. <article-title>Mutant p53 in colon cancer</article-title>. <source>Journal of molecular cell biology</source>. <year>2019</year>;<volume>11</volume>(<issue>4</issue>):<fpage>267</fpage>–<lpage>276</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1093/jmcb/mjy075</pub-id><?supplied-pmid 30496442?><pub-id pub-id-type="pmid">30496442</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1010732.ref038">
      <label>38</label>
      <mixed-citation publication-type="journal"><name><surname>Fearon</surname><given-names>ER</given-names></name>, <name><surname>Vogelstein</surname><given-names>B</given-names></name>. <article-title>A genetic model for colorectal tumorigenesis</article-title>. <source>cell</source>. <year>1990</year>;<volume>61</volume>(<issue>5</issue>):<fpage>759</fpage>–<lpage>767</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1016/0092-8674(90)90186-I</pub-id><?supplied-pmid 2188735?><pub-id pub-id-type="pmid">2188735</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1010732.ref039">
      <label>39</label>
      <mixed-citation publication-type="journal"><name><surname>Cicenas</surname><given-names>J</given-names></name>, <name><surname>Kvederaviciute</surname><given-names>K</given-names></name>, <name><surname>Meskinyte</surname><given-names>I</given-names></name>, <name><surname>Meskinyte-Kausiliene</surname><given-names>E</given-names></name>, <name><surname>Skeberdyte</surname><given-names>A</given-names></name>, <name><surname>Cicenas</surname><given-names>J</given-names><suffix>Jr</suffix></name>. <article-title>KRAS, TP53, CDKN2A, SMAD4, BRCA1, and BRCA2 mutations in pancreatic cancer</article-title>. <source>Cancers</source>. <year>2017</year>;<volume>9</volume>(<issue>5</issue>):<fpage>42</fpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.3390/cancers9050042</pub-id><?supplied-pmid 28452926?><pub-id pub-id-type="pmid">28452926</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1010732.ref040">
      <label>40</label>
      <mixed-citation publication-type="journal"><name><surname>Shugang</surname><given-names>X</given-names></name>, <name><surname>Hongfa</surname><given-names>Y</given-names></name>, <name><surname>Jianpeng</surname><given-names>L</given-names></name>, <name><surname>Xu</surname><given-names>Z</given-names></name>, <name><surname>Jingqi</surname><given-names>F</given-names></name>, <name><surname>Xiangxiang</surname><given-names>L</given-names></name>, <etal>et al</etal>. <article-title>Prognostic value of SMAD4 in pancreatic cancer: a meta-analysis</article-title>. <source>Translational oncology</source>. <year>2016</year>;<volume>9</volume>(<issue>1</issue>):<fpage>1</fpage>–<lpage>7</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1016/j.tranon.2015.11.007</pub-id><?supplied-pmid 26947875?><pub-id pub-id-type="pmid">26947875</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
