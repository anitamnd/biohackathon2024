<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.1 20151215//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.1?>
<?ConverterInfo.XSLTName jp2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">Bioinformatics</journal-id>
    <journal-id journal-id-type="publisher-id">bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1367-4803</issn>
    <issn pub-type="epub">1367-4811</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">6853649</article-id>
    <article-id pub-id-type="doi">10.1093/bioinformatics/btz292</article-id>
    <article-id pub-id-type="publisher-id">btz292</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Original Papers</subject>
        <subj-group subj-group-type="category-toc-heading">
          <subject>Gene Expression</subject>
        </subj-group>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>scMatch: a single-cell gene expression profile annotation tool using reference datasets</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">http://orcid.org/0000-0001-6571-1514</contrib-id>
        <name>
          <surname>Hou</surname>
          <given-names>Rui</given-names>
        </name>
        <xref ref-type="aff" rid="btz292-aff1"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Denisenko</surname>
          <given-names>Elena</given-names>
        </name>
        <xref ref-type="aff" rid="btz292-aff1"/>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">http://orcid.org/0000-0003-4543-1675</contrib-id>
        <name>
          <surname>Forrest</surname>
          <given-names>Alistair R R</given-names>
        </name>
        <xref ref-type="corresp" rid="btz292-cor1"/>
        <!--<email>alistair.forrest@gmail.com</email>-->
        <xref ref-type="aff" rid="btz292-aff1"/>
      </contrib>
    </contrib-group>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Kelso</surname>
          <given-names>Janet</given-names>
        </name>
        <role>Associate Editor</role>
      </contrib>
    </contrib-group>
    <aff id="btz292-aff1"><institution>Harry Perkins Institute of Medical Research, QEII Medical Centre and Centre for Medical Research, The University of Western Australia</institution>, Nedlands, Perth, WA 6009, Australia</aff>
    <author-notes>
      <corresp id="btz292-cor1">To whom correspondence should be addressed. E-mail: <email>alistair.forrest@gmail.com</email></corresp>
    </author-notes>
    <pub-date pub-type="ppub">
      <day>15</day>
      <month>11</month>
      <year>2019</year>
    </pub-date>
    <pub-date pub-type="epub" iso-8601-date="2019-04-26">
      <day>26</day>
      <month>4</month>
      <year>2019</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>26</day>
      <month>4</month>
      <year>2019</year>
    </pub-date>
    <!-- PMC Release delay is 0 months and 0 days and was based on the <pub-date pub-type="epub"/>. -->
    <volume>35</volume>
    <issue>22</issue>
    <fpage>4688</fpage>
    <lpage>4695</lpage>
    <history>
      <date date-type="received">
        <day>06</day>
        <month>12</month>
        <year>2018</year>
      </date>
      <date date-type="rev-recd">
        <day>28</day>
        <month>3</month>
        <year>2019</year>
      </date>
      <date date-type="accepted">
        <day>21</day>
        <month>4</month>
        <year>2019</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2019. Published by Oxford University Press.</copyright-statement>
      <copyright-year>2019</copyright-year>
      <license license-type="cc-by" xlink:href="http://creativecommons.org/licenses/by/4.0/">
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted reuse, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <self-uri xlink:href="btz292.pdf"/>
    <abstract>
      <title>Abstract</title>
      <sec id="s1">
        <title>Motivation</title>
        <p>Single-cell RNA sequencing (scRNA-seq) measures gene expression at the resolution of individual cells. Massively multiplexed single-cell profiling has enabled large-scale transcriptional analyses of thousands of cells in complex tissues. In most cases, the true identity of individual cells is unknown and needs to be inferred from the transcriptomic data. Existing methods typically cluster (group) cells based on similarities of their gene expression profiles and assign the same identity to all cells within each cluster using the averaged expression levels. However, scRNA-seq experiments typically produce low-coverage sequencing data for each cell, which hinders the clustering process.</p>
      </sec>
      <sec id="s2">
        <title>Results</title>
        <p>We introduce scMatch, which directly annotates single cells by identifying their closest match in large reference datasets. We used this strategy to annotate various single-cell datasets and evaluated the impacts of sequencing depth, similarity metric and reference datasets. We found that scMatch can rapidly and robustly annotate single cells with comparable accuracy to another recent cell annotation tool (SingleR), but that it is quicker and can handle larger reference datasets. We demonstrate how scMatch can handle large customized reference gene expression profiles that combine data from multiple sources, thus empowering researchers to identify cell populations in any complex tissue with the desired precision.</p>
      </sec>
      <sec id="s3">
        <title>Availability and implementation</title>
        <p>scMatch (Python code) and the FANTOM5 reference dataset are freely available to the research community here <ext-link ext-link-type="uri" xlink:href="https://github.com/forrest-lab/scMatch">https://github.com/forrest-lab/scMatch</ext-link>.</p>
      </sec>
      <sec id="s4">
        <title>Supplementary information</title>
        <p><xref ref-type="supplementary-material" rid="sup1">Supplementary data</xref> are available at <italic>Bioinformatics</italic> online.</p>
      </sec>
    </abstract>
    <funding-group>
      <award-group award-type="grant">
        <funding-source>
          <named-content content-type="funder-name">Cancer Research Trust ‘Enabling</named-content>
        </funding-source>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <named-content content-type="funder-name">Cancer Council of Western Australia</named-content>
        </funding-source>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <named-content content-type="funder-name">Australian Government Research Training Programme</named-content>
        </funding-source>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <named-content content-type="funder-name">Cancer Research Trust</named-content>
        </funding-source>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <named-content content-type="funder-name">Australian National Health and Medical Research Council Fellowship</named-content>
        </funding-source>
        <award-id>APP1154524</award-id>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <named-content content-type="funder-name">Australian Government and the Government of Western Australia</named-content>
        </funding-source>
      </award-group>
    </funding-group>
    <counts>
      <page-count count="8"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec>
    <title>1 Introduction</title>
    <p>Although the whole-transcriptome analysis of single cells has been possible since 2009 (<xref rid="btz292-B29" ref-type="bibr">Tang <italic>et al.</italic>, 2009</xref>) only recently has it become broadly applied in the research community. This is due to the development of new massively multiplexed single-cell RNA sequencing (scRNA-seq) protocols (<xref rid="btz292-B11" ref-type="bibr">Han <italic>et al.</italic>, 2018</xref>; <xref rid="btz292-B12" ref-type="bibr">Hashimshony <italic>et al.</italic>, 2012</xref>; <xref rid="btz292-B18" ref-type="bibr">Macosko <italic>et al.</italic>, 2015</xref>; <xref rid="btz292-B19" ref-type="bibr">Picelli <italic>et al.</italic>, 2013</xref>; <xref rid="btz292-B22" ref-type="bibr">Rosenberg <italic>et al.</italic>, 2018</xref>) and the broad availability of commercial platforms for generating these libraries. Barcode-based tracking methods (molecular-, cellular- and plate-level tags) now allow us to profile gene expression in thousands of cells. This advance in single cell profiling is enabling characterization of the diverse cell types that make up various tissues (<xref rid="btz292-B21" ref-type="bibr">Regev <italic>et al.</italic>, 2018</xref>) and to study biological processes, such as cell development (<xref rid="btz292-B3" ref-type="bibr">Bendall <italic>et al.</italic>, 2014</xref>; <xref rid="btz292-B14" ref-type="bibr">Klein <italic>et al.</italic>, 2015</xref>; <xref rid="btz292-B23" ref-type="bibr">Setty <italic>et al.</italic>, 2016</xref>; <xref rid="btz292-B33" ref-type="bibr">Trapnell <italic>et al.</italic>, 2014</xref>), cell state transition (<xref rid="btz292-B5" ref-type="bibr">da Rocha <italic>et al.</italic>, 2018</xref>; <xref rid="btz292-B10" ref-type="bibr">Haghverdi <italic>et al.</italic>, 2016</xref>; <xref rid="btz292-B24" ref-type="bibr">Shin <italic>et al.</italic>, 2015</xref>; <xref rid="btz292-B34" ref-type="bibr">Treutlein <italic>et al.</italic>, 2014</xref>) and multi-cellular interactions (<xref rid="btz292-B30" ref-type="bibr">Tay <italic>et al.</italic>, 2010</xref>; <xref rid="btz292-B31" ref-type="bibr">Thompson <italic>et al.</italic>, 2014</xref>; <xref rid="btz292-B35" ref-type="bibr">Wang <italic>et al.</italic>, 2014</xref>).</p>
    <p>For the majority of these new studies, high cell count, low-sequencing depth strategies are being used; however, low-sequencing depth scRNA-seq data typically only measures the expression of the most highly expressed 500–2000 genes per cell (<xref rid="btz292-B18" ref-type="bibr">Macosko <italic>et al.</italic>, 2015</xref>; <xref rid="btz292-B36" ref-type="bibr">Zheng <italic>et al.</italic> 2017</xref>). Additionally, cells have different RNA complexities, e.g. embryonic stem cell transcriptomes are more complex (expressing a broad range of genes) than fully differentiated cells which have transcriptomes more skewed to high expression of a smaller subset of genes. This translates to variable numbers of genes detected per cell and consequently variable numbers of ‘dropouts’ (genes that are expressed but not detected) for different cell lineages.</p>
    <p>To date, most publications analysing scRNA-seq data start by unsupervised clustering of the cells based on similarity between their gene expression profiles (<xref rid="btz292-B13" ref-type="bibr">Kim <italic>et al.</italic>, 2018</xref>; <xref rid="btz292-B27" ref-type="bibr">Svensson <italic>et al.</italic>, 2017</xref>). The aim of this is to subdivide the cells into separate clusters that represent biologically meaningful sub-populations. Canonical marker genes of known cell types enriched in each cluster are then used to annotate the cluster (consequently all cells within the cluster are given the same label). Despite this being the most common approach, a recent review of clustering algorithms applied to single cell data (<xref rid="btz292-B9" ref-type="bibr">Freytag <italic>et al.</italic>, 2018</xref>) found little degree of overlap between clusters identified by different methods and their granularity. In part due to the small and variable number of genes detected this results in either under-clustering of the single-cell data or misassignment. Problematically, in both cases, dissimilar cells are grouped together (<xref rid="btz292-B9" ref-type="bibr">Freytag <italic>et al.</italic>, 2018</xref>; <xref rid="btz292-B13" ref-type="bibr">Kim <italic>et al.</italic>, 2018</xref>; <xref rid="btz292-B25" ref-type="bibr">Shirai <italic>et al.</italic>, 2016</xref>).</p>
    <p>Here, as an alternative to the cluster-then-annotate approach, we directly annotate single cells without clustering using scMatch, a Python programme that utilizes the similarity between single-cell gene expression profiles and reference expression profiles to directly annotate single cells in a scalable fashion. Basic steps of the annotation pipeline are shown in <xref ref-type="fig" rid="btz292-F1">Figure 1</xref>. The first step of the pipeline involves calculating the similarity between gene expression measured in a single cell with reference gene expression profiles from a public database, such as the FANTOM5 atlas [Functional ANnoTation Of Mammalian genomes 5 (<xref rid="btz292-B2" ref-type="bibr">Arner <italic>et al.</italic>, 2015</xref>; <xref rid="btz292-B8" ref-type="bibr">Forrest <italic>et al.</italic>, 2014</xref>; <xref rid="btz292-B16" ref-type="bibr">Lizio <italic>et al.</italic>, 2017</xref>)]. In top-match mode, a cell is simply annotated based on the best correlated sample within the reference database (<xref ref-type="fig" rid="btz292-F1">Fig. 1</xref>, Step 2A). Alternatively, ontology-mode uses sample ontology terms (such as the cell ontology; <xref rid="btz292-B6" ref-type="bibr">Diehl <italic>et al.</italic>, 2016</xref>) to group samples from the same cell type or lineage and then calculates the average correlation (<xref ref-type="fig" rid="btz292-F1">Fig. 1</xref>, Step 2B). The ontology term with the highest average correlation is then used to annotate the cell. We benchmark scMatch by evaluating its annotation recall using several public single cell datasets where the identity of every single cell is already known. We show that the choice of correlation measure, the sequencing depth, the cell types in question and the reference database all have an impact on the annotation accuracy. Despite this, scMatch performs well for a broad collection of cell types, and is robust to variations in sequencing depth.
</p>
    <fig id="btz292-F1" orientation="portrait" position="float">
      <label>Fig. 1</label>
      <caption>
        <p>Annotation of single cells using scMatch. scRNA-seq expression profiles are compared against a reference database. Matching samples from the reference database are then ranked by highest to lowest similarity. In top-match mode the cell is annotated with the label of the reference sample with the highest similarity. In ontology-mode, the cell ontology with highest average similarity is used to annotate the query cell. Shapes represent the features of a unique gene expression profile</p>
      </caption>
      <graphic xlink:href="btz292f1"/>
    </fig>
  </sec>
  <sec>
    <title>2 Materials and methods</title>
    <sec>
      <title>2.1 Count table down sampling</title>
      <p>Existing down-sampling methods usually retain a random subset of the reads in a SAM or BAM file. From the count table, all aligned reads are known. To down-sample reads in a cell to a certain amount, we first calculate the retain probability <italic>P</italic> by dividing the target read count by the original read count. If the target read count is not less than the original read count, then the retain probability is 100%. After gaining the retain probability, we use the <italic>P</italic> to get the subset of detected reads in the cell. If the read count of a gene is <italic>C</italic>, then we randomly draw one or zero <italic>C</italic> times, providing the probability to draw one is <italic>P</italic>. The sum of the draw results is the down-sampled read count of that gene. In this way, approximately <italic>P</italic> × original reads are retained. Since the down-sampling is a stochastic process, the down-sampled count tables with the same retain probability are not identical. We therefore, down-sample a count table ten times and analyse all resulting tables to minimize the technical biases. The annotation recall plotted in the down sampling analysis is the number of correctly annotated single cells in 10 down-sampled count tables divided by the total number of single cells in these 10 tables.
</p>
      <table-wrap id="btz292-T2" orientation="portrait" position="float">
        <label>Table 2.</label>
        <caption>
          <p>Annotation recalls of scMatch on four down-sampled cell lines using Spearman’s correlation coefficient</p>
        </caption>
        <table frame="hsides" rules="groups">
          <colgroup span="1">
            <col valign="top" align="left" span="1"/>
            <col valign="top" align="left" span="1"/>
            <col valign="top" align="char" char="." span="1"/>
            <col valign="top" align="char" char="." span="1"/>
          </colgroup>
          <thead>
            <tr>
              <th colspan="2" rowspan="2"/>
              <th colspan="2" rowspan="1">Spearman<hr/></th>
            </tr>
            <tr>
              <th rowspan="1" colspan="1">Remove zeros (%)</th>
              <th rowspan="1" colspan="1">Keep zeros (%)</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td rowspan="5" colspan="1">A549</td>
              <td rowspan="1" colspan="1">150 000 reads</td>
              <td rowspan="1" colspan="1">99.20</td>
              <td rowspan="1" colspan="1">100.00</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">100 000 reads</td>
              <td rowspan="1" colspan="1">98.00</td>
              <td rowspan="1" colspan="1">100.00</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">50 000 reads</td>
              <td rowspan="1" colspan="1">94.60</td>
              <td rowspan="1" colspan="1">100.00</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">10 000 reads</td>
              <td rowspan="1" colspan="1">87.30</td>
              <td rowspan="1" colspan="1">99.70</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">1000 reads</td>
              <td rowspan="1" colspan="1">63.00</td>
              <td rowspan="1" colspan="1">92.20</td>
            </tr>
            <tr>
              <td rowspan="5" colspan="1">K562</td>
              <td rowspan="1" colspan="1">150 000 reads</td>
              <td rowspan="1" colspan="1">95.20</td>
              <td rowspan="1" colspan="1">100.00</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">100 000 reads</td>
              <td rowspan="1" colspan="1">92.90</td>
              <td rowspan="1" colspan="1">100.00</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">50 000 reads</td>
              <td rowspan="1" colspan="1">90.80</td>
              <td rowspan="1" colspan="1">100.00</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">10 000 reads</td>
              <td rowspan="1" colspan="1">85.10</td>
              <td rowspan="1" colspan="1">99.50</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">1000 reads</td>
              <td rowspan="1" colspan="1">14.50</td>
              <td rowspan="1" colspan="1">94.80</td>
            </tr>
            <tr>
              <td rowspan="5" colspan="1">GM12878 batch1</td>
              <td rowspan="1" colspan="1">150 000 reads</td>
              <td rowspan="1" colspan="1">80.30</td>
              <td rowspan="1" colspan="1">90.00</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">100 000 reads</td>
              <td rowspan="1" colspan="1">74.70</td>
              <td rowspan="1" colspan="1">89.70</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">50 000 reads</td>
              <td rowspan="1" colspan="1">66.90</td>
              <td rowspan="1" colspan="1">90.00</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">10 000 reads</td>
              <td rowspan="1" colspan="1">41.20</td>
              <td rowspan="1" colspan="1">89.10</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">1000 reads</td>
              <td rowspan="1" colspan="1">14.40</td>
              <td rowspan="1" colspan="1">79.70</td>
            </tr>
            <tr>
              <td rowspan="5" colspan="1">GM12878 batch2</td>
              <td rowspan="1" colspan="1">150 000 reads</td>
              <td rowspan="1" colspan="1">99.70</td>
              <td rowspan="1" colspan="1">100.00</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">100 000 reads</td>
              <td rowspan="1" colspan="1">99.60</td>
              <td rowspan="1" colspan="1">100.00</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">50 000 reads</td>
              <td rowspan="1" colspan="1">98.40</td>
              <td rowspan="1" colspan="1">100.00</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">10 000 reads</td>
              <td rowspan="1" colspan="1">92.80</td>
              <td rowspan="1" colspan="1">100.00</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">1000 reads</td>
              <td rowspan="1" colspan="1">46.10</td>
              <td rowspan="1" colspan="1">96.60</td>
            </tr>
            <tr>
              <td rowspan="5" colspan="1">H1 batch1</td>
              <td rowspan="1" colspan="1">150 000 reads</td>
              <td rowspan="1" colspan="1">98.30</td>
              <td rowspan="1" colspan="1">100.00</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">100 000 reads</td>
              <td rowspan="1" colspan="1">98.00</td>
              <td rowspan="1" colspan="1">100.00</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">50 000 reads</td>
              <td rowspan="1" colspan="1">97.40</td>
              <td rowspan="1" colspan="1">100.00</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">10 000 reads</td>
              <td rowspan="1" colspan="1">96.20</td>
              <td rowspan="1" colspan="1">100.00</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">1000 reads</td>
              <td rowspan="1" colspan="1">50.00</td>
              <td rowspan="1" colspan="1">99.40</td>
            </tr>
            <tr>
              <td rowspan="5" colspan="1">H1 batch2</td>
              <td rowspan="1" colspan="1">150 000 reads</td>
              <td rowspan="1" colspan="1">100.00</td>
              <td rowspan="1" colspan="1">100.00</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">100 000 reads</td>
              <td rowspan="1" colspan="1">100.00</td>
              <td rowspan="1" colspan="1">100.00</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">50 000 reads</td>
              <td rowspan="1" colspan="1">100.00</td>
              <td rowspan="1" colspan="1">100.00</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">10 000 reads</td>
              <td rowspan="1" colspan="1">99.60</td>
              <td rowspan="1" colspan="1">100.00</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">1000 reads</td>
              <td rowspan="1" colspan="1">59.30</td>
              <td rowspan="1" colspan="1">99.10</td>
            </tr>
          </tbody>
        </table>
        <table-wrap-foot>
          <fn id="tblfn1">
            <p><italic>Note</italic>: The recalls at depths varying from 1000 read up to 150 000 reads calculated (i) only using detected genes or (ii) using all genes. Average recalls of 10 random down-samplings are shown for each. Batch1 and batch2 correspond to biological replicates. Annotation recall is calculated as in <xref rid="btz292-T1" ref-type="table">Table 1</xref>.</p>
          </fn>
        </table-wrap-foot>
      </table-wrap>
    </sec>
    <sec>
      <title>2.2 Highly expressed and lineage-specific gene lists</title>
      <p>Highly expressed and lineage-specific genes were extracted from the FANTOM5 expression atlas. The 4129 highly expressed genes correspond to those detected in the FANTOM5 atlas with maximum expression ≥500 tags per million. The 272 lineage-specific genes were manually curated by examining the expression profiles of genes with maximum expression in the FANTOM5 atlas above 100 tags per million (115 are expressed above 5000 Transcripts Per Million (TPM). Note, the default in scMatch is to use all genes; however users are also able to provide custom gene lists if desired.</p>
    </sec>
    <sec>
      <title>2.3 Reference datasets used in scMatch and SingleR</title>
      <p>Reference gene expression data were collected from FANTOM5, SingleR’s Github repository (<ext-link ext-link-type="uri" xlink:href="https://github.com/dviraran/SingleR">https://github.com/dviraran/SingleR</ext-link>) and UCSC Xena Cancer browser (<ext-link ext-link-type="uri" xlink:href="https://xenabrowser.net">https://xenabrowser.net</ext-link>). For the FANTOM5 data 916 human samples (660 primary cell samples and 256 cancer cell line samples were used) and 821 mouse samples (302 tissue samples, 471 primary cell samples and 48 cancer cell line samples) were prepared as high-quality reference datasets [low read count, low-quality samples were excluded as were samples that could not inform on cell type (e.g. lung, testis)]. Cell ontology terms for the FANTOM5 samples were downloaded from the consortium website and underwent further manual annotation. These are available here <ext-link ext-link-type="uri" xlink:href="https://github.com/forrest-lab/scMatch/tree/master/refDB/FANTOM5">https://github.com/forrest-lab/scMatch/tree/master/refDB/FANTOM5</ext-link>. 972 human samples and 1188 mouse samples in SingleR’s reference dataset were extracted from R data files (<ext-link ext-link-type="uri" xlink:href="https://github.com/dviraran/SingleR/tree/master/data">https://github.com/dviraran/SingleR/tree/master/data</ext-link>). Bulk tumour RNA-seq data for 474 melanoma and 172 glioblastoma samples in The Cancer Genome Atlas (TCGA) were downloaded from the UCSC Xena Cancer browser. Note, we provide several of these reference databases via GitHub but users are also able to use their own custom reference databases. The list of samples used in each analysis is provided in <xref ref-type="supplementary-material" rid="sup1">Supplementary Table S9</xref>.</p>
    </sec>
    <sec>
      <title>2.4 Single-cell datasets</title>
      <p>Test scRNA-seq data were collected from NCBI GEO (Li <italic>et al.</italic> cell line data GSE81861; Tirosh <italic>et al.</italic> melanoma data GSE72056, and from the 10X Genomics website [peripheral blood mononuclear cells (PBMCs), <ext-link ext-link-type="uri" xlink:href="https://support.10xgenomics.com/single-cell-gene-expression/datasets">https://support.10xgenomics.com/single-cell-gene-expression/datasets</ext-link>).</p>
    </sec>
    <sec>
      <title>2.5 Single-cell data annotation using scMatch and SingleR</title>
      <p>The evaluation was conducted on a virtual machine equipped with 16 vCPUs and 48 GB of RAM. We ran scMatch using two correlation measures (Pearson and Spearman coefficients) and three subsets of genes (i) all genes in the FANTOM5 atlas (22 049 genes), (ii) highly expressed genes (detected in the FANTOM5 atlas with maximum expression ≥500 tags per million, 4129 genes) and (iii) manually curated lineage-specific genes from the FANTOM5 atlas (272 genes). The top matched samples returned by scMatch were used to evaluate the annotation recalls. SingleR (version 0.1.0) was run following the authors’ instructions and the fine-tuned results were used to evaluate the annotation recalls.</p>
    </sec>
    <sec>
      <title>2.6 Software implementation</title>
      <p>scMatch is written in Python, it can load gene expression data in CSV files or produced by 10X Genomics platform and then annotate them in parallel using any reference datasets. The resulting outputs are stored in Excel and CSV files.</p>
    </sec>
  </sec>
  <sec>
    <title>3 Results</title>
    <sec>
      <title>3.1 Evaluating annotation of high coverage scRNA-seq data from cell lines by comparison to the FANTOM5 reference database</title>
      <p>To explore methods for direct annotation of single cell expression profiles using previously published bulk expression datasets as reference databases, we first attempted to annotate single cell expression profiles of cell lines using the FANTOM5 expression atlas as a reference. Using single cell data generated by <xref rid="btz292-B15" ref-type="bibr">Li <italic>et al.</italic> (2017)</xref> (profiled using the SMARTer Ultra-Low RNA Kit platform) we calculated Spearman and Pearson correlations between single cell expression profiles of four cell lines (A549, K562, GM12878, H1 Human embryonic stem cells) and 1829 bulk expression profiles from the FANTOM5 project (<xref rid="btz292-B16" ref-type="bibr">Lizio <italic>et al.</italic>, 2017</xref>). We chose to focus on these four cell lines as corresponding bulk expression profiles were available in the FANTOM5 atlas. We considered a single cell correctly annotated if the best correlation corresponded to the matching cell line in FANTOM5 (<xref rid="btz292-T1" ref-type="table">Table 1</xref>). Note for the human embryonic stem cells we considered any match to any human embryonic stem cell lines and human induced pluripotent stem cells in FANTOM5 as a correct annotation. We also took advantage of biological replicates of H1 and GM12878 cells provided in the Li <italic>et al.</italic> paper to examine reproducibility.
</p>
      <table-wrap id="btz292-T1" orientation="portrait" position="float">
        <label>Table 1.</label>
        <caption>
          <p>Annotation recalls of scMatch on four deeply profiled cell lines</p>
        </caption>
        <table frame="hsides" rules="groups">
          <colgroup span="1">
            <col valign="top" align="left" span="1"/>
            <col valign="top" align="char" char="." span="1"/>
            <col valign="top" align="char" char="." span="1"/>
            <col valign="top" align="char" char="." span="1"/>
            <col valign="top" align="char" char="." span="1"/>
          </colgroup>
          <thead>
            <tr>
              <th rowspan="2" colspan="1"/>
              <th colspan="2" rowspan="1">Remove zeros<hr/></th>
              <th colspan="2" rowspan="1">Keep zeros<hr/></th>
            </tr>
            <tr>
              <th rowspan="1" colspan="1">Spearman (%)</th>
              <th rowspan="1" colspan="1">Pearson (%)</th>
              <th rowspan="1" colspan="1">Spearman (%)</th>
              <th rowspan="1" colspan="1">Pearson (%)</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td rowspan="1" colspan="1">A549</td>
              <td rowspan="1" colspan="1">100.00</td>
              <td rowspan="1" colspan="1">14.90</td>
              <td rowspan="1" colspan="1">100.00</td>
              <td rowspan="1" colspan="1">45.90</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">K562</td>
              <td rowspan="1" colspan="1">95.90</td>
              <td rowspan="1" colspan="1">1.40</td>
              <td rowspan="1" colspan="1">100.00</td>
              <td rowspan="1" colspan="1">20.50</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">GM12878 batch1</td>
              <td rowspan="1" colspan="1">81.20</td>
              <td rowspan="1" colspan="1">0.00</td>
              <td rowspan="1" colspan="1">93.80</td>
              <td rowspan="1" colspan="1">0.00</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">GM12878 batch2</td>
              <td rowspan="1" colspan="1">100.00</td>
              <td rowspan="1" colspan="1">50.00</td>
              <td rowspan="1" colspan="1">100.00</td>
              <td rowspan="1" colspan="1">57.30</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">H1 batch1</td>
              <td rowspan="1" colspan="1">100.00</td>
              <td rowspan="1" colspan="1">82.60</td>
              <td rowspan="1" colspan="1">100.00</td>
              <td rowspan="1" colspan="1">94.20</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">H1 batch2</td>
              <td rowspan="1" colspan="1">100.00</td>
              <td rowspan="1" colspan="1">84.40</td>
              <td rowspan="1" colspan="1">100.00</td>
              <td rowspan="1" colspan="1">96.90</td>
            </tr>
          </tbody>
        </table>
        <table-wrap-foot>
          <fn id="tblfn2">
            <p><italic>Note</italic>: Spearman’s and Pearson’s correlation coefficients were calculated between individual cells from the <xref rid="btz292-B15" ref-type="bibr">Li <italic>et al.</italic> (2017)</xref> dataset and all FANTOM5 samples, using either all genes (keep zeros), or detected genes only (remove zeros). An annotation was considered correct if the matching cell type in FANTOM5 had the highest correlation. Annotation recall is calculated as the number of cells that were correctly annotated by scMatch divided by the total number of cells of that type in the Li <italic>et al.</italic> dataset. The number of single cells for each cell line is: A549: 74 cells, K562: 73 cells, GM12878 batch1: 32 cells, GM12878 batch12: 96 cells, H1 batch1: 69 cells and H1 batch2: 96 cells. Batch1 and batch2 correspond to biological replicates.</p>
          </fn>
        </table-wrap-foot>
      </table-wrap>
      <p>From this comparison we found Spearman’s correlation coefficient outperformed Pearson’s correlation for all six libraries. Specifically, the annotation recalls for A549, K562, GM12878 (Batch 2) and the two H1 human embryonic stem cell batches were 100%, while that for GM12878 (Batch 1) was 93.75% (30 cells out of 32) (<xref rid="btz292-T1" ref-type="table">Table 1</xref>, <xref ref-type="supplementary-material" rid="sup1">Supplementary Table S1</xref>). We also carried out a parallel analysis where the correlations were only calculated using the genes detected in each cell (i.e. genes detected in FANTOM5 but not in the query cell were not used in the calculation of the correlation). However using all genes and Spearman’s correlation coefficient provided the best recalls (<xref rid="btz292-T1" ref-type="table">Table 1</xref>).</p>
    </sec>
    <sec>
      <title>3.2 Impact of sequencing depth on annotation recall</title>
      <p>In the above analysis, the median number of reads per cell was 2 029 222. Our method achieved a high recall on this high sequencing depth data; however, drop-seq-based experimental techniques typically sequence single cells at much lower depths. For example, 10× genomics recommend 20–50 000 reads per cell and Pollen <italic>et al.</italic> have reported that 50 000 reads per cell is sufficient to annotate cells correctly using expressed canonical marker genes (<xref rid="btz292-B20" ref-type="bibr">Pollen <italic>et al.</italic>, 2014</xref>). We, therefore, down-sampled the Li <italic>et al.</italic> cell line data used above to various fixed read depths per cell, to explore how the sequencing depth affected the annotation (Section 2).</p>
      <p>As expected, cells with more reads were more likely to be correctly classified than those down-sampled to lower read depths (<xref rid="btz292-T2" ref-type="table">Table 2</xref>, <xref ref-type="supplementary-material" rid="sup1">Supplementary Fig. S1</xref> and <xref ref-type="supplementary-material" rid="sup1">Supplementary Table S2</xref>). As in <xref rid="btz292-T1" ref-type="table">Table 1</xref>, using all genes (rather than filtering out genes with zero values) yielded the highest recalls. This effect was more apparent at lower reads depths, e.g. when GM12878 Batch 1 was down-sampled to 1000 reads the recall using all genes was 79% but when zeros were filtered out this dropped to 14%. Notably, when zeros were kept, the other five libraries still had high recalls ranging from 92 to 99% at this lowest depth of 1000 reads per cell. In terms of misclassifications, these typically were of closely related cells. For example, single cells from Batch 1 of the lymphoblastoid B cell line GM12878 were sometimes misannotated as primary B cells or other B cell lines (<xref ref-type="supplementary-material" rid="sup1">Supplementary Table S3</xref>). Last, decreasing the sequencing depth affected recall of different cell types to different degrees reflecting the different ranges of correlations observed for each cell type and differences in the number of similar (but distinct) cell types in the reference database. This has important implications for cell classification. Both sequencing depth and the cell type considered affect the classification performance.</p>
    </sec>
    <sec>
      <title>3.3. Annotation of PBMCs profiled using the 10X genomics platform</title>
      <p>Next to evaluate scMatch on authentic low-depth data, we assessed the performance of our method on a low-sequencing depth dataset obtained from 10 bead purified sub-populations of PBMCs profiled using the 10X genomics chromium 3’ assay (<xref rid="btz292-B36" ref-type="bibr">Zheng <italic>et al.</italic>, 2017</xref>). In this dataset, each cell was sequenced to a depth of ∼20 000 raw reads which translates to medians of 525 genes and 1300 unique molecular identifier counts per cell.</p>
      <p>To determine whether the classification accuracy of scMatch could be improved by using different subsets of genes, we compared the annotations using correlations calculated using (i) All reference genes (22 049 genes) to those obtained using either (ii) Highly expressed genes (detected in the FANTOM5 atlas with maximum expression ≥ 500 tags per million, 4129 genes) or (iii) Manually curated lineage-specific genes from the FANTOM5 atlas (272 genes). To score the annotation accuracy using each gene list we first attempted to map the ten PBMC sub-populations studied in the original publication to their corresponding primary cell types in the FANTOM5 reference dataset (445 primary cell samples, <xref ref-type="supplementary-material" rid="sup1">Supplementary Table S9</xref>). For all except CD8+CD45RA+ Naïve cytotoxic T cells we were able to find a corresponding sample in FANTOM5 (<xref ref-type="supplementary-material" rid="sup1">Supplementary Table S4</xref>).</p>
      <p>For four of the nine PBMC sub-populations with matching samples in FANTOM5, cell annotation using Spearman’s correlation coefficients yielded the best recalls; CD19+ B cells, CD8+ cytotoxic T cells, CD14+ monocytes were best annotated using all genes, while CD34+ haematopoietic stem cells were equally well annotated using all genes or using only highly expressed genes (from <xref rid="btz292-T3" ref-type="table">Table 3</xref> and <xref ref-type="supplementary-material" rid="sup1">Supplementary Table S5</xref>). For the other five sub-populations (T cell subsets and NK cells) Pearson’s correlation coefficients, with various gene lists, yielded better recalls. In particular CD4+ helper T cells, CD4+/CD45RA+/CD25− Naïve T cells and CD4+/CD25+ Regulatory T cells had recalls above 50% using either all genes or highly expressed genes. In contrast CD56+ NK cells and CD4+/CD45RO+ Memory T cells had poor recall regardless of the correlation method or the gene sets used.
</p>
      <table-wrap id="btz292-T3" orientation="portrait" position="float">
        <label>Table 3.</label>
        <caption>
          <p>Annotation of 93 655 PBMC cells profiled on the 10X platform</p>
        </caption>
        <table frame="hsides" rules="groups">
          <colgroup span="1">
            <col valign="top" align="left" span="1"/>
            <col valign="top" align="char" char="." span="1"/>
            <col valign="top" align="char" char="." span="1"/>
            <col valign="top" align="char" char="." span="1"/>
            <col valign="top" align="char" char="." span="1"/>
            <col valign="top" align="char" char="." span="1"/>
            <col valign="top" align="char" char="." span="1"/>
          </colgroup>
          <thead>
            <tr>
              <th rowspan="2" colspan="1"/>
              <th colspan="2" rowspan="1">Specific genes<hr/></th>
              <th colspan="2" rowspan="1">Highly expressed genes<hr/></th>
              <th colspan="2" rowspan="1">All genes<hr/></th>
            </tr>
            <tr>
              <th rowspan="1" colspan="1">Pearson (%)</th>
              <th rowspan="1" colspan="1">Spearman (%)</th>
              <th rowspan="1" colspan="1">Pearson (%)</th>
              <th rowspan="1" colspan="1">Spearman (%)</th>
              <th rowspan="1" colspan="1">Pearson (%)</th>
              <th rowspan="1" colspan="1">Spearman (%)</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td rowspan="1" colspan="1">CD4+/CD25+ regulatory T cells</td>
              <td rowspan="1" colspan="1">37.7</td>
              <td rowspan="1" colspan="1">8.4</td>
              <td rowspan="1" colspan="1">55.6</td>
              <td rowspan="1" colspan="1">53.2</td>
              <td rowspan="1" colspan="1">59.7</td>
              <td rowspan="1" colspan="1">19.3</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">CD8+ cytotoxic T cells</td>
              <td rowspan="1" colspan="1">30.7</td>
              <td rowspan="1" colspan="1">37.5</td>
              <td rowspan="1" colspan="1">2.0</td>
              <td rowspan="1" colspan="1">76.4</td>
              <td rowspan="1" colspan="1">2.0</td>
              <td rowspan="1" colspan="1">98.3</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">CD19+ B cells</td>
              <td rowspan="1" colspan="1">92.0</td>
              <td rowspan="1" colspan="1">41.5</td>
              <td rowspan="1" colspan="1">38.1</td>
              <td rowspan="1" colspan="1">99.9</td>
              <td rowspan="1" colspan="1">37.4</td>
              <td rowspan="1" colspan="1">100.0</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">CD56+ NK cells</td>
              <td rowspan="1" colspan="1">0.6</td>
              <td rowspan="1" colspan="1">4.9</td>
              <td rowspan="1" colspan="1">22.9</td>
              <td rowspan="1" colspan="1">0.0</td>
              <td rowspan="1" colspan="1">20.6</td>
              <td rowspan="1" colspan="1">0.0</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">CD4+ helper T cells</td>
              <td rowspan="1" colspan="1">55.5</td>
              <td rowspan="1" colspan="1">68.1</td>
              <td rowspan="1" colspan="1">98.2</td>
              <td rowspan="1" colspan="1">30.0</td>
              <td rowspan="1" colspan="1">98.4</td>
              <td rowspan="1" colspan="1">5.8</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">CD14+ monocytes</td>
              <td rowspan="1" colspan="1">10.7</td>
              <td rowspan="1" colspan="1">78.8</td>
              <td rowspan="1" colspan="1">28.0</td>
              <td rowspan="1" colspan="1">42.9</td>
              <td rowspan="1" colspan="1">27.5</td>
              <td rowspan="1" colspan="1">78.8</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">CD34+ cells</td>
              <td rowspan="1" colspan="1">0.8</td>
              <td rowspan="1" colspan="1">4.4</td>
              <td rowspan="1" colspan="1">56.3</td>
              <td rowspan="1" colspan="1">83.0</td>
              <td rowspan="1" colspan="1">36.0</td>
              <td rowspan="1" colspan="1">82.8</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">CD4+/CD45RO+ memory T cells</td>
              <td rowspan="1" colspan="1">44.0</td>
              <td rowspan="1" colspan="1">0.5</td>
              <td rowspan="1" colspan="1">26.3</td>
              <td rowspan="1" colspan="1">12.7</td>
              <td rowspan="1" colspan="1">28.5</td>
              <td rowspan="1" colspan="1">5.4</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">CD4+/CD45RA+/CD25− naive T cells</td>
              <td rowspan="1" colspan="1">11.1</td>
              <td rowspan="1" colspan="1">51.0</td>
              <td rowspan="1" colspan="1">86.6</td>
              <td rowspan="1" colspan="1">5.5</td>
              <td rowspan="1" colspan="1">85.9</td>
              <td rowspan="1" colspan="1">7.7</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">CD8+/CD45RA+ naive cytotoxic T cells</td>
              <td rowspan="1" colspan="1">29.7</td>
              <td rowspan="1" colspan="1">35.8</td>
              <td rowspan="1" colspan="1">0.0</td>
              <td rowspan="1" colspan="1">86.5</td>
              <td rowspan="1" colspan="1">0.0</td>
              <td rowspan="1" colspan="1">99.1</td>
            </tr>
          </tbody>
        </table>
        <table-wrap-foot>
          <fn id="tblfn3">
            <p><italic>Note</italic>: The relative recalls for PBMCs when annotated using scMatch with the FANTOM5 dataset as a reference. (i) Pearson’s correlation coefficient and (ii) Spearman’s correlation. Accuracy calculated using different gene lists is shown [(i) All reference set genes (22 049 genes), (ii) Highly expressed genes (detected in the FANTOM5 atlas with maximum expression ≥500 tags per million, 4129 genes) and (iii) Manually curated lineage-specific genes from the FANTOM5 atlas (272 genes)]. Annotation recall is calculated as the number of cells that were correctly annotated by scMatch divided by the total number of cells of that type in the <xref rid="btz292-B36" ref-type="bibr">Zheng <italic>et al.</italic> (2017)</xref> dataset.</p>
          </fn>
        </table-wrap-foot>
      </table-wrap>
      <p>Next we evaluated the use of the ‘ontology-mode’ (using Spearman’s correlations on all genes, <xref ref-type="fig" rid="btz292-F1">Fig. 1</xref>) to annotate this dataset. To do this we used the cell ontology (CL) annotations provided in the FANTOM5 atlas. For each single cell, correlations against reference samples in FANTOM5 with the same cell ontology annotation were averaged, and then cell ontology matches were sorted based on the average correlation. The results for Spearman correlations are summarized in <xref ref-type="supplementary-material" rid="sup1">Supplementary Table S6</xref>. As expected, for cell types where we already had high recall their annotations did not dramatically change. For example, almost 100% of B-cells were annotated as CL: 0000236: B cell, and 83% of CD34+ cells were annotated as CL: 0000037: hematopoietic stem cell. However, for multiple cell types the annotation recalls improved in ontology-mode. E.g. CD14+ monocytes achieved a recall of 78.8% in top-match mode but 94.3% were annotated as CL: 0002397: CD14-positive, CD16-positive monocyte in ontology mode, similarly CD4+/CD45RO+ Memory T cells only achieved a recall of 5.4% in top-match mode, but 45.9% were correctly annotated as CL: 0002678: memory regulatory T cell in ontology mode while the remainder mapped to other CD4+ subsets (30% were annotated as CL: 0002677: naive regulatory T cell and 21% as CL: 0000897: CD4-positive, alpha-beta memory T cell) (<xref ref-type="supplementary-material" rid="sup1">Supplementary Table S6</xref>). We envisage ‘ontology-mode’ will be useful to give an indication of the cell lineage when a cell type that is not in the reference database needs to be annotated.</p>
    </sec>
    <sec>
      <title>3.4 Performance of scMatch and SingleR using identical reference databases</title>
      <p>Recently <xref rid="btz292-B1" ref-type="bibr">Aran <italic>et al.</italic> (2019)</xref> presented an R package SingleR similar in concept to scMatch. For human cell annotation, SingleR uses 259 bulk RNA-seq samples from the BLUEPRINT (<xref rid="btz292-B7" ref-type="bibr">Fernandez <italic>et al.</italic>, 2016</xref>) and ENCODE (<xref rid="btz292-B26" ref-type="bibr">Sloan <italic>et al.</italic>, 2016</xref>) projects and 713 bulk microarray samples from the Human Primary Cell Atlas (HPCA) (<xref rid="btz292-B17" ref-type="bibr">Mabbott <italic>et al.</italic>, 2013</xref>) as reference expression data. To compare the performance of scMatch (Spearman’s correlation, all genes) to SingleR we annotated all cells from the 10X PBMC dataset above using both methods with either (i) BLUEPRINT + ENCODE, (ii) HPCA, (iii) BLUEPRINT + ENCODE + HPCA or (iv) BLUEPRINT + ENCODE + HPCA + FANTOM5 as reference databases (see <xref rid="btz292-T4" ref-type="table">Table 4</xref>, <xref ref-type="supplementary-material" rid="sup1">Supplementary Table S6</xref>).
</p>
      <table-wrap id="btz292-T4" orientation="portrait" position="float">
        <label>Table 4.</label>
        <caption>
          <p>The recalls of annotating the PBMCs using scMatch and SingleR using ENCODE, BLUEPRINT and HPCA datasets</p>
        </caption>
        <table frame="hsides" rules="groups">
          <colgroup span="1">
            <col valign="top" align="left" span="1"/>
            <col valign="top" align="char" char="." span="1"/>
            <col valign="top" align="char" char="." span="1"/>
            <col valign="top" align="char" char="." span="1"/>
            <col valign="top" align="char" char="." span="1"/>
            <col valign="top" align="char" char="." span="1"/>
            <col valign="top" align="char" char="." span="1"/>
            <col valign="top" align="char" char="." span="1"/>
          </colgroup>
          <thead>
            <tr>
              <th rowspan="2" colspan="1"/>
              <th colspan="2" rowspan="1">BLUEPRINT+ENCODE<hr/></th>
              <th colspan="2" rowspan="1">HPCA<hr/></th>
              <th colspan="2" rowspan="1">BLUEPRINT+ENCODE +HPCA<hr/></th>
              <th rowspan="1" colspan="1">BLUEPRINT+ENCODE +HPCA+FANTOM5</th>
            </tr>
            <tr>
              <th rowspan="1" colspan="1">SingleR (%)</th>
              <th rowspan="1" colspan="1">scMatch (%)</th>
              <th rowspan="1" colspan="1">SingleR (%)</th>
              <th rowspan="1" colspan="1">scMatch (%)</th>
              <th rowspan="1" colspan="1">SingleR (%)</th>
              <th rowspan="1" colspan="1">scMatch (%)</th>
              <th rowspan="1" colspan="1">scMatch (%)</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td rowspan="1" colspan="1">CD4+/CD25+ Regulatory T cells</td>
              <td rowspan="1" colspan="1">42.8</td>
              <td rowspan="1" colspan="1">28.1</td>
              <td rowspan="1" colspan="1">0.0</td>
              <td rowspan="1" colspan="1">0.0</td>
              <td rowspan="1" colspan="1">43.1</td>
              <td rowspan="1" colspan="1">37.9</td>
              <td rowspan="1" colspan="1">39.0</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">CD8+ Cytotoxic T cells</td>
              <td rowspan="1" colspan="1">82.7</td>
              <td rowspan="1" colspan="1">27.5</td>
              <td rowspan="1" colspan="1">18.0</td>
              <td rowspan="1" colspan="1">8.9</td>
              <td rowspan="1" colspan="1">34.0</td>
              <td rowspan="1" colspan="1">43.0</td>
              <td rowspan="1" colspan="1">44.8</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">CD19+ B cells</td>
              <td rowspan="1" colspan="1">99.9</td>
              <td rowspan="1" colspan="1">66.5</td>
              <td rowspan="1" colspan="1">100.0</td>
              <td rowspan="1" colspan="1">99.9</td>
              <td rowspan="1" colspan="1">90.5</td>
              <td rowspan="1" colspan="1">99.0</td>
              <td rowspan="1" colspan="1">99.2</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">CD56+ NK cells</td>
              <td rowspan="1" colspan="1">99.2</td>
              <td rowspan="1" colspan="1">95.8</td>
              <td rowspan="1" colspan="1">95.1</td>
              <td rowspan="1" colspan="1">93.3</td>
              <td rowspan="1" colspan="1">95.0</td>
              <td rowspan="1" colspan="1">98.4</td>
              <td rowspan="1" colspan="1">98.5</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">CD4+ Helper T cells</td>
              <td rowspan="1" colspan="1">94.5</td>
              <td rowspan="1" colspan="1">86.4</td>
              <td rowspan="1" colspan="1">99.5</td>
              <td rowspan="1" colspan="1">99.5</td>
              <td rowspan="1" colspan="1">93.5</td>
              <td rowspan="1" colspan="1">98.2</td>
              <td rowspan="1" colspan="1">97.9</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">CD14+ Monocytes</td>
              <td rowspan="1" colspan="1">98.1</td>
              <td rowspan="1" colspan="1">95.5</td>
              <td rowspan="1" colspan="1">83.2</td>
              <td rowspan="1" colspan="1">95.6</td>
              <td rowspan="1" colspan="1">96.4</td>
              <td rowspan="1" colspan="1">97.6</td>
              <td rowspan="1" colspan="1">97.7</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">CD34+ cells</td>
              <td rowspan="1" colspan="1">84.6</td>
              <td rowspan="1" colspan="1">88.2</td>
              <td rowspan="1" colspan="1">80.4</td>
              <td rowspan="1" colspan="1">85.3</td>
              <td rowspan="1" colspan="1">88.5</td>
              <td rowspan="1" colspan="1">85.7</td>
              <td rowspan="1" colspan="1">85.3</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">CD4+/CD45RO+ Memory T cells</td>
              <td rowspan="1" colspan="1">75.4</td>
              <td rowspan="1" colspan="1">80.8</td>
              <td rowspan="1" colspan="1">95.3</td>
              <td rowspan="1" colspan="1">97.5</td>
              <td rowspan="1" colspan="1">73.1</td>
              <td rowspan="1" colspan="1">86.8</td>
              <td rowspan="1" colspan="1">86.0</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">CD4+/CD45RA+/CD25− Naive T cells</td>
              <td rowspan="1" colspan="1">N/A</td>
              <td rowspan="1" colspan="1">N/A</td>
              <td rowspan="1" colspan="1">85.3</td>
              <td rowspan="1" colspan="1">85.3</td>
              <td rowspan="1" colspan="1">0.0</td>
              <td rowspan="1" colspan="1">0.0</td>
              <td rowspan="1" colspan="1">0.0</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">CD8+/CD45RA+ Naive Cytotoxic T cells</td>
              <td rowspan="1" colspan="1">N/A</td>
              <td rowspan="1" colspan="1">N/A</td>
              <td rowspan="1" colspan="1">0.0</td>
              <td rowspan="1" colspan="1">0.0</td>
              <td rowspan="1" colspan="1">0.0</td>
              <td rowspan="1" colspan="1">0.0</td>
              <td rowspan="1" colspan="1">0.0</td>
            </tr>
          </tbody>
        </table>
        <table-wrap-foot>
          <fn id="tblfn4">
            <p><italic>Note</italic>: Comparison of scMatch and SingleR using different reference datasets. Annotation recall is calculated as in <xref rid="btz292-T3" ref-type="table">Table 3</xref>. (i) We used SingleR in fine-tuning mode, (ii) There are no matched reference samples in the BLUEPRINT + ENCODE database for CD4+/CD45RA+/CD25− Naïve T cells and CD8+/CD45RA+ Naïve cytotoxic T cells.</p>
          </fn>
        </table-wrap-foot>
      </table-wrap>
      <p>For the majority of cell types SingleR and scMatch had similar accuracy; however, the relative accuracy of each depended greatly on the reference database used (<xref rid="btz292-T4" ref-type="table">Table 4</xref>). For example, when using the ENCODE + BLUEPRINT RNA-seq data as reference, SingleR outperformed scMatch in six out of eight comparisons. When using HPCA as the reference SingleR had better recall twice, scMatch had better recall three times and there were three ties (defined as &lt;0.5% difference). Notably no regulatory T cells were correctly annotated when using the HPCA as reference. Last when using the combined BLUEPRINT+ENCODE+HPCA dataset as reference, scMatch outperformed SingleR six times, SingleR outperformed scMatch twice, and neither were able to correctly annotate the two Naïve T cell populations (these typically matched to bulk CD4 or CD8, respectively).</p>
      <p>To demonstrate scMatch’s usage on a large reference dataset, we next merged BLUEPRINT+ENCODE+HPCA and FANTOM5 into a single reference dataset of 1417 samples and used it to annotate the PBMCs. For six of the cell types the annotations obtained by scMatch using BLUEPRINT+ENCODE+HPCA+FANTOM5 and BLUEPRINT+ENCODE+HPCA were comparable (&lt;0.5% difference) however for the CD4+/CD25+ Regulatory T cells and the CD8+ Cytotoxic T cells there were increases in recall of 1.07 and 1.81%, respectively (<xref rid="btz292-T4" ref-type="table">Table 4</xref>). We also examined the impact of increasing the number of reference samples on false positive rates and found that the higher recalls observed with more reference samples were accompanied with high precision (<xref ref-type="supplementary-material" rid="sup1">Supplementary Table S7</xref>). Thus incorporating more reference samples improved the performance of scMatch.</p>
      <p>In terms of run times. When we used BLUEPRINT+ENCODE+ HPCA as the reference dataset, on virtual machines with identical resources (16 vCPUs and 48 GB of RAM), scMatch was able to use up to 10 CPUs and took 40.5 h to annotate all 93 655 PBMCs while SingleR was only able to utilize at most two CPUs and took 193 h. This is largely because scMatch uses memory more efficiently. This may also explain why we were unable to load the combined BLUEPRINT+ENCODE+HPCA+ FANTOM5 dataset into SingleR to assess its performance.</p>
    </sec>
    <sec>
      <title>3.5 Application of scMatch to cancer datasets</title>
      <p>Previously, <xref rid="btz292-B32" ref-type="bibr">Tirosh <italic>et al.</italic> (2016)</xref> deeply sequenced 4645 single cells from 19 human melanoma tumours of various clinical and therapeutic backgrounds and detected the identities of these cells through flow cytometry, genetic and transcriptional profiles. Using scMatch and Spearman correlations we next annotated this dataset by comparison against the 916 FANTOM5 primary cells and cell lines, which include two melanoma cell lines (G-361 and COLO 679) and primary melanocytes. As shown in <xref ref-type="supplementary-material" rid="sup1">Supplementary Table S8</xref>, 94% of the cells (1187/1257) originally annotated as melanoma ‘malignant cells’ were annotated as either melanoma cells (31%) or melanocytes (63%).</p>
      <p>As a key step in single-cell analysis of tumour samples is the classification of cells as tumour or normal cells, we next assessed whether expansion of the reference database in scMatch by incorporating bulk RNA-seq datasets from TCGA) (<xref rid="btz292-B4" ref-type="bibr">Cancer Genome Atlas Network, 2015</xref>) would improve the discrimination of melanoma cells from melanocytes. To do this we added 474 bulk melanoma profiles and 172 bulk glioblastoma profiles (as an unrelated tumour type) to the FANTOM5 reference database (<xref ref-type="supplementary-material" rid="sup1">Supplementary Table S9</xref>).</p>
      <p>By adding these two bulk RNA-seq datasets and rerunning scMatch against this extended reference dataset, the majority of melanoma cells were now correctly annotated as melanoma (83.29%, 1047 cells out of 1257). We note only three cells in the dataset were now misannotated as glioblastoma (<xref ref-type="supplementary-material" rid="sup1">Supplementary Table S8</xref>). Additionally, three B cells and 36 T cells were now annotated as melanoma. Examining the scMatch results for these lymphocytes revealed they most closely matched melanoma lymph node metastases which are likely to contain large fractions of lymphocytes.</p>
      <p>Last, we investigated the expression of melanocytic markers in cells that were annotated as ‘malignant cells’, ‘non-malignant cells’ or ‘unresolved’ (based on Tirosh <italic>et al.</italic>’s inferred Copy Number Variation (CNV) and marker gene analyses from the original publication) and compared these to ‘melanoma’, ‘melanocyte’ and ‘other cell type’ annotations provided by scMatch (<xref ref-type="supplementary-material" rid="sup1">Supplementary Fig. S2</xref>). As expected, the majority of cells annotated by both Tirosh <italic>et al.</italic> as ‘malignant cells’ and by scMatch as melanocytic expressed high levels of the melanocytic markers <italic>MITF, PMEL, MLANA</italic> and <italic>TYR</italic>. Additionally 90 of the 132 cells labelled as ‘unresolved’ in the original publication, and 86 of the 416 cells labelled as ‘non-malignant cells’ were classified as melanoma cells or melanocytes by scMatch, the majority of which expressed melanocytic markers. Last, 14 cells classified as ‘malignant cells’ in the original publication were annotated as other cell types by scMatch. These are potentially misannotations in the original publication as they do not express <italic>TYR</italic> or <italic>MITF</italic> and only 1 expresses <italic>PMEL</italic> (<xref ref-type="supplementary-material" rid="sup1">Supplementary Fig. S2</xref>), but we cannot rule out dropout or mutations in these cells that inactivate these melanocytic markers. Together, this suggests that scMatch will be useful for annotation of tumour cells within single-cell datasets and that the power to correctly classify these cells may be improved by selective leveraging of large bulk tumour datasets such as TCGA.</p>
    </sec>
  </sec>
  <sec>
    <title>4 Discussion</title>
    <p>scRNA-seq is a rapidly evolving and increasingly popular technique for transcriptomic analysis of complex tissues. To reach its full potential, a reliable approach for cell type classification is required. Most contemporary approaches employ unsupervised clustering of cell expression profiles, followed by manual annotation of each cluster’s identity based on gene expression markers (<xref rid="btz292-B13" ref-type="bibr">Kim <italic>et al.</italic>, 2018</xref>; <xref rid="btz292-B27" ref-type="bibr">Svensson <italic>et al.</italic>, 2017</xref>). However, the unsupervised clustering algorithms are known to yield inconsistent results (<xref rid="btz292-B9" ref-type="bibr">Freytag <italic>et al.</italic>, 2018</xref>). Additionally, manual cluster annotation is subjective, non-scalable and non-reproducible. To overcome these limitations, we developed scMatch, a marker-free annotation programme for scRNA-seq data based on a test-to-reference per cell comparison.</p>
    <p>In development of scMatch, we first systematically compared the accuracy of the cell annotations using different similarity measures (Pearson’s versus Spearman’s correlation coefficients), different gene lists (all genes, cell type-specific genes and highly expressed genes) and with single-cell data at different sequencing depths. In most cases, Spearman’s rank correlation and using all genes yielded higher recall rates (<xref rid="btz292-T1" ref-type="table">Tables 1</xref> and <xref rid="btz292-T3" ref-type="table">3</xref>) and thus we recommend this option to users, red however for flexibility, we provide the user the options of using Pearson’s correlation and different user-defined sets of genes. To assess the impact of sequencing depth on the annotation recall, we performed cell type annotation of down-sampled human cell line data. As might be expected, annotation recall rates decreased with lower read depths; however, even when the depth was down-sampled to as low as 1000 reads, the recall rates were still high at 79–99% making scMatch a useful tool for annotating low-depth single-cell experiments (<xref rid="btz292-T2" ref-type="table">Table 2</xref>).</p>
    <p>scMatch is not the first tool to compare single cells to reference datasets. SingleR, recently introduced by Aran <italic>et al.</italic> uses a similar approach; however, scMatch has some advantages over SingleR. When using all genes (the best performing and recommended mode for scMatch) no pre-processing of test and reference gene expression data is required. It is also computationally more efficient as (i) the reference dataset is held in a simpler data structure which requires less memory and (ii) it does not incorporate a computationally intensive fine-tuning step. In terms of accuracy, the results were comparable between scMatch and SingleR (<xref rid="btz292-T4" ref-type="table">Table 4</xref>). However, when using the combined reference dataset of BLUEPRINT+ENCODE+HPCA, scMatch had higher recall than SingleR for 6 out of 10 PBMC cell types tested. A possible explanation as to why this occurs may be because SingleR calculates correlations only using the variable genes in the reference dataset. By combining samples from multiple reference datasets the set of variable genes identified by SingleR may change and thus affect the annotations. In contrast scMatch uses all genes as default, thus adding extra samples will not affect the correlations of existing samples. Additionally, scMatch offers ontology-mode which should be useful in cases where a matching cell type is absent but knowing cell lineage is still informative. Last, scMatch reports the sample in the reference dataset with the highest correlation, however these correlations vary with read depth in each cell and cell type considered (Supplementary Fig. S1). Currently we are unable to provide a meaningful confidence measure for annotations reported by scMatch. Cell types not present in the reference dataset will still be annotated with their closest match and closely related subtypes (e.g. T cells) may be difficult to discriminate.</p>
    <p>For these methods the reference dataset used has a large impact. For example, when the FANTOM5 primary cell dataset was used as a reference, natural killer cells were poorly annotated (<xref rid="btz292-T3" ref-type="table">Table 3</xref>), however, when the HPCA and BLUEPRINT+ENCODE were added, the recall approached 99% (<xref rid="btz292-T4" ref-type="table">Table 4</xref>). This was also associated with high precision (<xref ref-type="supplementary-material" rid="sup1">Supplementary Table S7</xref>). Similarly when we extended the reference dataset to include bulk tumour data from the TCGA the annotation of melanoma cells improved (<xref ref-type="supplementary-material" rid="sup1">Supplementary Fig. S2</xref>). We note however there are several considerations in regards to the reference dataset, including (i) the relative representation of each cell type, (ii) the desired granularity of cell types represented, (iii) the quality of the reference samples and (iv) the inclusion of reference datasets generated using different platform technologies.</p>
    <p>In principle, the addition of more reference samples for the same cell type should provide a better representation of the diversity within a cell type, but it also has the potential to increase the number of cells hitting this cell type by chance. When annotating PBMCs using the FANTOM5 references we saw no relationship between the total number of matched reference samples and recall rates (<xref ref-type="supplementary-material" rid="sup1">Supplementary Table S5</xref>). For example for CD4+ helper T cells, there were 26 reference samples but only a recall rate of 5.75% (Spearman all genes). In contrast, the CD34+ stem cells which only had five reference samples had a recall of 82.83%. Importantly adding a large number of reference samples corresponding to a cell type absent from the test dataset (172 bulk glioblastoma RNA-seq samples) introduced very few mis-annotations with only 3 of the 4645 cells in the melanoma dataset, mis-annotated as glioblastoma. We note, although CAGE, RNA-seq and microarrays have different dynamic ranges and biases, the inclusion of reference datasets measured on these different platforms improved the recall rates for both the PBMCs and the melanoma dataset. We attribute this to the meta-dataset containing a better coverage of cell states than any of the single datasets alone. Thus for the novice user we recommend to use all available relevant databases. Specifically, for normal tissues and primary cells we recommend using all available primary cell data, while for tumour samples inclusion of cell lines and bulk tumour samples is recommended to identify tumour cells.</p>
    <p>In conclusion, with the availability of large numbers of single cell datasets over the coming years, driven by the Human Cell Atlas (<xref rid="btz292-B21" ref-type="bibr">Regev <italic>et al.</italic>, 2018</xref>) and others (<xref rid="btz292-B11" ref-type="bibr">Han <italic>et al.</italic>, 2018</xref>; <xref rid="btz292-B28" ref-type="bibr">Tabula Muris <italic>et al.</italic>, 2018</xref>), scalable methods such as scMatch are needed for cell classification. Conversely, the cell types identified and their expression profiles in these atlases can be fed in as reference datasets to improve the annotation of future experiments.</p>
  </sec>
  <sec>
    <title>Funding</title>
    <p>This work was carried out with the support of a collaborative cancer research grant provided by the Cancer Research Trust ‘Enabling advanced single-cell cancer genomics in Western Australia’ and a grant from the Cancer Council of Western Australia. R.H. is supported by an Australian Government Research Training Programme (RTP) Scholarship. A.F. was supported by funds raised by the MACA Ride to Conquer Cancer and a Senior Cancer Research Fellowship from the Cancer Research Trust. A.F. is currently supported by an Australian National Health and Medical Research Council Fellowship [APP1154524]. Analysis was made possible with computational resources provided by the Pawsey Supercomputing Centre with funding from the Australian Government and the Government of Western Australia.</p>
    <sec>
      <title>Author contributions</title>
      <p>R.H. implemented scMatch in python, carried out all analyses and generated all figures and tables. A.R.R.F. designed the study. R.H., E.D. and A.R.R.F. wrote the article. All authors have read and approved of the final version of the article.</p>
      <p><italic>Conflict of Interest</italic>: none declared.</p>
    </sec>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material content-type="local-data" id="sup1">
      <label>btz292_Supplementary_Materials</label>
      <media xlink:href="btz292_supplementary_materials.zip">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <ref-list id="ref1">
    <title>References</title>
    <ref id="btz292-B1">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Aran</surname><given-names>D.</given-names></name></person-group><etal>et al</etal> (<year>2019</year>) 
<article-title>Reference-based analysis of lung single-cell sequencing reveals a transitional profibrotic macrophage</article-title>. <source>Nat. Immunol</source>., <volume>20</volume>, <fpage>163</fpage>–<lpage>172</lpage>.<pub-id pub-id-type="pmid">30643263</pub-id></mixed-citation>
    </ref>
    <ref id="btz292-B2">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Arner</surname><given-names>E.</given-names></name></person-group><etal>et al</etal> (<year>2015</year>) 
<article-title>Transcribed enhancers lead waves of coordinated transcription in transitioning mammalian cells</article-title>. <source>Science</source>, <volume>347</volume>, <fpage>1010</fpage>–<lpage>1014</lpage>.<pub-id pub-id-type="pmid">25678556</pub-id></mixed-citation>
    </ref>
    <ref id="btz292-B3">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Bendall</surname><given-names>S.C.</given-names></name></person-group><etal>et al</etal> (<year>2014</year>) 
<article-title>Single-cell trajectory detection uncovers progression and regulatory coordination in human B cell development</article-title>. <source>Cell</source>, <volume>157</volume>, <fpage>714</fpage>–<lpage>725</lpage>.<pub-id pub-id-type="pmid">24766814</pub-id></mixed-citation>
    </ref>
    <ref id="btz292-B4">
      <mixed-citation publication-type="journal">Cancer Genome Atlas Network. (<year>2015</year>) 
<article-title>Genomic classification of cutaneous melanoma</article-title>. <source>Cell</source>, <volume>161</volume>, <fpage>1681</fpage>–<lpage>1696</lpage>.<pub-id pub-id-type="pmid">26091043</pub-id></mixed-citation>
    </ref>
    <ref id="btz292-B5">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>da Rocha</surname><given-names>E.L.</given-names></name></person-group><etal>et al</etal> (<year>2018</year>) 
<article-title>Reconstruction of complex single-cell trajectories using CellRouter</article-title>. <source>Nat. Commun</source>., <volume>9</volume>, <fpage>892</fpage>.<pub-id pub-id-type="pmid">29497036</pub-id></mixed-citation>
    </ref>
    <ref id="btz292-B6">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Diehl</surname><given-names>A.D.</given-names></name></person-group><etal>et al</etal> (<year>2016</year>) 
<article-title>The Cell Ontology 2016: enhanced content, modularization, and ontology interoperability</article-title>. <source>J. Biomed. Semantics</source>, <volume>7</volume>, <fpage>44</fpage>.<pub-id pub-id-type="pmid">27377652</pub-id></mixed-citation>
    </ref>
    <ref id="btz292-B7">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Fernandez</surname><given-names>J.M.</given-names></name></person-group><etal>et al</etal> (<year>2016</year>) 
<article-title>The BLUEPRINT data analysis portal</article-title>. <source>Cell Syst</source>., <volume>3</volume>, <fpage>491</fpage>.<pub-id pub-id-type="pmid">27863955</pub-id></mixed-citation>
    </ref>
    <ref id="btz292-B8">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Forrest</surname><given-names>A.R.</given-names></name></person-group><etal>et al</etal> (<year>2014</year>) 
<article-title>A promoter-level mammalian expression atlas</article-title>. <source>Nature</source>, <volume>507</volume>, <fpage>462</fpage>–<lpage>470</lpage>.<pub-id pub-id-type="pmid">24670764</pub-id></mixed-citation>
    </ref>
    <ref id="btz292-B9">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Freytag</surname><given-names>S.</given-names></name></person-group><etal>et al</etal> (<year>2018</year>) 
<article-title>Comparison of clustering tools in R for medium-sized 10x Genomics single-cell RNA-sequencing data</article-title>. <source>F1000Res</source>., <volume>7</volume>, <fpage>1297</fpage>. (<pub-id pub-id-type="pmid">30228881</pub-id></mixed-citation>
    </ref>
    <ref id="btz292-B10">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Haghverdi</surname><given-names>L.</given-names></name></person-group><etal>et al</etal> (<year>2016</year>) 
<article-title>Diffusion pseudotime robustly reconstructs lineage branching</article-title>. <source>Nat. Methods</source>, <volume>13</volume>, <fpage>845</fpage>.<pub-id pub-id-type="pmid">27571553</pub-id></mixed-citation>
    </ref>
    <ref id="btz292-B11">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Han</surname><given-names>X.P.</given-names></name></person-group><etal>et al</etal> (<year>2018</year>) 
<article-title>Mapping the mouse cell atlas by Microwell-seq</article-title>. <source>Cell</source>, <volume>172</volume>, <fpage>1091</fpage>. +.<pub-id pub-id-type="pmid">29474909</pub-id></mixed-citation>
    </ref>
    <ref id="btz292-B12">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Hashimshony</surname><given-names>T.</given-names></name></person-group><etal>et al</etal> (<year>2012</year>) 
<article-title>CEL-Seq: single-cell RNA-seq by multiplexed linear amplification</article-title>. <source>Cell Rep</source>., <volume>2</volume>, <fpage>666</fpage>–<lpage>673</lpage>.<pub-id pub-id-type="pmid">22939981</pub-id></mixed-citation>
    </ref>
    <ref id="btz292-B13">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Kim</surname><given-names>T.</given-names></name></person-group><etal>et al</etal> (<year>2018</year>) 
<article-title>Impact of similarity metrics on single-cell RNA-seq data clustering</article-title>. <source>Brief. Bioinform</source>., doi: 10.1093/bib/bby076.</mixed-citation>
    </ref>
    <ref id="btz292-B14">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Klein</surname><given-names>A.M.</given-names></name></person-group><etal>et al</etal> (<year>2015</year>) 
<article-title>Droplet barcoding for single-cell transcriptomics applied to embryonic stem cells</article-title>. <source>Cell</source>, <volume>161</volume>, <fpage>1187</fpage>–<lpage>1201</lpage>.<pub-id pub-id-type="pmid">26000487</pub-id></mixed-citation>
    </ref>
    <ref id="btz292-B15">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Li</surname><given-names>H.</given-names></name></person-group><etal>et al</etal> (<year>2017</year>) 
<article-title>Reference component analysis of single-cell transcriptomes elucidates cellular heterogeneity in human colorectal tumors</article-title>. <source>Nat. Genet</source>., <volume>49</volume>, <fpage>708</fpage>–<lpage>718</lpage>.<pub-id pub-id-type="pmid">28319088</pub-id></mixed-citation>
    </ref>
    <ref id="btz292-B16">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Lizio</surname><given-names>M.</given-names></name></person-group><etal>et al</etal> (<year>2017</year>) 
<article-title>Update of the FANTOM web resource: high resolution transcriptome of diverse cell types in mammals</article-title>. <source>Nucleic Acids Res</source>., <volume>45</volume>, <fpage>D737</fpage>–<lpage>D743</lpage>.<pub-id pub-id-type="pmid">27794045</pub-id></mixed-citation>
    </ref>
    <ref id="btz292-B17">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Mabbott</surname><given-names>N.A.</given-names></name></person-group><etal>et al</etal> (<year>2013</year>) 
<article-title>An expression atlas of human primary cells: inference of gene function from coexpression networks</article-title>. <source>BMC Genomics</source>, <volume>14</volume>, <fpage>632</fpage>.<pub-id pub-id-type="pmid">24053356</pub-id></mixed-citation>
    </ref>
    <ref id="btz292-B18">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Macosko</surname><given-names>E.Z.</given-names></name></person-group><etal>et al</etal> (<year>2015</year>) 
<article-title>Highly parallel genome-wide expression profiling of individual cells using nanoliter droplets</article-title>. <source>Cell</source>, <volume>161</volume>, <fpage>1202</fpage>–<lpage>1214</lpage>.<pub-id pub-id-type="pmid">26000488</pub-id></mixed-citation>
    </ref>
    <ref id="btz292-B19">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Picelli</surname><given-names>S.</given-names></name></person-group><etal>et al</etal> (<year>2013</year>) 
<article-title>Smart-seq2 for sensitive full-length transcriptome profiling in single cells</article-title>. <source>Nat. Methods</source>, <volume>10</volume>, <fpage>1096</fpage>–<lpage>1098</lpage>.<pub-id pub-id-type="pmid">24056875</pub-id></mixed-citation>
    </ref>
    <ref id="btz292-B20">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Pollen</surname><given-names>A.A.</given-names></name></person-group><etal>et al</etal> (<year>2014</year>) 
<article-title>Low-coverage single-cell mRNA sequencing reveals cellular heterogeneity and activated signaling pathways in developing cerebral cortex</article-title>. <source>Nat. Biotechnol</source>., <volume>32</volume>, <fpage>1053</fpage>. +.<pub-id pub-id-type="pmid">25086649</pub-id></mixed-citation>
    </ref>
    <ref id="btz292-B21">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Regev</surname><given-names>A.</given-names></name></person-group><etal>et al</etal> (<year>2018</year>) 
<article-title>The Human Cell Atlas White Paper</article-title>. <source>arXiv Preprint arXiv</source>, <volume>05192</volume>, <fpage>2018</fpage>.</mixed-citation>
    </ref>
    <ref id="btz292-B22">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Rosenberg</surname><given-names>A.B.</given-names></name></person-group><etal>et al</etal> (<year>2018</year>) 
<article-title>Single-cell profiling of the developing mouse brain and spinal cord with split-pool barcoding</article-title>. <source>Science</source>, <volume>360</volume>, <fpage>176</fpage>.<pub-id pub-id-type="pmid">29545511</pub-id></mixed-citation>
    </ref>
    <ref id="btz292-B23">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Setty</surname><given-names>M.</given-names></name></person-group><etal>et al</etal> (<year>2016</year>) 
<article-title>Wishbone identifies bifurcating developmental trajectories from single-cell data</article-title>. <source>Nat. Biotechnol</source>., <volume>34</volume>, <fpage>637</fpage>–<lpage>645</lpage>.<pub-id pub-id-type="pmid">27136076</pub-id></mixed-citation>
    </ref>
    <ref id="btz292-B24">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Shin</surname><given-names>J.</given-names></name></person-group><etal>et al</etal> (<year>2015</year>) 
<article-title>Single-cell RNA-seq with waterfall reveals molecular cascades underlying adult neurogenesis</article-title>. <source>Cell Stem Cell</source>, <volume>17</volume>, <fpage>360</fpage>–<lpage>372</lpage>.<pub-id pub-id-type="pmid">26299571</pub-id></mixed-citation>
    </ref>
    <ref id="btz292-B25">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Shirai</surname><given-names>M.</given-names></name></person-group><etal>et al</etal> (<year>2016</year>) 
<article-title>Vertical flow array chips reliably identify cell types from single-cell mRNA sequencing experiments</article-title>. <source>Sci. Rep</source>., <volume>6</volume>, <fpage>36014</fpage>.<pub-id pub-id-type="pmid">27876759</pub-id></mixed-citation>
    </ref>
    <ref id="btz292-B26">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Sloan</surname><given-names>C.A.</given-names></name></person-group><etal>et al</etal> (<year>2016</year>) 
<article-title>ENCODE data at the ENCODE portal</article-title>. <source>Nucleic Acids Res</source>., <volume>44</volume>, <fpage>D726</fpage>–<lpage>D732</lpage>.<pub-id pub-id-type="pmid">26527727</pub-id></mixed-citation>
    </ref>
    <ref id="btz292-B27">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Svensson</surname><given-names>V.</given-names></name></person-group><etal>et al</etal> (<year>2017</year>) 
<article-title>Power analysis of single-cell RNA-sequencing experiments</article-title>. <source>Nat. Methods</source>, <volume>14</volume>, <fpage>381</fpage>. +.<pub-id pub-id-type="pmid">28263961</pub-id></mixed-citation>
    </ref>
    <ref id="btz292-B28">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Tabula Muris</surname><given-names>C.</given-names></name></person-group><etal>et al</etal> (<year>2018</year>) 
<article-title>Single-cell transcriptomics of 20 mouse organs creates a Tabula Muris</article-title>. <source>Nature</source>, <volume>562</volume>, <fpage>367</fpage>–<lpage>372</lpage>.<pub-id pub-id-type="pmid">30283141</pub-id></mixed-citation>
    </ref>
    <ref id="btz292-B29">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Tang</surname><given-names>F.C.</given-names></name></person-group><etal>et al</etal> (<year>2009</year>) 
<article-title>mRNA-Seq whole-transcriptome analysis of a single cell</article-title>. <source>Nat. Methods</source>, <volume>6</volume>, <fpage>377</fpage>–<lpage>386</lpage>.<pub-id pub-id-type="pmid">19349980</pub-id></mixed-citation>
    </ref>
    <ref id="btz292-B30">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Tay</surname><given-names>S.</given-names></name></person-group><etal>et al</etal> (<year>2010</year>) 
<article-title>Single-cell NF-kappa B dynamics reveal digital activation and analogue information processing</article-title>. <source>Nature</source>, <volume>466</volume>, <fpage>267</fpage>–<lpage>271</lpage>.<pub-id pub-id-type="pmid">20581820</pub-id></mixed-citation>
    </ref>
    <ref id="btz292-B31">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Thompson</surname><given-names>A.M.</given-names></name></person-group><etal>et al</etal> (<year>2014</year>) 
<article-title>Self-digitization microfluidic chip for absolute quantification of mRNA in single cells</article-title>. <source>Anal. Chem</source>., <volume>86</volume>, <fpage>12308</fpage>–<lpage>12314</lpage>.<pub-id pub-id-type="pmid">25390242</pub-id></mixed-citation>
    </ref>
    <ref id="btz292-B32">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Tirosh</surname><given-names>I.</given-names></name></person-group><etal>et al</etal> (<year>2016</year>) 
<article-title>Dissecting the multicellular ecosystem of metastatic melanoma by single-cell RNA-seq</article-title>. <source>Science</source>, <volume>352</volume>, <fpage>189</fpage>–<lpage>196</lpage>.<pub-id pub-id-type="pmid">27124452</pub-id></mixed-citation>
    </ref>
    <ref id="btz292-B33">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Trapnell</surname><given-names>C.</given-names></name></person-group><etal>et al</etal> (<year>2014</year>) 
<article-title>The dynamics and regulators of cell fate decisions are revealed by pseudotemporal ordering of single cells</article-title>. <source>Nat. Biotechnol</source>., <volume>32</volume>, <fpage>381</fpage>–<lpage>386</lpage>.<pub-id pub-id-type="pmid">24658644</pub-id></mixed-citation>
    </ref>
    <ref id="btz292-B34">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Treutlein</surname><given-names>B.</given-names></name></person-group><etal>et al</etal> (<year>2014</year>) 
<article-title>Reconstructing lineage hierarchies of the distal lung epithelium using single-cell RNA-seq</article-title>. <source>Nature</source>, <volume>509</volume>, <fpage>371</fpage>–<lpage>375</lpage>.<pub-id pub-id-type="pmid">24739965</pub-id></mixed-citation>
    </ref>
    <ref id="btz292-B35">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Wang</surname><given-names>B.L.</given-names></name></person-group><etal>et al</etal> (<year>2014</year>) 
<article-title>Microfluidic high-throughput culturing of single cells for selection based on extracellular metabolite production or consumption</article-title>. <source>Nat. Biotechnol</source>., <volume>32</volume>, <fpage>473</fpage>–<lpage>478</lpage>.<pub-id pub-id-type="pmid">24705516</pub-id></mixed-citation>
    </ref>
    <ref id="btz292-B36">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Zheng</surname><given-names>G.X.Y.</given-names></name></person-group><etal>et al</etal> (<year>2017</year>) 
<article-title>Massively parallel digital transcriptional profiling of single cells</article-title>. <source>Nat. Commun</source>., <volume>8</volume>, <fpage>14049</fpage>.<pub-id pub-id-type="pmid">28091601</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
