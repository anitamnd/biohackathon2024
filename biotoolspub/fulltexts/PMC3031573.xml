<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//NLM//DTD Journal Publishing DTD v2.3 20031101//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName journalpublishing.dtd?>
<?SourceDTD.Version 2.3?>
<?ConverterInfo.XSLTName jp2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">PLoS One</journal-id>
    <journal-id journal-id-type="iso-abbrev">PLoS ONE</journal-id>
    <journal-id journal-id-type="publisher-id">plos</journal-id>
    <journal-id journal-id-type="pmc">plosone</journal-id>
    <journal-title-group>
      <journal-title>PLoS ONE</journal-title>
    </journal-title-group>
    <issn pub-type="epub">1932-6203</issn>
    <publisher>
      <publisher-name>Public Library of Science</publisher-name>
      <publisher-loc>San Francisco, USA</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">3031573</article-id>
    <article-id pub-id-type="pmid">21304975</article-id>
    <article-id pub-id-type="publisher-id">PONE-D-10-01421</article-id>
    <article-id pub-id-type="doi">10.1371/journal.pone.0016526</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Research Article</subject>
      </subj-group>
      <subj-group subj-group-type="Discipline-v2">
        <subject>Biology</subject>
        <subj-group>
          <subject>Computational Biology</subject>
          <subj-group>
            <subject>Genomics</subject>
            <subj-group>
              <subject>Genome Analysis Tools</subject>
              <subject>Genome Complexity</subject>
              <subject>Structural Genomics</subject>
            </subj-group>
          </subj-group>
        </subj-group>
        <subj-group>
          <subject>Genomics</subject>
          <subj-group>
            <subject>Genome Analysis Tools</subject>
            <subject>Genome Complexity</subject>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v2">
        <subject>Computer Science</subject>
        <subj-group>
          <subject>Software Engineering</subject>
          <subj-group>
            <subject>Software Design</subject>
            <subject>Software Tools</subject>
          </subj-group>
        </subj-group>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Considering Transposable Element Diversification in <italic>De Novo</italic> Annotation Approaches</article-title>
      <alt-title alt-title-type="running-head"><italic>De Novo</italic> Annotation of Transposable Elements</alt-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Flutre</surname>
          <given-names>Timothée</given-names>
        </name>
        <xref ref-type="aff" rid="aff1">
          <sup>1</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Duprat</surname>
          <given-names>Elodie</given-names>
        </name>
        <xref ref-type="aff" rid="aff2">
          <sup>2</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Feuillet</surname>
          <given-names>Catherine</given-names>
        </name>
        <xref ref-type="aff" rid="aff3">
          <sup>3</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Quesneville</surname>
          <given-names>Hadi</given-names>
        </name>
        <xref ref-type="aff" rid="aff1">
          <sup>1</sup>
        </xref>
        <xref ref-type="corresp" rid="cor1">
          <sup>*</sup>
        </xref>
      </contrib>
    </contrib-group>
    <aff id="aff1">
      <label>1</label>
      <addr-line>Unité de Recherche en Génomique-Info, UR 1164, INRA Centre de Versailles-Grignon, Versailles, France</addr-line>
    </aff>
    <aff id="aff2">
      <label>2</label>
      <addr-line>Institut de Minéralogie et de Physique des Milieux Condensés, UMR 7590, CNRS-UPMC-IPGP-Université Paris Diderot, Paris, France</addr-line>
    </aff>
    <aff id="aff3">
      <label>3</label>
      <addr-line>Génétique, Diversité et Ecophysiologie des Céréales, UMR 1095, INRA Domaine du Crouël, Clermont-Ferrand, France</addr-line>
    </aff>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Xu</surname>
          <given-names>Ying</given-names>
        </name>
        <role>Editor</role>
        <xref ref-type="aff" rid="edit1"/>
      </contrib>
    </contrib-group>
    <aff id="edit1">University of Georgia, United States of America</aff>
    <author-notes>
      <corresp id="cor1">* E-mail: <email>Hadi.quesneville@versailles.inra.fr</email></corresp>
      <fn fn-type="con">
        <p>Conceived and designed the experiments: TF ED HQ. Performed the experiments: TF ED. Analyzed the data: TF ED CF HQ. Contributed reagents/materials/analysis tools: TF ED. Wrote the paper: TF CF HQ. Coordinated study: HQ.</p>
      </fn>
    </author-notes>
    <pub-date pub-type="collection">
      <year>2011</year>
    </pub-date>
    <pub-date pub-type="epub">
      <day>31</day>
      <month>1</month>
      <year>2011</year>
    </pub-date>
    <volume>6</volume>
    <issue>1</issue>
    <elocation-id>e16526</elocation-id>
    <history>
      <date date-type="received">
        <day>31</day>
        <month>8</month>
        <year>2010</year>
      </date>
      <date date-type="accepted">
        <day>4</day>
        <month>1</month>
        <year>2011</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>Flutre et al.</copyright-statement>
      <copyright-year>2011</copyright-year>
      <license xlink:href="http://creativecommons.org/licenses/by/4.0/">
        <license-p>This is an open-access article distributed under the terms of the Creative Commons Attribution License, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are properly credited.</license-p>
      </license>
    </permissions>
    <abstract>
      <p>Transposable elements (TEs) are mobile, repetitive DNA sequences that are almost ubiquitous in prokaryotic and eukaryotic genomes. They have a large impact on genome structure, function and evolution. With the recent development of high-throughput sequencing methods, many genome sequences have become available, making possible comparative studies of TE dynamics at an unprecedented scale. Several methods have been proposed for the <italic>de novo</italic> identification of TEs in sequenced genomes. Most begin with the detection of genomic repeats, but the subsequent steps for defining TE families differ. High-quality TE annotations are available for the <italic>Drosophila melanogaster</italic> and <italic>Arabidopsis thaliana</italic> genome sequences, providing a solid basis for the benchmarking of such methods. We compared the performance of specific algorithms for the clustering of interspersed repeats and found that only a particular combination of algorithms detected TE families with good recovery of the reference sequences. We then applied a new procedure for reconciling the different clustering results and classifying TE sequences. The whole approach was implemented in a pipeline using the REPET package. Finally, we show that our combined approach highlights the dynamics of well defined TE families by making it possible to identify structural variations among their copies. This approach makes it possible to annotate TE families and to study their diversification in a single analysis, improving our understanding of TE dynamics at the whole-genome scale and for diverse species.</p>
    </abstract>
    <counts>
      <page-count count="15"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec id="s1">
    <title>Introduction</title>
    <p>Transposable elements (TEs) are DNA sequences that can move and duplicate, autonomously or with the assistance of other elements, within genomes. TEs have been described as the “ultimate parasite”, because of their ability to amplify and invade genomes for their own ends <xref rid="pone.0016526-Orgel1" ref-type="bibr">[1]</xref>, and as “selfish DNA sequences” <xref rid="pone.0016526-Brookfield1" ref-type="bibr">[2]</xref>. These invasion events play a particularly important role in eukaryotic genomes, probably because of the smaller population sizes of eukaryotes than of prokaryotes <xref rid="pone.0016526-Lynch1" ref-type="bibr">[3]</xref>.</p>
    <p>TEs are generally classified according to their transposition mechanism. Those transposing <italic>via</italic> an RNA intermediate belong to class I and are referred to as retrotransposons, whereas those transposing <italic>via</italic> a DNA intermediate belong to class II and are called DNA transposons <xref rid="pone.0016526-Finnegan1" ref-type="bibr">[4]</xref>. Class I transposable elements can be classified into three main orders, LTR retrotransposons (having long terminal repeats), LINEs (long interspersed nuclear elements) and SINEs (short interspersed nuclear elements), whereas class II transposable elements are classified into DNA transposons, Helitrons and Mavericks <xref rid="pone.0016526-Wicker1" ref-type="bibr">[5]</xref>. Most TEs encode proteins that mediate their autonomous transposition. During the course of evolution, non autonomous elements have emerged from autonomous elements. Some are incomplete versions of autonomous elements, often with insertions/deletions (indels) disrupting their open reading frames (ORFs). Others are miniature versions lacking internal sequences but retaining the boundaries of the original element, making it possible for the autonomous element machinery to recognize them. MITEs (miniature inverted-repeats transposable elements) are well known examples of non autonomous elements that evolved from class II DNA transposons <xref rid="pone.0016526-Wessler1" ref-type="bibr">[6]</xref>, <xref rid="pone.0016526-Yang1" ref-type="bibr">[7]</xref>.</p>
    <p>TEs are now recognized to be a major component of the structure of the genome and to affect genome size and chromosomal rearrangements <xref rid="pone.0016526-Gray1" ref-type="bibr">[8]</xref>–<xref rid="pone.0016526-Coghlan1" ref-type="bibr">[10]</xref>. They often account for a large proportion of the genome: 20% of the 180 Mb <italic>Drosophila melanogaster</italic> genome, 45% of the 3.2 Gb human genome, and more than 80% of the 17 Gb bread wheat (<italic>Triticum aestivum</italic>) genome <xref rid="pone.0016526-Paux1" ref-type="bibr">[11]</xref>. These dispersed repeats can induce major chromosomal rearrangements, thereby affecting genome organization. However, the impact of TEs is not limited to effects on genome structure. As initially suggested by Barbara McClintock <xref rid="pone.0016526-McClintock1" ref-type="bibr">[12]</xref>, TEs may be seen as “controlling” elements. They may provide regulatory sequences with various effects on the adjacent genes. In particular, some silencing mechanisms involving RNA interference seem to have emerged primarily as a host response to prevent TE amplification. Thus, genes located close to TE insertions may be subject to transcriptional control due to TE repression, resulting in their epigenetic regulation <xref rid="pone.0016526-Slotkin1" ref-type="bibr">[13]</xref>, <xref rid="pone.0016526-Martin1" ref-type="bibr">[14]</xref>. Moreover, TEs are intrinsically able to create, modify and re-wire gene regulatory networks <xref rid="pone.0016526-Feschotte1" ref-type="bibr">[15]</xref>, <xref rid="pone.0016526-Herpin1" ref-type="bibr">[16]</xref>. Finally, many cases of exaptation and domestication involving TEs have been reported <xref rid="pone.0016526-Cordaux1" ref-type="bibr">[17]</xref>, <xref rid="pone.0016526-Santangelo1" ref-type="bibr">[18]</xref>. For example, there are several lines of evidence to suggest that the RAG1 and RAG2 genes involved in V(D)J recombination originated from a hAT DNA transposon that was domesticated to fulfill this primordial function of the adaptive immune system <xref rid="pone.0016526-Agrawal1" ref-type="bibr">[19]</xref>, <xref rid="pone.0016526-Zhou1" ref-type="bibr">[20]</xref>.</p>
    <p>The increase in efficiency and decrease in cost of new sequencing techniques <xref rid="pone.0016526-Schuster1" ref-type="bibr">[21]</xref> are leading to the sequencing of increasing numbers of genomes. About 1250 genome sequencing projects have already been initiated for eukaryotes, including species with large and repetitive genomes, such as maize <xref rid="pone.0016526-Schnable1" ref-type="bibr">[22]</xref>. The efficient and accurate annotation of TEs is therefore essential to our understanding of their impact on gene function and genome evolution <xref rid="pone.0016526-Bourque1" ref-type="bibr">[23]</xref>.</p>
    <p>If a routine TE annotation procedure is to be efficient, it must be both rapid and exhaustive, biologically relevant and computationally tractable. The TE annotation process can be divided into two phases: (i) the <italic>de novo</italic> discovery and identification of the TE families present in the genome studied and (ii) the precise, comprehensive annotation of TE copies on the chromosomes. For the second phase, an integrated pipeline has already been developed and tested <xref rid="pone.0016526-Quesneville1" ref-type="bibr">[24]</xref> and this pipeline has been applied to several organisms <xref rid="pone.0016526-Bergman1" ref-type="bibr">[25]</xref>–<xref rid="pone.0016526-The2" ref-type="bibr">[31]</xref>. For the <italic>de novo</italic> discovery phase, several programs and algorithms based on different assumptions have been developed, but none has yet proved entirely satisfactory. Indeed, as pointed out in a previous study <xref rid="pone.0016526-Saha1" ref-type="bibr">[32]</xref>, some programs have very low levels of sensitivity or specificity, whereas others return too short consensus sequence (&lt;1 kb).</p>
    <p>In addition to describing the composition and organization of the genome, TE annotation facilitates the identification of structural variants providing useful information about genome dynamics. Several examples of structural variations in TE families have been reported <xref rid="pone.0016526-Jiang1" ref-type="bibr">[33]</xref>, <xref rid="pone.0016526-Quesneville2" ref-type="bibr">[34]</xref> but these variations have generally been underestimated in genome-wide analyses of TEs. In this study, we addressed two questions, one concerning the challenges associated with whole-genome TE annotation, and the other relating to the identification and characterization of structural variants from the same TE family. We first compared the existing computational methods for the <italic>de novo</italic> identification of TEs in sequenced genomes, using the high-quality TE annotations available for the <italic>Drosophila melanogaster</italic>
<xref rid="pone.0016526-Quesneville1" ref-type="bibr">[24]</xref> and <italic>Arabidopsis thaliana</italic> genome sequences <xref rid="pone.0016526-Buisine1" ref-type="bibr">[29]</xref>. We then developed the TEdenovo pipeline, a tool combining several different programs, including procedures for the clustering of interspersed repeats, into a single framework, the REPET package (<ext-link ext-link-type="uri" xlink:href="http://urgi.versailles.inra.fr/index.php/repet">http://urgi.versailles.inra.fr/index.php/repet</ext-link>). Finally, by analyzing the <italic>D. melanogaster</italic> and <italic>A. thaliana</italic> genomes with the TEdenovo pipeline, we were able to obtain new insight into TE dynamics, highlighting structural variations emerging during the diversification of TE families and identifying putative new TEs absent from reference databanks.</p>
  </sec>
  <sec id="s2">
    <title>Results</title>
    <sec id="s2a">
      <title>Comparative analysis of <italic>de novo</italic> approaches</title>
      <p>We developed a three-step approach for comparing the efficiency of <italic>de novo</italic> TE detection methods (see <xref rid="pone.0016526-Bergman2" ref-type="bibr">[35]</xref> for a review), to provide a robust tool for identifying TEs in eukaryotic genomes: (i) the self-alignment of the input genomic sequences, (ii) the clustering of the resulting pairwise alignments, and (iii) the construction of a multiple alignment for each cluster from which a consensus sequence is derived (<xref ref-type="supplementary-material" rid="pone.0016526.s001">Figure S1</xref>). This process generates a databank of <italic>de novo</italic> consensus sequences representing putative TE families present in the genome analyzed, which can be used for the annotation of individual TE copies. We applied this three-step approach to the <italic>D. melanogaster</italic> release 4 and <italic>A. thaliana</italic> release 9 genome sequences. At each step, we evaluated several programs, comparing the efficiency with which they identified TEs with the aid of the high-quality TE sequence databanks (from the Berkeley <italic>Drosophila</italic> Genome Project and Repbase Update) and annotations available for these two reference genomes <xref rid="pone.0016526-Quesneville1" ref-type="bibr">[24]</xref>, <xref rid="pone.0016526-Buisine1" ref-type="bibr">[29]</xref>.</p>
      <p>Traditionally, the quality of <italic>de novo</italic> consensus sequences — the extent to which they correspond to full TE reference sequences rather than truncated versions — is not assessed. Validation is instead indirect: researchers annotate a genome sequence with RepeatMasker, using Repbase Update as TE databank, and consider the resulting TE annotations as the references. They then annotate the same genome with RepeatMasker, using the <italic>de novo</italic> consensus as TE databank, and consider these TE annotations as predictions. These two sets of annotations are then compared, by calculating sensitivity and specificity at the nucleotide level. The criterion used to estimate the quality of the <italic>de novo</italic> method is therefore the extent to which <italic>de novo</italic> predictions and reference annotations overlap. However, as we are particularly interested in TE dynamics, we need to assess the quality of the <italic>de novo</italic> library itself, by evaluating the extent to which full ancestral TE reference sequences are recovered. Such sequences, which originate from the reconstruction of a given element from its copies, are not only useful for subsequent TE annotation, but also provide a condensed view of the TEs in the genome. One way of assessing the quality of the <italic>de novo</italic> consensus sequences obtained with our three-step approach would be to compare these sequences with reference sequences from the Berkeley Drosophila Genome Project (BDGP) or Repbase Update databanks. However, it was clear that some of the reference sequences present in these databanks would not be present in the genomes analyzed. For example, the “P-element” reference sequence is absent from the genome sequence of the <italic>D. melanogaster</italic> strain used here. So, rather than using the reference databanks directly, we first constructed, for each genome, a “knowledge-based” databank comprising one consensus sequence per reference TE sequence, based on its genomic copies (see <xref ref-type="sec" rid="s4">Methods</xref>). For each genome, we then compared each <italic>de novo</italic> databank with its corresponding “knowledge-based” databank through pairwise sequence alignments. We then calculated the sensitivity S<sub>n</sub>*, specificity S<sub>p</sub>* and recovery ratio R<sub>CC</sub> (see <xref ref-type="sec" rid="s4">Methods</xref> and <xref ref-type="table" rid="pone-0016526-t001">Table 1</xref>). This last index, the R<sub>CC</sub> ratio, provides a precise measurement of the number of TE reference elements fully recovered in the <italic>de novo</italic> consensus sequences.</p>
      <table-wrap id="pone-0016526-t001" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pone.0016526.t001</object-id>
        <label>Table 1</label>
        <caption>
          <title>Sensitivity and specificity of the programs tested in the three-step <italic>de novo</italic> approach.</title>
        </caption>
        <alternatives>
          <graphic id="pone-0016526-t001-1" xlink:href="pone.0016526.t001"/>
          <table frame="hsides" rules="groups">
            <colgroup span="1">
              <col align="left" span="1"/>
              <col align="center" span="1"/>
              <col align="center" span="1"/>
              <col align="center" span="1"/>
              <col align="center" span="1"/>
              <col align="center" span="1"/>
              <col align="center" span="1"/>
            </colgroup>
            <thead>
              <tr>
                <td align="left" rowspan="1" colspan="1">Genome</td>
                <td align="left" rowspan="1" colspan="1">Self-alignment</td>
                <td align="left" rowspan="1" colspan="1">Clustering</td>
                <td align="left" rowspan="1" colspan="1">Multiple alignment</td>
                <td align="left" rowspan="1" colspan="1">S<sub>n</sub>*</td>
                <td align="left" rowspan="1" colspan="1">S<sub>p</sub>*</td>
                <td align="left" rowspan="1" colspan="1">R<sub>CC</sub>
</td>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td align="left" rowspan="1" colspan="1">
                  <italic>D. mel.</italic>
                </td>
                <td align="left" rowspan="1" colspan="1">BLASTER</td>
                <td align="left" rowspan="1" colspan="1">GROUPER</td>
                <td align="left" rowspan="1" colspan="1">MAP</td>
                <td align="left" rowspan="1" colspan="1">80.34%</td>
                <td align="left" rowspan="1" colspan="1">85.89%</td>
                <td align="left" rowspan="1" colspan="1">66.20%</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">
                  <italic>D. mel.</italic>
                </td>
                <td align="left" rowspan="1" colspan="1">BLASTER</td>
                <td align="left" rowspan="1" colspan="1">RECON</td>
                <td align="left" rowspan="1" colspan="1">MAP</td>
                <td align="left" rowspan="1" colspan="1">92.31%</td>
                <td align="left" rowspan="1" colspan="1">73.17%</td>
                <td align="left" rowspan="1" colspan="1">66.20%</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">
                  <italic>D. mel.</italic>
                </td>
                <td align="left" rowspan="1" colspan="1">BLASTER</td>
                <td align="left" rowspan="1" colspan="1">PILER</td>
                <td align="left" rowspan="1" colspan="1">MAP</td>
                <td align="left" rowspan="1" colspan="1">62.39%</td>
                <td align="left" rowspan="1" colspan="1">84.17%</td>
                <td align="left" rowspan="1" colspan="1">51.50%</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">
                  <italic>D. mel.</italic>
                </td>
                <td align="left" rowspan="1" colspan="1">PALS</td>
                <td align="left" rowspan="1" colspan="1">GROUPER</td>
                <td align="left" rowspan="1" colspan="1">MAP</td>
                <td align="left" rowspan="1" colspan="1">73.50%</td>
                <td align="left" rowspan="1" colspan="1">88.75%</td>
                <td align="left" rowspan="1" colspan="1">60.30%</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">
                  <italic>D. mel.</italic>
                </td>
                <td align="left" rowspan="1" colspan="1">PALS</td>
                <td align="left" rowspan="1" colspan="1">RECON</td>
                <td align="left" rowspan="1" colspan="1">MAP</td>
                <td align="left" rowspan="1" colspan="1">90.60%</td>
                <td align="left" rowspan="1" colspan="1">74.23%</td>
                <td align="left" rowspan="1" colspan="1">51.50%</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">
                  <italic>D. mel.</italic>
                </td>
                <td align="left" rowspan="1" colspan="1">PALS</td>
                <td align="left" rowspan="1" colspan="1">PILER</td>
                <td align="left" rowspan="1" colspan="1">MAP</td>
                <td align="left" rowspan="1" colspan="1">53.85%</td>
                <td align="left" rowspan="1" colspan="1">76.42%</td>
                <td align="left" rowspan="1" colspan="1">42.64%</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">
                  <italic>A. tha.</italic>
                </td>
                <td align="left" rowspan="1" colspan="1">BLASTER</td>
                <td align="left" rowspan="1" colspan="1">GROUPER</td>
                <td align="left" rowspan="1" colspan="1">MAP</td>
                <td align="left" rowspan="1" colspan="1">60.33%</td>
                <td align="left" rowspan="1" colspan="1">82.42%</td>
                <td align="left" rowspan="1" colspan="1">39.00%</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">
                  <italic>A. tha.</italic>
                </td>
                <td align="left" rowspan="1" colspan="1">BLASTER</td>
                <td align="left" rowspan="1" colspan="1">RECON</td>
                <td align="left" rowspan="1" colspan="1">MAP</td>
                <td align="left" rowspan="1" colspan="1">73.77%</td>
                <td align="left" rowspan="1" colspan="1">61.70%</td>
                <td align="left" rowspan="1" colspan="1">43.50%</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">
                  <italic>A. tha.</italic>
                </td>
                <td align="left" rowspan="1" colspan="1">BLASTER</td>
                <td align="left" rowspan="1" colspan="1">PILER</td>
                <td align="left" rowspan="1" colspan="1">MAP</td>
                <td align="left" rowspan="1" colspan="1">47.21%</td>
                <td align="left" rowspan="1" colspan="1">57.33%</td>
                <td align="left" rowspan="1" colspan="1">32.45%</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">
                  <italic>A. tha.</italic>
                </td>
                <td align="left" rowspan="1" colspan="1">PALS</td>
                <td align="left" rowspan="1" colspan="1">GROUPER</td>
                <td align="left" rowspan="1" colspan="1">MAP</td>
                <td align="left" rowspan="1" colspan="1">54.75%</td>
                <td align="left" rowspan="1" colspan="1">88.38%</td>
                <td align="left" rowspan="1" colspan="1">24.00%</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">
                  <italic>A. tha.</italic>
                </td>
                <td align="left" rowspan="1" colspan="1">PALS</td>
                <td align="left" rowspan="1" colspan="1">RECON</td>
                <td align="left" rowspan="1" colspan="1">MAP</td>
                <td align="left" rowspan="1" colspan="1">71.80%</td>
                <td align="left" rowspan="1" colspan="1">66.20%</td>
                <td align="left" rowspan="1" colspan="1">27.90%</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">
                  <italic>A. tha.</italic>
                </td>
                <td align="left" rowspan="1" colspan="1">PALS</td>
                <td align="left" rowspan="1" colspan="1">PILER</td>
                <td align="left" rowspan="1" colspan="1">MAP</td>
                <td align="left" rowspan="1" colspan="1">40.00%</td>
                <td align="left" rowspan="1" colspan="1">59.92%</td>
                <td align="left" rowspan="1" colspan="1">16.20%</td>
              </tr>
            </tbody>
          </table>
        </alternatives>
        <table-wrap-foot>
          <fn id="nt101">
            <label/>
            <p>“<italic>D. mel.</italic>” stands for “<italic>D. melanogaster</italic>” and “<italic>A. tha.</italic>” stands for “<italic>A. thaliana</italic>”. The three indices S<sub>n</sub>*, S<sub>p</sub>* and R<sub>CC</sub> correspond respectively to the measure of sensitivity, the measure of specificity and the recovery ratio when comparing a databank of TE <italic>de novo</italic> consensus sequences with a databank of TE reference sequences.</p>
          </fn>
        </table-wrap-foot>
      </table-wrap>
      <sec id="s2a1">
        <title>Self-alignment of the genomic sequences</title>
        <p>The first step in the three-step <italic>de novo</italic> approach involves the self-alignment of the input genomic sequences, corresponding to an all-by-all comparison of the genome with itself. We evaluated two local pairwise alignment programs for this first step: a heuristic algorithm, BLASTER <xref rid="pone.0016526-Quesneville3" ref-type="bibr">[36]</xref> wrapping BLAST <xref rid="pone.0016526-Altschul1" ref-type="bibr">[37]</xref>, and an exact algorithm, PALS <xref rid="pone.0016526-Rasmussen1" ref-type="bibr">[38]</xref> (see <xref ref-type="sec" rid="s4">Methods</xref>). We launched these two programs, with stringent parameters, on each of the target genomes, and then applied post-processing procedures to discard long segmental duplications (see <xref ref-type="sec" rid="s4">Methods</xref>). This resulted in a list of pairwise alignments corresponding to repeats in the <italic>D. melanogaster</italic> and <italic>A. thaliana</italic> genome sequences. A comparison of the <italic>de novo</italic> consensus sequence performances of the BLASTER and PALS programs (<xref ref-type="table" rid="pone-0016526-t001">Table 1</xref>) showed that BLASTER consistently had a higher sensitivity (S<sub>n</sub>*) and a much higher recovery ratio (R<sub>CC</sub>). In most cases, its specificity (S<sub>p</sub>*) was also better than that of PALS. Note that PALS was run with more stringent parameters than BLASTER as it cannot be used with the same values without computing time becoming intractable (see <xref ref-type="sec" rid="s4">Methods</xref>). As the recovery ratio R<sub>CC</sub> reflects the ability of the <italic>de novo</italic> approach to define TE boundaries correctly and, therefore, to recover full-length TE reference sequences, we preferred BLASTER over PALS for the self-alignment step. Moreover, in both genomes, BLASTER gave a higher genome coverage than PALS (<xref ref-type="supplementary-material" rid="pone.0016526.s004">Table S1</xref>), as expected given the lower stringency of its parameters (see <xref ref-type="sec" rid="s4">Methods</xref>). This first step also generated a lower limit for the repeats content of the genome: around 7% for <italic>D. melanogaster</italic> and 13% for <italic>A. thaliana</italic>.</p>
      </sec>
      <sec id="s2a2">
        <title>Clustering of the all-by-all matches</title>
        <p>In the second step, we clustered the results of the all-by-all comparisons, with the aim of gathering together, within the same cluster, all sequences belonging to the same TE family. This step is crucial to ensure the precise definition of repeat boundaries, one of the main challenges in the <italic>de novo</italic> detection of TEs. Due to their specific dynamics during genome evolution, TE families may differ considerably in terms of copy number, sequence divergence and insertion/deletion patterns. At this step, the aim is to cluster together all TE fragments sharing a common ancestor, with the aim of recovering the ancestral element that transposed in the past. However, TE copies diverge as they multiply and different copies may accumulate different modifications. This phenomenon results in structural variants, as depicted in <xref ref-type="fig" rid="pone-0016526-g001">Figure 1</xref>. In this case, the grouping together of copies from different structural variants within the same cluster may have the undesirable consequence of the identification of consensus sequences with some features specific to one of the structural variants with others specific to another variant. We therefore tested three programs specifically implemented for the clustering of interspersed repeats: GROUPER <xref rid="pone.0016526-Quesneville3" ref-type="bibr">[36]</xref>, RECON <xref rid="pone.0016526-Bao1" ref-type="bibr">[39]</xref> and PILER <xref rid="pone.0016526-Edgar1" ref-type="bibr">[40]</xref> (see <xref ref-type="sec" rid="s4">Methods</xref>).</p>
        <fig id="pone-0016526-g001" position="float">
          <object-id pub-id-type="doi">10.1371/journal.pone.0016526.g001</object-id>
          <label>Figure 1</label>
          <caption>
            <title>Schematic diagram of the dynamics of a TE family with two structural variants.</title>
          </caption>
          <graphic xlink:href="pone.0016526.g001"/>
        </fig>
        <p>We applied these three programs to the list of matches obtained in the genome self-alignments, and then applied procedures for discarding segmental duplications (see <xref ref-type="sec" rid="s4">Methods</xref>). In terms of the <italic>de novo</italic> consensuses generated from the resulting clusters (<xref ref-type="table" rid="pone-0016526-t001">Table 1</xref>), GROUPER and RECON were consistently more sensitive than PILER. Moreover, GROUPER was systematically more specific than RECON and PILER, with <italic>de novo</italic> consensuses from GROUPER less likely to be artifacts unrelated to TE reference sequences than those obtained with the other methods. In some cases, RECON provided a better recovery ratio (R<sub>CC</sub>) than GROUPER and PILER, but this ratio was always better for GROUPER than for PILER. In addition, regardless of the genome analyzed, the three programs did not necessarily generate the same number of clusters (<xref ref-type="supplementary-material" rid="pone.0016526.s005">Table S2</xref>): GROUPER generated more clusters than RECON, which, in turn, generated more clusters than PILER. The number of clusters obtained by the <italic>de novo</italic> approach was much higher for GROUPER and RECON than the number of TE families present in the reference databanks (BDGP or Repbase Update). We suggest that this large number of clusters reflects the high level of diversity within TE families in terms of copy divergence and nesting patterns, as assessed by clustering algorithms.</p>
      </sec>
      <sec id="s2a3">
        <title>Multiple sequence alignment for each cluster</title>
        <p>The third step, which consists in the construction of a multiple alignment for each cluster, is particularly important, because the quality of a consensus sequence depends on the quality of the multiple sequence alignment (MSA) from which it is derived. A large number of programs have been developed over the last ten years <xref rid="pone.0016526-Notredame1" ref-type="bibr">[41]</xref>, focusing on issues such as the scoring scheme, the use of templates for secondary structures and computation speed. In our case, the sequences to be aligned are very similar to each other in terms of nucleotide substitutions (identity of more than 90%), with most of the differences between them resulting from indels. The clusters generated by RECON include sequences of very different lengths (<xref ref-type="supplementary-material" rid="pone.0016526.s005">Table S2</xref>). Moreover, depending on the size and TE content of the genome analyzed, it may be necessary to process several thousand clusters. We tested only a subset of all the possible programs, focusing on those most suitable for our requirements: rapid procedures capable of handling indels. We therefore focused on progressive MSA algorithms, as these algorithms generate alignments rapidly. We tested MAP <xref rid="pone.0016526-Huang1" ref-type="bibr">[42]</xref>, CLUSTAL-W <xref rid="pone.0016526-Thompson1" ref-type="bibr">[43]</xref>, MAFFT <xref rid="pone.0016526-Katoh1" ref-type="bibr">[44]</xref> and PRANK <xref rid="pone.0016526-Loytynoja1" ref-type="bibr">[45]</xref> (see <xref ref-type="sec" rid="s4">Methods</xref>).</p>
        <p>For each of these multiple alignment programs, we used the matches returned by BLASTER and then clustered by GROUPER, RECON or PILER. This comparative study (<xref ref-type="supplementary-material" rid="pone.0016526.s006">Table S3</xref>) shows that all the multiple alignment programs gave similar results in terms of sensitivity and specificity, whether launched after GROUPER or after PILER. This result was expected, as all the sequences in these clusters are similar in both composition and length, making them easy to align. However, PRANK was slower than the other three programs, rendering it less suitable for large genome analyses. With RECON, the best results were obtained with MAP, due to the greater heterogeneity of RECON clusters in terms of sequence length, rendering alignment more difficult. Thus, few differences were observed, but MAP clearly outperformed the other programs on RECON clusters, making it more robust than the other programs, whatever the clustering method used.</p>
      </sec>
      <sec id="s2a4">
        <title>Comparison with another approach, RepeatScout</title>
        <p>We evaluated the performance of our three-step strategy, by comparing it with another approach that also builds a databank of TE consensus sequences from a raw genome sequence: RepeatScout <xref rid="pone.0016526-Price1" ref-type="bibr">[46]</xref> (see <xref ref-type="sec" rid="s4">Methods</xref>). We applied the RepeatScout program on the <italic>D. melanogaster</italic> and <italic>A. thaliana</italic> genome sequences, with the default parameters. It constructed 1770 consensuses for <italic>D. melanogaster</italic> and 3417 for <italic>A. thaliana</italic>. However, these consensuses were less sensitive and specific than those obtained with the tools described above (<xref ref-type="supplementary-material" rid="pone.0016526.s007">Table S4</xref>). This is probably due to the shorter length of the consensuses identified by RepeatScout (500 bp on average) than by GROUPER (∼2500 bp on average), RECON (∼2000 bp on average) and PILER (∼2800 bp on average). We obtained similar results for both genomes, indicating that this bias does not seem to be due to the input genome sequences. We hypothesize that RepeatScout fails to connect TE fragments more than a certain distance apart, thereby sometimes missing the true boundaries of a given TE copy. By contrast, GROUPER and RECON are particularly efficient at this task.</p>
      </sec>
      <sec id="s2a5">
        <title>Combination of programs into a robust pipeline, TEdenovo</title>
        <p>Based on the comparative analyses reported above, BLASTER should be used for the genome self-alignment step, followed by GROUPER or RECON for the clustering step and MAP for the multiple alignment step. However, a comparison of the consensuses obtained with all three clustering methods clearly showed that each of these methods nonetheless missed several reference TEs fully recovered by the others (<xref ref-type="fig" rid="pone-0016526-g002">Figure 2</xref>). With the <italic>D. melanogaster</italic> genome sequence, four “knowledge-based” consensuses were retrieved intact by GROUPER only, and nine such sequences were recovered by RECON only (<xref ref-type="fig" rid="pone-0016526-g002">Figure 2 A</xref>). Similarly, with the <italic>A. thaliana</italic> genome sequence, eight “knowledge-based” consensuses were retrieved intact only by GROUPER, whereas fifteen were retrieved intact only by RECON (<xref ref-type="fig" rid="pone-0016526-g002">Figure 2 B</xref>). The three clustering methods should therefore be used in combination, for the accurate identification of TE families in genome sequences. For this reason, we decided to the three-step approach within a combined, modular pipeline named “TEdenovo”. With respect to the best single method, GROUPER for <italic>D. melanogaster</italic> and RECON for <italic>A. thaliana</italic> (<xref ref-type="table" rid="pone-0016526-t001">Table 1</xref>), the combined approach, as implemented in the TEdenovo pipeline, improved the recovery of full-length “knowledge-based” consensus sequences by 20% and 13.5%, respectively, while maintaining high sensitivity and specificity (<xref ref-type="supplementary-material" rid="pone.0016526.s008">Table S5</xref>). The three approaches are combined at the clustering step, through the launching of GROUPER, RECON and PILER in parallel. The user may also choose to use PALS rather than BLASTER at step 1 or the other MSA programs at step 3, and can even choose to apply only one clustering program at step 2, although our results suggest that this would not be wise.</p>
        <fig id="pone-0016526-g002" position="float">
          <object-id pub-id-type="doi">10.1371/journal.pone.0016526.g002</object-id>
          <label>Figure 2</label>
          <caption>
            <title>Venn diagram showing the gains achieved by combining several clustering programs.</title>
            <p>(A) Combining the GROUPER and RECON programs in particular makes it possible to fully recover more TE sequences than each program alone from the <italic>D. melanogaster</italic> genome. (B) Same conclusion from the <italic>A. thaliana</italic> genome.</p>
          </caption>
          <graphic xlink:href="pone.0016526.g002"/>
        </fig>
      </sec>
    </sec>
    <sec id="s2b">
      <title>Classification of TE consensus sequences and identification of structural variation within TE families</title>
      <sec id="s2b1">
        <title>Classification of the consensus sequences and elimination of redundancy</title>
        <p>The three-step approach provided us with a set of <italic>de novo</italic> consensus sequences corresponding to interspersed sequences occurring at least three times in the genome studied. A two-step classification procedure was implemented to add more biological information, to filter out false-positives and to eliminate the redundancy introduced by the combined approach. There is a long-standing debate about the aims of any classification in biology <xref rid="pone.0016526-Mayr1" ref-type="bibr">[47]</xref>, and the case of genomic repeats does not escape the rule: “Although the reality is that repeats […] are a hierarchical evolutionary continuum that defies classification, it is still desirable to impose a simplistic classification that pretends that repeat families are distinct, for the purpose of practical genome annotation” <xref rid="pone.0016526-Bao1" ref-type="bibr">[39]</xref>. In this spirit, our classification procedure begins with the detection of TE features in the consensus sequences, and a decision tree classifying each consensus as a function of these features is then produced (<xref ref-type="fig" rid="pone-0016526-g003">Figure 3</xref>). In the first step, the procedure identifies terminal repeats, tandem repeats, poly-A tails and SSR-like tails (simple sequence repeats). It also aligns the consensus sequences with known TEs through blastn, blastx and tblastx, and with known genes from the host genome. The known TEs are those from Repbase Update, a curated set of TE sequences from numerous genomes <xref rid="pone.0016526-Jurka1" ref-type="bibr">[48]</xref>. Our TE classifier uses a customized version of this databank available from the Repbase Update website (<ext-link ext-link-type="uri" xlink:href="http://www.girinst.org/repbase/">http://www.girinst.org/repbase/</ext-link>), but any customized databank may be used, provided that it is appropriately formatted. In the second step, the procedure implements a decision tree based on the classification summarized in <xref rid="pone.0016526-Wicker1" ref-type="bibr">[5]</xref>. For benchmarking purposes, when analyzing <italic>de novo</italic> consensus sequences from the <italic>D. melanogaster</italic> and <italic>A. thaliana</italic> genomes, we removed the sequences known to belong to these species from the Repbase Update databank, to establish conditions equivalent to those for the analysis of a new genome.</p>
        <fig id="pone-0016526-g003" position="float">
          <object-id pub-id-type="doi">10.1371/journal.pone.0016526.g003</object-id>
          <label>Figure 3</label>
          <caption>
            <title>Simplified decision tree implemented in the TE classifier.</title>
          </caption>
          <graphic xlink:href="pone.0016526.g003"/>
        </fig>
        <p>The classification takes into account the degree of completeness of the <italic>de novo</italic> TE consensus (<xref ref-type="fig" rid="pone-0016526-g003">Figure 3</xref>). For instance, if a consensus sequence has the required “structural features” — LTRs (long terminal repeats), TIRs (terminal inverted repeats) or a tail (poly-A or SSR-like) — and “coding features” — matches with known TEs in tblastx and blastx analyses — then it is considered “complete”. If it has only one of these two types of features, it is classified as “incomplete”. Moreover, a consensus sequence can be classified as “confused” if our TE classifier detects features known to belong to different categories of TEs or, based on the detected features, its length is outside the range of TEs known to have such features. If the consensus has no identifiable features, it is classified as “not categorized”. We also used length parameters (<xref ref-type="supplementary-material" rid="pone.0016526.s009">Table S6</xref>) benchmarked on the reference databanks — BDGP for <italic>D. melanogaster</italic> and Repbase Update for <italic>A. thaliana</italic> — to improve differentiation between presumably truncated and full-length consensus sequences. We also used length parameters when classifying a sequence having only “structural features”, to determine whether the sequence concerned was a SINE or a MITE.</p>
        <fig id="pone-0016526-g004" position="float">
          <object-id pub-id-type="doi">10.1371/journal.pone.0016526.g004</object-id>
          <label>Figure 4</label>
          <caption>
            <title>Extensive structural variations within several TE families.</title>
            <p>Each image provides an overview of a multiple alignment, a column being in one color if all the residues within it are identical. In all the images, the first sequence in the multiple alignment (red star) is the TE reference sequence from a public databank (BDGP or Repbase). For alignments A to D, the second sequence (blue star) is the only <italic>de novo</italic> consensus in which the TE reference sequence is fully recovered by only one clustering method. All sequences below (in brackets) are TE genomic copies found by the <italic>de novo</italic> consensus analysis. For alignments E to H, the sequences below the TE reference sequence are <italic>de novo</italic> consensus that require manual curation. Beside is indicated the program that build them, “R” for RECON and “G” for GROUPER.</p>
          </caption>
          <graphic xlink:href="pone.0016526.g004"/>
        </fig>
        <p>As shown in <xref ref-type="table" rid="pone-0016526-t002">Table 2</xref> for <italic>D. melanogaster</italic> (<xref ref-type="supplementary-material" rid="pone.0016526.s010">Table S7</xref> for <italic>A. thaliana</italic>), our TE classifier retrieved the appropriate classification for the reference TEs, thus predicting a correct classification for <italic>de novo</italic> consensus sequences. Moreover, each high-level category of the TE classification (<italic>e.g.</italic> “class I LTR-retrotransposon”, “class I LINE”, and “class II DNA transposon”) contained similar proportions of <italic>de novo</italic> consensus sequences and TE reference sequences from the BDGP or Repbase Update databanks. Thus, our procedure efficiently classified <italic>de novo</italic> consensus sequences into the appropriate high-level categories.</p>
        <table-wrap id="pone-0016526-t002" position="float">
          <object-id pub-id-type="doi">10.1371/journal.pone.0016526.t002</object-id>
          <label>Table 2</label>
          <caption>
            <title>TEclassifier results for the classification of <italic>D. melanogaster</italic> TE sequences.</title>
          </caption>
          <alternatives>
            <graphic id="pone-0016526-t002-2" xlink:href="pone.0016526.t002"/>
            <table frame="hsides" rules="groups">
              <colgroup span="1">
                <col align="left" span="1"/>
                <col align="center" span="1"/>
                <col align="center" span="1"/>
                <col align="center" span="1"/>
              </colgroup>
              <thead>
                <tr>
                  <td align="left" rowspan="1" colspan="1">Classification</td>
                  <td align="left" rowspan="1" colspan="1">Reference TEs from the BDGP</td>
                  <td align="left" rowspan="1" colspan="1"><italic>De novo</italic> consensus (with redundancy)</td>
                  <td align="left" rowspan="1" colspan="1"><italic>De novo</italic> consensus (without redundancy)</td>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td align="left" rowspan="1" colspan="1">Class I “complete” LTR retrotransposon</td>
                  <td align="left" rowspan="1" colspan="1">56</td>
                  <td align="left" rowspan="1" colspan="1">150</td>
                  <td align="left" rowspan="1" colspan="1">48</td>
                </tr>
                <tr>
                  <td align="left" rowspan="1" colspan="1">Class I “incomplete” LTR retrotransposon</td>
                  <td align="left" rowspan="1" colspan="1">2</td>
                  <td align="left" rowspan="1" colspan="1">377</td>
                  <td align="left" rowspan="1" colspan="1">209</td>
                </tr>
                <tr>
                  <td align="left" rowspan="1" colspan="1">Class I “complete” LINE</td>
                  <td align="left" rowspan="1" colspan="1">23</td>
                  <td align="left" rowspan="1" colspan="1">117</td>
                  <td align="left" rowspan="1" colspan="1">27</td>
                </tr>
                <tr>
                  <td align="left" rowspan="1" colspan="1">Class I “incomplete” LINE</td>
                  <td align="left" rowspan="1" colspan="1">17</td>
                  <td align="left" rowspan="1" colspan="1">147</td>
                  <td align="left" rowspan="1" colspan="1">57</td>
                </tr>
                <tr>
                  <td align="left" rowspan="1" colspan="1">Class I SINE</td>
                  <td align="left" rowspan="1" colspan="1">0</td>
                  <td align="left" rowspan="1" colspan="1">2</td>
                  <td align="left" rowspan="1" colspan="1">1</td>
                </tr>
                <tr>
                  <td align="left" rowspan="1" colspan="1">Class II “complete” DNA transposon</td>
                  <td align="left" rowspan="1" colspan="1">19</td>
                  <td align="left" rowspan="1" colspan="1">30</td>
                  <td align="left" rowspan="1" colspan="1">13</td>
                </tr>
                <tr>
                  <td align="left" rowspan="1" colspan="1">Class II “incomplete” DNA transposon</td>
                  <td align="left" rowspan="1" colspan="1">2</td>
                  <td align="left" rowspan="1" colspan="1">75</td>
                  <td align="left" rowspan="1" colspan="1">32</td>
                </tr>
                <tr>
                  <td align="left" rowspan="1" colspan="1">Class II MITE</td>
                  <td align="left" rowspan="1" colspan="1">0</td>
                  <td align="left" rowspan="1" colspan="1">8</td>
                  <td align="left" rowspan="1" colspan="1">5</td>
                </tr>
                <tr>
                  <td align="left" rowspan="1" colspan="1">Helitron</td>
                  <td align="left" rowspan="1" colspan="1">1</td>
                  <td align="left" rowspan="1" colspan="1">0</td>
                  <td align="left" rowspan="1" colspan="1">0</td>
                </tr>
                <tr>
                  <td align="left" rowspan="1" colspan="1">SSR</td>
                  <td align="left" rowspan="1" colspan="1">0</td>
                  <td align="left" rowspan="1" colspan="1">8</td>
                  <td align="left" rowspan="1" colspan="1">8</td>
                </tr>
                <tr>
                  <td align="left" rowspan="1" colspan="1">Host genes</td>
                  <td align="left" rowspan="1" colspan="1">0</td>
                  <td align="left" rowspan="1" colspan="1">26</td>
                  <td align="left" rowspan="1" colspan="1">11</td>
                </tr>
                <tr>
                  <td align="left" rowspan="1" colspan="1">Confused</td>
                  <td align="left" rowspan="1" colspan="1">1</td>
                  <td align="left" rowspan="1" colspan="1">20</td>
                  <td align="left" rowspan="1" colspan="1">6</td>
                </tr>
                <tr>
                  <td align="left" rowspan="1" colspan="1">No category</td>
                  <td align="left" rowspan="1" colspan="1">5</td>
                  <td align="left" rowspan="1" colspan="1">341</td>
                  <td align="left" rowspan="1" colspan="1">176</td>
                </tr>
                <tr>
                  <td align="left" rowspan="1" colspan="1">Total</td>
                  <td align="left" rowspan="1" colspan="1">126</td>
                  <td align="left" rowspan="1" colspan="1">1301</td>
                  <td align="left" rowspan="1" colspan="1">593</td>
                </tr>
              </tbody>
            </table>
          </alternatives>
        </table-wrap>
        <p>The proportion of <italic>de novo</italic> consensus sequences classified as “incomplete” was high. In <italic>D. melanogaster</italic>, 75% (45% in <italic>A. thaliana</italic>) of the <italic>de novo</italic> consensus sequences classified as “incomplete” LTR retrotransposons matched only with known LTR retrotransposons from Repbase Update but contained no long terminal repeats. All the <italic>de novo</italic> consensus sequences classified as “incomplete” LINE retrotransposons from <italic>D. melanogaster</italic> (28% of those from <italic>A. thaliana</italic>) matched only known LINE retrotransposons from Repbase Update, but with no polyA-/SSR-like tail. Among the <italic>de novo</italic> consensus sequences classified as “incomplete” DNA transposons, 50% of those from <italic>D. melanogaster</italic> (32% of those from <italic>A. thaliana</italic>) matched only known DNA transposons from Repbase Update, but with no TIR. Thus, these <italic>de novo</italic> consensus sequences are classified as “incomplete” in <italic>D. melanogaster</italic> mostly because they lack terminal features, which is not the case for most such consensus sequences in <italic>A. thaliana</italic>. Thus, the clustering programs combined in the TEdenovo pipeline do not generate systematic bias towards “incomplete” TEs of a given kind.</p>
        <p>Moreover, only a few consensus sequences were classified as “confused”, facilitating manual curation. For instance, one 635-bp long consensus sequence built by RECON from the <italic>D. melanogaster</italic> genome has long terminal repeats as well as a poly-A tail which is contradictory according to our classification scheme derived from <xref rid="pone.0016526-Wicker1" ref-type="bibr">[5]</xref>. The consensus sequences classified as “host genes” are detailed in <xref ref-type="supplementary-material" rid="pone.0016526.s011">Table S8</xref>. The high proportion of unclassified consensus sequences (“no category”) reflects the limitations of this classification scheme. We searched all these consensus sequences for HMM profiles specific to TEs. We detected fragments of known TE profiles in only 14% of these unclassified consensus sequences (data not shown). Several of the other corresponded to Helitron reference sequences recovered intact within unclassified <italic>de novo</italic> consensus sequences. Helitrons are difficult to detect as they have no clear structural features other than a terminal hairpin <xref rid="pone.0016526-Tempel1" ref-type="bibr">[49]</xref>. Nonetheless, our <italic>de novo</italic> approach recovered all those with at least three full-length copies in the genome. This confirms the relevance of the combined <italic>de novo</italic> approach as implemented in the TEdenovo pipeline and shows that <italic>de novo</italic> consensus sequences may correspond to TEs even if they remain unclassified by this method.</p>
        <p>As shown above, the combination of clustering programs gave better results than any single program. However, it also provided redundant consensus sequences. We therefore applied a redundancy elimination procedure, in which we considered a consensus sequence to be redundant if it was included in another sequence, over <italic>x</italic>% of its length, with an identity of more than <italic>y</italic>%. We first tested this procedure directly on the whole <italic>de novo</italic> databank. It resulted in the loss of many well classified consensus sequences that were shorter than the misclassified sequences. We therefore applied the redundancy procedure on the basis of the classification. We decided to remove redundant consensus sequences classified as “incomplete” when they were included within consensus sequences classified as “complete”, but not vice versa. The “80-80-80” rule <xref rid="pone.0016526-Wicker1" ref-type="bibr">[5]</xref> has been proposed as a means of identifying copies from the same TE family: two TE copies may be considered to belong to the same family if they are aligned, with 80% identity, over at least 80 bp and 80% of their respective lengths. However, as this rule was originally developed for TE copies and not for consensus sequences, we also tested more stringent parameters (<xref ref-type="supplementary-material" rid="pone.0016526.s012">Table S9</xref>). We found that the best strategy for obtaining a high-quality <italic>de novo</italic> databank with a low level of redundancy was to remove redundant consensus sequences with more stringent parameters: “95-80-98”. This implies that a consensus sequence is removed if it is included within another consensus sequence over 98% of its length, with an identity level exceeding 95%.</p>
      </sec>
      <sec id="s2b2">
        <title>Comparison of de novo and knowledge-based TE annotations</title>
        <p>After the first phase of analysis with the TEdenovo pipeline, we used the <italic>de novo</italic> TE consensus sequence databank to detect all TE fragments and to reconstruct each TE copy in the genome of interest. This annotation phase was achieved with the TEannot pipeline <xref rid="pone.0016526-Quesneville1" ref-type="bibr">[24]</xref> (<xref ref-type="supplementary-material" rid="pone.0016526.s002">Figure S2</xref>), which is also part of the REPET package. TEannot combines several programs for detecting TE fragments, filtering out false-positives and reconstructing intact TE copies. This process involves the connection of TE fragments from the same copy, a procedure also called “TE defragmentation”. While improving the robustness of this pipeline, we notably improved the connection of TE fragments in the MATCHER algorithm (see <xref ref-type="sec" rid="s4">Methods</xref>). For a comprehensive analysis of the performance of the <italic>de novo</italic> approach presented above, we used the TEannot pipeline on both the <italic>D. melanogaster</italic> and <italic>A. thaliana</italic> genomes, with several databanks of <italic>de novo</italic> consensus sequences, each obtained with a specific combination of programs from the TEdenovo pipeline. We first discarded the consensus sequences that could be unambiguously identified as SSRs or host genes. We then compared each annotation with that obtained with the reference TE libraries from the BDGP and Repbase Update databanks (<xref ref-type="table" rid="pone-0016526-t003">Table 3</xref>).</p>
        <table-wrap id="pone-0016526-t003" position="float">
          <object-id pub-id-type="doi">10.1371/journal.pone.0016526.t003</object-id>
          <label>Table 3</label>
          <caption>
            <title>TE annotation results obtained with reference databanks and <italic>de novo</italic> databanks.</title>
          </caption>
          <alternatives>
            <graphic id="pone-0016526-t003-3" xlink:href="pone.0016526.t003"/>
            <table frame="hsides" rules="groups">
              <colgroup span="1">
                <col align="left" span="1"/>
                <col align="center" span="1"/>
                <col align="center" span="1"/>
                <col align="center" span="1"/>
                <col align="center" span="1"/>
                <col align="center" span="1"/>
                <col align="center" span="1"/>
              </colgroup>
              <thead>
                <tr>
                  <td align="left" rowspan="1" colspan="1">Genome</td>
                  <td align="left" rowspan="1" colspan="1">TE databank</td>
                  <td align="left" rowspan="1" colspan="1">Consensus (having copies)</td>
                  <td align="left" rowspan="1" colspan="1">TE genome coverage</td>
                  <td align="left" rowspan="1" colspan="1">Number of copies</td>
                  <td align="left" rowspan="1" colspan="1">S<sub>n</sub>
</td>
                  <td align="left" rowspan="1" colspan="1">S<sub>p</sub>
</td>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td align="left" rowspan="1" colspan="1">
                    <italic>D. mel.</italic>
                  </td>
                  <td align="left" rowspan="1" colspan="1">BDGP</td>
                  <td align="left" rowspan="1" colspan="1">125</td>
                  <td align="left" rowspan="1" colspan="1">10.51%</td>
                  <td align="left" rowspan="1" colspan="1">31208</td>
                  <td align="left" rowspan="1" colspan="1">NA</td>
                  <td align="left" rowspan="1" colspan="1">NA</td>
                </tr>
                <tr>
                  <td align="left" rowspan="1" colspan="1">
                    <italic>D. mel.</italic>
                  </td>
                  <td align="left" rowspan="1" colspan="1">GROUPER</td>
                  <td align="left" rowspan="1" colspan="1">712</td>
                  <td align="left" rowspan="1" colspan="1">10.29%</td>
                  <td align="left" rowspan="1" colspan="1">43699</td>
                  <td align="left" rowspan="1" colspan="1">81.92%</td>
                  <td align="left" rowspan="1" colspan="1">98.12%</td>
                </tr>
                <tr>
                  <td align="left" rowspan="1" colspan="1">
                    <italic>D. mel.</italic>
                  </td>
                  <td align="left" rowspan="1" colspan="1">RECON</td>
                  <td align="left" rowspan="1" colspan="1">437</td>
                  <td align="left" rowspan="1" colspan="1">11.05%</td>
                  <td align="left" rowspan="1" colspan="1">33072</td>
                  <td align="left" rowspan="1" colspan="1">87.77%</td>
                  <td align="left" rowspan="1" colspan="1">97.95%</td>
                </tr>
                <tr>
                  <td align="left" rowspan="1" colspan="1">
                    <italic>D. mel.</italic>
                  </td>
                  <td align="left" rowspan="1" colspan="1">PILER</td>
                  <td align="left" rowspan="1" colspan="1">114</td>
                  <td align="left" rowspan="1" colspan="1">8.87%</td>
                  <td align="left" rowspan="1" colspan="1">32789</td>
                  <td align="left" rowspan="1" colspan="1">74.07%</td>
                  <td align="left" rowspan="1" colspan="1">98.79%</td>
                </tr>
                <tr>
                  <td align="left" rowspan="1" colspan="1">
                    <italic>D. mel.</italic>
                  </td>
                  <td align="left" rowspan="1" colspan="1">RepeatScout</td>
                  <td align="left" rowspan="1" colspan="1">1432</td>
                  <td align="left" rowspan="1" colspan="1">10.86%</td>
                  <td align="left" rowspan="1" colspan="1">42048</td>
                  <td align="left" rowspan="1" colspan="1">85.28%</td>
                  <td align="left" rowspan="1" colspan="1">97.88%</td>
                </tr>
                <tr>
                  <td align="left" rowspan="1" colspan="1">
                    <italic>D. mel.</italic>
                  </td>
                  <td align="left" rowspan="1" colspan="1">G+R+P</td>
                  <td align="left" rowspan="1" colspan="1">568</td>
                  <td align="left" rowspan="1" colspan="1">11.98%</td>
                  <td align="left" rowspan="1" colspan="1">42847</td>
                  <td align="left" rowspan="1" colspan="1">91.43%</td>
                  <td align="left" rowspan="1" colspan="1">97.35%</td>
                </tr>
                <tr>
                  <td align="left" rowspan="1" colspan="1">
                    <italic>A. tha.</italic>
                  </td>
                  <td align="left" rowspan="1" colspan="1">Repbase</td>
                  <td align="left" rowspan="1" colspan="1">318</td>
                  <td align="left" rowspan="1" colspan="1">19.02%</td>
                  <td align="left" rowspan="1" colspan="1">41146</td>
                  <td align="left" rowspan="1" colspan="1">NA</td>
                  <td align="left" rowspan="1" colspan="1">NA</td>
                </tr>
                <tr>
                  <td align="left" rowspan="1" colspan="1">
                    <italic>A. tha.</italic>
                  </td>
                  <td align="left" rowspan="1" colspan="1">GROUPER</td>
                  <td align="left" rowspan="1" colspan="1">1237</td>
                  <td align="left" rowspan="1" colspan="1">18.78%</td>
                  <td align="left" rowspan="1" colspan="1">41791</td>
                  <td align="left" rowspan="1" colspan="1">79.29%</td>
                  <td align="left" rowspan="1" colspan="1">95.43%</td>
                </tr>
                <tr>
                  <td align="left" rowspan="1" colspan="1">
                    <italic>A. tha.</italic>
                  </td>
                  <td align="left" rowspan="1" colspan="1">RECON</td>
                  <td align="left" rowspan="1" colspan="1">1004</td>
                  <td align="left" rowspan="1" colspan="1">23.69%</td>
                  <td align="left" rowspan="1" colspan="1">49470</td>
                  <td align="left" rowspan="1" colspan="1">88.75%</td>
                  <td align="left" rowspan="1" colspan="1">91.59%</td>
                </tr>
                <tr>
                  <td align="left" rowspan="1" colspan="1">
                    <italic>A. tha.</italic>
                  </td>
                  <td align="left" rowspan="1" colspan="1">PILER</td>
                  <td align="left" rowspan="1" colspan="1">300</td>
                  <td align="left" rowspan="1" colspan="1">13.14%</td>
                  <td align="left" rowspan="1" colspan="1">34818</td>
                  <td align="left" rowspan="1" colspan="1">56.56%</td>
                  <td align="left" rowspan="1" colspan="1">97.05%</td>
                </tr>
                <tr>
                  <td align="left" rowspan="1" colspan="1">
                    <italic>A. tha.</italic>
                  </td>
                  <td align="left" rowspan="1" colspan="1">RepeatScout</td>
                  <td align="left" rowspan="1" colspan="1">2893</td>
                  <td align="left" rowspan="1" colspan="1">21.95%</td>
                  <td align="left" rowspan="1" colspan="1">68958</td>
                  <td align="left" rowspan="1" colspan="1">82.91%</td>
                  <td align="left" rowspan="1" colspan="1">92.36%</td>
                </tr>
                <tr>
                  <td align="left" rowspan="1" colspan="1">
                    <italic>A. tha.</italic>
                  </td>
                  <td align="left" rowspan="1" colspan="1">G+R+P</td>
                  <td align="left" rowspan="1" colspan="1">1232</td>
                  <td align="left" rowspan="1" colspan="1">22.77%</td>
                  <td align="left" rowspan="1" colspan="1">44059</td>
                  <td align="left" rowspan="1" colspan="1">87.03%</td>
                  <td align="left" rowspan="1" colspan="1">92.32%</td>
                </tr>
              </tbody>
            </table>
          </alternatives>
          <table-wrap-foot>
            <fn id="nt102">
              <label/>
              <p>“<italic>D. mel.</italic>” stands for “<italic>D. melanogaster</italic>” and “<italic>A. tha.</italic>” stands for “<italic>A. thaliana</italic>”. The S<sub>n</sub> and S<sub>p</sub> columns correspond respectively to sensitivity and specificity results when comparing two annotations in terms of nucleotide overlaps. “G+R+P” indicates that the three programs GROUPER, RECON and PILER were used to build the databank of <italic>de novo</italic> consensus sequences.</p>
            </fn>
          </table-wrap-foot>
        </table-wrap>
        <p>In <italic>D. melanogaster</italic> (<xref ref-type="table" rid="pone-0016526-t003">Table 3</xref>), when using only one clustering method, the GROUPER databank delivered the annotation closest to that obtained with the BDGP reference databank in terms of genome coverage and copy number. Sensitivity was highest with the RECON databank and specificity was highest with the PILER databank. The annotation shows high sensitivity and specificity, together with a high level of genome coverage, for the combined approach. Similar conclusions were drawn from the annotations for <italic>A. thaliana</italic>. An examination of match boundaries (<xref ref-type="supplementary-material" rid="pone.0016526.s003">Figure S3</xref> and <xref ref-type="supplementary-material" rid="pone.0016526.s013">Table S10</xref>) showed that the clustering methods were complementary: GROUPER gave the largest number of exact matches in <italic>D. melanogaster</italic> whereas RECON gave the largest number of exact matches in <italic>A. thaliana</italic>. About RepeatScout, although the specificity of its annotation is very similar with our combined approach, its sensitivity is much lower. Moreover, based only on <xref ref-type="table" rid="pone-0016526-t003">Table 3</xref>, it may appear that using “RECON” gives similar results than using our combined “G+R+P” approach. However, as shown above in <xref ref-type="fig" rid="pone-0016526-g002">Figure 2</xref>, “RECON” is not able to fully recover several TE reference sequences which are fully recovered only by “GROUPER”, and reciprocally. Biologically speaking, it is better to recover a full TE reference sequence as one consensus sequence, rather than several truncated or artifactual consensus sequences. In this context, not only the “G+R+P” approach builds a better library of TE <italic>de novo</italic> consensus sequences, but such a library is also able to provide reliable TE annotation. Thus, the combination of clustering methods in the TEdenovo pipeline leads to the construction of a high-quality TE library delivering annotations similar to those obtained for manually curated databanks.</p>
        <p>We then compared the results of our analyses with those obtained with RepeatModeler (<ext-link ext-link-type="uri" xlink:href="http://www.repeatmasker.org/RepeatModeler.html">http://www.repeatmasker.org/RepeatModeler.html</ext-link>), which combines RECON, RepeatScout, RepeatMasker and TRF and classifies the consensus sequences obtained. For <italic>D. melanogaster</italic>, RepeatModeler generated a library of 141 consensus sequences, with a sensitivity of 78% and a specificity of 76%. However, the recovery ratio of RepeatModeler (R<sub>CC</sub> = 21%) was much lower than that of the TEdenovo pipeline (R<sub>CC</sub> = 72%). This indicates that RepeatModeler recovers only a few intact TE reference sequences. Similar results were obtained for <italic>A. thaliana</italic>, with all three measurements showing lower values with RepeatModeler than with TEdenovo (<xref ref-type="supplementary-material" rid="pone.0016526.s014">Table S11</xref>). Running the TEannot pipeline with the consensus sequences generated by RepeatModeler resulted in a sensitivity markedly lower than that for the annotations obtained with the <italic>de novo</italic> library from the TEdenovo pipeline, although specificity was slightly higher (<xref ref-type="supplementary-material" rid="pone.0016526.s015">Table S12</xref>). The combination of several tools is therefore not sufficient in itself to improve the results. The way in which the tools are chosen and combined is determinant. We conclude that the TEdenovo pipeline achieves a good balance between sensitivity and specificity in the <italic>de novo</italic> construction of a TE databank from raw genomic sequences.</p>
        <p>We therefore developed the REPET package available online (<ext-link ext-link-type="uri" xlink:href="http://urgi.versailles.inra.fr/index.php/repet">http://urgi.versailles.inra.fr/index.php/repet</ext-link>), into which we integrated both the TEdenovo and TEannot pipelines, with the TE classifier described above corresponding to the final step of the TEdenovo pipeline. The REPET package was specifically designed to improve speed and tractability by (i) interacting with MySQL tables at several key points to take advantage of the SQL language, and (ii) automatically handling jobs launched in parallel on a cluster <italic>via</italic> free batch-queuing systems, such as the Sun Grid Engine (now known as Oracle Gene Engine), relaunching jobs in cases of cluster node failure. This package is thus specifically implemented for computationally intensive, genome-wide analyses that do not compromise the biological relevance of the results (see <xref ref-type="supplementary-material" rid="pone.0016526.s016">Table S13</xref> for details about computation times). As already pointed out by several authors, tools for <italic>de novo</italic> TE identification are “quite difficult to use, indicating the need for better user interfaces and auto-optimization” <xref rid="pone.0016526-Saha1" ref-type="bibr">[32]</xref>. We facilitated the use of our tools, by concealing technical details behind interfaces, one per pipeline. The user is also provided with access to a detailed tutorial and a configuration file with default parameters.</p>
      </sec>
      <sec id="s2b3">
        <title>Identification of structural variation within TE families and manual curation</title>
        <p>After annotating the TE copies in both genomes, we investigated the structural diversity within TE families, as represented by the large number of <italic>de novo</italic> consensus. We focused on the TE families for which the “knowledge-based” consensus was fully recovered by only one clustering method, GROUPER or RECON, as shown in <xref ref-type="fig" rid="pone-0016526-g002">Figure 2</xref> (see also <xref ref-type="supplementary-material" rid="pone.0016526.s017">Table S14</xref> and <xref ref-type="supplementary-material" rid="pone.0016526.s018">Table S15</xref>). Indeed, the failure of one method (either GROUPER or RECON) to recover all the TEs would illustrate differences in the ability of these methods to take TE structural variations into account. For each of these TE families, we retrieved genomic copies detected by the <italic>de novo</italic> consensus and built multiple alignments (see <xref ref-type="sec" rid="s4">Methods</xref>). <xref ref-type="fig" rid="pone-0016526-g004">Figure 4</xref> (cases a, b, c and d) provides an overview of several of these multiple alignments displaying extensive structural variations. In almost all TE families, differences between genomic copies were observed, due to substitutions and indels. The clustering method generated different clusters as a function of these differences and the fragmentation of the copies. Depending on the specific features of each algorithm, the consensus will correspond to the complete TE reference sequence or a truncated version of that sequence.</p>
        <p>We then looked for features particular to the TE families for which the reference sequence was fully recovered by only one clustering method, being recovered only partially with another method. We first compared the classification of these TE reference sequences. In <italic>D. melanogaster</italic>, the four TE reference sequences fully recovered only by GROUPER were all LTR retrotransposons, whereas the nine TE reference sequences fully recovered only by RECON comprised four LTR retrotransposons, three LINE retrotransposons and two DNA transposons. In <italic>A. thaliana</italic>, the eight TE reference sequences fully recovered only by GROUPER comprised five LTR retrotransposons and three DNA transposons, whereas the fifteen TE reference sequences fully recovered only by RECON comprised six LTR retrotransposons, eight DNA transposons and one Helitron. There were therefore no clear differences in the recovery of full-length TE reference sequences obtained with different clustering methods. We also looked for differences in terms of copy number. However, the TE reference sequences fully recovered only by GROUPER or only by RECON had similar numbers of full-length and truncated copies (data not shown). Comparisons of <italic>de novo</italic> consensuses and “knowledge-based” consensuses, as in <xref ref-type="table" rid="pone-0016526-t001">Table 1</xref>, showed that RECON was systematically the most sensitive method, whereas GROUPER was systematically the most specific. As a result, several TE reference sequences displayed partial matches with <italic>de novo</italic> consensuses from RECON only. Moreover, almost 50% of the <italic>de novo</italic> consensus sequences from RECON lacked both boundaries of the TE reference sequences, versus less than 20% of the consensus sequences from GROUPER. Conversely, a <italic>de novo</italic> library from GROUPER is likely to match with fewer TE reference sequences, but, when a match does occur, at least one boundary of the reference is likely to be correctly retrieved. Consequently, GROUPER and RECON are truly complementary, making the combined approach implemented in the TEdenovo pipeline very efficient.</p>
        <p>Our TE classifier can combine <italic>de novo</italic> consensus sequences from various sources, but manual curation is still required in some cases, particularly when there are several consensus sequences related to the same TE family (<xref ref-type="supplementary-material" rid="pone.0016526.s019">Table S16</xref>). <xref ref-type="fig" rid="pone-0016526-g004">Figure 4</xref> (alignments E to H) shows several examples in which manual curation of the <italic>de novo</italic> consensus sequences identified by GROUPER and RECON for a given TE family improves the recovery of the reference sequence. For instance, in <xref ref-type="fig" rid="pone-0016526-g004">Figure 4-E</xref>, all consensus sequences from RECON are truncated before the 3′ LTR of the ATLANTYS2 element whereas the G1184 consensus sequence from GROUPER connects this LTR with part of the internal region of the element. In <xref ref-type="fig" rid="pone-0016526-g004">Figure 4-F</xref>, two consensuses can be removed, G512 from GROUPER, a a solo-LTR, and G803, which is chimeric. Moreover, we can add the internal region of the element present in G1497, which lacks the 3′ LTR, to the truncated R474 from RECON. A similar strategy can be applied in <xref ref-type="fig" rid="pone-0016526-g004">figures 4-G and 4-H</xref>. Thus, although it is not always possible to recover the full reference sequence, we can improve the final <italic>de novo</italic> consensus by manual curation, making use of the multiple alignment of classified consensuses to guide informed decision-making.</p>
        <p>The TEdenovo pipeline identified putative new TEs in the <italic>D. melanogaster</italic> and <italic>A. thaliana</italic> genomes, despite the intensity with which these genomes have been studied and annotated manually. Indeed, we found <italic>de novo</italic> consensus sequences that were classified as “complete” TE but had no single match in blastn with known TE reference sequences from the BDGP or Repbase Update databanks. Three such sequences were identified in <italic>D. melanogaster</italic> (two from GROUPER and one from RECON), and four in <italic>A. thaliana</italic> (three from RECON and one from PILER). For example, in <italic>D. melanogaster</italic>, a 7.8 kb <italic>de novo</italic> consensus was classified as a “complete” LTR retrotransposon on the basis of its two long terminal repeats (each 510 nt long) and its matches with known LTR retrotransposons from Repbase Update in tblastx and blastx analyses. Furthermore, this consensus matched two HMM profiles corresponding to an integrase and an aspartic proteinase. There were four full-length copies in the genome, two of which retained their target site duplications. This <italic>de novo</italic> consensus sequence is probably non autonomous, as it lacks matches with HMM profiles corresponding to other LTR retrotransposon genes, and, notably, displays no match with a reverse transcriptase. However, it has enough of the typical properties of TEs and enough full-length copies to correspond to a true TE, rather than a mere segmental duplication containing TE fragments.</p>
      </sec>
    </sec>
  </sec>
  <sec id="s3">
    <title>Discussion</title>
    <sec id="s3a">
      <title>Combining approaches to build high-quality TE <italic>de novo</italic> consensus sequence databanks for sequenced genomes</title>
      <p>Transposable elements play a key role in the structure and evolution of genomes, but their impact remains to be fully elucidated. If we are to make use of the increasing numbers of genome sequencing projects to improve our understanding of TE biology, we will need an efficient, automatic <italic>de novo</italic> approach for the annotation of genome TE content. Several methods praised for their rapidity and low memory requirements, such as the MDR index <xref rid="pone.0016526-Kurtz1" ref-type="bibr">[50]</xref>, and P-clouds <xref rid="pone.0016526-Gu1" ref-type="bibr">[51]</xref>, provide a good overview of the repeat content of a given genome. However, they are not precise enough to provide insight into the functional impact of TEs (see for instance <xref rid="pone.0016526-Newman1" ref-type="bibr">[52]</xref> and <xref rid="pone.0016526-Teixeira1" ref-type="bibr">[53]</xref>). As such, these methods are good starting points but are inadequate for a full exploration of biological questions relating to TEs.</p>
      <p>The typical process of TE annotation, as we see it, should involve the identification of all TE copies throughout the genome and proceed in two phases. The first step is the construction of a <italic>de novo</italic> library of TE consensus sequences representing the TE families present in the genome. This library is then used to mine all the TE fragments present in the genome. The TE copies are then reconstructed, usually nested within each other, to unravel their intricate evolution. We describe here a new strategy for constructing databanks of TE consensus sequences by <italic>de novo</italic> methods. Our results for the <italic>D. melanogaster</italic> and <italic>A. thaliana</italic> genomes show that an approach combining several clustering programs provides the best outcome, in terms of sensitivity and specificity, for the identification of TE families and the annotation of their TE copies.</p>
      <p>Previous studies have already compared tools for <italic>de novo</italic> TE identification, either to propose a new algorithm (as for RECON, PILER and RepeatScout) or to help experimental biologists to use the most suitable tools for their analysis <xref rid="pone.0016526-Saha1" ref-type="bibr">[32]</xref>. In most of these studies, the results were validated by comparing the final TE copy annotations in terms of genome coverage, rather than by evaluating the accuracy of <italic>de novo</italic> TE consensus sequence identification. Little attention has been paid to analyses of the <italic>de novo</italic> databank itself. The use of consensus sequences corresponding to truncated or artifactual TEs would clearly bias subsequent annotations. We therefore propose three indices for measuring the quality of <italic>de novo</italic> databanks, with respect to reference databanks. This combined approach was validated by considering the proportion of <italic>de novo</italic> consensus sequences corresponding to full-length reference sequences, with well-defined boundaries.</p>
    </sec>
    <sec id="s3b">
      <title>Classification of TE sequences on the basis of their biological features and the curation of TE <italic>de novo</italic> databanks</title>
      <p>The tools typically used for the <italic>de novo</italic> identification of TE families provide no additional meta-data about the consensus sequences they build. Instead, the user has to use other tools to obtain a putative classification of the sequences obtained. Here, we implemented a combined <italic>de novo</italic> approach for the identification of TE families and developed a dedicated procedure for classifying sequences on the basis of TE features. We based our TE classifier on the classification proposed in <xref rid="pone.0016526-Wicker1" ref-type="bibr">[5]</xref>, from class to superfamily, combining various sources of information about TEs in a modular manner. This procedure was designed to be run in isolation for the analysis of any databank of putative TE-related sequences and for integration into the TEdenovo pipeline, to facilitate its use.</p>
      <p>The current version of our tool, TEclassifier, requires further improvement for the classification of less well known TEs, such as DIRS-like elements, Penelope-like elements, Crypton elements and Polintons/Mavericks. However, unlike tools like TEclass <xref rid="pone.0016526-Abrusan1" ref-type="bibr">[54]</xref>, which makes use of the profiles of frequent <italic>k</italic>-mers from the Repbase Update databank, our TE classifier guides output classification by detailing the precise TE features present on the analyzed sequences, such as terminal repeats and matches with known TEs. Our tool and REPclass <xref rid="pone.0016526-Feschotte2" ref-type="bibr">[55]</xref> are very similar, but our TE classifier has several advantages. Being part of the REPET package, it benefits from the architecture of this package and is therefore able to handle large databanks, which is often required when studying large genomes. Moreover, our TE classifier not only classifies putative TEs, it also makes it possible to filter out false-positives and to remove redundant sequences present in the input databank.</p>
      <p>In a wider perspective, we considered manual curation, a key topic in genome annotation. Computer-based predictions for the annotations of protein-coding genes are now of high quality, but it remains difficult to predict exon-intron boundaries correctly <xref rid="pone.0016526-Brent1" ref-type="bibr">[56]</xref>. Major efforts have been and are being made to improve the automatic annotation of protein-coding regions, but such efforts have been much less intensive for other parts of the genome, including TEs. In this study, we tried to fill this gap by designing the REPET package for the comprehensive association of all the meta-data obtained for a given TE family: (i) the <italic>de novo</italic> consensus sequences, (ii) the TE features used to classify them, (iii) the all-by-all comparisons from which they were built, and (iv) the TE copies they identify on the chromosomes. As a result, the manual curator can make informed decisions based on the biological features at hand, and the curated TE consensus databank can be used to provide a second release of TE annotations.</p>
    </sec>
    <sec id="s3c">
      <title>Efficiency of <italic>de novo</italic> approaches for recovering ancestral TEs and their structural variants from “junk”</title>
      <p>At the core of any <italic>de novo</italic> approach lies the possibility of identifying new agents in a given system by searching for their fundamental properties. In our case, we were confronted with raw whole-genome sequences containing numerous repeated sequences of different kinds, some of which have specific features and a common ancestry. We were interested in identifying, from among these sequences, TEs — interspersed repeats — and, more particularly, the ancestral sequences that actually transposed. The current copies of such sequences are likely to be divergent, fragmented and nested within each other, as TE families typically display extensive structural variation (<xref ref-type="fig" rid="pone-0016526-g004">Figure 4 A–D</xref>). We showed in this study that the <italic>de novo</italic> approach could recover some full-length TE sequences by correctly collecting together their fragments, even if no TE feature could be used to classify them. This was the case here for several Helitron reference sequences in the <italic>A. thaliana</italic> genome. Similarly, we were able to identify putative new non autonomous TEs in the <italic>D. melanogaster</italic> and <italic>A. thaliana</italic> genomes that had all the essential features of TEs but were nonetheless absent from the reference databanks.</p>
      <p>Efficient and robust tools are essential to keep pace with current whole-genome sequencing programs. Our analyses were performed on small model genomes. However, the <italic>de novo</italic> approach and the tools we presented here are scalable, at least to genomes reaching 500 Mb. Indeed, preliminary versions of the TEdenovo and TEannot pipelines were used to annotate the TE content of the 464-Mb aphid genome totalizing 38% of TEs <xref rid="pone.0016526-The2" ref-type="bibr">[31]</xref>. Moreover, our tools are modular and almost all steps can be launched in parallel, thus taking advantage of today's computer clusters. Future work will be dedicated to the improvement of the clustering step in the TEdenovo pipeline in order to provide, also to very large genomes, the ability to jointly annotate TEs and study their diversification. For all projects in which the aim is to sequence large and highly repetitive genomes (<italic>e.g.</italic> barley, hexaploid wheat), computational tools, such as the TEdenovo pipeline presented here, are likely to become increasingly useful for increasing our knowledge of the evolution of genome structure and the functional impact of TEs on neighboring genes.</p>
    </sec>
  </sec>
  <sec sec-type="methods" id="s4">
    <title>Methods</title>
    <sec id="s4a">
      <title>Genome sequences and TE reference databanks as benchmark</title>
      <p>In 2000, an international consortium driven by the Berkeley Drosophila Genome Project (BDGP) sequenced, assembled and annotated the genome of an isogenic <italic>y</italic>; <italic>cn bw sp</italic> strain of <italic>D. melanogaster</italic>
<xref rid="pone.0016526-Adams1" ref-type="bibr">[57]</xref>, this work now being continued at FlyBase (<ext-link ext-link-type="uri" xlink:href="http://flybase.org/">http://flybase.org/</ext-link>). In this study, we used the 118.4 Mb release 4 genome sequence corresponding mostly to euchromatin regions. Release 5 became available in 2006 and corresponds to release 4 with 50.3 Mb of additional heterochromatic regions and minor sequence corrections. We chose to work on release 4, which remains the <italic>D. melanogaster</italic> genomic sequence best annotated for TEs <xref rid="pone.0016526-Quesneville1" ref-type="bibr">[24]</xref>, <xref rid="pone.0016526-Bergman1" ref-type="bibr">[25]</xref>, despite the availability of the later sequence.</p>
      <p>Flybase provides a set of natural TE sequences experimentally identified in several Drosophilidae genomes. The latest version of this data set (bdgp9.41) consists of 179 sequences corresponding to different TE families, 126 of which have been detected in <italic>D. melanogaster</italic> strains. Each of these 126 sequences corresponds either to a TE copy of the given family present in <italic>D. melanogaster</italic> or to a consensus based on TE copies for the family concerned. In the latter case, consensuses were built either as a mosaic of TE copies or following a “majority rule” from a multiple alignment. In this study, these 126 sequences are referred to as “reference TEs”. The aim of the <italic>de novo</italic> approach presented in this article is to reconstruct such a library of TE sequences.</p>
      <p>In 2000, 115 Mb of the 125 Mb genome of <italic>A. thaliana</italic> accession Columbia had been sequenced, assembled and annotated <xref rid="pone.0016526-The3" ref-type="bibr">[58]</xref>. For our analyses, we used the 119 Mb of <italic>A. thaliana</italic> release 9 genome sequences available from the TAIR website (<ext-link ext-link-type="uri" xlink:href="http://www.arabidopsis.org/">http://www.arabidopsis.org/</ext-link>). For <italic>A. thaliana</italic>, a similar set of reference TEs is present in the Repbase Update databank. We used the library derived from this databank for previous studies <xref rid="pone.0016526-Buisine1" ref-type="bibr">[29]</xref> and containing 318 TE sequences.</p>
      <p>We annotated both genomes with the TEannot pipeline <xref rid="pone.0016526-Quesneville1" ref-type="bibr">[24]</xref> using the reference databanks cited above. We then constructed a consensus for each reference sequence, from the multiple alignment of copies when at least three copies longer than 100 bp were present (<xref ref-type="supplementary-material" rid="pone.0016526.s020">Table S17</xref>). For <italic>D. melanogaster</italic>, a consensus could be obtained for only 117 of the 126 reference sequences in the BDGP databank, referred to as a “knowledge-based” consensus: 68 of these sequences corresponded exactly to their reference element, the others being truncated. For <italic>A. thaliana</italic>, it was possible to construct 305 “knowledge-based” consensuses for the 318 TE reference sequences in the Repbase Update databank: 154 corresponded to the entire element and the others were truncated. These consensuses were collected into “knowledge-based” databanks. As such, they represent the upper limit of what can be retrieved with the <italic>de novo</italic> methods compared in this study (<xref ref-type="supplementary-material" rid="pone.0016526.s021">Table S18</xref>).</p>
    </sec>
    <sec id="s4b">
      <title><italic>De novo</italic> detection of TEs</title>
      <p>A three-step approach forms the backbone of our analysis: (i) self-alignment of the genomic sequences, (ii) clustering of the resulting matches, and (iii) multiple alignments of each cluster to build a consensus (<xref ref-type="supplementary-material" rid="pone.0016526.s001">Figure S1</xref>). Different programs may be used at each step, leading to several possible combinations. For each combination, we compared the <italic>de novo</italic> consensus with the set of reference TEs. Other methods are also available for constructing a consensus for comparison with the “knowledge-based” databanks constructed as described above.</p>
      <p>When comparing a <italic>de novo</italic> databank with a “knowledge-based” databank, it is not possible to calculate the number of false-negatives, <italic>i.e.</italic> the <italic>de novo</italic> consensus sequences incorrectly classified as not related to a TE because these consensus sequences are not present in the <italic>de novo</italic> library. The usual definitions of sensitivity and specificity are therefore not directly applicable. We estimated sensitivity by calculating the proportion of “knowledge-based” consensus sequences matching <italic>de novo</italic> consensus sequences (noted S<sub>n</sub>*). We then estimated specificity by considering the proportion of <italic>de novo</italic> consensus sequences matching “knowledge-based” consensus sequences (noted S<sub>p</sub>*). The observation of a <italic>de novo</italic> consensus that matches a “knowledge-based” consensus, both aligned along their entire lengths (+- 5%) indicates that this <italic>de novo</italic> consensus retrieved the exact and entire “knowledge-based” consensus. A recovery ratio (noted R<sub>CC</sub> for “complete-complete ratio”) can be calculated as the number of “knowledge-based” consensus sequences exactly retrieved by a <italic>de novo</italic> consensus, divided by the number of reference sequences exactly retrieved by a “knowledge-based” consensus. In <italic>D. melanogaster</italic>, 68 reference sequences (of the 126 in the BDGP databank) were exactly retrieved by a “knowledge-based” consensus, and 154 such sequences (of the 318 in Repbase Update) were exactly retrieved in <italic>A. thaliana</italic>. As an illustration, in <italic>D. melanogaster</italic>, if a given <italic>de novo</italic> method recovers 60 entire “knowledge-based” consensus sequences from a given genome, R<sub>CC</sub> would be 88% (60/68).</p>
      <sec id="s4b1">
        <title>First step: self-alignment of the genomic sequences</title>
        <p>The first step is the self-alignment of the genomic sequences in an all-by-all manner. We compared two programs, BLASTER <xref rid="pone.0016526-Quesneville3" ref-type="bibr">[36]</xref> and PALS <xref rid="pone.0016526-Rasmussen1" ref-type="bibr">[38]</xref> for this purpose. BLASTER is a wrapper for the BLAST softwares <xref rid="pone.0016526-Altschul1" ref-type="bibr">[37]</xref>. It was used for comparisons at the genome scale. It begins by cutting long queries into batches and launching them in parallel against the subject databank. The second program, PALS, implements a filter algorithm. It first finds all exact matches of length <italic>q</italic> between the query and subject sequences. It then restricts the search by identifying regions (parallelograms in the alignment matrix) containing a number of hits above a given threshold. Finally, if these regions have a length above a given threshold, PALS develops a chain of hits for each region, aligns the nucleotides and returns the coordinates of the resulting matches. For BLASTER, we kept matches with E-value below 10<sup>−300</sup>, a length exceeding 100 bp and an identity exceeding 90% (parameters “-E 1e-300 -L 100 -I 90”). For PALS, we used the default parameters: identity exceeding 94% and a length of more than 400 bp (parameters “-length 400 -pctid 94”). If the same parameters were used for BLASTER (identity &gt;90% and length &gt;100 bp), the computations took too long, even when launched in parallel. If the parameters length &gt;100 bp and identity &gt;94% were used with both programs, BLASTER still gave better results (data not shown).</p>
        <p>When all the matches had been retrieved, we discarded all those that were more than 20,000 bp long. This procedure was designed to filter out repeats corresponding to long segmental duplications. The issue of short segmental duplications was addressed in the next step. To speed up the computations, the input genome sequences were cut into chunks of length 200 kb with 10kb overlaps. These values are parameters of the tool and can thus be changed easily, according to the genome size, its repeat content, as well as technical details such as the number of nodes in the computer cluster. Each chunk was then aligned against the whole set of chunks, in parallel. Finally all the matches were collected together and redundant matches were filtered out.</p>
      </sec>
      <sec id="s4b2">
        <title>Second step: clustering of the resulting pairwise alignments</title>
        <p>The matches obtained in the first step were then clustered, and we tested three different programs for this step: GROUPER (<xref rid="pone.0016526-Quesneville3" ref-type="bibr">[36]</xref>, parameters “-j -C 0.95 -Z 3 -X 2 -G -1”), RECON (<xref rid="pone.0016526-Bao1" ref-type="bibr">[39]</xref>, default parameters) and PILER (<xref rid="pone.0016526-Edgar1" ref-type="bibr">[40]</xref>, parameter “-trs”).</p>
        <p>As TEs are frequently inserted within each other, GROUPER first aims at retrieving the full-length copies by connecting their fragments <italic>via</italic> a dynamic programming algorithm applied to the pairwise alignments. It links together, in chains, the matches corresponding to fragments belonging to the same TE copy but interrupted by indels. It then uses single-link clustering to gather similar chains of matches into the same cluster, using a high-coverage constraint (95%), and merges chains corresponding to the same locus. The use of a high-coverage constraint makes it possible to identify different structural variants from a given TE family (<xref ref-type="fig" rid="pone-0016526-g001">Figure 1</xref>): two copies from two different variants overlap by less than 95% threshold, and are therefore assigned to different clusters. The previous version of GROUPER suffered from the high redundancy among clusters, preventing its usage in practice on large genomes. Therefore, we implemented a new procedure that specifies, during the single-link clustering step, if a chain of matches is fully included within another one, as is often the case with non-autonomous TEs with respect to their autonomous counterparts. Once the clusters are built, we now remove those having less than a given number of members not included in any others (option “-X 2”).</p>
        <p>RECON uses a different strategy, first trying to infer the ancestral TE copies, named “elements”, from all the fragments at each locus. It does this by single-link clustering with a low-coverage constraint (50%), followed by an additional procedure focusing on the aggregation of endpoints to ensure the correct handling of composite elements, such as segmental duplications. It then gathers the “elements” into families again by single-link clustering, but this time with a high-coverage constraint (90%), and a procedure is then applied to deal with families that are related but different, based on length ratio and similarity thresholds.</p>
        <p>We also tested the PILER suite of programs. In this work, “PILER” refers systematically to PILER-DF, which focuses on interspersed repeats. PILER first defines “piles” as lists of matches covering a maximal contiguous region. It then globally aligns these piles, rather than the individual matches themselves. This prevents bias towards the shortest match in the pile. Finally, piles that cannot be globally aligned with each other over 95% of their length are gathered into clusters.</p>
        <p>All these three programs, GROUPER, RECON and PILER, return a set of clusters to which we applied several filters. First, we removed the clusters with fewer than three members. This discarded most of the short segmental duplications. Second, for large clusters, we retained only the 20 longest sequences, as keeping all the sequences would not add much information for the building of a consensus and would even introduce noise (data not shown). Third, for GROUPER, we filtered the sequences resulting from connected matches (<italic>i.e.</italic> chains) with a cumulative length greater than 20 kb and spanning more than 30 kb of the genome, as such sequences probably corresponded to segmental duplications.</p>
      </sec>
      <sec id="s4b3">
        <title>Third step: multiple alignments and consensus construction</title>
        <p>Finally, for each cluster, a multiple sequence alignment (MSA) was constructed, from which a consensus was derived. We compared several programs: MAP (<xref rid="pone.0016526-Huang1" ref-type="bibr">[42]</xref>, parameters “gap-size = 50 mismatch = −8 gap-open = 16 gap-extend = 4”), CLUSTAL-W (<xref rid="pone.0016526-Thompson1" ref-type="bibr">[43]</xref>, default parameters), MAFFT (<xref rid="pone.0016526-Katoh1" ref-type="bibr">[44]</xref>, parameter “–auto”) and PRANK (<xref rid="pone.0016526-Loytynoja1" ref-type="bibr">[45]</xref>, parameter “-F”). The consensus was constructed by applying a majority rule discarding columns in which all but one sequence had a gap.</p>
        <p>MAP was specifically designed to handle long gaps. Such gaps frequently occur when aligning TE copies of different lengths from the same TE family. In this program, gaps are not penalized beyond a given length. CLUSTAL-W is a well known progressive MSA algorithm, and was the first to propose position-specific gap penalties. MAFFT addresses the issue of CPU time by using Fast Fourier Transform for the rapid detection of homologous segments. It also implements a normalized similarity matrix that is said to perform better for alignments with sequences of different lengths. This program was the fastest MSA program we tested. PRANK takes into account the phylogenetic information contained in indels to distinguish insertions from deletions, to position them properly and avoid the overestimation of deletions. This sophistication renders PRANK much slower than MAP (10 times slower for a typical cluster containing 16 sequences of 8 kb each).</p>
      </sec>
      <sec id="s4b4">
        <title>Other approaches</title>
        <p>Other methods have also been proposed. We tested REPEATSCOUT <xref rid="pone.0016526-Price1" ref-type="bibr">[46]</xref> and RepeatModeler (Smit and Hubley unpublished), both with default parameters. RepeatScout begins by keeping high-frequency strings of length <italic>k</italic>, called <italic>k</italic>-mers. The program initially takes the most frequent <italic>k</italic>-mer and sets the consensus as being the <italic>k</italic>-mer in question. Based on the multiple alignment of all its occurrences, the program extends this consensus one nucleotide at a time, in both directions, according to a specific scoring function. For correct definition of the consensus boundaries, the scoring function is designed to allow extension of the consensus, even if shared by some alignments, but not all. Once the consensus can be extended no further, the program detects all its occurrences in the genome, and updates the initial table of <italic>k</italic>-mer frequencies accordingly. This procedure is applied iteratively for each <italic>k</italic>-mer with a frequency above a given threshold.</p>
      </sec>
    </sec>
    <sec id="s4c">
      <title>Classification of TE consensus and the elimination of redundancy</title>
      <p>We implemented a two-step TE classifier. The first step detects structural features of the consensus, such as terminal repeats, tandem repeats, and polyA or SSR-like tails, using programs from the REPET package (TRsearch, polyAtail) or elsewhere (TRF, <xref rid="pone.0016526-Benson1" ref-type="bibr">[59]</xref>). It also searches for matches with known TEs, by blastx, tblastx and blastn analysis, and for matches with known genes from the host's genome, by blastn analysis. The second step is based on a decision tree (<xref ref-type="fig" rid="pone-0016526-g003">Figure 3</xref>) classifying each consensus according to its length and features. The classification and the evidence underlying the classification are delivered as output. Any program looking for other TE features, such as Helitron hairpins, could easily be integrated into this framework.</p>
      <p>We eliminated redundant consensus sequences, by discarding all those included within another consensus sequence, for at least <italic>x</italic>% of their length, and with at least <italic>y</italic>% identity. We tested several values for <italic>x</italic> and <italic>y</italic>: 95-98, 90-90 and 80-80. We tested this procedure with and without taking into account the classification of the sequences.</p>
    </sec>
    <sec id="s4d">
      <title>Genome-wide annotation of TE copies</title>
      <p>A combined pipeline named TEannot for the genome-wide annotation of TE copies is already available <xref rid="pone.0016526-Quesneville1" ref-type="bibr">[24]</xref> (<xref ref-type="supplementary-material" rid="pone.0016526.s002">Figure S2</xref>). As input, it takes the genome sequences and a databank of TE sequences, typically that generated by the TEdenovo pipeline. It then launches BLASTER <xref rid="pone.0016526-Quesneville3" ref-type="bibr">[36]</xref>, RepeatMasker (<ext-link ext-link-type="uri" xlink:href="http://www.repeatmasker.org/">http://www.repeatmasker.org/</ext-link>) and CENSOR <xref rid="pone.0016526-Jurka2" ref-type="bibr">[60]</xref>, to map the TE sequences against the genome. False-positives are filtered out by applying the same procedure to shuffled genomic sequences. More precisely, the genomic sequences are randomized using the “shuffle” program of the HMMER package (<ext-link ext-link-type="uri" xlink:href="http://hmmer.janelia.org/">http://hmmer.janelia.org/</ext-link>). The TE reference sequences are then mapped onto these shuffled sequences with BLASTER, RepeatMasker and CENSOR, with the score for each match recorded. Finally, the matches between the TE reference sequences and the true genomic sequences are filtered according to these scores. Whereas in a previous version of the pipeline we used the highest score obtained on randomized genomic sequences to filter false-positives, we now use the 95% quantile of the scores obtained on the randomized sequences. This improvement prevents excessive filtering, using a single, very good match on randomized sequences, much better than most others. This change slightly increases TE coverage over previous estimations.</p>
      <p>Once the matches were filtered, we began to reconstruct the TE copies, to obtain a true annotation of TE copies and not of TE fragments only. In this pipeline, two steps are used to connect several TE fragments belonging to the same TE copy: MATCHER <xref rid="pone.0016526-Quesneville3" ref-type="bibr">[36]</xref> and the “long join” procedure. As in the <italic>de novo</italic> library, a TE family may be represented by several consensus sequences corresponding to each of its structural variants. We improved these tools to take this into account. In terms of vocabulary, we define a “TE fragment” as a match between a TE consensus sequence and a genomic sequence, whereas we define a “TE copy” as a chain of matches, each match in the chain being a TE fragment. Note that a full-length TE copy may correspond to two TE fragments, which, when connected together, correspond to the full TE consensus sequence.</p>
      <p>In the previous version of MATCHER, we began by combining the matches found by all three algorithms mentioned above. When two consensus sequences overlapped at a given locus, we retained the sequence with the highest score and truncated the other. We then connected the remaining matches by dynamic programming. In the current version of MATCHER, we first connect the matches by dynamic programming and then filter out overlapping chains of matches. A match that might have been filtered out in the previous version may not be filtered out in the current version, if it is chained with another match, thereby improving fragment connections. TE annotations would be improved by taking into account chains of matches (whole TE copies) rather than TE fragments (single matches).</p>
      <p>Once matches are connected by MATCHER, the TEannot pipeline also detects microsatellites by launching and combining the results of TRF <xref rid="pone.0016526-Benson1" ref-type="bibr">[59]</xref>, Mreps <xref rid="pone.0016526-Kolpakov1" ref-type="bibr">[61]</xref> and RepeatMasker. All TE copies are then combined with microsatellite coordinates to filter out short TE matches fully recovered by microsatellites.</p>
      <p>In the same spirit, we improved the “long join” procedure. We previously sorted the chains of matches on the basis of length, as a proxy for the age of the TE copies. The rationale behind this was that a TE copy may disappear slowly due to small deletions, becoming shorter over time. We now estimate the age of a TE copy by calculating the ratio of match identity to match length, summing this ratio for all matches in the chain.</p>
      <p>Finally, we compared the annotations obtained with <italic>de novo</italic> libraries and reference databanks, by calculating genome coverage and TE copy number, together with sensitivity and specificity, in terms of nucleotide overlaps (<xref ref-type="supplementary-material" rid="pone.0016526.s003">Figure S3</xref>). A high sensitivity indicates that the annotation based on <italic>de novo</italic> consensus sequences misses few TE nucleotides (false-negatives). A high specificity indicates that the <italic>de novo</italic> annotation identifies few non-TE nucleotides (false-positives).</p>
    </sec>
    <sec id="s4e">
      <title>Reconstruction of TE families</title>
      <p>We compared the patterns of diversification between TE families, by mining the genome with the <italic>de novo</italic> consensus sequences, using BLAT <xref rid="pone.0016526-Kent1" ref-type="bibr">[62]</xref> for the rapid identification of well conserved genomic copies. We then constructed a multiple alignment with the TE reference sequence from the public databank, the <italic>de novo</italic> consensus sequence and the genomic copies identified with this sequence (see <xref ref-type="fig" rid="pone-0016526-g004">Figure 4 A–D</xref>). For the identification of TE families represented by several <italic>de novo</italic> consensus sequences, we clustered <italic>de novo</italic> consensus sequences with BLASTCLUST from the NCBI-BLAST suite (<xref rid="pone.0016526-Dondoshansky1" ref-type="bibr">[63]</xref>, parameters “-S 0 -L 0.8 -b F -p F”). We then added the best TE reference sequence corresponding to each cluster, and finally built a multiple alignment. The addition of the reference sequence after clustering prevents the <italic>de novo</italic> consensus sequences from being clustered together solely because they overlap with the same reference sequence. This procedure can therefore be used to assist manual curation for newly sequenced genomes without known reference sequences. Multiple alignments were checked by eye, using Jalview <xref rid="pone.0016526-Waterhouse1" ref-type="bibr">[64]</xref>.</p>
    </sec>
  </sec>
  <sec sec-type="supplementary-material" id="s5">
    <title>Supporting Information</title>
    <supplementary-material content-type="local-data" id="pone.0016526.s001">
      <label>Figure S1</label>
      <caption>
        <p>
          <bold>Flow chart of the three first steps of the TEdenovo pipeline.</bold>
        </p>
        <p>(TIF)</p>
      </caption>
      <media xlink:href="pone.0016526.s001.tif">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pone.0016526.s002">
      <label>Figure S2</label>
      <caption>
        <p>
          <bold>Flow chart of the TEannot pipeline.</bold>
        </p>
        <p>(TIF)</p>
      </caption>
      <media xlink:href="pone.0016526.s002.tif">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pone.0016526.s003">
      <label>Figure S3</label>
      <caption>
        <p>
          <bold>Comparison of two TE annotations in terms of match boundaries.</bold>
        </p>
        <p>(TIF)</p>
      </caption>
      <media xlink:href="pone.0016526.s003.tif">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pone.0016526.s004">
      <label>Table S1</label>
      <caption>
        <p>
          <bold>Comparative analysis of self-alignment programs.</bold>
        </p>
        <p>(PDF)</p>
      </caption>
      <media xlink:href="pone.0016526.s004.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pone.0016526.s005">
      <label>Table S2</label>
      <caption>
        <p>
          <bold>Comparative analysis of clustering programs.</bold>
        </p>
        <p>(PDF)</p>
      </caption>
      <media xlink:href="pone.0016526.s005.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pone.0016526.s006">
      <label>Table S3</label>
      <caption>
        <p>
          <bold>Comparative analysis of multiple alignment programs.</bold>
        </p>
        <p>(PDF)</p>
      </caption>
      <media xlink:href="pone.0016526.s006.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pone.0016526.s007">
      <label>Table S4</label>
      <caption>
        <p>
          <bold>Results of the RepeatScout program.</bold>
        </p>
        <p>(PDF)</p>
      </caption>
      <media xlink:href="pone.0016526.s007.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pone.0016526.s008">
      <label>Table S5</label>
      <caption>
        <p>
          <bold>Results obtained with a combination of several clustering programs in the de novo approach.</bold>
        </p>
        <p>(PDF)</p>
      </caption>
      <media xlink:href="pone.0016526.s008.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pone.0016526.s009">
      <label>Table S6</label>
      <caption>
        <p>
          <bold>Length parameters used in the TEclassifier program.</bold>
        </p>
        <p>(PDF)</p>
      </caption>
      <media xlink:href="pone.0016526.s009.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pone.0016526.s010">
      <label>Table S7</label>
      <caption>
        <p>
          <bold>Results of the classification of TE sequences from A. thaliana.</bold>
        </p>
        <p>(PDF)</p>
      </caption>
      <media xlink:href="pone.0016526.s010.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pone.0016526.s011">
      <label>Table S8</label>
      <caption>
        <p>
          <bold>Consensus sequences matching known genes of D. melanogaster.</bold>
        </p>
        <p>(PDF)</p>
      </caption>
      <media xlink:href="pone.0016526.s011.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pone.0016526.s012">
      <label>Table S9</label>
      <caption>
        <p>
          <bold>Parameters of the tests for redundancy elimination in TEclassifier.</bold>
        </p>
        <p>(PDF)</p>
      </caption>
      <media xlink:href="pone.0016526.s012.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pone.0016526.s013">
      <label>Table S10</label>
      <caption>
        <p>
          <bold>Results of coordinate comparisons for TE annotation.</bold>
        </p>
        <p>(PDF)</p>
      </caption>
      <media xlink:href="pone.0016526.s013.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pone.0016526.s014">
      <label>Table S11</label>
      <caption>
        <p>
          <bold>Comparison of the performances of the RepeatModeler and TEdenovo databanks.</bold>
        </p>
        <p>(PDF)</p>
      </caption>
      <media xlink:href="pone.0016526.s014.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pone.0016526.s015">
      <label>Table S12</label>
      <caption>
        <p>
          <bold>Comparison of the performances of TE annotation with the databanks of de novo consensus sequences from RepeatModeler and TEdenovo.</bold>
        </p>
        <p>(PDF)</p>
      </caption>
      <media xlink:href="pone.0016526.s015.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pone.0016526.s016">
      <label>Table S13</label>
      <caption>
        <p>
          <bold>Computation times of the TEdenovo/TEannot pipelines and RepeatScout on the D. melanogaster and A. thaliana genomes.</bold>
        </p>
        <p>(PDF)</p>
      </caption>
      <media xlink:href="pone.0016526.s016.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pone.0016526.s017">
      <label>Table S14</label>
      <caption>
        <p>
          <bold>Reference sequences entirely retrieved by one clustering method but not by the others, in the D. melanogaster genome.</bold>
        </p>
        <p>(PDF)</p>
      </caption>
      <media xlink:href="pone.0016526.s017.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pone.0016526.s018">
      <label>Table S15</label>
      <caption>
        <p>
          <bold>Reference sequences entirely retrieved by one clustering method but not by the others, in the A. thaliana genome.</bold>
        </p>
        <p>(PDF)</p>
      </caption>
      <media xlink:href="pone.0016526.s018.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pone.0016526.s019">
      <label>Table S16</label>
      <caption>
        <p>
          <bold>List of TE families represented by several de novo consensus sequences.</bold>
        </p>
        <p>(PDF)</p>
      </caption>
      <media xlink:href="pone.0016526.s019.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pone.0016526.s020">
      <label>Table S17</label>
      <caption>
        <p>
          <bold>TE reference sequences for which no “knowledge-based” consensus could be built.</bold>
        </p>
        <p>(PDF)</p>
      </caption>
      <media xlink:href="pone.0016526.s020.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pone.0016526.s021">
      <label>Table S18</label>
      <caption>
        <p>
          <bold>Comparison of “knowledge-based” libraries with reference databanks.</bold>
        </p>
        <p>(PDF)</p>
      </caption>
      <media xlink:href="pone.0016526.s021.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <ack>
    <p>We wish to thank Emmanuelle Permal, Joëlle Amselem and Victoria Dominguez for helpful comments on the <italic>de novo</italic> approach, Olivier Inizan for his work on the REPET package, Claire Hoede for her help with the TE HMM profiles, and Isabelle Luyten and Sébastien Reboux for their help with the computer infrastructure required for such an analysis. We also thank the GenOuest platform for allowing us to run our analyses on their computer cluster.</p>
  </ack>
  <fn-group>
    <fn fn-type="COI-statement">
      <p><bold>Competing Interests: </bold>The authors have declared that no competing interests exist.</p>
    </fn>
    <fn fn-type="financial-disclosure">
      <p><bold>Funding: </bold>Timothée Flutre was funded by the Institut National de la Recherche Agronomique (INRA) (ASC), Elodie Duprat held a fellowship from the Université Pierre et Marie Curie (UPMC) (ATER) and this work was funded by a grant from the Agence Nationale de la Recherche (ANR-05-MMSA-0010) to Hadi Quesneville. The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.</p>
    </fn>
  </fn-group>
  <ref-list>
    <title>References</title>
    <ref id="pone.0016526-Orgel1">
      <label>1</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Orgel</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Crick</surname>
            <given-names>F</given-names>
          </name>
        </person-group>
        <year>1980</year>
        <article-title>Selfish DNA: the ultimate parasite.</article-title>
        <source>Nature</source>
        <volume>284</volume>
        <fpage>604</fpage>
        <lpage>607</lpage>
        <pub-id pub-id-type="pmid">7366731</pub-id>
      </element-citation>
    </ref>
    <ref id="pone.0016526-Brookfield1">
      <label>2</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Brookfield</surname>
            <given-names>JFY</given-names>
          </name>
        </person-group>
        <year>2005</year>
        <article-title>The ecology of the genome - mobile DNA elements and their hosts.</article-title>
        <source>Nature Reviews Genetics</source>
        <volume>6</volume>
        <fpage>128</fpage>
        <lpage>136</lpage>
      </element-citation>
    </ref>
    <ref id="pone.0016526-Lynch1">
      <label>3</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lynch</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Conery</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <year>2003</year>
        <article-title>The origins of genome complexity.</article-title>
        <source>Science</source>
        <volume>302</volume>
        <fpage>1401</fpage>
        <lpage>1404</lpage>
        <pub-id pub-id-type="pmid">14631042</pub-id>
      </element-citation>
    </ref>
    <ref id="pone.0016526-Finnegan1">
      <label>4</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Finnegan</surname>
            <given-names>D</given-names>
          </name>
        </person-group>
        <year>1989</year>
        <article-title>Eukaryotic transposable elements and genome evolution.</article-title>
        <source>Trends in Genetics</source>
        <volume>5</volume>
        <fpage>103</fpage>
        <lpage>107</lpage>
        <pub-id pub-id-type="pmid">2543105</pub-id>
      </element-citation>
    </ref>
    <ref id="pone.0016526-Wicker1">
      <label>5</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wicker</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Sabot</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Hua-Van</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Bennetzen</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Capy</surname>
            <given-names>P</given-names>
          </name>
          <etal/>
        </person-group>
        <year>2007</year>
        <article-title>A unified classification system for eukaryotic transposable elements.</article-title>
        <source>Nature Reviews Genetics</source>
        <volume>8</volume>
        <fpage>973</fpage>
        <lpage>982</lpage>
      </element-citation>
    </ref>
    <ref id="pone.0016526-Wessler1">
      <label>6</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wessler</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <year>1995</year>
        <article-title>LTR-retrotransposons and MITEs: important players in the evolution of plant genomes.</article-title>
        <source>Current Opinion in Genetics and Development</source>
        <volume>5</volume>
        <fpage>814</fpage>
        <lpage>821</lpage>
        <pub-id pub-id-type="pmid">8745082</pub-id>
      </element-citation>
    </ref>
    <ref id="pone.0016526-Yang1">
      <label>7</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Yang</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Nagel</surname>
            <given-names>DH</given-names>
          </name>
          <name>
            <surname>Feschotte</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Hancock</surname>
            <given-names>CN</given-names>
          </name>
          <name>
            <surname>Wessler</surname>
            <given-names>SR</given-names>
          </name>
        </person-group>
        <year>2009</year>
        <article-title>Tuned for transposition: molecular determinants underlying the hyperactivity of a Stowaway MITE.</article-title>
        <source>Science</source>
        <volume>325</volume>
        <fpage>1391</fpage>
        <lpage>1394</lpage>
        <pub-id pub-id-type="pmid">19745152</pub-id>
      </element-citation>
    </ref>
    <ref id="pone.0016526-Gray1">
      <label>8</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Gray</surname>
            <given-names>Y</given-names>
          </name>
        </person-group>
        <year>2000</year>
        <article-title>It takes two transposons to tango: transposable-element-mediated chromosomal rearrangements.</article-title>
        <source>Trends in Genetics</source>
        <volume>16</volume>
        <fpage>461</fpage>
        <lpage>468</lpage>
        <pub-id pub-id-type="pmid">11050333</pub-id>
      </element-citation>
    </ref>
    <ref id="pone.0016526-Eichler1">
      <label>9</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Eichler</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Sankoff</surname>
            <given-names>D</given-names>
          </name>
        </person-group>
        <year>2003</year>
        <article-title>Structural dynamics of eukaryotic chromosome evolution.</article-title>
        <source>Science</source>
        <volume>301</volume>
        <fpage>793</fpage>
        <lpage>797</lpage>
        <pub-id pub-id-type="pmid">12907789</pub-id>
      </element-citation>
    </ref>
    <ref id="pone.0016526-Coghlan1">
      <label>10</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Coghlan</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Eichler</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Oliver</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Paterson</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Stein</surname>
            <given-names>L</given-names>
          </name>
        </person-group>
        <year>2005</year>
        <article-title>Chromosome evolution in eukaryotes: a multi-kingdom perspective.</article-title>
        <source>Trends in Genetics</source>
        <volume>21</volume>
        <fpage>673</fpage>
        <lpage>682</lpage>
        <pub-id pub-id-type="pmid">16242204</pub-id>
      </element-citation>
    </ref>
    <ref id="pone.0016526-Paux1">
      <label>11</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Paux</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Sourdille</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Salse</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Saintenac</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Choulet</surname>
            <given-names>F</given-names>
          </name>
          <etal/>
        </person-group>
        <year>2008</year>
        <article-title>A Physical Map of the 1-Gigabase Bread Wheat Chromosome 3B.</article-title>
        <source>Science</source>
        <volume>322</volume>
        <fpage>101</fpage>
        <lpage>104</lpage>
        <pub-id pub-id-type="pmid">18832645</pub-id>
      </element-citation>
    </ref>
    <ref id="pone.0016526-McClintock1">
      <label>12</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>McClintock</surname>
            <given-names>B</given-names>
          </name>
        </person-group>
        <year>1956</year>
        <article-title>Controlling elements and the gene.</article-title>
        <source>Cold Spring Harbor Symposia on Quantitative Biology</source>
        <volume>21</volume>
        <fpage>197</fpage>
        <lpage>216</lpage>
        <pub-id pub-id-type="pmid">13433592</pub-id>
      </element-citation>
    </ref>
    <ref id="pone.0016526-Slotkin1">
      <label>13</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Slotkin</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Martienssen</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <year>2007</year>
        <article-title>Transposable elements and the epigenetic regulation of the genome.</article-title>
        <source>Nature Reviews Genetics</source>
        <volume>8</volume>
        <fpage>272</fpage>
        <lpage>285</lpage>
      </element-citation>
    </ref>
    <ref id="pone.0016526-Martin1">
      <label>14</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Martin</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Troadec</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Boualem</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Rajab</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Fernandez</surname>
            <given-names>R</given-names>
          </name>
          <etal/>
        </person-group>
        <year>2009</year>
        <article-title>A transposon-induced epigenetic change leads to sex determination in melon.</article-title>
        <source>Nature</source>
        <volume>461</volume>
        <fpage>1135</fpage>
        <lpage>1138</lpage>
        <pub-id pub-id-type="pmid">19847267</pub-id>
      </element-citation>
    </ref>
    <ref id="pone.0016526-Feschotte1">
      <label>15</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Feschotte</surname>
            <given-names>C</given-names>
          </name>
        </person-group>
        <year>2008</year>
        <article-title>Transposable elements and the evolution of regulatory networks.</article-title>
        <source>Nature Reviews Genetics</source>
        <volume>9</volume>
        <fpage>397</fpage>
        <lpage>405</lpage>
      </element-citation>
    </ref>
    <ref id="pone.0016526-Herpin1">
      <label>16</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Herpin</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Braasch</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Kraeussling</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Schmidt</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Thoma</surname>
            <given-names>E</given-names>
          </name>
          <etal/>
        </person-group>
        <year>2010</year>
        <article-title>Transcriptional rewiring of the sex determining dmrt1 gene duplicate by transposable elements.</article-title>
        <source>PLoS Genetics</source>
        <volume>6</volume>
        <fpage>e1000844+</fpage>
        <pub-id pub-id-type="pmid">20169179</pub-id>
      </element-citation>
    </ref>
    <ref id="pone.0016526-Cordaux1">
      <label>17</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Cordaux</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Udit</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Batzer</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Feschotte</surname>
            <given-names>C</given-names>
          </name>
        </person-group>
        <year>2006</year>
        <article-title>Birth of a chimeric primate gene by capture of the transposase gene from a mobile element.</article-title>
        <source>Proceedings of the National Academy of Sciences</source>
        <volume>103</volume>
        <fpage>8101</fpage>
        <lpage>8106</lpage>
      </element-citation>
    </ref>
    <ref id="pone.0016526-Santangelo1">
      <label>18</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Santangelo</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>de Souza</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Franchini</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Bumaschny</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Low</surname>
            <given-names>M</given-names>
          </name>
          <etal/>
        </person-group>
        <year>2007</year>
        <article-title>Ancient exaptation of a CORE-SINE retroposon into a highly conserved mammalian neuronal enhancer of the proopiomelanocortin gene.</article-title>
        <source>PLoS Genetics</source>
        <volume>3</volume>
      </element-citation>
    </ref>
    <ref id="pone.0016526-Agrawal1">
      <label>19</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Agrawal</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Eastman</surname>
            <given-names>QM</given-names>
          </name>
          <name>
            <surname>Schatz</surname>
            <given-names>DG</given-names>
          </name>
        </person-group>
        <year>1998</year>
        <article-title>Transposition mediated by RAG1 and RAG2 and its implications for the evolution of the immune system.</article-title>
        <source>Nature</source>
        <volume>394</volume>
        <fpage>744</fpage>
        <lpage>751</lpage>
        <pub-id pub-id-type="pmid">9723614</pub-id>
      </element-citation>
    </ref>
    <ref id="pone.0016526-Zhou1">
      <label>20</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zhou</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Mitra</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Atkinson</surname>
            <given-names>PW</given-names>
          </name>
          <name>
            <surname>Burgess Hickman</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Dyda</surname>
            <given-names>F</given-names>
          </name>
          <etal/>
        </person-group>
        <year>2004</year>
        <article-title>Transposition of hAT elements links transposable elements and V(D)J recombination.</article-title>
        <source>Nature</source>
        <volume>432</volume>
        <fpage>995</fpage>
        <lpage>1001</lpage>
        <pub-id pub-id-type="pmid">15616554</pub-id>
      </element-citation>
    </ref>
    <ref id="pone.0016526-Schuster1">
      <label>21</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Schuster</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <year>2008</year>
        <article-title>Next-generation sequencing transforms today's biology.</article-title>
        <source>Nature Methods</source>
        <volume>5</volume>
        <fpage>16</fpage>
        <lpage>18</lpage>
        <pub-id pub-id-type="pmid">18165802</pub-id>
      </element-citation>
    </ref>
    <ref id="pone.0016526-Schnable1">
      <label>22</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Schnable</surname>
            <given-names>PS</given-names>
          </name>
          <name>
            <surname>Ware</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Fulton</surname>
            <given-names>RS</given-names>
          </name>
          <name>
            <surname>Stein</surname>
            <given-names>JC</given-names>
          </name>
          <name>
            <surname>Wei</surname>
            <given-names>F</given-names>
          </name>
          <etal/>
        </person-group>
        <year>2009</year>
        <article-title>The B73 maize genome: complexity, diversity, and dynamics.</article-title>
        <source>Science</source>
        <volume>326</volume>
        <fpage>1112</fpage>
        <lpage>1115</lpage>
        <pub-id pub-id-type="pmid">19965430</pub-id>
      </element-citation>
    </ref>
    <ref id="pone.0016526-Bourque1">
      <label>23</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bourque</surname>
            <given-names>G</given-names>
          </name>
        </person-group>
        <year>2009</year>
        <article-title>Transposable elements in gene regulation and in the evolution of vertebrate genomes.</article-title>
        <source>Current Opinion in Genetics and Development</source>
        <volume>19</volume>
        <fpage>607</fpage>
        <lpage>612</lpage>
        <pub-id pub-id-type="pmid">19914058</pub-id>
      </element-citation>
    </ref>
    <ref id="pone.0016526-Quesneville1">
      <label>24</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Quesneville</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Bergman</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Andrieu</surname>
            <given-names>O</given-names>
          </name>
          <name>
            <surname>Autard</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Nouaud</surname>
            <given-names>D</given-names>
          </name>
          <etal/>
        </person-group>
        <year>2005</year>
        <article-title>Combined evidence annotation of transposable elements in genome sequences.</article-title>
        <source>PLoS Computational Biology</source>
        <volume>1</volume>
        <fpage>166</fpage>
        <lpage>175</lpage>
        <pub-id pub-id-type="pmid">16110336</pub-id>
      </element-citation>
    </ref>
    <ref id="pone.0016526-Bergman1">
      <label>25</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bergman</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Quesneville</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Anxolabehere</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Ashburner</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <year>2006</year>
        <article-title>Recurrent insertion and duplication generate networks of transposable element sequences in the Drosophila melanogaster genome.</article-title>
        <source>Genome Biology</source>
        <volume>7</volume>
        <fpage>R112+</fpage>
        <pub-id pub-id-type="pmid">17134480</pub-id>
      </element-citation>
    </ref>
    <ref id="pone.0016526-Nene1">
      <label>26</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Nene</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Wortman</surname>
            <given-names>JR</given-names>
          </name>
          <name>
            <surname>Lawson</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Haas</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Kodira</surname>
            <given-names>C</given-names>
          </name>
          <etal/>
        </person-group>
        <year>2007</year>
        <article-title>Genome sequence of Aedes aegypti, a major Arbovirus vector.</article-title>
        <source>Science</source>
        <volume>316</volume>
        <fpage>1718</fpage>
        <lpage>1723</lpage>
        <pub-id pub-id-type="pmid">17510324</pub-id>
      </element-citation>
    </ref>
    <ref id="pone.0016526-Cuomo1">
      <label>27</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Cuomo</surname>
            <given-names>CA</given-names>
          </name>
          <name>
            <surname>Guldener</surname>
            <given-names>U</given-names>
          </name>
          <name>
            <surname>Xu</surname>
            <given-names>JR</given-names>
          </name>
          <name>
            <surname>Trail</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Turgeon</surname>
            <given-names>BG</given-names>
          </name>
          <etal/>
        </person-group>
        <year>2007</year>
        <article-title>The Fusarium graminearum genome reveals a link between localized polymorphism and pathogen specialization.</article-title>
        <source>Science</source>
        <volume>317</volume>
        <fpage>1400</fpage>
        <lpage>1402</lpage>
        <pub-id pub-id-type="pmid">17823352</pub-id>
      </element-citation>
    </ref>
    <ref id="pone.0016526-The1">
      <label>28</label>
      <element-citation publication-type="journal">
        <collab>The 12 Drosophila Genomes Consortium</collab>
        <year>2007</year>
        <article-title>Evolution of genes and genomes on the Drosophila phylogeny.</article-title>
        <source>Nature</source>
        <volume>450</volume>
        <fpage>203</fpage>
        <lpage>218</lpage>
        <pub-id pub-id-type="pmid">17994087</pub-id>
      </element-citation>
    </ref>
    <ref id="pone.0016526-Buisine1">
      <label>29</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Buisine</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Quesneville</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Colot</surname>
            <given-names>V</given-names>
          </name>
        </person-group>
        <year>2008</year>
        <article-title>Improved detection and annotation of transposable elements in sequenced genomes using multiple reference sequence sets.</article-title>
        <source>Genomics</source>
        <volume>91</volume>
        <fpage>467</fpage>
        <lpage>475</lpage>
        <pub-id pub-id-type="pmid">18343092</pub-id>
      </element-citation>
    </ref>
    <ref id="pone.0016526-Abad1">
      <label>30</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Abad</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Gouzy</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Aury</surname>
            <given-names>JM</given-names>
          </name>
          <name>
            <surname>Castagnone-Sereno</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Danchin</surname>
            <given-names>EGJG</given-names>
          </name>
          <etal/>
        </person-group>
        <year>2008</year>
        <article-title>Genome sequence of the metazoan plant-parasitic nematode Meloidogyne incognita.</article-title>
        <source>Nature Biotechnology</source>
        <fpage>909</fpage>
        <lpage>915</lpage>
      </element-citation>
    </ref>
    <ref id="pone.0016526-The2">
      <label>31</label>
      <element-citation publication-type="journal">
        <collab>The International Aphid Genomics Consortium</collab>
        <year>2010</year>
        <article-title>Genome sequence of the pea aphid Acyrthosiphon pisum.</article-title>
        <source>PLoS Biology</source>
        <volume>8</volume>
        <fpage>e1000313+</fpage>
        <pub-id pub-id-type="pmid">20186266</pub-id>
      </element-citation>
    </ref>
    <ref id="pone.0016526-Saha1">
      <label>32</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Saha</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Bridges</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Magbanua</surname>
            <given-names>ZV</given-names>
          </name>
          <name>
            <surname>Peterson</surname>
            <given-names>DG</given-names>
          </name>
        </person-group>
        <year>2008</year>
        <article-title>Empirical comparison of ab initio repeat finding programs.</article-title>
        <source>Nucl Acids Res</source>
        <volume>36</volume>
        <fpage>2284</fpage>
        <lpage>2294</lpage>
        <pub-id pub-id-type="pmid">18287116</pub-id>
      </element-citation>
    </ref>
    <ref id="pone.0016526-Jiang1">
      <label>33</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Jiang</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Jordan</surname>
            <given-names>IK</given-names>
          </name>
          <name>
            <surname>Wessler</surname>
            <given-names>SR</given-names>
          </name>
        </person-group>
        <year>2002</year>
        <article-title>Dasheng and RIRE2. A nonautonomous Long Terminal Repeat element and its putative autonomous partner in the rice genome.</article-title>
        <source>Plant Physiol</source>
        <volume>130</volume>
        <fpage>1697</fpage>
        <lpage>1705</lpage>
        <pub-id pub-id-type="pmid">12481052</pub-id>
      </element-citation>
    </ref>
    <ref id="pone.0016526-Quesneville2">
      <label>34</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Quesneville</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Nouaud</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Anxolabehere</surname>
            <given-names>D</given-names>
          </name>
        </person-group>
        <year>2006</year>
        <article-title>P elements and MITE relatives in the whole genome sequence of Anopheles gambiae.</article-title>
        <source>BMC genomics</source>
        <volume>7</volume>
        <fpage>214+</fpage>
        <pub-id pub-id-type="pmid">16919158</pub-id>
      </element-citation>
    </ref>
    <ref id="pone.0016526-Bergman2">
      <label>35</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bergman</surname>
            <given-names>CMM</given-names>
          </name>
          <name>
            <surname>Quesneville</surname>
            <given-names>H</given-names>
          </name>
        </person-group>
        <year>2007</year>
        <article-title>Discovering and detecting transposable elements in genome sequences.</article-title>
        <source>Briefings in Bioinformatics</source>
        <volume>8</volume>
        <fpage>382</fpage>
        <lpage>392</lpage>
        <pub-id pub-id-type="pmid">17932080</pub-id>
      </element-citation>
    </ref>
    <ref id="pone.0016526-Quesneville3">
      <label>36</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Quesneville</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Nouaud</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Anxolabehere</surname>
            <given-names>D</given-names>
          </name>
        </person-group>
        <year>2003</year>
        <article-title>Detection of new transposable element families in Drosophila melanogaster and Anopheles gambiae genomes.</article-title>
        <source>Journal of Molecular Evolution</source>
        <volume>57</volume>
      </element-citation>
    </ref>
    <ref id="pone.0016526-Altschul1">
      <label>37</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Altschul</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Gish</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Miller</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Myers</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Lipman</surname>
            <given-names>D</given-names>
          </name>
        </person-group>
        <year>1990</year>
        <article-title>Basic local alignment search tool.</article-title>
        <source>Journal of Molecular Biology</source>
        <volume>215</volume>
        <fpage>403</fpage>
        <lpage>410</lpage>
        <pub-id pub-id-type="pmid">2231712</pub-id>
      </element-citation>
    </ref>
    <ref id="pone.0016526-Rasmussen1">
      <label>38</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Rasmussen</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Stoye</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Myers</surname>
            <given-names>E</given-names>
          </name>
        </person-group>
        <year>2006</year>
        <article-title>Efficient q-gram filters for finding all epsilon-matches over a given length.</article-title>
        <source>Journal of Computational Biology</source>
        <volume>13</volume>
        <fpage>296</fpage>
        <lpage>308</lpage>
        <pub-id pub-id-type="pmid">16597241</pub-id>
      </element-citation>
    </ref>
    <ref id="pone.0016526-Bao1">
      <label>39</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bao</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Eddy</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <year>2002</year>
        <article-title>Automated de novo identification of repeat sequence families in sequenced genomes.</article-title>
        <source>Genome Research</source>
        <volume>12</volume>
        <fpage>1269</fpage>
        <lpage>1276</lpage>
        <pub-id pub-id-type="pmid">12176934</pub-id>
      </element-citation>
    </ref>
    <ref id="pone.0016526-Edgar1">
      <label>40</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Edgar</surname>
            <given-names>RC</given-names>
          </name>
          <name>
            <surname>Myers</surname>
            <given-names>EW</given-names>
          </name>
        </person-group>
        <year>2005</year>
        <article-title>PILER: identification and classification of genomic repeats.</article-title>
        <source>Bioinformatics</source>
        <volume>21</volume>
        <fpage>i152</fpage>
        <lpage>158</lpage>
        <pub-id pub-id-type="pmid">15961452</pub-id>
      </element-citation>
    </ref>
    <ref id="pone.0016526-Notredame1">
      <label>41</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Notredame</surname>
            <given-names>C</given-names>
          </name>
        </person-group>
        <year>2007</year>
        <article-title>Recent evolutions of multiple sequence alignment algorithms.</article-title>
        <source>PLoS Computational Biology</source>
        <volume>3</volume>
        <fpage>e123+</fpage>
        <pub-id pub-id-type="pmid">17784778</pub-id>
      </element-citation>
    </ref>
    <ref id="pone.0016526-Huang1">
      <label>42</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Huang</surname>
            <given-names>X</given-names>
          </name>
        </person-group>
        <year>1994</year>
        <article-title>On global sequence alignment.</article-title>
        <source>Computer Applications in the Biosciences</source>
        <volume>10</volume>
        <fpage>227</fpage>
        <lpage>235</lpage>
        <pub-id pub-id-type="pmid">7922677</pub-id>
      </element-citation>
    </ref>
    <ref id="pone.0016526-Thompson1">
      <label>43</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Thompson</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Higgins</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Gibson</surname>
            <given-names>T</given-names>
          </name>
        </person-group>
        <year>1994</year>
        <article-title>CLUSTAL W: improving the sensitivity of progressive multiple sequence alignment through sequence weighting, position-specific gap penalties and weight matrix choice.</article-title>
        <source>Nucleic Acids Research</source>
        <volume>22</volume>
        <fpage>4673</fpage>
        <lpage>4680</lpage>
        <pub-id pub-id-type="pmid">7984417</pub-id>
      </element-citation>
    </ref>
    <ref id="pone.0016526-Katoh1">
      <label>44</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Katoh</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Toh</surname>
            <given-names>H</given-names>
          </name>
        </person-group>
        <year>2008</year>
        <article-title>Recent developments in the MAFFT multiple sequence alignment program.</article-title>
        <source>Briefings in Bioinformatics</source>
        <volume>9</volume>
        <fpage>286</fpage>
        <lpage>298</lpage>
        <pub-id pub-id-type="pmid">18372315</pub-id>
      </element-citation>
    </ref>
    <ref id="pone.0016526-Loytynoja1">
      <label>45</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Loytynoja</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Goldman</surname>
            <given-names>N</given-names>
          </name>
        </person-group>
        <year>2005</year>
        <article-title>An algorithm for progressive multiple alignment of sequences with insertions.</article-title>
        <source>Proceedings of the National Academy of Sciences</source>
        <volume>102</volume>
        <fpage>10557</fpage>
        <lpage>10562</lpage>
      </element-citation>
    </ref>
    <ref id="pone.0016526-Price1">
      <label>46</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Price</surname>
            <given-names>AL</given-names>
          </name>
          <name>
            <surname>Jones</surname>
            <given-names>NC</given-names>
          </name>
          <name>
            <surname>Pevzner</surname>
            <given-names>PA</given-names>
          </name>
        </person-group>
        <year>2005</year>
        <article-title>De novo identification of repeat families in large genomes.</article-title>
        <source>Bioinformatics</source>
        <volume>21</volume>
        <fpage>i351</fpage>
        <lpage>358</lpage>
        <pub-id pub-id-type="pmid">15961478</pub-id>
      </element-citation>
    </ref>
    <ref id="pone.0016526-Mayr1">
      <label>47</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Mayr</surname>
            <given-names>E</given-names>
          </name>
        </person-group>
        <year>1981</year>
        <article-title>Biological classification: toward a synthesis of opposing methodologies.</article-title>
        <source>Science</source>
        <volume>214</volume>
        <fpage>510</fpage>
        <lpage>516</lpage>
        <pub-id pub-id-type="pmid">17838387</pub-id>
      </element-citation>
    </ref>
    <ref id="pone.0016526-Jurka1">
      <label>48</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Jurka</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Kapitonov</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Pavlicek</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Klonowski</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Kohany</surname>
            <given-names>O</given-names>
          </name>
          <etal/>
        </person-group>
        <year>2005</year>
        <article-title>Repbase Update, a database of eukaryotic repetitive elements.</article-title>
        <source>Cytogenetic and Genome Research</source>
        <volume>110</volume>
        <fpage>462</fpage>
        <lpage>467</lpage>
        <pub-id pub-id-type="pmid">16093699</pub-id>
      </element-citation>
    </ref>
    <ref id="pone.0016526-Tempel1">
      <label>49</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Tempel</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Nicolas</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>El Amrani</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Couée</surname>
            <given-names>I</given-names>
          </name>
        </person-group>
        <year>2007</year>
        <article-title>Model-based identification of Helitrons results in a new classification of their families in Arabidopsis thaliana.</article-title>
        <source>Gene</source>
        <volume>403</volume>
        <fpage>18</fpage>
        <lpage>28</lpage>
        <pub-id pub-id-type="pmid">17889452</pub-id>
      </element-citation>
    </ref>
    <ref id="pone.0016526-Kurtz1">
      <label>50</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kurtz</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Narechania</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Stein</surname>
            <given-names>JC</given-names>
          </name>
          <name>
            <surname>Ware</surname>
            <given-names>D</given-names>
          </name>
        </person-group>
        <year>2008</year>
        <article-title>A new method to compute K-mer frequencies and its application to annotate large repetitive plant genomes.</article-title>
        <source>BMC Genomics</source>
        <volume>9</volume>
        <fpage>517+</fpage>
        <pub-id pub-id-type="pmid">18976482</pub-id>
      </element-citation>
    </ref>
    <ref id="pone.0016526-Gu1">
      <label>51</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Gu</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Castoe</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Hedges</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Batzer</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Pollock</surname>
            <given-names>D</given-names>
          </name>
        </person-group>
        <year>2008</year>
        <article-title>Identification of repeat structure in large genomes using repeat probability clouds.</article-title>
        <source>Analytical Biochemistry</source>
        <volume>380</volume>
        <fpage>77</fpage>
        <lpage>83</lpage>
        <pub-id pub-id-type="pmid">18541131</pub-id>
      </element-citation>
    </ref>
    <ref id="pone.0016526-Newman1">
      <label>52</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Newman</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Bailey</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Fan</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Pavelitz</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Weiner</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <year>2008</year>
        <article-title>An abundant evolutionarily conserved CSB-PiggyBac fusion protein expressed in Cockayne syndrome.</article-title>
        <source>PLoS Genetics</source>
        <volume>4</volume>
        <issue>3</issue>
        <fpage>e1000031</fpage>
        <pub-id pub-id-type="pmid">18369450</pub-id>
      </element-citation>
    </ref>
    <ref id="pone.0016526-Teixeira1">
      <label>53</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Teixeira</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Heredia</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Sarazin</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Roudier</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Boccara</surname>
            <given-names>M</given-names>
          </name>
          <etal/>
        </person-group>
        <year>2009</year>
        <article-title>A role for RNAi in the selective correction of DNA methylation defects.</article-title>
        <source>Science</source>
        <volume>323</volume>
        <fpage>1600</fpage>
        <lpage>1604</lpage>
        <pub-id pub-id-type="pmid">19179494</pub-id>
      </element-citation>
    </ref>
    <ref id="pone.0016526-Abrusan1">
      <label>54</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Abrusan</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Grundmann</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>DeMester</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Makalowski</surname>
            <given-names>W</given-names>
          </name>
        </person-group>
        <year>2009</year>
        <article-title>TEclass–a tool for automated classification of unknown eukaryotic transposable elements.</article-title>
        <source>Bioinformatics</source>
        <volume>25</volume>
        <fpage>1329</fpage>
        <lpage>1330</lpage>
        <pub-id pub-id-type="pmid">19349283</pub-id>
      </element-citation>
    </ref>
    <ref id="pone.0016526-Feschotte2">
      <label>55</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Feschotte</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Keswani</surname>
            <given-names>U</given-names>
          </name>
          <name>
            <surname>Ranganathan</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Guibotsy</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Levine</surname>
            <given-names>D</given-names>
          </name>
        </person-group>
        <year>2010</year>
        <article-title>Exploring repetitive DNA landscapes using REPCLASS, a tool that automates the classification of transposable elements in eukaryotic genomes.</article-title>
        <source>Genome Biol Evol</source>
        <volume>2009</volume>
        <fpage>205</fpage>
        <lpage>220</lpage>
      </element-citation>
    </ref>
    <ref id="pone.0016526-Brent1">
      <label>56</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Brent</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <year>2008</year>
        <article-title>Steady progress and recent breakthroughs in the accuracy of automated genome annotation.</article-title>
        <source>Nature Reviews Genetics</source>
        <volume>9</volume>
        <fpage>62</fpage>
        <lpage>73</lpage>
      </element-citation>
    </ref>
    <ref id="pone.0016526-Adams1">
      <label>57</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Adams</surname>
            <given-names>MD</given-names>
          </name>
          <name>
            <surname>Celniker</surname>
            <given-names>SE</given-names>
          </name>
          <name>
            <surname>Holt</surname>
            <given-names>RA</given-names>
          </name>
          <name>
            <surname>Evans</surname>
            <given-names>CA</given-names>
          </name>
          <name>
            <surname>Gocayne</surname>
            <given-names>JD</given-names>
          </name>
          <etal/>
        </person-group>
        <year>2000</year>
        <article-title>The genome sequence of Drosophila melanogaster.</article-title>
        <source>Science</source>
        <volume>287</volume>
        <fpage>2185</fpage>
        <lpage>2195</lpage>
        <pub-id pub-id-type="pmid">10731132</pub-id>
      </element-citation>
    </ref>
    <ref id="pone.0016526-The3">
      <label>58</label>
      <element-citation publication-type="journal">
        <collab>The Arabidopsis Genome Initiative</collab>
        <year>2000</year>
        <article-title>Analysis of the genome sequence of the flowering plant Arabidopsis thaliana.</article-title>
        <source>Nature</source>
        <volume>408</volume>
        <fpage>796</fpage>
        <lpage>815</lpage>
        <pub-id pub-id-type="pmid">11130711</pub-id>
      </element-citation>
    </ref>
    <ref id="pone.0016526-Benson1">
      <label>59</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Benson</surname>
            <given-names>G</given-names>
          </name>
        </person-group>
        <year>1999</year>
        <article-title>Tandem repeats finder: a program to analyze DNA sequences.</article-title>
        <source>Nucleic Acids Research</source>
        <volume>27</volume>
        <fpage>573</fpage>
        <lpage>580</lpage>
        <pub-id pub-id-type="pmid">9862982</pub-id>
      </element-citation>
    </ref>
    <ref id="pone.0016526-Jurka2">
      <label>60</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Jurka</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Klonowski</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Dagman</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Pelton</surname>
            <given-names>P</given-names>
          </name>
        </person-group>
        <year>1996</year>
        <article-title>CENSOR–a program for identification and elimination of repetitive elements from DNA sequences.</article-title>
        <source>Comput Chem</source>
        <volume>20</volume>
        <fpage>119</fpage>
        <lpage>121</lpage>
        <pub-id pub-id-type="pmid">8867843</pub-id>
      </element-citation>
    </ref>
    <ref id="pone.0016526-Kolpakov1">
      <label>61</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kolpakov</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Bana</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Kucherov</surname>
            <given-names>G</given-names>
          </name>
        </person-group>
        <year>2003</year>
        <article-title>mreps: efficient and flexible detection of tandem repeats in DNA.</article-title>
        <source>Nucleic Acids Research</source>
        <volume>31</volume>
        <fpage>3672</fpage>
        <lpage>3678</lpage>
        <pub-id pub-id-type="pmid">12824391</pub-id>
      </element-citation>
    </ref>
    <ref id="pone.0016526-Kent1">
      <label>62</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kent</surname>
            <given-names>W</given-names>
          </name>
        </person-group>
        <year>2002</year>
        <article-title>BLAT–the BLAST-like alignment tool.</article-title>
        <source>Genome Research</source>
        <volume>12</volume>
        <fpage>656</fpage>
        <lpage>664</lpage>
        <pub-id pub-id-type="pmid">11932250</pub-id>
      </element-citation>
    </ref>
    <ref id="pone.0016526-Dondoshansky1">
      <label>63</label>
      <element-citation publication-type="other">
        <person-group person-group-type="author">
          <name>
            <surname>Dondoshansky</surname>
            <given-names>I</given-names>
          </name>
        </person-group>
        <year>2002</year>
        <source>Blastclust (NCBI Software Development Toolkit)</source>
      </element-citation>
    </ref>
    <ref id="pone.0016526-Waterhouse1">
      <label>64</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Waterhouse</surname>
            <given-names>AM</given-names>
          </name>
          <name>
            <surname>Procter</surname>
            <given-names>JB</given-names>
          </name>
          <name>
            <surname>Martin</surname>
            <given-names>DMA</given-names>
          </name>
          <name>
            <surname>Clamp</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Barton</surname>
            <given-names>GJ</given-names>
          </name>
        </person-group>
        <year>2009</year>
        <article-title>Jalview Version 2–a multiple sequence alignment editor and analysis workbench.</article-title>
        <source>Bioinformatics</source>
        <volume>25</volume>
        <fpage>1189</fpage>
        <lpage>1191</lpage>
        <pub-id pub-id-type="pmid">19151095</pub-id>
      </element-citation>
    </ref>
  </ref-list>
</back>
<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//NLM//DTD Journal Publishing DTD v2.3 20031101//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName journalpublishing.dtd?>
<?SourceDTD.Version 2.3?>
<?ConverterInfo.XSLTName jp2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">PLoS One</journal-id>
    <journal-id journal-id-type="iso-abbrev">PLoS ONE</journal-id>
    <journal-id journal-id-type="publisher-id">plos</journal-id>
    <journal-id journal-id-type="pmc">plosone</journal-id>
    <journal-title-group>
      <journal-title>PLoS ONE</journal-title>
    </journal-title-group>
    <issn pub-type="epub">1932-6203</issn>
    <publisher>
      <publisher-name>Public Library of Science</publisher-name>
      <publisher-loc>San Francisco, USA</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">3031573</article-id>
    <article-id pub-id-type="pmid">21304975</article-id>
    <article-id pub-id-type="publisher-id">PONE-D-10-01421</article-id>
    <article-id pub-id-type="doi">10.1371/journal.pone.0016526</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Research Article</subject>
      </subj-group>
      <subj-group subj-group-type="Discipline-v2">
        <subject>Biology</subject>
        <subj-group>
          <subject>Computational Biology</subject>
          <subj-group>
            <subject>Genomics</subject>
            <subj-group>
              <subject>Genome Analysis Tools</subject>
              <subject>Genome Complexity</subject>
              <subject>Structural Genomics</subject>
            </subj-group>
          </subj-group>
        </subj-group>
        <subj-group>
          <subject>Genomics</subject>
          <subj-group>
            <subject>Genome Analysis Tools</subject>
            <subject>Genome Complexity</subject>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v2">
        <subject>Computer Science</subject>
        <subj-group>
          <subject>Software Engineering</subject>
          <subj-group>
            <subject>Software Design</subject>
            <subject>Software Tools</subject>
          </subj-group>
        </subj-group>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Considering Transposable Element Diversification in <italic>De Novo</italic> Annotation Approaches</article-title>
      <alt-title alt-title-type="running-head"><italic>De Novo</italic> Annotation of Transposable Elements</alt-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Flutre</surname>
          <given-names>Timothée</given-names>
        </name>
        <xref ref-type="aff" rid="aff1">
          <sup>1</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Duprat</surname>
          <given-names>Elodie</given-names>
        </name>
        <xref ref-type="aff" rid="aff2">
          <sup>2</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Feuillet</surname>
          <given-names>Catherine</given-names>
        </name>
        <xref ref-type="aff" rid="aff3">
          <sup>3</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Quesneville</surname>
          <given-names>Hadi</given-names>
        </name>
        <xref ref-type="aff" rid="aff1">
          <sup>1</sup>
        </xref>
        <xref ref-type="corresp" rid="cor1">
          <sup>*</sup>
        </xref>
      </contrib>
    </contrib-group>
    <aff id="aff1">
      <label>1</label>
      <addr-line>Unité de Recherche en Génomique-Info, UR 1164, INRA Centre de Versailles-Grignon, Versailles, France</addr-line>
    </aff>
    <aff id="aff2">
      <label>2</label>
      <addr-line>Institut de Minéralogie et de Physique des Milieux Condensés, UMR 7590, CNRS-UPMC-IPGP-Université Paris Diderot, Paris, France</addr-line>
    </aff>
    <aff id="aff3">
      <label>3</label>
      <addr-line>Génétique, Diversité et Ecophysiologie des Céréales, UMR 1095, INRA Domaine du Crouël, Clermont-Ferrand, France</addr-line>
    </aff>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Xu</surname>
          <given-names>Ying</given-names>
        </name>
        <role>Editor</role>
        <xref ref-type="aff" rid="edit1"/>
      </contrib>
    </contrib-group>
    <aff id="edit1">University of Georgia, United States of America</aff>
    <author-notes>
      <corresp id="cor1">* E-mail: <email>Hadi.quesneville@versailles.inra.fr</email></corresp>
      <fn fn-type="con">
        <p>Conceived and designed the experiments: TF ED HQ. Performed the experiments: TF ED. Analyzed the data: TF ED CF HQ. Contributed reagents/materials/analysis tools: TF ED. Wrote the paper: TF CF HQ. Coordinated study: HQ.</p>
      </fn>
    </author-notes>
    <pub-date pub-type="collection">
      <year>2011</year>
    </pub-date>
    <pub-date pub-type="epub">
      <day>31</day>
      <month>1</month>
      <year>2011</year>
    </pub-date>
    <volume>6</volume>
    <issue>1</issue>
    <elocation-id>e16526</elocation-id>
    <history>
      <date date-type="received">
        <day>31</day>
        <month>8</month>
        <year>2010</year>
      </date>
      <date date-type="accepted">
        <day>4</day>
        <month>1</month>
        <year>2011</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>Flutre et al.</copyright-statement>
      <copyright-year>2011</copyright-year>
      <license xlink:href="http://creativecommons.org/licenses/by/4.0/">
        <license-p>This is an open-access article distributed under the terms of the Creative Commons Attribution License, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are properly credited.</license-p>
      </license>
    </permissions>
    <abstract>
      <p>Transposable elements (TEs) are mobile, repetitive DNA sequences that are almost ubiquitous in prokaryotic and eukaryotic genomes. They have a large impact on genome structure, function and evolution. With the recent development of high-throughput sequencing methods, many genome sequences have become available, making possible comparative studies of TE dynamics at an unprecedented scale. Several methods have been proposed for the <italic>de novo</italic> identification of TEs in sequenced genomes. Most begin with the detection of genomic repeats, but the subsequent steps for defining TE families differ. High-quality TE annotations are available for the <italic>Drosophila melanogaster</italic> and <italic>Arabidopsis thaliana</italic> genome sequences, providing a solid basis for the benchmarking of such methods. We compared the performance of specific algorithms for the clustering of interspersed repeats and found that only a particular combination of algorithms detected TE families with good recovery of the reference sequences. We then applied a new procedure for reconciling the different clustering results and classifying TE sequences. The whole approach was implemented in a pipeline using the REPET package. Finally, we show that our combined approach highlights the dynamics of well defined TE families by making it possible to identify structural variations among their copies. This approach makes it possible to annotate TE families and to study their diversification in a single analysis, improving our understanding of TE dynamics at the whole-genome scale and for diverse species.</p>
    </abstract>
    <counts>
      <page-count count="15"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec id="s1">
    <title>Introduction</title>
    <p>Transposable elements (TEs) are DNA sequences that can move and duplicate, autonomously or with the assistance of other elements, within genomes. TEs have been described as the “ultimate parasite”, because of their ability to amplify and invade genomes for their own ends <xref rid="pone.0016526-Orgel1" ref-type="bibr">[1]</xref>, and as “selfish DNA sequences” <xref rid="pone.0016526-Brookfield1" ref-type="bibr">[2]</xref>. These invasion events play a particularly important role in eukaryotic genomes, probably because of the smaller population sizes of eukaryotes than of prokaryotes <xref rid="pone.0016526-Lynch1" ref-type="bibr">[3]</xref>.</p>
    <p>TEs are generally classified according to their transposition mechanism. Those transposing <italic>via</italic> an RNA intermediate belong to class I and are referred to as retrotransposons, whereas those transposing <italic>via</italic> a DNA intermediate belong to class II and are called DNA transposons <xref rid="pone.0016526-Finnegan1" ref-type="bibr">[4]</xref>. Class I transposable elements can be classified into three main orders, LTR retrotransposons (having long terminal repeats), LINEs (long interspersed nuclear elements) and SINEs (short interspersed nuclear elements), whereas class II transposable elements are classified into DNA transposons, Helitrons and Mavericks <xref rid="pone.0016526-Wicker1" ref-type="bibr">[5]</xref>. Most TEs encode proteins that mediate their autonomous transposition. During the course of evolution, non autonomous elements have emerged from autonomous elements. Some are incomplete versions of autonomous elements, often with insertions/deletions (indels) disrupting their open reading frames (ORFs). Others are miniature versions lacking internal sequences but retaining the boundaries of the original element, making it possible for the autonomous element machinery to recognize them. MITEs (miniature inverted-repeats transposable elements) are well known examples of non autonomous elements that evolved from class II DNA transposons <xref rid="pone.0016526-Wessler1" ref-type="bibr">[6]</xref>, <xref rid="pone.0016526-Yang1" ref-type="bibr">[7]</xref>.</p>
    <p>TEs are now recognized to be a major component of the structure of the genome and to affect genome size and chromosomal rearrangements <xref rid="pone.0016526-Gray1" ref-type="bibr">[8]</xref>–<xref rid="pone.0016526-Coghlan1" ref-type="bibr">[10]</xref>. They often account for a large proportion of the genome: 20% of the 180 Mb <italic>Drosophila melanogaster</italic> genome, 45% of the 3.2 Gb human genome, and more than 80% of the 17 Gb bread wheat (<italic>Triticum aestivum</italic>) genome <xref rid="pone.0016526-Paux1" ref-type="bibr">[11]</xref>. These dispersed repeats can induce major chromosomal rearrangements, thereby affecting genome organization. However, the impact of TEs is not limited to effects on genome structure. As initially suggested by Barbara McClintock <xref rid="pone.0016526-McClintock1" ref-type="bibr">[12]</xref>, TEs may be seen as “controlling” elements. They may provide regulatory sequences with various effects on the adjacent genes. In particular, some silencing mechanisms involving RNA interference seem to have emerged primarily as a host response to prevent TE amplification. Thus, genes located close to TE insertions may be subject to transcriptional control due to TE repression, resulting in their epigenetic regulation <xref rid="pone.0016526-Slotkin1" ref-type="bibr">[13]</xref>, <xref rid="pone.0016526-Martin1" ref-type="bibr">[14]</xref>. Moreover, TEs are intrinsically able to create, modify and re-wire gene regulatory networks <xref rid="pone.0016526-Feschotte1" ref-type="bibr">[15]</xref>, <xref rid="pone.0016526-Herpin1" ref-type="bibr">[16]</xref>. Finally, many cases of exaptation and domestication involving TEs have been reported <xref rid="pone.0016526-Cordaux1" ref-type="bibr">[17]</xref>, <xref rid="pone.0016526-Santangelo1" ref-type="bibr">[18]</xref>. For example, there are several lines of evidence to suggest that the RAG1 and RAG2 genes involved in V(D)J recombination originated from a hAT DNA transposon that was domesticated to fulfill this primordial function of the adaptive immune system <xref rid="pone.0016526-Agrawal1" ref-type="bibr">[19]</xref>, <xref rid="pone.0016526-Zhou1" ref-type="bibr">[20]</xref>.</p>
    <p>The increase in efficiency and decrease in cost of new sequencing techniques <xref rid="pone.0016526-Schuster1" ref-type="bibr">[21]</xref> are leading to the sequencing of increasing numbers of genomes. About 1250 genome sequencing projects have already been initiated for eukaryotes, including species with large and repetitive genomes, such as maize <xref rid="pone.0016526-Schnable1" ref-type="bibr">[22]</xref>. The efficient and accurate annotation of TEs is therefore essential to our understanding of their impact on gene function and genome evolution <xref rid="pone.0016526-Bourque1" ref-type="bibr">[23]</xref>.</p>
    <p>If a routine TE annotation procedure is to be efficient, it must be both rapid and exhaustive, biologically relevant and computationally tractable. The TE annotation process can be divided into two phases: (i) the <italic>de novo</italic> discovery and identification of the TE families present in the genome studied and (ii) the precise, comprehensive annotation of TE copies on the chromosomes. For the second phase, an integrated pipeline has already been developed and tested <xref rid="pone.0016526-Quesneville1" ref-type="bibr">[24]</xref> and this pipeline has been applied to several organisms <xref rid="pone.0016526-Bergman1" ref-type="bibr">[25]</xref>–<xref rid="pone.0016526-The2" ref-type="bibr">[31]</xref>. For the <italic>de novo</italic> discovery phase, several programs and algorithms based on different assumptions have been developed, but none has yet proved entirely satisfactory. Indeed, as pointed out in a previous study <xref rid="pone.0016526-Saha1" ref-type="bibr">[32]</xref>, some programs have very low levels of sensitivity or specificity, whereas others return too short consensus sequence (&lt;1 kb).</p>
    <p>In addition to describing the composition and organization of the genome, TE annotation facilitates the identification of structural variants providing useful information about genome dynamics. Several examples of structural variations in TE families have been reported <xref rid="pone.0016526-Jiang1" ref-type="bibr">[33]</xref>, <xref rid="pone.0016526-Quesneville2" ref-type="bibr">[34]</xref> but these variations have generally been underestimated in genome-wide analyses of TEs. In this study, we addressed two questions, one concerning the challenges associated with whole-genome TE annotation, and the other relating to the identification and characterization of structural variants from the same TE family. We first compared the existing computational methods for the <italic>de novo</italic> identification of TEs in sequenced genomes, using the high-quality TE annotations available for the <italic>Drosophila melanogaster</italic>
<xref rid="pone.0016526-Quesneville1" ref-type="bibr">[24]</xref> and <italic>Arabidopsis thaliana</italic> genome sequences <xref rid="pone.0016526-Buisine1" ref-type="bibr">[29]</xref>. We then developed the TEdenovo pipeline, a tool combining several different programs, including procedures for the clustering of interspersed repeats, into a single framework, the REPET package (<ext-link ext-link-type="uri" xlink:href="http://urgi.versailles.inra.fr/index.php/repet">http://urgi.versailles.inra.fr/index.php/repet</ext-link>). Finally, by analyzing the <italic>D. melanogaster</italic> and <italic>A. thaliana</italic> genomes with the TEdenovo pipeline, we were able to obtain new insight into TE dynamics, highlighting structural variations emerging during the diversification of TE families and identifying putative new TEs absent from reference databanks.</p>
  </sec>
  <sec id="s2">
    <title>Results</title>
    <sec id="s2a">
      <title>Comparative analysis of <italic>de novo</italic> approaches</title>
      <p>We developed a three-step approach for comparing the efficiency of <italic>de novo</italic> TE detection methods (see <xref rid="pone.0016526-Bergman2" ref-type="bibr">[35]</xref> for a review), to provide a robust tool for identifying TEs in eukaryotic genomes: (i) the self-alignment of the input genomic sequences, (ii) the clustering of the resulting pairwise alignments, and (iii) the construction of a multiple alignment for each cluster from which a consensus sequence is derived (<xref ref-type="supplementary-material" rid="pone.0016526.s001">Figure S1</xref>). This process generates a databank of <italic>de novo</italic> consensus sequences representing putative TE families present in the genome analyzed, which can be used for the annotation of individual TE copies. We applied this three-step approach to the <italic>D. melanogaster</italic> release 4 and <italic>A. thaliana</italic> release 9 genome sequences. At each step, we evaluated several programs, comparing the efficiency with which they identified TEs with the aid of the high-quality TE sequence databanks (from the Berkeley <italic>Drosophila</italic> Genome Project and Repbase Update) and annotations available for these two reference genomes <xref rid="pone.0016526-Quesneville1" ref-type="bibr">[24]</xref>, <xref rid="pone.0016526-Buisine1" ref-type="bibr">[29]</xref>.</p>
      <p>Traditionally, the quality of <italic>de novo</italic> consensus sequences — the extent to which they correspond to full TE reference sequences rather than truncated versions — is not assessed. Validation is instead indirect: researchers annotate a genome sequence with RepeatMasker, using Repbase Update as TE databank, and consider the resulting TE annotations as the references. They then annotate the same genome with RepeatMasker, using the <italic>de novo</italic> consensus as TE databank, and consider these TE annotations as predictions. These two sets of annotations are then compared, by calculating sensitivity and specificity at the nucleotide level. The criterion used to estimate the quality of the <italic>de novo</italic> method is therefore the extent to which <italic>de novo</italic> predictions and reference annotations overlap. However, as we are particularly interested in TE dynamics, we need to assess the quality of the <italic>de novo</italic> library itself, by evaluating the extent to which full ancestral TE reference sequences are recovered. Such sequences, which originate from the reconstruction of a given element from its copies, are not only useful for subsequent TE annotation, but also provide a condensed view of the TEs in the genome. One way of assessing the quality of the <italic>de novo</italic> consensus sequences obtained with our three-step approach would be to compare these sequences with reference sequences from the Berkeley Drosophila Genome Project (BDGP) or Repbase Update databanks. However, it was clear that some of the reference sequences present in these databanks would not be present in the genomes analyzed. For example, the “P-element” reference sequence is absent from the genome sequence of the <italic>D. melanogaster</italic> strain used here. So, rather than using the reference databanks directly, we first constructed, for each genome, a “knowledge-based” databank comprising one consensus sequence per reference TE sequence, based on its genomic copies (see <xref ref-type="sec" rid="s4">Methods</xref>). For each genome, we then compared each <italic>de novo</italic> databank with its corresponding “knowledge-based” databank through pairwise sequence alignments. We then calculated the sensitivity S<sub>n</sub>*, specificity S<sub>p</sub>* and recovery ratio R<sub>CC</sub> (see <xref ref-type="sec" rid="s4">Methods</xref> and <xref ref-type="table" rid="pone-0016526-t001">Table 1</xref>). This last index, the R<sub>CC</sub> ratio, provides a precise measurement of the number of TE reference elements fully recovered in the <italic>de novo</italic> consensus sequences.</p>
      <table-wrap id="pone-0016526-t001" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pone.0016526.t001</object-id>
        <label>Table 1</label>
        <caption>
          <title>Sensitivity and specificity of the programs tested in the three-step <italic>de novo</italic> approach.</title>
        </caption>
        <alternatives>
          <graphic id="pone-0016526-t001-1" xlink:href="pone.0016526.t001"/>
          <table frame="hsides" rules="groups">
            <colgroup span="1">
              <col align="left" span="1"/>
              <col align="center" span="1"/>
              <col align="center" span="1"/>
              <col align="center" span="1"/>
              <col align="center" span="1"/>
              <col align="center" span="1"/>
              <col align="center" span="1"/>
            </colgroup>
            <thead>
              <tr>
                <td align="left" rowspan="1" colspan="1">Genome</td>
                <td align="left" rowspan="1" colspan="1">Self-alignment</td>
                <td align="left" rowspan="1" colspan="1">Clustering</td>
                <td align="left" rowspan="1" colspan="1">Multiple alignment</td>
                <td align="left" rowspan="1" colspan="1">S<sub>n</sub>*</td>
                <td align="left" rowspan="1" colspan="1">S<sub>p</sub>*</td>
                <td align="left" rowspan="1" colspan="1">R<sub>CC</sub>
</td>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td align="left" rowspan="1" colspan="1">
                  <italic>D. mel.</italic>
                </td>
                <td align="left" rowspan="1" colspan="1">BLASTER</td>
                <td align="left" rowspan="1" colspan="1">GROUPER</td>
                <td align="left" rowspan="1" colspan="1">MAP</td>
                <td align="left" rowspan="1" colspan="1">80.34%</td>
                <td align="left" rowspan="1" colspan="1">85.89%</td>
                <td align="left" rowspan="1" colspan="1">66.20%</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">
                  <italic>D. mel.</italic>
                </td>
                <td align="left" rowspan="1" colspan="1">BLASTER</td>
                <td align="left" rowspan="1" colspan="1">RECON</td>
                <td align="left" rowspan="1" colspan="1">MAP</td>
                <td align="left" rowspan="1" colspan="1">92.31%</td>
                <td align="left" rowspan="1" colspan="1">73.17%</td>
                <td align="left" rowspan="1" colspan="1">66.20%</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">
                  <italic>D. mel.</italic>
                </td>
                <td align="left" rowspan="1" colspan="1">BLASTER</td>
                <td align="left" rowspan="1" colspan="1">PILER</td>
                <td align="left" rowspan="1" colspan="1">MAP</td>
                <td align="left" rowspan="1" colspan="1">62.39%</td>
                <td align="left" rowspan="1" colspan="1">84.17%</td>
                <td align="left" rowspan="1" colspan="1">51.50%</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">
                  <italic>D. mel.</italic>
                </td>
                <td align="left" rowspan="1" colspan="1">PALS</td>
                <td align="left" rowspan="1" colspan="1">GROUPER</td>
                <td align="left" rowspan="1" colspan="1">MAP</td>
                <td align="left" rowspan="1" colspan="1">73.50%</td>
                <td align="left" rowspan="1" colspan="1">88.75%</td>
                <td align="left" rowspan="1" colspan="1">60.30%</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">
                  <italic>D. mel.</italic>
                </td>
                <td align="left" rowspan="1" colspan="1">PALS</td>
                <td align="left" rowspan="1" colspan="1">RECON</td>
                <td align="left" rowspan="1" colspan="1">MAP</td>
                <td align="left" rowspan="1" colspan="1">90.60%</td>
                <td align="left" rowspan="1" colspan="1">74.23%</td>
                <td align="left" rowspan="1" colspan="1">51.50%</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">
                  <italic>D. mel.</italic>
                </td>
                <td align="left" rowspan="1" colspan="1">PALS</td>
                <td align="left" rowspan="1" colspan="1">PILER</td>
                <td align="left" rowspan="1" colspan="1">MAP</td>
                <td align="left" rowspan="1" colspan="1">53.85%</td>
                <td align="left" rowspan="1" colspan="1">76.42%</td>
                <td align="left" rowspan="1" colspan="1">42.64%</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">
                  <italic>A. tha.</italic>
                </td>
                <td align="left" rowspan="1" colspan="1">BLASTER</td>
                <td align="left" rowspan="1" colspan="1">GROUPER</td>
                <td align="left" rowspan="1" colspan="1">MAP</td>
                <td align="left" rowspan="1" colspan="1">60.33%</td>
                <td align="left" rowspan="1" colspan="1">82.42%</td>
                <td align="left" rowspan="1" colspan="1">39.00%</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">
                  <italic>A. tha.</italic>
                </td>
                <td align="left" rowspan="1" colspan="1">BLASTER</td>
                <td align="left" rowspan="1" colspan="1">RECON</td>
                <td align="left" rowspan="1" colspan="1">MAP</td>
                <td align="left" rowspan="1" colspan="1">73.77%</td>
                <td align="left" rowspan="1" colspan="1">61.70%</td>
                <td align="left" rowspan="1" colspan="1">43.50%</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">
                  <italic>A. tha.</italic>
                </td>
                <td align="left" rowspan="1" colspan="1">BLASTER</td>
                <td align="left" rowspan="1" colspan="1">PILER</td>
                <td align="left" rowspan="1" colspan="1">MAP</td>
                <td align="left" rowspan="1" colspan="1">47.21%</td>
                <td align="left" rowspan="1" colspan="1">57.33%</td>
                <td align="left" rowspan="1" colspan="1">32.45%</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">
                  <italic>A. tha.</italic>
                </td>
                <td align="left" rowspan="1" colspan="1">PALS</td>
                <td align="left" rowspan="1" colspan="1">GROUPER</td>
                <td align="left" rowspan="1" colspan="1">MAP</td>
                <td align="left" rowspan="1" colspan="1">54.75%</td>
                <td align="left" rowspan="1" colspan="1">88.38%</td>
                <td align="left" rowspan="1" colspan="1">24.00%</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">
                  <italic>A. tha.</italic>
                </td>
                <td align="left" rowspan="1" colspan="1">PALS</td>
                <td align="left" rowspan="1" colspan="1">RECON</td>
                <td align="left" rowspan="1" colspan="1">MAP</td>
                <td align="left" rowspan="1" colspan="1">71.80%</td>
                <td align="left" rowspan="1" colspan="1">66.20%</td>
                <td align="left" rowspan="1" colspan="1">27.90%</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">
                  <italic>A. tha.</italic>
                </td>
                <td align="left" rowspan="1" colspan="1">PALS</td>
                <td align="left" rowspan="1" colspan="1">PILER</td>
                <td align="left" rowspan="1" colspan="1">MAP</td>
                <td align="left" rowspan="1" colspan="1">40.00%</td>
                <td align="left" rowspan="1" colspan="1">59.92%</td>
                <td align="left" rowspan="1" colspan="1">16.20%</td>
              </tr>
            </tbody>
          </table>
        </alternatives>
        <table-wrap-foot>
          <fn id="nt101">
            <label/>
            <p>“<italic>D. mel.</italic>” stands for “<italic>D. melanogaster</italic>” and “<italic>A. tha.</italic>” stands for “<italic>A. thaliana</italic>”. The three indices S<sub>n</sub>*, S<sub>p</sub>* and R<sub>CC</sub> correspond respectively to the measure of sensitivity, the measure of specificity and the recovery ratio when comparing a databank of TE <italic>de novo</italic> consensus sequences with a databank of TE reference sequences.</p>
          </fn>
        </table-wrap-foot>
      </table-wrap>
      <sec id="s2a1">
        <title>Self-alignment of the genomic sequences</title>
        <p>The first step in the three-step <italic>de novo</italic> approach involves the self-alignment of the input genomic sequences, corresponding to an all-by-all comparison of the genome with itself. We evaluated two local pairwise alignment programs for this first step: a heuristic algorithm, BLASTER <xref rid="pone.0016526-Quesneville3" ref-type="bibr">[36]</xref> wrapping BLAST <xref rid="pone.0016526-Altschul1" ref-type="bibr">[37]</xref>, and an exact algorithm, PALS <xref rid="pone.0016526-Rasmussen1" ref-type="bibr">[38]</xref> (see <xref ref-type="sec" rid="s4">Methods</xref>). We launched these two programs, with stringent parameters, on each of the target genomes, and then applied post-processing procedures to discard long segmental duplications (see <xref ref-type="sec" rid="s4">Methods</xref>). This resulted in a list of pairwise alignments corresponding to repeats in the <italic>D. melanogaster</italic> and <italic>A. thaliana</italic> genome sequences. A comparison of the <italic>de novo</italic> consensus sequence performances of the BLASTER and PALS programs (<xref ref-type="table" rid="pone-0016526-t001">Table 1</xref>) showed that BLASTER consistently had a higher sensitivity (S<sub>n</sub>*) and a much higher recovery ratio (R<sub>CC</sub>). In most cases, its specificity (S<sub>p</sub>*) was also better than that of PALS. Note that PALS was run with more stringent parameters than BLASTER as it cannot be used with the same values without computing time becoming intractable (see <xref ref-type="sec" rid="s4">Methods</xref>). As the recovery ratio R<sub>CC</sub> reflects the ability of the <italic>de novo</italic> approach to define TE boundaries correctly and, therefore, to recover full-length TE reference sequences, we preferred BLASTER over PALS for the self-alignment step. Moreover, in both genomes, BLASTER gave a higher genome coverage than PALS (<xref ref-type="supplementary-material" rid="pone.0016526.s004">Table S1</xref>), as expected given the lower stringency of its parameters (see <xref ref-type="sec" rid="s4">Methods</xref>). This first step also generated a lower limit for the repeats content of the genome: around 7% for <italic>D. melanogaster</italic> and 13% for <italic>A. thaliana</italic>.</p>
      </sec>
      <sec id="s2a2">
        <title>Clustering of the all-by-all matches</title>
        <p>In the second step, we clustered the results of the all-by-all comparisons, with the aim of gathering together, within the same cluster, all sequences belonging to the same TE family. This step is crucial to ensure the precise definition of repeat boundaries, one of the main challenges in the <italic>de novo</italic> detection of TEs. Due to their specific dynamics during genome evolution, TE families may differ considerably in terms of copy number, sequence divergence and insertion/deletion patterns. At this step, the aim is to cluster together all TE fragments sharing a common ancestor, with the aim of recovering the ancestral element that transposed in the past. However, TE copies diverge as they multiply and different copies may accumulate different modifications. This phenomenon results in structural variants, as depicted in <xref ref-type="fig" rid="pone-0016526-g001">Figure 1</xref>. In this case, the grouping together of copies from different structural variants within the same cluster may have the undesirable consequence of the identification of consensus sequences with some features specific to one of the structural variants with others specific to another variant. We therefore tested three programs specifically implemented for the clustering of interspersed repeats: GROUPER <xref rid="pone.0016526-Quesneville3" ref-type="bibr">[36]</xref>, RECON <xref rid="pone.0016526-Bao1" ref-type="bibr">[39]</xref> and PILER <xref rid="pone.0016526-Edgar1" ref-type="bibr">[40]</xref> (see <xref ref-type="sec" rid="s4">Methods</xref>).</p>
        <fig id="pone-0016526-g001" position="float">
          <object-id pub-id-type="doi">10.1371/journal.pone.0016526.g001</object-id>
          <label>Figure 1</label>
          <caption>
            <title>Schematic diagram of the dynamics of a TE family with two structural variants.</title>
          </caption>
          <graphic xlink:href="pone.0016526.g001"/>
        </fig>
        <p>We applied these three programs to the list of matches obtained in the genome self-alignments, and then applied procedures for discarding segmental duplications (see <xref ref-type="sec" rid="s4">Methods</xref>). In terms of the <italic>de novo</italic> consensuses generated from the resulting clusters (<xref ref-type="table" rid="pone-0016526-t001">Table 1</xref>), GROUPER and RECON were consistently more sensitive than PILER. Moreover, GROUPER was systematically more specific than RECON and PILER, with <italic>de novo</italic> consensuses from GROUPER less likely to be artifacts unrelated to TE reference sequences than those obtained with the other methods. In some cases, RECON provided a better recovery ratio (R<sub>CC</sub>) than GROUPER and PILER, but this ratio was always better for GROUPER than for PILER. In addition, regardless of the genome analyzed, the three programs did not necessarily generate the same number of clusters (<xref ref-type="supplementary-material" rid="pone.0016526.s005">Table S2</xref>): GROUPER generated more clusters than RECON, which, in turn, generated more clusters than PILER. The number of clusters obtained by the <italic>de novo</italic> approach was much higher for GROUPER and RECON than the number of TE families present in the reference databanks (BDGP or Repbase Update). We suggest that this large number of clusters reflects the high level of diversity within TE families in terms of copy divergence and nesting patterns, as assessed by clustering algorithms.</p>
      </sec>
      <sec id="s2a3">
        <title>Multiple sequence alignment for each cluster</title>
        <p>The third step, which consists in the construction of a multiple alignment for each cluster, is particularly important, because the quality of a consensus sequence depends on the quality of the multiple sequence alignment (MSA) from which it is derived. A large number of programs have been developed over the last ten years <xref rid="pone.0016526-Notredame1" ref-type="bibr">[41]</xref>, focusing on issues such as the scoring scheme, the use of templates for secondary structures and computation speed. In our case, the sequences to be aligned are very similar to each other in terms of nucleotide substitutions (identity of more than 90%), with most of the differences between them resulting from indels. The clusters generated by RECON include sequences of very different lengths (<xref ref-type="supplementary-material" rid="pone.0016526.s005">Table S2</xref>). Moreover, depending on the size and TE content of the genome analyzed, it may be necessary to process several thousand clusters. We tested only a subset of all the possible programs, focusing on those most suitable for our requirements: rapid procedures capable of handling indels. We therefore focused on progressive MSA algorithms, as these algorithms generate alignments rapidly. We tested MAP <xref rid="pone.0016526-Huang1" ref-type="bibr">[42]</xref>, CLUSTAL-W <xref rid="pone.0016526-Thompson1" ref-type="bibr">[43]</xref>, MAFFT <xref rid="pone.0016526-Katoh1" ref-type="bibr">[44]</xref> and PRANK <xref rid="pone.0016526-Loytynoja1" ref-type="bibr">[45]</xref> (see <xref ref-type="sec" rid="s4">Methods</xref>).</p>
        <p>For each of these multiple alignment programs, we used the matches returned by BLASTER and then clustered by GROUPER, RECON or PILER. This comparative study (<xref ref-type="supplementary-material" rid="pone.0016526.s006">Table S3</xref>) shows that all the multiple alignment programs gave similar results in terms of sensitivity and specificity, whether launched after GROUPER or after PILER. This result was expected, as all the sequences in these clusters are similar in both composition and length, making them easy to align. However, PRANK was slower than the other three programs, rendering it less suitable for large genome analyses. With RECON, the best results were obtained with MAP, due to the greater heterogeneity of RECON clusters in terms of sequence length, rendering alignment more difficult. Thus, few differences were observed, but MAP clearly outperformed the other programs on RECON clusters, making it more robust than the other programs, whatever the clustering method used.</p>
      </sec>
      <sec id="s2a4">
        <title>Comparison with another approach, RepeatScout</title>
        <p>We evaluated the performance of our three-step strategy, by comparing it with another approach that also builds a databank of TE consensus sequences from a raw genome sequence: RepeatScout <xref rid="pone.0016526-Price1" ref-type="bibr">[46]</xref> (see <xref ref-type="sec" rid="s4">Methods</xref>). We applied the RepeatScout program on the <italic>D. melanogaster</italic> and <italic>A. thaliana</italic> genome sequences, with the default parameters. It constructed 1770 consensuses for <italic>D. melanogaster</italic> and 3417 for <italic>A. thaliana</italic>. However, these consensuses were less sensitive and specific than those obtained with the tools described above (<xref ref-type="supplementary-material" rid="pone.0016526.s007">Table S4</xref>). This is probably due to the shorter length of the consensuses identified by RepeatScout (500 bp on average) than by GROUPER (∼2500 bp on average), RECON (∼2000 bp on average) and PILER (∼2800 bp on average). We obtained similar results for both genomes, indicating that this bias does not seem to be due to the input genome sequences. We hypothesize that RepeatScout fails to connect TE fragments more than a certain distance apart, thereby sometimes missing the true boundaries of a given TE copy. By contrast, GROUPER and RECON are particularly efficient at this task.</p>
      </sec>
      <sec id="s2a5">
        <title>Combination of programs into a robust pipeline, TEdenovo</title>
        <p>Based on the comparative analyses reported above, BLASTER should be used for the genome self-alignment step, followed by GROUPER or RECON for the clustering step and MAP for the multiple alignment step. However, a comparison of the consensuses obtained with all three clustering methods clearly showed that each of these methods nonetheless missed several reference TEs fully recovered by the others (<xref ref-type="fig" rid="pone-0016526-g002">Figure 2</xref>). With the <italic>D. melanogaster</italic> genome sequence, four “knowledge-based” consensuses were retrieved intact by GROUPER only, and nine such sequences were recovered by RECON only (<xref ref-type="fig" rid="pone-0016526-g002">Figure 2 A</xref>). Similarly, with the <italic>A. thaliana</italic> genome sequence, eight “knowledge-based” consensuses were retrieved intact only by GROUPER, whereas fifteen were retrieved intact only by RECON (<xref ref-type="fig" rid="pone-0016526-g002">Figure 2 B</xref>). The three clustering methods should therefore be used in combination, for the accurate identification of TE families in genome sequences. For this reason, we decided to the three-step approach within a combined, modular pipeline named “TEdenovo”. With respect to the best single method, GROUPER for <italic>D. melanogaster</italic> and RECON for <italic>A. thaliana</italic> (<xref ref-type="table" rid="pone-0016526-t001">Table 1</xref>), the combined approach, as implemented in the TEdenovo pipeline, improved the recovery of full-length “knowledge-based” consensus sequences by 20% and 13.5%, respectively, while maintaining high sensitivity and specificity (<xref ref-type="supplementary-material" rid="pone.0016526.s008">Table S5</xref>). The three approaches are combined at the clustering step, through the launching of GROUPER, RECON and PILER in parallel. The user may also choose to use PALS rather than BLASTER at step 1 or the other MSA programs at step 3, and can even choose to apply only one clustering program at step 2, although our results suggest that this would not be wise.</p>
        <fig id="pone-0016526-g002" position="float">
          <object-id pub-id-type="doi">10.1371/journal.pone.0016526.g002</object-id>
          <label>Figure 2</label>
          <caption>
            <title>Venn diagram showing the gains achieved by combining several clustering programs.</title>
            <p>(A) Combining the GROUPER and RECON programs in particular makes it possible to fully recover more TE sequences than each program alone from the <italic>D. melanogaster</italic> genome. (B) Same conclusion from the <italic>A. thaliana</italic> genome.</p>
          </caption>
          <graphic xlink:href="pone.0016526.g002"/>
        </fig>
      </sec>
    </sec>
    <sec id="s2b">
      <title>Classification of TE consensus sequences and identification of structural variation within TE families</title>
      <sec id="s2b1">
        <title>Classification of the consensus sequences and elimination of redundancy</title>
        <p>The three-step approach provided us with a set of <italic>de novo</italic> consensus sequences corresponding to interspersed sequences occurring at least three times in the genome studied. A two-step classification procedure was implemented to add more biological information, to filter out false-positives and to eliminate the redundancy introduced by the combined approach. There is a long-standing debate about the aims of any classification in biology <xref rid="pone.0016526-Mayr1" ref-type="bibr">[47]</xref>, and the case of genomic repeats does not escape the rule: “Although the reality is that repeats […] are a hierarchical evolutionary continuum that defies classification, it is still desirable to impose a simplistic classification that pretends that repeat families are distinct, for the purpose of practical genome annotation” <xref rid="pone.0016526-Bao1" ref-type="bibr">[39]</xref>. In this spirit, our classification procedure begins with the detection of TE features in the consensus sequences, and a decision tree classifying each consensus as a function of these features is then produced (<xref ref-type="fig" rid="pone-0016526-g003">Figure 3</xref>). In the first step, the procedure identifies terminal repeats, tandem repeats, poly-A tails and SSR-like tails (simple sequence repeats). It also aligns the consensus sequences with known TEs through blastn, blastx and tblastx, and with known genes from the host genome. The known TEs are those from Repbase Update, a curated set of TE sequences from numerous genomes <xref rid="pone.0016526-Jurka1" ref-type="bibr">[48]</xref>. Our TE classifier uses a customized version of this databank available from the Repbase Update website (<ext-link ext-link-type="uri" xlink:href="http://www.girinst.org/repbase/">http://www.girinst.org/repbase/</ext-link>), but any customized databank may be used, provided that it is appropriately formatted. In the second step, the procedure implements a decision tree based on the classification summarized in <xref rid="pone.0016526-Wicker1" ref-type="bibr">[5]</xref>. For benchmarking purposes, when analyzing <italic>de novo</italic> consensus sequences from the <italic>D. melanogaster</italic> and <italic>A. thaliana</italic> genomes, we removed the sequences known to belong to these species from the Repbase Update databank, to establish conditions equivalent to those for the analysis of a new genome.</p>
        <fig id="pone-0016526-g003" position="float">
          <object-id pub-id-type="doi">10.1371/journal.pone.0016526.g003</object-id>
          <label>Figure 3</label>
          <caption>
            <title>Simplified decision tree implemented in the TE classifier.</title>
          </caption>
          <graphic xlink:href="pone.0016526.g003"/>
        </fig>
        <p>The classification takes into account the degree of completeness of the <italic>de novo</italic> TE consensus (<xref ref-type="fig" rid="pone-0016526-g003">Figure 3</xref>). For instance, if a consensus sequence has the required “structural features” — LTRs (long terminal repeats), TIRs (terminal inverted repeats) or a tail (poly-A or SSR-like) — and “coding features” — matches with known TEs in tblastx and blastx analyses — then it is considered “complete”. If it has only one of these two types of features, it is classified as “incomplete”. Moreover, a consensus sequence can be classified as “confused” if our TE classifier detects features known to belong to different categories of TEs or, based on the detected features, its length is outside the range of TEs known to have such features. If the consensus has no identifiable features, it is classified as “not categorized”. We also used length parameters (<xref ref-type="supplementary-material" rid="pone.0016526.s009">Table S6</xref>) benchmarked on the reference databanks — BDGP for <italic>D. melanogaster</italic> and Repbase Update for <italic>A. thaliana</italic> — to improve differentiation between presumably truncated and full-length consensus sequences. We also used length parameters when classifying a sequence having only “structural features”, to determine whether the sequence concerned was a SINE or a MITE.</p>
        <fig id="pone-0016526-g004" position="float">
          <object-id pub-id-type="doi">10.1371/journal.pone.0016526.g004</object-id>
          <label>Figure 4</label>
          <caption>
            <title>Extensive structural variations within several TE families.</title>
            <p>Each image provides an overview of a multiple alignment, a column being in one color if all the residues within it are identical. In all the images, the first sequence in the multiple alignment (red star) is the TE reference sequence from a public databank (BDGP or Repbase). For alignments A to D, the second sequence (blue star) is the only <italic>de novo</italic> consensus in which the TE reference sequence is fully recovered by only one clustering method. All sequences below (in brackets) are TE genomic copies found by the <italic>de novo</italic> consensus analysis. For alignments E to H, the sequences below the TE reference sequence are <italic>de novo</italic> consensus that require manual curation. Beside is indicated the program that build them, “R” for RECON and “G” for GROUPER.</p>
          </caption>
          <graphic xlink:href="pone.0016526.g004"/>
        </fig>
        <p>As shown in <xref ref-type="table" rid="pone-0016526-t002">Table 2</xref> for <italic>D. melanogaster</italic> (<xref ref-type="supplementary-material" rid="pone.0016526.s010">Table S7</xref> for <italic>A. thaliana</italic>), our TE classifier retrieved the appropriate classification for the reference TEs, thus predicting a correct classification for <italic>de novo</italic> consensus sequences. Moreover, each high-level category of the TE classification (<italic>e.g.</italic> “class I LTR-retrotransposon”, “class I LINE”, and “class II DNA transposon”) contained similar proportions of <italic>de novo</italic> consensus sequences and TE reference sequences from the BDGP or Repbase Update databanks. Thus, our procedure efficiently classified <italic>de novo</italic> consensus sequences into the appropriate high-level categories.</p>
        <table-wrap id="pone-0016526-t002" position="float">
          <object-id pub-id-type="doi">10.1371/journal.pone.0016526.t002</object-id>
          <label>Table 2</label>
          <caption>
            <title>TEclassifier results for the classification of <italic>D. melanogaster</italic> TE sequences.</title>
          </caption>
          <alternatives>
            <graphic id="pone-0016526-t002-2" xlink:href="pone.0016526.t002"/>
            <table frame="hsides" rules="groups">
              <colgroup span="1">
                <col align="left" span="1"/>
                <col align="center" span="1"/>
                <col align="center" span="1"/>
                <col align="center" span="1"/>
              </colgroup>
              <thead>
                <tr>
                  <td align="left" rowspan="1" colspan="1">Classification</td>
                  <td align="left" rowspan="1" colspan="1">Reference TEs from the BDGP</td>
                  <td align="left" rowspan="1" colspan="1"><italic>De novo</italic> consensus (with redundancy)</td>
                  <td align="left" rowspan="1" colspan="1"><italic>De novo</italic> consensus (without redundancy)</td>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td align="left" rowspan="1" colspan="1">Class I “complete” LTR retrotransposon</td>
                  <td align="left" rowspan="1" colspan="1">56</td>
                  <td align="left" rowspan="1" colspan="1">150</td>
                  <td align="left" rowspan="1" colspan="1">48</td>
                </tr>
                <tr>
                  <td align="left" rowspan="1" colspan="1">Class I “incomplete” LTR retrotransposon</td>
                  <td align="left" rowspan="1" colspan="1">2</td>
                  <td align="left" rowspan="1" colspan="1">377</td>
                  <td align="left" rowspan="1" colspan="1">209</td>
                </tr>
                <tr>
                  <td align="left" rowspan="1" colspan="1">Class I “complete” LINE</td>
                  <td align="left" rowspan="1" colspan="1">23</td>
                  <td align="left" rowspan="1" colspan="1">117</td>
                  <td align="left" rowspan="1" colspan="1">27</td>
                </tr>
                <tr>
                  <td align="left" rowspan="1" colspan="1">Class I “incomplete” LINE</td>
                  <td align="left" rowspan="1" colspan="1">17</td>
                  <td align="left" rowspan="1" colspan="1">147</td>
                  <td align="left" rowspan="1" colspan="1">57</td>
                </tr>
                <tr>
                  <td align="left" rowspan="1" colspan="1">Class I SINE</td>
                  <td align="left" rowspan="1" colspan="1">0</td>
                  <td align="left" rowspan="1" colspan="1">2</td>
                  <td align="left" rowspan="1" colspan="1">1</td>
                </tr>
                <tr>
                  <td align="left" rowspan="1" colspan="1">Class II “complete” DNA transposon</td>
                  <td align="left" rowspan="1" colspan="1">19</td>
                  <td align="left" rowspan="1" colspan="1">30</td>
                  <td align="left" rowspan="1" colspan="1">13</td>
                </tr>
                <tr>
                  <td align="left" rowspan="1" colspan="1">Class II “incomplete” DNA transposon</td>
                  <td align="left" rowspan="1" colspan="1">2</td>
                  <td align="left" rowspan="1" colspan="1">75</td>
                  <td align="left" rowspan="1" colspan="1">32</td>
                </tr>
                <tr>
                  <td align="left" rowspan="1" colspan="1">Class II MITE</td>
                  <td align="left" rowspan="1" colspan="1">0</td>
                  <td align="left" rowspan="1" colspan="1">8</td>
                  <td align="left" rowspan="1" colspan="1">5</td>
                </tr>
                <tr>
                  <td align="left" rowspan="1" colspan="1">Helitron</td>
                  <td align="left" rowspan="1" colspan="1">1</td>
                  <td align="left" rowspan="1" colspan="1">0</td>
                  <td align="left" rowspan="1" colspan="1">0</td>
                </tr>
                <tr>
                  <td align="left" rowspan="1" colspan="1">SSR</td>
                  <td align="left" rowspan="1" colspan="1">0</td>
                  <td align="left" rowspan="1" colspan="1">8</td>
                  <td align="left" rowspan="1" colspan="1">8</td>
                </tr>
                <tr>
                  <td align="left" rowspan="1" colspan="1">Host genes</td>
                  <td align="left" rowspan="1" colspan="1">0</td>
                  <td align="left" rowspan="1" colspan="1">26</td>
                  <td align="left" rowspan="1" colspan="1">11</td>
                </tr>
                <tr>
                  <td align="left" rowspan="1" colspan="1">Confused</td>
                  <td align="left" rowspan="1" colspan="1">1</td>
                  <td align="left" rowspan="1" colspan="1">20</td>
                  <td align="left" rowspan="1" colspan="1">6</td>
                </tr>
                <tr>
                  <td align="left" rowspan="1" colspan="1">No category</td>
                  <td align="left" rowspan="1" colspan="1">5</td>
                  <td align="left" rowspan="1" colspan="1">341</td>
                  <td align="left" rowspan="1" colspan="1">176</td>
                </tr>
                <tr>
                  <td align="left" rowspan="1" colspan="1">Total</td>
                  <td align="left" rowspan="1" colspan="1">126</td>
                  <td align="left" rowspan="1" colspan="1">1301</td>
                  <td align="left" rowspan="1" colspan="1">593</td>
                </tr>
              </tbody>
            </table>
          </alternatives>
        </table-wrap>
        <p>The proportion of <italic>de novo</italic> consensus sequences classified as “incomplete” was high. In <italic>D. melanogaster</italic>, 75% (45% in <italic>A. thaliana</italic>) of the <italic>de novo</italic> consensus sequences classified as “incomplete” LTR retrotransposons matched only with known LTR retrotransposons from Repbase Update but contained no long terminal repeats. All the <italic>de novo</italic> consensus sequences classified as “incomplete” LINE retrotransposons from <italic>D. melanogaster</italic> (28% of those from <italic>A. thaliana</italic>) matched only known LINE retrotransposons from Repbase Update, but with no polyA-/SSR-like tail. Among the <italic>de novo</italic> consensus sequences classified as “incomplete” DNA transposons, 50% of those from <italic>D. melanogaster</italic> (32% of those from <italic>A. thaliana</italic>) matched only known DNA transposons from Repbase Update, but with no TIR. Thus, these <italic>de novo</italic> consensus sequences are classified as “incomplete” in <italic>D. melanogaster</italic> mostly because they lack terminal features, which is not the case for most such consensus sequences in <italic>A. thaliana</italic>. Thus, the clustering programs combined in the TEdenovo pipeline do not generate systematic bias towards “incomplete” TEs of a given kind.</p>
        <p>Moreover, only a few consensus sequences were classified as “confused”, facilitating manual curation. For instance, one 635-bp long consensus sequence built by RECON from the <italic>D. melanogaster</italic> genome has long terminal repeats as well as a poly-A tail which is contradictory according to our classification scheme derived from <xref rid="pone.0016526-Wicker1" ref-type="bibr">[5]</xref>. The consensus sequences classified as “host genes” are detailed in <xref ref-type="supplementary-material" rid="pone.0016526.s011">Table S8</xref>. The high proportion of unclassified consensus sequences (“no category”) reflects the limitations of this classification scheme. We searched all these consensus sequences for HMM profiles specific to TEs. We detected fragments of known TE profiles in only 14% of these unclassified consensus sequences (data not shown). Several of the other corresponded to Helitron reference sequences recovered intact within unclassified <italic>de novo</italic> consensus sequences. Helitrons are difficult to detect as they have no clear structural features other than a terminal hairpin <xref rid="pone.0016526-Tempel1" ref-type="bibr">[49]</xref>. Nonetheless, our <italic>de novo</italic> approach recovered all those with at least three full-length copies in the genome. This confirms the relevance of the combined <italic>de novo</italic> approach as implemented in the TEdenovo pipeline and shows that <italic>de novo</italic> consensus sequences may correspond to TEs even if they remain unclassified by this method.</p>
        <p>As shown above, the combination of clustering programs gave better results than any single program. However, it also provided redundant consensus sequences. We therefore applied a redundancy elimination procedure, in which we considered a consensus sequence to be redundant if it was included in another sequence, over <italic>x</italic>% of its length, with an identity of more than <italic>y</italic>%. We first tested this procedure directly on the whole <italic>de novo</italic> databank. It resulted in the loss of many well classified consensus sequences that were shorter than the misclassified sequences. We therefore applied the redundancy procedure on the basis of the classification. We decided to remove redundant consensus sequences classified as “incomplete” when they were included within consensus sequences classified as “complete”, but not vice versa. The “80-80-80” rule <xref rid="pone.0016526-Wicker1" ref-type="bibr">[5]</xref> has been proposed as a means of identifying copies from the same TE family: two TE copies may be considered to belong to the same family if they are aligned, with 80% identity, over at least 80 bp and 80% of their respective lengths. However, as this rule was originally developed for TE copies and not for consensus sequences, we also tested more stringent parameters (<xref ref-type="supplementary-material" rid="pone.0016526.s012">Table S9</xref>). We found that the best strategy for obtaining a high-quality <italic>de novo</italic> databank with a low level of redundancy was to remove redundant consensus sequences with more stringent parameters: “95-80-98”. This implies that a consensus sequence is removed if it is included within another consensus sequence over 98% of its length, with an identity level exceeding 95%.</p>
      </sec>
      <sec id="s2b2">
        <title>Comparison of de novo and knowledge-based TE annotations</title>
        <p>After the first phase of analysis with the TEdenovo pipeline, we used the <italic>de novo</italic> TE consensus sequence databank to detect all TE fragments and to reconstruct each TE copy in the genome of interest. This annotation phase was achieved with the TEannot pipeline <xref rid="pone.0016526-Quesneville1" ref-type="bibr">[24]</xref> (<xref ref-type="supplementary-material" rid="pone.0016526.s002">Figure S2</xref>), which is also part of the REPET package. TEannot combines several programs for detecting TE fragments, filtering out false-positives and reconstructing intact TE copies. This process involves the connection of TE fragments from the same copy, a procedure also called “TE defragmentation”. While improving the robustness of this pipeline, we notably improved the connection of TE fragments in the MATCHER algorithm (see <xref ref-type="sec" rid="s4">Methods</xref>). For a comprehensive analysis of the performance of the <italic>de novo</italic> approach presented above, we used the TEannot pipeline on both the <italic>D. melanogaster</italic> and <italic>A. thaliana</italic> genomes, with several databanks of <italic>de novo</italic> consensus sequences, each obtained with a specific combination of programs from the TEdenovo pipeline. We first discarded the consensus sequences that could be unambiguously identified as SSRs or host genes. We then compared each annotation with that obtained with the reference TE libraries from the BDGP and Repbase Update databanks (<xref ref-type="table" rid="pone-0016526-t003">Table 3</xref>).</p>
        <table-wrap id="pone-0016526-t003" position="float">
          <object-id pub-id-type="doi">10.1371/journal.pone.0016526.t003</object-id>
          <label>Table 3</label>
          <caption>
            <title>TE annotation results obtained with reference databanks and <italic>de novo</italic> databanks.</title>
          </caption>
          <alternatives>
            <graphic id="pone-0016526-t003-3" xlink:href="pone.0016526.t003"/>
            <table frame="hsides" rules="groups">
              <colgroup span="1">
                <col align="left" span="1"/>
                <col align="center" span="1"/>
                <col align="center" span="1"/>
                <col align="center" span="1"/>
                <col align="center" span="1"/>
                <col align="center" span="1"/>
                <col align="center" span="1"/>
              </colgroup>
              <thead>
                <tr>
                  <td align="left" rowspan="1" colspan="1">Genome</td>
                  <td align="left" rowspan="1" colspan="1">TE databank</td>
                  <td align="left" rowspan="1" colspan="1">Consensus (having copies)</td>
                  <td align="left" rowspan="1" colspan="1">TE genome coverage</td>
                  <td align="left" rowspan="1" colspan="1">Number of copies</td>
                  <td align="left" rowspan="1" colspan="1">S<sub>n</sub>
</td>
                  <td align="left" rowspan="1" colspan="1">S<sub>p</sub>
</td>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td align="left" rowspan="1" colspan="1">
                    <italic>D. mel.</italic>
                  </td>
                  <td align="left" rowspan="1" colspan="1">BDGP</td>
                  <td align="left" rowspan="1" colspan="1">125</td>
                  <td align="left" rowspan="1" colspan="1">10.51%</td>
                  <td align="left" rowspan="1" colspan="1">31208</td>
                  <td align="left" rowspan="1" colspan="1">NA</td>
                  <td align="left" rowspan="1" colspan="1">NA</td>
                </tr>
                <tr>
                  <td align="left" rowspan="1" colspan="1">
                    <italic>D. mel.</italic>
                  </td>
                  <td align="left" rowspan="1" colspan="1">GROUPER</td>
                  <td align="left" rowspan="1" colspan="1">712</td>
                  <td align="left" rowspan="1" colspan="1">10.29%</td>
                  <td align="left" rowspan="1" colspan="1">43699</td>
                  <td align="left" rowspan="1" colspan="1">81.92%</td>
                  <td align="left" rowspan="1" colspan="1">98.12%</td>
                </tr>
                <tr>
                  <td align="left" rowspan="1" colspan="1">
                    <italic>D. mel.</italic>
                  </td>
                  <td align="left" rowspan="1" colspan="1">RECON</td>
                  <td align="left" rowspan="1" colspan="1">437</td>
                  <td align="left" rowspan="1" colspan="1">11.05%</td>
                  <td align="left" rowspan="1" colspan="1">33072</td>
                  <td align="left" rowspan="1" colspan="1">87.77%</td>
                  <td align="left" rowspan="1" colspan="1">97.95%</td>
                </tr>
                <tr>
                  <td align="left" rowspan="1" colspan="1">
                    <italic>D. mel.</italic>
                  </td>
                  <td align="left" rowspan="1" colspan="1">PILER</td>
                  <td align="left" rowspan="1" colspan="1">114</td>
                  <td align="left" rowspan="1" colspan="1">8.87%</td>
                  <td align="left" rowspan="1" colspan="1">32789</td>
                  <td align="left" rowspan="1" colspan="1">74.07%</td>
                  <td align="left" rowspan="1" colspan="1">98.79%</td>
                </tr>
                <tr>
                  <td align="left" rowspan="1" colspan="1">
                    <italic>D. mel.</italic>
                  </td>
                  <td align="left" rowspan="1" colspan="1">RepeatScout</td>
                  <td align="left" rowspan="1" colspan="1">1432</td>
                  <td align="left" rowspan="1" colspan="1">10.86%</td>
                  <td align="left" rowspan="1" colspan="1">42048</td>
                  <td align="left" rowspan="1" colspan="1">85.28%</td>
                  <td align="left" rowspan="1" colspan="1">97.88%</td>
                </tr>
                <tr>
                  <td align="left" rowspan="1" colspan="1">
                    <italic>D. mel.</italic>
                  </td>
                  <td align="left" rowspan="1" colspan="1">G+R+P</td>
                  <td align="left" rowspan="1" colspan="1">568</td>
                  <td align="left" rowspan="1" colspan="1">11.98%</td>
                  <td align="left" rowspan="1" colspan="1">42847</td>
                  <td align="left" rowspan="1" colspan="1">91.43%</td>
                  <td align="left" rowspan="1" colspan="1">97.35%</td>
                </tr>
                <tr>
                  <td align="left" rowspan="1" colspan="1">
                    <italic>A. tha.</italic>
                  </td>
                  <td align="left" rowspan="1" colspan="1">Repbase</td>
                  <td align="left" rowspan="1" colspan="1">318</td>
                  <td align="left" rowspan="1" colspan="1">19.02%</td>
                  <td align="left" rowspan="1" colspan="1">41146</td>
                  <td align="left" rowspan="1" colspan="1">NA</td>
                  <td align="left" rowspan="1" colspan="1">NA</td>
                </tr>
                <tr>
                  <td align="left" rowspan="1" colspan="1">
                    <italic>A. tha.</italic>
                  </td>
                  <td align="left" rowspan="1" colspan="1">GROUPER</td>
                  <td align="left" rowspan="1" colspan="1">1237</td>
                  <td align="left" rowspan="1" colspan="1">18.78%</td>
                  <td align="left" rowspan="1" colspan="1">41791</td>
                  <td align="left" rowspan="1" colspan="1">79.29%</td>
                  <td align="left" rowspan="1" colspan="1">95.43%</td>
                </tr>
                <tr>
                  <td align="left" rowspan="1" colspan="1">
                    <italic>A. tha.</italic>
                  </td>
                  <td align="left" rowspan="1" colspan="1">RECON</td>
                  <td align="left" rowspan="1" colspan="1">1004</td>
                  <td align="left" rowspan="1" colspan="1">23.69%</td>
                  <td align="left" rowspan="1" colspan="1">49470</td>
                  <td align="left" rowspan="1" colspan="1">88.75%</td>
                  <td align="left" rowspan="1" colspan="1">91.59%</td>
                </tr>
                <tr>
                  <td align="left" rowspan="1" colspan="1">
                    <italic>A. tha.</italic>
                  </td>
                  <td align="left" rowspan="1" colspan="1">PILER</td>
                  <td align="left" rowspan="1" colspan="1">300</td>
                  <td align="left" rowspan="1" colspan="1">13.14%</td>
                  <td align="left" rowspan="1" colspan="1">34818</td>
                  <td align="left" rowspan="1" colspan="1">56.56%</td>
                  <td align="left" rowspan="1" colspan="1">97.05%</td>
                </tr>
                <tr>
                  <td align="left" rowspan="1" colspan="1">
                    <italic>A. tha.</italic>
                  </td>
                  <td align="left" rowspan="1" colspan="1">RepeatScout</td>
                  <td align="left" rowspan="1" colspan="1">2893</td>
                  <td align="left" rowspan="1" colspan="1">21.95%</td>
                  <td align="left" rowspan="1" colspan="1">68958</td>
                  <td align="left" rowspan="1" colspan="1">82.91%</td>
                  <td align="left" rowspan="1" colspan="1">92.36%</td>
                </tr>
                <tr>
                  <td align="left" rowspan="1" colspan="1">
                    <italic>A. tha.</italic>
                  </td>
                  <td align="left" rowspan="1" colspan="1">G+R+P</td>
                  <td align="left" rowspan="1" colspan="1">1232</td>
                  <td align="left" rowspan="1" colspan="1">22.77%</td>
                  <td align="left" rowspan="1" colspan="1">44059</td>
                  <td align="left" rowspan="1" colspan="1">87.03%</td>
                  <td align="left" rowspan="1" colspan="1">92.32%</td>
                </tr>
              </tbody>
            </table>
          </alternatives>
          <table-wrap-foot>
            <fn id="nt102">
              <label/>
              <p>“<italic>D. mel.</italic>” stands for “<italic>D. melanogaster</italic>” and “<italic>A. tha.</italic>” stands for “<italic>A. thaliana</italic>”. The S<sub>n</sub> and S<sub>p</sub> columns correspond respectively to sensitivity and specificity results when comparing two annotations in terms of nucleotide overlaps. “G+R+P” indicates that the three programs GROUPER, RECON and PILER were used to build the databank of <italic>de novo</italic> consensus sequences.</p>
            </fn>
          </table-wrap-foot>
        </table-wrap>
        <p>In <italic>D. melanogaster</italic> (<xref ref-type="table" rid="pone-0016526-t003">Table 3</xref>), when using only one clustering method, the GROUPER databank delivered the annotation closest to that obtained with the BDGP reference databank in terms of genome coverage and copy number. Sensitivity was highest with the RECON databank and specificity was highest with the PILER databank. The annotation shows high sensitivity and specificity, together with a high level of genome coverage, for the combined approach. Similar conclusions were drawn from the annotations for <italic>A. thaliana</italic>. An examination of match boundaries (<xref ref-type="supplementary-material" rid="pone.0016526.s003">Figure S3</xref> and <xref ref-type="supplementary-material" rid="pone.0016526.s013">Table S10</xref>) showed that the clustering methods were complementary: GROUPER gave the largest number of exact matches in <italic>D. melanogaster</italic> whereas RECON gave the largest number of exact matches in <italic>A. thaliana</italic>. About RepeatScout, although the specificity of its annotation is very similar with our combined approach, its sensitivity is much lower. Moreover, based only on <xref ref-type="table" rid="pone-0016526-t003">Table 3</xref>, it may appear that using “RECON” gives similar results than using our combined “G+R+P” approach. However, as shown above in <xref ref-type="fig" rid="pone-0016526-g002">Figure 2</xref>, “RECON” is not able to fully recover several TE reference sequences which are fully recovered only by “GROUPER”, and reciprocally. Biologically speaking, it is better to recover a full TE reference sequence as one consensus sequence, rather than several truncated or artifactual consensus sequences. In this context, not only the “G+R+P” approach builds a better library of TE <italic>de novo</italic> consensus sequences, but such a library is also able to provide reliable TE annotation. Thus, the combination of clustering methods in the TEdenovo pipeline leads to the construction of a high-quality TE library delivering annotations similar to those obtained for manually curated databanks.</p>
        <p>We then compared the results of our analyses with those obtained with RepeatModeler (<ext-link ext-link-type="uri" xlink:href="http://www.repeatmasker.org/RepeatModeler.html">http://www.repeatmasker.org/RepeatModeler.html</ext-link>), which combines RECON, RepeatScout, RepeatMasker and TRF and classifies the consensus sequences obtained. For <italic>D. melanogaster</italic>, RepeatModeler generated a library of 141 consensus sequences, with a sensitivity of 78% and a specificity of 76%. However, the recovery ratio of RepeatModeler (R<sub>CC</sub> = 21%) was much lower than that of the TEdenovo pipeline (R<sub>CC</sub> = 72%). This indicates that RepeatModeler recovers only a few intact TE reference sequences. Similar results were obtained for <italic>A. thaliana</italic>, with all three measurements showing lower values with RepeatModeler than with TEdenovo (<xref ref-type="supplementary-material" rid="pone.0016526.s014">Table S11</xref>). Running the TEannot pipeline with the consensus sequences generated by RepeatModeler resulted in a sensitivity markedly lower than that for the annotations obtained with the <italic>de novo</italic> library from the TEdenovo pipeline, although specificity was slightly higher (<xref ref-type="supplementary-material" rid="pone.0016526.s015">Table S12</xref>). The combination of several tools is therefore not sufficient in itself to improve the results. The way in which the tools are chosen and combined is determinant. We conclude that the TEdenovo pipeline achieves a good balance between sensitivity and specificity in the <italic>de novo</italic> construction of a TE databank from raw genomic sequences.</p>
        <p>We therefore developed the REPET package available online (<ext-link ext-link-type="uri" xlink:href="http://urgi.versailles.inra.fr/index.php/repet">http://urgi.versailles.inra.fr/index.php/repet</ext-link>), into which we integrated both the TEdenovo and TEannot pipelines, with the TE classifier described above corresponding to the final step of the TEdenovo pipeline. The REPET package was specifically designed to improve speed and tractability by (i) interacting with MySQL tables at several key points to take advantage of the SQL language, and (ii) automatically handling jobs launched in parallel on a cluster <italic>via</italic> free batch-queuing systems, such as the Sun Grid Engine (now known as Oracle Gene Engine), relaunching jobs in cases of cluster node failure. This package is thus specifically implemented for computationally intensive, genome-wide analyses that do not compromise the biological relevance of the results (see <xref ref-type="supplementary-material" rid="pone.0016526.s016">Table S13</xref> for details about computation times). As already pointed out by several authors, tools for <italic>de novo</italic> TE identification are “quite difficult to use, indicating the need for better user interfaces and auto-optimization” <xref rid="pone.0016526-Saha1" ref-type="bibr">[32]</xref>. We facilitated the use of our tools, by concealing technical details behind interfaces, one per pipeline. The user is also provided with access to a detailed tutorial and a configuration file with default parameters.</p>
      </sec>
      <sec id="s2b3">
        <title>Identification of structural variation within TE families and manual curation</title>
        <p>After annotating the TE copies in both genomes, we investigated the structural diversity within TE families, as represented by the large number of <italic>de novo</italic> consensus. We focused on the TE families for which the “knowledge-based” consensus was fully recovered by only one clustering method, GROUPER or RECON, as shown in <xref ref-type="fig" rid="pone-0016526-g002">Figure 2</xref> (see also <xref ref-type="supplementary-material" rid="pone.0016526.s017">Table S14</xref> and <xref ref-type="supplementary-material" rid="pone.0016526.s018">Table S15</xref>). Indeed, the failure of one method (either GROUPER or RECON) to recover all the TEs would illustrate differences in the ability of these methods to take TE structural variations into account. For each of these TE families, we retrieved genomic copies detected by the <italic>de novo</italic> consensus and built multiple alignments (see <xref ref-type="sec" rid="s4">Methods</xref>). <xref ref-type="fig" rid="pone-0016526-g004">Figure 4</xref> (cases a, b, c and d) provides an overview of several of these multiple alignments displaying extensive structural variations. In almost all TE families, differences between genomic copies were observed, due to substitutions and indels. The clustering method generated different clusters as a function of these differences and the fragmentation of the copies. Depending on the specific features of each algorithm, the consensus will correspond to the complete TE reference sequence or a truncated version of that sequence.</p>
        <p>We then looked for features particular to the TE families for which the reference sequence was fully recovered by only one clustering method, being recovered only partially with another method. We first compared the classification of these TE reference sequences. In <italic>D. melanogaster</italic>, the four TE reference sequences fully recovered only by GROUPER were all LTR retrotransposons, whereas the nine TE reference sequences fully recovered only by RECON comprised four LTR retrotransposons, three LINE retrotransposons and two DNA transposons. In <italic>A. thaliana</italic>, the eight TE reference sequences fully recovered only by GROUPER comprised five LTR retrotransposons and three DNA transposons, whereas the fifteen TE reference sequences fully recovered only by RECON comprised six LTR retrotransposons, eight DNA transposons and one Helitron. There were therefore no clear differences in the recovery of full-length TE reference sequences obtained with different clustering methods. We also looked for differences in terms of copy number. However, the TE reference sequences fully recovered only by GROUPER or only by RECON had similar numbers of full-length and truncated copies (data not shown). Comparisons of <italic>de novo</italic> consensuses and “knowledge-based” consensuses, as in <xref ref-type="table" rid="pone-0016526-t001">Table 1</xref>, showed that RECON was systematically the most sensitive method, whereas GROUPER was systematically the most specific. As a result, several TE reference sequences displayed partial matches with <italic>de novo</italic> consensuses from RECON only. Moreover, almost 50% of the <italic>de novo</italic> consensus sequences from RECON lacked both boundaries of the TE reference sequences, versus less than 20% of the consensus sequences from GROUPER. Conversely, a <italic>de novo</italic> library from GROUPER is likely to match with fewer TE reference sequences, but, when a match does occur, at least one boundary of the reference is likely to be correctly retrieved. Consequently, GROUPER and RECON are truly complementary, making the combined approach implemented in the TEdenovo pipeline very efficient.</p>
        <p>Our TE classifier can combine <italic>de novo</italic> consensus sequences from various sources, but manual curation is still required in some cases, particularly when there are several consensus sequences related to the same TE family (<xref ref-type="supplementary-material" rid="pone.0016526.s019">Table S16</xref>). <xref ref-type="fig" rid="pone-0016526-g004">Figure 4</xref> (alignments E to H) shows several examples in which manual curation of the <italic>de novo</italic> consensus sequences identified by GROUPER and RECON for a given TE family improves the recovery of the reference sequence. For instance, in <xref ref-type="fig" rid="pone-0016526-g004">Figure 4-E</xref>, all consensus sequences from RECON are truncated before the 3′ LTR of the ATLANTYS2 element whereas the G1184 consensus sequence from GROUPER connects this LTR with part of the internal region of the element. In <xref ref-type="fig" rid="pone-0016526-g004">Figure 4-F</xref>, two consensuses can be removed, G512 from GROUPER, a a solo-LTR, and G803, which is chimeric. Moreover, we can add the internal region of the element present in G1497, which lacks the 3′ LTR, to the truncated R474 from RECON. A similar strategy can be applied in <xref ref-type="fig" rid="pone-0016526-g004">figures 4-G and 4-H</xref>. Thus, although it is not always possible to recover the full reference sequence, we can improve the final <italic>de novo</italic> consensus by manual curation, making use of the multiple alignment of classified consensuses to guide informed decision-making.</p>
        <p>The TEdenovo pipeline identified putative new TEs in the <italic>D. melanogaster</italic> and <italic>A. thaliana</italic> genomes, despite the intensity with which these genomes have been studied and annotated manually. Indeed, we found <italic>de novo</italic> consensus sequences that were classified as “complete” TE but had no single match in blastn with known TE reference sequences from the BDGP or Repbase Update databanks. Three such sequences were identified in <italic>D. melanogaster</italic> (two from GROUPER and one from RECON), and four in <italic>A. thaliana</italic> (three from RECON and one from PILER). For example, in <italic>D. melanogaster</italic>, a 7.8 kb <italic>de novo</italic> consensus was classified as a “complete” LTR retrotransposon on the basis of its two long terminal repeats (each 510 nt long) and its matches with known LTR retrotransposons from Repbase Update in tblastx and blastx analyses. Furthermore, this consensus matched two HMM profiles corresponding to an integrase and an aspartic proteinase. There were four full-length copies in the genome, two of which retained their target site duplications. This <italic>de novo</italic> consensus sequence is probably non autonomous, as it lacks matches with HMM profiles corresponding to other LTR retrotransposon genes, and, notably, displays no match with a reverse transcriptase. However, it has enough of the typical properties of TEs and enough full-length copies to correspond to a true TE, rather than a mere segmental duplication containing TE fragments.</p>
      </sec>
    </sec>
  </sec>
  <sec id="s3">
    <title>Discussion</title>
    <sec id="s3a">
      <title>Combining approaches to build high-quality TE <italic>de novo</italic> consensus sequence databanks for sequenced genomes</title>
      <p>Transposable elements play a key role in the structure and evolution of genomes, but their impact remains to be fully elucidated. If we are to make use of the increasing numbers of genome sequencing projects to improve our understanding of TE biology, we will need an efficient, automatic <italic>de novo</italic> approach for the annotation of genome TE content. Several methods praised for their rapidity and low memory requirements, such as the MDR index <xref rid="pone.0016526-Kurtz1" ref-type="bibr">[50]</xref>, and P-clouds <xref rid="pone.0016526-Gu1" ref-type="bibr">[51]</xref>, provide a good overview of the repeat content of a given genome. However, they are not precise enough to provide insight into the functional impact of TEs (see for instance <xref rid="pone.0016526-Newman1" ref-type="bibr">[52]</xref> and <xref rid="pone.0016526-Teixeira1" ref-type="bibr">[53]</xref>). As such, these methods are good starting points but are inadequate for a full exploration of biological questions relating to TEs.</p>
      <p>The typical process of TE annotation, as we see it, should involve the identification of all TE copies throughout the genome and proceed in two phases. The first step is the construction of a <italic>de novo</italic> library of TE consensus sequences representing the TE families present in the genome. This library is then used to mine all the TE fragments present in the genome. The TE copies are then reconstructed, usually nested within each other, to unravel their intricate evolution. We describe here a new strategy for constructing databanks of TE consensus sequences by <italic>de novo</italic> methods. Our results for the <italic>D. melanogaster</italic> and <italic>A. thaliana</italic> genomes show that an approach combining several clustering programs provides the best outcome, in terms of sensitivity and specificity, for the identification of TE families and the annotation of their TE copies.</p>
      <p>Previous studies have already compared tools for <italic>de novo</italic> TE identification, either to propose a new algorithm (as for RECON, PILER and RepeatScout) or to help experimental biologists to use the most suitable tools for their analysis <xref rid="pone.0016526-Saha1" ref-type="bibr">[32]</xref>. In most of these studies, the results were validated by comparing the final TE copy annotations in terms of genome coverage, rather than by evaluating the accuracy of <italic>de novo</italic> TE consensus sequence identification. Little attention has been paid to analyses of the <italic>de novo</italic> databank itself. The use of consensus sequences corresponding to truncated or artifactual TEs would clearly bias subsequent annotations. We therefore propose three indices for measuring the quality of <italic>de novo</italic> databanks, with respect to reference databanks. This combined approach was validated by considering the proportion of <italic>de novo</italic> consensus sequences corresponding to full-length reference sequences, with well-defined boundaries.</p>
    </sec>
    <sec id="s3b">
      <title>Classification of TE sequences on the basis of their biological features and the curation of TE <italic>de novo</italic> databanks</title>
      <p>The tools typically used for the <italic>de novo</italic> identification of TE families provide no additional meta-data about the consensus sequences they build. Instead, the user has to use other tools to obtain a putative classification of the sequences obtained. Here, we implemented a combined <italic>de novo</italic> approach for the identification of TE families and developed a dedicated procedure for classifying sequences on the basis of TE features. We based our TE classifier on the classification proposed in <xref rid="pone.0016526-Wicker1" ref-type="bibr">[5]</xref>, from class to superfamily, combining various sources of information about TEs in a modular manner. This procedure was designed to be run in isolation for the analysis of any databank of putative TE-related sequences and for integration into the TEdenovo pipeline, to facilitate its use.</p>
      <p>The current version of our tool, TEclassifier, requires further improvement for the classification of less well known TEs, such as DIRS-like elements, Penelope-like elements, Crypton elements and Polintons/Mavericks. However, unlike tools like TEclass <xref rid="pone.0016526-Abrusan1" ref-type="bibr">[54]</xref>, which makes use of the profiles of frequent <italic>k</italic>-mers from the Repbase Update databank, our TE classifier guides output classification by detailing the precise TE features present on the analyzed sequences, such as terminal repeats and matches with known TEs. Our tool and REPclass <xref rid="pone.0016526-Feschotte2" ref-type="bibr">[55]</xref> are very similar, but our TE classifier has several advantages. Being part of the REPET package, it benefits from the architecture of this package and is therefore able to handle large databanks, which is often required when studying large genomes. Moreover, our TE classifier not only classifies putative TEs, it also makes it possible to filter out false-positives and to remove redundant sequences present in the input databank.</p>
      <p>In a wider perspective, we considered manual curation, a key topic in genome annotation. Computer-based predictions for the annotations of protein-coding genes are now of high quality, but it remains difficult to predict exon-intron boundaries correctly <xref rid="pone.0016526-Brent1" ref-type="bibr">[56]</xref>. Major efforts have been and are being made to improve the automatic annotation of protein-coding regions, but such efforts have been much less intensive for other parts of the genome, including TEs. In this study, we tried to fill this gap by designing the REPET package for the comprehensive association of all the meta-data obtained for a given TE family: (i) the <italic>de novo</italic> consensus sequences, (ii) the TE features used to classify them, (iii) the all-by-all comparisons from which they were built, and (iv) the TE copies they identify on the chromosomes. As a result, the manual curator can make informed decisions based on the biological features at hand, and the curated TE consensus databank can be used to provide a second release of TE annotations.</p>
    </sec>
    <sec id="s3c">
      <title>Efficiency of <italic>de novo</italic> approaches for recovering ancestral TEs and their structural variants from “junk”</title>
      <p>At the core of any <italic>de novo</italic> approach lies the possibility of identifying new agents in a given system by searching for their fundamental properties. In our case, we were confronted with raw whole-genome sequences containing numerous repeated sequences of different kinds, some of which have specific features and a common ancestry. We were interested in identifying, from among these sequences, TEs — interspersed repeats — and, more particularly, the ancestral sequences that actually transposed. The current copies of such sequences are likely to be divergent, fragmented and nested within each other, as TE families typically display extensive structural variation (<xref ref-type="fig" rid="pone-0016526-g004">Figure 4 A–D</xref>). We showed in this study that the <italic>de novo</italic> approach could recover some full-length TE sequences by correctly collecting together their fragments, even if no TE feature could be used to classify them. This was the case here for several Helitron reference sequences in the <italic>A. thaliana</italic> genome. Similarly, we were able to identify putative new non autonomous TEs in the <italic>D. melanogaster</italic> and <italic>A. thaliana</italic> genomes that had all the essential features of TEs but were nonetheless absent from the reference databanks.</p>
      <p>Efficient and robust tools are essential to keep pace with current whole-genome sequencing programs. Our analyses were performed on small model genomes. However, the <italic>de novo</italic> approach and the tools we presented here are scalable, at least to genomes reaching 500 Mb. Indeed, preliminary versions of the TEdenovo and TEannot pipelines were used to annotate the TE content of the 464-Mb aphid genome totalizing 38% of TEs <xref rid="pone.0016526-The2" ref-type="bibr">[31]</xref>. Moreover, our tools are modular and almost all steps can be launched in parallel, thus taking advantage of today's computer clusters. Future work will be dedicated to the improvement of the clustering step in the TEdenovo pipeline in order to provide, also to very large genomes, the ability to jointly annotate TEs and study their diversification. For all projects in which the aim is to sequence large and highly repetitive genomes (<italic>e.g.</italic> barley, hexaploid wheat), computational tools, such as the TEdenovo pipeline presented here, are likely to become increasingly useful for increasing our knowledge of the evolution of genome structure and the functional impact of TEs on neighboring genes.</p>
    </sec>
  </sec>
  <sec sec-type="methods" id="s4">
    <title>Methods</title>
    <sec id="s4a">
      <title>Genome sequences and TE reference databanks as benchmark</title>
      <p>In 2000, an international consortium driven by the Berkeley Drosophila Genome Project (BDGP) sequenced, assembled and annotated the genome of an isogenic <italic>y</italic>; <italic>cn bw sp</italic> strain of <italic>D. melanogaster</italic>
<xref rid="pone.0016526-Adams1" ref-type="bibr">[57]</xref>, this work now being continued at FlyBase (<ext-link ext-link-type="uri" xlink:href="http://flybase.org/">http://flybase.org/</ext-link>). In this study, we used the 118.4 Mb release 4 genome sequence corresponding mostly to euchromatin regions. Release 5 became available in 2006 and corresponds to release 4 with 50.3 Mb of additional heterochromatic regions and minor sequence corrections. We chose to work on release 4, which remains the <italic>D. melanogaster</italic> genomic sequence best annotated for TEs <xref rid="pone.0016526-Quesneville1" ref-type="bibr">[24]</xref>, <xref rid="pone.0016526-Bergman1" ref-type="bibr">[25]</xref>, despite the availability of the later sequence.</p>
      <p>Flybase provides a set of natural TE sequences experimentally identified in several Drosophilidae genomes. The latest version of this data set (bdgp9.41) consists of 179 sequences corresponding to different TE families, 126 of which have been detected in <italic>D. melanogaster</italic> strains. Each of these 126 sequences corresponds either to a TE copy of the given family present in <italic>D. melanogaster</italic> or to a consensus based on TE copies for the family concerned. In the latter case, consensuses were built either as a mosaic of TE copies or following a “majority rule” from a multiple alignment. In this study, these 126 sequences are referred to as “reference TEs”. The aim of the <italic>de novo</italic> approach presented in this article is to reconstruct such a library of TE sequences.</p>
      <p>In 2000, 115 Mb of the 125 Mb genome of <italic>A. thaliana</italic> accession Columbia had been sequenced, assembled and annotated <xref rid="pone.0016526-The3" ref-type="bibr">[58]</xref>. For our analyses, we used the 119 Mb of <italic>A. thaliana</italic> release 9 genome sequences available from the TAIR website (<ext-link ext-link-type="uri" xlink:href="http://www.arabidopsis.org/">http://www.arabidopsis.org/</ext-link>). For <italic>A. thaliana</italic>, a similar set of reference TEs is present in the Repbase Update databank. We used the library derived from this databank for previous studies <xref rid="pone.0016526-Buisine1" ref-type="bibr">[29]</xref> and containing 318 TE sequences.</p>
      <p>We annotated both genomes with the TEannot pipeline <xref rid="pone.0016526-Quesneville1" ref-type="bibr">[24]</xref> using the reference databanks cited above. We then constructed a consensus for each reference sequence, from the multiple alignment of copies when at least three copies longer than 100 bp were present (<xref ref-type="supplementary-material" rid="pone.0016526.s020">Table S17</xref>). For <italic>D. melanogaster</italic>, a consensus could be obtained for only 117 of the 126 reference sequences in the BDGP databank, referred to as a “knowledge-based” consensus: 68 of these sequences corresponded exactly to their reference element, the others being truncated. For <italic>A. thaliana</italic>, it was possible to construct 305 “knowledge-based” consensuses for the 318 TE reference sequences in the Repbase Update databank: 154 corresponded to the entire element and the others were truncated. These consensuses were collected into “knowledge-based” databanks. As such, they represent the upper limit of what can be retrieved with the <italic>de novo</italic> methods compared in this study (<xref ref-type="supplementary-material" rid="pone.0016526.s021">Table S18</xref>).</p>
    </sec>
    <sec id="s4b">
      <title><italic>De novo</italic> detection of TEs</title>
      <p>A three-step approach forms the backbone of our analysis: (i) self-alignment of the genomic sequences, (ii) clustering of the resulting matches, and (iii) multiple alignments of each cluster to build a consensus (<xref ref-type="supplementary-material" rid="pone.0016526.s001">Figure S1</xref>). Different programs may be used at each step, leading to several possible combinations. For each combination, we compared the <italic>de novo</italic> consensus with the set of reference TEs. Other methods are also available for constructing a consensus for comparison with the “knowledge-based” databanks constructed as described above.</p>
      <p>When comparing a <italic>de novo</italic> databank with a “knowledge-based” databank, it is not possible to calculate the number of false-negatives, <italic>i.e.</italic> the <italic>de novo</italic> consensus sequences incorrectly classified as not related to a TE because these consensus sequences are not present in the <italic>de novo</italic> library. The usual definitions of sensitivity and specificity are therefore not directly applicable. We estimated sensitivity by calculating the proportion of “knowledge-based” consensus sequences matching <italic>de novo</italic> consensus sequences (noted S<sub>n</sub>*). We then estimated specificity by considering the proportion of <italic>de novo</italic> consensus sequences matching “knowledge-based” consensus sequences (noted S<sub>p</sub>*). The observation of a <italic>de novo</italic> consensus that matches a “knowledge-based” consensus, both aligned along their entire lengths (+- 5%) indicates that this <italic>de novo</italic> consensus retrieved the exact and entire “knowledge-based” consensus. A recovery ratio (noted R<sub>CC</sub> for “complete-complete ratio”) can be calculated as the number of “knowledge-based” consensus sequences exactly retrieved by a <italic>de novo</italic> consensus, divided by the number of reference sequences exactly retrieved by a “knowledge-based” consensus. In <italic>D. melanogaster</italic>, 68 reference sequences (of the 126 in the BDGP databank) were exactly retrieved by a “knowledge-based” consensus, and 154 such sequences (of the 318 in Repbase Update) were exactly retrieved in <italic>A. thaliana</italic>. As an illustration, in <italic>D. melanogaster</italic>, if a given <italic>de novo</italic> method recovers 60 entire “knowledge-based” consensus sequences from a given genome, R<sub>CC</sub> would be 88% (60/68).</p>
      <sec id="s4b1">
        <title>First step: self-alignment of the genomic sequences</title>
        <p>The first step is the self-alignment of the genomic sequences in an all-by-all manner. We compared two programs, BLASTER <xref rid="pone.0016526-Quesneville3" ref-type="bibr">[36]</xref> and PALS <xref rid="pone.0016526-Rasmussen1" ref-type="bibr">[38]</xref> for this purpose. BLASTER is a wrapper for the BLAST softwares <xref rid="pone.0016526-Altschul1" ref-type="bibr">[37]</xref>. It was used for comparisons at the genome scale. It begins by cutting long queries into batches and launching them in parallel against the subject databank. The second program, PALS, implements a filter algorithm. It first finds all exact matches of length <italic>q</italic> between the query and subject sequences. It then restricts the search by identifying regions (parallelograms in the alignment matrix) containing a number of hits above a given threshold. Finally, if these regions have a length above a given threshold, PALS develops a chain of hits for each region, aligns the nucleotides and returns the coordinates of the resulting matches. For BLASTER, we kept matches with E-value below 10<sup>−300</sup>, a length exceeding 100 bp and an identity exceeding 90% (parameters “-E 1e-300 -L 100 -I 90”). For PALS, we used the default parameters: identity exceeding 94% and a length of more than 400 bp (parameters “-length 400 -pctid 94”). If the same parameters were used for BLASTER (identity &gt;90% and length &gt;100 bp), the computations took too long, even when launched in parallel. If the parameters length &gt;100 bp and identity &gt;94% were used with both programs, BLASTER still gave better results (data not shown).</p>
        <p>When all the matches had been retrieved, we discarded all those that were more than 20,000 bp long. This procedure was designed to filter out repeats corresponding to long segmental duplications. The issue of short segmental duplications was addressed in the next step. To speed up the computations, the input genome sequences were cut into chunks of length 200 kb with 10kb overlaps. These values are parameters of the tool and can thus be changed easily, according to the genome size, its repeat content, as well as technical details such as the number of nodes in the computer cluster. Each chunk was then aligned against the whole set of chunks, in parallel. Finally all the matches were collected together and redundant matches were filtered out.</p>
      </sec>
      <sec id="s4b2">
        <title>Second step: clustering of the resulting pairwise alignments</title>
        <p>The matches obtained in the first step were then clustered, and we tested three different programs for this step: GROUPER (<xref rid="pone.0016526-Quesneville3" ref-type="bibr">[36]</xref>, parameters “-j -C 0.95 -Z 3 -X 2 -G -1”), RECON (<xref rid="pone.0016526-Bao1" ref-type="bibr">[39]</xref>, default parameters) and PILER (<xref rid="pone.0016526-Edgar1" ref-type="bibr">[40]</xref>, parameter “-trs”).</p>
        <p>As TEs are frequently inserted within each other, GROUPER first aims at retrieving the full-length copies by connecting their fragments <italic>via</italic> a dynamic programming algorithm applied to the pairwise alignments. It links together, in chains, the matches corresponding to fragments belonging to the same TE copy but interrupted by indels. It then uses single-link clustering to gather similar chains of matches into the same cluster, using a high-coverage constraint (95%), and merges chains corresponding to the same locus. The use of a high-coverage constraint makes it possible to identify different structural variants from a given TE family (<xref ref-type="fig" rid="pone-0016526-g001">Figure 1</xref>): two copies from two different variants overlap by less than 95% threshold, and are therefore assigned to different clusters. The previous version of GROUPER suffered from the high redundancy among clusters, preventing its usage in practice on large genomes. Therefore, we implemented a new procedure that specifies, during the single-link clustering step, if a chain of matches is fully included within another one, as is often the case with non-autonomous TEs with respect to their autonomous counterparts. Once the clusters are built, we now remove those having less than a given number of members not included in any others (option “-X 2”).</p>
        <p>RECON uses a different strategy, first trying to infer the ancestral TE copies, named “elements”, from all the fragments at each locus. It does this by single-link clustering with a low-coverage constraint (50%), followed by an additional procedure focusing on the aggregation of endpoints to ensure the correct handling of composite elements, such as segmental duplications. It then gathers the “elements” into families again by single-link clustering, but this time with a high-coverage constraint (90%), and a procedure is then applied to deal with families that are related but different, based on length ratio and similarity thresholds.</p>
        <p>We also tested the PILER suite of programs. In this work, “PILER” refers systematically to PILER-DF, which focuses on interspersed repeats. PILER first defines “piles” as lists of matches covering a maximal contiguous region. It then globally aligns these piles, rather than the individual matches themselves. This prevents bias towards the shortest match in the pile. Finally, piles that cannot be globally aligned with each other over 95% of their length are gathered into clusters.</p>
        <p>All these three programs, GROUPER, RECON and PILER, return a set of clusters to which we applied several filters. First, we removed the clusters with fewer than three members. This discarded most of the short segmental duplications. Second, for large clusters, we retained only the 20 longest sequences, as keeping all the sequences would not add much information for the building of a consensus and would even introduce noise (data not shown). Third, for GROUPER, we filtered the sequences resulting from connected matches (<italic>i.e.</italic> chains) with a cumulative length greater than 20 kb and spanning more than 30 kb of the genome, as such sequences probably corresponded to segmental duplications.</p>
      </sec>
      <sec id="s4b3">
        <title>Third step: multiple alignments and consensus construction</title>
        <p>Finally, for each cluster, a multiple sequence alignment (MSA) was constructed, from which a consensus was derived. We compared several programs: MAP (<xref rid="pone.0016526-Huang1" ref-type="bibr">[42]</xref>, parameters “gap-size = 50 mismatch = −8 gap-open = 16 gap-extend = 4”), CLUSTAL-W (<xref rid="pone.0016526-Thompson1" ref-type="bibr">[43]</xref>, default parameters), MAFFT (<xref rid="pone.0016526-Katoh1" ref-type="bibr">[44]</xref>, parameter “–auto”) and PRANK (<xref rid="pone.0016526-Loytynoja1" ref-type="bibr">[45]</xref>, parameter “-F”). The consensus was constructed by applying a majority rule discarding columns in which all but one sequence had a gap.</p>
        <p>MAP was specifically designed to handle long gaps. Such gaps frequently occur when aligning TE copies of different lengths from the same TE family. In this program, gaps are not penalized beyond a given length. CLUSTAL-W is a well known progressive MSA algorithm, and was the first to propose position-specific gap penalties. MAFFT addresses the issue of CPU time by using Fast Fourier Transform for the rapid detection of homologous segments. It also implements a normalized similarity matrix that is said to perform better for alignments with sequences of different lengths. This program was the fastest MSA program we tested. PRANK takes into account the phylogenetic information contained in indels to distinguish insertions from deletions, to position them properly and avoid the overestimation of deletions. This sophistication renders PRANK much slower than MAP (10 times slower for a typical cluster containing 16 sequences of 8 kb each).</p>
      </sec>
      <sec id="s4b4">
        <title>Other approaches</title>
        <p>Other methods have also been proposed. We tested REPEATSCOUT <xref rid="pone.0016526-Price1" ref-type="bibr">[46]</xref> and RepeatModeler (Smit and Hubley unpublished), both with default parameters. RepeatScout begins by keeping high-frequency strings of length <italic>k</italic>, called <italic>k</italic>-mers. The program initially takes the most frequent <italic>k</italic>-mer and sets the consensus as being the <italic>k</italic>-mer in question. Based on the multiple alignment of all its occurrences, the program extends this consensus one nucleotide at a time, in both directions, according to a specific scoring function. For correct definition of the consensus boundaries, the scoring function is designed to allow extension of the consensus, even if shared by some alignments, but not all. Once the consensus can be extended no further, the program detects all its occurrences in the genome, and updates the initial table of <italic>k</italic>-mer frequencies accordingly. This procedure is applied iteratively for each <italic>k</italic>-mer with a frequency above a given threshold.</p>
      </sec>
    </sec>
    <sec id="s4c">
      <title>Classification of TE consensus and the elimination of redundancy</title>
      <p>We implemented a two-step TE classifier. The first step detects structural features of the consensus, such as terminal repeats, tandem repeats, and polyA or SSR-like tails, using programs from the REPET package (TRsearch, polyAtail) or elsewhere (TRF, <xref rid="pone.0016526-Benson1" ref-type="bibr">[59]</xref>). It also searches for matches with known TEs, by blastx, tblastx and blastn analysis, and for matches with known genes from the host's genome, by blastn analysis. The second step is based on a decision tree (<xref ref-type="fig" rid="pone-0016526-g003">Figure 3</xref>) classifying each consensus according to its length and features. The classification and the evidence underlying the classification are delivered as output. Any program looking for other TE features, such as Helitron hairpins, could easily be integrated into this framework.</p>
      <p>We eliminated redundant consensus sequences, by discarding all those included within another consensus sequence, for at least <italic>x</italic>% of their length, and with at least <italic>y</italic>% identity. We tested several values for <italic>x</italic> and <italic>y</italic>: 95-98, 90-90 and 80-80. We tested this procedure with and without taking into account the classification of the sequences.</p>
    </sec>
    <sec id="s4d">
      <title>Genome-wide annotation of TE copies</title>
      <p>A combined pipeline named TEannot for the genome-wide annotation of TE copies is already available <xref rid="pone.0016526-Quesneville1" ref-type="bibr">[24]</xref> (<xref ref-type="supplementary-material" rid="pone.0016526.s002">Figure S2</xref>). As input, it takes the genome sequences and a databank of TE sequences, typically that generated by the TEdenovo pipeline. It then launches BLASTER <xref rid="pone.0016526-Quesneville3" ref-type="bibr">[36]</xref>, RepeatMasker (<ext-link ext-link-type="uri" xlink:href="http://www.repeatmasker.org/">http://www.repeatmasker.org/</ext-link>) and CENSOR <xref rid="pone.0016526-Jurka2" ref-type="bibr">[60]</xref>, to map the TE sequences against the genome. False-positives are filtered out by applying the same procedure to shuffled genomic sequences. More precisely, the genomic sequences are randomized using the “shuffle” program of the HMMER package (<ext-link ext-link-type="uri" xlink:href="http://hmmer.janelia.org/">http://hmmer.janelia.org/</ext-link>). The TE reference sequences are then mapped onto these shuffled sequences with BLASTER, RepeatMasker and CENSOR, with the score for each match recorded. Finally, the matches between the TE reference sequences and the true genomic sequences are filtered according to these scores. Whereas in a previous version of the pipeline we used the highest score obtained on randomized genomic sequences to filter false-positives, we now use the 95% quantile of the scores obtained on the randomized sequences. This improvement prevents excessive filtering, using a single, very good match on randomized sequences, much better than most others. This change slightly increases TE coverage over previous estimations.</p>
      <p>Once the matches were filtered, we began to reconstruct the TE copies, to obtain a true annotation of TE copies and not of TE fragments only. In this pipeline, two steps are used to connect several TE fragments belonging to the same TE copy: MATCHER <xref rid="pone.0016526-Quesneville3" ref-type="bibr">[36]</xref> and the “long join” procedure. As in the <italic>de novo</italic> library, a TE family may be represented by several consensus sequences corresponding to each of its structural variants. We improved these tools to take this into account. In terms of vocabulary, we define a “TE fragment” as a match between a TE consensus sequence and a genomic sequence, whereas we define a “TE copy” as a chain of matches, each match in the chain being a TE fragment. Note that a full-length TE copy may correspond to two TE fragments, which, when connected together, correspond to the full TE consensus sequence.</p>
      <p>In the previous version of MATCHER, we began by combining the matches found by all three algorithms mentioned above. When two consensus sequences overlapped at a given locus, we retained the sequence with the highest score and truncated the other. We then connected the remaining matches by dynamic programming. In the current version of MATCHER, we first connect the matches by dynamic programming and then filter out overlapping chains of matches. A match that might have been filtered out in the previous version may not be filtered out in the current version, if it is chained with another match, thereby improving fragment connections. TE annotations would be improved by taking into account chains of matches (whole TE copies) rather than TE fragments (single matches).</p>
      <p>Once matches are connected by MATCHER, the TEannot pipeline also detects microsatellites by launching and combining the results of TRF <xref rid="pone.0016526-Benson1" ref-type="bibr">[59]</xref>, Mreps <xref rid="pone.0016526-Kolpakov1" ref-type="bibr">[61]</xref> and RepeatMasker. All TE copies are then combined with microsatellite coordinates to filter out short TE matches fully recovered by microsatellites.</p>
      <p>In the same spirit, we improved the “long join” procedure. We previously sorted the chains of matches on the basis of length, as a proxy for the age of the TE copies. The rationale behind this was that a TE copy may disappear slowly due to small deletions, becoming shorter over time. We now estimate the age of a TE copy by calculating the ratio of match identity to match length, summing this ratio for all matches in the chain.</p>
      <p>Finally, we compared the annotations obtained with <italic>de novo</italic> libraries and reference databanks, by calculating genome coverage and TE copy number, together with sensitivity and specificity, in terms of nucleotide overlaps (<xref ref-type="supplementary-material" rid="pone.0016526.s003">Figure S3</xref>). A high sensitivity indicates that the annotation based on <italic>de novo</italic> consensus sequences misses few TE nucleotides (false-negatives). A high specificity indicates that the <italic>de novo</italic> annotation identifies few non-TE nucleotides (false-positives).</p>
    </sec>
    <sec id="s4e">
      <title>Reconstruction of TE families</title>
      <p>We compared the patterns of diversification between TE families, by mining the genome with the <italic>de novo</italic> consensus sequences, using BLAT <xref rid="pone.0016526-Kent1" ref-type="bibr">[62]</xref> for the rapid identification of well conserved genomic copies. We then constructed a multiple alignment with the TE reference sequence from the public databank, the <italic>de novo</italic> consensus sequence and the genomic copies identified with this sequence (see <xref ref-type="fig" rid="pone-0016526-g004">Figure 4 A–D</xref>). For the identification of TE families represented by several <italic>de novo</italic> consensus sequences, we clustered <italic>de novo</italic> consensus sequences with BLASTCLUST from the NCBI-BLAST suite (<xref rid="pone.0016526-Dondoshansky1" ref-type="bibr">[63]</xref>, parameters “-S 0 -L 0.8 -b F -p F”). We then added the best TE reference sequence corresponding to each cluster, and finally built a multiple alignment. The addition of the reference sequence after clustering prevents the <italic>de novo</italic> consensus sequences from being clustered together solely because they overlap with the same reference sequence. This procedure can therefore be used to assist manual curation for newly sequenced genomes without known reference sequences. Multiple alignments were checked by eye, using Jalview <xref rid="pone.0016526-Waterhouse1" ref-type="bibr">[64]</xref>.</p>
    </sec>
  </sec>
  <sec sec-type="supplementary-material" id="s5">
    <title>Supporting Information</title>
    <supplementary-material content-type="local-data" id="pone.0016526.s001">
      <label>Figure S1</label>
      <caption>
        <p>
          <bold>Flow chart of the three first steps of the TEdenovo pipeline.</bold>
        </p>
        <p>(TIF)</p>
      </caption>
      <media xlink:href="pone.0016526.s001.tif">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pone.0016526.s002">
      <label>Figure S2</label>
      <caption>
        <p>
          <bold>Flow chart of the TEannot pipeline.</bold>
        </p>
        <p>(TIF)</p>
      </caption>
      <media xlink:href="pone.0016526.s002.tif">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pone.0016526.s003">
      <label>Figure S3</label>
      <caption>
        <p>
          <bold>Comparison of two TE annotations in terms of match boundaries.</bold>
        </p>
        <p>(TIF)</p>
      </caption>
      <media xlink:href="pone.0016526.s003.tif">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pone.0016526.s004">
      <label>Table S1</label>
      <caption>
        <p>
          <bold>Comparative analysis of self-alignment programs.</bold>
        </p>
        <p>(PDF)</p>
      </caption>
      <media xlink:href="pone.0016526.s004.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pone.0016526.s005">
      <label>Table S2</label>
      <caption>
        <p>
          <bold>Comparative analysis of clustering programs.</bold>
        </p>
        <p>(PDF)</p>
      </caption>
      <media xlink:href="pone.0016526.s005.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pone.0016526.s006">
      <label>Table S3</label>
      <caption>
        <p>
          <bold>Comparative analysis of multiple alignment programs.</bold>
        </p>
        <p>(PDF)</p>
      </caption>
      <media xlink:href="pone.0016526.s006.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pone.0016526.s007">
      <label>Table S4</label>
      <caption>
        <p>
          <bold>Results of the RepeatScout program.</bold>
        </p>
        <p>(PDF)</p>
      </caption>
      <media xlink:href="pone.0016526.s007.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pone.0016526.s008">
      <label>Table S5</label>
      <caption>
        <p>
          <bold>Results obtained with a combination of several clustering programs in the de novo approach.</bold>
        </p>
        <p>(PDF)</p>
      </caption>
      <media xlink:href="pone.0016526.s008.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pone.0016526.s009">
      <label>Table S6</label>
      <caption>
        <p>
          <bold>Length parameters used in the TEclassifier program.</bold>
        </p>
        <p>(PDF)</p>
      </caption>
      <media xlink:href="pone.0016526.s009.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pone.0016526.s010">
      <label>Table S7</label>
      <caption>
        <p>
          <bold>Results of the classification of TE sequences from A. thaliana.</bold>
        </p>
        <p>(PDF)</p>
      </caption>
      <media xlink:href="pone.0016526.s010.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pone.0016526.s011">
      <label>Table S8</label>
      <caption>
        <p>
          <bold>Consensus sequences matching known genes of D. melanogaster.</bold>
        </p>
        <p>(PDF)</p>
      </caption>
      <media xlink:href="pone.0016526.s011.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pone.0016526.s012">
      <label>Table S9</label>
      <caption>
        <p>
          <bold>Parameters of the tests for redundancy elimination in TEclassifier.</bold>
        </p>
        <p>(PDF)</p>
      </caption>
      <media xlink:href="pone.0016526.s012.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pone.0016526.s013">
      <label>Table S10</label>
      <caption>
        <p>
          <bold>Results of coordinate comparisons for TE annotation.</bold>
        </p>
        <p>(PDF)</p>
      </caption>
      <media xlink:href="pone.0016526.s013.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pone.0016526.s014">
      <label>Table S11</label>
      <caption>
        <p>
          <bold>Comparison of the performances of the RepeatModeler and TEdenovo databanks.</bold>
        </p>
        <p>(PDF)</p>
      </caption>
      <media xlink:href="pone.0016526.s014.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pone.0016526.s015">
      <label>Table S12</label>
      <caption>
        <p>
          <bold>Comparison of the performances of TE annotation with the databanks of de novo consensus sequences from RepeatModeler and TEdenovo.</bold>
        </p>
        <p>(PDF)</p>
      </caption>
      <media xlink:href="pone.0016526.s015.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pone.0016526.s016">
      <label>Table S13</label>
      <caption>
        <p>
          <bold>Computation times of the TEdenovo/TEannot pipelines and RepeatScout on the D. melanogaster and A. thaliana genomes.</bold>
        </p>
        <p>(PDF)</p>
      </caption>
      <media xlink:href="pone.0016526.s016.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pone.0016526.s017">
      <label>Table S14</label>
      <caption>
        <p>
          <bold>Reference sequences entirely retrieved by one clustering method but not by the others, in the D. melanogaster genome.</bold>
        </p>
        <p>(PDF)</p>
      </caption>
      <media xlink:href="pone.0016526.s017.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pone.0016526.s018">
      <label>Table S15</label>
      <caption>
        <p>
          <bold>Reference sequences entirely retrieved by one clustering method but not by the others, in the A. thaliana genome.</bold>
        </p>
        <p>(PDF)</p>
      </caption>
      <media xlink:href="pone.0016526.s018.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pone.0016526.s019">
      <label>Table S16</label>
      <caption>
        <p>
          <bold>List of TE families represented by several de novo consensus sequences.</bold>
        </p>
        <p>(PDF)</p>
      </caption>
      <media xlink:href="pone.0016526.s019.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pone.0016526.s020">
      <label>Table S17</label>
      <caption>
        <p>
          <bold>TE reference sequences for which no “knowledge-based” consensus could be built.</bold>
        </p>
        <p>(PDF)</p>
      </caption>
      <media xlink:href="pone.0016526.s020.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pone.0016526.s021">
      <label>Table S18</label>
      <caption>
        <p>
          <bold>Comparison of “knowledge-based” libraries with reference databanks.</bold>
        </p>
        <p>(PDF)</p>
      </caption>
      <media xlink:href="pone.0016526.s021.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <ack>
    <p>We wish to thank Emmanuelle Permal, Joëlle Amselem and Victoria Dominguez for helpful comments on the <italic>de novo</italic> approach, Olivier Inizan for his work on the REPET package, Claire Hoede for her help with the TE HMM profiles, and Isabelle Luyten and Sébastien Reboux for their help with the computer infrastructure required for such an analysis. We also thank the GenOuest platform for allowing us to run our analyses on their computer cluster.</p>
  </ack>
  <fn-group>
    <fn fn-type="COI-statement">
      <p><bold>Competing Interests: </bold>The authors have declared that no competing interests exist.</p>
    </fn>
    <fn fn-type="financial-disclosure">
      <p><bold>Funding: </bold>Timothée Flutre was funded by the Institut National de la Recherche Agronomique (INRA) (ASC), Elodie Duprat held a fellowship from the Université Pierre et Marie Curie (UPMC) (ATER) and this work was funded by a grant from the Agence Nationale de la Recherche (ANR-05-MMSA-0010) to Hadi Quesneville. The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.</p>
    </fn>
  </fn-group>
  <ref-list>
    <title>References</title>
    <ref id="pone.0016526-Orgel1">
      <label>1</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Orgel</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Crick</surname>
            <given-names>F</given-names>
          </name>
        </person-group>
        <year>1980</year>
        <article-title>Selfish DNA: the ultimate parasite.</article-title>
        <source>Nature</source>
        <volume>284</volume>
        <fpage>604</fpage>
        <lpage>607</lpage>
        <pub-id pub-id-type="pmid">7366731</pub-id>
      </element-citation>
    </ref>
    <ref id="pone.0016526-Brookfield1">
      <label>2</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Brookfield</surname>
            <given-names>JFY</given-names>
          </name>
        </person-group>
        <year>2005</year>
        <article-title>The ecology of the genome - mobile DNA elements and their hosts.</article-title>
        <source>Nature Reviews Genetics</source>
        <volume>6</volume>
        <fpage>128</fpage>
        <lpage>136</lpage>
      </element-citation>
    </ref>
    <ref id="pone.0016526-Lynch1">
      <label>3</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lynch</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Conery</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <year>2003</year>
        <article-title>The origins of genome complexity.</article-title>
        <source>Science</source>
        <volume>302</volume>
        <fpage>1401</fpage>
        <lpage>1404</lpage>
        <pub-id pub-id-type="pmid">14631042</pub-id>
      </element-citation>
    </ref>
    <ref id="pone.0016526-Finnegan1">
      <label>4</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Finnegan</surname>
            <given-names>D</given-names>
          </name>
        </person-group>
        <year>1989</year>
        <article-title>Eukaryotic transposable elements and genome evolution.</article-title>
        <source>Trends in Genetics</source>
        <volume>5</volume>
        <fpage>103</fpage>
        <lpage>107</lpage>
        <pub-id pub-id-type="pmid">2543105</pub-id>
      </element-citation>
    </ref>
    <ref id="pone.0016526-Wicker1">
      <label>5</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wicker</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Sabot</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Hua-Van</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Bennetzen</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Capy</surname>
            <given-names>P</given-names>
          </name>
          <etal/>
        </person-group>
        <year>2007</year>
        <article-title>A unified classification system for eukaryotic transposable elements.</article-title>
        <source>Nature Reviews Genetics</source>
        <volume>8</volume>
        <fpage>973</fpage>
        <lpage>982</lpage>
      </element-citation>
    </ref>
    <ref id="pone.0016526-Wessler1">
      <label>6</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wessler</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <year>1995</year>
        <article-title>LTR-retrotransposons and MITEs: important players in the evolution of plant genomes.</article-title>
        <source>Current Opinion in Genetics and Development</source>
        <volume>5</volume>
        <fpage>814</fpage>
        <lpage>821</lpage>
        <pub-id pub-id-type="pmid">8745082</pub-id>
      </element-citation>
    </ref>
    <ref id="pone.0016526-Yang1">
      <label>7</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Yang</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Nagel</surname>
            <given-names>DH</given-names>
          </name>
          <name>
            <surname>Feschotte</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Hancock</surname>
            <given-names>CN</given-names>
          </name>
          <name>
            <surname>Wessler</surname>
            <given-names>SR</given-names>
          </name>
        </person-group>
        <year>2009</year>
        <article-title>Tuned for transposition: molecular determinants underlying the hyperactivity of a Stowaway MITE.</article-title>
        <source>Science</source>
        <volume>325</volume>
        <fpage>1391</fpage>
        <lpage>1394</lpage>
        <pub-id pub-id-type="pmid">19745152</pub-id>
      </element-citation>
    </ref>
    <ref id="pone.0016526-Gray1">
      <label>8</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Gray</surname>
            <given-names>Y</given-names>
          </name>
        </person-group>
        <year>2000</year>
        <article-title>It takes two transposons to tango: transposable-element-mediated chromosomal rearrangements.</article-title>
        <source>Trends in Genetics</source>
        <volume>16</volume>
        <fpage>461</fpage>
        <lpage>468</lpage>
        <pub-id pub-id-type="pmid">11050333</pub-id>
      </element-citation>
    </ref>
    <ref id="pone.0016526-Eichler1">
      <label>9</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Eichler</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Sankoff</surname>
            <given-names>D</given-names>
          </name>
        </person-group>
        <year>2003</year>
        <article-title>Structural dynamics of eukaryotic chromosome evolution.</article-title>
        <source>Science</source>
        <volume>301</volume>
        <fpage>793</fpage>
        <lpage>797</lpage>
        <pub-id pub-id-type="pmid">12907789</pub-id>
      </element-citation>
    </ref>
    <ref id="pone.0016526-Coghlan1">
      <label>10</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Coghlan</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Eichler</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Oliver</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Paterson</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Stein</surname>
            <given-names>L</given-names>
          </name>
        </person-group>
        <year>2005</year>
        <article-title>Chromosome evolution in eukaryotes: a multi-kingdom perspective.</article-title>
        <source>Trends in Genetics</source>
        <volume>21</volume>
        <fpage>673</fpage>
        <lpage>682</lpage>
        <pub-id pub-id-type="pmid">16242204</pub-id>
      </element-citation>
    </ref>
    <ref id="pone.0016526-Paux1">
      <label>11</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Paux</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Sourdille</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Salse</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Saintenac</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Choulet</surname>
            <given-names>F</given-names>
          </name>
          <etal/>
        </person-group>
        <year>2008</year>
        <article-title>A Physical Map of the 1-Gigabase Bread Wheat Chromosome 3B.</article-title>
        <source>Science</source>
        <volume>322</volume>
        <fpage>101</fpage>
        <lpage>104</lpage>
        <pub-id pub-id-type="pmid">18832645</pub-id>
      </element-citation>
    </ref>
    <ref id="pone.0016526-McClintock1">
      <label>12</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>McClintock</surname>
            <given-names>B</given-names>
          </name>
        </person-group>
        <year>1956</year>
        <article-title>Controlling elements and the gene.</article-title>
        <source>Cold Spring Harbor Symposia on Quantitative Biology</source>
        <volume>21</volume>
        <fpage>197</fpage>
        <lpage>216</lpage>
        <pub-id pub-id-type="pmid">13433592</pub-id>
      </element-citation>
    </ref>
    <ref id="pone.0016526-Slotkin1">
      <label>13</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Slotkin</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Martienssen</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <year>2007</year>
        <article-title>Transposable elements and the epigenetic regulation of the genome.</article-title>
        <source>Nature Reviews Genetics</source>
        <volume>8</volume>
        <fpage>272</fpage>
        <lpage>285</lpage>
      </element-citation>
    </ref>
    <ref id="pone.0016526-Martin1">
      <label>14</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Martin</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Troadec</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Boualem</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Rajab</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Fernandez</surname>
            <given-names>R</given-names>
          </name>
          <etal/>
        </person-group>
        <year>2009</year>
        <article-title>A transposon-induced epigenetic change leads to sex determination in melon.</article-title>
        <source>Nature</source>
        <volume>461</volume>
        <fpage>1135</fpage>
        <lpage>1138</lpage>
        <pub-id pub-id-type="pmid">19847267</pub-id>
      </element-citation>
    </ref>
    <ref id="pone.0016526-Feschotte1">
      <label>15</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Feschotte</surname>
            <given-names>C</given-names>
          </name>
        </person-group>
        <year>2008</year>
        <article-title>Transposable elements and the evolution of regulatory networks.</article-title>
        <source>Nature Reviews Genetics</source>
        <volume>9</volume>
        <fpage>397</fpage>
        <lpage>405</lpage>
      </element-citation>
    </ref>
    <ref id="pone.0016526-Herpin1">
      <label>16</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Herpin</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Braasch</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Kraeussling</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Schmidt</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Thoma</surname>
            <given-names>E</given-names>
          </name>
          <etal/>
        </person-group>
        <year>2010</year>
        <article-title>Transcriptional rewiring of the sex determining dmrt1 gene duplicate by transposable elements.</article-title>
        <source>PLoS Genetics</source>
        <volume>6</volume>
        <fpage>e1000844+</fpage>
        <pub-id pub-id-type="pmid">20169179</pub-id>
      </element-citation>
    </ref>
    <ref id="pone.0016526-Cordaux1">
      <label>17</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Cordaux</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Udit</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Batzer</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Feschotte</surname>
            <given-names>C</given-names>
          </name>
        </person-group>
        <year>2006</year>
        <article-title>Birth of a chimeric primate gene by capture of the transposase gene from a mobile element.</article-title>
        <source>Proceedings of the National Academy of Sciences</source>
        <volume>103</volume>
        <fpage>8101</fpage>
        <lpage>8106</lpage>
      </element-citation>
    </ref>
    <ref id="pone.0016526-Santangelo1">
      <label>18</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Santangelo</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>de Souza</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Franchini</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Bumaschny</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Low</surname>
            <given-names>M</given-names>
          </name>
          <etal/>
        </person-group>
        <year>2007</year>
        <article-title>Ancient exaptation of a CORE-SINE retroposon into a highly conserved mammalian neuronal enhancer of the proopiomelanocortin gene.</article-title>
        <source>PLoS Genetics</source>
        <volume>3</volume>
      </element-citation>
    </ref>
    <ref id="pone.0016526-Agrawal1">
      <label>19</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Agrawal</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Eastman</surname>
            <given-names>QM</given-names>
          </name>
          <name>
            <surname>Schatz</surname>
            <given-names>DG</given-names>
          </name>
        </person-group>
        <year>1998</year>
        <article-title>Transposition mediated by RAG1 and RAG2 and its implications for the evolution of the immune system.</article-title>
        <source>Nature</source>
        <volume>394</volume>
        <fpage>744</fpage>
        <lpage>751</lpage>
        <pub-id pub-id-type="pmid">9723614</pub-id>
      </element-citation>
    </ref>
    <ref id="pone.0016526-Zhou1">
      <label>20</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zhou</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Mitra</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Atkinson</surname>
            <given-names>PW</given-names>
          </name>
          <name>
            <surname>Burgess Hickman</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Dyda</surname>
            <given-names>F</given-names>
          </name>
          <etal/>
        </person-group>
        <year>2004</year>
        <article-title>Transposition of hAT elements links transposable elements and V(D)J recombination.</article-title>
        <source>Nature</source>
        <volume>432</volume>
        <fpage>995</fpage>
        <lpage>1001</lpage>
        <pub-id pub-id-type="pmid">15616554</pub-id>
      </element-citation>
    </ref>
    <ref id="pone.0016526-Schuster1">
      <label>21</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Schuster</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <year>2008</year>
        <article-title>Next-generation sequencing transforms today's biology.</article-title>
        <source>Nature Methods</source>
        <volume>5</volume>
        <fpage>16</fpage>
        <lpage>18</lpage>
        <pub-id pub-id-type="pmid">18165802</pub-id>
      </element-citation>
    </ref>
    <ref id="pone.0016526-Schnable1">
      <label>22</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Schnable</surname>
            <given-names>PS</given-names>
          </name>
          <name>
            <surname>Ware</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Fulton</surname>
            <given-names>RS</given-names>
          </name>
          <name>
            <surname>Stein</surname>
            <given-names>JC</given-names>
          </name>
          <name>
            <surname>Wei</surname>
            <given-names>F</given-names>
          </name>
          <etal/>
        </person-group>
        <year>2009</year>
        <article-title>The B73 maize genome: complexity, diversity, and dynamics.</article-title>
        <source>Science</source>
        <volume>326</volume>
        <fpage>1112</fpage>
        <lpage>1115</lpage>
        <pub-id pub-id-type="pmid">19965430</pub-id>
      </element-citation>
    </ref>
    <ref id="pone.0016526-Bourque1">
      <label>23</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bourque</surname>
            <given-names>G</given-names>
          </name>
        </person-group>
        <year>2009</year>
        <article-title>Transposable elements in gene regulation and in the evolution of vertebrate genomes.</article-title>
        <source>Current Opinion in Genetics and Development</source>
        <volume>19</volume>
        <fpage>607</fpage>
        <lpage>612</lpage>
        <pub-id pub-id-type="pmid">19914058</pub-id>
      </element-citation>
    </ref>
    <ref id="pone.0016526-Quesneville1">
      <label>24</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Quesneville</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Bergman</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Andrieu</surname>
            <given-names>O</given-names>
          </name>
          <name>
            <surname>Autard</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Nouaud</surname>
            <given-names>D</given-names>
          </name>
          <etal/>
        </person-group>
        <year>2005</year>
        <article-title>Combined evidence annotation of transposable elements in genome sequences.</article-title>
        <source>PLoS Computational Biology</source>
        <volume>1</volume>
        <fpage>166</fpage>
        <lpage>175</lpage>
        <pub-id pub-id-type="pmid">16110336</pub-id>
      </element-citation>
    </ref>
    <ref id="pone.0016526-Bergman1">
      <label>25</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bergman</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Quesneville</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Anxolabehere</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Ashburner</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <year>2006</year>
        <article-title>Recurrent insertion and duplication generate networks of transposable element sequences in the Drosophila melanogaster genome.</article-title>
        <source>Genome Biology</source>
        <volume>7</volume>
        <fpage>R112+</fpage>
        <pub-id pub-id-type="pmid">17134480</pub-id>
      </element-citation>
    </ref>
    <ref id="pone.0016526-Nene1">
      <label>26</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Nene</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Wortman</surname>
            <given-names>JR</given-names>
          </name>
          <name>
            <surname>Lawson</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Haas</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Kodira</surname>
            <given-names>C</given-names>
          </name>
          <etal/>
        </person-group>
        <year>2007</year>
        <article-title>Genome sequence of Aedes aegypti, a major Arbovirus vector.</article-title>
        <source>Science</source>
        <volume>316</volume>
        <fpage>1718</fpage>
        <lpage>1723</lpage>
        <pub-id pub-id-type="pmid">17510324</pub-id>
      </element-citation>
    </ref>
    <ref id="pone.0016526-Cuomo1">
      <label>27</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Cuomo</surname>
            <given-names>CA</given-names>
          </name>
          <name>
            <surname>Guldener</surname>
            <given-names>U</given-names>
          </name>
          <name>
            <surname>Xu</surname>
            <given-names>JR</given-names>
          </name>
          <name>
            <surname>Trail</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Turgeon</surname>
            <given-names>BG</given-names>
          </name>
          <etal/>
        </person-group>
        <year>2007</year>
        <article-title>The Fusarium graminearum genome reveals a link between localized polymorphism and pathogen specialization.</article-title>
        <source>Science</source>
        <volume>317</volume>
        <fpage>1400</fpage>
        <lpage>1402</lpage>
        <pub-id pub-id-type="pmid">17823352</pub-id>
      </element-citation>
    </ref>
    <ref id="pone.0016526-The1">
      <label>28</label>
      <element-citation publication-type="journal">
        <collab>The 12 Drosophila Genomes Consortium</collab>
        <year>2007</year>
        <article-title>Evolution of genes and genomes on the Drosophila phylogeny.</article-title>
        <source>Nature</source>
        <volume>450</volume>
        <fpage>203</fpage>
        <lpage>218</lpage>
        <pub-id pub-id-type="pmid">17994087</pub-id>
      </element-citation>
    </ref>
    <ref id="pone.0016526-Buisine1">
      <label>29</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Buisine</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Quesneville</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Colot</surname>
            <given-names>V</given-names>
          </name>
        </person-group>
        <year>2008</year>
        <article-title>Improved detection and annotation of transposable elements in sequenced genomes using multiple reference sequence sets.</article-title>
        <source>Genomics</source>
        <volume>91</volume>
        <fpage>467</fpage>
        <lpage>475</lpage>
        <pub-id pub-id-type="pmid">18343092</pub-id>
      </element-citation>
    </ref>
    <ref id="pone.0016526-Abad1">
      <label>30</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Abad</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Gouzy</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Aury</surname>
            <given-names>JM</given-names>
          </name>
          <name>
            <surname>Castagnone-Sereno</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Danchin</surname>
            <given-names>EGJG</given-names>
          </name>
          <etal/>
        </person-group>
        <year>2008</year>
        <article-title>Genome sequence of the metazoan plant-parasitic nematode Meloidogyne incognita.</article-title>
        <source>Nature Biotechnology</source>
        <fpage>909</fpage>
        <lpage>915</lpage>
      </element-citation>
    </ref>
    <ref id="pone.0016526-The2">
      <label>31</label>
      <element-citation publication-type="journal">
        <collab>The International Aphid Genomics Consortium</collab>
        <year>2010</year>
        <article-title>Genome sequence of the pea aphid Acyrthosiphon pisum.</article-title>
        <source>PLoS Biology</source>
        <volume>8</volume>
        <fpage>e1000313+</fpage>
        <pub-id pub-id-type="pmid">20186266</pub-id>
      </element-citation>
    </ref>
    <ref id="pone.0016526-Saha1">
      <label>32</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Saha</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Bridges</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Magbanua</surname>
            <given-names>ZV</given-names>
          </name>
          <name>
            <surname>Peterson</surname>
            <given-names>DG</given-names>
          </name>
        </person-group>
        <year>2008</year>
        <article-title>Empirical comparison of ab initio repeat finding programs.</article-title>
        <source>Nucl Acids Res</source>
        <volume>36</volume>
        <fpage>2284</fpage>
        <lpage>2294</lpage>
        <pub-id pub-id-type="pmid">18287116</pub-id>
      </element-citation>
    </ref>
    <ref id="pone.0016526-Jiang1">
      <label>33</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Jiang</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Jordan</surname>
            <given-names>IK</given-names>
          </name>
          <name>
            <surname>Wessler</surname>
            <given-names>SR</given-names>
          </name>
        </person-group>
        <year>2002</year>
        <article-title>Dasheng and RIRE2. A nonautonomous Long Terminal Repeat element and its putative autonomous partner in the rice genome.</article-title>
        <source>Plant Physiol</source>
        <volume>130</volume>
        <fpage>1697</fpage>
        <lpage>1705</lpage>
        <pub-id pub-id-type="pmid">12481052</pub-id>
      </element-citation>
    </ref>
    <ref id="pone.0016526-Quesneville2">
      <label>34</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Quesneville</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Nouaud</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Anxolabehere</surname>
            <given-names>D</given-names>
          </name>
        </person-group>
        <year>2006</year>
        <article-title>P elements and MITE relatives in the whole genome sequence of Anopheles gambiae.</article-title>
        <source>BMC genomics</source>
        <volume>7</volume>
        <fpage>214+</fpage>
        <pub-id pub-id-type="pmid">16919158</pub-id>
      </element-citation>
    </ref>
    <ref id="pone.0016526-Bergman2">
      <label>35</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bergman</surname>
            <given-names>CMM</given-names>
          </name>
          <name>
            <surname>Quesneville</surname>
            <given-names>H</given-names>
          </name>
        </person-group>
        <year>2007</year>
        <article-title>Discovering and detecting transposable elements in genome sequences.</article-title>
        <source>Briefings in Bioinformatics</source>
        <volume>8</volume>
        <fpage>382</fpage>
        <lpage>392</lpage>
        <pub-id pub-id-type="pmid">17932080</pub-id>
      </element-citation>
    </ref>
    <ref id="pone.0016526-Quesneville3">
      <label>36</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Quesneville</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Nouaud</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Anxolabehere</surname>
            <given-names>D</given-names>
          </name>
        </person-group>
        <year>2003</year>
        <article-title>Detection of new transposable element families in Drosophila melanogaster and Anopheles gambiae genomes.</article-title>
        <source>Journal of Molecular Evolution</source>
        <volume>57</volume>
      </element-citation>
    </ref>
    <ref id="pone.0016526-Altschul1">
      <label>37</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Altschul</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Gish</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Miller</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Myers</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Lipman</surname>
            <given-names>D</given-names>
          </name>
        </person-group>
        <year>1990</year>
        <article-title>Basic local alignment search tool.</article-title>
        <source>Journal of Molecular Biology</source>
        <volume>215</volume>
        <fpage>403</fpage>
        <lpage>410</lpage>
        <pub-id pub-id-type="pmid">2231712</pub-id>
      </element-citation>
    </ref>
    <ref id="pone.0016526-Rasmussen1">
      <label>38</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Rasmussen</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Stoye</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Myers</surname>
            <given-names>E</given-names>
          </name>
        </person-group>
        <year>2006</year>
        <article-title>Efficient q-gram filters for finding all epsilon-matches over a given length.</article-title>
        <source>Journal of Computational Biology</source>
        <volume>13</volume>
        <fpage>296</fpage>
        <lpage>308</lpage>
        <pub-id pub-id-type="pmid">16597241</pub-id>
      </element-citation>
    </ref>
    <ref id="pone.0016526-Bao1">
      <label>39</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bao</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Eddy</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <year>2002</year>
        <article-title>Automated de novo identification of repeat sequence families in sequenced genomes.</article-title>
        <source>Genome Research</source>
        <volume>12</volume>
        <fpage>1269</fpage>
        <lpage>1276</lpage>
        <pub-id pub-id-type="pmid">12176934</pub-id>
      </element-citation>
    </ref>
    <ref id="pone.0016526-Edgar1">
      <label>40</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Edgar</surname>
            <given-names>RC</given-names>
          </name>
          <name>
            <surname>Myers</surname>
            <given-names>EW</given-names>
          </name>
        </person-group>
        <year>2005</year>
        <article-title>PILER: identification and classification of genomic repeats.</article-title>
        <source>Bioinformatics</source>
        <volume>21</volume>
        <fpage>i152</fpage>
        <lpage>158</lpage>
        <pub-id pub-id-type="pmid">15961452</pub-id>
      </element-citation>
    </ref>
    <ref id="pone.0016526-Notredame1">
      <label>41</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Notredame</surname>
            <given-names>C</given-names>
          </name>
        </person-group>
        <year>2007</year>
        <article-title>Recent evolutions of multiple sequence alignment algorithms.</article-title>
        <source>PLoS Computational Biology</source>
        <volume>3</volume>
        <fpage>e123+</fpage>
        <pub-id pub-id-type="pmid">17784778</pub-id>
      </element-citation>
    </ref>
    <ref id="pone.0016526-Huang1">
      <label>42</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Huang</surname>
            <given-names>X</given-names>
          </name>
        </person-group>
        <year>1994</year>
        <article-title>On global sequence alignment.</article-title>
        <source>Computer Applications in the Biosciences</source>
        <volume>10</volume>
        <fpage>227</fpage>
        <lpage>235</lpage>
        <pub-id pub-id-type="pmid">7922677</pub-id>
      </element-citation>
    </ref>
    <ref id="pone.0016526-Thompson1">
      <label>43</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Thompson</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Higgins</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Gibson</surname>
            <given-names>T</given-names>
          </name>
        </person-group>
        <year>1994</year>
        <article-title>CLUSTAL W: improving the sensitivity of progressive multiple sequence alignment through sequence weighting, position-specific gap penalties and weight matrix choice.</article-title>
        <source>Nucleic Acids Research</source>
        <volume>22</volume>
        <fpage>4673</fpage>
        <lpage>4680</lpage>
        <pub-id pub-id-type="pmid">7984417</pub-id>
      </element-citation>
    </ref>
    <ref id="pone.0016526-Katoh1">
      <label>44</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Katoh</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Toh</surname>
            <given-names>H</given-names>
          </name>
        </person-group>
        <year>2008</year>
        <article-title>Recent developments in the MAFFT multiple sequence alignment program.</article-title>
        <source>Briefings in Bioinformatics</source>
        <volume>9</volume>
        <fpage>286</fpage>
        <lpage>298</lpage>
        <pub-id pub-id-type="pmid">18372315</pub-id>
      </element-citation>
    </ref>
    <ref id="pone.0016526-Loytynoja1">
      <label>45</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Loytynoja</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Goldman</surname>
            <given-names>N</given-names>
          </name>
        </person-group>
        <year>2005</year>
        <article-title>An algorithm for progressive multiple alignment of sequences with insertions.</article-title>
        <source>Proceedings of the National Academy of Sciences</source>
        <volume>102</volume>
        <fpage>10557</fpage>
        <lpage>10562</lpage>
      </element-citation>
    </ref>
    <ref id="pone.0016526-Price1">
      <label>46</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Price</surname>
            <given-names>AL</given-names>
          </name>
          <name>
            <surname>Jones</surname>
            <given-names>NC</given-names>
          </name>
          <name>
            <surname>Pevzner</surname>
            <given-names>PA</given-names>
          </name>
        </person-group>
        <year>2005</year>
        <article-title>De novo identification of repeat families in large genomes.</article-title>
        <source>Bioinformatics</source>
        <volume>21</volume>
        <fpage>i351</fpage>
        <lpage>358</lpage>
        <pub-id pub-id-type="pmid">15961478</pub-id>
      </element-citation>
    </ref>
    <ref id="pone.0016526-Mayr1">
      <label>47</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Mayr</surname>
            <given-names>E</given-names>
          </name>
        </person-group>
        <year>1981</year>
        <article-title>Biological classification: toward a synthesis of opposing methodologies.</article-title>
        <source>Science</source>
        <volume>214</volume>
        <fpage>510</fpage>
        <lpage>516</lpage>
        <pub-id pub-id-type="pmid">17838387</pub-id>
      </element-citation>
    </ref>
    <ref id="pone.0016526-Jurka1">
      <label>48</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Jurka</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Kapitonov</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Pavlicek</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Klonowski</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Kohany</surname>
            <given-names>O</given-names>
          </name>
          <etal/>
        </person-group>
        <year>2005</year>
        <article-title>Repbase Update, a database of eukaryotic repetitive elements.</article-title>
        <source>Cytogenetic and Genome Research</source>
        <volume>110</volume>
        <fpage>462</fpage>
        <lpage>467</lpage>
        <pub-id pub-id-type="pmid">16093699</pub-id>
      </element-citation>
    </ref>
    <ref id="pone.0016526-Tempel1">
      <label>49</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Tempel</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Nicolas</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>El Amrani</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Couée</surname>
            <given-names>I</given-names>
          </name>
        </person-group>
        <year>2007</year>
        <article-title>Model-based identification of Helitrons results in a new classification of their families in Arabidopsis thaliana.</article-title>
        <source>Gene</source>
        <volume>403</volume>
        <fpage>18</fpage>
        <lpage>28</lpage>
        <pub-id pub-id-type="pmid">17889452</pub-id>
      </element-citation>
    </ref>
    <ref id="pone.0016526-Kurtz1">
      <label>50</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kurtz</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Narechania</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Stein</surname>
            <given-names>JC</given-names>
          </name>
          <name>
            <surname>Ware</surname>
            <given-names>D</given-names>
          </name>
        </person-group>
        <year>2008</year>
        <article-title>A new method to compute K-mer frequencies and its application to annotate large repetitive plant genomes.</article-title>
        <source>BMC Genomics</source>
        <volume>9</volume>
        <fpage>517+</fpage>
        <pub-id pub-id-type="pmid">18976482</pub-id>
      </element-citation>
    </ref>
    <ref id="pone.0016526-Gu1">
      <label>51</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Gu</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Castoe</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Hedges</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Batzer</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Pollock</surname>
            <given-names>D</given-names>
          </name>
        </person-group>
        <year>2008</year>
        <article-title>Identification of repeat structure in large genomes using repeat probability clouds.</article-title>
        <source>Analytical Biochemistry</source>
        <volume>380</volume>
        <fpage>77</fpage>
        <lpage>83</lpage>
        <pub-id pub-id-type="pmid">18541131</pub-id>
      </element-citation>
    </ref>
    <ref id="pone.0016526-Newman1">
      <label>52</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Newman</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Bailey</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Fan</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Pavelitz</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Weiner</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <year>2008</year>
        <article-title>An abundant evolutionarily conserved CSB-PiggyBac fusion protein expressed in Cockayne syndrome.</article-title>
        <source>PLoS Genetics</source>
        <volume>4</volume>
        <issue>3</issue>
        <fpage>e1000031</fpage>
        <pub-id pub-id-type="pmid">18369450</pub-id>
      </element-citation>
    </ref>
    <ref id="pone.0016526-Teixeira1">
      <label>53</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Teixeira</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Heredia</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Sarazin</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Roudier</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Boccara</surname>
            <given-names>M</given-names>
          </name>
          <etal/>
        </person-group>
        <year>2009</year>
        <article-title>A role for RNAi in the selective correction of DNA methylation defects.</article-title>
        <source>Science</source>
        <volume>323</volume>
        <fpage>1600</fpage>
        <lpage>1604</lpage>
        <pub-id pub-id-type="pmid">19179494</pub-id>
      </element-citation>
    </ref>
    <ref id="pone.0016526-Abrusan1">
      <label>54</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Abrusan</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Grundmann</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>DeMester</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Makalowski</surname>
            <given-names>W</given-names>
          </name>
        </person-group>
        <year>2009</year>
        <article-title>TEclass–a tool for automated classification of unknown eukaryotic transposable elements.</article-title>
        <source>Bioinformatics</source>
        <volume>25</volume>
        <fpage>1329</fpage>
        <lpage>1330</lpage>
        <pub-id pub-id-type="pmid">19349283</pub-id>
      </element-citation>
    </ref>
    <ref id="pone.0016526-Feschotte2">
      <label>55</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Feschotte</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Keswani</surname>
            <given-names>U</given-names>
          </name>
          <name>
            <surname>Ranganathan</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Guibotsy</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Levine</surname>
            <given-names>D</given-names>
          </name>
        </person-group>
        <year>2010</year>
        <article-title>Exploring repetitive DNA landscapes using REPCLASS, a tool that automates the classification of transposable elements in eukaryotic genomes.</article-title>
        <source>Genome Biol Evol</source>
        <volume>2009</volume>
        <fpage>205</fpage>
        <lpage>220</lpage>
      </element-citation>
    </ref>
    <ref id="pone.0016526-Brent1">
      <label>56</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Brent</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <year>2008</year>
        <article-title>Steady progress and recent breakthroughs in the accuracy of automated genome annotation.</article-title>
        <source>Nature Reviews Genetics</source>
        <volume>9</volume>
        <fpage>62</fpage>
        <lpage>73</lpage>
      </element-citation>
    </ref>
    <ref id="pone.0016526-Adams1">
      <label>57</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Adams</surname>
            <given-names>MD</given-names>
          </name>
          <name>
            <surname>Celniker</surname>
            <given-names>SE</given-names>
          </name>
          <name>
            <surname>Holt</surname>
            <given-names>RA</given-names>
          </name>
          <name>
            <surname>Evans</surname>
            <given-names>CA</given-names>
          </name>
          <name>
            <surname>Gocayne</surname>
            <given-names>JD</given-names>
          </name>
          <etal/>
        </person-group>
        <year>2000</year>
        <article-title>The genome sequence of Drosophila melanogaster.</article-title>
        <source>Science</source>
        <volume>287</volume>
        <fpage>2185</fpage>
        <lpage>2195</lpage>
        <pub-id pub-id-type="pmid">10731132</pub-id>
      </element-citation>
    </ref>
    <ref id="pone.0016526-The3">
      <label>58</label>
      <element-citation publication-type="journal">
        <collab>The Arabidopsis Genome Initiative</collab>
        <year>2000</year>
        <article-title>Analysis of the genome sequence of the flowering plant Arabidopsis thaliana.</article-title>
        <source>Nature</source>
        <volume>408</volume>
        <fpage>796</fpage>
        <lpage>815</lpage>
        <pub-id pub-id-type="pmid">11130711</pub-id>
      </element-citation>
    </ref>
    <ref id="pone.0016526-Benson1">
      <label>59</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Benson</surname>
            <given-names>G</given-names>
          </name>
        </person-group>
        <year>1999</year>
        <article-title>Tandem repeats finder: a program to analyze DNA sequences.</article-title>
        <source>Nucleic Acids Research</source>
        <volume>27</volume>
        <fpage>573</fpage>
        <lpage>580</lpage>
        <pub-id pub-id-type="pmid">9862982</pub-id>
      </element-citation>
    </ref>
    <ref id="pone.0016526-Jurka2">
      <label>60</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Jurka</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Klonowski</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Dagman</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Pelton</surname>
            <given-names>P</given-names>
          </name>
        </person-group>
        <year>1996</year>
        <article-title>CENSOR–a program for identification and elimination of repetitive elements from DNA sequences.</article-title>
        <source>Comput Chem</source>
        <volume>20</volume>
        <fpage>119</fpage>
        <lpage>121</lpage>
        <pub-id pub-id-type="pmid">8867843</pub-id>
      </element-citation>
    </ref>
    <ref id="pone.0016526-Kolpakov1">
      <label>61</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kolpakov</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Bana</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Kucherov</surname>
            <given-names>G</given-names>
          </name>
        </person-group>
        <year>2003</year>
        <article-title>mreps: efficient and flexible detection of tandem repeats in DNA.</article-title>
        <source>Nucleic Acids Research</source>
        <volume>31</volume>
        <fpage>3672</fpage>
        <lpage>3678</lpage>
        <pub-id pub-id-type="pmid">12824391</pub-id>
      </element-citation>
    </ref>
    <ref id="pone.0016526-Kent1">
      <label>62</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kent</surname>
            <given-names>W</given-names>
          </name>
        </person-group>
        <year>2002</year>
        <article-title>BLAT–the BLAST-like alignment tool.</article-title>
        <source>Genome Research</source>
        <volume>12</volume>
        <fpage>656</fpage>
        <lpage>664</lpage>
        <pub-id pub-id-type="pmid">11932250</pub-id>
      </element-citation>
    </ref>
    <ref id="pone.0016526-Dondoshansky1">
      <label>63</label>
      <element-citation publication-type="other">
        <person-group person-group-type="author">
          <name>
            <surname>Dondoshansky</surname>
            <given-names>I</given-names>
          </name>
        </person-group>
        <year>2002</year>
        <source>Blastclust (NCBI Software Development Toolkit)</source>
      </element-citation>
    </ref>
    <ref id="pone.0016526-Waterhouse1">
      <label>64</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Waterhouse</surname>
            <given-names>AM</given-names>
          </name>
          <name>
            <surname>Procter</surname>
            <given-names>JB</given-names>
          </name>
          <name>
            <surname>Martin</surname>
            <given-names>DMA</given-names>
          </name>
          <name>
            <surname>Clamp</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Barton</surname>
            <given-names>GJ</given-names>
          </name>
        </person-group>
        <year>2009</year>
        <article-title>Jalview Version 2–a multiple sequence alignment editor and analysis workbench.</article-title>
        <source>Bioinformatics</source>
        <volume>25</volume>
        <fpage>1189</fpage>
        <lpage>1191</lpage>
        <pub-id pub-id-type="pmid">19151095</pub-id>
      </element-citation>
    </ref>
  </ref-list>
</back>
<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//NLM//DTD Journal Publishing DTD v2.3 20031101//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName journalpublishing.dtd?>
<?SourceDTD.Version 2.3?>
<?ConverterInfo.XSLTName jp2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">PLoS One</journal-id>
    <journal-id journal-id-type="iso-abbrev">PLoS ONE</journal-id>
    <journal-id journal-id-type="publisher-id">plos</journal-id>
    <journal-id journal-id-type="pmc">plosone</journal-id>
    <journal-title-group>
      <journal-title>PLoS ONE</journal-title>
    </journal-title-group>
    <issn pub-type="epub">1932-6203</issn>
    <publisher>
      <publisher-name>Public Library of Science</publisher-name>
      <publisher-loc>San Francisco, USA</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">3031573</article-id>
    <article-id pub-id-type="pmid">21304975</article-id>
    <article-id pub-id-type="publisher-id">PONE-D-10-01421</article-id>
    <article-id pub-id-type="doi">10.1371/journal.pone.0016526</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Research Article</subject>
      </subj-group>
      <subj-group subj-group-type="Discipline-v2">
        <subject>Biology</subject>
        <subj-group>
          <subject>Computational Biology</subject>
          <subj-group>
            <subject>Genomics</subject>
            <subj-group>
              <subject>Genome Analysis Tools</subject>
              <subject>Genome Complexity</subject>
              <subject>Structural Genomics</subject>
            </subj-group>
          </subj-group>
        </subj-group>
        <subj-group>
          <subject>Genomics</subject>
          <subj-group>
            <subject>Genome Analysis Tools</subject>
            <subject>Genome Complexity</subject>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v2">
        <subject>Computer Science</subject>
        <subj-group>
          <subject>Software Engineering</subject>
          <subj-group>
            <subject>Software Design</subject>
            <subject>Software Tools</subject>
          </subj-group>
        </subj-group>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Considering Transposable Element Diversification in <italic>De Novo</italic> Annotation Approaches</article-title>
      <alt-title alt-title-type="running-head"><italic>De Novo</italic> Annotation of Transposable Elements</alt-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Flutre</surname>
          <given-names>Timothée</given-names>
        </name>
        <xref ref-type="aff" rid="aff1">
          <sup>1</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Duprat</surname>
          <given-names>Elodie</given-names>
        </name>
        <xref ref-type="aff" rid="aff2">
          <sup>2</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Feuillet</surname>
          <given-names>Catherine</given-names>
        </name>
        <xref ref-type="aff" rid="aff3">
          <sup>3</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Quesneville</surname>
          <given-names>Hadi</given-names>
        </name>
        <xref ref-type="aff" rid="aff1">
          <sup>1</sup>
        </xref>
        <xref ref-type="corresp" rid="cor1">
          <sup>*</sup>
        </xref>
      </contrib>
    </contrib-group>
    <aff id="aff1">
      <label>1</label>
      <addr-line>Unité de Recherche en Génomique-Info, UR 1164, INRA Centre de Versailles-Grignon, Versailles, France</addr-line>
    </aff>
    <aff id="aff2">
      <label>2</label>
      <addr-line>Institut de Minéralogie et de Physique des Milieux Condensés, UMR 7590, CNRS-UPMC-IPGP-Université Paris Diderot, Paris, France</addr-line>
    </aff>
    <aff id="aff3">
      <label>3</label>
      <addr-line>Génétique, Diversité et Ecophysiologie des Céréales, UMR 1095, INRA Domaine du Crouël, Clermont-Ferrand, France</addr-line>
    </aff>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Xu</surname>
          <given-names>Ying</given-names>
        </name>
        <role>Editor</role>
        <xref ref-type="aff" rid="edit1"/>
      </contrib>
    </contrib-group>
    <aff id="edit1">University of Georgia, United States of America</aff>
    <author-notes>
      <corresp id="cor1">* E-mail: <email>Hadi.quesneville@versailles.inra.fr</email></corresp>
      <fn fn-type="con">
        <p>Conceived and designed the experiments: TF ED HQ. Performed the experiments: TF ED. Analyzed the data: TF ED CF HQ. Contributed reagents/materials/analysis tools: TF ED. Wrote the paper: TF CF HQ. Coordinated study: HQ.</p>
      </fn>
    </author-notes>
    <pub-date pub-type="collection">
      <year>2011</year>
    </pub-date>
    <pub-date pub-type="epub">
      <day>31</day>
      <month>1</month>
      <year>2011</year>
    </pub-date>
    <volume>6</volume>
    <issue>1</issue>
    <elocation-id>e16526</elocation-id>
    <history>
      <date date-type="received">
        <day>31</day>
        <month>8</month>
        <year>2010</year>
      </date>
      <date date-type="accepted">
        <day>4</day>
        <month>1</month>
        <year>2011</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>Flutre et al.</copyright-statement>
      <copyright-year>2011</copyright-year>
      <license xlink:href="http://creativecommons.org/licenses/by/4.0/">
        <license-p>This is an open-access article distributed under the terms of the Creative Commons Attribution License, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are properly credited.</license-p>
      </license>
    </permissions>
    <abstract>
      <p>Transposable elements (TEs) are mobile, repetitive DNA sequences that are almost ubiquitous in prokaryotic and eukaryotic genomes. They have a large impact on genome structure, function and evolution. With the recent development of high-throughput sequencing methods, many genome sequences have become available, making possible comparative studies of TE dynamics at an unprecedented scale. Several methods have been proposed for the <italic>de novo</italic> identification of TEs in sequenced genomes. Most begin with the detection of genomic repeats, but the subsequent steps for defining TE families differ. High-quality TE annotations are available for the <italic>Drosophila melanogaster</italic> and <italic>Arabidopsis thaliana</italic> genome sequences, providing a solid basis for the benchmarking of such methods. We compared the performance of specific algorithms for the clustering of interspersed repeats and found that only a particular combination of algorithms detected TE families with good recovery of the reference sequences. We then applied a new procedure for reconciling the different clustering results and classifying TE sequences. The whole approach was implemented in a pipeline using the REPET package. Finally, we show that our combined approach highlights the dynamics of well defined TE families by making it possible to identify structural variations among their copies. This approach makes it possible to annotate TE families and to study their diversification in a single analysis, improving our understanding of TE dynamics at the whole-genome scale and for diverse species.</p>
    </abstract>
    <counts>
      <page-count count="15"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec id="s1">
    <title>Introduction</title>
    <p>Transposable elements (TEs) are DNA sequences that can move and duplicate, autonomously or with the assistance of other elements, within genomes. TEs have been described as the “ultimate parasite”, because of their ability to amplify and invade genomes for their own ends <xref rid="pone.0016526-Orgel1" ref-type="bibr">[1]</xref>, and as “selfish DNA sequences” <xref rid="pone.0016526-Brookfield1" ref-type="bibr">[2]</xref>. These invasion events play a particularly important role in eukaryotic genomes, probably because of the smaller population sizes of eukaryotes than of prokaryotes <xref rid="pone.0016526-Lynch1" ref-type="bibr">[3]</xref>.</p>
    <p>TEs are generally classified according to their transposition mechanism. Those transposing <italic>via</italic> an RNA intermediate belong to class I and are referred to as retrotransposons, whereas those transposing <italic>via</italic> a DNA intermediate belong to class II and are called DNA transposons <xref rid="pone.0016526-Finnegan1" ref-type="bibr">[4]</xref>. Class I transposable elements can be classified into three main orders, LTR retrotransposons (having long terminal repeats), LINEs (long interspersed nuclear elements) and SINEs (short interspersed nuclear elements), whereas class II transposable elements are classified into DNA transposons, Helitrons and Mavericks <xref rid="pone.0016526-Wicker1" ref-type="bibr">[5]</xref>. Most TEs encode proteins that mediate their autonomous transposition. During the course of evolution, non autonomous elements have emerged from autonomous elements. Some are incomplete versions of autonomous elements, often with insertions/deletions (indels) disrupting their open reading frames (ORFs). Others are miniature versions lacking internal sequences but retaining the boundaries of the original element, making it possible for the autonomous element machinery to recognize them. MITEs (miniature inverted-repeats transposable elements) are well known examples of non autonomous elements that evolved from class II DNA transposons <xref rid="pone.0016526-Wessler1" ref-type="bibr">[6]</xref>, <xref rid="pone.0016526-Yang1" ref-type="bibr">[7]</xref>.</p>
    <p>TEs are now recognized to be a major component of the structure of the genome and to affect genome size and chromosomal rearrangements <xref rid="pone.0016526-Gray1" ref-type="bibr">[8]</xref>–<xref rid="pone.0016526-Coghlan1" ref-type="bibr">[10]</xref>. They often account for a large proportion of the genome: 20% of the 180 Mb <italic>Drosophila melanogaster</italic> genome, 45% of the 3.2 Gb human genome, and more than 80% of the 17 Gb bread wheat (<italic>Triticum aestivum</italic>) genome <xref rid="pone.0016526-Paux1" ref-type="bibr">[11]</xref>. These dispersed repeats can induce major chromosomal rearrangements, thereby affecting genome organization. However, the impact of TEs is not limited to effects on genome structure. As initially suggested by Barbara McClintock <xref rid="pone.0016526-McClintock1" ref-type="bibr">[12]</xref>, TEs may be seen as “controlling” elements. They may provide regulatory sequences with various effects on the adjacent genes. In particular, some silencing mechanisms involving RNA interference seem to have emerged primarily as a host response to prevent TE amplification. Thus, genes located close to TE insertions may be subject to transcriptional control due to TE repression, resulting in their epigenetic regulation <xref rid="pone.0016526-Slotkin1" ref-type="bibr">[13]</xref>, <xref rid="pone.0016526-Martin1" ref-type="bibr">[14]</xref>. Moreover, TEs are intrinsically able to create, modify and re-wire gene regulatory networks <xref rid="pone.0016526-Feschotte1" ref-type="bibr">[15]</xref>, <xref rid="pone.0016526-Herpin1" ref-type="bibr">[16]</xref>. Finally, many cases of exaptation and domestication involving TEs have been reported <xref rid="pone.0016526-Cordaux1" ref-type="bibr">[17]</xref>, <xref rid="pone.0016526-Santangelo1" ref-type="bibr">[18]</xref>. For example, there are several lines of evidence to suggest that the RAG1 and RAG2 genes involved in V(D)J recombination originated from a hAT DNA transposon that was domesticated to fulfill this primordial function of the adaptive immune system <xref rid="pone.0016526-Agrawal1" ref-type="bibr">[19]</xref>, <xref rid="pone.0016526-Zhou1" ref-type="bibr">[20]</xref>.</p>
    <p>The increase in efficiency and decrease in cost of new sequencing techniques <xref rid="pone.0016526-Schuster1" ref-type="bibr">[21]</xref> are leading to the sequencing of increasing numbers of genomes. About 1250 genome sequencing projects have already been initiated for eukaryotes, including species with large and repetitive genomes, such as maize <xref rid="pone.0016526-Schnable1" ref-type="bibr">[22]</xref>. The efficient and accurate annotation of TEs is therefore essential to our understanding of their impact on gene function and genome evolution <xref rid="pone.0016526-Bourque1" ref-type="bibr">[23]</xref>.</p>
    <p>If a routine TE annotation procedure is to be efficient, it must be both rapid and exhaustive, biologically relevant and computationally tractable. The TE annotation process can be divided into two phases: (i) the <italic>de novo</italic> discovery and identification of the TE families present in the genome studied and (ii) the precise, comprehensive annotation of TE copies on the chromosomes. For the second phase, an integrated pipeline has already been developed and tested <xref rid="pone.0016526-Quesneville1" ref-type="bibr">[24]</xref> and this pipeline has been applied to several organisms <xref rid="pone.0016526-Bergman1" ref-type="bibr">[25]</xref>–<xref rid="pone.0016526-The2" ref-type="bibr">[31]</xref>. For the <italic>de novo</italic> discovery phase, several programs and algorithms based on different assumptions have been developed, but none has yet proved entirely satisfactory. Indeed, as pointed out in a previous study <xref rid="pone.0016526-Saha1" ref-type="bibr">[32]</xref>, some programs have very low levels of sensitivity or specificity, whereas others return too short consensus sequence (&lt;1 kb).</p>
    <p>In addition to describing the composition and organization of the genome, TE annotation facilitates the identification of structural variants providing useful information about genome dynamics. Several examples of structural variations in TE families have been reported <xref rid="pone.0016526-Jiang1" ref-type="bibr">[33]</xref>, <xref rid="pone.0016526-Quesneville2" ref-type="bibr">[34]</xref> but these variations have generally been underestimated in genome-wide analyses of TEs. In this study, we addressed two questions, one concerning the challenges associated with whole-genome TE annotation, and the other relating to the identification and characterization of structural variants from the same TE family. We first compared the existing computational methods for the <italic>de novo</italic> identification of TEs in sequenced genomes, using the high-quality TE annotations available for the <italic>Drosophila melanogaster</italic>
<xref rid="pone.0016526-Quesneville1" ref-type="bibr">[24]</xref> and <italic>Arabidopsis thaliana</italic> genome sequences <xref rid="pone.0016526-Buisine1" ref-type="bibr">[29]</xref>. We then developed the TEdenovo pipeline, a tool combining several different programs, including procedures for the clustering of interspersed repeats, into a single framework, the REPET package (<ext-link ext-link-type="uri" xlink:href="http://urgi.versailles.inra.fr/index.php/repet">http://urgi.versailles.inra.fr/index.php/repet</ext-link>). Finally, by analyzing the <italic>D. melanogaster</italic> and <italic>A. thaliana</italic> genomes with the TEdenovo pipeline, we were able to obtain new insight into TE dynamics, highlighting structural variations emerging during the diversification of TE families and identifying putative new TEs absent from reference databanks.</p>
  </sec>
  <sec id="s2">
    <title>Results</title>
    <sec id="s2a">
      <title>Comparative analysis of <italic>de novo</italic> approaches</title>
      <p>We developed a three-step approach for comparing the efficiency of <italic>de novo</italic> TE detection methods (see <xref rid="pone.0016526-Bergman2" ref-type="bibr">[35]</xref> for a review), to provide a robust tool for identifying TEs in eukaryotic genomes: (i) the self-alignment of the input genomic sequences, (ii) the clustering of the resulting pairwise alignments, and (iii) the construction of a multiple alignment for each cluster from which a consensus sequence is derived (<xref ref-type="supplementary-material" rid="pone.0016526.s001">Figure S1</xref>). This process generates a databank of <italic>de novo</italic> consensus sequences representing putative TE families present in the genome analyzed, which can be used for the annotation of individual TE copies. We applied this three-step approach to the <italic>D. melanogaster</italic> release 4 and <italic>A. thaliana</italic> release 9 genome sequences. At each step, we evaluated several programs, comparing the efficiency with which they identified TEs with the aid of the high-quality TE sequence databanks (from the Berkeley <italic>Drosophila</italic> Genome Project and Repbase Update) and annotations available for these two reference genomes <xref rid="pone.0016526-Quesneville1" ref-type="bibr">[24]</xref>, <xref rid="pone.0016526-Buisine1" ref-type="bibr">[29]</xref>.</p>
      <p>Traditionally, the quality of <italic>de novo</italic> consensus sequences — the extent to which they correspond to full TE reference sequences rather than truncated versions — is not assessed. Validation is instead indirect: researchers annotate a genome sequence with RepeatMasker, using Repbase Update as TE databank, and consider the resulting TE annotations as the references. They then annotate the same genome with RepeatMasker, using the <italic>de novo</italic> consensus as TE databank, and consider these TE annotations as predictions. These two sets of annotations are then compared, by calculating sensitivity and specificity at the nucleotide level. The criterion used to estimate the quality of the <italic>de novo</italic> method is therefore the extent to which <italic>de novo</italic> predictions and reference annotations overlap. However, as we are particularly interested in TE dynamics, we need to assess the quality of the <italic>de novo</italic> library itself, by evaluating the extent to which full ancestral TE reference sequences are recovered. Such sequences, which originate from the reconstruction of a given element from its copies, are not only useful for subsequent TE annotation, but also provide a condensed view of the TEs in the genome. One way of assessing the quality of the <italic>de novo</italic> consensus sequences obtained with our three-step approach would be to compare these sequences with reference sequences from the Berkeley Drosophila Genome Project (BDGP) or Repbase Update databanks. However, it was clear that some of the reference sequences present in these databanks would not be present in the genomes analyzed. For example, the “P-element” reference sequence is absent from the genome sequence of the <italic>D. melanogaster</italic> strain used here. So, rather than using the reference databanks directly, we first constructed, for each genome, a “knowledge-based” databank comprising one consensus sequence per reference TE sequence, based on its genomic copies (see <xref ref-type="sec" rid="s4">Methods</xref>). For each genome, we then compared each <italic>de novo</italic> databank with its corresponding “knowledge-based” databank through pairwise sequence alignments. We then calculated the sensitivity S<sub>n</sub>*, specificity S<sub>p</sub>* and recovery ratio R<sub>CC</sub> (see <xref ref-type="sec" rid="s4">Methods</xref> and <xref ref-type="table" rid="pone-0016526-t001">Table 1</xref>). This last index, the R<sub>CC</sub> ratio, provides a precise measurement of the number of TE reference elements fully recovered in the <italic>de novo</italic> consensus sequences.</p>
      <table-wrap id="pone-0016526-t001" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pone.0016526.t001</object-id>
        <label>Table 1</label>
        <caption>
          <title>Sensitivity and specificity of the programs tested in the three-step <italic>de novo</italic> approach.</title>
        </caption>
        <alternatives>
          <graphic id="pone-0016526-t001-1" xlink:href="pone.0016526.t001"/>
          <table frame="hsides" rules="groups">
            <colgroup span="1">
              <col align="left" span="1"/>
              <col align="center" span="1"/>
              <col align="center" span="1"/>
              <col align="center" span="1"/>
              <col align="center" span="1"/>
              <col align="center" span="1"/>
              <col align="center" span="1"/>
            </colgroup>
            <thead>
              <tr>
                <td align="left" rowspan="1" colspan="1">Genome</td>
                <td align="left" rowspan="1" colspan="1">Self-alignment</td>
                <td align="left" rowspan="1" colspan="1">Clustering</td>
                <td align="left" rowspan="1" colspan="1">Multiple alignment</td>
                <td align="left" rowspan="1" colspan="1">S<sub>n</sub>*</td>
                <td align="left" rowspan="1" colspan="1">S<sub>p</sub>*</td>
                <td align="left" rowspan="1" colspan="1">R<sub>CC</sub>
</td>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td align="left" rowspan="1" colspan="1">
                  <italic>D. mel.</italic>
                </td>
                <td align="left" rowspan="1" colspan="1">BLASTER</td>
                <td align="left" rowspan="1" colspan="1">GROUPER</td>
                <td align="left" rowspan="1" colspan="1">MAP</td>
                <td align="left" rowspan="1" colspan="1">80.34%</td>
                <td align="left" rowspan="1" colspan="1">85.89%</td>
                <td align="left" rowspan="1" colspan="1">66.20%</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">
                  <italic>D. mel.</italic>
                </td>
                <td align="left" rowspan="1" colspan="1">BLASTER</td>
                <td align="left" rowspan="1" colspan="1">RECON</td>
                <td align="left" rowspan="1" colspan="1">MAP</td>
                <td align="left" rowspan="1" colspan="1">92.31%</td>
                <td align="left" rowspan="1" colspan="1">73.17%</td>
                <td align="left" rowspan="1" colspan="1">66.20%</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">
                  <italic>D. mel.</italic>
                </td>
                <td align="left" rowspan="1" colspan="1">BLASTER</td>
                <td align="left" rowspan="1" colspan="1">PILER</td>
                <td align="left" rowspan="1" colspan="1">MAP</td>
                <td align="left" rowspan="1" colspan="1">62.39%</td>
                <td align="left" rowspan="1" colspan="1">84.17%</td>
                <td align="left" rowspan="1" colspan="1">51.50%</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">
                  <italic>D. mel.</italic>
                </td>
                <td align="left" rowspan="1" colspan="1">PALS</td>
                <td align="left" rowspan="1" colspan="1">GROUPER</td>
                <td align="left" rowspan="1" colspan="1">MAP</td>
                <td align="left" rowspan="1" colspan="1">73.50%</td>
                <td align="left" rowspan="1" colspan="1">88.75%</td>
                <td align="left" rowspan="1" colspan="1">60.30%</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">
                  <italic>D. mel.</italic>
                </td>
                <td align="left" rowspan="1" colspan="1">PALS</td>
                <td align="left" rowspan="1" colspan="1">RECON</td>
                <td align="left" rowspan="1" colspan="1">MAP</td>
                <td align="left" rowspan="1" colspan="1">90.60%</td>
                <td align="left" rowspan="1" colspan="1">74.23%</td>
                <td align="left" rowspan="1" colspan="1">51.50%</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">
                  <italic>D. mel.</italic>
                </td>
                <td align="left" rowspan="1" colspan="1">PALS</td>
                <td align="left" rowspan="1" colspan="1">PILER</td>
                <td align="left" rowspan="1" colspan="1">MAP</td>
                <td align="left" rowspan="1" colspan="1">53.85%</td>
                <td align="left" rowspan="1" colspan="1">76.42%</td>
                <td align="left" rowspan="1" colspan="1">42.64%</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">
                  <italic>A. tha.</italic>
                </td>
                <td align="left" rowspan="1" colspan="1">BLASTER</td>
                <td align="left" rowspan="1" colspan="1">GROUPER</td>
                <td align="left" rowspan="1" colspan="1">MAP</td>
                <td align="left" rowspan="1" colspan="1">60.33%</td>
                <td align="left" rowspan="1" colspan="1">82.42%</td>
                <td align="left" rowspan="1" colspan="1">39.00%</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">
                  <italic>A. tha.</italic>
                </td>
                <td align="left" rowspan="1" colspan="1">BLASTER</td>
                <td align="left" rowspan="1" colspan="1">RECON</td>
                <td align="left" rowspan="1" colspan="1">MAP</td>
                <td align="left" rowspan="1" colspan="1">73.77%</td>
                <td align="left" rowspan="1" colspan="1">61.70%</td>
                <td align="left" rowspan="1" colspan="1">43.50%</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">
                  <italic>A. tha.</italic>
                </td>
                <td align="left" rowspan="1" colspan="1">BLASTER</td>
                <td align="left" rowspan="1" colspan="1">PILER</td>
                <td align="left" rowspan="1" colspan="1">MAP</td>
                <td align="left" rowspan="1" colspan="1">47.21%</td>
                <td align="left" rowspan="1" colspan="1">57.33%</td>
                <td align="left" rowspan="1" colspan="1">32.45%</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">
                  <italic>A. tha.</italic>
                </td>
                <td align="left" rowspan="1" colspan="1">PALS</td>
                <td align="left" rowspan="1" colspan="1">GROUPER</td>
                <td align="left" rowspan="1" colspan="1">MAP</td>
                <td align="left" rowspan="1" colspan="1">54.75%</td>
                <td align="left" rowspan="1" colspan="1">88.38%</td>
                <td align="left" rowspan="1" colspan="1">24.00%</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">
                  <italic>A. tha.</italic>
                </td>
                <td align="left" rowspan="1" colspan="1">PALS</td>
                <td align="left" rowspan="1" colspan="1">RECON</td>
                <td align="left" rowspan="1" colspan="1">MAP</td>
                <td align="left" rowspan="1" colspan="1">71.80%</td>
                <td align="left" rowspan="1" colspan="1">66.20%</td>
                <td align="left" rowspan="1" colspan="1">27.90%</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">
                  <italic>A. tha.</italic>
                </td>
                <td align="left" rowspan="1" colspan="1">PALS</td>
                <td align="left" rowspan="1" colspan="1">PILER</td>
                <td align="left" rowspan="1" colspan="1">MAP</td>
                <td align="left" rowspan="1" colspan="1">40.00%</td>
                <td align="left" rowspan="1" colspan="1">59.92%</td>
                <td align="left" rowspan="1" colspan="1">16.20%</td>
              </tr>
            </tbody>
          </table>
        </alternatives>
        <table-wrap-foot>
          <fn id="nt101">
            <label/>
            <p>“<italic>D. mel.</italic>” stands for “<italic>D. melanogaster</italic>” and “<italic>A. tha.</italic>” stands for “<italic>A. thaliana</italic>”. The three indices S<sub>n</sub>*, S<sub>p</sub>* and R<sub>CC</sub> correspond respectively to the measure of sensitivity, the measure of specificity and the recovery ratio when comparing a databank of TE <italic>de novo</italic> consensus sequences with a databank of TE reference sequences.</p>
          </fn>
        </table-wrap-foot>
      </table-wrap>
      <sec id="s2a1">
        <title>Self-alignment of the genomic sequences</title>
        <p>The first step in the three-step <italic>de novo</italic> approach involves the self-alignment of the input genomic sequences, corresponding to an all-by-all comparison of the genome with itself. We evaluated two local pairwise alignment programs for this first step: a heuristic algorithm, BLASTER <xref rid="pone.0016526-Quesneville3" ref-type="bibr">[36]</xref> wrapping BLAST <xref rid="pone.0016526-Altschul1" ref-type="bibr">[37]</xref>, and an exact algorithm, PALS <xref rid="pone.0016526-Rasmussen1" ref-type="bibr">[38]</xref> (see <xref ref-type="sec" rid="s4">Methods</xref>). We launched these two programs, with stringent parameters, on each of the target genomes, and then applied post-processing procedures to discard long segmental duplications (see <xref ref-type="sec" rid="s4">Methods</xref>). This resulted in a list of pairwise alignments corresponding to repeats in the <italic>D. melanogaster</italic> and <italic>A. thaliana</italic> genome sequences. A comparison of the <italic>de novo</italic> consensus sequence performances of the BLASTER and PALS programs (<xref ref-type="table" rid="pone-0016526-t001">Table 1</xref>) showed that BLASTER consistently had a higher sensitivity (S<sub>n</sub>*) and a much higher recovery ratio (R<sub>CC</sub>). In most cases, its specificity (S<sub>p</sub>*) was also better than that of PALS. Note that PALS was run with more stringent parameters than BLASTER as it cannot be used with the same values without computing time becoming intractable (see <xref ref-type="sec" rid="s4">Methods</xref>). As the recovery ratio R<sub>CC</sub> reflects the ability of the <italic>de novo</italic> approach to define TE boundaries correctly and, therefore, to recover full-length TE reference sequences, we preferred BLASTER over PALS for the self-alignment step. Moreover, in both genomes, BLASTER gave a higher genome coverage than PALS (<xref ref-type="supplementary-material" rid="pone.0016526.s004">Table S1</xref>), as expected given the lower stringency of its parameters (see <xref ref-type="sec" rid="s4">Methods</xref>). This first step also generated a lower limit for the repeats content of the genome: around 7% for <italic>D. melanogaster</italic> and 13% for <italic>A. thaliana</italic>.</p>
      </sec>
      <sec id="s2a2">
        <title>Clustering of the all-by-all matches</title>
        <p>In the second step, we clustered the results of the all-by-all comparisons, with the aim of gathering together, within the same cluster, all sequences belonging to the same TE family. This step is crucial to ensure the precise definition of repeat boundaries, one of the main challenges in the <italic>de novo</italic> detection of TEs. Due to their specific dynamics during genome evolution, TE families may differ considerably in terms of copy number, sequence divergence and insertion/deletion patterns. At this step, the aim is to cluster together all TE fragments sharing a common ancestor, with the aim of recovering the ancestral element that transposed in the past. However, TE copies diverge as they multiply and different copies may accumulate different modifications. This phenomenon results in structural variants, as depicted in <xref ref-type="fig" rid="pone-0016526-g001">Figure 1</xref>. In this case, the grouping together of copies from different structural variants within the same cluster may have the undesirable consequence of the identification of consensus sequences with some features specific to one of the structural variants with others specific to another variant. We therefore tested three programs specifically implemented for the clustering of interspersed repeats: GROUPER <xref rid="pone.0016526-Quesneville3" ref-type="bibr">[36]</xref>, RECON <xref rid="pone.0016526-Bao1" ref-type="bibr">[39]</xref> and PILER <xref rid="pone.0016526-Edgar1" ref-type="bibr">[40]</xref> (see <xref ref-type="sec" rid="s4">Methods</xref>).</p>
        <fig id="pone-0016526-g001" position="float">
          <object-id pub-id-type="doi">10.1371/journal.pone.0016526.g001</object-id>
          <label>Figure 1</label>
          <caption>
            <title>Schematic diagram of the dynamics of a TE family with two structural variants.</title>
          </caption>
          <graphic xlink:href="pone.0016526.g001"/>
        </fig>
        <p>We applied these three programs to the list of matches obtained in the genome self-alignments, and then applied procedures for discarding segmental duplications (see <xref ref-type="sec" rid="s4">Methods</xref>). In terms of the <italic>de novo</italic> consensuses generated from the resulting clusters (<xref ref-type="table" rid="pone-0016526-t001">Table 1</xref>), GROUPER and RECON were consistently more sensitive than PILER. Moreover, GROUPER was systematically more specific than RECON and PILER, with <italic>de novo</italic> consensuses from GROUPER less likely to be artifacts unrelated to TE reference sequences than those obtained with the other methods. In some cases, RECON provided a better recovery ratio (R<sub>CC</sub>) than GROUPER and PILER, but this ratio was always better for GROUPER than for PILER. In addition, regardless of the genome analyzed, the three programs did not necessarily generate the same number of clusters (<xref ref-type="supplementary-material" rid="pone.0016526.s005">Table S2</xref>): GROUPER generated more clusters than RECON, which, in turn, generated more clusters than PILER. The number of clusters obtained by the <italic>de novo</italic> approach was much higher for GROUPER and RECON than the number of TE families present in the reference databanks (BDGP or Repbase Update). We suggest that this large number of clusters reflects the high level of diversity within TE families in terms of copy divergence and nesting patterns, as assessed by clustering algorithms.</p>
      </sec>
      <sec id="s2a3">
        <title>Multiple sequence alignment for each cluster</title>
        <p>The third step, which consists in the construction of a multiple alignment for each cluster, is particularly important, because the quality of a consensus sequence depends on the quality of the multiple sequence alignment (MSA) from which it is derived. A large number of programs have been developed over the last ten years <xref rid="pone.0016526-Notredame1" ref-type="bibr">[41]</xref>, focusing on issues such as the scoring scheme, the use of templates for secondary structures and computation speed. In our case, the sequences to be aligned are very similar to each other in terms of nucleotide substitutions (identity of more than 90%), with most of the differences between them resulting from indels. The clusters generated by RECON include sequences of very different lengths (<xref ref-type="supplementary-material" rid="pone.0016526.s005">Table S2</xref>). Moreover, depending on the size and TE content of the genome analyzed, it may be necessary to process several thousand clusters. We tested only a subset of all the possible programs, focusing on those most suitable for our requirements: rapid procedures capable of handling indels. We therefore focused on progressive MSA algorithms, as these algorithms generate alignments rapidly. We tested MAP <xref rid="pone.0016526-Huang1" ref-type="bibr">[42]</xref>, CLUSTAL-W <xref rid="pone.0016526-Thompson1" ref-type="bibr">[43]</xref>, MAFFT <xref rid="pone.0016526-Katoh1" ref-type="bibr">[44]</xref> and PRANK <xref rid="pone.0016526-Loytynoja1" ref-type="bibr">[45]</xref> (see <xref ref-type="sec" rid="s4">Methods</xref>).</p>
        <p>For each of these multiple alignment programs, we used the matches returned by BLASTER and then clustered by GROUPER, RECON or PILER. This comparative study (<xref ref-type="supplementary-material" rid="pone.0016526.s006">Table S3</xref>) shows that all the multiple alignment programs gave similar results in terms of sensitivity and specificity, whether launched after GROUPER or after PILER. This result was expected, as all the sequences in these clusters are similar in both composition and length, making them easy to align. However, PRANK was slower than the other three programs, rendering it less suitable for large genome analyses. With RECON, the best results were obtained with MAP, due to the greater heterogeneity of RECON clusters in terms of sequence length, rendering alignment more difficult. Thus, few differences were observed, but MAP clearly outperformed the other programs on RECON clusters, making it more robust than the other programs, whatever the clustering method used.</p>
      </sec>
      <sec id="s2a4">
        <title>Comparison with another approach, RepeatScout</title>
        <p>We evaluated the performance of our three-step strategy, by comparing it with another approach that also builds a databank of TE consensus sequences from a raw genome sequence: RepeatScout <xref rid="pone.0016526-Price1" ref-type="bibr">[46]</xref> (see <xref ref-type="sec" rid="s4">Methods</xref>). We applied the RepeatScout program on the <italic>D. melanogaster</italic> and <italic>A. thaliana</italic> genome sequences, with the default parameters. It constructed 1770 consensuses for <italic>D. melanogaster</italic> and 3417 for <italic>A. thaliana</italic>. However, these consensuses were less sensitive and specific than those obtained with the tools described above (<xref ref-type="supplementary-material" rid="pone.0016526.s007">Table S4</xref>). This is probably due to the shorter length of the consensuses identified by RepeatScout (500 bp on average) than by GROUPER (∼2500 bp on average), RECON (∼2000 bp on average) and PILER (∼2800 bp on average). We obtained similar results for both genomes, indicating that this bias does not seem to be due to the input genome sequences. We hypothesize that RepeatScout fails to connect TE fragments more than a certain distance apart, thereby sometimes missing the true boundaries of a given TE copy. By contrast, GROUPER and RECON are particularly efficient at this task.</p>
      </sec>
      <sec id="s2a5">
        <title>Combination of programs into a robust pipeline, TEdenovo</title>
        <p>Based on the comparative analyses reported above, BLASTER should be used for the genome self-alignment step, followed by GROUPER or RECON for the clustering step and MAP for the multiple alignment step. However, a comparison of the consensuses obtained with all three clustering methods clearly showed that each of these methods nonetheless missed several reference TEs fully recovered by the others (<xref ref-type="fig" rid="pone-0016526-g002">Figure 2</xref>). With the <italic>D. melanogaster</italic> genome sequence, four “knowledge-based” consensuses were retrieved intact by GROUPER only, and nine such sequences were recovered by RECON only (<xref ref-type="fig" rid="pone-0016526-g002">Figure 2 A</xref>). Similarly, with the <italic>A. thaliana</italic> genome sequence, eight “knowledge-based” consensuses were retrieved intact only by GROUPER, whereas fifteen were retrieved intact only by RECON (<xref ref-type="fig" rid="pone-0016526-g002">Figure 2 B</xref>). The three clustering methods should therefore be used in combination, for the accurate identification of TE families in genome sequences. For this reason, we decided to the three-step approach within a combined, modular pipeline named “TEdenovo”. With respect to the best single method, GROUPER for <italic>D. melanogaster</italic> and RECON for <italic>A. thaliana</italic> (<xref ref-type="table" rid="pone-0016526-t001">Table 1</xref>), the combined approach, as implemented in the TEdenovo pipeline, improved the recovery of full-length “knowledge-based” consensus sequences by 20% and 13.5%, respectively, while maintaining high sensitivity and specificity (<xref ref-type="supplementary-material" rid="pone.0016526.s008">Table S5</xref>). The three approaches are combined at the clustering step, through the launching of GROUPER, RECON and PILER in parallel. The user may also choose to use PALS rather than BLASTER at step 1 or the other MSA programs at step 3, and can even choose to apply only one clustering program at step 2, although our results suggest that this would not be wise.</p>
        <fig id="pone-0016526-g002" position="float">
          <object-id pub-id-type="doi">10.1371/journal.pone.0016526.g002</object-id>
          <label>Figure 2</label>
          <caption>
            <title>Venn diagram showing the gains achieved by combining several clustering programs.</title>
            <p>(A) Combining the GROUPER and RECON programs in particular makes it possible to fully recover more TE sequences than each program alone from the <italic>D. melanogaster</italic> genome. (B) Same conclusion from the <italic>A. thaliana</italic> genome.</p>
          </caption>
          <graphic xlink:href="pone.0016526.g002"/>
        </fig>
      </sec>
    </sec>
    <sec id="s2b">
      <title>Classification of TE consensus sequences and identification of structural variation within TE families</title>
      <sec id="s2b1">
        <title>Classification of the consensus sequences and elimination of redundancy</title>
        <p>The three-step approach provided us with a set of <italic>de novo</italic> consensus sequences corresponding to interspersed sequences occurring at least three times in the genome studied. A two-step classification procedure was implemented to add more biological information, to filter out false-positives and to eliminate the redundancy introduced by the combined approach. There is a long-standing debate about the aims of any classification in biology <xref rid="pone.0016526-Mayr1" ref-type="bibr">[47]</xref>, and the case of genomic repeats does not escape the rule: “Although the reality is that repeats […] are a hierarchical evolutionary continuum that defies classification, it is still desirable to impose a simplistic classification that pretends that repeat families are distinct, for the purpose of practical genome annotation” <xref rid="pone.0016526-Bao1" ref-type="bibr">[39]</xref>. In this spirit, our classification procedure begins with the detection of TE features in the consensus sequences, and a decision tree classifying each consensus as a function of these features is then produced (<xref ref-type="fig" rid="pone-0016526-g003">Figure 3</xref>). In the first step, the procedure identifies terminal repeats, tandem repeats, poly-A tails and SSR-like tails (simple sequence repeats). It also aligns the consensus sequences with known TEs through blastn, blastx and tblastx, and with known genes from the host genome. The known TEs are those from Repbase Update, a curated set of TE sequences from numerous genomes <xref rid="pone.0016526-Jurka1" ref-type="bibr">[48]</xref>. Our TE classifier uses a customized version of this databank available from the Repbase Update website (<ext-link ext-link-type="uri" xlink:href="http://www.girinst.org/repbase/">http://www.girinst.org/repbase/</ext-link>), but any customized databank may be used, provided that it is appropriately formatted. In the second step, the procedure implements a decision tree based on the classification summarized in <xref rid="pone.0016526-Wicker1" ref-type="bibr">[5]</xref>. For benchmarking purposes, when analyzing <italic>de novo</italic> consensus sequences from the <italic>D. melanogaster</italic> and <italic>A. thaliana</italic> genomes, we removed the sequences known to belong to these species from the Repbase Update databank, to establish conditions equivalent to those for the analysis of a new genome.</p>
        <fig id="pone-0016526-g003" position="float">
          <object-id pub-id-type="doi">10.1371/journal.pone.0016526.g003</object-id>
          <label>Figure 3</label>
          <caption>
            <title>Simplified decision tree implemented in the TE classifier.</title>
          </caption>
          <graphic xlink:href="pone.0016526.g003"/>
        </fig>
        <p>The classification takes into account the degree of completeness of the <italic>de novo</italic> TE consensus (<xref ref-type="fig" rid="pone-0016526-g003">Figure 3</xref>). For instance, if a consensus sequence has the required “structural features” — LTRs (long terminal repeats), TIRs (terminal inverted repeats) or a tail (poly-A or SSR-like) — and “coding features” — matches with known TEs in tblastx and blastx analyses — then it is considered “complete”. If it has only one of these two types of features, it is classified as “incomplete”. Moreover, a consensus sequence can be classified as “confused” if our TE classifier detects features known to belong to different categories of TEs or, based on the detected features, its length is outside the range of TEs known to have such features. If the consensus has no identifiable features, it is classified as “not categorized”. We also used length parameters (<xref ref-type="supplementary-material" rid="pone.0016526.s009">Table S6</xref>) benchmarked on the reference databanks — BDGP for <italic>D. melanogaster</italic> and Repbase Update for <italic>A. thaliana</italic> — to improve differentiation between presumably truncated and full-length consensus sequences. We also used length parameters when classifying a sequence having only “structural features”, to determine whether the sequence concerned was a SINE or a MITE.</p>
        <fig id="pone-0016526-g004" position="float">
          <object-id pub-id-type="doi">10.1371/journal.pone.0016526.g004</object-id>
          <label>Figure 4</label>
          <caption>
            <title>Extensive structural variations within several TE families.</title>
            <p>Each image provides an overview of a multiple alignment, a column being in one color if all the residues within it are identical. In all the images, the first sequence in the multiple alignment (red star) is the TE reference sequence from a public databank (BDGP or Repbase). For alignments A to D, the second sequence (blue star) is the only <italic>de novo</italic> consensus in which the TE reference sequence is fully recovered by only one clustering method. All sequences below (in brackets) are TE genomic copies found by the <italic>de novo</italic> consensus analysis. For alignments E to H, the sequences below the TE reference sequence are <italic>de novo</italic> consensus that require manual curation. Beside is indicated the program that build them, “R” for RECON and “G” for GROUPER.</p>
          </caption>
          <graphic xlink:href="pone.0016526.g004"/>
        </fig>
        <p>As shown in <xref ref-type="table" rid="pone-0016526-t002">Table 2</xref> for <italic>D. melanogaster</italic> (<xref ref-type="supplementary-material" rid="pone.0016526.s010">Table S7</xref> for <italic>A. thaliana</italic>), our TE classifier retrieved the appropriate classification for the reference TEs, thus predicting a correct classification for <italic>de novo</italic> consensus sequences. Moreover, each high-level category of the TE classification (<italic>e.g.</italic> “class I LTR-retrotransposon”, “class I LINE”, and “class II DNA transposon”) contained similar proportions of <italic>de novo</italic> consensus sequences and TE reference sequences from the BDGP or Repbase Update databanks. Thus, our procedure efficiently classified <italic>de novo</italic> consensus sequences into the appropriate high-level categories.</p>
        <table-wrap id="pone-0016526-t002" position="float">
          <object-id pub-id-type="doi">10.1371/journal.pone.0016526.t002</object-id>
          <label>Table 2</label>
          <caption>
            <title>TEclassifier results for the classification of <italic>D. melanogaster</italic> TE sequences.</title>
          </caption>
          <alternatives>
            <graphic id="pone-0016526-t002-2" xlink:href="pone.0016526.t002"/>
            <table frame="hsides" rules="groups">
              <colgroup span="1">
                <col align="left" span="1"/>
                <col align="center" span="1"/>
                <col align="center" span="1"/>
                <col align="center" span="1"/>
              </colgroup>
              <thead>
                <tr>
                  <td align="left" rowspan="1" colspan="1">Classification</td>
                  <td align="left" rowspan="1" colspan="1">Reference TEs from the BDGP</td>
                  <td align="left" rowspan="1" colspan="1"><italic>De novo</italic> consensus (with redundancy)</td>
                  <td align="left" rowspan="1" colspan="1"><italic>De novo</italic> consensus (without redundancy)</td>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td align="left" rowspan="1" colspan="1">Class I “complete” LTR retrotransposon</td>
                  <td align="left" rowspan="1" colspan="1">56</td>
                  <td align="left" rowspan="1" colspan="1">150</td>
                  <td align="left" rowspan="1" colspan="1">48</td>
                </tr>
                <tr>
                  <td align="left" rowspan="1" colspan="1">Class I “incomplete” LTR retrotransposon</td>
                  <td align="left" rowspan="1" colspan="1">2</td>
                  <td align="left" rowspan="1" colspan="1">377</td>
                  <td align="left" rowspan="1" colspan="1">209</td>
                </tr>
                <tr>
                  <td align="left" rowspan="1" colspan="1">Class I “complete” LINE</td>
                  <td align="left" rowspan="1" colspan="1">23</td>
                  <td align="left" rowspan="1" colspan="1">117</td>
                  <td align="left" rowspan="1" colspan="1">27</td>
                </tr>
                <tr>
                  <td align="left" rowspan="1" colspan="1">Class I “incomplete” LINE</td>
                  <td align="left" rowspan="1" colspan="1">17</td>
                  <td align="left" rowspan="1" colspan="1">147</td>
                  <td align="left" rowspan="1" colspan="1">57</td>
                </tr>
                <tr>
                  <td align="left" rowspan="1" colspan="1">Class I SINE</td>
                  <td align="left" rowspan="1" colspan="1">0</td>
                  <td align="left" rowspan="1" colspan="1">2</td>
                  <td align="left" rowspan="1" colspan="1">1</td>
                </tr>
                <tr>
                  <td align="left" rowspan="1" colspan="1">Class II “complete” DNA transposon</td>
                  <td align="left" rowspan="1" colspan="1">19</td>
                  <td align="left" rowspan="1" colspan="1">30</td>
                  <td align="left" rowspan="1" colspan="1">13</td>
                </tr>
                <tr>
                  <td align="left" rowspan="1" colspan="1">Class II “incomplete” DNA transposon</td>
                  <td align="left" rowspan="1" colspan="1">2</td>
                  <td align="left" rowspan="1" colspan="1">75</td>
                  <td align="left" rowspan="1" colspan="1">32</td>
                </tr>
                <tr>
                  <td align="left" rowspan="1" colspan="1">Class II MITE</td>
                  <td align="left" rowspan="1" colspan="1">0</td>
                  <td align="left" rowspan="1" colspan="1">8</td>
                  <td align="left" rowspan="1" colspan="1">5</td>
                </tr>
                <tr>
                  <td align="left" rowspan="1" colspan="1">Helitron</td>
                  <td align="left" rowspan="1" colspan="1">1</td>
                  <td align="left" rowspan="1" colspan="1">0</td>
                  <td align="left" rowspan="1" colspan="1">0</td>
                </tr>
                <tr>
                  <td align="left" rowspan="1" colspan="1">SSR</td>
                  <td align="left" rowspan="1" colspan="1">0</td>
                  <td align="left" rowspan="1" colspan="1">8</td>
                  <td align="left" rowspan="1" colspan="1">8</td>
                </tr>
                <tr>
                  <td align="left" rowspan="1" colspan="1">Host genes</td>
                  <td align="left" rowspan="1" colspan="1">0</td>
                  <td align="left" rowspan="1" colspan="1">26</td>
                  <td align="left" rowspan="1" colspan="1">11</td>
                </tr>
                <tr>
                  <td align="left" rowspan="1" colspan="1">Confused</td>
                  <td align="left" rowspan="1" colspan="1">1</td>
                  <td align="left" rowspan="1" colspan="1">20</td>
                  <td align="left" rowspan="1" colspan="1">6</td>
                </tr>
                <tr>
                  <td align="left" rowspan="1" colspan="1">No category</td>
                  <td align="left" rowspan="1" colspan="1">5</td>
                  <td align="left" rowspan="1" colspan="1">341</td>
                  <td align="left" rowspan="1" colspan="1">176</td>
                </tr>
                <tr>
                  <td align="left" rowspan="1" colspan="1">Total</td>
                  <td align="left" rowspan="1" colspan="1">126</td>
                  <td align="left" rowspan="1" colspan="1">1301</td>
                  <td align="left" rowspan="1" colspan="1">593</td>
                </tr>
              </tbody>
            </table>
          </alternatives>
        </table-wrap>
        <p>The proportion of <italic>de novo</italic> consensus sequences classified as “incomplete” was high. In <italic>D. melanogaster</italic>, 75% (45% in <italic>A. thaliana</italic>) of the <italic>de novo</italic> consensus sequences classified as “incomplete” LTR retrotransposons matched only with known LTR retrotransposons from Repbase Update but contained no long terminal repeats. All the <italic>de novo</italic> consensus sequences classified as “incomplete” LINE retrotransposons from <italic>D. melanogaster</italic> (28% of those from <italic>A. thaliana</italic>) matched only known LINE retrotransposons from Repbase Update, but with no polyA-/SSR-like tail. Among the <italic>de novo</italic> consensus sequences classified as “incomplete” DNA transposons, 50% of those from <italic>D. melanogaster</italic> (32% of those from <italic>A. thaliana</italic>) matched only known DNA transposons from Repbase Update, but with no TIR. Thus, these <italic>de novo</italic> consensus sequences are classified as “incomplete” in <italic>D. melanogaster</italic> mostly because they lack terminal features, which is not the case for most such consensus sequences in <italic>A. thaliana</italic>. Thus, the clustering programs combined in the TEdenovo pipeline do not generate systematic bias towards “incomplete” TEs of a given kind.</p>
        <p>Moreover, only a few consensus sequences were classified as “confused”, facilitating manual curation. For instance, one 635-bp long consensus sequence built by RECON from the <italic>D. melanogaster</italic> genome has long terminal repeats as well as a poly-A tail which is contradictory according to our classification scheme derived from <xref rid="pone.0016526-Wicker1" ref-type="bibr">[5]</xref>. The consensus sequences classified as “host genes” are detailed in <xref ref-type="supplementary-material" rid="pone.0016526.s011">Table S8</xref>. The high proportion of unclassified consensus sequences (“no category”) reflects the limitations of this classification scheme. We searched all these consensus sequences for HMM profiles specific to TEs. We detected fragments of known TE profiles in only 14% of these unclassified consensus sequences (data not shown). Several of the other corresponded to Helitron reference sequences recovered intact within unclassified <italic>de novo</italic> consensus sequences. Helitrons are difficult to detect as they have no clear structural features other than a terminal hairpin <xref rid="pone.0016526-Tempel1" ref-type="bibr">[49]</xref>. Nonetheless, our <italic>de novo</italic> approach recovered all those with at least three full-length copies in the genome. This confirms the relevance of the combined <italic>de novo</italic> approach as implemented in the TEdenovo pipeline and shows that <italic>de novo</italic> consensus sequences may correspond to TEs even if they remain unclassified by this method.</p>
        <p>As shown above, the combination of clustering programs gave better results than any single program. However, it also provided redundant consensus sequences. We therefore applied a redundancy elimination procedure, in which we considered a consensus sequence to be redundant if it was included in another sequence, over <italic>x</italic>% of its length, with an identity of more than <italic>y</italic>%. We first tested this procedure directly on the whole <italic>de novo</italic> databank. It resulted in the loss of many well classified consensus sequences that were shorter than the misclassified sequences. We therefore applied the redundancy procedure on the basis of the classification. We decided to remove redundant consensus sequences classified as “incomplete” when they were included within consensus sequences classified as “complete”, but not vice versa. The “80-80-80” rule <xref rid="pone.0016526-Wicker1" ref-type="bibr">[5]</xref> has been proposed as a means of identifying copies from the same TE family: two TE copies may be considered to belong to the same family if they are aligned, with 80% identity, over at least 80 bp and 80% of their respective lengths. However, as this rule was originally developed for TE copies and not for consensus sequences, we also tested more stringent parameters (<xref ref-type="supplementary-material" rid="pone.0016526.s012">Table S9</xref>). We found that the best strategy for obtaining a high-quality <italic>de novo</italic> databank with a low level of redundancy was to remove redundant consensus sequences with more stringent parameters: “95-80-98”. This implies that a consensus sequence is removed if it is included within another consensus sequence over 98% of its length, with an identity level exceeding 95%.</p>
      </sec>
      <sec id="s2b2">
        <title>Comparison of de novo and knowledge-based TE annotations</title>
        <p>After the first phase of analysis with the TEdenovo pipeline, we used the <italic>de novo</italic> TE consensus sequence databank to detect all TE fragments and to reconstruct each TE copy in the genome of interest. This annotation phase was achieved with the TEannot pipeline <xref rid="pone.0016526-Quesneville1" ref-type="bibr">[24]</xref> (<xref ref-type="supplementary-material" rid="pone.0016526.s002">Figure S2</xref>), which is also part of the REPET package. TEannot combines several programs for detecting TE fragments, filtering out false-positives and reconstructing intact TE copies. This process involves the connection of TE fragments from the same copy, a procedure also called “TE defragmentation”. While improving the robustness of this pipeline, we notably improved the connection of TE fragments in the MATCHER algorithm (see <xref ref-type="sec" rid="s4">Methods</xref>). For a comprehensive analysis of the performance of the <italic>de novo</italic> approach presented above, we used the TEannot pipeline on both the <italic>D. melanogaster</italic> and <italic>A. thaliana</italic> genomes, with several databanks of <italic>de novo</italic> consensus sequences, each obtained with a specific combination of programs from the TEdenovo pipeline. We first discarded the consensus sequences that could be unambiguously identified as SSRs or host genes. We then compared each annotation with that obtained with the reference TE libraries from the BDGP and Repbase Update databanks (<xref ref-type="table" rid="pone-0016526-t003">Table 3</xref>).</p>
        <table-wrap id="pone-0016526-t003" position="float">
          <object-id pub-id-type="doi">10.1371/journal.pone.0016526.t003</object-id>
          <label>Table 3</label>
          <caption>
            <title>TE annotation results obtained with reference databanks and <italic>de novo</italic> databanks.</title>
          </caption>
          <alternatives>
            <graphic id="pone-0016526-t003-3" xlink:href="pone.0016526.t003"/>
            <table frame="hsides" rules="groups">
              <colgroup span="1">
                <col align="left" span="1"/>
                <col align="center" span="1"/>
                <col align="center" span="1"/>
                <col align="center" span="1"/>
                <col align="center" span="1"/>
                <col align="center" span="1"/>
                <col align="center" span="1"/>
              </colgroup>
              <thead>
                <tr>
                  <td align="left" rowspan="1" colspan="1">Genome</td>
                  <td align="left" rowspan="1" colspan="1">TE databank</td>
                  <td align="left" rowspan="1" colspan="1">Consensus (having copies)</td>
                  <td align="left" rowspan="1" colspan="1">TE genome coverage</td>
                  <td align="left" rowspan="1" colspan="1">Number of copies</td>
                  <td align="left" rowspan="1" colspan="1">S<sub>n</sub>
</td>
                  <td align="left" rowspan="1" colspan="1">S<sub>p</sub>
</td>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td align="left" rowspan="1" colspan="1">
                    <italic>D. mel.</italic>
                  </td>
                  <td align="left" rowspan="1" colspan="1">BDGP</td>
                  <td align="left" rowspan="1" colspan="1">125</td>
                  <td align="left" rowspan="1" colspan="1">10.51%</td>
                  <td align="left" rowspan="1" colspan="1">31208</td>
                  <td align="left" rowspan="1" colspan="1">NA</td>
                  <td align="left" rowspan="1" colspan="1">NA</td>
                </tr>
                <tr>
                  <td align="left" rowspan="1" colspan="1">
                    <italic>D. mel.</italic>
                  </td>
                  <td align="left" rowspan="1" colspan="1">GROUPER</td>
                  <td align="left" rowspan="1" colspan="1">712</td>
                  <td align="left" rowspan="1" colspan="1">10.29%</td>
                  <td align="left" rowspan="1" colspan="1">43699</td>
                  <td align="left" rowspan="1" colspan="1">81.92%</td>
                  <td align="left" rowspan="1" colspan="1">98.12%</td>
                </tr>
                <tr>
                  <td align="left" rowspan="1" colspan="1">
                    <italic>D. mel.</italic>
                  </td>
                  <td align="left" rowspan="1" colspan="1">RECON</td>
                  <td align="left" rowspan="1" colspan="1">437</td>
                  <td align="left" rowspan="1" colspan="1">11.05%</td>
                  <td align="left" rowspan="1" colspan="1">33072</td>
                  <td align="left" rowspan="1" colspan="1">87.77%</td>
                  <td align="left" rowspan="1" colspan="1">97.95%</td>
                </tr>
                <tr>
                  <td align="left" rowspan="1" colspan="1">
                    <italic>D. mel.</italic>
                  </td>
                  <td align="left" rowspan="1" colspan="1">PILER</td>
                  <td align="left" rowspan="1" colspan="1">114</td>
                  <td align="left" rowspan="1" colspan="1">8.87%</td>
                  <td align="left" rowspan="1" colspan="1">32789</td>
                  <td align="left" rowspan="1" colspan="1">74.07%</td>
                  <td align="left" rowspan="1" colspan="1">98.79%</td>
                </tr>
                <tr>
                  <td align="left" rowspan="1" colspan="1">
                    <italic>D. mel.</italic>
                  </td>
                  <td align="left" rowspan="1" colspan="1">RepeatScout</td>
                  <td align="left" rowspan="1" colspan="1">1432</td>
                  <td align="left" rowspan="1" colspan="1">10.86%</td>
                  <td align="left" rowspan="1" colspan="1">42048</td>
                  <td align="left" rowspan="1" colspan="1">85.28%</td>
                  <td align="left" rowspan="1" colspan="1">97.88%</td>
                </tr>
                <tr>
                  <td align="left" rowspan="1" colspan="1">
                    <italic>D. mel.</italic>
                  </td>
                  <td align="left" rowspan="1" colspan="1">G+R+P</td>
                  <td align="left" rowspan="1" colspan="1">568</td>
                  <td align="left" rowspan="1" colspan="1">11.98%</td>
                  <td align="left" rowspan="1" colspan="1">42847</td>
                  <td align="left" rowspan="1" colspan="1">91.43%</td>
                  <td align="left" rowspan="1" colspan="1">97.35%</td>
                </tr>
                <tr>
                  <td align="left" rowspan="1" colspan="1">
                    <italic>A. tha.</italic>
                  </td>
                  <td align="left" rowspan="1" colspan="1">Repbase</td>
                  <td align="left" rowspan="1" colspan="1">318</td>
                  <td align="left" rowspan="1" colspan="1">19.02%</td>
                  <td align="left" rowspan="1" colspan="1">41146</td>
                  <td align="left" rowspan="1" colspan="1">NA</td>
                  <td align="left" rowspan="1" colspan="1">NA</td>
                </tr>
                <tr>
                  <td align="left" rowspan="1" colspan="1">
                    <italic>A. tha.</italic>
                  </td>
                  <td align="left" rowspan="1" colspan="1">GROUPER</td>
                  <td align="left" rowspan="1" colspan="1">1237</td>
                  <td align="left" rowspan="1" colspan="1">18.78%</td>
                  <td align="left" rowspan="1" colspan="1">41791</td>
                  <td align="left" rowspan="1" colspan="1">79.29%</td>
                  <td align="left" rowspan="1" colspan="1">95.43%</td>
                </tr>
                <tr>
                  <td align="left" rowspan="1" colspan="1">
                    <italic>A. tha.</italic>
                  </td>
                  <td align="left" rowspan="1" colspan="1">RECON</td>
                  <td align="left" rowspan="1" colspan="1">1004</td>
                  <td align="left" rowspan="1" colspan="1">23.69%</td>
                  <td align="left" rowspan="1" colspan="1">49470</td>
                  <td align="left" rowspan="1" colspan="1">88.75%</td>
                  <td align="left" rowspan="1" colspan="1">91.59%</td>
                </tr>
                <tr>
                  <td align="left" rowspan="1" colspan="1">
                    <italic>A. tha.</italic>
                  </td>
                  <td align="left" rowspan="1" colspan="1">PILER</td>
                  <td align="left" rowspan="1" colspan="1">300</td>
                  <td align="left" rowspan="1" colspan="1">13.14%</td>
                  <td align="left" rowspan="1" colspan="1">34818</td>
                  <td align="left" rowspan="1" colspan="1">56.56%</td>
                  <td align="left" rowspan="1" colspan="1">97.05%</td>
                </tr>
                <tr>
                  <td align="left" rowspan="1" colspan="1">
                    <italic>A. tha.</italic>
                  </td>
                  <td align="left" rowspan="1" colspan="1">RepeatScout</td>
                  <td align="left" rowspan="1" colspan="1">2893</td>
                  <td align="left" rowspan="1" colspan="1">21.95%</td>
                  <td align="left" rowspan="1" colspan="1">68958</td>
                  <td align="left" rowspan="1" colspan="1">82.91%</td>
                  <td align="left" rowspan="1" colspan="1">92.36%</td>
                </tr>
                <tr>
                  <td align="left" rowspan="1" colspan="1">
                    <italic>A. tha.</italic>
                  </td>
                  <td align="left" rowspan="1" colspan="1">G+R+P</td>
                  <td align="left" rowspan="1" colspan="1">1232</td>
                  <td align="left" rowspan="1" colspan="1">22.77%</td>
                  <td align="left" rowspan="1" colspan="1">44059</td>
                  <td align="left" rowspan="1" colspan="1">87.03%</td>
                  <td align="left" rowspan="1" colspan="1">92.32%</td>
                </tr>
              </tbody>
            </table>
          </alternatives>
          <table-wrap-foot>
            <fn id="nt102">
              <label/>
              <p>“<italic>D. mel.</italic>” stands for “<italic>D. melanogaster</italic>” and “<italic>A. tha.</italic>” stands for “<italic>A. thaliana</italic>”. The S<sub>n</sub> and S<sub>p</sub> columns correspond respectively to sensitivity and specificity results when comparing two annotations in terms of nucleotide overlaps. “G+R+P” indicates that the three programs GROUPER, RECON and PILER were used to build the databank of <italic>de novo</italic> consensus sequences.</p>
            </fn>
          </table-wrap-foot>
        </table-wrap>
        <p>In <italic>D. melanogaster</italic> (<xref ref-type="table" rid="pone-0016526-t003">Table 3</xref>), when using only one clustering method, the GROUPER databank delivered the annotation closest to that obtained with the BDGP reference databank in terms of genome coverage and copy number. Sensitivity was highest with the RECON databank and specificity was highest with the PILER databank. The annotation shows high sensitivity and specificity, together with a high level of genome coverage, for the combined approach. Similar conclusions were drawn from the annotations for <italic>A. thaliana</italic>. An examination of match boundaries (<xref ref-type="supplementary-material" rid="pone.0016526.s003">Figure S3</xref> and <xref ref-type="supplementary-material" rid="pone.0016526.s013">Table S10</xref>) showed that the clustering methods were complementary: GROUPER gave the largest number of exact matches in <italic>D. melanogaster</italic> whereas RECON gave the largest number of exact matches in <italic>A. thaliana</italic>. About RepeatScout, although the specificity of its annotation is very similar with our combined approach, its sensitivity is much lower. Moreover, based only on <xref ref-type="table" rid="pone-0016526-t003">Table 3</xref>, it may appear that using “RECON” gives similar results than using our combined “G+R+P” approach. However, as shown above in <xref ref-type="fig" rid="pone-0016526-g002">Figure 2</xref>, “RECON” is not able to fully recover several TE reference sequences which are fully recovered only by “GROUPER”, and reciprocally. Biologically speaking, it is better to recover a full TE reference sequence as one consensus sequence, rather than several truncated or artifactual consensus sequences. In this context, not only the “G+R+P” approach builds a better library of TE <italic>de novo</italic> consensus sequences, but such a library is also able to provide reliable TE annotation. Thus, the combination of clustering methods in the TEdenovo pipeline leads to the construction of a high-quality TE library delivering annotations similar to those obtained for manually curated databanks.</p>
        <p>We then compared the results of our analyses with those obtained with RepeatModeler (<ext-link ext-link-type="uri" xlink:href="http://www.repeatmasker.org/RepeatModeler.html">http://www.repeatmasker.org/RepeatModeler.html</ext-link>), which combines RECON, RepeatScout, RepeatMasker and TRF and classifies the consensus sequences obtained. For <italic>D. melanogaster</italic>, RepeatModeler generated a library of 141 consensus sequences, with a sensitivity of 78% and a specificity of 76%. However, the recovery ratio of RepeatModeler (R<sub>CC</sub> = 21%) was much lower than that of the TEdenovo pipeline (R<sub>CC</sub> = 72%). This indicates that RepeatModeler recovers only a few intact TE reference sequences. Similar results were obtained for <italic>A. thaliana</italic>, with all three measurements showing lower values with RepeatModeler than with TEdenovo (<xref ref-type="supplementary-material" rid="pone.0016526.s014">Table S11</xref>). Running the TEannot pipeline with the consensus sequences generated by RepeatModeler resulted in a sensitivity markedly lower than that for the annotations obtained with the <italic>de novo</italic> library from the TEdenovo pipeline, although specificity was slightly higher (<xref ref-type="supplementary-material" rid="pone.0016526.s015">Table S12</xref>). The combination of several tools is therefore not sufficient in itself to improve the results. The way in which the tools are chosen and combined is determinant. We conclude that the TEdenovo pipeline achieves a good balance between sensitivity and specificity in the <italic>de novo</italic> construction of a TE databank from raw genomic sequences.</p>
        <p>We therefore developed the REPET package available online (<ext-link ext-link-type="uri" xlink:href="http://urgi.versailles.inra.fr/index.php/repet">http://urgi.versailles.inra.fr/index.php/repet</ext-link>), into which we integrated both the TEdenovo and TEannot pipelines, with the TE classifier described above corresponding to the final step of the TEdenovo pipeline. The REPET package was specifically designed to improve speed and tractability by (i) interacting with MySQL tables at several key points to take advantage of the SQL language, and (ii) automatically handling jobs launched in parallel on a cluster <italic>via</italic> free batch-queuing systems, such as the Sun Grid Engine (now known as Oracle Gene Engine), relaunching jobs in cases of cluster node failure. This package is thus specifically implemented for computationally intensive, genome-wide analyses that do not compromise the biological relevance of the results (see <xref ref-type="supplementary-material" rid="pone.0016526.s016">Table S13</xref> for details about computation times). As already pointed out by several authors, tools for <italic>de novo</italic> TE identification are “quite difficult to use, indicating the need for better user interfaces and auto-optimization” <xref rid="pone.0016526-Saha1" ref-type="bibr">[32]</xref>. We facilitated the use of our tools, by concealing technical details behind interfaces, one per pipeline. The user is also provided with access to a detailed tutorial and a configuration file with default parameters.</p>
      </sec>
      <sec id="s2b3">
        <title>Identification of structural variation within TE families and manual curation</title>
        <p>After annotating the TE copies in both genomes, we investigated the structural diversity within TE families, as represented by the large number of <italic>de novo</italic> consensus. We focused on the TE families for which the “knowledge-based” consensus was fully recovered by only one clustering method, GROUPER or RECON, as shown in <xref ref-type="fig" rid="pone-0016526-g002">Figure 2</xref> (see also <xref ref-type="supplementary-material" rid="pone.0016526.s017">Table S14</xref> and <xref ref-type="supplementary-material" rid="pone.0016526.s018">Table S15</xref>). Indeed, the failure of one method (either GROUPER or RECON) to recover all the TEs would illustrate differences in the ability of these methods to take TE structural variations into account. For each of these TE families, we retrieved genomic copies detected by the <italic>de novo</italic> consensus and built multiple alignments (see <xref ref-type="sec" rid="s4">Methods</xref>). <xref ref-type="fig" rid="pone-0016526-g004">Figure 4</xref> (cases a, b, c and d) provides an overview of several of these multiple alignments displaying extensive structural variations. In almost all TE families, differences between genomic copies were observed, due to substitutions and indels. The clustering method generated different clusters as a function of these differences and the fragmentation of the copies. Depending on the specific features of each algorithm, the consensus will correspond to the complete TE reference sequence or a truncated version of that sequence.</p>
        <p>We then looked for features particular to the TE families for which the reference sequence was fully recovered by only one clustering method, being recovered only partially with another method. We first compared the classification of these TE reference sequences. In <italic>D. melanogaster</italic>, the four TE reference sequences fully recovered only by GROUPER were all LTR retrotransposons, whereas the nine TE reference sequences fully recovered only by RECON comprised four LTR retrotransposons, three LINE retrotransposons and two DNA transposons. In <italic>A. thaliana</italic>, the eight TE reference sequences fully recovered only by GROUPER comprised five LTR retrotransposons and three DNA transposons, whereas the fifteen TE reference sequences fully recovered only by RECON comprised six LTR retrotransposons, eight DNA transposons and one Helitron. There were therefore no clear differences in the recovery of full-length TE reference sequences obtained with different clustering methods. We also looked for differences in terms of copy number. However, the TE reference sequences fully recovered only by GROUPER or only by RECON had similar numbers of full-length and truncated copies (data not shown). Comparisons of <italic>de novo</italic> consensuses and “knowledge-based” consensuses, as in <xref ref-type="table" rid="pone-0016526-t001">Table 1</xref>, showed that RECON was systematically the most sensitive method, whereas GROUPER was systematically the most specific. As a result, several TE reference sequences displayed partial matches with <italic>de novo</italic> consensuses from RECON only. Moreover, almost 50% of the <italic>de novo</italic> consensus sequences from RECON lacked both boundaries of the TE reference sequences, versus less than 20% of the consensus sequences from GROUPER. Conversely, a <italic>de novo</italic> library from GROUPER is likely to match with fewer TE reference sequences, but, when a match does occur, at least one boundary of the reference is likely to be correctly retrieved. Consequently, GROUPER and RECON are truly complementary, making the combined approach implemented in the TEdenovo pipeline very efficient.</p>
        <p>Our TE classifier can combine <italic>de novo</italic> consensus sequences from various sources, but manual curation is still required in some cases, particularly when there are several consensus sequences related to the same TE family (<xref ref-type="supplementary-material" rid="pone.0016526.s019">Table S16</xref>). <xref ref-type="fig" rid="pone-0016526-g004">Figure 4</xref> (alignments E to H) shows several examples in which manual curation of the <italic>de novo</italic> consensus sequences identified by GROUPER and RECON for a given TE family improves the recovery of the reference sequence. For instance, in <xref ref-type="fig" rid="pone-0016526-g004">Figure 4-E</xref>, all consensus sequences from RECON are truncated before the 3′ LTR of the ATLANTYS2 element whereas the G1184 consensus sequence from GROUPER connects this LTR with part of the internal region of the element. In <xref ref-type="fig" rid="pone-0016526-g004">Figure 4-F</xref>, two consensuses can be removed, G512 from GROUPER, a a solo-LTR, and G803, which is chimeric. Moreover, we can add the internal region of the element present in G1497, which lacks the 3′ LTR, to the truncated R474 from RECON. A similar strategy can be applied in <xref ref-type="fig" rid="pone-0016526-g004">figures 4-G and 4-H</xref>. Thus, although it is not always possible to recover the full reference sequence, we can improve the final <italic>de novo</italic> consensus by manual curation, making use of the multiple alignment of classified consensuses to guide informed decision-making.</p>
        <p>The TEdenovo pipeline identified putative new TEs in the <italic>D. melanogaster</italic> and <italic>A. thaliana</italic> genomes, despite the intensity with which these genomes have been studied and annotated manually. Indeed, we found <italic>de novo</italic> consensus sequences that were classified as “complete” TE but had no single match in blastn with known TE reference sequences from the BDGP or Repbase Update databanks. Three such sequences were identified in <italic>D. melanogaster</italic> (two from GROUPER and one from RECON), and four in <italic>A. thaliana</italic> (three from RECON and one from PILER). For example, in <italic>D. melanogaster</italic>, a 7.8 kb <italic>de novo</italic> consensus was classified as a “complete” LTR retrotransposon on the basis of its two long terminal repeats (each 510 nt long) and its matches with known LTR retrotransposons from Repbase Update in tblastx and blastx analyses. Furthermore, this consensus matched two HMM profiles corresponding to an integrase and an aspartic proteinase. There were four full-length copies in the genome, two of which retained their target site duplications. This <italic>de novo</italic> consensus sequence is probably non autonomous, as it lacks matches with HMM profiles corresponding to other LTR retrotransposon genes, and, notably, displays no match with a reverse transcriptase. However, it has enough of the typical properties of TEs and enough full-length copies to correspond to a true TE, rather than a mere segmental duplication containing TE fragments.</p>
      </sec>
    </sec>
  </sec>
  <sec id="s3">
    <title>Discussion</title>
    <sec id="s3a">
      <title>Combining approaches to build high-quality TE <italic>de novo</italic> consensus sequence databanks for sequenced genomes</title>
      <p>Transposable elements play a key role in the structure and evolution of genomes, but their impact remains to be fully elucidated. If we are to make use of the increasing numbers of genome sequencing projects to improve our understanding of TE biology, we will need an efficient, automatic <italic>de novo</italic> approach for the annotation of genome TE content. Several methods praised for their rapidity and low memory requirements, such as the MDR index <xref rid="pone.0016526-Kurtz1" ref-type="bibr">[50]</xref>, and P-clouds <xref rid="pone.0016526-Gu1" ref-type="bibr">[51]</xref>, provide a good overview of the repeat content of a given genome. However, they are not precise enough to provide insight into the functional impact of TEs (see for instance <xref rid="pone.0016526-Newman1" ref-type="bibr">[52]</xref> and <xref rid="pone.0016526-Teixeira1" ref-type="bibr">[53]</xref>). As such, these methods are good starting points but are inadequate for a full exploration of biological questions relating to TEs.</p>
      <p>The typical process of TE annotation, as we see it, should involve the identification of all TE copies throughout the genome and proceed in two phases. The first step is the construction of a <italic>de novo</italic> library of TE consensus sequences representing the TE families present in the genome. This library is then used to mine all the TE fragments present in the genome. The TE copies are then reconstructed, usually nested within each other, to unravel their intricate evolution. We describe here a new strategy for constructing databanks of TE consensus sequences by <italic>de novo</italic> methods. Our results for the <italic>D. melanogaster</italic> and <italic>A. thaliana</italic> genomes show that an approach combining several clustering programs provides the best outcome, in terms of sensitivity and specificity, for the identification of TE families and the annotation of their TE copies.</p>
      <p>Previous studies have already compared tools for <italic>de novo</italic> TE identification, either to propose a new algorithm (as for RECON, PILER and RepeatScout) or to help experimental biologists to use the most suitable tools for their analysis <xref rid="pone.0016526-Saha1" ref-type="bibr">[32]</xref>. In most of these studies, the results were validated by comparing the final TE copy annotations in terms of genome coverage, rather than by evaluating the accuracy of <italic>de novo</italic> TE consensus sequence identification. Little attention has been paid to analyses of the <italic>de novo</italic> databank itself. The use of consensus sequences corresponding to truncated or artifactual TEs would clearly bias subsequent annotations. We therefore propose three indices for measuring the quality of <italic>de novo</italic> databanks, with respect to reference databanks. This combined approach was validated by considering the proportion of <italic>de novo</italic> consensus sequences corresponding to full-length reference sequences, with well-defined boundaries.</p>
    </sec>
    <sec id="s3b">
      <title>Classification of TE sequences on the basis of their biological features and the curation of TE <italic>de novo</italic> databanks</title>
      <p>The tools typically used for the <italic>de novo</italic> identification of TE families provide no additional meta-data about the consensus sequences they build. Instead, the user has to use other tools to obtain a putative classification of the sequences obtained. Here, we implemented a combined <italic>de novo</italic> approach for the identification of TE families and developed a dedicated procedure for classifying sequences on the basis of TE features. We based our TE classifier on the classification proposed in <xref rid="pone.0016526-Wicker1" ref-type="bibr">[5]</xref>, from class to superfamily, combining various sources of information about TEs in a modular manner. This procedure was designed to be run in isolation for the analysis of any databank of putative TE-related sequences and for integration into the TEdenovo pipeline, to facilitate its use.</p>
      <p>The current version of our tool, TEclassifier, requires further improvement for the classification of less well known TEs, such as DIRS-like elements, Penelope-like elements, Crypton elements and Polintons/Mavericks. However, unlike tools like TEclass <xref rid="pone.0016526-Abrusan1" ref-type="bibr">[54]</xref>, which makes use of the profiles of frequent <italic>k</italic>-mers from the Repbase Update databank, our TE classifier guides output classification by detailing the precise TE features present on the analyzed sequences, such as terminal repeats and matches with known TEs. Our tool and REPclass <xref rid="pone.0016526-Feschotte2" ref-type="bibr">[55]</xref> are very similar, but our TE classifier has several advantages. Being part of the REPET package, it benefits from the architecture of this package and is therefore able to handle large databanks, which is often required when studying large genomes. Moreover, our TE classifier not only classifies putative TEs, it also makes it possible to filter out false-positives and to remove redundant sequences present in the input databank.</p>
      <p>In a wider perspective, we considered manual curation, a key topic in genome annotation. Computer-based predictions for the annotations of protein-coding genes are now of high quality, but it remains difficult to predict exon-intron boundaries correctly <xref rid="pone.0016526-Brent1" ref-type="bibr">[56]</xref>. Major efforts have been and are being made to improve the automatic annotation of protein-coding regions, but such efforts have been much less intensive for other parts of the genome, including TEs. In this study, we tried to fill this gap by designing the REPET package for the comprehensive association of all the meta-data obtained for a given TE family: (i) the <italic>de novo</italic> consensus sequences, (ii) the TE features used to classify them, (iii) the all-by-all comparisons from which they were built, and (iv) the TE copies they identify on the chromosomes. As a result, the manual curator can make informed decisions based on the biological features at hand, and the curated TE consensus databank can be used to provide a second release of TE annotations.</p>
    </sec>
    <sec id="s3c">
      <title>Efficiency of <italic>de novo</italic> approaches for recovering ancestral TEs and their structural variants from “junk”</title>
      <p>At the core of any <italic>de novo</italic> approach lies the possibility of identifying new agents in a given system by searching for their fundamental properties. In our case, we were confronted with raw whole-genome sequences containing numerous repeated sequences of different kinds, some of which have specific features and a common ancestry. We were interested in identifying, from among these sequences, TEs — interspersed repeats — and, more particularly, the ancestral sequences that actually transposed. The current copies of such sequences are likely to be divergent, fragmented and nested within each other, as TE families typically display extensive structural variation (<xref ref-type="fig" rid="pone-0016526-g004">Figure 4 A–D</xref>). We showed in this study that the <italic>de novo</italic> approach could recover some full-length TE sequences by correctly collecting together their fragments, even if no TE feature could be used to classify them. This was the case here for several Helitron reference sequences in the <italic>A. thaliana</italic> genome. Similarly, we were able to identify putative new non autonomous TEs in the <italic>D. melanogaster</italic> and <italic>A. thaliana</italic> genomes that had all the essential features of TEs but were nonetheless absent from the reference databanks.</p>
      <p>Efficient and robust tools are essential to keep pace with current whole-genome sequencing programs. Our analyses were performed on small model genomes. However, the <italic>de novo</italic> approach and the tools we presented here are scalable, at least to genomes reaching 500 Mb. Indeed, preliminary versions of the TEdenovo and TEannot pipelines were used to annotate the TE content of the 464-Mb aphid genome totalizing 38% of TEs <xref rid="pone.0016526-The2" ref-type="bibr">[31]</xref>. Moreover, our tools are modular and almost all steps can be launched in parallel, thus taking advantage of today's computer clusters. Future work will be dedicated to the improvement of the clustering step in the TEdenovo pipeline in order to provide, also to very large genomes, the ability to jointly annotate TEs and study their diversification. For all projects in which the aim is to sequence large and highly repetitive genomes (<italic>e.g.</italic> barley, hexaploid wheat), computational tools, such as the TEdenovo pipeline presented here, are likely to become increasingly useful for increasing our knowledge of the evolution of genome structure and the functional impact of TEs on neighboring genes.</p>
    </sec>
  </sec>
  <sec sec-type="methods" id="s4">
    <title>Methods</title>
    <sec id="s4a">
      <title>Genome sequences and TE reference databanks as benchmark</title>
      <p>In 2000, an international consortium driven by the Berkeley Drosophila Genome Project (BDGP) sequenced, assembled and annotated the genome of an isogenic <italic>y</italic>; <italic>cn bw sp</italic> strain of <italic>D. melanogaster</italic>
<xref rid="pone.0016526-Adams1" ref-type="bibr">[57]</xref>, this work now being continued at FlyBase (<ext-link ext-link-type="uri" xlink:href="http://flybase.org/">http://flybase.org/</ext-link>). In this study, we used the 118.4 Mb release 4 genome sequence corresponding mostly to euchromatin regions. Release 5 became available in 2006 and corresponds to release 4 with 50.3 Mb of additional heterochromatic regions and minor sequence corrections. We chose to work on release 4, which remains the <italic>D. melanogaster</italic> genomic sequence best annotated for TEs <xref rid="pone.0016526-Quesneville1" ref-type="bibr">[24]</xref>, <xref rid="pone.0016526-Bergman1" ref-type="bibr">[25]</xref>, despite the availability of the later sequence.</p>
      <p>Flybase provides a set of natural TE sequences experimentally identified in several Drosophilidae genomes. The latest version of this data set (bdgp9.41) consists of 179 sequences corresponding to different TE families, 126 of which have been detected in <italic>D. melanogaster</italic> strains. Each of these 126 sequences corresponds either to a TE copy of the given family present in <italic>D. melanogaster</italic> or to a consensus based on TE copies for the family concerned. In the latter case, consensuses were built either as a mosaic of TE copies or following a “majority rule” from a multiple alignment. In this study, these 126 sequences are referred to as “reference TEs”. The aim of the <italic>de novo</italic> approach presented in this article is to reconstruct such a library of TE sequences.</p>
      <p>In 2000, 115 Mb of the 125 Mb genome of <italic>A. thaliana</italic> accession Columbia had been sequenced, assembled and annotated <xref rid="pone.0016526-The3" ref-type="bibr">[58]</xref>. For our analyses, we used the 119 Mb of <italic>A. thaliana</italic> release 9 genome sequences available from the TAIR website (<ext-link ext-link-type="uri" xlink:href="http://www.arabidopsis.org/">http://www.arabidopsis.org/</ext-link>). For <italic>A. thaliana</italic>, a similar set of reference TEs is present in the Repbase Update databank. We used the library derived from this databank for previous studies <xref rid="pone.0016526-Buisine1" ref-type="bibr">[29]</xref> and containing 318 TE sequences.</p>
      <p>We annotated both genomes with the TEannot pipeline <xref rid="pone.0016526-Quesneville1" ref-type="bibr">[24]</xref> using the reference databanks cited above. We then constructed a consensus for each reference sequence, from the multiple alignment of copies when at least three copies longer than 100 bp were present (<xref ref-type="supplementary-material" rid="pone.0016526.s020">Table S17</xref>). For <italic>D. melanogaster</italic>, a consensus could be obtained for only 117 of the 126 reference sequences in the BDGP databank, referred to as a “knowledge-based” consensus: 68 of these sequences corresponded exactly to their reference element, the others being truncated. For <italic>A. thaliana</italic>, it was possible to construct 305 “knowledge-based” consensuses for the 318 TE reference sequences in the Repbase Update databank: 154 corresponded to the entire element and the others were truncated. These consensuses were collected into “knowledge-based” databanks. As such, they represent the upper limit of what can be retrieved with the <italic>de novo</italic> methods compared in this study (<xref ref-type="supplementary-material" rid="pone.0016526.s021">Table S18</xref>).</p>
    </sec>
    <sec id="s4b">
      <title><italic>De novo</italic> detection of TEs</title>
      <p>A three-step approach forms the backbone of our analysis: (i) self-alignment of the genomic sequences, (ii) clustering of the resulting matches, and (iii) multiple alignments of each cluster to build a consensus (<xref ref-type="supplementary-material" rid="pone.0016526.s001">Figure S1</xref>). Different programs may be used at each step, leading to several possible combinations. For each combination, we compared the <italic>de novo</italic> consensus with the set of reference TEs. Other methods are also available for constructing a consensus for comparison with the “knowledge-based” databanks constructed as described above.</p>
      <p>When comparing a <italic>de novo</italic> databank with a “knowledge-based” databank, it is not possible to calculate the number of false-negatives, <italic>i.e.</italic> the <italic>de novo</italic> consensus sequences incorrectly classified as not related to a TE because these consensus sequences are not present in the <italic>de novo</italic> library. The usual definitions of sensitivity and specificity are therefore not directly applicable. We estimated sensitivity by calculating the proportion of “knowledge-based” consensus sequences matching <italic>de novo</italic> consensus sequences (noted S<sub>n</sub>*). We then estimated specificity by considering the proportion of <italic>de novo</italic> consensus sequences matching “knowledge-based” consensus sequences (noted S<sub>p</sub>*). The observation of a <italic>de novo</italic> consensus that matches a “knowledge-based” consensus, both aligned along their entire lengths (+- 5%) indicates that this <italic>de novo</italic> consensus retrieved the exact and entire “knowledge-based” consensus. A recovery ratio (noted R<sub>CC</sub> for “complete-complete ratio”) can be calculated as the number of “knowledge-based” consensus sequences exactly retrieved by a <italic>de novo</italic> consensus, divided by the number of reference sequences exactly retrieved by a “knowledge-based” consensus. In <italic>D. melanogaster</italic>, 68 reference sequences (of the 126 in the BDGP databank) were exactly retrieved by a “knowledge-based” consensus, and 154 such sequences (of the 318 in Repbase Update) were exactly retrieved in <italic>A. thaliana</italic>. As an illustration, in <italic>D. melanogaster</italic>, if a given <italic>de novo</italic> method recovers 60 entire “knowledge-based” consensus sequences from a given genome, R<sub>CC</sub> would be 88% (60/68).</p>
      <sec id="s4b1">
        <title>First step: self-alignment of the genomic sequences</title>
        <p>The first step is the self-alignment of the genomic sequences in an all-by-all manner. We compared two programs, BLASTER <xref rid="pone.0016526-Quesneville3" ref-type="bibr">[36]</xref> and PALS <xref rid="pone.0016526-Rasmussen1" ref-type="bibr">[38]</xref> for this purpose. BLASTER is a wrapper for the BLAST softwares <xref rid="pone.0016526-Altschul1" ref-type="bibr">[37]</xref>. It was used for comparisons at the genome scale. It begins by cutting long queries into batches and launching them in parallel against the subject databank. The second program, PALS, implements a filter algorithm. It first finds all exact matches of length <italic>q</italic> between the query and subject sequences. It then restricts the search by identifying regions (parallelograms in the alignment matrix) containing a number of hits above a given threshold. Finally, if these regions have a length above a given threshold, PALS develops a chain of hits for each region, aligns the nucleotides and returns the coordinates of the resulting matches. For BLASTER, we kept matches with E-value below 10<sup>−300</sup>, a length exceeding 100 bp and an identity exceeding 90% (parameters “-E 1e-300 -L 100 -I 90”). For PALS, we used the default parameters: identity exceeding 94% and a length of more than 400 bp (parameters “-length 400 -pctid 94”). If the same parameters were used for BLASTER (identity &gt;90% and length &gt;100 bp), the computations took too long, even when launched in parallel. If the parameters length &gt;100 bp and identity &gt;94% were used with both programs, BLASTER still gave better results (data not shown).</p>
        <p>When all the matches had been retrieved, we discarded all those that were more than 20,000 bp long. This procedure was designed to filter out repeats corresponding to long segmental duplications. The issue of short segmental duplications was addressed in the next step. To speed up the computations, the input genome sequences were cut into chunks of length 200 kb with 10kb overlaps. These values are parameters of the tool and can thus be changed easily, according to the genome size, its repeat content, as well as technical details such as the number of nodes in the computer cluster. Each chunk was then aligned against the whole set of chunks, in parallel. Finally all the matches were collected together and redundant matches were filtered out.</p>
      </sec>
      <sec id="s4b2">
        <title>Second step: clustering of the resulting pairwise alignments</title>
        <p>The matches obtained in the first step were then clustered, and we tested three different programs for this step: GROUPER (<xref rid="pone.0016526-Quesneville3" ref-type="bibr">[36]</xref>, parameters “-j -C 0.95 -Z 3 -X 2 -G -1”), RECON (<xref rid="pone.0016526-Bao1" ref-type="bibr">[39]</xref>, default parameters) and PILER (<xref rid="pone.0016526-Edgar1" ref-type="bibr">[40]</xref>, parameter “-trs”).</p>
        <p>As TEs are frequently inserted within each other, GROUPER first aims at retrieving the full-length copies by connecting their fragments <italic>via</italic> a dynamic programming algorithm applied to the pairwise alignments. It links together, in chains, the matches corresponding to fragments belonging to the same TE copy but interrupted by indels. It then uses single-link clustering to gather similar chains of matches into the same cluster, using a high-coverage constraint (95%), and merges chains corresponding to the same locus. The use of a high-coverage constraint makes it possible to identify different structural variants from a given TE family (<xref ref-type="fig" rid="pone-0016526-g001">Figure 1</xref>): two copies from two different variants overlap by less than 95% threshold, and are therefore assigned to different clusters. The previous version of GROUPER suffered from the high redundancy among clusters, preventing its usage in practice on large genomes. Therefore, we implemented a new procedure that specifies, during the single-link clustering step, if a chain of matches is fully included within another one, as is often the case with non-autonomous TEs with respect to their autonomous counterparts. Once the clusters are built, we now remove those having less than a given number of members not included in any others (option “-X 2”).</p>
        <p>RECON uses a different strategy, first trying to infer the ancestral TE copies, named “elements”, from all the fragments at each locus. It does this by single-link clustering with a low-coverage constraint (50%), followed by an additional procedure focusing on the aggregation of endpoints to ensure the correct handling of composite elements, such as segmental duplications. It then gathers the “elements” into families again by single-link clustering, but this time with a high-coverage constraint (90%), and a procedure is then applied to deal with families that are related but different, based on length ratio and similarity thresholds.</p>
        <p>We also tested the PILER suite of programs. In this work, “PILER” refers systematically to PILER-DF, which focuses on interspersed repeats. PILER first defines “piles” as lists of matches covering a maximal contiguous region. It then globally aligns these piles, rather than the individual matches themselves. This prevents bias towards the shortest match in the pile. Finally, piles that cannot be globally aligned with each other over 95% of their length are gathered into clusters.</p>
        <p>All these three programs, GROUPER, RECON and PILER, return a set of clusters to which we applied several filters. First, we removed the clusters with fewer than three members. This discarded most of the short segmental duplications. Second, for large clusters, we retained only the 20 longest sequences, as keeping all the sequences would not add much information for the building of a consensus and would even introduce noise (data not shown). Third, for GROUPER, we filtered the sequences resulting from connected matches (<italic>i.e.</italic> chains) with a cumulative length greater than 20 kb and spanning more than 30 kb of the genome, as such sequences probably corresponded to segmental duplications.</p>
      </sec>
      <sec id="s4b3">
        <title>Third step: multiple alignments and consensus construction</title>
        <p>Finally, for each cluster, a multiple sequence alignment (MSA) was constructed, from which a consensus was derived. We compared several programs: MAP (<xref rid="pone.0016526-Huang1" ref-type="bibr">[42]</xref>, parameters “gap-size = 50 mismatch = −8 gap-open = 16 gap-extend = 4”), CLUSTAL-W (<xref rid="pone.0016526-Thompson1" ref-type="bibr">[43]</xref>, default parameters), MAFFT (<xref rid="pone.0016526-Katoh1" ref-type="bibr">[44]</xref>, parameter “–auto”) and PRANK (<xref rid="pone.0016526-Loytynoja1" ref-type="bibr">[45]</xref>, parameter “-F”). The consensus was constructed by applying a majority rule discarding columns in which all but one sequence had a gap.</p>
        <p>MAP was specifically designed to handle long gaps. Such gaps frequently occur when aligning TE copies of different lengths from the same TE family. In this program, gaps are not penalized beyond a given length. CLUSTAL-W is a well known progressive MSA algorithm, and was the first to propose position-specific gap penalties. MAFFT addresses the issue of CPU time by using Fast Fourier Transform for the rapid detection of homologous segments. It also implements a normalized similarity matrix that is said to perform better for alignments with sequences of different lengths. This program was the fastest MSA program we tested. PRANK takes into account the phylogenetic information contained in indels to distinguish insertions from deletions, to position them properly and avoid the overestimation of deletions. This sophistication renders PRANK much slower than MAP (10 times slower for a typical cluster containing 16 sequences of 8 kb each).</p>
      </sec>
      <sec id="s4b4">
        <title>Other approaches</title>
        <p>Other methods have also been proposed. We tested REPEATSCOUT <xref rid="pone.0016526-Price1" ref-type="bibr">[46]</xref> and RepeatModeler (Smit and Hubley unpublished), both with default parameters. RepeatScout begins by keeping high-frequency strings of length <italic>k</italic>, called <italic>k</italic>-mers. The program initially takes the most frequent <italic>k</italic>-mer and sets the consensus as being the <italic>k</italic>-mer in question. Based on the multiple alignment of all its occurrences, the program extends this consensus one nucleotide at a time, in both directions, according to a specific scoring function. For correct definition of the consensus boundaries, the scoring function is designed to allow extension of the consensus, even if shared by some alignments, but not all. Once the consensus can be extended no further, the program detects all its occurrences in the genome, and updates the initial table of <italic>k</italic>-mer frequencies accordingly. This procedure is applied iteratively for each <italic>k</italic>-mer with a frequency above a given threshold.</p>
      </sec>
    </sec>
    <sec id="s4c">
      <title>Classification of TE consensus and the elimination of redundancy</title>
      <p>We implemented a two-step TE classifier. The first step detects structural features of the consensus, such as terminal repeats, tandem repeats, and polyA or SSR-like tails, using programs from the REPET package (TRsearch, polyAtail) or elsewhere (TRF, <xref rid="pone.0016526-Benson1" ref-type="bibr">[59]</xref>). It also searches for matches with known TEs, by blastx, tblastx and blastn analysis, and for matches with known genes from the host's genome, by blastn analysis. The second step is based on a decision tree (<xref ref-type="fig" rid="pone-0016526-g003">Figure 3</xref>) classifying each consensus according to its length and features. The classification and the evidence underlying the classification are delivered as output. Any program looking for other TE features, such as Helitron hairpins, could easily be integrated into this framework.</p>
      <p>We eliminated redundant consensus sequences, by discarding all those included within another consensus sequence, for at least <italic>x</italic>% of their length, and with at least <italic>y</italic>% identity. We tested several values for <italic>x</italic> and <italic>y</italic>: 95-98, 90-90 and 80-80. We tested this procedure with and without taking into account the classification of the sequences.</p>
    </sec>
    <sec id="s4d">
      <title>Genome-wide annotation of TE copies</title>
      <p>A combined pipeline named TEannot for the genome-wide annotation of TE copies is already available <xref rid="pone.0016526-Quesneville1" ref-type="bibr">[24]</xref> (<xref ref-type="supplementary-material" rid="pone.0016526.s002">Figure S2</xref>). As input, it takes the genome sequences and a databank of TE sequences, typically that generated by the TEdenovo pipeline. It then launches BLASTER <xref rid="pone.0016526-Quesneville3" ref-type="bibr">[36]</xref>, RepeatMasker (<ext-link ext-link-type="uri" xlink:href="http://www.repeatmasker.org/">http://www.repeatmasker.org/</ext-link>) and CENSOR <xref rid="pone.0016526-Jurka2" ref-type="bibr">[60]</xref>, to map the TE sequences against the genome. False-positives are filtered out by applying the same procedure to shuffled genomic sequences. More precisely, the genomic sequences are randomized using the “shuffle” program of the HMMER package (<ext-link ext-link-type="uri" xlink:href="http://hmmer.janelia.org/">http://hmmer.janelia.org/</ext-link>). The TE reference sequences are then mapped onto these shuffled sequences with BLASTER, RepeatMasker and CENSOR, with the score for each match recorded. Finally, the matches between the TE reference sequences and the true genomic sequences are filtered according to these scores. Whereas in a previous version of the pipeline we used the highest score obtained on randomized genomic sequences to filter false-positives, we now use the 95% quantile of the scores obtained on the randomized sequences. This improvement prevents excessive filtering, using a single, very good match on randomized sequences, much better than most others. This change slightly increases TE coverage over previous estimations.</p>
      <p>Once the matches were filtered, we began to reconstruct the TE copies, to obtain a true annotation of TE copies and not of TE fragments only. In this pipeline, two steps are used to connect several TE fragments belonging to the same TE copy: MATCHER <xref rid="pone.0016526-Quesneville3" ref-type="bibr">[36]</xref> and the “long join” procedure. As in the <italic>de novo</italic> library, a TE family may be represented by several consensus sequences corresponding to each of its structural variants. We improved these tools to take this into account. In terms of vocabulary, we define a “TE fragment” as a match between a TE consensus sequence and a genomic sequence, whereas we define a “TE copy” as a chain of matches, each match in the chain being a TE fragment. Note that a full-length TE copy may correspond to two TE fragments, which, when connected together, correspond to the full TE consensus sequence.</p>
      <p>In the previous version of MATCHER, we began by combining the matches found by all three algorithms mentioned above. When two consensus sequences overlapped at a given locus, we retained the sequence with the highest score and truncated the other. We then connected the remaining matches by dynamic programming. In the current version of MATCHER, we first connect the matches by dynamic programming and then filter out overlapping chains of matches. A match that might have been filtered out in the previous version may not be filtered out in the current version, if it is chained with another match, thereby improving fragment connections. TE annotations would be improved by taking into account chains of matches (whole TE copies) rather than TE fragments (single matches).</p>
      <p>Once matches are connected by MATCHER, the TEannot pipeline also detects microsatellites by launching and combining the results of TRF <xref rid="pone.0016526-Benson1" ref-type="bibr">[59]</xref>, Mreps <xref rid="pone.0016526-Kolpakov1" ref-type="bibr">[61]</xref> and RepeatMasker. All TE copies are then combined with microsatellite coordinates to filter out short TE matches fully recovered by microsatellites.</p>
      <p>In the same spirit, we improved the “long join” procedure. We previously sorted the chains of matches on the basis of length, as a proxy for the age of the TE copies. The rationale behind this was that a TE copy may disappear slowly due to small deletions, becoming shorter over time. We now estimate the age of a TE copy by calculating the ratio of match identity to match length, summing this ratio for all matches in the chain.</p>
      <p>Finally, we compared the annotations obtained with <italic>de novo</italic> libraries and reference databanks, by calculating genome coverage and TE copy number, together with sensitivity and specificity, in terms of nucleotide overlaps (<xref ref-type="supplementary-material" rid="pone.0016526.s003">Figure S3</xref>). A high sensitivity indicates that the annotation based on <italic>de novo</italic> consensus sequences misses few TE nucleotides (false-negatives). A high specificity indicates that the <italic>de novo</italic> annotation identifies few non-TE nucleotides (false-positives).</p>
    </sec>
    <sec id="s4e">
      <title>Reconstruction of TE families</title>
      <p>We compared the patterns of diversification between TE families, by mining the genome with the <italic>de novo</italic> consensus sequences, using BLAT <xref rid="pone.0016526-Kent1" ref-type="bibr">[62]</xref> for the rapid identification of well conserved genomic copies. We then constructed a multiple alignment with the TE reference sequence from the public databank, the <italic>de novo</italic> consensus sequence and the genomic copies identified with this sequence (see <xref ref-type="fig" rid="pone-0016526-g004">Figure 4 A–D</xref>). For the identification of TE families represented by several <italic>de novo</italic> consensus sequences, we clustered <italic>de novo</italic> consensus sequences with BLASTCLUST from the NCBI-BLAST suite (<xref rid="pone.0016526-Dondoshansky1" ref-type="bibr">[63]</xref>, parameters “-S 0 -L 0.8 -b F -p F”). We then added the best TE reference sequence corresponding to each cluster, and finally built a multiple alignment. The addition of the reference sequence after clustering prevents the <italic>de novo</italic> consensus sequences from being clustered together solely because they overlap with the same reference sequence. This procedure can therefore be used to assist manual curation for newly sequenced genomes without known reference sequences. Multiple alignments were checked by eye, using Jalview <xref rid="pone.0016526-Waterhouse1" ref-type="bibr">[64]</xref>.</p>
    </sec>
  </sec>
  <sec sec-type="supplementary-material" id="s5">
    <title>Supporting Information</title>
    <supplementary-material content-type="local-data" id="pone.0016526.s001">
      <label>Figure S1</label>
      <caption>
        <p>
          <bold>Flow chart of the three first steps of the TEdenovo pipeline.</bold>
        </p>
        <p>(TIF)</p>
      </caption>
      <media xlink:href="pone.0016526.s001.tif">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pone.0016526.s002">
      <label>Figure S2</label>
      <caption>
        <p>
          <bold>Flow chart of the TEannot pipeline.</bold>
        </p>
        <p>(TIF)</p>
      </caption>
      <media xlink:href="pone.0016526.s002.tif">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pone.0016526.s003">
      <label>Figure S3</label>
      <caption>
        <p>
          <bold>Comparison of two TE annotations in terms of match boundaries.</bold>
        </p>
        <p>(TIF)</p>
      </caption>
      <media xlink:href="pone.0016526.s003.tif">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pone.0016526.s004">
      <label>Table S1</label>
      <caption>
        <p>
          <bold>Comparative analysis of self-alignment programs.</bold>
        </p>
        <p>(PDF)</p>
      </caption>
      <media xlink:href="pone.0016526.s004.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pone.0016526.s005">
      <label>Table S2</label>
      <caption>
        <p>
          <bold>Comparative analysis of clustering programs.</bold>
        </p>
        <p>(PDF)</p>
      </caption>
      <media xlink:href="pone.0016526.s005.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pone.0016526.s006">
      <label>Table S3</label>
      <caption>
        <p>
          <bold>Comparative analysis of multiple alignment programs.</bold>
        </p>
        <p>(PDF)</p>
      </caption>
      <media xlink:href="pone.0016526.s006.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pone.0016526.s007">
      <label>Table S4</label>
      <caption>
        <p>
          <bold>Results of the RepeatScout program.</bold>
        </p>
        <p>(PDF)</p>
      </caption>
      <media xlink:href="pone.0016526.s007.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pone.0016526.s008">
      <label>Table S5</label>
      <caption>
        <p>
          <bold>Results obtained with a combination of several clustering programs in the de novo approach.</bold>
        </p>
        <p>(PDF)</p>
      </caption>
      <media xlink:href="pone.0016526.s008.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pone.0016526.s009">
      <label>Table S6</label>
      <caption>
        <p>
          <bold>Length parameters used in the TEclassifier program.</bold>
        </p>
        <p>(PDF)</p>
      </caption>
      <media xlink:href="pone.0016526.s009.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pone.0016526.s010">
      <label>Table S7</label>
      <caption>
        <p>
          <bold>Results of the classification of TE sequences from A. thaliana.</bold>
        </p>
        <p>(PDF)</p>
      </caption>
      <media xlink:href="pone.0016526.s010.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pone.0016526.s011">
      <label>Table S8</label>
      <caption>
        <p>
          <bold>Consensus sequences matching known genes of D. melanogaster.</bold>
        </p>
        <p>(PDF)</p>
      </caption>
      <media xlink:href="pone.0016526.s011.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pone.0016526.s012">
      <label>Table S9</label>
      <caption>
        <p>
          <bold>Parameters of the tests for redundancy elimination in TEclassifier.</bold>
        </p>
        <p>(PDF)</p>
      </caption>
      <media xlink:href="pone.0016526.s012.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pone.0016526.s013">
      <label>Table S10</label>
      <caption>
        <p>
          <bold>Results of coordinate comparisons for TE annotation.</bold>
        </p>
        <p>(PDF)</p>
      </caption>
      <media xlink:href="pone.0016526.s013.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pone.0016526.s014">
      <label>Table S11</label>
      <caption>
        <p>
          <bold>Comparison of the performances of the RepeatModeler and TEdenovo databanks.</bold>
        </p>
        <p>(PDF)</p>
      </caption>
      <media xlink:href="pone.0016526.s014.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pone.0016526.s015">
      <label>Table S12</label>
      <caption>
        <p>
          <bold>Comparison of the performances of TE annotation with the databanks of de novo consensus sequences from RepeatModeler and TEdenovo.</bold>
        </p>
        <p>(PDF)</p>
      </caption>
      <media xlink:href="pone.0016526.s015.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pone.0016526.s016">
      <label>Table S13</label>
      <caption>
        <p>
          <bold>Computation times of the TEdenovo/TEannot pipelines and RepeatScout on the D. melanogaster and A. thaliana genomes.</bold>
        </p>
        <p>(PDF)</p>
      </caption>
      <media xlink:href="pone.0016526.s016.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pone.0016526.s017">
      <label>Table S14</label>
      <caption>
        <p>
          <bold>Reference sequences entirely retrieved by one clustering method but not by the others, in the D. melanogaster genome.</bold>
        </p>
        <p>(PDF)</p>
      </caption>
      <media xlink:href="pone.0016526.s017.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pone.0016526.s018">
      <label>Table S15</label>
      <caption>
        <p>
          <bold>Reference sequences entirely retrieved by one clustering method but not by the others, in the A. thaliana genome.</bold>
        </p>
        <p>(PDF)</p>
      </caption>
      <media xlink:href="pone.0016526.s018.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pone.0016526.s019">
      <label>Table S16</label>
      <caption>
        <p>
          <bold>List of TE families represented by several de novo consensus sequences.</bold>
        </p>
        <p>(PDF)</p>
      </caption>
      <media xlink:href="pone.0016526.s019.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pone.0016526.s020">
      <label>Table S17</label>
      <caption>
        <p>
          <bold>TE reference sequences for which no “knowledge-based” consensus could be built.</bold>
        </p>
        <p>(PDF)</p>
      </caption>
      <media xlink:href="pone.0016526.s020.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pone.0016526.s021">
      <label>Table S18</label>
      <caption>
        <p>
          <bold>Comparison of “knowledge-based” libraries with reference databanks.</bold>
        </p>
        <p>(PDF)</p>
      </caption>
      <media xlink:href="pone.0016526.s021.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <ack>
    <p>We wish to thank Emmanuelle Permal, Joëlle Amselem and Victoria Dominguez for helpful comments on the <italic>de novo</italic> approach, Olivier Inizan for his work on the REPET package, Claire Hoede for her help with the TE HMM profiles, and Isabelle Luyten and Sébastien Reboux for their help with the computer infrastructure required for such an analysis. We also thank the GenOuest platform for allowing us to run our analyses on their computer cluster.</p>
  </ack>
  <fn-group>
    <fn fn-type="COI-statement">
      <p><bold>Competing Interests: </bold>The authors have declared that no competing interests exist.</p>
    </fn>
    <fn fn-type="financial-disclosure">
      <p><bold>Funding: </bold>Timothée Flutre was funded by the Institut National de la Recherche Agronomique (INRA) (ASC), Elodie Duprat held a fellowship from the Université Pierre et Marie Curie (UPMC) (ATER) and this work was funded by a grant from the Agence Nationale de la Recherche (ANR-05-MMSA-0010) to Hadi Quesneville. The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.</p>
    </fn>
  </fn-group>
  <ref-list>
    <title>References</title>
    <ref id="pone.0016526-Orgel1">
      <label>1</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Orgel</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Crick</surname>
            <given-names>F</given-names>
          </name>
        </person-group>
        <year>1980</year>
        <article-title>Selfish DNA: the ultimate parasite.</article-title>
        <source>Nature</source>
        <volume>284</volume>
        <fpage>604</fpage>
        <lpage>607</lpage>
        <pub-id pub-id-type="pmid">7366731</pub-id>
      </element-citation>
    </ref>
    <ref id="pone.0016526-Brookfield1">
      <label>2</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Brookfield</surname>
            <given-names>JFY</given-names>
          </name>
        </person-group>
        <year>2005</year>
        <article-title>The ecology of the genome - mobile DNA elements and their hosts.</article-title>
        <source>Nature Reviews Genetics</source>
        <volume>6</volume>
        <fpage>128</fpage>
        <lpage>136</lpage>
      </element-citation>
    </ref>
    <ref id="pone.0016526-Lynch1">
      <label>3</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lynch</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Conery</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <year>2003</year>
        <article-title>The origins of genome complexity.</article-title>
        <source>Science</source>
        <volume>302</volume>
        <fpage>1401</fpage>
        <lpage>1404</lpage>
        <pub-id pub-id-type="pmid">14631042</pub-id>
      </element-citation>
    </ref>
    <ref id="pone.0016526-Finnegan1">
      <label>4</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Finnegan</surname>
            <given-names>D</given-names>
          </name>
        </person-group>
        <year>1989</year>
        <article-title>Eukaryotic transposable elements and genome evolution.</article-title>
        <source>Trends in Genetics</source>
        <volume>5</volume>
        <fpage>103</fpage>
        <lpage>107</lpage>
        <pub-id pub-id-type="pmid">2543105</pub-id>
      </element-citation>
    </ref>
    <ref id="pone.0016526-Wicker1">
      <label>5</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wicker</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Sabot</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Hua-Van</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Bennetzen</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Capy</surname>
            <given-names>P</given-names>
          </name>
          <etal/>
        </person-group>
        <year>2007</year>
        <article-title>A unified classification system for eukaryotic transposable elements.</article-title>
        <source>Nature Reviews Genetics</source>
        <volume>8</volume>
        <fpage>973</fpage>
        <lpage>982</lpage>
      </element-citation>
    </ref>
    <ref id="pone.0016526-Wessler1">
      <label>6</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wessler</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <year>1995</year>
        <article-title>LTR-retrotransposons and MITEs: important players in the evolution of plant genomes.</article-title>
        <source>Current Opinion in Genetics and Development</source>
        <volume>5</volume>
        <fpage>814</fpage>
        <lpage>821</lpage>
        <pub-id pub-id-type="pmid">8745082</pub-id>
      </element-citation>
    </ref>
    <ref id="pone.0016526-Yang1">
      <label>7</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Yang</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Nagel</surname>
            <given-names>DH</given-names>
          </name>
          <name>
            <surname>Feschotte</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Hancock</surname>
            <given-names>CN</given-names>
          </name>
          <name>
            <surname>Wessler</surname>
            <given-names>SR</given-names>
          </name>
        </person-group>
        <year>2009</year>
        <article-title>Tuned for transposition: molecular determinants underlying the hyperactivity of a Stowaway MITE.</article-title>
        <source>Science</source>
        <volume>325</volume>
        <fpage>1391</fpage>
        <lpage>1394</lpage>
        <pub-id pub-id-type="pmid">19745152</pub-id>
      </element-citation>
    </ref>
    <ref id="pone.0016526-Gray1">
      <label>8</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Gray</surname>
            <given-names>Y</given-names>
          </name>
        </person-group>
        <year>2000</year>
        <article-title>It takes two transposons to tango: transposable-element-mediated chromosomal rearrangements.</article-title>
        <source>Trends in Genetics</source>
        <volume>16</volume>
        <fpage>461</fpage>
        <lpage>468</lpage>
        <pub-id pub-id-type="pmid">11050333</pub-id>
      </element-citation>
    </ref>
    <ref id="pone.0016526-Eichler1">
      <label>9</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Eichler</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Sankoff</surname>
            <given-names>D</given-names>
          </name>
        </person-group>
        <year>2003</year>
        <article-title>Structural dynamics of eukaryotic chromosome evolution.</article-title>
        <source>Science</source>
        <volume>301</volume>
        <fpage>793</fpage>
        <lpage>797</lpage>
        <pub-id pub-id-type="pmid">12907789</pub-id>
      </element-citation>
    </ref>
    <ref id="pone.0016526-Coghlan1">
      <label>10</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Coghlan</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Eichler</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Oliver</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Paterson</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Stein</surname>
            <given-names>L</given-names>
          </name>
        </person-group>
        <year>2005</year>
        <article-title>Chromosome evolution in eukaryotes: a multi-kingdom perspective.</article-title>
        <source>Trends in Genetics</source>
        <volume>21</volume>
        <fpage>673</fpage>
        <lpage>682</lpage>
        <pub-id pub-id-type="pmid">16242204</pub-id>
      </element-citation>
    </ref>
    <ref id="pone.0016526-Paux1">
      <label>11</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Paux</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Sourdille</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Salse</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Saintenac</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Choulet</surname>
            <given-names>F</given-names>
          </name>
          <etal/>
        </person-group>
        <year>2008</year>
        <article-title>A Physical Map of the 1-Gigabase Bread Wheat Chromosome 3B.</article-title>
        <source>Science</source>
        <volume>322</volume>
        <fpage>101</fpage>
        <lpage>104</lpage>
        <pub-id pub-id-type="pmid">18832645</pub-id>
      </element-citation>
    </ref>
    <ref id="pone.0016526-McClintock1">
      <label>12</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>McClintock</surname>
            <given-names>B</given-names>
          </name>
        </person-group>
        <year>1956</year>
        <article-title>Controlling elements and the gene.</article-title>
        <source>Cold Spring Harbor Symposia on Quantitative Biology</source>
        <volume>21</volume>
        <fpage>197</fpage>
        <lpage>216</lpage>
        <pub-id pub-id-type="pmid">13433592</pub-id>
      </element-citation>
    </ref>
    <ref id="pone.0016526-Slotkin1">
      <label>13</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Slotkin</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Martienssen</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <year>2007</year>
        <article-title>Transposable elements and the epigenetic regulation of the genome.</article-title>
        <source>Nature Reviews Genetics</source>
        <volume>8</volume>
        <fpage>272</fpage>
        <lpage>285</lpage>
      </element-citation>
    </ref>
    <ref id="pone.0016526-Martin1">
      <label>14</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Martin</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Troadec</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Boualem</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Rajab</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Fernandez</surname>
            <given-names>R</given-names>
          </name>
          <etal/>
        </person-group>
        <year>2009</year>
        <article-title>A transposon-induced epigenetic change leads to sex determination in melon.</article-title>
        <source>Nature</source>
        <volume>461</volume>
        <fpage>1135</fpage>
        <lpage>1138</lpage>
        <pub-id pub-id-type="pmid">19847267</pub-id>
      </element-citation>
    </ref>
    <ref id="pone.0016526-Feschotte1">
      <label>15</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Feschotte</surname>
            <given-names>C</given-names>
          </name>
        </person-group>
        <year>2008</year>
        <article-title>Transposable elements and the evolution of regulatory networks.</article-title>
        <source>Nature Reviews Genetics</source>
        <volume>9</volume>
        <fpage>397</fpage>
        <lpage>405</lpage>
      </element-citation>
    </ref>
    <ref id="pone.0016526-Herpin1">
      <label>16</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Herpin</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Braasch</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Kraeussling</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Schmidt</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Thoma</surname>
            <given-names>E</given-names>
          </name>
          <etal/>
        </person-group>
        <year>2010</year>
        <article-title>Transcriptional rewiring of the sex determining dmrt1 gene duplicate by transposable elements.</article-title>
        <source>PLoS Genetics</source>
        <volume>6</volume>
        <fpage>e1000844+</fpage>
        <pub-id pub-id-type="pmid">20169179</pub-id>
      </element-citation>
    </ref>
    <ref id="pone.0016526-Cordaux1">
      <label>17</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Cordaux</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Udit</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Batzer</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Feschotte</surname>
            <given-names>C</given-names>
          </name>
        </person-group>
        <year>2006</year>
        <article-title>Birth of a chimeric primate gene by capture of the transposase gene from a mobile element.</article-title>
        <source>Proceedings of the National Academy of Sciences</source>
        <volume>103</volume>
        <fpage>8101</fpage>
        <lpage>8106</lpage>
      </element-citation>
    </ref>
    <ref id="pone.0016526-Santangelo1">
      <label>18</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Santangelo</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>de Souza</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Franchini</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Bumaschny</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Low</surname>
            <given-names>M</given-names>
          </name>
          <etal/>
        </person-group>
        <year>2007</year>
        <article-title>Ancient exaptation of a CORE-SINE retroposon into a highly conserved mammalian neuronal enhancer of the proopiomelanocortin gene.</article-title>
        <source>PLoS Genetics</source>
        <volume>3</volume>
      </element-citation>
    </ref>
    <ref id="pone.0016526-Agrawal1">
      <label>19</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Agrawal</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Eastman</surname>
            <given-names>QM</given-names>
          </name>
          <name>
            <surname>Schatz</surname>
            <given-names>DG</given-names>
          </name>
        </person-group>
        <year>1998</year>
        <article-title>Transposition mediated by RAG1 and RAG2 and its implications for the evolution of the immune system.</article-title>
        <source>Nature</source>
        <volume>394</volume>
        <fpage>744</fpage>
        <lpage>751</lpage>
        <pub-id pub-id-type="pmid">9723614</pub-id>
      </element-citation>
    </ref>
    <ref id="pone.0016526-Zhou1">
      <label>20</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zhou</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Mitra</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Atkinson</surname>
            <given-names>PW</given-names>
          </name>
          <name>
            <surname>Burgess Hickman</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Dyda</surname>
            <given-names>F</given-names>
          </name>
          <etal/>
        </person-group>
        <year>2004</year>
        <article-title>Transposition of hAT elements links transposable elements and V(D)J recombination.</article-title>
        <source>Nature</source>
        <volume>432</volume>
        <fpage>995</fpage>
        <lpage>1001</lpage>
        <pub-id pub-id-type="pmid">15616554</pub-id>
      </element-citation>
    </ref>
    <ref id="pone.0016526-Schuster1">
      <label>21</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Schuster</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <year>2008</year>
        <article-title>Next-generation sequencing transforms today's biology.</article-title>
        <source>Nature Methods</source>
        <volume>5</volume>
        <fpage>16</fpage>
        <lpage>18</lpage>
        <pub-id pub-id-type="pmid">18165802</pub-id>
      </element-citation>
    </ref>
    <ref id="pone.0016526-Schnable1">
      <label>22</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Schnable</surname>
            <given-names>PS</given-names>
          </name>
          <name>
            <surname>Ware</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Fulton</surname>
            <given-names>RS</given-names>
          </name>
          <name>
            <surname>Stein</surname>
            <given-names>JC</given-names>
          </name>
          <name>
            <surname>Wei</surname>
            <given-names>F</given-names>
          </name>
          <etal/>
        </person-group>
        <year>2009</year>
        <article-title>The B73 maize genome: complexity, diversity, and dynamics.</article-title>
        <source>Science</source>
        <volume>326</volume>
        <fpage>1112</fpage>
        <lpage>1115</lpage>
        <pub-id pub-id-type="pmid">19965430</pub-id>
      </element-citation>
    </ref>
    <ref id="pone.0016526-Bourque1">
      <label>23</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bourque</surname>
            <given-names>G</given-names>
          </name>
        </person-group>
        <year>2009</year>
        <article-title>Transposable elements in gene regulation and in the evolution of vertebrate genomes.</article-title>
        <source>Current Opinion in Genetics and Development</source>
        <volume>19</volume>
        <fpage>607</fpage>
        <lpage>612</lpage>
        <pub-id pub-id-type="pmid">19914058</pub-id>
      </element-citation>
    </ref>
    <ref id="pone.0016526-Quesneville1">
      <label>24</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Quesneville</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Bergman</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Andrieu</surname>
            <given-names>O</given-names>
          </name>
          <name>
            <surname>Autard</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Nouaud</surname>
            <given-names>D</given-names>
          </name>
          <etal/>
        </person-group>
        <year>2005</year>
        <article-title>Combined evidence annotation of transposable elements in genome sequences.</article-title>
        <source>PLoS Computational Biology</source>
        <volume>1</volume>
        <fpage>166</fpage>
        <lpage>175</lpage>
        <pub-id pub-id-type="pmid">16110336</pub-id>
      </element-citation>
    </ref>
    <ref id="pone.0016526-Bergman1">
      <label>25</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bergman</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Quesneville</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Anxolabehere</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Ashburner</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <year>2006</year>
        <article-title>Recurrent insertion and duplication generate networks of transposable element sequences in the Drosophila melanogaster genome.</article-title>
        <source>Genome Biology</source>
        <volume>7</volume>
        <fpage>R112+</fpage>
        <pub-id pub-id-type="pmid">17134480</pub-id>
      </element-citation>
    </ref>
    <ref id="pone.0016526-Nene1">
      <label>26</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Nene</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Wortman</surname>
            <given-names>JR</given-names>
          </name>
          <name>
            <surname>Lawson</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Haas</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Kodira</surname>
            <given-names>C</given-names>
          </name>
          <etal/>
        </person-group>
        <year>2007</year>
        <article-title>Genome sequence of Aedes aegypti, a major Arbovirus vector.</article-title>
        <source>Science</source>
        <volume>316</volume>
        <fpage>1718</fpage>
        <lpage>1723</lpage>
        <pub-id pub-id-type="pmid">17510324</pub-id>
      </element-citation>
    </ref>
    <ref id="pone.0016526-Cuomo1">
      <label>27</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Cuomo</surname>
            <given-names>CA</given-names>
          </name>
          <name>
            <surname>Guldener</surname>
            <given-names>U</given-names>
          </name>
          <name>
            <surname>Xu</surname>
            <given-names>JR</given-names>
          </name>
          <name>
            <surname>Trail</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Turgeon</surname>
            <given-names>BG</given-names>
          </name>
          <etal/>
        </person-group>
        <year>2007</year>
        <article-title>The Fusarium graminearum genome reveals a link between localized polymorphism and pathogen specialization.</article-title>
        <source>Science</source>
        <volume>317</volume>
        <fpage>1400</fpage>
        <lpage>1402</lpage>
        <pub-id pub-id-type="pmid">17823352</pub-id>
      </element-citation>
    </ref>
    <ref id="pone.0016526-The1">
      <label>28</label>
      <element-citation publication-type="journal">
        <collab>The 12 Drosophila Genomes Consortium</collab>
        <year>2007</year>
        <article-title>Evolution of genes and genomes on the Drosophila phylogeny.</article-title>
        <source>Nature</source>
        <volume>450</volume>
        <fpage>203</fpage>
        <lpage>218</lpage>
        <pub-id pub-id-type="pmid">17994087</pub-id>
      </element-citation>
    </ref>
    <ref id="pone.0016526-Buisine1">
      <label>29</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Buisine</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Quesneville</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Colot</surname>
            <given-names>V</given-names>
          </name>
        </person-group>
        <year>2008</year>
        <article-title>Improved detection and annotation of transposable elements in sequenced genomes using multiple reference sequence sets.</article-title>
        <source>Genomics</source>
        <volume>91</volume>
        <fpage>467</fpage>
        <lpage>475</lpage>
        <pub-id pub-id-type="pmid">18343092</pub-id>
      </element-citation>
    </ref>
    <ref id="pone.0016526-Abad1">
      <label>30</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Abad</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Gouzy</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Aury</surname>
            <given-names>JM</given-names>
          </name>
          <name>
            <surname>Castagnone-Sereno</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Danchin</surname>
            <given-names>EGJG</given-names>
          </name>
          <etal/>
        </person-group>
        <year>2008</year>
        <article-title>Genome sequence of the metazoan plant-parasitic nematode Meloidogyne incognita.</article-title>
        <source>Nature Biotechnology</source>
        <fpage>909</fpage>
        <lpage>915</lpage>
      </element-citation>
    </ref>
    <ref id="pone.0016526-The2">
      <label>31</label>
      <element-citation publication-type="journal">
        <collab>The International Aphid Genomics Consortium</collab>
        <year>2010</year>
        <article-title>Genome sequence of the pea aphid Acyrthosiphon pisum.</article-title>
        <source>PLoS Biology</source>
        <volume>8</volume>
        <fpage>e1000313+</fpage>
        <pub-id pub-id-type="pmid">20186266</pub-id>
      </element-citation>
    </ref>
    <ref id="pone.0016526-Saha1">
      <label>32</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Saha</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Bridges</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Magbanua</surname>
            <given-names>ZV</given-names>
          </name>
          <name>
            <surname>Peterson</surname>
            <given-names>DG</given-names>
          </name>
        </person-group>
        <year>2008</year>
        <article-title>Empirical comparison of ab initio repeat finding programs.</article-title>
        <source>Nucl Acids Res</source>
        <volume>36</volume>
        <fpage>2284</fpage>
        <lpage>2294</lpage>
        <pub-id pub-id-type="pmid">18287116</pub-id>
      </element-citation>
    </ref>
    <ref id="pone.0016526-Jiang1">
      <label>33</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Jiang</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Jordan</surname>
            <given-names>IK</given-names>
          </name>
          <name>
            <surname>Wessler</surname>
            <given-names>SR</given-names>
          </name>
        </person-group>
        <year>2002</year>
        <article-title>Dasheng and RIRE2. A nonautonomous Long Terminal Repeat element and its putative autonomous partner in the rice genome.</article-title>
        <source>Plant Physiol</source>
        <volume>130</volume>
        <fpage>1697</fpage>
        <lpage>1705</lpage>
        <pub-id pub-id-type="pmid">12481052</pub-id>
      </element-citation>
    </ref>
    <ref id="pone.0016526-Quesneville2">
      <label>34</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Quesneville</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Nouaud</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Anxolabehere</surname>
            <given-names>D</given-names>
          </name>
        </person-group>
        <year>2006</year>
        <article-title>P elements and MITE relatives in the whole genome sequence of Anopheles gambiae.</article-title>
        <source>BMC genomics</source>
        <volume>7</volume>
        <fpage>214+</fpage>
        <pub-id pub-id-type="pmid">16919158</pub-id>
      </element-citation>
    </ref>
    <ref id="pone.0016526-Bergman2">
      <label>35</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bergman</surname>
            <given-names>CMM</given-names>
          </name>
          <name>
            <surname>Quesneville</surname>
            <given-names>H</given-names>
          </name>
        </person-group>
        <year>2007</year>
        <article-title>Discovering and detecting transposable elements in genome sequences.</article-title>
        <source>Briefings in Bioinformatics</source>
        <volume>8</volume>
        <fpage>382</fpage>
        <lpage>392</lpage>
        <pub-id pub-id-type="pmid">17932080</pub-id>
      </element-citation>
    </ref>
    <ref id="pone.0016526-Quesneville3">
      <label>36</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Quesneville</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Nouaud</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Anxolabehere</surname>
            <given-names>D</given-names>
          </name>
        </person-group>
        <year>2003</year>
        <article-title>Detection of new transposable element families in Drosophila melanogaster and Anopheles gambiae genomes.</article-title>
        <source>Journal of Molecular Evolution</source>
        <volume>57</volume>
      </element-citation>
    </ref>
    <ref id="pone.0016526-Altschul1">
      <label>37</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Altschul</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Gish</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Miller</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Myers</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Lipman</surname>
            <given-names>D</given-names>
          </name>
        </person-group>
        <year>1990</year>
        <article-title>Basic local alignment search tool.</article-title>
        <source>Journal of Molecular Biology</source>
        <volume>215</volume>
        <fpage>403</fpage>
        <lpage>410</lpage>
        <pub-id pub-id-type="pmid">2231712</pub-id>
      </element-citation>
    </ref>
    <ref id="pone.0016526-Rasmussen1">
      <label>38</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Rasmussen</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Stoye</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Myers</surname>
            <given-names>E</given-names>
          </name>
        </person-group>
        <year>2006</year>
        <article-title>Efficient q-gram filters for finding all epsilon-matches over a given length.</article-title>
        <source>Journal of Computational Biology</source>
        <volume>13</volume>
        <fpage>296</fpage>
        <lpage>308</lpage>
        <pub-id pub-id-type="pmid">16597241</pub-id>
      </element-citation>
    </ref>
    <ref id="pone.0016526-Bao1">
      <label>39</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bao</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Eddy</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <year>2002</year>
        <article-title>Automated de novo identification of repeat sequence families in sequenced genomes.</article-title>
        <source>Genome Research</source>
        <volume>12</volume>
        <fpage>1269</fpage>
        <lpage>1276</lpage>
        <pub-id pub-id-type="pmid">12176934</pub-id>
      </element-citation>
    </ref>
    <ref id="pone.0016526-Edgar1">
      <label>40</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Edgar</surname>
            <given-names>RC</given-names>
          </name>
          <name>
            <surname>Myers</surname>
            <given-names>EW</given-names>
          </name>
        </person-group>
        <year>2005</year>
        <article-title>PILER: identification and classification of genomic repeats.</article-title>
        <source>Bioinformatics</source>
        <volume>21</volume>
        <fpage>i152</fpage>
        <lpage>158</lpage>
        <pub-id pub-id-type="pmid">15961452</pub-id>
      </element-citation>
    </ref>
    <ref id="pone.0016526-Notredame1">
      <label>41</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Notredame</surname>
            <given-names>C</given-names>
          </name>
        </person-group>
        <year>2007</year>
        <article-title>Recent evolutions of multiple sequence alignment algorithms.</article-title>
        <source>PLoS Computational Biology</source>
        <volume>3</volume>
        <fpage>e123+</fpage>
        <pub-id pub-id-type="pmid">17784778</pub-id>
      </element-citation>
    </ref>
    <ref id="pone.0016526-Huang1">
      <label>42</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Huang</surname>
            <given-names>X</given-names>
          </name>
        </person-group>
        <year>1994</year>
        <article-title>On global sequence alignment.</article-title>
        <source>Computer Applications in the Biosciences</source>
        <volume>10</volume>
        <fpage>227</fpage>
        <lpage>235</lpage>
        <pub-id pub-id-type="pmid">7922677</pub-id>
      </element-citation>
    </ref>
    <ref id="pone.0016526-Thompson1">
      <label>43</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Thompson</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Higgins</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Gibson</surname>
            <given-names>T</given-names>
          </name>
        </person-group>
        <year>1994</year>
        <article-title>CLUSTAL W: improving the sensitivity of progressive multiple sequence alignment through sequence weighting, position-specific gap penalties and weight matrix choice.</article-title>
        <source>Nucleic Acids Research</source>
        <volume>22</volume>
        <fpage>4673</fpage>
        <lpage>4680</lpage>
        <pub-id pub-id-type="pmid">7984417</pub-id>
      </element-citation>
    </ref>
    <ref id="pone.0016526-Katoh1">
      <label>44</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Katoh</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Toh</surname>
            <given-names>H</given-names>
          </name>
        </person-group>
        <year>2008</year>
        <article-title>Recent developments in the MAFFT multiple sequence alignment program.</article-title>
        <source>Briefings in Bioinformatics</source>
        <volume>9</volume>
        <fpage>286</fpage>
        <lpage>298</lpage>
        <pub-id pub-id-type="pmid">18372315</pub-id>
      </element-citation>
    </ref>
    <ref id="pone.0016526-Loytynoja1">
      <label>45</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Loytynoja</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Goldman</surname>
            <given-names>N</given-names>
          </name>
        </person-group>
        <year>2005</year>
        <article-title>An algorithm for progressive multiple alignment of sequences with insertions.</article-title>
        <source>Proceedings of the National Academy of Sciences</source>
        <volume>102</volume>
        <fpage>10557</fpage>
        <lpage>10562</lpage>
      </element-citation>
    </ref>
    <ref id="pone.0016526-Price1">
      <label>46</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Price</surname>
            <given-names>AL</given-names>
          </name>
          <name>
            <surname>Jones</surname>
            <given-names>NC</given-names>
          </name>
          <name>
            <surname>Pevzner</surname>
            <given-names>PA</given-names>
          </name>
        </person-group>
        <year>2005</year>
        <article-title>De novo identification of repeat families in large genomes.</article-title>
        <source>Bioinformatics</source>
        <volume>21</volume>
        <fpage>i351</fpage>
        <lpage>358</lpage>
        <pub-id pub-id-type="pmid">15961478</pub-id>
      </element-citation>
    </ref>
    <ref id="pone.0016526-Mayr1">
      <label>47</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Mayr</surname>
            <given-names>E</given-names>
          </name>
        </person-group>
        <year>1981</year>
        <article-title>Biological classification: toward a synthesis of opposing methodologies.</article-title>
        <source>Science</source>
        <volume>214</volume>
        <fpage>510</fpage>
        <lpage>516</lpage>
        <pub-id pub-id-type="pmid">17838387</pub-id>
      </element-citation>
    </ref>
    <ref id="pone.0016526-Jurka1">
      <label>48</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Jurka</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Kapitonov</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Pavlicek</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Klonowski</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Kohany</surname>
            <given-names>O</given-names>
          </name>
          <etal/>
        </person-group>
        <year>2005</year>
        <article-title>Repbase Update, a database of eukaryotic repetitive elements.</article-title>
        <source>Cytogenetic and Genome Research</source>
        <volume>110</volume>
        <fpage>462</fpage>
        <lpage>467</lpage>
        <pub-id pub-id-type="pmid">16093699</pub-id>
      </element-citation>
    </ref>
    <ref id="pone.0016526-Tempel1">
      <label>49</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Tempel</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Nicolas</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>El Amrani</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Couée</surname>
            <given-names>I</given-names>
          </name>
        </person-group>
        <year>2007</year>
        <article-title>Model-based identification of Helitrons results in a new classification of their families in Arabidopsis thaliana.</article-title>
        <source>Gene</source>
        <volume>403</volume>
        <fpage>18</fpage>
        <lpage>28</lpage>
        <pub-id pub-id-type="pmid">17889452</pub-id>
      </element-citation>
    </ref>
    <ref id="pone.0016526-Kurtz1">
      <label>50</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kurtz</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Narechania</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Stein</surname>
            <given-names>JC</given-names>
          </name>
          <name>
            <surname>Ware</surname>
            <given-names>D</given-names>
          </name>
        </person-group>
        <year>2008</year>
        <article-title>A new method to compute K-mer frequencies and its application to annotate large repetitive plant genomes.</article-title>
        <source>BMC Genomics</source>
        <volume>9</volume>
        <fpage>517+</fpage>
        <pub-id pub-id-type="pmid">18976482</pub-id>
      </element-citation>
    </ref>
    <ref id="pone.0016526-Gu1">
      <label>51</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Gu</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Castoe</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Hedges</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Batzer</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Pollock</surname>
            <given-names>D</given-names>
          </name>
        </person-group>
        <year>2008</year>
        <article-title>Identification of repeat structure in large genomes using repeat probability clouds.</article-title>
        <source>Analytical Biochemistry</source>
        <volume>380</volume>
        <fpage>77</fpage>
        <lpage>83</lpage>
        <pub-id pub-id-type="pmid">18541131</pub-id>
      </element-citation>
    </ref>
    <ref id="pone.0016526-Newman1">
      <label>52</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Newman</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Bailey</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Fan</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Pavelitz</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Weiner</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <year>2008</year>
        <article-title>An abundant evolutionarily conserved CSB-PiggyBac fusion protein expressed in Cockayne syndrome.</article-title>
        <source>PLoS Genetics</source>
        <volume>4</volume>
        <issue>3</issue>
        <fpage>e1000031</fpage>
        <pub-id pub-id-type="pmid">18369450</pub-id>
      </element-citation>
    </ref>
    <ref id="pone.0016526-Teixeira1">
      <label>53</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Teixeira</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Heredia</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Sarazin</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Roudier</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Boccara</surname>
            <given-names>M</given-names>
          </name>
          <etal/>
        </person-group>
        <year>2009</year>
        <article-title>A role for RNAi in the selective correction of DNA methylation defects.</article-title>
        <source>Science</source>
        <volume>323</volume>
        <fpage>1600</fpage>
        <lpage>1604</lpage>
        <pub-id pub-id-type="pmid">19179494</pub-id>
      </element-citation>
    </ref>
    <ref id="pone.0016526-Abrusan1">
      <label>54</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Abrusan</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Grundmann</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>DeMester</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Makalowski</surname>
            <given-names>W</given-names>
          </name>
        </person-group>
        <year>2009</year>
        <article-title>TEclass–a tool for automated classification of unknown eukaryotic transposable elements.</article-title>
        <source>Bioinformatics</source>
        <volume>25</volume>
        <fpage>1329</fpage>
        <lpage>1330</lpage>
        <pub-id pub-id-type="pmid">19349283</pub-id>
      </element-citation>
    </ref>
    <ref id="pone.0016526-Feschotte2">
      <label>55</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Feschotte</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Keswani</surname>
            <given-names>U</given-names>
          </name>
          <name>
            <surname>Ranganathan</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Guibotsy</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Levine</surname>
            <given-names>D</given-names>
          </name>
        </person-group>
        <year>2010</year>
        <article-title>Exploring repetitive DNA landscapes using REPCLASS, a tool that automates the classification of transposable elements in eukaryotic genomes.</article-title>
        <source>Genome Biol Evol</source>
        <volume>2009</volume>
        <fpage>205</fpage>
        <lpage>220</lpage>
      </element-citation>
    </ref>
    <ref id="pone.0016526-Brent1">
      <label>56</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Brent</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <year>2008</year>
        <article-title>Steady progress and recent breakthroughs in the accuracy of automated genome annotation.</article-title>
        <source>Nature Reviews Genetics</source>
        <volume>9</volume>
        <fpage>62</fpage>
        <lpage>73</lpage>
      </element-citation>
    </ref>
    <ref id="pone.0016526-Adams1">
      <label>57</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Adams</surname>
            <given-names>MD</given-names>
          </name>
          <name>
            <surname>Celniker</surname>
            <given-names>SE</given-names>
          </name>
          <name>
            <surname>Holt</surname>
            <given-names>RA</given-names>
          </name>
          <name>
            <surname>Evans</surname>
            <given-names>CA</given-names>
          </name>
          <name>
            <surname>Gocayne</surname>
            <given-names>JD</given-names>
          </name>
          <etal/>
        </person-group>
        <year>2000</year>
        <article-title>The genome sequence of Drosophila melanogaster.</article-title>
        <source>Science</source>
        <volume>287</volume>
        <fpage>2185</fpage>
        <lpage>2195</lpage>
        <pub-id pub-id-type="pmid">10731132</pub-id>
      </element-citation>
    </ref>
    <ref id="pone.0016526-The3">
      <label>58</label>
      <element-citation publication-type="journal">
        <collab>The Arabidopsis Genome Initiative</collab>
        <year>2000</year>
        <article-title>Analysis of the genome sequence of the flowering plant Arabidopsis thaliana.</article-title>
        <source>Nature</source>
        <volume>408</volume>
        <fpage>796</fpage>
        <lpage>815</lpage>
        <pub-id pub-id-type="pmid">11130711</pub-id>
      </element-citation>
    </ref>
    <ref id="pone.0016526-Benson1">
      <label>59</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Benson</surname>
            <given-names>G</given-names>
          </name>
        </person-group>
        <year>1999</year>
        <article-title>Tandem repeats finder: a program to analyze DNA sequences.</article-title>
        <source>Nucleic Acids Research</source>
        <volume>27</volume>
        <fpage>573</fpage>
        <lpage>580</lpage>
        <pub-id pub-id-type="pmid">9862982</pub-id>
      </element-citation>
    </ref>
    <ref id="pone.0016526-Jurka2">
      <label>60</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Jurka</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Klonowski</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Dagman</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Pelton</surname>
            <given-names>P</given-names>
          </name>
        </person-group>
        <year>1996</year>
        <article-title>CENSOR–a program for identification and elimination of repetitive elements from DNA sequences.</article-title>
        <source>Comput Chem</source>
        <volume>20</volume>
        <fpage>119</fpage>
        <lpage>121</lpage>
        <pub-id pub-id-type="pmid">8867843</pub-id>
      </element-citation>
    </ref>
    <ref id="pone.0016526-Kolpakov1">
      <label>61</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kolpakov</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Bana</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Kucherov</surname>
            <given-names>G</given-names>
          </name>
        </person-group>
        <year>2003</year>
        <article-title>mreps: efficient and flexible detection of tandem repeats in DNA.</article-title>
        <source>Nucleic Acids Research</source>
        <volume>31</volume>
        <fpage>3672</fpage>
        <lpage>3678</lpage>
        <pub-id pub-id-type="pmid">12824391</pub-id>
      </element-citation>
    </ref>
    <ref id="pone.0016526-Kent1">
      <label>62</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kent</surname>
            <given-names>W</given-names>
          </name>
        </person-group>
        <year>2002</year>
        <article-title>BLAT–the BLAST-like alignment tool.</article-title>
        <source>Genome Research</source>
        <volume>12</volume>
        <fpage>656</fpage>
        <lpage>664</lpage>
        <pub-id pub-id-type="pmid">11932250</pub-id>
      </element-citation>
    </ref>
    <ref id="pone.0016526-Dondoshansky1">
      <label>63</label>
      <element-citation publication-type="other">
        <person-group person-group-type="author">
          <name>
            <surname>Dondoshansky</surname>
            <given-names>I</given-names>
          </name>
        </person-group>
        <year>2002</year>
        <source>Blastclust (NCBI Software Development Toolkit)</source>
      </element-citation>
    </ref>
    <ref id="pone.0016526-Waterhouse1">
      <label>64</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Waterhouse</surname>
            <given-names>AM</given-names>
          </name>
          <name>
            <surname>Procter</surname>
            <given-names>JB</given-names>
          </name>
          <name>
            <surname>Martin</surname>
            <given-names>DMA</given-names>
          </name>
          <name>
            <surname>Clamp</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Barton</surname>
            <given-names>GJ</given-names>
          </name>
        </person-group>
        <year>2009</year>
        <article-title>Jalview Version 2–a multiple sequence alignment editor and analysis workbench.</article-title>
        <source>Bioinformatics</source>
        <volume>25</volume>
        <fpage>1189</fpage>
        <lpage>1191</lpage>
        <pub-id pub-id-type="pmid">19151095</pub-id>
      </element-citation>
    </ref>
  </ref-list>
</back>
