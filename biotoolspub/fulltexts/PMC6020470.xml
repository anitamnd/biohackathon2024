<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName A++V2.4.dtd?>
<?SourceDTD.Version 2.4?>
<?ConverterInfo.XSLTName springer2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Genome Biol</journal-id>
    <journal-id journal-id-type="iso-abbrev">Genome Biol</journal-id>
    <journal-title-group>
      <journal-title>Genome Biology</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1474-7596</issn>
    <issn pub-type="epub">1474-760X</issn>
    <publisher>
      <publisher-name>BioMed Central</publisher-name>
      <publisher-loc>London</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">6020470</article-id>
    <article-id pub-id-type="publisher-id">1450</article-id>
    <article-id pub-id-type="doi">10.1186/s13059-018-1450-0</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Software</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>HmmUFOtu: An HMM and phylogenetic placement based ultra-fast taxonomic assignment and OTU picking tool for microbiome amplicon sequencing studies</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author" corresp="yes">
        <name>
          <surname>Zheng</surname>
          <given-names>Qi</given-names>
        </name>
        <address>
          <email>zhengqi@pennmedicine.upenn.edu</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Bartow-McKenney</surname>
          <given-names>Casey</given-names>
        </name>
        <address>
          <email>casb@pennmedicine.upenn.edu</email>
        </address>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Meisel</surname>
          <given-names>Jacquelyn S.</given-names>
        </name>
        <address>
          <email>meiselj@pennmedicine.upenn.edu</email>
        </address>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0003-3939-2200</contrib-id>
        <name>
          <surname>Grice</surname>
          <given-names>Elizabeth A.</given-names>
        </name>
        <address>
          <email>egrice@pennmedicine.upenn.edu</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <aff id="Aff1"><label>1</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0004 1936 8972</institution-id><institution-id institution-id-type="GRID">grid.25879.31</institution-id><institution>Department of Dermatology and Microbiology, </institution><institution>Perelman School of Medicine, University of Pennsylvania, </institution></institution-wrap>421 Curie Blvd, BRB 1046/7, Philadelphia, PA 19104 USA </aff>
      <aff id="Aff2"><label>2</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0004 1936 8972</institution-id><institution-id institution-id-type="GRID">grid.25879.31</institution-id><institution>Genomics and Computational Biology Program, Department of Dermatology, </institution><institution>University of Pennsylvania, </institution></institution-wrap>Philadelphia, USA </aff>
    </contrib-group>
    <pub-date pub-type="epub">
      <day>27</day>
      <month>6</month>
      <year>2018</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>27</day>
      <month>6</month>
      <year>2018</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2018</year>
    </pub-date>
    <volume>19</volume>
    <elocation-id>82</elocation-id>
    <history>
      <date date-type="received">
        <day>27</day>
        <month>11</month>
        <year>2017</year>
      </date>
      <date date-type="accepted">
        <day>9</day>
        <month>5</month>
        <year>2018</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s). 2018</copyright-statement>
      <license license-type="OpenAccess">
        <license-p><bold>Open Access</bold>This article is distributed under the terms of the Creative Commons Attribution 4.0 International License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted use, distribution, and reproduction in any medium, provided you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons license, and indicate if changes were made. The Creative Commons Public Domain Dedication waiver (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/publicdomain/zero/1.0/">http://creativecommons.org/publicdomain/zero/1.0/</ext-link>) applies to the data made available in this article, unless otherwise stated.</license-p>
      </license>
    </permissions>
    <abstract id="Abs1">
      <p id="Par1">Culture-independent analysis of microbial communities frequently relies on amplification and sequencing of the prokaryotic 16S ribosomal RNA gene. Typical analysis pipelines group sequences into operational taxonomic units (OTUs) to infer taxonomic and phylogenetic relationships. Here, we present HmmUFOtu, a novel tool for processing microbiome amplicon sequencing data, which performs rapid per-read phylogenetic placement, followed by phylogenetically informed clustering into OTUs and taxonomy assignment. Compared to standard pipelines, HmmUFOtu more accurately and reliably recapitulates microbial community diversity and composition in simulated and real datasets without relying on heuristics or sacrificing speed or accuracy.</p>
      <sec>
        <title>Electronic supplementary material</title>
        <p>The online version of this article (10.1186/s13059-018-1450-0) contains supplementary material, which is available to authorized users.</p>
      </sec>
    </abstract>
    <kwd-group xml:lang="en">
      <title>Keywords</title>
      <kwd>Microbiome</kwd>
      <kwd>16S rRNA gene</kwd>
      <kwd>FM-index</kwd>
      <kwd>HMM profile alignment</kwd>
      <kwd>Phylogenetic placement</kwd>
      <kwd>Taxonomic assignment</kwd>
      <kwd>Operational taxonomic unit</kwd>
      <kwd>Dirichlet models</kwd>
      <kwd>DNA substitution models</kwd>
    </kwd-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100000069</institution-id>
            <institution>National Institute of Arthritis and Musculoskeletal and Skin Diseases</institution>
          </institution-wrap>
        </funding-source>
        <award-id>R00AR060873</award-id>
        <award-id>R01AR066663</award-id>
        <award-id>P30AR069589</award-id>
        <award-id>T32AR007465</award-id>
        <principal-award-recipient>
          <name>
            <surname>Grice</surname>
            <given-names>Elizabeth A.</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100000056</institution-id>
            <institution>National Institute of Nursing Research</institution>
          </institution-wrap>
        </funding-source>
        <award-id>R01NR015639</award-id>
        <principal-award-recipient>
          <name>
            <surname>Grice</surname>
            <given-names>Elizabeth A.</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100000051</institution-id>
            <institution>National Human Genome Research Institute</institution>
          </institution-wrap>
        </funding-source>
        <award-id>T32HG00046</award-id>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100000861</institution-id>
            <institution>Burroughs Wellcome Fund</institution>
          </institution-wrap>
        </funding-source>
      </award-group>
    </funding-group>
    <custom-meta-group>
      <custom-meta>
        <meta-name>issue-copyright-statement</meta-name>
        <meta-value>© The Author(s) 2018</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec id="Sec1">
    <title>Background</title>
    <p id="Par11">Culture-independent amplification, sequencing, and analysis of phylogenetic marker genes, such as the prokaryotic 16S ribosomal RNA (rRNA) gene, enables community-wide analysis of the diversity and composition of host-associated and environmental microbiota. These approaches heavily rely upon computational methods to cluster amplicon sequences into groups representing putatively conspecific sequences (operational taxonomic units [OTUs]) and to infer taxonomic and phylogenetic relationships [<xref ref-type="bibr" rid="CR1">1</xref>]. As sequencing costs decrease and throughput increases, tools for processing and analyzing these rapidly expanding datasets must also improve with respect to speed, computational burden, and accuracy.</p>
    <p id="Par12">A typical analysis workflow first assigns sequences to OTUs, then selects a representative sequence from each OTU, and all downstream taxonomic and diversity analyses are performed with the representative sequences (Fig. <xref rid="Fig1" ref-type="fig">1a</xref>). Taxonomic-based analyses allow investigators to assign an identity to sequences and then infer biological and functional attributes based on relationships to previously characterized and/or cultured taxa. OTU-based analyses are agnostic to taxonomic definitions; however, current clustering methods apply similarity thresholds (e.g. 97% similarity for species-level) that erroneously assume a stable rate of evolution across the length of the gene [<xref ref-type="bibr" rid="CR2">2</xref>, <xref ref-type="bibr" rid="CR3">3</xref>]. The required selection of a representative sequence from each OTU for taxonomic assignment and downstream analyses further compounds error and bias in OTU selection methods since this process precludes global optima due to the loss of information in the remaining sequences in an OTU. Together, these methods are widely used for profiling microbial communities; however, many serious practical concerns arise when considering their application to growing collections of 16S rRNA amplicon sequences.<fig id="Fig1"><label>Fig. 1</label><caption><p>General workflow of HmmUFOtu and the default OTU-based QIIME pipeline for 16S rRNA gene sequencing studies. <bold>a</bold> Main steps of the default QIIME pipeline include: (1) generating OTUs (OTU picking); (2) selecting an individual read for each OTU as the representative sequence (rep-seq picking); (3) assigning taxonomic information to every OTU by comparing the rep-seq to the reference database (taxonomic assignment); and optionally (4) aligning rep-seqs to the references; (5) constructing a de novo OTU tree using aligned rep-seqs. <bold>b</bold> Main steps of HmmUFOtu include: (1) per-read alignment and taxonomic assignment with profile-HMM and phylogenetic placement algorithms; (2) OTU picking around existing phylogenetic nodes to generate phylogeny-based OTUs, consensus based rep-seqs, and reference-based OTU tree. <italic>Dashed circles</italic>: phylogeny-based OTUs; <italic>gray dashed lines and dots</italic>: unneeded subtrees of the reference tree that are pruned to generate the OTU tree</p></caption><graphic xlink:href="13059_2018_1450_Fig1_HTML" id="MO1"/></fig></p>
    <p id="Par13">Commonly used OTU picking methods can be classified as de novo (e.g. cd-hit, BLAST, prefix/suffix/trie, UCLUST, USEARCH, Swarm, SortMeRNA, Mothur), closed-reference (“phylotyping;” e.g. uclust_ref, usearch_ref) or open-reference (“hybrid;” e.g. [<xref ref-type="bibr" rid="CR4">4</xref>–<xref ref-type="bibr" rid="CR9">9</xref>]). They differ, respectively, in whether sequences are compared to each other, a fixed reference dataset, or a combination of both approaches. Because pairwise comparison of sequences becomes computationally expensive with increasing sequencing depth, present OTU picking methods often use a heuristic when comparing reads, thereby compromising accuracy and efficacy. Open-reference OTU picking is the default and developer recommended methods for OTU clustering in QIIME [<xref ref-type="bibr" rid="CR10">10</xref>], a popular pipeline for performing microbial community analysis, though this method is well-known to result in inflated diversity estimates and to compromise the quality of the downstream data analysis [<xref ref-type="bibr" rid="CR11">11</xref>–<xref ref-type="bibr" rid="CR13">13</xref>].</p>
    <p id="Par14">Further compounding these sources of error and bias, presently preferred taxonomic assignment methods utilize distance-based methods, by identification of the closest reference sequence among pair-wise comparisons (e.g. BLAST, UCLUST) [<xref ref-type="bibr" rid="CR6">6</xref>, <xref ref-type="bibr" rid="CR9">9</xref>] or in a multiple-alignment profile (e.g. RDP classifier) [<xref ref-type="bibr" rid="CR14">14</xref>]. These taxonomic assignment methods have their respective advantages and disadvantages, but all neglect to incorporate established phylogenetic organization of known reference microorganisms. This exclusion can likely be attributed to the increased complexity of integrating reference phylogenetic information, due to the large number of reference sequences at a usable resolution (e.g. ~ 200,000 reference sequences in the GreenGenes 97% OTU “species level” reference tree) [<xref ref-type="bibr" rid="CR15">15</xref>].</p>
    <p id="Par15">Here, we present a novel strategy that addresses the limitations described above in the processing of microbial amplicon-based sequencing reads for the analysis of microbial community composition and diversity. We developed HmmUFOtu, a software tool that: (1) aligns sequences; (2) places every single- or paired-end read into a known reference tree; and (3) performs phylogeny-based OTU clustering, based on either observed leaves or inferred ancestors (Fig. <xref rid="Fig1" ref-type="fig">1b</xref>). The revised order of taxonomic assignment followed by OTU picking circumvents many of the previously discussed limitations and enables highly accurate alignment and taxonomic assignment, selection of biologically relevant representative sequences from each OTU, and robust phylogenetic community structures, as demonstrated in both simulated and real data benchmarks.</p>
  </sec>
  <sec id="Sec2">
    <title>Results</title>
    <p id="Par16">The HmmUFOtu (Hidden Markov Model [HMM]-based Ultra-Fast OTU tool) is composed of two core algorithms: (1) a banded-HMM profile alignment algorithm (banded-HMM) utilizing a consensus sequence FM-index (CSFM-index); and (2) the Seed-Estimate-Place (SEP) local phylogenetic placement algorithm. Both algorithms are designed specifically for phylogenetic markers such as the 16S rRNA gene, in which primers designed to anneal at highly conserved regions are used to amplify a portion of a target gene containing hypervariable regions. This feature led to our design of the CSFM-index powered banded-HMM algorithm, which restrains the regular profile HMM alignment algorithm with conserved seeds at the 5′ and 3′ ends of reads (Fig. <xref rid="Fig2" ref-type="fig">2a–c</xref>). The SEP algorithm takes advantage of both a phylogenetic placement algorithm introduced by similar tools [<xref ref-type="bibr" rid="CR16">16</xref>, <xref ref-type="bibr" rid="CR17">17</xref>] as well as our assumption that observing a novel instance of a read from a node, representing either an observed taxon or inferred ancestor, should not alter the overall topology of the known reference phylogenetic tree except for the local branch from which the read is emitted (Fig. <xref rid="Fig2" ref-type="fig">2d–g</xref>). Details of the core algorithms are fully elaborated in the “<xref rid="Sec15" ref-type="sec">Methods</xref>” section.<fig id="Fig2"><label>Fig. 2</label><caption><p>HmmUFOtu core algorithms. <bold>a</bold> Constructing a consensus sequence FM-index (CSFM-index) from a MSA using the Burrows-Wheeler transform (BWT) coupled with Wavelet-tree compression algorithms. <italic>Red</italic>: Actual stored data in a CSFM-index. <bold>b</bold> A “plan 7” (p7) HMM architecture specifically designed for 16S rRNA gene and other target gene/marker sequencing, with M (match), I (insertion), D (deletion), N (N′: 5′), C (C′: 3′), B (begin), and E (end) states, respectively. <italic>Dashed circles and arrows</italic>: “wing-retraction” process used to avoid empty alignment paths; <italic>red arrows</italic>: special transitions used to control the “global” or “local” alignment mode. <bold>c</bold> Banded-HMM Viterbi algorithm to find the most likely (minimum cost) path given the HMM profile (row), a read sequence (column), and two known “seed” paths by querying the CSFM-index. Only <italic>shaded grids</italic> are searched by the banded-Viterbi algorithm. The first and last shaded search areas rarely reach the profile ends. <bold>d</bold> An example of a 16S rRNA phylogenetic tree. In this tree, all directional conditional log-likelihoods (arrows in (e), (f), (g)) of all branches were pre-evaluated. The ancestral sequences of all internal nodes were inferred using maximum likelihood. <bold>e</bold> For a potential “seed” branch u--v, a small sub-tree containing only nodes u, v, the original conditional log-likelihoods L(u) and L(v) and original branch length w<sub>0</sub> are copied. <bold>f</bold> To place a new read n to branch u--v, a new internal node r is introduced, the new conditional log-likelihoods L(n) are evaluated, then initial branch lengths w<sub>rv</sub>, w<sub>ur</sub>, and w<sub>nr</sub> are estimated using observed distance (p-Dist). <bold>g</bold> For a candidate top estimation, the branch lengths w<sub>rv</sub>, w<sub>ur</sub>, w<sub>nr</sub> and L(rv), L(ru), and L(rn) are iteratively and jointly optimized until convergence</p></caption><graphic xlink:href="13059_2018_1450_Fig2_HTML" id="MO2"/></fig></p>
    <p id="Par17">To test HmmUFOtu performance, we built a benchmark HmmUFOtu database from the GreenGenes 97% reference database, “gg_97_otus_GTR,” using a pre-trained GTR DNA substitution model. This database roughly represents a prokaryotic (bacteria and archaea) species-level phylogenetic tree and contains ~ 200,000 nodes, of which all leaves (~ 100,000) and key internal nodes had assigned taxonomies. All unnamed internal nodes were assigned taxonomy by recursively back-tracing to their annotated ancestors.</p>
    <sec id="Sec3">
      <title>Simulated data</title>
      <p id="Par18">We first generated four simulated datasets from the “gg_97_otus_GTR” database. Each dataset contained sequences spanning different hypervariable regions of the 16S rRNA gene: (1) hypervariable region 4 (“V4”); (2) hypervariable regions 1 through 3 (“V1 V3”); (3) hypervariable regions 3 through 5 (“V3 V5”); and (4) a dataset containing segments drawn from random locations in the gene (“random”). We in silico “annealed” V4, V1 V3, and V3 V5 sequencing primers to the “gg_97_otus_GTR” database to obtain their consensus loci of the trained 16S HMM profile, then generated simulated reads using a procedure that mimics the construction of a real 16S library with the following steps: (1) a tree branch is randomly drawn from the reference tree; (2) a branching-point is drawn uniformly from this branch length; (3) a locus is uniformly drawn for the “random” dataset, or stays fixed at the known V4, V1 V3, or V3 V5 locus for their respective datasets (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S1); (4) amplicon size is either drawn from a truncated Gaussian distribution for the “random” dataset or fixed for V4, V1 V3, or V3 V5; (5) bases of the read are simulated according to the conditional likelihood of observing the four bases at the given branching point, or the gap probability at the consensus site (gaps are not present in the simulated reads). To replicate a practical 16S rRNA gene sequence survey, we generated 20 simulated samples, each containing 5000 in silico synthesized reads for the four datasets independently, in which both the consensus loci and the taxonomic assignment are known for all simulated reads. All four simulated datasets were then processed by HmmUFOtu and similar tools to evaluate their performance.</p>
      <sec id="Sec4">
        <title>HmmUFOtu achieves both high alignment accuracy and speed</title>
        <p id="Par19">To evaluate alignment performance, all four simulated datasets were aligned to the same 16S rRNA profile using HmmUFOtu, as well as hmmalign and nhmmer, two widely used HMM aligners from the HMMER3 package [<xref ref-type="bibr" rid="CR18">18</xref>, <xref ref-type="bibr" rid="CR19">19</xref>]. All three tested HMM-based tools achieved very high accuracy for the fixed locus datasets (V4, V1 V3, and V3 V5), but HmmUFOtu outperforms both hmmalign and nhmmer for the random dataset (Table <xref rid="Tab1" ref-type="table">1</xref>, upper panel), suggesting our banded-HMM algorithm and HMM architecture (Fig. <xref rid="Fig2" ref-type="fig">2a–c</xref>) can accurately map notably divergent reads. Additionally, HmmUFOtu is also about two- to threefold faster than hmmalign and nhmmer (Table <xref rid="Tab1" ref-type="table">1</xref>, lower panel), the latter of which is already an optimized algorithm for nucleotide alignment [<xref ref-type="bibr" rid="CR19">19</xref>]. Our banded-HMM algorithm significantly improves alignment accuracy and reduces the searching space compared to existing HMM algorithms by utilizing the relatively invariant “seeds” inherent to rRNA genes.<table-wrap id="Tab1"><label>Table 1</label><caption><p>Alignment accuracy (upper panel) and speed (lower panel) of HmmUFOtu and three other aligners benchmarked with four simulated datasets</p></caption><table frame="hsides" rules="groups"><thead><tr><th>Program</th><th>Random</th><th>V4</th><th>V1 V3</th><th>V3 V5</th></tr></thead><tbody><tr><td/><td align="center" colspan="4">Alignment accuracy (%)</td></tr><tr><td>hmmufotu</td><td>96.57</td><td>100.00</td><td>98.11</td><td>100.00</td></tr><tr><td>hmmalign</td><td>73.45</td><td>99.66</td><td>100.00</td><td>100.00</td></tr><tr><td>nhmmer</td><td>91.50</td><td>100.00</td><td>98.12</td><td>100.00</td></tr><tr><td>blastn</td><td>100.00</td><td>100.00</td><td>100.00</td><td>100.00</td></tr><tr><td/><td align="center" colspan="4">Speed (reads ∙ s<sup>− 1</sup> ∙ cpu<sup>−1</sup>)</td></tr><tr><td>hmmufotu</td><td>77.1</td><td>155.1</td><td>86.8</td><td>56.2</td></tr><tr><td>hmmalign</td><td>24.2</td><td>38.2</td><td>26.8</td><td>21.0</td></tr><tr><td>nhmmer</td><td>44.6</td><td>77.5</td><td>47.6</td><td>41.4</td></tr><tr><td>blastn</td><td>0.228</td><td>0.228</td><td>0.222</td><td>0.220</td></tr></tbody></table><table-wrap-foot><p>A correct alignment is defined as the aligned consensus locus overlapping with at least 90% of the true locus. Speed is measured as reads per second per processor. All HMM aligners used their own trained HMM models from the GreenGenes 97_OTUS reference sequence alignment; NCBI blastn used the best alignment among all hits. Accuracy results are based on the aggregate of 20 replicate samples; speed results are based on the average of 20 samples</p></table-wrap-foot></table-wrap></p>
        <p id="Par20">For further comparison, we also evaluated the alignment performance of a traditional pairwise alignment method using the NCBI blastn program [<xref ref-type="bibr" rid="CR9">9</xref>]. By aligning reads to all the sequences in the gg_97_otus_GTR database and using the best alignments for every read, we found that the NCBI blastn pairwise alignment algorithm can also achieve similarly high levels of accuracy as HmmUFOtu, but at considerably slower speeds (&gt; 300 times slower, Table <xref rid="Tab1" ref-type="table">1</xref>, lower panel). This result was not surprising, since a major advantage of the HMM-profile alignment algorithm is the multiple-sequence alignment (MSA) profile size-independent processing efficiency.</p>
      </sec>
      <sec id="Sec5">
        <title>HmmUFOtu achieves accurate taxonomic assignment for simulated reads at all taxonomy levels</title>
        <p id="Par21">We next evaluated the performance of HmmUFOtu to assign taxonomy at all levels ranging from kingdom to species using the previously described simulated datasets. Overall, we found that HmmUFOtu achieves very high assignment sensitivity (true positive rate [TPR] or recall), specificity (true negative rate [TNR]), and accuracy (ACC) at all levels (Table <xref rid="Tab2" ref-type="table">2</xref>, upper panel). The assignment sensitivity drops significantly at the species level, as does the assignment precision, but still retains high levels of specificity. This result may be an artefact of potential annotation errors at the species level in the GreenGenes database; it is important to note that only ~ 1/8 of all nodes with a genus level annotation also have a species level annotation (data not shown), suggesting the difficulty in generating accurate species level annotation. At this stage, HmmUFOtu was not compared to similar phylogenetic placement tools such as pplacer or EPA [<xref ref-type="bibr" rid="CR16">16</xref>, <xref ref-type="bibr" rid="CR17">17</xref>], because both tools failed to process the large reference tree due to technical errors most likely stemming from size restrictions (data not shown). Nevertheless, HmmUFOtu can perform taxonomic assignment at a speed of 3–4 reads per second per processor (Table <xref rid="Tab2" ref-type="table">2</xref>, upper panel), which in conjunction with its native and effective multi-threading support, permits fast and high throughput analyses.<table-wrap id="Tab2"><label>Table 2</label><caption><p>Taxonomic assignment performance (%) and speed of HmmUFOtu and two similar tools, pplacer and EPA, at different taxonomy levels</p></caption><table frame="hsides" rules="groups"><tbody><tr><td rowspan="2" colspan="2">Dataset</td><td colspan="7">Performance measurement</td><td rowspan="2">Speed</td></tr><tr><td>Kingdom</td><td>Phylum</td><td>Class</td><td>Order</td><td>Family</td><td>Genus</td><td align="center">Species</td></tr><tr><td rowspan="4">Random</td><td>TPR</td><td>100.00</td><td>99.96</td><td>99.52</td><td>99.22</td><td>98.87</td><td>95.03</td><td>81.96</td><td rowspan="4">3.14</td></tr><tr><td>TNR</td><td>nan</td><td>96.98</td><td>91.76</td><td>96.04</td><td>98.09</td><td>98.09</td><td>99.35</td></tr><tr><td>PPV</td><td>100.00</td><td>99.99</td><td>99.63</td><td>99.43</td><td>99.10</td><td>95.94</td><td>84.85</td></tr><tr><td>ACC</td><td>100.00</td><td>99.94</td><td>99.19</td><td>98.82</td><td>98.62</td><td>97.10</td><td>98.62</td></tr><tr><td rowspan="4">V4</td><td>TPR</td><td>100.00</td><td>99.96</td><td>99.52</td><td>99.26</td><td>99.17</td><td>95.78</td><td>82.75</td><td rowspan="4">4.61</td></tr><tr><td>TNR</td><td>nan</td><td>94.85</td><td>91.17</td><td>95.93</td><td>97.98</td><td>98.17</td><td>99.44</td></tr><tr><td>PPV</td><td>100.00</td><td>99.98</td><td>99.60</td><td>99.41</td><td>99.06</td><td>96.09</td><td>86.10</td></tr><tr><td>ACC</td><td>100.00</td><td>99.94</td><td>99.15</td><td>98.84</td><td>98.79</td><td>97.40</td><td>98.77</td></tr><tr><td rowspan="4">V1 V3</td><td>TPR</td><td>100.00</td><td>99.97</td><td>99.45</td><td>99.18</td><td>98.93</td><td>95.34</td><td>82.89</td><td rowspan="4">3.22</td></tr><tr><td>TNR</td><td>nan</td><td>98.84</td><td>89.52</td><td>95.51</td><td>97.56</td><td>97.93</td><td>99.26</td></tr><tr><td>PPV</td><td>100.00</td><td>99.99</td><td>99.51</td><td>99.36</td><td>98.86</td><td>95.53</td><td>82.83</td></tr><tr><td>ACC</td><td>100.00</td><td>99.96</td><td>99.01</td><td>98.72</td><td>98.49</td><td>97.11</td><td>98.58</td></tr><tr><td rowspan="4">V3 V5</td><td>TPR</td><td>100.00</td><td>99.96</td><td>99.61</td><td>99.39</td><td>99.40</td><td>96.98</td><td>86.71</td><td rowspan="4">3.15</td></tr><tr><td>TNR</td><td>nan</td><td>98.17</td><td>94.86</td><td>97.73</td><td>99.17</td><td>98.97</td><td>99.64</td></tr><tr><td>PPV</td><td>100.00</td><td>99.99</td><td>99.77</td><td>99.68</td><td>99.61</td><td>97.78</td><td>91.05</td></tr><tr><td>ACC</td><td>100.00</td><td>99.96</td><td>99.41</td><td>99.18</td><td>99.33</td><td>98.34</td><td>99.12</td></tr><tr><td rowspan="2" colspan="2">Program</td><td colspan="7">Performance measurement</td><td rowspan="2">Speed</td></tr><tr><td>Kingdom</td><td>Phylum</td><td>Class</td><td>Order</td><td>Family</td><td>Genus</td><td align="center">Species</td></tr><tr><td rowspan="4">HmmUFOtu</td><td>TPR</td><td>100.00</td><td>98.36</td><td>95.60</td><td>91.63</td><td>86.72</td><td>83.31</td><td>84.02</td><td rowspan="4">12.02</td></tr><tr><td>TNR</td><td>nan</td><td>95.05</td><td>94.97</td><td>96.29</td><td>97.50</td><td>98.71</td><td>99.71</td></tr><tr><td>PPV</td><td>100.00</td><td>99.11</td><td>95.65</td><td>90.81</td><td>84.11</td><td>80.48</td><td>83.04</td></tr><tr><td>ACC</td><td>100.00</td><td>97.86</td><td>95.31</td><td>94.96</td><td>96.07</td><td>97.79</td><td>99.44</td></tr><tr><td rowspan="4">Pplacer</td><td>TPR</td><td>100.00</td><td>99.92</td><td>99.68</td><td>99.58</td><td>99.70</td><td>100.00</td><td>100.00</td><td rowspan="4">3.23</td></tr><tr><td>TNR</td><td>nan</td><td>69.13</td><td>74.95</td><td>80.48</td><td>87.40</td><td>93.56</td><td>98.12</td></tr><tr><td>PPV</td><td>100.00</td><td>94.77</td><td>82.16</td><td>67.11</td><td>54.72</td><td>49.75</td><td>47.74</td></tr><tr><td>ACC</td><td>100.00</td><td>95.25</td><td>88.22</td><td>85.94</td><td>89.03</td><td>93.95</td><td>98.15</td></tr><tr><td rowspan="4">EPA</td><td>TPR</td><td>100.00</td><td>99.52</td><td>98.58</td><td>98.14</td><td>97.89</td><td>98.00</td><td>97.04</td><td rowspan="4">0.27</td></tr><tr><td>TNR</td><td>nan</td><td>82.12</td><td>84.06</td><td>87.74</td><td>92.06</td><td>95.76</td><td>98.89</td></tr><tr><td>PPV</td><td>100.00</td><td>96.89</td><td>87.74</td><td>76.20</td><td>65.31</td><td>59.53</td><td>60.07</td></tr><tr><td>ACC</td><td>100.00</td><td>96.88</td><td>91.85</td><td>90.71</td><td>92.83</td><td>95.89</td><td>98.86</td></tr></tbody></table><table-wrap-foot><p><italic>TPR</italic> sensitivity, <italic>TNR</italic> specificity, <italic>PPV</italic> precision, <italic>ACC</italic> accuracy, <italic>Nan</italic> no observed data</p><p>Speed is measured as reads per second per processor. Upper panel: results from running HmmUFOtu on four simulated datasets based on gg_97_otus_GTR database; Lower panel: results from running the three tested programs on the random79 dataset based on gg_79_otus_GTR database. Speed is measured as reads per second per processor. Performance measurement results are based on the aggregate of any replicate samples; speed results are based on the average of any replicate samples</p></table-wrap-foot></table-wrap></p>
        <p id="Par22">Although HmmUFOtu achieved high assignment accuracies at all taxonomy levels, we further investigated the balance between assignment sensitivity and precision. One concern was that incorrectly assigned taxa (low precision) may cause significant problems for downstream analyses, such as erroneous community compositions or false enrichment of “phantom” species. To this end, we generated precision and recall curves by varying the threshold of acceptable assignment Q scores calculated by HmmUFOtu. The Q-score is the posterior log-likelihood for a potential assignment to be correct given all considered assignments, which is mathematically equivalent to the “likelihood-weight” calculated by similar tools [<xref ref-type="bibr" rid="CR16">16</xref>, <xref ref-type="bibr" rid="CR17">17</xref>]. As previously shown, high assignment precision was achieved at all taxonomic levels except for the species level without any Q-score filtering (Fig. <xref rid="Fig3" ref-type="fig">3</xref>), illustrating the inherent strength of HmmUFOtu’s algorithms. At the species level, HmmUFOtu can achieve a more satisfactory assignment precision (≥ 90%) by setting the Q-score criteria as low as 3, resulting in a modest loss of sensitivity (&lt; 10%) (Fig. <xref rid="Fig3" ref-type="fig">3</xref>). Notably, the V3 V5 dataset exhibited better overall assignment performance for this simulated dataset (Fig. <xref rid="Fig3" ref-type="fig">3d</xref>), in agreement with previous findings where the V3 V5 region provide a more optimal combination of sequence divergence, amplicon size, and ease in primer design than the other regions tested in this study [<xref ref-type="bibr" rid="CR20">20</xref>].<fig id="Fig3"><label>Fig. 3</label><caption><p>Precision-recall (PR) curves for HmmUFOtu taxonomic assignment results on four simulated datasets: (<bold>a</bold>) random; (<bold>b</bold>) V4; (<bold>c</bold>) V1 V3; (<bold>d</bold>) V3 V5. True positive (TP) and true negative (TN) are defined as both the known and assigned taxonomy having or not having a certain level of taxonomy annotation, respectively. PR curves are calculated by varying the assignment Q-score threshold from 0 to 10 with a step of 1, then 20, 30, 40, 50, 60, and 250 (the maximum value)</p></caption><graphic xlink:href="13059_2018_1450_Fig3_HTML" id="MO3"/></fig></p>
        <p id="Par23">To compare the taxonomic assignment accuracy of HmmUFOtu with other phylogenetic placement tools, we built a smaller database using the GreenGenes 79% OTU data (gg_79_otus_GTR) that represents a mid-level (order/family) phylogenetic tree with only 2329 nodes, then generated a simulated dataset with 10,000 reads from random loci (random79). We did not generate similar V4, V1 V3, or V3 V5 datasets because these 16S primers were designed based on genus/species level reference sequences and thus the exact biological interpolation of such variable regions is not well defined at this higher level of taxonomy. The random79 dataset was processed by HmmUFOtu and two similar phylogenetic placement programs, pplacer and EPA [<xref ref-type="bibr" rid="CR16">16</xref>, <xref ref-type="bibr" rid="CR17">17</xref>]. With the default maximum likelihood mode, HmmUFOtu exhibits 5–10% higher overall accuracy at mid-level taxonomy (Table <xref rid="Tab2" ref-type="table">2</xref>, lower panel). We found that although all three tools have similarly high accuracies at the species level, both pplacer and EPA returned assignments with low precision and unexpectedly high sensitivity. This suggests that both pplacer and EPA exhibit a preference for placing sequences at lower branches of the phylogenetic tree proximal to the leaves, but the exact reason behind this behavior was not clear. In order to investigate this further, we calculated the Weighted UniFrac distance (also known as the Earth Mover’s Distance [<xref ref-type="bibr" rid="CR21">21</xref>]) for all placements between the reference placement positions (from the simulation) and the inferred positions by HmmUFOtu, pplacer, and EPA, and found that HmmUFOtu generated placements exhibit a smaller Weighted UniFrac distance than the other two tools (0.0878, 0.0958, and 0.0921 for HmmUFOtu, pplacer and EPA, respectively). This indicates that the greater observed placement accuracies (Table <xref rid="Tab2" ref-type="table">2</xref>, lower panel) were a result of pplacer and EPA placing sequences at the determined globally optimal position, which often resulted in lower taxonomic ranks. This propensity to place reads at lower taxonomic ranks can potentially result in spurious community compositions and has been actively addressed by other taxonomic assignment tools such as RDP classifier, SINTAX, and Metaxa2 [<xref ref-type="bibr" rid="CR14">14</xref>, <xref ref-type="bibr" rid="CR22">22</xref>]. HmmUFOtu uses the maximum likelihood placement, or equivalently a uniform placement prior, for taxonomy assignment by default, but the users can use an alternative node-height weighted prior for preferentially assigning reads at lower (near-leaf) taxonomy levels.</p>
        <p id="Par24">In addition to improved assignment accuracy, HmmUFOtu also ran at considerably faster speeds (4- to 40-fold faster in processing speed) than pplacer and EPA on the random79 dataset, respectively (Table <xref rid="Tab2" ref-type="table">2</xref>, lower panel). Notably, although the speed of pplacer and EPA cannot be strictly tested on large reference trees due to their technical limitations, the speed gain of HmmUFOtu is expected to be very profound on species resolution trees due to the linear time complexity of the two core algorithms with regard to total tree nodes [<xref ref-type="bibr" rid="CR16">16</xref>, <xref ref-type="bibr" rid="CR17">17</xref>].</p>
      </sec>
      <sec id="Sec6">
        <title>HmmUFOtu’s algorithms outperform traditional OTU-based methods for taxonomic assignment</title>
        <p id="Par25">As previously discussed, a typical analysis workflow for 16S rRNA sequence data first groups sequences into OTUs, then assigns all sequences within the same OTU the same taxonomic identity (Fig. <xref rid="Fig1" ref-type="fig">1</xref>). Although different in principle, both HmmUFOtu and traditional OTU-based methods eventually assign all reads to the reference taxa, giving us the opportunity to compare taxonomic assignment accuracy. We ran all four simulated datasets through the entire QIIME pipeline (v1.9.1) with default methods using UCLUST for OTU picking and taxonomy assignment and found that our profile-HMM and phylogenetic placement-based tool achieves much higher assignment accuracy at all phylogenetic levels (Fig. <xref rid="Fig4" ref-type="fig">4a, b</xref>). In contrast, the QIIME-default method only achieves similarly high accuracy at the higher taxonomic levels (phylum to order), suggesting the potential for a significant proportion of sequences being assigned to incorrect genus or species by traditional OTU-based methods.<fig id="Fig4"><label>Fig. 4</label><caption><p>Comparison of taxonomic assignment accuracy between HmmUFOtu and uclust, the QIIME-default OTU picking strategy, using the “gg_97_otus_GTR” database. The height of the <italic>bars</italic> reflects the assignment accuracy of four simulated datasets at different taxonomic levels using HmmUFOtu (<bold>a</bold>) or QIIME-default method (<bold>b</bold>, <bold>c</bold>). <bold>a</bold>, <bold>b</bold> Accuracy measured at per-read level. <bold>c</bold> Accuracy measured at per-OTU level</p></caption><graphic xlink:href="13059_2018_1450_Fig4_HTML" id="MO4"/></fig></p>
        <p id="Par26">In order to determine which step(s) of the OTU-based methods, namely OTU-picking and taxonomic assignment, might cause such assignment errors, we evaluated the assignment accuracy of QIIME-default methods at the OTU level, for which one representative sequence from each OTU was analyzed. At the OTU level, the assignment accuracy only slightly increases over assignment at the per-read level (Fig. <xref rid="Fig4" ref-type="fig">4c</xref>), suggesting the traditional distance-based taxonomic assignment methods as the primary contributors of assignment error compared to a phylogenetic placement-based method. We also observed a modest increase in assignment accuracy at the OTU level for the V4 dataset (Fig. <xref rid="Fig4" ref-type="fig">4c</xref> vs. b), which contains the least sequence diversity. This highlights the impact of the OTU-picking step on overall assignment accuracy, especially for less divergent datasets where reads are often grouped into larger OTUs.</p>
      </sec>
    </sec>
    <sec id="Sec7">
      <title>Application on real data</title>
      <p id="Par27">Real microbiome datasets are more complicated than simulated datasets, as they can be paired-ended, are subject to polymerase chain reaction (PCR) and sequencing errors, contain large amplicons with non-overlapping mates, or contain other experimental errors. Additionally, the true taxonomic identities of real datasets are usually unknown, making it impossible to adequately analyze the accuracy of read-level taxonomic assignment. In this study, we further benchmarked HmmUFOtu and similar tools using real datasets consisting of: (1) 16S rRNA amplicon datasets generated from a synthetic “mock” bacterial community DNA sample (“mock dataset;” Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S2); and (2) publicly available 16S rRNA amplicon datasets generated by the Human Microbiome Project (“HMP dataset;” Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S3).</p>
      <sec id="Sec8">
        <title>HmmUFOtu closely recapitulates mock community composition and diversity</title>
        <p id="Par28">DNA isolated from a synthetic mock bacterial community was amplified and sequenced using either the V4 or V1 V3 protocol as part of every Illumina MiSeq run performed by our group. The mock community contains genomic DNA of 20 different bacterial species belonging to 17 different genera with equivalent concentrations of 16S rRNA genes from each species (100,000 copies per organism per μL). We used the pre-processed V4 and V1 V3 mock community datasets with forward/reverse reads assembled by Pear v0.9.0 [<xref ref-type="bibr" rid="CR23">23</xref>] for analysis with both HmmUFOtu and the QIIME-default method. The relative community compositions at the genus level were calculated for each analysis with the generated OTU tables. Due to a built-in feature for processing unmerged paired-end reads (see “<xref rid="Sec15" ref-type="sec">Methods</xref>”), we also processed the raw unassembled paired-end V4 and V1 V3 reads with HmmUFOtu.</p>
        <p id="Par29">When comparing the OTU tables generated by each analysis to the theoretical composition of genus-level mock community taxa, we found that HmmUFOtu closely recapitulated the compositions of the reference community, especially for the V4 mock dataset (Fig. <xref rid="Fig5" ref-type="fig">5a, b</xref>). This similarity remains stable across the replicate samples that were sequenced on different Illumina runs, as revealed by the relatively invariant beta-diversity dissimilarity between HmmUFOtu inferred and reference compositions (Fig. <xref rid="Fig5" ref-type="fig">5c</xref>), indicating that our algorithm is robust to experimental conditions.<fig id="Fig5"><label>Fig. 5</label><caption><p>Comparison of inferred bacterial community structures between HmmUFOtu and QIIME-default methods using V4 and V1 V3 mock community datasets. Both mock datasets contain ten replicates sequenced across ten different Illumina MiSeq runs. <bold>a</bold>, <bold>b</bold> Inferred and theoretical () mock community compositions for V4 and V1 V3 datasets, respectively, calculated using HmmUFOtu or QIIME-default generated OTU tables. <italic>Bars</italic>: replicate samples; assembled: pre-processed paired-end merged reads; paired: un-processed paired-end reads. <bold>c</bold> Community structure dissimilarity between the inferred and reference community structure as calculated by the Bray-Curtis beta-diversity metric. The median is represented by the <italic>line</italic> in the <italic>box</italic>, <italic>hinges</italic> represent the first and third quartiles, <italic>whiskers</italic> represent 1.5 times the interquartile range, and <italic>dots</italic> represent outlying data points. <bold>d</bold> Alpha-diversity of the mock community measured by the inferred number of observed species. <italic>Box plots</italic> are as above. <italic>Left panels</italic>: V4 datasets; <italic>right panels</italic>: V1 V3 datasets</p></caption><graphic xlink:href="13059_2018_1450_Fig5_HTML" id="MO5"/></fig></p>
        <p id="Par30">We also found that while both HmmUFOtu and QIIME-default methods revealed similar mock community compositions, HmmUFOtu assigns fewer reads to taxonomies outside of the 17 reference genera, especially for the V4 dataset (Fig. <xref rid="Fig5" ref-type="fig">5a</xref>). We further scrutinized these results by comparing alpha diversity as measured by the number of observed species, independent of the known taxonomic assignment of the reference taxa (Fig. <xref rid="Fig5" ref-type="fig">5d</xref>). The QIIME-default method consistently inflated the number of observed species compared to HmmUFOtu (Fig. <xref rid="Fig5" ref-type="fig">5d</xref>, Kruskal–Wallis test; <italic>p</italic> &lt; 3.7e-5 and <italic>p</italic> &lt; 3.8e-5 for the V4 and V1 V3 dataset, respectively). HmmUFOtu also exhibited stability between different sequencing and processing strategies (assembled vs paired, V4 vs V1 V3, Fig. <xref rid="Fig5" ref-type="fig">5d</xref>). Additionally, we found that using unassembled paired-end reads with HmmUFOtu produced slightly more accurate and stable community structures (Fig. <xref rid="Fig5" ref-type="fig">5c, d</xref>) compared to assembled reads. Given that up to 5% of all reads could be lost during the paired-end merging step (data not shown), we strongly recommend the input of quality trimmed unassembled, demultiplexed paired-end reads.</p>
      </sec>
      <sec id="Sec9">
        <title>HmmUFOtu’s phylogeny-based OTUs and consensus-based representative sequences better capture the real bacterial genomic sequences</title>
        <p id="Par31">HmmUFOtu generates phylogeny-based OTUs using the basic assumption that each tree node would become its own OTU, as they are either true observed (leaf) or inferred ancestor (internal) sequences. Therefore, any phylogenetic tree node with reads placed closest to it becomes a phylogeny-based OTU (Fig. <xref rid="Fig1" ref-type="fig">1a</xref>). Instead of picking one sequence as the representative sequence of an OTU, we take advantage of both pre-aligned reads (by the banded-HMM algorithm) and pre-evaluated Log-Likelihoods (by the SEP algorithm) of the OTU, and then use a Bayesian statistical model to infer the consensus sequence of the observed OTU node (see “<xref rid="Sec15" ref-type="sec">Methods</xref>”). By aligning the generated representative sequences (rep-seqs) to the known genomic sequences of the mock community bacteria (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S2) using NCBI blastn program [<xref ref-type="bibr" rid="CR9">9</xref>], we found that the HmmUFOtu’s consensus based rep-seqs show a higher sequence similarity (percent identity) to the reference genomes compared to the QIIME-default method that uses the first read (“first”) in each OTU (Fig. <xref rid="Fig6" ref-type="fig">6a</xref>, Kruskal–Wallis test; <italic>p</italic> → 0 for both V4 and V1 V3 datasets), suggesting the consensus of all observed sequences generally better represents the true bacterial target gene sequences by aggregating information across multiple reads and/or samples.<fig id="Fig6"><label>Fig. 6</label><caption><p>Comparing the quality of rep-seqs between HmmUFOtu’s consensus-based and QIIME’s single-sequence based rep-seq picking methods. For HmmUFOtu: the consensus sequences with (default) or without the priors were tested; for QIIME: the “first,” “longest,” and “random” methods were tested. <bold>a</bold> Mock datasets, in which the quality is reflected by the %identity between the rep-seqs and the known bacterial reference genomes. <bold>b</bold> HMP datasets, in which the quality is reflected by the %identity between the rep-seqs and the de novo assembled scaffolds from the WGS data sequenced in the same samples. LAH left auriculotemporal part of head, RAH right auriculotemporal part of head</p></caption><graphic xlink:href="13059_2018_1450_Fig6_HTML" id="MO6"/></fig></p>
        <p id="Par32">To further confirm that the known reference genome sequences correctly reflect the real 16S rRNA gene sequences and do not suffer from incorrect annotations or other errors, we compiled a second real dataset from the Human Microbiome Project (HMP) which contains ten samples from five distinct body sites interrogated at two independent visits using the Roche/454 Next-Gen Sequencing (NGS) platform (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S3). These samples were selected because they all have matched whole genomic shotgun (WGS) sequencing data available that were sequenced using the same platform (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S3). Similar to the mock community dataset results, we found that HmmUFOtu generates rep-seqs that more closely resemble the assembled microbiota scaffolds from the WGS data compared to the QIIME-default “first” OTU-picking method (Fig. <xref rid="Fig6" ref-type="fig">6b</xref>). In addition, two other rep-seq picking methods from QIIME, “longest” and “random,” similarly produce rep-seqs with lower sequence identity to the WGS-based scaffolds. Also, we failed to detect a significant difference in accuracy when HmmUFOtu either utilized or ignored prior phylogenetic information to infer the consensus-based rep-seqs. Overall, we found that using the consensus sequences across multiple reads produces more accurate rep-seqs compared to single-read based methods (Fig. <xref rid="Fig6" ref-type="fig">6b</xref>, Kruskal–Wallis test; <italic>p</italic> &lt; 7.6e-10). Moreover, HmmUFOtu can construct the phylogenetic tree of OTUs (OTU-tree) in negligible time compared to the de novo tree construction method used by the QIIME pipeline (data not shown), which is achieved by simply pruning the reference tree to exclude subtrees without any placed reads (Fig. <xref rid="Fig1" ref-type="fig">1b</xref>).</p>
      </sec>
    </sec>
    <sec id="Sec10">
      <title>Detection of chimeric sequences</title>
      <p id="Par33">Amplicon sequencing of highly conserved marker genes such as the 16S rRNA gene can produce “chimeric” DNA sequences, which are often caused by an unintentional ligation of two distinct but closely related DNA templates during the PCR amplification step [<xref ref-type="bibr" rid="CR24">24</xref>]. The summarization of the placement log-likelihood of our SEP algorithm over all aligned regions may be biased by chimeric reads, resulting in incorrect phylogenetic placement at some common ancestor of the two initial templates, subsequently introducing artificial and erroneous OTUs. In order to detect potential chimeric reads, we developed a “segment placement comparison” algorithm that borrows the idea of “segment alignment,” a method commonly used in other published chimera detection tools such as ChimeraSlayer and UCHIME [<xref ref-type="bibr" rid="CR24">24</xref>, <xref ref-type="bibr" rid="CR25">25</xref>] (see “<xref rid="Sec15" ref-type="sec">Methods</xref>”). Briefly, HmmUFOtu compares the joint log-odds (LOD) of alternative vs best placement of both a 5′ and 3′ segments. For benchmarking performance, we generated a simulated dataset of chimeric sequences from the GreenGenes 97% OTU reference sequences (“gg_97_otus_chimera”) using a procedure similar to the method described by UCHIME [<xref ref-type="bibr" rid="CR25">25</xref>] involving the following steps: (1) a pair of reference sequences are randomly selected from the GreenGenes 97% OTU database, as long as the p-distance between their aligned sequences falls into any of the four ranges (i.e. [0.01,0.03), [0.03,0.05), [0.05,0.10), [0.10,0.15)); (2) a breaking point is uniformly drawn at their aligned (consensus) positions; (3) if the breaking point is within [0.25,0.75), the two reference sequences are in silico spliced and ligated into a chimeric sequence, otherwise the first sequence is kept unchanged; lastly, gaps from the alignment of chimeric and unchanged sequences are removed, whereby the resulting sequences are used as the simulated dataset. When testing performance, we found HmmUFOtu’s “segment placement comparison” algorithm could reliably identify chimera sequences with ~ 90% accuracy even with a minimum LOD threshold of zero (0) (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S4). As expected, the overall accuracy of chimera detection drops as the similarity between sequences increases (smaller p-distance); the accuracy dropped to 85% in the most extreme case (p-distance in [0.01,0.03), Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S4). The sensitivity is consistently &gt; 90% at this cut-off, comparable to previous reported sensitivities (&gt; 70%) on different simulated datasets [<xref ref-type="bibr" rid="CR24">24</xref>, <xref ref-type="bibr" rid="CR25">25</xref>], which supports the efficacy of our segment placement-based algorithm. We then compared the chimera detection sensitivity and specificity curves (ROC curves) of our algorithm by varying the minimum LOD cut-offs to ensure minimal classification of non-specific (false-positive) chimeric sequences, which can cause a significant loss of information. As shown in Fig. <xref rid="Fig7" ref-type="fig">7a</xref>, the specificity can be improved to &gt; 90% (FPR or false positive rate &lt; 0.1) by setting a minimum LOD cut-off as low as 50 with only a modest sensitivity loss (&lt; 10%). This trend was also observed in the [0.01,0.03] sub-dataset that are most difficult to detect given the similarity in the two initial sequences (Fig. <xref rid="Fig7" ref-type="fig">7a</xref>, red curve). Thus, we set the default LOD cut-off for chimera detection at 50 for specific results with high retention.</p>
      <p id="Par34">In order to estimate the proportion of chimeric results in the real datasets we previously analyzed, we re-processed all the mock and HMP datasets by enabling the chimera-detecting algorithm using the recommended LOD cut-off (50). Surprisingly, the mock V1 V3 dataset exhibits a consistently high estimated proportion of chimeric reads in the range of 20–30%, which is much higher than either the mock V4 dataset (2–3%) or the HMP dataset (5–10%) (Fig. <xref rid="Fig7" ref-type="fig">7b</xref>). Although there is no clear explanation for the discrepancy in proportions of chimeras, we speculate that higher rates stem from deeper sequencing depths (data not shown), larger consensus amplicons sizes, and the less efficient annealing properties of the forward primers used in the mock V1 V3 dataset (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S1).</p>
      <p id="Par35">We have suggested that chimeric reads likely lead to artifact OTUs during analysis. To verify this, we regenerated the phylogeny-based OTUs with the chimera-filtered results and found the overall alpha-diversity of the communities, as measured by the “observed species” metric, decreased proportionally with the number of chimeric reads (Fig. <xref rid="Fig7" ref-type="fig">7c</xref>), suggesting that most chimeras produced singleton OTUs in the original unfiltered analysis.</p>
    </sec>
    <sec id="Sec11">
      <title>Multi-threading performance and vectorization</title>
      <p id="Par36">One technical limitation of traditional OTU-picking methods is the difficulty in parallelizing jobs due to the pairwise-comparisons inherent to most methods. Furthermore, parallelization of the taxonomic assignment step is often implemented externally by utilizing UNIX sub-processes that dramatically increase the hardware burden. In contrast, the HmmUFOtu core algorithms are designed to be independent for each read (see “<xref rid="Sec15" ref-type="sec">Methods</xref>”) and can thus be easily parallelized (multi-threaded) across multiple reads. The native multi-threading support also reduces the requirement of hardware resources, which is critical for very large inputs.</p>
      <p id="Par37">We benchmarked the multi-threading performance of HmmUFOtu using one simulated sample containing 5000 reads from each of the four simulated datasets with 1, 2, 4, 8, or 16 threads. We found that the processing speed of HmmUFOtu increased almost linearly to the number of threads up to the delegation of eight threads (Fig. <xref rid="Fig8" ref-type="fig">8a</xref>). When employing 16 threads, the linear relationship was most likely lost due to the restriction of total available physical cores (12 in total) on the benchmarking machine. This is illustrated by the near-linear increase of the average CPU usage (Fig. <xref rid="Fig8" ref-type="fig">8b</xref>). Notably, HmmUFOtu only requires a near-constant RAM regardless of the CPU usage or the type of data (Fig. <xref rid="Fig8" ref-type="fig">8c</xref>), thus in theory, permitting the program to handle much larger 16S datasets generated in the future without requiring an equivalent demand in RAM.<fig id="Fig7"><label>Fig. 7</label><caption><p>Benchmarking results from chimeric read detection using the “segment placement comparison” algorithm from HmmUFOtu. <bold>a</bold> Receiver operating characteristic (ROC) curves for detecting simulated chimeric reads from random in silico cross-over events using GreenGenes 97% OTU reference sequences; 10,000 chimeric or non-chimeric simulated reads were used in the respective range for each p-distance subset. ROC curves are calculated by varying the min LOD cut-off from 0 to 10 with a step of 1, then 20 to 100 with a step of 10. <bold>b</bold> Estimated proportion of chimeric reads in all of the benchmarked real datasets (mock and HMP) by enabling HmmUFOtu’s chimera detection and setting the LOD cut-off at 50. <bold>c</bold> Differences in “observed species” alpha diversity of the mock community V1 V3 dataset. Paired: original results using raw paired reads; Nonchimera: chimera-filtered results using the same paired reads</p></caption><graphic xlink:href="13059_2018_1450_Fig7_HTML" id="MO7"/></fig><fig id="Fig8"><label>Fig. 8</label><caption><p>Multi-threading performance of HmmUFOtu benchmarked on four simulated datasets on 1–16 threads. <bold>a</bold> Relative processing speed (reads per second) normalized to 1-thread results. <bold>b</bold> Average CPU usage (%). <bold>c</bold> Maximum RAM (memory) usage in GB. All results are based on the average of 20 replicate samples</p></caption><graphic xlink:href="13059_2018_1450_Fig8_HTML" id="MO8"/></fig></p>
      <p id="Par38">Vectorization is a programming technique based on processor supplementary instruction sets available on many processors (such as Intel and AMD), which can significantly improve the processing speed of mathematical operations especially for vector and matrix operations. HmmUFOtu utilizes the built-in vectorization ability of Eigen3, which supports SSE2 and higher standards. For example, HmmUFOtu can quickly perform the matrix exponential calculations required by the GTR DNA substitution model, comparable in time to the processing of less complex DNA models that are based on simple tractable numerical calculations (TN93 and HKY85, Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S5).</p>
    </sec>
    <sec id="Sec12">
      <title>Implementation of multiple DNA and mutation rate models</title>
      <p id="Par39">The previously described analyses, including those performed on both simulated and real datasets, were processed using the gg_97_otus_GTR database, which uses the default generalized time-reversible (GTR) DNA substitution model to evaluate the likelihood of the reference phylogenetic trees [<xref ref-type="bibr" rid="CR26">26</xref>, <xref ref-type="bibr" rid="CR27">27</xref>]. Although the GTR model is used by the GreenGenes database [<xref ref-type="bibr" rid="CR15">15</xref>], we further tested HmmUFOtu on other popular models, since these simpler DNA models, such as TN93 [<xref ref-type="bibr" rid="CR28">28</xref>] or HKY85 [<xref ref-type="bibr" rid="CR29">29</xref>], are generally more robust due to the smaller number of free parameters and mathematically tractable features. We compared the GTR, TN93, and HKY85 DNA models using the V4 simulated dataset with the same methods described above and found that all models exhibit very similar assignment performance regarding the sensitivity, specificity, precision, and accuracy at all taxonomy levels (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S5). Notably, the simpler models TN93 and HKY85 often lead to slightly better assignment results even if the reference tree was built using the GTR model (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S5), suggesting that by using fewer free parameters, these models can still capture sufficient information from the phylogenetic structure of bacteria.</p>
      <p id="Par40">In addition to the different DNA models, we also studied the heterogeneity of mutation rates among different 16S rRNA gene sites by capturing the rate variation among sites using Discrete Gamma Distribution (<italic>dΓ)</italic> based models [<xref ref-type="bibr" rid="CR30">30</xref>] (see “<xref rid="Sec15" ref-type="sec">Methods</xref>”). Interestingly, by allowing variation among sites using the <italic>dΓ</italic> model, the assignment sensitivity and precision both experience significant loss compared to the fixed rate models (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S5), potentially due to the construction of reference trees in GreenGenes, which assumed fixed rate models [<xref ref-type="bibr" rid="CR15">15</xref>]. Considering that the processing speed is much slower (~ 1.5× slower at default settings; Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S5), we strongly recommend against using a Gamma model of among site rate variation for reference trees built with fixed rate models. Further, the estimated shape parameters of the <italic>dΓ</italic> models are usually around 0.5, indicating that most 16S rRNA gene sites are almost completely “invariant” (constant regions), while “mutation hotspots” exist in limited sites (hypervariable regions) [<xref ref-type="bibr" rid="CR31">31</xref>], recapitulating previous estimations of the shape parameters in a study using multiple methods [<xref ref-type="bibr" rid="CR32">32</xref>] (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S5).</p>
    </sec>
  </sec>
  <sec id="Sec13">
    <title>Discussion</title>
    <p id="Par41">Traditional workflows based on distance-based approaches first group sequences into OTUs, then assign taxonomy to (often arbitrarily) selected representative sequences. These methods are widely adapted due to the straightforward nature of their concepts and relatively well-established algorithms; however, they suffer from major drawbacks such as non-optimized assignments, sensitivity to input data order, limited statistical underpinnings, and disregard of the phylogenetic nature of bacterial sequences [<xref ref-type="bibr" rid="CR1">1</xref>, <xref ref-type="bibr" rid="CR8">8</xref>, <xref ref-type="bibr" rid="CR12">12</xref>, <xref ref-type="bibr" rid="CR33">33</xref>]. Many of these shortcomings stem from circumventing computationally expensive algorithms and complex implementations of related methods in favor of faster heuristics.</p>
    <p id="Par42">We highlight the shortcomings of these methods by comparing HmmUFOtu to the default methods implemented by the widely used QIIME platform [<xref ref-type="bibr" rid="CR10">10</xref>]. In both real and simulated datasets, HmmUFOtu outperforms QIIME default methods in accurately recapitulating microbial community composition and diversity. Notably, HmmUFOtu produces results with biologically realistic metrics regarding diversity and selects rep-seqs that more accurately represent the consensus sequence of the OTU. We also heavily employ prior knowledge in our tool, such as searching for “seed” alignments in the banded-HMM algorithm, as well as the stepwise SEP algorithm that uses the inherent phylogenetic nature of 16S rRNA genes.</p>
    <p id="Par43">HmmUFOtu organizes amplicon reads into OTUs by grouping together reads that have been placed around reference phylogenetic nodes. This procedure is independent of sample size and input order, two features that can affect traditional OTU-based methods, resulting in error-prone and slow analyses [<xref ref-type="bibr" rid="CR1">1</xref>]. Additionally, because each sequence is individually processed by HmmUFOtu, subsets of samples can be pre-processed before the collection of all samples; users would only need to summarize over all pre-processed assignment files to initiate downstream analyses, a step that generally takes only minutes. However, one limitation of HmmUFOtu to consider is the operation within constraints of a reference tree. References will be biased toward those organisms that are readily culturable, may not fully represent the biodiversity of a community, and may lead to generic taxonomic assignment at very high levels (phylum or class) [<xref ref-type="bibr" rid="CR11">11</xref>].</p>
    <p id="Par44">The algorithms implemented in HmmUFOtu are both powerful and flexible enough to be extended into microbiome research beyond the prokaryotic domain. Similar conserved marker genes exist in other systems, such as the eukaryotic 18S rRNA gene and fungal ITS region, from which amplicon sequencing data are rapidly accumulating. However, the current standard databases for eukaryotic marker genes are not as well annotated as the 16S rRNA gene databases; for example, the “SILVA” database for the eukaryotic 18S rRNA gene only provides a “guide-tree” for their sequences, which lacks branch length information and is not bi-sectional [<xref ref-type="bibr" rid="CR34">34</xref>, <xref ref-type="bibr" rid="CR35">35</xref>]. Further, the “UNITE” database for the fungal ITS region does not provide any phylogenetic tree due to the high variance of ITS sequences [<xref ref-type="bibr" rid="CR36">36</xref>]. Until fully evaluated and expert-curated phylogenetic trees from these databases are released, traditional OTU-based tools such as QIIME [<xref ref-type="bibr" rid="CR10">10</xref>] and Mothur [<xref ref-type="bibr" rid="CR5">5</xref>] will still be the preferred choices for analyzing eukaryotic amplicon sequencing data. A potential application for future available eukaryotic marker gene databases (i.e. ribosomal small subunit database) would be the ability to distinguish between prokaryotic and eukaryotic sequences in a sample as to remove the “contaminating” mitochondria and chloroplast 16S (m16S and c16S) sequences often found in environmental and fecal samples. However, presently, users are encouraged to use other non-phylogenetic based tools such as Metaxa2 [<xref ref-type="bibr" rid="CR22">22</xref>] for pre-filtering eukaryotic m16S and c16S sequences.</p>
    <p id="Par45">While researchers increasingly employ metagenomic and other multi-omic approaches for inferring characteristics of microbial communities and their interactions with the host and environment, amplicon sequencing of the 16S rRNA gene remains a staple in the toolkit of microbial community ecology. HmmUFOtu considerably improves upon current methods that form the core of popular analysis workflows by incorporating phylogenetic information into the crucial OTU-picking step and thereby improves the quality of downstream analyses and interpretations.</p>
  </sec>
  <sec id="Sec14">
    <title>Conclusions</title>
    <p id="Par46">Here we describe a novel method for resolving a fundamental problem in 16S rRNA gene amplicon and other target-gene based microbiome research – clustering sequences into biologically relevant OTUs and correctly assigning taxonomy to all reads within the OTU. We achieve this using two core algorithms: a CSFM-index powered banded-HMM algorithm and a SEP local phylogenetic placement algorithm. Our banded-HMM algorithm achieves high accuracy when aligning to a 16S rRNA gene sequence MSA, similar to other HMM-based aligners, but does so at 2–3 times the speed. The SEP algorithm achieves high accuracy, sensitivity, specificity, and precision in taxonomic assignment performance, even at species-level resolution for both simulated and real datasets, at speeds up to 30 times faster than current phylogenetic placement tools [<xref ref-type="bibr" rid="CR16">16</xref>, <xref ref-type="bibr" rid="CR17">17</xref>]. Taken together, HmmUFOtu can perform HMM-profile alignment, phylogenetic placement-based taxonomic assignment, phylogeny-based OTU picking, and consensus-based representative sequence inference in a species-resolution reference tree with ~ 200,000 nodes for 1 million 16S rRNA gene amplicon sequences within 6 h on a modest Linux workstation or cluster with 16 processors, 32 GB RAM, and ~ 20 GB disk requirement.</p>
  </sec>
  <sec id="Sec15">
    <title>Methods</title>
    <sec id="Sec16">
      <title>CSFM-index powered banded-HMM alignment algorithm</title>
      <p id="Par47">The banded-HMM alignment algorithm is designed to align NGS reads to a MSA profile with the assistance of short anchored segments, or “seeds,” along a known alignment path. To achieve this, the algorithm first attempts to find up to two seeds at the 5′ and 3′ end of a read using a CSFM-index data structure (Fig. <xref rid="Fig1" ref-type="fig">1a</xref>). The CSFM-index is a modified version of an FM-index (Full-text index in Minute space, a compressed full-text index based on the Burrows-Wheeler Transform) [<xref ref-type="bibr" rid="CR37">37</xref>] that stores additional information for quickly locating the consensus sequence (CS) position in an MSA profile. Our CSFM-index implementation also utilizes a Wavelet-tree for indexing BWT strings [<xref ref-type="bibr" rid="CR38">38</xref>], thus resulting in a small memory footprint and fast search speeds.</p>
      <p id="Par48">In order to accurately align NGS reads to the MSA profile, HmmUFOtu employs a widely used HMM architecture with seven special states (“plan7”) to capture the site-specific transition and emission features (Fig. <xref rid="Fig1" ref-type="fig">1b</xref>), which mimics the same core model used by the HMMER3 package [<xref ref-type="bibr" rid="CR18">18</xref>]. However, our “plan7” architecture includes modifications designed for 16S rRNA gene sequence alignment, specifically, limiting alignment of reads to one 16S profile, rather than aligning against multiple profiles, via the “J” state. The model has also been modified for unbiased local-alignment regarding the HMM profile by allowing direct entrance into intermediate match (“M”) states with comparable probabilities. Additionally, our architecture introduces the I<sub>0</sub> and I<sub>K</sub> states representing the frequently observed 5′ and 3′ overhangs in 16S rRNA sequence reads stemming from non-conserved 5′ and 3′ tail regions in some bacteria species.</p>
      <p id="Par49">Once the 5′ and 3′ seed alignment paths are identified by CSFM-index searches, HmmUFOtu uses a banded version of the Viterbi algorithm to find the global optimal alignment between the NGS read and HMM profile in or near these seed regions (Fig. <xref rid="Fig1" ref-type="fig">1c</xref>, gray regions), which maximizes the log-likelihood (equivalently, minimizes the cost) of observing the read sequence given the trained HMM-profile (Fig. <xref rid="Fig1" ref-type="fig">1c</xref>) using Dynamic Programming (DP). The banded HMM algorithm Procedure-Banded-HMM is further explicated below.</p>
      <graphic position="anchor" xlink:href="13059_2018_1450_Figa_HTML" id="MO9"/>
      <p id="Par50">where Diag-Dist and Procedure-Viterbi-DP are described in the <xref rid="Sec27" ref-type="sec">Appendix</xref>.</p>
      <p id="Par51">It is of note that for a very small proportion of NGS reads, no seed-alignment can be found by CSFM-index searches; we handle these reads with the standard, non-banded, HMM algorithm, as described previously [<xref ref-type="bibr" rid="CR18">18</xref>]. For paired-end reads, the forward and reverse mates were independently aligned using our method, then the alignments are merged as if a single assembled read were used, regardless of whether the forward or reverse mates have overlapping tails. To assess the alignment accuracy, a correct alignment is defined as overlapping ≥ 90% of its true locus, a commonly used threshold in many similar situations as described previously [<xref ref-type="bibr" rid="CR39">39</xref>, <xref ref-type="bibr" rid="CR40">40</xref>].</p>
    </sec>
    <sec id="Sec17">
      <title>SEP local phylogenetic placement algorithm</title>
      <p id="Par52">Once a NGS read is aligned to the MSA profile using the banded HMM algorithm, HmmUFOtu uses a local phylogenetic placement-based method to assign the correct taxonomic identification to a read based on the alignment. Unlike previous phylogenetic placement-based tools such as pplacer and EPA [<xref ref-type="bibr" rid="CR16">16</xref>, <xref ref-type="bibr" rid="CR17">17</xref>], HmmUFOtu makes the assumption that the global topology and branches of the bacterial phylogenetic tree should not be affected by observing an instance of a read, with the exception of adding a novel local branch as necessary for maintaining the correct bi-sectional tree topology (Fig. <xref rid="Fig2" ref-type="fig">2</xref>). In essence, the SEP procedure identifies the candidate optimal phylogenetic placement in three steps: first, it finds a candidate list of seed nodes with sequences (observed or inferred) that meet a similarity threshold to the read, as measured by observed p-distance (Fig. <xref rid="Fig2" ref-type="fig">2b</xref>, “seed” step). The algorithm then estimates the branching-point, the length of the new branch, and the sub-tree likelihood using the Procedure-Estimate-Place described below (Fig. <xref rid="Fig2" ref-type="fig">2c</xref>, “estimate” step). This can be proven to produce near-optimal tree likelihoods and can be performed efficiently since it neither modifies the original reference tree, nor creates an actual copy of the sub-tree (Procedure-Estimate-Place). Finally, estimated placements are sorted by their likelihoods; for every top candidate, a detailed placement algorithm copies the sub-tree, inserts the observed read node according to the aforementioned estimations (Fig. <xref rid="Fig2" ref-type="fig">2e, f</xref>), and iteratively optimizes the estimations by maximizing the placement likelihood, or the posterior probability if a prior is used. The final log-likelihood of this subtree is equivalent to the log-likelihood of the entire tree, according to the Pulley Principle [<xref ref-type="bibr" rid="CR41">41</xref>], as long as a time-reversible DNA substitution model is used (e.g. GTR, TN93, or HKY85 model). This step is further outlined in the Procedure-Joint-Opt-Place described below (Fig. <xref rid="Fig2" ref-type="fig">2g</xref>, “place” step).</p>
      <graphic position="anchor" xlink:href="13059_2018_1450_Figb_HTML" id="MO10"/>
      <p id="Par53">where ● represents the vector’s dot product, <bold>pDist</bold> is the p-distance between the observed or inferred sequence of a node and a read, and <bold>Leaf-LogLik</bold> for evaluating a leaf node as described previously [<xref ref-type="bibr" rid="CR41">41</xref>]. The <bold>Convolute</bold> is the core, numerical-underflow-free function that calculates the convolution between a node’s log-likelihood matrix whose columns are the conditional log-likelihood vectors, and a branch’s transition probability matrix, and the Procedure-Estimate-Branch is a p-distance-based branch length estimation method, both of which are described in the <xref rid="Sec27" ref-type="sec">Appendix</xref>.</p>
      <graphic position="anchor" xlink:href="13059_2018_1450_Figc_HTML" id="MO11"/>
      <p id="Par54">where <bold>Procedure-Evaluate</bold> is the Felsenstein’s pruning algorithm for tree evaluation as mentioned above [<xref ref-type="bibr" rid="CR41">41</xref>] and <bold>Procedure-Optimize-Branch</bold> for branch-optimization is an EM based algorithm as described previously [<xref ref-type="bibr" rid="CR41">41</xref>].</p>
    </sec>
    <sec id="Sec18">
      <title>Segment placement comparison algorithm for chimeric read detection</title>
      <p id="Par55">HmmUFOtu implements a “segment placement comparison” algorithm based on principles similar to previously described segment alignment-based methods such as ChimeraSlayer and UCHIME [<xref ref-type="bibr" rid="CR24">24</xref>, <xref ref-type="bibr" rid="CR25">25</xref>]. This algorithm: (1) breaks an aligned sequence (from a read or pair) into an even number of equal sized segments; (2) runs the SEP procedure on every segment using the common set of “seeds” for the entire sequence; (3) picks the best placement for both the 5′ and 3′ segment (5′-best and 3′-best); (4) calculates the alternative placements by re-running the “Estimate” and “Place” procedures for the 5′-segment sequence at the 3′-best branch (5′-alt) and vice versa for the 3′-segment (3′-alt); (5) calculates the joined LOD scores as<disp-formula id="Equa"><alternatives><tex-math id="M1">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ LOD=\left({loglik}^{5\hbox{'}- best}-{loglik}^{5\hbox{'}- alt}\right)+\left({loglik}^{3\hbox{'}- best}-{loglik}^{3\hbox{'}- alt}\right) $$\end{document}</tex-math><mml:math id="M2" display="block"><mml:mi mathvariant="italic">LOD</mml:mi><mml:mo>=</mml:mo><mml:mfenced close=")" open="("><mml:mrow><mml:msup><mml:mtext mathvariant="italic">loglik</mml:mtext><mml:mrow><mml:mn>5</mml:mn><mml:mo>'</mml:mo><mml:mo>−</mml:mo><mml:mtext mathvariant="italic">best</mml:mtext></mml:mrow></mml:msup><mml:mo>−</mml:mo><mml:msup><mml:mtext mathvariant="italic">loglik</mml:mtext><mml:mrow><mml:mn>5</mml:mn><mml:mo>'</mml:mo><mml:mo>−</mml:mo><mml:mi mathvariant="italic">alt</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mfenced><mml:mo>+</mml:mo><mml:mfenced close=")" open="("><mml:mrow><mml:msup><mml:mtext mathvariant="italic">loglik</mml:mtext><mml:mrow><mml:mn>3</mml:mn><mml:mo>'</mml:mo><mml:mo>−</mml:mo><mml:mtext mathvariant="italic">best</mml:mtext></mml:mrow></mml:msup><mml:mo>−</mml:mo><mml:msup><mml:mtext mathvariant="italic">loglik</mml:mtext><mml:mrow><mml:mn>3</mml:mn><mml:mo>'</mml:mo><mml:mo>−</mml:mo><mml:mi mathvariant="italic">alt</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mfenced></mml:math><graphic xlink:href="13059_2018_1450_Article_Equa.gif" position="anchor"/></alternatives></disp-formula>and; (6) identifies potential chimeras where the assigned phylogenetic tree nodes of the 5′-best and 3′-best placements fail to match and the LOD score exceeds a defined cut-off.</p>
    </sec>
    <sec id="Sec19">
      <title>Building HmmUFOtu databases</title>
      <p id="Par56">All HmmUFOtu databases used in our benchmarks were built by the “hmmufotu-build” program using the GreenGenes reference alignment, tree, and taxonomy annotation files. The build process generally consists of building the multiple-alignment index and CSFM-index, training the banded HMM profile, building and evaluating the phylogenetic tree, and optionally estimating the shape parameter of the <italic>dΓ</italic> model for among-site rate variation and subsequent re-evaluation of the tree (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S6). The database building process supports multi-threading, with time complexity proportional to the total number of nodes and consensus sites in the reference phylogenetic tree; this process requires ~ 10 mins for building the “gg_97_otus_GTR” database with six processors on the Linux workstation described below.</p>
    </sec>
    <sec id="Sec20">
      <title>Mock bacteria community processing</title>
      <p id="Par57">The mock community bacteria samples were purchased from the America Type Culture Collection (ATCC®) (Catalog # HM-782D). Both the V4 and V1 V3 samples were sequenced as control samples across multiple Illumina MiSeq runs with 150-bp or 300-bp paired-end platforms, respectively. All mock community runs were sequenced by the PENN FGS/NGSC center.</p>
    </sec>
    <sec id="Sec21">
      <title>Estimating model parameters in HmmUFOtu database construction</title>
      <p id="Par58">In order to train an HMM-profile for a given MSA, we adopted the common practice of using Dirichlet-multinomial models as prior distributions of observed transition and emission data [<xref ref-type="bibr" rid="CR42">42</xref>] as it balances prior biological knowledge with the observed training data. We trained 16S rRNA gene-specific Dirichlet-multinomial models using the GreenGenes gg_97_otus reference dataset for use in our analyses and benchmarking. Specifically, we used Dirichlet-density models (DDs) for transitions and insertion emissions (Fig. <xref rid="Fig1" ref-type="fig">1b</xref>, “I” states) and Dirichlet-mixture models (DMs) for the match emissions (Fig. <xref rid="Fig1" ref-type="fig">1b</xref>, “M” states). During training, the weights of the observed MSA are normalized using a position-specific method as described previously [<xref ref-type="bibr" rid="CR42">42</xref>]. Pre-trained Dirichlet-multinomial models are distributed with HmmUFOtu (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S7), but users can also train customized models on their own data.</p>
      <p id="Par59">To train the DNA substitution models, we estimated all potential “ancestral-offspring” mutations using the Gojobori 3-sequence method [<xref ref-type="bibr" rid="CR43">43</xref>] and then estimated the DNA model parameters for the GTR, TN93, and HKY85 models [<xref ref-type="bibr" rid="CR26">26</xref>, <xref ref-type="bibr" rid="CR28">28</xref>, <xref ref-type="bibr" rid="CR29">29</xref>]. HmmUFOtu also supports the Goldman two-sequence method [<xref ref-type="bibr" rid="CR44">44</xref>] for DNA model training as well as many other popular DNA substitution models. The complete list can be found in Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S8. Pre-trained DNA substitution models are distributed along with HmmUFOtu source code, but users may also train customized DNA models on their own data.</p>
      <p id="Par60">To estimate the shape parameter α of each <italic>dΓ</italic> model used for among-site rate variation in the HmmUFOtu databases we constructed, the 16S rRNA phylogenetic tree was evaluated with one pass using a fixed rate model, then the number of observed mutations occurring at each site is calculated using the known tree topology. The shape parameters were then estimated using the moment matching method, which assumes the parameters follow a negative-binomial distribution, as previously described [<xref ref-type="bibr" rid="CR32">32</xref>]. The amount of time required for training customized models is negligible compared to building the database. Details of model training can be found in Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S6.</p>
    </sec>
    <sec id="Sec22">
      <title>Generating phylogeny-based OTUs, consensus-based representative sequences, and OTU-trees</title>
      <p id="Par61">During the OTU summarization step of HmmUFOtu (“hmmufotu-sum”), any phylogenetic tree node containing more than a preset threshold of placed reads across all samples is defined as an OTU containing the NGS reads placed closest to it. To infer the consensus sequences, the posterior probability of observing the four nucleotides at each site is calculated from the observed base counts from aligned reads and a Dirichlet density prior with parameters proportional to the pre-evaluated node likelihood and a concentration parameter of 2. A concentration parameter of N is equivalent to using N unobserved, background “pseudo” reads for each OTU, but this prior can be disabled if set to 0. The consensus base at every site is then inferred by either choosing the base that maximizes the posterior probability or inserting a gap if more gaps were observed. Finally, a phylogenetic tree containing the OTUs is generated by pruning the original reference tree, leaving only nodes defined as an OTU and nodes required to maintain the bi-sectional property of the tree. Specific details of this process can be found in Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S6.</p>
    </sec>
    <sec id="Sec23">
      <title>Benchmarking settings and data analysis</title>
      <p id="Par62">All benchmarking tests were performed on a Linux workstation with 8 Intel Xeon® processors @ 3.70 GHz and 64 GB RAM, except for the multi-threading performance tests, which were performed on a Linux cluster node with 24 Intel Xeon® processors (12 physical cores) @ 3.07 GHz and 96 GB RAM. Speed and resource statistics are based on the “user” time from system log files. All tested third-party programs were run with the default options, unless specified otherwise. The default methods in the QIIME workflow were: “UCLUST” for OTU-picking, “first” for rep-seq picking, “UCLUST” for assigning taxonomy, “PyNAST” for aligning OTUs, and “FastTree” for constructing the phylogenetic tree of OTUs [<xref ref-type="bibr" rid="CR6">6</xref>, <xref ref-type="bibr" rid="CR45">45</xref>, <xref ref-type="bibr" rid="CR46">46</xref>]. All alignment and taxonomic assignment accuracy results were calculated using in-house Perl scripts. For taxonomic assignment accuracy benchmarks, the alignment outputs from HmmUFOtu were used as inputs for both pplacer and EPA to ensure fair comparisons. The alpha-diversity and beta-diversity analyses of mock communities were calculated with QIIME scripts [<xref ref-type="bibr" rid="CR10">10</xref>] using the observed species and Bray-Curtis metrics, respectively. Details can be found in Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S6.</p>
    </sec>
    <sec id="Sec24">
      <title>Data requirements and program output</title>
      <p id="Par63">All core programs of HmmUFOtu accept sequences in FASTA or FASTQ format, MSA profiles in FASTA aligned format, and phylogenetic trees in Newick format. The model training programs output in customized plain-text formats (“hmmufotu-train-dm” for Dirichlet prior models, “hmmufotu-train-sm” for DNA substitution models) or in standard HMMER3 text format [<xref ref-type="bibr" rid="CR18">18</xref>] (“hmmufotu-train-hmm” for HMM profiles). The database building program “hmmufotu-build” outputs databases as custom binary files. The main program “hmmufotu” outputs taxonomy assignments in tab-delimited plain-text format (TSV format). The OTU summarization program “hmmufotu-sum” outputs results in TSV format, which is compatible with third-party tools such as QIIME; it also optionally outputs the rep-seqs in FASTA format and the OTU-tree in Newick format. Optionally, “hmmufotu-jplace” may convert outputted TSV assignment files into “jplace” format for compatibility with third-party tools [<xref ref-type="bibr" rid="CR47">47</xref>] as long as the dependency C++ library JsonCpp is installed or specified during the configuration step.</p>
    </sec>
    <sec id="Sec25">
      <title>Implementation, dependency, and portability</title>
      <p id="Par64">HmmUFOtu is written in C++ 98 and is only dependent on the header-only libraries of C++ boost and Eigen3 for Newick tree parsing, statistics, and linear-algebra operations. Both libraries are available on most operating systems (OS) and do not require installation. Multi-threading of HmmUFOtu is implemented when native OpenMP is available. All HmmUFOtu tools are built by GNU Autotools allowing for easy installation on most OS including Linux, Mac OS X, and Windows. Pre-compiled HmmUFOtu executables are also available at <ext-link ext-link-type="uri" xlink:href="https://github.com/Grice-Lab/HmmUFOtu/releases">https://github.com/Grice-Lab/HmmUFOtu/releases</ext-link>.</p>
    </sec>
    <sec id="Sec26">
      <title>System requirements</title>
      <p id="Par65">HmmUFOtu pre-evaluates and stores all the directional conditional log-likelihoods of a reference phylogenetic tree, thus requiring a relatively large amount of memory (RAM) and disk space. For example, the “gg_97_otus_GTR” reference database takes about 20 GB RAM and disk space for both database building and read processing.</p>
    </sec>
  </sec>
  <sec sec-type="supplementary-material">
    <sec id="Sec28">
      <title>Additional file</title>
      <p>
        <supplementary-material content-type="local-data" id="MOESM1">
          <media xlink:href="13059_2018_1450_MOESM1_ESM.docx">
            <label>Additional file 1:</label>
            <caption>
              <p>Including supplementary Tables S1–S8 described in this study. (DOCX 74 kb)</p>
            </caption>
          </media>
        </supplementary-material>
      </p>
    </sec>
  </sec>
</body>
<back>
  <app-group>
    <app id="App1">
      <sec id="Sec27">
        <title>Appendix</title>
        <graphic position="anchor" xlink:href="13059_2018_1450_Figd_HTML" id="MO12"/>
        <graphic position="anchor" xlink:href="13059_2018_1450_Fige_HTML" id="MO13"/>
        <graphic position="anchor" xlink:href="13059_2018_1450_Figf_HTML" id="MO14"/>
        <graphic position="anchor" xlink:href="13059_2018_1450_Figg_HTML" id="MO15"/>
        <p id="Par73">where <italic>MIN_EXP</italic> is a scaling constant to avoid numeric-underflow errors.</p>
      </sec>
    </app>
  </app-group>
  <glossary>
    <title>Abbreviations</title>
    <def-list>
      <def-item>
        <term>BWT</term>
        <def>
          <p id="Par2">Burrows-Wheeler transform</p>
        </def>
      </def-item>
      <def-item>
        <term>CSFM-index</term>
        <def>
          <p id="Par3">Consensus-sequence Full-Text index</p>
        </def>
      </def-item>
      <def-item>
        <term>DD</term>
        <def>
          <p id="Par4">Dirichlet density</p>
        </def>
      </def-item>
      <def-item>
        <term>DM</term>
        <def>
          <p id="Par5">Dirichlet mixture</p>
        </def>
      </def-item>
      <def-item>
        <term>
          <italic>dΓ</italic>
        </term>
        <def>
          <p id="Par6">Discrete-Gamma model</p>
        </def>
      </def-item>
      <def-item>
        <term>HMM</term>
        <def>
          <p id="Par7">Hidden Markov model</p>
        </def>
      </def-item>
      <def-item>
        <term>OS</term>
        <def>
          <p id="Par8">Operating system</p>
        </def>
      </def-item>
      <def-item>
        <term>OTU</term>
        <def>
          <p id="Par9">Operational taxonomic unit</p>
        </def>
      </def-item>
      <def-item>
        <term>SEP</term>
        <def>
          <p id="Par10">Seed-Estimate-Place</p>
        </def>
      </def-item>
    </def-list>
  </glossary>
  <fn-group>
    <fn>
      <p>
        <bold>Electronic supplementary material</bold>
      </p>
      <p>The online version of this article (10.1186/s13059-018-1450-0) contains supplementary material, which is available to authorized users.</p>
    </fn>
  </fn-group>
  <ack>
    <title>Acknowledgements</title>
    <p>We thank Kyle Bittinger for his invaluable input on improving HmmUFOtu; we also thank Joseph Horwinski for constructing and sequencing the mock community libraries used in our previous studies.</p>
    <sec id="FPar1">
      <title>Funding</title>
      <p id="Par66">This work was supported in part by grants from the National Institutes of Health, National Institute of Arthritis, Musculoskeletal, and Skin Diseases (R00AR060873 and R01AR066663 to EAG), the Penn Skin Biology and Diseases Resource-based Center (P30AR069589 to Sarah E. Millar, EAG Co-Investigator), and the National Institute of Nursing Research (R01NR015639 to EAG). JSM was supported by NIH T32HG00046, Computational Genomics Training Grant and CBM was supported by NIH T32AR007465, Dermatology Research Training Grant.</p>
    </sec>
    <sec id="FPar2">
      <title>Availability of data and materials</title>
      <p id="Par67">The source code of HmmUFOtu is freely available at <ext-link ext-link-type="uri" xlink:href="https://github.com/Grice-Lab/HmmUFOtu/">https://github.com/Grice-Lab/HmmUFOtu/</ext-link>. The version of source code used in this manuscript has been deposited to the DOI compatible site of Zenodo at <ext-link ext-link-type="uri" xlink:href="https://zenodo.org/record/1189817">https://zenodo.org/record/1189817</ext-link> (DOI: 10.5281/zenodo.1189817). The V4 and V1 V3 mock community datasets were deposited into the NCBI SRA as BioProject PRJNA402045 [<xref ref-type="bibr" rid="CR48">48</xref>].</p>
    </sec>
  </ack>
  <notes notes-type="author-contribution">
    <title>Authors’ contributions</title>
    <p>QZ designed the algorithms, implemented HmmUFOtu, and submitted data to SRA; CBM helped benchmark performance with the QIIME pipeline; JSM designed the workflow charts and helped analyze the mock community datasets; EAG provided resources, funding, and supervision; QZ, CBM, and EAG composed the manuscript. All authors reviewed and edited the manuscript. All authors read and approved the final manuscript.</p>
  </notes>
  <notes notes-type="COI-statement">
    <sec id="FPar3">
      <title>Authors’ information</title>
      <p id="Par68">Jacquelyn S. Meisel, PhD is now a Postdoctoral Associate at the Institute of Advanced Computer Studies (UMIACS) at the University of Maryland College Park. The new contact email for Dr. Meisel is meiselj@umiacs.umd.edu.</p>
    </sec>
    <sec id="FPar4">
      <title>Ethics approval and consent to participate</title>
      <p id="Par69">None of the authors have any ethics or consent issues to declare for the experimental data used in this study. HmmUFOtu is licensed under the GNU General Public License v3.0.</p>
    </sec>
    <sec id="FPar5">
      <title>Consent for publication</title>
      <p id="Par70">All authors have consented to the publication of this work in <italic>Genome Biology</italic>.</p>
    </sec>
    <sec id="FPar6">
      <title>Competing interests</title>
      <p id="Par71">The authors declare that they have no competing interests.</p>
    </sec>
    <sec id="FPar7">
      <title>Publisher’s Note</title>
      <p id="Par72">Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p>
    </sec>
  </notes>
  <ref-list id="Bib1">
    <title>References</title>
    <ref id="CR1">
      <label>1.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Schloss</surname>
            <given-names>PD</given-names>
          </name>
          <name>
            <surname>Westcott</surname>
            <given-names>SL</given-names>
          </name>
        </person-group>
        <article-title>Assessing and improving methods used in operational taxonomic unit-based approaches for 16S rRNA gene sequence analysis</article-title>
        <source>Appl Environ Microbiol</source>
        <year>2011</year>
        <volume>77</volume>
        <fpage>3219</fpage>
        <lpage>3226</lpage>
        <pub-id pub-id-type="doi">10.1128/AEM.02810-10</pub-id>
        <?supplied-pmid 21421784?>
        <pub-id pub-id-type="pmid">21421784</pub-id>
      </element-citation>
    </ref>
    <ref id="CR2">
      <label>2.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Schloss</surname>
            <given-names>PD</given-names>
          </name>
        </person-group>
        <article-title>The effects of alignment quality, distance calculation method, sequence filtering, and region on the analysis of 16S rRNA gene-based studies</article-title>
        <source>PLoS Comput Biol</source>
        <year>2010</year>
        <volume>6</volume>
        <fpage>e1000844</fpage>
        <pub-id pub-id-type="doi">10.1371/journal.pcbi.1000844</pub-id>
        <?supplied-pmid 20628621?>
        <pub-id pub-id-type="pmid">20628621</pub-id>
      </element-citation>
    </ref>
    <ref id="CR3">
      <label>3.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kim</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Morrison</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Yu</surname>
            <given-names>Z</given-names>
          </name>
        </person-group>
        <article-title>Evaluation of different partial 16S rRNA gene sequence regions for phylogenetic analysis of microbiomes</article-title>
        <source>J Microbiol Methods</source>
        <year>2011</year>
        <volume>84</volume>
        <fpage>81</fpage>
        <lpage>87</lpage>
        <pub-id pub-id-type="doi">10.1016/j.mimet.2010.10.020</pub-id>
        <?supplied-pmid 21047533?>
        <pub-id pub-id-type="pmid">21047533</pub-id>
      </element-citation>
    </ref>
    <ref id="CR4">
      <label>4.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Li</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Godzik</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>Cd-hit: a fast program for clustering and comparing large sets of protein or nucleotide sequences</article-title>
        <source>Bioinformatics</source>
        <year>2006</year>
        <volume>22</volume>
        <fpage>1658</fpage>
        <lpage>1659</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btl158</pub-id>
        <?supplied-pmid 16731699?>
        <pub-id pub-id-type="pmid">16731699</pub-id>
      </element-citation>
    </ref>
    <ref id="CR5">
      <label>5.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Schloss</surname>
            <given-names>PD</given-names>
          </name>
          <name>
            <surname>Westcott</surname>
            <given-names>SL</given-names>
          </name>
          <name>
            <surname>Ryabin</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Hall</surname>
            <given-names>JR</given-names>
          </name>
          <name>
            <surname>Hartmann</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Hollister</surname>
            <given-names>EB</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Introducing mothur: open-source, platform-independent, community-supported software for describing and comparing microbial communities</article-title>
        <source>Appl Environ Microbiol</source>
        <year>2009</year>
        <volume>75</volume>
        <fpage>7537</fpage>
        <lpage>7541</lpage>
        <pub-id pub-id-type="doi">10.1128/AEM.01541-09</pub-id>
        <?supplied-pmid 19801464?>
        <pub-id pub-id-type="pmid">19801464</pub-id>
      </element-citation>
    </ref>
    <ref id="CR6">
      <label>6.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Edgar</surname>
            <given-names>RC</given-names>
          </name>
        </person-group>
        <article-title>Search and clustering orders of magnitude faster than BLAST</article-title>
        <source>Bioinformatics</source>
        <year>2010</year>
        <volume>26</volume>
        <fpage>2460</fpage>
        <lpage>2461</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btq461</pub-id>
        <?supplied-pmid 20709691?>
        <pub-id pub-id-type="pmid">20709691</pub-id>
      </element-citation>
    </ref>
    <ref id="CR7">
      <label>7.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kopylova</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Noe</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Touzet</surname>
            <given-names>H</given-names>
          </name>
        </person-group>
        <article-title>SortMeRNA: fast and accurate filtering of ribosomal RNAs in metatranscriptomic data</article-title>
        <source>Bioinformatics</source>
        <year>2012</year>
        <volume>28</volume>
        <fpage>3211</fpage>
        <lpage>3217</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/bts611</pub-id>
        <?supplied-pmid 23071270?>
        <pub-id pub-id-type="pmid">23071270</pub-id>
      </element-citation>
    </ref>
    <ref id="CR8">
      <label>8.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Mahe</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Rognes</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Quince</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>de Vargas</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Dunthorn</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>Swarm: robust and fast clustering method for amplicon-based studies</article-title>
        <source>PeerJ</source>
        <year>2014</year>
        <volume>2</volume>
        <fpage>e593</fpage>
        <pub-id pub-id-type="doi">10.7717/peerj.593</pub-id>
        <?supplied-pmid 25276506?>
        <pub-id pub-id-type="pmid">25276506</pub-id>
      </element-citation>
    </ref>
    <ref id="CR9">
      <label>9.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Johnson</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Zaretskaya</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Raytselis</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Merezhuk</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>McGinnis</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Madden</surname>
            <given-names>TL</given-names>
          </name>
        </person-group>
        <article-title>NCBI BLAST: a better web interface</article-title>
        <source>Nucleic Acids Res</source>
        <year>2008</year>
        <volume>36</volume>
        <fpage>W5</fpage>
        <lpage>W9</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/gkn201</pub-id>
        <?supplied-pmid 18440982?>
        <pub-id pub-id-type="pmid">18440982</pub-id>
      </element-citation>
    </ref>
    <ref id="CR10">
      <label>10.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Caporaso</surname>
            <given-names>JG</given-names>
          </name>
          <name>
            <surname>Kuczynski</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Stombaugh</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Bittinger</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Bushman</surname>
            <given-names>FD</given-names>
          </name>
          <name>
            <surname>Costello</surname>
            <given-names>EK</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>QIIME allows analysis of high-throughput community sequencing data</article-title>
        <source>Nat Methods</source>
        <year>2010</year>
        <volume>7</volume>
        <fpage>335</fpage>
        <lpage>336</lpage>
        <pub-id pub-id-type="doi">10.1038/nmeth.f.303</pub-id>
        <?supplied-pmid 20383131?>
        <pub-id pub-id-type="pmid">20383131</pub-id>
      </element-citation>
    </ref>
    <ref id="CR11">
      <label>11.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Edgar</surname>
            <given-names>RC</given-names>
          </name>
        </person-group>
        <article-title>Accuracy of microbial community diversity estimated by closed- and open-reference OTUs</article-title>
        <source>PeerJ</source>
        <year>2017</year>
        <volume>5</volume>
        <fpage>e3889</fpage>
        <pub-id pub-id-type="doi">10.7717/peerj.3889</pub-id>
        <?supplied-pmid 29018622?>
        <pub-id pub-id-type="pmid">29018622</pub-id>
      </element-citation>
    </ref>
    <ref id="CR12">
      <label>12.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Westcott</surname>
            <given-names>SL</given-names>
          </name>
          <name>
            <surname>Schloss</surname>
            <given-names>PD</given-names>
          </name>
        </person-group>
        <article-title>De novo clustering methods outperform reference-based methods for assigning 16S rRNA gene sequences to operational taxonomic units</article-title>
        <source>PeerJ</source>
        <year>2015</year>
        <volume>3</volume>
        <fpage>e1487</fpage>
        <pub-id pub-id-type="doi">10.7717/peerj.1487</pub-id>
        <?supplied-pmid 26664811?>
        <pub-id pub-id-type="pmid">26664811</pub-id>
      </element-citation>
    </ref>
    <ref id="CR13">
      <label>13.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Schloss</surname>
            <given-names>PD</given-names>
          </name>
        </person-group>
        <article-title>Application of a database-independent approach to assess the quality of operational taxonomic unit picking methods</article-title>
        <source>mSystems</source>
        <year>2016</year>
        <volume>1</volume>
        <fpage>e00027-16</fpage>
        <pub-id pub-id-type="doi">10.1128/mSystems.00027-16</pub-id>
        <?supplied-pmid 27832214?>
        <pub-id pub-id-type="pmid">27832214</pub-id>
      </element-citation>
    </ref>
    <ref id="CR14">
      <label>14.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wang</surname>
            <given-names>Q</given-names>
          </name>
          <name>
            <surname>Garrity</surname>
            <given-names>GM</given-names>
          </name>
          <name>
            <surname>Tiedje</surname>
            <given-names>JM</given-names>
          </name>
          <name>
            <surname>Cole</surname>
            <given-names>JR</given-names>
          </name>
        </person-group>
        <article-title>Naive Bayesian classifier for rapid assignment of rRNA sequences into the new bacterial taxonomy</article-title>
        <source>Appl Environ Microbiol</source>
        <year>2007</year>
        <volume>73</volume>
        <fpage>5261</fpage>
        <lpage>5267</lpage>
        <pub-id pub-id-type="doi">10.1128/AEM.00062-07</pub-id>
        <?supplied-pmid 17586664?>
        <pub-id pub-id-type="pmid">17586664</pub-id>
      </element-citation>
    </ref>
    <ref id="CR15">
      <label>15.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>DeSantis</surname>
            <given-names>TZ</given-names>
          </name>
          <name>
            <surname>Hugenholtz</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Larsen</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Rojas</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Brodie</surname>
            <given-names>EL</given-names>
          </name>
          <name>
            <surname>Keller</surname>
            <given-names>K</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Greengenes, a chimera-checked 16S rRNA gene database and workbench compatible with ARB</article-title>
        <source>Appl Environ Microbiol</source>
        <year>2006</year>
        <volume>72</volume>
        <fpage>5069</fpage>
        <lpage>5072</lpage>
        <pub-id pub-id-type="doi">10.1128/AEM.03006-05</pub-id>
        <?supplied-pmid 16820507?>
        <pub-id pub-id-type="pmid">16820507</pub-id>
      </element-citation>
    </ref>
    <ref id="CR16">
      <label>16.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Berger</surname>
            <given-names>SA</given-names>
          </name>
          <name>
            <surname>Krompass</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Stamatakis</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>Performance, accuracy, and Web server for evolutionary placement of short sequence reads under maximum likelihood</article-title>
        <source>Syst Biol</source>
        <year>2011</year>
        <volume>60</volume>
        <fpage>291</fpage>
        <lpage>302</lpage>
        <pub-id pub-id-type="doi">10.1093/sysbio/syr010</pub-id>
        <?supplied-pmid 21436105?>
        <pub-id pub-id-type="pmid">21436105</pub-id>
      </element-citation>
    </ref>
    <ref id="CR17">
      <label>17.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Matsen</surname>
            <given-names>FA</given-names>
          </name>
          <name>
            <surname>Kodner</surname>
            <given-names>RB</given-names>
          </name>
          <name>
            <surname>Armbrust</surname>
            <given-names>EV</given-names>
          </name>
        </person-group>
        <article-title>pplacer: linear time maximum-likelihood and Bayesian phylogenetic placement of sequences onto a fixed reference tree</article-title>
        <source>BMC Bioinformatics</source>
        <year>2010</year>
        <volume>11</volume>
        <fpage>538</fpage>
        <pub-id pub-id-type="doi">10.1186/1471-2105-11-538</pub-id>
        <?supplied-pmid 21034504?>
        <pub-id pub-id-type="pmid">21034504</pub-id>
      </element-citation>
    </ref>
    <ref id="CR18">
      <label>18.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Mistry</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Finn</surname>
            <given-names>RD</given-names>
          </name>
          <name>
            <surname>Eddy</surname>
            <given-names>SR</given-names>
          </name>
          <name>
            <surname>Bateman</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Punta</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>Challenges in homology search: HMMER3 and convergent evolution of coiled-coil regions</article-title>
        <source>Nucleic Acids Res</source>
        <year>2013</year>
        <volume>41</volume>
        <fpage>e121</fpage>
        <pub-id pub-id-type="doi">10.1093/nar/gkt263</pub-id>
        <?supplied-pmid 23598997?>
        <pub-id pub-id-type="pmid">23598997</pub-id>
      </element-citation>
    </ref>
    <ref id="CR19">
      <label>19.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wheeler</surname>
            <given-names>TJ</given-names>
          </name>
          <name>
            <surname>Eddy</surname>
            <given-names>SR</given-names>
          </name>
        </person-group>
        <article-title>nhmmer: DNA homology search with profile HMMs</article-title>
        <source>Bioinformatics</source>
        <year>2013</year>
        <volume>29</volume>
        <fpage>2487</fpage>
        <lpage>2489</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btt403</pub-id>
        <?supplied-pmid 23842809?>
        <pub-id pub-id-type="pmid">23842809</pub-id>
      </element-citation>
    </ref>
    <ref id="CR20">
      <label>20.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hartmann</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Howes</surname>
            <given-names>CG</given-names>
          </name>
          <name>
            <surname>Abarenkov</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Mohn</surname>
            <given-names>WW</given-names>
          </name>
          <name>
            <surname>Nilsson</surname>
            <given-names>RH</given-names>
          </name>
        </person-group>
        <article-title>V-Xtractor: an open-source, high-throughput software tool to identify and extract hypervariable regions of small subunit (16S/18S) ribosomal RNA gene sequences</article-title>
        <source>J Microbiol Methods</source>
        <year>2010</year>
        <volume>83</volume>
        <fpage>250</fpage>
        <lpage>253</lpage>
        <pub-id pub-id-type="doi">10.1016/j.mimet.2010.08.008</pub-id>
        <?supplied-pmid 20804791?>
        <pub-id pub-id-type="pmid">20804791</pub-id>
      </element-citation>
    </ref>
    <ref id="CR21">
      <label>21.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Evans</surname>
            <given-names>SN</given-names>
          </name>
          <name>
            <surname>Matsen</surname>
            <given-names>FA</given-names>
          </name>
        </person-group>
        <article-title>The phylogenetic Kantorovich-Rubinstein metric for environmental sequence samples</article-title>
        <source>J R Stat Soc Series B Stat Methodol</source>
        <year>2012</year>
        <volume>74</volume>
        <fpage>569</fpage>
        <lpage>592</lpage>
        <pub-id pub-id-type="doi">10.1111/j.1467-9868.2011.01018.x</pub-id>
        <?supplied-pmid 22844205?>
        <pub-id pub-id-type="pmid">22844205</pub-id>
      </element-citation>
    </ref>
    <ref id="CR22">
      <label>22.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bengtsson-Palme</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Hartmann</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Eriksson</surname>
            <given-names>KM</given-names>
          </name>
          <name>
            <surname>Pal</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Thorell</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Larsson</surname>
            <given-names>DG</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>METAXA2: improved identification and taxonomic classification of small and large subunit rRNA in metagenomic data</article-title>
        <source>Mol Ecol Resour</source>
        <year>2015</year>
        <volume>15</volume>
        <fpage>1403</fpage>
        <lpage>1414</lpage>
        <pub-id pub-id-type="doi">10.1111/1755-0998.12399</pub-id>
        <?supplied-pmid 25732605?>
        <pub-id pub-id-type="pmid">25732605</pub-id>
      </element-citation>
    </ref>
    <ref id="CR23">
      <label>23.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zhang</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Kobert</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Flouri</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Stamatakis</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>PEAR: a fast and accurate Illumina Paired-End reAd mergeR</article-title>
        <source>Bioinformatics</source>
        <year>2014</year>
        <volume>30</volume>
        <fpage>614</fpage>
        <lpage>620</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btt593</pub-id>
        <?supplied-pmid 24142950?>
        <pub-id pub-id-type="pmid">24142950</pub-id>
      </element-citation>
    </ref>
    <ref id="CR24">
      <label>24.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Haas</surname>
            <given-names>BJ</given-names>
          </name>
          <name>
            <surname>Gevers</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Earl</surname>
            <given-names>AM</given-names>
          </name>
          <name>
            <surname>Feldgarden</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Ward</surname>
            <given-names>DV</given-names>
          </name>
          <name>
            <surname>Giannoukos</surname>
            <given-names>G</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Chimeric 16S rRNA sequence formation and detection in Sanger and 454-pyrosequenced PCR amplicons</article-title>
        <source>Genome Res</source>
        <year>2011</year>
        <volume>21</volume>
        <fpage>494</fpage>
        <lpage>504</lpage>
        <pub-id pub-id-type="doi">10.1101/gr.112730.110</pub-id>
        <?supplied-pmid 21212162?>
        <pub-id pub-id-type="pmid">21212162</pub-id>
      </element-citation>
    </ref>
    <ref id="CR25">
      <label>25.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Edgar</surname>
            <given-names>RC</given-names>
          </name>
          <name>
            <surname>Haas</surname>
            <given-names>BJ</given-names>
          </name>
          <name>
            <surname>Clemente</surname>
            <given-names>JC</given-names>
          </name>
          <name>
            <surname>Quince</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Knight</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>UCHIME improves sensitivity and speed of chimera detection</article-title>
        <source>Bioinformatics</source>
        <year>2011</year>
        <volume>27</volume>
        <fpage>2194</fpage>
        <lpage>2200</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btr381</pub-id>
        <?supplied-pmid 21700674?>
        <pub-id pub-id-type="pmid">21700674</pub-id>
      </element-citation>
    </ref>
    <ref id="CR26">
      <label>26.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Waddell</surname>
            <given-names>PJ</given-names>
          </name>
          <name>
            <surname>Steel</surname>
            <given-names>MA</given-names>
          </name>
        </person-group>
        <article-title>General time-reversible distances with unequal rates across sites: mixing gamma and inverse Gaussian distributions with invariant sites</article-title>
        <source>Mol Phylogenet Evol</source>
        <year>1997</year>
        <volume>8</volume>
        <fpage>398</fpage>
        <lpage>414</lpage>
        <pub-id pub-id-type="doi">10.1006/mpev.1997.0452</pub-id>
        <?supplied-pmid 9417897?>
        <pub-id pub-id-type="pmid">9417897</pub-id>
      </element-citation>
    </ref>
    <ref id="CR27">
      <label>27.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Tavare</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>Some probabilistic and statistical problems in the analysis of DNA sequences</article-title>
        <source>Lect Math Life Sci</source>
        <year>1986</year>
        <volume>17</volume>
        <fpage>57</fpage>
        <lpage>86</lpage>
      </element-citation>
    </ref>
    <ref id="CR28">
      <label>28.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Tamura</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Nei</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>Estimation of the number of nucleotide substitutions in the control region of mitochondrial DNA in humans and chimpanzees</article-title>
        <source>Mol Biol Evol</source>
        <year>1993</year>
        <volume>10</volume>
        <fpage>512</fpage>
        <lpage>526</lpage>
        <?supplied-pmid 8336541?>
        <pub-id pub-id-type="pmid">8336541</pub-id>
      </element-citation>
    </ref>
    <ref id="CR29">
      <label>29.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hasegawa</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Kishino</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Yano</surname>
            <given-names>T</given-names>
          </name>
        </person-group>
        <article-title>Dating of the human-ape splitting by a molecular clock of mitochondrial DNA</article-title>
        <source>J Mol Evol</source>
        <year>1985</year>
        <volume>22</volume>
        <fpage>160</fpage>
        <lpage>174</lpage>
        <pub-id pub-id-type="doi">10.1007/BF02101694</pub-id>
        <?supplied-pmid 3934395?>
        <pub-id pub-id-type="pmid">3934395</pub-id>
      </element-citation>
    </ref>
    <ref id="CR30">
      <label>30.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Yang</surname>
            <given-names>Z</given-names>
          </name>
        </person-group>
        <article-title>Maximum likelihood phylogenetic estimation from DNA sequences with variable rates over sites: approximate methods</article-title>
        <source>J Mol Evol</source>
        <year>1994</year>
        <volume>39</volume>
        <fpage>306</fpage>
        <lpage>314</lpage>
        <pub-id pub-id-type="doi">10.1007/BF00160154</pub-id>
        <?supplied-pmid 7932792?>
        <pub-id pub-id-type="pmid">7932792</pub-id>
      </element-citation>
    </ref>
    <ref id="CR31">
      <label>31.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Yang</surname>
            <given-names>Z</given-names>
          </name>
        </person-group>
        <article-title>Among-site rate variation and its impact on phylogenetic analyses</article-title>
        <source>Trends Ecol Evol</source>
        <year>1996</year>
        <volume>11</volume>
        <fpage>367</fpage>
        <lpage>372</lpage>
        <pub-id pub-id-type="doi">10.1016/0169-5347(96)10041-0</pub-id>
        <?supplied-pmid 21237881?>
        <pub-id pub-id-type="pmid">21237881</pub-id>
      </element-citation>
    </ref>
    <ref id="CR32">
      <label>32.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Yang</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Kumar</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>Approximate methods for estimating the pattern of nucleotide substitution and the variation of substitution rates among sites</article-title>
        <source>Mol Biol Evol</source>
        <year>1996</year>
        <volume>13</volume>
        <fpage>650</fpage>
        <lpage>659</lpage>
        <pub-id pub-id-type="doi">10.1093/oxfordjournals.molbev.a025625</pub-id>
        <?supplied-pmid 8676739?>
        <pub-id pub-id-type="pmid">8676739</pub-id>
      </element-citation>
    </ref>
    <ref id="CR33">
      <label>33.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>He</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Caporaso</surname>
            <given-names>JG</given-names>
          </name>
          <name>
            <surname>Jiang</surname>
            <given-names>XT</given-names>
          </name>
          <name>
            <surname>Sheng</surname>
            <given-names>HF</given-names>
          </name>
          <name>
            <surname>Huse</surname>
            <given-names>SM</given-names>
          </name>
          <name>
            <surname>Rideout</surname>
            <given-names>JR</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Stability of operational taxonomic units: an important but neglected property for analyzing microbial diversity</article-title>
        <source>Microbiome</source>
        <year>2015</year>
        <volume>3</volume>
        <fpage>20</fpage>
        <pub-id pub-id-type="doi">10.1186/s40168-015-0081-x</pub-id>
        <?supplied-pmid 25995836?>
        <pub-id pub-id-type="pmid">25995836</pub-id>
      </element-citation>
    </ref>
    <ref id="CR34">
      <label>34.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Quast</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Pruesse</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Yilmaz</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Gerken</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Schweer</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Yarza</surname>
            <given-names>P</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>The SILVA ribosomal RNA gene database project: improved data processing and web-based tools</article-title>
        <source>Nucleic Acids Res</source>
        <year>2013</year>
        <volume>41</volume>
        <fpage>D590</fpage>
        <lpage>D596</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/gks1219</pub-id>
        <?supplied-pmid 23193283?>
        <pub-id pub-id-type="pmid">23193283</pub-id>
      </element-citation>
    </ref>
    <ref id="CR35">
      <label>35.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Yilmaz</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Parfrey</surname>
            <given-names>LW</given-names>
          </name>
          <name>
            <surname>Yarza</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Gerken</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Pruesse</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Quast</surname>
            <given-names>C</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>The SILVA and “All-species Living Tree Project (LTP)” taxonomic frameworks</article-title>
        <source>Nucleic Acids Res</source>
        <year>2014</year>
        <volume>42</volume>
        <fpage>D643</fpage>
        <lpage>D648</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/gkt1209</pub-id>
        <?supplied-pmid 24293649?>
        <pub-id pub-id-type="pmid">24293649</pub-id>
      </element-citation>
    </ref>
    <ref id="CR36">
      <label>36.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Koljalg</surname>
            <given-names>U</given-names>
          </name>
          <name>
            <surname>Nilsson</surname>
            <given-names>RH</given-names>
          </name>
          <name>
            <surname>Abarenkov</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Tedersoo</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Taylor</surname>
            <given-names>AF</given-names>
          </name>
          <name>
            <surname>Bahram</surname>
            <given-names>M</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Towards a unified paradigm for sequence-based identification of fungi</article-title>
        <source>Mol Ecol</source>
        <year>2013</year>
        <volume>22</volume>
        <fpage>5271</fpage>
        <lpage>5277</lpage>
        <pub-id pub-id-type="doi">10.1111/mec.12481</pub-id>
        <?supplied-pmid 24112409?>
        <pub-id pub-id-type="pmid">24112409</pub-id>
      </element-citation>
    </ref>
    <ref id="CR37">
      <label>37.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ferragina</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Manzini</surname>
            <given-names>G</given-names>
          </name>
        </person-group>
        <article-title>Indexing compressed text</article-title>
        <source>J ACM</source>
        <year>2005</year>
        <volume>52</volume>
        <fpage>552</fpage>
        <lpage>581</lpage>
        <pub-id pub-id-type="doi">10.1145/1082036.1082039</pub-id>
      </element-citation>
    </ref>
    <ref id="CR38">
      <label>38.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ferragina</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Giancarlo</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Manzini</surname>
            <given-names>G</given-names>
          </name>
        </person-group>
        <article-title>The myriad virtues of Wavelet Trees</article-title>
        <source>Inf Comput</source>
        <year>2009</year>
        <volume>207</volume>
        <fpage>849</fpage>
        <lpage>866</lpage>
        <pub-id pub-id-type="doi">10.1016/j.ic.2008.12.010</pub-id>
      </element-citation>
    </ref>
    <ref id="CR39">
      <label>39.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Skewes-Cox</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Sharpton</surname>
            <given-names>TJ</given-names>
          </name>
          <name>
            <surname>Pollard</surname>
            <given-names>KS</given-names>
          </name>
          <name>
            <surname>DeRisi</surname>
            <given-names>JL</given-names>
          </name>
        </person-group>
        <article-title>Profile hidden Markov models for the detection of viruses within metagenomic sequence data</article-title>
        <source>PLoS One</source>
        <year>2014</year>
        <volume>9</volume>
        <fpage>e105067</fpage>
        <pub-id pub-id-type="doi">10.1371/journal.pone.0105067</pub-id>
        <?supplied-pmid 25140992?>
        <pub-id pub-id-type="pmid">25140992</pub-id>
      </element-citation>
    </ref>
    <ref id="CR40">
      <label>40.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Xu</surname>
            <given-names>Q</given-names>
          </name>
          <name>
            <surname>Dunbrack</surname>
            <given-names>RL</given-names>
            <suffix>Jr</suffix>
          </name>
        </person-group>
        <article-title>Assignment of protein sequences to existing domain and family classification systems: Pfam and the PDB</article-title>
        <source>Bioinformatics</source>
        <year>2012</year>
        <volume>28</volume>
        <fpage>2763</fpage>
        <lpage>2772</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/bts533</pub-id>
        <?supplied-pmid 22942020?>
        <pub-id pub-id-type="pmid">22942020</pub-id>
      </element-citation>
    </ref>
    <ref id="CR41">
      <label>41.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Felsenstein</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>Evolutionary trees from DNA sequences: a maximum likelihood approach</article-title>
        <source>J Mol Evol</source>
        <year>1981</year>
        <volume>17</volume>
        <fpage>368</fpage>
        <lpage>376</lpage>
        <pub-id pub-id-type="doi">10.1007/BF01734359</pub-id>
        <?supplied-pmid 7288891?>
        <pub-id pub-id-type="pmid">7288891</pub-id>
      </element-citation>
    </ref>
    <ref id="CR42">
      <label>42.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Sjolander</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Karplus</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Brown</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Hughey</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Krogh</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Mian</surname>
            <given-names>IS</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Dirichlet mixtures: a method for improved detection of weak but significant protein sequence homology</article-title>
        <source>Comput Appl Biosci</source>
        <year>1996</year>
        <volume>12</volume>
        <fpage>327</fpage>
        <lpage>345</lpage>
        <?supplied-pmid 8902360?>
        <pub-id pub-id-type="pmid">8902360</pub-id>
      </element-citation>
    </ref>
    <ref id="CR43">
      <label>43.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Gojobori</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>WH</given-names>
          </name>
          <name>
            <surname>Graur</surname>
            <given-names>D</given-names>
          </name>
        </person-group>
        <article-title>Patterns of nucleotide substitution in pseudogenes and functional genes</article-title>
        <source>J Mol Evol</source>
        <year>1982</year>
        <volume>18</volume>
        <fpage>360</fpage>
        <lpage>369</lpage>
        <pub-id pub-id-type="doi">10.1007/BF01733904</pub-id>
        <?supplied-pmid 7120431?>
        <pub-id pub-id-type="pmid">7120431</pub-id>
      </element-citation>
    </ref>
    <ref id="CR44">
      <label>44.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Goldman</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Thorne</surname>
            <given-names>JL</given-names>
          </name>
          <name>
            <surname>Jones</surname>
            <given-names>DT</given-names>
          </name>
        </person-group>
        <article-title>Using evolutionary trees in protein secondary structure prediction and other comparative sequence analyses</article-title>
        <source>J Mol Biol</source>
        <year>1996</year>
        <volume>263</volume>
        <fpage>196</fpage>
        <lpage>208</lpage>
        <pub-id pub-id-type="doi">10.1006/jmbi.1996.0569</pub-id>
        <?supplied-pmid 8913301?>
        <pub-id pub-id-type="pmid">8913301</pub-id>
      </element-citation>
    </ref>
    <ref id="CR45">
      <label>45.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Caporaso</surname>
            <given-names>JG</given-names>
          </name>
          <name>
            <surname>Bittinger</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Bushman</surname>
            <given-names>FD</given-names>
          </name>
          <name>
            <surname>DeSantis</surname>
            <given-names>TZ</given-names>
          </name>
          <name>
            <surname>Andersen</surname>
            <given-names>GL</given-names>
          </name>
          <name>
            <surname>Knight</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>PyNAST: a flexible tool for aligning sequences to a template alignment</article-title>
        <source>Bioinformatics</source>
        <year>2010</year>
        <volume>26</volume>
        <fpage>266</fpage>
        <lpage>267</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btp636</pub-id>
        <?supplied-pmid 19914921?>
        <pub-id pub-id-type="pmid">19914921</pub-id>
      </element-citation>
    </ref>
    <ref id="CR46">
      <label>46.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Price</surname>
            <given-names>MN</given-names>
          </name>
          <name>
            <surname>Dehal</surname>
            <given-names>PS</given-names>
          </name>
          <name>
            <surname>Arkin</surname>
            <given-names>AP</given-names>
          </name>
        </person-group>
        <article-title>FastTree: computing large minimum evolution trees with profiles instead of a distance matrix</article-title>
        <source>Mol Biol Evol</source>
        <year>2009</year>
        <volume>26</volume>
        <fpage>1641</fpage>
        <lpage>1650</lpage>
        <pub-id pub-id-type="doi">10.1093/molbev/msp077</pub-id>
        <?supplied-pmid 19377059?>
        <pub-id pub-id-type="pmid">19377059</pub-id>
      </element-citation>
    </ref>
    <ref id="CR47">
      <label>47.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Matsen</surname>
            <given-names>FA</given-names>
          </name>
          <name>
            <surname>Hoffman</surname>
            <given-names>NG</given-names>
          </name>
          <name>
            <surname>Gallagher</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Stamatakis</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>A format for phylogenetic placements</article-title>
        <source>PLoS One</source>
        <year>2012</year>
        <volume>7</volume>
        <fpage>e31009</fpage>
        <pub-id pub-id-type="doi">10.1371/journal.pone.0031009</pub-id>
        <?supplied-pmid 22383988?>
        <pub-id pub-id-type="pmid">22383988</pub-id>
      </element-citation>
    </ref>
    <ref id="CR48">
      <label>48.</label>
      <mixed-citation publication-type="other">Zheng Q, Bartow-McKenney C, Meisel JS, Grice EA: Data sets of the V4 and V1V3 mock community 16S sequencing reads used for HmmUFOtu, An HMM and phylogenetic placement based ultra-fast taxonomic assignment and OTU picking tool for microbiome amplicon sequencing studies. NCBI SRA BioProject PRJNA402045. 2018. (<ext-link ext-link-type="uri" xlink:href="https://www.ncbi.nlm.nih.gov/bioproject/?term=PRJNA402045">https://www.ncbi.nlm.nih.gov/bioproject/?term=PRJNA402045</ext-link>). Accessed 1 Jan 2018.</mixed-citation>
    </ref>
  </ref-list>
</back>
