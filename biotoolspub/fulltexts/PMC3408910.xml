<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//NLM//DTD Journal Publishing DTD v3.0 20080202//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName journalpublishing3.dtd?>
<?SourceDTD.Version 3.0?>
<?ConverterInfo.XSLTName jp2nlmx2.xsl?>
<?ConverterInfo.Version 2?>
<?release-delay 12|0?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Opt Express</journal-id>
    <journal-id journal-id-type="iso-abbrev">Opt Express</journal-id>
    <journal-id journal-id-type="publisher-id">OE</journal-id>
    <journal-title-group>
      <journal-title>Optics Express</journal-title>
    </journal-title-group>
    <issn pub-type="epub">1094-4087</issn>
    <publisher>
      <publisher-name>Optical Society of America</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">3408910</article-id>
    <article-id pub-id-type="pmid">20940837</article-id>
    <article-id pub-id-type="publisher-id">131667</article-id>
    <article-id pub-id-type="doi">10.1364/OE.18.019413</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Research-Article</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Automatic segmentation of seven retinal layers in SDOCT images congruent with expert manual segmentation</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Chiu</surname>
          <given-names>Stephanie J.</given-names>
        </name>
        <xref ref-type="aff" rid="aff1">
          <sup>1</sup>
        </xref>
        <xref ref-type="corresp" rid="cor1">
          <sup>*</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Li</surname>
          <given-names>Xiao T.</given-names>
        </name>
        <xref ref-type="aff" rid="aff1">
          <sup>1</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Nicholas</surname>
          <given-names>Peter</given-names>
        </name>
        <xref ref-type="aff" rid="aff2">
          <sup>2</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Toth</surname>
          <given-names>Cynthia A.</given-names>
        </name>
        <xref ref-type="aff" rid="aff2">
          <sup>2</sup>
        </xref>
        <xref ref-type="aff" rid="aff1">
          <sup>1</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Izatt</surname>
          <given-names>Joseph A.</given-names>
        </name>
        <xref ref-type="aff" rid="aff1">
          <sup>1</sup>
        </xref>
        <xref ref-type="aff" rid="aff2">
          <sup>2</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Farsiu</surname>
          <given-names>Sina</given-names>
        </name>
        <xref ref-type="aff" rid="aff2">
          <sup>2</sup>
        </xref>
        <xref ref-type="aff" rid="aff1">
          <sup>1</sup>
        </xref>
      </contrib>
      <aff id="aff1"><label>1</label>Department of Biomedical Engineering, Duke University, Durham, NC, 27708, 
<country country="US">USA</country></aff>
      <aff id="aff2"><label>2</label>Department of Ophthalmology, Duke University Medical Center, Durham, NC, 27710, 
<country country="US">USA</country></aff>
    </contrib-group>
    <author-notes>
      <corresp id="cor1">
        <label>*</label>
        <email xlink:href="stephanie.chiu@duke.edu">stephanie.chiu@duke.edu</email>
      </corresp>
    </author-notes>
    <pub-date pub-type="collection">
      <day>30</day>
      <month>8</month>
      <year>2010</year>
    </pub-date>
    <pub-date pub-type="epub">
      <day>27</day>
      <month>8</month>
      <year>2010</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>27</day>
      <month>8</month>
      <year>2011</year>
    </pub-date>
    <!-- PMC Release delay is 12 months and 0 days and was based on the
					<pub-date pub-type="epub"/>. -->
    <volume>18</volume>
    <issue>18</issue>
    <fpage>19413</fpage>
    <lpage>19428</lpage>
    <history>
      <date date-type="received">
        <day>15</day>
        <month>7</month>
        <year>2010</year>
      </date>
      <date date-type="rev-recd">
        <day>18</day>
        <month>8</month>
        <year>2010</year>
      </date>
      <date date-type="accepted">
        <day>19</day>
        <month>8</month>
        <year>2010</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>©2010 Optical Society of America</copyright-statement>
      <copyright-year>2010</copyright-year>
      <copyright-holder>OSA</copyright-holder>
      <license license-type="open-access" xlink:href="http://creativecommons.org/licenses/by-nc-nd/3.0">
        <license-p>This is an open-access article distributed under the terms of the Creative Commons Attribution-Noncommercial-No Derivative Works 3.0 Unported License, which permits download and redistribution, provided that the original work is properly cited. This license restricts the article from being modified or used commercially.</license-p>
      </license>
    </permissions>
    <abstract>
      <p>Segmentation of anatomical and pathological structures in ophthalmic images is crucial for the diagnosis and study of ocular diseases. However, manual segmentation is often a time-consuming and subjective process. This paper presents an automatic approach for segmenting retinal layers in Spectral Domain Optical Coherence Tomography images using graph theory and dynamic programming. Results show that this method accurately segments eight retinal layer boundaries in normal adult eyes more closely to an expert grader as compared to a second expert grader.</p>
    </abstract>
    <kwd-group kwd-group-type="OCIS">
      <title>OCIS codes: </title>
      <kwd>(100.0100) Image processing</kwd>
      <kwd>(100.2960) Image analysis</kwd>
      <kwd>(110.4500) Optical coherence tomography</kwd>
      <kwd>(170.4470) Ophthalmology</kwd>
    </kwd-group>
    <funding-group>
      <award-group id="sp1">
        <funding-source>NIH</funding-source>
        <award-id>R21 EY019411</award-id>
      </award-group>
      <award-group id="sp2">
        <funding-source>The American Health Assistance Foundation</funding-source>
      </award-group>
      <award-group id="sp3">
        <funding-source>The Hartwell Foundation</funding-source>
      </award-group>
      <award-group id="sp4">
        <funding-source>Genentech</funding-source>
      </award-group>
      <award-group id="sp5">
        <funding-source>Duke Pratt Fellowship Program</funding-source>
      </award-group>
    </funding-group>
  </article-meta>
</front>
<body>
  <sec id="sec1-1">
    <title>1. Introduction</title>
    <p>Accurate detection of anatomical and pathological structures in Spectral Domain Optical Coherence Tomography (SDOCT) images is critical for the diagnosis and study of ocular diseases [<xref ref-type="bibr" rid="r1">1</xref>,<xref ref-type="bibr" rid="r2">2</xref>]. Commercial OCT systems are equipped with segmentation software mainly targeted to measure the nerve fiber layer and the total retinal thicknesses, with varying rates of success [<xref ref-type="bibr" rid="r3">3</xref>]. As for the other ocular features of interest, such as the photoreceptor layer thickness, quantitative data is primarily obtained by manual segmentation [<xref ref-type="bibr" rid="r4">4</xref>]. Manual segmentation is not only demanding for expert graders, but is also extremely time-consuming for clinical use, or for large scale, multi-center trials. Furthermore, the inherent variability between graders yields subjective results.</p>
    <p>This paper presents a fully automatic approach for segmenting layered structures in ocular images using graph theory and dynamic programming that significantly reduces the processing time required for image segmentation and feature extraction. While the proposed technique can be generalized for segmenting any layered structure in images of any imaging modality, we focus on the segmentation of retinal layers in SDOCT images. <xref ref-type="fig" rid="g001">Figure 1</xref>
<fig id="g001" fig-type="figure" orientation="portrait" position="float"><label>Fig. 1</label><caption><p>Target retinal layers of a cross-sectional SDOCT image (B-scan) centered at the macula.</p></caption><graphic xlink:href="oe-18-18-19413-g001"/></fig> shows a cross-sectional SDOCT image of the retina centered at the macula, annotated with the targeted eight layer boundaries delineated by a consensus of the expert graders advising this study (see Section 4.1). Knowledge of these layer boundary positions allows for retinal layer thickness calculations, which are imperative for the study and detection of ocular diseases.</p>
    <p>Previous reports have addressed different approaches to segmenting retinal layer boundaries with varying levels of success. Fernández proposed a combined structure tensor and complex diffusion filtering methodology in place of traditional thresholding [<xref ref-type="bibr" rid="r5">5</xref>]. Ishikawa implemented a column-wise intensity profiling system for layer classification with mean filtering techniques for de-speckling [<xref ref-type="bibr" rid="r6">6</xref>], and Fabritius introduced an alternative method for segmenting the ILM and RPE based on pixel intensity variations [<xref ref-type="bibr" rid="r7">7</xref>]. Active contours were yet another method explored by Yazdanpanah for layer segmentation of rodent images [<xref ref-type="bibr" rid="r8">8</xref>] and by Farsiu for the segmentation of drusen [<xref ref-type="bibr" rid="r9">9</xref>]. Mishra extended the traditional active contour with a two-step kernel-based optimization scheme [<xref ref-type="bibr" rid="r10">10</xref>].</p>
    <p>Graph-cut segmentation is a technique that has proven to be successful in a variety of medical image segmentation applications; however it has only very recently been introduced into ophthalmic SDOCT segmentation applications. Haeker / Garvin utilized radial scans to generate a composite 3-D image and performed a 3-D graph search of the retinal layers [<xref ref-type="bibr" rid="r11">11</xref>,<xref ref-type="bibr" rid="r12">12</xref>], and Lee used multi-scale, 3-D graph search for segmenting the optic nerve head [<xref ref-type="bibr" rid="r13">13</xref>]. Finally, Tolliver employed the spectral rounding solution of the grouping problem to effectively segment layers in a rather mathematically complex framework [<xref ref-type="bibr" rid="r14">14</xref>]. This paper presents a conceptually simpler, yet accurate, alternative approach to graph-cut segmentation using dynamic programming [<xref ref-type="bibr" rid="r15">15</xref>].</p>
    <p>Our simple algorithmic framework enables us to effectively address previous sources of instability including the merging of layers at the fovea [<xref ref-type="bibr" rid="r5">5</xref>,<xref ref-type="bibr" rid="r8">8</xref>], uneven tissue reflectivity [<xref ref-type="bibr" rid="r6">6</xref>], and the presence of pathology [<xref ref-type="bibr" rid="r5">5</xref>]. Moreover, special handling is included for issues such as vessel hypo-reflectivity, where structural information is lost due to shadowing of the vessels. Although previous works address automatic vessel detection [<xref ref-type="bibr" rid="r16">16</xref>], we incorporate a simple vessel detection algorithm for more accurate segmentation results. Furthermore, our algorithm is an adaptable framework for images with pathology such as drusen, as well as pediatric and corneal images, among others. Finally, while many successful segmentation techniques rely on volumetric data to accurately segment anatomic structures (e.g [<xref ref-type="bibr" rid="r12">12</xref>,<xref ref-type="bibr" rid="r13">13</xref>].), our algorithm is able to accurately segment features of interest in individual B-scans, which is important when volumetric data is not available.</p>
    <p>The organization of this paper is as follows. Section 2 discusses the general theory behind graph segmentation as well as our generalized method for automatically segmenting layered structures, and Section 3 shows an implementation of the algorithm for segmenting eight retinal layer boundaries in normal adult eyes. Section 4 compares our automated results against expert manual segmentation, and shows the algorithm applied to other types of images such as retinal pediatric and pathological eyes, as well as the cornea.</p>
  </sec>
  <sec id="sec1-2">
    <title>2. A generalized layer segmentation algorithm</title>
    <p>This section proposes a generalized method for segmenting layered structures. We describe the high-level issues when implementing a graph-based segmentation algorithm and describe our proposed solutions. Later, in Section 3, we describe the algorithmic implementation of these solutions in detail for segmenting retinal layers in SDOCT images. The following schematic (<xref ref-type="fig" rid="g002">Fig. 2</xref>
<fig id="g002" fig-type="figure" orientation="portrait" position="float"><label>Fig. 2</label><caption><p>A generalized layer segmentation algorithm schematic.</p></caption><graphic xlink:href="oe-18-18-19413-g002"/></fig>) outlines the core steps in our layer segmentation algorithm, which are discussed in the following subsections.</p>
    <sec id="sec2-1">
      <title>2.1 Graph representation and weight calculation</title>
      <p>We represent each image (e.g. an SDOCT B-scan) as a graph of nodes, where each node corresponds to a pixel. The links connecting the nodes are called <italic>edges</italic>. A set of connected edges form a pathway for one to travel across the graph. Weights can be assigned to individual edges to create path preferences. To travel across the graph from a start node to an end node, the preferred path is the route in which the total weight sum is at a minimum. This resulting path is the cut which segments one region from another. For our problem, boundaries between retinal layers correspond to the preferred paths (cuts) on an SDOCT B-scan.</p>
      <p>The key to accurately cutting a graph is to assign the appropriate edge weights. Common metrics for varying weight values include functions of distances between pixels or differences between intensity values [<xref ref-type="bibr" rid="r17">17</xref>]. As long as the feature to be segmented has characteristics unique to its surroundings, low weights can be assigned to the borders of that feature to distinguish it from the rest of the image.</p>
      <p>Once appropriate weights are assigned to the edges, computationally efficient techniques such as Dijkstra's algorithm [<xref ref-type="bibr" rid="r15">15</xref>] can be used to determine the lowest weighted path of a graph between arbitrary endpoints. <xref ref-type="fig" rid="g003">Figure 3</xref>
<fig id="g003" fig-type="figure" orientation="portrait" position="float"><label>Fig. 3</label><caption><p>Example graph weights (adjacency matrix) for three connected nodes.</p></caption><graphic xlink:href="oe-18-18-19413-g003"/></fig> shows example weights for three connected nodes. To find the minimum weighted path using Dijkstra's algorithm, the weight values must be positive and range from 0 to 1, where an edge weight of zero indicates an unconnected node pair. This table of graph weights is defined as the <italic>adjacency matrix</italic> of a graph, where one axis represents the start node and the other axis indicates the end node. This example illustrates node 1’s preference for node 3 due to its lower weight value compared to node 2.</p>
    </sec>
    <sec id="sec2-2">
      <title>2.2 Automatic endpoint initialization</title>
      <p>While a graph might consist of several layered structures, segmenting a specific layer requires the selection or estimation of the corresponding layer’s start and end nodes. In this section, we propose an automatic initialization method that bypasses the need for manual endpoint selection.</p>
      <p>Our initialization algorithm is based on the assumption that the layer to be segmented extends across the entire width of the image. Since Dijkstra’s algorithm prefers minimum-weighted paths, we add an additional column of nodes to both sides of the image with arbitrary intensity values and minimal weights <italic>w</italic>
<sub>min</sub> assigned to edges in the vertical direction. Note that, <italic>w</italic>
<sub>min</sub> is significantly smaller than any of the non-zero weights in the adjacency matrix of the original graph. In doing so, the nodes in the newly added columns maintain their connectivity, and the cut is able to traverse in the vertical direction of these columns with minimal resistance. This allows for the start and end nodes to be assigned arbitrarily in the newly added columns, since the cut will move freely along these columns prior to moving across the image in the minimum-weighted path. Once the image is segmented, the two additional columns can be removed, leaving an accurate cut without endpoint initialization error.</p>
      <p><xref ref-type="fig" rid="g004">Figure 4</xref><fig id="g004" fig-type="figure" orientation="portrait" position="float"><label>Fig. 4</label><caption><p>An example segmentation using automatic endpoint initialization.</p></caption><graphic xlink:href="oe-18-18-19413-g004"/></fig> is an example image segmented using the automatic initialization technique. Two vertical columns are added to either side of the image with arbitrary values (here, the maximum intensity) and minimal vertical edge weights. Furthermore, the start and end points are initialized to the top left and bottom right corners. Edges are assigned weights as a function of pixel intensity, where darker pixels result in a lower weight. The red line represents the resulting cut using Dijkstra’s algorithm. The newly added columns can then be removed, showing an accurate cut despite arbitrary endpoint assignments.</p>
    </sec>
    <sec id="sec2-3">
      <title>2.3 Search region limitation</title>
      <p>Oftentimes the feature to be segmented is in the neighborhood of extraneous structures with similar characteristics (e.g. the IPL and OPL regions of the retina). To prevent the algorithm from accidentally segmenting these structures in place of the target feature, it is helpful to limit the graph to a valid search space that excludes any extraneous matter. In terms of graph theory, this means that the weights of the edges in these invalid regions should be removed prior to cutting the graph. For example, if the INL region is already accurately segmented, we may declare all nodes belonging to the INL or regions above it as invalid, when searching for the OPL border.</p>
      <p>In practice, determining regions which are invalid can be complex and relies on prior knowledge about the image and its features. Detailed methods for limiting search regions in retinal SDOCT images will be discussed in Section 3.4, and an illustrative example is shown in <xref ref-type="fig" rid="g008">Fig. 8</xref>
<fig id="g008" fig-type="figure" orientation="portrait" position="float"><label>Fig. 8</label><caption><p>Segmentation of <xref ref-type="fig" rid="g006">Fig. 6b</xref> using Dijkstra’s algorithm, automatic endpoint initialization, and search space limitation. (a) The vitreous-NFL layer boundary segmented. (b) The pilot IS-OS layer boundary segmented.</p></caption><graphic xlink:href="oe-18-18-19413-g008"/></fig> of Section 3.3.</p>
    </sec>
    <sec id="sec2-4">
      <title>2.4 Finding the minimum-weighted path</title>
      <p>Given a graph with weights associated to edges, the graph can be cut by determining the minimum weighted path that connects two endpoints. In this paper, we utilize Dijkstra's algorithm [<xref ref-type="bibr" rid="r15">15</xref>] for finding the minimum path. However, other optimization algorithms which utilize graph theory and adjacency matrices (e.g. the max-flow-min-cut technique [<xref ref-type="bibr" rid="r16">16</xref>]) may also be suitable for segmenting the image. Selection of the appropriate algorithm is determined on a case by case basis. The benefits and drawbacks of each method are discussed in the literature [<xref ref-type="bibr" rid="r18">18</xref>–<xref ref-type="bibr" rid="r22">22</xref>].</p>
    </sec>
    <sec id="sec2-5">
      <title>2.5 Feedback and iteration</title>
      <p>Once the first layer boundary is segmented on the image, the process can be repeated recursively by limiting the search space based on the previous cut to segment a new layer boundary. The resulting effect is an iterative method in which retinal layer boundaries are segmented by order of prominence. Note that, our algorithm is designed so that the rare cases of inaccurate segmentation of one layer do not necessarily affect accurate segmentation of the ensuing layers.</p>
    </sec>
  </sec>
  <sec id="sec1-3">
    <title>3. Implementation for segmenting eight retinal layer boundaries</title>
    <p>This section details an implementation of the generalized segmentation algorithm discussed in Section 2 that automatically segments eight retinal layer boundaries in SDOCT images. The data to be segmented is assumed to consist of raster scanned images densely sampled in the lateral (B-scan) dimension. Each B-scan is segmented independently from other images within the same volume, and is assumed to be centered at the macula without the optic nerve head present. <xref ref-type="fig" rid="g005">Figure 5</xref>
<fig id="g005" fig-type="figure" orientation="portrait" position="float"><label>Fig. 5</label><caption><p>Eight retinal layer boundary segmentation algorithm schematic for SDOCT images.</p></caption><graphic xlink:href="oe-18-18-19413-g005"/></fig> below shows a full schematic of this algorithm, and the following subsections discuss each of the outlined steps.</p>
    <sec id="sec2-6">
      <title>3.1 Image flattening</title>
      <p>As mentioned in Section 2, a graph is segmented by computing the minimum weighted path from a start node to an end node. Inherent in this method is the tendency for the shortest geometric path to be found, since fewer traversed nodes results in a lower total weight. As a result, features with strong curvature or other irregularities, even with relatively strong gradients, are disadvantaged since their paths do not reflect the shortest geometric distance. Alternative to the normalized-cut approach [<xref ref-type="bibr" rid="r17">17</xref>], a natural solution to this dilemma is to transform the image such that the desired path is shortened.</p>
      <p>To account for the natural retinal curvature seen in SDOCT images, we flatten the image to avoid inaccurate shortcuts across the layers when segmenting. <xref ref-type="fig" rid="g006">Figure 6</xref>
<fig id="g006" fig-type="figure" orientation="portrait" position="float"><label>Fig. 6</label><caption><p>Image flattening. (a) The original retinal SDOCT image. (b) The flattened image.</p></caption><graphic xlink:href="oe-18-18-19413-g006"/></fig> demonstrates retinal flattening, where <xref ref-type="fig" rid="g006">Fig. 6b</xref> is the flattened version of the original image, <xref ref-type="fig" rid="g006">Fig. 6a</xref>.</p>
      <p>We created the flattened image based on a pilot estimate of the RPE layer. Our pilot estimate is based on prior knowledge that the RPE layer is one of the most hyper-reflective layers within a retinal SDOCT image. Thus, after denoising the SDOCT image with a Gaussian filter, we tentatively assign the brightest pixel in each column as an estimate of the RPE. We locate outlier pixels, often associated with the NFL, by searching for discontinuities greater than 50 pixels in the RPE estimate. These outliers are removed from the RPE estimate along with pixels lying in columns that present a significantly lower signal-to-noise ratio. We fit a second order polynomial to the remaining valid RPE points, and shift each column up or down such that the RPE points lie on a flat line. Regions of the flattened image that are outside the original field of view are extrapolated from the mirror image of the valid pixels. This avoids border artifacts when later filtering the image. The extrapolated pixels are excluded from weight calculations, and the resulting image is a smoothly flattened retina.</p>
    </sec>
    <sec id="sec2-7">
      <title>3.2 Calculate graph weights</title>
      <p>Graph weights in the literature [<xref ref-type="bibr" rid="r17">17</xref>] often include two terms representing the geometric distance and intensity difference of the graph nodes. Given the relatively high resolution of an SDOCT retinal scan, most features of interest have a smooth transition between neighboring pixels. Therefore, each node is associated with only its eight nearest neighbors, sparing us from incorporating geometric distance weights. All other node pairs are disconnected, resulting in a sparse adjacency matrix of intensity difference graph weights. For example, an [<italic>M × N</italic>] sized image has an [<italic>MN × MN</italic>] sized adjacency matrix with <italic>MNC</italic> filled entries, where <italic>C</italic> (here eight) is the number of nearest neighbors. We then define our graph to be undirected, thus halving the size of the adjacency matrix.</p>
      <p>In SDOCT images, retinal layers are primarily horizontal structures distinguishable by a change in pixel intensity in the vertical direction. Weights can therefore be calculated solely based on intensity gradients as follows:</p>
      <disp-formula id="e1">
        <mml:math id="m1">
          <mml:mrow>
            <mml:msub>
              <mml:mi>w</mml:mi>
              <mml:mrow>
                <mml:mi>a</mml:mi>
                <mml:mi>b</mml:mi>
              </mml:mrow>
            </mml:msub>
            <mml:mo>=</mml:mo>
            <mml:mn>2</mml:mn>
            <mml:mo>−</mml:mo>
            <mml:mrow>
              <mml:mo>(</mml:mo>
              <mml:mrow>
                <mml:msub>
                  <mml:mi>g</mml:mi>
                  <mml:mi>a</mml:mi>
                </mml:msub>
                <mml:mo>+</mml:mo>
                <mml:msub>
                  <mml:mi>g</mml:mi>
                  <mml:mi>b</mml:mi>
                </mml:msub>
              </mml:mrow>
              <mml:mo>)</mml:mo>
            </mml:mrow>
            <mml:mo>+</mml:mo>
            <mml:msub>
              <mml:mi>w</mml:mi>
              <mml:mrow>
                <mml:mi mathvariant="italic">min</mml:mi>
              </mml:mrow>
            </mml:msub>
            <mml:mo>,</mml:mo>
            <mml:mtext> where</mml:mtext>
          </mml:mrow>
        </mml:math>
        <label>(1)</label>
      </disp-formula>
      <def-list>
        <def-item>
          <term>
            <italic>w<sub>ab</sub></italic>
          </term>
          <def>
            <p>is the weight assigned to the edge connecting nodes <italic>a</italic> and <italic>b</italic>,</p>
          </def>
        </def-item>
        <def-item>
          <term>
            <italic>g<sub>a</sub></italic>
          </term>
          <def>
            <p>is the vertical gradient of the image at node <italic>a</italic>,</p>
          </def>
        </def-item>
        <def-item>
          <term>
            <italic>g<sub>b</sub></italic>
          </term>
          <def>
            <p> is the vertical gradient of the image at node <italic>b</italic>,</p>
          </def>
        </def-item>
        <def-item>
          <term>
            <italic>w<sub>min</sub></italic>
          </term>
          <def>
            <p>is the minimum weight in the graph, a small positive number added for system stabilization.</p>
          </def>
        </def-item>
      </def-list>
      <p><xref ref-type="disp-formula" rid="e1">Equation (1)</xref> assigns low weight values to node pairs with large vertical gradients. In our implementation, <italic>g<sub>a</sub></italic> and <italic>g<sub>b</sub></italic> are normalized to values between 0 and 1, and <italic>w<sub>min</sub></italic> = 1 × 10<sup>−5</sup>. These weights are further adjusted to account for the directionality of the gradient. To segment the vitreous-NFL layer boundary, for example, it is known that the boundary exhibits a darker layer above a brighter layer [<xref ref-type="bibr" rid="r12">12</xref>]. In contrast, the NFL-GCL layer boundary has a light-to-dark layer change. As a result, edge maps such as [<xref ref-type="bibr" rid="r1">1</xref>;-<xref ref-type="bibr" rid="r1">1</xref>] and [-1;1] can be utilized when calculating the gradient to extract the appropriate layers. Finally, for automatic endpoint initialization as discussed in Section 2.2, the end columns are duplicated and added to either side of the image with vertical edge weights equal to <italic>w<sub>min</sub></italic> and all other weights following <xref ref-type="disp-formula" rid="e1">Eq. (1)</xref>.</p>
      <p>Our implementation for segmenting retinal layers in SDOCT images yields two undirected adjacency matrices sensitive to either dark-to-light or light-to-dark intensity transitions. For layer boundaries exhibiting a darker layer above a lighter layer such as the vitreous-NFL, INL-OPL, IS-OS, and OS-RPE boundaries, we utilize the dark-to-light adjacency matrix. In contrast, for the NFL-GCL, IPL-INL, OPL-PRNL, and RPE-choroid boundaries, which exhibit a lighter layer above a darker layer, we use the light-to-dark adjacency matrix.</p>
      <p><xref ref-type="fig" rid="g007">Figure 7</xref><fig id="g007" fig-type="figure" orientation="portrait" position="float"><label>Fig. 7</label><caption><p>Gradient images used for calculating graph weights for <xref ref-type="fig" rid="g006">Fig. 6b</xref>. (a) Dark-to-light image for segmenting a darker layer above a lighter layer. (b) Light-to-dark image for segmenting a lighter layer above a darker layer.</p></caption><graphic xlink:href="oe-18-18-19413-g007"/></fig> shows two complementary gradient images used for calculating edge weights. <xref ref-type="fig" rid="g007">Figure 7a</xref> is the dark-to-light gradient image used to generate weights for segmenting the boundary between a darker layer above a lighter layer, and <xref ref-type="fig" rid="g007">Fig. 7b</xref> is the light-to-dark gradient image for boundaries separating a lighter layer above a darker layer.</p>
    </sec>
    <sec id="sec2-8">
      <title>3.3 Segmenting the vitreous-NFL and the IS-OS</title>
      <p>We implement the segmentation of multiple layers in an iterative process, where layer boundaries are cut by order of prominence. The vitreous-NFL and IS-OS are the two most prominent layer boundaries in an SDOCT retinal image due to their high contrast in pixel intensity. Our algorithm utilizes Dijkstra’s method and the dark-to-light graph weights to find the lowest-weighted path initialized at the upper left and the bottom right pixels of the image. The resulting cut is either the vitreous-NFL or the IS-OS.</p>
      <p>The vitreous-NFL is the topmost layer of the retina on a B-scan with little hyper-reflectivity above it, unlike the IS-OS. The region directly above the cut is therefore inspected for bright layers in order to determine which layer boundary was segmented. If there is no hyper-reflectivity present in the region, we then conclude that the segmented layer is the vitreous-NFL. Otherwise, we infer that the IS-OS is detected. In order to determine the presence or absence of hyper-reflectivity, the image is first low-pass filtered with a Gaussian kernel and thresholded using Otsu’s method [<xref ref-type="bibr" rid="r23">23</xref>] to generate a binary mask. This step isolates the NFL-OPL and IS-RPE complexes. The fraction of bright pixels in the region above the cut is then calculated for the binary image. If the fraction exceeds 0.025, then we conclude that the segmented layer boundary is the IS-OS due to the presence of the NFL-OPL complex. Otherwise, we conclude that the vitreous-NFL layer boundary was segmented.</p>
      <p>Following the limited search space concept described in Section 2.3, if the IS-OS layer boundary was first segmented, the search space is limited to the region 20 pixels above the segmented line so the vitreous-NFL can be segmented next. In contrast, if the vitreous-NFL was segmented first, then the search space is limited to the region 40 pixels below it to segment the IS-OS. Consequently, the algorithm successfully segments the two most prominent layer boundaries.</p>
      <p><xref ref-type="fig" rid="g008">Figure 8a</xref> shows an SDOCT B-scan, where the vitreous-NFL is first segmented, given a search space of the entire image. The search region is then limited to the space shown in <xref ref-type="fig" rid="g008">Fig. 8b</xref>, resulting in the segmented IS-OS line. This example also shows the result of the automatic endpoint initialization implemented in Section 3.2. Lastly, note that the pilot IS-OS layer detected at this stage may be inaccurate due to IS-OS and RPE layer confusion. Such errors are corrected in Section 3.8.</p>
    </sec>
    <sec id="sec2-9">
      <title>3.4 Search region limitation using connectivity-based segmentation</title>
      <p>While the vitreous-NFL and IS-OS are easily identifiable due to their prominent hyper-reflectivity, the remaining layer boundaries are not as distinct. To accurately segment these remaining layers, we introduce a method for defining a valid and narrow search region that isolates the layer boundaries of interest. Our method is implemented in two steps. We first develop a pilot estimate of pixel clusters corresponding to the hyper-reflective layer regions using a column-wise intensity profiling technique. Then, we connect and modify clusters associated with a particular layer, in what we call the connectivity-based step. We exploit the resulting layer estimations to limit search regions in Sections 3.6 to 3.8, in which three of the estimated layer boundaries are considered at a time. We use the top and bottom of these layers as the search space area for identifying the cut that represents the middle layer. The two column-wise intensity profiling and connectivity-based segmentation steps are described in the following paragraphs.</p>
      <p>First, we enhance the contrast between the light and dark layers. To achieve this, we coarsely denoise the image with a rectangular averaging filter of size 3 × 19 pixels. Next, we threshold this image by setting the values of pixels that are smaller than the median of their corresponding column to zero. An example contrast-enhanced image is shown in <xref ref-type="fig" rid="g009">Fig. 9b</xref>
<fig id="g009" fig-type="figure" orientation="portrait" position="float"><label>Fig. 9</label><caption><p>Contrast enhancement. (a) A flattened retinal SDOCT image. (b) The contrast-enhanced image.</p></caption><graphic xlink:href="oe-18-18-19413-g009"/></fig>.</p>
      <p>A binary mask is then generated to isolate the hyper-reflective retinal layers. This is done by taking the 1-D, column-wise, second-order derivative of the contrast-enhanced image to boost layer boundaries [<xref ref-type="bibr" rid="r24">24</xref>]. Next, we create a pilot binary mask by thresholding the edge-enhanced image at zero. Then, to remove outliers in each column, we set all non-zero clusters less than 5 pixels tall to zero and join the remaining clusters that are closer than 3 pixels from each other. The resulting mask corresponds to the hyper-reflective layers in the retina (i.e. NFL, IPL, OPL, IS-OS, RPE). A horizontal 1-D closing operation with a kernel of 10 pixels in size is performed on the image as a whole to close gaps, and any clusters less than 500 pixels in size are removed. The result is a coarse binary mask of the hyper-reflective retinal layers, as shown in <xref ref-type="fig" rid="g010">Fig. 10a</xref>
<fig id="g010" fig-type="figure" orientation="portrait" position="float"><label>Fig. 10</label><caption><p>(a) A binary mask of the filtered image in <xref ref-type="fig" rid="g009">Fig. 9b</xref>. The red arrows mark the location of the holes corresponding to the GCL-IPL complex. (b) A zoomed in binary mask with disconnected layers achieved by interpolating the lower boundaries of corresponding holes from <xref ref-type="fig" rid="g010">Fig. 10a</xref>. The green arrows point to vertical breaks used to separate clusters that were not disconnected through interpolation.</p></caption><graphic xlink:href="oe-18-18-19413-g010"/></fig>.</p>
      <p>The layers in some columns of the coarse binary mask might be blended together, as seen in the top layers of <xref ref-type="fig" rid="g010">Fig. 10a</xref>. We distinguish these merged hyper-reflective layers by interpolating the approximate location from neighboring columns in which they are detached. This is done by first detecting hyper-reflective pixel clusters with holes corresponding to a partially detected middle hypo-reflective layer. For example, note the merged NFL and IPL clusters and the holes corresponding to the GCL layer in <xref ref-type="fig" rid="g010">Fig. 10a</xref>. We simply cut the merged layers by interpolating the lower boundaries of corresponding holes, separating all layers as shown <xref ref-type="fig" rid="g010">Fig. 10b</xref>. Note that, the interpolating line may not break all merged layers into two clusters, as is the case in the foveal region of <xref ref-type="fig" rid="g010">Fig. 10b</xref>. We separate these areas from the original cluster with vertical lines.</p>
      <p>The algorithm then examines each column in the original binary mask (<xref ref-type="fig" rid="g010">Fig. 10a</xref>) and tentatively assigns each cluster of pixels within the column to a particular anatomical layer. The available choices for hyper-reflective layers are the NFL, IPL, OPL, IS-OS, RPE, or “no assignment” in the case that the rules fail to reach a reasonably certain assignment. To do this, the number of clusters is counted for each column. For columns with five clusters, the retinal layer assignments are straightforward since there is a one to one correspondence with the targeted layers. To determine the missing layers in columns with fewer than five clusters, we take advantage of our prior knowledge of the layer order and approximate layer distances. For instance, we assume that the OS-RPE is at least 30 pixels below the vitreous-NFL, and the distance between the RPE and IS-OS layers is less than 10 pixels. The end result is the tentatively-assigned retinal layers shown in <xref ref-type="fig" rid="g011">Fig. 11a</xref>
<fig id="g011" fig-type="figure" orientation="portrait" position="float"><label>Fig. 11</label><caption><p>Retinal layer assignments, where blue = NFL, green = IPL, yellow = OPL, cyan = IS-OS, magenta = RPE. (a) Column-wise layer assignments of the mask in <xref ref-type="fig" rid="g010">Fig. 10a</xref>. Note the conflicts in the top three layer assignments. (b) Cluster layer assignments of the mask in <xref ref-type="fig" rid="g010">Fig. 10b</xref>.</p></caption><graphic xlink:href="oe-18-18-19413-g011"/></fig>.</p>
      <p>To correct possible conflicts in the column-wise layer assignments where a spatially connected group of pixels may have tentative assignments to different retinal layers (<xref ref-type="fig" rid="g011">Fig. 11a</xref>), we devise a voting scheme. We reassign all connected pixels from a 2-D binary cluster to a single retinal layer based on the majority tentative assignment of the pixels in that cluster. The result from this cluster-based refinement method is shown in <xref ref-type="fig" rid="g011">Fig. 11b</xref>.</p>
      <p>The boundaries of the NFL, IPL, and OPL are determined by finding the top and bottom edges of the assigned pixel clusters (<xref ref-type="fig" rid="g011">Fig. 11b</xref>). The boundaries of the IS-OS and RPE are found by first distinguishing the two layers from each other. The brightest pixels in the filtered image (<xref ref-type="fig" rid="g009">Fig. 9b</xref>) that are a) given the IS-OS / RPE layer assignment in the original mask (<xref ref-type="fig" rid="g010">Fig. 10a</xref>), and b) furthest from the top of the image, are assigned as the center of the RPE. This center RPE line is then smoothed with a median filter. The RPE edges are located by performing a focused search for large changes in gradient near the center RPE line on the filtered image (<xref ref-type="fig" rid="g009">Fig. 9b</xref>). The same is done to find the IS-OS edges by searching just above the RPE layer, resulting in the estimated retinal layers displayed in <xref ref-type="fig" rid="g012">Fig. 12</xref>
<fig id="g012" fig-type="figure" orientation="portrait" position="float"><label>Fig. 12</label><caption><p>Connectivity-based segmentation of retinal layers using the layer assignments from <xref ref-type="fig" rid="g011">Fig. 11b</xref>.</p></caption><graphic xlink:href="oe-18-18-19413-g012"/></fig>. Because these layer estimations still contain errors, they are refined in the subsequent subsections using Dijkstra’s method, with adjacent layer estimations as search region boundaries.</p>
    </sec>
    <sec id="sec2-10">
      <title>3.5 Vessel detection</title>
      <p>Retinal SDOCT images with prominent vessels pose a challenge when segmenting the NFL-GCL boundary, because they result in hyper-reflective bulges in the NFL layer as shown in <xref ref-type="fig" rid="g013">Fig. 13a</xref>
<fig id="g013" fig-type="figure" orientation="portrait" position="float"><label>Fig. 13</label><caption><p>Vessel detection. (a) NFL-GCL without vessel detection. (b) NFL-GCL with vessel detection.</p></caption><graphic xlink:href="oe-18-18-19413-g013"/></fig>. In a very recent study, retinal blood vessels are located through iterative polynomial smoothing [<xref ref-type="bibr" rid="r25">25</xref>]. To address this problem, we incorporate a method that detects major vessels on individual B-scans, making Dijkstra’s algorithm indifferent to bulges in the NFL layer.</p>
      <p>In the first step, we tentatively segment the RPE-choroid layer boundary, where the pilot IS-OS is used to limit the search region. Then, a Gaussian filter is applied to the image, and columns ranging from the RPE-choroid to 15 pixels above are summed. Columns exhibiting low sum values, corresponding to the dark areas from vessel shadowing, are defined as the vessel regions.</p>
      <p>In the second step, we set edge weights in the vessel regions to <italic>w<sub>min</sub></italic> prior to segmenting the NFL-GCL. Upon updating the graph weights, the NFL-GCL cut will be indifferent to these vessel regions. <xref ref-type="fig" rid="g013">Figure 13b</xref> demonstrates the effectiveness of the vessel correction algorithm in improving the accuracy of the NFL-GCL boundary detection, which is described in Section 3.6.</p>
    </sec>
    <sec id="sec2-11">
      <title>3.6 Segmenting the NFL-GCL</title>
      <p>After incorporating minimum weights in the vessel regions and estimating the layer boundaries using connectivity-based segmentation, we form a pilot estimate of the NFL-GCL layer boundary using Dijkstra’s algorithm and the updated light-to-dark graph weights. We limit the search region using the vitreous-NFL from Section 3.3 and the estimated IPL-INL from Section 3.4 prior to cutting. Errors may arise, however, due to the similar light-to-dark gradient characteristics of the NFL-GCL and IPL-INL layer boundaries. Moreover, the NFL layer is thicker on the nasal side of the fovea that is closer to the optic nerve head, necessitating an asymmetric, larger search region.</p>
      <p>We include a technique in our algorithm to account for the NFL-GCL / IPL-INL confusion. First, the temporal side is predetermined based on knowledge of the scan direction (horizontal / vertical) and which eye (left / right) was imaged. For instance, horizontal scans of the left eye exhibit layer thinning on the right side of the fovea, whereas vertical scans of the left eye show layer thinning on both sides of the fovea.</p>
      <p>Using the vitreous-NFL from Section 3.3 and the preliminary NFL-GCL cut, we estimate the NFL thickness. Moving across the image from the thicker to the thinner side of the layer, we find the first instance where the thickness drops below a threshold of 6 pixels and mark it as the divide between the thick and thin sides. We limit the search region on the thinner NFL side to 10 pixels below the vitreous-NFL, and the search region on the thicker side is expanded from 5 pixels below the vitreous-NFL to 5 pixels below the preliminary NFL-GCL cut. <xref ref-type="fig" rid="g014">Figure 14</xref>
<fig id="g014" fig-type="figure" orientation="portrait" position="float"><label>Fig. 14</label><caption><p>NFL-GCL segmentation. (a) NFL-GCL before correction. (b) NFL-GCL after correction.</p></caption><graphic xlink:href="oe-18-18-19413-g014"/></fig> shows the resulting NFL-GCL segmentation before (<xref ref-type="fig" rid="g014">Fig. 14a</xref>) and after (<xref ref-type="fig" rid="g014">Fig. 14b</xref>) correcting the layer boundary.</p>
    </sec>
    <sec id="sec2-12">
      <title>3.7 Detecting the fovea and segmenting the IPL to ONL layer boundaries</title>
      <p>It is important to detect whether the image contains the fovea, since layers tend to merge together and become increasingly indistinguishable near the fovea. Due to inaccuracies in estimating layer boundaries, errors similar to the example in <xref ref-type="fig" rid="g015">Fig. 15a</xref>
<fig id="g015" fig-type="figure" orientation="portrait" position="float"><label>Fig. 15</label><caption><p>Fovea correction. (a) Segmented image before correction. (b) Segmented image after correction.</p></caption><graphic xlink:href="oe-18-18-19413-g015"/></fig> often appear in the pilot segmentations for B-scans containing the fovea. To address such problems, we first perform a pilot estimate of the IPL-INL, INL-OPL, and OPL-ONL layer boundaries using the appropriate weighting matrix (light-to-dark or dark-to-light) and Dijkstra’s algorithm. We limit the search regions using the previously segmented lines and the estimated layer boundaries from Section 3.4. For example, the IPL-INL search region is limited to 3 pixels below the NFL-GCL, and above the estimated IPL-INL or INL-OPL boundaries, whichever is higher.</p>
      <p>In the next step, we estimate the presence and location of the fovea by calculating the NFL, GCL-IPL, INL, and OPL layer thicknesses from the tentatively segmented layers. We then assign columns with a mean layer thickness of less than 5 pixels as the foveal region. Since this region may not necessarily be centered at the fovea, we locate the center by calculating the vitreous-NFL to IS-OS thickness, where the column containing the minimum thickness is located and expanded by 20 pixels on either side. If this region coincides with the foveal region detected prior, then it is included as a part of the fovea.</p>
      <p>After locating the fovea, we define more accurate search regions to account for foveal layer merging. This is done by maintaining the position of the lower boundary of the search space, however expanding the top boundary of the search space upward to reach the vitreous-NFL when re-segmenting the IPL-INL, INL-OPL, and OPL-ONL. The resulting segmentations are more accurate, as depicted in <xref ref-type="fig" rid="g015">Fig. 15b</xref>.</p>
    </sec>
    <sec id="sec2-13">
      <title>3.8 Segmenting the IS to choroid layer boundaries</title>
      <p>The remaining lower boundaries (IS-OS, OS-RPE, and RPE-choroid) are segmented in a straightforward manner by exploiting the previously estimated layer boundaries, the connectivity-based search regions, and Dijkstra’s algorithm. In particular, we improve upon the IS-OS estimate from Section 3.3 to remove any possible IS-OS / OS-RPE confusion. Our implementation re-segments the IS-OS with a modified search region ranging from 4 pixels below the segmented OPL-ONL line to 2 pixels above the estimated OS-RPE from Section 3.4.</p>
      <p>After segmenting all layer boundaries, we unflatten the image by shifting the pixels up or down in the direction opposite to image flattening, thereby restoring the original curvature. The result is an algorithm that segments 8 retinal layer boundaries on a given SDOCT image.</p>
    </sec>
  </sec>
  <sec id="sec1-4">
    <title>4. Experimental results</title>
    <sec id="sec2-14">
      <title>4.1 Automated versus manual segmentation study</title>
      <p>To determine the accuracy of the eight retinal layer boundary segmentation algorithm on SDOCT images, we conducted an automatic versus manual segmentation study. This study included macular scans from normal adult subjects segmented manually by an expert grader and automatically using our software. To estimate inter-expert-observer variability, a subset of scans was graded manually by a second expert. Both expert graders were OCT readers certified by the Duke Reading Center.</p>
      <p>Volumetric scans (6.7 x 6.7 mm) were acquired from 10 normal adult subjects in an IRB approved protocol using Bioptigen Inc (Research Triangle Park, NC) SDOCT imaging systems with an axial full-width at half-maximum (FWHM) resolution of 4.6μm (in tissue) and an axial pixel sample spacing of 3.23 µm. Five of the volumetric scans had lateral and azimuthal pixel sampling spacings of 6.7 µm and 67 µm (1000 A-scans × 100 B-scans), respectively. The other 5 volumetric scans had resolutions of 13.4 µm and 33.5 µm (500 A-scans × 200 B-scans) to validate the algorithm on varying lateral and azimuthal image resolutions. Note that the volumetric scans were comprised of a series of cross-sectional images, or B-scans, where the number of A-scans represents the image width.</p>
      <p>To compare the automatic versus manual segmentation results, 11 B-scans from each data set were selected with the sixth B-scan centered at the fovea and subsequent B-scans departing from the fovea at a linear rate. The inter-expert comparison included a subset of 3 B-scans from each set of 11 B-scans. The three B-scans chosen from each set included the foveal scan and two other randomly selected B-scans. Due to a prominent, irregular imaging artifact in one of the B-scans and a gross manual segmentation error in another B-scan, a total of two B-scans were removed from the study. Furthermore, 8 B-scans were used as training data for bias correction as will be discussed below. As a result, 100 B-scans (10 B-scans per data set) were observed for the automatic versus manual comparison and a subset of 29 B-scans (3 B-scans per data set with the exception of one) were included in the inter-expert comparison.</p>
      <p>Prior to automatic segmentation, ten percent of the image width was cropped from either side of each image to remove regions with low signal. Eight retinal layer boundaries were segmented automatically on 108 B-scans using a MATLAB software implementation of our algorithm. The average computation time was 9.74 seconds per image (64-bit OS, Intel Core2 Duo CPU at 2.53 GHz, and 4 GB RAM). The same eight layers were manually traced by two expert graders for the subset of 29 B-scans. Furthermore, these certified graders traced layers using their own expertise and were not allowed to consult with each other.</p>
      <p>In order to closely match the segmentation results of an expert grader, the automatic segmentation results were smoothed using a moving average filter. This was necessary because the automatic algorithm tightly followed gradient changes, whereas manual segmentation tended to be smooth. Furthermore, each expert grader exhibited a bias when tracing layer boundaries, either consistently following above or below by a constant distance from the actual boundary. As a result, training was performed on the 8 test images to determine any segmentation biases from the manual grading. Each automatically segmented layer in the set of 100 B-scans was then shifted up or down by bias values of −0.9, −0.8, −1.0, −1.3, −1.6, −1.3, −0.3, and −0.6 pixels, respectively, in order to mimic the segmentation behavior of the manual grader.</p>
      <p>Upon smoothing the layers and correcting for bias, we calculated the thicknesses of the 7 retinal layers for each of the 100 B-scans between neighboring layer boundaries. The average difference in layer thickness between the manual and automatic estimates was computed for each layer of each B-scan. The same was done to compare the two manual expert graders for 29 B-scans. The absolute mean and standard deviation of these differences across all B-scans were calculated and are shown in <xref ref-type="table" rid="t001">Table 1</xref>
<table-wrap id="t001" orientation="portrait" position="float"><label>Table 1</label><caption><title>Differences in retinal layer thickness segmentation between two expert manual graders for 29 B-scans (Column I), as compared to the thickness differences between the automatic segmentation and one expert manual grader of the same 29 B-scans (Column II). Column III reports the automatic and manual segmentation (of one grader) differences for a larger subset of 100 B-scans. Each pixel is 3.23 μm.</title></caption><table frame="hsides" rules="all"><col width="16.07%" span="1"/><col width="15.17%" span="1"/><col width="13.32%" span="1"/><col width="14.23%" span="1"/><col width="13.35%" span="1"/><col width="14.23%" span="1"/><col width="13.63%" span="1"/><thead><tr><th valign="middle" colspan="7" align="center" scope="colgroup" rowspan="1"><bold>Retinal Layer Thickness Differences</bold></th></tr><tr><th valign="middle" align="center" scope="col" rowspan="1" colspan="1"/><th valign="middle" colspan="2" align="center" scope="colgroup" rowspan="1"><bold>Comparison of Two</bold><break/><bold>Manual Expert Graders</bold></th><th valign="middle" colspan="4" align="center" scope="colgroup" rowspan="1"><bold>Comparison of Automatic and</bold><break/><bold>Manual Segmentation</bold></th></tr><tr><th valign="middle" align="center" scope="col" rowspan="1" colspan="1"/><th valign="middle" colspan="2" align="center" scope="colgroup" rowspan="1"><bold>Column I</bold></th><th valign="middle" colspan="2" align="center" scope="colgroup" rowspan="1"><bold>Column II</bold></th><th valign="middle" colspan="2" align="center" scope="colgroup" rowspan="1"><bold>Column III</bold></th></tr><tr><th valign="middle" align="center" scope="col" rowspan="1" colspan="1"/><th valign="middle" colspan="4" align="center" scope="colgroup" rowspan="1">29 B-scans</th><th valign="middle" colspan="2" align="center" scope="colgroup" rowspan="1">100 B-scans</th></tr></thead><tbody><tr><td valign="middle" align="center" scope="row" rowspan="1" colspan="1"><bold>Retinal Layer</bold></td><td valign="middle" align="center" rowspan="1" colspan="1">Mean Difference (Pixels)</td><td valign="middle" align="center" rowspan="1" colspan="1">Standard Deviation (Pixels)</td><td valign="middle" align="center" rowspan="1" colspan="1">Mean Difference (Pixels)</td><td valign="middle" align="center" rowspan="1" colspan="1">Standard Deviation (Pixels)</td><td valign="middle" align="center" rowspan="1" colspan="1">Mean Difference (Pixels)</td><td valign="middle" align="center" rowspan="1" colspan="1">Standard Deviation (Pixels)</td></tr><tr><td valign="middle" align="center" scope="row" rowspan="1" colspan="1">NFL</td><td valign="middle" align="center" rowspan="1" colspan="1">1.73</td><td valign="middle" align="center" rowspan="1" colspan="1">0.90</td><td valign="bottom" align="center" rowspan="1" colspan="1">0.99</td><td valign="bottom" align="center" rowspan="1" colspan="1">0.76</td><td valign="bottom" align="center" rowspan="1" colspan="1">0.88</td><td valign="bottom" align="center" rowspan="1" colspan="1">0.68</td></tr><tr><td valign="middle" align="center" scope="row" rowspan="1" colspan="1">GCLIPL</td><td valign="middle" align="center" rowspan="1" colspan="1">1.06</td><td valign="middle" align="center" rowspan="1" colspan="1">0.95</td><td valign="bottom" align="center" rowspan="1" colspan="1">0.57</td><td valign="bottom" align="center" rowspan="1" colspan="1">0.48</td><td valign="bottom" align="center" rowspan="1" colspan="1">0.77</td><td valign="bottom" align="center" rowspan="1" colspan="1">0.65</td></tr><tr><td valign="middle" align="center" scope="row" rowspan="1" colspan="1">INL</td><td valign="middle" align="center" rowspan="1" colspan="1">2.22</td><td valign="middle" align="center" rowspan="1" colspan="1">1.30</td><td valign="bottom" align="center" rowspan="1" colspan="1">1.07</td><td valign="bottom" align="center" rowspan="1" colspan="1">0.87</td><td valign="bottom" align="center" rowspan="1" colspan="1">0.98</td><td valign="bottom" align="center" rowspan="1" colspan="1">0.74</td></tr><tr><td valign="middle" align="center" scope="row" rowspan="1" colspan="1">OPL</td><td valign="middle" align="center" rowspan="1" colspan="1">1.90</td><td valign="middle" align="center" rowspan="1" colspan="1">1.53</td><td valign="bottom" align="center" rowspan="1" colspan="1">1.64</td><td valign="bottom" align="center" rowspan="1" colspan="1">1.08</td><td valign="bottom" align="center" rowspan="1" colspan="1">1.48</td><td valign="bottom" align="center" rowspan="1" colspan="1">1.05</td></tr><tr><td valign="middle" align="center" scope="row" rowspan="1" colspan="1">ONL-IS</td><td valign="middle" align="center" rowspan="1" colspan="1">1.63</td><td valign="middle" align="center" rowspan="1" colspan="1">1.19</td><td valign="bottom" align="center" rowspan="1" colspan="1">1.40</td><td valign="bottom" align="center" rowspan="1" colspan="1">1.06</td><td valign="bottom" align="center" rowspan="1" colspan="1">1.20</td><td valign="bottom" align="center" rowspan="1" colspan="1">0.92</td></tr><tr><td valign="middle" align="center" scope="row" rowspan="1" colspan="1">OS</td><td valign="middle" align="center" rowspan="1" colspan="1">1.11</td><td valign="middle" align="center" rowspan="1" colspan="1">0.88</td><td valign="bottom" align="center" rowspan="1" colspan="1">0.92</td><td valign="bottom" align="center" rowspan="1" colspan="1">0.80</td><td valign="bottom" align="center" rowspan="1" colspan="1">0.88</td><td valign="bottom" align="center" rowspan="1" colspan="1">0.73</td></tr><tr><td valign="middle" align="center" scope="row" rowspan="1" colspan="1">RPE</td><td valign="middle" align="center" rowspan="1" colspan="1">2.21</td><td valign="middle" align="center" rowspan="1" colspan="1">1.20</td><td valign="bottom" align="center" rowspan="1" colspan="1">0.96</td><td valign="bottom" align="center" rowspan="1" colspan="1">0.69</td><td valign="bottom" align="center" rowspan="1" colspan="1">0.99</td><td valign="bottom" align="center" rowspan="1" colspan="1">0.87</td></tr><tr><td valign="middle" align="center" scope="row" rowspan="1" colspan="1">Total Retina</td><td valign="middle" align="center" rowspan="1" colspan="1"><bold>2.22</bold></td><td valign="middle" align="center" rowspan="1" colspan="1">1.00</td><td valign="bottom" align="center" rowspan="1" colspan="1"><bold>0.92</bold></td><td valign="bottom" align="center" rowspan="1" colspan="1">0.83</td><td valign="bottom" align="center" rowspan="1" colspan="1"><bold>0.94</bold></td><td valign="bottom" align="center" rowspan="1" colspan="1">0.82</td></tr></tbody></table></table-wrap>. Column I shows the absolute average thickness difference for the various retinal layers as measured by two expert manual graders for 29 B-scans. Column II displays the same layer thickness difference calculation for the 29-Bscans, but with layer thicknesses determined by the automatic segmentation software and one of the two manual graders. Column III reports the thickness differences between the automatic and manual grader for the larger set of 100 B-scans.</p>
      <p>Among all data sets, maximum differences for the 8 retinal thicknesses reported in columns I and II of <xref ref-type="table" rid="t001">Table 1</xref>, (Column I, Column II), were as follows: NFL (10,18.7), GCL-IPL (11,11.8), INL (12,9.7), OPL (11,15.2), ONS-IS(10,11.1), OS (8,7.6), RPE (11,7.9), and total retina (11,12).</p>
      <p>The results in <xref ref-type="table" rid="t001">Table 1</xref>show that the automatic algorithm accurately segmented seven retinal layers in normal adult eyes more closely to an expert grader as compared to another grader. For example, two manual graders differed in their segmentation of the total retina by an average of 2.22 pixels, whereas our fully automatic algorithm differed from one of the manual graders by an average of 0.95 pixels. <xref ref-type="fig" rid="g016">Figure 16</xref>
<fig id="g016" fig-type="figure" orientation="portrait" position="float"><label>Fig. 16</label><caption><p>Comparison of automatic (cyan) versus manual (magenta) segmentation.</p></caption><graphic xlink:href="oe-18-18-19413-g016"/></fig>displays the qualitative results, with the automatic segmentation (cyan) overlaid with the manual segmentation (magenta) results.</p>
      <p>To test the repeatability of the proposed method, we captured five volumetric scans of one normal subject with lateral and azimuthal pixel sampling spacings of 6.7 µm and 67 µm (1000 A-scans × 100 B-scans), respectively. The subject rested between each volumetric image capture. In accordance with longstanding clinical convention (described in the AREDS study [<xref ref-type="bibr" rid="r26">26</xref>]), we calculated the volume of each retinal layer within the 3 mm diameter circle around the fovea. We selected one of these scans as the anchor and compared the automatically measured volume of each of its layers with those of the other scans. We calculated the normalized mean and standard deviation of the differences in estimating the volume of each layer. The results, (mean, standard deviation), were as follows: NFL (3.88%,3.43%), GCL-IPL (1.70%,1.99%), INL (3.37%,3.43%), OPL (2.20%,2.01%), ONS-IS(1.02%,0.76%), OS (0.84%,0.61%), RPE (0.16%,0.18%), and total retina (0.26%,0.09%). Note that, such slight differences are mainly due to the uncontrollable patient motion that occurs during volumetric scans and existence of significant pre-retinal image artifacts in some of the captured B-scans.</p>
    </sec>
    <sec id="sec2-15">
      <title>4.2 Other segmentation results</title>
      <p>Sections 3 and 4.1 discuss the algorithm implemented for segmenting retinal layers on macular, normal adult SDOCT images. We have generalized the algorithm in Section 2 for different types of layered structures. <xref ref-type="fig" rid="g017">Figure 17</xref>
<fig id="g017" fig-type="figure" orientation="portrait" position="float"><label>Fig. 17</label><caption><p>Segmentation of anatomical and pathological images of the eye. (a-c) Level 3 aged-macular degeneration retinas with drusen. (d) Pediatric retina. (e) Pediatric retina with edema. (f) Cornea.</p></caption><graphic xlink:href="oe-18-18-19413-g017"/></fig>below shows the segmentation results for a variety of SDOCT image types, including retinas with Level 3 aged-macular degeneration (<xref ref-type="fig" rid="g017">Fig. 17a-b</xref>), a retina with Level 3 AMD with poor image quality (<xref ref-type="fig" rid="g017">Fig. 17c</xref>), a pediatric retina (<xref ref-type="fig" rid="g017">Fig. 17d</xref>), a pediatric retina with edema (<xref ref-type="fig" rid="g017">Fig. 17e</xref>), and the cornea (<xref ref-type="fig" rid="g017">Fig. 17f</xref>). The extension and validation of our algorithm for all these different diseases is out of the scope of this preliminary paper, and will be fully addressed in our upcoming publications.</p>
    </sec>
  </sec>
  <sec id="sec1-5">
    <title>5. Conclusion</title>
    <p>The automatic algorithm accurately segmented eight retinal layer boundaries on SDOCT images of normal eyes, with consistent results that matched an expert grader more closely than a second grader. This is highly encouraging for both reducing the time and manpower required to segment images in large-scale ophthalmic studies.</p>
    <p>The accuracy of the proposed algorithm has yet to be proven for other ocular imaging scenarios, including pathological eyes, pediatric eyes, corneal images, and images from other SDOCT systems. To achieve this, weighting schemes in addition to vertical gradients, such as distance penalties, can be included in adjacency matrix calculations, and alternative approaches for search space limitation can be investigated. In addition, since this algorithm targets 2-D image segmentation, information from neighboring B-scans can be utilized in correcting for outliers, or the algorithm can be readily extended to 3-D segmentation (indeed with a significant increase in computational complexity). To make the proposed method more suitable for use in clinic, its computational complexity should be reduced. We expect to achieve this by exploiting more efficient computer programming languages (e.g. C instead of MATLAB) and taking advantage of Graphics Processing Units (GPUs). To reduce filter smoothing artifacts, especially for thin retinal layers, it might be beneficial to use non-linear adaptive filters (e.g [<xref ref-type="bibr" rid="r27">27</xref>].) for image denoising and edge detection. Lastly, we believe that it is important to compare the performance of this and other academic or commercial SDOCT segmentation algorithms for different imaging setups on similar test data sets. We are preparing clinical manuscripts to address these issues.</p>
  </sec>
</body>
<back>
  <ack>
    <title>Acknowledgements</title>
    <p>We would like to thank Ramiro Maldonado, Michelle McCall, Rachelle O'Connell, Katrina Winter, Neeru Sarin, and Stephanie A. Kennedy for their contributions to the Automatic versus Manual Segmentation Study, Prof. Rebecca Willett for her invaluable comments, and Prof. Anthony N. Kuo for providing and Francesco LaRocca for segmenting the image in Fig. 17f. This work was supported in part by NIH Grant R21 EY019411, The American Health Assistance Foundation, The Hartwell Foundation, Genentech, and the Duke Pratt Fellowship Program.</p>
  </ack>
  <ref-list>
    <title>References and links</title>
    <ref id="r1">
      <label>1</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Huang</surname><given-names>D.</given-names></name><name><surname>Swanson</surname><given-names>E. A.</given-names></name><name><surname>Lin</surname><given-names>C. P.</given-names></name><name><surname>Schuman</surname><given-names>J. S.</given-names></name><name><surname>Stinson</surname><given-names>W. G.</given-names></name><name><surname>Chang</surname><given-names>W.</given-names></name><name><surname>Hee</surname><given-names>M. R.</given-names></name><name><surname>Flotte</surname><given-names>T.</given-names></name><name><surname>Gregory</surname><given-names>K.</given-names></name><name><surname>Puliafito</surname><given-names>C. A.</given-names></name><name><surname>et</surname></name></person-group>, “<article-title>Optical coherence tomography</article-title>,” <source>Science</source><volume>254</volume>(<issue>5035</issue>), <fpage>1178</fpage>–<lpage>1181</lpage>(<year>1991</year>).<pub-id pub-id-type="doi">10.1126/science.1957169</pub-id><pub-id pub-id-type="pmid">1957169</pub-id></mixed-citation>
    </ref>
    <ref id="r2">
      <label>2</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Fujimoto</surname><given-names>J. G.</given-names></name><name><surname>Drexler</surname><given-names>W.</given-names></name><name><surname>Schuman</surname><given-names>J. S.</given-names></name><name><surname>Hitzenberger</surname><given-names>C. K.</given-names></name></person-group>, “<article-title>Optical Coherence Tomography (OCT) in ophthalmology: introduction</article-title>,” <source>Opt. Express</source><volume>17</volume>(<issue>5</issue>), <fpage>3978</fpage>–<lpage>3979</lpage>(<year>2009</year>).<pub-id pub-id-type="doi">10.1364/OE.17.003978</pub-id><pub-id pub-id-type="pmid">19259239</pub-id></mixed-citation>
    </ref>
    <ref id="r3">
      <label>3</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Han</surname><given-names>I. C.</given-names></name><name><surname>Jaffe</surname><given-names>G. J.</given-names></name></person-group>, “<article-title>Evaluation of Artifacts Associated with Macular Spectral-Domain Optical Coherence Tomography</article-title>,” <source>Ophthalmology</source><volume>117</volume>, <fpage>1177</fpage>–<lpage>1189</lpage> (<year>2010</year>). <pub-id pub-id-type="doi">10.1016/j.ophtha.2009.10.029</pub-id><pub-id pub-id-type="pmid">20171740</pub-id></mixed-citation>
    </ref>
    <ref id="r4">
      <label>4</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Schuman</surname><given-names>S. G.</given-names></name><name><surname>Koreishi</surname><given-names>A. F.</given-names></name><name><surname>Farsiu</surname><given-names>S.</given-names></name><name><surname>Jung</surname><given-names>S.</given-names></name><name><surname>Izatt</surname><given-names>J. A.</given-names></name><name><surname>Toth</surname><given-names>C. A.</given-names></name></person-group>, “<article-title>Photoreceptor Layer Thinning over Drusen in Eyes with Age-Related Macular Degeneration Imaged In Vivo with Spectral-Domain Optical Coherence Tomography</article-title>,” <source>Ophthalmology</source><volume>116</volume>, <fpage>488</fpage>–<lpage>496</lpage>(<year>2009</year>). <pub-id pub-id-type="doi">10.1016/j.ophtha.2008.10.006</pub-id><pub-id pub-id-type="pmcid">2695995</pub-id><pub-id pub-id-type="pmid">19167082</pub-id></mixed-citation>
    </ref>
    <ref id="r5">
      <label>5</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Cabrera Fernández</surname><given-names>D.</given-names></name><name><surname>Salinas</surname><given-names>H. M.</given-names></name><name><surname>Puliafito</surname><given-names>C. A.</given-names></name></person-group>, “<article-title>Automated detection of retinal layer structures on optical coherence tomography images</article-title>,” <source>Opt. Express</source><volume>13</volume>(<issue>25</issue>), <fpage>10200</fpage>–<lpage>10216</lpage>(<year>2005</year>).<pub-id pub-id-type="doi">10.1364/OPEX.13.010200</pub-id><pub-id pub-id-type="pmid">19503235</pub-id></mixed-citation>
    </ref>
    <ref id="r6">
      <label>6</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ishikawa</surname><given-names>H.</given-names></name><name><surname>Stein</surname><given-names>D. M.</given-names></name><name><surname>Wollstein</surname><given-names>G.</given-names></name><name><surname>Beaton</surname><given-names>S.</given-names></name><name><surname>Fujimoto</surname><given-names>J. G.</given-names></name><name><surname>Schuman</surname><given-names>J. S.</given-names></name></person-group>, “<article-title>Macular segmentation with optical coherence tomography</article-title>,” <source>Invest. Ophthalmol. Vis. Sci.</source><volume>46</volume>(<issue>6</issue>), <fpage>2012</fpage>–<lpage>2017</lpage>(<year>2005</year>).<pub-id pub-id-type="doi">10.1167/iovs.04-0335</pub-id><pub-id pub-id-type="pmid">15914617</pub-id></mixed-citation>
    </ref>
    <ref id="r7">
      <label>7</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Fabritius</surname><given-names>T.</given-names></name><name><surname>Makita</surname><given-names>S.</given-names></name><name><surname>Miura</surname><given-names>M.</given-names></name><name><surname>Myllylä</surname><given-names>R.</given-names></name><name><surname>Yasuno</surname><given-names>Y.</given-names></name></person-group>, “<article-title>Automated segmentation of the macula by optical coherence tomography</article-title>,” <source>Opt. Express</source><volume>17</volume>(<issue>18</issue>), <fpage>15659</fpage>–<lpage>15669</lpage>(<year>2009</year>).<pub-id pub-id-type="doi">10.1364/OE.17.015659</pub-id><pub-id pub-id-type="pmid">19724565</pub-id></mixed-citation>
    </ref>
    <ref id="r8">
      <label>8</label>
      <mixed-citation publication-type="confproc">A. Yazdanpanah, G. Hamarneh, B. Smith, and M. Sarunic, “Intra-retinal Layer Segmentation in Optical Coherence Tomography Using an Active Contour Approach,” in Proceedings of the 12th International Conference on Medical Image Computing and Computer-Assisted Intervention: Part II, (Springer-Verlag, London, UK, 2009), pp. 649–656.</mixed-citation>
    </ref>
    <ref id="r9">
      <label>9</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Farsiu</surname><given-names>S.</given-names></name><name><surname>Chiu</surname><given-names>S. J.</given-names></name><name><surname>Izatt</surname><given-names>J. A.</given-names></name><name><surname>Toth</surname><given-names>C. A.</given-names></name></person-group>, “<article-title>Optical coherence tomography</article-title>,” <source>Proc. SPIE</source><volume>6844</volume>, <fpage>68440D</fpage>(<year>2008</year>).<pub-id pub-id-type="doi">10.1117/12.768624</pub-id></mixed-citation>
    </ref>
    <ref id="r10">
      <label>10</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Mishra</surname><given-names>A.</given-names></name><name><surname>Wong</surname><given-names>A.</given-names></name><name><surname>Bizheva</surname><given-names>K.</given-names></name><name><surname>Clausi</surname><given-names>D. A.</given-names></name></person-group>, “<article-title>Intra-retinal layer segmentation in optical coherence tomography images</article-title>,” <source>Opt. Express</source><volume>17</volume>(<issue>26</issue>), <fpage>23719</fpage>–<lpage>23728</lpage>(<year>2009</year>).<pub-id pub-id-type="doi">10.1364/OE.17.023719</pub-id><pub-id pub-id-type="pmid">20052083</pub-id></mixed-citation>
    </ref>
    <ref id="r11">
      <label>11</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Haeker</surname><given-names>M.</given-names></name><name><surname>Sonka</surname><given-names>M.</given-names></name><name><surname>Kardon</surname><given-names>R.</given-names></name><name><surname>Shah</surname><given-names>V. A.</given-names></name><name><surname>Wu</surname><given-names>X.</given-names></name><name><surname>Abramoff</surname><given-names>M. D.</given-names></name></person-group>, “<article-title>Automated segmentation of intraretinal layers from macular optical coherence tomography images</article-title>,” <source>Proc. SPIE</source><volume>6512</volume>, <fpage>651214</fpage>(<year>2007</year>).<pub-id pub-id-type="doi">10.1117/12.710231</pub-id></mixed-citation>
    </ref>
    <ref id="r12">
      <label>12</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Garvin</surname><given-names>M. K.</given-names></name><name><surname>Abràmoff</surname><given-names>M. D.</given-names></name><name><surname>Wu</surname><given-names>X.</given-names></name><name><surname>Russell</surname><given-names>S. R.</given-names></name><name><surname>Burns</surname><given-names>T. L.</given-names></name><name><surname>Sonka</surname><given-names>M.</given-names></name></person-group>, “<article-title>Automated 3-D intraretinal layer segmentation of macular spectral-domain optical coherence tomography images</article-title>,” <source>IEEE Trans. Med. Imaging</source><volume>28</volume>(<issue>9</issue>), <fpage>1436</fpage>–<lpage>1447</lpage>(<year>2009</year>).<pub-id pub-id-type="doi">10.1109/TMI.2009.2016958</pub-id><pub-id pub-id-type="pmid">19278927</pub-id></mixed-citation>
    </ref>
    <ref id="r13">
      <label>13</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lee</surname><given-names>K.</given-names></name><name><surname>Niemeijer</surname><given-names>M.</given-names></name><name><surname>Garvin</surname><given-names>M. K.</given-names></name><name><surname>Kwon</surname><given-names>Y. H.</given-names></name><name><surname>Sonka</surname><given-names>M.</given-names></name><name><surname>Abramoff</surname><given-names>M. D.</given-names></name></person-group>, “<article-title>Segmentation of the optic disc in 3-D OCT scans of the optic nerve head</article-title>,” <source>IEEE Trans. Med. Imaging</source><volume>29</volume>(<issue>1</issue>), <fpage>159</fpage>–<lpage>168</lpage>(<year>2010</year>).<pub-id pub-id-type="doi">10.1109/TMI.2009.2031324</pub-id><pub-id pub-id-type="pmcid">2911797</pub-id><pub-id pub-id-type="pmid">19758857</pub-id></mixed-citation>
    </ref>
    <ref id="r14">
      <label>14</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Tolliver</surname><given-names>D. A.</given-names></name><name><surname>Koutis</surname><given-names>I.</given-names></name><name><surname>Ishikawa</surname><given-names>H.</given-names></name><name><surname>Schuman</surname><given-names>J. S.</given-names></name><name><surname>Miller</surname><given-names>G. L.</given-names></name></person-group>, “<article-title>Automatic Multiple Retinal Layer Segmentation in Spectral Domain OCT Scans via Spectral Rounding</article-title>,” <source>Invest. Ophthalmol. Vis. Sci</source>. <volume>49</volume>, <fpage>1878</fpage>- (<year>2008</year>). </mixed-citation>
    </ref>
    <ref id="r15">
      <label>15</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Dijkstra</surname><given-names>E. W.</given-names></name></person-group>, “<article-title>A note on two problems in connexion with graphs</article-title>,” <source>Numerische Mathematik</source><volume>1</volume>(<issue>1</issue>), <fpage>269</fpage>–<lpage>271</lpage>(<year>1959</year>).<pub-id pub-id-type="doi">10.1007/BF01386390</pub-id></mixed-citation>
    </ref>
    <ref id="r16">
      <label>16</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Niemeijer</surname><given-names>M.</given-names></name><name><surname>Garvin</surname><given-names>M. K.</given-names></name><name><surname>van Ginneken</surname><given-names>B.</given-names></name><name><surname>Sonka</surname><given-names>M.</given-names></name><name><surname>Abramoff</surname><given-names>M. D.</given-names></name></person-group>, “<article-title>Vessel segmentation in 3D spectral OCT scans of the retina</article-title>,” <source>Proc. SPIE</source><volume>6914</volume>, <fpage>69148</fpage>(<year>2008</year>).</mixed-citation>
    </ref>
    <ref id="r17">
      <label>17</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Shi</surname><given-names>J.</given-names></name><name><surname>Malik</surname><given-names>J.</given-names></name></person-group>, “<article-title>Normalized Cuts and Image Segmentation</article-title>,” <source>IEEE Trans. Pattern Anal. Mach. Intell.</source><volume>22</volume>(<issue>8</issue>), <fpage>888</fpage>–<lpage>905</lpage>(<year>2000</year>).<pub-id pub-id-type="doi">10.1109/34.868688</pub-id></mixed-citation>
    </ref>
    <ref id="r18">
      <label>18</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Elias</surname><given-names>P.</given-names></name><name><surname>Feinstein</surname><given-names>A.</given-names></name><name><surname>Shannon</surname><given-names>C.</given-names></name></person-group>, “<article-title>A note on the maximum flow through a network</article-title>,” <source>IRE Trans. Inf. Theory</source><volume>2</volume>(<issue>4</issue>), <fpage>117</fpage>–<lpage>119</lpage>(<year>1956</year>).<pub-id pub-id-type="doi">10.1109/TIT.1956.1056816</pub-id></mixed-citation>
    </ref>
    <ref id="r19">
      <label>19</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Warshall</surname><given-names>S.</given-names></name></person-group>, “<article-title>A Theorem on Boolean Matrices</article-title>,” <source>J. ACM</source><volume>9</volume>(<issue>1</issue>), <fpage>11</fpage>–<lpage>12</lpage>(<year>1962</year>).<pub-id pub-id-type="doi">10.1145/321105.321107</pub-id></mixed-citation>
    </ref>
    <ref id="r20">
      <label>20</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bellman</surname><given-names>R.</given-names></name></person-group>, “<article-title>On a Routing Problem</article-title>,” <source>Q. Appl. Math.</source><volume>16</volume>, <fpage>87</fpage>–<lpage>90</lpage>(<year>1958</year>).</mixed-citation>
    </ref>
    <ref id="r21">
      <label>21</label>
      <mixed-citation publication-type="book">L. R. Ford, and D. R. Fulkerson, <source>Flows in networks</source>, (Princeton University Press, Princeton, N.J., 1962).</mixed-citation>
    </ref>
    <ref id="r22">
      <label>22</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Floyd</surname><given-names>R. W.</given-names></name></person-group>, “<article-title>Algorithm 97: Shortest path</article-title>,” <source>Commun. ACM</source><volume>5</volume>(<issue>6</issue>), <fpage>345</fpage>(<year>1962</year>).<pub-id pub-id-type="doi">10.1145/367766.368168</pub-id></mixed-citation>
    </ref>
    <ref id="r23">
      <label>23</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Otsu</surname><given-names>N.</given-names></name></person-group>, “<article-title>Threshold Selection Method from Gray-Level Histograms</article-title>,” <source>IEEE Trans. Syst. Man Cyber.</source><volume>9</volume>(<issue>1</issue>), <fpage>62</fpage>–<lpage>66</lpage>(<year>1979</year>).<pub-id pub-id-type="doi">10.1109/TSMC.1979.4310076</pub-id></mixed-citation>
    </ref>
    <ref id="r24">
      <label>24</label>
      <mixed-citation publication-type="book">R. C. Gonzalez, and R. E. Woods, <source>Digital image processing</source>, 3rd ed. (Pearson/Prentice Hall, Upper Saddle River, NJ, 2008), pp. xxii, 954 p.</mixed-citation>
    </ref>
    <ref id="r25">
      <label>25</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lu</surname><given-names>S.</given-names></name><name><surname>Cheung</surname><given-names>C.</given-names></name><name><surname>Liu</surname><given-names>J.</given-names></name><name><surname>Lim</surname><given-names>J.</given-names></name><name><surname>Leung</surname><given-names>C.</given-names></name><name><surname>Wong</surname><given-names>T.</given-names></name></person-group>, “<article-title>Automated Layer Segmentation of Optical Coherence Tomography Images</article-title>,” <source>IEEE Trans. Biomed. Eng.</source>(<comment>to be published</comment>).<pub-id pub-id-type="pmcid">3125057</pub-id><pub-id pub-id-type="pmid">21926010</pub-id></mixed-citation>
    </ref>
    <ref id="r26">
      <label>26</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><collab>Age-Related Eye Disease Study Research Group</collab></person-group>, “<article-title>The Age-Related Eye Disease Study system for classifying age-related macular degeneration from stereoscopic color fundus photographs: the Age-Related Eye Disease Study Report Number 6</article-title>,” <source>Am. J. Ophthalmol.</source><volume>132</volume>(<issue>5</issue>), <fpage>668</fpage>–<lpage>681</lpage>(<year>2001</year>).<pub-id pub-id-type="pmid">11704028</pub-id></mixed-citation>
    </ref>
    <ref id="r27">
      <label>27</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Takeda</surname><given-names>H.</given-names></name><name><surname>Farsiu</surname><given-names>S.</given-names></name><name><surname>Milanfar</surname><given-names>P.</given-names></name></person-group>, “<article-title>Kernel regression for image processing and reconstruction</article-title>,” <source>IEEE Trans. Image Process.</source><volume>16</volume>(<issue>2</issue>), <fpage>349</fpage>–<lpage>366</lpage>(<year>2007</year>).<pub-id pub-id-type="doi">10.1109/TIP.2006.888330</pub-id><pub-id pub-id-type="pmid">17269630</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
