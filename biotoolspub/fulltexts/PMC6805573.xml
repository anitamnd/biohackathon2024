<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName A++V2.4.dtd?>
<?SourceDTD.Version 2.4?>
<?ConverterInfo.XSLTName springer2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Genome Biol</journal-id>
    <journal-id journal-id-type="iso-abbrev">Genome Biol</journal-id>
    <journal-title-group>
      <journal-title>Genome Biology</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1474-7596</issn>
    <issn pub-type="epub">1474-760X</issn>
    <publisher>
      <publisher-name>BioMed Central</publisher-name>
      <publisher-loc>London</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">6805573</article-id>
    <article-id pub-id-type="publisher-id">1817</article-id>
    <article-id pub-id-type="doi">10.1186/s13059-019-1817-x</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Method</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Robust taxonomic classification of uncharted microbial sequences and bins with CAT and BAT</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author" equal-contrib="yes">
        <name>
          <surname>von Meijenfeldt</surname>
          <given-names>F. A. Bastiaan</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author" equal-contrib="yes">
        <name>
          <surname>Arkhipova</surname>
          <given-names>Ksenia</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Cambuy</surname>
          <given-names>Diego D.</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Coutinho</surname>
          <given-names>Felipe H.</given-names>
        </name>
        <xref ref-type="aff" rid="Aff2">2</xref>
        <xref ref-type="aff" rid="Aff3">3</xref>
        <xref ref-type="aff" rid="Aff4">4</xref>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <name>
          <surname>Dutilh</surname>
          <given-names>Bas E.</given-names>
        </name>
        <address>
          <phone>+31 30 253 4212</phone>
          <email>bedutilh@gmail.com</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <aff id="Aff1"><label>1</label><institution-wrap><institution-id institution-id-type="ISNI">0000000120346234</institution-id><institution-id institution-id-type="GRID">grid.5477.1</institution-id><institution>Theoretical Biology and Bioinformatics, Science for Life, </institution><institution>Utrecht University, </institution></institution-wrap>Utrecht, The Netherlands </aff>
      <aff id="Aff2"><label>2</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0004 0444 9382</institution-id><institution-id institution-id-type="GRID">grid.10417.33</institution-id><institution>Centre for Molecular and Biomolecular Informatics, </institution><institution>Radboud University Medical Centre, </institution></institution-wrap>Nijmegen, The Netherlands </aff>
      <aff id="Aff3"><label>3</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0001 2294 473X</institution-id><institution-id institution-id-type="GRID">grid.8536.8</institution-id><institution>Instituto de Biologia, Universidade Federal do Rio de Janeiro, </institution></institution-wrap>Rio de Janeiro, RJ Brazil </aff>
      <aff id="Aff4"><label>4</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0001 0586 4893</institution-id><institution-id institution-id-type="GRID">grid.26811.3c</institution-id><institution>Present Address: Evolutionary Genomics Group, Departamento de Produccíon Vegetal y Microbiología, </institution><institution>Universidad Miguel Hernández, </institution></institution-wrap>Campus San Juan, San Juan, 03550 Alicante, Spain </aff>
    </contrib-group>
    <pub-date pub-type="epub">
      <day>22</day>
      <month>10</month>
      <year>2019</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>22</day>
      <month>10</month>
      <year>2019</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2019</year>
    </pub-date>
    <volume>20</volume>
    <elocation-id>217</elocation-id>
    <history>
      <date date-type="received">
        <day>22</day>
        <month>3</month>
        <year>2019</year>
      </date>
      <date date-type="accepted">
        <day>10</day>
        <month>9</month>
        <year>2019</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s). 2019</copyright-statement>
      <license license-type="OpenAccess">
        <license-p><bold>Open Access</bold>This article is distributed under the terms of the Creative Commons Attribution 4.0 International License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted use, distribution, and reproduction in any medium, provided you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons license, and indicate if changes were made. The Creative Commons Public Domain Dedication waiver (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/publicdomain/zero/1.0/">http://creativecommons.org/publicdomain/zero/1.0/</ext-link>) applies to the data made available in this article, unless otherwise stated.</license-p>
      </license>
    </permissions>
    <abstract id="Abs1">
      <p id="Par1">Current-day metagenomics analyses increasingly involve de novo taxonomic classification of long DNA sequences and metagenome-assembled genomes. Here, we show that the conventional best-hit approach often leads to classifications that are too specific, especially when the sequences represent novel deep lineages. We present a classification method that integrates multiple signals to classify sequences (Contig Annotation Tool, CAT) and metagenome-assembled genomes (Bin Annotation Tool, BAT). Classifications are automatically made at low taxonomic ranks if closely related organisms are present in the reference database and at higher ranks otherwise. The result is a high classification precision even for sequences from considerably unknown organisms.</p>
    </abstract>
    <funding-group>
      <award-group>
        <funding-source>
          <institution>Nederlandse Organisatie voor Wetenschappelijk Onderzoek (NL)</institution>
        </funding-source>
        <award-id>864.14.004</award-id>
        <principal-award-recipient>
          <name>
            <surname>Dutilh</surname>
            <given-names>Bas E.</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/501100003593</institution-id>
            <institution>Conselho Nacional de Desenvolvimento Científico e Tecnológico</institution>
          </institution-wrap>
        </funding-source>
        <award-id>Science Without Borders program</award-id>
        <award-id>Science Without Borders program</award-id>
        <principal-award-recipient>
          <name>
            <surname>Cambuy</surname>
            <given-names>Diego D.</given-names>
          </name>
          <name>
            <surname>Coutinho</surname>
            <given-names>Felipe H.</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
    </funding-group>
    <custom-meta-group>
      <custom-meta>
        <meta-name>issue-copyright-statement</meta-name>
        <meta-value>© The Author(s) 2019</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec id="Sec1">
    <title>Background</title>
    <p id="Par2">Metagenomics, the direct sequencing of DNA from microbial communities in natural environments, has revolutionized the field of microbiology by unearthing a vast microbial sequence space in our biosphere, much of which remains unexplored [<xref ref-type="bibr" rid="CR1">1</xref>–<xref ref-type="bibr" rid="CR3">3</xref>]. With increases in DNA sequencing throughput, metagenomics has moved from analysis of individual reads to sequence assembly, where increases in sequencing depth have enabled de novo assembly of high-quality contiguous sequences (contigs), sometimes many kilobases in length [<xref ref-type="bibr" rid="CR4">4</xref>]. In addition, current state-of-the-art encompasses binning of these contigs into high-quality draft genomes, or metagenome-assembled genomes (MAGs) [<xref ref-type="bibr" rid="CR5">5</xref>–<xref ref-type="bibr" rid="CR8">8</xref>]. The advance from short reads to contigs and MAGs allows the metagenomics field to answer its classical questions [<xref ref-type="bibr" rid="CR9">9</xref>], “who is there?” and “what are they doing?” in a unified manner: “who is doing what?”, as both function and taxonomy can be confidently linked to the same genomic entity. Because assembly and binning can be done de novo, these questions can be applied to organisms that have never been seen before, and the discovery of entirely novel phyla is common still [<xref ref-type="bibr" rid="CR8">8</xref>].</p>
    <p id="Par3">Several efficient tools for taxonomic classification of short-read sequences have been developed over the years, reflecting the read-based focus of the time. Most tools consider each read as an independent observation, whose taxonomic origin can be estimated by identifying best-hit matches in a reference database, either on read, K-mer, or translated protein level (see [<xref ref-type="bibr" rid="CR10">10</xref>] for an overview). Widely used programs such as Kraken [<xref ref-type="bibr" rid="CR11">11</xref>] (K-mer based), CLARK [<xref ref-type="bibr" rid="CR12">12</xref>] (discriminative K-mer based), and Kaiju [<xref ref-type="bibr" rid="CR13">13</xref>] (protein-based) can process hundreds of thousands of sequencing reads per second. Without compromising accuracy, still faster approaches use mixture modeling of K-mer profiles, as implemented in FOCUS [<xref ref-type="bibr" rid="CR14">14</xref>]. Sometimes a Last Common Ancestor (LCA) algorithm is applied to allow for multiple hits with similar scores as the best hit (e.g., Kraken, MEGAN [<xref ref-type="bibr" rid="CR15">15</xref>]).</p>
    <p id="Par4">Similar approaches are often applied to contigs, with classification often based on the best hit to a reference database. Although fast, the best-hit approach can lead to spurious specificity in classifications, for example when a genomic region is highly conserved or recently acquired via horizontal gene transfer (HGT) from a distantly related organism. As we will show below, the problem is particularly grave when the query contigs are very divergent from the sequences in the database, i.e., they are distantly related to known organisms. Whereas specificity (correctly classified/total classified) can be increased when only classifications at higher taxonomic ranks are considered, this approach is not desirable as taxonomic resolution is unnecessarily lost for query contigs that are closely related to known organisms.</p>
    <p id="Par5">Depending on their length, contigs may contain multiple open reading frames (ORFs), each of which contains a taxonomic signal. Integrating these signals should enable a more robust classification of the entire contig, yet surprisingly few tools exist that integrate distributed signals for contig classification. The viral-specific pipeline MetaVir2 [<xref ref-type="bibr" rid="CR16">16</xref>] assesses the classification of up to five ORFs encoded on a contig. Recently, the MEGAN long-read algorithm was introduced [<xref ref-type="bibr" rid="CR17">17</xref>], which allows users to taxonomically classify long sequences such as those generated by Oxford Nanopore Technologies or Pacific Biosciences sequencers. The algorithm works by partitioning the sequence into intervals based on the location of hits of a LAST [<xref ref-type="bibr" rid="CR18">18</xref>] search.</p>
    <p id="Par6">In contrast, for taxonomic classification of MAGs, it is common to include information from multiple ORFs. Since the classification of complete genomes by using phylogenetic trees of multiple marker genes is well-established [<xref ref-type="bibr" rid="CR19">19</xref>], MAG classification has followed these best practices. Some steps in the process can be automated, including initial placement in a low-resolution backbone tree by CheckM [<xref ref-type="bibr" rid="CR20">20</xref>], specific marker gene identification, and backbone tree taxon selection by phyloSkeleton [<xref ref-type="bibr" rid="CR21">21</xref>], and many tools are available for protein alignment, trimming, tree building, and display. However, interpretation of the resulting phylogeny remains a critical manual step, making this approach for genomic taxonomy a laborious task that does not scale well with the increasing number of MAGs being generated (see, e.g., [<xref ref-type="bibr" rid="CR7">7</xref>]).</p>
    <p id="Par7">Here we present Contig Annotation Tool (CAT) and Bin Annotation Tool (BAT), two taxonomic classifiers whose underlying ORF-based algorithm is specifically designed to provide robust taxonomic classification of long sequences and MAGs. Both tools exploit commonly used tools for ORF calling and homology searches. They require minimal user input and can be applied in an automated manner, yet all aspects are flexible and can be tuned to user preferences.</p>
    <sec id="Sec2">
      <title>Benchmarking classification of sequences from novel taxa</title>
      <p id="Par8">Taxonomic classifiers are often benchmarked by testing them on sequences from novel taxa, i.e., that are not (yet) in the reference database (e.g., as in the CAMI challenge [<xref ref-type="bibr" rid="CR22">22</xref>], and [<xref ref-type="bibr" rid="CR11">11</xref>, <xref ref-type="bibr" rid="CR12">12</xref>, <xref ref-type="bibr" rid="CR14">14</xref>]). Alternatively, unknown query sequences can be simulated by using a “leave-one-out” approach, where the genome that is being queried is removed from the database (e.g., [<xref ref-type="bibr" rid="CR13">13</xref>, <xref ref-type="bibr" rid="CR17">17</xref>]). However, due to taxonomic biases in database composition, other strains from the same species, or other species from the same genus, may still be present. Thus, the leave-one-out approach does not reflect the level of sequence unknownness that is often encountered in real metagenomes, where the query sequences may be only distantly related to the ones in the reference database. A benchmark better suited to address this novelty is a “leave-entire-taxa-out” approach also known as clade exclusion, where all related sequences belonging to a certain taxonomic rank are removed from the database (e.g., [<xref ref-type="bibr" rid="CR11">11</xref>, <xref ref-type="bibr" rid="CR23">23</xref>, <xref ref-type="bibr" rid="CR24">24</xref>]).</p>
      <p id="Par9">Here, we rigorously assess the performance of taxonomic classification tools by developing an extensive database reduction approach at different taxonomic ranks, where novel species, genera, and families are simulated by removing all the sequences of entire taxa from the database. In a second benchmark, we classified the high-complexity CAMI dataset [<xref ref-type="bibr" rid="CR22">22</xref>]. We show that the algorithm of CAT and BAT allows for the correct classification of organisms from known and unknown taxa and outperforms existing methods, especially for sequences that are highly unknown (i.e., with no close relatives in the database). Third, we used BAT in a real-world challenge to classify a large, recently published set of 913 MAGs from the cow rumen [<xref ref-type="bibr" rid="CR7">7</xref>] that represent a wide range of novelty at all taxonomic ranks, and whose published taxonomic classifications involved extensive phylogenetic analyses.</p>
    </sec>
  </sec>
  <sec id="Sec3">
    <title>Results and discussion</title>
    <p id="Par10">To test the performance of our newly developed taxonomic classification tools CAT and BAT, we thoroughly tested them in three independent benchmarks: (1) A clade exclusion experiment with increasing levels of sequence unknownness, (2) the high-complexity gold standard CAMI assembly, and (3) a recently published set of MAGs where the BAT classifications are compared to the published taxonomic classifications.</p>
    <sec id="Sec4">
      <title>Contig classification with CAT</title>
      <sec id="Sec5">
        <title>Benchmark 1: Classification of increasingly unknown sequences</title>
        <p id="Par11">We used CAT (Fig. <xref rid="Fig1" ref-type="fig">1</xref>) to classify ten simulated contig sets in the context of four reference databases with different levels of simulated unknownness, representing query sequences from (A) known strains, (B) novel species, (C) novel genera, and (D) novel families (see the “<xref rid="Sec13" ref-type="sec">Methods</xref>” section). To assess the effect of the two key user parameters, <italic>r</italic> (hits included within <italic>range</italic> of top hits) and <italic>f</italic> (minimum <italic>fraction</italic> classification support), on precision, fraction of classified sequences, sensitivity, and taxonomic rank of classification, we ran CAT with a wide range of possible parameter values against all four reference databases (Fig. <xref rid="Fig2" ref-type="fig">2</xref>). This parameter sweep revealed a trade-off between the classification precision on the one hand and the taxonomic resolution and the fraction of classified sequences on the other hand. This general trend can be understood by considering that classifications at a low taxonomic rank (i.e., close to the species rank, high taxonomic resolution) will inevitably be increasingly imprecise, especially if closely related organisms are absent from the reference database. This might be resolved by classifying sequences at a higher taxonomic rank, but this leads to increased numbers of sequences not being classified or classified at trivially informative taxonomic ranks such as “cellular organisms” or “root.”
<fig id="Fig1"><label>Fig. 1</label><caption><p>Contig and MAG classification with CAT and BAT. <bold>a</bold>, <bold>b</bold> Step 1: ORF prediction with Prodigal. CAT analyses all ORFs on a contig, BAT analyses all ORFs in a MAG. <bold>c</bold> Step 2: predicted ORFs are queries with DIAMOND to the NCBI non-redundant protein database (nr). <bold>d</bold> Step 3: ORFs are individually classified based on the LCA of all hits falling within a certain range of the top hit (parameter <italic>r</italic>), and the top-hit bit-score is assigned to the classification. Bit-scores of hits are depicted within brackets. Hits in gray are not included in final annotation of the ORF. Parameter <italic>f</italic> defines minimal bit-score support (mbs). <bold>e</bold> Step 4: contig or MAG classification is based on a voting approach of all classified ORFs, by summing all bit-scores from ORFs supporting a certain classification. The contig or MAG is classified as the lowest classification reaching mbs. The example illustrates the benefit of including multiple ORFs when classifying contigs or MAGs; a best-hit approach might have selected <italic>Bacteroides vulgatus</italic> or Bacteroidetes if an LCA algorithm was applied as its classification, as this part has the highest score to proteins in the database in a local alignment-based homology search. In the example, only six taxonomic ranks are shown for brevity; in reality, CAT and BAT will interpret the entire taxonomic lineage</p></caption><graphic xlink:href="13059_2019_1817_Fig1_HTML" id="MO1"/></fig>
<fig id="Fig2"><label>Fig. 2</label><caption><p>Classification performance of CAT for different levels of unknownness across a range of parameter settings. Thickness of markers indicates values of the <italic>f</italic> parameter; runs with similar <italic>r</italic> parameter values are connected with black lines. Markers indicate maximum and minimum values out of ten benchmarking datasets, bars cross at the means. Color coding indicates the mean taxonomic rank of classification averaged across the then benchmarking datasets (minimum and maximum values not shown for brevity). Gray lines in the plot depict sensitivity, which is defined as the fraction of classified sequences times precision. Runs with equal parameter settings are connected in the parameter settings figure, showing that CAT achieves a high precision regardless of unknownness of the query sequence, by classifying sequences that are more unknown at higher taxonomic ranks. Default parameter combination (<italic>r</italic> = 10, <italic>f</italic> = 0.5) is shown in red</p></caption><graphic xlink:href="13059_2019_1817_Fig2_HTML" id="MO2"/></fig></p>
        <p id="Par12">The <italic>r</italic> parameter, which governs the divergence of included hits for each ORF, has the largest effect. As increasing <italic>r</italic> includes homologs from increasingly divergent taxonomic groups, their LCA is pushed back and classifications at low taxonomic ranks are lost, resulting in fewer classified sequences and classifications at lower taxonomic resolution (i.e., at higher taxonomic ranks), but with higher precision. The <italic>f</italic> parameter, which governs the minimum bit-score support required for classifying a sequence, has a smaller effect. Decreasing <italic>f</italic> results in classifications that are based on evidence from fewer ORFs, leading to more tentative classifications at lower taxonomic ranks. As a result, more sequences are classified at lower taxonomic ranks, albeit with a lower precision.</p>
        <p id="Par13">As a user increases <italic>r</italic> and <italic>f</italic>, this will increasingly result in high-rank classifications that are correct but ultimately uninformative. When low values of <italic>r</italic> and <italic>f</italic> are chosen, the classifications will be more specific (i.e., at a lower taxonomic rank) but more speculative (i.e., precision goes down). Based on the parameter sweep described above, we set the default values for CAT contig classification to <italic>r</italic> = 10 and <italic>f</italic> = 0.5 (red line in the legend of Fig. <xref rid="Fig2" ref-type="fig">2</xref>). Note that this value of <italic>f</italic> = 0.5 results in at most one classification, since &gt; 50% of the bit-score supports that classification.</p>
      </sec>
      <sec id="Sec6">
        <title>Comparison to state-of-the-art taxonomic classifiers</title>
        <p id="Par14">We compared classification by CAT in this first benchmark to (1) the recently published LAST+MEGAN-LR algorithm [<xref ref-type="bibr" rid="CR17">17</xref>], (2) the widely used Kaiju algorithm [<xref ref-type="bibr" rid="CR13">13</xref>], and (3) a conventional best-hit approach with DIAMOND [<xref ref-type="bibr" rid="CR25">25</xref>]. Kaiju, designed for short-read classification, uses a best-hit approach with an LCA algorithm if equally good top-hits are found. Its underlying algorithm allows for the classification of long sequences as well and has recently been used as such [<xref ref-type="bibr" rid="CR17">17</xref>, <xref ref-type="bibr" rid="CR26">26</xref>, <xref ref-type="bibr" rid="CR27">27</xref>]. Final Kaiju classification is based on the hit with the maximum exact match (MEM), or on the highest scoring match allowing for mismatches (Greedy).</p>
        <p id="Par15">When classifying simulated contigs against the full reference database (known strains), all programs showed a similar precision and fraction of classified sequences (Fig. <xref rid="Fig3" ref-type="fig">3</xref>a). The mean taxonomic rank of classification is slightly higher for CAT and LAST+MEGAN-LR than for the other approaches (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S1), reflecting the conservative LCA-based classification strategies of the former two. DIAMOND best-hit does not use an LCA algorithm, and Kaiju only in cases where multiple hits have identical scores, and thus, they classify contigs according to the taxonomic rank of their match in the reference database.
<fig id="Fig3"><label>Fig. 3</label><caption><p>Classification performance of CAT, LAST+MEGAN-LR, Kaiju, and DIAMOND best-hit for different levels of unknownness. <bold>a</bold> Classification of known sequences. <bold>b</bold>–<bold>d</bold> Classification of simulated novel taxa for different levels of divergence from reference databases. Black bars indicate maximum and minimum values out of ten benchmarking datasets, bars cross at the means. Color coding indicates the mean taxonomic rank of classification averaged across the then benchmarking datasets (minimum and maximum values not shown for brevity)</p></caption><graphic xlink:href="13059_2019_1817_Fig3_HTML" id="MO3"/></fig></p>
        <p id="Par16">When novel species, genera, and families were simulated by removing related sequences from the database, precision declined rapidly for DIAMOND best-hit and Kaiju (Fig. <xref rid="Fig3" ref-type="fig">3</xref>b–d). The classifications called by these approaches are often too specific, because in databases where closely related sequences are absent, the singular best hit may still match a sequence that is annotated at a low taxonomic rank, although this annotation cannot match that of the query. This spurious specificity can be seen in the mean rank of classification, which stays close to the species rank, even when sequences from the same species, genus, or family were removed from the database (Fig. <xref rid="Fig3" ref-type="fig">3</xref>b–d, Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S1). CAT and LAST+MEGAN-LR clearly perform better in the face of such uncharted sequences. With default parameter settings, CAT has higher precision and sensitivity than MEGAN-LR and classifications are made at slightly higher taxonomic ranks.</p>
        <p id="Par17">Precision for CAT and LAST+MEGAN-LR increases when the sequence contains more ORFs with a DIAMOND hit to the database, whereas this is not the case for DIAMOND best-hit and Kaiju (Additional file <xref rid="MOESM2" ref-type="media">2</xref>: Figure S1). Algorithms that integrate multiple taxonomic signals are thus well suited for taxonomic classification of long metagenomic sequences and MAGs (see below), but even the majority of contigs in our benchmarking sets that contained a single ORF are still classified correctly (Additional file <xref rid="MOESM2" ref-type="media">2</xref>: Figure S1).</p>
      </sec>
      <sec id="Sec7">
        <title>Sequences are classified correctly and automatically at the appropriate taxonomic rank</title>
        <p id="Par18">As a solution to the spurious specificity of the best-hit approach described above, classifications are sometimes assigned to a higher taxonomic rank such as genus, family, or even phylum. However, applying a rank cutoff may unnecessarily sacrifice taxonomic resolution in cases where the query sequences do have close relatives in the reference database and classification at a low taxonomic rank would be justified. Additional file <xref rid="MOESM2" ref-type="media">2</xref>: Figure S2 shows that application of a rank cutoff to the best-hit classifications (e.g., reporting all classifications at the genus or phylum rank) does not solve the problem of spurious specificity as effectively as CAT does. CAT classifications have a higher precision than a best-hit cutoff on a rank comparable to its mean rank. For example, when novel families are simulated, the mean rank of classification for CAT is between order and class, and precision is much higher than best-hit classifications on those ranks, with a similar fraction of classified sequences (Additional file <xref rid="MOESM2" ref-type="media">2</xref>: Figure S2d). Importantly, CAT has the highest precision on a per rank basis of any of the tested tools (Additional file <xref rid="MOESM2" ref-type="media">2</xref>: Figure S3, Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S2). This shows that CAT approach of integrating multiple taxonomic signals across a sequence leads to better classifications.</p>
        <p id="Par19">As shown in Fig. <xref rid="Fig2" ref-type="fig">2</xref>, the ORF-based voting algorithm ensures a high precision regardless of the level of unknownness of the query sequences, i.e., whether closely related sequences are present in the reference database or not. In some circumstances, taxonomic resolution is traded for precision: when classifying sequences that are more distantly related to the sequences in the reference database, hits will have weaker bit-scores and match sequences that are taxonomically more diverse. As a result of these conflicting signals, the algorithm automatically increases the taxonomic rank when classifying more divergent query sequences. Thus, no rank cutoff is needed for precise classifications, regardless of the composition of the metagenome.</p>
      </sec>
      <sec id="Sec8">
        <title>Benchmark 2: Comparison to CAMI tools</title>
        <p id="Par20"><italic>O</italic>ur second benchmark consisted of classifying the high-complexity gold standard assembly of the CAMI challenge [<xref ref-type="bibr" rid="CR22">22</xref>]. Classifying the CAMI dataset has two benefits. First, it allows us to compare CAT to any of the taxonomic classifiers tested in the CAMI challenge (referred to as “taxonomic binners” in [<xref ref-type="bibr" rid="CR22">22</xref>]). Second, CAMI simulated novel organisms, making it a complementary benchmarking approach as compared to the database reduction method in our first benchmark.</p>
        <p id="Par21">Since novel sequences are simulated, it is crucial that search databases are used that do not contain the simulated sequences. For this reason, an “old” copy of RefSeq (dated January 30th, 2015) was supplied during the CAMI challenge. Here, we also ran CAT with that old RefSeq reference database for a fair comparison against the other tools. However, one of the advantages of CAT and BAT is that they can be run with very large protein databases and hence have a larger search space for taxonomic classification beyond RefSeq. Thus, we also ran CAT with the nr databases from a similar date (January 23, 2015) as a reference. The nr database is the default option for CAT and BAT runs.</p>
        <p id="Par22">CAT performance measures on the high-complexity gold standard contig set (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S3) are plotted in Additional file <xref rid="MOESM2" ref-type="media">2</xref>: Figure S4 and can be compared to Supplementary Figure 18 and Supplementary Figure 19 in [<xref ref-type="bibr" rid="CR22">22</xref>]. Average precision increases sharply if 99% of the data are considered (i.e., removal of taxa summing up to less than 1% of the total assembly length) as opposed to 100%. This is also true for most of the tools tested in the CAMI challenge. The reason for this observation is that precision in the CAMI challenge is measured on a “per bin” basis, and erroneous classifications of single contigs thus weigh very heavily in this benchmark. If classifications that are seen in only a single or few contigs (i.e., are supported by short sequence length overall) are excluded, CAT showed very high average precision at all taxonomic ranks down to the genus level (Additional file <xref rid="MOESM2" ref-type="media">2</xref>: Figure S4). Accuracy and average recall were high for higher ranks and decreased towards the species level. Misclassification was very low, with misclassification rates of up to 11% only at the lowest taxonomic ranks. Notably, CAT results with nr as a reference database (Additional file <xref rid="MOESM2" ref-type="media">2</xref>: Figure S4b) were better than with RefSeq as reference (Additional file <xref rid="MOESM2" ref-type="media">2</xref>: Figure S4a) for any of the measures. Average precision stayed above 90% down to the genus level if nr was used as a reference, higher than what is achieved by any of the tools tested in the CAMI challenge (see below). This highlights the benefit of using a large reference database for taxonomic classification.</p>
        <p id="Par23">We compared CAT to the other tools tested in the CAMI challenge by downloading their performance measures from the CAMI GitHub (Additional file <xref rid="MOESM2" ref-type="media">2</xref>: Figure S5). The CAMI tools fall within two categories: One set of tools (taxator-tk 1.4pre1e, taxator-tk 1.3.0e, PhyloPythiaS+ mg c400, MEGAN 6.4.9) had low misclassification but also low average recall and accuracy. The other set (PhyloPythiaS+ c400, Kraken 0.10.6-unreleased, Kraken 0.10.5) had high recall and accuracy, but very high misclassification rates towards species level. In contrast, CAT managed a medium (when using RefSeq as reference database) to high (when using nr as reference database) average recall and accuracy, with a very low misclassification rate. The misclassification rate was lower than that of the CAMI tools, with the exception of taxator-tk (both versions), which classified very few sequences in general. CAT scored among the highest average precision with 99% of the data. Thus, CAT has a high average precision and combines the high average recall and accuracy of the second set of tools with the low misclassification of the first.</p>
      </sec>
      <sec id="Sec9">
        <title>The ORF-based algorithm is fast and has a very low memory requirement</title>
        <p id="Par24">CAT is about two times faster than LAST+MEGAN-LR (Fig. <xref rid="Fig4" ref-type="fig">4</xref>a) and outperforms all other programs tested in our first benchmark in terms of memory usage (Fig. <xref rid="Fig4" ref-type="fig">4</xref>b). The slowest and most memory intensive step is the DIAMOND search for homologs in the vast nr database, which due to the flexible nature of our implementation can be optimized for a specific use case (see Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S4) or replaced by any protein aligner of a user’s choice, as can the search database.
<fig id="Fig4"><label>Fig. 4</label><caption><p>Computer resource usage by CAT, LAST+MEGAN-LR, and Kaiju. <bold>a</bold> Run-time and <bold>b</bold> peak memory usage. In <bold>a</bold>, classification by CAT and Kaiju includes adding taxonomic names to the classification; in <bold>b</bold>, these steps are depicted separately</p></caption><graphic xlink:href="13059_2019_1817_Fig4_HTML" id="MO4"/></fig></p>
        <p id="Par25">We classified the CAMI high complexity dataset with recent versions of the tools tested in our first and second benchmarks. This analysis showed that CAT is faster than MEGAN6, LAST+MEGAN-LR, and taxator-tk and has a memory footprint that is similar to or lower than any of the tested tools (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S4).</p>
      </sec>
    </sec>
    <sec id="Sec10">
      <title>MAG classification with BAT</title>
      <sec id="Sec11">
        <title>Benchmark 3: Classification of 913 metagenome-assembled genome bins (MAGs)</title>
        <p id="Par26">Next, we set out to apply the algorithm to MAGs, i.e., draft genomes that can be generated from metagenomes by assembly and binning. Since the typical pipeline to generate MAGs is reference database independent, they can be distantly related to known organisms. As benchmark set, we picked 913 recently published MAGs from the cow rumen [<xref ref-type="bibr" rid="CR7">7</xref>] that represented a wide range of novelty at different taxonomic ranks (Additional file <xref rid="MOESM2" ref-type="media">2</xref>: Figure S6a). The published classifications were based on the placement of the MAGs in a backbone tree and subsequent refinement, a slow process that includes various manual steps and visual screening [<xref ref-type="bibr" rid="CR7">7</xref>]. At the time of our study, the MAGs were not yet included in the reference database, providing an ideal test case for our automated classification tool BAT.</p>
        <p id="Par27">The 913 MAGs were previously assessed to be ≥ 80% complete and have ≤ 10% contamination and contain between 541 and 5378 ORFs each (Additional file <xref rid="MOESM2" ref-type="media">2</xref>: Figure S6b). We ran BAT with default parameter settings for MAGs classification (<italic>r</italic> = 5, <italic>f</italic> = 0.3). The low <italic>r</italic> value ensures that individual ORFs are annotated to an LCA with a relatively low taxonomic rank, as hits within 5% of the highest bit-score are considered. The low <italic>f</italic> value reports taxonomic classifications that are supported by at least 30% of the bit-score evidence. While this could be considered a speculative call when contigs with relatively few encoded ORFs are annotated, the much higher number of ORFs in MAGs means that even classifications with relatively low <italic>f</italic> values are backed by a high number of ORFs and precision is thus expected to be high (Additional file <xref rid="MOESM2" ref-type="media">2</xref>: Figure S1). We scored the consistency between BAT and the published classifications (Fig. <xref rid="Fig5" ref-type="fig">5</xref>a), dividing consistent classifications into three groups: (i) BAT can be more conservative than the published classification, i.e., BAT classifies the MAG to an ancestor of the published classification; (ii) classifications can be equal; and (iii) BAT can be more specific. Alternatively, BAT can classify a MAG inconsistently, i.e., in a different taxonomic lineage than the original publication. As shown in Fig. <xref rid="Fig5" ref-type="fig">5</xref>a, 885 of 913 MAGs (97%) were classified consistently with the original publication. If parameter <italic>f</italic> is relaxed, mean rank of classification for the MAGs increases (Fig. <xref rid="Fig5" ref-type="fig">5</xref>b). Importantly, decreasing the value of <italic>f</italic> has little effect on inconsistency rate. Thus, changing this parameter will mainly lead to a change in the rank of classification, while the taxonomic lineage will remain unchanged. Finally, classifying these MAGs with two MAG classification tools that are still under development, lastTaxa (<ext-link ext-link-type="uri" xlink:href="https://gitlab.com/jfroula/lasttaxa">https://gitlab.com/jfroula/lasttaxa</ext-link>) and GTDB-Tk (<ext-link ext-link-type="uri" xlink:href="https://github.com/Ecogenomics/GTDBTk">https://github.com/Ecogenomics/GTDBTk</ext-link>), yielded very similar results (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S5).
<fig id="Fig5"><label>Fig. 5</label><caption><p>Classification of 913 MAGs with BAT. <bold>a</bold> Consistency between BAT classifications and published classifications with default parameter settings (<italic>r</italic> = 5, <italic>f</italic> = 0.3). <bold>b</bold> The mean rank of classification can be increased by increasing <italic>f</italic>. Arrow indicates BAT results for its default parameter settings</p></caption><graphic xlink:href="13059_2019_1817_Fig5_HTML" id="MO5"/></fig></p>
        <p id="Par28">To assess the taxonomy of the 28 inconsistently classified MAGs (at <italic>r</italic> = 5, <italic>f</italic> = 0.3), we placed them in a phylogenomic tree with closely related genomes and observed their closest relatives, the published classifications, and the BAT classifications. As shown in Fig. <xref rid="Fig6" ref-type="fig">6</xref>, BAT classified all 28 inconsistently classified MAGs more precisely and at a higher taxonomic resolution than the published classifications. Note that this may be due to these closely related reference genomes being new additions to the database since the research was performed. Together, these results highlight the benefit of using BAT for the rapid, automated, and high-resolution taxonomic classification of novel microbial lineages at a range of unknownness.
<fig id="Fig6"><label>Fig. 6</label><caption><p>Tree placement of the 28 inconsistently classified MAGs that were assigned to five different taxa according to the original classifications (<bold>a</bold>–<bold>d</bold>). Headers of subfigures refer to the published classifications. In <bold>a</bold>, MAGs published as Selenomonadales are marked with an asterisk. Taxonomic classification of reference genomes is indicated in shades boxes. BAT classifications of MAGs are indicated in open boxes</p></caption><graphic xlink:href="13059_2019_1817_Fig6_HTML" id="MO6"/></fig></p>
      </sec>
    </sec>
  </sec>
  <sec id="Sec12">
    <title>Conclusions</title>
    <p id="Par29">Metagenomics continues to reveal novel microorganisms in all environments in the biosphere, whose genome sequences can be reconstructed with high accuracy by using high-throughput DNA sequencing and modern sequence assembly and binning tools. Taxonomically classifying these uncharted sequences remains challenging, partly because the vast natural biodiversity remains highly underrepresented in even the largest reference databases, partly because existing classifiers are built to classify short sequencing reads, and partly because interpreting trees is manual work.</p>
    <p id="Par30">We presented CAT and BAT, a set of tools that exploits DIAMOND homology searches of individual ORFs called by Prodigal, LCA annotation, and a user-definable weighting to classify long contigs and metagenome-assembled genomes (MAGs). As we have shown, these query sequences contain a wealth of information that allows their accurate taxonomic classification at appropriate taxonomic ranks, i.e., at a low rank when closely related organisms are present in the database, and at a high rank when the sequences are divergent or highly novel. We have shown that the low precision of conventional best-hit approaches when classifying novel taxa can be overcome by a voting algorithm based on classifications of multiple ORFs. Elegantly, sequences from organisms that are distantly related to those in the reference database are automatically classified at a higher taxonomic rank than known strains. ORFs on divergent sequences will hit a wider variety of different taxa both on the individual ORF level and between ORFs. Such conflict of classifications is automatically resolved by the algorithm by providing a more conservative classification, so no taxonomic cutoff rank for classification needs to be pre-defined. In metagenomes containing both known and unknown sequences, the algorithm vastly outperforms best-hit approaches and a range of state-of-the-art taxonomic classifiers in precision.</p>
    <p id="Par31">CAT and BAT supplement a modern metagenomics workflow in various ways. For example, CAT can be used after metagenome assembly to confidently classify all contigs. Since contigs are longer sequences and thus contain more information than individual reads, we expect that classification of the original reads in terms of classified contigs results in better profiling estimates than those based on the reads alone. Indeed, a comparison in [<xref ref-type="bibr" rid="CR22">22</xref>] between taxonomic binners and dedicated taxonomic profilers (whose output is an abundance profile but not classification of individual sequences) showed that on average binners estimated taxon abundance more accurately than profilers. With increases in contig lengths due to advances in assembly algorithms and more deeply sequenced metagenomes, as well as increasingly available long-read metagenomic sequencing datasets, CAT classifications will become even more precise in the future. Moreover, BAT will rapidly provide taxonomic classifications of MAGs without requiring a full phylogenomics pipeline and subsequently visual inspection of the tree. CAT classifications of individual contigs within MAGs can be used to identify taxonomic outliers, and flag those as possible contamination. As most binning tools do not incorporate taxonomic signals (e.g., [<xref ref-type="bibr" rid="CR28">28</xref>, <xref ref-type="bibr" rid="CR29">29</xref>]), CAT classification can be considered as independent evidence and might be used to decide on the inclusion of specific contigs in a MAG.</p>
    <p id="Par32">BAT provides a robust and rapid classification of MAGs in a single operation, but is not a replacement for high-confidence phylogenomic tree construction based on marker gene superalignments which remains the gold standard [<xref ref-type="bibr" rid="CR19">19</xref>]. However, BAT queries the full NCBI non-redundant reference database (nr) and the taxonomic context is thus much bigger than any phylogenomic tree that depends on completely sequenced genomes. For example, the backbone tree of CheckM currently includes only 5656 genomes [<xref ref-type="bibr" rid="CR20">20</xref>]. BAT classification is fully automated and can be run on a set of MAGs with minimal user input, allowing MAG classification to be scaled up considerably as we showed here for over 900 MAGs that were classified consistently with the original publication in almost all cases. Notably, in all inconsistent cases, we identified genomes that were more closely related to the BAT classification than to the published (manual) classification.</p>
    <p id="Par33">As long as sequence space is incompletely explored and reference databases represent a biased view of the tree of life [<xref ref-type="bibr" rid="CR1">1</xref>, <xref ref-type="bibr" rid="CR3">3</xref>], algorithms designed to address the abundant uncharted microbial sequences will be needed to make sense of the microbial world. Decreasing sequencing costs and improvement of alignment and binning algorithms have moved metagenomics from the analysis of short reads towards contigs and MAGs, improving our understanding of microbial ecosystems to a genomic resolution. As these data will only increase in the coming years, we presented a robust solution to their specific challenges that we expect will play an important role in future metagenomics workflows.</p>
  </sec>
  <sec id="Sec13">
    <title>Methods</title>
    <sec id="Sec14">
      <title>Explanation of the algorithm</title>
      <p id="Par34">Both CAT and BAT take high-quality long DNA sequences in FASTA format as input (Fig. <xref rid="Fig1" ref-type="fig">1</xref>), such as assembled contigs or corrected long Oxford Nanopore Technologies or Pacific Biosciences reads [<xref ref-type="bibr" rid="CR30">30</xref>, <xref ref-type="bibr" rid="CR31">31</xref>]. First, ORFs are predicted with Prodigal [<xref ref-type="bibr" rid="CR32">32</xref>] in metagenome mode, using default parameter settings (genetic code 11) (Fig. <xref rid="Fig1" ref-type="fig">1</xref>a, b). Predicted proteins can also be independently supplied to CAT/BAT in case a user prefers a different gene caller than Prodigal.</p>
      <p id="Par35">Next, protein translations of the predicted ORFs are queried against the National Center for Biotechnology Information (NCBI) non-redundant protein database (nr) [<xref ref-type="bibr" rid="CR33">33</xref>] using DIAMOND [<xref ref-type="bibr" rid="CR25">25</xref>] blastp (<italic>e</italic> value cutoff of 0.001, BLOSUM62 alignment matrix, reporting alignments within 50% range of top hit bit-score) (Fig. <xref rid="Fig1" ref-type="fig">1</xref>c). The nr database is currently the largest sequence database where all sequences are assigned to clades in NCBI Taxonomy [<xref ref-type="bibr" rid="CR34">34</xref>]. A separate BLAST tabular output file can also be supplied together with the predicted protein file, in which case CAT/BAT starts directly with classification.</p>
      <p id="Par36">Taxonomic classification of the query sequences is then carried out based on a voting approach that considers all ORFs on a query with hits to the reference database. Here, the main difference between CAT and BAT is that CAT considers ORFs on a single contig, whereas BAT considers ORFs on all contigs belonging to a MAG. CAT and BAT also have slightly different default parameter values (see below).</p>
      <p id="Par37">First, the algorithm infers the taxonomic affiliation of individual ORFs based on the top DIAMOND hits (Fig. <xref rid="Fig1" ref-type="fig">1</xref>d). To account for similarly high-scoring hits in potentially different clades, hits within a user-defined range of the top hit bit-score to that ORF are considered and the ORF is assigned to the LCA of their lineages (parameter <italic>r</italic> for <italic>range</italic>, by default hits with bit-scores within 10% or 5% range of the top hit bit-score are included, <italic>r</italic> = 10 for CAT and <italic>r</italic> = 5 for BAT, respectively). By adjusting parameter <italic>r</italic>, the user can tune how conservative CAT is in the classification of individual ORFs. For example, increasing <italic>r</italic> results in more divergent hits being included that together are likely to have a deeper LCA, thus leading to a more conservative ORF classification at a higher taxonomic rank. In contrast, decreasing <italic>r</italic> leads to a more specific classification since fewer and more similar hits will be included, likely with a narrower taxonomic range. This accounts for conserved or HGT-prone genes that are highly similar in diverse taxa by assigning them a high-rank classification. The top hit bit-score for each ORF is registered for the subsequent voting process (Fig. <xref rid="Fig1" ref-type="fig">1</xref>d).</p>
      <p id="Par38">Next, the query contig or MAG is evaluated by summing the bit-scores for each taxon identified among the classifications of all ORFs, as well as their ancestral lineages up to the taxonomy root (Fig. <xref rid="Fig1" ref-type="fig">1</xref>e). The query contig or MAG is then assigned to a taxon, if the total bit-score evidence for that taxon exceeds a cutoff value (<italic>mbs</italic>, minimal bit-score support), which is calculated as a fraction (parameter <italic>f</italic> for <italic>fraction</italic>) of the sum of the bit-scores of all ORFs (mbs = <italic>f</italic> × <italic>B</italic><sub>sum</sub>, by default <italic>f</italic> = 0.5 for CAT and <italic>f</italic> = 0.3 for BAT). For example, if parameter <italic>f</italic> is set to 0.5, this means that a contig is assigned to a taxon if the majority of the sum of the bit-scores of all ORFs supports that classification (mbs = 0.5 × <italic>B</italic><sub>sum</sub>). This is done at multiple taxonomic ranks including phylum, class, order, family, genus, and species. The algorithm stops at the taxonomic rank where the total bit-score supporting the classification drops below the minimal bit-score support value, so CAT/BAT automatically finds the lowest rank taxonomic classification that is still reliable (Fig. <xref rid="Fig1" ref-type="fig">1</xref>e). Note that with CAT default values (<italic>f</italic> = 0.5), only one classification is given per sequence, and there can be no conflicting classifications at different ranks (e.g., a species-level classification conflicting with a genus-level classification). When <italic>f</italic> &lt; 0.5 is set by the user, multiple lineages at a given taxonomic rank may exceed the threshold, and all will be written to the output file. A user can decide on the appropriate (rank of) classification based on support values that represent the fraction of summed bit-score that supports the classification. While these support values are indicative of the prediction precision (Additional file <xref rid="MOESM2" ref-type="media">2</xref>: Figure S7a), in contrast to the total bit-score alone (Additional file <xref rid="MOESM2" ref-type="media">2</xref>: Figure S7b), it should be noted that they cannot be interpreted as statistical probabilities.</p>
    </sec>
    <sec id="Sec15">
      <title>Output files</title>
      <p id="Par39">For each query contig or MAG, the full taxonomic lineage of the lowest-rank supported classification is written to the output file, together with support values per rank (i.e., the fraction of <italic>B</italic><sub>sum</sub> that is represented by the taxon). In addition, the number of ORFs found on the contig or MAG and the number of ORFs on which the classification is based are written to the output file. An extra output file containing information about individual ORFs is also generated, including classifications of ORFs and an explanation for any ORF that is not classified. We advise the user caution when interpreting the classifications of short contigs that are based on relatively few ORFs as they will be less robust than the classifications of long contigs or MAGs (Additional file <xref rid="MOESM2" ref-type="media">2</xref>: Figure S1).</p>
    </sec>
    <sec id="Sec16">
      <title>Helper programs</title>
      <p id="Par40">The CAT/BAT package comes bundled with three helper utilities, “prepare,” “add_names,” and “summarise.” “Prepare” only needs to be run once. It downloads all the needed files including NCBI taxonomy files and the nr database. It constructs a DIAMOND database from nr and generates the files needed for subsequent CAT and BAT runs. Because the first protein accession in nr not always represents the LCA of all protein accessions in the entry, “prepare” corrects for this in the protein accession to taxonomy id mapping file (prot.accession2taxid). After running CAT/BAT, “add_names” will add taxonomic names to the output files, either of the full lineage or of official taxonomic ranks alone (superkingdom, phylum, class, order, family, genus, species). “Summarise” generates summary statistics based on a named classification file. For contig classification, it reports the total length of the contigs that are classified to each taxon. For MAG classification, it reports the number of MAGs per taxon.</p>
    </sec>
    <sec id="Sec17">
      <title>Generation of contigs for clade exclusion benchmarking datasets</title>
      <p id="Par41">To test the performance of the algorithm in a first benchmark, we artificially generated contigs from known genome sequences in the RefSeq database [<xref ref-type="bibr" rid="CR35">35</xref>] (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S6). We randomly downloaded one genome per taxonomic order from bacterial RefSeq on July 7, 2017 (163 orders in total) and cut the genomes into at most 65 non-overlapping contigs, generating a set of ~ 10,500 contigs with known taxonomic affiliation. Contig lengths were based on the length distribution of eight assembled real metagenomes deposited in the Sequence Read Archive (SRA) [<xref ref-type="bibr" rid="CR36">36</xref>] (assembly with metaSPAdes v3.10.1 [<xref ref-type="bibr" rid="CR4">4</xref>] after quality filtering with BBDuk that is included with BBTools v36.64 (<ext-link ext-link-type="uri" xlink:href="https://sourceforge.net/projects/bbmap/">https://sourceforge.net/projects/bbmap/</ext-link>), see Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S6), with a minimum length of 300 nucleotides. This was done ten times to construct ten different benchmarking datasets sampled from 163 different genomes, each from a different taxonomic order.</p>
      <p id="Par42">Viruses remain vastly under-sampled, and the sequences in the database remain a small fraction of the total viral sequence space [<xref ref-type="bibr" rid="CR37">37</xref>]. Moreover, the hierarchy of the viral taxonomy is not as deeply structured as the taxonomy of cellular organisms [<xref ref-type="bibr" rid="CR38">38</xref>]. Based on these considerations, we did not explicitly assess the performance of our tool on viral sequences. However, we expect that classification of viruses will be readily possible when closely related viruses are present in the reference database.</p>
    </sec>
    <sec id="Sec18">
      <title>Reference databases with increasing levels of unknownness</title>
      <p id="Par43">The benchmarking datasets generated above are derived from genomes whose sequences are also present in the reference database, corresponding to the perhaps unlikely scenario where the query sequences in the metagenome are identical to known strains in the database. To benchmark our tools in the context of discovering sequences from novel taxa, we next generated novel reference databases with increasing levels of unknownness by removing specific taxonomic groups from nr. In addition to the original nr database (known strains), three derived databases were constructed to reflect the situation of discovering novel species, genera, and families. This was done by removing all proteins that are only present in the same species, genus, or family as any of the 163 genomes in the benchmarking dataset. To do this, either we removed the sequences from the database itself, or if a protein was identical in sequence to a protein in another clade, we changed the protein accession to taxonomy id mapping file to exclude the query taxon. In contrast to many other taxonomic classification tools, all the programs that we compared (CAT, DIAMOND best-hit, LAST+MEGAN-LR, and Kaiju) allowed such custom files to be used. The three reduced databases and associated mapping files thus reflect what nr would have looked like if the species, genus, or family of the genomes present in the benchmarking dataset were never seen before. This was done independently for each of the ten different benchmarking datasets, resulting in a total of 30 new reference databases to rigorously test the performance of our sequence classification tools in the face of uncharted microbial sequences. Simulating unknownness like this provides a better benchmark for classification of unknown sequences than a leave-one-out approach where only the query genome is removed from the reference database(e.g., [<xref ref-type="bibr" rid="CR13">13</xref>, <xref ref-type="bibr" rid="CR17">17</xref>]), because close relatives of the query may still be present in the latter case.</p>
    </sec>
    <sec id="Sec19">
      <title>Programs, parameters, and dependencies</title>
      <p id="Par44">Nr database and taxonomy files were downloaded on November 23, 2017. Prodigal v2.6.3 [<xref ref-type="bibr" rid="CR32">32</xref>] was used to identify ORFs on the simulated contigs. DIAMOND v0.9.14 [<xref ref-type="bibr" rid="CR25">25</xref>] was used to align the encoded proteins to the reference databases for CAT and for the DIAMOND best-hit approach. Kaiju v1.6.2 [<xref ref-type="bibr" rid="CR13">13</xref>] was run both in MEM and Greedy mode with SEG low complexity filter enabled. The number of mismatches allowed in Greedy mode was set to 5. For LAST+MEGAN-LR, LAST v914 [<xref ref-type="bibr" rid="CR18">18</xref>] was used to map sequences to the databases with a score penalty of 15 for frameshifts, as suggested in [<xref ref-type="bibr" rid="CR17">17</xref>]. Scripts in the MEGAN v6.11.7 [<xref ref-type="bibr" rid="CR17">17</xref>] tools directory were used to convert LAST output to a classification file. The maf2daa tool was used to convert LAST output to a .daa alignment file. The daa2rma tool was used to apply the long-read algorithm. “--minSupportPercent” was set to 0 and the LCA algorithm to longReads, and the longReads filter was applied. “--topPercent” was set to 10 and “--lcaCoveragePercent” to 80 (MEGAN-LR defaults). The rma2info tool was used to convert the generated .rma file to a classification file. When a reduced database was queried, the appropriate protein accession to taxonomy id mapping file was supplied via its respective setting (see the section “<xref rid="Sec18" ref-type="sec">Reference databases with increasing levels of unknownness</xref>” above).</p>
    </sec>
    <sec id="Sec20">
      <title>Scoring of contig classification performance</title>
      <p id="Par45">For contig classification, we scored (i) the fraction of classified contigs, (ii) sensitivity, (iii) precision, and (iv) mean and median rank of classification (Additional file <xref rid="MOESM2" ref-type="media">2</xref>: Figure S8). Classifications were compared at the taxonomic ranks of species, genus, family, order, class, phylum, and superkingdom. In those cases where <italic>f</italic> &lt; 0.5 and multiple classifications reached the mbs threshold, we chose the lowest classification that reached a majority vote (i.e., as if <italic>f</italic> = 0.5) for calculating the four performance measures i–iv. This means CAT classifications were more conservative in those (rare) cases. Contigs with a classification higher than the superkingdom rank (e.g., “cellular organisms” or “root”) were considered unclassified, as these classifications are trivially informative in our benchmark. For all tools, a classification was considered correct if it was a subset of the true taxonomic lineage, regardless of rank of classification. If a classification was consistent with the true taxonomic lineage but classified too specifically (e.g., at the species rank whereas the query is a novel family), it was considered incorrect. For classifications that are shown per rank, only that part of the lineage that is too specific is considered incorrect.</p>
      <p id="Par46">The mean and median taxonomic rank of classification were calculated for all classified contigs, where the ranks species-phylum were given the integer values 0–6, respectively. Even though the true distance between taxonomic ranks may vary [<xref ref-type="bibr" rid="CR39">39</xref>], calculating mean taxonomic rank in this fashion does serve as a proxy to show that classifications are called at higher taxonomic ranks “on average” under certain parameter conditions or, e.g., with higher divergence of the query sequence from the reference database. Sensitivity and precision were scored as (correctly classified/total number of contigs) and (correctly classified/total number of classified contigs), respectively. Thus, all performance measures are a property of the whole contig set and not of single taxonomic classifications as with some measures in the CAMI challenge benchmark further on. Wherever error bars are shown, they represent the maximum and minimum values out of the ten benchmark datasets.</p>
    </sec>
    <sec id="Sec21">
      <title>CAMI high-complexity gold standard benchmark</title>
      <p id="Par47">In a second benchmark, we downloaded the high-complexity gold standard assembly together with the taxonomy files and NCBI RefSeq database (dated January 30, 2015) that was supplied with the CAMI challenge [<xref ref-type="bibr" rid="CR22">22</xref>]<bold>.</bold> We ran CAT on the assembly with RefSeq and nr (dated January 23, 2015) as reference databases. Importantly, both databases did not contain any of the query sequences yet.</p>
      <p id="Par48">We scored performance in exactly the same way as in the CAMI challenge, which allows us to compare the results of CAT to any of the taxonomic classifiers tested (“taxonomic binners”). In short, all four measures (accuracy, misclassification, average precision, average recall) are a function of the number of classified base pairs and not of classified contigs as in the benchmark above. If a tool classifies a sequence on a taxonomic rank that is not present in the gold standard, it is not taken into account. Thus, there is no penalty for classifications that are too specific. Accuracy is (number of correctly classified base pairs/total number of base pairs), misclassification (number of incorrectly classified base pairs/total number of base pairs), and both are thus a property of the whole assembly. Precision is a measure of the purity of a predicted taxonomic bin (i.e., all sequences from a single predicted taxon) with (number of correctly assigned base pairs/total assigned base pairs). Average precision is the mean precision of all predicted taxonomic bins and is thus very sensitive to misclassified small bins. Therefore in [<xref ref-type="bibr" rid="CR22">22</xref>] in addition to precision measures of the full data, small bins summing up to 1% of the data are excluded and precision is recalculated. We did the same. Recall is a measure of the completeness of a real taxon bin (i.e., all sequences from a single query taxon), with (number of correctly assigned base pairs/real number of base pairs). Average recall is mean recall for all real taxon bins.</p>
      <p id="Par49">For a comparison with all taxonomic classifiers tested in the CAMI challenge, we downloaded the summaries from <ext-link ext-link-type="uri" xlink:href="https://github.com/CAMI-challenge/firstchallenge_evaluation/tree/master/binning/tables/plot/supervised/summary_high.csv">https://github.com/CAMI-challenge/firstchallenge_evaluation/tree/master/binning/tables/plot/supervised/summary_high.csv</ext-link> and <ext-link ext-link-type="uri" xlink:href="https://github.com/CAMI-challenge/firstchallenge_evaluation/tree/master/binning/tables/plot/supervised/summary99_high.csv">https://github.com/CAMI-challenge/firstchallenge_evaluation/tree/master/binning/tables/plot/supervised/summary99_high.csv</ext-link>.</p>
    </sec>
    <sec id="Sec22">
      <title>MAG classification</title>
      <p id="Par50">For a third benchmark, 913 high-quality draft genome bins (MAGs) (completeness ≥ 80%, contamination ≤ 10%) from the cow rumen generated with both conventional metagenomics as well as Hi-C binning methods [<xref ref-type="bibr" rid="CR7">7</xref>] were downloaded from the DataShare of the University of Edinburgh (<ext-link ext-link-type="uri" xlink:href="https://datashare.is.ed.ac.uk/handle/10283/3009">https://datashare.is.ed.ac.uk/handle/10283/3009</ext-link>). Taxonomic classification of the MAGs was downloaded from the supplementary data that accompanies the paper and manually corrected if the names did not match our taxonomy files (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S5). To save disk space on the alignment file being generated, we ran BAT on batches of 25 genomes each. Akin to the contig classification case in the first benchmark, we only considered classifications by BAT at official taxonomic ranks and chose the majority classification in those cases were BAT gave more than one classification for a MAG (i.e., as if <italic>f =</italic> 0.5 for that MAG) resulting in more conservative classifications.</p>
      <p id="Par51">To manually assess the 28 MAGs whose classification was inconsistent with the published classifications, we created a phylogenomic tree of those bins together with closely related genomes that were downloaded from PATRIC [<xref ref-type="bibr" rid="CR40">40</xref>] on January 16, 2018. CheckM v1.0.7 [<xref ref-type="bibr" rid="CR20">20</xref>] was used to extract 43 phylogenetically informative marker genes that were realigned with ClustalOmega v1.2.3 [<xref ref-type="bibr" rid="CR41">41</xref>]. We concatenated the alignments to create a superalignment and included gaps if a protein was absent. We constructed a maximum likelihood tree with IQ-TREE v1.6.3 [<xref ref-type="bibr" rid="CR42">42</xref>], with ModelFinder [<xref ref-type="bibr" rid="CR43">43</xref>] set to fit nuclear models (best-fit model LG+R7 based on Bayesian Information Criterion), including 1000 ultrafast bootstraps [<xref ref-type="bibr" rid="CR44">44</xref>]. Per clade, rooted subtrees were visualized in iTOL [<xref ref-type="bibr" rid="CR45">45</xref>].</p>
      <p id="Par52">We classified the MAGs with 2 MAG classification tools that are still under development, lastTaxa (<ext-link ext-link-type="uri" xlink:href="https://gitlab.com/jfroula/lasttaxa">https://gitlab.com/jfroula/lasttaxa</ext-link>) and GTDB-Tk v0.2.2 (<ext-link ext-link-type="uri" xlink:href="https://github.com/Ecogenomics/GTDBTk">https://github.com/Ecogenomics/GTDBTk</ext-link>). LastTaxa predicts ORFs with Prodigal and searches the nr database with LAST, after which classification is based on the majority classification of individual ORFs. LastTaxa was run on the same nr dataset as BAT, and they can thus be directly compared. GTDB-Tk first identifies marker genes and places the MAG in a reference genome tree based on these marker genes (see also [<xref ref-type="bibr" rid="CR39">39</xref>]). GTDB-Tk was run with the classify workflow with release 86 of the GTDB-tk reference database. This database was constructed after the publication of [<xref ref-type="bibr" rid="CR7">7</xref>]. The results of these comparisons can be found in Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S5.</p>
    </sec>
    <sec id="Sec23">
      <title>Usage of computer resources</title>
      <p id="Par53">Run time and peak memory usage were estimated with the Linux/usr/bin/time utility. Elapsed wall clock time and maximum resident set size were scored for runs of CAT, MEGAN-LR, and Kaiju, classifying contig set #1 (10,533 contigs, see Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S6) with the nr reference database. All tools were run with default parameter settings. Runs were performed on a machine with an Intel Xeon Gold 6136 Processor, 128 GB of memory, 24 cores, and 48 threads. Whenever one of the programs allowed for the deployment of multiple threads, all were used.</p>
      <p id="Par54">We estimated run time and peak memory usage for CAT, MEGAN-LR, Kaiju, and recent versions of the CAMI tools on the CAMI high-complexity dataset, with the NCBI RefSeq database that was supplied with the CAMI challenge as a reference. PhyloPythiaS+ was excluded because it needs a custom database that cannot be constructed based on RefSeq. The CAMI tools were run as suggested in their respective manuals and/or as done in the CAMI challenge (see Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S4). MEGAN was run on a single metagenomic read file (out of 5 in the challenge); all the other tools were run on the gold standard assembly (42,038 contigs). Runs were performed on a machine with an Intel Xeon E5-2667 v3 Processor, 512 GB of memory, and 16 cores/threads. Whenever one of the programs allowed for the deployment of multiple threads, all were used.</p>
      <p id="Par55">CAT and BAT have been tried and tested on 128 GB machines.</p>
    </sec>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary information</title>
    <sec id="Sec24">
      <p>
        <supplementary-material content-type="local-data" id="MOESM1">
          <media xlink:href="13059_2019_1817_MOESM1_ESM.xlsx">
            <caption>
              <p><bold>Additional file 1: </bold><bold>Tables S1-S6.</bold> Supplementary tables. (XLSX 7 mb)</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM2">
          <media xlink:href="13059_2019_1817_MOESM2_ESM.pdf">
            <caption>
              <p><bold>Additional file 2: Figures S1-S8.</bold> Supplementary figures. (PDF 1.55 mb)</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM3">
          <media xlink:href="13059_2019_1817_MOESM3_ESM.docx">
            <caption>
              <p><bold>Additional file 3.</bold> Review history. (DOCX 21.7 kb)</p>
            </caption>
          </media>
        </supplementary-material>
      </p>
    </sec>
  </sec>
</body>
<back>
  <fn-group>
    <fn>
      <p>
        <bold>Publisher’s Note</bold>
      </p>
      <p>Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p>
    </fn>
    <fn>
      <p>F. A. Bastiaan von Meijenfeldt and Ksenia Arkhipova contributed equally to this work.</p>
    </fn>
  </fn-group>
  <sec>
    <title>Supplementary information</title>
    <p><bold>Supplementary information</bold> accompanies this paper at 10.1186/s13059-019-1817-x.</p>
  </sec>
  <ack>
    <title>Acknowledgements</title>
    <p>We thank Jan Kees van Amerongen for his technical support and Johannes Dröge for his advice on taxator-tk.</p>
    <sec id="FPar1">
      <title>Review history</title>
      <p id="Par56">The review history is available as Additional file <xref rid="MOESM3" ref-type="media">3</xref>.</p>
    </sec>
  </ack>
  <notes notes-type="author-contribution">
    <title>Authors’ contributions</title>
    <p>BED conceived the study. FABvM, DDC, and KA wrote the code. FABvM and FHC analyzed the data. FABvM and BED wrote the paper. All authors read and approved the final manuscript.</p>
  </notes>
  <notes notes-type="funding-information">
    <title>Funding</title>
    <p>This work was supported by the Netherlands Organization for Scientific Research [Vidi grant 864.14.004] to [B.E.D.] and the Conselho Nacional de Desenvolvimento Científico e Tecnológico [Science Without Borders program] to [D.D.C.] and [F.H.C.].</p>
  </notes>
  <notes notes-type="data-availability">
    <title>Availability of data and materials</title>
    <p>CAT and BAT are available under the MIT License at GitHub [<xref ref-type="bibr" rid="CR46">46</xref>]. A version of the source code used in this manuscript is deposited on Zenodo [<xref ref-type="bibr" rid="CR47">47</xref>]. All benchmarking datasets and reference databases with increasing levels of unknownness are available from the authors upon request. The contigs in the first benchmark are based on Bacterial RefSeq [<xref ref-type="bibr" rid="CR35">35</xref>] and the databases based on nr [<xref ref-type="bibr" rid="CR33">33</xref>]. The second benchmark is the CAMI benchmark [<xref ref-type="bibr" rid="CR22">22</xref>], and the third is from Stewart et al. [<xref ref-type="bibr" rid="CR7">7</xref>].</p>
  </notes>
  <notes>
    <title>Ethics approval and consent to participate</title>
    <p id="Par57">Not applicable.</p>
  </notes>
  <notes notes-type="COI-statement">
    <title>Competing interests</title>
    <p id="Par58">The authors declare that they have no competing interests.</p>
  </notes>
  <ref-list id="Bib1">
    <title>References</title>
    <ref id="CR1">
      <label>1.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Dutilh</surname>
            <given-names>BE</given-names>
          </name>
        </person-group>
        <article-title>Metagenomic ventures into outer sequence space</article-title>
        <source>Bacteriophage.</source>
        <year>2014</year>
        <volume>4</volume>
        <fpage>e979664</fpage>
        <pub-id pub-id-type="doi">10.4161/21597081.2014.979664</pub-id>
        <?supplied-pmid 26458273?>
        <pub-id pub-id-type="pmid">26458273</pub-id>
      </element-citation>
    </ref>
    <ref id="CR2">
      <label>2.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bernard</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Pathmanathan</surname>
            <given-names>JS</given-names>
          </name>
          <name>
            <surname>Lannes</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Lopez</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Bapteste</surname>
            <given-names>E</given-names>
          </name>
        </person-group>
        <article-title>Microbial dark matter investigations: how microbial studies transform biological knowledge and empirically sketch a logic of scientific discovery</article-title>
        <source>Genome Biol Evol</source>
        <year>2018</year>
        <volume>10</volume>
        <fpage>707</fpage>
        <lpage>715</lpage>
        <pub-id pub-id-type="doi">10.1093/gbe/evy031</pub-id>
        <?supplied-pmid 29420719?>
        <pub-id pub-id-type="pmid">29420719</pub-id>
      </element-citation>
    </ref>
    <ref id="CR3">
      <label>3.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Castelle</surname>
            <given-names>CJ</given-names>
          </name>
          <name>
            <surname>Banfield</surname>
            <given-names>JF</given-names>
          </name>
        </person-group>
        <article-title>Major new microbial groups expand diversity and alter our understanding of the tree of life</article-title>
        <source>Cell.</source>
        <year>2018</year>
        <volume>172</volume>
        <fpage>1181</fpage>
        <lpage>1197</lpage>
        <pub-id pub-id-type="doi">10.1016/j.cell.2018.02.016</pub-id>
        <?supplied-pmid 29522741?>
        <pub-id pub-id-type="pmid">29522741</pub-id>
      </element-citation>
    </ref>
    <ref id="CR4">
      <label>4.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Nurk</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Meleshko</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Korobeynikov</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Pevzner</surname>
            <given-names>PA</given-names>
          </name>
        </person-group>
        <article-title>metaSPAdes: a new versatile metagenomic assembler</article-title>
        <source>Genome Res</source>
        <year>2017</year>
        <volume>27</volume>
        <fpage>824</fpage>
        <lpage>834</lpage>
        <pub-id pub-id-type="doi">10.1101/gr.213959.116</pub-id>
        <?supplied-pmid 5411777?>
        <pub-id pub-id-type="pmid">28298430</pub-id>
      </element-citation>
    </ref>
    <ref id="CR5">
      <label>5.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Brown</surname>
            <given-names>CT</given-names>
          </name>
          <name>
            <surname>Hug</surname>
            <given-names>LA</given-names>
          </name>
          <name>
            <surname>Thomas</surname>
            <given-names>BC</given-names>
          </name>
          <name>
            <surname>Sharon</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Castelle</surname>
            <given-names>CJ</given-names>
          </name>
          <name>
            <surname>Singh</surname>
            <given-names>A</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Unusual biology across a group comprising more than 15% of domain bacteria</article-title>
        <source>Nature.</source>
        <year>2015</year>
        <volume>523</volume>
        <fpage>208</fpage>
        <lpage>211</lpage>
        <pub-id pub-id-type="doi">10.1038/nature14486</pub-id>
        <?supplied-pmid 26083755?>
        <pub-id pub-id-type="pmid">26083755</pub-id>
      </element-citation>
    </ref>
    <ref id="CR6">
      <label>6.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Parks</surname>
            <given-names>DH</given-names>
          </name>
          <name>
            <surname>Rinke</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Chuvochina</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Chaumeil</surname>
            <given-names>P-A</given-names>
          </name>
          <name>
            <surname>Woodcroft</surname>
            <given-names>BJ</given-names>
          </name>
          <name>
            <surname>Evans</surname>
            <given-names>PN</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Recovery of nearly 8,000 metagenome-assembled genomes substantially expands the tree of life</article-title>
        <source>Nat Microbiol</source>
        <year>2017</year>
        <volume>31</volume>
        <fpage>217</fpage>
        <lpage>1542</lpage>
      </element-citation>
    </ref>
    <ref id="CR7">
      <label>7.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Stewart</surname>
            <given-names>RD</given-names>
          </name>
          <name>
            <surname>Auffret</surname>
            <given-names>MD</given-names>
          </name>
          <name>
            <surname>Warr</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Wiser</surname>
            <given-names>AH</given-names>
          </name>
          <name>
            <surname>Press</surname>
            <given-names>MO</given-names>
          </name>
          <name>
            <surname>Langford</surname>
            <given-names>KW</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Assembly of 913 microbial genomes from metagenomic sequencing of the cow rumen</article-title>
        <source>Nat Commun</source>
        <year>2018</year>
        <volume>9</volume>
        <fpage>870</fpage>
        <pub-id pub-id-type="doi">10.1038/s41467-018-03317-6</pub-id>
        <?supplied-pmid 29491419?>
        <pub-id pub-id-type="pmid">29491419</pub-id>
      </element-citation>
    </ref>
    <ref id="CR8">
      <label>8.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Anantharaman</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Brown</surname>
            <given-names>CT</given-names>
          </name>
          <name>
            <surname>Hug</surname>
            <given-names>LA</given-names>
          </name>
          <name>
            <surname>Sharon</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Castelle</surname>
            <given-names>CJ</given-names>
          </name>
          <name>
            <surname>Probst</surname>
            <given-names>AJ</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Thousands of microbial genomes shed light on interconnected biogeochemical processes in an aquifer system</article-title>
        <source>Nat Commun</source>
        <year>2016</year>
        <volume>7</volume>
        <fpage>13219</fpage>
        <pub-id pub-id-type="doi">10.1038/ncomms13219</pub-id>
        <?supplied-pmid 27774985?>
        <pub-id pub-id-type="pmid">27774985</pub-id>
      </element-citation>
    </ref>
    <ref id="CR9">
      <label>9.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Handelsman</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>Metagenomics: application of genomics to uncultured microorganisms</article-title>
        <source>Microbiol Mol Biol Rev</source>
        <year>2004</year>
        <volume>68</volume>
        <fpage>669</fpage>
        <lpage>685</lpage>
        <pub-id pub-id-type="doi">10.1128/MMBR.68.4.669-685.2004</pub-id>
        <?supplied-pmid 15590779?>
        <pub-id pub-id-type="pmid">15590779</pub-id>
      </element-citation>
    </ref>
    <ref id="CR10">
      <label>10.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Breitwieser</surname>
            <given-names>FP</given-names>
          </name>
          <name>
            <surname>Lu</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Salzberg</surname>
            <given-names>SL</given-names>
          </name>
        </person-group>
        <article-title>A review of methods and databases for metagenomic classification and assembly</article-title>
        <source>Brief Bioinformatics</source>
        <year>2017</year>
        <volume>3</volume>
        <fpage>31</fpage>
      </element-citation>
    </ref>
    <ref id="CR11">
      <label>11.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wood</surname>
            <given-names>DE</given-names>
          </name>
          <name>
            <surname>Salzberg</surname>
            <given-names>SL</given-names>
          </name>
        </person-group>
        <article-title>Kraken: ultrafast metagenomic sequence classification using exact alignments</article-title>
        <source>Genome Biol</source>
        <year>2014</year>
        <volume>15</volume>
        <fpage>R46</fpage>
        <pub-id pub-id-type="doi">10.1186/gb-2014-15-3-r46</pub-id>
        <?supplied-pmid 4053813?>
        <pub-id pub-id-type="pmid">24580807</pub-id>
      </element-citation>
    </ref>
    <ref id="CR12">
      <label>12.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ounit</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Wanamaker</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Close</surname>
            <given-names>TJ</given-names>
          </name>
          <name>
            <surname>Lonardi</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>CLARK: fast and accurate classification of metagenomic and genomic sequences using discriminative k-mers</article-title>
        <source>BMC Genomics</source>
        <year>2015</year>
        <volume>16</volume>
        <fpage>236</fpage>
        <pub-id pub-id-type="doi">10.1186/s12864-015-1419-2</pub-id>
        <?supplied-pmid 25879410?>
        <pub-id pub-id-type="pmid">25879410</pub-id>
      </element-citation>
    </ref>
    <ref id="CR13">
      <label>13.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Menzel</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Ng</surname>
            <given-names>KL</given-names>
          </name>
          <name>
            <surname>Krogh</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>Fast and sensitive taxonomic classification for metagenomics with Kaiju</article-title>
        <source>Nat Commun</source>
        <year>2016</year>
        <volume>7</volume>
        <fpage>11257</fpage>
        <pub-id pub-id-type="doi">10.1038/ncomms11257</pub-id>
        <?supplied-pmid 27071849?>
        <pub-id pub-id-type="pmid">27071849</pub-id>
      </element-citation>
    </ref>
    <ref id="CR14">
      <label>14.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Silva</surname>
            <given-names>GGZ</given-names>
          </name>
          <name>
            <surname>Cuevas</surname>
            <given-names>DA</given-names>
          </name>
          <name>
            <surname>Dutilh</surname>
            <given-names>BE</given-names>
          </name>
          <name>
            <surname>Edwards</surname>
            <given-names>RA</given-names>
          </name>
        </person-group>
        <article-title>FOCUS: an alignment-free model to identify organisms in metagenomes using non-negative least squares</article-title>
        <source>PeerJ.</source>
        <year>2014</year>
        <volume>2</volume>
        <fpage>e425</fpage>
        <pub-id pub-id-type="doi">10.7717/peerj.425</pub-id>
        <?supplied-pmid 24949242?>
        <pub-id pub-id-type="pmid">24949242</pub-id>
      </element-citation>
    </ref>
    <ref id="CR15">
      <label>15.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Huson</surname>
            <given-names>DH</given-names>
          </name>
          <name>
            <surname>Beier</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Flade</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Górska</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>El-Hadidi</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Mitra</surname>
            <given-names>S</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>MEGAN community edition - interactive exploration and analysis of large-scale microbiome sequencing data</article-title>
        <source>PLoS Comput Biol</source>
        <year>2016</year>
        <volume>12</volume>
        <fpage>e1004957</fpage>
        <pub-id pub-id-type="doi">10.1371/journal.pcbi.1004957</pub-id>
        <?supplied-pmid 4915700?>
        <pub-id pub-id-type="pmid">27327495</pub-id>
      </element-citation>
    </ref>
    <ref id="CR16">
      <label>16.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Roux</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Tournayre</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Mahul</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Debroas</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Enault</surname>
            <given-names>F</given-names>
          </name>
        </person-group>
        <article-title>Metavir 2: new tools for viral metagenome comparison and assembled virome analysis</article-title>
        <source>BMC Bioinformatics</source>
        <year>2014</year>
        <volume>15</volume>
        <fpage>76</fpage>
        <pub-id pub-id-type="doi">10.1186/1471-2105-15-76</pub-id>
        <?supplied-pmid 24646187?>
        <pub-id pub-id-type="pmid">24646187</pub-id>
      </element-citation>
    </ref>
    <ref id="CR17">
      <label>17.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Huson</surname>
            <given-names>DH</given-names>
          </name>
          <name>
            <surname>Albrecht</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Bağcı</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Bessarab</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Górska</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Jolic</surname>
            <given-names>D</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>MEGAN-LR: new algorithms allow accurate binning and easy interactive exploration of metagenomic long reads and contigs</article-title>
        <source>Biol Direct</source>
        <year>2018</year>
        <volume>13</volume>
        <fpage>6</fpage>
        <pub-id pub-id-type="doi">10.1186/s13062-018-0208-7</pub-id>
        <?supplied-pmid 5910613?>
        <pub-id pub-id-type="pmid">29678199</pub-id>
      </element-citation>
    </ref>
    <ref id="CR18">
      <label>18.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kiełbasa</surname>
            <given-names>SM</given-names>
          </name>
          <name>
            <surname>Wan</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Sato</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Horton</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Frith</surname>
            <given-names>MC</given-names>
          </name>
        </person-group>
        <article-title>Adaptive seeds tame genomic sequence comparison</article-title>
        <source>Genome Res</source>
        <year>2011</year>
        <volume>21</volume>
        <fpage>487</fpage>
        <lpage>493</lpage>
        <pub-id pub-id-type="doi">10.1101/gr.113985.110</pub-id>
        <?supplied-pmid 21209072?>
        <pub-id pub-id-type="pmid">21209072</pub-id>
      </element-citation>
    </ref>
    <ref id="CR19">
      <label>19.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Dutilh</surname>
            <given-names>BE</given-names>
          </name>
          <name>
            <surname>van Noort</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>van der Heijden</surname>
            <given-names>RTJM</given-names>
          </name>
          <name>
            <surname>Boekhout</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Snel</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Huynen</surname>
            <given-names>MA</given-names>
          </name>
        </person-group>
        <article-title>Assessment of phylogenomic and orthology approaches for phylogenetic inference</article-title>
        <source>Bioinformatics.</source>
        <year>2007</year>
        <volume>23</volume>
        <fpage>815</fpage>
        <lpage>824</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btm015</pub-id>
        <?supplied-pmid 17237036?>
        <pub-id pub-id-type="pmid">17237036</pub-id>
      </element-citation>
    </ref>
    <ref id="CR20">
      <label>20.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Parks</surname>
            <given-names>DH</given-names>
          </name>
          <name>
            <surname>Imelfort</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Skennerton</surname>
            <given-names>CT</given-names>
          </name>
          <name>
            <surname>Hugenholtz</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Tyson</surname>
            <given-names>GW</given-names>
          </name>
        </person-group>
        <article-title>CheckM: assessing the quality of microbial genomes recovered from isolates, single cells, and metagenomes</article-title>
        <source>Genome Res</source>
        <year>2015</year>
        <volume>25</volume>
        <fpage>1043</fpage>
        <lpage>1055</lpage>
        <pub-id pub-id-type="doi">10.1101/gr.186072.114</pub-id>
        <?supplied-pmid 25977477?>
        <pub-id pub-id-type="pmid">25977477</pub-id>
      </element-citation>
    </ref>
    <ref id="CR21">
      <label>21.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Guy</surname>
            <given-names>L</given-names>
          </name>
        </person-group>
        <article-title>phyloSkeleton: taxon selection, data retrieval and marker identification for phylogenomics</article-title>
        <source>Bioinformatics.</source>
        <year>2017</year>
        <volume>33</volume>
        <fpage>1230</fpage>
        <lpage>1232</lpage>
        <?supplied-pmid 28057682?>
        <pub-id pub-id-type="pmid">28057682</pub-id>
      </element-citation>
    </ref>
    <ref id="CR22">
      <label>22.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Sczyrba</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Hofmann</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Belmann</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Koslicki</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Janssen</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Dröge</surname>
            <given-names>J</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Critical assessment of metagenome interpretation-a benchmark of metagenomics software</article-title>
        <source>Nat Methods</source>
        <year>2017</year>
        <volume>14</volume>
        <fpage>1063</fpage>
        <lpage>1071</lpage>
        <pub-id pub-id-type="doi">10.1038/nmeth.4458</pub-id>
        <?supplied-pmid 5903868?>
        <pub-id pub-id-type="pmid">28967888</pub-id>
      </element-citation>
    </ref>
    <ref id="CR23">
      <label>23.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Gregor</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Dröge</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Schirmer</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Quince</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>McHardy</surname>
            <given-names>AC</given-names>
          </name>
        </person-group>
        <article-title>PhyloPythiaS+: a self-training method for the rapid reconstruction of low-ranking taxonomic bins from metagenomes</article-title>
        <source>PeerJ PeerJ Inc</source>
        <year>2016</year>
        <volume>4</volume>
        <fpage>e1603</fpage>
        <pub-id pub-id-type="doi">10.7717/peerj.1603</pub-id>
      </element-citation>
    </ref>
    <ref id="CR24">
      <label>24.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Dröge</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Gregor</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>McHardy</surname>
            <given-names>AC</given-names>
          </name>
        </person-group>
        <article-title>Taxator-tk: precise taxonomic assignment of metagenomes by fast approximation of evolutionary neighborhoods</article-title>
        <source>Bioinformatics.</source>
        <year>2015</year>
        <volume>31</volume>
        <fpage>817</fpage>
        <lpage>824</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btu745</pub-id>
        <?supplied-pmid 25388150?>
        <pub-id pub-id-type="pmid">25388150</pub-id>
      </element-citation>
    </ref>
    <ref id="CR25">
      <label>25.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Buchfink</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Xie</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Huson</surname>
            <given-names>DH</given-names>
          </name>
        </person-group>
        <article-title>Fast and sensitive protein alignment using DIAMOND</article-title>
        <source>Nat Methods</source>
        <year>2015</year>
        <volume>12</volume>
        <fpage>59</fpage>
        <lpage>60</lpage>
        <pub-id pub-id-type="doi">10.1038/nmeth.3176</pub-id>
        <?supplied-pmid 25402007?>
        <pub-id pub-id-type="pmid">25402007</pub-id>
      </element-citation>
    </ref>
    <ref id="CR26">
      <label>26.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Xia</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Shi</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Atoni</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Zhao</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Yuan</surname>
            <given-names>Z</given-names>
          </name>
        </person-group>
        <article-title>Comparative metagenomic profiling of viromes associated with four common mosquito species in China</article-title>
        <source>Virol Sin</source>
        <year>2018</year>
        <volume>33</volume>
        <fpage>59</fpage>
        <lpage>66</lpage>
        <pub-id pub-id-type="doi">10.1007/s12250-018-0015-4</pub-id>
        <?supplied-pmid 29500689?>
        <pub-id pub-id-type="pmid">29500689</pub-id>
      </element-citation>
    </ref>
    <ref id="CR27">
      <label>27.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Young</surname>
            <given-names>JM</given-names>
          </name>
          <name>
            <surname>Skvortsov</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Arkhipova</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Allen</surname>
            <given-names>CCR</given-names>
          </name>
        </person-group>
        <article-title>Draft genome sequence of the predatory marine bacterium Halobacteriovorax sp. strain JY17</article-title>
        <source>Genome Announc</source>
        <year>2018</year>
        <volume>6</volume>
        <fpage>593</fpage>
        <pub-id pub-id-type="doi">10.1128/genomeA.01416-17</pub-id>
      </element-citation>
    </ref>
    <ref id="CR28">
      <label>28.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kang</surname>
            <given-names>DD</given-names>
          </name>
          <name>
            <surname>Froula</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Egan</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>Z</given-names>
          </name>
        </person-group>
        <article-title>MetaBAT, an efficient tool for accurately reconstructing single genomes from complex microbial communities</article-title>
        <source>PeerJ PeerJ Inc</source>
        <year>2015</year>
        <volume>3</volume>
        <fpage>e1165</fpage>
        <pub-id pub-id-type="doi">10.7717/peerj.1165</pub-id>
      </element-citation>
    </ref>
    <ref id="CR29">
      <label>29.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Alneberg</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Bjarnason</surname>
            <given-names>BS</given-names>
          </name>
          <name>
            <surname>de Bruijn</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Schirmer</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Quick</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Ijaz</surname>
            <given-names>UZ</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Binning metagenomic contigs by coverage and composition</article-title>
        <source>Nat Methods</source>
        <year>2014</year>
        <volume>11</volume>
        <fpage>1144</fpage>
        <lpage>1146</lpage>
        <pub-id pub-id-type="doi">10.1038/nmeth.3103</pub-id>
        <pub-id pub-id-type="pmid">25218180</pub-id>
      </element-citation>
    </ref>
    <ref id="CR30">
      <label>30.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bao</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Lan</surname>
            <given-names>L</given-names>
          </name>
        </person-group>
        <article-title>HALC: high throughput algorithm for long read error correction</article-title>
        <source>BMC Bioinformatics.</source>
        <year>2017</year>
        <volume>18</volume>
        <fpage>204</fpage>
        <pub-id pub-id-type="doi">10.1186/s12859-017-1610-3</pub-id>
        <?supplied-pmid 28381259?>
        <pub-id pub-id-type="pmid">28381259</pub-id>
      </element-citation>
    </ref>
    <ref id="CR31">
      <label>31.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Koren</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Walenz</surname>
            <given-names>BP</given-names>
          </name>
          <name>
            <surname>Berlin</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Miller</surname>
            <given-names>JR</given-names>
          </name>
          <name>
            <surname>Bergman</surname>
            <given-names>NH</given-names>
          </name>
          <name>
            <surname>Phillippy</surname>
            <given-names>AM</given-names>
          </name>
        </person-group>
        <article-title>Canu: scalable and accurate long-read assembly via adaptive k-mer weighting and repeat separation</article-title>
        <source>Genome Res</source>
        <year>2017</year>
        <volume>27</volume>
        <fpage>722</fpage>
        <lpage>736</lpage>
        <pub-id pub-id-type="doi">10.1101/gr.215087.116</pub-id>
        <?supplied-pmid 28298431?>
        <pub-id pub-id-type="pmid">28298431</pub-id>
      </element-citation>
    </ref>
    <ref id="CR32">
      <label>32.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hyatt</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>G-L</given-names>
          </name>
          <name>
            <surname>Locascio</surname>
            <given-names>PF</given-names>
          </name>
          <name>
            <surname>Land</surname>
            <given-names>ML</given-names>
          </name>
          <name>
            <surname>Larimer</surname>
            <given-names>FW</given-names>
          </name>
          <name>
            <surname>Hauser</surname>
            <given-names>LJ</given-names>
          </name>
        </person-group>
        <article-title>Prodigal: prokaryotic gene recognition and translation initiation site identification</article-title>
        <source>BMC Bioinformatics.</source>
        <year>2010</year>
        <volume>11</volume>
        <fpage>119</fpage>
        <pub-id pub-id-type="doi">10.1186/1471-2105-11-119</pub-id>
        <?supplied-pmid 20211023?>
        <pub-id pub-id-type="pmid">20211023</pub-id>
      </element-citation>
    </ref>
    <ref id="CR33">
      <label>33.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Sayers</surname>
            <given-names>EW</given-names>
          </name>
          <name>
            <surname>Agarwala</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Bolton</surname>
            <given-names>EE</given-names>
          </name>
          <name>
            <surname>Brister</surname>
            <given-names>JR</given-names>
          </name>
          <name>
            <surname>Canese</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Clark</surname>
            <given-names>K</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Database resources of the National Center for Biotechnology Information</article-title>
        <source>Nucleic Acids Res</source>
        <year>2018</year>
        <volume>266</volume>
        <fpage>141</fpage>
      </element-citation>
    </ref>
    <ref id="CR34">
      <label>34.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Federhen</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>The NCBI taxonomy database</article-title>
        <source>Nucleic Acids Res</source>
        <year>2012</year>
        <volume>40</volume>
        <fpage>D136</fpage>
        <lpage>D143</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/gkr1178</pub-id>
        <pub-id pub-id-type="pmid">22139910</pub-id>
      </element-citation>
    </ref>
    <ref id="CR35">
      <label>35.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>O'Leary</surname>
            <given-names>NA</given-names>
          </name>
          <name>
            <surname>Wright</surname>
            <given-names>MW</given-names>
          </name>
          <name>
            <surname>Brister</surname>
            <given-names>JR</given-names>
          </name>
          <name>
            <surname>Ciufo</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Haddad</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>McVeigh</surname>
            <given-names>R</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Reference sequence (RefSeq) database at NCBI: current status, taxonomic expansion, and functional annotation</article-title>
        <source>Nucleic Acids Res</source>
        <year>2016</year>
        <volume>44</volume>
        <fpage>D733</fpage>
        <lpage>D745</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/gkv1189</pub-id>
        <pub-id pub-id-type="pmid">26553804</pub-id>
      </element-citation>
    </ref>
    <ref id="CR36">
      <label>36.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Leinonen</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Sugawara</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Shumway</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>International nucleotide sequence database collaboration. The sequence read archive</article-title>
        <source>Nucleic Acids Res</source>
        <year>2011</year>
        <volume>39</volume>
        <fpage>D19</fpage>
        <lpage>D21</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/gkq1019</pub-id>
        <?supplied-pmid 21062823?>
        <pub-id pub-id-type="pmid">21062823</pub-id>
      </element-citation>
    </ref>
    <ref id="CR37">
      <label>37.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Mokili</surname>
            <given-names>JL</given-names>
          </name>
          <name>
            <surname>Rohwer</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Dutilh</surname>
            <given-names>BE</given-names>
          </name>
        </person-group>
        <article-title>Metagenomics and future perspectives in virus discovery</article-title>
        <source>Curr Opin Virol</source>
        <year>2012</year>
        <volume>2</volume>
        <fpage>63</fpage>
        <lpage>77</lpage>
        <pub-id pub-id-type="doi">10.1016/j.coviro.2011.12.004</pub-id>
        <?supplied-pmid 22440968?>
        <pub-id pub-id-type="pmid">22440968</pub-id>
      </element-citation>
    </ref>
    <ref id="CR38">
      <label>38.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>King</surname>
            <given-names>AMQ</given-names>
          </name>
          <name>
            <surname>Lefkowitz</surname>
            <given-names>EJ</given-names>
          </name>
          <name>
            <surname>Mushegian</surname>
            <given-names>AR</given-names>
          </name>
          <name>
            <surname>Adams</surname>
            <given-names>MJ</given-names>
          </name>
          <name>
            <surname>Dutilh</surname>
            <given-names>BE</given-names>
          </name>
          <name>
            <surname>Gorbalenya</surname>
            <given-names>AE</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Changes to taxonomy and the international code of virus classification and nomenclature ratified by the International Committee on Taxonomy of Viruses (2018)</article-title>
        <source>Arch Virol Springer Vienna</source>
        <year>2018</year>
        <volume>163</volume>
        <fpage>2601</fpage>
        <lpage>2631</lpage>
        <pub-id pub-id-type="doi">10.1007/s00705-018-3847-1</pub-id>
      </element-citation>
    </ref>
    <ref id="CR39">
      <label>39.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Parks</surname>
            <given-names>DH</given-names>
          </name>
          <name>
            <surname>Chuvochina</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Waite</surname>
            <given-names>DW</given-names>
          </name>
          <name>
            <surname>Rinke</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Skarshewski</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Chaumeil</surname>
            <given-names>P-A</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>A standardized bacterial taxonomy based on genome phylogeny substantially revises the tree of life</article-title>
        <source>Nature Biotechnol</source>
        <year>2018</year>
        <volume>36</volume>
        <fpage>10</fpage>
        <pub-id pub-id-type="doi">10.1038/nbt.4229</pub-id>
        <pub-id pub-id-type="pmid">29319692</pub-id>
      </element-citation>
    </ref>
    <ref id="CR40">
      <label>40.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wattam</surname>
            <given-names>AR</given-names>
          </name>
          <name>
            <surname>Davis</surname>
            <given-names>JJ</given-names>
          </name>
          <name>
            <surname>Assaf</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Boisvert</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Brettin</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Bun</surname>
            <given-names>C</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Improvements to PATRIC, the all-bacterial bioinformatics database and analysis resource center</article-title>
        <source>Nucleic Acids Res</source>
        <year>2017</year>
        <volume>45</volume>
        <fpage>D535</fpage>
        <lpage>D542</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/gkw1017</pub-id>
        <?supplied-pmid 27899627?>
        <pub-id pub-id-type="pmid">27899627</pub-id>
      </element-citation>
    </ref>
    <ref id="CR41">
      <label>41.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Sievers</surname>
            <given-names>Fabian</given-names>
          </name>
          <name>
            <surname>Wilm</surname>
            <given-names>Andreas</given-names>
          </name>
          <name>
            <surname>Dineen</surname>
            <given-names>David</given-names>
          </name>
          <name>
            <surname>Gibson</surname>
            <given-names>Toby J</given-names>
          </name>
          <name>
            <surname>Karplus</surname>
            <given-names>Kevin</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>Weizhong</given-names>
          </name>
          <name>
            <surname>Lopez</surname>
            <given-names>Rodrigo</given-names>
          </name>
          <name>
            <surname>McWilliam</surname>
            <given-names>Hamish</given-names>
          </name>
          <name>
            <surname>Remmert</surname>
            <given-names>Michael</given-names>
          </name>
          <name>
            <surname>Söding</surname>
            <given-names>Johannes</given-names>
          </name>
          <name>
            <surname>Thompson</surname>
            <given-names>Julie D</given-names>
          </name>
          <name>
            <surname>Higgins</surname>
            <given-names>Desmond G</given-names>
          </name>
        </person-group>
        <article-title>Fast, scalable generation of high‐quality protein multiple sequence alignments using Clustal Omega</article-title>
        <source>Molecular Systems Biology</source>
        <year>2011</year>
        <volume>7</volume>
        <issue>1</issue>
        <fpage>539</fpage>
        <pub-id pub-id-type="doi">10.1038/msb.2011.75</pub-id>
        <?supplied-pmid 21988835?>
        <pub-id pub-id-type="pmid">21988835</pub-id>
      </element-citation>
    </ref>
    <ref id="CR42">
      <label>42.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Nguyen</surname>
            <given-names>L-T</given-names>
          </name>
          <name>
            <surname>Schmidt</surname>
            <given-names>HA</given-names>
          </name>
          <name>
            <surname>Haeseler</surname>
            <given-names>v A</given-names>
          </name>
          <name>
            <surname>Minh</surname>
            <given-names>BQ</given-names>
          </name>
        </person-group>
        <article-title>IQ-TREE: a fast and effective stochastic algorithm for estimating maximum-likelihood phylogenies</article-title>
        <source>Mol Biol Evol</source>
        <year>2015</year>
        <volume>32</volume>
        <fpage>268</fpage>
        <lpage>274</lpage>
        <pub-id pub-id-type="doi">10.1093/molbev/msu300</pub-id>
        <pub-id pub-id-type="pmid">25371430</pub-id>
      </element-citation>
    </ref>
    <ref id="CR43">
      <label>43.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kalyaanamoorthy</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Minh</surname>
            <given-names>BQ</given-names>
          </name>
          <name>
            <surname>Wong</surname>
            <given-names>TKF</given-names>
          </name>
          <name>
            <surname>Haeseler</surname>
            <given-names>v A</given-names>
          </name>
          <name>
            <surname>Jermiin</surname>
            <given-names>LS</given-names>
          </name>
        </person-group>
        <article-title>ModelFinder: fast model selection for accurate phylogenetic estimates</article-title>
        <source>Nat Methods</source>
        <year>2017</year>
        <volume>14</volume>
        <fpage>587</fpage>
        <lpage>589</lpage>
        <pub-id pub-id-type="doi">10.1038/nmeth.4285</pub-id>
        <?supplied-pmid 28481363?>
        <pub-id pub-id-type="pmid">28481363</pub-id>
      </element-citation>
    </ref>
    <ref id="CR44">
      <label>44.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hoang</surname>
            <given-names>DT</given-names>
          </name>
          <name>
            <surname>Chernomor</surname>
            <given-names>O</given-names>
          </name>
          <name>
            <surname>Haeseler</surname>
            <given-names>v A</given-names>
          </name>
          <name>
            <surname>Minh</surname>
            <given-names>BQ</given-names>
          </name>
          <name>
            <surname>Vinh</surname>
            <given-names>LS</given-names>
          </name>
        </person-group>
        <article-title>UFBoot2: improving the ultrafast bootstrap approximation</article-title>
        <source>Mol Biol Evol</source>
        <year>2018</year>
        <volume>35</volume>
        <fpage>518</fpage>
        <lpage>522</lpage>
        <pub-id pub-id-type="doi">10.1093/molbev/msx281</pub-id>
        <?supplied-pmid 29077904?>
        <pub-id pub-id-type="pmid">29077904</pub-id>
      </element-citation>
    </ref>
    <ref id="CR45">
      <label>45.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Letunic</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Bork</surname>
            <given-names>P</given-names>
          </name>
        </person-group>
        <article-title>Interactive tree of life (iTOL) v3: an online tool for the display and annotation of phylogenetic and other trees</article-title>
        <source>Nucleic Acids Res</source>
        <year>2016</year>
        <volume>44</volume>
        <fpage>W242</fpage>
        <lpage>W245</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/gkw290</pub-id>
        <?supplied-pmid 27095192?>
        <pub-id pub-id-type="pmid">27095192</pub-id>
      </element-citation>
    </ref>
    <ref id="CR46">
      <label>46.</label>
      <mixed-citation publication-type="other">von Meijenfeldt FAB, Arkhipova K, Cambuy DD, Coutinho FH, Dutilh BE. CAT/BAT: tool for taxonomic classification of contigs and metagenome-assembled genomes (MAGs): GitHub. <ext-link ext-link-type="uri" xlink:href="https://github.com/dutilh/CAT">https://github.com/dutilh/CAT</ext-link>; 2019.</mixed-citation>
    </ref>
    <ref id="CR47">
      <label>47.</label>
      <mixed-citation publication-type="other">von Meijenfeldt FAB, Arkhipova K, Cambuy DD, Coutinho FH, Dutilh BE. CAT/BAT: tool for taxonomic classification of contigs and metagenome-assembled genomes (MAGs) (version v5.0.1): Zenodo; 2019. 10.5281/zenodo.3403695.</mixed-citation>
    </ref>
  </ref-list>
</back>
<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName A++V2.4.dtd?>
<?SourceDTD.Version 2.4?>
<?ConverterInfo.XSLTName springer2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Genome Biol</journal-id>
    <journal-id journal-id-type="iso-abbrev">Genome Biol</journal-id>
    <journal-title-group>
      <journal-title>Genome Biology</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1474-7596</issn>
    <issn pub-type="epub">1474-760X</issn>
    <publisher>
      <publisher-name>BioMed Central</publisher-name>
      <publisher-loc>London</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">6805573</article-id>
    <article-id pub-id-type="publisher-id">1817</article-id>
    <article-id pub-id-type="doi">10.1186/s13059-019-1817-x</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Method</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Robust taxonomic classification of uncharted microbial sequences and bins with CAT and BAT</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author" equal-contrib="yes">
        <name>
          <surname>von Meijenfeldt</surname>
          <given-names>F. A. Bastiaan</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author" equal-contrib="yes">
        <name>
          <surname>Arkhipova</surname>
          <given-names>Ksenia</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Cambuy</surname>
          <given-names>Diego D.</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Coutinho</surname>
          <given-names>Felipe H.</given-names>
        </name>
        <xref ref-type="aff" rid="Aff2">2</xref>
        <xref ref-type="aff" rid="Aff3">3</xref>
        <xref ref-type="aff" rid="Aff4">4</xref>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <name>
          <surname>Dutilh</surname>
          <given-names>Bas E.</given-names>
        </name>
        <address>
          <phone>+31 30 253 4212</phone>
          <email>bedutilh@gmail.com</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <aff id="Aff1"><label>1</label><institution-wrap><institution-id institution-id-type="ISNI">0000000120346234</institution-id><institution-id institution-id-type="GRID">grid.5477.1</institution-id><institution>Theoretical Biology and Bioinformatics, Science for Life, </institution><institution>Utrecht University, </institution></institution-wrap>Utrecht, The Netherlands </aff>
      <aff id="Aff2"><label>2</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0004 0444 9382</institution-id><institution-id institution-id-type="GRID">grid.10417.33</institution-id><institution>Centre for Molecular and Biomolecular Informatics, </institution><institution>Radboud University Medical Centre, </institution></institution-wrap>Nijmegen, The Netherlands </aff>
      <aff id="Aff3"><label>3</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0001 2294 473X</institution-id><institution-id institution-id-type="GRID">grid.8536.8</institution-id><institution>Instituto de Biologia, Universidade Federal do Rio de Janeiro, </institution></institution-wrap>Rio de Janeiro, RJ Brazil </aff>
      <aff id="Aff4"><label>4</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0001 0586 4893</institution-id><institution-id institution-id-type="GRID">grid.26811.3c</institution-id><institution>Present Address: Evolutionary Genomics Group, Departamento de Produccíon Vegetal y Microbiología, </institution><institution>Universidad Miguel Hernández, </institution></institution-wrap>Campus San Juan, San Juan, 03550 Alicante, Spain </aff>
    </contrib-group>
    <pub-date pub-type="epub">
      <day>22</day>
      <month>10</month>
      <year>2019</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>22</day>
      <month>10</month>
      <year>2019</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2019</year>
    </pub-date>
    <volume>20</volume>
    <elocation-id>217</elocation-id>
    <history>
      <date date-type="received">
        <day>22</day>
        <month>3</month>
        <year>2019</year>
      </date>
      <date date-type="accepted">
        <day>10</day>
        <month>9</month>
        <year>2019</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s). 2019</copyright-statement>
      <license license-type="OpenAccess">
        <license-p><bold>Open Access</bold>This article is distributed under the terms of the Creative Commons Attribution 4.0 International License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted use, distribution, and reproduction in any medium, provided you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons license, and indicate if changes were made. The Creative Commons Public Domain Dedication waiver (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/publicdomain/zero/1.0/">http://creativecommons.org/publicdomain/zero/1.0/</ext-link>) applies to the data made available in this article, unless otherwise stated.</license-p>
      </license>
    </permissions>
    <abstract id="Abs1">
      <p id="Par1">Current-day metagenomics analyses increasingly involve de novo taxonomic classification of long DNA sequences and metagenome-assembled genomes. Here, we show that the conventional best-hit approach often leads to classifications that are too specific, especially when the sequences represent novel deep lineages. We present a classification method that integrates multiple signals to classify sequences (Contig Annotation Tool, CAT) and metagenome-assembled genomes (Bin Annotation Tool, BAT). Classifications are automatically made at low taxonomic ranks if closely related organisms are present in the reference database and at higher ranks otherwise. The result is a high classification precision even for sequences from considerably unknown organisms.</p>
    </abstract>
    <funding-group>
      <award-group>
        <funding-source>
          <institution>Nederlandse Organisatie voor Wetenschappelijk Onderzoek (NL)</institution>
        </funding-source>
        <award-id>864.14.004</award-id>
        <principal-award-recipient>
          <name>
            <surname>Dutilh</surname>
            <given-names>Bas E.</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/501100003593</institution-id>
            <institution>Conselho Nacional de Desenvolvimento Científico e Tecnológico</institution>
          </institution-wrap>
        </funding-source>
        <award-id>Science Without Borders program</award-id>
        <award-id>Science Without Borders program</award-id>
        <principal-award-recipient>
          <name>
            <surname>Cambuy</surname>
            <given-names>Diego D.</given-names>
          </name>
          <name>
            <surname>Coutinho</surname>
            <given-names>Felipe H.</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
    </funding-group>
    <custom-meta-group>
      <custom-meta>
        <meta-name>issue-copyright-statement</meta-name>
        <meta-value>© The Author(s) 2019</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec id="Sec1">
    <title>Background</title>
    <p id="Par2">Metagenomics, the direct sequencing of DNA from microbial communities in natural environments, has revolutionized the field of microbiology by unearthing a vast microbial sequence space in our biosphere, much of which remains unexplored [<xref ref-type="bibr" rid="CR1">1</xref>–<xref ref-type="bibr" rid="CR3">3</xref>]. With increases in DNA sequencing throughput, metagenomics has moved from analysis of individual reads to sequence assembly, where increases in sequencing depth have enabled de novo assembly of high-quality contiguous sequences (contigs), sometimes many kilobases in length [<xref ref-type="bibr" rid="CR4">4</xref>]. In addition, current state-of-the-art encompasses binning of these contigs into high-quality draft genomes, or metagenome-assembled genomes (MAGs) [<xref ref-type="bibr" rid="CR5">5</xref>–<xref ref-type="bibr" rid="CR8">8</xref>]. The advance from short reads to contigs and MAGs allows the metagenomics field to answer its classical questions [<xref ref-type="bibr" rid="CR9">9</xref>], “who is there?” and “what are they doing?” in a unified manner: “who is doing what?”, as both function and taxonomy can be confidently linked to the same genomic entity. Because assembly and binning can be done de novo, these questions can be applied to organisms that have never been seen before, and the discovery of entirely novel phyla is common still [<xref ref-type="bibr" rid="CR8">8</xref>].</p>
    <p id="Par3">Several efficient tools for taxonomic classification of short-read sequences have been developed over the years, reflecting the read-based focus of the time. Most tools consider each read as an independent observation, whose taxonomic origin can be estimated by identifying best-hit matches in a reference database, either on read, K-mer, or translated protein level (see [<xref ref-type="bibr" rid="CR10">10</xref>] for an overview). Widely used programs such as Kraken [<xref ref-type="bibr" rid="CR11">11</xref>] (K-mer based), CLARK [<xref ref-type="bibr" rid="CR12">12</xref>] (discriminative K-mer based), and Kaiju [<xref ref-type="bibr" rid="CR13">13</xref>] (protein-based) can process hundreds of thousands of sequencing reads per second. Without compromising accuracy, still faster approaches use mixture modeling of K-mer profiles, as implemented in FOCUS [<xref ref-type="bibr" rid="CR14">14</xref>]. Sometimes a Last Common Ancestor (LCA) algorithm is applied to allow for multiple hits with similar scores as the best hit (e.g., Kraken, MEGAN [<xref ref-type="bibr" rid="CR15">15</xref>]).</p>
    <p id="Par4">Similar approaches are often applied to contigs, with classification often based on the best hit to a reference database. Although fast, the best-hit approach can lead to spurious specificity in classifications, for example when a genomic region is highly conserved or recently acquired via horizontal gene transfer (HGT) from a distantly related organism. As we will show below, the problem is particularly grave when the query contigs are very divergent from the sequences in the database, i.e., they are distantly related to known organisms. Whereas specificity (correctly classified/total classified) can be increased when only classifications at higher taxonomic ranks are considered, this approach is not desirable as taxonomic resolution is unnecessarily lost for query contigs that are closely related to known organisms.</p>
    <p id="Par5">Depending on their length, contigs may contain multiple open reading frames (ORFs), each of which contains a taxonomic signal. Integrating these signals should enable a more robust classification of the entire contig, yet surprisingly few tools exist that integrate distributed signals for contig classification. The viral-specific pipeline MetaVir2 [<xref ref-type="bibr" rid="CR16">16</xref>] assesses the classification of up to five ORFs encoded on a contig. Recently, the MEGAN long-read algorithm was introduced [<xref ref-type="bibr" rid="CR17">17</xref>], which allows users to taxonomically classify long sequences such as those generated by Oxford Nanopore Technologies or Pacific Biosciences sequencers. The algorithm works by partitioning the sequence into intervals based on the location of hits of a LAST [<xref ref-type="bibr" rid="CR18">18</xref>] search.</p>
    <p id="Par6">In contrast, for taxonomic classification of MAGs, it is common to include information from multiple ORFs. Since the classification of complete genomes by using phylogenetic trees of multiple marker genes is well-established [<xref ref-type="bibr" rid="CR19">19</xref>], MAG classification has followed these best practices. Some steps in the process can be automated, including initial placement in a low-resolution backbone tree by CheckM [<xref ref-type="bibr" rid="CR20">20</xref>], specific marker gene identification, and backbone tree taxon selection by phyloSkeleton [<xref ref-type="bibr" rid="CR21">21</xref>], and many tools are available for protein alignment, trimming, tree building, and display. However, interpretation of the resulting phylogeny remains a critical manual step, making this approach for genomic taxonomy a laborious task that does not scale well with the increasing number of MAGs being generated (see, e.g., [<xref ref-type="bibr" rid="CR7">7</xref>]).</p>
    <p id="Par7">Here we present Contig Annotation Tool (CAT) and Bin Annotation Tool (BAT), two taxonomic classifiers whose underlying ORF-based algorithm is specifically designed to provide robust taxonomic classification of long sequences and MAGs. Both tools exploit commonly used tools for ORF calling and homology searches. They require minimal user input and can be applied in an automated manner, yet all aspects are flexible and can be tuned to user preferences.</p>
    <sec id="Sec2">
      <title>Benchmarking classification of sequences from novel taxa</title>
      <p id="Par8">Taxonomic classifiers are often benchmarked by testing them on sequences from novel taxa, i.e., that are not (yet) in the reference database (e.g., as in the CAMI challenge [<xref ref-type="bibr" rid="CR22">22</xref>], and [<xref ref-type="bibr" rid="CR11">11</xref>, <xref ref-type="bibr" rid="CR12">12</xref>, <xref ref-type="bibr" rid="CR14">14</xref>]). Alternatively, unknown query sequences can be simulated by using a “leave-one-out” approach, where the genome that is being queried is removed from the database (e.g., [<xref ref-type="bibr" rid="CR13">13</xref>, <xref ref-type="bibr" rid="CR17">17</xref>]). However, due to taxonomic biases in database composition, other strains from the same species, or other species from the same genus, may still be present. Thus, the leave-one-out approach does not reflect the level of sequence unknownness that is often encountered in real metagenomes, where the query sequences may be only distantly related to the ones in the reference database. A benchmark better suited to address this novelty is a “leave-entire-taxa-out” approach also known as clade exclusion, where all related sequences belonging to a certain taxonomic rank are removed from the database (e.g., [<xref ref-type="bibr" rid="CR11">11</xref>, <xref ref-type="bibr" rid="CR23">23</xref>, <xref ref-type="bibr" rid="CR24">24</xref>]).</p>
      <p id="Par9">Here, we rigorously assess the performance of taxonomic classification tools by developing an extensive database reduction approach at different taxonomic ranks, where novel species, genera, and families are simulated by removing all the sequences of entire taxa from the database. In a second benchmark, we classified the high-complexity CAMI dataset [<xref ref-type="bibr" rid="CR22">22</xref>]. We show that the algorithm of CAT and BAT allows for the correct classification of organisms from known and unknown taxa and outperforms existing methods, especially for sequences that are highly unknown (i.e., with no close relatives in the database). Third, we used BAT in a real-world challenge to classify a large, recently published set of 913 MAGs from the cow rumen [<xref ref-type="bibr" rid="CR7">7</xref>] that represent a wide range of novelty at all taxonomic ranks, and whose published taxonomic classifications involved extensive phylogenetic analyses.</p>
    </sec>
  </sec>
  <sec id="Sec3">
    <title>Results and discussion</title>
    <p id="Par10">To test the performance of our newly developed taxonomic classification tools CAT and BAT, we thoroughly tested them in three independent benchmarks: (1) A clade exclusion experiment with increasing levels of sequence unknownness, (2) the high-complexity gold standard CAMI assembly, and (3) a recently published set of MAGs where the BAT classifications are compared to the published taxonomic classifications.</p>
    <sec id="Sec4">
      <title>Contig classification with CAT</title>
      <sec id="Sec5">
        <title>Benchmark 1: Classification of increasingly unknown sequences</title>
        <p id="Par11">We used CAT (Fig. <xref rid="Fig1" ref-type="fig">1</xref>) to classify ten simulated contig sets in the context of four reference databases with different levels of simulated unknownness, representing query sequences from (A) known strains, (B) novel species, (C) novel genera, and (D) novel families (see the “<xref rid="Sec13" ref-type="sec">Methods</xref>” section). To assess the effect of the two key user parameters, <italic>r</italic> (hits included within <italic>range</italic> of top hits) and <italic>f</italic> (minimum <italic>fraction</italic> classification support), on precision, fraction of classified sequences, sensitivity, and taxonomic rank of classification, we ran CAT with a wide range of possible parameter values against all four reference databases (Fig. <xref rid="Fig2" ref-type="fig">2</xref>). This parameter sweep revealed a trade-off between the classification precision on the one hand and the taxonomic resolution and the fraction of classified sequences on the other hand. This general trend can be understood by considering that classifications at a low taxonomic rank (i.e., close to the species rank, high taxonomic resolution) will inevitably be increasingly imprecise, especially if closely related organisms are absent from the reference database. This might be resolved by classifying sequences at a higher taxonomic rank, but this leads to increased numbers of sequences not being classified or classified at trivially informative taxonomic ranks such as “cellular organisms” or “root.”
<fig id="Fig1"><label>Fig. 1</label><caption><p>Contig and MAG classification with CAT and BAT. <bold>a</bold>, <bold>b</bold> Step 1: ORF prediction with Prodigal. CAT analyses all ORFs on a contig, BAT analyses all ORFs in a MAG. <bold>c</bold> Step 2: predicted ORFs are queries with DIAMOND to the NCBI non-redundant protein database (nr). <bold>d</bold> Step 3: ORFs are individually classified based on the LCA of all hits falling within a certain range of the top hit (parameter <italic>r</italic>), and the top-hit bit-score is assigned to the classification. Bit-scores of hits are depicted within brackets. Hits in gray are not included in final annotation of the ORF. Parameter <italic>f</italic> defines minimal bit-score support (mbs). <bold>e</bold> Step 4: contig or MAG classification is based on a voting approach of all classified ORFs, by summing all bit-scores from ORFs supporting a certain classification. The contig or MAG is classified as the lowest classification reaching mbs. The example illustrates the benefit of including multiple ORFs when classifying contigs or MAGs; a best-hit approach might have selected <italic>Bacteroides vulgatus</italic> or Bacteroidetes if an LCA algorithm was applied as its classification, as this part has the highest score to proteins in the database in a local alignment-based homology search. In the example, only six taxonomic ranks are shown for brevity; in reality, CAT and BAT will interpret the entire taxonomic lineage</p></caption><graphic xlink:href="13059_2019_1817_Fig1_HTML" id="MO1"/></fig>
<fig id="Fig2"><label>Fig. 2</label><caption><p>Classification performance of CAT for different levels of unknownness across a range of parameter settings. Thickness of markers indicates values of the <italic>f</italic> parameter; runs with similar <italic>r</italic> parameter values are connected with black lines. Markers indicate maximum and minimum values out of ten benchmarking datasets, bars cross at the means. Color coding indicates the mean taxonomic rank of classification averaged across the then benchmarking datasets (minimum and maximum values not shown for brevity). Gray lines in the plot depict sensitivity, which is defined as the fraction of classified sequences times precision. Runs with equal parameter settings are connected in the parameter settings figure, showing that CAT achieves a high precision regardless of unknownness of the query sequence, by classifying sequences that are more unknown at higher taxonomic ranks. Default parameter combination (<italic>r</italic> = 10, <italic>f</italic> = 0.5) is shown in red</p></caption><graphic xlink:href="13059_2019_1817_Fig2_HTML" id="MO2"/></fig></p>
        <p id="Par12">The <italic>r</italic> parameter, which governs the divergence of included hits for each ORF, has the largest effect. As increasing <italic>r</italic> includes homologs from increasingly divergent taxonomic groups, their LCA is pushed back and classifications at low taxonomic ranks are lost, resulting in fewer classified sequences and classifications at lower taxonomic resolution (i.e., at higher taxonomic ranks), but with higher precision. The <italic>f</italic> parameter, which governs the minimum bit-score support required for classifying a sequence, has a smaller effect. Decreasing <italic>f</italic> results in classifications that are based on evidence from fewer ORFs, leading to more tentative classifications at lower taxonomic ranks. As a result, more sequences are classified at lower taxonomic ranks, albeit with a lower precision.</p>
        <p id="Par13">As a user increases <italic>r</italic> and <italic>f</italic>, this will increasingly result in high-rank classifications that are correct but ultimately uninformative. When low values of <italic>r</italic> and <italic>f</italic> are chosen, the classifications will be more specific (i.e., at a lower taxonomic rank) but more speculative (i.e., precision goes down). Based on the parameter sweep described above, we set the default values for CAT contig classification to <italic>r</italic> = 10 and <italic>f</italic> = 0.5 (red line in the legend of Fig. <xref rid="Fig2" ref-type="fig">2</xref>). Note that this value of <italic>f</italic> = 0.5 results in at most one classification, since &gt; 50% of the bit-score supports that classification.</p>
      </sec>
      <sec id="Sec6">
        <title>Comparison to state-of-the-art taxonomic classifiers</title>
        <p id="Par14">We compared classification by CAT in this first benchmark to (1) the recently published LAST+MEGAN-LR algorithm [<xref ref-type="bibr" rid="CR17">17</xref>], (2) the widely used Kaiju algorithm [<xref ref-type="bibr" rid="CR13">13</xref>], and (3) a conventional best-hit approach with DIAMOND [<xref ref-type="bibr" rid="CR25">25</xref>]. Kaiju, designed for short-read classification, uses a best-hit approach with an LCA algorithm if equally good top-hits are found. Its underlying algorithm allows for the classification of long sequences as well and has recently been used as such [<xref ref-type="bibr" rid="CR17">17</xref>, <xref ref-type="bibr" rid="CR26">26</xref>, <xref ref-type="bibr" rid="CR27">27</xref>]. Final Kaiju classification is based on the hit with the maximum exact match (MEM), or on the highest scoring match allowing for mismatches (Greedy).</p>
        <p id="Par15">When classifying simulated contigs against the full reference database (known strains), all programs showed a similar precision and fraction of classified sequences (Fig. <xref rid="Fig3" ref-type="fig">3</xref>a). The mean taxonomic rank of classification is slightly higher for CAT and LAST+MEGAN-LR than for the other approaches (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S1), reflecting the conservative LCA-based classification strategies of the former two. DIAMOND best-hit does not use an LCA algorithm, and Kaiju only in cases where multiple hits have identical scores, and thus, they classify contigs according to the taxonomic rank of their match in the reference database.
<fig id="Fig3"><label>Fig. 3</label><caption><p>Classification performance of CAT, LAST+MEGAN-LR, Kaiju, and DIAMOND best-hit for different levels of unknownness. <bold>a</bold> Classification of known sequences. <bold>b</bold>–<bold>d</bold> Classification of simulated novel taxa for different levels of divergence from reference databases. Black bars indicate maximum and minimum values out of ten benchmarking datasets, bars cross at the means. Color coding indicates the mean taxonomic rank of classification averaged across the then benchmarking datasets (minimum and maximum values not shown for brevity)</p></caption><graphic xlink:href="13059_2019_1817_Fig3_HTML" id="MO3"/></fig></p>
        <p id="Par16">When novel species, genera, and families were simulated by removing related sequences from the database, precision declined rapidly for DIAMOND best-hit and Kaiju (Fig. <xref rid="Fig3" ref-type="fig">3</xref>b–d). The classifications called by these approaches are often too specific, because in databases where closely related sequences are absent, the singular best hit may still match a sequence that is annotated at a low taxonomic rank, although this annotation cannot match that of the query. This spurious specificity can be seen in the mean rank of classification, which stays close to the species rank, even when sequences from the same species, genus, or family were removed from the database (Fig. <xref rid="Fig3" ref-type="fig">3</xref>b–d, Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S1). CAT and LAST+MEGAN-LR clearly perform better in the face of such uncharted sequences. With default parameter settings, CAT has higher precision and sensitivity than MEGAN-LR and classifications are made at slightly higher taxonomic ranks.</p>
        <p id="Par17">Precision for CAT and LAST+MEGAN-LR increases when the sequence contains more ORFs with a DIAMOND hit to the database, whereas this is not the case for DIAMOND best-hit and Kaiju (Additional file <xref rid="MOESM2" ref-type="media">2</xref>: Figure S1). Algorithms that integrate multiple taxonomic signals are thus well suited for taxonomic classification of long metagenomic sequences and MAGs (see below), but even the majority of contigs in our benchmarking sets that contained a single ORF are still classified correctly (Additional file <xref rid="MOESM2" ref-type="media">2</xref>: Figure S1).</p>
      </sec>
      <sec id="Sec7">
        <title>Sequences are classified correctly and automatically at the appropriate taxonomic rank</title>
        <p id="Par18">As a solution to the spurious specificity of the best-hit approach described above, classifications are sometimes assigned to a higher taxonomic rank such as genus, family, or even phylum. However, applying a rank cutoff may unnecessarily sacrifice taxonomic resolution in cases where the query sequences do have close relatives in the reference database and classification at a low taxonomic rank would be justified. Additional file <xref rid="MOESM2" ref-type="media">2</xref>: Figure S2 shows that application of a rank cutoff to the best-hit classifications (e.g., reporting all classifications at the genus or phylum rank) does not solve the problem of spurious specificity as effectively as CAT does. CAT classifications have a higher precision than a best-hit cutoff on a rank comparable to its mean rank. For example, when novel families are simulated, the mean rank of classification for CAT is between order and class, and precision is much higher than best-hit classifications on those ranks, with a similar fraction of classified sequences (Additional file <xref rid="MOESM2" ref-type="media">2</xref>: Figure S2d). Importantly, CAT has the highest precision on a per rank basis of any of the tested tools (Additional file <xref rid="MOESM2" ref-type="media">2</xref>: Figure S3, Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S2). This shows that CAT approach of integrating multiple taxonomic signals across a sequence leads to better classifications.</p>
        <p id="Par19">As shown in Fig. <xref rid="Fig2" ref-type="fig">2</xref>, the ORF-based voting algorithm ensures a high precision regardless of the level of unknownness of the query sequences, i.e., whether closely related sequences are present in the reference database or not. In some circumstances, taxonomic resolution is traded for precision: when classifying sequences that are more distantly related to the sequences in the reference database, hits will have weaker bit-scores and match sequences that are taxonomically more diverse. As a result of these conflicting signals, the algorithm automatically increases the taxonomic rank when classifying more divergent query sequences. Thus, no rank cutoff is needed for precise classifications, regardless of the composition of the metagenome.</p>
      </sec>
      <sec id="Sec8">
        <title>Benchmark 2: Comparison to CAMI tools</title>
        <p id="Par20"><italic>O</italic>ur second benchmark consisted of classifying the high-complexity gold standard assembly of the CAMI challenge [<xref ref-type="bibr" rid="CR22">22</xref>]. Classifying the CAMI dataset has two benefits. First, it allows us to compare CAT to any of the taxonomic classifiers tested in the CAMI challenge (referred to as “taxonomic binners” in [<xref ref-type="bibr" rid="CR22">22</xref>]). Second, CAMI simulated novel organisms, making it a complementary benchmarking approach as compared to the database reduction method in our first benchmark.</p>
        <p id="Par21">Since novel sequences are simulated, it is crucial that search databases are used that do not contain the simulated sequences. For this reason, an “old” copy of RefSeq (dated January 30th, 2015) was supplied during the CAMI challenge. Here, we also ran CAT with that old RefSeq reference database for a fair comparison against the other tools. However, one of the advantages of CAT and BAT is that they can be run with very large protein databases and hence have a larger search space for taxonomic classification beyond RefSeq. Thus, we also ran CAT with the nr databases from a similar date (January 23, 2015) as a reference. The nr database is the default option for CAT and BAT runs.</p>
        <p id="Par22">CAT performance measures on the high-complexity gold standard contig set (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S3) are plotted in Additional file <xref rid="MOESM2" ref-type="media">2</xref>: Figure S4 and can be compared to Supplementary Figure 18 and Supplementary Figure 19 in [<xref ref-type="bibr" rid="CR22">22</xref>]. Average precision increases sharply if 99% of the data are considered (i.e., removal of taxa summing up to less than 1% of the total assembly length) as opposed to 100%. This is also true for most of the tools tested in the CAMI challenge. The reason for this observation is that precision in the CAMI challenge is measured on a “per bin” basis, and erroneous classifications of single contigs thus weigh very heavily in this benchmark. If classifications that are seen in only a single or few contigs (i.e., are supported by short sequence length overall) are excluded, CAT showed very high average precision at all taxonomic ranks down to the genus level (Additional file <xref rid="MOESM2" ref-type="media">2</xref>: Figure S4). Accuracy and average recall were high for higher ranks and decreased towards the species level. Misclassification was very low, with misclassification rates of up to 11% only at the lowest taxonomic ranks. Notably, CAT results with nr as a reference database (Additional file <xref rid="MOESM2" ref-type="media">2</xref>: Figure S4b) were better than with RefSeq as reference (Additional file <xref rid="MOESM2" ref-type="media">2</xref>: Figure S4a) for any of the measures. Average precision stayed above 90% down to the genus level if nr was used as a reference, higher than what is achieved by any of the tools tested in the CAMI challenge (see below). This highlights the benefit of using a large reference database for taxonomic classification.</p>
        <p id="Par23">We compared CAT to the other tools tested in the CAMI challenge by downloading their performance measures from the CAMI GitHub (Additional file <xref rid="MOESM2" ref-type="media">2</xref>: Figure S5). The CAMI tools fall within two categories: One set of tools (taxator-tk 1.4pre1e, taxator-tk 1.3.0e, PhyloPythiaS+ mg c400, MEGAN 6.4.9) had low misclassification but also low average recall and accuracy. The other set (PhyloPythiaS+ c400, Kraken 0.10.6-unreleased, Kraken 0.10.5) had high recall and accuracy, but very high misclassification rates towards species level. In contrast, CAT managed a medium (when using RefSeq as reference database) to high (when using nr as reference database) average recall and accuracy, with a very low misclassification rate. The misclassification rate was lower than that of the CAMI tools, with the exception of taxator-tk (both versions), which classified very few sequences in general. CAT scored among the highest average precision with 99% of the data. Thus, CAT has a high average precision and combines the high average recall and accuracy of the second set of tools with the low misclassification of the first.</p>
      </sec>
      <sec id="Sec9">
        <title>The ORF-based algorithm is fast and has a very low memory requirement</title>
        <p id="Par24">CAT is about two times faster than LAST+MEGAN-LR (Fig. <xref rid="Fig4" ref-type="fig">4</xref>a) and outperforms all other programs tested in our first benchmark in terms of memory usage (Fig. <xref rid="Fig4" ref-type="fig">4</xref>b). The slowest and most memory intensive step is the DIAMOND search for homologs in the vast nr database, which due to the flexible nature of our implementation can be optimized for a specific use case (see Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S4) or replaced by any protein aligner of a user’s choice, as can the search database.
<fig id="Fig4"><label>Fig. 4</label><caption><p>Computer resource usage by CAT, LAST+MEGAN-LR, and Kaiju. <bold>a</bold> Run-time and <bold>b</bold> peak memory usage. In <bold>a</bold>, classification by CAT and Kaiju includes adding taxonomic names to the classification; in <bold>b</bold>, these steps are depicted separately</p></caption><graphic xlink:href="13059_2019_1817_Fig4_HTML" id="MO4"/></fig></p>
        <p id="Par25">We classified the CAMI high complexity dataset with recent versions of the tools tested in our first and second benchmarks. This analysis showed that CAT is faster than MEGAN6, LAST+MEGAN-LR, and taxator-tk and has a memory footprint that is similar to or lower than any of the tested tools (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S4).</p>
      </sec>
    </sec>
    <sec id="Sec10">
      <title>MAG classification with BAT</title>
      <sec id="Sec11">
        <title>Benchmark 3: Classification of 913 metagenome-assembled genome bins (MAGs)</title>
        <p id="Par26">Next, we set out to apply the algorithm to MAGs, i.e., draft genomes that can be generated from metagenomes by assembly and binning. Since the typical pipeline to generate MAGs is reference database independent, they can be distantly related to known organisms. As benchmark set, we picked 913 recently published MAGs from the cow rumen [<xref ref-type="bibr" rid="CR7">7</xref>] that represented a wide range of novelty at different taxonomic ranks (Additional file <xref rid="MOESM2" ref-type="media">2</xref>: Figure S6a). The published classifications were based on the placement of the MAGs in a backbone tree and subsequent refinement, a slow process that includes various manual steps and visual screening [<xref ref-type="bibr" rid="CR7">7</xref>]. At the time of our study, the MAGs were not yet included in the reference database, providing an ideal test case for our automated classification tool BAT.</p>
        <p id="Par27">The 913 MAGs were previously assessed to be ≥ 80% complete and have ≤ 10% contamination and contain between 541 and 5378 ORFs each (Additional file <xref rid="MOESM2" ref-type="media">2</xref>: Figure S6b). We ran BAT with default parameter settings for MAGs classification (<italic>r</italic> = 5, <italic>f</italic> = 0.3). The low <italic>r</italic> value ensures that individual ORFs are annotated to an LCA with a relatively low taxonomic rank, as hits within 5% of the highest bit-score are considered. The low <italic>f</italic> value reports taxonomic classifications that are supported by at least 30% of the bit-score evidence. While this could be considered a speculative call when contigs with relatively few encoded ORFs are annotated, the much higher number of ORFs in MAGs means that even classifications with relatively low <italic>f</italic> values are backed by a high number of ORFs and precision is thus expected to be high (Additional file <xref rid="MOESM2" ref-type="media">2</xref>: Figure S1). We scored the consistency between BAT and the published classifications (Fig. <xref rid="Fig5" ref-type="fig">5</xref>a), dividing consistent classifications into three groups: (i) BAT can be more conservative than the published classification, i.e., BAT classifies the MAG to an ancestor of the published classification; (ii) classifications can be equal; and (iii) BAT can be more specific. Alternatively, BAT can classify a MAG inconsistently, i.e., in a different taxonomic lineage than the original publication. As shown in Fig. <xref rid="Fig5" ref-type="fig">5</xref>a, 885 of 913 MAGs (97%) were classified consistently with the original publication. If parameter <italic>f</italic> is relaxed, mean rank of classification for the MAGs increases (Fig. <xref rid="Fig5" ref-type="fig">5</xref>b). Importantly, decreasing the value of <italic>f</italic> has little effect on inconsistency rate. Thus, changing this parameter will mainly lead to a change in the rank of classification, while the taxonomic lineage will remain unchanged. Finally, classifying these MAGs with two MAG classification tools that are still under development, lastTaxa (<ext-link ext-link-type="uri" xlink:href="https://gitlab.com/jfroula/lasttaxa">https://gitlab.com/jfroula/lasttaxa</ext-link>) and GTDB-Tk (<ext-link ext-link-type="uri" xlink:href="https://github.com/Ecogenomics/GTDBTk">https://github.com/Ecogenomics/GTDBTk</ext-link>), yielded very similar results (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S5).
<fig id="Fig5"><label>Fig. 5</label><caption><p>Classification of 913 MAGs with BAT. <bold>a</bold> Consistency between BAT classifications and published classifications with default parameter settings (<italic>r</italic> = 5, <italic>f</italic> = 0.3). <bold>b</bold> The mean rank of classification can be increased by increasing <italic>f</italic>. Arrow indicates BAT results for its default parameter settings</p></caption><graphic xlink:href="13059_2019_1817_Fig5_HTML" id="MO5"/></fig></p>
        <p id="Par28">To assess the taxonomy of the 28 inconsistently classified MAGs (at <italic>r</italic> = 5, <italic>f</italic> = 0.3), we placed them in a phylogenomic tree with closely related genomes and observed their closest relatives, the published classifications, and the BAT classifications. As shown in Fig. <xref rid="Fig6" ref-type="fig">6</xref>, BAT classified all 28 inconsistently classified MAGs more precisely and at a higher taxonomic resolution than the published classifications. Note that this may be due to these closely related reference genomes being new additions to the database since the research was performed. Together, these results highlight the benefit of using BAT for the rapid, automated, and high-resolution taxonomic classification of novel microbial lineages at a range of unknownness.
<fig id="Fig6"><label>Fig. 6</label><caption><p>Tree placement of the 28 inconsistently classified MAGs that were assigned to five different taxa according to the original classifications (<bold>a</bold>–<bold>d</bold>). Headers of subfigures refer to the published classifications. In <bold>a</bold>, MAGs published as Selenomonadales are marked with an asterisk. Taxonomic classification of reference genomes is indicated in shades boxes. BAT classifications of MAGs are indicated in open boxes</p></caption><graphic xlink:href="13059_2019_1817_Fig6_HTML" id="MO6"/></fig></p>
      </sec>
    </sec>
  </sec>
  <sec id="Sec12">
    <title>Conclusions</title>
    <p id="Par29">Metagenomics continues to reveal novel microorganisms in all environments in the biosphere, whose genome sequences can be reconstructed with high accuracy by using high-throughput DNA sequencing and modern sequence assembly and binning tools. Taxonomically classifying these uncharted sequences remains challenging, partly because the vast natural biodiversity remains highly underrepresented in even the largest reference databases, partly because existing classifiers are built to classify short sequencing reads, and partly because interpreting trees is manual work.</p>
    <p id="Par30">We presented CAT and BAT, a set of tools that exploits DIAMOND homology searches of individual ORFs called by Prodigal, LCA annotation, and a user-definable weighting to classify long contigs and metagenome-assembled genomes (MAGs). As we have shown, these query sequences contain a wealth of information that allows their accurate taxonomic classification at appropriate taxonomic ranks, i.e., at a low rank when closely related organisms are present in the database, and at a high rank when the sequences are divergent or highly novel. We have shown that the low precision of conventional best-hit approaches when classifying novel taxa can be overcome by a voting algorithm based on classifications of multiple ORFs. Elegantly, sequences from organisms that are distantly related to those in the reference database are automatically classified at a higher taxonomic rank than known strains. ORFs on divergent sequences will hit a wider variety of different taxa both on the individual ORF level and between ORFs. Such conflict of classifications is automatically resolved by the algorithm by providing a more conservative classification, so no taxonomic cutoff rank for classification needs to be pre-defined. In metagenomes containing both known and unknown sequences, the algorithm vastly outperforms best-hit approaches and a range of state-of-the-art taxonomic classifiers in precision.</p>
    <p id="Par31">CAT and BAT supplement a modern metagenomics workflow in various ways. For example, CAT can be used after metagenome assembly to confidently classify all contigs. Since contigs are longer sequences and thus contain more information than individual reads, we expect that classification of the original reads in terms of classified contigs results in better profiling estimates than those based on the reads alone. Indeed, a comparison in [<xref ref-type="bibr" rid="CR22">22</xref>] between taxonomic binners and dedicated taxonomic profilers (whose output is an abundance profile but not classification of individual sequences) showed that on average binners estimated taxon abundance more accurately than profilers. With increases in contig lengths due to advances in assembly algorithms and more deeply sequenced metagenomes, as well as increasingly available long-read metagenomic sequencing datasets, CAT classifications will become even more precise in the future. Moreover, BAT will rapidly provide taxonomic classifications of MAGs without requiring a full phylogenomics pipeline and subsequently visual inspection of the tree. CAT classifications of individual contigs within MAGs can be used to identify taxonomic outliers, and flag those as possible contamination. As most binning tools do not incorporate taxonomic signals (e.g., [<xref ref-type="bibr" rid="CR28">28</xref>, <xref ref-type="bibr" rid="CR29">29</xref>]), CAT classification can be considered as independent evidence and might be used to decide on the inclusion of specific contigs in a MAG.</p>
    <p id="Par32">BAT provides a robust and rapid classification of MAGs in a single operation, but is not a replacement for high-confidence phylogenomic tree construction based on marker gene superalignments which remains the gold standard [<xref ref-type="bibr" rid="CR19">19</xref>]. However, BAT queries the full NCBI non-redundant reference database (nr) and the taxonomic context is thus much bigger than any phylogenomic tree that depends on completely sequenced genomes. For example, the backbone tree of CheckM currently includes only 5656 genomes [<xref ref-type="bibr" rid="CR20">20</xref>]. BAT classification is fully automated and can be run on a set of MAGs with minimal user input, allowing MAG classification to be scaled up considerably as we showed here for over 900 MAGs that were classified consistently with the original publication in almost all cases. Notably, in all inconsistent cases, we identified genomes that were more closely related to the BAT classification than to the published (manual) classification.</p>
    <p id="Par33">As long as sequence space is incompletely explored and reference databases represent a biased view of the tree of life [<xref ref-type="bibr" rid="CR1">1</xref>, <xref ref-type="bibr" rid="CR3">3</xref>], algorithms designed to address the abundant uncharted microbial sequences will be needed to make sense of the microbial world. Decreasing sequencing costs and improvement of alignment and binning algorithms have moved metagenomics from the analysis of short reads towards contigs and MAGs, improving our understanding of microbial ecosystems to a genomic resolution. As these data will only increase in the coming years, we presented a robust solution to their specific challenges that we expect will play an important role in future metagenomics workflows.</p>
  </sec>
  <sec id="Sec13">
    <title>Methods</title>
    <sec id="Sec14">
      <title>Explanation of the algorithm</title>
      <p id="Par34">Both CAT and BAT take high-quality long DNA sequences in FASTA format as input (Fig. <xref rid="Fig1" ref-type="fig">1</xref>), such as assembled contigs or corrected long Oxford Nanopore Technologies or Pacific Biosciences reads [<xref ref-type="bibr" rid="CR30">30</xref>, <xref ref-type="bibr" rid="CR31">31</xref>]. First, ORFs are predicted with Prodigal [<xref ref-type="bibr" rid="CR32">32</xref>] in metagenome mode, using default parameter settings (genetic code 11) (Fig. <xref rid="Fig1" ref-type="fig">1</xref>a, b). Predicted proteins can also be independently supplied to CAT/BAT in case a user prefers a different gene caller than Prodigal.</p>
      <p id="Par35">Next, protein translations of the predicted ORFs are queried against the National Center for Biotechnology Information (NCBI) non-redundant protein database (nr) [<xref ref-type="bibr" rid="CR33">33</xref>] using DIAMOND [<xref ref-type="bibr" rid="CR25">25</xref>] blastp (<italic>e</italic> value cutoff of 0.001, BLOSUM62 alignment matrix, reporting alignments within 50% range of top hit bit-score) (Fig. <xref rid="Fig1" ref-type="fig">1</xref>c). The nr database is currently the largest sequence database where all sequences are assigned to clades in NCBI Taxonomy [<xref ref-type="bibr" rid="CR34">34</xref>]. A separate BLAST tabular output file can also be supplied together with the predicted protein file, in which case CAT/BAT starts directly with classification.</p>
      <p id="Par36">Taxonomic classification of the query sequences is then carried out based on a voting approach that considers all ORFs on a query with hits to the reference database. Here, the main difference between CAT and BAT is that CAT considers ORFs on a single contig, whereas BAT considers ORFs on all contigs belonging to a MAG. CAT and BAT also have slightly different default parameter values (see below).</p>
      <p id="Par37">First, the algorithm infers the taxonomic affiliation of individual ORFs based on the top DIAMOND hits (Fig. <xref rid="Fig1" ref-type="fig">1</xref>d). To account for similarly high-scoring hits in potentially different clades, hits within a user-defined range of the top hit bit-score to that ORF are considered and the ORF is assigned to the LCA of their lineages (parameter <italic>r</italic> for <italic>range</italic>, by default hits with bit-scores within 10% or 5% range of the top hit bit-score are included, <italic>r</italic> = 10 for CAT and <italic>r</italic> = 5 for BAT, respectively). By adjusting parameter <italic>r</italic>, the user can tune how conservative CAT is in the classification of individual ORFs. For example, increasing <italic>r</italic> results in more divergent hits being included that together are likely to have a deeper LCA, thus leading to a more conservative ORF classification at a higher taxonomic rank. In contrast, decreasing <italic>r</italic> leads to a more specific classification since fewer and more similar hits will be included, likely with a narrower taxonomic range. This accounts for conserved or HGT-prone genes that are highly similar in diverse taxa by assigning them a high-rank classification. The top hit bit-score for each ORF is registered for the subsequent voting process (Fig. <xref rid="Fig1" ref-type="fig">1</xref>d).</p>
      <p id="Par38">Next, the query contig or MAG is evaluated by summing the bit-scores for each taxon identified among the classifications of all ORFs, as well as their ancestral lineages up to the taxonomy root (Fig. <xref rid="Fig1" ref-type="fig">1</xref>e). The query contig or MAG is then assigned to a taxon, if the total bit-score evidence for that taxon exceeds a cutoff value (<italic>mbs</italic>, minimal bit-score support), which is calculated as a fraction (parameter <italic>f</italic> for <italic>fraction</italic>) of the sum of the bit-scores of all ORFs (mbs = <italic>f</italic> × <italic>B</italic><sub>sum</sub>, by default <italic>f</italic> = 0.5 for CAT and <italic>f</italic> = 0.3 for BAT). For example, if parameter <italic>f</italic> is set to 0.5, this means that a contig is assigned to a taxon if the majority of the sum of the bit-scores of all ORFs supports that classification (mbs = 0.5 × <italic>B</italic><sub>sum</sub>). This is done at multiple taxonomic ranks including phylum, class, order, family, genus, and species. The algorithm stops at the taxonomic rank where the total bit-score supporting the classification drops below the minimal bit-score support value, so CAT/BAT automatically finds the lowest rank taxonomic classification that is still reliable (Fig. <xref rid="Fig1" ref-type="fig">1</xref>e). Note that with CAT default values (<italic>f</italic> = 0.5), only one classification is given per sequence, and there can be no conflicting classifications at different ranks (e.g., a species-level classification conflicting with a genus-level classification). When <italic>f</italic> &lt; 0.5 is set by the user, multiple lineages at a given taxonomic rank may exceed the threshold, and all will be written to the output file. A user can decide on the appropriate (rank of) classification based on support values that represent the fraction of summed bit-score that supports the classification. While these support values are indicative of the prediction precision (Additional file <xref rid="MOESM2" ref-type="media">2</xref>: Figure S7a), in contrast to the total bit-score alone (Additional file <xref rid="MOESM2" ref-type="media">2</xref>: Figure S7b), it should be noted that they cannot be interpreted as statistical probabilities.</p>
    </sec>
    <sec id="Sec15">
      <title>Output files</title>
      <p id="Par39">For each query contig or MAG, the full taxonomic lineage of the lowest-rank supported classification is written to the output file, together with support values per rank (i.e., the fraction of <italic>B</italic><sub>sum</sub> that is represented by the taxon). In addition, the number of ORFs found on the contig or MAG and the number of ORFs on which the classification is based are written to the output file. An extra output file containing information about individual ORFs is also generated, including classifications of ORFs and an explanation for any ORF that is not classified. We advise the user caution when interpreting the classifications of short contigs that are based on relatively few ORFs as they will be less robust than the classifications of long contigs or MAGs (Additional file <xref rid="MOESM2" ref-type="media">2</xref>: Figure S1).</p>
    </sec>
    <sec id="Sec16">
      <title>Helper programs</title>
      <p id="Par40">The CAT/BAT package comes bundled with three helper utilities, “prepare,” “add_names,” and “summarise.” “Prepare” only needs to be run once. It downloads all the needed files including NCBI taxonomy files and the nr database. It constructs a DIAMOND database from nr and generates the files needed for subsequent CAT and BAT runs. Because the first protein accession in nr not always represents the LCA of all protein accessions in the entry, “prepare” corrects for this in the protein accession to taxonomy id mapping file (prot.accession2taxid). After running CAT/BAT, “add_names” will add taxonomic names to the output files, either of the full lineage or of official taxonomic ranks alone (superkingdom, phylum, class, order, family, genus, species). “Summarise” generates summary statistics based on a named classification file. For contig classification, it reports the total length of the contigs that are classified to each taxon. For MAG classification, it reports the number of MAGs per taxon.</p>
    </sec>
    <sec id="Sec17">
      <title>Generation of contigs for clade exclusion benchmarking datasets</title>
      <p id="Par41">To test the performance of the algorithm in a first benchmark, we artificially generated contigs from known genome sequences in the RefSeq database [<xref ref-type="bibr" rid="CR35">35</xref>] (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S6). We randomly downloaded one genome per taxonomic order from bacterial RefSeq on July 7, 2017 (163 orders in total) and cut the genomes into at most 65 non-overlapping contigs, generating a set of ~ 10,500 contigs with known taxonomic affiliation. Contig lengths were based on the length distribution of eight assembled real metagenomes deposited in the Sequence Read Archive (SRA) [<xref ref-type="bibr" rid="CR36">36</xref>] (assembly with metaSPAdes v3.10.1 [<xref ref-type="bibr" rid="CR4">4</xref>] after quality filtering with BBDuk that is included with BBTools v36.64 (<ext-link ext-link-type="uri" xlink:href="https://sourceforge.net/projects/bbmap/">https://sourceforge.net/projects/bbmap/</ext-link>), see Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S6), with a minimum length of 300 nucleotides. This was done ten times to construct ten different benchmarking datasets sampled from 163 different genomes, each from a different taxonomic order.</p>
      <p id="Par42">Viruses remain vastly under-sampled, and the sequences in the database remain a small fraction of the total viral sequence space [<xref ref-type="bibr" rid="CR37">37</xref>]. Moreover, the hierarchy of the viral taxonomy is not as deeply structured as the taxonomy of cellular organisms [<xref ref-type="bibr" rid="CR38">38</xref>]. Based on these considerations, we did not explicitly assess the performance of our tool on viral sequences. However, we expect that classification of viruses will be readily possible when closely related viruses are present in the reference database.</p>
    </sec>
    <sec id="Sec18">
      <title>Reference databases with increasing levels of unknownness</title>
      <p id="Par43">The benchmarking datasets generated above are derived from genomes whose sequences are also present in the reference database, corresponding to the perhaps unlikely scenario where the query sequences in the metagenome are identical to known strains in the database. To benchmark our tools in the context of discovering sequences from novel taxa, we next generated novel reference databases with increasing levels of unknownness by removing specific taxonomic groups from nr. In addition to the original nr database (known strains), three derived databases were constructed to reflect the situation of discovering novel species, genera, and families. This was done by removing all proteins that are only present in the same species, genus, or family as any of the 163 genomes in the benchmarking dataset. To do this, either we removed the sequences from the database itself, or if a protein was identical in sequence to a protein in another clade, we changed the protein accession to taxonomy id mapping file to exclude the query taxon. In contrast to many other taxonomic classification tools, all the programs that we compared (CAT, DIAMOND best-hit, LAST+MEGAN-LR, and Kaiju) allowed such custom files to be used. The three reduced databases and associated mapping files thus reflect what nr would have looked like if the species, genus, or family of the genomes present in the benchmarking dataset were never seen before. This was done independently for each of the ten different benchmarking datasets, resulting in a total of 30 new reference databases to rigorously test the performance of our sequence classification tools in the face of uncharted microbial sequences. Simulating unknownness like this provides a better benchmark for classification of unknown sequences than a leave-one-out approach where only the query genome is removed from the reference database(e.g., [<xref ref-type="bibr" rid="CR13">13</xref>, <xref ref-type="bibr" rid="CR17">17</xref>]), because close relatives of the query may still be present in the latter case.</p>
    </sec>
    <sec id="Sec19">
      <title>Programs, parameters, and dependencies</title>
      <p id="Par44">Nr database and taxonomy files were downloaded on November 23, 2017. Prodigal v2.6.3 [<xref ref-type="bibr" rid="CR32">32</xref>] was used to identify ORFs on the simulated contigs. DIAMOND v0.9.14 [<xref ref-type="bibr" rid="CR25">25</xref>] was used to align the encoded proteins to the reference databases for CAT and for the DIAMOND best-hit approach. Kaiju v1.6.2 [<xref ref-type="bibr" rid="CR13">13</xref>] was run both in MEM and Greedy mode with SEG low complexity filter enabled. The number of mismatches allowed in Greedy mode was set to 5. For LAST+MEGAN-LR, LAST v914 [<xref ref-type="bibr" rid="CR18">18</xref>] was used to map sequences to the databases with a score penalty of 15 for frameshifts, as suggested in [<xref ref-type="bibr" rid="CR17">17</xref>]. Scripts in the MEGAN v6.11.7 [<xref ref-type="bibr" rid="CR17">17</xref>] tools directory were used to convert LAST output to a classification file. The maf2daa tool was used to convert LAST output to a .daa alignment file. The daa2rma tool was used to apply the long-read algorithm. “--minSupportPercent” was set to 0 and the LCA algorithm to longReads, and the longReads filter was applied. “--topPercent” was set to 10 and “--lcaCoveragePercent” to 80 (MEGAN-LR defaults). The rma2info tool was used to convert the generated .rma file to a classification file. When a reduced database was queried, the appropriate protein accession to taxonomy id mapping file was supplied via its respective setting (see the section “<xref rid="Sec18" ref-type="sec">Reference databases with increasing levels of unknownness</xref>” above).</p>
    </sec>
    <sec id="Sec20">
      <title>Scoring of contig classification performance</title>
      <p id="Par45">For contig classification, we scored (i) the fraction of classified contigs, (ii) sensitivity, (iii) precision, and (iv) mean and median rank of classification (Additional file <xref rid="MOESM2" ref-type="media">2</xref>: Figure S8). Classifications were compared at the taxonomic ranks of species, genus, family, order, class, phylum, and superkingdom. In those cases where <italic>f</italic> &lt; 0.5 and multiple classifications reached the mbs threshold, we chose the lowest classification that reached a majority vote (i.e., as if <italic>f</italic> = 0.5) for calculating the four performance measures i–iv. This means CAT classifications were more conservative in those (rare) cases. Contigs with a classification higher than the superkingdom rank (e.g., “cellular organisms” or “root”) were considered unclassified, as these classifications are trivially informative in our benchmark. For all tools, a classification was considered correct if it was a subset of the true taxonomic lineage, regardless of rank of classification. If a classification was consistent with the true taxonomic lineage but classified too specifically (e.g., at the species rank whereas the query is a novel family), it was considered incorrect. For classifications that are shown per rank, only that part of the lineage that is too specific is considered incorrect.</p>
      <p id="Par46">The mean and median taxonomic rank of classification were calculated for all classified contigs, where the ranks species-phylum were given the integer values 0–6, respectively. Even though the true distance between taxonomic ranks may vary [<xref ref-type="bibr" rid="CR39">39</xref>], calculating mean taxonomic rank in this fashion does serve as a proxy to show that classifications are called at higher taxonomic ranks “on average” under certain parameter conditions or, e.g., with higher divergence of the query sequence from the reference database. Sensitivity and precision were scored as (correctly classified/total number of contigs) and (correctly classified/total number of classified contigs), respectively. Thus, all performance measures are a property of the whole contig set and not of single taxonomic classifications as with some measures in the CAMI challenge benchmark further on. Wherever error bars are shown, they represent the maximum and minimum values out of the ten benchmark datasets.</p>
    </sec>
    <sec id="Sec21">
      <title>CAMI high-complexity gold standard benchmark</title>
      <p id="Par47">In a second benchmark, we downloaded the high-complexity gold standard assembly together with the taxonomy files and NCBI RefSeq database (dated January 30, 2015) that was supplied with the CAMI challenge [<xref ref-type="bibr" rid="CR22">22</xref>]<bold>.</bold> We ran CAT on the assembly with RefSeq and nr (dated January 23, 2015) as reference databases. Importantly, both databases did not contain any of the query sequences yet.</p>
      <p id="Par48">We scored performance in exactly the same way as in the CAMI challenge, which allows us to compare the results of CAT to any of the taxonomic classifiers tested (“taxonomic binners”). In short, all four measures (accuracy, misclassification, average precision, average recall) are a function of the number of classified base pairs and not of classified contigs as in the benchmark above. If a tool classifies a sequence on a taxonomic rank that is not present in the gold standard, it is not taken into account. Thus, there is no penalty for classifications that are too specific. Accuracy is (number of correctly classified base pairs/total number of base pairs), misclassification (number of incorrectly classified base pairs/total number of base pairs), and both are thus a property of the whole assembly. Precision is a measure of the purity of a predicted taxonomic bin (i.e., all sequences from a single predicted taxon) with (number of correctly assigned base pairs/total assigned base pairs). Average precision is the mean precision of all predicted taxonomic bins and is thus very sensitive to misclassified small bins. Therefore in [<xref ref-type="bibr" rid="CR22">22</xref>] in addition to precision measures of the full data, small bins summing up to 1% of the data are excluded and precision is recalculated. We did the same. Recall is a measure of the completeness of a real taxon bin (i.e., all sequences from a single query taxon), with (number of correctly assigned base pairs/real number of base pairs). Average recall is mean recall for all real taxon bins.</p>
      <p id="Par49">For a comparison with all taxonomic classifiers tested in the CAMI challenge, we downloaded the summaries from <ext-link ext-link-type="uri" xlink:href="https://github.com/CAMI-challenge/firstchallenge_evaluation/tree/master/binning/tables/plot/supervised/summary_high.csv">https://github.com/CAMI-challenge/firstchallenge_evaluation/tree/master/binning/tables/plot/supervised/summary_high.csv</ext-link> and <ext-link ext-link-type="uri" xlink:href="https://github.com/CAMI-challenge/firstchallenge_evaluation/tree/master/binning/tables/plot/supervised/summary99_high.csv">https://github.com/CAMI-challenge/firstchallenge_evaluation/tree/master/binning/tables/plot/supervised/summary99_high.csv</ext-link>.</p>
    </sec>
    <sec id="Sec22">
      <title>MAG classification</title>
      <p id="Par50">For a third benchmark, 913 high-quality draft genome bins (MAGs) (completeness ≥ 80%, contamination ≤ 10%) from the cow rumen generated with both conventional metagenomics as well as Hi-C binning methods [<xref ref-type="bibr" rid="CR7">7</xref>] were downloaded from the DataShare of the University of Edinburgh (<ext-link ext-link-type="uri" xlink:href="https://datashare.is.ed.ac.uk/handle/10283/3009">https://datashare.is.ed.ac.uk/handle/10283/3009</ext-link>). Taxonomic classification of the MAGs was downloaded from the supplementary data that accompanies the paper and manually corrected if the names did not match our taxonomy files (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S5). To save disk space on the alignment file being generated, we ran BAT on batches of 25 genomes each. Akin to the contig classification case in the first benchmark, we only considered classifications by BAT at official taxonomic ranks and chose the majority classification in those cases were BAT gave more than one classification for a MAG (i.e., as if <italic>f =</italic> 0.5 for that MAG) resulting in more conservative classifications.</p>
      <p id="Par51">To manually assess the 28 MAGs whose classification was inconsistent with the published classifications, we created a phylogenomic tree of those bins together with closely related genomes that were downloaded from PATRIC [<xref ref-type="bibr" rid="CR40">40</xref>] on January 16, 2018. CheckM v1.0.7 [<xref ref-type="bibr" rid="CR20">20</xref>] was used to extract 43 phylogenetically informative marker genes that were realigned with ClustalOmega v1.2.3 [<xref ref-type="bibr" rid="CR41">41</xref>]. We concatenated the alignments to create a superalignment and included gaps if a protein was absent. We constructed a maximum likelihood tree with IQ-TREE v1.6.3 [<xref ref-type="bibr" rid="CR42">42</xref>], with ModelFinder [<xref ref-type="bibr" rid="CR43">43</xref>] set to fit nuclear models (best-fit model LG+R7 based on Bayesian Information Criterion), including 1000 ultrafast bootstraps [<xref ref-type="bibr" rid="CR44">44</xref>]. Per clade, rooted subtrees were visualized in iTOL [<xref ref-type="bibr" rid="CR45">45</xref>].</p>
      <p id="Par52">We classified the MAGs with 2 MAG classification tools that are still under development, lastTaxa (<ext-link ext-link-type="uri" xlink:href="https://gitlab.com/jfroula/lasttaxa">https://gitlab.com/jfroula/lasttaxa</ext-link>) and GTDB-Tk v0.2.2 (<ext-link ext-link-type="uri" xlink:href="https://github.com/Ecogenomics/GTDBTk">https://github.com/Ecogenomics/GTDBTk</ext-link>). LastTaxa predicts ORFs with Prodigal and searches the nr database with LAST, after which classification is based on the majority classification of individual ORFs. LastTaxa was run on the same nr dataset as BAT, and they can thus be directly compared. GTDB-Tk first identifies marker genes and places the MAG in a reference genome tree based on these marker genes (see also [<xref ref-type="bibr" rid="CR39">39</xref>]). GTDB-Tk was run with the classify workflow with release 86 of the GTDB-tk reference database. This database was constructed after the publication of [<xref ref-type="bibr" rid="CR7">7</xref>]. The results of these comparisons can be found in Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S5.</p>
    </sec>
    <sec id="Sec23">
      <title>Usage of computer resources</title>
      <p id="Par53">Run time and peak memory usage were estimated with the Linux/usr/bin/time utility. Elapsed wall clock time and maximum resident set size were scored for runs of CAT, MEGAN-LR, and Kaiju, classifying contig set #1 (10,533 contigs, see Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S6) with the nr reference database. All tools were run with default parameter settings. Runs were performed on a machine with an Intel Xeon Gold 6136 Processor, 128 GB of memory, 24 cores, and 48 threads. Whenever one of the programs allowed for the deployment of multiple threads, all were used.</p>
      <p id="Par54">We estimated run time and peak memory usage for CAT, MEGAN-LR, Kaiju, and recent versions of the CAMI tools on the CAMI high-complexity dataset, with the NCBI RefSeq database that was supplied with the CAMI challenge as a reference. PhyloPythiaS+ was excluded because it needs a custom database that cannot be constructed based on RefSeq. The CAMI tools were run as suggested in their respective manuals and/or as done in the CAMI challenge (see Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S4). MEGAN was run on a single metagenomic read file (out of 5 in the challenge); all the other tools were run on the gold standard assembly (42,038 contigs). Runs were performed on a machine with an Intel Xeon E5-2667 v3 Processor, 512 GB of memory, and 16 cores/threads. Whenever one of the programs allowed for the deployment of multiple threads, all were used.</p>
      <p id="Par55">CAT and BAT have been tried and tested on 128 GB machines.</p>
    </sec>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary information</title>
    <sec id="Sec24">
      <p>
        <supplementary-material content-type="local-data" id="MOESM1">
          <media xlink:href="13059_2019_1817_MOESM1_ESM.xlsx">
            <caption>
              <p><bold>Additional file 1: </bold><bold>Tables S1-S6.</bold> Supplementary tables. (XLSX 7 mb)</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM2">
          <media xlink:href="13059_2019_1817_MOESM2_ESM.pdf">
            <caption>
              <p><bold>Additional file 2: Figures S1-S8.</bold> Supplementary figures. (PDF 1.55 mb)</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM3">
          <media xlink:href="13059_2019_1817_MOESM3_ESM.docx">
            <caption>
              <p><bold>Additional file 3.</bold> Review history. (DOCX 21.7 kb)</p>
            </caption>
          </media>
        </supplementary-material>
      </p>
    </sec>
  </sec>
</body>
<back>
  <fn-group>
    <fn>
      <p>
        <bold>Publisher’s Note</bold>
      </p>
      <p>Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p>
    </fn>
    <fn>
      <p>F. A. Bastiaan von Meijenfeldt and Ksenia Arkhipova contributed equally to this work.</p>
    </fn>
  </fn-group>
  <sec>
    <title>Supplementary information</title>
    <p><bold>Supplementary information</bold> accompanies this paper at 10.1186/s13059-019-1817-x.</p>
  </sec>
  <ack>
    <title>Acknowledgements</title>
    <p>We thank Jan Kees van Amerongen for his technical support and Johannes Dröge for his advice on taxator-tk.</p>
    <sec id="FPar1">
      <title>Review history</title>
      <p id="Par56">The review history is available as Additional file <xref rid="MOESM3" ref-type="media">3</xref>.</p>
    </sec>
  </ack>
  <notes notes-type="author-contribution">
    <title>Authors’ contributions</title>
    <p>BED conceived the study. FABvM, DDC, and KA wrote the code. FABvM and FHC analyzed the data. FABvM and BED wrote the paper. All authors read and approved the final manuscript.</p>
  </notes>
  <notes notes-type="funding-information">
    <title>Funding</title>
    <p>This work was supported by the Netherlands Organization for Scientific Research [Vidi grant 864.14.004] to [B.E.D.] and the Conselho Nacional de Desenvolvimento Científico e Tecnológico [Science Without Borders program] to [D.D.C.] and [F.H.C.].</p>
  </notes>
  <notes notes-type="data-availability">
    <title>Availability of data and materials</title>
    <p>CAT and BAT are available under the MIT License at GitHub [<xref ref-type="bibr" rid="CR46">46</xref>]. A version of the source code used in this manuscript is deposited on Zenodo [<xref ref-type="bibr" rid="CR47">47</xref>]. All benchmarking datasets and reference databases with increasing levels of unknownness are available from the authors upon request. The contigs in the first benchmark are based on Bacterial RefSeq [<xref ref-type="bibr" rid="CR35">35</xref>] and the databases based on nr [<xref ref-type="bibr" rid="CR33">33</xref>]. The second benchmark is the CAMI benchmark [<xref ref-type="bibr" rid="CR22">22</xref>], and the third is from Stewart et al. [<xref ref-type="bibr" rid="CR7">7</xref>].</p>
  </notes>
  <notes>
    <title>Ethics approval and consent to participate</title>
    <p id="Par57">Not applicable.</p>
  </notes>
  <notes notes-type="COI-statement">
    <title>Competing interests</title>
    <p id="Par58">The authors declare that they have no competing interests.</p>
  </notes>
  <ref-list id="Bib1">
    <title>References</title>
    <ref id="CR1">
      <label>1.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Dutilh</surname>
            <given-names>BE</given-names>
          </name>
        </person-group>
        <article-title>Metagenomic ventures into outer sequence space</article-title>
        <source>Bacteriophage.</source>
        <year>2014</year>
        <volume>4</volume>
        <fpage>e979664</fpage>
        <pub-id pub-id-type="doi">10.4161/21597081.2014.979664</pub-id>
        <?supplied-pmid 26458273?>
        <pub-id pub-id-type="pmid">26458273</pub-id>
      </element-citation>
    </ref>
    <ref id="CR2">
      <label>2.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bernard</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Pathmanathan</surname>
            <given-names>JS</given-names>
          </name>
          <name>
            <surname>Lannes</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Lopez</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Bapteste</surname>
            <given-names>E</given-names>
          </name>
        </person-group>
        <article-title>Microbial dark matter investigations: how microbial studies transform biological knowledge and empirically sketch a logic of scientific discovery</article-title>
        <source>Genome Biol Evol</source>
        <year>2018</year>
        <volume>10</volume>
        <fpage>707</fpage>
        <lpage>715</lpage>
        <pub-id pub-id-type="doi">10.1093/gbe/evy031</pub-id>
        <?supplied-pmid 29420719?>
        <pub-id pub-id-type="pmid">29420719</pub-id>
      </element-citation>
    </ref>
    <ref id="CR3">
      <label>3.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Castelle</surname>
            <given-names>CJ</given-names>
          </name>
          <name>
            <surname>Banfield</surname>
            <given-names>JF</given-names>
          </name>
        </person-group>
        <article-title>Major new microbial groups expand diversity and alter our understanding of the tree of life</article-title>
        <source>Cell.</source>
        <year>2018</year>
        <volume>172</volume>
        <fpage>1181</fpage>
        <lpage>1197</lpage>
        <pub-id pub-id-type="doi">10.1016/j.cell.2018.02.016</pub-id>
        <?supplied-pmid 29522741?>
        <pub-id pub-id-type="pmid">29522741</pub-id>
      </element-citation>
    </ref>
    <ref id="CR4">
      <label>4.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Nurk</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Meleshko</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Korobeynikov</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Pevzner</surname>
            <given-names>PA</given-names>
          </name>
        </person-group>
        <article-title>metaSPAdes: a new versatile metagenomic assembler</article-title>
        <source>Genome Res</source>
        <year>2017</year>
        <volume>27</volume>
        <fpage>824</fpage>
        <lpage>834</lpage>
        <pub-id pub-id-type="doi">10.1101/gr.213959.116</pub-id>
        <?supplied-pmid 5411777?>
        <pub-id pub-id-type="pmid">28298430</pub-id>
      </element-citation>
    </ref>
    <ref id="CR5">
      <label>5.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Brown</surname>
            <given-names>CT</given-names>
          </name>
          <name>
            <surname>Hug</surname>
            <given-names>LA</given-names>
          </name>
          <name>
            <surname>Thomas</surname>
            <given-names>BC</given-names>
          </name>
          <name>
            <surname>Sharon</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Castelle</surname>
            <given-names>CJ</given-names>
          </name>
          <name>
            <surname>Singh</surname>
            <given-names>A</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Unusual biology across a group comprising more than 15% of domain bacteria</article-title>
        <source>Nature.</source>
        <year>2015</year>
        <volume>523</volume>
        <fpage>208</fpage>
        <lpage>211</lpage>
        <pub-id pub-id-type="doi">10.1038/nature14486</pub-id>
        <?supplied-pmid 26083755?>
        <pub-id pub-id-type="pmid">26083755</pub-id>
      </element-citation>
    </ref>
    <ref id="CR6">
      <label>6.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Parks</surname>
            <given-names>DH</given-names>
          </name>
          <name>
            <surname>Rinke</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Chuvochina</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Chaumeil</surname>
            <given-names>P-A</given-names>
          </name>
          <name>
            <surname>Woodcroft</surname>
            <given-names>BJ</given-names>
          </name>
          <name>
            <surname>Evans</surname>
            <given-names>PN</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Recovery of nearly 8,000 metagenome-assembled genomes substantially expands the tree of life</article-title>
        <source>Nat Microbiol</source>
        <year>2017</year>
        <volume>31</volume>
        <fpage>217</fpage>
        <lpage>1542</lpage>
      </element-citation>
    </ref>
    <ref id="CR7">
      <label>7.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Stewart</surname>
            <given-names>RD</given-names>
          </name>
          <name>
            <surname>Auffret</surname>
            <given-names>MD</given-names>
          </name>
          <name>
            <surname>Warr</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Wiser</surname>
            <given-names>AH</given-names>
          </name>
          <name>
            <surname>Press</surname>
            <given-names>MO</given-names>
          </name>
          <name>
            <surname>Langford</surname>
            <given-names>KW</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Assembly of 913 microbial genomes from metagenomic sequencing of the cow rumen</article-title>
        <source>Nat Commun</source>
        <year>2018</year>
        <volume>9</volume>
        <fpage>870</fpage>
        <pub-id pub-id-type="doi">10.1038/s41467-018-03317-6</pub-id>
        <?supplied-pmid 29491419?>
        <pub-id pub-id-type="pmid">29491419</pub-id>
      </element-citation>
    </ref>
    <ref id="CR8">
      <label>8.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Anantharaman</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Brown</surname>
            <given-names>CT</given-names>
          </name>
          <name>
            <surname>Hug</surname>
            <given-names>LA</given-names>
          </name>
          <name>
            <surname>Sharon</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Castelle</surname>
            <given-names>CJ</given-names>
          </name>
          <name>
            <surname>Probst</surname>
            <given-names>AJ</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Thousands of microbial genomes shed light on interconnected biogeochemical processes in an aquifer system</article-title>
        <source>Nat Commun</source>
        <year>2016</year>
        <volume>7</volume>
        <fpage>13219</fpage>
        <pub-id pub-id-type="doi">10.1038/ncomms13219</pub-id>
        <?supplied-pmid 27774985?>
        <pub-id pub-id-type="pmid">27774985</pub-id>
      </element-citation>
    </ref>
    <ref id="CR9">
      <label>9.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Handelsman</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>Metagenomics: application of genomics to uncultured microorganisms</article-title>
        <source>Microbiol Mol Biol Rev</source>
        <year>2004</year>
        <volume>68</volume>
        <fpage>669</fpage>
        <lpage>685</lpage>
        <pub-id pub-id-type="doi">10.1128/MMBR.68.4.669-685.2004</pub-id>
        <?supplied-pmid 15590779?>
        <pub-id pub-id-type="pmid">15590779</pub-id>
      </element-citation>
    </ref>
    <ref id="CR10">
      <label>10.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Breitwieser</surname>
            <given-names>FP</given-names>
          </name>
          <name>
            <surname>Lu</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Salzberg</surname>
            <given-names>SL</given-names>
          </name>
        </person-group>
        <article-title>A review of methods and databases for metagenomic classification and assembly</article-title>
        <source>Brief Bioinformatics</source>
        <year>2017</year>
        <volume>3</volume>
        <fpage>31</fpage>
      </element-citation>
    </ref>
    <ref id="CR11">
      <label>11.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wood</surname>
            <given-names>DE</given-names>
          </name>
          <name>
            <surname>Salzberg</surname>
            <given-names>SL</given-names>
          </name>
        </person-group>
        <article-title>Kraken: ultrafast metagenomic sequence classification using exact alignments</article-title>
        <source>Genome Biol</source>
        <year>2014</year>
        <volume>15</volume>
        <fpage>R46</fpage>
        <pub-id pub-id-type="doi">10.1186/gb-2014-15-3-r46</pub-id>
        <?supplied-pmid 4053813?>
        <pub-id pub-id-type="pmid">24580807</pub-id>
      </element-citation>
    </ref>
    <ref id="CR12">
      <label>12.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ounit</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Wanamaker</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Close</surname>
            <given-names>TJ</given-names>
          </name>
          <name>
            <surname>Lonardi</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>CLARK: fast and accurate classification of metagenomic and genomic sequences using discriminative k-mers</article-title>
        <source>BMC Genomics</source>
        <year>2015</year>
        <volume>16</volume>
        <fpage>236</fpage>
        <pub-id pub-id-type="doi">10.1186/s12864-015-1419-2</pub-id>
        <?supplied-pmid 25879410?>
        <pub-id pub-id-type="pmid">25879410</pub-id>
      </element-citation>
    </ref>
    <ref id="CR13">
      <label>13.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Menzel</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Ng</surname>
            <given-names>KL</given-names>
          </name>
          <name>
            <surname>Krogh</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>Fast and sensitive taxonomic classification for metagenomics with Kaiju</article-title>
        <source>Nat Commun</source>
        <year>2016</year>
        <volume>7</volume>
        <fpage>11257</fpage>
        <pub-id pub-id-type="doi">10.1038/ncomms11257</pub-id>
        <?supplied-pmid 27071849?>
        <pub-id pub-id-type="pmid">27071849</pub-id>
      </element-citation>
    </ref>
    <ref id="CR14">
      <label>14.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Silva</surname>
            <given-names>GGZ</given-names>
          </name>
          <name>
            <surname>Cuevas</surname>
            <given-names>DA</given-names>
          </name>
          <name>
            <surname>Dutilh</surname>
            <given-names>BE</given-names>
          </name>
          <name>
            <surname>Edwards</surname>
            <given-names>RA</given-names>
          </name>
        </person-group>
        <article-title>FOCUS: an alignment-free model to identify organisms in metagenomes using non-negative least squares</article-title>
        <source>PeerJ.</source>
        <year>2014</year>
        <volume>2</volume>
        <fpage>e425</fpage>
        <pub-id pub-id-type="doi">10.7717/peerj.425</pub-id>
        <?supplied-pmid 24949242?>
        <pub-id pub-id-type="pmid">24949242</pub-id>
      </element-citation>
    </ref>
    <ref id="CR15">
      <label>15.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Huson</surname>
            <given-names>DH</given-names>
          </name>
          <name>
            <surname>Beier</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Flade</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Górska</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>El-Hadidi</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Mitra</surname>
            <given-names>S</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>MEGAN community edition - interactive exploration and analysis of large-scale microbiome sequencing data</article-title>
        <source>PLoS Comput Biol</source>
        <year>2016</year>
        <volume>12</volume>
        <fpage>e1004957</fpage>
        <pub-id pub-id-type="doi">10.1371/journal.pcbi.1004957</pub-id>
        <?supplied-pmid 4915700?>
        <pub-id pub-id-type="pmid">27327495</pub-id>
      </element-citation>
    </ref>
    <ref id="CR16">
      <label>16.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Roux</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Tournayre</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Mahul</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Debroas</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Enault</surname>
            <given-names>F</given-names>
          </name>
        </person-group>
        <article-title>Metavir 2: new tools for viral metagenome comparison and assembled virome analysis</article-title>
        <source>BMC Bioinformatics</source>
        <year>2014</year>
        <volume>15</volume>
        <fpage>76</fpage>
        <pub-id pub-id-type="doi">10.1186/1471-2105-15-76</pub-id>
        <?supplied-pmid 24646187?>
        <pub-id pub-id-type="pmid">24646187</pub-id>
      </element-citation>
    </ref>
    <ref id="CR17">
      <label>17.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Huson</surname>
            <given-names>DH</given-names>
          </name>
          <name>
            <surname>Albrecht</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Bağcı</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Bessarab</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Górska</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Jolic</surname>
            <given-names>D</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>MEGAN-LR: new algorithms allow accurate binning and easy interactive exploration of metagenomic long reads and contigs</article-title>
        <source>Biol Direct</source>
        <year>2018</year>
        <volume>13</volume>
        <fpage>6</fpage>
        <pub-id pub-id-type="doi">10.1186/s13062-018-0208-7</pub-id>
        <?supplied-pmid 5910613?>
        <pub-id pub-id-type="pmid">29678199</pub-id>
      </element-citation>
    </ref>
    <ref id="CR18">
      <label>18.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kiełbasa</surname>
            <given-names>SM</given-names>
          </name>
          <name>
            <surname>Wan</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Sato</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Horton</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Frith</surname>
            <given-names>MC</given-names>
          </name>
        </person-group>
        <article-title>Adaptive seeds tame genomic sequence comparison</article-title>
        <source>Genome Res</source>
        <year>2011</year>
        <volume>21</volume>
        <fpage>487</fpage>
        <lpage>493</lpage>
        <pub-id pub-id-type="doi">10.1101/gr.113985.110</pub-id>
        <?supplied-pmid 21209072?>
        <pub-id pub-id-type="pmid">21209072</pub-id>
      </element-citation>
    </ref>
    <ref id="CR19">
      <label>19.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Dutilh</surname>
            <given-names>BE</given-names>
          </name>
          <name>
            <surname>van Noort</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>van der Heijden</surname>
            <given-names>RTJM</given-names>
          </name>
          <name>
            <surname>Boekhout</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Snel</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Huynen</surname>
            <given-names>MA</given-names>
          </name>
        </person-group>
        <article-title>Assessment of phylogenomic and orthology approaches for phylogenetic inference</article-title>
        <source>Bioinformatics.</source>
        <year>2007</year>
        <volume>23</volume>
        <fpage>815</fpage>
        <lpage>824</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btm015</pub-id>
        <?supplied-pmid 17237036?>
        <pub-id pub-id-type="pmid">17237036</pub-id>
      </element-citation>
    </ref>
    <ref id="CR20">
      <label>20.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Parks</surname>
            <given-names>DH</given-names>
          </name>
          <name>
            <surname>Imelfort</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Skennerton</surname>
            <given-names>CT</given-names>
          </name>
          <name>
            <surname>Hugenholtz</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Tyson</surname>
            <given-names>GW</given-names>
          </name>
        </person-group>
        <article-title>CheckM: assessing the quality of microbial genomes recovered from isolates, single cells, and metagenomes</article-title>
        <source>Genome Res</source>
        <year>2015</year>
        <volume>25</volume>
        <fpage>1043</fpage>
        <lpage>1055</lpage>
        <pub-id pub-id-type="doi">10.1101/gr.186072.114</pub-id>
        <?supplied-pmid 25977477?>
        <pub-id pub-id-type="pmid">25977477</pub-id>
      </element-citation>
    </ref>
    <ref id="CR21">
      <label>21.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Guy</surname>
            <given-names>L</given-names>
          </name>
        </person-group>
        <article-title>phyloSkeleton: taxon selection, data retrieval and marker identification for phylogenomics</article-title>
        <source>Bioinformatics.</source>
        <year>2017</year>
        <volume>33</volume>
        <fpage>1230</fpage>
        <lpage>1232</lpage>
        <?supplied-pmid 28057682?>
        <pub-id pub-id-type="pmid">28057682</pub-id>
      </element-citation>
    </ref>
    <ref id="CR22">
      <label>22.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Sczyrba</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Hofmann</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Belmann</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Koslicki</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Janssen</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Dröge</surname>
            <given-names>J</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Critical assessment of metagenome interpretation-a benchmark of metagenomics software</article-title>
        <source>Nat Methods</source>
        <year>2017</year>
        <volume>14</volume>
        <fpage>1063</fpage>
        <lpage>1071</lpage>
        <pub-id pub-id-type="doi">10.1038/nmeth.4458</pub-id>
        <?supplied-pmid 5903868?>
        <pub-id pub-id-type="pmid">28967888</pub-id>
      </element-citation>
    </ref>
    <ref id="CR23">
      <label>23.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Gregor</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Dröge</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Schirmer</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Quince</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>McHardy</surname>
            <given-names>AC</given-names>
          </name>
        </person-group>
        <article-title>PhyloPythiaS+: a self-training method for the rapid reconstruction of low-ranking taxonomic bins from metagenomes</article-title>
        <source>PeerJ PeerJ Inc</source>
        <year>2016</year>
        <volume>4</volume>
        <fpage>e1603</fpage>
        <pub-id pub-id-type="doi">10.7717/peerj.1603</pub-id>
      </element-citation>
    </ref>
    <ref id="CR24">
      <label>24.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Dröge</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Gregor</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>McHardy</surname>
            <given-names>AC</given-names>
          </name>
        </person-group>
        <article-title>Taxator-tk: precise taxonomic assignment of metagenomes by fast approximation of evolutionary neighborhoods</article-title>
        <source>Bioinformatics.</source>
        <year>2015</year>
        <volume>31</volume>
        <fpage>817</fpage>
        <lpage>824</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btu745</pub-id>
        <?supplied-pmid 25388150?>
        <pub-id pub-id-type="pmid">25388150</pub-id>
      </element-citation>
    </ref>
    <ref id="CR25">
      <label>25.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Buchfink</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Xie</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Huson</surname>
            <given-names>DH</given-names>
          </name>
        </person-group>
        <article-title>Fast and sensitive protein alignment using DIAMOND</article-title>
        <source>Nat Methods</source>
        <year>2015</year>
        <volume>12</volume>
        <fpage>59</fpage>
        <lpage>60</lpage>
        <pub-id pub-id-type="doi">10.1038/nmeth.3176</pub-id>
        <?supplied-pmid 25402007?>
        <pub-id pub-id-type="pmid">25402007</pub-id>
      </element-citation>
    </ref>
    <ref id="CR26">
      <label>26.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Xia</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Shi</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Atoni</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Zhao</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Yuan</surname>
            <given-names>Z</given-names>
          </name>
        </person-group>
        <article-title>Comparative metagenomic profiling of viromes associated with four common mosquito species in China</article-title>
        <source>Virol Sin</source>
        <year>2018</year>
        <volume>33</volume>
        <fpage>59</fpage>
        <lpage>66</lpage>
        <pub-id pub-id-type="doi">10.1007/s12250-018-0015-4</pub-id>
        <?supplied-pmid 29500689?>
        <pub-id pub-id-type="pmid">29500689</pub-id>
      </element-citation>
    </ref>
    <ref id="CR27">
      <label>27.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Young</surname>
            <given-names>JM</given-names>
          </name>
          <name>
            <surname>Skvortsov</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Arkhipova</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Allen</surname>
            <given-names>CCR</given-names>
          </name>
        </person-group>
        <article-title>Draft genome sequence of the predatory marine bacterium Halobacteriovorax sp. strain JY17</article-title>
        <source>Genome Announc</source>
        <year>2018</year>
        <volume>6</volume>
        <fpage>593</fpage>
        <pub-id pub-id-type="doi">10.1128/genomeA.01416-17</pub-id>
      </element-citation>
    </ref>
    <ref id="CR28">
      <label>28.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kang</surname>
            <given-names>DD</given-names>
          </name>
          <name>
            <surname>Froula</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Egan</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>Z</given-names>
          </name>
        </person-group>
        <article-title>MetaBAT, an efficient tool for accurately reconstructing single genomes from complex microbial communities</article-title>
        <source>PeerJ PeerJ Inc</source>
        <year>2015</year>
        <volume>3</volume>
        <fpage>e1165</fpage>
        <pub-id pub-id-type="doi">10.7717/peerj.1165</pub-id>
      </element-citation>
    </ref>
    <ref id="CR29">
      <label>29.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Alneberg</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Bjarnason</surname>
            <given-names>BS</given-names>
          </name>
          <name>
            <surname>de Bruijn</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Schirmer</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Quick</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Ijaz</surname>
            <given-names>UZ</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Binning metagenomic contigs by coverage and composition</article-title>
        <source>Nat Methods</source>
        <year>2014</year>
        <volume>11</volume>
        <fpage>1144</fpage>
        <lpage>1146</lpage>
        <pub-id pub-id-type="doi">10.1038/nmeth.3103</pub-id>
        <pub-id pub-id-type="pmid">25218180</pub-id>
      </element-citation>
    </ref>
    <ref id="CR30">
      <label>30.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bao</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Lan</surname>
            <given-names>L</given-names>
          </name>
        </person-group>
        <article-title>HALC: high throughput algorithm for long read error correction</article-title>
        <source>BMC Bioinformatics.</source>
        <year>2017</year>
        <volume>18</volume>
        <fpage>204</fpage>
        <pub-id pub-id-type="doi">10.1186/s12859-017-1610-3</pub-id>
        <?supplied-pmid 28381259?>
        <pub-id pub-id-type="pmid">28381259</pub-id>
      </element-citation>
    </ref>
    <ref id="CR31">
      <label>31.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Koren</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Walenz</surname>
            <given-names>BP</given-names>
          </name>
          <name>
            <surname>Berlin</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Miller</surname>
            <given-names>JR</given-names>
          </name>
          <name>
            <surname>Bergman</surname>
            <given-names>NH</given-names>
          </name>
          <name>
            <surname>Phillippy</surname>
            <given-names>AM</given-names>
          </name>
        </person-group>
        <article-title>Canu: scalable and accurate long-read assembly via adaptive k-mer weighting and repeat separation</article-title>
        <source>Genome Res</source>
        <year>2017</year>
        <volume>27</volume>
        <fpage>722</fpage>
        <lpage>736</lpage>
        <pub-id pub-id-type="doi">10.1101/gr.215087.116</pub-id>
        <?supplied-pmid 28298431?>
        <pub-id pub-id-type="pmid">28298431</pub-id>
      </element-citation>
    </ref>
    <ref id="CR32">
      <label>32.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hyatt</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>G-L</given-names>
          </name>
          <name>
            <surname>Locascio</surname>
            <given-names>PF</given-names>
          </name>
          <name>
            <surname>Land</surname>
            <given-names>ML</given-names>
          </name>
          <name>
            <surname>Larimer</surname>
            <given-names>FW</given-names>
          </name>
          <name>
            <surname>Hauser</surname>
            <given-names>LJ</given-names>
          </name>
        </person-group>
        <article-title>Prodigal: prokaryotic gene recognition and translation initiation site identification</article-title>
        <source>BMC Bioinformatics.</source>
        <year>2010</year>
        <volume>11</volume>
        <fpage>119</fpage>
        <pub-id pub-id-type="doi">10.1186/1471-2105-11-119</pub-id>
        <?supplied-pmid 20211023?>
        <pub-id pub-id-type="pmid">20211023</pub-id>
      </element-citation>
    </ref>
    <ref id="CR33">
      <label>33.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Sayers</surname>
            <given-names>EW</given-names>
          </name>
          <name>
            <surname>Agarwala</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Bolton</surname>
            <given-names>EE</given-names>
          </name>
          <name>
            <surname>Brister</surname>
            <given-names>JR</given-names>
          </name>
          <name>
            <surname>Canese</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Clark</surname>
            <given-names>K</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Database resources of the National Center for Biotechnology Information</article-title>
        <source>Nucleic Acids Res</source>
        <year>2018</year>
        <volume>266</volume>
        <fpage>141</fpage>
      </element-citation>
    </ref>
    <ref id="CR34">
      <label>34.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Federhen</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>The NCBI taxonomy database</article-title>
        <source>Nucleic Acids Res</source>
        <year>2012</year>
        <volume>40</volume>
        <fpage>D136</fpage>
        <lpage>D143</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/gkr1178</pub-id>
        <pub-id pub-id-type="pmid">22139910</pub-id>
      </element-citation>
    </ref>
    <ref id="CR35">
      <label>35.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>O'Leary</surname>
            <given-names>NA</given-names>
          </name>
          <name>
            <surname>Wright</surname>
            <given-names>MW</given-names>
          </name>
          <name>
            <surname>Brister</surname>
            <given-names>JR</given-names>
          </name>
          <name>
            <surname>Ciufo</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Haddad</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>McVeigh</surname>
            <given-names>R</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Reference sequence (RefSeq) database at NCBI: current status, taxonomic expansion, and functional annotation</article-title>
        <source>Nucleic Acids Res</source>
        <year>2016</year>
        <volume>44</volume>
        <fpage>D733</fpage>
        <lpage>D745</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/gkv1189</pub-id>
        <pub-id pub-id-type="pmid">26553804</pub-id>
      </element-citation>
    </ref>
    <ref id="CR36">
      <label>36.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Leinonen</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Sugawara</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Shumway</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>International nucleotide sequence database collaboration. The sequence read archive</article-title>
        <source>Nucleic Acids Res</source>
        <year>2011</year>
        <volume>39</volume>
        <fpage>D19</fpage>
        <lpage>D21</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/gkq1019</pub-id>
        <?supplied-pmid 21062823?>
        <pub-id pub-id-type="pmid">21062823</pub-id>
      </element-citation>
    </ref>
    <ref id="CR37">
      <label>37.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Mokili</surname>
            <given-names>JL</given-names>
          </name>
          <name>
            <surname>Rohwer</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Dutilh</surname>
            <given-names>BE</given-names>
          </name>
        </person-group>
        <article-title>Metagenomics and future perspectives in virus discovery</article-title>
        <source>Curr Opin Virol</source>
        <year>2012</year>
        <volume>2</volume>
        <fpage>63</fpage>
        <lpage>77</lpage>
        <pub-id pub-id-type="doi">10.1016/j.coviro.2011.12.004</pub-id>
        <?supplied-pmid 22440968?>
        <pub-id pub-id-type="pmid">22440968</pub-id>
      </element-citation>
    </ref>
    <ref id="CR38">
      <label>38.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>King</surname>
            <given-names>AMQ</given-names>
          </name>
          <name>
            <surname>Lefkowitz</surname>
            <given-names>EJ</given-names>
          </name>
          <name>
            <surname>Mushegian</surname>
            <given-names>AR</given-names>
          </name>
          <name>
            <surname>Adams</surname>
            <given-names>MJ</given-names>
          </name>
          <name>
            <surname>Dutilh</surname>
            <given-names>BE</given-names>
          </name>
          <name>
            <surname>Gorbalenya</surname>
            <given-names>AE</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Changes to taxonomy and the international code of virus classification and nomenclature ratified by the International Committee on Taxonomy of Viruses (2018)</article-title>
        <source>Arch Virol Springer Vienna</source>
        <year>2018</year>
        <volume>163</volume>
        <fpage>2601</fpage>
        <lpage>2631</lpage>
        <pub-id pub-id-type="doi">10.1007/s00705-018-3847-1</pub-id>
      </element-citation>
    </ref>
    <ref id="CR39">
      <label>39.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Parks</surname>
            <given-names>DH</given-names>
          </name>
          <name>
            <surname>Chuvochina</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Waite</surname>
            <given-names>DW</given-names>
          </name>
          <name>
            <surname>Rinke</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Skarshewski</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Chaumeil</surname>
            <given-names>P-A</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>A standardized bacterial taxonomy based on genome phylogeny substantially revises the tree of life</article-title>
        <source>Nature Biotechnol</source>
        <year>2018</year>
        <volume>36</volume>
        <fpage>10</fpage>
        <pub-id pub-id-type="doi">10.1038/nbt.4229</pub-id>
        <pub-id pub-id-type="pmid">29319692</pub-id>
      </element-citation>
    </ref>
    <ref id="CR40">
      <label>40.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wattam</surname>
            <given-names>AR</given-names>
          </name>
          <name>
            <surname>Davis</surname>
            <given-names>JJ</given-names>
          </name>
          <name>
            <surname>Assaf</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Boisvert</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Brettin</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Bun</surname>
            <given-names>C</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Improvements to PATRIC, the all-bacterial bioinformatics database and analysis resource center</article-title>
        <source>Nucleic Acids Res</source>
        <year>2017</year>
        <volume>45</volume>
        <fpage>D535</fpage>
        <lpage>D542</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/gkw1017</pub-id>
        <?supplied-pmid 27899627?>
        <pub-id pub-id-type="pmid">27899627</pub-id>
      </element-citation>
    </ref>
    <ref id="CR41">
      <label>41.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Sievers</surname>
            <given-names>Fabian</given-names>
          </name>
          <name>
            <surname>Wilm</surname>
            <given-names>Andreas</given-names>
          </name>
          <name>
            <surname>Dineen</surname>
            <given-names>David</given-names>
          </name>
          <name>
            <surname>Gibson</surname>
            <given-names>Toby J</given-names>
          </name>
          <name>
            <surname>Karplus</surname>
            <given-names>Kevin</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>Weizhong</given-names>
          </name>
          <name>
            <surname>Lopez</surname>
            <given-names>Rodrigo</given-names>
          </name>
          <name>
            <surname>McWilliam</surname>
            <given-names>Hamish</given-names>
          </name>
          <name>
            <surname>Remmert</surname>
            <given-names>Michael</given-names>
          </name>
          <name>
            <surname>Söding</surname>
            <given-names>Johannes</given-names>
          </name>
          <name>
            <surname>Thompson</surname>
            <given-names>Julie D</given-names>
          </name>
          <name>
            <surname>Higgins</surname>
            <given-names>Desmond G</given-names>
          </name>
        </person-group>
        <article-title>Fast, scalable generation of high‐quality protein multiple sequence alignments using Clustal Omega</article-title>
        <source>Molecular Systems Biology</source>
        <year>2011</year>
        <volume>7</volume>
        <issue>1</issue>
        <fpage>539</fpage>
        <pub-id pub-id-type="doi">10.1038/msb.2011.75</pub-id>
        <?supplied-pmid 21988835?>
        <pub-id pub-id-type="pmid">21988835</pub-id>
      </element-citation>
    </ref>
    <ref id="CR42">
      <label>42.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Nguyen</surname>
            <given-names>L-T</given-names>
          </name>
          <name>
            <surname>Schmidt</surname>
            <given-names>HA</given-names>
          </name>
          <name>
            <surname>Haeseler</surname>
            <given-names>v A</given-names>
          </name>
          <name>
            <surname>Minh</surname>
            <given-names>BQ</given-names>
          </name>
        </person-group>
        <article-title>IQ-TREE: a fast and effective stochastic algorithm for estimating maximum-likelihood phylogenies</article-title>
        <source>Mol Biol Evol</source>
        <year>2015</year>
        <volume>32</volume>
        <fpage>268</fpage>
        <lpage>274</lpage>
        <pub-id pub-id-type="doi">10.1093/molbev/msu300</pub-id>
        <pub-id pub-id-type="pmid">25371430</pub-id>
      </element-citation>
    </ref>
    <ref id="CR43">
      <label>43.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kalyaanamoorthy</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Minh</surname>
            <given-names>BQ</given-names>
          </name>
          <name>
            <surname>Wong</surname>
            <given-names>TKF</given-names>
          </name>
          <name>
            <surname>Haeseler</surname>
            <given-names>v A</given-names>
          </name>
          <name>
            <surname>Jermiin</surname>
            <given-names>LS</given-names>
          </name>
        </person-group>
        <article-title>ModelFinder: fast model selection for accurate phylogenetic estimates</article-title>
        <source>Nat Methods</source>
        <year>2017</year>
        <volume>14</volume>
        <fpage>587</fpage>
        <lpage>589</lpage>
        <pub-id pub-id-type="doi">10.1038/nmeth.4285</pub-id>
        <?supplied-pmid 28481363?>
        <pub-id pub-id-type="pmid">28481363</pub-id>
      </element-citation>
    </ref>
    <ref id="CR44">
      <label>44.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hoang</surname>
            <given-names>DT</given-names>
          </name>
          <name>
            <surname>Chernomor</surname>
            <given-names>O</given-names>
          </name>
          <name>
            <surname>Haeseler</surname>
            <given-names>v A</given-names>
          </name>
          <name>
            <surname>Minh</surname>
            <given-names>BQ</given-names>
          </name>
          <name>
            <surname>Vinh</surname>
            <given-names>LS</given-names>
          </name>
        </person-group>
        <article-title>UFBoot2: improving the ultrafast bootstrap approximation</article-title>
        <source>Mol Biol Evol</source>
        <year>2018</year>
        <volume>35</volume>
        <fpage>518</fpage>
        <lpage>522</lpage>
        <pub-id pub-id-type="doi">10.1093/molbev/msx281</pub-id>
        <?supplied-pmid 29077904?>
        <pub-id pub-id-type="pmid">29077904</pub-id>
      </element-citation>
    </ref>
    <ref id="CR45">
      <label>45.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Letunic</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Bork</surname>
            <given-names>P</given-names>
          </name>
        </person-group>
        <article-title>Interactive tree of life (iTOL) v3: an online tool for the display and annotation of phylogenetic and other trees</article-title>
        <source>Nucleic Acids Res</source>
        <year>2016</year>
        <volume>44</volume>
        <fpage>W242</fpage>
        <lpage>W245</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/gkw290</pub-id>
        <?supplied-pmid 27095192?>
        <pub-id pub-id-type="pmid">27095192</pub-id>
      </element-citation>
    </ref>
    <ref id="CR46">
      <label>46.</label>
      <mixed-citation publication-type="other">von Meijenfeldt FAB, Arkhipova K, Cambuy DD, Coutinho FH, Dutilh BE. CAT/BAT: tool for taxonomic classification of contigs and metagenome-assembled genomes (MAGs): GitHub. <ext-link ext-link-type="uri" xlink:href="https://github.com/dutilh/CAT">https://github.com/dutilh/CAT</ext-link>; 2019.</mixed-citation>
    </ref>
    <ref id="CR47">
      <label>47.</label>
      <mixed-citation publication-type="other">von Meijenfeldt FAB, Arkhipova K, Cambuy DD, Coutinho FH, Dutilh BE. CAT/BAT: tool for taxonomic classification of contigs and metagenome-assembled genomes (MAGs) (version v5.0.1): Zenodo; 2019. 10.5281/zenodo.3403695.</mixed-citation>
    </ref>
  </ref-list>
</back>
