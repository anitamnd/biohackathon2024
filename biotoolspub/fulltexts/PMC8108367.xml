<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName A++V2.4.dtd?>
<?SourceDTD.Version 2.4?>
<?ConverterInfo.XSLTName springer2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Genome Biol</journal-id>
    <journal-id journal-id-type="iso-abbrev">Genome Biol</journal-id>
    <journal-title-group>
      <journal-title>Genome Biology</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1474-7596</issn>
    <issn pub-type="epub">1474-760X</issn>
    <publisher>
      <publisher-name>BioMed Central</publisher-name>
      <publisher-loc>London</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">8108367</article-id>
    <article-id pub-id-type="publisher-id">2362</article-id>
    <article-id pub-id-type="doi">10.1186/s13059-021-02362-7</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Method</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>SpatialDWLS: accurate deconvolution of spatial transcriptomic data</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Dong</surname>
          <given-names>Rui</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-2283-4714</contrib-id>
        <name>
          <surname>Yuan</surname>
          <given-names>Guo-Cheng</given-names>
        </name>
        <address>
          <email>guo-cheng.yuan@mssm.edu</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff3">3</xref>
      </contrib>
      <aff id="Aff1"><label>1</label><institution-wrap><institution-id institution-id-type="GRID">grid.38142.3c</institution-id><institution-id institution-id-type="ISNI">000000041936754X</institution-id><institution>Department of Pediatric Oncology, Dana-Farber Cancer Institute, </institution><institution>Harvard Medical School, </institution></institution-wrap>Boston, MA 02215 USA </aff>
      <aff id="Aff2"><label>2</label><institution-wrap><institution-id institution-id-type="GRID">grid.38142.3c</institution-id><institution-id institution-id-type="ISNI">000000041936754X</institution-id><institution>Massachusetts General Hospital Cancer Center, </institution><institution>Harvard Medical School, </institution></institution-wrap>Charlestown, MA 02129 USA </aff>
      <aff id="Aff3"><label>3</label><institution-wrap><institution-id institution-id-type="GRID">grid.59734.3c</institution-id><institution-id institution-id-type="ISNI">0000 0001 0670 2351</institution-id><institution>Department of Genetics and Genomic Sciences, Charles Bronfman Institute for Personalized Medicine, </institution><institution>Icahn School of Medicine at Mount Sinai, </institution></institution-wrap>New York, NY 10029 USA </aff>
    </contrib-group>
    <pub-date pub-type="epub">
      <day>10</day>
      <month>5</month>
      <year>2021</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>10</day>
      <month>5</month>
      <year>2021</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2021</year>
    </pub-date>
    <volume>22</volume>
    <elocation-id>145</elocation-id>
    <history>
      <date date-type="received">
        <day>14</day>
        <month>2</month>
        <year>2021</year>
      </date>
      <date date-type="accepted">
        <day>23</day>
        <month>4</month>
        <year>2021</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2021</copyright-statement>
      <license>
        <ali:license_ref specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p><bold>Open Access</bold>This article is licensed under a Creative Commons Attribution 4.0 International License, which permits use, sharing, adaptation, distribution and reproduction in any medium or format, as long as you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons licence, and indicate if changes were made. The images or other third party material in this article are included in the article's Creative Commons licence, unless indicated otherwise in a credit line to the material. If material is not included in the article's Creative Commons licence and your intended use is not permitted by statutory regulation or exceeds the permitted use, you will need to obtain permission directly from the copyright holder. To view a copy of this licence, visit <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>. The Creative Commons Public Domain Dedication waiver (<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/publicdomain/zero/1.0/">http://creativecommons.org/publicdomain/zero/1.0/</ext-link>) applies to the data made available in this article, unless otherwise stated in a credit line to the data.</license-p>
      </license>
    </permissions>
    <abstract id="Abs1">
      <p id="Par1">Recent development of spatial transcriptomic technologies has made it possible to characterize cellular heterogeneity with spatial information. However, the technology often does not have sufficient resolution to distinguish neighboring cell types. Here, we present spatialDWLS, to quantitatively estimate the cell-type composition at each spatial location. We benchmark the performance of spatialDWLS by comparing it with a number of existing deconvolution methods and find that spatialDWLS outperforms the other methods in terms of accuracy and speed. By applying spatialDWLS to a human developmental heart dataset, we observe striking spatial temporal changes of cell-type composition during development.</p>
      <sec>
        <title>Supplementary Information</title>
        <p>The online version contains supplementary material available at 10.1186/s13059-021-02362-7.</p>
      </sec>
    </abstract>
    <kwd-group xml:lang="en">
      <title>Keywords</title>
      <kwd>Spatial transcriptomics</kwd>
      <kwd>Single cell</kwd>
      <kwd>Deconvolution</kwd>
    </kwd-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100000052</institution-id>
            <institution>NIH Office of the Director</institution>
          </institution-wrap>
        </funding-source>
        <award-id>UH3HL145609</award-id>
        <principal-award-recipient>
          <name>
            <surname>Yuan</surname>
            <given-names>Guo-Cheng</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100000049</institution-id>
            <institution>National Institute on Aging</institution>
          </institution-wrap>
        </funding-source>
        <award-id>R01AG066028</award-id>
        <principal-award-recipient>
          <name>
            <surname>Yuan</surname>
            <given-names>Guo-Cheng</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
    </funding-group>
    <custom-meta-group>
      <custom-meta>
        <meta-name>issue-copyright-statement</meta-name>
        <meta-value>© The Author(s) 2021</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec id="Sec1">
    <title>Background</title>
    <p id="Par2">Rapid development in spatial transcriptomics has enabled systematic characterization of cellular heterogeneity while preserving spatial context [<xref ref-type="bibr" rid="CR1">1</xref>–<xref ref-type="bibr" rid="CR6">6</xref>]. Compared to the commonly-used single-cell RNA-seq technology, the main advantage of spatial transcriptomic technologies is that they can be used to profile gene expression in a small number of or even single cells while preserving spatial information. This is crucial for mapping the structural organization of tissues and facilitates mechanistic studies of cell-environment interactions. On the other hand, identifying the spatial distributions of various cell types can be challenging, since many existing methods do not have single-cell resolution, such as Spatial Transcriptomics [<xref ref-type="bibr" rid="CR4">4</xref>], 10X Genomics Visium, Slide-seq [<xref ref-type="bibr" rid="CR2">2</xref>], DBiT-seq [<xref ref-type="bibr" rid="CR6">6</xref>], and Nanostring GeoMx. This is an important barrier for data analysis and interpretation which limits the utility of these technologies. Therefore, it is desirable to develop computational methods to infer the composition of cell types at each location, a task that is often referred to as cell-type deconvolution.</p>
    <p id="Par3">A number of methods have been developed for deconvolving bulk RNAseq data [<xref ref-type="bibr" rid="CR7">7</xref>–<xref ref-type="bibr" rid="CR13">13</xref>]. In principle, these methods can be directly applied to spatial expression analysis as well, treating the data from each location as a bulk sample. However, there are two main limitations for this approach. First, the number of cells within each spot is typically small. For example, each spot in the 10X Genomics Visium platform has the diameter of 55 μm, corresponding to a spatial resolution of 5–10 cells. The application of a bulk RNAseq deconvolution method to such a small sample size would result in noise from unrelated cell types. Second, as spatial expression datasets usually contain thousands of spots, it would be time and memory consuming if deconvolution methods designed for bulk RNA-seq are applied on spatial expression datasets. Recently, several methods have been developed specifically for spatial transcriptomic data deconvolution [<xref ref-type="bibr" rid="CR14">14</xref>–<xref ref-type="bibr" rid="CR16">16</xref>]. Here, we introduce a novel method spatialDWLS for this task and benchmark with existing methods.</p>
  </sec>
  <sec id="Sec2">
    <title>Results</title>
    <sec id="Sec3">
      <title>Overview of spatialDWLS</title>
      <p id="Par4">SpatialDWLS is an extension of dampened weighted least squares (DWLS) [<xref ref-type="bibr" rid="CR9">9</xref>], which we developed previously for deconvolution of RNAseq data. In short, DWLS uses a weighted least squares approach to infer cell-type composition, where the weight is selected to minimize the overall relative error rate. Because only a small number of cell types may be associated with a specific location, we combine a recently developed cell-type enrichment analysis method [<xref ref-type="bibr" rid="CR17">17</xref>] to enhance specificity. In a nutshell, spatialDWLS contains two steps (Fig. <xref rid="Fig1" ref-type="fig">1</xref>a). First, it identifies cell types that likely to be present at each location [<xref ref-type="bibr" rid="CR17">17</xref>]. Second, the cell type composition at each location is inferred by applying DWLS to infer the fraction of each selected cell type [<xref ref-type="bibr" rid="CR9">9</xref>]. The details are described in the “Methods” section.
<fig id="Fig1"><label>Fig. 1</label><caption><p>An overview of the spatialDWLS method. <bold>a</bold> A schematic representation of the spatialDWLS workflow. The input contains a spatial transcriptomic dataset (gene expression matrix and cell location coordinates) and a set of known cell-type specific gene signatures. For each spot, the cell types that are likely to be present are identified by using cell-type enrichment analysis. Then, a modified DWLS method is applied to infer cell type position at each spot. <bold>b</bold> Comparison of the accuracy of different deconvolution methods. Single-cell resolution seqFISH+ data are coarse-grain averaged to generate lower-resolution spatial transcriptomic data. The true frequency of a cell-type (indicated as blue squares in the top left panel) at each spot is compared with the inferred frequency (indicated as red squares in the five other panels) by using different methods. The relationship is also represented as a scatter plot, with <italic>x</italic>-axis representing the true frequency and the <italic>y</italic>-axis representing the inferred frequency. The overall performance is quantified as the root mean square error (RMSE). The oligodendrocyte cell-type is used here as a representative example. <bold>c</bold> The overall RMSE error is further decomposed into two components, corresponding to regions where the cell type is absent (red) and present (green), respectively. <bold>d</bold> Comparison of the computing speed of different methods. Running times for analyzing a mouse brain Visium dataset are shown</p></caption><graphic xlink:href="13059_2021_2362_Fig1_HTML" id="MO1"/></fig></p>
    </sec>
    <sec id="Sec4">
      <title>Evaluation and benchmarks of spatialDWLS</title>
      <p id="Par5">To evaluate the performance of spatialDWLS, we created a simulated spatial transcriptomic dataset based on coarse-graining average of single-cell resolution data. Specifically, we analyzed a public seqFISH+ dataset [<xref ref-type="bibr" rid="CR1">1</xref>], which contains the expression profile of 10,000 genes in 523 cells from the mouse somatosensory cortex at the single-cell resolution. To mimic the outcome of a lower-resolution profiling strategy, we divided each field of view (FOV) into squared spots of ~ 51.5 μm on each side and aggregated the transcript counts that fell into each spot. On average, about seven cells are included in each spot. The resulting dataset has a total number of 71 spots, each covering an average of 7.3 cells. The original dataset serves as the ground-truth for benchmarking.</p>
      <p id="Par6">To apply spatialDWLS, we obtained cell-type specific gene signatures from a publicly available single-cell RNAseq (scRNAseq) dataset [<xref ref-type="bibr" rid="CR18">18</xref>]. In total, this dataset contains 1691 cells and 6 major cell types are identified. Based on the scRNAseq derived cell-type gene signatures, we applied spatialDWLS to deconvolve the above simulated dataset. The cell-type percentage at each location varies from 5.9 to 100%.</p>
      <p id="Par7">To evaluate the performance of our spatialDWLS method, we compared the predicted and true cell type proportion and found good agreement overall (Fig. <xref rid="Fig1" ref-type="fig">1</xref>b–c and Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S1a-b). For example, the root mean square error (RMSE) associated with oligodendrocytes is only 0.03 with the predicted values approximately center around ground-truth (Fig. <xref rid="Fig1" ref-type="fig">1</xref>b). In order to separately evaluate the sensitivity and specificity, we divided the simulated spots into subsets where the cell type was present or absent and evaluated the RMSE errors for each subset. The fact that both errors have small magnitude indicates spatialDWLS has both high degrees of sensitivity and specificity (Fig. <xref rid="Fig1" ref-type="fig">1</xref>c). As a benchmark, we applied four published deconvolution methods, including MuSiC [<xref ref-type="bibr" rid="CR8">8</xref>], RCTD [<xref ref-type="bibr" rid="CR14">14</xref>], SPOTlight [<xref ref-type="bibr" rid="CR15">15</xref>], and stereoscope [<xref ref-type="bibr" rid="CR16">16</xref>] to analyze the same dataset. All the other methods led to higher error (Fig. <xref rid="Fig1" ref-type="fig">1</xref>b, Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S1a, b), although the differences with MuSiC and RCTD appear modest.</p>
      <p id="Par8">Next, we applied spatialDWLS to analyze a 10X Genomics Visium dataset mapping the spatial transcriptomic profile in mouse brain. This dataset contains 2698 spatially barcoded circular spots each 55 μm in diameter. To comprehensively deconvolve cell type composition, we used the mouse nervous system atlas scRNAseq data as a reference [<xref ref-type="bibr" rid="CR19">19</xref>], which contains gene expression signature of 21 major cell types. While it is impossible to quantify the prediction accuracy because the ground-truth is unknown, the resulting spatial distributions are highly consistent with the mouse Allen Brain Atlas (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S2a, b). For example, the peptidergic cells were correctly mapped to the hypothalamus region; the granule neurons were correctly mapped to the dentate gyrus region, and the medium spiny neurons were correctly mapped to the basal ganglia (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S2a, b).</p>
      <p id="Par9">The spatialDWLS analysis took 23 min CPU time on a small computer cluster (Intel Xeon CPU E5-2650 32 processors 2.00GHz and 380Gb memory). To compare the computational efficiency of different methods, we applied each of the other methods to analyze the same dataset using the same computer. Furthermore, to assess scalability we subsampled the mouse brain dataset varying from 500 to 2000 spots and examined the relationship between CPU time and sample size. We found that spatialDWLS and MuSiC were more computationally efficient, each taking about 23 min CPU time to analyze the 2000-spot dataset. In comparison, both RCTD and SPOTlight were about 2 times slower for the larger sample size, whereas stereoscope was at least 10 times slower (Fig. <xref rid="Fig1" ref-type="fig">1</xref>d). Taken together, these analyses suggest spatialDWLS is more accurate and computationally efficient than these other methods.</p>
    </sec>
    <sec id="Sec5">
      <title>Apply spatialDWLS on human heart spatial transcriptomic dataset</title>
      <p id="Par10">During embryonic development, the spatial-temporal distribution of cell types changes dramatically. Therefore, it is of interest to test whether spatialDWLS could aid the discovery of such dynamic changes. Recently, Asp and colleagues studied the development of human heart in early embryos (4.5–5, 6.5, and 9 post-conception weeks) by using the Spatial Transcriptomics (ST) technology [<xref ref-type="bibr" rid="CR20">20</xref>] (Fig. <xref rid="Fig2" ref-type="fig">2</xref>a). Since the data does not have single-cell resolution, they were not able to identify cell-type distribution directly from the ST data. In order to apply spatialDWLS, we utilized the scRNAseq derived gene signatures from this study as reference. All the cell types were mapped to expected locations (Fig. <xref rid="Fig2" ref-type="fig">2</xref>b and Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S3a-c).
<fig id="Fig2"><label>Fig. 2</label><caption><p>Deconvolution analysis identifies spatial-temporal change of cell-type composition during human heart development. <bold>a</bold> A schematic overview of the analysis. Spatial Transcriptomic data for developing heart were collected at three developmental stages by Asp et al. 2019. In parallel, single-cell RNAseq analysis was carried out to identify cell-type specific gene signatures. The spatialDWLS method was applied to infer the distribution of different cell-types across developmental stages. <bold>b</bold> The resulting estimates of the spatial distribution of different cell types. One representative sample was selected from each developmental stage. <bold>c</bold> A summary of the cell-type composition for all samples grouped by the corresponding developmental stages. <bold>d</bold> The assortativity analysis indicates an increased level of spatial clustering among similar cell types during heart development</p></caption><graphic xlink:href="13059_2021_2362_Fig2_HTML" id="MO2"/></fig></p>
      <p id="Par11">In order to quantitatively compare the change of spatial-temporal organization of cell type composition during embryonic heart development, we first examined the overall abundance of different cell types (Fig. <xref rid="Fig2" ref-type="fig">2</xref>c). We found that the abundance of ventricular cardiomyocytes increases dramatically during development (from an average of 25% in weeks 4.5–5 to 53% in week 9) (Fig. <xref rid="Fig2" ref-type="fig">2</xref>c). Notably, the abundance of atrial cardiomyocytes does not show this trend, which probably reflects the atrium compartments expand less dramatically compared to the ventricle compartments. Next, we compared the spatial organization patterns across developmental stages. Normal heart function relies on the coordinated activity of billions of cardiac cells; therefore, we were interested to test whether spatially neighboring cells tend to belong to the same cell type. This is quantified by using a metric called the assortativity coefficient [<xref ref-type="bibr" rid="CR21">21</xref>], which is commonly used in social network analysis to characterize the tendency of friendship formed by similar individuals. In the current context, we considered the spatial network connecting neighboring cells. We further modified the definition of assortativity coefficient in order to account for the cellular heterogeneity within each spot location (see the “Methods” section for details). We found that the assortativity coefficient increased from 0.23 at weeks 4.5–5 to 0.50 at week 9 (Fig. <xref rid="Fig2" ref-type="fig">2</xref>d), suggesting the spatial organization becomes increasingly spatially coherent during heart development.</p>
    </sec>
  </sec>
  <sec id="Sec6">
    <title>Conclusions</title>
    <p id="Par12">SpatialDWLS is an accurate and computationally efficient method for estimating the spatial distribution of cell types from spatial transcriptomic data. Thus, it provides a valuable enabling toolkit for investigating cell-cell interactions from various spatial transcriptomic technology platforms that do not have single-cell resolution. Compared to existing deconvolution methods [<xref ref-type="bibr" rid="CR7">7</xref>–<xref ref-type="bibr" rid="CR16">16</xref>], the key difference is spatialDWLS contains an additional filtering step to remove irrelevant cell-types thereby enhancing specificity. The spatialDWLS method can be easily accessed in Giotto [<xref ref-type="bibr" rid="CR17">17</xref>], which is a user-friendly software package containing a large number of computational tools for spatial transcriptomic data analysis and visualization.</p>
  </sec>
  <sec id="Sec7">
    <title>Methods</title>
    <sec id="Sec8">
      <title>Cell type selection of spatial expression data by enrichment analysis</title>
      <p id="Par13">We use an enrichment based weighted least squares approach for deconvolution of spatial expression datasets. First, enrichment analysis using Parametric Analysis of Gene Set Enrichment (PAGE) method [<xref ref-type="bibr" rid="CR22">22</xref>] is applied on spatial expression dataset as previously reported [<xref ref-type="bibr" rid="CR17">17</xref>]. The marker genes can be identified via differential expression gene analysis of Giotto based on the scRNAseq data provided by users. Alternatively, users can also provide marker gene expression for each cell type for deconvolution. The number of cell-type specific marker genes is denoted by <italic>m</italic>. For each gene, we calculate the fold change as the ratio between its expression value at each spot and the mean expression of all spots. The mean fold change of the <italic>m</italic> marker genes is calculated and denoted as <italic>S</italic><sub><italic>m</italic></sub>. As background control, the mean and standard deviation of the fold change values across all genes are denoted as μ and δ, respectively. The enrichment score (ES) is defined as follows:
<disp-formula id="Equa"><alternatives><tex-math id="M1">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ \mathrm{ES}=\frac{\left({S}_m-\mu \right)\ast \sqrt{m}}{\delta } $$\end{document}</tex-math><mml:math id="M2" display="block"><mml:mi>ES</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mi>S</mml:mi><mml:mi>m</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:mi>μ</mml:mi></mml:mrow></mml:mfenced><mml:mo>∗</mml:mo><mml:msqrt><mml:mi>m</mml:mi></mml:msqrt></mml:mrow><mml:mi>δ</mml:mi></mml:mfrac></mml:math><graphic xlink:href="13059_2021_2362_Article_Equa.gif" position="anchor"/></alternatives></disp-formula></p>
      <p id="Par14">Then, we binarize the enrichment matrix with the cutoff value of ES = 2 to select cell types that are likely to be present at each point.</p>
    </sec>
    <sec id="Sec9">
      <title>Estimating cell type composition by using a weighted least squares approach</title>
      <p id="Par15">In previous work, we developed DWLS [<xref ref-type="bibr" rid="CR9">9</xref>] for deconvolution of scRNAseq data. This method is extended here to deconvolve spatial transcriptomic data using the signature gene identification step described above. In short, DWLS uses a weighted least squares approach to infer cell-type composition, where the weight is selected to minimize the overall relative error rate. In addition, a damping constant <italic>d</italic> is used to enhance numerical stability, whose value is determined by using a cross-validation procedure. Here, we use the same sets of weights and damping constant across spots within same clusters to reduce technical variation. Finally, since the number of cells present at each spot is generally small, we perform another round deconvolution after removing those cell types that are predicted to present at a low frequency by imposing an additional thresholding (min frequency = 0.02 by default).</p>
    </sec>
    <sec id="Sec10">
      <title>Coarse-grained spatial transcriptomic data for model performance evaluation</title>
      <p id="Par16">The somatosensory cortex seqFISH+ data were abstained from <ext-link ext-link-type="uri" xlink:href="https://github.com/CaiGroup/seqFISH-PLUS">https://github.com/CaiGroup/seqFISH-PLUS</ext-link>. To simulate spot-like data, we defined the square with 500 pixels time 500 pixels (~ 51.5 μm) as one spot-like region. Then, average expression level was calculated for each spot-like region. Due to the small sample size, we only considered the 6 major clusters: excitatory neurons (eNeuron), inhibitory neurons (iNeuron), astrocytes, oligodendrocytes (Olig), microglia cells, and endothelial-mural cells (endo_mural).</p>
    </sec>
    <sec id="Sec11">
      <title>Benchmark comparison among different methods</title>
      <p id="Par17">Coarse-grained seqFISH+ dataset was used for benchmarking the accuracy of different deconvolution methods, including spatialDWLS, MuSiC, RCTD, SPOTlight, and stereoscope. For each published method, the default parameter setting was used for comparison. If the users are required to set parameters manually, we used the values suggested in the vignettes of the corresponding software. Cell-type annotations for the original, single-cell resolution data were used as the ground-truth. All five methods used the same scRNA-seq dataset as a reference in deconvolution.</p>
      <p id="Par18">For spatialDWLS, we clustered the spot-like regions by using Leiden clustering as implemented in Giotto (Version 1.0.3) by using the following commands <italic>createNearestNetwork(dimensions_to_use = 1:10, k = 4)</italic> and <italic>doLeidenCluster(resolution = 0.4, n_iterations = 1000)</italic>.</p>
      <p id="Par20">Then, marker genes of major clusters were identified by using the <italic>findMarkers_one_vs_all</italic> function with parameter setting: <italic>method = ‘gini’, expression_values = ‘normalized’</italic>. Top 100 ranked genes for each cell type were selected as marker genes. Average marker gene expression was calculated based on the cell type annotation of scRNA-seq. Then, deconvolution was applied by using the <italic>runDWLSDeconv</italic> function.</p>
      <p id="Par21">MuSiC [<xref ref-type="bibr" rid="CR8">8</xref>] (version 0.1.1) was used for deconvolution by using whole single cell RNA-seq matrix. <italic>ExpressionSet</italic> classes were generated for both single cell RNA-seq (<italic>SC.eset</italic>) and spatial expression datasets (<italic>ST.eset</italic>). Then, cell type proportion was estimated by using <italic>music_prop(bulk.eset = ST.eset, sc.eset = SC.eset).</italic></p>
      <p id="Par22">Then, to perform deconvolution by using SPOTlight [<xref ref-type="bibr" rid="CR15">15</xref>] (version 0.1.0), signature genes were identified based on the major cell type annotation by using <italic>Seurat::FindAllMarkers(logfc.threshold = 1, min.pct = 0.9).</italic></p>
      <p id="Par23">Deconvolution was performed by using <italic>spotlight_deconvolution(se_sc = SC, counts_spatial = ST, cluster_markers = cluster_markers_all, clust_vr = “label”).</italic></p>
      <p id="Par24">Next, we used stereoscope [<xref ref-type="bibr" rid="CR16">16</xref>] (version 0.2.0) for the deconvolution of simulated dataset. Deconvolution was performed with the parameter: <italic>stereoscope run -scc SC.tsv -scl cell_labels.tsv -stc ST.tsv -sce 5000.</italic></p>
      <p id="Par25">Finally, we used RCTD [<xref ref-type="bibr" rid="CR14">14</xref>] (version 1.1.0) to evaluate the cell type composition for simulated seqFISH+ dataset. Signature genes were identified by using “<italic>dgeToSeurat</italic>,” and then “<italic>create.RCTD</italic>” and “run.RCTD” were used to decompose the cell type composition. Finally, cell type percentage for each spot was calculated using the “<italic>sweep</italic>” function.</p>
      <p id="Par26">The computational efficiency of different methods was benchmarked by using the Visium brain dataset. All analyses were done on the same computer, which had Intel Xeon CPU E5-2650 2.00GHz and 380Gb memory. Of note, the Visium data cannot be used to evaluate accuracy because the ground-truth is not known.</p>
    </sec>
    <sec id="Sec12">
      <title>Root mean square error (RMSE) calculation</title>
      <p id="Par27">Based on the cell type annotation of seqFISH+ dataset, we calculated the true cell type percentage for simulated spatial expression datasets. For a specific cell type, we divided spot-like regions into two groups based on the presence or absence of this cell type. RMSEs were calculated separately for these two groups.</p>
    </sec>
    <sec id="Sec13">
      <title>Analysis of a spatial transcriptomic dataset from the mouse brain</title>
      <p id="Par28">The Visium dataset was obtained from the 10X Genomics website (<ext-link ext-link-type="uri" xlink:href="https://support.10xgenomics.com/spatial-gene-expression/datasets/1.1.0/V1_Adult_Mouse_Brain">https://support.10xgenomics.com/spatial-gene-expression/datasets/1.1.0/V1_Adult_Mouse_Brain</ext-link>), which corresponds to a coronal section of the mouse brain. Then, Giotto was used for data analysis as (<ext-link ext-link-type="uri" xlink:href="http://www.spatialgiotto.com/giotto.visium.brain.html">http://www.spatialgiotto.com/giotto.visium.brain.html</ext-link>). Only spots within tissue were kept for further analysis. Then, we filtered out low quality spots and genes by using filterGiotto with the parameter: <italic>expression_threshold = 1, gene_det_in_min_cells = 50, min_det_genes_per_cell = 1000</italic>.</p>
      <p id="Par29">After normalization and highly variable gene calculation, we performed neighborhood analysis with parameter: <italic>createNearestNetwork (dimensions_to_use = 1:10, k = 15)</italic> and clustered spots with the parameter: <italic>doLeidenCluster(resolution = 0.4, n_iterations = 1000)</italic>. Finally, we used marker genes and scRNA-seq reported in Zeisel et al. [<xref ref-type="bibr" rid="CR18">18</xref>] to deconvolute the Visium dataset.</p>
    </sec>
    <sec id="Sec14">
      <title>Analysis of a spatial transcriptomic dataset from developing human heart</title>
      <p id="Par30">The human heart spatial transcriptomics datasets were obtained from [<xref ref-type="bibr" rid="CR20">20</xref>]. Then, we filtered out low quality spots and genes by using filterGiotto with the parameter: <italic>expression_threshold = 1, gene_det_in_min_cells = 10, min_det_genes_per_cell = 200</italic>.</p>
      <p id="Par31">After normalization and highly variable gene detection, we performed neighborhood analysis with theparameter: <italic>createNearestNetwork(dimensions_to_use = 1:10, k = 10)</italic> and clustered spots with the parameter: <italic>doLeidenCluster(resolution = 0.4, n_iterations = 1000)</italic>.</p>
      <p id="Par33">In addition, we use the scRNA-seq data from the same website with spatial transcriptomics datasets. Based on the clusters reported, we re-analyzed signature genes by using Giotto with the parameter: <italic>findMarkers_one_vs_all(method = 'scran')</italic>.</p>
      <p id="Par34">The average expression of marker genes was used for the deconvolution of heart ST datasets.</p>
    </sec>
    <sec id="Sec15">
      <title>Assortativity analysis</title>
      <p id="Par35">To evaluate the degree of spatial coherence, we extended the assortativity analysis [<xref ref-type="bibr" rid="CR21">21</xref>], a method commonly used in the network analysis to evaluate the tendency of similar networks nodes are connected to each other. Here, we generated a spatial network by connecting spots that are immediately next to each other. The assortativity coefficient represents the normalized deviation of edges connecting the same cell type than expected by chance. More precisely, it is defined by the following formula:
<disp-formula id="Equi"><alternatives><tex-math id="M3">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ Q=\frac{\sum_k{q}_{kk}-{\sum}_k{a}_k^2}{1-{\sum}_k{a}_k^2} $$\end{document}</tex-math><mml:math id="M4" display="block"><mml:mi>Q</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mo>∑</mml:mo><mml:mi>k</mml:mi></mml:msub><mml:msub><mml:mi>q</mml:mi><mml:mi mathvariant="italic">kk</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mo>∑</mml:mo><mml:mi>k</mml:mi></mml:msub><mml:msubsup><mml:mi>a</mml:mi><mml:mi>k</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msub><mml:mo>∑</mml:mo><mml:mi>k</mml:mi></mml:msub><mml:msubsup><mml:mi>a</mml:mi><mml:mi>k</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:mfrac></mml:math><graphic xlink:href="13059_2021_2362_Article_Equi.gif" position="anchor"/></alternatives></disp-formula></p>
      <p id="Par36">where
<disp-formula id="Equj"><alternatives><tex-math id="M5">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {q}_{kk}=\frac{\sum_i{\sum}_j{w}_k^i{w}_k^j{e}_{ij}}{\sum_i{\sum}_j{e}_{ij}} $$\end{document}</tex-math><mml:math id="M6" display="block"><mml:msub><mml:mi>q</mml:mi><mml:mi mathvariant="italic">kk</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mo>∑</mml:mo><mml:mi>i</mml:mi></mml:msub><mml:msub><mml:mo>∑</mml:mo><mml:mi>j</mml:mi></mml:msub><mml:msubsup><mml:mi>w</mml:mi><mml:mi>k</mml:mi><mml:mi>i</mml:mi></mml:msubsup><mml:msubsup><mml:mi>w</mml:mi><mml:mi>k</mml:mi><mml:mi>j</mml:mi></mml:msubsup><mml:msub><mml:mi>e</mml:mi><mml:mi mathvariant="italic">ij</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mo>∑</mml:mo><mml:mi>i</mml:mi></mml:msub><mml:msub><mml:mo>∑</mml:mo><mml:mi>j</mml:mi></mml:msub><mml:msub><mml:mi>e</mml:mi><mml:mi mathvariant="italic">ij</mml:mi></mml:msub></mml:mrow></mml:mfrac></mml:math><graphic xlink:href="13059_2021_2362_Article_Equj.gif" position="anchor"/></alternatives></disp-formula></p>
      <p id="Par37">and
<disp-formula id="Equk"><alternatives><tex-math id="M7">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {a}_k=\frac{1}{N}{\sum}_i{w}_k^i $$\end{document}</tex-math><mml:math id="M8" display="block"><mml:msub><mml:mi>a</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mi>N</mml:mi></mml:mfrac><mml:msub><mml:mo>∑</mml:mo><mml:mi>i</mml:mi></mml:msub><mml:msubsup><mml:mi>w</mml:mi><mml:mi>k</mml:mi><mml:mi>i</mml:mi></mml:msubsup></mml:math><graphic xlink:href="13059_2021_2362_Article_Equk.gif" position="anchor"/></alternatives></disp-formula></p>
      <p id="Par38">In the above, <inline-formula id="IEq1"><alternatives><tex-math id="M9">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {w}_k^i $$\end{document}</tex-math><mml:math id="M10" display="inline"><mml:msubsup><mml:mi>w</mml:mi><mml:mi>k</mml:mi><mml:mi>i</mml:mi></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2021_2362_Article_IEq1.gif"/></alternatives></inline-formula> represents the fraction of cell-type <italic>k</italic> at the <italic>i</italic>th spot, <italic>N</italic> represents the total number of spots, and <italic>e</italic><sub><italic>ij</italic></sub> is defined as
<disp-formula id="Equl"><alternatives><tex-math id="M11">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {e}_{ij}=\left\{\begin{array}{c}1,\mathrm{if}\ i\ \mathrm{and}\ j\ \mathrm{are}\ \mathrm{neighboring}\ \mathrm{spots}\\ {}0,\mathrm{otherwise}\end{array}\right. $$\end{document}</tex-math><mml:math id="M12" display="block"><mml:msub><mml:mi>e</mml:mi><mml:mi mathvariant="italic">ij</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mfenced open="{"><mml:mtable><mml:mtr><mml:mtd><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mtext>if</mml:mtext><mml:mspace width="0.25em"/><mml:mi>i</mml:mi><mml:mspace width="0.25em"/><mml:mtext>and</mml:mtext><mml:mspace width="0.25em"/><mml:mi>j</mml:mi><mml:mspace width="0.25em"/><mml:mi>are</mml:mi><mml:mspace width="0.25em"/><mml:mtext>neighboring spots</mml:mtext></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mtext>otherwise</mml:mtext></mml:mtd></mml:mtr></mml:mtable></mml:mfenced></mml:math><graphic xlink:href="13059_2021_2362_Article_Equl.gif" position="anchor"/></alternatives></disp-formula></p>
      <p id="Par39">If the values of <inline-formula id="IEq2"><alternatives><tex-math id="M13">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {w}_k^i $$\end{document}</tex-math><mml:math id="M14" display="inline"><mml:msubsup><mml:mi>w</mml:mi><mml:mi>k</mml:mi><mml:mi>i</mml:mi></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2021_2362_Article_IEq2.gif"/></alternatives></inline-formula> are binary, then the above definition reduces to the original formula in [<xref ref-type="bibr" rid="CR21">21</xref>].</p>
    </sec>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Information</title>
    <sec id="Sec16">
      <p>
        <supplementary-material content-type="local-data" id="MOESM1">
          <media xlink:href="13059_2021_2362_MOESM1_ESM.pdf">
            <caption>
              <p>
                <bold>Additional file 1: Figure S1-S3.</bold>
              </p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM2">
          <media xlink:href="13059_2021_2362_MOESM2_ESM.docx">
            <caption>
              <p><bold>Additional file 2.</bold> Review history.</p>
            </caption>
          </media>
        </supplementary-material>
      </p>
    </sec>
  </sec>
</body>
<back>
  <fn-group>
    <fn>
      <p>
        <bold>Publisher’s Note</bold>
      </p>
      <p>Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p>
    </fn>
  </fn-group>
  <ack>
    <title>Acknowledgements</title>
    <p>We gratefully thank Dr. Ruben Dries for his helpful discussion and Ms. Natalie Del Rossi for her technical assistance.</p>
    <sec id="FPar1">
      <title>Review history</title>
      <p id="Par40">The review history is available as Additional file <xref rid="MOESM2" ref-type="media">2</xref>.</p>
    </sec>
    <sec id="FPar2">
      <title>Peer review information</title>
      <p id="Par41">Barbara Cheifet was the primary editor of this article and managed its editorial process and peer review in collaboration with the rest of the editorial team.</p>
    </sec>
  </ack>
  <notes notes-type="author-contribution">
    <title>Authors’ contributions</title>
    <p>GCY conceived the idea and supervised the work. RD and GCY designed the spatialDWLS package. RD implemented the package and performed the analysis. RD and GCY wrote and revised the manuscript. All authors read and approved the final manuscript.</p>
    <sec id="FPar3">
      <title>Authors’ information</title>
      <p id="Par42">Twitter handle: @gc_yuan (Guo-Cheng Yuan).</p>
    </sec>
  </notes>
  <notes notes-type="funding-information">
    <title>Funding</title>
    <p>This research was supported by NIH grants UH3HL145609 and R01AG066028 to G.-C.Y.</p>
  </notes>
  <notes notes-type="data-availability">
    <title>Availability of data and materials</title>
    <p>All codes, data, and analysis results in this paper are publicly available at GitHub [<xref ref-type="bibr" rid="CR23">23</xref>] and at Zenodo [<xref ref-type="bibr" rid="CR24">24</xref>]. The source code is released under the MIT license. Furthermore, the spatialDWLS method is implemented as the <italic>runDWLSDeconv</italic> function in Giotto (<ext-link ext-link-type="uri" xlink:href="https://github.com/RubD/Giotto">https://github.com/RubD/Giotto</ext-link>), and detailed tutorial and vignette are available at Giotto websites (<ext-link ext-link-type="uri" xlink:href="http://www.spatialgiotto.com">http://www.spatialgiotto.com</ext-link> and <ext-link ext-link-type="uri" xlink:href="https://rubd.github.io/Giotto_site/">https://rubd.github.io/Giotto_site/</ext-link>).</p>
  </notes>
  <notes>
    <title>Declarations</title>
    <notes id="FPar4">
      <title>Ethics approval and consent to participate</title>
      <p id="Par43">Not applicable.</p>
    </notes>
    <notes id="FPar5" notes-type="COI-statement">
      <title>Competing interests</title>
      <p id="Par44">The authors declare that they have no competing interests.</p>
    </notes>
  </notes>
  <ref-list id="Bib1">
    <title>References</title>
    <ref id="CR1">
      <label>1.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Eng</surname>
            <given-names>CL</given-names>
          </name>
          <name>
            <surname>Lawson</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Zhu</surname>
            <given-names>Q</given-names>
          </name>
          <name>
            <surname>Dries</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Koulena</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Takei</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Yun</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Cronin</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Karp</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Yuan</surname>
            <given-names>GC</given-names>
          </name>
          <name>
            <surname>Cai</surname>
            <given-names>L</given-names>
          </name>
        </person-group>
        <article-title>Transcriptome-scale super-resolved imaging in tissues by RNA seqFISH</article-title>
        <source>Nature</source>
        <year>2019</year>
        <volume>568</volume>
        <issue>7751</issue>
        <fpage>235</fpage>
        <lpage>239</lpage>
        <pub-id pub-id-type="doi">10.1038/s41586-019-1049-y</pub-id>
        <?supplied-pmid 30911168?>
        <pub-id pub-id-type="pmid">30911168</pub-id>
      </element-citation>
    </ref>
    <ref id="CR2">
      <label>2.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Rodriques</surname>
            <given-names>SG</given-names>
          </name>
          <name>
            <surname>Stickels</surname>
            <given-names>RR</given-names>
          </name>
          <name>
            <surname>Goeva</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Martin</surname>
            <given-names>CA</given-names>
          </name>
          <name>
            <surname>Murray</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Vanderburg</surname>
            <given-names>CR</given-names>
          </name>
          <name>
            <surname>Welch</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>LM</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Macosko</surname>
            <given-names>EZ</given-names>
          </name>
        </person-group>
        <article-title>Slide-seq: a scalable technology for measuring genome-wide expression at high spatial resolution</article-title>
        <source>Science</source>
        <year>2019</year>
        <volume>363</volume>
        <issue>6434</issue>
        <fpage>1463</fpage>
        <lpage>1467</lpage>
        <pub-id pub-id-type="doi">10.1126/science.aaw1219</pub-id>
        <?supplied-pmid 30923225?>
        <pub-id pub-id-type="pmid">30923225</pub-id>
      </element-citation>
    </ref>
    <ref id="CR3">
      <label>3.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wang</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Allen</surname>
            <given-names>WE</given-names>
          </name>
          <name>
            <surname>Wright</surname>
            <given-names>MA</given-names>
          </name>
          <name>
            <surname>Sylwestrak</surname>
            <given-names>EL</given-names>
          </name>
          <name>
            <surname>Samusik</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Vesuna</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Evans</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Liu</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Ramakrishnan</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Liu</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Nolan</surname>
            <given-names>GP</given-names>
          </name>
          <name>
            <surname>Bava</surname>
            <given-names>FA</given-names>
          </name>
          <name>
            <surname>Deisseroth</surname>
            <given-names>K</given-names>
          </name>
        </person-group>
        <article-title>Three-dimensional intact-tissue sequencing of single-cell transcriptional states</article-title>
        <source>Science</source>
        <year>2018</year>
        <volume>361</volume>
        <issue>6400</issue>
        <fpage>eaat5691</fpage>
        <pub-id pub-id-type="doi">10.1126/science.aat5691</pub-id>
        <?supplied-pmid 29930089?>
        <pub-id pub-id-type="pmid">29930089</pub-id>
      </element-citation>
    </ref>
    <ref id="CR4">
      <label>4.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Stahl</surname>
            <given-names>PL</given-names>
          </name>
          <name>
            <surname>Salmen</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Vickovic</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Lundmark</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Navarro</surname>
            <given-names>JF</given-names>
          </name>
          <name>
            <surname>Magnusson</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Giacomello</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Asp</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Westholm</surname>
            <given-names>JO</given-names>
          </name>
          <name>
            <surname>Huss</surname>
            <given-names>M</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Visualization and analysis of gene expression in tissue sections by spatial transcriptomics</article-title>
        <source>Science</source>
        <year>2016</year>
        <volume>353</volume>
        <issue>6294</issue>
        <fpage>78</fpage>
        <lpage>82</lpage>
        <pub-id pub-id-type="doi">10.1126/science.aaf2403</pub-id>
        <?supplied-pmid 27365449?>
        <pub-id pub-id-type="pmid">27365449</pub-id>
      </element-citation>
    </ref>
    <ref id="CR5">
      <label>5.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Moffitt</surname>
            <given-names>JR</given-names>
          </name>
          <name>
            <surname>Hao</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Bambah-Mukku</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Lu</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Dulac</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Zhuang</surname>
            <given-names>X</given-names>
          </name>
        </person-group>
        <article-title>High-performance multiplexed fluorescence in situ hybridization in culture and tissue with matrix imprinting and clearing</article-title>
        <source>Proc Natl Acad Sci U S A</source>
        <year>2016</year>
        <volume>113</volume>
        <issue>50</issue>
        <fpage>14456</fpage>
        <lpage>14461</lpage>
        <pub-id pub-id-type="doi">10.1073/pnas.1617699113</pub-id>
        <?supplied-pmid 27911841?>
        <pub-id pub-id-type="pmid">27911841</pub-id>
      </element-citation>
    </ref>
    <ref id="CR6">
      <label>6.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Liu</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Yang</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Deng</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Su</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Enninful</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Guo</surname>
            <given-names>CC</given-names>
          </name>
          <name>
            <surname>Tebaldi</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Kim</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Bai</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Norris</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Pan</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Xiao</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Halene</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Fan</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>High-spatial-resolution multi-omics sequencing via deterministic barcoding in tissue</article-title>
        <source>Cell</source>
        <year>2020</year>
        <volume>183</volume>
        <issue>6</issue>
        <fpage>1665</fpage>
        <lpage>1681</lpage>
        <pub-id pub-id-type="doi">10.1016/j.cell.2020.10.026</pub-id>
        <?supplied-pmid 33188776?>
        <pub-id pub-id-type="pmid">33188776</pub-id>
      </element-citation>
    </ref>
    <ref id="CR7">
      <label>7.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zhong</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Wan</surname>
            <given-names>YW</given-names>
          </name>
          <name>
            <surname>Pang</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Chow</surname>
            <given-names>LM</given-names>
          </name>
          <name>
            <surname>Liu</surname>
            <given-names>Z</given-names>
          </name>
        </person-group>
        <article-title>Digital sorting of complex tissues for cell type-specific gene expression profiles</article-title>
        <source>BMC Bioinformatics</source>
        <year>2013</year>
        <volume>14</volume>
        <issue>1</issue>
        <fpage>89</fpage>
        <pub-id pub-id-type="doi">10.1186/1471-2105-14-89</pub-id>
        <?supplied-pmid 23497278?>
        <pub-id pub-id-type="pmid">23497278</pub-id>
      </element-citation>
    </ref>
    <ref id="CR8">
      <label>8.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wang</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Park</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Susztak</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>NR</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>Bulk tissue cell type deconvolution with multi-subject single-cell expression reference</article-title>
        <source>Nat Commun</source>
        <year>2019</year>
        <volume>10</volume>
        <issue>1</issue>
        <fpage>380</fpage>
        <pub-id pub-id-type="doi">10.1038/s41467-018-08023-x</pub-id>
        <?supplied-pmid 30670690?>
        <pub-id pub-id-type="pmid">30670690</pub-id>
      </element-citation>
    </ref>
    <ref id="CR9">
      <label>9.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Tsoucas</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Dong</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Zhu</surname>
            <given-names>Q</given-names>
          </name>
          <name>
            <surname>Guo</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Yuan</surname>
            <given-names>GC</given-names>
          </name>
        </person-group>
        <article-title>Accurate estimation of cell-type composition from gene expression data</article-title>
        <source>Nat Commun</source>
        <year>2019</year>
        <volume>10</volume>
        <issue>1</issue>
        <fpage>2975</fpage>
        <pub-id pub-id-type="doi">10.1038/s41467-019-10802-z</pub-id>
        <?supplied-pmid 31278265?>
        <pub-id pub-id-type="pmid">31278265</pub-id>
      </element-citation>
    </ref>
    <ref id="CR10">
      <label>10.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Newman</surname>
            <given-names>AM</given-names>
          </name>
          <name>
            <surname>Liu</surname>
            <given-names>CL</given-names>
          </name>
          <name>
            <surname>Green</surname>
            <given-names>MR</given-names>
          </name>
          <name>
            <surname>Gentles</surname>
            <given-names>AJ</given-names>
          </name>
          <name>
            <surname>Feng</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Xu</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Hoang</surname>
            <given-names>CD</given-names>
          </name>
          <name>
            <surname>Diehn</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Alizadeh</surname>
            <given-names>AA</given-names>
          </name>
        </person-group>
        <article-title>Robust enumeration of cell subsets from tissue expression profiles</article-title>
        <source>Nat Methods</source>
        <year>2015</year>
        <volume>12</volume>
        <issue>5</issue>
        <fpage>453</fpage>
        <lpage>457</lpage>
        <pub-id pub-id-type="doi">10.1038/nmeth.3337</pub-id>
        <?supplied-pmid 25822800?>
        <pub-id pub-id-type="pmid">25822800</pub-id>
      </element-citation>
    </ref>
    <ref id="CR11">
      <label>11.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Li</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Severson</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Pignon</surname>
            <given-names>JC</given-names>
          </name>
          <name>
            <surname>Zhao</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Novak</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Jiang</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Shen</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Aster</surname>
            <given-names>JC</given-names>
          </name>
          <name>
            <surname>Rodig</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Signoretti</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Liu</surname>
            <given-names>JS</given-names>
          </name>
          <name>
            <surname>Liu</surname>
            <given-names>XS</given-names>
          </name>
        </person-group>
        <article-title>Comprehensive analyses of tumor immunity: implications for cancer immunotherapy</article-title>
        <source>Genome Biol</source>
        <year>2016</year>
        <volume>17</volume>
        <issue>1</issue>
        <fpage>174</fpage>
        <pub-id pub-id-type="doi">10.1186/s13059-016-1028-7</pub-id>
        <?supplied-pmid 27549193?>
        <pub-id pub-id-type="pmid">27549193</pub-id>
      </element-citation>
    </ref>
    <ref id="CR12">
      <label>12.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Gong</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Szustakowski</surname>
            <given-names>JD</given-names>
          </name>
        </person-group>
        <article-title>DeconRNASeq: a statistical framework for deconvolution of heterogeneous tissue samples based on mRNA-Seq data</article-title>
        <source>Bioinformatics</source>
        <year>2013</year>
        <volume>29</volume>
        <issue>8</issue>
        <fpage>1083</fpage>
        <lpage>1085</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btt090</pub-id>
        <?supplied-pmid 23428642?>
        <pub-id pub-id-type="pmid">23428642</pub-id>
      </element-citation>
    </ref>
    <ref id="CR13">
      <label>13.</label>
      <mixed-citation publication-type="other">Dong M, Thennavan A, Urrutia E, Li Y, Perou CM, Zou F, et al. SCDC: bulk gene expression deconvolution by multiple single-cell RNA sequencing references. Brief Bioinform. 2021;22(1):416–27. 10.1093/bib/bbz166.</mixed-citation>
    </ref>
    <ref id="CR14">
      <label>14.</label>
      <mixed-citation publication-type="other">Cable DM, Murray E, Zou LS, Goeva A, Macosko EZ, Chen F, Irizarry RA. Robust decomposition of cell type mixtures in spatial transcriptomics. Nat Biotechnol. 2021. 10.1038/s41587-021-00830-w. Online ahead of print.</mixed-citation>
    </ref>
    <ref id="CR15">
      <label>15.</label>
      <mixed-citation publication-type="other">Elosua-Bayes M, Nieto P, Mereu E, Gut I, Heyn H.  SPOTlight: seeded NMF regression to deconvolute spatial transcriptomics spots with single-cell transcriptomes. Nucleic Acids Res. 2021 Feb 5:gkab043. 10.1093/nar/gkab043. Online ahead of print.</mixed-citation>
    </ref>
    <ref id="CR16">
      <label>16.</label>
      <mixed-citation publication-type="other">Andersson A, Bergenstråhle J, Asp M, Bergenstråhle L, Jurek A, Navarro JF, Lundeberg J: Spatial mapping of cell types by integration of transcriptomics data. 2019. bioRxiv. 10.1101/2019.12.13.874495.</mixed-citation>
    </ref>
    <ref id="CR17">
      <label>17.</label>
      <mixed-citation publication-type="other">Dries R, Zhu Q, Dong R, Eng CL, Li H, Liu K, Fu Y, Zhao T, Sarkar A, Bao F, George RE, Pierson N, Cai L, Yuan GC.  Giotto: a toolbox for integrative analysis and visualization of spatial expression data. Genome Biol. 2021;22(1):78. 10.1186/s13059-021-02286-2.</mixed-citation>
    </ref>
    <ref id="CR18">
      <label>18.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zeisel</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Munoz-Manchado</surname>
            <given-names>AB</given-names>
          </name>
          <name>
            <surname>Codeluppi</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Lonnerberg</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>La Manno</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Jureus</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Marques</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Munguba</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>He</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Betsholtz</surname>
            <given-names>C</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Brain structure. Cell types in the mouse cortex and hippocampus revealed by single-cell RNA-seq</article-title>
        <source>Science</source>
        <year>2015</year>
        <volume>347</volume>
        <issue>6226</issue>
        <fpage>1138</fpage>
        <lpage>1142</lpage>
        <pub-id pub-id-type="doi">10.1126/science.aaa1934</pub-id>
        <?supplied-pmid 25700174?>
        <pub-id pub-id-type="pmid">25700174</pub-id>
      </element-citation>
    </ref>
    <ref id="CR19">
      <label>19.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zeisel</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Hochgerner</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Lonnerberg</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Johnsson</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Memic</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>van der Zwan</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Haring</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Braun</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Borm</surname>
            <given-names>LE</given-names>
          </name>
          <name>
            <surname>La Manno</surname>
            <given-names>G</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Molecular architecture of the mouse nervous system</article-title>
        <source>Cell</source>
        <year>2018</year>
        <volume>174</volume>
        <issue>4</issue>
        <fpage>999</fpage>
        <lpage>1014</lpage>
        <pub-id pub-id-type="doi">10.1016/j.cell.2018.06.021</pub-id>
        <?supplied-pmid 30096314?>
        <pub-id pub-id-type="pmid">30096314</pub-id>
      </element-citation>
    </ref>
    <ref id="CR20">
      <label>20.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Asp</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Giacomello</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Larsson</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Wu</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Furth</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Qian</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Wardell</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Custodio</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Reimegard</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Salmen</surname>
            <given-names>F</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>A spatiotemporal organ-wide gene expression and cell atlas of the developing human heart</article-title>
        <source>Cell</source>
        <year>2019</year>
        <volume>179</volume>
        <issue>7</issue>
        <fpage>1647</fpage>
        <lpage>1660</lpage>
        <pub-id pub-id-type="doi">10.1016/j.cell.2019.11.025</pub-id>
        <?supplied-pmid 31835037?>
        <pub-id pub-id-type="pmid">31835037</pub-id>
      </element-citation>
    </ref>
    <ref id="CR21">
      <label>21.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Newman</surname>
            <given-names>ME</given-names>
          </name>
        </person-group>
        <article-title>Mixing patterns in networks</article-title>
        <source>Phys Rev E Stat Nonlin Soft Matter Phys</source>
        <year>2003</year>
        <volume>67</volume>
        <issue>2</issue>
        <fpage>026126</fpage>
        <pub-id pub-id-type="doi">10.1103/PhysRevE.67.026126</pub-id>
        <?supplied-pmid 12636767?>
        <pub-id pub-id-type="pmid">12636767</pub-id>
      </element-citation>
    </ref>
    <ref id="CR22">
      <label>22.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kim</surname>
            <given-names>SY</given-names>
          </name>
          <name>
            <surname>Volsky</surname>
            <given-names>DJ</given-names>
          </name>
        </person-group>
        <article-title>PAGE: parametric analysis of gene set enrichment</article-title>
        <source>BMC Bioinformatics</source>
        <year>2005</year>
        <volume>6</volume>
        <issue>1</issue>
        <fpage>144</fpage>
        <pub-id pub-id-type="doi">10.1186/1471-2105-6-144</pub-id>
        <?supplied-pmid 15941488?>
        <pub-id pub-id-type="pmid">15941488</pub-id>
      </element-citation>
    </ref>
    <ref id="CR23">
      <label>23.</label>
      <mixed-citation publication-type="other">Dong R, Yuan GC. SpatialDWLS on GitHub [Internet]: Available from: <ext-link ext-link-type="uri" xlink:href="https://github.com/rdong08/spatialDWLS_dataset">https://github.com/rdong08/spatialDWLS_dataset</ext-link>.</mixed-citation>
    </ref>
    <ref id="CR24">
      <label>24.</label>
      <mixed-citation publication-type="other">Dong R, Yuan GC. SpatialDWLS on Zenodo [Internet]: Available from: <ext-link ext-link-type="uri" xlink:href="https://zenodo.org/record/4706209#.YIDBoalKjv5">https://zenodo.org/record/4706209#.YIDBoalKjv5</ext-link>.</mixed-citation>
    </ref>
  </ref-list>
</back>
