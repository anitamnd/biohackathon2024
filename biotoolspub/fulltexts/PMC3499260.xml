<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.1 20151215//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-archivearticle1.dtd?>
<?SourceDTD.Version 1.1?>
<?ConverterInfo.XSLTName jp2nlmx2.xsl?>
<?ConverterInfo.Version 2?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">PLoS Genet</journal-id>
    <journal-id journal-id-type="iso-abbrev">PLoS Genet</journal-id>
    <journal-id journal-id-type="publisher-id">plos</journal-id>
    <journal-id journal-id-type="pmc">plosgen</journal-id>
    <journal-title-group>
      <journal-title>PLoS Genetics</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1553-7390</issn>
    <issn pub-type="epub">1553-7404</issn>
    <publisher>
      <publisher-name>Public Library of Science</publisher-name>
      <publisher-loc>San Francisco, USA</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">3499260</article-id>
    <article-id pub-id-type="pmid">23166502</article-id>
    <article-id pub-id-type="publisher-id">PGENETICS-D-12-00574</article-id>
    <article-id pub-id-type="doi">10.1371/journal.pgen.1002967</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Research Article</subject>
      </subj-group>
      <subj-group subj-group-type="Discipline-v2">
        <subject>Biology</subject>
        <subj-group>
          <subject>Genetics</subject>
          <subj-group>
            <subject>Population Genetics</subject>
          </subj-group>
        </subj-group>
        <subj-group>
          <subject>Population Biology</subject>
          <subj-group>
            <subject>Population Genetics</subject>
            <subj-group>
              <subject>Gene Flow</subject>
              <subject>Genetic Drift</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Inference of Population Splits and Mixtures from Genome-Wide Allele Frequency Data</article-title>
      <alt-title alt-title-type="running-head">Inferring History from Genetics</alt-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Pickrell</surname>
          <given-names>Joseph K.</given-names>
        </name>
        <xref ref-type="aff" rid="aff1">
          <sup>1</sup>
        </xref>
        <xref ref-type="corresp" rid="cor1">
          <sup>*</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Pritchard</surname>
          <given-names>Jonathan K.</given-names>
        </name>
        <xref ref-type="aff" rid="aff1">
          <sup>1</sup>
        </xref>
        <xref ref-type="aff" rid="aff2">
          <sup>2</sup>
        </xref>
        <xref ref-type="corresp" rid="cor1">
          <sup>*</sup>
        </xref>
      </contrib>
    </contrib-group>
    <aff id="aff1">
      <label>1</label>
      <addr-line>Department of Human Genetics, University of Chicago, Chicago, Illinois, United States of America</addr-line>
    </aff>
    <aff id="aff2">
      <label>2</label>
      <addr-line>Howard Hughes Medical Institute, University of Chicago, Chicago, Illinois, United States of America</addr-line>
    </aff>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Tang</surname>
          <given-names>Hua</given-names>
        </name>
        <role>Editor</role>
        <xref ref-type="aff" rid="edit1"/>
      </contrib>
    </contrib-group>
    <aff id="edit1">
      <addr-line>Stanford University, United States of America</addr-line>
    </aff>
    <author-notes>
      <corresp id="cor1">* E-mail: <email>joseph_pickrell@hms.harvard.edu</email> (JK Pickrell); <email>pritch@uchicago.edu</email> (JK Pritchard)</corresp>
      <fn fn-type="COI-statement">
        <p>The authors have declared that no competing interests exist.</p>
      </fn>
      <fn fn-type="con">
        <p>Conceived and designed the experiments: JK Pickrell, JK Pritchard. Analyzed the data: JK Pickrell. Contributed reagents/materials/analysis tools: JK Pickrell. Wrote the paper: JK Pickrell, JK Pritchard.</p>
      </fn>
      <fn id="fn1" fn-type="current-aff">
        <label>¤</label>
        <p>Current address: Department of Genetics, Harvard Medical School, Boston, Massachusetts, United States of America</p>
      </fn>
    </author-notes>
    <pub-date pub-type="collection">
      <month>11</month>
      <year>2012</year>
    </pub-date>
    <pub-date pub-type="epub">
      <day>15</day>
      <month>11</month>
      <year>2012</year>
    </pub-date>
    <volume>8</volume>
    <issue>11</issue>
    <elocation-id>e1002967</elocation-id>
    <history>
      <date date-type="received">
        <day>5</day>
        <month>3</month>
        <year>2012</year>
      </date>
      <date date-type="accepted">
        <day>8</day>
        <month>8</month>
        <year>2012</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© 2012 Pickrell, Pritchard</copyright-statement>
      <copyright-year>2012</copyright-year>
      <copyright-holder>Pickrell, Pritchard</copyright-holder>
      <license xlink:href="http://creativecommons.org/licenses/by/4.0/">
        <license-p>This is an open-access article distributed under the terms of the Creative Commons Attribution License, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are properly credited.</license-p>
      </license>
    </permissions>
    <abstract>
      <p>Many aspects of the historical relationships between populations in a species are reflected in genetic data. Inferring these relationships from genetic data, however, remains a challenging task. In this paper, we present a statistical model for inferring the patterns of population splits and mixtures in multiple populations. In our model, the sampled populations in a species are related to their common ancestor through a graph of ancestral populations. Using genome-wide allele frequency data and a Gaussian approximation to genetic drift, we infer the structure of this graph. We applied this method to a set of 55 human populations and a set of 82 dog breeds and wild canids. In both species, we show that a simple bifurcating tree does not fully describe the data; in contrast, we infer many migration events. While some of the migration events that we find have been detected previously, many have not. For example, in the human data, we infer that Cambodians trace approximately 16% of their ancestry to a population ancestral to other extant East Asian populations. In the dog data, we infer that both the boxer and basenji trace a considerable fraction of their ancestry (9% and 25%, respectively) to wolves subsequent to domestication and that East Asian toy breeds (the Shih Tzu and the Pekingese) result from admixture between modern toy breeds and “ancient” Asian breeds. Software implementing the model described here, called <italic>TreeMix</italic>, is available at <ext-link ext-link-type="uri" xlink:href="http://treemix.googlecode.com">http://treemix.googlecode.com</ext-link>.</p>
    </abstract>
    <abstract abstract-type="summary">
      <title>Author Summary</title>
      <p>With modern genotyping technology, it is now possible to obtain large amounts of genetic data from many populations in a species. An important question that can be addressed with these data is: what is the history of these populations? There is a long history in population genetics of inferring the relationships among populations as a bifurcating tree, analogous to phylogenetic trees for representing the evolution of species. However, it has long been recognized that, since populations from the same species exchange genes, simple bifurcating trees may be an incorrect representation of population histories. We have developed a method to address this issue, using a model which allows for both population splits and gene flow. In application to humans, we show that we are able to identify a number of both previously known and unknown episodes of gene flow in history, including gene flow into Cambodia of a population only distantly related to modern East Asia. In application to dogs, we show that the boxer and basenji breeds have a considerable component of ancestry from grey wolves subsequent to domestication.</p>
    </abstract>
    <funding-group>
      <funding-statement>This work was funded by the Howard Hughes Medical Institute and by NIH grant MH084703 to JK Pritchard. The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.</funding-statement>
    </funding-group>
    <counts>
      <page-count count="17"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec id="s1">
    <title>Introduction</title>
    <p>The extant populations in a species result from an often-complex demographic history, involving population splits, gene flow, and changes in population size. It has long been recognized that genetic data can be used to learn about this history <xref rid="pgen.1002967-CavalliSforza1" ref-type="bibr">[1]</xref>–<xref rid="pgen.1002967-Cann1" ref-type="bibr">[3]</xref>. In humans, early approaches to inferring history from genetics were limited to using a relatively small number of blood group or other protein polymorphisms <xref rid="pgen.1002967-CavalliSforza1" ref-type="bibr">[1]</xref>, <xref rid="pgen.1002967-Nei1" ref-type="bibr">[4]</xref>–<xref rid="pgen.1002967-CavalliSforza2" ref-type="bibr">[6]</xref>. These types of studies were then superseded by analyses of DNA markers, which have progressed from single marker studies <xref rid="pgen.1002967-Cann1" ref-type="bibr">[3]</xref> to studies involving hundreds of thousands of markers <xref rid="pgen.1002967-Li1" ref-type="bibr">[7]</xref>. It is now feasible to collect genome-wide genetic data in any species; to a large extent it is no longer the data collection, but rather the statistical models used for analysis, that limit the historical insight possible.</p>
    <p>There are many statistical approaches to demographic inference from genetic data. One approach is to develop an explicit population genetic model for the history of a set of populations, framed in terms of the effective population sizes of the populations, the times of population splits, the times of demographic events (such as population bottlenecks), and other relevant parameters. The values of these parameters can then be learned from the data using a variety of techniques, often involving simulation <xref rid="pgen.1002967-Pritchard1" ref-type="bibr">[8]</xref>–<xref rid="pgen.1002967-Gronau1" ref-type="bibr">[16]</xref>. These approaches have the advantage of allowing flexible modeling of a wide variety of demographic scenarios, but the disadvantage that they can only be applied to one or a few populations at a time.</p>
    <p>Another type of approach to learning about population history uses methods that summarize the major components of genetic variation in a sample by clustering or principal components analysis <xref rid="pgen.1002967-Menozzi1" ref-type="bibr">[17]</xref>–<xref rid="pgen.1002967-Lawson1" ref-type="bibr">[20]</xref>. Although these methods do not model history explicitly, the inferred components can often be interpreted <italic>post hoc</italic> as representing historical populations, and individuals or populations that are mixtures of different components as evidence of admixture between these populations (e.g., <xref rid="pgen.1002967-Menozzi1" ref-type="bibr">[17]</xref>, <xref rid="pgen.1002967-Rosenberg1" ref-type="bibr">[21]</xref>–<xref rid="pgen.1002967-vonHoldt1" ref-type="bibr">[23]</xref>). However, these methods are not directly informative about history; indeed, the relationship between the major components of genetic variation and true underlying demography is not always intuitive <xref rid="pgen.1002967-Franois1" ref-type="bibr">[24]</xref>–<xref rid="pgen.1002967-Novembre1" ref-type="bibr">[26]</xref>.</p>
    <p>A different class of approaches focuses on the relationships between populations, by representing a set of populations as a bifurcating tree <xref rid="pgen.1002967-CavalliSforza1" ref-type="bibr">[1]</xref>, <xref rid="pgen.1002967-Saitou1" ref-type="bibr">[27]</xref>–<xref rid="pgen.1002967-Nielsen1" ref-type="bibr">[32]</xref>. In these models, the details of the demographic histories of the population are absorbed into the branch lengths of the tree <xref rid="pgen.1002967-CavalliSforza1" ref-type="bibr">[1]</xref>, <xref rid="pgen.1002967-Nicholson1" ref-type="bibr">[33]</xref>. This approach has the advantage of being applicable to large numbers of populations; however, a major caveat when modeling the history of populations as a tree is that gene flow violates the assumptions of the model <xref rid="pgen.1002967-Felsenstein1" ref-type="bibr">[2]</xref>, <xref rid="pgen.1002967-CavalliSforza3" ref-type="bibr">[34]</xref>, <xref rid="pgen.1002967-CavalliSforza4" ref-type="bibr">[35]</xref>. It is often difficult to know, <italic>a priori</italic>, how well the history fits a simple bifurcating tree. Explicit tests for the violation of a tree model have been developed <xref rid="pgen.1002967-CavalliSforza4" ref-type="bibr">[35]</xref>–<xref rid="pgen.1002967-Lathrop1" ref-type="bibr">[40]</xref>. These tests have been used, most notably, to infer the existence of gene flow between modern and archaic humans <xref rid="pgen.1002967-Green1" ref-type="bibr">[39]</xref>, <xref rid="pgen.1002967-Reich2" ref-type="bibr">[41]</xref>, <xref rid="pgen.1002967-Reich3" ref-type="bibr">[42]</xref>, as well as between diverged modern human populations <xref rid="pgen.1002967-Reich1" ref-type="bibr">[37]</xref>, <xref rid="pgen.1002967-Moorjani1" ref-type="bibr">[43]</xref>, <xref rid="pgen.1002967-Rasmussen1" ref-type="bibr">[44]</xref>.</p>
    <p>In this paper, we present a unified statistical framework for building population trees and testing for the presence of gene flow between diverged populations. In this framework, the relationship between populations is represented as a graph, allowing us to model both population splits and gene flow. Graph-based models are of growing interest in phylogenetics <xref rid="pgen.1002967-Huson1" ref-type="bibr">[45]</xref>, <xref rid="pgen.1002967-Huson2" ref-type="bibr">[46]</xref>, but have been rarely used in population genetics (with some exceptions <xref rid="pgen.1002967-Reich1" ref-type="bibr">[37]</xref>, <xref rid="pgen.1002967-Lathrop1" ref-type="bibr">[40]</xref>, <xref rid="pgen.1002967-Dyer1" ref-type="bibr">[47]</xref>).</p>
  </sec>
  <sec id="s2">
    <title>Results</title>
    <p>The starting point for our model was first proposed by Cavalli-Sforza and Edwards <xref rid="pgen.1002967-CavalliSforza1" ref-type="bibr">[1]</xref>, and we draw additionally on related models by Nicholson et al. <xref rid="pgen.1002967-Nicholson1" ref-type="bibr">[33]</xref> and Coop et al. <xref rid="pgen.1002967-Coop1" ref-type="bibr">[48]</xref>. Our goal is to provide a statistical framework for inferring population networks that is motivated by an explicit population genetic model, but sufficiently abstract to be computationally feasible for genome-wide data from many populations (say, 10–100). Our primary aim is to represent the topology of relationships between populations, rather than the precise times of demographic events.</p>
    <p>Our approach to this problem is to first build a maximum likelihood tree of populations. We then identify populations that are poor fits to the tree model, and model migration events involving these populations. Below, we first describe this approach in an idealized setting, and then describe the modifications necessary for implementation in practice.</p>
    <sec id="s2a">
      <title>Model</title>
      <p>In the most simple case, consider a single SNP, and let the allele frequency of one of the alleles at this SNP in an ancestral population be <inline-formula><inline-graphic xlink:href="pgen.1002967.e001.jpg"/></inline-formula>. (We use a lowercase <inline-formula><inline-graphic xlink:href="pgen.1002967.e002.jpg"/></inline-formula> to denote that this is a parameter rather than a random variable. We initially consider distributions conditional on <inline-formula><inline-graphic xlink:href="pgen.1002967.e003.jpg"/></inline-formula>). Now consider a descendant population <inline-formula><inline-graphic xlink:href="pgen.1002967.e004.jpg"/></inline-formula>. We model <inline-formula><inline-graphic xlink:href="pgen.1002967.e005.jpg"/></inline-formula>, the allele frequency of the SNP in population <inline-formula><inline-graphic xlink:href="pgen.1002967.e006.jpg"/></inline-formula>, as:<disp-formula id="pgen.1002967.e007"><graphic xlink:href="pgen.1002967.e007.jpg" position="anchor" orientation="portrait"/><label>(1)</label></disp-formula>with<disp-formula id="pgen.1002967.e008"><graphic xlink:href="pgen.1002967.e008.jpg" position="anchor" orientation="portrait"/><label>(2)</label></disp-formula>where <inline-formula><inline-graphic xlink:href="pgen.1002967.e009.jpg"/></inline-formula> is a factor that reflects the amount of genetic drift that has occurred between the ancestral population and <inline-formula><inline-graphic xlink:href="pgen.1002967.e010.jpg"/></inline-formula>. This Gaussian model was first introduced by Cavalli-Sforza and Edwards <xref rid="pgen.1002967-CavalliSforza1" ref-type="bibr">[1]</xref>, and the motivation for this model is outlined in Nicholson et al. <xref rid="pgen.1002967-Nicholson1" ref-type="bibr">[33]</xref>, if the amount of genetic drift between the two populations is small (at most on a timescale of the same order as the effective population size), then the diffusion approximation to a Wright-Fisher model of genetic drift leads to <xref ref-type="disp-formula" rid="pgen.1002967.e008">Equation 2</xref> with <inline-formula><inline-graphic xlink:href="pgen.1002967.e011.jpg"/></inline-formula>, where <inline-formula><inline-graphic xlink:href="pgen.1002967.e012.jpg"/></inline-formula> is the number of generations separating the two populations, and <inline-formula><inline-graphic xlink:href="pgen.1002967.e013.jpg"/></inline-formula> is the effective population size <xref rid="pgen.1002967-Nicholson1" ref-type="bibr">[33]</xref>. We do not model the boundaries of the allele frequencies at zero and one, nor do we consider new mutations. This means that this model will be most accurate for alleles that were at intermediate frequency in the ancestral population.</p>
      <p>Now consider a descendant population of <inline-formula><inline-graphic xlink:href="pgen.1002967.e014.jpg"/></inline-formula>; let us call this population <inline-formula><inline-graphic xlink:href="pgen.1002967.e015.jpg"/></inline-formula>, and the allele frequency in the population <inline-formula><inline-graphic xlink:href="pgen.1002967.e016.jpg"/></inline-formula>. Using the same model:<disp-formula id="pgen.1002967.e017"><graphic xlink:href="pgen.1002967.e017.jpg" position="anchor" orientation="portrait"/><label>(3)</label></disp-formula>
<disp-formula id="pgen.1002967.e018"><graphic xlink:href="pgen.1002967.e018.jpg" position="anchor" orientation="portrait"/><label>(4)</label></disp-formula>where<disp-formula id="pgen.1002967.e019"><graphic xlink:href="pgen.1002967.e019.jpg" position="anchor" orientation="portrait"/><label>(5)</label></disp-formula>
</p>
      <p>We can write down the expectation and variance of <inline-formula><inline-graphic xlink:href="pgen.1002967.e020.jpg"/></inline-formula> as:<disp-formula id="pgen.1002967.e021"><graphic xlink:href="pgen.1002967.e021.jpg" position="anchor" orientation="portrait"/><label>(6)</label></disp-formula>
<disp-formula id="pgen.1002967.e022"><graphic xlink:href="pgen.1002967.e022.jpg" position="anchor" orientation="portrait"/><label>(7)</label></disp-formula>and:<disp-formula id="pgen.1002967.e023"><graphic xlink:href="pgen.1002967.e023.jpg" position="anchor" orientation="portrait"/><label>(8)</label></disp-formula>
<disp-formula id="pgen.1002967.e024"><graphic xlink:href="pgen.1002967.e024.jpg" position="anchor" orientation="portrait"/><label>(9)</label></disp-formula>We then assume that the amount of genetic drift between all the populations is small. This implies that <inline-formula><inline-graphic xlink:href="pgen.1002967.e025.jpg"/></inline-formula> is well-approximated by <inline-formula><inline-graphic xlink:href="pgen.1002967.e026.jpg"/></inline-formula> in <xref ref-type="disp-formula" rid="pgen.1002967.e019">Equation 5</xref>, and hence the amount of genetic drift between <inline-formula><inline-graphic xlink:href="pgen.1002967.e027.jpg"/></inline-formula> and <inline-formula><inline-graphic xlink:href="pgen.1002967.e028.jpg"/></inline-formula> is approximately independent of the amount of genetic drift between <inline-formula><inline-graphic xlink:href="pgen.1002967.e029.jpg"/></inline-formula> and <inline-formula><inline-graphic xlink:href="pgen.1002967.e030.jpg"/></inline-formula>
<xref rid="pgen.1002967-CavalliSforza4" ref-type="bibr">[35]</xref>. With these simplifications:<disp-formula id="pgen.1002967.e031"><graphic xlink:href="pgen.1002967.e031.jpg" position="anchor" orientation="portrait"/><label>(10)</label></disp-formula>
<disp-formula id="pgen.1002967.e032"><graphic xlink:href="pgen.1002967.e032.jpg" position="anchor" orientation="portrait"/><label>(11)</label></disp-formula>We thus have a model for <inline-formula><inline-graphic xlink:href="pgen.1002967.e033.jpg"/></inline-formula>, conditional on <inline-formula><inline-graphic xlink:href="pgen.1002967.e034.jpg"/></inline-formula>:<disp-formula id="pgen.1002967.e035"><graphic xlink:href="pgen.1002967.e035.jpg" position="anchor" orientation="portrait"/><label>(12)</label></disp-formula>
</p>
      <sec id="s2a1">
        <title>Multiple populations</title>
        <p>Now consider a set of four populations, all related to an ancestral population by a tree, as depicted in <xref ref-type="fig" rid="pgen-1002967-g001">Figure 1A</xref>. Let the allele frequencies in the four populations be denoted <inline-formula><inline-graphic xlink:href="pgen.1002967.e036.jpg"/></inline-formula>, <inline-formula><inline-graphic xlink:href="pgen.1002967.e037.jpg"/></inline-formula>, <inline-formula><inline-graphic xlink:href="pgen.1002967.e038.jpg"/></inline-formula>, and <inline-formula><inline-graphic xlink:href="pgen.1002967.e039.jpg"/></inline-formula>, respectively, and the vector of all four frequencies be <inline-formula><inline-graphic xlink:href="pgen.1002967.e040.jpg"/></inline-formula>. We want to write down a joint distribution for <inline-formula><inline-graphic xlink:href="pgen.1002967.e041.jpg"/></inline-formula> given the tree. We start by writing down the covariance between any two populations with respect to the ancestral allele frequency (i.e. <inline-formula><inline-graphic xlink:href="pgen.1002967.e042.jpg"/></inline-formula>). This is simply the variance of the common ancestor of the two populations:<disp-formula id="pgen.1002967.e043"><graphic xlink:href="pgen.1002967.e043.jpg" position="anchor" orientation="portrait"/><label>(13)</label></disp-formula>
<disp-formula id="pgen.1002967.e044"><graphic xlink:href="pgen.1002967.e044.jpg" position="anchor" orientation="portrait"/><label>(14)</label></disp-formula>
<disp-formula id="pgen.1002967.e045"><graphic xlink:href="pgen.1002967.e045.jpg" position="anchor" orientation="portrait"/><label>(15)</label></disp-formula>and so on (<xref ref-type="fig" rid="pgen-1002967-g001">Figure 1B</xref>).</p>
        <fig id="pgen-1002967-g001" orientation="portrait" position="float">
          <object-id pub-id-type="doi">10.1371/journal.pgen.1002967.g001</object-id>
          <label>Figure 1</label>
          <caption>
            <title>Simple examples.</title>
            <p>A. An example tree. B. The covariance matrix implied by the tree structure in A. Note that the covariance here is with respect to the allele frequency at the root, and that each entry has been divided by <inline-formula><inline-graphic xlink:href="pgen.1002967.e046.jpg"/></inline-formula> to simplify the presentation. C. An example graph. The migration edge is colored red. Parental populations for population 3 are labeled <inline-formula><inline-graphic xlink:href="pgen.1002967.e047.jpg"/></inline-formula> and <inline-formula><inline-graphic xlink:href="pgen.1002967.e048.jpg"/></inline-formula>; see the main text for details. D. The covariance matrix implied by the graph in C; again, each entry has been divided by <inline-formula><inline-graphic xlink:href="pgen.1002967.e049.jpg"/></inline-formula>. The migration terms are in red, and the non-migration terms are in blue.</p>
          </caption>
          <graphic xlink:href="pgen.1002967.g001"/>
        </fig>
        <p>Let us use <inline-formula><inline-graphic xlink:href="pgen.1002967.e050.jpg"/></inline-formula> to denote the variance-covariance matrix of allele frequencies between populations implied by the tree. Now, if we knew the value of <inline-formula><inline-graphic xlink:href="pgen.1002967.e051.jpg"/></inline-formula>, we could model <inline-formula><inline-graphic xlink:href="pgen.1002967.e052.jpg"/></inline-formula> as:<disp-formula id="pgen.1002967.e053"><graphic xlink:href="pgen.1002967.e053.jpg" position="anchor" orientation="portrait"/><label>(16)</label></disp-formula>where <inline-formula><inline-graphic xlink:href="pgen.1002967.e054.jpg"/></inline-formula> and <inline-formula><inline-graphic xlink:href="pgen.1002967.e055.jpg"/></inline-formula> denotes the multivariate normal distribution. The covariance matrix <inline-formula><inline-graphic xlink:href="pgen.1002967.e056.jpg"/></inline-formula> is distinct from the sample covariance matrix; we return to this distinction later. This multivariate normal model was proposed by <xref rid="pgen.1002967-Felsenstein2" ref-type="bibr">[28]</xref>. Additionally, a multivariate normal model was used by Coop et al. <xref rid="pgen.1002967-Coop1" ref-type="bibr">[48]</xref> and Weir and Hill <xref rid="pgen.1002967-Weir1" ref-type="bibr">[49]</xref>, although these authors did not explicitly model the variance-covariance matrix in terms of a tree.</p>
      </sec>
      <sec id="s2a2">
        <title>Modeling migration</title>
        <p>To extend this framework to include migration, we allow populations to have ancestry from multiple parental populations <xref rid="pgen.1002967-CavalliSforza4" ref-type="bibr">[35]</xref>, <xref rid="pgen.1002967-Lathrop1" ref-type="bibr">[40]</xref>. The contribution of each parental population is weighted; if we assume admixture occurs in a single generation, these weights are related to the fraction of alleles in the descendant population that originated in each parental population. Consider population 3 in <xref ref-type="fig" rid="pgen-1002967-g001">Figure 1C</xref> (recall that the allele frequency in this population is <inline-formula><inline-graphic xlink:href="pgen.1002967.e057.jpg"/></inline-formula>). We have labeled the two parental populations <inline-formula><inline-graphic xlink:href="pgen.1002967.e058.jpg"/></inline-formula> and <inline-formula><inline-graphic xlink:href="pgen.1002967.e059.jpg"/></inline-formula>; let the allele frequencies in these populations be <inline-formula><inline-graphic xlink:href="pgen.1002967.e060.jpg"/></inline-formula> and <inline-formula><inline-graphic xlink:href="pgen.1002967.e061.jpg"/></inline-formula>, respectively. We model <inline-formula><inline-graphic xlink:href="pgen.1002967.e062.jpg"/></inline-formula> as:<disp-formula id="pgen.1002967.e063"><graphic xlink:href="pgen.1002967.e063.jpg" position="anchor" orientation="portrait"/><label>(17)</label></disp-formula>where <inline-formula><inline-graphic xlink:href="pgen.1002967.e064.jpg"/></inline-formula>. Note that there is some question as to how to weight <inline-formula><inline-graphic xlink:href="pgen.1002967.e065.jpg"/></inline-formula>, the genetic drift specific to population 3. In reality, it comes from three sources: drift since <inline-formula><inline-graphic xlink:href="pgen.1002967.e066.jpg"/></inline-formula> but before the population mixture, drift since <inline-formula><inline-graphic xlink:href="pgen.1002967.e067.jpg"/></inline-formula> but before the population mixture, and drift since the mixture. These three components should have weights <inline-formula><inline-graphic xlink:href="pgen.1002967.e068.jpg"/></inline-formula>, <inline-formula><inline-graphic xlink:href="pgen.1002967.e069.jpg"/></inline-formula>, and 1, respectively. However, the three components are not all separately identifiable. For ease of computation, we estimate only a single drift parameter in this situation, and weight it by <inline-formula><inline-graphic xlink:href="pgen.1002967.e070.jpg"/></inline-formula> (<xref ref-type="supplementary-material" rid="pgen.1002967.s016">Text S1</xref>, <xref ref-type="supplementary-material" rid="pgen.1002967.s001">Figure S1</xref>).</p>
        <p>Additionally, there is a choice of whether the edge from <inline-formula><inline-graphic xlink:href="pgen.1002967.e071.jpg"/></inline-formula> or the edge from <inline-formula><inline-graphic xlink:href="pgen.1002967.e072.jpg"/></inline-formula> should be considered the “migration” edge; these two possibilities not identifiable in the model. In practice, we set the edge with the largest weight as the non-migration edge, and the other edge (or edges) as the “migration” edge(s).</p>
        <p>With these simplifications, the variance of <inline-formula><inline-graphic xlink:href="pgen.1002967.e073.jpg"/></inline-formula> can be written in the mixture case as:<disp-formula id="pgen.1002967.e074"><graphic xlink:href="pgen.1002967.e074.jpg" position="anchor" orientation="portrait"/><label>(18)</label></disp-formula>
<disp-formula id="pgen.1002967.e075"><graphic xlink:href="pgen.1002967.e075.jpg" position="anchor" orientation="portrait"/><label>(19)</label></disp-formula>We can now consider multiple populations related by a graph instead of a tree (<xref ref-type="fig" rid="pgen-1002967-g001">Figure 1C</xref>). The variance-covariance matrix <inline-formula><inline-graphic xlink:href="pgen.1002967.e076.jpg"/></inline-formula> can be filled in as before, but now including terms for migration (<xref ref-type="fig" rid="pgen-1002967-g001">Figure 1D</xref>). This model can be written in terms of a directed acyclic graph (the lack of cycles follows from the fact that no population can contribute genetic material to its own ancestor), where the <inline-formula><inline-graphic xlink:href="pgen.1002967.e077.jpg"/></inline-formula> parameters correspond to edge lengths (<xref ref-type="supplementary-material" rid="pgen.1002967.s016">Text S1</xref>). For subsets of up to four populations, this model is closely related to the “<inline-formula><inline-graphic xlink:href="pgen.1002967.e078.jpg"/></inline-formula> statistics” used as tests for treeness by Reich et al. <xref rid="pgen.1002967-Reich1" ref-type="bibr">[37]</xref> (<xref ref-type="supplementary-material" rid="pgen.1002967.s016">Text S1</xref>).</p>
      </sec>
      <sec id="s2a3">
        <title>Normalization</title>
        <p>As described above, <inline-formula><inline-graphic xlink:href="pgen.1002967.e079.jpg"/></inline-formula> depends on the ancestral allele frequency <inline-formula><inline-graphic xlink:href="pgen.1002967.e080.jpg"/></inline-formula>. This means that the true variance-covariance matrix will differ by a scaling factor between SNPs with different values of <inline-formula><inline-graphic xlink:href="pgen.1002967.e081.jpg"/></inline-formula>. In much work on this type of model, investigators have normalized allele frequencies to account for this. One potential normalization is the arcsine square-root transformation <xref rid="pgen.1002967-CavalliSforza1" ref-type="bibr">[1]</xref>. However, a drawback to this normalization is that it is non-linear; the expected value of the allele frequency in the descendant populations is no longer <inline-formula><inline-graphic xlink:href="pgen.1002967.e082.jpg"/></inline-formula>, but pushed towards the boundaries, which could induce spurious correlations between the most drifted populations <xref rid="pgen.1002967-Felsenstein4" ref-type="bibr">[50]</xref>. Another plausible transformation would be to scale all allele frequencies by <inline-formula><inline-graphic xlink:href="pgen.1002967.e083.jpg"/></inline-formula>, where <inline-formula><inline-graphic xlink:href="pgen.1002967.e084.jpg"/></inline-formula> is the mean allele frequency across populations <xref rid="pgen.1002967-Patterson1" ref-type="bibr">[19]</xref>, <xref rid="pgen.1002967-Nicholson1" ref-type="bibr">[33]</xref>. Both of these transformations increase the influence of polymorphisms that were rare in the ancestral population. However, these are precisely the loci where the approximation of our model to a true population genetics model is most likely to break down. For these reasons, we choose to work directly with untransformed allele frequencies.</p>
      </sec>
      <sec id="s2a4">
        <title>Properties of the sample covariance</title>
        <p>In practice, the multivariate normal model in <xref ref-type="disp-formula" rid="pgen.1002967.e053">Equation 16</xref> is impractical because we do not know the ancestral values of allele frequencies, but instead only the values in sampled descendant populations. This means that <inline-formula><inline-graphic xlink:href="pgen.1002967.e085.jpg"/></inline-formula> cannot be estimated directly from data. However, consider instead the <italic>sample</italic> covariance matrix <inline-formula><inline-graphic xlink:href="pgen.1002967.e086.jpg"/></inline-formula>, where <inline-formula><inline-graphic xlink:href="pgen.1002967.e087.jpg"/></inline-formula>, where <inline-formula><inline-graphic xlink:href="pgen.1002967.e088.jpg"/></inline-formula>, <inline-formula><inline-graphic xlink:href="pgen.1002967.e089.jpg"/></inline-formula> is the number of populations, and <inline-formula><inline-graphic xlink:href="pgen.1002967.e090.jpg"/></inline-formula> and <inline-formula><inline-graphic xlink:href="pgen.1002967.e091.jpg"/></inline-formula> are the sample allele frequencies in populations <inline-formula><inline-graphic xlink:href="pgen.1002967.e092.jpg"/></inline-formula> and <inline-formula><inline-graphic xlink:href="pgen.1002967.e093.jpg"/></inline-formula>. <inline-formula><inline-graphic xlink:href="pgen.1002967.e094.jpg"/></inline-formula> is closely related to <inline-formula><inline-graphic xlink:href="pgen.1002967.e095.jpg"/></inline-formula> as follows:<disp-formula id="pgen.1002967.e096"><graphic xlink:href="pgen.1002967.e096.jpg" position="anchor" orientation="portrait"/><label>(20)</label></disp-formula>
<disp-formula id="pgen.1002967.e097"><graphic xlink:href="pgen.1002967.e097.jpg" position="anchor" orientation="portrait"/><label>(21)</label></disp-formula>
<disp-formula id="pgen.1002967.e098"><graphic xlink:href="pgen.1002967.e098.jpg" position="anchor" orientation="portrait"/><label>(22)</label></disp-formula>
<disp-formula id="pgen.1002967.e099"><graphic xlink:href="pgen.1002967.e099.jpg" position="anchor" orientation="portrait"/><label>(23)</label></disp-formula>In the following section, we will describe how we perform inference based on the sample covariance matrix <inline-formula><inline-graphic xlink:href="pgen.1002967.e100.jpg"/></inline-formula>.</p>
      </sec>
      <sec id="s2a5">
        <title>Estimation from finite samples and many SNPs</title>
        <p>Now assume that we have genotyped <inline-formula><inline-graphic xlink:href="pgen.1002967.e101.jpg"/></inline-formula> SNPs in each of <inline-formula><inline-graphic xlink:href="pgen.1002967.e102.jpg"/></inline-formula> populations. Our goal is to use these data to estimate the population history graph <inline-formula><inline-graphic xlink:href="pgen.1002967.e103.jpg"/></inline-formula>: that is, <inline-formula><inline-graphic xlink:href="pgen.1002967.e104.jpg"/></inline-formula> is a rooted, directed, acyclic graph with specified branch lengths and mixture weights, as described above and in <xref ref-type="supplementary-material" rid="pgen.1002967.s016">Text S1</xref>. Let the sample allele frequency at SNP <inline-formula><inline-graphic xlink:href="pgen.1002967.e105.jpg"/></inline-formula> in population <inline-formula><inline-graphic xlink:href="pgen.1002967.e106.jpg"/></inline-formula> be <inline-formula><inline-graphic xlink:href="pgen.1002967.e107.jpg"/></inline-formula>. We can estimate the sample covariance matrix <inline-formula><inline-graphic xlink:href="pgen.1002967.e108.jpg"/></inline-formula>:<disp-formula id="pgen.1002967.e109"><graphic xlink:href="pgen.1002967.e109.jpg" position="anchor" orientation="portrait"/><label>(24)</label></disp-formula>where <inline-formula><inline-graphic xlink:href="pgen.1002967.e110.jpg"/></inline-formula>. The fact that in practice we have finite samples from each population and a finite number of SNPs has two effects on this matrix. First, sampling leads to a biased estimation of the terms on the diagonal, since sampling can be thought of as adding an amount of “drift” to each population (as well as smaller effects on the off-diagonal terms; see <xref ref-type="supplementary-material" rid="pgen.1002967.s016">Text S1</xref> for details). Additionally, it leads to some uncertainty in all terms. To account for the biased diagonal terms, in practice we calculate a corrected version of <inline-formula><inline-graphic xlink:href="pgen.1002967.e111.jpg"/></inline-formula> that removes this bias (<xref ref-type="supplementary-material" rid="pgen.1002967.s016">Text S1</xref>). To account for uncertainty in the values of this matrix, we use a block resampling approach (see below). Finally, with multiple SNPs, we are working with SNPs with many different values of <inline-formula><inline-graphic xlink:href="pgen.1002967.e112.jpg"/></inline-formula>. In this case, the <inline-formula><inline-graphic xlink:href="pgen.1002967.e113.jpg"/></inline-formula> terms described above can be thought of as <inline-formula><inline-graphic xlink:href="pgen.1002967.e114.jpg"/></inline-formula>; i.e., the mean across SNPs of <inline-formula><inline-graphic xlink:href="pgen.1002967.e115.jpg"/></inline-formula>.</p>
        <p>We now want to write down a likelihood for <inline-formula><inline-graphic xlink:href="pgen.1002967.e116.jpg"/></inline-formula> given <inline-formula><inline-graphic xlink:href="pgen.1002967.e117.jpg"/></inline-formula> (which in turn implies the expected sample covariance matrix <inline-formula><inline-graphic xlink:href="pgen.1002967.e118.jpg"/></inline-formula>). One possibility would be to use the Wishart distribution, since the sample covariance matrix of multivariate normal random variables has this form. However, computation of the Wishart density involves computationally-intensive matrix inversion, so we took an alternative approach. Consider the observed covariance between populations <inline-formula><inline-graphic xlink:href="pgen.1002967.e119.jpg"/></inline-formula> and <inline-formula><inline-graphic xlink:href="pgen.1002967.e120.jpg"/></inline-formula>, <inline-formula><inline-graphic xlink:href="pgen.1002967.e121.jpg"/></inline-formula>. If we had a large number of independent genomic regions and estimated this quantity separately in each independent region, the sampling distribution would be approximately normal with mean <inline-formula><inline-graphic xlink:href="pgen.1002967.e122.jpg"/></inline-formula> (by appeal to the central limit theorem). We thus model <inline-formula><inline-graphic xlink:href="pgen.1002967.e123.jpg"/></inline-formula> as:<disp-formula id="pgen.1002967.e124"><graphic xlink:href="pgen.1002967.e124.jpg" position="anchor" orientation="portrait"/><label>(25)</label></disp-formula>where <inline-formula><inline-graphic xlink:href="pgen.1002967.e125.jpg"/></inline-formula> is the standard error in the estimation of <inline-formula><inline-graphic xlink:href="pgen.1002967.e126.jpg"/></inline-formula>. Because the allele frequencies at nearby SNPs are correlated (i.e., there is linkage disequilibrium), a naive estimate of <inline-formula><inline-graphic xlink:href="pgen.1002967.e127.jpg"/></inline-formula> that treated each SNP as independent would be too small. We instead take a resampling approach to estimate <inline-formula><inline-graphic xlink:href="pgen.1002967.e128.jpg"/></inline-formula>. We split the genome into <inline-formula><inline-graphic xlink:href="pgen.1002967.e129.jpg"/></inline-formula> blocks, such that there are <inline-formula><inline-graphic xlink:href="pgen.1002967.e130.jpg"/></inline-formula> SNPs per block (with <inline-formula><inline-graphic xlink:href="pgen.1002967.e131.jpg"/></inline-formula> chosen so that the block sizes are larger than blocks of linkage disequilibrium) <xref rid="pgen.1002967-Keinan1" ref-type="bibr">[36]</xref>. (If <inline-formula><inline-graphic xlink:href="pgen.1002967.e132.jpg"/></inline-formula> does not divide evenly into <inline-formula><inline-graphic xlink:href="pgen.1002967.e133.jpg"/></inline-formula>, we discard the remaining SNPs.) We then calculate <inline-formula><inline-graphic xlink:href="pgen.1002967.e134.jpg"/></inline-formula> separately in each block. Let <inline-formula><inline-graphic xlink:href="pgen.1002967.e135.jpg"/></inline-formula> be the sample covariance between two populations <inline-formula><inline-graphic xlink:href="pgen.1002967.e136.jpg"/></inline-formula> and <inline-formula><inline-graphic xlink:href="pgen.1002967.e137.jpg"/></inline-formula> in block <inline-formula><inline-graphic xlink:href="pgen.1002967.e138.jpg"/></inline-formula>. Now,<disp-formula id="pgen.1002967.e139"><graphic xlink:href="pgen.1002967.e139.jpg" position="anchor" orientation="portrait"/><label>(26)</label></disp-formula>and<disp-formula id="pgen.1002967.e140"><graphic xlink:href="pgen.1002967.e140.jpg" position="anchor" orientation="portrait"/><label>(27)</label></disp-formula>If we take each pair of populations in turn, we can write down a composite likelihood for <inline-formula><inline-graphic xlink:href="pgen.1002967.e141.jpg"/></inline-formula>:<disp-formula id="pgen.1002967.e142"><graphic xlink:href="pgen.1002967.e142.jpg" position="anchor" orientation="portrait"/><label>(28)</label></disp-formula>where <inline-formula><inline-graphic xlink:href="pgen.1002967.e143.jpg"/></inline-formula> is a Gaussian density with mean <inline-formula><inline-graphic xlink:href="pgen.1002967.e144.jpg"/></inline-formula> (computed from <inline-formula><inline-graphic xlink:href="pgen.1002967.e145.jpg"/></inline-formula> by <xref ref-type="disp-formula" rid="pgen.1002967.e099">Equation 23</xref>) and variance <inline-formula><inline-graphic xlink:href="pgen.1002967.e146.jpg"/></inline-formula> evaluated at <inline-formula><inline-graphic xlink:href="pgen.1002967.e147.jpg"/></inline-formula>.</p>
      </sec>
      <sec id="s2a6">
        <title>Measuring model fit</title>
        <p>Finally, we wanted to define measures for how well the model fits the data. First, we define the matrix of residuals in this model, <inline-formula><inline-graphic xlink:href="pgen.1002967.e148.jpg"/></inline-formula>. These quantities are useful for visualization and fitting:<disp-formula id="pgen.1002967.e149"><graphic xlink:href="pgen.1002967.e149.jpg" position="anchor" orientation="portrait"/><label>(29)</label></disp-formula>Positive residuals indicate pairs of populations where the model underestimates the observed covariance, and thus populations where the fit might be improved by adding additional edges. Negative residuals indicate pairs of populations where the model overestimates the observed covariance; these are a necessary outcome of having positive residuals, but can also sometimes be interpreted as populations that are forced too close together due to unmodeled migration elsewhere in the graph. These residuals can be used to define a measure of the fraction of the variance in <inline-formula><inline-graphic xlink:href="pgen.1002967.e150.jpg"/></inline-formula> that is explained by <inline-formula><inline-graphic xlink:href="pgen.1002967.e151.jpg"/></inline-formula>. Let us call this fraction <inline-formula><inline-graphic xlink:href="pgen.1002967.e152.jpg"/></inline-formula>:<disp-formula id="pgen.1002967.e153"><graphic xlink:href="pgen.1002967.e153.jpg" position="anchor" orientation="portrait"/><label>(30)</label></disp-formula>where <inline-formula><inline-graphic xlink:href="pgen.1002967.e154.jpg"/></inline-formula> and <inline-formula><inline-graphic xlink:href="pgen.1002967.e155.jpg"/></inline-formula>. This quantity approximates the fraction of the variance in relatedness between populations that is accounted for by the model.</p>
      </sec>
      <sec id="s2a7">
        <title>Implementation</title>
        <p>We implemented an algorithm, called <italic>TreeMix</italic>, that searches for the graph that maximizes the composite likelihood in <xref ref-type="disp-formula" rid="pgen.1002967.e142">Equation 28</xref>. A search that enumerates all graphs is infeasible unless <inline-formula><inline-graphic xlink:href="pgen.1002967.e156.jpg"/></inline-formula> is very small, so to simplify the search we make the assumption that the history of the sampled populations is approximately tree-like. We thus start by searching for the maximum likelihood tree, taking an algorithmic approach similar to Felsenstein <xref rid="pgen.1002967-Felsenstein3" ref-type="bibr">[30]</xref>.</p>
        <p>After building the tree, we fix the position of the root. (In the tree model the position of the root is not identifiable, as the evolution of allele frequencies along the tree is reversible under the Gaussian model when drift is assumed to be small. In a graph model, though the position of the root is partially identifiable, in all applications we assume that the position of the root is fixed using prior information about known outgroups). We then calculate the residual covariance matrix, <inline-formula><inline-graphic xlink:href="pgen.1002967.e157.jpg"/></inline-formula>, and add migration edges in a directed matter. First, we find the <inline-formula><inline-graphic xlink:href="pgen.1002967.e158.jpg"/></inline-formula> pairs of populations with the maximum residuals. We then attempt adding a migration edge between populations in the vicinity of each of the <inline-formula><inline-graphic xlink:href="pgen.1002967.e159.jpg"/></inline-formula> population pairs. For each attempted graph (or tree) topology, we optimize the branch lengths and migration edge weights (Methods).</p>
        <p>After finding the single migration edge that most increases the likelihood, we attempt a series of local changes to the graph structure (Methods). We then iterate over this procedure to add additional migration edges. In principle, migration edges could be added until they are no longer statistically significant (see the following paragraph). In our experience, however, we prefer to stop adding migration events well before this point so that the resulting graph remains interpretable.</p>
      </sec>
      <sec id="s2a8">
        <title>Significance testing</title>
        <p>After building the maximum likelihood graph, we would like to quantify our uncertainty in the resulting graph structure. In particular, we would like to quantify our confidence in individual migration events. However, because the likelihood in <xref ref-type="disp-formula" rid="pgen.1002967.e142">Equation 28</xref> is a composite likelihood, it cannot be used directly for formal tests for significance. Instead, we take a resampling approach to test the support for individual migration edges.</p>
        <p>Consider a given migration edge, with corresponding weight <inline-formula><inline-graphic xlink:href="pgen.1002967.e160.jpg"/></inline-formula>. We wish to calculate a p-value for this weight (under the null hypothesis that <inline-formula><inline-graphic xlink:href="pgen.1002967.e161.jpg"/></inline-formula>, and for a fixed graph structure). To do this, we use the Wald statistic <inline-formula><inline-graphic xlink:href="pgen.1002967.e162.jpg"/></inline-formula>, where <inline-formula><inline-graphic xlink:href="pgen.1002967.e163.jpg"/></inline-formula> is the standard error in the estimate of the weight, which is distributed <inline-formula><inline-graphic xlink:href="pgen.1002967.e164.jpg"/></inline-formula> under the null. To obtain the standard error, recall that we have split the genome into <inline-formula><inline-graphic xlink:href="pgen.1002967.e165.jpg"/></inline-formula> independent blocks. We use the jackknife estimates of both <inline-formula><inline-graphic xlink:href="pgen.1002967.e166.jpg"/></inline-formula> and the standard error in <inline-formula><inline-graphic xlink:href="pgen.1002967.e167.jpg"/></inline-formula> (where we jackknife over blocks). Let <inline-formula><inline-graphic xlink:href="pgen.1002967.e168.jpg"/></inline-formula> index blocks, and <inline-formula><inline-graphic xlink:href="pgen.1002967.e169.jpg"/></inline-formula> be the estimated weight computed using all blocks <italic>except</italic>
<inline-formula><inline-graphic xlink:href="pgen.1002967.e170.jpg"/></inline-formula>. Then:<disp-formula id="pgen.1002967.e171"><graphic xlink:href="pgen.1002967.e171.jpg" position="anchor" orientation="portrait"/><label>(31)</label></disp-formula>
<disp-formula id="pgen.1002967.e172"><graphic xlink:href="pgen.1002967.e172.jpg" position="anchor" orientation="portrait"/><label>(32)</label></disp-formula>This allows us to calculate a p-value for the migration edge. There are a number of complications to the interpretation of this p-value. First, there is the issue of multiple testing–there are at least <inline-formula><inline-graphic xlink:href="pgen.1002967.e173.jpg"/></inline-formula> edges in the graph (recall that <inline-formula><inline-graphic xlink:href="pgen.1002967.e174.jpg"/></inline-formula> is the number of populations), and thus around <inline-formula><inline-graphic xlink:href="pgen.1002967.e175.jpg"/></inline-formula> possible migration events. More importantly, the p-value is generated under a heavily parameterized model: we are comparing a fixed graph structure with a migration event to that same graph without the migration event. A “significant” p-value simply indicates that the hypothesized migration event significantly improves the fit to the data; this does not account for the possibility of errors in the graph structure, or indicate that the particular migration event tested is the correct one (rather than a migration event between a different pair of populations). For this reason, we treat the precise p-value generated by this procedure with caution, and use additional, less-parameterized methods like three- and four-population tests <xref rid="pgen.1002967-Reich1" ref-type="bibr">[37]</xref> to test the robustness of the inference.</p>
      </sec>
    </sec>
    <sec id="s2b">
      <title>Simulations</title>
      <p>We tested the performance of the <italic>TreeMix</italic> method in simulations. We generated coalescent simulations from several histories; the basic structure was a set of 20 populations produced by a serial bottleneck model like that used by DeGiorgio et al. <xref rid="pgen.1002967-DeGiorgio1" ref-type="bibr">[51]</xref> to model human history (<xref ref-type="fig" rid="pgen-1002967-g002">Figure 2A</xref>). The parameters of the simulations were chosen to be reasonable for non-African human populations; we used an effective population size of 10,000, and a history where all 20 populations share a common ancestor 2000 generations in the past. Each individual simulation involved 400 regions of approximately 500 kb each, and thus recapitulated many aspects of real data, including hundreds of thousands of loci and the presence of linkage disequilibrium.</p>
      <fig id="pgen-1002967-g002" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pgen.1002967.g002</object-id>
        <label>Figure 2</label>
        <caption>
          <title>Performance on simulated data.</title>
          <p>A. The basic outline of the demographic model used. B. Trees inferred by <italic>TreeMix</italic>. We simulated 100 independent data sets, under the demographic model in A., and inferred the tree. All simulations gave the same topology; plotted are the mean branch lengths. C. Performance in the presence of migration. We added migration events to the tree in A. and inferred the structure of the graph. Each point represents the error rate over 100 independent simulations, defined as the fraction of simulations where the inferred graph topology does not perfectly match the simulated topology. On the x-axis we show the populations involved in the simulated migration event; e.g., if the source population is 1 and the destination population is 10, this is a migration event from population 1 to population 10, as labeled in A. D. Admixture weight estimation. We simulated admixture events with different weights from population 1 to population 10, and inferred the weight. Each point is the mean across 100 simulations, and the bar represents the range.</p>
        </caption>
        <graphic xlink:href="pgen.1002967.g002"/>
      </fig>
      <sec id="s2b1">
        <title>Tree simulations</title>
        <p>First, we tested the performance of the algorithm on truly tree-like data. We generated 100 independent simulations of 20 chromosomes from each population using the above demographic model without migration, and inferred population trees. The inferred trees perfectly matched the simulated model in all cases (<xref ref-type="fig" rid="pgen-1002967-g002">Figure 2B</xref>, <xref ref-type="supplementary-material" rid="pgen.1002967.s002">Figure S2</xref>), and the fitted tree model accounted for an average of 99.8% of the variance in <inline-formula><inline-graphic xlink:href="pgen.1002967.e176.jpg"/></inline-formula>. To test the effect of SNP ascertainment, we then inferred trees using only SNPs that were polymorphic in one of the populations (either population 1 or population 20); this ascertainment scheme did not decrease accuracy of the inferred topology, though it did alter the inferred branch lengths (<xref ref-type="supplementary-material" rid="pgen.1002967.s003">Figure S3</xref>).</p>
        <p>We used these simulations without migration to test the calibration of our p-values for migration events. For each simulation, after building the maximum likelihood tree, we introduced a migration event between two random populations and tested it for significance. As expected if the p-values are properly calibrated, their distribution is approximately uniform (<xref ref-type="supplementary-material" rid="pgen.1002967.s004">Figure S4</xref>).</p>
        <p>Finally, we performed tree simulations in a situation where fixed differences and new mutations (rather than shared polymorphisms inherited from a common ancestor) were common between the populations; in this context the population genetic interpretation of the model breaks down. We performed simulations where all the true branch lengths were 50 times longer than in the original model, corresponding to a history where the 20 populations share a common ancestor approximately 100,000 generations in the past. Again, we see no errors in the topology of the inferred trees (Figures S5, S6). In this situation, the covariances between closely-related populations tend to be slightly underestimated; in more extreme situations this could lead to spurious inferences of migration (Figures S5, S6). However, overall, these simulations suggest that the model will still be useful even in situations where the population genetic interpretation is not strictly correct.</p>
      </sec>
      <sec id="s2b2">
        <title>Simulations with migration</title>
        <p>We then introduced migration events into our simulations. We generated simulations under the same model described above; however, we now simulated an admixture event approximately 100 generations before the present where one population receives a fraction of its ancestry (either 10% or 30%) from one of the other populations. We tried ten different pairwise combinations of populations, and generated 100 simulations for each pair. For each simulation, we ran <italic>TreeMix</italic> and allowed it to infer a migration event. We then judged the error rate of the algorithm as the fraction of times the inferred topology of the graph was not exactly correct (this is a conservative estimate of the error rate, in that inferred graph topologies that are very close to the truth are counted as errors). In general, <italic>TreeMix</italic> was able to correctly infer the graph structure in these simulations (<xref ref-type="fig" rid="pgen-1002967-g002">Figure 2C</xref>). However, accuracy dropped considerably when migration was between closely related populations without outgroups present in the data (these are populations 1 and 20 in the model; <xref ref-type="fig" rid="pgen-1002967-g002">Figure 2C</xref>). The major types of errors produced in the simulations were incorrectly inferred directions of migration arrows and inference of admixture in populations related to the truly admixed population (<xref ref-type="supplementary-material" rid="pgen.1002967.s016">Text S1</xref>, <xref ref-type="supplementary-material" rid="pgen.1002967.s007">Figure S7</xref>).</p>
        <p>We next asked whether the mixture “weights” inferred in the model can be interpreted as admixture proportions. To do this, we simulated admixture events of varying proportion between the first and tenth population in the serial bottleneck model described above, set the graph to the true topology, and estimated the mixture weight. The weights are indeed correlated with the true ancestry fraction, but underestimate relatively high admixture proportions in these simulations (<xref ref-type="fig" rid="pgen-1002967-g002">Figure 2D</xref>). The precise bias in the estimation of this parameter will depend, in real data, on largely unknowable parameters (<xref ref-type="supplementary-material" rid="pgen.1002967.s016">Text S1</xref>).</p>
      </sec>
    </sec>
    <sec id="s2c">
      <title>Application to humans</title>
      <p>To test the performance of the <italic>TreeMix</italic> model with real data, we applied it to humans, whose genetic history has been studied extensively <xref rid="pgen.1002967-Li1" ref-type="bibr">[7]</xref>, <xref rid="pgen.1002967-Rosenberg1" ref-type="bibr">[21]</xref>, <xref rid="pgen.1002967-Jakobsson1" ref-type="bibr">[52]</xref>, <xref rid="pgen.1002967-Hellenthal1" ref-type="bibr">[53]</xref>. We applied the model to a dataset consisting of about 125,000 SNPs ascertained by low-coverage genome sequencing in a single Yoruban individual and then genotyped in 55 modern and archaic human populations <xref rid="pgen.1002967-Patterson2" ref-type="bibr">[54]</xref>. In all that follows, we excluded the two Oceanian populations because they gave inconsistent results across datasets. We believe this difficulty results from the fact that these populations contain ancestry from multiple sources, making the graph estimation somewhat unstable when they are included (<xref ref-type="supplementary-material" rid="pgen.1002967.s016">Text S1</xref>, <xref ref-type="supplementary-material" rid="pgen.1002967.s012">Figure S12</xref>). We first built the tree of all 53 remaining populations (<xref ref-type="fig" rid="pgen-1002967-g003">Figure 3A</xref>). This tree largely recapitulates the known relationships among population groups <xref rid="pgen.1002967-Li1" ref-type="bibr">[7]</xref>, and explains 98.8% of the variance in relatedness between populations (though this is high, it is less than the 99.8% observed in the simulations of a true tree model). We examined the residuals of the model's fit to identify aspects of ancestry not captured by the tree (<xref ref-type="fig" rid="pgen-1002967-g003">Figure 3B</xref>). A number of known admixed populations stand out: in particular, these include the Mozabite and Middle Eastern populations.</p>
      <fig id="pgen-1002967-g003" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pgen.1002967.g003</object-id>
        <label>Figure 3</label>
        <caption>
          <title>Inferred human tree.</title>
          <p>A. Maximum likelihood tree. Plotted is the maximum-likelihood tree. Populations are colored according to geographic location (black: archaic humans, red: Africa, brown: Middle East, green: Europe, blue: Central Asia, purple: America, orange: East Asia). The scale bar shows ten times the average standard error of the entries in the sample covariance matrix (<inline-formula><inline-graphic xlink:href="pgen.1002967.e177.jpg"/></inline-formula>). For analysis including Oceania, see Figures S11 and S12. B. Residual fit. Plotted is the residual fit from the maximum likelihood tree in A. We divided the residual covariance between each pair of populations <inline-formula><inline-graphic xlink:href="pgen.1002967.e178.jpg"/></inline-formula> and <inline-formula><inline-graphic xlink:href="pgen.1002967.e179.jpg"/></inline-formula> by the average standard error across all pairs. We then plot in each cell <inline-formula><inline-graphic xlink:href="pgen.1002967.e180.jpg"/></inline-formula> this scaled residual. Colors are described in the palette on the right. Residuals above zero represent populations that are more closely related to each other in the data than in the best-fit tree, and thus are candidates for admixture events.</p>
        </caption>
        <graphic xlink:href="pgen.1002967.g003"/>
      </fig>
      <p>We then sequentially added migration events to the tree. In <xref ref-type="fig" rid="pgen-1002967-g004">Figure 4</xref>, we show the inferred graph with ten migration edges; p-values for all reported migration edges are less than <inline-formula><inline-graphic xlink:href="pgen.1002967.e181.jpg"/></inline-formula> (we show the graph with the maximum likelihood over several independent runs of <italic>TreeMix</italic> with random orders of input populations). This graph model explains 99.8% of the variance in relatedness between populations. As expected from examination of <xref ref-type="fig" rid="pgen-1002967-g003">Figure 3B</xref>, the migration events recapitulate many known events in human history. We infer that the Mozabite are the result of admixture between an African and a Middle Eastern population (with about 33% of their ancestry from Africa), and that Middle Eastern populations also have African ancestry (Palestinians and Bedouins: <inline-formula><inline-graphic xlink:href="pgen.1002967.e182.jpg"/></inline-formula> from Africa; Druze: <inline-formula><inline-graphic xlink:href="pgen.1002967.e183.jpg"/></inline-formula>). This is consistent with previously reported admixture proportions from these populations <xref rid="pgen.1002967-Moorjani1" ref-type="bibr">[43]</xref>, <xref rid="pgen.1002967-Price1" ref-type="bibr">[55]</xref>. Additionally, we identify the known European ancestry in the Maya (<inline-formula><inline-graphic xlink:href="pgen.1002967.e184.jpg"/></inline-formula>) <xref rid="pgen.1002967-Rosenberg1" ref-type="bibr">[21]</xref>, and infer that the Uyghur and Hazara populations are the result of admixture between west Eurasian and East Asian populations (<inline-formula><inline-graphic xlink:href="pgen.1002967.e185.jpg"/></inline-formula> and <inline-formula><inline-graphic xlink:href="pgen.1002967.e186.jpg"/></inline-formula> from west Eurasia, respectively) <xref rid="pgen.1002967-Lawson1" ref-type="bibr">[20]</xref>, <xref rid="pgen.1002967-Rosenberg1" ref-type="bibr">[21]</xref>, <xref rid="pgen.1002967-Xu1" ref-type="bibr">[56]</xref>.</p>
      <fig id="pgen-1002967-g004" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pgen.1002967.g004</object-id>
        <label>Figure 4</label>
        <caption>
          <title>Inferred human tree with mixture events.</title>
          <p>Plotted is the structure of the graph inferred by <italic>TreeMix</italic> for human populations, allowing ten migration events. Migration arrows are colored according to their weight. Horizontal branch lengths are proportional to the amount of genetic drift that has occurred on the branch. The scale bar shows ten times the average standard error of the entries in the sample covariance matrix (<inline-formula><inline-graphic xlink:href="pgen.1002967.e187.jpg"/></inline-formula>). The residual fit from this graph is shown in <xref ref-type="supplementary-material" rid="pgen.1002967.s009">Figure S9</xref>. Admixture from Neandertals to non-African populations is only apparent when considering subsets of the data (see Discussion and <xref ref-type="supplementary-material" rid="pgen.1002967.s015">Figure S15</xref>).</p>
        </caption>
        <graphic xlink:href="pgen.1002967.g004"/>
      </fig>
      <p>Several additional migration events in the human data have not been previously examined in detail, but are consistent with previous clustering analysis of these populations <xref rid="pgen.1002967-Li1" ref-type="bibr">[7]</xref>, <xref rid="pgen.1002967-Lawson1" ref-type="bibr">[20]</xref>, <xref rid="pgen.1002967-Rosenberg1" ref-type="bibr">[21]</xref>. These include migration from Africa to the Makrani and Brahui in Central Asia (<inline-formula><inline-graphic xlink:href="pgen.1002967.e188.jpg"/></inline-formula>) and from a population related to East Asians and Native Americans (which we interpret as likely Siberian) to Russia (<inline-formula><inline-graphic xlink:href="pgen.1002967.e189.jpg"/></inline-formula>).</p>
      <p>Two inferred edges were unexpected. First, perhaps the most surprising inference is that Cambodians trace about 16% of their ancestry to a population equally related to both Europeans and other East Asians (while the remaining 84% of their ancestry is related to other southeast Asians). This is partially consistent with clustering analyses, which indicate shared ancestry between Cambodians and central Asian populations <xref rid="pgen.1002967-Li1" ref-type="bibr">[7]</xref>. To confirm that the Cambodians are admixed, we turned to less parameterized models. The predicted admixture event implies that allele frequencies in Cambodia are more similar to those in African populations than would be expected based on their East Asian ancestry. To test this, we used three-population tests <xref rid="pgen.1002967-Reich1" ref-type="bibr">[37]</xref>. We tested the trees [African, [Cambodian,Dai]] for evidence of admixture in the Cambodians (Methods). When using any African population, there is strong evidence of admixture (when using Yoruba, <inline-formula><inline-graphic xlink:href="pgen.1002967.e190.jpg"/></inline-formula> [<inline-formula><inline-graphic xlink:href="pgen.1002967.e191.jpg"/></inline-formula>]; when using Mandenka, <inline-formula><inline-graphic xlink:href="pgen.1002967.e192.jpg"/></inline-formula> [<inline-formula><inline-graphic xlink:href="pgen.1002967.e193.jpg"/></inline-formula>]; when using San, <inline-formula><inline-graphic xlink:href="pgen.1002967.e194.jpg"/></inline-formula> [<inline-formula><inline-graphic xlink:href="pgen.1002967.e195.jpg"/></inline-formula>]). We conclude that the Cambodian population is the result of an admixture event involving a southeast Asian population related to the Dai and a Eurasian population only distantly related to those present in these data.</p>
      <p>Finally, we infer an admixture edge from the Middle East (a population related to the Mozabite, a Berber population from northern Africa) to southern European populations (<inline-formula><inline-graphic xlink:href="pgen.1002967.e196.jpg"/></inline-formula>). This migration edge is the one edge that is not consistent across independent runs of <italic>TreeMix</italic> on these data (<xref ref-type="supplementary-material" rid="pgen.1002967.s008">Figure S8</xref>). In particular, an alternative graph (albeit with lower likelihood) places the Mozabite as an admixture between southern Europe and Africa (rather than the Middle East and Africa), and does not include an edge from the middle East to southern Europe. We thus hesitate to interpret this result, except to note that the relationship between northern African, the Middle East, and southern Europe involves complex patterns of gene flow that merit further investigation <xref rid="pgen.1002967-Moorjani1" ref-type="bibr">[43]</xref>, <xref rid="pgen.1002967-Henn1" ref-type="bibr">[57]</xref>.</p>
      <p>To test the robustness of our results to SNP ascertainment, we additionally ran <italic>TreeMix</italic> on the same set of populations using a set of SNPs ascertained in a single French individual. The inferred graph was nearly identical (<xref ref-type="supplementary-material" rid="pgen.1002967.s010">Figure S10</xref>). Additionally, as noted above, different random input orders for the populations gave very similar results (<xref ref-type="supplementary-material" rid="pgen.1002967.s008">Figure S8</xref>). We conclude from this that the model is able to consistently and accurately infer the major mixture events in the history of a species. This approach is computationally efficient: building the tree took around five minutes on a standard desktop computer (with a processor speed of 3.1 GHz), and adding ten migration events to the tree took about four and a half hours (the major computational cost is in the iterative estimation of migration weights).</p>
    </sec>
    <sec id="s2d">
      <title>Application to dogs</title>
      <p>While human populations have been extensively studied, we next applied the model to dogs, a species where considerably less is known about population history. In particular, we applied the model to a dataset consisting of about 60,000 SNPs genotyped in 82 dog breeds or wild canids <xref rid="pgen.1002967-Boyko1" ref-type="bibr">[58]</xref>. As for humans, we first inferred the maximum likelihood tree (<xref ref-type="fig" rid="pgen-1002967-g005">Figure 5A</xref>). The differences in history between dogs and humans are striking: there are long terminal branches leading to each dog breed in the inferred tree (<xref ref-type="fig" rid="pgen-1002967-g005">Figure 5A</xref>, recall that the terminal branch lengths account for sample size). This is consistent with the known strong bottlenecks in the establishment of dog breeds <xref rid="pgen.1002967-vonHoldt1" ref-type="bibr">[23]</xref>. However, examining the residuals from the model revealed a number of populations that do not fit a strict tree model (<xref ref-type="fig" rid="pgen-1002967-g005">Figure 5B</xref>); indeed, the tree model explained 94.7% of the variance in relatedness between breeds, somewhat less than between human populations.</p>
      <fig id="pgen-1002967-g005" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pgen.1002967.g005</object-id>
        <label>Figure 5</label>
        <caption>
          <title>Inferred dog tree.</title>
          <p>A. Maximum likelihood tree. Populations are colored according to breed type. Dark blue: wild canids, grey: ancient breeds, brown: spitz breeds, black: toy dogs, red: spaniels, maroon: scent hounds, dark red: working dogs, light green: herding dogs, light blue: mastiff-like dogs, purple: small terriers, orange: retrievers, dark green: sight hounds. The scale bar shows ten times the average standard error of the entries in the sample covariance matrix (<inline-formula><inline-graphic xlink:href="pgen.1002967.e197.jpg"/></inline-formula>). B. Residual fit. Plotted is the residual fit from the maximum likelihood tree in A. We divided the residual covariance between each pair of populations <inline-formula><inline-graphic xlink:href="pgen.1002967.e198.jpg"/></inline-formula> and <inline-formula><inline-graphic xlink:href="pgen.1002967.e199.jpg"/></inline-formula> by the average standard error across all pairs. We then plot in each cell <inline-formula><inline-graphic xlink:href="pgen.1002967.e200.jpg"/></inline-formula> this scaled residual. Colors are described in the palette on the right.</p>
        </caption>
        <graphic xlink:href="pgen.1002967.g005"/>
      </fig>
      <p>We sequentially added migration events to the tree in <xref ref-type="fig" rid="pgen-1002967-g005">Figure 5A</xref>. In <xref ref-type="fig" rid="pgen-1002967-g006">Figure 6</xref>, we show the inferred graph with ten migration events, which explains 96.8% of the variance in relatedness between breeds (which suggests that additional events exist in the data). In the following paragraphs, we describe some of these events.</p>
      <fig id="pgen-1002967-g006" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pgen.1002967.g006</object-id>
        <label>Figure 6</label>
        <caption>
          <title>Inferred dog graph.</title>
          <p>Plotted is the structure of the graph inferred by <italic>TreeMix</italic> for dog populations, allowing ten migration events. Migration arrows are colored according to their weight. The scale bar shows ten times the average standard error of the entries in the sample covariance matrix (<inline-formula><inline-graphic xlink:href="pgen.1002967.e201.jpg"/></inline-formula>). See the main text for discussion. The residual fit from this graph is presented in <xref ref-type="supplementary-material" rid="pgen.1002967.s013">Figure S13</xref>.</p>
        </caption>
        <graphic xlink:href="pgen.1002967.g006"/>
      </fig>
      <p>We infer that the bull mastiff is the result of an admixture event between bulldogs and mastiffs. This is a known event <xref rid="pgen.1002967-American1" ref-type="bibr">[59]</xref>; we estimate the admixture proportions as 33% bulldog and 67% mastiff. We further examined this event using four-population tests for treeness. As expected given the known history, the tree [[boxer,bulldog],[mastiff,bull mastiff]] fails the four-population test (<inline-formula><inline-graphic xlink:href="pgen.1002967.e202.jpg"/></inline-formula>, <inline-formula><inline-graphic xlink:href="pgen.1002967.e203.jpg"/></inline-formula>), while replacing the bull mastiff with other related breeds that we do not predict to be involved in the admixture event results in trees that pass this test. For example, the tree [[boxer,bulldog],[mastiff,Boston terrier]] passes the four-population test with <inline-formula><inline-graphic xlink:href="pgen.1002967.e204.jpg"/></inline-formula>.</p>
      <p>The most visually apparent residuals in <xref ref-type="fig" rid="pgen-1002967-g005">Figure 5B</xref> are accounted for in the graph by an admixture event from the grey wolf into the basenji, an ancient African breed of dog (<inline-formula><inline-graphic xlink:href="pgen.1002967.e205.jpg"/></inline-formula>). Such a high mixture fraction is consistent with previous clustering analyses of these data <xref rid="pgen.1002967-vonHoldt1" ref-type="bibr">[23]</xref>, <xref rid="pgen.1002967-Parker1" ref-type="bibr">[60]</xref>. We again sought to confirm this signal in a less-parameterized model. We tested the four-population tree [[wolf,ancient breed],[basenji, Afghan hound]] with various “ancient” dog breeds. We could not find a tree that passed the four-population test (with Akita as the ancient breed, <inline-formula><inline-graphic xlink:href="pgen.1002967.e206.jpg"/></inline-formula>; with Alaskan Malamute, <inline-formula><inline-graphic xlink:href="pgen.1002967.e207.jpg"/></inline-formula>), confirming the presence of gene flow in these trees. Replacing the basenji with the saluki in these analyses resulted in trees that pass the four-population test (for example, the tree [[wolf, Akita],[Afghan hound, saluki]] passes with <inline-formula><inline-graphic xlink:href="pgen.1002967.e208.jpg"/></inline-formula>). Though we cannot have complete confidence in the precise migration events, these results are consistent with admixture between gray wolves and the basenji.</p>
      <p>Another breed that stands out in this analysis is the boxer (Note that many of the SNPs used in this study were ascertained using a boxer individual, so we may have increased power to identify migration events involving this breed). We infer a significant genetic contribution from wolves to the boxer (<inline-formula><inline-graphic xlink:href="pgen.1002967.e209.jpg"/></inline-formula>), and migration between the boxer and the Chinese shar-pei, a distantly-related ancient breed (<inline-formula><inline-graphic xlink:href="pgen.1002967.e210.jpg"/></inline-formula>). To further examine these events, we again turned to four-population tests. To evaluate the wolf mixture, we tested the tree [[wolf, ancient breed],[boxer, bulldog]]. We did not find a tree that passed the four-population test (with Akita as the ancient breed, <inline-formula><inline-graphic xlink:href="pgen.1002967.e211.jpg"/></inline-formula>; with Afghan Hound, <inline-formula><inline-graphic xlink:href="pgen.1002967.e212.jpg"/></inline-formula>). Replacing the Boxer with the Mastiff in these analyses led to trees that passed the four-population test (for example, with Akita as the ancient breed, <inline-formula><inline-graphic xlink:href="pgen.1002967.e213.jpg"/></inline-formula>). To evaluate the gene flow from the Boxer to the Chinese shar-pei, we tested the tree [[Chinese shar-pei, Akita],[boxer, bulldog]]; this tree fails the four-population test (<inline-formula><inline-graphic xlink:href="pgen.1002967.e214.jpg"/></inline-formula>), while the tree [[Chow Chow, Akita],[boxer,bulldog]] passes (<inline-formula><inline-graphic xlink:href="pgen.1002967.e215.jpg"/></inline-formula>).</p>
      <p>Previous analyses of these data have noted that the “toy breeds” of dog cluster together Vonholdt:2010uq. We find that the Chinese toy breeds (the Pekingese and the Shi Tzu) result from admixture between a population related to ancient East Asian dog breeds and a modern population related to the Brussels griffon and the pug (<inline-formula><inline-graphic xlink:href="pgen.1002967.e216.jpg"/></inline-formula> from the East Asian breeds). To confirm the presence of gene flow, we tested four-population trees of the form [[Asian toy breed, Akita/Chow Chow],[Pug,mastiff]]. These trees fail, with varying levels of significance, ranging from [[Chow Chow, Shi Tzu],[Pug, mastiff]] (<inline-formula><inline-graphic xlink:href="pgen.1002967.e217.jpg"/></inline-formula>) to [[Akita, Pekingese],[Pug, mastiff]] (<inline-formula><inline-graphic xlink:href="pgen.1002967.e218.jpg"/></inline-formula>).</p>
      <p>Finally, we noticed that two of the sighthounds (the Borzoi and the Italian greyhound) do not cluster with the other sight hounds in the tree, namely greyhound, whippet and Irish wolfhound (<xref ref-type="fig" rid="pgen-1002967-g005">Figure 5A</xref>); however, they do show evidence of having sighthound admixture in the graph (<xref ref-type="fig" rid="pgen-1002967-g006">Figure 6</xref>). These are the borzoi (which appear to be admixed between an ancient or spitz-breed dog, with 47% ancestry from the sighthounds) and the Italian Greyhound (which appears to be admixed with a toy breed, with 34% ancestry from the sighthounds). This is consistent with the known phenotypic characteristics of these dogs; the borzoi is considered a saluki-like breed, and the Italian greyhound is phenotypically a small version of a greyhound <xref rid="pgen.1002967-American1" ref-type="bibr">[59]</xref>.</p>
      <p>Overall, we conclude that there has been considerable gene flow between dog breeds over the course of domestication; there are many additional migration events that merit further examination (<xref ref-type="fig" rid="pgen-1002967-g006">Figure 6</xref>, <xref ref-type="supplementary-material" rid="pgen.1002967.s016">Text S1</xref>).</p>
    </sec>
  </sec>
  <sec id="s3">
    <title>Discussion</title>
    <p>In this paper, we have developed a unified model for inferring patterns of population splits and mixtures from genome-wide allele frequency data. We have shown that this model is accurate in simulations, largely recapitulates the known relationships between well-studied human populations, and is able to identify new relationships between populations in both humans and dogs.</p>
    <p>The <italic>TreeMix</italic> model can be thought of as a complement to methods for the identification of population structure <xref rid="pgen.1002967-Pritchard2" ref-type="bibr">[18]</xref>–<xref rid="pgen.1002967-Lawson1" ref-type="bibr">[20]</xref>. These latter methods are powerful tools for clustering together individuals into relatively homogenous populations (and to identify individuals that are genetic outliers in their population) <xref rid="pgen.1002967-Pritchard2" ref-type="bibr">[18]</xref>–<xref rid="pgen.1002967-Lawson1" ref-type="bibr">[20]</xref>. However, once population structure in a species has been identified, these methods are not well-suited for describing <italic>how</italic> it arose, and are only indirectly informative about the historical relationships between different populations. The model developed in this paper is designed to more directly address these historical questions.</p>
    <sec id="s3a">
      <title>Modeling assumptions</title>
      <p>There are a number of assumptions, both implicit and explicit, in the interpretation of the <italic>TreeMix</italic> model. First, we have motivated the model in terms of inferring the historical splits and mixtures of populations. However, a given covariance structure of allele frequencies between populations can be a consequence of either a non-equilibrium demography (population splits and mixtures) or an equilibrium demography (populations at long-term stasis with a fixed migration structure) <xref rid="pgen.1002967-Felsenstein1" ref-type="bibr">[2]</xref>. For the species analyzed in this paper, population equilibrium over the entire species range is not a tenable hypothesis; however, some subsets of populations may be at equilibrium, and there may be species where this alternative historical interpretation of the model is plausible.</p>
      <p>We have also modeled migration between populations as occurring at single, instantaneous time points. This is, of course, a dramatic simplification of the migration process. This model will work best when gene flow between populations is restricted to a relatively short time period. Situations of continuous migration violate this assumption and lead to unclear results (<xref ref-type="supplementary-material" rid="pgen.1002967.s014">Figure S14</xref>). The relevance of this assumption will depend on the species and the populations considered. In humans, the relevance of continuous versus discrete mixture events is an open question–some aspects of genetic variation appear compatible with continuous migration <xref rid="pgen.1002967-Novembre2" ref-type="bibr">[61]</xref>, while other aspects do not <xref rid="pgen.1002967-Reich1" ref-type="bibr">[37]</xref>. Indeed, both sorts of models are likely relevant at different time scales <xref rid="pgen.1002967-Novembre3" ref-type="bibr">[62]</xref>.</p>
      <p>We also rely on the implicit assumption that the history of the species being analyzed is largely tree-like. We have made this assumption to simplify the search for the maximum likelihood graph; additionally, we speculate that in graphs with complex structure, there will be many graphs that lead to identical covariance matrices, and thus several different histories will be compatible with the data. That said, improvements to the search algorithm could allow the assumption of approximate treeness to be somewhat relaxed. Currently, if the number of admixed populations is large relative to the number of unadmixed populations, this assumption breaks down. For example, in the human data, note that we see no evidence of the documented gene flow from Neandertals to all non-African populations <xref rid="pgen.1002967-Green1" ref-type="bibr">[39]</xref> (<xref ref-type="fig" rid="pgen-1002967-g003">Figure 3B</xref>). The reason for this is that the large number of populations with admixture can be accommodated in the tree by allowing the branch from Neandertals to Africans to be slightly underestimated (additionally, by using SNPs ascertained in Africa, we have selected against sites that are informative about Neandertal ancestry). If only a single non-African population is included in the analysis, the relationship between Neandertals and the non-African population is clearer (<xref ref-type="supplementary-material" rid="pgen.1002967.s015">Figure S15</xref>).</p>
    </sec>
    <sec id="s3b">
      <title>Conclusions</title>
      <p>A number of extensions to the sort of model described here are of potential interest. First, the historical relationships between populations could be useful as null demographic models for the detection of natural selection <xref rid="pgen.1002967-Coop1" ref-type="bibr">[48]</xref>, <xref rid="pgen.1002967-Bhatia1" ref-type="bibr">[63]</xref>, <xref rid="pgen.1002967-Bonhomme1" ref-type="bibr">[64]</xref>. Second, in a given individual, the best-fit graph relating the individual to other populations may change along a chromosome; this sort of information could be of use in local ancestry inference. Finally, we have not used the information about demographic history present in linkage disequilibrium; approaches that explicitly use this information may provide additional power to detect migration events and estimate their timing, at an additional computational cost <xref rid="pgen.1002967-Lawson1" ref-type="bibr">[20]</xref>, <xref rid="pgen.1002967-Hellenthal1" ref-type="bibr">[53]</xref>, <xref rid="pgen.1002967-Myers1" ref-type="bibr">[65]</xref>.</p>
    </sec>
  </sec>
  <sec sec-type="methods" id="s4">
    <title>Methods</title>
    <sec id="s4a">
      <title>Graph estimation</title>
      <p>As described in the Results, we developed an algorithm called <italic>TreeMix</italic> that uses the composite likelihood in <xref ref-type="disp-formula" rid="pgen.1002967.e142">Equation 28</xref> to search for the maximum likelihood graph. Estimation involves two major steps. First, for a given graph topology, we need to find the maximum likelihood branch lengths and migration weights. Second, we need to search the space of possible graphs. First consider a given graph topology. We iterate between optimizing the branch lengths and weights. If the edge weights are known, the observed entries of the covariance matrix can be written down as an overdetermined system of linear equations (as in <xref ref-type="disp-formula" rid="pgen.1002967.e043">Equations 13</xref>–<xref ref-type="disp-formula" rid="pgen.1002967.e045">15</xref>). We solve this system by non-negative least squares <xref rid="pgen.1002967-Lawson2" ref-type="bibr">[66]</xref>. Though the least squares solution is the maximum composite likelihood solution in the case where all entries of the covariance matrix have equal variance, it is not strictly the maximum likelihood solution in cases with unequal variances. The algorithm could be extended to unequal variances using a weighted least squares approach, but we have not implemented this. We then do a golden section search for the optimal weight (between zero and one) on each migration edge <xref rid="pgen.1002967-Press1" ref-type="bibr">[67]</xref>. At each step in the golden section search, we update the branch lengths. We optimize the weight of each migration edge in turn, and iterate over migration edges until convergence.</p>
      <p>To search the space of possible graphs, we take a hill-climbing approach. We start by finding a local optimum tree, taking an algorithmic approach similar to Felsenstein <xref rid="pgen.1002967-Felsenstein3" ref-type="bibr">[30]</xref>. We randomly select three populations, optimize the branch lengths for all three possible trees, and choose the best (in terms of the composite likelihood) tree. Then, we add the remaining populations one by one in a random order. To add a population, we try attaching it to all branches of the current tree, optimizing the branch lengths for each one as described above, and find the most likely spot. We then perform a round of local rearrangements (i.e., nearest-neighbor interchanges <xref rid="pgen.1002967-Felsenstein4" ref-type="bibr">[50]</xref>) around each internal node, keeping the resulting tree only if it increases the likelihood.</p>
      <p>After adding all populations, we calculate the residual covariance matrix, <inline-formula><inline-graphic xlink:href="pgen.1002967.e219.jpg"/></inline-formula>. We then add migration edges in a directed matter. First, we find the <inline-formula><inline-graphic xlink:href="pgen.1002967.e220.jpg"/></inline-formula> pairs of populations with the maximum residuals (these are the pairs of populations with the worst fit under the model). In the results reported, <inline-formula><inline-graphic xlink:href="pgen.1002967.e221.jpg"/></inline-formula>. We define a “neighborhood” around each population of a pair as the tips within a distance of <inline-formula><inline-graphic xlink:href="pgen.1002967.e222.jpg"/></inline-formula> edges of the focal population. In applications above, we use <inline-formula><inline-graphic xlink:href="pgen.1002967.e223.jpg"/></inline-formula>. This defines a set of pairs of populations that either have a poor fit, or are located in the graph near populations with a poor fit. We take each of these pairs in turn. For each pair, we identify the set of nodes in the path from each member of the pair to the root of the graph. This gives us two sets of nodes. We take all pairwise combinations of nodes in each set, and look at residuals between the populations that are the descendants of each node. If all of the residuals are positive, we add a migration edge between the two nodes and estimate its maximum likelihood weight. We then keep only the single edge that most increases the likelihood of the graph. After adding a migration edge, we attempt nearest-neighbor interchanges at the source and destination of the migration event, attempt changing the source and destination of all migration events, and attempt changing the direction of all migration arrows. Once we have reached the local maximum by this method, we attempt nearest-neighbor interchanges at all internal nodes. We iterate over this procedure for a predetermined number of migration edges. We then test the migration edges for significance as described.</p>
      <p>The <italic>TreeMix</italic> source code is available at <ext-link ext-link-type="uri" xlink:href="http://treemix.googlecode.com">http://treemix.googlecode.com</ext-link>.</p>
    </sec>
    <sec id="s4b">
      <title>Three- and four-population tests of treeness</title>
      <p>We implemented three- and four-population tests as described in Reich et al. <xref rid="pgen.1002967-Reich1" ref-type="bibr">[37]</xref>. For the relationship between the <inline-formula><inline-graphic xlink:href="pgen.1002967.e224.jpg"/></inline-formula> statistics and the covariance model underlying <italic>TreeMix</italic>, see the <xref ref-type="supplementary-material" rid="pgen.1002967.s016">Text S1</xref>. For the three-population test, we estimated <inline-formula><inline-graphic xlink:href="pgen.1002967.e225.jpg"/></inline-formula> as in Reich et al. <xref rid="pgen.1002967-Reich1" ref-type="bibr">[37]</xref>, and tested whether is it less than zero. We report the Z-score for this test. To obtain a standard error on the estimate of <inline-formula><inline-graphic xlink:href="pgen.1002967.e226.jpg"/></inline-formula>, we used a block jackknife similar to Reich et al. <xref rid="pgen.1002967-Reich1" ref-type="bibr">[37]</xref>. However, Reich et al. <xref rid="pgen.1002967-Reich1" ref-type="bibr">[37]</xref> split the genome into blocks based on distance (with variable numbers of SNPs per block); we split the genome into blocks of <inline-formula><inline-graphic xlink:href="pgen.1002967.e227.jpg"/></inline-formula> SNPs (and thus the blocks will be of variable size).</p>
      <p>For the four-population test for treeness, we calculate the <inline-formula><inline-graphic xlink:href="pgen.1002967.e228.jpg"/></inline-formula> statistic as in Reich et al. <xref rid="pgen.1002967-Reich1" ref-type="bibr">[37]</xref>, and test whether it is different than zero. Again, we report a Z-score for this test. Standard errors for the <inline-formula><inline-graphic xlink:href="pgen.1002967.e229.jpg"/></inline-formula> statistic were obtained as for the <inline-formula><inline-graphic xlink:href="pgen.1002967.e230.jpg"/></inline-formula> statistic.</p>
    </sec>
    <sec id="s4c">
      <title>Human data</title>
      <p>The human data we used were downloaded from <ext-link ext-link-type="uri" xlink:href="http://www.cephb.fr/en/hgdp/">http://www.cephb.fr/en/hgdp/</ext-link> on August 16th, 2011 (the data set labeled Harvard HGDP-CEPH genotypes). They consist of several panels of SNPs ascertained from low-coverage genome sequencing of single individual from different populations and then genotyped in the Human Genome Diversity Panel <xref rid="pgen.1002967-Patterson2" ref-type="bibr">[54]</xref>. Additionally, at each site, a single sequencing read from the Denisova and Neandertal genome sequencing projects was sampled and the allele reported. These data have the property that they allow for complete control of the ascertainment strategy, and allow us to test the robustness of inference to different ascertainment schemes. For the main analyses, we used the panel of autosomal SNPs ascertained in a single Yoruban individual; there are 124,115 such sites. For some analyses, we also used the panel of autosomal SNPs ascertained in a single French individual; there are 111,970 such sites. For all analyses with <italic>TreeMix</italic>, we used a window size (<inline-formula><inline-graphic xlink:href="pgen.1002967.e231.jpg"/></inline-formula>) of 500; this corresponds to a window size of approximately 10 Mb. For all <italic>TreeMix</italic> analyses, we set the Neandertal and Denisova samples as the outgroups.</p>
      <p>Since we have only a single allele from the Neandertal and Denisova populations, we cannot calculate heterozygosity in these populations for unbiased estimation of the covariance matrix (see ). To account for this, we simply chose a relatively low level of heterozygosity and assigned it to both populations. In the Yoruba ascertained SNPs, we used a heterozygosity of 0.13, and for the French ascertained SNPs, we used a heterozygosity of 0.2. In practice, this only affected the lengths of the terminal branches to Neandertal and Denisova; running <italic>TreeMix</italic> with a heterozygosity of zero in both populations resulted in the same graph topologies (not shown).</p>
    </sec>
    <sec id="s4d">
      <title>Dog data</title>
      <p>Allele counts for the dog breeds and wild canids reported in Boyko et al. Boyko:2010fk were downloaded from <ext-link ext-link-type="uri" xlink:href="http://genome-mirror.bscb.cornell.edu/">http://genome-mirror.bscb.cornell.edu/</ext-link> on July 30, 2011. These data consist of counts of reference and alternate alleles at 61,468 sites in 85 dog breeds and wild canids. We removed the Jackal and Scottish Deerhound for having relatively high amounts of missing data, and the village dogs because it is unclear if they represent a coherent population. We also removed all SNPs on the X chromosome. This left us with 60,615 SNPs in 82 populations. We ran <italic>TreeMix</italic> with a window size (<inline-formula><inline-graphic xlink:href="pgen.1002967.e232.jpg"/></inline-formula>) of 500. This corresponds to a window size of approximately 20 Mb. For all <italic>TreeMix</italic> analyses, we set the coyote as the outgroup.</p>
      <p>The ascertainment scheme used for SNP discovery in dogs was complicated <xref rid="pgen.1002967-LindbladToh1" ref-type="bibr">[68]</xref>. The largest set of SNPs were ascertained by virtue of being different between the boxer and poodle assemblies. This should lead to an overestimation of the distance between the boxer and the poodle in our analysis. Indeed, in <xref ref-type="fig" rid="pgen-1002967-g005">Figure 5B</xref>, a considerable negative residual between the boxer and poodle is visible. Another set of SNPs were ascertained by being heterozygous within a boxer individual, and a third set were ascertained by comparison between a boxer and wild canids. These latter SNPs should lead to an overestimation of the distance between the boxer and the wolf in our analysis (as we see for the poodle); in fact, we infer migration between the boxer and the wolf. This ascertainment issue may have led us to underestimate the amount of gene flow in the comparison.</p>
    </sec>
    <sec id="s4e">
      <title>Simulations</title>
      <p>All simulations were performed using <italic>ms</italic>
<xref rid="pgen.1002967-Hudson1" ref-type="bibr">[69]</xref>. The exact commands used are listed in <xref ref-type="supplementary-material" rid="pgen.1002967.s016">Text S1</xref>. When running <italic>TreeMix</italic> on simulations without ascertainment, we used a window size of 5000 SNPs; for simulations with ascertainment we used windows of 1000 SNPs. Consensus trees were generated using SumTrees v.3.1.0 <xref rid="pgen.1002967-Sukumaran1" ref-type="bibr">[70]</xref>.</p>
    </sec>
  </sec>
  <sec sec-type="supplementary-material" id="s5">
    <title>Supporting Information</title>
    <supplementary-material content-type="local-data" id="pgen.1002967.s001">
      <label>Figure S1</label>
      <caption>
        <p>A graph with a mixture event. Capital letters represent nodes, branch length parameters are in blue, and weight parameters are in red.</p>
        <p>(PDF)</p>
      </caption>
      <media xlink:href="pgen.1002967.s001.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pgen.1002967.s002">
      <label>Figure S2</label>
      <caption>
        <p>Replicates of inferred trees from simulated data. We generated tree-like data using the topology in <xref ref-type="fig" rid="pgen-1002967-g002">Figure 2A</xref> in the main text. In <xref ref-type="fig" rid="pgen-1002967-g002">Figure 2B</xref> in the main text, we show the inferred tree with mean branch lengths. In this figure, we show four representative individual trees.</p>
        <p>(PDF)</p>
      </caption>
      <media xlink:href="pgen.1002967.s002.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pgen.1002967.s003">
      <label>Figure S3</label>
      <caption>
        <p>Inferred trees on ascertained data. We generated tree-like data using the topology in <xref ref-type="fig" rid="pgen-1002967-g002">Figure 2A</xref> in the main text. We then used only the SNPs that were polymorphic in either population 1 (A.) or population 20 (B.) to infer the trees. The correct topology was obtained in all 100 simulations; the branch lengths in each figure are the mean across all simulations.</p>
        <p>(PDF)</p>
      </caption>
      <media xlink:href="pgen.1002967.s003.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pgen.1002967.s004">
      <label>Figure S4</label>
      <caption>
        <p>Histogram of p-values for migration in simulated data. We generated 100 tree-like datasets using the topology in <xref ref-type="fig" rid="pgen-1002967-g002">Figure 2A</xref> in the main text. We then randomly chose two populations (without replacement), added a migration edge between the two populations, and tested for significance using the procedure described in the main text. Plotted is the histogram of p-values for the significance test. If the p-values are properly calibrated, this distribution should be uniform (dotted line). Though the distribution is not completely uniform, there is no skew towards low p-values.</p>
        <p>(PDF)</p>
      </caption>
      <media xlink:href="pgen.1002967.s004.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pgen.1002967.s005">
      <label>Figure S5</label>
      <caption>
        <p>Consensus tree in simulations with long branches. We generated 100 tree-like datasets using the topology in <xref ref-type="fig" rid="pgen-1002967-g002">Figure 2A</xref> in the main text, multiplying all branch lengths by 50. We then inferred the maximum likelihood tree. A. Plotted are the mean branch lengths from the simulations. All simulations resulted in the same inferred topology. B. In each simulation, we scaled the residuals by the average standard error, then averaged these scaled residuals across simulations. Plotted are the mean scaled residuals across the 100 simulations. The most extreme residuals are not large (around 0.3 standard errors), but tend to be present between closely related populations.</p>
        <p>(PDF)</p>
      </caption>
      <media xlink:href="pgen.1002967.s005.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pgen.1002967.s006">
      <label>Figure S6</label>
      <caption>
        <p>Example trees from simulations with long branches. We generated 100 tree-like datasets using the topology in <xref ref-type="fig" rid="pgen-1002967-g002">Figure 2A</xref> in the main text, multiplying all branch lengths by 50. We then inferred the maximum likelihood tree. In <xref ref-type="supplementary-material" rid="pgen.1002967.s005">Figure S5</xref>, we show the average inferred tree. Here, we show two representative trees (A. and C. and the residuals corresponding to each tree (B. and D.).</p>
        <p>(PDF)</p>
      </caption>
      <media xlink:href="pgen.1002967.s006.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pgen.1002967.s007">
      <label>Figure S7</label>
      <caption>
        <p>Representative errors in simulations. We examined the simulations in which <italic>TreeMix</italic> did not reach the correct answer. A. The correct topology for the simulations presented in the other panels. B. A representative example of an incorrect topology inferred from the simulations of a migration event with weight 10% from population 1 to population 5 (this topology accounted for all observed errors). C. A representative example of an incorrect topology inferred from the simulations of a migration event with weight 30% from population 1 to population 5 (this topology accounted for 95% of all errors).</p>
        <p>(PDF)</p>
      </caption>
      <media xlink:href="pgen.1002967.s007.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pgen.1002967.s008">
      <label>Figure S8</label>
      <caption>
        <p>Replicate graphs inferred in the human data. These graphs were generated in an identical manner as <xref ref-type="fig" rid="pgen-1002967-g004">Figure 4</xref> in the main text, but using different random input orders for populations during tree-building. All random input orders gave very similar results.</p>
        <p>(PDF)</p>
      </caption>
      <media xlink:href="pgen.1002967.s008.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pgen.1002967.s009">
      <label>Figure S9</label>
      <caption>
        <p>Residual fit from graph of human data presented in the main text. Plotted are the residuals from the fit of the graph presented in <xref ref-type="fig" rid="pgen-1002967-g004">Figure 4</xref> in the main text.</p>
        <p>(PDF)</p>
      </caption>
      <media xlink:href="pgen.1002967.s009.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pgen.1002967.s010">
      <label>Figure S10</label>
      <caption>
        <p>Graph inferred from SNPs ascertained in a single French individual. The graph was generated in an identical manner as <xref ref-type="fig" rid="pgen-1002967-g004">Figure 4</xref> in the main text, but using a panel of SNPs ascertained in a single French, rather than a single Yoruban, individual. The inferred graph is extremely similar to that in <xref ref-type="fig" rid="pgen-1002967-g004">Figure 4</xref>. The one major difference is that, in this graph, the Mozabite appear as an admixture of a Sardinian population rather than a Middle Eastern population; this configuration is seen in some runs of <italic>TreeMix</italic> on the Yoruba-ascertained data (<xref ref-type="supplementary-material" rid="pgen.1002967.s008">Figure S8A</xref>).</p>
        <p>(PDF)</p>
      </caption>
      <media xlink:href="pgen.1002967.s010.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pgen.1002967.s011">
      <label>Figure S11</label>
      <caption>
        <p>Trees inferred using the human data including the Oceanians. We show the maximum likelihood trees and residuals for the human data including the Oceanian populations, plotted in the same manner as in <xref ref-type="fig" rid="pgen-1002967-g003">Figure 3</xref> in the main text. Trees were inferred using the panel of SNPs ascertained in a single Yoruban individual (A. and C.) and the panel of SNPs ascertained in a single French individual (B. and D.).</p>
        <p>(PDF)</p>
      </caption>
      <media xlink:href="pgen.1002967.s011.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pgen.1002967.s012">
      <label>Figure S12</label>
      <caption>
        <p>Graphs inferred using the human data including the Oceanians. We show the maximum likelihood graphs for the human data including the Oceanian populations, plotted in the same manner as in <xref ref-type="fig" rid="pgen-1002967-g004">Figure 4</xref> in the main text. Six migration edges were inferred in each graph. Graphs were inferred using the panel of SNPs ascertained in a single Yoruban individual (A.) and the panel of SNPs ascertained in a single French individual (B.). See <xref ref-type="supplementary-material" rid="pgen.1002967.s016">Text S1</xref> for discussion.</p>
        <p>(PDF)</p>
      </caption>
      <media xlink:href="pgen.1002967.s012.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pgen.1002967.s013">
      <label>Figure S13</label>
      <caption>
        <p>Residual fit from graph of dog data presented in the main text. Plotted are the residuals from the fit of the graph presented in <xref ref-type="fig" rid="pgen-1002967-g006">Figure 6</xref> in the main text.</p>
        <p>(PDF)</p>
      </caption>
      <media xlink:href="pgen.1002967.s013.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pgen.1002967.s014">
      <label>Figure S14</label>
      <caption>
        <p><italic>TreeMix</italic> run on populations with continuous migration. We simulated a set of populations on a lattice, where each population has constant gene flow at a rate of <inline-formula><inline-graphic xlink:href="pgen.1002967.e233.jpg"/></inline-formula> with neighboring populations. All populations split from an outgroup 16,400 generations in the past. The exact <italic>ms</italic> command is given in <xref ref-type="supplementary-material" rid="pgen.1002967.s016">Text S1</xref>. The configuration of the lattice is presented in A. (population 1 is the outgroup). <italic>TreeMix</italic> inferred no consistent tree structure. Three representative trees are presented in B.-D.</p>
        <p>(PDF)</p>
      </caption>
      <media xlink:href="pgen.1002967.s014.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pgen.1002967.s015">
      <label>Figure S15</label>
      <caption>
        <p><italic>TreeMix</italic> run on human data using only a single non-African population. We inferred the maximum likelihood tree (A.) using only the African populations and one non-African population (French), using SNPs identified in a single Yoruban individual. In examining the residuals (B.), a relationship between the French and the Neandertal is clear. We then inferred three migration events (C.), where we do see that the French contain some Neandertal ancestry (<inline-formula><inline-graphic xlink:href="pgen.1002967.e234.jpg"/></inline-formula>). Residual fit for this graph is shown in D.</p>
        <p>(PDF)</p>
      </caption>
      <media xlink:href="pgen.1002967.s015.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pgen.1002967.s016">
      <label>Text S1</label>
      <caption>
        <p>Supplementary Information.</p>
        <p>(PDF)</p>
      </caption>
      <media xlink:href="pgen.1002967.s016.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <ack>
    <p>We thank three anonymous reviewers, David Reich, Nick Patterson, Graham Coop, Peter Ralph, Daniel Falush, and Daniel Lawson for helpful comments and suggestions.</p>
  </ack>
  <ref-list>
    <title>References</title>
    <ref id="pgen.1002967-CavalliSforza1">
      <label>1</label>
      <mixed-citation publication-type="journal"><name><surname>Cavalli-Sforza</surname><given-names>LL</given-names></name>, <name><surname>Edwards</surname><given-names>AW</given-names></name> (<year>1967</year>) <article-title>Phylogenetic analysis. Models and estimation proce-dures</article-title>. <source>Am J Hum Genet</source>
<volume>19</volume>: <fpage>233</fpage>–<lpage>57</lpage>.<pub-id pub-id-type="pmid">6026583</pub-id></mixed-citation>
    </ref>
    <ref id="pgen.1002967-Felsenstein1">
      <label>2</label>
      <mixed-citation publication-type="journal"><name><surname>Felsenstein</surname><given-names>J</given-names></name> (<year>1982</year>) <article-title>How can we infer geography and history from gene frequencies?</article-title>
<source>J Theor Biol</source>
<volume>96</volume>: <fpage>9</fpage>–<lpage>20</lpage>.<pub-id pub-id-type="pmid">7109659</pub-id></mixed-citation>
    </ref>
    <ref id="pgen.1002967-Cann1">
      <label>3</label>
      <mixed-citation publication-type="journal"><name><surname>Cann</surname><given-names>RL</given-names></name>, <name><surname>Stoneking</surname><given-names>M</given-names></name>, <name><surname>Wilson</surname><given-names>AC</given-names></name> (<year>1987</year>) <article-title>Mitochondrial DNA and human evolution</article-title>. <source>Nature</source>
<volume>325</volume>: <fpage>31</fpage>–<lpage>6</lpage>.<pub-id pub-id-type="pmid">3025745</pub-id></mixed-citation>
    </ref>
    <ref id="pgen.1002967-Nei1">
      <label>4</label>
      <mixed-citation publication-type="journal"><name><surname>Nei</surname><given-names>M</given-names></name>, <name><surname>Roychoudhury</surname><given-names>AK</given-names></name> (<year>1974</year>) <article-title>Genic variation within and between the three major races of man, Caucasoids, Negroids, and Mongoloids</article-title>. <source>Am J Hum Genet</source>
<volume>26</volume>: <fpage>421</fpage>–<lpage>43</lpage>.<pub-id pub-id-type="pmid">4841634</pub-id></mixed-citation>
    </ref>
    <ref id="pgen.1002967-Nei2">
      <label>5</label>
      <mixed-citation publication-type="journal"><name><surname>Nei</surname><given-names>M</given-names></name>, <name><surname>Roychoudhury</surname><given-names>AK</given-names></name> (<year>1993</year>) <article-title>Evolutionary relationships of human populations on a global scale</article-title>. <source>Mol Biol Evol</source>
<volume>10</volume>: <fpage>927</fpage>–<lpage>43</lpage>.<pub-id pub-id-type="pmid">8412653</pub-id></mixed-citation>
    </ref>
    <ref id="pgen.1002967-CavalliSforza2">
      <label>6</label>
      <mixed-citation publication-type="journal"><name><surname>Cavalli-Sforza</surname><given-names>LL</given-names></name>, <name><surname>Piazza</surname><given-names>A</given-names></name>, <name><surname>Menozzi</surname><given-names>P</given-names></name>, <name><surname>Mountain</surname><given-names>J</given-names></name> (<year>1988</year>) <article-title>Reconstruction of human evolution: bringing together genetic, archaeological, and linguistic data</article-title>. <source>Proc Natl Acad Sci U S A</source>
<volume>85</volume>: <fpage>6002</fpage>–<lpage>6</lpage>.<pub-id pub-id-type="pmid">3166138</pub-id></mixed-citation>
    </ref>
    <ref id="pgen.1002967-Li1">
      <label>7</label>
      <mixed-citation publication-type="journal"><name><surname>Li</surname><given-names>JZ</given-names></name>, <name><surname>Absher</surname><given-names>DM</given-names></name>, <name><surname>Tang</surname><given-names>H</given-names></name>, <name><surname>Southwick</surname><given-names>AM</given-names></name>, <name><surname>Casto</surname><given-names>AM</given-names></name>, <etal>et al</etal> (<year>2008</year>) <article-title>Worldwide human rela-tionships inferred from genome-wide patterns of variation</article-title>. <source>Science</source>
<volume>319</volume>: <fpage>1100</fpage>–<lpage>1104</lpage>.<pub-id pub-id-type="pmid">18292342</pub-id></mixed-citation>
    </ref>
    <ref id="pgen.1002967-Pritchard1">
      <label>8</label>
      <mixed-citation publication-type="journal"><name><surname>Pritchard</surname><given-names>JK</given-names></name>, <name><surname>Seielstad</surname><given-names>MT</given-names></name>, <name><surname>Perez-Lezaun</surname><given-names>A</given-names></name>, <name><surname>Feldman</surname><given-names>MW</given-names></name> (<year>1999</year>) <article-title>Population growth of human Y chromosomes: a study of Y chromosome microsatellites</article-title>. <source>Mol Biol Evol</source>
<volume>16</volume>: <fpage>1791</fpage>–<lpage>8</lpage>.<pub-id pub-id-type="pmid">10605120</pub-id></mixed-citation>
    </ref>
    <ref id="pgen.1002967-Beaumont1">
      <label>9</label>
      <mixed-citation publication-type="journal"><name><surname>Beaumont</surname><given-names>MA</given-names></name>, <name><surname>Zhang</surname><given-names>W</given-names></name>, <name><surname>Balding</surname><given-names>DJ</given-names></name> (<year>2002</year>) <article-title>Approximate Bayesian computation in popula-tion genetics</article-title>. <source>Genetics</source>
<volume>162</volume>: <fpage>2025</fpage>–<lpage>35</lpage>.<pub-id pub-id-type="pmid">12524368</pub-id></mixed-citation>
    </ref>
    <ref id="pgen.1002967-Schaffner1">
      <label>10</label>
      <mixed-citation publication-type="journal"><name><surname>Schaffner</surname><given-names>SF</given-names></name>, <name><surname>Foo</surname><given-names>C</given-names></name>, <name><surname>Gabriel</surname><given-names>S</given-names></name>, <name><surname>Reich</surname><given-names>D</given-names></name>, <name><surname>Daly</surname><given-names>MJ</given-names></name>, <etal>et al</etal> (<year>2005</year>) <article-title>Calibrating a coalescent simulation of human genome sequence variation</article-title>. <source>Genome Res</source>
<volume>15</volume>: <fpage>1576</fpage>–<lpage>1583</lpage>.<pub-id pub-id-type="pmid">16251467</pub-id></mixed-citation>
    </ref>
    <ref id="pgen.1002967-Gutenkunst1">
      <label>11</label>
      <mixed-citation publication-type="journal"><name><surname>Gutenkunst</surname><given-names>RN</given-names></name>, <name><surname>Hernandez</surname><given-names>RD</given-names></name>, <name><surname>Williamson</surname><given-names>SH</given-names></name>, <name><surname>Bustamante</surname><given-names>CD</given-names></name> (<year>2009</year>) <article-title>Inferring the joint demographic history of multiple populations from multidimensional SNP frequency data</article-title>. <source>PLoS Genet</source>
<volume>5</volume>: <fpage>e1000695</fpage>
<comment>doi:<ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1371/journal.pgen.1000695">10.1371/journal.pgen.1000695</ext-link></comment>.<pub-id pub-id-type="pmid">19851460</pub-id></mixed-citation>
    </ref>
    <ref id="pgen.1002967-Hey1">
      <label>12</label>
      <mixed-citation publication-type="journal"><name><surname>Hey</surname><given-names>J</given-names></name>, <name><surname>Nielsen</surname><given-names>R</given-names></name> (<year>2004</year>) <article-title>Multilocus methods for estimating population sizes, migration rates and divergence time, with applications to the divergence of Drosophila pseudoobscura and D. persimilis</article-title>. <source>Genetics</source>
<volume>167</volume>: <fpage>747</fpage>–<lpage>60</lpage>.<pub-id pub-id-type="pmid">15238526</pub-id></mixed-citation>
    </ref>
    <ref id="pgen.1002967-Beerli1">
      <label>13</label>
      <mixed-citation publication-type="journal"><name><surname>Beerli</surname><given-names>P</given-names></name>, <name><surname>Felsenstein</surname><given-names>J</given-names></name> (<year>1999</year>) <article-title>Maximum-likelihood estimation of migration rates and effective population numbers in two populations using a coalescent approach</article-title>. <source>Genetics</source>
<volume>152</volume>: <fpage>763</fpage>–<lpage>73</lpage>.<pub-id pub-id-type="pmid">10353916</pub-id></mixed-citation>
    </ref>
    <ref id="pgen.1002967-Becquet1">
      <label>14</label>
      <mixed-citation publication-type="journal"><name><surname>Becquet</surname><given-names>C</given-names></name>, <name><surname>Przeworski</surname><given-names>M</given-names></name> (<year>2007</year>) <article-title>A new approach to estimate parameters of speciation models with application to apes</article-title>. <source>Genome Res</source>
<volume>17</volume>: <fpage>1505</fpage>–<lpage>19</lpage>.<pub-id pub-id-type="pmid">17712021</pub-id></mixed-citation>
    </ref>
    <ref id="pgen.1002967-Kubatko1">
      <label>15</label>
      <mixed-citation publication-type="journal"><name><surname>Kubatko</surname><given-names>LS</given-names></name> (<year>2009</year>) <article-title>Identifying hybridization events in the presence of coalescence via model selection</article-title>. <source>Syst Biol</source>
<volume>58</volume>: <fpage>478</fpage>–<lpage>88</lpage>.<pub-id pub-id-type="pmid">20525602</pub-id></mixed-citation>
    </ref>
    <ref id="pgen.1002967-Gronau1">
      <label>16</label>
      <mixed-citation publication-type="journal"><name><surname>Gronau</surname><given-names>I</given-names></name>, <name><surname>Hubisz</surname><given-names>MJ</given-names></name>, <name><surname>Gulko</surname><given-names>B</given-names></name>, <name><surname>Danko</surname><given-names>CG</given-names></name>, <name><surname>Siepel</surname><given-names>A</given-names></name> (<year>2011</year>) <article-title>Bayesian inference of ancient human demography from individual genome sequences</article-title>. <source>Nat Genet</source>
<volume>43</volume>: <fpage>1031</fpage>–<lpage>4</lpage>.<pub-id pub-id-type="pmid">21926973</pub-id></mixed-citation>
    </ref>
    <ref id="pgen.1002967-Menozzi1">
      <label>17</label>
      <mixed-citation publication-type="journal"><name><surname>Menozzi</surname><given-names>P</given-names></name>, <name><surname>Piazza</surname><given-names>A</given-names></name>, <name><surname>Cavalli-Sforza</surname><given-names>L</given-names></name> (<year>1978</year>) <article-title>Synthetic maps of human gene frequencies in Europeans</article-title>. <source>Science</source>
<volume>201</volume>: <fpage>786</fpage>–<lpage>92</lpage>.<pub-id pub-id-type="pmid">356262</pub-id></mixed-citation>
    </ref>
    <ref id="pgen.1002967-Pritchard2">
      <label>18</label>
      <mixed-citation publication-type="journal"><name><surname>Pritchard</surname><given-names>JK</given-names></name>, <name><surname>Stephens</surname><given-names>M</given-names></name>, <name><surname>Donnelly</surname><given-names>P</given-names></name> (<year>2000</year>) <article-title>Inference of population structure using multi-locus genotype data</article-title>. <source>Genetics</source>
<volume>155</volume>: <fpage>945</fpage>–<lpage>59</lpage>.<pub-id pub-id-type="pmid">10835412</pub-id></mixed-citation>
    </ref>
    <ref id="pgen.1002967-Patterson1">
      <label>19</label>
      <mixed-citation publication-type="journal"><name><surname>Patterson</surname><given-names>N</given-names></name>, <name><surname>Price</surname><given-names>AL</given-names></name>, <name><surname>Reich</surname><given-names>D</given-names></name> (<year>2006</year>) <article-title>Population structure and eigenanalysis</article-title>. <source>PLoS Genet</source>
<volume>2</volume>: <fpage>e190</fpage>
<comment>doi:<ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1371/journal.pgen.0020190">10.1371/journal.pgen.0020190</ext-link></comment>.<pub-id pub-id-type="pmid">17194218</pub-id></mixed-citation>
    </ref>
    <ref id="pgen.1002967-Lawson1">
      <label>20</label>
      <mixed-citation publication-type="journal"><name><surname>Lawson</surname><given-names>DJ</given-names></name>, <name><surname>Hellenthal</surname><given-names>G</given-names></name>, <name><surname>Myers</surname><given-names>S</given-names></name>, <name><surname>Falush</surname><given-names>D</given-names></name> (<year>2012</year>) <article-title>Inference of Population Structure using Dense Haplotype Data</article-title>. <source>PLoS Genet</source>
<volume>8</volume>: <fpage>e1002453</fpage>
<comment>doi:<ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1371/journal.pgen.1002453">10.1371/journal.pgen.1002453</ext-link></comment>.<pub-id pub-id-type="pmid">22291602</pub-id></mixed-citation>
    </ref>
    <ref id="pgen.1002967-Rosenberg1">
      <label>21</label>
      <mixed-citation publication-type="journal"><name><surname>Rosenberg</surname><given-names>NA</given-names></name>, <name><surname>Pritchard</surname><given-names>JK</given-names></name>, <name><surname>Weber</surname><given-names>JL</given-names></name>, <name><surname>Cann</surname><given-names>HM</given-names></name>, <name><surname>Kidd</surname><given-names>KK</given-names></name>, <etal>et al</etal> (<year>2002</year>) <article-title>Genetic structure of human populations</article-title>. <source>Science</source>
<volume>298</volume>: <fpage>2381</fpage>–<lpage>2385</lpage>.<pub-id pub-id-type="pmid">12493913</pub-id></mixed-citation>
    </ref>
    <ref id="pgen.1002967-Liti1">
      <label>22</label>
      <mixed-citation publication-type="journal"><name><surname>Liti</surname><given-names>G</given-names></name>, <name><surname>Carter</surname><given-names>DM</given-names></name>, <name><surname>Moses</surname><given-names>AM</given-names></name>, <name><surname>Warringer</surname><given-names>J</given-names></name>, <name><surname>Parts</surname><given-names>L</given-names></name>, <etal>et al</etal> (<year>2009</year>) <article-title>Population genomics of domestic and wild yeasts</article-title>. <source>Nature</source>
<volume>458</volume>: <fpage>337</fpage>–<lpage>41</lpage>.<pub-id pub-id-type="pmid">19212322</pub-id></mixed-citation>
    </ref>
    <ref id="pgen.1002967-vonHoldt1">
      <label>23</label>
      <mixed-citation publication-type="journal"><name><surname>vonHoldt</surname><given-names>BM</given-names></name>, <name><surname>Pollinger</surname><given-names>JP</given-names></name>, <name><surname>Lohmueller</surname><given-names>KE</given-names></name>, <name><surname>Han</surname><given-names>E</given-names></name>, <name><surname>Parker</surname><given-names>HG</given-names></name>, <etal>et al</etal> (<year>2010</year>) <article-title>Genome-wide SNP and haplotype analyses reveal a rich history underlying dog domestication</article-title>. <source>Nature</source>
<volume>464</volume>: <fpage>898</fpage>–<lpage>902</lpage>.<pub-id pub-id-type="pmid">20237475</pub-id></mixed-citation>
    </ref>
    <ref id="pgen.1002967-Franois1">
      <label>24</label>
      <mixed-citation publication-type="journal"><name><surname>François</surname><given-names>O</given-names></name>, <name><surname>Currat</surname><given-names>M</given-names></name>, <name><surname>Ray</surname><given-names>N</given-names></name>, <name><surname>Han</surname><given-names>E</given-names></name>, <name><surname>Excoffier</surname><given-names>L</given-names></name>, <etal>et al</etal> (<year>2010</year>) <article-title>Principal component analysis under population genetic models of range expansion and admixture</article-title>. <source>Mol Biol Evol</source>
<volume>27</volume>: <fpage>1257</fpage>–<lpage>68</lpage>.<pub-id pub-id-type="pmid">20097660</pub-id></mixed-citation>
    </ref>
    <ref id="pgen.1002967-McVean1">
      <label>25</label>
      <mixed-citation publication-type="journal"><name><surname>McVean</surname><given-names>G</given-names></name> (<year>2009</year>) <article-title>A genealogical interpretation of principal components analysis</article-title>. <source>PLoS Genet</source>
<volume>5</volume>: <fpage>e1000686</fpage>
<comment>doi:<ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1371/journal.pgen.1000686">10.1371/journal.pgen.1000686</ext-link></comment>.<pub-id pub-id-type="pmid">19834557</pub-id></mixed-citation>
    </ref>
    <ref id="pgen.1002967-Novembre1">
      <label>26</label>
      <mixed-citation publication-type="journal"><name><surname>Novembre</surname><given-names>J</given-names></name>, <name><surname>Stephens</surname><given-names>M</given-names></name> (<year>2008</year>) <article-title>Interpreting principal component analyses of spatial popula-tion genetic variation</article-title>. <source>Nat Genet</source>
<volume>40</volume>: <fpage>646</fpage>–<lpage>9</lpage>.<pub-id pub-id-type="pmid">18425127</pub-id></mixed-citation>
    </ref>
    <ref id="pgen.1002967-Saitou1">
      <label>27</label>
      <mixed-citation publication-type="journal"><name><surname>Saitou</surname><given-names>N</given-names></name>, <name><surname>Nei</surname><given-names>M</given-names></name> (<year>1987</year>) <article-title>The neighbor-joining method: a new method for reconstructing phy-logenetic trees</article-title>. <source>Mol Biol Evol</source>
<volume>4</volume>: <fpage>406</fpage>–<lpage>25</lpage>.<pub-id pub-id-type="pmid">3447015</pub-id></mixed-citation>
    </ref>
    <ref id="pgen.1002967-Felsenstein2">
      <label>28</label>
      <mixed-citation publication-type="journal"><name><surname>Felsenstein</surname><given-names>J</given-names></name> (<year>1973</year>) <article-title>Maximum-likelihood estimation of evolutionary trees from continuous characters</article-title>. <source>Am J Hum Genet</source>
<volume>25</volume>: <fpage>471</fpage>–<lpage>92</lpage>.<pub-id pub-id-type="pmid">4741844</pub-id></mixed-citation>
    </ref>
    <ref id="pgen.1002967-RoyChoudhury1">
      <label>29</label>
      <mixed-citation publication-type="journal"><name><surname>RoyChoudhury</surname><given-names>A</given-names></name>, <name><surname>Felsenstein</surname><given-names>J</given-names></name>, <name><surname>Thompson</surname><given-names>EA</given-names></name> (<year>2008</year>) <article-title>A two-stage pruning algorithm for likelihood computation for a population tree</article-title>. <source>Genetics</source>
<volume>180</volume>: <fpage>1095</fpage>–<lpage>105</lpage>.<pub-id pub-id-type="pmid">18780754</pub-id></mixed-citation>
    </ref>
    <ref id="pgen.1002967-Felsenstein3">
      <label>30</label>
      <mixed-citation publication-type="journal"><name><surname>Felsenstein</surname><given-names>J</given-names></name> (<year>1981</year>) <article-title>Evolutionary trees from gene frequencies and quantitative characters: finding maximum likelihood estimates</article-title>. <source>Evolution</source>
<volume>35</volume>: <fpage>1229</fpage>–<lpage>1242</lpage>.</mixed-citation>
    </ref>
    <ref id="pgen.1002967-Sirn1">
      <label>31</label>
      <mixed-citation publication-type="journal"><name><surname>Sirén</surname><given-names>J</given-names></name>, <name><surname>Marttinen</surname><given-names>P</given-names></name>, <name><surname>Corander</surname><given-names>J</given-names></name> (<year>2011</year>) <article-title>Reconstructing population histories from single nu-cleotide polymorphism data</article-title>. <source>Mol Biol Evol</source>
<volume>28</volume>: <fpage>673</fpage>–<lpage>83</lpage>.<pub-id pub-id-type="pmid">20819907</pub-id></mixed-citation>
    </ref>
    <ref id="pgen.1002967-Nielsen1">
      <label>32</label>
      <mixed-citation publication-type="journal"><name><surname>Nielsen</surname><given-names>R</given-names></name>, <name><surname>Mountain</surname><given-names>JL</given-names></name>, <name><surname>Huelsenbeck</surname><given-names>JP</given-names></name>, <name><surname>Slatkin</surname><given-names>M</given-names></name> (<year>1998</year>) <article-title>Maximum-likelihood estimation of population divergence times and population phylogeny in models without mutation</article-title>. <source>Evolution</source>
<volume>52</volume>: <fpage>669</fpage>–<lpage>677</lpage>.</mixed-citation>
    </ref>
    <ref id="pgen.1002967-Nicholson1">
      <label>33</label>
      <mixed-citation publication-type="journal"><name><surname>Nicholson</surname><given-names>G</given-names></name>, <name><surname>Smith</surname><given-names>AV</given-names></name>, <name><surname>Jónsson</surname><given-names>F</given-names></name>, <name><surname>Gústafsson</surname><given-names>Ó</given-names></name>, <name><surname>Stefánsson</surname><given-names>K</given-names></name>, <etal>et al</etal> (<year>2002</year>) <article-title>Assessing Pop-ulation Differentiation and Isolation from Single-Nucleotide Polymorphism Data</article-title>. <source>Journal of the Royal Statistical Society Series B (Statistical Methodology)</source>
<volume>64</volume>: <fpage>695</fpage>–<lpage>715</lpage>.</mixed-citation>
    </ref>
    <ref id="pgen.1002967-CavalliSforza3">
      <label>34</label>
      <mixed-citation publication-type="journal"><name><surname>Cavalli-Sforza</surname><given-names>LL</given-names></name> (<year>1973</year>) <article-title>Analytic review: some current problems of human population genet-ics</article-title>. <source>Am J Hum Genet</source>
<volume>25</volume>: <fpage>82</fpage>–<lpage>104</lpage>.<pub-id pub-id-type="pmid">4567614</pub-id></mixed-citation>
    </ref>
    <ref id="pgen.1002967-CavalliSforza4">
      <label>35</label>
      <mixed-citation publication-type="journal"><name><surname>Cavalli-Sforza</surname><given-names>LL</given-names></name>, <name><surname>Piazza</surname><given-names>A</given-names></name> (<year>1975</year>) <article-title>Analysis of evolution: evolutionary rates, independence and treeness</article-title>. <source>Theor Popul Biol</source>
<volume>8</volume>: <fpage>127</fpage>–<lpage>65</lpage>.<pub-id pub-id-type="pmid">1198349</pub-id></mixed-citation>
    </ref>
    <ref id="pgen.1002967-Keinan1">
      <label>36</label>
      <mixed-citation publication-type="journal"><name><surname>Keinan</surname><given-names>A</given-names></name>, <name><surname>Mullikin</surname><given-names>JC</given-names></name>, <name><surname>Patterson</surname><given-names>N</given-names></name>, <name><surname>Reich</surname><given-names>D</given-names></name> (<year>2007</year>) <article-title>Measurement of the human allele fre-quency spectrum demonstrates greater genetic drift in East Asians than in Europeans</article-title>. <source>Nat Genet</source>
<volume>39</volume>: <fpage>1251</fpage>–<lpage>5</lpage>.<pub-id pub-id-type="pmid">17828266</pub-id></mixed-citation>
    </ref>
    <ref id="pgen.1002967-Reich1">
      <label>37</label>
      <mixed-citation publication-type="journal"><name><surname>Reich</surname><given-names>D</given-names></name>, <name><surname>Thangaraj</surname><given-names>K</given-names></name>, <name><surname>Patterson</surname><given-names>N</given-names></name>, <name><surname>Price</surname><given-names>AL</given-names></name>, <name><surname>Singh</surname><given-names>L</given-names></name> (<year>2009</year>) <article-title>Reconstructing Indian popula-tion history</article-title>. <source>Nature</source>
<volume>461</volume>: <fpage>489</fpage>–<lpage>94</lpage>.<pub-id pub-id-type="pmid">19779445</pub-id></mixed-citation>
    </ref>
    <ref id="pgen.1002967-Durand1">
      <label>38</label>
      <mixed-citation publication-type="journal"><name><surname>Durand</surname><given-names>EY</given-names></name>, <name><surname>Patterson</surname><given-names>N</given-names></name>, <name><surname>Reich</surname><given-names>D</given-names></name>, <name><surname>Slatkin</surname><given-names>M</given-names></name> (<year>2011</year>) <article-title>Testing for Ancient Admixture between Closely Related Populations</article-title>. <source>Mol Biol Evol</source>
<volume>28</volume>: <fpage>2239</fpage>–<lpage>52</lpage>.<pub-id pub-id-type="pmid">21325092</pub-id></mixed-citation>
    </ref>
    <ref id="pgen.1002967-Green1">
      <label>39</label>
      <mixed-citation publication-type="journal"><name><surname>Green</surname><given-names>RE</given-names></name>, <name><surname>Krause</surname><given-names>J</given-names></name>, <name><surname>Briggs</surname><given-names>AW</given-names></name>, <name><surname>Maricic</surname><given-names>T</given-names></name>, <name><surname>Stenzel</surname><given-names>U</given-names></name>, <etal>et al</etal> (<year>2010</year>) <article-title>A draft sequence of the Neandertal genome</article-title>. <source>Science</source>
<volume>328</volume>: <fpage>710</fpage>–<lpage>22</lpage>.<pub-id pub-id-type="pmid">20448178</pub-id></mixed-citation>
    </ref>
    <ref id="pgen.1002967-Lathrop1">
      <label>40</label>
      <mixed-citation publication-type="journal"><name><surname>Lathrop</surname><given-names>GM</given-names></name> (<year>1982</year>) <article-title>Evolutionary trees and admixture: phylogenetic inference when some populations are hybridized</article-title>. <source>Ann Hum Genet</source>
<volume>46</volume>: <fpage>245</fpage>–<lpage>55</lpage>.<pub-id pub-id-type="pmid">7125596</pub-id></mixed-citation>
    </ref>
    <ref id="pgen.1002967-Reich2">
      <label>41</label>
      <mixed-citation publication-type="journal"><name><surname>Reich</surname><given-names>D</given-names></name>, <name><surname>Green</surname><given-names>RE</given-names></name>, <name><surname>Kircher</surname><given-names>M</given-names></name>, <name><surname>Krause</surname><given-names>J</given-names></name>, <name><surname>Patterson</surname><given-names>N</given-names></name>, <etal>et al</etal> (<year>2010</year>) <article-title>Genetic history of an archaic hominin group from Denisova Cave in Siberia</article-title>. <source>Nature</source>
<volume>468</volume>: <fpage>1053</fpage>–<lpage>60</lpage>.<pub-id pub-id-type="pmid">21179161</pub-id></mixed-citation>
    </ref>
    <ref id="pgen.1002967-Reich3">
      <label>42</label>
      <mixed-citation publication-type="journal"><name><surname>Reich</surname><given-names>D</given-names></name>, <name><surname>Patterson</surname><given-names>N</given-names></name>, <name><surname>Kircher</surname><given-names>M</given-names></name>, <name><surname>Delfin</surname><given-names>F</given-names></name>, <name><surname>Nandineni</surname><given-names>MR</given-names></name>, <etal>et al</etal> (<year>2011</year>) <article-title>Denisova admixture and the first modern human dispersals into Southeast Asia and Oceania</article-title>. <source>Am J Hum Genet</source>
<volume>89</volume>: <fpage>516</fpage>–<lpage>28</lpage>.<pub-id pub-id-type="pmid">21944045</pub-id></mixed-citation>
    </ref>
    <ref id="pgen.1002967-Moorjani1">
      <label>43</label>
      <mixed-citation publication-type="journal"><name><surname>Moorjani</surname><given-names>P</given-names></name>, <name><surname>Patterson</surname><given-names>N</given-names></name>, <name><surname>Hirschhorn</surname><given-names>JN</given-names></name>, <name><surname>Keinan</surname><given-names>A</given-names></name>, <name><surname>Hao</surname><given-names>L</given-names></name>, <etal>et al</etal> (<year>2011</year>) <article-title>The history of African gene flow into Southern Europeans, Levantines, and Jews</article-title>. <source>PLoS Genet</source>
<volume>7</volume>: <fpage>e1001373</fpage>
<comment>doi:<ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1371/journal.pgen.1001373.">10.1371/journal.pgen.1001373.</ext-link></comment>.<pub-id pub-id-type="pmid">21533020</pub-id></mixed-citation>
    </ref>
    <ref id="pgen.1002967-Rasmussen1">
      <label>44</label>
      <mixed-citation publication-type="journal"><name><surname>Rasmussen</surname><given-names>M</given-names></name>, <name><surname>Guo</surname><given-names>X</given-names></name>, <name><surname>Wang</surname><given-names>Y</given-names></name>, <name><surname>Lohmueller</surname><given-names>KE</given-names></name>, <name><surname>Rasmussen</surname><given-names>S</given-names></name>, <etal>et al</etal> (<year>2011</year>) <article-title>An Aboriginal Australian genome reveals separate human dispersals into Asia</article-title>. <source>Science</source>
<volume>334</volume>: <fpage>94</fpage>–<lpage>8</lpage>.<pub-id pub-id-type="pmid">21940856</pub-id></mixed-citation>
    </ref>
    <ref id="pgen.1002967-Huson1">
      <label>45</label>
      <mixed-citation publication-type="other">Huson D, Rupp R, Scornavacca C (2010) Phylogenetic Networks. Concepts, Algorithms and Applications. Cambridge University Press.</mixed-citation>
    </ref>
    <ref id="pgen.1002967-Huson2">
      <label>46</label>
      <mixed-citation publication-type="journal"><name><surname>Huson</surname><given-names>DH</given-names></name>, <name><surname>Bryant</surname><given-names>D</given-names></name> (<year>2006</year>) <article-title>Application of phylogenetic networks in evolutionary studies</article-title>. <source>Mol Biol Evol</source>
<volume>23</volume>: <fpage>254</fpage>–<lpage>67</lpage>.<pub-id pub-id-type="pmid">16221896</pub-id></mixed-citation>
    </ref>
    <ref id="pgen.1002967-Dyer1">
      <label>47</label>
      <mixed-citation publication-type="journal"><name><surname>Dyer</surname><given-names>RJ</given-names></name>, <name><surname>Nason</surname><given-names>JD</given-names></name> (<year>2004</year>) <article-title>Population Graphs: the graph theoretic shape of genetic structure</article-title>. <source>Mol Ecol</source>
<volume>13</volume>: <fpage>1713</fpage>–<lpage>27</lpage>.<pub-id pub-id-type="pmid">15189198</pub-id></mixed-citation>
    </ref>
    <ref id="pgen.1002967-Coop1">
      <label>48</label>
      <mixed-citation publication-type="journal"><name><surname>Coop</surname><given-names>G</given-names></name>, <name><surname>Witonsky</surname><given-names>D</given-names></name>, <name><surname>Di Rienzo</surname><given-names>A</given-names></name>, <name><surname>Pritchard</surname><given-names>JK</given-names></name> (<year>2010</year>) <article-title>Using environmental correlations to identify loci underlying local adaptation</article-title>. <source>Genetics</source>
<volume>185</volume>: <fpage>1411</fpage>–<lpage>23</lpage>.<pub-id pub-id-type="pmid">20516501</pub-id></mixed-citation>
    </ref>
    <ref id="pgen.1002967-Weir1">
      <label>49</label>
      <mixed-citation publication-type="journal"><name><surname>Weir</surname><given-names>BS</given-names></name>, <name><surname>Hill</surname><given-names>WG</given-names></name> (<year>2002</year>) <article-title>Estimating F-statistics</article-title>. <source>Annu Rev Genet</source>
<volume>36</volume>: <fpage>721</fpage>–<lpage>50</lpage>.<pub-id pub-id-type="pmid">12359738</pub-id></mixed-citation>
    </ref>
    <ref id="pgen.1002967-Felsenstein4">
      <label>50</label>
      <mixed-citation publication-type="other">Felsenstein J (2003) Inferring Phylogenies. Sinauer Associates, 2nd edition.</mixed-citation>
    </ref>
    <ref id="pgen.1002967-DeGiorgio1">
      <label>51</label>
      <mixed-citation publication-type="journal"><name><surname>DeGiorgio</surname><given-names>M</given-names></name>, <name><surname>Jakobsson</surname><given-names>M</given-names></name>, <name><surname>Rosenberg</surname><given-names>NA</given-names></name> (<year>2009</year>) <article-title>Out of Africa: modern humanorigins special feature: explaining worldwide patterns of human genetic variation using a coalescent- based serial founder model of migration outward from Africa</article-title>. <source>Proc Natl Acad Sci U S A</source>
<volume>106</volume>: <fpage>16057</fpage>–<lpage>62</lpage>.<pub-id pub-id-type="pmid">19706453</pub-id></mixed-citation>
    </ref>
    <ref id="pgen.1002967-Jakobsson1">
      <label>52</label>
      <mixed-citation publication-type="journal"><name><surname>Jakobsson</surname><given-names>M</given-names></name>, <name><surname>Scholz</surname><given-names>SW</given-names></name>, <name><surname>Scheet</surname><given-names>P</given-names></name>, <name><surname>Gibbs</surname><given-names>JR</given-names></name>, <name><surname>VanLiere</surname><given-names>JM</given-names></name>, <etal>et al</etal> (<year>2008</year>) <article-title>Genotype, haplotype and copy-number variation in worldwide human populations</article-title>. <source>Nature</source>
<volume>451</volume>: <fpage>998</fpage>–<lpage>1003</lpage>.<pub-id pub-id-type="pmid">18288195</pub-id></mixed-citation>
    </ref>
    <ref id="pgen.1002967-Hellenthal1">
      <label>53</label>
      <mixed-citation publication-type="journal"><name><surname>Hellenthal</surname><given-names>G</given-names></name>, <name><surname>Auton</surname><given-names>A</given-names></name>, <name><surname>Falush</surname><given-names>D</given-names></name> (<year>2008</year>) <article-title>Inferring human colonization history using a copying model</article-title>. <source>PLoS Genet</source>
<volume>4</volume>: <fpage>e1000078</fpage>
<comment>doi:<ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1371/journal.pgen.1000078.">10.1371/journal.pgen.1000078.</ext-link></comment>.<pub-id pub-id-type="pmid">18497854</pub-id></mixed-citation>
    </ref>
    <ref id="pgen.1002967-Patterson2">
      <label>54</label>
      <mixed-citation publication-type="journal"><name><surname>Patterson</surname><given-names>N</given-names></name>, <name><surname>Moorjani</surname><given-names>P</given-names></name>, <name><surname>Luo</surname><given-names>Y</given-names></name>, <name><surname>Mallick</surname><given-names>S</given-names></name>, <name><surname>Rohland</surname><given-names>N</given-names></name>, <etal>et al</etal> (<year>2012</year>) <article-title>Ancient admixture</article-title>. <source>Genetics</source> In Press.</mixed-citation>
    </ref>
    <ref id="pgen.1002967-Price1">
      <label>55</label>
      <mixed-citation publication-type="journal"><name><surname>Price</surname><given-names>AL</given-names></name>, <name><surname>Tandon</surname><given-names>A</given-names></name>, <name><surname>Patterson</surname><given-names>N</given-names></name>, <name><surname>Barnes</surname><given-names>KC</given-names></name>, <name><surname>Rafaels</surname><given-names>N</given-names></name>, <etal>et al</etal> (<year>2009</year>) <article-title>Sensitive detection of chromosomal segments of distinct ancestry in admixed populations</article-title>. <source>PLoS Genet</source>
<volume>5</volume>: <fpage>e1000519</fpage>
<comment>doi:<ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1371/journal.pgen.1000519.">10.1371/journal.pgen.1000519.</ext-link></comment>.<pub-id pub-id-type="pmid">19543370</pub-id></mixed-citation>
    </ref>
    <ref id="pgen.1002967-Xu1">
      <label>56</label>
      <mixed-citation publication-type="journal"><name><surname>Xu</surname><given-names>S</given-names></name>, <name><surname>Huang</surname><given-names>W</given-names></name>, <name><surname>Qian</surname><given-names>J</given-names></name>, <name><surname>Jin</surname><given-names>L</given-names></name> (<year>2008</year>) <article-title>Analysis of genomic admixture in Uyghur and its implication in mapping strategy</article-title>. <source>Am J Hum Genet</source>
<volume>82</volume>: <fpage>883</fpage>–<lpage>94</lpage>.<pub-id pub-id-type="pmid">18355773</pub-id></mixed-citation>
    </ref>
    <ref id="pgen.1002967-Henn1">
      <label>57</label>
      <mixed-citation publication-type="journal"><name><surname>Henn</surname><given-names>BM</given-names></name>, <name><surname>Botigué</surname><given-names>LR</given-names></name>, <name><surname>Gravel</surname><given-names>S</given-names></name>, <name><surname>Wang</surname><given-names>W</given-names></name>, <name><surname>Brisbin</surname><given-names>A</given-names></name>, <etal>et al</etal> (<year>2012</year>) <article-title>Genomic ancestry of North Africans supports back-to-Africa migrations</article-title>. <source>PLoS Genet</source>
<volume>8</volume>: <fpage>e1002397</fpage>
<comment>doi:<ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1371/journal.pgen.1002397.">10.1371/journal.pgen.1002397.</ext-link></comment>.<pub-id pub-id-type="pmid">22253600</pub-id></mixed-citation>
    </ref>
    <ref id="pgen.1002967-Boyko1">
      <label>58</label>
      <mixed-citation publication-type="journal"><name><surname>Boyko</surname><given-names>AR</given-names></name>, <name><surname>Quignon</surname><given-names>P</given-names></name>, <name><surname>Li</surname><given-names>L</given-names></name>, <name><surname>Schoenebeck</surname><given-names>JJ</given-names></name>, <name><surname>Degenhardt</surname><given-names>JD</given-names></name>, <etal>et al</etal> (<year>2010</year>) <article-title>A simple genetic architecture underlies morphological variation in dogs</article-title>. <source>PLoS Biol</source>
<volume>8</volume>: <fpage>e1000451</fpage>
<comment>doi:<ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1371/journal.pbio.1000451.">10.1371/journal.pbio.1000451.</ext-link></comment>.<pub-id pub-id-type="pmid">20711490</pub-id></mixed-citation>
    </ref>
    <ref id="pgen.1002967-American1">
      <label>59</label>
      <mixed-citation publication-type="other">American Kennel Club (2006) The complete dog book. Ballantine Books.</mixed-citation>
    </ref>
    <ref id="pgen.1002967-Parker1">
      <label>60</label>
      <mixed-citation publication-type="journal"><name><surname>Parker</surname><given-names>HG</given-names></name>, <name><surname>Kim</surname><given-names>LV</given-names></name>, <name><surname>Sutter</surname><given-names>NB</given-names></name>, <name><surname>Carlson</surname><given-names>S</given-names></name>, <name><surname>Lorentzen</surname><given-names>TD</given-names></name>, <etal>et al</etal> (<year>2004</year>) <article-title>Genetic structure of the purebred domestic dog</article-title>. <source>Science</source>
<volume>304</volume>: <fpage>1160</fpage>–<lpage>4</lpage>.<pub-id pub-id-type="pmid">15155949</pub-id></mixed-citation>
    </ref>
    <ref id="pgen.1002967-Novembre2">
      <label>61</label>
      <mixed-citation publication-type="journal"><name><surname>Novembre</surname><given-names>J</given-names></name>, <name><surname>Johnson</surname><given-names>T</given-names></name>, <name><surname>Bryc</surname><given-names>K</given-names></name>, <name><surname>Kutalik</surname><given-names>Z</given-names></name>, <name><surname>Boyko</surname><given-names>AR</given-names></name>, <etal>et al</etal> (<year>2008</year>) <article-title>Genes mirror geography within Europe</article-title>. <source>Nature</source>
<volume>456</volume>: <fpage>98</fpage>–<lpage>101</lpage>.<pub-id pub-id-type="pmid">18758442</pub-id></mixed-citation>
    </ref>
    <ref id="pgen.1002967-Novembre3">
      <label>62</label>
      <mixed-citation publication-type="journal"><name><surname>Novembre</surname><given-names>J</given-names></name>, <name><surname>Ramachandran</surname><given-names>S</given-names></name> (<year>2011</year>) <article-title>Perspectives on human population structure at the cusp of the sequencing era</article-title>. <source>Annu Rev Genomics Hum Genet</source>
<volume>12</volume>: <fpage>245</fpage>–<lpage>74</lpage>.<pub-id pub-id-type="pmid">21801023</pub-id></mixed-citation>
    </ref>
    <ref id="pgen.1002967-Bhatia1">
      <label>63</label>
      <mixed-citation publication-type="journal"><name><surname>Bhatia</surname><given-names>G</given-names></name>, <name><surname>Patterson</surname><given-names>N</given-names></name>, <name><surname>Pasaniuc</surname><given-names>B</given-names></name>, <name><surname>Zaitlen</surname><given-names>N</given-names></name>, <name><surname>Genovese</surname><given-names>G</given-names></name>, <etal>et al</etal> (<year>2011</year>) <article-title>Genome-wide com-parison of African-ancestry populations from CARe and other cohorts reveals signals of natural selection</article-title>. <source>Am J Hum Genet</source>
<volume>89</volume>: <fpage>368</fpage>–<lpage>81</lpage>.<pub-id pub-id-type="pmid">21907010</pub-id></mixed-citation>
    </ref>
    <ref id="pgen.1002967-Bonhomme1">
      <label>64</label>
      <mixed-citation publication-type="journal"><name><surname>Bonhomme</surname><given-names>M</given-names></name>, <name><surname>Chevalet</surname><given-names>C</given-names></name>, <name><surname>Servin</surname><given-names>B</given-names></name>, <name><surname>Boitard</surname><given-names>S</given-names></name>, <name><surname>Abdallah</surname><given-names>J</given-names></name>, <etal>et al</etal> (<year>2010</year>) <article-title>Detecting selection in population trees: the Lewontin and Krakauer test extended</article-title>. <source>Genetics</source>
<volume>186</volume>: <fpage>241</fpage>–<lpage>62</lpage>.<pub-id pub-id-type="pmid">20855576</pub-id></mixed-citation>
    </ref>
    <ref id="pgen.1002967-Myers1">
      <label>65</label>
      <mixed-citation publication-type="other">Myers S, Hellenthal G, Lawson D, Busby G, Leslie S, <etal>et al</etal>. (2011). LD patterns in dense variation data reveal information about the history of human populations worldwide. URL <ext-link ext-link-type="uri" xlink:href="http://www.ichg2011.org/cgi-bin/ichg11s?&amp;sort=ptimes&amp;sbutton=Detail&amp;absno=21708&amp;sid=806980">http://www.ichg2011.org/cgi-bin/ichg11s?&amp;sort=ptimes&amp;sbutton=Detail&amp;absno=21708&amp;sid=806980</ext-link>.</mixed-citation>
    </ref>
    <ref id="pgen.1002967-Lawson2">
      <label>66</label>
      <mixed-citation publication-type="other">Lawson CL, Hanson RJ (1995) Solving least squares problems. Philadelphia, PA: Society for Industrial Mathematics, 3rd edition.</mixed-citation>
    </ref>
    <ref id="pgen.1002967-Press1">
      <label>67</label>
      <mixed-citation publication-type="other">Press WH, Teukolsky SA, Vetterling WT, Flannery BP (1992) Numerical recipes in C (2<sup>nd</sup> ed.): the art of scientific computing. New York, NY, USA: Cambridge University Press.</mixed-citation>
    </ref>
    <ref id="pgen.1002967-LindbladToh1">
      <label>68</label>
      <mixed-citation publication-type="journal"><name><surname>Lindblad-Toh</surname><given-names>K</given-names></name>, <name><surname>Wade</surname><given-names>CM</given-names></name>, <name><surname>Mikkelsen</surname><given-names>TS</given-names></name>, <name><surname>Karlsson</surname><given-names>EK</given-names></name>, <name><surname>Jaffe</surname><given-names>DB</given-names></name>, <etal>et al</etal> (<year>2005</year>) <article-title>Genome sequence, comparative analysis and haplotype structure of the domestic dog</article-title>. <source>Nature</source>
<volume>438</volume>: <fpage>803</fpage>–<lpage>19</lpage>.<pub-id pub-id-type="pmid">16341006</pub-id></mixed-citation>
    </ref>
    <ref id="pgen.1002967-Hudson1">
      <label>69</label>
      <mixed-citation publication-type="journal"><name><surname>Hudson</surname><given-names>RR</given-names></name> (<year>2002</year>) <article-title>Generating samples under a Wright-Fisher neutral model of genetic varia-tion</article-title>. <source>Bioinformatics</source>
<volume>18</volume>: <fpage>337</fpage>–<lpage>8</lpage>.<pub-id pub-id-type="pmid">11847089</pub-id></mixed-citation>
    </ref>
    <ref id="pgen.1002967-Sukumaran1">
      <label>70</label>
      <mixed-citation publication-type="journal"><name><surname>Sukumaran</surname><given-names>J</given-names></name>, <name><surname>Holder</surname><given-names>MT</given-names></name> (<year>2010</year>) <article-title>DendroPy: a Python library for phylogenetic computing</article-title>. <source>Bioinformatics</source>
<volume>26</volume>: <fpage>1569</fpage>–<lpage>71</lpage>.<pub-id pub-id-type="pmid">20421198</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
