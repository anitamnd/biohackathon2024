<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.1 20151215//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-archivearticle1.dtd?>
<?SourceDTD.Version 1.1?>
<?ConverterInfo.XSLTName jp2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">PLoS One</journal-id>
    <journal-id journal-id-type="iso-abbrev">PLoS ONE</journal-id>
    <journal-id journal-id-type="publisher-id">plos</journal-id>
    <journal-id journal-id-type="pmc">plosone</journal-id>
    <journal-title-group>
      <journal-title>PLoS ONE</journal-title>
    </journal-title-group>
    <issn pub-type="epub">1932-6203</issn>
    <publisher>
      <publisher-name>Public Library of Science</publisher-name>
      <publisher-loc>San Francisco, USA</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">4221433</article-id>
    <article-id pub-id-type="pmid">25372567</article-id>
    <article-id pub-id-type="publisher-id">PONE-D-14-26604</article-id>
    <article-id pub-id-type="doi">10.1371/journal.pone.0111988</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Research Article</subject>
      </subj-group>
      <subj-group subj-group-type="Discipline-v2">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Computational Biology</subject>
          <subj-group>
            <subject>Genome Analysis</subject>
            <subj-group>
              <subject>Transcriptome Analysis</subject>
              <subj-group>
                <subject>Genome Expression Analysis</subject>
              </subj-group>
            </subj-group>
          </subj-group>
          <subj-group>
            <subject>Biological Data Management</subject>
          </subj-group>
        </subj-group>
        <subj-group>
          <subject>Genetics</subject>
          <subj-group>
            <subject>Gene Expression</subject>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v2">
        <subject>Computer and Information Sciences</subject>
        <subj-group>
          <subject>Computer Software</subject>
          <subj-group>
            <subject>Systems Software</subject>
          </subj-group>
        </subj-group>
        <subj-group>
          <subject>Data Visualization</subject>
        </subj-group>
        <subj-group>
          <subject>Software Engineering</subject>
          <subj-group>
            <subject>Software Tools</subject>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v2">
        <subject>Engineering and Technology</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>HemI: A Toolkit for Illustrating Heatmaps</article-title>
      <alt-title alt-title-type="running-head">The Heatmap Visualization</alt-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author" equal-contrib="yes">
        <name>
          <surname>Deng</surname>
          <given-names>Wankun</given-names>
        </name>
        <xref ref-type="aff" rid="aff1"/>
      </contrib>
      <contrib contrib-type="author" equal-contrib="yes">
        <name>
          <surname>Wang</surname>
          <given-names>Yongbo</given-names>
        </name>
        <xref ref-type="aff" rid="aff1"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Liu</surname>
          <given-names>Zexian</given-names>
        </name>
        <xref ref-type="aff" rid="aff1"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Cheng</surname>
          <given-names>Han</given-names>
        </name>
        <xref ref-type="aff" rid="aff1"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Xue</surname>
          <given-names>Yu</given-names>
        </name>
        <xref ref-type="aff" rid="aff1"/>
        <xref ref-type="corresp" rid="cor1">
          <sup>*</sup>
        </xref>
      </contrib>
    </contrib-group>
    <aff id="aff1">
      <addr-line>Department of Biomedical Engineering, College of Life Science and Technology, Huazhong University of Science and Technology, Wuhan, Hubei, China</addr-line>
    </aff>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Zhang</surname>
          <given-names>Zhang</given-names>
        </name>
        <role>Editor</role>
        <xref ref-type="aff" rid="edit1"/>
      </contrib>
    </contrib-group>
    <aff id="edit1">
      <addr-line>Beijing Institute of Genomics, Chinese Academy of Sciences, China</addr-line>
    </aff>
    <author-notes>
      <corresp id="cor1">* E-mail: <email>xueyu@hust.edu.cn</email></corresp>
      <fn fn-type="COI-statement">
        <p><bold>Competing Interests: </bold>YX is a PLOS ONE Editorial Board member. This does not alter the authors' adherence to PLOS ONE Editorial policies and criteria.</p>
      </fn>
      <fn fn-type="con">
        <p>Conceived and designed the experiments: YX. Performed the experiments: WD YW. Analyzed the data: WD YW YX. Contributed reagents/materials/analysis tools: ZL HC. Wrote the paper: WD YW YX.</p>
      </fn>
    </author-notes>
    <pub-date pub-type="collection">
      <year>2014</year>
    </pub-date>
    <pub-date pub-type="epub">
      <day>5</day>
      <month>11</month>
      <year>2014</year>
    </pub-date>
    <volume>9</volume>
    <issue>11</issue>
    <elocation-id>e111988</elocation-id>
    <history>
      <date date-type="received">
        <day>30</day>
        <month>6</month>
        <year>2014</year>
      </date>
      <date date-type="accepted">
        <day>4</day>
        <month>10</month>
        <year>2014</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© 2014 Deng et al</copyright-statement>
      <copyright-year>2014</copyright-year>
      <copyright-holder>Deng et al</copyright-holder>
      <license xlink:href="http://creativecommons.org/licenses/by/4.0/">
        <license-p>This is an open-access article distributed under the terms of the Creative Commons Attribution License, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are properly credited.</license-p>
      </license>
    </permissions>
    <abstract>
      <p>Recent high-throughput techniques have generated a flood of biological data in all aspects. The transformation and visualization of multi-dimensional and numerical gene or protein expression data in a single heatmap can provide a concise but comprehensive presentation of molecular dynamics under different conditions. In this work, we developed an easy-to-use tool named HemI (Heat map Illustrator), which can visualize either gene or protein expression data in heatmaps. Additionally, the heatmaps can be recolored, rescaled or rotated in a customized manner. In addition, HemI provides multiple clustering strategies for analyzing the data. Publication-quality figures can be exported directly. We propose that HemI can be a useful toolkit for conveniently visualizing and manipulating heatmaps. The stand-alone packages of HemI were implemented in Java and can be accessed at <ext-link ext-link-type="uri" xlink:href="http://hemi.biocuckoo.org/down.php">http://hemi.biocuckoo.org/down.php</ext-link>.</p>
    </abstract>
    <funding-group>
      <funding-statement>The work was supported, in whole or in part, by the National Basic Research Program (973 project) (2012CB910101, and 2013CB9339002), Natural Science Foundation of China (31171263, 81272578 and J1103514), International Science &amp; Technology Cooperation Program of China (2014DFB30020), China Postdoctoral Science Foundation (2014M550392), and Fundamental Research Funds for the Central Universities (HUST: 2013TS080, 2014YQ003). The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.</funding-statement>
    </funding-group>
    <counts>
      <page-count count="5"/>
    </counts>
    <custom-meta-group>
      <custom-meta id="data-availability">
        <meta-name>Data Availability</meta-name>
        <meta-value>The authors confirm that all data underlying the findings are fully available without restriction. All relevant data are within the paper.</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
  <notes>
    <title>Data Availability</title>
    <p>The authors confirm that all data underlying the findings are fully available without restriction. All relevant data are within the paper.</p>
  </notes>
</front>
<body>
  <sec id="s1">
    <title>Introduction</title>
    <p>A good picture is worth a thousand words. Recent progress in high-throughput techniques, such as DNA microarray, next-generation sequencing (NGS) and quantitative proteomics, has increased the demand for the visualization of multi-dimensional and numeric data <xref rid="pone.0111988-Koschmieder1" ref-type="bibr">[1]</xref>–<xref rid="pone.0111988-Collison1" ref-type="bibr">[3]</xref>.</p>
    <p>As an intuitive strategy, a heatmap can graphically visualize the matrix data by representing individual values with different colors. To estimate how many papers have heatmaps, we carefully curated all original research articles published in 2012 of five leading journals, including <italic>Nature Biotechnology</italic>, <italic>Cancer Cell</italic>, <italic>Genome Research</italic>, <italic>Genome Biology</italic>, and <italic>Molecular &amp; Cellular Proteomics</italic>, and found that ∼30.4% (202 out of 664 papers) contain at least one figure for heatmaps (<xref ref-type="table" rid="pone-0111988-t001">Table 1</xref>). We also manually checked the 202 papers, and observed that the methods for drawing heatmaps were not mentioned in up to ∼66% (134/202) of them (<xref ref-type="table" rid="pone-0111988-t002">Table 2</xref>). For 68 remaining papers in which the tools were clearly stated, nearly ∼46% of them visualized heatmaps with the R language package (<xref ref-type="table" rid="pone-0111988-t002">Table 2</xref>). However, considerable programming skills, which some researchers do not possess, are needed for using R. Also, we found the Java Treeview, an illustrator of microarray data <xref rid="pone.0111988-Saldanha1" ref-type="bibr">[4]</xref>, was used in ∼24% of the 68 papers. Although the Java Treeview doesn't perform any clustering analyses, a clustered data file in CDT format generated by other tools must be provided an input. To overcome this limitation, Seo <italic>et al.</italic> developed an interactive tool of Hierarchical Clustering Explorer (HCE) for both visualizing heatmaps and clustering the numeric data <xref rid="pone.0111988-Seo1" ref-type="bibr">[5]</xref>. The heatmaps in HCE can be easily manipulated, whereas the artwork quality was yet to be improved. Moreover, although heatmaps can be accomplished by a number of commercial or non-commercial softwares such as GeneSpring GX, Mayday <xref rid="pone.0111988-Battke1" ref-type="bibr">[6]</xref>, Cytobank <xref rid="pone.0111988-Chen1" ref-type="bibr">[7]</xref> and D3 (<ext-link ext-link-type="uri" xlink:href="http://d3js.org/">http://d3js.org/</ext-link>), these tools were not designed specifically for heatmap generating. Recently, an interactive heatmap viewer called jHeatmap was developed <xref rid="pone.0111988-DeuPons1" ref-type="bibr">[8]</xref>. The tool is useful for the intuitive and interactive visualization of complex data in the form of heatmaps. However, no further manipulations, such as re-coloration and re-rotation, can be performed. Also, the visualized heatmaps cannot be exported for the publication proposes. Thus, the development of an easy-to-use toolkit for conveniently illustrating heatmaps and exporting publication-quality figures will be a great help for both bioinformaticians and experimentalists.</p>
    <table-wrap id="pone-0111988-t001" orientation="portrait" position="float">
      <object-id pub-id-type="doi">10.1371/journal.pone.0111988.t001</object-id>
      <label>Table 1</label>
      <caption>
        <title>Using frequency of heatmap.</title>
      </caption>
      <alternatives>
        <graphic id="pone-0111988-t001-1" xlink:href="pone.0111988.t001"/>
        <table frame="hsides" rules="groups">
          <colgroup span="1">
            <col align="left" span="1"/>
            <col align="center" span="1"/>
            <col align="center" span="1"/>
            <col align="center" span="1"/>
          </colgroup>
          <thead>
            <tr>
              <td align="left" rowspan="1" colspan="1">Journal</td>
              <td align="left" rowspan="1" colspan="1">Num. of papers</td>
              <td align="left" rowspan="1" colspan="1">Num. of heatmaps<xref ref-type="table-fn" rid="nt102">a</xref>
</td>
              <td align="left" rowspan="1" colspan="1">Per.<xref ref-type="table-fn" rid="nt103">b</xref>
</td>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td align="left" rowspan="1" colspan="1">
                <italic>Nature Biotechnology</italic>
              </td>
              <td align="left" rowspan="1" colspan="1">81</td>
              <td align="left" rowspan="1" colspan="1">19</td>
              <td align="left" rowspan="1" colspan="1">23.46%</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">
                <italic>Cancer Cell</italic>
              </td>
              <td align="left" rowspan="1" colspan="1">106</td>
              <td align="left" rowspan="1" colspan="1">40</td>
              <td align="left" rowspan="1" colspan="1">37.74%</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">
                <italic>Genome Research</italic>
              </td>
              <td align="left" rowspan="1" colspan="1">144</td>
              <td align="left" rowspan="1" colspan="1">58</td>
              <td align="left" rowspan="1" colspan="1">40.28%</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">
                <italic>Genome Biology</italic>
              </td>
              <td align="left" rowspan="1" colspan="1">92</td>
              <td align="left" rowspan="1" colspan="1">26</td>
              <td align="left" rowspan="1" colspan="1">28.26%</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">
                <italic>Molecular &amp; Cellular Proteomics</italic>
              </td>
              <td align="left" rowspan="1" colspan="1">241</td>
              <td align="left" rowspan="1" colspan="1">59</td>
              <td align="left" rowspan="1" colspan="1">24.48%</td>
            </tr>
          </tbody>
        </table>
      </alternatives>
      <table-wrap-foot>
        <fn id="nt101">
          <label/>
          <p>To estimate <italic>how</italic> many papers contain heatmaps, we went through all original research papers (excluding reviews and other articles) published in 2012 of five leading journals as below.</p>
        </fn>
        <fn id="nt102">
          <label>a</label>
          <p>Num. of Heatmaps, the number of papers containing with at least one heatmap figure;</p>
        </fn>
        <fn id="nt103">
          <label>b</label>
          <p>Per., the percentiles.</p>
        </fn>
      </table-wrap-foot>
    </table-wrap>
    <table-wrap id="pone-0111988-t002" orientation="portrait" position="float">
      <object-id pub-id-type="doi">10.1371/journal.pone.0111988.t002</object-id>
      <label>Table 2</label>
      <caption>
        <title>The summarization of the methods for illustrating heatmaps among the 202 papers published in 2012 on five leading journals.</title>
      </caption>
      <alternatives>
        <graphic id="pone-0111988-t002-2" xlink:href="pone.0111988.t002"/>
        <table frame="hsides" rules="groups">
          <colgroup span="1">
            <col align="left" span="1"/>
            <col align="center" span="1"/>
            <col align="center" span="1"/>
          </colgroup>
          <thead>
            <tr>
              <td align="left" rowspan="1" colspan="1">Tools<xref ref-type="table-fn" rid="nt104">a</xref>
</td>
              <td align="left" rowspan="1" colspan="1">Num.<xref ref-type="table-fn" rid="nt105">b</xref>
</td>
              <td align="left" rowspan="1" colspan="1">Web link<xref ref-type="table-fn" rid="nt106">c</xref>
</td>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td align="left" rowspan="1" colspan="1">R</td>
              <td align="left" rowspan="1" colspan="1">31</td>
              <td align="left" rowspan="1" colspan="1">
                <ext-link ext-link-type="uri" xlink:href="http://www.r-project.org/">http://www.r-project.org/</ext-link>
              </td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">Java Treeview</td>
              <td align="left" rowspan="1" colspan="1">16</td>
              <td align="left" rowspan="1" colspan="1">
                <ext-link ext-link-type="uri" xlink:href="http://jtreeview.sourceforge.net/">http://jtreeview.sourceforge.net/</ext-link>
              </td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">MATLAB</td>
              <td align="left" rowspan="1" colspan="1">7</td>
              <td align="left" rowspan="1" colspan="1">
                <ext-link ext-link-type="uri" xlink:href="http://www.mathworks.cn/products/matlab/">http://www.mathworks.cn/products/matlab/</ext-link>
              </td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">SPSS</td>
              <td align="left" rowspan="1" colspan="1">4</td>
              <td align="left" rowspan="1" colspan="1">
                <ext-link ext-link-type="uri" xlink:href="http://www-01.ibm.com/software/analytics/spss/">http://www-01.ibm.com/software/analytics/spss/</ext-link>
              </td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">GeneSpring</td>
              <td align="left" rowspan="1" colspan="1">2</td>
              <td align="left" rowspan="1" colspan="1">
                <ext-link ext-link-type="uri" xlink:href="http://genespring-support.com/">http://genespring-support.com/</ext-link>
              </td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">MultiExperiment Viewer</td>
              <td align="left" rowspan="1" colspan="1">2</td>
              <td align="left" rowspan="1" colspan="1">
                <ext-link ext-link-type="uri" xlink:href="http://www.tm4.org/mev.html">http://www.tm4.org/mev.html</ext-link>
              </td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">Cytobank</td>
              <td align="left" rowspan="1" colspan="1">1</td>
              <td align="left" rowspan="1" colspan="1">
                <ext-link ext-link-type="uri" xlink:href="https://www.cytobank.org/">https://www.cytobank.org/</ext-link>
              </td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">Heatmap Builder</td>
              <td align="left" rowspan="1" colspan="1">1</td>
              <td align="left" rowspan="1" colspan="1">
                <ext-link ext-link-type="uri" xlink:href="http://ashleylab.stanford.edu/tools/tools-scripts.html">http://ashleylab.stanford.edu/tools/tools-scripts.html</ext-link>
              </td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">Integrative Genomics Viewer</td>
              <td align="left" rowspan="1" colspan="1">1</td>
              <td align="left" rowspan="1" colspan="1">
                <ext-link ext-link-type="uri" xlink:href="http://www.broadinstitute.org/igv/">http://www.broadinstitute.org/igv/</ext-link>
              </td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">Matrix2png</td>
              <td align="left" rowspan="1" colspan="1">1</td>
              <td align="left" rowspan="1" colspan="1">
                <ext-link ext-link-type="uri" xlink:href="http://www.chibi.ubc.ca/matrix2png/">http://www.chibi.ubc.ca/matrix2png/</ext-link>
              </td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">Mayday</td>
              <td align="left" rowspan="1" colspan="1">1</td>
              <td align="left" rowspan="1" colspan="1">
                <ext-link ext-link-type="uri" xlink:href="http://microarray-analysis.org">http://microarray-analysis.org</ext-link>
              </td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">Processing</td>
              <td align="left" rowspan="1" colspan="1">1</td>
              <td align="left" rowspan="1" colspan="1">
                <ext-link ext-link-type="uri" xlink:href="http://processing.org/">http://processing.org/</ext-link>
              </td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">N/A<xref ref-type="table-fn" rid="nt107">d</xref>
</td>
              <td align="left" rowspan="1" colspan="1">134</td>
              <td align="left" rowspan="1" colspan="1">N/A</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">Total</td>
              <td align="left" rowspan="1" colspan="1">202</td>
              <td align="left" rowspan="1" colspan="1"/>
            </tr>
          </tbody>
        </table>
      </alternatives>
      <table-wrap-foot>
        <fn id="nt104">
          <label>a</label>
          <p>Tools, the name of used tools;</p>
        </fn>
        <fn id="nt105">
          <label>b</label>
          <p>Num., the number of papers that used the tool;</p>
        </fn>
        <fn id="nt106">
          <label>c</label>
          <p>Web link, the website of the tool;</p>
        </fn>
        <fn id="nt107">
          <label>d</label>
          <p>N/A, not mentioned in the corresponding papers.</p>
        </fn>
      </table-wrap-foot>
    </table-wrap>
  </sec>
  <sec sec-type="methods" id="s2">
    <title>Method</title>
    <p>In this work, we presented a novel software package of HemI (Heatmap Illustrator, version 1.0), which used a red, green, and blue tricolor in a 256 color mode. Given a selected color scale, the total color space will be automatically processed into a numerical matrix (768 rows * 3 columns) by Java. Then the inputted gene or protein expression data can be linearly normalized as below:<disp-formula id="pone.0111988.e001"><graphic xlink:href="pone.0111988.e001.jpg" position="anchor" orientation="portrait"/><label>(1)</label></disp-formula>More frequently, researchers prefer to visualize the logarithmic relations between different conditions and molecular expression levels. Thus, the original data can also be normalized as below:<disp-formula id="pone.0111988.e002"><graphic xlink:href="pone.0111988.e002.jpg" position="anchor" orientation="portrait"/><label>(2)</label></disp-formula>While</p>
    <list list-type="bullet">
      <list-item>
        <p><italic>NV</italic> = normalized value</p>
      </list-item>
      <list-item>
        <p><italic>OV</italic> = original value</p>
      </list-item>
      <list-item>
        <p><italic>Max</italic> = the maximum of all OVs</p>
      </list-item>
      <list-item>
        <p><italic>Min</italic> = the minimum of all OVs</p>
      </list-item>
      <list-item>
        <p><italic>a</italic> = 2 (default), and can also be use-defined as 10 or e</p>
      </list-item>
    </list>
    <p>In both equations, the <italic>Max</italic> cannot be equal to <italic>Min</italic>, and both <italic>OV</italic> and <italic>Min</italic> values must be greater than 0 in <xref ref-type="disp-formula" rid="pone.0111988.e002">Eq. 2</xref>. The calculated <italic>NV</italic>s were then mapped to the color matrix, while the tricolor values of the nearest number of rows were visualized.</p>
    <p>For further analysis of the data in heatmaps, several clustering approaches such as the hierarchical and <italic>k</italic>-means clustering algorithms, were also integrated. To calculate the distance, three types of linkage criteria (<xref ref-type="table" rid="pone-0111988-t003">Table 3</xref>) and seven kinds of metrics (<xref ref-type="table" rid="pone-0111988-t004">Table 4</xref>) were adopted for the two algorithms, respectively.</p>
    <table-wrap id="pone-0111988-t003" orientation="portrait" position="float">
      <object-id pub-id-type="doi">10.1371/journal.pone.0111988.t003</object-id>
      <label>Table 3</label>
      <caption>
        <title>Three mostly used linkage criteria for the hierarchical clustering.</title>
      </caption>
      <alternatives>
        <graphic id="pone-0111988-t003-3" xlink:href="pone.0111988.t003"/>
        <table frame="hsides" rules="groups">
          <colgroup span="1">
            <col align="left" span="1"/>
            <col align="center" span="1"/>
          </colgroup>
          <thead>
            <tr>
              <td align="left" rowspan="1" colspan="1">Linkage criterion</td>
              <td align="left" rowspan="1" colspan="1">Equation</td>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td align="left" rowspan="1" colspan="1">Average linkage clustering (default)</td>
              <td align="left" rowspan="1" colspan="1">
                <inline-formula>
                  <inline-graphic xlink:href="pone.0111988.e003.jpg"/>
                </inline-formula>
              </td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">Minimum linkage clustering</td>
              <td align="left" rowspan="1" colspan="1">
                <inline-formula>
                  <inline-graphic xlink:href="pone.0111988.e004.jpg"/>
                </inline-formula>
              </td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">Maximum linkage clustering</td>
              <td align="left" rowspan="1" colspan="1">
                <inline-formula>
                  <inline-graphic xlink:href="pone.0111988.e005.jpg"/>
                </inline-formula>
              </td>
            </tr>
          </tbody>
        </table>
      </alternatives>
      <table-wrap-foot>
        <fn id="nt108">
          <label/>
          <p>To calculate the pairwise distances for the hierarchical clustering, three commonly used linkage criteria were taken from the Wikipedia (<ext-link ext-link-type="uri" xlink:href="http://en.wikipedia.org/wiki/Hierarchical_clustering">http://en.wikipedia.org/wiki/Hierarchical_clustering</ext-link>).</p>
        </fn>
      </table-wrap-foot>
    </table-wrap>
    <table-wrap id="pone-0111988-t004" orientation="portrait" position="float">
      <object-id pub-id-type="doi">10.1371/journal.pone.0111988.t004</object-id>
      <label>Table 4</label>
      <caption>
        <title>Seven distances for the clustering.</title>
      </caption>
      <alternatives>
        <graphic id="pone-0111988-t004-4" xlink:href="pone.0111988.t004"/>
        <table frame="hsides" rules="groups">
          <colgroup span="1">
            <col align="left" span="1"/>
            <col align="center" span="1"/>
          </colgroup>
          <thead>
            <tr>
              <td align="left" rowspan="1" colspan="1">Distance</td>
              <td align="left" rowspan="1" colspan="1">Equation</td>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td align="left" rowspan="1" colspan="1">Euclidean distance</td>
              <td align="left" rowspan="1" colspan="1">
                <inline-formula>
                  <inline-graphic xlink:href="pone.0111988.e006.jpg"/>
                </inline-formula>
              </td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">Squared Euclidean distance</td>
              <td align="left" rowspan="1" colspan="1">
                <inline-formula>
                  <inline-graphic xlink:href="pone.0111988.e007.jpg"/>
                </inline-formula>
              </td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">Manhattan distance</td>
              <td align="left" rowspan="1" colspan="1">
                <inline-formula>
                  <inline-graphic xlink:href="pone.0111988.e008.jpg"/>
                </inline-formula>
              </td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">Maximum distance</td>
              <td align="left" rowspan="1" colspan="1">
                <inline-formula>
                  <inline-graphic xlink:href="pone.0111988.e009.jpg"/>
                </inline-formula>
              </td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">Pearson distance (default)</td>
              <td align="left" rowspan="1" colspan="1">
                <inline-formula>
                  <inline-graphic xlink:href="pone.0111988.e010.jpg"/>
                </inline-formula>
              </td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">Spearman distance</td>
              <td align="left" rowspan="1" colspan="1">
                <inline-formula>
                  <inline-graphic xlink:href="pone.0111988.e011.jpg"/>
                </inline-formula>
              </td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">Kendall's tau distance</td>
              <td align="left" rowspan="1" colspan="1">
                <inline-formula>
                  <inline-graphic xlink:href="pone.0111988.e012.jpg"/>
                </inline-formula>
              </td>
            </tr>
          </tbody>
        </table>
      </alternatives>
      <table-wrap-foot>
        <fn id="nt109">
          <label/>
          <p>To calculate the distances for the hierarchical and k-means clustering approaches, up to 7 mostly used distances were adopted.</p>
        </fn>
      </table-wrap-foot>
    </table-wrap>
    <p>HemI 1.0 was written in Java 1.6 (J2SE 6.0) and packaged with Install4j 4.0.8. We developed six packages to support three major ×86/×64 operating systems (OSs), including Windows, Unix/Linux, and Mac. The stability and applicability of HemI was rigorously tested under Windows XP/7, Ubuntu, and Apple Mac OS X 10.5 (Leopard).</p>
  </sec>
  <sec id="s3">
    <title>Usage</title>
    <p>Heml was developed in an easy-to-use mode. Here, we took data from a previously published study <xref rid="pone.0111988-Zhao1" ref-type="bibr">[9]</xref> as a demo to describe the usage of HemI. Androgen receptor (AR), a hormone-activated transcription factor, regulates prostate development, function and malignant transformation as an essential transcriptional repressor <xref rid="pone.0111988-Zhao1" ref-type="bibr">[9]</xref>. To characterize potentially AR-regulated genes, LNCaP prostate cancer cells were first hormone-starved for 3 days. Then, the gene expression levels were profiled after 3, 6, 12, 24 and 48 hours of androgen treatment <xref rid="pone.0111988-Zhao1" ref-type="bibr">[9]</xref>. Totally, Zhao <italic>et al.</italic> identified 428 androgen-repressed genes <xref rid="pone.0111988-Zhao1" ref-type="bibr">[9]</xref>, and the corresponding data set was used as an example for HemI.</p>
    <p>First, the numerical data in one of the three file formats, including Microsoft Excel spreadsheet (.xls), Tab Separated Value (TSV) or Comma Separated Value (CSV) can be loaded through clicking on the “LOAD” button of the main interface. Then, users can select the numerical data area for visualizing a heatmap with mouse-dragging or holding-SHIFT-then-click manipulations. The titles for <italic>X</italic>-axis and <italic>Y</italic>-axis can be specified by inputting number of row and column in the data sheet (<xref ref-type="fig" rid="pone-0111988-g001">Figure 1A</xref>). For convenience, an “Auto Fill” button was provided, while the first column and row were regarded as the titles of <italic>Y</italic>-axis and <italic>X</italic>-axis, respectively. A heatmap will be automatically generated after clicking on the finish button.</p>
    <fig id="pone-0111988-g001" orientation="portrait" position="float">
      <object-id pub-id-type="doi">10.1371/journal.pone.0111988.g001</object-id>
      <label>Figure 1</label>
      <caption>
        <title>Usage of HemI 1.0.</title>
        <p>(A) The numerical data in one of three file formats can be directly loaded, whereas the data area can be selected by dragging or holding-SHIFT-then-click manipulations. Titles for <italic>X</italic>-axis or <italic>Y</italic>-axis can also be specified; (B) Multiple options for manipulating the heatmp; (C) The numeric data can be clustered for either or both of <italic>X</italic>-axis and <italic>Y</italic>-axis; (D) Publication-quality figures can be exported, and two figure formats were supported.</p>
      </caption>
      <graphic xlink:href="pone.0111988.g001"/>
    </fig>
    <p>The generated heatmap can be easily manipulated in a customized manner. For example, the width and height of the artwork can be adjusted, whereas the blank space out of the heatmap can also be changed (<xref ref-type="fig" rid="pone-0111988-g001">Figure 1B</xref>). The picture can be re-colored, re-rotated, and the <italic>X</italic>-axis and <italic>Y</italic>-axis can be interchanged (<xref ref-type="fig" rid="pone-0111988-g001">Figure 1B</xref>). Moreover, the corresponding data can be clustered for either or both of <italic>X</italic>-axis and <italic>Y</italic>-axis by clicking on the clustering options of main panel (<xref ref-type="fig" rid="pone-0111988-g001">Figure 1C</xref>). After all configurations are finalized, the new heatmap can be updated and displayed by clicking on the “REFRESH” button.</p>
    <p>To obtain publication-quality figures, users can export heatmaps by right-clicking on the canvas and choosing the export option. Users can select different resolutions for outputting figures, such as 72 dpi, 300 dpi and 600 dpi (<xref ref-type="fig" rid="pone-0111988-g001">Figure 1D</xref>). Two picture formats, including.png and.tiff, were also provided to satisfy the different requirements. The whole procedure was carefully implemented into a video with ∼4 minutes on our website (<ext-link ext-link-type="uri" xlink:href="http://hemi.biocuckoo.org/faq.php">http://hemi.biocuckoo.org/faq.php</ext-link>).</p>
  </sec>
  <sec id="s4">
    <title>Discussion</title>
    <p>The heatmap of potentially AR-regulated genes <xref rid="pone.0111988-Zhao1" ref-type="bibr">[9]</xref> was re-illustrated by HemI (<xref ref-type="fig" rid="pone-0111988-g002">Figure 2A</xref>). Also, poly-ADP-ribose polymerase (PARP) family proteins are involved in a variety of cellular pathways such as DNA repair and cell death, and regarded as a class of important drug targets in cancer therapeutics <xref rid="pone.0111988-Wahlberg1" ref-type="bibr">[10]</xref>. As a sub-family of PARP, tankyrases also play an essential role in telomere length regulation <xref rid="pone.0111988-Wahlberg1" ref-type="bibr">[10]</xref>. Recently, a differential scanning fluorimetry (DSF) approach was adopted for rapid profiling of 185 known and potential PARP chemical compounds for their binding ability to 13 PRAP family proteins including two tankyrases, TNSK1 and TNSK2 <xref rid="pone.0111988-Wahlberg1" ref-type="bibr">[10]</xref>. We redrew the heatmap of thermal shifts measured by DSF for all 185 inhibitors against 13 PARP members (<xref ref-type="fig" rid="pone-0111988-g002">Figure 2B</xref>). Our results are consistent with the previous analysis, which demonstrated that most of inhibitors lack specificity and mainly target PARP1-4 as primary hits, while several compounds can efficiently inhibit both PARP1-4 and two tankyrases <xref rid="pone.0111988-Wahlberg1" ref-type="bibr">[10]</xref>.</p>
    <fig id="pone-0111988-g002" orientation="portrait" position="float">
      <object-id pub-id-type="doi">10.1371/journal.pone.0111988.g002</object-id>
      <label>Figure 2</label>
      <caption>
        <title>Illustrating heatmaps by HemI 1.0.</title>
        <p>(A) Thermal shifts, which indicate binding affinities of 185 compounds to 13 PARPs, were measured by DSF. A higher value represents a stronger binding affinity. (B) Totally, 428 androgen-repressed genes were identified from LNCaP cells, after the treatment of 1 nM synthetic androgen R1881 for 3, 6, 12, 24 and 48 hours. Values shown were normalized to 0 hour and log<sup>2</sup> transformed.</p>
      </caption>
      <graphic xlink:href="pone.0111988.g002"/>
    </fig>
    <p>Taken together, we propose that HemI 1.0 can be a useful tool for both experimentalists and bioinformaticians, and allow users to draw, manipulate and export publication-quality heatmaps in a user friendly manner. The software packages of HemI will be continuously maintained and improved upon users' comments and feedbacks.</p>
  </sec>
</body>
<back>
  <ack>
    <p>The authors thank Tianshun Gao and Yuangen Yao for their helpful discussions during the tool development. We also thank American Journal Experts for language editing.</p>
  </ack>
  <ref-list>
    <title>References</title>
    <ref id="pone.0111988-Koschmieder1">
      <label>1</label>
      <mixed-citation publication-type="journal"><name><surname>Koschmieder</surname><given-names>A</given-names></name>, <name><surname>Zimmermann</surname><given-names>K</given-names></name>, <name><surname>Trissl</surname><given-names>S</given-names></name>, <name><surname>Stoltmann</surname><given-names>T</given-names></name>, <name><surname>Leser</surname><given-names>U</given-names></name> (<year>2012</year>) <article-title>Tools for managing and analyzing microarray data</article-title>. <source>Brief Bioinform</source>
<volume>13</volume>: <fpage>46</fpage>–<lpage>60</lpage>.<pub-id pub-id-type="pmid">21422065</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0111988-Pabinger1">
      <label>2</label>
      <mixed-citation publication-type="journal"><name><surname>Pabinger</surname><given-names>S</given-names></name>, <name><surname>Dander</surname><given-names>A</given-names></name>, <name><surname>Fischer</surname><given-names>M</given-names></name>, <name><surname>Snajder</surname><given-names>R</given-names></name>, <name><surname>Sperk</surname><given-names>M</given-names></name>, <etal>et al</etal> (<year>2014</year>) <article-title>A survey of tools for variant analysis of next-generation genome sequencing data</article-title>. <source>Brief Bioinform</source>
<volume>15</volume>: <fpage>256</fpage>–<lpage>278</lpage>.<pub-id pub-id-type="pmid">23341494</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0111988-Collison1">
      <label>3</label>
      <mixed-citation publication-type="journal"><name><surname>Collison</surname><given-names>M</given-names></name>, <name><surname>Hirt</surname><given-names>RP</given-names></name>, <name><surname>Wipat</surname><given-names>A</given-names></name>, <name><surname>Nakjang</surname><given-names>S</given-names></name>, <name><surname>Sanseau</surname><given-names>P</given-names></name>, <etal>et al</etal> (<year>2012</year>) <article-title>Data mining the human gut microbiota for therapeutic targets</article-title>. <source>Brief Bioinform</source>
<volume>13</volume>: <fpage>751</fpage>–<lpage>768</lpage>.<pub-id pub-id-type="pmid">22445903</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0111988-Saldanha1">
      <label>4</label>
      <mixed-citation publication-type="journal"><name><surname>Saldanha</surname><given-names>AJ</given-names></name> (<year>2004</year>) <article-title>Java Treeview–extensible visualization of microarray data</article-title>. <source>Bioinformatics</source>
<volume>20</volume>: <fpage>3246</fpage>–<lpage>3248</lpage>.<pub-id pub-id-type="pmid">15180930</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0111988-Seo1">
      <label>5</label>
      <mixed-citation publication-type="journal"><name><surname>Seo</surname><given-names>J</given-names></name>, <name><surname>Gordish-Dressman</surname><given-names>H</given-names></name>, <name><surname>Hoffman</surname><given-names>EP</given-names></name> (<year>2006</year>) <article-title>An interactive power analysis tool for microarray hypothesis testing and generation</article-title>. <source>Bioinformatics</source>
<volume>22</volume>: <fpage>808</fpage>–<lpage>814</lpage>.<pub-id pub-id-type="pmid">16418236</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0111988-Battke1">
      <label>6</label>
      <mixed-citation publication-type="journal"><name><surname>Battke</surname><given-names>F</given-names></name>, <name><surname>Symons</surname><given-names>S</given-names></name>, <name><surname>Nieselt</surname><given-names>K</given-names></name> (<year>2010</year>) <article-title>Mayday–integrative analytics for expression data</article-title>. <source>BMC Bioinformatics</source>
<volume>11</volume>: <fpage>121</fpage>.<pub-id pub-id-type="pmid">20214778</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0111988-Chen1">
      <label>7</label>
      <mixed-citation publication-type="journal"><name><surname>Chen</surname><given-names>TJ</given-names></name>, <name><surname>Kotecha</surname><given-names>N</given-names></name> (<year>2014</year>) <article-title>Cytobank: providing an analytics platform for community cytometry data analysis and collaboration</article-title>. <source>Curr Top Microbiol Immunol</source>
<volume>377</volume>: <fpage>127</fpage>–<lpage>157</lpage>.<pub-id pub-id-type="pmid">24590675</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0111988-DeuPons1">
      <label>8</label>
      <mixed-citation publication-type="journal"><name><surname>Deu-Pons</surname><given-names>J</given-names></name>, <name><surname>Schroeder</surname><given-names>MP</given-names></name>, <name><surname>Lopez-Bigas</surname><given-names>N</given-names></name> (<year>2014</year>) <article-title>jHeatmap: an interactive heatmap viewer for the web</article-title>. <source>Bioinformatics</source>
<volume>30</volume>: <fpage>1757</fpage>–<lpage>1758</lpage>.<pub-id pub-id-type="pmid">24567544</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0111988-Zhao1">
      <label>9</label>
      <mixed-citation publication-type="journal"><name><surname>Zhao</surname><given-names>JC</given-names></name>, <name><surname>Yu</surname><given-names>J</given-names></name>, <name><surname>Runkle</surname><given-names>C</given-names></name>, <name><surname>Wu</surname><given-names>L</given-names></name>, <name><surname>Hu</surname><given-names>M</given-names></name>, <etal>et al</etal> (<year>2012</year>) <article-title>Cooperation between Polycomb and androgen receptor during oncogenic transformation</article-title>. <source>Genome Res</source>
<volume>22</volume>: <fpage>322</fpage>–<lpage>331</lpage>.<pub-id pub-id-type="pmid">22179855</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0111988-Wahlberg1">
      <label>10</label>
      <mixed-citation publication-type="journal"><name><surname>Wahlberg</surname><given-names>E</given-names></name>, <name><surname>Karlberg</surname><given-names>T</given-names></name>, <name><surname>Kouznetsova</surname><given-names>E</given-names></name>, <name><surname>Markova</surname><given-names>N</given-names></name>, <name><surname>Macchiarulo</surname><given-names>A</given-names></name>, <etal>et al</etal> (<year>2012</year>) <article-title>Family-wide chemical profiling and structural analysis of PARP and tankyrase inhibitors</article-title>. <source>Nat Biotechnol</source>
<volume>30</volume>: <fpage>283</fpage>–<lpage>288</lpage>.<pub-id pub-id-type="pmid">22343925</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
