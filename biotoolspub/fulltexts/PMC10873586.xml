<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.2 20190208//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.2?>
<?ConverterInfo.XSLTName jats2jats3.xsl?>
<?ConverterInfo.Version 1?>
<?properties open_access?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">Bioinformatics</journal-id>
    <journal-id journal-id-type="publisher-id">bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1367-4803</issn>
    <issn pub-type="epub">1367-4811</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">10873586</article-id>
    <article-id pub-id-type="pmid">38317054</article-id>
    <article-id pub-id-type="doi">10.1093/bioinformatics/btae063</article-id>
    <article-id pub-id-type="publisher-id">btae063</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Original Paper</subject>
        <subj-group subj-group-type="category-toc-heading">
          <subject>Gene Expression</subject>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="category-taxonomy-collection">
        <subject>AcademicSubjects/SCI01060</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>CTISL: a dynamic stacking multi-class classification approach for identifying cell types from single-cell RNA-seq data</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Wang</surname>
          <given-names>Xiao</given-names>
        </name>
        <role vocab="credit" vocab-identifier="https://credit.niso.org" vocab-term="Data curation" vocab-term-identifier="https://credit.niso.org/contributor-roles/data-curation" degree-contribution="lead">Data curation</role>
        <role vocab="credit" vocab-identifier="https://credit.niso.org" vocab-term="Formal analysis" vocab-term-identifier="https://credit.niso.org/contributor-roles/formal-analysis" degree-contribution="lead">Formal analysis</role>
        <role vocab="credit" vocab-identifier="https://credit.niso.org" vocab-term="Methodology" vocab-term-identifier="https://credit.niso.org/contributor-roles/methodology" degree-contribution="lead">Methodology</role>
        <role vocab="credit" vocab-identifier="https://credit.niso.org" vocab-term="Software" vocab-term-identifier="https://credit.niso.org/contributor-roles/software" degree-contribution="lead">Software</role>
        <role vocab="credit" vocab-identifier="https://credit.niso.org" vocab-term="Validation" vocab-term-identifier="https://credit.niso.org/contributor-roles/validation" degree-contribution="lead">Validation</role>
        <role vocab="credit" vocab-identifier="https://credit.niso.org" vocab-term="Visualization" vocab-term-identifier="https://credit.niso.org/contributor-roles/visualization" degree-contribution="lead">Visualization</role>
        <role vocab="credit" vocab-identifier="https://credit.niso.org" vocab-term="Writing - original draft" vocab-term-identifier="https://credit.niso.org/contributor-roles/writing-original-draft" degree-contribution="lead">Writing - original draft</role>
        <role vocab="credit" vocab-identifier="https://credit.niso.org" vocab-term="Writing - review &amp; editing" vocab-term-identifier="https://credit.niso.org/contributor-roles/writing-review-editing" degree-contribution="equal">Writing - review &amp; editing</role>
        <aff><institution>Department of Software Engineering, College of Information Engineering, Northwest A&amp;F University</institution>, Yangling 712100, <country country="CN">China</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Chai</surname>
          <given-names>Ziyi</given-names>
        </name>
        <role vocab="credit" vocab-identifier="https://credit.niso.org" vocab-term="Data curation" vocab-term-identifier="https://credit.niso.org/contributor-roles/data-curation" degree-contribution="supporting">Data curation</role>
        <role vocab="credit" vocab-identifier="https://credit.niso.org" vocab-term="Methodology" vocab-term-identifier="https://credit.niso.org/contributor-roles/methodology" degree-contribution="supporting">Methodology</role>
        <aff><institution>Department of Software Engineering, College of Information Engineering, Northwest A&amp;F University</institution>, Yangling 712100, <country country="CN">China</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Li</surname>
          <given-names>Shaohua</given-names>
        </name>
        <role vocab="credit" vocab-identifier="https://credit.niso.org" vocab-term="Data curation" vocab-term-identifier="https://credit.niso.org/contributor-roles/data-curation" degree-contribution="supporting">Data curation</role>
        <role vocab="credit" vocab-identifier="https://credit.niso.org" vocab-term="Methodology" vocab-term-identifier="https://credit.niso.org/contributor-roles/methodology" degree-contribution="supporting">Methodology</role>
        <aff><institution>Department of Software Engineering, College of Information Engineering, Northwest A&amp;F University</institution>, Yangling 712100, <country country="CN">China</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0002-5331-3655</contrib-id>
        <name>
          <surname>Liu</surname>
          <given-names>Yan</given-names>
        </name>
        <role vocab="credit" vocab-identifier="https://credit.niso.org" vocab-term="Methodology" vocab-term-identifier="https://credit.niso.org/contributor-roles/methodology" degree-contribution="supporting">Methodology</role>
        <role vocab="credit" vocab-identifier="https://credit.niso.org" vocab-term="Writing - review &amp; editing" vocab-term-identifier="https://credit.niso.org/contributor-roles/writing-review-editing" degree-contribution="supporting">Writing - review &amp; editing</role>
        <aff><institution>School of Computer Science and Engineering, Nanjing University of Science and Technology</institution>, Nanjing 210094, <country country="CN">China</country></aff>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0002-1847-754X</contrib-id>
        <name>
          <surname>Li</surname>
          <given-names>Chen</given-names>
        </name>
        <role vocab="credit" vocab-identifier="https://credit.niso.org" vocab-term="Conceptualization" vocab-term-identifier="https://credit.niso.org/contributor-roles/conceptualization" degree-contribution="equal">Conceptualization</role>
        <role vocab="credit" vocab-identifier="https://credit.niso.org" vocab-term="Investigation" vocab-term-identifier="https://credit.niso.org/contributor-roles/investigation" degree-contribution="equal">Investigation</role>
        <role vocab="credit" vocab-identifier="https://credit.niso.org" vocab-term="Supervision" vocab-term-identifier="https://credit.niso.org/contributor-roles/supervision" degree-contribution="equal">Supervision</role>
        <role vocab="credit" vocab-identifier="https://credit.niso.org" vocab-term="Visualization" vocab-term-identifier="https://credit.niso.org/contributor-roles/visualization" degree-contribution="lead">Visualization</role>
        <role vocab="credit" vocab-identifier="https://credit.niso.org" vocab-term="Writing - original draft" vocab-term-identifier="https://credit.niso.org/contributor-roles/writing-original-draft" degree-contribution="equal">Writing - original draft</role>
        <role vocab="credit" vocab-identifier="https://credit.niso.org" vocab-term="Writing - review &amp; editing" vocab-term-identifier="https://credit.niso.org/contributor-roles/writing-review-editing" degree-contribution="lead">Writing - review &amp; editing</role>
        <aff><institution>Department of Biochemistry and Molecular Biology, Monash University</institution>, Melbourne, VIC 3800, <country country="AU">Australia</country></aff>
        <xref rid="btae063-cor1" ref-type="corresp"/>
        <!--chen.li@monash.edu-->
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0003-4821-3585</contrib-id>
        <name>
          <surname>Jiang</surname>
          <given-names>Yu</given-names>
        </name>
        <role vocab="credit" vocab-identifier="https://credit.niso.org" vocab-term="Conceptualization" vocab-term-identifier="https://credit.niso.org/contributor-roles/conceptualization" degree-contribution="equal">Conceptualization</role>
        <role vocab="credit" vocab-identifier="https://credit.niso.org" vocab-term="Investigation" vocab-term-identifier="https://credit.niso.org/contributor-roles/investigation" degree-contribution="equal">Investigation</role>
        <role vocab="credit" vocab-identifier="https://credit.niso.org" vocab-term="Supervision" vocab-term-identifier="https://credit.niso.org/contributor-roles/supervision" degree-contribution="equal">Supervision</role>
        <role vocab="credit" vocab-identifier="https://credit.niso.org" vocab-term="Visualization" vocab-term-identifier="https://credit.niso.org/contributor-roles/visualization" degree-contribution="equal">Visualization</role>
        <role vocab="credit" vocab-identifier="https://credit.niso.org" vocab-term="Writing - review &amp; editing" vocab-term-identifier="https://credit.niso.org/contributor-roles/writing-review-editing" degree-contribution="equal">Writing - review &amp; editing</role>
        <aff><institution>Department of Animal Genetics, Breeding and Reproduction, College of Animal Science and Technology, Northwest A&amp;F University</institution>, Yangling 712100, <country country="CN">China</country></aff>
        <xref rid="btae063-cor3" ref-type="corresp"/>
        <!--yu.jiang@nwafu.edu.cn-->
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <name>
          <surname>Liu</surname>
          <given-names>Quanzhong</given-names>
        </name>
        <role vocab="credit" vocab-identifier="https://credit.niso.org" vocab-term="Conceptualization" vocab-term-identifier="https://credit.niso.org/contributor-roles/conceptualization" degree-contribution="lead">Conceptualization</role>
        <role vocab="credit" vocab-identifier="https://credit.niso.org" vocab-term="Funding acquisition" vocab-term-identifier="https://credit.niso.org/contributor-roles/funding-acquisition" degree-contribution="lead">Funding acquisition</role>
        <role vocab="credit" vocab-identifier="https://credit.niso.org" vocab-term="Investigation" vocab-term-identifier="https://credit.niso.org/contributor-roles/investigation" degree-contribution="lead">Investigation</role>
        <role vocab="credit" vocab-identifier="https://credit.niso.org" vocab-term="Supervision" vocab-term-identifier="https://credit.niso.org/contributor-roles/supervision" degree-contribution="lead">Supervision</role>
        <role vocab="credit" vocab-identifier="https://credit.niso.org" vocab-term="Visualization" vocab-term-identifier="https://credit.niso.org/contributor-roles/visualization" degree-contribution="supporting">Visualization</role>
        <role vocab="credit" vocab-identifier="https://credit.niso.org" vocab-term="Writing - original draft" vocab-term-identifier="https://credit.niso.org/contributor-roles/writing-original-draft" degree-contribution="equal">Writing - original draft</role>
        <role vocab="credit" vocab-identifier="https://credit.niso.org" vocab-term="Writing - review &amp; editing" vocab-term-identifier="https://credit.niso.org/contributor-roles/writing-review-editing" degree-contribution="equal">Writing - review &amp; editing</role>
        <aff><institution>Department of Software Engineering, College of Information Engineering, Northwest A&amp;F University</institution>, Yangling 712100, <country country="CN">China</country></aff>
        <aff><institution>Shaanxi Engineering Research Center of Agricultural Information Intelligent Perception and Analysis, Northwest A&amp;F University</institution>, Yangling 712100, <country country="CN">China</country></aff>
        <xref rid="btae063-cor2" ref-type="corresp"/>
        <!--liuqzhong@nwafu.edu.cn-->
      </contrib>
    </contrib-group>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Mathelier</surname>
          <given-names>Anthony</given-names>
        </name>
        <role>Associate Editor</role>
      </contrib>
    </contrib-group>
    <author-notes>
      <corresp id="btae063-cor1">Corresponding authors. Department of Biochemistry and Molecular Biology, Monash University, Melbourne, VIC 3800, Australia. E-mail <email>chen.li@monash.edu</email> (C.L.)</corresp>
      <corresp id="btae063-cor2">Department of Software Engineering, College of Information Engineering, Northwest A&amp;F University, Yangling 712100, China. E-mail: <email>liuqzhong@nwafu.edu.cn</email> (Q.L.)</corresp>
      <corresp id="btae063-cor3">Department of Animal Genetics, Breeding and Reproduction, College of Animal Science and Technology, Northwest A&amp;F University, Yangling 712100, China. E-mail: <email>yu.jiang@nwafu.edu.cn</email> (Y.J.)</corresp>
    </author-notes>
    <pub-date pub-type="collection">
      <month>2</month>
      <year>2024</year>
    </pub-date>
    <pub-date pub-type="epub" iso-8601-date="2024-02-05">
      <day>05</day>
      <month>2</month>
      <year>2024</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>05</day>
      <month>2</month>
      <year>2024</year>
    </pub-date>
    <volume>40</volume>
    <issue>2</issue>
    <elocation-id>btae063</elocation-id>
    <history>
      <date date-type="received">
        <day>15</day>
        <month>2</month>
        <year>2024</year>
      </date>
      <date date-type="rev-recd">
        <day>15</day>
        <month>2</month>
        <year>2024</year>
      </date>
      <date date-type="editorial-decision">
        <day>15</day>
        <month>2</month>
        <year>2024</year>
      </date>
      <date date-type="accepted">
        <day>15</day>
        <month>2</month>
        <year>2024</year>
      </date>
      <date date-type="corrected-typeset">
        <day>15</day>
        <month>2</month>
        <year>2024</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2024. Published by Oxford University Press.</copyright-statement>
      <copyright-year>2024</copyright-year>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">https://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted reuse, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <self-uri xlink:href="btae063.pdf"/>
    <abstract>
      <title>Abstract</title>
      <sec id="s1">
        <title>Motivation</title>
        <p>Effective identification of cell types is of critical importance in single-cell RNA-sequencing (scRNA-seq) data analysis. To date, many supervised machine learning-based predictors have been implemented to identify cell types from scRNA-seq datasets. Despite the technical advances of these state-of-the-art tools, most existing predictors were single classifiers, of which the performances can still be significantly improved. It is therefore highly desirable to employ the ensemble learning strategy to develop more accurate computational models for robust and comprehensive identification of cell types on scRNA-seq datasets.</p>
      </sec>
      <sec id="s2">
        <title>Results</title>
        <p>We propose a two-layer stacking model, termed CTISL (Cell Type Identification by Stacking ensemble Learning), which integrates multiple classifiers to identify cell types. In the first layer, given a reference scRNA-seq dataset with known cell types, CTISL dynamically combines multiple cell-type-specific classifiers (i.e. support-vector machine and logistic regression) as the base learners to deliver the outcomes for the input of a meta-classifier in the second layer. We conducted a total of 24 benchmarking experiments on 17 human and mouse scRNA-seq datasets to evaluate and compare the prediction performance of CTISL and other state-of-the-art predictors. The experiment results demonstrate that CTISL achieves superior or competitive performance compared to these state-of-the-art approaches. We anticipate that CTISL can serve as a useful and reliable tool for cost-effective identification of cell types from scRNA-seq datasets.</p>
      </sec>
      <sec id="s3">
        <title>Availability and implementation</title>
        <p>The webserver and source code are freely available at <ext-link xlink:href="http://bigdata.biocie.cn/CTISLweb/home" ext-link-type="uri">http://bigdata.biocie.cn/CTISLweb/home</ext-link> and <ext-link xlink:href="https://zenodo.org/records/10568906" ext-link-type="uri">https://zenodo.org/records/10568906</ext-link>, respectively.</p>
      </sec>
    </abstract>
    <funding-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>National Key Research and Development Program of China</institution>
            <institution-id institution-id-type="DOI">10.13039/501100012166</institution-id>
          </institution-wrap>
        </funding-source>
        <award-id>2022YFF1000100</award-id>
      </award-group>
    </funding-group>
    <counts>
      <page-count count="10"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec>
    <title>1 Introduction</title>
    <p>Single-cell RNA (scRNA)-seq techniques have been widely applied to profile transcriptomic data at the single-cell level (<xref rid="btae063-B55" ref-type="bibr">Tang <italic toggle="yes">et al.</italic> 2009</xref>). Identification of the cell types has therefore become a critical step in scRNA-seq data analysis (<xref rid="btae063-B26" ref-type="bibr">Huang and Zhang 2021</xref>). Traditionally, the types of cells were annotated based on their shapes, sizes, and other features observed via microscope anatomy, histology, and pathology (<xref rid="btae063-B5" ref-type="bibr">Arendt <italic toggle="yes">et al.</italic> 2016</xref>, <xref rid="btae063-B29" ref-type="bibr">Kiselev <italic toggle="yes">et al.</italic> 2019</xref>). The advances in scRNA-seq techniques have allowed the fast accumulation of sequencing data, which requires the assistance of computational and artificial intelligence-guided approaches for the accurate and robust annotation of cell types (<xref rid="btae063-B39" ref-type="bibr">Ma <italic toggle="yes">et al.</italic> 2021</xref>, <xref rid="btae063-B54" ref-type="bibr">Sun <italic toggle="yes">et al.</italic> 2022</xref>). Particularly, machine learning (ML)-based approaches have shown their great capability of handling large-scale datasets for annotating cell types. In recent years, various ML-based approaches have been developed to annotate cell types using scRNA-seq datasets. These methods can be broadly classified into two main categories: unsupervised and supervised approaches.</p>
    <p>Unsupervised methods, such as RaceID (<xref rid="btae063-B22" ref-type="bibr">Grün <italic toggle="yes">et al.</italic> 2015</xref>), SNN-Cliq (<xref rid="btae063-B62" ref-type="bibr">Xu and Su 2015</xref>), SINCERA (<xref rid="btae063-B23" ref-type="bibr">Guo <italic toggle="yes">et al.</italic> 2015</xref>), pcaReduce (<xref rid="btae063-B70" ref-type="bibr">Žurauskienė and Yau 2016</xref>), GiniClust (<xref rid="btae063-B28" ref-type="bibr">Jiang <italic toggle="yes">et al.</italic> 2016</xref>), SIMLR (<xref rid="btae063-B57" ref-type="bibr">Wang <italic toggle="yes">et al.</italic> 2017</xref>), SC3 (<xref rid="btae063-B30" ref-type="bibr">Kiselev <italic toggle="yes">et al.</italic> 2017</xref>), SCENIC (<xref rid="btae063-B2" ref-type="bibr">Aibar <italic toggle="yes">et al.</italic> 2017</xref>), Scanpy (<xref rid="btae063-B60" ref-type="bibr">Wolf <italic toggle="yes">et al.</italic> 2018</xref>), and SCENA (<xref rid="btae063-B14" ref-type="bibr">Cui <italic toggle="yes">et al.</italic> 2021</xref>), cluster cells into different groups using various methods, e.g. <italic toggle="yes">K</italic>-means (<xref rid="btae063-B10" ref-type="bibr">Celebi <italic toggle="yes">et al.</italic> 2013</xref>), Shared Nearest Neighbor (<xref rid="btae063-B18" ref-type="bibr">Ertoz <italic toggle="yes">et al.</italic> 2002</xref>), and cluster-based similarity partitioning algorithm (<xref rid="btae063-B53" ref-type="bibr">Strehl and Ghosh 2003</xref>). Although unsupervised clustering-based methods achieved outstanding performances in annotating cell types, many challenges remain (<xref rid="btae063-B29" ref-type="bibr">Kiselev <italic toggle="yes">et al.</italic> 2019</xref>), such as the ambiguous number of cell-type clusters (<xref rid="btae063-B46" ref-type="bibr">Qi <italic toggle="yes">et al.</italic> 2020</xref>), model and parameter dependency (<xref rid="btae063-B61" ref-type="bibr">Xie <italic toggle="yes">et al.</italic> 2019</xref>), unsatisfactory performance on imbalanced clusters (<xref rid="btae063-B39" ref-type="bibr">Ma <italic toggle="yes">et al.</italic> 2021</xref>), and poor reproducibility (<xref rid="btae063-B11" ref-type="bibr">Chen <italic toggle="yes">et al.</italic> 2022</xref>). Moreover, unsupervised methods are usually constructed based on the assumption that all cells in each cluster belong to the same cell type. In fact, a cluster is often mixed with a major cell type and small percentages of other cell types (<xref rid="btae063-B3" ref-type="bibr">Alquicira-Hernandez <italic toggle="yes">et al.</italic> 2019</xref>), which makes it challenging to effectively annotate cell types in such clusters (<xref rid="btae063-B29" ref-type="bibr">Kiselev <italic toggle="yes">et al.</italic> 2019</xref>, <xref rid="btae063-B44" ref-type="bibr">Pliner <italic toggle="yes">et al.</italic> 2019</xref>).</p>
    <p>Supervised ML-based methods, on the other hand, have been increasingly popular in recent years (<xref rid="btae063-B39" ref-type="bibr">Ma <italic toggle="yes">et al.</italic> 2021</xref>). These supervised methods can be further classified into two categories: traditional ML- and deep learning (DL)-based approaches. Traditional ML-based approaches, such as scPred (<xref rid="btae063-B3" ref-type="bibr">Alquicira-Hernandez <italic toggle="yes">et al.</italic> 2019</xref>), scClassify (<xref rid="btae063-B35" ref-type="bibr">Lin <italic toggle="yes">et al.</italic> 2020</xref>), ELSA (<xref rid="btae063-B58" ref-type="bibr">Wang <italic toggle="yes">et al.</italic> 2020</xref>a), scDetect (<xref rid="btae063-B52" ref-type="bibr">Shen <italic toggle="yes">et al.</italic> 2021</xref>), CellTypist (<xref rid="btae063-B17" ref-type="bibr">Domínguez Conde <italic toggle="yes">et al.</italic> 2022</xref>), scmap (<xref rid="btae063-B31" ref-type="bibr">Kiselev <italic toggle="yes">et al.</italic> 2018</xref>), SingleR (<xref rid="btae063-B4" ref-type="bibr">Aran <italic toggle="yes">et al.</italic> 2019</xref>), and scAnnotatR (<xref rid="btae063-B42" ref-type="bibr">Nguyen and Griss 2022</xref>), often employ classic ML models, such as Support-Vector Machines (SVM) (<xref rid="btae063-B12" ref-type="bibr">Cortes and Vapnik 1995</xref>), <italic toggle="yes">K</italic>-Nearest Neighbors (<xref rid="btae063-B13" ref-type="bibr">Cover and Hart 1967</xref>), Random Forest (RF) (<xref rid="btae063-B8" ref-type="bibr">Breiman 2001</xref>), Logistic Regression (LR) (<xref rid="btae063-B41" ref-type="bibr">Lecessie and van Houwelingen 1992</xref>), and Bootstrap (<xref rid="btae063-B21" ref-type="bibr">Fushiki 2010</xref>), etc. While DL-based approaches employ state-of-the-art neural network-based algorithms, including Artificial Neural Networks (<xref rid="btae063-B65" ref-type="bibr">Yang 2008</xref>), Convolutional Neural Networks (<xref rid="btae063-B63" ref-type="bibr">Yamashita <italic toggle="yes">et al.</italic> 2018</xref>), Deep Neural Networks (<xref rid="btae063-B50" ref-type="bibr">Samek <italic toggle="yes">et al.</italic> 2021</xref>), Capsule Neural Networks (<xref rid="btae063-B49" ref-type="bibr">Sabour <italic toggle="yes">et al.</italic> 2017</xref>), and Graph Neural Networks (<xref rid="btae063-B68" ref-type="bibr">Zhou <italic toggle="yes">et al.</italic> 2020</xref>), to achieve superior annotation performance. Representative DL-based approaches include SuperCT (<xref rid="btae063-B61" ref-type="bibr">Xie <italic toggle="yes">et al.</italic> 2019</xref>), ACTINN (<xref rid="btae063-B38" ref-type="bibr">Ma and Pellegrini 2020</xref>), scCapsNet (<xref rid="btae063-B58" ref-type="bibr">Wang <italic toggle="yes">et al.</italic> 2020</xref>b), scGraph (<xref rid="btae063-B66" ref-type="bibr">Yin <italic toggle="yes">et al.</italic> 2022</xref>), GraphCS (<xref rid="btae063-B67" ref-type="bibr">Zeng <italic toggle="yes">et al.</italic> 2022</xref>), TripletCell (<xref rid="btae063-B36" ref-type="bibr">Liu <italic toggle="yes">et al.</italic> 2023</xref>), scBERT (<xref rid="btae063-B64" ref-type="bibr">Yang <italic toggle="yes">et al.</italic> 2022</xref>), and scDeepInsight (<xref rid="btae063-B27" ref-type="bibr">Jia <italic toggle="yes">et al.</italic> 2023</xref>).</p>
    <p>Some comprehensive reviews have thoroughly evaluated a number of supervised models for the identification of cell types (<xref rid="btae063-B1" ref-type="bibr">Abdelaal <italic toggle="yes">et al.</italic> 2019</xref>, <xref rid="btae063-B26" ref-type="bibr">Huang and Zhang 2021</xref>, <xref rid="btae063-B39" ref-type="bibr">Ma <italic toggle="yes">et al.</italic> 2021</xref>). Most supervised-based methods first used a scRNA-seq dataset with known cell types to train a multi-class classification model and then loaded the trained model to predict the type of each cell in a new scRNA-seq dataset. Despite that supervised methods generally outperform unsupervised cell clustering methods (<xref rid="btae063-B39" ref-type="bibr">Ma <italic toggle="yes">et al.</italic> 2021</xref>), most of these supervised methods are based on a single classifier. On the other hand, it has been widely accepted that ensemble multiple classifiers usually outperform the performance of a single learner (<xref rid="btae063-B69" ref-type="bibr">Zhou 2012</xref>). For example, scDetect (<xref rid="btae063-B52" ref-type="bibr">Shen <italic toggle="yes">et al.</italic> 2021</xref>) achieved outstanding cell-type identification performance by implementing multiple <italic toggle="yes">k</italic>-Top Scoring Pairs classifiers with a weighted majority voting strategy to identify cell types from scRNA-seq data.</p>
    <p>In this study, we developed a two-layer dynamic ensemble learning model, termed CTISL (Cell Type Identification by Stacking ensemble Learning), for accurate cell-type prediction in scRNA-seq data. In CTISL, cell-type identification is regarded as a multi-class classification task. A variety of features were extracted to build multiple base learners for different cell-type categories. We selected the best-performing classifiers as base learners in CTISL according to our extensive experiments and a recent study evaluating the performance of various individual classifiers in cell-type identification using scRNA-seq datasets (<xref rid="btae063-B26" ref-type="bibr">Huang and Zhang 2021</xref>). Our extensive performance benchmarking experiments on scRNA-seq datasets of various species, tissues, batches, and protocols show that CTISL achieved outstanding performance and strong stability compared to state-of-the-art traditional ML and DL methods, demonstrating that the stacking ensemble learning technique is an effective approach to achieving more robust performance for cell-type annotation. Overall, our dynamic ensemble learning model provides a promising approach for accurately identifying cell types in scRNA-seq datasets, with the potential to advance biomedical research and clinical applications.</p>
  </sec>
  <sec>
    <title>2 Materials and methods</title>
    <sec>
      <title>2.1 Dataset collection</title>
      <p>We collected in total 17 scRNA-seq datasets of two species (<italic toggle="yes">Homo sapiens</italic> and <italic toggle="yes">Mus musculus</italic>) from various tissues, batches, and protocols to train and evaluate CTISL and other benchmarked methods. Among these datasets, seven are derived from human peripheral blood mononuclear cell (PBMC) samples (<xref rid="btae063-B16" ref-type="bibr">Ding <italic toggle="yes">et al.</italic> 2020</xref>) and were used for inter- and intra-dataset evaluations. Several pairs of datasets with different batches were extracted from various cells, including human blood dendritic cells (<xref rid="btae063-B56" ref-type="bibr">Villani <italic toggle="yes">et al.</italic> 2017</xref>), namely Dendritic_batch1 and Dendritic_batch2, and mouse retinal bipolar cells (<xref rid="btae063-B51" ref-type="bibr">Shekhar <italic toggle="yes">et al.</italic> 2016</xref>), namely Retina(5)_batch1 and Retina(5)_batch2, and Retina(19)_batch1 and Retina(19)_batch2. Each of the three pairs was used for cross-batch evaluations. In addition, two datasets from human and mouse airway (<xref rid="btae063-B43" ref-type="bibr">Plasschaert <italic toggle="yes">et al.</italic> 2018</xref>) and pancreas (<xref rid="btae063-B6" ref-type="bibr">Baron <italic toggle="yes">et al.</italic> 2016</xref>) were extracted, namely “HumanAirway,” “MouseAirway,” “HumanPancreas,” and “MousePancreas,” respectively. Each pair of datasets is from the same tissue of two species and was used for cross-species evaluations. A detailed description of these 17 scRNA-seq datasets is provided in <xref rid="sup1" ref-type="supplementary-material">Supplementary Table S1</xref>.</p>
    </sec>
    <sec>
      <title>2.2 The CTISL framework</title>
      <p>As illustrated in <xref rid="btae063-F1" ref-type="fig">Fig. 1</xref>, the construction of CTISL consists of four steps: dataset pre-processing, feature selection, stacking model construction, and model evaluation.</p>
      <fig position="float" id="btae063-F1">
        <label>Figure 1.</label>
        <caption>
          <p>The construction of the CTISL framework includes four major steps, including (A) dataset pre-processing, (B) feature selection, (C) dynamic stacking model construction, and (D) model evaluation.</p>
        </caption>
        <graphic xlink:href="btae063f1" position="float"/>
      </fig>
      <p><bold>Step 1. Dataset pre-processing:</bold> We employed the Scanpy package (<xref rid="btae063-B60" ref-type="bibr">Wolf <italic toggle="yes">et al.</italic> 2018</xref>) to perform scRNA-seq data pre-processing (<xref rid="btae063-F1" ref-type="fig">Fig. 1A</xref>). In the cell normalization step, the expression value of each gene in each cell was divided by the total sum of gene expression values in that cell and then multiplied by a constant 10e4. Other pre-processing steps remain consistent with the previous study (<xref rid="btae063-B25" ref-type="bibr">Hu <italic toggle="yes">et al.</italic> 2020</xref>). Note that the dataset pre-processing step is performed separately for training and testing datasets.</p>
      <p><bold>Step 2. Feature selection:</bold> A scRNA-seq dataset <inline-formula id="IE1"><mml:math id="IM1" display="inline" overflow="scroll"><mml:mi mathvariant="normal">D</mml:mi></mml:math></inline-formula> can be represented as an <inline-formula id="IE2"><mml:math id="IM2" display="inline" overflow="scroll"><mml:mi>n</mml:mi><mml:mo>×</mml:mo><mml:mi>m</mml:mi></mml:math></inline-formula> matrix, where <inline-formula id="IE3"><mml:math id="IM3" display="inline" overflow="scroll"><mml:mi>n</mml:mi></mml:math></inline-formula> and <inline-formula id="IE4"><mml:math id="IM4" display="inline" overflow="scroll"><mml:mi>m</mml:mi></mml:math></inline-formula> are the numbers of cells and genes, respectively. <inline-formula id="IE5"><mml:math id="IM5" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>D</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mfenced open="(" close=")" separators="|"><mml:mrow><mml:mn>1</mml:mn><mml:mo>≤</mml:mo><mml:mi>i</mml:mi><mml:mo>≤</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:mfenced></mml:math></inline-formula> represents the <italic toggle="yes">i</italic>-th cell, and <inline-formula id="IE6"><mml:math id="IM6" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>D</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mfenced open="(" close=")" separators="|"><mml:mrow><mml:mn>1</mml:mn><mml:mo>≤</mml:mo><mml:mi>i</mml:mi><mml:mo>≤</mml:mo><mml:mi>n</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="normal"> </mml:mi><mml:mn>1</mml:mn><mml:mo>≤</mml:mo><mml:mi>j</mml:mi><mml:mo>≤</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:mfenced></mml:math></inline-formula> denotes the expression value of the <inline-formula id="IE7"><mml:math id="IM7" display="inline" overflow="scroll"><mml:mi>j</mml:mi></mml:math></inline-formula>-th gene in <inline-formula id="IE8"><mml:math id="IM8" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>D</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula>. As there is usually more than one cell type in <inline-formula id="IE9"><mml:math id="IM9" display="inline" overflow="scroll"><mml:mi>D</mml:mi></mml:math></inline-formula>, cell-type identification is formulated as a multi-class classification task. Generally, <inline-formula id="IE10"><mml:math id="IM10" display="inline" overflow="scroll"><mml:mi>D</mml:mi></mml:math></inline-formula> contains high-dimensional features (genes) and small size of samples (cells). The high number of redundant genes might decrease the predictive performance of the model. To find a better gene subset for identifying cell types, we employed χ<sup>2</sup> (<xref rid="btae063-B19" ref-type="bibr">Forman 2003</xref>), a popular feature selection method, to select the genes related to cell types. Suppose <inline-formula id="IE11"><mml:math id="IM11" display="inline" overflow="scroll"><mml:mi>D</mml:mi></mml:math></inline-formula> contains <italic toggle="yes">t</italic> cell types, and<inline-formula id="IE12"><mml:math id="IM12" display="inline" overflow="scroll"><mml:mi mathvariant="normal"> </mml:mi><mml:mi>C</mml:mi></mml:math></inline-formula> represents the set of cell types, the procedure of feature selection (<xref rid="btae063-F1" ref-type="fig">Fig. 1B</xref>) is described as follows: (i) a dataset <inline-formula id="IE13"><mml:math id="IM13" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:mi>D</mml:mi></mml:mrow><mml:mrow><mml:mi>′</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> with two classes was constructed for each cell type <inline-formula id="IE14"><mml:math id="IM14" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mi mathvariant="normal"> </mml:mi><mml:mfenced open="(" close=")" separators="|"><mml:mrow><mml:mn>1</mml:mn><mml:mo>≤</mml:mo><mml:mi>k</mml:mi><mml:mo>≤</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:mfenced></mml:math></inline-formula>—samples with the cell type of <inline-formula id="IE15"><mml:math id="IM15" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> are regarded as the positive class of <inline-formula id="IE16"><mml:math id="IM16" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:mi>D</mml:mi></mml:mrow><mml:mrow><mml:mi>′</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula>, and remaining samples as the negative class; and (ii) χ<sup>2</sup> was employed to select the top 300 genes with stronger identification ability of <inline-formula id="IE17"><mml:math id="IM17" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula>, and let <inline-formula id="IE18"><mml:math id="IM18" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> denote the set of these 300 genes. We then repeated the above two steps until each <inline-formula id="IE19"><mml:math id="IM19" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mfenced open="(" close=")" separators="|"><mml:mrow><mml:mn>1</mml:mn><mml:mo>≤</mml:mo><mml:mi>k</mml:mi><mml:mo>≤</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:mfenced></mml:math></inline-formula> was obtained as informative genes for the cell type of <inline-formula id="IE20"><mml:math id="IM20" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula>.</p>
      <p><bold>Step 3. Stacking model construction:</bold> Among traditional ML-based methods, SVM with the radial basis function (RBF) or linear kernel, and LR classifiers achieved generally better performances than other classifiers in annotating cell types (<xref rid="btae063-B1" ref-type="bibr">Abdelaal <italic toggle="yes">et al.</italic> 2019</xref>, <xref rid="btae063-B3" ref-type="bibr">Alquicira-Hernandez <italic toggle="yes">et al.</italic> 2019</xref>, <xref rid="btae063-B26" ref-type="bibr">Huang and Zhang 2021</xref>, <xref rid="btae063-B39" ref-type="bibr">Ma <italic toggle="yes">et al.</italic> 2021</xref>). In this work, we employed the stacking strategy (<xref rid="btae063-B69" ref-type="bibr">Zhou 2012</xref>) to integrate SVM and LR classifiers as individual base learners. It has been demonstrated that the stacking approach can achieve powerful performance in various bioinformatic tasks, such as anti-cancer peptide identification (<xref rid="btae063-B34" ref-type="bibr">Liang <italic toggle="yes">et al.</italic> 2021</xref>), prokaryotic lysine acetylation site prediction (<xref rid="btae063-B7" ref-type="bibr">Basith <italic toggle="yes">et al.</italic> 2022</xref>), and long ncRNA subcellular localization prediction (<xref rid="btae063-B9" ref-type="bibr">Cao <italic toggle="yes">et al.</italic> 2018</xref>). In addition, to conduct a more comprehensive study, we integrated another two base learners, including RF (<xref rid="btae063-B8" ref-type="bibr">Breiman 2001</xref>) and gradient boosting classifier (GBC) (<xref rid="btae063-B20" ref-type="bibr">Friedman 2001</xref>). We also built other variations for our CTISL framework, including χ<sup>2</sup> with multilayer perceptron (<xref rid="btae063-B45" ref-type="bibr">Popescu <italic toggle="yes">et al.</italic> 2009</xref>) (χ<sup>2</sup>+MLP) and CTISL with marker genes. Refer to <xref rid="sup1" ref-type="supplementary-material">Supplementary Section S1</xref> for more information. In this work, we constructed two layers of stacking ensemble models. The first layer combines SVM and LR as the base classifiers via the stacking strategy and the second level employs LR as the meta-classifier fed by the outputs of the stacking layer. Details of the procedure are described as follows (<xref rid="btae063-F1" ref-type="fig">Fig. 1C</xref>). In the first step, given a scRNA-seq dataset <inline-formula id="IE21"><mml:math id="IM21" display="inline" overflow="scroll"><mml:mi>D</mml:mi></mml:math></inline-formula> with <inline-formula id="IE22"><mml:math id="IM22" display="inline" overflow="scroll"><mml:mi>n</mml:mi></mml:math></inline-formula> cells and the set <inline-formula id="IE23"><mml:math id="IM23" display="inline" overflow="scroll"><mml:mi>C</mml:mi></mml:math></inline-formula> with <italic toggle="yes">t</italic> kinds of cell types, we obtained a set of informative genes <inline-formula id="IE24"><mml:math id="IM24" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mfenced open="(" close=")" separators="|"><mml:mrow><mml:mn>1</mml:mn><mml:mo>≤</mml:mo><mml:mi>k</mml:mi><mml:mo>≤</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:mfenced><mml:mi mathvariant="normal"> </mml:mi></mml:math></inline-formula>for the cell type of <inline-formula id="IE25"><mml:math id="IM25" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mfenced open="(" close=")" separators="|"><mml:mrow><mml:mn>1</mml:mn><mml:mo>≤</mml:mo><mml:mi>k</mml:mi><mml:mo>≤</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:mfenced><mml:mi mathvariant="normal"> </mml:mi></mml:math></inline-formula>using the proposed feature selection strategy. Subsequently, we extracted these gene columns in <inline-formula id="IE26"><mml:math id="IM26" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> and removed other genes from <inline-formula id="IE27"><mml:math id="IM27" display="inline" overflow="scroll"><mml:mi>D</mml:mi></mml:math></inline-formula> to form a sub-dataset <inline-formula id="IE28"><mml:math id="IM28" display="inline" overflow="scroll"><mml:mi>D</mml:mi><mml:mfenced open="(" close=")" separators="|"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:mfenced></mml:math></inline-formula>. In the second step, to avoid overfitting, we implemented our ensemble strategy using the stacking cross-validation algorithm provided in the “mlxtend” package (<xref rid="btae063-B47" ref-type="bibr">Raschka 2018</xref>). In this procedure, <inline-formula id="IE29"><mml:math id="IM29" display="inline" overflow="scroll"><mml:mi>D</mml:mi><mml:mfenced open="(" close=")" separators="|"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:mfenced><mml:mi mathvariant="normal"> </mml:mi></mml:math></inline-formula>was first split into 3-folds. The first-level classifier SVM with RBF kernel was trained on the 2-folds, and prediction results (<inline-formula id="IE30"><mml:math id="IM30" display="inline" overflow="scroll"><mml:mi>t</mml:mi></mml:math></inline-formula> probability values) on the remaining fold as new features of the fold. After three rounds, <inline-formula id="IE31"><mml:math id="IM31" display="inline" overflow="scroll"><mml:mi>D</mml:mi><mml:mfenced open="(" close=")" separators="|"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:mfenced><mml:mi mathvariant="normal"> </mml:mi></mml:math></inline-formula>was transformed into a new dataset <inline-formula id="IE32"><mml:math id="IM32" display="inline" overflow="scroll"><mml:mi>D</mml:mi><mml:mi mathvariant="normal">'</mml:mi><mml:mfenced open="(" close=")" separators="|"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:mfenced><mml:mi mathvariant="normal"> </mml:mi></mml:math></inline-formula>with <inline-formula id="IE33"><mml:math id="IM33" display="inline" overflow="scroll"><mml:mi>t</mml:mi></mml:math></inline-formula> features. The same procedure was used to fit the first layer LR classifier. Thus, <inline-formula id="IE34"><mml:math id="IM34" display="inline" overflow="scroll"><mml:mi>D</mml:mi><mml:mfenced open="(" close=")" separators="|"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:mfenced><mml:mi mathvariant="normal"> </mml:mi></mml:math></inline-formula>was transformed into a new dataset <inline-formula id="IE35"><mml:math id="IM35" display="inline" overflow="scroll"><mml:mi>D</mml:mi><mml:mi mathvariant="normal">'</mml:mi><mml:mfenced open="(" close=")" separators="|"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:mfenced><mml:mi mathvariant="normal"> </mml:mi></mml:math></inline-formula>with <inline-formula id="IE36"><mml:math id="IM36" display="inline" overflow="scroll"><mml:mn>2</mml:mn><mml:mi>t</mml:mi></mml:math></inline-formula> features through the first layer classifiers. After repeating the above two steps for each <inline-formula id="IE37"><mml:math id="IM37" display="inline" overflow="scroll"><mml:mi>D</mml:mi><mml:mfenced open="(" close=")" separators="|"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:mfenced><mml:mo>,</mml:mo><mml:mfenced open="(" close=")" separators="|"><mml:mrow><mml:mn>1</mml:mn><mml:mo>≤</mml:mo><mml:mi>k</mml:mi><mml:mo>≤</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:mfenced></mml:math></inline-formula>, <inline-formula id="IE38"><mml:math id="IM38" display="inline" overflow="scroll"><mml:mi>D</mml:mi></mml:math></inline-formula> was transformed into a new dataset <inline-formula id="IE39"><mml:math id="IM39" display="inline" overflow="scroll"><mml:mi>D</mml:mi><mml:mi mathvariant="normal">′</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:msubsup><mml:mi>U</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msubsup></mml:mrow><mml:mrow><mml:mo> </mml:mo><mml:mi>D</mml:mi><mml:mi mathvariant="normal">'</mml:mi><mml:mfenced open="(" close=")" separators="|"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:mfenced></mml:mrow></mml:mrow></mml:math></inline-formula>, where <inline-formula id="IE40"><mml:math id="IM40" display="inline" overflow="scroll"><mml:mi>D</mml:mi><mml:mi mathvariant="normal">'</mml:mi></mml:math></inline-formula> is an <inline-formula id="IE41"><mml:math id="IM41" display="inline" overflow="scroll"><mml:mi>n</mml:mi><mml:mo>×</mml:mo><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>×</mml:mo><mml:mn>2</mml:mn><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:math></inline-formula> matrix. Finally, <inline-formula id="IE42"><mml:math id="IM42" display="inline" overflow="scroll"><mml:mi>D</mml:mi><mml:mi mathvariant="normal">'</mml:mi></mml:math></inline-formula> was fed into the second layer classifier LR. Note that as the numbers of cell types vary across different scRNA-seq datasets, CTISL dynamically combines different numbers of base classifiers (i.e. SVM and LR) on different scRNA-seq training datasets.</p>
      <p><bold>Step 4. Model evaluation:</bold> To effectively evaluate and compare the performance of CTISL and other state-of-the-art approaches, we used four evaluation strategies including intra-dataset, inter-dataset, cross-batch, and cross-species evaluation (<xref rid="btae063-F1" ref-type="fig">Fig. 1D</xref>). For intra-dataset validation, we used the 5-fold cross-validation on seven PBMCs of <italic toggle="yes">H.sapiens</italic>. Five-folds were stratified to preserve the ratios of samples/cells for each cell type. When validating the inter-dataset performance, we used seven human PBMC datasets, which were generated by seven different protocols (i.e. 10Xv2, 10Xv3, CEL-Seq2, Drop-Seq, inDrop, SMART-Seq2, and SeqWell, respectively). To maximize the use of the existing datasets, we conducted seven inter-group experiments, with each experiment using one dataset as the testing set and the remaining six datasets for training. For cross-batch validation, we used three datasets, Dendritic, Retina(5), and Retina(19). For each dataset, we conducted experiments with one batch for training and the other one for testing. In total, we conducted six cross-batch experiments. To assess the cross-species performance, we conducted experiments on a pair of datasets, which were obtained from the same tissue of two different species by the same protocol. The model was trained on one dataset of original species and predicted cell types in another dataset of target species, and <italic toggle="yes">vice versa</italic>. In this work, we used two datasets generated by the inDrop protocol from the pancreas tissues of <italic toggle="yes">H.sapiens</italic> and <italic toggle="yes">M.musculus</italic> and two datasets generated by the inDrop protocol from the airway tissues of <italic toggle="yes">H.sapiens</italic> and <italic toggle="yes">M.musculus</italic>.</p>
    </sec>
    <sec>
      <title>2.3 Benchmarking against state-of-the-art ML-based cell-type prediction methods</title>
      <p>In our benchmark experiments, we compared CTISL with nine state-of-the-art ML-based methods including ACTINN (<xref rid="btae063-B38" ref-type="bibr">Ma and Pellegrini 2020</xref>) scCapsNet (<xref rid="btae063-B58" ref-type="bibr">Wang <italic toggle="yes">et al.</italic> 2020b</xref>), scDetect (<xref rid="btae063-B52" ref-type="bibr">Shen <italic toggle="yes">et al.</italic> 2021</xref>), TripletCell (<xref rid="btae063-B36" ref-type="bibr">Liu <italic toggle="yes">et al.</italic> 2023</xref>), scmap-cluster (<xref rid="btae063-B31" ref-type="bibr">Kiselev <italic toggle="yes">et al.</italic> 2018</xref>), scmap-cell (<xref rid="btae063-B31" ref-type="bibr">Kiselev <italic toggle="yes">et al.</italic> 2018</xref>), CellTypist (<xref rid="btae063-B17" ref-type="bibr">Domínguez Conde <italic toggle="yes">et al.</italic> 2022</xref>), scBERT (<xref rid="btae063-B64" ref-type="bibr">Yang <italic toggle="yes">et al.</italic> 2022</xref>), and SingleR (<xref rid="btae063-B4" ref-type="bibr">Aran <italic toggle="yes">et al.</italic> 2019</xref>). For ACTINN, scDetect, TripletCell, scmap-cluster, scmap-cell, CellTypist, scBERT, and SingleR, we used the pre-processing methods provided in their studies to process the original data and used the processed data as input for these models. While for scCapsNet, we used the method in this study to pre-process the data. All compared methods were trained and tested using the same training and testing datasets to ensure a fair comparison. We employed three popular performance evaluation metrics, including accuracy, median <italic toggle="yes">F</italic>1-score, and macro <italic toggle="yes">F</italic>1-score (<xref rid="sup1" ref-type="supplementary-material">Supplementary Section S2</xref>) to evaluate and compare the predictive performance of CTISL with state-of-the-art approaches. Accuracy is defined as the percentage of correctly predicted cell type among all cells. Median <italic toggle="yes">F</italic>1-score is defined as the median value of <italic toggle="yes">F</italic>1-scores of all cell types and macro <italic toggle="yes">F</italic>1-score denotes the average of <italic toggle="yes">F</italic>1-scores of all cell types. Therefore, macro <italic toggle="yes">F</italic>1-score is suitable for scRNA-seq data with highly imbalanced proportions of cell types (<xref rid="btae063-B39" ref-type="bibr">Ma <italic toggle="yes">et al.</italic> 2021</xref>).</p>
    </sec>
  </sec>
  <sec>
    <title>3 Results</title>
    <sec>
      <title>3.1 Performance evaluation on selected feature genes</title>
      <p>Most feature gene selection algorithms were designed to choose highly variable genes (HVGs). However, cell-type identification is a multi-class classification task and HVGs might not be related to cell types. This section therefore aimed to evaluate the performance of the base classifiers on different feature gene sets, including feature genes selected by various methods and HVGs. The feature gene selection methods, we evaluated in this study include the χ<sup>2</sup> method, limma (<xref rid="btae063-B48" ref-type="bibr">Ritchie <italic toggle="yes">et al.</italic> 2015</xref>), and GeneClust (<xref rid="btae063-B15" ref-type="bibr">Deng <italic toggle="yes">et al.</italic> 2023</xref>). While the χ<sup>2</sup> method and limma can select feature genes for each cell type, GeneClust selects a subset of highly representative genes that are relevant to each cluster. For each cell type, we used the χ<sup>2</sup> algorithm and limma to select the top <italic toggle="yes">k</italic> (<italic toggle="yes">k</italic> = 100, 200, 300, 400, and 500) genes that are related to cell types. Thus, for scRNA-seq with <italic toggle="yes">t</italic> cell types, <inline-formula id="IE43"><mml:math id="IM43" display="inline" overflow="scroll"><mml:mi>t</mml:mi><mml:mo>×</mml:mo><mml:mi>k</mml:mi><mml:mi mathvariant="normal"> </mml:mi></mml:math></inline-formula>genes were chosen as features. To evaluate the performance of genes selected by our proposed feature selection method, we compared the selected genes in our work with 2000, 3000, 4000, and 5000 highly variable genes, respectively. We trained our base classifiers on seven human scRNA-seq datasets using the selected genes via a 5-fold cross-validation test—the feature genes were selected using the 4-folds and the performance was tested using the rest fold. Performance comparison between SVM and LR using 300 χ<sup>2</sup>-selected genes and 5000 HVGs is shown in <xref rid="btae063-F2" ref-type="fig">Fig. 2A and B</xref>, respectively. Detailed performance values of all the numbers of selected genes and feature gene selection methods are shown in <xref rid="sup1" ref-type="supplementary-material">Supplementary Tables S2</xref> and <xref rid="sup1" ref-type="supplementary-material">S3</xref>, respectively. From the average accuracy, and macro and media <italic toggle="yes">F</italic>1-scores, the χ<sup>2</sup> method outperformed other gene selection methods and HVGs. However, the performance did not always improve with the increase in the number of features selected by the χ<sup>2</sup> method. Therefore, we further evaluated the performance of the whole CTISL framework on various numbers of selected genes (from 10 to 2000) selected by the χ<sup>2</sup> approach for all experimental scenarios, including intra-dataset, inter-dataset, cross-batch dataset, and cross-species. As illustrated in <xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S1</xref>, not all performance values generally improved with the increase in the number of selected genes, posing the challenge of selecting a universally optimized number of genes. Specifically, we counted the number of times when each number of selected genes achieved the highest accuracy and macro and median <italic toggle="yes">F</italic>1-scores. As a result, 2000 χ<sup>2</sup>-selected genes achieved the highest performance 20 times, followed by 1500 genes (18 times) and 300 genes (16 times). However, when using the selected 2000 and 1500 genes, CTISL took a significantly longer time to build the model. Considering balancing the running time and performance, in our CTISL framework, we used 300 as the default number of top genes based on the experiments. We further used the 10Xv2 dataset as an example to explore the robustness of CTISL concerning different numbers of distinct genes selected for each cell type using the χ<sup>2</sup> approach (<xref rid="sup1" ref-type="supplementary-material">Supplementary Table S4</xref> and <xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S2</xref>). Notably, we observed a reduction in the number of distinct genes for certain cell types with an increase in the number of selected genes. Moreover, when the number of selected genes was above 1000, the number of distinct signature genes for each cell type did not always increase along with the increase of the number of selected genes by the χ<sup>2</sup> approach. Refer to <xref rid="sup1" ref-type="supplementary-material">Supplementary Section S1</xref> for more details.</p>
      <fig position="float" id="btae063-F2">
        <label>Figure 2.</label>
        <caption>
          <p>Feature gene selection and performance comparison of base learners and our CTISL framework (stacking LR and SVM). (A and B) Performance of SVM and LR using different feature gene selection approaches including the χ<sup>2</sup> method (300 genes selected) and the 5000 highly variable genes used in the work by <xref rid="btae063-B26" ref-type="bibr">Huang and Zhang (2021)</xref>. (C–F) Performance comparison among base classifiers LR, SVM, and CTISL (using the stacking ensemble learning technique) models based on the 300 selected feature genes by the χ<sup>2</sup> method in terms of accuracy, macro <italic toggle="yes">F</italic>1-score, and median <italic toggle="yes">F</italic>1-score using (C) intra-dataset, (D) inter-dataset, (E) cross-batch, and (F) cross-species evaluation strategy.</p>
        </caption>
        <graphic xlink:href="btae063f2" position="float"/>
      </fig>
      <p>We also examined the genes selected by the χ<sup>2</sup> method and found that some of them are marker genes of the corresponding cell types according to the CellMarker 2.0 database (<xref rid="btae063-B24" ref-type="bibr">Hu <italic toggle="yes">et al.</italic> 2023</xref>). As shown in <xref rid="sup1" ref-type="supplementary-material">Supplementary Table S5</xref>, 31 out of 62 marker genes in B cells of the PBMC_10Xv2 dataset were selected by the χ<sup>2</sup> method. These findings confirm that the χ<sup>2</sup> method is capable of selecting indicative feature genes for cell-type identification. We then conducted a performance comparison of CTISL by using selected feature genes and marker genes, respectively. We found that CTISL achieved better performance when using the selected feature genes in comparison to the marker genes (<xref rid="sup1" ref-type="supplementary-material">Supplementary Table S6</xref>). Although maker genes have a strong ability to identify cell types, the limited number of known marker genes in some cell types cannot help the model achieve satisfactory performance of cell-type identification. Refer to <xref rid="sup1" ref-type="supplementary-material">Supplementary Section S2</xref> for more information.</p>
    </sec>
    <sec>
      <title>3.2 Performance evaluation of CTISL</title>
      <p>We then evaluated and compared the performance improvement achieved by the stacking learning technique. We systematically compared CTISL (using stacking learning to ensemble LR and SVM) with selected genes and marker genes, respectively, χ<sup>2</sup>+MLP (multilayer perceptron) (<xref rid="btae063-B45" ref-type="bibr">Popescu <italic toggle="yes">et al.</italic> 2009</xref>), and CTISL with LR+SVM+RF+GBC (<xref rid="btae063-B20" ref-type="bibr">Friedman 2001</xref>) in intra-dataset experiments, inter-dataset experiments, cross-batch experiments, and cross-species experiments. Refer to the methodological details of integrating MLP, RF, and GBC in <xref rid="sup1" ref-type="supplementary-material">Supplementary Sections S1</xref> and <xref rid="sup1" ref-type="supplementary-material">S3</xref>. The performance of CTISL stacking LR and SVM using 300 selected feature genes is demonstrated in <xref rid="btae063-F2" ref-type="fig">Fig. 2</xref> and all detailed performance values are illustrated in <xref rid="sup1" ref-type="supplementary-material">Supplementary Table S6</xref>.</p>
      <p>The intra-dataset experiments demonstrate that CTISL outperformed all other approaches in terms of average accuracy and average median <italic toggle="yes">F</italic>1-score, except for the slightly lower (0.001) average macro <italic toggle="yes">F</italic>1-score than CTISL with LR+SVM+RF+GBC (<xref rid="sup1" ref-type="supplementary-material">Supplementary Table S6</xref>). In addition, CTISL outperformed the base classifiers LR and SVM (<xref rid="btae063-F2" ref-type="fig">Fig. 2C</xref> and <xref rid="sup1" ref-type="supplementary-material">Supplementary Table S6</xref>) in terms of average accuracy (92.8% versus 91.6% and 92.8% versus 90.7%), average macro <italic toggle="yes">F</italic>1-score (0.906 versus 0.877 and 0.906 versus 0.773), and average median <italic toggle="yes">F</italic>1-score (0.947 versus 0.938 and 0.947 versus 0.908). While for inter-dataset experiments, compared to LR and SVM, CTISL achieved higher average accuracy (87.2% versus 83.0% and 87.2% versus 87.1%), average macro <italic toggle="yes">F</italic>1-score (0.734 versus 0.696 and 0.734 versus 0.716, respectively), and average median <italic toggle="yes">F</italic>1-score (0.857 versus 0.801 and 0.857 versus 0.850) in inter-dataset experiments (<xref rid="btae063-F2" ref-type="fig">Fig. 2D</xref> and <xref rid="sup1" ref-type="supplementary-material">Supplementary Table S6</xref>). For cross-batch experiments, CTISL outperformed the base classifiers LR and SVM (<xref rid="btae063-F2" ref-type="fig">Fig. 2E</xref> and <xref rid="sup1" ref-type="supplementary-material">Supplementary Table S6</xref>) in terms of average accuracy (98.3% versus 97.8% and 98.3% versus 96.6%), average macro <italic toggle="yes">F</italic>1-score (0.961 versus 0.948 and 0.961 versus 0.798), and average median <italic toggle="yes">F</italic>1-score (0.973 versus 0.971 and 0.973 versus 0.778). Our cross-species experiments demonstrate that χ<sup>2</sup>+MLP outperformed CTISL in average macro and median <italic toggle="yes">F</italic>1-scores, while CTISL still achieved better performance than the base learners (i.e. LR and SVM) in most of the cross-species experiments (<xref rid="btae063-F2" ref-type="fig">Fig. 2F</xref> and <xref rid="sup1" ref-type="supplementary-material">Supplementary Table S6</xref>). Detailed performance comparison and discussion about χ<sup>2</sup>+MLP and CTISL with LR+SVM+RF+GBC have been provided in <xref rid="sup1" ref-type="supplementary-material">Supplementary Section S3</xref>.</p>
      <p>Although CTISL did not outperform the ensemble base learners on all three metrics in all 24 benchmarking experiments, the results demonstrate that CTISL achieved consistently robust and stable average performance across all cases, except for the comparative prediction performance based on cross-species. Overall, we conclude that the stacking learning technique can effectively improve the prediction performance of base classifiers on intra-dataset, inter-dataset, and cross-batch scenarios of cell type-identification. In addition, to examine the effectiveness of CTISL, we employed UMAP (<xref rid="btae063-B40" ref-type="bibr">McInnes <italic toggle="yes">et al.</italic> 2018</xref>) to visualize the cell types represented by features extracted from each step in our model (<xref rid="btae063-F3" ref-type="fig">Fig. 3</xref>). As can be seen from <xref rid="btae063-F3" ref-type="fig">Fig. 3</xref>, all cells were mixed in the original dataset. After selecting the feature genes, the same type of cells began to form a blurry cluster, which then gradually separated after the first layer. After the output layer, the same type of cells was well clustered into the same group. These results confirm that CTISL can effectively extract informative features representing cell types, thereby achieving outstanding prediction performance.</p>
      <fig position="float" id="btae063-F3">
        <label>Figure 3.</label>
        <caption>
          <p>Visualizing the cell-type identification results on seven datasets, including (A) 10Xv2, (B) 10Xv3, (C) CELSeq, (D) DropSeq, (E) inDrop, (F) SMARTSeq2, and (G) SeqWell. For each dataset, the four panels, from top to bottom, represent the visualizations without feature selection, the results after feature selection, the output of the first layer of the model, and the output of the last layer of the model, respectively.</p>
        </caption>
        <graphic xlink:href="btae063f3" position="float"/>
      </fig>
    </sec>
    <sec>
      <title>3.3 Model interpretation</title>
      <p>In this section, we used the SHAP package (<xref rid="btae063-B37" ref-type="bibr">Lundberg and Lee 2017</xref>) to interpret the output of CTISL (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S3</xref>) and compared the selected feature genes with the marker genes from the CellMarker 2.0 database (<xref rid="btae063-B24" ref-type="bibr">Hu <italic toggle="yes">et al.</italic> 2023</xref>). We plotted the distribution of the impact of the top 20 selected genes from the output of CTISL. Positive SHAP values indicate the identification of the current cell type, while negative SHAP values indicate the identification of other types. Taking the B cell in 10Xv2 e.g. (<xref rid="sup1" ref-type="supplementary-material">Supplementary Table S5</xref> and <xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S3A</xref>), most genes with high expression achieved positive SHAP values. Among these 20 selected top genes, 8 are marker genes according to CellMarker 2.0, including CD79A, IGHM, MS4A1, TNFRSF13C, IGHD, IGKC, CD74, and CD79B. These genes have high expression values in most B cell samples, and their SHAP values from the output of the model are positive, meaning that these genes are favorable to the identification of B cells. Similar results of other cell types can also be found in 10Xv2 (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S3</xref>). For example, the high expression of IL7R and LTB are marker genes of CD4+ T cells according to CellMarker 2.0 and are favorable for the recognition of CD4+ T cells (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S3I</xref>). They were among the top 20 selected genes for this cell type according to the output of our CTISL. Similarly, the high expression of PF4, PPBP, TUBB1, and MYL9 positively impacted the identification of megakaryocytes (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S3F</xref>), and they were marker genes for this cell type based on our SHAP analysis. In addition, high expression of marker genes, such as KLRF1, SPON2, KLRB1, GNLY, CCL4, FCGR3A, CD247, GZMB, CD7, KLRD1, and TRDC are more indicative of identifying natural killer cells. These genes are all marker genes based on the annotations of CellMarker 2.0 and were also among the top 20 selected genes for this cell type based on the outputs of CTISL (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S3G</xref>). For the Plasmacytoid dendritic cell (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S3H</xref>), out of the 6188 samples in the PBMC-10Xv2 dataset, only 38 samples are available. As such, there are only eight plasmacytoid dendritic cells in the test sub-dataset using a 5-fold cross-validation test on the 10Xv2 dataset. As a result, there are few data points with higher SHAP values depicted in <xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S3H</xref>.</p>
    </sec>
    <sec>
      <title>3.4 Benchmarking CTISL against state-of-the-art methods in intra- and inter-dataset scenarios</title>
      <p>We first performed 5-fold cross-validations on seven human PBMC datasets and compared CTISL with nine state-of-the-art approaches in intra- and inter-dataset scenarios. The evaluated approaches included ACTINN, scCapsNet, scDetect, TripletCell, scmap-cluster, scmap-cell, CellTypist, scBERT, and SingleR. <xref rid="btae063-F4" ref-type="fig">Figure 4A</xref> demonstrated that CTISL outperformed all other nine benchmarked methods in terms of accuracy on five out of seven intra-dataset experiments. Among the remaining two datasets, scmap-cell achieved the highest accuracy of 95.9%, while CTISL achieved the second-best performance of 95.1% on the 10Xv3 dataset. Additionally, CTISL achieved the third-best performance of 87.5% on the SeqWell dataset. In terms of macro <italic toggle="yes">F</italic>1-score (<xref rid="btae063-F4" ref-type="fig">Fig. 4B</xref>), CTISL outperformed all other nine benchmarked methods on four out of seven intra-datasets. For the remaining three datasets, CTISL achieved the second-best performance of 0.949 on the 10Xv3 dataset, 0.911 on the CELSeq dataset, and 0.802 on the inDrop dataset. Similar results are observed in terms of median <italic toggle="yes">F</italic>1-score (<xref rid="btae063-F4" ref-type="fig">Fig. 4C</xref>). To evaluate the performance generalization of CTISL, we further performed inter-dataset tests on seven human PBMC datasets generated by different protocols. We first trained our model on six of seven datasets and tested the model on the remaining dataset. Each dataset was used as the testing data once [in line with <xref rid="btae063-B58" ref-type="bibr">Wang <italic toggle="yes">et al.</italic> (2020</xref>b) and <xref rid="btae063-B64" ref-type="bibr">Yang <italic toggle="yes">et al.</italic> (2022)</xref>] and the evaluation therefore contained seven sub-tasks. As can be seen in <xref rid="btae063-F4" ref-type="fig">Fig. 4A</xref>, CTISL achieved the best accuracy on two out of seven tests. In the remaining five datasets, CTISL achieved the second-best performance of 87.0% on the DropSeq test dataset, the second-best performance of 85.6% on the inDrop test dataset, the fourth-best performance of 90.1% on the 10Xv2 test dataset, the third-best performance of 92.4% on the 10Xv3 test dataset, and the seventh-best performance of 74.1% on the SeqWell test dataset. Additionally, CTISL and scmap-cell achieved the highest macro <italic toggle="yes">F</italic>1-score on two out of seven test results (<xref rid="btae063-F4" ref-type="fig">Fig. 4B</xref>), followed by scCapsNet, scDetect, and TripletCell on one test, respectively. scCapsNet, and scBERT achieved the highest median <italic toggle="yes">F</italic>1-score on two tests, followed by CTISL, TripletCell, and scmap-cell on one test separately (<xref rid="btae063-F4" ref-type="fig">Fig. 4C</xref>). Overall, these comparison results demonstrate that CTISL is capable of accurately and robustly identifying cell types in both inter- and intra-dataset experiments.</p>
      <fig position="float" id="btae063-F4">
        <label>Figure 4.</label>
        <caption>
          <p>Performance evaluation and benchmarking between CTISL and nine state-of-the-art cell-type predictors in terms of (A) accuracy, (B) macro <italic toggle="yes">F</italic>1-score, and (C) median <italic toggle="yes">F</italic>1-score on seven human PBMC datasets in intra- and inter-dataset, cross-batch, and cross-species experiments. “b1 to b2” and “b2 to b1” mean that the model was trained on the first/second batch of dataset and tested on the second/first batch of dataset, respectively. While “h to m” and “m or h” mean that the model was trained on the human/mouse dataset and was tested using the mouse/human dataset, respectively.</p>
        </caption>
        <graphic xlink:href="btae063f4" position="float"/>
      </fig>
    </sec>
    <sec>
      <title>3.5 Performance comparison in cross-batch and cross-species scenarios</title>
      <p>To evaluate the performance of CTISL on different batches of datasets, we ran all 10 predictors on 3 datasets with 2 batches (<xref rid="sup1" ref-type="supplementary-material">Supplementary Table S1</xref>). We trained all models on one batch and assessed their performance using the dataset of another batch. In terms of accuracy (<xref rid="btae063-F4" ref-type="fig">Fig. 4A</xref>), CTISL, ACTINN, and scmap-cell achieved the highest accuracy (100%) across one batch of the Retina(5) dataset (b2–b1). Similarly, CTISL achieved the highest performance of 98.0% on the Retina(19) dataset (b2–b1) and the second-best performance of 96.8% (b1–b2). Similarly, CTISL achieved the highest performance of 98.1% on the dendritic dataset (b2–b1) and the second-best performance of 97.1% (b1–b2). CTISL also achieved the highest macro and median <italic toggle="yes">F</italic>1-scores (<xref rid="btae063-F4" ref-type="fig">Fig. 4B and C</xref>) on four and three out of six experiments, respectively.</p>
      <p>We then conducted cross-species cell-type identification using human and mouse pancreas and airway datasets. CTISL achieved the fourth-best accuracy of 84.3% from human to mouse on the pancreas datasets (<xref rid="btae063-F4" ref-type="fig">Fig. 4A</xref>). Except for CellTypist, which achieved the highest accuracy of 88.8%, all other models performed poorly when they were trained on the mouse pancreas dataset to predict cell types in the human pancreas dataset. This is presumably because those cell types are not completely identical across human and mouse pancreas tissues. It is a common phenomenon in cross-species scenarios that some unique cell types only exist in the test dataset. For example, several cell types (e.g. acinar, epsilon, and mast) only appear in the human pancreas dataset and are not present in the mouse pancreas dataset. Similarly, two cell types (e.g. B_cell and immuse_other) solely appear in the mouse pancreas dataset and are not present in the human pancreas dataset (<xref rid="sup1" ref-type="supplementary-material">Supplementary Table S7</xref>). This phenomenon greatly reduces the prediction performance of all the models compared. On the other hand, in the airway dataset, the human data comprised three cell types—Basal, Ciliated, and Secretory, with similar sample sizes of 252, 258, and 280, respectively. When using human airway datasets for training the model to predict the cell types in mouse airway datasets, all 10 models performed well, with CTISL ranked third in accuracy (<xref rid="btae063-F4" ref-type="fig">Fig. 4A</xref>). However, the mouse airway datasets exhibited a huge imbalance in sample sizes of the cell types, including Basal, Ciliated, and Secretory, with sample sizes of 6009, 1333, and 4792, respectively. Therefore, we applied the “RandomUnderSampler” function from the “imblearn” library (<xref rid="btae063-B33" ref-type="bibr">Lemaître <italic toggle="yes">et al.</italic> 2017</xref>), which is a down-sampling strategy based on the method proposed by <xref rid="btae063-B32" ref-type="bibr">Laurikkala (2001)</xref> to balance the class distribution in the dataset (<xref rid="sup1" ref-type="supplementary-material">Supplementary Section S3</xref>). We set the sample size of each cell type to 1333 and trained the four models using the down-sampled data to predict human data. Five rounds of down-sampling were then conducted for each experiment and the average results for each trial were calculated. CTISL achieved the highest accuracy of 99.7% (<xref rid="btae063-F4" ref-type="fig">Fig. 4A</xref>) and the highest macro (<xref rid="btae063-F4" ref-type="fig">Fig. 4B</xref>) and median <italic toggle="yes">F</italic>1-score (<xref rid="btae063-F4" ref-type="fig">Fig. 4C</xref>) of 0.998 on the human airway dataset. In addition, according to cross-species experiments (<xref rid="sup1" ref-type="supplementary-material">Supplementary Table S6</xref>), χ<sup>2</sup>+MLP achieved overall better performance than CTISL, and CTISL with LR+SVM+RF+GBC outperformed CTISL in terms of average macro and median <italic toggle="yes">F</italic>1-score. Therefore, we recommend χ<sup>2</sup>+MLP when performing cross-species cell-type identification. Taken together, despite that χ<sup>2</sup>+MLP performed better than CTISL in cross-species experiments, these results showed that CTISL possesses a strong predictive ability in cell-type identification in intra-dataset, inter-dataset, and cross-batch experiment scenarios.</p>
    </sec>
  </sec>
  <sec>
    <title>4 Discussion and conclusions</title>
    <p>For identifying cell types using highly sparse single-cell expression matrix data, it is crucial to perform feature selection prior to model construction. Our feature selection method consists of multiple iterations, with each iteration selecting representative features for a specific cell type. We compared our selected features with publicly available cell-type marker genes and found that some of our selected marker genes could accurately identify the corresponding cell types and have significant biological relevance. Furthermore, we analyzed the performance of CTISL using various feature gene selection methods and different numbers of selected genes (<xref rid="sup1" ref-type="supplementary-material">Supplementary Tables S2</xref> and <xref rid="sup1" ref-type="supplementary-material">S3</xref>, and <xref rid="sup1" ref-type="supplementary-material">Supplementary Section S1</xref>). It is worth noticing that the prediction performance of CTISL is still limited by supervised learning. When training and testing CTISL across datasets, the cell types in the predicted results of CTISL are solely based on the available types in the training set, meaning that the model cannot identify new cell types in the test dataset. Although some existing models are able to identify new cell types (such as ACTINN, scCapsNet, scDetect, TripletCell, scmap-cell, and scmap-cluster), they may only classify them as a “novel”/ “other” type without accurately determining their actual types. In the future, we will endeavor to incorporate more cell types by combining more single-cell omic data, such as scATAC-seq data, thereby enriching the prediction capacity of CTISL. CTISL utilizes LR and SVM as default base learners for each cell type in the training dataset. However, other classifiers can also be integrated into CTISL as base learners (Supplementary Sections S3). Moreover, as the number of cell types increases, CTISL can dynamically increase the number of base learners (<xref rid="sup1" ref-type="supplementary-material">Supplementary Section S5</xref>). In addition, the performance of CTISL, like most state-of-the-art predictors, may suffer from imbalanced cell types in the training dataset when performing cross-species predictions. However, this issue can be to some extent mitigated by employing down-sampling techniques in the training dataset. It is worth noticing that the down-sampling strategy does not work if the rarest cell type (i.e. the cell type with the least number of cells compared to other cell types) in the training dataset has an insufficient number of cells. We also discussed the effect of cell-type imbalances on different experiment scenarios, such as cross-batch and intra-dataset in <xref rid="sup1" ref-type="supplementary-material">Supplementary Section S4</xref>.</p>
    <p>We developed a user-friendly web-based application for CTISL at <ext-link xlink:href="http://bigdata.biocie.cn/CTISLweb/home" ext-link-type="uri">http://bigdata.biocie.cn/CTISLweb/home</ext-link> to facilitate community-wide efforts to identify cell types using users’ datasets. Additionally, users have the option to choose different models other than LR and SVM as base learners or add additional models to the CTISL framework, via our webserver and locally runnable software (<ext-link xlink:href="https://zenodo.org/records/10568906" ext-link-type="uri">https://zenodo.org/records/10568906</ext-link>). Alternatively, given that χ<sup>2</sup>+MLP achieved better performance than the original CTISL in cross-species cell-type identification, we provided the MLP option on our webserver and GitHub repository for users to replace the stacking model. In conclusion, as a dynamic stacking ensemble learning-based model for robust multi-class classification of cell types using scRNA-seq data, CTISL achieved better or competitive, and more robust performances compared to other state-of-the-art predictors based on our extensive benchmarking experiments on intra- and inter-dataset, cross-batch, and cross-species datasets. Altogether, we anticipate that CTISL will serve as a prominent computational tool for the accurate identification of cell types using scRNA-seq data, thereby facilitating scRNA-seq data analysis and hypothesis generation.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material id="sup1" position="float" content-type="local-data">
      <label>btae063_Supplementary_Data</label>
      <media xlink:href="btae063_supplementary_data.docx">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <ack id="ack1">
    <title>Acknowledgements</title>
    <p>We thank the High-Performance Computing (HPC) of Northwest A&amp;F University (NWAFU) for providing computing resources.</p>
  </ack>
  <sec>
    <title>Supplementary data</title>
    <p><xref rid="sup1" ref-type="supplementary-material">Supplementary data</xref> are available at <italic toggle="yes">Bioinformatics</italic> online.</p>
  </sec>
  <sec sec-type="COI-statement">
    <title>Conflict of interest</title>
    <p>None declared.</p>
  </sec>
  <sec>
    <title>Funding</title>
    <p>This work was supported by the National Key R&amp;D Program of China [2022YFF1000100].</p>
  </sec>
  <ref-list id="ref1">
    <title>References</title>
    <ref id="btae063-B1">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Abdelaal</surname><given-names>T</given-names></string-name>, <string-name><surname>Michielsen</surname><given-names>L</given-names></string-name>, <string-name><surname>Cats</surname><given-names>D</given-names></string-name></person-group><etal>et al</etal><article-title>A comparison of automatic cell identification methods for single-cell RNA sequencing data</article-title>. <source>Genome Biol</source><year>2019</year>;<volume>20</volume>:<fpage>194</fpage>.<pub-id pub-id-type="pmid">31500660</pub-id></mixed-citation>
    </ref>
    <ref id="btae063-B2">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Aibar</surname><given-names>S</given-names></string-name>, <string-name><surname>González-Blas</surname><given-names>CB</given-names></string-name>, <string-name><surname>Moerman</surname><given-names>T</given-names></string-name></person-group><etal>et al</etal><article-title>SCENIC: single-cell regulatory network inference and clustering</article-title>. <source>Nat Methods</source><year>2017</year>;<volume>14</volume>:<fpage>1083</fpage>–<lpage>6</lpage>.<pub-id pub-id-type="pmid">28991892</pub-id></mixed-citation>
    </ref>
    <ref id="btae063-B3">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Alquicira-Hernandez</surname><given-names>J</given-names></string-name>, <string-name><surname>Sathe</surname><given-names>A</given-names></string-name>, <string-name><surname>Ji</surname><given-names>HP</given-names></string-name></person-group><etal>et al</etal><article-title>scPred: accurate supervised method for cell-type classification from single-cell RNA-seq data</article-title>. <source>Genome Biol</source><year>2019</year>;<volume>20</volume>:<fpage>264</fpage>.<pub-id pub-id-type="pmid">31829268</pub-id></mixed-citation>
    </ref>
    <ref id="btae063-B4">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Aran</surname><given-names>D</given-names></string-name>, <string-name><surname>Looney</surname><given-names>AP</given-names></string-name>, <string-name><surname>Liu</surname><given-names>L</given-names></string-name></person-group><etal>et al</etal><article-title>Reference-based analysis of lung single-cell sequencing reveals a transitional profibrotic macrophage</article-title>. <source>Nat Immunol</source><year>2019</year>;<volume>20</volume>:<fpage>163</fpage>–<lpage>72</lpage>.<pub-id pub-id-type="pmid">30643263</pub-id></mixed-citation>
    </ref>
    <ref id="btae063-B5">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Arendt</surname><given-names>D</given-names></string-name>, <string-name><surname>Musser</surname><given-names>JM</given-names></string-name>, <string-name><surname>Baker</surname><given-names>CVH</given-names></string-name></person-group><etal>et al</etal><article-title>The origin and evolution of cell types</article-title>. <source>Nat Rev Genet</source><year>2016</year>;<volume>17</volume>:<fpage>744</fpage>–<lpage>57</lpage>.<pub-id pub-id-type="pmid">27818507</pub-id></mixed-citation>
    </ref>
    <ref id="btae063-B6">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Baron</surname><given-names>M</given-names></string-name>, <string-name><surname>Veres</surname><given-names>A</given-names></string-name>, <string-name><surname>Wolock</surname><given-names>SL</given-names></string-name></person-group><etal>et al</etal><article-title>A single-cell transcriptomic map of the human and mouse pancreas reveals inter- and intra-cell population structure</article-title>. <source>Cell Syst</source><year>2016</year>;<volume>3</volume>:<fpage>346</fpage>–<lpage>60.e4</lpage>.<pub-id pub-id-type="pmid">27667365</pub-id></mixed-citation>
    </ref>
    <ref id="btae063-B7">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Basith</surname><given-names>S</given-names></string-name>, <string-name><surname>Lee</surname><given-names>G</given-names></string-name>, <string-name><surname>Manavalan</surname><given-names>B.</given-names></string-name></person-group><article-title>STALLION: a stacking-based ensemble learning framework for prokaryotic lysine acetylation site prediction</article-title>. <source>Brief Bioinform</source><year>2022</year>;<volume>23</volume>:<fpage>bbab376</fpage>.<pub-id pub-id-type="pmid">34532736</pub-id></mixed-citation>
    </ref>
    <ref id="btae063-B8">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Breiman</surname><given-names>L.</given-names></string-name></person-group><article-title>Random forests</article-title>. <source>Mach Learn</source><year>2001</year>;<volume>45</volume>:<fpage>5</fpage>–<lpage>32</lpage>.</mixed-citation>
    </ref>
    <ref id="btae063-B9">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Cao</surname><given-names>Z</given-names></string-name>, <string-name><surname>Pan</surname><given-names>X</given-names></string-name>, <string-name><surname>Yang</surname><given-names>Y</given-names></string-name></person-group><etal>et al</etal><article-title>The lncLocator: a subcellular localization predictor for long non-coding RNAs based on a stacked ensemble classifier</article-title>. <source>Bioinformatics</source><year>2018</year>;<volume>34</volume>:<fpage>2185</fpage>–<lpage>94</lpage>.<pub-id pub-id-type="pmid">29462250</pub-id></mixed-citation>
    </ref>
    <ref id="btae063-B10">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Celebi</surname><given-names>ME</given-names></string-name>, <string-name><surname>Kingravi</surname><given-names>HA</given-names></string-name>, <string-name><surname>Vela</surname><given-names>PA.</given-names></string-name></person-group><article-title>A comparative study of efficient initialization methods for the k-means clustering algorithm</article-title>. <source>Expert Syst Appl</source><year>2013</year>;<volume>40</volume>:<fpage>200</fpage>–<lpage>10</lpage>.</mixed-citation>
    </ref>
    <ref id="btae063-B11">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Chen</surname><given-names>X</given-names></string-name>, <string-name><surname>Chen</surname><given-names>S</given-names></string-name>, <string-name><surname>Song</surname><given-names>S</given-names></string-name></person-group><etal>et al</etal><article-title>Cell type annotation of single-cell chromatin accessibility data via supervised Bayesian embedding</article-title>. <source>Nat Mach Intell</source><year>2022</year>;<volume>4</volume>:<fpage>116</fpage>–<lpage>26</lpage>.</mixed-citation>
    </ref>
    <ref id="btae063-B12">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Cortes</surname><given-names>C</given-names></string-name>, <string-name><surname>Vapnik</surname><given-names>V.</given-names></string-name></person-group><article-title>Support-vector networks</article-title>. <source>Mach Learn</source><year>1995</year>;<volume>20</volume>:<fpage>273</fpage>–<lpage>97</lpage>.</mixed-citation>
    </ref>
    <ref id="btae063-B13">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Cover</surname><given-names>T</given-names></string-name>, <string-name><surname>Hart</surname><given-names>P.</given-names></string-name></person-group><article-title>Nearest neighbor pattern classification</article-title>. <source>IEEE Trans Inform Theory</source><year>1967</year>;<volume>13</volume>:<fpage>21</fpage>–<lpage>7</lpage>.</mixed-citation>
    </ref>
    <ref id="btae063-B14">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Cui</surname><given-names>Y</given-names></string-name>, <string-name><surname>Zhang</surname><given-names>S</given-names></string-name>, <string-name><surname>Liang</surname><given-names>Y</given-names></string-name></person-group><etal>et al</etal><article-title>Consensus clustering of single-cell RNA-seq data by enhancing network affinity</article-title>. <source>Brief Bioinform</source><year>2021</year>;<volume>22</volume>:<fpage>bbab236</fpage>.<pub-id pub-id-type="pmid">34160582</pub-id></mixed-citation>
    </ref>
    <ref id="btae063-B15">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Deng</surname><given-names>T</given-names></string-name>, <string-name><surname>Chen</surname><given-names>S</given-names></string-name>, <string-name><surname>Zhang</surname><given-names>Y</given-names></string-name></person-group><etal>et al</etal><article-title>A cofunctional grouping-based approach for non-redundant feature gene selection in unannotated single-cell RNA-seq analysis</article-title>. <source>Brief Bioinform</source><year>2023</year>;<volume>24</volume>:<fpage>bbad042</fpage>.<pub-id pub-id-type="pmid">36754847</pub-id></mixed-citation>
    </ref>
    <ref id="btae063-B16">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Ding</surname><given-names>J</given-names></string-name>, <string-name><surname>Adiconis</surname><given-names>X</given-names></string-name>, <string-name><surname>Simmons</surname><given-names>SK</given-names></string-name></person-group><etal>et al</etal><article-title>Systematic comparison of single-cell and single-nucleus RNA-sequencing methods</article-title>. <source>Nat Biotechnol</source><year>2020</year>;<volume>38</volume>:<fpage>737</fpage>–<lpage>46</lpage>.<pub-id pub-id-type="pmid">32341560</pub-id></mixed-citation>
    </ref>
    <ref id="btae063-B17">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Domínguez Conde</surname><given-names>C</given-names></string-name>, <string-name><surname>Xu</surname><given-names>C</given-names></string-name>, <string-name><surname>Jarvis</surname><given-names>LB</given-names></string-name></person-group><etal>et al</etal><article-title>Cross-tissue immune cell analysis reveals tissue-specific features in humans</article-title>. <source>Science</source><year>2022</year>;<volume>376</volume>:<fpage>eabl5197</fpage>.<pub-id pub-id-type="pmid">35549406</pub-id></mixed-citation>
    </ref>
    <ref id="btae063-B18">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><string-name><surname>Ertoz</surname><given-names>L</given-names></string-name>, <string-name><surname>Steinbach</surname><given-names>M</given-names></string-name>, <string-name><surname>Kumar</surname><given-names>V.</given-names></string-name></person-group> A new shared nearest neighbor clustering algorithm and its applications. In: <italic toggle="yes">Workshop on Clustering High Dimensional Data and Its Applications at 2nd SIAM International Conference on Data Mining, Arlington, VA, USA</italic>. United States: Society for Industrial and Applied Mathematics <year>2002</year>.</mixed-citation>
    </ref>
    <ref id="btae063-B19">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Forman</surname><given-names>G.</given-names></string-name></person-group><article-title>An extensive empirical study of feature selection metrics for text classification</article-title>. <source>J Mach Learn Res</source><year>2003</year>;<volume>3</volume>:<fpage>1289</fpage>–<lpage>305</lpage>.</mixed-citation>
    </ref>
    <ref id="btae063-B20">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Friedman</surname><given-names>JH.</given-names></string-name></person-group><article-title>Greedy function approximation: a gradient boosting machine</article-title>. <source>Ann Statist</source><year>2001</year>;<volume>29</volume>:<fpage>1189</fpage>–<lpage>232</lpage>.</mixed-citation>
    </ref>
    <ref id="btae063-B21">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Fushiki</surname><given-names>T.</given-names></string-name></person-group><article-title>Bayesian bootstrap prediction</article-title>. <source>J Stat Plan Inference</source><year>2010</year>;<volume>140</volume>:<fpage>65</fpage>–<lpage>74</lpage>.</mixed-citation>
    </ref>
    <ref id="btae063-B22">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Grün</surname><given-names>D</given-names></string-name>, <string-name><surname>Lyubimova</surname><given-names>A</given-names></string-name>, <string-name><surname>Kester</surname><given-names>L</given-names></string-name></person-group><etal>et al</etal><article-title>Single-cell messenger RNA sequencing reveals rare intestinal cell types</article-title>. <source>Nature</source><year>2015</year>;<volume>525</volume>:<fpage>251</fpage>–<lpage>5</lpage>.<pub-id pub-id-type="pmid">26287467</pub-id></mixed-citation>
    </ref>
    <ref id="btae063-B23">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Guo</surname><given-names>M</given-names></string-name>, <string-name><surname>Wang</surname><given-names>H</given-names></string-name>, <string-name><surname>Potter</surname><given-names>SS</given-names></string-name></person-group><etal>et al</etal><article-title>SINCERA: a pipeline for single-cell RNA-seq profiling analysis</article-title>. <source>PLoS Comput Biol</source><year>2015</year>;<volume>11</volume>:<fpage>e1004575</fpage>.<pub-id pub-id-type="pmid">26600239</pub-id></mixed-citation>
    </ref>
    <ref id="btae063-B24">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Hu</surname><given-names>C</given-names></string-name>, <string-name><surname>Li</surname><given-names>T</given-names></string-name>, <string-name><surname>Xu</surname><given-names>Y</given-names></string-name></person-group><etal>et al</etal><article-title>CellMarker 2.0: an updated database of manually curated cell markers in human/mouse and web tools based on scRNA-seq data</article-title>. <source>Nucleic Acids Res</source><year>2023</year>;<volume>51</volume>:<fpage>D870</fpage>–<lpage>6</lpage>.<pub-id pub-id-type="pmid">36300619</pub-id></mixed-citation>
    </ref>
    <ref id="btae063-B25">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Hu</surname><given-names>J</given-names></string-name>, <string-name><surname>Li</surname><given-names>X</given-names></string-name>, <string-name><surname>Hu</surname><given-names>G</given-names></string-name></person-group><etal>et al</etal><article-title>Iterative transfer learning with neural network for clustering and cell type classification in single-cell RNA-seq analysis</article-title>. <source>Nat Mach Intell</source><year>2020</year>;<volume>2</volume>:<fpage>607</fpage>–<lpage>18</lpage>.<pub-id pub-id-type="pmid">33817554</pub-id></mixed-citation>
    </ref>
    <ref id="btae063-B26">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Huang</surname><given-names>Y</given-names></string-name>, <string-name><surname>Zhang</surname><given-names>P.</given-names></string-name></person-group><article-title>Evaluation of machine learning approaches for cell-type identification from single-cell transcriptomics data</article-title>. <source>Brief Bioinform</source><year>2021</year>;<volume>22</volume>:<fpage>bbab217</fpage>.<pub-id pub-id-type="pmid">34050369</pub-id></mixed-citation>
    </ref>
    <ref id="btae063-B27">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Jia</surname><given-names>S</given-names></string-name>, <string-name><surname>Lysenko</surname><given-names>A</given-names></string-name>, <string-name><surname>Boroevich</surname><given-names>KA</given-names></string-name></person-group><etal>et al</etal><article-title>scDeepInsight: a supervised cell-type identification method for scRNA-seq data with deep learning</article-title>. <source>Brief Bioinform</source><year>2023</year>;<volume>24</volume>:<fpage>bbad266</fpage>.<pub-id pub-id-type="pmid">37523217</pub-id></mixed-citation>
    </ref>
    <ref id="btae063-B28">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Jiang</surname><given-names>L</given-names></string-name>, <string-name><surname>Chen</surname><given-names>H</given-names></string-name>, <string-name><surname>Pinello</surname><given-names>L</given-names></string-name></person-group><etal>et al</etal><article-title>GiniClust: detecting rare cell types from single-cell gene expression data with Gini index</article-title>. <source>Genome Biol</source><year>2016</year>;<volume>17</volume>:<fpage>144</fpage>.<pub-id pub-id-type="pmid">27368803</pub-id></mixed-citation>
    </ref>
    <ref id="btae063-B29">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Kiselev</surname><given-names>VY</given-names></string-name>, <string-name><surname>Andrews</surname><given-names>TS</given-names></string-name>, <string-name><surname>Hemberg</surname><given-names>M.</given-names></string-name></person-group><article-title>Challenges in unsupervised clustering of single-cell RNA-seq data</article-title>. <source>Nat Rev Genet</source><year>2019</year>;<volume>20</volume>:<fpage>273</fpage>–<lpage>82</lpage>.<pub-id pub-id-type="pmid">30617341</pub-id></mixed-citation>
    </ref>
    <ref id="btae063-B30">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Kiselev</surname><given-names>VY</given-names></string-name>, <string-name><surname>Kirschner</surname><given-names>K</given-names></string-name>, <string-name><surname>Schaub</surname><given-names>MT</given-names></string-name></person-group><etal>et al</etal><article-title>SC3: consensus clustering of single-cell RNA-seq data</article-title>. <source>Nat Methods</source><year>2017</year>;<volume>14</volume>:<fpage>483</fpage>–<lpage>6</lpage>.<pub-id pub-id-type="pmid">28346451</pub-id></mixed-citation>
    </ref>
    <ref id="btae063-B31">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Kiselev</surname><given-names>VY</given-names></string-name>, <string-name><surname>Yiu</surname><given-names>A</given-names></string-name>, <string-name><surname>Hemberg</surname><given-names>MJNM.</given-names></string-name></person-group><article-title>Scmap: projection of single-cell RNA-seq data across data sets</article-title>. <source>Nat Methods</source><year>2018</year>;<volume>15</volume>:<fpage>359</fpage>–<lpage>62</lpage>.<pub-id pub-id-type="pmid">29608555</pub-id></mixed-citation>
    </ref>
    <ref id="btae063-B32">
      <mixed-citation publication-type="book"><person-group person-group-type="author"><string-name><surname>Laurikkala</surname><given-names>J.</given-names></string-name></person-group> Improving identification of difficult small classes by balancing class distribution. In: <italic toggle="yes">Artificial Intelligence in Medicine: 8th Conference on Artificial Intelligence in Medicine in Europe, AIME 2001, Cascais, Portugal, July 1–4, 2001, Proceedings 8</italic>. <fpage>63</fpage>–<lpage>6</lpage>. <publisher-name>Germany</publisher-name>: Springer-Verlag Berlin Heidelberg, <year>2001</year>.</mixed-citation>
    </ref>
    <ref id="btae063-B33">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Lemaître</surname><given-names>G</given-names></string-name>, <string-name><surname>Nogueira</surname><given-names>F</given-names></string-name>, <string-name><surname>Aridas</surname><given-names>C.</given-names></string-name></person-group><article-title>Imbalanced-learn: a python toolbox to tackle the curse of imbalanced datasets in machine learning</article-title>. <source>J Mach Learn Res</source><year>2017</year>;<volume>18</volume>:<fpage>559</fpage>–<lpage>63</lpage>.</mixed-citation>
    </ref>
    <ref id="btae063-B34">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Liang</surname><given-names>X</given-names></string-name>, <string-name><surname>Li</surname><given-names>F</given-names></string-name>, <string-name><surname>Chen</surname><given-names>J</given-names></string-name></person-group><etal>et al</etal><article-title>Large-scale comparative review and assessment of computational methods for anti-cancer peptide identification</article-title>. <source>Brief Bioinform</source><year>2021</year>;<volume>22</volume>:<fpage>bbaa312</fpage>.<pub-id pub-id-type="pmid">33316035</pub-id></mixed-citation>
    </ref>
    <ref id="btae063-B35">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Lin</surname><given-names>Y</given-names></string-name>, <string-name><surname>Cao</surname><given-names>Y</given-names></string-name>, <string-name><surname>Kim</surname><given-names>HJ</given-names></string-name></person-group><etal>et al</etal><article-title>scClassify: sample size estimation and multiscale classification of cells using single and multiple reference</article-title>. <source>Mol Syst Biol</source><year>2020</year>;<volume>16</volume>:<fpage>e9389</fpage>.<pub-id pub-id-type="pmid">32567229</pub-id></mixed-citation>
    </ref>
    <ref id="btae063-B36">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Liu</surname><given-names>Y</given-names></string-name>, <string-name><surname>Wei</surname><given-names>G</given-names></string-name>, <string-name><surname>Li</surname><given-names>C</given-names></string-name></person-group><etal>et al</etal><article-title>TripletCell: a deep metric learning framework for accurate annotation of cell types at the single-cell level</article-title>. <source>Brief Bioinform</source><year>2023</year>;<volume>24</volume>:<fpage>bbad132</fpage>.<pub-id pub-id-type="pmid">37080771</pub-id></mixed-citation>
    </ref>
    <ref id="btae063-B37">
      <mixed-citation publication-type="book"><person-group person-group-type="author"><string-name><surname>Lundberg</surname><given-names>S</given-names></string-name>, <string-name><surname>Lee</surname><given-names>S-I.</given-names></string-name></person-group> A unified approach to interpreting model predictions. In: <italic toggle="yes">31st Conference on Neural Information Processing Systems (NIPS), Long Beach, California, USA</italic>, Vol. <volume>23</volume>. <fpage>4765</fpage>–<lpage>74</lpage>. United States: <publisher-name>ACM</publisher-name>, <year>2017</year>.</mixed-citation>
    </ref>
    <ref id="btae063-B41">
      <mixed-citation publication-type="journal">Lecessie S and van Houwelingen JC. Ridge estimators in logistic regression. <source>Appl Statist</source> 1992;<volume>41</volume>:<fpage>191</fpage>–<lpage>201</lpage>.</mixed-citation>
    </ref>
    <ref id="btae063-B38">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Ma</surname><given-names>F</given-names></string-name>, <string-name><surname>Pellegrini</surname><given-names>M.</given-names></string-name></person-group><article-title>ACTINN: automated identification of cell types in single cell RNA sequencing</article-title>. <source>Bioinformatics</source><year>2020</year>;<volume>36</volume>:<fpage>533</fpage>–<lpage>8</lpage>.<pub-id pub-id-type="pmid">31359028</pub-id></mixed-citation>
    </ref>
    <ref id="btae063-B39">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Ma</surname><given-names>W</given-names></string-name>, <string-name><surname>Su</surname><given-names>K</given-names></string-name>, <string-name><surname>Wu</surname><given-names>H.</given-names></string-name></person-group><article-title>Evaluation of some aspects in supervised cell type identification for single-cell RNA-seq: classifier, feature selection, and reference construction</article-title>. <source>Genome Biol</source><year>2021</year>;<volume>22</volume>:<fpage>264</fpage>.<pub-id pub-id-type="pmid">34503564</pub-id></mixed-citation>
    </ref>
    <ref id="btae063-B40">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>McInnes</surname><given-names>L</given-names></string-name>, <string-name><surname>Healy</surname><given-names>J</given-names></string-name>, <string-name><surname>Saul</surname><given-names>N</given-names></string-name></person-group><etal>et al</etal><article-title>UMAP: uniform manifold approximation and projection</article-title>. <source>JOSS</source><year>2018</year>;<volume>3</volume>:<fpage>861</fpage>.</mixed-citation>
    </ref>
    <ref id="btae063-B42">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Nguyen</surname><given-names>V</given-names></string-name>, <string-name><surname>Griss</surname><given-names>J.</given-names></string-name></person-group><article-title>scAnnotatR: framework to accurately classify cell types in single-cell RNA-sequencing data</article-title>. <source>BMC Bioinformatics</source><year>2022</year>;<volume>23</volume>:<fpage>44</fpage>.<pub-id pub-id-type="pmid">35038984</pub-id></mixed-citation>
    </ref>
    <ref id="btae063-B43">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Plasschaert</surname><given-names>LW</given-names></string-name>, <string-name><surname>Žilionis</surname><given-names>R</given-names></string-name>, <string-name><surname>Choo-Wing</surname><given-names>R</given-names></string-name></person-group><etal>et al</etal><article-title>A single-cell atlas of the airway epithelium reveals the CFTR-rich pulmonary ionocyte</article-title>. <source>Nature</source><year>2018</year>;<volume>560</volume>:<fpage>377</fpage>–<lpage>81</lpage>.<pub-id pub-id-type="pmid">30069046</pub-id></mixed-citation>
    </ref>
    <ref id="btae063-B44">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Pliner</surname><given-names>HA</given-names></string-name>, <string-name><surname>Shendure</surname><given-names>J</given-names></string-name>, <string-name><surname>Trapnell</surname><given-names>C.</given-names></string-name></person-group><article-title>Supervised classification enables rapid annotation of cell atlases</article-title>. <source>Nat Methods</source><year>2019</year>;<volume>16</volume>:<fpage>983</fpage>–<lpage>6</lpage>.<pub-id pub-id-type="pmid">31501545</pub-id></mixed-citation>
    </ref>
    <ref id="btae063-B45">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Popescu</surname><given-names>M-C</given-names></string-name></person-group>, Balas VE, Perescu-Popescu L <etal>et al</etal><article-title>Multilayer perceptron and neural networks</article-title>. <source>WSEAS Trans Circuits Syst</source><year>2009</year>;<volume>8</volume>:<fpage>579</fpage>–<lpage>88</lpage>.</mixed-citation>
    </ref>
    <ref id="btae063-B46">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Qi</surname><given-names>R</given-names></string-name>, <string-name><surname>Ma</surname><given-names>A</given-names></string-name>, <string-name><surname>Ma</surname><given-names>Q</given-names></string-name></person-group><etal>et al</etal><article-title>Clustering and classification methods for single-cell RNA-sequencing data</article-title>. <source>Brief Bioinform</source><year>2020</year>;<volume>21</volume>:<fpage>1196</fpage>–<lpage>208</lpage>.<pub-id pub-id-type="pmid">31271412</pub-id></mixed-citation>
    </ref>
    <ref id="btae063-B47">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Raschka</surname><given-names>S.</given-names></string-name></person-group><article-title>MLxtend: providing machine learning and data science utilities and extensions to python’s scientific computing stack</article-title>. <source>JOSS</source><year>2018</year>;<volume>3</volume>:<fpage>638</fpage>.</mixed-citation>
    </ref>
    <ref id="btae063-B48">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Ritchie</surname><given-names>ME</given-names></string-name>, <string-name><surname>Phipson</surname><given-names>B</given-names></string-name>, <string-name><surname>Wu</surname><given-names>D</given-names></string-name></person-group><etal>et al</etal><article-title>Limma powers differential expression analyses for RNA-sequencing and microarray studies</article-title>. <source>Nucleic Acids Res</source><year>2015</year>;<volume>43</volume>:<fpage>e47</fpage>.<pub-id pub-id-type="pmid">25605792</pub-id></mixed-citation>
    </ref>
    <ref id="btae063-B49">
      <mixed-citation publication-type="book"><person-group person-group-type="author"><string-name><surname>Sabour</surname><given-names>S</given-names></string-name>, <string-name><surname>Frosst</surname><given-names>N</given-names></string-name>, <string-name><surname>Hinton</surname><given-names>GE.</given-names></string-name></person-group> Dynamic routing between capsules. In: <italic toggle="yes">Proceedings of the 31st International Conference on Neural Information Processing Systems. Long Beach, California, USA</italic>. <fpage>3859</fpage>–<lpage>69</lpage>. United States: <publisher-name>Curran Associates Inc</publisher-name>., <year>2017</year>.</mixed-citation>
    </ref>
    <ref id="btae063-B50">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Samek</surname><given-names>W</given-names></string-name>, <string-name><surname>Montavon</surname><given-names>G</given-names></string-name>, <string-name><surname>Lapuschkin</surname><given-names>S</given-names></string-name></person-group><etal>et al</etal><article-title>Explaining deep neural networks and beyond: a review of methods and applications</article-title>. <source>Proc IEEE</source><year>2021</year>;<volume>109</volume>:<fpage>247</fpage>–<lpage>78</lpage>.</mixed-citation>
    </ref>
    <ref id="btae063-B51">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Shekhar</surname><given-names>K</given-names></string-name>, <string-name><surname>Lapan</surname><given-names>SW</given-names></string-name>, <string-name><surname>Whitney</surname><given-names>IE</given-names></string-name></person-group><etal>et al</etal><article-title>Comprehensive classification of retinal bipolar neurons by single-cell transcriptomics</article-title>. <source>Cell</source><year>2016</year>;<volume>166</volume>:<fpage>1308</fpage>–<lpage>23.e30</lpage>.<pub-id pub-id-type="pmid">27565351</pub-id></mixed-citation>
    </ref>
    <ref id="btae063-B52">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Shen</surname><given-names>Y</given-names></string-name>, <string-name><surname>Chu</surname><given-names>Q</given-names></string-name>, <string-name><surname>Timko</surname><given-names>MP</given-names></string-name></person-group><etal>et al</etal><article-title>scDetect: a rank-based ensemble learning algorithm for cell type identification of single-cell RNA sequencing in cancer</article-title>. <source>Bioinformatics</source><year>2021</year>;<volume>37</volume>:<fpage>4115</fpage>–<lpage>22</lpage>.<pub-id pub-id-type="pmid">34048541</pub-id></mixed-citation>
    </ref>
    <ref id="btae063-B53">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Strehl</surname><given-names>A</given-names></string-name>, <string-name><surname>Ghosh</surname><given-names>J.</given-names></string-name></person-group><article-title>Cluster ensembles—a knowledge reuse framework for combining multiple partitions</article-title>. <source>J Mach Learn Res</source><year>2003</year>;<volume>3</volume>:<fpage>583</fpage>–<lpage>617</lpage>.</mixed-citation>
    </ref>
    <ref id="btae063-B54">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Sun</surname><given-names>X</given-names></string-name>, <string-name><surname>Lin</surname><given-names>X</given-names></string-name>, <string-name><surname>Li</surname><given-names>Z</given-names></string-name></person-group><etal>et al</etal><article-title>A comprehensive comparison of supervised and unsupervised methods for cell type identification in single-cell RNA-seq</article-title>. <source>Brief Bioinform</source><year>2022</year>;<volume>23</volume>:<fpage>bbab567</fpage>.<pub-id pub-id-type="pmid">35021202</pub-id></mixed-citation>
    </ref>
    <ref id="btae063-B55">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Tang</surname><given-names>F</given-names></string-name>, <string-name><surname>Barbacioru</surname><given-names>C</given-names></string-name>, <string-name><surname>Wang</surname><given-names>Y</given-names></string-name></person-group><etal>et al</etal><article-title>mRNA-Seq whole-transcriptome analysis of a single cell</article-title>. <source>Nat Methods</source><year>2009</year>;<volume>6</volume>:<fpage>377</fpage>–<lpage>82</lpage>.<pub-id pub-id-type="pmid">19349980</pub-id></mixed-citation>
    </ref>
    <ref id="btae063-B56">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Villani</surname><given-names>A-C</given-names></string-name>, <string-name><surname>Satija</surname><given-names>R</given-names></string-name>, <string-name><surname>Reynolds</surname><given-names>G</given-names></string-name></person-group><etal>et al</etal><article-title>Single-cell RNA-seq reveals new types of human blood dendritic cells, monocytes, and progenitors</article-title>. <source>Science</source><year>2017</year>;<volume>356</volume>:<fpage>eaah4573</fpage>.<pub-id pub-id-type="pmid">28428369</pub-id></mixed-citation>
    </ref>
    <ref id="btae063-B57">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Wang</surname><given-names>B</given-names></string-name>, <string-name><surname>Zhu</surname><given-names>J</given-names></string-name>, <string-name><surname>Pierson</surname><given-names>E</given-names></string-name></person-group><etal>et al</etal><article-title>Visualization and analysis of single-cell RNA-seq data by kernel-based similarity learning</article-title>. <source>Nat Methods</source><year>2017</year>;<volume>14</volume>:<fpage>414</fpage>–<lpage>6</lpage>.<pub-id pub-id-type="pmid">28263960</pub-id></mixed-citation>
    </ref>
    <ref id="btae063-B58">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Wang</surname><given-names>L</given-names></string-name>, <string-name><surname>Catalan</surname><given-names>F</given-names></string-name>, <string-name><surname>Shamardani</surname><given-names>K</given-names></string-name></person-group><etal>et al</etal><article-title>Ensemble learning for classifying single-cell data and projection across reference atlases</article-title>. <source>Bioinformatics</source><year>2020a</year>;<volume>36</volume>:<fpage>3585</fpage>–<lpage>7</lpage>.<pub-id pub-id-type="pmid">32105316</pub-id></mixed-citation>
    </ref>
    <ref id="btae063-B59">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Wang</surname><given-names>L</given-names></string-name>, <string-name><surname>Nie</surname><given-names>R</given-names></string-name>, <string-name><surname>Yu</surname><given-names>Z</given-names></string-name></person-group><etal>et al</etal><article-title>An interpretable deep-learning architecture of capsule networks for identifying cell-type gene expression programs from single-cell RNA-sequencing data</article-title>. <source>Nat Mach Intell</source><year>2020b</year>;<volume>2</volume>:<fpage>693</fpage>–<lpage>703</lpage>.</mixed-citation>
    </ref>
    <ref id="btae063-B60">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Wolf</surname><given-names>FA</given-names></string-name>, <string-name><surname>Angerer</surname><given-names>P</given-names></string-name>, <string-name><surname>Theis</surname><given-names>FJ.</given-names></string-name></person-group><article-title>SCANPY: large-scale single-cell gene expression data analysis</article-title>. <source>Genome Biol</source><year>2018</year>;<volume>19</volume>:<fpage>15</fpage>.<pub-id pub-id-type="pmid">29409532</pub-id></mixed-citation>
    </ref>
    <ref id="btae063-B61">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Xie</surname><given-names>P</given-names></string-name>, <string-name><surname>Gao</surname><given-names>M</given-names></string-name>, <string-name><surname>Wang</surname><given-names>C</given-names></string-name></person-group><etal>et al</etal><article-title>SuperCT: a supervised-learning framework for enhanced characterization of single-cell transcriptomic profiles</article-title>. <source>Nucleic Acids Res</source><year>2019</year>;<volume>47</volume>:<fpage>e48</fpage>.<pub-id pub-id-type="pmid">30799483</pub-id></mixed-citation>
    </ref>
    <ref id="btae063-B62">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Xu</surname><given-names>C</given-names></string-name>, <string-name><surname>Su</surname><given-names>Z.</given-names></string-name></person-group><article-title>Identification of cell types from single-cell transcriptomes using a novel clustering method</article-title>. <source>Bioinformatics</source><year>2015</year>;<volume>31</volume>:<fpage>1974</fpage>–<lpage>80</lpage>.<pub-id pub-id-type="pmid">25805722</pub-id></mixed-citation>
    </ref>
    <ref id="btae063-B63">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Yamashita</surname><given-names>R</given-names></string-name>, <string-name><surname>Nishio</surname><given-names>M</given-names></string-name>, <string-name><surname>Do</surname><given-names>RKG</given-names></string-name></person-group><etal>et al</etal><article-title>Convolutional neural networks: an overview and application in radiology</article-title>. <source>Insights Imaging</source><year>2018</year>;<volume>9</volume>:<fpage>611</fpage>–<lpage>29</lpage>.<pub-id pub-id-type="pmid">29934920</pub-id></mixed-citation>
    </ref>
    <ref id="btae063-B64">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Yang</surname><given-names>F</given-names></string-name>, <string-name><surname>Wang</surname><given-names>W</given-names></string-name>, <string-name><surname>Wang</surname><given-names>F</given-names></string-name></person-group><etal>et al</etal><article-title>scBERT as a large-scale pretrained deep language model for cell type annotation of single-cell RNA-seq data</article-title>. <source>Nat Mach Intell</source><year>2022</year>;<volume>4</volume>:<fpage>852</fpage>–<lpage>66</lpage>.</mixed-citation>
    </ref>
    <ref id="btae063-B65">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Yang</surname><given-names>K-T-T.</given-names></string-name></person-group><article-title>Artificial neural networks (ANNs): a new paradigm for thermal science and engineering</article-title>. <source>J Heat Transfer Trans ASME</source><year>2008</year>;<volume>130</volume>:<fpage>093001</fpage>.</mixed-citation>
    </ref>
    <ref id="btae063-B66">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Yin</surname><given-names>Q</given-names></string-name>, <string-name><surname>Liu</surname><given-names>Q</given-names></string-name>, <string-name><surname>Fu</surname><given-names>Z</given-names></string-name></person-group><etal>et al</etal><article-title>scGraph: a graph neural network-based approach to automatically identify cell types</article-title>. <source>Bioinformatics</source><year>2022</year>;<volume>38</volume>:<fpage>2996</fpage>–<lpage>3003</lpage>.<pub-id pub-id-type="pmid">35394015</pub-id></mixed-citation>
    </ref>
    <ref id="btae063-B67">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Zeng</surname><given-names>Y</given-names></string-name>, <string-name><surname>Wei</surname><given-names>Z</given-names></string-name>, <string-name><surname>Pan</surname><given-names>Z</given-names></string-name></person-group><etal>et al</etal><article-title>A robust and scalable graph neural network for accurate single-cell classification</article-title>. <source>Brief Bioinform</source><year>2022</year>;<volume>23</volume>:<fpage>bbab570</fpage>.<pub-id pub-id-type="pmid">35018408</pub-id></mixed-citation>
    </ref>
    <ref id="btae063-B68">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Zhou</surname><given-names>J</given-names></string-name>, <string-name><surname>Cui</surname><given-names>G</given-names></string-name>, <string-name><surname>Hu</surname><given-names>S</given-names></string-name></person-group><etal>et al</etal><article-title>Graph neural networks: a review of methods and applications</article-title>. <source>AI Open</source><year>2020</year>;<volume>1</volume>:<fpage>57</fpage>–<lpage>81</lpage>.</mixed-citation>
    </ref>
    <ref id="btae063-B69">
      <mixed-citation publication-type="book"><person-group person-group-type="author"><string-name><surname>Zhou</surname><given-names>Z-H.</given-names></string-name></person-group><source>Ensemble Methods Foundations and Algorithms</source>. United States: <publisher-name>CRC Press</publisher-name>, <year>2012</year>.</mixed-citation>
    </ref>
    <ref id="btae063-B70">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Žurauskienė</surname><given-names>J</given-names></string-name>, <string-name><surname>Yau</surname><given-names>C.</given-names></string-name></person-group><article-title>pcaReduce: hierarchical clustering of single cell transcriptional profiles</article-title>. <source>BMC Bioinformatics</source><year>2016</year>;<volume>17</volume>:<fpage>140</fpage>.<pub-id pub-id-type="pmid">27005807</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.2 20190208//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.2?>
<?ConverterInfo.XSLTName jats2jats3.xsl?>
<?ConverterInfo.Version 1?>
<?properties open_access?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">Bioinformatics</journal-id>
    <journal-id journal-id-type="publisher-id">bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1367-4803</issn>
    <issn pub-type="epub">1367-4811</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">10873586</article-id>
    <article-id pub-id-type="pmid">38317054</article-id>
    <article-id pub-id-type="doi">10.1093/bioinformatics/btae063</article-id>
    <article-id pub-id-type="publisher-id">btae063</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Original Paper</subject>
        <subj-group subj-group-type="category-toc-heading">
          <subject>Gene Expression</subject>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="category-taxonomy-collection">
        <subject>AcademicSubjects/SCI01060</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>CTISL: a dynamic stacking multi-class classification approach for identifying cell types from single-cell RNA-seq data</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Wang</surname>
          <given-names>Xiao</given-names>
        </name>
        <role vocab="credit" vocab-identifier="https://credit.niso.org" vocab-term="Data curation" vocab-term-identifier="https://credit.niso.org/contributor-roles/data-curation" degree-contribution="lead">Data curation</role>
        <role vocab="credit" vocab-identifier="https://credit.niso.org" vocab-term="Formal analysis" vocab-term-identifier="https://credit.niso.org/contributor-roles/formal-analysis" degree-contribution="lead">Formal analysis</role>
        <role vocab="credit" vocab-identifier="https://credit.niso.org" vocab-term="Methodology" vocab-term-identifier="https://credit.niso.org/contributor-roles/methodology" degree-contribution="lead">Methodology</role>
        <role vocab="credit" vocab-identifier="https://credit.niso.org" vocab-term="Software" vocab-term-identifier="https://credit.niso.org/contributor-roles/software" degree-contribution="lead">Software</role>
        <role vocab="credit" vocab-identifier="https://credit.niso.org" vocab-term="Validation" vocab-term-identifier="https://credit.niso.org/contributor-roles/validation" degree-contribution="lead">Validation</role>
        <role vocab="credit" vocab-identifier="https://credit.niso.org" vocab-term="Visualization" vocab-term-identifier="https://credit.niso.org/contributor-roles/visualization" degree-contribution="lead">Visualization</role>
        <role vocab="credit" vocab-identifier="https://credit.niso.org" vocab-term="Writing - original draft" vocab-term-identifier="https://credit.niso.org/contributor-roles/writing-original-draft" degree-contribution="lead">Writing - original draft</role>
        <role vocab="credit" vocab-identifier="https://credit.niso.org" vocab-term="Writing - review &amp; editing" vocab-term-identifier="https://credit.niso.org/contributor-roles/writing-review-editing" degree-contribution="equal">Writing - review &amp; editing</role>
        <aff><institution>Department of Software Engineering, College of Information Engineering, Northwest A&amp;F University</institution>, Yangling 712100, <country country="CN">China</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Chai</surname>
          <given-names>Ziyi</given-names>
        </name>
        <role vocab="credit" vocab-identifier="https://credit.niso.org" vocab-term="Data curation" vocab-term-identifier="https://credit.niso.org/contributor-roles/data-curation" degree-contribution="supporting">Data curation</role>
        <role vocab="credit" vocab-identifier="https://credit.niso.org" vocab-term="Methodology" vocab-term-identifier="https://credit.niso.org/contributor-roles/methodology" degree-contribution="supporting">Methodology</role>
        <aff><institution>Department of Software Engineering, College of Information Engineering, Northwest A&amp;F University</institution>, Yangling 712100, <country country="CN">China</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Li</surname>
          <given-names>Shaohua</given-names>
        </name>
        <role vocab="credit" vocab-identifier="https://credit.niso.org" vocab-term="Data curation" vocab-term-identifier="https://credit.niso.org/contributor-roles/data-curation" degree-contribution="supporting">Data curation</role>
        <role vocab="credit" vocab-identifier="https://credit.niso.org" vocab-term="Methodology" vocab-term-identifier="https://credit.niso.org/contributor-roles/methodology" degree-contribution="supporting">Methodology</role>
        <aff><institution>Department of Software Engineering, College of Information Engineering, Northwest A&amp;F University</institution>, Yangling 712100, <country country="CN">China</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0002-5331-3655</contrib-id>
        <name>
          <surname>Liu</surname>
          <given-names>Yan</given-names>
        </name>
        <role vocab="credit" vocab-identifier="https://credit.niso.org" vocab-term="Methodology" vocab-term-identifier="https://credit.niso.org/contributor-roles/methodology" degree-contribution="supporting">Methodology</role>
        <role vocab="credit" vocab-identifier="https://credit.niso.org" vocab-term="Writing - review &amp; editing" vocab-term-identifier="https://credit.niso.org/contributor-roles/writing-review-editing" degree-contribution="supporting">Writing - review &amp; editing</role>
        <aff><institution>School of Computer Science and Engineering, Nanjing University of Science and Technology</institution>, Nanjing 210094, <country country="CN">China</country></aff>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0002-1847-754X</contrib-id>
        <name>
          <surname>Li</surname>
          <given-names>Chen</given-names>
        </name>
        <role vocab="credit" vocab-identifier="https://credit.niso.org" vocab-term="Conceptualization" vocab-term-identifier="https://credit.niso.org/contributor-roles/conceptualization" degree-contribution="equal">Conceptualization</role>
        <role vocab="credit" vocab-identifier="https://credit.niso.org" vocab-term="Investigation" vocab-term-identifier="https://credit.niso.org/contributor-roles/investigation" degree-contribution="equal">Investigation</role>
        <role vocab="credit" vocab-identifier="https://credit.niso.org" vocab-term="Supervision" vocab-term-identifier="https://credit.niso.org/contributor-roles/supervision" degree-contribution="equal">Supervision</role>
        <role vocab="credit" vocab-identifier="https://credit.niso.org" vocab-term="Visualization" vocab-term-identifier="https://credit.niso.org/contributor-roles/visualization" degree-contribution="lead">Visualization</role>
        <role vocab="credit" vocab-identifier="https://credit.niso.org" vocab-term="Writing - original draft" vocab-term-identifier="https://credit.niso.org/contributor-roles/writing-original-draft" degree-contribution="equal">Writing - original draft</role>
        <role vocab="credit" vocab-identifier="https://credit.niso.org" vocab-term="Writing - review &amp; editing" vocab-term-identifier="https://credit.niso.org/contributor-roles/writing-review-editing" degree-contribution="lead">Writing - review &amp; editing</role>
        <aff><institution>Department of Biochemistry and Molecular Biology, Monash University</institution>, Melbourne, VIC 3800, <country country="AU">Australia</country></aff>
        <xref rid="btae063-cor1" ref-type="corresp"/>
        <!--chen.li@monash.edu-->
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0003-4821-3585</contrib-id>
        <name>
          <surname>Jiang</surname>
          <given-names>Yu</given-names>
        </name>
        <role vocab="credit" vocab-identifier="https://credit.niso.org" vocab-term="Conceptualization" vocab-term-identifier="https://credit.niso.org/contributor-roles/conceptualization" degree-contribution="equal">Conceptualization</role>
        <role vocab="credit" vocab-identifier="https://credit.niso.org" vocab-term="Investigation" vocab-term-identifier="https://credit.niso.org/contributor-roles/investigation" degree-contribution="equal">Investigation</role>
        <role vocab="credit" vocab-identifier="https://credit.niso.org" vocab-term="Supervision" vocab-term-identifier="https://credit.niso.org/contributor-roles/supervision" degree-contribution="equal">Supervision</role>
        <role vocab="credit" vocab-identifier="https://credit.niso.org" vocab-term="Visualization" vocab-term-identifier="https://credit.niso.org/contributor-roles/visualization" degree-contribution="equal">Visualization</role>
        <role vocab="credit" vocab-identifier="https://credit.niso.org" vocab-term="Writing - review &amp; editing" vocab-term-identifier="https://credit.niso.org/contributor-roles/writing-review-editing" degree-contribution="equal">Writing - review &amp; editing</role>
        <aff><institution>Department of Animal Genetics, Breeding and Reproduction, College of Animal Science and Technology, Northwest A&amp;F University</institution>, Yangling 712100, <country country="CN">China</country></aff>
        <xref rid="btae063-cor3" ref-type="corresp"/>
        <!--yu.jiang@nwafu.edu.cn-->
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <name>
          <surname>Liu</surname>
          <given-names>Quanzhong</given-names>
        </name>
        <role vocab="credit" vocab-identifier="https://credit.niso.org" vocab-term="Conceptualization" vocab-term-identifier="https://credit.niso.org/contributor-roles/conceptualization" degree-contribution="lead">Conceptualization</role>
        <role vocab="credit" vocab-identifier="https://credit.niso.org" vocab-term="Funding acquisition" vocab-term-identifier="https://credit.niso.org/contributor-roles/funding-acquisition" degree-contribution="lead">Funding acquisition</role>
        <role vocab="credit" vocab-identifier="https://credit.niso.org" vocab-term="Investigation" vocab-term-identifier="https://credit.niso.org/contributor-roles/investigation" degree-contribution="lead">Investigation</role>
        <role vocab="credit" vocab-identifier="https://credit.niso.org" vocab-term="Supervision" vocab-term-identifier="https://credit.niso.org/contributor-roles/supervision" degree-contribution="lead">Supervision</role>
        <role vocab="credit" vocab-identifier="https://credit.niso.org" vocab-term="Visualization" vocab-term-identifier="https://credit.niso.org/contributor-roles/visualization" degree-contribution="supporting">Visualization</role>
        <role vocab="credit" vocab-identifier="https://credit.niso.org" vocab-term="Writing - original draft" vocab-term-identifier="https://credit.niso.org/contributor-roles/writing-original-draft" degree-contribution="equal">Writing - original draft</role>
        <role vocab="credit" vocab-identifier="https://credit.niso.org" vocab-term="Writing - review &amp; editing" vocab-term-identifier="https://credit.niso.org/contributor-roles/writing-review-editing" degree-contribution="equal">Writing - review &amp; editing</role>
        <aff><institution>Department of Software Engineering, College of Information Engineering, Northwest A&amp;F University</institution>, Yangling 712100, <country country="CN">China</country></aff>
        <aff><institution>Shaanxi Engineering Research Center of Agricultural Information Intelligent Perception and Analysis, Northwest A&amp;F University</institution>, Yangling 712100, <country country="CN">China</country></aff>
        <xref rid="btae063-cor2" ref-type="corresp"/>
        <!--liuqzhong@nwafu.edu.cn-->
      </contrib>
    </contrib-group>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Mathelier</surname>
          <given-names>Anthony</given-names>
        </name>
        <role>Associate Editor</role>
      </contrib>
    </contrib-group>
    <author-notes>
      <corresp id="btae063-cor1">Corresponding authors. Department of Biochemistry and Molecular Biology, Monash University, Melbourne, VIC 3800, Australia. E-mail <email>chen.li@monash.edu</email> (C.L.)</corresp>
      <corresp id="btae063-cor2">Department of Software Engineering, College of Information Engineering, Northwest A&amp;F University, Yangling 712100, China. E-mail: <email>liuqzhong@nwafu.edu.cn</email> (Q.L.)</corresp>
      <corresp id="btae063-cor3">Department of Animal Genetics, Breeding and Reproduction, College of Animal Science and Technology, Northwest A&amp;F University, Yangling 712100, China. E-mail: <email>yu.jiang@nwafu.edu.cn</email> (Y.J.)</corresp>
    </author-notes>
    <pub-date pub-type="collection">
      <month>2</month>
      <year>2024</year>
    </pub-date>
    <pub-date pub-type="epub" iso-8601-date="2024-02-05">
      <day>05</day>
      <month>2</month>
      <year>2024</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>05</day>
      <month>2</month>
      <year>2024</year>
    </pub-date>
    <volume>40</volume>
    <issue>2</issue>
    <elocation-id>btae063</elocation-id>
    <history>
      <date date-type="received">
        <day>15</day>
        <month>2</month>
        <year>2024</year>
      </date>
      <date date-type="rev-recd">
        <day>15</day>
        <month>2</month>
        <year>2024</year>
      </date>
      <date date-type="editorial-decision">
        <day>15</day>
        <month>2</month>
        <year>2024</year>
      </date>
      <date date-type="accepted">
        <day>15</day>
        <month>2</month>
        <year>2024</year>
      </date>
      <date date-type="corrected-typeset">
        <day>15</day>
        <month>2</month>
        <year>2024</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2024. Published by Oxford University Press.</copyright-statement>
      <copyright-year>2024</copyright-year>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">https://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted reuse, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <self-uri xlink:href="btae063.pdf"/>
    <abstract>
      <title>Abstract</title>
      <sec id="s1">
        <title>Motivation</title>
        <p>Effective identification of cell types is of critical importance in single-cell RNA-sequencing (scRNA-seq) data analysis. To date, many supervised machine learning-based predictors have been implemented to identify cell types from scRNA-seq datasets. Despite the technical advances of these state-of-the-art tools, most existing predictors were single classifiers, of which the performances can still be significantly improved. It is therefore highly desirable to employ the ensemble learning strategy to develop more accurate computational models for robust and comprehensive identification of cell types on scRNA-seq datasets.</p>
      </sec>
      <sec id="s2">
        <title>Results</title>
        <p>We propose a two-layer stacking model, termed CTISL (Cell Type Identification by Stacking ensemble Learning), which integrates multiple classifiers to identify cell types. In the first layer, given a reference scRNA-seq dataset with known cell types, CTISL dynamically combines multiple cell-type-specific classifiers (i.e. support-vector machine and logistic regression) as the base learners to deliver the outcomes for the input of a meta-classifier in the second layer. We conducted a total of 24 benchmarking experiments on 17 human and mouse scRNA-seq datasets to evaluate and compare the prediction performance of CTISL and other state-of-the-art predictors. The experiment results demonstrate that CTISL achieves superior or competitive performance compared to these state-of-the-art approaches. We anticipate that CTISL can serve as a useful and reliable tool for cost-effective identification of cell types from scRNA-seq datasets.</p>
      </sec>
      <sec id="s3">
        <title>Availability and implementation</title>
        <p>The webserver and source code are freely available at <ext-link xlink:href="http://bigdata.biocie.cn/CTISLweb/home" ext-link-type="uri">http://bigdata.biocie.cn/CTISLweb/home</ext-link> and <ext-link xlink:href="https://zenodo.org/records/10568906" ext-link-type="uri">https://zenodo.org/records/10568906</ext-link>, respectively.</p>
      </sec>
    </abstract>
    <funding-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>National Key Research and Development Program of China</institution>
            <institution-id institution-id-type="DOI">10.13039/501100012166</institution-id>
          </institution-wrap>
        </funding-source>
        <award-id>2022YFF1000100</award-id>
      </award-group>
    </funding-group>
    <counts>
      <page-count count="10"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec>
    <title>1 Introduction</title>
    <p>Single-cell RNA (scRNA)-seq techniques have been widely applied to profile transcriptomic data at the single-cell level (<xref rid="btae063-B55" ref-type="bibr">Tang <italic toggle="yes">et al.</italic> 2009</xref>). Identification of the cell types has therefore become a critical step in scRNA-seq data analysis (<xref rid="btae063-B26" ref-type="bibr">Huang and Zhang 2021</xref>). Traditionally, the types of cells were annotated based on their shapes, sizes, and other features observed via microscope anatomy, histology, and pathology (<xref rid="btae063-B5" ref-type="bibr">Arendt <italic toggle="yes">et al.</italic> 2016</xref>, <xref rid="btae063-B29" ref-type="bibr">Kiselev <italic toggle="yes">et al.</italic> 2019</xref>). The advances in scRNA-seq techniques have allowed the fast accumulation of sequencing data, which requires the assistance of computational and artificial intelligence-guided approaches for the accurate and robust annotation of cell types (<xref rid="btae063-B39" ref-type="bibr">Ma <italic toggle="yes">et al.</italic> 2021</xref>, <xref rid="btae063-B54" ref-type="bibr">Sun <italic toggle="yes">et al.</italic> 2022</xref>). Particularly, machine learning (ML)-based approaches have shown their great capability of handling large-scale datasets for annotating cell types. In recent years, various ML-based approaches have been developed to annotate cell types using scRNA-seq datasets. These methods can be broadly classified into two main categories: unsupervised and supervised approaches.</p>
    <p>Unsupervised methods, such as RaceID (<xref rid="btae063-B22" ref-type="bibr">Grün <italic toggle="yes">et al.</italic> 2015</xref>), SNN-Cliq (<xref rid="btae063-B62" ref-type="bibr">Xu and Su 2015</xref>), SINCERA (<xref rid="btae063-B23" ref-type="bibr">Guo <italic toggle="yes">et al.</italic> 2015</xref>), pcaReduce (<xref rid="btae063-B70" ref-type="bibr">Žurauskienė and Yau 2016</xref>), GiniClust (<xref rid="btae063-B28" ref-type="bibr">Jiang <italic toggle="yes">et al.</italic> 2016</xref>), SIMLR (<xref rid="btae063-B57" ref-type="bibr">Wang <italic toggle="yes">et al.</italic> 2017</xref>), SC3 (<xref rid="btae063-B30" ref-type="bibr">Kiselev <italic toggle="yes">et al.</italic> 2017</xref>), SCENIC (<xref rid="btae063-B2" ref-type="bibr">Aibar <italic toggle="yes">et al.</italic> 2017</xref>), Scanpy (<xref rid="btae063-B60" ref-type="bibr">Wolf <italic toggle="yes">et al.</italic> 2018</xref>), and SCENA (<xref rid="btae063-B14" ref-type="bibr">Cui <italic toggle="yes">et al.</italic> 2021</xref>), cluster cells into different groups using various methods, e.g. <italic toggle="yes">K</italic>-means (<xref rid="btae063-B10" ref-type="bibr">Celebi <italic toggle="yes">et al.</italic> 2013</xref>), Shared Nearest Neighbor (<xref rid="btae063-B18" ref-type="bibr">Ertoz <italic toggle="yes">et al.</italic> 2002</xref>), and cluster-based similarity partitioning algorithm (<xref rid="btae063-B53" ref-type="bibr">Strehl and Ghosh 2003</xref>). Although unsupervised clustering-based methods achieved outstanding performances in annotating cell types, many challenges remain (<xref rid="btae063-B29" ref-type="bibr">Kiselev <italic toggle="yes">et al.</italic> 2019</xref>), such as the ambiguous number of cell-type clusters (<xref rid="btae063-B46" ref-type="bibr">Qi <italic toggle="yes">et al.</italic> 2020</xref>), model and parameter dependency (<xref rid="btae063-B61" ref-type="bibr">Xie <italic toggle="yes">et al.</italic> 2019</xref>), unsatisfactory performance on imbalanced clusters (<xref rid="btae063-B39" ref-type="bibr">Ma <italic toggle="yes">et al.</italic> 2021</xref>), and poor reproducibility (<xref rid="btae063-B11" ref-type="bibr">Chen <italic toggle="yes">et al.</italic> 2022</xref>). Moreover, unsupervised methods are usually constructed based on the assumption that all cells in each cluster belong to the same cell type. In fact, a cluster is often mixed with a major cell type and small percentages of other cell types (<xref rid="btae063-B3" ref-type="bibr">Alquicira-Hernandez <italic toggle="yes">et al.</italic> 2019</xref>), which makes it challenging to effectively annotate cell types in such clusters (<xref rid="btae063-B29" ref-type="bibr">Kiselev <italic toggle="yes">et al.</italic> 2019</xref>, <xref rid="btae063-B44" ref-type="bibr">Pliner <italic toggle="yes">et al.</italic> 2019</xref>).</p>
    <p>Supervised ML-based methods, on the other hand, have been increasingly popular in recent years (<xref rid="btae063-B39" ref-type="bibr">Ma <italic toggle="yes">et al.</italic> 2021</xref>). These supervised methods can be further classified into two categories: traditional ML- and deep learning (DL)-based approaches. Traditional ML-based approaches, such as scPred (<xref rid="btae063-B3" ref-type="bibr">Alquicira-Hernandez <italic toggle="yes">et al.</italic> 2019</xref>), scClassify (<xref rid="btae063-B35" ref-type="bibr">Lin <italic toggle="yes">et al.</italic> 2020</xref>), ELSA (<xref rid="btae063-B58" ref-type="bibr">Wang <italic toggle="yes">et al.</italic> 2020</xref>a), scDetect (<xref rid="btae063-B52" ref-type="bibr">Shen <italic toggle="yes">et al.</italic> 2021</xref>), CellTypist (<xref rid="btae063-B17" ref-type="bibr">Domínguez Conde <italic toggle="yes">et al.</italic> 2022</xref>), scmap (<xref rid="btae063-B31" ref-type="bibr">Kiselev <italic toggle="yes">et al.</italic> 2018</xref>), SingleR (<xref rid="btae063-B4" ref-type="bibr">Aran <italic toggle="yes">et al.</italic> 2019</xref>), and scAnnotatR (<xref rid="btae063-B42" ref-type="bibr">Nguyen and Griss 2022</xref>), often employ classic ML models, such as Support-Vector Machines (SVM) (<xref rid="btae063-B12" ref-type="bibr">Cortes and Vapnik 1995</xref>), <italic toggle="yes">K</italic>-Nearest Neighbors (<xref rid="btae063-B13" ref-type="bibr">Cover and Hart 1967</xref>), Random Forest (RF) (<xref rid="btae063-B8" ref-type="bibr">Breiman 2001</xref>), Logistic Regression (LR) (<xref rid="btae063-B41" ref-type="bibr">Lecessie and van Houwelingen 1992</xref>), and Bootstrap (<xref rid="btae063-B21" ref-type="bibr">Fushiki 2010</xref>), etc. While DL-based approaches employ state-of-the-art neural network-based algorithms, including Artificial Neural Networks (<xref rid="btae063-B65" ref-type="bibr">Yang 2008</xref>), Convolutional Neural Networks (<xref rid="btae063-B63" ref-type="bibr">Yamashita <italic toggle="yes">et al.</italic> 2018</xref>), Deep Neural Networks (<xref rid="btae063-B50" ref-type="bibr">Samek <italic toggle="yes">et al.</italic> 2021</xref>), Capsule Neural Networks (<xref rid="btae063-B49" ref-type="bibr">Sabour <italic toggle="yes">et al.</italic> 2017</xref>), and Graph Neural Networks (<xref rid="btae063-B68" ref-type="bibr">Zhou <italic toggle="yes">et al.</italic> 2020</xref>), to achieve superior annotation performance. Representative DL-based approaches include SuperCT (<xref rid="btae063-B61" ref-type="bibr">Xie <italic toggle="yes">et al.</italic> 2019</xref>), ACTINN (<xref rid="btae063-B38" ref-type="bibr">Ma and Pellegrini 2020</xref>), scCapsNet (<xref rid="btae063-B58" ref-type="bibr">Wang <italic toggle="yes">et al.</italic> 2020</xref>b), scGraph (<xref rid="btae063-B66" ref-type="bibr">Yin <italic toggle="yes">et al.</italic> 2022</xref>), GraphCS (<xref rid="btae063-B67" ref-type="bibr">Zeng <italic toggle="yes">et al.</italic> 2022</xref>), TripletCell (<xref rid="btae063-B36" ref-type="bibr">Liu <italic toggle="yes">et al.</italic> 2023</xref>), scBERT (<xref rid="btae063-B64" ref-type="bibr">Yang <italic toggle="yes">et al.</italic> 2022</xref>), and scDeepInsight (<xref rid="btae063-B27" ref-type="bibr">Jia <italic toggle="yes">et al.</italic> 2023</xref>).</p>
    <p>Some comprehensive reviews have thoroughly evaluated a number of supervised models for the identification of cell types (<xref rid="btae063-B1" ref-type="bibr">Abdelaal <italic toggle="yes">et al.</italic> 2019</xref>, <xref rid="btae063-B26" ref-type="bibr">Huang and Zhang 2021</xref>, <xref rid="btae063-B39" ref-type="bibr">Ma <italic toggle="yes">et al.</italic> 2021</xref>). Most supervised-based methods first used a scRNA-seq dataset with known cell types to train a multi-class classification model and then loaded the trained model to predict the type of each cell in a new scRNA-seq dataset. Despite that supervised methods generally outperform unsupervised cell clustering methods (<xref rid="btae063-B39" ref-type="bibr">Ma <italic toggle="yes">et al.</italic> 2021</xref>), most of these supervised methods are based on a single classifier. On the other hand, it has been widely accepted that ensemble multiple classifiers usually outperform the performance of a single learner (<xref rid="btae063-B69" ref-type="bibr">Zhou 2012</xref>). For example, scDetect (<xref rid="btae063-B52" ref-type="bibr">Shen <italic toggle="yes">et al.</italic> 2021</xref>) achieved outstanding cell-type identification performance by implementing multiple <italic toggle="yes">k</italic>-Top Scoring Pairs classifiers with a weighted majority voting strategy to identify cell types from scRNA-seq data.</p>
    <p>In this study, we developed a two-layer dynamic ensemble learning model, termed CTISL (Cell Type Identification by Stacking ensemble Learning), for accurate cell-type prediction in scRNA-seq data. In CTISL, cell-type identification is regarded as a multi-class classification task. A variety of features were extracted to build multiple base learners for different cell-type categories. We selected the best-performing classifiers as base learners in CTISL according to our extensive experiments and a recent study evaluating the performance of various individual classifiers in cell-type identification using scRNA-seq datasets (<xref rid="btae063-B26" ref-type="bibr">Huang and Zhang 2021</xref>). Our extensive performance benchmarking experiments on scRNA-seq datasets of various species, tissues, batches, and protocols show that CTISL achieved outstanding performance and strong stability compared to state-of-the-art traditional ML and DL methods, demonstrating that the stacking ensemble learning technique is an effective approach to achieving more robust performance for cell-type annotation. Overall, our dynamic ensemble learning model provides a promising approach for accurately identifying cell types in scRNA-seq datasets, with the potential to advance biomedical research and clinical applications.</p>
  </sec>
  <sec>
    <title>2 Materials and methods</title>
    <sec>
      <title>2.1 Dataset collection</title>
      <p>We collected in total 17 scRNA-seq datasets of two species (<italic toggle="yes">Homo sapiens</italic> and <italic toggle="yes">Mus musculus</italic>) from various tissues, batches, and protocols to train and evaluate CTISL and other benchmarked methods. Among these datasets, seven are derived from human peripheral blood mononuclear cell (PBMC) samples (<xref rid="btae063-B16" ref-type="bibr">Ding <italic toggle="yes">et al.</italic> 2020</xref>) and were used for inter- and intra-dataset evaluations. Several pairs of datasets with different batches were extracted from various cells, including human blood dendritic cells (<xref rid="btae063-B56" ref-type="bibr">Villani <italic toggle="yes">et al.</italic> 2017</xref>), namely Dendritic_batch1 and Dendritic_batch2, and mouse retinal bipolar cells (<xref rid="btae063-B51" ref-type="bibr">Shekhar <italic toggle="yes">et al.</italic> 2016</xref>), namely Retina(5)_batch1 and Retina(5)_batch2, and Retina(19)_batch1 and Retina(19)_batch2. Each of the three pairs was used for cross-batch evaluations. In addition, two datasets from human and mouse airway (<xref rid="btae063-B43" ref-type="bibr">Plasschaert <italic toggle="yes">et al.</italic> 2018</xref>) and pancreas (<xref rid="btae063-B6" ref-type="bibr">Baron <italic toggle="yes">et al.</italic> 2016</xref>) were extracted, namely “HumanAirway,” “MouseAirway,” “HumanPancreas,” and “MousePancreas,” respectively. Each pair of datasets is from the same tissue of two species and was used for cross-species evaluations. A detailed description of these 17 scRNA-seq datasets is provided in <xref rid="sup1" ref-type="supplementary-material">Supplementary Table S1</xref>.</p>
    </sec>
    <sec>
      <title>2.2 The CTISL framework</title>
      <p>As illustrated in <xref rid="btae063-F1" ref-type="fig">Fig. 1</xref>, the construction of CTISL consists of four steps: dataset pre-processing, feature selection, stacking model construction, and model evaluation.</p>
      <fig position="float" id="btae063-F1">
        <label>Figure 1.</label>
        <caption>
          <p>The construction of the CTISL framework includes four major steps, including (A) dataset pre-processing, (B) feature selection, (C) dynamic stacking model construction, and (D) model evaluation.</p>
        </caption>
        <graphic xlink:href="btae063f1" position="float"/>
      </fig>
      <p><bold>Step 1. Dataset pre-processing:</bold> We employed the Scanpy package (<xref rid="btae063-B60" ref-type="bibr">Wolf <italic toggle="yes">et al.</italic> 2018</xref>) to perform scRNA-seq data pre-processing (<xref rid="btae063-F1" ref-type="fig">Fig. 1A</xref>). In the cell normalization step, the expression value of each gene in each cell was divided by the total sum of gene expression values in that cell and then multiplied by a constant 10e4. Other pre-processing steps remain consistent with the previous study (<xref rid="btae063-B25" ref-type="bibr">Hu <italic toggle="yes">et al.</italic> 2020</xref>). Note that the dataset pre-processing step is performed separately for training and testing datasets.</p>
      <p><bold>Step 2. Feature selection:</bold> A scRNA-seq dataset <inline-formula id="IE1"><mml:math id="IM1" display="inline" overflow="scroll"><mml:mi mathvariant="normal">D</mml:mi></mml:math></inline-formula> can be represented as an <inline-formula id="IE2"><mml:math id="IM2" display="inline" overflow="scroll"><mml:mi>n</mml:mi><mml:mo>×</mml:mo><mml:mi>m</mml:mi></mml:math></inline-formula> matrix, where <inline-formula id="IE3"><mml:math id="IM3" display="inline" overflow="scroll"><mml:mi>n</mml:mi></mml:math></inline-formula> and <inline-formula id="IE4"><mml:math id="IM4" display="inline" overflow="scroll"><mml:mi>m</mml:mi></mml:math></inline-formula> are the numbers of cells and genes, respectively. <inline-formula id="IE5"><mml:math id="IM5" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>D</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mfenced open="(" close=")" separators="|"><mml:mrow><mml:mn>1</mml:mn><mml:mo>≤</mml:mo><mml:mi>i</mml:mi><mml:mo>≤</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:mfenced></mml:math></inline-formula> represents the <italic toggle="yes">i</italic>-th cell, and <inline-formula id="IE6"><mml:math id="IM6" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>D</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mfenced open="(" close=")" separators="|"><mml:mrow><mml:mn>1</mml:mn><mml:mo>≤</mml:mo><mml:mi>i</mml:mi><mml:mo>≤</mml:mo><mml:mi>n</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="normal"> </mml:mi><mml:mn>1</mml:mn><mml:mo>≤</mml:mo><mml:mi>j</mml:mi><mml:mo>≤</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:mfenced></mml:math></inline-formula> denotes the expression value of the <inline-formula id="IE7"><mml:math id="IM7" display="inline" overflow="scroll"><mml:mi>j</mml:mi></mml:math></inline-formula>-th gene in <inline-formula id="IE8"><mml:math id="IM8" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>D</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula>. As there is usually more than one cell type in <inline-formula id="IE9"><mml:math id="IM9" display="inline" overflow="scroll"><mml:mi>D</mml:mi></mml:math></inline-formula>, cell-type identification is formulated as a multi-class classification task. Generally, <inline-formula id="IE10"><mml:math id="IM10" display="inline" overflow="scroll"><mml:mi>D</mml:mi></mml:math></inline-formula> contains high-dimensional features (genes) and small size of samples (cells). The high number of redundant genes might decrease the predictive performance of the model. To find a better gene subset for identifying cell types, we employed χ<sup>2</sup> (<xref rid="btae063-B19" ref-type="bibr">Forman 2003</xref>), a popular feature selection method, to select the genes related to cell types. Suppose <inline-formula id="IE11"><mml:math id="IM11" display="inline" overflow="scroll"><mml:mi>D</mml:mi></mml:math></inline-formula> contains <italic toggle="yes">t</italic> cell types, and<inline-formula id="IE12"><mml:math id="IM12" display="inline" overflow="scroll"><mml:mi mathvariant="normal"> </mml:mi><mml:mi>C</mml:mi></mml:math></inline-formula> represents the set of cell types, the procedure of feature selection (<xref rid="btae063-F1" ref-type="fig">Fig. 1B</xref>) is described as follows: (i) a dataset <inline-formula id="IE13"><mml:math id="IM13" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:mi>D</mml:mi></mml:mrow><mml:mrow><mml:mi>′</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> with two classes was constructed for each cell type <inline-formula id="IE14"><mml:math id="IM14" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mi mathvariant="normal"> </mml:mi><mml:mfenced open="(" close=")" separators="|"><mml:mrow><mml:mn>1</mml:mn><mml:mo>≤</mml:mo><mml:mi>k</mml:mi><mml:mo>≤</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:mfenced></mml:math></inline-formula>—samples with the cell type of <inline-formula id="IE15"><mml:math id="IM15" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> are regarded as the positive class of <inline-formula id="IE16"><mml:math id="IM16" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:mi>D</mml:mi></mml:mrow><mml:mrow><mml:mi>′</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula>, and remaining samples as the negative class; and (ii) χ<sup>2</sup> was employed to select the top 300 genes with stronger identification ability of <inline-formula id="IE17"><mml:math id="IM17" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula>, and let <inline-formula id="IE18"><mml:math id="IM18" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> denote the set of these 300 genes. We then repeated the above two steps until each <inline-formula id="IE19"><mml:math id="IM19" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mfenced open="(" close=")" separators="|"><mml:mrow><mml:mn>1</mml:mn><mml:mo>≤</mml:mo><mml:mi>k</mml:mi><mml:mo>≤</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:mfenced></mml:math></inline-formula> was obtained as informative genes for the cell type of <inline-formula id="IE20"><mml:math id="IM20" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula>.</p>
      <p><bold>Step 3. Stacking model construction:</bold> Among traditional ML-based methods, SVM with the radial basis function (RBF) or linear kernel, and LR classifiers achieved generally better performances than other classifiers in annotating cell types (<xref rid="btae063-B1" ref-type="bibr">Abdelaal <italic toggle="yes">et al.</italic> 2019</xref>, <xref rid="btae063-B3" ref-type="bibr">Alquicira-Hernandez <italic toggle="yes">et al.</italic> 2019</xref>, <xref rid="btae063-B26" ref-type="bibr">Huang and Zhang 2021</xref>, <xref rid="btae063-B39" ref-type="bibr">Ma <italic toggle="yes">et al.</italic> 2021</xref>). In this work, we employed the stacking strategy (<xref rid="btae063-B69" ref-type="bibr">Zhou 2012</xref>) to integrate SVM and LR classifiers as individual base learners. It has been demonstrated that the stacking approach can achieve powerful performance in various bioinformatic tasks, such as anti-cancer peptide identification (<xref rid="btae063-B34" ref-type="bibr">Liang <italic toggle="yes">et al.</italic> 2021</xref>), prokaryotic lysine acetylation site prediction (<xref rid="btae063-B7" ref-type="bibr">Basith <italic toggle="yes">et al.</italic> 2022</xref>), and long ncRNA subcellular localization prediction (<xref rid="btae063-B9" ref-type="bibr">Cao <italic toggle="yes">et al.</italic> 2018</xref>). In addition, to conduct a more comprehensive study, we integrated another two base learners, including RF (<xref rid="btae063-B8" ref-type="bibr">Breiman 2001</xref>) and gradient boosting classifier (GBC) (<xref rid="btae063-B20" ref-type="bibr">Friedman 2001</xref>). We also built other variations for our CTISL framework, including χ<sup>2</sup> with multilayer perceptron (<xref rid="btae063-B45" ref-type="bibr">Popescu <italic toggle="yes">et al.</italic> 2009</xref>) (χ<sup>2</sup>+MLP) and CTISL with marker genes. Refer to <xref rid="sup1" ref-type="supplementary-material">Supplementary Section S1</xref> for more information. In this work, we constructed two layers of stacking ensemble models. The first layer combines SVM and LR as the base classifiers via the stacking strategy and the second level employs LR as the meta-classifier fed by the outputs of the stacking layer. Details of the procedure are described as follows (<xref rid="btae063-F1" ref-type="fig">Fig. 1C</xref>). In the first step, given a scRNA-seq dataset <inline-formula id="IE21"><mml:math id="IM21" display="inline" overflow="scroll"><mml:mi>D</mml:mi></mml:math></inline-formula> with <inline-formula id="IE22"><mml:math id="IM22" display="inline" overflow="scroll"><mml:mi>n</mml:mi></mml:math></inline-formula> cells and the set <inline-formula id="IE23"><mml:math id="IM23" display="inline" overflow="scroll"><mml:mi>C</mml:mi></mml:math></inline-formula> with <italic toggle="yes">t</italic> kinds of cell types, we obtained a set of informative genes <inline-formula id="IE24"><mml:math id="IM24" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mfenced open="(" close=")" separators="|"><mml:mrow><mml:mn>1</mml:mn><mml:mo>≤</mml:mo><mml:mi>k</mml:mi><mml:mo>≤</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:mfenced><mml:mi mathvariant="normal"> </mml:mi></mml:math></inline-formula>for the cell type of <inline-formula id="IE25"><mml:math id="IM25" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mfenced open="(" close=")" separators="|"><mml:mrow><mml:mn>1</mml:mn><mml:mo>≤</mml:mo><mml:mi>k</mml:mi><mml:mo>≤</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:mfenced><mml:mi mathvariant="normal"> </mml:mi></mml:math></inline-formula>using the proposed feature selection strategy. Subsequently, we extracted these gene columns in <inline-formula id="IE26"><mml:math id="IM26" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> and removed other genes from <inline-formula id="IE27"><mml:math id="IM27" display="inline" overflow="scroll"><mml:mi>D</mml:mi></mml:math></inline-formula> to form a sub-dataset <inline-formula id="IE28"><mml:math id="IM28" display="inline" overflow="scroll"><mml:mi>D</mml:mi><mml:mfenced open="(" close=")" separators="|"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:mfenced></mml:math></inline-formula>. In the second step, to avoid overfitting, we implemented our ensemble strategy using the stacking cross-validation algorithm provided in the “mlxtend” package (<xref rid="btae063-B47" ref-type="bibr">Raschka 2018</xref>). In this procedure, <inline-formula id="IE29"><mml:math id="IM29" display="inline" overflow="scroll"><mml:mi>D</mml:mi><mml:mfenced open="(" close=")" separators="|"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:mfenced><mml:mi mathvariant="normal"> </mml:mi></mml:math></inline-formula>was first split into 3-folds. The first-level classifier SVM with RBF kernel was trained on the 2-folds, and prediction results (<inline-formula id="IE30"><mml:math id="IM30" display="inline" overflow="scroll"><mml:mi>t</mml:mi></mml:math></inline-formula> probability values) on the remaining fold as new features of the fold. After three rounds, <inline-formula id="IE31"><mml:math id="IM31" display="inline" overflow="scroll"><mml:mi>D</mml:mi><mml:mfenced open="(" close=")" separators="|"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:mfenced><mml:mi mathvariant="normal"> </mml:mi></mml:math></inline-formula>was transformed into a new dataset <inline-formula id="IE32"><mml:math id="IM32" display="inline" overflow="scroll"><mml:mi>D</mml:mi><mml:mi mathvariant="normal">'</mml:mi><mml:mfenced open="(" close=")" separators="|"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:mfenced><mml:mi mathvariant="normal"> </mml:mi></mml:math></inline-formula>with <inline-formula id="IE33"><mml:math id="IM33" display="inline" overflow="scroll"><mml:mi>t</mml:mi></mml:math></inline-formula> features. The same procedure was used to fit the first layer LR classifier. Thus, <inline-formula id="IE34"><mml:math id="IM34" display="inline" overflow="scroll"><mml:mi>D</mml:mi><mml:mfenced open="(" close=")" separators="|"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:mfenced><mml:mi mathvariant="normal"> </mml:mi></mml:math></inline-formula>was transformed into a new dataset <inline-formula id="IE35"><mml:math id="IM35" display="inline" overflow="scroll"><mml:mi>D</mml:mi><mml:mi mathvariant="normal">'</mml:mi><mml:mfenced open="(" close=")" separators="|"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:mfenced><mml:mi mathvariant="normal"> </mml:mi></mml:math></inline-formula>with <inline-formula id="IE36"><mml:math id="IM36" display="inline" overflow="scroll"><mml:mn>2</mml:mn><mml:mi>t</mml:mi></mml:math></inline-formula> features through the first layer classifiers. After repeating the above two steps for each <inline-formula id="IE37"><mml:math id="IM37" display="inline" overflow="scroll"><mml:mi>D</mml:mi><mml:mfenced open="(" close=")" separators="|"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:mfenced><mml:mo>,</mml:mo><mml:mfenced open="(" close=")" separators="|"><mml:mrow><mml:mn>1</mml:mn><mml:mo>≤</mml:mo><mml:mi>k</mml:mi><mml:mo>≤</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:mfenced></mml:math></inline-formula>, <inline-formula id="IE38"><mml:math id="IM38" display="inline" overflow="scroll"><mml:mi>D</mml:mi></mml:math></inline-formula> was transformed into a new dataset <inline-formula id="IE39"><mml:math id="IM39" display="inline" overflow="scroll"><mml:mi>D</mml:mi><mml:mi mathvariant="normal">′</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:msubsup><mml:mi>U</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msubsup></mml:mrow><mml:mrow><mml:mo> </mml:mo><mml:mi>D</mml:mi><mml:mi mathvariant="normal">'</mml:mi><mml:mfenced open="(" close=")" separators="|"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:mfenced></mml:mrow></mml:mrow></mml:math></inline-formula>, where <inline-formula id="IE40"><mml:math id="IM40" display="inline" overflow="scroll"><mml:mi>D</mml:mi><mml:mi mathvariant="normal">'</mml:mi></mml:math></inline-formula> is an <inline-formula id="IE41"><mml:math id="IM41" display="inline" overflow="scroll"><mml:mi>n</mml:mi><mml:mo>×</mml:mo><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>×</mml:mo><mml:mn>2</mml:mn><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:math></inline-formula> matrix. Finally, <inline-formula id="IE42"><mml:math id="IM42" display="inline" overflow="scroll"><mml:mi>D</mml:mi><mml:mi mathvariant="normal">'</mml:mi></mml:math></inline-formula> was fed into the second layer classifier LR. Note that as the numbers of cell types vary across different scRNA-seq datasets, CTISL dynamically combines different numbers of base classifiers (i.e. SVM and LR) on different scRNA-seq training datasets.</p>
      <p><bold>Step 4. Model evaluation:</bold> To effectively evaluate and compare the performance of CTISL and other state-of-the-art approaches, we used four evaluation strategies including intra-dataset, inter-dataset, cross-batch, and cross-species evaluation (<xref rid="btae063-F1" ref-type="fig">Fig. 1D</xref>). For intra-dataset validation, we used the 5-fold cross-validation on seven PBMCs of <italic toggle="yes">H.sapiens</italic>. Five-folds were stratified to preserve the ratios of samples/cells for each cell type. When validating the inter-dataset performance, we used seven human PBMC datasets, which were generated by seven different protocols (i.e. 10Xv2, 10Xv3, CEL-Seq2, Drop-Seq, inDrop, SMART-Seq2, and SeqWell, respectively). To maximize the use of the existing datasets, we conducted seven inter-group experiments, with each experiment using one dataset as the testing set and the remaining six datasets for training. For cross-batch validation, we used three datasets, Dendritic, Retina(5), and Retina(19). For each dataset, we conducted experiments with one batch for training and the other one for testing. In total, we conducted six cross-batch experiments. To assess the cross-species performance, we conducted experiments on a pair of datasets, which were obtained from the same tissue of two different species by the same protocol. The model was trained on one dataset of original species and predicted cell types in another dataset of target species, and <italic toggle="yes">vice versa</italic>. In this work, we used two datasets generated by the inDrop protocol from the pancreas tissues of <italic toggle="yes">H.sapiens</italic> and <italic toggle="yes">M.musculus</italic> and two datasets generated by the inDrop protocol from the airway tissues of <italic toggle="yes">H.sapiens</italic> and <italic toggle="yes">M.musculus</italic>.</p>
    </sec>
    <sec>
      <title>2.3 Benchmarking against state-of-the-art ML-based cell-type prediction methods</title>
      <p>In our benchmark experiments, we compared CTISL with nine state-of-the-art ML-based methods including ACTINN (<xref rid="btae063-B38" ref-type="bibr">Ma and Pellegrini 2020</xref>) scCapsNet (<xref rid="btae063-B58" ref-type="bibr">Wang <italic toggle="yes">et al.</italic> 2020b</xref>), scDetect (<xref rid="btae063-B52" ref-type="bibr">Shen <italic toggle="yes">et al.</italic> 2021</xref>), TripletCell (<xref rid="btae063-B36" ref-type="bibr">Liu <italic toggle="yes">et al.</italic> 2023</xref>), scmap-cluster (<xref rid="btae063-B31" ref-type="bibr">Kiselev <italic toggle="yes">et al.</italic> 2018</xref>), scmap-cell (<xref rid="btae063-B31" ref-type="bibr">Kiselev <italic toggle="yes">et al.</italic> 2018</xref>), CellTypist (<xref rid="btae063-B17" ref-type="bibr">Domínguez Conde <italic toggle="yes">et al.</italic> 2022</xref>), scBERT (<xref rid="btae063-B64" ref-type="bibr">Yang <italic toggle="yes">et al.</italic> 2022</xref>), and SingleR (<xref rid="btae063-B4" ref-type="bibr">Aran <italic toggle="yes">et al.</italic> 2019</xref>). For ACTINN, scDetect, TripletCell, scmap-cluster, scmap-cell, CellTypist, scBERT, and SingleR, we used the pre-processing methods provided in their studies to process the original data and used the processed data as input for these models. While for scCapsNet, we used the method in this study to pre-process the data. All compared methods were trained and tested using the same training and testing datasets to ensure a fair comparison. We employed three popular performance evaluation metrics, including accuracy, median <italic toggle="yes">F</italic>1-score, and macro <italic toggle="yes">F</italic>1-score (<xref rid="sup1" ref-type="supplementary-material">Supplementary Section S2</xref>) to evaluate and compare the predictive performance of CTISL with state-of-the-art approaches. Accuracy is defined as the percentage of correctly predicted cell type among all cells. Median <italic toggle="yes">F</italic>1-score is defined as the median value of <italic toggle="yes">F</italic>1-scores of all cell types and macro <italic toggle="yes">F</italic>1-score denotes the average of <italic toggle="yes">F</italic>1-scores of all cell types. Therefore, macro <italic toggle="yes">F</italic>1-score is suitable for scRNA-seq data with highly imbalanced proportions of cell types (<xref rid="btae063-B39" ref-type="bibr">Ma <italic toggle="yes">et al.</italic> 2021</xref>).</p>
    </sec>
  </sec>
  <sec>
    <title>3 Results</title>
    <sec>
      <title>3.1 Performance evaluation on selected feature genes</title>
      <p>Most feature gene selection algorithms were designed to choose highly variable genes (HVGs). However, cell-type identification is a multi-class classification task and HVGs might not be related to cell types. This section therefore aimed to evaluate the performance of the base classifiers on different feature gene sets, including feature genes selected by various methods and HVGs. The feature gene selection methods, we evaluated in this study include the χ<sup>2</sup> method, limma (<xref rid="btae063-B48" ref-type="bibr">Ritchie <italic toggle="yes">et al.</italic> 2015</xref>), and GeneClust (<xref rid="btae063-B15" ref-type="bibr">Deng <italic toggle="yes">et al.</italic> 2023</xref>). While the χ<sup>2</sup> method and limma can select feature genes for each cell type, GeneClust selects a subset of highly representative genes that are relevant to each cluster. For each cell type, we used the χ<sup>2</sup> algorithm and limma to select the top <italic toggle="yes">k</italic> (<italic toggle="yes">k</italic> = 100, 200, 300, 400, and 500) genes that are related to cell types. Thus, for scRNA-seq with <italic toggle="yes">t</italic> cell types, <inline-formula id="IE43"><mml:math id="IM43" display="inline" overflow="scroll"><mml:mi>t</mml:mi><mml:mo>×</mml:mo><mml:mi>k</mml:mi><mml:mi mathvariant="normal"> </mml:mi></mml:math></inline-formula>genes were chosen as features. To evaluate the performance of genes selected by our proposed feature selection method, we compared the selected genes in our work with 2000, 3000, 4000, and 5000 highly variable genes, respectively. We trained our base classifiers on seven human scRNA-seq datasets using the selected genes via a 5-fold cross-validation test—the feature genes were selected using the 4-folds and the performance was tested using the rest fold. Performance comparison between SVM and LR using 300 χ<sup>2</sup>-selected genes and 5000 HVGs is shown in <xref rid="btae063-F2" ref-type="fig">Fig. 2A and B</xref>, respectively. Detailed performance values of all the numbers of selected genes and feature gene selection methods are shown in <xref rid="sup1" ref-type="supplementary-material">Supplementary Tables S2</xref> and <xref rid="sup1" ref-type="supplementary-material">S3</xref>, respectively. From the average accuracy, and macro and media <italic toggle="yes">F</italic>1-scores, the χ<sup>2</sup> method outperformed other gene selection methods and HVGs. However, the performance did not always improve with the increase in the number of features selected by the χ<sup>2</sup> method. Therefore, we further evaluated the performance of the whole CTISL framework on various numbers of selected genes (from 10 to 2000) selected by the χ<sup>2</sup> approach for all experimental scenarios, including intra-dataset, inter-dataset, cross-batch dataset, and cross-species. As illustrated in <xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S1</xref>, not all performance values generally improved with the increase in the number of selected genes, posing the challenge of selecting a universally optimized number of genes. Specifically, we counted the number of times when each number of selected genes achieved the highest accuracy and macro and median <italic toggle="yes">F</italic>1-scores. As a result, 2000 χ<sup>2</sup>-selected genes achieved the highest performance 20 times, followed by 1500 genes (18 times) and 300 genes (16 times). However, when using the selected 2000 and 1500 genes, CTISL took a significantly longer time to build the model. Considering balancing the running time and performance, in our CTISL framework, we used 300 as the default number of top genes based on the experiments. We further used the 10Xv2 dataset as an example to explore the robustness of CTISL concerning different numbers of distinct genes selected for each cell type using the χ<sup>2</sup> approach (<xref rid="sup1" ref-type="supplementary-material">Supplementary Table S4</xref> and <xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S2</xref>). Notably, we observed a reduction in the number of distinct genes for certain cell types with an increase in the number of selected genes. Moreover, when the number of selected genes was above 1000, the number of distinct signature genes for each cell type did not always increase along with the increase of the number of selected genes by the χ<sup>2</sup> approach. Refer to <xref rid="sup1" ref-type="supplementary-material">Supplementary Section S1</xref> for more details.</p>
      <fig position="float" id="btae063-F2">
        <label>Figure 2.</label>
        <caption>
          <p>Feature gene selection and performance comparison of base learners and our CTISL framework (stacking LR and SVM). (A and B) Performance of SVM and LR using different feature gene selection approaches including the χ<sup>2</sup> method (300 genes selected) and the 5000 highly variable genes used in the work by <xref rid="btae063-B26" ref-type="bibr">Huang and Zhang (2021)</xref>. (C–F) Performance comparison among base classifiers LR, SVM, and CTISL (using the stacking ensemble learning technique) models based on the 300 selected feature genes by the χ<sup>2</sup> method in terms of accuracy, macro <italic toggle="yes">F</italic>1-score, and median <italic toggle="yes">F</italic>1-score using (C) intra-dataset, (D) inter-dataset, (E) cross-batch, and (F) cross-species evaluation strategy.</p>
        </caption>
        <graphic xlink:href="btae063f2" position="float"/>
      </fig>
      <p>We also examined the genes selected by the χ<sup>2</sup> method and found that some of them are marker genes of the corresponding cell types according to the CellMarker 2.0 database (<xref rid="btae063-B24" ref-type="bibr">Hu <italic toggle="yes">et al.</italic> 2023</xref>). As shown in <xref rid="sup1" ref-type="supplementary-material">Supplementary Table S5</xref>, 31 out of 62 marker genes in B cells of the PBMC_10Xv2 dataset were selected by the χ<sup>2</sup> method. These findings confirm that the χ<sup>2</sup> method is capable of selecting indicative feature genes for cell-type identification. We then conducted a performance comparison of CTISL by using selected feature genes and marker genes, respectively. We found that CTISL achieved better performance when using the selected feature genes in comparison to the marker genes (<xref rid="sup1" ref-type="supplementary-material">Supplementary Table S6</xref>). Although maker genes have a strong ability to identify cell types, the limited number of known marker genes in some cell types cannot help the model achieve satisfactory performance of cell-type identification. Refer to <xref rid="sup1" ref-type="supplementary-material">Supplementary Section S2</xref> for more information.</p>
    </sec>
    <sec>
      <title>3.2 Performance evaluation of CTISL</title>
      <p>We then evaluated and compared the performance improvement achieved by the stacking learning technique. We systematically compared CTISL (using stacking learning to ensemble LR and SVM) with selected genes and marker genes, respectively, χ<sup>2</sup>+MLP (multilayer perceptron) (<xref rid="btae063-B45" ref-type="bibr">Popescu <italic toggle="yes">et al.</italic> 2009</xref>), and CTISL with LR+SVM+RF+GBC (<xref rid="btae063-B20" ref-type="bibr">Friedman 2001</xref>) in intra-dataset experiments, inter-dataset experiments, cross-batch experiments, and cross-species experiments. Refer to the methodological details of integrating MLP, RF, and GBC in <xref rid="sup1" ref-type="supplementary-material">Supplementary Sections S1</xref> and <xref rid="sup1" ref-type="supplementary-material">S3</xref>. The performance of CTISL stacking LR and SVM using 300 selected feature genes is demonstrated in <xref rid="btae063-F2" ref-type="fig">Fig. 2</xref> and all detailed performance values are illustrated in <xref rid="sup1" ref-type="supplementary-material">Supplementary Table S6</xref>.</p>
      <p>The intra-dataset experiments demonstrate that CTISL outperformed all other approaches in terms of average accuracy and average median <italic toggle="yes">F</italic>1-score, except for the slightly lower (0.001) average macro <italic toggle="yes">F</italic>1-score than CTISL with LR+SVM+RF+GBC (<xref rid="sup1" ref-type="supplementary-material">Supplementary Table S6</xref>). In addition, CTISL outperformed the base classifiers LR and SVM (<xref rid="btae063-F2" ref-type="fig">Fig. 2C</xref> and <xref rid="sup1" ref-type="supplementary-material">Supplementary Table S6</xref>) in terms of average accuracy (92.8% versus 91.6% and 92.8% versus 90.7%), average macro <italic toggle="yes">F</italic>1-score (0.906 versus 0.877 and 0.906 versus 0.773), and average median <italic toggle="yes">F</italic>1-score (0.947 versus 0.938 and 0.947 versus 0.908). While for inter-dataset experiments, compared to LR and SVM, CTISL achieved higher average accuracy (87.2% versus 83.0% and 87.2% versus 87.1%), average macro <italic toggle="yes">F</italic>1-score (0.734 versus 0.696 and 0.734 versus 0.716, respectively), and average median <italic toggle="yes">F</italic>1-score (0.857 versus 0.801 and 0.857 versus 0.850) in inter-dataset experiments (<xref rid="btae063-F2" ref-type="fig">Fig. 2D</xref> and <xref rid="sup1" ref-type="supplementary-material">Supplementary Table S6</xref>). For cross-batch experiments, CTISL outperformed the base classifiers LR and SVM (<xref rid="btae063-F2" ref-type="fig">Fig. 2E</xref> and <xref rid="sup1" ref-type="supplementary-material">Supplementary Table S6</xref>) in terms of average accuracy (98.3% versus 97.8% and 98.3% versus 96.6%), average macro <italic toggle="yes">F</italic>1-score (0.961 versus 0.948 and 0.961 versus 0.798), and average median <italic toggle="yes">F</italic>1-score (0.973 versus 0.971 and 0.973 versus 0.778). Our cross-species experiments demonstrate that χ<sup>2</sup>+MLP outperformed CTISL in average macro and median <italic toggle="yes">F</italic>1-scores, while CTISL still achieved better performance than the base learners (i.e. LR and SVM) in most of the cross-species experiments (<xref rid="btae063-F2" ref-type="fig">Fig. 2F</xref> and <xref rid="sup1" ref-type="supplementary-material">Supplementary Table S6</xref>). Detailed performance comparison and discussion about χ<sup>2</sup>+MLP and CTISL with LR+SVM+RF+GBC have been provided in <xref rid="sup1" ref-type="supplementary-material">Supplementary Section S3</xref>.</p>
      <p>Although CTISL did not outperform the ensemble base learners on all three metrics in all 24 benchmarking experiments, the results demonstrate that CTISL achieved consistently robust and stable average performance across all cases, except for the comparative prediction performance based on cross-species. Overall, we conclude that the stacking learning technique can effectively improve the prediction performance of base classifiers on intra-dataset, inter-dataset, and cross-batch scenarios of cell type-identification. In addition, to examine the effectiveness of CTISL, we employed UMAP (<xref rid="btae063-B40" ref-type="bibr">McInnes <italic toggle="yes">et al.</italic> 2018</xref>) to visualize the cell types represented by features extracted from each step in our model (<xref rid="btae063-F3" ref-type="fig">Fig. 3</xref>). As can be seen from <xref rid="btae063-F3" ref-type="fig">Fig. 3</xref>, all cells were mixed in the original dataset. After selecting the feature genes, the same type of cells began to form a blurry cluster, which then gradually separated after the first layer. After the output layer, the same type of cells was well clustered into the same group. These results confirm that CTISL can effectively extract informative features representing cell types, thereby achieving outstanding prediction performance.</p>
      <fig position="float" id="btae063-F3">
        <label>Figure 3.</label>
        <caption>
          <p>Visualizing the cell-type identification results on seven datasets, including (A) 10Xv2, (B) 10Xv3, (C) CELSeq, (D) DropSeq, (E) inDrop, (F) SMARTSeq2, and (G) SeqWell. For each dataset, the four panels, from top to bottom, represent the visualizations without feature selection, the results after feature selection, the output of the first layer of the model, and the output of the last layer of the model, respectively.</p>
        </caption>
        <graphic xlink:href="btae063f3" position="float"/>
      </fig>
    </sec>
    <sec>
      <title>3.3 Model interpretation</title>
      <p>In this section, we used the SHAP package (<xref rid="btae063-B37" ref-type="bibr">Lundberg and Lee 2017</xref>) to interpret the output of CTISL (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S3</xref>) and compared the selected feature genes with the marker genes from the CellMarker 2.0 database (<xref rid="btae063-B24" ref-type="bibr">Hu <italic toggle="yes">et al.</italic> 2023</xref>). We plotted the distribution of the impact of the top 20 selected genes from the output of CTISL. Positive SHAP values indicate the identification of the current cell type, while negative SHAP values indicate the identification of other types. Taking the B cell in 10Xv2 e.g. (<xref rid="sup1" ref-type="supplementary-material">Supplementary Table S5</xref> and <xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S3A</xref>), most genes with high expression achieved positive SHAP values. Among these 20 selected top genes, 8 are marker genes according to CellMarker 2.0, including CD79A, IGHM, MS4A1, TNFRSF13C, IGHD, IGKC, CD74, and CD79B. These genes have high expression values in most B cell samples, and their SHAP values from the output of the model are positive, meaning that these genes are favorable to the identification of B cells. Similar results of other cell types can also be found in 10Xv2 (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S3</xref>). For example, the high expression of IL7R and LTB are marker genes of CD4+ T cells according to CellMarker 2.0 and are favorable for the recognition of CD4+ T cells (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S3I</xref>). They were among the top 20 selected genes for this cell type according to the output of our CTISL. Similarly, the high expression of PF4, PPBP, TUBB1, and MYL9 positively impacted the identification of megakaryocytes (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S3F</xref>), and they were marker genes for this cell type based on our SHAP analysis. In addition, high expression of marker genes, such as KLRF1, SPON2, KLRB1, GNLY, CCL4, FCGR3A, CD247, GZMB, CD7, KLRD1, and TRDC are more indicative of identifying natural killer cells. These genes are all marker genes based on the annotations of CellMarker 2.0 and were also among the top 20 selected genes for this cell type based on the outputs of CTISL (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S3G</xref>). For the Plasmacytoid dendritic cell (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S3H</xref>), out of the 6188 samples in the PBMC-10Xv2 dataset, only 38 samples are available. As such, there are only eight plasmacytoid dendritic cells in the test sub-dataset using a 5-fold cross-validation test on the 10Xv2 dataset. As a result, there are few data points with higher SHAP values depicted in <xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S3H</xref>.</p>
    </sec>
    <sec>
      <title>3.4 Benchmarking CTISL against state-of-the-art methods in intra- and inter-dataset scenarios</title>
      <p>We first performed 5-fold cross-validations on seven human PBMC datasets and compared CTISL with nine state-of-the-art approaches in intra- and inter-dataset scenarios. The evaluated approaches included ACTINN, scCapsNet, scDetect, TripletCell, scmap-cluster, scmap-cell, CellTypist, scBERT, and SingleR. <xref rid="btae063-F4" ref-type="fig">Figure 4A</xref> demonstrated that CTISL outperformed all other nine benchmarked methods in terms of accuracy on five out of seven intra-dataset experiments. Among the remaining two datasets, scmap-cell achieved the highest accuracy of 95.9%, while CTISL achieved the second-best performance of 95.1% on the 10Xv3 dataset. Additionally, CTISL achieved the third-best performance of 87.5% on the SeqWell dataset. In terms of macro <italic toggle="yes">F</italic>1-score (<xref rid="btae063-F4" ref-type="fig">Fig. 4B</xref>), CTISL outperformed all other nine benchmarked methods on four out of seven intra-datasets. For the remaining three datasets, CTISL achieved the second-best performance of 0.949 on the 10Xv3 dataset, 0.911 on the CELSeq dataset, and 0.802 on the inDrop dataset. Similar results are observed in terms of median <italic toggle="yes">F</italic>1-score (<xref rid="btae063-F4" ref-type="fig">Fig. 4C</xref>). To evaluate the performance generalization of CTISL, we further performed inter-dataset tests on seven human PBMC datasets generated by different protocols. We first trained our model on six of seven datasets and tested the model on the remaining dataset. Each dataset was used as the testing data once [in line with <xref rid="btae063-B58" ref-type="bibr">Wang <italic toggle="yes">et al.</italic> (2020</xref>b) and <xref rid="btae063-B64" ref-type="bibr">Yang <italic toggle="yes">et al.</italic> (2022)</xref>] and the evaluation therefore contained seven sub-tasks. As can be seen in <xref rid="btae063-F4" ref-type="fig">Fig. 4A</xref>, CTISL achieved the best accuracy on two out of seven tests. In the remaining five datasets, CTISL achieved the second-best performance of 87.0% on the DropSeq test dataset, the second-best performance of 85.6% on the inDrop test dataset, the fourth-best performance of 90.1% on the 10Xv2 test dataset, the third-best performance of 92.4% on the 10Xv3 test dataset, and the seventh-best performance of 74.1% on the SeqWell test dataset. Additionally, CTISL and scmap-cell achieved the highest macro <italic toggle="yes">F</italic>1-score on two out of seven test results (<xref rid="btae063-F4" ref-type="fig">Fig. 4B</xref>), followed by scCapsNet, scDetect, and TripletCell on one test, respectively. scCapsNet, and scBERT achieved the highest median <italic toggle="yes">F</italic>1-score on two tests, followed by CTISL, TripletCell, and scmap-cell on one test separately (<xref rid="btae063-F4" ref-type="fig">Fig. 4C</xref>). Overall, these comparison results demonstrate that CTISL is capable of accurately and robustly identifying cell types in both inter- and intra-dataset experiments.</p>
      <fig position="float" id="btae063-F4">
        <label>Figure 4.</label>
        <caption>
          <p>Performance evaluation and benchmarking between CTISL and nine state-of-the-art cell-type predictors in terms of (A) accuracy, (B) macro <italic toggle="yes">F</italic>1-score, and (C) median <italic toggle="yes">F</italic>1-score on seven human PBMC datasets in intra- and inter-dataset, cross-batch, and cross-species experiments. “b1 to b2” and “b2 to b1” mean that the model was trained on the first/second batch of dataset and tested on the second/first batch of dataset, respectively. While “h to m” and “m or h” mean that the model was trained on the human/mouse dataset and was tested using the mouse/human dataset, respectively.</p>
        </caption>
        <graphic xlink:href="btae063f4" position="float"/>
      </fig>
    </sec>
    <sec>
      <title>3.5 Performance comparison in cross-batch and cross-species scenarios</title>
      <p>To evaluate the performance of CTISL on different batches of datasets, we ran all 10 predictors on 3 datasets with 2 batches (<xref rid="sup1" ref-type="supplementary-material">Supplementary Table S1</xref>). We trained all models on one batch and assessed their performance using the dataset of another batch. In terms of accuracy (<xref rid="btae063-F4" ref-type="fig">Fig. 4A</xref>), CTISL, ACTINN, and scmap-cell achieved the highest accuracy (100%) across one batch of the Retina(5) dataset (b2–b1). Similarly, CTISL achieved the highest performance of 98.0% on the Retina(19) dataset (b2–b1) and the second-best performance of 96.8% (b1–b2). Similarly, CTISL achieved the highest performance of 98.1% on the dendritic dataset (b2–b1) and the second-best performance of 97.1% (b1–b2). CTISL also achieved the highest macro and median <italic toggle="yes">F</italic>1-scores (<xref rid="btae063-F4" ref-type="fig">Fig. 4B and C</xref>) on four and three out of six experiments, respectively.</p>
      <p>We then conducted cross-species cell-type identification using human and mouse pancreas and airway datasets. CTISL achieved the fourth-best accuracy of 84.3% from human to mouse on the pancreas datasets (<xref rid="btae063-F4" ref-type="fig">Fig. 4A</xref>). Except for CellTypist, which achieved the highest accuracy of 88.8%, all other models performed poorly when they were trained on the mouse pancreas dataset to predict cell types in the human pancreas dataset. This is presumably because those cell types are not completely identical across human and mouse pancreas tissues. It is a common phenomenon in cross-species scenarios that some unique cell types only exist in the test dataset. For example, several cell types (e.g. acinar, epsilon, and mast) only appear in the human pancreas dataset and are not present in the mouse pancreas dataset. Similarly, two cell types (e.g. B_cell and immuse_other) solely appear in the mouse pancreas dataset and are not present in the human pancreas dataset (<xref rid="sup1" ref-type="supplementary-material">Supplementary Table S7</xref>). This phenomenon greatly reduces the prediction performance of all the models compared. On the other hand, in the airway dataset, the human data comprised three cell types—Basal, Ciliated, and Secretory, with similar sample sizes of 252, 258, and 280, respectively. When using human airway datasets for training the model to predict the cell types in mouse airway datasets, all 10 models performed well, with CTISL ranked third in accuracy (<xref rid="btae063-F4" ref-type="fig">Fig. 4A</xref>). However, the mouse airway datasets exhibited a huge imbalance in sample sizes of the cell types, including Basal, Ciliated, and Secretory, with sample sizes of 6009, 1333, and 4792, respectively. Therefore, we applied the “RandomUnderSampler” function from the “imblearn” library (<xref rid="btae063-B33" ref-type="bibr">Lemaître <italic toggle="yes">et al.</italic> 2017</xref>), which is a down-sampling strategy based on the method proposed by <xref rid="btae063-B32" ref-type="bibr">Laurikkala (2001)</xref> to balance the class distribution in the dataset (<xref rid="sup1" ref-type="supplementary-material">Supplementary Section S3</xref>). We set the sample size of each cell type to 1333 and trained the four models using the down-sampled data to predict human data. Five rounds of down-sampling were then conducted for each experiment and the average results for each trial were calculated. CTISL achieved the highest accuracy of 99.7% (<xref rid="btae063-F4" ref-type="fig">Fig. 4A</xref>) and the highest macro (<xref rid="btae063-F4" ref-type="fig">Fig. 4B</xref>) and median <italic toggle="yes">F</italic>1-score (<xref rid="btae063-F4" ref-type="fig">Fig. 4C</xref>) of 0.998 on the human airway dataset. In addition, according to cross-species experiments (<xref rid="sup1" ref-type="supplementary-material">Supplementary Table S6</xref>), χ<sup>2</sup>+MLP achieved overall better performance than CTISL, and CTISL with LR+SVM+RF+GBC outperformed CTISL in terms of average macro and median <italic toggle="yes">F</italic>1-score. Therefore, we recommend χ<sup>2</sup>+MLP when performing cross-species cell-type identification. Taken together, despite that χ<sup>2</sup>+MLP performed better than CTISL in cross-species experiments, these results showed that CTISL possesses a strong predictive ability in cell-type identification in intra-dataset, inter-dataset, and cross-batch experiment scenarios.</p>
    </sec>
  </sec>
  <sec>
    <title>4 Discussion and conclusions</title>
    <p>For identifying cell types using highly sparse single-cell expression matrix data, it is crucial to perform feature selection prior to model construction. Our feature selection method consists of multiple iterations, with each iteration selecting representative features for a specific cell type. We compared our selected features with publicly available cell-type marker genes and found that some of our selected marker genes could accurately identify the corresponding cell types and have significant biological relevance. Furthermore, we analyzed the performance of CTISL using various feature gene selection methods and different numbers of selected genes (<xref rid="sup1" ref-type="supplementary-material">Supplementary Tables S2</xref> and <xref rid="sup1" ref-type="supplementary-material">S3</xref>, and <xref rid="sup1" ref-type="supplementary-material">Supplementary Section S1</xref>). It is worth noticing that the prediction performance of CTISL is still limited by supervised learning. When training and testing CTISL across datasets, the cell types in the predicted results of CTISL are solely based on the available types in the training set, meaning that the model cannot identify new cell types in the test dataset. Although some existing models are able to identify new cell types (such as ACTINN, scCapsNet, scDetect, TripletCell, scmap-cell, and scmap-cluster), they may only classify them as a “novel”/ “other” type without accurately determining their actual types. In the future, we will endeavor to incorporate more cell types by combining more single-cell omic data, such as scATAC-seq data, thereby enriching the prediction capacity of CTISL. CTISL utilizes LR and SVM as default base learners for each cell type in the training dataset. However, other classifiers can also be integrated into CTISL as base learners (Supplementary Sections S3). Moreover, as the number of cell types increases, CTISL can dynamically increase the number of base learners (<xref rid="sup1" ref-type="supplementary-material">Supplementary Section S5</xref>). In addition, the performance of CTISL, like most state-of-the-art predictors, may suffer from imbalanced cell types in the training dataset when performing cross-species predictions. However, this issue can be to some extent mitigated by employing down-sampling techniques in the training dataset. It is worth noticing that the down-sampling strategy does not work if the rarest cell type (i.e. the cell type with the least number of cells compared to other cell types) in the training dataset has an insufficient number of cells. We also discussed the effect of cell-type imbalances on different experiment scenarios, such as cross-batch and intra-dataset in <xref rid="sup1" ref-type="supplementary-material">Supplementary Section S4</xref>.</p>
    <p>We developed a user-friendly web-based application for CTISL at <ext-link xlink:href="http://bigdata.biocie.cn/CTISLweb/home" ext-link-type="uri">http://bigdata.biocie.cn/CTISLweb/home</ext-link> to facilitate community-wide efforts to identify cell types using users’ datasets. Additionally, users have the option to choose different models other than LR and SVM as base learners or add additional models to the CTISL framework, via our webserver and locally runnable software (<ext-link xlink:href="https://zenodo.org/records/10568906" ext-link-type="uri">https://zenodo.org/records/10568906</ext-link>). Alternatively, given that χ<sup>2</sup>+MLP achieved better performance than the original CTISL in cross-species cell-type identification, we provided the MLP option on our webserver and GitHub repository for users to replace the stacking model. In conclusion, as a dynamic stacking ensemble learning-based model for robust multi-class classification of cell types using scRNA-seq data, CTISL achieved better or competitive, and more robust performances compared to other state-of-the-art predictors based on our extensive benchmarking experiments on intra- and inter-dataset, cross-batch, and cross-species datasets. Altogether, we anticipate that CTISL will serve as a prominent computational tool for the accurate identification of cell types using scRNA-seq data, thereby facilitating scRNA-seq data analysis and hypothesis generation.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material id="sup1" position="float" content-type="local-data">
      <label>btae063_Supplementary_Data</label>
      <media xlink:href="btae063_supplementary_data.docx">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <ack id="ack1">
    <title>Acknowledgements</title>
    <p>We thank the High-Performance Computing (HPC) of Northwest A&amp;F University (NWAFU) for providing computing resources.</p>
  </ack>
  <sec>
    <title>Supplementary data</title>
    <p><xref rid="sup1" ref-type="supplementary-material">Supplementary data</xref> are available at <italic toggle="yes">Bioinformatics</italic> online.</p>
  </sec>
  <sec sec-type="COI-statement">
    <title>Conflict of interest</title>
    <p>None declared.</p>
  </sec>
  <sec>
    <title>Funding</title>
    <p>This work was supported by the National Key R&amp;D Program of China [2022YFF1000100].</p>
  </sec>
  <ref-list id="ref1">
    <title>References</title>
    <ref id="btae063-B1">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Abdelaal</surname><given-names>T</given-names></string-name>, <string-name><surname>Michielsen</surname><given-names>L</given-names></string-name>, <string-name><surname>Cats</surname><given-names>D</given-names></string-name></person-group><etal>et al</etal><article-title>A comparison of automatic cell identification methods for single-cell RNA sequencing data</article-title>. <source>Genome Biol</source><year>2019</year>;<volume>20</volume>:<fpage>194</fpage>.<pub-id pub-id-type="pmid">31500660</pub-id></mixed-citation>
    </ref>
    <ref id="btae063-B2">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Aibar</surname><given-names>S</given-names></string-name>, <string-name><surname>González-Blas</surname><given-names>CB</given-names></string-name>, <string-name><surname>Moerman</surname><given-names>T</given-names></string-name></person-group><etal>et al</etal><article-title>SCENIC: single-cell regulatory network inference and clustering</article-title>. <source>Nat Methods</source><year>2017</year>;<volume>14</volume>:<fpage>1083</fpage>–<lpage>6</lpage>.<pub-id pub-id-type="pmid">28991892</pub-id></mixed-citation>
    </ref>
    <ref id="btae063-B3">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Alquicira-Hernandez</surname><given-names>J</given-names></string-name>, <string-name><surname>Sathe</surname><given-names>A</given-names></string-name>, <string-name><surname>Ji</surname><given-names>HP</given-names></string-name></person-group><etal>et al</etal><article-title>scPred: accurate supervised method for cell-type classification from single-cell RNA-seq data</article-title>. <source>Genome Biol</source><year>2019</year>;<volume>20</volume>:<fpage>264</fpage>.<pub-id pub-id-type="pmid">31829268</pub-id></mixed-citation>
    </ref>
    <ref id="btae063-B4">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Aran</surname><given-names>D</given-names></string-name>, <string-name><surname>Looney</surname><given-names>AP</given-names></string-name>, <string-name><surname>Liu</surname><given-names>L</given-names></string-name></person-group><etal>et al</etal><article-title>Reference-based analysis of lung single-cell sequencing reveals a transitional profibrotic macrophage</article-title>. <source>Nat Immunol</source><year>2019</year>;<volume>20</volume>:<fpage>163</fpage>–<lpage>72</lpage>.<pub-id pub-id-type="pmid">30643263</pub-id></mixed-citation>
    </ref>
    <ref id="btae063-B5">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Arendt</surname><given-names>D</given-names></string-name>, <string-name><surname>Musser</surname><given-names>JM</given-names></string-name>, <string-name><surname>Baker</surname><given-names>CVH</given-names></string-name></person-group><etal>et al</etal><article-title>The origin and evolution of cell types</article-title>. <source>Nat Rev Genet</source><year>2016</year>;<volume>17</volume>:<fpage>744</fpage>–<lpage>57</lpage>.<pub-id pub-id-type="pmid">27818507</pub-id></mixed-citation>
    </ref>
    <ref id="btae063-B6">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Baron</surname><given-names>M</given-names></string-name>, <string-name><surname>Veres</surname><given-names>A</given-names></string-name>, <string-name><surname>Wolock</surname><given-names>SL</given-names></string-name></person-group><etal>et al</etal><article-title>A single-cell transcriptomic map of the human and mouse pancreas reveals inter- and intra-cell population structure</article-title>. <source>Cell Syst</source><year>2016</year>;<volume>3</volume>:<fpage>346</fpage>–<lpage>60.e4</lpage>.<pub-id pub-id-type="pmid">27667365</pub-id></mixed-citation>
    </ref>
    <ref id="btae063-B7">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Basith</surname><given-names>S</given-names></string-name>, <string-name><surname>Lee</surname><given-names>G</given-names></string-name>, <string-name><surname>Manavalan</surname><given-names>B.</given-names></string-name></person-group><article-title>STALLION: a stacking-based ensemble learning framework for prokaryotic lysine acetylation site prediction</article-title>. <source>Brief Bioinform</source><year>2022</year>;<volume>23</volume>:<fpage>bbab376</fpage>.<pub-id pub-id-type="pmid">34532736</pub-id></mixed-citation>
    </ref>
    <ref id="btae063-B8">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Breiman</surname><given-names>L.</given-names></string-name></person-group><article-title>Random forests</article-title>. <source>Mach Learn</source><year>2001</year>;<volume>45</volume>:<fpage>5</fpage>–<lpage>32</lpage>.</mixed-citation>
    </ref>
    <ref id="btae063-B9">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Cao</surname><given-names>Z</given-names></string-name>, <string-name><surname>Pan</surname><given-names>X</given-names></string-name>, <string-name><surname>Yang</surname><given-names>Y</given-names></string-name></person-group><etal>et al</etal><article-title>The lncLocator: a subcellular localization predictor for long non-coding RNAs based on a stacked ensemble classifier</article-title>. <source>Bioinformatics</source><year>2018</year>;<volume>34</volume>:<fpage>2185</fpage>–<lpage>94</lpage>.<pub-id pub-id-type="pmid">29462250</pub-id></mixed-citation>
    </ref>
    <ref id="btae063-B10">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Celebi</surname><given-names>ME</given-names></string-name>, <string-name><surname>Kingravi</surname><given-names>HA</given-names></string-name>, <string-name><surname>Vela</surname><given-names>PA.</given-names></string-name></person-group><article-title>A comparative study of efficient initialization methods for the k-means clustering algorithm</article-title>. <source>Expert Syst Appl</source><year>2013</year>;<volume>40</volume>:<fpage>200</fpage>–<lpage>10</lpage>.</mixed-citation>
    </ref>
    <ref id="btae063-B11">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Chen</surname><given-names>X</given-names></string-name>, <string-name><surname>Chen</surname><given-names>S</given-names></string-name>, <string-name><surname>Song</surname><given-names>S</given-names></string-name></person-group><etal>et al</etal><article-title>Cell type annotation of single-cell chromatin accessibility data via supervised Bayesian embedding</article-title>. <source>Nat Mach Intell</source><year>2022</year>;<volume>4</volume>:<fpage>116</fpage>–<lpage>26</lpage>.</mixed-citation>
    </ref>
    <ref id="btae063-B12">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Cortes</surname><given-names>C</given-names></string-name>, <string-name><surname>Vapnik</surname><given-names>V.</given-names></string-name></person-group><article-title>Support-vector networks</article-title>. <source>Mach Learn</source><year>1995</year>;<volume>20</volume>:<fpage>273</fpage>–<lpage>97</lpage>.</mixed-citation>
    </ref>
    <ref id="btae063-B13">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Cover</surname><given-names>T</given-names></string-name>, <string-name><surname>Hart</surname><given-names>P.</given-names></string-name></person-group><article-title>Nearest neighbor pattern classification</article-title>. <source>IEEE Trans Inform Theory</source><year>1967</year>;<volume>13</volume>:<fpage>21</fpage>–<lpage>7</lpage>.</mixed-citation>
    </ref>
    <ref id="btae063-B14">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Cui</surname><given-names>Y</given-names></string-name>, <string-name><surname>Zhang</surname><given-names>S</given-names></string-name>, <string-name><surname>Liang</surname><given-names>Y</given-names></string-name></person-group><etal>et al</etal><article-title>Consensus clustering of single-cell RNA-seq data by enhancing network affinity</article-title>. <source>Brief Bioinform</source><year>2021</year>;<volume>22</volume>:<fpage>bbab236</fpage>.<pub-id pub-id-type="pmid">34160582</pub-id></mixed-citation>
    </ref>
    <ref id="btae063-B15">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Deng</surname><given-names>T</given-names></string-name>, <string-name><surname>Chen</surname><given-names>S</given-names></string-name>, <string-name><surname>Zhang</surname><given-names>Y</given-names></string-name></person-group><etal>et al</etal><article-title>A cofunctional grouping-based approach for non-redundant feature gene selection in unannotated single-cell RNA-seq analysis</article-title>. <source>Brief Bioinform</source><year>2023</year>;<volume>24</volume>:<fpage>bbad042</fpage>.<pub-id pub-id-type="pmid">36754847</pub-id></mixed-citation>
    </ref>
    <ref id="btae063-B16">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Ding</surname><given-names>J</given-names></string-name>, <string-name><surname>Adiconis</surname><given-names>X</given-names></string-name>, <string-name><surname>Simmons</surname><given-names>SK</given-names></string-name></person-group><etal>et al</etal><article-title>Systematic comparison of single-cell and single-nucleus RNA-sequencing methods</article-title>. <source>Nat Biotechnol</source><year>2020</year>;<volume>38</volume>:<fpage>737</fpage>–<lpage>46</lpage>.<pub-id pub-id-type="pmid">32341560</pub-id></mixed-citation>
    </ref>
    <ref id="btae063-B17">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Domínguez Conde</surname><given-names>C</given-names></string-name>, <string-name><surname>Xu</surname><given-names>C</given-names></string-name>, <string-name><surname>Jarvis</surname><given-names>LB</given-names></string-name></person-group><etal>et al</etal><article-title>Cross-tissue immune cell analysis reveals tissue-specific features in humans</article-title>. <source>Science</source><year>2022</year>;<volume>376</volume>:<fpage>eabl5197</fpage>.<pub-id pub-id-type="pmid">35549406</pub-id></mixed-citation>
    </ref>
    <ref id="btae063-B18">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><string-name><surname>Ertoz</surname><given-names>L</given-names></string-name>, <string-name><surname>Steinbach</surname><given-names>M</given-names></string-name>, <string-name><surname>Kumar</surname><given-names>V.</given-names></string-name></person-group> A new shared nearest neighbor clustering algorithm and its applications. In: <italic toggle="yes">Workshop on Clustering High Dimensional Data and Its Applications at 2nd SIAM International Conference on Data Mining, Arlington, VA, USA</italic>. United States: Society for Industrial and Applied Mathematics <year>2002</year>.</mixed-citation>
    </ref>
    <ref id="btae063-B19">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Forman</surname><given-names>G.</given-names></string-name></person-group><article-title>An extensive empirical study of feature selection metrics for text classification</article-title>. <source>J Mach Learn Res</source><year>2003</year>;<volume>3</volume>:<fpage>1289</fpage>–<lpage>305</lpage>.</mixed-citation>
    </ref>
    <ref id="btae063-B20">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Friedman</surname><given-names>JH.</given-names></string-name></person-group><article-title>Greedy function approximation: a gradient boosting machine</article-title>. <source>Ann Statist</source><year>2001</year>;<volume>29</volume>:<fpage>1189</fpage>–<lpage>232</lpage>.</mixed-citation>
    </ref>
    <ref id="btae063-B21">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Fushiki</surname><given-names>T.</given-names></string-name></person-group><article-title>Bayesian bootstrap prediction</article-title>. <source>J Stat Plan Inference</source><year>2010</year>;<volume>140</volume>:<fpage>65</fpage>–<lpage>74</lpage>.</mixed-citation>
    </ref>
    <ref id="btae063-B22">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Grün</surname><given-names>D</given-names></string-name>, <string-name><surname>Lyubimova</surname><given-names>A</given-names></string-name>, <string-name><surname>Kester</surname><given-names>L</given-names></string-name></person-group><etal>et al</etal><article-title>Single-cell messenger RNA sequencing reveals rare intestinal cell types</article-title>. <source>Nature</source><year>2015</year>;<volume>525</volume>:<fpage>251</fpage>–<lpage>5</lpage>.<pub-id pub-id-type="pmid">26287467</pub-id></mixed-citation>
    </ref>
    <ref id="btae063-B23">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Guo</surname><given-names>M</given-names></string-name>, <string-name><surname>Wang</surname><given-names>H</given-names></string-name>, <string-name><surname>Potter</surname><given-names>SS</given-names></string-name></person-group><etal>et al</etal><article-title>SINCERA: a pipeline for single-cell RNA-seq profiling analysis</article-title>. <source>PLoS Comput Biol</source><year>2015</year>;<volume>11</volume>:<fpage>e1004575</fpage>.<pub-id pub-id-type="pmid">26600239</pub-id></mixed-citation>
    </ref>
    <ref id="btae063-B24">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Hu</surname><given-names>C</given-names></string-name>, <string-name><surname>Li</surname><given-names>T</given-names></string-name>, <string-name><surname>Xu</surname><given-names>Y</given-names></string-name></person-group><etal>et al</etal><article-title>CellMarker 2.0: an updated database of manually curated cell markers in human/mouse and web tools based on scRNA-seq data</article-title>. <source>Nucleic Acids Res</source><year>2023</year>;<volume>51</volume>:<fpage>D870</fpage>–<lpage>6</lpage>.<pub-id pub-id-type="pmid">36300619</pub-id></mixed-citation>
    </ref>
    <ref id="btae063-B25">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Hu</surname><given-names>J</given-names></string-name>, <string-name><surname>Li</surname><given-names>X</given-names></string-name>, <string-name><surname>Hu</surname><given-names>G</given-names></string-name></person-group><etal>et al</etal><article-title>Iterative transfer learning with neural network for clustering and cell type classification in single-cell RNA-seq analysis</article-title>. <source>Nat Mach Intell</source><year>2020</year>;<volume>2</volume>:<fpage>607</fpage>–<lpage>18</lpage>.<pub-id pub-id-type="pmid">33817554</pub-id></mixed-citation>
    </ref>
    <ref id="btae063-B26">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Huang</surname><given-names>Y</given-names></string-name>, <string-name><surname>Zhang</surname><given-names>P.</given-names></string-name></person-group><article-title>Evaluation of machine learning approaches for cell-type identification from single-cell transcriptomics data</article-title>. <source>Brief Bioinform</source><year>2021</year>;<volume>22</volume>:<fpage>bbab217</fpage>.<pub-id pub-id-type="pmid">34050369</pub-id></mixed-citation>
    </ref>
    <ref id="btae063-B27">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Jia</surname><given-names>S</given-names></string-name>, <string-name><surname>Lysenko</surname><given-names>A</given-names></string-name>, <string-name><surname>Boroevich</surname><given-names>KA</given-names></string-name></person-group><etal>et al</etal><article-title>scDeepInsight: a supervised cell-type identification method for scRNA-seq data with deep learning</article-title>. <source>Brief Bioinform</source><year>2023</year>;<volume>24</volume>:<fpage>bbad266</fpage>.<pub-id pub-id-type="pmid">37523217</pub-id></mixed-citation>
    </ref>
    <ref id="btae063-B28">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Jiang</surname><given-names>L</given-names></string-name>, <string-name><surname>Chen</surname><given-names>H</given-names></string-name>, <string-name><surname>Pinello</surname><given-names>L</given-names></string-name></person-group><etal>et al</etal><article-title>GiniClust: detecting rare cell types from single-cell gene expression data with Gini index</article-title>. <source>Genome Biol</source><year>2016</year>;<volume>17</volume>:<fpage>144</fpage>.<pub-id pub-id-type="pmid">27368803</pub-id></mixed-citation>
    </ref>
    <ref id="btae063-B29">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Kiselev</surname><given-names>VY</given-names></string-name>, <string-name><surname>Andrews</surname><given-names>TS</given-names></string-name>, <string-name><surname>Hemberg</surname><given-names>M.</given-names></string-name></person-group><article-title>Challenges in unsupervised clustering of single-cell RNA-seq data</article-title>. <source>Nat Rev Genet</source><year>2019</year>;<volume>20</volume>:<fpage>273</fpage>–<lpage>82</lpage>.<pub-id pub-id-type="pmid">30617341</pub-id></mixed-citation>
    </ref>
    <ref id="btae063-B30">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Kiselev</surname><given-names>VY</given-names></string-name>, <string-name><surname>Kirschner</surname><given-names>K</given-names></string-name>, <string-name><surname>Schaub</surname><given-names>MT</given-names></string-name></person-group><etal>et al</etal><article-title>SC3: consensus clustering of single-cell RNA-seq data</article-title>. <source>Nat Methods</source><year>2017</year>;<volume>14</volume>:<fpage>483</fpage>–<lpage>6</lpage>.<pub-id pub-id-type="pmid">28346451</pub-id></mixed-citation>
    </ref>
    <ref id="btae063-B31">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Kiselev</surname><given-names>VY</given-names></string-name>, <string-name><surname>Yiu</surname><given-names>A</given-names></string-name>, <string-name><surname>Hemberg</surname><given-names>MJNM.</given-names></string-name></person-group><article-title>Scmap: projection of single-cell RNA-seq data across data sets</article-title>. <source>Nat Methods</source><year>2018</year>;<volume>15</volume>:<fpage>359</fpage>–<lpage>62</lpage>.<pub-id pub-id-type="pmid">29608555</pub-id></mixed-citation>
    </ref>
    <ref id="btae063-B32">
      <mixed-citation publication-type="book"><person-group person-group-type="author"><string-name><surname>Laurikkala</surname><given-names>J.</given-names></string-name></person-group> Improving identification of difficult small classes by balancing class distribution. In: <italic toggle="yes">Artificial Intelligence in Medicine: 8th Conference on Artificial Intelligence in Medicine in Europe, AIME 2001, Cascais, Portugal, July 1–4, 2001, Proceedings 8</italic>. <fpage>63</fpage>–<lpage>6</lpage>. <publisher-name>Germany</publisher-name>: Springer-Verlag Berlin Heidelberg, <year>2001</year>.</mixed-citation>
    </ref>
    <ref id="btae063-B33">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Lemaître</surname><given-names>G</given-names></string-name>, <string-name><surname>Nogueira</surname><given-names>F</given-names></string-name>, <string-name><surname>Aridas</surname><given-names>C.</given-names></string-name></person-group><article-title>Imbalanced-learn: a python toolbox to tackle the curse of imbalanced datasets in machine learning</article-title>. <source>J Mach Learn Res</source><year>2017</year>;<volume>18</volume>:<fpage>559</fpage>–<lpage>63</lpage>.</mixed-citation>
    </ref>
    <ref id="btae063-B34">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Liang</surname><given-names>X</given-names></string-name>, <string-name><surname>Li</surname><given-names>F</given-names></string-name>, <string-name><surname>Chen</surname><given-names>J</given-names></string-name></person-group><etal>et al</etal><article-title>Large-scale comparative review and assessment of computational methods for anti-cancer peptide identification</article-title>. <source>Brief Bioinform</source><year>2021</year>;<volume>22</volume>:<fpage>bbaa312</fpage>.<pub-id pub-id-type="pmid">33316035</pub-id></mixed-citation>
    </ref>
    <ref id="btae063-B35">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Lin</surname><given-names>Y</given-names></string-name>, <string-name><surname>Cao</surname><given-names>Y</given-names></string-name>, <string-name><surname>Kim</surname><given-names>HJ</given-names></string-name></person-group><etal>et al</etal><article-title>scClassify: sample size estimation and multiscale classification of cells using single and multiple reference</article-title>. <source>Mol Syst Biol</source><year>2020</year>;<volume>16</volume>:<fpage>e9389</fpage>.<pub-id pub-id-type="pmid">32567229</pub-id></mixed-citation>
    </ref>
    <ref id="btae063-B36">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Liu</surname><given-names>Y</given-names></string-name>, <string-name><surname>Wei</surname><given-names>G</given-names></string-name>, <string-name><surname>Li</surname><given-names>C</given-names></string-name></person-group><etal>et al</etal><article-title>TripletCell: a deep metric learning framework for accurate annotation of cell types at the single-cell level</article-title>. <source>Brief Bioinform</source><year>2023</year>;<volume>24</volume>:<fpage>bbad132</fpage>.<pub-id pub-id-type="pmid">37080771</pub-id></mixed-citation>
    </ref>
    <ref id="btae063-B37">
      <mixed-citation publication-type="book"><person-group person-group-type="author"><string-name><surname>Lundberg</surname><given-names>S</given-names></string-name>, <string-name><surname>Lee</surname><given-names>S-I.</given-names></string-name></person-group> A unified approach to interpreting model predictions. In: <italic toggle="yes">31st Conference on Neural Information Processing Systems (NIPS), Long Beach, California, USA</italic>, Vol. <volume>23</volume>. <fpage>4765</fpage>–<lpage>74</lpage>. United States: <publisher-name>ACM</publisher-name>, <year>2017</year>.</mixed-citation>
    </ref>
    <ref id="btae063-B41">
      <mixed-citation publication-type="journal">Lecessie S and van Houwelingen JC. Ridge estimators in logistic regression. <source>Appl Statist</source> 1992;<volume>41</volume>:<fpage>191</fpage>–<lpage>201</lpage>.</mixed-citation>
    </ref>
    <ref id="btae063-B38">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Ma</surname><given-names>F</given-names></string-name>, <string-name><surname>Pellegrini</surname><given-names>M.</given-names></string-name></person-group><article-title>ACTINN: automated identification of cell types in single cell RNA sequencing</article-title>. <source>Bioinformatics</source><year>2020</year>;<volume>36</volume>:<fpage>533</fpage>–<lpage>8</lpage>.<pub-id pub-id-type="pmid">31359028</pub-id></mixed-citation>
    </ref>
    <ref id="btae063-B39">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Ma</surname><given-names>W</given-names></string-name>, <string-name><surname>Su</surname><given-names>K</given-names></string-name>, <string-name><surname>Wu</surname><given-names>H.</given-names></string-name></person-group><article-title>Evaluation of some aspects in supervised cell type identification for single-cell RNA-seq: classifier, feature selection, and reference construction</article-title>. <source>Genome Biol</source><year>2021</year>;<volume>22</volume>:<fpage>264</fpage>.<pub-id pub-id-type="pmid">34503564</pub-id></mixed-citation>
    </ref>
    <ref id="btae063-B40">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>McInnes</surname><given-names>L</given-names></string-name>, <string-name><surname>Healy</surname><given-names>J</given-names></string-name>, <string-name><surname>Saul</surname><given-names>N</given-names></string-name></person-group><etal>et al</etal><article-title>UMAP: uniform manifold approximation and projection</article-title>. <source>JOSS</source><year>2018</year>;<volume>3</volume>:<fpage>861</fpage>.</mixed-citation>
    </ref>
    <ref id="btae063-B42">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Nguyen</surname><given-names>V</given-names></string-name>, <string-name><surname>Griss</surname><given-names>J.</given-names></string-name></person-group><article-title>scAnnotatR: framework to accurately classify cell types in single-cell RNA-sequencing data</article-title>. <source>BMC Bioinformatics</source><year>2022</year>;<volume>23</volume>:<fpage>44</fpage>.<pub-id pub-id-type="pmid">35038984</pub-id></mixed-citation>
    </ref>
    <ref id="btae063-B43">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Plasschaert</surname><given-names>LW</given-names></string-name>, <string-name><surname>Žilionis</surname><given-names>R</given-names></string-name>, <string-name><surname>Choo-Wing</surname><given-names>R</given-names></string-name></person-group><etal>et al</etal><article-title>A single-cell atlas of the airway epithelium reveals the CFTR-rich pulmonary ionocyte</article-title>. <source>Nature</source><year>2018</year>;<volume>560</volume>:<fpage>377</fpage>–<lpage>81</lpage>.<pub-id pub-id-type="pmid">30069046</pub-id></mixed-citation>
    </ref>
    <ref id="btae063-B44">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Pliner</surname><given-names>HA</given-names></string-name>, <string-name><surname>Shendure</surname><given-names>J</given-names></string-name>, <string-name><surname>Trapnell</surname><given-names>C.</given-names></string-name></person-group><article-title>Supervised classification enables rapid annotation of cell atlases</article-title>. <source>Nat Methods</source><year>2019</year>;<volume>16</volume>:<fpage>983</fpage>–<lpage>6</lpage>.<pub-id pub-id-type="pmid">31501545</pub-id></mixed-citation>
    </ref>
    <ref id="btae063-B45">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Popescu</surname><given-names>M-C</given-names></string-name></person-group>, Balas VE, Perescu-Popescu L <etal>et al</etal><article-title>Multilayer perceptron and neural networks</article-title>. <source>WSEAS Trans Circuits Syst</source><year>2009</year>;<volume>8</volume>:<fpage>579</fpage>–<lpage>88</lpage>.</mixed-citation>
    </ref>
    <ref id="btae063-B46">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Qi</surname><given-names>R</given-names></string-name>, <string-name><surname>Ma</surname><given-names>A</given-names></string-name>, <string-name><surname>Ma</surname><given-names>Q</given-names></string-name></person-group><etal>et al</etal><article-title>Clustering and classification methods for single-cell RNA-sequencing data</article-title>. <source>Brief Bioinform</source><year>2020</year>;<volume>21</volume>:<fpage>1196</fpage>–<lpage>208</lpage>.<pub-id pub-id-type="pmid">31271412</pub-id></mixed-citation>
    </ref>
    <ref id="btae063-B47">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Raschka</surname><given-names>S.</given-names></string-name></person-group><article-title>MLxtend: providing machine learning and data science utilities and extensions to python’s scientific computing stack</article-title>. <source>JOSS</source><year>2018</year>;<volume>3</volume>:<fpage>638</fpage>.</mixed-citation>
    </ref>
    <ref id="btae063-B48">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Ritchie</surname><given-names>ME</given-names></string-name>, <string-name><surname>Phipson</surname><given-names>B</given-names></string-name>, <string-name><surname>Wu</surname><given-names>D</given-names></string-name></person-group><etal>et al</etal><article-title>Limma powers differential expression analyses for RNA-sequencing and microarray studies</article-title>. <source>Nucleic Acids Res</source><year>2015</year>;<volume>43</volume>:<fpage>e47</fpage>.<pub-id pub-id-type="pmid">25605792</pub-id></mixed-citation>
    </ref>
    <ref id="btae063-B49">
      <mixed-citation publication-type="book"><person-group person-group-type="author"><string-name><surname>Sabour</surname><given-names>S</given-names></string-name>, <string-name><surname>Frosst</surname><given-names>N</given-names></string-name>, <string-name><surname>Hinton</surname><given-names>GE.</given-names></string-name></person-group> Dynamic routing between capsules. In: <italic toggle="yes">Proceedings of the 31st International Conference on Neural Information Processing Systems. Long Beach, California, USA</italic>. <fpage>3859</fpage>–<lpage>69</lpage>. United States: <publisher-name>Curran Associates Inc</publisher-name>., <year>2017</year>.</mixed-citation>
    </ref>
    <ref id="btae063-B50">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Samek</surname><given-names>W</given-names></string-name>, <string-name><surname>Montavon</surname><given-names>G</given-names></string-name>, <string-name><surname>Lapuschkin</surname><given-names>S</given-names></string-name></person-group><etal>et al</etal><article-title>Explaining deep neural networks and beyond: a review of methods and applications</article-title>. <source>Proc IEEE</source><year>2021</year>;<volume>109</volume>:<fpage>247</fpage>–<lpage>78</lpage>.</mixed-citation>
    </ref>
    <ref id="btae063-B51">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Shekhar</surname><given-names>K</given-names></string-name>, <string-name><surname>Lapan</surname><given-names>SW</given-names></string-name>, <string-name><surname>Whitney</surname><given-names>IE</given-names></string-name></person-group><etal>et al</etal><article-title>Comprehensive classification of retinal bipolar neurons by single-cell transcriptomics</article-title>. <source>Cell</source><year>2016</year>;<volume>166</volume>:<fpage>1308</fpage>–<lpage>23.e30</lpage>.<pub-id pub-id-type="pmid">27565351</pub-id></mixed-citation>
    </ref>
    <ref id="btae063-B52">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Shen</surname><given-names>Y</given-names></string-name>, <string-name><surname>Chu</surname><given-names>Q</given-names></string-name>, <string-name><surname>Timko</surname><given-names>MP</given-names></string-name></person-group><etal>et al</etal><article-title>scDetect: a rank-based ensemble learning algorithm for cell type identification of single-cell RNA sequencing in cancer</article-title>. <source>Bioinformatics</source><year>2021</year>;<volume>37</volume>:<fpage>4115</fpage>–<lpage>22</lpage>.<pub-id pub-id-type="pmid">34048541</pub-id></mixed-citation>
    </ref>
    <ref id="btae063-B53">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Strehl</surname><given-names>A</given-names></string-name>, <string-name><surname>Ghosh</surname><given-names>J.</given-names></string-name></person-group><article-title>Cluster ensembles—a knowledge reuse framework for combining multiple partitions</article-title>. <source>J Mach Learn Res</source><year>2003</year>;<volume>3</volume>:<fpage>583</fpage>–<lpage>617</lpage>.</mixed-citation>
    </ref>
    <ref id="btae063-B54">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Sun</surname><given-names>X</given-names></string-name>, <string-name><surname>Lin</surname><given-names>X</given-names></string-name>, <string-name><surname>Li</surname><given-names>Z</given-names></string-name></person-group><etal>et al</etal><article-title>A comprehensive comparison of supervised and unsupervised methods for cell type identification in single-cell RNA-seq</article-title>. <source>Brief Bioinform</source><year>2022</year>;<volume>23</volume>:<fpage>bbab567</fpage>.<pub-id pub-id-type="pmid">35021202</pub-id></mixed-citation>
    </ref>
    <ref id="btae063-B55">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Tang</surname><given-names>F</given-names></string-name>, <string-name><surname>Barbacioru</surname><given-names>C</given-names></string-name>, <string-name><surname>Wang</surname><given-names>Y</given-names></string-name></person-group><etal>et al</etal><article-title>mRNA-Seq whole-transcriptome analysis of a single cell</article-title>. <source>Nat Methods</source><year>2009</year>;<volume>6</volume>:<fpage>377</fpage>–<lpage>82</lpage>.<pub-id pub-id-type="pmid">19349980</pub-id></mixed-citation>
    </ref>
    <ref id="btae063-B56">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Villani</surname><given-names>A-C</given-names></string-name>, <string-name><surname>Satija</surname><given-names>R</given-names></string-name>, <string-name><surname>Reynolds</surname><given-names>G</given-names></string-name></person-group><etal>et al</etal><article-title>Single-cell RNA-seq reveals new types of human blood dendritic cells, monocytes, and progenitors</article-title>. <source>Science</source><year>2017</year>;<volume>356</volume>:<fpage>eaah4573</fpage>.<pub-id pub-id-type="pmid">28428369</pub-id></mixed-citation>
    </ref>
    <ref id="btae063-B57">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Wang</surname><given-names>B</given-names></string-name>, <string-name><surname>Zhu</surname><given-names>J</given-names></string-name>, <string-name><surname>Pierson</surname><given-names>E</given-names></string-name></person-group><etal>et al</etal><article-title>Visualization and analysis of single-cell RNA-seq data by kernel-based similarity learning</article-title>. <source>Nat Methods</source><year>2017</year>;<volume>14</volume>:<fpage>414</fpage>–<lpage>6</lpage>.<pub-id pub-id-type="pmid">28263960</pub-id></mixed-citation>
    </ref>
    <ref id="btae063-B58">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Wang</surname><given-names>L</given-names></string-name>, <string-name><surname>Catalan</surname><given-names>F</given-names></string-name>, <string-name><surname>Shamardani</surname><given-names>K</given-names></string-name></person-group><etal>et al</etal><article-title>Ensemble learning for classifying single-cell data and projection across reference atlases</article-title>. <source>Bioinformatics</source><year>2020a</year>;<volume>36</volume>:<fpage>3585</fpage>–<lpage>7</lpage>.<pub-id pub-id-type="pmid">32105316</pub-id></mixed-citation>
    </ref>
    <ref id="btae063-B59">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Wang</surname><given-names>L</given-names></string-name>, <string-name><surname>Nie</surname><given-names>R</given-names></string-name>, <string-name><surname>Yu</surname><given-names>Z</given-names></string-name></person-group><etal>et al</etal><article-title>An interpretable deep-learning architecture of capsule networks for identifying cell-type gene expression programs from single-cell RNA-sequencing data</article-title>. <source>Nat Mach Intell</source><year>2020b</year>;<volume>2</volume>:<fpage>693</fpage>–<lpage>703</lpage>.</mixed-citation>
    </ref>
    <ref id="btae063-B60">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Wolf</surname><given-names>FA</given-names></string-name>, <string-name><surname>Angerer</surname><given-names>P</given-names></string-name>, <string-name><surname>Theis</surname><given-names>FJ.</given-names></string-name></person-group><article-title>SCANPY: large-scale single-cell gene expression data analysis</article-title>. <source>Genome Biol</source><year>2018</year>;<volume>19</volume>:<fpage>15</fpage>.<pub-id pub-id-type="pmid">29409532</pub-id></mixed-citation>
    </ref>
    <ref id="btae063-B61">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Xie</surname><given-names>P</given-names></string-name>, <string-name><surname>Gao</surname><given-names>M</given-names></string-name>, <string-name><surname>Wang</surname><given-names>C</given-names></string-name></person-group><etal>et al</etal><article-title>SuperCT: a supervised-learning framework for enhanced characterization of single-cell transcriptomic profiles</article-title>. <source>Nucleic Acids Res</source><year>2019</year>;<volume>47</volume>:<fpage>e48</fpage>.<pub-id pub-id-type="pmid">30799483</pub-id></mixed-citation>
    </ref>
    <ref id="btae063-B62">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Xu</surname><given-names>C</given-names></string-name>, <string-name><surname>Su</surname><given-names>Z.</given-names></string-name></person-group><article-title>Identification of cell types from single-cell transcriptomes using a novel clustering method</article-title>. <source>Bioinformatics</source><year>2015</year>;<volume>31</volume>:<fpage>1974</fpage>–<lpage>80</lpage>.<pub-id pub-id-type="pmid">25805722</pub-id></mixed-citation>
    </ref>
    <ref id="btae063-B63">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Yamashita</surname><given-names>R</given-names></string-name>, <string-name><surname>Nishio</surname><given-names>M</given-names></string-name>, <string-name><surname>Do</surname><given-names>RKG</given-names></string-name></person-group><etal>et al</etal><article-title>Convolutional neural networks: an overview and application in radiology</article-title>. <source>Insights Imaging</source><year>2018</year>;<volume>9</volume>:<fpage>611</fpage>–<lpage>29</lpage>.<pub-id pub-id-type="pmid">29934920</pub-id></mixed-citation>
    </ref>
    <ref id="btae063-B64">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Yang</surname><given-names>F</given-names></string-name>, <string-name><surname>Wang</surname><given-names>W</given-names></string-name>, <string-name><surname>Wang</surname><given-names>F</given-names></string-name></person-group><etal>et al</etal><article-title>scBERT as a large-scale pretrained deep language model for cell type annotation of single-cell RNA-seq data</article-title>. <source>Nat Mach Intell</source><year>2022</year>;<volume>4</volume>:<fpage>852</fpage>–<lpage>66</lpage>.</mixed-citation>
    </ref>
    <ref id="btae063-B65">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Yang</surname><given-names>K-T-T.</given-names></string-name></person-group><article-title>Artificial neural networks (ANNs): a new paradigm for thermal science and engineering</article-title>. <source>J Heat Transfer Trans ASME</source><year>2008</year>;<volume>130</volume>:<fpage>093001</fpage>.</mixed-citation>
    </ref>
    <ref id="btae063-B66">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Yin</surname><given-names>Q</given-names></string-name>, <string-name><surname>Liu</surname><given-names>Q</given-names></string-name>, <string-name><surname>Fu</surname><given-names>Z</given-names></string-name></person-group><etal>et al</etal><article-title>scGraph: a graph neural network-based approach to automatically identify cell types</article-title>. <source>Bioinformatics</source><year>2022</year>;<volume>38</volume>:<fpage>2996</fpage>–<lpage>3003</lpage>.<pub-id pub-id-type="pmid">35394015</pub-id></mixed-citation>
    </ref>
    <ref id="btae063-B67">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Zeng</surname><given-names>Y</given-names></string-name>, <string-name><surname>Wei</surname><given-names>Z</given-names></string-name>, <string-name><surname>Pan</surname><given-names>Z</given-names></string-name></person-group><etal>et al</etal><article-title>A robust and scalable graph neural network for accurate single-cell classification</article-title>. <source>Brief Bioinform</source><year>2022</year>;<volume>23</volume>:<fpage>bbab570</fpage>.<pub-id pub-id-type="pmid">35018408</pub-id></mixed-citation>
    </ref>
    <ref id="btae063-B68">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Zhou</surname><given-names>J</given-names></string-name>, <string-name><surname>Cui</surname><given-names>G</given-names></string-name>, <string-name><surname>Hu</surname><given-names>S</given-names></string-name></person-group><etal>et al</etal><article-title>Graph neural networks: a review of methods and applications</article-title>. <source>AI Open</source><year>2020</year>;<volume>1</volume>:<fpage>57</fpage>–<lpage>81</lpage>.</mixed-citation>
    </ref>
    <ref id="btae063-B69">
      <mixed-citation publication-type="book"><person-group person-group-type="author"><string-name><surname>Zhou</surname><given-names>Z-H.</given-names></string-name></person-group><source>Ensemble Methods Foundations and Algorithms</source>. United States: <publisher-name>CRC Press</publisher-name>, <year>2012</year>.</mixed-citation>
    </ref>
    <ref id="btae063-B70">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Žurauskienė</surname><given-names>J</given-names></string-name>, <string-name><surname>Yau</surname><given-names>C.</given-names></string-name></person-group><article-title>pcaReduce: hierarchical clustering of single cell transcriptional profiles</article-title>. <source>BMC Bioinformatics</source><year>2016</year>;<volume>17</volume>:<fpage>140</fpage>.<pub-id pub-id-type="pmid">27005807</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.2 20190208//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.2?>
<?ConverterInfo.XSLTName jats2jats3.xsl?>
<?ConverterInfo.Version 1?>
<?properties open_access?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">Bioinformatics</journal-id>
    <journal-id journal-id-type="publisher-id">bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1367-4803</issn>
    <issn pub-type="epub">1367-4811</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">10873586</article-id>
    <article-id pub-id-type="pmid">38317054</article-id>
    <article-id pub-id-type="doi">10.1093/bioinformatics/btae063</article-id>
    <article-id pub-id-type="publisher-id">btae063</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Original Paper</subject>
        <subj-group subj-group-type="category-toc-heading">
          <subject>Gene Expression</subject>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="category-taxonomy-collection">
        <subject>AcademicSubjects/SCI01060</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>CTISL: a dynamic stacking multi-class classification approach for identifying cell types from single-cell RNA-seq data</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Wang</surname>
          <given-names>Xiao</given-names>
        </name>
        <role vocab="credit" vocab-identifier="https://credit.niso.org" vocab-term="Data curation" vocab-term-identifier="https://credit.niso.org/contributor-roles/data-curation" degree-contribution="lead">Data curation</role>
        <role vocab="credit" vocab-identifier="https://credit.niso.org" vocab-term="Formal analysis" vocab-term-identifier="https://credit.niso.org/contributor-roles/formal-analysis" degree-contribution="lead">Formal analysis</role>
        <role vocab="credit" vocab-identifier="https://credit.niso.org" vocab-term="Methodology" vocab-term-identifier="https://credit.niso.org/contributor-roles/methodology" degree-contribution="lead">Methodology</role>
        <role vocab="credit" vocab-identifier="https://credit.niso.org" vocab-term="Software" vocab-term-identifier="https://credit.niso.org/contributor-roles/software" degree-contribution="lead">Software</role>
        <role vocab="credit" vocab-identifier="https://credit.niso.org" vocab-term="Validation" vocab-term-identifier="https://credit.niso.org/contributor-roles/validation" degree-contribution="lead">Validation</role>
        <role vocab="credit" vocab-identifier="https://credit.niso.org" vocab-term="Visualization" vocab-term-identifier="https://credit.niso.org/contributor-roles/visualization" degree-contribution="lead">Visualization</role>
        <role vocab="credit" vocab-identifier="https://credit.niso.org" vocab-term="Writing - original draft" vocab-term-identifier="https://credit.niso.org/contributor-roles/writing-original-draft" degree-contribution="lead">Writing - original draft</role>
        <role vocab="credit" vocab-identifier="https://credit.niso.org" vocab-term="Writing - review &amp; editing" vocab-term-identifier="https://credit.niso.org/contributor-roles/writing-review-editing" degree-contribution="equal">Writing - review &amp; editing</role>
        <aff><institution>Department of Software Engineering, College of Information Engineering, Northwest A&amp;F University</institution>, Yangling 712100, <country country="CN">China</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Chai</surname>
          <given-names>Ziyi</given-names>
        </name>
        <role vocab="credit" vocab-identifier="https://credit.niso.org" vocab-term="Data curation" vocab-term-identifier="https://credit.niso.org/contributor-roles/data-curation" degree-contribution="supporting">Data curation</role>
        <role vocab="credit" vocab-identifier="https://credit.niso.org" vocab-term="Methodology" vocab-term-identifier="https://credit.niso.org/contributor-roles/methodology" degree-contribution="supporting">Methodology</role>
        <aff><institution>Department of Software Engineering, College of Information Engineering, Northwest A&amp;F University</institution>, Yangling 712100, <country country="CN">China</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Li</surname>
          <given-names>Shaohua</given-names>
        </name>
        <role vocab="credit" vocab-identifier="https://credit.niso.org" vocab-term="Data curation" vocab-term-identifier="https://credit.niso.org/contributor-roles/data-curation" degree-contribution="supporting">Data curation</role>
        <role vocab="credit" vocab-identifier="https://credit.niso.org" vocab-term="Methodology" vocab-term-identifier="https://credit.niso.org/contributor-roles/methodology" degree-contribution="supporting">Methodology</role>
        <aff><institution>Department of Software Engineering, College of Information Engineering, Northwest A&amp;F University</institution>, Yangling 712100, <country country="CN">China</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0002-5331-3655</contrib-id>
        <name>
          <surname>Liu</surname>
          <given-names>Yan</given-names>
        </name>
        <role vocab="credit" vocab-identifier="https://credit.niso.org" vocab-term="Methodology" vocab-term-identifier="https://credit.niso.org/contributor-roles/methodology" degree-contribution="supporting">Methodology</role>
        <role vocab="credit" vocab-identifier="https://credit.niso.org" vocab-term="Writing - review &amp; editing" vocab-term-identifier="https://credit.niso.org/contributor-roles/writing-review-editing" degree-contribution="supporting">Writing - review &amp; editing</role>
        <aff><institution>School of Computer Science and Engineering, Nanjing University of Science and Technology</institution>, Nanjing 210094, <country country="CN">China</country></aff>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0002-1847-754X</contrib-id>
        <name>
          <surname>Li</surname>
          <given-names>Chen</given-names>
        </name>
        <role vocab="credit" vocab-identifier="https://credit.niso.org" vocab-term="Conceptualization" vocab-term-identifier="https://credit.niso.org/contributor-roles/conceptualization" degree-contribution="equal">Conceptualization</role>
        <role vocab="credit" vocab-identifier="https://credit.niso.org" vocab-term="Investigation" vocab-term-identifier="https://credit.niso.org/contributor-roles/investigation" degree-contribution="equal">Investigation</role>
        <role vocab="credit" vocab-identifier="https://credit.niso.org" vocab-term="Supervision" vocab-term-identifier="https://credit.niso.org/contributor-roles/supervision" degree-contribution="equal">Supervision</role>
        <role vocab="credit" vocab-identifier="https://credit.niso.org" vocab-term="Visualization" vocab-term-identifier="https://credit.niso.org/contributor-roles/visualization" degree-contribution="lead">Visualization</role>
        <role vocab="credit" vocab-identifier="https://credit.niso.org" vocab-term="Writing - original draft" vocab-term-identifier="https://credit.niso.org/contributor-roles/writing-original-draft" degree-contribution="equal">Writing - original draft</role>
        <role vocab="credit" vocab-identifier="https://credit.niso.org" vocab-term="Writing - review &amp; editing" vocab-term-identifier="https://credit.niso.org/contributor-roles/writing-review-editing" degree-contribution="lead">Writing - review &amp; editing</role>
        <aff><institution>Department of Biochemistry and Molecular Biology, Monash University</institution>, Melbourne, VIC 3800, <country country="AU">Australia</country></aff>
        <xref rid="btae063-cor1" ref-type="corresp"/>
        <!--chen.li@monash.edu-->
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0003-4821-3585</contrib-id>
        <name>
          <surname>Jiang</surname>
          <given-names>Yu</given-names>
        </name>
        <role vocab="credit" vocab-identifier="https://credit.niso.org" vocab-term="Conceptualization" vocab-term-identifier="https://credit.niso.org/contributor-roles/conceptualization" degree-contribution="equal">Conceptualization</role>
        <role vocab="credit" vocab-identifier="https://credit.niso.org" vocab-term="Investigation" vocab-term-identifier="https://credit.niso.org/contributor-roles/investigation" degree-contribution="equal">Investigation</role>
        <role vocab="credit" vocab-identifier="https://credit.niso.org" vocab-term="Supervision" vocab-term-identifier="https://credit.niso.org/contributor-roles/supervision" degree-contribution="equal">Supervision</role>
        <role vocab="credit" vocab-identifier="https://credit.niso.org" vocab-term="Visualization" vocab-term-identifier="https://credit.niso.org/contributor-roles/visualization" degree-contribution="equal">Visualization</role>
        <role vocab="credit" vocab-identifier="https://credit.niso.org" vocab-term="Writing - review &amp; editing" vocab-term-identifier="https://credit.niso.org/contributor-roles/writing-review-editing" degree-contribution="equal">Writing - review &amp; editing</role>
        <aff><institution>Department of Animal Genetics, Breeding and Reproduction, College of Animal Science and Technology, Northwest A&amp;F University</institution>, Yangling 712100, <country country="CN">China</country></aff>
        <xref rid="btae063-cor3" ref-type="corresp"/>
        <!--yu.jiang@nwafu.edu.cn-->
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <name>
          <surname>Liu</surname>
          <given-names>Quanzhong</given-names>
        </name>
        <role vocab="credit" vocab-identifier="https://credit.niso.org" vocab-term="Conceptualization" vocab-term-identifier="https://credit.niso.org/contributor-roles/conceptualization" degree-contribution="lead">Conceptualization</role>
        <role vocab="credit" vocab-identifier="https://credit.niso.org" vocab-term="Funding acquisition" vocab-term-identifier="https://credit.niso.org/contributor-roles/funding-acquisition" degree-contribution="lead">Funding acquisition</role>
        <role vocab="credit" vocab-identifier="https://credit.niso.org" vocab-term="Investigation" vocab-term-identifier="https://credit.niso.org/contributor-roles/investigation" degree-contribution="lead">Investigation</role>
        <role vocab="credit" vocab-identifier="https://credit.niso.org" vocab-term="Supervision" vocab-term-identifier="https://credit.niso.org/contributor-roles/supervision" degree-contribution="lead">Supervision</role>
        <role vocab="credit" vocab-identifier="https://credit.niso.org" vocab-term="Visualization" vocab-term-identifier="https://credit.niso.org/contributor-roles/visualization" degree-contribution="supporting">Visualization</role>
        <role vocab="credit" vocab-identifier="https://credit.niso.org" vocab-term="Writing - original draft" vocab-term-identifier="https://credit.niso.org/contributor-roles/writing-original-draft" degree-contribution="equal">Writing - original draft</role>
        <role vocab="credit" vocab-identifier="https://credit.niso.org" vocab-term="Writing - review &amp; editing" vocab-term-identifier="https://credit.niso.org/contributor-roles/writing-review-editing" degree-contribution="equal">Writing - review &amp; editing</role>
        <aff><institution>Department of Software Engineering, College of Information Engineering, Northwest A&amp;F University</institution>, Yangling 712100, <country country="CN">China</country></aff>
        <aff><institution>Shaanxi Engineering Research Center of Agricultural Information Intelligent Perception and Analysis, Northwest A&amp;F University</institution>, Yangling 712100, <country country="CN">China</country></aff>
        <xref rid="btae063-cor2" ref-type="corresp"/>
        <!--liuqzhong@nwafu.edu.cn-->
      </contrib>
    </contrib-group>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Mathelier</surname>
          <given-names>Anthony</given-names>
        </name>
        <role>Associate Editor</role>
      </contrib>
    </contrib-group>
    <author-notes>
      <corresp id="btae063-cor1">Corresponding authors. Department of Biochemistry and Molecular Biology, Monash University, Melbourne, VIC 3800, Australia. E-mail <email>chen.li@monash.edu</email> (C.L.)</corresp>
      <corresp id="btae063-cor2">Department of Software Engineering, College of Information Engineering, Northwest A&amp;F University, Yangling 712100, China. E-mail: <email>liuqzhong@nwafu.edu.cn</email> (Q.L.)</corresp>
      <corresp id="btae063-cor3">Department of Animal Genetics, Breeding and Reproduction, College of Animal Science and Technology, Northwest A&amp;F University, Yangling 712100, China. E-mail: <email>yu.jiang@nwafu.edu.cn</email> (Y.J.)</corresp>
    </author-notes>
    <pub-date pub-type="collection">
      <month>2</month>
      <year>2024</year>
    </pub-date>
    <pub-date pub-type="epub" iso-8601-date="2024-02-05">
      <day>05</day>
      <month>2</month>
      <year>2024</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>05</day>
      <month>2</month>
      <year>2024</year>
    </pub-date>
    <volume>40</volume>
    <issue>2</issue>
    <elocation-id>btae063</elocation-id>
    <history>
      <date date-type="received">
        <day>15</day>
        <month>2</month>
        <year>2024</year>
      </date>
      <date date-type="rev-recd">
        <day>15</day>
        <month>2</month>
        <year>2024</year>
      </date>
      <date date-type="editorial-decision">
        <day>15</day>
        <month>2</month>
        <year>2024</year>
      </date>
      <date date-type="accepted">
        <day>15</day>
        <month>2</month>
        <year>2024</year>
      </date>
      <date date-type="corrected-typeset">
        <day>15</day>
        <month>2</month>
        <year>2024</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2024. Published by Oxford University Press.</copyright-statement>
      <copyright-year>2024</copyright-year>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">https://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted reuse, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <self-uri xlink:href="btae063.pdf"/>
    <abstract>
      <title>Abstract</title>
      <sec id="s1">
        <title>Motivation</title>
        <p>Effective identification of cell types is of critical importance in single-cell RNA-sequencing (scRNA-seq) data analysis. To date, many supervised machine learning-based predictors have been implemented to identify cell types from scRNA-seq datasets. Despite the technical advances of these state-of-the-art tools, most existing predictors were single classifiers, of which the performances can still be significantly improved. It is therefore highly desirable to employ the ensemble learning strategy to develop more accurate computational models for robust and comprehensive identification of cell types on scRNA-seq datasets.</p>
      </sec>
      <sec id="s2">
        <title>Results</title>
        <p>We propose a two-layer stacking model, termed CTISL (Cell Type Identification by Stacking ensemble Learning), which integrates multiple classifiers to identify cell types. In the first layer, given a reference scRNA-seq dataset with known cell types, CTISL dynamically combines multiple cell-type-specific classifiers (i.e. support-vector machine and logistic regression) as the base learners to deliver the outcomes for the input of a meta-classifier in the second layer. We conducted a total of 24 benchmarking experiments on 17 human and mouse scRNA-seq datasets to evaluate and compare the prediction performance of CTISL and other state-of-the-art predictors. The experiment results demonstrate that CTISL achieves superior or competitive performance compared to these state-of-the-art approaches. We anticipate that CTISL can serve as a useful and reliable tool for cost-effective identification of cell types from scRNA-seq datasets.</p>
      </sec>
      <sec id="s3">
        <title>Availability and implementation</title>
        <p>The webserver and source code are freely available at <ext-link xlink:href="http://bigdata.biocie.cn/CTISLweb/home" ext-link-type="uri">http://bigdata.biocie.cn/CTISLweb/home</ext-link> and <ext-link xlink:href="https://zenodo.org/records/10568906" ext-link-type="uri">https://zenodo.org/records/10568906</ext-link>, respectively.</p>
      </sec>
    </abstract>
    <funding-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>National Key Research and Development Program of China</institution>
            <institution-id institution-id-type="DOI">10.13039/501100012166</institution-id>
          </institution-wrap>
        </funding-source>
        <award-id>2022YFF1000100</award-id>
      </award-group>
    </funding-group>
    <counts>
      <page-count count="10"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec>
    <title>1 Introduction</title>
    <p>Single-cell RNA (scRNA)-seq techniques have been widely applied to profile transcriptomic data at the single-cell level (<xref rid="btae063-B55" ref-type="bibr">Tang <italic toggle="yes">et al.</italic> 2009</xref>). Identification of the cell types has therefore become a critical step in scRNA-seq data analysis (<xref rid="btae063-B26" ref-type="bibr">Huang and Zhang 2021</xref>). Traditionally, the types of cells were annotated based on their shapes, sizes, and other features observed via microscope anatomy, histology, and pathology (<xref rid="btae063-B5" ref-type="bibr">Arendt <italic toggle="yes">et al.</italic> 2016</xref>, <xref rid="btae063-B29" ref-type="bibr">Kiselev <italic toggle="yes">et al.</italic> 2019</xref>). The advances in scRNA-seq techniques have allowed the fast accumulation of sequencing data, which requires the assistance of computational and artificial intelligence-guided approaches for the accurate and robust annotation of cell types (<xref rid="btae063-B39" ref-type="bibr">Ma <italic toggle="yes">et al.</italic> 2021</xref>, <xref rid="btae063-B54" ref-type="bibr">Sun <italic toggle="yes">et al.</italic> 2022</xref>). Particularly, machine learning (ML)-based approaches have shown their great capability of handling large-scale datasets for annotating cell types. In recent years, various ML-based approaches have been developed to annotate cell types using scRNA-seq datasets. These methods can be broadly classified into two main categories: unsupervised and supervised approaches.</p>
    <p>Unsupervised methods, such as RaceID (<xref rid="btae063-B22" ref-type="bibr">Grün <italic toggle="yes">et al.</italic> 2015</xref>), SNN-Cliq (<xref rid="btae063-B62" ref-type="bibr">Xu and Su 2015</xref>), SINCERA (<xref rid="btae063-B23" ref-type="bibr">Guo <italic toggle="yes">et al.</italic> 2015</xref>), pcaReduce (<xref rid="btae063-B70" ref-type="bibr">Žurauskienė and Yau 2016</xref>), GiniClust (<xref rid="btae063-B28" ref-type="bibr">Jiang <italic toggle="yes">et al.</italic> 2016</xref>), SIMLR (<xref rid="btae063-B57" ref-type="bibr">Wang <italic toggle="yes">et al.</italic> 2017</xref>), SC3 (<xref rid="btae063-B30" ref-type="bibr">Kiselev <italic toggle="yes">et al.</italic> 2017</xref>), SCENIC (<xref rid="btae063-B2" ref-type="bibr">Aibar <italic toggle="yes">et al.</italic> 2017</xref>), Scanpy (<xref rid="btae063-B60" ref-type="bibr">Wolf <italic toggle="yes">et al.</italic> 2018</xref>), and SCENA (<xref rid="btae063-B14" ref-type="bibr">Cui <italic toggle="yes">et al.</italic> 2021</xref>), cluster cells into different groups using various methods, e.g. <italic toggle="yes">K</italic>-means (<xref rid="btae063-B10" ref-type="bibr">Celebi <italic toggle="yes">et al.</italic> 2013</xref>), Shared Nearest Neighbor (<xref rid="btae063-B18" ref-type="bibr">Ertoz <italic toggle="yes">et al.</italic> 2002</xref>), and cluster-based similarity partitioning algorithm (<xref rid="btae063-B53" ref-type="bibr">Strehl and Ghosh 2003</xref>). Although unsupervised clustering-based methods achieved outstanding performances in annotating cell types, many challenges remain (<xref rid="btae063-B29" ref-type="bibr">Kiselev <italic toggle="yes">et al.</italic> 2019</xref>), such as the ambiguous number of cell-type clusters (<xref rid="btae063-B46" ref-type="bibr">Qi <italic toggle="yes">et al.</italic> 2020</xref>), model and parameter dependency (<xref rid="btae063-B61" ref-type="bibr">Xie <italic toggle="yes">et al.</italic> 2019</xref>), unsatisfactory performance on imbalanced clusters (<xref rid="btae063-B39" ref-type="bibr">Ma <italic toggle="yes">et al.</italic> 2021</xref>), and poor reproducibility (<xref rid="btae063-B11" ref-type="bibr">Chen <italic toggle="yes">et al.</italic> 2022</xref>). Moreover, unsupervised methods are usually constructed based on the assumption that all cells in each cluster belong to the same cell type. In fact, a cluster is often mixed with a major cell type and small percentages of other cell types (<xref rid="btae063-B3" ref-type="bibr">Alquicira-Hernandez <italic toggle="yes">et al.</italic> 2019</xref>), which makes it challenging to effectively annotate cell types in such clusters (<xref rid="btae063-B29" ref-type="bibr">Kiselev <italic toggle="yes">et al.</italic> 2019</xref>, <xref rid="btae063-B44" ref-type="bibr">Pliner <italic toggle="yes">et al.</italic> 2019</xref>).</p>
    <p>Supervised ML-based methods, on the other hand, have been increasingly popular in recent years (<xref rid="btae063-B39" ref-type="bibr">Ma <italic toggle="yes">et al.</italic> 2021</xref>). These supervised methods can be further classified into two categories: traditional ML- and deep learning (DL)-based approaches. Traditional ML-based approaches, such as scPred (<xref rid="btae063-B3" ref-type="bibr">Alquicira-Hernandez <italic toggle="yes">et al.</italic> 2019</xref>), scClassify (<xref rid="btae063-B35" ref-type="bibr">Lin <italic toggle="yes">et al.</italic> 2020</xref>), ELSA (<xref rid="btae063-B58" ref-type="bibr">Wang <italic toggle="yes">et al.</italic> 2020</xref>a), scDetect (<xref rid="btae063-B52" ref-type="bibr">Shen <italic toggle="yes">et al.</italic> 2021</xref>), CellTypist (<xref rid="btae063-B17" ref-type="bibr">Domínguez Conde <italic toggle="yes">et al.</italic> 2022</xref>), scmap (<xref rid="btae063-B31" ref-type="bibr">Kiselev <italic toggle="yes">et al.</italic> 2018</xref>), SingleR (<xref rid="btae063-B4" ref-type="bibr">Aran <italic toggle="yes">et al.</italic> 2019</xref>), and scAnnotatR (<xref rid="btae063-B42" ref-type="bibr">Nguyen and Griss 2022</xref>), often employ classic ML models, such as Support-Vector Machines (SVM) (<xref rid="btae063-B12" ref-type="bibr">Cortes and Vapnik 1995</xref>), <italic toggle="yes">K</italic>-Nearest Neighbors (<xref rid="btae063-B13" ref-type="bibr">Cover and Hart 1967</xref>), Random Forest (RF) (<xref rid="btae063-B8" ref-type="bibr">Breiman 2001</xref>), Logistic Regression (LR) (<xref rid="btae063-B41" ref-type="bibr">Lecessie and van Houwelingen 1992</xref>), and Bootstrap (<xref rid="btae063-B21" ref-type="bibr">Fushiki 2010</xref>), etc. While DL-based approaches employ state-of-the-art neural network-based algorithms, including Artificial Neural Networks (<xref rid="btae063-B65" ref-type="bibr">Yang 2008</xref>), Convolutional Neural Networks (<xref rid="btae063-B63" ref-type="bibr">Yamashita <italic toggle="yes">et al.</italic> 2018</xref>), Deep Neural Networks (<xref rid="btae063-B50" ref-type="bibr">Samek <italic toggle="yes">et al.</italic> 2021</xref>), Capsule Neural Networks (<xref rid="btae063-B49" ref-type="bibr">Sabour <italic toggle="yes">et al.</italic> 2017</xref>), and Graph Neural Networks (<xref rid="btae063-B68" ref-type="bibr">Zhou <italic toggle="yes">et al.</italic> 2020</xref>), to achieve superior annotation performance. Representative DL-based approaches include SuperCT (<xref rid="btae063-B61" ref-type="bibr">Xie <italic toggle="yes">et al.</italic> 2019</xref>), ACTINN (<xref rid="btae063-B38" ref-type="bibr">Ma and Pellegrini 2020</xref>), scCapsNet (<xref rid="btae063-B58" ref-type="bibr">Wang <italic toggle="yes">et al.</italic> 2020</xref>b), scGraph (<xref rid="btae063-B66" ref-type="bibr">Yin <italic toggle="yes">et al.</italic> 2022</xref>), GraphCS (<xref rid="btae063-B67" ref-type="bibr">Zeng <italic toggle="yes">et al.</italic> 2022</xref>), TripletCell (<xref rid="btae063-B36" ref-type="bibr">Liu <italic toggle="yes">et al.</italic> 2023</xref>), scBERT (<xref rid="btae063-B64" ref-type="bibr">Yang <italic toggle="yes">et al.</italic> 2022</xref>), and scDeepInsight (<xref rid="btae063-B27" ref-type="bibr">Jia <italic toggle="yes">et al.</italic> 2023</xref>).</p>
    <p>Some comprehensive reviews have thoroughly evaluated a number of supervised models for the identification of cell types (<xref rid="btae063-B1" ref-type="bibr">Abdelaal <italic toggle="yes">et al.</italic> 2019</xref>, <xref rid="btae063-B26" ref-type="bibr">Huang and Zhang 2021</xref>, <xref rid="btae063-B39" ref-type="bibr">Ma <italic toggle="yes">et al.</italic> 2021</xref>). Most supervised-based methods first used a scRNA-seq dataset with known cell types to train a multi-class classification model and then loaded the trained model to predict the type of each cell in a new scRNA-seq dataset. Despite that supervised methods generally outperform unsupervised cell clustering methods (<xref rid="btae063-B39" ref-type="bibr">Ma <italic toggle="yes">et al.</italic> 2021</xref>), most of these supervised methods are based on a single classifier. On the other hand, it has been widely accepted that ensemble multiple classifiers usually outperform the performance of a single learner (<xref rid="btae063-B69" ref-type="bibr">Zhou 2012</xref>). For example, scDetect (<xref rid="btae063-B52" ref-type="bibr">Shen <italic toggle="yes">et al.</italic> 2021</xref>) achieved outstanding cell-type identification performance by implementing multiple <italic toggle="yes">k</italic>-Top Scoring Pairs classifiers with a weighted majority voting strategy to identify cell types from scRNA-seq data.</p>
    <p>In this study, we developed a two-layer dynamic ensemble learning model, termed CTISL (Cell Type Identification by Stacking ensemble Learning), for accurate cell-type prediction in scRNA-seq data. In CTISL, cell-type identification is regarded as a multi-class classification task. A variety of features were extracted to build multiple base learners for different cell-type categories. We selected the best-performing classifiers as base learners in CTISL according to our extensive experiments and a recent study evaluating the performance of various individual classifiers in cell-type identification using scRNA-seq datasets (<xref rid="btae063-B26" ref-type="bibr">Huang and Zhang 2021</xref>). Our extensive performance benchmarking experiments on scRNA-seq datasets of various species, tissues, batches, and protocols show that CTISL achieved outstanding performance and strong stability compared to state-of-the-art traditional ML and DL methods, demonstrating that the stacking ensemble learning technique is an effective approach to achieving more robust performance for cell-type annotation. Overall, our dynamic ensemble learning model provides a promising approach for accurately identifying cell types in scRNA-seq datasets, with the potential to advance biomedical research and clinical applications.</p>
  </sec>
  <sec>
    <title>2 Materials and methods</title>
    <sec>
      <title>2.1 Dataset collection</title>
      <p>We collected in total 17 scRNA-seq datasets of two species (<italic toggle="yes">Homo sapiens</italic> and <italic toggle="yes">Mus musculus</italic>) from various tissues, batches, and protocols to train and evaluate CTISL and other benchmarked methods. Among these datasets, seven are derived from human peripheral blood mononuclear cell (PBMC) samples (<xref rid="btae063-B16" ref-type="bibr">Ding <italic toggle="yes">et al.</italic> 2020</xref>) and were used for inter- and intra-dataset evaluations. Several pairs of datasets with different batches were extracted from various cells, including human blood dendritic cells (<xref rid="btae063-B56" ref-type="bibr">Villani <italic toggle="yes">et al.</italic> 2017</xref>), namely Dendritic_batch1 and Dendritic_batch2, and mouse retinal bipolar cells (<xref rid="btae063-B51" ref-type="bibr">Shekhar <italic toggle="yes">et al.</italic> 2016</xref>), namely Retina(5)_batch1 and Retina(5)_batch2, and Retina(19)_batch1 and Retina(19)_batch2. Each of the three pairs was used for cross-batch evaluations. In addition, two datasets from human and mouse airway (<xref rid="btae063-B43" ref-type="bibr">Plasschaert <italic toggle="yes">et al.</italic> 2018</xref>) and pancreas (<xref rid="btae063-B6" ref-type="bibr">Baron <italic toggle="yes">et al.</italic> 2016</xref>) were extracted, namely “HumanAirway,” “MouseAirway,” “HumanPancreas,” and “MousePancreas,” respectively. Each pair of datasets is from the same tissue of two species and was used for cross-species evaluations. A detailed description of these 17 scRNA-seq datasets is provided in <xref rid="sup1" ref-type="supplementary-material">Supplementary Table S1</xref>.</p>
    </sec>
    <sec>
      <title>2.2 The CTISL framework</title>
      <p>As illustrated in <xref rid="btae063-F1" ref-type="fig">Fig. 1</xref>, the construction of CTISL consists of four steps: dataset pre-processing, feature selection, stacking model construction, and model evaluation.</p>
      <fig position="float" id="btae063-F1">
        <label>Figure 1.</label>
        <caption>
          <p>The construction of the CTISL framework includes four major steps, including (A) dataset pre-processing, (B) feature selection, (C) dynamic stacking model construction, and (D) model evaluation.</p>
        </caption>
        <graphic xlink:href="btae063f1" position="float"/>
      </fig>
      <p><bold>Step 1. Dataset pre-processing:</bold> We employed the Scanpy package (<xref rid="btae063-B60" ref-type="bibr">Wolf <italic toggle="yes">et al.</italic> 2018</xref>) to perform scRNA-seq data pre-processing (<xref rid="btae063-F1" ref-type="fig">Fig. 1A</xref>). In the cell normalization step, the expression value of each gene in each cell was divided by the total sum of gene expression values in that cell and then multiplied by a constant 10e4. Other pre-processing steps remain consistent with the previous study (<xref rid="btae063-B25" ref-type="bibr">Hu <italic toggle="yes">et al.</italic> 2020</xref>). Note that the dataset pre-processing step is performed separately for training and testing datasets.</p>
      <p><bold>Step 2. Feature selection:</bold> A scRNA-seq dataset <inline-formula id="IE1"><mml:math id="IM1" display="inline" overflow="scroll"><mml:mi mathvariant="normal">D</mml:mi></mml:math></inline-formula> can be represented as an <inline-formula id="IE2"><mml:math id="IM2" display="inline" overflow="scroll"><mml:mi>n</mml:mi><mml:mo>×</mml:mo><mml:mi>m</mml:mi></mml:math></inline-formula> matrix, where <inline-formula id="IE3"><mml:math id="IM3" display="inline" overflow="scroll"><mml:mi>n</mml:mi></mml:math></inline-formula> and <inline-formula id="IE4"><mml:math id="IM4" display="inline" overflow="scroll"><mml:mi>m</mml:mi></mml:math></inline-formula> are the numbers of cells and genes, respectively. <inline-formula id="IE5"><mml:math id="IM5" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>D</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mfenced open="(" close=")" separators="|"><mml:mrow><mml:mn>1</mml:mn><mml:mo>≤</mml:mo><mml:mi>i</mml:mi><mml:mo>≤</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:mfenced></mml:math></inline-formula> represents the <italic toggle="yes">i</italic>-th cell, and <inline-formula id="IE6"><mml:math id="IM6" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>D</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mfenced open="(" close=")" separators="|"><mml:mrow><mml:mn>1</mml:mn><mml:mo>≤</mml:mo><mml:mi>i</mml:mi><mml:mo>≤</mml:mo><mml:mi>n</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="normal"> </mml:mi><mml:mn>1</mml:mn><mml:mo>≤</mml:mo><mml:mi>j</mml:mi><mml:mo>≤</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:mfenced></mml:math></inline-formula> denotes the expression value of the <inline-formula id="IE7"><mml:math id="IM7" display="inline" overflow="scroll"><mml:mi>j</mml:mi></mml:math></inline-formula>-th gene in <inline-formula id="IE8"><mml:math id="IM8" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>D</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula>. As there is usually more than one cell type in <inline-formula id="IE9"><mml:math id="IM9" display="inline" overflow="scroll"><mml:mi>D</mml:mi></mml:math></inline-formula>, cell-type identification is formulated as a multi-class classification task. Generally, <inline-formula id="IE10"><mml:math id="IM10" display="inline" overflow="scroll"><mml:mi>D</mml:mi></mml:math></inline-formula> contains high-dimensional features (genes) and small size of samples (cells). The high number of redundant genes might decrease the predictive performance of the model. To find a better gene subset for identifying cell types, we employed χ<sup>2</sup> (<xref rid="btae063-B19" ref-type="bibr">Forman 2003</xref>), a popular feature selection method, to select the genes related to cell types. Suppose <inline-formula id="IE11"><mml:math id="IM11" display="inline" overflow="scroll"><mml:mi>D</mml:mi></mml:math></inline-formula> contains <italic toggle="yes">t</italic> cell types, and<inline-formula id="IE12"><mml:math id="IM12" display="inline" overflow="scroll"><mml:mi mathvariant="normal"> </mml:mi><mml:mi>C</mml:mi></mml:math></inline-formula> represents the set of cell types, the procedure of feature selection (<xref rid="btae063-F1" ref-type="fig">Fig. 1B</xref>) is described as follows: (i) a dataset <inline-formula id="IE13"><mml:math id="IM13" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:mi>D</mml:mi></mml:mrow><mml:mrow><mml:mi>′</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> with two classes was constructed for each cell type <inline-formula id="IE14"><mml:math id="IM14" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mi mathvariant="normal"> </mml:mi><mml:mfenced open="(" close=")" separators="|"><mml:mrow><mml:mn>1</mml:mn><mml:mo>≤</mml:mo><mml:mi>k</mml:mi><mml:mo>≤</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:mfenced></mml:math></inline-formula>—samples with the cell type of <inline-formula id="IE15"><mml:math id="IM15" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> are regarded as the positive class of <inline-formula id="IE16"><mml:math id="IM16" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:mi>D</mml:mi></mml:mrow><mml:mrow><mml:mi>′</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula>, and remaining samples as the negative class; and (ii) χ<sup>2</sup> was employed to select the top 300 genes with stronger identification ability of <inline-formula id="IE17"><mml:math id="IM17" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula>, and let <inline-formula id="IE18"><mml:math id="IM18" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> denote the set of these 300 genes. We then repeated the above two steps until each <inline-formula id="IE19"><mml:math id="IM19" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mfenced open="(" close=")" separators="|"><mml:mrow><mml:mn>1</mml:mn><mml:mo>≤</mml:mo><mml:mi>k</mml:mi><mml:mo>≤</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:mfenced></mml:math></inline-formula> was obtained as informative genes for the cell type of <inline-formula id="IE20"><mml:math id="IM20" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula>.</p>
      <p><bold>Step 3. Stacking model construction:</bold> Among traditional ML-based methods, SVM with the radial basis function (RBF) or linear kernel, and LR classifiers achieved generally better performances than other classifiers in annotating cell types (<xref rid="btae063-B1" ref-type="bibr">Abdelaal <italic toggle="yes">et al.</italic> 2019</xref>, <xref rid="btae063-B3" ref-type="bibr">Alquicira-Hernandez <italic toggle="yes">et al.</italic> 2019</xref>, <xref rid="btae063-B26" ref-type="bibr">Huang and Zhang 2021</xref>, <xref rid="btae063-B39" ref-type="bibr">Ma <italic toggle="yes">et al.</italic> 2021</xref>). In this work, we employed the stacking strategy (<xref rid="btae063-B69" ref-type="bibr">Zhou 2012</xref>) to integrate SVM and LR classifiers as individual base learners. It has been demonstrated that the stacking approach can achieve powerful performance in various bioinformatic tasks, such as anti-cancer peptide identification (<xref rid="btae063-B34" ref-type="bibr">Liang <italic toggle="yes">et al.</italic> 2021</xref>), prokaryotic lysine acetylation site prediction (<xref rid="btae063-B7" ref-type="bibr">Basith <italic toggle="yes">et al.</italic> 2022</xref>), and long ncRNA subcellular localization prediction (<xref rid="btae063-B9" ref-type="bibr">Cao <italic toggle="yes">et al.</italic> 2018</xref>). In addition, to conduct a more comprehensive study, we integrated another two base learners, including RF (<xref rid="btae063-B8" ref-type="bibr">Breiman 2001</xref>) and gradient boosting classifier (GBC) (<xref rid="btae063-B20" ref-type="bibr">Friedman 2001</xref>). We also built other variations for our CTISL framework, including χ<sup>2</sup> with multilayer perceptron (<xref rid="btae063-B45" ref-type="bibr">Popescu <italic toggle="yes">et al.</italic> 2009</xref>) (χ<sup>2</sup>+MLP) and CTISL with marker genes. Refer to <xref rid="sup1" ref-type="supplementary-material">Supplementary Section S1</xref> for more information. In this work, we constructed two layers of stacking ensemble models. The first layer combines SVM and LR as the base classifiers via the stacking strategy and the second level employs LR as the meta-classifier fed by the outputs of the stacking layer. Details of the procedure are described as follows (<xref rid="btae063-F1" ref-type="fig">Fig. 1C</xref>). In the first step, given a scRNA-seq dataset <inline-formula id="IE21"><mml:math id="IM21" display="inline" overflow="scroll"><mml:mi>D</mml:mi></mml:math></inline-formula> with <inline-formula id="IE22"><mml:math id="IM22" display="inline" overflow="scroll"><mml:mi>n</mml:mi></mml:math></inline-formula> cells and the set <inline-formula id="IE23"><mml:math id="IM23" display="inline" overflow="scroll"><mml:mi>C</mml:mi></mml:math></inline-formula> with <italic toggle="yes">t</italic> kinds of cell types, we obtained a set of informative genes <inline-formula id="IE24"><mml:math id="IM24" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mfenced open="(" close=")" separators="|"><mml:mrow><mml:mn>1</mml:mn><mml:mo>≤</mml:mo><mml:mi>k</mml:mi><mml:mo>≤</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:mfenced><mml:mi mathvariant="normal"> </mml:mi></mml:math></inline-formula>for the cell type of <inline-formula id="IE25"><mml:math id="IM25" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mfenced open="(" close=")" separators="|"><mml:mrow><mml:mn>1</mml:mn><mml:mo>≤</mml:mo><mml:mi>k</mml:mi><mml:mo>≤</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:mfenced><mml:mi mathvariant="normal"> </mml:mi></mml:math></inline-formula>using the proposed feature selection strategy. Subsequently, we extracted these gene columns in <inline-formula id="IE26"><mml:math id="IM26" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> and removed other genes from <inline-formula id="IE27"><mml:math id="IM27" display="inline" overflow="scroll"><mml:mi>D</mml:mi></mml:math></inline-formula> to form a sub-dataset <inline-formula id="IE28"><mml:math id="IM28" display="inline" overflow="scroll"><mml:mi>D</mml:mi><mml:mfenced open="(" close=")" separators="|"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:mfenced></mml:math></inline-formula>. In the second step, to avoid overfitting, we implemented our ensemble strategy using the stacking cross-validation algorithm provided in the “mlxtend” package (<xref rid="btae063-B47" ref-type="bibr">Raschka 2018</xref>). In this procedure, <inline-formula id="IE29"><mml:math id="IM29" display="inline" overflow="scroll"><mml:mi>D</mml:mi><mml:mfenced open="(" close=")" separators="|"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:mfenced><mml:mi mathvariant="normal"> </mml:mi></mml:math></inline-formula>was first split into 3-folds. The first-level classifier SVM with RBF kernel was trained on the 2-folds, and prediction results (<inline-formula id="IE30"><mml:math id="IM30" display="inline" overflow="scroll"><mml:mi>t</mml:mi></mml:math></inline-formula> probability values) on the remaining fold as new features of the fold. After three rounds, <inline-formula id="IE31"><mml:math id="IM31" display="inline" overflow="scroll"><mml:mi>D</mml:mi><mml:mfenced open="(" close=")" separators="|"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:mfenced><mml:mi mathvariant="normal"> </mml:mi></mml:math></inline-formula>was transformed into a new dataset <inline-formula id="IE32"><mml:math id="IM32" display="inline" overflow="scroll"><mml:mi>D</mml:mi><mml:mi mathvariant="normal">'</mml:mi><mml:mfenced open="(" close=")" separators="|"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:mfenced><mml:mi mathvariant="normal"> </mml:mi></mml:math></inline-formula>with <inline-formula id="IE33"><mml:math id="IM33" display="inline" overflow="scroll"><mml:mi>t</mml:mi></mml:math></inline-formula> features. The same procedure was used to fit the first layer LR classifier. Thus, <inline-formula id="IE34"><mml:math id="IM34" display="inline" overflow="scroll"><mml:mi>D</mml:mi><mml:mfenced open="(" close=")" separators="|"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:mfenced><mml:mi mathvariant="normal"> </mml:mi></mml:math></inline-formula>was transformed into a new dataset <inline-formula id="IE35"><mml:math id="IM35" display="inline" overflow="scroll"><mml:mi>D</mml:mi><mml:mi mathvariant="normal">'</mml:mi><mml:mfenced open="(" close=")" separators="|"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:mfenced><mml:mi mathvariant="normal"> </mml:mi></mml:math></inline-formula>with <inline-formula id="IE36"><mml:math id="IM36" display="inline" overflow="scroll"><mml:mn>2</mml:mn><mml:mi>t</mml:mi></mml:math></inline-formula> features through the first layer classifiers. After repeating the above two steps for each <inline-formula id="IE37"><mml:math id="IM37" display="inline" overflow="scroll"><mml:mi>D</mml:mi><mml:mfenced open="(" close=")" separators="|"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:mfenced><mml:mo>,</mml:mo><mml:mfenced open="(" close=")" separators="|"><mml:mrow><mml:mn>1</mml:mn><mml:mo>≤</mml:mo><mml:mi>k</mml:mi><mml:mo>≤</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:mfenced></mml:math></inline-formula>, <inline-formula id="IE38"><mml:math id="IM38" display="inline" overflow="scroll"><mml:mi>D</mml:mi></mml:math></inline-formula> was transformed into a new dataset <inline-formula id="IE39"><mml:math id="IM39" display="inline" overflow="scroll"><mml:mi>D</mml:mi><mml:mi mathvariant="normal">′</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:msubsup><mml:mi>U</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msubsup></mml:mrow><mml:mrow><mml:mo> </mml:mo><mml:mi>D</mml:mi><mml:mi mathvariant="normal">'</mml:mi><mml:mfenced open="(" close=")" separators="|"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:mfenced></mml:mrow></mml:mrow></mml:math></inline-formula>, where <inline-formula id="IE40"><mml:math id="IM40" display="inline" overflow="scroll"><mml:mi>D</mml:mi><mml:mi mathvariant="normal">'</mml:mi></mml:math></inline-formula> is an <inline-formula id="IE41"><mml:math id="IM41" display="inline" overflow="scroll"><mml:mi>n</mml:mi><mml:mo>×</mml:mo><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>×</mml:mo><mml:mn>2</mml:mn><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:math></inline-formula> matrix. Finally, <inline-formula id="IE42"><mml:math id="IM42" display="inline" overflow="scroll"><mml:mi>D</mml:mi><mml:mi mathvariant="normal">'</mml:mi></mml:math></inline-formula> was fed into the second layer classifier LR. Note that as the numbers of cell types vary across different scRNA-seq datasets, CTISL dynamically combines different numbers of base classifiers (i.e. SVM and LR) on different scRNA-seq training datasets.</p>
      <p><bold>Step 4. Model evaluation:</bold> To effectively evaluate and compare the performance of CTISL and other state-of-the-art approaches, we used four evaluation strategies including intra-dataset, inter-dataset, cross-batch, and cross-species evaluation (<xref rid="btae063-F1" ref-type="fig">Fig. 1D</xref>). For intra-dataset validation, we used the 5-fold cross-validation on seven PBMCs of <italic toggle="yes">H.sapiens</italic>. Five-folds were stratified to preserve the ratios of samples/cells for each cell type. When validating the inter-dataset performance, we used seven human PBMC datasets, which were generated by seven different protocols (i.e. 10Xv2, 10Xv3, CEL-Seq2, Drop-Seq, inDrop, SMART-Seq2, and SeqWell, respectively). To maximize the use of the existing datasets, we conducted seven inter-group experiments, with each experiment using one dataset as the testing set and the remaining six datasets for training. For cross-batch validation, we used three datasets, Dendritic, Retina(5), and Retina(19). For each dataset, we conducted experiments with one batch for training and the other one for testing. In total, we conducted six cross-batch experiments. To assess the cross-species performance, we conducted experiments on a pair of datasets, which were obtained from the same tissue of two different species by the same protocol. The model was trained on one dataset of original species and predicted cell types in another dataset of target species, and <italic toggle="yes">vice versa</italic>. In this work, we used two datasets generated by the inDrop protocol from the pancreas tissues of <italic toggle="yes">H.sapiens</italic> and <italic toggle="yes">M.musculus</italic> and two datasets generated by the inDrop protocol from the airway tissues of <italic toggle="yes">H.sapiens</italic> and <italic toggle="yes">M.musculus</italic>.</p>
    </sec>
    <sec>
      <title>2.3 Benchmarking against state-of-the-art ML-based cell-type prediction methods</title>
      <p>In our benchmark experiments, we compared CTISL with nine state-of-the-art ML-based methods including ACTINN (<xref rid="btae063-B38" ref-type="bibr">Ma and Pellegrini 2020</xref>) scCapsNet (<xref rid="btae063-B58" ref-type="bibr">Wang <italic toggle="yes">et al.</italic> 2020b</xref>), scDetect (<xref rid="btae063-B52" ref-type="bibr">Shen <italic toggle="yes">et al.</italic> 2021</xref>), TripletCell (<xref rid="btae063-B36" ref-type="bibr">Liu <italic toggle="yes">et al.</italic> 2023</xref>), scmap-cluster (<xref rid="btae063-B31" ref-type="bibr">Kiselev <italic toggle="yes">et al.</italic> 2018</xref>), scmap-cell (<xref rid="btae063-B31" ref-type="bibr">Kiselev <italic toggle="yes">et al.</italic> 2018</xref>), CellTypist (<xref rid="btae063-B17" ref-type="bibr">Domínguez Conde <italic toggle="yes">et al.</italic> 2022</xref>), scBERT (<xref rid="btae063-B64" ref-type="bibr">Yang <italic toggle="yes">et al.</italic> 2022</xref>), and SingleR (<xref rid="btae063-B4" ref-type="bibr">Aran <italic toggle="yes">et al.</italic> 2019</xref>). For ACTINN, scDetect, TripletCell, scmap-cluster, scmap-cell, CellTypist, scBERT, and SingleR, we used the pre-processing methods provided in their studies to process the original data and used the processed data as input for these models. While for scCapsNet, we used the method in this study to pre-process the data. All compared methods were trained and tested using the same training and testing datasets to ensure a fair comparison. We employed three popular performance evaluation metrics, including accuracy, median <italic toggle="yes">F</italic>1-score, and macro <italic toggle="yes">F</italic>1-score (<xref rid="sup1" ref-type="supplementary-material">Supplementary Section S2</xref>) to evaluate and compare the predictive performance of CTISL with state-of-the-art approaches. Accuracy is defined as the percentage of correctly predicted cell type among all cells. Median <italic toggle="yes">F</italic>1-score is defined as the median value of <italic toggle="yes">F</italic>1-scores of all cell types and macro <italic toggle="yes">F</italic>1-score denotes the average of <italic toggle="yes">F</italic>1-scores of all cell types. Therefore, macro <italic toggle="yes">F</italic>1-score is suitable for scRNA-seq data with highly imbalanced proportions of cell types (<xref rid="btae063-B39" ref-type="bibr">Ma <italic toggle="yes">et al.</italic> 2021</xref>).</p>
    </sec>
  </sec>
  <sec>
    <title>3 Results</title>
    <sec>
      <title>3.1 Performance evaluation on selected feature genes</title>
      <p>Most feature gene selection algorithms were designed to choose highly variable genes (HVGs). However, cell-type identification is a multi-class classification task and HVGs might not be related to cell types. This section therefore aimed to evaluate the performance of the base classifiers on different feature gene sets, including feature genes selected by various methods and HVGs. The feature gene selection methods, we evaluated in this study include the χ<sup>2</sup> method, limma (<xref rid="btae063-B48" ref-type="bibr">Ritchie <italic toggle="yes">et al.</italic> 2015</xref>), and GeneClust (<xref rid="btae063-B15" ref-type="bibr">Deng <italic toggle="yes">et al.</italic> 2023</xref>). While the χ<sup>2</sup> method and limma can select feature genes for each cell type, GeneClust selects a subset of highly representative genes that are relevant to each cluster. For each cell type, we used the χ<sup>2</sup> algorithm and limma to select the top <italic toggle="yes">k</italic> (<italic toggle="yes">k</italic> = 100, 200, 300, 400, and 500) genes that are related to cell types. Thus, for scRNA-seq with <italic toggle="yes">t</italic> cell types, <inline-formula id="IE43"><mml:math id="IM43" display="inline" overflow="scroll"><mml:mi>t</mml:mi><mml:mo>×</mml:mo><mml:mi>k</mml:mi><mml:mi mathvariant="normal"> </mml:mi></mml:math></inline-formula>genes were chosen as features. To evaluate the performance of genes selected by our proposed feature selection method, we compared the selected genes in our work with 2000, 3000, 4000, and 5000 highly variable genes, respectively. We trained our base classifiers on seven human scRNA-seq datasets using the selected genes via a 5-fold cross-validation test—the feature genes were selected using the 4-folds and the performance was tested using the rest fold. Performance comparison between SVM and LR using 300 χ<sup>2</sup>-selected genes and 5000 HVGs is shown in <xref rid="btae063-F2" ref-type="fig">Fig. 2A and B</xref>, respectively. Detailed performance values of all the numbers of selected genes and feature gene selection methods are shown in <xref rid="sup1" ref-type="supplementary-material">Supplementary Tables S2</xref> and <xref rid="sup1" ref-type="supplementary-material">S3</xref>, respectively. From the average accuracy, and macro and media <italic toggle="yes">F</italic>1-scores, the χ<sup>2</sup> method outperformed other gene selection methods and HVGs. However, the performance did not always improve with the increase in the number of features selected by the χ<sup>2</sup> method. Therefore, we further evaluated the performance of the whole CTISL framework on various numbers of selected genes (from 10 to 2000) selected by the χ<sup>2</sup> approach for all experimental scenarios, including intra-dataset, inter-dataset, cross-batch dataset, and cross-species. As illustrated in <xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S1</xref>, not all performance values generally improved with the increase in the number of selected genes, posing the challenge of selecting a universally optimized number of genes. Specifically, we counted the number of times when each number of selected genes achieved the highest accuracy and macro and median <italic toggle="yes">F</italic>1-scores. As a result, 2000 χ<sup>2</sup>-selected genes achieved the highest performance 20 times, followed by 1500 genes (18 times) and 300 genes (16 times). However, when using the selected 2000 and 1500 genes, CTISL took a significantly longer time to build the model. Considering balancing the running time and performance, in our CTISL framework, we used 300 as the default number of top genes based on the experiments. We further used the 10Xv2 dataset as an example to explore the robustness of CTISL concerning different numbers of distinct genes selected for each cell type using the χ<sup>2</sup> approach (<xref rid="sup1" ref-type="supplementary-material">Supplementary Table S4</xref> and <xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S2</xref>). Notably, we observed a reduction in the number of distinct genes for certain cell types with an increase in the number of selected genes. Moreover, when the number of selected genes was above 1000, the number of distinct signature genes for each cell type did not always increase along with the increase of the number of selected genes by the χ<sup>2</sup> approach. Refer to <xref rid="sup1" ref-type="supplementary-material">Supplementary Section S1</xref> for more details.</p>
      <fig position="float" id="btae063-F2">
        <label>Figure 2.</label>
        <caption>
          <p>Feature gene selection and performance comparison of base learners and our CTISL framework (stacking LR and SVM). (A and B) Performance of SVM and LR using different feature gene selection approaches including the χ<sup>2</sup> method (300 genes selected) and the 5000 highly variable genes used in the work by <xref rid="btae063-B26" ref-type="bibr">Huang and Zhang (2021)</xref>. (C–F) Performance comparison among base classifiers LR, SVM, and CTISL (using the stacking ensemble learning technique) models based on the 300 selected feature genes by the χ<sup>2</sup> method in terms of accuracy, macro <italic toggle="yes">F</italic>1-score, and median <italic toggle="yes">F</italic>1-score using (C) intra-dataset, (D) inter-dataset, (E) cross-batch, and (F) cross-species evaluation strategy.</p>
        </caption>
        <graphic xlink:href="btae063f2" position="float"/>
      </fig>
      <p>We also examined the genes selected by the χ<sup>2</sup> method and found that some of them are marker genes of the corresponding cell types according to the CellMarker 2.0 database (<xref rid="btae063-B24" ref-type="bibr">Hu <italic toggle="yes">et al.</italic> 2023</xref>). As shown in <xref rid="sup1" ref-type="supplementary-material">Supplementary Table S5</xref>, 31 out of 62 marker genes in B cells of the PBMC_10Xv2 dataset were selected by the χ<sup>2</sup> method. These findings confirm that the χ<sup>2</sup> method is capable of selecting indicative feature genes for cell-type identification. We then conducted a performance comparison of CTISL by using selected feature genes and marker genes, respectively. We found that CTISL achieved better performance when using the selected feature genes in comparison to the marker genes (<xref rid="sup1" ref-type="supplementary-material">Supplementary Table S6</xref>). Although maker genes have a strong ability to identify cell types, the limited number of known marker genes in some cell types cannot help the model achieve satisfactory performance of cell-type identification. Refer to <xref rid="sup1" ref-type="supplementary-material">Supplementary Section S2</xref> for more information.</p>
    </sec>
    <sec>
      <title>3.2 Performance evaluation of CTISL</title>
      <p>We then evaluated and compared the performance improvement achieved by the stacking learning technique. We systematically compared CTISL (using stacking learning to ensemble LR and SVM) with selected genes and marker genes, respectively, χ<sup>2</sup>+MLP (multilayer perceptron) (<xref rid="btae063-B45" ref-type="bibr">Popescu <italic toggle="yes">et al.</italic> 2009</xref>), and CTISL with LR+SVM+RF+GBC (<xref rid="btae063-B20" ref-type="bibr">Friedman 2001</xref>) in intra-dataset experiments, inter-dataset experiments, cross-batch experiments, and cross-species experiments. Refer to the methodological details of integrating MLP, RF, and GBC in <xref rid="sup1" ref-type="supplementary-material">Supplementary Sections S1</xref> and <xref rid="sup1" ref-type="supplementary-material">S3</xref>. The performance of CTISL stacking LR and SVM using 300 selected feature genes is demonstrated in <xref rid="btae063-F2" ref-type="fig">Fig. 2</xref> and all detailed performance values are illustrated in <xref rid="sup1" ref-type="supplementary-material">Supplementary Table S6</xref>.</p>
      <p>The intra-dataset experiments demonstrate that CTISL outperformed all other approaches in terms of average accuracy and average median <italic toggle="yes">F</italic>1-score, except for the slightly lower (0.001) average macro <italic toggle="yes">F</italic>1-score than CTISL with LR+SVM+RF+GBC (<xref rid="sup1" ref-type="supplementary-material">Supplementary Table S6</xref>). In addition, CTISL outperformed the base classifiers LR and SVM (<xref rid="btae063-F2" ref-type="fig">Fig. 2C</xref> and <xref rid="sup1" ref-type="supplementary-material">Supplementary Table S6</xref>) in terms of average accuracy (92.8% versus 91.6% and 92.8% versus 90.7%), average macro <italic toggle="yes">F</italic>1-score (0.906 versus 0.877 and 0.906 versus 0.773), and average median <italic toggle="yes">F</italic>1-score (0.947 versus 0.938 and 0.947 versus 0.908). While for inter-dataset experiments, compared to LR and SVM, CTISL achieved higher average accuracy (87.2% versus 83.0% and 87.2% versus 87.1%), average macro <italic toggle="yes">F</italic>1-score (0.734 versus 0.696 and 0.734 versus 0.716, respectively), and average median <italic toggle="yes">F</italic>1-score (0.857 versus 0.801 and 0.857 versus 0.850) in inter-dataset experiments (<xref rid="btae063-F2" ref-type="fig">Fig. 2D</xref> and <xref rid="sup1" ref-type="supplementary-material">Supplementary Table S6</xref>). For cross-batch experiments, CTISL outperformed the base classifiers LR and SVM (<xref rid="btae063-F2" ref-type="fig">Fig. 2E</xref> and <xref rid="sup1" ref-type="supplementary-material">Supplementary Table S6</xref>) in terms of average accuracy (98.3% versus 97.8% and 98.3% versus 96.6%), average macro <italic toggle="yes">F</italic>1-score (0.961 versus 0.948 and 0.961 versus 0.798), and average median <italic toggle="yes">F</italic>1-score (0.973 versus 0.971 and 0.973 versus 0.778). Our cross-species experiments demonstrate that χ<sup>2</sup>+MLP outperformed CTISL in average macro and median <italic toggle="yes">F</italic>1-scores, while CTISL still achieved better performance than the base learners (i.e. LR and SVM) in most of the cross-species experiments (<xref rid="btae063-F2" ref-type="fig">Fig. 2F</xref> and <xref rid="sup1" ref-type="supplementary-material">Supplementary Table S6</xref>). Detailed performance comparison and discussion about χ<sup>2</sup>+MLP and CTISL with LR+SVM+RF+GBC have been provided in <xref rid="sup1" ref-type="supplementary-material">Supplementary Section S3</xref>.</p>
      <p>Although CTISL did not outperform the ensemble base learners on all three metrics in all 24 benchmarking experiments, the results demonstrate that CTISL achieved consistently robust and stable average performance across all cases, except for the comparative prediction performance based on cross-species. Overall, we conclude that the stacking learning technique can effectively improve the prediction performance of base classifiers on intra-dataset, inter-dataset, and cross-batch scenarios of cell type-identification. In addition, to examine the effectiveness of CTISL, we employed UMAP (<xref rid="btae063-B40" ref-type="bibr">McInnes <italic toggle="yes">et al.</italic> 2018</xref>) to visualize the cell types represented by features extracted from each step in our model (<xref rid="btae063-F3" ref-type="fig">Fig. 3</xref>). As can be seen from <xref rid="btae063-F3" ref-type="fig">Fig. 3</xref>, all cells were mixed in the original dataset. After selecting the feature genes, the same type of cells began to form a blurry cluster, which then gradually separated after the first layer. After the output layer, the same type of cells was well clustered into the same group. These results confirm that CTISL can effectively extract informative features representing cell types, thereby achieving outstanding prediction performance.</p>
      <fig position="float" id="btae063-F3">
        <label>Figure 3.</label>
        <caption>
          <p>Visualizing the cell-type identification results on seven datasets, including (A) 10Xv2, (B) 10Xv3, (C) CELSeq, (D) DropSeq, (E) inDrop, (F) SMARTSeq2, and (G) SeqWell. For each dataset, the four panels, from top to bottom, represent the visualizations without feature selection, the results after feature selection, the output of the first layer of the model, and the output of the last layer of the model, respectively.</p>
        </caption>
        <graphic xlink:href="btae063f3" position="float"/>
      </fig>
    </sec>
    <sec>
      <title>3.3 Model interpretation</title>
      <p>In this section, we used the SHAP package (<xref rid="btae063-B37" ref-type="bibr">Lundberg and Lee 2017</xref>) to interpret the output of CTISL (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S3</xref>) and compared the selected feature genes with the marker genes from the CellMarker 2.0 database (<xref rid="btae063-B24" ref-type="bibr">Hu <italic toggle="yes">et al.</italic> 2023</xref>). We plotted the distribution of the impact of the top 20 selected genes from the output of CTISL. Positive SHAP values indicate the identification of the current cell type, while negative SHAP values indicate the identification of other types. Taking the B cell in 10Xv2 e.g. (<xref rid="sup1" ref-type="supplementary-material">Supplementary Table S5</xref> and <xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S3A</xref>), most genes with high expression achieved positive SHAP values. Among these 20 selected top genes, 8 are marker genes according to CellMarker 2.0, including CD79A, IGHM, MS4A1, TNFRSF13C, IGHD, IGKC, CD74, and CD79B. These genes have high expression values in most B cell samples, and their SHAP values from the output of the model are positive, meaning that these genes are favorable to the identification of B cells. Similar results of other cell types can also be found in 10Xv2 (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S3</xref>). For example, the high expression of IL7R and LTB are marker genes of CD4+ T cells according to CellMarker 2.0 and are favorable for the recognition of CD4+ T cells (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S3I</xref>). They were among the top 20 selected genes for this cell type according to the output of our CTISL. Similarly, the high expression of PF4, PPBP, TUBB1, and MYL9 positively impacted the identification of megakaryocytes (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S3F</xref>), and they were marker genes for this cell type based on our SHAP analysis. In addition, high expression of marker genes, such as KLRF1, SPON2, KLRB1, GNLY, CCL4, FCGR3A, CD247, GZMB, CD7, KLRD1, and TRDC are more indicative of identifying natural killer cells. These genes are all marker genes based on the annotations of CellMarker 2.0 and were also among the top 20 selected genes for this cell type based on the outputs of CTISL (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S3G</xref>). For the Plasmacytoid dendritic cell (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S3H</xref>), out of the 6188 samples in the PBMC-10Xv2 dataset, only 38 samples are available. As such, there are only eight plasmacytoid dendritic cells in the test sub-dataset using a 5-fold cross-validation test on the 10Xv2 dataset. As a result, there are few data points with higher SHAP values depicted in <xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S3H</xref>.</p>
    </sec>
    <sec>
      <title>3.4 Benchmarking CTISL against state-of-the-art methods in intra- and inter-dataset scenarios</title>
      <p>We first performed 5-fold cross-validations on seven human PBMC datasets and compared CTISL with nine state-of-the-art approaches in intra- and inter-dataset scenarios. The evaluated approaches included ACTINN, scCapsNet, scDetect, TripletCell, scmap-cluster, scmap-cell, CellTypist, scBERT, and SingleR. <xref rid="btae063-F4" ref-type="fig">Figure 4A</xref> demonstrated that CTISL outperformed all other nine benchmarked methods in terms of accuracy on five out of seven intra-dataset experiments. Among the remaining two datasets, scmap-cell achieved the highest accuracy of 95.9%, while CTISL achieved the second-best performance of 95.1% on the 10Xv3 dataset. Additionally, CTISL achieved the third-best performance of 87.5% on the SeqWell dataset. In terms of macro <italic toggle="yes">F</italic>1-score (<xref rid="btae063-F4" ref-type="fig">Fig. 4B</xref>), CTISL outperformed all other nine benchmarked methods on four out of seven intra-datasets. For the remaining three datasets, CTISL achieved the second-best performance of 0.949 on the 10Xv3 dataset, 0.911 on the CELSeq dataset, and 0.802 on the inDrop dataset. Similar results are observed in terms of median <italic toggle="yes">F</italic>1-score (<xref rid="btae063-F4" ref-type="fig">Fig. 4C</xref>). To evaluate the performance generalization of CTISL, we further performed inter-dataset tests on seven human PBMC datasets generated by different protocols. We first trained our model on six of seven datasets and tested the model on the remaining dataset. Each dataset was used as the testing data once [in line with <xref rid="btae063-B58" ref-type="bibr">Wang <italic toggle="yes">et al.</italic> (2020</xref>b) and <xref rid="btae063-B64" ref-type="bibr">Yang <italic toggle="yes">et al.</italic> (2022)</xref>] and the evaluation therefore contained seven sub-tasks. As can be seen in <xref rid="btae063-F4" ref-type="fig">Fig. 4A</xref>, CTISL achieved the best accuracy on two out of seven tests. In the remaining five datasets, CTISL achieved the second-best performance of 87.0% on the DropSeq test dataset, the second-best performance of 85.6% on the inDrop test dataset, the fourth-best performance of 90.1% on the 10Xv2 test dataset, the third-best performance of 92.4% on the 10Xv3 test dataset, and the seventh-best performance of 74.1% on the SeqWell test dataset. Additionally, CTISL and scmap-cell achieved the highest macro <italic toggle="yes">F</italic>1-score on two out of seven test results (<xref rid="btae063-F4" ref-type="fig">Fig. 4B</xref>), followed by scCapsNet, scDetect, and TripletCell on one test, respectively. scCapsNet, and scBERT achieved the highest median <italic toggle="yes">F</italic>1-score on two tests, followed by CTISL, TripletCell, and scmap-cell on one test separately (<xref rid="btae063-F4" ref-type="fig">Fig. 4C</xref>). Overall, these comparison results demonstrate that CTISL is capable of accurately and robustly identifying cell types in both inter- and intra-dataset experiments.</p>
      <fig position="float" id="btae063-F4">
        <label>Figure 4.</label>
        <caption>
          <p>Performance evaluation and benchmarking between CTISL and nine state-of-the-art cell-type predictors in terms of (A) accuracy, (B) macro <italic toggle="yes">F</italic>1-score, and (C) median <italic toggle="yes">F</italic>1-score on seven human PBMC datasets in intra- and inter-dataset, cross-batch, and cross-species experiments. “b1 to b2” and “b2 to b1” mean that the model was trained on the first/second batch of dataset and tested on the second/first batch of dataset, respectively. While “h to m” and “m or h” mean that the model was trained on the human/mouse dataset and was tested using the mouse/human dataset, respectively.</p>
        </caption>
        <graphic xlink:href="btae063f4" position="float"/>
      </fig>
    </sec>
    <sec>
      <title>3.5 Performance comparison in cross-batch and cross-species scenarios</title>
      <p>To evaluate the performance of CTISL on different batches of datasets, we ran all 10 predictors on 3 datasets with 2 batches (<xref rid="sup1" ref-type="supplementary-material">Supplementary Table S1</xref>). We trained all models on one batch and assessed their performance using the dataset of another batch. In terms of accuracy (<xref rid="btae063-F4" ref-type="fig">Fig. 4A</xref>), CTISL, ACTINN, and scmap-cell achieved the highest accuracy (100%) across one batch of the Retina(5) dataset (b2–b1). Similarly, CTISL achieved the highest performance of 98.0% on the Retina(19) dataset (b2–b1) and the second-best performance of 96.8% (b1–b2). Similarly, CTISL achieved the highest performance of 98.1% on the dendritic dataset (b2–b1) and the second-best performance of 97.1% (b1–b2). CTISL also achieved the highest macro and median <italic toggle="yes">F</italic>1-scores (<xref rid="btae063-F4" ref-type="fig">Fig. 4B and C</xref>) on four and three out of six experiments, respectively.</p>
      <p>We then conducted cross-species cell-type identification using human and mouse pancreas and airway datasets. CTISL achieved the fourth-best accuracy of 84.3% from human to mouse on the pancreas datasets (<xref rid="btae063-F4" ref-type="fig">Fig. 4A</xref>). Except for CellTypist, which achieved the highest accuracy of 88.8%, all other models performed poorly when they were trained on the mouse pancreas dataset to predict cell types in the human pancreas dataset. This is presumably because those cell types are not completely identical across human and mouse pancreas tissues. It is a common phenomenon in cross-species scenarios that some unique cell types only exist in the test dataset. For example, several cell types (e.g. acinar, epsilon, and mast) only appear in the human pancreas dataset and are not present in the mouse pancreas dataset. Similarly, two cell types (e.g. B_cell and immuse_other) solely appear in the mouse pancreas dataset and are not present in the human pancreas dataset (<xref rid="sup1" ref-type="supplementary-material">Supplementary Table S7</xref>). This phenomenon greatly reduces the prediction performance of all the models compared. On the other hand, in the airway dataset, the human data comprised three cell types—Basal, Ciliated, and Secretory, with similar sample sizes of 252, 258, and 280, respectively. When using human airway datasets for training the model to predict the cell types in mouse airway datasets, all 10 models performed well, with CTISL ranked third in accuracy (<xref rid="btae063-F4" ref-type="fig">Fig. 4A</xref>). However, the mouse airway datasets exhibited a huge imbalance in sample sizes of the cell types, including Basal, Ciliated, and Secretory, with sample sizes of 6009, 1333, and 4792, respectively. Therefore, we applied the “RandomUnderSampler” function from the “imblearn” library (<xref rid="btae063-B33" ref-type="bibr">Lemaître <italic toggle="yes">et al.</italic> 2017</xref>), which is a down-sampling strategy based on the method proposed by <xref rid="btae063-B32" ref-type="bibr">Laurikkala (2001)</xref> to balance the class distribution in the dataset (<xref rid="sup1" ref-type="supplementary-material">Supplementary Section S3</xref>). We set the sample size of each cell type to 1333 and trained the four models using the down-sampled data to predict human data. Five rounds of down-sampling were then conducted for each experiment and the average results for each trial were calculated. CTISL achieved the highest accuracy of 99.7% (<xref rid="btae063-F4" ref-type="fig">Fig. 4A</xref>) and the highest macro (<xref rid="btae063-F4" ref-type="fig">Fig. 4B</xref>) and median <italic toggle="yes">F</italic>1-score (<xref rid="btae063-F4" ref-type="fig">Fig. 4C</xref>) of 0.998 on the human airway dataset. In addition, according to cross-species experiments (<xref rid="sup1" ref-type="supplementary-material">Supplementary Table S6</xref>), χ<sup>2</sup>+MLP achieved overall better performance than CTISL, and CTISL with LR+SVM+RF+GBC outperformed CTISL in terms of average macro and median <italic toggle="yes">F</italic>1-score. Therefore, we recommend χ<sup>2</sup>+MLP when performing cross-species cell-type identification. Taken together, despite that χ<sup>2</sup>+MLP performed better than CTISL in cross-species experiments, these results showed that CTISL possesses a strong predictive ability in cell-type identification in intra-dataset, inter-dataset, and cross-batch experiment scenarios.</p>
    </sec>
  </sec>
  <sec>
    <title>4 Discussion and conclusions</title>
    <p>For identifying cell types using highly sparse single-cell expression matrix data, it is crucial to perform feature selection prior to model construction. Our feature selection method consists of multiple iterations, with each iteration selecting representative features for a specific cell type. We compared our selected features with publicly available cell-type marker genes and found that some of our selected marker genes could accurately identify the corresponding cell types and have significant biological relevance. Furthermore, we analyzed the performance of CTISL using various feature gene selection methods and different numbers of selected genes (<xref rid="sup1" ref-type="supplementary-material">Supplementary Tables S2</xref> and <xref rid="sup1" ref-type="supplementary-material">S3</xref>, and <xref rid="sup1" ref-type="supplementary-material">Supplementary Section S1</xref>). It is worth noticing that the prediction performance of CTISL is still limited by supervised learning. When training and testing CTISL across datasets, the cell types in the predicted results of CTISL are solely based on the available types in the training set, meaning that the model cannot identify new cell types in the test dataset. Although some existing models are able to identify new cell types (such as ACTINN, scCapsNet, scDetect, TripletCell, scmap-cell, and scmap-cluster), they may only classify them as a “novel”/ “other” type without accurately determining their actual types. In the future, we will endeavor to incorporate more cell types by combining more single-cell omic data, such as scATAC-seq data, thereby enriching the prediction capacity of CTISL. CTISL utilizes LR and SVM as default base learners for each cell type in the training dataset. However, other classifiers can also be integrated into CTISL as base learners (Supplementary Sections S3). Moreover, as the number of cell types increases, CTISL can dynamically increase the number of base learners (<xref rid="sup1" ref-type="supplementary-material">Supplementary Section S5</xref>). In addition, the performance of CTISL, like most state-of-the-art predictors, may suffer from imbalanced cell types in the training dataset when performing cross-species predictions. However, this issue can be to some extent mitigated by employing down-sampling techniques in the training dataset. It is worth noticing that the down-sampling strategy does not work if the rarest cell type (i.e. the cell type with the least number of cells compared to other cell types) in the training dataset has an insufficient number of cells. We also discussed the effect of cell-type imbalances on different experiment scenarios, such as cross-batch and intra-dataset in <xref rid="sup1" ref-type="supplementary-material">Supplementary Section S4</xref>.</p>
    <p>We developed a user-friendly web-based application for CTISL at <ext-link xlink:href="http://bigdata.biocie.cn/CTISLweb/home" ext-link-type="uri">http://bigdata.biocie.cn/CTISLweb/home</ext-link> to facilitate community-wide efforts to identify cell types using users’ datasets. Additionally, users have the option to choose different models other than LR and SVM as base learners or add additional models to the CTISL framework, via our webserver and locally runnable software (<ext-link xlink:href="https://zenodo.org/records/10568906" ext-link-type="uri">https://zenodo.org/records/10568906</ext-link>). Alternatively, given that χ<sup>2</sup>+MLP achieved better performance than the original CTISL in cross-species cell-type identification, we provided the MLP option on our webserver and GitHub repository for users to replace the stacking model. In conclusion, as a dynamic stacking ensemble learning-based model for robust multi-class classification of cell types using scRNA-seq data, CTISL achieved better or competitive, and more robust performances compared to other state-of-the-art predictors based on our extensive benchmarking experiments on intra- and inter-dataset, cross-batch, and cross-species datasets. Altogether, we anticipate that CTISL will serve as a prominent computational tool for the accurate identification of cell types using scRNA-seq data, thereby facilitating scRNA-seq data analysis and hypothesis generation.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material id="sup1" position="float" content-type="local-data">
      <label>btae063_Supplementary_Data</label>
      <media xlink:href="btae063_supplementary_data.docx">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <ack id="ack1">
    <title>Acknowledgements</title>
    <p>We thank the High-Performance Computing (HPC) of Northwest A&amp;F University (NWAFU) for providing computing resources.</p>
  </ack>
  <sec>
    <title>Supplementary data</title>
    <p><xref rid="sup1" ref-type="supplementary-material">Supplementary data</xref> are available at <italic toggle="yes">Bioinformatics</italic> online.</p>
  </sec>
  <sec sec-type="COI-statement">
    <title>Conflict of interest</title>
    <p>None declared.</p>
  </sec>
  <sec>
    <title>Funding</title>
    <p>This work was supported by the National Key R&amp;D Program of China [2022YFF1000100].</p>
  </sec>
  <ref-list id="ref1">
    <title>References</title>
    <ref id="btae063-B1">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Abdelaal</surname><given-names>T</given-names></string-name>, <string-name><surname>Michielsen</surname><given-names>L</given-names></string-name>, <string-name><surname>Cats</surname><given-names>D</given-names></string-name></person-group><etal>et al</etal><article-title>A comparison of automatic cell identification methods for single-cell RNA sequencing data</article-title>. <source>Genome Biol</source><year>2019</year>;<volume>20</volume>:<fpage>194</fpage>.<pub-id pub-id-type="pmid">31500660</pub-id></mixed-citation>
    </ref>
    <ref id="btae063-B2">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Aibar</surname><given-names>S</given-names></string-name>, <string-name><surname>González-Blas</surname><given-names>CB</given-names></string-name>, <string-name><surname>Moerman</surname><given-names>T</given-names></string-name></person-group><etal>et al</etal><article-title>SCENIC: single-cell regulatory network inference and clustering</article-title>. <source>Nat Methods</source><year>2017</year>;<volume>14</volume>:<fpage>1083</fpage>–<lpage>6</lpage>.<pub-id pub-id-type="pmid">28991892</pub-id></mixed-citation>
    </ref>
    <ref id="btae063-B3">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Alquicira-Hernandez</surname><given-names>J</given-names></string-name>, <string-name><surname>Sathe</surname><given-names>A</given-names></string-name>, <string-name><surname>Ji</surname><given-names>HP</given-names></string-name></person-group><etal>et al</etal><article-title>scPred: accurate supervised method for cell-type classification from single-cell RNA-seq data</article-title>. <source>Genome Biol</source><year>2019</year>;<volume>20</volume>:<fpage>264</fpage>.<pub-id pub-id-type="pmid">31829268</pub-id></mixed-citation>
    </ref>
    <ref id="btae063-B4">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Aran</surname><given-names>D</given-names></string-name>, <string-name><surname>Looney</surname><given-names>AP</given-names></string-name>, <string-name><surname>Liu</surname><given-names>L</given-names></string-name></person-group><etal>et al</etal><article-title>Reference-based analysis of lung single-cell sequencing reveals a transitional profibrotic macrophage</article-title>. <source>Nat Immunol</source><year>2019</year>;<volume>20</volume>:<fpage>163</fpage>–<lpage>72</lpage>.<pub-id pub-id-type="pmid">30643263</pub-id></mixed-citation>
    </ref>
    <ref id="btae063-B5">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Arendt</surname><given-names>D</given-names></string-name>, <string-name><surname>Musser</surname><given-names>JM</given-names></string-name>, <string-name><surname>Baker</surname><given-names>CVH</given-names></string-name></person-group><etal>et al</etal><article-title>The origin and evolution of cell types</article-title>. <source>Nat Rev Genet</source><year>2016</year>;<volume>17</volume>:<fpage>744</fpage>–<lpage>57</lpage>.<pub-id pub-id-type="pmid">27818507</pub-id></mixed-citation>
    </ref>
    <ref id="btae063-B6">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Baron</surname><given-names>M</given-names></string-name>, <string-name><surname>Veres</surname><given-names>A</given-names></string-name>, <string-name><surname>Wolock</surname><given-names>SL</given-names></string-name></person-group><etal>et al</etal><article-title>A single-cell transcriptomic map of the human and mouse pancreas reveals inter- and intra-cell population structure</article-title>. <source>Cell Syst</source><year>2016</year>;<volume>3</volume>:<fpage>346</fpage>–<lpage>60.e4</lpage>.<pub-id pub-id-type="pmid">27667365</pub-id></mixed-citation>
    </ref>
    <ref id="btae063-B7">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Basith</surname><given-names>S</given-names></string-name>, <string-name><surname>Lee</surname><given-names>G</given-names></string-name>, <string-name><surname>Manavalan</surname><given-names>B.</given-names></string-name></person-group><article-title>STALLION: a stacking-based ensemble learning framework for prokaryotic lysine acetylation site prediction</article-title>. <source>Brief Bioinform</source><year>2022</year>;<volume>23</volume>:<fpage>bbab376</fpage>.<pub-id pub-id-type="pmid">34532736</pub-id></mixed-citation>
    </ref>
    <ref id="btae063-B8">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Breiman</surname><given-names>L.</given-names></string-name></person-group><article-title>Random forests</article-title>. <source>Mach Learn</source><year>2001</year>;<volume>45</volume>:<fpage>5</fpage>–<lpage>32</lpage>.</mixed-citation>
    </ref>
    <ref id="btae063-B9">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Cao</surname><given-names>Z</given-names></string-name>, <string-name><surname>Pan</surname><given-names>X</given-names></string-name>, <string-name><surname>Yang</surname><given-names>Y</given-names></string-name></person-group><etal>et al</etal><article-title>The lncLocator: a subcellular localization predictor for long non-coding RNAs based on a stacked ensemble classifier</article-title>. <source>Bioinformatics</source><year>2018</year>;<volume>34</volume>:<fpage>2185</fpage>–<lpage>94</lpage>.<pub-id pub-id-type="pmid">29462250</pub-id></mixed-citation>
    </ref>
    <ref id="btae063-B10">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Celebi</surname><given-names>ME</given-names></string-name>, <string-name><surname>Kingravi</surname><given-names>HA</given-names></string-name>, <string-name><surname>Vela</surname><given-names>PA.</given-names></string-name></person-group><article-title>A comparative study of efficient initialization methods for the k-means clustering algorithm</article-title>. <source>Expert Syst Appl</source><year>2013</year>;<volume>40</volume>:<fpage>200</fpage>–<lpage>10</lpage>.</mixed-citation>
    </ref>
    <ref id="btae063-B11">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Chen</surname><given-names>X</given-names></string-name>, <string-name><surname>Chen</surname><given-names>S</given-names></string-name>, <string-name><surname>Song</surname><given-names>S</given-names></string-name></person-group><etal>et al</etal><article-title>Cell type annotation of single-cell chromatin accessibility data via supervised Bayesian embedding</article-title>. <source>Nat Mach Intell</source><year>2022</year>;<volume>4</volume>:<fpage>116</fpage>–<lpage>26</lpage>.</mixed-citation>
    </ref>
    <ref id="btae063-B12">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Cortes</surname><given-names>C</given-names></string-name>, <string-name><surname>Vapnik</surname><given-names>V.</given-names></string-name></person-group><article-title>Support-vector networks</article-title>. <source>Mach Learn</source><year>1995</year>;<volume>20</volume>:<fpage>273</fpage>–<lpage>97</lpage>.</mixed-citation>
    </ref>
    <ref id="btae063-B13">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Cover</surname><given-names>T</given-names></string-name>, <string-name><surname>Hart</surname><given-names>P.</given-names></string-name></person-group><article-title>Nearest neighbor pattern classification</article-title>. <source>IEEE Trans Inform Theory</source><year>1967</year>;<volume>13</volume>:<fpage>21</fpage>–<lpage>7</lpage>.</mixed-citation>
    </ref>
    <ref id="btae063-B14">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Cui</surname><given-names>Y</given-names></string-name>, <string-name><surname>Zhang</surname><given-names>S</given-names></string-name>, <string-name><surname>Liang</surname><given-names>Y</given-names></string-name></person-group><etal>et al</etal><article-title>Consensus clustering of single-cell RNA-seq data by enhancing network affinity</article-title>. <source>Brief Bioinform</source><year>2021</year>;<volume>22</volume>:<fpage>bbab236</fpage>.<pub-id pub-id-type="pmid">34160582</pub-id></mixed-citation>
    </ref>
    <ref id="btae063-B15">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Deng</surname><given-names>T</given-names></string-name>, <string-name><surname>Chen</surname><given-names>S</given-names></string-name>, <string-name><surname>Zhang</surname><given-names>Y</given-names></string-name></person-group><etal>et al</etal><article-title>A cofunctional grouping-based approach for non-redundant feature gene selection in unannotated single-cell RNA-seq analysis</article-title>. <source>Brief Bioinform</source><year>2023</year>;<volume>24</volume>:<fpage>bbad042</fpage>.<pub-id pub-id-type="pmid">36754847</pub-id></mixed-citation>
    </ref>
    <ref id="btae063-B16">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Ding</surname><given-names>J</given-names></string-name>, <string-name><surname>Adiconis</surname><given-names>X</given-names></string-name>, <string-name><surname>Simmons</surname><given-names>SK</given-names></string-name></person-group><etal>et al</etal><article-title>Systematic comparison of single-cell and single-nucleus RNA-sequencing methods</article-title>. <source>Nat Biotechnol</source><year>2020</year>;<volume>38</volume>:<fpage>737</fpage>–<lpage>46</lpage>.<pub-id pub-id-type="pmid">32341560</pub-id></mixed-citation>
    </ref>
    <ref id="btae063-B17">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Domínguez Conde</surname><given-names>C</given-names></string-name>, <string-name><surname>Xu</surname><given-names>C</given-names></string-name>, <string-name><surname>Jarvis</surname><given-names>LB</given-names></string-name></person-group><etal>et al</etal><article-title>Cross-tissue immune cell analysis reveals tissue-specific features in humans</article-title>. <source>Science</source><year>2022</year>;<volume>376</volume>:<fpage>eabl5197</fpage>.<pub-id pub-id-type="pmid">35549406</pub-id></mixed-citation>
    </ref>
    <ref id="btae063-B18">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><string-name><surname>Ertoz</surname><given-names>L</given-names></string-name>, <string-name><surname>Steinbach</surname><given-names>M</given-names></string-name>, <string-name><surname>Kumar</surname><given-names>V.</given-names></string-name></person-group> A new shared nearest neighbor clustering algorithm and its applications. In: <italic toggle="yes">Workshop on Clustering High Dimensional Data and Its Applications at 2nd SIAM International Conference on Data Mining, Arlington, VA, USA</italic>. United States: Society for Industrial and Applied Mathematics <year>2002</year>.</mixed-citation>
    </ref>
    <ref id="btae063-B19">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Forman</surname><given-names>G.</given-names></string-name></person-group><article-title>An extensive empirical study of feature selection metrics for text classification</article-title>. <source>J Mach Learn Res</source><year>2003</year>;<volume>3</volume>:<fpage>1289</fpage>–<lpage>305</lpage>.</mixed-citation>
    </ref>
    <ref id="btae063-B20">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Friedman</surname><given-names>JH.</given-names></string-name></person-group><article-title>Greedy function approximation: a gradient boosting machine</article-title>. <source>Ann Statist</source><year>2001</year>;<volume>29</volume>:<fpage>1189</fpage>–<lpage>232</lpage>.</mixed-citation>
    </ref>
    <ref id="btae063-B21">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Fushiki</surname><given-names>T.</given-names></string-name></person-group><article-title>Bayesian bootstrap prediction</article-title>. <source>J Stat Plan Inference</source><year>2010</year>;<volume>140</volume>:<fpage>65</fpage>–<lpage>74</lpage>.</mixed-citation>
    </ref>
    <ref id="btae063-B22">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Grün</surname><given-names>D</given-names></string-name>, <string-name><surname>Lyubimova</surname><given-names>A</given-names></string-name>, <string-name><surname>Kester</surname><given-names>L</given-names></string-name></person-group><etal>et al</etal><article-title>Single-cell messenger RNA sequencing reveals rare intestinal cell types</article-title>. <source>Nature</source><year>2015</year>;<volume>525</volume>:<fpage>251</fpage>–<lpage>5</lpage>.<pub-id pub-id-type="pmid">26287467</pub-id></mixed-citation>
    </ref>
    <ref id="btae063-B23">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Guo</surname><given-names>M</given-names></string-name>, <string-name><surname>Wang</surname><given-names>H</given-names></string-name>, <string-name><surname>Potter</surname><given-names>SS</given-names></string-name></person-group><etal>et al</etal><article-title>SINCERA: a pipeline for single-cell RNA-seq profiling analysis</article-title>. <source>PLoS Comput Biol</source><year>2015</year>;<volume>11</volume>:<fpage>e1004575</fpage>.<pub-id pub-id-type="pmid">26600239</pub-id></mixed-citation>
    </ref>
    <ref id="btae063-B24">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Hu</surname><given-names>C</given-names></string-name>, <string-name><surname>Li</surname><given-names>T</given-names></string-name>, <string-name><surname>Xu</surname><given-names>Y</given-names></string-name></person-group><etal>et al</etal><article-title>CellMarker 2.0: an updated database of manually curated cell markers in human/mouse and web tools based on scRNA-seq data</article-title>. <source>Nucleic Acids Res</source><year>2023</year>;<volume>51</volume>:<fpage>D870</fpage>–<lpage>6</lpage>.<pub-id pub-id-type="pmid">36300619</pub-id></mixed-citation>
    </ref>
    <ref id="btae063-B25">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Hu</surname><given-names>J</given-names></string-name>, <string-name><surname>Li</surname><given-names>X</given-names></string-name>, <string-name><surname>Hu</surname><given-names>G</given-names></string-name></person-group><etal>et al</etal><article-title>Iterative transfer learning with neural network for clustering and cell type classification in single-cell RNA-seq analysis</article-title>. <source>Nat Mach Intell</source><year>2020</year>;<volume>2</volume>:<fpage>607</fpage>–<lpage>18</lpage>.<pub-id pub-id-type="pmid">33817554</pub-id></mixed-citation>
    </ref>
    <ref id="btae063-B26">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Huang</surname><given-names>Y</given-names></string-name>, <string-name><surname>Zhang</surname><given-names>P.</given-names></string-name></person-group><article-title>Evaluation of machine learning approaches for cell-type identification from single-cell transcriptomics data</article-title>. <source>Brief Bioinform</source><year>2021</year>;<volume>22</volume>:<fpage>bbab217</fpage>.<pub-id pub-id-type="pmid">34050369</pub-id></mixed-citation>
    </ref>
    <ref id="btae063-B27">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Jia</surname><given-names>S</given-names></string-name>, <string-name><surname>Lysenko</surname><given-names>A</given-names></string-name>, <string-name><surname>Boroevich</surname><given-names>KA</given-names></string-name></person-group><etal>et al</etal><article-title>scDeepInsight: a supervised cell-type identification method for scRNA-seq data with deep learning</article-title>. <source>Brief Bioinform</source><year>2023</year>;<volume>24</volume>:<fpage>bbad266</fpage>.<pub-id pub-id-type="pmid">37523217</pub-id></mixed-citation>
    </ref>
    <ref id="btae063-B28">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Jiang</surname><given-names>L</given-names></string-name>, <string-name><surname>Chen</surname><given-names>H</given-names></string-name>, <string-name><surname>Pinello</surname><given-names>L</given-names></string-name></person-group><etal>et al</etal><article-title>GiniClust: detecting rare cell types from single-cell gene expression data with Gini index</article-title>. <source>Genome Biol</source><year>2016</year>;<volume>17</volume>:<fpage>144</fpage>.<pub-id pub-id-type="pmid">27368803</pub-id></mixed-citation>
    </ref>
    <ref id="btae063-B29">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Kiselev</surname><given-names>VY</given-names></string-name>, <string-name><surname>Andrews</surname><given-names>TS</given-names></string-name>, <string-name><surname>Hemberg</surname><given-names>M.</given-names></string-name></person-group><article-title>Challenges in unsupervised clustering of single-cell RNA-seq data</article-title>. <source>Nat Rev Genet</source><year>2019</year>;<volume>20</volume>:<fpage>273</fpage>–<lpage>82</lpage>.<pub-id pub-id-type="pmid">30617341</pub-id></mixed-citation>
    </ref>
    <ref id="btae063-B30">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Kiselev</surname><given-names>VY</given-names></string-name>, <string-name><surname>Kirschner</surname><given-names>K</given-names></string-name>, <string-name><surname>Schaub</surname><given-names>MT</given-names></string-name></person-group><etal>et al</etal><article-title>SC3: consensus clustering of single-cell RNA-seq data</article-title>. <source>Nat Methods</source><year>2017</year>;<volume>14</volume>:<fpage>483</fpage>–<lpage>6</lpage>.<pub-id pub-id-type="pmid">28346451</pub-id></mixed-citation>
    </ref>
    <ref id="btae063-B31">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Kiselev</surname><given-names>VY</given-names></string-name>, <string-name><surname>Yiu</surname><given-names>A</given-names></string-name>, <string-name><surname>Hemberg</surname><given-names>MJNM.</given-names></string-name></person-group><article-title>Scmap: projection of single-cell RNA-seq data across data sets</article-title>. <source>Nat Methods</source><year>2018</year>;<volume>15</volume>:<fpage>359</fpage>–<lpage>62</lpage>.<pub-id pub-id-type="pmid">29608555</pub-id></mixed-citation>
    </ref>
    <ref id="btae063-B32">
      <mixed-citation publication-type="book"><person-group person-group-type="author"><string-name><surname>Laurikkala</surname><given-names>J.</given-names></string-name></person-group> Improving identification of difficult small classes by balancing class distribution. In: <italic toggle="yes">Artificial Intelligence in Medicine: 8th Conference on Artificial Intelligence in Medicine in Europe, AIME 2001, Cascais, Portugal, July 1–4, 2001, Proceedings 8</italic>. <fpage>63</fpage>–<lpage>6</lpage>. <publisher-name>Germany</publisher-name>: Springer-Verlag Berlin Heidelberg, <year>2001</year>.</mixed-citation>
    </ref>
    <ref id="btae063-B33">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Lemaître</surname><given-names>G</given-names></string-name>, <string-name><surname>Nogueira</surname><given-names>F</given-names></string-name>, <string-name><surname>Aridas</surname><given-names>C.</given-names></string-name></person-group><article-title>Imbalanced-learn: a python toolbox to tackle the curse of imbalanced datasets in machine learning</article-title>. <source>J Mach Learn Res</source><year>2017</year>;<volume>18</volume>:<fpage>559</fpage>–<lpage>63</lpage>.</mixed-citation>
    </ref>
    <ref id="btae063-B34">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Liang</surname><given-names>X</given-names></string-name>, <string-name><surname>Li</surname><given-names>F</given-names></string-name>, <string-name><surname>Chen</surname><given-names>J</given-names></string-name></person-group><etal>et al</etal><article-title>Large-scale comparative review and assessment of computational methods for anti-cancer peptide identification</article-title>. <source>Brief Bioinform</source><year>2021</year>;<volume>22</volume>:<fpage>bbaa312</fpage>.<pub-id pub-id-type="pmid">33316035</pub-id></mixed-citation>
    </ref>
    <ref id="btae063-B35">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Lin</surname><given-names>Y</given-names></string-name>, <string-name><surname>Cao</surname><given-names>Y</given-names></string-name>, <string-name><surname>Kim</surname><given-names>HJ</given-names></string-name></person-group><etal>et al</etal><article-title>scClassify: sample size estimation and multiscale classification of cells using single and multiple reference</article-title>. <source>Mol Syst Biol</source><year>2020</year>;<volume>16</volume>:<fpage>e9389</fpage>.<pub-id pub-id-type="pmid">32567229</pub-id></mixed-citation>
    </ref>
    <ref id="btae063-B36">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Liu</surname><given-names>Y</given-names></string-name>, <string-name><surname>Wei</surname><given-names>G</given-names></string-name>, <string-name><surname>Li</surname><given-names>C</given-names></string-name></person-group><etal>et al</etal><article-title>TripletCell: a deep metric learning framework for accurate annotation of cell types at the single-cell level</article-title>. <source>Brief Bioinform</source><year>2023</year>;<volume>24</volume>:<fpage>bbad132</fpage>.<pub-id pub-id-type="pmid">37080771</pub-id></mixed-citation>
    </ref>
    <ref id="btae063-B37">
      <mixed-citation publication-type="book"><person-group person-group-type="author"><string-name><surname>Lundberg</surname><given-names>S</given-names></string-name>, <string-name><surname>Lee</surname><given-names>S-I.</given-names></string-name></person-group> A unified approach to interpreting model predictions. In: <italic toggle="yes">31st Conference on Neural Information Processing Systems (NIPS), Long Beach, California, USA</italic>, Vol. <volume>23</volume>. <fpage>4765</fpage>–<lpage>74</lpage>. United States: <publisher-name>ACM</publisher-name>, <year>2017</year>.</mixed-citation>
    </ref>
    <ref id="btae063-B41">
      <mixed-citation publication-type="journal">Lecessie S and van Houwelingen JC. Ridge estimators in logistic regression. <source>Appl Statist</source> 1992;<volume>41</volume>:<fpage>191</fpage>–<lpage>201</lpage>.</mixed-citation>
    </ref>
    <ref id="btae063-B38">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Ma</surname><given-names>F</given-names></string-name>, <string-name><surname>Pellegrini</surname><given-names>M.</given-names></string-name></person-group><article-title>ACTINN: automated identification of cell types in single cell RNA sequencing</article-title>. <source>Bioinformatics</source><year>2020</year>;<volume>36</volume>:<fpage>533</fpage>–<lpage>8</lpage>.<pub-id pub-id-type="pmid">31359028</pub-id></mixed-citation>
    </ref>
    <ref id="btae063-B39">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Ma</surname><given-names>W</given-names></string-name>, <string-name><surname>Su</surname><given-names>K</given-names></string-name>, <string-name><surname>Wu</surname><given-names>H.</given-names></string-name></person-group><article-title>Evaluation of some aspects in supervised cell type identification for single-cell RNA-seq: classifier, feature selection, and reference construction</article-title>. <source>Genome Biol</source><year>2021</year>;<volume>22</volume>:<fpage>264</fpage>.<pub-id pub-id-type="pmid">34503564</pub-id></mixed-citation>
    </ref>
    <ref id="btae063-B40">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>McInnes</surname><given-names>L</given-names></string-name>, <string-name><surname>Healy</surname><given-names>J</given-names></string-name>, <string-name><surname>Saul</surname><given-names>N</given-names></string-name></person-group><etal>et al</etal><article-title>UMAP: uniform manifold approximation and projection</article-title>. <source>JOSS</source><year>2018</year>;<volume>3</volume>:<fpage>861</fpage>.</mixed-citation>
    </ref>
    <ref id="btae063-B42">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Nguyen</surname><given-names>V</given-names></string-name>, <string-name><surname>Griss</surname><given-names>J.</given-names></string-name></person-group><article-title>scAnnotatR: framework to accurately classify cell types in single-cell RNA-sequencing data</article-title>. <source>BMC Bioinformatics</source><year>2022</year>;<volume>23</volume>:<fpage>44</fpage>.<pub-id pub-id-type="pmid">35038984</pub-id></mixed-citation>
    </ref>
    <ref id="btae063-B43">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Plasschaert</surname><given-names>LW</given-names></string-name>, <string-name><surname>Žilionis</surname><given-names>R</given-names></string-name>, <string-name><surname>Choo-Wing</surname><given-names>R</given-names></string-name></person-group><etal>et al</etal><article-title>A single-cell atlas of the airway epithelium reveals the CFTR-rich pulmonary ionocyte</article-title>. <source>Nature</source><year>2018</year>;<volume>560</volume>:<fpage>377</fpage>–<lpage>81</lpage>.<pub-id pub-id-type="pmid">30069046</pub-id></mixed-citation>
    </ref>
    <ref id="btae063-B44">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Pliner</surname><given-names>HA</given-names></string-name>, <string-name><surname>Shendure</surname><given-names>J</given-names></string-name>, <string-name><surname>Trapnell</surname><given-names>C.</given-names></string-name></person-group><article-title>Supervised classification enables rapid annotation of cell atlases</article-title>. <source>Nat Methods</source><year>2019</year>;<volume>16</volume>:<fpage>983</fpage>–<lpage>6</lpage>.<pub-id pub-id-type="pmid">31501545</pub-id></mixed-citation>
    </ref>
    <ref id="btae063-B45">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Popescu</surname><given-names>M-C</given-names></string-name></person-group>, Balas VE, Perescu-Popescu L <etal>et al</etal><article-title>Multilayer perceptron and neural networks</article-title>. <source>WSEAS Trans Circuits Syst</source><year>2009</year>;<volume>8</volume>:<fpage>579</fpage>–<lpage>88</lpage>.</mixed-citation>
    </ref>
    <ref id="btae063-B46">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Qi</surname><given-names>R</given-names></string-name>, <string-name><surname>Ma</surname><given-names>A</given-names></string-name>, <string-name><surname>Ma</surname><given-names>Q</given-names></string-name></person-group><etal>et al</etal><article-title>Clustering and classification methods for single-cell RNA-sequencing data</article-title>. <source>Brief Bioinform</source><year>2020</year>;<volume>21</volume>:<fpage>1196</fpage>–<lpage>208</lpage>.<pub-id pub-id-type="pmid">31271412</pub-id></mixed-citation>
    </ref>
    <ref id="btae063-B47">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Raschka</surname><given-names>S.</given-names></string-name></person-group><article-title>MLxtend: providing machine learning and data science utilities and extensions to python’s scientific computing stack</article-title>. <source>JOSS</source><year>2018</year>;<volume>3</volume>:<fpage>638</fpage>.</mixed-citation>
    </ref>
    <ref id="btae063-B48">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Ritchie</surname><given-names>ME</given-names></string-name>, <string-name><surname>Phipson</surname><given-names>B</given-names></string-name>, <string-name><surname>Wu</surname><given-names>D</given-names></string-name></person-group><etal>et al</etal><article-title>Limma powers differential expression analyses for RNA-sequencing and microarray studies</article-title>. <source>Nucleic Acids Res</source><year>2015</year>;<volume>43</volume>:<fpage>e47</fpage>.<pub-id pub-id-type="pmid">25605792</pub-id></mixed-citation>
    </ref>
    <ref id="btae063-B49">
      <mixed-citation publication-type="book"><person-group person-group-type="author"><string-name><surname>Sabour</surname><given-names>S</given-names></string-name>, <string-name><surname>Frosst</surname><given-names>N</given-names></string-name>, <string-name><surname>Hinton</surname><given-names>GE.</given-names></string-name></person-group> Dynamic routing between capsules. In: <italic toggle="yes">Proceedings of the 31st International Conference on Neural Information Processing Systems. Long Beach, California, USA</italic>. <fpage>3859</fpage>–<lpage>69</lpage>. United States: <publisher-name>Curran Associates Inc</publisher-name>., <year>2017</year>.</mixed-citation>
    </ref>
    <ref id="btae063-B50">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Samek</surname><given-names>W</given-names></string-name>, <string-name><surname>Montavon</surname><given-names>G</given-names></string-name>, <string-name><surname>Lapuschkin</surname><given-names>S</given-names></string-name></person-group><etal>et al</etal><article-title>Explaining deep neural networks and beyond: a review of methods and applications</article-title>. <source>Proc IEEE</source><year>2021</year>;<volume>109</volume>:<fpage>247</fpage>–<lpage>78</lpage>.</mixed-citation>
    </ref>
    <ref id="btae063-B51">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Shekhar</surname><given-names>K</given-names></string-name>, <string-name><surname>Lapan</surname><given-names>SW</given-names></string-name>, <string-name><surname>Whitney</surname><given-names>IE</given-names></string-name></person-group><etal>et al</etal><article-title>Comprehensive classification of retinal bipolar neurons by single-cell transcriptomics</article-title>. <source>Cell</source><year>2016</year>;<volume>166</volume>:<fpage>1308</fpage>–<lpage>23.e30</lpage>.<pub-id pub-id-type="pmid">27565351</pub-id></mixed-citation>
    </ref>
    <ref id="btae063-B52">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Shen</surname><given-names>Y</given-names></string-name>, <string-name><surname>Chu</surname><given-names>Q</given-names></string-name>, <string-name><surname>Timko</surname><given-names>MP</given-names></string-name></person-group><etal>et al</etal><article-title>scDetect: a rank-based ensemble learning algorithm for cell type identification of single-cell RNA sequencing in cancer</article-title>. <source>Bioinformatics</source><year>2021</year>;<volume>37</volume>:<fpage>4115</fpage>–<lpage>22</lpage>.<pub-id pub-id-type="pmid">34048541</pub-id></mixed-citation>
    </ref>
    <ref id="btae063-B53">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Strehl</surname><given-names>A</given-names></string-name>, <string-name><surname>Ghosh</surname><given-names>J.</given-names></string-name></person-group><article-title>Cluster ensembles—a knowledge reuse framework for combining multiple partitions</article-title>. <source>J Mach Learn Res</source><year>2003</year>;<volume>3</volume>:<fpage>583</fpage>–<lpage>617</lpage>.</mixed-citation>
    </ref>
    <ref id="btae063-B54">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Sun</surname><given-names>X</given-names></string-name>, <string-name><surname>Lin</surname><given-names>X</given-names></string-name>, <string-name><surname>Li</surname><given-names>Z</given-names></string-name></person-group><etal>et al</etal><article-title>A comprehensive comparison of supervised and unsupervised methods for cell type identification in single-cell RNA-seq</article-title>. <source>Brief Bioinform</source><year>2022</year>;<volume>23</volume>:<fpage>bbab567</fpage>.<pub-id pub-id-type="pmid">35021202</pub-id></mixed-citation>
    </ref>
    <ref id="btae063-B55">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Tang</surname><given-names>F</given-names></string-name>, <string-name><surname>Barbacioru</surname><given-names>C</given-names></string-name>, <string-name><surname>Wang</surname><given-names>Y</given-names></string-name></person-group><etal>et al</etal><article-title>mRNA-Seq whole-transcriptome analysis of a single cell</article-title>. <source>Nat Methods</source><year>2009</year>;<volume>6</volume>:<fpage>377</fpage>–<lpage>82</lpage>.<pub-id pub-id-type="pmid">19349980</pub-id></mixed-citation>
    </ref>
    <ref id="btae063-B56">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Villani</surname><given-names>A-C</given-names></string-name>, <string-name><surname>Satija</surname><given-names>R</given-names></string-name>, <string-name><surname>Reynolds</surname><given-names>G</given-names></string-name></person-group><etal>et al</etal><article-title>Single-cell RNA-seq reveals new types of human blood dendritic cells, monocytes, and progenitors</article-title>. <source>Science</source><year>2017</year>;<volume>356</volume>:<fpage>eaah4573</fpage>.<pub-id pub-id-type="pmid">28428369</pub-id></mixed-citation>
    </ref>
    <ref id="btae063-B57">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Wang</surname><given-names>B</given-names></string-name>, <string-name><surname>Zhu</surname><given-names>J</given-names></string-name>, <string-name><surname>Pierson</surname><given-names>E</given-names></string-name></person-group><etal>et al</etal><article-title>Visualization and analysis of single-cell RNA-seq data by kernel-based similarity learning</article-title>. <source>Nat Methods</source><year>2017</year>;<volume>14</volume>:<fpage>414</fpage>–<lpage>6</lpage>.<pub-id pub-id-type="pmid">28263960</pub-id></mixed-citation>
    </ref>
    <ref id="btae063-B58">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Wang</surname><given-names>L</given-names></string-name>, <string-name><surname>Catalan</surname><given-names>F</given-names></string-name>, <string-name><surname>Shamardani</surname><given-names>K</given-names></string-name></person-group><etal>et al</etal><article-title>Ensemble learning for classifying single-cell data and projection across reference atlases</article-title>. <source>Bioinformatics</source><year>2020a</year>;<volume>36</volume>:<fpage>3585</fpage>–<lpage>7</lpage>.<pub-id pub-id-type="pmid">32105316</pub-id></mixed-citation>
    </ref>
    <ref id="btae063-B59">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Wang</surname><given-names>L</given-names></string-name>, <string-name><surname>Nie</surname><given-names>R</given-names></string-name>, <string-name><surname>Yu</surname><given-names>Z</given-names></string-name></person-group><etal>et al</etal><article-title>An interpretable deep-learning architecture of capsule networks for identifying cell-type gene expression programs from single-cell RNA-sequencing data</article-title>. <source>Nat Mach Intell</source><year>2020b</year>;<volume>2</volume>:<fpage>693</fpage>–<lpage>703</lpage>.</mixed-citation>
    </ref>
    <ref id="btae063-B60">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Wolf</surname><given-names>FA</given-names></string-name>, <string-name><surname>Angerer</surname><given-names>P</given-names></string-name>, <string-name><surname>Theis</surname><given-names>FJ.</given-names></string-name></person-group><article-title>SCANPY: large-scale single-cell gene expression data analysis</article-title>. <source>Genome Biol</source><year>2018</year>;<volume>19</volume>:<fpage>15</fpage>.<pub-id pub-id-type="pmid">29409532</pub-id></mixed-citation>
    </ref>
    <ref id="btae063-B61">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Xie</surname><given-names>P</given-names></string-name>, <string-name><surname>Gao</surname><given-names>M</given-names></string-name>, <string-name><surname>Wang</surname><given-names>C</given-names></string-name></person-group><etal>et al</etal><article-title>SuperCT: a supervised-learning framework for enhanced characterization of single-cell transcriptomic profiles</article-title>. <source>Nucleic Acids Res</source><year>2019</year>;<volume>47</volume>:<fpage>e48</fpage>.<pub-id pub-id-type="pmid">30799483</pub-id></mixed-citation>
    </ref>
    <ref id="btae063-B62">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Xu</surname><given-names>C</given-names></string-name>, <string-name><surname>Su</surname><given-names>Z.</given-names></string-name></person-group><article-title>Identification of cell types from single-cell transcriptomes using a novel clustering method</article-title>. <source>Bioinformatics</source><year>2015</year>;<volume>31</volume>:<fpage>1974</fpage>–<lpage>80</lpage>.<pub-id pub-id-type="pmid">25805722</pub-id></mixed-citation>
    </ref>
    <ref id="btae063-B63">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Yamashita</surname><given-names>R</given-names></string-name>, <string-name><surname>Nishio</surname><given-names>M</given-names></string-name>, <string-name><surname>Do</surname><given-names>RKG</given-names></string-name></person-group><etal>et al</etal><article-title>Convolutional neural networks: an overview and application in radiology</article-title>. <source>Insights Imaging</source><year>2018</year>;<volume>9</volume>:<fpage>611</fpage>–<lpage>29</lpage>.<pub-id pub-id-type="pmid">29934920</pub-id></mixed-citation>
    </ref>
    <ref id="btae063-B64">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Yang</surname><given-names>F</given-names></string-name>, <string-name><surname>Wang</surname><given-names>W</given-names></string-name>, <string-name><surname>Wang</surname><given-names>F</given-names></string-name></person-group><etal>et al</etal><article-title>scBERT as a large-scale pretrained deep language model for cell type annotation of single-cell RNA-seq data</article-title>. <source>Nat Mach Intell</source><year>2022</year>;<volume>4</volume>:<fpage>852</fpage>–<lpage>66</lpage>.</mixed-citation>
    </ref>
    <ref id="btae063-B65">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Yang</surname><given-names>K-T-T.</given-names></string-name></person-group><article-title>Artificial neural networks (ANNs): a new paradigm for thermal science and engineering</article-title>. <source>J Heat Transfer Trans ASME</source><year>2008</year>;<volume>130</volume>:<fpage>093001</fpage>.</mixed-citation>
    </ref>
    <ref id="btae063-B66">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Yin</surname><given-names>Q</given-names></string-name>, <string-name><surname>Liu</surname><given-names>Q</given-names></string-name>, <string-name><surname>Fu</surname><given-names>Z</given-names></string-name></person-group><etal>et al</etal><article-title>scGraph: a graph neural network-based approach to automatically identify cell types</article-title>. <source>Bioinformatics</source><year>2022</year>;<volume>38</volume>:<fpage>2996</fpage>–<lpage>3003</lpage>.<pub-id pub-id-type="pmid">35394015</pub-id></mixed-citation>
    </ref>
    <ref id="btae063-B67">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Zeng</surname><given-names>Y</given-names></string-name>, <string-name><surname>Wei</surname><given-names>Z</given-names></string-name>, <string-name><surname>Pan</surname><given-names>Z</given-names></string-name></person-group><etal>et al</etal><article-title>A robust and scalable graph neural network for accurate single-cell classification</article-title>. <source>Brief Bioinform</source><year>2022</year>;<volume>23</volume>:<fpage>bbab570</fpage>.<pub-id pub-id-type="pmid">35018408</pub-id></mixed-citation>
    </ref>
    <ref id="btae063-B68">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Zhou</surname><given-names>J</given-names></string-name>, <string-name><surname>Cui</surname><given-names>G</given-names></string-name>, <string-name><surname>Hu</surname><given-names>S</given-names></string-name></person-group><etal>et al</etal><article-title>Graph neural networks: a review of methods and applications</article-title>. <source>AI Open</source><year>2020</year>;<volume>1</volume>:<fpage>57</fpage>–<lpage>81</lpage>.</mixed-citation>
    </ref>
    <ref id="btae063-B69">
      <mixed-citation publication-type="book"><person-group person-group-type="author"><string-name><surname>Zhou</surname><given-names>Z-H.</given-names></string-name></person-group><source>Ensemble Methods Foundations and Algorithms</source>. United States: <publisher-name>CRC Press</publisher-name>, <year>2012</year>.</mixed-citation>
    </ref>
    <ref id="btae063-B70">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Žurauskienė</surname><given-names>J</given-names></string-name>, <string-name><surname>Yau</surname><given-names>C.</given-names></string-name></person-group><article-title>pcaReduce: hierarchical clustering of single cell transcriptional profiles</article-title>. <source>BMC Bioinformatics</source><year>2016</year>;<volume>17</volume>:<fpage>140</fpage>.<pub-id pub-id-type="pmid">27005807</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
