<?properties open_access?>
<?properties manuscript?>
<?origin nihpa?>
<?iso-abbr Nat. Biotechnol.?>
<?submitter-system nihms?>
<?submitter-canonical-name Nature Publishing Group?>
<?submitter-canonical-id NATURE-STRUCTUR?>
<?submitter-userid 8068858?>
<?submitter-authority myNCBI?>
<?submitter-login nature-structure?>
<?submitter-name Nature Publishing Group?>
<?domain nihpa?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-journal-id">9604648</journal-id>
    <journal-id journal-id-type="pubmed-jr-id">20305</journal-id>
    <journal-id journal-id-type="nlm-ta">Nat Biotechnol</journal-id>
    <journal-id journal-id-type="iso-abbrev">Nat. Biotechnol.</journal-id>
    <journal-title-group>
      <journal-title>Nature biotechnology</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1087-0156</issn>
    <issn pub-type="epub">1546-1696</issn>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">5607865</article-id>
    <article-id pub-id-type="pmid">28263296</article-id>
    <article-id pub-id-type="doi">10.1038/nbt.3804</article-id>
    <article-id pub-id-type="manuscript">nihpa847627</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Article</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>GuideScan software for improved single and paired CRISPR guide RNA design</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Perez</surname>
          <given-names>Alexendar R.</given-names>
        </name>
        <xref ref-type="aff" rid="A1">1</xref>
        <xref ref-type="aff" rid="A2">2</xref>
        <xref ref-type="aff" rid="A3">3</xref>
        <xref rid="FN2" ref-type="author-notes">4</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Pritykin</surname>
          <given-names>Yuri</given-names>
        </name>
        <xref ref-type="aff" rid="A1">1</xref>
        <xref rid="FN2" ref-type="author-notes">4</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Vidigal</surname>
          <given-names>Joana A.</given-names>
        </name>
        <xref ref-type="aff" rid="A2">2</xref>
        <xref rid="FN2" ref-type="author-notes">4</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Chhangawala</surname>
          <given-names>Sagar</given-names>
        </name>
        <xref ref-type="aff" rid="A1">1</xref>
        <xref ref-type="aff" rid="A3">3</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Zamparo</surname>
          <given-names>Lee</given-names>
        </name>
        <xref ref-type="aff" rid="A1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Leslie</surname>
          <given-names>Christina S.</given-names>
        </name>
        <xref ref-type="aff" rid="A1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Ventura</surname>
          <given-names>Andrea</given-names>
        </name>
        <xref ref-type="aff" rid="A2">2</xref>
      </contrib>
    </contrib-group>
    <aff id="A1"><label>1</label>Computational Biology Program, Memorial Sloan Kettering Cancer Center, New York, New York, USA</aff>
    <aff id="A2"><label>2</label>Cancer Biology and Genetics Program, Memorial Sloan Kettering Cancer Center, New York, New York, USA</aff>
    <aff id="A3"><label>3</label>Weill Cornell Graduate School of Medical Sciences of Cornell University, New York, New York, USA</aff>
    <author-notes>
      <corresp id="FN1">Corresponding authors: Andrea Ventura: <email>venturaa@mskcc.org</email>. Christina S. Leslie: <email>cleslie@cbio.mskcc.org</email>. Joana A. Vidigal: <email>decampoj@mskcc.org</email></corresp>
      <fn id="FN2" fn-type="equal">
        <label>4</label>
        <p>These authors contributed equally.</p>
      </fn>
    </author-notes>
    <pub-date pub-type="nihms-submitted">
      <day>5</day>
      <month>2</month>
      <year>2017</year>
    </pub-date>
    <pub-date pub-type="epub">
      <day>06</day>
      <month>3</month>
      <year>2017</year>
    </pub-date>
    <pub-date pub-type="ppub">
      <month>4</month>
      <year>2017</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>22</day>
      <month>9</month>
      <year>2017</year>
    </pub-date>
    <volume>35</volume>
    <issue>4</issue>
    <fpage>347</fpage>
    <lpage>349</lpage>
    <!--elocation-id from pubmed: 10.1038/nbt.3804-->
    <permissions>
      <license>
        <license-p>Users may view, print, copy, and download text and data-mine the content in such documents, for the purposes of academic research, subject always to the full Conditions of use:
<uri xlink:type="simple" xlink:href="http://www.nature.com/authors/editorial_policies/license.html#terms">http://www.nature.com/authors/editorial_policies/license.html#terms</uri></license-p>
      </license>
    </permissions>
    <abstract>
      <p id="P1">We present GuideScan software for the design of CRISPR guide RNA libraries that can be used to edit coding and noncoding genomic regions. GuideScan produces high-density sets of gRNAs for single- and paired-gRNA genome-wide screens. We also show that by using a trie data structure GuideScan designs gRNAs that are more specific than those designed by existing tools.</p>
    </abstract>
  </article-meta>
</front>
<body>
  <p id="P2">CRISPR-Cas9 genome editing<sup><xref rid="R1" ref-type="bibr">1</xref>, <xref rid="R2" ref-type="bibr">2</xref></sup> can be used for both straightforward disruption of single protein coding genes and genome-wide loss-of-function screens<sup><xref rid="R3" ref-type="bibr">3</xref>–<xref rid="R6" ref-type="bibr">6</xref></sup>. However, application of CRISPR-Cas9 genome editing to the non-coding genome remains limited</p>
  <p id="P3">Disruption of noncoding RNA or DNA elements using CRISPR-Cas9 often requires the concomitant expression of two gRNAs to engineer deletions <sup><xref rid="R8" ref-type="bibr">8</xref>, <xref rid="R10" ref-type="bibr">10</xref></sup>. Although progress has been made towards making the construction of paired-gRNA vectors scalable<sup><xref rid="R11" ref-type="bibr">11</xref></sup>, the absence of tools to design paired-gRNA libraries has hampered progress towards genome-wide non-coding genetic screens. To overcome this limitation we developed GuideScan, an open-source software package that allows users to construct comprehensive and fully customizable gRNA databases for any genome or CRISPR endonuclease and design paired- and single-gRNA libraries (<xref rid="F1" ref-type="fig">Fig 1a</xref>).</p>
  <p id="P4">The first step in building a gRNA database is identifying the targetable genome space. To accommodate different CRISPR endonucleases with distinct specificity requirements, GuideScan allows the user to define target sequences by setting the values of three parameters: the protospacer associated motif (PAM), the PAM position relative to the gRNA binding sequence, and gRNA length<sup><xref rid="R12" ref-type="bibr">12</xref></sup> (<xref rid="F1" ref-type="fig">Fig. 1a</xref>, <bold>middle panel</bold>). Non-canonical PAMs can also be specified, since they can be recognized and cleaved by CRISPR proteins with some efficiency and thus may contribute to off-target cutting.</p>
  <p id="P5">Next, gRNA sequences that can lead to cleavage of multiple genomic loci need to be identified and removed. Because CRISPR endonucleases can tolerate single mismatches in gRNA-DNA pairing<sup><xref rid="R13" ref-type="bibr">13</xref></sup>, gRNAs that have less than 2 mismatches to off-target loci are typically avoided<sup><xref rid="R14" ref-type="bibr">14</xref></sup>. Third party alignment tools are often used to identify potential off-target loci in the genome, but we and others<sup><xref rid="R12" ref-type="bibr">12</xref></sup> have found that they are unable to return all mismatch neighbors (data not shown) and thus consistently underestimate the number of potential off-targets for a given gRNA<sup><xref rid="R15" ref-type="bibr">15</xref></sup>.</p>
  <p id="P6">Rather than using an alignment tool, GuideScan uses a retrieval tree (trie) data structure, which efficiently and precisely enumerates all targetable sequences present in a given genome (<xref rid="F1" ref-type="fig">Fig. 1a</xref>, <bold>right panel</bold>). Traversals of the trie allow for the computation of sequence mismatch neighborhoods, which are used to construct databases of gRNAs whose target sites are unique in the genome up to a user-defined number of mismatches (M). Additionally, for gRNAs in the database, more degenerate target sequences – up to Q (Q &gt; M) mismatches – can be correctly enumerated, and stored in the database as potential off-target loci. Each gRNA can be further annotated with additional information, including on-target efficiency scores<sup><xref rid="R13" ref-type="bibr">13</xref></sup> and the genomic feature(s) it overlaps with (e.g. exon, intron, intergenic region). Once constructed, the database allows efficient individual or batch queries of genomic coordinates for single or paired gRNA designs.</p>
  <p id="P7">To validate GuideScan, we generated a murine Cas9 database with M=1. This database contains over 1.7×10<sup>8</sup> gRNAs, with an average distance of 15.5 nucleotides between gRNAs designed over autosomes, and is two orders of magnitude larger than the only other available genome-wide gRNA database, provided by mit.edu as a UCSC genome browser track (<xref rid="SD2" ref-type="supplementary-material">Supplementary Figure 1a</xref> and <xref rid="SD1" ref-type="supplementary-material">Supplementary Note</xref>).</p>
  <p id="P8">To test if using Guidescan translated into a better practical outcome in terms of designing gRNAs for precise genomic deletions in the noncoding genome, we took the coordinates of mouse CTCF binding sites, enhancers, miRNAs, and lncRNAs and used GuideScan or the mit.edu genome-wide UCSC track gRNA database to design pairs of gRNAs against each target site. We found that the combined median distances of the GuideScan gRNA pairs to the feature boundaries were 29, 31, 24, and 27 base pairs (bp) respectively, compared with 781, 783, 716 and 774 bp when using gRNAs from the mit.edu genome-wide track (<xref rid="F1" ref-type="fig">Fig. 1b</xref>). Thus, databases generated by our tool are suitable for the engineering of precise genomic deletions and the generation of loss-of-function alleles for noncoding regulatory elements (<xref rid="F1" ref-type="fig">Figure 1c, d</xref>).</p>
  <p id="P9">To further benchmark GuideScan, we compared it to three widely used gRNA design tools: the mit.edu web interface<sup><xref rid="R14" ref-type="bibr">14</xref></sup> (see <xref rid="SD1" ref-type="supplementary-material">Supplementary Note</xref>), CRISPRscan<sup><xref rid="R10" ref-type="bibr">10</xref></sup>, and E-CRISP<sup><xref rid="R16" ref-type="bibr">16</xref></sup>. Unlike GuideScan these tools do not provide direct access to the underlying databases, so we queried 150 regions in the mouse genome overlapping randomly selected protein-coding genes, noncoding elements, and repetitive regions. All tools returned distinct but overlapping sets of gRNAs (<xref rid="F2" ref-type="fig">Fig. 2a</xref> and <xref rid="SD1" ref-type="supplementary-material">Supp. Table 1</xref>), and surprisingly all except for GuideScan returned a substantial fraction of guides having more than one perfect target site—hereafter referred to as ‘perfect off-targets’ (<xref rid="F2" ref-type="fig">Fig. 2a</xref>, <xref rid="SD1" ref-type="supplementary-material">Supp. Table 2</xref>). In the most extreme cases, individual gRNAs had more than 30,000 perfect off-targets (<xref rid="F2" ref-type="fig">Fig. 2b</xref>) that were missed by the corresponding design tool (<xref rid="SD1" ref-type="supplementary-material">Supp. Table 1</xref>) and consequently were not considered when calculating the gRNA’s specificity score. In fact, gRNAs with more than one perfect target site were roughly equally distributed between low (26%), medium (37%), and high (37%) specificity score categories according to the output of the mit.edu web interface<sup><xref rid="R11" ref-type="bibr">11</xref></sup> (<xref rid="SD2" ref-type="supplementary-material">Supp. Fig. 1b</xref>).</p>
  <p id="P10">In addition, the competitor tools that we tested underreported the number of off-target sites with single mismatches to the gRNA (<xref rid="SD1" ref-type="supplementary-material">Supp. Table 1</xref>). Based on these observations we predicted that gRNAs returned by GuideScan should have, on average, greater specificity than gRNAs reported by the other tools. To test this prediction, we used GuideScan’s trie function to enumerate all potential off-target loci (Q=3) for the gRNAs designed by all tools, and calculated the likelihood of cleavage at these sites using a recently reported metric that takes into account the number, position, and nature of mismatches<sup><xref rid="R13" ref-type="bibr">13</xref></sup>. We then used these values to calculate the aggregate specificity score for each gRNA as previously described<sup><xref rid="R14" ref-type="bibr">14</xref></sup>. We found that gRNAs designed by GuideScan had on average significantly higher specificity scores than those returned by the mit.edu web interface (p&lt;2.2×10<sup>−16</sup>; D=0.22; Z=7.38) or by CRISPRScan (p&lt;2.2×10<sup>−16</sup>; D=0.25; Z=6.59) (<xref rid="F2" ref-type="fig">Fig. 2c</xref>). E-CRISP and GuideScan had similar distribution of specificity scores, but E-CRISP returned an order of magnitude fewer gRNAs, some of which had multiple perfect or near-perfect matches in the genome (<xref rid="F2" ref-type="fig">Fig. 2a, 2b</xref> and <xref rid="SD1" ref-type="supplementary-material">Supp. Table 2</xref>).</p>
  <p id="P11">Failure to discard gRNAs with multiple perfect target sites has important implications in the design and interpretation of gene editing experiments. The number of DSBs induced by a gRNA in a single cell correlates well with gene-independent gRNA depletion, and is a major source of noise in negative selection screens<sup><xref rid="R17" ref-type="bibr">17</xref></sup>. Thus, the correct identification and filtering of promiscuous gRNAs is crucial for designing effective CRISPR libraries. Furthermore, unknowingly using gRNAs with multiple perfect target sites can result in highly efficient gene editing at undesired sites (<xref rid="F2" ref-type="fig">Fig. 2d</xref>) as well as the generation of chromosomal rearrangements<sup><xref rid="R18" ref-type="bibr">18</xref></sup> such as translocations (<xref rid="F2" ref-type="fig">Fig. 2e</xref>) and deletions (<xref rid="F2" ref-type="fig">Fig. 2f</xref>) that include the desired cleavage site and the unknown additional sites.</p>
  <p id="P12">To facilitate the construction of single and paired gRNA libraries, we have released a web interface that includes access to pre-compiled genome-wide Cas9 and Cpf1 gRNAs databases for many model organisms (<ext-link ext-link-type="uri" xlink:href="www.guidescan.com">www.guidescan.com</ext-link>). This website allows users to input coordinates of genomic features in batch, to choose between designing single internal gRNAs or pairs of flanking gRNAs, and retrieve for each genomic coordinate a pre-defined number of gRNAs or gRNA pairs.</p>
  <p id="P13">Collectively, these data show that GuideScan is a substantial improvement compared with existing gRNA design tools. We expect that this tool will facilitate ongoing efforts aimed at deducing functions of coding and the noncoding parts of genomes.</p>
  <sec sec-type="methods" id="S1" specific-use="web-only">
    <title>Methods</title>
    <sec id="S2">
      <title>Command line gRNA database generation</title>
      <p id="P14">To generate a customized genome-wide gRNA database for a given CRISPR system the user supplies the target genome as a FASTA file and specifies parameters such as desired gRNA length, PAM position with respect to gRNA, canonical and alternative PAM sequences, Hamming distance (M) for which gRNAs are required to have a unique target site in the genome, and Hamming distance (Q) for which potential off-targets will be enumerated. Like other methods, the algorithm scans a genome for canonical and alternative PAM sequences and identifies all k-mers associated with them<sup><xref rid="R21" ref-type="bibr">21</xref></sup>. The full universe of these k-mers and PAM sequences with their coordinates are written out to a temporary file along with a count of how often a particular k-mer occurs in the genome. At the next stage, the algorithm analyzes the list of k-mers and determines which of these k-mers constitute potential gRNAs. A trie of all k-mers is constructed. The trie stores a user-defined maximum number of k-mer coordinates. If and only if a k-mer occurs with a canonical PAM uniquely in the genome then it is initially labeled as a candidate gRNA. However, if the k-mer occurs more than once in the genome or occurs with an alternative PAM then it is labeled as a non-candidate gRNA. These non-candidate gRNAs are written out to ‘blacklist’ files which define why a k-mer was rejected as a candidate gRNA. Furthermore, the algorithm ensures that each gRNA has a unique target in the genome up to M mismatches, thereby forcing all candidate gRNAs to be distinct from one another by at least M mismatches. This task is accomplished through trie traversals, where for each candidate gRNA sequence a mismatch neighborhood (which in this case is the set of inexact matches to the candidate gRNA up to M mismatches) is assessed. If even one mismatch neighbor sequence is found for a given candidate gRNA, then this gRNA is not unique in the genome up to M mismatches and is therefore relabeled as a non-candidate gRNA and written to the ‘blacklist’ file. The gRNAs that are unique in the genome up to M mismatches can have off-targets completely enumerated up to Q (where Q &gt; M) mismatches. Off-target information for candidate gRNAs is again determined by trie traversals and computing the mismatch neighborhood for a given gRNA sequence. By construction, the gRNAs undergoing off-target enumeration have no off-targets within M mismatches, and so if an inexact match to the gRNA sequence with P mismatches is found, such that M &lt; P ≤ Q, then the number of times this off-target sequence occurs, its Hamming distance P, and coordinates for a user-defined number of off-target are recorded. Candidate gRNAs are written from the trie to a file in sequence alignment map (SAM) format<sup><xref rid="R19" ref-type="bibr">19</xref></sup>. This file has the gRNA sequence as a unique identifier as well as off-target information for the gRNA stored in a hex-byte array. SAM tags record a maximum count of off-targets, the distance for which off-targets were searched, and the hex-byte array of off-target sequences and their coordinates. This SAM file is then converted to a BAM file and indexed so that it can be quickly accessed using Samtools.</p>
    </sec>
    <sec id="S3">
      <title>Database cutting efficiency scores</title>
      <p id="P15">The guideRNA database can be enriched with additional information such as on-target cutting efficiency scores. We adopt the scores defined by Doench et al. Rule Set 2<sup><xref rid="R13" ref-type="bibr">13</xref></sup> Scores are computed for each gRNA and added to the previously constructed database. This rule set predicts on-target gRNA cutting efficiency using a learned boosted regression tree model. The input for this model requires a 30mer sequence, only assesses cutting efficiency for 20mer gRNAs, and only predicts cutting efficiency for gRNAs with the canonical Cas9 PAM sequence (NGG).</p>
    </sec>
    <sec id="S4">
      <title>Database cutting specificity scores</title>
      <p id="P16">A database BAM file, composed of Cas9 gRNAs with 20mer complementary region and NGG PAM, can be supplemented to include gRNA specificity scores. Specificity scores for gRNAs are based on the Doench et al. CFD model<sup><xref rid="R13" ref-type="bibr">13</xref></sup>, which computes the likelihood of a gRNA cutting at each individual off-target site using an experimentally derived mutation matrix. Specifically, for a given gRNA GuideScan enumerates all its neighbors up to Q mismatches, calculates the CFD score for each neighbor, and then multiplies that score by the number of times the neighbor occurs in the genome. It then aggregates the CFD values into a single composite score utilizing the formula used by Hsu et al.<sup><xref rid="R14" ref-type="bibr">14</xref></sup>: 
<disp-formula id="FD1"><mml:math id="M1" display="block" overflow="scroll"><mml:mrow><mml:mi mathvariant="italic">Specificity</mml:mi><mml:mspace width="0.16667em"/><mml:mi mathvariant="italic">Score</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>n</mml:mi></mml:msubsup><mml:msub><mml:mi mathvariant="italic">CFD</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>∗</mml:mo><mml:msub><mml:mi>q</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mfrac></mml:mrow></mml:math></disp-formula></p>
      <p id="P17">Here, n represents the number of unique targetable sites within up to z mismatches. The desired on-target site (z = 0) is included in this computation and will give a CFD value of one. The value q<sub>i</sub> represents the number of times the i<sup>th</sup> neighbor occurs in the genome. For a unique target site up to z mismatches, the specificity score would be 1 since CFD = i = n = q<sub>i</sub> = 1. The resulting composite specificity score is written out to a text file along with information such as the target sequence and target coordinates. These scores are then added to the BAM file as a new SAM tag. Importantly, because the GuideScan algorithm is general and allows the construction of gRNA databases for distinct enzymes and distinct gRNA lengths, specificity scores are not automatically computed. If a user chooses to compute these scores, GuideScan first determines whether the database conforms to the parameters required for CFD scoring, and if so computes the aggregate specificity score for each gRNA in that database. For the specificity scores in the pre-computed Cas9 databases on the GuideScan web-interface, the parameters z = Q = 3 were used.</p>
    </sec>
    <sec id="S5">
      <title>Database query and gRNA annotations</title>
      <p id="P18">The algorithm allows for the direct query of the BAM file database using PySam (python interface to samtools; <ext-link ext-link-type="uri" xlink:href="https://github.com/pysam-developers/pysam">https://github.com/pysam-developers/pysam</ext-link>) and allows for the lookup of gRNAs by genomic coordinates. The output contains the gRNAs in the queried region, off-target information, predicted Rule Set 2 cutting efficiency score if appropriate, as well as the exon annotation of on-target gRNA and off-target cut sites. The exon annotation relies on the creation of an interval tree constructed from a BED file containing genome-wide exon coordinates. Consequently, the exon annotation for gRNAs is done at the time of database query.</p>
    </sec>
    <sec id="S6">
      <title>Code availability</title>
      <p id="P19">The code is freely available at guidescan.com, in <xref rid="SD1" ref-type="supplementary-material">Supplementary Code</xref> and at bitbucket (bitbucket.org/arp2012/crispr-project/overview). Version v0.0.4 of the code was used to generate the data presented in this manuscript.</p>
    </sec>
    <sec id="S7">
      <title>Web server implementation</title>
      <p id="P20">The algorithm was run on a select set of model organisms, as well as on human genome, to produce gRNA databases where all constituent gRNAs are unique in the genome up to two mismatches. These databases are accessible through a web interface that allows for batch queries by genomic coordinates. The website allows the user to find gRNAs within a genomic region or flanking a genomic region and allows the output to be sorted according to either number of off-targets, distance to target site, or cutting efficiency score. The website utilizes the database query ability of our algorithm to rapidly report gRNAs for user defined regions and achieves its functionality through CherryPy, a python web framework (<ext-link ext-link-type="uri" xlink:href="http://www.cherrypy.org/">http://www.cherrypy.org/</ext-link>).</p>
    </sec>
    <sec id="S8">
      <title>Tool comparisons</title>
      <p id="P21">The comparisons shown in <xref rid="F1" ref-type="fig">Figure 1b</xref> were done using the coordinates mouse CTCF binding sites, enhancers, miRNAs, and lncRNAs retrieved from the following publications <sup><xref rid="R21" ref-type="bibr">21</xref>–<xref rid="R24" ref-type="bibr">24</xref></sup>. The outputs of GuideScan, crispr.mit.edu web portal<sup><xref rid="R14" ref-type="bibr">14</xref></sup>, CRISPRscan<sup><xref rid="R10" ref-type="bibr">10</xref></sup>, and E-CRISP<sup><xref rid="R16" ref-type="bibr">16</xref></sup> were compared on sequences overlapping randomly chosen protein coding genes, noncoding genomic elements, and repeat masked regions. We limited our test to a total of 150 sequences (50 protein coding genes, 50 noncoding elements, 50 repeat masked regions) from mm10 (the most recent assembly of <italic>M. musculus</italic> genome) because the input limits (file size/number of sequences) associated with some of these tools made larger scale comparisons impractical. Similarly, we limited the size of the test sequences to 150 base pairs due to input limits of some of the tools. The genomic coordinates of the sequences used in these comparisons are provided in <xref rid="SD1" ref-type="supplementary-material">Supplementary Table 3</xref>. Importantly, the CRISPRscan tool provides both 19mer and 20mer gRNA designs. For the purpose of this experiment we limited our analysis to 20mers because they could be directly compared to the gRNA designs provided by the remaining softwares. The number and type of off-targets for each gRNA was determined by querying GuideScan’s software package intermediate kmers file and independently through a R query of BSgenome mm10 version.</p>
    </sec>
    <sec id="S9">
      <title>Statistical Methods</title>
      <p id="P22">A one-sided Kolmogorov-Smirnov test was used to compare the specificity scores of 1839 GuideScan gRNAs against 267 E-CRISP gRNAs, 1189 CRISPRScan gRNAs, and 2641 MIT gRNAs; <italic>P</italic> values were computed using the ks.test function in R. Additionally, the effect sizes (Z) of these comparisons were reported using the formula</p>
      <p id="P23"><disp-formula id="FD2"><mml:math id="M2" display="block" overflow="scroll"><mml:mrow><mml:mi>Z</mml:mi><mml:mo>=</mml:mo><mml:mi>D</mml:mi><mml:msqrt><mml:mfrac><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>∗</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:mfrac></mml:msqrt></mml:mrow></mml:math></disp-formula> where D is the Kolmogorov-Smirnov statistic equaling the maximum difference between empirical CDF functions of the two samples in the comparison, and n<sub>1</sub> and n<sub>2</sub> are the sample sizes.</p>
    </sec>
    <sec id="S10">
      <title>DNA constructs</title>
      <p id="P24">Paired-gRNA vectors to generate deletions of DNA and RNA noncoding elements were cloned as previously described<sup><xref rid="R11" ref-type="bibr">11</xref></sup>. Briefly, s/mU6 oligos carrying the sequence corresponding to 2 gRNAs for each locus (miR-290~295: gRNA1, TAGTACATCGGTCTAACTCA; gRNA2, GTTGAGACTAAAGGTAATCC. Enhancer element: gRNA1, AGCTACCCCGTAACCAAGTG; gRNA2, AAGGCCATATAGTTGTCGCC) were PCR amplified and cloned into <italic>BsmB</italic>I digested lentiCRISPRv1 vector (addgene #49535) using pDonor_sU6 intermediate vector (addgene #69351). Single gRNAs were cloned into BsmBI digested lentiCRISPRv1 vector using standard oligo cloning protocols.</p>
    </sec>
    <sec id="S11">
      <title>Cell culture and detection of genomic editing</title>
      <p id="P25">The V6.5 Mouse Embryonic Stem cells (obtained from Rudolf Jaenisch) were tested for germline transmission and for the absence of mycoplasma infection. These cells were grown on a monolayer of irradiated mouse embryo fibroblasts at 37°C (5% CO<sub>2</sub>) in KnockOut DMEM media (Gibco) supplemented with 15% FCS, L-glutamine (2mM), penicillin (100U ml^−1), streptomycin (100μg ml^−1), and LIF (10<sup>3</sup> U ml^−1). To generate genomic deletions, paired-gRNA vectors were transfected using Lipofectamine 2000 (Invitrogen) according to manufacturer’s protocols. Cells were collected in lysis buffer (100 mM Tris-HCl pH8.5, 200 mM NaCl, 5 mM EDTA, 0.2% SDS and 100 ng ml^−1 proteinase K) 6 days following transfection, and genomic DNA extracted using phenol-chloroform followed by ethanol precipitation. Genomic deletions were detected by PCR using primers flanking the gRNA cut sites (miR_fwd: AGGGAGGAACGAGCCTATGT, miR_rev: GCATGCCTAAATCCCAAGAG; enh_fwd: GTGGCTCAGTGTTTCCCATT, enh_rev: CAGGCAAACTCTCCCATGTT). PCR bands corresponding to the genomic deletions were cloned into the Topo Blunt II vector (Invitrogen) and plasmid DNA from individual bacterial clones subject to Sanger sequencing.</p>
      <p id="P26">To test cleavage and rearrangements produced by single gRNAs, 293T cells (obtained from ATCC, cultured under standard conditions, and tested negative for mycoplasma contamination) were plated on 12-well-plates (Corning). Constructs expressing individual gRNAs were transfected into cells the following day using lipofectamine 2000 (Invitrogen) and transfected cells selected with puromycin (4 μg ml^−1) for 2 days. Four days following transfection, genomic DNA was extracted as above and used to determine total cleavage and generation of genomic rearrangements. Total editing at perfect target sites was determined using a T7 endonuclease assay. Briefly, target sites in a pool of transfected cells were amplified by PCR, and 200ng of resulting amplicon were used to generate DNA heteroduplexes. The resulting molecules were incubated with 10U of T7 endonuclease (NEB) for 15 minutes and the product of the digestion run on a 2% agarose gel. Total editing estimates were calculated as previously described<sup><xref rid="R25" ref-type="bibr">25</xref></sup>. Sequences or gRNAs and primers used in these experiments are shown in <xref rid="SD1" ref-type="supplementary-material">Supplementary Table 4</xref>.</p>
    </sec>
  </sec>
  <sec sec-type="supplementary-material" id="S13">
    <title>Supplementary Material</title>
    <supplementary-material content-type="local-data" id="SD1">
      <label>1</label>
      <media xlink:href="NIHMS847627-supplement-1.doc" orientation="portrait" xlink:type="simple" id="d36e599" position="anchor"/>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="SD2">
      <label>2</label>
      <media xlink:href="NIHMS847627-supplement-2.pdf" orientation="portrait" xlink:type="simple" id="d36e603" position="anchor"/>
    </supplementary-material>
  </sec>
</body>
<back>
  <ack id="S14">
    <p>We thank members of the Ventura and the Leslie laboratories for comments and suggestions. We thank Lauren Fairchild and Rafi Pelossof for providing source code for the SplashRNA web server to serve as the backbone for the GuideScan website. This work was supported in part by NIH: grants P30-CA008748 (MSK Core), U01-HG007033 (CSL), U01-HG007893 (CSL), and by grants from the Geoffrey Beene Cancer Research Foundation (AV), the Uniting Against Lung Cancer Foundation (AV), the Cycle for Survival Foundation (AV), the Pershing Square Sohn Cancer Research Alliance (AV), and the Lung Cancer Research Foundation (JAV). The GuideScan source code and all associated documentation are deposited at guidescan.com.</p>
  </ack>
  <fn-group>
    <fn id="FN3" fn-type="con">
      <p>
        <bold>Author Contributions</bold>
      </p>
      <p>J.A.V., C.S.L., and A.V. conceived and supervised the project. Y.P. and A.R.P. developed the GuideScan algorithm with input from C.S.L.; A.R.P and Y.P. implemented the GuideScan software package; A.R.P. performed the computational experiments; J.A.V. performed the wet-lab experiments; A.R.P and S.C. implemented the web-server; L.Z. provided expertise in software development and helped improve the website user experience; J.A.V drafted the manuscript with contributions from all authors.</p>
    </fn>
    <fn fn-type="COI-statement" id="FN4">
      <p>
        <bold>Competing Financial Interests</bold>
      </p>
      <p>The authors declare no competing financial interests.</p>
    </fn>
  </fn-group>
  <ref-list>
    <ref id="R1">
      <label>1</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Doudna</surname>
            <given-names>JA</given-names>
          </name>
          <name>
            <surname>Charpentier</surname>
            <given-names>E</given-names>
          </name>
        </person-group>
        <source>Science</source>
        <volume>346</volume>
        <fpage>1258096</fpage>
        <year>2014</year>
        <pub-id pub-id-type="pmid">25430774</pub-id>
      </element-citation>
    </ref>
    <ref id="R2">
      <label>2</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hsu</surname>
            <given-names>PD</given-names>
          </name>
          <etal/>
        </person-group>
        <source>Cell</source>
        <volume>157</volume>
        <fpage>1262</fpage>
        <lpage>1278</lpage>
        <year>2014</year>
        <pub-id pub-id-type="pmid">24906146</pub-id>
      </element-citation>
    </ref>
    <ref id="R3">
      <label>3</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Shalem</surname>
            <given-names>O</given-names>
          </name>
          <etal/>
        </person-group>
        <source>Science</source>
        <volume>343</volume>
        <fpage>84</fpage>
        <lpage>87</lpage>
        <year>2014</year>
        <pub-id pub-id-type="pmid">24336571</pub-id>
      </element-citation>
    </ref>
    <ref id="R4">
      <label>4</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Koike-Yusa</surname>
            <given-names>H</given-names>
          </name>
          <etal/>
        </person-group>
        <source>Nature biotechnology</source>
        <volume>32</volume>
        <fpage>267</fpage>
        <lpage>273</lpage>
        <year>2014</year>
      </element-citation>
    </ref>
    <ref id="R5">
      <label>5</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wang</surname>
            <given-names>T</given-names>
          </name>
          <etal/>
        </person-group>
        <source>Science</source>
        <volume>343</volume>
        <fpage>80</fpage>
        <lpage>84</lpage>
        <year>2014</year>
        <pub-id pub-id-type="pmid">24336569</pub-id>
      </element-citation>
    </ref>
    <ref id="R6">
      <label>6</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Korkmaz</surname>
            <given-names>G</given-names>
          </name>
          <etal/>
        </person-group>
        <source>Nature biotechnology</source>
        <volume>34</volume>
        <fpage>192</fpage>
        <lpage>198</lpage>
        <year>2016</year>
      </element-citation>
    </ref>
    <ref id="R7">
      <label>7</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Rajagopal</surname>
            <given-names>N</given-names>
          </name>
          <etal/>
        </person-group>
        <source>Nature biotechnology</source>
        <volume>34</volume>
        <fpage>167</fpage>
        <lpage>174</lpage>
        <year>2016</year>
      </element-citation>
    </ref>
    <ref id="R8">
      <label>8</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zhu</surname>
            <given-names>S</given-names>
          </name>
          <etal/>
        </person-group>
        <source>Nature biotechnology</source>
        <year>2016</year>
      </element-citation>
    </ref>
    <ref id="R9">
      <label>9</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Canver</surname>
            <given-names>MC</given-names>
          </name>
          <etal/>
        </person-group>
        <source>Nature</source>
        <volume>527</volume>
        <fpage>192</fpage>
        <lpage>197</lpage>
        <year>2015</year>
        <pub-id pub-id-type="pmid">26375006</pub-id>
      </element-citation>
    </ref>
    <ref id="R10">
      <label>10</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Moreno-Mateos</surname>
            <given-names>MA</given-names>
          </name>
          <etal/>
        </person-group>
        <source>Nature methods</source>
        <volume>12</volume>
        <fpage>982</fpage>
        <lpage>988</lpage>
        <year>2015</year>
        <pub-id pub-id-type="pmid">26322839</pub-id>
      </element-citation>
    </ref>
    <ref id="R11">
      <label>11</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Vidigal</surname>
            <given-names>JA</given-names>
          </name>
          <name>
            <surname>Ventura</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <source>Nature communications</source>
        <volume>6</volume>
        <fpage>8083</fpage>
        <year>2015</year>
      </element-citation>
    </ref>
    <ref id="R12">
      <label>12</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Fu</surname>
            <given-names>Y</given-names>
          </name>
          <etal/>
        </person-group>
        <source>Nature biotechnology</source>
        <volume>32</volume>
        <fpage>279</fpage>
        <lpage>284</lpage>
        <year>2014</year>
      </element-citation>
    </ref>
    <ref id="R13">
      <label>13</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Doench</surname>
            <given-names>JG</given-names>
          </name>
          <etal/>
        </person-group>
        <source>Nature biotechnology</source>
        <volume>34</volume>
        <fpage>184</fpage>
        <lpage>191</lpage>
        <year>2016</year>
      </element-citation>
    </ref>
    <ref id="R14">
      <label>14</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hsu</surname>
            <given-names>PD</given-names>
          </name>
          <etal/>
        </person-group>
        <source>Nature biotechnology</source>
        <volume>31</volume>
        <fpage>827</fpage>
        <lpage>832</lpage>
        <year>2013</year>
      </element-citation>
    </ref>
    <ref id="R15">
      <label>15</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Tsai</surname>
            <given-names>SQ</given-names>
          </name>
          <etal/>
        </person-group>
        <source>Nature biotechnology</source>
        <volume>33</volume>
        <fpage>187</fpage>
        <lpage>197</lpage>
        <year>2015</year>
      </element-citation>
    </ref>
    <ref id="R16">
      <label>16</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Heigwer</surname>
            <given-names>F</given-names>
          </name>
          <etal/>
        </person-group>
        <source>Nature methods</source>
        <volume>11</volume>
        <fpage>122</fpage>
        <lpage>123</lpage>
        <year>2014</year>
        <pub-id pub-id-type="pmid">24481216</pub-id>
      </element-citation>
    </ref>
    <ref id="R17">
      <label>17</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Aguirre</surname>
            <given-names>AJ</given-names>
          </name>
          <etal/>
        </person-group>
        <source>Cancer discovery</source>
        <year>2016</year>
      </element-citation>
    </ref>
    <ref id="R18">
      <label>18</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Maddalo</surname>
            <given-names>D</given-names>
          </name>
          <etal/>
        </person-group>
        <source>Nature</source>
        <volume>516</volume>
        <fpage>423</fpage>
        <lpage>427</lpage>
        <year>2014</year>
        <pub-id pub-id-type="pmid">25337876</pub-id>
      </element-citation>
    </ref>
    <ref id="R19">
      <label>19</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Li</surname>
            <given-names>H</given-names>
          </name>
          <etal/>
        </person-group>
        <source>Bioinformatics</source>
        <volume>25</volume>
        <fpage>2078</fpage>
        <lpage>2079</lpage>
        <year>2009</year>
        <pub-id pub-id-type="pmid">19505943</pub-id>
      </element-citation>
    </ref>
    <ref id="R20">
      <label>20</label>
      <element-citation publication-type="journal">
        <collab>Consortium EP</collab>
        <source>Nature</source>
        <volume>489</volume>
        <fpage>57</fpage>
        <lpage>74</lpage>
        <year>2012</year>
        <pub-id pub-id-type="pmid">22955616</pub-id>
      </element-citation>
    </ref>
    <ref id="R21">
      <label>21</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Pliatsika</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Rigoutsos</surname>
            <given-names>I</given-names>
          </name>
        </person-group>
        <source>Biol Direct</source>
        <volume>10</volume>
        <fpage>4</fpage>
        <year>2015</year>
        <pub-id pub-id-type="pmid">25630343</pub-id>
      </element-citation>
    </ref>
    <ref id="R22">
      <label>22</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Whyte</surname>
            <given-names>WA</given-names>
          </name>
          <etal/>
        </person-group>
        <source>Cell</source>
        <volume>153</volume>
        <fpage>307</fpage>
        <lpage>319</lpage>
        <year>2013</year>
        <pub-id pub-id-type="pmid">23582322</pub-id>
      </element-citation>
    </ref>
    <ref id="R23">
      <label>23</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kozomara</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Griffiths-Jones</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <source>Nucleic acids research</source>
        <volume>39</volume>
        <fpage>D152</fpage>
        <lpage>157</lpage>
        <year>2011</year>
        <pub-id pub-id-type="pmid">21037258</pub-id>
      </element-citation>
    </ref>
    <ref id="R24">
      <label>24</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Harrow</surname>
            <given-names>J</given-names>
          </name>
          <etal/>
        </person-group>
        <source>Genome research</source>
        <volume>22</volume>
        <fpage>1760</fpage>
        <lpage>1774</lpage>
        <year>2012</year>
        <pub-id pub-id-type="pmid">22955987</pub-id>
      </element-citation>
    </ref>
    <ref id="R25">
      <label>25</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lin</surname>
            <given-names>S</given-names>
          </name>
          <etal/>
        </person-group>
        <source>Elife</source>
        <volume>3</volume>
        <fpage>e04766</fpage>
        <year>2014</year>
        <pub-id pub-id-type="pmid">25497837</pub-id>
      </element-citation>
    </ref>
  </ref-list>
</back>
<floats-group>
  <fig id="F1" orientation="portrait" position="float">
    <label>Figure 1</label>
    <caption>
      <title>The GuideScan gRNA design tool</title>
      <p><bold>(a)</bold> Overview of GuideScan. Left, GuideScan takes as input a FASTA file containing any genome of choice. Middle, targetable sequences are defined by choosing the PAM sequence (Cas9’s canonical PAM, red; non-canonical PAM, blue), its position relative to the gRNA, and the length of the gRNA (grey box). Right, targetable sequences are indexed in a retrieval tree (trie), and associated information is stored at leaf nodes. R, trie root. <bold>(b)</bold> Distributions of combined distance of flanking gRNA-pairs to the boundaries of selected noncoding genomic features using GuideScan (blue) or mit.edu genome-wide tracks (red) <bold>(c,d)</bold> Example deletions of genomic regions containing RNA <bold>(c)</bold> and DNA <bold>(d)</bold> noncoding elements using pairs of gRNAs designed by GuideScan. gRNA sequences, blue and red; PAM sequences, bold underlined. For each targeted locus, shown are the predicted sequence post deletion, sequences of three edited alleles, and a representative chromatogram.</p>
    </caption>
    <graphic xlink:href="nihms847627f1"/>
  </fig>
  <fig id="F2" orientation="portrait" position="float">
    <label>Figure 2</label>
    <caption>
      <title>GuideScan correctly enumerates off-target sequences and filters out promiscuous gRNAs</title>
      <p><bold>(a)</bold> Number of murine gRNAs (20mers) designed by each tool for a random sample of protein coding genes, noncoding elements, and repetitive regions. Number of gRNAs with off-targets within at least two mismatches from gRNA (black), within a single mismatch (white), and with perfect off-targets (red). OT, off-target. <bold>(b)</bold> Number of perfect off-target sites for the gRNAs designed by each tool. Each dot represents a gRNA (mean, red line). <bold>(c)</bold> Cumulative distribution of specificity scores for the gRNAs designed by each tool. <bold>(d)</bold> T7 cleavage assay for gRNAs having a single (black, on-target site) or multiple (red, on-target site; blue, perfect off-target site) perfect matches in the genome. Position of the cleavage substrates, filled triangles; position of cleavage products, opened triangles. Estimated total editing (TE) at each site is shown below the corresponding lane. <bold>(e)</bold> Left, schematic representation of the chromosomal locations of three perfect target sites of a gRNA labeled highly specific by competitor tools (mit.edu score = 78). Right, PCR-based identification of chromosomal translocations between all three targets. +, gRNA; − empty plasmid. <bold>(f)</bold> Left, schematic representation of the position of three perfect target sites—all within chromosome 2—of a gRNA labeled highly specific by competitor tools (mit.edu score = 89). Genomic sequence: target sites, red; PAM sequence, bold. Right, PCR-based identification of chromosomal deletions between target sites. Position of the wild-type amplicon, filled triangle; position of deletion amplicons, open triangle. +, gRNA; - empty plasmid. Gels in d-e were cropped from full-length versions shown in <xref rid="SD2" ref-type="supplementary-material">Supplementary Figure 2</xref>.</p>
    </caption>
    <graphic xlink:href="nihms847627f2"/>
  </fig>
</floats-group>
