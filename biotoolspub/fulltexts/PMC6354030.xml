<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.1 20151215//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.1?>
<?ConverterInfo.XSLTName jp2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Gigascience</journal-id>
    <journal-id journal-id-type="iso-abbrev">Gigascience</journal-id>
    <journal-id journal-id-type="publisher-id">gigascience</journal-id>
    <journal-title-group>
      <journal-title>GigaScience</journal-title>
    </journal-title-group>
    <issn pub-type="epub">2047-217X</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">6354030</article-id>
    <article-id pub-id-type="doi">10.1093/gigascience/giy165</article-id>
    <article-id pub-id-type="publisher-id">giy165</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Technical Note</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Libra: scalable <italic>k-</italic>mer–based tool for massive all-vs-all metagenome comparisons</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">http://orcid.org/0000-0002-9705-6355</contrib-id>
        <name>
          <surname>Choi</surname>
          <given-names>Illyoung</given-names>
        </name>
        <xref ref-type="aff" rid="aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">http://orcid.org/0000-0002-4125-7561</contrib-id>
        <name>
          <surname>Ponsero</surname>
          <given-names>Alise J</given-names>
        </name>
        <xref ref-type="aff" rid="aff2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">http://orcid.org/0000-0002-8014-9184</contrib-id>
        <name>
          <surname>Bomhoff</surname>
          <given-names>Matthew</given-names>
        </name>
        <xref ref-type="aff" rid="aff2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">http://orcid.org/0000-0001-9961-144X</contrib-id>
        <name>
          <surname>Youens-Clark</surname>
          <given-names>Ken</given-names>
        </name>
        <xref ref-type="aff" rid="aff2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">http://orcid.org/0000-0002-5557-0604</contrib-id>
        <name>
          <surname>Hartman</surname>
          <given-names>John H</given-names>
        </name>
        <!--<email>jhh@cs.arizona.edu</email>-->
        <xref ref-type="aff" rid="aff1">1</xref>
        <xref ref-type="corresp" rid="cor1"/>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">http://orcid.org/0000-0001-8699-957X</contrib-id>
        <name>
          <surname>Hurwitz</surname>
          <given-names>Bonnie L</given-names>
        </name>
        <!--<email>bhurwitz@email.arizona.edu</email>-->
        <xref ref-type="aff" rid="aff2">2</xref>
        <xref ref-type="aff" rid="aff3">3</xref>
        <xref ref-type="corresp" rid="cor2"/>
      </contrib>
    </contrib-group>
    <aff id="aff1"><label>1</label>Department of Computer Science, University of Arizona, 1040 E. 4th Street, Tucson, Arizona, 85721, USA</aff>
    <aff id="aff2"><label>2</label>Department of Biosystems Engineering, University of Arizona, 1177 E. 4th Street, Tucson, Arizona, 85721, USA</aff>
    <aff id="aff3"><label>3</label>BIO5 Institute, University of Arizona, 1657 E. Helen Street, Tucson, Arizona, 85719, USA</aff>
    <author-notes>
      <corresp id="cor2"><bold>Correspondence address</bold>. 1177 E. 4th Street, Tucson, Arizona, 85721, USA. Bonnie L. Hurwitz, E-mail: <email>bhurwitz@email.arizona.edu</email></corresp>
      <corresp id="cor1"><bold>Correspondence address</bold>. John H. Hartman, E-mail: <email>jhh@cs.arizona.edu</email></corresp>
    </author-notes>
    <pub-date pub-type="epub" iso-8601-date="2018-12-28">
      <day>28</day>
      <month>12</month>
      <year>2018</year>
    </pub-date>
    <pub-date pub-type="collection">
      <month>2</month>
      <year>2019</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>28</day>
      <month>12</month>
      <year>2018</year>
    </pub-date>
    <!-- PMC Release delay is 0 months and 0 days and was based on the <pub-date pub-type="epub"/>. -->
    <volume>8</volume>
    <issue>2</issue>
    <elocation-id>giy165</elocation-id>
    <history>
      <date date-type="accepted">
        <day>17</day>
        <month>12</month>
        <year>2018</year>
      </date>
      <date date-type="rev-recd">
        <day>24</day>
        <month>10</month>
        <year>2018</year>
      </date>
      <date date-type="received">
        <day>24</day>
        <month>8</month>
        <year>2018</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2018. Published by Oxford University Press.</copyright-statement>
      <copyright-year>2018</copyright-year>
      <license license-type="cc-by" xlink:href="http://creativecommons.org/licenses/by/4.0/">
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted reuse, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <self-uri xlink:href="giy165.pdf"/>
    <abstract>
      <title>Abstract</title>
      <sec id="abs1">
        <title>Background</title>
        <p>Shotgun metagenomics provides powerful insights into microbial community biodiversity and function. Yet, inferences from metagenomic studies are often limited by dataset size and complexity and are restricted by the availability and completeness of existing databases. <italic>De novo</italic> comparative metagenomics enables the comparison of metagenomes based on their total genetic content.</p>
      </sec>
      <sec id="abs2">
        <title>Results</title>
        <p>We developed a tool called Libra that performs an all-vs-all comparison of metagenomes for precise clustering based on their <italic>k</italic>-mer content. Libra uses a scalable Hadoop framework for massive metagenome comparisons, Cosine Similarity for calculating the distance using sequence composition and abundance while normalizing for sequencing depth, and a web-based implementation in iMicrobe (<ext-link ext-link-type="uri" xlink:href="http://imicrobe.us">http://imicrobe.us</ext-link>) that uses the CyVerse advanced cyberinfrastructure to promote broad use of the tool by the scientific community.</p>
      </sec>
      <sec id="abs3">
        <title>Conclusions</title>
        <p>A comparison of Libra to equivalent tools using both simulated and real metagenomic datasets, ranging from 80 million to 4.2 billion reads, reveals that methods commonly implemented to reduce compute time for large datasets, such as data reduction, read count normalization, and presence/absence distance metrics, greatly diminish the resolution of large-scale comparative analyses. In contrast, Libra uses all of the reads to calculate <italic>k</italic>-mer abundance in a Hadoop architecture that can scale to any size dataset to enable global-scale analyses and link microbial signatures to biological processes.</p>
      </sec>
    </abstract>
    <kwd-group kwd-group-type="keywords">
      <kwd>metagenomics</kwd>
      <kwd>Hadoop</kwd>
      <kwd><italic>k</italic>-mer</kwd>
      <kwd>distance metrics</kwd>
      <kwd>clustering</kwd>
    </kwd-group>
    <funding-group>
      <award-group award-type="grant">
        <funding-source>
          <named-content content-type="funder-name">National Science Foundation</named-content>
          <named-content content-type="funder-identifier">10.13039.100000001</named-content>
        </funding-source>
        <award-id>1640775</award-id>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <named-content content-type="funder-name">University of Arizona Information Technology Services</named-content>
        </funding-source>
      </award-group>
    </funding-group>
    <counts>
      <page-count count="14"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec sec-type="intro" id="sec1">
    <title>Introduction</title>
    <p>Over the last decade, scientists have generated petabytes of genomic data to uncover the role of microbes in dynamic living systems. Yet, to understand the underlying biological principles that guide the distribution of microbial communities, massive ‘omics datasets need to be compared with environmental factors to find linkages across space and time. One of the greatest challenges in these endeavors has been in documenting and analyzing unexplored genetic diversity in wild microbial communities. For example, fewer than 60% of 40 million non-redundant genes from the Global Ocean Survey and the Tara Oceans Expeditions match known proteins in bacteria [<xref rid="bib1" ref-type="bibr">1</xref>, <xref rid="bib2" ref-type="bibr">2</xref>]. Other microorganisms such as viruses or pico-eukaryotes that are important to ocean ecosystems are even less well defined (e.g., &lt;7% of reads from viromes match known proteins [<xref rid="bib3" ref-type="bibr">3</xref>]). This is largely due to the fact that these organisms are unculturable and reference genomes do not exist in public data repositories. Thus, genome sequences from metagenomic data await better taxonomic and functional definition. Consequently, even advanced tools such as <italic>k</italic>-mer–based classifiers that rapidly assign metagenomic reads to known microbes miss “microbial dark matter” that comprises a significant proportion of metagenomes [<xref rid="bib4" ref-type="bibr">4–6</xref>].</p>
    <sec id="sec1-1">
      <title><italic>De novo</italic> comparative metagenomics offers a path forward</title>
      <p>In order to examine the complete genomic content, metagenomic samples can be compared using their sequence signature (or frequency of <italic>k</italic>-mers) (list of tools available in Supplementary Table S1A). This approach relies on three core tenets of <italic>k-</italic>mer–based analytics: (i) closely related organisms share <italic>k-</italic>mer profiles and cluster together, making taxonomic assignment unnecessary [<xref rid="bib7" ref-type="bibr">7</xref>, <xref rid="bib8" ref-type="bibr">8</xref>]; (ii) <italic>k-</italic>mer frequency is correlated with the abundance of an organism [<xref rid="bib9" ref-type="bibr">9</xref>]; and (iii) <italic>k-</italic>mers of sufficient length can be used to distinguish specific organisms [<xref rid="bib10" ref-type="bibr">10</xref>]. In 2012, the Compareads [<xref rid="bib11" ref-type="bibr">11</xref>] method was proposed, followed by Commet [<xref rid="bib12" ref-type="bibr">12</xref>]. Both of these tools compute the number of shared reads between metagenomes using a <italic>k-</italic>mer–based read similarity measure. The number of shared reads between datasets is then used to compute a Jaccard distance between samples.</p>
      <p>Given the computational intensity of all-vs-all sequence analysis, several other methods have been employed to reduce the dimensionality of metagenomes and speed up analyses by creating unique <italic>k-</italic>mer sets and computing the genetic distance between pairs of metagenomes, such as MetaFast [<xref rid="bib13" ref-type="bibr">13</xref>] and Mash [<xref rid="bib14" ref-type="bibr">14</xref>]. The fastest of these methods, Mash [<xref rid="bib15" ref-type="bibr">15</xref>], indexes samples by unique <italic>k-</italic>mers to create size-reduced sketches and compares these sketches using the MinHash algorithm [<xref rid="bib16" ref-type="bibr">16</xref>] for computing a genetic distance using Jaccard similarity. Yet, the tradeoff for speed is that samples are reduced to a subset of unique <italic>k-</italic>mers (1 k by default) that may lead to an unrepresentative <italic>k-</italic>mer profile of the samples. Further, given that Mash uses Jaccard similarity, only the genetic distance between samples is accounted for (or genetic content in microbial communities) without considering abundance (dominant vs rare organisms in the sample), which is central to microbial ecology and ecosystem processes [<xref rid="bib17" ref-type="bibr">17</xref>]. Sourmash [<xref rid="bib18" ref-type="bibr">18</xref>], a toolkit for manipulating MinHash sketches, uses the same underlying algorithm and distance metric as Mash and therefore has the same limitations.</p>
      <p>Recently, Simka [<xref rid="bib15" ref-type="bibr">15</xref>] was developed to compute a distance matrix between metagenomes by dividing the input datasets into abundance vectors from subsets of <italic>k-</italic>mers, then rejoining the resulting abundances in a cumulative distance matrix. The methodology can be parallelized to execute the analyses on a high-performance computing cluster (HPC). Simka also provides various ecological distance metrics to let the user choose the metric most relevant to their analysis. However, the computational time varies based on the distance metric, where some distances scale linearly and other distances metrics, such as Jensen-Shannon, scale quadratically as additional samples are added [<xref rid="bib15" ref-type="bibr">15</xref>]. Moreover, Simka normalizes datasets in an all-vs-all comparison by reducing the depth of sequencing for all samples to the least common denominator, therefore, decreasing the resolution of the datasets. Lastly, computing <italic>k-</italic>mer analytics using HPC is subject to reduced fault tolerance for massive datasets. A framework to compare one metagenome to a set of metagenomes on a high-performance computing system called DSM [<xref rid="bib19" ref-type="bibr">19</xref>] has also been proposed; however, this tool is limited to retrieval tasks and does not provide an all-vs-all sequence analysis.</p>
    </sec>
    <sec id="sec1-2">
      <title>Scaling sequence analysis using big data analytics via Hadoop</title>
      <p>Hadoop is an attractive platform for performing large-scale sequence analysis because it provides a distributed file system and distributed computation for analyzing massive amounts of data. Hadoop clusters are comprised of commodity servers so that the processing power increases as more computing resources are added. Hadoop also offers a high-level programming abstraction, called MapReduce [<xref rid="bib20" ref-type="bibr">20</xref>], that greatly simplifies the implementation of new analytical tools and a high-performance distributed file system (HDFS) for storing datasets. Programmers do not need specialized training in distributed systems and networking to implement distributed programs using MapReduce. Hadoop also provides fault-tolerance by default. When a Hadoop node fails, Hadoop reassigns the failed node's tasks to another node containing a redundant copy of the data those tasks were processing. This differs from HPC where schedulers track failed nodes and either restart the failed computation from the most recent checkpoint or from the beginning if checkpointing was not used. Thus, using a Hadoop infrastructure ensures that computations and data are protected even in the event of hardware failures. These benefits have led to new analytic tools based on Hadoop, making Hadoop a <italic>de facto</italic> standard in large-scale data analysis. In metagenomics, the development of efficient and inexpensive high-throughput sequencing technologies has led to a rapid increase in the amount of sequence data for studying microbes in diverse environments. However, to date, only Hadoop-enabled genomic or <italic>k-</italic>mer counting tools exist, and no comparative metagenomics tools are available (Supplementary Table S1B).</p>
    </sec>
    <sec id="sec1-3">
      <title>Existing big data algorithms compare reads to limited genomic reference data</title>
      <p>Recent progress has been made in translating bioinformatics algorithms to big data architectures to overcome scalability issues. Thus far, these algorithms compare large-scale next-generation sequence (NGS) datasets to reference genomic datasets and replace computationally intensive algorithms such as sequence alignment [<xref rid="bib21" ref-type="bibr">21</xref>], genetic variant detection [<xref rid="bib22" ref-type="bibr">22</xref>, <xref rid="bib23" ref-type="bibr">23</xref>], ortholog detection [<xref rid="bib24" ref-type="bibr">24</xref>], differential gene expression [<xref rid="bib25" ref-type="bibr">25</xref>, <xref rid="bib26" ref-type="bibr">26</xref>], or short-read mapping [<xref rid="bib27" ref-type="bibr">27–30</xref>] (Supplementary Table S1B). For example, BlastReduce and CloudBurst are parallel sequence mapping tools based on Hadoop MapReduce [<xref rid="bib28" ref-type="bibr">28</xref>, <xref rid="bib29" ref-type="bibr">29</xref>]. These tools, however, implement a query-to-a-reference approach that is inefficient for all-vs-all analyses of reads from metagenomes. Other algorithms such as BioPig [<xref rid="bib31" ref-type="bibr">31</xref>] and Bloomfish [<xref rid="bib32" ref-type="bibr">32</xref>] generate an index of sequence data for later partial sequence search and <italic>k-</italic>mer counting using Hadoop [<xref rid="bib33" ref-type="bibr">33</xref>] (Supplementary Table S1B). Also, some of these tools adopt traditional sequence indexing techniques such as a suffix array that is inefficient in reading and indexing data in HDFS, thus reducing performance. Moreover, neither tool offers an end-to-end solution for comparing metagenomes consisting of data distribution on a Hadoop cluster, <italic>k-</italic>mer indexing and counting, distance matrix computation, and visualization. Finally, none of these tools are enabled in an advanced cyberinfrastructure where users can compute analyses in a simple web-based platform (Supplementary Table S1B).</p>
    </sec>
    <sec id="sec1-4">
      <title>Libra: a tool for scalable all-vs-all sequence analysis in an advanced cyberinfrastructure</title>
      <p>Here, we describe a scalable algorithm called Libra that is capable of performing all-vs-all sequence analysis using Hadoop MapReduce (SciCrunch.org tool reference ID SCR_016608). We demonstrate for the first time that Hadoop MapReduce can be applied to all-vs-all sequence comparisons of large-scale metagenomic datasets comprised of mixed microbial communities. We demonstrate that Cosine Similarity, which is widely used in document clustering and information retrieval, is a good distance metric for comparing datasets to consider genetic distance and microbial abundance simultaneously, along with widely accepted distance metrics in biology such as Bray-Curtis [<xref rid="bib34" ref-type="bibr">34</xref>] and Jensen-Shannon [<xref rid="bib35" ref-type="bibr">35</xref>]. We validate this distance metric using simulated metagenomes (from both short- and long-read technologies) to show that Libra has exceptional sensitivity in distinguishing complex mixed microbiomes. Next, we show Libra's ability to distinguish metagenomes by both community composition and abundance using 48 samples (16S rRNA and whole-genome shotgun sequencing [WGS]) from the Human Microbiome Project (HMP) and the simulated Critical Assessment of Metagenome Interpretation (CAMI) “toy” Pacific Biosciences (PacBio) dataset across diverse body sites and compare the results to Mash and Simka. Finally, we show that Libra can scale to massive global-scale datasets by examining viral diversity in 43 Tara Ocean Viromes (TOVs) from the 2009–2011 Expedition [<xref rid="bib36" ref-type="bibr">36</xref>] that represent 26 sites containing about 4.2 billion reads. We show for the first time that viral communities in the ocean are similar across temperature gradients, irrespective of their location in the ocean. The resulting data demonstrate that Libra provides accurate, efficient, and scalable computation for comparative metagenomics that can be used to discern global patterns in microbial ecology.</p>
      <p>To promote the broad use of the Libra algorithm, we developed a web-based tool in iMicrobe [<xref rid="bib37" ref-type="bibr">37</xref>] where users can run Libra using data in their free CyVerse [<xref rid="bib38" ref-type="bibr">38</xref>, <xref rid="bib39" ref-type="bibr">39</xref>] account or use datasets that are integrated into the iMicrobe Data Commons. These analyses are fundamental for determining relationships among diverse metagenomes to inform follow-up analyses on microbial-driven biological processes.</p>
    </sec>
  </sec>
  <sec id="sec2">
    <title>Data Description</title>
    <sec id="sec2-1">
      <title>Staggered mock community</title>
      <p>We performed metagenomic shotgun sequencing on a staggered mock community obtained from the Human Microbiome Consortium (HM-277D). The staggered mock community is comprised of genomic DNA from genera commonly found on or within the human body, consisting of 1,000 to 1,000,000,000 16S rRNA gene copies per organism per aliquot. The resulting DNA was subjected to whole-genome sequencing as follows. Mixtures were diluted to a final concentration of 1 ng/µL and used to generate whole genome sequencing libraries with the Ion Xpress Plug Fragment Library Kit and manual #MAN0009847, revC (Thermo Fisher Scientific, Waltham, MA). Briefly, 10 ng of bacterial DNA was sheared using the Ion Shear enzymatic reaction for 12 minutes and Ion Xpress bar code adapters ligated following end repair. Following bar code ligation, libraries were amplified using the manufacturer's supplied Library Amplification primers and recommended conditions. Amplified libraries were size-selected to ∼200 base pairs using the Invitrogen E-gel Size Select Agarose cassettes as outlined in the Ion Xpress manual and quantitated with the Ion Universal Library quantitation kit. Equimolar amounts of the library were added to an Ion PI Template OT2 200 kit V3. The resulting templated beads were enriched with the Ion OneTouch ES system and quantitated with the Qubit Ion Sphere Quality Control kit (Life Technologies) on a Qubit 3.0 fluorometer (Qubit, New York). Enriched templated beads were loaded onto an Ion PI V2 chip and sequenced according to the manufacturer's protocol using the Ion PI Sequencing 200 kit V3 on an Ion Torrent Proton sequencer. The sequence data, comprised of ∼80 million reads, have been deposited into the National Center for Biotechnology Information Sequence Read Archive under accession SRP115095 under project accession PRJNA397434.</p>
    </sec>
    <sec id="sec2-2">
      <title>Simulated data derived from the staggered mock community</title>
      <p>The resulting sequence data from the staggered mock community (∼80 million reads) were used to develop simulated metagenomes to test the effects of varying read depth and of the composition and abundance of organisms in mixed metagenomes [<xref rid="bib40" ref-type="bibr">40</xref>]. To examine read depth (in terms of raw read counts and file size), we used the known staggered mock community abundance profile to generate a simulated metagenome using GemSim [<xref rid="bib41" ref-type="bibr">41</xref>] of 2 million reads (454 sequencing) and duplicated the dataset 2x, 5x, and 10x. We also simulated the effects of sequencing a metagenome more deeply using GemSim [<xref rid="bib41" ref-type="bibr">41</xref>] to generate simulated metagenomes with 0.5, 1, 5, and 10 million reads based on the relative abundance of organisms in the staggered mock community. Next, we developed four simulated metagenomes to test the effect of changing the dominant organism abundance and genetic composition, including 10 million reads from the staggered mock community (mock 1), the mock community with alterations in a few abundant species (mock 2), the mock community with many alterations in abundant species (mock 3), and mock 3 with additional sequences from archaea to further alter the genetic composition (mock 4) as described in Supplementary Table S2. The same community profiles were used to generate paired-end Illumina dataset (100 million reads), using GemSim (Illumina v4 error model). Finally, using SimLord [<xref rid="bib42" ref-type="bibr">42</xref>], the community profiles were used to generate simulated third-generation sequencing datasets (PacBio single-molecule real-time sequencing, 1 million reads). SimLord default parameters were used to generate those simulated datasets. All simulated datasets are available in iMicrobe [<xref rid="bib37" ref-type="bibr">37</xref>] under project 265 and under DOI [<xref rid="bib40" ref-type="bibr">40</xref>].</p>
    </sec>
    <sec id="sec2-3">
      <title>Human microbiome 16S rRNA gene amplicons and WGS reads</title>
      <p>Human microbiome datasets were downloaded from the National Institutes of Health Human Microbiome Project [<xref rid="bib43" ref-type="bibr">43</xref>] including 48 samples from 5 body sites including urogenital (posterior fornix), gastrointestinal (stool), oral (buccal mucosa, supragingival plaque, tongue dorsum), airways (anterior nares), and skin (retroauricular crease left and right) (See Supplementary Table S3). Matched datasets consisting of 16S rRNA reads WGS reads, and WGS assembled contigs were downloaded from the 16S trimmed dataset and the HMIWGS/HMASM dataset, respectively. For the WGS reads dataset, the analysis was run on the paired 1 read file.</p>
    </sec>
    <sec id="sec2-4">
      <title>Tara ocean viromes</title>
      <p>TOVs were downloaded from European Nucleotide Archive at the European Molecular Biology Laboratory (EMBL) and consisted of 43 viromes from 43 samples at 26 locations across the world's oceans collected during the Tara Oceans (2009–2012) scientific expedition (Supplementary Table S4) [<xref rid="bib36" ref-type="bibr">36</xref>]. Metadata for the samples were downloaded from PANGAEA [<xref rid="bib44" ref-type="bibr">44</xref>]. These samples were derived from multiple depths including 16 surface samples (5–6 meters), 18 deep chlorophyll maximum (DCM) samples (17–148 meters), and 1 mesopelagic sample (791 meters). Quality-control procedures were applied according to the methods described by Brum and colleagues [<xref rid="bib36" ref-type="bibr">36</xref>].</p>
    </sec>
    <sec id="sec2-5">
      <title>CAMI human microbiome project toy dataset</title>
      <p>The HMP toy dataset from the CAMI 2nd Challenge was downloaded from their website [<xref rid="bib45" ref-type="bibr">45</xref>]. This dataset is composed of 49 simulated PacBio reads from five different body sites of the human host, namely, gastrointestinal tract, oral cavity, airways, skin, and urogenital tract.</p>
    </sec>
  </sec>
  <sec id="sec3">
    <title>Results and Discussion</title>
    <sec id="sec3-1">
      <title>Libra computational strategy</title>
      <p>Libra uses Hadoop MapReduce to perform massive all-vs-all sequence comparisons between next-generation sequence datasets. Libra uses a scalable algorithm and efficient resource usage to make all-vs-all comparisons feasible on large datasets. Hadoop allows parallel computation over distributed computing resources via its simple programming interface called <italic>MapReduce</italic>, while hiding much of the complexity of distributed computing (e.g., node failures) for robust fault-tolerant computation. Taking advantage of Hadoop, Libra can scale to larger input datasets and more computing resources. Furthermore, many cloud providers such as Amazon and Google offer Hadoop clusters on a pay-as-you-go basis, allowing scientists to scale their Libra computations to match their datasets and budgets.</p>
      <p>Libra is implemented using three different MapReduce jobs: (1) <italic>k-</italic>mer histogram construction, (2) inverted index construction, and (3) distance matrix computation. Figure <xref ref-type="fig" rid="fig1">1</xref> shows a workflow of the Libra algorithm.</p>
      <fig id="fig1" orientation="portrait" position="float">
        <label>Figure 1:</label>
        <caption>
          <p>The Libra workflow. Libra consists of three MapReduce jobs (yellow boxes): (1) Libra constructs a <italic>k-</italic>mer histogram of the input samples for load-balancing. The <italic>k-</italic>mer histogram of the input samples is computed in parallel by running multiple Map tasks and a Reduce task that combines their results. (2) Libra constructs the inverted index in parallel. In the Map phase, a separate Map task is spawned for every data block in the input sample files. Each Map task generates <italic>k-</italic>mers from the sequences stored in a data block then passes them to the Reduce tasks. Each Reduce task then counts <italic>k-</italic>mers it receives and produces an index chunk. (3) In the distance matrix computation, the work is split by partitioning the <italic>k-</italic>mer space at the beginning of a MapReduce job. The <italic>k-</italic>mer histogram files for input samples are loaded, and the <italic>k-</italic>mer space is partitioned according to the <italic>k-</italic>mer distributions. A separate Map task is spawned for each partition to perform the computation in parallel and merged to produce the complete distance matrix.</p>
        </caption>
        <graphic xlink:href="giy165fig1"/>
      </fig>
    </sec>
    <sec id="sec3-2">
      <title>Libra distance computation</title>
      <p>Jaccard and Bray-Curtis distance have been extensively used to compare metagenomes based on their sequence signature [<xref rid="bib13" ref-type="bibr">13–15</xref>]. While Mash only computes the Jaccard distance between samples, Simka and Libra implement several classic ecology distances, allowing the user to choose the best-suited distance for the considered dataset [<xref rid="bib15" ref-type="bibr">15</xref>]. Libra provides three distance metrics—Cosine Similarity, Bray-Curtis, and Jensen-Shannon. Here, we demonstrate Cosine Similarity as the default distance metric. This distance uses a vector space model to compute the distance between two NGS samples based on their <italic>k-</italic>mer composition and abundance, while simultaneously normalizing for sequencing depth. Cosine Similarity is widely used in document clustering and information retrieval. This distance metric was previously used to evaluate the accuracy of methods to reconstruct genomes from “virtual metagenomes” derived from 16S rRNA data based on shared Kyoto Encyclopedia of Genes and Genomes orthologous gene counts [<xref rid="bib46" ref-type="bibr">46</xref>] but has not been applied in analyzing sequence signatures between metagenomes. Libra users can also weight <italic>k-</italic>mers based on their abundance (using Boolean weighting, natural weighting, and logarithmic weighting) to account for differences in microbial community composition and sequencing effort as detailed below.</p>
    </sec>
    <sec id="sec3-3">
      <title>Cosine Similarity allows for an accurate and normalized comparison of metagenomes</title>
      <p>We explored the effects of varying (1) the size of the datasets, (2) depth of sequencing, (3) the abundance of dominant microbes in the community, and (4) genetic composition of the community by adding in an entirely new organism (in our case, we added archaea). We constructed simulated metagenomes and compared Libra's distance based on the Cosine Similarity against those from Mash and Simka. Simulated datasets were derived from genomic DNA from a staggered mock community of bacteria obtained from the Human Microbiome Consortium and sequenced deeply using the Ion Torrent sequencing platform (80 million reads; see the Methods section).</p>
      <p>First, we examined the effect of the size of the dataset by using GemSim [<xref rid="bib41" ref-type="bibr">41</xref>] to obtain a simulated metagenome composed of 1 million reads (454 sequencing) from the mock community and duplicated that dataset 2x and 10x. Overall, we found that altering the size of the metagenome (by duplicating the data) had no effect on the distance between metagenomes for Mash, Simka, or Libra. In each case, the distance of the duplicated datasets to the 1x mock community was less than 0.0001 (data not shown).</p>
      <p>Because metagenomes do not scale exactly with size and instead have an increasing representation of low-abundance organisms, we created a second simulated dataset from the mock community using GemSim [<xref rid="bib41" ref-type="bibr">41</xref>] 0.5, 1, 5, and 10 million reads (454 sequencing) to mimic the effect of reducing the sequencing. Given the abundance of organisms in the mock community, the 0.5 M read dataset is mainly comprised of dominant species. Because Simka normalizes all samples to the lowest read count, no changes between samples were measurable when using Jaccard and Bray-Curtis distances (Fig. <xref ref-type="fig" rid="fig2">2A</xref>). In contrast, Mash and Libra (natural weighting) take into account all of the reads in the metagenomes; therefore, they measure a larger difference when you compare the smallest (0.5 M read sample) and largest (10 million read sample). These results suggest that Libra (natural weighting) and Mash are appropriate for comparing datasets at different sequencing depths, whereas using Simka could lead to undesired effects.</p>
      <fig id="fig2" orientation="portrait" position="float">
        <label>Figure 2:</label>
        <caption>
          <p>Analysis of simulated metagenomes using Mash, Simka, and Libra. <bold>(A)</bold> Distance to staggered mock community simulated metagenome composed of 10 million reads (mock 1 10 M), for simulated metagenomes of same community sequenced at various depth. Simulated metagenomes (454 sequencing) were obtained using GemSim and the known abundance profile of the staggered mock community (see Supplementary Table S2). In order to mimic various sequencing depths, the simulated metagenomes were generated at 0.5, 1, 5, or 10 million reads (noted mock 1 0.5 M; mock 1 1 M; mock 1 5 M; mock 1V2 10 M). The distances between the four simulated metagenomes and a 10 million read simulated metagenome (mock 1 10 M) was computed using Mash, Simka (Jaccard and Bray-Curtis distance), and Libra (natural weighting). <bold>(B)</bold> Distance to staggered mock community simulated metagenome (mock 1) for simulated metagenomes from increasingly distant communities. The mock 1 relies on the known abundance profile from the staggered mock community. The mock 2 community profile was obtained by randomly inverting three species abundance from mock 1 profile. The mock 3 profile was obtained by randomly inverting two species abundances from mock 2 profile. Finally, a mock 4 profile was obtained by adding high-abundance archeal genomes not present in any the other mock communities. Simulated metagenomes (454 sequencing) were generated using GemSim at 10 million reads. The distance between the mock 1 community to mock 2, mock 3, mock 4, and a replicate community (mock 1 V2) was computed using Mash, Simka (Jaccard and Bray-Curtis distance), and Libra (cosine distance, natural, and logarithmic weighting).</p>
        </caption>
        <graphic xlink:href="giy165fig2"/>
      </fig>
      <p>In addition to natural variation in population-level abundances, artifacts from sequencing can result in high-abundance <italic>k-</italic>mers. Libra allows users to select the optimal methodology for weighting high-abundance <italic>k-</italic>mers in their datasets including Boolean, natural, and logarithmic. These options for weighting <italic>k-</italic>mers are important for different biological scenarios as described below and shown in simulated datasets. To examine the effect of weighting, we compared and contrasted the natural and logarithmic weight in Libra with other distances obtained from Mash and Simka (Jaccard and Bray-Curtis). We also examined the effect of adding an entirely new species by spiking a simulated dataset with sequences derived from archaea (that were not present in the mock community). The simulated datasets (454 technology) were comprised of the staggered mock community (mock 1), the mock community with alterations in a few abundant species (mock 2), the mock community with many alterations in abundant species (mock 3), and mock 3 with additional sequences from archaea to alter the genetic composition of the community (mock 4) (see Supplementary Table S2). The resulting data showed that Libra (logarithmic weighting) shows a stepwise increase in distance among the mock communities (Fig. <xref ref-type="fig" rid="fig2">2B</xref>). This suggests that logarithmic weighting in Libra allows for a comparison of distantly related microbial communities. Mash also shows a stepwise distance between communities but is compressed relative to Libra, making differences less distinct. Simka (Bray-Curtis and Jaccard) and Libra (cosine distance, natural weighting) reach the maximum difference between mock communities 3 and 4 (Fig. <xref ref-type="fig" rid="fig2">2B</xref>). This indicates that these distances are more appropriate when comparing metagenomes with small fluctuations in the community (e.g., data from a time-series analysis), whereas Libra (cosine distance, logarithmic weighting) can be used to distinguish metagenomes that vary in both genetic composition and abundance over a wide range of species diversity by dampening the effect of high-abundance <italic>k-</italic>mers. Because of this important difference, we used the cosine distance with the logarithmic weighting in all subsequent analyses. Further, we also found that cosine distance provides the fastest computation among all distance metrics (see the Methods section). We confirmed these findings using Illumina simulated datasets (Supplementary Fig. S1A) to show that these results are consistent across short-read technologies.</p>
      <p>Given the availability of long-read (∼10K) sequencing technologies such as Oxford Nanopore and PacBio sequencing, we repeated the above analyses on simulated long-read data (Supplementary Fig. S1B). We show that simulated PacBio long-read data for the mock community derived from SimLoRD [<xref rid="bib42" ref-type="bibr">42</xref>] shows a similar stepwise distance pattern between each of the mock communities (Supplementary Fig. S1B) but has a higher overall distance between mock 1 and each of the mock communities (mock 2<xref ref-type="bibr" rid="bib13">–</xref>4), likely due to the high simulated random error rate compared to simulated short-read data.</p>
    </sec>
    <sec id="sec3-4">
      <title>Libra accurately profiles differences in bacterial diversity and abundance in amplicon and WGS datasets from the human microbiome</title>
      <p>Microbial diversity is traditionally assessed using two methods: the 16S rRNA gene to classify bacterial and archaeal groups at the genus to species level or WGS for finer taxonomic classification at the species or subspecies level. Further, WGS datasets provide additional information on functional differences between metagenomes. Here, we compare and contrast the effect of different algorithmic approaches (Mash vs Libra vs Simka), distance metric (Libra vs Simka), data type (16S rRNA vs WGS), and sequence type (WGS reads vs assembled contigs) in analyzing data from 48 samples across eight body sites from the HMP. Specifically, we examine matched datasets (16S rRNA reads, WGS reads, and WGS assembled contigs) classified as urogenital (posterior fornix), gastrointestinal (stool), oral (buccal mucosa, supragingival plaque, tongue dorsum), airways (anterior nares), and skin (retroauricular crease left and right) (See Supplementary Table S2).</p>
      <p>Because the HMP datasets represent microbial communities, abundant bacteria will have more total read counts than rare bacteria in the samples. Thus, each sample can vary by both taxonomic composition (the genetic content of taxa in a sample) and abundance (the relative proportion of those taxa in the samples). Importantly, the 16S rRNA amplicon dataset is useful in showing how well each algorithm performs in detecting and quantifying small-scale variation for single a gene at the genus level, whereas the WGS dataset demonstrates the effect of including the complete genetic content and abundance of organisms at the species level in a community [<xref rid="bib47" ref-type="bibr">47</xref>]. Also, we examine differences in each algorithm when read abundance is excluded using assembled contigs that only represent the genetic composition of the community.</p>
      <p>Using the 16S rRNA reads, both Mash and Libra clustered samples by broad categories but not individual body sites (Fig. <xref ref-type="fig" rid="fig3">3A</xref> and 3B). Similar to what has been described in previous work [<xref rid="bib15" ref-type="bibr">15</xref>], samples from the airways and skin co-cluster, whereas other categories, including urogenital, gastrointestinal, and oral, are distinct [<xref rid="bib15" ref-type="bibr">15</xref>]. These results indicate that limited variation in the 16S rRNA gene may only allow for clustering for broad categories. Further, the Mash algorithm shows lower overall resolution (Fig. <xref ref-type="fig" rid="fig3">3A</xref>) compared to Libra (Fig. <xref ref-type="fig" rid="fig3">3B</xref>). Indeed, amplicon sequencing analysis is not an original intended use of Mash, given that it reduces the dimensionality of the data by looking at presence/absence of unique <italic>k-</italic>mers, whereas Libra examines the complete dataset accounting for both the genetic composition of organisms and their abundance. In contrast, Simka (Jaccard-ab and Bray-Curtis) fails to cluster samples by broad categories; some skin samples are found associated with stool and fornix samples (Fig. <xref ref-type="fig" rid="fig3">3C</xref> and 3D). Moreover, Simka Jaccard-ab fails to cluster the mouth samples together (Fig. <xref ref-type="fig" rid="fig3">3C</xref>). This result suggests that applying Simka and these well-used distance metrics are not appropriate for these datasets.</p>
      <fig id="fig3" orientation="portrait" position="float">
        <label>Figure 3:</label>
        <caption>
          <p>Clustering of HMP 16S rRNA datasets using Mash, Libra, and Simka. A total of 48 human metagenomic samples from the HMP clustered by Mash <bold>(A)</bold>, Libra <bold>(B)</bold>, or Simka using Jaccard-ab <bold>(C)</bold> and Bray-Curtis distances <bold>(D)</bold> from 16S rRNA sequencing runs. The samples were clustered using Ward's method on their distance scores. Mash, Simka, and Libra report distance in the same range (0–1). Heat maps showing the pairwise dissimilarity between samples were therefore scaled between 0 (green) and 1 (red). A key below the heat map colors the samples by body sites.</p>
        </caption>
        <graphic xlink:href="giy165fig3"/>
      </fig>
      <p>When using WGS reads, both Mash and Libra show enhanced clustering by body site (Fig. <xref ref-type="fig" rid="fig4">4A</xref> and <xref ref-type="fig" rid="fig4">B</xref>); however, Mash shows decreased resolution (Fig. <xref ref-type="fig" rid="fig4">4A</xref>) as compared to Libra (Fig. <xref ref-type="fig" rid="fig4">4B</xref>). Again, these differences reflect the effect of using all of the read data (Libra) rather than a subset (Mash). The effect of using all of the read data compared to a subset (when sketching in Mash) has been previously described in Benoit et al. [<xref rid="bib15" ref-type="bibr">15</xref>]. Importantly, the Libra algorithm depends on read abundance that provides increased resolution for interpersonal variation as seen in skin samples (Fig. <xref ref-type="fig" rid="fig4">4B</xref>). Similar to the 16S rRNA datasets, Simka (Jaccard-ab and Bray-Curtis) failed to cluster the samples by body site, where some skin and stool samples cluster with fornix samples (Fig. <xref ref-type="fig" rid="fig4">4C</xref> and 4D). Similarly, Simka Jaccard-ab also fails to cluster the mouth samples together (Fig. <xref ref-type="fig" rid="fig4">4C</xref>). Overall Simka shows an enhanced clustering by body site using WGS data compared to the 16S rRNA data using these distance metrics; however, the clustering is still not accurate. In order to confirm the independence of these results toward the sequencing technology, we performed the same experiment on the <italic>CAMI HMP</italic> “toy dataset” (simulated PacBio long reads) (Supplementary Fig. S2). This analysis shows that each of the tools is able to cluster the samples broadly by body site. However, there are small misclassifications shared across all tools, suggesting that the increased error rate for this technology could have a limited impact on <italic>k-</italic>mer–based analytics.</p>
      <fig id="fig4" orientation="portrait" position="float">
        <label>Figure 4:</label>
        <caption>
          <p>Clustering of WGS samples using Mash, and Libra and Simka. A total of 48 human metagenomic samples from the HMPs clustered by Mash <bold>(A)</bold>, Libra <bold>(B)</bold>, or Simka using Jaccard-ab <bold>(C)</bold> and Bray-Curtis distances <bold>(D)</bold> from WGS runs. The samples were clustered using Ward's method on their distance scores. Heat maps illustrate the pairwise dissimilarity between samples, scaled between 0 (green) and 1 (red). A key below the heat map colors the samples by body site.</p>
        </caption>
        <graphic xlink:href="giy165fig4"/>
      </fig>
      <p>When abundance is taken out of the equation by using assembled contigs (see Supplementary Fig. S3), Mash performs well in clustering distinct body sites, whereas Libra shows discrepancies and less overall resolution. Thus, as designed, Libra requires reads rather than contigs to perform accurately and obtain high-resolution clustering (Fig. <xref ref-type="fig" rid="fig4">4</xref>). Simka (Jaccard-ab and Bray-Curtis) was not able to distinguish any assembled datasets and scored all sample-to-sample distances to the maximum, even considering presence-absence distance metric proposed by Simka (data not shown). This phenomenon may be explained by the normalization method used by Simka, which does not provide enough data to compare the samples when normalized by the smallest number of contigs (in our dataset 69 contigs).</p>
    </sec>
    <sec id="sec3-5">
      <title>Libra allows for ecosystem-scale analysis: clustering theTOVs to unravel global patterns</title>
      <p>To demonstrate the scale and performance of the Libra algorithm, we analyzed 43 TOVs from the 2009–2011 Expedition [<xref rid="bib36" ref-type="bibr">36</xref>] representing 26 sites, 43 samples, and 4.2 billion reads from the global ocean (see the Methods section). Phages (viruses that infect bacteria) are abundant in the ocean [<xref rid="bib48" ref-type="bibr">48</xref>] and can significantly impact environmental processes through host mortality, horizontal gene transfer, and host-gene expression. Yet, how phages change over space and time in the global ocean and with environmental fluxes is just beginning to be explored. The primary challenge is the majority of reads in viromes (often &gt;90%) do not match known proteins or viral genomes [<xref rid="bib3" ref-type="bibr">3</xref>] and no conserved genes like the bacterial 16S rRNA gene exist to differentiate populations. To examine known and unknown viruses simultaneously, viromes are best compared using sequence signatures to identify common viral populations.</p>
      <p>Two approaches exist to cluster viromes based on sequence composition. The first approach uses protein clustering to examine functional diversity in viromes between sites [<xref rid="bib3" ref-type="bibr">3</xref>, <xref rid="bib36" ref-type="bibr">36</xref>, <xref rid="bib49" ref-type="bibr">49</xref>]. Protein clustering, however, depends on accurate assembly and gene finding that can be problematic in fragmented and genetically diverse viromes [<xref rid="bib50" ref-type="bibr">50</xref>]. Further, assemblies from viromes often include only a fraction of the total reads (e.g., only one-third in TOVs [<xref rid="bib36" ref-type="bibr">36</xref>]). To examine global viral diversity in the ocean using all of the reads, we examined TOVs using Libra. The complete pairwise analysis of ∼4.2 billion reads in the TOV dataset [<xref rid="bib36" ref-type="bibr">36</xref>] finished in 18 hours using a 10-node Hadoop cluster (see the Methods section and Supplementary Table S4). Importantly, Libra exhibits remarkable performance in computing the distance matrix, wherein <italic>k-</italic>mer matches for all TOVs completed within 1.5 hours (see Table <xref rid="tbl1" ref-type="table">1</xref>). This step usually represents the largest computational bottleneck for bioinformatics tools that compute pairwise distances between sequence pairs for applications such as hierarchical sequence clustering [<xref rid="bib51" ref-type="bibr">51–54</xref>]. A direct comparison of the runtime of Simka, Mash, and Libra are not possible given that each tool is tuned to a different computational architecture with a different number of servers and total CPU/memory (Mash runs on a single server; Simka runs on an HPC, and Libra on Hadoop).</p>
      <table-wrap id="tbl1" orientation="portrait" position="float">
        <label>Table 1:</label>
        <caption>
          <p>Execution times for the Libra based on the TOV dataset</p>
        </caption>
        <table frame="hsides" rules="groups">
          <thead>
            <tr>
              <th align="left" rowspan="1" colspan="1">Stage</th>
              <th align="left" rowspan="1" colspan="1">Execution time</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td rowspan="1" colspan="1">Preprocessing (<italic>k-</italic>mer histogram construction/Inverted index construction)</td>
              <td rowspan="1" colspan="1">16:32:55</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">Distance matrix computation</td>
              <td rowspan="1" colspan="1">1:24:27</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">Total</td>
              <td rowspan="1" colspan="1">17:57:22</td>
            </tr>
          </tbody>
        </table>
      </table-wrap>
      <p>Overall, we found that viral populations in the ocean are largely structured by temperature in four gradients (Fig. <xref ref-type="fig" rid="fig5">5</xref>) similar to their bacterial hosts [<xref rid="bib2" ref-type="bibr">2</xref>]. Interestingly, samples from different Longhurst provinces but the same temperature gradient cluster together. Also, water samples from the surface and DCM at the same station, cluster more closely together than samples from the same depth at nearby sites (Fig. <xref ref-type="fig" rid="fig5">5</xref>). Also noteworthy, samples that were derived from extremely cold environments (noted as C0 in Fig. <xref ref-type="fig" rid="fig5">5</xref>) lacked similarity to all other samples (at a 30% similarity score), indicating distinctly different viral populations. These samples include a mesotrophic sample that has previously been shown to have distinctly different viral populations than surface ocean samples [<xref rid="bib55" ref-type="bibr">55</xref>]. Taken together, these data indicate that viral populations are structured globally by temperature and at finer resolution by the station (for surface and DCM samples), indicating that micronutrients and local conditions play an important role in defining viral populations.</p>
      <fig id="fig5" orientation="portrait" position="float">
        <label>Figure 5:</label>
        <caption>
          <p>Visualizing the genetic distance among marine viral communities using Libra. Similarities between samples from 43 TOV from the 2009–2012 Tara Oceans Expedition. Lines (edges) between samples represent the similarity and are colored and thickened accordingly. Lines with insignificant similarity (less than 30%) are removed. Each of the sample names is color coded by Longhurst Province. Inner circles show temperature ranges. Sample names show the temperature range, station, and depth as indicated on the legend. The analysis is performed using Libra (k = 20, Logarithmic weighting, and Cosine Similarity).</p>
        </caption>
        <graphic xlink:href="giy165fig5"/>
      </fig>
    </sec>
  </sec>
  <sec id="sec4">
    <title>Innovations</title>
    <p>Scientific collaboration is increasingly data driven given large-scale next-generation sequencing datasets. It is now possible to generate, aggregate, archive, and share datasets that are terabytes and even petabytes in size. Scalability of a system is becoming a vital feature that decides the feasibility of massive ‘omic's analyses. In particular, this is important for metagenomics where patterns in global ecology can only be discerned by comparing the sequence signatures of microbial communities from massive ‘omics datasets, given that most microbial genomes have not been defined. Current algorithms to perform these tasks run on local workstations or high-performance computing architectures.</p>
    <p>Hadoop is a well-used framework allowing for scalability. The Hadoop framework was previously used for <italic>k-</italic>mer spectra calculation in prior work (Supplementary Table S1B) [<xref rid="bib31" ref-type="bibr">31</xref>, <xref rid="bib32" ref-type="bibr">32</xref>]. However, these tools do not provide any distance computation between the generated <italic>k-</italic>mer spectra. To our knowledge, Libra is, therefore, the first <italic>k-</italic>mer based <italic>de novo</italic> comparative metagenomic tool that uses a Hadoop framework for scalability and fault tolerance.</p>
    <p><italic>De novo</italic> comparative metagenomic tools rely on the calculation of a distance metric in order to perform a clustering task on the metagenomes. Libra provides several distance metrics on the <italic>k-</italic>mer spectra: two well-used metrics in metagenomics (Bray-Curtis and Jensen distance), as well as a Cosine Similarity metric. Cosine Similarity, although extensively used in computer science, has been rarely implemented in genomic and metagenomic studies [<xref rid="bib46" ref-type="bibr">46</xref>]. To our knowledge, this work is the first to describe the use of the Cosine Similarity metric to cluster metagenomes based on their <italic>k-</italic>mer content.</p>
    <p>Finally, the analysis of large-scale metagenomic analysis requires access to large computing resources. In order to use Libra, the user requires access to a Hadoop framework. To allow for better access to the tool and to computing resources, we provide a web-based implementation tool embedded in the CyVerse advanced cyberinfrastructure through iMicrobe [<xref rid="bib37" ref-type="bibr">37</xref>]. The work described here is the first step in implementing a free cloud-based computing resource for <italic>de novo</italic> comparative metagenomics that can be broadly used by scientists to analyze large-scale shared data resources. Moreover, the code can be ported to any Hadoop cluster (e.g., Wrangler at TACC, Amazon EMR, or private Hadoop clusters). This computing paradigm is consistent with recent efforts to increase the accessibility of big datasets in the cloud, such as the Pan-Cancer Analyses of Whole Genomes Project [<xref rid="bib56" ref-type="bibr">56</xref>].</p>
  </sec>
  <sec sec-type="methods" id="sec5">
    <title>Methods</title>
    <sec id="sec5-1">
      <title>Libra algorithm detailed description</title>
      <sec id="sec5-1-1">
        <title><italic>k-</italic>mer size</title>
        <p>Libra calculates the distances between samples based on their <italic>k-</italic>mer composition. The canonical representation of the <italic>k-</italic>mer is used to reduce the number of stored <italic>k-</italic>mers. Several considerations should be taken into account for choosing the <italic>k-</italic>mer size <italic>k</italic>. Larger values of <italic>k</italic> result in fewer matches due to sequencing errors and fragmentary metagenomic data. However, smaller values of <italic>k</italic> give less information about the sequence similarities. In Libra, <italic>k</italic> is a configurable parameter chosen by the user and is set by default to <italic>k</italic> equal to 21. This value was reported to be at the inflection point where the <italic>k-</italic>mer matches move from random to a representative of the read content and is generally resilient to sequencing error and variation [<xref rid="bib57" ref-type="bibr">57</xref>, <xref rid="bib58" ref-type="bibr">58</xref>].</p>
      </sec>
      <sec id="sec5-1-2">
        <title>Distance matrix computation</title>
        <p>Libra provides three distance metrics—Cosine Similarity, Bray-Curtis, and Jensen-Shannon. Cosine Similarity is the default.</p>
      </sec>
      <sec id="sec5-1-3">
        <title>Cosine Similarity metric</title>
        <p>Libra constructs a vector <inline-formula><tex-math id="M1">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}${v_s}$\end{document}</tex-math></inline-formula> for each sample <italic>s</italic> from the weight of each <italic>k-</italic>mer <italic>k</italic> in the sample (<inline-formula><tex-math id="M2">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}${w_{k.s}}$\end{document}</tex-math></inline-formula>). Each dimension in the vector corresponds to the weight of the corresponding <italic>k-</italic>mer: 
<disp-formula><tex-math id="M3">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}
\begin{equation*}
\ {v_s} = \ \left( {{w_{k1,s}},{w_{k2,s}},{w_{k3,s}}, \ldots ,{w_{kn,s}}} \right)
\end{equation*}
\end{document}</tex-math></disp-formula></p>
        <p>The weight of a <italic>k-</italic>mer in a sample (<inline-formula><tex-math id="M4">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}${w_{ks}}$\end{document}</tex-math></inline-formula>) can be derived from the frequency of the <italic>k-</italic>mer (<inline-formula><tex-math id="M5">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}${f_{ks}}$\end{document}</tex-math></inline-formula>) in several ways. The simplest uses the raw frequency of the <italic>k-</italic>mer (<inline-formula><tex-math id="M6">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$\ {w_{ks}} = \ {f_{ks}}$\end{document}</tex-math></inline-formula>), called <italic>Natural Weighting</italic>. Another uses <italic>Logarithmic Weighting</italic> ( <inline-formula><tex-math id="M7">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}${w_{ks}} = \ 1 + log( {{f_{ks}}} )$\end{document}</tex-math></inline-formula>) to not give too much weight to highly abundant <italic>k-</italic>mers. In this weighting, <inline-formula><tex-math id="M8">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}${w_{ks}}$\end{document}</tex-math></inline-formula> grows logarithmically with the frequency <inline-formula><tex-math id="M9">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}${f_{ks}}$\end{document}</tex-math></inline-formula>, reducing the effect on the distance of highly abundant <italic>k-</italic>mers caused by sequencing artifacts.</p>
        <p>Once their vectors have been constructed, the distance between two samples (<inline-formula><tex-math id="M10">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}${s_1}$\end{document}</tex-math></inline-formula> and <inline-formula><tex-math id="M11">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}${s_2}$\end{document}</tex-math></inline-formula>) is derived using distance metrics. For example, the distance between the two samples using Cosine Similarity is determined as follows: 
<disp-formula><tex-math id="M12">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}
\begin{equation*}
Distance\left( {{s_1},{s_2}} \right)\ = \ 1 - CosineSimilarity\left( {{s_1},{s_2}} \right)
\end{equation*}
\end{document}</tex-math></disp-formula><disp-formula><tex-math id="M13">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}
\begin{equation*}
= \ 1 - cos\left( {{v_{s1}},{v_{s2}}} \right)\ = \ 1 - \ \frac{{{v_{s1}}\ \cdot \ {v_{s2}}}}{{\left| {\left| {{v_{s1}}} \right|} \right|\ \times \ \left| {\left| {{v_{s2}}} \right|} \right|}} = \ 1 - \frac{{{D_{s1,s2}}}}{{{M_{s1}} \times {M_{s2}}}}
\end{equation*}
\end{document}</tex-math></disp-formula></p>
        <p><italic>where</italic>, 
<disp-formula><tex-math id="M14">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}
\begin{equation*}
{D_{s1,s2}} = {v_{s1}}\ \cdot \ {v_{s2}} = \sum\limits_{i \in s1 \cap s2} {{w_{ki,s1}} \times {w_{ki,s2}},} \ 
\end{equation*}
\end{document}</tex-math></disp-formula><disp-formula><tex-math id="M15">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}
\begin{equation*}
{M_s} = \left| {\left| {{v_s}} \right|} \right| = \sqrt {\sum\limits_{i \in s} {{{\left( {{w_{ki,s}}} \right)}^2}} } 
\end{equation*}
\end{document}</tex-math></disp-formula></p>
        <p>In other words, <inline-formula><tex-math id="M16">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}${D_{s1,\ s2}}$\end{document}</tex-math></inline-formula> is the dot product of the vectors <inline-formula><tex-math id="M17">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}${v_{s1}}$\end{document}</tex-math></inline-formula>and <inline-formula><tex-math id="M18">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}${v_{s2}}$\end{document}</tex-math></inline-formula>, and <inline-formula><tex-math id="M19">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}${M_s}$\end{document}</tex-math></inline-formula> is the magnitude (length) of the vector <inline-formula><tex-math id="M20">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}${v_s}$\end{document}</tex-math></inline-formula>. The distance between two NGS samples is the cosine of the angle between their vectors <inline-formula><tex-math id="M21">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}${v_s}$\end{document}</tex-math></inline-formula>; the magnitude of the vector <inline-formula><tex-math id="M22">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}${M_s}$\end{document}</tex-math></inline-formula> is not taken into account in the metric, thereby normalizing samples with different numbers of total base pairs.</p>
      </sec>
    </sec>
    <sec id="sec5-2">
      <title>Inverted index construction</title>
      <p>A naïve implementation would require the storage of one vector with 4<italic><sup>k</sup></italic> dimensions per sample, where <italic>k</italic> is the <italic>k-</italic>mer length. For a <italic>k</italic> of 21, each vector would have more than 1 million dimensions. To reduce the overhead, Libra stores and computes the distance on a single <italic>inverted index</italic> with the <italic>k-</italic>mer frequencies from multiple samples and performs the distance computation on the index directly. The inverted index is indexed by <italic>k-</italic>mer, and each entry is an index record containing a list of pairs, each of which contains a sample identifier and the frequency of the <italic>k-</italic>mer in the sample.
<disp-formula><tex-math id="M23">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}
\begin{eqnarray*}
index\ record &amp;=&amp; k-mer:\lbrace {\left\langle {sample-id,frequency} \right\rangle} , \\
&amp;&amp; {\left\langle {sample-id,frequency} \right\rangle} \ldots \rbrace
\end{eqnarray*}
\end{document}</tex-math></disp-formula></p>
      <p>The records in the index are stored in alphabetical order by <italic>k-</italic>mer, allowing the record for a particular <italic>k-</italic>mer to be found via binary search. The <italic>k-</italic>mer record contains the <italic>k-</italic>mer frequency in each sample, not the weight, to allow for different weighting functions to be applied during distance matrix computation.</p>
    </sec>
    <sec id="sec5-3">
      <title>Sweep line algorithm</title>
      <p>To compute the distance between two samples <inline-formula><tex-math id="M24">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}${S_1}$\end{document}</tex-math></inline-formula> and <inline-formula><tex-math id="M25">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}${S_2}$\end{document}</tex-math></inline-formula>, Libra must compute the three values <inline-formula><tex-math id="M26">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}${D_{s1,\ s2}}$\end{document}</tex-math></inline-formula>, <inline-formula><tex-math id="M27">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}${M_{s1}}$\end{document}</tex-math></inline-formula><italic>, and</italic><inline-formula><tex-math id="M28">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}${M_{s2}}$\end{document}</tex-math></inline-formula>. The values are calculated by scanning through the vectors <inline-formula><tex-math id="M29">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}${v_{s1}}$\end{document}</tex-math></inline-formula> and <inline-formula><tex-math id="M30">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}${v_{s2}}$\end{document}</tex-math></inline-formula> and computing the values. The time for the distance matrix computation is proportional to the number of dimensions (the number of <italic>k-</italic>mers) in the two vectors. In general, computing all-vs-all comparisons on n samples would require <inline-formula><tex-math id="M31">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$n \times \ ( {n - 1} )/2$\end{document}</tex-math></inline-formula> vector scans, which becomes prohibitively expensive as <italic>n</italic> gets large. Libra uses a sweep line algorithm [<xref rid="bib38" ref-type="bibr">38</xref>] to greatly reduce the computational time. The sweep line algorithm only requires a single scan of all vectors to compute the distance of all pairs of samples (see Supplementary Fig. S4). Briefly, Libra sweeps a line through all the vectors simultaneously starting with the first component. Libra outputs a record of the non-zero values of the following format:
<disp-formula><tex-math id="M32">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}
\begin{equation*}
record = k-mer:\left\{ {\left\langle {sample-id,weight} \right\rangle ,\left\langle {sample-id,weight} \right\rangle ,\ \ldots } \right\}
\end{equation*}
\end{document}</tex-math></disp-formula></p>
      <p>Libra then moves the sweep line to the next component and performs the same operation. From the output records, contributions to <inline-formula><tex-math id="M33">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}${M_s}$\end{document}</tex-math></inline-formula> for each sample in the record are computed and accumulated. Contributions to <inline-formula><tex-math id="M34">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$D$\end{document}</tex-math></inline-formula> are also computed from the record by extracting sample pairs. For example, the record {<inline-formula><tex-math id="M35">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$ &lt; {s_1},\ x &gt;,\ &lt; {s_2},\ y &gt;,\ \langle {{s_4},\ z} \rangle $\end{document}</tex-math></inline-formula>} has three sample pairs <inline-formula><tex-math id="M36">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$( {{s_1}{s_2}} ),\ ( {{s_1}{s_4}} )\ and\ ( {{s_2}{s_4}} )$\end{document}</tex-math></inline-formula>. Libra then computes contribution to <inline-formula><tex-math id="M37">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$D$\end{document}</tex-math></inline-formula> for each pair, e.g., <inline-formula><tex-math id="M38">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$x*y$\end{document}</tex-math></inline-formula> is added to <inline-formula><tex-math id="M39">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}${D_{s1,\ s2}}$\end{document}</tex-math></inline-formula>, <inline-formula><tex-math id="M40">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$x*z$\end{document}</tex-math></inline-formula> is added to <inline-formula><tex-math id="M41">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}${D_{s1,\ s4}}$\end{document}</tex-math></inline-formula>, and <inline-formula><tex-math id="M42">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$y*z$\end{document}</tex-math></inline-formula> is added to <inline-formula><tex-math id="M43">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}${D_{s2,\ s4}}$\end{document}</tex-math></inline-formula>. Using this method, Libra computes the distances of every sample pair in an input dataset in linear time. Other distance metrics, such as Bray-Curtis and Jensen-Shannon, can also be computed in the same fashion.</p>
      <p>The sweep algorithm is particularly easy to implement on an inverted index; it consists of simply stepping through the (sorted) <italic>k-</italic>mers. Furthermore, the sweep algorithm is easily parallelized. The <italic>k-</italic>mer space is partitioned and a separate sweep is performed on each partition computing the contributions of its <italic>k-</italic>mer frequencies to the <inline-formula><tex-math id="M44">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$D$\end{document}</tex-math></inline-formula> and <inline-formula><tex-math id="M45">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$M$\end{document}</tex-math></inline-formula> values. At the end of the computation, the intermediate <inline-formula><tex-math id="M46">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$D$\end{document}</tex-math></inline-formula> and <inline-formula><tex-math id="M47">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$M$\end{document}</tex-math></inline-formula> values are combined together to produce the final <inline-formula><tex-math id="M48">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$D$\end{document}</tex-math></inline-formula> and <inline-formula><tex-math id="M49">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$M$\end{document}</tex-math></inline-formula> values and thereby the distance matrix. Each sweep uses binary search to find the first <italic>k-</italic>mer in the partition.</p>
    </sec>
    <sec id="sec5-4">
      <title>Terabyte sort</title>
      <p>Libra groups the samples automatically based on the number and size (by default 4 GB per group). Similar to Terabyte Sort [<xref rid="bib59" ref-type="bibr">59</xref>], the index records are partitioned by <italic>k-</italic>mer ranges and the records in each partition are stored in a separate <italic>chunk file</italic>. All <italic>k-</italic>mers in partition <inline-formula><tex-math id="M50">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$n$\end{document}</tex-math></inline-formula> appear before the <italic>k-</italic>mers in partition<inline-formula><tex-math id="M51">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$n + 1$\end{document}</tex-math></inline-formula> in lexicographic order. This facilitates breaking computation and I/O down into smaller tasks, so that work of creating an index can be distributed across several machines.</p>
    </sec>
    <sec id="sec5-5">
      <title><italic>k-</italic>mer space partitioning</title>
      <p>Both the inverted index construction and the distance matrix computation require partitioning the <italic>k-</italic>mer space so that different partitions can be processed independently. For the partitioning to be effective, the workload should be balanced across the partitions. Simply partitioning into fixed-size partitions based on the <italic>k-</italic>mer space will not ensure balanced workloads, as the <italic>k-</italic>mers do not appear with uniform frequency. Some partitions may have more <italic>k-</italic>mer records than others and thereby incur higher processing costs. Instead, the partitions should be created based on the <italic>k-</italic>mer distribution, so that each partition has roughly the same number of records (see Supplementary Fig. S5).</p>
      <p>Computing the exact <italic>k-</italic>mer distribution across all the samples is too expensive in both space and time; therefore, Libra approximates the distribution instead. A histogram is constructed using the first six letters of the <italic>k-</italic>mers in each sample, which requires much less space and time to compute. In practice, partitioning based on this histogram adequately partitions the <italic>k-</italic>mer space so that the workloads are sufficiently balanced across the partitions.</p>
    </sec>
    <sec id="sec5-6">
      <title>Scalability benchmarking for Libra</title>
      <p>We used synthetic datasets for a scalability benchmark. Each dataset contains 10 billion bytes (approximately 9.3 GB). We used four datasets consisting of 10 (93 GB), 20 (186 GB), 30 (279 GB), and 40 (372 GB) samples in the benchmark. Each experiment was run three times, and an average of the three runs reported (see Supplementary Table S4 for details). The runtime of Libra increased linearly with increased input volume (Fig. <xref ref-type="fig" rid="fig6">6</xref>). This shows that Libra efficiently handles the increased volume of input and efficiently computes distances between all sample pairs while the number of sample pairs increases quadratically.</p>
      <fig id="fig6" orientation="portrait" position="float">
        <label>Figure 6:</label>
        <caption>
          <p>Scalability testing for Libra. Runtimes of Libra on four datasets consisting of 10, 20, 30, and 40 samples (total sizes of 93 GB, 186 GB, 279 GB, and 372 GB, respectively). Libra was performed with default parameters (<italic>k</italic> = 20, Logarithmic weighting, and Cosine Similarity). Runtimes were averaged out over three runs. The total runtime of Libra increased linearly with increased input volume. Both index construction and distance matrix computation showed linearly increased runtimes for the increased input volume. This shows that Libra performs efficiently and scales to input although the number of distances between sample pairs to be computed increases quadratically.</p>
        </caption>
        <graphic xlink:href="giy165fig6"/>
      </fig>
    </sec>
    <sec id="sec5-7">
      <title>Benchmarking runtimes of different distance metrics in Libra</title>
      <p>We used the same synthetic dataset with 40 samples (372 GB in total) in the scalability benchmarking (Fig. <xref ref-type="fig" rid="fig7">7</xref>). We measured the runtimes of Libra for the different distance metrics. Once the index is constructed, all distance metrics are calculated using that index; thus, runtimes of the inverted index construction for the different metrics are the same. Each experiment was run three times and the average reported (see Supplementary Table S4 for details). Differences in runtimes are mainly due to the different computational workloads of distance metrics (Fig. <xref ref-type="fig" rid="fig7">7</xref>). For example, Jensen-Shannon requires more multiplications and divisions in nested loops than Cosine Similarity, incurring more computational workload. Yet, distance matrix computation with Jensen-Shannon took only 12.64% of total runtime.</p>
      <fig id="fig7" orientation="portrait" position="float">
        <label>Figure 7:</label>
        <caption>
          <p>Runtimes for different distance metrics. Runtimes for three different distance metrics (Cosine Similarity, Bray-Curtis, and Jensen-Shannon) in Libra with 40 samples of input (372 GB in total). Libra was performed with default parameters (<italic>k</italic> = 20 and Logarithmic weighting). Runtimes were averaged over three runs. An inverted index was reused for all three distance metrics because the inverted index Libra constructs are independent of the distance metrics. Cosine Similarity took the shortest runtime among the three metrics while Jensen-Shannon took the longest. Jensen-Shannon took almost twice as long as Cosine Similarity because it requires more mathematical computations. Because of its fastest runtime, Cosine Similarity is used by default in Libra.</p>
        </caption>
        <graphic xlink:href="giy165fig7"/>
      </fig>
    </sec>
    <sec id="sec5-8">
      <title>Advanced cyberinfrastructure for Libra in iMicrobe</title>
      <p>To improve access to Libra, we made it available on the iMicrobe website [<xref rid="bib37" ref-type="bibr">37</xref>]. A researcher with a CyVerse account can run Libra on iMicrobe by filling out a simple web form specifying the input files and parameters. Input files are selected from the CyVerse Data Store where they have either been uploaded by the user to their home directory or are part of the iMicrobe Data Commons. When a job is submitted, the user is presented with the status of the job and on completion with the output files and visualization of results. To deploy Libra on iMicrobe, we developed a job dispatch service to automate the execution of Libra on a University of Arizona Hadoop cluster. The service is written in NodeJS and accepts a JSON description of the job inputs and parameters, stages the input files onto the UA Hadoop cluster, executes Libra with the given parameters, and transfers the resulting output files to the user's home directory in the CyVerse Data Store. The service provides a RESTful interface that mimics the Agave API Jobs service and is secured using an Agave OAuth2 token. The source code is available on Github [<xref rid="bib60" ref-type="bibr">60</xref>].</p>
    </sec>
    <sec id="sec5-9">
      <title>Experimental environment description</title>
      <sec id="sec5-9-1">
        <title>Mash and Simka configurations</title>
        <p>Mash v1.1 was run on the metagenomic datasets with the following parameters: -r –s 10000 –m 2 [<xref rid="bib19" ref-type="bibr">19</xref>]. The analysis of assemblies was run without the parameter “-r,” used for short sequences.</p>
        <p>Simka v1.3.2 was run on the metagenomic datasets with the following parameters: -abundance-min 2 -max-reads [MINCOUNT] -simple-dist -complex-dist, where [MINCOUNT] is the smallest sequence count across the analyzed samples.</p>
      </sec>
      <sec id="sec5-9-2">
        <title>Hadoop cluster configuration</title>
        <p>The Libra experiments described here were performed on a Hadoop cluster consisting of 10 physical nodes (9 MapReduce worker nodes). Each node contains 12 CPUs and 128 GB of RAM and is configured to run a maximum of 7 YARN containers simultaneously with 10 GB of RAM per container. The remaining system resources are reserved for the operating system and other Hadoop services such as Hive or HBase.</p>
      </sec>
      <sec id="sec5-9-3">
        <title>The rationale for not porting Libra to Spark</title>
        <p>Spark [<xref rid="bib61" ref-type="bibr">61</xref>] is increasingly popular for scientific data analysis [<xref rid="bib62" ref-type="bibr">62</xref>] because of its outstanding performance provided by fast in-memory processing. Although Libra is currently implemented on Hadoop MapReduce, Libra can be easily ported to Spark because both Hadoop MapReduce and Spark have similar interfaces for data processing and partitioning. For example, resilient distributed datasets (RDD) can be partitioned and distributed over a Spark cluster using Libra's <italic>k-</italic>mer range partitioning. RDDs are memory resident, allowing Spark to significantly improve the performance of Libra's <italic>k-</italic>mer counting and distance matrix computation by avoiding slow disk I/O for intermediate data. We implemented Libra using Hadoop MapReduce because Spark requires much more RAM than Hadoop MapReduce, significantly increasing the cost of the cluster.</p>
      </sec>
    </sec>
  </sec>
  <sec id="sec6">
    <title>Availability of source code and requirements</title>
    <p><bold>Project home page:</bold> Program binary, source code, and documentation for Libra are available in Github [<xref rid="bib63" ref-type="bibr">63</xref>]; Libra web-based App is in iMicrobe [<xref rid="bib37" ref-type="bibr">37</xref>] under Apps; code to implement the Libra web-based App is in Github [<xref rid="bib60" ref-type="bibr">60</xref>].</p>
    <p><bold>Operating system(s):</bold> MapReduce 2.0 (Apache Hadoop 2.3.0 or above).</p>
    <p><bold>Programming language:</bold> Java 7 (or above).</p>
    <p><bold>Other requirements:</bold> None.</p>
    <p><bold>License:</bold> Apache license version 2.0.</p>
    <p><bold>Any restrictions to use by non-academics:</bold> None. Libra has been registered with the SciCrunch database under reference ID: SCR_016608.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material content-type="local-data" id="sup1">
      <label>GIGA-D-18-00324_Original_Submission.pdf</label>
      <media xlink:href="giy165_giga-d-18-00324_original_submission.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="sup2">
      <label>GIGA-D-18-00324_Revision_1.pdf</label>
      <media xlink:href="giy165_giga-d-18-00324_revision_1.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="sup3">
      <label>GIGA-D-18-00324_Revision_2.pdf</label>
      <media xlink:href="giy165_giga-d-18-00324_revision_2.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="sup4">
      <label>Response_to_Reviewer_Comments_Original_Submission.pdf</label>
      <media xlink:href="giy165_response_to_reviewer_comments_original_submission.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="sup5">
      <label>Response_to_Reviewer_Comments_Revision_1.pdf</label>
      <media xlink:href="giy165_response_to_reviewer_comments_revision_1.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="sup6">
      <label>Reviewer_1_Report_Original_Submission -- Jason R. Miller, MS</label>
      <caption>
        <p>9/5/2018 Reviewed</p>
      </caption>
      <media xlink:href="giy165_reviewer_1_report_original_submission.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="sup7">
      <label>Reviewer_1_Report_Revision_1 -- Jason R. Miller, MS</label>
      <caption>
        <p>11/1/2018 Reviewed</p>
      </caption>
      <media xlink:href="giy165_reviewer_1_report_revision_1.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="sup8">
      <label>Reviewer_1_Report_Revision_2 -- Jason R. Miller, MS</label>
      <caption>
        <p>12/5/2018 Reviewed</p>
      </caption>
      <media xlink:href="giy165_reviewer_1_report_revision_2.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="sup9">
      <label>Reviewer_2_Report_Original_Submission -- Jie Ren</label>
      <caption>
        <p>9/12/2018 Reviewed</p>
      </caption>
      <media xlink:href="giy165_reviewer_2_report_original_submission.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="sup10">
      <label>Reviewer_3_Report_Original_Submission -- Rachid Ounit</label>
      <caption>
        <p>9/17/2018 Reviewed</p>
      </caption>
      <media xlink:href="giy165_reviewer_3_report_original_submission.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="sup11">
      <label>Reviewer_3_Report_Revision_1 -- Rachid Ounit</label>
      <caption>
        <p>11/8/2018 Reviewed</p>
      </caption>
      <media xlink:href="giy165_reviewer_3_report_revision_1.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="sup12">
      <label>Reviewer_3_Report_Revision_2 -- Rachid Ounit</label>
      <caption>
        <p>12/5/2018 Reviewed</p>
      </caption>
      <media xlink:href="giy165_reviewer_3_report_revision_2.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="sup13">
      <label>Supplemental Files</label>
      <media xlink:href="giy165_supplemental_files.zip">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <ack>
    <title>ACKNOWLEDGEMENTS</title>
    <p>We thank Binil Benjamin, Russell Lewis, and members of the Hurwitz Lab for comments on the Libra algorithm and feedback on the manuscript. We thank the staff at the University of Arizona Information Technology Services for access and system support for the Hadoop cluster. We thank George Watts for feedback and critical discussions on the manuscript and support for sequencing the mock community.</p>
  </ack>
  <sec sec-type="data-availability" id="sec7">
    <title>Availability of supporting data</title>
    <p>Snapshots of the code and other supporting data are available in the <italic>GigaScience</italic> repository, GigaDB [<xref rid="bib64" ref-type="bibr">64</xref>].</p>
  </sec>
  <sec id="sec8">
    <title>Additional files</title>
    <p>supplemental_Fig1.pdf</p>
    <p>Supplemental Fig2.pdf</p>
    <p>Supplemental Fig3.pdf</p>
    <p>Supplemental Fig4.pdf</p>
    <p>Supplemental Fig5.pdf</p>
    <p>Supplemental Table1 -Comparable_tools.xlsx</p>
    <p>Supplemental Table 2.xlsx</p>
    <p>Supplemental Table 3.xlsx</p>
    <p>Supplemental Table 4.xlsx</p>
    <p>Supplemental Table 5.xlsx</p>
  </sec>
  <sec id="sec9">
    <title>Abbreviations</title>
    <p>CAMI: Critical Assessment of Metagenome Interpretation; DCM: deep chlorophyll maximum; HDFS: high-performance distributed file system; HMP: Human Microbiome Project; HPC: high-performance computing cluster; NGS: next-generation sequence; PacBio: Pacific Biosciences; RDD: resilient distributed dataset; TOV: Tara Ocean Virome; WGS: whole-genome shotgun sequencing.</p>
  </sec>
  <sec id="sec10">
    <title>Competing interests</title>
    <p>The authors declare that they have no competing interests.</p>
  </sec>
  <sec id="sec11" sec-type="funding">
    <title>Funding</title>
    <p>This work was supported by the National Science Foundation award 1640775 to B.L.H. and J.H.H. System support and access for the Hadoop cluster was provided by University of Arizona Information Technology Services. The following reagent was obtained through BEI Resources, National Institute of Allergy and Infectious diseases (NIAID), National Institutes of Health (NIH) as part of the Human Microbiome Project: Genomic DNA from Microbial Mock Community B (Staggered, High Concentration), v5.2H, for Whole Genome Shotgun Sequencing, HM-277D.</p>
  </sec>
  <sec id="sec12">
    <title>Author contributions</title>
    <p>B.L.H., J.H.H., and I.C. conceived of the Libra algorithm and code. I.C. wrote the Libra code. B.L.H., A.J.P., and I.C. planned and carried out the analyses. B.L.H., A.J.P., J.H.H., and I.C. contributed to the interpretation of the results. M.B. and K.Y.C. implemented Libra as an application in iMicrobe. B.L.H., A.J.P., J.H.H., and I.C. wrote the manuscript. All authors provided critical feedback and helped shape the research, analysis, and manuscript.</p>
  </sec>
  <ref-list>
    <title>References</title>
    <ref id="bib1">
      <label>1.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Yooseph</surname><given-names>S</given-names></name>, <name name-style="western"><surname>Sutton</surname><given-names>G</given-names></name>, <name name-style="western"><surname>Rusch</surname><given-names>DB</given-names></name>, <etal/></person-group><article-title>The Sorcerer II Global Ocean Sampling expedition: expanding the universe of protein families</article-title>. <source>PLoS Biol</source>. <year>2007</year>;<volume>5</volume>:<fpage>e16</fpage>.<pub-id pub-id-type="pmid">17355171</pub-id></mixed-citation>
    </ref>
    <ref id="bib2">
      <label>2.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Sunagawa</surname><given-names>S</given-names></name>, , <name name-style="western"><surname>Coelho</surname><given-names>LP</given-names></name>, <name name-style="western"><surname>Chaffron</surname><given-names>S</given-names></name><etal/></person-group><article-title>Structure and function of the global ocean microbiome</article-title>. <source>Science</source>. <year>2015</year>;<volume>348</volume>, <fpage>1261359</fpage><comment><ext-link ext-link-type="uri" xlink:href="http://www.sciencemag.org/content/348/6237/1261359.abstract">http://www.sciencemag.org/content/348/6237/1261359.abstract</ext-link></comment>.<pub-id pub-id-type="pmid">25999513</pub-id></mixed-citation>
    </ref>
    <ref id="bib3">
      <label>3.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Hurwitz</surname><given-names>BL</given-names></name>, <name name-style="western"><surname>Sullivan</surname><given-names>MB</given-names></name></person-group><article-title>The Pacific Ocean Virome (POV): a marine viral metagenomic dataset and associated protein clusters for quantitative viral ecology</article-title>. <source>PLoS One</source>. <year>2013</year>;<volume>8</volume>:<fpage>e57355</fpage>.<pub-id pub-id-type="pmid">23468974</pub-id></mixed-citation>
    </ref>
    <ref id="bib4">
      <label>4.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Marcy</surname><given-names>Y</given-names></name>, <name name-style="western"><surname>Ouverney</surname><given-names>C</given-names></name>, <name name-style="western"><surname>Bik</surname><given-names>EM</given-names></name><etal/></person-group><article-title>Dissecting biological “dark matter” with single-cell genetic analysis of rare and uncultivated TM7 microbes from the human mouth</article-title>. <source>Proc Natl Acad Sci U S A</source>. <year>2007</year>;<volume>104</volume>:<fpage>11889</fpage>–<lpage>94</lpage>.<pub-id pub-id-type="pmid">17620602</pub-id></mixed-citation>
    </ref>
    <ref id="bib5">
      <label>5.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Rinke</surname><given-names>C</given-names></name>, <name name-style="western"><surname>Schwientek</surname><given-names>P</given-names></name>, <name name-style="western"><surname>Sczyrba</surname><given-names>A</given-names></name>, <etal/></person-group><article-title>Insights into the phylogeny and coding potential of microbial dark matter</article-title>. <source>Nature</source>. <year>2013</year>;<volume>499</volume>:<fpage>431</fpage>–<lpage>7</lpage>.<pub-id pub-id-type="pmid">23851394</pub-id></mixed-citation>
    </ref>
    <ref id="bib6">
      <label>6.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Hug</surname><given-names>LA</given-names></name>, <name name-style="western"><surname>Baker</surname><given-names>BJ</given-names></name>, <name name-style="western"><surname>Anantharaman</surname><given-names>K</given-names></name>, <etal/></person-group><article-title>A new view of the tree of life</article-title>. <source>Nat Microbiol</source>.<year>2016</year>;<volume>1</volume>:<fpage>16048</fpage>.<pub-id pub-id-type="pmid">27572647</pub-id></mixed-citation>
    </ref>
    <ref id="bib7">
      <label>7.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Dubinkina</surname><given-names>VB</given-names></name>, <name name-style="western"><surname>Ischenko</surname><given-names>DS</given-names></name>, <name name-style="western"><surname>Ulyantsev</surname><given-names>VI</given-names></name><etal/></person-group><article-title>Assessment of <italic>k-</italic>mer spectrum applicability for metagenomic dissimilarity analysis</article-title>. <source>BMC Bioinformatics</source>. <year>2016</year>;<volume>17</volume>:<fpage>38</fpage>.<pub-id pub-id-type="pmid">26774270</pub-id></mixed-citation>
    </ref>
    <ref id="bib8">
      <label>8.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Teeling</surname><given-names>H</given-names></name>, <name name-style="western"><surname>Waldmann</surname><given-names>J</given-names></name>, <name name-style="western"><surname>Lombardot</surname><given-names>T</given-names></name><etal/></person-group><article-title>TETRA: a web-service and a stand-alone program for the analysis and comparison of tetranucleotide usage patterns in DNA sequences</article-title>. <source>BMC Bioinformatics</source>. <year>2004</year>;<volume>5</volume>:<fpage>163</fpage>.<pub-id pub-id-type="pmid">15507136</pub-id></mixed-citation>
    </ref>
    <ref id="bib9">
      <label>9.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Wu</surname><given-names>Y-W</given-names></name>, <name name-style="western"><surname>Ye</surname><given-names>Y</given-names></name></person-group><article-title>A novel abundance-based algorithm for binning metagenomic sequences using l-tuples</article-title>. <source>J. Comput. Biol</source>. <year>2011</year>;<volume>18</volume>:<fpage>523</fpage>–<lpage>34</lpage>.<pub-id pub-id-type="pmid">21385052</pub-id></mixed-citation>
    </ref>
    <ref id="bib10">
      <label>10.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Fofanov</surname><given-names>Y</given-names></name>, <name name-style="western"><surname>Luo</surname><given-names>Y</given-names></name>, <name name-style="western"><surname>Katili</surname><given-names>C</given-names></name><etal/></person-group><article-title>How independent are the appearances of n-mers in different genomes?</article-title>. <source>Bioinformatics</source>.<year>2004</year>;<volume>20</volume>:<fpage>2421</fpage>–<lpage>8</lpage>.<pub-id pub-id-type="pmid">15087315</pub-id></mixed-citation>
    </ref>
    <ref id="bib11">
      <label>11.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Maillet</surname><given-names>N</given-names></name>, <name name-style="western"><surname>Lemaitre</surname><given-names>C</given-names></name>, <name name-style="western"><surname>Chikhi</surname><given-names>R</given-names></name>, <etal/></person-group><article-title>Compareads: comparing huge metagenomic experiments</article-title>. <source>BMC Bioinformatics</source>. <year>2012</year>;<volume>13</volume>(<issue>Suppl 19</issue>):<fpage>S10</fpage>.</mixed-citation>
    </ref>
    <ref id="bib12">
      <label>12.</label>
      <mixed-citation publication-type="other"><person-group person-group-type="author"><name name-style="western"><surname>Maillet</surname><given-names>N</given-names></name>, <name name-style="western"><surname>Collet</surname><given-names>G</given-names></name>, <name name-style="western"><surname>Vannier</surname><given-names>T</given-names></name>, <etal/></person-group><article-title>Commet: comparing and combining multiple metagenomic datasets</article-title>. <comment>2014 IEEE International Conference on Bioinformatics and Biomedicine (BIBM).</comment><year>2014</year> p. <fpage>94</fpage>–<lpage>8</lpage>.</mixed-citation>
    </ref>
    <ref id="bib13">
      <label>13.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Ulyantsev</surname><given-names>VI</given-names></name>, <name name-style="western"><surname>Kazakov</surname><given-names>SV</given-names></name>, <name name-style="western"><surname>Dubinkina</surname><given-names>VB</given-names></name><etal/></person-group><article-title>MetaFast: fast reference-free graph-based comparison of shotgun metagenomic data</article-title>. <source>Bioinformatics</source>. <year>2016</year>;<volume>32</volume>:<fpage>2760</fpage>–<lpage>7</lpage>.<pub-id pub-id-type="pmid">27259541</pub-id></mixed-citation>
    </ref>
    <ref id="bib14">
      <label>14.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Ondov</surname><given-names>BD</given-names></name>, <name name-style="western"><surname>Treangen</surname><given-names>TJ</given-names></name>, <name name-style="western"><surname>Melsted</surname><given-names>P</given-names></name>, <etal/></person-group><article-title>Mash: fast genome and metagenome distance estimation using MinHash</article-title>. <source>Genome Biol</source>.<year>2016</year>;<volume>17</volume>:<fpage>132</fpage>.<pub-id pub-id-type="pmid">27323842</pub-id></mixed-citation>
    </ref>
    <ref id="bib15">
      <label>15.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Benoit</surname><given-names>G</given-names></name>, <name name-style="western"><surname>Peterlongo</surname><given-names>P</given-names></name>, <name name-style="western"><surname>Mariadassou</surname><given-names>M</given-names></name>, <etal/></person-group><article-title>Multiple comparative metagenomics using multiset <italic>k-</italic>mer counting</article-title>. <source>PeerJ Comput Sci</source>.<year>2016</year>;<volume>2</volume>:<fpage>e94</fpage>.</mixed-citation>
    </ref>
    <ref id="bib16">
      <label>16.</label>
      <mixed-citation publication-type="book"><person-group person-group-type="author"><name name-style="western"><surname>Broder</surname><given-names>AZ</given-names></name></person-group><source>On the resemblance and containment of documents</source>. <comment>Proceedings Compression and Complexity of Sequences 1997 (Cat No97TB100171).</comment><pub-id pub-id-type="doi">10.1109/sequen.1997.666900</pub-id></mixed-citation>
    </ref>
    <ref id="bib17">
      <label>17.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Koslicki</surname><given-names>D</given-names></name>, <name name-style="western"><surname>Zabeti</surname><given-names>H</given-names></name></person-group><article-title>Improving Min Hash via the containment index with applications to metagenomic analysis</article-title>. <source>bioRxiv</source>. <year>2017</year><fpage>184150</fpage>, doi:<pub-id pub-id-type="doi">10.1101/184150</pub-id><comment><ext-link ext-link-type="uri" xlink:href="https://www.biorxiv.org/content/early/2017/09/04/184150.abstract">https://www.biorxiv.org/content/early/2017/09/04/184150.abstract</ext-link></comment>.</mixed-citation>
    </ref>
    <ref id="bib18">
      <label>18.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Brown</surname><given-names>CT</given-names></name>, <name name-style="western"><surname>Irber</surname><given-names>L</given-names></name></person-group><article-title>sourmash: a library for MinHash sketching of DNA</article-title>. <source>The Journal of Open Source Software</source>, <year>2016</year>;<volume>1</volume>, <issue>5</issue>, <fpage>27</fpage>, doi:<pub-id pub-id-type="doi">10.21105/joss.0027</pub-id><comment><ext-link ext-link-type="uri" xlink:href="http://www.theoj.org/joss-papers/joss.00027/10.21105.joss.00027.pdf">http://www.theoj.org/joss-papers/joss.00027/10.21105.joss.00027.pdf</ext-link></comment>.</mixed-citation>
    </ref>
    <ref id="bib19">
      <label>19.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Seth</surname><given-names>S</given-names></name>, <name name-style="western"><surname>Välimäki</surname><given-names>N</given-names></name>, <name name-style="western"><surname>Kaski</surname><given-names>S</given-names></name>, <etal/></person-group><article-title>Exploration and retrieval of whole-metagenome sequencing samples</article-title>. <source>Bioinformatics</source>.<year>2014</year>;<volume>30</volume>:<fpage>2471</fpage>–<lpage>9</lpage>.<pub-id pub-id-type="pmid">24845653</pub-id></mixed-citation>
    </ref>
    <ref id="bib20">
      <label>20.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Dean</surname><given-names>J</given-names></name>, <name name-style="western"><surname>Ghemawat</surname><given-names>S</given-names></name></person-group><article-title>MapReduce: simplified data processing on large clusters</article-title>. <source>Commun. ACM</source>. <comment>New York, NY, USA: ACM</comment>; <year>2008</year>;<volume>51</volume>:<fpage>107</fpage>–<lpage>13</lpage>.</mixed-citation>
    </ref>
    <ref id="bib21">
      <label>21.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Kolker</surname><given-names>N</given-names></name>, <name name-style="western"><surname>Higdon</surname><given-names>R</given-names></name>, <name name-style="western"><surname>Broomall</surname><given-names>W</given-names></name><etal/></person-group><article-title>Classifying proteins into functional groups based on all-versus-all BLAST of 10 million proteins</article-title>. <source>OMICS</source>.<year>2011</year>;<volume>15</volume>:<fpage>513</fpage>–<lpage>21</lpage>.<pub-id pub-id-type="pmid">21809957</pub-id></mixed-citation>
    </ref>
    <ref id="bib22">
      <label>22.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>McKenna</surname><given-names>A</given-names></name>, <name name-style="western"><surname>Hanna</surname><given-names>M</given-names></name>, <name name-style="western"><surname>Banks</surname><given-names>E</given-names></name><etal/></person-group><article-title>The Genome Analysis Toolkit: a MapReduce framework for analyzing next-generation DNA sequencing data</article-title>. <source>Genome Res</source>.<year>2010</year>;<volume>20</volume>:<fpage>1297</fpage>–<lpage>303</lpage>.<pub-id pub-id-type="pmid">20644199</pub-id></mixed-citation>
    </ref>
    <ref id="bib23">
      <label>23.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Langmead</surname><given-names>B</given-names></name>, <name name-style="western"><surname>Schatz</surname><given-names>MC</given-names></name>, <name name-style="western"><surname>Lin</surname><given-names>J</given-names></name>, <etal/></person-group><article-title>Searching for SNPs with cloud computing</article-title>. <source>Genome Biol</source>.<year>2009</year>;<volume>10</volume>:<fpage>R134</fpage>.<pub-id pub-id-type="pmid">19930550</pub-id></mixed-citation>
    </ref>
    <ref id="bib24">
      <label>24.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Wall</surname><given-names>DP</given-names></name>, <name name-style="western"><surname>Kudtarkar</surname><given-names>P</given-names></name>, <name name-style="western"><surname>Fusaro</surname><given-names>VA</given-names></name>, <etal/></person-group><article-title>Cloud computing for comparative genomics</article-title>. <source>BMC Bioinformatics</source>. <year>2010</year>;<volume>11</volume>:<fpage>259</fpage>.<pub-id pub-id-type="pmid">20482786</pub-id></mixed-citation>
    </ref>
    <ref id="bib25">
      <label>25.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Langmead</surname><given-names>B</given-names></name>, <name name-style="western"><surname>Hansen</surname><given-names>KD</given-names></name>, <name name-style="western"><surname>Leek</surname><given-names>JT</given-names></name></person-group><article-title>Cloud-scale RNA-sequencing differential expression analysis with Myrna</article-title>. <source>Genome Biol</source>.<year>2010</year>;<volume>11</volume>:<fpage>R83</fpage>.<pub-id pub-id-type="pmid">20701754</pub-id></mixed-citation>
    </ref>
    <ref id="bib26">
      <label>26.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Jourdren</surname><given-names>L</given-names></name>, <name name-style="western"><surname>Bernard</surname><given-names>M</given-names></name>, <name name-style="western"><surname>Dillies</surname><given-names>M-A</given-names></name>, <etal/></person-group><article-title>Eoulsan: a cloud computing-based framework facilitating high throughput sequencing analyses</article-title>. <source>Bioinformatics</source>.<year>2012</year>;<volume>28</volume>:<fpage>1542</fpage>–<lpage>3</lpage>.<pub-id pub-id-type="pmid">22492314</pub-id></mixed-citation>
    </ref>
    <ref id="bib27">
      <label>27.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Nguyen</surname><given-names>T</given-names></name>, <name name-style="western"><surname>Shi</surname><given-names>W</given-names></name>, <name name-style="western"><surname>Ruden</surname><given-names>D</given-names></name></person-group><article-title>CloudAligner: a fast and full-featured MapReduce based tool for sequence mapping</article-title>. <source>BMC Res Notes</source>.<year>2011</year>;<volume>4</volume>:<fpage>171</fpage>.<pub-id pub-id-type="pmid">21645377</pub-id></mixed-citation>
    </ref>
    <ref id="bib28">
      <label>28.</label>
      <mixed-citation publication-type="book"><person-group person-group-type="author"><name name-style="western"><surname>Schatz</surname><given-names>MC</given-names></name></person-group><source>BlastReduce: high performance short read mapping with MapReduce</source>. <publisher-name>University of Maryland</publisher-name>, ; <year>2008</year>;<comment><ext-link ext-link-type="uri" xlink:href="https://www.cs.umd.edu/sites/default/files/scholarly_papers/MichaelSchatz_1.pdf">https://www.cs.umd.edu/sites/default/files/scholarly_papers/MichaelSchatz_1.pdf</ext-link></comment></mixed-citation>
    </ref>
    <ref id="bib29">
      <label>29.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Schatz</surname><given-names>MC</given-names></name></person-group><article-title>CloudBurst: highly sensitive read mapping with MapReduce</article-title>. <source>Bioinformatics</source>. <comment>Oxford University Press</comment>; <year>2009</year>;<volume>25</volume>:<fpage>1363</fpage>–<lpage>9</lpage>.<pub-id pub-id-type="pmid">19357099</pub-id></mixed-citation>
    </ref>
    <ref id="bib30">
      <label>30.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Pandey</surname><given-names>RV</given-names></name>, <name name-style="western"><surname>Schlötterer</surname><given-names>C</given-names></name></person-group><article-title>DistMap: a toolkit for distributed short read mapping on a Hadoop cluster</article-title>. <source>PLoS One</source>. <year>2013</year>;<volume>8</volume>:<fpage>e72614</fpage>.<pub-id pub-id-type="pmid">24009693</pub-id></mixed-citation>
    </ref>
    <ref id="bib31">
      <label>31.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Nordberg</surname><given-names>H</given-names></name>, <name name-style="western"><surname>Bhatia</surname><given-names>K</given-names></name>, <name name-style="western"><surname>Wang</surname><given-names>K</given-names></name>, <etal/></person-group><article-title>BioPig: a Hadoop-based analytic toolkit for large-scale sequence data</article-title>. <source>Bioinformatics</source>. <year>2013</year>;<volume>29</volume>:<fpage>3014</fpage>–<lpage>9</lpage>.<pub-id pub-id-type="pmid">24021384</pub-id></mixed-citation>
    </ref>
    <ref id="bib32">
      <label>32.</label>
      <mixed-citation publication-type="other"><person-group person-group-type="author"><name name-style="western"><surname>Gao</surname><given-names>T</given-names></name>, <name name-style="western"><surname>Guo</surname><given-names>Y</given-names></name>, <name name-style="western"><surname>Wei</surname><given-names>Y</given-names></name><etal/></person-group><article-title>Bloomfish: a highly scalable distributed K-mer counting framework</article-title>. , <source>2017 IEEE 23rd International Conference on Parallel and Distributed Systems (ICPADS).</source><year>2017</year> p. <fpage>170</fpage>–<lpage>9</lpage>.</mixed-citation>
    </ref>
    <ref id="bib33">
      <label>33.</label>
      <mixed-citation publication-type="book"><person-group person-group-type="author"><name name-style="western"><surname>Menon</surname><given-names>RK</given-names></name>, <name name-style="western"><surname>Bhat</surname><given-names>GP</given-names></name>, <name name-style="western"><surname>Schatz</surname><given-names>MC</given-names></name></person-group><article-title>Rapid parallel genome indexing with MapReduce</article-title>. <source>Proceedings of the Second International Workshop on MapReduce and Its Applications</source>. <publisher-loc>New York, NY, USA</publisher-loc>: <publisher-name>ACM</publisher-name>; <year>2011</year> p. <fpage>51</fpage>–<lpage>8</lpage>.</mixed-citation>
    </ref>
    <ref id="bib34">
      <label>34.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Michie</surname><given-names>MG</given-names></name></person-group><article-title>Use of the Bray-Curtis similarity measure in cluster analysis of foraminiferal data</article-title>. <source>Math. Geol</source>. <year>1982</year>;<volume>14</volume>:<fpage>661</fpage>–<lpage>7</lpage>.</mixed-citation>
    </ref>
    <ref id="bib35">
      <label>35.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Lin</surname><given-names>J</given-names></name></person-group><article-title>Divergence measures based on the Shannon entropy</article-title>. <source>IEEE Trans. Inf. Theory</source>. <year>1991</year>;<volume>37</volume>:<fpage>145</fpage>–<lpage>51</lpage>.</mixed-citation>
    </ref>
    <ref id="bib36">
      <label>36.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Brum</surname><given-names>JR</given-names></name>, <name name-style="western"><surname>Ignacio-Espinoza</surname><given-names>JC</given-names></name>, <name name-style="western"><surname>Roux</surname><given-names>S</given-names></name>, <etal/></person-group><article-title>Patterns and ecological drivers of ocean viral communities</article-title>. <source>Science</source>; <year>2015</year>;<volume>348</volume>:<fpage>1261498</fpage><comment><ext-link ext-link-type="uri" xlink:href="http://www.sciencemag.org/content/348/6237/1261498.abstract">http://www.sciencemag.org/content/348/6237/1261498.abstract</ext-link></comment><pub-id pub-id-type="pmid">25999515</pub-id></mixed-citation>
    </ref>
    <ref id="bib37">
      <label>37.</label>
      <mixed-citation publication-type="other"><person-group person-group-type="author"><name name-style="western"><surname>Youens-Clark</surname><given-names>K</given-names></name>, <name name-style="western"><surname>Bomhoff</surname><given-names>M</given-names></name>, <name name-style="western"><surname>Hurwitz</surname><given-names>BL</given-names></name></person-group><comment>iMicrobe</comment><year>2018</year>; <comment><ext-link ext-link-type="uri" xlink:href="http://imicrobe.us">http://imicrobe.us</ext-link></comment></mixed-citation>
    </ref>
    <ref id="bib38">
      <label>38.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Goff</surname><given-names>SA</given-names></name>, <name name-style="western"><surname>Vaughn</surname><given-names>M</given-names></name>, <name name-style="western"><surname>McKay</surname><given-names>S</given-names></name>, <etal/></person-group><article-title>The iPlant Collaborative: cyberinfrastructure for plant biology</article-title>. <source>Front Plant Sci</source>. <year>2011</year>;<volume>2</volume>:<fpage>34</fpage>.<pub-id pub-id-type="pmid">22645531</pub-id></mixed-citation>
    </ref>
    <ref id="bib39">
      <label>39.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Devisetty</surname><given-names>UK</given-names></name>, <name name-style="western"><surname>Kennedy</surname><given-names>K</given-names></name>, <name name-style="western"><surname>Sarando</surname><given-names>P</given-names></name>, <etal/></person-group><article-title>Bringing your tools to CyVerse Discovery Environment using Docker</article-title>. <source>F1000Res</source>. <year>2016</year>;<volume>5</volume>:<fpage>1442</fpage>.<pub-id pub-id-type="pmid">27803802</pub-id></mixed-citation>
    </ref>
    <ref id="bib40">
      <label>40.</label>
      <mixed-citation publication-type="other"><person-group person-group-type="author"><name name-style="western"><surname>Ponsero</surname><given-names>A</given-names></name>, <name name-style="western"><surname>Hurwitz</surname><given-names>BL</given-names></name></person-group><article-title>Simulated metagenomics mock communities</article-title>. <comment>Cyverse Data Commons</comment><year>2018</year>: <pub-id pub-id-type="doi">10.7946/MQ0G</pub-id>.</mixed-citation>
    </ref>
    <ref id="bib41">
      <label>41.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>McElroy</surname><given-names>KE</given-names></name>, <name name-style="western"><surname>Luciani</surname><given-names>F</given-names></name>, <name name-style="western"><surname>Thomas</surname><given-names>T</given-names></name></person-group><article-title>GemSIM: general, error-model based simulator of next-generation sequencing data</article-title>. <source>BMC Genomics</source>.<year>2012</year>;<volume>13</volume>:<fpage>74</fpage>.<pub-id pub-id-type="pmid">22336055</pub-id></mixed-citation>
    </ref>
    <ref id="bib42">
      <label>42.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Stöcker</surname><given-names>BK</given-names></name>, <name name-style="western"><surname>Köster</surname><given-names>J</given-names></name>, <name name-style="western"><surname>Rahmann</surname><given-names>S</given-names></name></person-group><article-title>SimLoRD: simulation of long read data</article-title>. <source>Bioinformatics</source>.<year>2016</year>;<volume>32</volume>:<fpage>2704</fpage>–<lpage>6</lpage>.<pub-id pub-id-type="pmid">27166244</pub-id></mixed-citation>
    </ref>
    <ref id="bib43">
      <label>43.</label>
      <mixed-citation publication-type="journal"><collab>Human Microbiome Project Consortium</collab>. <article-title>Structure, function and diversity of the healthy human microbiome</article-title>. <source>Nature</source>.<year>2012</year>;<volume>486</volume>:<fpage>207</fpage>–<lpage>14</lpage>.<pub-id pub-id-type="pmid">22699609</pub-id></mixed-citation>
    </ref>
    <ref id="bib44">
      <label>44.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Diepenbroek</surname><given-names>M</given-names></name>, <name name-style="western"><surname>Grobe</surname><given-names>H</given-names></name>, <name name-style="western"><surname>Reinke</surname><given-names>M</given-names></name>, <etal/></person-group><article-title>PANGAEA—an information system for environmental sciences</article-title>. <source>Comput. Geosci</source>.; <year>2002</year>;<volume>28</volume>:<fpage>1201</fpage>–<lpage>10</lpage>.</mixed-citation>
    </ref>
    <ref id="bib45">
      <label>45.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>McHardy</surname><given-names>A</given-names></name>, <name name-style="western"><surname>Sczyrba</surname><given-names>A</given-names></name></person-group><article-title>Critical assessment of metagenome Iiterpretation (CAMI) 2nd Challenge</article-title>. <year>2018</year>; <comment>CAMI .</comment><comment><ext-link ext-link-type="uri" xlink:href="https://data.cami-challenge.org/participate">https://data.cami-challenge.org/participate</ext-link></comment>.</mixed-citation>
    </ref>
    <ref id="bib46">
      <label>46.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Okuda</surname><given-names>S</given-names></name>, <name name-style="western"><surname>Tsuchiya</surname><given-names>Y</given-names></name>, <name name-style="western"><surname>Kiriyama</surname><given-names>C</given-names></name><etal/></person-group><article-title>Virtual metagenome reconstruction from 16S rRNA gene sequences</article-title>. <source>Nat Commun</source>.<year>2012</year>;<volume>3</volume>:<fpage>1203</fpage>.<pub-id pub-id-type="pmid">23149747</pub-id></mixed-citation>
    </ref>
    <ref id="bib47">
      <label>47.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Watts</surname><given-names>GS</given-names></name>, <name name-style="western"><surname>Youens-Clark</surname><given-names>K</given-names></name>, <name name-style="western"><surname>Slepian</surname><given-names>MJ</given-names></name>, <etal/></person-group><article-title>16S rRNA gene sequencing on a benchtop sequencer: accuracy for identification of clinically important bacteria</article-title>. <source>J. Appl. Microbiol</source>. <year>2017</year>;<volume>123</volume>:<fpage>1584</fpage>–<lpage>96</lpage>.<pub-id pub-id-type="pmid">28940494</pub-id></mixed-citation>
    </ref>
    <ref id="bib48">
      <label>48.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Bergh</surname><given-names>O</given-names></name>, <name name-style="western"><surname>Borsheim</surname><given-names>KY</given-names></name>, <name name-style="western"><surname>Bratbak</surname><given-names>G</given-names></name>, <etal/></person-group><article-title>High abundance of viruses found in aquatic environments</article-title>. <source>Nature</source>. <year>1989</year>;<volume>340</volume>:<fpage>467</fpage>–<lpage>8</lpage>.<pub-id pub-id-type="pmid">2755508</pub-id></mixed-citation>
    </ref>
    <ref id="bib49">
      <label>49.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Hurwitz</surname><given-names>BL</given-names></name>, <name name-style="western"><surname>Brum</surname><given-names>JR</given-names></name>, <name name-style="western"><surname>Sullivan</surname><given-names>MB</given-names></name></person-group><article-title>Depth-stratified functional and taxonomic niche specialization in the “core” and “flexible” Pacific Ocean virome</article-title>. <source>ISME J</source>; <year>2014</year>, <volume>9</volume>, <issue>2</issue>, <fpage>472</fpage>–<lpage>84</lpage>, doi:<pub-id pub-id-type="doi">10.1038/ismej.2014.143</pub-id>; <comment><ext-link ext-link-type="uri" xlink:href="http://www.nature.com/ismej/journal/vaop/ncurrent/full/ismej2014143a.html">http://www.nature.com/ismej/journal/vaop/ncurrent/full/ismej2014143a.html</ext-link></comment>.<pub-id pub-id-type="pmid">25093636</pub-id></mixed-citation>
    </ref>
    <ref id="bib50">
      <label>50.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Minot</surname><given-names>S</given-names></name>, <name name-style="western"><surname>Wu</surname><given-names>GD</given-names></name>, <name name-style="western"><surname>Lewis</surname><given-names>JD</given-names></name>, <etal/></person-group><article-title>Conservation of gene cassettes among diverse viruses of the human gut</article-title>. <source>PLoS One</source>. <year>2012</year>;<volume>7</volume>:<fpage>e42342</fpage>.<pub-id pub-id-type="pmid">22900013</pub-id></mixed-citation>
    </ref>
    <ref id="bib51">
      <label>51.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Sun</surname><given-names>Y</given-names></name>, <name name-style="western"><surname>Cai</surname><given-names>Y</given-names></name>, <name name-style="western"><surname>Huse</surname><given-names>SM</given-names></name>, <etal/></person-group><article-title>A large-scale benchmark study of existing algorithms for taxonomy-independent microbial community analysis</article-title>. <source>Brief Bioinform</source>; <year>2012</year>;<volume>13</volume>:<fpage>107</fpage>–<lpage>21</lpage>.<pub-id pub-id-type="pmid">21525143</pub-id></mixed-citation>
    </ref>
    <ref id="bib52">
      <label>52.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Edgar</surname><given-names>RC</given-names></name></person-group><article-title>Search and clustering orders of magnitude faster than BLAST</article-title>. <source>Bioinformatics</source>. <year>2010</year>;<volume>26</volume>:<fpage>2460</fpage>–<lpage>1</lpage>.<pub-id pub-id-type="pmid">20709691</pub-id></mixed-citation>
    </ref>
    <ref id="bib53">
      <label>53.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Niu</surname><given-names>BF</given-names></name>, <name name-style="western"><surname>Fu</surname><given-names>LM</given-names></name>, <name name-style="western"><surname>Sun</surname><given-names>SL</given-names></name>, <etal/></person-group><article-title>Artificial and natural duplicates in pyrosequencing reads of metagenomic data</article-title>. <source>BMC Bioinformatics</source>. <year>2010</year>;<volume>11</volume>:<fpage>187</fpage>.<pub-id pub-id-type="pmid">20388221</pub-id></mixed-citation>
    </ref>
    <ref id="bib54">
      <label>54.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Cai</surname><given-names>Y</given-names></name>, <name name-style="western"><surname>Sun</surname><given-names>Y</given-names></name></person-group><article-title>ESPRIT-Tree: hierarchical clustering analysis of millions of 16S rRNA pyrosequences in quasilinear computational time</article-title>. <source>Nucleic Acids Res</source>, <year>2011</year>;<volume>39</volume>:<fpage>e95</fpage>.<pub-id pub-id-type="pmid">21596775</pub-id></mixed-citation>
    </ref>
    <ref id="bib55">
      <label>55.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Hurwitz</surname><given-names>BL</given-names></name>, <name name-style="western"><surname>Brum</surname><given-names>JR</given-names></name>, <name name-style="western"><surname>Sullivan</surname><given-names>MB</given-names></name></person-group><article-title>Depth-stratified functional and taxonomic niche specialization in the “core” and “flexible” Pacific Ocean virome</article-title>. <source>ISME J</source>. <year>2015</year>;<volume>9</volume>:<fpage>472</fpage>–<lpage>84</lpage>.<pub-id pub-id-type="pmid">25093636</pub-id></mixed-citation>
    </ref>
    <ref id="bib56">
      <label>56.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Weinstein</surname><given-names>JN</given-names></name>, <name name-style="western"><surname>Collisson</surname><given-names>EA</given-names></name>, <name name-style="western"><surname>Mills</surname><given-names>GB</given-names></name>, <etal/></person-group><article-title>The cancer genome atlas pan-cancer analysis project</article-title>. <source>Nat Genet</source>. <year>2013</year>;<volume>45</volume>:<fpage>1113</fpage>–<lpage>20</lpage>.<pub-id pub-id-type="pmid">24071849</pub-id></mixed-citation>
    </ref>
    <ref id="bib57">
      <label>57.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Hurwitz</surname><given-names>BL</given-names></name>, <name name-style="western"><surname>Westveld</surname><given-names>AH</given-names></name>, <name name-style="western"><surname>Brum</surname><given-names>JR</given-names></name>, <etal/></person-group><article-title>Modeling ecological drivers in marine viral communities using comparative metagenomics and network analyses</article-title>. <source>Proc Natl Acad Sci</source>. <year>2014</year>;<volume>111</volume>:<fpage>10714</fpage>–<lpage>9</lpage>.<pub-id pub-id-type="pmid">25002514</pub-id></mixed-citation>
    </ref>
    <ref id="bib58">
      <label>58.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Kurtz</surname><given-names>S</given-names></name>, <name name-style="western"><surname>Narechania</surname><given-names>A</given-names></name>, <name name-style="western"><surname>Stein</surname><given-names>JC</given-names></name>, <etal/></person-group><article-title>A new method to compute K-mer frequencies and its application to annotate large repetitive plant genomes</article-title>. <source>BMC Genomics</source>. <year>2008</year>;<volume>9</volume>:<fpage>517</fpage>.<pub-id pub-id-type="pmid">18976482</pub-id></mixed-citation>
    </ref>
    <ref id="bib59">
      <label>59.</label>
      <mixed-citation publication-type="book"><person-group person-group-type="author"><name name-style="western"><surname>O'Malley</surname><given-names>O</given-names></name></person-group><source>Terabyte sort on Apache Hadoop</source>.<comment><ext-link ext-link-type="uri" xlink:href="http://sortbenchmarkorg/Yahoo-Hadooppdf">http://sortbenchmark org/Yahoo-Hadoop pdf</ext-link></comment>, <comment>Citeseer</comment>; <year>2008</year>;<fpage>1</fpage>–<lpage>3</lpage>.</mixed-citation>
    </ref>
    <ref id="bib60">
      <label>60.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Bomhoff</surname><given-names>M</given-names></name></person-group><article-title>Ocean Cloud Commons Plan B Github</article-title>. <year>2018</year>; <comment><ext-link ext-link-type="uri" xlink:href="https://github.com/hurwitzlab/occ-plan-b">https://github.com/hurwitzlab/occ-plan-b</ext-link></comment></mixed-citation>
    </ref>
    <ref id="bib61">
      <label>61.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Zaharia</surname><given-names>M</given-names></name>, <name name-style="western"><surname>Chowdhury</surname><given-names>M</given-names></name>, <name name-style="western"><surname>Franklin</surname><given-names>MJ</given-names></name>, <etal/></person-group><article-title>Spark: cluster computing with working sets</article-title>. <source>HotCloud</source>. <year>2010</year>;<volume>10</volume>:<fpage>95</fpage>.</mixed-citation>
    </ref>
    <ref id="bib62">
      <label>62.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Guo</surname><given-names>R</given-names></name>, <name name-style="western"><surname>Zhao</surname><given-names>Y</given-names></name>, <name name-style="western"><surname>Zou</surname><given-names>Q</given-names></name>, <etal/></person-group><article-title>Bioinformatics applications on Apache Spark</article-title>. <source>GigaScience</source>. <year>2018</year>, <volume>7</volume>, <issue>8</issue>, doi:<pub-id pub-id-type="doi">10.1093/gigascience/giy098</pub-id>.</mixed-citation>
    </ref>
    <ref id="bib63">
      <label>63.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Choi</surname><given-names>I</given-names></name></person-group><article-title>Libra Github</article-title>. <year>2018</year>; <comment><ext-link ext-link-type="uri" xlink:href="https://www.github.com/iychoi/Libra">https://www.github.com/iychoi/Libra</ext-link></comment></mixed-citation>
    </ref>
    <ref id="bib64">
      <label>64.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Choi</surname><given-names>I</given-names></name>, <name name-style="western"><surname>Ponsero</surname><given-names>AJ</given-names></name>, <name name-style="western"><surname>Bomhoff</surname><given-names>M</given-names></name><etal/></person-group><article-title>Supporting data for “Libra: scalable <italic>k-</italic>mer based tool for massive all-vs-all metagenome comparisons.”</article-title>. <source>GigaScience Database</source>. <year>2018</year><pub-id pub-id-type="doi">10.5524/100547</pub-id>.</mixed-citation>
    </ref>
  </ref-list>
</back>
