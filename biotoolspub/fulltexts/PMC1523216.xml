<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">BMC Bioinformatics</journal-id>
    <journal-title>BMC Bioinformatics</journal-title>
    <issn pub-type="epub">1471-2105</issn>
    <publisher>
      <publisher-name>BioMed Central</publisher-name>
      <publisher-loc>London</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">1523216</article-id>
    <article-id pub-id-type="publisher-id">1471-2105-7-264</article-id>
    <article-id pub-id-type="pmid">16716215</article-id>
    <article-id pub-id-type="doi">10.1186/1471-2105-7-264</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Research Article</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Spatial normalization of array-CGH data</article-title>
    </title-group>
    <contrib-group>
      <contrib id="A1" equal-contrib="yes" corresp="yes" contrib-type="author">
        <name>
          <surname>Neuvial</surname>
          <given-names>Pierre</given-names>
        </name>
        <xref ref-type="aff" rid="I1">1</xref>
        <email>pierre.neuvial@curie.fr</email>
      </contrib>
      <contrib id="A2" equal-contrib="yes" contrib-type="author">
        <name>
          <surname>Hupé</surname>
          <given-names>Philippe</given-names>
        </name>
        <xref ref-type="aff" rid="I1">1</xref>
        <xref ref-type="aff" rid="I2">2</xref>
        <email>philippe.hupe@curie.fr</email>
      </contrib>
      <contrib id="A3" contrib-type="author">
        <name>
          <surname>Brito</surname>
          <given-names>Isabel</given-names>
        </name>
        <xref ref-type="aff" rid="I1">1</xref>
        <email>isabel.brito@curie.fr</email>
      </contrib>
      <contrib id="A4" contrib-type="author">
        <name>
          <surname>Liva</surname>
          <given-names>Stéphane</given-names>
        </name>
        <xref ref-type="aff" rid="I1">1</xref>
        <email>stephane.liva@curie.fr</email>
      </contrib>
      <contrib id="A5" contrib-type="author">
        <name>
          <surname>Manié</surname>
          <given-names>Élodie</given-names>
        </name>
        <xref ref-type="aff" rid="I3">3</xref>
        <email>elodie.manie@curie.fr</email>
      </contrib>
      <contrib id="A6" contrib-type="author">
        <name>
          <surname>Brennetot</surname>
          <given-names>Caroline</given-names>
        </name>
        <xref ref-type="aff" rid="I3">3</xref>
        <email>caroline.brennetot@curie.fr</email>
      </contrib>
      <contrib id="A7" contrib-type="author">
        <name>
          <surname>Radvanyi</surname>
          <given-names>François</given-names>
        </name>
        <xref ref-type="aff" rid="I2">2</xref>
        <email>francois.radvanyi@curie.fr</email>
      </contrib>
      <contrib id="A8" contrib-type="author">
        <name>
          <surname>Aurias</surname>
          <given-names>Alain</given-names>
        </name>
        <xref ref-type="aff" rid="I3">3</xref>
        <email>alain.aurias@curie.fr</email>
      </contrib>
      <contrib id="A9" contrib-type="author">
        <name>
          <surname>Barillot</surname>
          <given-names>Emmanuel</given-names>
        </name>
        <xref ref-type="aff" rid="I1">1</xref>
        <email>emmanuel.barillot@curie.fr</email>
      </contrib>
    </contrib-group>
    <aff id="I1"><label>1</label>Institut Curie, Service de Bioinformatique, 26, rue d'Ulm, Paris, 75248 cedex 05, France</aff>
    <aff id="I2"><label>2</label>Institut Curie, CNRS UMR 144, 26, rue d'Ulm, Paris, 75248 cedex 05, France</aff>
    <aff id="I3"><label>3</label>Institut Curie, INSERM U509, 26, rue d'Ulm, Paris, 75248 cedex 05, France</aff>
    <pub-date pub-type="collection">
      <year>2006</year>
    </pub-date>
    <pub-date pub-type="epub">
      <day>22</day>
      <month>5</month>
      <year>2006</year>
    </pub-date>
    <volume>7</volume>
    <fpage>264</fpage>
    <lpage>264</lpage>
    <ext-link ext-link-type="uri" xlink:href="http://www.biomedcentral.com/1471-2105/7/264"/>
    <history>
      <date date-type="received">
        <day>15</day>
        <month>9</month>
        <year>2005</year>
      </date>
      <date date-type="accepted">
        <day>22</day>
        <month>5</month>
        <year>2006</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>Copyright © 2006 Neuvial et al; licensee BioMed Central Ltd.</copyright-statement>
      <copyright-year>2006</copyright-year>
      <copyright-holder>Neuvial et al; licensee BioMed Central Ltd.</copyright-holder>
      <license license-type="open-access" xlink:href="http://creativecommons.org/licenses/by/2.0">
        <p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/2.0"/>), which permits unrestricted use, distribution, and reproduction in any medium, provided the original work is properly cited.</p>
        <!--<rdf xmlns="http://web.resource.org/cc/" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:dc="http://purl.org/dc/elements/1.1" xmlns:dcterms="http://purl.org/dc/terms"><Work xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:dcterms="http://purl.org/dc/terms/" rdf:about=""><license rdf:resource="http://creativecommons.org/licenses/by/2.0"/><dc:type rdf:resource="http://purl.org/dc/dcmitype/Text"/><dc:author>
               Neuvial
               Pierre
               
               pierre.neuvial@curie.fr
            </dc:author><dc:title>
            Spatial normalization of array-CGH data
         </dc:title><dc:date>2006</dc:date><dcterms:bibliographicCitation>BMC Bioinformatics 7(1): 264-. (2006)</dcterms:bibliographicCitation><dc:identifier type="sici">1471-2105(2006)7:1&#x0003c;264&#x0003e;</dc:identifier><dcterms:isPartOf>urn:ISSN:1471-2105</dcterms:isPartOf><License rdf:about="http://creativecommons.org/licenses/by/2.0"><permits rdf:resource="http://web.resource.org/cc/Reproduction" xmlns=""/><permits rdf:resource="http://web.resource.org/cc/Distribution" xmlns=""/><requires rdf:resource="http://web.resource.org/cc/Notice" xmlns=""/><requires rdf:resource="http://web.resource.org/cc/Attribution" xmlns=""/><permits rdf:resource="http://web.resource.org/cc/DerivativeWorks" xmlns=""/></License></Work></rdf>-->
      </license>
    </permissions>
    <abstract>
      <sec>
        <title>Background</title>
        <p>Array-based comparative genomic hybridization (array-CGH) is a recently developed technique for analyzing changes in DNA copy number. As in all microarray analyses, normalization is required to correct for experimental artifacts while preserving the true biological signal. We investigated various sources of systematic variation in array-CGH data and identified two distinct types of spatial effect of no biological relevance as the predominant experimental artifacts: continuous spatial gradients and local spatial bias. Local spatial bias affects a large proportion of arrays, and has not previously been considered in array-CGH experiments.</p>
      </sec>
      <sec>
        <title>Results</title>
        <p>We show that existing normalization techniques do not correct these spatial effects properly. We therefore developed an automatic method for the spatial normalization of array-CGH data. This method makes it possible to delineate and to eliminate and/or correct areas affected by spatial bias. It is based on the combination of a spatial segmentation algorithm called NEM (Neighborhood Expectation Maximization) and spatial trend estimation. We defined quality criteria for array-CGH data, demonstrating significant improvements in data quality with our method for three data sets coming from two different platforms (198, 175 and 26 BAC-arrays).</p>
      </sec>
      <sec>
        <title>Conclusion</title>
        <p>We have designed an automatic algorithm for the spatial normalization of BAC CGH-array data, preventing the misinterpretation of experimental artifacts as biologically relevant outliers in the genomic profile. This algorithm is implemented in the R package MANOR (Micro-Array NORmalization), which is described at <ext-link ext-link-type="uri" xlink:href="http://bioinfo.curie.fr/projects/manor"/> and available from the Bioconductor site <ext-link ext-link-type="uri" xlink:href="http://www.bioconductor.org"/>. It can also be tested on the CAPweb bioinformatics platform at <ext-link ext-link-type="uri" xlink:href="http://bioinfo.curie.fr/CAPweb"/>.</p>
      </sec>
    </abstract>
  </article-meta>
</front>
<body>
  <sec>
    <title>Background</title>
    <p>Array-based comparative genomic hybridization (array-CGH) provides a quantitative measure of differences in copy number between two DNA samples [<xref ref-type="bibr" rid="B1">1</xref>]. The technique is typically applied to cancer studies because chromosome aberrations frequently occur during tumor progression [<xref ref-type="bibr" rid="B2">2</xref>]. Array-CGH facilitates the localization and identification of oncogenes and tumor suppressor genes, which are likely to be present in chromosomal regions gained and lost, respectively, in cancer cells.</p>
    <p>Recent developments in the statistical analysis of array-CGH data have focused on high-level analysis, typically the identification of breakpoints from the genomic profile [<xref ref-type="bibr" rid="B3">3</xref>-<xref ref-type="bibr" rid="B7">7</xref>], rather than normalization. Most of the normalization techniques used to date for array-CGH data analysis have therefore involved the simple transposition of methods originally designed for expression data [<xref ref-type="bibr" rid="B8">8</xref>,<xref ref-type="bibr" rid="B9">9</xref>], correcting for differences in the labeling efficiency of the two dyes, spotting effects (block, row, column, or print-tip effects), and local or global intensity dependence of the ratios [<xref ref-type="bibr" rid="B10">10</xref>]. As far as we are aware, Khojasteh <italic>et al</italic>. [<xref ref-type="bibr" rid="B11">11</xref>] have reported the only method specific to CGH arrays.</p>
    <p>Investigation of the systematic sources of variation in the array-CGH data studied showed that the effects affecting expression arrays were negligible with respect to spatial effects of two types. We describe here an algorithm for spatial normalization, which can also be combined with existing normalization methods for handling non-spatial artifacts. We will define and illustrate these two types of spatial effect, and show that such effects are not properly taken into account by traditional normalization techniques.</p>
    <sec>
      <title>Two distinct types of spatial artifact</title>
      <p>The methods proposed here were originally developed for the analysis of bladder cancer data from tumors collected at Henri Mondor Hospital (Créteil, France) [<xref ref-type="bibr" rid="B12">12</xref>], analyzed by hybridization on CGH arrays (F. Radvanyi, D. Pinkel <italic>et al</italic>., unpublished results), including 2464 clones spotted at the University of California San Francisco (UCSF) [<xref ref-type="bibr" rid="B13">13</xref>]. They were then adapted to several data sets for CGH arrays produced and hybridized at the Institut Curie, including the breast cancer data (O. Delattre, A. Aurias <italic>et al</italic>., unpublished results) and the neuroblastoma data [<xref ref-type="bibr" rid="B14">14</xref>] (which is publicly available [<xref ref-type="bibr" rid="B15">15</xref>]) used to illustrate the technique.</p>
      <p>We identified two types of spatial effect with fundamentally different natures: <italic>local spatial bias </italic>(Fig. <xref ref-type="fig" rid="F1">1(a)</xref>) and <italic>continuous spatial gradients </italic>(Fig. <xref ref-type="fig" rid="F2">2-1(a)</xref>):</p>
      <sec>
        <title>Local spatial bias</title>
        <p>The array image shows clusters of spots with a discrete signal shift, with the other spots of the array remaining unchanged. These clustered shifted spots on the array image (Fig. <xref ref-type="fig" rid="F1">1(a)</xref>) have no biological explanation, and correspond to outliers on genomic profiles (Fig. <xref ref-type="fig" rid="F3">3(e)</xref> and <xref ref-type="fig" rid="F6">6(e)</xref>). In the data sets studied here, this artifact was found to affect about half of all arrays. We describe it as <italic>local </italic>because it affects only limited areas of the array.</p>
      </sec>
      <sec>
        <title>Continuous spatial gradient</title>
        <p>The array image shows a smooth gradient in signal from one side of the slide to the other (Fig. <xref ref-type="fig" rid="F2">2-1(a)</xref>). This artifact leads to genomic profiles with high variability, even between regions with the same DNA copy number. When this effect is observed, it affects all spots to various degrees.</p>
        <p>These two types of effect are experimental artifacts of non-biological origin:</p>
        <p>- They occur on arrays designed such that neighboring spots on the array correspond to non-neighboring clones in the genome, so there is no obvious biological reason for the clustering of high (or low) signals on the array;</p>
        <p>- They are frequently observed on control (normal tissue vs normal tissue) hybridizations, and even on background signals (see Figure <xref ref-type="fig" rid="F5">5</xref> for illustration with the breast cancer data set).</p>
        <p>The methods proposed are designed to remove or reduce these two types of spatial effect, while preserving the true biological signal.</p>
      </sec>
    </sec>
    <sec>
      <title>The need for a spatial segmentation method</title>
      <p>The spatial effects described above cannot be attributed to spotting, for two reasons: firstly, they are not limited to array rows, columns or blocks; secondly, they are not reproducible from one array to another, even for arrays taken from batches of slides printed at the same time. Therefore, it is not possible to correct for them properly with the normalization methods generally used for expression arrays, in which "spatial" effects are captured only by row, column, or print-tip group effects. For a method to be appropriate, it must take into account the spatial structure of the array as a whole, and the arbitrary shape of these biased areas.</p>
      <p>Several different studies have taken into account spatial effects in expression microarray data and have provided signal correction methods. For example, Workman <italic>et al</italic>. [<xref ref-type="bibr" rid="B16">16</xref>] defined a spatial gradient normalization method using a two-dimensional Gaussian function to estimate local background bias in a probe neighborhood. Baird <italic>et al</italic>. [<xref ref-type="bibr" rid="B17">17</xref>] proposed a mixed model for cDNA array data, using splines with spatial autocorrelation, assuming the existence of a one-step correlation between adjacent spots in a row or column. Colantuoni <italic>et al</italic>. [<xref ref-type="bibr" rid="B18">18</xref>] proposed a method for normalizing the element signal intensities to a mean intensity calculated locally across the surface of a DNA microarray. Others studies have combined intensity-dependent and spatially-dependent effects. Wilson <italic>et al</italic>. [<xref ref-type="bibr" rid="B19">19</xref>] have proposed fitting a single LOESS curve on the MA plot and then spatially smoothing the residuals using a median filter to estimate the spatial trend. Tarca <italic>et al</italic>. [<xref ref-type="bibr" rid="B20">20</xref>] proposed correcting intensity-dependent and spatially-dependent effects using a feed-forward neural network. Khojasteh <italic>et al</italic>. [<xref ref-type="bibr" rid="B11">11</xref>] have compared different CGH array data normalization methods and suggested that a three-step normalization that combines print-tip LOESS with spatial correction using moving median and microplate effect correction gave the best results.</p>
      <p>These methods may be suitable for correcting continuous spatial gradients, but they were not designed to detect abrupt changes in signal value across the array, and therefore may not adequately handle local spatial bias: Figure <xref ref-type="fig" rid="F1">1</xref> illustrates the need for a spatial <italic>segmentation </italic>method to handle such local spatial effects. From the median-centered log-ratios (a) we estimate a spatial trend (b) by two-dimensional LOESS regression [<xref ref-type="bibr" rid="B21">21</xref>,<xref ref-type="bibr" rid="B22">22</xref>]; subtracting this spatial trend from the raw values partially corrects the spatial effect (c), but the array trend after correction (d) demonstrates that the spatial effect is undercorrected at the inner border of the biased area, and overcorrected at the outer border, consistent with the observation that signal disturbances vary steeply at the border of the biased area. This systematic overcorrection or undercorrection may lead to misinterpretation in the corresponding genomic profile.</p>
      <p>A similar type of spatial effect was reported for expression microarrays by Reimers <italic>et al </italic>[<xref ref-type="bibr" rid="B23">23</xref>]. For CGH arrays, this type of effect should be easier to detect and correct, as they have a much smaller range of signal ratio variation than expression microarrays. However, this smaller range necessitates a much greater measurement precision for array-CGH data.</p>
      <p>We describe here a spatial segmentation algorithm for the automatic <italic>delineation </italic>and <italic>elimination </italic>of unreliable areas, facilitating the exclusion of local spatial bias from array-CGH data. This algorithm consists of three steps, which are explained in detail in the Methods section:</p>
      <p>[step 1]: Estimation of a spatial trend on the array using two-dimensional LOESS regression [<xref ref-type="bibr" rid="B21">21</xref>,<xref ref-type="bibr" rid="B22">22</xref>]</p>
      <p>[step 2]: Segmentation of the array into spatial areas with similar trend values using NEM, an unsupervised classification algorithm including spatial constraints [<xref ref-type="bibr" rid="B24">24</xref>,<xref ref-type="bibr" rid="B25">25</xref>]</p>
      <p>[step 3]: Identification of the areas affected by spatial bias.</p>
      <p>A wide variety of microarray techniques based on BACs, cDNAs or oligonucleotides (see [<xref ref-type="bibr" rid="B26">26</xref>] for a review) may be used to quantify changes in DNA copy number. From a technical aspect, our method could be applied to any of these microarray types, although we detected local spatial bias only on BAC arrays.</p>
      <p>Therefore, we focused on this technology, which has also been the most widely used so far. We provide examples of the implementation of this method and illustrate its performance with three data sets collected on two CGH-array platforms:</p>
      <p>- The first data set (bladder cancer data) was produced at the UCSF. In this data set, local spatial effects were observed on 57% of 198 arrays, with a median of 229 affected spots, and no visual evidence of spatial gradients;</p>
      <p>- The two other data sets were produced at the Institut Curie, INSERM U509. They consist of a breast cancer data set, in which local spatial effects were observed on 45% of 175 arrays, with a median of 592 affected spots, and a neuroblastoma data set [<xref ref-type="bibr" rid="B14">14</xref>,<xref ref-type="bibr" rid="B15">15</xref>], with local spatial effects on 23% of 26 arrays, and a median of 551 affected spots.</p>
    </sec>
    <sec>
      <title>MANOR: an algorithm combining segmentation and signal correction</title>
      <p>In addition to local spatial bias, we also frequently identified continuous spatial gradients, especially in breast cancer data set (Fig. <xref ref-type="fig" rid="F2">2-1(a)</xref>) and neuroblastoma data set. A straightforward way to correct for spatial gradients (Fig. <xref ref-type="fig" rid="F2">2-1(b)</xref>) is to subtract from the log-ratios an estimate of the spatial trend on the array (Fig. <xref ref-type="fig" rid="F2">2-2(a, b)</xref>). The first step of the spatial segmentation algorithm for detecting local spatial bias (step 1) provides such an estimate. This estimate is calculated using two-dimensional LOESS regression as explained in detail in the Methods section.</p>
      <p>In many cases, the CGH arrays were affected by both types of spatial effect: local spatial effects and continuous spatial gradients. In practice, we do not know in advance what type of spatial effect affects a given array. Thus, we propose the following two-step approach:</p>
      <p>1. run the spatial segmentation algorithm (<italic>seg</italic>) to identify potential areas of local spatial bias</p>
      <p>2. correct spots not excluded during the first step for continuous spatial gradients (<italic>2dLoess</italic>).</p>
      <p>This algorithm, implemented in the MANOR package, will be referred to as <italic>seg+2dLoess </italic>in the remainder of this article. The rationale underlying this two-step approach is that arrays affected by continuous spatial gradients only will not be detected as containing local spatial bias by the step <italic>seg</italic>, and will therefore be properly corrected by the step <italic>2dLoess</italic>. This two-step approach is suitable for the spatial normalization of data sets containing both types of spatial effect.</p>
    </sec>
  </sec>
  <sec>
    <title>Results and discussion</title>
    <p>We have used our method for the spatial normalization of array-CGH data from two different platforms. In this section, we provide information about the practical implementation of the method on these two platforms, and quantitative results comparing our method to ten other normalization techniques. These compare the values of three quality criteria calculated after normalization of each array: the first, <italic>sigma</italic>, estimates the experimental variability between replicates, whereas the others, <italic>smt </italic>and <italic>dyn</italic>, evaluate quality in the context of the estimation of differences in DNA copy number between test and reference samples: <italic>smt </italic>quantifies the smoothness of the signal over the genome, and <italic>dyn </italic>assesses the dynamics of the signal, defined by the signal-to-noise ratio between gained and normal regions; these criteria are defined more formally and explained in detail in the Methods section.</p>
    <p>To our knowledge, the ten normalization procedures used for the comparisons cover all the different types of approaches proposed so far and include the methods proposed by Tarca <italic>et al</italic>. [<xref ref-type="bibr" rid="B20">20</xref>], Yang <italic>et al</italic>. [<xref ref-type="bibr" rid="B10">10</xref>] and Khojasteh <italic>et al</italic>. [<xref ref-type="bibr" rid="B11">11</xref>]. These methods are detailed in the Methods section. For each normalization method, we calculated the three quality criteria for each array. When comparing two methods, we calculated a relative performance for each quality criterion, and assessed the significance of this performance using a Student's t-test, as explained in the Methods section. We show that our proposed method outperforms all previously published approaches for the three data sets.</p>
    <sec>
      <title>Application to data produced at UCSF</title>
      <p>The bladder cancer data set to which our algorithm was applied concerns 198 arrays that were spotted and hybridized at UCSF. These arrays consist of 7392 spots, corresponding to 2464 clones – all of which are BACs (Bacterial Artificial Chromosomes) – with the following design:</p>
      <p>- Neighboring clones in the genome are dispersed on the array – a necessary condition for distinguishing between spatial artifacts and real biological information;</p>
      <p>- Each clone is replicated three times on the array, and the three replicated spots are adjacent, so a high level of consistency for the three corresponding ratios does not prove that there are no spatial effects.</p>
      <p>For this data set, spatial normalization is the last step in the following comprehensive normalization process. After image analysis of the arrays with SPOT 2.0 software [<xref ref-type="bibr" rid="B27">27</xref>], we screened for low-quality spots: spots with a foreground reference signal (and foreground DAPI signal) less than 125% of the background reference signal (reference DAPI signal) were discarded, as were clones with a log-ratio standard deviation exceeding 0.1. Clones for which only one of the three replicates was retained after these steps were then also discarded.</p>
      <p>Finally, we applied the proposed spatial normalization method <italic>seg+2dLoess </italic>as follows: the spatial segmentation <italic>seg </italic>was applied to the log-ratios of this filtered array, with <italic>K </italic>= 5 and <italic>β </italic>= 1 (see Methods for a definition of these parameters and a discussion of how to choose them), followed by the correction for continuous spatial gradients <italic>2dLoess</italic>.</p>
      <sec>
        <title>Spatial normalization step</title>
        <p>Our segmentation algorithm detected local spatial effects on 113 of 198 bladder cancer arrays (57%); the median proportion of biased areas on these arrays was 3.1%. Figure <xref ref-type="fig" rid="F3">3</xref> (top) illustrates the successive steps of the algorithm, from centered log-ratios to array trend, spatial segmentation of the array, and finally the delineation of biased areas. Red dots on the corresponding genomic profile (Figure <xref ref-type="fig" rid="F3">3</xref>, bottom) correspond to the spots discarded during spatial normalization (on this figure, signal log-ratios have not yet been averaged by clone: <italic>spot-level information </italic>is displayed).</p>
        <p>Figure <xref ref-type="fig" rid="F3">3</xref> (bottom) illustrates the improvement in data quality achieved with our spatial normalization method: among the apparent outliers (i.e. clones with log-ratio values significantly different from the mean log-ratio value for the genomic region), it distinguished between experimental artifacts (red dots) and potentially biologically relevant outliers accounting for localized genomic amplifications.</p>
      </sec>
      <sec>
        <title>Evaluation of the performance of the <italic>seg+2dLoess </italic>method</title>
        <p>For each normalization method (11 methods including ours), we calculated the three quality criteria for each array and performed pairwise comparison of methods using the estimate and significance of their relative performance for each criterion, as explained in detail in the Methods section.</p>
        <p>Figure <xref ref-type="fig" rid="F4">4</xref> shows the results of comparison of the ten methods with <italic>seg+2dLoess</italic>. For the <italic>dyn </italic>criterion, <italic>seg+2dLoess </italic>significantly outperformed all methods (with all <italic>p</italic>-values ≤ 0.039), and most significantly methods 5 to 11, that do not include the <italic>2dLoess </italic>step (with all <italic>p</italic>-values below 8.5 × 10<sup>-18</sup>). The <italic>dyn </italic>criterion is particularly important as it assesses the quality of copy number change detection. <italic>seg+2dLoess </italic>also gives significantly better results for the <italic>sigma </italic>criterion than all other methods (with all <italic>p</italic>-values below 1.1 × 10<sup>-8</sup>) except one: <italic>seg </italic>performs significantly better (<italic>p </italic>= 7.9 × 10<sup>-4</sup>) but the relative improvement has a limited amplitude (only 0.36%).</p>
        <p>For the <italic>smt </italic>criterion, <italic>seg+2dLoess </italic>also significantly outperforms all methods (with all <italic>p</italic>-values below 8.1 × 10<sup>-6</sup>, except <italic>block+2dLoess </italic>for which <italic>p </italic>= 0.048).</p>
        <p>Section 1 of the <xref ref-type="supplementary-material" rid="S1">Additional file 1</xref> shows similar plots to Figure <xref ref-type="fig" rid="F4">4</xref>, but for the <italic>smt </italic>and <italic>dyn </italic>criteria, and for the <italic>smt </italic>and <italic>sigma </italic>criteria. Tables 1 to 3 of the Additional files <xref ref-type="supplementary-material" rid="S2">2</xref> and <xref ref-type="supplementary-material" rid="S3">3</xref> summarize the results of all the pairwise comparisons of methods for the three quality criteria.</p>
        <p>Taken together, these results show that the <italic>seg+2dLoess </italic>method outperforms its competitors for the bladder cancer data set.</p>
      </sec>
    </sec>
    <sec>
      <title>Application to data produced at Institut Curie, INSERM U 509</title>
      <p>The Institut Curie, INSERM U509 has developed its own high-density CGH array; all steps in the production of these chips are performed in Institut Curie laboratories, including array spotting, DNA preparation, hybridization, scanning and image processing. The current version of the array contains 3342 clones, each of which is spotted at least three times on the array, giving a total of 10800 to 11520 spots (including controls).</p>
      <p>This array was designed to facilitate distinction between relevant biological effects and experimental artifacts: "empty" spots and spots of water were included as controls, clone replicates were scattered over the array, and the positions of clones on the array are not correlated with their actual positions in the genome. A reliable ratio value can therefore be calculated even if one of the three replicates is flagged. The arrays were scanned using an Axon Genepix 4000b scanner, and images were processed with Genepix Pro 5.1.</p>
      <p>We analyzed a breast cancer data set and a neuroblastoma data set from this platform.</p>
      <p>For this platform, we applied the proposed spatial normalization method <italic>seg+2dLoess </italic>as follows: the spatial segmentation <italic>seg </italic>was applied to the Background signal as explained in the paragraph below, and the spatial gradients were corrected by <italic>2dLoess </italic>calculated over the log-ratios. A post-processing step that includes spot and clone screening was then applied (allowing us, for example, to discard spots having too low a signal-to-noise ratio, or with poor replicate consistency).</p>
      <sec>
        <title>Detail of the spatial segmentation step</title>
        <p>Although we can correct the foreground signal for background intensity, a significant proportion of arrays still show localized spatial patterns that cannot be attributed to biological causes. Visual examination of spatial representations of the four signals (foreground and background intensities for test and reference signals) revealed that the bias was much clearer for the background signal of Cy3-labeled samples (Figure <xref ref-type="fig" rid="F5">5</xref>), which was not the case for bladder cancer data. We therefore applied the spatial segmentation method described above to the background signal of the Cy3 channel, with <italic>K </italic>= 7 and <italic>β </italic>= 1 (see Methods for a definition of these parameters and a discussion of how to choose them).</p>
        <p>Biased areas of the CGH array are flagged and excluded from subsequent analysis. As clone replicates are not adjacent on the array, at least two of the three replicates generally remain after spatial bias correction, and a reliable ratio value can still be calculated. Figure <xref ref-type="fig" rid="F6">6</xref> shows the results of this spatial segmentation step in the case of an array with local spatial bias but no spatial gradients.</p>
      </sec>
      <sec>
        <title>Evaluation of the performance of the method <italic>seg+2dLoess </italic></title>
        <p>As for bladder cancer data, we calculated the three quality criteria for each normalization method and for each array for the breast cancer data set and the neuroblastoma data set. We then compared the methods paiwise using the estimate and significance of their relative performance for each criterion, as explained in detail in the Methods section.</p>
        <p>Figures <xref ref-type="fig" rid="F7">7</xref> and <xref ref-type="fig" rid="F8">8</xref> show the results of comparing the ten methods with <italic>seg+2dLoess </italic>for the <italic>dyn </italic>and <italic>sigma </italic>criteria. <italic>seg+2dLoess </italic>significantly outperforms all other methods for the three criteria on the breast cancer data set (with all <italic>p</italic>-values below 2.3 × 10<sup>-4</sup>).</p>
        <p>The neuroblastoma data set gives similar results: <italic>seg+2dLoess </italic>quality criteria are always better than those of the other methods, except for <italic>dyn</italic>, in which <italic>adjSeg+2dLoess </italic>is slightly better (0.22%) but not significantly so (<italic>p </italic>= 0.1). For <italic>smt, seg+2dLoess </italic>is only slightly better than <italic>ptl+movMed </italic>and the methods including the <italic>2dLoess </italic>step, but not significantly so for <italic>adjSeg+2dLoess </italic>and <italic>ptl+movMed</italic>. In these cases, the small size of the data set (26 arrays, 6 with local spatial bias) affects the statistical power.</p>
        <p>Section 2 and 3 of the <xref ref-type="supplementary-material" rid="S1">Additional file 1</xref> and Tables 4 to 9 of the Additional files <xref ref-type="supplementary-material" rid="S2">2</xref> and <xref ref-type="supplementary-material" rid="S3">3</xref> detail and complement these results.</p>
        <p>These results show that the <italic>seg+2dLoess </italic>method outperforms the other methods on the two data sets produced on the Institut Curie, INSERM U509 platform. The results also allow the methods to be ranked in terms of performance. Those methods that include a two-dimensional LOESS step are the highest ranked, with the methods proposed by [<xref ref-type="bibr" rid="B11">11</xref>,<xref ref-type="bibr" rid="B10">10</xref>] and [<xref ref-type="bibr" rid="B20">20</xref>], which all include some spatial processing, being next, and the other methods being the lowest ranked (see Figure <xref ref-type="fig" rid="F7">7</xref> for example).</p>
      </sec>
    </sec>
  </sec>
  <sec>
    <title>Conclusion</title>
    <p>We have designed an efficient and automated algorithm for the spatial normalization of BAC array-CGH data, and defined a set of parameters for CGH array data quality assessment. We have shown that our method significantly improves the quality of data from two different BAC-array platforms and outperforms other normalization techniques on three data sets.</p>
    <p>The proposed algorithm is particularly suitable for correcting spatial effects not related to array design (row, column, or print-tip group effects): indeed, the arrays studied show two distinct types of such spatial effect (local spatial bias and continuous spatial gradients), which can simultaneously affect any given array. In such cases, using spatial trend correction after spatial segmentation helps to remove or reduce these two types of spatial effect, while preserving the true biological signal.</p>
    <p>This method is original in the application of a segmentation algorithm for detecting and removing local spatial bias, preventing the misinterpretation of experimental artifacts as biologically relevant outliers in the genomic profile.</p>
    <p>This method was developed for array-CGH experiments, and gave very good results. However, it can be applied to any microarray experiment having the same types of spatial effect.</p>
  </sec>
  <sec>
    <title>Availability and requirements</title>
    <p>Our method is implemented in the R package MANOR (Micro-Array NORmalization) [<xref ref-type="bibr" rid="B28">28</xref>], which is available from the Bioconductor site [<xref ref-type="bibr" rid="B29">29</xref>]. It can also be tested on the CAPweb bioinformatics platform [<xref ref-type="bibr" rid="B30">30</xref>,<xref ref-type="bibr" rid="B31">31</xref>].</p>
  </sec>
  <sec sec-type="methods">
    <title>Methods</title>
    <p>In this section, we provide details of the segmentation method and the other normalization techniques used for comparison, and of the quality criteria proposed. We also discuss the choice of the two parameters of the segmentation algorithm: <italic>K </italic>and <italic>β</italic>.</p>
    <sec>
      <title>Description of the segmentation algorithm (seg)</title>
      <p>The segmentation method consists of three steps:</p>
      <p>[step 1]: Estimation of a spatial trend on the array using two-dimensional LOESS regression [<xref ref-type="bibr" rid="B21">21</xref>,<xref ref-type="bibr" rid="B22">22</xref>]</p>
      <p>[step 2]: Segmentation of the array into spatial areas with similar trend values, using NEM, an unsupervised classification algorithm including spatial constraints [<xref ref-type="bibr" rid="B24">24</xref>,<xref ref-type="bibr" rid="B25">25</xref>]</p>
      <p>[step 3]: Identification of the areas affected by spatial bias.</p>
      <sec>
        <title>[step 1]: spatial trend estimation</title>
        <p>We decided to carry out spatial segmentation based on an estimate of the spatial trend on the array, to optimize the robustness of segmentation. Furthermore, estimation of this trend makes it possible to replace missing values by interpolating the spatial trend.</p>
        <p>The trend is estimated by means of a two-dimensional LOESS procedure with three iterative reweighting steps [<xref ref-type="bibr" rid="B21">21</xref>,<xref ref-type="bibr" rid="B22">22</xref>]. The local estimation is linear and the neighborhood taken into account to fit the local model corresponds to 3% of the total number of points. We use an iterative reweighting procedure to avoid outlier effects. Indeed, in the context of cancer studies, we are investigating changes in DNA copy number, and some clones displaying an amplification or a homozygous deletion may generate extreme but biologically meaningful values, which should not be interpreted as a local spatial bias.</p>
        <p>When the spatial trend is estimated from the log-ratios, we first apply a basic correction to these log-ratios to prevent confusion between spatial artifacts and biologically relevant effects. For each chromosome arm, <italic>centered </italic>log-ratios are calculated as follows: the median of the corresponding log-ratio values is calculated and then subtracted from the initial values. The spatial trend is estimated from these centered log-ratios. This method helps to decrease the impact of true genomic aberrations on the detection of spatial trends in the data, particularly for samples with many, or large genomic alterations, as most of these alterations correspond to the gain or loss of whole chromosome arms.</p>
      </sec>
      <sec>
        <title>[step 2]: spatial segmentation</title>
        <p>This step aims to identify <italic>K </italic>clusters corresponding to spots with similar signal levels located close together geographically. This is achieved by Neighborhood Expectation Maximization (NEM) [<xref ref-type="bibr" rid="B24">24</xref>,<xref ref-type="bibr" rid="B25">25</xref>]. We assume that the data are drawn from a mixed Gaussian density function <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M1" name="1471-2105-7-264-i3" overflow="scroll"><mml:semantics definitionURL="" encoding=""><mml:mrow><mml:mi>f</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>|</mml:mo><mml:mi>Φ</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mstyle displaystyle="true"><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>K</mml:mi></mml:msubsup><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:msub><mml:mi>f</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>|</mml:mo><mml:msub><mml:mi>θ</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:mrow><mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaqabeGadaaakeaacqWGMbGzcqGGOaakieqacqWF4baEdaWgaaWcbaGaemyAaKgabeaakiabcYha8HGabiab+z6agjabcMcaPiabg2da9maaqadabaGaemiCaa3aaSbaaSqaaiabdUgaRbqabaGccqWGMbGzdaWgaaWcbaGaem4AaSgabeaakiabcIcaOiab=Hha4naaBaaaleaacqWGPbqAaeqaaOGaeiiFaWhccmGae0hUde3aaSbaaSqaaiabdUgaRbqabaGccqGGPaqkaSqaaiabdUgaRjabg2da9iabigdaXaqaaiabdUealbqdcqGHris5aaaa@4CAE@</mml:annotation></mml:semantics></mml:math></inline-formula> where <italic>p</italic><sub><italic>k </italic></sub>are the proportions of the mixture model, <italic>f</italic><sub><italic>k </italic></sub>(<bold>x</bold><sub><italic>i</italic></sub>|<bold><italic>θ</italic></bold><sub><italic>k</italic></sub>) denotes the density function of a Gaussian distribution with parameter <bold><italic>θ</italic></bold><sub><italic>k </italic></sub>= (<bold><italic>μ</italic></bold><sub><italic>k</italic></sub>, <bold>Σ</bold><sub><italic>k</italic></sub>) and <bold>Φ </bold>= {<italic>p</italic><sub>1</sub>,..., <italic>p</italic><sub><italic>k </italic></sub>, <bold><italic>θ</italic></bold><sub>1</sub>,..., <bold><italic>θ</italic></bold><sub><italic>K</italic></sub>} is the set of parameters to be estimated. The classical EM algorithm considers the following decomposition of the likelihood:</p>
        <p>
          <inline-formula>
            <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M2" name="1471-2105-7-264-i4" overflow="scroll">
              <mml:semantics definitionURL="" encoding="">
                <mml:mrow>
                  <mml:mi>L</mml:mi>
                  <mml:mo stretchy="false">(</mml:mo>
                  <mml:mi>c</mml:mi>
                  <mml:mo>,</mml:mo>
                  <mml:mi>Φ</mml:mi>
                  <mml:mo stretchy="false">)</mml:mo>
                  <mml:mo>=</mml:mo>
                  <mml:mstyle displaystyle="true">
                    <mml:munderover>
                      <mml:mo>∑</mml:mo>
                      <mml:mrow>
                        <mml:mi>i</mml:mi>
                        <mml:mo>=</mml:mo>
                        <mml:mn>1</mml:mn>
                      </mml:mrow>
                      <mml:mi>N</mml:mi>
                    </mml:munderover>
                    <mml:mrow>
                      <mml:mstyle displaystyle="true">
                        <mml:munderover>
                          <mml:mo>∑</mml:mo>
                          <mml:mrow>
                            <mml:mi>k</mml:mi>
                            <mml:mo>=</mml:mo>
                            <mml:mn>1</mml:mn>
                          </mml:mrow>
                          <mml:mi>K</mml:mi>
                        </mml:munderover>
                        <mml:mrow>
                          <mml:msub>
                            <mml:mi>c</mml:mi>
                            <mml:mrow>
                              <mml:mi>i</mml:mi>
                              <mml:mi>k</mml:mi>
                            </mml:mrow>
                          </mml:msub>
                        </mml:mrow>
                      </mml:mstyle>
                      <mml:mi>log</mml:mi>
                      <mml:mo>⁡</mml:mo>
                      <mml:msub>
                        <mml:mi>p</mml:mi>
                        <mml:mi>k</mml:mi>
                      </mml:msub>
                      <mml:msub>
                        <mml:mi>f</mml:mi>
                        <mml:mi>k</mml:mi>
                      </mml:msub>
                      <mml:mo stretchy="false">(</mml:mo>
                      <mml:msub>
                        <mml:mi>x</mml:mi>
                        <mml:mi>i</mml:mi>
                      </mml:msub>
                      <mml:mo>|</mml:mo>
                      <mml:msub>
                        <mml:mi>θ</mml:mi>
                        <mml:mi>k</mml:mi>
                      </mml:msub>
                      <mml:mo stretchy="false">)</mml:mo>
                      <mml:mo>−</mml:mo>
                    </mml:mrow>
                  </mml:mstyle>
                  <mml:mstyle displaystyle="true">
                    <mml:munderover>
                      <mml:mo>∑</mml:mo>
                      <mml:mrow>
                        <mml:mi>i</mml:mi>
                        <mml:mo>=</mml:mo>
                        <mml:mn>1</mml:mn>
                      </mml:mrow>
                      <mml:mi>N</mml:mi>
                    </mml:munderover>
                    <mml:mrow>
                      <mml:mstyle displaystyle="true">
                        <mml:munderover>
                          <mml:mo>∑</mml:mo>
                          <mml:mrow>
                            <mml:mi>k</mml:mi>
                            <mml:mo>=</mml:mo>
                            <mml:mn>1</mml:mn>
                          </mml:mrow>
                          <mml:mi>K</mml:mi>
                        </mml:munderover>
                        <mml:mrow>
                          <mml:msub>
                            <mml:mi>c</mml:mi>
                            <mml:mrow>
                              <mml:mi>i</mml:mi>
                              <mml:mi>k</mml:mi>
                            </mml:mrow>
                          </mml:msub>
                        </mml:mrow>
                      </mml:mstyle>
                      <mml:mi>log</mml:mi>
                      <mml:mo>⁡</mml:mo>
                      <mml:msub>
                        <mml:mi>c</mml:mi>
                        <mml:mrow>
                          <mml:mi>i</mml:mi>
                          <mml:mi>k</mml:mi>
                        </mml:mrow>
                      </mml:msub>
                    </mml:mrow>
                  </mml:mstyle>
                  <mml:mtext>     </mml:mtext>
                  <mml:mrow>
                    <mml:mo>(</mml:mo>
                    <mml:mn>1</mml:mn>
                    <mml:mo>)</mml:mo>
                  </mml:mrow>
                </mml:mrow>
                <mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaqabeGadaaakeaacqWGmbatcqGGOaakieqacqWFJbWycqGGSaaliiqacqGFMoGrcqGGPaqkcqGH9aqpdaaeWbqaamaaqahabaGaem4yam2aaSbaaSqaaiabdMgaPjabdUgaRbqabaaabaGaem4AaSMaeyypa0JaeGymaedabaGaem4saSeaniabggHiLdGccyGGSbaBcqGGVbWBcqGGNbWzcqWGWbaCdaWgaaWcbaGaem4AaSgabeaakiabdAgaMnaaBaaaleaacqWGRbWAaeqaaOGaeiikaGIae8hEaG3aaSbaaSqaaiabdMgaPbqabaGccqGG8baFiiWacqqF4oqCdaWgaaWcbaGaem4AaSgabeaakiabcMcaPiabgkHiTaWcbaGaemyAaKMaeyypa0JaeGymaedabaGaemOta4eaniabggHiLdGcdaaeWbqaamaaqahabaGaem4yam2aaSbaaSqaaiabdMgaPjabdUgaRbqabaaabaGaem4AaSMaeyypa0JaeGymaedabaGaem4saSeaniabggHiLdGccyGGSbaBcqGGVbWBcqGGNbWzcqWGJbWydaWgaaWcbaGaemyAaKMaem4AaSgabeaaaeaacqWGPbqAcqGH9aqpcqaIXaqmaeaacqWGobGta0GaeyyeIuoakiaaxMaacaWLjaWaaeWaaeaacqaIXaqmaiaawIcacaGLPaaaaaa@7811@</mml:annotation>
              </mml:semantics>
            </mml:math>
          </inline-formula>
        </p>
        <p>where</p>
        <p>
          <inline-formula>
            <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M3" name="1471-2105-7-264-i5" overflow="scroll">
              <mml:semantics definitionURL="" encoding="">
                <mml:mrow>
                  <mml:msub>
                    <mml:mi>c</mml:mi>
                    <mml:mrow>
                      <mml:mi>i</mml:mi>
                      <mml:mi>k</mml:mi>
                    </mml:mrow>
                  </mml:msub>
                  <mml:mo>=</mml:mo>
                  <mml:mfrac>
                    <mml:mrow>
                      <mml:msub>
                        <mml:mi>p</mml:mi>
                        <mml:mi>k</mml:mi>
                      </mml:msub>
                      <mml:msub>
                        <mml:mi>f</mml:mi>
                        <mml:mi>k</mml:mi>
                      </mml:msub>
                      <mml:mo stretchy="false">(</mml:mo>
                      <mml:msub>
                        <mml:mi>x</mml:mi>
                        <mml:mi>i</mml:mi>
                      </mml:msub>
                      <mml:mo>|</mml:mo>
                      <mml:msub>
                        <mml:mi>θ</mml:mi>
                        <mml:mi>k</mml:mi>
                      </mml:msub>
                      <mml:mo stretchy="false">)</mml:mo>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mi>f</mml:mi>
                      <mml:mo stretchy="false">(</mml:mo>
                      <mml:msub>
                        <mml:mi>x</mml:mi>
                        <mml:mi>i</mml:mi>
                      </mml:msub>
                      <mml:mo stretchy="false">)</mml:mo>
                    </mml:mrow>
                  </mml:mfrac>
                  <mml:mtext> </mml:mtext>
                  <mml:mtext> </mml:mtext>
                  <mml:mtext>and</mml:mtext>
                  <mml:mtext> </mml:mtext>
                  <mml:mtext> </mml:mtext>
                  <mml:mi>c</mml:mi>
                  <mml:mo>=</mml:mo>
                  <mml:mo stretchy="false">(</mml:mo>
                  <mml:msub>
                    <mml:mi>c</mml:mi>
                    <mml:mrow>
                      <mml:mi>i</mml:mi>
                      <mml:mi>k</mml:mi>
                    </mml:mrow>
                  </mml:msub>
                  <mml:mo stretchy="false">)</mml:mo>
                  <mml:mtext>     </mml:mtext>
                  <mml:mrow>
                    <mml:mo>(</mml:mo>
                    <mml:mn>2</mml:mn>
                    <mml:mo>)</mml:mo>
                  </mml:mrow>
                </mml:mrow>
                <mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaqabeGadaaakeaacqWGJbWydaWgaaWcbaGaemyAaKMaem4AaSgabeaakiabg2da9maalaaabaGaemiCaa3aaSbaaSqaaiabdUgaRbqabaGccqWGMbGzdaWgaaWcbaGaem4AaSgabeaakiabcIcaOGqabiab=Hha4naaBaaaleaacqWGPbqAaeqaaOGaeiiFaWhcciGae4hUde3aaSbaaSqaaiabdUgaRbqabaGccqGGPaqkaeaacqWGMbGzcqGGOaakcqWF4baEdaWgaaWcbaGaemyAaKgabeaakiabcMcaPaaacaaMc8UaaGPaVlabbggaHjabb6gaUjabbsgaKjaaykW7caaMc8Uae83yamMaeyypa0JaeiikaGIaem4yam2aaSbaaSqaaiabdMgaPjabdUgaRbqabaGccqGGPaqkcaWLjaGaaCzcamaabmaabaGaeGOmaidacaGLOaGaayzkaaaaaa@5DB1@</mml:annotation>
              </mml:semantics>
            </mml:math>
          </inline-formula>
        </p>
        <p>In the mixture model context, [<xref ref-type="bibr" rid="B32">32</xref>] pointed out that the EM algorithm is formally equivalent to the alternative maximization of <italic>L </italic>(<bold>c</bold>, <bold>Φ</bold>) with respect to <bold>c </bold>("E" step) and with respect to <bold>Φ </bold>("M" step). The NEM algorithm is original in that it regularizes the likelihood by means of a term that takes into account the spatial dimension of the problem through the following adjacency matrix:</p>
        <p>
          <inline-formula>
            <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M4" name="1471-2105-7-264-i6" overflow="scroll">
              <mml:semantics definitionURL="" encoding="">
                <mml:mrow>
                  <mml:msub>
                    <mml:mi>v</mml:mi>
                    <mml:mrow>
                      <mml:mi>i</mml:mi>
                      <mml:mi>j</mml:mi>
                    </mml:mrow>
                  </mml:msub>
                  <mml:mo>=</mml:mo>
                  <mml:mrow>
                    <mml:mo>{</mml:mo>
                    <mml:mrow>
                      <mml:mtable columnalign="left">
                        <mml:mtr columnalign="left">
                          <mml:mtd columnalign="left">
                            <mml:mn>1</mml:mn>
                          </mml:mtd>
                          <mml:mtd columnalign="left">
                            <mml:mrow>
                              <mml:mtext>if </mml:mtext>
                              <mml:mi>i</mml:mi>
                              <mml:mtext> and </mml:mtext>
                              <mml:mi>j</mml:mi>
                              <mml:mtext> are neighbors</mml:mtext>
                            </mml:mrow>
                          </mml:mtd>
                        </mml:mtr>
                        <mml:mtr columnalign="left">
                          <mml:mtd columnalign="left">
                            <mml:mn>0</mml:mn>
                          </mml:mtd>
                          <mml:mtd columnalign="left">
                            <mml:mrow>
                              <mml:mtext>otherwise</mml:mtext>
                            </mml:mrow>
                          </mml:mtd>
                        </mml:mtr>
                      </mml:mtable>
                    </mml:mrow>
                  </mml:mrow>
                </mml:mrow>
                <mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaqabeGadaaakeaacqWG2bGDdaWgaaWcbaGaemyAaKMaemOAaOgabeaakiabg2da9maaceaabaqbaeaabiGaaaqaaiabigdaXaqaaiabbMgaPjabbAgaMjabbccaGGqaciab=LgaPjabbccaGiabbggaHjabb6gaUjabbsgaKjabbccaGiab=PgaQjabbccaGiabbggaHjabbkhaYjabbwgaLjabbccaGiabb6gaUjabbwgaLjabbMgaPjabbEgaNjabbIgaOjabbkgaIjabb+gaVjabbkhaYjabbohaZbqaaiabicdaWaqaaiabb+gaVjabbsha0jabbIgaOjabbwgaLjabbkhaYjabbEha3jabbMgaPjabbohaZjabbwgaLbaaaiaawUhaaaaa@5F1A@</mml:annotation>
              </mml:semantics>
            </mml:math>
          </inline-formula>
        </p>
        <p>Here, the neighbors of a point located at coordinates (<italic>l</italic>, <italic>m </italic>) are the four points with the following coordinates: (<italic>l </italic>+1, <italic>m</italic>), (<italic>l </italic>- 1, <italic>m</italic>), (<italic>l</italic>, <italic>m </italic>- 1). We define the following quantity:</p>
        <p>
          <inline-formula>
            <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M5" name="1471-2105-7-264-i7" overflow="scroll">
              <mml:semantics definitionURL="" encoding="">
                <mml:mrow>
                  <mml:mi>G</mml:mi>
                  <mml:mo stretchy="false">(</mml:mo>
                  <mml:mi>c</mml:mi>
                  <mml:mo stretchy="false">)</mml:mo>
                  <mml:mo>=</mml:mo>
                  <mml:mfrac>
                    <mml:mn>1</mml:mn>
                    <mml:mn>2</mml:mn>
                  </mml:mfrac>
                  <mml:mstyle displaystyle="true">
                    <mml:munderover>
                      <mml:mo>∑</mml:mo>
                      <mml:mrow>
                        <mml:mi>i</mml:mi>
                        <mml:mo>=</mml:mo>
                        <mml:mn>1</mml:mn>
                      </mml:mrow>
                      <mml:mi>N</mml:mi>
                    </mml:munderover>
                    <mml:mrow>
                      <mml:mstyle displaystyle="true">
                        <mml:munderover>
                          <mml:mo>∑</mml:mo>
                          <mml:mrow>
                            <mml:mi>j</mml:mi>
                            <mml:mo>=</mml:mo>
                            <mml:mn>1</mml:mn>
                          </mml:mrow>
                          <mml:mi>N</mml:mi>
                        </mml:munderover>
                        <mml:mrow>
                          <mml:mstyle displaystyle="true">
                            <mml:munderover>
                              <mml:mo>∑</mml:mo>
                              <mml:mrow>
                                <mml:mi>k</mml:mi>
                                <mml:mo>=</mml:mo>
                                <mml:mn>1</mml:mn>
                              </mml:mrow>
                              <mml:mi>K</mml:mi>
                            </mml:munderover>
                            <mml:mrow>
                              <mml:msub>
                                <mml:mi>c</mml:mi>
                                <mml:mrow>
                                  <mml:mi>i</mml:mi>
                                  <mml:mi>k</mml:mi>
                                </mml:mrow>
                              </mml:msub>
                              <mml:msub>
                                <mml:mi>c</mml:mi>
                                <mml:mrow>
                                  <mml:mi>j</mml:mi>
                                  <mml:mi>k</mml:mi>
                                </mml:mrow>
                              </mml:msub>
                              <mml:msub>
                                <mml:mi>v</mml:mi>
                                <mml:mrow>
                                  <mml:mi>i</mml:mi>
                                  <mml:mi>j</mml:mi>
                                </mml:mrow>
                              </mml:msub>
                            </mml:mrow>
                          </mml:mstyle>
                        </mml:mrow>
                      </mml:mstyle>
                    </mml:mrow>
                  </mml:mstyle>
                  <mml:mtext>     </mml:mtext>
                  <mml:mrow>
                    <mml:mo>(</mml:mo>
                    <mml:mn>3</mml:mn>
                    <mml:mo>)</mml:mo>
                  </mml:mrow>
                </mml:mrow>
                <mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaqabeGadaaakeaacqWGhbWrcqGGOaakieqacqWFJbWycqGGPaqkcqGH9aqpdaWcaaqaaiabigdaXaqaaiabikdaYaaadaaeWbqaamaaqahabaWaaabCaeaacqWGJbWydaWgaaWcbaGaemyAaKMaem4AaSgabeaakiabdogaJnaaBaaaleaacqWGQbGAcqWGRbWAaeqaaOGaemODay3aaSbaaSqaaiabdMgaPjabdQgaQbqabaaabaGaem4AaSMaeyypa0JaeGymaedabaGaem4saSeaniabggHiLdaaleaacqWGQbGAcqGH9aqpcqaIXaqmaeaacqWGobGta0GaeyyeIuoaaSqaaiabdMgaPjabg2da9iabigdaXaqaaiabd6eaobqdcqGHris5aOGaaCzcaiaaxMaadaqadaqaaiabiodaZaGaayjkaiaawMcaaaaa@5883@</mml:annotation>
              </mml:semantics>
            </mml:math>
          </inline-formula>
        </p>
        <p>Thus, instead of maximizing <italic>L </italic>(<bold>c</bold>, <bold>Φ </bold>) in the E step, we maximize <italic>L </italic>(<bold>c</bold>, <bold>Φ</bold>) + <italic>βG </italic>(<bold>c</bold>). The value of <italic>β </italic>controls the weighting of the geographical context in the maximization. The M step remains unchanged.</p>
      </sec>
      <sec>
        <title>[step 3]: elimination of local spatial bias</title>
        <p>The basic idea is to remove from the array those spatial clusters with signal values significantly higher (or lower) than the unbiased areas of the array. We describe here the situation for positive spatial bias, but the idea can be adapted to negative bias. As local spatial biases cover a limited proportion of the array, we introduced a tuning parameter <italic>p</italic><sub><italic>max</italic></sub>, which corresponds to the maximum proportion of the array image corresponding to local spatial bias. In our experiment, local spatial bias typically applies to less than one quarter of the array, so we used <italic>p</italic><sub><italic>max </italic></sub>= 0.25.</p>
        <p>After sorting the clusters identified by NEM by decreasing mean signal, we consider only those clusters with cumulative frequencies lower than <italic>p</italic><sub><italic>max </italic></sub>to be potentially biased, making it possible to define a set of candidate clusters. The mean signal value of the remaining clusters is used as a reference value for the unbiased signal. Each candidate cluster with a mean signal differing from this reference value by more than a given threshold value is considered biased. The other candidates are considered unbiased, unless their mean signal is closer to that of the biased cluster than to that of the reference: such clusters are also considered biased. This threshold was chosen based on the cross-validation of arrays analyzed by experts.</p>
      </sec>
    </sec>
    <sec>
      <title>Comparison to other normalization methods</title>
      <p>We compared the described methodology with other classical normalization methods. All these methods are listed below:</p>
      <p>- <italic>A print-tip group method:</italic></p>
      <p><bold>block (block normalization): </bold>we subtract off the row and column block median log-ratio values for each spot, and adds back the overall block median log-ratio value.</p>
      <p>- <italic>A print-tip group with intensity dependent effect method:</italic></p>
      <p><bold>ptl (print-tip loess): </bold>we apply the print-tip LOESS normalization [<xref ref-type="bibr" rid="B10">10</xref>] method using the marray R package (1.8.0 release, with default parameters) available from Bioconductor.</p>
      <p>- <italic>A spatial smoothing method:</italic></p>
      <p><bold>2dLoess (correction of continuous spatial gradients): </bold>a spatial trend is estimated by two-dimensional LOESS [<xref ref-type="bibr" rid="B21">21</xref>,<xref ref-type="bibr" rid="B22">22</xref>], which is then substrated from the log-ratio values.</p>
      <p>- <italic>Two spatial segmentation methods:</italic></p>
      <p><bold>seg (segmentation of local spatial bias): </bold>we apply the spatial segmentation algorithm described above to automatically eliminate the biased area.</p>
      <p><bold>adjSeg (correction of local spatial bias): </bold>we apply the spatial segmentation algorithm to automatically delineate the biased area. The median log-ratio value of such an area is then adjusted to the median log-ratio value of the unbiased area.</p>
      <p>- <italic>A method combining print-tip group and spatial smoothing:</italic></p>
      <p><bold>block+2dLoess (block normalization and global correction): </bold>we apply the <italic>2dLoess </italic>method on the normalized log-ratio values obtained with <italic>block</italic>.</p>
      <p>- <italic>Two methods combining intensity dependent effect and spatial smoothing:</italic></p>
      <p><bold>nnNorm (neural network normalization): </bold>we apply the normalization method described by Tarca <italic>et al</italic>. [<xref ref-type="bibr" rid="B20">20</xref>] using the nnNorm R package (1.5.1 release, with default parameters) available from Bioconductor. Briefly, this technique uses a neural network approach to correct the intensity-dependent and spatially-dependent effects.</p>
      <p><bold>ptl+movMed (print-tip loess and moving median filter): </bold>Khojasteh <italic>et al</italic>. [<xref ref-type="bibr" rid="B11">11</xref>] compared different normalization methods and suggested that combining the print-tip LOESS method with spatial correction (using a moving median calculated over a neighborhood of 11 rows by 11 columns) and microplate correction gave the best results. As the microplate information was not available in our data, we discarded the third step and only considered the print-tip LOESS and spatial correction.</p>
      <p>- <italic>Two methods combining spatial segmentation and spatial smoothing:</italic></p>
      <p><bold>adjSeg+2dLoess (correction of local spatial bias and continuous spatial gradients): </bold>we apply the <italic>2dLoess </italic>method on the normalized log-ratio values obtained with the <italic>adjSeg </italic>method.</p>
      <p><bold>seg+2dLoess (local segmentation and correction of continuous spatial gradients): </bold>we apply the <italic>2dLoess </italic>method on the log-ratio obtained with the <italic>seg </italic>method.</p>
      <p>- Raw log-ratio values with no normalization (<bold>none</bold>).</p>
    </sec>
    <sec>
      <title>Array-CGH data quality assessment</title>
      <sec>
        <title>Definition of quality criteria</title>
        <p>Evaluation of the quality of the signal ratios of an array facilitates the comparison of different image analyses or normalization algorithms, and makes it possible to quantify the improvement achieved by each step of a given normalization algorithm. We define three criteria for assessing the quality of the analyzed array: the first addresses the issue of overall quality whereas the other two provide quality evaluations for the estimation of differences in DNA copy number between test and reference samples.</p>
        <p><italic>sigma </italic>The first item provides an estimate of experimental noise. We isolate each clone and calculate the standard deviation of the log-ratio of the corresponding replicates. <italic>sigma </italic>is defined as the median of these standard deviations: the smaller the value of <italic>sigma</italic>, the higher the quality of the array.</p>
        <p>The other two criteria are calculated after detection of the altered (gained or lost) regions in the test sample. We used the GLAD algorithm, developed by Hupé <italic>et al</italic>. [<xref ref-type="bibr" rid="B4">4</xref>] for this purpose:</p>
        <p><italic>smt </italic>Within a given DNA copy number region, the ratios of contiguous clones should not differ considerably. The second quality criterion concerns the <italic>smoothness </italic>of the signal log-ratios within such a chromosomal region: signal smoothness is defined as the median absolute difference between log-ratios for contiguous normal clones. If <italic>N </italic>denotes the set of clones considered normal after DNA copy number estimation, we can calculate</p>
        <p><italic>smt </italic>= median<sub><italic>n</italic>∈<italic>N</italic></sub>|<italic>x</italic><sub>(<italic>n</italic>) </sub>- <italic>x</italic><sub>(<italic>n </italic>-1)</sub>|,</p>
        <p>where <italic>x</italic><sub>(<italic>n</italic>) </sub>is the value of the log-ratio at the <italic>n</italic><sup>th </sup>clone in genome order.</p>
        <p><italic>dyn </italic>The last criterion estimates the <italic>dynamics </italic>of DNA copy number variation between test and reference samples. We calculate the discrepancy between the median ratios of the regions considered "gained"(<italic>G</italic>) and "normal"(<italic>N</italic>) after DNA copy number estimation, and compare it with signal smoothness, as measured by <italic>smt</italic>:</p>
        <p>
          <inline-formula>
            <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M6" name="1471-2105-7-264-i8" overflow="scroll">
              <mml:semantics definitionURL="" encoding="">
                <mml:mrow>
                  <mml:mi>d</mml:mi>
                  <mml:mi>y</mml:mi>
                  <mml:mi>n</mml:mi>
                  <mml:mo>=</mml:mo>
                  <mml:mfrac>
                    <mml:mrow>
                      <mml:msub>
                        <mml:mrow>
                          <mml:mtext>median</mml:mtext>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mi>g</mml:mi>
                          <mml:mo>∈</mml:mo>
                          <mml:mi>G</mml:mi>
                        </mml:mrow>
                      </mml:msub>
                      <mml:msub>
                        <mml:mi>x</mml:mi>
                        <mml:mi>g</mml:mi>
                      </mml:msub>
                      <mml:mo>−</mml:mo>
                      <mml:msub>
                        <mml:mrow>
                          <mml:mtext>median</mml:mtext>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mi>n</mml:mi>
                          <mml:mo>∈</mml:mo>
                          <mml:mi>N</mml:mi>
                        </mml:mrow>
                      </mml:msub>
                      <mml:msub>
                        <mml:mi>x</mml:mi>
                        <mml:mi>n</mml:mi>
                      </mml:msub>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mi>s</mml:mi>
                      <mml:mi>m</mml:mi>
                      <mml:mi>t</mml:mi>
                    </mml:mrow>
                  </mml:mfrac>
                </mml:mrow>
                <mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaqabeGadaaakeaacqWGKbazcqWG5bqEcqWGUbGBcqGH9aqpdaWcaaqaaiabb2gaTjabbwgaLjabbsgaKjabbMgaPjabbggaHjabb6gaUnaaBaaaleaacqWGNbWzcqGHiiIZcqWGhbWraeqaaOGaemiEaG3aaSbaaSqaaiabdEgaNbqabaGccqGHsislcqqGTbqBcqqGLbqzcqqGKbazcqqGPbqAcqqGHbqycqqGUbGBdaWgaaWcbaGaemOBa4MaeyicI4SaemOta4eabeaakiabdIha4naaBaaaleaacqWGUbGBaeqaaaGcbaGaem4CamNaemyBa0MaemiDaqhaaaaa@55B5@</mml:annotation>
              </mml:semantics>
            </mml:math>
          </inline-formula>
        </p>
        <p>If no gained region is detected, we compare "normal" regions with "lost"(<italic>L</italic>) regions.</p>
        <p><italic>smt </italic>and <italic>dyn </italic>are not independent parameters and are anticorrelated. However, they quantify related but different ideas, as <italic>smt </italic>estimates the noise level after data normalization whereas <italic>dyn </italic>measures the ability to detect genome alterations after data normalization.</p>
      </sec>
      <sec>
        <title>Paiwise comparison of quality criteria</title>
        <p>These three criteria help us to decide which of two normalization methods gives the best results for a given array. In this pairwise comparison context, <italic>smt </italic>and <italic>dyn </italic>must be calculated with the same definition of <italic>G</italic>, <italic>N</italic>, and <italic>L </italic>regions for the two normalized arrays. We therefore define consensus <italic>G</italic>, <italic>N</italic>, and <italic>L </italic>regions associated with an array processed with two different normalization methods as the intersection of the two corresponding <italic>G</italic>, <italic>N</italic>, and <italic>L </italic>regions obtained using the two different normalization methods.</p>
        <p>In order to test whether method <italic>j </italic>is better than method <italic>i</italic>, we defined a relative performance for each quality criterion as follows:</p>
        <p>
          <inline-graphic xlink:href="1471-2105-7-264-i9.gif"/>
        </p>
        <p>We calculated this relative performance for each array, and assessed its significance by testing the hypotheses <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M7" name="1471-2105-7-264-i2" overflow="scroll"><mml:semantics definitionURL="" encoding=""><mml:mrow><mml:msub><mml:mi>ℋ</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBamrtHrhAL1wy0L2yHvtyaeHbnfgDOvwBHrxAJfwnaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaWaaeGaeaaakeaaimaacqWFlecsdaWgaaWcbaacbiGae4xAaKgcbaGae0hlaWIae4NAaOgabeaaaaa@3B2C@</mml:annotation></mml:semantics></mml:math></inline-formula>: {<italic>RP</italic><sup><italic>qc</italic></sup>(<italic>i,j</italic>) &lt; 0} for each quality criterion <italic>qc</italic>, using a Student's unilateral t-test.</p>
        <p>In figures <xref ref-type="fig" rid="F4">4</xref>, <xref ref-type="fig" rid="F7">7</xref>, and <xref ref-type="fig" rid="F8">8</xref>, we calculated relative performances <italic>RP</italic>(<italic>seg+2dLoess</italic>, <italic>test</italic>) where <italic>test </italic>corresponds to one of the ten other methods. Hence a <italic>negative value </italic>for <italic>RP </italic>(<italic>seg+2dLoess</italic>, <italic>test</italic>) indicates that our proposed method outperforms the <italic>test </italic>method.</p>
      </sec>
    </sec>
    <sec>
      <title>Parameter choice for the segmentation algorithm</title>
      <p>The segmentation algorithm includes two parameters: the number <italic>K </italic>of clusters, and the regularization parameter <italic>β</italic>, which controls the weighting of geographic context in signal segmentation. Our experience suggests that the optimal choice of <italic>K </italic>and <italic>β </italic>may depend on the array-CGH technology used. We therefore provide guidelines for the choice of suitable parameters of the algorithm. We have investigated two different approaches to the choice of (<italic>K</italic>, <italic>β</italic>): incorporating a model selection criterion into the algorithm so that an optimal (<italic>K</italic>, <italic>β</italic>) can be chosen <italic>for each array</italic>, or developing a calibration method to help the user to find relevant sets of parameters for analyzing <italic>a whole data set</italic>. In this section, we discuss these two approaches and justify our choice of the second solution.</p>
      <sec>
        <title>The difficulty finding optimal parameters on a per array basis</title>
        <p>Choice of the number <italic>K </italic>of components in a mixture model can be addressed using model selection criteria. The basic idea is as follows: as the maximum likelihood estimator of the model increases mechanically with <italic>K </italic>(as model complexity increases with <italic>K</italic>), this method subtracts an increasing function of <italic>K </italic>from the likelihood of the model with <italic>K </italic>components, to prevent model overfitting. Many applications use the Akaike Information Criterion (AIC) or the Bayesian Information Criterion (BIC) for this purpose. However, in our framework, <italic>K </italic>and <italic>β </italic>must be chosen simultaneously, because <italic>β </italic>also affects the maximum likelihood estimator. As we have no information concerning the quantitative behavior of the maximum likelihood estimator with respect to <italic>K </italic>and <italic>β </italic>(this complex question is beyond the scope of this paper), the choice of an appropriate penalization remains arbitrary.</p>
        <p>We also considered an approach involving the fitting of <italic>K </italic>using model selection criteria and cross-validating the choice of <italic>β</italic>, but this approach has major drawbacks: first, it strongly increases the complexity of the estimation process, making this method too time-consuming for use as a routine normalization method; second, it makes the normalization method difficult to interpret, because two arrays from the same platform will not be treated with the same parameters.</p>
      </sec>
      <sec>
        <title>Guidelines for choosing relevant parameters for analyzing a new data set</title>
        <p>Rather than searching for optimal (<italic>K</italic>, <italic>β</italic>) values for each array, we provide a calibration method making it possible to choose appropriate (<italic>K</italic>, <italic>β</italic>) values for each data set. The basic principle of the calibration method is comparison of the output of our algorithm run on different (<italic>K</italic>, <italic>β</italic>) pairs, taken from a pre-defined grid (e. g. <italic>K </italic>∈ {2,... 10} and <italic>β </italic>∈ {0.1,0.2,...2.0}).</p>
        <p>We considered two different approaches to compare the results of the segmentations and to choose appropriate (<italic>K</italic>, <italic>β</italic>) values. The first approach involved choosing a (<italic>K</italic>, <italic>β</italic>) combination that optimizes quality criteria. The second involves expert assessment. An expert examines each array from a representative set and determines whether there is local spatial bias: he or she checks both the array image and the genomic profile to guarantee that the spatial effect is due to an experimental artifact rather than a biological effect. We then select the (<italic>K</italic>, <italic>β</italic>) combination that gives the best agreement between the expert decision and the algorithm decision. We call this second approach <italic>expert assessment</italic>. We found this second method simpler and more efficient than the first, for a number of reasons, outlined below.</p>
        <p>In the first approach, quality criteria are calculated after normalization and DNA copy number assessment, so these three steps have to be carried out for each (<italic>K</italic>, <italic>β</italic>) combination. Therefore, although this method has the obvious advantage of not relying on expert assessment, it is time-consuming, and provides only indirect evaluations of the differences between pairs of parameters, which may make the results hard to interpret. Moreover, a much lower level of variation was observed in the values of quality criteria for different (<italic>K</italic>, <italic>β</italic>) combinations for a given array than between arrays, so we were unable to identify optimal (<italic>K</italic>, <italic>β</italic>) values with this method (data not shown).</p>
        <p>In the second approach, we considered two different ways of performing the expert assessment: either identifying arrays displaying local spatial bias (qualitative assessment), or estimating the number of spots that should be discarded (quantitative assessment). We found quantitative assessment to be very poorly reproducible, with large differences between experts, and much more time-consuming than the qualitative method. Therefore, we adopted the qualitative method, which made possible the rapid expert assessment of a larger number of arrays, thus increasing the accuracy of parameter choice.</p>
        <p>Based on the qualitative expert assessment of an entire data set or a subset of data, we compare, for each array, the decision of our algorithm (has the algorithm detected a local spatial bias?) with that of the expert. We then calculate the proportion of false positives and false negatives for each combination of the parameters <italic>K </italic>∈ {2,...10} and <italic>β </italic>∈ {0.1, 0.2,... 2.0}. Qualitative expert assessment remains highly variable (significant differences between experts), as a substantial proportion of arrays are difficult to classify. Nevertheless, all assessments show the same form of dependence in the error rate in (<italic>K</italic>, <italic>β</italic>), and lead to selection of the same parameters (data not shown).</p>
        <p>For illustration, we use a subset of arrays on which two different expert assessments agree. The analysis is shown in Figure <xref ref-type="fig" rid="F9">9</xref> for breast cancer data (134/179 arrays), and Figure <xref ref-type="fig" rid="F10">10</xref> for bladder cancer data (169/198 arrays). False positives are arrays that experts identified as having no local spatial bias, but which were identified by the algorithm as having local spatial bias. False negatives are arrays that the expert considered to contain local spatial bias, and for which no such areas were reported by the algorithm. Roughly speaking, <italic>K </italic>controls cluster size, and <italic>β </italic>influences both the size and spatial coherence of the clusters. As <italic>K </italic>increases (with fixed <italic>β</italic>), clusters tend to shrink, leading to an increase in the mean signal value of the highest cluster, making it more likely that this cluster will be identified as a local spatial bias. For fixed <italic>K</italic>, the highest cluster is slightly more likely to be detected as local spatial bias for intermediate <italic>β</italic>, corresponding to an extreme cluster with high, homogenous values: for low <italic>β </italic>this cluster is often quite large and incorporates too small signal values, whereas for very high <italic>β</italic>, the geographic context is too strong, leading to a highest cluster with heterogeneous signal values.</p>
        <p>Drawing figures such as Figure <xref ref-type="fig" rid="F9">9</xref> or <xref ref-type="fig" rid="F10">10</xref> for any new data set can facilitate the identification of relevant sets of parameters for the segmentation algorithm. In our case, they suggest values of <italic>K </italic>= 5 and <italic>β </italic>between 0.9 and 1.3 for bladder cancer data set, and <italic>K </italic>= 7 or 8 and <italic>β </italic>between 0.9 and 1.3 for breast cancer data set. We used <italic>K </italic>= 5, <italic>β </italic>= 1 for the bladder cancer data set, and <italic>K </italic>= 7, <italic>β </italic>= 1 for the breast cancer data set.</p>
      </sec>
    </sec>
  </sec>
  <sec>
    <title>Authors' contributions</title>
    <p>PH and EB designed the study. PN and PH designed, coded and validated the spatial normalization algorithm. IB designed and coded the quality criteria. SL performed data integration. PH, PN, IB and EB drafted the manuscript. EM, CB, FR and AA performed the microarray experiments and validated the spatial normalization algorithm. FR, AA and EB supervised the study. All authors read and approved the final manuscript.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material content-type="local-data" id="S1">
      <caption>
        <title>Additional File 1</title>
        <p><bold>Comparison of method seg+2dLoess with 10 alternative normalization methods</bold>. We compared the method (<italic>seg+2dLoess</italic>) to ten methods for three quality criteria: <italic>sigma</italic>, <italic>smt </italic>and <italic>dyn</italic>. All images can be described as follows. Each color corresponds to the comparison of <italic>seg+2dLoess </italic>with a different method. The proposed method is taken as a reference (red point 1 at (0, 0)). For each method <italic>i</italic>, the cross indicates the mean relative performance on the data set for the two quality criteria compared, and the lines give the corresponding 95% quantile of the relative performance. The proposed method significantly outperforms, for the quality criterion shown in the y axis (at level 5%), all methods with a 95% quantile below the horizontal dashed black line. Similarly, the proposed method significantly outperformed, for the quality criterion shown in the x axis (at level 5%), all methods with a 95% quantile left of the vertical dashed black line. On most images, methods 2, 3, and 4, which contain a gradient subtraction step using 2<italic>dLoess</italic>, perform the best against <italic>seg+2dLoess</italic>, as they cluster near the top-right corner of the image. However, <italic>seg+2dLoess </italic>still significantly outperforms them for <italic>sigma</italic>, <italic>smt </italic>and <italic>dyn</italic>.</p>
      </caption>
      <media xlink:href="1471-2105-7-264-S1.pdf" mimetype="application" mime-subtype="pdf">
        <caption>
          <p>Click here for file</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="S2">
      <caption>
        <title>Additional File 2</title>
        <p><bold><italic>p</italic>-values of the relative performances of 11 normalization methods</bold>. We compare the results of 11 normalization methods on 3 data sets. Each table gives the significance levels of all pairwise comparisons between these 11 methods, for a given data set and a given quality measurement (<italic>sigma</italic>, <italic>smt</italic>, <italic>dyn</italic>). We calculated a relative performance for each array (as explained in the Methods section), and assessed its significance by testing the hypotheses <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M8" name="1471-2105-7-264-i1" overflow="scroll"><mml:semantics definitionURL="" encoding=""><mml:mrow><mml:msubsup><mml:mi>ℋ</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mi>q</mml:mi><mml:mi>c</mml:mi></mml:mrow></mml:msubsup></mml:mrow><mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBamrtHrhAL1wy0L2yHvtyaeHbnfgDOvwBHrxAJfwnaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaWaaeGaeaaakeaaimaacqWFlecsdaqhaaWcbaacbiGae4xAaKMae4hlaWIae4NAaOgabaGae4xCaeNae43yamgaaaaa@3DD5@</mml:annotation></mml:semantics></mml:math></inline-formula>: {<italic>RP<sup>qc</sup></italic>(<italic>i</italic>, <italic>j</italic>) &lt; 0} for each quality criterion <italic>qc</italic>, using a Student's unilateral t-test. The <italic>p</italic>-value associated to <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M9" name="1471-2105-7-264-i2" overflow="scroll"><mml:semantics definitionURL="" encoding=""><mml:mrow><mml:msub><mml:mi>ℋ</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBamrtHrhAL1wy0L2yHvtyaeHbnfgDOvwBHrxAJfwnaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaWaaeGaeaaakeaaimaacqWFlecsdaWgaaWcbaacbiGae4xAaKgcbaGae0hlaWIae4NAaOgabeaaaaa@3B2C@</mml:annotation></mml:semantics></mml:math></inline-formula> is reported in cell (<italic>i</italic>, <italic>j</italic>).</p>
      </caption>
      <media xlink:href="1471-2105-7-264-S2.pdf" mimetype="application" mime-subtype="pdf">
        <caption>
          <p>Click here for file</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="S3">
      <caption>
        <title>Additional File 3</title>
        <p><bold>Estimates of the relative performances of 11 normalization methods</bold>. We compare the results of 11 normalization methods on 3 data sets. Each table gives the estimates of relative performance of all pairs of methods, for a given data set and a given quality measurement (<italic>sigma</italic>, <italic>smt</italic>, <italic>dyn</italic>). We calculated a relative performance for each array, and reported the mean value across all arrays of a given project in the following tables.</p>
      </caption>
      <media xlink:href="1471-2105-7-264-S3.pdf" mimetype="application" mime-subtype="pdf">
        <caption>
          <p>Click here for file</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <ack>
    <sec>
      <title>Acknowledgements</title>
      <p>This work was supported by the Institut Curie, the Institut National de la Santé et de la Recherche Médicale, the Centre National de la Recherche Scientifique, the IST program from the European Commission through the HKIS project (IST-2001-38153), the Cancéropole Ile de France, and the association <italic>Courir pour la vie, courir pour Curie</italic>.</p>
      <p>The construction of the 3.3K BAC-array by Institut Curie, INSERM U509 was supported by grants from the Carte d'Identité des Tumeurs program of the Ligue Nationale Contre le Cancer.</p>
      <p>We thank Isabelle Janoueix-Lerosey and Olivier Delattre (Institut Curie, INSERM U509) for making the neuroblastoma data set publicly available.</p>
      <p>We thank Nadège Gruel, Virginie Raynal, Gaelle Pierron, Olivier Delattre (Institut Curie, INSERM U509) and Daniel Pinkel (University of California San Francisco) for fruitful discussions.</p>
    </sec>
  </ack>
  <ref-list>
    <ref id="B1">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Pinkel</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Segraves</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Sudar</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Clark</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Poole</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Kowbel</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Collins</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Kuo</surname>
            <given-names>WL</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Zhai</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Dairkee</surname>
            <given-names>SH</given-names>
          </name>
          <name>
            <surname>Ljung</surname>
            <given-names>BM</given-names>
          </name>
          <name>
            <surname>Gray</surname>
            <given-names>JW</given-names>
          </name>
          <name>
            <surname>Albertson</surname>
            <given-names>DG</given-names>
          </name>
        </person-group>
        <article-title>High resolution analysis of DNA copy number variation using comparative genomic hybridization to microarrays</article-title>
        <source>Nat Genet</source>
        <year>1998</year>
        <volume>20</volume>
        <fpage>207</fpage>
        <lpage>211</lpage>
        <pub-id pub-id-type="pmid">9771718</pub-id>
        <pub-id pub-id-type="doi">10.1038/2524</pub-id>
      </citation>
    </ref>
    <ref id="B2">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Albertson</surname>
            <given-names>DG</given-names>
          </name>
          <name>
            <surname>Collins</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>McCormick</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Gray</surname>
            <given-names>JW</given-names>
          </name>
        </person-group>
        <article-title>Chromosome aberrations in solid tumors</article-title>
        <source>Nat Genet</source>
        <year>2003</year>
        <volume>34</volume>
        <fpage>369</fpage>
        <lpage>76</lpage>
        <pub-id pub-id-type="pmid">12923544</pub-id>
        <pub-id pub-id-type="doi">10.1038/ng1215</pub-id>
      </citation>
    </ref>
    <ref id="B3">
      <citation citation-type="other">
        <person-group person-group-type="author">
          <name>
            <surname>Fridlyand</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Snijders</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Pinkel</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Albertson</surname>
            <given-names>DG</given-names>
          </name>
          <name>
            <surname>Jain</surname>
            <given-names>AN</given-names>
          </name>
        </person-group>
        <article-title>Application of Hidden Markov Models to the analysis of the array CGH data</article-title>
        <source>Journal of Multivariate Analysis</source>
        <year>2004</year>
        <comment>Special Issue on Multivariate Methods in Genomic Data Analysis</comment>
      </citation>
    </ref>
    <ref id="B4">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hupé</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Stransky</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Thiery</surname>
            <given-names>JP</given-names>
          </name>
          <name>
            <surname>Radvanyi</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Barillot</surname>
            <given-names>E</given-names>
          </name>
        </person-group>
        <article-title>Analysis of array CGH data: from signal ratios to gain and loss of DNA regions</article-title>
        <source>Bioinformatics</source>
        <year>2004</year>
        <volume>20</volume>
        <fpage>3413</fpage>
        <lpage>3422</lpage>
        <pub-id pub-id-type="pmid">15381628</pub-id>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/bth418</pub-id>
      </citation>
    </ref>
    <ref id="B5">
      <citation citation-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Jong</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Marchiori</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>van der Vaart</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Ylstra</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Weiss</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Meijer</surname>
            <given-names>G</given-names>
          </name>
        </person-group>
        <person-group person-group-type="editor">
          <name>
            <surname>Raidl GR, Cagnoni S, Cardalda JJR, Corne DW, Gottlieb J, Guillot A, Hart E, Johnson CG, Marchiori E, Meyer JA, Middendorf M</surname>
          </name>
        </person-group>
        <article-title>Chromosomal Breakpoint Detection in Human Cancer</article-title>
        <source>Applications of Evolutionary Computing, EvoWorkshops2003: EvoBIO, EvoCOP, EvoIASP, EvoMUSART, EvoROB, EvoSTIM, Volume 2611 of LNCS</source>
        <year>2003</year>
        <publisher-name>University of Essex, England, UK: Springer-Verlag</publisher-name>
        <fpage>54</fpage>
        <lpage>65</lpage>
      </citation>
    </ref>
    <ref id="B6">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Olshen</surname>
            <given-names>AB</given-names>
          </name>
          <name>
            <surname>Venkatraman</surname>
            <given-names>ES</given-names>
          </name>
          <name>
            <surname>Lucito</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Wigler</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>Circular binary segmentation for the analysis of array-based DNA copy number data</article-title>
        <source>Biostatistics</source>
        <year>2004</year>
        <volume>5</volume>
        <fpage>557</fpage>
        <lpage>572</lpage>
        <pub-id pub-id-type="pmid">15475419</pub-id>
        <pub-id pub-id-type="doi">10.1093/biostatistics/kxh008</pub-id>
      </citation>
    </ref>
    <ref id="B7">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Picard</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Robin</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Lavielle</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Vaisse</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Daudin</surname>
            <given-names>JJ</given-names>
          </name>
        </person-group>
        <article-title>A statistical approach for array CGH data analysis</article-title>
        <source>BMC Bioinformatics</source>
        <year>2005</year>
        <volume>6</volume>
        <fpage>27</fpage>
        <pub-id pub-id-type="pmid">15705208</pub-id>
        <pub-id pub-id-type="doi">10.1186/1471-2105-6-27</pub-id>
      </citation>
    </ref>
    <ref id="B8">
      <citation citation-type="other">
        <person-group person-group-type="author">
          <name>
            <surname>Pollack</surname>
            <given-names>JR</given-names>
          </name>
          <name>
            <surname>Sorlie</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Perou</surname>
            <given-names>CM</given-names>
          </name>
          <name>
            <surname>Rees</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Jeffreys</surname>
            <given-names>SS</given-names>
          </name>
          <name>
            <surname>Lonning</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Tibshirani</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Botstein</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Borresen-Dale</surname>
            <given-names>AL</given-names>
          </name>
          <name>
            <surname>Brown</surname>
            <given-names>PO</given-names>
          </name>
        </person-group>
        <article-title>Microarray analysis reveals a direct role of DNA copy number alteration in the transcriptional program of breast tumors</article-title>
        <source>PNAS</source>
        <year>2002</year>
      </citation>
    </ref>
    <ref id="B9">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wang</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Meza-Zepeda</surname>
            <given-names>LA</given-names>
          </name>
          <name>
            <surname>Kresse</surname>
            <given-names>SH</given-names>
          </name>
          <name>
            <surname>Myklebost</surname>
            <given-names>O</given-names>
          </name>
        </person-group>
        <article-title>M-CGH: Analysing microarray-based CGH experiments</article-title>
        <source>BMC Bioinformatics</source>
        <year>2004</year>
        <volume>5</volume>
        <fpage>74</fpage>
        <pub-id pub-id-type="pmid">15189572</pub-id>
        <pub-id pub-id-type="doi">10.1186/1471-2105-5-74</pub-id>
      </citation>
    </ref>
    <ref id="B10">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Yang</surname>
            <given-names>YH</given-names>
          </name>
          <name>
            <surname>Dudoit</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Luu</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Lin</surname>
            <given-names>DM</given-names>
          </name>
          <name>
            <surname>Pend</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Ngai</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Speed</surname>
            <given-names>TP</given-names>
          </name>
        </person-group>
        <article-title>Normalization of cDNA microarray data: a robust composite method addressing single and multiple slide systematic variation</article-title>
        <source>Nucleic Acids Research</source>
        <year>2002</year>
        <volume>30</volume>
        <fpage>e15:1</fpage>
        <lpage>e15:11</lpage>
        <pub-id pub-id-type="pmid">11842121</pub-id>
      </citation>
    </ref>
    <ref id="B11">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Khojasteh</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Lam</surname>
            <given-names>WL</given-names>
          </name>
          <name>
            <surname>Ward</surname>
            <given-names>RK</given-names>
          </name>
          <name>
            <surname>MacAulay</surname>
            <given-names>C</given-names>
          </name>
        </person-group>
        <article-title>A stepwise framework for the normalization of array CGH data</article-title>
        <source>BMC Bioinformatics</source>
        <year>2005</year>
        <volume>6</volume>
        <fpage>274</fpage>
        <pub-id pub-id-type="pmid">16297240</pub-id>
        <pub-id pub-id-type="doi">10.1186/1471-2105-6-274</pub-id>
      </citation>
    </ref>
    <ref id="B12">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Billerey</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Chopin</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Aubriot-Lorton</surname>
            <given-names>MH</given-names>
          </name>
          <name>
            <surname>Ricol</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Gil</surname>
            <given-names>S Diez de Medina</given-names>
          </name>
          <name>
            <surname>Van Rhijn</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Bralet</surname>
            <given-names>MP</given-names>
          </name>
          <name>
            <surname>Lefrere-Belda</surname>
            <given-names>MA</given-names>
          </name>
          <name>
            <surname>Lahaye</surname>
            <given-names>JB</given-names>
          </name>
          <name>
            <surname>Abbou</surname>
            <given-names>CC</given-names>
          </name>
          <name>
            <surname>Bonaventure</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Zafrani</surname>
            <given-names>ES</given-names>
          </name>
          <name>
            <surname>van der Kwast</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Thiery</surname>
            <given-names>JP</given-names>
          </name>
          <name>
            <surname>Radvanyi</surname>
            <given-names>F</given-names>
          </name>
        </person-group>
        <article-title>Frequent FGFR3 mutations in papillary non-invasive bladder(pTa) tumors</article-title>
        <source>Am J Pathol</source>
        <year>2001</year>
        <volume>158</volume>
        <fpage>955</fpage>
        <lpage>1959</lpage>
        <pub-id pub-id-type="pmid">11238043</pub-id>
      </citation>
    </ref>
    <ref id="B13">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Snijders</surname>
            <given-names>AM</given-names>
          </name>
          <name>
            <surname>Nowak</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Segraves</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Blackwood</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Brown</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Conroy</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Hamilton</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Hindle</surname>
            <given-names>AK</given-names>
          </name>
          <name>
            <surname>Huey</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Kimura</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>SL</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Myambo</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Palmer</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Ylstra</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Yue</surname>
            <given-names>JP</given-names>
          </name>
          <name>
            <surname>Gray</surname>
            <given-names>JW</given-names>
          </name>
          <name>
            <surname>Jain</surname>
            <given-names>AN</given-names>
          </name>
          <name>
            <surname>Pinkel</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Albertson</surname>
            <given-names>DG</given-names>
          </name>
        </person-group>
        <article-title>Assembly of microarrays for genome-wide measurement of DNA copy number</article-title>
        <source>Nat Genet</source>
        <year>2001</year>
        <volume>29</volume>
        <fpage>263</fpage>
        <lpage>4</lpage>
        <pub-id pub-id-type="pmid">11687795</pub-id>
        <pub-id pub-id-type="doi">10.1038/ng754</pub-id>
      </citation>
    </ref>
    <ref id="B14">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Janoueix-Lerosey</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Hupé</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Maciorowski</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>La Rosa</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Pierron</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Manié</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Liva</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Barillot</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Delattre</surname>
            <given-names>O</given-names>
          </name>
        </person-group>
        <article-title>Preferential occurence of chromosome breakpoints within early replicating regions in neuroblastoma</article-title>
        <source>Cell Cycle</source>
        <year>2005</year>
        <volume>4</volume>
        <fpage>1842</fpage>
        <lpage>1846</lpage>
        <pub-id pub-id-type="pmid">16294040</pub-id>
      </citation>
    </ref>
    <ref id="B15">
      <citation citation-type="other">
        <article-title>Replication timing data analysis in Neuroblastoma</article-title>
        <ext-link ext-link-type="uri" xlink:href="http://microarrays.curie.fr/publications/U509/reptiming"/>
      </citation>
    </ref>
    <ref id="B16">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Workman</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Jensen</surname>
            <given-names>LJ</given-names>
          </name>
          <name>
            <surname>Jarmer</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Berka</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Gautier</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Nielsen</surname>
            <given-names>HB</given-names>
          </name>
          <name>
            <surname>Saxild</surname>
            <given-names>HH</given-names>
          </name>
          <name>
            <surname>Nielsen</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Brunak</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Knudsen</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>A new non-linear normalization method for reducing variability in DNA microarray experiments</article-title>
        <source>Genome Biology</source>
        <year>2002</year>
        <volume>3</volume>
        <fpage>research0048.1</fpage>
        <lpage>0048.16</lpage>
        <pub-id pub-id-type="pmid">12225587</pub-id>
        <pub-id pub-id-type="doi">10.1186/gb-2002-3-9-research0048</pub-id>
      </citation>
    </ref>
    <ref id="B17">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Baird</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Johnstone</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Wilson</surname>
            <given-names>T</given-names>
          </name>
        </person-group>
        <article-title>Normalization of Microarray Data Using a Spatial Mixed Model analysis which includes Splines</article-title>
        <source>Bioinformatics</source>
        <year>2004</year>
        <volume>20</volume>
        <fpage>3196</fpage>
        <lpage>3205</lpage>
        <pub-id pub-id-type="pmid">15231532</pub-id>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/bth384</pub-id>
      </citation>
    </ref>
    <ref id="B18">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Colantuoni</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Henry</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Zeger</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Pevsner</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>Local mean normalization of microarray element signal intensities across an array surface: quality control and correction of spatially systematic artifacts</article-title>
        <source>Biotechniques</source>
        <year>2002</year>
        <volume>32</volume>
        <fpage>1316</fpage>
        <lpage>1320</lpage>
        <pub-id pub-id-type="pmid">12074162</pub-id>
      </citation>
    </ref>
    <ref id="B19">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wilson</surname>
            <given-names>DL</given-names>
          </name>
          <name>
            <surname>Buckley</surname>
            <given-names>MJ</given-names>
          </name>
          <name>
            <surname>Helliwell</surname>
            <given-names>CA</given-names>
          </name>
          <name>
            <surname>Wilson</surname>
            <given-names>IW</given-names>
          </name>
        </person-group>
        <article-title>New normalization methods for cDNA microarray data</article-title>
        <source>Bioinformatics</source>
        <year>2003</year>
        <volume>19</volume>
        <fpage>1325</fpage>
        <lpage>1332</lpage>
        <pub-id pub-id-type="pmid">12874043</pub-id>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btg146</pub-id>
      </citation>
    </ref>
    <ref id="B20">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Tarca</surname>
            <given-names>AL</given-names>
          </name>
          <name>
            <surname>Cooke</surname>
            <given-names>JEK</given-names>
          </name>
          <name>
            <surname>Mackay</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>A robust neural networks approach for spatial and intensity-dependent normalization of cDNA microarray data</article-title>
        <source>Bioinformatics</source>
        <year>2005</year>
        <volume>21</volume>
        <fpage>2674</fpage>
        <lpage>2683</lpage>
        <pub-id pub-id-type="pmid">15797913</pub-id>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/bti397</pub-id>
      </citation>
    </ref>
    <ref id="B21">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Cleveland</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Devlin</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Grosse</surname>
            <given-names>E</given-names>
          </name>
        </person-group>
        <article-title>Regression By Local Fitting</article-title>
        <source>Journal of Econometrics</source>
        <year>1988</year>
        <volume>37</volume>
        <fpage>87</fpage>
        <lpage>114</lpage>
        <pub-id pub-id-type="doi">10.1016/0304-4076(88)90077-2</pub-id>
      </citation>
    </ref>
    <ref id="B22">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Cleveland</surname>
            <given-names>WS</given-names>
          </name>
          <name>
            <surname>Grosse</surname>
            <given-names>E</given-names>
          </name>
        </person-group>
        <article-title>Computational Methods for Local Regression</article-title>
        <source>Statistics and Computing</source>
        <year>1991</year>
        <volume>1</volume>
        <fpage>47</fpage>
        <lpage>62</lpage>
        <pub-id pub-id-type="doi">10.1007/BF01890836</pub-id>
      </citation>
    </ref>
    <ref id="B23">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Reimers</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Weinstein</surname>
            <given-names>JN</given-names>
          </name>
        </person-group>
        <article-title>Quality assessment of microarrays: visualization of spatial artifacts and quantitation of regional biases</article-title>
        <source>BMC Bioinformatics</source>
        <year>2005</year>
        <volume>6</volume>
        <fpage>166</fpage>
        <pub-id pub-id-type="pmid">15992406</pub-id>
        <pub-id pub-id-type="doi">10.1186/1471-2105-6-166</pub-id>
      </citation>
    </ref>
    <ref id="B24">
      <citation citation-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Ambroise</surname>
            <given-names>C</given-names>
          </name>
        </person-group>
        <article-title>Approche probabiliste en classification automatique et contraintes de voisinage</article-title>
        <source>PhD thesis</source>
        <year>1996</year>
        <publisher-name>Université Technique de Compiègne, France</publisher-name>
      </citation>
    </ref>
    <ref id="B25">
      <citation citation-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Ambroise</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Dang</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Govaert</surname>
            <given-names>G</given-names>
          </name>
        </person-group>
        <person-group person-group-type="editor">
          <name>
            <surname>Soares A, Gomes-Hernandez J, Froidevaux R</surname>
          </name>
        </person-group>
        <article-title>Clustering of spatial data by the EM algorithm</article-title>
        <source>Geostatistics for Environmental Applications</source>
        <year>1997</year>
        <publisher-name>Kluwer Academic Publisher</publisher-name>
        <fpage>493</fpage>
        <lpage>504</lpage>
      </citation>
    </ref>
    <ref id="B26">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Pinkel</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Albertson</surname>
            <given-names>DG</given-names>
          </name>
        </person-group>
        <article-title>Array comparative genomic hybridization and its applications in cancer</article-title>
        <source>Nat Genet</source>
        <year>2005</year>
        <fpage>S11</fpage>
        <lpage>S17</lpage>
        <pub-id pub-id-type="pmid">15920524</pub-id>
        <pub-id pub-id-type="doi">10.1038/ng1569</pub-id>
      </citation>
    </ref>
    <ref id="B27">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Jain</surname>
            <given-names>AN</given-names>
          </name>
          <name>
            <surname>Tokuyasu</surname>
            <given-names>TA</given-names>
          </name>
          <name>
            <surname>Snijders</surname>
            <given-names>AM</given-names>
          </name>
          <name>
            <surname>Segraves</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Albertson</surname>
            <given-names>DG</given-names>
          </name>
          <name>
            <surname>Pinkel</surname>
            <given-names>D</given-names>
          </name>
        </person-group>
        <article-title>Fully automatic quantification of microarray image data</article-title>
        <source>Genome Res</source>
        <year>2002</year>
        <volume>12</volume>
        <fpage>325</fpage>
        <lpage>332</lpage>
        <pub-id pub-id-type="pmid">11827952</pub-id>
        <pub-id pub-id-type="doi">10.1101/gr.210902</pub-id>
      </citation>
    </ref>
    <ref id="B28">
      <citation citation-type="other">
        <article-title>MANOR: CGH Micro-Array NORmalization</article-title>
        <ext-link ext-link-type="uri" xlink:href="http://bioinfo.curie.fr/projects/manor"/>
      </citation>
    </ref>
    <ref id="B29">
      <citation citation-type="other">
        <article-title>Bioconductor: Open software development for computational biology and bioinformatics</article-title>
        <ext-link ext-link-type="uri" xlink:href="http://www.bioconductor.org"/>
      </citation>
    </ref>
    <ref id="B30">
      <citation citation-type="other">
        <person-group person-group-type="author">
          <name>
            <surname>Liva</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Hupé</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Neuvial</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Brito</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Viara</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>La Rosa</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Barillot</surname>
            <given-names>E</given-names>
          </name>
        </person-group>
        <article-title>CAPweb : a bioinformatics CGH array Analysis Platform</article-title>
        <source>Nucleic Acids Research</source>
        <year>2006</year>
        <comment/>
      </citation>
    </ref>
    <ref id="B31">
      <citation citation-type="other">
        <article-title>CAPweb : a bioinformatics CGH array Analysis Platform</article-title>
        <ext-link ext-link-type="uri" xlink:href="http://bioinfo.curie.fr/CAPweb"/>
      </citation>
    </ref>
    <ref id="B32">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hathaway</surname>
            <given-names>RJ</given-names>
          </name>
        </person-group>
        <article-title>Another interpretation of the EM algorithm for mixture distributions</article-title>
        <source>Journal of Statistics and Probability Letters</source>
        <year>1986</year>
        <volume>4</volume>
        <fpage>53</fpage>
        <lpage>56</lpage>
        <pub-id pub-id-type="doi">10.1016/0167-7152(86)90016-7</pub-id>
      </citation>
    </ref>
  </ref-list>
  <sec sec-type="display-objects">
    <title>Figures and Tables</title>
    <fig position="float" id="F1">
      <label>Figure 1</label>
      <caption>
        <p><bold>The need for an image segmentation method</bold>. An array with areas of local spatial bias (bladder cancer data): a straightforward trend correction method does not address the spatial effect appropriately. (a) Median-centered log-ratios; (b) spatial trend; (c) log-ratios after trend subtraction; (d) remaining spatial trend after subtraction (the color scale is not the same as in (b)). Colors are proportional to signal log-ratios; white dots correspond to missing values.</p>
      </caption>
      <graphic xlink:href="1471-2105-7-264-1"/>
    </fig>
    <fig position="float" id="F2">
      <label>Figure 2</label>
      <caption>
        <p><bold>Results of the gradient subtraction step (2dLoess) on a breast cancer array</bold>. Correction of the spatial gradient of a breast cancer array: continuous spatial gradients are correctly taken into account by the proposed normalization method. 1(a) Median-centered log-ratios; 1(b) spatial trend; 1(c) genomic profile without spatial normalization; 2(a) corrected log-ratios; 2(b) spatial trend after correction (the color scale is not the same as in 1(b)); 2(c) genomic profile after spatial normalization. The vertical gray dashed lines indicate the separation between chromosomes.</p>
      </caption>
      <graphic xlink:href="1471-2105-7-264-2"/>
    </fig>
    <fig position="float" id="F3">
      <label>Figure 3</label>
      <caption>
        <p><bold>Results of the proposed spatial segmentation method (seg) on a bladder cancer array</bold>. Bladder cancer array with local spatial bias accurately detected by the proposed normalization method. (a) Median-centered log-ratios; (b) spatial trend; (c) spatial segmentation; (d) local spatial bias. The border of areas affected by local spatial bias that have been detected in panel (d) are reported on panels (a), (b) and (c) as a black step-function for easy interpretation; (e) genomic profile without spatial normalization (spots detected as local spatial artifacts are marked in red, and the vertical gray dashed lines indicate the separation between chromosomes).</p>
      </caption>
      <graphic xlink:href="1471-2105-7-264-3"/>
    </fig>
    <fig position="float" id="F4">
      <label>Figure 4</label>
      <caption>
        <p><bold>The proposed method (seg+2dLoess) compares favorably to all other normalization methods – bladder cancer data set</bold>. We compared the proposed method (<italic>seg+2dLoess</italic>) to ten methods for two quality criteria: <italic>sigma </italic>and <italic>dyn</italic>. Each color corresponds to the comparison of <italic>seg+2dLoess </italic>with a different method. The proposed method is taken as a reference (red point 1 at (0, 0)). For each method <italic>i</italic>, the cross indicates the mean relative performance (see methods section) of the data set for <italic>dyn </italic>(x axis) and in <italic>sigma </italic>(y axis), and the lines give the corresponding 95% quantile of relative performance. For <italic>sigma </italic>(<italic>dyn</italic>, respectively), the methods with a 95% quantile below (left to, respectively) the horizontal (vertical, respectively) dashed black line are significantly outperformed by our proposed method. Here <italic>seg+2dLoess </italic>significantly outperforms all methods for <italic>dyn </italic>and <italic>sigma</italic>, except <italic>seg</italic>, which performs slightly better for <italic>sigma</italic>. Methods 2, 3, and 4, which contain a gradient subtraction step using 2<italic>dLoess</italic>, perform the best against <italic>seg+2dLoess</italic>, as they cluster near the top-right corner of the image. However, <italic>seg+2dLoess </italic>still significantly outperformed these methods for both <italic>sigma </italic>and <italic>dyn</italic>.</p>
      </caption>
      <graphic xlink:href="1471-2105-7-264-4"/>
    </fig>
    <fig position="float" id="F5">
      <label>Figure 5</label>
      <caption>
        <p><bold>Evidence of local spatial bias on foreground and background raw signals on a breast cancer array</bold>. Log-ratios of the four raw signals of a breast cancer array: local spatial biases are easier to detect on a Cy3 background. (a) Test foreground; (b) test background; (c) reference foreground; (d) reference background. Gray-scale level is proportional to signal value.</p>
      </caption>
      <graphic xlink:href="1471-2105-7-264-5"/>
    </fig>
    <fig position="float" id="F6">
      <label>Figure 6</label>
      <caption>
        <p><bold>Results of the local spatial normalization step (seg) on a breast cancer array</bold>. Breast cancer array with local spatial bias accurately detected by the proposed normalization method. (a) Background signal log-ratios (Cy 3); (b) spatial trend; (c) spatial segmentation; (d) local spatial bias. The border of areas affected by local spatial bias that have been detected in panel (d) are reported on panels (a), (b) and (c) as a black step function for easy interpretation; (e) genomic profile without spatial normalization (spots detected as local spatial artifacts are marked in red, and the vertical gray dashed lines indicate the separation between chromosomes).</p>
      </caption>
      <graphic xlink:href="1471-2105-7-264-6"/>
    </fig>
    <fig position="float" id="F7">
      <label>Figure 7</label>
      <caption>
        <p><bold>The proposed method (seg+2dLoess) compares favorably to all other normalization methods – breast cancer data set</bold>. We compared the proposed method (<italic>seg+2dLoess</italic>) to ten methods for two quality criteria: <italic>sigma </italic>and <italic>dyn</italic>. Each color corresponds to the comparison of <italic>seg+2dLoess </italic>with a different method. The proposed method is taken as a reference (red point 1 at (0, 0)). For each method <italic>i</italic>, the cross indicates the mean relative performance (see methods section) of the data set for <italic>dyn </italic>(x axis) and in <italic>sigma </italic>(y axis), and the lines give the corresponding 95% quantile of relative performance. For <italic>sigma </italic>(<italic>dyn</italic>, respectively), the methods with a 95% quantile below (left to, respectively) the horizontal (vertical, respectively) dashed black line are significantly outperformed by our proposed method. Here <italic>seg+2dLoess </italic>significantly outperforms all methods for <italic>dyn </italic>and <italic>sigma</italic>.</p>
      </caption>
      <graphic xlink:href="1471-2105-7-264-7"/>
    </fig>
    <fig position="float" id="F8">
      <label>Figure 8</label>
      <caption>
        <p><bold>The proposed method (seg+2dLoess) compares favorably to all other normalization methods – neuroblastoma data set</bold>. We compared the proposed method (<italic>seg+2dLoess</italic>) to ten methods for two quality criteria: <italic>sigma </italic>and <italic>dyn</italic>. Each color corresponds to the comparison of <italic>seg+2dLoess </italic>with a different method. The proposed method is taken as a reference (red point 1 at (0,0)). For each method <italic>i</italic>, the cross indicates the mean relative performance (see methods section) of the data set for <italic>dyn </italic>(x axis) and in <italic>sigma </italic>(y axis), and the lines give the corresponding 95% quantile of relative performance. For <italic>sigma </italic>(<italic>dyn</italic>, respectively), the methods with a 95% quantile below (left to, respectively) the horizontal (vertical, respectively) dashed black line are significantly outperformed by our proposed method. Here <italic>seg+2dLoess </italic>significantly outperforms all methods for <italic>dyn </italic>and <italic>sigma</italic>, except those containing a gradient subtraction step with <italic>2dLoess</italic>.</p>
      </caption>
      <graphic xlink:href="1471-2105-7-264-8"/>
    </fig>
    <fig position="float" id="F9">
      <label>Figure 9</label>
      <caption>
        <p><bold>Comparison between qualitative assessment and segmentation results with various (<italic>K</italic>, <italic>β</italic>) –breast cancer data set</bold>. Thesegmentation algorithm is run with <italic>K </italic>∈ {2,...10} (<italic>x </italic>axis) and <italic>β </italic>∈ {0.1, 0.2,...2.0} (<italic>y </italic>axis) and compared with the expert assessment of the breast cancer data set. (a) False positive rate; (b) False negative rate; (c) Total error rate.</p>
      </caption>
      <graphic xlink:href="1471-2105-7-264-9"/>
    </fig>
    <fig position="float" id="F10">
      <label>Figure 10</label>
      <caption>
        <p><bold>Comparison between qualitative assessment and segmentation results with various (<italic>K</italic>, <italic>β</italic>) – bladder cancer data set</bold>. The segmentation algorithm is run with <italic>K </italic>∈ {2,...10} (<italic>x </italic>axis) and <italic>β </italic>∈ {0.1, 0.2,...2.0} (<italic>y </italic>axis) and compared with the expert assessment of the breast cancer data set. (a) False positive rate; (b) False negative rate; (c) Total error rate.</p>
      </caption>
      <graphic xlink:href="1471-2105-7-264-10"/>
    </fig>
  </sec>
</back>
