<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//NLM//DTD Journal Publishing DTD v2.3 20070202//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName journalpublishing.dtd?>
<?SourceDTD.Version 2.3?>
<?ConverterInfo.XSLTName jp2nlmx2.xsl?>
<?ConverterInfo.Version 2?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Nucleic Acids Res</journal-id>
    <journal-id journal-id-type="iso-abbrev">Nucleic Acids Res</journal-id>
    <journal-id journal-id-type="publisher-id">nar</journal-id>
    <journal-id journal-id-type="hwp">nar</journal-id>
    <journal-title-group>
      <journal-title>Nucleic Acids Research</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">0305-1048</issn>
    <issn pub-type="epub">1362-4962</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">3351174</article-id>
    <article-id pub-id-type="doi">10.1093/nar/gks003</article-id>
    <article-id pub-id-type="publisher-id">gks003</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Methods Online</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>cn.MOPS: mixture of Poissons for discovering copy number variations in next-generation sequencing data with a low false discovery rate</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Klambauer</surname>
          <given-names>Günter</given-names>
        </name>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Schwarzbauer</surname>
          <given-names>Karin</given-names>
        </name>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Mayr</surname>
          <given-names>Andreas</given-names>
        </name>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Clevert</surname>
          <given-names>Djork-Arné</given-names>
        </name>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Mitterecker</surname>
          <given-names>Andreas</given-names>
        </name>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Bodenhofer</surname>
          <given-names>Ulrich</given-names>
        </name>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Hochreiter</surname>
          <given-names>Sepp</given-names>
        </name>
        <xref ref-type="corresp" rid="gks003-COR1">*</xref>
      </contrib>
    </contrib-group>
    <aff id="gks003-AFF1">Institute of Bioinformatics, Johannes Kepler University, A-4040 Linz, Austria</aff>
    <author-notes id="AN1">
      <corresp id="gks003-COR1">*To whom correspondence should be addressed. Tel: <phone>+43 732 2468 8880</phone>; Fax: <fax>+43 732 2468 9511</fax>; Email: <email>hochreit@bioinf.jku.at</email></corresp>
    </author-notes>
    <!--For NAR both ppub and collection dates generated for PMC processing 1/27/05 beck-->
    <pub-date pub-type="collection">
      <month>5</month>
      <year>2012</year>
    </pub-date>
    <pub-date pub-type="ppub">
      <month>5</month>
      <year>2012</year>
    </pub-date>
    <pub-date pub-type="epub">
      <day>2</day>
      <month>1</month>
      <year>2012</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>2</day>
      <month>1</month>
      <year>2012</year>
    </pub-date>
    <!-- PMC Release delay is 0 months and 0 days and was based on the
							<pub-date pub-type="epub"/>. -->
    <volume>40</volume>
    <issue>9</issue>
    <fpage>e69</fpage>
    <lpage>e69</lpage>
    <history>
      <date date-type="received">
        <day>31</day>
        <month>8</month>
        <year>2011</year>
      </date>
      <date date-type="rev-recd">
        <day>1</day>
        <month>12</month>
        <year>2011</year>
      </date>
      <date date-type="accepted">
        <day>28</day>
        <month>12</month>
        <year>2011</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2012. Published by Oxford University Press.</copyright-statement>
      <copyright-year>2012</copyright-year>
      <license license-type="creative-commons" xlink:href="http://creativecommons.org/licenses/by-nc/3.0">
        <license-p><!--CREATIVE COMMONS-->This is an Open Access article distributed under the terms of the Creative Commons Attribution Non-Commercial License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by-nc/3.0">http://creativecommons.org/licenses/by-nc/3.0</ext-link>), which permits unrestricted non-commercial use, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <abstract>
      <p>Quantitative analyses of next-generation sequencing (NGS) data, such as the detection of copy number variations (CNVs), remain challenging. Current methods detect CNVs as changes in the depth of coverage along chromosomes. Technological or genomic variations in the depth of coverage thus lead to a high false discovery rate (FDR), even upon correction for GC content. In the context of association studies between CNVs and disease, a high FDR means many false CNVs, thereby decreasing the discovery power of the study after correction for multiple testing. We propose ‘Copy Number estimation by a Mixture Of PoissonS’ (cn.MOPS), a data processing pipeline for CNV detection in NGS data. In contrast to previous approaches, cn.MOPS incorporates modeling of depths of coverage across samples at each genomic position. Therefore, cn.MOPS is not affected by read count variations along chromosomes. Using a Bayesian approach, cn.MOPS decomposes variations in the depth of coverage across samples into integer copy numbers and noise by means of its mixture components and Poisson distributions, respectively. The noise estimate allows for reducing the FDR by filtering out detections having high noise that are likely to be false detections. We compared cn.MOPS with the five most popular methods for CNV detection in NGS data using four benchmark datasets: (i) simulated data, (ii) NGS data from a male HapMap individual with implanted CNVs from the X chromosome, (iii) data from HapMap individuals with known CNVs, (iv) high coverage data from the 1000 Genomes Project. cn.MOPS outperformed its five competitors in terms of precision (1–FDR) and recall for both gains and losses in all benchmark data sets. The software cn.MOPS is publicly available as an R package at <ext-link ext-link-type="uri" xlink:href="http://www.bioinf.jku.at/software/cnmops/">http://www.bioinf.jku.at/software/cnmops/</ext-link> and at Bioconductor.</p>
    </abstract>
    <counts>
      <page-count count="14"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec>
    <title>INTRODUCTION</title>
    <p>Next-generation sequencing (NGS) has evolved into an important technology for genotyping (<xref ref-type="bibr" rid="gks003-B1">1</xref>) and genome assembly (<xref ref-type="bibr" rid="gks003-B2">2</xref>). NGS has also been applied to transcriptomics (mRNA-Seq), where it revealed new splice variants and new transcripts (<xref ref-type="bibr" rid="gks003-B3">3</xref>). Despite these successes, quantitative analyses of NGS data, for instance, determination of the expression levels of genes, are still challenging (<xref ref-type="bibr" rid="gks003-B4">4</xref>,<xref ref-type="bibr" rid="gks003-B5">5</xref>). Estimation of DNA copy numbers is another important kind of quantitative analysis, in which local depths of coverage must be mapped to integer copy numbers. Copy number analysis by NGS has the following potential advantages compared with array-based techniques: (i) estimation of integer copy numbers from NGS data is more accurate for large copy numbers, since depths of coverage scale linearly with copy numbers (<xref ref-type="bibr" rid="gks003-B6">6</xref>). (ii) Breakpoints of copy number regions can be determined more precisely (<xref ref-type="bibr" rid="gks003-B7">7</xref>) because they do not rely on predefined probes. (iii) Allele-specific copy numbers may be estimated for observed alleles, while array-based techniques are restricted to predefined alleles. Allele-specific copy numbers are of interest because they allow for determining whether an allele is fully functional, which is important, for example, for the identification of mutations leading to cancer development (<xref ref-type="bibr" rid="gks003-B8">8</xref>).</p>
    <p>In the following, we review existing methods for estimating DNA copy numbers in NGS data. These methods represent the depth of coverage either as read counts or as log read counts in an interval and can be classified into (a) approaches detecting read count deviations and (b) reference-based approaches. Class (a) methods detect CNVs as deviations of (log) read counts from an average (log) read count of a chromosome. Class (b) methods detect CNVs as intervals for which (log) read count ratios between a sample and a reference deviate from 1 (0). This reference can either be a designated control sample or a constructed average sample.</p>
    <p>MOFDOC (‘MOdel Free Depth Of Coverage’) belongs to class (a) and has been used by Alkan <italic>et al.</italic> (<xref ref-type="bibr" rid="gks003-B6">6</xref>), Campbell <italic>et al.</italic> (<xref ref-type="bibr" rid="gks003-B9">9</xref>), Wang <italic>et al.</italic> (<xref ref-type="bibr" rid="gks003-B10">10</xref>), Bentley <italic>et al.</italic> (<xref ref-type="bibr" rid="gks003-B11">11</xref>) and Wheeler <italic>et al.</italic> (<xref ref-type="bibr" rid="gks003-B12">12</xref>) for NGS copy number detection and earlier by Bailey <italic>et al.</italic> (<xref ref-type="bibr" rid="gks003-B13">13</xref>) for whole-genome shotgun sequencing. The variant of MOFDOC, as introduced by Alkan <italic>et al.</italic> (<xref ref-type="bibr" rid="gks003-B6">6</xref>), first divides the genome into non-overlapping segments of equal length in which reads are counted. Note that some variants of MOFDOC are based on log read counts. Using the overall mean and standard deviation of those segment read counts, each segment is characterized by the multiple of the standard deviation by which its read count differs from the overall mean. A segmentation algorithm combines consecutive segments into a gain segment if they have read counts larger than three times the standard deviation above the mean; analogously, it combines segments into a loss segment if they have read counts smaller than two times the standard deviation below the mean (see blue boxes in <xref ref-type="fig" rid="gks003-F2">Figure 2</xref>). GC correction is crucial for proper performance of MOFDOC because of the GC content bias of NGS (<xref ref-type="bibr" rid="gks003-B14">14</xref>). However, MOFDOC, like most class (a) methods, has a high false discovery rate (FDR), even upon GC correction. The reason is that mean segment read counts for copy number two may vary along the chromosome due to technological biases or local genomic characteristics. These read count variations along the chromosome appear consistently across samples, for example, all samples tend to have either larger or smaller read counts (see <ext-link ext-link-type="uri" xlink:href="http://nar.oxfordjournals.org/cgi/content/full/gks003/DC1">Supplementary Figure S11</ext-link> and the third bar in <xref ref-type="fig" rid="gks003-F2">Figure 2</xref>). Class (a) methods confound these variations with copy number changes leading to false discoveries.</p>
    <p>EWT (‘Event-Wise Testing’), introduced by Yoon <italic>et al.</italic> (<xref ref-type="bibr" rid="gks003-B15">15</xref>), is identical to MOFDOC except for the final segmentation algorithm. EWT uses a probabilistic approach to join consecutive segments that, under a Gaussian assumption, show either significantly larger or significantly smaller read counts than the overall mean (see blue boxes in <xref ref-type="fig" rid="gks003-F2">Figure 2</xref>). As for MOFDOC, read count variations along the chromosome lead to false CNVs (see <ext-link ext-link-type="uri" xlink:href="http://nar.oxfordjournals.org/cgi/content/full/gks003/DC1">Supplementary Figure S11</ext-link>).</p>
    <p>JointSLM (<xref ref-type="bibr" rid="gks003-B16">16</xref>) also belongs to class (a), and extends the idea of EWT to a simultaneous segmentation of multiple samples. Again, the genome is divided into equally sized, non-overlapping segments for which the logarithm of GC-corrected and normalized (divided by the median per sample) read counts is computed. A hidden Markov model (HMM) slides along the chromosome and simultaneously scans the log-normalized read counts of all samples. The more samples show large or small read counts, the more likely a segment is detected (see blue boxes in <xref ref-type="fig" rid="gks003-F2">Figure 2</xref>). JointSLM hardly detects CNVs that occur only in a few samples, because its HMM uses a single state variable for simultaneously explaining the copy numbers of all individuals (see <ext-link ext-link-type="uri" xlink:href="http://nar.oxfordjournals.org/cgi/content/full/gks003/DC1">Supplementary Figure S9</ext-link>). Furthermore, CNV regions may contain both gains and losses (<xref ref-type="bibr" rid="gks003-B17">17</xref>), which impedes JointSLM in detecting such regions, since samples have propensities to transit to different HMM hidden states. Like other class (a) methods, JointSLM detects spurious regions if they contain read counts that, due to genomic and technical biases, are smaller or larger than the chromosome average (see <ext-link ext-link-type="uri" xlink:href="http://nar.oxfordjournals.org/cgi/content/full/gks003/DC1">Supplementary Figure S11</ext-link>). Note that we consider JointSLM as a class (a) method because it detects simultaneous deviations of log read counts from an average log read count.</p>
    <p>SeqSeg (<xref ref-type="bibr" rid="gks003-B7">7</xref>) is a class (b) method that was designed to identify copy number aberrations (CNAs) in tumor samples by comparing them to references, that is, their matched controls. SeqSeg evaluates the likelihood of each tumor read being a CNA breakpoint and keeps the most likely ones, thereby segmenting the chromosome. For each segment, the ratio between sample read counts and reference read counts is computed. Segments are called gains if their ratios are above 1.5, which corresponds to a copy number of at least 3, or losses if their ratios are below 0.5, which corresponds to a copy number of at most 1. Read count variations along the chromosome stemming, for instance, from the GC bias are implicitly corrected because these variations affect both the tumor sample and the reference in a similar way. SeqSeg relies on a single reference and does not consider local read count variations across replicates or multiple samples. Consequently, SeqSeg falsely detects CNVs in genomic regions where read counts of replicates are highly variable (see <ext-link ext-link-type="uri" xlink:href="http://nar.oxfordjournals.org/cgi/content/full/gks003/DC1">Supplementary Figure S12</ext-link>).</p>
    <p>rSW-seq (<xref ref-type="bibr" rid="gks003-B18">18</xref>) improves SeqSeg with respect to breakpoint identification, but the local read count variability remains disregarded. Note that both methods, SeqSeg and rSW-seq, were designed for CNA detection in tumor samples, especially at the breakpoint identification step.</p>
    <p>CNAseg (<xref ref-type="bibr" rid="gks003-B19">19</xref>) was also designed to detect CNAs in tumor samples, using an approach similar to that of SeqSeg. CNAseg, like JointSLM for a single sample, employs an HMM for joining equally sized, non-overlapping segments using the difference in segment read counts between tumor and reference. The resulting segments are joined on the basis of a χ<sup>2</sup> statistic.</p>
    <p>CNV-Seq (<xref ref-type="bibr" rid="gks003-B20">20</xref>) is another class (b) method. It also divides the genome into equally sized, non-overlapping segments for which read count ratios are computed using a reference sample. The read counts are assumed to follow a Poisson distribution, which is approximated by a Gaussian distribution. Subsequently, the Geary-Hinkley transformation is applied to the ratios of Gaussians to produce an approximately Gaussian output. In a final step, a segmentation algorithm joins consecutive segments with log ratios above or below a certain threshold. Like all other methods, CNV-Seq is prone to falsely detecting CNVs since it does not take local read count variability into account (see <ext-link ext-link-type="uri" xlink:href="http://nar.oxfordjournals.org/cgi/content/full/gks003/DC1">Supplementary Figure S12</ext-link>).</p>
    <p>FREEC (‘control-FREE Copy number calling’) is a class (b) method suggested by Boeva <italic>et al.</italic> (<xref ref-type="bibr" rid="gks003-B21">21</xref>). FREEC also counts reads in equally sized, non-overlapping segments and computes read count ratios per segment using a reference sample. Hypothetical read counts estimated by a polynomial function of the segment's GC content can be used instead of a reference. In the segmentation step, the breakpoints are determined by LASSO (‘Least Absolute Shrinkage eStimatOr’) regression (<xref ref-type="bibr" rid="gks003-B22">22</xref>). FREEC does not consider local read count variability either, which makes it susceptible to falsely discovered CNVs (see <ext-link ext-link-type="uri" xlink:href="http://nar.oxfordjournals.org/cgi/content/full/gks003/DC1">Supplementary Figure S12</ext-link>).</p>
    <p>In summary, existing methods suffer from a high FDR that results (i) from read count variations along the chromosome, especially if no references are used, and (ii) from variations in read counts (noisy counts) across samples that may occur even for constant copy numbers. The high FDR can be moderated for paired-end reads by confirming CNVs by means of clusters of discordant read pairs—incorrect orientation, order or distance (<xref ref-type="bibr" rid="gks003-B23">23</xref>). However, this approach may considerably decrease the discovery power since clusters may be missed, especially in cases of low coverage.</p>
    <p>Below we introduce cn.MOPS, a CNV detection method together with a data processing pipeline which, in contrast to most previous methods, (i) provides integer copy numbers, (ii) estimates variations in read counts across samples and (iii) uses these estimates for CNV calling, thereby keeping the FDR low. A high FDR is particularly critical in association studies between CNVs and diseases: a high FDR implies many false CNVs. Correction for multiple testing must then consider these false discoveries, which increases the corrected <italic>P</italic>-values and reduces the discovery power of a study. The novelty of cn.MOPS is modeling across samples, which improves the performance considerably, as technical and biological variations are estimated and taken into account. By ‘modeling across samples’ we mean the construction of a generative model that explains how the data have been produced. This model decomposes the read count of each sample into signal and noise. The idea of modeling across samples has already improved CNV detection in microarray data by reducing the FDR, as the recent cn.FARMS method (<xref ref-type="bibr" rid="gks003-B24">24</xref>) demonstrates.</p>
  </sec>
  <sec sec-type="methods">
    <title>METHODS</title>
    <p>The cn.MOPS processing pipeline is depicted in <xref ref-type="fig" rid="gks003-F1">Figure 1</xref>. The left column shows modeling across samples and integer copy number estimation that are unique to the cn.MOPS pipeline. On the right-hand side, GC correction is unique to some previous analysis pipelines; however, this step is not necessary for cn.MOPS, as the local model automatically captures GC content effects. The steps of the cn.MOPS processing pipeline and the central cn.MOPS model are described in the following subsections.
<fig id="gks003-F1" position="float"><label>Figure 1.</label><caption><p>The processing pipelines for CNV detection in NGS data. Left column: modeling across samples and integer copy number estimation are unique to cn.MOPS. Right column: either GC correction [class (a) methods] or read count ratios [class (b) methods] are required for previous pipelines.</p></caption><graphic xlink:href="gks003f1"/></fig></p>
    <sec>
      <title>Read mapping and segment read counts</title>
      <p>After quality control, <italic>read mapping</italic> is the first step in analyzing NGS data with respect to CNVs (<xref ref-type="fig" rid="gks003-F1">Figure 1</xref>). Depending on the technology, the read length and whether the reads are single or paired, the parameters of the mapping method should be adjusted to minimize the number of false positives without generating too many false negatives. The most important mapping parameters are the number of mismatches allowed and the gap parameters of the employed alignment algorithm. These parameters depend on the expected sequencing errors [see (<xref ref-type="bibr" rid="gks003-B14">14</xref>) for a statistical analysis of sequencing errors]. If multiple best mapping positions are found for a read, then the read can be randomly assigned to one of them, to all of them, or can be discarded. In our experiments, we mapped the reads by Bowtie (<xref ref-type="bibr" rid="gks003-B25">25</xref>) for paired reads, allowed two mismatches and mapped to one random best mapping position.</p>
      <p>After read mapping, <italic>segments</italic> must be defined <italic>in which the reads are counted</italic> (<xref ref-type="fig" rid="gks003-F1">Figure 1</xref>). For cn.MOPS, as for all other approaches except SeqSeg and rSW-seq, the genome is first divided into non-overlapping segments in which reads are counted. Previous methods compare read counts along the chromosome (depth of coverage) and must therefore have equally sized segments in which reads are counted. Although cn.MOPS also uses equally sized segments by default, equal size is not strictly required, since a separate model is generated for each segment. The later segmentation along the chromosome is based on the expected copy number, which is independent of the segment length. If the sizes of segments in which reads are counted are variable, then the resolution can be traded off against the confidence in the estimated copy numbers.</p>
    </sec>
    <sec>
      <title>Sample normalization and GC correction</title>
      <p><italic>GC correction</italic> is a crucial first step for proper performance of class (a) methods, such as MOFDOC (<xref ref-type="fig" rid="gks003-F1">Figure 1</xref>). These methods subsequently apply a segmentation algorithm to (log) read counts along the chromosome. Therefore, the (log) read counts must be normalized to be comparable between different genomic loci. Since the numbers of reads within segments depend on their GC content (<xref ref-type="bibr" rid="gks003-B14">14</xref>), the segments' (log) read counts must be normalized for their GC content.</p>
      <p><italic>Sample normalization</italic> is important for modeling across samples because the reads of all samples are assumed to be caused by the same model (<xref ref-type="fig" rid="gks003-F1">Figure 1</xref>). Sample normalization corrects the read counts of one sample by the number of mappable reads of the sample to make read counts comparable across samples. Using data of HapMap individuals from the 1000 Genomes Project (<xref ref-type="bibr" rid="gks003-B26">26</xref>), we tested read counts of 25 kbp segments for being Poisson distributed with and without sample normalization. Without sample normalization, the Poisson assumption was rejected by a Poisson test (<xref ref-type="bibr" rid="gks003-B27">27</xref>) for 92% of the segments. Using normalization, however, the Poisson assumption was rejected for only 2% of the segments. Segments that were rejected coincide significantly with known CNV regions according to Fisher's exact test with <italic>p</italic> &lt; 2.2<italic>e</italic>-16 (for details see <ext-link ext-link-type="uri" xlink:href="http://nar.oxfordjournals.org/cgi/content/full/gks003/DC1">Supplementary Table S1</ext-link>). Thus, our model assumption that, for a constant copy number, the read counts are Poisson distributed is justified with sample normalization. This assumption is also in concordance with the findings of Sathirapongsasuti <italic>et al.</italic> (<xref ref-type="bibr" rid="gks003-B28">28</xref>).</p>
    </sec>
    <sec>
      <title>The mixture of Poissons model</title>
      <p>Our main contribution and novelty is modeling of read count variations across samples in order to separate variations caused by copy numbers from local variations caused by technical or biological noise (<xref ref-type="fig" rid="gks003-F1">Figure 1</xref>). For CNV detection, we use a mixture of Poissons model that is not affected by read count variations along the chromosome, because a separate model is constructed at each DNA locus. The model incorporates the linear dependency between average read counts in segments and copy numbers (<xref ref-type="bibr" rid="gks003-B6">6</xref>,<xref ref-type="bibr" rid="gks003-B7">7</xref>). In contrast to existing methods, cn.MOPS provides integer copy numbers together with their confidence intervals. Model selection in a Bayesian framework is based on maximizing the posterior by an expectation maximization (EM) algorithm. Most importantly, a Dirichlet prior on the mixture components prefers a constant copy number of 2 for all samples. Only if the data drive the posterior away from this prior, the segment receives a high informative/non-informative call (I/NI call), that is, the part of the CNV call which detects variation across samples.</p>
      <sec>
        <title>The Model</title>
        <p>cn.MOPS is a generative probabilistic model that explains the observed read counts by copy numbers and by measurement variations. Consequently, the model assumes that the read counts <italic>x</italic> in a segment are distributed across samples according to a mixture of Poissons, in which each mixture component corresponds to specific copy number and the Poisson parameter reflects the noise:
<disp-formula id="gks003-M1"><label>(1)</label><graphic xlink:href="gks003m1"/></disp-formula>
In this model, α<sub><italic>i</italic></sub> is the percentage of samples with copy number <italic>i</italic> for 0 ≤ <italic>i</italic> ≤ <italic>n</italic>, and λ is the mean read count for copy number 2. P is the Poisson distribution:
<disp-formula id="gks003-M2"><label>(2)</label><graphic xlink:href="gks003m2"/></disp-formula>
The model integrates the assumption that the read counts are linearly related to the number of copies. For copy number <italic>i</italic> ≥ 1, the mean read count is thus <inline-formula><inline-graphic xlink:href="gks003i1.jpg"/></inline-formula>. For copy number <italic>i</italic> = 0, we assume a Poisson distribution with parameter <inline-formula><inline-graphic xlink:href="gks003i2.jpg"/></inline-formula>, which accounts for background noise stemming from wrongly or ambiguously mapped reads and for sample contamination by other DNA. See <ext-link ext-link-type="uri" xlink:href="http://nar.oxfordjournals.org/cgi/content/full/gks003/DC1">Supplementary Section S2.5</ext-link>, for a justification of the noise model. Note, that the results of cn.MOPS are robust against the choice of the hyperparameter ε (see <ext-link ext-link-type="uri" xlink:href="http://nar.oxfordjournals.org/cgi/content/full/gks003/DC1">Supplementary Section S3.8</ext-link>). The robustness is due to the fact that copy number zero can be detected with a broad range of ε values.</p>
        <p>The model in Equation (<xref ref-type="disp-formula" rid="gks003-M1">1</xref>) allows <italic>estimation of integer copy numbers</italic> with fixed model parameters α<sub><italic>i</italic></sub> and λ. The prior probability that a read count stems from copy number <italic>i</italic> is <italic>p</italic>(<italic>i</italic>) = α<sub><italic>i</italic></sub>. The likelihood that a read count <italic>x</italic> is produced by the <italic>i</italic>-th mixture component is <inline-formula><inline-graphic xlink:href="gks003i3.jpg"/></inline-formula>. Then Bayes' formula can be used to compute the posterior <italic>p</italic>(<italic>i</italic> ∣ <italic>x</italic>), that is, the probability that read count <italic>x</italic> is caused by the <italic>i</italic>-th component corresponding to copy number <italic>i</italic>. Consequently, a read count is assigned the integer copy number with the largest posterior probability.</p>
      </sec>
      <sec>
        <title>Model Selection by an EM Algorithm and Dirichlet Prior</title>
        <p>Suppose that read counts {<italic>x</italic><sub>1</sub>, … , <italic>x</italic><sub><italic>N</italic></sub>} have been observed for <italic>N</italic> samples in a given segment. Model selection is concerned with fitting a model that best explains the training data {<italic>x</italic><sub>1</sub>, … , <italic>x</italic><sub><italic>N</italic></sub>}. In a Bayesian framework, <bold>α</bold> and λ are considered as random variables; thus, <italic>p</italic>(<italic>x</italic>) in Equation (<xref ref-type="disp-formula" rid="gks003-M1">1</xref>) becomes a conditional probability <italic>p</italic>(<italic>x</italic> ∣ <bold>α</bold>, λ), i.e. the likelihood that read count <italic>x</italic> has been produced by the model with parameters <bold>α</bold> and λ. If we assume that, for the prior distribution, the parameters <bold>α</bold> and λ are independent [<italic>p</italic>(<bold>α</bold>,λ) = <italic>p</italic>(<bold>α</bold>)<italic>p</italic>(λ)], then the parameter posterior is
<disp-formula id="gks003-M3"><label>(3)</label><graphic xlink:href="gks003m3"/></disp-formula></p>
        <p>We introduce a <italic>Dirichlet prior p</italic>(<bold>α</bold>) on <bold>α</bold> = (α<sub>0</sub>, α<sub>1</sub>, … ,  α <sub><italic>n</italic></sub>) to include the prior knowledge that almost all locations have copy number 2 for all samples, which is the null hypothesis of constant copy number 2. The Dirichlet prior
<disp-formula id="gks003-M4"><label>(4)</label><graphic xlink:href="gks003m4"/></disp-formula>
with parameter vector <bold>γ</bold> = (γ<sub>0</sub>, γ<sub>1</sub>, … , γ<sub><italic>n</italic></sub>) is well suited to express our prior assumptions about <bold>α</bold>. By setting γ<sub>2</sub> ≫ γ<sub><italic>i</italic></sub> ≥ 1 (for <italic>i</italic> ≠ 2), we ensure that vectors <bold>α</bold> with a large value for α<sub>2</sub>—the percentage of samples having copy number 2—are the most likely to be drawn. Each component <italic>i</italic> of the Dirichlet distribution <italic>p</italic>(<bold>α</bold>) is distributed according to a beta distribution with the mode (γ<sub><italic>i</italic></sub> − 1)/(γ<sub><italic>s</italic></sub> − <italic>n</italic>), where <inline-formula><inline-graphic xlink:href="gks003i4.jpg"/></inline-formula>.</p>
        <p>For the prior on λ, we simply choose a <italic>uniform distribution</italic> on a sufficiently large interval with left endpoint 0.</p>
        <p>An <italic>EM algorithm</italic> minimizes an upper bound on the negative log-posterior of the parameters <bold>α</bold> and λ by following update rules (for details see <ext-link ext-link-type="uri" xlink:href="http://nar.oxfordjournals.org/cgi/content/full/gks003/DC1">Supplementary Section S2.2</ext-link>):
<disp-formula id="gks003-M5"><label>(5)</label><graphic xlink:href="gks003m5"/></disp-formula>
<disp-formula id="gks003-M6"><label>(6)</label><graphic xlink:href="gks003m6"/></disp-formula>
<disp-formula id="gks003-M7"><label>(7)</label><graphic xlink:href="gks003m7"/></disp-formula>
Here, <inline-formula><inline-graphic xlink:href="gks003i5.jpg"/></inline-formula> is an estimate (the E-step of the EM algorithm) of the posterior α<sub><italic>ik</italic></sub> = <italic>p</italic>(<italic>i</italic> ∣ <italic>x</italic><sub><italic>k</italic></sub>, <bold>α</bold>, λ) using current estimations <bold>α</bold><sup>old</sup> and λ<sup>old</sup> of the parameters. We simplify the hyperparameter vector <bold>γ</bold> to one intuitively interpretable hyperparameter <italic>G</italic> by setting γ<sub><italic>i</italic></sub> = 1 for <italic>i</italic> ≠ 2 and γ<sub>2</sub> = 1 + <italic>G</italic>. This setting ensures that α<sub>2</sub> &gt; <italic>G</italic>/(<italic>G</italic> + <italic>N</italic>) in the α<sub><italic>i</italic></sub> update Equation (<xref ref-type="disp-formula" rid="gks003-M6">6</xref>). Thus, a minimum percentage of individuals that have copy number 2 can be ensured by the hyperparameter <italic>G</italic> (for details see <ext-link ext-link-type="uri" xlink:href="http://nar.oxfordjournals.org/cgi/content/full/gks003/DC1">Supplementary Section S2.2</ext-link>).</p>
      </sec>
      <sec>
        <title>I/NI Call: Information Gain of Posterior over Prior</title>
        <p>Based on the Bayesian framework, we define an informative/non-informative (I/NI) call analogous to that of the FARMS algorithm, which excelled at summarization and gene filtering of microarray data (<xref ref-type="bibr" rid="gks003-B29">29</xref>–<xref ref-type="bibr" rid="gks003-B31">31</xref>). In contrast to λ, which captures noise variation, <bold>α</bold> captures variation arising from CNVs; therefore, its posterior indicates CNVs in the data. The I/NI call measures the information gain of the posterior compared to its prior distribution <italic>p</italic>(<bold>α</bold>), which represents the null hypothesis that all samples have copy number 2. Therefore, the I/NI call measures the tendency to reject the null hypothesis based on the observed data.</p>
        <p>We define the I/NI call as a weighted distance between the posterior's mode and the prior's mode (0, 0, 1, 0, … , 0), which results in the expected absolute log fold change relative to copy number 2 (for details see <ext-link ext-link-type="uri" xlink:href="http://nar.oxfordjournals.org/cgi/content/full/gks003/DC1">Supplementary Section S2.3</ext-link>):
<disp-formula id="gks003-M8"><label>(8)</label><graphic xlink:href="gks003m8"/></disp-formula>
with <inline-formula><inline-graphic xlink:href="gks003i6.jpg"/></inline-formula> [this equation is derived in <ext-link ext-link-type="uri" xlink:href="http://nar.oxfordjournals.org/cgi/content/full/gks003/DC1">Supplementary Equation (S25)</ext-link>]. For notational convenience, we did not distinguish between <italic>i</italic> = 0 and <italic>i</italic> ≥ 1 in the above formula. ‘log(0/2)’ must be understood as log(ε/2)—in accordance with the fact that read counts for copy number 0 are Poisson distributed with parameter ελ/2 (see ‘The Model’ section). For <bold>α</bold> = (0, 0, 1, 0, … , 0), the I/NI call is zero, whereas any other <bold>α</bold> gives a positive I/NI call. The more copy numbers differ from 2, the higher is the I/NI call, where gains and losses are treated on the same level by the absolute value of the logarithm. The rightmost term in Equation (<xref ref-type="disp-formula" rid="gks003-M8">8</xref>) makes clear that the I/NI call can be understood as the sum of <italic>individual I/NI calls</italic>, I/NI(<bold>α</bold><sub><italic>k</italic></sub>), that is, the contribution of the <italic>k</italic>-th sample to the I/NI call:
<disp-formula id="gks003-M9"><label>(9)</label><graphic xlink:href="gks003m9"/></disp-formula>
where <bold>α</bold><sub><italic>k</italic></sub> = (α<sub>0<italic>k</italic></sub>, α<sub>1<italic>k</italic></sub>, … , α <sub><italic>nk</italic></sub>) is the vector of posteriors for the read count <italic>x</italic><sub><italic>k</italic></sub>.</p>
      </sec>
    </sec>
    <sec>
      <title>Segmentation and CNV call</title>
      <p><italic>Segmentation</italic> is an important step in CNV detection as it determines the length and position of a CNV (<xref ref-type="fig" rid="gks003-F1">Figure 1</xref>). Class (a) methods perform segmentation on the GC-corrected (log) read counts, while ratio-based methods perform segmentation on the (log) ratios. Some methods, such as JointSLM, apply an HMM for segmentation and CNV detection.</p>
      <p>In the cn.MOPS pipeline, segmentation is based on the results of the modeling step. More specifically, cn.MOPS detects CNVs by segmenting the chromosomes of individuals based on their individual I/NI calls, joining genomically adjacent I/NI calls that show the same copy numbers. Note, however, that the I/NI call defined in Equation (<xref ref-type="disp-formula" rid="gks003-M9">9</xref>) does not distinguish between losses and gains with the same fold change. To avoid joining losses and gains, we define the <italic>signed individual I/NI call</italic> as the expected log fold change:
<disp-formula id="gks003-M10"><label>(10)</label><graphic xlink:href="gks003m10"/></disp-formula>
The absolute value of the signed I/NI call |sI/NI(<bold>α</bold><sub><italic>k</italic></sub>)| is not exactly the I/NI call I/NI(<bold>α</bold><sub><italic>k</italic></sub>), but the two values are always very close (see <ext-link ext-link-type="uri" xlink:href="http://nar.oxfordjournals.org/cgi/content/full/gks003/DC1">Supplementary Section S2.4</ext-link>, for detailed mathematical analysis and experimental evaluations).</p>
      <p>cn.MOPS applies either its own algorithm ‘fastseg’ or, alternatively, the circular binary segmentation algorithm [DNAcopy (<xref ref-type="bibr" rid="gks003-B32">32</xref>)] to sI/NI(<bold>α</bold><sub><italic>k</italic></sub>) along the chromosome. The segmentation algorithm joins consecutive segments with large or small expected fold changes to make a candidate segment. It then supplies candidate segments that show variations along the chromosome and also across samples indicated by the signed individual I/NI calls.</p>
      <p>All CNV detection methods except those based on HMMs decide on the basis of a threshold on the average/median (log) read count or (log) ratio over the segments whether the candidate segments are CNVs. In the cn.MOPS pipeline, a candidate segment is called a CNV segment if the median of the signed individual I/NI call sI/NI(<bold>α</bold><sub><italic>k</italic></sub>) over the segment is at least 0.6 ≈ log<sub>2</sub>(3/2) for gains or at most −1 = log<sub>2</sub>(1/2) for losses. This <italic>CNV call</italic> incorporates two calls: (i) an I/NI call across samples and (ii) a segment call along the chromosome. Only if consecutive segments obtain an I/NI call, they are joined by the segmentation algorithm (see second bar and third sample in <xref ref-type="fig" rid="gks003-F2">Figure 2</xref>). This idea of calling a CNV by detecting both variation across samples and variation along a chromosome has already led to improvements in CNV detection based on DNA microarray data using the cn.FARMS method (<xref ref-type="bibr" rid="gks003-B24">24</xref>).
<fig id="gks003-F2" position="float"><label>Figure 2.</label><caption><p>Illustration of the basic concept of cn.MOPS: a CNV call incorporates the detection of variation across samples (I/NI call) and the detection of variation along a chromosome (segmentation). Curves show read counts along one chromosome for five samples. I/NI calls (green) detect variation across samples (green vertical boxes). A CNV (red box) is called if consecutive segments have high I/NI calls. Blue boxes mark segments that segmentation algorithm of class (a) methods (see the ‘Introduction’ section) would combine into a CNV. First vertical bar (from the left) and first sample: the I/NI call indicates variation across samples (‘I/NI call +’). However, too few adjacent segments show high I/NI calls. Second bar and third sample: the I/NI call indicates variation across samples (‘I/NI call +’) and sufficiently many adjacent segments show high I/NI calls, which leads to a CNV call (red box). Third bar: the read counts drop consistently and would thus be detected by a segmentation algorithm of class (a) methods (blue boxes). However, the read counts of the samples do not vary, which does not lead to an I/NI call (‘I/NI call −’). A CNV is not detected, which is correct as the copy number does not vary across samples. Fourth bar and samples numbers 2 and 4: I/NI call indicates variation across samples (‘I/NI call +’). As in the first bar, too few adjacent segments show high I/NI calls. Fifth bar and second sample: a segmentation algorithm of class (a) methods would combine adjacent read counts that are consistently small (blue box) into a CNV. However, the read counts are within the variation of the constant copy number at this location. Therefore, the I/NI call does not indicate variation across samples (‘I/NI call −’).</p></caption><graphic xlink:href="gks003f2"/></fig></p>
    </sec>
    <sec>
      <title>Integer copy number estimation</title>
      <p>The final step is concerned with <italic>estimating the integer copy numbers</italic> of the CNVs (<xref ref-type="fig" rid="gks003-F1">Figure 1</xref>). Methods based on HMMs, such as JointSLM, automatically obtain integer copy numbers by means of their hidden states. However, most existing methods do not estimate the integer copy numbers of the CNVs.</p>
      <p>cn.MOPS automatically supplies posterior estimates of the integer copy numbers for each segment (<xref ref-type="fig" rid="gks003-F1">Figure 1</xref>). The estimated copy number of a CNV is the most probable posterior copy number, where the segment posteriors within the CNV are assumed to be independent.</p>
    </sec>
  </sec>
  <sec sec-type="results">
    <title>RESULTS</title>
    <p>In order to compare methods that detect copy number variations in NGS data, we first specify the evaluation procedure. Subsequently, we provide an overview of the methods compared and finally we present results on four benchmark data sets.</p>
    <sec>
      <title>Evaluation of CNV detection results</title>
      <p>We assume that the true CNVs are known and to be rediscovered. Each chromosome is split into equally large evaluation segments the size of which is chosen to accommodate the shortest known CNV. An evaluation segment is called a <italic>true positive</italic> (TP) if it is entirely contained both in a true CNV and in a detected CNV segment. It is called a <italic>false negative</italic> (FN) if it is entirely contained in a true CNV but does not overlap with any predicted CNV segment. An evaluation segment is called a <italic>false positive</italic> (FP) if it is entirely detected as a CNV segment but does not overlap with any true CNV. Finally, it is called a <italic>true negative</italic> (TN) if it overlaps neither with a true CNV nor with a detected CNV segment. These definitions imply that all evaluation segments that partly overlap with true CNVs or detected CNV segments remain ignored, as the copy numbers in these segments are ambiguous. <xref ref-type="fig" rid="gks003-F3">Figure 3</xref> illustrates the definitions of the four categories of evaluation segments. The two measures we employ hereafter are <italic>recall</italic> [#TP/(#TP + #FN)] and <italic>precision</italic> [#TP/(#TP + #FP)]. Note that precision is 1-FDR, in which we are especially interested. A CNV calling threshold governs the trade-off between recall and precision or, in other words, the trade-off between FNs and FPs, because more detected CNVs lead to more FPs but fewer FNs, and vice versa. To assess the performance of methods at different CNV calling thresholds, we use <italic>precision-recall curves</italic>. Precision-recall curves are independent of the number of TNs, which makes them an ideal tool for our evaluation, as the majority of samples are negatives (non-CNVs).
<fig id="gks003-F3" position="float"><label>Figure 3.</label><caption><p>Definitions for the evaluation of copy number detection methods. A genome is split into equally sized evaluation segments of a length shorter than the shortest CNV. Top panel: Knowing the true CNV regions (green), the evaluation segments are labeled as class 1 (CNV segment) or class −1 (non-CNV segment). Middle panel: A CNV detection method classifies each evaluation segment into CNV segments (blue, class 1) and non-CNV segments (class −1). Bottom panel: In the first line, positives (known CNV regions) are divided into true positives (TP, green) and false negatives (FN, red). In the second line, negatives (no overlap with known CNV regions) are divided into true negatives (TN, green) and false positives (FP, red). Segments partly overlapping with known or predicted CNV regions are not considered (‘na’).</p></caption><graphic xlink:href="gks003f3"/></fig></p>
    </sec>
    <sec sec-type="methods">
      <title>Methods compared</title>
      <p>We compared the following methods (see the ‘Introduction’ section for an overview):<list list-type="order"><list-item><p>cn.MOPS: our new model and pipeline,</p></list-item><list-item><p>MOFDOC: according to the variant of Alkan <italic>et al.</italic> (<xref ref-type="bibr" rid="gks003-B6">6</xref>),</p></list-item><list-item><p>EWT: Yoon <italic>et al.</italic> (<xref ref-type="bibr" rid="gks003-B15">15</xref>),</p></list-item><list-item><p>JointSLM: Magi <italic>et al.</italic> (<xref ref-type="bibr" rid="gks003-B16">16</xref>),</p></list-item><list-item><p>CNV-Seq: Xie and Tammi (<xref ref-type="bibr" rid="gks003-B20">20</xref>),</p></list-item><list-item><p>FREEC: Boeva <italic>et al.</italic> (<xref ref-type="bibr" rid="gks003-B21">21</xref>).</p></list-item></list></p>
      <p>In this subsection, we provide an overview of the parameter settings, initializations and how these methods were employed.</p>
      <p>cn.MOPS: we initialized the parameter λ with the median read count <inline-formula><inline-graphic xlink:href="gks003i7.jpg"/></inline-formula>. We set ε = 0.05 and assumed nine possible copy numbers 0 ≤ <italic>i</italic> ≤ <italic>n</italic> = 8, which covers previously observed copy numbers in the HapMap individuals (<xref ref-type="bibr" rid="gks003-B17">17</xref>). The parameter <bold>α</bold> should be initialized close to the location of the prior's mode (0, 0, 1, 0, … , 0), which are the optimal parameters if all samples have copy number 2. However, initializing <bold>α</bold> with this vector would clamp all <inline-formula><inline-graphic xlink:href="gks003i8.jpg"/></inline-formula> and <inline-formula><inline-graphic xlink:href="gks003i9.jpg"/></inline-formula> to zero according to Equation (<xref ref-type="disp-formula" rid="gks003-M6">6</xref>) and Equation (<xref ref-type="disp-formula" rid="gks003-M7">7</xref>). Therefore, we initialized <bold>α</bold> with (0.05, 0.05, 0.6, 0.05, … , 0.05).</p>
      <p>MOFDOC: we implemented MOFDOC using the CNV calling criterion of Alkan <italic>et al.</italic> (<xref ref-type="bibr" rid="gks003-B6">6</xref>). A CNV region is called if <italic>a</italic> out of <italic>b</italic> consecutive segments show a read count with a <italic>z</italic>-score below or above thresholds specified to call a loss or gain segment (default values <italic>a</italic> = 6 and <italic>b</italic> = 7). We generalized this ‘<italic>a</italic>-<italic>b</italic>-smoother’ to a smoothing algorithm that is not only able to smooth logical, but also real values arising from CNV calls, which improved MOFDOC's results.</p>
      <p>EWT: we reimplemented event-wise testing as described by Yoon <italic>et al.</italic> (<xref ref-type="bibr" rid="gks003-B15">15</xref>), but improved the GC correction by using all samples to estimate the GC effect. Further, we restricted the minimum ‘event size’, a parameter that prevents EWT from testing for CNVs that are too short. We generalized EWT to a variety of segment sizes that are also apt for low coverage CNV detection. Our modifications to EWT improved its results.</p>
      <p>JointSLM: we applied version 0.1 of the R package <monospace>JointSLM</monospace> adjusting the package to GC content correction for a variety of segment sizes.</p>
      <p>CNV-Seq: we used the authors' implementation (<ext-link ext-link-type="uri" xlink:href="http://tiger.dbs.nus.edu.sg/cnv-seq/">http://tiger.dbs.nus.edu.sg/cnv-seq/</ext-link>), taking the median of the samples' read counts as reference read count.</p>
      <p>FREEC: we used version 3.2 (<ext-link ext-link-type="uri" xlink:href="http://bioinfo-out.curie.fr/projects/freec/">http://bioinfo-out.curie.fr/projects/freec/</ext-link>), taking, analogously to CNV-Seq, the median of the samples' read counts as reference. Although FREEC can perform the analysis without a reference, we used it in ‘reference mode’ because of the improved performance.</p>
      <p>We did not include SeqSeg (<xref ref-type="bibr" rid="gks003-B7">7</xref>) because we were not able to find suitable parameters, not even after an extensive search. The problem was that SeqSeg either did not detect any breakpoints or the thresholds for the <italic>P</italic>-values were not determined. However, the performance of SeqSeg can be estimated via CNV-Seq that is very similar. We also omitted CNAseg (<xref ref-type="bibr" rid="gks003-B19">19</xref>) from the comparison as its developers state that this method is specifically tailored to CNA detection in tumor samples.</p>
      <p>To ensure a fair comparison, the parameters of the methods were optimized on simulated data sets similar to the one we used in our first experiment. More details, for instance, on the parameters that were used and computation time, can be found in the ‘Discussion’ section.</p>
    </sec>
    <sec>
      <title>Simulated data with constructed CNVs</title>
      <p>We constructed 100 artificial benchmark data sets, assuming an artificial genome to consist of a single chromosome of 125 Mb length, divided into 5000 segments of length 25 kb. We created 40 samples by sampling read counts for all segments and samples according to a Poisson process. The overall number of evaluation segments was therefore 40 × 5000 = 200 000.</p>
      <p>The Poisson parameters λ of the Poisson process for simulating the read counts in the evaluation segments were drawn from a distribution of λ values that was estimated using median GC-corrected read counts of HapMap individuals from the 1000 Genomes Project. Therefore, the simulated Poisson distributions are similar to those found in real sequencing experiments. We scaled these λ values by a random number between 0.3 and 1 in order to simulate different coverages. This read count simulation yielded 290 000–770 000 reads, corresponding to a coverage of 0.18–0.46 and 0.08–0.22 for 75 and 36 bp reads, respectively.</p>
      <p>Note that we consider low-coverage sequencing data here, because methods for analyzing SNPs and CNVs in low-coverage data will continue to be relevant in the future. Le and Durbin (<xref ref-type="bibr" rid="gks003-B33">33</xref>) showed that low-coverage data will remain important in the context of single nucleotide polymorphism (SNP) data analysis: in terms of a study's discovery power, where a fixed number of reads should rather be used for sequencing more samples with lower coverage than for sequencing fewer samples with higher coverage. The relationship between discovery power and coverage is similar for CNV data. In the ‘High Coverage Data Sets’ section below, we also simulate high coverage data sets.</p>
      <p>On the basis of HapMap data (<xref ref-type="bibr" rid="gks003-B17">17</xref>), we determined CNV region characteristics and how copy numbers are distributed. We implanted 20 CNV regions into each of the benchmark chromosomes. The lengths of the CNV regions were chosen randomly from the interval 75–200 kb, which, according to Xie and Tammi (<xref ref-type="bibr" rid="gks003-B20">20</xref>), is the range of accurate detection for the given coverage. The 20 starting points of the CNV regions were chosen randomly along the chromosome. After having determined the 20 CNV regions, we had to decide how CNVs are implanted into the single samples. To this end, we first had to take into account that CNVs of different individuals cluster at specific regions of the DNA called ‘CNV regions’, of which many contain only losses or only gains. Based on characteristics of HapMap individuals, we assigned CNV region types such that 80% are of type ‘loss region’ (containing only losses), 15% of type ‘gain region’ (containing only gains), and 5% of type ‘mixed region’ (containing both losses and gains). Then the actual copy number for each sample was drawn according to the copy numbers observed for HapMap individuals (<xref ref-type="bibr" rid="gks003-B17">17</xref>): For a CNV region of type ‘loss region’, a sample has probabilities of 0.8, 0.15 and 0.05 of having copy numbers 2, 1 and 0, respectively. For a CNV region of type ‘gain region’, a sample has probabilities of 0.85, 0.08, 0.06 and 0.01 of having copy numbers 2, 3, 4 and 5, respectively. For a CNV region of type ‘mixed region’, a sample has probabilities 0.04, 0.16, 0.67, 0.11 and 0.02 of having copy numbers 0, 1, 2, 3 and 4, respectively. Of the 200 000 evaluation segments, on average 101 (±56) are gains and 612 (±104) are losses. The CNV lengths range from 75 006 bp to 199 848 bp with an average of 136 921 bp.</p>
      <p><xref ref-type="table" rid="gks003-T1">Table 1</xref> reports the performance of the compared copy number detection methods separately for gains and losses. As evaluation measures, we use the area under the precision-recall curve and the recall for a fixed FDR of 0.05. All methods perform better at detecting losses because it is more likely for gains than for losses to have read counts in the range of copy number 2. This is due to the fact that an average copy number 2 read count is more likely to be produced by copy number 3 than by copy number 1 (see <ext-link ext-link-type="uri" xlink:href="http://nar.oxfordjournals.org/cgi/content/full/gks003/DC1">Supplementary Section S3.3</ext-link>). JointSLM performs worse than other methods because of the low percentage of samples showing an abnormal copy number (the rare events). cn.MOPS yielded the largest average area under the precision-recall curve. The improvement over the other methods is highly significant, as shown by a Wilcoxon signed-rank test. cn.MOPS achieved the highest recall (for FDR fixed at 0.05), which, according to a Wilcoxon test, was also significantly higher than those of the other methods. In summary, cn.MOPS significantly outperformed its competitors on the 100 simulated data sets.
<table-wrap id="gks003-T1" position="float"><label>Table 1.</label><caption><p>Performance of the compared copy number detection methods on the artificial benchmark data set</p></caption><table frame="hsides" rules="groups"><thead align="left"><tr><th rowspan="1" colspan="1"/><th rowspan="1" colspan="1">PR AUC</th><th rowspan="1" colspan="1"><italic>P</italic>-value</th><th rowspan="1" colspan="1">Recall</th><th rowspan="1" colspan="1"><italic>P</italic>-value</th></tr></thead><tbody align="left"><tr><td rowspan="1" colspan="1">Gains</td><td rowspan="1" colspan="1"/><td rowspan="1" colspan="1"/><td rowspan="1" colspan="1"/><td rowspan="1" colspan="1"/></tr><tr><td rowspan="1" colspan="1">    cn.MOPS</td><td rowspan="1" colspan="1"><bold>0.94</bold></td><td rowspan="1" colspan="1">–</td><td rowspan="1" colspan="1"><bold>0.88</bold></td><td rowspan="1" colspan="1">–</td></tr><tr><td rowspan="1" colspan="1">    MOFDOC</td><td rowspan="1" colspan="1">0.81</td><td rowspan="1" colspan="1">1.14e-13</td><td rowspan="1" colspan="1">0.76</td><td rowspan="1" colspan="1">9.75e-12</td></tr><tr><td rowspan="1" colspan="1">    EWT</td><td rowspan="1" colspan="1">0.79</td><td rowspan="1" colspan="1">5.95e-14</td><td rowspan="1" colspan="1">0.74</td><td rowspan="1" colspan="1">1.34e-12</td></tr><tr><td rowspan="1" colspan="1">    JointSLM</td><td rowspan="1" colspan="1">0.25</td><td rowspan="1" colspan="1">4.23e-18</td><td rowspan="1" colspan="1">0.22</td><td rowspan="1" colspan="1">2.80e-17</td></tr><tr><td rowspan="1" colspan="1">    CNV-Seq</td><td rowspan="1" colspan="1">0.35</td><td rowspan="1" colspan="1">4.23e-18</td><td rowspan="1" colspan="1">0.35</td><td rowspan="1" colspan="1">3.98e-17</td></tr><tr><td rowspan="1" colspan="1">    FREEC</td><td rowspan="1" colspan="1">0.65</td><td rowspan="1" colspan="1">1.95e-17</td><td rowspan="1" colspan="1">0.53</td><td rowspan="1" colspan="1">3.42e-14</td></tr><tr><td rowspan="1" colspan="1">Losses</td><td rowspan="1" colspan="1"/><td rowspan="1" colspan="1"/><td rowspan="1" colspan="1"/><td rowspan="1" colspan="1"/></tr><tr><td rowspan="1" colspan="1">    cn.MOPS</td><td rowspan="1" colspan="1"><bold>0.96</bold></td><td rowspan="1" colspan="1">–</td><td rowspan="1" colspan="1"><bold>0.96</bold></td><td rowspan="1" colspan="1">–</td></tr><tr><td rowspan="1" colspan="1">    MOFDOC</td><td rowspan="1" colspan="1">0.92</td><td rowspan="1" colspan="1">3.50e-17</td><td rowspan="1" colspan="1">0.90</td><td rowspan="1" colspan="1">9.22e-17</td></tr><tr><td rowspan="1" colspan="1">    EWT</td><td rowspan="1" colspan="1">0.91</td><td rowspan="1" colspan="1">3.20e-18</td><td rowspan="1" colspan="1">0.90</td><td rowspan="1" colspan="1">8.44e-17</td></tr><tr><td rowspan="1" colspan="1">    JointSLM</td><td rowspan="1" colspan="1">0.34</td><td rowspan="1" colspan="1">1.98e-18</td><td rowspan="1" colspan="1">0.28</td><td rowspan="1" colspan="1">1.98e-18</td></tr><tr><td rowspan="1" colspan="1">    CNV-Seq</td><td rowspan="1" colspan="1">0.81</td><td rowspan="1" colspan="1">1.98e-18</td><td rowspan="1" colspan="1">0.81</td><td rowspan="1" colspan="1">3.84e-17</td></tr><tr><td rowspan="1" colspan="1">    FREEC</td><td rowspan="1" colspan="1">0.73</td><td rowspan="1" colspan="1">1.98e-18</td><td rowspan="1" colspan="1">0.72</td><td rowspan="1" colspan="1">3.32e-17</td></tr></tbody></table><table-wrap-foot><fn><p>‘PR AUC’ gives the average area under the precision-recall curve of 100 experiments. The second column, ‘<italic>P</italic>-value’, reports the <italic>P</italic>-value of a Wilcoxon signed-rank test (over the 100 experiments) with the null hypothesis that cn.MOPS (in bold) and another method have the same area under the curve. ‘Recall’ reports the recall at a precision of 0.95, that is, an FDR of 0.05. The last column, ‘<italic>P</italic>-value’, gives the <italic>P</italic>-value of an analogous Wilcoxon test for the recall with an FDR of 0.05. cn.MOPS performed significantly better than all other methods.</p></fn></table-wrap-foot></table-wrap></p>
    </sec>
    <sec>
      <title>Real sequencing data with implanted CNVs from the X chromosome</title>
      <p>In contrast to simulated read counts, we next considered real reads obtained from the sequencing of a single male HapMap individual (NA20755). This man's genome was sequenced 17 times by the Solexa Genome Analyzer II at the Wellcome Trust Sanger Institute [(<xref ref-type="bibr" rid="gks003-B26">26</xref>) see <ext-link ext-link-type="uri" xlink:href="http://nar.oxfordjournals.org/cgi/content/full/gks003/DC1">Supplementary Table S5</ext-link>]. These 17 samples ensure a constant copy number, as they stem from the same individual. We mapped the reads with Bowtie (<xref ref-type="bibr" rid="gks003-B25">25</xref>) for paired reads, allowing two mismatches. The numbers of reads range from 12 069 758 to 18 810 212, of which between 10 419 510 and 16 041 464 could be mapped, which corresponds to coverages between 0.13 and 0.21 (see <ext-link ext-link-type="uri" xlink:href="http://nar.oxfordjournals.org/cgi/content/full/gks003/DC1">Supplementary Section S3.3</ext-link>, for details on read mapping and the number of reads).</p>
      <p>We created 110 benchmark data sets by choosing each of human chromosomes 1–22 five times, implanting 20 random CNV regions in each chromosome data set. The lengths of these implanted CNV regions were chosen to be 75, 100, 150, and 200 kb (5 each), and, for each of the regions, a random segment on the X chromosome which supplied reads for the region was selected. CNV region types and individual copy numbers were determined according to the procedure and distributions described in the first experiment except that we only considered CNV copy numbers 1 and 3 since they are the most difficult to distinguish from copy number 2. We assigned CNV region types such that 80% are of ‘loss region’ type, 15% of ‘gain region’ type, and 5% of ‘mixed region’ type. For a CNV region of ‘loss region’ type, a sample has probabilities 0.8 and 0.2 of having copy number 2 and 1, respectively, for a CNV region of ‘gain region’ type, 0.85 and 0.15 of having copy numbers 2 and 3, respectively, and for a CNV region of ‘mixed region’ type, 0.2, 0.67 and 0.13 of having copy numbers 1, 2 and 3, respectively. Finally, the read counts of the 17 samples were computed in the following way: outside CNVs the original reads counts were used; within CNVs, we added as many read counts as there are copies from the corresponding segment on the X chromosome, taking independent read counts from the considered sample and other random samples.</p>
      <p>The CNV detection results were evaluated as described in the ‘Evaluation of CNV Detection Results’ section. The number of evaluation segments ranges from around 32 000 for chromosome 21 to around 168 000 for chromosome 1. On average, 0.1% of the evaluation segments are gains and 0.4% are losses.</p>
      <p><xref ref-type="table" rid="gks003-T2">Table 2</xref> reports the performance of the compared copy number detection methods separately for gains and losses. As before, we use the area under the precision-recall curve and the recall for the FDR fixed at 0.05. Again, all methods performed better at detecting losses. If we adhere to the Poisson assumption, the reasons for this performance difference are the same as those stated in the first experiment. cn.MOPS significantly outperformed all other methods with respect to both the area under the precision-recall curve (PR AUC) and the recall for FDR at 0.05. No method considers the variation of the read counts across samples, except cn.MOPS, which estimates this variation via its Poisson parameter, thus achieving superior performance.
<table-wrap id="gks003-T2" position="float"><label>Table 2.</label><caption><p>Performance of the compared copy number detection methods on real sequencing data with implanted CNVs from the X chromosome</p></caption><table frame="hsides" rules="groups"><thead align="left"><tr><th rowspan="1" colspan="1"/><th rowspan="1" colspan="1">PR AUC</th><th rowspan="1" colspan="1"><italic>P</italic>-value</th><th rowspan="1" colspan="1">Recall</th><th rowspan="1" colspan="1"><italic>P</italic>-value</th></tr></thead><tbody align="left"><tr><td rowspan="1" colspan="1">Gains</td><td rowspan="1" colspan="1"/><td rowspan="1" colspan="1"/><td rowspan="1" colspan="1"/><td rowspan="1" colspan="1"/></tr><tr><td rowspan="1" colspan="1">    cn.MOPS</td><td rowspan="1" colspan="1"><bold>0.70</bold></td><td rowspan="1" colspan="1">–</td><td rowspan="1" colspan="1"><bold>0.65</bold></td><td rowspan="1" colspan="1">–</td></tr><tr><td rowspan="1" colspan="1">    MOFDOC</td><td rowspan="1" colspan="1">0.20</td><td rowspan="1" colspan="1">1.12e-17</td><td rowspan="1" colspan="1">0.10</td><td rowspan="1" colspan="1">2.31e-17</td></tr><tr><td rowspan="1" colspan="1">    EWT</td><td rowspan="1" colspan="1">0.22</td><td rowspan="1" colspan="1">1.95e-16</td><td rowspan="1" colspan="1">0.13</td><td rowspan="1" colspan="1">8.70e-17</td></tr><tr><td rowspan="1" colspan="1">    JointSLM</td><td rowspan="1" colspan="1">0.06</td><td rowspan="1" colspan="1">1.94e-19</td><td rowspan="1" colspan="1">0.03</td><td rowspan="1" colspan="1">7.00e-18</td></tr><tr><td rowspan="1" colspan="1">    CNV-Seq</td><td rowspan="1" colspan="1">0.13</td><td rowspan="1" colspan="1">1.74e-19</td><td rowspan="1" colspan="1">0.13</td><td rowspan="1" colspan="1">5.75e-18</td></tr><tr><td rowspan="1" colspan="1">    FREEC</td><td rowspan="1" colspan="1">0.49</td><td rowspan="1" colspan="1">1.22e-12</td><td rowspan="1" colspan="1">0.30</td><td rowspan="1" colspan="1">4.41e-15</td></tr><tr><td rowspan="1" colspan="1">Losses</td><td rowspan="1" colspan="1"/><td rowspan="1" colspan="1"/><td rowspan="1" colspan="1"/><td rowspan="1" colspan="1"/></tr><tr><td rowspan="1" colspan="1">    cn.MOPS</td><td rowspan="1" colspan="1"><bold>0.89</bold></td><td rowspan="1" colspan="1">–</td><td rowspan="1" colspan="1"><bold>0.88</bold></td><td rowspan="1" colspan="1">–</td></tr><tr><td rowspan="1" colspan="1">    MOFDOC</td><td rowspan="1" colspan="1">0.57</td><td rowspan="1" colspan="1">3.78e-15</td><td rowspan="1" colspan="1">0.21</td><td rowspan="1" colspan="1">2.48e-18</td></tr><tr><td rowspan="1" colspan="1">    EWT</td><td rowspan="1" colspan="1">0.62</td><td rowspan="1" colspan="1">1.77e-12</td><td rowspan="1" colspan="1">0.34</td><td rowspan="1" colspan="1">2.02e-17</td></tr><tr><td rowspan="1" colspan="1">    JointSLM</td><td rowspan="1" colspan="1">0.17</td><td rowspan="1" colspan="1">4.43e-20</td><td rowspan="1" colspan="1">0.08</td><td rowspan="1" colspan="1">4.43e-20</td></tr><tr><td rowspan="1" colspan="1">    CNV-Seq</td><td rowspan="1" colspan="1">0.50</td><td rowspan="1" colspan="1">4.43e-20</td><td rowspan="1" colspan="1">0.50</td><td rowspan="1" colspan="1">4.43e-20</td></tr><tr><td rowspan="1" colspan="1">    FREEC</td><td rowspan="1" colspan="1">0.52</td><td rowspan="1" colspan="1">7.05e-17</td><td rowspan="1" colspan="1">0.36</td><td rowspan="1" colspan="1">4.56e-20</td></tr></tbody></table><table-wrap-foot><fn><p>‘PR AUC’ gives the average area under the precision-recall curve of 100 experiments. The second column, ‘<italic>P</italic>-value’, reports the <italic>P</italic>-value of a Wilcoxon signed-rank test (over the 100 experiments) with the null hypothesis that cn.MOPS (in bold) and another method have the same area under the curve. ‘Recall’ reports the recall at a precision of 0.95, that is, an FDR of 0.05. The last column, ‘<italic>P</italic>-value’, gives the <italic>P</italic>-value of an analogous Wilcoxon test for the recall with an FDR of 0.05. cn.MOPS outperformed all other methods significantly.</p></fn></table-wrap-foot></table-wrap></p>
    </sec>
    <sec>
      <title>Rediscovery of known CNVs in HapMap sequencing data</title>
      <p>Next, we compared how well the methods are able to rediscover known CNVs of HapMap individuals whose DNA was sequenced by the Solexa Genome Analyzer II at the Wellcome Trust Sanger Institute (<xref ref-type="bibr" rid="gks003-B26">26</xref>). We focused on 18 individuals for each of whom the reads were produced on one lane (one sequencing run contains seven lanes). The reads were mapped by Bowtie (<xref ref-type="bibr" rid="gks003-B25">25</xref>) for paired reads, allowing three mismatches. The numbers of reads range from 12 442 124 to 31 977 690, of which 7 498 420–22 217 020 could be mapped, which lead to a coverage between 0.20 and 0.60 (see <ext-link ext-link-type="uri" xlink:href="http://nar.oxfordjournals.org/cgi/content/full/gks003/DC1">Supplementary Section S3.4</ext-link>, for details on individuals, read mapping and the number of reads). We considered the CNVs of these 18 individuals, determined previously by means of microarrays (<xref ref-type="bibr" rid="gks003-B17">17</xref>), to be the true CNVs. They were detected by the Affymetrix Human SNP array 6.0 and reconfirmed with the Illumina Human1M-single BeadChip. After filtering for CNVs larger than 75 kb, we obtained 170 CNVs, of which 66 are gains and 104 are losses, with lengths ranging from 76 kb to 457 kb. Though some of these CNVs might still be false positives, the double confirmation and considering only CNVs of vast lengths approaches a golden standard. The CNV detection results were evaluated as described in the ‘Evaluation of CNV Detection Results’ section with evaluation segments of length 25 kb. In total, we have 2 064 906 evaluation segments, of which 450 are labeled as losses, as they lie within one of the 104 loss CNVs, and 469 are labeled as gains, as they lie within one of the 66 gain CNVs.</p>
      <p><xref ref-type="table" rid="gks003-T3">Table 3</xref> shows the performance of the six compared methods at rediscovering known CNVs for the 18 HapMap individuals, where the average area under the precision-recall curve is used as evaluation criterion. As found in previous experiments, all methods perform better at detecting losses. cn.MOPS performs significantly better than its competitors in terms of both the PR AUC and the recall for an FDR of 0.05, although FREEC performs equally well for gains.
<table-wrap id="gks003-T3" position="float"><label>Table 3.</label><caption><p>Performance of the compared copy number detection methods on HapMap individuals, where known CNVs should be rediscovered</p></caption><table frame="hsides" rules="groups"><thead align="left"><tr><th rowspan="1" colspan="1"/><th rowspan="1" colspan="1">PR AUC</th><th rowspan="1" colspan="1"><italic>P</italic>-value</th><th rowspan="1" colspan="1">Recall</th><th rowspan="1" colspan="1"><italic>P</italic>-value</th></tr></thead><tbody align="left"><tr><td rowspan="1" colspan="1">Gains</td><td rowspan="1" colspan="1"/><td rowspan="1" colspan="1"/><td rowspan="1" colspan="1"/><td rowspan="1" colspan="1"/></tr><tr><td rowspan="1" colspan="1">    cn.MOPS</td><td rowspan="1" colspan="1"><bold>0.35</bold></td><td rowspan="1" colspan="1">–</td><td rowspan="1" colspan="1"><bold>0.24</bold></td><td rowspan="1" colspan="1">–</td></tr><tr><td rowspan="1" colspan="1">    MOFDOC</td><td rowspan="1" colspan="1">0.13</td><td rowspan="1" colspan="1">1.17e-03</td><td rowspan="1" colspan="1">0.06</td><td rowspan="1" colspan="1">1.95e-03</td></tr><tr><td rowspan="1" colspan="1">    EWT</td><td rowspan="1" colspan="1">0.16</td><td rowspan="1" colspan="1">5.34e-04</td><td rowspan="1" colspan="1">0.10</td><td rowspan="1" colspan="1">1.86e-02</td></tr><tr><td rowspan="1" colspan="1">    JointSLM</td><td rowspan="1" colspan="1">0.08</td><td rowspan="1" colspan="1">3.81e-05</td><td rowspan="1" colspan="1">0.05</td><td rowspan="1" colspan="1">7.81e-03</td></tr><tr><td rowspan="1" colspan="1">    CNV-Seq</td><td rowspan="1" colspan="1">0.22</td><td rowspan="1" colspan="1">1.74e-02</td><td rowspan="1" colspan="1"><bold>0.21</bold></td><td rowspan="1" colspan="1">3.61e-01</td></tr><tr><td rowspan="1" colspan="1">    FREEC</td><td rowspan="1" colspan="1"><bold>0.35</bold></td><td rowspan="1" colspan="1">8.68e-01</td><td rowspan="1" colspan="1"><bold>0.17</bold></td><td rowspan="1" colspan="1">2.38e-01</td></tr><tr><td rowspan="1" colspan="1">Losses</td><td rowspan="1" colspan="1"/><td rowspan="1" colspan="1"/><td rowspan="1" colspan="1"/><td rowspan="1" colspan="1"/></tr><tr><td rowspan="1" colspan="1">    cn.MOPS</td><td rowspan="1" colspan="1"><bold>0.53</bold></td><td rowspan="1" colspan="1">–</td><td rowspan="1" colspan="1"><bold>0.45</bold></td><td rowspan="1" colspan="1">–</td></tr><tr><td rowspan="1" colspan="1">    MOFDOC</td><td rowspan="1" colspan="1">0.40</td><td rowspan="1" colspan="1">2.67e-04</td><td rowspan="1" colspan="1">0.33</td><td rowspan="1" colspan="1">3.42e-03</td></tr><tr><td rowspan="1" colspan="1">    EWT</td><td rowspan="1" colspan="1">0.36</td><td rowspan="1" colspan="1">7.63e-06</td><td rowspan="1" colspan="1">0.23</td><td rowspan="1" colspan="1">6.10e-05</td></tr><tr><td rowspan="1" colspan="1">    JointSLM</td><td rowspan="1" colspan="1">0.15</td><td rowspan="1" colspan="1">3.81e-06</td><td rowspan="1" colspan="1">0.06</td><td rowspan="1" colspan="1">1.53e-05</td></tr><tr><td rowspan="1" colspan="1">    CNV-Seq</td><td rowspan="1" colspan="1">0.32</td><td rowspan="1" colspan="1">7.63e-05</td><td rowspan="1" colspan="1">0.27</td><td rowspan="1" colspan="1">3.66e-04</td></tr><tr><td rowspan="1" colspan="1">    FREEC</td><td rowspan="1" colspan="1">0.42</td><td rowspan="1" colspan="1">2.37e-03</td><td rowspan="1" colspan="1">0.26</td><td rowspan="1" colspan="1">1.01e-03</td></tr></tbody></table><table-wrap-foot><fn><p>‘PR AUC’ gives the average area under the precision-recall curve of 18 samples. The second column, ‘<italic>P</italic>-value’, reports the <italic>P</italic>-value of a Wilcoxon signed-rank test (over the 18 samples) with the null hypothesis that cn.MOPS (in bold) and another method have the same area under the curve. ‘Recall’ reports the recall at a precision of 0.95, that is, an FDR of 0.05. The last column, ‘<italic>P</italic>-value’, gives the <italic>P</italic>-value of an analogous Wilcoxon test for the recall with an FDR of 0.05. cn.MOPS rediscovered known CNVs most reliably. Only for gains the performance of FREEC is similar to that of cn.MOPS, whereas cn.MOPS performs significantly better than all its competitors at losses.</p></fn></table-wrap-foot></table-wrap></p>
      <p>So far we have considered CNV detection as a classification task whose goal was to detect CNVs in individual samples. In order to assess the quality of the CNV calling across HapMap samples, we also investigated the performance of each method at a different task—detecting segments in which at least one CNV occurs in one sample. For this task, we did not obtain segments from a segmentation algorithm, but we computed a CNV call for each evaluation segment. The CNV calls must be defined depending on the method. For cn.MOPS, we utilized the I/NI call. For <italic>z</italic>-score based methods, namely MOFDOC, EWT and JointSLM, we used the mean of the <italic>z</italic>-score on the evaluation segment. For the ratio-based methods, CNV-Seq and FREEC, we took the mean log-ratios of the evaluation segments. The area under precision-recall curve was 0.18 for the I/NI call, 0.02 for the mean <italic>z</italic>-score, and 0.14 for the mean log-ratio. The area under curve values are lower than in the other experiments because outliers were not filtered out by a segmentation algorithm. Alternative CNV calls such as variance and maximum-based values are reported in <ext-link ext-link-type="uri" xlink:href="http://nar.oxfordjournals.org/cgi/content/full/gks003/DC1">Supplementary Section S3.5</ext-link>.</p>
      <p><xref ref-type="fig" rid="gks003-F4">Figure 4</xref> visualizes the results of this comparison in the form of whole-genome CNV calling plots along all evaluation segments. cn.MOPS separates true CNVs (indicated by red dots) from non-CNV segments (blue dots) more successfully than the other methods. Furthermore, cn.MOPS has lower FDRs for different calling thresholds, as can be seen from the lower variance of the blue dots at the bottom. The superior performance of cn.MOPS at CNV calling across samples is the reason why cn.MOPS outperformed the other methods in previous experiments.
<fig id="gks003-F4" position="float"><label>Figure 4.</label><caption><p>Whole-genome CNV calling plots that visualize the performance of cn.MOPS, MOFDOC, EWT, JointSLM, CNV-Seq, and FREEC at rediscovering known CNVs of HapMap individuals. The plots visualize CNV calling values (vertical axis) along chromosomes 1–22 of the human genome without segmentation. The first panel shows the I/NI call used for cn.MOPS. The second panel provides mean <italic>z</italic>-scores used by EWT, JointSLM, while the last panel depicts mean log-ratios used by CNV-Seq and FREEC. We called the largest 0.5% of the CNV calling values (blue dots) and scaled them to maximum one. Darker shades of blue indicate a high density of calling values. True CNV regions are displayed as light red bars, and the corresponding CNV calls are indicated by red dots. Segments without calling values (white segments) correspond to assembly gaps in the reference genome. A perfect calling method would call all segments in true CNV regions (red dots) at maximum 1 and would call others (blue dots) at minimum 0. Arrows indicate segments in true CNV regions that are called by one method group but not by the other method groups. A threshold of 0.6 for log-ratios-based methods, namely CNV-Seq and FREEC, and a threshold of 0.8 for cn.MOPS would lead to the same true positive rate, while cn.MOPS yields fewer false discoveries (lower FDR). cn.MOPS is better at separating segments of true CNV regions from non-CNV segments than the other methods, as indicated by the lower variance of I/NI values (see blue area at the bottom of the first panel). The better separation by cn.MOPS results in FDRs lower than those of other methods, regardless of the calling thresholds.</p></caption><graphic xlink:href="gks003f4"/></fig></p>
    </sec>
    <sec>
      <title>High coverage data sets</title>
      <p>Finally, we compared the performance of CNV detection methods on two high coverage data sets. The first data set is simulated analogously to our previous simulated data but now with high coverage. On this data set we first show that, if we fix the resolution, higher coverage leads to better performance in terms of precision and recall. Next we show that, if we fix the performance in terms of precision and recall, higher coverage allows for higher resolution. The second data set consists of six high coverage samples from the 1000 Genomes Project on which we show that cn.MOPS is well suited for high coverage data sets (for details see <ext-link ext-link-type="uri" xlink:href="http://nar.oxfordjournals.org/cgi/content/full/gks003/DC1">Supplementary Section S3.6</ext-link>).</p>
      <p><italic>Simulated Data: Coverage</italic> versus Performance and Resolution. The first data set was simulated as described in the ‘Simulated Data with Constructed CNVs’ section, but now with different depths of coverage including high coverage. These data allow for investigating the impact of increasing coverage on the performance and on the resolution of CNV detection methods. In order to evaluate the methods as realistically as possible, we drew small blocks of consecutive λ values from data of the 1000 Genomes Project to include mutual dependencies between adjacent segments like in real data.</p>
      <p>First, in order to analyze the dependencies between <italic>coverage and performance</italic>, we implanted short CNVs with lengths 1–5 kb in a 25 Mb chromosome. To be able to detect CNVs of these lengths, we chose a segment length of 250 bp for all compared methods. For each of the coverages 1×, 5×, 10×, 25× and 50×, we generated 10 data sets and determined the recall of each method at a fixed FDR of 0.05. <xref ref-type="fig" rid="gks003-F5">Figure 5</xref> shows that the average performance of all methods increases with the depth of coverage. Again, cn.MOPS outperforms the other methods at all coverages.
<fig id="gks003-F5" position="float"><label>Figure 5.</label><caption><p>CNV detection performance for different levels of coverage. Each curve in the two panels corresponds to the recall of one method at detecting short CNVs of lengths 1–5 kb (left panel: gains; right panel: losses). The FDR was fixed at 0.05.</p></caption><graphic xlink:href="gks003f5"/></fig></p>
      <p>Second, we analyzed the dependencies between <italic>coverage and resolution</italic> for cn.MOPS. We implanted CNVs of different ranges of lengths 1–5 kb, 5–25 kb, 25–75 kb and 100–125 kb into chromosomes of lengths 25, 125, 250 and 250 Mb, respectively. For each of the coverages 1×, 5×, 10×, 25× or 50× and each range of CNV lengths, cn.MOPS is evaluated on 10 simulated data sets. In each run, we chose the segment size as a fifth of the minimal CNV length. <xref ref-type="table" rid="gks003-T4">Table 4</xref> shows the recall of cn.MOPS for different coverages, again at a fixed FDR of 0.05. Obviously, for a given performance threshold of 0.95, higher coverage allows for higher resolution.
<table-wrap id="gks003-T4" position="float"><label>Table 4.</label><caption><p>Average recall values of cn.MOPS at an FDR of 0.05 for different levels of coverage and different CNV lengths, along with their standard deviations over the 10 runs</p></caption><table frame="hsides" rules="groups"><tbody align="left"><tr><td rowspan="1" colspan="1"><inline-graphic xlink:href="gks003t1.jpg"/></td></tr></tbody></table></table-wrap></p>
      <sec>
        <title>High Coverage Real World Data: Performance Comparison</title>
        <p>On the second high coverage data set from the 1000 Genomes Project we compare the performance of CNV detection methods. The data consist of alignment files of chromosome 1 of two trios that were sequenced at a coverage of 20–60×. A segment length of 500 bp led to 498 502 segments. The International HapMap 3 Consortium (<xref ref-type="bibr" rid="gks003-B17">17</xref>) found 68 CNVs of ‘loss’ type and 4 of ‘gain’ type, which we considered as true CNVs. Using these true CNVs, out of 2 991 012 evaluation segments, 192 were gains and 2016 losses.</p>
        <p>Again, the performance of the CNV detection methods was evaluated by the area under the precision-recall curve and the recall at a fixed FDR. For this experiment, however, we report the recall value at an FDR of 0.9, since all methods detect a large number of new CNVs thus resulting in indistinguishable small recalls at an FDR of 0.05. <xref ref-type="table" rid="gks003-T5">Table 5</xref> shows the results. cn.MOPS performs best, where EWT performs equally well for losses in terms of the area under the precision-recall curve.
<table-wrap id="gks003-T5" position="float"><label>Table 5.</label><caption><p>Performance of the compared copy number detection methods for six high coverage samples from the 1000 Genomes Project</p></caption><table frame="hsides" rules="groups"><thead align="left"><tr><th rowspan="1" colspan="1"/><th colspan="2" align="center" rowspan="1">Gains<hr/></th><th colspan="2" align="center" rowspan="1">Losses<hr/></th></tr><tr><th rowspan="1" colspan="1"/><th rowspan="1" colspan="1">PR AUC</th><th rowspan="1" colspan="1">Recall</th><th rowspan="1" colspan="1">PR AUC</th><th rowspan="1" colspan="1">Recall</th></tr></thead><tbody align="left"><tr><td rowspan="1" colspan="1">cn.MOPS</td><td rowspan="1" colspan="1"><bold>0.34</bold></td><td rowspan="1" colspan="1"><bold>0.92</bold></td><td rowspan="1" colspan="1"><bold>0.33</bold></td><td rowspan="1" colspan="1"><bold>0.59</bold></td></tr><tr><td rowspan="1" colspan="1">MOFDOC</td><td rowspan="1" colspan="1">0.00</td><td rowspan="1" colspan="1">0.00</td><td rowspan="1" colspan="1">0.21</td><td rowspan="1" colspan="1">0.28</td></tr><tr><td rowspan="1" colspan="1">EWT</td><td rowspan="1" colspan="1">0.00</td><td rowspan="1" colspan="1">0.00</td><td rowspan="1" colspan="1">0.30</td><td rowspan="1" colspan="1">0.37</td></tr><tr><td rowspan="1" colspan="1">JointSLM</td><td rowspan="1" colspan="1">0.01</td><td rowspan="1" colspan="1">0.00</td><td rowspan="1" colspan="1">0.26</td><td rowspan="1" colspan="1">0.26</td></tr><tr><td rowspan="1" colspan="1">CNV-Seq</td><td rowspan="1" colspan="1">0.14</td><td rowspan="1" colspan="1">0.79</td><td rowspan="1" colspan="1">0.26</td><td rowspan="1" colspan="1">0.38</td></tr><tr><td rowspan="1" colspan="1">FREEC</td><td rowspan="1" colspan="1">0.26</td><td rowspan="1" colspan="1"><bold>0.92</bold></td><td rowspan="1" colspan="1">0.22</td><td rowspan="1" colspan="1">0.25</td></tr></tbody></table><table-wrap-foot><fn><p>‘PR AUC’ gives the area under precision-recall curve. ‘Recall’ reports the recall at a precision of 0.1. cn.MOPS performs best, where FREEC performs equally well for gains in terms of recall.</p></fn></table-wrap-foot></table-wrap></p>
        <p>In <ext-link ext-link-type="uri" xlink:href="http://nar.oxfordjournals.org/cgi/content/full/gks003/DC1">Supplementary Section S3.7</ext-link>, we additionally provide experiments on a 58 sample data set of medium sequencing coverage from the 1000 Genomes Project. cn.MOPS performs well on this data set with considerable more samples than the current data set, too.</p>
        <p>We have shown that cn.MOPS is also well suited for high coverage data sets on which it outperformed its competitors.</p>
      </sec>
    </sec>
  </sec>
  <sec sec-type="discussion">
    <title>DISCUSSION</title>
    <sec>
      <title>Data Access</title>
      <p>The data of the second, third and fourth experiment are part of the 1000 Genomes Project. For the second experiment we used one chromosome from a Tuscany sample (NA20755), for the third experiment 18 samples from Pilot Phase 1, and for the fourth experiment chromosome 1 of 6 high coverage samples in order to comply with the Ft. Lauderdale principle for use of unpublished data for method development.</p>
    </sec>
    <sec>
      <title>Limitations</title>
      <p>cn.MOPS cannot be applied to a single sample because it decomposes variations along samples into those stemming from copy numbers and those from noise. The quality of this decomposition increases with the number of samples. We recommend to use at least 6 samples for proper parameter estimation (see <ext-link ext-link-type="uri" xlink:href="http://nar.oxfordjournals.org/cgi/content/full/gks003/DC1">Supplementary Section S3.9</ext-link>). If the majority of samples has a copy number different from 2, then the cn.MOPS model regards this copy number as copy number 2. However, this incorrect assignment of components to copy numbers can readily be corrected by comparing the expected read counts (the parameter λ) along the chromosome.</p>
    </sec>
    <sec>
      <title>Computational Costs</title>
      <p>With massively growing amounts of NGS data, computation time is becoming an increasingly important, and possibly limiting, factor in CNV analysis. To create an impression of the computational cost of cn.MOPS, we report the computation times for a medium coverage data set (see <ext-link ext-link-type="uri" xlink:href="http://nar.oxfordjournals.org/cgi/content/full/gks003/DC1">Supplementary Section S3.7</ext-link> and <ext-link ext-link-type="uri" xlink:href="http://nar.oxfordjournals.org/cgi/content/full/gks003/DC1">Supplementary Table S17</ext-link>). The data set consists of chromosome 20 of 58 samples from the 1000 Genomes Project with coverages ranging from 2.5× to 8×. Not surprisingly, the model-free approaches MOFDOC (110s), EWT (239s) and CNV-Seq (96s) were faster than the model-based approaches cn.MOPS (250s), JointSLM (1001s), and FREEC (693s), where cn.MOPS was the fastest among the model-based methods. All computations were done on a Linux server with Intel® Xeon® CPU with 2.27GHz. In order to facilitate a fair comparison, all computations were performed on single processors only. Note, however, that cn.MOPS can be parallelized easily since it models each genomic location independently. The parallelization is already implemented in the R package <monospace>cn.mops</monospace> (but was not used in the above comparison).</p>
    </sec>
    <sec>
      <title>NGS-based versus array-based CNV detection</title>
      <p>For the HapMap data set, microarray-based techniques missed CNVs that are clearly identified by sequencing techniques. This entails that CNV detection in NGS data will be important in the future to complement and confirm CNVs previously detected by microarray techniques. In contrast to microarrays, NGS allows estimation of allele-specific copy numbers without a priori allele selection, which, in the context of diseases, is especially relevant for determining whether an allele is fully functional.</p>
    </sec>
    <sec>
      <title>Exon sequencing</title>
      <p>We are currently adapting cn.MOPS to analyze data from exon sequencing (ExonSeq), where DNA fragments are first captured by hybridization to probes attached to baits and then sequenced. For exon sequencing, the read counts show higher variation along the chromosome because hybridization and cross-hybridization effects are introduced via the baits. Thus, cn.MOPS is even better suited to this task than other methods. First results are very promising.</p>
    </sec>
  </sec>
  <sec sec-type="conclusions">
    <title>CONCLUSION</title>
    <p>We have introduced cn.MOPS—a novel method and pipeline for the detection of copy number variations in NGS data. cn.MOPS incorporates a probabilistic model that decomposes read variations across samples into integer copy numbers and noise by means of its mixture components and its Poisson distributions, respectively. cn.MOPS is able to control the FDR for CNV detection via a Dirichlet prior on the model's mixture components. The Dirichlet prior prefers a constant copy number of 2 for all samples, which corresponds to the null hypothesis. The more the data drag the posterior away from the Dirichlet prior, the more likely a CNV is present in the data.</p>
    <p>We compared cn.MOPS with the five most popular CNV detection methods using four benchmark data sets. For all benchmarks, cn.MOPS outperformed its competitors, especially in terms of FDR.</p>
  </sec>
  <sec>
    <title>SUPPLEMENTARY DATA</title>
    <p><ext-link ext-link-type="uri" xlink:href="http://nar.oxfordjournals.org/cgi/content/full/gks003/DC1">Supplementary Data</ext-link> are available at NAR Online: Supplementary Tables S1–S17, Supplementary Figures S1–S14 and Supplementary Sections S1–S4.</p>
  </sec>
  <sec>
    <title>FUNDING</title>
    <p>Funding for open access charge: <funding-source>Funds from the Institute of Bioinformatics</funding-source>, <funding-source>Johannes Kepler University Linz</funding-source>.</p>
    <p><italic>Conflict of interest statement</italic>. None declared.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material id="PMC_1" content-type="local-data">
      <caption>
        <title>Supplementary Data</title>
      </caption>
      <media mimetype="text" mime-subtype="html" xlink:href="supp_40_9_e69__index.html"/>
      <media xlink:role="associated-file" mimetype="application" mime-subtype="pdf" xlink:href="supp_gks003_nar-02180-met-n-2011-File011.pdf"/>
      <media xlink:role="associated-file" mimetype="application" mime-subtype="vnd.ms-excel" xlink:href="supp_gks003_nar-02180-met-n-2011-File012.xls"/>
    </supplementary-material>
  </sec>
</body>
<back>
  <ref-list>
    <title>REFERENCES</title>
    <ref id="gks003-B1">
      <label>1</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>DePristo</surname>
            <given-names>MA</given-names>
          </name>
          <name>
            <surname>Banks</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Poplin</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Garimella</surname>
            <given-names>KV</given-names>
          </name>
          <name>
            <surname>Maguire</surname>
            <given-names>JR</given-names>
          </name>
          <name>
            <surname>Hartl</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Philippakis</surname>
            <given-names>AA</given-names>
          </name>
          <name>
            <surname>del Angel</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Rivas</surname>
            <given-names>MA</given-names>
          </name>
          <name>
            <surname>Hanna</surname>
            <given-names>M</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>A framework for variation discovery and genotyping using next-generation DNA sequencing data</article-title>
        <source>Nat. Genet.</source>
        <year>2011</year>
        <volume>43</volume>
        <fpage>491</fpage>
        <lpage>498</lpage>
        <pub-id pub-id-type="pmid">21478889</pub-id>
      </element-citation>
    </ref>
    <ref id="gks003-B2">
      <label>2</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lander</surname>
            <given-names>ES</given-names>
          </name>
        </person-group>
        <article-title>Initial impact of the sequencing of the human genome</article-title>
        <source>Nature</source>
        <year>2011</year>
        <volume>470</volume>
        <fpage>187</fpage>
        <lpage>197</lpage>
        <pub-id pub-id-type="pmid">21307931</pub-id>
      </element-citation>
    </ref>
    <ref id="gks003-B3">
      <label>3</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Sultan</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Schulz</surname>
            <given-names>MH</given-names>
          </name>
          <name>
            <surname>Richard</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Magen</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Klingenhoff</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Scherf</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Seifert</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Borodina</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Soldatov</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Parkhomchuk</surname>
            <given-names>D</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>A global view of gene activity and alternative splicing by deep sequencing of the human transcriptome</article-title>
        <source>Science</source>
        <year>2008</year>
        <volume>321</volume>
        <fpage>956</fpage>
        <lpage>960</lpage>
        <pub-id pub-id-type="pmid">18599741</pub-id>
      </element-citation>
    </ref>
    <ref id="gks003-B4">
      <label>4</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bullard</surname>
            <given-names>JH</given-names>
          </name>
          <name>
            <surname>Purdom</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Hansen</surname>
            <given-names>KD</given-names>
          </name>
          <name>
            <surname>Dudoit</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>Evaluation of statistical methods for normalization and differential expression in mRNA-Seq experiments</article-title>
        <source>BMC Bioinformatics</source>
        <year>2010</year>
        <volume>11</volume>
        <fpage>94</fpage>
        <pub-id pub-id-type="pmid">20167110</pub-id>
      </element-citation>
    </ref>
    <ref id="gks003-B5">
      <label>5</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Łabaj</surname>
            <given-names>PP</given-names>
          </name>
          <name>
            <surname>Leparc</surname>
            <given-names>GG</given-names>
          </name>
          <name>
            <surname>Linggi</surname>
            <given-names>BE</given-names>
          </name>
          <name>
            <surname>Markillie</surname>
            <given-names>LM</given-names>
          </name>
          <name>
            <surname>Wiley</surname>
            <given-names>SH</given-names>
          </name>
          <name>
            <surname>Kreil</surname>
            <given-names>DP</given-names>
          </name>
        </person-group>
        <article-title>Characterization and improvement of RNA-Seq precision in quantitative transcript expression profiling</article-title>
        <source>Bioinformatics</source>
        <year>2011</year>
        <volume>27</volume>
        <fpage>i383</fpage>
        <lpage>i391</lpage>
        <pub-id pub-id-type="pmid">21685096</pub-id>
      </element-citation>
    </ref>
    <ref id="gks003-B6">
      <label>6</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Alkan</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Kidd</surname>
            <given-names>JM</given-names>
          </name>
          <name>
            <surname>Marques-Bonet</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Aksay</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Antonacci</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Hormozdiari</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Kitzman</surname>
            <given-names>JO</given-names>
          </name>
          <name>
            <surname>Baker</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Malig</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Mutlu</surname>
            <given-names>O</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Personalized copy number and segmental duplication maps using next-generation sequencing</article-title>
        <source>Nat. Genet.</source>
        <year>2009</year>
        <volume>41</volume>
        <fpage>1061</fpage>
        <lpage>1067</lpage>
        <pub-id pub-id-type="pmid">19718026</pub-id>
      </element-citation>
    </ref>
    <ref id="gks003-B7">
      <label>7</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Chiang</surname>
            <given-names>DY</given-names>
          </name>
          <name>
            <surname>Getz</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Jaffe</surname>
            <given-names>DB</given-names>
          </name>
          <name>
            <surname>Zhao</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Carter</surname>
            <given-names>SL</given-names>
          </name>
          <name>
            <surname>Russ</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Nusbaum</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Meyerson</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Lander</surname>
            <given-names>ES</given-names>
          </name>
        </person-group>
        <article-title>High-resolution mapping of copy-number alterations with massively parallel sequencing</article-title>
        <source>Nat. Methods</source>
        <year>2008</year>
        <volume>6</volume>
        <fpage>99</fpage>
        <lpage>103</lpage>
        <pub-id pub-id-type="pmid">19043412</pub-id>
      </element-citation>
    </ref>
    <ref id="gks003-B8">
      <label>8</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Stratton</surname>
            <given-names>MR</given-names>
          </name>
          <name>
            <surname>Campbell</surname>
            <given-names>PJ</given-names>
          </name>
          <name>
            <surname>Futreal</surname>
            <given-names>PA</given-names>
          </name>
        </person-group>
        <article-title>The cancer genome</article-title>
        <source>Nature</source>
        <year>2009</year>
        <volume>458</volume>
        <fpage>719</fpage>
        <lpage>724</lpage>
        <pub-id pub-id-type="pmid">19360079</pub-id>
      </element-citation>
    </ref>
    <ref id="gks003-B9">
      <label>9</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Campbell</surname>
            <given-names>PJ</given-names>
          </name>
          <name>
            <surname>Stephens</surname>
            <given-names>PJ</given-names>
          </name>
          <name>
            <surname>Pleasance</surname>
            <given-names>ED</given-names>
          </name>
          <name>
            <surname>O'Meara</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Santarius</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Stebbings</surname>
            <given-names>LA</given-names>
          </name>
          <name>
            <surname>Leroy</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Edkins</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Hardy</surname>
            <given-names>C</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Identification of somatically acquired rearrangements in cancer using genome-wide massively parallel paired-end sequencing</article-title>
        <source>Nat. Genet.</source>
        <year>2008</year>
        <volume>40</volume>
        <fpage>722</fpage>
        <lpage>729</lpage>
        <pub-id pub-id-type="pmid">18438408</pub-id>
      </element-citation>
    </ref>
    <ref id="gks003-B10">
      <label>10</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wang</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Tian</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Goodman</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Fan</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>J</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>The diploid genome sequence of an Asian individual</article-title>
        <source>Nature</source>
        <year>2008</year>
        <volume>456</volume>
        <fpage>60</fpage>
        <lpage>65</lpage>
        <pub-id pub-id-type="pmid">18987735</pub-id>
      </element-citation>
    </ref>
    <ref id="gks003-B11">
      <label>11</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bentley</surname>
            <given-names>DR</given-names>
          </name>
          <name>
            <surname>Balasubramanian</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Swerdlow</surname>
            <given-names>HP</given-names>
          </name>
          <name>
            <surname>Smith</surname>
            <given-names>GP</given-names>
          </name>
          <name>
            <surname>Milton</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Brown</surname>
            <given-names>CG</given-names>
          </name>
          <name>
            <surname>Hall</surname>
            <given-names>KP</given-names>
          </name>
          <name>
            <surname>Evers</surname>
            <given-names>DJ</given-names>
          </name>
          <name>
            <surname>Barnes</surname>
            <given-names>CL</given-names>
          </name>
          <name>
            <surname>Bignell</surname>
            <given-names>HR</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Accurate whole human genome sequencing using reversible terminator chemistry</article-title>
        <source>Nature</source>
        <year>2008</year>
        <volume>456</volume>
        <fpage>53</fpage>
        <lpage>59</lpage>
        <pub-id pub-id-type="pmid">18987734</pub-id>
      </element-citation>
    </ref>
    <ref id="gks003-B12">
      <label>12</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wheeler</surname>
            <given-names>DA</given-names>
          </name>
          <name>
            <surname>Srinivasan</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Egholm</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Shen</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>McGuire</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>He</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>Y-J</given-names>
          </name>
          <name>
            <surname>Makhijani</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Roth</surname>
            <given-names>GT</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>The complete genome of an individual by massively parallel DNA sequencing</article-title>
        <source>Nature</source>
        <year>2008</year>
        <volume>452</volume>
        <fpage>872</fpage>
        <lpage>876</lpage>
        <pub-id pub-id-type="pmid">18421352</pub-id>
      </element-citation>
    </ref>
    <ref id="gks003-B13">
      <label>13</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bailey</surname>
            <given-names>JA</given-names>
          </name>
          <name>
            <surname>Gu</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Clark</surname>
            <given-names>RA</given-names>
          </name>
          <name>
            <surname>Reinert</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Samonte</surname>
            <given-names>RV</given-names>
          </name>
          <name>
            <surname>Schwartz</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Adams</surname>
            <given-names>MD</given-names>
          </name>
          <name>
            <surname>Myers</surname>
            <given-names>EW</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>PW</given-names>
          </name>
          <name>
            <surname>Eichler</surname>
            <given-names>EE</given-names>
          </name>
        </person-group>
        <article-title>Recent segmental duplications in the human genome</article-title>
        <source>Science</source>
        <year>2002</year>
        <volume>297</volume>
        <fpage>1003</fpage>
        <lpage>1007</lpage>
        <pub-id pub-id-type="pmid">12169732</pub-id>
      </element-citation>
    </ref>
    <ref id="gks003-B14">
      <label>14</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Dohm</surname>
            <given-names>JC</given-names>
          </name>
          <name>
            <surname>Lottaz</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Borodina</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Himmelbauer</surname>
            <given-names>H</given-names>
          </name>
        </person-group>
        <article-title>Substantial biases in ultra-short read data sets from high-throughput DNA sequencing</article-title>
        <source>Nucleic Acids Res.</source>
        <year>2008</year>
        <volume>36</volume>
        <fpage>e105</fpage>
        <pub-id pub-id-type="pmid">18660515</pub-id>
      </element-citation>
    </ref>
    <ref id="gks003-B15">
      <label>15</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Yoon</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Xuan</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Makarov</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Ye</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Sebat</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>Sensitive and accurate detection of copy number variants using read depth of coverage</article-title>
        <source>Genome Res.</source>
        <year>2009</year>
        <volume>19</volume>
        <fpage>1586</fpage>
        <lpage>1592</lpage>
        <pub-id pub-id-type="pmid">19657104</pub-id>
      </element-citation>
    </ref>
    <ref id="gks003-B16">
      <label>16</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Magi</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Benelli</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Yoon</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Roviello</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Torricelli</surname>
            <given-names>F</given-names>
          </name>
        </person-group>
        <article-title>Detecting common copy number variants in high-throughput sequencing data by using JointSLM algorithm</article-title>
        <source>Nucleic Acids Res.</source>
        <year>2011</year>
        <volume>39</volume>
        <fpage>e65</fpage>
        <pub-id pub-id-type="pmid">21321017</pub-id>
      </element-citation>
    </ref>
    <ref id="gks003-B17">
      <label>17</label>
      <element-citation publication-type="book">
        <comment>The International HapMap 3 Consortium (2010) Integrating common and rare genetic variation in diverse human populations. <italic>Nature</italic>, <bold>467</bold>, 52–58</comment>
      </element-citation>
    </ref>
    <ref id="gks003-B18">
      <label>18</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kim</surname>
            <given-names>T-M</given-names>
          </name>
          <name>
            <surname>Luquette</surname>
            <given-names>LJ</given-names>
          </name>
          <name>
            <surname>Xi</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Park</surname>
            <given-names>PJ</given-names>
          </name>
        </person-group>
        <article-title>rSW-seq: algorithm for detection of copy number alterations in deep sequencing data</article-title>
        <source>BMC Bioinformatics</source>
        <year>2010</year>
        <volume>11</volume>
        <fpage>432</fpage>
        <pub-id pub-id-type="pmid">20718989</pub-id>
      </element-citation>
    </ref>
    <ref id="gks003-B19">
      <label>19</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ivakhno</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Royce</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Cox</surname>
            <given-names>AJ</given-names>
          </name>
          <name>
            <surname>Evers</surname>
            <given-names>DJ</given-names>
          </name>
          <name>
            <surname>Cheetham</surname>
            <given-names>RK</given-names>
          </name>
          <name>
            <surname>Tavar</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>CNAseg–a novel framework for identification of copy number changes in cancer from second-generation sequencing data</article-title>
        <source>Bioinformatics</source>
        <year>2010</year>
        <volume>26</volume>
        <fpage>3051</fpage>
        <lpage>3058</lpage>
        <pub-id pub-id-type="pmid">20966003</pub-id>
      </element-citation>
    </ref>
    <ref id="gks003-B20">
      <label>20</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Xie</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Tammi</surname>
            <given-names>MT</given-names>
          </name>
        </person-group>
        <article-title>CNV-Seq, a new method to detect copy number variation using high-throughput sequencing</article-title>
        <source>BMC Bioinformatics</source>
        <year>2009</year>
        <volume>10</volume>
        <fpage>80</fpage>
        <pub-id pub-id-type="pmid">19267900</pub-id>
      </element-citation>
    </ref>
    <ref id="gks003-B21">
      <label>21</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Boeva</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Zinovyev</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Bleakley</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Vert</surname>
            <given-names>J-P</given-names>
          </name>
          <name>
            <surname>Janoueix-Lerosey</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Delattre</surname>
            <given-names>O</given-names>
          </name>
          <name>
            <surname>Barillot</surname>
            <given-names>E</given-names>
          </name>
        </person-group>
        <article-title>Control-free calling of copy number alterations in deep-sequencing data using GC-content normalization</article-title>
        <source>Bioinformatics</source>
        <year>2011</year>
        <volume>27</volume>
        <fpage>268</fpage>
        <lpage>269</lpage>
        <pub-id pub-id-type="pmid">21081509</pub-id>
      </element-citation>
    </ref>
    <ref id="gks003-B22">
      <label>22</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Harchaoui</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Levy-Leduc</surname>
            <given-names>C</given-names>
          </name>
        </person-group>
        <person-group person-group-type="editor">
          <name>
            <surname>Platt</surname>
            <given-names>JC</given-names>
          </name>
          <name>
            <surname>Koller</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Singer</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Roweis</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>Catching Change-points with Lasso</article-title>
        <source>Advances in Neural Information Processing Systems</source>
        <year>2008</year>
        <volume>Vol. 20</volume>
        <publisher-loc>Cambridge, MA</publisher-loc>
        <publisher-name>MIT Press</publisher-name>
        <fpage>617</fpage>
        <lpage>624</lpage>
      </element-citation>
    </ref>
    <ref id="gks003-B23">
      <label>23</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Medvedev</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Fiume</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Dzamba</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Smith</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Brudno</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>Detecting copy number variation with mated short reads</article-title>
        <source>Genome Res.</source>
        <year>2010</year>
        <volume>20</volume>
        <fpage>1613</fpage>
        <lpage>1622</lpage>
        <pub-id pub-id-type="pmid">20805290</pub-id>
      </element-citation>
    </ref>
    <ref id="gks003-B24">
      <label>24</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Clevert</surname>
            <given-names>D-A</given-names>
          </name>
          <name>
            <surname>Mitterecker</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Mayr</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Klambauer</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Tuefferd</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Bondt</surname>
            <given-names>AD</given-names>
          </name>
          <name>
            <surname>Talloen</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Göhlmann</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Hochreiter</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>cn.FARMS: a latent variable model to detect copy number variations in microarray data with a low false discovery rate</article-title>
        <source>Nucleic Acids Res.</source>
        <year>2011</year>
        <volume>39</volume>
        <fpage>e79</fpage>
        <pub-id pub-id-type="pmid">21486749</pub-id>
      </element-citation>
    </ref>
    <ref id="gks003-B25">
      <label>25</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Langmead</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Trapnell</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Pop</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Salzberg</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>Ultrafast and memory-efficient alignment of short DNA sequences to the human genome</article-title>
        <source>Genome Biol.</source>
        <year>2009</year>
        <volume>10</volume>
        <fpage>R25</fpage>
        <pub-id pub-id-type="pmid">19261174</pub-id>
      </element-citation>
    </ref>
    <ref id="gks003-B26">
      <label>26</label>
      <element-citation publication-type="book">
        <comment>The 1000 Genomes Project Consortium (2010) A map of human genome variation from population-scale sequencing. <italic>Nature</italic><bold>467</bold>, 1061–1073</comment>
      </element-citation>
    </ref>
    <ref id="gks003-B27">
      <label>27</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Brown</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Zhao</surname>
            <given-names>L</given-names>
          </name>
        </person-group>
        <article-title>A new test for the Poisson distribution</article-title>
        <source>Sankhya Ser. A</source>
        <year>2002</year>
        <volume>64</volume>
        <fpage>611</fpage>
        <lpage>625</lpage>
      </element-citation>
    </ref>
    <ref id="gks003-B28">
      <label>28</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Sathirapongsasuti</surname>
            <given-names>FJ</given-names>
          </name>
          <name>
            <surname>Lee</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Horst</surname>
            <given-names>BA</given-names>
          </name>
          <name>
            <surname>Brunner</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Cochran</surname>
            <given-names>AJ</given-names>
          </name>
          <name>
            <surname>Binder</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Quackenbush</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Nelson</surname>
            <given-names>SF</given-names>
          </name>
        </person-group>
        <article-title>Exome sequencing-based copy-number variation and loss of heterozygosity detection: ExomeCNV</article-title>
        <source>Bioinformatics</source>
        <year>2011</year>
        <volume>27</volume>
        <fpage>2648</fpage>
        <lpage>2654</lpage>
        <pub-id pub-id-type="pmid">21828086</pub-id>
      </element-citation>
    </ref>
    <ref id="gks003-B29">
      <label>29</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hochreiter</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Clevert</surname>
            <given-names>D-A</given-names>
          </name>
          <name>
            <surname>Obermayer</surname>
            <given-names>K</given-names>
          </name>
        </person-group>
        <article-title>A new summarization method for Affymetrix probe level data</article-title>
        <source>Bioinformatics</source>
        <year>2006</year>
        <volume>22</volume>
        <fpage>943</fpage>
        <lpage>949</lpage>
        <pub-id pub-id-type="pmid">16473874</pub-id>
      </element-citation>
    </ref>
    <ref id="gks003-B30">
      <label>30</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Talloen</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Clevert</surname>
            <given-names>D-A</given-names>
          </name>
          <name>
            <surname>Hochreiter</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Amaratunga</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Bijnens</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Kass</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Göhlmann</surname>
            <given-names>H</given-names>
          </name>
        </person-group>
        <article-title>I/NI-calls for the exclusion of non-informative genes: a highly effective filtering tool for microarray data</article-title>
        <source>Bioinformatics</source>
        <year>2007</year>
        <volume>23</volume>
        <fpage>2897</fpage>
        <lpage>2902</lpage>
        <pub-id pub-id-type="pmid">17921172</pub-id>
      </element-citation>
    </ref>
    <ref id="gks003-B31">
      <label>31</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Talloen</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Hochreiter</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Bijnens</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Kasim</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Shkedy</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Amaratunga</surname>
            <given-names>D</given-names>
          </name>
        </person-group>
        <article-title>Filtering data from high-throughput experiments based on measurement reliability</article-title>
        <source>Proc. Natl Acad. Sci. USA</source>
        <year>2010</year>
        <volume>107</volume>
        <fpage>173</fpage>
        <lpage>174</lpage>
      </element-citation>
    </ref>
    <ref id="gks003-B32">
      <label>32</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Venkatraman</surname>
            <given-names>ES</given-names>
          </name>
          <name>
            <surname>Olshen</surname>
            <given-names>AB</given-names>
          </name>
        </person-group>
        <article-title>A faster circular binary segmentation algorithm for the analysis of array CGH data</article-title>
        <source>Bioinformatics</source>
        <year>2007</year>
        <volume>23</volume>
        <fpage>657</fpage>
        <lpage>663</lpage>
        <pub-id pub-id-type="pmid">17234643</pub-id>
      </element-citation>
    </ref>
    <ref id="gks003-B33">
      <label>33</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Le</surname>
            <given-names>SQ</given-names>
          </name>
          <name>
            <surname>Durbin</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>SNP detection and genotyping from low-coverage sequencing data on multiple diploid samples</article-title>
        <source>Genome Res.</source>
        <year>2011</year>
        <volume>21</volume>
        <fpage>952</fpage>
        <lpage>960</lpage>
        <pub-id pub-id-type="pmid">20980557</pub-id>
      </element-citation>
    </ref>
  </ref-list>
</back>
