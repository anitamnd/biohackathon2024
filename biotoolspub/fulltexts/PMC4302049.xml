<?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName A++V2.4.dtd?>
<?SourceDTD.Version 2.4?>
<?ConverterInfo.XSLTName springer2nlmx2.xsl?>
<?ConverterInfo.Version 2?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Genome Biol</journal-id>
    <journal-title-group>
      <journal-title>Genome Biology</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1465-6906</issn>
    <issn pub-type="epub">1465-6914</issn>
    <publisher>
      <publisher-name>BioMed Central</publisher-name>
      <publisher-loc>London</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">4302049</article-id>
    <article-id pub-id-type="pmid">25516281</article-id>
    <article-id pub-id-type="publisher-id">550</article-id>
    <article-id pub-id-type="doi">10.1186/s13059-014-0550-8</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Method</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Moderated estimation of fold change and dispersion for RNA-seq data with DESeq2</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Love</surname>
          <given-names>Michael I</given-names>
        </name>
        <address>
          <email>mlove@jimmy.harvard.edu</email>
        </address>
        <xref ref-type="aff" rid="Aff1"/>
        <xref ref-type="aff" rid="Aff2"/>
        <xref ref-type="aff" rid="Aff3"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Huber</surname>
          <given-names>Wolfgang</given-names>
        </name>
        <address>
          <email>whuber@embl.de</email>
        </address>
        <xref ref-type="aff" rid="Aff2"/>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <name>
          <surname>Anders</surname>
          <given-names>Simon</given-names>
        </name>
        <address>
          <email>sanders@fs.tum.de</email>
        </address>
        <xref ref-type="aff" rid="Aff2"/>
      </contrib>
      <aff id="Aff1"><label/>Department of Biostatistics and Computational Biology, Dana Farber Cancer Institute and Department of Biostatistics, Harvard School of Public Health, 450 Brookline Avenue, Boston, 02215 MA USA </aff>
      <aff id="Aff2"><label/>Genome Biology Unit, European Molecular Biology Laboratory, Meyerhofstrasse 1, Heidelberg, 69117 Germany </aff>
      <aff id="Aff3"><label/>Department of Computational Molecular Biology, Max Planck Institute for Molecular Genetics, Ihnestrasse 63-7314195, Berlin, Germany </aff>
    </contrib-group>
    <pub-date pub-type="epub">
      <day>5</day>
      <month>12</month>
      <year>2014</year>
    </pub-date>
    <pub-date pub-type="ppub">
      <year>2014</year>
    </pub-date>
    <volume>15</volume>
    <issue>12</issue>
    <elocation-id>550</elocation-id>
    <history>
      <date date-type="received">
        <day>27</day>
        <month>5</month>
        <year>2014</year>
      </date>
      <date date-type="accepted">
        <day>19</day>
        <month>11</month>
        <year>2014</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© Love et al.; licensee BioMed Central. 2014</copyright-statement>
      <license license-type="open-access">
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0">http://creativecommons.org/licenses/by/4.0</ext-link>), which permits unrestricted use, distribution, and reproduction in any medium, provided the original work is properly credited. The Creative Commons Public Domain Dedication waiver (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/publicdomain/zero/1.0/">http://creativecommons.org/publicdomain/zero/1.0/</ext-link>) applies to the data made available in this article, unless otherwise stated.</license-p>
      </license>
    </permissions>
    <abstract id="Abs1">
      <p>In comparative high-throughput sequencing assays, a fundamental task is the analysis of count data, such as read counts per gene in RNA-seq, for evidence of systematic changes across experimental conditions. Small replicate numbers, discreteness, large dynamic range and the presence of outliers require a suitable statistical approach. We present <italic>DESeq2</italic>, a method for differential analysis of count data, using shrinkage estimation for dispersions and fold changes to improve stability and interpretability of estimates. This enables a more quantitative analysis focused on the strength rather than the mere presence of differential expression. The <italic>DESeq2</italic> package is available at http://www.bioconductor.org/packages/release/bioc/html/DESeq2.html.</p>
      <sec>
        <title>Electronic supplementary material</title>
        <p>The online version of this article (doi:10.1186/s13059-014-0550-8) contains supplementary material, which is available to authorized users.</p>
      </sec>
    </abstract>
    <custom-meta-group>
      <custom-meta>
        <meta-name>issue-copyright-statement</meta-name>
        <meta-value>© The Author(s) 2014</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec id="Sec1">
    <title>Background</title>
    <p>The rapid adoption of high-throughput sequencing (HTS) technologies for genomic studies has resulted in a need for statistical methods to assess quantitative differences between experiments. An important task here is the analysis of RNA sequencing (RNA-seq) data with the aim of finding genes that are differentially expressed across groups of samples. This task is general: methods for it are typically also applicable for other comparative HTS assays, including chromatin immunoprecipitation sequencing, chromosome conformation capture, or counting observed taxa in metagenomic studies.</p>
    <p>Besides the need to account for the specifics of count data, such as non-normality and a dependence of the variance on the mean, a core challenge is the small number of samples in typical HTS experiments – often as few as two or three replicates per condition. Inferential methods that treat each gene separately suffer here from lack of power, due to the high uncertainty of within-group variance estimates. In high-throughput assays, this limitation can be overcome by pooling information across genes, specifically, by exploiting assumptions about the similarity of the variances of different genes measured in the same experiment [<xref ref-type="bibr" rid="CR1">1</xref>].</p>
    <p>Many methods for differential expression analysis of RNA-seq data perform such information sharing across genes for variance (or, equivalently, dispersion) estimation. <italic>edgeR</italic> [<xref ref-type="bibr" rid="CR2">2</xref>,<xref ref-type="bibr" rid="CR3">3</xref>] moderates the dispersion estimate for each gene toward a common estimate across all genes, or toward a local estimate from genes with similar expression strength, using a weighted conditional likelihood. Our <italic>DESeq</italic> method [<xref ref-type="bibr" rid="CR4">4</xref>] detects and corrects dispersion estimates that are too low through modeling of the dependence of the dispersion on the average expression strength over all samples. <italic>BBSeq</italic> [<xref ref-type="bibr" rid="CR5">5</xref>] models the dispersion on the mean, with the mean absolute deviation of dispersion estimates used to reduce the influence of outliers. <italic>DSS</italic> [<xref ref-type="bibr" rid="CR6">6</xref>] uses a Bayesian approach to provide an estimate for the dispersion for individual genes that accounts for the heterogeneity of dispersion values for different genes. <italic>baySeq</italic> [<xref ref-type="bibr" rid="CR7">7</xref>] and <italic>ShrinkBayes</italic> [<xref ref-type="bibr" rid="CR8">8</xref>] estimate priors for a Bayesian model over all genes, and then provide posterior probabilities or false discovery rates (FDRs) for differential expression.</p>
    <p>The most common approach in the comparative analysis of transcriptomics data is to test the null hypothesis that the logarithmic fold change (LFC) between treatment and control for a gene’s expression is exactly zero, i.e., that the gene is not at all affected by the treatment. Often the goal of differential analysis is to produce a list of genes passing multiple-test adjustment, ranked by <italic>P</italic> value. However, small changes, even if statistically highly significant, might not be the most interesting candidates for further investigation. Ranking by fold change, on the other hand, is complicated by the noisiness of LFC estimates for genes with low counts. Furthermore, the number of genes called significantly differentially expressed depends as much on the sample size and other aspects of experimental design as it does on the biology of the experiment – and well-powered experiments often generate an overwhelmingly long list of hits [<xref ref-type="bibr" rid="CR9">9</xref>]. We, therefore, developed a statistical framework to facilitate gene ranking and visualization based on stable estimation of effect sizes (LFCs), as well as testing of differential expression with respect to user-defined thresholds of biological significance.</p>
    <p>Here we present <italic>DESeq2</italic>, a successor to our <italic>DESeq</italic> method [<xref ref-type="bibr" rid="CR4">4</xref>]. <italic>DESeq2</italic> integrates methodological advances with several novel features to facilitate a more quantitative analysis of comparative RNA-seq data using shrinkage estimators for dispersion and fold change. We demonstrate the advantages of <italic>DESeq2</italic>’s new features by describing a number of applications possible with shrunken fold changes and their estimates of standard error, including improved gene ranking and visualization, hypothesis tests above and below a threshold, and the regularized logarithm transformation for quality assessment and clustering of overdispersed count data. We furthermore compare <italic>DESeq2</italic>’s statistical power with existing tools, revealing that our methodology has high sensitivity and precision, while controlling the false positive rate. <italic>DESeq2</italic> is available [<xref ref-type="bibr" rid="CR10">10</xref>] as an R/Bioconductor package [<xref ref-type="bibr" rid="CR11">11</xref>].</p>
  </sec>
  <sec id="Sec2">
    <title>Results and discussion</title>
    <sec id="Sec3">
      <title>Model and normalization</title>
      <p>The starting point of a <italic>DESeq2</italic> analysis is a count matrix <italic>K</italic> with one row for each gene <italic>i</italic> and one column for each sample <italic>j</italic>. The matrix entries <italic>K</italic><sub><italic>ij</italic></sub> indicate the number of sequencing reads that have been unambiguously mapped to a gene in a sample. Note that although we refer in this paper to counts of reads in genes, the methods presented here can be applied as well to other kinds of HTS count data. For each gene, we fit a generalized linear model (GLM) [<xref ref-type="bibr" rid="CR12">12</xref>] as follows.</p>
      <p>We model read counts <italic>K</italic><sub><italic>ij</italic></sub> as following a negative binomial distribution (sometimes also called a gamma-Poisson distribution) with mean <italic>μ</italic><sub><italic>ij</italic></sub> and dispersion <italic>α</italic><sub><italic>i</italic></sub>. The mean is taken as a quantity <italic>q</italic><sub><italic>ij</italic></sub>, proportional to the concentration of cDNA fragments from the gene in the sample, scaled by a normalization factor <italic>s</italic><sub><italic>ij</italic></sub>, i.e., <italic>μ</italic><sub><italic>ij</italic></sub>=<italic>s</italic><sub><italic>ij</italic></sub><italic>q</italic><sub><italic>ij</italic></sub>. For many applications, the same constant <italic>s</italic><sub><italic>j</italic></sub> can be used for all genes in a sample, which then accounts for differences in sequencing depth between samples. To estimate these <italic>size factors</italic>, the <italic>DESeq2</italic> package offers the median-of-ratios method already used in <italic>DESeq</italic> [<xref ref-type="bibr" rid="CR4">4</xref>]. However, it can be advantageous to calculate gene-specific normalization factors <italic>s</italic><sub><italic>ij</italic></sub> to account for further sources of technical biases such as differing dependence on GC content, gene length or the like, using published methods [<xref ref-type="bibr" rid="CR13">13</xref>,<xref ref-type="bibr" rid="CR14">14</xref>], and these can be supplied instead.</p>
      <p>We use GLMs with a logarithmic link, <inline-formula id="IEq1"><alternatives><tex-math id="M1">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
							$\log _{2} q_{\textit {ij}}=\sum _{r} x_{\textit {jr}} \beta _{\textit {ir}}$
						\end{document}</tex-math><mml:math id="M2"><mml:munder><mml:mrow><mml:mo>log</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:munder><mml:msub><mml:mrow><mml:mi>q</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ij</mml:mtext></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:munder><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:munder><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">jr</mml:mtext></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ir</mml:mtext></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13059_2014_550_Article_IEq1.gif"/></alternatives></inline-formula>, with design matrix elements <italic>x</italic><sub><italic>jr</italic></sub> and coefficients <italic>β</italic><sub><italic>ir</italic></sub>. In the simplest case of a comparison between two groups, such as treated and control samples, the design matrix elements indicate whether a sample <italic>j</italic> is treated or not, and the GLM fit returns coefficients indicating the overall expression strength of the gene and the log <sub>2</sub> fold change between treatment and control. The use of linear models, however, provides the flexibility to also analyze more complex designs, as is often useful in genomic studies [<xref ref-type="bibr" rid="CR15">15</xref>].</p>
    </sec>
    <sec id="Sec4">
      <title>Empirical Bayes shrinkage for dispersion estimation</title>
      <p>Within-group variability, i.e., the variability between replicates, is modeled by the dispersion parameter <italic>α</italic><sub><italic>i</italic></sub>, which describes the variance of counts via <inline-formula id="IEq2"><alternatives><tex-math id="M3">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
							$\operatorname {Var} K_{\textit {ij}} = \mu _{\textit {ij}} + \alpha _{i} \mu _{\textit {ij}}^{2}$
						\end{document}</tex-math><mml:math id="M4"><mml:mo>Var</mml:mo><mml:msub><mml:mrow><mml:mi>K</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ij</mml:mtext></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ij</mml:mtext></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:msubsup><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ij</mml:mtext></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2014_550_Article_IEq2.gif"/></alternatives></inline-formula>. Accurate estimation of the dispersion parameter <italic>α</italic><sub><italic>i</italic></sub> is critical for the statistical inference of differential expression. For studies with large sample sizes this is usually not a problem. For controlled experiments, however, sample sizes tend to be smaller (experimental designs with as little as two or three replicates are common and reasonable), resulting in highly variable dispersion estimates for each gene. If used directly, these noisy estimates would compromise the accuracy of differential expression testing.</p>
      <p>One sensible solution is to share information across genes. In <italic>DESeq2</italic>, we assume that genes of similar average expression strength have similar dispersion. We here explain the concepts of our approach using as examples a dataset by Bottomly <italic>et al.</italic> [<xref ref-type="bibr" rid="CR16">16</xref>] with RNA-seq data for mice of two different strains and a dataset by Pickrell <italic>et al.</italic> [<xref ref-type="bibr" rid="CR17">17</xref>] with RNA-seq data for human lymphoblastoid cell lines. For the mathematical details, see <xref rid="Sec18" ref-type="sec">Materials and methods</xref>.</p>
      <p>We first treat each gene separately and estimate gene-wise dispersion estimates (using maximum likelihood), which rely only on the data of each individual gene (black dots in Figure <xref rid="Fig1" ref-type="fig">1</xref>). Next, we determine the location parameter of the distribution of these estimates; to allow for dependence on average expression strength, we fit a smooth curve, as shown by the red line in Figure <xref rid="Fig1" ref-type="fig">1</xref>. This provides an accurate estimate for the expected dispersion value for genes of a given expression strength but does not represent deviations of individual genes from this overall trend. We then shrink the gene-wise dispersion estimates toward the values predicted by the curve to obtain final dispersion values (blue arrow heads). We use an empirical Bayes approach (<xref rid="Sec18" ref-type="sec">Materials and methods</xref>), which lets the strength of shrinkage depend (i) on an estimate of how close true dispersion values tend to be to the fit and (ii) on the degrees of freedom: as the sample size increases, the shrinkage decreases in strength, and eventually becomes negligible. Our approach therefore accounts for gene-specific variation to the extent that the data provide this information, while the fitted curve aids estimation and testing in less information-rich settings.
<fig id="Fig1"><label>Figure 1</label><caption><p><bold>Shrinkage estimation of dispersion.</bold> Plot of dispersion estimates over the average expression strength <bold>(A)</bold> for the Bottomly <italic>et al.</italic> [<xref ref-type="bibr" rid="CR16">16</xref>] dataset with six samples across two groups and <bold>(B)</bold> for five samples from the Pickrell <italic>et al.</italic> [<xref ref-type="bibr" rid="CR17">17</xref>] dataset, fitting only an intercept term. First, gene-wise MLEs are obtained using only the respective gene’s data (black dots). Then, a curve (red) is fit to the MLEs to capture the overall trend of dispersion-mean dependence. This fit is used as a prior mean for a second estimation round, which results in the final MAP estimates of dispersion (arrow heads). This can be understood as a shrinkage (along the blue arrows) of the noisy gene-wise estimates toward the consensus represented by the red line. The black points circled in blue are detected as dispersion outliers and not shrunk toward the prior (shrinkage would follow the dotted line). For clarity, only a subset of genes is shown, which is enriched for dispersion outliers. Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S1 displays the same data but with dispersions of all genes shown. MAP, maximum <italic>a posteriori</italic>; MLE, maximum-likelihood estimate.</p></caption><graphic xlink:href="13059_2014_550_Fig1_HTML" id="MO1"/></fig></p>
      <p>Our approach is similar to the one used by <italic>DSS</italic> [<xref ref-type="bibr" rid="CR6">6</xref>], in that both methods sequentially estimate a prior distribution for the true dispersion values around the fit, and then provide the maximum <italic>a posteriori</italic> (MAP) as the final estimate. It differs from the previous implementation of <italic>DESeq</italic>, which used the maximum of the fitted curve and the gene-wise dispersion estimate as the final estimate and tended to overestimate the dispersions (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S2). The approach of <italic>DESeq2</italic> differs from that of <italic>edgeR</italic> [<xref ref-type="bibr" rid="CR3">3</xref>], as <italic>DESeq2</italic> estimates the width of the prior distribution from the data and therefore automatically controls the amount of shrinkage based on the observed properties of the data. In contrast, the default steps in <italic>edgeR</italic> require a user-adjustable parameter, the <italic>prior degrees of freedom</italic>, which weighs the contribution of the individual gene estimate and <italic>edgeR</italic>’s dispersion fit.</p>
      <p>Note that in Figure <xref rid="Fig1" ref-type="fig">1</xref> a number of genes with gene-wise dispersion estimates below the curve have their final estimates raised substantially. The shrinkage procedure thereby helps avoid potential false positives, which can result from underestimates of dispersion. If, on the other hand, an individual gene’s dispersion is far above the distribution of the gene-wise dispersion estimates of other genes, then the shrinkage would lead to a greatly reduced final estimate of dispersion. We reasoned that in many cases, the reason for extraordinarily high dispersion of a gene is that it does not obey our modeling assumptions; some genes may show much higher variability than others for biological or technical reasons, even though they have the same average expression levels. In these cases, inference based on the shrunken dispersion estimates could lead to undesirable false positive calls. <italic>DESeq2</italic> handles these cases by using the gene-wise estimate instead of the shrunken estimate when the former is more than 2 residual standard deviations above the curve.</p>
    </sec>
    <sec id="Sec5">
      <title>Empirical Bayes shrinkage for fold-change estimation</title>
      <p>A common difficulty in the analysis of HTS data is the strong variance of LFC estimates for genes with low read count. We demonstrate this issue using the dataset by Bottomly <italic>et al.</italic> [<xref ref-type="bibr" rid="CR16">16</xref>]. As visualized in Figure <xref rid="Fig2" ref-type="fig">2</xref>A, weakly expressed genes seem to show much stronger differences between the compared mouse strains than strongly expressed genes. This phenomenon, seen in most HTS datasets, is a direct consequence of dealing with <italic>count</italic> data, in which ratios are inherently noisier when counts are low. This heteroskedasticity (variance of LFCs depending on mean count) complicates downstream analysis and data interpretation, as it makes effect sizes difficult to compare across the dynamic range of the data.
<fig id="Fig2"><label>Figure 2</label><caption><p><bold>Effect of shrinkage on logarithmic fold change estimates.</bold> Plots of the <bold>(A)</bold> MLE (i.e., no shrinkage) and <bold>(B)</bold> MAP estimate (i.e., with shrinkage) for the LFCs attributable to mouse strain, over the average expression strength for a ten vs eleven sample comparison of the Bottomly <italic>et al.</italic> [<xref ref-type="bibr" rid="CR16">16</xref>] dataset. Small triangles at the top and bottom of the plots indicate points that would fall outside of the plotting window. Two genes with similar mean count and MLE logarithmic fold change are highlighted with green and purple circles. <bold>(C)</bold> The counts (normalized by size factors <italic>s</italic>
<sub><italic>j</italic></sub>) for these genes reveal low dispersion for the gene in green and high dispersion for the gene in purple. <bold>(D)</bold> Density plots of the likelihoods (solid lines, scaled to integrate to 1) and the posteriors (dashed lines) for the green and purple genes and of the prior (solid black line): due to the higher dispersion of the purple gene, its likelihood is wider and less peaked (indicating less information), and the prior has more influence on its posterior than for the green gene. The stronger curvature of the green posterior at its maximum translates to a smaller reported standard error for the MAP LFC estimate (horizontal error bar). adj., adjusted; LFC, logarithmic fold change; MAP, maximum <italic>a posteriori</italic>; MLE, maximum-likelihood estimate.</p></caption><graphic xlink:href="13059_2014_550_Fig2_HTML" id="MO2"/></fig></p>
      <p><italic>DESeq2</italic> overcomes this issue by shrinking LFC estimates toward zero in a manner such that shrinkage is stronger when the available information for a gene is low, which may be because counts are low, dispersion is high or there are few degrees of freedom. We again employ an empirical Bayes procedure: we first perform ordinary GLM fits to obtain maximum-likelihood estimates (MLEs) for the LFCs and then fit a zero-centered normal distribution to the observed distribution of MLEs over all genes. This distribution is used as a prior on LFCs in a second round of GLM fits, and the MAP estimates are kept as final estimates of LFC. Furthermore, a standard error for each estimate is reported, which is derived from the posterior’s curvature at its maximum (see <xref rid="Sec18" ref-type="sec">Materials and methods</xref> for details). These shrunken LFCs and their standard errors are used in the Wald tests for differential expression described in the next section.</p>
      <p>The resulting MAP LFCs are biased toward zero in a manner that removes the problem of exaggerated LFCs for low counts. As Figure <xref rid="Fig2" ref-type="fig">2</xref>B shows, the strongest LFCs are no longer exhibited by genes with weakest expression. Rather, the estimates are more evenly spread around zero, and for very weakly expressed genes (with less than one read per sample on average), LFCs hardly deviate from zero, reflecting that accurate LFC estimates are not possible here.</p>
      <p>The strength of shrinkage does not depend simply on the mean count, but rather on the amount of information available for the fold change estimation (as indicated by the observed Fisher information; see <xref rid="Sec18" ref-type="sec">Materials and methods</xref>). Two genes with equal expression strength but different dispersions will experience a different amount of shrinkage (Figure <xref rid="Fig2" ref-type="fig">2</xref>C,D). The shrinkage of LFC estimates can be described as a bias-variance trade-off [<xref ref-type="bibr" rid="CR18">18</xref>]: for genes with little information for LFC estimation, a reduction of the strong variance is bought at the cost of accepting a bias toward zero, and this can result in an overall reduction in mean squared error, e.g., when comparing to LFC estimates from a new dataset. Genes with high information for LFC estimation will have, in our approach, LFCs with both low bias and low variance. Furthermore, as the degrees of freedom increase, and the experiment provides more information for LFC estimation, the shrunken estimates will converge to the unshrunken estimates. We note that other Bayesian efforts toward moderating fold changes for RNA-seq include hierarchical models [<xref ref-type="bibr" rid="CR8">8</xref>,<xref ref-type="bibr" rid="CR19">19</xref>] and the <italic>GFOLD</italic> (or generalized fold change) tool [<xref ref-type="bibr" rid="CR20">20</xref>], which uses a posterior distribution of LFCs.</p>
      <p>The shrunken MAP LFCs offer a more reproducible quantification of transcriptional differences than standard MLE LFCs. To demonstrate this, we split the Bottomly <italic>et al.</italic> samples equally into two groups, I and II, such that each group contained a balanced split of the strains, simulating a scenario where an experiment (samples in group I) is performed, analyzed and reported, and then independently replicated (samples in group II). Within each group, we estimated LFCs between the strains and compared between groups I and II, using the MLE LFCs (Figure <xref rid="Fig3" ref-type="fig">3</xref>A) and using the MAP LFCs (Figure <xref rid="Fig3" ref-type="fig">3</xref>B). Because the shrinkage moves large LFCs that are not well supported by the data toward zero, the agreement between the two independent sample groups increases considerably. Therefore, shrunken fold-change estimates offer a more reliable basis for quantitative conclusions than normal MLEs.
<fig id="Fig3"><label>Figure 3</label><caption><p><bold>Stability of logarithmic fold changes.</bold><italic>DESeq2</italic> is run on equally split halves of the data of Bottomly <italic>et al.</italic> [<xref ref-type="bibr" rid="CR16">16</xref>], and the LFCs from the halves are plotted against each other. <bold>(A)</bold> MLEs, i.e., without LFC shrinkage. <bold>(B)</bold> MAP estimates, i.e., with shrinkage. Points in the top left and bottom right quadrants indicate genes with a change of sign of LFC. Red points indicate genes with adjusted <italic>P</italic> value &lt;0.1. The legend displays the root-mean-square error of the estimates in group I compared to those in group II. LFC, logarithmic fold change; MAP, maximum <italic>a posteriori</italic>; MLE, maximum-likelihood estimate; RMSE, root-mean-square error.</p></caption><graphic xlink:href="13059_2014_550_Fig3_HTML" id="MO3"/></fig></p>
      <p>This makes shrunken LFCs also suitable for ranking genes, e.g., to prioritize them for follow-up experiments. For example, if we sort the genes in the two sample groups of Figure <xref rid="Fig3" ref-type="fig">3</xref> by unshrunken LFC estimates, and consider the 100 genes with the strongest up- or down-regulation in group I, we find only 21 of these again among the top 100 up- or down-regulated genes in group II. However, if we rank the genes by shrunken LFC estimates, the overlap improves to 81 of 100 genes (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S3).</p>
      <p>A simpler often used method is to add a fixed number (pseudocount) to all counts before forming ratios. However, this requires the choice of a tuning parameter and only reacts to one of the sources of uncertainty, low counts, but not to gene-specific dispersion differences or sample size. We demonstrate this in the <italic>Benchmarks</italic> section below.</p>
    </sec>
    <sec id="Sec6">
      <title>Hypothesis tests for differential expression</title>
      <p>After GLMs are fit for each gene, one may test whether each model coefficient differs significantly from zero. <italic>DESeq2</italic> reports the standard error for each shrunken LFC estimate, obtained from the curvature of the coefficient’s posterior (dashed lines in Figure <xref rid="Fig2" ref-type="fig">2</xref>D) at its maximum. For significance testing, <italic>DESeq2</italic> uses a Wald test: the shrunken estimate of LFC is divided by its standard error, resulting in a <italic>z</italic>-statistic, which is compared to a standard normal distribution. (See <xref rid="Sec18" ref-type="sec">Materials and methods</xref> for details.) The Wald test allows testing of individual coefficients, or contrasts of coefficients, without the need to fit a reduced model as with the likelihood ratio test, though the likelihood ratio test is also available as an option in <italic>DESeq2</italic>. The Wald test <italic>P</italic> values from the subset of genes that pass an independent filtering step, described in the next section, are adjusted for multiple testing using the procedure of Benjamini and Hochberg [<xref ref-type="bibr" rid="CR21">21</xref>].</p>
    </sec>
    <sec id="Sec7">
      <title>Automatic independent filtering</title>
      <p>Due to the large number of tests performed in the analysis of RNA-seq and other genome-wide experiments, the multiple testing problem needs to be addressed. A popular objective is control or estimation of the FDR. Multiple testing adjustment tends to be associated with a loss of power, in the sense that the FDR for a set of genes is often higher than the individual <italic>P</italic> values of these genes. However, the loss can be reduced if genes that have little or no chance of being detected as differentially expressed are omitted from the testing, provided that the criterion for omission is independent of the test statistic under the null hypothesis [<xref ref-type="bibr" rid="CR22">22</xref>] (see <xref rid="Sec18" ref-type="sec">Materials and methods</xref>). <italic>DESeq2</italic> uses the average expression strength of each gene, across all samples, as its filter criterion, and it omits all genes with mean normalized counts below a filtering threshold from multiple testing adjustment. <italic>DESeq2</italic> by default will choose a threshold that maximizes the number of genes found at a user-specified target FDR. In Figures <xref rid="Fig2" ref-type="fig">2</xref>A,B and <xref rid="Fig3" ref-type="fig">3</xref>, genes found in this way to be significant at an estimated FDR of 10% are depicted in red. Depending on the distribution of the mean normalized counts, the resulting increase in power can be substantial, sometimes making the difference in whether or not any differentially expressed genes are detected.</p>
    </sec>
    <sec id="Sec8">
      <title>Hypothesis tests with thresholds on effect size</title>
      <sec id="Sec9">
        <title>Specifying minimum effect size</title>
        <p>Most approaches to testing for differential expression, including the default approach of <italic>DESeq2</italic>, test against the null hypothesis of <italic>zero</italic> LFC. However, if any biological processes are genuinely affected by the difference in experimental treatment, this null hypothesis implies that the gene under consideration is <italic>perfectly</italic> decoupled from these processes. Due to the high interconnectedness of cells’ regulatory networks, this hypothesis is, in fact, implausible, and arguably wrong for many if not most genes. Consequently, with sufficient sample size, even genes with a very small but non-zero LFC will eventually be detected as differentially expressed. A change should therefore be of sufficient magnitude to be considered <italic>biologically significant</italic>. For small-scale experiments, statistical significance is often a much stricter requirement than biological significance, thereby relieving the researcher from the need to decide on a threshold for biological significance.</p>
        <p>For well-powered experiments, however, a statistical test against the conventional null hypothesis of zero LFC may report genes with statistically significant changes that are so weak in effect strength that they could be considered irrelevant or distracting. A common procedure is to disregard genes whose estimated LFC <italic>β</italic><sub><italic>ir</italic></sub> is below some threshold, |<italic>β</italic><sub><italic>ir</italic></sub>|≤<italic>θ</italic>. However, this approach loses the benefit of an easily interpretable FDR, as the reported <italic>P</italic> value and adjusted <italic>P</italic> value still correspond to the test of <italic>zero</italic> LFC. It is therefore desirable to include the threshold in the statistical testing procedure directly, i.e., not to filter post hoc on a reported fold-change <italic>estimate</italic>, but rather to evaluate statistically directly whether there is sufficient evidence that the LFC is above the chosen threshold.</p>
        <p><italic>DESeq2</italic> offers tests for composite null hypotheses of the form |<italic>β</italic><sub><italic>ir</italic></sub>|≤<italic>θ</italic>, where <italic>β</italic><sub><italic>ir</italic></sub> is the shrunken LFC from the estimation procedure described above. (See <xref rid="Sec18" ref-type="sec">Materials and methods</xref> for details.) Figure <xref rid="Fig4" ref-type="fig">4</xref>A demonstrates how such a thresholded test gives rise to a curved decision boundary: to reach significance, the estimated LFC has to exceed the specified threshold by an amount that depends on the available information. We note that related approaches to generate gene lists that satisfy both statistical and biological significance criteria have been previously discussed for microarray data [<xref ref-type="bibr" rid="CR23">23</xref>] and recently for sequencing data [<xref ref-type="bibr" rid="CR19">19</xref>].
<fig id="Fig4"><label>Figure 4</label><caption><p><bold>Hypothesis testing involving non-zero thresholds.</bold> Shown are plots of the estimated fold change over average expression strength (“minus over average”, or MA-plots) for a ten vs eleven comparison using the Bottomly <italic>et al.</italic> [<xref ref-type="bibr" rid="CR16">16</xref>] dataset, with highlighted points indicating low adjusted <italic>P</italic> values. The alternate hypotheses are that logarithmic (base 2) fold changes are <bold>(A)</bold> greater than 1 in absolute value or <bold>(B)</bold> less than 1 in absolute value. adj., adjusted.</p></caption><graphic xlink:href="13059_2014_550_Fig4_HTML" id="MO4"/></fig></p>
      </sec>
      <sec id="Sec10">
        <title>Specifying maximum effect size</title>
        <p>Sometimes, a researcher is interested in finding genes that are not, or only very weakly, affected by the treatment or experimental condition. This amounts to a setting similar to the one just discussed, but the roles of the null and alternative hypotheses are swapped. We are here asking for evidence of the effect being weak, not for evidence of the effect being zero, because the latter question is rarely tractable. The meaning of <italic>weak</italic> needs to be quantified for the biological question at hand by choosing a suitable threshold <italic>θ</italic> for the LFC. For such analyses, <italic>DESeq2</italic> offers a test of the composite null hypothesis |<italic>β</italic><sub><italic>ir</italic></sub>|≥<italic>θ</italic>, which will report genes as significant for which there is evidence that their LFC is weaker than <italic>θ</italic>. Figure <xref rid="Fig4" ref-type="fig">4</xref>B shows the outcome of such a test. For genes with very low read count, even an estimate of zero LFC is not significant, as the large uncertainty of the estimate does not allow us to exclude that the gene may in truth be more than weakly affected by the experimental condition. Note the lack of LFC shrinkage: to find genes with weak differential expression, <italic>DESeq2</italic> requires that the LFC shrinkage has been disabled. This is because the zero-centered prior used for LFC shrinkage embodies a <italic>prior</italic> belief that LFCs tend to be small, and hence is inappropriate here.</p>
      </sec>
    </sec>
    <sec id="Sec11">
      <title>Detection of count outliers</title>
      <p>Parametric methods for detecting differential expression can have gene-wise estimates of LFC overly influenced by individual outliers that do not fit the distributional assumptions of the model [<xref ref-type="bibr" rid="CR24">24</xref>]. An example of such an outlier would be a gene with single-digit counts for all samples, except one sample with a count in the thousands. As the aim of differential expression analysis is typically to find <italic>consistently</italic> up- or down-regulated genes, it is useful to consider diagnostics for detecting individual observations that overly influence the LFC estimate and <italic>P</italic> value for a gene. A standard outlier diagnostic is Cook’s distance [<xref ref-type="bibr" rid="CR25">25</xref>], which is defined within each gene for each sample as the scaled distance that the coefficient vector, <inline-formula id="IEq3"><alternatives><tex-math id="M5">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
							$\vec {\beta }_{i}$
						\end{document}</tex-math><mml:math id="M6"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mo>→</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13059_2014_550_Article_IEq3.gif"/></alternatives></inline-formula>, of a linear model or GLM would move if the sample were removed and the model refit.</p>
      <p><italic>DESeq2</italic> flags, for each gene, those samples that have a Cook’s distance greater than the 0.99 quantile of the <italic>F</italic>(<italic>p</italic>,<italic>m</italic>−<italic>p</italic>) distribution, where <italic>p</italic> is the number of model parameters including the intercept, and <italic>m</italic> is the number of samples. The use of the <italic>F</italic> distribution is motivated by the heuristic reasoning that removing a single sample should not move the vector <inline-formula id="IEq4"><alternatives><tex-math id="M7">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
							$\vec {\beta }_{i}$
						\end{document}</tex-math><mml:math id="M8"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mo>→</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13059_2014_550_Article_IEq4.gif"/></alternatives></inline-formula> outside of a 99% confidence region around <inline-formula id="IEq5"><alternatives><tex-math id="M9">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
							$\vec {\beta }_{i}$
						\end{document}</tex-math><mml:math id="M10"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mo>→</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13059_2014_550_Article_IEq5.gif"/></alternatives></inline-formula> fit using all the samples [<xref ref-type="bibr" rid="CR25">25</xref>]. However, if there are two or fewer replicates for a condition, these samples do not contribute to outlier detection, as there are insufficient replicates to determine outlier status.</p>
      <p>How should one deal with flagged outliers? In an experiment with many replicates, discarding the outlier and proceeding with the remaining data might make best use of the available data. In a small experiment with few samples, however, the presence of an outlier can impair inference regarding the affected gene, and merely ignoring the outlier may even be considered data cherry-picking – and therefore, it is more prudent to exclude the whole gene from downstream analysis.</p>
      <p>Hence, <italic>DESeq2</italic> offers two possible responses to flagged outliers. By default, outliers in conditions with six or fewer replicates cause the whole gene to be flagged and removed from subsequent analysis, including <italic>P</italic> value adjustment for multiple testing. For conditions that contain seven or more replicates, <italic>DESeq2</italic> replaces the outlier counts with an imputed value, namely the trimmed mean over all samples, scaled by the size factor, and then re-estimates the dispersion, LFCs and <italic>P</italic> values for these genes. As the outlier is replaced with the value predicted by the null hypothesis of no differential expression, this is a more conservative choice than simply omitting the outlier. When there are many degrees of freedom, the second approach avoids discarding genes that might contain true differential expression.</p>
      <p>Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S4 displays the outlier replacement procedure for a single gene in a seven by seven comparison of the Bottomly <italic>et al.</italic> [<xref ref-type="bibr" rid="CR16">16</xref>] dataset. While the original fitted means are heavily influenced by a single sample with a large count, the corrected LFCs provide a better fit to the majority of the samples.</p>
    </sec>
    <sec id="Sec12">
      <title>Regularized logarithm transformation</title>
      <p>For certain analyses, it is useful to transform data to render them homoskedastic. As an example, consider the task of assessing sample similarities in an unsupervised manner using a clustering or ordination algorithm. For RNA-seq data, the problem of heteroskedasticity arises: if the data are given to such an algorithm on the original count scale, the result will be dominated by highly expressed, highly variable genes; if logarithm-transformed data are used, undue weight will be given to weakly expressed genes, which show exaggerated LFCs, as discussed above. Therefore, we use the shrinkage approach of <italic>DESeq2</italic> to implement a <italic>regularized logarithm</italic> transformation (rlog), which behaves similarly to a log2 transformation for genes with high counts, while shrinking together the values for different samples for genes with low counts. It therefore avoids a commonly observed property of the standard logarithm transformation, the spreading apart of data for genes with low counts, where random noise is likely to dominate any biologically meaningful signal. When we consider the variance of each gene, computed across samples, these variances are stabilized – i.e., approximately the same, or homoskedastic – after the rlog transformation, while they would otherwise strongly depend on the mean counts. It thus facilitates multivariate visualization and ordinations such as clustering or principal component analysis that tend to work best when the variables have similar dynamic range. Note that while the rlog transformation builds upon on our LFC shrinkage approach, it is distinct from and not part of the statistical inference procedure for differential expression analysis described above, which employs the raw counts, not transformed data.</p>
      <p>The rlog transformation is calculated by fitting for each gene a GLM with a baseline expression (i.e., intercept only) and, computing for each sample, shrunken LFCs with respect to the baseline, using the same empirical Bayes procedure as before (<xref rid="Sec18" ref-type="sec">Materials and methods</xref>). Here, however, the sample covariate information (e.g. treatment or control) is not used, so that all samples are treated equally. The rlog transformation accounts for variation in sequencing depth across samples as it represents the logarithm of <italic>q</italic><sub><italic>ij</italic></sub> after accounting for the size factors <italic>s</italic><sub><italic>ij</italic></sub>. This is in contrast to the variance-stabilizing transformation (VST) for overdispersed counts introduced in <italic>DESeq</italic> [<xref ref-type="bibr" rid="CR4">4</xref>]: while the VST is also effective at stabilizing variance, it does not directly take into account differences in size factors; and in datasets with large variation in sequencing depth (dynamic range of size factors <inline-formula id="IEq6"><alternatives><tex-math id="M11">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
							$\gtrsim $
						\end{document}</tex-math><mml:math id="M12"><mml:mo>≳</mml:mo></mml:math><inline-graphic xlink:href="13059_2014_550_Article_IEq6.gif"/></alternatives></inline-formula>4) we observed undesirable artifacts in the performance of the VST. A disadvantage of the rlog transformation with respect to the VST is, however, that the ordering of genes within a sample will change if neighboring genes undergo shrinkage of different strength. As with the VST, the value of rlog(<italic>K</italic><sub><italic>ij</italic></sub>) for large counts is approximately equal to log2(<italic>K</italic><sub><italic>ij</italic></sub>/<italic>s</italic><sub><italic>j</italic></sub>). Both the rlog transformation and the VST are provided in the <italic>DESeq2</italic> package.</p>
      <p>We demonstrate the use of the rlog transformation on the RNA-seq dataset of Hammer <italic>et al.</italic> [<xref ref-type="bibr" rid="CR26">26</xref>], wherein RNA was sequenced from the dorsal root ganglion of rats that had undergone spinal nerve ligation and controls, at 2 weeks and at 2 months after the ligation. The count matrix for this dataset was downloaded from the ReCount online resource [<xref ref-type="bibr" rid="CR27">27</xref>]. This dataset offers more subtle differences between conditions than the Bottomly <italic>et al.</italic> [<xref ref-type="bibr" rid="CR16">16</xref>] dataset. Figure <xref rid="Fig5" ref-type="fig">5</xref> provides diagnostic plots of the normalized counts under the ordinary logarithm with a pseudocount of 1 and the rlog transformation, showing that the rlog both stabilizes the variance through the range of the mean of counts and helps to find meaningful patterns in the data.
<fig id="Fig5"><label>Figure 5</label><caption><p><bold>Variance stabilization and clustering after rlog transformation.</bold> Two transformations were applied to the counts of the Hammer <italic>et al.</italic> [<xref ref-type="bibr" rid="CR26">26</xref>] dataset: the logarithm of normalized counts plus a pseudocount, i.e. <italic>f</italic>(<italic>K</italic>
<sub><italic>ij</italic></sub>)= log2(<italic>K</italic>
<sub><italic>ij</italic></sub>/<italic>s</italic>
<sub><italic>j</italic></sub>+1), and the rlog. The gene-wise standard deviation of transformed values is variable across the range of the mean of counts using the logarithm <bold>(A)</bold>, while relatively stable using the rlog <bold>(B)</bold>. A hierarchical clustering on Euclidean distances and complete linkage using the rlog <bold>(D)</bold> transformed data clusters the samples into the groups defined by treatment and time, while using the logarithm-transformed counts <bold>(C)</bold> produces a more ambiguous result. sd, standard deviation.</p></caption><graphic xlink:href="13059_2014_550_Fig5_HTML" id="MO5"/></fig></p>
    </sec>
    <sec id="Sec13">
      <title>Gene-level analysis</title>
      <p>We here present <italic>DESeq2</italic> for the analysis of per-gene counts, i.e., the total number of reads that can be uniquely assigned to a gene. In contrast, several algorithms [<xref ref-type="bibr" rid="CR28">28</xref>,<xref ref-type="bibr" rid="CR29">29</xref>] work with probabilistic assignments of reads to transcripts, where multiple, overlapping transcripts can originate from each gene. It has been noted that the total read count approach can result in false detection of differential expression when in fact only transcript isoform lengths change, and even in a wrong sign of LFCs in extreme cases [<xref ref-type="bibr" rid="CR28">28</xref>]. However, in our benchmark, discussed in the following section, we found that LFC sign disagreements between total read count and probabilistic-assignment-based methods were rare for genes that were differentially expressed according to either method (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S5). Furthermore, if estimates for average transcript length are available for the conditions, these can be incorporated into the <italic>DESeq2</italic> framework as gene- and sample-specific normalization factors. In addition, the approach used in <italic>DESeq2</italic> can be extended to isoform-specific analysis, either through generalized linear modeling at the exon level with a gene-specific mean as in the <italic>DEXSeq</italic> package [<xref ref-type="bibr" rid="CR30">30</xref>] or through counting evidence for alternative isoforms in splice graphs [<xref ref-type="bibr" rid="CR31">31</xref>,<xref ref-type="bibr" rid="CR32">32</xref>]. In fact, the latest release version of <italic>DEXSeq</italic> now uses <italic>DESeq2</italic> as its inferential engine and so offers shrinkage estimation of dispersion and effect sizes for an exon-level analysis, too.</p>
    </sec>
    <sec id="Sec14">
      <title>Comparative benchmarks</title>
      <p>To assess how well <italic>DESeq2</italic> performs for standard analyses in comparison to other current methods, we used a combination of simulations and real data. The negative-binomial-based approaches compared were <italic>DESeq (old)</italic> [<xref ref-type="bibr" rid="CR4">4</xref>], <italic>edgeR</italic> [<xref ref-type="bibr" rid="CR33">33</xref>], <italic>edgeR</italic> with the robust option [<xref ref-type="bibr" rid="CR34">34</xref>], <italic>DSS</italic> [<xref ref-type="bibr" rid="CR6">6</xref>] and <italic>EBSeq</italic> [<xref ref-type="bibr" rid="CR35">35</xref>]. Other methods compared were the <italic>voom</italic> normalization method followed by linear modeling using the <italic>limma</italic> package [<xref ref-type="bibr" rid="CR36">36</xref>] and the <italic>SAMseq</italic> permutation method of the <italic>samr</italic> package [<xref ref-type="bibr" rid="CR24">24</xref>]. For the benchmarks using real data, the <italic>Cuffdiff 2</italic> [<xref ref-type="bibr" rid="CR28">28</xref>] method of the Cufflinks suite was included. For version numbers of the software used, see Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S3. For all algorithms returning <italic>P</italic> values, the <italic>P</italic> values from genes with non-zero sum of read counts across samples were adjusted using the Benjamini–Hochberg procedure [<xref ref-type="bibr" rid="CR21">21</xref>].</p>
      <sec id="Sec15">
        <title>Benchmarks through simulation</title>
        <p><bold>Sensitivity and precision</bold> We simulated datasets of 10,000 genes with negative binomial distributed counts. To simulate data with realistic moments, the mean and dispersions were drawn from the joint distribution of means and gene-wise dispersion estimates from the Pickrell <italic>et al.</italic> data, fitting only an intercept term. These datasets were of varying total sample size (<italic>m</italic>∈{6,8,10,20}), and the samples were split into two equal-sized groups; 80% of the simulated genes had no true differential expression, while for 20% of the genes, true fold changes of 2, 3 and 4 were used to generate counts across the two groups, with the direction of fold change chosen randomly. The simulated differentially expressed genes were chosen uniformly at random among all the genes, throughout the range of mean counts. MA-plots of the true fold changes used in the simulation and the observed fold changes induced by the simulation for one of the simulation settings are shown in Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S6.</p>
        <p>Algorithms’ performance in the simulation benchmark was assessed by their sensitivity and precision. The sensitivity was calculated as the fraction of genes with adjusted <italic>P</italic> value &lt;0.1 among the genes with true differences between group means. The precision was calculated as the fraction of genes with true differences between group means among those with adjusted <italic>P</italic> value &lt;0.1. The sensitivity is plotted over 1−precision, or the FDR, in Figure <xref rid="Fig6" ref-type="fig">6</xref>. <italic>DESeq2</italic>, and also <italic>edgeR</italic>, often had the highest sensitivity of the algorithms that controlled type-I error in the sense that the actual FDR was at or below 0.1, the threshold for adjusted <italic>P</italic> values used for calling differentially expressed genes. <italic>DESeq2</italic> had higher sensitivity compared to the other algorithms, particularly for small fold change (2 or 3), as was also found in benchmarks performed by Zhou <italic>et al.</italic> [<xref ref-type="bibr" rid="CR34">34</xref>]. For larger sample sizes and larger fold changes the performance of the various algorithms was more consistent.
<fig id="Fig6"><label>Figure 6</label><caption><p><bold>Sensitivity and precision of algorithms across combinations of sample size and effect size.</bold><italic>DESeq2</italic> and <italic>edgeR</italic> often had the highest sensitivity of those algorithms that controlled the FDR, i.e., those algorithms which fall on or to the left of the vertical black line. For a plot of sensitivity against false positive rate, rather than FDR, see Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S8, and for the dependence of sensitivity on the mean of counts, see Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S9. Note that <italic>EBSeq</italic> filters low-count genes (see main text for details).</p></caption><graphic xlink:href="13059_2014_550_Fig6_HTML" id="MO6"/></fig></p>
        <p>The overly conservative calling of the old <italic>DESeq</italic> tool can be observed, with reduced sensitivity compared to the other algorithms and an actual FDR less than the nominal value of 0.1. We note that <italic>EBSeq</italic> version 1.4.0 by default removes low-count genes – whose 75% quantile of normalized counts is less than ten – before calling differential expression. The sensitivity of algorithms on the simulated data across a range of the mean of counts are more closely compared in Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S9.</p>
        <p><bold>Outlier sensitivity</bold> We used simulations to compare the sensitivity and specificity of <italic>DESeq2</italic>’s outlier handling approach to that of <italic>edgeR</italic>, which was recently added to the software and published while this manuscript was under review. <italic>edgeR</italic> now includes an optional method to handle outliers by iteratively refitting the GLM after down-weighting potential outlier counts [<xref ref-type="bibr" rid="CR34">34</xref>]. The simulations, summarized in Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S10, indicated that both approaches to outliers nearly recover the performance on an outlier-free dataset, though <italic>edgeR-robust</italic> had slightly higher actual than nominal FDR, as seen in Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S11.</p>
        <p><bold>Precision of fold change estimates</bold> We benchmarked the <italic>DESeq2</italic> approach of using an empirical prior to achieve shrinkage of LFC estimates against two competing approaches: the <italic>GFOLD</italic> method, which can analyze experiments without replication [<xref ref-type="bibr" rid="CR20">20</xref>] and can also handle experiments with replicates, and the <italic>edgeR</italic> package, which provides a pseudocount-based shrinkage termed <italic>predictive LFCs</italic>. Results are summarized in Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figures S12–S16. <italic>DESeq2</italic> had consistently low root-mean-square error and mean absolute error across a range of sample sizes and models for a distribution of true LFCs. <italic>GFOLD</italic> had similarly low error to <italic>DESeq2</italic> over all genes; however, when focusing on differentially expressed genes, it performed worse for larger sample sizes. <italic>edgeR</italic> with default settings had similarly low error to <italic>DESeq2</italic> when focusing only on the differentially expressed genes, but had higher error over all genes.</p>
        <p><bold>Clustering</bold> We compared the performance of the rlog transformation against other methods of transformation or distance calculation in the recovery of simulated clusters. The adjusted Rand index [<xref ref-type="bibr" rid="CR37">37</xref>] was used to compare a hierarchical clustering based on various distances with the true cluster membership. We tested the Euclidean distance for normalized counts, logarithm of normalized counts plus a pseudocount of 1, rlog-transformed counts and VST counts. In addition we compared these Euclidean distances with the Poisson distance implemented in the <italic>PoiClaClu</italic> package [<xref ref-type="bibr" rid="CR38">38</xref>], and a distance implemented internally in the <italic>plotMDS</italic> function of <italic>edgeR</italic> (though not the default distance, which is similar to the logarithm of normalized counts). The results, shown in Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S17, revealed that when the size factors were equal for all samples, the Poisson distance and the Euclidean distance of rlog-transformed or VST counts outperformed other methods. However, when the size factors were not equal across samples, the rlog approach generally outperformed the other methods. Finally, we note that the rlog transformation provides normalized data, which can be used for a variety of applications, of which distance calculation is one.</p>
      </sec>
      <sec id="Sec16">
        <title>Benchmark for RNA sequencing data</title>
        <p>While simulation is useful to verify how well an algorithm behaves with idealized theoretical data, and hence can verify that the algorithm performs as expected under its own assumptions, simulations cannot inform us how well the theory fits reality. With RNA-seq data, there is the complication of not knowing fully or directly the underlying truth; however, we can work around this limitation by using more indirect inference, explained below.</p>
        <p>In the following benchmarks, we considered three performance metrics for differential expression calling: the false positive rate (or 1 minus the specificity), sensitivity and precision. We can obtain meaningful estimates of specificity from looking at datasets where we believe all genes fall under the null hypothesis of no differential expression [<xref ref-type="bibr" rid="CR39">39</xref>]. Sensitivity and precision are more difficult to estimate, as they require independent knowledge of those genes that are differentially expressed. To circumvent this problem, we used experimental reproducibility on independent samples (though from the same dataset) as a proxy. We used a dataset with large numbers of replicates in both of two groups, where we expect that truly differentially expressed genes exist. We repeatedly split this dataset into an evaluation set and a larger verification set, and compared the calls from the evaluation set with the calls from the verification set, which were taken as truth. It is important to keep in mind that the calls from the verification set are only an approximation of the true differential state, and the approximation error has a systematic and a stochastic component. The stochastic error becomes small once the sample size of the verification set is large enough. For the systematic errors, our benchmark assumes that these affect all algorithms more or less equally and do not markedly change the ranking of the algorithms.</p>
        <p><bold>False positive rate</bold> To evaluate the false positive rate of the algorithms, we considered mock comparisons from a dataset with many samples and no known condition dividing the samples into distinct groups. We used the RNA-seq data of Pickrell <italic>et al.</italic> [<xref ref-type="bibr" rid="CR17">17</xref>] for lymphoblastoid cell lines derived from unrelated Nigerian individuals. We chose a set of 26 RNA-seq samples of the same read length (46 base pairs) from male individuals. We randomly drew without replacement ten samples from the set to compare five against five, and this process was repeated 30 times. We estimated the false positive rate associated with a critical value of 0.01 by dividing the number of <italic>P</italic> values less than 0.01 by the total number of tests; genes with zero sum of read counts across samples were excluded. The results over the 30 replications, summarized in Figure <xref rid="Fig7" ref-type="fig">7</xref>, indicated that all algorithms generally controlled the number of false positives. <italic>DESeq (old)</italic> and <italic>Cuffdiff 2</italic> appeared overly conservative in this analysis, not using up their type-I error budget.
<fig id="Fig7"><label>Figure 7</label><caption><p><bold>Benchmark of false positive calling.</bold> Shown are estimates of <italic>P</italic>(<italic>P</italic> value&lt;0.01) under the null hypothesis. The FPR is the number of <italic>P</italic> values less than 0.01 divided by the total number of tests, from randomly selected comparisons of five vs five samples from the Pickrell <italic>et al.</italic> [<xref ref-type="bibr" rid="CR17">17</xref>] dataset, with no known condition dividing the samples. Type-I error control requires that the tool does not substantially exceed the nominal value of 0.01 (black line). <italic>EBSeq</italic> results were not included in this plot as it returns posterior probabilities, which unlike <italic>P</italic> values are not expected to be uniformly distributed under the null hypothesis. FPR, false positive rate.</p></caption><graphic xlink:href="13059_2014_550_Fig7_HTML" id="MO7"/></fig></p>
        <p><bold>Sensitivity</bold> To obtain an impression of the sensitivity of the algorithms, we considered the Bottomly <italic>et al.</italic> [<xref ref-type="bibr" rid="CR16">16</xref>] dataset, which contains ten and eleven replicates of two different, genetically homogeneous mice strains. This allowed for a split of three vs three for the evaluation set and seven vs eight for the verification set, which were balanced across the three experimental batches. Random splits were replicated 30 times. Batch information was not provided to the <italic>DESeq (old)</italic>, <italic>DESeq2</italic>, <italic>DSS</italic>, <italic>edgeR</italic> or <italic>voom</italic> algorithms, which can accommodate complex experimental designs, to have comparable calls across all algorithms.</p>
        <p>We rotated though each algorithm to determine the calls of the verification set. For a given algorithm’s verification set calls, we tested the evaluation set calls of every algorithm. We used this approach rather than a consensus-based method, as we did not want to favor or disfavor any particular algorithm or group of algorithms. Sensitivity was calculated as in the simulation benchmark, now with true differential expression defined by an adjusted <italic>P</italic> value &lt;0.1 in the larger verification set, as diagrammed in Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S18. Figure <xref rid="Fig8" ref-type="fig">8</xref> displays the estimates of sensitivity for each algorithm pair.
<fig id="Fig8"><label>Figure 8</label><caption><p><bold>Sensitivity estimated from experimental reproducibility.</bold> Each algorithm’s sensitivity in the evaluation set (box plots) is evaluated using the calls of each other algorithm in the verification set (panels with grey label).</p></caption><graphic xlink:href="13059_2014_550_Fig8_HTML" id="MO8"/></fig></p>
        <p>The ranking of algorithms was generally consistent regardless of which algorithm was chosen to determine calls in the verification set. <italic>DESeq2</italic> had comparable sensitivity to <italic>edgeR</italic> and <italic>voom</italic> though less than <italic>DSS</italic>. The median sensitivity estimates were typically between 0.2 and 0.4 for all algorithms. That all algorithms had relatively low median sensitivity can be explained by the small sample size of the evaluation set and the fact that increasing the sample size in the verification set increases power. It was expected that the permutation-based <italic>SAMseq</italic> method would rarely produce adjusted <italic>P</italic> value &lt;0.1 in the evaluation set, because the three vs three comparison does not enable enough permutations.</p>
        <p><bold>Precision</bold> Another important consideration from the perspective of an investigator is the precision, or fraction of true positives in the set of genes which pass the adjusted <italic>P</italic> value threshold. This can also be reported as 1−FDR. Again, ‘true’ differential expression was defined by an adjusted <italic>P</italic> value &lt;0.1 in the larger verification set. The estimates of precision are displayed in Figure <xref rid="Fig9" ref-type="fig">9</xref>, where we can see that <italic>DESeq2</italic> often had the second highest median precision, behind <italic>DESeq (old)</italic>. We can also see that algorithms with higher median sensitivity, e.g., <italic>DSS</italic>, were generally associated here with lower median precision. The rankings differed significantly when <italic>Cuffdiff 2</italic> was used to determine the verification set calls. This is likely due to the additional steps <italic>Cuffdiff 2</italic> performed to deconvolve changes in isoform-level abundance from gene-level abundance, which apparently came at the cost of lower precision when compared against its own verification set calls.
<fig id="Fig9"><label>Figure 9</label><caption><p><bold>Precision estimated from experimental reproducibility.</bold> Each algorithm’s precision in the evaluation set (box plots) is evaluated using the calls of each other algorithm in the verification set (panels with grey label).</p></caption><graphic xlink:href="13059_2014_550_Fig9_HTML" id="MO9"/></fig></p>
        <p>To compare the sensitivity and precision results further, we calculated the precision of algorithms along a grid of nominal adjusted <italic>P</italic> values (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S19). We then found the nominal adjusted <italic>P</italic> value for each algorithm, which resulted in a median actual precision of 0.9 (FDR = 0.1). Having thus calibrated each algorithm to a target FDR, we evaluated the sensitivity of calling, as shown in Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S20. As expected, here the algorithms performed more similarly to each other. This analysis revealed that, for a given target precision, <italic>DESeq2</italic> often was among the top algorithms by median sensitivity, though the variability across random replicates was larger than the differences between algorithms.</p>
        <p>The absolute number of calls for the evaluation and verification sets can be seen in Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figures S21 and S22, which mostly matched the order seen in the sensitivity plot of Figure <xref rid="Fig8" ref-type="fig">8</xref>. Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figures S23 and S24 provide heat maps and clustering based on the Jaccard index of calls for one replicate of the evaluation and verification sets, indicating a large overlap of calls across the different algorithms.</p>
        <p>In summary, the benchmarking tests showed that <italic>DESeq2</italic> effectively controlled type-I errors, maintaining a median false positive rate just below the chosen critical value in a mock comparison of groups of samples randomly chosen from a larger pool. For both simulation and analysis of real data, <italic>DESeq2</italic> often achieved the highest sensitivity of those algorithms that controlled the FDR.</p>
      </sec>
    </sec>
  </sec>
  <sec id="Sec17" sec-type="conclusion">
    <title>Conclusions</title>
    <p><italic>DESeq2</italic> offers a comprehensive and general solution for gene-level analysis of RNA-seq data. Shrinkage estimators substantially improve the stability and reproducibility of analysis results compared to maximum-likelihood-based solutions. Empirical Bayes priors provide automatic control of the amount of shrinkage based on the amount of information for the estimated quantity available in the data. This allows <italic>DESeq2</italic> to offer consistent performance over a large range of data types and makes it applicable for small studies with few replicates as well as for large observational studies. <italic>DESeq2</italic>’s heuristics for outlier detection help to recognize genes for which the modeling assumptions are unsuitable and so avoids type-I errors caused by these. The embedding of these strategies in the framework of GLMs enables the treatment of both simple and complex designs.</p>
    <p>A critical advance is the shrinkage estimator for fold changes for differential expression analysis, which offers a sound and statistically well-founded solution to the practically relevant problem of comparing fold change across the wide dynamic range of RNA-seq experiments. This is of value for many downstream analysis tasks, including the ranking of genes for follow-up studies and association of fold changes with other variables of interest. In addition, the rlog transformation, which implements shrinkage of fold changes on a per-sample basis, facilitates visualization of differences, for example in heat maps, and enables the application of a wide range of techniques that require homoskedastic input data, including machine-learning or ordination techniques such as principal component analysis and clustering.</p>
    <p><italic>DESeq2</italic> hence offers to practitioners a wide set of features with state-of-the-art inferential power. Its use cases are not limited to RNA-seq data or other transcriptomics assays; rather, many kinds of high-throughput count data can be used. Other areas for which <italic>DESeq</italic> or <italic>DESeq2</italic> have been used include chromatin immunoprecipitation sequencing assays (e.g., [<xref ref-type="bibr" rid="CR40">40</xref>]; see also the <italic>DiffBind</italic> package [<xref ref-type="bibr" rid="CR41">41</xref>,<xref ref-type="bibr" rid="CR42">42</xref>]), barcode-based assays (e.g., [<xref ref-type="bibr" rid="CR43">43</xref>]), metagenomics data (e.g., [<xref ref-type="bibr" rid="CR44">44</xref>]), ribosome profiling [<xref ref-type="bibr" rid="CR45">45</xref>] and CRISPR/Cas-library assays [<xref ref-type="bibr" rid="CR46">46</xref>]. Finally, the <italic>DESeq2</italic> package is integrated well in the Bioconductor infrastructure [<xref ref-type="bibr" rid="CR11">11</xref>] and comes with extensive documentation, including a vignette that demonstrates a complete analysis step by step and discusses advanced use cases.</p>
  </sec>
  <sec id="Sec18" sec-type="materials|methods">
    <title>Materials and methods</title>
    <p>A summary of the notation used in the following section is provided in Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S1.</p>
    <sec id="Sec19">
      <title>Model and normalization</title>
      <p>The read count <italic>K</italic><sub><italic>ij</italic></sub> for gene <italic>i</italic> in sample <italic>j</italic> is described with a GLM of the negative binomial family with a logarithmic link:
<disp-formula id="Equ1"><label>(1)</label><alternatives><tex-math id="M13">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
							 $$ \begin{aligned} K_{ij} &amp; \sim \text{NB}(\text{mean} = \mu_{ij}, \text{dispersion} = \alpha_{i})  \\ \mu_{ij} &amp;= s_{ij} q_{ij} \\ \end{aligned}  $$ 
						\end{document}</tex-math><mml:math id="M14"><mml:mtable><mml:mtr><mml:mtd><mml:msub><mml:mrow><mml:mi>K</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ij</mml:mtext></mml:mrow></mml:msub></mml:mtd><mml:mtd><mml:mo>∼</mml:mo><mml:mtext>NB</mml:mtext><mml:mo>(</mml:mo><mml:mtext>mean</mml:mtext><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ij</mml:mtext></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mtext>dispersion</mml:mtext><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msub><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ij</mml:mtext></mml:mrow></mml:msub></mml:mtd><mml:mtd><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ij</mml:mtext></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>q</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ij</mml:mtext></mml:mrow></mml:msub></mml:mtd></mml:mtr><mml:mtr/></mml:mtable></mml:math><graphic xlink:href="13059_2014_550_Article_Equ1.gif" position="anchor"/></alternatives></disp-formula></p>
      <p>
        <disp-formula id="Equ2">
          <label>(2)</label>
          <alternatives>
            <tex-math id="M15">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
							 $$ \log q_{ij} = \sum_{r} x_{jr} \beta_{ir}.   $$ 
						\end{document}</tex-math>
            <mml:math id="M16">
              <mml:mo>log</mml:mo>
              <mml:msub>
                <mml:mrow>
                  <mml:mi>q</mml:mi>
                </mml:mrow>
                <mml:mrow>
                  <mml:mtext mathvariant="italic">ij</mml:mtext>
                </mml:mrow>
              </mml:msub>
              <mml:mo>=</mml:mo>
              <mml:munder>
                <mml:mrow>
                  <mml:mo>∑</mml:mo>
                </mml:mrow>
                <mml:mrow>
                  <mml:mi>r</mml:mi>
                </mml:mrow>
              </mml:munder>
              <mml:msub>
                <mml:mrow>
                  <mml:mi>x</mml:mi>
                </mml:mrow>
                <mml:mrow>
                  <mml:mtext mathvariant="italic">jr</mml:mtext>
                </mml:mrow>
              </mml:msub>
              <mml:msub>
                <mml:mrow>
                  <mml:mi>β</mml:mi>
                </mml:mrow>
                <mml:mrow>
                  <mml:mtext mathvariant="italic">ir</mml:mtext>
                </mml:mrow>
              </mml:msub>
              <mml:mi>.</mml:mi>
            </mml:math>
            <graphic xlink:href="13059_2014_550_Article_Equ2.gif" position="anchor"/>
          </alternatives>
        </disp-formula>
      </p>
      <p>For notational simplicity, the equations here use the natural logarithm as the link function, though the <italic>DESeq2</italic> software reports estimated model coefficients and their estimated standard errors on the log2 scale.</p>
      <p>By default, the normalization constants <italic>s</italic><sub><italic>ij</italic></sub> are considered constant within a sample, <italic>s</italic><sub><italic>ij</italic></sub>=<italic>s</italic><sub><italic>j</italic></sub>, and are estimated with the median-of-ratios method previously described and used in <italic>DESeq</italic> [<xref ref-type="bibr" rid="CR4">4</xref>] and <italic>DEXSeq</italic> [<xref ref-type="bibr" rid="CR30">30</xref>]:
<disp-formula id="Equa"><alternatives><tex-math id="M17">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
							 $$s_{j} = {\underset{i:\,K_{i}^{\text{R}}\neq 0}{\text{median}}}\, \frac{K_{ij}}{K^{\text{R}}_{i}}\quad\text{with}\quad K^{\text{R}}_{i} = \left(\prod\limits_{j=1}^{m} K_{ij}\right)^{1/m}. $$ 
						\end{document}</tex-math><mml:math id="M18"><mml:mrow><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:munder><mml:mrow><mml:mtext>median</mml:mtext></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>:</mml:mo><mml:mspace width="0.3em"/><mml:msubsup><mml:mrow><mml:mi>K</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mtext>R</mml:mtext></mml:mrow></mml:msubsup><mml:mo>≠</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:munder><mml:mspace width="0.3em"/><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi>K</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ij</mml:mtext></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msubsup><mml:mrow><mml:mi>K</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mtext>R</mml:mtext></mml:mrow></mml:msubsup></mml:mrow></mml:mfrac><mml:mspace width="1em"/><mml:mtext>with</mml:mtext><mml:mspace width="1em"/><mml:msubsup><mml:mrow><mml:mi>K</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mtext>R</mml:mtext></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:munderover accent="false" accentunder="false"><mml:mrow><mml:mo mathsize="big">∏</mml:mo></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:munderover><mml:msub><mml:mrow><mml:mi>K</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ij</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:mi>m</mml:mi></mml:mrow></mml:msup><mml:mi>.</mml:mi></mml:mrow></mml:math><graphic xlink:href="13059_2014_550_Article_Equa.gif" position="anchor"/></alternatives></disp-formula></p>
      <p>Alternatively, the user can supply normalization constants <italic>s</italic><sub><italic>ij</italic></sub> calculated using other methods (e.g., using <italic>cqn</italic> [<xref ref-type="bibr" rid="CR13">13</xref>] or <italic>EDASeq</italic> [<xref ref-type="bibr" rid="CR14">14</xref>]), which may differ from gene to gene.</p>
    </sec>
    <sec id="Sec20">
      <title>Expanded design matrices</title>
      <p>For consistency with our software’s documentation, in the following text we will use the terminology of the <italic>R</italic> statistical language. In linear modeling, a categorical variable or <italic>factor</italic> can take on two or more values or <italic>levels</italic>. In standard design matrices, one of the values is chosen as a reference value or <italic>base level</italic> and absorbed into the intercept. In standard GLMs, the choice of base level does not influence the values of contrasts (LFCs). This, however, is no longer the case in our approach using ridge-regression-like shrinkage on the coefficients (described below), when factors with more than two levels are present in the design matrix, because the base level will not undergo shrinkage while the other levels do.</p>
      <p>To recover the desirable symmetry between all levels, <italic>DESeq2</italic> uses <italic>expanded design matrices</italic>, which include an indicator variable for <italic>each</italic> level of each factor, in addition to an intercept column (i.e., none of the levels is absorbed into the intercept). While such a design matrix no longer has full rank, a unique solution exists because the zero-centered prior distribution (see below) provides regularization. For dispersion estimation and for estimating the width of the LFC prior, standard design matrices are used.</p>
    </sec>
    <sec id="Sec21">
      <title>Contrasts</title>
      <p>Contrasts between levels and standard errors of such contrasts can be calculated as they would in the standard design matrix case, i.e., using:
<disp-formula id="Equ3"><label>(3)</label><alternatives><tex-math id="M19">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
							 $$ {\beta_{i}^{c}} = \vec{c}\,^{t} \vec{\beta_{i}}   $$ 
						\end{document}</tex-math><mml:math id="M20"><mml:msubsup><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>c</mml:mi></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mover accent="true"><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mo>→</mml:mo></mml:mover><mml:msup><mml:mrow><mml:mspace width="0.3em"/></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msup><mml:mover accent="true"><mml:mrow><mml:msub><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>→</mml:mo></mml:mover></mml:math><graphic xlink:href="13059_2014_550_Article_Equ3.gif" position="anchor"/></alternatives></disp-formula></p>
      <p>
        <disp-formula id="Equ4">
          <label>(4)</label>
          <alternatives>
            <tex-math id="M21">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
							 $$ \text{SE}\left({\beta_{i}^{c}}\right) = \sqrt{\vec{c}\,^{t} \Sigma_{i} \vec{c}},   $$ 
						\end{document}</tex-math>
            <mml:math id="M22">
              <mml:mtext>SE</mml:mtext>
              <mml:mfenced close=")" open="(" separators="">
                <mml:mrow>
                  <mml:msubsup>
                    <mml:mrow>
                      <mml:mi>β</mml:mi>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mi>i</mml:mi>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mi>c</mml:mi>
                    </mml:mrow>
                  </mml:msubsup>
                </mml:mrow>
              </mml:mfenced>
              <mml:mo>=</mml:mo>
              <mml:msqrt>
                <mml:mrow>
                  <mml:mover accent="true">
                    <mml:mrow>
                      <mml:mi>c</mml:mi>
                    </mml:mrow>
                    <mml:mo>→</mml:mo>
                  </mml:mover>
                  <mml:msup>
                    <mml:mrow>
                      <mml:mspace width="0.3em"/>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mi>t</mml:mi>
                    </mml:mrow>
                  </mml:msup>
                  <mml:msub>
                    <mml:mrow>
                      <mml:mi>Σ</mml:mi>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mi>i</mml:mi>
                    </mml:mrow>
                  </mml:msub>
                  <mml:mover accent="true">
                    <mml:mrow>
                      <mml:mi>c</mml:mi>
                    </mml:mrow>
                    <mml:mo>→</mml:mo>
                  </mml:mover>
                </mml:mrow>
              </mml:msqrt>
              <mml:mo>,</mml:mo>
            </mml:math>
            <graphic xlink:href="13059_2014_550_Article_Equ4.gif" position="anchor"/>
          </alternatives>
        </disp-formula>
      </p>
      <p>where <inline-formula id="IEq7"><alternatives><tex-math id="M23">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
							$\vec {c}$
						\end{document}</tex-math><mml:math id="M24"><mml:mover accent="true"><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mo>→</mml:mo></mml:mover></mml:math><inline-graphic xlink:href="13059_2014_550_Article_IEq7.gif"/></alternatives></inline-formula> represents a numeric contrast, e.g., 1 and −1 specifying the numerator and denominator of a simple two-level contrast, and <inline-formula id="IEq8"><alternatives><tex-math id="M25">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
							$\Sigma _{i} = \text {Cov}(\vec \beta _{i})$
						\end{document}</tex-math><mml:math id="M26"><mml:msub><mml:mrow><mml:mi>Σ</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mtext>Cov</mml:mtext><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mo>→</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:math><inline-graphic xlink:href="13059_2014_550_Article_IEq8.gif"/></alternatives></inline-formula>, defined below.</p>
    </sec>
    <sec id="Sec22">
      <title>Estimation of dispersions</title>
      <p>We assume the dispersion parameter <italic>α</italic><sub><italic>i</italic></sub> follows a log-normal prior distribution that is centered around a trend that depends on the gene’s mean normalized read count:
<disp-formula id="Equ5"><label>(5)</label><alternatives><tex-math id="M27">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
							 $$ \log \alpha_{i} \sim N\!\left(\log \alpha_{\text{tr}}(\bar\mu_{i}), \, \sigma_{\text{d}}^{2} \right).   $$ 
						\end{document}</tex-math><mml:math id="M28"><mml:mo>log</mml:mo><mml:msub><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>∼</mml:mo><mml:mi>N</mml:mi><mml:mspace width="0.3em"/><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mo>log</mml:mo><mml:msub><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mtext>tr</mml:mtext></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mo>¯</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo><mml:mo>,</mml:mo><mml:mspace width="0.3em"/><mml:msubsup><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mtext>d</mml:mtext></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:mrow></mml:mfenced><mml:mi>.</mml:mi></mml:math><graphic xlink:href="13059_2014_550_Article_Equ5.gif" position="anchor"/></alternatives></disp-formula></p>
      <p>Here, <italic>α</italic><sub>tr</sub> is a function of the gene’s mean normalized count,
<disp-formula id="Equb"><alternatives><tex-math id="M29">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
							 $$\bar{\mu}_{i} = \frac{1}{m} \sum\limits_{j} \frac{K_{ij}}{s_{ij}}. $$ 
						\end{document}</tex-math><mml:math id="M30"><mml:mrow><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mo>¯</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:mfrac><mml:munder><mml:mrow><mml:mo mathsize="big">∑</mml:mo></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:munder><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi>K</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ij</mml:mtext></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ij</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:mi>.</mml:mi></mml:mrow></mml:math><graphic xlink:href="13059_2014_550_Article_Equb.gif" position="anchor"/></alternatives></disp-formula> It describes the mean-dependent expectation of the prior. <italic>σ</italic><sub>d</sub> is the width of the prior, a hyperparameter describing how much the individual genes’ true dispersions scatter around the trend. For the trend function, we use the same parametrization as we used for <italic>DEXSeq</italic> [<xref ref-type="bibr" rid="CR30">30</xref>], namely,
<disp-formula id="Equ6"><label>(6)</label><alternatives><tex-math id="M31">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
							 $$ \alpha_{\text{tr}}(\bar{\mu}) = \frac{a_{1}}{\bar{\mu}} + \alpha_{0}.   $$ 
						\end{document}</tex-math><mml:math id="M32"><mml:msub><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mtext>tr</mml:mtext></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mover accent="true"><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mo>¯</mml:mo></mml:mover><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi>a</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mo>¯</mml:mo></mml:mover></mml:mrow></mml:mfrac><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mi>.</mml:mi></mml:math><graphic xlink:href="13059_2014_550_Article_Equ6.gif" position="anchor"/></alternatives></disp-formula></p>
      <p>We get final dispersion estimates from this model in three steps, which implement a computationally fast approximation to a full empirical Bayes treatment. We first use the count data for each gene separately to get preliminary gene-wise dispersion estimates <inline-formula id="IEq9"><alternatives><tex-math id="M33">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
							$\alpha ^{\text {gw}}_{i}$
						\end{document}</tex-math><mml:math id="M34"><mml:msubsup><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mtext>gw</mml:mtext></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2014_550_Article_IEq9.gif"/></alternatives></inline-formula> by maximum-likelihood estimation. Then, we fit the dispersion trend <italic>α</italic><sub>tr</sub>. Finally, we combine the likelihood with the trended prior to get maximum <italic>a posteriori</italic> (MAP) values as final dispersion estimates. Details for the three steps follow.</p>
      <p><bold>Gene-wise dispersion estimates</bold> To get a gene-wise dispersion estimate for a gene <italic>i</italic>, we start by fitting a negative binomial GLM without an LFC prior for the design matrix <italic>X</italic> to the gene’s count data. This GLM uses a rough method-of-moments estimate of dispersion, based on the within-group variances and means. The initial GLM is necessary to obtain an initial set of fitted values, <inline-formula id="IEq10"><alternatives><tex-math id="M35">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
							$\hat \mu _{\textit {ij}}^{0}$
						\end{document}</tex-math><mml:math id="M36"><mml:msubsup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ij</mml:mtext></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2014_550_Article_IEq10.gif"/></alternatives></inline-formula>. We then maximize the Cox–Reid adjusted likelihood of the dispersion, conditioned on the fitted values <inline-formula id="IEq11"><alternatives><tex-math id="M37">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
							$\hat \mu _{\textit {ij}}^{0}$
						\end{document}</tex-math><mml:math id="M38"><mml:msubsup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ij</mml:mtext></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2014_550_Article_IEq11.gif"/></alternatives></inline-formula> from the initial fit, to obtain the gene-wise estimate <inline-formula id="IEq12"><alternatives><tex-math id="M39">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
							$\alpha ^{\text {gw}}_{i}$
						\end{document}</tex-math><mml:math id="M40"><mml:msubsup><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mtext>gw</mml:mtext></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2014_550_Article_IEq12.gif"/></alternatives></inline-formula>, i.e.,
<disp-formula id="Equc"><alternatives><tex-math id="M41">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
							 $$\alpha^{\text{gw}}_{i} = {\underset{\alpha}{\text{arg max}}}\; \ell_{\text{CR}}\left(\alpha; \vec\mu_{\textit{i}\cdot}^{0}, \vec K_{\textit{i}\cdot}\right) $$ 
						\end{document}</tex-math><mml:math id="M42"><mml:mrow><mml:msubsup><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mtext>gw</mml:mtext></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:munder><mml:mrow><mml:mtext>arg max</mml:mtext></mml:mrow><mml:mrow><mml:mi>α</mml:mi></mml:mrow></mml:munder><mml:mspace width="2.77626pt"/><mml:msub><mml:mrow><mml:mi>ℓ</mml:mi></mml:mrow><mml:mrow><mml:mtext>CR</mml:mtext></mml:mrow></mml:msub><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mi>α</mml:mi><mml:mo>;</mml:mo><mml:msubsup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mo>→</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">i</mml:mtext><mml:mo>·</mml:mo></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>K</mml:mi></mml:mrow><mml:mo>→</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">i</mml:mtext><mml:mo>·</mml:mo></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:mrow></mml:math><graphic xlink:href="13059_2014_550_Article_Equc.gif" position="anchor"/></alternatives></disp-formula> with
<disp-formula id="Equ7"><label>(7)</label><alternatives><tex-math id="M43">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
							 $$ \begin{aligned} \ell_{\text{CR}}(\alpha; \vec\mu, \vec K) &amp;= \ell(\alpha) - \frac{1}{2} \log\left(\det\left(X^{t} W X\right) \right)  \\ \ell(\alpha) &amp;= \sum\limits_{j} \log f_{\text{NB}}(K_{j}; \mu_{j}, \alpha), \end{aligned}  $$ 
						\end{document}</tex-math><mml:math id="M44"><mml:mtable><mml:mtr><mml:mtd><mml:msub><mml:mrow><mml:mi>ℓ</mml:mi></mml:mrow><mml:mrow><mml:mtext>CR</mml:mtext></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mi>α</mml:mi><mml:mo>;</mml:mo><mml:mover accent="true"><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mo>→</mml:mo></mml:mover><mml:mo>,</mml:mo><mml:mover accent="true"><mml:mrow><mml:mi>K</mml:mi></mml:mrow><mml:mo>→</mml:mo></mml:mover><mml:mo>)</mml:mo></mml:mtd><mml:mtd><mml:mo>=</mml:mo><mml:mi>ℓ</mml:mi><mml:mo>(</mml:mo><mml:mi>α</mml:mi><mml:mo>)</mml:mo><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:mfrac><mml:mo>log</mml:mo><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mo>det</mml:mo><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msup><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msup><mml:mtext mathvariant="italic">WX</mml:mtext></mml:mrow></mml:mfenced></mml:mrow></mml:mfenced></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mi>ℓ</mml:mi><mml:mo>(</mml:mo><mml:mi>α</mml:mi><mml:mo>)</mml:mo></mml:mtd><mml:mtd><mml:mo>=</mml:mo><mml:munder><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:munder><mml:mo>log</mml:mo><mml:msub><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mtext>NB</mml:mtext></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>K</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>;</mml:mo><mml:msub><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>α</mml:mi><mml:mo>)</mml:mo><mml:mo>,</mml:mo></mml:mtd></mml:mtr></mml:mtable></mml:math><graphic xlink:href="13059_2014_550_Article_Equ7.gif" position="anchor"/></alternatives></disp-formula></p>
      <p>where <italic>f</italic><sub>NB</sub>(<italic>k</italic>;<italic>μ</italic>,<italic>α</italic>) is the probability mass function of the negative binomial distribution with mean <italic>μ</italic> and dispersion <italic>α</italic>, and the second term provides the Cox–Reid bias adjustment [<xref ref-type="bibr" rid="CR47">47</xref>]. This adjustment, first used in the context of dispersion estimation for SAGE data [<xref ref-type="bibr" rid="CR48">48</xref>] and then for HTS data [<xref ref-type="bibr" rid="CR3">3</xref>] in <italic>edgeR</italic>, corrects for the negative bias of dispersion estimates from using the MLEs for the fitted values <inline-formula id="IEq13"><alternatives><tex-math id="M45">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
							$\hat \mu _{\textit {ij}}^{0}$
						\end{document}</tex-math><mml:math id="M46"><mml:msubsup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ij</mml:mtext></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2014_550_Article_IEq13.gif"/></alternatives></inline-formula> (analogous to Bessel’s correction in the usual sample variance formula; for details, see [<xref ref-type="bibr" rid="CR49">49</xref>], Section 10.6). It is formed from the Fisher information for the fitted values, which is here calculated as det(<italic>X</italic><sup><italic>t</italic></sup><italic>W</italic><italic>X</italic>), where <italic>W</italic> is the diagonal weight matrix from the standard iteratively reweighted least-squares algorithm. As the GLM’s link function is <italic>g</italic>(<italic>μ</italic>)= log(<italic>μ</italic>) and its variance function is <italic>V</italic>(<italic>μ</italic>;<italic>α</italic>)=<italic>μ</italic>+<italic>α</italic><italic>μ</italic><sup>2</sup>, the elements of the diagonal matrix <italic>W</italic><sub><italic>i</italic></sub> are given by:
<disp-formula id="Equd"><alternatives><tex-math id="M47">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
							 $$w_{jj} = \frac{1}{g^{\prime}(\mu_{j})^{2} V(\mu_{j})} = \frac{1}{1/\mu_{j} + \alpha}. $$ 
						\end{document}</tex-math><mml:math id="M48"><mml:mrow><mml:msub><mml:mrow><mml:mi>w</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">jj</mml:mtext></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:mi>g</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mi>V</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:msub><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mi>α</mml:mi></mml:mrow></mml:mfrac><mml:mi>.</mml:mi></mml:mrow></mml:math><graphic xlink:href="13059_2014_550_Article_Equd.gif" position="anchor"/></alternatives></disp-formula></p>
      <p>The optimization in Equation (<xref rid="Equ7" ref-type="">7</xref>) is performed on the scale of log<italic>α</italic> using a backtracking line search with accepted proposals that satisfy Armijo conditions [<xref ref-type="bibr" rid="CR50">50</xref>].</p>
      <p><bold>Dispersion trend</bold> A parametric curve of the form (<xref rid="Equ6" ref-type="">6</xref>) is fit by regressing the gene-wise dispersion estimates <inline-formula id="IEq14"><alternatives><tex-math id="M49">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
							$\alpha ^{\text {gw}}_{i}$
						\end{document}</tex-math><mml:math id="M50"><mml:msubsup><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mtext>gw</mml:mtext></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2014_550_Article_IEq14.gif"/></alternatives></inline-formula> onto the means of the normalized counts, <inline-formula id="IEq15"><alternatives><tex-math id="M51">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
							$\bar {\mu }_{i}$
						\end{document}</tex-math><mml:math id="M52"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mo>¯</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13059_2014_550_Article_IEq15.gif"/></alternatives></inline-formula>. The sampling distribution of the gene-wise dispersion estimate around the true value <italic>α</italic><sub><italic>i</italic></sub> can be highly skewed, and therefore we do not use ordinary least-squares regression but rather gamma-family GLM regression. Furthermore, dispersion outliers could skew the fit and hence a scheme to exclude such outliers is used.</p>
      <p>The hyperparameters <italic>a</italic><sub>1</sub> and <italic>α</italic><sub>0</sub> of (<xref rid="Equ6" ref-type="">6</xref>) are obtained by iteratively fitting a gamma-family GLM. At each iteration, genes with a ratio of dispersion to fitted value outside the range [10<sup>−4</sup>,15] are left out until the sum of squared LFCs of the new coefficients over the old coefficients is less than 10<sup>−6</sup> (same approach as in <italic>DEXSeq</italic> [<xref ref-type="bibr" rid="CR30">30</xref>]).</p>
      <p>The parametrization (<xref rid="Equ6" ref-type="">6</xref>) is based on reports by us and others of decreasing dependence of dispersion on the mean in many datasets [<xref ref-type="bibr" rid="CR3">3</xref>-<xref ref-type="bibr" rid="CR6">6</xref>,<xref ref-type="bibr" rid="CR51">51</xref>]. Some caution is warranted to disentangle true underlying dependence from effects of estimation bias that can create a perceived dependence of the dispersion on the mean. Consider a negative binomial distributed random variable with expectation <italic>μ</italic> and dispersion <italic>α</italic>. Its variance <italic>v</italic>=<italic>μ</italic>+<italic>α</italic><italic>μ</italic><sup>2</sup> has two components, <italic>v</italic>=<italic>v</italic><sub>P</sub>+<italic>v</italic><sub>D</sub>, the Poisson component <italic>v</italic><sub>P</sub>=<italic>μ</italic> independent of <italic>α</italic>, and the overdispersion component <italic>v</italic><sub>D</sub>=<italic>α</italic><italic>μ</italic><sup>2</sup>. When <italic>μ</italic> is small, <italic>μ</italic>≲1/<italic>α</italic> (vertical lines in Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S1), the Poisson component dominates, in the sense that <inline-formula id="IEq16"><alternatives><tex-math id="M53">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
							$v_{\text {P}}/v_{\text {D}} = 1/(\alpha \mu) \gtrsim 1$
						\end{document}</tex-math><mml:math id="M54"><mml:msub><mml:mrow><mml:mi>v</mml:mi></mml:mrow><mml:mrow><mml:mtext>P</mml:mtext></mml:mrow></mml:msub><mml:mo>/</mml:mo><mml:msub><mml:mrow><mml:mi>v</mml:mi></mml:mrow><mml:mrow><mml:mtext>D</mml:mtext></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:mo>(</mml:mo><mml:mi>αμ</mml:mi><mml:mo>)</mml:mo><mml:mo>≳</mml:mo><mml:mn>1</mml:mn></mml:math><inline-graphic xlink:href="13059_2014_550_Article_IEq16.gif"/></alternatives></inline-formula>, and the observed data provide little information on the value of <italic>α</italic>. Therefore the sampling variance of an estimator for <italic>α</italic> will be large when <italic>μ</italic>≲1/<italic>α</italic>, which leads to the appearance of bias. For simplicity, we have stated the above argument without regard to the influence of the size factors, <italic>s</italic><sub><italic>j</italic></sub>, on the value of <italic>μ</italic>. This is permissible because, by construction, the geometric mean of our size factors is close to 1, and hence, the mean across samples of the unnormalized read counts, <inline-formula id="IEq17"><alternatives><tex-math id="M55">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
							$\frac {1}{m}\sum _{j} K_{\textit {ij}}$
						\end{document}</tex-math><mml:math id="M56"><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:mfrac><mml:munder><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:munder><mml:msub><mml:mrow><mml:mi>K</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ij</mml:mtext></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13059_2014_550_Article_IEq17.gif"/></alternatives></inline-formula>, and the mean of the normalized read counts, <inline-formula id="IEq18"><alternatives><tex-math id="M57">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
							$\frac {1}{m}\sum _{j} K_{\textit {ij}}/s_{j}$
						\end{document}</tex-math><mml:math id="M58"><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:mfrac><mml:munder><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:munder><mml:msub><mml:mrow><mml:mi>K</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ij</mml:mtext></mml:mrow></mml:msub><mml:mo>/</mml:mo><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13059_2014_550_Article_IEq18.gif"/></alternatives></inline-formula>, will be roughly the same.</p>
      <p>This phenomenon may give rise to an apparent dependence of <italic>α</italic> on <italic>μ</italic>. It is possible that the shape of the dispersion-mean fit for the Bottomly data (Figure <xref rid="Fig1" ref-type="fig">1</xref>A) can be explained in that manner: the asymptotic dispersion is <italic>α</italic><sub>0</sub>≈0.01, and the non-zero slope of the mean-dispersion plot is limited to the range of mean counts up to around 100, the reciprocal of <italic>α</italic><sub>0</sub>. However, overestimation of <italic>α</italic> in that low-count range has little effect on inference, as in that range the variance <italic>v</italic> is anyway dominated by the <italic>α</italic>-independent Poisson component <italic>v</italic><sub>P</sub>. The situation is different for the Pickrell data: here, a dependence of dispersion on mean was observed for counts clearly above the reciprocal of the asymptotic dispersion <italic>α</italic><sub>0</sub> (Figure <xref rid="Fig1" ref-type="fig">1</xref>B), and hence is not due merely to estimation bias. Simulations (shown in Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S25) confirmed that the observed joint distribution of estimated dispersions and means is not compatible with a single, constant dispersion. Therefore, the parametrization (<xref rid="Equ6" ref-type="">6</xref>) is a flexible and mildly conservative modeling choice: it is able to pick up dispersion-mean dependence if it is present, while it can lead to a minor loss of power in the low-count range due to a tendency to overestimate dispersion there.</p>
      <p><bold>Dispersion prior</bold> As also observed by Wu <italic>et al.</italic> [<xref ref-type="bibr" rid="CR6">6</xref>], a log-normal prior fits the observed dispersion distribution for typical RNA-seq datasets. We solve the computational difficulty of working with a non-conjugate prior using the following argument: the logarithmic residuals from the trend fit, <inline-formula id="IEq19"><alternatives><tex-math id="M59">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
							$\log \alpha ^{\text {gw}}_{i} - \log \alpha _{\text {tr}}(\bar \mu _{i})$
						\end{document}</tex-math><mml:math id="M60"><mml:mo>log</mml:mo><mml:munderover><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mtext>gw</mml:mtext></mml:mrow></mml:munderover><mml:mo>−</mml:mo><mml:mo>log</mml:mo><mml:msub><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mtext>tr</mml:mtext></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mo>¯</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:math><inline-graphic xlink:href="13059_2014_550_Article_IEq19.gif"/></alternatives></inline-formula>, arise from two contributions, namely the scatter of the true logarithmic dispersions around the trend, given by the prior with variance <inline-formula id="IEq20"><alternatives><tex-math id="M61">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
							$\sigma _{\text {d}}^{2}$
						\end{document}</tex-math><mml:math id="M62"><mml:msubsup><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mtext>d</mml:mtext></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2014_550_Article_IEq20.gif"/></alternatives></inline-formula>, and the sampling distribution of the logarithm of the dispersion estimator, with variance <inline-formula id="IEq21"><alternatives><tex-math id="M63">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
							$\sigma ^{2}_{\text {lde}}$
						\end{document}</tex-math><mml:math id="M64"><mml:msubsup><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mtext>lde</mml:mtext></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2014_550_Article_IEq21.gif"/></alternatives></inline-formula>. The sampling distribution of a dispersion estimator is approximately a scaled <italic>χ</italic><sup>2</sup> distribution with <italic>m</italic>−<italic>p</italic> degrees of freedom, with <italic>m</italic> the number of samples and <italic>p</italic> the number of coefficients. The variance of the logarithm of a <inline-formula id="IEq22"><alternatives><tex-math id="M65">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
							${\chi ^{2}_{f}}$
						\end{document}</tex-math><mml:math id="M66"><mml:msubsup><mml:mrow><mml:mi>χ</mml:mi></mml:mrow><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2014_550_Article_IEq22.gif"/></alternatives></inline-formula>-distributed random variable is given [<xref ref-type="bibr" rid="CR52">52</xref>] by the trigamma function <italic>ψ</italic><sub>1</sub>,
<disp-formula id="Eque"><alternatives><tex-math id="M67">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
							 $$\operatorname{Var} \log X^{2} = \psi_{1}(f/2)\quad\text{for}\quad X^{2} {\sim\chi^{2}_{f}}.  $$ 
						\end{document}</tex-math><mml:math id="M68"><mml:mrow><mml:mo>Var</mml:mo><mml:mo>log</mml:mo><mml:msup><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>ψ</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mi>f</mml:mi><mml:mo>/</mml:mo><mml:mn>2</mml:mn><mml:mo>)</mml:mo><mml:mspace width="1em"/><mml:mtext>for</mml:mtext><mml:mspace width="1em"/><mml:msup><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo>∼</mml:mo><mml:munderover><mml:mrow><mml:mi>χ</mml:mi></mml:mrow><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:munderover><mml:mi>.</mml:mi></mml:mrow></mml:math><graphic xlink:href="13059_2014_550_Article_Eque.gif" position="anchor"/></alternatives></disp-formula> Therefore, <inline-formula id="IEq23"><alternatives><tex-math id="M69">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
							$\sigma ^{2}_{\text {lde}}\approx \psi _{1}((m-p)/2)$
						\end{document}</tex-math><mml:math id="M70"><mml:msubsup><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mtext>lde</mml:mtext></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo>≈</mml:mo><mml:msub><mml:mrow><mml:mi>ψ</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mo>(</mml:mo><mml:mi>m</mml:mi><mml:mo>−</mml:mo><mml:mi>p</mml:mi><mml:mo>)</mml:mo><mml:mo>/</mml:mo><mml:mn>2</mml:mn><mml:mo>)</mml:mo></mml:math><inline-graphic xlink:href="13059_2014_550_Article_IEq23.gif"/></alternatives></inline-formula>, i.e., the sampling variance of the logarithm of a variance or dispersion estimator is approximately constant across genes and depends only on the degrees of freedom of the model.</p>
      <p>Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S2 compares this approximation for the variance of logarithmic dispersion estimates with the variance of logarithmic Cox–Reid adjusted dispersion estimates for simulated negative binomial data, over a combination of different sample sizes, number of parameters and dispersion values used to create the simulated data. The approximation is close to the sample variance for various typical values of <italic>m</italic>, <italic>p</italic> and <italic>α</italic>.</p>
      <p>Therefore, the prior variance <inline-formula id="IEq24"><alternatives><tex-math id="M71">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
							$\sigma _{\text {d}}^{2}$
						\end{document}</tex-math><mml:math id="M72"><mml:msubsup><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mtext>d</mml:mtext></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2014_550_Article_IEq24.gif"/></alternatives></inline-formula> is obtained by subtracting the expected sampling variance from an estimate of the variance of the logarithmic residuals, <inline-formula id="IEq25"><alternatives><tex-math id="M73">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
							$s^{2}_{\text {lr}}$
						\end{document}</tex-math><mml:math id="M74"><mml:msubsup><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mtext>lr</mml:mtext></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2014_550_Article_IEq25.gif"/></alternatives></inline-formula>:
<disp-formula id="Equf"><alternatives><tex-math id="M75">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
							 $$\sigma_{\text{d}}^{2} = \operatorname{max}\left\{ s^{2}_{\text{lr}} - \psi_{1}((m-p)/2),\,\,0.25 \right\}. $$ 
						\end{document}</tex-math><mml:math id="M76"><mml:mrow><mml:msubsup><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mtext>d</mml:mtext></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mo>max</mml:mo><mml:mfenced close="}" open="{" separators=""><mml:mrow><mml:munderover><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mtext>lr</mml:mtext></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:munderover><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi>ψ</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mo>(</mml:mo><mml:mi>m</mml:mi><mml:mo>−</mml:mo><mml:mi>p</mml:mi><mml:mo>)</mml:mo><mml:mo>/</mml:mo><mml:mn>2</mml:mn><mml:mo>)</mml:mo><mml:mo>,</mml:mo><mml:mspace width="0.3em"/><mml:mspace width="0.3em"/><mml:mn>0.25</mml:mn></mml:mrow></mml:mfenced><mml:mi>.</mml:mi></mml:mrow></mml:math><graphic xlink:href="13059_2014_550_Article_Equf.gif" position="anchor"/></alternatives></disp-formula> The prior variance <inline-formula id="IEq26"><alternatives><tex-math id="M77">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
							$\sigma _{\text {d}}^{2}$
						\end{document}</tex-math><mml:math id="M78"><mml:msubsup><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mtext>d</mml:mtext></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2014_550_Article_IEq26.gif"/></alternatives></inline-formula> is thresholded at a minimal value of 0.25 so that the dispersion estimates are not shrunk entirely to <inline-formula id="IEq27"><alternatives><tex-math id="M79">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
							$\alpha _{\text {tr}}(\bar \mu _{i})$
						\end{document}</tex-math><mml:math id="M80"><mml:msub><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mtext>tr</mml:mtext></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mo>¯</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:math><inline-graphic xlink:href="13059_2014_550_Article_IEq27.gif"/></alternatives></inline-formula> if the variance of the logarithmic residuals is less than the expected sampling variance.</p>
      <p>To avoid inflation of <inline-formula id="IEq28"><alternatives><tex-math id="M81">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
							$\sigma _{\text {d}}^{2}$
						\end{document}</tex-math><mml:math id="M82"><mml:msubsup><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mtext>d</mml:mtext></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2014_550_Article_IEq28.gif"/></alternatives></inline-formula> due to dispersion outliers (i.e., genes not well captured by this prior; see below), we use a robust estimator for the standard deviation <italic>s</italic><sub>lr</sub> of the logarithmic residuals,
<disp-formula id="Equ8"><label>(8)</label><alternatives><tex-math id="M83">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
							 $$ s_{\text{lr}} = {\underset{i}{\text{mad}}} \left(\log \alpha^{\text{gw}}_{i} - \log \alpha_{\text{tr}}(\bar\mu_{i})\right),   $$ 
						\end{document}</tex-math><mml:math id="M84"><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mtext>lr</mml:mtext></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:munder><mml:mrow><mml:mtext>mad</mml:mtext></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:munder><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mo>log</mml:mo><mml:munderover><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mtext>gw</mml:mtext></mml:mrow></mml:munderover><mml:mo>−</mml:mo><mml:mo>log</mml:mo><mml:msub><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mtext>tr</mml:mtext></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mo>¯</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow></mml:mfenced><mml:mo>,</mml:mo></mml:math><graphic xlink:href="13059_2014_550_Article_Equ8.gif" position="anchor"/></alternatives></disp-formula></p>
      <p>where mad stands for the median absolute deviation, divided as usual by the scaling factor <italic>Φ</italic><sup>−1</sup>(3/4).</p>
      <p><bold>Three or less residuals degrees of freedom</bold> When there are three or less residual degrees of freedom (number of samples minus number of parameters to estimate), the estimation of the prior variance <inline-formula id="IEq29"><alternatives><tex-math id="M85">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
							$\sigma _{\text {d}}^{2}$
						\end{document}</tex-math><mml:math id="M86"><mml:msubsup><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mtext>d</mml:mtext></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2014_550_Article_IEq29.gif"/></alternatives></inline-formula> using the observed variance of logarithmic residuals <inline-formula id="IEq30"><alternatives><tex-math id="M87">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
							$s^{2}_{\text {lr}}$
						\end{document}</tex-math><mml:math id="M88"><mml:msubsup><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mtext>lr</mml:mtext></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2014_550_Article_IEq30.gif"/></alternatives></inline-formula> tends to underestimate <inline-formula id="IEq31"><alternatives><tex-math id="M89">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
							$\sigma _{\text {d}}^{2}$
						\end{document}</tex-math><mml:math id="M90"><mml:msubsup><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mtext>d</mml:mtext></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2014_550_Article_IEq31.gif"/></alternatives></inline-formula>. In this case, we instead estimate the prior variance through simulation. We match the distribution of logarithmic residuals to a density of simulated logarithmic residuals. These are the logarithm of <inline-formula id="IEq32"><alternatives><tex-math id="M91">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
							$\chi ^{2}_{m-p}$
						\end{document}</tex-math><mml:math id="M92"><mml:msubsup><mml:mrow><mml:mi>χ</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi><mml:mo>−</mml:mo><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2014_550_Article_IEq32.gif"/></alternatives></inline-formula>-distributed random variables added to <inline-formula id="IEq33"><alternatives><tex-math id="M93">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
							$N(0,\sigma _{\text {d}}^{2})$
						\end{document}</tex-math><mml:math id="M94"><mml:mi>N</mml:mi><mml:mo>(</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mtext>d</mml:mtext></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo>)</mml:mo></mml:math><inline-graphic xlink:href="13059_2014_550_Article_IEq33.gif"/></alternatives></inline-formula> random variables to account for the spread due to the prior. The simulated distribution is shifted by − log(<italic>m</italic>−<italic>p</italic>) to account for the scaling of the <italic>χ</italic><sup>2</sup> distribution. We repeat the simulation over a grid of values for <inline-formula id="IEq34"><alternatives><tex-math id="M95">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
							$\sigma _{\text {d}}^{2}$
						\end{document}</tex-math><mml:math id="M96"><mml:msubsup><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mtext>d</mml:mtext></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2014_550_Article_IEq34.gif"/></alternatives></inline-formula>, and select the value that minimizes the Kullback–Leibler divergence from the observed density of logarithmic residuals to the simulated density.</p>
      <p><bold>Final dispersion estimate</bold> We form a logarithmic posterior for the dispersion from the Cox–Reid adjusted logarithmic likelihood (<xref rid="Equ7" ref-type="">7</xref>) and the logarithmic prior (<xref rid="Equ5" ref-type="">5</xref>) and use its maximum (i.e., the MAP value) as the final estimate of the dispersion,
<disp-formula id="Equ9"><label>(9)</label><alternatives><tex-math id="M97">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
							 $$ \alpha_{i}^{\text{MAP}} = {\underset{\alpha}{\text{arg max}}}\, \left(\ell_{\text{CR}}\left(\alpha; \vec\mu_{\textit{i}\cdot}^{0}, \vec K_{\textit{i}\cdot}\right) + \Lambda_{i}(\alpha) \right),   $$ 
						\end{document}</tex-math><mml:math id="M98"><mml:msubsup><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mtext>MAP</mml:mtext></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:munder><mml:mrow><mml:mtext>arg max</mml:mtext></mml:mrow><mml:mrow><mml:mi>α</mml:mi></mml:mrow></mml:munder><mml:mspace width="0.3em"/><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msub><mml:mrow><mml:mi>ℓ</mml:mi></mml:mrow><mml:mrow><mml:mtext>CR</mml:mtext></mml:mrow></mml:msub><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mi>α</mml:mi><mml:mo>;</mml:mo><mml:msubsup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mo>→</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">i</mml:mtext><mml:mo>·</mml:mo></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>K</mml:mi></mml:mrow><mml:mo>→</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">i</mml:mtext><mml:mo>·</mml:mo></mml:mrow></mml:msub></mml:mrow></mml:mfenced><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>Λ</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mi>α</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mfenced><mml:mo>,</mml:mo></mml:math><graphic xlink:href="13059_2014_550_Article_Equ9.gif" position="anchor"/></alternatives></disp-formula></p>
      <p>where
<disp-formula id="Equg"><alternatives><tex-math id="M99">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
							 $$\Lambda_{i}(\alpha) = \frac{- \left(\log\alpha-\log\alpha_{\text{tr}}(\bar\mu_{i})\right)^{2}}{2 \sigma_{\text{d}}^{2}}, $$ 
						\end{document}</tex-math><mml:math id="M100"><mml:mrow><mml:msub><mml:mrow><mml:mi>Λ</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mi>α</mml:mi><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mo>−</mml:mo><mml:msup><mml:mrow><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mo>log</mml:mo><mml:mi>α</mml:mi><mml:mo>−</mml:mo><mml:mo>log</mml:mo><mml:msub><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mtext>tr</mml:mtext></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mo>¯</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:msubsup><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mtext>d</mml:mtext></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:mrow></mml:mfrac><mml:mo>,</mml:mo></mml:mrow></mml:math><graphic xlink:href="13059_2014_550_Article_Equg.gif" position="anchor"/></alternatives></disp-formula> is, up to an additive constant, the logarithm of the density of prior (<xref rid="Equ5" ref-type="">5</xref>). Again, a backtracking line search is used to perform the optimization.</p>
      <p><bold>Dispersion outliers</bold> For some genes, the gene-wise estimate <inline-formula id="IEq35"><alternatives><tex-math id="M101">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
							$\alpha ^{\text {gw}}_{i}$
						\end{document}</tex-math><mml:math id="M102"><mml:msubsup><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mtext>gw</mml:mtext></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2014_550_Article_IEq35.gif"/></alternatives></inline-formula> can be so far above the prior expectation <inline-formula id="IEq36"><alternatives><tex-math id="M103">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
							$\alpha _{\text {tr}}(\bar \mu _{i})$
						\end{document}</tex-math><mml:math id="M104"><mml:msub><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mtext>tr</mml:mtext></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mo>¯</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:math><inline-graphic xlink:href="13059_2014_550_Article_IEq36.gif"/></alternatives></inline-formula> that it would be unreasonable to assume that the prior is suitable for the gene. If the dispersion estimate for such genes were down-moderated toward the fitted trend, this might lead to false positives. Therefore, we use the heuristic of considering a gene as a dispersion outlier, if the residual from the trend fit is more than two standard deviations of logarithmic residuals, <italic>s</italic><sub>lr</sub> (see Equation (<xref rid="Equ8" ref-type="">8</xref>)), above the fit, i.e., if
<disp-formula id="Equh"><alternatives><tex-math id="M105">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
							 $$ \log \alpha_{i}^{\text{gw}} &gt; \log\alpha_{\text{tr}}(\bar\mu_{i}) + 2 s_{\text{lr}}. $$ \end{document}</tex-math><mml:math id="M106"><mml:mrow><mml:mo>log</mml:mo><mml:munderover><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mtext>gw</mml:mtext></mml:mrow></mml:munderover><mml:mo>&gt;</mml:mo><mml:mo>log</mml:mo><mml:msub><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mtext>tr</mml:mtext></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mo>¯</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo><mml:mo>+</mml:mo><mml:mn>2</mml:mn><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mtext>lr</mml:mtext></mml:mrow></mml:msub><mml:mi>.</mml:mi></mml:mrow></mml:math><graphic xlink:href="13059_2014_550_Article_Equh.gif" position="anchor"/></alternatives></disp-formula></p>
      <p>For such genes, the gene-wise estimate <inline-formula id="IEq37"><alternatives><tex-math id="M107">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
							$\alpha ^{\text {gw}}_{i}$
						\end{document}</tex-math><mml:math id="M108"><mml:msubsup><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mtext>gw</mml:mtext></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2014_550_Article_IEq37.gif"/></alternatives></inline-formula> is not shrunk toward the trended prior mean. Instead of the MAP value <inline-formula id="IEq38"><alternatives><tex-math id="M109">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
							$\alpha _{i}^{\text {MAP}}$
						\end{document}</tex-math><mml:math id="M110"><mml:msubsup><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mtext>MAP</mml:mtext></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2014_550_Article_IEq38.gif"/></alternatives></inline-formula>, we use the gene-wise estimate <inline-formula id="IEq39"><alternatives><tex-math id="M111">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
							$\alpha ^{\text {gw}}_{i}$
						\end{document}</tex-math><mml:math id="M112"><mml:msubsup><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mtext>gw</mml:mtext></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2014_550_Article_IEq39.gif"/></alternatives></inline-formula> as a final dispersion value in the subsequent steps. In addition, the iterative fitting procedure for the parametric dispersion trend described above avoids that such dispersion outliers influence the prior mean.</p>
    </sec>
    <sec id="Sec23">
      <title>Shrinkage estimation of logarithmic fold changes</title>
      <p>To incorporate empirical Bayes shrinkage of LFCs, we postulate a zero-centered normal prior for the coefficients <italic>β</italic><sub><italic>ir</italic></sub> of model (<xref rid="Equ2" ref-type="">2</xref>) that represent LFCs (i.e., typically, all coefficients except for the intercept <italic>β</italic><sub><italic>i</italic>0</sub>):
<disp-formula id="Equ10"><label>(10)</label><alternatives><tex-math id="M113">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
							 $$ \beta_{ir} \sim N\!\left(0, {\sigma_{r}^{2}} \right).   $$ 
						\end{document}</tex-math><mml:math id="M114"><mml:msub><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ir</mml:mtext></mml:mrow></mml:msub><mml:mo>∼</mml:mo><mml:mi>N</mml:mi><mml:mspace width="0.3em"/><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:mrow></mml:mfenced><mml:mi>.</mml:mi></mml:math><graphic xlink:href="13059_2014_550_Article_Equ10.gif" position="anchor"/></alternatives></disp-formula></p>
      <p>As was observed with differential expression analysis using microarrays, genes with low intensity values tend to suffer from a small signal-to-noise ratio. Alternative estimators can be found that are more stable than the standard calculation of fold change as the ratio of average observed values for each condition [<xref ref-type="bibr" rid="CR53">53</xref>-<xref ref-type="bibr" rid="CR55">55</xref>]. <italic>DESeq2</italic>’s approach can be seen as an extension of these approaches for stable estimation of gene-expression fold changes to count data.</p>
      <p><bold>Empirical prior estimate</bold> To obtain values for the empirical prior widths <italic>σ</italic><sub><italic>r</italic></sub> for the model coefficients, we again approximate a full empirical Bayes approach, as with the estimation of dispersion prior, though here we do not subtract the expected sampling variance from the observed variance of maximum likelihood estimates. The estimate of the LFC prior width is calculated as follows. We use the standard iteratively reweighted least-squares algorithm [<xref ref-type="bibr" rid="CR12">12</xref>] for each gene’s model, Equations (<xref rid="Equ1" ref-type="">1</xref>) and (<xref rid="Equ2" ref-type="">2</xref>), to get MLEs for the coefficients <inline-formula id="IEq40"><alternatives><tex-math id="M115">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
							$\beta _{\textit {ir}}^{\text {MLE}}$
						\end{document}</tex-math><mml:math id="M116"><mml:msubsup><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ir</mml:mtext></mml:mrow><mml:mrow><mml:mtext>MLE</mml:mtext></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2014_550_Article_IEq40.gif"/></alternatives></inline-formula>. We then fit, for each column <italic>r</italic> of the design matrix (except for the intercept), a zero-centered normal distribution to the empirical distribution of MLE fold change estimates <inline-formula id="IEq41"><alternatives><tex-math id="M117">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
							$\vec {\beta }^{\text {MLE}}_{r}$
						\end{document}</tex-math><mml:math id="M118"><mml:msubsup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mo>→</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mtext>MLE</mml:mtext></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2014_550_Article_IEq41.gif"/></alternatives></inline-formula>.</p>
      <p>To make the fit robust against outliers with very high absolute LFC values, we use quantile matching: the width <italic>σ</italic><sub><italic>r</italic></sub> is chosen such that the (1−<italic>p</italic>) empirical quantile of the absolute value of the observed LFCs, <inline-formula id="IEq42"><alternatives><tex-math id="M119">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
							$\vec {\beta }^{\text {MLE}}_{r}$
						\end{document}</tex-math><mml:math id="M120"><mml:msubsup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mo>→</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mtext>MLE</mml:mtext></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2014_550_Article_IEq42.gif"/></alternatives></inline-formula>, matches the (1−<italic>p</italic>/2) theoretical quantile of the prior, <inline-formula id="IEq43"><alternatives><tex-math id="M121">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
							$N(0,{\sigma _{r}^{2}})$
						\end{document}</tex-math><mml:math id="M122"><mml:mi>N</mml:mi><mml:mo>(</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo>)</mml:mo></mml:math><inline-graphic xlink:href="13059_2014_550_Article_IEq43.gif"/></alternatives></inline-formula>, where <italic>p</italic> is set by default to 0.05. If we write the theoretical upper quantile of a normal distribution as <italic>Q</italic><sub><italic>N</italic></sub>(1−<italic>p</italic>) and the empirical upper quantile of the MLE LFCs as <inline-formula id="IEq44"><alternatives><tex-math id="M123">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
							$Q_{|\beta _{r}|}(1 - p)$
						\end{document}</tex-math><mml:math id="M124"><mml:msub><mml:mrow><mml:mi>Q</mml:mi></mml:mrow><mml:mrow><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mo>|</mml:mo></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>p</mml:mi><mml:mo>)</mml:mo></mml:math><inline-graphic xlink:href="13059_2014_550_Article_IEq44.gif"/></alternatives></inline-formula>, then the prior width is calculated as:
<disp-formula id="Equi"><alternatives><tex-math id="M125">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
							 $$ \sigma_{r} = \frac{Q_{|\beta_{r}|}(1 - p)}{Q_{N}(1 - p/2)}. $$ 
						\end{document}</tex-math><mml:math id="M126"><mml:mrow><mml:msub><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi>Q</mml:mi></mml:mrow><mml:mrow><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mo>|</mml:mo></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>p</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>Q</mml:mi></mml:mrow><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>p</mml:mi><mml:mo>/</mml:mo><mml:mn>2</mml:mn><mml:mo>)</mml:mo></mml:mrow></mml:mfrac><mml:mi>.</mml:mi></mml:mrow></mml:math><graphic xlink:href="13059_2014_550_Article_Equi.gif" position="anchor"/></alternatives></disp-formula></p>
      <p>To ensure that the prior width <italic>σ</italic><sub><italic>r</italic></sub> will be independent of the choice of base level, the estimates from the quantile matching procedure are averaged for each factor over all possible contrasts of factor levels. When determining the empirical upper quantile, extreme LFC values (<inline-formula id="IEq45"><alternatives><tex-math id="M127">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
							$\left |\beta _{\textit {ir}}^{\text {MLE}}\right | &gt; \log (2) \, 10$\end{document}</tex-math><mml:math id="M128"><mml:mfenced close="|" open="|" separators=""><mml:mrow><mml:msubsup><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ir</mml:mtext></mml:mrow><mml:mrow><mml:mtext>MLE</mml:mtext></mml:mrow></mml:msubsup></mml:mrow></mml:mfenced><mml:mo>&gt;</mml:mo><mml:mo>log</mml:mo><mml:mo>(</mml:mo><mml:mn>2</mml:mn><mml:mo>)</mml:mo><mml:mspace width="0.3em"/><mml:mn>10</mml:mn></mml:math><inline-graphic xlink:href="13059_2014_550_Article_IEq45.gif"/></alternatives></inline-formula>, or 10 on the base 2 scale) are excluded.</p>
      <p><bold>Final estimate of logarithmic fold changes</bold> The logarithmic posterior for the vector, <inline-formula id="IEq46"><alternatives><tex-math id="M129">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
							$\vec \beta _{i}$
						\end{document}</tex-math><mml:math id="M130"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mo>→</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13059_2014_550_Article_IEq46.gif"/></alternatives></inline-formula>, of model coefficients <italic>β</italic><sub><italic>ir</italic></sub> for gene <italic>i</italic> is the sum of the logarithmic likelihood of the GLM (<xref rid="Equ2" ref-type="">2</xref>) and the logarithm of the prior density (<xref rid="Equ10" ref-type="">10</xref>), and its maximum yields the final MAP coefficient estimates:
<disp-formula id="Equj"><alternatives><tex-math id="M131">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
							 $$\vec\beta_{i} = {\underset{\vec\beta}{\text{arg max}}} \left(\sum_{j} \log f_{\text{NB}}\left(K_{ij};\mu_{j}(\vec\beta),\alpha_{i} \right) + \Lambda(\vec\beta) \right), $$ 
						\end{document}</tex-math><mml:math id="M132"><mml:mrow><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mo>→</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:munder><mml:mrow><mml:mtext>arg max</mml:mtext></mml:mrow><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mo>→</mml:mo></mml:mover></mml:mrow></mml:munder><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:munder><mml:mrow><mml:mo mathsize="big">∑</mml:mo></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:munder><mml:mo>log</mml:mo><mml:msub><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mtext>NB</mml:mtext></mml:mrow></mml:msub><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msub><mml:mrow><mml:mi>K</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ij</mml:mtext></mml:mrow></mml:msub><mml:mo>;</mml:mo><mml:msub><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mover accent="true"><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mo>→</mml:mo></mml:mover><mml:mo>)</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced><mml:mo>+</mml:mo><mml:mi>Λ</mml:mi><mml:mo>(</mml:mo><mml:mover accent="true"><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mo>→</mml:mo></mml:mover><mml:mo>)</mml:mo></mml:mrow></mml:mfenced><mml:mo>,</mml:mo></mml:mrow></mml:math><graphic xlink:href="13059_2014_550_Article_Equj.gif" position="anchor"/></alternatives></disp-formula> where
<disp-formula id="Equk"><alternatives><tex-math id="M133">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
							 $$\mu_{j}(\vec\beta) = s_{ij} e^{\sum_{r} x_{jr} \beta_{r}}, \quad \Lambda(\vec\beta) = \sum_{r} \frac{- {\beta_{r}^{2}}}{2 {\sigma_{r}^{2}}}, $$ 
						\end{document}</tex-math><mml:math id="M134"><mml:mrow><mml:msub><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mover accent="true"><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mo>→</mml:mo></mml:mover><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ij</mml:mtext></mml:mrow></mml:msub><mml:msup><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:munder><mml:mrow><mml:mo mathsize="big">∑</mml:mo></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:munder><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">jr</mml:mtext></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:mspace width="1em"/><mml:mi>Λ</mml:mi><mml:mo>(</mml:mo><mml:mover accent="true"><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mo>→</mml:mo></mml:mover><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:munder><mml:mrow><mml:mo mathsize="big">∑</mml:mo></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:munder><mml:mfrac><mml:mrow><mml:mo>−</mml:mo><mml:msubsup><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:msubsup><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:mrow></mml:mfrac><mml:mo>,</mml:mo></mml:mrow></mml:math><graphic xlink:href="13059_2014_550_Article_Equk.gif" position="anchor"/></alternatives></disp-formula> and <italic>α</italic><sub><italic>i</italic></sub> is the final dispersion estimate for gene <italic>i</italic>, i.e., <inline-formula id="IEq47"><alternatives><tex-math id="M135">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
							$\alpha _{i}=\alpha _{i}^{\text {MAP}}$
						\end{document}</tex-math><mml:math id="M136"><mml:msub><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msubsup><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mtext>MAP</mml:mtext></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2014_550_Article_IEq47.gif"/></alternatives></inline-formula>, except for dispersion outliers, where <inline-formula id="IEq48"><alternatives><tex-math id="M137">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
							$\alpha _{i}=\alpha _{i}^{\text {gw}}$
						\end{document}</tex-math><mml:math id="M138"><mml:msub><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msubsup><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mtext>gw</mml:mtext></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2014_550_Article_IEq48.gif"/></alternatives></inline-formula>.</p>
      <p>The term <italic>Λ</italic>(<italic>β</italic>), i.e., the logarithm of the density of the normal prior (up to an additive constant), can be read as a ridge penalty term, and therefore, we perform the optimization using the <italic>iteratively reweighted ridge regression algorithm</italic> [<xref ref-type="bibr" rid="CR56">56</xref>], also known as <italic>weighted updates</italic> [<xref ref-type="bibr" rid="CR57">57</xref>]. Specifically, the updates for a given gene are of the form
<disp-formula id="Equl"><alternatives><tex-math id="M139">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
							 $$ \vec\beta \leftarrow \left(X^{t} W X + \vec{\lambda} I\right)^{-1} X^{t} W \vec{z}, $$ 
						\end{document}</tex-math><mml:math id="M140"><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mo>→</mml:mo></mml:mover><mml:mo>←</mml:mo><mml:msup><mml:mrow><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msup><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msup><mml:mtext mathvariant="italic">WX</mml:mtext><mml:mo>+</mml:mo><mml:mover accent="true"><mml:mrow><mml:mi>λ</mml:mi></mml:mrow><mml:mo>→</mml:mo></mml:mover><mml:mi>I</mml:mi></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:msup><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msup><mml:mi>W</mml:mi><mml:mover accent="true"><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mo>→</mml:mo></mml:mover><mml:mo>,</mml:mo></mml:mrow></mml:math><graphic xlink:href="13059_2014_550_Article_Equl.gif" position="anchor"/></alternatives></disp-formula> with <inline-formula id="IEq49"><alternatives><tex-math id="M141">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
							$\lambda _{r} = 1/{\sigma _{r}^{2}}$
						\end{document}</tex-math><mml:math id="M142"><mml:msub><mml:mrow><mml:mi>λ</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:msubsup><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2014_550_Article_IEq49.gif"/></alternatives></inline-formula> and
<disp-formula id="Equm"><alternatives><tex-math id="M143">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
							 $$ z_{j} = \log \frac{\mu_{j}}{s_{j}} + \frac{K_{j} - \mu_{j}}{\mu_{j}}, $$ 
						\end{document}</tex-math><mml:math id="M144"><mml:mrow><mml:msub><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mo>log</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:mo>+</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi>K</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:mo>,</mml:mo></mml:mrow></mml:math><graphic xlink:href="13059_2014_550_Article_Equm.gif" position="anchor"/></alternatives></disp-formula> where the current fitted values <inline-formula id="IEq50"><alternatives><tex-math id="M145">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
							$\mu _{j} = s_{j} e^{\sum _{r} x_{\textit {jr}}\beta _{r}}$
						\end{document}</tex-math><mml:math id="M146"><mml:msub><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:msup><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:munder><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:munder><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">jr</mml:mtext></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msup></mml:math><inline-graphic xlink:href="13059_2014_550_Article_IEq50.gif"/></alternatives></inline-formula> are computed from the current estimates <inline-formula id="IEq51"><alternatives><tex-math id="M147">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
							$\vec \beta $
						\end{document}</tex-math><mml:math id="M148"><mml:mover accent="true"><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mo>→</mml:mo></mml:mover></mml:math><inline-graphic xlink:href="13059_2014_550_Article_IEq51.gif"/></alternatives></inline-formula> in each iteration.</p>
      <p><bold>Fisher information.</bold> The effect of the zero-centered normal prior can be understood as shrinking the MAP LFC estimates based on the amount of information the experiment provides for this coefficient, and we briefly elaborate on this here. Specifically, for a given gene <italic>i</italic>, the shrinkage for an LFC <italic>β</italic><sub><italic>ir</italic></sub> depends on the <italic>observed Fisher information</italic>, given by
<disp-formula id="Equn"><alternatives><tex-math id="M149">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
							 $$\mathcal{J}_{m}(\hat\beta_{ir}) = - \left[ \frac{\partial^{2}}{\partial \beta_{ir}^{2}} \ell\left(\vec\beta_{i} ; \vec{K_{i}}, \alpha_{i}\right) \right]_{\beta_{ir} = \hat\beta_{ir}}, $$ 
						\end{document}</tex-math><mml:math id="M150"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="script">J</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ir</mml:mtext></mml:mrow></mml:msub><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mfenced close="]" open="[" separators=""><mml:mrow><mml:mfrac><mml:mrow><mml:msup><mml:mrow><mml:mi>∂</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:mi>∂</mml:mi><mml:msubsup><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ir</mml:mtext></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:mrow></mml:mfrac><mml:mi>ℓ</mml:mi><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mo>→</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>;</mml:mo><mml:mover accent="true"><mml:mrow><mml:msub><mml:mrow><mml:mi>K</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>→</mml:mo></mml:mover><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ir</mml:mtext></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ir</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo>,</mml:mo></mml:mrow></mml:math><graphic xlink:href="13059_2014_550_Article_Equn.gif" position="anchor"/></alternatives></disp-formula> where <inline-formula id="IEq52"><alternatives><tex-math id="M151">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
							$\ell \left (\vec \beta _{i} ; \vec {K_{i}}, \alpha _{i}\right)$
						\end{document}</tex-math><mml:math id="M152"><mml:mi>ℓ</mml:mi><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mo>→</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>;</mml:mo><mml:mover accent="true"><mml:mrow><mml:msub><mml:mrow><mml:mi>K</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>→</mml:mo></mml:mover><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:math><inline-graphic xlink:href="13059_2014_550_Article_IEq52.gif"/></alternatives></inline-formula> is the logarithm of the likelihood, and partial derivatives are taken with respect to LFC <italic>β</italic><sub><italic>ir</italic></sub>. For a negative binomial GLM, the observed Fisher information, or peakedness of the logarithm of the profile likelihood, is influenced by a number of factors including the degrees of freedom, the estimated mean counts <italic>μ</italic><sub><italic>ij</italic></sub>, and the gene’s dispersion estimate <italic>α</italic><sub><italic>i</italic></sub>. The prior influences the MAP estimate when the density of the likelihood and the prior are multiplied to calculate the posterior. Genes with low estimated mean values <italic>μ</italic><sub><italic>ij</italic></sub> or high dispersion estimates <italic>α</italic><sub><italic>i</italic></sub> have flatter profile likelihoods, as do datasets with few residual degrees of freedom, and therefore in these cases the zero-centered prior pulls the MAP estimate from a high-uncertainty MLE closer toward zero.</p>
    </sec>
    <sec id="Sec24">
      <title>Wald test</title>
      <p>The Wald test compares the beta estimate <italic>β</italic><sub><italic>ir</italic></sub> divided by its estimated standard error SE(<italic>β</italic><sub><italic>ir</italic></sub>) to a standard normal distribution. The estimated standard errors are the square root of the diagonal elements of the estimated covariance matrix, <italic>Σ</italic><sub><italic>i</italic></sub>, for the coefficients, i.e., <inline-formula id="IEq53"><alternatives><tex-math id="M153">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
							$\operatorname {SE}(\beta _{\textit {ir}})=\sqrt {\Sigma _{i,rr}}$
						\end{document}</tex-math><mml:math id="M154"><mml:mo>SE</mml:mo><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ir</mml:mtext></mml:mrow></mml:msub><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:msqrt><mml:mrow><mml:msub><mml:mrow><mml:mi>Σ</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mtext mathvariant="italic">rr</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:msqrt></mml:math><inline-graphic xlink:href="13059_2014_550_Article_IEq53.gif"/></alternatives></inline-formula>. Contrasts of coefficients are tested similarly by forming a Wald statistics using (<xref rid="Equ3" ref-type="">3</xref>) and (<xref rid="Equ4" ref-type="">4</xref>). We use the following formula for the coefficient covariance matrix for a GLM with normal prior on coefficients [<xref ref-type="bibr" rid="CR56">56</xref>, <xref ref-type="bibr" rid="CR58">58</xref>]:
<disp-formula id="Equo"><alternatives><tex-math id="M155">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
							 $$\Sigma_{i} = \operatorname{Cov}(\vec{\beta}_{i}) = (X^{t} W X + \vec{\lambda} I)^{-1} (X^{t} W X) (X^{t} W X + \vec{\lambda} I)^{-1}. $$ 
						\end{document}</tex-math><mml:math id="M156"><mml:mrow><mml:mspace width="-14.0pt"/><mml:msub><mml:mrow><mml:mi>Σ</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mo>Cov</mml:mo><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mo>→</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:msup><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msup><mml:mtext mathvariant="italic">WX</mml:mtext><mml:mo>+</mml:mo><mml:mover accent="true"><mml:mrow><mml:mi>λ</mml:mi></mml:mrow><mml:mo>→</mml:mo></mml:mover><mml:mi>I</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mo>(</mml:mo><mml:msup><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msup><mml:mtext mathvariant="italic">WX</mml:mtext><mml:mo>)</mml:mo><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:msup><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msup><mml:mtext mathvariant="italic">WX</mml:mtext><mml:mo>+</mml:mo><mml:mover accent="true"><mml:mrow><mml:mi>λ</mml:mi></mml:mrow><mml:mo>→</mml:mo></mml:mover><mml:mi>I</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mi>.</mml:mi></mml:mrow></mml:math><graphic xlink:href="13059_2014_550_Article_Equo.gif" position="anchor"/></alternatives></disp-formula> The tail integrals of the standard normal distribution are multiplied by 2 to achieve a two-tailed test. The Wald test <italic>P</italic> values from the subset of genes that pass the independent filtering step are adjusted for multiple testing using the procedure of Benjamini and Hochberg [<xref ref-type="bibr" rid="CR21">21</xref>].</p>
    </sec>
    <sec id="Sec25">
      <title>Independent filtering</title>
      <p>Independent filtering does not compromise type-I error control as long as the distribution of the test statistic is marginally independent of the filter statistic <italic>under the null hypothesis</italic> [<xref ref-type="bibr" rid="CR22">22</xref>], and we argue in the following that this is the case in our application. The filter statistic in <italic>DESeq2</italic> is the mean of normalized counts for a gene, while the test statistic is <italic>p</italic>, the <italic>P</italic> value from the Wald test. We first consider the case where the size factors are equal and where the gene-wise dispersion estimates are used for each gene, i.e. without dispersion shrinkage. The distribution family for the negative binomial is parameterized by <italic>θ</italic>=(<italic>μ</italic>,<italic>α</italic>). Aside from discreteness of <italic>p</italic> due to low counts, for a given <italic>μ</italic>, the distribution of <italic>p</italic> is Uniform(0,1) under the null hypothesis, so <italic>p</italic> is an ancillary statistic. The sample mean of counts for gene <italic>i</italic>, <inline-formula id="IEq54"><alternatives><tex-math id="M157">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
							$\bar {K}_{i}$
						\end{document}</tex-math><mml:math id="M158"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>K</mml:mi></mml:mrow><mml:mo>¯</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13059_2014_550_Article_IEq54.gif"/></alternatives></inline-formula>, is boundedly complete sufficient for <italic>μ</italic>. Then from Basu’s theorem, <inline-formula id="IEq55"><alternatives><tex-math id="M159">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
							$\bar {K}_{i}$
						\end{document}</tex-math><mml:math id="M160"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>K</mml:mi></mml:mrow><mml:mo>¯</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13059_2014_550_Article_IEq55.gif"/></alternatives></inline-formula> and <italic>p</italic> are independent.</p>
      <p>While for very low counts, one can observe discreteness and non-uniformity of <italic>p</italic> under the null hypothesis, <italic>DESeq2</italic> does not use the distribution of <italic>p</italic> in its estimation procedure – for example, <italic>DESeq2</italic> does not estimate the proportion of null genes using the distribution of <italic>p</italic> – so this kind of dependence of <italic>p</italic> on <italic>μ</italic> does not lead to increased type-I error.</p>
      <p>If the size factors are not equal across samples, but not correlated with condition, conditioning on the mean of <italic>normalized</italic> counts should also provide uniformly distributed <italic>p</italic> as with conditioning on the mean of counts, <inline-formula id="IEq56"><alternatives><tex-math id="M161">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
							$\bar {K}_{i}$
						\end{document}</tex-math><mml:math id="M162"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>K</mml:mi></mml:mrow><mml:mo>¯</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13059_2014_550_Article_IEq56.gif"/></alternatives></inline-formula>. We may consider a pathological case where the size factors are perfectly confounded with condition, in which case, even under the null hypothesis, genes with low mean count would have non-uniform distribution of <italic>p</italic>, as one condition could have positive counts and the other condition often zero counts. This could lead to non-uniformity of <italic>p</italic> under the null hypothesis; however, such a pathological case would pose problems for many statistical tests of differences in mean.</p>
      <p>We used simulation to demonstrate that the independence of the null distribution of the test statistic from the filter statistic still holds for dispersion shrinkage. Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S26 displays marginal null distributions of <italic>p</italic> across the range of mean normalized counts. Despite spikes in the distribution for the genes with the lowest mean counts due to discreteness of the data, these densities were nearly uniform across the range of average expression strength.</p>
    </sec>
    <sec id="Sec26">
      <title>Composite null hypotheses</title>
      <p><italic>DESeq2</italic> offers tests for composite null hypotheses of the form <inline-formula id="IEq57"><alternatives><tex-math id="M163">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
							$\mathcal {H}_{0}: |\beta _{\textit {ir}}| \le \theta $
						\end{document}</tex-math><mml:math id="M164"><mml:msub><mml:mrow><mml:mi mathvariant="script">ℋ</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>:</mml:mo><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ir</mml:mtext></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:mo>≤</mml:mo><mml:mi>θ</mml:mi></mml:math><inline-graphic xlink:href="13059_2014_550_Article_IEq57.gif"/></alternatives></inline-formula> to find genes whose LFC significantly exceeds a threshold <italic>θ</italic>&gt;0. The composite null hypothesis is replaced by two simple null hypotheses: <inline-formula id="IEq58"><alternatives><tex-math id="M165">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
							$\mathcal {H}_{0a}: \beta _{\textit {ir}} = \theta $
						\end{document}</tex-math><mml:math id="M166"><mml:msub><mml:mrow><mml:mi mathvariant="script">ℋ</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn><mml:mi>a</mml:mi></mml:mrow></mml:msub><mml:mo>:</mml:mo><mml:msub><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ir</mml:mtext></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>θ</mml:mi></mml:math><inline-graphic xlink:href="13059_2014_550_Article_IEq58.gif"/></alternatives></inline-formula> and <inline-formula id="IEq59"><alternatives><tex-math id="M167">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
							$\mathcal {H}_{0b}: \beta _{\textit {ir}} = -\theta $
						\end{document}</tex-math><mml:math id="M168"><mml:msub><mml:mrow><mml:mi mathvariant="script">ℋ</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn><mml:mi>b</mml:mi></mml:mrow></mml:msub><mml:mo>:</mml:mo><mml:msub><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ir</mml:mtext></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:mi>θ</mml:mi></mml:math><inline-graphic xlink:href="13059_2014_550_Article_IEq59.gif"/></alternatives></inline-formula>. Two-tailed <italic>P</italic> values are generated by integrating a normal distribution centered on <italic>θ</italic> with standard deviation SE(<italic>β</italic><sub><italic>ir</italic></sub>) from |<italic>β</italic><sub><italic>ir</italic></sub>| toward <italic>∞</italic>. The value of the integral is then multiplied by 2 and thresholded at 1. This procedure controls type-I error even when <italic>β</italic><sub><italic>ir</italic></sub>=±<italic>θ</italic>, and is equivalent to the standard <italic>DESeq2</italic><italic>P</italic> value when <italic>θ</italic>=0.</p>
      <p>Conversely, when searching for genes whose absolute LFC is significantly below a threshold, i.e., when testing the null hypothesis <inline-formula id="IEq60"><alternatives><tex-math id="M169">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
							$\mathcal {H}_{0}: |\beta _{\textit {ir}}| \ge \theta $
						\end{document}</tex-math><mml:math id="M170"><mml:msub><mml:mrow><mml:mi mathvariant="script">ℋ</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>:</mml:mo><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ir</mml:mtext></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:mo>≥</mml:mo><mml:mi>θ</mml:mi></mml:math><inline-graphic xlink:href="13059_2014_550_Article_IEq60.gif"/></alternatives></inline-formula>, the <italic>P</italic> value is constructed as the maximum of two one-sided tests of the simple null hypotheses: <inline-formula id="IEq61"><alternatives><tex-math id="M171">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
							$\mathcal {H}_{0a}: \beta _{\textit {ir}} = \theta $
						\end{document}</tex-math><mml:math id="M172"><mml:msub><mml:mrow><mml:mi mathvariant="script">ℋ</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn><mml:mi>a</mml:mi></mml:mrow></mml:msub><mml:mo>:</mml:mo><mml:msub><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ir</mml:mtext></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>θ</mml:mi></mml:math><inline-graphic xlink:href="13059_2014_550_Article_IEq61.gif"/></alternatives></inline-formula> and <inline-formula id="IEq62"><alternatives><tex-math id="M173">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
							$\mathcal {H}_{0b}: \beta _{\textit {ir}} = -\theta $
						\end{document}</tex-math><mml:math id="M174"><mml:msub><mml:mrow><mml:mi mathvariant="script">ℋ</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn><mml:mi>b</mml:mi></mml:mrow></mml:msub><mml:mo>:</mml:mo><mml:msub><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ir</mml:mtext></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:mi>θ</mml:mi></mml:math><inline-graphic xlink:href="13059_2014_550_Article_IEq62.gif"/></alternatives></inline-formula>. The one-sided <italic>P</italic> values are generated by integrating a normal distribution centered on <italic>θ</italic> with standard deviation SE(<italic>β</italic><sub><italic>ir</italic></sub>) from <italic>β</italic><sub><italic>ir</italic></sub> toward −<italic>∞</italic>, and integrating a normal distribution centered on −<italic>θ</italic> with standard deviation SE(<italic>β</italic><sub><italic>ir</italic></sub>) from <italic>β</italic><sub><italic>ir</italic></sub> toward <italic>∞</italic>.</p>
      <p>Note that while a zero-centered prior on LFCs is consistent with testing the null hypothesis of small LFCs, it should not be used when testing the null hypothesis of large LFCs, because the prior would then favor the alternative hypothesis. <italic>DESeq2</italic> requires that no prior has been used when testing the null hypothesis of large LFCs, so that the data alone must provide evidence against the null hypothesis.</p>
    </sec>
    <sec id="Sec27">
      <title>Interactions</title>
      <p>Two exceptions to the default <italic>DESeq2</italic> LFC estimation steps are used for experimental designs with interaction terms. First, when any interaction terms are included in the design, the LFC prior width for main effect terms is not estimated from the data, but set to a wide value (<inline-formula id="IEq63"><alternatives><tex-math id="M175">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
							${\sigma ^{2}_{r}} = (\log (2))^{2} \, 1000$
						\end{document}</tex-math><mml:math id="M176"><mml:msubsup><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mo>log</mml:mo><mml:mo>(</mml:mo><mml:mn>2</mml:mn><mml:mo>)</mml:mo><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mspace width="0.3em"/><mml:mn>1000</mml:mn></mml:math><inline-graphic xlink:href="13059_2014_550_Article_IEq63.gif"/></alternatives></inline-formula>, or 1000 on the base 2 scale). This ensures that shrinkage of main effect terms will not result in false positive calls of significance for interactions. Second, when interaction terms are included and all factors have two levels, then standard design matrices are used rather than expanded model matrices, such that only a single term is used to test the null hypothesis that a combination of two effects is merely additive in the logarithmic scale.</p>
    </sec>
    <sec id="Sec28">
      <title>Regularized logarithm</title>
      <p>The rlog transformation is calculated as follows. The experimental design matrix <italic>X</italic> is substituted with a design matrix with an indicator variable for every sample in addition to an intercept column. A model as described in Equations (<xref rid="Equ1" ref-type="">1</xref>) and (<xref rid="Equ2" ref-type="">2</xref>) is fit with a zero-centered normal prior on the non-intercept terms and using the fitted dispersion values <inline-formula id="IEq64"><alternatives><tex-math id="M177">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
							$\alpha _{\text {tr}}(\bar \mu)$
						\end{document}</tex-math><mml:math id="M178"><mml:msub><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mtext>tr</mml:mtext></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mover accent="true"><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mo>¯</mml:mo></mml:mover><mml:mo>)</mml:mo></mml:math><inline-graphic xlink:href="13059_2014_550_Article_IEq64.gif"/></alternatives></inline-formula>, which capture the overall variance-mean dependence of the dataset. The true experimental design matrix <italic>X</italic> is then only used in estimating the variance-mean trend over all genes. For unsupervised analyses, for instance sample quality assessment, it is desirable that the experimental design has no influence on the transformation, and hence <italic>DESeq2</italic> by default ignores the design matrix and re-estimates the dispersions treating all samples as replicates, i.e., it uses <italic>blind</italic> dispersion estimation. The rlog-transformed values are the fitted values,
<disp-formula id="Equp"><alternatives><tex-math id="M179">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
							 $$ \text{rlog}\left(K_{ij}\right) \equiv \log_{2} q_{ij} = \beta_{i0} + \beta_{ij}, $$ 
						\end{document}</tex-math><mml:math id="M180"><mml:mrow><mml:mtext>rlog</mml:mtext><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msub><mml:mrow><mml:mi>K</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ij</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:mfenced><mml:mo>≡</mml:mo><mml:munder><mml:mrow><mml:mo>log</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:munder><mml:msub><mml:mrow><mml:mi>q</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ij</mml:mtext></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ij</mml:mtext></mml:mrow></mml:msub><mml:mo>,</mml:mo></mml:mrow></mml:math><graphic xlink:href="13059_2014_550_Article_Equp.gif" position="anchor"/></alternatives></disp-formula> where <italic>β</italic><sub><italic>ij</italic></sub> is the shrunken LFC on the base 2 scale for the <italic>j</italic>th sample. The variance of the prior is set using a similar approach as taken with differential expression, by matching a zero-centered normal distribution to observed LFCs. First a matrix of LFCs is calculated by taking the logarithm (base 2) of the normalized counts plus a pseudocount of <inline-formula id="IEq65"><alternatives><tex-math id="M181">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
							$\frac {1}{2}$
						\end{document}</tex-math><mml:math id="M182"><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:mfrac></mml:math><inline-graphic xlink:href="13059_2014_550_Article_IEq65.gif"/></alternatives></inline-formula> for each sample divided by the mean of normalized counts plus a pseudocount of <inline-formula id="IEq66"><alternatives><tex-math id="M183">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
							$\frac {1}{2}$
						\end{document}</tex-math><mml:math id="M184"><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:mfrac></mml:math><inline-graphic xlink:href="13059_2014_550_Article_IEq66.gif"/></alternatives></inline-formula>. The pseudocount of <inline-formula id="IEq67"><alternatives><tex-math id="M185">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
							$\frac {1}{2}$
						\end{document}</tex-math><mml:math id="M186"><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:mfrac></mml:math><inline-graphic xlink:href="13059_2014_550_Article_IEq67.gif"/></alternatives></inline-formula> allows for calculation of the logarithmic ratio for all genes, and has little effect on the estimate of the variance of the prior or the final rlog transformation. This matrix of LFCs then represents the common-scale logarithmic ratio of each sample to the fitted value using only an intercept. The prior variance is found by matching the 97.5% quantile of a zero-centered normal distribution to the 95% quantile of the absolute values in the LFC matrix.</p>
    </sec>
    <sec id="Sec29">
      <title>Cook’s distance for outlier detection</title>
      <p>The MLE of <inline-formula id="IEq68"><alternatives><tex-math id="M187">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
							$\vec {\beta }_{i}$
						\end{document}</tex-math><mml:math id="M188"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mo>→</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13059_2014_550_Article_IEq68.gif"/></alternatives></inline-formula> is used for calculating Cook’s distance. Considering a gene <italic>i</italic> and sample <italic>j</italic>, Cook’s distance for GLMs is given by [<xref ref-type="bibr" rid="CR59">59</xref>]:
<disp-formula id="Equq"><alternatives><tex-math id="M189">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
							 $$ D_{ij} = \frac{R_{ij}^{2}}{\tau p} \frac{h_{jj}}{(1 - h_{jj})^{2}}, $$ 
						\end{document}</tex-math><mml:math id="M190"><mml:mrow><mml:msub><mml:mrow><mml:mi>D</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ij</mml:mtext></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msubsup><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ij</mml:mtext></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:mrow><mml:mrow><mml:mi>τp</mml:mi></mml:mrow></mml:mfrac><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi>h</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">jj</mml:mtext></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi>h</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">jj</mml:mtext></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mfrac><mml:mo>,</mml:mo></mml:mrow></mml:math><graphic xlink:href="13059_2014_550_Article_Equq.gif" position="anchor"/></alternatives></disp-formula> where <italic>R</italic><sub><italic>ij</italic></sub> is the Pearson residual of sample <italic>j</italic>, <italic>τ</italic> is an overdispersion parameter (in the negative binomial GLM, <italic>τ</italic> is set to 1), <italic>p</italic> is the number of parameters including the intercept, and <italic>h</italic><sub><italic>jj</italic></sub> is the <italic>j</italic>th diagonal element of the hat matrix <italic>H</italic>:
<disp-formula id="Equr"><alternatives><tex-math id="M191">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
							 $$ H = W^{1/2} X (X^{t} W X)^{-1} X^{t} W^{1/2}. $$ 
						\end{document}</tex-math><mml:math id="M192"><mml:mrow><mml:mi>H</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mi>W</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mi>X</mml:mi><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:msup><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msup><mml:mtext mathvariant="italic">WX</mml:mtext><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:msup><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msup><mml:msup><mml:mrow><mml:mi>W</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mi>.</mml:mi></mml:mrow></mml:math><graphic xlink:href="13059_2014_550_Article_Equr.gif" position="anchor"/></alternatives></disp-formula></p>
      <p>Pearson residuals <italic>R</italic><sub><italic>ij</italic></sub> are calculated as
<disp-formula id="Equs"><alternatives><tex-math id="M193">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
							 $$ R_{ij} = \frac{(K_{ij} - \mu_{ij})}{\sqrt{V(\mu_{ij})}}, $$ 
						\end{document}</tex-math><mml:math id="M194"><mml:mrow><mml:msub><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ij</mml:mtext></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>K</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ij</mml:mtext></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ij</mml:mtext></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:msqrt><mml:mrow><mml:mi>V</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ij</mml:mtext></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow></mml:msqrt></mml:mrow></mml:mfrac><mml:mo>,</mml:mo></mml:mrow></mml:math><graphic xlink:href="13059_2014_550_Article_Equs.gif" position="anchor"/></alternatives></disp-formula> where <italic>μ</italic><sub><italic>ij</italic></sub> is estimated by the negative binomial GLM without the LFC prior, and using the variance function <italic>V</italic>(<italic>μ</italic>)=<italic>μ</italic>+<italic>α</italic><italic>μ</italic><sup>2</sup>. A method-of-moments estimate <inline-formula id="IEq69"><alternatives><tex-math id="M195">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
							$\alpha _{i}^{\text {rob}}$
						\end{document}</tex-math><mml:math id="M196"><mml:msubsup><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mtext>rob</mml:mtext></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2014_550_Article_IEq69.gif"/></alternatives></inline-formula>, using a robust estimator of variance <inline-formula id="IEq70"><alternatives><tex-math id="M197">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
							$s_{i,\text {rob}}^{2}$
						\end{document}</tex-math><mml:math id="M198"><mml:msubsup><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mtext>rob</mml:mtext></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2014_550_Article_IEq70.gif"/></alternatives></inline-formula> to provide robustness against outliers, is used here:
<disp-formula id="Equt"><alternatives><tex-math id="M199">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
							 $$\alpha_{i}^{\text{rob}} = \operatorname{max} \left(\frac{s_{i,\text{rob}}^{2} - \bar\mu_{i}}{{\bar\mu_{i}^{2}}}, 0 \right). $$ 
						\end{document}</tex-math><mml:math id="M200"><mml:mrow><mml:msubsup><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mtext>rob</mml:mtext></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mo>max</mml:mo><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mfrac><mml:mrow><mml:munderover><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mtext>rob</mml:mtext></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:munderover><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mo>¯</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:munderover><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mo>¯</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:munderover></mml:mrow></mml:mfrac><mml:mo>,</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:mfenced><mml:mi>.</mml:mi></mml:mrow></mml:math><graphic xlink:href="13059_2014_550_Article_Equt.gif" position="anchor"/></alternatives></disp-formula></p>
    </sec>
    <sec id="Sec30">
      <title>R/Bioconductor package</title>
      <p><italic>DESeq2</italic> is implemented as a package for the R statistical environment and is available [<xref ref-type="bibr" rid="CR10">10</xref>] as part of the Bioconductor project [<xref ref-type="bibr" rid="CR11">11</xref>]. The count matrix and metadata, including the gene model and sample information, are stored in an S4 class derived from the <italic>SummarizedExperiment</italic> class of the <italic>GenomicRanges</italic> package [<xref ref-type="bibr" rid="CR60">60</xref>]. <italic>SummarizedExperiment</italic> objects containing count matrices can be easily generated using the <italic>summarizeOverlaps</italic> function of the <italic>GenomicAlignments</italic> package [<xref ref-type="bibr" rid="CR61">61</xref>]. This workflow automatically stores the gene model as metadata and additionally other information such as the genome and gene annotation versions. Other methods to obtain count matrices include the <italic>htseq-count</italic> script [<xref ref-type="bibr" rid="CR62">62</xref>] and the Bioconductor packages <italic>easyRNASeq</italic> [<xref ref-type="bibr" rid="CR63">63</xref>] and <italic>featureCount</italic> [<xref ref-type="bibr" rid="CR64">64</xref>].</p>
      <p>The <italic>DESeq2</italic> package comes with a detailed vignette, which works through a number of example differential expression analyses on real datasets, and the use of the rlog transformation for quality assessment and visualization. A single function, called <italic>DESeq</italic>, is used to run the default analysis, while lower-level functions are also available for advanced users.</p>
    </sec>
    <sec id="Sec31">
      <title>Read alignment for the Bottomly <italic>et al.</italic> and Pickrell <italic>et al.</italic> datasets</title>
      <p>Reads were aligned using the TopHat2 aligner [<xref ref-type="bibr" rid="CR65">65</xref>], and assigned to genes using the <italic>summarizeOverlaps</italic> function of the <italic>GenomicRanges</italic> package [<xref ref-type="bibr" rid="CR60">60</xref>]. The sequence read archive fastq files of the Pickrell <italic>et al.</italic> [<xref ref-type="bibr" rid="CR17">17</xref>] dataset (accession number [SRA:SRP001540]) were aligned to the <italic>Homo sapiens</italic> reference sequence GRCh37 downloaded in March 2013 from Illumina iGenomes. Reads were counted in the genes defined by the Ensembl GTF file, release 70, contained in the Illumina iGenome. The sequence read archive fastq files of the Bottomly <italic>et al.</italic> [<xref ref-type="bibr" rid="CR16">16</xref>] dataset (accession number [SRA:SRP004777]) were aligned to the <italic>Mus musculus</italic> reference sequence NCBIM37 downloaded in March 2013 from Illumina iGenomes. Reads were counted in the genes defined by the Ensembl GTF file, release 66, contained in the Illumina iGenome.</p>
    </sec>
    <sec id="Sec32">
      <title>Reproducible code</title>
      <p>Sweave vignettes for reproducing all figures and tables in this paper, including data objects for the experiments mentioned, and code for aligning reads and for benchmarking, can be found in a package <italic>DESeq2paper</italic> [<xref ref-type="bibr" rid="CR66">66</xref>].</p>
    </sec>
  </sec>
</body>
<back>
  <app-group>
    <app id="App1">
      <sec id="Sec33">
        <title>Additional file</title>
        <p>
          <media position="anchor" xlink:href="13059_2014_550_MOESM1_ESM.pdf" id="MOESM1">
            <label>Additional file 1</label>
            <caption>
              <p>
                <bold>Supplementary methods, tables and figures.</bold>
              </p>
            </caption>
          </media>
        </p>
      </sec>
    </app>
  </app-group>
  <glossary>
    <title>Abbreviations</title>
    <def-list>
      <def-list>
        <def-item>
          <term>FDR</term>
          <def>
            <p>False discovery rate</p>
          </def>
        </def-item>
        <def-item>
          <term>GLM</term>
          <def>
            <p>Generalized linear model</p>
          </def>
        </def-item>
        <def-item>
          <term>HTS</term>
          <def>
            <p>High-throughput sequencing</p>
          </def>
        </def-item>
        <def-item>
          <term>LFC</term>
          <def>
            <p>Logarithmic fold change</p>
          </def>
        </def-item>
        <def-item>
          <term>MAP</term>
          <def>
            <p>Maximum <italic>a posteriori</italic></p>
          </def>
        </def-item>
        <def-item>
          <term>MLE</term>
          <def>
            <p>Maximum-likelihood estimate</p>
          </def>
        </def-item>
        <def-item>
          <term>RNA-seq</term>
          <def>
            <p>RNA sequencing</p>
          </def>
        </def-item>
        <def-item>
          <term>VST</term>
          <def>
            <p>Variance-stabilizing transformation</p>
          </def>
        </def-item>
      </def-list>
    </def-list>
  </glossary>
  <fn-group>
    <fn>
      <p>
        <bold>Competing interests</bold>
      </p>
      <p>The authors declare that they have no competing interests.</p>
    </fn>
    <fn>
      <p>
        <bold>Authors’ contributions</bold>
      </p>
      <p>All authors developed the method and wrote the manuscript. MIL implemented the method and performed the analyses. All authors read and approved the final manuscript.</p>
    </fn>
  </fn-group>
  <ack>
    <title>Acknowledgements</title>
    <p>The authors thank all users of DESeq and DESeq2 who provided valuable feedback. We thank Judith Zaugg for helpful comments on the manuscript. MIL acknowledges funding via a stipend from the International Max Planck Research School for Computational Biology and Scientific Computing and a grant from the National Institutes of Health (5T32CA009337-33). WH and SA acknowledge funding from the European Union’s 7th Framework Programme (Health) via Project <italic>Radiant</italic>. We thank an anonymous reviewer for raising the question of estimation biases in the dispersion-mean trend fitting.</p>
  </ack>
  <ref-list id="Bib1">
    <title>References</title>
    <ref id="CR1">
      <label>1</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lönnstedt</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Speed</surname>
            <given-names>T</given-names>
          </name>
        </person-group>
        <article-title>
          <bold>Replicated microarray data</bold>
        </article-title>
        <source>Stat Sinica</source>
        <year>2002</year>
        <volume>12</volume>
        <fpage>31</fpage>
        <lpage>46</lpage>
      </element-citation>
    </ref>
    <ref id="CR2">
      <label>2</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Robinson</surname>
            <given-names>MD</given-names>
          </name>
          <name>
            <surname>Smyth</surname>
            <given-names>GK</given-names>
          </name>
        </person-group>
        <article-title>
          <bold>Moderated statistical tests for assessing differences in tag abundance</bold>
        </article-title>
        <source>Bioinformatics</source>
        <year>2007</year>
        <volume>23</volume>
        <fpage>2881</fpage>
        <lpage>2887</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btm453</pub-id>
        <?supplied-pmid 17881408?>
        <pub-id pub-id-type="pmid">17881408</pub-id>
      </element-citation>
    </ref>
    <ref id="CR3">
      <label>3</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>McCarthy</surname>
            <given-names>DJ</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Smyth</surname>
            <given-names>GK</given-names>
          </name>
        </person-group>
        <article-title>
          <bold>Differential expression analysis of multifactor RNA-seq experiments with respect to biological variation</bold>
        </article-title>
        <source>Nucleic Acids Res</source>
        <year>2012</year>
        <volume>40</volume>
        <fpage>4288</fpage>
        <lpage>4297</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/gks042</pub-id>
        <?supplied-pmid 22287627?>
        <pub-id pub-id-type="pmid">22287627</pub-id>
      </element-citation>
    </ref>
    <ref id="CR4">
      <label>4</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Anders</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Huber</surname>
            <given-names>W</given-names>
          </name>
        </person-group>
        <article-title>
          <bold>Differential expression analysis for sequence count data</bold>
        </article-title>
        <source>Genome Biol</source>
        <year>2010</year>
        <volume>11</volume>
        <fpage>106</fpage>
        <pub-id pub-id-type="doi">10.1186/gb-2010-11-10-r106</pub-id>
        <pub-id pub-id-type="pmid">20236492</pub-id>
      </element-citation>
    </ref>
    <ref id="CR5">
      <label>5</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zhou</surname>
            <given-names>Y-H</given-names>
          </name>
          <name>
            <surname>Xia</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Wright</surname>
            <given-names>FA</given-names>
          </name>
        </person-group>
        <article-title>
          <bold>A powerful and flexible approach to the analysis of RNA sequence count data</bold>
        </article-title>
        <source>Bioinformatics</source>
        <year>2011</year>
        <volume>27</volume>
        <fpage>2672</fpage>
        <lpage>2678</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btr449</pub-id>
        <?supplied-pmid 21810900?>
        <pub-id pub-id-type="pmid">21810900</pub-id>
      </element-citation>
    </ref>
    <ref id="CR6">
      <label>6</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wu</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Wu</surname>
            <given-names>Z</given-names>
          </name>
        </person-group>
        <article-title>
          <bold>A new shrinkage estimator for dispersion improves differential expression detection in RNA-seq data</bold>
        </article-title>
        <source>Biostatistics</source>
        <year>2013</year>
        <volume>14</volume>
        <fpage>232</fpage>
        <lpage>243</lpage>
        <pub-id pub-id-type="doi">10.1093/biostatistics/kxs033</pub-id>
        <?supplied-pmid 23001152?>
        <pub-id pub-id-type="pmid">23001152</pub-id>
      </element-citation>
    </ref>
    <ref id="CR7">
      <label>7</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hardcastle</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Kelly</surname>
            <given-names>K</given-names>
          </name>
        </person-group>
        <article-title>
          <bold>baySeq: empirical Bayesian methods for identifying differential expression in sequence count data</bold>
        </article-title>
        <source>BMC Bioinformatics</source>
        <year>2010</year>
        <volume>11</volume>
        <fpage>422</fpage>
        <pub-id pub-id-type="doi">10.1186/1471-2105-11-422</pub-id>
        <?supplied-pmid 20698981?>
        <pub-id pub-id-type="pmid">20698981</pub-id>
      </element-citation>
    </ref>
    <ref id="CR8">
      <label>8</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Van De Wiel</surname>
            <given-names>MA</given-names>
          </name>
          <name>
            <surname>Leday</surname>
            <given-names>GGR</given-names>
          </name>
          <name>
            <surname>Pardo</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Rue</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Van Der Vaart</surname>
            <given-names>AW</given-names>
          </name>
          <name>
            <surname>Van Wieringen</surname>
            <given-names>WN</given-names>
          </name>
        </person-group>
        <article-title>
          <bold>Bayesian analysis of RNA sequencing data by estimating multiple shrinkage priors</bold>
        </article-title>
        <source>Biostatistics</source>
        <year>2013</year>
        <volume>14</volume>
        <fpage>113</fpage>
        <lpage>128</lpage>
        <pub-id pub-id-type="doi">10.1093/biostatistics/kxs031</pub-id>
        <?supplied-pmid 22988280?>
        <pub-id pub-id-type="pmid">22988280</pub-id>
      </element-citation>
    </ref>
    <ref id="CR9">
      <label>9</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Boer</surname>
            <given-names>JM</given-names>
          </name>
          <name>
            <surname>Huber</surname>
            <given-names>WK</given-names>
          </name>
          <name>
            <surname>Sültmann</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Wilmer</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>von Heydebreck</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Haas</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Korn</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Gunawan</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Vente</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Füzesi</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Vingron</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Poustka</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>
          <bold>Identification and classification of differentially expressed genes in renal cell carcinoma by expression profiling on a global human 31,500-element cDNA array</bold>
        </article-title>
        <source>Genome Res</source>
        <year>2001</year>
        <volume>11</volume>
        <fpage>1861</fpage>
        <lpage>1870</lpage>
        <?supplied-pmid 11691851?>
        <pub-id pub-id-type="pmid">11691851</pub-id>
      </element-citation>
    </ref>
    <ref id="CR10">
      <label>10</label>
      <mixed-citation publication-type="other"><bold>DESeq2</bold>. [http://www.bioconductor.org/packages/release/bioc/html/DESeq2.html]</mixed-citation>
    </ref>
    <ref id="CR11">
      <label>11</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Gentleman</surname>
            <given-names>RC</given-names>
          </name>
          <name>
            <surname>Carey</surname>
            <given-names>VJ</given-names>
          </name>
          <name>
            <surname>Bates</surname>
            <given-names>DM</given-names>
          </name>
          <name>
            <surname>Bolstad</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Dettling</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Dudoit</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Ellis</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Gautier</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Ge</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Gentry</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Hornik</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Hothorn</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Huber</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Iacus</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Irizarry</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Leisch</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Maechler</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Rossini</surname>
            <given-names>AJ</given-names>
          </name>
          <name>
            <surname>Sawitzki</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Smith</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Smyth</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Tierney</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Yang</surname>
            <given-names>JY</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>
          <bold>Bioconductor: open software development for computational biology and bioinformatics</bold>
        </article-title>
        <source>Genome Biol</source>
        <year>2004</year>
        <volume>5</volume>
        <fpage>R80</fpage>
        <pub-id pub-id-type="doi">10.1186/gb-2004-5-10-r80</pub-id>
        <?supplied-pmid 15461798?>
        <pub-id pub-id-type="pmid">15461798</pub-id>
      </element-citation>
    </ref>
    <ref id="CR12">
      <label>12</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>McCullagh</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Nelder</surname>
            <given-names>JA</given-names>
          </name>
        </person-group>
        <article-title>
          <bold>Generalized linear models</bold>
        </article-title>
        <source>
          <italic>Monographs on Statistics &amp; Applied Probability</italic>
        </source>
        <year>1989</year>
        <publisher-loc>London, UK</publisher-loc>
        <publisher-name>Chapman &amp; Hall/CRC</publisher-name>
      </element-citation>
    </ref>
    <ref id="CR13">
      <label>13</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hansen</surname>
            <given-names>KD</given-names>
          </name>
          <name>
            <surname>Irizarry</surname>
            <given-names>RA</given-names>
          </name>
          <name>
            <surname>Wu</surname>
            <given-names>Z</given-names>
          </name>
        </person-group>
        <article-title>
          <bold>Removing technical variability in RNA-seq data using conditional quantile normalization</bold>
        </article-title>
        <source>Biostatistics</source>
        <year>2012</year>
        <volume>13</volume>
        <fpage>204</fpage>
        <lpage>216</lpage>
        <pub-id pub-id-type="doi">10.1093/biostatistics/kxr054</pub-id>
        <?supplied-pmid 22285995?>
        <pub-id pub-id-type="pmid">22285995</pub-id>
      </element-citation>
    </ref>
    <ref id="CR14">
      <label>14</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Risso</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Schwartz</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Sherlock</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Dudoit</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>
          <bold>GC-content normalization for RNA-seq data</bold>
        </article-title>
        <source>BMC Bioinformatics</source>
        <year>2011</year>
        <volume>12</volume>
        <fpage>480</fpage>
        <pub-id pub-id-type="doi">10.1186/1471-2105-12-480</pub-id>
        <?supplied-pmid 22177264?>
        <pub-id pub-id-type="pmid">22177264</pub-id>
      </element-citation>
    </ref>
    <ref id="CR15">
      <label>15</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Smyth</surname>
            <given-names>GK</given-names>
          </name>
        </person-group>
        <article-title>
          <bold>Linear models and empirical Bayes methods for assessing differential expression in microarray experiments</bold>
        </article-title>
        <source>Stat Appl Genet Mol Biol</source>
        <year>2004</year>
        <volume>3</volume>
        <fpage>1</fpage>
        <lpage>25</lpage>
      </element-citation>
    </ref>
    <ref id="CR16">
      <label>16</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bottomly</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Walter</surname>
            <given-names>NAR</given-names>
          </name>
          <name>
            <surname>Hunter</surname>
            <given-names>JE</given-names>
          </name>
          <name>
            <surname>Darakjian</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Kawane</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Buck</surname>
            <given-names>KJ</given-names>
          </name>
          <name>
            <surname>Searles</surname>
            <given-names>RP</given-names>
          </name>
          <name>
            <surname>Mooney</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>McWeeney</surname>
            <given-names>SK</given-names>
          </name>
          <name>
            <surname>Hitzemann</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>
          <bold>Evaluating gene expression in C57BL/6J and DBA/2J mouse striatum using RNA-seq and microarrays</bold>
        </article-title>
        <source>PLoS ONE</source>
        <year>2011</year>
        <volume>6</volume>
        <fpage>17820</fpage>
        <pub-id pub-id-type="doi">10.1371/journal.pone.0017820</pub-id>
      </element-citation>
    </ref>
    <ref id="CR17">
      <label>17</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Pickrell</surname>
            <given-names>JK</given-names>
          </name>
          <name>
            <surname>Marioni</surname>
            <given-names>JC</given-names>
          </name>
          <name>
            <surname>Pai</surname>
            <given-names>AA</given-names>
          </name>
          <name>
            <surname>Degner</surname>
            <given-names>JF</given-names>
          </name>
          <name>
            <surname>Engelhardt</surname>
            <given-names>BE</given-names>
          </name>
          <name>
            <surname>Nkadori</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Veyrieras</surname>
            <given-names>J-B</given-names>
          </name>
          <name>
            <surname>Stephens</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Gilad</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Pritchard</surname>
            <given-names>JK</given-names>
          </name>
        </person-group>
        <article-title>
          <bold>Understanding mechanisms underlying human gene expression variation with RNA sequencing</bold>
        </article-title>
        <source>Nature</source>
        <year>2010</year>
        <volume>464</volume>
        <fpage>768</fpage>
        <lpage>772</lpage>
        <pub-id pub-id-type="doi">10.1038/nature08872</pub-id>
        <?supplied-pmid 20220758?>
        <pub-id pub-id-type="pmid">20220758</pub-id>
      </element-citation>
    </ref>
    <ref id="CR18">
      <label>18</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Hastie</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Tibshirani</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Friedman</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <source>
          <italic>The Elements of Statistical Learning: Data Mining, Inference, and Prediction</italic>
        </source>
        <year>2009</year>
        <publisher-loc>New York City, USA</publisher-loc>
        <publisher-name>Springer</publisher-name>
      </element-citation>
    </ref>
    <ref id="CR19">
      <label>19</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bi</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Davuluri</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>
          <bold>NPEBseq: nonparametric empirical Bayesian-based procedure for differential expression analysis of RNA-seq data</bold>
        </article-title>
        <source>BMC Bioinformatics</source>
        <year>2013</year>
        <volume>14</volume>
        <fpage>262</fpage>
        <pub-id pub-id-type="doi">10.1186/1471-2105-14-262</pub-id>
        <?supplied-pmid 23981227?>
        <pub-id pub-id-type="pmid">23981227</pub-id>
      </element-citation>
    </ref>
    <ref id="CR20">
      <label>20</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Feng</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Meyer</surname>
            <given-names>CA</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>Q</given-names>
          </name>
          <name>
            <surname>Liu</surname>
            <given-names>JS</given-names>
          </name>
          <name>
            <surname>Liu</surname>
            <given-names>XS</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>Y</given-names>
          </name>
        </person-group>
        <article-title>
          <bold>GFOLD: a generalized fold change for ranking differentially expressed genes from RNA-seq data</bold>
        </article-title>
        <source>Bioinformatics</source>
        <year>2012</year>
        <volume>28</volume>
        <fpage>2782</fpage>
        <lpage>2788</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/bts515</pub-id>
        <?supplied-pmid 22923299?>
        <pub-id pub-id-type="pmid">22923299</pub-id>
      </element-citation>
    </ref>
    <ref id="CR21">
      <label>21</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Benjamini</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Hochberg</surname>
            <given-names>Y</given-names>
          </name>
        </person-group>
        <article-title>
          <bold>Controlling the false discovery rate: a practical and powerful approach to multiple testing</bold>
        </article-title>
        <source>J R Stat Soc Ser B Methodol</source>
        <year>1995</year>
        <volume>57</volume>
        <fpage>289</fpage>
        <lpage>300</lpage>
      </element-citation>
    </ref>
    <ref id="CR22">
      <label>22</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bourgon</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Gentleman</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Huber</surname>
            <given-names>W</given-names>
          </name>
        </person-group>
        <article-title>
          <bold>Independent filtering increases detection power for high-throughput experiments</bold>
        </article-title>
        <source>Proc Natl Acad Sci USA</source>
        <year>2010</year>
        <volume>107</volume>
        <fpage>9546</fpage>
        <lpage>9551</lpage>
        <pub-id pub-id-type="doi">10.1073/pnas.0914005107</pub-id>
        <?supplied-pmid 20460310?>
        <pub-id pub-id-type="pmid">20460310</pub-id>
      </element-citation>
    </ref>
    <ref id="CR23">
      <label>23</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>McCarthy</surname>
            <given-names>DJ</given-names>
          </name>
          <name>
            <surname>Smyth</surname>
            <given-names>GK</given-names>
          </name>
        </person-group>
        <article-title>
          <bold>Testing significance relative to a fold-change threshold is a TREAT</bold>
        </article-title>
        <source>Bioinformatics</source>
        <year>2009</year>
        <volume>25</volume>
        <fpage>765</fpage>
        <lpage>771</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btp053</pub-id>
        <?supplied-pmid 19176553?>
        <pub-id pub-id-type="pmid">19176553</pub-id>
      </element-citation>
    </ref>
    <ref id="CR24">
      <label>24</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Li</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Tibshirani</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>
          <bold>Finding consistent patterns: a nonparametric approach for identifying differential expression in RNA-seq data</bold>
        </article-title>
        <source>Stat Methods Med Res</source>
        <year>2013</year>
        <volume>22</volume>
        <fpage>519</fpage>
        <lpage>536</lpage>
        <pub-id pub-id-type="doi">10.1177/0962280211428386</pub-id>
        <?supplied-pmid 22127579?>
        <pub-id pub-id-type="pmid">22127579</pub-id>
      </element-citation>
    </ref>
    <ref id="CR25">
      <label>25</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Cook</surname>
            <given-names>RD</given-names>
          </name>
        </person-group>
        <article-title>
          <bold>Detection of influential observation in linear regression</bold>
        </article-title>
        <source>Technometrics</source>
        <year>1977</year>
        <volume>19</volume>
        <fpage>15</fpage>
        <lpage>18</lpage>
        <pub-id pub-id-type="doi">10.2307/1268249</pub-id>
      </element-citation>
    </ref>
    <ref id="CR26">
      <label>26</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hammer</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Banck</surname>
            <given-names>MS</given-names>
          </name>
          <name>
            <surname>Amberg</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Petznick</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Luo</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Khrebtukova</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Schroth</surname>
            <given-names>GP</given-names>
          </name>
          <name>
            <surname>Beyerlein</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Beutler</surname>
            <given-names>AS</given-names>
          </name>
        </person-group>
        <article-title>
          <bold>mRNA-seq with agnostic splice site discovery for nervous system transcriptomics tested in chronic pain</bold>
        </article-title>
        <source>Genome Res</source>
        <year>2010</year>
        <volume>20</volume>
        <fpage>847</fpage>
        <lpage>860</lpage>
        <pub-id pub-id-type="doi">10.1101/gr.101204.109</pub-id>
        <?supplied-pmid 20452967?>
        <pub-id pub-id-type="pmid">20452967</pub-id>
      </element-citation>
    </ref>
    <ref id="CR27">
      <label>27</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Frazee</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Langmead</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Leek</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>
          <bold>ReCount: a multi-experiment resource of analysis-ready RNA-seq gene count datasets</bold>
        </article-title>
        <source>BMC Bioinformatics</source>
        <year>2011</year>
        <volume>12</volume>
        <fpage>449</fpage>
        <pub-id pub-id-type="doi">10.1186/1471-2105-12-449</pub-id>
        <?supplied-pmid 22087737?>
        <pub-id pub-id-type="pmid">22087737</pub-id>
      </element-citation>
    </ref>
    <ref id="CR28">
      <label>28</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Trapnell</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Hendrickson</surname>
            <given-names>DG</given-names>
          </name>
          <name>
            <surname>Sauvageau</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Goff</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Rinn</surname>
            <given-names>JL</given-names>
          </name>
          <name>
            <surname>Pachter</surname>
            <given-names>L</given-names>
          </name>
        </person-group>
        <article-title>
          <bold>Differential analysis of gene regulation at transcript resolution with RNA-seq</bold>
        </article-title>
        <source>Nat Biotechnol</source>
        <year>2012</year>
        <volume>31</volume>
        <fpage>46</fpage>
        <lpage>53</lpage>
        <pub-id pub-id-type="doi">10.1038/nbt.2450</pub-id>
        <?supplied-pmid 23222703?>
        <pub-id pub-id-type="pmid">23222703</pub-id>
      </element-citation>
    </ref>
    <ref id="CR29">
      <label>29</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Glaus</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Honkela</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Rattray</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>
          <bold>Identifying differentially expressed transcripts from RNA-seq data with biological variation</bold>
        </article-title>
        <source>Bioinformatics</source>
        <year>2012</year>
        <volume>28</volume>
        <fpage>1721</fpage>
        <lpage>1728</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/bts260</pub-id>
        <?supplied-pmid 22563066?>
        <pub-id pub-id-type="pmid">22563066</pub-id>
      </element-citation>
    </ref>
    <ref id="CR30">
      <label>30</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Anders</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Reyes</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Huber</surname>
            <given-names>W</given-names>
          </name>
        </person-group>
        <article-title>
          <bold>Detecting differential usage of exons from RNA-seq data</bold>
        </article-title>
        <source>Genome Res</source>
        <year>2012</year>
        <volume>22</volume>
        <fpage>2008</fpage>
        <lpage>2017</lpage>
        <pub-id pub-id-type="doi">10.1101/gr.133744.111</pub-id>
        <?supplied-pmid 22722343?>
        <pub-id pub-id-type="pmid">22722343</pub-id>
      </element-citation>
    </ref>
    <ref id="CR31">
      <label>31</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Sammeth</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>
          <bold>Complete alternative splicing events are bubbles in splicing graphs</bold>
        </article-title>
        <source>J Comput Biol</source>
        <year>2009</year>
        <volume>16</volume>
        <fpage>1117</fpage>
        <lpage>1140</lpage>
        <pub-id pub-id-type="doi">10.1089/cmb.2009.0108</pub-id>
        <?supplied-pmid 19689216?>
        <pub-id pub-id-type="pmid">19689216</pub-id>
      </element-citation>
    </ref>
    <ref id="CR32">
      <label>32</label>
      <mixed-citation publication-type="other">Pagès H, Bindreither D, Carlson M, Morgan M: <bold>SplicingGraphs: create, manipulate, visualize splicing graphs, and assign RNA-seq reads to them</bold>2013. Bioconductor package [http://www.bioconductor.org]</mixed-citation>
    </ref>
    <ref id="CR33">
      <label>33</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Robinson</surname>
            <given-names>MD</given-names>
          </name>
          <name>
            <surname>McCarthy</surname>
            <given-names>DJ</given-names>
          </name>
          <name>
            <surname>Smyth</surname>
            <given-names>GK</given-names>
          </name>
        </person-group>
        <article-title>
          <bold>edgeR: a Bioconductor package for differential expression analysis of digital gene expression data</bold>
        </article-title>
        <source>Bioinformatics</source>
        <year>2009</year>
        <volume>26</volume>
        <fpage>139</fpage>
        <lpage>140</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btp616</pub-id>
        <?supplied-pmid 19910308?>
        <pub-id pub-id-type="pmid">19910308</pub-id>
      </element-citation>
    </ref>
    <ref id="CR34">
      <label>34</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zhou</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Lindsay</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Robinson</surname>
            <given-names>MD</given-names>
          </name>
        </person-group>
        <article-title>
          <bold>Robustly detecting differential expression in RNA sequencing data using observation weights</bold>
        </article-title>
        <source>Nucleic Acids Res</source>
        <year>2014</year>
        <volume>42</volume>
        <fpage>e91</fpage>
        <pub-id pub-id-type="doi">10.1093/nar/gku310</pub-id>
        <?supplied-pmid 24753412?>
        <pub-id pub-id-type="pmid">24753412</pub-id>
      </element-citation>
    </ref>
    <ref id="CR35">
      <label>35</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Leng</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Dawson</surname>
            <given-names>JA</given-names>
          </name>
          <name>
            <surname>Thomson</surname>
            <given-names>JA</given-names>
          </name>
          <name>
            <surname>Ruotti</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Rissman</surname>
            <given-names>AI</given-names>
          </name>
          <name>
            <surname>Smits</surname>
            <given-names>BMG</given-names>
          </name>
          <name>
            <surname>Haag</surname>
            <given-names>JD</given-names>
          </name>
          <name>
            <surname>Gould</surname>
            <given-names>MN</given-names>
          </name>
          <name>
            <surname>Stewart</surname>
            <given-names>RM</given-names>
          </name>
          <name>
            <surname>Kendziorski</surname>
            <given-names>C</given-names>
          </name>
        </person-group>
        <article-title>
          <bold>EBSeq: an empirical Bayes hierarchical model for inference in RNA-seq experiments</bold>
        </article-title>
        <source>Bioinformatics</source>
        <year>2013</year>
        <volume>29</volume>
        <fpage>1035</fpage>
        <lpage>1043</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btt087</pub-id>
        <?supplied-pmid 23428641?>
        <pub-id pub-id-type="pmid">23428641</pub-id>
      </element-citation>
    </ref>
    <ref id="CR36">
      <label>36</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Law</surname>
            <given-names>CW</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Shi</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Smyth</surname>
            <given-names>GK</given-names>
          </name>
        </person-group>
        <article-title>
          <bold>Voom: precision weights unlock linear model analysis tools for RNA-seq read counts</bold>
        </article-title>
        <source>Genome Biol</source>
        <year>2014</year>
        <volume>15</volume>
        <fpage>29</fpage>
        <pub-id pub-id-type="doi">10.1186/gb-2014-15-2-r29</pub-id>
      </element-citation>
    </ref>
    <ref id="CR37">
      <label>37</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hubert</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Arabie</surname>
            <given-names>P</given-names>
          </name>
        </person-group>
        <article-title>
          <bold>Comparing partitions</bold>
        </article-title>
        <source>J Classif</source>
        <year>1985</year>
        <volume>2</volume>
        <fpage>193</fpage>
        <lpage>218</lpage>
        <pub-id pub-id-type="doi">10.1007/BF01908075</pub-id>
      </element-citation>
    </ref>
    <ref id="CR38">
      <label>38</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Witten</surname>
            <given-names>DM</given-names>
          </name>
        </person-group>
        <article-title>
          <bold>Classification and clustering of sequencing data using a Poisson model</bold>
        </article-title>
        <source>Ann Appl Stat</source>
        <year>2011</year>
        <volume>5</volume>
        <fpage>2493</fpage>
        <lpage>2518</lpage>
        <pub-id pub-id-type="doi">10.1214/11-AOAS493</pub-id>
      </element-citation>
    </ref>
    <ref id="CR39">
      <label>39</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Irizarry</surname>
            <given-names>RA</given-names>
          </name>
          <name>
            <surname>Wu</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Jaffee</surname>
            <given-names>HA</given-names>
          </name>
        </person-group>
        <article-title>
          <bold>Comparison of affymetrix GeneChip expression measures</bold>
        </article-title>
        <source>Bioinformatics</source>
        <year>2006</year>
        <volume>22</volume>
        <fpage>789</fpage>
        <lpage>794</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btk046</pub-id>
        <?supplied-pmid 16410320?>
        <pub-id pub-id-type="pmid">16410320</pub-id>
      </element-citation>
    </ref>
    <ref id="CR40">
      <label>40</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Asangani</surname>
            <given-names>IA</given-names>
          </name>
          <name>
            <surname>Dommeti</surname>
            <given-names>VL</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Malik</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Cieslik</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Yang</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Escara-Wilke</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Wilder-Romans</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Dhanireddy</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Engelke</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Iyer</surname>
            <given-names>MK</given-names>
          </name>
          <name>
            <surname>Jing</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Wu</surname>
            <given-names>Y-M</given-names>
          </name>
          <name>
            <surname>Cao</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Qin</surname>
            <given-names>ZS</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Feng</surname>
            <given-names>FY</given-names>
          </name>
          <name>
            <surname>Chinnaiyan</surname>
            <given-names>AM</given-names>
          </name>
        </person-group>
        <article-title>
          <bold>Therapeutic targeting of BET bromodomain proteins in castration-resistant prostate cancer</bold>
        </article-title>
        <source>Nature</source>
        <year>2014</year>
        <volume>510</volume>
        <fpage>278</fpage>
        <lpage>282</lpage>
        <pub-id pub-id-type="doi">10.1038/nature13229</pub-id>
        <?supplied-pmid 24759320?>
        <pub-id pub-id-type="pmid">24759320</pub-id>
      </element-citation>
    </ref>
    <ref id="CR41">
      <label>41</label>
      <mixed-citation publication-type="other">Stark R, Brown G: <bold>DiffBind: differential binding analysis of ChIP-seq peak data</bold>2013. Bioconductor package [http://www.bioconductor.org]</mixed-citation>
    </ref>
    <ref id="CR42">
      <label>42</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ross-Innes</surname>
            <given-names>CS</given-names>
          </name>
          <name>
            <surname>Stark</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Teschendorff</surname>
            <given-names>AE</given-names>
          </name>
          <name>
            <surname>Holmes</surname>
            <given-names>KA</given-names>
          </name>
          <name>
            <surname>Ali</surname>
            <given-names>HR</given-names>
          </name>
          <name>
            <surname>Dunning</surname>
            <given-names>MJ</given-names>
          </name>
          <name>
            <surname>Brown</surname>
            <given-names>GD</given-names>
          </name>
          <name>
            <surname>Gojis</surname>
            <given-names>O</given-names>
          </name>
          <name>
            <surname>Ellis</surname>
            <given-names>IO</given-names>
          </name>
          <name>
            <surname>Green</surname>
            <given-names>AR</given-names>
          </name>
          <name>
            <surname>Ali</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Chin</surname>
            <given-names>S-F</given-names>
          </name>
          <name>
            <surname>Palmieri</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Caldas</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Carroll</surname>
            <given-names>JS</given-names>
          </name>
        </person-group>
        <article-title>
          <bold>Differential oestrogen receptor binding is associated with clinical outcome in breast cancer</bold>
        </article-title>
        <source>Nature</source>
        <year>2012</year>
        <volume>481</volume>
        <fpage>389</fpage>
        <lpage>393</lpage>
        <?supplied-pmid 22217937?>
        <pub-id pub-id-type="pmid">22217937</pub-id>
      </element-citation>
    </ref>
    <ref id="CR43">
      <label>43</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Robinson</surname>
            <given-names>DG</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Storey</surname>
            <given-names>JD</given-names>
          </name>
          <name>
            <surname>Gresham</surname>
            <given-names>D</given-names>
          </name>
        </person-group>
        <article-title>
          <bold>Design and analysis of bar-seq experiments</bold>
        </article-title>
        <source>G3 (Bethesda)</source>
        <year>2013</year>
        <volume>4</volume>
        <fpage>11</fpage>
        <lpage>18</lpage>
        <pub-id pub-id-type="doi">10.1534/g3.113.008565</pub-id>
        <pub-id pub-id-type="pmid">24192834</pub-id>
      </element-citation>
    </ref>
    <ref id="CR44">
      <label>44</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>McMurdie</surname>
            <given-names>PJ</given-names>
          </name>
          <name>
            <surname>Holmes</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>
          <bold>Waste not, want not: why rarefying microbiome data is inadmissible</bold>
        </article-title>
        <source>PLoS Comput Biol</source>
        <year>2014</year>
        <volume>10</volume>
        <fpage>1003531</fpage>
        <pub-id pub-id-type="doi">10.1371/journal.pcbi.1003531</pub-id>
      </element-citation>
    </ref>
    <ref id="CR45">
      <label>45</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Vasquez</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Hon</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Vanselow</surname>
            <given-names>JT</given-names>
          </name>
          <name>
            <surname>Schlosser</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Siegel</surname>
            <given-names>TN</given-names>
          </name>
        </person-group>
        <article-title>
          <bold>Comparative ribosome profiling reveals extensive translational complexity in different Trypanosoma brucei life cycle stages</bold>
        </article-title>
        <source>Nucleic Acids Res</source>
        <year>2014</year>
        <volume>42</volume>
        <fpage>3623</fpage>
        <lpage>3637</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/gkt1386</pub-id>
        <?supplied-pmid 24442674?>
        <pub-id pub-id-type="pmid">24442674</pub-id>
      </element-citation>
    </ref>
    <ref id="CR46">
      <label>46</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zhou</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Zhu</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Cai</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Yuan</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Huang</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Wei</surname>
            <given-names>W</given-names>
          </name>
        </person-group>
        <article-title>
          <bold>High-throughput screening of a CRISPR/Cas9 library for functional genomics in human cells</bold>
        </article-title>
        <source>Nature</source>
        <year>2014</year>
        <volume>509</volume>
        <fpage>487</fpage>
        <lpage>491</lpage>
        <pub-id pub-id-type="doi">10.1038/nature13166</pub-id>
        <?supplied-pmid 24717434?>
        <pub-id pub-id-type="pmid">24717434</pub-id>
      </element-citation>
    </ref>
    <ref id="CR47">
      <label>47</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Cox</surname>
            <given-names>DR</given-names>
          </name>
          <name>
            <surname>Reid</surname>
            <given-names>N</given-names>
          </name>
        </person-group>
        <article-title>
          <bold>Parameter orthogonality and approximate conditional inference</bold>
        </article-title>
        <source>J R Stat Soc Ser B Methodol</source>
        <year>1987</year>
        <volume>49</volume>
        <fpage>1</fpage>
        <lpage>39</lpage>
      </element-citation>
    </ref>
    <ref id="CR48">
      <label>48</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Robinson</surname>
            <given-names>MD</given-names>
          </name>
          <name>
            <surname>Smyth</surname>
            <given-names>GK</given-names>
          </name>
        </person-group>
        <article-title>
          <bold>Small-sample estimation of negative binomial dispersion, with applications to SAGE data</bold>
        </article-title>
        <source>Biostatistics</source>
        <year>2007</year>
        <volume>9</volume>
        <fpage>321</fpage>
        <lpage>332</lpage>
        <pub-id pub-id-type="doi">10.1093/biostatistics/kxm030</pub-id>
        <?supplied-pmid 17728317?>
        <pub-id pub-id-type="pmid">17728317</pub-id>
      </element-citation>
    </ref>
    <ref id="CR49">
      <label>49</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Pawitan</surname>
            <given-names>Y</given-names>
          </name>
        </person-group>
        <source>
          <italic>In All Likelihood: Statistical Modelling and Inference Using Likelihood</italic>
        </source>
        <year>2001</year>
        <publisher-loc>New York City, USA</publisher-loc>
        <publisher-name>Oxford University Press</publisher-name>
      </element-citation>
    </ref>
    <ref id="CR50">
      <label>50</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Armijo</surname>
            <given-names>L</given-names>
          </name>
        </person-group>
        <article-title>
          <bold>Minimization of functions having Lipschitz continuous first partial derivatives</bold>
        </article-title>
        <source>Pac J Math</source>
        <year>1966</year>
        <volume>16</volume>
        <fpage>1</fpage>
        <lpage>3</lpage>
        <pub-id pub-id-type="doi">10.2140/pjm.1966.16.1</pub-id>
      </element-citation>
    </ref>
    <ref id="CR51">
      <label>51</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Di</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Schafer</surname>
            <given-names>DW</given-names>
          </name>
          <name>
            <surname>Cumbie</surname>
            <given-names>JS</given-names>
          </name>
          <name>
            <surname>Chang</surname>
            <given-names>JH</given-names>
          </name>
        </person-group>
        <article-title>
          <bold>The NBP negative binomial model for assessing differential gene expression from RNA-seq</bold>
        </article-title>
        <source>Stat Appl Genet Mol Biol</source>
        <year>2011</year>
        <volume>10</volume>
        <fpage>1</fpage>
        <lpage>28</lpage>
      </element-citation>
    </ref>
    <ref id="CR52">
      <label>52</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Abramowitz</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Stegun</surname>
            <given-names>I</given-names>
          </name>
        </person-group>
        <source>
          <italic>Handbook of Mathematical Functions</italic>
        </source>
        <year>1965</year>
        <publisher-loc>New York, USA</publisher-loc>
        <publisher-name>Dover Publications</publisher-name>
      </element-citation>
    </ref>
    <ref id="CR53">
      <label>53</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Newton</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Kendziorski</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Richmond</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Blattner</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Tsui</surname>
            <given-names>K</given-names>
          </name>
        </person-group>
        <article-title>
          <bold>On differential variability of expression ratios: improving statistical inference about gene expression changes from microarray data</bold>
        </article-title>
        <source>J Comput Biol</source>
        <year>2001</year>
        <volume>8</volume>
        <fpage>37</fpage>
        <lpage>52</lpage>
        <pub-id pub-id-type="doi">10.1089/106652701300099074</pub-id>
        <?supplied-pmid 11339905?>
        <pub-id pub-id-type="pmid">11339905</pub-id>
      </element-citation>
    </ref>
    <ref id="CR54">
      <label>54</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Huber</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>von Heydebreck</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Sultmann</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Poustka</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Vingron</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>
          <bold>Variance stabilization applied to microarray data calibration and to the quantification of differential expression</bold>
        </article-title>
        <source>Bioinformatics</source>
        <year>2002</year>
        <volume>18</volume>
        <fpage>96</fpage>
        <lpage>104</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/18.suppl_1.S96</pub-id>
      </element-citation>
    </ref>
    <ref id="CR55">
      <label>55</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Durbin</surname>
            <given-names>BP</given-names>
          </name>
          <name>
            <surname>Hardin</surname>
            <given-names>JS</given-names>
          </name>
          <name>
            <surname>Hawkins</surname>
            <given-names>DM</given-names>
          </name>
          <name>
            <surname>Rocke</surname>
            <given-names>DM</given-names>
          </name>
        </person-group>
        <article-title>
          <bold>A variance-stabilizing transformation for gene-expression microarray data</bold>
        </article-title>
        <source>Bioinformatics</source>
        <year>2002</year>
        <volume>18</volume>
        <fpage>105</fpage>
        <lpage>110</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/18.suppl_1.S105</pub-id>
      </element-citation>
    </ref>
    <ref id="CR56">
      <label>56</label>
      <mixed-citation publication-type="other">Park MY: <bold>Generalized linear models with regularization</bold>. <italic>PhD thesis.</italic>Stanford University, Department of Statistics; 2006.</mixed-citation>
    </ref>
    <ref id="CR57">
      <label>57</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Friedman</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Hastie</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Tibshirani</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>
          <bold>Regularization paths for generalized linear models via coordinate descent</bold>
        </article-title>
        <source>J Stat Softw</source>
        <year>2010</year>
        <volume>33</volume>
        <fpage>1</fpage>
        <lpage>22</lpage>
        <?supplied-pmid 20808728?>
        <pub-id pub-id-type="pmid">20808728</pub-id>
      </element-citation>
    </ref>
    <ref id="CR58">
      <label>58</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Cule</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Vineis</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>De Iorio</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>
          <bold>Significance testing in ridge regression for genetic data</bold>
        </article-title>
        <source>BMC Bioinformatics</source>
        <year>2011</year>
        <volume>12</volume>
        <fpage>372</fpage>
        <pub-id pub-id-type="doi">10.1186/1471-2105-12-372</pub-id>
        <?supplied-pmid 21929786?>
        <pub-id pub-id-type="pmid">21929786</pub-id>
      </element-citation>
    </ref>
    <ref id="CR59">
      <label>59</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Cook</surname>
            <given-names>RD</given-names>
          </name>
          <name>
            <surname>Weisberg</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <source>
          <italic>Residuals and Influence in Regression</italic>
        </source>
        <year>1982</year>
        <publisher-loc>New York, USA</publisher-loc>
        <publisher-name>Chapman and Hall/CRC</publisher-name>
      </element-citation>
    </ref>
    <ref id="CR60">
      <label>60</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lawrence</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Huber</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Pagès</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Aboyoun</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Carlson</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Gentleman</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Morgan</surname>
            <given-names>MT</given-names>
          </name>
          <name>
            <surname>Carey</surname>
            <given-names>VJ</given-names>
          </name>
        </person-group>
        <article-title>
          <bold>Software for computing and annotating genomic ranges</bold>
        </article-title>
        <source>PLoS Comput Biol</source>
        <year>2013</year>
        <volume>9</volume>
        <fpage>1003118</fpage>
        <pub-id pub-id-type="doi">10.1371/journal.pcbi.1003118</pub-id>
      </element-citation>
    </ref>
    <ref id="CR61">
      <label>61</label>
      <mixed-citation publication-type="other">Pagès H, Obenchain V, Morgan M: <bold>GenomicAlignments: Representation and manipulation of short genomic alignments</bold>2013. Bioconductor package [http://www.bioconductor.org]</mixed-citation>
    </ref>
    <ref id="CR62">
      <label>62</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Anders</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Pyl</surname>
            <given-names>PT</given-names>
          </name>
          <name>
            <surname>Huber</surname>
            <given-names>W</given-names>
          </name>
        </person-group>
        <article-title>
          <bold>HTSeq - A Python framework to work with high-throughput sequencing data</bold>
        </article-title>
        <source>Bioinformatics</source>
        <year>2015</year>
        <volume>31</volume>
        <fpage>166</fpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btu638</pub-id>
        <?supplied-pmid 25260700?>
        <pub-id pub-id-type="pmid">25260700</pub-id>
      </element-citation>
    </ref>
    <ref id="CR63">
      <label>63</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Delhomme</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Padioleau</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Furlong</surname>
            <given-names>EE</given-names>
          </name>
          <name>
            <surname>Steinmetz</surname>
            <given-names>LM</given-names>
          </name>
        </person-group>
        <article-title>
          <bold>easyRNASeq: a Bioconductor package for processing RNA-seq data</bold>
        </article-title>
        <source>Bioinformatics</source>
        <year>2012</year>
        <volume>28</volume>
        <fpage>2532</fpage>
        <lpage>2533</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/bts477</pub-id>
        <?supplied-pmid 22847932?>
        <pub-id pub-id-type="pmid">22847932</pub-id>
      </element-citation>
    </ref>
    <ref id="CR64">
      <label>64</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Liao</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Smyth</surname>
            <given-names>GK</given-names>
          </name>
          <name>
            <surname>Shi</surname>
            <given-names>W</given-names>
          </name>
        </person-group>
        <article-title>
          <bold>featureCounts: an efficient general purpose program for assigning sequence reads to genomic features</bold>
        </article-title>
        <source>Bioinformatics</source>
        <year>2014</year>
        <volume>30</volume>
        <fpage>923</fpage>
        <lpage>930</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btt656</pub-id>
        <?supplied-pmid 24227677?>
        <pub-id pub-id-type="pmid">24227677</pub-id>
      </element-citation>
    </ref>
    <ref id="CR65">
      <label>65</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kim</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Pertea</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Trapnell</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Pimentel</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Kelley</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Salzberg</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>
          <bold>TopHat2: accurate alignment of transcriptomes in the presence of insertions, deletions and gene fusions</bold>
        </article-title>
        <source>Genome Biol</source>
        <year>2013</year>
        <volume>14</volume>
        <fpage>36</fpage>
        <pub-id pub-id-type="doi">10.1186/gb-2013-14-4-r36</pub-id>
      </element-citation>
    </ref>
    <ref id="CR66">
      <label>66</label>
      <mixed-citation publication-type="other"><bold>DESeq2paper</bold>. [http://www-huber.embl.de/DESeq2paper]</mixed-citation>
    </ref>
  </ref-list>
</back>
<?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName A++V2.4.dtd?>
<?SourceDTD.Version 2.4?>
<?ConverterInfo.XSLTName springer2nlmx2.xsl?>
<?ConverterInfo.Version 2?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Genome Biol</journal-id>
    <journal-title-group>
      <journal-title>Genome Biology</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1465-6906</issn>
    <issn pub-type="epub">1465-6914</issn>
    <publisher>
      <publisher-name>BioMed Central</publisher-name>
      <publisher-loc>London</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">4302049</article-id>
    <article-id pub-id-type="pmid">25516281</article-id>
    <article-id pub-id-type="publisher-id">550</article-id>
    <article-id pub-id-type="doi">10.1186/s13059-014-0550-8</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Method</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Moderated estimation of fold change and dispersion for RNA-seq data with DESeq2</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Love</surname>
          <given-names>Michael I</given-names>
        </name>
        <address>
          <email>mlove@jimmy.harvard.edu</email>
        </address>
        <xref ref-type="aff" rid="Aff1"/>
        <xref ref-type="aff" rid="Aff2"/>
        <xref ref-type="aff" rid="Aff3"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Huber</surname>
          <given-names>Wolfgang</given-names>
        </name>
        <address>
          <email>whuber@embl.de</email>
        </address>
        <xref ref-type="aff" rid="Aff2"/>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <name>
          <surname>Anders</surname>
          <given-names>Simon</given-names>
        </name>
        <address>
          <email>sanders@fs.tum.de</email>
        </address>
        <xref ref-type="aff" rid="Aff2"/>
      </contrib>
      <aff id="Aff1"><label/>Department of Biostatistics and Computational Biology, Dana Farber Cancer Institute and Department of Biostatistics, Harvard School of Public Health, 450 Brookline Avenue, Boston, 02215 MA USA </aff>
      <aff id="Aff2"><label/>Genome Biology Unit, European Molecular Biology Laboratory, Meyerhofstrasse 1, Heidelberg, 69117 Germany </aff>
      <aff id="Aff3"><label/>Department of Computational Molecular Biology, Max Planck Institute for Molecular Genetics, Ihnestrasse 63-7314195, Berlin, Germany </aff>
    </contrib-group>
    <pub-date pub-type="epub">
      <day>5</day>
      <month>12</month>
      <year>2014</year>
    </pub-date>
    <pub-date pub-type="ppub">
      <year>2014</year>
    </pub-date>
    <volume>15</volume>
    <issue>12</issue>
    <elocation-id>550</elocation-id>
    <history>
      <date date-type="received">
        <day>27</day>
        <month>5</month>
        <year>2014</year>
      </date>
      <date date-type="accepted">
        <day>19</day>
        <month>11</month>
        <year>2014</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© Love et al.; licensee BioMed Central. 2014</copyright-statement>
      <license license-type="open-access">
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0">http://creativecommons.org/licenses/by/4.0</ext-link>), which permits unrestricted use, distribution, and reproduction in any medium, provided the original work is properly credited. The Creative Commons Public Domain Dedication waiver (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/publicdomain/zero/1.0/">http://creativecommons.org/publicdomain/zero/1.0/</ext-link>) applies to the data made available in this article, unless otherwise stated.</license-p>
      </license>
    </permissions>
    <abstract id="Abs1">
      <p>In comparative high-throughput sequencing assays, a fundamental task is the analysis of count data, such as read counts per gene in RNA-seq, for evidence of systematic changes across experimental conditions. Small replicate numbers, discreteness, large dynamic range and the presence of outliers require a suitable statistical approach. We present <italic>DESeq2</italic>, a method for differential analysis of count data, using shrinkage estimation for dispersions and fold changes to improve stability and interpretability of estimates. This enables a more quantitative analysis focused on the strength rather than the mere presence of differential expression. The <italic>DESeq2</italic> package is available at http://www.bioconductor.org/packages/release/bioc/html/DESeq2.html.</p>
      <sec>
        <title>Electronic supplementary material</title>
        <p>The online version of this article (doi:10.1186/s13059-014-0550-8) contains supplementary material, which is available to authorized users.</p>
      </sec>
    </abstract>
    <custom-meta-group>
      <custom-meta>
        <meta-name>issue-copyright-statement</meta-name>
        <meta-value>© The Author(s) 2014</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec id="Sec1">
    <title>Background</title>
    <p>The rapid adoption of high-throughput sequencing (HTS) technologies for genomic studies has resulted in a need for statistical methods to assess quantitative differences between experiments. An important task here is the analysis of RNA sequencing (RNA-seq) data with the aim of finding genes that are differentially expressed across groups of samples. This task is general: methods for it are typically also applicable for other comparative HTS assays, including chromatin immunoprecipitation sequencing, chromosome conformation capture, or counting observed taxa in metagenomic studies.</p>
    <p>Besides the need to account for the specifics of count data, such as non-normality and a dependence of the variance on the mean, a core challenge is the small number of samples in typical HTS experiments – often as few as two or three replicates per condition. Inferential methods that treat each gene separately suffer here from lack of power, due to the high uncertainty of within-group variance estimates. In high-throughput assays, this limitation can be overcome by pooling information across genes, specifically, by exploiting assumptions about the similarity of the variances of different genes measured in the same experiment [<xref ref-type="bibr" rid="CR1">1</xref>].</p>
    <p>Many methods for differential expression analysis of RNA-seq data perform such information sharing across genes for variance (or, equivalently, dispersion) estimation. <italic>edgeR</italic> [<xref ref-type="bibr" rid="CR2">2</xref>,<xref ref-type="bibr" rid="CR3">3</xref>] moderates the dispersion estimate for each gene toward a common estimate across all genes, or toward a local estimate from genes with similar expression strength, using a weighted conditional likelihood. Our <italic>DESeq</italic> method [<xref ref-type="bibr" rid="CR4">4</xref>] detects and corrects dispersion estimates that are too low through modeling of the dependence of the dispersion on the average expression strength over all samples. <italic>BBSeq</italic> [<xref ref-type="bibr" rid="CR5">5</xref>] models the dispersion on the mean, with the mean absolute deviation of dispersion estimates used to reduce the influence of outliers. <italic>DSS</italic> [<xref ref-type="bibr" rid="CR6">6</xref>] uses a Bayesian approach to provide an estimate for the dispersion for individual genes that accounts for the heterogeneity of dispersion values for different genes. <italic>baySeq</italic> [<xref ref-type="bibr" rid="CR7">7</xref>] and <italic>ShrinkBayes</italic> [<xref ref-type="bibr" rid="CR8">8</xref>] estimate priors for a Bayesian model over all genes, and then provide posterior probabilities or false discovery rates (FDRs) for differential expression.</p>
    <p>The most common approach in the comparative analysis of transcriptomics data is to test the null hypothesis that the logarithmic fold change (LFC) between treatment and control for a gene’s expression is exactly zero, i.e., that the gene is not at all affected by the treatment. Often the goal of differential analysis is to produce a list of genes passing multiple-test adjustment, ranked by <italic>P</italic> value. However, small changes, even if statistically highly significant, might not be the most interesting candidates for further investigation. Ranking by fold change, on the other hand, is complicated by the noisiness of LFC estimates for genes with low counts. Furthermore, the number of genes called significantly differentially expressed depends as much on the sample size and other aspects of experimental design as it does on the biology of the experiment – and well-powered experiments often generate an overwhelmingly long list of hits [<xref ref-type="bibr" rid="CR9">9</xref>]. We, therefore, developed a statistical framework to facilitate gene ranking and visualization based on stable estimation of effect sizes (LFCs), as well as testing of differential expression with respect to user-defined thresholds of biological significance.</p>
    <p>Here we present <italic>DESeq2</italic>, a successor to our <italic>DESeq</italic> method [<xref ref-type="bibr" rid="CR4">4</xref>]. <italic>DESeq2</italic> integrates methodological advances with several novel features to facilitate a more quantitative analysis of comparative RNA-seq data using shrinkage estimators for dispersion and fold change. We demonstrate the advantages of <italic>DESeq2</italic>’s new features by describing a number of applications possible with shrunken fold changes and their estimates of standard error, including improved gene ranking and visualization, hypothesis tests above and below a threshold, and the regularized logarithm transformation for quality assessment and clustering of overdispersed count data. We furthermore compare <italic>DESeq2</italic>’s statistical power with existing tools, revealing that our methodology has high sensitivity and precision, while controlling the false positive rate. <italic>DESeq2</italic> is available [<xref ref-type="bibr" rid="CR10">10</xref>] as an R/Bioconductor package [<xref ref-type="bibr" rid="CR11">11</xref>].</p>
  </sec>
  <sec id="Sec2">
    <title>Results and discussion</title>
    <sec id="Sec3">
      <title>Model and normalization</title>
      <p>The starting point of a <italic>DESeq2</italic> analysis is a count matrix <italic>K</italic> with one row for each gene <italic>i</italic> and one column for each sample <italic>j</italic>. The matrix entries <italic>K</italic><sub><italic>ij</italic></sub> indicate the number of sequencing reads that have been unambiguously mapped to a gene in a sample. Note that although we refer in this paper to counts of reads in genes, the methods presented here can be applied as well to other kinds of HTS count data. For each gene, we fit a generalized linear model (GLM) [<xref ref-type="bibr" rid="CR12">12</xref>] as follows.</p>
      <p>We model read counts <italic>K</italic><sub><italic>ij</italic></sub> as following a negative binomial distribution (sometimes also called a gamma-Poisson distribution) with mean <italic>μ</italic><sub><italic>ij</italic></sub> and dispersion <italic>α</italic><sub><italic>i</italic></sub>. The mean is taken as a quantity <italic>q</italic><sub><italic>ij</italic></sub>, proportional to the concentration of cDNA fragments from the gene in the sample, scaled by a normalization factor <italic>s</italic><sub><italic>ij</italic></sub>, i.e., <italic>μ</italic><sub><italic>ij</italic></sub>=<italic>s</italic><sub><italic>ij</italic></sub><italic>q</italic><sub><italic>ij</italic></sub>. For many applications, the same constant <italic>s</italic><sub><italic>j</italic></sub> can be used for all genes in a sample, which then accounts for differences in sequencing depth between samples. To estimate these <italic>size factors</italic>, the <italic>DESeq2</italic> package offers the median-of-ratios method already used in <italic>DESeq</italic> [<xref ref-type="bibr" rid="CR4">4</xref>]. However, it can be advantageous to calculate gene-specific normalization factors <italic>s</italic><sub><italic>ij</italic></sub> to account for further sources of technical biases such as differing dependence on GC content, gene length or the like, using published methods [<xref ref-type="bibr" rid="CR13">13</xref>,<xref ref-type="bibr" rid="CR14">14</xref>], and these can be supplied instead.</p>
      <p>We use GLMs with a logarithmic link, <inline-formula id="IEq1"><alternatives><tex-math id="M1">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
							$\log _{2} q_{\textit {ij}}=\sum _{r} x_{\textit {jr}} \beta _{\textit {ir}}$
						\end{document}</tex-math><mml:math id="M2"><mml:munder><mml:mrow><mml:mo>log</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:munder><mml:msub><mml:mrow><mml:mi>q</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ij</mml:mtext></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:munder><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:munder><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">jr</mml:mtext></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ir</mml:mtext></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13059_2014_550_Article_IEq1.gif"/></alternatives></inline-formula>, with design matrix elements <italic>x</italic><sub><italic>jr</italic></sub> and coefficients <italic>β</italic><sub><italic>ir</italic></sub>. In the simplest case of a comparison between two groups, such as treated and control samples, the design matrix elements indicate whether a sample <italic>j</italic> is treated or not, and the GLM fit returns coefficients indicating the overall expression strength of the gene and the log <sub>2</sub> fold change between treatment and control. The use of linear models, however, provides the flexibility to also analyze more complex designs, as is often useful in genomic studies [<xref ref-type="bibr" rid="CR15">15</xref>].</p>
    </sec>
    <sec id="Sec4">
      <title>Empirical Bayes shrinkage for dispersion estimation</title>
      <p>Within-group variability, i.e., the variability between replicates, is modeled by the dispersion parameter <italic>α</italic><sub><italic>i</italic></sub>, which describes the variance of counts via <inline-formula id="IEq2"><alternatives><tex-math id="M3">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
							$\operatorname {Var} K_{\textit {ij}} = \mu _{\textit {ij}} + \alpha _{i} \mu _{\textit {ij}}^{2}$
						\end{document}</tex-math><mml:math id="M4"><mml:mo>Var</mml:mo><mml:msub><mml:mrow><mml:mi>K</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ij</mml:mtext></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ij</mml:mtext></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:msubsup><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ij</mml:mtext></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2014_550_Article_IEq2.gif"/></alternatives></inline-formula>. Accurate estimation of the dispersion parameter <italic>α</italic><sub><italic>i</italic></sub> is critical for the statistical inference of differential expression. For studies with large sample sizes this is usually not a problem. For controlled experiments, however, sample sizes tend to be smaller (experimental designs with as little as two or three replicates are common and reasonable), resulting in highly variable dispersion estimates for each gene. If used directly, these noisy estimates would compromise the accuracy of differential expression testing.</p>
      <p>One sensible solution is to share information across genes. In <italic>DESeq2</italic>, we assume that genes of similar average expression strength have similar dispersion. We here explain the concepts of our approach using as examples a dataset by Bottomly <italic>et al.</italic> [<xref ref-type="bibr" rid="CR16">16</xref>] with RNA-seq data for mice of two different strains and a dataset by Pickrell <italic>et al.</italic> [<xref ref-type="bibr" rid="CR17">17</xref>] with RNA-seq data for human lymphoblastoid cell lines. For the mathematical details, see <xref rid="Sec18" ref-type="sec">Materials and methods</xref>.</p>
      <p>We first treat each gene separately and estimate gene-wise dispersion estimates (using maximum likelihood), which rely only on the data of each individual gene (black dots in Figure <xref rid="Fig1" ref-type="fig">1</xref>). Next, we determine the location parameter of the distribution of these estimates; to allow for dependence on average expression strength, we fit a smooth curve, as shown by the red line in Figure <xref rid="Fig1" ref-type="fig">1</xref>. This provides an accurate estimate for the expected dispersion value for genes of a given expression strength but does not represent deviations of individual genes from this overall trend. We then shrink the gene-wise dispersion estimates toward the values predicted by the curve to obtain final dispersion values (blue arrow heads). We use an empirical Bayes approach (<xref rid="Sec18" ref-type="sec">Materials and methods</xref>), which lets the strength of shrinkage depend (i) on an estimate of how close true dispersion values tend to be to the fit and (ii) on the degrees of freedom: as the sample size increases, the shrinkage decreases in strength, and eventually becomes negligible. Our approach therefore accounts for gene-specific variation to the extent that the data provide this information, while the fitted curve aids estimation and testing in less information-rich settings.
<fig id="Fig1"><label>Figure 1</label><caption><p><bold>Shrinkage estimation of dispersion.</bold> Plot of dispersion estimates over the average expression strength <bold>(A)</bold> for the Bottomly <italic>et al.</italic> [<xref ref-type="bibr" rid="CR16">16</xref>] dataset with six samples across two groups and <bold>(B)</bold> for five samples from the Pickrell <italic>et al.</italic> [<xref ref-type="bibr" rid="CR17">17</xref>] dataset, fitting only an intercept term. First, gene-wise MLEs are obtained using only the respective gene’s data (black dots). Then, a curve (red) is fit to the MLEs to capture the overall trend of dispersion-mean dependence. This fit is used as a prior mean for a second estimation round, which results in the final MAP estimates of dispersion (arrow heads). This can be understood as a shrinkage (along the blue arrows) of the noisy gene-wise estimates toward the consensus represented by the red line. The black points circled in blue are detected as dispersion outliers and not shrunk toward the prior (shrinkage would follow the dotted line). For clarity, only a subset of genes is shown, which is enriched for dispersion outliers. Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S1 displays the same data but with dispersions of all genes shown. MAP, maximum <italic>a posteriori</italic>; MLE, maximum-likelihood estimate.</p></caption><graphic xlink:href="13059_2014_550_Fig1_HTML" id="MO1"/></fig></p>
      <p>Our approach is similar to the one used by <italic>DSS</italic> [<xref ref-type="bibr" rid="CR6">6</xref>], in that both methods sequentially estimate a prior distribution for the true dispersion values around the fit, and then provide the maximum <italic>a posteriori</italic> (MAP) as the final estimate. It differs from the previous implementation of <italic>DESeq</italic>, which used the maximum of the fitted curve and the gene-wise dispersion estimate as the final estimate and tended to overestimate the dispersions (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S2). The approach of <italic>DESeq2</italic> differs from that of <italic>edgeR</italic> [<xref ref-type="bibr" rid="CR3">3</xref>], as <italic>DESeq2</italic> estimates the width of the prior distribution from the data and therefore automatically controls the amount of shrinkage based on the observed properties of the data. In contrast, the default steps in <italic>edgeR</italic> require a user-adjustable parameter, the <italic>prior degrees of freedom</italic>, which weighs the contribution of the individual gene estimate and <italic>edgeR</italic>’s dispersion fit.</p>
      <p>Note that in Figure <xref rid="Fig1" ref-type="fig">1</xref> a number of genes with gene-wise dispersion estimates below the curve have their final estimates raised substantially. The shrinkage procedure thereby helps avoid potential false positives, which can result from underestimates of dispersion. If, on the other hand, an individual gene’s dispersion is far above the distribution of the gene-wise dispersion estimates of other genes, then the shrinkage would lead to a greatly reduced final estimate of dispersion. We reasoned that in many cases, the reason for extraordinarily high dispersion of a gene is that it does not obey our modeling assumptions; some genes may show much higher variability than others for biological or technical reasons, even though they have the same average expression levels. In these cases, inference based on the shrunken dispersion estimates could lead to undesirable false positive calls. <italic>DESeq2</italic> handles these cases by using the gene-wise estimate instead of the shrunken estimate when the former is more than 2 residual standard deviations above the curve.</p>
    </sec>
    <sec id="Sec5">
      <title>Empirical Bayes shrinkage for fold-change estimation</title>
      <p>A common difficulty in the analysis of HTS data is the strong variance of LFC estimates for genes with low read count. We demonstrate this issue using the dataset by Bottomly <italic>et al.</italic> [<xref ref-type="bibr" rid="CR16">16</xref>]. As visualized in Figure <xref rid="Fig2" ref-type="fig">2</xref>A, weakly expressed genes seem to show much stronger differences between the compared mouse strains than strongly expressed genes. This phenomenon, seen in most HTS datasets, is a direct consequence of dealing with <italic>count</italic> data, in which ratios are inherently noisier when counts are low. This heteroskedasticity (variance of LFCs depending on mean count) complicates downstream analysis and data interpretation, as it makes effect sizes difficult to compare across the dynamic range of the data.
<fig id="Fig2"><label>Figure 2</label><caption><p><bold>Effect of shrinkage on logarithmic fold change estimates.</bold> Plots of the <bold>(A)</bold> MLE (i.e., no shrinkage) and <bold>(B)</bold> MAP estimate (i.e., with shrinkage) for the LFCs attributable to mouse strain, over the average expression strength for a ten vs eleven sample comparison of the Bottomly <italic>et al.</italic> [<xref ref-type="bibr" rid="CR16">16</xref>] dataset. Small triangles at the top and bottom of the plots indicate points that would fall outside of the plotting window. Two genes with similar mean count and MLE logarithmic fold change are highlighted with green and purple circles. <bold>(C)</bold> The counts (normalized by size factors <italic>s</italic>
<sub><italic>j</italic></sub>) for these genes reveal low dispersion for the gene in green and high dispersion for the gene in purple. <bold>(D)</bold> Density plots of the likelihoods (solid lines, scaled to integrate to 1) and the posteriors (dashed lines) for the green and purple genes and of the prior (solid black line): due to the higher dispersion of the purple gene, its likelihood is wider and less peaked (indicating less information), and the prior has more influence on its posterior than for the green gene. The stronger curvature of the green posterior at its maximum translates to a smaller reported standard error for the MAP LFC estimate (horizontal error bar). adj., adjusted; LFC, logarithmic fold change; MAP, maximum <italic>a posteriori</italic>; MLE, maximum-likelihood estimate.</p></caption><graphic xlink:href="13059_2014_550_Fig2_HTML" id="MO2"/></fig></p>
      <p><italic>DESeq2</italic> overcomes this issue by shrinking LFC estimates toward zero in a manner such that shrinkage is stronger when the available information for a gene is low, which may be because counts are low, dispersion is high or there are few degrees of freedom. We again employ an empirical Bayes procedure: we first perform ordinary GLM fits to obtain maximum-likelihood estimates (MLEs) for the LFCs and then fit a zero-centered normal distribution to the observed distribution of MLEs over all genes. This distribution is used as a prior on LFCs in a second round of GLM fits, and the MAP estimates are kept as final estimates of LFC. Furthermore, a standard error for each estimate is reported, which is derived from the posterior’s curvature at its maximum (see <xref rid="Sec18" ref-type="sec">Materials and methods</xref> for details). These shrunken LFCs and their standard errors are used in the Wald tests for differential expression described in the next section.</p>
      <p>The resulting MAP LFCs are biased toward zero in a manner that removes the problem of exaggerated LFCs for low counts. As Figure <xref rid="Fig2" ref-type="fig">2</xref>B shows, the strongest LFCs are no longer exhibited by genes with weakest expression. Rather, the estimates are more evenly spread around zero, and for very weakly expressed genes (with less than one read per sample on average), LFCs hardly deviate from zero, reflecting that accurate LFC estimates are not possible here.</p>
      <p>The strength of shrinkage does not depend simply on the mean count, but rather on the amount of information available for the fold change estimation (as indicated by the observed Fisher information; see <xref rid="Sec18" ref-type="sec">Materials and methods</xref>). Two genes with equal expression strength but different dispersions will experience a different amount of shrinkage (Figure <xref rid="Fig2" ref-type="fig">2</xref>C,D). The shrinkage of LFC estimates can be described as a bias-variance trade-off [<xref ref-type="bibr" rid="CR18">18</xref>]: for genes with little information for LFC estimation, a reduction of the strong variance is bought at the cost of accepting a bias toward zero, and this can result in an overall reduction in mean squared error, e.g., when comparing to LFC estimates from a new dataset. Genes with high information for LFC estimation will have, in our approach, LFCs with both low bias and low variance. Furthermore, as the degrees of freedom increase, and the experiment provides more information for LFC estimation, the shrunken estimates will converge to the unshrunken estimates. We note that other Bayesian efforts toward moderating fold changes for RNA-seq include hierarchical models [<xref ref-type="bibr" rid="CR8">8</xref>,<xref ref-type="bibr" rid="CR19">19</xref>] and the <italic>GFOLD</italic> (or generalized fold change) tool [<xref ref-type="bibr" rid="CR20">20</xref>], which uses a posterior distribution of LFCs.</p>
      <p>The shrunken MAP LFCs offer a more reproducible quantification of transcriptional differences than standard MLE LFCs. To demonstrate this, we split the Bottomly <italic>et al.</italic> samples equally into two groups, I and II, such that each group contained a balanced split of the strains, simulating a scenario where an experiment (samples in group I) is performed, analyzed and reported, and then independently replicated (samples in group II). Within each group, we estimated LFCs between the strains and compared between groups I and II, using the MLE LFCs (Figure <xref rid="Fig3" ref-type="fig">3</xref>A) and using the MAP LFCs (Figure <xref rid="Fig3" ref-type="fig">3</xref>B). Because the shrinkage moves large LFCs that are not well supported by the data toward zero, the agreement between the two independent sample groups increases considerably. Therefore, shrunken fold-change estimates offer a more reliable basis for quantitative conclusions than normal MLEs.
<fig id="Fig3"><label>Figure 3</label><caption><p><bold>Stability of logarithmic fold changes.</bold><italic>DESeq2</italic> is run on equally split halves of the data of Bottomly <italic>et al.</italic> [<xref ref-type="bibr" rid="CR16">16</xref>], and the LFCs from the halves are plotted against each other. <bold>(A)</bold> MLEs, i.e., without LFC shrinkage. <bold>(B)</bold> MAP estimates, i.e., with shrinkage. Points in the top left and bottom right quadrants indicate genes with a change of sign of LFC. Red points indicate genes with adjusted <italic>P</italic> value &lt;0.1. The legend displays the root-mean-square error of the estimates in group I compared to those in group II. LFC, logarithmic fold change; MAP, maximum <italic>a posteriori</italic>; MLE, maximum-likelihood estimate; RMSE, root-mean-square error.</p></caption><graphic xlink:href="13059_2014_550_Fig3_HTML" id="MO3"/></fig></p>
      <p>This makes shrunken LFCs also suitable for ranking genes, e.g., to prioritize them for follow-up experiments. For example, if we sort the genes in the two sample groups of Figure <xref rid="Fig3" ref-type="fig">3</xref> by unshrunken LFC estimates, and consider the 100 genes with the strongest up- or down-regulation in group I, we find only 21 of these again among the top 100 up- or down-regulated genes in group II. However, if we rank the genes by shrunken LFC estimates, the overlap improves to 81 of 100 genes (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S3).</p>
      <p>A simpler often used method is to add a fixed number (pseudocount) to all counts before forming ratios. However, this requires the choice of a tuning parameter and only reacts to one of the sources of uncertainty, low counts, but not to gene-specific dispersion differences or sample size. We demonstrate this in the <italic>Benchmarks</italic> section below.</p>
    </sec>
    <sec id="Sec6">
      <title>Hypothesis tests for differential expression</title>
      <p>After GLMs are fit for each gene, one may test whether each model coefficient differs significantly from zero. <italic>DESeq2</italic> reports the standard error for each shrunken LFC estimate, obtained from the curvature of the coefficient’s posterior (dashed lines in Figure <xref rid="Fig2" ref-type="fig">2</xref>D) at its maximum. For significance testing, <italic>DESeq2</italic> uses a Wald test: the shrunken estimate of LFC is divided by its standard error, resulting in a <italic>z</italic>-statistic, which is compared to a standard normal distribution. (See <xref rid="Sec18" ref-type="sec">Materials and methods</xref> for details.) The Wald test allows testing of individual coefficients, or contrasts of coefficients, without the need to fit a reduced model as with the likelihood ratio test, though the likelihood ratio test is also available as an option in <italic>DESeq2</italic>. The Wald test <italic>P</italic> values from the subset of genes that pass an independent filtering step, described in the next section, are adjusted for multiple testing using the procedure of Benjamini and Hochberg [<xref ref-type="bibr" rid="CR21">21</xref>].</p>
    </sec>
    <sec id="Sec7">
      <title>Automatic independent filtering</title>
      <p>Due to the large number of tests performed in the analysis of RNA-seq and other genome-wide experiments, the multiple testing problem needs to be addressed. A popular objective is control or estimation of the FDR. Multiple testing adjustment tends to be associated with a loss of power, in the sense that the FDR for a set of genes is often higher than the individual <italic>P</italic> values of these genes. However, the loss can be reduced if genes that have little or no chance of being detected as differentially expressed are omitted from the testing, provided that the criterion for omission is independent of the test statistic under the null hypothesis [<xref ref-type="bibr" rid="CR22">22</xref>] (see <xref rid="Sec18" ref-type="sec">Materials and methods</xref>). <italic>DESeq2</italic> uses the average expression strength of each gene, across all samples, as its filter criterion, and it omits all genes with mean normalized counts below a filtering threshold from multiple testing adjustment. <italic>DESeq2</italic> by default will choose a threshold that maximizes the number of genes found at a user-specified target FDR. In Figures <xref rid="Fig2" ref-type="fig">2</xref>A,B and <xref rid="Fig3" ref-type="fig">3</xref>, genes found in this way to be significant at an estimated FDR of 10% are depicted in red. Depending on the distribution of the mean normalized counts, the resulting increase in power can be substantial, sometimes making the difference in whether or not any differentially expressed genes are detected.</p>
    </sec>
    <sec id="Sec8">
      <title>Hypothesis tests with thresholds on effect size</title>
      <sec id="Sec9">
        <title>Specifying minimum effect size</title>
        <p>Most approaches to testing for differential expression, including the default approach of <italic>DESeq2</italic>, test against the null hypothesis of <italic>zero</italic> LFC. However, if any biological processes are genuinely affected by the difference in experimental treatment, this null hypothesis implies that the gene under consideration is <italic>perfectly</italic> decoupled from these processes. Due to the high interconnectedness of cells’ regulatory networks, this hypothesis is, in fact, implausible, and arguably wrong for many if not most genes. Consequently, with sufficient sample size, even genes with a very small but non-zero LFC will eventually be detected as differentially expressed. A change should therefore be of sufficient magnitude to be considered <italic>biologically significant</italic>. For small-scale experiments, statistical significance is often a much stricter requirement than biological significance, thereby relieving the researcher from the need to decide on a threshold for biological significance.</p>
        <p>For well-powered experiments, however, a statistical test against the conventional null hypothesis of zero LFC may report genes with statistically significant changes that are so weak in effect strength that they could be considered irrelevant or distracting. A common procedure is to disregard genes whose estimated LFC <italic>β</italic><sub><italic>ir</italic></sub> is below some threshold, |<italic>β</italic><sub><italic>ir</italic></sub>|≤<italic>θ</italic>. However, this approach loses the benefit of an easily interpretable FDR, as the reported <italic>P</italic> value and adjusted <italic>P</italic> value still correspond to the test of <italic>zero</italic> LFC. It is therefore desirable to include the threshold in the statistical testing procedure directly, i.e., not to filter post hoc on a reported fold-change <italic>estimate</italic>, but rather to evaluate statistically directly whether there is sufficient evidence that the LFC is above the chosen threshold.</p>
        <p><italic>DESeq2</italic> offers tests for composite null hypotheses of the form |<italic>β</italic><sub><italic>ir</italic></sub>|≤<italic>θ</italic>, where <italic>β</italic><sub><italic>ir</italic></sub> is the shrunken LFC from the estimation procedure described above. (See <xref rid="Sec18" ref-type="sec">Materials and methods</xref> for details.) Figure <xref rid="Fig4" ref-type="fig">4</xref>A demonstrates how such a thresholded test gives rise to a curved decision boundary: to reach significance, the estimated LFC has to exceed the specified threshold by an amount that depends on the available information. We note that related approaches to generate gene lists that satisfy both statistical and biological significance criteria have been previously discussed for microarray data [<xref ref-type="bibr" rid="CR23">23</xref>] and recently for sequencing data [<xref ref-type="bibr" rid="CR19">19</xref>].
<fig id="Fig4"><label>Figure 4</label><caption><p><bold>Hypothesis testing involving non-zero thresholds.</bold> Shown are plots of the estimated fold change over average expression strength (“minus over average”, or MA-plots) for a ten vs eleven comparison using the Bottomly <italic>et al.</italic> [<xref ref-type="bibr" rid="CR16">16</xref>] dataset, with highlighted points indicating low adjusted <italic>P</italic> values. The alternate hypotheses are that logarithmic (base 2) fold changes are <bold>(A)</bold> greater than 1 in absolute value or <bold>(B)</bold> less than 1 in absolute value. adj., adjusted.</p></caption><graphic xlink:href="13059_2014_550_Fig4_HTML" id="MO4"/></fig></p>
      </sec>
      <sec id="Sec10">
        <title>Specifying maximum effect size</title>
        <p>Sometimes, a researcher is interested in finding genes that are not, or only very weakly, affected by the treatment or experimental condition. This amounts to a setting similar to the one just discussed, but the roles of the null and alternative hypotheses are swapped. We are here asking for evidence of the effect being weak, not for evidence of the effect being zero, because the latter question is rarely tractable. The meaning of <italic>weak</italic> needs to be quantified for the biological question at hand by choosing a suitable threshold <italic>θ</italic> for the LFC. For such analyses, <italic>DESeq2</italic> offers a test of the composite null hypothesis |<italic>β</italic><sub><italic>ir</italic></sub>|≥<italic>θ</italic>, which will report genes as significant for which there is evidence that their LFC is weaker than <italic>θ</italic>. Figure <xref rid="Fig4" ref-type="fig">4</xref>B shows the outcome of such a test. For genes with very low read count, even an estimate of zero LFC is not significant, as the large uncertainty of the estimate does not allow us to exclude that the gene may in truth be more than weakly affected by the experimental condition. Note the lack of LFC shrinkage: to find genes with weak differential expression, <italic>DESeq2</italic> requires that the LFC shrinkage has been disabled. This is because the zero-centered prior used for LFC shrinkage embodies a <italic>prior</italic> belief that LFCs tend to be small, and hence is inappropriate here.</p>
      </sec>
    </sec>
    <sec id="Sec11">
      <title>Detection of count outliers</title>
      <p>Parametric methods for detecting differential expression can have gene-wise estimates of LFC overly influenced by individual outliers that do not fit the distributional assumptions of the model [<xref ref-type="bibr" rid="CR24">24</xref>]. An example of such an outlier would be a gene with single-digit counts for all samples, except one sample with a count in the thousands. As the aim of differential expression analysis is typically to find <italic>consistently</italic> up- or down-regulated genes, it is useful to consider diagnostics for detecting individual observations that overly influence the LFC estimate and <italic>P</italic> value for a gene. A standard outlier diagnostic is Cook’s distance [<xref ref-type="bibr" rid="CR25">25</xref>], which is defined within each gene for each sample as the scaled distance that the coefficient vector, <inline-formula id="IEq3"><alternatives><tex-math id="M5">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
							$\vec {\beta }_{i}$
						\end{document}</tex-math><mml:math id="M6"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mo>→</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13059_2014_550_Article_IEq3.gif"/></alternatives></inline-formula>, of a linear model or GLM would move if the sample were removed and the model refit.</p>
      <p><italic>DESeq2</italic> flags, for each gene, those samples that have a Cook’s distance greater than the 0.99 quantile of the <italic>F</italic>(<italic>p</italic>,<italic>m</italic>−<italic>p</italic>) distribution, where <italic>p</italic> is the number of model parameters including the intercept, and <italic>m</italic> is the number of samples. The use of the <italic>F</italic> distribution is motivated by the heuristic reasoning that removing a single sample should not move the vector <inline-formula id="IEq4"><alternatives><tex-math id="M7">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
							$\vec {\beta }_{i}$
						\end{document}</tex-math><mml:math id="M8"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mo>→</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13059_2014_550_Article_IEq4.gif"/></alternatives></inline-formula> outside of a 99% confidence region around <inline-formula id="IEq5"><alternatives><tex-math id="M9">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
							$\vec {\beta }_{i}$
						\end{document}</tex-math><mml:math id="M10"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mo>→</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13059_2014_550_Article_IEq5.gif"/></alternatives></inline-formula> fit using all the samples [<xref ref-type="bibr" rid="CR25">25</xref>]. However, if there are two or fewer replicates for a condition, these samples do not contribute to outlier detection, as there are insufficient replicates to determine outlier status.</p>
      <p>How should one deal with flagged outliers? In an experiment with many replicates, discarding the outlier and proceeding with the remaining data might make best use of the available data. In a small experiment with few samples, however, the presence of an outlier can impair inference regarding the affected gene, and merely ignoring the outlier may even be considered data cherry-picking – and therefore, it is more prudent to exclude the whole gene from downstream analysis.</p>
      <p>Hence, <italic>DESeq2</italic> offers two possible responses to flagged outliers. By default, outliers in conditions with six or fewer replicates cause the whole gene to be flagged and removed from subsequent analysis, including <italic>P</italic> value adjustment for multiple testing. For conditions that contain seven or more replicates, <italic>DESeq2</italic> replaces the outlier counts with an imputed value, namely the trimmed mean over all samples, scaled by the size factor, and then re-estimates the dispersion, LFCs and <italic>P</italic> values for these genes. As the outlier is replaced with the value predicted by the null hypothesis of no differential expression, this is a more conservative choice than simply omitting the outlier. When there are many degrees of freedom, the second approach avoids discarding genes that might contain true differential expression.</p>
      <p>Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S4 displays the outlier replacement procedure for a single gene in a seven by seven comparison of the Bottomly <italic>et al.</italic> [<xref ref-type="bibr" rid="CR16">16</xref>] dataset. While the original fitted means are heavily influenced by a single sample with a large count, the corrected LFCs provide a better fit to the majority of the samples.</p>
    </sec>
    <sec id="Sec12">
      <title>Regularized logarithm transformation</title>
      <p>For certain analyses, it is useful to transform data to render them homoskedastic. As an example, consider the task of assessing sample similarities in an unsupervised manner using a clustering or ordination algorithm. For RNA-seq data, the problem of heteroskedasticity arises: if the data are given to such an algorithm on the original count scale, the result will be dominated by highly expressed, highly variable genes; if logarithm-transformed data are used, undue weight will be given to weakly expressed genes, which show exaggerated LFCs, as discussed above. Therefore, we use the shrinkage approach of <italic>DESeq2</italic> to implement a <italic>regularized logarithm</italic> transformation (rlog), which behaves similarly to a log2 transformation for genes with high counts, while shrinking together the values for different samples for genes with low counts. It therefore avoids a commonly observed property of the standard logarithm transformation, the spreading apart of data for genes with low counts, where random noise is likely to dominate any biologically meaningful signal. When we consider the variance of each gene, computed across samples, these variances are stabilized – i.e., approximately the same, or homoskedastic – after the rlog transformation, while they would otherwise strongly depend on the mean counts. It thus facilitates multivariate visualization and ordinations such as clustering or principal component analysis that tend to work best when the variables have similar dynamic range. Note that while the rlog transformation builds upon on our LFC shrinkage approach, it is distinct from and not part of the statistical inference procedure for differential expression analysis described above, which employs the raw counts, not transformed data.</p>
      <p>The rlog transformation is calculated by fitting for each gene a GLM with a baseline expression (i.e., intercept only) and, computing for each sample, shrunken LFCs with respect to the baseline, using the same empirical Bayes procedure as before (<xref rid="Sec18" ref-type="sec">Materials and methods</xref>). Here, however, the sample covariate information (e.g. treatment or control) is not used, so that all samples are treated equally. The rlog transformation accounts for variation in sequencing depth across samples as it represents the logarithm of <italic>q</italic><sub><italic>ij</italic></sub> after accounting for the size factors <italic>s</italic><sub><italic>ij</italic></sub>. This is in contrast to the variance-stabilizing transformation (VST) for overdispersed counts introduced in <italic>DESeq</italic> [<xref ref-type="bibr" rid="CR4">4</xref>]: while the VST is also effective at stabilizing variance, it does not directly take into account differences in size factors; and in datasets with large variation in sequencing depth (dynamic range of size factors <inline-formula id="IEq6"><alternatives><tex-math id="M11">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
							$\gtrsim $
						\end{document}</tex-math><mml:math id="M12"><mml:mo>≳</mml:mo></mml:math><inline-graphic xlink:href="13059_2014_550_Article_IEq6.gif"/></alternatives></inline-formula>4) we observed undesirable artifacts in the performance of the VST. A disadvantage of the rlog transformation with respect to the VST is, however, that the ordering of genes within a sample will change if neighboring genes undergo shrinkage of different strength. As with the VST, the value of rlog(<italic>K</italic><sub><italic>ij</italic></sub>) for large counts is approximately equal to log2(<italic>K</italic><sub><italic>ij</italic></sub>/<italic>s</italic><sub><italic>j</italic></sub>). Both the rlog transformation and the VST are provided in the <italic>DESeq2</italic> package.</p>
      <p>We demonstrate the use of the rlog transformation on the RNA-seq dataset of Hammer <italic>et al.</italic> [<xref ref-type="bibr" rid="CR26">26</xref>], wherein RNA was sequenced from the dorsal root ganglion of rats that had undergone spinal nerve ligation and controls, at 2 weeks and at 2 months after the ligation. The count matrix for this dataset was downloaded from the ReCount online resource [<xref ref-type="bibr" rid="CR27">27</xref>]. This dataset offers more subtle differences between conditions than the Bottomly <italic>et al.</italic> [<xref ref-type="bibr" rid="CR16">16</xref>] dataset. Figure <xref rid="Fig5" ref-type="fig">5</xref> provides diagnostic plots of the normalized counts under the ordinary logarithm with a pseudocount of 1 and the rlog transformation, showing that the rlog both stabilizes the variance through the range of the mean of counts and helps to find meaningful patterns in the data.
<fig id="Fig5"><label>Figure 5</label><caption><p><bold>Variance stabilization and clustering after rlog transformation.</bold> Two transformations were applied to the counts of the Hammer <italic>et al.</italic> [<xref ref-type="bibr" rid="CR26">26</xref>] dataset: the logarithm of normalized counts plus a pseudocount, i.e. <italic>f</italic>(<italic>K</italic>
<sub><italic>ij</italic></sub>)= log2(<italic>K</italic>
<sub><italic>ij</italic></sub>/<italic>s</italic>
<sub><italic>j</italic></sub>+1), and the rlog. The gene-wise standard deviation of transformed values is variable across the range of the mean of counts using the logarithm <bold>(A)</bold>, while relatively stable using the rlog <bold>(B)</bold>. A hierarchical clustering on Euclidean distances and complete linkage using the rlog <bold>(D)</bold> transformed data clusters the samples into the groups defined by treatment and time, while using the logarithm-transformed counts <bold>(C)</bold> produces a more ambiguous result. sd, standard deviation.</p></caption><graphic xlink:href="13059_2014_550_Fig5_HTML" id="MO5"/></fig></p>
    </sec>
    <sec id="Sec13">
      <title>Gene-level analysis</title>
      <p>We here present <italic>DESeq2</italic> for the analysis of per-gene counts, i.e., the total number of reads that can be uniquely assigned to a gene. In contrast, several algorithms [<xref ref-type="bibr" rid="CR28">28</xref>,<xref ref-type="bibr" rid="CR29">29</xref>] work with probabilistic assignments of reads to transcripts, where multiple, overlapping transcripts can originate from each gene. It has been noted that the total read count approach can result in false detection of differential expression when in fact only transcript isoform lengths change, and even in a wrong sign of LFCs in extreme cases [<xref ref-type="bibr" rid="CR28">28</xref>]. However, in our benchmark, discussed in the following section, we found that LFC sign disagreements between total read count and probabilistic-assignment-based methods were rare for genes that were differentially expressed according to either method (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S5). Furthermore, if estimates for average transcript length are available for the conditions, these can be incorporated into the <italic>DESeq2</italic> framework as gene- and sample-specific normalization factors. In addition, the approach used in <italic>DESeq2</italic> can be extended to isoform-specific analysis, either through generalized linear modeling at the exon level with a gene-specific mean as in the <italic>DEXSeq</italic> package [<xref ref-type="bibr" rid="CR30">30</xref>] or through counting evidence for alternative isoforms in splice graphs [<xref ref-type="bibr" rid="CR31">31</xref>,<xref ref-type="bibr" rid="CR32">32</xref>]. In fact, the latest release version of <italic>DEXSeq</italic> now uses <italic>DESeq2</italic> as its inferential engine and so offers shrinkage estimation of dispersion and effect sizes for an exon-level analysis, too.</p>
    </sec>
    <sec id="Sec14">
      <title>Comparative benchmarks</title>
      <p>To assess how well <italic>DESeq2</italic> performs for standard analyses in comparison to other current methods, we used a combination of simulations and real data. The negative-binomial-based approaches compared were <italic>DESeq (old)</italic> [<xref ref-type="bibr" rid="CR4">4</xref>], <italic>edgeR</italic> [<xref ref-type="bibr" rid="CR33">33</xref>], <italic>edgeR</italic> with the robust option [<xref ref-type="bibr" rid="CR34">34</xref>], <italic>DSS</italic> [<xref ref-type="bibr" rid="CR6">6</xref>] and <italic>EBSeq</italic> [<xref ref-type="bibr" rid="CR35">35</xref>]. Other methods compared were the <italic>voom</italic> normalization method followed by linear modeling using the <italic>limma</italic> package [<xref ref-type="bibr" rid="CR36">36</xref>] and the <italic>SAMseq</italic> permutation method of the <italic>samr</italic> package [<xref ref-type="bibr" rid="CR24">24</xref>]. For the benchmarks using real data, the <italic>Cuffdiff 2</italic> [<xref ref-type="bibr" rid="CR28">28</xref>] method of the Cufflinks suite was included. For version numbers of the software used, see Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S3. For all algorithms returning <italic>P</italic> values, the <italic>P</italic> values from genes with non-zero sum of read counts across samples were adjusted using the Benjamini–Hochberg procedure [<xref ref-type="bibr" rid="CR21">21</xref>].</p>
      <sec id="Sec15">
        <title>Benchmarks through simulation</title>
        <p><bold>Sensitivity and precision</bold> We simulated datasets of 10,000 genes with negative binomial distributed counts. To simulate data with realistic moments, the mean and dispersions were drawn from the joint distribution of means and gene-wise dispersion estimates from the Pickrell <italic>et al.</italic> data, fitting only an intercept term. These datasets were of varying total sample size (<italic>m</italic>∈{6,8,10,20}), and the samples were split into two equal-sized groups; 80% of the simulated genes had no true differential expression, while for 20% of the genes, true fold changes of 2, 3 and 4 were used to generate counts across the two groups, with the direction of fold change chosen randomly. The simulated differentially expressed genes were chosen uniformly at random among all the genes, throughout the range of mean counts. MA-plots of the true fold changes used in the simulation and the observed fold changes induced by the simulation for one of the simulation settings are shown in Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S6.</p>
        <p>Algorithms’ performance in the simulation benchmark was assessed by their sensitivity and precision. The sensitivity was calculated as the fraction of genes with adjusted <italic>P</italic> value &lt;0.1 among the genes with true differences between group means. The precision was calculated as the fraction of genes with true differences between group means among those with adjusted <italic>P</italic> value &lt;0.1. The sensitivity is plotted over 1−precision, or the FDR, in Figure <xref rid="Fig6" ref-type="fig">6</xref>. <italic>DESeq2</italic>, and also <italic>edgeR</italic>, often had the highest sensitivity of the algorithms that controlled type-I error in the sense that the actual FDR was at or below 0.1, the threshold for adjusted <italic>P</italic> values used for calling differentially expressed genes. <italic>DESeq2</italic> had higher sensitivity compared to the other algorithms, particularly for small fold change (2 or 3), as was also found in benchmarks performed by Zhou <italic>et al.</italic> [<xref ref-type="bibr" rid="CR34">34</xref>]. For larger sample sizes and larger fold changes the performance of the various algorithms was more consistent.
<fig id="Fig6"><label>Figure 6</label><caption><p><bold>Sensitivity and precision of algorithms across combinations of sample size and effect size.</bold><italic>DESeq2</italic> and <italic>edgeR</italic> often had the highest sensitivity of those algorithms that controlled the FDR, i.e., those algorithms which fall on or to the left of the vertical black line. For a plot of sensitivity against false positive rate, rather than FDR, see Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S8, and for the dependence of sensitivity on the mean of counts, see Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S9. Note that <italic>EBSeq</italic> filters low-count genes (see main text for details).</p></caption><graphic xlink:href="13059_2014_550_Fig6_HTML" id="MO6"/></fig></p>
        <p>The overly conservative calling of the old <italic>DESeq</italic> tool can be observed, with reduced sensitivity compared to the other algorithms and an actual FDR less than the nominal value of 0.1. We note that <italic>EBSeq</italic> version 1.4.0 by default removes low-count genes – whose 75% quantile of normalized counts is less than ten – before calling differential expression. The sensitivity of algorithms on the simulated data across a range of the mean of counts are more closely compared in Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S9.</p>
        <p><bold>Outlier sensitivity</bold> We used simulations to compare the sensitivity and specificity of <italic>DESeq2</italic>’s outlier handling approach to that of <italic>edgeR</italic>, which was recently added to the software and published while this manuscript was under review. <italic>edgeR</italic> now includes an optional method to handle outliers by iteratively refitting the GLM after down-weighting potential outlier counts [<xref ref-type="bibr" rid="CR34">34</xref>]. The simulations, summarized in Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S10, indicated that both approaches to outliers nearly recover the performance on an outlier-free dataset, though <italic>edgeR-robust</italic> had slightly higher actual than nominal FDR, as seen in Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S11.</p>
        <p><bold>Precision of fold change estimates</bold> We benchmarked the <italic>DESeq2</italic> approach of using an empirical prior to achieve shrinkage of LFC estimates against two competing approaches: the <italic>GFOLD</italic> method, which can analyze experiments without replication [<xref ref-type="bibr" rid="CR20">20</xref>] and can also handle experiments with replicates, and the <italic>edgeR</italic> package, which provides a pseudocount-based shrinkage termed <italic>predictive LFCs</italic>. Results are summarized in Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figures S12–S16. <italic>DESeq2</italic> had consistently low root-mean-square error and mean absolute error across a range of sample sizes and models for a distribution of true LFCs. <italic>GFOLD</italic> had similarly low error to <italic>DESeq2</italic> over all genes; however, when focusing on differentially expressed genes, it performed worse for larger sample sizes. <italic>edgeR</italic> with default settings had similarly low error to <italic>DESeq2</italic> when focusing only on the differentially expressed genes, but had higher error over all genes.</p>
        <p><bold>Clustering</bold> We compared the performance of the rlog transformation against other methods of transformation or distance calculation in the recovery of simulated clusters. The adjusted Rand index [<xref ref-type="bibr" rid="CR37">37</xref>] was used to compare a hierarchical clustering based on various distances with the true cluster membership. We tested the Euclidean distance for normalized counts, logarithm of normalized counts plus a pseudocount of 1, rlog-transformed counts and VST counts. In addition we compared these Euclidean distances with the Poisson distance implemented in the <italic>PoiClaClu</italic> package [<xref ref-type="bibr" rid="CR38">38</xref>], and a distance implemented internally in the <italic>plotMDS</italic> function of <italic>edgeR</italic> (though not the default distance, which is similar to the logarithm of normalized counts). The results, shown in Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S17, revealed that when the size factors were equal for all samples, the Poisson distance and the Euclidean distance of rlog-transformed or VST counts outperformed other methods. However, when the size factors were not equal across samples, the rlog approach generally outperformed the other methods. Finally, we note that the rlog transformation provides normalized data, which can be used for a variety of applications, of which distance calculation is one.</p>
      </sec>
      <sec id="Sec16">
        <title>Benchmark for RNA sequencing data</title>
        <p>While simulation is useful to verify how well an algorithm behaves with idealized theoretical data, and hence can verify that the algorithm performs as expected under its own assumptions, simulations cannot inform us how well the theory fits reality. With RNA-seq data, there is the complication of not knowing fully or directly the underlying truth; however, we can work around this limitation by using more indirect inference, explained below.</p>
        <p>In the following benchmarks, we considered three performance metrics for differential expression calling: the false positive rate (or 1 minus the specificity), sensitivity and precision. We can obtain meaningful estimates of specificity from looking at datasets where we believe all genes fall under the null hypothesis of no differential expression [<xref ref-type="bibr" rid="CR39">39</xref>]. Sensitivity and precision are more difficult to estimate, as they require independent knowledge of those genes that are differentially expressed. To circumvent this problem, we used experimental reproducibility on independent samples (though from the same dataset) as a proxy. We used a dataset with large numbers of replicates in both of two groups, where we expect that truly differentially expressed genes exist. We repeatedly split this dataset into an evaluation set and a larger verification set, and compared the calls from the evaluation set with the calls from the verification set, which were taken as truth. It is important to keep in mind that the calls from the verification set are only an approximation of the true differential state, and the approximation error has a systematic and a stochastic component. The stochastic error becomes small once the sample size of the verification set is large enough. For the systematic errors, our benchmark assumes that these affect all algorithms more or less equally and do not markedly change the ranking of the algorithms.</p>
        <p><bold>False positive rate</bold> To evaluate the false positive rate of the algorithms, we considered mock comparisons from a dataset with many samples and no known condition dividing the samples into distinct groups. We used the RNA-seq data of Pickrell <italic>et al.</italic> [<xref ref-type="bibr" rid="CR17">17</xref>] for lymphoblastoid cell lines derived from unrelated Nigerian individuals. We chose a set of 26 RNA-seq samples of the same read length (46 base pairs) from male individuals. We randomly drew without replacement ten samples from the set to compare five against five, and this process was repeated 30 times. We estimated the false positive rate associated with a critical value of 0.01 by dividing the number of <italic>P</italic> values less than 0.01 by the total number of tests; genes with zero sum of read counts across samples were excluded. The results over the 30 replications, summarized in Figure <xref rid="Fig7" ref-type="fig">7</xref>, indicated that all algorithms generally controlled the number of false positives. <italic>DESeq (old)</italic> and <italic>Cuffdiff 2</italic> appeared overly conservative in this analysis, not using up their type-I error budget.
<fig id="Fig7"><label>Figure 7</label><caption><p><bold>Benchmark of false positive calling.</bold> Shown are estimates of <italic>P</italic>(<italic>P</italic> value&lt;0.01) under the null hypothesis. The FPR is the number of <italic>P</italic> values less than 0.01 divided by the total number of tests, from randomly selected comparisons of five vs five samples from the Pickrell <italic>et al.</italic> [<xref ref-type="bibr" rid="CR17">17</xref>] dataset, with no known condition dividing the samples. Type-I error control requires that the tool does not substantially exceed the nominal value of 0.01 (black line). <italic>EBSeq</italic> results were not included in this plot as it returns posterior probabilities, which unlike <italic>P</italic> values are not expected to be uniformly distributed under the null hypothesis. FPR, false positive rate.</p></caption><graphic xlink:href="13059_2014_550_Fig7_HTML" id="MO7"/></fig></p>
        <p><bold>Sensitivity</bold> To obtain an impression of the sensitivity of the algorithms, we considered the Bottomly <italic>et al.</italic> [<xref ref-type="bibr" rid="CR16">16</xref>] dataset, which contains ten and eleven replicates of two different, genetically homogeneous mice strains. This allowed for a split of three vs three for the evaluation set and seven vs eight for the verification set, which were balanced across the three experimental batches. Random splits were replicated 30 times. Batch information was not provided to the <italic>DESeq (old)</italic>, <italic>DESeq2</italic>, <italic>DSS</italic>, <italic>edgeR</italic> or <italic>voom</italic> algorithms, which can accommodate complex experimental designs, to have comparable calls across all algorithms.</p>
        <p>We rotated though each algorithm to determine the calls of the verification set. For a given algorithm’s verification set calls, we tested the evaluation set calls of every algorithm. We used this approach rather than a consensus-based method, as we did not want to favor or disfavor any particular algorithm or group of algorithms. Sensitivity was calculated as in the simulation benchmark, now with true differential expression defined by an adjusted <italic>P</italic> value &lt;0.1 in the larger verification set, as diagrammed in Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S18. Figure <xref rid="Fig8" ref-type="fig">8</xref> displays the estimates of sensitivity for each algorithm pair.
<fig id="Fig8"><label>Figure 8</label><caption><p><bold>Sensitivity estimated from experimental reproducibility.</bold> Each algorithm’s sensitivity in the evaluation set (box plots) is evaluated using the calls of each other algorithm in the verification set (panels with grey label).</p></caption><graphic xlink:href="13059_2014_550_Fig8_HTML" id="MO8"/></fig></p>
        <p>The ranking of algorithms was generally consistent regardless of which algorithm was chosen to determine calls in the verification set. <italic>DESeq2</italic> had comparable sensitivity to <italic>edgeR</italic> and <italic>voom</italic> though less than <italic>DSS</italic>. The median sensitivity estimates were typically between 0.2 and 0.4 for all algorithms. That all algorithms had relatively low median sensitivity can be explained by the small sample size of the evaluation set and the fact that increasing the sample size in the verification set increases power. It was expected that the permutation-based <italic>SAMseq</italic> method would rarely produce adjusted <italic>P</italic> value &lt;0.1 in the evaluation set, because the three vs three comparison does not enable enough permutations.</p>
        <p><bold>Precision</bold> Another important consideration from the perspective of an investigator is the precision, or fraction of true positives in the set of genes which pass the adjusted <italic>P</italic> value threshold. This can also be reported as 1−FDR. Again, ‘true’ differential expression was defined by an adjusted <italic>P</italic> value &lt;0.1 in the larger verification set. The estimates of precision are displayed in Figure <xref rid="Fig9" ref-type="fig">9</xref>, where we can see that <italic>DESeq2</italic> often had the second highest median precision, behind <italic>DESeq (old)</italic>. We can also see that algorithms with higher median sensitivity, e.g., <italic>DSS</italic>, were generally associated here with lower median precision. The rankings differed significantly when <italic>Cuffdiff 2</italic> was used to determine the verification set calls. This is likely due to the additional steps <italic>Cuffdiff 2</italic> performed to deconvolve changes in isoform-level abundance from gene-level abundance, which apparently came at the cost of lower precision when compared against its own verification set calls.
<fig id="Fig9"><label>Figure 9</label><caption><p><bold>Precision estimated from experimental reproducibility.</bold> Each algorithm’s precision in the evaluation set (box plots) is evaluated using the calls of each other algorithm in the verification set (panels with grey label).</p></caption><graphic xlink:href="13059_2014_550_Fig9_HTML" id="MO9"/></fig></p>
        <p>To compare the sensitivity and precision results further, we calculated the precision of algorithms along a grid of nominal adjusted <italic>P</italic> values (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S19). We then found the nominal adjusted <italic>P</italic> value for each algorithm, which resulted in a median actual precision of 0.9 (FDR = 0.1). Having thus calibrated each algorithm to a target FDR, we evaluated the sensitivity of calling, as shown in Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S20. As expected, here the algorithms performed more similarly to each other. This analysis revealed that, for a given target precision, <italic>DESeq2</italic> often was among the top algorithms by median sensitivity, though the variability across random replicates was larger than the differences between algorithms.</p>
        <p>The absolute number of calls for the evaluation and verification sets can be seen in Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figures S21 and S22, which mostly matched the order seen in the sensitivity plot of Figure <xref rid="Fig8" ref-type="fig">8</xref>. Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figures S23 and S24 provide heat maps and clustering based on the Jaccard index of calls for one replicate of the evaluation and verification sets, indicating a large overlap of calls across the different algorithms.</p>
        <p>In summary, the benchmarking tests showed that <italic>DESeq2</italic> effectively controlled type-I errors, maintaining a median false positive rate just below the chosen critical value in a mock comparison of groups of samples randomly chosen from a larger pool. For both simulation and analysis of real data, <italic>DESeq2</italic> often achieved the highest sensitivity of those algorithms that controlled the FDR.</p>
      </sec>
    </sec>
  </sec>
  <sec id="Sec17" sec-type="conclusion">
    <title>Conclusions</title>
    <p><italic>DESeq2</italic> offers a comprehensive and general solution for gene-level analysis of RNA-seq data. Shrinkage estimators substantially improve the stability and reproducibility of analysis results compared to maximum-likelihood-based solutions. Empirical Bayes priors provide automatic control of the amount of shrinkage based on the amount of information for the estimated quantity available in the data. This allows <italic>DESeq2</italic> to offer consistent performance over a large range of data types and makes it applicable for small studies with few replicates as well as for large observational studies. <italic>DESeq2</italic>’s heuristics for outlier detection help to recognize genes for which the modeling assumptions are unsuitable and so avoids type-I errors caused by these. The embedding of these strategies in the framework of GLMs enables the treatment of both simple and complex designs.</p>
    <p>A critical advance is the shrinkage estimator for fold changes for differential expression analysis, which offers a sound and statistically well-founded solution to the practically relevant problem of comparing fold change across the wide dynamic range of RNA-seq experiments. This is of value for many downstream analysis tasks, including the ranking of genes for follow-up studies and association of fold changes with other variables of interest. In addition, the rlog transformation, which implements shrinkage of fold changes on a per-sample basis, facilitates visualization of differences, for example in heat maps, and enables the application of a wide range of techniques that require homoskedastic input data, including machine-learning or ordination techniques such as principal component analysis and clustering.</p>
    <p><italic>DESeq2</italic> hence offers to practitioners a wide set of features with state-of-the-art inferential power. Its use cases are not limited to RNA-seq data or other transcriptomics assays; rather, many kinds of high-throughput count data can be used. Other areas for which <italic>DESeq</italic> or <italic>DESeq2</italic> have been used include chromatin immunoprecipitation sequencing assays (e.g., [<xref ref-type="bibr" rid="CR40">40</xref>]; see also the <italic>DiffBind</italic> package [<xref ref-type="bibr" rid="CR41">41</xref>,<xref ref-type="bibr" rid="CR42">42</xref>]), barcode-based assays (e.g., [<xref ref-type="bibr" rid="CR43">43</xref>]), metagenomics data (e.g., [<xref ref-type="bibr" rid="CR44">44</xref>]), ribosome profiling [<xref ref-type="bibr" rid="CR45">45</xref>] and CRISPR/Cas-library assays [<xref ref-type="bibr" rid="CR46">46</xref>]. Finally, the <italic>DESeq2</italic> package is integrated well in the Bioconductor infrastructure [<xref ref-type="bibr" rid="CR11">11</xref>] and comes with extensive documentation, including a vignette that demonstrates a complete analysis step by step and discusses advanced use cases.</p>
  </sec>
  <sec id="Sec18" sec-type="materials|methods">
    <title>Materials and methods</title>
    <p>A summary of the notation used in the following section is provided in Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S1.</p>
    <sec id="Sec19">
      <title>Model and normalization</title>
      <p>The read count <italic>K</italic><sub><italic>ij</italic></sub> for gene <italic>i</italic> in sample <italic>j</italic> is described with a GLM of the negative binomial family with a logarithmic link:
<disp-formula id="Equ1"><label>(1)</label><alternatives><tex-math id="M13">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
							 $$ \begin{aligned} K_{ij} &amp; \sim \text{NB}(\text{mean} = \mu_{ij}, \text{dispersion} = \alpha_{i})  \\ \mu_{ij} &amp;= s_{ij} q_{ij} \\ \end{aligned}  $$ 
						\end{document}</tex-math><mml:math id="M14"><mml:mtable><mml:mtr><mml:mtd><mml:msub><mml:mrow><mml:mi>K</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ij</mml:mtext></mml:mrow></mml:msub></mml:mtd><mml:mtd><mml:mo>∼</mml:mo><mml:mtext>NB</mml:mtext><mml:mo>(</mml:mo><mml:mtext>mean</mml:mtext><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ij</mml:mtext></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mtext>dispersion</mml:mtext><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msub><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ij</mml:mtext></mml:mrow></mml:msub></mml:mtd><mml:mtd><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ij</mml:mtext></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>q</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ij</mml:mtext></mml:mrow></mml:msub></mml:mtd></mml:mtr><mml:mtr/></mml:mtable></mml:math><graphic xlink:href="13059_2014_550_Article_Equ1.gif" position="anchor"/></alternatives></disp-formula></p>
      <p>
        <disp-formula id="Equ2">
          <label>(2)</label>
          <alternatives>
            <tex-math id="M15">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
							 $$ \log q_{ij} = \sum_{r} x_{jr} \beta_{ir}.   $$ 
						\end{document}</tex-math>
            <mml:math id="M16">
              <mml:mo>log</mml:mo>
              <mml:msub>
                <mml:mrow>
                  <mml:mi>q</mml:mi>
                </mml:mrow>
                <mml:mrow>
                  <mml:mtext mathvariant="italic">ij</mml:mtext>
                </mml:mrow>
              </mml:msub>
              <mml:mo>=</mml:mo>
              <mml:munder>
                <mml:mrow>
                  <mml:mo>∑</mml:mo>
                </mml:mrow>
                <mml:mrow>
                  <mml:mi>r</mml:mi>
                </mml:mrow>
              </mml:munder>
              <mml:msub>
                <mml:mrow>
                  <mml:mi>x</mml:mi>
                </mml:mrow>
                <mml:mrow>
                  <mml:mtext mathvariant="italic">jr</mml:mtext>
                </mml:mrow>
              </mml:msub>
              <mml:msub>
                <mml:mrow>
                  <mml:mi>β</mml:mi>
                </mml:mrow>
                <mml:mrow>
                  <mml:mtext mathvariant="italic">ir</mml:mtext>
                </mml:mrow>
              </mml:msub>
              <mml:mi>.</mml:mi>
            </mml:math>
            <graphic xlink:href="13059_2014_550_Article_Equ2.gif" position="anchor"/>
          </alternatives>
        </disp-formula>
      </p>
      <p>For notational simplicity, the equations here use the natural logarithm as the link function, though the <italic>DESeq2</italic> software reports estimated model coefficients and their estimated standard errors on the log2 scale.</p>
      <p>By default, the normalization constants <italic>s</italic><sub><italic>ij</italic></sub> are considered constant within a sample, <italic>s</italic><sub><italic>ij</italic></sub>=<italic>s</italic><sub><italic>j</italic></sub>, and are estimated with the median-of-ratios method previously described and used in <italic>DESeq</italic> [<xref ref-type="bibr" rid="CR4">4</xref>] and <italic>DEXSeq</italic> [<xref ref-type="bibr" rid="CR30">30</xref>]:
<disp-formula id="Equa"><alternatives><tex-math id="M17">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
							 $$s_{j} = {\underset{i:\,K_{i}^{\text{R}}\neq 0}{\text{median}}}\, \frac{K_{ij}}{K^{\text{R}}_{i}}\quad\text{with}\quad K^{\text{R}}_{i} = \left(\prod\limits_{j=1}^{m} K_{ij}\right)^{1/m}. $$ 
						\end{document}</tex-math><mml:math id="M18"><mml:mrow><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:munder><mml:mrow><mml:mtext>median</mml:mtext></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>:</mml:mo><mml:mspace width="0.3em"/><mml:msubsup><mml:mrow><mml:mi>K</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mtext>R</mml:mtext></mml:mrow></mml:msubsup><mml:mo>≠</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:munder><mml:mspace width="0.3em"/><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi>K</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ij</mml:mtext></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msubsup><mml:mrow><mml:mi>K</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mtext>R</mml:mtext></mml:mrow></mml:msubsup></mml:mrow></mml:mfrac><mml:mspace width="1em"/><mml:mtext>with</mml:mtext><mml:mspace width="1em"/><mml:msubsup><mml:mrow><mml:mi>K</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mtext>R</mml:mtext></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:munderover accent="false" accentunder="false"><mml:mrow><mml:mo mathsize="big">∏</mml:mo></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:munderover><mml:msub><mml:mrow><mml:mi>K</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ij</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:mi>m</mml:mi></mml:mrow></mml:msup><mml:mi>.</mml:mi></mml:mrow></mml:math><graphic xlink:href="13059_2014_550_Article_Equa.gif" position="anchor"/></alternatives></disp-formula></p>
      <p>Alternatively, the user can supply normalization constants <italic>s</italic><sub><italic>ij</italic></sub> calculated using other methods (e.g., using <italic>cqn</italic> [<xref ref-type="bibr" rid="CR13">13</xref>] or <italic>EDASeq</italic> [<xref ref-type="bibr" rid="CR14">14</xref>]), which may differ from gene to gene.</p>
    </sec>
    <sec id="Sec20">
      <title>Expanded design matrices</title>
      <p>For consistency with our software’s documentation, in the following text we will use the terminology of the <italic>R</italic> statistical language. In linear modeling, a categorical variable or <italic>factor</italic> can take on two or more values or <italic>levels</italic>. In standard design matrices, one of the values is chosen as a reference value or <italic>base level</italic> and absorbed into the intercept. In standard GLMs, the choice of base level does not influence the values of contrasts (LFCs). This, however, is no longer the case in our approach using ridge-regression-like shrinkage on the coefficients (described below), when factors with more than two levels are present in the design matrix, because the base level will not undergo shrinkage while the other levels do.</p>
      <p>To recover the desirable symmetry between all levels, <italic>DESeq2</italic> uses <italic>expanded design matrices</italic>, which include an indicator variable for <italic>each</italic> level of each factor, in addition to an intercept column (i.e., none of the levels is absorbed into the intercept). While such a design matrix no longer has full rank, a unique solution exists because the zero-centered prior distribution (see below) provides regularization. For dispersion estimation and for estimating the width of the LFC prior, standard design matrices are used.</p>
    </sec>
    <sec id="Sec21">
      <title>Contrasts</title>
      <p>Contrasts between levels and standard errors of such contrasts can be calculated as they would in the standard design matrix case, i.e., using:
<disp-formula id="Equ3"><label>(3)</label><alternatives><tex-math id="M19">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
							 $$ {\beta_{i}^{c}} = \vec{c}\,^{t} \vec{\beta_{i}}   $$ 
						\end{document}</tex-math><mml:math id="M20"><mml:msubsup><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>c</mml:mi></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mover accent="true"><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mo>→</mml:mo></mml:mover><mml:msup><mml:mrow><mml:mspace width="0.3em"/></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msup><mml:mover accent="true"><mml:mrow><mml:msub><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>→</mml:mo></mml:mover></mml:math><graphic xlink:href="13059_2014_550_Article_Equ3.gif" position="anchor"/></alternatives></disp-formula></p>
      <p>
        <disp-formula id="Equ4">
          <label>(4)</label>
          <alternatives>
            <tex-math id="M21">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
							 $$ \text{SE}\left({\beta_{i}^{c}}\right) = \sqrt{\vec{c}\,^{t} \Sigma_{i} \vec{c}},   $$ 
						\end{document}</tex-math>
            <mml:math id="M22">
              <mml:mtext>SE</mml:mtext>
              <mml:mfenced close=")" open="(" separators="">
                <mml:mrow>
                  <mml:msubsup>
                    <mml:mrow>
                      <mml:mi>β</mml:mi>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mi>i</mml:mi>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mi>c</mml:mi>
                    </mml:mrow>
                  </mml:msubsup>
                </mml:mrow>
              </mml:mfenced>
              <mml:mo>=</mml:mo>
              <mml:msqrt>
                <mml:mrow>
                  <mml:mover accent="true">
                    <mml:mrow>
                      <mml:mi>c</mml:mi>
                    </mml:mrow>
                    <mml:mo>→</mml:mo>
                  </mml:mover>
                  <mml:msup>
                    <mml:mrow>
                      <mml:mspace width="0.3em"/>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mi>t</mml:mi>
                    </mml:mrow>
                  </mml:msup>
                  <mml:msub>
                    <mml:mrow>
                      <mml:mi>Σ</mml:mi>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mi>i</mml:mi>
                    </mml:mrow>
                  </mml:msub>
                  <mml:mover accent="true">
                    <mml:mrow>
                      <mml:mi>c</mml:mi>
                    </mml:mrow>
                    <mml:mo>→</mml:mo>
                  </mml:mover>
                </mml:mrow>
              </mml:msqrt>
              <mml:mo>,</mml:mo>
            </mml:math>
            <graphic xlink:href="13059_2014_550_Article_Equ4.gif" position="anchor"/>
          </alternatives>
        </disp-formula>
      </p>
      <p>where <inline-formula id="IEq7"><alternatives><tex-math id="M23">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
							$\vec {c}$
						\end{document}</tex-math><mml:math id="M24"><mml:mover accent="true"><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mo>→</mml:mo></mml:mover></mml:math><inline-graphic xlink:href="13059_2014_550_Article_IEq7.gif"/></alternatives></inline-formula> represents a numeric contrast, e.g., 1 and −1 specifying the numerator and denominator of a simple two-level contrast, and <inline-formula id="IEq8"><alternatives><tex-math id="M25">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
							$\Sigma _{i} = \text {Cov}(\vec \beta _{i})$
						\end{document}</tex-math><mml:math id="M26"><mml:msub><mml:mrow><mml:mi>Σ</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mtext>Cov</mml:mtext><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mo>→</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:math><inline-graphic xlink:href="13059_2014_550_Article_IEq8.gif"/></alternatives></inline-formula>, defined below.</p>
    </sec>
    <sec id="Sec22">
      <title>Estimation of dispersions</title>
      <p>We assume the dispersion parameter <italic>α</italic><sub><italic>i</italic></sub> follows a log-normal prior distribution that is centered around a trend that depends on the gene’s mean normalized read count:
<disp-formula id="Equ5"><label>(5)</label><alternatives><tex-math id="M27">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
							 $$ \log \alpha_{i} \sim N\!\left(\log \alpha_{\text{tr}}(\bar\mu_{i}), \, \sigma_{\text{d}}^{2} \right).   $$ 
						\end{document}</tex-math><mml:math id="M28"><mml:mo>log</mml:mo><mml:msub><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>∼</mml:mo><mml:mi>N</mml:mi><mml:mspace width="0.3em"/><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mo>log</mml:mo><mml:msub><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mtext>tr</mml:mtext></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mo>¯</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo><mml:mo>,</mml:mo><mml:mspace width="0.3em"/><mml:msubsup><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mtext>d</mml:mtext></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:mrow></mml:mfenced><mml:mi>.</mml:mi></mml:math><graphic xlink:href="13059_2014_550_Article_Equ5.gif" position="anchor"/></alternatives></disp-formula></p>
      <p>Here, <italic>α</italic><sub>tr</sub> is a function of the gene’s mean normalized count,
<disp-formula id="Equb"><alternatives><tex-math id="M29">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
							 $$\bar{\mu}_{i} = \frac{1}{m} \sum\limits_{j} \frac{K_{ij}}{s_{ij}}. $$ 
						\end{document}</tex-math><mml:math id="M30"><mml:mrow><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mo>¯</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:mfrac><mml:munder><mml:mrow><mml:mo mathsize="big">∑</mml:mo></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:munder><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi>K</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ij</mml:mtext></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ij</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:mi>.</mml:mi></mml:mrow></mml:math><graphic xlink:href="13059_2014_550_Article_Equb.gif" position="anchor"/></alternatives></disp-formula> It describes the mean-dependent expectation of the prior. <italic>σ</italic><sub>d</sub> is the width of the prior, a hyperparameter describing how much the individual genes’ true dispersions scatter around the trend. For the trend function, we use the same parametrization as we used for <italic>DEXSeq</italic> [<xref ref-type="bibr" rid="CR30">30</xref>], namely,
<disp-formula id="Equ6"><label>(6)</label><alternatives><tex-math id="M31">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
							 $$ \alpha_{\text{tr}}(\bar{\mu}) = \frac{a_{1}}{\bar{\mu}} + \alpha_{0}.   $$ 
						\end{document}</tex-math><mml:math id="M32"><mml:msub><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mtext>tr</mml:mtext></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mover accent="true"><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mo>¯</mml:mo></mml:mover><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi>a</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mo>¯</mml:mo></mml:mover></mml:mrow></mml:mfrac><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mi>.</mml:mi></mml:math><graphic xlink:href="13059_2014_550_Article_Equ6.gif" position="anchor"/></alternatives></disp-formula></p>
      <p>We get final dispersion estimates from this model in three steps, which implement a computationally fast approximation to a full empirical Bayes treatment. We first use the count data for each gene separately to get preliminary gene-wise dispersion estimates <inline-formula id="IEq9"><alternatives><tex-math id="M33">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
							$\alpha ^{\text {gw}}_{i}$
						\end{document}</tex-math><mml:math id="M34"><mml:msubsup><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mtext>gw</mml:mtext></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2014_550_Article_IEq9.gif"/></alternatives></inline-formula> by maximum-likelihood estimation. Then, we fit the dispersion trend <italic>α</italic><sub>tr</sub>. Finally, we combine the likelihood with the trended prior to get maximum <italic>a posteriori</italic> (MAP) values as final dispersion estimates. Details for the three steps follow.</p>
      <p><bold>Gene-wise dispersion estimates</bold> To get a gene-wise dispersion estimate for a gene <italic>i</italic>, we start by fitting a negative binomial GLM without an LFC prior for the design matrix <italic>X</italic> to the gene’s count data. This GLM uses a rough method-of-moments estimate of dispersion, based on the within-group variances and means. The initial GLM is necessary to obtain an initial set of fitted values, <inline-formula id="IEq10"><alternatives><tex-math id="M35">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
							$\hat \mu _{\textit {ij}}^{0}$
						\end{document}</tex-math><mml:math id="M36"><mml:msubsup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ij</mml:mtext></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2014_550_Article_IEq10.gif"/></alternatives></inline-formula>. We then maximize the Cox–Reid adjusted likelihood of the dispersion, conditioned on the fitted values <inline-formula id="IEq11"><alternatives><tex-math id="M37">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
							$\hat \mu _{\textit {ij}}^{0}$
						\end{document}</tex-math><mml:math id="M38"><mml:msubsup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ij</mml:mtext></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2014_550_Article_IEq11.gif"/></alternatives></inline-formula> from the initial fit, to obtain the gene-wise estimate <inline-formula id="IEq12"><alternatives><tex-math id="M39">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
							$\alpha ^{\text {gw}}_{i}$
						\end{document}</tex-math><mml:math id="M40"><mml:msubsup><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mtext>gw</mml:mtext></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2014_550_Article_IEq12.gif"/></alternatives></inline-formula>, i.e.,
<disp-formula id="Equc"><alternatives><tex-math id="M41">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
							 $$\alpha^{\text{gw}}_{i} = {\underset{\alpha}{\text{arg max}}}\; \ell_{\text{CR}}\left(\alpha; \vec\mu_{\textit{i}\cdot}^{0}, \vec K_{\textit{i}\cdot}\right) $$ 
						\end{document}</tex-math><mml:math id="M42"><mml:mrow><mml:msubsup><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mtext>gw</mml:mtext></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:munder><mml:mrow><mml:mtext>arg max</mml:mtext></mml:mrow><mml:mrow><mml:mi>α</mml:mi></mml:mrow></mml:munder><mml:mspace width="2.77626pt"/><mml:msub><mml:mrow><mml:mi>ℓ</mml:mi></mml:mrow><mml:mrow><mml:mtext>CR</mml:mtext></mml:mrow></mml:msub><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mi>α</mml:mi><mml:mo>;</mml:mo><mml:msubsup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mo>→</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">i</mml:mtext><mml:mo>·</mml:mo></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>K</mml:mi></mml:mrow><mml:mo>→</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">i</mml:mtext><mml:mo>·</mml:mo></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:mrow></mml:math><graphic xlink:href="13059_2014_550_Article_Equc.gif" position="anchor"/></alternatives></disp-formula> with
<disp-formula id="Equ7"><label>(7)</label><alternatives><tex-math id="M43">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
							 $$ \begin{aligned} \ell_{\text{CR}}(\alpha; \vec\mu, \vec K) &amp;= \ell(\alpha) - \frac{1}{2} \log\left(\det\left(X^{t} W X\right) \right)  \\ \ell(\alpha) &amp;= \sum\limits_{j} \log f_{\text{NB}}(K_{j}; \mu_{j}, \alpha), \end{aligned}  $$ 
						\end{document}</tex-math><mml:math id="M44"><mml:mtable><mml:mtr><mml:mtd><mml:msub><mml:mrow><mml:mi>ℓ</mml:mi></mml:mrow><mml:mrow><mml:mtext>CR</mml:mtext></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mi>α</mml:mi><mml:mo>;</mml:mo><mml:mover accent="true"><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mo>→</mml:mo></mml:mover><mml:mo>,</mml:mo><mml:mover accent="true"><mml:mrow><mml:mi>K</mml:mi></mml:mrow><mml:mo>→</mml:mo></mml:mover><mml:mo>)</mml:mo></mml:mtd><mml:mtd><mml:mo>=</mml:mo><mml:mi>ℓ</mml:mi><mml:mo>(</mml:mo><mml:mi>α</mml:mi><mml:mo>)</mml:mo><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:mfrac><mml:mo>log</mml:mo><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mo>det</mml:mo><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msup><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msup><mml:mtext mathvariant="italic">WX</mml:mtext></mml:mrow></mml:mfenced></mml:mrow></mml:mfenced></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mi>ℓ</mml:mi><mml:mo>(</mml:mo><mml:mi>α</mml:mi><mml:mo>)</mml:mo></mml:mtd><mml:mtd><mml:mo>=</mml:mo><mml:munder><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:munder><mml:mo>log</mml:mo><mml:msub><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mtext>NB</mml:mtext></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>K</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>;</mml:mo><mml:msub><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>α</mml:mi><mml:mo>)</mml:mo><mml:mo>,</mml:mo></mml:mtd></mml:mtr></mml:mtable></mml:math><graphic xlink:href="13059_2014_550_Article_Equ7.gif" position="anchor"/></alternatives></disp-formula></p>
      <p>where <italic>f</italic><sub>NB</sub>(<italic>k</italic>;<italic>μ</italic>,<italic>α</italic>) is the probability mass function of the negative binomial distribution with mean <italic>μ</italic> and dispersion <italic>α</italic>, and the second term provides the Cox–Reid bias adjustment [<xref ref-type="bibr" rid="CR47">47</xref>]. This adjustment, first used in the context of dispersion estimation for SAGE data [<xref ref-type="bibr" rid="CR48">48</xref>] and then for HTS data [<xref ref-type="bibr" rid="CR3">3</xref>] in <italic>edgeR</italic>, corrects for the negative bias of dispersion estimates from using the MLEs for the fitted values <inline-formula id="IEq13"><alternatives><tex-math id="M45">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
							$\hat \mu _{\textit {ij}}^{0}$
						\end{document}</tex-math><mml:math id="M46"><mml:msubsup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ij</mml:mtext></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2014_550_Article_IEq13.gif"/></alternatives></inline-formula> (analogous to Bessel’s correction in the usual sample variance formula; for details, see [<xref ref-type="bibr" rid="CR49">49</xref>], Section 10.6). It is formed from the Fisher information for the fitted values, which is here calculated as det(<italic>X</italic><sup><italic>t</italic></sup><italic>W</italic><italic>X</italic>), where <italic>W</italic> is the diagonal weight matrix from the standard iteratively reweighted least-squares algorithm. As the GLM’s link function is <italic>g</italic>(<italic>μ</italic>)= log(<italic>μ</italic>) and its variance function is <italic>V</italic>(<italic>μ</italic>;<italic>α</italic>)=<italic>μ</italic>+<italic>α</italic><italic>μ</italic><sup>2</sup>, the elements of the diagonal matrix <italic>W</italic><sub><italic>i</italic></sub> are given by:
<disp-formula id="Equd"><alternatives><tex-math id="M47">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
							 $$w_{jj} = \frac{1}{g^{\prime}(\mu_{j})^{2} V(\mu_{j})} = \frac{1}{1/\mu_{j} + \alpha}. $$ 
						\end{document}</tex-math><mml:math id="M48"><mml:mrow><mml:msub><mml:mrow><mml:mi>w</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">jj</mml:mtext></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:mi>g</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mi>V</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:msub><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mi>α</mml:mi></mml:mrow></mml:mfrac><mml:mi>.</mml:mi></mml:mrow></mml:math><graphic xlink:href="13059_2014_550_Article_Equd.gif" position="anchor"/></alternatives></disp-formula></p>
      <p>The optimization in Equation (<xref rid="Equ7" ref-type="">7</xref>) is performed on the scale of log<italic>α</italic> using a backtracking line search with accepted proposals that satisfy Armijo conditions [<xref ref-type="bibr" rid="CR50">50</xref>].</p>
      <p><bold>Dispersion trend</bold> A parametric curve of the form (<xref rid="Equ6" ref-type="">6</xref>) is fit by regressing the gene-wise dispersion estimates <inline-formula id="IEq14"><alternatives><tex-math id="M49">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
							$\alpha ^{\text {gw}}_{i}$
						\end{document}</tex-math><mml:math id="M50"><mml:msubsup><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mtext>gw</mml:mtext></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2014_550_Article_IEq14.gif"/></alternatives></inline-formula> onto the means of the normalized counts, <inline-formula id="IEq15"><alternatives><tex-math id="M51">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
							$\bar {\mu }_{i}$
						\end{document}</tex-math><mml:math id="M52"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mo>¯</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13059_2014_550_Article_IEq15.gif"/></alternatives></inline-formula>. The sampling distribution of the gene-wise dispersion estimate around the true value <italic>α</italic><sub><italic>i</italic></sub> can be highly skewed, and therefore we do not use ordinary least-squares regression but rather gamma-family GLM regression. Furthermore, dispersion outliers could skew the fit and hence a scheme to exclude such outliers is used.</p>
      <p>The hyperparameters <italic>a</italic><sub>1</sub> and <italic>α</italic><sub>0</sub> of (<xref rid="Equ6" ref-type="">6</xref>) are obtained by iteratively fitting a gamma-family GLM. At each iteration, genes with a ratio of dispersion to fitted value outside the range [10<sup>−4</sup>,15] are left out until the sum of squared LFCs of the new coefficients over the old coefficients is less than 10<sup>−6</sup> (same approach as in <italic>DEXSeq</italic> [<xref ref-type="bibr" rid="CR30">30</xref>]).</p>
      <p>The parametrization (<xref rid="Equ6" ref-type="">6</xref>) is based on reports by us and others of decreasing dependence of dispersion on the mean in many datasets [<xref ref-type="bibr" rid="CR3">3</xref>-<xref ref-type="bibr" rid="CR6">6</xref>,<xref ref-type="bibr" rid="CR51">51</xref>]. Some caution is warranted to disentangle true underlying dependence from effects of estimation bias that can create a perceived dependence of the dispersion on the mean. Consider a negative binomial distributed random variable with expectation <italic>μ</italic> and dispersion <italic>α</italic>. Its variance <italic>v</italic>=<italic>μ</italic>+<italic>α</italic><italic>μ</italic><sup>2</sup> has two components, <italic>v</italic>=<italic>v</italic><sub>P</sub>+<italic>v</italic><sub>D</sub>, the Poisson component <italic>v</italic><sub>P</sub>=<italic>μ</italic> independent of <italic>α</italic>, and the overdispersion component <italic>v</italic><sub>D</sub>=<italic>α</italic><italic>μ</italic><sup>2</sup>. When <italic>μ</italic> is small, <italic>μ</italic>≲1/<italic>α</italic> (vertical lines in Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S1), the Poisson component dominates, in the sense that <inline-formula id="IEq16"><alternatives><tex-math id="M53">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
							$v_{\text {P}}/v_{\text {D}} = 1/(\alpha \mu) \gtrsim 1$
						\end{document}</tex-math><mml:math id="M54"><mml:msub><mml:mrow><mml:mi>v</mml:mi></mml:mrow><mml:mrow><mml:mtext>P</mml:mtext></mml:mrow></mml:msub><mml:mo>/</mml:mo><mml:msub><mml:mrow><mml:mi>v</mml:mi></mml:mrow><mml:mrow><mml:mtext>D</mml:mtext></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:mo>(</mml:mo><mml:mi>αμ</mml:mi><mml:mo>)</mml:mo><mml:mo>≳</mml:mo><mml:mn>1</mml:mn></mml:math><inline-graphic xlink:href="13059_2014_550_Article_IEq16.gif"/></alternatives></inline-formula>, and the observed data provide little information on the value of <italic>α</italic>. Therefore the sampling variance of an estimator for <italic>α</italic> will be large when <italic>μ</italic>≲1/<italic>α</italic>, which leads to the appearance of bias. For simplicity, we have stated the above argument without regard to the influence of the size factors, <italic>s</italic><sub><italic>j</italic></sub>, on the value of <italic>μ</italic>. This is permissible because, by construction, the geometric mean of our size factors is close to 1, and hence, the mean across samples of the unnormalized read counts, <inline-formula id="IEq17"><alternatives><tex-math id="M55">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
							$\frac {1}{m}\sum _{j} K_{\textit {ij}}$
						\end{document}</tex-math><mml:math id="M56"><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:mfrac><mml:munder><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:munder><mml:msub><mml:mrow><mml:mi>K</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ij</mml:mtext></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13059_2014_550_Article_IEq17.gif"/></alternatives></inline-formula>, and the mean of the normalized read counts, <inline-formula id="IEq18"><alternatives><tex-math id="M57">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
							$\frac {1}{m}\sum _{j} K_{\textit {ij}}/s_{j}$
						\end{document}</tex-math><mml:math id="M58"><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:mfrac><mml:munder><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:munder><mml:msub><mml:mrow><mml:mi>K</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ij</mml:mtext></mml:mrow></mml:msub><mml:mo>/</mml:mo><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13059_2014_550_Article_IEq18.gif"/></alternatives></inline-formula>, will be roughly the same.</p>
      <p>This phenomenon may give rise to an apparent dependence of <italic>α</italic> on <italic>μ</italic>. It is possible that the shape of the dispersion-mean fit for the Bottomly data (Figure <xref rid="Fig1" ref-type="fig">1</xref>A) can be explained in that manner: the asymptotic dispersion is <italic>α</italic><sub>0</sub>≈0.01, and the non-zero slope of the mean-dispersion plot is limited to the range of mean counts up to around 100, the reciprocal of <italic>α</italic><sub>0</sub>. However, overestimation of <italic>α</italic> in that low-count range has little effect on inference, as in that range the variance <italic>v</italic> is anyway dominated by the <italic>α</italic>-independent Poisson component <italic>v</italic><sub>P</sub>. The situation is different for the Pickrell data: here, a dependence of dispersion on mean was observed for counts clearly above the reciprocal of the asymptotic dispersion <italic>α</italic><sub>0</sub> (Figure <xref rid="Fig1" ref-type="fig">1</xref>B), and hence is not due merely to estimation bias. Simulations (shown in Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S25) confirmed that the observed joint distribution of estimated dispersions and means is not compatible with a single, constant dispersion. Therefore, the parametrization (<xref rid="Equ6" ref-type="">6</xref>) is a flexible and mildly conservative modeling choice: it is able to pick up dispersion-mean dependence if it is present, while it can lead to a minor loss of power in the low-count range due to a tendency to overestimate dispersion there.</p>
      <p><bold>Dispersion prior</bold> As also observed by Wu <italic>et al.</italic> [<xref ref-type="bibr" rid="CR6">6</xref>], a log-normal prior fits the observed dispersion distribution for typical RNA-seq datasets. We solve the computational difficulty of working with a non-conjugate prior using the following argument: the logarithmic residuals from the trend fit, <inline-formula id="IEq19"><alternatives><tex-math id="M59">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
							$\log \alpha ^{\text {gw}}_{i} - \log \alpha _{\text {tr}}(\bar \mu _{i})$
						\end{document}</tex-math><mml:math id="M60"><mml:mo>log</mml:mo><mml:munderover><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mtext>gw</mml:mtext></mml:mrow></mml:munderover><mml:mo>−</mml:mo><mml:mo>log</mml:mo><mml:msub><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mtext>tr</mml:mtext></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mo>¯</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:math><inline-graphic xlink:href="13059_2014_550_Article_IEq19.gif"/></alternatives></inline-formula>, arise from two contributions, namely the scatter of the true logarithmic dispersions around the trend, given by the prior with variance <inline-formula id="IEq20"><alternatives><tex-math id="M61">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
							$\sigma _{\text {d}}^{2}$
						\end{document}</tex-math><mml:math id="M62"><mml:msubsup><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mtext>d</mml:mtext></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2014_550_Article_IEq20.gif"/></alternatives></inline-formula>, and the sampling distribution of the logarithm of the dispersion estimator, with variance <inline-formula id="IEq21"><alternatives><tex-math id="M63">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
							$\sigma ^{2}_{\text {lde}}$
						\end{document}</tex-math><mml:math id="M64"><mml:msubsup><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mtext>lde</mml:mtext></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2014_550_Article_IEq21.gif"/></alternatives></inline-formula>. The sampling distribution of a dispersion estimator is approximately a scaled <italic>χ</italic><sup>2</sup> distribution with <italic>m</italic>−<italic>p</italic> degrees of freedom, with <italic>m</italic> the number of samples and <italic>p</italic> the number of coefficients. The variance of the logarithm of a <inline-formula id="IEq22"><alternatives><tex-math id="M65">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
							${\chi ^{2}_{f}}$
						\end{document}</tex-math><mml:math id="M66"><mml:msubsup><mml:mrow><mml:mi>χ</mml:mi></mml:mrow><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2014_550_Article_IEq22.gif"/></alternatives></inline-formula>-distributed random variable is given [<xref ref-type="bibr" rid="CR52">52</xref>] by the trigamma function <italic>ψ</italic><sub>1</sub>,
<disp-formula id="Eque"><alternatives><tex-math id="M67">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
							 $$\operatorname{Var} \log X^{2} = \psi_{1}(f/2)\quad\text{for}\quad X^{2} {\sim\chi^{2}_{f}}.  $$ 
						\end{document}</tex-math><mml:math id="M68"><mml:mrow><mml:mo>Var</mml:mo><mml:mo>log</mml:mo><mml:msup><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>ψ</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mi>f</mml:mi><mml:mo>/</mml:mo><mml:mn>2</mml:mn><mml:mo>)</mml:mo><mml:mspace width="1em"/><mml:mtext>for</mml:mtext><mml:mspace width="1em"/><mml:msup><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo>∼</mml:mo><mml:munderover><mml:mrow><mml:mi>χ</mml:mi></mml:mrow><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:munderover><mml:mi>.</mml:mi></mml:mrow></mml:math><graphic xlink:href="13059_2014_550_Article_Eque.gif" position="anchor"/></alternatives></disp-formula> Therefore, <inline-formula id="IEq23"><alternatives><tex-math id="M69">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
							$\sigma ^{2}_{\text {lde}}\approx \psi _{1}((m-p)/2)$
						\end{document}</tex-math><mml:math id="M70"><mml:msubsup><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mtext>lde</mml:mtext></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo>≈</mml:mo><mml:msub><mml:mrow><mml:mi>ψ</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mo>(</mml:mo><mml:mi>m</mml:mi><mml:mo>−</mml:mo><mml:mi>p</mml:mi><mml:mo>)</mml:mo><mml:mo>/</mml:mo><mml:mn>2</mml:mn><mml:mo>)</mml:mo></mml:math><inline-graphic xlink:href="13059_2014_550_Article_IEq23.gif"/></alternatives></inline-formula>, i.e., the sampling variance of the logarithm of a variance or dispersion estimator is approximately constant across genes and depends only on the degrees of freedom of the model.</p>
      <p>Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S2 compares this approximation for the variance of logarithmic dispersion estimates with the variance of logarithmic Cox–Reid adjusted dispersion estimates for simulated negative binomial data, over a combination of different sample sizes, number of parameters and dispersion values used to create the simulated data. The approximation is close to the sample variance for various typical values of <italic>m</italic>, <italic>p</italic> and <italic>α</italic>.</p>
      <p>Therefore, the prior variance <inline-formula id="IEq24"><alternatives><tex-math id="M71">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
							$\sigma _{\text {d}}^{2}$
						\end{document}</tex-math><mml:math id="M72"><mml:msubsup><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mtext>d</mml:mtext></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2014_550_Article_IEq24.gif"/></alternatives></inline-formula> is obtained by subtracting the expected sampling variance from an estimate of the variance of the logarithmic residuals, <inline-formula id="IEq25"><alternatives><tex-math id="M73">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
							$s^{2}_{\text {lr}}$
						\end{document}</tex-math><mml:math id="M74"><mml:msubsup><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mtext>lr</mml:mtext></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2014_550_Article_IEq25.gif"/></alternatives></inline-formula>:
<disp-formula id="Equf"><alternatives><tex-math id="M75">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
							 $$\sigma_{\text{d}}^{2} = \operatorname{max}\left\{ s^{2}_{\text{lr}} - \psi_{1}((m-p)/2),\,\,0.25 \right\}. $$ 
						\end{document}</tex-math><mml:math id="M76"><mml:mrow><mml:msubsup><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mtext>d</mml:mtext></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mo>max</mml:mo><mml:mfenced close="}" open="{" separators=""><mml:mrow><mml:munderover><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mtext>lr</mml:mtext></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:munderover><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi>ψ</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mo>(</mml:mo><mml:mi>m</mml:mi><mml:mo>−</mml:mo><mml:mi>p</mml:mi><mml:mo>)</mml:mo><mml:mo>/</mml:mo><mml:mn>2</mml:mn><mml:mo>)</mml:mo><mml:mo>,</mml:mo><mml:mspace width="0.3em"/><mml:mspace width="0.3em"/><mml:mn>0.25</mml:mn></mml:mrow></mml:mfenced><mml:mi>.</mml:mi></mml:mrow></mml:math><graphic xlink:href="13059_2014_550_Article_Equf.gif" position="anchor"/></alternatives></disp-formula> The prior variance <inline-formula id="IEq26"><alternatives><tex-math id="M77">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
							$\sigma _{\text {d}}^{2}$
						\end{document}</tex-math><mml:math id="M78"><mml:msubsup><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mtext>d</mml:mtext></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2014_550_Article_IEq26.gif"/></alternatives></inline-formula> is thresholded at a minimal value of 0.25 so that the dispersion estimates are not shrunk entirely to <inline-formula id="IEq27"><alternatives><tex-math id="M79">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
							$\alpha _{\text {tr}}(\bar \mu _{i})$
						\end{document}</tex-math><mml:math id="M80"><mml:msub><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mtext>tr</mml:mtext></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mo>¯</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:math><inline-graphic xlink:href="13059_2014_550_Article_IEq27.gif"/></alternatives></inline-formula> if the variance of the logarithmic residuals is less than the expected sampling variance.</p>
      <p>To avoid inflation of <inline-formula id="IEq28"><alternatives><tex-math id="M81">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
							$\sigma _{\text {d}}^{2}$
						\end{document}</tex-math><mml:math id="M82"><mml:msubsup><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mtext>d</mml:mtext></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2014_550_Article_IEq28.gif"/></alternatives></inline-formula> due to dispersion outliers (i.e., genes not well captured by this prior; see below), we use a robust estimator for the standard deviation <italic>s</italic><sub>lr</sub> of the logarithmic residuals,
<disp-formula id="Equ8"><label>(8)</label><alternatives><tex-math id="M83">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
							 $$ s_{\text{lr}} = {\underset{i}{\text{mad}}} \left(\log \alpha^{\text{gw}}_{i} - \log \alpha_{\text{tr}}(\bar\mu_{i})\right),   $$ 
						\end{document}</tex-math><mml:math id="M84"><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mtext>lr</mml:mtext></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:munder><mml:mrow><mml:mtext>mad</mml:mtext></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:munder><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mo>log</mml:mo><mml:munderover><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mtext>gw</mml:mtext></mml:mrow></mml:munderover><mml:mo>−</mml:mo><mml:mo>log</mml:mo><mml:msub><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mtext>tr</mml:mtext></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mo>¯</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow></mml:mfenced><mml:mo>,</mml:mo></mml:math><graphic xlink:href="13059_2014_550_Article_Equ8.gif" position="anchor"/></alternatives></disp-formula></p>
      <p>where mad stands for the median absolute deviation, divided as usual by the scaling factor <italic>Φ</italic><sup>−1</sup>(3/4).</p>
      <p><bold>Three or less residuals degrees of freedom</bold> When there are three or less residual degrees of freedom (number of samples minus number of parameters to estimate), the estimation of the prior variance <inline-formula id="IEq29"><alternatives><tex-math id="M85">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
							$\sigma _{\text {d}}^{2}$
						\end{document}</tex-math><mml:math id="M86"><mml:msubsup><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mtext>d</mml:mtext></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2014_550_Article_IEq29.gif"/></alternatives></inline-formula> using the observed variance of logarithmic residuals <inline-formula id="IEq30"><alternatives><tex-math id="M87">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
							$s^{2}_{\text {lr}}$
						\end{document}</tex-math><mml:math id="M88"><mml:msubsup><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mtext>lr</mml:mtext></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2014_550_Article_IEq30.gif"/></alternatives></inline-formula> tends to underestimate <inline-formula id="IEq31"><alternatives><tex-math id="M89">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
							$\sigma _{\text {d}}^{2}$
						\end{document}</tex-math><mml:math id="M90"><mml:msubsup><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mtext>d</mml:mtext></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2014_550_Article_IEq31.gif"/></alternatives></inline-formula>. In this case, we instead estimate the prior variance through simulation. We match the distribution of logarithmic residuals to a density of simulated logarithmic residuals. These are the logarithm of <inline-formula id="IEq32"><alternatives><tex-math id="M91">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
							$\chi ^{2}_{m-p}$
						\end{document}</tex-math><mml:math id="M92"><mml:msubsup><mml:mrow><mml:mi>χ</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi><mml:mo>−</mml:mo><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2014_550_Article_IEq32.gif"/></alternatives></inline-formula>-distributed random variables added to <inline-formula id="IEq33"><alternatives><tex-math id="M93">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
							$N(0,\sigma _{\text {d}}^{2})$
						\end{document}</tex-math><mml:math id="M94"><mml:mi>N</mml:mi><mml:mo>(</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mtext>d</mml:mtext></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo>)</mml:mo></mml:math><inline-graphic xlink:href="13059_2014_550_Article_IEq33.gif"/></alternatives></inline-formula> random variables to account for the spread due to the prior. The simulated distribution is shifted by − log(<italic>m</italic>−<italic>p</italic>) to account for the scaling of the <italic>χ</italic><sup>2</sup> distribution. We repeat the simulation over a grid of values for <inline-formula id="IEq34"><alternatives><tex-math id="M95">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
							$\sigma _{\text {d}}^{2}$
						\end{document}</tex-math><mml:math id="M96"><mml:msubsup><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mtext>d</mml:mtext></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2014_550_Article_IEq34.gif"/></alternatives></inline-formula>, and select the value that minimizes the Kullback–Leibler divergence from the observed density of logarithmic residuals to the simulated density.</p>
      <p><bold>Final dispersion estimate</bold> We form a logarithmic posterior for the dispersion from the Cox–Reid adjusted logarithmic likelihood (<xref rid="Equ7" ref-type="">7</xref>) and the logarithmic prior (<xref rid="Equ5" ref-type="">5</xref>) and use its maximum (i.e., the MAP value) as the final estimate of the dispersion,
<disp-formula id="Equ9"><label>(9)</label><alternatives><tex-math id="M97">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
							 $$ \alpha_{i}^{\text{MAP}} = {\underset{\alpha}{\text{arg max}}}\, \left(\ell_{\text{CR}}\left(\alpha; \vec\mu_{\textit{i}\cdot}^{0}, \vec K_{\textit{i}\cdot}\right) + \Lambda_{i}(\alpha) \right),   $$ 
						\end{document}</tex-math><mml:math id="M98"><mml:msubsup><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mtext>MAP</mml:mtext></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:munder><mml:mrow><mml:mtext>arg max</mml:mtext></mml:mrow><mml:mrow><mml:mi>α</mml:mi></mml:mrow></mml:munder><mml:mspace width="0.3em"/><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msub><mml:mrow><mml:mi>ℓ</mml:mi></mml:mrow><mml:mrow><mml:mtext>CR</mml:mtext></mml:mrow></mml:msub><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mi>α</mml:mi><mml:mo>;</mml:mo><mml:msubsup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mo>→</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">i</mml:mtext><mml:mo>·</mml:mo></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>K</mml:mi></mml:mrow><mml:mo>→</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">i</mml:mtext><mml:mo>·</mml:mo></mml:mrow></mml:msub></mml:mrow></mml:mfenced><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>Λ</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mi>α</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mfenced><mml:mo>,</mml:mo></mml:math><graphic xlink:href="13059_2014_550_Article_Equ9.gif" position="anchor"/></alternatives></disp-formula></p>
      <p>where
<disp-formula id="Equg"><alternatives><tex-math id="M99">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
							 $$\Lambda_{i}(\alpha) = \frac{- \left(\log\alpha-\log\alpha_{\text{tr}}(\bar\mu_{i})\right)^{2}}{2 \sigma_{\text{d}}^{2}}, $$ 
						\end{document}</tex-math><mml:math id="M100"><mml:mrow><mml:msub><mml:mrow><mml:mi>Λ</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mi>α</mml:mi><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mo>−</mml:mo><mml:msup><mml:mrow><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mo>log</mml:mo><mml:mi>α</mml:mi><mml:mo>−</mml:mo><mml:mo>log</mml:mo><mml:msub><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mtext>tr</mml:mtext></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mo>¯</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:msubsup><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mtext>d</mml:mtext></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:mrow></mml:mfrac><mml:mo>,</mml:mo></mml:mrow></mml:math><graphic xlink:href="13059_2014_550_Article_Equg.gif" position="anchor"/></alternatives></disp-formula> is, up to an additive constant, the logarithm of the density of prior (<xref rid="Equ5" ref-type="">5</xref>). Again, a backtracking line search is used to perform the optimization.</p>
      <p><bold>Dispersion outliers</bold> For some genes, the gene-wise estimate <inline-formula id="IEq35"><alternatives><tex-math id="M101">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
							$\alpha ^{\text {gw}}_{i}$
						\end{document}</tex-math><mml:math id="M102"><mml:msubsup><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mtext>gw</mml:mtext></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2014_550_Article_IEq35.gif"/></alternatives></inline-formula> can be so far above the prior expectation <inline-formula id="IEq36"><alternatives><tex-math id="M103">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
							$\alpha _{\text {tr}}(\bar \mu _{i})$
						\end{document}</tex-math><mml:math id="M104"><mml:msub><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mtext>tr</mml:mtext></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mo>¯</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:math><inline-graphic xlink:href="13059_2014_550_Article_IEq36.gif"/></alternatives></inline-formula> that it would be unreasonable to assume that the prior is suitable for the gene. If the dispersion estimate for such genes were down-moderated toward the fitted trend, this might lead to false positives. Therefore, we use the heuristic of considering a gene as a dispersion outlier, if the residual from the trend fit is more than two standard deviations of logarithmic residuals, <italic>s</italic><sub>lr</sub> (see Equation (<xref rid="Equ8" ref-type="">8</xref>)), above the fit, i.e., if
<disp-formula id="Equh"><alternatives><tex-math id="M105">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
							 $$ \log \alpha_{i}^{\text{gw}} &gt; \log\alpha_{\text{tr}}(\bar\mu_{i}) + 2 s_{\text{lr}}. $$ \end{document}</tex-math><mml:math id="M106"><mml:mrow><mml:mo>log</mml:mo><mml:munderover><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mtext>gw</mml:mtext></mml:mrow></mml:munderover><mml:mo>&gt;</mml:mo><mml:mo>log</mml:mo><mml:msub><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mtext>tr</mml:mtext></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mo>¯</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo><mml:mo>+</mml:mo><mml:mn>2</mml:mn><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mtext>lr</mml:mtext></mml:mrow></mml:msub><mml:mi>.</mml:mi></mml:mrow></mml:math><graphic xlink:href="13059_2014_550_Article_Equh.gif" position="anchor"/></alternatives></disp-formula></p>
      <p>For such genes, the gene-wise estimate <inline-formula id="IEq37"><alternatives><tex-math id="M107">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
							$\alpha ^{\text {gw}}_{i}$
						\end{document}</tex-math><mml:math id="M108"><mml:msubsup><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mtext>gw</mml:mtext></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2014_550_Article_IEq37.gif"/></alternatives></inline-formula> is not shrunk toward the trended prior mean. Instead of the MAP value <inline-formula id="IEq38"><alternatives><tex-math id="M109">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
							$\alpha _{i}^{\text {MAP}}$
						\end{document}</tex-math><mml:math id="M110"><mml:msubsup><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mtext>MAP</mml:mtext></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2014_550_Article_IEq38.gif"/></alternatives></inline-formula>, we use the gene-wise estimate <inline-formula id="IEq39"><alternatives><tex-math id="M111">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
							$\alpha ^{\text {gw}}_{i}$
						\end{document}</tex-math><mml:math id="M112"><mml:msubsup><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mtext>gw</mml:mtext></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2014_550_Article_IEq39.gif"/></alternatives></inline-formula> as a final dispersion value in the subsequent steps. In addition, the iterative fitting procedure for the parametric dispersion trend described above avoids that such dispersion outliers influence the prior mean.</p>
    </sec>
    <sec id="Sec23">
      <title>Shrinkage estimation of logarithmic fold changes</title>
      <p>To incorporate empirical Bayes shrinkage of LFCs, we postulate a zero-centered normal prior for the coefficients <italic>β</italic><sub><italic>ir</italic></sub> of model (<xref rid="Equ2" ref-type="">2</xref>) that represent LFCs (i.e., typically, all coefficients except for the intercept <italic>β</italic><sub><italic>i</italic>0</sub>):
<disp-formula id="Equ10"><label>(10)</label><alternatives><tex-math id="M113">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
							 $$ \beta_{ir} \sim N\!\left(0, {\sigma_{r}^{2}} \right).   $$ 
						\end{document}</tex-math><mml:math id="M114"><mml:msub><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ir</mml:mtext></mml:mrow></mml:msub><mml:mo>∼</mml:mo><mml:mi>N</mml:mi><mml:mspace width="0.3em"/><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:mrow></mml:mfenced><mml:mi>.</mml:mi></mml:math><graphic xlink:href="13059_2014_550_Article_Equ10.gif" position="anchor"/></alternatives></disp-formula></p>
      <p>As was observed with differential expression analysis using microarrays, genes with low intensity values tend to suffer from a small signal-to-noise ratio. Alternative estimators can be found that are more stable than the standard calculation of fold change as the ratio of average observed values for each condition [<xref ref-type="bibr" rid="CR53">53</xref>-<xref ref-type="bibr" rid="CR55">55</xref>]. <italic>DESeq2</italic>’s approach can be seen as an extension of these approaches for stable estimation of gene-expression fold changes to count data.</p>
      <p><bold>Empirical prior estimate</bold> To obtain values for the empirical prior widths <italic>σ</italic><sub><italic>r</italic></sub> for the model coefficients, we again approximate a full empirical Bayes approach, as with the estimation of dispersion prior, though here we do not subtract the expected sampling variance from the observed variance of maximum likelihood estimates. The estimate of the LFC prior width is calculated as follows. We use the standard iteratively reweighted least-squares algorithm [<xref ref-type="bibr" rid="CR12">12</xref>] for each gene’s model, Equations (<xref rid="Equ1" ref-type="">1</xref>) and (<xref rid="Equ2" ref-type="">2</xref>), to get MLEs for the coefficients <inline-formula id="IEq40"><alternatives><tex-math id="M115">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
							$\beta _{\textit {ir}}^{\text {MLE}}$
						\end{document}</tex-math><mml:math id="M116"><mml:msubsup><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ir</mml:mtext></mml:mrow><mml:mrow><mml:mtext>MLE</mml:mtext></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2014_550_Article_IEq40.gif"/></alternatives></inline-formula>. We then fit, for each column <italic>r</italic> of the design matrix (except for the intercept), a zero-centered normal distribution to the empirical distribution of MLE fold change estimates <inline-formula id="IEq41"><alternatives><tex-math id="M117">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
							$\vec {\beta }^{\text {MLE}}_{r}$
						\end{document}</tex-math><mml:math id="M118"><mml:msubsup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mo>→</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mtext>MLE</mml:mtext></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2014_550_Article_IEq41.gif"/></alternatives></inline-formula>.</p>
      <p>To make the fit robust against outliers with very high absolute LFC values, we use quantile matching: the width <italic>σ</italic><sub><italic>r</italic></sub> is chosen such that the (1−<italic>p</italic>) empirical quantile of the absolute value of the observed LFCs, <inline-formula id="IEq42"><alternatives><tex-math id="M119">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
							$\vec {\beta }^{\text {MLE}}_{r}$
						\end{document}</tex-math><mml:math id="M120"><mml:msubsup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mo>→</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mtext>MLE</mml:mtext></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2014_550_Article_IEq42.gif"/></alternatives></inline-formula>, matches the (1−<italic>p</italic>/2) theoretical quantile of the prior, <inline-formula id="IEq43"><alternatives><tex-math id="M121">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
							$N(0,{\sigma _{r}^{2}})$
						\end{document}</tex-math><mml:math id="M122"><mml:mi>N</mml:mi><mml:mo>(</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo>)</mml:mo></mml:math><inline-graphic xlink:href="13059_2014_550_Article_IEq43.gif"/></alternatives></inline-formula>, where <italic>p</italic> is set by default to 0.05. If we write the theoretical upper quantile of a normal distribution as <italic>Q</italic><sub><italic>N</italic></sub>(1−<italic>p</italic>) and the empirical upper quantile of the MLE LFCs as <inline-formula id="IEq44"><alternatives><tex-math id="M123">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
							$Q_{|\beta _{r}|}(1 - p)$
						\end{document}</tex-math><mml:math id="M124"><mml:msub><mml:mrow><mml:mi>Q</mml:mi></mml:mrow><mml:mrow><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mo>|</mml:mo></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>p</mml:mi><mml:mo>)</mml:mo></mml:math><inline-graphic xlink:href="13059_2014_550_Article_IEq44.gif"/></alternatives></inline-formula>, then the prior width is calculated as:
<disp-formula id="Equi"><alternatives><tex-math id="M125">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
							 $$ \sigma_{r} = \frac{Q_{|\beta_{r}|}(1 - p)}{Q_{N}(1 - p/2)}. $$ 
						\end{document}</tex-math><mml:math id="M126"><mml:mrow><mml:msub><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi>Q</mml:mi></mml:mrow><mml:mrow><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mo>|</mml:mo></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>p</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>Q</mml:mi></mml:mrow><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>p</mml:mi><mml:mo>/</mml:mo><mml:mn>2</mml:mn><mml:mo>)</mml:mo></mml:mrow></mml:mfrac><mml:mi>.</mml:mi></mml:mrow></mml:math><graphic xlink:href="13059_2014_550_Article_Equi.gif" position="anchor"/></alternatives></disp-formula></p>
      <p>To ensure that the prior width <italic>σ</italic><sub><italic>r</italic></sub> will be independent of the choice of base level, the estimates from the quantile matching procedure are averaged for each factor over all possible contrasts of factor levels. When determining the empirical upper quantile, extreme LFC values (<inline-formula id="IEq45"><alternatives><tex-math id="M127">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
							$\left |\beta _{\textit {ir}}^{\text {MLE}}\right | &gt; \log (2) \, 10$\end{document}</tex-math><mml:math id="M128"><mml:mfenced close="|" open="|" separators=""><mml:mrow><mml:msubsup><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ir</mml:mtext></mml:mrow><mml:mrow><mml:mtext>MLE</mml:mtext></mml:mrow></mml:msubsup></mml:mrow></mml:mfenced><mml:mo>&gt;</mml:mo><mml:mo>log</mml:mo><mml:mo>(</mml:mo><mml:mn>2</mml:mn><mml:mo>)</mml:mo><mml:mspace width="0.3em"/><mml:mn>10</mml:mn></mml:math><inline-graphic xlink:href="13059_2014_550_Article_IEq45.gif"/></alternatives></inline-formula>, or 10 on the base 2 scale) are excluded.</p>
      <p><bold>Final estimate of logarithmic fold changes</bold> The logarithmic posterior for the vector, <inline-formula id="IEq46"><alternatives><tex-math id="M129">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
							$\vec \beta _{i}$
						\end{document}</tex-math><mml:math id="M130"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mo>→</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13059_2014_550_Article_IEq46.gif"/></alternatives></inline-formula>, of model coefficients <italic>β</italic><sub><italic>ir</italic></sub> for gene <italic>i</italic> is the sum of the logarithmic likelihood of the GLM (<xref rid="Equ2" ref-type="">2</xref>) and the logarithm of the prior density (<xref rid="Equ10" ref-type="">10</xref>), and its maximum yields the final MAP coefficient estimates:
<disp-formula id="Equj"><alternatives><tex-math id="M131">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
							 $$\vec\beta_{i} = {\underset{\vec\beta}{\text{arg max}}} \left(\sum_{j} \log f_{\text{NB}}\left(K_{ij};\mu_{j}(\vec\beta),\alpha_{i} \right) + \Lambda(\vec\beta) \right), $$ 
						\end{document}</tex-math><mml:math id="M132"><mml:mrow><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mo>→</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:munder><mml:mrow><mml:mtext>arg max</mml:mtext></mml:mrow><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mo>→</mml:mo></mml:mover></mml:mrow></mml:munder><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:munder><mml:mrow><mml:mo mathsize="big">∑</mml:mo></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:munder><mml:mo>log</mml:mo><mml:msub><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mtext>NB</mml:mtext></mml:mrow></mml:msub><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msub><mml:mrow><mml:mi>K</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ij</mml:mtext></mml:mrow></mml:msub><mml:mo>;</mml:mo><mml:msub><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mover accent="true"><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mo>→</mml:mo></mml:mover><mml:mo>)</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced><mml:mo>+</mml:mo><mml:mi>Λ</mml:mi><mml:mo>(</mml:mo><mml:mover accent="true"><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mo>→</mml:mo></mml:mover><mml:mo>)</mml:mo></mml:mrow></mml:mfenced><mml:mo>,</mml:mo></mml:mrow></mml:math><graphic xlink:href="13059_2014_550_Article_Equj.gif" position="anchor"/></alternatives></disp-formula> where
<disp-formula id="Equk"><alternatives><tex-math id="M133">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
							 $$\mu_{j}(\vec\beta) = s_{ij} e^{\sum_{r} x_{jr} \beta_{r}}, \quad \Lambda(\vec\beta) = \sum_{r} \frac{- {\beta_{r}^{2}}}{2 {\sigma_{r}^{2}}}, $$ 
						\end{document}</tex-math><mml:math id="M134"><mml:mrow><mml:msub><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mover accent="true"><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mo>→</mml:mo></mml:mover><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ij</mml:mtext></mml:mrow></mml:msub><mml:msup><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:munder><mml:mrow><mml:mo mathsize="big">∑</mml:mo></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:munder><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">jr</mml:mtext></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:mspace width="1em"/><mml:mi>Λ</mml:mi><mml:mo>(</mml:mo><mml:mover accent="true"><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mo>→</mml:mo></mml:mover><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:munder><mml:mrow><mml:mo mathsize="big">∑</mml:mo></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:munder><mml:mfrac><mml:mrow><mml:mo>−</mml:mo><mml:msubsup><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:msubsup><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:mrow></mml:mfrac><mml:mo>,</mml:mo></mml:mrow></mml:math><graphic xlink:href="13059_2014_550_Article_Equk.gif" position="anchor"/></alternatives></disp-formula> and <italic>α</italic><sub><italic>i</italic></sub> is the final dispersion estimate for gene <italic>i</italic>, i.e., <inline-formula id="IEq47"><alternatives><tex-math id="M135">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
							$\alpha _{i}=\alpha _{i}^{\text {MAP}}$
						\end{document}</tex-math><mml:math id="M136"><mml:msub><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msubsup><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mtext>MAP</mml:mtext></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2014_550_Article_IEq47.gif"/></alternatives></inline-formula>, except for dispersion outliers, where <inline-formula id="IEq48"><alternatives><tex-math id="M137">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
							$\alpha _{i}=\alpha _{i}^{\text {gw}}$
						\end{document}</tex-math><mml:math id="M138"><mml:msub><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msubsup><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mtext>gw</mml:mtext></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2014_550_Article_IEq48.gif"/></alternatives></inline-formula>.</p>
      <p>The term <italic>Λ</italic>(<italic>β</italic>), i.e., the logarithm of the density of the normal prior (up to an additive constant), can be read as a ridge penalty term, and therefore, we perform the optimization using the <italic>iteratively reweighted ridge regression algorithm</italic> [<xref ref-type="bibr" rid="CR56">56</xref>], also known as <italic>weighted updates</italic> [<xref ref-type="bibr" rid="CR57">57</xref>]. Specifically, the updates for a given gene are of the form
<disp-formula id="Equl"><alternatives><tex-math id="M139">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
							 $$ \vec\beta \leftarrow \left(X^{t} W X + \vec{\lambda} I\right)^{-1} X^{t} W \vec{z}, $$ 
						\end{document}</tex-math><mml:math id="M140"><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mo>→</mml:mo></mml:mover><mml:mo>←</mml:mo><mml:msup><mml:mrow><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msup><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msup><mml:mtext mathvariant="italic">WX</mml:mtext><mml:mo>+</mml:mo><mml:mover accent="true"><mml:mrow><mml:mi>λ</mml:mi></mml:mrow><mml:mo>→</mml:mo></mml:mover><mml:mi>I</mml:mi></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:msup><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msup><mml:mi>W</mml:mi><mml:mover accent="true"><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mo>→</mml:mo></mml:mover><mml:mo>,</mml:mo></mml:mrow></mml:math><graphic xlink:href="13059_2014_550_Article_Equl.gif" position="anchor"/></alternatives></disp-formula> with <inline-formula id="IEq49"><alternatives><tex-math id="M141">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
							$\lambda _{r} = 1/{\sigma _{r}^{2}}$
						\end{document}</tex-math><mml:math id="M142"><mml:msub><mml:mrow><mml:mi>λ</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:msubsup><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2014_550_Article_IEq49.gif"/></alternatives></inline-formula> and
<disp-formula id="Equm"><alternatives><tex-math id="M143">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
							 $$ z_{j} = \log \frac{\mu_{j}}{s_{j}} + \frac{K_{j} - \mu_{j}}{\mu_{j}}, $$ 
						\end{document}</tex-math><mml:math id="M144"><mml:mrow><mml:msub><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mo>log</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:mo>+</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi>K</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:mo>,</mml:mo></mml:mrow></mml:math><graphic xlink:href="13059_2014_550_Article_Equm.gif" position="anchor"/></alternatives></disp-formula> where the current fitted values <inline-formula id="IEq50"><alternatives><tex-math id="M145">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
							$\mu _{j} = s_{j} e^{\sum _{r} x_{\textit {jr}}\beta _{r}}$
						\end{document}</tex-math><mml:math id="M146"><mml:msub><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:msup><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:munder><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:munder><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">jr</mml:mtext></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msup></mml:math><inline-graphic xlink:href="13059_2014_550_Article_IEq50.gif"/></alternatives></inline-formula> are computed from the current estimates <inline-formula id="IEq51"><alternatives><tex-math id="M147">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
							$\vec \beta $
						\end{document}</tex-math><mml:math id="M148"><mml:mover accent="true"><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mo>→</mml:mo></mml:mover></mml:math><inline-graphic xlink:href="13059_2014_550_Article_IEq51.gif"/></alternatives></inline-formula> in each iteration.</p>
      <p><bold>Fisher information.</bold> The effect of the zero-centered normal prior can be understood as shrinking the MAP LFC estimates based on the amount of information the experiment provides for this coefficient, and we briefly elaborate on this here. Specifically, for a given gene <italic>i</italic>, the shrinkage for an LFC <italic>β</italic><sub><italic>ir</italic></sub> depends on the <italic>observed Fisher information</italic>, given by
<disp-formula id="Equn"><alternatives><tex-math id="M149">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
							 $$\mathcal{J}_{m}(\hat\beta_{ir}) = - \left[ \frac{\partial^{2}}{\partial \beta_{ir}^{2}} \ell\left(\vec\beta_{i} ; \vec{K_{i}}, \alpha_{i}\right) \right]_{\beta_{ir} = \hat\beta_{ir}}, $$ 
						\end{document}</tex-math><mml:math id="M150"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="script">J</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ir</mml:mtext></mml:mrow></mml:msub><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mfenced close="]" open="[" separators=""><mml:mrow><mml:mfrac><mml:mrow><mml:msup><mml:mrow><mml:mi>∂</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:mi>∂</mml:mi><mml:msubsup><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ir</mml:mtext></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:mrow></mml:mfrac><mml:mi>ℓ</mml:mi><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mo>→</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>;</mml:mo><mml:mover accent="true"><mml:mrow><mml:msub><mml:mrow><mml:mi>K</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>→</mml:mo></mml:mover><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ir</mml:mtext></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ir</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo>,</mml:mo></mml:mrow></mml:math><graphic xlink:href="13059_2014_550_Article_Equn.gif" position="anchor"/></alternatives></disp-formula> where <inline-formula id="IEq52"><alternatives><tex-math id="M151">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
							$\ell \left (\vec \beta _{i} ; \vec {K_{i}}, \alpha _{i}\right)$
						\end{document}</tex-math><mml:math id="M152"><mml:mi>ℓ</mml:mi><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mo>→</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>;</mml:mo><mml:mover accent="true"><mml:mrow><mml:msub><mml:mrow><mml:mi>K</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>→</mml:mo></mml:mover><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:math><inline-graphic xlink:href="13059_2014_550_Article_IEq52.gif"/></alternatives></inline-formula> is the logarithm of the likelihood, and partial derivatives are taken with respect to LFC <italic>β</italic><sub><italic>ir</italic></sub>. For a negative binomial GLM, the observed Fisher information, or peakedness of the logarithm of the profile likelihood, is influenced by a number of factors including the degrees of freedom, the estimated mean counts <italic>μ</italic><sub><italic>ij</italic></sub>, and the gene’s dispersion estimate <italic>α</italic><sub><italic>i</italic></sub>. The prior influences the MAP estimate when the density of the likelihood and the prior are multiplied to calculate the posterior. Genes with low estimated mean values <italic>μ</italic><sub><italic>ij</italic></sub> or high dispersion estimates <italic>α</italic><sub><italic>i</italic></sub> have flatter profile likelihoods, as do datasets with few residual degrees of freedom, and therefore in these cases the zero-centered prior pulls the MAP estimate from a high-uncertainty MLE closer toward zero.</p>
    </sec>
    <sec id="Sec24">
      <title>Wald test</title>
      <p>The Wald test compares the beta estimate <italic>β</italic><sub><italic>ir</italic></sub> divided by its estimated standard error SE(<italic>β</italic><sub><italic>ir</italic></sub>) to a standard normal distribution. The estimated standard errors are the square root of the diagonal elements of the estimated covariance matrix, <italic>Σ</italic><sub><italic>i</italic></sub>, for the coefficients, i.e., <inline-formula id="IEq53"><alternatives><tex-math id="M153">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
							$\operatorname {SE}(\beta _{\textit {ir}})=\sqrt {\Sigma _{i,rr}}$
						\end{document}</tex-math><mml:math id="M154"><mml:mo>SE</mml:mo><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ir</mml:mtext></mml:mrow></mml:msub><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:msqrt><mml:mrow><mml:msub><mml:mrow><mml:mi>Σ</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mtext mathvariant="italic">rr</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:msqrt></mml:math><inline-graphic xlink:href="13059_2014_550_Article_IEq53.gif"/></alternatives></inline-formula>. Contrasts of coefficients are tested similarly by forming a Wald statistics using (<xref rid="Equ3" ref-type="">3</xref>) and (<xref rid="Equ4" ref-type="">4</xref>). We use the following formula for the coefficient covariance matrix for a GLM with normal prior on coefficients [<xref ref-type="bibr" rid="CR56">56</xref>, <xref ref-type="bibr" rid="CR58">58</xref>]:
<disp-formula id="Equo"><alternatives><tex-math id="M155">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
							 $$\Sigma_{i} = \operatorname{Cov}(\vec{\beta}_{i}) = (X^{t} W X + \vec{\lambda} I)^{-1} (X^{t} W X) (X^{t} W X + \vec{\lambda} I)^{-1}. $$ 
						\end{document}</tex-math><mml:math id="M156"><mml:mrow><mml:mspace width="-14.0pt"/><mml:msub><mml:mrow><mml:mi>Σ</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mo>Cov</mml:mo><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mo>→</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:msup><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msup><mml:mtext mathvariant="italic">WX</mml:mtext><mml:mo>+</mml:mo><mml:mover accent="true"><mml:mrow><mml:mi>λ</mml:mi></mml:mrow><mml:mo>→</mml:mo></mml:mover><mml:mi>I</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mo>(</mml:mo><mml:msup><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msup><mml:mtext mathvariant="italic">WX</mml:mtext><mml:mo>)</mml:mo><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:msup><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msup><mml:mtext mathvariant="italic">WX</mml:mtext><mml:mo>+</mml:mo><mml:mover accent="true"><mml:mrow><mml:mi>λ</mml:mi></mml:mrow><mml:mo>→</mml:mo></mml:mover><mml:mi>I</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mi>.</mml:mi></mml:mrow></mml:math><graphic xlink:href="13059_2014_550_Article_Equo.gif" position="anchor"/></alternatives></disp-formula> The tail integrals of the standard normal distribution are multiplied by 2 to achieve a two-tailed test. The Wald test <italic>P</italic> values from the subset of genes that pass the independent filtering step are adjusted for multiple testing using the procedure of Benjamini and Hochberg [<xref ref-type="bibr" rid="CR21">21</xref>].</p>
    </sec>
    <sec id="Sec25">
      <title>Independent filtering</title>
      <p>Independent filtering does not compromise type-I error control as long as the distribution of the test statistic is marginally independent of the filter statistic <italic>under the null hypothesis</italic> [<xref ref-type="bibr" rid="CR22">22</xref>], and we argue in the following that this is the case in our application. The filter statistic in <italic>DESeq2</italic> is the mean of normalized counts for a gene, while the test statistic is <italic>p</italic>, the <italic>P</italic> value from the Wald test. We first consider the case where the size factors are equal and where the gene-wise dispersion estimates are used for each gene, i.e. without dispersion shrinkage. The distribution family for the negative binomial is parameterized by <italic>θ</italic>=(<italic>μ</italic>,<italic>α</italic>). Aside from discreteness of <italic>p</italic> due to low counts, for a given <italic>μ</italic>, the distribution of <italic>p</italic> is Uniform(0,1) under the null hypothesis, so <italic>p</italic> is an ancillary statistic. The sample mean of counts for gene <italic>i</italic>, <inline-formula id="IEq54"><alternatives><tex-math id="M157">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
							$\bar {K}_{i}$
						\end{document}</tex-math><mml:math id="M158"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>K</mml:mi></mml:mrow><mml:mo>¯</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13059_2014_550_Article_IEq54.gif"/></alternatives></inline-formula>, is boundedly complete sufficient for <italic>μ</italic>. Then from Basu’s theorem, <inline-formula id="IEq55"><alternatives><tex-math id="M159">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
							$\bar {K}_{i}$
						\end{document}</tex-math><mml:math id="M160"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>K</mml:mi></mml:mrow><mml:mo>¯</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13059_2014_550_Article_IEq55.gif"/></alternatives></inline-formula> and <italic>p</italic> are independent.</p>
      <p>While for very low counts, one can observe discreteness and non-uniformity of <italic>p</italic> under the null hypothesis, <italic>DESeq2</italic> does not use the distribution of <italic>p</italic> in its estimation procedure – for example, <italic>DESeq2</italic> does not estimate the proportion of null genes using the distribution of <italic>p</italic> – so this kind of dependence of <italic>p</italic> on <italic>μ</italic> does not lead to increased type-I error.</p>
      <p>If the size factors are not equal across samples, but not correlated with condition, conditioning on the mean of <italic>normalized</italic> counts should also provide uniformly distributed <italic>p</italic> as with conditioning on the mean of counts, <inline-formula id="IEq56"><alternatives><tex-math id="M161">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
							$\bar {K}_{i}$
						\end{document}</tex-math><mml:math id="M162"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>K</mml:mi></mml:mrow><mml:mo>¯</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13059_2014_550_Article_IEq56.gif"/></alternatives></inline-formula>. We may consider a pathological case where the size factors are perfectly confounded with condition, in which case, even under the null hypothesis, genes with low mean count would have non-uniform distribution of <italic>p</italic>, as one condition could have positive counts and the other condition often zero counts. This could lead to non-uniformity of <italic>p</italic> under the null hypothesis; however, such a pathological case would pose problems for many statistical tests of differences in mean.</p>
      <p>We used simulation to demonstrate that the independence of the null distribution of the test statistic from the filter statistic still holds for dispersion shrinkage. Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S26 displays marginal null distributions of <italic>p</italic> across the range of mean normalized counts. Despite spikes in the distribution for the genes with the lowest mean counts due to discreteness of the data, these densities were nearly uniform across the range of average expression strength.</p>
    </sec>
    <sec id="Sec26">
      <title>Composite null hypotheses</title>
      <p><italic>DESeq2</italic> offers tests for composite null hypotheses of the form <inline-formula id="IEq57"><alternatives><tex-math id="M163">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
							$\mathcal {H}_{0}: |\beta _{\textit {ir}}| \le \theta $
						\end{document}</tex-math><mml:math id="M164"><mml:msub><mml:mrow><mml:mi mathvariant="script">ℋ</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>:</mml:mo><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ir</mml:mtext></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:mo>≤</mml:mo><mml:mi>θ</mml:mi></mml:math><inline-graphic xlink:href="13059_2014_550_Article_IEq57.gif"/></alternatives></inline-formula> to find genes whose LFC significantly exceeds a threshold <italic>θ</italic>&gt;0. The composite null hypothesis is replaced by two simple null hypotheses: <inline-formula id="IEq58"><alternatives><tex-math id="M165">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
							$\mathcal {H}_{0a}: \beta _{\textit {ir}} = \theta $
						\end{document}</tex-math><mml:math id="M166"><mml:msub><mml:mrow><mml:mi mathvariant="script">ℋ</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn><mml:mi>a</mml:mi></mml:mrow></mml:msub><mml:mo>:</mml:mo><mml:msub><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ir</mml:mtext></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>θ</mml:mi></mml:math><inline-graphic xlink:href="13059_2014_550_Article_IEq58.gif"/></alternatives></inline-formula> and <inline-formula id="IEq59"><alternatives><tex-math id="M167">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
							$\mathcal {H}_{0b}: \beta _{\textit {ir}} = -\theta $
						\end{document}</tex-math><mml:math id="M168"><mml:msub><mml:mrow><mml:mi mathvariant="script">ℋ</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn><mml:mi>b</mml:mi></mml:mrow></mml:msub><mml:mo>:</mml:mo><mml:msub><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ir</mml:mtext></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:mi>θ</mml:mi></mml:math><inline-graphic xlink:href="13059_2014_550_Article_IEq59.gif"/></alternatives></inline-formula>. Two-tailed <italic>P</italic> values are generated by integrating a normal distribution centered on <italic>θ</italic> with standard deviation SE(<italic>β</italic><sub><italic>ir</italic></sub>) from |<italic>β</italic><sub><italic>ir</italic></sub>| toward <italic>∞</italic>. The value of the integral is then multiplied by 2 and thresholded at 1. This procedure controls type-I error even when <italic>β</italic><sub><italic>ir</italic></sub>=±<italic>θ</italic>, and is equivalent to the standard <italic>DESeq2</italic><italic>P</italic> value when <italic>θ</italic>=0.</p>
      <p>Conversely, when searching for genes whose absolute LFC is significantly below a threshold, i.e., when testing the null hypothesis <inline-formula id="IEq60"><alternatives><tex-math id="M169">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
							$\mathcal {H}_{0}: |\beta _{\textit {ir}}| \ge \theta $
						\end{document}</tex-math><mml:math id="M170"><mml:msub><mml:mrow><mml:mi mathvariant="script">ℋ</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>:</mml:mo><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ir</mml:mtext></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:mo>≥</mml:mo><mml:mi>θ</mml:mi></mml:math><inline-graphic xlink:href="13059_2014_550_Article_IEq60.gif"/></alternatives></inline-formula>, the <italic>P</italic> value is constructed as the maximum of two one-sided tests of the simple null hypotheses: <inline-formula id="IEq61"><alternatives><tex-math id="M171">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
							$\mathcal {H}_{0a}: \beta _{\textit {ir}} = \theta $
						\end{document}</tex-math><mml:math id="M172"><mml:msub><mml:mrow><mml:mi mathvariant="script">ℋ</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn><mml:mi>a</mml:mi></mml:mrow></mml:msub><mml:mo>:</mml:mo><mml:msub><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ir</mml:mtext></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>θ</mml:mi></mml:math><inline-graphic xlink:href="13059_2014_550_Article_IEq61.gif"/></alternatives></inline-formula> and <inline-formula id="IEq62"><alternatives><tex-math id="M173">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
							$\mathcal {H}_{0b}: \beta _{\textit {ir}} = -\theta $
						\end{document}</tex-math><mml:math id="M174"><mml:msub><mml:mrow><mml:mi mathvariant="script">ℋ</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn><mml:mi>b</mml:mi></mml:mrow></mml:msub><mml:mo>:</mml:mo><mml:msub><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ir</mml:mtext></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:mi>θ</mml:mi></mml:math><inline-graphic xlink:href="13059_2014_550_Article_IEq62.gif"/></alternatives></inline-formula>. The one-sided <italic>P</italic> values are generated by integrating a normal distribution centered on <italic>θ</italic> with standard deviation SE(<italic>β</italic><sub><italic>ir</italic></sub>) from <italic>β</italic><sub><italic>ir</italic></sub> toward −<italic>∞</italic>, and integrating a normal distribution centered on −<italic>θ</italic> with standard deviation SE(<italic>β</italic><sub><italic>ir</italic></sub>) from <italic>β</italic><sub><italic>ir</italic></sub> toward <italic>∞</italic>.</p>
      <p>Note that while a zero-centered prior on LFCs is consistent with testing the null hypothesis of small LFCs, it should not be used when testing the null hypothesis of large LFCs, because the prior would then favor the alternative hypothesis. <italic>DESeq2</italic> requires that no prior has been used when testing the null hypothesis of large LFCs, so that the data alone must provide evidence against the null hypothesis.</p>
    </sec>
    <sec id="Sec27">
      <title>Interactions</title>
      <p>Two exceptions to the default <italic>DESeq2</italic> LFC estimation steps are used for experimental designs with interaction terms. First, when any interaction terms are included in the design, the LFC prior width for main effect terms is not estimated from the data, but set to a wide value (<inline-formula id="IEq63"><alternatives><tex-math id="M175">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
							${\sigma ^{2}_{r}} = (\log (2))^{2} \, 1000$
						\end{document}</tex-math><mml:math id="M176"><mml:msubsup><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mo>log</mml:mo><mml:mo>(</mml:mo><mml:mn>2</mml:mn><mml:mo>)</mml:mo><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mspace width="0.3em"/><mml:mn>1000</mml:mn></mml:math><inline-graphic xlink:href="13059_2014_550_Article_IEq63.gif"/></alternatives></inline-formula>, or 1000 on the base 2 scale). This ensures that shrinkage of main effect terms will not result in false positive calls of significance for interactions. Second, when interaction terms are included and all factors have two levels, then standard design matrices are used rather than expanded model matrices, such that only a single term is used to test the null hypothesis that a combination of two effects is merely additive in the logarithmic scale.</p>
    </sec>
    <sec id="Sec28">
      <title>Regularized logarithm</title>
      <p>The rlog transformation is calculated as follows. The experimental design matrix <italic>X</italic> is substituted with a design matrix with an indicator variable for every sample in addition to an intercept column. A model as described in Equations (<xref rid="Equ1" ref-type="">1</xref>) and (<xref rid="Equ2" ref-type="">2</xref>) is fit with a zero-centered normal prior on the non-intercept terms and using the fitted dispersion values <inline-formula id="IEq64"><alternatives><tex-math id="M177">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
							$\alpha _{\text {tr}}(\bar \mu)$
						\end{document}</tex-math><mml:math id="M178"><mml:msub><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mtext>tr</mml:mtext></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mover accent="true"><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mo>¯</mml:mo></mml:mover><mml:mo>)</mml:mo></mml:math><inline-graphic xlink:href="13059_2014_550_Article_IEq64.gif"/></alternatives></inline-formula>, which capture the overall variance-mean dependence of the dataset. The true experimental design matrix <italic>X</italic> is then only used in estimating the variance-mean trend over all genes. For unsupervised analyses, for instance sample quality assessment, it is desirable that the experimental design has no influence on the transformation, and hence <italic>DESeq2</italic> by default ignores the design matrix and re-estimates the dispersions treating all samples as replicates, i.e., it uses <italic>blind</italic> dispersion estimation. The rlog-transformed values are the fitted values,
<disp-formula id="Equp"><alternatives><tex-math id="M179">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
							 $$ \text{rlog}\left(K_{ij}\right) \equiv \log_{2} q_{ij} = \beta_{i0} + \beta_{ij}, $$ 
						\end{document}</tex-math><mml:math id="M180"><mml:mrow><mml:mtext>rlog</mml:mtext><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msub><mml:mrow><mml:mi>K</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ij</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:mfenced><mml:mo>≡</mml:mo><mml:munder><mml:mrow><mml:mo>log</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:munder><mml:msub><mml:mrow><mml:mi>q</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ij</mml:mtext></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ij</mml:mtext></mml:mrow></mml:msub><mml:mo>,</mml:mo></mml:mrow></mml:math><graphic xlink:href="13059_2014_550_Article_Equp.gif" position="anchor"/></alternatives></disp-formula> where <italic>β</italic><sub><italic>ij</italic></sub> is the shrunken LFC on the base 2 scale for the <italic>j</italic>th sample. The variance of the prior is set using a similar approach as taken with differential expression, by matching a zero-centered normal distribution to observed LFCs. First a matrix of LFCs is calculated by taking the logarithm (base 2) of the normalized counts plus a pseudocount of <inline-formula id="IEq65"><alternatives><tex-math id="M181">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
							$\frac {1}{2}$
						\end{document}</tex-math><mml:math id="M182"><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:mfrac></mml:math><inline-graphic xlink:href="13059_2014_550_Article_IEq65.gif"/></alternatives></inline-formula> for each sample divided by the mean of normalized counts plus a pseudocount of <inline-formula id="IEq66"><alternatives><tex-math id="M183">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
							$\frac {1}{2}$
						\end{document}</tex-math><mml:math id="M184"><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:mfrac></mml:math><inline-graphic xlink:href="13059_2014_550_Article_IEq66.gif"/></alternatives></inline-formula>. The pseudocount of <inline-formula id="IEq67"><alternatives><tex-math id="M185">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
							$\frac {1}{2}$
						\end{document}</tex-math><mml:math id="M186"><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:mfrac></mml:math><inline-graphic xlink:href="13059_2014_550_Article_IEq67.gif"/></alternatives></inline-formula> allows for calculation of the logarithmic ratio for all genes, and has little effect on the estimate of the variance of the prior or the final rlog transformation. This matrix of LFCs then represents the common-scale logarithmic ratio of each sample to the fitted value using only an intercept. The prior variance is found by matching the 97.5% quantile of a zero-centered normal distribution to the 95% quantile of the absolute values in the LFC matrix.</p>
    </sec>
    <sec id="Sec29">
      <title>Cook’s distance for outlier detection</title>
      <p>The MLE of <inline-formula id="IEq68"><alternatives><tex-math id="M187">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
							$\vec {\beta }_{i}$
						\end{document}</tex-math><mml:math id="M188"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mo>→</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13059_2014_550_Article_IEq68.gif"/></alternatives></inline-formula> is used for calculating Cook’s distance. Considering a gene <italic>i</italic> and sample <italic>j</italic>, Cook’s distance for GLMs is given by [<xref ref-type="bibr" rid="CR59">59</xref>]:
<disp-formula id="Equq"><alternatives><tex-math id="M189">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
							 $$ D_{ij} = \frac{R_{ij}^{2}}{\tau p} \frac{h_{jj}}{(1 - h_{jj})^{2}}, $$ 
						\end{document}</tex-math><mml:math id="M190"><mml:mrow><mml:msub><mml:mrow><mml:mi>D</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ij</mml:mtext></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msubsup><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ij</mml:mtext></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:mrow><mml:mrow><mml:mi>τp</mml:mi></mml:mrow></mml:mfrac><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi>h</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">jj</mml:mtext></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi>h</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">jj</mml:mtext></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mfrac><mml:mo>,</mml:mo></mml:mrow></mml:math><graphic xlink:href="13059_2014_550_Article_Equq.gif" position="anchor"/></alternatives></disp-formula> where <italic>R</italic><sub><italic>ij</italic></sub> is the Pearson residual of sample <italic>j</italic>, <italic>τ</italic> is an overdispersion parameter (in the negative binomial GLM, <italic>τ</italic> is set to 1), <italic>p</italic> is the number of parameters including the intercept, and <italic>h</italic><sub><italic>jj</italic></sub> is the <italic>j</italic>th diagonal element of the hat matrix <italic>H</italic>:
<disp-formula id="Equr"><alternatives><tex-math id="M191">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
							 $$ H = W^{1/2} X (X^{t} W X)^{-1} X^{t} W^{1/2}. $$ 
						\end{document}</tex-math><mml:math id="M192"><mml:mrow><mml:mi>H</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mi>W</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mi>X</mml:mi><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:msup><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msup><mml:mtext mathvariant="italic">WX</mml:mtext><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:msup><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msup><mml:msup><mml:mrow><mml:mi>W</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mi>.</mml:mi></mml:mrow></mml:math><graphic xlink:href="13059_2014_550_Article_Equr.gif" position="anchor"/></alternatives></disp-formula></p>
      <p>Pearson residuals <italic>R</italic><sub><italic>ij</italic></sub> are calculated as
<disp-formula id="Equs"><alternatives><tex-math id="M193">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
							 $$ R_{ij} = \frac{(K_{ij} - \mu_{ij})}{\sqrt{V(\mu_{ij})}}, $$ 
						\end{document}</tex-math><mml:math id="M194"><mml:mrow><mml:msub><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ij</mml:mtext></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>K</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ij</mml:mtext></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ij</mml:mtext></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:msqrt><mml:mrow><mml:mi>V</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ij</mml:mtext></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow></mml:msqrt></mml:mrow></mml:mfrac><mml:mo>,</mml:mo></mml:mrow></mml:math><graphic xlink:href="13059_2014_550_Article_Equs.gif" position="anchor"/></alternatives></disp-formula> where <italic>μ</italic><sub><italic>ij</italic></sub> is estimated by the negative binomial GLM without the LFC prior, and using the variance function <italic>V</italic>(<italic>μ</italic>)=<italic>μ</italic>+<italic>α</italic><italic>μ</italic><sup>2</sup>. A method-of-moments estimate <inline-formula id="IEq69"><alternatives><tex-math id="M195">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
							$\alpha _{i}^{\text {rob}}$
						\end{document}</tex-math><mml:math id="M196"><mml:msubsup><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mtext>rob</mml:mtext></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2014_550_Article_IEq69.gif"/></alternatives></inline-formula>, using a robust estimator of variance <inline-formula id="IEq70"><alternatives><tex-math id="M197">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
							$s_{i,\text {rob}}^{2}$
						\end{document}</tex-math><mml:math id="M198"><mml:msubsup><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mtext>rob</mml:mtext></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2014_550_Article_IEq70.gif"/></alternatives></inline-formula> to provide robustness against outliers, is used here:
<disp-formula id="Equt"><alternatives><tex-math id="M199">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
							 $$\alpha_{i}^{\text{rob}} = \operatorname{max} \left(\frac{s_{i,\text{rob}}^{2} - \bar\mu_{i}}{{\bar\mu_{i}^{2}}}, 0 \right). $$ 
						\end{document}</tex-math><mml:math id="M200"><mml:mrow><mml:msubsup><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mtext>rob</mml:mtext></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mo>max</mml:mo><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mfrac><mml:mrow><mml:munderover><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mtext>rob</mml:mtext></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:munderover><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mo>¯</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:munderover><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mo>¯</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:munderover></mml:mrow></mml:mfrac><mml:mo>,</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:mfenced><mml:mi>.</mml:mi></mml:mrow></mml:math><graphic xlink:href="13059_2014_550_Article_Equt.gif" position="anchor"/></alternatives></disp-formula></p>
    </sec>
    <sec id="Sec30">
      <title>R/Bioconductor package</title>
      <p><italic>DESeq2</italic> is implemented as a package for the R statistical environment and is available [<xref ref-type="bibr" rid="CR10">10</xref>] as part of the Bioconductor project [<xref ref-type="bibr" rid="CR11">11</xref>]. The count matrix and metadata, including the gene model and sample information, are stored in an S4 class derived from the <italic>SummarizedExperiment</italic> class of the <italic>GenomicRanges</italic> package [<xref ref-type="bibr" rid="CR60">60</xref>]. <italic>SummarizedExperiment</italic> objects containing count matrices can be easily generated using the <italic>summarizeOverlaps</italic> function of the <italic>GenomicAlignments</italic> package [<xref ref-type="bibr" rid="CR61">61</xref>]. This workflow automatically stores the gene model as metadata and additionally other information such as the genome and gene annotation versions. Other methods to obtain count matrices include the <italic>htseq-count</italic> script [<xref ref-type="bibr" rid="CR62">62</xref>] and the Bioconductor packages <italic>easyRNASeq</italic> [<xref ref-type="bibr" rid="CR63">63</xref>] and <italic>featureCount</italic> [<xref ref-type="bibr" rid="CR64">64</xref>].</p>
      <p>The <italic>DESeq2</italic> package comes with a detailed vignette, which works through a number of example differential expression analyses on real datasets, and the use of the rlog transformation for quality assessment and visualization. A single function, called <italic>DESeq</italic>, is used to run the default analysis, while lower-level functions are also available for advanced users.</p>
    </sec>
    <sec id="Sec31">
      <title>Read alignment for the Bottomly <italic>et al.</italic> and Pickrell <italic>et al.</italic> datasets</title>
      <p>Reads were aligned using the TopHat2 aligner [<xref ref-type="bibr" rid="CR65">65</xref>], and assigned to genes using the <italic>summarizeOverlaps</italic> function of the <italic>GenomicRanges</italic> package [<xref ref-type="bibr" rid="CR60">60</xref>]. The sequence read archive fastq files of the Pickrell <italic>et al.</italic> [<xref ref-type="bibr" rid="CR17">17</xref>] dataset (accession number [SRA:SRP001540]) were aligned to the <italic>Homo sapiens</italic> reference sequence GRCh37 downloaded in March 2013 from Illumina iGenomes. Reads were counted in the genes defined by the Ensembl GTF file, release 70, contained in the Illumina iGenome. The sequence read archive fastq files of the Bottomly <italic>et al.</italic> [<xref ref-type="bibr" rid="CR16">16</xref>] dataset (accession number [SRA:SRP004777]) were aligned to the <italic>Mus musculus</italic> reference sequence NCBIM37 downloaded in March 2013 from Illumina iGenomes. Reads were counted in the genes defined by the Ensembl GTF file, release 66, contained in the Illumina iGenome.</p>
    </sec>
    <sec id="Sec32">
      <title>Reproducible code</title>
      <p>Sweave vignettes for reproducing all figures and tables in this paper, including data objects for the experiments mentioned, and code for aligning reads and for benchmarking, can be found in a package <italic>DESeq2paper</italic> [<xref ref-type="bibr" rid="CR66">66</xref>].</p>
    </sec>
  </sec>
</body>
<back>
  <app-group>
    <app id="App1">
      <sec id="Sec33">
        <title>Additional file</title>
        <p>
          <media position="anchor" xlink:href="13059_2014_550_MOESM1_ESM.pdf" id="MOESM1">
            <label>Additional file 1</label>
            <caption>
              <p>
                <bold>Supplementary methods, tables and figures.</bold>
              </p>
            </caption>
          </media>
        </p>
      </sec>
    </app>
  </app-group>
  <glossary>
    <title>Abbreviations</title>
    <def-list>
      <def-list>
        <def-item>
          <term>FDR</term>
          <def>
            <p>False discovery rate</p>
          </def>
        </def-item>
        <def-item>
          <term>GLM</term>
          <def>
            <p>Generalized linear model</p>
          </def>
        </def-item>
        <def-item>
          <term>HTS</term>
          <def>
            <p>High-throughput sequencing</p>
          </def>
        </def-item>
        <def-item>
          <term>LFC</term>
          <def>
            <p>Logarithmic fold change</p>
          </def>
        </def-item>
        <def-item>
          <term>MAP</term>
          <def>
            <p>Maximum <italic>a posteriori</italic></p>
          </def>
        </def-item>
        <def-item>
          <term>MLE</term>
          <def>
            <p>Maximum-likelihood estimate</p>
          </def>
        </def-item>
        <def-item>
          <term>RNA-seq</term>
          <def>
            <p>RNA sequencing</p>
          </def>
        </def-item>
        <def-item>
          <term>VST</term>
          <def>
            <p>Variance-stabilizing transformation</p>
          </def>
        </def-item>
      </def-list>
    </def-list>
  </glossary>
  <fn-group>
    <fn>
      <p>
        <bold>Competing interests</bold>
      </p>
      <p>The authors declare that they have no competing interests.</p>
    </fn>
    <fn>
      <p>
        <bold>Authors’ contributions</bold>
      </p>
      <p>All authors developed the method and wrote the manuscript. MIL implemented the method and performed the analyses. All authors read and approved the final manuscript.</p>
    </fn>
  </fn-group>
  <ack>
    <title>Acknowledgements</title>
    <p>The authors thank all users of DESeq and DESeq2 who provided valuable feedback. We thank Judith Zaugg for helpful comments on the manuscript. MIL acknowledges funding via a stipend from the International Max Planck Research School for Computational Biology and Scientific Computing and a grant from the National Institutes of Health (5T32CA009337-33). WH and SA acknowledge funding from the European Union’s 7th Framework Programme (Health) via Project <italic>Radiant</italic>. We thank an anonymous reviewer for raising the question of estimation biases in the dispersion-mean trend fitting.</p>
  </ack>
  <ref-list id="Bib1">
    <title>References</title>
    <ref id="CR1">
      <label>1</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lönnstedt</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Speed</surname>
            <given-names>T</given-names>
          </name>
        </person-group>
        <article-title>
          <bold>Replicated microarray data</bold>
        </article-title>
        <source>Stat Sinica</source>
        <year>2002</year>
        <volume>12</volume>
        <fpage>31</fpage>
        <lpage>46</lpage>
      </element-citation>
    </ref>
    <ref id="CR2">
      <label>2</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Robinson</surname>
            <given-names>MD</given-names>
          </name>
          <name>
            <surname>Smyth</surname>
            <given-names>GK</given-names>
          </name>
        </person-group>
        <article-title>
          <bold>Moderated statistical tests for assessing differences in tag abundance</bold>
        </article-title>
        <source>Bioinformatics</source>
        <year>2007</year>
        <volume>23</volume>
        <fpage>2881</fpage>
        <lpage>2887</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btm453</pub-id>
        <?supplied-pmid 17881408?>
        <pub-id pub-id-type="pmid">17881408</pub-id>
      </element-citation>
    </ref>
    <ref id="CR3">
      <label>3</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>McCarthy</surname>
            <given-names>DJ</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Smyth</surname>
            <given-names>GK</given-names>
          </name>
        </person-group>
        <article-title>
          <bold>Differential expression analysis of multifactor RNA-seq experiments with respect to biological variation</bold>
        </article-title>
        <source>Nucleic Acids Res</source>
        <year>2012</year>
        <volume>40</volume>
        <fpage>4288</fpage>
        <lpage>4297</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/gks042</pub-id>
        <?supplied-pmid 22287627?>
        <pub-id pub-id-type="pmid">22287627</pub-id>
      </element-citation>
    </ref>
    <ref id="CR4">
      <label>4</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Anders</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Huber</surname>
            <given-names>W</given-names>
          </name>
        </person-group>
        <article-title>
          <bold>Differential expression analysis for sequence count data</bold>
        </article-title>
        <source>Genome Biol</source>
        <year>2010</year>
        <volume>11</volume>
        <fpage>106</fpage>
        <pub-id pub-id-type="doi">10.1186/gb-2010-11-10-r106</pub-id>
        <pub-id pub-id-type="pmid">20236492</pub-id>
      </element-citation>
    </ref>
    <ref id="CR5">
      <label>5</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zhou</surname>
            <given-names>Y-H</given-names>
          </name>
          <name>
            <surname>Xia</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Wright</surname>
            <given-names>FA</given-names>
          </name>
        </person-group>
        <article-title>
          <bold>A powerful and flexible approach to the analysis of RNA sequence count data</bold>
        </article-title>
        <source>Bioinformatics</source>
        <year>2011</year>
        <volume>27</volume>
        <fpage>2672</fpage>
        <lpage>2678</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btr449</pub-id>
        <?supplied-pmid 21810900?>
        <pub-id pub-id-type="pmid">21810900</pub-id>
      </element-citation>
    </ref>
    <ref id="CR6">
      <label>6</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wu</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Wu</surname>
            <given-names>Z</given-names>
          </name>
        </person-group>
        <article-title>
          <bold>A new shrinkage estimator for dispersion improves differential expression detection in RNA-seq data</bold>
        </article-title>
        <source>Biostatistics</source>
        <year>2013</year>
        <volume>14</volume>
        <fpage>232</fpage>
        <lpage>243</lpage>
        <pub-id pub-id-type="doi">10.1093/biostatistics/kxs033</pub-id>
        <?supplied-pmid 23001152?>
        <pub-id pub-id-type="pmid">23001152</pub-id>
      </element-citation>
    </ref>
    <ref id="CR7">
      <label>7</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hardcastle</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Kelly</surname>
            <given-names>K</given-names>
          </name>
        </person-group>
        <article-title>
          <bold>baySeq: empirical Bayesian methods for identifying differential expression in sequence count data</bold>
        </article-title>
        <source>BMC Bioinformatics</source>
        <year>2010</year>
        <volume>11</volume>
        <fpage>422</fpage>
        <pub-id pub-id-type="doi">10.1186/1471-2105-11-422</pub-id>
        <?supplied-pmid 20698981?>
        <pub-id pub-id-type="pmid">20698981</pub-id>
      </element-citation>
    </ref>
    <ref id="CR8">
      <label>8</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Van De Wiel</surname>
            <given-names>MA</given-names>
          </name>
          <name>
            <surname>Leday</surname>
            <given-names>GGR</given-names>
          </name>
          <name>
            <surname>Pardo</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Rue</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Van Der Vaart</surname>
            <given-names>AW</given-names>
          </name>
          <name>
            <surname>Van Wieringen</surname>
            <given-names>WN</given-names>
          </name>
        </person-group>
        <article-title>
          <bold>Bayesian analysis of RNA sequencing data by estimating multiple shrinkage priors</bold>
        </article-title>
        <source>Biostatistics</source>
        <year>2013</year>
        <volume>14</volume>
        <fpage>113</fpage>
        <lpage>128</lpage>
        <pub-id pub-id-type="doi">10.1093/biostatistics/kxs031</pub-id>
        <?supplied-pmid 22988280?>
        <pub-id pub-id-type="pmid">22988280</pub-id>
      </element-citation>
    </ref>
    <ref id="CR9">
      <label>9</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Boer</surname>
            <given-names>JM</given-names>
          </name>
          <name>
            <surname>Huber</surname>
            <given-names>WK</given-names>
          </name>
          <name>
            <surname>Sültmann</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Wilmer</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>von Heydebreck</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Haas</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Korn</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Gunawan</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Vente</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Füzesi</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Vingron</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Poustka</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>
          <bold>Identification and classification of differentially expressed genes in renal cell carcinoma by expression profiling on a global human 31,500-element cDNA array</bold>
        </article-title>
        <source>Genome Res</source>
        <year>2001</year>
        <volume>11</volume>
        <fpage>1861</fpage>
        <lpage>1870</lpage>
        <?supplied-pmid 11691851?>
        <pub-id pub-id-type="pmid">11691851</pub-id>
      </element-citation>
    </ref>
    <ref id="CR10">
      <label>10</label>
      <mixed-citation publication-type="other"><bold>DESeq2</bold>. [http://www.bioconductor.org/packages/release/bioc/html/DESeq2.html]</mixed-citation>
    </ref>
    <ref id="CR11">
      <label>11</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Gentleman</surname>
            <given-names>RC</given-names>
          </name>
          <name>
            <surname>Carey</surname>
            <given-names>VJ</given-names>
          </name>
          <name>
            <surname>Bates</surname>
            <given-names>DM</given-names>
          </name>
          <name>
            <surname>Bolstad</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Dettling</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Dudoit</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Ellis</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Gautier</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Ge</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Gentry</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Hornik</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Hothorn</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Huber</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Iacus</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Irizarry</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Leisch</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Maechler</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Rossini</surname>
            <given-names>AJ</given-names>
          </name>
          <name>
            <surname>Sawitzki</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Smith</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Smyth</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Tierney</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Yang</surname>
            <given-names>JY</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>
          <bold>Bioconductor: open software development for computational biology and bioinformatics</bold>
        </article-title>
        <source>Genome Biol</source>
        <year>2004</year>
        <volume>5</volume>
        <fpage>R80</fpage>
        <pub-id pub-id-type="doi">10.1186/gb-2004-5-10-r80</pub-id>
        <?supplied-pmid 15461798?>
        <pub-id pub-id-type="pmid">15461798</pub-id>
      </element-citation>
    </ref>
    <ref id="CR12">
      <label>12</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>McCullagh</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Nelder</surname>
            <given-names>JA</given-names>
          </name>
        </person-group>
        <article-title>
          <bold>Generalized linear models</bold>
        </article-title>
        <source>
          <italic>Monographs on Statistics &amp; Applied Probability</italic>
        </source>
        <year>1989</year>
        <publisher-loc>London, UK</publisher-loc>
        <publisher-name>Chapman &amp; Hall/CRC</publisher-name>
      </element-citation>
    </ref>
    <ref id="CR13">
      <label>13</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hansen</surname>
            <given-names>KD</given-names>
          </name>
          <name>
            <surname>Irizarry</surname>
            <given-names>RA</given-names>
          </name>
          <name>
            <surname>Wu</surname>
            <given-names>Z</given-names>
          </name>
        </person-group>
        <article-title>
          <bold>Removing technical variability in RNA-seq data using conditional quantile normalization</bold>
        </article-title>
        <source>Biostatistics</source>
        <year>2012</year>
        <volume>13</volume>
        <fpage>204</fpage>
        <lpage>216</lpage>
        <pub-id pub-id-type="doi">10.1093/biostatistics/kxr054</pub-id>
        <?supplied-pmid 22285995?>
        <pub-id pub-id-type="pmid">22285995</pub-id>
      </element-citation>
    </ref>
    <ref id="CR14">
      <label>14</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Risso</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Schwartz</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Sherlock</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Dudoit</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>
          <bold>GC-content normalization for RNA-seq data</bold>
        </article-title>
        <source>BMC Bioinformatics</source>
        <year>2011</year>
        <volume>12</volume>
        <fpage>480</fpage>
        <pub-id pub-id-type="doi">10.1186/1471-2105-12-480</pub-id>
        <?supplied-pmid 22177264?>
        <pub-id pub-id-type="pmid">22177264</pub-id>
      </element-citation>
    </ref>
    <ref id="CR15">
      <label>15</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Smyth</surname>
            <given-names>GK</given-names>
          </name>
        </person-group>
        <article-title>
          <bold>Linear models and empirical Bayes methods for assessing differential expression in microarray experiments</bold>
        </article-title>
        <source>Stat Appl Genet Mol Biol</source>
        <year>2004</year>
        <volume>3</volume>
        <fpage>1</fpage>
        <lpage>25</lpage>
      </element-citation>
    </ref>
    <ref id="CR16">
      <label>16</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bottomly</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Walter</surname>
            <given-names>NAR</given-names>
          </name>
          <name>
            <surname>Hunter</surname>
            <given-names>JE</given-names>
          </name>
          <name>
            <surname>Darakjian</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Kawane</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Buck</surname>
            <given-names>KJ</given-names>
          </name>
          <name>
            <surname>Searles</surname>
            <given-names>RP</given-names>
          </name>
          <name>
            <surname>Mooney</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>McWeeney</surname>
            <given-names>SK</given-names>
          </name>
          <name>
            <surname>Hitzemann</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>
          <bold>Evaluating gene expression in C57BL/6J and DBA/2J mouse striatum using RNA-seq and microarrays</bold>
        </article-title>
        <source>PLoS ONE</source>
        <year>2011</year>
        <volume>6</volume>
        <fpage>17820</fpage>
        <pub-id pub-id-type="doi">10.1371/journal.pone.0017820</pub-id>
      </element-citation>
    </ref>
    <ref id="CR17">
      <label>17</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Pickrell</surname>
            <given-names>JK</given-names>
          </name>
          <name>
            <surname>Marioni</surname>
            <given-names>JC</given-names>
          </name>
          <name>
            <surname>Pai</surname>
            <given-names>AA</given-names>
          </name>
          <name>
            <surname>Degner</surname>
            <given-names>JF</given-names>
          </name>
          <name>
            <surname>Engelhardt</surname>
            <given-names>BE</given-names>
          </name>
          <name>
            <surname>Nkadori</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Veyrieras</surname>
            <given-names>J-B</given-names>
          </name>
          <name>
            <surname>Stephens</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Gilad</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Pritchard</surname>
            <given-names>JK</given-names>
          </name>
        </person-group>
        <article-title>
          <bold>Understanding mechanisms underlying human gene expression variation with RNA sequencing</bold>
        </article-title>
        <source>Nature</source>
        <year>2010</year>
        <volume>464</volume>
        <fpage>768</fpage>
        <lpage>772</lpage>
        <pub-id pub-id-type="doi">10.1038/nature08872</pub-id>
        <?supplied-pmid 20220758?>
        <pub-id pub-id-type="pmid">20220758</pub-id>
      </element-citation>
    </ref>
    <ref id="CR18">
      <label>18</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Hastie</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Tibshirani</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Friedman</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <source>
          <italic>The Elements of Statistical Learning: Data Mining, Inference, and Prediction</italic>
        </source>
        <year>2009</year>
        <publisher-loc>New York City, USA</publisher-loc>
        <publisher-name>Springer</publisher-name>
      </element-citation>
    </ref>
    <ref id="CR19">
      <label>19</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bi</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Davuluri</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>
          <bold>NPEBseq: nonparametric empirical Bayesian-based procedure for differential expression analysis of RNA-seq data</bold>
        </article-title>
        <source>BMC Bioinformatics</source>
        <year>2013</year>
        <volume>14</volume>
        <fpage>262</fpage>
        <pub-id pub-id-type="doi">10.1186/1471-2105-14-262</pub-id>
        <?supplied-pmid 23981227?>
        <pub-id pub-id-type="pmid">23981227</pub-id>
      </element-citation>
    </ref>
    <ref id="CR20">
      <label>20</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Feng</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Meyer</surname>
            <given-names>CA</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>Q</given-names>
          </name>
          <name>
            <surname>Liu</surname>
            <given-names>JS</given-names>
          </name>
          <name>
            <surname>Liu</surname>
            <given-names>XS</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>Y</given-names>
          </name>
        </person-group>
        <article-title>
          <bold>GFOLD: a generalized fold change for ranking differentially expressed genes from RNA-seq data</bold>
        </article-title>
        <source>Bioinformatics</source>
        <year>2012</year>
        <volume>28</volume>
        <fpage>2782</fpage>
        <lpage>2788</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/bts515</pub-id>
        <?supplied-pmid 22923299?>
        <pub-id pub-id-type="pmid">22923299</pub-id>
      </element-citation>
    </ref>
    <ref id="CR21">
      <label>21</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Benjamini</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Hochberg</surname>
            <given-names>Y</given-names>
          </name>
        </person-group>
        <article-title>
          <bold>Controlling the false discovery rate: a practical and powerful approach to multiple testing</bold>
        </article-title>
        <source>J R Stat Soc Ser B Methodol</source>
        <year>1995</year>
        <volume>57</volume>
        <fpage>289</fpage>
        <lpage>300</lpage>
      </element-citation>
    </ref>
    <ref id="CR22">
      <label>22</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bourgon</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Gentleman</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Huber</surname>
            <given-names>W</given-names>
          </name>
        </person-group>
        <article-title>
          <bold>Independent filtering increases detection power for high-throughput experiments</bold>
        </article-title>
        <source>Proc Natl Acad Sci USA</source>
        <year>2010</year>
        <volume>107</volume>
        <fpage>9546</fpage>
        <lpage>9551</lpage>
        <pub-id pub-id-type="doi">10.1073/pnas.0914005107</pub-id>
        <?supplied-pmid 20460310?>
        <pub-id pub-id-type="pmid">20460310</pub-id>
      </element-citation>
    </ref>
    <ref id="CR23">
      <label>23</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>McCarthy</surname>
            <given-names>DJ</given-names>
          </name>
          <name>
            <surname>Smyth</surname>
            <given-names>GK</given-names>
          </name>
        </person-group>
        <article-title>
          <bold>Testing significance relative to a fold-change threshold is a TREAT</bold>
        </article-title>
        <source>Bioinformatics</source>
        <year>2009</year>
        <volume>25</volume>
        <fpage>765</fpage>
        <lpage>771</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btp053</pub-id>
        <?supplied-pmid 19176553?>
        <pub-id pub-id-type="pmid">19176553</pub-id>
      </element-citation>
    </ref>
    <ref id="CR24">
      <label>24</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Li</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Tibshirani</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>
          <bold>Finding consistent patterns: a nonparametric approach for identifying differential expression in RNA-seq data</bold>
        </article-title>
        <source>Stat Methods Med Res</source>
        <year>2013</year>
        <volume>22</volume>
        <fpage>519</fpage>
        <lpage>536</lpage>
        <pub-id pub-id-type="doi">10.1177/0962280211428386</pub-id>
        <?supplied-pmid 22127579?>
        <pub-id pub-id-type="pmid">22127579</pub-id>
      </element-citation>
    </ref>
    <ref id="CR25">
      <label>25</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Cook</surname>
            <given-names>RD</given-names>
          </name>
        </person-group>
        <article-title>
          <bold>Detection of influential observation in linear regression</bold>
        </article-title>
        <source>Technometrics</source>
        <year>1977</year>
        <volume>19</volume>
        <fpage>15</fpage>
        <lpage>18</lpage>
        <pub-id pub-id-type="doi">10.2307/1268249</pub-id>
      </element-citation>
    </ref>
    <ref id="CR26">
      <label>26</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hammer</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Banck</surname>
            <given-names>MS</given-names>
          </name>
          <name>
            <surname>Amberg</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Petznick</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Luo</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Khrebtukova</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Schroth</surname>
            <given-names>GP</given-names>
          </name>
          <name>
            <surname>Beyerlein</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Beutler</surname>
            <given-names>AS</given-names>
          </name>
        </person-group>
        <article-title>
          <bold>mRNA-seq with agnostic splice site discovery for nervous system transcriptomics tested in chronic pain</bold>
        </article-title>
        <source>Genome Res</source>
        <year>2010</year>
        <volume>20</volume>
        <fpage>847</fpage>
        <lpage>860</lpage>
        <pub-id pub-id-type="doi">10.1101/gr.101204.109</pub-id>
        <?supplied-pmid 20452967?>
        <pub-id pub-id-type="pmid">20452967</pub-id>
      </element-citation>
    </ref>
    <ref id="CR27">
      <label>27</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Frazee</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Langmead</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Leek</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>
          <bold>ReCount: a multi-experiment resource of analysis-ready RNA-seq gene count datasets</bold>
        </article-title>
        <source>BMC Bioinformatics</source>
        <year>2011</year>
        <volume>12</volume>
        <fpage>449</fpage>
        <pub-id pub-id-type="doi">10.1186/1471-2105-12-449</pub-id>
        <?supplied-pmid 22087737?>
        <pub-id pub-id-type="pmid">22087737</pub-id>
      </element-citation>
    </ref>
    <ref id="CR28">
      <label>28</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Trapnell</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Hendrickson</surname>
            <given-names>DG</given-names>
          </name>
          <name>
            <surname>Sauvageau</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Goff</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Rinn</surname>
            <given-names>JL</given-names>
          </name>
          <name>
            <surname>Pachter</surname>
            <given-names>L</given-names>
          </name>
        </person-group>
        <article-title>
          <bold>Differential analysis of gene regulation at transcript resolution with RNA-seq</bold>
        </article-title>
        <source>Nat Biotechnol</source>
        <year>2012</year>
        <volume>31</volume>
        <fpage>46</fpage>
        <lpage>53</lpage>
        <pub-id pub-id-type="doi">10.1038/nbt.2450</pub-id>
        <?supplied-pmid 23222703?>
        <pub-id pub-id-type="pmid">23222703</pub-id>
      </element-citation>
    </ref>
    <ref id="CR29">
      <label>29</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Glaus</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Honkela</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Rattray</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>
          <bold>Identifying differentially expressed transcripts from RNA-seq data with biological variation</bold>
        </article-title>
        <source>Bioinformatics</source>
        <year>2012</year>
        <volume>28</volume>
        <fpage>1721</fpage>
        <lpage>1728</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/bts260</pub-id>
        <?supplied-pmid 22563066?>
        <pub-id pub-id-type="pmid">22563066</pub-id>
      </element-citation>
    </ref>
    <ref id="CR30">
      <label>30</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Anders</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Reyes</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Huber</surname>
            <given-names>W</given-names>
          </name>
        </person-group>
        <article-title>
          <bold>Detecting differential usage of exons from RNA-seq data</bold>
        </article-title>
        <source>Genome Res</source>
        <year>2012</year>
        <volume>22</volume>
        <fpage>2008</fpage>
        <lpage>2017</lpage>
        <pub-id pub-id-type="doi">10.1101/gr.133744.111</pub-id>
        <?supplied-pmid 22722343?>
        <pub-id pub-id-type="pmid">22722343</pub-id>
      </element-citation>
    </ref>
    <ref id="CR31">
      <label>31</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Sammeth</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>
          <bold>Complete alternative splicing events are bubbles in splicing graphs</bold>
        </article-title>
        <source>J Comput Biol</source>
        <year>2009</year>
        <volume>16</volume>
        <fpage>1117</fpage>
        <lpage>1140</lpage>
        <pub-id pub-id-type="doi">10.1089/cmb.2009.0108</pub-id>
        <?supplied-pmid 19689216?>
        <pub-id pub-id-type="pmid">19689216</pub-id>
      </element-citation>
    </ref>
    <ref id="CR32">
      <label>32</label>
      <mixed-citation publication-type="other">Pagès H, Bindreither D, Carlson M, Morgan M: <bold>SplicingGraphs: create, manipulate, visualize splicing graphs, and assign RNA-seq reads to them</bold>2013. Bioconductor package [http://www.bioconductor.org]</mixed-citation>
    </ref>
    <ref id="CR33">
      <label>33</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Robinson</surname>
            <given-names>MD</given-names>
          </name>
          <name>
            <surname>McCarthy</surname>
            <given-names>DJ</given-names>
          </name>
          <name>
            <surname>Smyth</surname>
            <given-names>GK</given-names>
          </name>
        </person-group>
        <article-title>
          <bold>edgeR: a Bioconductor package for differential expression analysis of digital gene expression data</bold>
        </article-title>
        <source>Bioinformatics</source>
        <year>2009</year>
        <volume>26</volume>
        <fpage>139</fpage>
        <lpage>140</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btp616</pub-id>
        <?supplied-pmid 19910308?>
        <pub-id pub-id-type="pmid">19910308</pub-id>
      </element-citation>
    </ref>
    <ref id="CR34">
      <label>34</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zhou</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Lindsay</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Robinson</surname>
            <given-names>MD</given-names>
          </name>
        </person-group>
        <article-title>
          <bold>Robustly detecting differential expression in RNA sequencing data using observation weights</bold>
        </article-title>
        <source>Nucleic Acids Res</source>
        <year>2014</year>
        <volume>42</volume>
        <fpage>e91</fpage>
        <pub-id pub-id-type="doi">10.1093/nar/gku310</pub-id>
        <?supplied-pmid 24753412?>
        <pub-id pub-id-type="pmid">24753412</pub-id>
      </element-citation>
    </ref>
    <ref id="CR35">
      <label>35</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Leng</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Dawson</surname>
            <given-names>JA</given-names>
          </name>
          <name>
            <surname>Thomson</surname>
            <given-names>JA</given-names>
          </name>
          <name>
            <surname>Ruotti</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Rissman</surname>
            <given-names>AI</given-names>
          </name>
          <name>
            <surname>Smits</surname>
            <given-names>BMG</given-names>
          </name>
          <name>
            <surname>Haag</surname>
            <given-names>JD</given-names>
          </name>
          <name>
            <surname>Gould</surname>
            <given-names>MN</given-names>
          </name>
          <name>
            <surname>Stewart</surname>
            <given-names>RM</given-names>
          </name>
          <name>
            <surname>Kendziorski</surname>
            <given-names>C</given-names>
          </name>
        </person-group>
        <article-title>
          <bold>EBSeq: an empirical Bayes hierarchical model for inference in RNA-seq experiments</bold>
        </article-title>
        <source>Bioinformatics</source>
        <year>2013</year>
        <volume>29</volume>
        <fpage>1035</fpage>
        <lpage>1043</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btt087</pub-id>
        <?supplied-pmid 23428641?>
        <pub-id pub-id-type="pmid">23428641</pub-id>
      </element-citation>
    </ref>
    <ref id="CR36">
      <label>36</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Law</surname>
            <given-names>CW</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Shi</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Smyth</surname>
            <given-names>GK</given-names>
          </name>
        </person-group>
        <article-title>
          <bold>Voom: precision weights unlock linear model analysis tools for RNA-seq read counts</bold>
        </article-title>
        <source>Genome Biol</source>
        <year>2014</year>
        <volume>15</volume>
        <fpage>29</fpage>
        <pub-id pub-id-type="doi">10.1186/gb-2014-15-2-r29</pub-id>
      </element-citation>
    </ref>
    <ref id="CR37">
      <label>37</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hubert</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Arabie</surname>
            <given-names>P</given-names>
          </name>
        </person-group>
        <article-title>
          <bold>Comparing partitions</bold>
        </article-title>
        <source>J Classif</source>
        <year>1985</year>
        <volume>2</volume>
        <fpage>193</fpage>
        <lpage>218</lpage>
        <pub-id pub-id-type="doi">10.1007/BF01908075</pub-id>
      </element-citation>
    </ref>
    <ref id="CR38">
      <label>38</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Witten</surname>
            <given-names>DM</given-names>
          </name>
        </person-group>
        <article-title>
          <bold>Classification and clustering of sequencing data using a Poisson model</bold>
        </article-title>
        <source>Ann Appl Stat</source>
        <year>2011</year>
        <volume>5</volume>
        <fpage>2493</fpage>
        <lpage>2518</lpage>
        <pub-id pub-id-type="doi">10.1214/11-AOAS493</pub-id>
      </element-citation>
    </ref>
    <ref id="CR39">
      <label>39</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Irizarry</surname>
            <given-names>RA</given-names>
          </name>
          <name>
            <surname>Wu</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Jaffee</surname>
            <given-names>HA</given-names>
          </name>
        </person-group>
        <article-title>
          <bold>Comparison of affymetrix GeneChip expression measures</bold>
        </article-title>
        <source>Bioinformatics</source>
        <year>2006</year>
        <volume>22</volume>
        <fpage>789</fpage>
        <lpage>794</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btk046</pub-id>
        <?supplied-pmid 16410320?>
        <pub-id pub-id-type="pmid">16410320</pub-id>
      </element-citation>
    </ref>
    <ref id="CR40">
      <label>40</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Asangani</surname>
            <given-names>IA</given-names>
          </name>
          <name>
            <surname>Dommeti</surname>
            <given-names>VL</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Malik</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Cieslik</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Yang</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Escara-Wilke</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Wilder-Romans</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Dhanireddy</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Engelke</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Iyer</surname>
            <given-names>MK</given-names>
          </name>
          <name>
            <surname>Jing</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Wu</surname>
            <given-names>Y-M</given-names>
          </name>
          <name>
            <surname>Cao</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Qin</surname>
            <given-names>ZS</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Feng</surname>
            <given-names>FY</given-names>
          </name>
          <name>
            <surname>Chinnaiyan</surname>
            <given-names>AM</given-names>
          </name>
        </person-group>
        <article-title>
          <bold>Therapeutic targeting of BET bromodomain proteins in castration-resistant prostate cancer</bold>
        </article-title>
        <source>Nature</source>
        <year>2014</year>
        <volume>510</volume>
        <fpage>278</fpage>
        <lpage>282</lpage>
        <pub-id pub-id-type="doi">10.1038/nature13229</pub-id>
        <?supplied-pmid 24759320?>
        <pub-id pub-id-type="pmid">24759320</pub-id>
      </element-citation>
    </ref>
    <ref id="CR41">
      <label>41</label>
      <mixed-citation publication-type="other">Stark R, Brown G: <bold>DiffBind: differential binding analysis of ChIP-seq peak data</bold>2013. Bioconductor package [http://www.bioconductor.org]</mixed-citation>
    </ref>
    <ref id="CR42">
      <label>42</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ross-Innes</surname>
            <given-names>CS</given-names>
          </name>
          <name>
            <surname>Stark</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Teschendorff</surname>
            <given-names>AE</given-names>
          </name>
          <name>
            <surname>Holmes</surname>
            <given-names>KA</given-names>
          </name>
          <name>
            <surname>Ali</surname>
            <given-names>HR</given-names>
          </name>
          <name>
            <surname>Dunning</surname>
            <given-names>MJ</given-names>
          </name>
          <name>
            <surname>Brown</surname>
            <given-names>GD</given-names>
          </name>
          <name>
            <surname>Gojis</surname>
            <given-names>O</given-names>
          </name>
          <name>
            <surname>Ellis</surname>
            <given-names>IO</given-names>
          </name>
          <name>
            <surname>Green</surname>
            <given-names>AR</given-names>
          </name>
          <name>
            <surname>Ali</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Chin</surname>
            <given-names>S-F</given-names>
          </name>
          <name>
            <surname>Palmieri</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Caldas</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Carroll</surname>
            <given-names>JS</given-names>
          </name>
        </person-group>
        <article-title>
          <bold>Differential oestrogen receptor binding is associated with clinical outcome in breast cancer</bold>
        </article-title>
        <source>Nature</source>
        <year>2012</year>
        <volume>481</volume>
        <fpage>389</fpage>
        <lpage>393</lpage>
        <?supplied-pmid 22217937?>
        <pub-id pub-id-type="pmid">22217937</pub-id>
      </element-citation>
    </ref>
    <ref id="CR43">
      <label>43</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Robinson</surname>
            <given-names>DG</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Storey</surname>
            <given-names>JD</given-names>
          </name>
          <name>
            <surname>Gresham</surname>
            <given-names>D</given-names>
          </name>
        </person-group>
        <article-title>
          <bold>Design and analysis of bar-seq experiments</bold>
        </article-title>
        <source>G3 (Bethesda)</source>
        <year>2013</year>
        <volume>4</volume>
        <fpage>11</fpage>
        <lpage>18</lpage>
        <pub-id pub-id-type="doi">10.1534/g3.113.008565</pub-id>
        <pub-id pub-id-type="pmid">24192834</pub-id>
      </element-citation>
    </ref>
    <ref id="CR44">
      <label>44</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>McMurdie</surname>
            <given-names>PJ</given-names>
          </name>
          <name>
            <surname>Holmes</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>
          <bold>Waste not, want not: why rarefying microbiome data is inadmissible</bold>
        </article-title>
        <source>PLoS Comput Biol</source>
        <year>2014</year>
        <volume>10</volume>
        <fpage>1003531</fpage>
        <pub-id pub-id-type="doi">10.1371/journal.pcbi.1003531</pub-id>
      </element-citation>
    </ref>
    <ref id="CR45">
      <label>45</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Vasquez</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Hon</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Vanselow</surname>
            <given-names>JT</given-names>
          </name>
          <name>
            <surname>Schlosser</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Siegel</surname>
            <given-names>TN</given-names>
          </name>
        </person-group>
        <article-title>
          <bold>Comparative ribosome profiling reveals extensive translational complexity in different Trypanosoma brucei life cycle stages</bold>
        </article-title>
        <source>Nucleic Acids Res</source>
        <year>2014</year>
        <volume>42</volume>
        <fpage>3623</fpage>
        <lpage>3637</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/gkt1386</pub-id>
        <?supplied-pmid 24442674?>
        <pub-id pub-id-type="pmid">24442674</pub-id>
      </element-citation>
    </ref>
    <ref id="CR46">
      <label>46</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zhou</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Zhu</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Cai</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Yuan</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Huang</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Wei</surname>
            <given-names>W</given-names>
          </name>
        </person-group>
        <article-title>
          <bold>High-throughput screening of a CRISPR/Cas9 library for functional genomics in human cells</bold>
        </article-title>
        <source>Nature</source>
        <year>2014</year>
        <volume>509</volume>
        <fpage>487</fpage>
        <lpage>491</lpage>
        <pub-id pub-id-type="doi">10.1038/nature13166</pub-id>
        <?supplied-pmid 24717434?>
        <pub-id pub-id-type="pmid">24717434</pub-id>
      </element-citation>
    </ref>
    <ref id="CR47">
      <label>47</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Cox</surname>
            <given-names>DR</given-names>
          </name>
          <name>
            <surname>Reid</surname>
            <given-names>N</given-names>
          </name>
        </person-group>
        <article-title>
          <bold>Parameter orthogonality and approximate conditional inference</bold>
        </article-title>
        <source>J R Stat Soc Ser B Methodol</source>
        <year>1987</year>
        <volume>49</volume>
        <fpage>1</fpage>
        <lpage>39</lpage>
      </element-citation>
    </ref>
    <ref id="CR48">
      <label>48</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Robinson</surname>
            <given-names>MD</given-names>
          </name>
          <name>
            <surname>Smyth</surname>
            <given-names>GK</given-names>
          </name>
        </person-group>
        <article-title>
          <bold>Small-sample estimation of negative binomial dispersion, with applications to SAGE data</bold>
        </article-title>
        <source>Biostatistics</source>
        <year>2007</year>
        <volume>9</volume>
        <fpage>321</fpage>
        <lpage>332</lpage>
        <pub-id pub-id-type="doi">10.1093/biostatistics/kxm030</pub-id>
        <?supplied-pmid 17728317?>
        <pub-id pub-id-type="pmid">17728317</pub-id>
      </element-citation>
    </ref>
    <ref id="CR49">
      <label>49</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Pawitan</surname>
            <given-names>Y</given-names>
          </name>
        </person-group>
        <source>
          <italic>In All Likelihood: Statistical Modelling and Inference Using Likelihood</italic>
        </source>
        <year>2001</year>
        <publisher-loc>New York City, USA</publisher-loc>
        <publisher-name>Oxford University Press</publisher-name>
      </element-citation>
    </ref>
    <ref id="CR50">
      <label>50</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Armijo</surname>
            <given-names>L</given-names>
          </name>
        </person-group>
        <article-title>
          <bold>Minimization of functions having Lipschitz continuous first partial derivatives</bold>
        </article-title>
        <source>Pac J Math</source>
        <year>1966</year>
        <volume>16</volume>
        <fpage>1</fpage>
        <lpage>3</lpage>
        <pub-id pub-id-type="doi">10.2140/pjm.1966.16.1</pub-id>
      </element-citation>
    </ref>
    <ref id="CR51">
      <label>51</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Di</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Schafer</surname>
            <given-names>DW</given-names>
          </name>
          <name>
            <surname>Cumbie</surname>
            <given-names>JS</given-names>
          </name>
          <name>
            <surname>Chang</surname>
            <given-names>JH</given-names>
          </name>
        </person-group>
        <article-title>
          <bold>The NBP negative binomial model for assessing differential gene expression from RNA-seq</bold>
        </article-title>
        <source>Stat Appl Genet Mol Biol</source>
        <year>2011</year>
        <volume>10</volume>
        <fpage>1</fpage>
        <lpage>28</lpage>
      </element-citation>
    </ref>
    <ref id="CR52">
      <label>52</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Abramowitz</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Stegun</surname>
            <given-names>I</given-names>
          </name>
        </person-group>
        <source>
          <italic>Handbook of Mathematical Functions</italic>
        </source>
        <year>1965</year>
        <publisher-loc>New York, USA</publisher-loc>
        <publisher-name>Dover Publications</publisher-name>
      </element-citation>
    </ref>
    <ref id="CR53">
      <label>53</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Newton</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Kendziorski</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Richmond</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Blattner</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Tsui</surname>
            <given-names>K</given-names>
          </name>
        </person-group>
        <article-title>
          <bold>On differential variability of expression ratios: improving statistical inference about gene expression changes from microarray data</bold>
        </article-title>
        <source>J Comput Biol</source>
        <year>2001</year>
        <volume>8</volume>
        <fpage>37</fpage>
        <lpage>52</lpage>
        <pub-id pub-id-type="doi">10.1089/106652701300099074</pub-id>
        <?supplied-pmid 11339905?>
        <pub-id pub-id-type="pmid">11339905</pub-id>
      </element-citation>
    </ref>
    <ref id="CR54">
      <label>54</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Huber</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>von Heydebreck</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Sultmann</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Poustka</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Vingron</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>
          <bold>Variance stabilization applied to microarray data calibration and to the quantification of differential expression</bold>
        </article-title>
        <source>Bioinformatics</source>
        <year>2002</year>
        <volume>18</volume>
        <fpage>96</fpage>
        <lpage>104</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/18.suppl_1.S96</pub-id>
      </element-citation>
    </ref>
    <ref id="CR55">
      <label>55</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Durbin</surname>
            <given-names>BP</given-names>
          </name>
          <name>
            <surname>Hardin</surname>
            <given-names>JS</given-names>
          </name>
          <name>
            <surname>Hawkins</surname>
            <given-names>DM</given-names>
          </name>
          <name>
            <surname>Rocke</surname>
            <given-names>DM</given-names>
          </name>
        </person-group>
        <article-title>
          <bold>A variance-stabilizing transformation for gene-expression microarray data</bold>
        </article-title>
        <source>Bioinformatics</source>
        <year>2002</year>
        <volume>18</volume>
        <fpage>105</fpage>
        <lpage>110</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/18.suppl_1.S105</pub-id>
      </element-citation>
    </ref>
    <ref id="CR56">
      <label>56</label>
      <mixed-citation publication-type="other">Park MY: <bold>Generalized linear models with regularization</bold>. <italic>PhD thesis.</italic>Stanford University, Department of Statistics; 2006.</mixed-citation>
    </ref>
    <ref id="CR57">
      <label>57</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Friedman</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Hastie</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Tibshirani</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>
          <bold>Regularization paths for generalized linear models via coordinate descent</bold>
        </article-title>
        <source>J Stat Softw</source>
        <year>2010</year>
        <volume>33</volume>
        <fpage>1</fpage>
        <lpage>22</lpage>
        <?supplied-pmid 20808728?>
        <pub-id pub-id-type="pmid">20808728</pub-id>
      </element-citation>
    </ref>
    <ref id="CR58">
      <label>58</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Cule</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Vineis</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>De Iorio</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>
          <bold>Significance testing in ridge regression for genetic data</bold>
        </article-title>
        <source>BMC Bioinformatics</source>
        <year>2011</year>
        <volume>12</volume>
        <fpage>372</fpage>
        <pub-id pub-id-type="doi">10.1186/1471-2105-12-372</pub-id>
        <?supplied-pmid 21929786?>
        <pub-id pub-id-type="pmid">21929786</pub-id>
      </element-citation>
    </ref>
    <ref id="CR59">
      <label>59</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Cook</surname>
            <given-names>RD</given-names>
          </name>
          <name>
            <surname>Weisberg</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <source>
          <italic>Residuals and Influence in Regression</italic>
        </source>
        <year>1982</year>
        <publisher-loc>New York, USA</publisher-loc>
        <publisher-name>Chapman and Hall/CRC</publisher-name>
      </element-citation>
    </ref>
    <ref id="CR60">
      <label>60</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lawrence</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Huber</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Pagès</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Aboyoun</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Carlson</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Gentleman</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Morgan</surname>
            <given-names>MT</given-names>
          </name>
          <name>
            <surname>Carey</surname>
            <given-names>VJ</given-names>
          </name>
        </person-group>
        <article-title>
          <bold>Software for computing and annotating genomic ranges</bold>
        </article-title>
        <source>PLoS Comput Biol</source>
        <year>2013</year>
        <volume>9</volume>
        <fpage>1003118</fpage>
        <pub-id pub-id-type="doi">10.1371/journal.pcbi.1003118</pub-id>
      </element-citation>
    </ref>
    <ref id="CR61">
      <label>61</label>
      <mixed-citation publication-type="other">Pagès H, Obenchain V, Morgan M: <bold>GenomicAlignments: Representation and manipulation of short genomic alignments</bold>2013. Bioconductor package [http://www.bioconductor.org]</mixed-citation>
    </ref>
    <ref id="CR62">
      <label>62</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Anders</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Pyl</surname>
            <given-names>PT</given-names>
          </name>
          <name>
            <surname>Huber</surname>
            <given-names>W</given-names>
          </name>
        </person-group>
        <article-title>
          <bold>HTSeq - A Python framework to work with high-throughput sequencing data</bold>
        </article-title>
        <source>Bioinformatics</source>
        <year>2015</year>
        <volume>31</volume>
        <fpage>166</fpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btu638</pub-id>
        <?supplied-pmid 25260700?>
        <pub-id pub-id-type="pmid">25260700</pub-id>
      </element-citation>
    </ref>
    <ref id="CR63">
      <label>63</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Delhomme</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Padioleau</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Furlong</surname>
            <given-names>EE</given-names>
          </name>
          <name>
            <surname>Steinmetz</surname>
            <given-names>LM</given-names>
          </name>
        </person-group>
        <article-title>
          <bold>easyRNASeq: a Bioconductor package for processing RNA-seq data</bold>
        </article-title>
        <source>Bioinformatics</source>
        <year>2012</year>
        <volume>28</volume>
        <fpage>2532</fpage>
        <lpage>2533</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/bts477</pub-id>
        <?supplied-pmid 22847932?>
        <pub-id pub-id-type="pmid">22847932</pub-id>
      </element-citation>
    </ref>
    <ref id="CR64">
      <label>64</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Liao</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Smyth</surname>
            <given-names>GK</given-names>
          </name>
          <name>
            <surname>Shi</surname>
            <given-names>W</given-names>
          </name>
        </person-group>
        <article-title>
          <bold>featureCounts: an efficient general purpose program for assigning sequence reads to genomic features</bold>
        </article-title>
        <source>Bioinformatics</source>
        <year>2014</year>
        <volume>30</volume>
        <fpage>923</fpage>
        <lpage>930</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btt656</pub-id>
        <?supplied-pmid 24227677?>
        <pub-id pub-id-type="pmid">24227677</pub-id>
      </element-citation>
    </ref>
    <ref id="CR65">
      <label>65</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kim</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Pertea</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Trapnell</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Pimentel</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Kelley</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Salzberg</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>
          <bold>TopHat2: accurate alignment of transcriptomes in the presence of insertions, deletions and gene fusions</bold>
        </article-title>
        <source>Genome Biol</source>
        <year>2013</year>
        <volume>14</volume>
        <fpage>36</fpage>
        <pub-id pub-id-type="doi">10.1186/gb-2013-14-4-r36</pub-id>
      </element-citation>
    </ref>
    <ref id="CR66">
      <label>66</label>
      <mixed-citation publication-type="other"><bold>DESeq2paper</bold>. [http://www-huber.embl.de/DESeq2paper]</mixed-citation>
    </ref>
  </ref-list>
</back>
<?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName A++V2.4.dtd?>
<?SourceDTD.Version 2.4?>
<?ConverterInfo.XSLTName springer2nlmx2.xsl?>
<?ConverterInfo.Version 2?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Genome Biol</journal-id>
    <journal-title-group>
      <journal-title>Genome Biology</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1465-6906</issn>
    <issn pub-type="epub">1465-6914</issn>
    <publisher>
      <publisher-name>BioMed Central</publisher-name>
      <publisher-loc>London</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">4302049</article-id>
    <article-id pub-id-type="pmid">25516281</article-id>
    <article-id pub-id-type="publisher-id">550</article-id>
    <article-id pub-id-type="doi">10.1186/s13059-014-0550-8</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Method</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Moderated estimation of fold change and dispersion for RNA-seq data with DESeq2</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Love</surname>
          <given-names>Michael I</given-names>
        </name>
        <address>
          <email>mlove@jimmy.harvard.edu</email>
        </address>
        <xref ref-type="aff" rid="Aff1"/>
        <xref ref-type="aff" rid="Aff2"/>
        <xref ref-type="aff" rid="Aff3"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Huber</surname>
          <given-names>Wolfgang</given-names>
        </name>
        <address>
          <email>whuber@embl.de</email>
        </address>
        <xref ref-type="aff" rid="Aff2"/>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <name>
          <surname>Anders</surname>
          <given-names>Simon</given-names>
        </name>
        <address>
          <email>sanders@fs.tum.de</email>
        </address>
        <xref ref-type="aff" rid="Aff2"/>
      </contrib>
      <aff id="Aff1"><label/>Department of Biostatistics and Computational Biology, Dana Farber Cancer Institute and Department of Biostatistics, Harvard School of Public Health, 450 Brookline Avenue, Boston, 02215 MA USA </aff>
      <aff id="Aff2"><label/>Genome Biology Unit, European Molecular Biology Laboratory, Meyerhofstrasse 1, Heidelberg, 69117 Germany </aff>
      <aff id="Aff3"><label/>Department of Computational Molecular Biology, Max Planck Institute for Molecular Genetics, Ihnestrasse 63-7314195, Berlin, Germany </aff>
    </contrib-group>
    <pub-date pub-type="epub">
      <day>5</day>
      <month>12</month>
      <year>2014</year>
    </pub-date>
    <pub-date pub-type="ppub">
      <year>2014</year>
    </pub-date>
    <volume>15</volume>
    <issue>12</issue>
    <elocation-id>550</elocation-id>
    <history>
      <date date-type="received">
        <day>27</day>
        <month>5</month>
        <year>2014</year>
      </date>
      <date date-type="accepted">
        <day>19</day>
        <month>11</month>
        <year>2014</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© Love et al.; licensee BioMed Central. 2014</copyright-statement>
      <license license-type="open-access">
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0">http://creativecommons.org/licenses/by/4.0</ext-link>), which permits unrestricted use, distribution, and reproduction in any medium, provided the original work is properly credited. The Creative Commons Public Domain Dedication waiver (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/publicdomain/zero/1.0/">http://creativecommons.org/publicdomain/zero/1.0/</ext-link>) applies to the data made available in this article, unless otherwise stated.</license-p>
      </license>
    </permissions>
    <abstract id="Abs1">
      <p>In comparative high-throughput sequencing assays, a fundamental task is the analysis of count data, such as read counts per gene in RNA-seq, for evidence of systematic changes across experimental conditions. Small replicate numbers, discreteness, large dynamic range and the presence of outliers require a suitable statistical approach. We present <italic>DESeq2</italic>, a method for differential analysis of count data, using shrinkage estimation for dispersions and fold changes to improve stability and interpretability of estimates. This enables a more quantitative analysis focused on the strength rather than the mere presence of differential expression. The <italic>DESeq2</italic> package is available at http://www.bioconductor.org/packages/release/bioc/html/DESeq2.html.</p>
      <sec>
        <title>Electronic supplementary material</title>
        <p>The online version of this article (doi:10.1186/s13059-014-0550-8) contains supplementary material, which is available to authorized users.</p>
      </sec>
    </abstract>
    <custom-meta-group>
      <custom-meta>
        <meta-name>issue-copyright-statement</meta-name>
        <meta-value>© The Author(s) 2014</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec id="Sec1">
    <title>Background</title>
    <p>The rapid adoption of high-throughput sequencing (HTS) technologies for genomic studies has resulted in a need for statistical methods to assess quantitative differences between experiments. An important task here is the analysis of RNA sequencing (RNA-seq) data with the aim of finding genes that are differentially expressed across groups of samples. This task is general: methods for it are typically also applicable for other comparative HTS assays, including chromatin immunoprecipitation sequencing, chromosome conformation capture, or counting observed taxa in metagenomic studies.</p>
    <p>Besides the need to account for the specifics of count data, such as non-normality and a dependence of the variance on the mean, a core challenge is the small number of samples in typical HTS experiments – often as few as two or three replicates per condition. Inferential methods that treat each gene separately suffer here from lack of power, due to the high uncertainty of within-group variance estimates. In high-throughput assays, this limitation can be overcome by pooling information across genes, specifically, by exploiting assumptions about the similarity of the variances of different genes measured in the same experiment [<xref ref-type="bibr" rid="CR1">1</xref>].</p>
    <p>Many methods for differential expression analysis of RNA-seq data perform such information sharing across genes for variance (or, equivalently, dispersion) estimation. <italic>edgeR</italic> [<xref ref-type="bibr" rid="CR2">2</xref>,<xref ref-type="bibr" rid="CR3">3</xref>] moderates the dispersion estimate for each gene toward a common estimate across all genes, or toward a local estimate from genes with similar expression strength, using a weighted conditional likelihood. Our <italic>DESeq</italic> method [<xref ref-type="bibr" rid="CR4">4</xref>] detects and corrects dispersion estimates that are too low through modeling of the dependence of the dispersion on the average expression strength over all samples. <italic>BBSeq</italic> [<xref ref-type="bibr" rid="CR5">5</xref>] models the dispersion on the mean, with the mean absolute deviation of dispersion estimates used to reduce the influence of outliers. <italic>DSS</italic> [<xref ref-type="bibr" rid="CR6">6</xref>] uses a Bayesian approach to provide an estimate for the dispersion for individual genes that accounts for the heterogeneity of dispersion values for different genes. <italic>baySeq</italic> [<xref ref-type="bibr" rid="CR7">7</xref>] and <italic>ShrinkBayes</italic> [<xref ref-type="bibr" rid="CR8">8</xref>] estimate priors for a Bayesian model over all genes, and then provide posterior probabilities or false discovery rates (FDRs) for differential expression.</p>
    <p>The most common approach in the comparative analysis of transcriptomics data is to test the null hypothesis that the logarithmic fold change (LFC) between treatment and control for a gene’s expression is exactly zero, i.e., that the gene is not at all affected by the treatment. Often the goal of differential analysis is to produce a list of genes passing multiple-test adjustment, ranked by <italic>P</italic> value. However, small changes, even if statistically highly significant, might not be the most interesting candidates for further investigation. Ranking by fold change, on the other hand, is complicated by the noisiness of LFC estimates for genes with low counts. Furthermore, the number of genes called significantly differentially expressed depends as much on the sample size and other aspects of experimental design as it does on the biology of the experiment – and well-powered experiments often generate an overwhelmingly long list of hits [<xref ref-type="bibr" rid="CR9">9</xref>]. We, therefore, developed a statistical framework to facilitate gene ranking and visualization based on stable estimation of effect sizes (LFCs), as well as testing of differential expression with respect to user-defined thresholds of biological significance.</p>
    <p>Here we present <italic>DESeq2</italic>, a successor to our <italic>DESeq</italic> method [<xref ref-type="bibr" rid="CR4">4</xref>]. <italic>DESeq2</italic> integrates methodological advances with several novel features to facilitate a more quantitative analysis of comparative RNA-seq data using shrinkage estimators for dispersion and fold change. We demonstrate the advantages of <italic>DESeq2</italic>’s new features by describing a number of applications possible with shrunken fold changes and their estimates of standard error, including improved gene ranking and visualization, hypothesis tests above and below a threshold, and the regularized logarithm transformation for quality assessment and clustering of overdispersed count data. We furthermore compare <italic>DESeq2</italic>’s statistical power with existing tools, revealing that our methodology has high sensitivity and precision, while controlling the false positive rate. <italic>DESeq2</italic> is available [<xref ref-type="bibr" rid="CR10">10</xref>] as an R/Bioconductor package [<xref ref-type="bibr" rid="CR11">11</xref>].</p>
  </sec>
  <sec id="Sec2">
    <title>Results and discussion</title>
    <sec id="Sec3">
      <title>Model and normalization</title>
      <p>The starting point of a <italic>DESeq2</italic> analysis is a count matrix <italic>K</italic> with one row for each gene <italic>i</italic> and one column for each sample <italic>j</italic>. The matrix entries <italic>K</italic><sub><italic>ij</italic></sub> indicate the number of sequencing reads that have been unambiguously mapped to a gene in a sample. Note that although we refer in this paper to counts of reads in genes, the methods presented here can be applied as well to other kinds of HTS count data. For each gene, we fit a generalized linear model (GLM) [<xref ref-type="bibr" rid="CR12">12</xref>] as follows.</p>
      <p>We model read counts <italic>K</italic><sub><italic>ij</italic></sub> as following a negative binomial distribution (sometimes also called a gamma-Poisson distribution) with mean <italic>μ</italic><sub><italic>ij</italic></sub> and dispersion <italic>α</italic><sub><italic>i</italic></sub>. The mean is taken as a quantity <italic>q</italic><sub><italic>ij</italic></sub>, proportional to the concentration of cDNA fragments from the gene in the sample, scaled by a normalization factor <italic>s</italic><sub><italic>ij</italic></sub>, i.e., <italic>μ</italic><sub><italic>ij</italic></sub>=<italic>s</italic><sub><italic>ij</italic></sub><italic>q</italic><sub><italic>ij</italic></sub>. For many applications, the same constant <italic>s</italic><sub><italic>j</italic></sub> can be used for all genes in a sample, which then accounts for differences in sequencing depth between samples. To estimate these <italic>size factors</italic>, the <italic>DESeq2</italic> package offers the median-of-ratios method already used in <italic>DESeq</italic> [<xref ref-type="bibr" rid="CR4">4</xref>]. However, it can be advantageous to calculate gene-specific normalization factors <italic>s</italic><sub><italic>ij</italic></sub> to account for further sources of technical biases such as differing dependence on GC content, gene length or the like, using published methods [<xref ref-type="bibr" rid="CR13">13</xref>,<xref ref-type="bibr" rid="CR14">14</xref>], and these can be supplied instead.</p>
      <p>We use GLMs with a logarithmic link, <inline-formula id="IEq1"><alternatives><tex-math id="M1">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
							$\log _{2} q_{\textit {ij}}=\sum _{r} x_{\textit {jr}} \beta _{\textit {ir}}$
						\end{document}</tex-math><mml:math id="M2"><mml:munder><mml:mrow><mml:mo>log</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:munder><mml:msub><mml:mrow><mml:mi>q</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ij</mml:mtext></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:munder><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:munder><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">jr</mml:mtext></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ir</mml:mtext></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13059_2014_550_Article_IEq1.gif"/></alternatives></inline-formula>, with design matrix elements <italic>x</italic><sub><italic>jr</italic></sub> and coefficients <italic>β</italic><sub><italic>ir</italic></sub>. In the simplest case of a comparison between two groups, such as treated and control samples, the design matrix elements indicate whether a sample <italic>j</italic> is treated or not, and the GLM fit returns coefficients indicating the overall expression strength of the gene and the log <sub>2</sub> fold change between treatment and control. The use of linear models, however, provides the flexibility to also analyze more complex designs, as is often useful in genomic studies [<xref ref-type="bibr" rid="CR15">15</xref>].</p>
    </sec>
    <sec id="Sec4">
      <title>Empirical Bayes shrinkage for dispersion estimation</title>
      <p>Within-group variability, i.e., the variability between replicates, is modeled by the dispersion parameter <italic>α</italic><sub><italic>i</italic></sub>, which describes the variance of counts via <inline-formula id="IEq2"><alternatives><tex-math id="M3">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
							$\operatorname {Var} K_{\textit {ij}} = \mu _{\textit {ij}} + \alpha _{i} \mu _{\textit {ij}}^{2}$
						\end{document}</tex-math><mml:math id="M4"><mml:mo>Var</mml:mo><mml:msub><mml:mrow><mml:mi>K</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ij</mml:mtext></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ij</mml:mtext></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:msubsup><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ij</mml:mtext></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2014_550_Article_IEq2.gif"/></alternatives></inline-formula>. Accurate estimation of the dispersion parameter <italic>α</italic><sub><italic>i</italic></sub> is critical for the statistical inference of differential expression. For studies with large sample sizes this is usually not a problem. For controlled experiments, however, sample sizes tend to be smaller (experimental designs with as little as two or three replicates are common and reasonable), resulting in highly variable dispersion estimates for each gene. If used directly, these noisy estimates would compromise the accuracy of differential expression testing.</p>
      <p>One sensible solution is to share information across genes. In <italic>DESeq2</italic>, we assume that genes of similar average expression strength have similar dispersion. We here explain the concepts of our approach using as examples a dataset by Bottomly <italic>et al.</italic> [<xref ref-type="bibr" rid="CR16">16</xref>] with RNA-seq data for mice of two different strains and a dataset by Pickrell <italic>et al.</italic> [<xref ref-type="bibr" rid="CR17">17</xref>] with RNA-seq data for human lymphoblastoid cell lines. For the mathematical details, see <xref rid="Sec18" ref-type="sec">Materials and methods</xref>.</p>
      <p>We first treat each gene separately and estimate gene-wise dispersion estimates (using maximum likelihood), which rely only on the data of each individual gene (black dots in Figure <xref rid="Fig1" ref-type="fig">1</xref>). Next, we determine the location parameter of the distribution of these estimates; to allow for dependence on average expression strength, we fit a smooth curve, as shown by the red line in Figure <xref rid="Fig1" ref-type="fig">1</xref>. This provides an accurate estimate for the expected dispersion value for genes of a given expression strength but does not represent deviations of individual genes from this overall trend. We then shrink the gene-wise dispersion estimates toward the values predicted by the curve to obtain final dispersion values (blue arrow heads). We use an empirical Bayes approach (<xref rid="Sec18" ref-type="sec">Materials and methods</xref>), which lets the strength of shrinkage depend (i) on an estimate of how close true dispersion values tend to be to the fit and (ii) on the degrees of freedom: as the sample size increases, the shrinkage decreases in strength, and eventually becomes negligible. Our approach therefore accounts for gene-specific variation to the extent that the data provide this information, while the fitted curve aids estimation and testing in less information-rich settings.
<fig id="Fig1"><label>Figure 1</label><caption><p><bold>Shrinkage estimation of dispersion.</bold> Plot of dispersion estimates over the average expression strength <bold>(A)</bold> for the Bottomly <italic>et al.</italic> [<xref ref-type="bibr" rid="CR16">16</xref>] dataset with six samples across two groups and <bold>(B)</bold> for five samples from the Pickrell <italic>et al.</italic> [<xref ref-type="bibr" rid="CR17">17</xref>] dataset, fitting only an intercept term. First, gene-wise MLEs are obtained using only the respective gene’s data (black dots). Then, a curve (red) is fit to the MLEs to capture the overall trend of dispersion-mean dependence. This fit is used as a prior mean for a second estimation round, which results in the final MAP estimates of dispersion (arrow heads). This can be understood as a shrinkage (along the blue arrows) of the noisy gene-wise estimates toward the consensus represented by the red line. The black points circled in blue are detected as dispersion outliers and not shrunk toward the prior (shrinkage would follow the dotted line). For clarity, only a subset of genes is shown, which is enriched for dispersion outliers. Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S1 displays the same data but with dispersions of all genes shown. MAP, maximum <italic>a posteriori</italic>; MLE, maximum-likelihood estimate.</p></caption><graphic xlink:href="13059_2014_550_Fig1_HTML" id="MO1"/></fig></p>
      <p>Our approach is similar to the one used by <italic>DSS</italic> [<xref ref-type="bibr" rid="CR6">6</xref>], in that both methods sequentially estimate a prior distribution for the true dispersion values around the fit, and then provide the maximum <italic>a posteriori</italic> (MAP) as the final estimate. It differs from the previous implementation of <italic>DESeq</italic>, which used the maximum of the fitted curve and the gene-wise dispersion estimate as the final estimate and tended to overestimate the dispersions (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S2). The approach of <italic>DESeq2</italic> differs from that of <italic>edgeR</italic> [<xref ref-type="bibr" rid="CR3">3</xref>], as <italic>DESeq2</italic> estimates the width of the prior distribution from the data and therefore automatically controls the amount of shrinkage based on the observed properties of the data. In contrast, the default steps in <italic>edgeR</italic> require a user-adjustable parameter, the <italic>prior degrees of freedom</italic>, which weighs the contribution of the individual gene estimate and <italic>edgeR</italic>’s dispersion fit.</p>
      <p>Note that in Figure <xref rid="Fig1" ref-type="fig">1</xref> a number of genes with gene-wise dispersion estimates below the curve have their final estimates raised substantially. The shrinkage procedure thereby helps avoid potential false positives, which can result from underestimates of dispersion. If, on the other hand, an individual gene’s dispersion is far above the distribution of the gene-wise dispersion estimates of other genes, then the shrinkage would lead to a greatly reduced final estimate of dispersion. We reasoned that in many cases, the reason for extraordinarily high dispersion of a gene is that it does not obey our modeling assumptions; some genes may show much higher variability than others for biological or technical reasons, even though they have the same average expression levels. In these cases, inference based on the shrunken dispersion estimates could lead to undesirable false positive calls. <italic>DESeq2</italic> handles these cases by using the gene-wise estimate instead of the shrunken estimate when the former is more than 2 residual standard deviations above the curve.</p>
    </sec>
    <sec id="Sec5">
      <title>Empirical Bayes shrinkage for fold-change estimation</title>
      <p>A common difficulty in the analysis of HTS data is the strong variance of LFC estimates for genes with low read count. We demonstrate this issue using the dataset by Bottomly <italic>et al.</italic> [<xref ref-type="bibr" rid="CR16">16</xref>]. As visualized in Figure <xref rid="Fig2" ref-type="fig">2</xref>A, weakly expressed genes seem to show much stronger differences between the compared mouse strains than strongly expressed genes. This phenomenon, seen in most HTS datasets, is a direct consequence of dealing with <italic>count</italic> data, in which ratios are inherently noisier when counts are low. This heteroskedasticity (variance of LFCs depending on mean count) complicates downstream analysis and data interpretation, as it makes effect sizes difficult to compare across the dynamic range of the data.
<fig id="Fig2"><label>Figure 2</label><caption><p><bold>Effect of shrinkage on logarithmic fold change estimates.</bold> Plots of the <bold>(A)</bold> MLE (i.e., no shrinkage) and <bold>(B)</bold> MAP estimate (i.e., with shrinkage) for the LFCs attributable to mouse strain, over the average expression strength for a ten vs eleven sample comparison of the Bottomly <italic>et al.</italic> [<xref ref-type="bibr" rid="CR16">16</xref>] dataset. Small triangles at the top and bottom of the plots indicate points that would fall outside of the plotting window. Two genes with similar mean count and MLE logarithmic fold change are highlighted with green and purple circles. <bold>(C)</bold> The counts (normalized by size factors <italic>s</italic>
<sub><italic>j</italic></sub>) for these genes reveal low dispersion for the gene in green and high dispersion for the gene in purple. <bold>(D)</bold> Density plots of the likelihoods (solid lines, scaled to integrate to 1) and the posteriors (dashed lines) for the green and purple genes and of the prior (solid black line): due to the higher dispersion of the purple gene, its likelihood is wider and less peaked (indicating less information), and the prior has more influence on its posterior than for the green gene. The stronger curvature of the green posterior at its maximum translates to a smaller reported standard error for the MAP LFC estimate (horizontal error bar). adj., adjusted; LFC, logarithmic fold change; MAP, maximum <italic>a posteriori</italic>; MLE, maximum-likelihood estimate.</p></caption><graphic xlink:href="13059_2014_550_Fig2_HTML" id="MO2"/></fig></p>
      <p><italic>DESeq2</italic> overcomes this issue by shrinking LFC estimates toward zero in a manner such that shrinkage is stronger when the available information for a gene is low, which may be because counts are low, dispersion is high or there are few degrees of freedom. We again employ an empirical Bayes procedure: we first perform ordinary GLM fits to obtain maximum-likelihood estimates (MLEs) for the LFCs and then fit a zero-centered normal distribution to the observed distribution of MLEs over all genes. This distribution is used as a prior on LFCs in a second round of GLM fits, and the MAP estimates are kept as final estimates of LFC. Furthermore, a standard error for each estimate is reported, which is derived from the posterior’s curvature at its maximum (see <xref rid="Sec18" ref-type="sec">Materials and methods</xref> for details). These shrunken LFCs and their standard errors are used in the Wald tests for differential expression described in the next section.</p>
      <p>The resulting MAP LFCs are biased toward zero in a manner that removes the problem of exaggerated LFCs for low counts. As Figure <xref rid="Fig2" ref-type="fig">2</xref>B shows, the strongest LFCs are no longer exhibited by genes with weakest expression. Rather, the estimates are more evenly spread around zero, and for very weakly expressed genes (with less than one read per sample on average), LFCs hardly deviate from zero, reflecting that accurate LFC estimates are not possible here.</p>
      <p>The strength of shrinkage does not depend simply on the mean count, but rather on the amount of information available for the fold change estimation (as indicated by the observed Fisher information; see <xref rid="Sec18" ref-type="sec">Materials and methods</xref>). Two genes with equal expression strength but different dispersions will experience a different amount of shrinkage (Figure <xref rid="Fig2" ref-type="fig">2</xref>C,D). The shrinkage of LFC estimates can be described as a bias-variance trade-off [<xref ref-type="bibr" rid="CR18">18</xref>]: for genes with little information for LFC estimation, a reduction of the strong variance is bought at the cost of accepting a bias toward zero, and this can result in an overall reduction in mean squared error, e.g., when comparing to LFC estimates from a new dataset. Genes with high information for LFC estimation will have, in our approach, LFCs with both low bias and low variance. Furthermore, as the degrees of freedom increase, and the experiment provides more information for LFC estimation, the shrunken estimates will converge to the unshrunken estimates. We note that other Bayesian efforts toward moderating fold changes for RNA-seq include hierarchical models [<xref ref-type="bibr" rid="CR8">8</xref>,<xref ref-type="bibr" rid="CR19">19</xref>] and the <italic>GFOLD</italic> (or generalized fold change) tool [<xref ref-type="bibr" rid="CR20">20</xref>], which uses a posterior distribution of LFCs.</p>
      <p>The shrunken MAP LFCs offer a more reproducible quantification of transcriptional differences than standard MLE LFCs. To demonstrate this, we split the Bottomly <italic>et al.</italic> samples equally into two groups, I and II, such that each group contained a balanced split of the strains, simulating a scenario where an experiment (samples in group I) is performed, analyzed and reported, and then independently replicated (samples in group II). Within each group, we estimated LFCs between the strains and compared between groups I and II, using the MLE LFCs (Figure <xref rid="Fig3" ref-type="fig">3</xref>A) and using the MAP LFCs (Figure <xref rid="Fig3" ref-type="fig">3</xref>B). Because the shrinkage moves large LFCs that are not well supported by the data toward zero, the agreement between the two independent sample groups increases considerably. Therefore, shrunken fold-change estimates offer a more reliable basis for quantitative conclusions than normal MLEs.
<fig id="Fig3"><label>Figure 3</label><caption><p><bold>Stability of logarithmic fold changes.</bold><italic>DESeq2</italic> is run on equally split halves of the data of Bottomly <italic>et al.</italic> [<xref ref-type="bibr" rid="CR16">16</xref>], and the LFCs from the halves are plotted against each other. <bold>(A)</bold> MLEs, i.e., without LFC shrinkage. <bold>(B)</bold> MAP estimates, i.e., with shrinkage. Points in the top left and bottom right quadrants indicate genes with a change of sign of LFC. Red points indicate genes with adjusted <italic>P</italic> value &lt;0.1. The legend displays the root-mean-square error of the estimates in group I compared to those in group II. LFC, logarithmic fold change; MAP, maximum <italic>a posteriori</italic>; MLE, maximum-likelihood estimate; RMSE, root-mean-square error.</p></caption><graphic xlink:href="13059_2014_550_Fig3_HTML" id="MO3"/></fig></p>
      <p>This makes shrunken LFCs also suitable for ranking genes, e.g., to prioritize them for follow-up experiments. For example, if we sort the genes in the two sample groups of Figure <xref rid="Fig3" ref-type="fig">3</xref> by unshrunken LFC estimates, and consider the 100 genes with the strongest up- or down-regulation in group I, we find only 21 of these again among the top 100 up- or down-regulated genes in group II. However, if we rank the genes by shrunken LFC estimates, the overlap improves to 81 of 100 genes (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S3).</p>
      <p>A simpler often used method is to add a fixed number (pseudocount) to all counts before forming ratios. However, this requires the choice of a tuning parameter and only reacts to one of the sources of uncertainty, low counts, but not to gene-specific dispersion differences or sample size. We demonstrate this in the <italic>Benchmarks</italic> section below.</p>
    </sec>
    <sec id="Sec6">
      <title>Hypothesis tests for differential expression</title>
      <p>After GLMs are fit for each gene, one may test whether each model coefficient differs significantly from zero. <italic>DESeq2</italic> reports the standard error for each shrunken LFC estimate, obtained from the curvature of the coefficient’s posterior (dashed lines in Figure <xref rid="Fig2" ref-type="fig">2</xref>D) at its maximum. For significance testing, <italic>DESeq2</italic> uses a Wald test: the shrunken estimate of LFC is divided by its standard error, resulting in a <italic>z</italic>-statistic, which is compared to a standard normal distribution. (See <xref rid="Sec18" ref-type="sec">Materials and methods</xref> for details.) The Wald test allows testing of individual coefficients, or contrasts of coefficients, without the need to fit a reduced model as with the likelihood ratio test, though the likelihood ratio test is also available as an option in <italic>DESeq2</italic>. The Wald test <italic>P</italic> values from the subset of genes that pass an independent filtering step, described in the next section, are adjusted for multiple testing using the procedure of Benjamini and Hochberg [<xref ref-type="bibr" rid="CR21">21</xref>].</p>
    </sec>
    <sec id="Sec7">
      <title>Automatic independent filtering</title>
      <p>Due to the large number of tests performed in the analysis of RNA-seq and other genome-wide experiments, the multiple testing problem needs to be addressed. A popular objective is control or estimation of the FDR. Multiple testing adjustment tends to be associated with a loss of power, in the sense that the FDR for a set of genes is often higher than the individual <italic>P</italic> values of these genes. However, the loss can be reduced if genes that have little or no chance of being detected as differentially expressed are omitted from the testing, provided that the criterion for omission is independent of the test statistic under the null hypothesis [<xref ref-type="bibr" rid="CR22">22</xref>] (see <xref rid="Sec18" ref-type="sec">Materials and methods</xref>). <italic>DESeq2</italic> uses the average expression strength of each gene, across all samples, as its filter criterion, and it omits all genes with mean normalized counts below a filtering threshold from multiple testing adjustment. <italic>DESeq2</italic> by default will choose a threshold that maximizes the number of genes found at a user-specified target FDR. In Figures <xref rid="Fig2" ref-type="fig">2</xref>A,B and <xref rid="Fig3" ref-type="fig">3</xref>, genes found in this way to be significant at an estimated FDR of 10% are depicted in red. Depending on the distribution of the mean normalized counts, the resulting increase in power can be substantial, sometimes making the difference in whether or not any differentially expressed genes are detected.</p>
    </sec>
    <sec id="Sec8">
      <title>Hypothesis tests with thresholds on effect size</title>
      <sec id="Sec9">
        <title>Specifying minimum effect size</title>
        <p>Most approaches to testing for differential expression, including the default approach of <italic>DESeq2</italic>, test against the null hypothesis of <italic>zero</italic> LFC. However, if any biological processes are genuinely affected by the difference in experimental treatment, this null hypothesis implies that the gene under consideration is <italic>perfectly</italic> decoupled from these processes. Due to the high interconnectedness of cells’ regulatory networks, this hypothesis is, in fact, implausible, and arguably wrong for many if not most genes. Consequently, with sufficient sample size, even genes with a very small but non-zero LFC will eventually be detected as differentially expressed. A change should therefore be of sufficient magnitude to be considered <italic>biologically significant</italic>. For small-scale experiments, statistical significance is often a much stricter requirement than biological significance, thereby relieving the researcher from the need to decide on a threshold for biological significance.</p>
        <p>For well-powered experiments, however, a statistical test against the conventional null hypothesis of zero LFC may report genes with statistically significant changes that are so weak in effect strength that they could be considered irrelevant or distracting. A common procedure is to disregard genes whose estimated LFC <italic>β</italic><sub><italic>ir</italic></sub> is below some threshold, |<italic>β</italic><sub><italic>ir</italic></sub>|≤<italic>θ</italic>. However, this approach loses the benefit of an easily interpretable FDR, as the reported <italic>P</italic> value and adjusted <italic>P</italic> value still correspond to the test of <italic>zero</italic> LFC. It is therefore desirable to include the threshold in the statistical testing procedure directly, i.e., not to filter post hoc on a reported fold-change <italic>estimate</italic>, but rather to evaluate statistically directly whether there is sufficient evidence that the LFC is above the chosen threshold.</p>
        <p><italic>DESeq2</italic> offers tests for composite null hypotheses of the form |<italic>β</italic><sub><italic>ir</italic></sub>|≤<italic>θ</italic>, where <italic>β</italic><sub><italic>ir</italic></sub> is the shrunken LFC from the estimation procedure described above. (See <xref rid="Sec18" ref-type="sec">Materials and methods</xref> for details.) Figure <xref rid="Fig4" ref-type="fig">4</xref>A demonstrates how such a thresholded test gives rise to a curved decision boundary: to reach significance, the estimated LFC has to exceed the specified threshold by an amount that depends on the available information. We note that related approaches to generate gene lists that satisfy both statistical and biological significance criteria have been previously discussed for microarray data [<xref ref-type="bibr" rid="CR23">23</xref>] and recently for sequencing data [<xref ref-type="bibr" rid="CR19">19</xref>].
<fig id="Fig4"><label>Figure 4</label><caption><p><bold>Hypothesis testing involving non-zero thresholds.</bold> Shown are plots of the estimated fold change over average expression strength (“minus over average”, or MA-plots) for a ten vs eleven comparison using the Bottomly <italic>et al.</italic> [<xref ref-type="bibr" rid="CR16">16</xref>] dataset, with highlighted points indicating low adjusted <italic>P</italic> values. The alternate hypotheses are that logarithmic (base 2) fold changes are <bold>(A)</bold> greater than 1 in absolute value or <bold>(B)</bold> less than 1 in absolute value. adj., adjusted.</p></caption><graphic xlink:href="13059_2014_550_Fig4_HTML" id="MO4"/></fig></p>
      </sec>
      <sec id="Sec10">
        <title>Specifying maximum effect size</title>
        <p>Sometimes, a researcher is interested in finding genes that are not, or only very weakly, affected by the treatment or experimental condition. This amounts to a setting similar to the one just discussed, but the roles of the null and alternative hypotheses are swapped. We are here asking for evidence of the effect being weak, not for evidence of the effect being zero, because the latter question is rarely tractable. The meaning of <italic>weak</italic> needs to be quantified for the biological question at hand by choosing a suitable threshold <italic>θ</italic> for the LFC. For such analyses, <italic>DESeq2</italic> offers a test of the composite null hypothesis |<italic>β</italic><sub><italic>ir</italic></sub>|≥<italic>θ</italic>, which will report genes as significant for which there is evidence that their LFC is weaker than <italic>θ</italic>. Figure <xref rid="Fig4" ref-type="fig">4</xref>B shows the outcome of such a test. For genes with very low read count, even an estimate of zero LFC is not significant, as the large uncertainty of the estimate does not allow us to exclude that the gene may in truth be more than weakly affected by the experimental condition. Note the lack of LFC shrinkage: to find genes with weak differential expression, <italic>DESeq2</italic> requires that the LFC shrinkage has been disabled. This is because the zero-centered prior used for LFC shrinkage embodies a <italic>prior</italic> belief that LFCs tend to be small, and hence is inappropriate here.</p>
      </sec>
    </sec>
    <sec id="Sec11">
      <title>Detection of count outliers</title>
      <p>Parametric methods for detecting differential expression can have gene-wise estimates of LFC overly influenced by individual outliers that do not fit the distributional assumptions of the model [<xref ref-type="bibr" rid="CR24">24</xref>]. An example of such an outlier would be a gene with single-digit counts for all samples, except one sample with a count in the thousands. As the aim of differential expression analysis is typically to find <italic>consistently</italic> up- or down-regulated genes, it is useful to consider diagnostics for detecting individual observations that overly influence the LFC estimate and <italic>P</italic> value for a gene. A standard outlier diagnostic is Cook’s distance [<xref ref-type="bibr" rid="CR25">25</xref>], which is defined within each gene for each sample as the scaled distance that the coefficient vector, <inline-formula id="IEq3"><alternatives><tex-math id="M5">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
							$\vec {\beta }_{i}$
						\end{document}</tex-math><mml:math id="M6"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mo>→</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13059_2014_550_Article_IEq3.gif"/></alternatives></inline-formula>, of a linear model or GLM would move if the sample were removed and the model refit.</p>
      <p><italic>DESeq2</italic> flags, for each gene, those samples that have a Cook’s distance greater than the 0.99 quantile of the <italic>F</italic>(<italic>p</italic>,<italic>m</italic>−<italic>p</italic>) distribution, where <italic>p</italic> is the number of model parameters including the intercept, and <italic>m</italic> is the number of samples. The use of the <italic>F</italic> distribution is motivated by the heuristic reasoning that removing a single sample should not move the vector <inline-formula id="IEq4"><alternatives><tex-math id="M7">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
							$\vec {\beta }_{i}$
						\end{document}</tex-math><mml:math id="M8"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mo>→</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13059_2014_550_Article_IEq4.gif"/></alternatives></inline-formula> outside of a 99% confidence region around <inline-formula id="IEq5"><alternatives><tex-math id="M9">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
							$\vec {\beta }_{i}$
						\end{document}</tex-math><mml:math id="M10"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mo>→</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13059_2014_550_Article_IEq5.gif"/></alternatives></inline-formula> fit using all the samples [<xref ref-type="bibr" rid="CR25">25</xref>]. However, if there are two or fewer replicates for a condition, these samples do not contribute to outlier detection, as there are insufficient replicates to determine outlier status.</p>
      <p>How should one deal with flagged outliers? In an experiment with many replicates, discarding the outlier and proceeding with the remaining data might make best use of the available data. In a small experiment with few samples, however, the presence of an outlier can impair inference regarding the affected gene, and merely ignoring the outlier may even be considered data cherry-picking – and therefore, it is more prudent to exclude the whole gene from downstream analysis.</p>
      <p>Hence, <italic>DESeq2</italic> offers two possible responses to flagged outliers. By default, outliers in conditions with six or fewer replicates cause the whole gene to be flagged and removed from subsequent analysis, including <italic>P</italic> value adjustment for multiple testing. For conditions that contain seven or more replicates, <italic>DESeq2</italic> replaces the outlier counts with an imputed value, namely the trimmed mean over all samples, scaled by the size factor, and then re-estimates the dispersion, LFCs and <italic>P</italic> values for these genes. As the outlier is replaced with the value predicted by the null hypothesis of no differential expression, this is a more conservative choice than simply omitting the outlier. When there are many degrees of freedom, the second approach avoids discarding genes that might contain true differential expression.</p>
      <p>Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S4 displays the outlier replacement procedure for a single gene in a seven by seven comparison of the Bottomly <italic>et al.</italic> [<xref ref-type="bibr" rid="CR16">16</xref>] dataset. While the original fitted means are heavily influenced by a single sample with a large count, the corrected LFCs provide a better fit to the majority of the samples.</p>
    </sec>
    <sec id="Sec12">
      <title>Regularized logarithm transformation</title>
      <p>For certain analyses, it is useful to transform data to render them homoskedastic. As an example, consider the task of assessing sample similarities in an unsupervised manner using a clustering or ordination algorithm. For RNA-seq data, the problem of heteroskedasticity arises: if the data are given to such an algorithm on the original count scale, the result will be dominated by highly expressed, highly variable genes; if logarithm-transformed data are used, undue weight will be given to weakly expressed genes, which show exaggerated LFCs, as discussed above. Therefore, we use the shrinkage approach of <italic>DESeq2</italic> to implement a <italic>regularized logarithm</italic> transformation (rlog), which behaves similarly to a log2 transformation for genes with high counts, while shrinking together the values for different samples for genes with low counts. It therefore avoids a commonly observed property of the standard logarithm transformation, the spreading apart of data for genes with low counts, where random noise is likely to dominate any biologically meaningful signal. When we consider the variance of each gene, computed across samples, these variances are stabilized – i.e., approximately the same, or homoskedastic – after the rlog transformation, while they would otherwise strongly depend on the mean counts. It thus facilitates multivariate visualization and ordinations such as clustering or principal component analysis that tend to work best when the variables have similar dynamic range. Note that while the rlog transformation builds upon on our LFC shrinkage approach, it is distinct from and not part of the statistical inference procedure for differential expression analysis described above, which employs the raw counts, not transformed data.</p>
      <p>The rlog transformation is calculated by fitting for each gene a GLM with a baseline expression (i.e., intercept only) and, computing for each sample, shrunken LFCs with respect to the baseline, using the same empirical Bayes procedure as before (<xref rid="Sec18" ref-type="sec">Materials and methods</xref>). Here, however, the sample covariate information (e.g. treatment or control) is not used, so that all samples are treated equally. The rlog transformation accounts for variation in sequencing depth across samples as it represents the logarithm of <italic>q</italic><sub><italic>ij</italic></sub> after accounting for the size factors <italic>s</italic><sub><italic>ij</italic></sub>. This is in contrast to the variance-stabilizing transformation (VST) for overdispersed counts introduced in <italic>DESeq</italic> [<xref ref-type="bibr" rid="CR4">4</xref>]: while the VST is also effective at stabilizing variance, it does not directly take into account differences in size factors; and in datasets with large variation in sequencing depth (dynamic range of size factors <inline-formula id="IEq6"><alternatives><tex-math id="M11">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
							$\gtrsim $
						\end{document}</tex-math><mml:math id="M12"><mml:mo>≳</mml:mo></mml:math><inline-graphic xlink:href="13059_2014_550_Article_IEq6.gif"/></alternatives></inline-formula>4) we observed undesirable artifacts in the performance of the VST. A disadvantage of the rlog transformation with respect to the VST is, however, that the ordering of genes within a sample will change if neighboring genes undergo shrinkage of different strength. As with the VST, the value of rlog(<italic>K</italic><sub><italic>ij</italic></sub>) for large counts is approximately equal to log2(<italic>K</italic><sub><italic>ij</italic></sub>/<italic>s</italic><sub><italic>j</italic></sub>). Both the rlog transformation and the VST are provided in the <italic>DESeq2</italic> package.</p>
      <p>We demonstrate the use of the rlog transformation on the RNA-seq dataset of Hammer <italic>et al.</italic> [<xref ref-type="bibr" rid="CR26">26</xref>], wherein RNA was sequenced from the dorsal root ganglion of rats that had undergone spinal nerve ligation and controls, at 2 weeks and at 2 months after the ligation. The count matrix for this dataset was downloaded from the ReCount online resource [<xref ref-type="bibr" rid="CR27">27</xref>]. This dataset offers more subtle differences between conditions than the Bottomly <italic>et al.</italic> [<xref ref-type="bibr" rid="CR16">16</xref>] dataset. Figure <xref rid="Fig5" ref-type="fig">5</xref> provides diagnostic plots of the normalized counts under the ordinary logarithm with a pseudocount of 1 and the rlog transformation, showing that the rlog both stabilizes the variance through the range of the mean of counts and helps to find meaningful patterns in the data.
<fig id="Fig5"><label>Figure 5</label><caption><p><bold>Variance stabilization and clustering after rlog transformation.</bold> Two transformations were applied to the counts of the Hammer <italic>et al.</italic> [<xref ref-type="bibr" rid="CR26">26</xref>] dataset: the logarithm of normalized counts plus a pseudocount, i.e. <italic>f</italic>(<italic>K</italic>
<sub><italic>ij</italic></sub>)= log2(<italic>K</italic>
<sub><italic>ij</italic></sub>/<italic>s</italic>
<sub><italic>j</italic></sub>+1), and the rlog. The gene-wise standard deviation of transformed values is variable across the range of the mean of counts using the logarithm <bold>(A)</bold>, while relatively stable using the rlog <bold>(B)</bold>. A hierarchical clustering on Euclidean distances and complete linkage using the rlog <bold>(D)</bold> transformed data clusters the samples into the groups defined by treatment and time, while using the logarithm-transformed counts <bold>(C)</bold> produces a more ambiguous result. sd, standard deviation.</p></caption><graphic xlink:href="13059_2014_550_Fig5_HTML" id="MO5"/></fig></p>
    </sec>
    <sec id="Sec13">
      <title>Gene-level analysis</title>
      <p>We here present <italic>DESeq2</italic> for the analysis of per-gene counts, i.e., the total number of reads that can be uniquely assigned to a gene. In contrast, several algorithms [<xref ref-type="bibr" rid="CR28">28</xref>,<xref ref-type="bibr" rid="CR29">29</xref>] work with probabilistic assignments of reads to transcripts, where multiple, overlapping transcripts can originate from each gene. It has been noted that the total read count approach can result in false detection of differential expression when in fact only transcript isoform lengths change, and even in a wrong sign of LFCs in extreme cases [<xref ref-type="bibr" rid="CR28">28</xref>]. However, in our benchmark, discussed in the following section, we found that LFC sign disagreements between total read count and probabilistic-assignment-based methods were rare for genes that were differentially expressed according to either method (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S5). Furthermore, if estimates for average transcript length are available for the conditions, these can be incorporated into the <italic>DESeq2</italic> framework as gene- and sample-specific normalization factors. In addition, the approach used in <italic>DESeq2</italic> can be extended to isoform-specific analysis, either through generalized linear modeling at the exon level with a gene-specific mean as in the <italic>DEXSeq</italic> package [<xref ref-type="bibr" rid="CR30">30</xref>] or through counting evidence for alternative isoforms in splice graphs [<xref ref-type="bibr" rid="CR31">31</xref>,<xref ref-type="bibr" rid="CR32">32</xref>]. In fact, the latest release version of <italic>DEXSeq</italic> now uses <italic>DESeq2</italic> as its inferential engine and so offers shrinkage estimation of dispersion and effect sizes for an exon-level analysis, too.</p>
    </sec>
    <sec id="Sec14">
      <title>Comparative benchmarks</title>
      <p>To assess how well <italic>DESeq2</italic> performs for standard analyses in comparison to other current methods, we used a combination of simulations and real data. The negative-binomial-based approaches compared were <italic>DESeq (old)</italic> [<xref ref-type="bibr" rid="CR4">4</xref>], <italic>edgeR</italic> [<xref ref-type="bibr" rid="CR33">33</xref>], <italic>edgeR</italic> with the robust option [<xref ref-type="bibr" rid="CR34">34</xref>], <italic>DSS</italic> [<xref ref-type="bibr" rid="CR6">6</xref>] and <italic>EBSeq</italic> [<xref ref-type="bibr" rid="CR35">35</xref>]. Other methods compared were the <italic>voom</italic> normalization method followed by linear modeling using the <italic>limma</italic> package [<xref ref-type="bibr" rid="CR36">36</xref>] and the <italic>SAMseq</italic> permutation method of the <italic>samr</italic> package [<xref ref-type="bibr" rid="CR24">24</xref>]. For the benchmarks using real data, the <italic>Cuffdiff 2</italic> [<xref ref-type="bibr" rid="CR28">28</xref>] method of the Cufflinks suite was included. For version numbers of the software used, see Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S3. For all algorithms returning <italic>P</italic> values, the <italic>P</italic> values from genes with non-zero sum of read counts across samples were adjusted using the Benjamini–Hochberg procedure [<xref ref-type="bibr" rid="CR21">21</xref>].</p>
      <sec id="Sec15">
        <title>Benchmarks through simulation</title>
        <p><bold>Sensitivity and precision</bold> We simulated datasets of 10,000 genes with negative binomial distributed counts. To simulate data with realistic moments, the mean and dispersions were drawn from the joint distribution of means and gene-wise dispersion estimates from the Pickrell <italic>et al.</italic> data, fitting only an intercept term. These datasets were of varying total sample size (<italic>m</italic>∈{6,8,10,20}), and the samples were split into two equal-sized groups; 80% of the simulated genes had no true differential expression, while for 20% of the genes, true fold changes of 2, 3 and 4 were used to generate counts across the two groups, with the direction of fold change chosen randomly. The simulated differentially expressed genes were chosen uniformly at random among all the genes, throughout the range of mean counts. MA-plots of the true fold changes used in the simulation and the observed fold changes induced by the simulation for one of the simulation settings are shown in Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S6.</p>
        <p>Algorithms’ performance in the simulation benchmark was assessed by their sensitivity and precision. The sensitivity was calculated as the fraction of genes with adjusted <italic>P</italic> value &lt;0.1 among the genes with true differences between group means. The precision was calculated as the fraction of genes with true differences between group means among those with adjusted <italic>P</italic> value &lt;0.1. The sensitivity is plotted over 1−precision, or the FDR, in Figure <xref rid="Fig6" ref-type="fig">6</xref>. <italic>DESeq2</italic>, and also <italic>edgeR</italic>, often had the highest sensitivity of the algorithms that controlled type-I error in the sense that the actual FDR was at or below 0.1, the threshold for adjusted <italic>P</italic> values used for calling differentially expressed genes. <italic>DESeq2</italic> had higher sensitivity compared to the other algorithms, particularly for small fold change (2 or 3), as was also found in benchmarks performed by Zhou <italic>et al.</italic> [<xref ref-type="bibr" rid="CR34">34</xref>]. For larger sample sizes and larger fold changes the performance of the various algorithms was more consistent.
<fig id="Fig6"><label>Figure 6</label><caption><p><bold>Sensitivity and precision of algorithms across combinations of sample size and effect size.</bold><italic>DESeq2</italic> and <italic>edgeR</italic> often had the highest sensitivity of those algorithms that controlled the FDR, i.e., those algorithms which fall on or to the left of the vertical black line. For a plot of sensitivity against false positive rate, rather than FDR, see Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S8, and for the dependence of sensitivity on the mean of counts, see Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S9. Note that <italic>EBSeq</italic> filters low-count genes (see main text for details).</p></caption><graphic xlink:href="13059_2014_550_Fig6_HTML" id="MO6"/></fig></p>
        <p>The overly conservative calling of the old <italic>DESeq</italic> tool can be observed, with reduced sensitivity compared to the other algorithms and an actual FDR less than the nominal value of 0.1. We note that <italic>EBSeq</italic> version 1.4.0 by default removes low-count genes – whose 75% quantile of normalized counts is less than ten – before calling differential expression. The sensitivity of algorithms on the simulated data across a range of the mean of counts are more closely compared in Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S9.</p>
        <p><bold>Outlier sensitivity</bold> We used simulations to compare the sensitivity and specificity of <italic>DESeq2</italic>’s outlier handling approach to that of <italic>edgeR</italic>, which was recently added to the software and published while this manuscript was under review. <italic>edgeR</italic> now includes an optional method to handle outliers by iteratively refitting the GLM after down-weighting potential outlier counts [<xref ref-type="bibr" rid="CR34">34</xref>]. The simulations, summarized in Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S10, indicated that both approaches to outliers nearly recover the performance on an outlier-free dataset, though <italic>edgeR-robust</italic> had slightly higher actual than nominal FDR, as seen in Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S11.</p>
        <p><bold>Precision of fold change estimates</bold> We benchmarked the <italic>DESeq2</italic> approach of using an empirical prior to achieve shrinkage of LFC estimates against two competing approaches: the <italic>GFOLD</italic> method, which can analyze experiments without replication [<xref ref-type="bibr" rid="CR20">20</xref>] and can also handle experiments with replicates, and the <italic>edgeR</italic> package, which provides a pseudocount-based shrinkage termed <italic>predictive LFCs</italic>. Results are summarized in Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figures S12–S16. <italic>DESeq2</italic> had consistently low root-mean-square error and mean absolute error across a range of sample sizes and models for a distribution of true LFCs. <italic>GFOLD</italic> had similarly low error to <italic>DESeq2</italic> over all genes; however, when focusing on differentially expressed genes, it performed worse for larger sample sizes. <italic>edgeR</italic> with default settings had similarly low error to <italic>DESeq2</italic> when focusing only on the differentially expressed genes, but had higher error over all genes.</p>
        <p><bold>Clustering</bold> We compared the performance of the rlog transformation against other methods of transformation or distance calculation in the recovery of simulated clusters. The adjusted Rand index [<xref ref-type="bibr" rid="CR37">37</xref>] was used to compare a hierarchical clustering based on various distances with the true cluster membership. We tested the Euclidean distance for normalized counts, logarithm of normalized counts plus a pseudocount of 1, rlog-transformed counts and VST counts. In addition we compared these Euclidean distances with the Poisson distance implemented in the <italic>PoiClaClu</italic> package [<xref ref-type="bibr" rid="CR38">38</xref>], and a distance implemented internally in the <italic>plotMDS</italic> function of <italic>edgeR</italic> (though not the default distance, which is similar to the logarithm of normalized counts). The results, shown in Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S17, revealed that when the size factors were equal for all samples, the Poisson distance and the Euclidean distance of rlog-transformed or VST counts outperformed other methods. However, when the size factors were not equal across samples, the rlog approach generally outperformed the other methods. Finally, we note that the rlog transformation provides normalized data, which can be used for a variety of applications, of which distance calculation is one.</p>
      </sec>
      <sec id="Sec16">
        <title>Benchmark for RNA sequencing data</title>
        <p>While simulation is useful to verify how well an algorithm behaves with idealized theoretical data, and hence can verify that the algorithm performs as expected under its own assumptions, simulations cannot inform us how well the theory fits reality. With RNA-seq data, there is the complication of not knowing fully or directly the underlying truth; however, we can work around this limitation by using more indirect inference, explained below.</p>
        <p>In the following benchmarks, we considered three performance metrics for differential expression calling: the false positive rate (or 1 minus the specificity), sensitivity and precision. We can obtain meaningful estimates of specificity from looking at datasets where we believe all genes fall under the null hypothesis of no differential expression [<xref ref-type="bibr" rid="CR39">39</xref>]. Sensitivity and precision are more difficult to estimate, as they require independent knowledge of those genes that are differentially expressed. To circumvent this problem, we used experimental reproducibility on independent samples (though from the same dataset) as a proxy. We used a dataset with large numbers of replicates in both of two groups, where we expect that truly differentially expressed genes exist. We repeatedly split this dataset into an evaluation set and a larger verification set, and compared the calls from the evaluation set with the calls from the verification set, which were taken as truth. It is important to keep in mind that the calls from the verification set are only an approximation of the true differential state, and the approximation error has a systematic and a stochastic component. The stochastic error becomes small once the sample size of the verification set is large enough. For the systematic errors, our benchmark assumes that these affect all algorithms more or less equally and do not markedly change the ranking of the algorithms.</p>
        <p><bold>False positive rate</bold> To evaluate the false positive rate of the algorithms, we considered mock comparisons from a dataset with many samples and no known condition dividing the samples into distinct groups. We used the RNA-seq data of Pickrell <italic>et al.</italic> [<xref ref-type="bibr" rid="CR17">17</xref>] for lymphoblastoid cell lines derived from unrelated Nigerian individuals. We chose a set of 26 RNA-seq samples of the same read length (46 base pairs) from male individuals. We randomly drew without replacement ten samples from the set to compare five against five, and this process was repeated 30 times. We estimated the false positive rate associated with a critical value of 0.01 by dividing the number of <italic>P</italic> values less than 0.01 by the total number of tests; genes with zero sum of read counts across samples were excluded. The results over the 30 replications, summarized in Figure <xref rid="Fig7" ref-type="fig">7</xref>, indicated that all algorithms generally controlled the number of false positives. <italic>DESeq (old)</italic> and <italic>Cuffdiff 2</italic> appeared overly conservative in this analysis, not using up their type-I error budget.
<fig id="Fig7"><label>Figure 7</label><caption><p><bold>Benchmark of false positive calling.</bold> Shown are estimates of <italic>P</italic>(<italic>P</italic> value&lt;0.01) under the null hypothesis. The FPR is the number of <italic>P</italic> values less than 0.01 divided by the total number of tests, from randomly selected comparisons of five vs five samples from the Pickrell <italic>et al.</italic> [<xref ref-type="bibr" rid="CR17">17</xref>] dataset, with no known condition dividing the samples. Type-I error control requires that the tool does not substantially exceed the nominal value of 0.01 (black line). <italic>EBSeq</italic> results were not included in this plot as it returns posterior probabilities, which unlike <italic>P</italic> values are not expected to be uniformly distributed under the null hypothesis. FPR, false positive rate.</p></caption><graphic xlink:href="13059_2014_550_Fig7_HTML" id="MO7"/></fig></p>
        <p><bold>Sensitivity</bold> To obtain an impression of the sensitivity of the algorithms, we considered the Bottomly <italic>et al.</italic> [<xref ref-type="bibr" rid="CR16">16</xref>] dataset, which contains ten and eleven replicates of two different, genetically homogeneous mice strains. This allowed for a split of three vs three for the evaluation set and seven vs eight for the verification set, which were balanced across the three experimental batches. Random splits were replicated 30 times. Batch information was not provided to the <italic>DESeq (old)</italic>, <italic>DESeq2</italic>, <italic>DSS</italic>, <italic>edgeR</italic> or <italic>voom</italic> algorithms, which can accommodate complex experimental designs, to have comparable calls across all algorithms.</p>
        <p>We rotated though each algorithm to determine the calls of the verification set. For a given algorithm’s verification set calls, we tested the evaluation set calls of every algorithm. We used this approach rather than a consensus-based method, as we did not want to favor or disfavor any particular algorithm or group of algorithms. Sensitivity was calculated as in the simulation benchmark, now with true differential expression defined by an adjusted <italic>P</italic> value &lt;0.1 in the larger verification set, as diagrammed in Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S18. Figure <xref rid="Fig8" ref-type="fig">8</xref> displays the estimates of sensitivity for each algorithm pair.
<fig id="Fig8"><label>Figure 8</label><caption><p><bold>Sensitivity estimated from experimental reproducibility.</bold> Each algorithm’s sensitivity in the evaluation set (box plots) is evaluated using the calls of each other algorithm in the verification set (panels with grey label).</p></caption><graphic xlink:href="13059_2014_550_Fig8_HTML" id="MO8"/></fig></p>
        <p>The ranking of algorithms was generally consistent regardless of which algorithm was chosen to determine calls in the verification set. <italic>DESeq2</italic> had comparable sensitivity to <italic>edgeR</italic> and <italic>voom</italic> though less than <italic>DSS</italic>. The median sensitivity estimates were typically between 0.2 and 0.4 for all algorithms. That all algorithms had relatively low median sensitivity can be explained by the small sample size of the evaluation set and the fact that increasing the sample size in the verification set increases power. It was expected that the permutation-based <italic>SAMseq</italic> method would rarely produce adjusted <italic>P</italic> value &lt;0.1 in the evaluation set, because the three vs three comparison does not enable enough permutations.</p>
        <p><bold>Precision</bold> Another important consideration from the perspective of an investigator is the precision, or fraction of true positives in the set of genes which pass the adjusted <italic>P</italic> value threshold. This can also be reported as 1−FDR. Again, ‘true’ differential expression was defined by an adjusted <italic>P</italic> value &lt;0.1 in the larger verification set. The estimates of precision are displayed in Figure <xref rid="Fig9" ref-type="fig">9</xref>, where we can see that <italic>DESeq2</italic> often had the second highest median precision, behind <italic>DESeq (old)</italic>. We can also see that algorithms with higher median sensitivity, e.g., <italic>DSS</italic>, were generally associated here with lower median precision. The rankings differed significantly when <italic>Cuffdiff 2</italic> was used to determine the verification set calls. This is likely due to the additional steps <italic>Cuffdiff 2</italic> performed to deconvolve changes in isoform-level abundance from gene-level abundance, which apparently came at the cost of lower precision when compared against its own verification set calls.
<fig id="Fig9"><label>Figure 9</label><caption><p><bold>Precision estimated from experimental reproducibility.</bold> Each algorithm’s precision in the evaluation set (box plots) is evaluated using the calls of each other algorithm in the verification set (panels with grey label).</p></caption><graphic xlink:href="13059_2014_550_Fig9_HTML" id="MO9"/></fig></p>
        <p>To compare the sensitivity and precision results further, we calculated the precision of algorithms along a grid of nominal adjusted <italic>P</italic> values (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S19). We then found the nominal adjusted <italic>P</italic> value for each algorithm, which resulted in a median actual precision of 0.9 (FDR = 0.1). Having thus calibrated each algorithm to a target FDR, we evaluated the sensitivity of calling, as shown in Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S20. As expected, here the algorithms performed more similarly to each other. This analysis revealed that, for a given target precision, <italic>DESeq2</italic> often was among the top algorithms by median sensitivity, though the variability across random replicates was larger than the differences between algorithms.</p>
        <p>The absolute number of calls for the evaluation and verification sets can be seen in Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figures S21 and S22, which mostly matched the order seen in the sensitivity plot of Figure <xref rid="Fig8" ref-type="fig">8</xref>. Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figures S23 and S24 provide heat maps and clustering based on the Jaccard index of calls for one replicate of the evaluation and verification sets, indicating a large overlap of calls across the different algorithms.</p>
        <p>In summary, the benchmarking tests showed that <italic>DESeq2</italic> effectively controlled type-I errors, maintaining a median false positive rate just below the chosen critical value in a mock comparison of groups of samples randomly chosen from a larger pool. For both simulation and analysis of real data, <italic>DESeq2</italic> often achieved the highest sensitivity of those algorithms that controlled the FDR.</p>
      </sec>
    </sec>
  </sec>
  <sec id="Sec17" sec-type="conclusion">
    <title>Conclusions</title>
    <p><italic>DESeq2</italic> offers a comprehensive and general solution for gene-level analysis of RNA-seq data. Shrinkage estimators substantially improve the stability and reproducibility of analysis results compared to maximum-likelihood-based solutions. Empirical Bayes priors provide automatic control of the amount of shrinkage based on the amount of information for the estimated quantity available in the data. This allows <italic>DESeq2</italic> to offer consistent performance over a large range of data types and makes it applicable for small studies with few replicates as well as for large observational studies. <italic>DESeq2</italic>’s heuristics for outlier detection help to recognize genes for which the modeling assumptions are unsuitable and so avoids type-I errors caused by these. The embedding of these strategies in the framework of GLMs enables the treatment of both simple and complex designs.</p>
    <p>A critical advance is the shrinkage estimator for fold changes for differential expression analysis, which offers a sound and statistically well-founded solution to the practically relevant problem of comparing fold change across the wide dynamic range of RNA-seq experiments. This is of value for many downstream analysis tasks, including the ranking of genes for follow-up studies and association of fold changes with other variables of interest. In addition, the rlog transformation, which implements shrinkage of fold changes on a per-sample basis, facilitates visualization of differences, for example in heat maps, and enables the application of a wide range of techniques that require homoskedastic input data, including machine-learning or ordination techniques such as principal component analysis and clustering.</p>
    <p><italic>DESeq2</italic> hence offers to practitioners a wide set of features with state-of-the-art inferential power. Its use cases are not limited to RNA-seq data or other transcriptomics assays; rather, many kinds of high-throughput count data can be used. Other areas for which <italic>DESeq</italic> or <italic>DESeq2</italic> have been used include chromatin immunoprecipitation sequencing assays (e.g., [<xref ref-type="bibr" rid="CR40">40</xref>]; see also the <italic>DiffBind</italic> package [<xref ref-type="bibr" rid="CR41">41</xref>,<xref ref-type="bibr" rid="CR42">42</xref>]), barcode-based assays (e.g., [<xref ref-type="bibr" rid="CR43">43</xref>]), metagenomics data (e.g., [<xref ref-type="bibr" rid="CR44">44</xref>]), ribosome profiling [<xref ref-type="bibr" rid="CR45">45</xref>] and CRISPR/Cas-library assays [<xref ref-type="bibr" rid="CR46">46</xref>]. Finally, the <italic>DESeq2</italic> package is integrated well in the Bioconductor infrastructure [<xref ref-type="bibr" rid="CR11">11</xref>] and comes with extensive documentation, including a vignette that demonstrates a complete analysis step by step and discusses advanced use cases.</p>
  </sec>
  <sec id="Sec18" sec-type="materials|methods">
    <title>Materials and methods</title>
    <p>A summary of the notation used in the following section is provided in Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S1.</p>
    <sec id="Sec19">
      <title>Model and normalization</title>
      <p>The read count <italic>K</italic><sub><italic>ij</italic></sub> for gene <italic>i</italic> in sample <italic>j</italic> is described with a GLM of the negative binomial family with a logarithmic link:
<disp-formula id="Equ1"><label>(1)</label><alternatives><tex-math id="M13">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
							 $$ \begin{aligned} K_{ij} &amp; \sim \text{NB}(\text{mean} = \mu_{ij}, \text{dispersion} = \alpha_{i})  \\ \mu_{ij} &amp;= s_{ij} q_{ij} \\ \end{aligned}  $$ 
						\end{document}</tex-math><mml:math id="M14"><mml:mtable><mml:mtr><mml:mtd><mml:msub><mml:mrow><mml:mi>K</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ij</mml:mtext></mml:mrow></mml:msub></mml:mtd><mml:mtd><mml:mo>∼</mml:mo><mml:mtext>NB</mml:mtext><mml:mo>(</mml:mo><mml:mtext>mean</mml:mtext><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ij</mml:mtext></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mtext>dispersion</mml:mtext><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msub><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ij</mml:mtext></mml:mrow></mml:msub></mml:mtd><mml:mtd><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ij</mml:mtext></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>q</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ij</mml:mtext></mml:mrow></mml:msub></mml:mtd></mml:mtr><mml:mtr/></mml:mtable></mml:math><graphic xlink:href="13059_2014_550_Article_Equ1.gif" position="anchor"/></alternatives></disp-formula></p>
      <p>
        <disp-formula id="Equ2">
          <label>(2)</label>
          <alternatives>
            <tex-math id="M15">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
							 $$ \log q_{ij} = \sum_{r} x_{jr} \beta_{ir}.   $$ 
						\end{document}</tex-math>
            <mml:math id="M16">
              <mml:mo>log</mml:mo>
              <mml:msub>
                <mml:mrow>
                  <mml:mi>q</mml:mi>
                </mml:mrow>
                <mml:mrow>
                  <mml:mtext mathvariant="italic">ij</mml:mtext>
                </mml:mrow>
              </mml:msub>
              <mml:mo>=</mml:mo>
              <mml:munder>
                <mml:mrow>
                  <mml:mo>∑</mml:mo>
                </mml:mrow>
                <mml:mrow>
                  <mml:mi>r</mml:mi>
                </mml:mrow>
              </mml:munder>
              <mml:msub>
                <mml:mrow>
                  <mml:mi>x</mml:mi>
                </mml:mrow>
                <mml:mrow>
                  <mml:mtext mathvariant="italic">jr</mml:mtext>
                </mml:mrow>
              </mml:msub>
              <mml:msub>
                <mml:mrow>
                  <mml:mi>β</mml:mi>
                </mml:mrow>
                <mml:mrow>
                  <mml:mtext mathvariant="italic">ir</mml:mtext>
                </mml:mrow>
              </mml:msub>
              <mml:mi>.</mml:mi>
            </mml:math>
            <graphic xlink:href="13059_2014_550_Article_Equ2.gif" position="anchor"/>
          </alternatives>
        </disp-formula>
      </p>
      <p>For notational simplicity, the equations here use the natural logarithm as the link function, though the <italic>DESeq2</italic> software reports estimated model coefficients and their estimated standard errors on the log2 scale.</p>
      <p>By default, the normalization constants <italic>s</italic><sub><italic>ij</italic></sub> are considered constant within a sample, <italic>s</italic><sub><italic>ij</italic></sub>=<italic>s</italic><sub><italic>j</italic></sub>, and are estimated with the median-of-ratios method previously described and used in <italic>DESeq</italic> [<xref ref-type="bibr" rid="CR4">4</xref>] and <italic>DEXSeq</italic> [<xref ref-type="bibr" rid="CR30">30</xref>]:
<disp-formula id="Equa"><alternatives><tex-math id="M17">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
							 $$s_{j} = {\underset{i:\,K_{i}^{\text{R}}\neq 0}{\text{median}}}\, \frac{K_{ij}}{K^{\text{R}}_{i}}\quad\text{with}\quad K^{\text{R}}_{i} = \left(\prod\limits_{j=1}^{m} K_{ij}\right)^{1/m}. $$ 
						\end{document}</tex-math><mml:math id="M18"><mml:mrow><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:munder><mml:mrow><mml:mtext>median</mml:mtext></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>:</mml:mo><mml:mspace width="0.3em"/><mml:msubsup><mml:mrow><mml:mi>K</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mtext>R</mml:mtext></mml:mrow></mml:msubsup><mml:mo>≠</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:munder><mml:mspace width="0.3em"/><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi>K</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ij</mml:mtext></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msubsup><mml:mrow><mml:mi>K</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mtext>R</mml:mtext></mml:mrow></mml:msubsup></mml:mrow></mml:mfrac><mml:mspace width="1em"/><mml:mtext>with</mml:mtext><mml:mspace width="1em"/><mml:msubsup><mml:mrow><mml:mi>K</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mtext>R</mml:mtext></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:munderover accent="false" accentunder="false"><mml:mrow><mml:mo mathsize="big">∏</mml:mo></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:munderover><mml:msub><mml:mrow><mml:mi>K</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ij</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:mi>m</mml:mi></mml:mrow></mml:msup><mml:mi>.</mml:mi></mml:mrow></mml:math><graphic xlink:href="13059_2014_550_Article_Equa.gif" position="anchor"/></alternatives></disp-formula></p>
      <p>Alternatively, the user can supply normalization constants <italic>s</italic><sub><italic>ij</italic></sub> calculated using other methods (e.g., using <italic>cqn</italic> [<xref ref-type="bibr" rid="CR13">13</xref>] or <italic>EDASeq</italic> [<xref ref-type="bibr" rid="CR14">14</xref>]), which may differ from gene to gene.</p>
    </sec>
    <sec id="Sec20">
      <title>Expanded design matrices</title>
      <p>For consistency with our software’s documentation, in the following text we will use the terminology of the <italic>R</italic> statistical language. In linear modeling, a categorical variable or <italic>factor</italic> can take on two or more values or <italic>levels</italic>. In standard design matrices, one of the values is chosen as a reference value or <italic>base level</italic> and absorbed into the intercept. In standard GLMs, the choice of base level does not influence the values of contrasts (LFCs). This, however, is no longer the case in our approach using ridge-regression-like shrinkage on the coefficients (described below), when factors with more than two levels are present in the design matrix, because the base level will not undergo shrinkage while the other levels do.</p>
      <p>To recover the desirable symmetry between all levels, <italic>DESeq2</italic> uses <italic>expanded design matrices</italic>, which include an indicator variable for <italic>each</italic> level of each factor, in addition to an intercept column (i.e., none of the levels is absorbed into the intercept). While such a design matrix no longer has full rank, a unique solution exists because the zero-centered prior distribution (see below) provides regularization. For dispersion estimation and for estimating the width of the LFC prior, standard design matrices are used.</p>
    </sec>
    <sec id="Sec21">
      <title>Contrasts</title>
      <p>Contrasts between levels and standard errors of such contrasts can be calculated as they would in the standard design matrix case, i.e., using:
<disp-formula id="Equ3"><label>(3)</label><alternatives><tex-math id="M19">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
							 $$ {\beta_{i}^{c}} = \vec{c}\,^{t} \vec{\beta_{i}}   $$ 
						\end{document}</tex-math><mml:math id="M20"><mml:msubsup><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>c</mml:mi></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mover accent="true"><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mo>→</mml:mo></mml:mover><mml:msup><mml:mrow><mml:mspace width="0.3em"/></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msup><mml:mover accent="true"><mml:mrow><mml:msub><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>→</mml:mo></mml:mover></mml:math><graphic xlink:href="13059_2014_550_Article_Equ3.gif" position="anchor"/></alternatives></disp-formula></p>
      <p>
        <disp-formula id="Equ4">
          <label>(4)</label>
          <alternatives>
            <tex-math id="M21">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
							 $$ \text{SE}\left({\beta_{i}^{c}}\right) = \sqrt{\vec{c}\,^{t} \Sigma_{i} \vec{c}},   $$ 
						\end{document}</tex-math>
            <mml:math id="M22">
              <mml:mtext>SE</mml:mtext>
              <mml:mfenced close=")" open="(" separators="">
                <mml:mrow>
                  <mml:msubsup>
                    <mml:mrow>
                      <mml:mi>β</mml:mi>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mi>i</mml:mi>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mi>c</mml:mi>
                    </mml:mrow>
                  </mml:msubsup>
                </mml:mrow>
              </mml:mfenced>
              <mml:mo>=</mml:mo>
              <mml:msqrt>
                <mml:mrow>
                  <mml:mover accent="true">
                    <mml:mrow>
                      <mml:mi>c</mml:mi>
                    </mml:mrow>
                    <mml:mo>→</mml:mo>
                  </mml:mover>
                  <mml:msup>
                    <mml:mrow>
                      <mml:mspace width="0.3em"/>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mi>t</mml:mi>
                    </mml:mrow>
                  </mml:msup>
                  <mml:msub>
                    <mml:mrow>
                      <mml:mi>Σ</mml:mi>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mi>i</mml:mi>
                    </mml:mrow>
                  </mml:msub>
                  <mml:mover accent="true">
                    <mml:mrow>
                      <mml:mi>c</mml:mi>
                    </mml:mrow>
                    <mml:mo>→</mml:mo>
                  </mml:mover>
                </mml:mrow>
              </mml:msqrt>
              <mml:mo>,</mml:mo>
            </mml:math>
            <graphic xlink:href="13059_2014_550_Article_Equ4.gif" position="anchor"/>
          </alternatives>
        </disp-formula>
      </p>
      <p>where <inline-formula id="IEq7"><alternatives><tex-math id="M23">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
							$\vec {c}$
						\end{document}</tex-math><mml:math id="M24"><mml:mover accent="true"><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mo>→</mml:mo></mml:mover></mml:math><inline-graphic xlink:href="13059_2014_550_Article_IEq7.gif"/></alternatives></inline-formula> represents a numeric contrast, e.g., 1 and −1 specifying the numerator and denominator of a simple two-level contrast, and <inline-formula id="IEq8"><alternatives><tex-math id="M25">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
							$\Sigma _{i} = \text {Cov}(\vec \beta _{i})$
						\end{document}</tex-math><mml:math id="M26"><mml:msub><mml:mrow><mml:mi>Σ</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mtext>Cov</mml:mtext><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mo>→</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:math><inline-graphic xlink:href="13059_2014_550_Article_IEq8.gif"/></alternatives></inline-formula>, defined below.</p>
    </sec>
    <sec id="Sec22">
      <title>Estimation of dispersions</title>
      <p>We assume the dispersion parameter <italic>α</italic><sub><italic>i</italic></sub> follows a log-normal prior distribution that is centered around a trend that depends on the gene’s mean normalized read count:
<disp-formula id="Equ5"><label>(5)</label><alternatives><tex-math id="M27">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
							 $$ \log \alpha_{i} \sim N\!\left(\log \alpha_{\text{tr}}(\bar\mu_{i}), \, \sigma_{\text{d}}^{2} \right).   $$ 
						\end{document}</tex-math><mml:math id="M28"><mml:mo>log</mml:mo><mml:msub><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>∼</mml:mo><mml:mi>N</mml:mi><mml:mspace width="0.3em"/><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mo>log</mml:mo><mml:msub><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mtext>tr</mml:mtext></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mo>¯</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo><mml:mo>,</mml:mo><mml:mspace width="0.3em"/><mml:msubsup><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mtext>d</mml:mtext></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:mrow></mml:mfenced><mml:mi>.</mml:mi></mml:math><graphic xlink:href="13059_2014_550_Article_Equ5.gif" position="anchor"/></alternatives></disp-formula></p>
      <p>Here, <italic>α</italic><sub>tr</sub> is a function of the gene’s mean normalized count,
<disp-formula id="Equb"><alternatives><tex-math id="M29">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
							 $$\bar{\mu}_{i} = \frac{1}{m} \sum\limits_{j} \frac{K_{ij}}{s_{ij}}. $$ 
						\end{document}</tex-math><mml:math id="M30"><mml:mrow><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mo>¯</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:mfrac><mml:munder><mml:mrow><mml:mo mathsize="big">∑</mml:mo></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:munder><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi>K</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ij</mml:mtext></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ij</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:mi>.</mml:mi></mml:mrow></mml:math><graphic xlink:href="13059_2014_550_Article_Equb.gif" position="anchor"/></alternatives></disp-formula> It describes the mean-dependent expectation of the prior. <italic>σ</italic><sub>d</sub> is the width of the prior, a hyperparameter describing how much the individual genes’ true dispersions scatter around the trend. For the trend function, we use the same parametrization as we used for <italic>DEXSeq</italic> [<xref ref-type="bibr" rid="CR30">30</xref>], namely,
<disp-formula id="Equ6"><label>(6)</label><alternatives><tex-math id="M31">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
							 $$ \alpha_{\text{tr}}(\bar{\mu}) = \frac{a_{1}}{\bar{\mu}} + \alpha_{0}.   $$ 
						\end{document}</tex-math><mml:math id="M32"><mml:msub><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mtext>tr</mml:mtext></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mover accent="true"><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mo>¯</mml:mo></mml:mover><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi>a</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mo>¯</mml:mo></mml:mover></mml:mrow></mml:mfrac><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mi>.</mml:mi></mml:math><graphic xlink:href="13059_2014_550_Article_Equ6.gif" position="anchor"/></alternatives></disp-formula></p>
      <p>We get final dispersion estimates from this model in three steps, which implement a computationally fast approximation to a full empirical Bayes treatment. We first use the count data for each gene separately to get preliminary gene-wise dispersion estimates <inline-formula id="IEq9"><alternatives><tex-math id="M33">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
							$\alpha ^{\text {gw}}_{i}$
						\end{document}</tex-math><mml:math id="M34"><mml:msubsup><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mtext>gw</mml:mtext></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2014_550_Article_IEq9.gif"/></alternatives></inline-formula> by maximum-likelihood estimation. Then, we fit the dispersion trend <italic>α</italic><sub>tr</sub>. Finally, we combine the likelihood with the trended prior to get maximum <italic>a posteriori</italic> (MAP) values as final dispersion estimates. Details for the three steps follow.</p>
      <p><bold>Gene-wise dispersion estimates</bold> To get a gene-wise dispersion estimate for a gene <italic>i</italic>, we start by fitting a negative binomial GLM without an LFC prior for the design matrix <italic>X</italic> to the gene’s count data. This GLM uses a rough method-of-moments estimate of dispersion, based on the within-group variances and means. The initial GLM is necessary to obtain an initial set of fitted values, <inline-formula id="IEq10"><alternatives><tex-math id="M35">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
							$\hat \mu _{\textit {ij}}^{0}$
						\end{document}</tex-math><mml:math id="M36"><mml:msubsup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ij</mml:mtext></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2014_550_Article_IEq10.gif"/></alternatives></inline-formula>. We then maximize the Cox–Reid adjusted likelihood of the dispersion, conditioned on the fitted values <inline-formula id="IEq11"><alternatives><tex-math id="M37">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
							$\hat \mu _{\textit {ij}}^{0}$
						\end{document}</tex-math><mml:math id="M38"><mml:msubsup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ij</mml:mtext></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2014_550_Article_IEq11.gif"/></alternatives></inline-formula> from the initial fit, to obtain the gene-wise estimate <inline-formula id="IEq12"><alternatives><tex-math id="M39">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
							$\alpha ^{\text {gw}}_{i}$
						\end{document}</tex-math><mml:math id="M40"><mml:msubsup><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mtext>gw</mml:mtext></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2014_550_Article_IEq12.gif"/></alternatives></inline-formula>, i.e.,
<disp-formula id="Equc"><alternatives><tex-math id="M41">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
							 $$\alpha^{\text{gw}}_{i} = {\underset{\alpha}{\text{arg max}}}\; \ell_{\text{CR}}\left(\alpha; \vec\mu_{\textit{i}\cdot}^{0}, \vec K_{\textit{i}\cdot}\right) $$ 
						\end{document}</tex-math><mml:math id="M42"><mml:mrow><mml:msubsup><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mtext>gw</mml:mtext></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:munder><mml:mrow><mml:mtext>arg max</mml:mtext></mml:mrow><mml:mrow><mml:mi>α</mml:mi></mml:mrow></mml:munder><mml:mspace width="2.77626pt"/><mml:msub><mml:mrow><mml:mi>ℓ</mml:mi></mml:mrow><mml:mrow><mml:mtext>CR</mml:mtext></mml:mrow></mml:msub><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mi>α</mml:mi><mml:mo>;</mml:mo><mml:msubsup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mo>→</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">i</mml:mtext><mml:mo>·</mml:mo></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>K</mml:mi></mml:mrow><mml:mo>→</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">i</mml:mtext><mml:mo>·</mml:mo></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:mrow></mml:math><graphic xlink:href="13059_2014_550_Article_Equc.gif" position="anchor"/></alternatives></disp-formula> with
<disp-formula id="Equ7"><label>(7)</label><alternatives><tex-math id="M43">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
							 $$ \begin{aligned} \ell_{\text{CR}}(\alpha; \vec\mu, \vec K) &amp;= \ell(\alpha) - \frac{1}{2} \log\left(\det\left(X^{t} W X\right) \right)  \\ \ell(\alpha) &amp;= \sum\limits_{j} \log f_{\text{NB}}(K_{j}; \mu_{j}, \alpha), \end{aligned}  $$ 
						\end{document}</tex-math><mml:math id="M44"><mml:mtable><mml:mtr><mml:mtd><mml:msub><mml:mrow><mml:mi>ℓ</mml:mi></mml:mrow><mml:mrow><mml:mtext>CR</mml:mtext></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mi>α</mml:mi><mml:mo>;</mml:mo><mml:mover accent="true"><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mo>→</mml:mo></mml:mover><mml:mo>,</mml:mo><mml:mover accent="true"><mml:mrow><mml:mi>K</mml:mi></mml:mrow><mml:mo>→</mml:mo></mml:mover><mml:mo>)</mml:mo></mml:mtd><mml:mtd><mml:mo>=</mml:mo><mml:mi>ℓ</mml:mi><mml:mo>(</mml:mo><mml:mi>α</mml:mi><mml:mo>)</mml:mo><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:mfrac><mml:mo>log</mml:mo><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mo>det</mml:mo><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msup><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msup><mml:mtext mathvariant="italic">WX</mml:mtext></mml:mrow></mml:mfenced></mml:mrow></mml:mfenced></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mi>ℓ</mml:mi><mml:mo>(</mml:mo><mml:mi>α</mml:mi><mml:mo>)</mml:mo></mml:mtd><mml:mtd><mml:mo>=</mml:mo><mml:munder><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:munder><mml:mo>log</mml:mo><mml:msub><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mtext>NB</mml:mtext></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>K</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>;</mml:mo><mml:msub><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>α</mml:mi><mml:mo>)</mml:mo><mml:mo>,</mml:mo></mml:mtd></mml:mtr></mml:mtable></mml:math><graphic xlink:href="13059_2014_550_Article_Equ7.gif" position="anchor"/></alternatives></disp-formula></p>
      <p>where <italic>f</italic><sub>NB</sub>(<italic>k</italic>;<italic>μ</italic>,<italic>α</italic>) is the probability mass function of the negative binomial distribution with mean <italic>μ</italic> and dispersion <italic>α</italic>, and the second term provides the Cox–Reid bias adjustment [<xref ref-type="bibr" rid="CR47">47</xref>]. This adjustment, first used in the context of dispersion estimation for SAGE data [<xref ref-type="bibr" rid="CR48">48</xref>] and then for HTS data [<xref ref-type="bibr" rid="CR3">3</xref>] in <italic>edgeR</italic>, corrects for the negative bias of dispersion estimates from using the MLEs for the fitted values <inline-formula id="IEq13"><alternatives><tex-math id="M45">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
							$\hat \mu _{\textit {ij}}^{0}$
						\end{document}</tex-math><mml:math id="M46"><mml:msubsup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ij</mml:mtext></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2014_550_Article_IEq13.gif"/></alternatives></inline-formula> (analogous to Bessel’s correction in the usual sample variance formula; for details, see [<xref ref-type="bibr" rid="CR49">49</xref>], Section 10.6). It is formed from the Fisher information for the fitted values, which is here calculated as det(<italic>X</italic><sup><italic>t</italic></sup><italic>W</italic><italic>X</italic>), where <italic>W</italic> is the diagonal weight matrix from the standard iteratively reweighted least-squares algorithm. As the GLM’s link function is <italic>g</italic>(<italic>μ</italic>)= log(<italic>μ</italic>) and its variance function is <italic>V</italic>(<italic>μ</italic>;<italic>α</italic>)=<italic>μ</italic>+<italic>α</italic><italic>μ</italic><sup>2</sup>, the elements of the diagonal matrix <italic>W</italic><sub><italic>i</italic></sub> are given by:
<disp-formula id="Equd"><alternatives><tex-math id="M47">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
							 $$w_{jj} = \frac{1}{g^{\prime}(\mu_{j})^{2} V(\mu_{j})} = \frac{1}{1/\mu_{j} + \alpha}. $$ 
						\end{document}</tex-math><mml:math id="M48"><mml:mrow><mml:msub><mml:mrow><mml:mi>w</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">jj</mml:mtext></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:mi>g</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mi>V</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:msub><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mi>α</mml:mi></mml:mrow></mml:mfrac><mml:mi>.</mml:mi></mml:mrow></mml:math><graphic xlink:href="13059_2014_550_Article_Equd.gif" position="anchor"/></alternatives></disp-formula></p>
      <p>The optimization in Equation (<xref rid="Equ7" ref-type="">7</xref>) is performed on the scale of log<italic>α</italic> using a backtracking line search with accepted proposals that satisfy Armijo conditions [<xref ref-type="bibr" rid="CR50">50</xref>].</p>
      <p><bold>Dispersion trend</bold> A parametric curve of the form (<xref rid="Equ6" ref-type="">6</xref>) is fit by regressing the gene-wise dispersion estimates <inline-formula id="IEq14"><alternatives><tex-math id="M49">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
							$\alpha ^{\text {gw}}_{i}$
						\end{document}</tex-math><mml:math id="M50"><mml:msubsup><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mtext>gw</mml:mtext></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2014_550_Article_IEq14.gif"/></alternatives></inline-formula> onto the means of the normalized counts, <inline-formula id="IEq15"><alternatives><tex-math id="M51">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
							$\bar {\mu }_{i}$
						\end{document}</tex-math><mml:math id="M52"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mo>¯</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13059_2014_550_Article_IEq15.gif"/></alternatives></inline-formula>. The sampling distribution of the gene-wise dispersion estimate around the true value <italic>α</italic><sub><italic>i</italic></sub> can be highly skewed, and therefore we do not use ordinary least-squares regression but rather gamma-family GLM regression. Furthermore, dispersion outliers could skew the fit and hence a scheme to exclude such outliers is used.</p>
      <p>The hyperparameters <italic>a</italic><sub>1</sub> and <italic>α</italic><sub>0</sub> of (<xref rid="Equ6" ref-type="">6</xref>) are obtained by iteratively fitting a gamma-family GLM. At each iteration, genes with a ratio of dispersion to fitted value outside the range [10<sup>−4</sup>,15] are left out until the sum of squared LFCs of the new coefficients over the old coefficients is less than 10<sup>−6</sup> (same approach as in <italic>DEXSeq</italic> [<xref ref-type="bibr" rid="CR30">30</xref>]).</p>
      <p>The parametrization (<xref rid="Equ6" ref-type="">6</xref>) is based on reports by us and others of decreasing dependence of dispersion on the mean in many datasets [<xref ref-type="bibr" rid="CR3">3</xref>-<xref ref-type="bibr" rid="CR6">6</xref>,<xref ref-type="bibr" rid="CR51">51</xref>]. Some caution is warranted to disentangle true underlying dependence from effects of estimation bias that can create a perceived dependence of the dispersion on the mean. Consider a negative binomial distributed random variable with expectation <italic>μ</italic> and dispersion <italic>α</italic>. Its variance <italic>v</italic>=<italic>μ</italic>+<italic>α</italic><italic>μ</italic><sup>2</sup> has two components, <italic>v</italic>=<italic>v</italic><sub>P</sub>+<italic>v</italic><sub>D</sub>, the Poisson component <italic>v</italic><sub>P</sub>=<italic>μ</italic> independent of <italic>α</italic>, and the overdispersion component <italic>v</italic><sub>D</sub>=<italic>α</italic><italic>μ</italic><sup>2</sup>. When <italic>μ</italic> is small, <italic>μ</italic>≲1/<italic>α</italic> (vertical lines in Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S1), the Poisson component dominates, in the sense that <inline-formula id="IEq16"><alternatives><tex-math id="M53">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
							$v_{\text {P}}/v_{\text {D}} = 1/(\alpha \mu) \gtrsim 1$
						\end{document}</tex-math><mml:math id="M54"><mml:msub><mml:mrow><mml:mi>v</mml:mi></mml:mrow><mml:mrow><mml:mtext>P</mml:mtext></mml:mrow></mml:msub><mml:mo>/</mml:mo><mml:msub><mml:mrow><mml:mi>v</mml:mi></mml:mrow><mml:mrow><mml:mtext>D</mml:mtext></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:mo>(</mml:mo><mml:mi>αμ</mml:mi><mml:mo>)</mml:mo><mml:mo>≳</mml:mo><mml:mn>1</mml:mn></mml:math><inline-graphic xlink:href="13059_2014_550_Article_IEq16.gif"/></alternatives></inline-formula>, and the observed data provide little information on the value of <italic>α</italic>. Therefore the sampling variance of an estimator for <italic>α</italic> will be large when <italic>μ</italic>≲1/<italic>α</italic>, which leads to the appearance of bias. For simplicity, we have stated the above argument without regard to the influence of the size factors, <italic>s</italic><sub><italic>j</italic></sub>, on the value of <italic>μ</italic>. This is permissible because, by construction, the geometric mean of our size factors is close to 1, and hence, the mean across samples of the unnormalized read counts, <inline-formula id="IEq17"><alternatives><tex-math id="M55">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
							$\frac {1}{m}\sum _{j} K_{\textit {ij}}$
						\end{document}</tex-math><mml:math id="M56"><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:mfrac><mml:munder><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:munder><mml:msub><mml:mrow><mml:mi>K</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ij</mml:mtext></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13059_2014_550_Article_IEq17.gif"/></alternatives></inline-formula>, and the mean of the normalized read counts, <inline-formula id="IEq18"><alternatives><tex-math id="M57">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
							$\frac {1}{m}\sum _{j} K_{\textit {ij}}/s_{j}$
						\end{document}</tex-math><mml:math id="M58"><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:mfrac><mml:munder><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:munder><mml:msub><mml:mrow><mml:mi>K</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ij</mml:mtext></mml:mrow></mml:msub><mml:mo>/</mml:mo><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13059_2014_550_Article_IEq18.gif"/></alternatives></inline-formula>, will be roughly the same.</p>
      <p>This phenomenon may give rise to an apparent dependence of <italic>α</italic> on <italic>μ</italic>. It is possible that the shape of the dispersion-mean fit for the Bottomly data (Figure <xref rid="Fig1" ref-type="fig">1</xref>A) can be explained in that manner: the asymptotic dispersion is <italic>α</italic><sub>0</sub>≈0.01, and the non-zero slope of the mean-dispersion plot is limited to the range of mean counts up to around 100, the reciprocal of <italic>α</italic><sub>0</sub>. However, overestimation of <italic>α</italic> in that low-count range has little effect on inference, as in that range the variance <italic>v</italic> is anyway dominated by the <italic>α</italic>-independent Poisson component <italic>v</italic><sub>P</sub>. The situation is different for the Pickrell data: here, a dependence of dispersion on mean was observed for counts clearly above the reciprocal of the asymptotic dispersion <italic>α</italic><sub>0</sub> (Figure <xref rid="Fig1" ref-type="fig">1</xref>B), and hence is not due merely to estimation bias. Simulations (shown in Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S25) confirmed that the observed joint distribution of estimated dispersions and means is not compatible with a single, constant dispersion. Therefore, the parametrization (<xref rid="Equ6" ref-type="">6</xref>) is a flexible and mildly conservative modeling choice: it is able to pick up dispersion-mean dependence if it is present, while it can lead to a minor loss of power in the low-count range due to a tendency to overestimate dispersion there.</p>
      <p><bold>Dispersion prior</bold> As also observed by Wu <italic>et al.</italic> [<xref ref-type="bibr" rid="CR6">6</xref>], a log-normal prior fits the observed dispersion distribution for typical RNA-seq datasets. We solve the computational difficulty of working with a non-conjugate prior using the following argument: the logarithmic residuals from the trend fit, <inline-formula id="IEq19"><alternatives><tex-math id="M59">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
							$\log \alpha ^{\text {gw}}_{i} - \log \alpha _{\text {tr}}(\bar \mu _{i})$
						\end{document}</tex-math><mml:math id="M60"><mml:mo>log</mml:mo><mml:munderover><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mtext>gw</mml:mtext></mml:mrow></mml:munderover><mml:mo>−</mml:mo><mml:mo>log</mml:mo><mml:msub><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mtext>tr</mml:mtext></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mo>¯</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:math><inline-graphic xlink:href="13059_2014_550_Article_IEq19.gif"/></alternatives></inline-formula>, arise from two contributions, namely the scatter of the true logarithmic dispersions around the trend, given by the prior with variance <inline-formula id="IEq20"><alternatives><tex-math id="M61">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
							$\sigma _{\text {d}}^{2}$
						\end{document}</tex-math><mml:math id="M62"><mml:msubsup><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mtext>d</mml:mtext></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2014_550_Article_IEq20.gif"/></alternatives></inline-formula>, and the sampling distribution of the logarithm of the dispersion estimator, with variance <inline-formula id="IEq21"><alternatives><tex-math id="M63">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
							$\sigma ^{2}_{\text {lde}}$
						\end{document}</tex-math><mml:math id="M64"><mml:msubsup><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mtext>lde</mml:mtext></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2014_550_Article_IEq21.gif"/></alternatives></inline-formula>. The sampling distribution of a dispersion estimator is approximately a scaled <italic>χ</italic><sup>2</sup> distribution with <italic>m</italic>−<italic>p</italic> degrees of freedom, with <italic>m</italic> the number of samples and <italic>p</italic> the number of coefficients. The variance of the logarithm of a <inline-formula id="IEq22"><alternatives><tex-math id="M65">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
							${\chi ^{2}_{f}}$
						\end{document}</tex-math><mml:math id="M66"><mml:msubsup><mml:mrow><mml:mi>χ</mml:mi></mml:mrow><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2014_550_Article_IEq22.gif"/></alternatives></inline-formula>-distributed random variable is given [<xref ref-type="bibr" rid="CR52">52</xref>] by the trigamma function <italic>ψ</italic><sub>1</sub>,
<disp-formula id="Eque"><alternatives><tex-math id="M67">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
							 $$\operatorname{Var} \log X^{2} = \psi_{1}(f/2)\quad\text{for}\quad X^{2} {\sim\chi^{2}_{f}}.  $$ 
						\end{document}</tex-math><mml:math id="M68"><mml:mrow><mml:mo>Var</mml:mo><mml:mo>log</mml:mo><mml:msup><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>ψ</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mi>f</mml:mi><mml:mo>/</mml:mo><mml:mn>2</mml:mn><mml:mo>)</mml:mo><mml:mspace width="1em"/><mml:mtext>for</mml:mtext><mml:mspace width="1em"/><mml:msup><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo>∼</mml:mo><mml:munderover><mml:mrow><mml:mi>χ</mml:mi></mml:mrow><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:munderover><mml:mi>.</mml:mi></mml:mrow></mml:math><graphic xlink:href="13059_2014_550_Article_Eque.gif" position="anchor"/></alternatives></disp-formula> Therefore, <inline-formula id="IEq23"><alternatives><tex-math id="M69">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
							$\sigma ^{2}_{\text {lde}}\approx \psi _{1}((m-p)/2)$
						\end{document}</tex-math><mml:math id="M70"><mml:msubsup><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mtext>lde</mml:mtext></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo>≈</mml:mo><mml:msub><mml:mrow><mml:mi>ψ</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mo>(</mml:mo><mml:mi>m</mml:mi><mml:mo>−</mml:mo><mml:mi>p</mml:mi><mml:mo>)</mml:mo><mml:mo>/</mml:mo><mml:mn>2</mml:mn><mml:mo>)</mml:mo></mml:math><inline-graphic xlink:href="13059_2014_550_Article_IEq23.gif"/></alternatives></inline-formula>, i.e., the sampling variance of the logarithm of a variance or dispersion estimator is approximately constant across genes and depends only on the degrees of freedom of the model.</p>
      <p>Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S2 compares this approximation for the variance of logarithmic dispersion estimates with the variance of logarithmic Cox–Reid adjusted dispersion estimates for simulated negative binomial data, over a combination of different sample sizes, number of parameters and dispersion values used to create the simulated data. The approximation is close to the sample variance for various typical values of <italic>m</italic>, <italic>p</italic> and <italic>α</italic>.</p>
      <p>Therefore, the prior variance <inline-formula id="IEq24"><alternatives><tex-math id="M71">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
							$\sigma _{\text {d}}^{2}$
						\end{document}</tex-math><mml:math id="M72"><mml:msubsup><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mtext>d</mml:mtext></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2014_550_Article_IEq24.gif"/></alternatives></inline-formula> is obtained by subtracting the expected sampling variance from an estimate of the variance of the logarithmic residuals, <inline-formula id="IEq25"><alternatives><tex-math id="M73">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
							$s^{2}_{\text {lr}}$
						\end{document}</tex-math><mml:math id="M74"><mml:msubsup><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mtext>lr</mml:mtext></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2014_550_Article_IEq25.gif"/></alternatives></inline-formula>:
<disp-formula id="Equf"><alternatives><tex-math id="M75">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
							 $$\sigma_{\text{d}}^{2} = \operatorname{max}\left\{ s^{2}_{\text{lr}} - \psi_{1}((m-p)/2),\,\,0.25 \right\}. $$ 
						\end{document}</tex-math><mml:math id="M76"><mml:mrow><mml:msubsup><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mtext>d</mml:mtext></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mo>max</mml:mo><mml:mfenced close="}" open="{" separators=""><mml:mrow><mml:munderover><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mtext>lr</mml:mtext></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:munderover><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi>ψ</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mo>(</mml:mo><mml:mi>m</mml:mi><mml:mo>−</mml:mo><mml:mi>p</mml:mi><mml:mo>)</mml:mo><mml:mo>/</mml:mo><mml:mn>2</mml:mn><mml:mo>)</mml:mo><mml:mo>,</mml:mo><mml:mspace width="0.3em"/><mml:mspace width="0.3em"/><mml:mn>0.25</mml:mn></mml:mrow></mml:mfenced><mml:mi>.</mml:mi></mml:mrow></mml:math><graphic xlink:href="13059_2014_550_Article_Equf.gif" position="anchor"/></alternatives></disp-formula> The prior variance <inline-formula id="IEq26"><alternatives><tex-math id="M77">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
							$\sigma _{\text {d}}^{2}$
						\end{document}</tex-math><mml:math id="M78"><mml:msubsup><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mtext>d</mml:mtext></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2014_550_Article_IEq26.gif"/></alternatives></inline-formula> is thresholded at a minimal value of 0.25 so that the dispersion estimates are not shrunk entirely to <inline-formula id="IEq27"><alternatives><tex-math id="M79">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
							$\alpha _{\text {tr}}(\bar \mu _{i})$
						\end{document}</tex-math><mml:math id="M80"><mml:msub><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mtext>tr</mml:mtext></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mo>¯</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:math><inline-graphic xlink:href="13059_2014_550_Article_IEq27.gif"/></alternatives></inline-formula> if the variance of the logarithmic residuals is less than the expected sampling variance.</p>
      <p>To avoid inflation of <inline-formula id="IEq28"><alternatives><tex-math id="M81">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
							$\sigma _{\text {d}}^{2}$
						\end{document}</tex-math><mml:math id="M82"><mml:msubsup><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mtext>d</mml:mtext></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2014_550_Article_IEq28.gif"/></alternatives></inline-formula> due to dispersion outliers (i.e., genes not well captured by this prior; see below), we use a robust estimator for the standard deviation <italic>s</italic><sub>lr</sub> of the logarithmic residuals,
<disp-formula id="Equ8"><label>(8)</label><alternatives><tex-math id="M83">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
							 $$ s_{\text{lr}} = {\underset{i}{\text{mad}}} \left(\log \alpha^{\text{gw}}_{i} - \log \alpha_{\text{tr}}(\bar\mu_{i})\right),   $$ 
						\end{document}</tex-math><mml:math id="M84"><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mtext>lr</mml:mtext></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:munder><mml:mrow><mml:mtext>mad</mml:mtext></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:munder><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mo>log</mml:mo><mml:munderover><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mtext>gw</mml:mtext></mml:mrow></mml:munderover><mml:mo>−</mml:mo><mml:mo>log</mml:mo><mml:msub><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mtext>tr</mml:mtext></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mo>¯</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow></mml:mfenced><mml:mo>,</mml:mo></mml:math><graphic xlink:href="13059_2014_550_Article_Equ8.gif" position="anchor"/></alternatives></disp-formula></p>
      <p>where mad stands for the median absolute deviation, divided as usual by the scaling factor <italic>Φ</italic><sup>−1</sup>(3/4).</p>
      <p><bold>Three or less residuals degrees of freedom</bold> When there are three or less residual degrees of freedom (number of samples minus number of parameters to estimate), the estimation of the prior variance <inline-formula id="IEq29"><alternatives><tex-math id="M85">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
							$\sigma _{\text {d}}^{2}$
						\end{document}</tex-math><mml:math id="M86"><mml:msubsup><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mtext>d</mml:mtext></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2014_550_Article_IEq29.gif"/></alternatives></inline-formula> using the observed variance of logarithmic residuals <inline-formula id="IEq30"><alternatives><tex-math id="M87">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
							$s^{2}_{\text {lr}}$
						\end{document}</tex-math><mml:math id="M88"><mml:msubsup><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mtext>lr</mml:mtext></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2014_550_Article_IEq30.gif"/></alternatives></inline-formula> tends to underestimate <inline-formula id="IEq31"><alternatives><tex-math id="M89">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
							$\sigma _{\text {d}}^{2}$
						\end{document}</tex-math><mml:math id="M90"><mml:msubsup><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mtext>d</mml:mtext></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2014_550_Article_IEq31.gif"/></alternatives></inline-formula>. In this case, we instead estimate the prior variance through simulation. We match the distribution of logarithmic residuals to a density of simulated logarithmic residuals. These are the logarithm of <inline-formula id="IEq32"><alternatives><tex-math id="M91">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
							$\chi ^{2}_{m-p}$
						\end{document}</tex-math><mml:math id="M92"><mml:msubsup><mml:mrow><mml:mi>χ</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi><mml:mo>−</mml:mo><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2014_550_Article_IEq32.gif"/></alternatives></inline-formula>-distributed random variables added to <inline-formula id="IEq33"><alternatives><tex-math id="M93">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
							$N(0,\sigma _{\text {d}}^{2})$
						\end{document}</tex-math><mml:math id="M94"><mml:mi>N</mml:mi><mml:mo>(</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mtext>d</mml:mtext></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo>)</mml:mo></mml:math><inline-graphic xlink:href="13059_2014_550_Article_IEq33.gif"/></alternatives></inline-formula> random variables to account for the spread due to the prior. The simulated distribution is shifted by − log(<italic>m</italic>−<italic>p</italic>) to account for the scaling of the <italic>χ</italic><sup>2</sup> distribution. We repeat the simulation over a grid of values for <inline-formula id="IEq34"><alternatives><tex-math id="M95">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
							$\sigma _{\text {d}}^{2}$
						\end{document}</tex-math><mml:math id="M96"><mml:msubsup><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mtext>d</mml:mtext></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2014_550_Article_IEq34.gif"/></alternatives></inline-formula>, and select the value that minimizes the Kullback–Leibler divergence from the observed density of logarithmic residuals to the simulated density.</p>
      <p><bold>Final dispersion estimate</bold> We form a logarithmic posterior for the dispersion from the Cox–Reid adjusted logarithmic likelihood (<xref rid="Equ7" ref-type="">7</xref>) and the logarithmic prior (<xref rid="Equ5" ref-type="">5</xref>) and use its maximum (i.e., the MAP value) as the final estimate of the dispersion,
<disp-formula id="Equ9"><label>(9)</label><alternatives><tex-math id="M97">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
							 $$ \alpha_{i}^{\text{MAP}} = {\underset{\alpha}{\text{arg max}}}\, \left(\ell_{\text{CR}}\left(\alpha; \vec\mu_{\textit{i}\cdot}^{0}, \vec K_{\textit{i}\cdot}\right) + \Lambda_{i}(\alpha) \right),   $$ 
						\end{document}</tex-math><mml:math id="M98"><mml:msubsup><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mtext>MAP</mml:mtext></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:munder><mml:mrow><mml:mtext>arg max</mml:mtext></mml:mrow><mml:mrow><mml:mi>α</mml:mi></mml:mrow></mml:munder><mml:mspace width="0.3em"/><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msub><mml:mrow><mml:mi>ℓ</mml:mi></mml:mrow><mml:mrow><mml:mtext>CR</mml:mtext></mml:mrow></mml:msub><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mi>α</mml:mi><mml:mo>;</mml:mo><mml:msubsup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mo>→</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">i</mml:mtext><mml:mo>·</mml:mo></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>K</mml:mi></mml:mrow><mml:mo>→</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">i</mml:mtext><mml:mo>·</mml:mo></mml:mrow></mml:msub></mml:mrow></mml:mfenced><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>Λ</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mi>α</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mfenced><mml:mo>,</mml:mo></mml:math><graphic xlink:href="13059_2014_550_Article_Equ9.gif" position="anchor"/></alternatives></disp-formula></p>
      <p>where
<disp-formula id="Equg"><alternatives><tex-math id="M99">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
							 $$\Lambda_{i}(\alpha) = \frac{- \left(\log\alpha-\log\alpha_{\text{tr}}(\bar\mu_{i})\right)^{2}}{2 \sigma_{\text{d}}^{2}}, $$ 
						\end{document}</tex-math><mml:math id="M100"><mml:mrow><mml:msub><mml:mrow><mml:mi>Λ</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mi>α</mml:mi><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mo>−</mml:mo><mml:msup><mml:mrow><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mo>log</mml:mo><mml:mi>α</mml:mi><mml:mo>−</mml:mo><mml:mo>log</mml:mo><mml:msub><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mtext>tr</mml:mtext></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mo>¯</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:msubsup><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mtext>d</mml:mtext></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:mrow></mml:mfrac><mml:mo>,</mml:mo></mml:mrow></mml:math><graphic xlink:href="13059_2014_550_Article_Equg.gif" position="anchor"/></alternatives></disp-formula> is, up to an additive constant, the logarithm of the density of prior (<xref rid="Equ5" ref-type="">5</xref>). Again, a backtracking line search is used to perform the optimization.</p>
      <p><bold>Dispersion outliers</bold> For some genes, the gene-wise estimate <inline-formula id="IEq35"><alternatives><tex-math id="M101">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
							$\alpha ^{\text {gw}}_{i}$
						\end{document}</tex-math><mml:math id="M102"><mml:msubsup><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mtext>gw</mml:mtext></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2014_550_Article_IEq35.gif"/></alternatives></inline-formula> can be so far above the prior expectation <inline-formula id="IEq36"><alternatives><tex-math id="M103">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
							$\alpha _{\text {tr}}(\bar \mu _{i})$
						\end{document}</tex-math><mml:math id="M104"><mml:msub><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mtext>tr</mml:mtext></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mo>¯</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:math><inline-graphic xlink:href="13059_2014_550_Article_IEq36.gif"/></alternatives></inline-formula> that it would be unreasonable to assume that the prior is suitable for the gene. If the dispersion estimate for such genes were down-moderated toward the fitted trend, this might lead to false positives. Therefore, we use the heuristic of considering a gene as a dispersion outlier, if the residual from the trend fit is more than two standard deviations of logarithmic residuals, <italic>s</italic><sub>lr</sub> (see Equation (<xref rid="Equ8" ref-type="">8</xref>)), above the fit, i.e., if
<disp-formula id="Equh"><alternatives><tex-math id="M105">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
							 $$ \log \alpha_{i}^{\text{gw}} &gt; \log\alpha_{\text{tr}}(\bar\mu_{i}) + 2 s_{\text{lr}}. $$ \end{document}</tex-math><mml:math id="M106"><mml:mrow><mml:mo>log</mml:mo><mml:munderover><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mtext>gw</mml:mtext></mml:mrow></mml:munderover><mml:mo>&gt;</mml:mo><mml:mo>log</mml:mo><mml:msub><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mtext>tr</mml:mtext></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mo>¯</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo><mml:mo>+</mml:mo><mml:mn>2</mml:mn><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mtext>lr</mml:mtext></mml:mrow></mml:msub><mml:mi>.</mml:mi></mml:mrow></mml:math><graphic xlink:href="13059_2014_550_Article_Equh.gif" position="anchor"/></alternatives></disp-formula></p>
      <p>For such genes, the gene-wise estimate <inline-formula id="IEq37"><alternatives><tex-math id="M107">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
							$\alpha ^{\text {gw}}_{i}$
						\end{document}</tex-math><mml:math id="M108"><mml:msubsup><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mtext>gw</mml:mtext></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2014_550_Article_IEq37.gif"/></alternatives></inline-formula> is not shrunk toward the trended prior mean. Instead of the MAP value <inline-formula id="IEq38"><alternatives><tex-math id="M109">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
							$\alpha _{i}^{\text {MAP}}$
						\end{document}</tex-math><mml:math id="M110"><mml:msubsup><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mtext>MAP</mml:mtext></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2014_550_Article_IEq38.gif"/></alternatives></inline-formula>, we use the gene-wise estimate <inline-formula id="IEq39"><alternatives><tex-math id="M111">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
							$\alpha ^{\text {gw}}_{i}$
						\end{document}</tex-math><mml:math id="M112"><mml:msubsup><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mtext>gw</mml:mtext></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2014_550_Article_IEq39.gif"/></alternatives></inline-formula> as a final dispersion value in the subsequent steps. In addition, the iterative fitting procedure for the parametric dispersion trend described above avoids that such dispersion outliers influence the prior mean.</p>
    </sec>
    <sec id="Sec23">
      <title>Shrinkage estimation of logarithmic fold changes</title>
      <p>To incorporate empirical Bayes shrinkage of LFCs, we postulate a zero-centered normal prior for the coefficients <italic>β</italic><sub><italic>ir</italic></sub> of model (<xref rid="Equ2" ref-type="">2</xref>) that represent LFCs (i.e., typically, all coefficients except for the intercept <italic>β</italic><sub><italic>i</italic>0</sub>):
<disp-formula id="Equ10"><label>(10)</label><alternatives><tex-math id="M113">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
							 $$ \beta_{ir} \sim N\!\left(0, {\sigma_{r}^{2}} \right).   $$ 
						\end{document}</tex-math><mml:math id="M114"><mml:msub><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ir</mml:mtext></mml:mrow></mml:msub><mml:mo>∼</mml:mo><mml:mi>N</mml:mi><mml:mspace width="0.3em"/><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:mrow></mml:mfenced><mml:mi>.</mml:mi></mml:math><graphic xlink:href="13059_2014_550_Article_Equ10.gif" position="anchor"/></alternatives></disp-formula></p>
      <p>As was observed with differential expression analysis using microarrays, genes with low intensity values tend to suffer from a small signal-to-noise ratio. Alternative estimators can be found that are more stable than the standard calculation of fold change as the ratio of average observed values for each condition [<xref ref-type="bibr" rid="CR53">53</xref>-<xref ref-type="bibr" rid="CR55">55</xref>]. <italic>DESeq2</italic>’s approach can be seen as an extension of these approaches for stable estimation of gene-expression fold changes to count data.</p>
      <p><bold>Empirical prior estimate</bold> To obtain values for the empirical prior widths <italic>σ</italic><sub><italic>r</italic></sub> for the model coefficients, we again approximate a full empirical Bayes approach, as with the estimation of dispersion prior, though here we do not subtract the expected sampling variance from the observed variance of maximum likelihood estimates. The estimate of the LFC prior width is calculated as follows. We use the standard iteratively reweighted least-squares algorithm [<xref ref-type="bibr" rid="CR12">12</xref>] for each gene’s model, Equations (<xref rid="Equ1" ref-type="">1</xref>) and (<xref rid="Equ2" ref-type="">2</xref>), to get MLEs for the coefficients <inline-formula id="IEq40"><alternatives><tex-math id="M115">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
							$\beta _{\textit {ir}}^{\text {MLE}}$
						\end{document}</tex-math><mml:math id="M116"><mml:msubsup><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ir</mml:mtext></mml:mrow><mml:mrow><mml:mtext>MLE</mml:mtext></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2014_550_Article_IEq40.gif"/></alternatives></inline-formula>. We then fit, for each column <italic>r</italic> of the design matrix (except for the intercept), a zero-centered normal distribution to the empirical distribution of MLE fold change estimates <inline-formula id="IEq41"><alternatives><tex-math id="M117">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
							$\vec {\beta }^{\text {MLE}}_{r}$
						\end{document}</tex-math><mml:math id="M118"><mml:msubsup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mo>→</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mtext>MLE</mml:mtext></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2014_550_Article_IEq41.gif"/></alternatives></inline-formula>.</p>
      <p>To make the fit robust against outliers with very high absolute LFC values, we use quantile matching: the width <italic>σ</italic><sub><italic>r</italic></sub> is chosen such that the (1−<italic>p</italic>) empirical quantile of the absolute value of the observed LFCs, <inline-formula id="IEq42"><alternatives><tex-math id="M119">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
							$\vec {\beta }^{\text {MLE}}_{r}$
						\end{document}</tex-math><mml:math id="M120"><mml:msubsup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mo>→</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mtext>MLE</mml:mtext></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2014_550_Article_IEq42.gif"/></alternatives></inline-formula>, matches the (1−<italic>p</italic>/2) theoretical quantile of the prior, <inline-formula id="IEq43"><alternatives><tex-math id="M121">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
							$N(0,{\sigma _{r}^{2}})$
						\end{document}</tex-math><mml:math id="M122"><mml:mi>N</mml:mi><mml:mo>(</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo>)</mml:mo></mml:math><inline-graphic xlink:href="13059_2014_550_Article_IEq43.gif"/></alternatives></inline-formula>, where <italic>p</italic> is set by default to 0.05. If we write the theoretical upper quantile of a normal distribution as <italic>Q</italic><sub><italic>N</italic></sub>(1−<italic>p</italic>) and the empirical upper quantile of the MLE LFCs as <inline-formula id="IEq44"><alternatives><tex-math id="M123">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
							$Q_{|\beta _{r}|}(1 - p)$
						\end{document}</tex-math><mml:math id="M124"><mml:msub><mml:mrow><mml:mi>Q</mml:mi></mml:mrow><mml:mrow><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mo>|</mml:mo></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>p</mml:mi><mml:mo>)</mml:mo></mml:math><inline-graphic xlink:href="13059_2014_550_Article_IEq44.gif"/></alternatives></inline-formula>, then the prior width is calculated as:
<disp-formula id="Equi"><alternatives><tex-math id="M125">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
							 $$ \sigma_{r} = \frac{Q_{|\beta_{r}|}(1 - p)}{Q_{N}(1 - p/2)}. $$ 
						\end{document}</tex-math><mml:math id="M126"><mml:mrow><mml:msub><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi>Q</mml:mi></mml:mrow><mml:mrow><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mo>|</mml:mo></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>p</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>Q</mml:mi></mml:mrow><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>p</mml:mi><mml:mo>/</mml:mo><mml:mn>2</mml:mn><mml:mo>)</mml:mo></mml:mrow></mml:mfrac><mml:mi>.</mml:mi></mml:mrow></mml:math><graphic xlink:href="13059_2014_550_Article_Equi.gif" position="anchor"/></alternatives></disp-formula></p>
      <p>To ensure that the prior width <italic>σ</italic><sub><italic>r</italic></sub> will be independent of the choice of base level, the estimates from the quantile matching procedure are averaged for each factor over all possible contrasts of factor levels. When determining the empirical upper quantile, extreme LFC values (<inline-formula id="IEq45"><alternatives><tex-math id="M127">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
							$\left |\beta _{\textit {ir}}^{\text {MLE}}\right | &gt; \log (2) \, 10$\end{document}</tex-math><mml:math id="M128"><mml:mfenced close="|" open="|" separators=""><mml:mrow><mml:msubsup><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ir</mml:mtext></mml:mrow><mml:mrow><mml:mtext>MLE</mml:mtext></mml:mrow></mml:msubsup></mml:mrow></mml:mfenced><mml:mo>&gt;</mml:mo><mml:mo>log</mml:mo><mml:mo>(</mml:mo><mml:mn>2</mml:mn><mml:mo>)</mml:mo><mml:mspace width="0.3em"/><mml:mn>10</mml:mn></mml:math><inline-graphic xlink:href="13059_2014_550_Article_IEq45.gif"/></alternatives></inline-formula>, or 10 on the base 2 scale) are excluded.</p>
      <p><bold>Final estimate of logarithmic fold changes</bold> The logarithmic posterior for the vector, <inline-formula id="IEq46"><alternatives><tex-math id="M129">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
							$\vec \beta _{i}$
						\end{document}</tex-math><mml:math id="M130"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mo>→</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13059_2014_550_Article_IEq46.gif"/></alternatives></inline-formula>, of model coefficients <italic>β</italic><sub><italic>ir</italic></sub> for gene <italic>i</italic> is the sum of the logarithmic likelihood of the GLM (<xref rid="Equ2" ref-type="">2</xref>) and the logarithm of the prior density (<xref rid="Equ10" ref-type="">10</xref>), and its maximum yields the final MAP coefficient estimates:
<disp-formula id="Equj"><alternatives><tex-math id="M131">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
							 $$\vec\beta_{i} = {\underset{\vec\beta}{\text{arg max}}} \left(\sum_{j} \log f_{\text{NB}}\left(K_{ij};\mu_{j}(\vec\beta),\alpha_{i} \right) + \Lambda(\vec\beta) \right), $$ 
						\end{document}</tex-math><mml:math id="M132"><mml:mrow><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mo>→</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:munder><mml:mrow><mml:mtext>arg max</mml:mtext></mml:mrow><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mo>→</mml:mo></mml:mover></mml:mrow></mml:munder><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:munder><mml:mrow><mml:mo mathsize="big">∑</mml:mo></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:munder><mml:mo>log</mml:mo><mml:msub><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mtext>NB</mml:mtext></mml:mrow></mml:msub><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msub><mml:mrow><mml:mi>K</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ij</mml:mtext></mml:mrow></mml:msub><mml:mo>;</mml:mo><mml:msub><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mover accent="true"><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mo>→</mml:mo></mml:mover><mml:mo>)</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced><mml:mo>+</mml:mo><mml:mi>Λ</mml:mi><mml:mo>(</mml:mo><mml:mover accent="true"><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mo>→</mml:mo></mml:mover><mml:mo>)</mml:mo></mml:mrow></mml:mfenced><mml:mo>,</mml:mo></mml:mrow></mml:math><graphic xlink:href="13059_2014_550_Article_Equj.gif" position="anchor"/></alternatives></disp-formula> where
<disp-formula id="Equk"><alternatives><tex-math id="M133">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
							 $$\mu_{j}(\vec\beta) = s_{ij} e^{\sum_{r} x_{jr} \beta_{r}}, \quad \Lambda(\vec\beta) = \sum_{r} \frac{- {\beta_{r}^{2}}}{2 {\sigma_{r}^{2}}}, $$ 
						\end{document}</tex-math><mml:math id="M134"><mml:mrow><mml:msub><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mover accent="true"><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mo>→</mml:mo></mml:mover><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ij</mml:mtext></mml:mrow></mml:msub><mml:msup><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:munder><mml:mrow><mml:mo mathsize="big">∑</mml:mo></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:munder><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">jr</mml:mtext></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:mspace width="1em"/><mml:mi>Λ</mml:mi><mml:mo>(</mml:mo><mml:mover accent="true"><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mo>→</mml:mo></mml:mover><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:munder><mml:mrow><mml:mo mathsize="big">∑</mml:mo></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:munder><mml:mfrac><mml:mrow><mml:mo>−</mml:mo><mml:msubsup><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:msubsup><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:mrow></mml:mfrac><mml:mo>,</mml:mo></mml:mrow></mml:math><graphic xlink:href="13059_2014_550_Article_Equk.gif" position="anchor"/></alternatives></disp-formula> and <italic>α</italic><sub><italic>i</italic></sub> is the final dispersion estimate for gene <italic>i</italic>, i.e., <inline-formula id="IEq47"><alternatives><tex-math id="M135">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
							$\alpha _{i}=\alpha _{i}^{\text {MAP}}$
						\end{document}</tex-math><mml:math id="M136"><mml:msub><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msubsup><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mtext>MAP</mml:mtext></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2014_550_Article_IEq47.gif"/></alternatives></inline-formula>, except for dispersion outliers, where <inline-formula id="IEq48"><alternatives><tex-math id="M137">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
							$\alpha _{i}=\alpha _{i}^{\text {gw}}$
						\end{document}</tex-math><mml:math id="M138"><mml:msub><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msubsup><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mtext>gw</mml:mtext></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2014_550_Article_IEq48.gif"/></alternatives></inline-formula>.</p>
      <p>The term <italic>Λ</italic>(<italic>β</italic>), i.e., the logarithm of the density of the normal prior (up to an additive constant), can be read as a ridge penalty term, and therefore, we perform the optimization using the <italic>iteratively reweighted ridge regression algorithm</italic> [<xref ref-type="bibr" rid="CR56">56</xref>], also known as <italic>weighted updates</italic> [<xref ref-type="bibr" rid="CR57">57</xref>]. Specifically, the updates for a given gene are of the form
<disp-formula id="Equl"><alternatives><tex-math id="M139">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
							 $$ \vec\beta \leftarrow \left(X^{t} W X + \vec{\lambda} I\right)^{-1} X^{t} W \vec{z}, $$ 
						\end{document}</tex-math><mml:math id="M140"><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mo>→</mml:mo></mml:mover><mml:mo>←</mml:mo><mml:msup><mml:mrow><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msup><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msup><mml:mtext mathvariant="italic">WX</mml:mtext><mml:mo>+</mml:mo><mml:mover accent="true"><mml:mrow><mml:mi>λ</mml:mi></mml:mrow><mml:mo>→</mml:mo></mml:mover><mml:mi>I</mml:mi></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:msup><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msup><mml:mi>W</mml:mi><mml:mover accent="true"><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mo>→</mml:mo></mml:mover><mml:mo>,</mml:mo></mml:mrow></mml:math><graphic xlink:href="13059_2014_550_Article_Equl.gif" position="anchor"/></alternatives></disp-formula> with <inline-formula id="IEq49"><alternatives><tex-math id="M141">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
							$\lambda _{r} = 1/{\sigma _{r}^{2}}$
						\end{document}</tex-math><mml:math id="M142"><mml:msub><mml:mrow><mml:mi>λ</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:msubsup><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2014_550_Article_IEq49.gif"/></alternatives></inline-formula> and
<disp-formula id="Equm"><alternatives><tex-math id="M143">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
							 $$ z_{j} = \log \frac{\mu_{j}}{s_{j}} + \frac{K_{j} - \mu_{j}}{\mu_{j}}, $$ 
						\end{document}</tex-math><mml:math id="M144"><mml:mrow><mml:msub><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mo>log</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:mo>+</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi>K</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:mo>,</mml:mo></mml:mrow></mml:math><graphic xlink:href="13059_2014_550_Article_Equm.gif" position="anchor"/></alternatives></disp-formula> where the current fitted values <inline-formula id="IEq50"><alternatives><tex-math id="M145">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
							$\mu _{j} = s_{j} e^{\sum _{r} x_{\textit {jr}}\beta _{r}}$
						\end{document}</tex-math><mml:math id="M146"><mml:msub><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:msup><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:munder><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:munder><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">jr</mml:mtext></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msup></mml:math><inline-graphic xlink:href="13059_2014_550_Article_IEq50.gif"/></alternatives></inline-formula> are computed from the current estimates <inline-formula id="IEq51"><alternatives><tex-math id="M147">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
							$\vec \beta $
						\end{document}</tex-math><mml:math id="M148"><mml:mover accent="true"><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mo>→</mml:mo></mml:mover></mml:math><inline-graphic xlink:href="13059_2014_550_Article_IEq51.gif"/></alternatives></inline-formula> in each iteration.</p>
      <p><bold>Fisher information.</bold> The effect of the zero-centered normal prior can be understood as shrinking the MAP LFC estimates based on the amount of information the experiment provides for this coefficient, and we briefly elaborate on this here. Specifically, for a given gene <italic>i</italic>, the shrinkage for an LFC <italic>β</italic><sub><italic>ir</italic></sub> depends on the <italic>observed Fisher information</italic>, given by
<disp-formula id="Equn"><alternatives><tex-math id="M149">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
							 $$\mathcal{J}_{m}(\hat\beta_{ir}) = - \left[ \frac{\partial^{2}}{\partial \beta_{ir}^{2}} \ell\left(\vec\beta_{i} ; \vec{K_{i}}, \alpha_{i}\right) \right]_{\beta_{ir} = \hat\beta_{ir}}, $$ 
						\end{document}</tex-math><mml:math id="M150"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="script">J</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ir</mml:mtext></mml:mrow></mml:msub><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mfenced close="]" open="[" separators=""><mml:mrow><mml:mfrac><mml:mrow><mml:msup><mml:mrow><mml:mi>∂</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:mi>∂</mml:mi><mml:msubsup><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ir</mml:mtext></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:mrow></mml:mfrac><mml:mi>ℓ</mml:mi><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mo>→</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>;</mml:mo><mml:mover accent="true"><mml:mrow><mml:msub><mml:mrow><mml:mi>K</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>→</mml:mo></mml:mover><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ir</mml:mtext></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ir</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo>,</mml:mo></mml:mrow></mml:math><graphic xlink:href="13059_2014_550_Article_Equn.gif" position="anchor"/></alternatives></disp-formula> where <inline-formula id="IEq52"><alternatives><tex-math id="M151">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
							$\ell \left (\vec \beta _{i} ; \vec {K_{i}}, \alpha _{i}\right)$
						\end{document}</tex-math><mml:math id="M152"><mml:mi>ℓ</mml:mi><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mo>→</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>;</mml:mo><mml:mover accent="true"><mml:mrow><mml:msub><mml:mrow><mml:mi>K</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>→</mml:mo></mml:mover><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:math><inline-graphic xlink:href="13059_2014_550_Article_IEq52.gif"/></alternatives></inline-formula> is the logarithm of the likelihood, and partial derivatives are taken with respect to LFC <italic>β</italic><sub><italic>ir</italic></sub>. For a negative binomial GLM, the observed Fisher information, or peakedness of the logarithm of the profile likelihood, is influenced by a number of factors including the degrees of freedom, the estimated mean counts <italic>μ</italic><sub><italic>ij</italic></sub>, and the gene’s dispersion estimate <italic>α</italic><sub><italic>i</italic></sub>. The prior influences the MAP estimate when the density of the likelihood and the prior are multiplied to calculate the posterior. Genes with low estimated mean values <italic>μ</italic><sub><italic>ij</italic></sub> or high dispersion estimates <italic>α</italic><sub><italic>i</italic></sub> have flatter profile likelihoods, as do datasets with few residual degrees of freedom, and therefore in these cases the zero-centered prior pulls the MAP estimate from a high-uncertainty MLE closer toward zero.</p>
    </sec>
    <sec id="Sec24">
      <title>Wald test</title>
      <p>The Wald test compares the beta estimate <italic>β</italic><sub><italic>ir</italic></sub> divided by its estimated standard error SE(<italic>β</italic><sub><italic>ir</italic></sub>) to a standard normal distribution. The estimated standard errors are the square root of the diagonal elements of the estimated covariance matrix, <italic>Σ</italic><sub><italic>i</italic></sub>, for the coefficients, i.e., <inline-formula id="IEq53"><alternatives><tex-math id="M153">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
							$\operatorname {SE}(\beta _{\textit {ir}})=\sqrt {\Sigma _{i,rr}}$
						\end{document}</tex-math><mml:math id="M154"><mml:mo>SE</mml:mo><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ir</mml:mtext></mml:mrow></mml:msub><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:msqrt><mml:mrow><mml:msub><mml:mrow><mml:mi>Σ</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mtext mathvariant="italic">rr</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:msqrt></mml:math><inline-graphic xlink:href="13059_2014_550_Article_IEq53.gif"/></alternatives></inline-formula>. Contrasts of coefficients are tested similarly by forming a Wald statistics using (<xref rid="Equ3" ref-type="">3</xref>) and (<xref rid="Equ4" ref-type="">4</xref>). We use the following formula for the coefficient covariance matrix for a GLM with normal prior on coefficients [<xref ref-type="bibr" rid="CR56">56</xref>, <xref ref-type="bibr" rid="CR58">58</xref>]:
<disp-formula id="Equo"><alternatives><tex-math id="M155">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
							 $$\Sigma_{i} = \operatorname{Cov}(\vec{\beta}_{i}) = (X^{t} W X + \vec{\lambda} I)^{-1} (X^{t} W X) (X^{t} W X + \vec{\lambda} I)^{-1}. $$ 
						\end{document}</tex-math><mml:math id="M156"><mml:mrow><mml:mspace width="-14.0pt"/><mml:msub><mml:mrow><mml:mi>Σ</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mo>Cov</mml:mo><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mo>→</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:msup><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msup><mml:mtext mathvariant="italic">WX</mml:mtext><mml:mo>+</mml:mo><mml:mover accent="true"><mml:mrow><mml:mi>λ</mml:mi></mml:mrow><mml:mo>→</mml:mo></mml:mover><mml:mi>I</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mo>(</mml:mo><mml:msup><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msup><mml:mtext mathvariant="italic">WX</mml:mtext><mml:mo>)</mml:mo><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:msup><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msup><mml:mtext mathvariant="italic">WX</mml:mtext><mml:mo>+</mml:mo><mml:mover accent="true"><mml:mrow><mml:mi>λ</mml:mi></mml:mrow><mml:mo>→</mml:mo></mml:mover><mml:mi>I</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mi>.</mml:mi></mml:mrow></mml:math><graphic xlink:href="13059_2014_550_Article_Equo.gif" position="anchor"/></alternatives></disp-formula> The tail integrals of the standard normal distribution are multiplied by 2 to achieve a two-tailed test. The Wald test <italic>P</italic> values from the subset of genes that pass the independent filtering step are adjusted for multiple testing using the procedure of Benjamini and Hochberg [<xref ref-type="bibr" rid="CR21">21</xref>].</p>
    </sec>
    <sec id="Sec25">
      <title>Independent filtering</title>
      <p>Independent filtering does not compromise type-I error control as long as the distribution of the test statistic is marginally independent of the filter statistic <italic>under the null hypothesis</italic> [<xref ref-type="bibr" rid="CR22">22</xref>], and we argue in the following that this is the case in our application. The filter statistic in <italic>DESeq2</italic> is the mean of normalized counts for a gene, while the test statistic is <italic>p</italic>, the <italic>P</italic> value from the Wald test. We first consider the case where the size factors are equal and where the gene-wise dispersion estimates are used for each gene, i.e. without dispersion shrinkage. The distribution family for the negative binomial is parameterized by <italic>θ</italic>=(<italic>μ</italic>,<italic>α</italic>). Aside from discreteness of <italic>p</italic> due to low counts, for a given <italic>μ</italic>, the distribution of <italic>p</italic> is Uniform(0,1) under the null hypothesis, so <italic>p</italic> is an ancillary statistic. The sample mean of counts for gene <italic>i</italic>, <inline-formula id="IEq54"><alternatives><tex-math id="M157">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
							$\bar {K}_{i}$
						\end{document}</tex-math><mml:math id="M158"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>K</mml:mi></mml:mrow><mml:mo>¯</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13059_2014_550_Article_IEq54.gif"/></alternatives></inline-formula>, is boundedly complete sufficient for <italic>μ</italic>. Then from Basu’s theorem, <inline-formula id="IEq55"><alternatives><tex-math id="M159">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
							$\bar {K}_{i}$
						\end{document}</tex-math><mml:math id="M160"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>K</mml:mi></mml:mrow><mml:mo>¯</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13059_2014_550_Article_IEq55.gif"/></alternatives></inline-formula> and <italic>p</italic> are independent.</p>
      <p>While for very low counts, one can observe discreteness and non-uniformity of <italic>p</italic> under the null hypothesis, <italic>DESeq2</italic> does not use the distribution of <italic>p</italic> in its estimation procedure – for example, <italic>DESeq2</italic> does not estimate the proportion of null genes using the distribution of <italic>p</italic> – so this kind of dependence of <italic>p</italic> on <italic>μ</italic> does not lead to increased type-I error.</p>
      <p>If the size factors are not equal across samples, but not correlated with condition, conditioning on the mean of <italic>normalized</italic> counts should also provide uniformly distributed <italic>p</italic> as with conditioning on the mean of counts, <inline-formula id="IEq56"><alternatives><tex-math id="M161">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
							$\bar {K}_{i}$
						\end{document}</tex-math><mml:math id="M162"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>K</mml:mi></mml:mrow><mml:mo>¯</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13059_2014_550_Article_IEq56.gif"/></alternatives></inline-formula>. We may consider a pathological case where the size factors are perfectly confounded with condition, in which case, even under the null hypothesis, genes with low mean count would have non-uniform distribution of <italic>p</italic>, as one condition could have positive counts and the other condition often zero counts. This could lead to non-uniformity of <italic>p</italic> under the null hypothesis; however, such a pathological case would pose problems for many statistical tests of differences in mean.</p>
      <p>We used simulation to demonstrate that the independence of the null distribution of the test statistic from the filter statistic still holds for dispersion shrinkage. Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S26 displays marginal null distributions of <italic>p</italic> across the range of mean normalized counts. Despite spikes in the distribution for the genes with the lowest mean counts due to discreteness of the data, these densities were nearly uniform across the range of average expression strength.</p>
    </sec>
    <sec id="Sec26">
      <title>Composite null hypotheses</title>
      <p><italic>DESeq2</italic> offers tests for composite null hypotheses of the form <inline-formula id="IEq57"><alternatives><tex-math id="M163">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
							$\mathcal {H}_{0}: |\beta _{\textit {ir}}| \le \theta $
						\end{document}</tex-math><mml:math id="M164"><mml:msub><mml:mrow><mml:mi mathvariant="script">ℋ</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>:</mml:mo><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ir</mml:mtext></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:mo>≤</mml:mo><mml:mi>θ</mml:mi></mml:math><inline-graphic xlink:href="13059_2014_550_Article_IEq57.gif"/></alternatives></inline-formula> to find genes whose LFC significantly exceeds a threshold <italic>θ</italic>&gt;0. The composite null hypothesis is replaced by two simple null hypotheses: <inline-formula id="IEq58"><alternatives><tex-math id="M165">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
							$\mathcal {H}_{0a}: \beta _{\textit {ir}} = \theta $
						\end{document}</tex-math><mml:math id="M166"><mml:msub><mml:mrow><mml:mi mathvariant="script">ℋ</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn><mml:mi>a</mml:mi></mml:mrow></mml:msub><mml:mo>:</mml:mo><mml:msub><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ir</mml:mtext></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>θ</mml:mi></mml:math><inline-graphic xlink:href="13059_2014_550_Article_IEq58.gif"/></alternatives></inline-formula> and <inline-formula id="IEq59"><alternatives><tex-math id="M167">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
							$\mathcal {H}_{0b}: \beta _{\textit {ir}} = -\theta $
						\end{document}</tex-math><mml:math id="M168"><mml:msub><mml:mrow><mml:mi mathvariant="script">ℋ</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn><mml:mi>b</mml:mi></mml:mrow></mml:msub><mml:mo>:</mml:mo><mml:msub><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ir</mml:mtext></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:mi>θ</mml:mi></mml:math><inline-graphic xlink:href="13059_2014_550_Article_IEq59.gif"/></alternatives></inline-formula>. Two-tailed <italic>P</italic> values are generated by integrating a normal distribution centered on <italic>θ</italic> with standard deviation SE(<italic>β</italic><sub><italic>ir</italic></sub>) from |<italic>β</italic><sub><italic>ir</italic></sub>| toward <italic>∞</italic>. The value of the integral is then multiplied by 2 and thresholded at 1. This procedure controls type-I error even when <italic>β</italic><sub><italic>ir</italic></sub>=±<italic>θ</italic>, and is equivalent to the standard <italic>DESeq2</italic><italic>P</italic> value when <italic>θ</italic>=0.</p>
      <p>Conversely, when searching for genes whose absolute LFC is significantly below a threshold, i.e., when testing the null hypothesis <inline-formula id="IEq60"><alternatives><tex-math id="M169">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
							$\mathcal {H}_{0}: |\beta _{\textit {ir}}| \ge \theta $
						\end{document}</tex-math><mml:math id="M170"><mml:msub><mml:mrow><mml:mi mathvariant="script">ℋ</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>:</mml:mo><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ir</mml:mtext></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:mo>≥</mml:mo><mml:mi>θ</mml:mi></mml:math><inline-graphic xlink:href="13059_2014_550_Article_IEq60.gif"/></alternatives></inline-formula>, the <italic>P</italic> value is constructed as the maximum of two one-sided tests of the simple null hypotheses: <inline-formula id="IEq61"><alternatives><tex-math id="M171">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
							$\mathcal {H}_{0a}: \beta _{\textit {ir}} = \theta $
						\end{document}</tex-math><mml:math id="M172"><mml:msub><mml:mrow><mml:mi mathvariant="script">ℋ</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn><mml:mi>a</mml:mi></mml:mrow></mml:msub><mml:mo>:</mml:mo><mml:msub><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ir</mml:mtext></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>θ</mml:mi></mml:math><inline-graphic xlink:href="13059_2014_550_Article_IEq61.gif"/></alternatives></inline-formula> and <inline-formula id="IEq62"><alternatives><tex-math id="M173">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
							$\mathcal {H}_{0b}: \beta _{\textit {ir}} = -\theta $
						\end{document}</tex-math><mml:math id="M174"><mml:msub><mml:mrow><mml:mi mathvariant="script">ℋ</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn><mml:mi>b</mml:mi></mml:mrow></mml:msub><mml:mo>:</mml:mo><mml:msub><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ir</mml:mtext></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:mi>θ</mml:mi></mml:math><inline-graphic xlink:href="13059_2014_550_Article_IEq62.gif"/></alternatives></inline-formula>. The one-sided <italic>P</italic> values are generated by integrating a normal distribution centered on <italic>θ</italic> with standard deviation SE(<italic>β</italic><sub><italic>ir</italic></sub>) from <italic>β</italic><sub><italic>ir</italic></sub> toward −<italic>∞</italic>, and integrating a normal distribution centered on −<italic>θ</italic> with standard deviation SE(<italic>β</italic><sub><italic>ir</italic></sub>) from <italic>β</italic><sub><italic>ir</italic></sub> toward <italic>∞</italic>.</p>
      <p>Note that while a zero-centered prior on LFCs is consistent with testing the null hypothesis of small LFCs, it should not be used when testing the null hypothesis of large LFCs, because the prior would then favor the alternative hypothesis. <italic>DESeq2</italic> requires that no prior has been used when testing the null hypothesis of large LFCs, so that the data alone must provide evidence against the null hypothesis.</p>
    </sec>
    <sec id="Sec27">
      <title>Interactions</title>
      <p>Two exceptions to the default <italic>DESeq2</italic> LFC estimation steps are used for experimental designs with interaction terms. First, when any interaction terms are included in the design, the LFC prior width for main effect terms is not estimated from the data, but set to a wide value (<inline-formula id="IEq63"><alternatives><tex-math id="M175">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
							${\sigma ^{2}_{r}} = (\log (2))^{2} \, 1000$
						\end{document}</tex-math><mml:math id="M176"><mml:msubsup><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mo>log</mml:mo><mml:mo>(</mml:mo><mml:mn>2</mml:mn><mml:mo>)</mml:mo><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mspace width="0.3em"/><mml:mn>1000</mml:mn></mml:math><inline-graphic xlink:href="13059_2014_550_Article_IEq63.gif"/></alternatives></inline-formula>, or 1000 on the base 2 scale). This ensures that shrinkage of main effect terms will not result in false positive calls of significance for interactions. Second, when interaction terms are included and all factors have two levels, then standard design matrices are used rather than expanded model matrices, such that only a single term is used to test the null hypothesis that a combination of two effects is merely additive in the logarithmic scale.</p>
    </sec>
    <sec id="Sec28">
      <title>Regularized logarithm</title>
      <p>The rlog transformation is calculated as follows. The experimental design matrix <italic>X</italic> is substituted with a design matrix with an indicator variable for every sample in addition to an intercept column. A model as described in Equations (<xref rid="Equ1" ref-type="">1</xref>) and (<xref rid="Equ2" ref-type="">2</xref>) is fit with a zero-centered normal prior on the non-intercept terms and using the fitted dispersion values <inline-formula id="IEq64"><alternatives><tex-math id="M177">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
							$\alpha _{\text {tr}}(\bar \mu)$
						\end{document}</tex-math><mml:math id="M178"><mml:msub><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mtext>tr</mml:mtext></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mover accent="true"><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mo>¯</mml:mo></mml:mover><mml:mo>)</mml:mo></mml:math><inline-graphic xlink:href="13059_2014_550_Article_IEq64.gif"/></alternatives></inline-formula>, which capture the overall variance-mean dependence of the dataset. The true experimental design matrix <italic>X</italic> is then only used in estimating the variance-mean trend over all genes. For unsupervised analyses, for instance sample quality assessment, it is desirable that the experimental design has no influence on the transformation, and hence <italic>DESeq2</italic> by default ignores the design matrix and re-estimates the dispersions treating all samples as replicates, i.e., it uses <italic>blind</italic> dispersion estimation. The rlog-transformed values are the fitted values,
<disp-formula id="Equp"><alternatives><tex-math id="M179">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
							 $$ \text{rlog}\left(K_{ij}\right) \equiv \log_{2} q_{ij} = \beta_{i0} + \beta_{ij}, $$ 
						\end{document}</tex-math><mml:math id="M180"><mml:mrow><mml:mtext>rlog</mml:mtext><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msub><mml:mrow><mml:mi>K</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ij</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:mfenced><mml:mo>≡</mml:mo><mml:munder><mml:mrow><mml:mo>log</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:munder><mml:msub><mml:mrow><mml:mi>q</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ij</mml:mtext></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ij</mml:mtext></mml:mrow></mml:msub><mml:mo>,</mml:mo></mml:mrow></mml:math><graphic xlink:href="13059_2014_550_Article_Equp.gif" position="anchor"/></alternatives></disp-formula> where <italic>β</italic><sub><italic>ij</italic></sub> is the shrunken LFC on the base 2 scale for the <italic>j</italic>th sample. The variance of the prior is set using a similar approach as taken with differential expression, by matching a zero-centered normal distribution to observed LFCs. First a matrix of LFCs is calculated by taking the logarithm (base 2) of the normalized counts plus a pseudocount of <inline-formula id="IEq65"><alternatives><tex-math id="M181">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
							$\frac {1}{2}$
						\end{document}</tex-math><mml:math id="M182"><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:mfrac></mml:math><inline-graphic xlink:href="13059_2014_550_Article_IEq65.gif"/></alternatives></inline-formula> for each sample divided by the mean of normalized counts plus a pseudocount of <inline-formula id="IEq66"><alternatives><tex-math id="M183">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
							$\frac {1}{2}$
						\end{document}</tex-math><mml:math id="M184"><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:mfrac></mml:math><inline-graphic xlink:href="13059_2014_550_Article_IEq66.gif"/></alternatives></inline-formula>. The pseudocount of <inline-formula id="IEq67"><alternatives><tex-math id="M185">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
							$\frac {1}{2}$
						\end{document}</tex-math><mml:math id="M186"><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:mfrac></mml:math><inline-graphic xlink:href="13059_2014_550_Article_IEq67.gif"/></alternatives></inline-formula> allows for calculation of the logarithmic ratio for all genes, and has little effect on the estimate of the variance of the prior or the final rlog transformation. This matrix of LFCs then represents the common-scale logarithmic ratio of each sample to the fitted value using only an intercept. The prior variance is found by matching the 97.5% quantile of a zero-centered normal distribution to the 95% quantile of the absolute values in the LFC matrix.</p>
    </sec>
    <sec id="Sec29">
      <title>Cook’s distance for outlier detection</title>
      <p>The MLE of <inline-formula id="IEq68"><alternatives><tex-math id="M187">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
							$\vec {\beta }_{i}$
						\end{document}</tex-math><mml:math id="M188"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mo>→</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13059_2014_550_Article_IEq68.gif"/></alternatives></inline-formula> is used for calculating Cook’s distance. Considering a gene <italic>i</italic> and sample <italic>j</italic>, Cook’s distance for GLMs is given by [<xref ref-type="bibr" rid="CR59">59</xref>]:
<disp-formula id="Equq"><alternatives><tex-math id="M189">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
							 $$ D_{ij} = \frac{R_{ij}^{2}}{\tau p} \frac{h_{jj}}{(1 - h_{jj})^{2}}, $$ 
						\end{document}</tex-math><mml:math id="M190"><mml:mrow><mml:msub><mml:mrow><mml:mi>D</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ij</mml:mtext></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msubsup><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ij</mml:mtext></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:mrow><mml:mrow><mml:mi>τp</mml:mi></mml:mrow></mml:mfrac><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi>h</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">jj</mml:mtext></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi>h</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">jj</mml:mtext></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mfrac><mml:mo>,</mml:mo></mml:mrow></mml:math><graphic xlink:href="13059_2014_550_Article_Equq.gif" position="anchor"/></alternatives></disp-formula> where <italic>R</italic><sub><italic>ij</italic></sub> is the Pearson residual of sample <italic>j</italic>, <italic>τ</italic> is an overdispersion parameter (in the negative binomial GLM, <italic>τ</italic> is set to 1), <italic>p</italic> is the number of parameters including the intercept, and <italic>h</italic><sub><italic>jj</italic></sub> is the <italic>j</italic>th diagonal element of the hat matrix <italic>H</italic>:
<disp-formula id="Equr"><alternatives><tex-math id="M191">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
							 $$ H = W^{1/2} X (X^{t} W X)^{-1} X^{t} W^{1/2}. $$ 
						\end{document}</tex-math><mml:math id="M192"><mml:mrow><mml:mi>H</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mi>W</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mi>X</mml:mi><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:msup><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msup><mml:mtext mathvariant="italic">WX</mml:mtext><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:msup><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msup><mml:msup><mml:mrow><mml:mi>W</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mi>.</mml:mi></mml:mrow></mml:math><graphic xlink:href="13059_2014_550_Article_Equr.gif" position="anchor"/></alternatives></disp-formula></p>
      <p>Pearson residuals <italic>R</italic><sub><italic>ij</italic></sub> are calculated as
<disp-formula id="Equs"><alternatives><tex-math id="M193">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
							 $$ R_{ij} = \frac{(K_{ij} - \mu_{ij})}{\sqrt{V(\mu_{ij})}}, $$ 
						\end{document}</tex-math><mml:math id="M194"><mml:mrow><mml:msub><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ij</mml:mtext></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>K</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ij</mml:mtext></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ij</mml:mtext></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:msqrt><mml:mrow><mml:mi>V</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ij</mml:mtext></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow></mml:msqrt></mml:mrow></mml:mfrac><mml:mo>,</mml:mo></mml:mrow></mml:math><graphic xlink:href="13059_2014_550_Article_Equs.gif" position="anchor"/></alternatives></disp-formula> where <italic>μ</italic><sub><italic>ij</italic></sub> is estimated by the negative binomial GLM without the LFC prior, and using the variance function <italic>V</italic>(<italic>μ</italic>)=<italic>μ</italic>+<italic>α</italic><italic>μ</italic><sup>2</sup>. A method-of-moments estimate <inline-formula id="IEq69"><alternatives><tex-math id="M195">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
							$\alpha _{i}^{\text {rob}}$
						\end{document}</tex-math><mml:math id="M196"><mml:msubsup><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mtext>rob</mml:mtext></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2014_550_Article_IEq69.gif"/></alternatives></inline-formula>, using a robust estimator of variance <inline-formula id="IEq70"><alternatives><tex-math id="M197">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
							$s_{i,\text {rob}}^{2}$
						\end{document}</tex-math><mml:math id="M198"><mml:msubsup><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mtext>rob</mml:mtext></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2014_550_Article_IEq70.gif"/></alternatives></inline-formula> to provide robustness against outliers, is used here:
<disp-formula id="Equt"><alternatives><tex-math id="M199">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
							 $$\alpha_{i}^{\text{rob}} = \operatorname{max} \left(\frac{s_{i,\text{rob}}^{2} - \bar\mu_{i}}{{\bar\mu_{i}^{2}}}, 0 \right). $$ 
						\end{document}</tex-math><mml:math id="M200"><mml:mrow><mml:msubsup><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mtext>rob</mml:mtext></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mo>max</mml:mo><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mfrac><mml:mrow><mml:munderover><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mtext>rob</mml:mtext></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:munderover><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mo>¯</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:munderover><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mo>¯</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:munderover></mml:mrow></mml:mfrac><mml:mo>,</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:mfenced><mml:mi>.</mml:mi></mml:mrow></mml:math><graphic xlink:href="13059_2014_550_Article_Equt.gif" position="anchor"/></alternatives></disp-formula></p>
    </sec>
    <sec id="Sec30">
      <title>R/Bioconductor package</title>
      <p><italic>DESeq2</italic> is implemented as a package for the R statistical environment and is available [<xref ref-type="bibr" rid="CR10">10</xref>] as part of the Bioconductor project [<xref ref-type="bibr" rid="CR11">11</xref>]. The count matrix and metadata, including the gene model and sample information, are stored in an S4 class derived from the <italic>SummarizedExperiment</italic> class of the <italic>GenomicRanges</italic> package [<xref ref-type="bibr" rid="CR60">60</xref>]. <italic>SummarizedExperiment</italic> objects containing count matrices can be easily generated using the <italic>summarizeOverlaps</italic> function of the <italic>GenomicAlignments</italic> package [<xref ref-type="bibr" rid="CR61">61</xref>]. This workflow automatically stores the gene model as metadata and additionally other information such as the genome and gene annotation versions. Other methods to obtain count matrices include the <italic>htseq-count</italic> script [<xref ref-type="bibr" rid="CR62">62</xref>] and the Bioconductor packages <italic>easyRNASeq</italic> [<xref ref-type="bibr" rid="CR63">63</xref>] and <italic>featureCount</italic> [<xref ref-type="bibr" rid="CR64">64</xref>].</p>
      <p>The <italic>DESeq2</italic> package comes with a detailed vignette, which works through a number of example differential expression analyses on real datasets, and the use of the rlog transformation for quality assessment and visualization. A single function, called <italic>DESeq</italic>, is used to run the default analysis, while lower-level functions are also available for advanced users.</p>
    </sec>
    <sec id="Sec31">
      <title>Read alignment for the Bottomly <italic>et al.</italic> and Pickrell <italic>et al.</italic> datasets</title>
      <p>Reads were aligned using the TopHat2 aligner [<xref ref-type="bibr" rid="CR65">65</xref>], and assigned to genes using the <italic>summarizeOverlaps</italic> function of the <italic>GenomicRanges</italic> package [<xref ref-type="bibr" rid="CR60">60</xref>]. The sequence read archive fastq files of the Pickrell <italic>et al.</italic> [<xref ref-type="bibr" rid="CR17">17</xref>] dataset (accession number [SRA:SRP001540]) were aligned to the <italic>Homo sapiens</italic> reference sequence GRCh37 downloaded in March 2013 from Illumina iGenomes. Reads were counted in the genes defined by the Ensembl GTF file, release 70, contained in the Illumina iGenome. The sequence read archive fastq files of the Bottomly <italic>et al.</italic> [<xref ref-type="bibr" rid="CR16">16</xref>] dataset (accession number [SRA:SRP004777]) were aligned to the <italic>Mus musculus</italic> reference sequence NCBIM37 downloaded in March 2013 from Illumina iGenomes. Reads were counted in the genes defined by the Ensembl GTF file, release 66, contained in the Illumina iGenome.</p>
    </sec>
    <sec id="Sec32">
      <title>Reproducible code</title>
      <p>Sweave vignettes for reproducing all figures and tables in this paper, including data objects for the experiments mentioned, and code for aligning reads and for benchmarking, can be found in a package <italic>DESeq2paper</italic> [<xref ref-type="bibr" rid="CR66">66</xref>].</p>
    </sec>
  </sec>
</body>
<back>
  <app-group>
    <app id="App1">
      <sec id="Sec33">
        <title>Additional file</title>
        <p>
          <media position="anchor" xlink:href="13059_2014_550_MOESM1_ESM.pdf" id="MOESM1">
            <label>Additional file 1</label>
            <caption>
              <p>
                <bold>Supplementary methods, tables and figures.</bold>
              </p>
            </caption>
          </media>
        </p>
      </sec>
    </app>
  </app-group>
  <glossary>
    <title>Abbreviations</title>
    <def-list>
      <def-list>
        <def-item>
          <term>FDR</term>
          <def>
            <p>False discovery rate</p>
          </def>
        </def-item>
        <def-item>
          <term>GLM</term>
          <def>
            <p>Generalized linear model</p>
          </def>
        </def-item>
        <def-item>
          <term>HTS</term>
          <def>
            <p>High-throughput sequencing</p>
          </def>
        </def-item>
        <def-item>
          <term>LFC</term>
          <def>
            <p>Logarithmic fold change</p>
          </def>
        </def-item>
        <def-item>
          <term>MAP</term>
          <def>
            <p>Maximum <italic>a posteriori</italic></p>
          </def>
        </def-item>
        <def-item>
          <term>MLE</term>
          <def>
            <p>Maximum-likelihood estimate</p>
          </def>
        </def-item>
        <def-item>
          <term>RNA-seq</term>
          <def>
            <p>RNA sequencing</p>
          </def>
        </def-item>
        <def-item>
          <term>VST</term>
          <def>
            <p>Variance-stabilizing transformation</p>
          </def>
        </def-item>
      </def-list>
    </def-list>
  </glossary>
  <fn-group>
    <fn>
      <p>
        <bold>Competing interests</bold>
      </p>
      <p>The authors declare that they have no competing interests.</p>
    </fn>
    <fn>
      <p>
        <bold>Authors’ contributions</bold>
      </p>
      <p>All authors developed the method and wrote the manuscript. MIL implemented the method and performed the analyses. All authors read and approved the final manuscript.</p>
    </fn>
  </fn-group>
  <ack>
    <title>Acknowledgements</title>
    <p>The authors thank all users of DESeq and DESeq2 who provided valuable feedback. We thank Judith Zaugg for helpful comments on the manuscript. MIL acknowledges funding via a stipend from the International Max Planck Research School for Computational Biology and Scientific Computing and a grant from the National Institutes of Health (5T32CA009337-33). WH and SA acknowledge funding from the European Union’s 7th Framework Programme (Health) via Project <italic>Radiant</italic>. We thank an anonymous reviewer for raising the question of estimation biases in the dispersion-mean trend fitting.</p>
  </ack>
  <ref-list id="Bib1">
    <title>References</title>
    <ref id="CR1">
      <label>1</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lönnstedt</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Speed</surname>
            <given-names>T</given-names>
          </name>
        </person-group>
        <article-title>
          <bold>Replicated microarray data</bold>
        </article-title>
        <source>Stat Sinica</source>
        <year>2002</year>
        <volume>12</volume>
        <fpage>31</fpage>
        <lpage>46</lpage>
      </element-citation>
    </ref>
    <ref id="CR2">
      <label>2</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Robinson</surname>
            <given-names>MD</given-names>
          </name>
          <name>
            <surname>Smyth</surname>
            <given-names>GK</given-names>
          </name>
        </person-group>
        <article-title>
          <bold>Moderated statistical tests for assessing differences in tag abundance</bold>
        </article-title>
        <source>Bioinformatics</source>
        <year>2007</year>
        <volume>23</volume>
        <fpage>2881</fpage>
        <lpage>2887</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btm453</pub-id>
        <?supplied-pmid 17881408?>
        <pub-id pub-id-type="pmid">17881408</pub-id>
      </element-citation>
    </ref>
    <ref id="CR3">
      <label>3</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>McCarthy</surname>
            <given-names>DJ</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Smyth</surname>
            <given-names>GK</given-names>
          </name>
        </person-group>
        <article-title>
          <bold>Differential expression analysis of multifactor RNA-seq experiments with respect to biological variation</bold>
        </article-title>
        <source>Nucleic Acids Res</source>
        <year>2012</year>
        <volume>40</volume>
        <fpage>4288</fpage>
        <lpage>4297</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/gks042</pub-id>
        <?supplied-pmid 22287627?>
        <pub-id pub-id-type="pmid">22287627</pub-id>
      </element-citation>
    </ref>
    <ref id="CR4">
      <label>4</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Anders</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Huber</surname>
            <given-names>W</given-names>
          </name>
        </person-group>
        <article-title>
          <bold>Differential expression analysis for sequence count data</bold>
        </article-title>
        <source>Genome Biol</source>
        <year>2010</year>
        <volume>11</volume>
        <fpage>106</fpage>
        <pub-id pub-id-type="doi">10.1186/gb-2010-11-10-r106</pub-id>
        <pub-id pub-id-type="pmid">20236492</pub-id>
      </element-citation>
    </ref>
    <ref id="CR5">
      <label>5</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zhou</surname>
            <given-names>Y-H</given-names>
          </name>
          <name>
            <surname>Xia</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Wright</surname>
            <given-names>FA</given-names>
          </name>
        </person-group>
        <article-title>
          <bold>A powerful and flexible approach to the analysis of RNA sequence count data</bold>
        </article-title>
        <source>Bioinformatics</source>
        <year>2011</year>
        <volume>27</volume>
        <fpage>2672</fpage>
        <lpage>2678</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btr449</pub-id>
        <?supplied-pmid 21810900?>
        <pub-id pub-id-type="pmid">21810900</pub-id>
      </element-citation>
    </ref>
    <ref id="CR6">
      <label>6</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wu</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Wu</surname>
            <given-names>Z</given-names>
          </name>
        </person-group>
        <article-title>
          <bold>A new shrinkage estimator for dispersion improves differential expression detection in RNA-seq data</bold>
        </article-title>
        <source>Biostatistics</source>
        <year>2013</year>
        <volume>14</volume>
        <fpage>232</fpage>
        <lpage>243</lpage>
        <pub-id pub-id-type="doi">10.1093/biostatistics/kxs033</pub-id>
        <?supplied-pmid 23001152?>
        <pub-id pub-id-type="pmid">23001152</pub-id>
      </element-citation>
    </ref>
    <ref id="CR7">
      <label>7</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hardcastle</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Kelly</surname>
            <given-names>K</given-names>
          </name>
        </person-group>
        <article-title>
          <bold>baySeq: empirical Bayesian methods for identifying differential expression in sequence count data</bold>
        </article-title>
        <source>BMC Bioinformatics</source>
        <year>2010</year>
        <volume>11</volume>
        <fpage>422</fpage>
        <pub-id pub-id-type="doi">10.1186/1471-2105-11-422</pub-id>
        <?supplied-pmid 20698981?>
        <pub-id pub-id-type="pmid">20698981</pub-id>
      </element-citation>
    </ref>
    <ref id="CR8">
      <label>8</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Van De Wiel</surname>
            <given-names>MA</given-names>
          </name>
          <name>
            <surname>Leday</surname>
            <given-names>GGR</given-names>
          </name>
          <name>
            <surname>Pardo</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Rue</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Van Der Vaart</surname>
            <given-names>AW</given-names>
          </name>
          <name>
            <surname>Van Wieringen</surname>
            <given-names>WN</given-names>
          </name>
        </person-group>
        <article-title>
          <bold>Bayesian analysis of RNA sequencing data by estimating multiple shrinkage priors</bold>
        </article-title>
        <source>Biostatistics</source>
        <year>2013</year>
        <volume>14</volume>
        <fpage>113</fpage>
        <lpage>128</lpage>
        <pub-id pub-id-type="doi">10.1093/biostatistics/kxs031</pub-id>
        <?supplied-pmid 22988280?>
        <pub-id pub-id-type="pmid">22988280</pub-id>
      </element-citation>
    </ref>
    <ref id="CR9">
      <label>9</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Boer</surname>
            <given-names>JM</given-names>
          </name>
          <name>
            <surname>Huber</surname>
            <given-names>WK</given-names>
          </name>
          <name>
            <surname>Sültmann</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Wilmer</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>von Heydebreck</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Haas</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Korn</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Gunawan</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Vente</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Füzesi</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Vingron</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Poustka</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>
          <bold>Identification and classification of differentially expressed genes in renal cell carcinoma by expression profiling on a global human 31,500-element cDNA array</bold>
        </article-title>
        <source>Genome Res</source>
        <year>2001</year>
        <volume>11</volume>
        <fpage>1861</fpage>
        <lpage>1870</lpage>
        <?supplied-pmid 11691851?>
        <pub-id pub-id-type="pmid">11691851</pub-id>
      </element-citation>
    </ref>
    <ref id="CR10">
      <label>10</label>
      <mixed-citation publication-type="other"><bold>DESeq2</bold>. [http://www.bioconductor.org/packages/release/bioc/html/DESeq2.html]</mixed-citation>
    </ref>
    <ref id="CR11">
      <label>11</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Gentleman</surname>
            <given-names>RC</given-names>
          </name>
          <name>
            <surname>Carey</surname>
            <given-names>VJ</given-names>
          </name>
          <name>
            <surname>Bates</surname>
            <given-names>DM</given-names>
          </name>
          <name>
            <surname>Bolstad</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Dettling</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Dudoit</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Ellis</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Gautier</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Ge</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Gentry</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Hornik</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Hothorn</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Huber</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Iacus</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Irizarry</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Leisch</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Maechler</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Rossini</surname>
            <given-names>AJ</given-names>
          </name>
          <name>
            <surname>Sawitzki</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Smith</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Smyth</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Tierney</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Yang</surname>
            <given-names>JY</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>
          <bold>Bioconductor: open software development for computational biology and bioinformatics</bold>
        </article-title>
        <source>Genome Biol</source>
        <year>2004</year>
        <volume>5</volume>
        <fpage>R80</fpage>
        <pub-id pub-id-type="doi">10.1186/gb-2004-5-10-r80</pub-id>
        <?supplied-pmid 15461798?>
        <pub-id pub-id-type="pmid">15461798</pub-id>
      </element-citation>
    </ref>
    <ref id="CR12">
      <label>12</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>McCullagh</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Nelder</surname>
            <given-names>JA</given-names>
          </name>
        </person-group>
        <article-title>
          <bold>Generalized linear models</bold>
        </article-title>
        <source>
          <italic>Monographs on Statistics &amp; Applied Probability</italic>
        </source>
        <year>1989</year>
        <publisher-loc>London, UK</publisher-loc>
        <publisher-name>Chapman &amp; Hall/CRC</publisher-name>
      </element-citation>
    </ref>
    <ref id="CR13">
      <label>13</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hansen</surname>
            <given-names>KD</given-names>
          </name>
          <name>
            <surname>Irizarry</surname>
            <given-names>RA</given-names>
          </name>
          <name>
            <surname>Wu</surname>
            <given-names>Z</given-names>
          </name>
        </person-group>
        <article-title>
          <bold>Removing technical variability in RNA-seq data using conditional quantile normalization</bold>
        </article-title>
        <source>Biostatistics</source>
        <year>2012</year>
        <volume>13</volume>
        <fpage>204</fpage>
        <lpage>216</lpage>
        <pub-id pub-id-type="doi">10.1093/biostatistics/kxr054</pub-id>
        <?supplied-pmid 22285995?>
        <pub-id pub-id-type="pmid">22285995</pub-id>
      </element-citation>
    </ref>
    <ref id="CR14">
      <label>14</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Risso</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Schwartz</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Sherlock</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Dudoit</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>
          <bold>GC-content normalization for RNA-seq data</bold>
        </article-title>
        <source>BMC Bioinformatics</source>
        <year>2011</year>
        <volume>12</volume>
        <fpage>480</fpage>
        <pub-id pub-id-type="doi">10.1186/1471-2105-12-480</pub-id>
        <?supplied-pmid 22177264?>
        <pub-id pub-id-type="pmid">22177264</pub-id>
      </element-citation>
    </ref>
    <ref id="CR15">
      <label>15</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Smyth</surname>
            <given-names>GK</given-names>
          </name>
        </person-group>
        <article-title>
          <bold>Linear models and empirical Bayes methods for assessing differential expression in microarray experiments</bold>
        </article-title>
        <source>Stat Appl Genet Mol Biol</source>
        <year>2004</year>
        <volume>3</volume>
        <fpage>1</fpage>
        <lpage>25</lpage>
      </element-citation>
    </ref>
    <ref id="CR16">
      <label>16</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bottomly</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Walter</surname>
            <given-names>NAR</given-names>
          </name>
          <name>
            <surname>Hunter</surname>
            <given-names>JE</given-names>
          </name>
          <name>
            <surname>Darakjian</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Kawane</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Buck</surname>
            <given-names>KJ</given-names>
          </name>
          <name>
            <surname>Searles</surname>
            <given-names>RP</given-names>
          </name>
          <name>
            <surname>Mooney</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>McWeeney</surname>
            <given-names>SK</given-names>
          </name>
          <name>
            <surname>Hitzemann</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>
          <bold>Evaluating gene expression in C57BL/6J and DBA/2J mouse striatum using RNA-seq and microarrays</bold>
        </article-title>
        <source>PLoS ONE</source>
        <year>2011</year>
        <volume>6</volume>
        <fpage>17820</fpage>
        <pub-id pub-id-type="doi">10.1371/journal.pone.0017820</pub-id>
      </element-citation>
    </ref>
    <ref id="CR17">
      <label>17</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Pickrell</surname>
            <given-names>JK</given-names>
          </name>
          <name>
            <surname>Marioni</surname>
            <given-names>JC</given-names>
          </name>
          <name>
            <surname>Pai</surname>
            <given-names>AA</given-names>
          </name>
          <name>
            <surname>Degner</surname>
            <given-names>JF</given-names>
          </name>
          <name>
            <surname>Engelhardt</surname>
            <given-names>BE</given-names>
          </name>
          <name>
            <surname>Nkadori</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Veyrieras</surname>
            <given-names>J-B</given-names>
          </name>
          <name>
            <surname>Stephens</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Gilad</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Pritchard</surname>
            <given-names>JK</given-names>
          </name>
        </person-group>
        <article-title>
          <bold>Understanding mechanisms underlying human gene expression variation with RNA sequencing</bold>
        </article-title>
        <source>Nature</source>
        <year>2010</year>
        <volume>464</volume>
        <fpage>768</fpage>
        <lpage>772</lpage>
        <pub-id pub-id-type="doi">10.1038/nature08872</pub-id>
        <?supplied-pmid 20220758?>
        <pub-id pub-id-type="pmid">20220758</pub-id>
      </element-citation>
    </ref>
    <ref id="CR18">
      <label>18</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Hastie</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Tibshirani</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Friedman</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <source>
          <italic>The Elements of Statistical Learning: Data Mining, Inference, and Prediction</italic>
        </source>
        <year>2009</year>
        <publisher-loc>New York City, USA</publisher-loc>
        <publisher-name>Springer</publisher-name>
      </element-citation>
    </ref>
    <ref id="CR19">
      <label>19</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bi</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Davuluri</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>
          <bold>NPEBseq: nonparametric empirical Bayesian-based procedure for differential expression analysis of RNA-seq data</bold>
        </article-title>
        <source>BMC Bioinformatics</source>
        <year>2013</year>
        <volume>14</volume>
        <fpage>262</fpage>
        <pub-id pub-id-type="doi">10.1186/1471-2105-14-262</pub-id>
        <?supplied-pmid 23981227?>
        <pub-id pub-id-type="pmid">23981227</pub-id>
      </element-citation>
    </ref>
    <ref id="CR20">
      <label>20</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Feng</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Meyer</surname>
            <given-names>CA</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>Q</given-names>
          </name>
          <name>
            <surname>Liu</surname>
            <given-names>JS</given-names>
          </name>
          <name>
            <surname>Liu</surname>
            <given-names>XS</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>Y</given-names>
          </name>
        </person-group>
        <article-title>
          <bold>GFOLD: a generalized fold change for ranking differentially expressed genes from RNA-seq data</bold>
        </article-title>
        <source>Bioinformatics</source>
        <year>2012</year>
        <volume>28</volume>
        <fpage>2782</fpage>
        <lpage>2788</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/bts515</pub-id>
        <?supplied-pmid 22923299?>
        <pub-id pub-id-type="pmid">22923299</pub-id>
      </element-citation>
    </ref>
    <ref id="CR21">
      <label>21</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Benjamini</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Hochberg</surname>
            <given-names>Y</given-names>
          </name>
        </person-group>
        <article-title>
          <bold>Controlling the false discovery rate: a practical and powerful approach to multiple testing</bold>
        </article-title>
        <source>J R Stat Soc Ser B Methodol</source>
        <year>1995</year>
        <volume>57</volume>
        <fpage>289</fpage>
        <lpage>300</lpage>
      </element-citation>
    </ref>
    <ref id="CR22">
      <label>22</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bourgon</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Gentleman</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Huber</surname>
            <given-names>W</given-names>
          </name>
        </person-group>
        <article-title>
          <bold>Independent filtering increases detection power for high-throughput experiments</bold>
        </article-title>
        <source>Proc Natl Acad Sci USA</source>
        <year>2010</year>
        <volume>107</volume>
        <fpage>9546</fpage>
        <lpage>9551</lpage>
        <pub-id pub-id-type="doi">10.1073/pnas.0914005107</pub-id>
        <?supplied-pmid 20460310?>
        <pub-id pub-id-type="pmid">20460310</pub-id>
      </element-citation>
    </ref>
    <ref id="CR23">
      <label>23</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>McCarthy</surname>
            <given-names>DJ</given-names>
          </name>
          <name>
            <surname>Smyth</surname>
            <given-names>GK</given-names>
          </name>
        </person-group>
        <article-title>
          <bold>Testing significance relative to a fold-change threshold is a TREAT</bold>
        </article-title>
        <source>Bioinformatics</source>
        <year>2009</year>
        <volume>25</volume>
        <fpage>765</fpage>
        <lpage>771</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btp053</pub-id>
        <?supplied-pmid 19176553?>
        <pub-id pub-id-type="pmid">19176553</pub-id>
      </element-citation>
    </ref>
    <ref id="CR24">
      <label>24</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Li</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Tibshirani</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>
          <bold>Finding consistent patterns: a nonparametric approach for identifying differential expression in RNA-seq data</bold>
        </article-title>
        <source>Stat Methods Med Res</source>
        <year>2013</year>
        <volume>22</volume>
        <fpage>519</fpage>
        <lpage>536</lpage>
        <pub-id pub-id-type="doi">10.1177/0962280211428386</pub-id>
        <?supplied-pmid 22127579?>
        <pub-id pub-id-type="pmid">22127579</pub-id>
      </element-citation>
    </ref>
    <ref id="CR25">
      <label>25</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Cook</surname>
            <given-names>RD</given-names>
          </name>
        </person-group>
        <article-title>
          <bold>Detection of influential observation in linear regression</bold>
        </article-title>
        <source>Technometrics</source>
        <year>1977</year>
        <volume>19</volume>
        <fpage>15</fpage>
        <lpage>18</lpage>
        <pub-id pub-id-type="doi">10.2307/1268249</pub-id>
      </element-citation>
    </ref>
    <ref id="CR26">
      <label>26</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hammer</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Banck</surname>
            <given-names>MS</given-names>
          </name>
          <name>
            <surname>Amberg</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Petznick</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Luo</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Khrebtukova</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Schroth</surname>
            <given-names>GP</given-names>
          </name>
          <name>
            <surname>Beyerlein</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Beutler</surname>
            <given-names>AS</given-names>
          </name>
        </person-group>
        <article-title>
          <bold>mRNA-seq with agnostic splice site discovery for nervous system transcriptomics tested in chronic pain</bold>
        </article-title>
        <source>Genome Res</source>
        <year>2010</year>
        <volume>20</volume>
        <fpage>847</fpage>
        <lpage>860</lpage>
        <pub-id pub-id-type="doi">10.1101/gr.101204.109</pub-id>
        <?supplied-pmid 20452967?>
        <pub-id pub-id-type="pmid">20452967</pub-id>
      </element-citation>
    </ref>
    <ref id="CR27">
      <label>27</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Frazee</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Langmead</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Leek</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>
          <bold>ReCount: a multi-experiment resource of analysis-ready RNA-seq gene count datasets</bold>
        </article-title>
        <source>BMC Bioinformatics</source>
        <year>2011</year>
        <volume>12</volume>
        <fpage>449</fpage>
        <pub-id pub-id-type="doi">10.1186/1471-2105-12-449</pub-id>
        <?supplied-pmid 22087737?>
        <pub-id pub-id-type="pmid">22087737</pub-id>
      </element-citation>
    </ref>
    <ref id="CR28">
      <label>28</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Trapnell</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Hendrickson</surname>
            <given-names>DG</given-names>
          </name>
          <name>
            <surname>Sauvageau</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Goff</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Rinn</surname>
            <given-names>JL</given-names>
          </name>
          <name>
            <surname>Pachter</surname>
            <given-names>L</given-names>
          </name>
        </person-group>
        <article-title>
          <bold>Differential analysis of gene regulation at transcript resolution with RNA-seq</bold>
        </article-title>
        <source>Nat Biotechnol</source>
        <year>2012</year>
        <volume>31</volume>
        <fpage>46</fpage>
        <lpage>53</lpage>
        <pub-id pub-id-type="doi">10.1038/nbt.2450</pub-id>
        <?supplied-pmid 23222703?>
        <pub-id pub-id-type="pmid">23222703</pub-id>
      </element-citation>
    </ref>
    <ref id="CR29">
      <label>29</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Glaus</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Honkela</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Rattray</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>
          <bold>Identifying differentially expressed transcripts from RNA-seq data with biological variation</bold>
        </article-title>
        <source>Bioinformatics</source>
        <year>2012</year>
        <volume>28</volume>
        <fpage>1721</fpage>
        <lpage>1728</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/bts260</pub-id>
        <?supplied-pmid 22563066?>
        <pub-id pub-id-type="pmid">22563066</pub-id>
      </element-citation>
    </ref>
    <ref id="CR30">
      <label>30</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Anders</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Reyes</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Huber</surname>
            <given-names>W</given-names>
          </name>
        </person-group>
        <article-title>
          <bold>Detecting differential usage of exons from RNA-seq data</bold>
        </article-title>
        <source>Genome Res</source>
        <year>2012</year>
        <volume>22</volume>
        <fpage>2008</fpage>
        <lpage>2017</lpage>
        <pub-id pub-id-type="doi">10.1101/gr.133744.111</pub-id>
        <?supplied-pmid 22722343?>
        <pub-id pub-id-type="pmid">22722343</pub-id>
      </element-citation>
    </ref>
    <ref id="CR31">
      <label>31</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Sammeth</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>
          <bold>Complete alternative splicing events are bubbles in splicing graphs</bold>
        </article-title>
        <source>J Comput Biol</source>
        <year>2009</year>
        <volume>16</volume>
        <fpage>1117</fpage>
        <lpage>1140</lpage>
        <pub-id pub-id-type="doi">10.1089/cmb.2009.0108</pub-id>
        <?supplied-pmid 19689216?>
        <pub-id pub-id-type="pmid">19689216</pub-id>
      </element-citation>
    </ref>
    <ref id="CR32">
      <label>32</label>
      <mixed-citation publication-type="other">Pagès H, Bindreither D, Carlson M, Morgan M: <bold>SplicingGraphs: create, manipulate, visualize splicing graphs, and assign RNA-seq reads to them</bold>2013. Bioconductor package [http://www.bioconductor.org]</mixed-citation>
    </ref>
    <ref id="CR33">
      <label>33</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Robinson</surname>
            <given-names>MD</given-names>
          </name>
          <name>
            <surname>McCarthy</surname>
            <given-names>DJ</given-names>
          </name>
          <name>
            <surname>Smyth</surname>
            <given-names>GK</given-names>
          </name>
        </person-group>
        <article-title>
          <bold>edgeR: a Bioconductor package for differential expression analysis of digital gene expression data</bold>
        </article-title>
        <source>Bioinformatics</source>
        <year>2009</year>
        <volume>26</volume>
        <fpage>139</fpage>
        <lpage>140</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btp616</pub-id>
        <?supplied-pmid 19910308?>
        <pub-id pub-id-type="pmid">19910308</pub-id>
      </element-citation>
    </ref>
    <ref id="CR34">
      <label>34</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zhou</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Lindsay</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Robinson</surname>
            <given-names>MD</given-names>
          </name>
        </person-group>
        <article-title>
          <bold>Robustly detecting differential expression in RNA sequencing data using observation weights</bold>
        </article-title>
        <source>Nucleic Acids Res</source>
        <year>2014</year>
        <volume>42</volume>
        <fpage>e91</fpage>
        <pub-id pub-id-type="doi">10.1093/nar/gku310</pub-id>
        <?supplied-pmid 24753412?>
        <pub-id pub-id-type="pmid">24753412</pub-id>
      </element-citation>
    </ref>
    <ref id="CR35">
      <label>35</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Leng</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Dawson</surname>
            <given-names>JA</given-names>
          </name>
          <name>
            <surname>Thomson</surname>
            <given-names>JA</given-names>
          </name>
          <name>
            <surname>Ruotti</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Rissman</surname>
            <given-names>AI</given-names>
          </name>
          <name>
            <surname>Smits</surname>
            <given-names>BMG</given-names>
          </name>
          <name>
            <surname>Haag</surname>
            <given-names>JD</given-names>
          </name>
          <name>
            <surname>Gould</surname>
            <given-names>MN</given-names>
          </name>
          <name>
            <surname>Stewart</surname>
            <given-names>RM</given-names>
          </name>
          <name>
            <surname>Kendziorski</surname>
            <given-names>C</given-names>
          </name>
        </person-group>
        <article-title>
          <bold>EBSeq: an empirical Bayes hierarchical model for inference in RNA-seq experiments</bold>
        </article-title>
        <source>Bioinformatics</source>
        <year>2013</year>
        <volume>29</volume>
        <fpage>1035</fpage>
        <lpage>1043</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btt087</pub-id>
        <?supplied-pmid 23428641?>
        <pub-id pub-id-type="pmid">23428641</pub-id>
      </element-citation>
    </ref>
    <ref id="CR36">
      <label>36</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Law</surname>
            <given-names>CW</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Shi</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Smyth</surname>
            <given-names>GK</given-names>
          </name>
        </person-group>
        <article-title>
          <bold>Voom: precision weights unlock linear model analysis tools for RNA-seq read counts</bold>
        </article-title>
        <source>Genome Biol</source>
        <year>2014</year>
        <volume>15</volume>
        <fpage>29</fpage>
        <pub-id pub-id-type="doi">10.1186/gb-2014-15-2-r29</pub-id>
      </element-citation>
    </ref>
    <ref id="CR37">
      <label>37</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hubert</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Arabie</surname>
            <given-names>P</given-names>
          </name>
        </person-group>
        <article-title>
          <bold>Comparing partitions</bold>
        </article-title>
        <source>J Classif</source>
        <year>1985</year>
        <volume>2</volume>
        <fpage>193</fpage>
        <lpage>218</lpage>
        <pub-id pub-id-type="doi">10.1007/BF01908075</pub-id>
      </element-citation>
    </ref>
    <ref id="CR38">
      <label>38</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Witten</surname>
            <given-names>DM</given-names>
          </name>
        </person-group>
        <article-title>
          <bold>Classification and clustering of sequencing data using a Poisson model</bold>
        </article-title>
        <source>Ann Appl Stat</source>
        <year>2011</year>
        <volume>5</volume>
        <fpage>2493</fpage>
        <lpage>2518</lpage>
        <pub-id pub-id-type="doi">10.1214/11-AOAS493</pub-id>
      </element-citation>
    </ref>
    <ref id="CR39">
      <label>39</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Irizarry</surname>
            <given-names>RA</given-names>
          </name>
          <name>
            <surname>Wu</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Jaffee</surname>
            <given-names>HA</given-names>
          </name>
        </person-group>
        <article-title>
          <bold>Comparison of affymetrix GeneChip expression measures</bold>
        </article-title>
        <source>Bioinformatics</source>
        <year>2006</year>
        <volume>22</volume>
        <fpage>789</fpage>
        <lpage>794</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btk046</pub-id>
        <?supplied-pmid 16410320?>
        <pub-id pub-id-type="pmid">16410320</pub-id>
      </element-citation>
    </ref>
    <ref id="CR40">
      <label>40</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Asangani</surname>
            <given-names>IA</given-names>
          </name>
          <name>
            <surname>Dommeti</surname>
            <given-names>VL</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Malik</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Cieslik</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Yang</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Escara-Wilke</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Wilder-Romans</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Dhanireddy</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Engelke</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Iyer</surname>
            <given-names>MK</given-names>
          </name>
          <name>
            <surname>Jing</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Wu</surname>
            <given-names>Y-M</given-names>
          </name>
          <name>
            <surname>Cao</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Qin</surname>
            <given-names>ZS</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Feng</surname>
            <given-names>FY</given-names>
          </name>
          <name>
            <surname>Chinnaiyan</surname>
            <given-names>AM</given-names>
          </name>
        </person-group>
        <article-title>
          <bold>Therapeutic targeting of BET bromodomain proteins in castration-resistant prostate cancer</bold>
        </article-title>
        <source>Nature</source>
        <year>2014</year>
        <volume>510</volume>
        <fpage>278</fpage>
        <lpage>282</lpage>
        <pub-id pub-id-type="doi">10.1038/nature13229</pub-id>
        <?supplied-pmid 24759320?>
        <pub-id pub-id-type="pmid">24759320</pub-id>
      </element-citation>
    </ref>
    <ref id="CR41">
      <label>41</label>
      <mixed-citation publication-type="other">Stark R, Brown G: <bold>DiffBind: differential binding analysis of ChIP-seq peak data</bold>2013. Bioconductor package [http://www.bioconductor.org]</mixed-citation>
    </ref>
    <ref id="CR42">
      <label>42</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ross-Innes</surname>
            <given-names>CS</given-names>
          </name>
          <name>
            <surname>Stark</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Teschendorff</surname>
            <given-names>AE</given-names>
          </name>
          <name>
            <surname>Holmes</surname>
            <given-names>KA</given-names>
          </name>
          <name>
            <surname>Ali</surname>
            <given-names>HR</given-names>
          </name>
          <name>
            <surname>Dunning</surname>
            <given-names>MJ</given-names>
          </name>
          <name>
            <surname>Brown</surname>
            <given-names>GD</given-names>
          </name>
          <name>
            <surname>Gojis</surname>
            <given-names>O</given-names>
          </name>
          <name>
            <surname>Ellis</surname>
            <given-names>IO</given-names>
          </name>
          <name>
            <surname>Green</surname>
            <given-names>AR</given-names>
          </name>
          <name>
            <surname>Ali</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Chin</surname>
            <given-names>S-F</given-names>
          </name>
          <name>
            <surname>Palmieri</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Caldas</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Carroll</surname>
            <given-names>JS</given-names>
          </name>
        </person-group>
        <article-title>
          <bold>Differential oestrogen receptor binding is associated with clinical outcome in breast cancer</bold>
        </article-title>
        <source>Nature</source>
        <year>2012</year>
        <volume>481</volume>
        <fpage>389</fpage>
        <lpage>393</lpage>
        <?supplied-pmid 22217937?>
        <pub-id pub-id-type="pmid">22217937</pub-id>
      </element-citation>
    </ref>
    <ref id="CR43">
      <label>43</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Robinson</surname>
            <given-names>DG</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Storey</surname>
            <given-names>JD</given-names>
          </name>
          <name>
            <surname>Gresham</surname>
            <given-names>D</given-names>
          </name>
        </person-group>
        <article-title>
          <bold>Design and analysis of bar-seq experiments</bold>
        </article-title>
        <source>G3 (Bethesda)</source>
        <year>2013</year>
        <volume>4</volume>
        <fpage>11</fpage>
        <lpage>18</lpage>
        <pub-id pub-id-type="doi">10.1534/g3.113.008565</pub-id>
        <pub-id pub-id-type="pmid">24192834</pub-id>
      </element-citation>
    </ref>
    <ref id="CR44">
      <label>44</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>McMurdie</surname>
            <given-names>PJ</given-names>
          </name>
          <name>
            <surname>Holmes</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>
          <bold>Waste not, want not: why rarefying microbiome data is inadmissible</bold>
        </article-title>
        <source>PLoS Comput Biol</source>
        <year>2014</year>
        <volume>10</volume>
        <fpage>1003531</fpage>
        <pub-id pub-id-type="doi">10.1371/journal.pcbi.1003531</pub-id>
      </element-citation>
    </ref>
    <ref id="CR45">
      <label>45</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Vasquez</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Hon</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Vanselow</surname>
            <given-names>JT</given-names>
          </name>
          <name>
            <surname>Schlosser</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Siegel</surname>
            <given-names>TN</given-names>
          </name>
        </person-group>
        <article-title>
          <bold>Comparative ribosome profiling reveals extensive translational complexity in different Trypanosoma brucei life cycle stages</bold>
        </article-title>
        <source>Nucleic Acids Res</source>
        <year>2014</year>
        <volume>42</volume>
        <fpage>3623</fpage>
        <lpage>3637</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/gkt1386</pub-id>
        <?supplied-pmid 24442674?>
        <pub-id pub-id-type="pmid">24442674</pub-id>
      </element-citation>
    </ref>
    <ref id="CR46">
      <label>46</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zhou</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Zhu</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Cai</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Yuan</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Huang</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Wei</surname>
            <given-names>W</given-names>
          </name>
        </person-group>
        <article-title>
          <bold>High-throughput screening of a CRISPR/Cas9 library for functional genomics in human cells</bold>
        </article-title>
        <source>Nature</source>
        <year>2014</year>
        <volume>509</volume>
        <fpage>487</fpage>
        <lpage>491</lpage>
        <pub-id pub-id-type="doi">10.1038/nature13166</pub-id>
        <?supplied-pmid 24717434?>
        <pub-id pub-id-type="pmid">24717434</pub-id>
      </element-citation>
    </ref>
    <ref id="CR47">
      <label>47</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Cox</surname>
            <given-names>DR</given-names>
          </name>
          <name>
            <surname>Reid</surname>
            <given-names>N</given-names>
          </name>
        </person-group>
        <article-title>
          <bold>Parameter orthogonality and approximate conditional inference</bold>
        </article-title>
        <source>J R Stat Soc Ser B Methodol</source>
        <year>1987</year>
        <volume>49</volume>
        <fpage>1</fpage>
        <lpage>39</lpage>
      </element-citation>
    </ref>
    <ref id="CR48">
      <label>48</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Robinson</surname>
            <given-names>MD</given-names>
          </name>
          <name>
            <surname>Smyth</surname>
            <given-names>GK</given-names>
          </name>
        </person-group>
        <article-title>
          <bold>Small-sample estimation of negative binomial dispersion, with applications to SAGE data</bold>
        </article-title>
        <source>Biostatistics</source>
        <year>2007</year>
        <volume>9</volume>
        <fpage>321</fpage>
        <lpage>332</lpage>
        <pub-id pub-id-type="doi">10.1093/biostatistics/kxm030</pub-id>
        <?supplied-pmid 17728317?>
        <pub-id pub-id-type="pmid">17728317</pub-id>
      </element-citation>
    </ref>
    <ref id="CR49">
      <label>49</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Pawitan</surname>
            <given-names>Y</given-names>
          </name>
        </person-group>
        <source>
          <italic>In All Likelihood: Statistical Modelling and Inference Using Likelihood</italic>
        </source>
        <year>2001</year>
        <publisher-loc>New York City, USA</publisher-loc>
        <publisher-name>Oxford University Press</publisher-name>
      </element-citation>
    </ref>
    <ref id="CR50">
      <label>50</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Armijo</surname>
            <given-names>L</given-names>
          </name>
        </person-group>
        <article-title>
          <bold>Minimization of functions having Lipschitz continuous first partial derivatives</bold>
        </article-title>
        <source>Pac J Math</source>
        <year>1966</year>
        <volume>16</volume>
        <fpage>1</fpage>
        <lpage>3</lpage>
        <pub-id pub-id-type="doi">10.2140/pjm.1966.16.1</pub-id>
      </element-citation>
    </ref>
    <ref id="CR51">
      <label>51</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Di</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Schafer</surname>
            <given-names>DW</given-names>
          </name>
          <name>
            <surname>Cumbie</surname>
            <given-names>JS</given-names>
          </name>
          <name>
            <surname>Chang</surname>
            <given-names>JH</given-names>
          </name>
        </person-group>
        <article-title>
          <bold>The NBP negative binomial model for assessing differential gene expression from RNA-seq</bold>
        </article-title>
        <source>Stat Appl Genet Mol Biol</source>
        <year>2011</year>
        <volume>10</volume>
        <fpage>1</fpage>
        <lpage>28</lpage>
      </element-citation>
    </ref>
    <ref id="CR52">
      <label>52</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Abramowitz</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Stegun</surname>
            <given-names>I</given-names>
          </name>
        </person-group>
        <source>
          <italic>Handbook of Mathematical Functions</italic>
        </source>
        <year>1965</year>
        <publisher-loc>New York, USA</publisher-loc>
        <publisher-name>Dover Publications</publisher-name>
      </element-citation>
    </ref>
    <ref id="CR53">
      <label>53</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Newton</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Kendziorski</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Richmond</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Blattner</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Tsui</surname>
            <given-names>K</given-names>
          </name>
        </person-group>
        <article-title>
          <bold>On differential variability of expression ratios: improving statistical inference about gene expression changes from microarray data</bold>
        </article-title>
        <source>J Comput Biol</source>
        <year>2001</year>
        <volume>8</volume>
        <fpage>37</fpage>
        <lpage>52</lpage>
        <pub-id pub-id-type="doi">10.1089/106652701300099074</pub-id>
        <?supplied-pmid 11339905?>
        <pub-id pub-id-type="pmid">11339905</pub-id>
      </element-citation>
    </ref>
    <ref id="CR54">
      <label>54</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Huber</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>von Heydebreck</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Sultmann</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Poustka</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Vingron</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>
          <bold>Variance stabilization applied to microarray data calibration and to the quantification of differential expression</bold>
        </article-title>
        <source>Bioinformatics</source>
        <year>2002</year>
        <volume>18</volume>
        <fpage>96</fpage>
        <lpage>104</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/18.suppl_1.S96</pub-id>
      </element-citation>
    </ref>
    <ref id="CR55">
      <label>55</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Durbin</surname>
            <given-names>BP</given-names>
          </name>
          <name>
            <surname>Hardin</surname>
            <given-names>JS</given-names>
          </name>
          <name>
            <surname>Hawkins</surname>
            <given-names>DM</given-names>
          </name>
          <name>
            <surname>Rocke</surname>
            <given-names>DM</given-names>
          </name>
        </person-group>
        <article-title>
          <bold>A variance-stabilizing transformation for gene-expression microarray data</bold>
        </article-title>
        <source>Bioinformatics</source>
        <year>2002</year>
        <volume>18</volume>
        <fpage>105</fpage>
        <lpage>110</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/18.suppl_1.S105</pub-id>
      </element-citation>
    </ref>
    <ref id="CR56">
      <label>56</label>
      <mixed-citation publication-type="other">Park MY: <bold>Generalized linear models with regularization</bold>. <italic>PhD thesis.</italic>Stanford University, Department of Statistics; 2006.</mixed-citation>
    </ref>
    <ref id="CR57">
      <label>57</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Friedman</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Hastie</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Tibshirani</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>
          <bold>Regularization paths for generalized linear models via coordinate descent</bold>
        </article-title>
        <source>J Stat Softw</source>
        <year>2010</year>
        <volume>33</volume>
        <fpage>1</fpage>
        <lpage>22</lpage>
        <?supplied-pmid 20808728?>
        <pub-id pub-id-type="pmid">20808728</pub-id>
      </element-citation>
    </ref>
    <ref id="CR58">
      <label>58</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Cule</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Vineis</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>De Iorio</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>
          <bold>Significance testing in ridge regression for genetic data</bold>
        </article-title>
        <source>BMC Bioinformatics</source>
        <year>2011</year>
        <volume>12</volume>
        <fpage>372</fpage>
        <pub-id pub-id-type="doi">10.1186/1471-2105-12-372</pub-id>
        <?supplied-pmid 21929786?>
        <pub-id pub-id-type="pmid">21929786</pub-id>
      </element-citation>
    </ref>
    <ref id="CR59">
      <label>59</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Cook</surname>
            <given-names>RD</given-names>
          </name>
          <name>
            <surname>Weisberg</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <source>
          <italic>Residuals and Influence in Regression</italic>
        </source>
        <year>1982</year>
        <publisher-loc>New York, USA</publisher-loc>
        <publisher-name>Chapman and Hall/CRC</publisher-name>
      </element-citation>
    </ref>
    <ref id="CR60">
      <label>60</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lawrence</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Huber</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Pagès</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Aboyoun</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Carlson</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Gentleman</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Morgan</surname>
            <given-names>MT</given-names>
          </name>
          <name>
            <surname>Carey</surname>
            <given-names>VJ</given-names>
          </name>
        </person-group>
        <article-title>
          <bold>Software for computing and annotating genomic ranges</bold>
        </article-title>
        <source>PLoS Comput Biol</source>
        <year>2013</year>
        <volume>9</volume>
        <fpage>1003118</fpage>
        <pub-id pub-id-type="doi">10.1371/journal.pcbi.1003118</pub-id>
      </element-citation>
    </ref>
    <ref id="CR61">
      <label>61</label>
      <mixed-citation publication-type="other">Pagès H, Obenchain V, Morgan M: <bold>GenomicAlignments: Representation and manipulation of short genomic alignments</bold>2013. Bioconductor package [http://www.bioconductor.org]</mixed-citation>
    </ref>
    <ref id="CR62">
      <label>62</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Anders</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Pyl</surname>
            <given-names>PT</given-names>
          </name>
          <name>
            <surname>Huber</surname>
            <given-names>W</given-names>
          </name>
        </person-group>
        <article-title>
          <bold>HTSeq - A Python framework to work with high-throughput sequencing data</bold>
        </article-title>
        <source>Bioinformatics</source>
        <year>2015</year>
        <volume>31</volume>
        <fpage>166</fpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btu638</pub-id>
        <?supplied-pmid 25260700?>
        <pub-id pub-id-type="pmid">25260700</pub-id>
      </element-citation>
    </ref>
    <ref id="CR63">
      <label>63</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Delhomme</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Padioleau</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Furlong</surname>
            <given-names>EE</given-names>
          </name>
          <name>
            <surname>Steinmetz</surname>
            <given-names>LM</given-names>
          </name>
        </person-group>
        <article-title>
          <bold>easyRNASeq: a Bioconductor package for processing RNA-seq data</bold>
        </article-title>
        <source>Bioinformatics</source>
        <year>2012</year>
        <volume>28</volume>
        <fpage>2532</fpage>
        <lpage>2533</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/bts477</pub-id>
        <?supplied-pmid 22847932?>
        <pub-id pub-id-type="pmid">22847932</pub-id>
      </element-citation>
    </ref>
    <ref id="CR64">
      <label>64</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Liao</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Smyth</surname>
            <given-names>GK</given-names>
          </name>
          <name>
            <surname>Shi</surname>
            <given-names>W</given-names>
          </name>
        </person-group>
        <article-title>
          <bold>featureCounts: an efficient general purpose program for assigning sequence reads to genomic features</bold>
        </article-title>
        <source>Bioinformatics</source>
        <year>2014</year>
        <volume>30</volume>
        <fpage>923</fpage>
        <lpage>930</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btt656</pub-id>
        <?supplied-pmid 24227677?>
        <pub-id pub-id-type="pmid">24227677</pub-id>
      </element-citation>
    </ref>
    <ref id="CR65">
      <label>65</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kim</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Pertea</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Trapnell</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Pimentel</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Kelley</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Salzberg</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>
          <bold>TopHat2: accurate alignment of transcriptomes in the presence of insertions, deletions and gene fusions</bold>
        </article-title>
        <source>Genome Biol</source>
        <year>2013</year>
        <volume>14</volume>
        <fpage>36</fpage>
        <pub-id pub-id-type="doi">10.1186/gb-2013-14-4-r36</pub-id>
      </element-citation>
    </ref>
    <ref id="CR66">
      <label>66</label>
      <mixed-citation publication-type="other"><bold>DESeq2paper</bold>. [http://www-huber.embl.de/DESeq2paper]</mixed-citation>
    </ref>
  </ref-list>
</back>
