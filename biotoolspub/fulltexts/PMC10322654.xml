<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.2 20190208//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.2?>
<?ConverterInfo.XSLTName jats2jats3.xsl?>
<?ConverterInfo.Version 1?>
<?properties open_access?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">Bioinformatics</journal-id>
    <journal-id journal-id-type="publisher-id">bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1367-4803</issn>
    <issn pub-type="epub">1367-4811</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">10322654</article-id>
    <article-id pub-id-type="pmid">37354527</article-id>
    <article-id pub-id-type="doi">10.1093/bioinformatics/btad407</article-id>
    <article-id pub-id-type="publisher-id">btad407</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Original Paper</subject>
        <subj-group subj-group-type="category-toc-heading">
          <subject>Data and Text Mining</subject>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="category-taxonomy-collection">
        <subject>AcademicSubjects/SCI01060</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>enviRule: an end-to-end system for automatic extraction of reaction patterns from environmental contaminant biotransformation pathways</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0009-0008-4588-9487</contrib-id>
        <name>
          <surname>Zhang</surname>
          <given-names>Kunyang</given-names>
        </name>
        <aff><institution>Department of Environmental Chemistry, Eawag</institution>, Dübendorf 8600, <country country="CH">Switzerland</country></aff>
        <aff><institution>Department of Chemistry, University of Zürich</institution>, Zürich 8057, <country country="CH">Switzerland</country></aff>
        <xref rid="btad407-cor1" ref-type="corresp"/>
        <!--kunyang.zhang@eawag.ch-->
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0001-6068-8220</contrib-id>
        <name>
          <surname>Fenner</surname>
          <given-names>Kathrin</given-names>
        </name>
        <aff><institution>Department of Environmental Chemistry, Eawag</institution>, Dübendorf 8600, <country country="CH">Switzerland</country></aff>
        <aff><institution>Department of Chemistry, University of Zürich</institution>, Zürich 8057, <country country="CH">Switzerland</country></aff>
      </contrib>
    </contrib-group>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Wren</surname>
          <given-names>Jonathan</given-names>
        </name>
        <role>Associate Editor</role>
      </contrib>
    </contrib-group>
    <author-notes>
      <corresp id="btad407-cor1">Corresponding author. Department of Environmental Chemistry, Eawag, Dübendorf 8600, Switzerland. E-mail: <email>kunyang.zhang@eawag.ch</email> (K.Z.)</corresp>
    </author-notes>
    <pub-date pub-type="collection">
      <month>7</month>
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="epub" iso-8601-date="2023-06-24">
      <day>24</day>
      <month>6</month>
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>24</day>
      <month>6</month>
      <year>2023</year>
    </pub-date>
    <volume>39</volume>
    <issue>7</issue>
    <elocation-id>btad407</elocation-id>
    <history>
      <date date-type="received">
        <day>05</day>
        <month>4</month>
        <year>2023</year>
      </date>
      <date date-type="rev-recd">
        <day>02</day>
        <month>6</month>
        <year>2023</year>
      </date>
      <date date-type="editorial-decision">
        <day>20</day>
        <month>6</month>
        <year>2023</year>
      </date>
      <date date-type="accepted">
        <day>23</day>
        <month>6</month>
        <year>2023</year>
      </date>
      <date date-type="corrected-typeset">
        <day>05</day>
        <month>7</month>
        <year>2023</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2023. Published by Oxford University Press.</copyright-statement>
      <copyright-year>2023</copyright-year>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">https://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted reuse, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <self-uri xlink:href="btad407.pdf"/>
    <abstract>
      <title>Abstract</title>
      <sec id="s1">
        <title>Motivation</title>
        <p>Transformation products (TPs) of man-made chemicals, formed through microbially mediated transformation in the environment, can have serious adverse environmental effects, yet the analytical identification of TPs is challenging. Rule-based prediction tools are successful in predicting TPs, especially in environmental chemistry applications that typically have to rely on small datasets, by imparting the existing knowledge on enzyme-mediated biotransformation reactions. However, the rules extracted from biotransformation reaction databases usually face the issue of being over/under-generalized and are not flexible to be updated with new reactions.</p>
      </sec>
      <sec id="s2">
        <title>Results</title>
        <p>We developed an automatic rule extraction tool called enviRule. It clusters biotransformation reactions into different groups based on the similarities of reaction fingerprints, and then automatically extracts and generalizes rules for each reaction group in SMARTS format. It optimizes the genericity of automatic rules against the downstream TP prediction task. Models trained with automatic rules outperformed the models trained with manually curated rules by 30% in the area under curve (AUC) scores. Moreover, automatic rules can be easily updated with new reactions, highlighting enviRule’s strengths for both automatic extraction of optimized reactions rules and automated updating thereof.</p>
      </sec>
      <sec id="s3">
        <title>Availability and implementation</title>
        <p>enviRule code is freely available at <ext-link xlink:href="https://github.com/zhangky12/enviRule" ext-link-type="uri">https://github.com/zhangky12/enviRule</ext-link>.</p>
      </sec>
    </abstract>
    <funding-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>European Union’s H2020 research and innovation program</institution>
          </institution-wrap>
        </funding-source>
      </award-group>
    </funding-group>
    <counts>
      <page-count count="8"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec>
    <title>1 Introduction</title>
    <p>Environmental biotransformation of a variety of organic contaminants plays an important role in chemical risk management (<xref rid="btad407-B18" ref-type="bibr">Kern <italic toggle="yes">et al.</italic> 2010</xref>, <xref rid="btad407-B25" ref-type="bibr">Olvera-Vargas <italic toggle="yes">et al.</italic> 2016</xref>), bioremediation of contaminated sites (<xref rid="btad407-B4" ref-type="bibr">de Lorenzo <italic toggle="yes">et al.</italic> 2008</xref>), and the development of green chemical alternatives (<xref rid="btad407-B21" ref-type="bibr">Moermond <italic toggle="yes">et al.</italic> 2022</xref>). In most cases, the bioactivity of transformation products (TPs) formed as part of the biotransformation process is mitigated through the structural changes introduced. However, examples have been reported where TPs exhibit equal or even higher bioactivities due to the conservation or formation of toxicophore structures in TPs, resulting in greater ecological risks compared to the parent compounds (<xref rid="btad407-B3" ref-type="bibr">Cwiertny <italic toggle="yes">et al.</italic> 2014</xref>). For example, decreases in the diversity and function of soil microorganisms were observed in a soil treated with 3,5-dichloroaniline (3,5-DCA), but not in the soil treated with its parent pesticide iprodione, suggesting greater toxicity of 3,5-DCA to soil microorganisms (<xref rid="btad407-B38" ref-type="bibr">Vasileiadis <italic toggle="yes">et al.</italic> 2018</xref>). Hence TPs should be included into hazard and risk assessment to obtain a comprehensive metric for the biological effects of contaminants. Yet, the identification and structural characterization of TPs is challenging, especially in environmental samples (<xref rid="btad407-B16" ref-type="bibr">Hubert <italic toggle="yes">et al.</italic> 2017</xref>). Typically, analysis by liquid chromatography-high resolution mass spectrometry (LC-HRMS) suspect or nontarget screening is required for the identification of formed TPs (<xref rid="btad407-B14" ref-type="bibr">Helbling <italic toggle="yes">et al.</italic> 2010</xref>, <xref rid="btad407-B12" ref-type="bibr">Funke <italic toggle="yes">et al.</italic> 2016</xref>), which is time-consuming and labor-intensive. Therefore, <italic toggle="yes">in silico</italic> models that can accurately predict possible biotransformation TPs are an essential tool for the comprehensive ecological risk assessment of environmental contaminants.</p>
    <p>Substantial efforts have been made to enable the <italic toggle="yes">in silico</italic> prediction of TPs from contaminant biotransformation by environmental microbial communities, and a number of rule-based systems have been developed, including enviPath (<xref rid="btad407-B40" ref-type="bibr">Wicker <italic toggle="yes">et al.</italic> 2016</xref>), the chemical transformation simulator by the US EPA (<ext-link xlink:href="https://scholarsarchive.byu.edu/iemssconference/2016/Stream-A/19/" ext-link-type="uri">https://scholarsarchive.byu.edu/iemssconference/2016/Stream-A/19/</ext-link>), and Biotransformer (<xref rid="btad407-B6" ref-type="bibr">Djoumbou-Feunang <italic toggle="yes">et al.</italic> 2019</xref>, <xref rid="btad407-B41" ref-type="bibr">Wishart <italic toggle="yes">et al.</italic> 2022</xref>). All of these <italic toggle="yes">in silico</italic> prediction tools combine both domain knowledge and machine learning models to predict and prune biotransformation pathways. Although rule-free models (i.e. sequence-based models) have also been shown to achieve considerable success in predicting the outcomes of chemical reactions (<xref rid="btad407-B32" ref-type="bibr">Schwaller <italic toggle="yes">et al.</italic> 2019</xref>, <xref rid="btad407-B33" ref-type="bibr">2021a</xref>, <xref rid="btad407-B34" ref-type="bibr">b</xref>), and sometimes even outperform rule-based models, they require large amounts of data for their training. This mostly prevents them from being applied on environmental biotransformation reactions, which only have limited sizes of datasets, especially when the reactions are confined to specific environmental matrices, such as soil, water, sediments, and sludge (<xref rid="btad407-B30" ref-type="bibr">Satoh <italic toggle="yes">et al.</italic> 2023</xref>). Rules significantly facilitate the training of models on small datasets by imparting the existing knowledge on enzyme-mediated biotransformation reactions to models, making rule-based models the currently most suitable approach for predicting TPs formed through environmental biotransformation reactions.</p>
    <p>The key challenge in developing rule-based models is the extraction of reaction rules from reaction databases. An exhaustive comparison of rules extracted from enzymatic reactions can be found in a previous report (<xref rid="btad407-B24" ref-type="bibr">Ni <italic toggle="yes">et al.</italic> 2021</xref>). Among the rules that are currently available online, the majority of them were manually curated, e.g. EAWAG-PPS rules (<xref rid="btad407-B13" ref-type="bibr">Gao <italic toggle="yes">et al.</italic> 2010</xref>), BNICE rules (<xref rid="btad407-B20" ref-type="bibr">Li <italic toggle="yes">et al.</italic> 2004</xref>), and MINE rules (<xref rid="btad407-B17" ref-type="bibr">Jeffryes <italic toggle="yes">et al.</italic> 2015</xref>). Manually curated rules are designed and examined by experts, and the rules can normally explain the most common reactions. However, recent improvements in techniques for elucidating biotransformation reactions at trace contaminant levels, e.g. the increased accessibility of LC-HRMS instruments and data analysis methods, enable biotransformation reactions to be discovered at increasing speed (<xref rid="btad407-B43" ref-type="bibr">Zimmermann <italic toggle="yes">et al.</italic> 2019</xref>), causing a surge in the volume of datasets. In addition, efforts have been made over the past five years to encode pathway information from publicly available regulatory dossiers. In enviPath specifically, the addition of the EAWAG-SOIL package, containing information on pesticide degradation pathways in soil, to the legacy EAWAG-BBD package has almost doubled the number of available reactions (<xref rid="btad407-B19" ref-type="bibr">Latino <italic toggle="yes">et al.</italic> 2017</xref>). With the addition of new pathway information, manually curated rules can be limited in representing the newly added reactions for two main reasons. First, due to the expansion of the chemical space covered, new reaction patterns might be present in the new datasets that are not included in existing rules at all. In the other case, similar reaction patterns are already included but not generalized enough to account for enzyme promiscuity on substrates in new reactions. At this point, with manually curated rules, it is very challenging to (i) sort new reactions into one of these two categories, and (ii) find the optimal level of generalization, also called genericity, for each rule.</p>
    <p>Therefore, interest has shifted from manually curated rules to automatically extracted rules. Indeed, systems like BNICE and ATLASx, which once used manual rules, have been updated to automatic rules in recent years (<xref rid="btad407-B24" ref-type="bibr">Ni <italic toggle="yes">et al.</italic> 2021</xref>, <xref rid="btad407-B22" ref-type="bibr">MohammadiPeyhani <italic toggle="yes">et al.</italic> 2022</xref>). Tools for automatic extraction of rules, based on atom–atom mapping (AAM) for the recognition of reaction centers, have been successfully developed (<xref rid="btad407-B7" ref-type="bibr">Duigou <italic toggle="yes">et al.</italic> 2019</xref>, <xref rid="btad407-B5" ref-type="bibr">Ding <italic toggle="yes">et al.</italic> 2020</xref>, <xref rid="btad407-B24" ref-type="bibr">Ni <italic toggle="yes">et al.</italic> 2021</xref>). Relative to manual rule curation, automatic extraction of rules from reactions can be very fast and the resulting set of rules normally covers reaction patterns more comprehensively. For instance, 4996 automatically extracted rules cover 20 942 biological reactions in Rhea (<xref rid="btad407-B5" ref-type="bibr">Ding <italic toggle="yes">et al.</italic> 2020</xref>). In addition, when new reactions are added and if it is found that they cannot be covered by any of the existing rules, automatic rule extraction should allow focusing on only those rules that need to be adjusted or created. This can potentially streamline the process of updating existing rules, relative to running extractions again for the combined set of reactions and producing a completely new set of rules. However, this possibility has not yet been extensively explored.</p>
    <p>Despite these obvious advantages of automatic rule extraction, the algorithms used are typically fully agnostic of biochemical expert knowledge on enzymes’ substrate specificities. Therefore, the main challenge faced by tools for automatic rule extraction is defining the appropriate genericity of rules (<xref rid="btad407-B36" ref-type="bibr">Sveshnikova <italic toggle="yes">et al.</italic> 2022</xref>). Although reaction rules can be extracted at different genericity levels by using various extension diameters of reaction centers as demonstrated in RetroRules (<xref rid="btad407-B7" ref-type="bibr">Duigou <italic toggle="yes">et al.</italic> 2019</xref>), reaction centers are usually not extended (<xref rid="btad407-B24" ref-type="bibr">Ni <italic toggle="yes">et al.</italic> 2021</xref>) or extended to include only immediately neighboring atoms (<xref rid="btad407-B2" ref-type="bibr">Coley <italic toggle="yes">et al.</italic> 2017</xref>, <xref rid="btad407-B35" ref-type="bibr">Segler and Waller 2017</xref>, <xref rid="btad407-B5" ref-type="bibr">Ding <italic toggle="yes">et al.</italic> 2020</xref>) in order to ensure sufficient coverage. Rules extracted in this way can typically be generalized well to cover unknown reactions as they only specify few neighboring atoms around reaction centers. For example, the rule set with 1224 rules automatically extracted from MetaCyc reactions, which only overlap with 58% of KEGG reactions, can cover 85.2% of all KEGG reactions (<xref rid="btad407-B24" ref-type="bibr">Ni <italic toggle="yes">et al.</italic> 2021</xref>). However, while their coverage is high, such rules are likely to be falsely triggered on many substrates, resulting in combinatorial explosion when used in pathway predictions (<xref rid="btad407-B5" ref-type="bibr">Ding <italic toggle="yes">et al.</italic> 2020</xref>). Developing algorithms to balance between coverage and over-generalization in automatic rule extraction is therefore of utmost importance.</p>
    <p>Here, we exploit knowledge on observed contaminant biotransformation pathways to explore the possibility of optimizing rule genericity directly against the prediction task at hand. More specifically, we developed an automatic rule generation tool called enviRule that can automatically extract rules from biotransformation reactions, efficiently update automatic rules as new data is added, and determine the optimum genericity of rules for the task of contaminant pathway prediction using the enviPath pathway prediction system (<xref rid="btad407-B40" ref-type="bibr">Wicker <italic toggle="yes">et al.</italic> 2016</xref>). To that end, we related rule genericity to the pathway prediction performance of machine learning models and determined the optimum rule genericity as yielding the best model performance.</p>
    <p>We tested enviRule on the biotransformation reactions contained in the EAWAG-BBD package in enviPath and compared the prediction performance of models trained with the previously manually curated rules and the newly generated automatic rules at both reaction and pathway levels. The automatic rules were then updated with the more recently added reactions contained in the EAWAG-SOIL package to test the applicability of enviRule to deal with the growing number of new reactions.</p>
  </sec>
  <sec>
    <title>2 System and methods</title>
    <sec>
      <title>2.1 Biotransformation reaction dataset</title>
      <p>Biotransformation reactions reported in the EAWAG-BBD and EAWAG-SOIL packages in enviPath were used for automatic rule generation and updating of rules, respectively. EAWAG-BBD is a mirror data package of the University of Minnesota Biocatalysis/Biodegradation Database (UM-BBD), which was first developed in 1995 (<xref rid="btad407-B10" ref-type="bibr">Ellis <italic toggle="yes">et al.</italic> 1999</xref>). Over the past two decades, the dataset has grown from 4 to 219 pathways with 1479 reactions (<xref rid="btad407-B11" ref-type="bibr">Ellis <italic toggle="yes">et al.</italic> 2006</xref>). Most of the data in EAWAG-BBD derives from studies of pure or enrichment cultures. In contrast, EAWAG-SOIL, a rather new data package, contains pesticide biotransformation pathways in soils extracted from the draft assessment reports (DAR) used in pesticide registration that are made publicly available through the European Food Safety Authority (EFSA) (<xref rid="btad407-B19" ref-type="bibr">Latino <italic toggle="yes">et al.</italic> 2017</xref>). 317 pathways with 2447 reactions observed under aerobic conditions have been extracted from DARs and documented in EAWAG-SOIL. Different from most studies reported in EAWAG-BBD, biotransformation studies reported in EAWAG-SOIL were carried out using <sup>14</sup>C-labeling, thus likely providing more complete pathways.</p>
    </sec>
    <sec>
      <title>2.2 Design of enviRule</title>
      <p>enviRule consists of three modules, namely reaction clusterer, rule generator, and reaction adder, which work closely together to generate and update automatic rules. Reactions are first clustered in reaction clusterer based on reaction centers, then rule generator produces automatic rules for each reaction cluster. When new reactions are added, reaction adder identifies existing rules to be updated and new rules to be created. A schematic overview of enviRule can be found in <xref rid="btad407-F1" ref-type="fig">Fig. 1</xref>. SMARTScompareViewer <xref rid="btad407-B9" ref-type="bibr"> (Ehmki <italic toggle="yes">et al.</italic>, 2019; </xref><xref rid="btad407-B31" ref-type="bibr">Schmidt <italic toggle="yes">et al.</italic>, 2019) </xref> was used to visualize reactions and SMARTS.</p>
      <fig position="float" id="btad407-F1">
        <label>Figure 1.</label>
        <caption>
          <p>Overview of enviRule. Reactions are first sent to the Reaction Clusterer to calculate reaction fingerprints, which are then used to cluster reactions into different groups. The Rule Generator automatically extract rules from clustered groups. Clustered groups can also be expanded with new reactions that have the same reaction fingerprints, and corresponding rules are updated.</p>
        </caption>
        <graphic xlink:href="btad407f1" position="float"/>
      </fig>
      <sec>
        <title>2.2.1 Module 1: Reaction clusterer</title>
        <p>Reaction clusterer was designed to avoid redundancy in generating automatic rules. Reactions with the same reaction centers are clustered into the same group with the goal of finding one generalized rule for each group in the next step. Reaction clusterer applies the Reaction Decoder Tool (RDT) for calculating AAM and bond changes (<xref rid="btad407-B27" ref-type="bibr">Rahman <italic toggle="yes">et al.</italic> 2016</xref>). The algorithms have been previously reported in EC-BLAST and are now available in RDT (<xref rid="btad407-B26" ref-type="bibr">Rahman <italic toggle="yes">et al.</italic> 2014</xref>). Adapted from EC-BLAST, comprehensive reaction fingerprints are created in reaction clusterer to measure reaction similarities. Chemical bonds and atoms in the reaction centers of substrates and products are encoded into multiple fingerprints: a bond formation/cleavage fingerprint, a bond-change fingerprint, which contains all the bonds with changed orders, and a set of reaction-center fingerprints, representing atoms in reaction centers. The reaction centers defined in reaction clusterer include changed atoms and bonds, as well as whole functional groups if any parts of a predefined set of functional groups are involved in reactions. The list of functional groups was adapted from a tool for predicting chemical reaction outcomes with machine learning (<xref rid="btad407-B2" ref-type="bibr">Coley <italic toggle="yes">et al.</italic> 2017</xref>). Since the Tanimoto coefficient has been widely accepted for calculating the similarity of bit-strings (<xref rid="btad407-B15" ref-type="bibr">Holliday <italic toggle="yes">et al.</italic> 2002</xref>), it is used as the indicator of reaction similarity in reaction clusterer. Only if the Tanimoto coefficient of reaction fingerprints is 1.0, two reactions are clustered into the same group. The reaction fingerprints of each clustered group are stored for further comparison when new reactions are added through reaction adder. In this project, only reaction groups with at least two reactions were sent to rule generator for automatic rule generation.</p>
      </sec>
      <sec>
        <title>2.2.2 Module 2: Rule generator</title>
        <p>In the rule generator, reaction centers are expanded by the breadth first search (BFS) algorithm with adjustable diameters to include neighboring bonds and atoms (i.e. substituents). Rule generator was developed with RDT and CDK. It automatically generates SMIRKS rules (<ext-link xlink:href="http://www.daylight.com/dayhtml/doc/theory/theory.smirks.html" ext-link-type="uri">http://www.daylight.com/dayhtml/doc/theory/theory.smirks.html</ext-link>) for each of the reaction groups. In the enviPath prediction system, each rule has a classifier that requires training. To decrease the sparsity of the training data of classifiers, classifiers are built for composite rules. Each composite rule represents one reaction group and may comprise of one or several simple rules extracted from the reactions present in this group. Without a combination strategy, the number of simple rules in a composite rule should equal the number of reactions in the corresponding group. Here, we aimed to minimize the number of simple rules in each composite rule as follows to control redundancy. To minimize the number of rules inside a composite rule we use graph combination to integrate substrates of different reactions without producing unobserved combinations of substituents (i.e. <xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S2</xref>), thus avoiding over-generalization of rules. After initializing each substrate as a graph with its original reaction center as backbone and substituents as leaf nodes (<xref rid="btad407-F2" ref-type="fig">Fig. 2</xref>), graphs are combined only (i.e. <xref rid="btad407-F2" ref-type="fig">Fig. 2a–c</xref>) when no connections are created between two substituents that do not co-exist in any reaction (e.g. substituent S_A1 and substituent S_B2 in <xref rid="btad407-F2" ref-type="fig">Fig. 2d</xref>). Graphs are translated into SMARTS after combination.</p>
        <fig position="float" id="btad407-F2">
          <label>Figure 2.</label>
          <caption>
            <p>Schematic view of substrate combination. Solid annotated circles are atoms in a reaction center, while dashed annotated circles are substituents. This figure demonstrates the graph combination for a group with two reactions. Four cases are distinguished (a–d) based on whether substituents (S) attached to either atom in the reaction center are equal or not. The left side shows the substrates of two simple rules extracted from the two reactions, and the right side shows three plausible (i.e. a–c) and one incorrect (i.e. d) combined forms of the substrates. Colored lines (i.e. the red and blue lines) in (d) denote unobserved combinations of substituents. In case d, the two reactions cannot be combined into one rule (see also <xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S2</xref> for another concrete example).</p>
          </caption>
          <graphic xlink:href="btad407f2" position="float"/>
        </fig>
      </sec>
      <sec>
        <title>2.2.2 Module 3: Reaction adder</title>
        <p>When new reactions are available, similarly to reaction clusterer, reaction adder clusters them into different groups. In addition, it compares the fingerprints of new reactions with the previously stored fingerprints of reaction groups and adds new reactions into existing reaction groups if the Tanimoto coefficient of their fingerprints is 1.0, otherwise puts them into new groups. Rule generator will be applied on those expanded groups, with existing and new reactions, to produce updated rules that are generalized to cover newly added reactions. For new reactions that cannot be added into any of the existing reaction groups, new rules will be generated by rule generator.</p>
      </sec>
    </sec>
    <sec>
      <title>2.3 Machine learning models for pathway predictions</title>
      <p>Pathway prediction was reduced to a multi-label classification problem in enviPath. The goal is to iteratively predict which rules (i.e. labels) are correctly triggered on a compound and then on its predicted TPs. enviPath used to solve multi-label classification with a binary relevance method (BM) by building independent classifiers for each rule (<xref rid="btad407-B39" ref-type="bibr">Wicker <italic toggle="yes">et al.</italic> 2010</xref>). Later, BM was replaced by an ensemble chain classifier (ECC) to take the correlation of these classifiers into consideration (<xref rid="btad407-B28" ref-type="bibr">Read <italic toggle="yes">et al.</italic> 2011</xref>). ECC models are implemented with MEKA (<xref rid="btad407-B29" ref-type="bibr">Read <italic toggle="yes">et al.</italic> 2016</xref>), which is a multi-label extension of the WEKA machine learning tool (<xref rid="btad407-B42" ref-type="bibr">Witten and Frank 2002</xref>).</p>
      <p>To prepare the training data for ECC models, each compound is represented as a vector consisting of 192 MACCS (Molecular ACCess System) structural fingerprints (<xref rid="btad407-B8" ref-type="bibr">Durant <italic toggle="yes">et al.</italic> 2002</xref>) and rules that are encoded into a binary string. For training the classifier of a rule, if this rule is triggered on a compound and resulting products are observed in the biotransformation reactions in the dataset, this compound is taken as a positive sample (PS). Conversely, if the rule is triggered but products cannot be observed, this compound is a negative sample (NS).</p>
    </sec>
    <sec>
      <title>2.4 Performance evaluation</title>
      <sec>
        <title>2.4.1 Genericity of automatic rules</title>
        <p>The range of compounds a rule can be triggered on depends on how specific this rule is. This characteristic of a rule is also called genericity and is evaluated as follows:
where NS represents the number of negative samples used for training the classifier of a rule, while PS stands for the number of positive samples. Genericity, i.e. the ratio of negative to positive samples, significantly affects the training of models and their prediction performance. A specific genericity of a rule can be achieved in rule generator by iteratively adjusting the diameters for the extension of reaction centers or by adding explicit hydrogens. To achieve a genericity target value, a rule is iteratively adjusted and evaluated against all the training compounds to count the number of negative samples and positive samples, until the ratio is as close as possible to the target genericity. For example, if the current genericity of a rule is greater than the target genericity, either extension diameters will be increased or explicit hydrogens will be added by the rule generator to generate a more specific version of this rule, and vice versa.</p>
        <disp-formula id="E1">
          <label>(1)</label>
          <mml:math id="M1" display="block" overflow="scroll">
            <mml:mtable>
              <mml:mtr>
                <mml:mtd>
                  <mml:mrow>
                    <mml:maligngroup/>
                    <mml:mi mathvariant="normal">G</mml:mi>
                    <mml:mi mathvariant="normal">e</mml:mi>
                    <mml:mi mathvariant="normal">n</mml:mi>
                    <mml:mi mathvariant="normal">e</mml:mi>
                    <mml:mi mathvariant="normal">r</mml:mi>
                    <mml:mi mathvariant="normal">i</mml:mi>
                    <mml:mi mathvariant="normal">c</mml:mi>
                    <mml:mi mathvariant="normal">i</mml:mi>
                    <mml:mi mathvariant="normal">t</mml:mi>
                    <mml:mi mathvariant="normal">y</mml:mi>
                    <mml:mo>=</mml:mo>
                    <mml:mrow>
                      <mml:mfrac>
                        <mml:mrow>
                          <mml:mi mathvariant="normal">NS</mml:mi>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mi mathvariant="normal">PS</mml:mi>
                        </mml:mrow>
                      </mml:mfrac>
                    </mml:mrow>
                  </mml:mrow>
                </mml:mtd>
              </mml:mtr>
            </mml:mtable>
          </mml:math>
        </disp-formula>
        <p>The optimum genericity of rules in this project was determined for the task of contaminant pathway prediction using the enviPath pathway prediction system. Specifically, prediction models were trained on 80%of data with 6 sets of automatic rules whose genericities were predefined at different genericity levels of 0, 1, 5, 10, 20, and 50. The genericity corresponding to the model yielding the highest predicted probabilities for the experimentally observed products in the remaining 20% test reactions is selected as optimum genericity. Once the optimum genericity is determined, extension diameters and explicit hydrogens for each rule can be adjusted as explained.</p>
      </sec>
      <sec>
        <title>2.4.2 Single-gen evaluation of pathway prediction</title>
        <p>Single-gen evaluation was performed at reaction level to compare the prediction performance of models trained with automatic rules and manually curated rules. For performance evaluation, we calculated precision and recall (<xref rid="E2" ref-type="disp-formula">Equations 2</xref> and <xref rid="E3" ref-type="disp-formula">3</xref>).
where TP and FP represent the numbers of correctly predicted and falsely predicted transformation products, respectively. It should be noted that FN only represents the transformation products documented in the dataset that cannot be predicted by models, which might be an underestimation relative to the true situation due to limitations of the analytical method used for transformation product detection. 80% of compounds were chosen to train models, while the remaining 20% were selected for testing. The evaluation was repeated 100 times for an unbiased examination of how well the model can predict new data not included during training.</p>
        <disp-formula id="E2">
          <label>(2)</label>
          <mml:math id="M2" display="block" overflow="scroll">
            <mml:mtable>
              <mml:mtr>
                <mml:mtd>
                  <mml:mrow>
                    <mml:maligngroup/>
                    <mml:mi mathvariant="normal">P</mml:mi>
                    <mml:mi mathvariant="normal">r</mml:mi>
                    <mml:mi mathvariant="normal">e</mml:mi>
                    <mml:mi mathvariant="normal">c</mml:mi>
                    <mml:mi mathvariant="normal">i</mml:mi>
                    <mml:mi mathvariant="normal">s</mml:mi>
                    <mml:mi mathvariant="normal">i</mml:mi>
                    <mml:mi mathvariant="normal">o</mml:mi>
                    <mml:mi mathvariant="normal">n</mml:mi>
                    <mml:mo>=</mml:mo>
                    <mml:mrow>
                      <mml:mfrac>
                        <mml:mrow>
                          <mml:mi mathvariant="normal">TP</mml:mi>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mi mathvariant="normal">TP</mml:mi>
                          <mml:mo>+</mml:mo>
                          <mml:mi mathvariant="normal">FP</mml:mi>
                        </mml:mrow>
                      </mml:mfrac>
                    </mml:mrow>
                  </mml:mrow>
                </mml:mtd>
              </mml:mtr>
            </mml:mtable>
          </mml:math>
        </disp-formula>
        <disp-formula id="E3">
          <label>(3)</label>
          <mml:math id="M3" display="block" overflow="scroll">
            <mml:mtable>
              <mml:mtr>
                <mml:mtd>
                  <mml:mrow>
                    <mml:maligngroup/>
                    <mml:mi mathvariant="normal">R</mml:mi>
                    <mml:mi mathvariant="normal">e</mml:mi>
                    <mml:mi mathvariant="normal">c</mml:mi>
                    <mml:mi mathvariant="normal">a</mml:mi>
                    <mml:mi mathvariant="normal">l</mml:mi>
                    <mml:mi mathvariant="normal">l</mml:mi>
                    <mml:mo>=</mml:mo>
                    <mml:mrow>
                      <mml:mfrac>
                        <mml:mrow>
                          <mml:mi mathvariant="normal">TP</mml:mi>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mi mathvariant="normal">TP</mml:mi>
                          <mml:mo>+</mml:mo>
                          <mml:mi mathvariant="normal">FN</mml:mi>
                        </mml:mrow>
                      </mml:mfrac>
                    </mml:mrow>
                  </mml:mrow>
                </mml:mtd>
              </mml:mtr>
            </mml:mtable>
          </mml:math>
        </disp-formula>
      </sec>
      <sec>
        <title>2.4.3 Multi-gen evaluation of pathway prediction</title>
        <p>Multi-gen evaluation was proposed in a previous study (<xref rid="btad407-B37" ref-type="bibr">Tam <italic toggle="yes">et al.</italic> 2021</xref>) and used to evaluate prediction performance for whole pathways. In multi-gen evaluation, transformation products emerging after several generations are assigned reduced weights when calculating precision and recall because they have higher uncertainties. In addition, intermediate predicted transformation products that are not observed in the dataset are not punished as false positives if they lead to correct downstream products. Different from the previously reported version of multi-gen evaluation, in this study, unobserved products created along with correct products from the same reactions, e.g. in an oxidative cleavage or hydrolysis reaction, were not punished as false positives. This modification will result in higher precision values compared to the original version of the multi-gen algorithm. Similar to single-gen evaluation, models were trained on 80% of compounds and tested on the rest, which was repeated 100 times.</p>
      </sec>
    </sec>
  </sec>
  <sec>
    <title>3 Results and discussion</title>
    <sec>
      <title>3.1 Automatic rules</title>
      <p><xref rid="btad407-F3" ref-type="fig">Figure 3</xref> shows the averaged probabilities of test reactions predicted by models trained with different sets of automatic rules adjusted to predefined genericity levels. High averaged probabilities indicate a high confidence of the thus trained models for the test reactions. Since all test reactions were actually experimentally observed, the genericity yielding models with highest averaged probabilities for test reactions is preferred. Among the six predefined genericities, the model trained with automatic rules generated at a genericity level of five resulted in the highest averaged probability. Hence, five was determined as the optimum genericity level for automatic rule generation and used in all the subsequent steps.</p>
      <fig position="float" id="btad407-F3">
        <label>Figure 3.</label>
        <caption>
          <p>Averaged predicted probabilities of test reactions for predefined genericity levels used in automatic rule extraction. Error bars are calculated with the results from five different train and test splits (see also <xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S1</xref>).</p>
        </caption>
        <graphic xlink:href="btad407f3" position="float"/>
      </fig>
      <p>Using the optimized genericity level of 5, 143 automatic rules were extracted using the reaction data provided in the EAWAG-BBD package. They successfully covered 826 of 1132 target biotransformation reactions (73.0% coverage), while the previously 208 manually designed rules used in Eawag-BBD (<xref rid="btad407-B13" ref-type="bibr">Gao <italic toggle="yes">et al.</italic> 2010</xref>) and transferred into the enviPath EAWAG-BBD package, known as btrules, covered 745 reactions (65.8% coverage). The reactions covered by the two sets of rules showed a significant overlap. 641 reactions can be concurrently covered by 96 automatic rules and 116 btrules, implying that more than 86% reactions covered by btrules can also be covered by automatic rules. 86 out of 116 btrules share reactions with only one automatic rule, which is a one-to-one relationship. Manual rules with a one-to-one relationship can have almost the same form as their corresponding automatic rule, which is, e.g. the case for the hydrolysis rule for nitroesters, i.e. bt0058 and automatic rule-116 (<xref rid="btad407-F4" ref-type="fig">Fig. 4</xref>). The only difference is the carbon connected to the oxygen atom in the reaction center of rule-116 cannot be quaternary, while in bt0058 it can be any carbon. However, since the genericities of manual rules are not explicitly regulated but the genericities of automatic rules are adjusted to be close to 5, btrules and corresponding automatic rules might differ in their specification of neighboring groups, even though the reaction centers are the same. As a result, btrules can have higher or lower genericity than their corresponding automatic rule in one-to-one relationships. The hydrolysis rule for phosphate/thiophosphate esters, i.e. bt0361 (genericity = 8.20), for instance, has a higher genericity than the corresponding automatic rule-87 (genericity = 5.20), while the rule for reduction of nitro groups to amino groups, i.e. bt0080 (genericity = 2.25), has lower genericity than the corresponding automatic rule-44 (genericity = 5.11) (<xref rid="btad407-F4" ref-type="fig">Fig. 4</xref>). In addition to one-to-one relationships, several one-to-many relationships are observed, where the reactions covered by one manual rule are covered by several automatic rules, or the other way around. The reductive dehalogenation rule bt0029, for instance, which removes chloride, bromide, and iodine atoms from aromatic or aliphatic carbons and replaces them with a hydrogen atom, is associated with automatic rule-123, rule-137, and rule-152, which handle the dechlorination of aliphatic carbons, the dechlorination of aromatic carbons, and the debromination of aromatic carbons, respectively (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S3</xref>). None of the automatic rules covers the debromination of aliphatic carbons or deiodination in general because such reactions are not present in the EAWAG-BBD package. Conversely, reactions covered by several manual rules can also be covered by only one automatic rule. The rule for oxidation of primary alcohols to aldehydes, i.e. bt0001, for instance, and the rule for oxidation of secondary alcohols to ketone/esters, i.e. bt0002, are combined into the automatic rule-19 (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S4</xref>) because the reaction centers of these two rules are the same, both including a C–O single bond and a C–H bond.</p>
      <fig position="float" id="btad407-F4">
        <label>Figure 4.</label>
        <caption>
          <p>One-to-one relationships of manual btrules and automatic rules. If the substituents of atoms in the reaction centers are similar, automatic rules and manual btrules can have almost the same forms and genericities (a). However, manual btrules can have higher genericities (b) if the substituents are more diverse, or lower genericities (c) if their substituents are less diverse, while the genericities of automatic rules remain stable.</p>
        </caption>
        <graphic xlink:href="btad407f4" position="float"/>
      </fig>
      <p>For automatic rule updates, firstly, the 143 automatic rules extracted from the EAWAG-BBD reactions were applied to the EAWAG-SOIL reactions. 1118 of 2447 EAWAG-SOIL reactions could not be covered by any of the initial set of 143 automatic rules extracted from EAWAG-BBD and were therefore used for the rule updates. Automatic rules that had the same reaction centers as one or several uncovered reactions were automatically adapted to include the newly introduced substituents. For example, the substructure [CH](-[C])-[CH3] was added as a possible neighboring group of the carbon atom in the reaction center of automatic rule-326 to cover the reaction 0000154 in the EAWAG-SOIL package (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S5</xref>). Upon rule updating, 38 out of the 143 original automatic rules were changed and 100 new rules were created, resulting in an updated rule set including 243 automatic rules in total. With this updated set of rules, the number of not covered EAWAG-SOIL reactions dropped from 1118 to 542.</p>
    </sec>
    <sec>
      <title>3.2 Evaluation of models with automatic rules extracted from EAWAG-BBD</title>
      <p>In <xref rid="btad407-F5" ref-type="fig">Fig. 5a</xref>, results for single-gen evaluation for models generated with the original, manually extracted btrules and the newly generated automatic rules are given. Automatic rules cannot reach the same maximum precision as btrules at the highest probability threshold, but their advantages in coverage become salient at lower thresholds. The area under the curve (AUC) scores of the model trained with manual btrules and the model trained with automatic rules are 0.30 and 0.39, respectively, suggesting a better overall performance at reaction level for the model trained with the automatic rules, primarily due to the gain in recall. Similar results can be observed in models trained with more evenly split (i.e. 60%/40% and 70%/30%) train/test data (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S7</xref>).</p>
      <fig position="float" id="btad407-F5">
        <label>Figure 5.</label>
        <caption>
          <p>Performance of models with the EAWAG-BBD reactions in (a) single-gen evaluation and (b) multi-gen evaluation.</p>
        </caption>
        <graphic xlink:href="btad407f5" position="float"/>
      </fig>
      <p>The results of multi-gen evaluation at pathway level are visualized in <xref rid="btad407-F5" ref-type="fig">Fig. 5b</xref>. AUC values for multi-gen evaluation, i.e. evaluation at pathway level, are generally lower than for single-gen evaluation because downstream reactions will never get a chance to be predicted if upstream reactions cannot be predicted, making it more challenging to obtain a high recall. Yet, similar to single-gen evaluation, the AUC score of the model trained with manual btrules (0.19) is lower than of the model trained with automatic rules (0.21), supporting the superior performance of the automatic rules over the manually curated ones at pathway level. The increase in AUC is also mainly caused by the high recall of automatic-rule-trained models.</p>
    </sec>
    <sec>
      <title>3.3 Evaluation of models with automatic rules updated with EAWAG-SOIL</title>
      <p>Both manual btrules and automatic rules extracted from the EAWAG-BBD reactions failed to generalize well for the prediction of the EAWAG-SOIL data. According to the single-gen evaluation results shown in <xref rid="btad407-F6" ref-type="fig">Fig. 6a</xref>, the AUC scores for the models trained with btrules and automatic rules and evaluated on the EAWAG-SOIL reactions were 0.19 and 0.20, respectively, which is substantially lower than the AUC scores in the single-gen evaluation of the two models trained and evaluated on the EAWAG-BBD reactions. After rule updating, an AUC score of 0.35 was achieved by the model trained with the updated automatic rules, suggesting a considerable improvement in the performance of the model with the set of updated rules.</p>
      <fig position="float" id="btad407-F6">
        <label>Figure 6.</label>
        <caption>
          <p>(a) Single-gen evaluation and (b) multi-gen evaluation of models against the EAWAG-SOIL reactions for three sets of rules, i.e. manually curated rules (btrules), automatic rules extracted from EAWAG-BBD data (auto rules), and automatic rules updated with EAWAG-SOIL data (updated auto rules).</p>
        </caption>
        <graphic xlink:href="btad407f6" position="float"/>
      </fig>
      <p>Results for multi-gen evaluation again agreed with results for single-gen evaluation (<xref rid="btad407-F6" ref-type="fig">Fig. 6b</xref>). The difference between the AUC scores for the model trained with btrules (0.13) and the model trained with automatic rules extracted from the EAWAG-BBD reactions (0.12) was tiny when evaluated against the EAWAG-SOIL data. Yet, as a consequence of the good coverage of the EAWAG-SOIL reactions by updated automatic rules, the AUC score (0.20) for the model trained with updated automatic rules improved, largely due to the increase in recall.</p>
    </sec>
    <sec>
      <title>3.4 Benchmarking against other automatic rules</title>
      <p>To enable benchmarking the performance of our automatic rules against external automatic rule sets, the single-gen evaluation was implemented with RDKit and Meka wrapper in Scikit-multilearn Python package. We compared the single-gen evaluation results on the EAWAG-BBD package for the models trained with automatic rules extracted from the EAWAG-BBD reactions and the automatic rules extracted from MetaCyc dataset (<xref rid="btad407-B24" ref-type="bibr">Ni <italic toggle="yes">et al.</italic> 2021</xref>). MetaCyc is a comprehensive database that contains metabolic pathways and enzymes from various domains of life, including environmental bacteria like Nitrospirae and Planctomycetes (<xref rid="btad407-B1" ref-type="bibr">Caspi <italic toggle="yes">et al.</italic> 2018</xref>). Since all the biotransformation reactions in the EAWAG-BBD package are decomposition reactions, i.e. one substrate reacting to one or several products, only the 255 decomposition rules were selected from the 2318 MetaCyc auto rules for the comparison. Although MetaCyc auto rules showed good generalization for KEGG and BRENDA reactions (<xref rid="btad407-B24" ref-type="bibr">Ni <italic toggle="yes">et al.</italic> 2021</xref>), the 255 MetaCyc decomposition rules could only cover 342 of 1132 EAWAG-BBD reactions (30.2% coverage). This most likely is the main reason also for the low AUC score of 0.11 of the prediction model trained with MetaCyc auto rules (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S6</xref>).</p>
    </sec>
  </sec>
  <sec>
    <title>4 Conclusion</title>
    <p>enviRule is proposed as an efficient tool for automatic extraction of reaction rules, required for rule-based biotransformation pathway prediction systems, from biotransformation reactions. In contrast to manual rules, automatic rules are extracted in a more thorough, data-driven approach and therefore no biotransformation reaction is overlooked. While this approach achieves a higher coverage of reactions compared to the previously used, manually curated rules, the genericity of rules is well controlled, and the number of rules is carefully minimized by a graph combination algorithm without over-generalization. We demonstrated that the optimum genericity of rules for the specific task of contaminant pathway prediction could be determined by comparing the predicted probabilities of test reactions from enviPath prediction models trained with rule sets that have different genericities. This optimum genericity of rules is expected to not change significantly when reactions from a similar domain are added (see, e.g. the predicted probabilities for the combined set of EAWAG-BBD and EAWAG-SOIL reactions in <xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S8</xref>). enviRule also allows streamlined, computationally efficient rule adaption when new reaction information is obtained, focusing only on rules that need to be updated and rules that need to be newly created, instead of running rule extraction all over again for existing and new reactions. The experimental results show that the improvement in recall for the models trained with automatic rules leads to a significant increase in the overall performance of TP prediction, compared with the models trained with manually curated rules.</p>
    <p>Despite the remarkable achievements of enviRule, the limitations should also be noticed. Among the reaction groups clustered by the rule clusterer module of enviRule, 722 of them only have single instances. They are considered too unique for rule extraction, and hence they are skipped in the rule generator. However, some of them could contain important rules, and, upon enrichment of our reaction datasets with additional reactions, eventually more reactions might be clustered into them. For example, we are missing a rule for reductive debromination of aliphatic carbons because there are not enough examples of that type of reaction in EAWAG-BBD and EAWAG-SOIL reaction databases. One option to populate reaction clusters with additional reactions would be to augment our reaction databases with reactions from enzyme databases such as BRENDA and KEGG. However, it remains unclear which of these reactions would be observed under environmentally relevant conditions, and therefore the meaningfulness of such an approach must be carefully evaluated.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material id="sup1" position="float" content-type="local-data">
      <label>btad407_Supplementary_Data</label>
      <media xlink:href="btad407_supplementary_data.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <sec>
    <title>Supplementary data</title>
    <p><xref rid="sup1" ref-type="supplementary-material">Supplementary data</xref> are available at <italic toggle="yes">Bioinformatics</italic> online.</p>
  </sec>
  <sec sec-type="COI-statement">
    <title>Conflict of interest</title>
    <p>None declared.</p>
  </sec>
  <sec>
    <title>Funding</title>
    <p>This work was supported by the European Union’s H2020 research and innovation program under the Marie Sklodowska-Curie grant agreement MSCA-ITN-H2020 [956496] and was subordinate to the project: Academia Network for RevIsing and Advancing the Assessment of the Soil Microbial Toxicity of Pesticides (ARISTO).</p>
  </sec>
  <sec sec-type="data-availability">
    <title>Data availability</title>
    <p>The automatically extracted rules underlying this article, as well as 255 decomposition rules extracted from MetaCyc dataset (<xref rid="btad407-B24" ref-type="bibr">Ni <italic toggle="yes">et al.</italic> 2021</xref>), are available at online repositories (<ext-link xlink:href="https://github.com/zhangky12/enviRule" ext-link-type="uri">https://github.com/zhangky12/enviRule</ext-link>), and the reaction data used for rule extraction is available on <ext-link xlink:href="https://envipath.org/" ext-link-type="uri">https://envipath.org/</ext-link>.</p>
  </sec>
  <ref-list id="ref1">
    <title>References</title>
    <ref id="btad407-B1">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Caspi</surname><given-names>R</given-names></string-name>, <string-name><surname>Billington</surname><given-names>R</given-names></string-name>, <string-name><surname>Fulcher</surname><given-names>CA</given-names></string-name></person-group><etal>et al</etal><article-title>The MetaCyc database of metabolic pathways and enzymes</article-title>. <source>Nucleic Acids Res</source><year>2018</year>;<volume>46</volume>:<fpage>D633</fpage>–<lpage>9</lpage>.<pub-id pub-id-type="pmid">29059334</pub-id></mixed-citation>
    </ref>
    <ref id="btad407-B2">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Coley</surname><given-names>CW</given-names></string-name>, <string-name><surname>Barzilay</surname><given-names>R</given-names></string-name>, <string-name><surname>Jaakkola</surname><given-names>TS</given-names></string-name></person-group><etal>et al</etal><article-title>Prediction of organic reaction outcomes using machine learning</article-title>. <source>ACS Cent Sci</source><year>2017</year>;<volume>3</volume>:<fpage>434</fpage>–<lpage>43</lpage>.<pub-id pub-id-type="pmid">28573205</pub-id></mixed-citation>
    </ref>
    <ref id="btad407-B3">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Cwiertny</surname><given-names>DM</given-names></string-name>, <string-name><surname>Snyder</surname><given-names>SA</given-names></string-name>, <string-name><surname>Schlenk</surname><given-names>D</given-names></string-name></person-group><etal>et al</etal><article-title>Environmental designer drugs: when transformation may not eliminate risk</article-title>. <source>Environ Sci Technol</source><year>2014</year>;<volume>48</volume>:<fpage>11737</fpage>–<lpage>45</lpage>.<pub-id pub-id-type="pmid">25216024</pub-id></mixed-citation>
    </ref>
    <ref id="btad407-B4">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>de Lorenzo</surname><given-names>V.</given-names></string-name></person-group><article-title>Systems biology approaches to bioremediation</article-title>. <source>Curr Opin Biotechnol</source><year>2008</year>;<volume>19</volume>:<fpage>579</fpage>–<lpage>89</lpage>.<pub-id pub-id-type="pmid">19000761</pub-id></mixed-citation>
    </ref>
    <ref id="btad407-B5">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Ding</surname><given-names>S</given-names></string-name>, <string-name><surname>Tian</surname><given-names>Y</given-names></string-name>, <string-name><surname>Cai</surname><given-names>P</given-names></string-name></person-group><etal>et al</etal><article-title>novoPathFinder: a webserver of designing novel-pathway with integrating GEM-model</article-title>. <source>Nucleic Acids Res</source><year>2020</year>;<volume>48</volume>:<fpage>W477</fpage>–<lpage>87</lpage>.<pub-id pub-id-type="pmid">32313937</pub-id></mixed-citation>
    </ref>
    <ref id="btad407-B6">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Djoumbou-Feunang</surname><given-names>Y</given-names></string-name>, <string-name><surname>Fiamoncini</surname><given-names>J</given-names></string-name>, <string-name><surname>Gil-de-la-Fuente</surname><given-names>A</given-names></string-name></person-group><etal>et al</etal><article-title>BioTransformer: a comprehensive computational tool for small molecule metabolism prediction and metabolite identification</article-title>. <source>J Cheminform</source><year>2019</year>;<volume>11</volume>:<fpage>2</fpage>–<lpage>25</lpage>.<pub-id pub-id-type="pmid">30612223</pub-id></mixed-citation>
    </ref>
    <ref id="btad407-B7">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Duigou</surname><given-names>T</given-names></string-name>, <string-name><surname>Du Lac</surname><given-names>M</given-names></string-name>, <string-name><surname>Carbonell</surname><given-names>P</given-names></string-name></person-group><etal>et al</etal><article-title>RetroRules: a database of reaction rules for engineering biology</article-title>. <source>Nucleic Acids Res</source><year>2019</year>;<volume>47</volume>:<fpage>D1229</fpage>–<lpage>35</lpage>.<pub-id pub-id-type="pmid">30321422</pub-id></mixed-citation>
    </ref>
    <ref id="btad407-B8">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Durant</surname><given-names>JL</given-names></string-name>, <string-name><surname>Leland</surname><given-names>BA</given-names></string-name>, <string-name><surname>Henry</surname><given-names>DR</given-names></string-name></person-group><etal>et al</etal><article-title>Reoptimization of MDL keys for use in drug discovery</article-title>. <source>J Chem Inf Comput Sci</source><year>2002</year>;<volume>42</volume>:<fpage>1273</fpage>–<lpage>80</lpage>.<pub-id pub-id-type="pmid">12444722</pub-id></mixed-citation>
    </ref>
    <ref id="btad407-B9">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Ehmki</surname><given-names>ESR</given-names></string-name>, <string-name><surname>Schmidt</surname><given-names>R</given-names></string-name>, <string-name><surname>Ohm</surname><given-names>F</given-names></string-name></person-group><etal>et al</etal><article-title>Comparing molecular patterns using the example of SMARTS: applications and filter collection analysis</article-title>. <source>J Chem Inf Model</source><year>2019</year>;<volume>59</volume>:<fpage>2572</fpage>–<lpage>86</lpage>.<pub-id pub-id-type="pmid">31125225</pub-id></mixed-citation>
    </ref>
    <ref id="btad407-B10">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Ellis</surname><given-names>LB</given-names></string-name>, <string-name><surname>Hershberger</surname><given-names>CD</given-names></string-name>, <string-name><surname>Wackett</surname><given-names>LP</given-names></string-name></person-group><etal>et al</etal><article-title>The University of Minnesota Biocatalysis/Biodegradation Database: specialized metabolism for functional genomics</article-title>. <source>Nucleic Acids Res</source><year>1999</year>;<volume>27</volume>:<fpage>373</fpage>–<lpage>6</lpage>.<pub-id pub-id-type="pmid">9847233</pub-id></mixed-citation>
    </ref>
    <ref id="btad407-B11">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Ellis</surname><given-names>LBM</given-names></string-name>, <string-name><surname>Roe</surname><given-names>D</given-names></string-name>, <string-name><surname>Wackett</surname><given-names>LP</given-names></string-name></person-group><etal>et al</etal><article-title>The University of Minnesota Biocatalysis/Biodegradation Database: the first decade</article-title>. <source>Nucleic Acids Res</source><year>2006</year>;<volume>34</volume>:<fpage>D517</fpage>–<lpage>21</lpage>.<pub-id pub-id-type="pmid">16381924</pub-id></mixed-citation>
    </ref>
    <ref id="btad407-B12">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Funke</surname><given-names>J</given-names></string-name>, <string-name><surname>Prasse</surname><given-names>C</given-names></string-name>, <string-name><surname>Ternes</surname><given-names>TA</given-names></string-name></person-group><etal>et al</etal><article-title>Identification of transformation products of antiviral drugs formed during biological wastewater treatment and their occurrence in the urban water cycle</article-title>. <source>Water Res</source><year>2016</year>;<volume>98</volume>:<fpage>75</fpage>–<lpage>83</lpage>.<pub-id pub-id-type="pmid">27082694</pub-id></mixed-citation>
    </ref>
    <ref id="btad407-B13">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Gao</surname><given-names>J</given-names></string-name>, <string-name><surname>Ellis</surname><given-names>LBM</given-names></string-name>, <string-name><surname>Wackett</surname><given-names>LP</given-names></string-name></person-group><etal>et al</etal><article-title>The University of Minnesota Biocatalysis/Biodegradation Database: improving public access</article-title>. <source>Nucleic Acids Res</source><year>2010</year>;<volume>38</volume>:<fpage>D488</fpage>–<lpage>91</lpage>.<pub-id pub-id-type="pmid">19767608</pub-id></mixed-citation>
    </ref>
    <ref id="btad407-B14">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Helbling</surname><given-names>DE</given-names></string-name>, <string-name><surname>Hollender</surname><given-names>J</given-names></string-name>, <string-name><surname>Kohler</surname><given-names>H-PE</given-names></string-name></person-group><etal>et al</etal><article-title>High-throughput identification of microbial transformation products of organic micropollutants</article-title>. <source>Environ Sci Technol</source><year>2010</year>;<volume>44</volume>:<fpage>6621</fpage>–<lpage>7</lpage>.<pub-id pub-id-type="pmid">20799730</pub-id></mixed-citation>
    </ref>
    <ref id="btad407-B15">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Holliday</surname><given-names>JD</given-names></string-name></person-group><etal>et al</etal><article-title>Grouping of coefficients for the calculation of inter-molecular similarity and dissimilarity using 2D fragment bit-strings</article-title>. <source>Comb Chem High Throughput Screen</source><year>2002</year>;<volume>5</volume>:<fpage>155</fpage>–<lpage>66</lpage>.<pub-id pub-id-type="pmid">11966424</pub-id></mixed-citation>
    </ref>
    <ref id="btad407-B16">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Hubert</surname><given-names>J</given-names></string-name>, <string-name><surname>Nuzillard</surname><given-names>J-M</given-names></string-name>, <string-name><surname>Renault</surname><given-names>J-H</given-names></string-name></person-group><etal>et al</etal><article-title>Dereplication strategies in natural product research: how many tools and methodologies behind the same concept?</article-title><source>Phytochem Rev</source><year>2017</year>;<volume>16</volume>:<fpage>55</fpage>–<lpage>95</lpage>.</mixed-citation>
    </ref>
    <ref id="btad407-B17">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Jeffryes</surname><given-names>JG</given-names></string-name>, <string-name><surname>Colastani</surname><given-names>RL</given-names></string-name>, <string-name><surname>Elbadawi-Sidhu</surname><given-names>M</given-names></string-name></person-group><etal>et al</etal><article-title>MINEs: open access databases of computationally predicted enzyme promiscuity products for untargeted metabolomics</article-title>. <source>J Cheminform</source><year>2015</year>;<volume>7</volume>:<fpage>1</fpage>–<lpage>8</lpage>.<pub-id pub-id-type="pmid">25705261</pub-id></mixed-citation>
    </ref>
    <ref id="btad407-B18">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Kern</surname><given-names>S</given-names></string-name>, <string-name><surname>Baumgartner</surname><given-names>R</given-names></string-name>, <string-name><surname>Helbling</surname><given-names>DE</given-names></string-name></person-group><etal>et al</etal><article-title>A tiered procedure for assessing the formation of biotransformation products of pharmaceuticals and biocides during activated sludge treatment</article-title>. <source>J Environ Monit</source><year>2010</year>;<volume>12</volume>:<fpage>2100</fpage>–<lpage>11</lpage>.<pub-id pub-id-type="pmid">20967365</pub-id></mixed-citation>
    </ref>
    <ref id="btad407-B19">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Latino</surname><given-names>DARS</given-names></string-name>, <string-name><surname>Wicker</surname><given-names>J</given-names></string-name>, <string-name><surname>Gütlein</surname><given-names>M</given-names></string-name></person-group><etal>et al</etal><article-title>Eawag-Soil in enviPath: a new resource for exploring regulatory pesticide soil biodegradation pathways and half-life data</article-title>. <source>Environ Sci Process Impacts</source><year>2017</year>;<volume>19</volume>:<fpage>449</fpage>–<lpage>64</lpage>.<pub-id pub-id-type="pmid">28229138</pub-id></mixed-citation>
    </ref>
    <ref id="btad407-B20">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Li</surname><given-names>C</given-names></string-name>, <string-name><surname>Henry</surname><given-names>CS</given-names></string-name>, <string-name><surname>Jankowski</surname><given-names>MD</given-names></string-name></person-group><etal>et al</etal><article-title>Computational discovery of biochemical routes to specialty chemicals</article-title>. <source>Chem Eng Sci</source><year>2004</year>;<volume>59</volume>:<fpage>5051</fpage>–<lpage>60</lpage>.</mixed-citation>
    </ref>
    <ref id="btad407-B21">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Moermond</surname><given-names>CTA</given-names></string-name>, <string-name><surname>Puhlmann</surname><given-names>N</given-names></string-name>, <string-name><surname>Brown</surname><given-names>AR</given-names></string-name></person-group><etal>et al</etal><article-title>GREENER pharmaceuticals for more sustainable healthcare</article-title>. <source>Environ Sci Technol Lett</source><year>2022</year>;<volume>9</volume>:<fpage>699</fpage>–<lpage>705</lpage>.<pub-id pub-id-type="pmid">36118957</pub-id></mixed-citation>
    </ref>
    <ref id="btad407-B22">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>MohammadiPeyhani</surname><given-names>H</given-names></string-name>, <string-name><surname>Hafner</surname><given-names>J</given-names></string-name>, <string-name><surname>Sveshnikova</surname><given-names>A</given-names></string-name></person-group><etal>et al</etal><article-title>Expanding biochemical knowledge and illuminating metabolic dark matter with ATLASx</article-title>. <source>Nat Commun</source><year>2022</year>;<volume>13</volume>:<fpage>1</fpage>–<lpage>12</lpage>.<pub-id pub-id-type="pmid">34983933</pub-id></mixed-citation>
    </ref>
    <ref id="btad407-B24">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Ni</surname><given-names>Z</given-names></string-name>, <string-name><surname>Stine</surname><given-names>AE</given-names></string-name>, <string-name><surname>Tyo</surname><given-names>KEJ</given-names></string-name></person-group><etal>et al</etal><article-title>Curating a comprehensive set of enzymatic reaction rules for efficient novel biosynthetic pathway design</article-title>. <source>Metab Eng</source><year>2021</year>;<volume>65</volume>:<fpage>79</fpage>–<lpage>87</lpage>.<pub-id pub-id-type="pmid">33662575</pub-id></mixed-citation>
    </ref>
    <ref id="btad407-B25">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Olvera-Vargas</surname><given-names>H</given-names></string-name>, <string-name><surname>Leroy</surname><given-names>S</given-names></string-name>, <string-name><surname>Rivard</surname><given-names>M</given-names></string-name></person-group><etal>et al</etal><article-title>Microbial biotransformation of furosemide for environmental risk assessment: identification of metabolites and toxicological evaluation</article-title>. <source>Environ Sci Pollut Res Int</source><year>2016</year>;<volume>23</volume>:<fpage>22691</fpage>–<lpage>700</lpage>.<pub-id pub-id-type="pmid">27557972</pub-id></mixed-citation>
    </ref>
    <ref id="btad407-B26">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Rahman</surname><given-names>SA</given-names></string-name>, <string-name><surname>Cuesta</surname><given-names>SM</given-names></string-name>, <string-name><surname>Furnham</surname><given-names>N</given-names></string-name></person-group><etal>et al</etal><article-title>EC-BLAST: a tool to automatically search and compare enzyme reactions</article-title>. <source>Nat Methods</source><year>2014</year>;<volume>11</volume>:<fpage>171</fpage>–<lpage>4</lpage>.<pub-id pub-id-type="pmid">24412978</pub-id></mixed-citation>
    </ref>
    <ref id="btad407-B27">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Rahman</surname><given-names>SA</given-names></string-name>, <string-name><surname>Torrance</surname><given-names>G</given-names></string-name>, <string-name><surname>Baldacci</surname><given-names>L</given-names></string-name></person-group><etal>et al</etal><article-title>Reaction decoder tool (RDT): extracting features from chemical reactions</article-title>. <source>Bioinformatics</source><year>2016</year>;<volume>32</volume>:<fpage>2065</fpage>–<lpage>6</lpage>.<pub-id pub-id-type="pmid">27153692</pub-id></mixed-citation>
    </ref>
    <ref id="btad407-B28">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Read</surname><given-names>J</given-names></string-name>, <string-name><surname>Pfahringer</surname><given-names>B</given-names></string-name>, <string-name><surname>Holmes</surname><given-names>G</given-names></string-name></person-group><etal>et al</etal><article-title>Classifier chains for multi-label classification</article-title>. <source>Mach Learn</source><year>2011</year>;<volume>85</volume>:<fpage>333</fpage>–<lpage>59</lpage>.</mixed-citation>
    </ref>
    <ref id="btad407-B29">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Read</surname><given-names>J</given-names></string-name>, <string-name><surname>Reutemann</surname><given-names>P</given-names></string-name>, <string-name><surname>Pfahringer</surname><given-names>B</given-names></string-name></person-group><etal>et al</etal><article-title>Meka: a multi-label/multi-target extension to Weka</article-title>. <source>J Mach Learn Res</source><year>2016</year>;<volume>17</volume>:<fpage>1</fpage>–<lpage>5</lpage>.</mixed-citation>
    </ref>
    <ref id="btad407-B30">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Satoh</surname><given-names>H</given-names></string-name>, <string-name><surname>Hafner</surname><given-names>J</given-names></string-name>, <string-name><surname>Hutter</surname><given-names>J</given-names></string-name></person-group><etal>et al</etal><article-title>Can AI help improve water quality? Towards the prediction of degradation of micropollutants in wastewater</article-title>. <source>Chimia</source><year>2023</year>;<volume>77</volume>:<fpage>48</fpage>.</mixed-citation>
    </ref>
    <ref id="btad407-B31">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Schmidt</surname><given-names>R</given-names></string-name>, <string-name><surname>Ehmki</surname><given-names>ESR</given-names></string-name>, <string-name><surname>Ohm</surname><given-names>F</given-names></string-name></person-group><etal>et al</etal><article-title>Comparing molecular patterns using the example of SMARTS: theory and algorithms</article-title>. <source>J Chem Inf Model</source><year>2019</year>;<volume>59</volume>:<fpage>2560</fpage>–<lpage>71</lpage>.<pub-id pub-id-type="pmid">31120751</pub-id></mixed-citation>
    </ref>
    <ref id="btad407-B32">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Schwaller</surname><given-names>P</given-names></string-name>, <string-name><surname>Laino</surname><given-names>T</given-names></string-name>, <string-name><surname>Gaudin</surname><given-names>T</given-names></string-name></person-group><etal>et al</etal><article-title>Molecular transformer: a model for uncertainty-calibrated chemical reaction prediction</article-title>. <source>ACS Cent Sci</source><year>2019</year>;<volume>5</volume>:<fpage>1572</fpage>–<lpage>83</lpage>.<pub-id pub-id-type="pmid">31572784</pub-id></mixed-citation>
    </ref>
    <ref id="btad407-B33">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Schwaller</surname><given-names>P</given-names></string-name>, <string-name><surname>Probst</surname><given-names>D</given-names></string-name>, <string-name><surname>Vaucher</surname><given-names>AC</given-names></string-name></person-group><etal>et al</etal><article-title>Mapping the space of chemical reactions using attention-based neural networks</article-title>. <source>Nat Mach Intell</source><year>2021a</year>;<volume>3</volume>:<fpage>144</fpage>–<lpage>52</lpage>.</mixed-citation>
    </ref>
    <ref id="btad407-B34">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Schwaller</surname><given-names>P</given-names></string-name>, <string-name><surname>Vaucher</surname><given-names>AC</given-names></string-name>, <string-name><surname>Laino</surname><given-names>T</given-names></string-name></person-group><etal>et al</etal><article-title>Prediction of chemical reaction yields using deep learning</article-title>. <source>Mach Learn Sci Technol</source><year>2021b</year>;<volume>2</volume>:<fpage>015016</fpage>.</mixed-citation>
    </ref>
    <ref id="btad407-B35">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Segler</surname><given-names>MH</given-names></string-name>, <string-name><surname>Waller</surname><given-names>MP.</given-names></string-name></person-group><article-title>Neural‐symbolic machine learning for retrosynthesis and reaction prediction</article-title>. <source>Chemistry</source><year>2017</year>;<volume>23</volume>:<fpage>5966</fpage>–<lpage>71</lpage>.<pub-id pub-id-type="pmid">28134452</pub-id></mixed-citation>
    </ref>
    <ref id="btad407-B36">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Sveshnikova</surname><given-names>A</given-names></string-name>, <string-name><surname>MohammadiPeyhani</surname><given-names>H</given-names></string-name>, <string-name><surname>Hatzimanikatis</surname><given-names>V</given-names></string-name></person-group><etal>et al</etal><article-title>Computational tools and resources for designing new pathways to small molecules</article-title>. <source>Curr Opin Biotechnol</source><year>2022</year>;<volume>76</volume>:<fpage>102722</fpage>.<pub-id pub-id-type="pmid">35483185</pub-id></mixed-citation>
    </ref>
    <ref id="btad407-B37">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Tam</surname><given-names>JYC</given-names></string-name>, <string-name><surname>Lorsbach</surname><given-names>T</given-names></string-name>, <string-name><surname>Schmidt</surname><given-names>S</given-names></string-name></person-group><etal>et al</etal><article-title>Holistic evaluation of biodegradation pathway prediction: assessing multi-step reactions and intermediate products</article-title>. <source>J Cheminform</source><year>2021</year>;<volume>13</volume>:<fpage>1</fpage>–<lpage>14</lpage>.<pub-id pub-id-type="pmid">33407901</pub-id></mixed-citation>
    </ref>
    <ref id="btad407-B38">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Vasileiadis</surname><given-names>S</given-names></string-name>, <string-name><surname>Puglisi</surname><given-names>E</given-names></string-name>, <string-name><surname>Papadopoulou</surname><given-names>ES</given-names></string-name></person-group><etal>et al</etal><article-title>Blame it on the metabolite: 3,5-dichloroaniline rather than the parent compound is responsible for the decreasing diversity and function of soil microorganisms</article-title>. <source>Appl Environ Microbiol</source><year>2018</year>;<volume>84</volume>:<fpage>e01536</fpage>-<lpage>18</lpage>.<pub-id pub-id-type="pmid">30194100</pub-id></mixed-citation>
    </ref>
    <ref id="btad407-B39">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Wicker</surname><given-names>J</given-names></string-name>, <string-name><surname>Fenner</surname><given-names>K</given-names></string-name>, <string-name><surname>Ellis</surname><given-names>L</given-names></string-name></person-group><etal>et al</etal><article-title>Predicting biodegradation products and pathways: a hybrid knowledge- and machine learning-based approach</article-title>. <source>Bioinformatics</source><year>2010</year>;<volume>26</volume>:<fpage>814</fpage>–<lpage>21</lpage>.<pub-id pub-id-type="pmid">20106820</pub-id></mixed-citation>
    </ref>
    <ref id="btad407-B40">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Wicker</surname><given-names>J</given-names></string-name>, <string-name><surname>Lorsbach</surname><given-names>T</given-names></string-name>, <string-name><surname>Gütlein</surname><given-names>M</given-names></string-name></person-group><etal>et al</etal><article-title>enviPath—the environmental contaminant biotransformation pathway resource</article-title>. <source>Nucleic Acids Res</source><year>2016</year>;<volume>44</volume>:<fpage>D502</fpage>–<lpage>8</lpage>.<pub-id pub-id-type="pmid">26582924</pub-id></mixed-citation>
    </ref>
    <ref id="btad407-B41">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Wishart</surname><given-names>DS</given-names></string-name>, <string-name><surname>Tian</surname><given-names>S</given-names></string-name>, <string-name><surname>Allen</surname><given-names>D</given-names></string-name></person-group><etal>et al</etal><article-title>BioTransformer 3.0—a web server for accurately predicting metabolic transformation products</article-title>. <source>Nucleic Acids Res</source><year>2022</year>;<volume>50</volume>:<fpage>W115</fpage>–<lpage>23</lpage>.<pub-id pub-id-type="pmid">35536252</pub-id></mixed-citation>
    </ref>
    <ref id="btad407-B42">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Witten</surname><given-names>IH</given-names></string-name>, <string-name><surname>Frank</surname><given-names>E.</given-names></string-name></person-group><article-title>Data mining: practical machine learning tools and techniques with java implementations</article-title>. <source>SIGMOD Rec</source><year>2002</year>;<volume>31</volume>:<fpage>76</fpage>–<lpage>7</lpage>.</mixed-citation>
    </ref>
    <ref id="btad407-B43">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Zimmermann</surname><given-names>M</given-names></string-name>, <string-name><surname>Zimmermann-Kogadeeva</surname><given-names>M</given-names></string-name>, <string-name><surname>Wegmann</surname><given-names>R</given-names></string-name></person-group><etal>et al</etal><article-title>Mapping human microbiome drug metabolism by gut bacteria and their genes</article-title>. <source>Nature</source><year>2019</year>;<volume>570</volume>:<fpage>462</fpage>–<lpage>7</lpage>.<pub-id pub-id-type="pmid">31158845</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.2 20190208//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.2?>
<?ConverterInfo.XSLTName jats2jats3.xsl?>
<?ConverterInfo.Version 1?>
<?properties open_access?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">Bioinformatics</journal-id>
    <journal-id journal-id-type="publisher-id">bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1367-4803</issn>
    <issn pub-type="epub">1367-4811</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">10322654</article-id>
    <article-id pub-id-type="pmid">37354527</article-id>
    <article-id pub-id-type="doi">10.1093/bioinformatics/btad407</article-id>
    <article-id pub-id-type="publisher-id">btad407</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Original Paper</subject>
        <subj-group subj-group-type="category-toc-heading">
          <subject>Data and Text Mining</subject>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="category-taxonomy-collection">
        <subject>AcademicSubjects/SCI01060</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>enviRule: an end-to-end system for automatic extraction of reaction patterns from environmental contaminant biotransformation pathways</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0009-0008-4588-9487</contrib-id>
        <name>
          <surname>Zhang</surname>
          <given-names>Kunyang</given-names>
        </name>
        <aff><institution>Department of Environmental Chemistry, Eawag</institution>, Dübendorf 8600, <country country="CH">Switzerland</country></aff>
        <aff><institution>Department of Chemistry, University of Zürich</institution>, Zürich 8057, <country country="CH">Switzerland</country></aff>
        <xref rid="btad407-cor1" ref-type="corresp"/>
        <!--kunyang.zhang@eawag.ch-->
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0001-6068-8220</contrib-id>
        <name>
          <surname>Fenner</surname>
          <given-names>Kathrin</given-names>
        </name>
        <aff><institution>Department of Environmental Chemistry, Eawag</institution>, Dübendorf 8600, <country country="CH">Switzerland</country></aff>
        <aff><institution>Department of Chemistry, University of Zürich</institution>, Zürich 8057, <country country="CH">Switzerland</country></aff>
      </contrib>
    </contrib-group>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Wren</surname>
          <given-names>Jonathan</given-names>
        </name>
        <role>Associate Editor</role>
      </contrib>
    </contrib-group>
    <author-notes>
      <corresp id="btad407-cor1">Corresponding author. Department of Environmental Chemistry, Eawag, Dübendorf 8600, Switzerland. E-mail: <email>kunyang.zhang@eawag.ch</email> (K.Z.)</corresp>
    </author-notes>
    <pub-date pub-type="collection">
      <month>7</month>
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="epub" iso-8601-date="2023-06-24">
      <day>24</day>
      <month>6</month>
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>24</day>
      <month>6</month>
      <year>2023</year>
    </pub-date>
    <volume>39</volume>
    <issue>7</issue>
    <elocation-id>btad407</elocation-id>
    <history>
      <date date-type="received">
        <day>05</day>
        <month>4</month>
        <year>2023</year>
      </date>
      <date date-type="rev-recd">
        <day>02</day>
        <month>6</month>
        <year>2023</year>
      </date>
      <date date-type="editorial-decision">
        <day>20</day>
        <month>6</month>
        <year>2023</year>
      </date>
      <date date-type="accepted">
        <day>23</day>
        <month>6</month>
        <year>2023</year>
      </date>
      <date date-type="corrected-typeset">
        <day>05</day>
        <month>7</month>
        <year>2023</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2023. Published by Oxford University Press.</copyright-statement>
      <copyright-year>2023</copyright-year>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">https://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted reuse, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <self-uri xlink:href="btad407.pdf"/>
    <abstract>
      <title>Abstract</title>
      <sec id="s1">
        <title>Motivation</title>
        <p>Transformation products (TPs) of man-made chemicals, formed through microbially mediated transformation in the environment, can have serious adverse environmental effects, yet the analytical identification of TPs is challenging. Rule-based prediction tools are successful in predicting TPs, especially in environmental chemistry applications that typically have to rely on small datasets, by imparting the existing knowledge on enzyme-mediated biotransformation reactions. However, the rules extracted from biotransformation reaction databases usually face the issue of being over/under-generalized and are not flexible to be updated with new reactions.</p>
      </sec>
      <sec id="s2">
        <title>Results</title>
        <p>We developed an automatic rule extraction tool called enviRule. It clusters biotransformation reactions into different groups based on the similarities of reaction fingerprints, and then automatically extracts and generalizes rules for each reaction group in SMARTS format. It optimizes the genericity of automatic rules against the downstream TP prediction task. Models trained with automatic rules outperformed the models trained with manually curated rules by 30% in the area under curve (AUC) scores. Moreover, automatic rules can be easily updated with new reactions, highlighting enviRule’s strengths for both automatic extraction of optimized reactions rules and automated updating thereof.</p>
      </sec>
      <sec id="s3">
        <title>Availability and implementation</title>
        <p>enviRule code is freely available at <ext-link xlink:href="https://github.com/zhangky12/enviRule" ext-link-type="uri">https://github.com/zhangky12/enviRule</ext-link>.</p>
      </sec>
    </abstract>
    <funding-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>European Union’s H2020 research and innovation program</institution>
          </institution-wrap>
        </funding-source>
      </award-group>
    </funding-group>
    <counts>
      <page-count count="8"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec>
    <title>1 Introduction</title>
    <p>Environmental biotransformation of a variety of organic contaminants plays an important role in chemical risk management (<xref rid="btad407-B18" ref-type="bibr">Kern <italic toggle="yes">et al.</italic> 2010</xref>, <xref rid="btad407-B25" ref-type="bibr">Olvera-Vargas <italic toggle="yes">et al.</italic> 2016</xref>), bioremediation of contaminated sites (<xref rid="btad407-B4" ref-type="bibr">de Lorenzo <italic toggle="yes">et al.</italic> 2008</xref>), and the development of green chemical alternatives (<xref rid="btad407-B21" ref-type="bibr">Moermond <italic toggle="yes">et al.</italic> 2022</xref>). In most cases, the bioactivity of transformation products (TPs) formed as part of the biotransformation process is mitigated through the structural changes introduced. However, examples have been reported where TPs exhibit equal or even higher bioactivities due to the conservation or formation of toxicophore structures in TPs, resulting in greater ecological risks compared to the parent compounds (<xref rid="btad407-B3" ref-type="bibr">Cwiertny <italic toggle="yes">et al.</italic> 2014</xref>). For example, decreases in the diversity and function of soil microorganisms were observed in a soil treated with 3,5-dichloroaniline (3,5-DCA), but not in the soil treated with its parent pesticide iprodione, suggesting greater toxicity of 3,5-DCA to soil microorganisms (<xref rid="btad407-B38" ref-type="bibr">Vasileiadis <italic toggle="yes">et al.</italic> 2018</xref>). Hence TPs should be included into hazard and risk assessment to obtain a comprehensive metric for the biological effects of contaminants. Yet, the identification and structural characterization of TPs is challenging, especially in environmental samples (<xref rid="btad407-B16" ref-type="bibr">Hubert <italic toggle="yes">et al.</italic> 2017</xref>). Typically, analysis by liquid chromatography-high resolution mass spectrometry (LC-HRMS) suspect or nontarget screening is required for the identification of formed TPs (<xref rid="btad407-B14" ref-type="bibr">Helbling <italic toggle="yes">et al.</italic> 2010</xref>, <xref rid="btad407-B12" ref-type="bibr">Funke <italic toggle="yes">et al.</italic> 2016</xref>), which is time-consuming and labor-intensive. Therefore, <italic toggle="yes">in silico</italic> models that can accurately predict possible biotransformation TPs are an essential tool for the comprehensive ecological risk assessment of environmental contaminants.</p>
    <p>Substantial efforts have been made to enable the <italic toggle="yes">in silico</italic> prediction of TPs from contaminant biotransformation by environmental microbial communities, and a number of rule-based systems have been developed, including enviPath (<xref rid="btad407-B40" ref-type="bibr">Wicker <italic toggle="yes">et al.</italic> 2016</xref>), the chemical transformation simulator by the US EPA (<ext-link xlink:href="https://scholarsarchive.byu.edu/iemssconference/2016/Stream-A/19/" ext-link-type="uri">https://scholarsarchive.byu.edu/iemssconference/2016/Stream-A/19/</ext-link>), and Biotransformer (<xref rid="btad407-B6" ref-type="bibr">Djoumbou-Feunang <italic toggle="yes">et al.</italic> 2019</xref>, <xref rid="btad407-B41" ref-type="bibr">Wishart <italic toggle="yes">et al.</italic> 2022</xref>). All of these <italic toggle="yes">in silico</italic> prediction tools combine both domain knowledge and machine learning models to predict and prune biotransformation pathways. Although rule-free models (i.e. sequence-based models) have also been shown to achieve considerable success in predicting the outcomes of chemical reactions (<xref rid="btad407-B32" ref-type="bibr">Schwaller <italic toggle="yes">et al.</italic> 2019</xref>, <xref rid="btad407-B33" ref-type="bibr">2021a</xref>, <xref rid="btad407-B34" ref-type="bibr">b</xref>), and sometimes even outperform rule-based models, they require large amounts of data for their training. This mostly prevents them from being applied on environmental biotransformation reactions, which only have limited sizes of datasets, especially when the reactions are confined to specific environmental matrices, such as soil, water, sediments, and sludge (<xref rid="btad407-B30" ref-type="bibr">Satoh <italic toggle="yes">et al.</italic> 2023</xref>). Rules significantly facilitate the training of models on small datasets by imparting the existing knowledge on enzyme-mediated biotransformation reactions to models, making rule-based models the currently most suitable approach for predicting TPs formed through environmental biotransformation reactions.</p>
    <p>The key challenge in developing rule-based models is the extraction of reaction rules from reaction databases. An exhaustive comparison of rules extracted from enzymatic reactions can be found in a previous report (<xref rid="btad407-B24" ref-type="bibr">Ni <italic toggle="yes">et al.</italic> 2021</xref>). Among the rules that are currently available online, the majority of them were manually curated, e.g. EAWAG-PPS rules (<xref rid="btad407-B13" ref-type="bibr">Gao <italic toggle="yes">et al.</italic> 2010</xref>), BNICE rules (<xref rid="btad407-B20" ref-type="bibr">Li <italic toggle="yes">et al.</italic> 2004</xref>), and MINE rules (<xref rid="btad407-B17" ref-type="bibr">Jeffryes <italic toggle="yes">et al.</italic> 2015</xref>). Manually curated rules are designed and examined by experts, and the rules can normally explain the most common reactions. However, recent improvements in techniques for elucidating biotransformation reactions at trace contaminant levels, e.g. the increased accessibility of LC-HRMS instruments and data analysis methods, enable biotransformation reactions to be discovered at increasing speed (<xref rid="btad407-B43" ref-type="bibr">Zimmermann <italic toggle="yes">et al.</italic> 2019</xref>), causing a surge in the volume of datasets. In addition, efforts have been made over the past five years to encode pathway information from publicly available regulatory dossiers. In enviPath specifically, the addition of the EAWAG-SOIL package, containing information on pesticide degradation pathways in soil, to the legacy EAWAG-BBD package has almost doubled the number of available reactions (<xref rid="btad407-B19" ref-type="bibr">Latino <italic toggle="yes">et al.</italic> 2017</xref>). With the addition of new pathway information, manually curated rules can be limited in representing the newly added reactions for two main reasons. First, due to the expansion of the chemical space covered, new reaction patterns might be present in the new datasets that are not included in existing rules at all. In the other case, similar reaction patterns are already included but not generalized enough to account for enzyme promiscuity on substrates in new reactions. At this point, with manually curated rules, it is very challenging to (i) sort new reactions into one of these two categories, and (ii) find the optimal level of generalization, also called genericity, for each rule.</p>
    <p>Therefore, interest has shifted from manually curated rules to automatically extracted rules. Indeed, systems like BNICE and ATLASx, which once used manual rules, have been updated to automatic rules in recent years (<xref rid="btad407-B24" ref-type="bibr">Ni <italic toggle="yes">et al.</italic> 2021</xref>, <xref rid="btad407-B22" ref-type="bibr">MohammadiPeyhani <italic toggle="yes">et al.</italic> 2022</xref>). Tools for automatic extraction of rules, based on atom–atom mapping (AAM) for the recognition of reaction centers, have been successfully developed (<xref rid="btad407-B7" ref-type="bibr">Duigou <italic toggle="yes">et al.</italic> 2019</xref>, <xref rid="btad407-B5" ref-type="bibr">Ding <italic toggle="yes">et al.</italic> 2020</xref>, <xref rid="btad407-B24" ref-type="bibr">Ni <italic toggle="yes">et al.</italic> 2021</xref>). Relative to manual rule curation, automatic extraction of rules from reactions can be very fast and the resulting set of rules normally covers reaction patterns more comprehensively. For instance, 4996 automatically extracted rules cover 20 942 biological reactions in Rhea (<xref rid="btad407-B5" ref-type="bibr">Ding <italic toggle="yes">et al.</italic> 2020</xref>). In addition, when new reactions are added and if it is found that they cannot be covered by any of the existing rules, automatic rule extraction should allow focusing on only those rules that need to be adjusted or created. This can potentially streamline the process of updating existing rules, relative to running extractions again for the combined set of reactions and producing a completely new set of rules. However, this possibility has not yet been extensively explored.</p>
    <p>Despite these obvious advantages of automatic rule extraction, the algorithms used are typically fully agnostic of biochemical expert knowledge on enzymes’ substrate specificities. Therefore, the main challenge faced by tools for automatic rule extraction is defining the appropriate genericity of rules (<xref rid="btad407-B36" ref-type="bibr">Sveshnikova <italic toggle="yes">et al.</italic> 2022</xref>). Although reaction rules can be extracted at different genericity levels by using various extension diameters of reaction centers as demonstrated in RetroRules (<xref rid="btad407-B7" ref-type="bibr">Duigou <italic toggle="yes">et al.</italic> 2019</xref>), reaction centers are usually not extended (<xref rid="btad407-B24" ref-type="bibr">Ni <italic toggle="yes">et al.</italic> 2021</xref>) or extended to include only immediately neighboring atoms (<xref rid="btad407-B2" ref-type="bibr">Coley <italic toggle="yes">et al.</italic> 2017</xref>, <xref rid="btad407-B35" ref-type="bibr">Segler and Waller 2017</xref>, <xref rid="btad407-B5" ref-type="bibr">Ding <italic toggle="yes">et al.</italic> 2020</xref>) in order to ensure sufficient coverage. Rules extracted in this way can typically be generalized well to cover unknown reactions as they only specify few neighboring atoms around reaction centers. For example, the rule set with 1224 rules automatically extracted from MetaCyc reactions, which only overlap with 58% of KEGG reactions, can cover 85.2% of all KEGG reactions (<xref rid="btad407-B24" ref-type="bibr">Ni <italic toggle="yes">et al.</italic> 2021</xref>). However, while their coverage is high, such rules are likely to be falsely triggered on many substrates, resulting in combinatorial explosion when used in pathway predictions (<xref rid="btad407-B5" ref-type="bibr">Ding <italic toggle="yes">et al.</italic> 2020</xref>). Developing algorithms to balance between coverage and over-generalization in automatic rule extraction is therefore of utmost importance.</p>
    <p>Here, we exploit knowledge on observed contaminant biotransformation pathways to explore the possibility of optimizing rule genericity directly against the prediction task at hand. More specifically, we developed an automatic rule generation tool called enviRule that can automatically extract rules from biotransformation reactions, efficiently update automatic rules as new data is added, and determine the optimum genericity of rules for the task of contaminant pathway prediction using the enviPath pathway prediction system (<xref rid="btad407-B40" ref-type="bibr">Wicker <italic toggle="yes">et al.</italic> 2016</xref>). To that end, we related rule genericity to the pathway prediction performance of machine learning models and determined the optimum rule genericity as yielding the best model performance.</p>
    <p>We tested enviRule on the biotransformation reactions contained in the EAWAG-BBD package in enviPath and compared the prediction performance of models trained with the previously manually curated rules and the newly generated automatic rules at both reaction and pathway levels. The automatic rules were then updated with the more recently added reactions contained in the EAWAG-SOIL package to test the applicability of enviRule to deal with the growing number of new reactions.</p>
  </sec>
  <sec>
    <title>2 System and methods</title>
    <sec>
      <title>2.1 Biotransformation reaction dataset</title>
      <p>Biotransformation reactions reported in the EAWAG-BBD and EAWAG-SOIL packages in enviPath were used for automatic rule generation and updating of rules, respectively. EAWAG-BBD is a mirror data package of the University of Minnesota Biocatalysis/Biodegradation Database (UM-BBD), which was first developed in 1995 (<xref rid="btad407-B10" ref-type="bibr">Ellis <italic toggle="yes">et al.</italic> 1999</xref>). Over the past two decades, the dataset has grown from 4 to 219 pathways with 1479 reactions (<xref rid="btad407-B11" ref-type="bibr">Ellis <italic toggle="yes">et al.</italic> 2006</xref>). Most of the data in EAWAG-BBD derives from studies of pure or enrichment cultures. In contrast, EAWAG-SOIL, a rather new data package, contains pesticide biotransformation pathways in soils extracted from the draft assessment reports (DAR) used in pesticide registration that are made publicly available through the European Food Safety Authority (EFSA) (<xref rid="btad407-B19" ref-type="bibr">Latino <italic toggle="yes">et al.</italic> 2017</xref>). 317 pathways with 2447 reactions observed under aerobic conditions have been extracted from DARs and documented in EAWAG-SOIL. Different from most studies reported in EAWAG-BBD, biotransformation studies reported in EAWAG-SOIL were carried out using <sup>14</sup>C-labeling, thus likely providing more complete pathways.</p>
    </sec>
    <sec>
      <title>2.2 Design of enviRule</title>
      <p>enviRule consists of three modules, namely reaction clusterer, rule generator, and reaction adder, which work closely together to generate and update automatic rules. Reactions are first clustered in reaction clusterer based on reaction centers, then rule generator produces automatic rules for each reaction cluster. When new reactions are added, reaction adder identifies existing rules to be updated and new rules to be created. A schematic overview of enviRule can be found in <xref rid="btad407-F1" ref-type="fig">Fig. 1</xref>. SMARTScompareViewer <xref rid="btad407-B9" ref-type="bibr"> (Ehmki <italic toggle="yes">et al.</italic>, 2019; </xref><xref rid="btad407-B31" ref-type="bibr">Schmidt <italic toggle="yes">et al.</italic>, 2019) </xref> was used to visualize reactions and SMARTS.</p>
      <fig position="float" id="btad407-F1">
        <label>Figure 1.</label>
        <caption>
          <p>Overview of enviRule. Reactions are first sent to the Reaction Clusterer to calculate reaction fingerprints, which are then used to cluster reactions into different groups. The Rule Generator automatically extract rules from clustered groups. Clustered groups can also be expanded with new reactions that have the same reaction fingerprints, and corresponding rules are updated.</p>
        </caption>
        <graphic xlink:href="btad407f1" position="float"/>
      </fig>
      <sec>
        <title>2.2.1 Module 1: Reaction clusterer</title>
        <p>Reaction clusterer was designed to avoid redundancy in generating automatic rules. Reactions with the same reaction centers are clustered into the same group with the goal of finding one generalized rule for each group in the next step. Reaction clusterer applies the Reaction Decoder Tool (RDT) for calculating AAM and bond changes (<xref rid="btad407-B27" ref-type="bibr">Rahman <italic toggle="yes">et al.</italic> 2016</xref>). The algorithms have been previously reported in EC-BLAST and are now available in RDT (<xref rid="btad407-B26" ref-type="bibr">Rahman <italic toggle="yes">et al.</italic> 2014</xref>). Adapted from EC-BLAST, comprehensive reaction fingerprints are created in reaction clusterer to measure reaction similarities. Chemical bonds and atoms in the reaction centers of substrates and products are encoded into multiple fingerprints: a bond formation/cleavage fingerprint, a bond-change fingerprint, which contains all the bonds with changed orders, and a set of reaction-center fingerprints, representing atoms in reaction centers. The reaction centers defined in reaction clusterer include changed atoms and bonds, as well as whole functional groups if any parts of a predefined set of functional groups are involved in reactions. The list of functional groups was adapted from a tool for predicting chemical reaction outcomes with machine learning (<xref rid="btad407-B2" ref-type="bibr">Coley <italic toggle="yes">et al.</italic> 2017</xref>). Since the Tanimoto coefficient has been widely accepted for calculating the similarity of bit-strings (<xref rid="btad407-B15" ref-type="bibr">Holliday <italic toggle="yes">et al.</italic> 2002</xref>), it is used as the indicator of reaction similarity in reaction clusterer. Only if the Tanimoto coefficient of reaction fingerprints is 1.0, two reactions are clustered into the same group. The reaction fingerprints of each clustered group are stored for further comparison when new reactions are added through reaction adder. In this project, only reaction groups with at least two reactions were sent to rule generator for automatic rule generation.</p>
      </sec>
      <sec>
        <title>2.2.2 Module 2: Rule generator</title>
        <p>In the rule generator, reaction centers are expanded by the breadth first search (BFS) algorithm with adjustable diameters to include neighboring bonds and atoms (i.e. substituents). Rule generator was developed with RDT and CDK. It automatically generates SMIRKS rules (<ext-link xlink:href="http://www.daylight.com/dayhtml/doc/theory/theory.smirks.html" ext-link-type="uri">http://www.daylight.com/dayhtml/doc/theory/theory.smirks.html</ext-link>) for each of the reaction groups. In the enviPath prediction system, each rule has a classifier that requires training. To decrease the sparsity of the training data of classifiers, classifiers are built for composite rules. Each composite rule represents one reaction group and may comprise of one or several simple rules extracted from the reactions present in this group. Without a combination strategy, the number of simple rules in a composite rule should equal the number of reactions in the corresponding group. Here, we aimed to minimize the number of simple rules in each composite rule as follows to control redundancy. To minimize the number of rules inside a composite rule we use graph combination to integrate substrates of different reactions without producing unobserved combinations of substituents (i.e. <xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S2</xref>), thus avoiding over-generalization of rules. After initializing each substrate as a graph with its original reaction center as backbone and substituents as leaf nodes (<xref rid="btad407-F2" ref-type="fig">Fig. 2</xref>), graphs are combined only (i.e. <xref rid="btad407-F2" ref-type="fig">Fig. 2a–c</xref>) when no connections are created between two substituents that do not co-exist in any reaction (e.g. substituent S_A1 and substituent S_B2 in <xref rid="btad407-F2" ref-type="fig">Fig. 2d</xref>). Graphs are translated into SMARTS after combination.</p>
        <fig position="float" id="btad407-F2">
          <label>Figure 2.</label>
          <caption>
            <p>Schematic view of substrate combination. Solid annotated circles are atoms in a reaction center, while dashed annotated circles are substituents. This figure demonstrates the graph combination for a group with two reactions. Four cases are distinguished (a–d) based on whether substituents (S) attached to either atom in the reaction center are equal or not. The left side shows the substrates of two simple rules extracted from the two reactions, and the right side shows three plausible (i.e. a–c) and one incorrect (i.e. d) combined forms of the substrates. Colored lines (i.e. the red and blue lines) in (d) denote unobserved combinations of substituents. In case d, the two reactions cannot be combined into one rule (see also <xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S2</xref> for another concrete example).</p>
          </caption>
          <graphic xlink:href="btad407f2" position="float"/>
        </fig>
      </sec>
      <sec>
        <title>2.2.2 Module 3: Reaction adder</title>
        <p>When new reactions are available, similarly to reaction clusterer, reaction adder clusters them into different groups. In addition, it compares the fingerprints of new reactions with the previously stored fingerprints of reaction groups and adds new reactions into existing reaction groups if the Tanimoto coefficient of their fingerprints is 1.0, otherwise puts them into new groups. Rule generator will be applied on those expanded groups, with existing and new reactions, to produce updated rules that are generalized to cover newly added reactions. For new reactions that cannot be added into any of the existing reaction groups, new rules will be generated by rule generator.</p>
      </sec>
    </sec>
    <sec>
      <title>2.3 Machine learning models for pathway predictions</title>
      <p>Pathway prediction was reduced to a multi-label classification problem in enviPath. The goal is to iteratively predict which rules (i.e. labels) are correctly triggered on a compound and then on its predicted TPs. enviPath used to solve multi-label classification with a binary relevance method (BM) by building independent classifiers for each rule (<xref rid="btad407-B39" ref-type="bibr">Wicker <italic toggle="yes">et al.</italic> 2010</xref>). Later, BM was replaced by an ensemble chain classifier (ECC) to take the correlation of these classifiers into consideration (<xref rid="btad407-B28" ref-type="bibr">Read <italic toggle="yes">et al.</italic> 2011</xref>). ECC models are implemented with MEKA (<xref rid="btad407-B29" ref-type="bibr">Read <italic toggle="yes">et al.</italic> 2016</xref>), which is a multi-label extension of the WEKA machine learning tool (<xref rid="btad407-B42" ref-type="bibr">Witten and Frank 2002</xref>).</p>
      <p>To prepare the training data for ECC models, each compound is represented as a vector consisting of 192 MACCS (Molecular ACCess System) structural fingerprints (<xref rid="btad407-B8" ref-type="bibr">Durant <italic toggle="yes">et al.</italic> 2002</xref>) and rules that are encoded into a binary string. For training the classifier of a rule, if this rule is triggered on a compound and resulting products are observed in the biotransformation reactions in the dataset, this compound is taken as a positive sample (PS). Conversely, if the rule is triggered but products cannot be observed, this compound is a negative sample (NS).</p>
    </sec>
    <sec>
      <title>2.4 Performance evaluation</title>
      <sec>
        <title>2.4.1 Genericity of automatic rules</title>
        <p>The range of compounds a rule can be triggered on depends on how specific this rule is. This characteristic of a rule is also called genericity and is evaluated as follows:
where NS represents the number of negative samples used for training the classifier of a rule, while PS stands for the number of positive samples. Genericity, i.e. the ratio of negative to positive samples, significantly affects the training of models and their prediction performance. A specific genericity of a rule can be achieved in rule generator by iteratively adjusting the diameters for the extension of reaction centers or by adding explicit hydrogens. To achieve a genericity target value, a rule is iteratively adjusted and evaluated against all the training compounds to count the number of negative samples and positive samples, until the ratio is as close as possible to the target genericity. For example, if the current genericity of a rule is greater than the target genericity, either extension diameters will be increased or explicit hydrogens will be added by the rule generator to generate a more specific version of this rule, and vice versa.</p>
        <disp-formula id="E1">
          <label>(1)</label>
          <mml:math id="M1" display="block" overflow="scroll">
            <mml:mtable>
              <mml:mtr>
                <mml:mtd>
                  <mml:mrow>
                    <mml:maligngroup/>
                    <mml:mi mathvariant="normal">G</mml:mi>
                    <mml:mi mathvariant="normal">e</mml:mi>
                    <mml:mi mathvariant="normal">n</mml:mi>
                    <mml:mi mathvariant="normal">e</mml:mi>
                    <mml:mi mathvariant="normal">r</mml:mi>
                    <mml:mi mathvariant="normal">i</mml:mi>
                    <mml:mi mathvariant="normal">c</mml:mi>
                    <mml:mi mathvariant="normal">i</mml:mi>
                    <mml:mi mathvariant="normal">t</mml:mi>
                    <mml:mi mathvariant="normal">y</mml:mi>
                    <mml:mo>=</mml:mo>
                    <mml:mrow>
                      <mml:mfrac>
                        <mml:mrow>
                          <mml:mi mathvariant="normal">NS</mml:mi>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mi mathvariant="normal">PS</mml:mi>
                        </mml:mrow>
                      </mml:mfrac>
                    </mml:mrow>
                  </mml:mrow>
                </mml:mtd>
              </mml:mtr>
            </mml:mtable>
          </mml:math>
        </disp-formula>
        <p>The optimum genericity of rules in this project was determined for the task of contaminant pathway prediction using the enviPath pathway prediction system. Specifically, prediction models were trained on 80%of data with 6 sets of automatic rules whose genericities were predefined at different genericity levels of 0, 1, 5, 10, 20, and 50. The genericity corresponding to the model yielding the highest predicted probabilities for the experimentally observed products in the remaining 20% test reactions is selected as optimum genericity. Once the optimum genericity is determined, extension diameters and explicit hydrogens for each rule can be adjusted as explained.</p>
      </sec>
      <sec>
        <title>2.4.2 Single-gen evaluation of pathway prediction</title>
        <p>Single-gen evaluation was performed at reaction level to compare the prediction performance of models trained with automatic rules and manually curated rules. For performance evaluation, we calculated precision and recall (<xref rid="E2" ref-type="disp-formula">Equations 2</xref> and <xref rid="E3" ref-type="disp-formula">3</xref>).
where TP and FP represent the numbers of correctly predicted and falsely predicted transformation products, respectively. It should be noted that FN only represents the transformation products documented in the dataset that cannot be predicted by models, which might be an underestimation relative to the true situation due to limitations of the analytical method used for transformation product detection. 80% of compounds were chosen to train models, while the remaining 20% were selected for testing. The evaluation was repeated 100 times for an unbiased examination of how well the model can predict new data not included during training.</p>
        <disp-formula id="E2">
          <label>(2)</label>
          <mml:math id="M2" display="block" overflow="scroll">
            <mml:mtable>
              <mml:mtr>
                <mml:mtd>
                  <mml:mrow>
                    <mml:maligngroup/>
                    <mml:mi mathvariant="normal">P</mml:mi>
                    <mml:mi mathvariant="normal">r</mml:mi>
                    <mml:mi mathvariant="normal">e</mml:mi>
                    <mml:mi mathvariant="normal">c</mml:mi>
                    <mml:mi mathvariant="normal">i</mml:mi>
                    <mml:mi mathvariant="normal">s</mml:mi>
                    <mml:mi mathvariant="normal">i</mml:mi>
                    <mml:mi mathvariant="normal">o</mml:mi>
                    <mml:mi mathvariant="normal">n</mml:mi>
                    <mml:mo>=</mml:mo>
                    <mml:mrow>
                      <mml:mfrac>
                        <mml:mrow>
                          <mml:mi mathvariant="normal">TP</mml:mi>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mi mathvariant="normal">TP</mml:mi>
                          <mml:mo>+</mml:mo>
                          <mml:mi mathvariant="normal">FP</mml:mi>
                        </mml:mrow>
                      </mml:mfrac>
                    </mml:mrow>
                  </mml:mrow>
                </mml:mtd>
              </mml:mtr>
            </mml:mtable>
          </mml:math>
        </disp-formula>
        <disp-formula id="E3">
          <label>(3)</label>
          <mml:math id="M3" display="block" overflow="scroll">
            <mml:mtable>
              <mml:mtr>
                <mml:mtd>
                  <mml:mrow>
                    <mml:maligngroup/>
                    <mml:mi mathvariant="normal">R</mml:mi>
                    <mml:mi mathvariant="normal">e</mml:mi>
                    <mml:mi mathvariant="normal">c</mml:mi>
                    <mml:mi mathvariant="normal">a</mml:mi>
                    <mml:mi mathvariant="normal">l</mml:mi>
                    <mml:mi mathvariant="normal">l</mml:mi>
                    <mml:mo>=</mml:mo>
                    <mml:mrow>
                      <mml:mfrac>
                        <mml:mrow>
                          <mml:mi mathvariant="normal">TP</mml:mi>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mi mathvariant="normal">TP</mml:mi>
                          <mml:mo>+</mml:mo>
                          <mml:mi mathvariant="normal">FN</mml:mi>
                        </mml:mrow>
                      </mml:mfrac>
                    </mml:mrow>
                  </mml:mrow>
                </mml:mtd>
              </mml:mtr>
            </mml:mtable>
          </mml:math>
        </disp-formula>
      </sec>
      <sec>
        <title>2.4.3 Multi-gen evaluation of pathway prediction</title>
        <p>Multi-gen evaluation was proposed in a previous study (<xref rid="btad407-B37" ref-type="bibr">Tam <italic toggle="yes">et al.</italic> 2021</xref>) and used to evaluate prediction performance for whole pathways. In multi-gen evaluation, transformation products emerging after several generations are assigned reduced weights when calculating precision and recall because they have higher uncertainties. In addition, intermediate predicted transformation products that are not observed in the dataset are not punished as false positives if they lead to correct downstream products. Different from the previously reported version of multi-gen evaluation, in this study, unobserved products created along with correct products from the same reactions, e.g. in an oxidative cleavage or hydrolysis reaction, were not punished as false positives. This modification will result in higher precision values compared to the original version of the multi-gen algorithm. Similar to single-gen evaluation, models were trained on 80% of compounds and tested on the rest, which was repeated 100 times.</p>
      </sec>
    </sec>
  </sec>
  <sec>
    <title>3 Results and discussion</title>
    <sec>
      <title>3.1 Automatic rules</title>
      <p><xref rid="btad407-F3" ref-type="fig">Figure 3</xref> shows the averaged probabilities of test reactions predicted by models trained with different sets of automatic rules adjusted to predefined genericity levels. High averaged probabilities indicate a high confidence of the thus trained models for the test reactions. Since all test reactions were actually experimentally observed, the genericity yielding models with highest averaged probabilities for test reactions is preferred. Among the six predefined genericities, the model trained with automatic rules generated at a genericity level of five resulted in the highest averaged probability. Hence, five was determined as the optimum genericity level for automatic rule generation and used in all the subsequent steps.</p>
      <fig position="float" id="btad407-F3">
        <label>Figure 3.</label>
        <caption>
          <p>Averaged predicted probabilities of test reactions for predefined genericity levels used in automatic rule extraction. Error bars are calculated with the results from five different train and test splits (see also <xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S1</xref>).</p>
        </caption>
        <graphic xlink:href="btad407f3" position="float"/>
      </fig>
      <p>Using the optimized genericity level of 5, 143 automatic rules were extracted using the reaction data provided in the EAWAG-BBD package. They successfully covered 826 of 1132 target biotransformation reactions (73.0% coverage), while the previously 208 manually designed rules used in Eawag-BBD (<xref rid="btad407-B13" ref-type="bibr">Gao <italic toggle="yes">et al.</italic> 2010</xref>) and transferred into the enviPath EAWAG-BBD package, known as btrules, covered 745 reactions (65.8% coverage). The reactions covered by the two sets of rules showed a significant overlap. 641 reactions can be concurrently covered by 96 automatic rules and 116 btrules, implying that more than 86% reactions covered by btrules can also be covered by automatic rules. 86 out of 116 btrules share reactions with only one automatic rule, which is a one-to-one relationship. Manual rules with a one-to-one relationship can have almost the same form as their corresponding automatic rule, which is, e.g. the case for the hydrolysis rule for nitroesters, i.e. bt0058 and automatic rule-116 (<xref rid="btad407-F4" ref-type="fig">Fig. 4</xref>). The only difference is the carbon connected to the oxygen atom in the reaction center of rule-116 cannot be quaternary, while in bt0058 it can be any carbon. However, since the genericities of manual rules are not explicitly regulated but the genericities of automatic rules are adjusted to be close to 5, btrules and corresponding automatic rules might differ in their specification of neighboring groups, even though the reaction centers are the same. As a result, btrules can have higher or lower genericity than their corresponding automatic rule in one-to-one relationships. The hydrolysis rule for phosphate/thiophosphate esters, i.e. bt0361 (genericity = 8.20), for instance, has a higher genericity than the corresponding automatic rule-87 (genericity = 5.20), while the rule for reduction of nitro groups to amino groups, i.e. bt0080 (genericity = 2.25), has lower genericity than the corresponding automatic rule-44 (genericity = 5.11) (<xref rid="btad407-F4" ref-type="fig">Fig. 4</xref>). In addition to one-to-one relationships, several one-to-many relationships are observed, where the reactions covered by one manual rule are covered by several automatic rules, or the other way around. The reductive dehalogenation rule bt0029, for instance, which removes chloride, bromide, and iodine atoms from aromatic or aliphatic carbons and replaces them with a hydrogen atom, is associated with automatic rule-123, rule-137, and rule-152, which handle the dechlorination of aliphatic carbons, the dechlorination of aromatic carbons, and the debromination of aromatic carbons, respectively (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S3</xref>). None of the automatic rules covers the debromination of aliphatic carbons or deiodination in general because such reactions are not present in the EAWAG-BBD package. Conversely, reactions covered by several manual rules can also be covered by only one automatic rule. The rule for oxidation of primary alcohols to aldehydes, i.e. bt0001, for instance, and the rule for oxidation of secondary alcohols to ketone/esters, i.e. bt0002, are combined into the automatic rule-19 (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S4</xref>) because the reaction centers of these two rules are the same, both including a C–O single bond and a C–H bond.</p>
      <fig position="float" id="btad407-F4">
        <label>Figure 4.</label>
        <caption>
          <p>One-to-one relationships of manual btrules and automatic rules. If the substituents of atoms in the reaction centers are similar, automatic rules and manual btrules can have almost the same forms and genericities (a). However, manual btrules can have higher genericities (b) if the substituents are more diverse, or lower genericities (c) if their substituents are less diverse, while the genericities of automatic rules remain stable.</p>
        </caption>
        <graphic xlink:href="btad407f4" position="float"/>
      </fig>
      <p>For automatic rule updates, firstly, the 143 automatic rules extracted from the EAWAG-BBD reactions were applied to the EAWAG-SOIL reactions. 1118 of 2447 EAWAG-SOIL reactions could not be covered by any of the initial set of 143 automatic rules extracted from EAWAG-BBD and were therefore used for the rule updates. Automatic rules that had the same reaction centers as one or several uncovered reactions were automatically adapted to include the newly introduced substituents. For example, the substructure [CH](-[C])-[CH3] was added as a possible neighboring group of the carbon atom in the reaction center of automatic rule-326 to cover the reaction 0000154 in the EAWAG-SOIL package (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S5</xref>). Upon rule updating, 38 out of the 143 original automatic rules were changed and 100 new rules were created, resulting in an updated rule set including 243 automatic rules in total. With this updated set of rules, the number of not covered EAWAG-SOIL reactions dropped from 1118 to 542.</p>
    </sec>
    <sec>
      <title>3.2 Evaluation of models with automatic rules extracted from EAWAG-BBD</title>
      <p>In <xref rid="btad407-F5" ref-type="fig">Fig. 5a</xref>, results for single-gen evaluation for models generated with the original, manually extracted btrules and the newly generated automatic rules are given. Automatic rules cannot reach the same maximum precision as btrules at the highest probability threshold, but their advantages in coverage become salient at lower thresholds. The area under the curve (AUC) scores of the model trained with manual btrules and the model trained with automatic rules are 0.30 and 0.39, respectively, suggesting a better overall performance at reaction level for the model trained with the automatic rules, primarily due to the gain in recall. Similar results can be observed in models trained with more evenly split (i.e. 60%/40% and 70%/30%) train/test data (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S7</xref>).</p>
      <fig position="float" id="btad407-F5">
        <label>Figure 5.</label>
        <caption>
          <p>Performance of models with the EAWAG-BBD reactions in (a) single-gen evaluation and (b) multi-gen evaluation.</p>
        </caption>
        <graphic xlink:href="btad407f5" position="float"/>
      </fig>
      <p>The results of multi-gen evaluation at pathway level are visualized in <xref rid="btad407-F5" ref-type="fig">Fig. 5b</xref>. AUC values for multi-gen evaluation, i.e. evaluation at pathway level, are generally lower than for single-gen evaluation because downstream reactions will never get a chance to be predicted if upstream reactions cannot be predicted, making it more challenging to obtain a high recall. Yet, similar to single-gen evaluation, the AUC score of the model trained with manual btrules (0.19) is lower than of the model trained with automatic rules (0.21), supporting the superior performance of the automatic rules over the manually curated ones at pathway level. The increase in AUC is also mainly caused by the high recall of automatic-rule-trained models.</p>
    </sec>
    <sec>
      <title>3.3 Evaluation of models with automatic rules updated with EAWAG-SOIL</title>
      <p>Both manual btrules and automatic rules extracted from the EAWAG-BBD reactions failed to generalize well for the prediction of the EAWAG-SOIL data. According to the single-gen evaluation results shown in <xref rid="btad407-F6" ref-type="fig">Fig. 6a</xref>, the AUC scores for the models trained with btrules and automatic rules and evaluated on the EAWAG-SOIL reactions were 0.19 and 0.20, respectively, which is substantially lower than the AUC scores in the single-gen evaluation of the two models trained and evaluated on the EAWAG-BBD reactions. After rule updating, an AUC score of 0.35 was achieved by the model trained with the updated automatic rules, suggesting a considerable improvement in the performance of the model with the set of updated rules.</p>
      <fig position="float" id="btad407-F6">
        <label>Figure 6.</label>
        <caption>
          <p>(a) Single-gen evaluation and (b) multi-gen evaluation of models against the EAWAG-SOIL reactions for three sets of rules, i.e. manually curated rules (btrules), automatic rules extracted from EAWAG-BBD data (auto rules), and automatic rules updated with EAWAG-SOIL data (updated auto rules).</p>
        </caption>
        <graphic xlink:href="btad407f6" position="float"/>
      </fig>
      <p>Results for multi-gen evaluation again agreed with results for single-gen evaluation (<xref rid="btad407-F6" ref-type="fig">Fig. 6b</xref>). The difference between the AUC scores for the model trained with btrules (0.13) and the model trained with automatic rules extracted from the EAWAG-BBD reactions (0.12) was tiny when evaluated against the EAWAG-SOIL data. Yet, as a consequence of the good coverage of the EAWAG-SOIL reactions by updated automatic rules, the AUC score (0.20) for the model trained with updated automatic rules improved, largely due to the increase in recall.</p>
    </sec>
    <sec>
      <title>3.4 Benchmarking against other automatic rules</title>
      <p>To enable benchmarking the performance of our automatic rules against external automatic rule sets, the single-gen evaluation was implemented with RDKit and Meka wrapper in Scikit-multilearn Python package. We compared the single-gen evaluation results on the EAWAG-BBD package for the models trained with automatic rules extracted from the EAWAG-BBD reactions and the automatic rules extracted from MetaCyc dataset (<xref rid="btad407-B24" ref-type="bibr">Ni <italic toggle="yes">et al.</italic> 2021</xref>). MetaCyc is a comprehensive database that contains metabolic pathways and enzymes from various domains of life, including environmental bacteria like Nitrospirae and Planctomycetes (<xref rid="btad407-B1" ref-type="bibr">Caspi <italic toggle="yes">et al.</italic> 2018</xref>). Since all the biotransformation reactions in the EAWAG-BBD package are decomposition reactions, i.e. one substrate reacting to one or several products, only the 255 decomposition rules were selected from the 2318 MetaCyc auto rules for the comparison. Although MetaCyc auto rules showed good generalization for KEGG and BRENDA reactions (<xref rid="btad407-B24" ref-type="bibr">Ni <italic toggle="yes">et al.</italic> 2021</xref>), the 255 MetaCyc decomposition rules could only cover 342 of 1132 EAWAG-BBD reactions (30.2% coverage). This most likely is the main reason also for the low AUC score of 0.11 of the prediction model trained with MetaCyc auto rules (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S6</xref>).</p>
    </sec>
  </sec>
  <sec>
    <title>4 Conclusion</title>
    <p>enviRule is proposed as an efficient tool for automatic extraction of reaction rules, required for rule-based biotransformation pathway prediction systems, from biotransformation reactions. In contrast to manual rules, automatic rules are extracted in a more thorough, data-driven approach and therefore no biotransformation reaction is overlooked. While this approach achieves a higher coverage of reactions compared to the previously used, manually curated rules, the genericity of rules is well controlled, and the number of rules is carefully minimized by a graph combination algorithm without over-generalization. We demonstrated that the optimum genericity of rules for the specific task of contaminant pathway prediction could be determined by comparing the predicted probabilities of test reactions from enviPath prediction models trained with rule sets that have different genericities. This optimum genericity of rules is expected to not change significantly when reactions from a similar domain are added (see, e.g. the predicted probabilities for the combined set of EAWAG-BBD and EAWAG-SOIL reactions in <xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S8</xref>). enviRule also allows streamlined, computationally efficient rule adaption when new reaction information is obtained, focusing only on rules that need to be updated and rules that need to be newly created, instead of running rule extraction all over again for existing and new reactions. The experimental results show that the improvement in recall for the models trained with automatic rules leads to a significant increase in the overall performance of TP prediction, compared with the models trained with manually curated rules.</p>
    <p>Despite the remarkable achievements of enviRule, the limitations should also be noticed. Among the reaction groups clustered by the rule clusterer module of enviRule, 722 of them only have single instances. They are considered too unique for rule extraction, and hence they are skipped in the rule generator. However, some of them could contain important rules, and, upon enrichment of our reaction datasets with additional reactions, eventually more reactions might be clustered into them. For example, we are missing a rule for reductive debromination of aliphatic carbons because there are not enough examples of that type of reaction in EAWAG-BBD and EAWAG-SOIL reaction databases. One option to populate reaction clusters with additional reactions would be to augment our reaction databases with reactions from enzyme databases such as BRENDA and KEGG. However, it remains unclear which of these reactions would be observed under environmentally relevant conditions, and therefore the meaningfulness of such an approach must be carefully evaluated.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material id="sup1" position="float" content-type="local-data">
      <label>btad407_Supplementary_Data</label>
      <media xlink:href="btad407_supplementary_data.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <sec>
    <title>Supplementary data</title>
    <p><xref rid="sup1" ref-type="supplementary-material">Supplementary data</xref> are available at <italic toggle="yes">Bioinformatics</italic> online.</p>
  </sec>
  <sec sec-type="COI-statement">
    <title>Conflict of interest</title>
    <p>None declared.</p>
  </sec>
  <sec>
    <title>Funding</title>
    <p>This work was supported by the European Union’s H2020 research and innovation program under the Marie Sklodowska-Curie grant agreement MSCA-ITN-H2020 [956496] and was subordinate to the project: Academia Network for RevIsing and Advancing the Assessment of the Soil Microbial Toxicity of Pesticides (ARISTO).</p>
  </sec>
  <sec sec-type="data-availability">
    <title>Data availability</title>
    <p>The automatically extracted rules underlying this article, as well as 255 decomposition rules extracted from MetaCyc dataset (<xref rid="btad407-B24" ref-type="bibr">Ni <italic toggle="yes">et al.</italic> 2021</xref>), are available at online repositories (<ext-link xlink:href="https://github.com/zhangky12/enviRule" ext-link-type="uri">https://github.com/zhangky12/enviRule</ext-link>), and the reaction data used for rule extraction is available on <ext-link xlink:href="https://envipath.org/" ext-link-type="uri">https://envipath.org/</ext-link>.</p>
  </sec>
  <ref-list id="ref1">
    <title>References</title>
    <ref id="btad407-B1">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Caspi</surname><given-names>R</given-names></string-name>, <string-name><surname>Billington</surname><given-names>R</given-names></string-name>, <string-name><surname>Fulcher</surname><given-names>CA</given-names></string-name></person-group><etal>et al</etal><article-title>The MetaCyc database of metabolic pathways and enzymes</article-title>. <source>Nucleic Acids Res</source><year>2018</year>;<volume>46</volume>:<fpage>D633</fpage>–<lpage>9</lpage>.<pub-id pub-id-type="pmid">29059334</pub-id></mixed-citation>
    </ref>
    <ref id="btad407-B2">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Coley</surname><given-names>CW</given-names></string-name>, <string-name><surname>Barzilay</surname><given-names>R</given-names></string-name>, <string-name><surname>Jaakkola</surname><given-names>TS</given-names></string-name></person-group><etal>et al</etal><article-title>Prediction of organic reaction outcomes using machine learning</article-title>. <source>ACS Cent Sci</source><year>2017</year>;<volume>3</volume>:<fpage>434</fpage>–<lpage>43</lpage>.<pub-id pub-id-type="pmid">28573205</pub-id></mixed-citation>
    </ref>
    <ref id="btad407-B3">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Cwiertny</surname><given-names>DM</given-names></string-name>, <string-name><surname>Snyder</surname><given-names>SA</given-names></string-name>, <string-name><surname>Schlenk</surname><given-names>D</given-names></string-name></person-group><etal>et al</etal><article-title>Environmental designer drugs: when transformation may not eliminate risk</article-title>. <source>Environ Sci Technol</source><year>2014</year>;<volume>48</volume>:<fpage>11737</fpage>–<lpage>45</lpage>.<pub-id pub-id-type="pmid">25216024</pub-id></mixed-citation>
    </ref>
    <ref id="btad407-B4">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>de Lorenzo</surname><given-names>V.</given-names></string-name></person-group><article-title>Systems biology approaches to bioremediation</article-title>. <source>Curr Opin Biotechnol</source><year>2008</year>;<volume>19</volume>:<fpage>579</fpage>–<lpage>89</lpage>.<pub-id pub-id-type="pmid">19000761</pub-id></mixed-citation>
    </ref>
    <ref id="btad407-B5">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Ding</surname><given-names>S</given-names></string-name>, <string-name><surname>Tian</surname><given-names>Y</given-names></string-name>, <string-name><surname>Cai</surname><given-names>P</given-names></string-name></person-group><etal>et al</etal><article-title>novoPathFinder: a webserver of designing novel-pathway with integrating GEM-model</article-title>. <source>Nucleic Acids Res</source><year>2020</year>;<volume>48</volume>:<fpage>W477</fpage>–<lpage>87</lpage>.<pub-id pub-id-type="pmid">32313937</pub-id></mixed-citation>
    </ref>
    <ref id="btad407-B6">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Djoumbou-Feunang</surname><given-names>Y</given-names></string-name>, <string-name><surname>Fiamoncini</surname><given-names>J</given-names></string-name>, <string-name><surname>Gil-de-la-Fuente</surname><given-names>A</given-names></string-name></person-group><etal>et al</etal><article-title>BioTransformer: a comprehensive computational tool for small molecule metabolism prediction and metabolite identification</article-title>. <source>J Cheminform</source><year>2019</year>;<volume>11</volume>:<fpage>2</fpage>–<lpage>25</lpage>.<pub-id pub-id-type="pmid">30612223</pub-id></mixed-citation>
    </ref>
    <ref id="btad407-B7">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Duigou</surname><given-names>T</given-names></string-name>, <string-name><surname>Du Lac</surname><given-names>M</given-names></string-name>, <string-name><surname>Carbonell</surname><given-names>P</given-names></string-name></person-group><etal>et al</etal><article-title>RetroRules: a database of reaction rules for engineering biology</article-title>. <source>Nucleic Acids Res</source><year>2019</year>;<volume>47</volume>:<fpage>D1229</fpage>–<lpage>35</lpage>.<pub-id pub-id-type="pmid">30321422</pub-id></mixed-citation>
    </ref>
    <ref id="btad407-B8">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Durant</surname><given-names>JL</given-names></string-name>, <string-name><surname>Leland</surname><given-names>BA</given-names></string-name>, <string-name><surname>Henry</surname><given-names>DR</given-names></string-name></person-group><etal>et al</etal><article-title>Reoptimization of MDL keys for use in drug discovery</article-title>. <source>J Chem Inf Comput Sci</source><year>2002</year>;<volume>42</volume>:<fpage>1273</fpage>–<lpage>80</lpage>.<pub-id pub-id-type="pmid">12444722</pub-id></mixed-citation>
    </ref>
    <ref id="btad407-B9">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Ehmki</surname><given-names>ESR</given-names></string-name>, <string-name><surname>Schmidt</surname><given-names>R</given-names></string-name>, <string-name><surname>Ohm</surname><given-names>F</given-names></string-name></person-group><etal>et al</etal><article-title>Comparing molecular patterns using the example of SMARTS: applications and filter collection analysis</article-title>. <source>J Chem Inf Model</source><year>2019</year>;<volume>59</volume>:<fpage>2572</fpage>–<lpage>86</lpage>.<pub-id pub-id-type="pmid">31125225</pub-id></mixed-citation>
    </ref>
    <ref id="btad407-B10">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Ellis</surname><given-names>LB</given-names></string-name>, <string-name><surname>Hershberger</surname><given-names>CD</given-names></string-name>, <string-name><surname>Wackett</surname><given-names>LP</given-names></string-name></person-group><etal>et al</etal><article-title>The University of Minnesota Biocatalysis/Biodegradation Database: specialized metabolism for functional genomics</article-title>. <source>Nucleic Acids Res</source><year>1999</year>;<volume>27</volume>:<fpage>373</fpage>–<lpage>6</lpage>.<pub-id pub-id-type="pmid">9847233</pub-id></mixed-citation>
    </ref>
    <ref id="btad407-B11">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Ellis</surname><given-names>LBM</given-names></string-name>, <string-name><surname>Roe</surname><given-names>D</given-names></string-name>, <string-name><surname>Wackett</surname><given-names>LP</given-names></string-name></person-group><etal>et al</etal><article-title>The University of Minnesota Biocatalysis/Biodegradation Database: the first decade</article-title>. <source>Nucleic Acids Res</source><year>2006</year>;<volume>34</volume>:<fpage>D517</fpage>–<lpage>21</lpage>.<pub-id pub-id-type="pmid">16381924</pub-id></mixed-citation>
    </ref>
    <ref id="btad407-B12">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Funke</surname><given-names>J</given-names></string-name>, <string-name><surname>Prasse</surname><given-names>C</given-names></string-name>, <string-name><surname>Ternes</surname><given-names>TA</given-names></string-name></person-group><etal>et al</etal><article-title>Identification of transformation products of antiviral drugs formed during biological wastewater treatment and their occurrence in the urban water cycle</article-title>. <source>Water Res</source><year>2016</year>;<volume>98</volume>:<fpage>75</fpage>–<lpage>83</lpage>.<pub-id pub-id-type="pmid">27082694</pub-id></mixed-citation>
    </ref>
    <ref id="btad407-B13">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Gao</surname><given-names>J</given-names></string-name>, <string-name><surname>Ellis</surname><given-names>LBM</given-names></string-name>, <string-name><surname>Wackett</surname><given-names>LP</given-names></string-name></person-group><etal>et al</etal><article-title>The University of Minnesota Biocatalysis/Biodegradation Database: improving public access</article-title>. <source>Nucleic Acids Res</source><year>2010</year>;<volume>38</volume>:<fpage>D488</fpage>–<lpage>91</lpage>.<pub-id pub-id-type="pmid">19767608</pub-id></mixed-citation>
    </ref>
    <ref id="btad407-B14">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Helbling</surname><given-names>DE</given-names></string-name>, <string-name><surname>Hollender</surname><given-names>J</given-names></string-name>, <string-name><surname>Kohler</surname><given-names>H-PE</given-names></string-name></person-group><etal>et al</etal><article-title>High-throughput identification of microbial transformation products of organic micropollutants</article-title>. <source>Environ Sci Technol</source><year>2010</year>;<volume>44</volume>:<fpage>6621</fpage>–<lpage>7</lpage>.<pub-id pub-id-type="pmid">20799730</pub-id></mixed-citation>
    </ref>
    <ref id="btad407-B15">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Holliday</surname><given-names>JD</given-names></string-name></person-group><etal>et al</etal><article-title>Grouping of coefficients for the calculation of inter-molecular similarity and dissimilarity using 2D fragment bit-strings</article-title>. <source>Comb Chem High Throughput Screen</source><year>2002</year>;<volume>5</volume>:<fpage>155</fpage>–<lpage>66</lpage>.<pub-id pub-id-type="pmid">11966424</pub-id></mixed-citation>
    </ref>
    <ref id="btad407-B16">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Hubert</surname><given-names>J</given-names></string-name>, <string-name><surname>Nuzillard</surname><given-names>J-M</given-names></string-name>, <string-name><surname>Renault</surname><given-names>J-H</given-names></string-name></person-group><etal>et al</etal><article-title>Dereplication strategies in natural product research: how many tools and methodologies behind the same concept?</article-title><source>Phytochem Rev</source><year>2017</year>;<volume>16</volume>:<fpage>55</fpage>–<lpage>95</lpage>.</mixed-citation>
    </ref>
    <ref id="btad407-B17">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Jeffryes</surname><given-names>JG</given-names></string-name>, <string-name><surname>Colastani</surname><given-names>RL</given-names></string-name>, <string-name><surname>Elbadawi-Sidhu</surname><given-names>M</given-names></string-name></person-group><etal>et al</etal><article-title>MINEs: open access databases of computationally predicted enzyme promiscuity products for untargeted metabolomics</article-title>. <source>J Cheminform</source><year>2015</year>;<volume>7</volume>:<fpage>1</fpage>–<lpage>8</lpage>.<pub-id pub-id-type="pmid">25705261</pub-id></mixed-citation>
    </ref>
    <ref id="btad407-B18">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Kern</surname><given-names>S</given-names></string-name>, <string-name><surname>Baumgartner</surname><given-names>R</given-names></string-name>, <string-name><surname>Helbling</surname><given-names>DE</given-names></string-name></person-group><etal>et al</etal><article-title>A tiered procedure for assessing the formation of biotransformation products of pharmaceuticals and biocides during activated sludge treatment</article-title>. <source>J Environ Monit</source><year>2010</year>;<volume>12</volume>:<fpage>2100</fpage>–<lpage>11</lpage>.<pub-id pub-id-type="pmid">20967365</pub-id></mixed-citation>
    </ref>
    <ref id="btad407-B19">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Latino</surname><given-names>DARS</given-names></string-name>, <string-name><surname>Wicker</surname><given-names>J</given-names></string-name>, <string-name><surname>Gütlein</surname><given-names>M</given-names></string-name></person-group><etal>et al</etal><article-title>Eawag-Soil in enviPath: a new resource for exploring regulatory pesticide soil biodegradation pathways and half-life data</article-title>. <source>Environ Sci Process Impacts</source><year>2017</year>;<volume>19</volume>:<fpage>449</fpage>–<lpage>64</lpage>.<pub-id pub-id-type="pmid">28229138</pub-id></mixed-citation>
    </ref>
    <ref id="btad407-B20">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Li</surname><given-names>C</given-names></string-name>, <string-name><surname>Henry</surname><given-names>CS</given-names></string-name>, <string-name><surname>Jankowski</surname><given-names>MD</given-names></string-name></person-group><etal>et al</etal><article-title>Computational discovery of biochemical routes to specialty chemicals</article-title>. <source>Chem Eng Sci</source><year>2004</year>;<volume>59</volume>:<fpage>5051</fpage>–<lpage>60</lpage>.</mixed-citation>
    </ref>
    <ref id="btad407-B21">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Moermond</surname><given-names>CTA</given-names></string-name>, <string-name><surname>Puhlmann</surname><given-names>N</given-names></string-name>, <string-name><surname>Brown</surname><given-names>AR</given-names></string-name></person-group><etal>et al</etal><article-title>GREENER pharmaceuticals for more sustainable healthcare</article-title>. <source>Environ Sci Technol Lett</source><year>2022</year>;<volume>9</volume>:<fpage>699</fpage>–<lpage>705</lpage>.<pub-id pub-id-type="pmid">36118957</pub-id></mixed-citation>
    </ref>
    <ref id="btad407-B22">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>MohammadiPeyhani</surname><given-names>H</given-names></string-name>, <string-name><surname>Hafner</surname><given-names>J</given-names></string-name>, <string-name><surname>Sveshnikova</surname><given-names>A</given-names></string-name></person-group><etal>et al</etal><article-title>Expanding biochemical knowledge and illuminating metabolic dark matter with ATLASx</article-title>. <source>Nat Commun</source><year>2022</year>;<volume>13</volume>:<fpage>1</fpage>–<lpage>12</lpage>.<pub-id pub-id-type="pmid">34983933</pub-id></mixed-citation>
    </ref>
    <ref id="btad407-B24">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Ni</surname><given-names>Z</given-names></string-name>, <string-name><surname>Stine</surname><given-names>AE</given-names></string-name>, <string-name><surname>Tyo</surname><given-names>KEJ</given-names></string-name></person-group><etal>et al</etal><article-title>Curating a comprehensive set of enzymatic reaction rules for efficient novel biosynthetic pathway design</article-title>. <source>Metab Eng</source><year>2021</year>;<volume>65</volume>:<fpage>79</fpage>–<lpage>87</lpage>.<pub-id pub-id-type="pmid">33662575</pub-id></mixed-citation>
    </ref>
    <ref id="btad407-B25">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Olvera-Vargas</surname><given-names>H</given-names></string-name>, <string-name><surname>Leroy</surname><given-names>S</given-names></string-name>, <string-name><surname>Rivard</surname><given-names>M</given-names></string-name></person-group><etal>et al</etal><article-title>Microbial biotransformation of furosemide for environmental risk assessment: identification of metabolites and toxicological evaluation</article-title>. <source>Environ Sci Pollut Res Int</source><year>2016</year>;<volume>23</volume>:<fpage>22691</fpage>–<lpage>700</lpage>.<pub-id pub-id-type="pmid">27557972</pub-id></mixed-citation>
    </ref>
    <ref id="btad407-B26">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Rahman</surname><given-names>SA</given-names></string-name>, <string-name><surname>Cuesta</surname><given-names>SM</given-names></string-name>, <string-name><surname>Furnham</surname><given-names>N</given-names></string-name></person-group><etal>et al</etal><article-title>EC-BLAST: a tool to automatically search and compare enzyme reactions</article-title>. <source>Nat Methods</source><year>2014</year>;<volume>11</volume>:<fpage>171</fpage>–<lpage>4</lpage>.<pub-id pub-id-type="pmid">24412978</pub-id></mixed-citation>
    </ref>
    <ref id="btad407-B27">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Rahman</surname><given-names>SA</given-names></string-name>, <string-name><surname>Torrance</surname><given-names>G</given-names></string-name>, <string-name><surname>Baldacci</surname><given-names>L</given-names></string-name></person-group><etal>et al</etal><article-title>Reaction decoder tool (RDT): extracting features from chemical reactions</article-title>. <source>Bioinformatics</source><year>2016</year>;<volume>32</volume>:<fpage>2065</fpage>–<lpage>6</lpage>.<pub-id pub-id-type="pmid">27153692</pub-id></mixed-citation>
    </ref>
    <ref id="btad407-B28">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Read</surname><given-names>J</given-names></string-name>, <string-name><surname>Pfahringer</surname><given-names>B</given-names></string-name>, <string-name><surname>Holmes</surname><given-names>G</given-names></string-name></person-group><etal>et al</etal><article-title>Classifier chains for multi-label classification</article-title>. <source>Mach Learn</source><year>2011</year>;<volume>85</volume>:<fpage>333</fpage>–<lpage>59</lpage>.</mixed-citation>
    </ref>
    <ref id="btad407-B29">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Read</surname><given-names>J</given-names></string-name>, <string-name><surname>Reutemann</surname><given-names>P</given-names></string-name>, <string-name><surname>Pfahringer</surname><given-names>B</given-names></string-name></person-group><etal>et al</etal><article-title>Meka: a multi-label/multi-target extension to Weka</article-title>. <source>J Mach Learn Res</source><year>2016</year>;<volume>17</volume>:<fpage>1</fpage>–<lpage>5</lpage>.</mixed-citation>
    </ref>
    <ref id="btad407-B30">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Satoh</surname><given-names>H</given-names></string-name>, <string-name><surname>Hafner</surname><given-names>J</given-names></string-name>, <string-name><surname>Hutter</surname><given-names>J</given-names></string-name></person-group><etal>et al</etal><article-title>Can AI help improve water quality? Towards the prediction of degradation of micropollutants in wastewater</article-title>. <source>Chimia</source><year>2023</year>;<volume>77</volume>:<fpage>48</fpage>.</mixed-citation>
    </ref>
    <ref id="btad407-B31">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Schmidt</surname><given-names>R</given-names></string-name>, <string-name><surname>Ehmki</surname><given-names>ESR</given-names></string-name>, <string-name><surname>Ohm</surname><given-names>F</given-names></string-name></person-group><etal>et al</etal><article-title>Comparing molecular patterns using the example of SMARTS: theory and algorithms</article-title>. <source>J Chem Inf Model</source><year>2019</year>;<volume>59</volume>:<fpage>2560</fpage>–<lpage>71</lpage>.<pub-id pub-id-type="pmid">31120751</pub-id></mixed-citation>
    </ref>
    <ref id="btad407-B32">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Schwaller</surname><given-names>P</given-names></string-name>, <string-name><surname>Laino</surname><given-names>T</given-names></string-name>, <string-name><surname>Gaudin</surname><given-names>T</given-names></string-name></person-group><etal>et al</etal><article-title>Molecular transformer: a model for uncertainty-calibrated chemical reaction prediction</article-title>. <source>ACS Cent Sci</source><year>2019</year>;<volume>5</volume>:<fpage>1572</fpage>–<lpage>83</lpage>.<pub-id pub-id-type="pmid">31572784</pub-id></mixed-citation>
    </ref>
    <ref id="btad407-B33">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Schwaller</surname><given-names>P</given-names></string-name>, <string-name><surname>Probst</surname><given-names>D</given-names></string-name>, <string-name><surname>Vaucher</surname><given-names>AC</given-names></string-name></person-group><etal>et al</etal><article-title>Mapping the space of chemical reactions using attention-based neural networks</article-title>. <source>Nat Mach Intell</source><year>2021a</year>;<volume>3</volume>:<fpage>144</fpage>–<lpage>52</lpage>.</mixed-citation>
    </ref>
    <ref id="btad407-B34">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Schwaller</surname><given-names>P</given-names></string-name>, <string-name><surname>Vaucher</surname><given-names>AC</given-names></string-name>, <string-name><surname>Laino</surname><given-names>T</given-names></string-name></person-group><etal>et al</etal><article-title>Prediction of chemical reaction yields using deep learning</article-title>. <source>Mach Learn Sci Technol</source><year>2021b</year>;<volume>2</volume>:<fpage>015016</fpage>.</mixed-citation>
    </ref>
    <ref id="btad407-B35">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Segler</surname><given-names>MH</given-names></string-name>, <string-name><surname>Waller</surname><given-names>MP.</given-names></string-name></person-group><article-title>Neural‐symbolic machine learning for retrosynthesis and reaction prediction</article-title>. <source>Chemistry</source><year>2017</year>;<volume>23</volume>:<fpage>5966</fpage>–<lpage>71</lpage>.<pub-id pub-id-type="pmid">28134452</pub-id></mixed-citation>
    </ref>
    <ref id="btad407-B36">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Sveshnikova</surname><given-names>A</given-names></string-name>, <string-name><surname>MohammadiPeyhani</surname><given-names>H</given-names></string-name>, <string-name><surname>Hatzimanikatis</surname><given-names>V</given-names></string-name></person-group><etal>et al</etal><article-title>Computational tools and resources for designing new pathways to small molecules</article-title>. <source>Curr Opin Biotechnol</source><year>2022</year>;<volume>76</volume>:<fpage>102722</fpage>.<pub-id pub-id-type="pmid">35483185</pub-id></mixed-citation>
    </ref>
    <ref id="btad407-B37">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Tam</surname><given-names>JYC</given-names></string-name>, <string-name><surname>Lorsbach</surname><given-names>T</given-names></string-name>, <string-name><surname>Schmidt</surname><given-names>S</given-names></string-name></person-group><etal>et al</etal><article-title>Holistic evaluation of biodegradation pathway prediction: assessing multi-step reactions and intermediate products</article-title>. <source>J Cheminform</source><year>2021</year>;<volume>13</volume>:<fpage>1</fpage>–<lpage>14</lpage>.<pub-id pub-id-type="pmid">33407901</pub-id></mixed-citation>
    </ref>
    <ref id="btad407-B38">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Vasileiadis</surname><given-names>S</given-names></string-name>, <string-name><surname>Puglisi</surname><given-names>E</given-names></string-name>, <string-name><surname>Papadopoulou</surname><given-names>ES</given-names></string-name></person-group><etal>et al</etal><article-title>Blame it on the metabolite: 3,5-dichloroaniline rather than the parent compound is responsible for the decreasing diversity and function of soil microorganisms</article-title>. <source>Appl Environ Microbiol</source><year>2018</year>;<volume>84</volume>:<fpage>e01536</fpage>-<lpage>18</lpage>.<pub-id pub-id-type="pmid">30194100</pub-id></mixed-citation>
    </ref>
    <ref id="btad407-B39">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Wicker</surname><given-names>J</given-names></string-name>, <string-name><surname>Fenner</surname><given-names>K</given-names></string-name>, <string-name><surname>Ellis</surname><given-names>L</given-names></string-name></person-group><etal>et al</etal><article-title>Predicting biodegradation products and pathways: a hybrid knowledge- and machine learning-based approach</article-title>. <source>Bioinformatics</source><year>2010</year>;<volume>26</volume>:<fpage>814</fpage>–<lpage>21</lpage>.<pub-id pub-id-type="pmid">20106820</pub-id></mixed-citation>
    </ref>
    <ref id="btad407-B40">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Wicker</surname><given-names>J</given-names></string-name>, <string-name><surname>Lorsbach</surname><given-names>T</given-names></string-name>, <string-name><surname>Gütlein</surname><given-names>M</given-names></string-name></person-group><etal>et al</etal><article-title>enviPath—the environmental contaminant biotransformation pathway resource</article-title>. <source>Nucleic Acids Res</source><year>2016</year>;<volume>44</volume>:<fpage>D502</fpage>–<lpage>8</lpage>.<pub-id pub-id-type="pmid">26582924</pub-id></mixed-citation>
    </ref>
    <ref id="btad407-B41">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Wishart</surname><given-names>DS</given-names></string-name>, <string-name><surname>Tian</surname><given-names>S</given-names></string-name>, <string-name><surname>Allen</surname><given-names>D</given-names></string-name></person-group><etal>et al</etal><article-title>BioTransformer 3.0—a web server for accurately predicting metabolic transformation products</article-title>. <source>Nucleic Acids Res</source><year>2022</year>;<volume>50</volume>:<fpage>W115</fpage>–<lpage>23</lpage>.<pub-id pub-id-type="pmid">35536252</pub-id></mixed-citation>
    </ref>
    <ref id="btad407-B42">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Witten</surname><given-names>IH</given-names></string-name>, <string-name><surname>Frank</surname><given-names>E.</given-names></string-name></person-group><article-title>Data mining: practical machine learning tools and techniques with java implementations</article-title>. <source>SIGMOD Rec</source><year>2002</year>;<volume>31</volume>:<fpage>76</fpage>–<lpage>7</lpage>.</mixed-citation>
    </ref>
    <ref id="btad407-B43">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Zimmermann</surname><given-names>M</given-names></string-name>, <string-name><surname>Zimmermann-Kogadeeva</surname><given-names>M</given-names></string-name>, <string-name><surname>Wegmann</surname><given-names>R</given-names></string-name></person-group><etal>et al</etal><article-title>Mapping human microbiome drug metabolism by gut bacteria and their genes</article-title>. <source>Nature</source><year>2019</year>;<volume>570</volume>:<fpage>462</fpage>–<lpage>7</lpage>.<pub-id pub-id-type="pmid">31158845</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
