<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//NLM//DTD Journal Publishing DTD v2.3 20070202//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName journalpublishing.dtd?>
<?SourceDTD.Version 2.3?>
<?ConverterInfo.XSLTName jp2nlmx2.xsl?>
<?ConverterInfo.Version 2?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Bioinformatics</journal-id>
    <journal-id journal-id-type="publisher-id">bioinformatics</journal-id>
    <journal-id journal-id-type="hwp">bioinfo</journal-id>
    <journal-title-group>
      <journal-title>Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1367-4803</issn>
    <issn pub-type="epub">1367-4811</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">3232367</article-id>
    <article-id pub-id-type="doi">10.1093/bioinformatics/btr570</article-id>
    <article-id pub-id-type="publisher-id">btr570</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Original Papers</subject>
        <subj-group>
          <subject>Genome Analysis</subject>
        </subj-group>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Pyicos: a versatile toolkit for the analysis of high-throughput sequencing data</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Althammer</surname>
          <given-names>Sonja</given-names>
        </name>
        <xref ref-type="aff" rid="AFF1">
          <sup>1</sup>
        </xref>
        <xref ref-type="fn" rid="FN1">
          <sup>†</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>González-Vallinas</surname>
          <given-names>Juan</given-names>
        </name>
        <xref ref-type="aff" rid="AFF1">
          <sup>1</sup>
        </xref>
        <xref ref-type="fn" rid="FN1">
          <sup>†</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Ballaré</surname>
          <given-names>Cecilia</given-names>
        </name>
        <xref ref-type="aff" rid="AFF1">
          <sup>2</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Beato</surname>
          <given-names>Miguel</given-names>
        </name>
        <xref ref-type="aff" rid="AFF1">
          <sup>1</sup>
        </xref>
        <xref ref-type="aff" rid="AFF1">
          <sup>2</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Eyras</surname>
          <given-names>Eduardo</given-names>
        </name>
        <xref ref-type="aff" rid="AFF1">
          <sup>1</sup>
        </xref>
        <xref ref-type="aff" rid="AFF1">
          <sup>3</sup>
        </xref>
        <xref ref-type="corresp" rid="COR1">
          <sup>*</sup>
        </xref>
      </contrib>
    </contrib-group>
    <aff id="AFF1"><sup>1</sup>Universitat Pompeu Fabra, <sup>2</sup>Centre for Genomic Regulation (CRG), Dr Aiguader 88, E08003 Barcelona and <sup>3</sup>Catalan Institution for Research and Advanced Studies (ICREA), Passeig Lluís Companys 23, E08010 Barcelona, Spain</aff>
    <author-notes>
      <corresp id="COR1">* To whom correspondence should be addressed.</corresp>
      <fn>
        <p>Associate editor: Alex Bateman</p>
      </fn>
    </author-notes>
    <pub-date pub-type="ppub">
      <day>15</day>
      <month>12</month>
      <year>2011</year>
    </pub-date>
    <pub-date pub-type="epub">
      <day>12</day>
      <month>10</month>
      <year>2011</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>12</day>
      <month>10</month>
      <year>2011</year>
    </pub-date>
    <!-- PMC Release delay is 0 months and 0 days and was based on the
							<pub-date pub-type="epub"/>. -->
    <volume>27</volume>
    <issue>24</issue>
    <fpage>3333</fpage>
    <lpage>3340</lpage>
    <history>
      <date date-type="received">
        <day>16</day>
        <month>7</month>
        <year>2011</year>
      </date>
      <date date-type="rev-recd">
        <day>20</day>
        <month>9</month>
        <year>2011</year>
      </date>
      <date date-type="accepted">
        <day>6</day>
        <month>10</month>
        <year>2011</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2011. Published by Oxford University Press.</copyright-statement>
      <copyright-year>2011</copyright-year>
      <license license-type="creative-commons" xlink:href="http://creativecommons.org/licenses/by-nc/3.0">
        <license-p><!--CREATIVE COMMONS-->This is an Open Access article distributed under the terms of the Creative Commons Attribution Non-Commercial License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by-nc/3.0">http://creativecommons.org/licenses/by-nc/3.0</ext-link>), which permits unrestricted non-commercial use, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <abstract>
      <p><bold>Motivation:</bold> High-throughput sequencing (HTS) has revolutionized gene regulation studies and is now fundamental for the detection of protein–DNA and protein–RNA binding, as well as for measuring RNA expression. With increasing variety and sequencing depth of HTS datasets, the need for more flexible and memory-efficient tools to analyse them is growing.</p>
      <p><bold>Results:</bold> We describe <italic>Pyicos</italic>, a powerful toolkit for the analysis of mapped reads from diverse HTS experiments: ChIP-Seq, either punctuated or broad signals, CLIP-Seq and RNA-Seq. We prove the effectiveness of <italic>Pyicos</italic> to select for significant signals and show that its accuracy is comparable and sometimes superior to that of methods specifically designed for each particular type of experiment. <italic>Pyicos</italic> facilitates the analysis of a variety of HTS datatypes through its flexibility and memory efficiency, providing a useful framework for data integration into models of regulatory genomics.</p>
      <p><bold>Availability:</bold> Open-source software, with tutorials and protocol files, is available at <ext-link ext-link-type="uri" xlink:href="http://regulatorygenomics.upf.edu/pyicos">http://regulatorygenomics.upf.edu/pyicos</ext-link> or as a Galaxy server at <ext-link ext-link-type="uri" xlink:href="http://regulatorygenomics.upf.edu/galaxy">http://regulatorygenomics.upf.edu/galaxy</ext-link></p>
      <p>
        <bold>Contact:</bold>
        <email>eduardo.eyras@upf.edu</email>
      </p>
      <p><bold>Supplementary Information:</bold><ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/cgi/content/full/btr570/DC1">Supplementary data</ext-link> are available at <italic>Bioinformatics</italic> online.</p>
    </abstract>
    <counts>
      <page-count count="8"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec id="SEC1">
    <title>1 INTRODUCTION</title>
    <p>Gene expression is regulated through a complex network of protein interactions with RNA and DNA. Recent advances in high-throughput sequencing (HTS) technologies provide a very effective way to obtain information about these interactions at genome-wide level at reasonable cost. ChIP-Seq (chromatin immunoprecipitation followed by HTS) has become the preferred method for current analysis of transcriptional regulation <italic>in vivo</italic>, since it provides genome-wide coverage at a high sensitivity and signal-to-noise ratio (<xref ref-type="bibr" rid="B7">Johnson <italic>et al.</italic>, 2007</xref>; <xref ref-type="bibr" rid="B24">Robertson <italic>et al.</italic>, 2007</xref>). However, to unravel the complete gene expression network, it is also necessary to systematically identify protein–RNA interactions in cells. HITS-CLIP or CLIP-Seq (cross-linking immunoprecipitation followed by HTS) provides a powerful mean to obtain global information about direct protein–RNA interactions in cells (<xref ref-type="bibr" rid="B12">Licatalosi <italic>et al.</italic>, 2008</xref>; <xref ref-type="bibr" rid="B35">Xue <italic>et al.</italic>, 2009</xref>). Additionally, the RNA-Seq experiments provide a way to measure RNA levels at a higher sensitivity and coverage than microarray experiments. Despite the inherent biases, RNA-Seq can overcome some of the array limitations and provides the possibility to measure alternative splicing events (<xref ref-type="bibr" rid="B19">Pan <italic>et al.</italic>, 2008</xref>; <xref ref-type="bibr" rid="B32">Wang <italic>et al.</italic>, 2008a</xref>) or expression levels (<xref ref-type="bibr" rid="B21">Pepke <italic>et al.</italic>, 2009</xref>; <xref ref-type="bibr" rid="B30">Trapnell <italic>et al.</italic>, 2010</xref>), to detect single nucleotide polymorphisms (<xref ref-type="bibr" rid="B33">Wang <italic>et al.</italic>, 2008b</xref>) and to discover novel genes (<xref ref-type="bibr" rid="B10">Khalil <italic>et al.</italic>, 2009</xref>). Short-read sequencing platforms such as Illumina are very suitable for the study of protein–DNA and protein–RNA interactions, since they can produce enough data to perform accurate quantitative analysis. Furthermore, the resulting reads are of sufficient length to be mapped accurately to a reference sequence, but short enough to define the interaction sites with enough precision. However, not all interactions can be detected at the same coverage. For instance, transcription factors produce generally a clearly localized, or punctuated, signal (<xref ref-type="bibr" rid="B20">Park, 2009</xref>), whereas histone marks or RNA polymerase II (RNAPII) produce broad signals, covering more extended regions (<xref ref-type="bibr" rid="B20">Park, 2009</xref>). Most of the tools published for the analysis of ChIP-Seq data focus on punctuated signals (<xref ref-type="bibr" rid="B4">Fejes <italic>et al.</italic>, 2008</xref>; <xref ref-type="bibr" rid="B16">Nix <italic>et al.</italic>, 2008</xref>; <xref ref-type="bibr" rid="B20">Park, 2009</xref>; <xref ref-type="bibr" rid="B21">Pepke <italic>et al.</italic>, 2009</xref>; <xref ref-type="bibr" rid="B38">Zhang <italic>et al.</italic>, 2008</xref>), with only few methods devoted to analyse broad signals (<xref ref-type="bibr" rid="B28">Shin <italic>et al.</italic>, 2009</xref>; <xref ref-type="bibr" rid="B39">Zang <italic>et al.</italic>, 2009</xref>). However, these methods are not readily applicable to other HTS datatypes, like CLIP-Seq or RNA-Seq, making it necessary to incorporate additional tools to perform gene regulation studies, which generally involve multiple HTS experiments. The increase in variety and sequencing depth of such experiments, as well as the growing need for memory-efficient tools that can be applied to various datatypes, motivated us to develop <italic>Pyicos</italic>.</p>
    <p>In this article, we describe <italic>Pyicos</italic>, a versatile toolkit operating on short HTS reads that have already been mapped to a reference coordinate system, like a genome or a transcriptome. We demonstrate its accuracy on punctuated ChIP-Seq data comparing it to MACS (<xref ref-type="bibr" rid="B38">Zhang <italic>et al.</italic>, 2008</xref>), FindPeaks (<xref ref-type="bibr" rid="B4">Fejes <italic>et al.</italic>, 2008</xref>) and USeq (<xref ref-type="bibr" rid="B16">Nix <italic>et al.</italic>, 2008</xref>), using published ChIP-Seq datasets. We also describe the accuracy of <italic>Pyicos</italic> enrichment analysis (EA) to detect differentially expressed (DE) genes from RNA-Seq data by comparing it with the Bioconductor packages DEGseq (<xref ref-type="bibr" rid="B34">Wang <italic>et al.</italic>, 2010</xref>), DESeq (<xref ref-type="bibr" rid="B1">Anders and Huber, 2010</xref>) and edgeR (<xref ref-type="bibr" rid="B25">Robinson <italic>et al.</italic>, 2010</xref>) using published RNA-Seq data and microarray experiments on the same samples. Furthermore, we illustrate the flexibility of <italic>Pyicos</italic> by showing its effectiveness on other HTS datatypes: broad ChIP-Seq signals and CLIP-Seq data. Finally, we also discuss the performance of <italic>Pyicos</italic> in terms of memory usage and CPU time.</p>
    <p><italic>Pyicos</italic> provides different protocols to define significant signals from ChIP-Seq (both punctuated and broad), CLIP-Seq and RNA-Seq data; and all operations can be applied independently or combined in a protocol file, which makes <italic>Pyicos</italic> useful for the integrative analysis of a wide variety of HTS data. Moreover, the software has a modular architecture that allows re-usability in other Python applications. <italic>Pyicos</italic> thus offers a useful framework to facilitate the analysis of a variety of HTS datatypes, providing the basis for data integration into gene regulation studies.</p>
  </sec>
  <sec id="SEC2">
    <title>2 METHODS</title>
    <p><italic>Pyicos</italic> is written in Python and is available under the GNU General Public License. It can operate from the command line or as a software library within Python programs (tested on GNU/Linux Fedora 12 and MAC OSX). All operations can be used independently and the parameters can be set by the user; thus providing as much flexibility as possible. Additionally, <italic>Pyicos</italic> can be run using protocols files (<ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/cgi/content/full/btr570/DC1">Supplementary Fig. S1</ext-link> and <ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/cgi/content/full/btr570/DC1">Supplementary Material</ext-link>), which allows the user to apply them directly for standard analyses or to design customized workflows.</p>
    <p><italic>Pyicos</italic> has its own compressed format for peaks as explained in the <ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/cgi/content/full/btr570/DC1">Supplementary Material</ext-link>. This is also used as an internal representation for read clusters, and can be used as input and output formats. Furthermore, <italic>Pyicos</italic> can handle other various formats, providing converter capabilities. It can read eland, SAM, BED and wiggle (fixed and variable step); and write to SAM, BED and wiggle (fixed and variable step). Some formats are obligatory for some of the operations, which are specified in the corresponding command help.</p>
    <sec id="SEC2.1">
      <title>2.1 Callpeaks protocol</title>
      <p>The <italic>callpeaks</italic> protocol is applied to punctuated ChIP-Seq data and starts by optionally removing duplicated reads, i.e. redundant reads in terms of position and strand in a genome. Next, all reads that fall into a set of regions specified by the user, such as satellites and pericentromeric regions, are removed, as they generally lead to false positives (FPs). Reads are extended to the expected initial fragment size, given as input. Alternatively, <italic>Pyicos</italic> can also estimate this extension using a shift correlation analysis (<xref ref-type="bibr" rid="B38">Zhang <italic>et al.</italic>, 2008</xref>). Next, reads are grouped into read clusters according to genomic overlap. To follow standard nomenclature, for punctuated data we will refer to read clusters as peaks. When a control experiment is available, <italic>callpeaks</italic> normalizes the sample with respect to control and subtracts the profile of the control from that of the sample with nucleotide resolution (<ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/cgi/content/full/btr570/DC1">Supplementary Material</ext-link>). At this stage, <italic>callpeaks</italic> removes two possible artefacts: peaks that are shorter than a certain length (100 nt by default), which may be produced by the subtraction step; and block-like peaks, which may occur when duplicates are kept. This removal is optional to the user. <italic>Pyicos</italic> also includes a split operation, which allows exploring the possibility that some peaks may describe multiple binding sites. Finally, <italic>callpeaks</italic> calculates the significance for a peak to correspond to a real binding site using Poisson analysis applied to three different parameters: the peak height, the number of reads per peak and the number of reads per nucleotide. For each chromosome, a <italic>P</italic>-value is calculated independently for each of these parameters. We also define a peak score as a combination of the Poisson <italic>P</italic>-value and the peak parameter <italic>P</italic>: peak score=[<italic>P</italic> − log<sub>10</sub>(P-value)]/2, for <italic>P</italic> equal to either the peak height or the peak read count.</p>
    </sec>
    <sec id="SEC2.2">
      <title>2.2 Benchmarking of callpeaks</title>
      <p>We compared <italic>Pyicos</italic> with MACS (<xref ref-type="bibr" rid="B38">Zhang <italic>et al.</italic>, 2008</xref>) version 1.3.7.1, FindPeaks (<xref ref-type="bibr" rid="B4">Fejes <italic>et al.</italic>, 2008</xref>) version 3.3 and USeq (<xref ref-type="bibr" rid="B16">Nix <italic>et al.</italic>, 2008</xref>) version 7.2, using ChIP-Seq datasets for four different factors: the insulator (CTCF) in K562 cells (<xref ref-type="bibr" rid="B3">ENCODE Consortium, 2011</xref>), the CCAAT/enhancer-binding protein alpha (CEBPA) in liver cells (<xref ref-type="bibr" rid="B27">Schmidt <italic>et al.</italic>, 2010</xref>), the neuron-restrictive silencer factor (NRSF) in Jurkat T cells (<xref ref-type="bibr" rid="B7">Johnson, Mortazavi, <italic>et al.</italic>, 2007</xref>) and the progesterone receptor (PR) in T47D cells (<xref ref-type="bibr" rid="B31">Vicent <italic>et al.</italic>, 2011</xref>). We have used various measures to evaluate the quality of peak definition on the punctuated ChIP-Seq data. Two of the descriptors of the peak definition used are the peak length and the distance between the peak centre and summit, i.e. the position with the highest read pileup. We further compared the rankings of the peaks provided by each method: the <italic>peak score</italic> (<italic>Pyicos</italic>), the <italic>peak height</italic> (FindPeaks), the value of −10·log<sub>10</sub>(<italic>P</italic>-value) (MACS) and the <italic>ranking</italic> provided by USeq.</p>
      <p>For the accuracy evaluation, we also used the 83 positive and 30 negative regions validated by ChIP-qPCR for NRSF (<xref ref-type="bibr" rid="B14">Mortazavi <italic>et al.</italic>, 2006</xref>) as done in <xref ref-type="bibr" rid="B7">Johnson <italic>et al.</italic> (2007</xref>). Since peaks differ a lot in their extensions (<ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/cgi/content/full/btr570/DC1">Supplementary Fig. S2</ext-link>), we took a region of 100 nt centred on the summit as the predicted binding region. We classified the peaks from each method as true positives (TPs) and FPs depending on whether the 100 nt long region centred on the summit overlapped a positive or negative validated region, respectively. The true positive rate (TPR) was calculated as TP over the total number of positive regions and the false positive rate (FPR) was calculated as FP over the total number of negative regions. Receiver operating characteristic (ROC) curves were calculated using incremental subsets of peaks along the ranked peaks from each method, with increasing subset sizes of 500 peaks.</p>
      <p>An additional measure of the quality of the predictions is the fraction of peaks associated to the expected motif (<xref ref-type="bibr" rid="B6">Ji <italic>et al.</italic>, 2008</xref>; <xref ref-type="bibr" rid="B38">Zhang <italic>et al.</italic>, 2008</xref>). We thus measured the fraction of peaks with motif occurrence in the sequence underlying the summit, considering 100 nt for NRSF and PR peaks and 200 nt for CEBPA and CTCF peaks. For the motif analysis, we scanned the selected sequences from the peaks using the matrices for NRSF, CTCF, CEBPA and the three available matrices for PR from TRANSFAC (<xref ref-type="bibr" rid="B11">Knüppel <italic>et al.</italic>, 1994</xref>) (accession numbers: M00256, M01200, M00116, M00954, M00957, M00960) using a custom script. We used as core similarity cut-off 0.99 and as total similarity cut-off 0.85. As the summit of a peak is associated more strongly with the binding motif than the peak centre (<ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/cgi/content/full/btr570/DC1">Supplementary Fig. S3</ext-link>), we considered it as a suitable reference position. Additionally, we used as fourth descriptor the spatial resolution, i.e. the distance from the summit position to the centre of the detected motif.</p>
      <p>Finally, for all four ChIP-Seq datasets, we considered the <italic>Pyicos</italic> rankings using both the peak height and read count scores. For further analyses, we selected the score that gives the best motif content in top-scoring peaks: the peak height score for PR and CEBPA, and the read count score for CTCF and NRSF.</p>
    </sec>
    <sec id="SEC2.3">
      <title>2.3 Enrichment protocol</title>
      <p><italic>Pyicos</italic> incorporates a method to calculate the significance of the enrichment of the signal between two samples based on the comparison with the distribution of enrichment values on the same regions for experimental or theoretical replicas, similarly to the methods MATR and MARS from DEGseq (<xref ref-type="bibr" rid="B34">Wang <italic>et al.</italic>, 2010</xref>). Using subsets of ∼5% of neighbouring data points along the axis of average densities <italic>A</italic>, the enrichment values <italic>M</italic> calculated for genes between RNA-Seq samples for two liver replicas from <xref ref-type="bibr" rid="B13">Marioni <italic>et al.</italic> (2008</xref>) follow a normal distribution (<ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/cgi/content/full/btr570/DC1">Supplementary Fig. S4</ext-link>). Accordingly, <italic>Pyicos</italic> uses a sliding window along the <italic>A</italic> axis and calculates a <italic>Z</italic>-score for the enrichment <italic>M</italic> of each region from the comparison of the replicas (details in <ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/cgi/content/full/btr570/DC1">Supplementary Material</ext-link>). The region is assigned to a background window according to proximity: the region is compared with the values of the window which centre is closest to the region in terms of the value of <italic>A</italic>. If no replicas are provided, theoretical replicas are created by randomly rearranging the reads into two subsets, taking into account the relative sizes of the original samples. We integrated the TMM normalization (<xref ref-type="bibr" rid="B25">Robinson and Oshlack, 2010</xref>) in <italic>Pyicos</italic> EA. The calculation of the TMM factor on our read count lists yielded a value of 0.68 for liver versus kidney and a value of 1.01 for the comparison of the two liver replicas, which agrees with the results reported in <xref ref-type="bibr" rid="B25">Robinson and Oshlack (2010</xref>).</p>
      <p><italic>Pyicos</italic> EA can have read counts or reads per kilobase per million reads (RPKM) (<xref ref-type="bibr" rid="B15">Mortazavi <italic>et al.</italic>, 2008</xref>) as input; or alternatively, directly the BED files with regions and read coordinates, overcoming the need of an additional tool to count reads. Additionally, <italic>Pyicos</italic> can calculate enriched regions <italic>de novo</italic> by scanning the samples provided, using two configurable parameters, the proximity between two reads to be taken as part of the same region, and the minimum number of reads in the region to be considered.</p>
    </sec>
    <sec id="SEC2.4">
      <title>2.4 Benchmarking of EA</title>
      <p>To assess the accuracy of <italic>Pyicos</italic> in the prediction of DE genes, we compared it to three other methods, DEGseq (<xref ref-type="bibr" rid="B34">Wang <italic>et al.</italic>, 2010</xref>), DESeq (<xref ref-type="bibr" rid="B1">Anders and Huber, 2010</xref>) and edgeR (<xref ref-type="bibr" rid="B25">Robinson <italic>et al.</italic>, 2010</xref>); using published datasets for RNA-Seq and equivalent microarray experiments for liver and kidney samples (<xref ref-type="bibr" rid="B13">Marioni <italic>et al.</italic>, 2008</xref>). First, we mapped the microarray results to the Ensembl annotation (<xref ref-type="bibr" rid="B5">Flicek <italic>et al.</italic>, 2011</xref>). Then, using the microarray data, we defined a benchmarking set composed of DE and non-DE genes. DE genes were defined to have False Discovery Rate (FDR) &lt;0.001 and an absolute log<sub>2</sub>-fold change &gt;0.5 (<xref ref-type="bibr" rid="B13">Marioni <italic>et al.</italic>, 2008</xref>), regardless of whether they are up- or down-regulated. Non-DE genes were defined to have an FDR &gt;0.01 and an absolute log<sub>2</sub>-fold change of at most 0.5. This benchmarking set is composed of 6700 DE genes and 7060 non-DE genes. To predict DE genes, we considered for each Ensembl locus the mean of the values for read counts or RPKM for the corresponding Ensembl transcripts in the locus. The RPKM and read count per transcript were calculated with reads falling within the exons of each transcript. A pseudocount of one read per transcript was added to be able to operate with transcripts whose exons did not have any reads in any of the samples. We estimated the TPs and FPs as the number of predicted DE (enriched or depleted) genes that were annotated as DE or non-DE genes in the benchmarking set, respectively. ROC curves were calculated by considering increasing absolute values of the <italic>Z</italic>-score or −log10(<italic>P</italic>-value) for the predictions for each method. We also calculated precision–recall curves along <italic>Z</italic>-score thresholds, where precision is the ratio of TP over the number of predicted cases and recall is the same as the TPR.</p>
    </sec>
    <sec id="SEC2.5">
      <title>2.5 Enrichment on ChIP-Seq data</title>
      <p>We performed EA on broad ChIP-Seq signals using ENCODE data for H3K36me3 and RNAPII, and correlated the results to the enrichment of RNA-Seq data, for the K562 and NHEK cells (<xref ref-type="bibr" rid="B3">ENCODE Consortium, 2011</xref>). The calculation of significantly enriched or depleted regions was based on RPKM values. Replicas 1 and 2 from K562 and replica 1 from NHEK were used to calculate enrichment on three different types of regions from the Ensembl annotation (<xref ref-type="bibr" rid="B5">Flicek <italic>et al.</italic>, 2011</xref>): for H3K36me3 we used the transcript-body, spanning from the transcription start site (TSS) to the transcription termination site (TTS); for RNAPII we used a window of 4 kb around the TSS; and the transcript exons for RNA-Seq, as before. Significant regions were defined as those with an absolute <italic>Z</italic>-score &gt;10. We calculated the Pearson's correlation coefficient of <italic>Z</italic>-scores from significant regions between H3K36me3 and RNA-Seq, as well as between RNAPII and RNA-Seq.</p>
    </sec>
    <sec id="SEC2.6">
      <title>2.6 Memory usage and running time benchmarking</title>
      <p>To test the memory usage and running time of the <italic>callpeaks</italic> protocol, we used ChIP-Seq data for the human transcription factor CEBPA (<xref ref-type="bibr" rid="B27">Schmidt <italic>et al.</italic>, 2010</xref>). To simulate files of different sizes, we first pooled together all available reads and took random subsets with an increasing size step of 3 million reads, up to 30 million reads, separately for sample and control. In each run, we subsampled two random sets of equal size from the ChIP-Seq reads and from control, using steps of 3 million reads.</p>
      <p>In order to test the performance of <italic>Pyicos</italic> EA, we compared it to DEGSeq and to a combination of BEDTools (<xref ref-type="bibr" rid="B23">Quinlan and Hall, 2010</xref>) with edgeR and DESeq, as these two programs do not accept as input BED files with the regions of interest and the positions of the mapped reads from the samples to be compared. In this way, all four calculations start with the same input: BED files for the samples and the region file. We used the same CEBPA data mentioned before and we calculated the enrichment in the region of 2 kb upstream of the TSS for RefSeq annotated genes. This time we sampled twice per run on the experiment, in order to get a simulated replica, and once for the control. We sampled reads increasing by 3 million reads in each run.</p>
    </sec>
  </sec>
  <sec id="SEC3">
    <title>3 RESULTS</title>
    <sec id="SEC3.1">
      <title>3.1 Analysis of punctuated ChIP-Seq data</title>
      <p>The problem of peak detection entails two challenges: first, to determine significant peaks by distinguishing between real and false binding signal; and secondly, once we have selected the candidate peaks, we need to properly determine the site of interaction. In what follows, we use various methods to establish the accuracy and quality of peak prediction for <italic>Pyicos</italic> and three other published methods for punctuated ChIP-Seq analysis. But first, we assess the effectiveness of <italic>Pyicos</italic> operations for peak definition using ChIP-Seq datasets for NRSF, PR, CTCF and CEBPA.</p>
      <p>ChIP-Seq analysis often starts by removing duplicated reads, i.e. redundant reads in terms of position and strand in a genome. This has been suggested to eliminate amplification biases (<xref ref-type="bibr" rid="B38">Zhang <italic>et al.</italic>, 2008</xref>). We observe that keeping duplicates does not produce any improvement on the four sets and that, in fact, the highest fraction of peaks with motifs is achieved when all duplicates are removed (<ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/cgi/content/full/btr570/DC1">Supplementary Fig. S5</ext-link>). An additional way to remove experimental biases, which may introduce FPs, is the use of a control. When this is available, <italic>callpeaks</italic> subtracts the control from the sample after normalization (<ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/cgi/content/full/btr570/DC1">Supplementary Material</ext-link>). To test whether <italic>Pyicos</italic> subtraction improves peak detection, we generated peaks with and without the subtraction of the control. We observe a great improvement in peak detection for CEBPA (<xref ref-type="fig" rid="F1">Fig. 1</xref>a), CTCF and PR (<ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/cgi/content/full/btr570/DC1">Supplementary Fig. S6</ext-link>), while we only saw a slight increase for the top peaks for NRSF (<xref ref-type="fig" rid="F1">Fig. 1</xref>b). Interestingly, the subtraction of the control results into almost no difference in the spatial resolution (<ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/cgi/content/full/btr570/DC1">Supplementary Fig. S7</ext-link>).
<fig id="F1" position="float"><label>Fig. 1.</label><caption><p>Properties of candidate peaks. Cumulative plots of the fraction of <italic>Pyicos</italic> peaks with a motif along the ranking selected by Poisson <italic>P</italic>-value cut-offs for peaks with and without subtraction for (<bold>a</bold>) CEBPA and (<bold>b</bold>) NRSF. Cumulative plot of the fraction of peaks with motifs along the ranking for the top 3000 peaks predicted by <italic>Pyicos</italic>, MACS, FindPeaks and USeq, for (<bold>c</bold>) PR and (<bold>d</bold>) CTCF. (<bold>e</bold>) Memory performance of the same four methods on the CEBPA ChIP-Seq data.</p></caption><graphic xlink:href="btr570f1"/></fig></p>
      <p>To explore the possibility that some regions of ChIP-Seq signal may describe multiple binding sites, <italic>Pyicos</italic> includes the option to split peaks (<ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/cgi/content/full/btr570/DC1">Supplementary Material</ext-link>). We found that splitting peaks showed improvement only on the CTCF dataset, while spatial resolution was maintained (<ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/cgi/content/full/btr570/DC1">Supplementary Fig. S8</ext-link>). The protocol <italic>callpeaks</italic> incorporates a Poisson test on the retained peaks to select those that are more likely to be functional (<xref ref-type="sec" rid="SEC2">Section 2</xref>). Although the Poisson distribution seems not to fit well the background biases of ChIP-Seq experiments (<xref ref-type="bibr" rid="B38">Zhang <italic>et al.</italic>, 2008</xref>), our analyses indicate that by subtracting the control we remove these biases and Poisson analysis can be applied. Each predicted peak is given a peak-score and a <italic>P</italic>-value (<xref ref-type="sec" rid="SEC2">Section 2</xref>). The peak score gives a ranking for all peaks, whereas the <italic>P</italic>-value is used to select a subset of candidate peaks with certain significance. In order to show that the peak score produces an appropriate ranking, we calculated the fraction of peaks containing the expected motif along ranked peaks. We observe that for increasing cut-offs of the <italic>P</italic>-value, the fraction of peaks with motifs decreases with the peak score (<ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/cgi/content/full/btr570/DC1">Supplementary Fig. 9</ext-link>). The selection of candidate peaks by <italic>P</italic>-value is therefore consistent with the expected association of significant peaks to functional motifs. The peak score can be calculated using the peak height or read count. On the one hand, we found no differences in peak quality on NRSF and slight differences on CTCF and CEBPA, using peak height or read count. On the other hand, the peak height score for PR results into an increased fraction of peaks with motifs relative to the read count score (<ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/cgi/content/full/btr570/DC1">Supplementary Fig. S10</ext-link>).</p>
    </sec>
    <sec id="SEC3.2">
      <title>3.2 Comparing peak detection with other methods</title>
      <p>In order to further assess the quality of <italic>Pyicos</italic> peak calling, we compared <italic>Pyicos</italic> with three other methods: MACS, FindPeaks and USeq. We evaluated the peak definition of the four methods in terms of motif content (<xref ref-type="sec" rid="SEC2">Section 2</xref>). They all show a similar trend along the ranking, with <italic>Pyicos</italic> and MACS showing higher densities for all ranking positions (<xref ref-type="fig" rid="F1">Fig. 1</xref>c and d and <ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/cgi/content/full/btr570/DC1">Supplementary Fig. S11</ext-link>). Moreover, calculating the spatial resolution (<xref ref-type="sec" rid="SEC2">Section 2</xref>), the four methods show the largest agreement for the PR dataset, whereas USeq shows the lowest spatial resolution on NRSF, CEBPA and CTCF (<ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/cgi/content/full/btr570/DC1">Supplementary Fig. S12</ext-link>).</p>
      <p>We also evaluated the accuracy of peak definition measuring the overlap of the selected peaks with a benchmarking set of positive and negative NRSF binding regions validated by ChIP-qPCR (<xref ref-type="sec" rid="SEC2">Section 2</xref>). All four methods show high agreement for their top 3000 NRSF peaks in terms of overlap (<ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/cgi/content/full/btr570/DC1">Supplementary Table S1</ext-link>) and in terms of the pairwise correlations (<ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/cgi/content/full/btr570/DC1">Supplementary Table S2</ext-link>); hence, we expect they would achieve similar accuracies. Indeed, the four methods perform similarly well with an area under the ROC curve (AUC) between 0.90 and 0.91 (<xref ref-type="table" rid="T1">Table 1</xref>). We also compared the accuracy of peak definition of the selected peaks by calculating the distances between summit and peak centre as well as the lengths of the peaks. We found that USeq, which produces the shortest peaks (<ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/cgi/content/full/btr570/DC1">Supplementary Fig. S2</ext-link>), achieves the shortest distance between summit and peak centre, closely followed by <italic>Pyicos</italic> (<ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/cgi/content/full/btr570/DC1">Supplementary Fig. S13</ext-link>).
<table-wrap id="T1" position="float"><label>Table 1.</label><caption><p>AUC for peaks predicted by each tested method, using the ChIP-qPCR-validated NRSF regions for benchmarking</p></caption><table frame="hsides" rules="groups"><thead align="left"><tr><th rowspan="1" colspan="1"/><th rowspan="1" colspan="1">Pyicos</th><th rowspan="1" colspan="1">MACS</th><th rowspan="1" colspan="1">FindPeaks</th><th rowspan="1" colspan="1">USeq</th></tr></thead><tbody align="left"><tr><td rowspan="1" colspan="1">AUC</td><td rowspan="1" colspan="1">0.9</td><td rowspan="1" colspan="1">0.9</td><td rowspan="1" colspan="1">0.91</td><td rowspan="1" colspan="1">0.9</td></tr></tbody></table></table-wrap>
</p>
      <p>Finally, in order to test our software performance, we used ChIP-Seq data for the human transcription factor CEBPA (<xref ref-type="bibr" rid="B27">Schmidt <italic>et al.</italic>, 2010</xref>) (<xref ref-type="sec" rid="SEC2">Section 2</xref>). Running all four methods with conditions as similar as possible (<ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/cgi/content/full/btr570/DC1">Supplementary Material</ext-link>), we observed that <italic>Pyicos</italic> is more efficient in memory usage than the other three methods (<xref ref-type="fig" rid="F1">Fig. 1</xref>e) and stays competitive in running time (<ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/cgi/content/full/btr570/DC1">Supplementary Fig. S14</ext-link>).</p>
    </sec>
    <sec id="SEC3.3">
      <title>3.3 EA on RNA-Seq data</title>
      <p>Methods to measure differential gene expression from RNA-Seq are generally based on EA between samples (<xref ref-type="bibr" rid="B1">Anders and Huber, 2010</xref>; <xref ref-type="bibr" rid="B2">Bullard <italic>et al.</italic>, 2010</xref>; <xref ref-type="bibr" rid="B18">Oshlack <italic>et al.</italic>, 2010</xref>; <xref ref-type="bibr" rid="B25">Robinson and Oshlack, 2010</xref>; <xref ref-type="bibr" rid="B34">Wang <italic>et al.</italic>, 2010</xref>). <italic>Pyicos</italic> incorporates a method to detect regions of significant enrichment between two samples based on the comparison of the observed enrichment values with those measured between two replicas (<xref ref-type="sec" rid="SEC2">Section 2</xref>). In order to establish the accuracy of <italic>Pyicos</italic> for detecting DE genes, we compared it first to the methods MATR (with replicas) and MARS (without replicas) from DEGseq (<xref ref-type="bibr" rid="B34">Wang <italic>et al.</italic>, 2010</xref>), using RNA-Seq data from liver and kidney (<xref ref-type="bibr" rid="B13">Marioni <italic>et al.</italic>, 2008</xref>). Both methods, DEGseq and <italic>Pyicos</italic>, can accept as input read counts or RPKM values for each gene; and they also can estimate a theoretical replica when an experimental one is not provided. We measured the significance of the enrichment of liver over kidney in all genes using four different combinations of input data: replicated count, non-replicated count, replicated RPKM and non-replicated RPKM. Comparing the <italic>Z</italic>-scores calculated by <italic>Pyicos</italic> and DEGseq, we observe a high correlation between both methods for all the inputs (<ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/cgi/content/full/btr570/DC1">Supplementary Table 3</ext-link>).</p>
      <p>To further estimate the accuracy of <italic>Pyicos</italic> EA, we also ran DESeq (<xref ref-type="bibr" rid="B1">Anders and Huber, 2010</xref>) and edgeR (<xref ref-type="bibr" rid="B25">Robinson <italic>et al.</italic>, 2010</xref>), on the same benchmarking sets, using again the four different input types. Using the microarray experiments from <xref ref-type="bibr" rid="B13">Marioni <italic>et al.</italic> (2008</xref>), we created a benchmarking set (<xref ref-type="sec" rid="SEC2">Section 2</xref>). We found an overall good performance for <italic>Pyicos</italic>, with AUCs between 0.791 and 0.813 and a behaviour similar to DEGseq. All four methods agree similarly well with the benchmarking set when replicated read count data is used (<xref ref-type="fig" rid="F2">Fig. 2</xref>a). However, we find greater disagreements between methods and lower accuracy for the other three input combinations (<ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/cgi/content/full/btr570/DC1">Supplementary Fig. S15 a–c</ext-link>). Moreover, the precision–recall curves show a similar level of agreement for replicated read count data (<xref ref-type="fig" rid="F2">Fig. 2</xref>b) and confirm the good performance of <italic>Pyicos</italic> for all combination of inputs (<ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/cgi/content/full/btr570/DC1">Supplementary Fig. S15 d–f</ext-link>). For DESeq, it was not possible to make calculations on non-integer values, so we restricted the calculations to counts, which resulted in a high AUC when replicas were used. Although edgeR was developed for replicated count data, it was also run with non-replicated count data and performed similarly well.
<fig id="F2" position="float"><label>Fig. 2.</label><caption><p>Prediction of DE genes. (<bold>a</bold>) ROC curves for the benchmarking against the microarray data (<xref ref-type="bibr" rid="B13">Marioni <italic>et al.</italic>, 2008</xref>) for DESeq, <italic>Pyicos</italic>, edgeR and DEGseq using read counts and replicated data. (<bold>b</bold>) Precision–recall curves for the benchmarking against microarray data for the same four methods using read counts and replicated data. (<bold>c</bold>) Memory performance of the same four methods on the EA of CEBPA ChIP-Seq dataset on the promoter region (<xref ref-type="sec" rid="SEC2">Section 2</xref>). DESeq and edgeR are run in combination with BEDTools. (<bold>d</bold>) ROC curves of the different normalization methods: read counts (Counts), TMM-normalized counts (TMM counts), RPKMs and TRPKs, for the microarray benchmarking. (<bold>e</bold>) Absolute differences of the medians from the length distributions of DE and non-DE genes calculate with <italic>Pyicos</italic> using counts, TMM-normalized counts, RPKMs, TRPKs, and the corresponding value from the microarray data.</p></caption><graphic xlink:href="btr570f2"/></fig></p>
      <p>In order to test the memory usage and processing time of <italic>Pyicos</italic> EA calculation, we applied EA from all four methods on the CEBPA dataset to compare the ChIP-Seq sample to the control sample. While <italic>Pyicos</italic> and DEGseq can be run directly on BED files, edgeR and DESeq require count data as input. Hence, we combined these last two methods with BEDTools for the comparison. Since the most time consuming and memory intensive operation is the counting of reads per region, which is done with BEDTools, edgeR and DESeq show the same behaviour. The performance of DEGseq suffers in terms CPU time and especially memory usage. Although <italic>Pyicos</italic> is not as fast as the combination of BEDTools with edgeR or DESeq, it still can handle very large datasets at much lower memory usage (<ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/cgi/content/full/btr570/DC1">Supplementary Fig. S16</ext-link> and <xref ref-type="fig" rid="F2">Fig. 2</xref>c). BEDTools algorithm compromises memory usage in exchange of execution time, whereas <italic>Pyicos</italic> algorithm focuses on memory efficiency.</p>
    </sec>
    <sec id="SEC3.4">
      <title>3.4 Normalization of the RNA-Seq data</title>
      <p>As genes have different lengths and RNA-Seq samples may vary considerably in size, proper normalization of the input data is essential. The trimmed mean of M values (TMM) normalization (<xref ref-type="bibr" rid="B25">Robinson and Oshlack, 2010</xref>) aims to correct biases due to differences in samples sizes and expression patterns. TMM normalization on count data correctly places the M median on zero on our gene set (<ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/cgi/content/full/btr570/DC1">Supplementary Figs S17a and S17b</ext-link>). We considered the combination of TMM normalization with RPKM densities, which we hypothesize that it would improve results as it takes into account both gene lengths and sample sizes. We thus define a TRPK density as the TMM-normalized Read Per Kilobase density (<ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/cgi/content/full/btr570/DC1">Supplementary Material</ext-link>). First, as expected, using TRPK we can achieve a correction of the M-median for RPKM (<ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/cgi/content/full/btr570/DC1">Supplementary Figs S17c and S17d</ext-link>). Next, we assessed whether the TMM normalization also results in an improvement of the accuracy calculation using the array results. However, for this particular benchmarking set, we could not observe such an improvement (<xref ref-type="fig" rid="F2">Fig. 2</xref>d).</p>
      <p>Intriguingly, read counts seem to perform slightly better in our benchmarking analysis, as shown above. However, they have been observed to produce length biases in the determination of DE genes (<xref ref-type="bibr" rid="B17">Oshlack and Wakefield, 2009</xref>). To explore the correction effect of the various normalizations on the length biases, we calculated the lengths for all DE and non-DE genes predicted by <italic>Pyicos</italic> EA using counts, TMM normalized counts, RPKM and TRPK; and compared them to the lengths of the DE and non-DE genes from the microarray results (<ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/cgi/content/full/btr570/DC1">Supplementary Fig. S18</ext-link>). We observe a significant difference between the absolute length medians of DE and non-DE genes when normalized counts are not used. However, this difference decreases when we use the RPKM and TMM-normalized read counts, achieving the smallest difference and reaching a similar value to the one found for the microarray when TRPK is used (<xref ref-type="fig" rid="F2">Fig. 2</xref>e).</p>
    </sec>
    <sec id="SEC3.5">
      <title>3.5 EA on broad ChIP-Seq data</title>
      <p>We next provide evidence that <italic>Pyicos</italic> EA approach is also suitable for the analysis of broad ChIP-Seq data when comparing two conditions. Broad ChIP-Seq data does not generally produce clearly delimited regions; hence, one cannot speak of peaks. However, it is interesting to be able to measure how the signal changes between two conditions or cell types in specific regions. <italic>Pyicos</italic> allows the calculation of significant enrichment in predefined regions, e.g. gene-body, promoter regions, etc., which are given as input in a BED file. To show the applicability of <italic>Pyicos</italic> on broad ChIP-Seq data, we tried to reproduce the relation between RNAPII activity and transcription (<xref ref-type="bibr" rid="B29">Sultan <italic>et al.</italic>, 2008</xref>) and between the H3K36me3 chromatin signal and transcription (<xref ref-type="bibr" rid="B8">Joshi and Struhl, 2005</xref>; <xref ref-type="bibr" rid="B22">Pokholok <italic>et al.</italic>, 2005</xref>). For this, we calculated the correlation of the enrichment of H3K36me3 and RNAPII, with that of RNA-Seq using ENCODE datasets (<xref ref-type="bibr" rid="B3">ENCODE Consortium, 2011</xref>). For each datatype, we calculated the EA values of K562 over NHEK, considering the variation between two K562 replicas (<xref ref-type="sec" rid="SEC2">Section 2</xref>). We selected a cut-off of |Z-score|&gt;10, obtaining 1238 genes with significant changes in RNAPII and RNA-Seq, and 377 genes with significant changes in H3K36me3 and RNA-Seq. For these gene sets, we measured a Pearson's correlation between the enrichment <italic>Z</italic>-scores of 0.87 and 0.90, for RNAPII versus RNA-Seq and H3K36me3 versus RNA-Seq, respectively.</p>
    </sec>
    <sec id="SEC3.6">
      <title>3.6 CLIP-Seq data analysis</title>
      <p>CLIP-Seq reads can be mapped to the genome or to the transcriptome in order to detect RNA binding activity. CLIP experiments normally use a control with an unspecific antibody to check the presence of unspecific binding. However, such a control is not always sequenced; hence, a method to calculate enrichment without a control was proposed (<xref ref-type="bibr" rid="B35">Xue <italic>et al.</italic>, 2009</xref>; <xref ref-type="bibr" rid="B36">Yeo <italic>et al.</italic>, 2009</xref>). This method, called modified false discovery rate (modFDR), is included in <italic>Pyicos</italic> (<ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/cgi/content/full/btr570/DC1">Supplementary Material</ext-link>). In order to show <italic>Pyicos</italic> applicability to CLIP-Seq experiments, we reproduced the results from <xref ref-type="bibr" rid="B35">Xue <italic>et al.</italic> (2009</xref>), where the interacting RNA sites for the polypyrimidine tract binding protein were mapped to the reference human genome. We used all the mapped reads from this experiment and ran <italic>Pyicos modFDR</italic> operation considering the gene-body of the RefSeq genes as regions to calculate the significant read clusters. <italic>Pyicos</italic> retrieved 92% of the 32 298 regions defined in <xref ref-type="bibr" rid="B35">Xue <italic>et al.</italic> (2009</xref>) on the same gene set, which means 91.5% of the reported 10 515 genes having at least one significant cluster (<xref ref-type="fig" rid="F3">Fig. 3</xref>a). Moreover, the genes missed by <italic>Pyicos modFDR</italic> were those with a low number of reads: from the 467 genes missed by <italic>Pyicos</italic>, 89.7% contained clusters with heights of at most three reads (<xref ref-type="fig" rid="F3">Fig. 3</xref>b), suggesting that they are likely FPs. Moreover, there were 898 genes selected by <italic>Pyicos</italic> that were not in the predictions from <xref ref-type="bibr" rid="B35">Xue <italic>et al.</italic> (2009</xref>), from which 11.1% had clusters that are &gt;3, indicating that <italic>Pyicos</italic> may still recover real sites that are borderline. Nonetheless, the clusters missed by either case had <italic>P</italic>-values closely above the used 0.001 thresholds, indicating that the observed variation was mostly due to the random nature of the background model calculation.
<fig id="F3" position="float"><label>Fig. 3.</label><caption><p>Detecting significant clusters in CLIP-Seq. (<bold>a</bold>) Genes with at least one significant cluster using <italic>Pyicos</italic> CLIP-Seq protocol (red) and the results published in <xref ref-type="bibr" rid="B35">Xue <italic>et al.</italic> (2009</xref>) (blue). (<bold>b</bold>) Beanplots (Kampstra, 2008) showing the distribution of heights for three subsets of read clusters: the significant clusters exclusively detected in <xref ref-type="bibr" rid="B35">Xue <italic>et al.</italic> (2009</xref>) and not by <italic>Pyicos</italic> (Only Xue <italic>et al.</italic>), the significant clusters exclusively found by <italic>Pyicos</italic> (Only <italic>Pyicos</italic>) and all the significant clusters found by <italic>Pyicos</italic> (All <italic>Pyicos</italic>).</p></caption><graphic xlink:href="btr570f3"/></fig></p>
    </sec>
  </sec>
  <sec id="SEC4">
    <title>4 DISCUSSION</title>
    <p>We have described <italic>Pyicos</italic>, a powerful tool for the analysis of mapped HTS reads. <italic>Pyicos</italic> framework facilitates the analysis of different HTS datatypes. We have described its application to ChIP-Seq, RNA-Seq and CLIP-Seq data using the three corresponding protocols: <italic>callpeaks</italic>, <italic>enrichment</italic> and <italic>clipseq</italic>. In <italic>callpeaks</italic>, we define a peak score in terms of a Poisson <italic>P</italic>-value, which is calculated independently for each chromosome, and in terms of one peak property, either the peak height or read count. The peak score therefore takes into account the differences across chromosomes and the fact that peaks with the same height or read count may have different <italic>P</italic>-values depending on the chromosome in which they are located. Using ChIP-Seq data for PR, CTCF, CEBPA and NRSF, we have shown that the peak score provides an appropriate ranking for peaks. Interestingly, using either the peak height or read count can make a difference depending on the dataset, as we found an increase of ∼7% in the fraction of the top 500 PR peaks with motifs, leading to a better peak definition compared with the other methods. We have further shown that the subtraction of the control is effective to increase the fraction of peaks with motif, indicating that it eliminates potential FPs.</p>
    <p><italic>Pyicos</italic> has the advantage that all operations described are configurable by the user to keep as much flexibility as possible, since not all of them may be applicable to a dataset. For instance, splitting peaks seems to result in improvements only for CTCF. Similarly, although <italic>Pyicos</italic> allows the user to choose the number of tolerated duplicated reads, we found that in all datasets the best peak definition is achieved by removing all duplicates.</p>
    <p>Furthermore, using various measures, we have compared <italic>callpeaks</italic> with three other methods specifically developed for punctuated ChIP-Seq data: MACS, USeq and FindPeaks. Regarding peak definition, we have found that FindPeaks, <italic>Pyicos</italic> and MACS show very similar spatial resolutions, which are also higher than those for USeq peaks. Furthermore, we observed that peaks ranked by <italic>Pyicos</italic> and MACS show a slightly higher fraction of motif-containing peaks than those ranked by FindPeaks and USeq.</p>
    <p>Peak detection has been assessed using ChIP-qPCR validated positive and negative regions for NRSF. We found that all methods perform similarly, probably due to high agreement between their generated peaks. The methods with the highest pairwise correlations are <italic>Pyicos</italic>, MACS and USeq. FindPeaks showed a lower correlation, probably due to a different handling of the control sample: whereas, FindPeaks compares a peak height with the distribution of peak heights from the control sample, the other three methods compare signal to control locally, using windows (MACS and USeq) or at base pair resolution (<italic>Pyicos</italic>). In summary, our results lead us to conclude that <italic>callpeaks</italic> provides an accurate protocol for peak detection for punctuated ChIP-Seq data. Moreover, due to the more flexible usage of the various operations compared with other methods, it allows to design a customized analysis of the ChIP-Seq data.</p>
    <p>We have further illustrated <italic>Pyicos</italic> flexibility by applying it to other datatypes. Using data from RNA-Seq and microarray experiments on liver and kidney samples, we have shown that <italic>Pyicos</italic> can recover DE genes with high accuracy and that is in fact comparable to methods specifically designed for differential expression analysis from RNA-Seq. Moreover, <italic>Pyicos</italic> performs well using different inputs: replicated or non-replicated, read counts or RPKM. DEGseq, which can also work with RPKM, shows similar accuracy as <italic>Pyicos</italic> and both correlate well in terms of the predicted <italic>Z</italic>-scores. The other two methods, DESeq and edgeR, were not designed to work with RPKM, hence could not be included in the comparison. The fact that <italic>Pyicos</italic> performs well with simulated replicated data presents the advantage of making possible to analyse many of the published datasets that have been produced without replica.</p>
    <p>It is surprising that the highest accuracy is achieved on count data, since it is known that using counts leads to a length bias in DE gene detection. This is probably because the genes selected from the microarray for benchmarking are not much affected by the length bias, since the accuracy hardly changes when using RPKM. This also suggests that RPKM alone does not provide the optimal normalization method. However, using a new density definition, TRPK, which combines RPKM with the TMM normalization, the length differences between DE and non-DE genes are reduced to a level close to that of the microarray. Nonetheless, the TMM normalization is based on the assumption that the majority of regions tested do not change significantly, which might not hold true for some pairs of samples or for certain sets of regions. Accordingly, <italic>Pyicos</italic> implements this as an option to the user.</p>
    <p>The flexibility of <italic>Pyicos</italic> is further demonstrated by applying the EA protocol to broad ChIP-Seq data. In particular, using ENCODE ChIP-Seq data for H3K36me3 and RNAPII from the cell lines K562 and NHEK, we obtain a high correlation for the <italic>Z</italic>-scores of these signals when compared with the enrichment <italic>Z</italic>-scores for RNA-Seq between the same cell lines. Thus, the EA of <italic>Pyicos</italic> using RPKM provides a tool to analyse broad ChIP-Seq data of various sorts, which would otherwise require a combination of approaches to be analysed (<xref ref-type="bibr" rid="B37">Young <italic>et al.</italic>, 2011</xref>). A further advantage is that <italic>Pyicos</italic> can directly accept BED files with mapped reads and regions of interest, unlike DESeq and edgeR. <italic>Pyicos</italic> can also calculate enriched regions <italic>de novo</italic> genome wide, using the reads from two experiments that are overlapping or sufficiently close in position. This is particularly useful for the analysis of signals for which the user does not know where to expect the enrichment relative to genome annotations, like enhancer elements. We have further shown that <italic>Pyicos</italic> can also be used to process CLIP-Seq data without a control. We expect that many of the basic <italic>Pyicos</italic> operations could be applicable to other datatypes and could possibly be combined to generate new analysis protocols.</p>
    <p>Some of the operations described can become impracticable for some analysis tools due to the amount of reads produced by a single HTS experiment nowadays. The bottleneck of HTS data analysis mostly lies in the memory usage of the software and in the storage and retrieval of data. Indeed, HTS data generation seems to be outpacing the improvements in CPU and disk storage (<xref ref-type="bibr" rid="B9">Kahn, 2011</xref>). Moreover, HTS data has become ubiquitous in genomic research; hence, we should aim to provide software that can be adapted to the available computing resources and, in particular, that can run on the average desktop computer. For these reasons, we developed <italic>Pyicos</italic> minimizing RAM usage and maintaining reasonable CPU time usage. <italic>Pyicos callpeaks</italic> protocol for ChIP-Seq data outperforms the other tested methods concerning memory usage while it stays competitive in running time. FindPeaks and USeq algorithms load entire files in memory, allowing for better time performance. However, this is only practical on a computer with enough RAM. For example, an experiment with 100 million reads using as input a BED file, would require &gt;4 GB available of RAM. For EA, the main bottleneck lies in the calculation of read counts or RPKM on the input regions. Although <italic>Pyicos</italic> is not as fast as BEDTools combined with DESeq or edgeR, its memory performance is far superior, allowing the handling of very large datasets. As made patent in the last few years, read files are increasing enormously in size with the development of the technology, making memory usage a critical feature in HTS analysis software.</p>
    <p>We conclude that the added value of having a modular tool is not at the cost of accuracy or performance; hence, <italic>Pyicos</italic> provides a useful framework for the analysis and integration of heterogeneous HTS data. Finally, as <italic>Pyicos</italic> is open source, we encourage the addition of new operations in order to combine them with already existing ones and possibly to create new analysis protocols.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material id="PMC_1" content-type="local-data">
      <caption>
        <title>Supplementary Data</title>
      </caption>
      <media mimetype="text" mime-subtype="html" xlink:href="supp_27_24_3333__index.html"/>
      <media xlink:role="associated-file" mimetype="application" mime-subtype="pdf" xlink:href="supp_btr570_Pyicos_SuppMaterial_20_9_2011.pdf"/>
    </supplementary-material>
  </sec>
</body>
<back>
  <fn-group>
    <fn id="FN1" fn-type="other">
      <p><sup>†</sup>The authors wish it to be known that, in their opinion, the last two authors should be regarded as joint First Authors.</p>
    </fn>
  </fn-group>
  <ack>
    <title>ACKNOWLEDGEMENTS</title>
    <p>The authors would like to thank Christian Perez-Llamas, David González, Julien Lagarde and Robert Castelo for useful discussions, and Alba Jene for discussions and comments on the manuscript. We also acknowledge Mark Kon, Manolis Kellis and Ana Rojas for providing us the opportunity to present <italic>Pyicos</italic> in their institutions.</p>
    <p><italic>Funding</italic>: <funding-source>Generalitat de Catalunya by FI</funding-source> grant (to S.A.); <funding-source>Spanish Ministry of Science (MICINN)</funding-source> by FPI grant (to J.G.V.); <funding-source>MICINN</funding-source> grant <award-id>BIO2008-01091</award-id> (to E.E.); <funding-source>European Commission grant EURASNET</funding-source>-(<award-id>LSHG-CT-2005-518238</award-id>) (to E.E.).</p>
    <p><italic>Conflict of Interest</italic>: none declared.</p>
  </ack>
  <ref-list>
    <title>REFERENCES</title>
    <ref id="B1">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Anders</surname>
            <given-names>S.</given-names>
          </name>
          <name>
            <surname>Huber</surname>
            <given-names>W.</given-names>
          </name>
        </person-group>
        <article-title>Differential expression analysis for sequence count data</article-title>
        <source>Genome Biol.</source>
        <year>2010</year>
        <volume>11</volume>
        <fpage>R106</fpage>
        <pub-id pub-id-type="pmid">20979621</pub-id>
      </element-citation>
    </ref>
    <ref id="B2">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bullard</surname>
            <given-names>J.H.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Evaluation of statistical methods for normalization and differential expression in mRNA-Seq experiments</article-title>
        <source>BMC Bioinformatics</source>
        <year>2010</year>
        <volume>11</volume>
        <fpage>94</fpage>
        <pub-id pub-id-type="pmid">20167110</pub-id>
      </element-citation>
    </ref>
    <ref id="B3">
      <element-citation publication-type="journal">
        <collab>ENCODE Consortium</collab>
        <article-title>A User's Guide to the Encyclopedia of DNA Elements (ENCODE)</article-title>
        <source>PLoS Biol.</source>
        <year>2011</year>
        <volume>9</volume>
        <fpage>e1001046</fpage>
        <pub-id pub-id-type="pmid">21526222</pub-id>
      </element-citation>
    </ref>
    <ref id="B4">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Fejes</surname>
            <given-names>A.P.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>FindPeaks 3.1: a tool for identifying areas of enrichment from massively parallel short-read sequencing technology</article-title>
        <source>Bioinformatics</source>
        <year>2008</year>
        <volume>24</volume>
        <fpage>1729</fpage>
        <lpage>1730</lpage>
        <pub-id pub-id-type="pmid">18599518</pub-id>
      </element-citation>
    </ref>
    <ref id="B5">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Flicek</surname>
            <given-names>P.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Ensembl 2011</article-title>
        <source>Nucleic Acids Res.</source>
        <year>2011</year>
        <volume>39</volume>
        <fpage>D800</fpage>
        <lpage>D806</lpage>
        <pub-id pub-id-type="pmid">21045057</pub-id>
      </element-citation>
    </ref>
    <ref id="B6">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ji</surname>
            <given-names>H.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>An integrated software system for analyzing ChIP-chip and ChIP-seq data</article-title>
        <source>Nat. Biotechnol.</source>
        <year>2008</year>
        <volume>26</volume>
        <fpage>1293</fpage>
        <lpage>1300</lpage>
        <pub-id pub-id-type="pmid">18978777</pub-id>
      </element-citation>
    </ref>
    <ref id="B7">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Johnson</surname>
            <given-names>D.S.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Genome-wide mapping of in vivo protein-DNA interactions</article-title>
        <source>Science</source>
        <year>2007</year>
        <volume>316</volume>
        <fpage>1497</fpage>
        <lpage>1502</lpage>
        <pub-id pub-id-type="pmid">17540862</pub-id>
      </element-citation>
    </ref>
    <ref id="B8">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Joshi</surname>
            <given-names>A.A.</given-names>
          </name>
          <name>
            <surname>Struhl</surname>
            <given-names>K.</given-names>
          </name>
        </person-group>
        <article-title>Eaf3 chromodomain interaction with methylated H3-K36 links histone deacetylation to Pol II elongation</article-title>
        <source>Mol. Cell</source>
        <year>2005</year>
        <volume>20</volume>
        <fpage>971</fpage>
        <lpage>978</lpage>
        <pub-id pub-id-type="pmid">16364921</pub-id>
      </element-citation>
    </ref>
    <ref id="B9">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kahn</surname>
            <given-names>S.D.</given-names>
          </name>
        </person-group>
        <article-title>On the future of genomic data</article-title>
        <source>Science</source>
        <year>2011</year>
        <volume>331</volume>
        <fpage>728</fpage>
        <lpage>729</lpage>
        <pub-id pub-id-type="pmid">21311016</pub-id>
      </element-citation>
    </ref>
    <ref id="B10">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Khalil</surname>
            <given-names>A.M.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Many human large intergenic noncoding RNAs associate with chromatin-modifying complexes and affect gene expression</article-title>
        <source>Proc. Natl Acad. Sci. USA</source>
        <year>2009</year>
        <volume>106</volume>
        <fpage>11667</fpage>
        <lpage>11672</lpage>
        <pub-id pub-id-type="pmid">19571010</pub-id>
      </element-citation>
    </ref>
    <ref id="B11">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Knüppel</surname>
            <given-names>R.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>TRANSFAC retrieval program: a network model database of eukaryotic transcription regulating sequences and proteins</article-title>
        <source>J. Comput. Biol.</source>
        <year>1994</year>
        <volume>1</volume>
        <fpage>191</fpage>
        <lpage>198</lpage>
        <pub-id pub-id-type="pmid">8790464</pub-id>
      </element-citation>
    </ref>
    <ref id="B12">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Licatalosi</surname>
            <given-names>D.D.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>HITS-CLIP yields genome-wide insights into brain alternative RNA processing</article-title>
        <source>Nature</source>
        <year>2008</year>
        <volume>456</volume>
        <fpage>464</fpage>
        <lpage>469</lpage>
        <pub-id pub-id-type="pmid">18978773</pub-id>
      </element-citation>
    </ref>
    <ref id="B13">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Marioni</surname>
            <given-names>J.C.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>RNA-seq: an assessment of technical reproducibility and comparison with gene expression arrays</article-title>
        <source>Genome Res.</source>
        <year>2008</year>
        <volume>18</volume>
        <fpage>1509</fpage>
        <lpage>1517</lpage>
        <pub-id pub-id-type="pmid">18550803</pub-id>
      </element-citation>
    </ref>
    <ref id="B14">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Mortazavi</surname>
            <given-names>A.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Comparative genomics modeling of the NRSF/REST repressor network: From single conserved sites to genome-wide repertoire</article-title>
        <source>Genome Res.</source>
        <year>2006</year>
        <volume>16</volume>
        <fpage>1208</fpage>
        <lpage>1221</lpage>
        <pub-id pub-id-type="pmid">16963704</pub-id>
      </element-citation>
    </ref>
    <ref id="B15">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Mortazavi</surname>
            <given-names>A.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Mapping and quantifying mammalian transcriptomes by RNA-Seq</article-title>
        <source>Nat. Methods</source>
        <year>2008</year>
        <volume>5</volume>
        <fpage>621</fpage>
        <lpage>628</lpage>
        <pub-id pub-id-type="pmid">18516045</pub-id>
      </element-citation>
    </ref>
    <ref id="B16">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Nix</surname>
            <given-names>D.A.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Empirical methods for controlling false positives and estimating confidence in ChIP-Seq peaks</article-title>
        <source>BMC Bioinformatics</source>
        <year>2008</year>
        <volume>9</volume>
        <fpage>523</fpage>
        <pub-id pub-id-type="pmid">19061503</pub-id>
      </element-citation>
    </ref>
    <ref id="B17">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Oshlack</surname>
            <given-names>A.</given-names>
          </name>
          <name>
            <surname>Wakefield</surname>
            <given-names>M.J.</given-names>
          </name>
        </person-group>
        <article-title>Transcript length bias in RNA-seq data confounds systems biology</article-title>
        <source>Biol. Direct</source>
        <year>2009</year>
        <volume>4</volume>
        <fpage>14</fpage>
        <pub-id pub-id-type="pmid">19371405</pub-id>
      </element-citation>
    </ref>
    <ref id="B18">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Oshlack</surname>
            <given-names>A.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>From RNA-seq reads to differential expression results</article-title>
        <source>Genome Biol.</source>
        <year>2010</year>
        <volume>11</volume>
        <fpage>220</fpage>
        <pub-id pub-id-type="pmid">21176179</pub-id>
      </element-citation>
    </ref>
    <ref id="B19">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Pan</surname>
            <given-names>Q.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Deep surveying of alternative splicing complexity in the human transcriptome by high-throughput sequencing</article-title>
        <source>Nat. Genet.</source>
        <year>2008</year>
        <volume>40</volume>
        <fpage>1413</fpage>
        <lpage>1415</lpage>
        <pub-id pub-id-type="pmid">18978789</pub-id>
      </element-citation>
    </ref>
    <ref id="B20">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Park</surname>
            <given-names>P.J.</given-names>
          </name>
        </person-group>
        <article-title>ChIP-seq: advantages and challenges of a maturing technology</article-title>
        <source>Nat. Rev. Genet.</source>
        <year>2009</year>
        <volume>10</volume>
        <fpage>669</fpage>
        <lpage>680</lpage>
        <pub-id pub-id-type="pmid">19736561</pub-id>
      </element-citation>
    </ref>
    <ref id="B21">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Pepke</surname>
            <given-names>S.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Computation for ChIP-seq and RNA-seq studies</article-title>
        <source>Nat. Methods</source>
        <year>2009</year>
        <volume>6</volume>
        <fpage>S22</fpage>
        <lpage>S32</lpage>
        <pub-id pub-id-type="pmid">19844228</pub-id>
      </element-citation>
    </ref>
    <ref id="B22">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Pokholok</surname>
            <given-names>D.K.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Genome-wide map of nucleosome acetylation and methylation in yeast</article-title>
        <source>Cell</source>
        <year>2005</year>
        <volume>122</volume>
        <fpage>517</fpage>
        <lpage>527</lpage>
        <pub-id pub-id-type="pmid">16122420</pub-id>
      </element-citation>
    </ref>
    <ref id="B23">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Quinlan</surname>
            <given-names>A.R.</given-names>
          </name>
          <name>
            <surname>Hall</surname>
            <given-names>I.M.</given-names>
          </name>
        </person-group>
        <article-title>BEDTools: a flexible suite of utilities for comparing genomic features</article-title>
        <source>Bioinformatics</source>
        <year>2010</year>
        <volume>26</volume>
        <fpage>841</fpage>
        <lpage>842</lpage>
        <pub-id pub-id-type="pmid">20110278</pub-id>
      </element-citation>
    </ref>
    <ref id="B24">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Robertson</surname>
            <given-names>G.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Genome-wide profiles of STAT1 DNA association using chromatin immunoprecipitation and massively parallel sequencing</article-title>
        <source>Nat. Methods</source>
        <year>2007</year>
        <volume>4</volume>
        <fpage>651</fpage>
        <lpage>657</lpage>
        <pub-id pub-id-type="pmid">17558387</pub-id>
      </element-citation>
    </ref>
    <ref id="B25">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Robinson</surname>
            <given-names>M.D.</given-names>
          </name>
          <name>
            <surname>Oshlack</surname>
            <given-names>A.</given-names>
          </name>
        </person-group>
        <article-title>A scaling normalization method for differential expression analysis of RNA-seq data</article-title>
        <source>Genome Biol.</source>
        <year>2010</year>
        <volume>11</volume>
        <fpage>R25</fpage>
        <pub-id pub-id-type="pmid">20196867</pub-id>
      </element-citation>
    </ref>
    <ref id="B26">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Robinson</surname>
            <given-names>M.D.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>edgeR: a Bioconductor package for differential expression analysis of digital gene expression data</article-title>
        <source>Bioinformatics</source>
        <year>2010</year>
        <volume>26</volume>
        <fpage>139</fpage>
        <lpage>140</lpage>
        <pub-id pub-id-type="pmid">19910308</pub-id>
      </element-citation>
    </ref>
    <ref id="B27">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Schmidt</surname>
            <given-names>D.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Five-vertebrate ChIP-seq reveals the evolutionary dynamics of transcription factor binding</article-title>
        <source>Science</source>
        <year>2010</year>
        <volume>328</volume>
        <fpage>1036</fpage>
        <lpage>1040</lpage>
        <pub-id pub-id-type="pmid">20378774</pub-id>
      </element-citation>
    </ref>
    <ref id="B28">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Shin</surname>
            <given-names>H.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>CEAS: cis-regulatory element annotation system</article-title>
        <source>Bioinformatics</source>
        <year>2009</year>
        <volume>25</volume>
        <fpage>2605</fpage>
        <lpage>2606</lpage>
        <pub-id pub-id-type="pmid">19689956</pub-id>
      </element-citation>
    </ref>
    <ref id="B29">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Sultan</surname>
            <given-names>M.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>A global view of gene activity and alternative splicing by deep sequencing of the human transcriptome</article-title>
        <source>Science</source>
        <year>2008</year>
        <volume>321</volume>
        <fpage>956</fpage>
        <lpage>960</lpage>
        <pub-id pub-id-type="pmid">18599741</pub-id>
      </element-citation>
    </ref>
    <ref id="B30">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Trapnell</surname>
            <given-names>C.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Transcript assembly and quantification by RNA-Seq reveals unannotated transcripts and isoform switching during cell differentiation</article-title>
        <source>Nat. Biotechnol.</source>
        <year>2010</year>
        <volume>28</volume>
        <fpage>511</fpage>
        <lpage>515</lpage>
        <pub-id pub-id-type="pmid">20436464</pub-id>
      </element-citation>
    </ref>
    <ref id="B31">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Vicent</surname>
            <given-names>G.P.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Four enzymes cooperate to displace histone H1 during the first minute of hormonal gene activation</article-title>
        <source>Genes Dev.</source>
        <year>2011</year>
        <volume>25</volume>
        <fpage>845</fpage>
        <lpage>862</lpage>
        <pub-id pub-id-type="pmid">21447625</pub-id>
      </element-citation>
    </ref>
    <ref id="B32">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wang</surname>
            <given-names>E.T.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Alternative isoform regulation in human tissue transcriptomes</article-title>
        <source>Nature</source>
        <year>2008a</year>
        <volume>456</volume>
        <fpage>470</fpage>
        <lpage>476</lpage>
        <pub-id pub-id-type="pmid">18978772</pub-id>
      </element-citation>
    </ref>
    <ref id="B33">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wang</surname>
            <given-names>X.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Transcriptome-wide identification of novel imprinted genes in neonatal mouse brain</article-title>
        <source>PLoS One</source>
        <year>2008b</year>
        <volume>3</volume>
        <fpage>e3839</fpage>
        <pub-id pub-id-type="pmid">19052635</pub-id>
      </element-citation>
    </ref>
    <ref id="B34">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wang</surname>
            <given-names>L.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>DEGseq: an R package for identifying differentially expressed genes from RNA-seq data</article-title>
        <source>Bioinformatics</source>
        <year>2010</year>
        <volume>26</volume>
        <fpage>136</fpage>
        <lpage>138</lpage>
        <pub-id pub-id-type="pmid">19855105</pub-id>
      </element-citation>
    </ref>
    <ref id="B35">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Xue</surname>
            <given-names>Y.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Genome-wide analysis of PTB-RNA interactions reveals a strategy used by the general splicing repressor to modulate exon inclusion or skipping</article-title>
        <source>Mol. Cell</source>
        <year>2009</year>
        <volume>36</volume>
        <fpage>996</fpage>
        <lpage>1006</lpage>
        <pub-id pub-id-type="pmid">20064465</pub-id>
      </element-citation>
    </ref>
    <ref id="B36">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Yeo</surname>
            <given-names>G.W.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>An RNA code for the FOX2 splicing regulator revealed by mapping RNA-protein interactions in stem cells</article-title>
        <source>Nat. Struct. Mol. Biol.</source>
        <year>2009</year>
        <volume>16</volume>
        <fpage>130</fpage>
        <lpage>137</lpage>
        <pub-id pub-id-type="pmid">19136955</pub-id>
      </element-citation>
    </ref>
    <ref id="B37">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Young</surname>
            <given-names>M.D.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>ChIP-seq analysis reveals distinct H3K27me3 profiles that correlate with transcriptional activity</article-title>
        <source>Nucleic Acids Res.</source>
        <year>2011</year>
        <volume>39</volume>
        <fpage>7415</fpage>
        <lpage>7427</lpage>
        <pub-id pub-id-type="pmid">21652639</pub-id>
      </element-citation>
    </ref>
    <ref id="B38">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zhang</surname>
            <given-names>Y.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Model-based analysis of ChIP-Seq (MACS)</article-title>
        <source>Genome Biol.</source>
        <year>2008</year>
        <volume>9</volume>
        <fpage>R137</fpage>
        <pub-id pub-id-type="pmid">18798982</pub-id>
      </element-citation>
    </ref>
    <ref id="B39">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zang</surname>
            <given-names>C.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>A clustering approach for identification of enriched domains from histone modification ChIP-Seq data</article-title>
        <source>Bioinformatics</source>
        <year>2009</year>
        <volume>25</volume>
        <fpage>1952</fpage>
        <lpage>1958</lpage>
        <pub-id pub-id-type="pmid">19505939</pub-id>
      </element-citation>
    </ref>
  </ref-list>
</back>
