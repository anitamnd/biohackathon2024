<?DTDIdentifier.IdentifierValue http://www.biomedcentral.com/xml/article.dtd?>
<?DTDIdentifier.IdentifierType system?>
<?SourceDTD.DTDName article.dtd?>
<?SourceDTD.Version 1.0?>
<?ConverterInfo.XSLTName bmc2nlmx2.xsl?>
<?ConverterInfo.Version 2?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">BMC Genomics</journal-id>
    <journal-id journal-id-type="iso-abbrev">BMC Genomics</journal-id>
    <journal-title-group>
      <journal-title>BMC Genomics</journal-title>
    </journal-title-group>
    <issn pub-type="epub">1471-2164</issn>
    <publisher>
      <publisher-name>BioMed Central</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">4051166</article-id>
    <article-id pub-id-type="publisher-id">1471-2164-15-264</article-id>
    <article-id pub-id-type="pmid">24708189</article-id>
    <article-id pub-id-type="doi">10.1186/1471-2164-15-264</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Research Article</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Comparison of mapping algorithms used in high-throughput sequencing: application to Ion Torrent data</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author" corresp="yes" id="A1">
        <name>
          <surname>Caboche</surname>
          <given-names>Ségolène</given-names>
        </name>
        <xref ref-type="aff" rid="I1">1</xref>
        <xref ref-type="aff" rid="I4">4</xref>
        <email>segolene.caboche@pasteur-lille.fr</email>
      </contrib>
      <contrib contrib-type="author" id="A2">
        <name>
          <surname>Audebert</surname>
          <given-names>Christophe</given-names>
        </name>
        <xref ref-type="aff" rid="I2">2</xref>
        <xref ref-type="aff" rid="I4">4</xref>
        <email>c.audebert@genesdiffusion.com</email>
      </contrib>
      <contrib contrib-type="author" id="A3">
        <name>
          <surname>Lemoine</surname>
          <given-names>Yves</given-names>
        </name>
        <xref ref-type="aff" rid="I1">1</xref>
        <xref ref-type="aff" rid="I3">3</xref>
        <xref ref-type="aff" rid="I4">4</xref>
        <email>yves.lemoine@pasteur-lille.fr</email>
      </contrib>
      <contrib contrib-type="author" id="A4">
        <name>
          <surname>Hot</surname>
          <given-names>David</given-names>
        </name>
        <xref ref-type="aff" rid="I1">1</xref>
        <xref ref-type="aff" rid="I3">3</xref>
        <xref ref-type="aff" rid="I4">4</xref>
        <email>david.hot@pasteur-lille.fr</email>
      </contrib>
    </contrib-group>
    <aff id="I1"><label>1</label>FRE 3642 Molecular and Cellular Medecine, CNRS, Institut Pasteur de Lille and Univ Lille Nord de France, Lille, France</aff>
    <aff id="I2"><label>2</label>Genes Diffusion, 3595, Route de Tournai, 59501 Douai, France</aff>
    <aff id="I3"><label>3</label>Transcriptomics and Applied Genomics, Center of Infection and Immunity of Lille, Inserm U1019, CNRS UMR8204, Institut Pasteur de Lille, Univ Lille Nord de France, Lille, France</aff>
    <aff id="I4"><label>4</label>PEGASE-Biosciences, Institut Pasteur de Lille, 1 Rue du Professeur Calmette, 59019 Lille, France</aff>
    <pub-date pub-type="collection">
      <year>2014</year>
    </pub-date>
    <pub-date pub-type="epub">
      <day>5</day>
      <month>4</month>
      <year>2014</year>
    </pub-date>
    <volume>15</volume>
    <fpage>264</fpage>
    <lpage>264</lpage>
    <history>
      <date date-type="received">
        <day>13</day>
        <month>11</month>
        <year>2013</year>
      </date>
      <date date-type="accepted">
        <day>1</day>
        <month>4</month>
        <year>2014</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>Copyright © 2014 Caboche et al.; licensee BioMed Central Ltd.</copyright-statement>
      <copyright-year>2014</copyright-year>
      <copyright-holder>Caboche et al.; licensee BioMed Central Ltd.</copyright-holder>
      <license license-type="open-access" xlink:href="http://creativecommons.org/licenses/by/2.0">
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/2.0">http://creativecommons.org/licenses/by/2.0</ext-link>),which permits unrestricted use, distribution, and reproduction in any medium, provided the original work is properly credited. The Creative Commons Public Domain Dedication waiver (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/publicdomain/zero/1.0/">http://creativecommons.org/publicdomain/zero/1.0/</ext-link>) applies to the data made available in this article, unless otherwise stated.</license-p>
      </license>
    </permissions>
    <self-uri xlink:href="http://www.biomedcentral.com/1471-2164/15/264"/>
    <abstract>
      <sec>
        <title>Background</title>
        <p>The rapid evolution in high-throughput sequencing (HTS) technologies has opened up new perspectives in several research fields and led to the production of large volumes of sequence data. A fundamental step in HTS data analysis is the mapping of reads onto reference sequences. Choosing a suitable mapper for a given technology and a given application is a subtle task because of the difficulty of evaluating mapping algorithms.</p>
      </sec>
      <sec>
        <title>Results</title>
        <p>In this paper, we present a benchmark procedure to compare mapping algorithms used in HTS using both real and simulated datasets and considering four evaluation criteria: computational resource and time requirements, robustness of mapping, ability to report positions for reads in repetitive regions, and ability to retrieve true genetic variation positions. To measure robustness, we introduced a new definition for a correctly mapped read taking into account not only the expected start position of the read but also the end position and the number of indels and substitutions. We developed CuReSim, a new read simulator, that is able to generate customized benchmark data for any kind of HTS technology by adjusting parameters to the error types. CuReSim and CuReSimEval, a tool to evaluate the mapping quality of the CuReSim simulated reads, are freely available. We applied our benchmark procedure to evaluate 14 mappers in the context of whole genome sequencing of small genomes with Ion Torrent data for which such a comparison has not yet been established.</p>
      </sec>
      <sec>
        <title>Conclusions</title>
        <p>A benchmark procedure to compare HTS data mappers is introduced with a new definition for the mapping correctness as well as tools to generate simulated reads and evaluate mapping quality. The application of this procedure to Ion Torrent data from the whole genome sequencing of small genomes has allowed us to validate our benchmark procedure and demonstrate that it is helpful for selecting a mapper based on the intended application, questions to be addressed, and the technology used. This benchmark procedure can be used to evaluate existing or in-development mappers as well as to optimize parameters of a chosen mapper for any application and any sequencing platform.</p>
      </sec>
    </abstract>
    <kwd-group>
      <kwd>High-throughput sequencing</kwd>
      <kwd>Mapping algorithms</kwd>
      <kwd>Mapper comparison</kwd>
      <kwd>Read simulator</kwd>
    </kwd-group>
  </article-meta>
</front>
<body>
  <sec>
    <title>Background</title>
    <p>High-throughput sequencing (HTS) technology has recently shown a rapid and impressive development and this has led to the production of gigabases of sequence in a few hours for only a fraction of the former cost [<xref ref-type="bibr" rid="B1">1</xref>]. HTS has produced an explosion of knowledge in genetics and genomics thanks to the development of specific applications such as genome re-sequencing (whole genome sequencing and targeted sequencing). This technological evolution was paralleled by the development of new algorithms to deal with the quantity and the quality of reads produced. A fundamental analysis steps in re-sequencing approaches is the mapping of the reads onto a reference genome. This step, which involves the accurate positioning of reads onto a reference genome sequence, is highly important because it determines the global quality of downstream analyses. The algorithms used for this step are called mappers. Mappers have to be sensitive and accurate and, if possible, fast and not too computationally demanding. They should be able to find the true position of each read on a reference genome and ideally distinguish between technical sequencing errors and natural genetic variations.</p>
    <p>In recent years many mappers have been developed and distributed (more than 60 mappers are listed in [<xref ref-type="bibr" rid="B2">2</xref>]). Two studies [<xref ref-type="bibr" rid="B2">2</xref>,<xref ref-type="bibr" rid="B3">3</xref>] have classified mappers using a wide variety of features that include: the type of data, their application, the sequencing platform, the read length, the allowed error rate, parallel implementation, the ability to deal with multi-mapped reads (<italic>i.e.</italic> reads aligned to multiple locations), the input and output formats, and the available parameters. Mappers have multiplied and so has the range of possible settings. Hence, the growing difficulty in selecting a mapper has been raised in recent studies aimed at evaluating mapper performances through a multiplicity of comparison criteria. Some of these studies have focused on mapper sensitivity (ability to correctly map reads) [<xref ref-type="bibr" rid="B4">4</xref>-<xref ref-type="bibr" rid="B6">6</xref>]. Schbath <italic>et al.</italic> studied the ability of mappers to identify unique versus multi-mapped reads using a well-controlled benchmark containing reads with exactly three mismatches [<xref ref-type="bibr" rid="B7">7</xref>]. Hatem <italic>et al.</italic> introduced a benchmarking suite to analyze mapping tools [<xref ref-type="bibr" rid="B8">8</xref>], which consists of tests that cover input properties and algorithmic features.</p>
    <p>In addition to the difficulty in determining evaluation criteria, choosing an appropriate evaluation method, <italic>i.e.</italic> how to compare mappers according to the evaluation criteria, and using the appropriate metrics, are also problematical. Using real datasets to evaluate mapper performances allows only a rough assessment and classification of mappers by comparing the percentage of mapped reads, but does not reveal the actual accuracy of mappers. Attempts have been made to avoid this pitfall using simulated datasets in which the original read positions are known. Another difficulty lies in the accurate definition of what a correctly mapped read is. The basic definition is to consider a read as correctly mapped if the original location is retrieved [<xref ref-type="bibr" rid="B4">4</xref>]. Ruffalo <italic>et al.</italic> broadened this definition by adding a condition on the quality score, which had to be superior to a given threshold [<xref ref-type="bibr" rid="B5">5</xref>]. In a more recent paper [<xref ref-type="bibr" rid="B8">8</xref>], a new definition was introduced in which a read was considered to be correctly mapped if the mapping criteria were not violated, <italic>i.e.</italic> contained less errors than the threshold parameter set by the user.</p>
    <p>Using simulated data allows numerical values to be obtained and compared between a set of mappers. However, simulated data do not have the same characteristics as real data, even when an error model based on real data is used. Real HTS data present biases [<xref ref-type="bibr" rid="B9">9</xref>] that can be very difficult to simulate. Additionally, the current definition of the mapping correctness based only on the original start location presents some weaknesses: a read can have several correct positions on the reference sequence and sequencing errors or true genetic variations can lead to a better alignment in a genome position different from the original one. Holtgrewe <italic>et al.</italic> introduced the interval definition, rather than the genome position, to describe a read mapping [<xref ref-type="bibr" rid="B6">6</xref>] and used a full-sensitivity algorithm to identify all possible matching intervals within a given error rate range for each read. This method has been implemented in RABEMA (Read Alignment BEnchMArk), a tool that evaluates the result of arbitrary read mappers that support the SAM output format with real and simulated datasets. Our analysis of the published literature on mapper evaluation led us to conclude that for a complete and robust comparison of mappers, real and simulated datasets should be used. Using real datasets avoids simulation biases and gives a real picture of mapper behavior, whereas simulated datasets are benchmarks from which all parameters can be controlled. Additionally, a sound, more complete definition of what constitutes a correctly mapped read needs to be considered (see below).</p>
    <p>In all the previous studies, mapper performance was evaluated using large eukaryotic genomes (mainly the human genome) and, for the most part, short Illumina or Illumina-like reads data were used, except in [<xref ref-type="bibr" rid="B4">4</xref>,<xref ref-type="bibr" rid="B6">6</xref>] where 454 datasets were evaluated with a reduced number of mappers and metrics. The type of sequencing errors and their rate is inherent to the sequencing technology and more precisely to the nucleotide elongation detection methods used. For example, Life Technologies sequencing by oligonucleotide ligation and detection (SOLiD) technology showed a strong bias in its coverage of repetitive elements [<xref ref-type="bibr" rid="B10">10</xref>], whereas the Illumina reversible dye-terminator sequencing technology (HiSeq) mainly caused substitutions [<xref ref-type="bibr" rid="B11">11</xref>]. Pyrosequencing on solid support (454/Roche) and ion semiconductor sequencing technology (Ion Torrent, Life Technologies) produced indel errors associated with homopolymer-regions [<xref ref-type="bibr" rid="B12">12</xref>]. In the published evaluations, the criteria that were tested and the default parameters of the mappers were usually chosen to address or deal with substitution-type errors and are, therefore, less informative for mapping the reads from new technologies like the Ion Torrent platform.</p>
    <p>Furthermore, the analysis of small microbial genomes compared with the analysis of large eukaryotic genomes poses other challenges because microbial genomes contain a wide range of GC content, which is sometimes extreme. Very high or very low GC content means that there is a high probability of encountering homopolymers in a genome sequence and this is known to be a specific problem for pyrosequencing and ion semiconductor sequencers. A recent development in the HTS technologies has made available benchtop sequencers targeted at the quick and inexpensive sequencing of small to moderate-sized genomes, mainly bacteria, viruses, fungi, and parasites. Small microbial genome sequences could be considered to present a simpler, less demanding mapping process compared with the mapping process for larger eukaryotic genomes. However, this is only partially true because the characteristics of small microbial genomes are not the same as those of eukaryotic genomes. The questions of interest are also usually different and, consequently, the expected mapping quality criteria are not exactly the same. Whole genome sequencing or re-sequencing is an important application in the new field of microorganism characterization using HTS. For instance, clinical diagnosis and the epidemiological study of microbial strain circulation will be profoundly remodeled in the near future by the use of HTS, which should, very soon, be used as a characterization approach for pathogens and which will probably slowly replace the present PCR and biochemical based characterization methods [<xref ref-type="bibr" rid="B13">13</xref>,<xref ref-type="bibr" rid="B14">14</xref>]. In this particular context the re-sequencing applications and derived analyses are in the front-line of research and development. The focus includes the sequencing of the entire length of a microbial genome and the analysis of obtained reads by mapping them onto one or several reference strains to identify potential relevant changes in the studied genome. The aim is to accurately identify the gain or loss in genetic elements (genes or parts of genes, prophages, and plasmids) as well as small changes (mutations and indels) to predict a potential new phenotype or a derived new pathogenicity profile. This requirement poses several challenges, the most important of which is the necessity to distinguish true genetic variations from sequencing errors.</p>
    <p>In this paper, we focus on the evaluation of mappers in the context of whole genome sequencing or re-sequencing for small microbial, mainly bacterial genomes. We tested 14 mappers, mostly using their default settings to be in the general context of non-expert users. We selected four criteria to match this context: (i) computational resource and time requirements, (ii) robustness of mapping through the evaluation of precision, recall and F-measure, (iii) ability to report positions for reads in repetitive regions, and (iv) ability to retrieve true genetic variation positions. To evaluate a mapper’s robustness on simulated datasets, we introduced a new definition of a correctly mapped read. In addition to the original start position (<italic>i.e.</italic> the position from which a read is simulated) that was used in most previous studies, the end position as well as the numbers of insertions, deletions, and substitutions in the alignment were also used to classify the mapping of a read as correct. This definition is more stringent than the previous ones because it implies that it is a full-length read alignment and that the error count is correct. Indeed, sequencing errors can mean that the original location of a read is not necessarily the best alignment location. Using mappers tuned to report all possible hits (‘all’ mode) and to accept a higher error rate than the error rate introduced in simulated reads, it should be possible to retrieve the original location in addition to potential equivalent or better hits. With the new definition of a correctly mapped read used in this study, we ensured that the mapper was able to retrieve the expected original alignment despite inevitable sequencing errors in the reads, thereby allowing a true evaluation of the mapper’s robustness.</p>
    <p>The analysis was applied to data generated by the Ion Torrent Personal Genome Machine (PGM), a newly arrived technology dedicated mainly to small genome sequencing, for which mapper performances have not yet been evaluated. Reads from real datasets and artificially simulated reads were used. Simulated reads were generated using a new customizable read simulator, CuReSim, which can generate reads of user-determined lengths with insertions, deletions, and substitutions introduced at a controlled rate and with an adjustable error distribution along the read. CuReSim and CuReSimEval, a script that can be used to evaluate mapping quality, were developed in Java to run on all operating systems (see Section 2 of Additional file <xref ref-type="supplementary-material" rid="S1">1</xref> for more details) and are freely available at <ext-link ext-link-type="uri" xlink:href="http://www.pegase-biosciences.com/tools/curesim/">http://www.pegase-biosciences.com/tools/curesim/</ext-link>. We have shown that in microbial genome sequencing, some mappers, such as segemehl, present higher robustness than others, especially when the number of sequencing errors was high. Other mappers are more robust for other applications that demand other quality criteria. For example, BWASW, SHRiMP2, SMALT, SSAHA2 and TMAP, might perform particularly well for sequencing focused on rare variant discovery because they show a robust discrimination of variations. SMALT can localize most of the positions of reads located in repeated regions. Some mappers, such as Novoalign, SMALT and SRmapper, needed very small memory resources (about 20 MB), while SNAP was very fast and required only about two minutes to process the bigger datasets used in this study. These results emphasize the observation that mapper choice is application dependent and users should carefully consider the targeted aim before choosing a mapper. The evaluation approach presented here, together with the developed tools (CuReSim to generate simulated reads and CuReSimEval to evaluate mapping quality) can be considered as a general method to evaluate existing or in-development mappers and could prove interesting in the evaluation of the performances of mappers for the coming third generation of sequencers that may have yet another type and rate of errors.</p>
  </sec>
  <sec sec-type="results">
    <title>Results</title>
    <sec>
      <title>Computational resource requirement and time measurement</title>
      <p>All mapping processes involve the alignment of millions of reads onto a reference sequence. This is true even for small genome sequencing projects where the small size of the reference sequence is generally compensated by the multiplicity of samples to be analyzed. In clinical microbiology, the time and the computational resources required for the analysis are critical; therefore, 0 these factors also need to be evaluated for the different mappers. All the mappers tested were run with 24 threads (except for Novoalign, SRmapper, and SSAHA2, which can be run with only 1 thread) and the memory consumption and runtime were recorded for three different Ion Torrent datasets RD_100, RD_200, and RD_400. These three datasets contain real single-reads with different mean sizes and are described in Table <xref ref-type="table" rid="T1">1</xref>. The reference genome used was <italic>Escherichia coli str. K-12 substr. DH10B</italic> [GenBank:NC_010473] for the RD_100 and RD_200 datasets and <italic>Escherichia coli str. K-12 substr. MG16655</italic> [GenBank:NC_000913] for the RD_400 dataset. Figure <xref ref-type="fig" rid="F1">1</xref> shows the memory consumption for each mapper for the real datasets when the indexing and mapping steps were considered together. Novoalign, SMALT, and SRmapper needed very low memory resources (about 20 MB). It should be noted that SRmapper was developed to run on a computer with 4 GB of RAM for genomes the size of the human genome, but, in such a case, it can be run only in ‘all-best’ mode and does not allow indels in the mapping. The Novoalign version used in this study was the free academic version that has not been implemented in parallel. A second group comprising Bowtie2, MOSAIK, and segemehl, needed less than 1 GB of RAM, while a third group, BWA, BWASW, and TMAP, needed less than 2 GB of memory. BWA had peak memory usage of 2 GB for RD_100 and of more than 3 GB for the RD_400 dataset. BWA was developed to map short reads of up to 100 bases, which may explain the high peak usage for 400-base reads. SHRiMP2, SNAP, and SSAHA2 required more RAM (about 3 GB) and SSAHA2 needed about 6 GB for the RD_400 dataset. Finally, the GSNAP and PASS mappers were highly memory-consuming; for the RD_400 dataset, GSNAP needed 6 GB of RAM, with a peak usage of 7 GB while PASS needed about 12 GB of RAM with a peak usage of 14 GB. The RAM requirement increased proportionally with the dataset size for half of the mappers tested, while for Bowtie2, BWASW, MOSAIK, Novoalign, SMALT, segemehl, SHRiMP2, and TMAP memory consumption was about the same for all dataset sizes. These experiments revealed that the computational resource requirements varied considerably among the mappers, from a few megabytes to 14 GB.</p>
      <table-wrap position="float" id="T1">
        <label>Table 1</label>
        <caption>
          <p>Main features of the Ion Torrent Personal Genome Machine datasets used in this study</p>
        </caption>
        <table frame="hsides" rules="groups" border="1">
          <colgroup>
            <col align="left"/>
            <col align="center"/>
            <col align="center"/>
            <col align="center"/>
            <col align="center"/>
          </colgroup>
          <thead valign="top">
            <tr>
              <th colspan="5" align="center">
                <bold>Ion Torrent PGM data</bold>
              </th>
            </tr>
          </thead>
          <tbody valign="top">
            <tr>
              <td align="center" valign="bottom">
                <bold>Name</bold>
                <hr/>
              </td>
              <td align="center" valign="bottom">
                <bold>Chip</bold>
                <hr/>
              </td>
              <td align="center" valign="bottom">
                <bold>Number of reads</bold>
                <hr/>
              </td>
              <td align="center" valign="bottom">
                <bold>Mean length</bold>
                <hr/>
              </td>
              <td align="center" valign="bottom">
                <bold>Organism</bold>
                <hr/>
              </td>
            </tr>
            <tr>
              <td align="center" valign="bottom">RD_100<hr/></td>
              <td align="center" valign="bottom">316<hr/></td>
              <td align="center" valign="bottom">1,713,033<hr/></td>
              <td align="center" valign="bottom">111 bp<hr/></td>
              <td align="center" valign="bottom">
                <italic>E. coli K-12 DH10B</italic>
                <hr/>
              </td>
            </tr>
            <tr>
              <td align="center" valign="bottom">RD_200<hr/></td>
              <td align="center" valign="bottom">316<hr/></td>
              <td align="center" valign="bottom">2,176,492<hr/></td>
              <td align="center" valign="bottom">226 bp<hr/></td>
              <td align="center" valign="bottom">
                <italic>E. coli K-12 DH10B</italic>
                <hr/>
              </td>
            </tr>
            <tr>
              <td align="center">RD_400</td>
              <td align="center">318</td>
              <td align="center">6,668,556</td>
              <td align="center">312 bp</td>
              <td align="center">
                <italic>E. coli K-12 MG1655</italic>
              </td>
            </tr>
          </tbody>
        </table>
        <table-wrap-foot>
          <p>The datasets all contain only single-reads with different mean sizes.</p>
        </table-wrap-foot>
      </table-wrap>
      <fig id="F1" position="float">
        <label>Figure 1</label>
        <caption>
          <p><bold>Computational resource requirements for each mapper dealing with real datasets.</bold> Random Access Memory (RAM, in gigabytes) consumption observed for each mapper, for the three real datasets (RD_100, RD_200 and RD_400) is shown. The values are the requirements for when the indexing and mapping steps were considered together. Vertical bars show the mean memory usage and vertical lines represent the peak memory usage. (1) indicates the mappers that report only one read (‘any-best’ mode) and (2) indicates the mappers that can run only in ‘all-best’ mode.</p>
        </caption>
        <graphic xlink:href="1471-2164-15-264-1"/>
      </fig>
      <p>The time required for the sequencing process relies mainly on the biotechnological part of the protocol (from sample preparation to the sequencing run) but the runtime of the mapping step could also constitute a bottleneck for some mappers. Figure <xref ref-type="fig" rid="F2">2</xref> shows runtime measurements for each mapper running with the three real datasets. The mappers had very different runtimes that were not all proportional to the dataset size. SNAP was very quick and needed only about 2 minutes to map the RD_400 dataset. However, this runtime was for the program run in ‘any-best’ mode, which is always quicker than the other modes. SRmapper, SSAHA2, PASS, Bowtie2, TMAP, SMALT, BWASW, SHRiMP2, and MOSAIK needed less than 40 minutes to map the RD_400 dataset and between 1 minute (for Bowtie2 and SMALT) and 6 minutes (for SSAHA2) to map the RD_100 dataset. BWA had quick runtimes of 2 and 7 minutes for the RD_100 and RD_200 datasets, respectively, but was slower with the biggest dataset RD_400 (around 80 minutes), probably because BWA is optimized for short reads. The slowest mappers were Novoalign, GSNAP, and segemehl. The Novoalign version used in this study could only be run with one thread which explains the long runtimes observed in this study (43, 102, and 297 minutes). GSNAP runtimes were 7, 20 and 90 minutes, and segemehl needed 13, 33 and 144 minutes for the RD_100, RD_200, and RD_400 datasets, respectively. For all the mappers, the runtimes for the RD_400 dataset (which contains more reads than the other datasets) were longer. Generally speaking, the more bases in the dataset, the longer was the runtime, although the runtimes ranged from one minute to up to five hours.</p>
      <fig id="F2" position="float">
        <label>Figure 2</label>
        <caption>
          <p><bold>Runtime measurements for each mapper dealing with real datasets.</bold> Runtime measurements are in minutes. The time measurements are the runtimes for when the indexing and mapping steps are considered together. Vertical bars show the user runtime (time elapsed during the experiments) and vertical lines indicate the CPU time. The time axis is in log scale. Each mapper was run with 24 threads (except Novoalign, SRmapper, SSAHA2, which were run with 1 thread). (1) indicates the mappers that report only one read (‘any-best’ mode) and (2) indicates the mappers that can run only in ‘all-best’ mode.</p>
        </caption>
        <graphic xlink:href="1471-2164-15-264-2"/>
      </fig>
    </sec>
    <sec>
      <title>Mapper robustness</title>
      <p>The accuracy of the sequencing technology is usually the criterion of first importance in the choice of a sequencer. Nevertheless, the mappers used to analyze the sequencing data must be able to efficiently take into account the inherent and inevitable raw data errors. A robust mapper will permit compensation for sequencing defects and will contribute to maximizing coverage while limiting noise. To evaluate mapper robustness, one method is to compute metrics (here precision, recall, and F-measure) through a benchmark formed by simulated reads for which their original location in the genome and the number and type of introduced errors are known. We used simulated datasets with varying error rates to compare mapper robustness. To avoid simulation biases, we also studied mapper robustness with RABEMA [<xref ref-type="bibr" rid="B6">6</xref>] using real sub-datasets.</p>
      <p>Figure <xref ref-type="fig" rid="F3">3</xref> shows the F-measure for each mapper with a simulated dataset containing 50,000 reads with a mean length of 200 bases and an error rate that varied from 0 to 4%. F-measure is the harmonic mean of precision and recall (see the Methods section for details). Precision is the fraction of mapped reads that are correctly mapped and recall is the fraction of correctly mapped reads that are retrieved. Additional figures that show the precision and recall values used to compute the F-measure are in Section 3.1 of Additional file <xref ref-type="supplementary-material" rid="S1">1</xref>. Figure <xref ref-type="fig" rid="F3">3</xref> shows that the 14 mappers displayed very different robustness when the error rate increased, even when, overall, the F-measure decreased when the error rate increased. All mappers had F-measures close to 1 when the reads contained no sequencing errors or had low error rates, which meant that they were able to correctly map the whole set of reads. SRmapper, PASS, BWA, SNAP, and GSNAP showed significant decreases in the F-measure when 1.5% and 3% of indels were present in the reads. SRmapper and SNAP used with their default settings do not allow indels in the alignments, which explained the very low F-measure values observed for these two mappers. The low F-measure values for SRmapper and SNAP were attributable to low precision values, whereas for BWA, the low F-measures resulted from low recall values (see Section 3.1 in Additional file <xref ref-type="supplementary-material" rid="S1">1</xref>). Thus, with high error rates, BWA did not map a large number of reads but the mapped reads were correct; whereas, a large number of reads were incorrectly mapped by SRmapper and SNAP (see the figure showing the percentage of mapped reads in Section 3.1 in Additional file <xref ref-type="supplementary-material" rid="S1">1</xref>). The nine other mappers tested showed high F-measure values. Segemehl had a very high F-measure even with high error rates, meaning that it correctly map the major part of the read dataset. MOSAIK, SMALT, SSAHA2, and Novoalign showed peaks in the F-measure values when the dataset contained only indel errors and seemed to better handle one kind of error rather than a combination of substitution and indel errors. SHRiMP2 and Bowtie2, and more significantly TMAP and BWASW, showed a decrease of F-measure values for 1.5 and 3% indel error rates. Most of the tested mappers have been tuned mainly to deal with substitutions, which can explain their changing behaviors. The F-measure variations observed for these nine mappers are mainly the result of precision variations, except for Novoalign for which the recall values decreased at high error rates.</p>
      <fig id="F3" position="float">
        <label>Figure 3</label>
        <caption>
          <p><bold>F-measures with varying error rate for each mapper dealing with simulated datasets.</bold> F-measures are shown for error rates from 0 to 4%. The simulated read datasets consisted of 50,000 reads with a mean length of 200 bases. (1) indicates the mappers that report only one read (‘any-best’ mode) and (2) indicates the mappers that can run only in ‘all-best’ mode.</p>
        </caption>
        <graphic xlink:href="1471-2164-15-264-3"/>
      </fig>
      <p>These experiments were repeated for simulated datasets containing reads with a mean length of 100 and 400 bases (corresponding figures can be found in Section 3.1 in Additional file <xref ref-type="supplementary-material" rid="S1">1</xref>). Overall, the F-measure values were marginally higher for the shortest reads but the mapper behaviors were similar to the behaviors observed with the dataset containing the reads with a mean length of 200 bases. However, differences were observed for BWA and GSNAP for which the F-measures were significantly better for the dataset with the shorter reads. BWA was designed to map reads up to 100 bp long, which explained the better results with short reads. The F-measures for the dataset of reads of 400 bases were lower for all the mappers and a significant decrease was observed for Novoalign, BWA (designed for short reads), and GSNAP. For the reads of 400 bases, Novoalign showed an F-measure close to 0 even when the reads contained no errors. This finding can be explained by the fact that Novoalign truncates reads before alignment (option -<italic>n</italic>). The maximum allowed read length is 300, so all reads longer than this are truncated to 300 before mapping.</p>
      <p>These experiments showed that most of the mappers were less robust when the indel rate increased, probably because most mappers are tuned mainly to deal with substitutions. In the alignment step, the scoring parameters used by the mappers are often those currently used in bioinformatics, <italic>i.e.</italic> from the evolutionary point of view, a substitution is less penalized than an insertion or a deletion. However, in sequencing, mutations do not follow evolutionary rules; rather, they are dependent on the error model of the sequencing technology. The Ion Torrent PGM, for example, is known to introduce more indels than substitutions into homopolymer stretches. Therefore, mapper robustness could probably be improved by modifying the scoring parameters in the alignment step by decreasing the indel penalty. To test this idea, we changed the gap penalty for two mappers, SHRiMP2 and PASS. For SHRiMP2, the gap open and extension penalties were set to match the penalty for substitutions (see the Section 4.1 in Additional file <xref ref-type="supplementary-material" rid="S1">1</xref> for more details). For PASS, a maximum gap of 8 bases was allowed with a gap open and extension penalty of 1. The F-measures that were obtained with the adapted scoring parameters behaved in the same way as previously observed for these two methods, but they were globally better for all error rates than the F-measures obtained with the default parameters (the corresponding figure can be found in Section 4.1 in Additional file <xref ref-type="supplementary-material" rid="S1">1</xref>).</p>
      <p>All the simulated datasets described above contained 2,500 random reads (<italic>i.e.</italic> reads that were generated by choosing randomly a nucleotide for each position), which could not be mapped onto the reference genome. All the mappers, except SMALT and TMAP, returned all the random reads as unmapped. For SMALT and TMAP, the longer the read length the higher the number of mapped random reads. SMALT mapped only a small number of the random reads (less than 10 reads with around 30 matches), whereas TMAP mapped around 10%, 12%, and 16% of the random reads in the 100, 200, and 400 bases datasets, respectively, with around 15 matches. These percentages are not negligible and indicated that the TMAP strategy (used as the default mapper in Ion Torrent analysis suite) was to map a maximum number of reads even if the mapping was not always relevant. The reported alignments for the random reads were short and could be filtered out easily, but for non-expert users these reported hits will add to the complexity of the read mapping task.</p>
      <p>In conclusion, most of the tested mappers were robust with low error rates. Segemehl showed the best F-measures even for datasets with high error rates and for all read lengths considered in this study. MOSAIK, SMALT, SSAHA2, Bowtie2, and SHRiMP2 correctly mapped a major part of the read datasets. The results also showed that to handle Ion Torrent reads, mappers need to allow indels in the alignments, as was clear for all tested mappers except for SRmapper and PASS with their default settings. We also demonstrated that decreasing the gap penalties could improve the mapping results for Ion Torrent data.</p>
      <p>To avoid simulation biases, RABEMA was used to evaluate mapper performances with real datasets.</p>
      <p>In RABEMA, a full-sensitivity algorithm was used to identify all possible matching intervals within a given error rate range for each read and the mapper evaluation was based on a metric called normalized found intervals (NFI), in which each interval for a read contributed 1/<italic>x</italic> points, where <italic>x</italic> is the number of alignments for the read. The number of points was divided by the number of reads and multiplied by 100 to get the percentage. Figure <xref ref-type="fig" rid="F4">4</xref> shows the percentage of NFI for mappers run in the ‘all’ mode with varying error rates. Only 11 mappers were considered because BWASW, SNAP, and SRmapper cannot be run in ‘all’ mode. All the mappers identified between 100% and 95% of the NFI for datasets with no errors. However, for datasets with errors, the NFI fell rapidly to below 10% of NFI for some mappers (PASS, BWA, and GSNAP), while others (TMAP, SSAHA2, SMALT, MOSAIK, and Novoalign) maintained a high NFI percentage for datasets with up to a 4% error rate and finished at between 50 and 20% NFI for an 8% error rate (Novoalign fell rapidly and finished below 10%). Only segemehl, SHRiMP2, and Bowtie2 maintained NFI above 80%, even at an 8% error rate.</p>
      <fig id="F4" position="float">
        <label>Figure 4</label>
        <caption>
          <p><bold>Normalized found intervals with varying error rate for the mappers that can run in ‘all-mode’.</bold> The percentage of normalized found intervals was obtained using RABEMA, with error rates varying from 0 to 8% for the 11 mappers run in ‘all-mode’. Mappers were run with real sub-datasets containing 50,000 reads randomly extracted from the RD_200 dataset. Each point is the mean value of four sub-datasets.</p>
        </caption>
        <graphic xlink:href="1471-2164-15-264-4"/>
      </fig>
      <p>The experiments were repeated with datasets that contained reads 100 and 400 bases long (figures can be found in Section 3.1 in Additional file <xref ref-type="supplementary-material" rid="S1">1</xref>). The ranking and behavior of the 11 mappers were similar to those obtained with datasets containing read lengths of 100, except Novoalign which was significantly better with the shorter reads. For datasets with reads 400 bases long, the behavior of most of the mappers was similar to the behavior observed with 200-base long reads but the NFI percentages were lower. The Novoalign plot with several increases and decreases was atypical and only around 16% of the 400-base reads were mapped, probably because Novoalign trims reads to a maximum length of 300 bases. BWA identified around 100% NFI in the 400-base reads dataset with no errors, while with an error rate of 8% the NFI only fell to 40%. This behavior for BWA was surprising when compared with its behavior in the previous experiments; however, it can be explained by the definition of NFI used by RABEMA. In RABEMA, reads do not have to be aligned over their entire length to be considered as correctly mapped; so, many of the short alignments returned by BWA were classified as correct by RABEMA, which was not the case with our new definition. The analysis of mapper performances on real datasets with RABEMA indicated that Bowtie2, segemehl, and SHRiMP2 were better than the other mappers, even for datasets with high error rates and regardless of the read lengths.</p>
      <p>Similar observations and similar rankings were obtained with the real and simulated datasets. This double strategy built our confidence in the conclusions drawn from these experiments and confirmed that our simulator generated reads that were similar to sequencer generated reads (at least for Ion Torrent generated reads).</p>
    </sec>
    <sec>
      <title>Study of repeats</title>
      <p>The study and analysis of repeated sequences is as important for small microbial genomes, especially for bacterial genomes, as it is for eukaryotic genomes. Repeats in bacterial genomes represent a smaller proportion of the total genomic DNA that they do in eukaryotic genomes, but the repeated elements are usually longer(for example, copies of homologous genes, inserted sequences, and transposons). Mapper behavior when dealing with repetitive regions in a reference genome is, therefore, an important parameter when the DNA repeat regions may also be informative regions. To study the ability of a mapper to report all possible positions for a read in a repeated sequence, we used an artificial genome containing five repeats. In theory, a mapper, in ‘all’ mode, must report 5 hits for each repeat-located read. Figure <xref ref-type="fig" rid="F5">5</xref> shows the percentage of repeat-located reads correctly reported by the mappers with reads of 200 bases, subdivided in classes depending on the number of hits found. For each of the repeat-located reads, the number of locations in a repeat were counted. Note that BWASW and SNAP can report only one hit (‘any-best’ mode) and SRmapper is limited to all-best hits. Most of the mappers were able to map repeat-located reads in at least one repeat (percentages were close to 100%), except for BWA and PASS. Only two mappers (SMALT and GSNAP) retrieved a large proportion (more than 80%) of the 5 hits and four few others (SHRiMP2, MOSAIK, TMAP, and Bowtie2) retrieved an average proportion of the 5 hits (between 70 and 35%). The other mappers performed quite poorly in this task, retrieving only a small percentage or none of the 5 hits. With 100-base and 400-base reads, the mappers gave better and worse global results, respectively, than they did with the 200-base reads (except for TMAP which was less efficient with the 100-base reads than it was with the 200-base reads; see Section 3.2 in Additional file <xref ref-type="supplementary-material" rid="S1">1</xref>). In conclusion, SMALT was very good at retrieving multi-mapped reads whatever the read length, while GSNAP, MOSAIK, and SHRiMP2 also gave correct results. TMAP was better with longer reads and Novoalign was better with shorter reads. Mappers that cannot be run in ‘all-mode’ or that are not able to deal with indels (BWASW, SNAP, PASS, and SRmapper) are not suitable for identifying multi-mapped reads.</p>
      <fig id="F5" position="float">
        <label>Figure 5</label>
        <caption>
          <p><bold>Percentage of repeat-located reads correctly reported by the mappers.</bold> The percentage of reads correctly reported in a repeat is shown for the mappers dealing with simulated reads of 200 bases, subdivided in classes depending on the number of identified hits. (1) indicates mappers that that report only one read (‘any-best’ mode) and (2) indicates the mappers that can run only in ‘all-best’ mode.</p>
        </caption>
        <graphic xlink:href="1471-2164-15-264-5"/>
      </fig>
    </sec>
    <sec>
      <title>Mutation discovery</title>
      <p>Distinguishing between sequencing or mapping errors and true genetic variations is a challenge in variant analysis. Exome sequencing and genome re-sequencing require robust mapping results with as little noise as possible to identify a mutation of interest and to limit false positive mutations. Real reads from <italic>E. coli DH10B</italic> sequencing were mapped onto a genome sequence in which mutations with known positions and types (substitution or indel) had been introduced artificially. FreeBayes software [<xref ref-type="bibr" rid="B15">15</xref>] was used to call variants, and precision and recall values were computed for mutation discovery in a reference genome with varying mutation rates. Figure <xref ref-type="fig" rid="F6">6</xref> shows the precision and recall values obtained for mutation discovery with real datasets containing reads of 200 bases and a theoretical depth of 40<italic>X</italic>. Generally, precision and especially recall decreased when the mutation rate was increased in the reference genome. In all the experiments, the precision values were high, indicating that the mutations predicted by the variant caller from the mapping files were mainly correct for all mappers. Most of the tested mappers presented good precision and recall values for all mutation rates; the exceptions were BWA, Novoalign, PASS and SRmapper. SRmapper and PASS presented lower precision and recall values than all the other mappers mostly because these two mappers do not allow for indels in the alignments, which decreased the precision of the mapping (see the subsection Mapper robustness) and made the variant calling less accurate. The mutation discovery performances of BWA and Novoalign diminished when the mutation rate reached 5%. It should be noted that for these two mappers, the percentage of mapped reads, and therefore the mean depth, was low compared with the percentage of mapped reads for the other mappers (15% for BWA and 50% for Novalign - see the corresponding figure in Section 3.3 in Additional file <xref ref-type="supplementary-material" rid="S1">1</xref>). This reduced number of mapped reads did not permit the accurate detection of mutations in the reference genome. ROC curves were constructed (see the corresponding figures in Section 3.3 in Additional file <xref ref-type="supplementary-material" rid="S1">1</xref>), which confirmed the mutation discovery results that we obtained.</p>
      <fig id="F6" position="float">
        <label>Figure 6</label>
        <caption>
          <p><bold>Precision and recall values for mutation discovery with varying mutation rates in the reference genome.</bold> The real datasets that were used contained reads of 200 bases and had a theoretical depth of 40<italic>X</italic>. The precision (in black) and recall (in gray) values obtained for mutation discovery for each mapper are shown. Top panel: 0.05% mutations in the reference genome; middle panel: 1% mutations in the reference genome; and bottom panel: 5% mutations in the reference genome. (1) indicates the mappers that report only one read (‘any-best’ mode) and (2) indicates the mappers that can run only in ‘all-best’ mode.</p>
        </caption>
        <graphic xlink:href="1471-2164-15-264-6"/>
      </fig>
      <p>The experiments were repeated with simulated datasets (the corresponding figure can be found in Section 3.3 in Additional file <xref ref-type="supplementary-material" rid="S1">1</xref>). The conclusions that were drawn were similar to those obtained with the real datasets; however, the precision and recall values were lower for all mappers. We also performed similar experiments with real and simulated datasets for read lengths of 100 and 400 bases (see Section 3.3 in Additional file <xref ref-type="supplementary-material" rid="S1">1</xref> for corresponding figures). Mapper behavior was similar regardless of the read length, except for BWA and Novoalign. These two mappers showed better values with reads of 100 bases, and showed near zero recall values with reads of 400 bases. These results were not surprising because BWA was designed for short reads and Novoalign truncates reads to a maximum length of 300 bases.</p>
      <p>The behavior of the mappers in variant discovery was coherent with the results obtained in the robustness study and could be deduced from them. For example, SRmapper and BWA show a significant decrease in F-measure values when the error rate increased and similar behavior has been observed when the mutation rate was increased in the reference genomes. Variant discovery is impacted directly by the quality of the mapper alignments, <italic>i.e.</italic> position and type of edit operations (mismatches, insertions and deletions). The definition of a correctly mapped read introduced in this study is more stringent than for previous studies, because it takes into account the correctness of the alignment (length, number, and type of edit operations). These results demonstrated that the method we used to evaluate mapper robustness was efficient.</p>
      <p>For the simulated data, similar behavior was observed for all the mappers and for all datasets but with lower precision and recall values than was observed for the real data. This decrease could be explained by a lower error rate in the real data than in the simulated data. We performed complementary analyses to observe the precision and recall values obtained with lower sequencing error rates (data not shown). When reads were generated without errors, the precision and recall values were close to 1. Precision and recall values were closer to the values obtained for the real dataset values when reads were generated with 0.5% deletions, 0.25% insertions, and 0.25% substitutions, suggesting that the real dataset used here contained less than 2% sequencing errors. These experiments again showed that the data simulated with CuReSim have characteristics that are similar to the real data produced by the Ion Torrent PGM.</p>
      <p>Finally, because we used simulated data, the impact of sequencing depth in mutation discovery could be tested. We used SHRiMP2 because this mapper behaved well in the variant discovery experiments. The same procedure was applied with four different read datasets of 200 bases with mean depths of 20<italic>X</italic>, 80<italic>X</italic>, 160<italic>X</italic>, and 320<italic>X</italic> (results are shown in Table S1 of Section 4.2 in Additional file <xref ref-type="supplementary-material" rid="S1">1</xref>). The precision and recall values were lower with a mean sequencing depth of 20<italic>X</italic> and were equivalent for the other tested sequencing depths. These results showed that a mean sequencing depth of 40<italic>X</italic> was enough to call variations correctly. Increasing the depth of sequencing did not seem to improve the quality of variant calling.</p>
      <p>These experiments showed that most of the tested mappers gave correct results in mutation discovery even when used with their default settings. The only exceptions were the BWA, Novoalign, PASS, and SRmapper mappers. SRmapper and PASS do not allow indels in alignments. These kinds of mappers should be avoided for variant calling analysis.</p>
    </sec>
  </sec>
  <sec sec-type="discussion">
    <title>Discussion</title>
    <p>Here, a benchmark procedure to compare mappers for HTS that can be applied to any sequencing platforms and any applications is described. The different steps involved in this procedure are shown in Figure <xref ref-type="fig" rid="F7">7</xref>. In step 1, a list of mappers is defined. Depending on the sequencing technology and the application, the most appropriate mapper can be selected for use. In step 2, real datasets are collected and simulated datasets are generated before being mapped onto the reference genome. Step 3 is a comparison step based on four criteria: mapper computational resource and time requirements; mapper robustness; mapper behavior with repetitive regions; and mapper mutation discovery ability. The benchmark procedure uses simulated and real datasets to provide the user with a robust method for mapper comparison. The results obtained can be used to answer questions such as: How much RAM is required? How long will it take to map a set of reads? How does the robustness vary in relation to the error rate? How does a mapper deal with multi-mapped reads? Could a mapper be used with a distant reference genome? What is the quality of the reported alignment? Answers to these questions can help users chose a mapper that best fits a particular application and sequencing platform. This procedure could also be used to evaluate performances of a newly developed mapper or to optimize parameters of already existing mappers.</p>
    <fig id="F7" position="float">
      <label>Figure 7</label>
      <caption>
        <p><bold>Benchmark procedure used to compare mappers.</bold> The different steps used to compare mappers are shown. The criteria in the solid ellipses were used with simulated and real data, whereas the criteria in the dotted ellipses were used only with simulated data.</p>
      </caption>
      <graphic xlink:href="1471-2164-15-264-7"/>
    </fig>
    <p>We also presented a new read simulator, CuReSim (Customized Read Simulator), which generates synthetic HTS reads for the major letter-base sequencing platforms. Users can fix the mutation rates, the read lengths, and can generate random reads. Several error distribution modes are available and particular attention was paid to special cases in which several introduced errors in the same read can lower the number of errors because of compensatory changes. CuReSimEval is a complementary tool that evaluates the mapping quality from SAM files produced by aligning CuReSim simulated reads with any mapper. CuReSim and CuReSimEval are freely available at <ext-link ext-link-type="uri" xlink:href="http://www.pegase-biosciences.com/tools/curesim/">http://www.pegase-biosciences.com/tools/curesim/</ext-link>. The CuReSim suite has been developed in Java and is distributed as JAR files to be operating system independent and easy to use by non-expert users.</p>
    <p>We used the CuReSim suite in a mapper comparison with Ion Torrent data applied to small genomes. To obtain a robust evaluation procedure, we introduced a new definition for mapping correctness. This newly introduced definition is more stringent than the previous ones because the end of the alignment and the number of mutations were considered in addition to the start position. The mapper robustness results obtained with the CuReSim suite simulated data matched the results obtained with real datasets and RABEMA, demonstrating that the CuReSim suite simulated reads with characteristics similar to real reads. We performed completely independent experiments to evaluate the mutation discovery ability of the mappers and found that the results obtained for mapper robustness can also be used to predict the mutation discovery ability of the mappers. Variant calling efficiency is directly dependent on the alignment quality obtained by the mapping algorithms. Checking whether a mapped read is in its expected position is not sufficient because the position and number of edit operations in the produced alignment must also be as close as possible to the expected alignment. The sequencing errors in Ion Torrent reads are mainly indels. For mappers that are unable to deal correctly with indels, the resulting alignments, even those at the expected positions, can result in biased mapping that could impact the variant calling results. All our results demonstrated the reliability of our evaluation method.</p>
    <p>Our benchmark procedure was applied to Ion Torrent data from small genome sequencing. Mapping algorithms and previous mapper comparison studies focused mainly on short reads with substitutions (Illumina technology) and on large reference genomes (mainly the human genome). These evaluation studies therefore are poorly informative for mapping new technology sequencer data with different error models. Additionally, some features of bacterial and small genomes, such as possible extreme GC content, make the extrapolation from the previous studies difficult. For example, very high or low GC content percentages create a higher probability of encountering homopolymers in the genome sequence, which can significantly increase the number of indels in homopolymers. Our benchmark procedure for Ion Torrent data with bacterial genomes did not reveal a single best mapper but rather indicated several options depending on the particular application and technology. When only a desktop computer with 4 GB of RAM is available, users can select a mapper that is not highly memory-consuming; for example, Novoalign, SMALT, SRmapper, Bowtie2, MOSAIK, or segemehl. Novoalign, segemehl, and GSNAP require very long runtimes, while SNAP is very fast (around 2 minutes to deal with big datasets). Other mappers had runtimes shorter than 40 minutes for the bigger datasets. Concerning mapper robustness with varying error rates, all mappers manage to correctly map reads when the sequencing error rate was low; however, some mappers were clearly not suitable for use with datasets containing high error rates (PASS, BWA, GSNAP, SNAP, and SRmapper). Segemehl presented good F-measure values with all the tested datasets even at high error rates. MOSAIK, SHRiMP2, and Bowtie2 also gave correct results. SMALT was well fitted to retrieve all hits for repeat-located reads and GSNAP, MOSAIK, and SHRiMP2 also give correct results in this task. One of these mappers is therefore suitable for the identification of unique and non-unique reads, whereas PASS, BWA, BWASW, SNAP, and SRmapper are not. Mapper behavior for mutation discovery with datasets with varying mutation rates using a close but not identical reference genome is of special interest because often only the genome of a closely-related species is available as a reference. Mutation discovery ability is also important when the genomes of two closely-related strains are compared to detect variants or mutated strains, for example. In such cases, mappers need to produce accurate alignments so that true mutations can be detected. All the mappers tested here showed good precision and recall with all tested mutation rates and for all datasets, except BWA, Novoalign, PASS, and SRmapper.</p>
    <p>Our results show that some mappers dealt correctly with the Ion Torrent data although they were not initially designed for this technology. For example, SHRiMP2 which was designed for Illumina, SOLiD, and 454 reads, showed robust results with Ion Torrent data.</p>
    <p>The mapper default parameters were used deliberately in this study to mimic the general case of a non-expert user; therefore, different results could have been obtained with other parameter settings. Even with the default settings, several mappers that can be used with Ion Torrent data were identified. Additionally, we showed that the mapping results could be improved by adapting the parameter settings to the error model, for example, by decreasing the indel penalty with SHRiMP2. For Ion Torrent data, our study demonstrated that to be efficient a mapper had to allow indels in the alignments and that the results were more reliable when the mapping algorithm allowed multi-mapped reads. The mutation discovery experiments showed that a sequencing depth of 40<italic>X</italic> was enough to correctly call variants.</p>
  </sec>
  <sec sec-type="conclusions">
    <title>Conclusions</title>
    <p>All the different applications that arise from HTS technologies need not have the same mapping characteristics. Some applications may require robust mapping that deals with high error rates while others may require the ability to deal with repeats, for example, when re-sequencing is performed for bacterial variant identification aimed at efficiently detecting mutations and indels. Mappers such as SSAHA2, TMAP, SHRiMP2, or Bowtie2 will support the detection of mutations even at high rates and without the necessity for deep sequencing. In other applications, such as amplicon sequencing to study of repeated motifs (such as CRISPR or IS), the ability to map correctly on repeat regions will be essential and a mapper like SMALT, which performs such tasks very well even though its robustness is not among the highest could be used.</p>
    <p>However, for some specific applications, such as the discovery of mutations in viral genomes, mappers such as Bowtie2, segemehl, and SHRiMP2 with strong robustness could be used because accurate mapping of the maximum number of reads, especially the few that bear the mutation, is essential [<xref ref-type="bibr" rid="B28">28</xref>].</p>
    <p>For some applications, it could be better to use a combination of mappers; for example, in pathogen identification, the strain might be unknown. In this case, SNAP can be used to quickly identify a close reference genome among a set of available genomes, then a more robust mapper can be used to identify mutations or unique reads.</p>
    <p>The correct choice of mapper is crucial in HTS data analysis. In this paper, we have presented a benchmark procedure to compare mapping algorithms that are used currently in HTS. Therefore, we introduced a stringent definition of mapping correctness together with a new read simulator, CuReSim, to generate simulated reads with controlled type, rate, and/or distribution of errors along the reads. The read simulator is freely distributed along with a tool to evaluate the mapping quality, CuReSimEval; both are available at <ext-link ext-link-type="uri" xlink:href="http://www.pegase-biosciences.com/tools/curesim/">http://www.pegase-biosciences.com/tools/curesim/</ext-link>. This procedure was applied to small genomes with Ion Torrent data. Our results do not lead to the selection of a unique, omnipotent mapper but rather show that the choice of mapper has to be application and sequencing technology driven. Our study also demonstrates that a combination of several complementary mappers could significantly improve the mapping step in pipelines. Possible combinations should be tested and evaluated using the same approach. The benchmark procedure presented here greatly helps in the choice of a good mapper for a given application and dataset. This procedure could also be used to evaluate a newly developed mapper or to optimize parameters of an already existing one. An optimized solution for read mapping, adapted to sequencing technology and biological applications, will help compensate for HTS defects.</p>
  </sec>
  <sec sec-type="methods">
    <title>Methods</title>
    <sec>
      <title>Mappers</title>
      <p>The mappers used in this study were selected from the list given in [<xref ref-type="bibr" rid="B2">2</xref>]. The mappers that were explicitly indicated as compatible with Ion Torrent data were selected first; namely, Bowtie2, GSNAP, MOSAIK, Novoalign, segemehl, SMALT, SNAP, and TMAP. Reads generated using the Roche 454 technology have features in common with Ion Torrent reads, so the mapper list was extended to include mappers that were compatible with 454 technology; namely, BWA, BWASW, PASS, SHRiMP2, and SSAHA2. Finally, SRmapper, which is not a sequencing-platform specific mapper, was added. Table <xref ref-type="table" rid="T2">2</xref> lists the 14 selected mappers used in this study and their main features. The main differences between them are the algorithmic approaches and the available options. All the selected mappers index the reference genome, and MOSAIK indexes the reference genome and the reads. The Bowtie2, BWA, BWASW, and TMAP algorithms are all based on the Burrows–Wheeler transform, while the algorithms of the other mappers use hash-tables. TMAP is the mapper that is commonly distributed with the Ion Torrent technology. TMAP uses a series of algorithms (BWA, BWASW, SSAHA2, the super-maximal exact matching algorithm, and the Smith–Waterman algorithm) to map data to an indexed reference sequence. Parallel implementation can greatly decrease execution times for almost all mappers. Most mappers can report all the hits with scores higher than a given threshold; this option is often called the ‘all’ mode report. SRmapper can be run only in the ‘all-best’ mode, which means it reports all hits with the best score. BWASW and SNAP can only be run in ‘any-best’ mode, which means they report only one random hit from among the best hits. The selected mappers were run with their default parameters, except those for which the reporting mode was set to ‘all’ mode. The number of threads was fixed to 24 for all the parallel implemented mappers. The command lines that were used for each of the mappers are available in Section 1 in Additional file <xref ref-type="supplementary-material" rid="S1">1</xref>.</p>
      <table-wrap position="float" id="T2">
        <label>Table 2</label>
        <caption>
          <p>Description of mappers used in this study</p>
        </caption>
        <table frame="hsides" rules="groups" border="1">
          <colgroup>
            <col/>
            <col/>
            <col/>
            <col/>
            <col/>
            <col/>
            <col/>
            <col/>
            <col/>
            <col/>
            <col/>
          </colgroup>
          <thead valign="top">
            <tr>
              <th colspan="11" align="center">
                <bold>Features of mappers used in this study</bold>
              </th>
            </tr>
          </thead>
          <tbody valign="top">
            <tr>
              <td align="center" valign="bottom">
                <bold>Name</bold>
                <hr/>
              </td>
              <td align="center" valign="bottom">
                <bold>Version</bold>
                <hr/>
              </td>
              <td align="center" valign="bottom">
                <bold>Algorithm</bold>
                <hr/>
              </td>
              <td align="center" valign="bottom">
                <bold>Mis.</bold>
                <hr/>
              </td>
              <td align="center" valign="bottom">
                <bold>Indels</bold>
                <hr/>
              </td>
              <td align="center" valign="bottom">
                <bold>Gaps</bold>
                <hr/>
              </td>
              <td align="center" valign="bottom">
                <bold>Report</bold>
                <hr/>
              </td>
              <td align="center" valign="bottom">
                <bold>Align.</bold>
                <hr/>
              </td>
              <td align="center" valign="bottom">
                <bold>Parallel</bold>
                <hr/>
              </td>
              <td align="center" valign="bottom">
                <bold>Qual.</bold>
                <hr/>
              </td>
              <td align="center" valign="bottom">
                <bold>Ref.</bold>
                <hr/>
              </td>
            </tr>
            <tr>
              <td align="center" valign="bottom">Bowtie2<hr/></td>
              <td align="center" valign="bottom">2.0.4<hr/></td>
              <td align="center" valign="bottom">BWT<hr/></td>
              <td align="center" valign="bottom">Y<hr/></td>
              <td align="center" valign="bottom">Y<hr/></td>
              <td align="center" valign="bottom">Y<hr/></td>
              <td align="center" valign="bottom">A<hr/></td>
              <td align="center" valign="bottom">G,L<hr/></td>
              <td align="center" valign="bottom">Y<hr/></td>
              <td align="center" valign="bottom">Y<hr/></td>
              <td align="center" valign="bottom">[<xref ref-type="bibr" rid="B16">16</xref>]<hr/></td>
            </tr>
            <tr>
              <td align="center" valign="bottom">BWA<hr/></td>
              <td align="center" valign="bottom">0.6.2<hr/></td>
              <td align="center" valign="bottom">BWT<hr/></td>
              <td align="center" valign="bottom">Y<hr/></td>
              <td align="center" valign="bottom">Y<hr/></td>
              <td align="center" valign="bottom">Y<hr/></td>
              <td align="center" valign="bottom">A<hr/></td>
              <td align="center" valign="bottom">G<hr/></td>
              <td align="center" valign="bottom">Y<hr/></td>
              <td align="center" valign="bottom">Y<hr/></td>
              <td align="center" valign="bottom">[<xref ref-type="bibr" rid="B17">17</xref>]<hr/></td>
            </tr>
            <tr>
              <td align="center" valign="bottom">BWASW<hr/></td>
              <td align="center" valign="bottom">0.6.2<hr/></td>
              <td align="center" valign="bottom">BWT<hr/></td>
              <td align="center" valign="bottom">Y<hr/></td>
              <td align="center" valign="bottom">Y<hr/></td>
              <td align="center" valign="bottom">Y<hr/></td>
              <td align="center" valign="bottom">AnyB<hr/></td>
              <td align="center" valign="bottom">L<hr/></td>
              <td align="center" valign="bottom">Y<hr/></td>
              <td align="center" valign="bottom">Y<hr/></td>
              <td align="center" valign="bottom">[<xref ref-type="bibr" rid="B18">18</xref>]<hr/></td>
            </tr>
            <tr>
              <td align="center" valign="bottom">GSNAP<hr/></td>
              <td align="center" valign="bottom">2012-12-20<hr/></td>
              <td align="center" valign="bottom">HT<hr/></td>
              <td align="center" valign="bottom">Y<hr/></td>
              <td align="center" valign="bottom">Y<hr/></td>
              <td align="center" valign="bottom">Y<hr/></td>
              <td align="center" valign="bottom">A<hr/></td>
              <td align="center" valign="bottom">G,L<hr/></td>
              <td align="center" valign="bottom">Y<hr/></td>
              <td align="center" valign="bottom">N<hr/></td>
              <td align="center" valign="bottom">[<xref ref-type="bibr" rid="B19">19</xref>]<hr/></td>
            </tr>
            <tr>
              <td align="center" valign="bottom">MOSAIK<hr/></td>
              <td align="center" valign="bottom">2.1.73<hr/></td>
              <td align="center" valign="bottom">HTR<hr/></td>
              <td align="center" valign="bottom">Y<hr/></td>
              <td align="center" valign="bottom">Y<hr/></td>
              <td align="center" valign="bottom">Y<hr/></td>
              <td align="center" valign="bottom">A<hr/></td>
              <td align="center" valign="bottom">G<hr/></td>
              <td align="center" valign="bottom">Y<hr/></td>
              <td align="center" valign="bottom">Y<hr/></td>
              <td align="center" valign="bottom">[<xref ref-type="bibr" rid="B20">20</xref>]<hr/></td>
            </tr>
            <tr>
              <td align="center" valign="bottom">Novoalign<hr/></td>
              <td align="center" valign="bottom">2.08.03<hr/></td>
              <td align="center" valign="bottom">HT<hr/></td>
              <td align="center" valign="bottom">Y<hr/></td>
              <td align="center" valign="bottom">Y<hr/></td>
              <td align="center" valign="bottom">Y<hr/></td>
              <td align="center" valign="bottom">A<hr/></td>
              <td align="center" valign="bottom">G<hr/></td>
              <td align="center" valign="bottom">N<hr/></td>
              <td align="center" valign="bottom">Y<hr/></td>
              <td align="center" valign="bottom"> <hr/></td>
            </tr>
            <tr>
              <td align="center" valign="bottom">PASS<hr/></td>
              <td align="center" valign="bottom">2.02<hr/></td>
              <td align="center" valign="bottom">HT<hr/></td>
              <td align="center" valign="bottom">Y<hr/></td>
              <td align="center" valign="bottom">Y<hr/></td>
              <td align="center" valign="bottom">Y<hr/></td>
              <td align="center" valign="bottom">A<hr/></td>
              <td align="center" valign="bottom">G<hr/></td>
              <td align="center" valign="bottom">Y<hr/></td>
              <td align="center" valign="bottom">Y<hr/></td>
              <td align="center" valign="bottom">[<xref ref-type="bibr" rid="B21">21</xref>]<hr/></td>
            </tr>
            <tr>
              <td align="center" valign="bottom">segemehl<hr/></td>
              <td align="center" valign="bottom">0.1.4-380<hr/></td>
              <td align="center" valign="bottom">ESA<hr/></td>
              <td align="center" valign="bottom">Y<hr/></td>
              <td align="center" valign="bottom">Y<hr/></td>
              <td align="center" valign="bottom">Y<hr/></td>
              <td align="center" valign="bottom">A<hr/></td>
              <td align="center" valign="bottom">G<hr/></td>
              <td align="center" valign="bottom">Y<hr/></td>
              <td align="center" valign="bottom">N<hr/></td>
              <td align="center" valign="bottom">[<xref ref-type="bibr" rid="B22">22</xref>]<hr/></td>
            </tr>
            <tr>
              <td align="center" valign="bottom">SHRiMP2<hr/></td>
              <td align="center" valign="bottom">2.2.3<hr/></td>
              <td align="center" valign="bottom">HT<hr/></td>
              <td align="center" valign="bottom">Y<hr/></td>
              <td align="center" valign="bottom">Y<hr/></td>
              <td align="center" valign="bottom">N<hr/></td>
              <td align="center" valign="bottom">A<hr/></td>
              <td align="center" valign="bottom">G<hr/></td>
              <td align="center" valign="bottom">Y<hr/></td>
              <td align="center" valign="bottom">Y<hr/></td>
              <td align="center" valign="bottom">[<xref ref-type="bibr" rid="B23">23</xref>]<hr/></td>
            </tr>
            <tr>
              <td align="center" valign="bottom">SMALT<hr/></td>
              <td align="center" valign="bottom">0.7.0.1<hr/></td>
              <td align="center" valign="bottom">HT<hr/></td>
              <td align="center" valign="bottom">Y<hr/></td>
              <td align="center" valign="bottom">Y<hr/></td>
              <td align="center" valign="bottom">N<hr/></td>
              <td align="center" valign="bottom">A<hr/></td>
              <td align="center" valign="bottom">L<hr/></td>
              <td align="center" valign="bottom">Y<hr/></td>
              <td align="center" valign="bottom">Y<hr/></td>
              <td align="center" valign="bottom"> <hr/></td>
            </tr>
            <tr>
              <td align="center" valign="bottom">SNAP<hr/></td>
              <td align="center" valign="bottom">0.15<hr/></td>
              <td align="center" valign="bottom">HT<hr/></td>
              <td align="center" valign="bottom">Y<hr/></td>
              <td align="center" valign="bottom">Y<hr/></td>
              <td align="center" valign="bottom">Y<hr/></td>
              <td align="center" valign="bottom">AnyB<hr/></td>
              <td align="center" valign="bottom">G,L<hr/></td>
              <td align="center" valign="bottom">Y<hr/></td>
              <td align="center" valign="bottom">Y<hr/></td>
              <td align="center" valign="bottom">[<xref ref-type="bibr" rid="B24">24</xref>]<hr/></td>
            </tr>
            <tr>
              <td align="center" valign="bottom">SRmapper<hr/></td>
              <td align="center" valign="bottom">0.1.1<hr/></td>
              <td align="center" valign="bottom">HT<hr/></td>
              <td align="center" valign="bottom">Y<hr/></td>
              <td align="center" valign="bottom">N<hr/></td>
              <td align="center" valign="bottom">N<hr/></td>
              <td align="center" valign="bottom">AB<hr/></td>
              <td align="center" valign="bottom">G<hr/></td>
              <td align="center" valign="bottom">N<hr/></td>
              <td align="center" valign="bottom">N<hr/></td>
              <td align="center" valign="bottom">[<xref ref-type="bibr" rid="B25">25</xref>]<hr/></td>
            </tr>
            <tr>
              <td align="center" valign="bottom">SSAHA2<hr/></td>
              <td align="center" valign="bottom">2.5.5<hr/></td>
              <td align="center" valign="bottom">HT<hr/></td>
              <td align="center" valign="bottom">Y<hr/></td>
              <td align="center" valign="bottom">Y<hr/></td>
              <td align="center" valign="bottom">N<hr/></td>
              <td align="center" valign="bottom">A<hr/></td>
              <td align="center" valign="bottom">L<hr/></td>
              <td align="center" valign="bottom">N<hr/></td>
              <td align="center" valign="bottom">N<hr/></td>
              <td align="center" valign="bottom">[<xref ref-type="bibr" rid="B26">26</xref>]<hr/></td>
            </tr>
            <tr>
              <td align="center">TMAP</td>
              <td align="center">3.2.2</td>
              <td align="center">BWT</td>
              <td align="center">Y</td>
              <td align="center">Y</td>
              <td align="center">Y</td>
              <td align="center">A</td>
              <td align="center">G,L</td>
              <td align="center">Y</td>
              <td align="center">Y</td>
              <td align="center">[<xref ref-type="bibr" rid="B27">27</xref>]</td>
            </tr>
          </tbody>
        </table>
        <table-wrap-foot>
          <p>The column headed ‘version’ indicates the version of the mapper used in this study; the column headed ‘algorithm’ gives the algorithmic method used in the mapper. BWT, the reference genome was indexed with the Burrows–Wheeler transform; HT, the reference genome was indexed with Hash-Table; HTR, the reference genome and reads were indexed with Hash-Table; and ESA, the reference genome was indexed by enhanced suffix arrays. In the columns headed ‘mis.’ (mismatches), ‘indels’, and ‘gaps’, ‘Y’ indicates the algorithm allows mismatches, indels, and long insertions or deletions, and ‘N’ indicates otherwise. The column headed ‘report’ indicates the available report mode: ‘A’ for ‘all’; ‘AnyB’ for ‘any-best’; and ‘AB’ for ‘all-best’ mode. The column headed ‘align.’ ‘G’ (globally) indicates the reads were aligned end-to-end and ‘L’ locally indicates they were not. In the column headed ‘parallel’, ‘Y’ indicates the algorithm is multi-threaded, and ‘N’ indicates it is not. The column headed ‘qual.’ indicates if sequencing quality is taken into account by the mapper (‘Y’ for yes; ‘N’ for no). Bibliographical references are given in the last column.</p>
        </table-wrap-foot>
      </table-wrap>
    </sec>
    <sec>
      <title>Computational resource requirement and time measurement</title>
      <p>Memory consumption was measured by parsing the output of the Unix command ‘top’ every second. The time measurement was obtained using the Unix command ‘time’. The real time corresponds to the elapsed wall-clock time. CPU time, obtained by adding the user and system times, is the amount of time the CPU was actually executing instructions. All the mappers were run on a PC with a 6-core processor (2.40 GHz) with 24 GB of RAM.</p>
    </sec>
    <sec>
      <title>Datasets</title>
      <p>Real and simulated datasets were used in this study. Three real datasets obtained from the Ion Torrent Community website (<ext-link ext-link-type="uri" xlink:href="http://ioncommunity.lifetechnologies.com/">http://ioncommunity.lifetechnologies.com/</ext-link>) were used. The main features of the real datasets, RD_100, RD_200, and RD_400, are shown in Table <xref ref-type="table" rid="T1">1</xref>. For some experiments, smaller datasets were required; therefore, 50,000 reads were extracted randomly from the real data to generate the smaller datasets. Four files were generated from each dataset and the mean value was computed.</p>
      <p>Simulated data were generated from the complete genome of <italic>Escherichia coli str. K-12 substr. DH10B</italic> [GenBank:NC_010473] using CuReSim. The command lines used for read generation are available in Section 1 in Additional file <xref ref-type="supplementary-material" rid="S1">1</xref>. Three datasets were generated with read lengths specific to Ion Torrent technology: mean lengths of 100 bases, 200 bases, and 400 bases with a standard deviation in length of 10% for each dataset. Ion Torrent technology produces reads with about 1% deletions, 0.5% insertions, and 0.5% substitutions [<xref ref-type="bibr" rid="B12">12</xref>,<xref ref-type="bibr" rid="B29">29</xref>,<xref ref-type="bibr" rid="B30">30</xref>]. Each simulated dataset contained 9 files of 50,000 reads with varying indel and substitution rates: the indel rate varied from 0 to 3% and the substitution rate varied from 0 to 1%. Table <xref ref-type="table" rid="T3">3</xref> shows the 9 files that formed the simulated dataset. Each dataset contained, among the 50,000 reads, 2,500 randomly generated reads.</p>
      <table-wrap position="float" id="T3">
        <label>Table 3</label>
        <caption>
          <p>Simulated datasets used in this study</p>
        </caption>
        <table frame="hsides" rules="groups" border="1">
          <colgroup>
            <col align="left"/>
            <col align="center"/>
            <col align="center"/>
            <col align="center"/>
          </colgroup>
          <thead valign="top">
            <tr>
              <th colspan="4" align="center">
                <bold>Simulated data</bold>
              </th>
            </tr>
          </thead>
          <tbody valign="top">
            <tr>
              <td align="center" valign="bottom">
                <bold>Insertion rate</bold>
                <hr/>
              </td>
              <td align="center" valign="bottom">
                <bold>Deletion rate</bold>
                <hr/>
              </td>
              <td align="center" valign="bottom">
                <bold>Substitution rate</bold>
                <hr/>
              </td>
              <td align="center" valign="bottom">
                <bold>Total error rate</bold>
                <hr/>
              </td>
            </tr>
            <tr>
              <td align="center" valign="bottom">0<hr/></td>
              <td align="center" valign="bottom">0<hr/></td>
              <td align="center" valign="bottom">0<hr/></td>
              <td align="center" valign="bottom">0<hr/></td>
            </tr>
            <tr>
              <td align="center" valign="bottom">0<hr/></td>
              <td align="center" valign="bottom">0<hr/></td>
              <td align="center" valign="bottom">0.5<hr/></td>
              <td align="center" valign="bottom">0.5<hr/></td>
            </tr>
            <tr>
              <td align="center" valign="bottom">0<hr/></td>
              <td align="center" valign="bottom">0<hr/></td>
              <td align="center" valign="bottom">1<hr/></td>
              <td align="center" valign="bottom">1<hr/></td>
            </tr>
            <tr>
              <td align="center" valign="bottom">0.5<hr/></td>
              <td align="center" valign="bottom">1<hr/></td>
              <td align="center" valign="bottom">0<hr/></td>
              <td align="center" valign="bottom">1.5<hr/></td>
            </tr>
            <tr>
              <td align="center" valign="bottom">0.5<hr/></td>
              <td align="center" valign="bottom">1<hr/></td>
              <td align="center" valign="bottom">0.5<hr/></td>
              <td align="center" valign="bottom">2<hr/></td>
            </tr>
            <tr>
              <td align="center" valign="bottom">0.5<hr/></td>
              <td align="center" valign="bottom">1<hr/></td>
              <td align="center" valign="bottom">1<hr/></td>
              <td align="center" valign="bottom">2.5<hr/></td>
            </tr>
            <tr>
              <td align="center" valign="bottom">1<hr/></td>
              <td align="center" valign="bottom">2<hr/></td>
              <td align="center" valign="bottom">0<hr/></td>
              <td align="center" valign="bottom">3<hr/></td>
            </tr>
            <tr>
              <td align="center" valign="bottom">1<hr/></td>
              <td align="center" valign="bottom">2<hr/></td>
              <td align="center" valign="bottom">0.5<hr/></td>
              <td align="center" valign="bottom">3.5<hr/></td>
            </tr>
            <tr>
              <td align="center">1</td>
              <td align="center">2</td>
              <td align="center">1</td>
              <td align="center">4</td>
            </tr>
          </tbody>
        </table>
        <table-wrap-foot>
          <p>The datasets each contained 50,000 reads with varying indel, substitution and error rates. The indel rate varied from 0 to 3%, the substitution rate varied from 0 to 1%, and the total error rate varied from 0 to 4%.</p>
        </table-wrap-foot>
      </table-wrap>
      <p>All the datasets and genomes used in this study can be obtained from the authors upon request.</p>
    </sec>
    <sec>
      <title>Mapper robustness</title>
      <p>To compare the mappers’ robustness, several metrics were computed for the simulated datasets. A read was considered as correctly mapped if among the reported hits at least one hit fitted the following criteria: i) the original start position (<italic>i.e.</italic> the position from which the read is generated) was retrieved, ii) the end position was retrieved, and iii) the alignment produced by the mapper showed exactly the same number of insertions, deletions, and substitutions. Indels in homopolymers at the end of the alignment led to failure to find some correct alignments (the observed start and end positions are not the expected ones). To deal with this special case, a shift for the start and end positions was allowed. The shift gives the number of possible insertions and deletions not considered at the alignment ends. In this case an alignment was considered as correct when the number of insertions (or deletions) in the mapper alignment added to the possible missing insertions (or deletions) was equal to the original number of insertions (or deletions), and the number of substitutions was the same. Figure <xref ref-type="fig" rid="F8">8</xref> shows examples of alignments produced by a mapper in the case of indels in this special case. In the read 1 example, the expected alignment starts in 4031012 and ends in 4031103, with two deletions, no insertions; and one substitution; however, the alignment returned by the mapper starts in 4031014, ends in 4031103, and showed only one substitution. Not considering the special case of indels at the alignment ends would have classified this read as incorrectly mapped. However, with our rules, the shift in start positions allowed one deletion at the start of the alignment, meaning that the read was classified as correctly mapped, which reflects reality. In the read 2 example, a shift permitted the addition of one deletion at the beginning of the alignment. However, the number of substitutions was different between the expected and observed alignments; therefore, the read was classified as incorrectly mapped. A read was considered as incorrectly mapped if no hits fitted the three criteria listed above. A read was considered as unmapped if the read was not identified on the reference genome. Precision and recall values were computed as: <inline-formula><mml:math id="M1" name="1471-2164-15-264-i1" overflow="scroll"><mml:mtext mathvariant="italic">precision</mml:mtext><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mtext mathvariant="italic">TP</mml:mtext></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">TP</mml:mtext><mml:mo>+</mml:mo><mml:mtext mathvariant="italic">FP</mml:mtext></mml:mrow></mml:mfrac></mml:math></inline-formula> and <inline-formula><mml:math id="M2" name="1471-2164-15-264-i2" overflow="scroll"><mml:mtext mathvariant="italic">recall</mml:mtext><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mtext mathvariant="italic">TP</mml:mtext></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">TP</mml:mtext><mml:mo>+</mml:mo><mml:mtext mathvariant="italic">FN</mml:mtext></mml:mrow></mml:mfrac></mml:math></inline-formula> with <italic>TP: true positives</italic> being correctly mapped reads, <italic>FP: false positives</italic> being incorrectly mapped reads, and <italic>FN: false negatives</italic> being unmapped reads. The F-measure combines the precision and recall values and was computed as: <inline-formula><mml:math id="M3" name="1471-2164-15-264-i3" overflow="scroll"><mml:mi>F</mml:mi><mml:mo>-</mml:mo><mml:mtext mathvariant="italic">measure</mml:mtext><mml:mo>=</mml:mo><mml:mn>2</mml:mn><mml:mo>∗</mml:mo><mml:mfrac><mml:mrow><mml:mtext mathvariant="italic">precision</mml:mtext><mml:mo>∗</mml:mo><mml:mtext mathvariant="italic">recall</mml:mtext></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">precision</mml:mtext><mml:mo>+</mml:mo><mml:mtext mathvariant="italic">recall</mml:mtext></mml:mrow></mml:mfrac></mml:math></inline-formula> The script to compute these metrics with simulated datasets produced by CuReSim is freely available.</p>
      <fig id="F8" position="float">
        <label>Figure 8</label>
        <caption>
          <p><bold>Reads identified as correctly and incorrectly mapped.</bold> Two representative alignments of simulated reads (read 1 and read 2). produced by a mapper in the special case of indels in homopolymers at the end of an alignment. In each case, the first alignment is the expected alignment for the simulated read with the correct number of insertions, deletions, and substitutions; the second alignment is the alignment returned by a mapper.</p>
        </caption>
        <graphic xlink:href="1471-2164-15-264-8"/>
      </fig>
      <p>To evaluate the mapper performances on real datasets, the reduced datasets containing 50,000 reads were mapped with each mapper using RABEMA [<xref ref-type="bibr" rid="B6">6</xref>] to obtain the percentage of NFI depending on the error rates. RABEMA was run for all the mappers in ‘all-mode’, except for BWASW, SNAP, and SRmapper for which the ‘all-mode’ is not available.</p>
    </sec>
    <sec>
      <title>Study of repeats</title>
      <p>A 250,000 bp long artificial genome was generated with five repeats of 500 bp and an error rate of 3%. Using CuReSim, we generated from this genome three sets of 50,000 reads with 0.5% insertions, 1% deletions, 0.5% substitutions, and a mean size of 100, 200, and 400 bases with a standard deviation in length of 10%. This artificial genome was used to evaluate the ability of a mapper to retrieve all locations for a read located in a repeat. A total of 479, 465, and 482 reads for the 100, 200, and 400-base datasets, respectively, were located in one of the 5 repetitions. The number of locations corresponding to a repeat was counted for each of the repeat-located reads.</p>
    </sec>
    <sec>
      <title>Mutation discovery</title>
      <p>To evaluate the ability of each mapper to retrieve mutations (<italic>i.e.</italic> true genetic variations within the sample), real and simulated datasets were used with reference genomes in which mutations were introduced artificially at different rates. An in-house script that can take an entire genome as input and return a mutated genome with a given error rate and a file containing the introduced mutations with their type (substitution or indel) and their genome position was used. For the real datasets, three mutated genomes were generated from the complete genome of <italic>Escherichia coli str. K-12 substr. DH10B</italic> with 0.05, 1, and 5% mutations (comprising 90% substitutions and 10% indels). These genomes were used as reference genomes with the real datasets RD_100 and a subset containing 830,000 reads from RD_200. In the same way, three mutated genomes from <italic>Escherichia coli str. K-12 substr. MG16655</italic> [GenBank:NC_000913] were generated to use as reference genomes with a sub-dataset extracted from the RD_400 dataset (595,000 reads). We used sub-datasets for read lengths of 200 and 400 bases to obtain a similar depth of 40<italic>X</italic> for each real dataset. For the simulated dataset, a sub-sequence of 250,000 bp from the <italic>Escherichia coli str. K-12 substr. DH10B</italic> complete genome(from 2,000,001 to 2,250,000) was extracted. From this sub-sequence, we generated three simulated read datasets with CuReSim, with mean lengths of 100, 200, and 400 bp with 10% standard deviation in length and 0.5% insertions, 1% deletions and 0.5% substitutions, and three mutated small genomes with 0.05, 1, and 5% mutations. To obtain a mean depth of about 40<italic>X</italic> for each length set, these 100, 200, and 400 datasets contained 100,000; 50,000, and 25,000 reads respectively. Mutation detection was performed with FreeBayes [<xref ref-type="bibr" rid="B15">15</xref>] version 9.9.2-27 (commit id:5d5b8ac). FreeBayes produces a file in Variant Call Format (VCF) that contains all variations. The VCF file was filtered to keep only the variations with a depth of at least 10 reads and a frequency of at least 80%. The ability of the mappers to detect true genetic variations was evaluated by computing precision and recall as follows: <inline-formula><mml:math id="M4" name="1471-2164-15-264-i4" overflow="scroll"><mml:mtext mathvariant="italic">precision</mml:mtext><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mtext mathvariant="italic">CM</mml:mtext></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">CM</mml:mtext><mml:mo>+</mml:mo><mml:mtext mathvariant="italic">IM</mml:mtext></mml:mrow></mml:mfrac></mml:math></inline-formula> and <inline-formula><mml:math id="M5" name="1471-2164-15-264-i5" overflow="scroll"><mml:mtext mathvariant="italic">recall</mml:mtext><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mtext mathvariant="italic">CM</mml:mtext></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">CM</mml:mtext><mml:mo>+</mml:mo><mml:mtext mathvariant="italic">IM</mml:mtext><mml:mo>+</mml:mo><mml:mtext mathvariant="italic">NM</mml:mtext></mml:mrow></mml:mfrac></mml:math></inline-formula>, where <italic>CM</italic> is correctly identified mutations, <italic>i.e.</italic> same type and same or equivalent position as the introduced mutation, <italic>IM</italic> is incorrectly identified mutation, and <italic>NM</italic> is not-found mutation.</p>
    </sec>
  </sec>
  <sec>
    <title>Competing interests</title>
    <p>The authors declare that they have no competing interests.</p>
  </sec>
  <sec>
    <title>Authors’ contributions</title>
    <p>SC designed the algorithm and wrote the source code, analyzed the project data, and drafted the manuscript. CA and DH supervised the research, carried out the planning and design, contributed to algorithm design and data analysis, and helped to draft the manuscript. YL contributed to the design of the project and to drafting the manuscript. All authors read and approved the final manuscript.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material content-type="local-data" id="S1">
      <caption>
        <title>Additional file 1</title>
        <p><bold>Supplementary material.</bold> This PDF file contains supplementary data for this paper. Section 1 - Command lines used for each of the tested mappers and for read generation. Section 2 - Description of CuReSim, the customizable read simulator, and CuReSimEval, the program to evaluate the mapping quality. Section 3 - additional figures. Section 4 - presents additional experiments.</p>
      </caption>
      <media xlink:href="1471-2164-15-264-S1.PDF">
        <caption>
          <p>Click here for file</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <sec>
    <title>Acknowledgements</title>
    <p>This work was supported by Univ Lille Nord de France, Institut Pasteur de Lille and the Gènes Diffusion company. We thank Gaël Even (Gènes Diffusion) for help on algorithm and computing aspects, and Kristina Keidel, Anne Bouchard, and Raymond Pierce for proofreading the manuscript. We also thank Wan-Ping Lee for help with the MOSAIK algorithm and Erik Garrison for help with FreeBayes and the modifications he made to the program.</p>
  </sec>
  <ref-list>
    <ref id="B1">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Soon</surname>
          <given-names>WW</given-names>
        </name>
        <name>
          <surname>Hariharan</surname>
          <given-names>M</given-names>
        </name>
        <name>
          <surname>Snyder</surname>
          <given-names>MP</given-names>
        </name>
        <article-title>High-throughput sequencing for biology and medicine</article-title>
        <source>Mol Syst Biol</source>
        <year>2013</year>
        <volume>15</volume>
        <issue>640</issue>
        <comment>[<ext-link ext-link-type="uri" xlink:href="http://www.ncbi.nlm.nih.gov/pubmed/23340846">http://www.ncbi.nlm.nih.gov/pubmed/23340846</ext-link>]</comment>
      </mixed-citation>
    </ref>
    <ref id="B2">
      <mixed-citation publication-type="other">
        <name>
          <surname>Fonseca</surname>
          <given-names>NA</given-names>
        </name>
        <name>
          <surname>Rung</surname>
          <given-names>J</given-names>
        </name>
        <name>
          <surname>Brazma</surname>
          <given-names>A</given-names>
        </name>
        <name>
          <surname>Marioni</surname>
          <given-names>JC</given-names>
        </name>
        <article-title>Tools for mapping high-throughput sequencing data</article-title>
        <source>Bioinformatics</source>
        <year>2012</year>
        <comment>[<ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/content/early/2012/10/11/bioinformatics.bts605.abstract">http://bioinformatics.oxfordjournals.org/content/early/2012/10/11/bioinformatics.bts605.abstract</ext-link>]</comment>
      </mixed-citation>
    </ref>
    <ref id="B3">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Li</surname>
          <given-names>H</given-names>
        </name>
        <name>
          <surname>Homer</surname>
          <given-names>N</given-names>
        </name>
        <article-title>A survey of sequence alignment algorithms for next-generation sequencing</article-title>
        <source>Brief Bioinformatics</source>
        <year>2010</year>
        <volume>15</volume>
        <issue>5</issue>
        <fpage>473</fpage>
        <lpage>483</lpage>
        <pub-id pub-id-type="doi">10.1093/bib/bbq015</pub-id>
        <?supplied-pmid 20460430?>
        <pub-id pub-id-type="pmid">20460430</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B4">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Bao</surname>
          <given-names>S</given-names>
        </name>
        <name>
          <surname>Jiang</surname>
          <given-names>R</given-names>
        </name>
        <name>
          <surname>Kwan</surname>
          <given-names>W</given-names>
        </name>
        <name>
          <surname>Wang</surname>
          <given-names>B</given-names>
        </name>
        <name>
          <surname>Ma</surname>
          <given-names>X</given-names>
        </name>
        <name>
          <surname>Song</surname>
          <given-names>YQ</given-names>
        </name>
        <article-title>Evaluation of next-generation sequencing software in mapping and assembly</article-title>
        <source>J Hum Genet</source>
        <year>2011</year>
        <volume>15</volume>
        <issue>6</issue>
        <fpage>406</fpage>
        <lpage>414</lpage>
        <pub-id pub-id-type="doi">10.1038/jhg.2011.43</pub-id>
        <?supplied-pmid 21525877?>
        <pub-id pub-id-type="pmid">21525877</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B5">
      <mixed-citation publication-type="other">
        <name>
          <surname>Ruffalo</surname>
          <given-names>M</given-names>
        </name>
        <name>
          <surname>LaFramboise</surname>
          <given-names>T</given-names>
        </name>
        <name>
          <surname>Koyutürk</surname>
          <given-names>M</given-names>
        </name>
        <article-title>Comparative analysis of algorithms for next-generation sequencing read alignment</article-title>
        <source>Bioinformatics</source>
        <year>2011</year>
        <comment>[<ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/content/27/20/2790">http://bioinformatics.oxfordjournals.org/content/27/20/2790</ext-link>]</comment>
      </mixed-citation>
    </ref>
    <ref id="B6">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Holtgrewe</surname>
          <given-names>M</given-names>
        </name>
        <name>
          <surname>Emde</surname>
          <given-names>AK</given-names>
        </name>
        <name>
          <surname>Weese</surname>
          <given-names>D</given-names>
        </name>
        <name>
          <surname>Reinert</surname>
          <given-names>K</given-names>
        </name>
        <article-title>A novel and well-defined benchmarking method for second generation read mapping</article-title>
        <source>BMC Bioinformatics</source>
        <year>2011</year>
        <volume>15</volume>
        <fpage>210</fpage>
        <comment>[<ext-link ext-link-type="uri" xlink:href="http://www.biomedcentral.com/1471-2105/12/210">http://www.biomedcentral.com/1471-2105/12/210</ext-link>]</comment>
        <pub-id pub-id-type="doi">10.1186/1471-2105-12-210</pub-id>
        <?supplied-pmid 21615913?>
        <pub-id pub-id-type="pmid">21615913</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B7">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Schbath</surname>
          <given-names>S</given-names>
        </name>
        <name>
          <surname>Martin</surname>
          <given-names>V</given-names>
        </name>
        <name>
          <surname>Zytnicki</surname>
          <given-names>M</given-names>
        </name>
        <name>
          <surname>Fayolle</surname>
          <given-names>J</given-names>
        </name>
        <name>
          <surname>Loux</surname>
          <given-names>V</given-names>
        </name>
        <name>
          <surname>Gibrat</surname>
          <given-names>JF</given-names>
        </name>
        <article-title>Mapping reads on a genomic sequence: an algorithmic overview and a practical comparative analysis</article-title>
        <source>J Comput Biol</source>
        <year>2012</year>
        <volume>15</volume>
        <issue>6</issue>
        <fpage>796</fpage>
        <lpage>813</lpage>
        <pub-id pub-id-type="doi">10.1089/cmb.2012.0022</pub-id>
        <?supplied-pmid 22506536?>
        <pub-id pub-id-type="pmid">22506536</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B8">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Hatem</surname>
          <given-names>A</given-names>
        </name>
        <name>
          <surname>Bozdag</surname>
          <given-names>D</given-names>
        </name>
        <name>
          <surname>Toland</surname>
          <given-names>AE</given-names>
        </name>
        <name>
          <surname>Catalyurek</surname>
          <given-names>UV</given-names>
        </name>
        <article-title>Benchmarking short sequence mapping tools</article-title>
        <source>BMC Bioinformatics</source>
        <year>2013</year>
        <volume>15</volume>
        <fpage>184</fpage>
        <pub-id pub-id-type="doi">10.1186/1471-2105-14-184</pub-id>
        <?supplied-pmid 23758764?>
        <pub-id pub-id-type="pmid">23758764</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B9">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Dohm</surname>
          <given-names>JC</given-names>
        </name>
        <name>
          <surname>Lottaz</surname>
          <given-names>C</given-names>
        </name>
        <name>
          <surname>Borodina</surname>
          <given-names>T</given-names>
        </name>
        <name>
          <surname>Himmelbauer</surname>
          <given-names>H</given-names>
        </name>
        <article-title>Substantial biases in ultra-short read data sets from high-throughput DNA sequencing</article-title>
        <source>Nucleic Acids Res</source>
        <year>2008</year>
        <volume>15</volume>
        <issue>16</issue>
        <fpage>e105</fpage>
        <pub-id pub-id-type="doi">10.1093/nar/gkn425</pub-id>
        <?supplied-pmid 18660515?>
        <pub-id pub-id-type="pmid">18660515</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B10">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Harismendy</surname>
          <given-names>O</given-names>
        </name>
        <name>
          <surname>Ng</surname>
          <given-names>PC</given-names>
        </name>
        <name>
          <surname>Strausberg</surname>
          <given-names>RL</given-names>
        </name>
        <name>
          <surname>Wang</surname>
          <given-names>X</given-names>
        </name>
        <name>
          <surname>Stockwell</surname>
          <given-names>TB</given-names>
        </name>
        <name>
          <surname>Beeson</surname>
          <given-names>KY</given-names>
        </name>
        <name>
          <surname>Schork</surname>
          <given-names>NJ</given-names>
        </name>
        <name>
          <surname>Murray</surname>
          <given-names>SS</given-names>
        </name>
        <name>
          <surname>Topol</surname>
          <given-names>EJ</given-names>
        </name>
        <name>
          <surname>Levy</surname>
          <given-names>S</given-names>
        </name>
        <name>
          <surname>Frazer</surname>
          <given-names>KA</given-names>
        </name>
        <article-title>Evaluation of next generation sequencing platforms for population targeted sequencing studies</article-title>
        <source>Genome Biol</source>
        <year>2009</year>
        <volume>15</volume>
        <issue>3</issue>
        <fpage>R32</fpage>
        <pub-id pub-id-type="doi">10.1186/gb-2009-10-3-r32</pub-id>
        <?supplied-pmid 19327155?>
        <pub-id pub-id-type="pmid">19327155</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B11">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Meacham</surname>
          <given-names>F</given-names>
        </name>
        <name>
          <surname>Boffelli</surname>
          <given-names>D</given-names>
        </name>
        <name>
          <surname>Dhahbi</surname>
          <given-names>J</given-names>
        </name>
        <name>
          <surname>Martin</surname>
          <given-names>DI</given-names>
        </name>
        <name>
          <surname>Singer</surname>
          <given-names>M</given-names>
        </name>
        <name>
          <surname>Pachter</surname>
          <given-names>L</given-names>
        </name>
        <article-title>Identification and correction of systematic error in high-throughput sequence data</article-title>
        <source>BMC Bioinformatics</source>
        <year>2011</year>
        <volume>15</volume>
        <fpage>451</fpage>
        <pub-id pub-id-type="doi">10.1186/1471-2105-12-451</pub-id>
        <?supplied-pmid 22099972?>
        <pub-id pub-id-type="pmid">22099972</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B12">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Loman</surname>
          <given-names>NJ</given-names>
        </name>
        <name>
          <surname>Misra</surname>
          <given-names>RV</given-names>
        </name>
        <name>
          <surname>Dallman</surname>
          <given-names>TJ</given-names>
        </name>
        <name>
          <surname>Constantinidou</surname>
          <given-names>C</given-names>
        </name>
        <name>
          <surname>Gharbia</surname>
          <given-names>SE</given-names>
        </name>
        <name>
          <surname>Wain</surname>
          <given-names>J</given-names>
        </name>
        <name>
          <surname>Pallen</surname>
          <given-names>MJ</given-names>
        </name>
        <article-title>Performance comparison of benchtop high-throughput sequencing platforms</article-title>
        <source>Nat Biotechnol</source>
        <year>2012</year>
        <volume>15</volume>
        <issue>5</issue>
        <fpage>434</fpage>
        <lpage>439</lpage>
        <pub-id pub-id-type="doi">10.1038/nbt.2198</pub-id>
        <?supplied-pmid 22522955?>
        <pub-id pub-id-type="pmid">22522955</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B13">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Torok</surname>
          <given-names>ME</given-names>
        </name>
        <name>
          <surname>Peacock</surname>
          <given-names>SJ</given-names>
        </name>
        <article-title>Rapid whole-genome sequencing of bacterial pathogens in the clinical microbiology laboratory–pipe dream or reality?</article-title>
        <source>J Antimicrob Chemother</source>
        <year>2012</year>
        <volume>15</volume>
        <issue>10</issue>
        <fpage>2307</fpage>
        <lpage>2308</lpage>
        <pub-id pub-id-type="doi">10.1093/jac/dks247</pub-id>
        <?supplied-pmid 22729921?>
        <pub-id pub-id-type="pmid">22729921</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B14">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Sherry</surname>
          <given-names>NL</given-names>
        </name>
        <name>
          <surname>Porter</surname>
          <given-names>JL</given-names>
        </name>
        <name>
          <surname>Seemann</surname>
          <given-names>T</given-names>
        </name>
        <name>
          <surname>Watkins</surname>
          <given-names>A</given-names>
        </name>
        <name>
          <surname>Stinear</surname>
          <given-names>TP</given-names>
        </name>
        <name>
          <surname>Howden</surname>
          <given-names>BP</given-names>
        </name>
        <article-title>Outbreak investigation using high-throughput genome sequencing within a diagnostic microbiology laboratory</article-title>
        <source>J Clin Microbiol</source>
        <year>2013</year>
        <volume>15</volume>
        <issue>5</issue>
        <fpage>1396</fpage>
        <lpage>1401</lpage>
        <pub-id pub-id-type="doi">10.1128/JCM.03332-12</pub-id>
        <?supplied-pmid 23408689?>
        <pub-id pub-id-type="pmid">23408689</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B15">
      <mixed-citation publication-type="other">
        <name>
          <surname>Garrison</surname>
          <given-names>E</given-names>
        </name>
        <name>
          <surname>Marth</surname>
          <given-names>G</given-names>
        </name>
        <article-title>Haplotype-based variant detection from short-read sequencing</article-title>
        <source>eprint</source>
        <year>2012</year>
        <comment>(arXiv:1207.3907v2)</comment>
      </mixed-citation>
    </ref>
    <ref id="B16">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Langmead</surname>
          <given-names>B</given-names>
        </name>
        <name>
          <surname>Salzberg</surname>
          <given-names>SL</given-names>
        </name>
        <article-title>Fast gapped-read alignment with Bowtie 2</article-title>
        <source>Nat Methods</source>
        <year>2012</year>
        <volume>15</volume>
        <issue>4</issue>
        <fpage>357</fpage>
        <lpage>359</lpage>
        <pub-id pub-id-type="doi">10.1038/nmeth.1923</pub-id>
        <?supplied-pmid 22388286?>
        <pub-id pub-id-type="pmid">22388286</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B17">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Li</surname>
          <given-names>H</given-names>
        </name>
        <name>
          <surname>Durbin</surname>
          <given-names>R</given-names>
        </name>
        <article-title>Fast and accurate short read alignment with Burrows-Wheeler transform</article-title>
        <source>Bioinformatics</source>
        <year>2009</year>
        <volume>15</volume>
        <issue>14</issue>
        <fpage>1754</fpage>
        <lpage>1760</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btp324</pub-id>
        <?supplied-pmid 19451168?>
        <pub-id pub-id-type="pmid">19451168</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B18">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Li</surname>
          <given-names>H</given-names>
        </name>
        <name>
          <surname>Durbin</surname>
          <given-names>R</given-names>
        </name>
        <article-title>Fast and accurate long-read alignment with Burrows-Wheeler transform</article-title>
        <source>Bioinformatics</source>
        <year>2010</year>
        <volume>15</volume>
        <issue>5</issue>
        <fpage>589</fpage>
        <lpage>595</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btp698</pub-id>
        <?supplied-pmid 20080505?>
        <pub-id pub-id-type="pmid">20080505</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B19">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Wu</surname>
          <given-names>TD</given-names>
        </name>
        <name>
          <surname>Nacu</surname>
          <given-names>S</given-names>
        </name>
        <article-title>Fast and SNP-tolerant detection of complex variants and splicing in short reads</article-title>
        <source>Bioinformatics</source>
        <year>2010</year>
        <volume>15</volume>
        <issue>7</issue>
        <fpage>873</fpage>
        <lpage>881</lpage>
        <comment>[<ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/content/26/7/873.abstract">http://bioinformatics.oxfordjournals.org/content/26/7/873.abstract</ext-link>]</comment>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btq057</pub-id>
        <?supplied-pmid 20147302?>
        <pub-id pub-id-type="pmid">20147302</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B20">
      <mixed-citation publication-type="other">
        <name>
          <surname>Lee</surname>
          <given-names>W</given-names>
        </name>
        <name>
          <surname>Stromberg</surname>
          <given-names>M</given-names>
        </name>
        <name>
          <surname>Ward</surname>
          <given-names>A</given-names>
        </name>
        <name>
          <surname>Stewart</surname>
          <given-names>C</given-names>
        </name>
        <name>
          <surname>Garrison</surname>
          <given-names>E</given-names>
        </name>
        <name>
          <surname>Marth</surname>
          <given-names>G</given-names>
        </name>
        <article-title>MOSAIK: a hash-based algorithm for accurate next-generation sequencing read mapping</article-title>
        <source>eprint arXiv:1309.1149</source>
        <year>2013</year>
        <comment>[<ext-link ext-link-type="uri" xlink:href="http://arxiv.org/abs/1309.1149">http://arxiv.org/abs/1309.1149</ext-link>]</comment>
      </mixed-citation>
    </ref>
    <ref id="B21">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Campagna</surname>
          <given-names>D</given-names>
        </name>
        <name>
          <surname>Albiero</surname>
          <given-names>A</given-names>
        </name>
        <name>
          <surname>Bilardi</surname>
          <given-names>A</given-names>
        </name>
        <name>
          <surname>Caniato</surname>
          <given-names>E</given-names>
        </name>
        <name>
          <surname>Forcato</surname>
          <given-names>C</given-names>
        </name>
        <name>
          <surname>Manavski</surname>
          <given-names>S</given-names>
        </name>
        <name>
          <surname>Vitulo</surname>
          <given-names>N</given-names>
        </name>
        <name>
          <surname>Valle</surname>
          <given-names>G</given-names>
        </name>
        <article-title>PASS: a program to align short sequences</article-title>
        <source>Bioinformatics</source>
        <year>2009</year>
        <volume>15</volume>
        <issue>7</issue>
        <fpage>967</fpage>
        <lpage>968</lpage>
        <comment>[<ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/content/25/7/967.abstract">http://bioinformatics.oxfordjournals.org/content/25/7/967.abstract</ext-link>]</comment>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btp087</pub-id>
        <?supplied-pmid 19218350?>
        <pub-id pub-id-type="pmid">19218350</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B22">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Hoffmann</surname>
          <given-names>S</given-names>
        </name>
        <name>
          <surname>Otto</surname>
          <given-names>C</given-names>
        </name>
        <name>
          <surname>Kurtz</surname>
          <given-names>S</given-names>
        </name>
        <name>
          <surname>Sharma</surname>
          <given-names>CM</given-names>
        </name>
        <name>
          <surname>Khaitovich</surname>
          <given-names>P</given-names>
        </name>
        <name>
          <surname>Vogel</surname>
          <given-names>J</given-names>
        </name>
        <name>
          <surname>Stadler</surname>
          <given-names>PF</given-names>
        </name>
        <name>
          <surname>Hackermuller</surname>
          <given-names>J</given-names>
        </name>
        <article-title>Fast mapping of short sequences with mismatches, insertions and deletions using index structures</article-title>
        <source>PLoS Comput Biol</source>
        <year>2009</year>
        <volume>15</volume>
        <issue>9</issue>
        <fpage>e1000502</fpage>
        <pub-id pub-id-type="doi">10.1371/journal.pcbi.1000502</pub-id>
        <?supplied-pmid 19750212?>
        <pub-id pub-id-type="pmid">19750212</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B23">
      <mixed-citation publication-type="journal">
        <name>
          <surname>David</surname>
          <given-names>M</given-names>
        </name>
        <name>
          <surname>Dzamba</surname>
          <given-names>M</given-names>
        </name>
        <name>
          <surname>Lister</surname>
          <given-names>D</given-names>
        </name>
        <name>
          <surname>Ilie</surname>
          <given-names>L</given-names>
        </name>
        <name>
          <surname>Brudno</surname>
          <given-names>M</given-names>
        </name>
        <article-title>SHRiMP2: sensitive yet practical SHort Read Mapping</article-title>
        <source>Bioinformatics</source>
        <year>2011</year>
        <volume>15</volume>
        <issue>7</issue>
        <fpage>1011</fpage>
        <lpage>1012</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btr046</pub-id>
        <?supplied-pmid 21278192?>
        <pub-id pub-id-type="pmid">21278192</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B24">
      <mixed-citation publication-type="other">
        <name>
          <surname>Zaharia</surname>
          <given-names>M</given-names>
        </name>
        <name>
          <surname>Bolosky</surname>
          <given-names>WJ</given-names>
        </name>
        <name>
          <surname>Curtis</surname>
          <given-names>K</given-names>
        </name>
        <name>
          <surname>Fox</surname>
          <given-names>A</given-names>
        </name>
        <name>
          <surname>Patterson</surname>
          <given-names>DA</given-names>
        </name>
        <name>
          <surname>Shenker</surname>
          <given-names>S</given-names>
        </name>
        <name>
          <surname>Stoica</surname>
          <given-names>I</given-names>
        </name>
        <name>
          <surname>Karp</surname>
          <given-names>RM</given-names>
        </name>
        <name>
          <surname>Sittler</surname>
          <given-names>T</given-names>
        </name>
        <article-title>Faster and more accurate sequence alignment with SNAP</article-title>
        <source>CoRR</source>
        <year>2011</year>
        <fpage>abs/1111.5572</fpage>
      </mixed-citation>
    </ref>
    <ref id="B25">
      <mixed-citation publication-type="other">
        <name>
          <surname>Gontarz</surname>
          <given-names>PM</given-names>
        </name>
        <name>
          <surname>Berger</surname>
          <given-names>J</given-names>
        </name>
        <name>
          <surname>Wong</surname>
          <given-names>CF</given-names>
        </name>
        <article-title>SRmapper: a fast and sensitive genome-hashing alignment tool</article-title>
        <source>Bioinformatics</source>
        <year>2012</year>
        <comment>[<ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/content/early/2012/12/20/bioinformatics.bts712.abstract">http://bioinformatics.oxfordjournals.org/content/early/2012/12/20/bioinformatics.bts712.abstract</ext-link>]</comment>
      </mixed-citation>
    </ref>
    <ref id="B26">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Ning</surname>
          <given-names>Z</given-names>
        </name>
        <name>
          <surname>Cox</surname>
          <given-names>AJ</given-names>
        </name>
        <name>
          <surname>Mullikin</surname>
          <given-names>JC</given-names>
        </name>
        <article-title>SSAHA: a fast search method for large DNA databases</article-title>
        <source>Genome Res</source>
        <year>2001</year>
        <volume>15</volume>
        <issue>10</issue>
        <fpage>1725</fpage>
        <lpage>1729</lpage>
        <pub-id pub-id-type="doi">10.1101/gr.194201</pub-id>
        <?supplied-pmid 11591649?>
        <pub-id pub-id-type="pmid">11591649</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B27">
      <mixed-citation publication-type="other">
        <name>
          <surname>Homer</surname>
          <given-names>N</given-names>
        </name>
        <name>
          <surname>Merriman</surname>
          <given-names>B</given-names>
        </name>
        <article-title>TMAP: the Torrent Mapping Alignment Program</article-title>
        <comment>[<ext-link ext-link-type="uri" xlink:href="https://github.com/iontorrent/TMAP">https://github.com/iontorrent/TMAP</ext-link>]</comment>
      </mixed-citation>
    </ref>
    <ref id="B28">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Henn</surname>
          <given-names>MR</given-names>
        </name>
        <name>
          <surname>Boutwell</surname>
          <given-names>CL</given-names>
        </name>
        <name>
          <surname>Charlebois</surname>
          <given-names>P</given-names>
        </name>
        <name>
          <surname>Lennon</surname>
          <given-names>NJ</given-names>
        </name>
        <name>
          <surname>Power</surname>
          <given-names>KA</given-names>
        </name>
        <name>
          <surname>Macalalad</surname>
          <given-names>AR</given-names>
        </name>
        <name>
          <surname>Berlin</surname>
          <given-names>AM</given-names>
        </name>
        <name>
          <surname>Malboeuf</surname>
          <given-names>CM</given-names>
        </name>
        <name>
          <surname>Ryan</surname>
          <given-names>EM</given-names>
        </name>
        <name>
          <surname>Gnerre</surname>
          <given-names>S</given-names>
        </name>
        <name>
          <surname>Zody</surname>
          <given-names>MC</given-names>
        </name>
        <name>
          <surname>Erlich</surname>
          <given-names>RL</given-names>
        </name>
        <name>
          <surname>Green</surname>
          <given-names>LM</given-names>
        </name>
        <name>
          <surname>Berical</surname>
          <given-names>A</given-names>
        </name>
        <name>
          <surname>Wang</surname>
          <given-names>Y</given-names>
        </name>
        <name>
          <surname>Casali</surname>
          <given-names>M</given-names>
        </name>
        <name>
          <surname>Streeck</surname>
          <given-names>H</given-names>
        </name>
        <name>
          <surname>Bloom</surname>
          <given-names>AK</given-names>
        </name>
        <name>
          <surname>Dudek</surname>
          <given-names>T</given-names>
        </name>
        <name>
          <surname>Tully</surname>
          <given-names>D</given-names>
        </name>
        <name>
          <surname>Newman</surname>
          <given-names>R</given-names>
        </name>
        <name>
          <surname>Axten</surname>
          <given-names>KL</given-names>
        </name>
        <name>
          <surname>Gladden</surname>
          <given-names>AD</given-names>
        </name>
        <name>
          <surname>Battis</surname>
          <given-names>L</given-names>
        </name>
        <name>
          <surname>Kemper</surname>
          <given-names>M</given-names>
        </name>
        <name>
          <surname>Zeng</surname>
          <given-names>Q</given-names>
        </name>
        <name>
          <surname>Shea</surname>
          <given-names>TP</given-names>
        </name>
        <name>
          <surname>Gujja</surname>
          <given-names>S</given-names>
        </name>
        <name>
          <surname>Zedlack</surname>
          <given-names>C</given-names>
        </name>
        <name>
          <surname>Gasser</surname>
          <given-names>O</given-names>
        </name>
        <etal/>
        <article-title>Whole genome deep sequencing of HIV-1 reveals the impact of early minor variants upon immune recognition during acute infection</article-title>
        <source>PLoS Pathog</source>
        <year>2012</year>
        <volume>15</volume>
        <issue>3</issue>
        <fpage>e1002529</fpage>
        <pub-id pub-id-type="doi">10.1371/journal.ppat.1002529</pub-id>
        <?supplied-pmid 22412369?>
        <pub-id pub-id-type="pmid">22412369</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B29">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Liu</surname>
          <given-names>L</given-names>
        </name>
        <name>
          <surname>Li</surname>
          <given-names>Y</given-names>
        </name>
        <name>
          <surname>Li</surname>
          <given-names>S</given-names>
        </name>
        <name>
          <surname>Hu</surname>
          <given-names>N</given-names>
        </name>
        <name>
          <surname>He</surname>
          <given-names>Y</given-names>
        </name>
        <name>
          <surname>Pong</surname>
          <given-names>R</given-names>
        </name>
        <name>
          <surname>Lin</surname>
          <given-names>D</given-names>
        </name>
        <name>
          <surname>Lu</surname>
          <given-names>L</given-names>
        </name>
        <name>
          <surname>Law</surname>
          <given-names>M</given-names>
        </name>
        <article-title>Comparison of next-generation sequencing systems</article-title>
        <source>J Biomed Biotechnol</source>
        <year>2012</year>
        <volume>15</volume>
        <fpage>251364</fpage>
        <?supplied-pmid 22829749?>
        <pub-id pub-id-type="pmid">22829749</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B30">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Quail</surname>
          <given-names>MA</given-names>
        </name>
        <name>
          <surname>Smith</surname>
          <given-names>M</given-names>
        </name>
        <name>
          <surname>Coupland</surname>
          <given-names>P</given-names>
        </name>
        <name>
          <surname>Otto</surname>
          <given-names>TD</given-names>
        </name>
        <name>
          <surname>Harris</surname>
          <given-names>SR</given-names>
        </name>
        <name>
          <surname>Connor</surname>
          <given-names>TR</given-names>
        </name>
        <name>
          <surname>Bertoni</surname>
          <given-names>A</given-names>
        </name>
        <name>
          <surname>Swerdlow</surname>
          <given-names>HP</given-names>
        </name>
        <name>
          <surname>Gu</surname>
          <given-names>Y</given-names>
        </name>
        <article-title>A tale of three next generation sequencing platforms: comparison of Ion Torrent, Pacific Biosciences and Illumina MiSeq sequencers</article-title>
        <source>BMC Genomics</source>
        <year>2012</year>
        <volume>15</volume>
        <fpage>341</fpage>
        <pub-id pub-id-type="doi">10.1186/1471-2164-13-341</pub-id>
        <?supplied-pmid 22827831?>
        <pub-id pub-id-type="pmid">22827831</pub-id>
      </mixed-citation>
    </ref>
  </ref-list>
</back>
<?DTDIdentifier.IdentifierValue http://www.biomedcentral.com/xml/article.dtd?>
<?DTDIdentifier.IdentifierType system?>
<?SourceDTD.DTDName article.dtd?>
<?SourceDTD.Version 1.0?>
<?ConverterInfo.XSLTName bmc2nlmx2.xsl?>
<?ConverterInfo.Version 2?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">BMC Genomics</journal-id>
    <journal-id journal-id-type="iso-abbrev">BMC Genomics</journal-id>
    <journal-title-group>
      <journal-title>BMC Genomics</journal-title>
    </journal-title-group>
    <issn pub-type="epub">1471-2164</issn>
    <publisher>
      <publisher-name>BioMed Central</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">4051166</article-id>
    <article-id pub-id-type="publisher-id">1471-2164-15-264</article-id>
    <article-id pub-id-type="pmid">24708189</article-id>
    <article-id pub-id-type="doi">10.1186/1471-2164-15-264</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Research Article</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Comparison of mapping algorithms used in high-throughput sequencing: application to Ion Torrent data</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author" corresp="yes" id="A1">
        <name>
          <surname>Caboche</surname>
          <given-names>Ségolène</given-names>
        </name>
        <xref ref-type="aff" rid="I1">1</xref>
        <xref ref-type="aff" rid="I4">4</xref>
        <email>segolene.caboche@pasteur-lille.fr</email>
      </contrib>
      <contrib contrib-type="author" id="A2">
        <name>
          <surname>Audebert</surname>
          <given-names>Christophe</given-names>
        </name>
        <xref ref-type="aff" rid="I2">2</xref>
        <xref ref-type="aff" rid="I4">4</xref>
        <email>c.audebert@genesdiffusion.com</email>
      </contrib>
      <contrib contrib-type="author" id="A3">
        <name>
          <surname>Lemoine</surname>
          <given-names>Yves</given-names>
        </name>
        <xref ref-type="aff" rid="I1">1</xref>
        <xref ref-type="aff" rid="I3">3</xref>
        <xref ref-type="aff" rid="I4">4</xref>
        <email>yves.lemoine@pasteur-lille.fr</email>
      </contrib>
      <contrib contrib-type="author" id="A4">
        <name>
          <surname>Hot</surname>
          <given-names>David</given-names>
        </name>
        <xref ref-type="aff" rid="I1">1</xref>
        <xref ref-type="aff" rid="I3">3</xref>
        <xref ref-type="aff" rid="I4">4</xref>
        <email>david.hot@pasteur-lille.fr</email>
      </contrib>
    </contrib-group>
    <aff id="I1"><label>1</label>FRE 3642 Molecular and Cellular Medecine, CNRS, Institut Pasteur de Lille and Univ Lille Nord de France, Lille, France</aff>
    <aff id="I2"><label>2</label>Genes Diffusion, 3595, Route de Tournai, 59501 Douai, France</aff>
    <aff id="I3"><label>3</label>Transcriptomics and Applied Genomics, Center of Infection and Immunity of Lille, Inserm U1019, CNRS UMR8204, Institut Pasteur de Lille, Univ Lille Nord de France, Lille, France</aff>
    <aff id="I4"><label>4</label>PEGASE-Biosciences, Institut Pasteur de Lille, 1 Rue du Professeur Calmette, 59019 Lille, France</aff>
    <pub-date pub-type="collection">
      <year>2014</year>
    </pub-date>
    <pub-date pub-type="epub">
      <day>5</day>
      <month>4</month>
      <year>2014</year>
    </pub-date>
    <volume>15</volume>
    <fpage>264</fpage>
    <lpage>264</lpage>
    <history>
      <date date-type="received">
        <day>13</day>
        <month>11</month>
        <year>2013</year>
      </date>
      <date date-type="accepted">
        <day>1</day>
        <month>4</month>
        <year>2014</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>Copyright © 2014 Caboche et al.; licensee BioMed Central Ltd.</copyright-statement>
      <copyright-year>2014</copyright-year>
      <copyright-holder>Caboche et al.; licensee BioMed Central Ltd.</copyright-holder>
      <license license-type="open-access" xlink:href="http://creativecommons.org/licenses/by/2.0">
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/2.0">http://creativecommons.org/licenses/by/2.0</ext-link>),which permits unrestricted use, distribution, and reproduction in any medium, provided the original work is properly credited. The Creative Commons Public Domain Dedication waiver (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/publicdomain/zero/1.0/">http://creativecommons.org/publicdomain/zero/1.0/</ext-link>) applies to the data made available in this article, unless otherwise stated.</license-p>
      </license>
    </permissions>
    <self-uri xlink:href="http://www.biomedcentral.com/1471-2164/15/264"/>
    <abstract>
      <sec>
        <title>Background</title>
        <p>The rapid evolution in high-throughput sequencing (HTS) technologies has opened up new perspectives in several research fields and led to the production of large volumes of sequence data. A fundamental step in HTS data analysis is the mapping of reads onto reference sequences. Choosing a suitable mapper for a given technology and a given application is a subtle task because of the difficulty of evaluating mapping algorithms.</p>
      </sec>
      <sec>
        <title>Results</title>
        <p>In this paper, we present a benchmark procedure to compare mapping algorithms used in HTS using both real and simulated datasets and considering four evaluation criteria: computational resource and time requirements, robustness of mapping, ability to report positions for reads in repetitive regions, and ability to retrieve true genetic variation positions. To measure robustness, we introduced a new definition for a correctly mapped read taking into account not only the expected start position of the read but also the end position and the number of indels and substitutions. We developed CuReSim, a new read simulator, that is able to generate customized benchmark data for any kind of HTS technology by adjusting parameters to the error types. CuReSim and CuReSimEval, a tool to evaluate the mapping quality of the CuReSim simulated reads, are freely available. We applied our benchmark procedure to evaluate 14 mappers in the context of whole genome sequencing of small genomes with Ion Torrent data for which such a comparison has not yet been established.</p>
      </sec>
      <sec>
        <title>Conclusions</title>
        <p>A benchmark procedure to compare HTS data mappers is introduced with a new definition for the mapping correctness as well as tools to generate simulated reads and evaluate mapping quality. The application of this procedure to Ion Torrent data from the whole genome sequencing of small genomes has allowed us to validate our benchmark procedure and demonstrate that it is helpful for selecting a mapper based on the intended application, questions to be addressed, and the technology used. This benchmark procedure can be used to evaluate existing or in-development mappers as well as to optimize parameters of a chosen mapper for any application and any sequencing platform.</p>
      </sec>
    </abstract>
    <kwd-group>
      <kwd>High-throughput sequencing</kwd>
      <kwd>Mapping algorithms</kwd>
      <kwd>Mapper comparison</kwd>
      <kwd>Read simulator</kwd>
    </kwd-group>
  </article-meta>
</front>
<body>
  <sec>
    <title>Background</title>
    <p>High-throughput sequencing (HTS) technology has recently shown a rapid and impressive development and this has led to the production of gigabases of sequence in a few hours for only a fraction of the former cost [<xref ref-type="bibr" rid="B1">1</xref>]. HTS has produced an explosion of knowledge in genetics and genomics thanks to the development of specific applications such as genome re-sequencing (whole genome sequencing and targeted sequencing). This technological evolution was paralleled by the development of new algorithms to deal with the quantity and the quality of reads produced. A fundamental analysis steps in re-sequencing approaches is the mapping of the reads onto a reference genome. This step, which involves the accurate positioning of reads onto a reference genome sequence, is highly important because it determines the global quality of downstream analyses. The algorithms used for this step are called mappers. Mappers have to be sensitive and accurate and, if possible, fast and not too computationally demanding. They should be able to find the true position of each read on a reference genome and ideally distinguish between technical sequencing errors and natural genetic variations.</p>
    <p>In recent years many mappers have been developed and distributed (more than 60 mappers are listed in [<xref ref-type="bibr" rid="B2">2</xref>]). Two studies [<xref ref-type="bibr" rid="B2">2</xref>,<xref ref-type="bibr" rid="B3">3</xref>] have classified mappers using a wide variety of features that include: the type of data, their application, the sequencing platform, the read length, the allowed error rate, parallel implementation, the ability to deal with multi-mapped reads (<italic>i.e.</italic> reads aligned to multiple locations), the input and output formats, and the available parameters. Mappers have multiplied and so has the range of possible settings. Hence, the growing difficulty in selecting a mapper has been raised in recent studies aimed at evaluating mapper performances through a multiplicity of comparison criteria. Some of these studies have focused on mapper sensitivity (ability to correctly map reads) [<xref ref-type="bibr" rid="B4">4</xref>-<xref ref-type="bibr" rid="B6">6</xref>]. Schbath <italic>et al.</italic> studied the ability of mappers to identify unique versus multi-mapped reads using a well-controlled benchmark containing reads with exactly three mismatches [<xref ref-type="bibr" rid="B7">7</xref>]. Hatem <italic>et al.</italic> introduced a benchmarking suite to analyze mapping tools [<xref ref-type="bibr" rid="B8">8</xref>], which consists of tests that cover input properties and algorithmic features.</p>
    <p>In addition to the difficulty in determining evaluation criteria, choosing an appropriate evaluation method, <italic>i.e.</italic> how to compare mappers according to the evaluation criteria, and using the appropriate metrics, are also problematical. Using real datasets to evaluate mapper performances allows only a rough assessment and classification of mappers by comparing the percentage of mapped reads, but does not reveal the actual accuracy of mappers. Attempts have been made to avoid this pitfall using simulated datasets in which the original read positions are known. Another difficulty lies in the accurate definition of what a correctly mapped read is. The basic definition is to consider a read as correctly mapped if the original location is retrieved [<xref ref-type="bibr" rid="B4">4</xref>]. Ruffalo <italic>et al.</italic> broadened this definition by adding a condition on the quality score, which had to be superior to a given threshold [<xref ref-type="bibr" rid="B5">5</xref>]. In a more recent paper [<xref ref-type="bibr" rid="B8">8</xref>], a new definition was introduced in which a read was considered to be correctly mapped if the mapping criteria were not violated, <italic>i.e.</italic> contained less errors than the threshold parameter set by the user.</p>
    <p>Using simulated data allows numerical values to be obtained and compared between a set of mappers. However, simulated data do not have the same characteristics as real data, even when an error model based on real data is used. Real HTS data present biases [<xref ref-type="bibr" rid="B9">9</xref>] that can be very difficult to simulate. Additionally, the current definition of the mapping correctness based only on the original start location presents some weaknesses: a read can have several correct positions on the reference sequence and sequencing errors or true genetic variations can lead to a better alignment in a genome position different from the original one. Holtgrewe <italic>et al.</italic> introduced the interval definition, rather than the genome position, to describe a read mapping [<xref ref-type="bibr" rid="B6">6</xref>] and used a full-sensitivity algorithm to identify all possible matching intervals within a given error rate range for each read. This method has been implemented in RABEMA (Read Alignment BEnchMArk), a tool that evaluates the result of arbitrary read mappers that support the SAM output format with real and simulated datasets. Our analysis of the published literature on mapper evaluation led us to conclude that for a complete and robust comparison of mappers, real and simulated datasets should be used. Using real datasets avoids simulation biases and gives a real picture of mapper behavior, whereas simulated datasets are benchmarks from which all parameters can be controlled. Additionally, a sound, more complete definition of what constitutes a correctly mapped read needs to be considered (see below).</p>
    <p>In all the previous studies, mapper performance was evaluated using large eukaryotic genomes (mainly the human genome) and, for the most part, short Illumina or Illumina-like reads data were used, except in [<xref ref-type="bibr" rid="B4">4</xref>,<xref ref-type="bibr" rid="B6">6</xref>] where 454 datasets were evaluated with a reduced number of mappers and metrics. The type of sequencing errors and their rate is inherent to the sequencing technology and more precisely to the nucleotide elongation detection methods used. For example, Life Technologies sequencing by oligonucleotide ligation and detection (SOLiD) technology showed a strong bias in its coverage of repetitive elements [<xref ref-type="bibr" rid="B10">10</xref>], whereas the Illumina reversible dye-terminator sequencing technology (HiSeq) mainly caused substitutions [<xref ref-type="bibr" rid="B11">11</xref>]. Pyrosequencing on solid support (454/Roche) and ion semiconductor sequencing technology (Ion Torrent, Life Technologies) produced indel errors associated with homopolymer-regions [<xref ref-type="bibr" rid="B12">12</xref>]. In the published evaluations, the criteria that were tested and the default parameters of the mappers were usually chosen to address or deal with substitution-type errors and are, therefore, less informative for mapping the reads from new technologies like the Ion Torrent platform.</p>
    <p>Furthermore, the analysis of small microbial genomes compared with the analysis of large eukaryotic genomes poses other challenges because microbial genomes contain a wide range of GC content, which is sometimes extreme. Very high or very low GC content means that there is a high probability of encountering homopolymers in a genome sequence and this is known to be a specific problem for pyrosequencing and ion semiconductor sequencers. A recent development in the HTS technologies has made available benchtop sequencers targeted at the quick and inexpensive sequencing of small to moderate-sized genomes, mainly bacteria, viruses, fungi, and parasites. Small microbial genome sequences could be considered to present a simpler, less demanding mapping process compared with the mapping process for larger eukaryotic genomes. However, this is only partially true because the characteristics of small microbial genomes are not the same as those of eukaryotic genomes. The questions of interest are also usually different and, consequently, the expected mapping quality criteria are not exactly the same. Whole genome sequencing or re-sequencing is an important application in the new field of microorganism characterization using HTS. For instance, clinical diagnosis and the epidemiological study of microbial strain circulation will be profoundly remodeled in the near future by the use of HTS, which should, very soon, be used as a characterization approach for pathogens and which will probably slowly replace the present PCR and biochemical based characterization methods [<xref ref-type="bibr" rid="B13">13</xref>,<xref ref-type="bibr" rid="B14">14</xref>]. In this particular context the re-sequencing applications and derived analyses are in the front-line of research and development. The focus includes the sequencing of the entire length of a microbial genome and the analysis of obtained reads by mapping them onto one or several reference strains to identify potential relevant changes in the studied genome. The aim is to accurately identify the gain or loss in genetic elements (genes or parts of genes, prophages, and plasmids) as well as small changes (mutations and indels) to predict a potential new phenotype or a derived new pathogenicity profile. This requirement poses several challenges, the most important of which is the necessity to distinguish true genetic variations from sequencing errors.</p>
    <p>In this paper, we focus on the evaluation of mappers in the context of whole genome sequencing or re-sequencing for small microbial, mainly bacterial genomes. We tested 14 mappers, mostly using their default settings to be in the general context of non-expert users. We selected four criteria to match this context: (i) computational resource and time requirements, (ii) robustness of mapping through the evaluation of precision, recall and F-measure, (iii) ability to report positions for reads in repetitive regions, and (iv) ability to retrieve true genetic variation positions. To evaluate a mapper’s robustness on simulated datasets, we introduced a new definition of a correctly mapped read. In addition to the original start position (<italic>i.e.</italic> the position from which a read is simulated) that was used in most previous studies, the end position as well as the numbers of insertions, deletions, and substitutions in the alignment were also used to classify the mapping of a read as correct. This definition is more stringent than the previous ones because it implies that it is a full-length read alignment and that the error count is correct. Indeed, sequencing errors can mean that the original location of a read is not necessarily the best alignment location. Using mappers tuned to report all possible hits (‘all’ mode) and to accept a higher error rate than the error rate introduced in simulated reads, it should be possible to retrieve the original location in addition to potential equivalent or better hits. With the new definition of a correctly mapped read used in this study, we ensured that the mapper was able to retrieve the expected original alignment despite inevitable sequencing errors in the reads, thereby allowing a true evaluation of the mapper’s robustness.</p>
    <p>The analysis was applied to data generated by the Ion Torrent Personal Genome Machine (PGM), a newly arrived technology dedicated mainly to small genome sequencing, for which mapper performances have not yet been evaluated. Reads from real datasets and artificially simulated reads were used. Simulated reads were generated using a new customizable read simulator, CuReSim, which can generate reads of user-determined lengths with insertions, deletions, and substitutions introduced at a controlled rate and with an adjustable error distribution along the read. CuReSim and CuReSimEval, a script that can be used to evaluate mapping quality, were developed in Java to run on all operating systems (see Section 2 of Additional file <xref ref-type="supplementary-material" rid="S1">1</xref> for more details) and are freely available at <ext-link ext-link-type="uri" xlink:href="http://www.pegase-biosciences.com/tools/curesim/">http://www.pegase-biosciences.com/tools/curesim/</ext-link>. We have shown that in microbial genome sequencing, some mappers, such as segemehl, present higher robustness than others, especially when the number of sequencing errors was high. Other mappers are more robust for other applications that demand other quality criteria. For example, BWASW, SHRiMP2, SMALT, SSAHA2 and TMAP, might perform particularly well for sequencing focused on rare variant discovery because they show a robust discrimination of variations. SMALT can localize most of the positions of reads located in repeated regions. Some mappers, such as Novoalign, SMALT and SRmapper, needed very small memory resources (about 20 MB), while SNAP was very fast and required only about two minutes to process the bigger datasets used in this study. These results emphasize the observation that mapper choice is application dependent and users should carefully consider the targeted aim before choosing a mapper. The evaluation approach presented here, together with the developed tools (CuReSim to generate simulated reads and CuReSimEval to evaluate mapping quality) can be considered as a general method to evaluate existing or in-development mappers and could prove interesting in the evaluation of the performances of mappers for the coming third generation of sequencers that may have yet another type and rate of errors.</p>
  </sec>
  <sec sec-type="results">
    <title>Results</title>
    <sec>
      <title>Computational resource requirement and time measurement</title>
      <p>All mapping processes involve the alignment of millions of reads onto a reference sequence. This is true even for small genome sequencing projects where the small size of the reference sequence is generally compensated by the multiplicity of samples to be analyzed. In clinical microbiology, the time and the computational resources required for the analysis are critical; therefore, 0 these factors also need to be evaluated for the different mappers. All the mappers tested were run with 24 threads (except for Novoalign, SRmapper, and SSAHA2, which can be run with only 1 thread) and the memory consumption and runtime were recorded for three different Ion Torrent datasets RD_100, RD_200, and RD_400. These three datasets contain real single-reads with different mean sizes and are described in Table <xref ref-type="table" rid="T1">1</xref>. The reference genome used was <italic>Escherichia coli str. K-12 substr. DH10B</italic> [GenBank:NC_010473] for the RD_100 and RD_200 datasets and <italic>Escherichia coli str. K-12 substr. MG16655</italic> [GenBank:NC_000913] for the RD_400 dataset. Figure <xref ref-type="fig" rid="F1">1</xref> shows the memory consumption for each mapper for the real datasets when the indexing and mapping steps were considered together. Novoalign, SMALT, and SRmapper needed very low memory resources (about 20 MB). It should be noted that SRmapper was developed to run on a computer with 4 GB of RAM for genomes the size of the human genome, but, in such a case, it can be run only in ‘all-best’ mode and does not allow indels in the mapping. The Novoalign version used in this study was the free academic version that has not been implemented in parallel. A second group comprising Bowtie2, MOSAIK, and segemehl, needed less than 1 GB of RAM, while a third group, BWA, BWASW, and TMAP, needed less than 2 GB of memory. BWA had peak memory usage of 2 GB for RD_100 and of more than 3 GB for the RD_400 dataset. BWA was developed to map short reads of up to 100 bases, which may explain the high peak usage for 400-base reads. SHRiMP2, SNAP, and SSAHA2 required more RAM (about 3 GB) and SSAHA2 needed about 6 GB for the RD_400 dataset. Finally, the GSNAP and PASS mappers were highly memory-consuming; for the RD_400 dataset, GSNAP needed 6 GB of RAM, with a peak usage of 7 GB while PASS needed about 12 GB of RAM with a peak usage of 14 GB. The RAM requirement increased proportionally with the dataset size for half of the mappers tested, while for Bowtie2, BWASW, MOSAIK, Novoalign, SMALT, segemehl, SHRiMP2, and TMAP memory consumption was about the same for all dataset sizes. These experiments revealed that the computational resource requirements varied considerably among the mappers, from a few megabytes to 14 GB.</p>
      <table-wrap position="float" id="T1">
        <label>Table 1</label>
        <caption>
          <p>Main features of the Ion Torrent Personal Genome Machine datasets used in this study</p>
        </caption>
        <table frame="hsides" rules="groups" border="1">
          <colgroup>
            <col align="left"/>
            <col align="center"/>
            <col align="center"/>
            <col align="center"/>
            <col align="center"/>
          </colgroup>
          <thead valign="top">
            <tr>
              <th colspan="5" align="center">
                <bold>Ion Torrent PGM data</bold>
              </th>
            </tr>
          </thead>
          <tbody valign="top">
            <tr>
              <td align="center" valign="bottom">
                <bold>Name</bold>
                <hr/>
              </td>
              <td align="center" valign="bottom">
                <bold>Chip</bold>
                <hr/>
              </td>
              <td align="center" valign="bottom">
                <bold>Number of reads</bold>
                <hr/>
              </td>
              <td align="center" valign="bottom">
                <bold>Mean length</bold>
                <hr/>
              </td>
              <td align="center" valign="bottom">
                <bold>Organism</bold>
                <hr/>
              </td>
            </tr>
            <tr>
              <td align="center" valign="bottom">RD_100<hr/></td>
              <td align="center" valign="bottom">316<hr/></td>
              <td align="center" valign="bottom">1,713,033<hr/></td>
              <td align="center" valign="bottom">111 bp<hr/></td>
              <td align="center" valign="bottom">
                <italic>E. coli K-12 DH10B</italic>
                <hr/>
              </td>
            </tr>
            <tr>
              <td align="center" valign="bottom">RD_200<hr/></td>
              <td align="center" valign="bottom">316<hr/></td>
              <td align="center" valign="bottom">2,176,492<hr/></td>
              <td align="center" valign="bottom">226 bp<hr/></td>
              <td align="center" valign="bottom">
                <italic>E. coli K-12 DH10B</italic>
                <hr/>
              </td>
            </tr>
            <tr>
              <td align="center">RD_400</td>
              <td align="center">318</td>
              <td align="center">6,668,556</td>
              <td align="center">312 bp</td>
              <td align="center">
                <italic>E. coli K-12 MG1655</italic>
              </td>
            </tr>
          </tbody>
        </table>
        <table-wrap-foot>
          <p>The datasets all contain only single-reads with different mean sizes.</p>
        </table-wrap-foot>
      </table-wrap>
      <fig id="F1" position="float">
        <label>Figure 1</label>
        <caption>
          <p><bold>Computational resource requirements for each mapper dealing with real datasets.</bold> Random Access Memory (RAM, in gigabytes) consumption observed for each mapper, for the three real datasets (RD_100, RD_200 and RD_400) is shown. The values are the requirements for when the indexing and mapping steps were considered together. Vertical bars show the mean memory usage and vertical lines represent the peak memory usage. (1) indicates the mappers that report only one read (‘any-best’ mode) and (2) indicates the mappers that can run only in ‘all-best’ mode.</p>
        </caption>
        <graphic xlink:href="1471-2164-15-264-1"/>
      </fig>
      <p>The time required for the sequencing process relies mainly on the biotechnological part of the protocol (from sample preparation to the sequencing run) but the runtime of the mapping step could also constitute a bottleneck for some mappers. Figure <xref ref-type="fig" rid="F2">2</xref> shows runtime measurements for each mapper running with the three real datasets. The mappers had very different runtimes that were not all proportional to the dataset size. SNAP was very quick and needed only about 2 minutes to map the RD_400 dataset. However, this runtime was for the program run in ‘any-best’ mode, which is always quicker than the other modes. SRmapper, SSAHA2, PASS, Bowtie2, TMAP, SMALT, BWASW, SHRiMP2, and MOSAIK needed less than 40 minutes to map the RD_400 dataset and between 1 minute (for Bowtie2 and SMALT) and 6 minutes (for SSAHA2) to map the RD_100 dataset. BWA had quick runtimes of 2 and 7 minutes for the RD_100 and RD_200 datasets, respectively, but was slower with the biggest dataset RD_400 (around 80 minutes), probably because BWA is optimized for short reads. The slowest mappers were Novoalign, GSNAP, and segemehl. The Novoalign version used in this study could only be run with one thread which explains the long runtimes observed in this study (43, 102, and 297 minutes). GSNAP runtimes were 7, 20 and 90 minutes, and segemehl needed 13, 33 and 144 minutes for the RD_100, RD_200, and RD_400 datasets, respectively. For all the mappers, the runtimes for the RD_400 dataset (which contains more reads than the other datasets) were longer. Generally speaking, the more bases in the dataset, the longer was the runtime, although the runtimes ranged from one minute to up to five hours.</p>
      <fig id="F2" position="float">
        <label>Figure 2</label>
        <caption>
          <p><bold>Runtime measurements for each mapper dealing with real datasets.</bold> Runtime measurements are in minutes. The time measurements are the runtimes for when the indexing and mapping steps are considered together. Vertical bars show the user runtime (time elapsed during the experiments) and vertical lines indicate the CPU time. The time axis is in log scale. Each mapper was run with 24 threads (except Novoalign, SRmapper, SSAHA2, which were run with 1 thread). (1) indicates the mappers that report only one read (‘any-best’ mode) and (2) indicates the mappers that can run only in ‘all-best’ mode.</p>
        </caption>
        <graphic xlink:href="1471-2164-15-264-2"/>
      </fig>
    </sec>
    <sec>
      <title>Mapper robustness</title>
      <p>The accuracy of the sequencing technology is usually the criterion of first importance in the choice of a sequencer. Nevertheless, the mappers used to analyze the sequencing data must be able to efficiently take into account the inherent and inevitable raw data errors. A robust mapper will permit compensation for sequencing defects and will contribute to maximizing coverage while limiting noise. To evaluate mapper robustness, one method is to compute metrics (here precision, recall, and F-measure) through a benchmark formed by simulated reads for which their original location in the genome and the number and type of introduced errors are known. We used simulated datasets with varying error rates to compare mapper robustness. To avoid simulation biases, we also studied mapper robustness with RABEMA [<xref ref-type="bibr" rid="B6">6</xref>] using real sub-datasets.</p>
      <p>Figure <xref ref-type="fig" rid="F3">3</xref> shows the F-measure for each mapper with a simulated dataset containing 50,000 reads with a mean length of 200 bases and an error rate that varied from 0 to 4%. F-measure is the harmonic mean of precision and recall (see the Methods section for details). Precision is the fraction of mapped reads that are correctly mapped and recall is the fraction of correctly mapped reads that are retrieved. Additional figures that show the precision and recall values used to compute the F-measure are in Section 3.1 of Additional file <xref ref-type="supplementary-material" rid="S1">1</xref>. Figure <xref ref-type="fig" rid="F3">3</xref> shows that the 14 mappers displayed very different robustness when the error rate increased, even when, overall, the F-measure decreased when the error rate increased. All mappers had F-measures close to 1 when the reads contained no sequencing errors or had low error rates, which meant that they were able to correctly map the whole set of reads. SRmapper, PASS, BWA, SNAP, and GSNAP showed significant decreases in the F-measure when 1.5% and 3% of indels were present in the reads. SRmapper and SNAP used with their default settings do not allow indels in the alignments, which explained the very low F-measure values observed for these two mappers. The low F-measure values for SRmapper and SNAP were attributable to low precision values, whereas for BWA, the low F-measures resulted from low recall values (see Section 3.1 in Additional file <xref ref-type="supplementary-material" rid="S1">1</xref>). Thus, with high error rates, BWA did not map a large number of reads but the mapped reads were correct; whereas, a large number of reads were incorrectly mapped by SRmapper and SNAP (see the figure showing the percentage of mapped reads in Section 3.1 in Additional file <xref ref-type="supplementary-material" rid="S1">1</xref>). The nine other mappers tested showed high F-measure values. Segemehl had a very high F-measure even with high error rates, meaning that it correctly map the major part of the read dataset. MOSAIK, SMALT, SSAHA2, and Novoalign showed peaks in the F-measure values when the dataset contained only indel errors and seemed to better handle one kind of error rather than a combination of substitution and indel errors. SHRiMP2 and Bowtie2, and more significantly TMAP and BWASW, showed a decrease of F-measure values for 1.5 and 3% indel error rates. Most of the tested mappers have been tuned mainly to deal with substitutions, which can explain their changing behaviors. The F-measure variations observed for these nine mappers are mainly the result of precision variations, except for Novoalign for which the recall values decreased at high error rates.</p>
      <fig id="F3" position="float">
        <label>Figure 3</label>
        <caption>
          <p><bold>F-measures with varying error rate for each mapper dealing with simulated datasets.</bold> F-measures are shown for error rates from 0 to 4%. The simulated read datasets consisted of 50,000 reads with a mean length of 200 bases. (1) indicates the mappers that report only one read (‘any-best’ mode) and (2) indicates the mappers that can run only in ‘all-best’ mode.</p>
        </caption>
        <graphic xlink:href="1471-2164-15-264-3"/>
      </fig>
      <p>These experiments were repeated for simulated datasets containing reads with a mean length of 100 and 400 bases (corresponding figures can be found in Section 3.1 in Additional file <xref ref-type="supplementary-material" rid="S1">1</xref>). Overall, the F-measure values were marginally higher for the shortest reads but the mapper behaviors were similar to the behaviors observed with the dataset containing the reads with a mean length of 200 bases. However, differences were observed for BWA and GSNAP for which the F-measures were significantly better for the dataset with the shorter reads. BWA was designed to map reads up to 100 bp long, which explained the better results with short reads. The F-measures for the dataset of reads of 400 bases were lower for all the mappers and a significant decrease was observed for Novoalign, BWA (designed for short reads), and GSNAP. For the reads of 400 bases, Novoalign showed an F-measure close to 0 even when the reads contained no errors. This finding can be explained by the fact that Novoalign truncates reads before alignment (option -<italic>n</italic>). The maximum allowed read length is 300, so all reads longer than this are truncated to 300 before mapping.</p>
      <p>These experiments showed that most of the mappers were less robust when the indel rate increased, probably because most mappers are tuned mainly to deal with substitutions. In the alignment step, the scoring parameters used by the mappers are often those currently used in bioinformatics, <italic>i.e.</italic> from the evolutionary point of view, a substitution is less penalized than an insertion or a deletion. However, in sequencing, mutations do not follow evolutionary rules; rather, they are dependent on the error model of the sequencing technology. The Ion Torrent PGM, for example, is known to introduce more indels than substitutions into homopolymer stretches. Therefore, mapper robustness could probably be improved by modifying the scoring parameters in the alignment step by decreasing the indel penalty. To test this idea, we changed the gap penalty for two mappers, SHRiMP2 and PASS. For SHRiMP2, the gap open and extension penalties were set to match the penalty for substitutions (see the Section 4.1 in Additional file <xref ref-type="supplementary-material" rid="S1">1</xref> for more details). For PASS, a maximum gap of 8 bases was allowed with a gap open and extension penalty of 1. The F-measures that were obtained with the adapted scoring parameters behaved in the same way as previously observed for these two methods, but they were globally better for all error rates than the F-measures obtained with the default parameters (the corresponding figure can be found in Section 4.1 in Additional file <xref ref-type="supplementary-material" rid="S1">1</xref>).</p>
      <p>All the simulated datasets described above contained 2,500 random reads (<italic>i.e.</italic> reads that were generated by choosing randomly a nucleotide for each position), which could not be mapped onto the reference genome. All the mappers, except SMALT and TMAP, returned all the random reads as unmapped. For SMALT and TMAP, the longer the read length the higher the number of mapped random reads. SMALT mapped only a small number of the random reads (less than 10 reads with around 30 matches), whereas TMAP mapped around 10%, 12%, and 16% of the random reads in the 100, 200, and 400 bases datasets, respectively, with around 15 matches. These percentages are not negligible and indicated that the TMAP strategy (used as the default mapper in Ion Torrent analysis suite) was to map a maximum number of reads even if the mapping was not always relevant. The reported alignments for the random reads were short and could be filtered out easily, but for non-expert users these reported hits will add to the complexity of the read mapping task.</p>
      <p>In conclusion, most of the tested mappers were robust with low error rates. Segemehl showed the best F-measures even for datasets with high error rates and for all read lengths considered in this study. MOSAIK, SMALT, SSAHA2, Bowtie2, and SHRiMP2 correctly mapped a major part of the read datasets. The results also showed that to handle Ion Torrent reads, mappers need to allow indels in the alignments, as was clear for all tested mappers except for SRmapper and PASS with their default settings. We also demonstrated that decreasing the gap penalties could improve the mapping results for Ion Torrent data.</p>
      <p>To avoid simulation biases, RABEMA was used to evaluate mapper performances with real datasets.</p>
      <p>In RABEMA, a full-sensitivity algorithm was used to identify all possible matching intervals within a given error rate range for each read and the mapper evaluation was based on a metric called normalized found intervals (NFI), in which each interval for a read contributed 1/<italic>x</italic> points, where <italic>x</italic> is the number of alignments for the read. The number of points was divided by the number of reads and multiplied by 100 to get the percentage. Figure <xref ref-type="fig" rid="F4">4</xref> shows the percentage of NFI for mappers run in the ‘all’ mode with varying error rates. Only 11 mappers were considered because BWASW, SNAP, and SRmapper cannot be run in ‘all’ mode. All the mappers identified between 100% and 95% of the NFI for datasets with no errors. However, for datasets with errors, the NFI fell rapidly to below 10% of NFI for some mappers (PASS, BWA, and GSNAP), while others (TMAP, SSAHA2, SMALT, MOSAIK, and Novoalign) maintained a high NFI percentage for datasets with up to a 4% error rate and finished at between 50 and 20% NFI for an 8% error rate (Novoalign fell rapidly and finished below 10%). Only segemehl, SHRiMP2, and Bowtie2 maintained NFI above 80%, even at an 8% error rate.</p>
      <fig id="F4" position="float">
        <label>Figure 4</label>
        <caption>
          <p><bold>Normalized found intervals with varying error rate for the mappers that can run in ‘all-mode’.</bold> The percentage of normalized found intervals was obtained using RABEMA, with error rates varying from 0 to 8% for the 11 mappers run in ‘all-mode’. Mappers were run with real sub-datasets containing 50,000 reads randomly extracted from the RD_200 dataset. Each point is the mean value of four sub-datasets.</p>
        </caption>
        <graphic xlink:href="1471-2164-15-264-4"/>
      </fig>
      <p>The experiments were repeated with datasets that contained reads 100 and 400 bases long (figures can be found in Section 3.1 in Additional file <xref ref-type="supplementary-material" rid="S1">1</xref>). The ranking and behavior of the 11 mappers were similar to those obtained with datasets containing read lengths of 100, except Novoalign which was significantly better with the shorter reads. For datasets with reads 400 bases long, the behavior of most of the mappers was similar to the behavior observed with 200-base long reads but the NFI percentages were lower. The Novoalign plot with several increases and decreases was atypical and only around 16% of the 400-base reads were mapped, probably because Novoalign trims reads to a maximum length of 300 bases. BWA identified around 100% NFI in the 400-base reads dataset with no errors, while with an error rate of 8% the NFI only fell to 40%. This behavior for BWA was surprising when compared with its behavior in the previous experiments; however, it can be explained by the definition of NFI used by RABEMA. In RABEMA, reads do not have to be aligned over their entire length to be considered as correctly mapped; so, many of the short alignments returned by BWA were classified as correct by RABEMA, which was not the case with our new definition. The analysis of mapper performances on real datasets with RABEMA indicated that Bowtie2, segemehl, and SHRiMP2 were better than the other mappers, even for datasets with high error rates and regardless of the read lengths.</p>
      <p>Similar observations and similar rankings were obtained with the real and simulated datasets. This double strategy built our confidence in the conclusions drawn from these experiments and confirmed that our simulator generated reads that were similar to sequencer generated reads (at least for Ion Torrent generated reads).</p>
    </sec>
    <sec>
      <title>Study of repeats</title>
      <p>The study and analysis of repeated sequences is as important for small microbial genomes, especially for bacterial genomes, as it is for eukaryotic genomes. Repeats in bacterial genomes represent a smaller proportion of the total genomic DNA that they do in eukaryotic genomes, but the repeated elements are usually longer(for example, copies of homologous genes, inserted sequences, and transposons). Mapper behavior when dealing with repetitive regions in a reference genome is, therefore, an important parameter when the DNA repeat regions may also be informative regions. To study the ability of a mapper to report all possible positions for a read in a repeated sequence, we used an artificial genome containing five repeats. In theory, a mapper, in ‘all’ mode, must report 5 hits for each repeat-located read. Figure <xref ref-type="fig" rid="F5">5</xref> shows the percentage of repeat-located reads correctly reported by the mappers with reads of 200 bases, subdivided in classes depending on the number of hits found. For each of the repeat-located reads, the number of locations in a repeat were counted. Note that BWASW and SNAP can report only one hit (‘any-best’ mode) and SRmapper is limited to all-best hits. Most of the mappers were able to map repeat-located reads in at least one repeat (percentages were close to 100%), except for BWA and PASS. Only two mappers (SMALT and GSNAP) retrieved a large proportion (more than 80%) of the 5 hits and four few others (SHRiMP2, MOSAIK, TMAP, and Bowtie2) retrieved an average proportion of the 5 hits (between 70 and 35%). The other mappers performed quite poorly in this task, retrieving only a small percentage or none of the 5 hits. With 100-base and 400-base reads, the mappers gave better and worse global results, respectively, than they did with the 200-base reads (except for TMAP which was less efficient with the 100-base reads than it was with the 200-base reads; see Section 3.2 in Additional file <xref ref-type="supplementary-material" rid="S1">1</xref>). In conclusion, SMALT was very good at retrieving multi-mapped reads whatever the read length, while GSNAP, MOSAIK, and SHRiMP2 also gave correct results. TMAP was better with longer reads and Novoalign was better with shorter reads. Mappers that cannot be run in ‘all-mode’ or that are not able to deal with indels (BWASW, SNAP, PASS, and SRmapper) are not suitable for identifying multi-mapped reads.</p>
      <fig id="F5" position="float">
        <label>Figure 5</label>
        <caption>
          <p><bold>Percentage of repeat-located reads correctly reported by the mappers.</bold> The percentage of reads correctly reported in a repeat is shown for the mappers dealing with simulated reads of 200 bases, subdivided in classes depending on the number of identified hits. (1) indicates mappers that that report only one read (‘any-best’ mode) and (2) indicates the mappers that can run only in ‘all-best’ mode.</p>
        </caption>
        <graphic xlink:href="1471-2164-15-264-5"/>
      </fig>
    </sec>
    <sec>
      <title>Mutation discovery</title>
      <p>Distinguishing between sequencing or mapping errors and true genetic variations is a challenge in variant analysis. Exome sequencing and genome re-sequencing require robust mapping results with as little noise as possible to identify a mutation of interest and to limit false positive mutations. Real reads from <italic>E. coli DH10B</italic> sequencing were mapped onto a genome sequence in which mutations with known positions and types (substitution or indel) had been introduced artificially. FreeBayes software [<xref ref-type="bibr" rid="B15">15</xref>] was used to call variants, and precision and recall values were computed for mutation discovery in a reference genome with varying mutation rates. Figure <xref ref-type="fig" rid="F6">6</xref> shows the precision and recall values obtained for mutation discovery with real datasets containing reads of 200 bases and a theoretical depth of 40<italic>X</italic>. Generally, precision and especially recall decreased when the mutation rate was increased in the reference genome. In all the experiments, the precision values were high, indicating that the mutations predicted by the variant caller from the mapping files were mainly correct for all mappers. Most of the tested mappers presented good precision and recall values for all mutation rates; the exceptions were BWA, Novoalign, PASS and SRmapper. SRmapper and PASS presented lower precision and recall values than all the other mappers mostly because these two mappers do not allow for indels in the alignments, which decreased the precision of the mapping (see the subsection Mapper robustness) and made the variant calling less accurate. The mutation discovery performances of BWA and Novoalign diminished when the mutation rate reached 5%. It should be noted that for these two mappers, the percentage of mapped reads, and therefore the mean depth, was low compared with the percentage of mapped reads for the other mappers (15% for BWA and 50% for Novalign - see the corresponding figure in Section 3.3 in Additional file <xref ref-type="supplementary-material" rid="S1">1</xref>). This reduced number of mapped reads did not permit the accurate detection of mutations in the reference genome. ROC curves were constructed (see the corresponding figures in Section 3.3 in Additional file <xref ref-type="supplementary-material" rid="S1">1</xref>), which confirmed the mutation discovery results that we obtained.</p>
      <fig id="F6" position="float">
        <label>Figure 6</label>
        <caption>
          <p><bold>Precision and recall values for mutation discovery with varying mutation rates in the reference genome.</bold> The real datasets that were used contained reads of 200 bases and had a theoretical depth of 40<italic>X</italic>. The precision (in black) and recall (in gray) values obtained for mutation discovery for each mapper are shown. Top panel: 0.05% mutations in the reference genome; middle panel: 1% mutations in the reference genome; and bottom panel: 5% mutations in the reference genome. (1) indicates the mappers that report only one read (‘any-best’ mode) and (2) indicates the mappers that can run only in ‘all-best’ mode.</p>
        </caption>
        <graphic xlink:href="1471-2164-15-264-6"/>
      </fig>
      <p>The experiments were repeated with simulated datasets (the corresponding figure can be found in Section 3.3 in Additional file <xref ref-type="supplementary-material" rid="S1">1</xref>). The conclusions that were drawn were similar to those obtained with the real datasets; however, the precision and recall values were lower for all mappers. We also performed similar experiments with real and simulated datasets for read lengths of 100 and 400 bases (see Section 3.3 in Additional file <xref ref-type="supplementary-material" rid="S1">1</xref> for corresponding figures). Mapper behavior was similar regardless of the read length, except for BWA and Novoalign. These two mappers showed better values with reads of 100 bases, and showed near zero recall values with reads of 400 bases. These results were not surprising because BWA was designed for short reads and Novoalign truncates reads to a maximum length of 300 bases.</p>
      <p>The behavior of the mappers in variant discovery was coherent with the results obtained in the robustness study and could be deduced from them. For example, SRmapper and BWA show a significant decrease in F-measure values when the error rate increased and similar behavior has been observed when the mutation rate was increased in the reference genomes. Variant discovery is impacted directly by the quality of the mapper alignments, <italic>i.e.</italic> position and type of edit operations (mismatches, insertions and deletions). The definition of a correctly mapped read introduced in this study is more stringent than for previous studies, because it takes into account the correctness of the alignment (length, number, and type of edit operations). These results demonstrated that the method we used to evaluate mapper robustness was efficient.</p>
      <p>For the simulated data, similar behavior was observed for all the mappers and for all datasets but with lower precision and recall values than was observed for the real data. This decrease could be explained by a lower error rate in the real data than in the simulated data. We performed complementary analyses to observe the precision and recall values obtained with lower sequencing error rates (data not shown). When reads were generated without errors, the precision and recall values were close to 1. Precision and recall values were closer to the values obtained for the real dataset values when reads were generated with 0.5% deletions, 0.25% insertions, and 0.25% substitutions, suggesting that the real dataset used here contained less than 2% sequencing errors. These experiments again showed that the data simulated with CuReSim have characteristics that are similar to the real data produced by the Ion Torrent PGM.</p>
      <p>Finally, because we used simulated data, the impact of sequencing depth in mutation discovery could be tested. We used SHRiMP2 because this mapper behaved well in the variant discovery experiments. The same procedure was applied with four different read datasets of 200 bases with mean depths of 20<italic>X</italic>, 80<italic>X</italic>, 160<italic>X</italic>, and 320<italic>X</italic> (results are shown in Table S1 of Section 4.2 in Additional file <xref ref-type="supplementary-material" rid="S1">1</xref>). The precision and recall values were lower with a mean sequencing depth of 20<italic>X</italic> and were equivalent for the other tested sequencing depths. These results showed that a mean sequencing depth of 40<italic>X</italic> was enough to call variations correctly. Increasing the depth of sequencing did not seem to improve the quality of variant calling.</p>
      <p>These experiments showed that most of the tested mappers gave correct results in mutation discovery even when used with their default settings. The only exceptions were the BWA, Novoalign, PASS, and SRmapper mappers. SRmapper and PASS do not allow indels in alignments. These kinds of mappers should be avoided for variant calling analysis.</p>
    </sec>
  </sec>
  <sec sec-type="discussion">
    <title>Discussion</title>
    <p>Here, a benchmark procedure to compare mappers for HTS that can be applied to any sequencing platforms and any applications is described. The different steps involved in this procedure are shown in Figure <xref ref-type="fig" rid="F7">7</xref>. In step 1, a list of mappers is defined. Depending on the sequencing technology and the application, the most appropriate mapper can be selected for use. In step 2, real datasets are collected and simulated datasets are generated before being mapped onto the reference genome. Step 3 is a comparison step based on four criteria: mapper computational resource and time requirements; mapper robustness; mapper behavior with repetitive regions; and mapper mutation discovery ability. The benchmark procedure uses simulated and real datasets to provide the user with a robust method for mapper comparison. The results obtained can be used to answer questions such as: How much RAM is required? How long will it take to map a set of reads? How does the robustness vary in relation to the error rate? How does a mapper deal with multi-mapped reads? Could a mapper be used with a distant reference genome? What is the quality of the reported alignment? Answers to these questions can help users chose a mapper that best fits a particular application and sequencing platform. This procedure could also be used to evaluate performances of a newly developed mapper or to optimize parameters of already existing mappers.</p>
    <fig id="F7" position="float">
      <label>Figure 7</label>
      <caption>
        <p><bold>Benchmark procedure used to compare mappers.</bold> The different steps used to compare mappers are shown. The criteria in the solid ellipses were used with simulated and real data, whereas the criteria in the dotted ellipses were used only with simulated data.</p>
      </caption>
      <graphic xlink:href="1471-2164-15-264-7"/>
    </fig>
    <p>We also presented a new read simulator, CuReSim (Customized Read Simulator), which generates synthetic HTS reads for the major letter-base sequencing platforms. Users can fix the mutation rates, the read lengths, and can generate random reads. Several error distribution modes are available and particular attention was paid to special cases in which several introduced errors in the same read can lower the number of errors because of compensatory changes. CuReSimEval is a complementary tool that evaluates the mapping quality from SAM files produced by aligning CuReSim simulated reads with any mapper. CuReSim and CuReSimEval are freely available at <ext-link ext-link-type="uri" xlink:href="http://www.pegase-biosciences.com/tools/curesim/">http://www.pegase-biosciences.com/tools/curesim/</ext-link>. The CuReSim suite has been developed in Java and is distributed as JAR files to be operating system independent and easy to use by non-expert users.</p>
    <p>We used the CuReSim suite in a mapper comparison with Ion Torrent data applied to small genomes. To obtain a robust evaluation procedure, we introduced a new definition for mapping correctness. This newly introduced definition is more stringent than the previous ones because the end of the alignment and the number of mutations were considered in addition to the start position. The mapper robustness results obtained with the CuReSim suite simulated data matched the results obtained with real datasets and RABEMA, demonstrating that the CuReSim suite simulated reads with characteristics similar to real reads. We performed completely independent experiments to evaluate the mutation discovery ability of the mappers and found that the results obtained for mapper robustness can also be used to predict the mutation discovery ability of the mappers. Variant calling efficiency is directly dependent on the alignment quality obtained by the mapping algorithms. Checking whether a mapped read is in its expected position is not sufficient because the position and number of edit operations in the produced alignment must also be as close as possible to the expected alignment. The sequencing errors in Ion Torrent reads are mainly indels. For mappers that are unable to deal correctly with indels, the resulting alignments, even those at the expected positions, can result in biased mapping that could impact the variant calling results. All our results demonstrated the reliability of our evaluation method.</p>
    <p>Our benchmark procedure was applied to Ion Torrent data from small genome sequencing. Mapping algorithms and previous mapper comparison studies focused mainly on short reads with substitutions (Illumina technology) and on large reference genomes (mainly the human genome). These evaluation studies therefore are poorly informative for mapping new technology sequencer data with different error models. Additionally, some features of bacterial and small genomes, such as possible extreme GC content, make the extrapolation from the previous studies difficult. For example, very high or low GC content percentages create a higher probability of encountering homopolymers in the genome sequence, which can significantly increase the number of indels in homopolymers. Our benchmark procedure for Ion Torrent data with bacterial genomes did not reveal a single best mapper but rather indicated several options depending on the particular application and technology. When only a desktop computer with 4 GB of RAM is available, users can select a mapper that is not highly memory-consuming; for example, Novoalign, SMALT, SRmapper, Bowtie2, MOSAIK, or segemehl. Novoalign, segemehl, and GSNAP require very long runtimes, while SNAP is very fast (around 2 minutes to deal with big datasets). Other mappers had runtimes shorter than 40 minutes for the bigger datasets. Concerning mapper robustness with varying error rates, all mappers manage to correctly map reads when the sequencing error rate was low; however, some mappers were clearly not suitable for use with datasets containing high error rates (PASS, BWA, GSNAP, SNAP, and SRmapper). Segemehl presented good F-measure values with all the tested datasets even at high error rates. MOSAIK, SHRiMP2, and Bowtie2 also gave correct results. SMALT was well fitted to retrieve all hits for repeat-located reads and GSNAP, MOSAIK, and SHRiMP2 also give correct results in this task. One of these mappers is therefore suitable for the identification of unique and non-unique reads, whereas PASS, BWA, BWASW, SNAP, and SRmapper are not. Mapper behavior for mutation discovery with datasets with varying mutation rates using a close but not identical reference genome is of special interest because often only the genome of a closely-related species is available as a reference. Mutation discovery ability is also important when the genomes of two closely-related strains are compared to detect variants or mutated strains, for example. In such cases, mappers need to produce accurate alignments so that true mutations can be detected. All the mappers tested here showed good precision and recall with all tested mutation rates and for all datasets, except BWA, Novoalign, PASS, and SRmapper.</p>
    <p>Our results show that some mappers dealt correctly with the Ion Torrent data although they were not initially designed for this technology. For example, SHRiMP2 which was designed for Illumina, SOLiD, and 454 reads, showed robust results with Ion Torrent data.</p>
    <p>The mapper default parameters were used deliberately in this study to mimic the general case of a non-expert user; therefore, different results could have been obtained with other parameter settings. Even with the default settings, several mappers that can be used with Ion Torrent data were identified. Additionally, we showed that the mapping results could be improved by adapting the parameter settings to the error model, for example, by decreasing the indel penalty with SHRiMP2. For Ion Torrent data, our study demonstrated that to be efficient a mapper had to allow indels in the alignments and that the results were more reliable when the mapping algorithm allowed multi-mapped reads. The mutation discovery experiments showed that a sequencing depth of 40<italic>X</italic> was enough to correctly call variants.</p>
  </sec>
  <sec sec-type="conclusions">
    <title>Conclusions</title>
    <p>All the different applications that arise from HTS technologies need not have the same mapping characteristics. Some applications may require robust mapping that deals with high error rates while others may require the ability to deal with repeats, for example, when re-sequencing is performed for bacterial variant identification aimed at efficiently detecting mutations and indels. Mappers such as SSAHA2, TMAP, SHRiMP2, or Bowtie2 will support the detection of mutations even at high rates and without the necessity for deep sequencing. In other applications, such as amplicon sequencing to study of repeated motifs (such as CRISPR or IS), the ability to map correctly on repeat regions will be essential and a mapper like SMALT, which performs such tasks very well even though its robustness is not among the highest could be used.</p>
    <p>However, for some specific applications, such as the discovery of mutations in viral genomes, mappers such as Bowtie2, segemehl, and SHRiMP2 with strong robustness could be used because accurate mapping of the maximum number of reads, especially the few that bear the mutation, is essential [<xref ref-type="bibr" rid="B28">28</xref>].</p>
    <p>For some applications, it could be better to use a combination of mappers; for example, in pathogen identification, the strain might be unknown. In this case, SNAP can be used to quickly identify a close reference genome among a set of available genomes, then a more robust mapper can be used to identify mutations or unique reads.</p>
    <p>The correct choice of mapper is crucial in HTS data analysis. In this paper, we have presented a benchmark procedure to compare mapping algorithms that are used currently in HTS. Therefore, we introduced a stringent definition of mapping correctness together with a new read simulator, CuReSim, to generate simulated reads with controlled type, rate, and/or distribution of errors along the reads. The read simulator is freely distributed along with a tool to evaluate the mapping quality, CuReSimEval; both are available at <ext-link ext-link-type="uri" xlink:href="http://www.pegase-biosciences.com/tools/curesim/">http://www.pegase-biosciences.com/tools/curesim/</ext-link>. This procedure was applied to small genomes with Ion Torrent data. Our results do not lead to the selection of a unique, omnipotent mapper but rather show that the choice of mapper has to be application and sequencing technology driven. Our study also demonstrates that a combination of several complementary mappers could significantly improve the mapping step in pipelines. Possible combinations should be tested and evaluated using the same approach. The benchmark procedure presented here greatly helps in the choice of a good mapper for a given application and dataset. This procedure could also be used to evaluate a newly developed mapper or to optimize parameters of an already existing one. An optimized solution for read mapping, adapted to sequencing technology and biological applications, will help compensate for HTS defects.</p>
  </sec>
  <sec sec-type="methods">
    <title>Methods</title>
    <sec>
      <title>Mappers</title>
      <p>The mappers used in this study were selected from the list given in [<xref ref-type="bibr" rid="B2">2</xref>]. The mappers that were explicitly indicated as compatible with Ion Torrent data were selected first; namely, Bowtie2, GSNAP, MOSAIK, Novoalign, segemehl, SMALT, SNAP, and TMAP. Reads generated using the Roche 454 technology have features in common with Ion Torrent reads, so the mapper list was extended to include mappers that were compatible with 454 technology; namely, BWA, BWASW, PASS, SHRiMP2, and SSAHA2. Finally, SRmapper, which is not a sequencing-platform specific mapper, was added. Table <xref ref-type="table" rid="T2">2</xref> lists the 14 selected mappers used in this study and their main features. The main differences between them are the algorithmic approaches and the available options. All the selected mappers index the reference genome, and MOSAIK indexes the reference genome and the reads. The Bowtie2, BWA, BWASW, and TMAP algorithms are all based on the Burrows–Wheeler transform, while the algorithms of the other mappers use hash-tables. TMAP is the mapper that is commonly distributed with the Ion Torrent technology. TMAP uses a series of algorithms (BWA, BWASW, SSAHA2, the super-maximal exact matching algorithm, and the Smith–Waterman algorithm) to map data to an indexed reference sequence. Parallel implementation can greatly decrease execution times for almost all mappers. Most mappers can report all the hits with scores higher than a given threshold; this option is often called the ‘all’ mode report. SRmapper can be run only in the ‘all-best’ mode, which means it reports all hits with the best score. BWASW and SNAP can only be run in ‘any-best’ mode, which means they report only one random hit from among the best hits. The selected mappers were run with their default parameters, except those for which the reporting mode was set to ‘all’ mode. The number of threads was fixed to 24 for all the parallel implemented mappers. The command lines that were used for each of the mappers are available in Section 1 in Additional file <xref ref-type="supplementary-material" rid="S1">1</xref>.</p>
      <table-wrap position="float" id="T2">
        <label>Table 2</label>
        <caption>
          <p>Description of mappers used in this study</p>
        </caption>
        <table frame="hsides" rules="groups" border="1">
          <colgroup>
            <col/>
            <col/>
            <col/>
            <col/>
            <col/>
            <col/>
            <col/>
            <col/>
            <col/>
            <col/>
            <col/>
          </colgroup>
          <thead valign="top">
            <tr>
              <th colspan="11" align="center">
                <bold>Features of mappers used in this study</bold>
              </th>
            </tr>
          </thead>
          <tbody valign="top">
            <tr>
              <td align="center" valign="bottom">
                <bold>Name</bold>
                <hr/>
              </td>
              <td align="center" valign="bottom">
                <bold>Version</bold>
                <hr/>
              </td>
              <td align="center" valign="bottom">
                <bold>Algorithm</bold>
                <hr/>
              </td>
              <td align="center" valign="bottom">
                <bold>Mis.</bold>
                <hr/>
              </td>
              <td align="center" valign="bottom">
                <bold>Indels</bold>
                <hr/>
              </td>
              <td align="center" valign="bottom">
                <bold>Gaps</bold>
                <hr/>
              </td>
              <td align="center" valign="bottom">
                <bold>Report</bold>
                <hr/>
              </td>
              <td align="center" valign="bottom">
                <bold>Align.</bold>
                <hr/>
              </td>
              <td align="center" valign="bottom">
                <bold>Parallel</bold>
                <hr/>
              </td>
              <td align="center" valign="bottom">
                <bold>Qual.</bold>
                <hr/>
              </td>
              <td align="center" valign="bottom">
                <bold>Ref.</bold>
                <hr/>
              </td>
            </tr>
            <tr>
              <td align="center" valign="bottom">Bowtie2<hr/></td>
              <td align="center" valign="bottom">2.0.4<hr/></td>
              <td align="center" valign="bottom">BWT<hr/></td>
              <td align="center" valign="bottom">Y<hr/></td>
              <td align="center" valign="bottom">Y<hr/></td>
              <td align="center" valign="bottom">Y<hr/></td>
              <td align="center" valign="bottom">A<hr/></td>
              <td align="center" valign="bottom">G,L<hr/></td>
              <td align="center" valign="bottom">Y<hr/></td>
              <td align="center" valign="bottom">Y<hr/></td>
              <td align="center" valign="bottom">[<xref ref-type="bibr" rid="B16">16</xref>]<hr/></td>
            </tr>
            <tr>
              <td align="center" valign="bottom">BWA<hr/></td>
              <td align="center" valign="bottom">0.6.2<hr/></td>
              <td align="center" valign="bottom">BWT<hr/></td>
              <td align="center" valign="bottom">Y<hr/></td>
              <td align="center" valign="bottom">Y<hr/></td>
              <td align="center" valign="bottom">Y<hr/></td>
              <td align="center" valign="bottom">A<hr/></td>
              <td align="center" valign="bottom">G<hr/></td>
              <td align="center" valign="bottom">Y<hr/></td>
              <td align="center" valign="bottom">Y<hr/></td>
              <td align="center" valign="bottom">[<xref ref-type="bibr" rid="B17">17</xref>]<hr/></td>
            </tr>
            <tr>
              <td align="center" valign="bottom">BWASW<hr/></td>
              <td align="center" valign="bottom">0.6.2<hr/></td>
              <td align="center" valign="bottom">BWT<hr/></td>
              <td align="center" valign="bottom">Y<hr/></td>
              <td align="center" valign="bottom">Y<hr/></td>
              <td align="center" valign="bottom">Y<hr/></td>
              <td align="center" valign="bottom">AnyB<hr/></td>
              <td align="center" valign="bottom">L<hr/></td>
              <td align="center" valign="bottom">Y<hr/></td>
              <td align="center" valign="bottom">Y<hr/></td>
              <td align="center" valign="bottom">[<xref ref-type="bibr" rid="B18">18</xref>]<hr/></td>
            </tr>
            <tr>
              <td align="center" valign="bottom">GSNAP<hr/></td>
              <td align="center" valign="bottom">2012-12-20<hr/></td>
              <td align="center" valign="bottom">HT<hr/></td>
              <td align="center" valign="bottom">Y<hr/></td>
              <td align="center" valign="bottom">Y<hr/></td>
              <td align="center" valign="bottom">Y<hr/></td>
              <td align="center" valign="bottom">A<hr/></td>
              <td align="center" valign="bottom">G,L<hr/></td>
              <td align="center" valign="bottom">Y<hr/></td>
              <td align="center" valign="bottom">N<hr/></td>
              <td align="center" valign="bottom">[<xref ref-type="bibr" rid="B19">19</xref>]<hr/></td>
            </tr>
            <tr>
              <td align="center" valign="bottom">MOSAIK<hr/></td>
              <td align="center" valign="bottom">2.1.73<hr/></td>
              <td align="center" valign="bottom">HTR<hr/></td>
              <td align="center" valign="bottom">Y<hr/></td>
              <td align="center" valign="bottom">Y<hr/></td>
              <td align="center" valign="bottom">Y<hr/></td>
              <td align="center" valign="bottom">A<hr/></td>
              <td align="center" valign="bottom">G<hr/></td>
              <td align="center" valign="bottom">Y<hr/></td>
              <td align="center" valign="bottom">Y<hr/></td>
              <td align="center" valign="bottom">[<xref ref-type="bibr" rid="B20">20</xref>]<hr/></td>
            </tr>
            <tr>
              <td align="center" valign="bottom">Novoalign<hr/></td>
              <td align="center" valign="bottom">2.08.03<hr/></td>
              <td align="center" valign="bottom">HT<hr/></td>
              <td align="center" valign="bottom">Y<hr/></td>
              <td align="center" valign="bottom">Y<hr/></td>
              <td align="center" valign="bottom">Y<hr/></td>
              <td align="center" valign="bottom">A<hr/></td>
              <td align="center" valign="bottom">G<hr/></td>
              <td align="center" valign="bottom">N<hr/></td>
              <td align="center" valign="bottom">Y<hr/></td>
              <td align="center" valign="bottom"> <hr/></td>
            </tr>
            <tr>
              <td align="center" valign="bottom">PASS<hr/></td>
              <td align="center" valign="bottom">2.02<hr/></td>
              <td align="center" valign="bottom">HT<hr/></td>
              <td align="center" valign="bottom">Y<hr/></td>
              <td align="center" valign="bottom">Y<hr/></td>
              <td align="center" valign="bottom">Y<hr/></td>
              <td align="center" valign="bottom">A<hr/></td>
              <td align="center" valign="bottom">G<hr/></td>
              <td align="center" valign="bottom">Y<hr/></td>
              <td align="center" valign="bottom">Y<hr/></td>
              <td align="center" valign="bottom">[<xref ref-type="bibr" rid="B21">21</xref>]<hr/></td>
            </tr>
            <tr>
              <td align="center" valign="bottom">segemehl<hr/></td>
              <td align="center" valign="bottom">0.1.4-380<hr/></td>
              <td align="center" valign="bottom">ESA<hr/></td>
              <td align="center" valign="bottom">Y<hr/></td>
              <td align="center" valign="bottom">Y<hr/></td>
              <td align="center" valign="bottom">Y<hr/></td>
              <td align="center" valign="bottom">A<hr/></td>
              <td align="center" valign="bottom">G<hr/></td>
              <td align="center" valign="bottom">Y<hr/></td>
              <td align="center" valign="bottom">N<hr/></td>
              <td align="center" valign="bottom">[<xref ref-type="bibr" rid="B22">22</xref>]<hr/></td>
            </tr>
            <tr>
              <td align="center" valign="bottom">SHRiMP2<hr/></td>
              <td align="center" valign="bottom">2.2.3<hr/></td>
              <td align="center" valign="bottom">HT<hr/></td>
              <td align="center" valign="bottom">Y<hr/></td>
              <td align="center" valign="bottom">Y<hr/></td>
              <td align="center" valign="bottom">N<hr/></td>
              <td align="center" valign="bottom">A<hr/></td>
              <td align="center" valign="bottom">G<hr/></td>
              <td align="center" valign="bottom">Y<hr/></td>
              <td align="center" valign="bottom">Y<hr/></td>
              <td align="center" valign="bottom">[<xref ref-type="bibr" rid="B23">23</xref>]<hr/></td>
            </tr>
            <tr>
              <td align="center" valign="bottom">SMALT<hr/></td>
              <td align="center" valign="bottom">0.7.0.1<hr/></td>
              <td align="center" valign="bottom">HT<hr/></td>
              <td align="center" valign="bottom">Y<hr/></td>
              <td align="center" valign="bottom">Y<hr/></td>
              <td align="center" valign="bottom">N<hr/></td>
              <td align="center" valign="bottom">A<hr/></td>
              <td align="center" valign="bottom">L<hr/></td>
              <td align="center" valign="bottom">Y<hr/></td>
              <td align="center" valign="bottom">Y<hr/></td>
              <td align="center" valign="bottom"> <hr/></td>
            </tr>
            <tr>
              <td align="center" valign="bottom">SNAP<hr/></td>
              <td align="center" valign="bottom">0.15<hr/></td>
              <td align="center" valign="bottom">HT<hr/></td>
              <td align="center" valign="bottom">Y<hr/></td>
              <td align="center" valign="bottom">Y<hr/></td>
              <td align="center" valign="bottom">Y<hr/></td>
              <td align="center" valign="bottom">AnyB<hr/></td>
              <td align="center" valign="bottom">G,L<hr/></td>
              <td align="center" valign="bottom">Y<hr/></td>
              <td align="center" valign="bottom">Y<hr/></td>
              <td align="center" valign="bottom">[<xref ref-type="bibr" rid="B24">24</xref>]<hr/></td>
            </tr>
            <tr>
              <td align="center" valign="bottom">SRmapper<hr/></td>
              <td align="center" valign="bottom">0.1.1<hr/></td>
              <td align="center" valign="bottom">HT<hr/></td>
              <td align="center" valign="bottom">Y<hr/></td>
              <td align="center" valign="bottom">N<hr/></td>
              <td align="center" valign="bottom">N<hr/></td>
              <td align="center" valign="bottom">AB<hr/></td>
              <td align="center" valign="bottom">G<hr/></td>
              <td align="center" valign="bottom">N<hr/></td>
              <td align="center" valign="bottom">N<hr/></td>
              <td align="center" valign="bottom">[<xref ref-type="bibr" rid="B25">25</xref>]<hr/></td>
            </tr>
            <tr>
              <td align="center" valign="bottom">SSAHA2<hr/></td>
              <td align="center" valign="bottom">2.5.5<hr/></td>
              <td align="center" valign="bottom">HT<hr/></td>
              <td align="center" valign="bottom">Y<hr/></td>
              <td align="center" valign="bottom">Y<hr/></td>
              <td align="center" valign="bottom">N<hr/></td>
              <td align="center" valign="bottom">A<hr/></td>
              <td align="center" valign="bottom">L<hr/></td>
              <td align="center" valign="bottom">N<hr/></td>
              <td align="center" valign="bottom">N<hr/></td>
              <td align="center" valign="bottom">[<xref ref-type="bibr" rid="B26">26</xref>]<hr/></td>
            </tr>
            <tr>
              <td align="center">TMAP</td>
              <td align="center">3.2.2</td>
              <td align="center">BWT</td>
              <td align="center">Y</td>
              <td align="center">Y</td>
              <td align="center">Y</td>
              <td align="center">A</td>
              <td align="center">G,L</td>
              <td align="center">Y</td>
              <td align="center">Y</td>
              <td align="center">[<xref ref-type="bibr" rid="B27">27</xref>]</td>
            </tr>
          </tbody>
        </table>
        <table-wrap-foot>
          <p>The column headed ‘version’ indicates the version of the mapper used in this study; the column headed ‘algorithm’ gives the algorithmic method used in the mapper. BWT, the reference genome was indexed with the Burrows–Wheeler transform; HT, the reference genome was indexed with Hash-Table; HTR, the reference genome and reads were indexed with Hash-Table; and ESA, the reference genome was indexed by enhanced suffix arrays. In the columns headed ‘mis.’ (mismatches), ‘indels’, and ‘gaps’, ‘Y’ indicates the algorithm allows mismatches, indels, and long insertions or deletions, and ‘N’ indicates otherwise. The column headed ‘report’ indicates the available report mode: ‘A’ for ‘all’; ‘AnyB’ for ‘any-best’; and ‘AB’ for ‘all-best’ mode. The column headed ‘align.’ ‘G’ (globally) indicates the reads were aligned end-to-end and ‘L’ locally indicates they were not. In the column headed ‘parallel’, ‘Y’ indicates the algorithm is multi-threaded, and ‘N’ indicates it is not. The column headed ‘qual.’ indicates if sequencing quality is taken into account by the mapper (‘Y’ for yes; ‘N’ for no). Bibliographical references are given in the last column.</p>
        </table-wrap-foot>
      </table-wrap>
    </sec>
    <sec>
      <title>Computational resource requirement and time measurement</title>
      <p>Memory consumption was measured by parsing the output of the Unix command ‘top’ every second. The time measurement was obtained using the Unix command ‘time’. The real time corresponds to the elapsed wall-clock time. CPU time, obtained by adding the user and system times, is the amount of time the CPU was actually executing instructions. All the mappers were run on a PC with a 6-core processor (2.40 GHz) with 24 GB of RAM.</p>
    </sec>
    <sec>
      <title>Datasets</title>
      <p>Real and simulated datasets were used in this study. Three real datasets obtained from the Ion Torrent Community website (<ext-link ext-link-type="uri" xlink:href="http://ioncommunity.lifetechnologies.com/">http://ioncommunity.lifetechnologies.com/</ext-link>) were used. The main features of the real datasets, RD_100, RD_200, and RD_400, are shown in Table <xref ref-type="table" rid="T1">1</xref>. For some experiments, smaller datasets were required; therefore, 50,000 reads were extracted randomly from the real data to generate the smaller datasets. Four files were generated from each dataset and the mean value was computed.</p>
      <p>Simulated data were generated from the complete genome of <italic>Escherichia coli str. K-12 substr. DH10B</italic> [GenBank:NC_010473] using CuReSim. The command lines used for read generation are available in Section 1 in Additional file <xref ref-type="supplementary-material" rid="S1">1</xref>. Three datasets were generated with read lengths specific to Ion Torrent technology: mean lengths of 100 bases, 200 bases, and 400 bases with a standard deviation in length of 10% for each dataset. Ion Torrent technology produces reads with about 1% deletions, 0.5% insertions, and 0.5% substitutions [<xref ref-type="bibr" rid="B12">12</xref>,<xref ref-type="bibr" rid="B29">29</xref>,<xref ref-type="bibr" rid="B30">30</xref>]. Each simulated dataset contained 9 files of 50,000 reads with varying indel and substitution rates: the indel rate varied from 0 to 3% and the substitution rate varied from 0 to 1%. Table <xref ref-type="table" rid="T3">3</xref> shows the 9 files that formed the simulated dataset. Each dataset contained, among the 50,000 reads, 2,500 randomly generated reads.</p>
      <table-wrap position="float" id="T3">
        <label>Table 3</label>
        <caption>
          <p>Simulated datasets used in this study</p>
        </caption>
        <table frame="hsides" rules="groups" border="1">
          <colgroup>
            <col align="left"/>
            <col align="center"/>
            <col align="center"/>
            <col align="center"/>
          </colgroup>
          <thead valign="top">
            <tr>
              <th colspan="4" align="center">
                <bold>Simulated data</bold>
              </th>
            </tr>
          </thead>
          <tbody valign="top">
            <tr>
              <td align="center" valign="bottom">
                <bold>Insertion rate</bold>
                <hr/>
              </td>
              <td align="center" valign="bottom">
                <bold>Deletion rate</bold>
                <hr/>
              </td>
              <td align="center" valign="bottom">
                <bold>Substitution rate</bold>
                <hr/>
              </td>
              <td align="center" valign="bottom">
                <bold>Total error rate</bold>
                <hr/>
              </td>
            </tr>
            <tr>
              <td align="center" valign="bottom">0<hr/></td>
              <td align="center" valign="bottom">0<hr/></td>
              <td align="center" valign="bottom">0<hr/></td>
              <td align="center" valign="bottom">0<hr/></td>
            </tr>
            <tr>
              <td align="center" valign="bottom">0<hr/></td>
              <td align="center" valign="bottom">0<hr/></td>
              <td align="center" valign="bottom">0.5<hr/></td>
              <td align="center" valign="bottom">0.5<hr/></td>
            </tr>
            <tr>
              <td align="center" valign="bottom">0<hr/></td>
              <td align="center" valign="bottom">0<hr/></td>
              <td align="center" valign="bottom">1<hr/></td>
              <td align="center" valign="bottom">1<hr/></td>
            </tr>
            <tr>
              <td align="center" valign="bottom">0.5<hr/></td>
              <td align="center" valign="bottom">1<hr/></td>
              <td align="center" valign="bottom">0<hr/></td>
              <td align="center" valign="bottom">1.5<hr/></td>
            </tr>
            <tr>
              <td align="center" valign="bottom">0.5<hr/></td>
              <td align="center" valign="bottom">1<hr/></td>
              <td align="center" valign="bottom">0.5<hr/></td>
              <td align="center" valign="bottom">2<hr/></td>
            </tr>
            <tr>
              <td align="center" valign="bottom">0.5<hr/></td>
              <td align="center" valign="bottom">1<hr/></td>
              <td align="center" valign="bottom">1<hr/></td>
              <td align="center" valign="bottom">2.5<hr/></td>
            </tr>
            <tr>
              <td align="center" valign="bottom">1<hr/></td>
              <td align="center" valign="bottom">2<hr/></td>
              <td align="center" valign="bottom">0<hr/></td>
              <td align="center" valign="bottom">3<hr/></td>
            </tr>
            <tr>
              <td align="center" valign="bottom">1<hr/></td>
              <td align="center" valign="bottom">2<hr/></td>
              <td align="center" valign="bottom">0.5<hr/></td>
              <td align="center" valign="bottom">3.5<hr/></td>
            </tr>
            <tr>
              <td align="center">1</td>
              <td align="center">2</td>
              <td align="center">1</td>
              <td align="center">4</td>
            </tr>
          </tbody>
        </table>
        <table-wrap-foot>
          <p>The datasets each contained 50,000 reads with varying indel, substitution and error rates. The indel rate varied from 0 to 3%, the substitution rate varied from 0 to 1%, and the total error rate varied from 0 to 4%.</p>
        </table-wrap-foot>
      </table-wrap>
      <p>All the datasets and genomes used in this study can be obtained from the authors upon request.</p>
    </sec>
    <sec>
      <title>Mapper robustness</title>
      <p>To compare the mappers’ robustness, several metrics were computed for the simulated datasets. A read was considered as correctly mapped if among the reported hits at least one hit fitted the following criteria: i) the original start position (<italic>i.e.</italic> the position from which the read is generated) was retrieved, ii) the end position was retrieved, and iii) the alignment produced by the mapper showed exactly the same number of insertions, deletions, and substitutions. Indels in homopolymers at the end of the alignment led to failure to find some correct alignments (the observed start and end positions are not the expected ones). To deal with this special case, a shift for the start and end positions was allowed. The shift gives the number of possible insertions and deletions not considered at the alignment ends. In this case an alignment was considered as correct when the number of insertions (or deletions) in the mapper alignment added to the possible missing insertions (or deletions) was equal to the original number of insertions (or deletions), and the number of substitutions was the same. Figure <xref ref-type="fig" rid="F8">8</xref> shows examples of alignments produced by a mapper in the case of indels in this special case. In the read 1 example, the expected alignment starts in 4031012 and ends in 4031103, with two deletions, no insertions; and one substitution; however, the alignment returned by the mapper starts in 4031014, ends in 4031103, and showed only one substitution. Not considering the special case of indels at the alignment ends would have classified this read as incorrectly mapped. However, with our rules, the shift in start positions allowed one deletion at the start of the alignment, meaning that the read was classified as correctly mapped, which reflects reality. In the read 2 example, a shift permitted the addition of one deletion at the beginning of the alignment. However, the number of substitutions was different between the expected and observed alignments; therefore, the read was classified as incorrectly mapped. A read was considered as incorrectly mapped if no hits fitted the three criteria listed above. A read was considered as unmapped if the read was not identified on the reference genome. Precision and recall values were computed as: <inline-formula><mml:math id="M1" name="1471-2164-15-264-i1" overflow="scroll"><mml:mtext mathvariant="italic">precision</mml:mtext><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mtext mathvariant="italic">TP</mml:mtext></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">TP</mml:mtext><mml:mo>+</mml:mo><mml:mtext mathvariant="italic">FP</mml:mtext></mml:mrow></mml:mfrac></mml:math></inline-formula> and <inline-formula><mml:math id="M2" name="1471-2164-15-264-i2" overflow="scroll"><mml:mtext mathvariant="italic">recall</mml:mtext><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mtext mathvariant="italic">TP</mml:mtext></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">TP</mml:mtext><mml:mo>+</mml:mo><mml:mtext mathvariant="italic">FN</mml:mtext></mml:mrow></mml:mfrac></mml:math></inline-formula> with <italic>TP: true positives</italic> being correctly mapped reads, <italic>FP: false positives</italic> being incorrectly mapped reads, and <italic>FN: false negatives</italic> being unmapped reads. The F-measure combines the precision and recall values and was computed as: <inline-formula><mml:math id="M3" name="1471-2164-15-264-i3" overflow="scroll"><mml:mi>F</mml:mi><mml:mo>-</mml:mo><mml:mtext mathvariant="italic">measure</mml:mtext><mml:mo>=</mml:mo><mml:mn>2</mml:mn><mml:mo>∗</mml:mo><mml:mfrac><mml:mrow><mml:mtext mathvariant="italic">precision</mml:mtext><mml:mo>∗</mml:mo><mml:mtext mathvariant="italic">recall</mml:mtext></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">precision</mml:mtext><mml:mo>+</mml:mo><mml:mtext mathvariant="italic">recall</mml:mtext></mml:mrow></mml:mfrac></mml:math></inline-formula> The script to compute these metrics with simulated datasets produced by CuReSim is freely available.</p>
      <fig id="F8" position="float">
        <label>Figure 8</label>
        <caption>
          <p><bold>Reads identified as correctly and incorrectly mapped.</bold> Two representative alignments of simulated reads (read 1 and read 2). produced by a mapper in the special case of indels in homopolymers at the end of an alignment. In each case, the first alignment is the expected alignment for the simulated read with the correct number of insertions, deletions, and substitutions; the second alignment is the alignment returned by a mapper.</p>
        </caption>
        <graphic xlink:href="1471-2164-15-264-8"/>
      </fig>
      <p>To evaluate the mapper performances on real datasets, the reduced datasets containing 50,000 reads were mapped with each mapper using RABEMA [<xref ref-type="bibr" rid="B6">6</xref>] to obtain the percentage of NFI depending on the error rates. RABEMA was run for all the mappers in ‘all-mode’, except for BWASW, SNAP, and SRmapper for which the ‘all-mode’ is not available.</p>
    </sec>
    <sec>
      <title>Study of repeats</title>
      <p>A 250,000 bp long artificial genome was generated with five repeats of 500 bp and an error rate of 3%. Using CuReSim, we generated from this genome three sets of 50,000 reads with 0.5% insertions, 1% deletions, 0.5% substitutions, and a mean size of 100, 200, and 400 bases with a standard deviation in length of 10%. This artificial genome was used to evaluate the ability of a mapper to retrieve all locations for a read located in a repeat. A total of 479, 465, and 482 reads for the 100, 200, and 400-base datasets, respectively, were located in one of the 5 repetitions. The number of locations corresponding to a repeat was counted for each of the repeat-located reads.</p>
    </sec>
    <sec>
      <title>Mutation discovery</title>
      <p>To evaluate the ability of each mapper to retrieve mutations (<italic>i.e.</italic> true genetic variations within the sample), real and simulated datasets were used with reference genomes in which mutations were introduced artificially at different rates. An in-house script that can take an entire genome as input and return a mutated genome with a given error rate and a file containing the introduced mutations with their type (substitution or indel) and their genome position was used. For the real datasets, three mutated genomes were generated from the complete genome of <italic>Escherichia coli str. K-12 substr. DH10B</italic> with 0.05, 1, and 5% mutations (comprising 90% substitutions and 10% indels). These genomes were used as reference genomes with the real datasets RD_100 and a subset containing 830,000 reads from RD_200. In the same way, three mutated genomes from <italic>Escherichia coli str. K-12 substr. MG16655</italic> [GenBank:NC_000913] were generated to use as reference genomes with a sub-dataset extracted from the RD_400 dataset (595,000 reads). We used sub-datasets for read lengths of 200 and 400 bases to obtain a similar depth of 40<italic>X</italic> for each real dataset. For the simulated dataset, a sub-sequence of 250,000 bp from the <italic>Escherichia coli str. K-12 substr. DH10B</italic> complete genome(from 2,000,001 to 2,250,000) was extracted. From this sub-sequence, we generated three simulated read datasets with CuReSim, with mean lengths of 100, 200, and 400 bp with 10% standard deviation in length and 0.5% insertions, 1% deletions and 0.5% substitutions, and three mutated small genomes with 0.05, 1, and 5% mutations. To obtain a mean depth of about 40<italic>X</italic> for each length set, these 100, 200, and 400 datasets contained 100,000; 50,000, and 25,000 reads respectively. Mutation detection was performed with FreeBayes [<xref ref-type="bibr" rid="B15">15</xref>] version 9.9.2-27 (commit id:5d5b8ac). FreeBayes produces a file in Variant Call Format (VCF) that contains all variations. The VCF file was filtered to keep only the variations with a depth of at least 10 reads and a frequency of at least 80%. The ability of the mappers to detect true genetic variations was evaluated by computing precision and recall as follows: <inline-formula><mml:math id="M4" name="1471-2164-15-264-i4" overflow="scroll"><mml:mtext mathvariant="italic">precision</mml:mtext><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mtext mathvariant="italic">CM</mml:mtext></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">CM</mml:mtext><mml:mo>+</mml:mo><mml:mtext mathvariant="italic">IM</mml:mtext></mml:mrow></mml:mfrac></mml:math></inline-formula> and <inline-formula><mml:math id="M5" name="1471-2164-15-264-i5" overflow="scroll"><mml:mtext mathvariant="italic">recall</mml:mtext><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mtext mathvariant="italic">CM</mml:mtext></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">CM</mml:mtext><mml:mo>+</mml:mo><mml:mtext mathvariant="italic">IM</mml:mtext><mml:mo>+</mml:mo><mml:mtext mathvariant="italic">NM</mml:mtext></mml:mrow></mml:mfrac></mml:math></inline-formula>, where <italic>CM</italic> is correctly identified mutations, <italic>i.e.</italic> same type and same or equivalent position as the introduced mutation, <italic>IM</italic> is incorrectly identified mutation, and <italic>NM</italic> is not-found mutation.</p>
    </sec>
  </sec>
  <sec>
    <title>Competing interests</title>
    <p>The authors declare that they have no competing interests.</p>
  </sec>
  <sec>
    <title>Authors’ contributions</title>
    <p>SC designed the algorithm and wrote the source code, analyzed the project data, and drafted the manuscript. CA and DH supervised the research, carried out the planning and design, contributed to algorithm design and data analysis, and helped to draft the manuscript. YL contributed to the design of the project and to drafting the manuscript. All authors read and approved the final manuscript.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material content-type="local-data" id="S1">
      <caption>
        <title>Additional file 1</title>
        <p><bold>Supplementary material.</bold> This PDF file contains supplementary data for this paper. Section 1 - Command lines used for each of the tested mappers and for read generation. Section 2 - Description of CuReSim, the customizable read simulator, and CuReSimEval, the program to evaluate the mapping quality. Section 3 - additional figures. Section 4 - presents additional experiments.</p>
      </caption>
      <media xlink:href="1471-2164-15-264-S1.PDF">
        <caption>
          <p>Click here for file</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <sec>
    <title>Acknowledgements</title>
    <p>This work was supported by Univ Lille Nord de France, Institut Pasteur de Lille and the Gènes Diffusion company. We thank Gaël Even (Gènes Diffusion) for help on algorithm and computing aspects, and Kristina Keidel, Anne Bouchard, and Raymond Pierce for proofreading the manuscript. We also thank Wan-Ping Lee for help with the MOSAIK algorithm and Erik Garrison for help with FreeBayes and the modifications he made to the program.</p>
  </sec>
  <ref-list>
    <ref id="B1">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Soon</surname>
          <given-names>WW</given-names>
        </name>
        <name>
          <surname>Hariharan</surname>
          <given-names>M</given-names>
        </name>
        <name>
          <surname>Snyder</surname>
          <given-names>MP</given-names>
        </name>
        <article-title>High-throughput sequencing for biology and medicine</article-title>
        <source>Mol Syst Biol</source>
        <year>2013</year>
        <volume>15</volume>
        <issue>640</issue>
        <comment>[<ext-link ext-link-type="uri" xlink:href="http://www.ncbi.nlm.nih.gov/pubmed/23340846">http://www.ncbi.nlm.nih.gov/pubmed/23340846</ext-link>]</comment>
      </mixed-citation>
    </ref>
    <ref id="B2">
      <mixed-citation publication-type="other">
        <name>
          <surname>Fonseca</surname>
          <given-names>NA</given-names>
        </name>
        <name>
          <surname>Rung</surname>
          <given-names>J</given-names>
        </name>
        <name>
          <surname>Brazma</surname>
          <given-names>A</given-names>
        </name>
        <name>
          <surname>Marioni</surname>
          <given-names>JC</given-names>
        </name>
        <article-title>Tools for mapping high-throughput sequencing data</article-title>
        <source>Bioinformatics</source>
        <year>2012</year>
        <comment>[<ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/content/early/2012/10/11/bioinformatics.bts605.abstract">http://bioinformatics.oxfordjournals.org/content/early/2012/10/11/bioinformatics.bts605.abstract</ext-link>]</comment>
      </mixed-citation>
    </ref>
    <ref id="B3">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Li</surname>
          <given-names>H</given-names>
        </name>
        <name>
          <surname>Homer</surname>
          <given-names>N</given-names>
        </name>
        <article-title>A survey of sequence alignment algorithms for next-generation sequencing</article-title>
        <source>Brief Bioinformatics</source>
        <year>2010</year>
        <volume>15</volume>
        <issue>5</issue>
        <fpage>473</fpage>
        <lpage>483</lpage>
        <pub-id pub-id-type="doi">10.1093/bib/bbq015</pub-id>
        <?supplied-pmid 20460430?>
        <pub-id pub-id-type="pmid">20460430</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B4">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Bao</surname>
          <given-names>S</given-names>
        </name>
        <name>
          <surname>Jiang</surname>
          <given-names>R</given-names>
        </name>
        <name>
          <surname>Kwan</surname>
          <given-names>W</given-names>
        </name>
        <name>
          <surname>Wang</surname>
          <given-names>B</given-names>
        </name>
        <name>
          <surname>Ma</surname>
          <given-names>X</given-names>
        </name>
        <name>
          <surname>Song</surname>
          <given-names>YQ</given-names>
        </name>
        <article-title>Evaluation of next-generation sequencing software in mapping and assembly</article-title>
        <source>J Hum Genet</source>
        <year>2011</year>
        <volume>15</volume>
        <issue>6</issue>
        <fpage>406</fpage>
        <lpage>414</lpage>
        <pub-id pub-id-type="doi">10.1038/jhg.2011.43</pub-id>
        <?supplied-pmid 21525877?>
        <pub-id pub-id-type="pmid">21525877</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B5">
      <mixed-citation publication-type="other">
        <name>
          <surname>Ruffalo</surname>
          <given-names>M</given-names>
        </name>
        <name>
          <surname>LaFramboise</surname>
          <given-names>T</given-names>
        </name>
        <name>
          <surname>Koyutürk</surname>
          <given-names>M</given-names>
        </name>
        <article-title>Comparative analysis of algorithms for next-generation sequencing read alignment</article-title>
        <source>Bioinformatics</source>
        <year>2011</year>
        <comment>[<ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/content/27/20/2790">http://bioinformatics.oxfordjournals.org/content/27/20/2790</ext-link>]</comment>
      </mixed-citation>
    </ref>
    <ref id="B6">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Holtgrewe</surname>
          <given-names>M</given-names>
        </name>
        <name>
          <surname>Emde</surname>
          <given-names>AK</given-names>
        </name>
        <name>
          <surname>Weese</surname>
          <given-names>D</given-names>
        </name>
        <name>
          <surname>Reinert</surname>
          <given-names>K</given-names>
        </name>
        <article-title>A novel and well-defined benchmarking method for second generation read mapping</article-title>
        <source>BMC Bioinformatics</source>
        <year>2011</year>
        <volume>15</volume>
        <fpage>210</fpage>
        <comment>[<ext-link ext-link-type="uri" xlink:href="http://www.biomedcentral.com/1471-2105/12/210">http://www.biomedcentral.com/1471-2105/12/210</ext-link>]</comment>
        <pub-id pub-id-type="doi">10.1186/1471-2105-12-210</pub-id>
        <?supplied-pmid 21615913?>
        <pub-id pub-id-type="pmid">21615913</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B7">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Schbath</surname>
          <given-names>S</given-names>
        </name>
        <name>
          <surname>Martin</surname>
          <given-names>V</given-names>
        </name>
        <name>
          <surname>Zytnicki</surname>
          <given-names>M</given-names>
        </name>
        <name>
          <surname>Fayolle</surname>
          <given-names>J</given-names>
        </name>
        <name>
          <surname>Loux</surname>
          <given-names>V</given-names>
        </name>
        <name>
          <surname>Gibrat</surname>
          <given-names>JF</given-names>
        </name>
        <article-title>Mapping reads on a genomic sequence: an algorithmic overview and a practical comparative analysis</article-title>
        <source>J Comput Biol</source>
        <year>2012</year>
        <volume>15</volume>
        <issue>6</issue>
        <fpage>796</fpage>
        <lpage>813</lpage>
        <pub-id pub-id-type="doi">10.1089/cmb.2012.0022</pub-id>
        <?supplied-pmid 22506536?>
        <pub-id pub-id-type="pmid">22506536</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B8">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Hatem</surname>
          <given-names>A</given-names>
        </name>
        <name>
          <surname>Bozdag</surname>
          <given-names>D</given-names>
        </name>
        <name>
          <surname>Toland</surname>
          <given-names>AE</given-names>
        </name>
        <name>
          <surname>Catalyurek</surname>
          <given-names>UV</given-names>
        </name>
        <article-title>Benchmarking short sequence mapping tools</article-title>
        <source>BMC Bioinformatics</source>
        <year>2013</year>
        <volume>15</volume>
        <fpage>184</fpage>
        <pub-id pub-id-type="doi">10.1186/1471-2105-14-184</pub-id>
        <?supplied-pmid 23758764?>
        <pub-id pub-id-type="pmid">23758764</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B9">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Dohm</surname>
          <given-names>JC</given-names>
        </name>
        <name>
          <surname>Lottaz</surname>
          <given-names>C</given-names>
        </name>
        <name>
          <surname>Borodina</surname>
          <given-names>T</given-names>
        </name>
        <name>
          <surname>Himmelbauer</surname>
          <given-names>H</given-names>
        </name>
        <article-title>Substantial biases in ultra-short read data sets from high-throughput DNA sequencing</article-title>
        <source>Nucleic Acids Res</source>
        <year>2008</year>
        <volume>15</volume>
        <issue>16</issue>
        <fpage>e105</fpage>
        <pub-id pub-id-type="doi">10.1093/nar/gkn425</pub-id>
        <?supplied-pmid 18660515?>
        <pub-id pub-id-type="pmid">18660515</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B10">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Harismendy</surname>
          <given-names>O</given-names>
        </name>
        <name>
          <surname>Ng</surname>
          <given-names>PC</given-names>
        </name>
        <name>
          <surname>Strausberg</surname>
          <given-names>RL</given-names>
        </name>
        <name>
          <surname>Wang</surname>
          <given-names>X</given-names>
        </name>
        <name>
          <surname>Stockwell</surname>
          <given-names>TB</given-names>
        </name>
        <name>
          <surname>Beeson</surname>
          <given-names>KY</given-names>
        </name>
        <name>
          <surname>Schork</surname>
          <given-names>NJ</given-names>
        </name>
        <name>
          <surname>Murray</surname>
          <given-names>SS</given-names>
        </name>
        <name>
          <surname>Topol</surname>
          <given-names>EJ</given-names>
        </name>
        <name>
          <surname>Levy</surname>
          <given-names>S</given-names>
        </name>
        <name>
          <surname>Frazer</surname>
          <given-names>KA</given-names>
        </name>
        <article-title>Evaluation of next generation sequencing platforms for population targeted sequencing studies</article-title>
        <source>Genome Biol</source>
        <year>2009</year>
        <volume>15</volume>
        <issue>3</issue>
        <fpage>R32</fpage>
        <pub-id pub-id-type="doi">10.1186/gb-2009-10-3-r32</pub-id>
        <?supplied-pmid 19327155?>
        <pub-id pub-id-type="pmid">19327155</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B11">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Meacham</surname>
          <given-names>F</given-names>
        </name>
        <name>
          <surname>Boffelli</surname>
          <given-names>D</given-names>
        </name>
        <name>
          <surname>Dhahbi</surname>
          <given-names>J</given-names>
        </name>
        <name>
          <surname>Martin</surname>
          <given-names>DI</given-names>
        </name>
        <name>
          <surname>Singer</surname>
          <given-names>M</given-names>
        </name>
        <name>
          <surname>Pachter</surname>
          <given-names>L</given-names>
        </name>
        <article-title>Identification and correction of systematic error in high-throughput sequence data</article-title>
        <source>BMC Bioinformatics</source>
        <year>2011</year>
        <volume>15</volume>
        <fpage>451</fpage>
        <pub-id pub-id-type="doi">10.1186/1471-2105-12-451</pub-id>
        <?supplied-pmid 22099972?>
        <pub-id pub-id-type="pmid">22099972</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B12">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Loman</surname>
          <given-names>NJ</given-names>
        </name>
        <name>
          <surname>Misra</surname>
          <given-names>RV</given-names>
        </name>
        <name>
          <surname>Dallman</surname>
          <given-names>TJ</given-names>
        </name>
        <name>
          <surname>Constantinidou</surname>
          <given-names>C</given-names>
        </name>
        <name>
          <surname>Gharbia</surname>
          <given-names>SE</given-names>
        </name>
        <name>
          <surname>Wain</surname>
          <given-names>J</given-names>
        </name>
        <name>
          <surname>Pallen</surname>
          <given-names>MJ</given-names>
        </name>
        <article-title>Performance comparison of benchtop high-throughput sequencing platforms</article-title>
        <source>Nat Biotechnol</source>
        <year>2012</year>
        <volume>15</volume>
        <issue>5</issue>
        <fpage>434</fpage>
        <lpage>439</lpage>
        <pub-id pub-id-type="doi">10.1038/nbt.2198</pub-id>
        <?supplied-pmid 22522955?>
        <pub-id pub-id-type="pmid">22522955</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B13">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Torok</surname>
          <given-names>ME</given-names>
        </name>
        <name>
          <surname>Peacock</surname>
          <given-names>SJ</given-names>
        </name>
        <article-title>Rapid whole-genome sequencing of bacterial pathogens in the clinical microbiology laboratory–pipe dream or reality?</article-title>
        <source>J Antimicrob Chemother</source>
        <year>2012</year>
        <volume>15</volume>
        <issue>10</issue>
        <fpage>2307</fpage>
        <lpage>2308</lpage>
        <pub-id pub-id-type="doi">10.1093/jac/dks247</pub-id>
        <?supplied-pmid 22729921?>
        <pub-id pub-id-type="pmid">22729921</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B14">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Sherry</surname>
          <given-names>NL</given-names>
        </name>
        <name>
          <surname>Porter</surname>
          <given-names>JL</given-names>
        </name>
        <name>
          <surname>Seemann</surname>
          <given-names>T</given-names>
        </name>
        <name>
          <surname>Watkins</surname>
          <given-names>A</given-names>
        </name>
        <name>
          <surname>Stinear</surname>
          <given-names>TP</given-names>
        </name>
        <name>
          <surname>Howden</surname>
          <given-names>BP</given-names>
        </name>
        <article-title>Outbreak investigation using high-throughput genome sequencing within a diagnostic microbiology laboratory</article-title>
        <source>J Clin Microbiol</source>
        <year>2013</year>
        <volume>15</volume>
        <issue>5</issue>
        <fpage>1396</fpage>
        <lpage>1401</lpage>
        <pub-id pub-id-type="doi">10.1128/JCM.03332-12</pub-id>
        <?supplied-pmid 23408689?>
        <pub-id pub-id-type="pmid">23408689</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B15">
      <mixed-citation publication-type="other">
        <name>
          <surname>Garrison</surname>
          <given-names>E</given-names>
        </name>
        <name>
          <surname>Marth</surname>
          <given-names>G</given-names>
        </name>
        <article-title>Haplotype-based variant detection from short-read sequencing</article-title>
        <source>eprint</source>
        <year>2012</year>
        <comment>(arXiv:1207.3907v2)</comment>
      </mixed-citation>
    </ref>
    <ref id="B16">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Langmead</surname>
          <given-names>B</given-names>
        </name>
        <name>
          <surname>Salzberg</surname>
          <given-names>SL</given-names>
        </name>
        <article-title>Fast gapped-read alignment with Bowtie 2</article-title>
        <source>Nat Methods</source>
        <year>2012</year>
        <volume>15</volume>
        <issue>4</issue>
        <fpage>357</fpage>
        <lpage>359</lpage>
        <pub-id pub-id-type="doi">10.1038/nmeth.1923</pub-id>
        <?supplied-pmid 22388286?>
        <pub-id pub-id-type="pmid">22388286</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B17">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Li</surname>
          <given-names>H</given-names>
        </name>
        <name>
          <surname>Durbin</surname>
          <given-names>R</given-names>
        </name>
        <article-title>Fast and accurate short read alignment with Burrows-Wheeler transform</article-title>
        <source>Bioinformatics</source>
        <year>2009</year>
        <volume>15</volume>
        <issue>14</issue>
        <fpage>1754</fpage>
        <lpage>1760</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btp324</pub-id>
        <?supplied-pmid 19451168?>
        <pub-id pub-id-type="pmid">19451168</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B18">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Li</surname>
          <given-names>H</given-names>
        </name>
        <name>
          <surname>Durbin</surname>
          <given-names>R</given-names>
        </name>
        <article-title>Fast and accurate long-read alignment with Burrows-Wheeler transform</article-title>
        <source>Bioinformatics</source>
        <year>2010</year>
        <volume>15</volume>
        <issue>5</issue>
        <fpage>589</fpage>
        <lpage>595</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btp698</pub-id>
        <?supplied-pmid 20080505?>
        <pub-id pub-id-type="pmid">20080505</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B19">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Wu</surname>
          <given-names>TD</given-names>
        </name>
        <name>
          <surname>Nacu</surname>
          <given-names>S</given-names>
        </name>
        <article-title>Fast and SNP-tolerant detection of complex variants and splicing in short reads</article-title>
        <source>Bioinformatics</source>
        <year>2010</year>
        <volume>15</volume>
        <issue>7</issue>
        <fpage>873</fpage>
        <lpage>881</lpage>
        <comment>[<ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/content/26/7/873.abstract">http://bioinformatics.oxfordjournals.org/content/26/7/873.abstract</ext-link>]</comment>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btq057</pub-id>
        <?supplied-pmid 20147302?>
        <pub-id pub-id-type="pmid">20147302</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B20">
      <mixed-citation publication-type="other">
        <name>
          <surname>Lee</surname>
          <given-names>W</given-names>
        </name>
        <name>
          <surname>Stromberg</surname>
          <given-names>M</given-names>
        </name>
        <name>
          <surname>Ward</surname>
          <given-names>A</given-names>
        </name>
        <name>
          <surname>Stewart</surname>
          <given-names>C</given-names>
        </name>
        <name>
          <surname>Garrison</surname>
          <given-names>E</given-names>
        </name>
        <name>
          <surname>Marth</surname>
          <given-names>G</given-names>
        </name>
        <article-title>MOSAIK: a hash-based algorithm for accurate next-generation sequencing read mapping</article-title>
        <source>eprint arXiv:1309.1149</source>
        <year>2013</year>
        <comment>[<ext-link ext-link-type="uri" xlink:href="http://arxiv.org/abs/1309.1149">http://arxiv.org/abs/1309.1149</ext-link>]</comment>
      </mixed-citation>
    </ref>
    <ref id="B21">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Campagna</surname>
          <given-names>D</given-names>
        </name>
        <name>
          <surname>Albiero</surname>
          <given-names>A</given-names>
        </name>
        <name>
          <surname>Bilardi</surname>
          <given-names>A</given-names>
        </name>
        <name>
          <surname>Caniato</surname>
          <given-names>E</given-names>
        </name>
        <name>
          <surname>Forcato</surname>
          <given-names>C</given-names>
        </name>
        <name>
          <surname>Manavski</surname>
          <given-names>S</given-names>
        </name>
        <name>
          <surname>Vitulo</surname>
          <given-names>N</given-names>
        </name>
        <name>
          <surname>Valle</surname>
          <given-names>G</given-names>
        </name>
        <article-title>PASS: a program to align short sequences</article-title>
        <source>Bioinformatics</source>
        <year>2009</year>
        <volume>15</volume>
        <issue>7</issue>
        <fpage>967</fpage>
        <lpage>968</lpage>
        <comment>[<ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/content/25/7/967.abstract">http://bioinformatics.oxfordjournals.org/content/25/7/967.abstract</ext-link>]</comment>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btp087</pub-id>
        <?supplied-pmid 19218350?>
        <pub-id pub-id-type="pmid">19218350</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B22">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Hoffmann</surname>
          <given-names>S</given-names>
        </name>
        <name>
          <surname>Otto</surname>
          <given-names>C</given-names>
        </name>
        <name>
          <surname>Kurtz</surname>
          <given-names>S</given-names>
        </name>
        <name>
          <surname>Sharma</surname>
          <given-names>CM</given-names>
        </name>
        <name>
          <surname>Khaitovich</surname>
          <given-names>P</given-names>
        </name>
        <name>
          <surname>Vogel</surname>
          <given-names>J</given-names>
        </name>
        <name>
          <surname>Stadler</surname>
          <given-names>PF</given-names>
        </name>
        <name>
          <surname>Hackermuller</surname>
          <given-names>J</given-names>
        </name>
        <article-title>Fast mapping of short sequences with mismatches, insertions and deletions using index structures</article-title>
        <source>PLoS Comput Biol</source>
        <year>2009</year>
        <volume>15</volume>
        <issue>9</issue>
        <fpage>e1000502</fpage>
        <pub-id pub-id-type="doi">10.1371/journal.pcbi.1000502</pub-id>
        <?supplied-pmid 19750212?>
        <pub-id pub-id-type="pmid">19750212</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B23">
      <mixed-citation publication-type="journal">
        <name>
          <surname>David</surname>
          <given-names>M</given-names>
        </name>
        <name>
          <surname>Dzamba</surname>
          <given-names>M</given-names>
        </name>
        <name>
          <surname>Lister</surname>
          <given-names>D</given-names>
        </name>
        <name>
          <surname>Ilie</surname>
          <given-names>L</given-names>
        </name>
        <name>
          <surname>Brudno</surname>
          <given-names>M</given-names>
        </name>
        <article-title>SHRiMP2: sensitive yet practical SHort Read Mapping</article-title>
        <source>Bioinformatics</source>
        <year>2011</year>
        <volume>15</volume>
        <issue>7</issue>
        <fpage>1011</fpage>
        <lpage>1012</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btr046</pub-id>
        <?supplied-pmid 21278192?>
        <pub-id pub-id-type="pmid">21278192</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B24">
      <mixed-citation publication-type="other">
        <name>
          <surname>Zaharia</surname>
          <given-names>M</given-names>
        </name>
        <name>
          <surname>Bolosky</surname>
          <given-names>WJ</given-names>
        </name>
        <name>
          <surname>Curtis</surname>
          <given-names>K</given-names>
        </name>
        <name>
          <surname>Fox</surname>
          <given-names>A</given-names>
        </name>
        <name>
          <surname>Patterson</surname>
          <given-names>DA</given-names>
        </name>
        <name>
          <surname>Shenker</surname>
          <given-names>S</given-names>
        </name>
        <name>
          <surname>Stoica</surname>
          <given-names>I</given-names>
        </name>
        <name>
          <surname>Karp</surname>
          <given-names>RM</given-names>
        </name>
        <name>
          <surname>Sittler</surname>
          <given-names>T</given-names>
        </name>
        <article-title>Faster and more accurate sequence alignment with SNAP</article-title>
        <source>CoRR</source>
        <year>2011</year>
        <fpage>abs/1111.5572</fpage>
      </mixed-citation>
    </ref>
    <ref id="B25">
      <mixed-citation publication-type="other">
        <name>
          <surname>Gontarz</surname>
          <given-names>PM</given-names>
        </name>
        <name>
          <surname>Berger</surname>
          <given-names>J</given-names>
        </name>
        <name>
          <surname>Wong</surname>
          <given-names>CF</given-names>
        </name>
        <article-title>SRmapper: a fast and sensitive genome-hashing alignment tool</article-title>
        <source>Bioinformatics</source>
        <year>2012</year>
        <comment>[<ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/content/early/2012/12/20/bioinformatics.bts712.abstract">http://bioinformatics.oxfordjournals.org/content/early/2012/12/20/bioinformatics.bts712.abstract</ext-link>]</comment>
      </mixed-citation>
    </ref>
    <ref id="B26">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Ning</surname>
          <given-names>Z</given-names>
        </name>
        <name>
          <surname>Cox</surname>
          <given-names>AJ</given-names>
        </name>
        <name>
          <surname>Mullikin</surname>
          <given-names>JC</given-names>
        </name>
        <article-title>SSAHA: a fast search method for large DNA databases</article-title>
        <source>Genome Res</source>
        <year>2001</year>
        <volume>15</volume>
        <issue>10</issue>
        <fpage>1725</fpage>
        <lpage>1729</lpage>
        <pub-id pub-id-type="doi">10.1101/gr.194201</pub-id>
        <?supplied-pmid 11591649?>
        <pub-id pub-id-type="pmid">11591649</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B27">
      <mixed-citation publication-type="other">
        <name>
          <surname>Homer</surname>
          <given-names>N</given-names>
        </name>
        <name>
          <surname>Merriman</surname>
          <given-names>B</given-names>
        </name>
        <article-title>TMAP: the Torrent Mapping Alignment Program</article-title>
        <comment>[<ext-link ext-link-type="uri" xlink:href="https://github.com/iontorrent/TMAP">https://github.com/iontorrent/TMAP</ext-link>]</comment>
      </mixed-citation>
    </ref>
    <ref id="B28">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Henn</surname>
          <given-names>MR</given-names>
        </name>
        <name>
          <surname>Boutwell</surname>
          <given-names>CL</given-names>
        </name>
        <name>
          <surname>Charlebois</surname>
          <given-names>P</given-names>
        </name>
        <name>
          <surname>Lennon</surname>
          <given-names>NJ</given-names>
        </name>
        <name>
          <surname>Power</surname>
          <given-names>KA</given-names>
        </name>
        <name>
          <surname>Macalalad</surname>
          <given-names>AR</given-names>
        </name>
        <name>
          <surname>Berlin</surname>
          <given-names>AM</given-names>
        </name>
        <name>
          <surname>Malboeuf</surname>
          <given-names>CM</given-names>
        </name>
        <name>
          <surname>Ryan</surname>
          <given-names>EM</given-names>
        </name>
        <name>
          <surname>Gnerre</surname>
          <given-names>S</given-names>
        </name>
        <name>
          <surname>Zody</surname>
          <given-names>MC</given-names>
        </name>
        <name>
          <surname>Erlich</surname>
          <given-names>RL</given-names>
        </name>
        <name>
          <surname>Green</surname>
          <given-names>LM</given-names>
        </name>
        <name>
          <surname>Berical</surname>
          <given-names>A</given-names>
        </name>
        <name>
          <surname>Wang</surname>
          <given-names>Y</given-names>
        </name>
        <name>
          <surname>Casali</surname>
          <given-names>M</given-names>
        </name>
        <name>
          <surname>Streeck</surname>
          <given-names>H</given-names>
        </name>
        <name>
          <surname>Bloom</surname>
          <given-names>AK</given-names>
        </name>
        <name>
          <surname>Dudek</surname>
          <given-names>T</given-names>
        </name>
        <name>
          <surname>Tully</surname>
          <given-names>D</given-names>
        </name>
        <name>
          <surname>Newman</surname>
          <given-names>R</given-names>
        </name>
        <name>
          <surname>Axten</surname>
          <given-names>KL</given-names>
        </name>
        <name>
          <surname>Gladden</surname>
          <given-names>AD</given-names>
        </name>
        <name>
          <surname>Battis</surname>
          <given-names>L</given-names>
        </name>
        <name>
          <surname>Kemper</surname>
          <given-names>M</given-names>
        </name>
        <name>
          <surname>Zeng</surname>
          <given-names>Q</given-names>
        </name>
        <name>
          <surname>Shea</surname>
          <given-names>TP</given-names>
        </name>
        <name>
          <surname>Gujja</surname>
          <given-names>S</given-names>
        </name>
        <name>
          <surname>Zedlack</surname>
          <given-names>C</given-names>
        </name>
        <name>
          <surname>Gasser</surname>
          <given-names>O</given-names>
        </name>
        <etal/>
        <article-title>Whole genome deep sequencing of HIV-1 reveals the impact of early minor variants upon immune recognition during acute infection</article-title>
        <source>PLoS Pathog</source>
        <year>2012</year>
        <volume>15</volume>
        <issue>3</issue>
        <fpage>e1002529</fpage>
        <pub-id pub-id-type="doi">10.1371/journal.ppat.1002529</pub-id>
        <?supplied-pmid 22412369?>
        <pub-id pub-id-type="pmid">22412369</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B29">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Liu</surname>
          <given-names>L</given-names>
        </name>
        <name>
          <surname>Li</surname>
          <given-names>Y</given-names>
        </name>
        <name>
          <surname>Li</surname>
          <given-names>S</given-names>
        </name>
        <name>
          <surname>Hu</surname>
          <given-names>N</given-names>
        </name>
        <name>
          <surname>He</surname>
          <given-names>Y</given-names>
        </name>
        <name>
          <surname>Pong</surname>
          <given-names>R</given-names>
        </name>
        <name>
          <surname>Lin</surname>
          <given-names>D</given-names>
        </name>
        <name>
          <surname>Lu</surname>
          <given-names>L</given-names>
        </name>
        <name>
          <surname>Law</surname>
          <given-names>M</given-names>
        </name>
        <article-title>Comparison of next-generation sequencing systems</article-title>
        <source>J Biomed Biotechnol</source>
        <year>2012</year>
        <volume>15</volume>
        <fpage>251364</fpage>
        <?supplied-pmid 22829749?>
        <pub-id pub-id-type="pmid">22829749</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B30">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Quail</surname>
          <given-names>MA</given-names>
        </name>
        <name>
          <surname>Smith</surname>
          <given-names>M</given-names>
        </name>
        <name>
          <surname>Coupland</surname>
          <given-names>P</given-names>
        </name>
        <name>
          <surname>Otto</surname>
          <given-names>TD</given-names>
        </name>
        <name>
          <surname>Harris</surname>
          <given-names>SR</given-names>
        </name>
        <name>
          <surname>Connor</surname>
          <given-names>TR</given-names>
        </name>
        <name>
          <surname>Bertoni</surname>
          <given-names>A</given-names>
        </name>
        <name>
          <surname>Swerdlow</surname>
          <given-names>HP</given-names>
        </name>
        <name>
          <surname>Gu</surname>
          <given-names>Y</given-names>
        </name>
        <article-title>A tale of three next generation sequencing platforms: comparison of Ion Torrent, Pacific Biosciences and Illumina MiSeq sequencers</article-title>
        <source>BMC Genomics</source>
        <year>2012</year>
        <volume>15</volume>
        <fpage>341</fpage>
        <pub-id pub-id-type="doi">10.1186/1471-2164-13-341</pub-id>
        <?supplied-pmid 22827831?>
        <pub-id pub-id-type="pmid">22827831</pub-id>
      </mixed-citation>
    </ref>
  </ref-list>
</back>
