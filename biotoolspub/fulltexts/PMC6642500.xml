<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName A++V2.4.dtd?>
<?SourceDTD.Version 2.4?>
<?ConverterInfo.XSLTName springer2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Algorithms Mol Biol</journal-id>
    <journal-id journal-id-type="iso-abbrev">Algorithms Mol Biol</journal-id>
    <journal-title-group>
      <journal-title>Algorithms for Molecular Biology : AMB</journal-title>
    </journal-title-group>
    <issn pub-type="epub">1748-7188</issn>
    <publisher>
      <publisher-name>BioMed Central</publisher-name>
      <publisher-loc>London</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">6642500</article-id>
    <article-id pub-id-type="publisher-id">151</article-id>
    <article-id pub-id-type="doi">10.1186/s13015-019-0151-x</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Research</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Statistically consistent divide-and-conquer pipelines for phylogeny estimation using NJMerge</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid">https://orcid.org/0000-0001-5553-3312</contrib-id>
        <name>
          <surname>Molloy</surname>
          <given-names>Erin K.</given-names>
        </name>
        <address>
          <email>emolloy2@illinois.edu</email>
        </address>
        <xref ref-type="aff" rid="Aff1"/>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0001-7717-3514</contrib-id>
        <name>
          <surname>Warnow</surname>
          <given-names>Tandy</given-names>
        </name>
        <address>
          <email>warnow@illinois.edu</email>
        </address>
        <xref ref-type="aff" rid="Aff1"/>
      </contrib>
      <aff id="Aff1"><institution-wrap><institution-id institution-id-type="ISNI">0000 0004 1936 9991</institution-id><institution-id institution-id-type="GRID">grid.35403.31</institution-id><institution>Department of Computer Science, </institution><institution>University of Illinois at Urbana-Champaign, </institution></institution-wrap>201 North Goodwin Avenue, Urbana, IL 61801 USA </aff>
    </contrib-group>
    <pub-date pub-type="epub">
      <day>19</day>
      <month>7</month>
      <year>2019</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>19</day>
      <month>7</month>
      <year>2019</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2019</year>
    </pub-date>
    <volume>14</volume>
    <elocation-id>14</elocation-id>
    <history>
      <date date-type="received">
        <day>5</day>
        <month>5</month>
        <year>2019</year>
      </date>
      <date date-type="accepted">
        <day>13</day>
        <month>6</month>
        <year>2019</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2019</copyright-statement>
      <license license-type="OpenAccess">
        <license-p><bold>Open Access</bold>This article is distributed under the terms of the Creative Commons Attribution 4.0 International License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted use, distribution, and reproduction in any medium, provided you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons license, and indicate if changes were made. The Creative Commons Public Domain Dedication waiver (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/publicdomain/zero/1.0/">http://creativecommons.org/publicdomain/zero/1.0/</ext-link>) applies to the data made available in this article, unless otherwise stated.</license-p>
      </license>
    </permissions>
    <abstract id="Abs1">
      <sec>
        <title>Background</title>
        <p id="Par1">Divide-and-conquer methods, which divide the species set into overlapping subsets, construct a tree on each subset, and then combine the subset trees using a supertree method, provide a key algorithmic framework for boosting the scalability of phylogeny estimation methods to large datasets. Yet the use of supertree methods, which typically attempt to solve NP-hard optimization problems, limits the scalability of such approaches.</p>
      </sec>
      <sec>
        <title>Results</title>
        <p id="Par2">In this paper, we introduce a divide-and-conquer approach that does not require supertree estimation: we divide the species set into pairwise disjoint subsets, construct a tree on each subset using a base method, and then combine the subset trees using a distance matrix. For this merger step, we present a new method, called NJMerge, which is a polynomial-time extension of Neighbor Joining (NJ); thus, NJMerge can be viewed either as a method for improving traditional NJ or as a method for scaling the base method to larger datasets. We prove that NJMerge can be used to create divide-and-conquer pipelines that are statistically consistent under some models of evolution. We also report the results of an extensive simulation study evaluating NJMerge on multi-locus datasets with up to 1000 species. We found that NJMerge sometimes improved the accuracy of traditional NJ and substantially reduced the running time of three popular species tree methods (ASTRAL-III, SVDquartets, and “concatenation” using RAxML) without sacrificing accuracy. Finally, although NJMerge can fail to return a tree, in our experiments, NJMerge failed on only 11 out of 2560 test cases.</p>
      </sec>
      <sec>
        <title>Conclusions</title>
        <p id="Par3">Theoretical and empirical results suggest that NJMerge is a valuable technique for large-scale phylogeny estimation, especially when computational resources are limited. NJMerge is freely available on Github (<ext-link ext-link-type="uri" xlink:href="http://github.com/ekmolloy/njmerge">http://github.com/ekmolloy/njmerge</ext-link>).</p>
      </sec>
      <sec>
        <title>Electronic supplementary material</title>
        <p>The online version of this article (10.1186/s13015-019-0151-x) contains supplementary material, which is available to authorized users.</p>
      </sec>
    </abstract>
    <kwd-group xml:lang="en">
      <title>Keywords</title>
      <kwd>Divide-and-conquer</kwd>
      <kwd>Neighbor Joining</kwd>
      <kwd>Species trees</kwd>
      <kwd>Incomplete lineage sorting</kwd>
      <kwd>Phylogenomics</kwd>
    </kwd-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100000001</institution-id>
            <institution>National Science Foundation</institution>
          </institution-wrap>
        </funding-source>
        <award-id>1535977</award-id>
        <award-id>1513629</award-id>
        <award-id>1144245</award-id>
        <principal-award-recipient>
          <name>
            <surname>Molloy</surname>
            <given-names>Erin K.</given-names>
          </name>
          <name>
            <surname>Warnow</surname>
            <given-names>Tandy</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
    </funding-group>
    <custom-meta-group>
      <custom-meta>
        <meta-name>issue-copyright-statement</meta-name>
        <meta-value>© The Author(s) 2019</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec id="Sec1">
    <title>Introduction</title>
    <p id="Par4">Estimating evolutionary trees, called phylogenies, from molecular sequence data is a fundamental problem in computational biology, and building the Tree of Life is a scientific grand challenge. It is also a computational grand challenge, as many of the most accurate phylogeny estimation methods are heuristics for NP-hard optimization problems. Species tree estimation can be further complicated by biological processes (e.g., incomplete lineage sorting, gene duplication and loss, and horizontal gene transfer) that create heterogeneous evolutionary histories across genomes or “gene tree discordance” [<xref ref-type="bibr" rid="CR1">1</xref>].</p>
    <p id="Par5">Incomplete lineage sorting (ILS), which is modeled by the Multi-Species Coalescent (MSC) model [<xref ref-type="bibr" rid="CR2">2</xref>, <xref ref-type="bibr" rid="CR3">3</xref>], has been shown to present challenges for phylogenomic analyses [<xref ref-type="bibr" rid="CR4">4</xref>]. In addition, while the standard approach for multi-locus species tree estimation uses maximum likelihood methods (e.g., RAxML) on the concatenated multiple sequence alignment, recent studies have established that even exact algorithms for maximum likelihood are not statistically consistent methods for multi-locus species tree estimation under the MSC model (see [<xref ref-type="bibr" rid="CR5">5</xref>] for a proof for unpartitioned maximum likelihood and [<xref ref-type="bibr" rid="CR6">6</xref>] for fully partitioned maximum likelihood).</p>
    <p id="Par6">Because concatenation analyses using maximum likelihood are provably not statistically consistent in the presence of incomplete lineage sorting, new methods have been developed that are provably statistically consistent under the MSC model. Bayesian methods that co-estimate gene trees and species trees (e.g., [<xref ref-type="bibr" rid="CR7">7</xref>, <xref ref-type="bibr" rid="CR8">8</xref>]) are statistically consistent and expected to be the highly accurate; however, such methods are also prohibitively expensive on large datasets. More efficient approaches have been developed that are statistically consistent under the MSC model, including “gene tree summary methods”, which take a collection of gene trees as input and then compute a species tree from the gene trees using only the gene tree topologies. For example, NJst [<xref ref-type="bibr" rid="CR9">9</xref>] runs Neighbor Joining (NJ) [<xref ref-type="bibr" rid="CR10">10</xref>] on the “average gene tree internode distance” (AGID) matrix, and ASTRAL [<xref ref-type="bibr" rid="CR11">11</xref>] finds a quartet-median tree (i.e. a species tree that maximizes the total quartet tree similarity to the input gene trees) within a constrained search space. However, gene tree summary methods can have reduced accuracy when gene tree estimation error is high, which is a problem for many phylogenomic datasets (see discussion in [<xref ref-type="bibr" rid="CR12">12</xref>]).</p>
    <p id="Par7">Because of the impact of gene tree estimation error, alternative approaches that bypass gene tree estimation, called “site-based” methods, have been proposed. Perhaps the best known site-based method is SVDquartets [<xref ref-type="bibr" rid="CR13">13</xref>], which estimates quartet trees from the concatenated sequence alignments (using statistical properties of the MSC model and the sequence evolution model) and then combines the quartet trees into a tree on the full set of species using quartet amalgamation methods that are heuristics for the Maximum Quartet Consistency problem [<xref ref-type="bibr" rid="CR14">14</xref>]. Other examples of site-based methods include computing Jukes-Cantor [<xref ref-type="bibr" rid="CR15">15</xref>] or log-det [<xref ref-type="bibr" rid="CR16">16</xref>] distances from the concatenated alignment and then running NJ on the resulting distance matrix. Such approaches can be statistically consistent under the MSC model when the sequence evolution models across genes satisfy some additional assumptions (e.g., a relaxed molecular clock) [<xref ref-type="bibr" rid="CR17">17</xref>, <xref ref-type="bibr" rid="CR18">18</xref>].</p>
    <p id="Par8">Many of these methods (e.g., ASTRAL, SVDquartets, and concatenation using RAxML) are heuristics for NP-hard optimization problems. Such methods can have difficulties scaling to datasets with large numbers of species, and divide-and-conquer approaches have been developed to scale methods to larger datasets (e.g., the family of disk covering methods [<xref ref-type="bibr" rid="CR19">19</xref>–<xref ref-type="bibr" rid="CR24">24</xref>]). Such methods operate by dividing the species set into overlapping subsets, constructing trees on the subsets, and then merging the subset trees into a tree on the entire species set. The last step of this process, called “supertree estimation”, can provide good accuracy (i.e., retain much of the accuracy in the subset trees) if good supertree methods are used. Notably, the supertree compatibility problem is NP-complete [<xref ref-type="bibr" rid="CR25">25</xref>], and the preferred supertree methods attempt to solve NP-hard optimization problems (e.g., the Robinson–Foulds supertree problem [<xref ref-type="bibr" rid="CR26">26</xref>], the Maximum Quartet Consistency problem [<xref ref-type="bibr" rid="CR14">14</xref>], the Matrix Representation with Parsimony problem [<xref ref-type="bibr" rid="CR27">27</xref>], and the Matrix Representation with Likelihood problem [<xref ref-type="bibr" rid="CR28">28</xref>]). In summary, none of the current supertree methods provide both accuracy and scalability to datasets with large numbers of species (see [<xref ref-type="bibr" rid="CR29">29</xref>] for further discussion).</p>
    <p id="Par9">In this paper, we introduce a new divide-and-conquer approach to scaling phylogeny estimation methods to large datasets: we divide the species (or leaf) set into pairwise disjoint subsets, construct a tree on each of the subsets, and then assemble the subset trees into a tree on the entire species set. Supertree methods cannot be used to combine trees on pairwise disjoint leaf sets, and we present a new polynomial-time method, called NJMerge, for this task. We prove that NJMerge can be used in statistically consistent divide-and-conquer pipelines for both gene tree and species tree estimation and evaluate the effectiveness of using NJMerge in the context of multi-locus species tree estimation. We found, using an extensive simulation study, that NJMerge sometimes improved the accuracy of traditional NJ and that NJMerge provided substantial improvements in the running time for three methods (ASTRAL-III [<xref ref-type="bibr" rid="CR30">30</xref>], SVDquartets [<xref ref-type="bibr" rid="CR13">13</xref>], and concatenation using RAxML [<xref ref-type="bibr" rid="CR31">31</xref>]) without sacrificing accuracy. Furthermore, NJMerge enabled SVDquartets and RAxML to run on large datasets (e.g., 1000 taxa and 1000 genes), on which SVDquartets and RAxML would otherwise fail to run when limited to 64 GB of memory. While NJMerge is not guaranteed to return a tree; the failure rate in our experiments was low (less than 1% of tests). In addition, NJMerge failed on fewer datasets than either ASTRAL-III, SVDquartets, or RAxML—when given the same computational resources: a single compute node with 64 GB of physical memory, 16 cores, and a maximum wall-clock time of 48 h. Together, these results suggest that NJMerge is a valuable technique for large-scale phylogeny estimation, especially when computational resources are limited.</p>
  </sec>
  <sec id="Sec2">
    <title>NJMerge</title>
    <p id="Par10">Neighbor Joining (NJ) [<xref ref-type="bibr" rid="CR10">10</xref>], perhaps the most widely used polynomial-time method for phylogeny estimation, estimates a tree <italic>T</italic> from a dissimilarity matrix <italic>D</italic>; NJMerge is a polynomial-time extension of NJ to impose a set of constraints on the output tree <italic>T</italic> (Fig. <xref rid="Fig1" ref-type="fig">1</xref>). More formally, NJMerge takes as input a dissimilarity matrix <italic>D</italic> on leaf set <inline-formula id="IEq1"><alternatives><tex-math id="M1">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$S = \{s_1, s_2, \ldots , s_n\}$$\end{document}</tex-math><mml:math id="M2"><mml:mrow><mml:mi>S</mml:mi><mml:mo>=</mml:mo><mml:mo stretchy="false">{</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="13015_2019_151_Article_IEq1.gif"/></alternatives></inline-formula> and a set <inline-formula id="IEq2"><alternatives><tex-math id="M3">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathcal {T}} = \{T_1, T_2, \dots , T_k\}$$\end{document}</tex-math><mml:math id="M4"><mml:mrow><mml:mi mathvariant="script">T</mml:mi><mml:mo>=</mml:mo><mml:mo stretchy="false">{</mml:mo><mml:msub><mml:mi>T</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>T</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>⋯</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>T</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="13015_2019_151_Article_IEq2.gif"/></alternatives></inline-formula> of unrooted binary trees on pairwise disjoint subsets of the leaf set <italic>S</italic> and returns a tree <italic>T</italic> that agrees with every tree in <inline-formula id="IEq3"><alternatives><tex-math id="M5">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathcal {T}}$$\end{document}</tex-math><mml:math id="M6"><mml:mi mathvariant="script">T</mml:mi></mml:math><inline-graphic xlink:href="13015_2019_151_Article_IEq3.gif"/></alternatives></inline-formula> (Definition <xref ref-type="sec" rid="FPar1">1</xref>). Note that the output tree <italic>T</italic> is a compatibility supertree for <inline-formula id="IEq4"><alternatives><tex-math id="M7">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathcal {T}}$$\end{document}</tex-math><mml:math id="M8"><mml:mi mathvariant="script">T</mml:mi></mml:math><inline-graphic xlink:href="13015_2019_151_Article_IEq4.gif"/></alternatives></inline-formula> and that because the trees in <inline-formula id="IEq5"><alternatives><tex-math id="M9">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathcal {T}}$$\end{document}</tex-math><mml:math id="M10"><mml:mi mathvariant="script">T</mml:mi></mml:math><inline-graphic xlink:href="13015_2019_151_Article_IEq5.gif"/></alternatives></inline-formula> are on pairwise disjoint subsets of the leaf set <italic>S</italic>, a compatibility supertree always exists. NJMerge does not require that the input constraint trees <inline-formula id="IEq6"><alternatives><tex-math id="M11">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathcal {T}}$$\end{document}</tex-math><mml:math id="M12"><mml:mi mathvariant="script">T</mml:mi></mml:math><inline-graphic xlink:href="13015_2019_151_Article_IEq6.gif"/></alternatives></inline-formula> to form clades in <italic>T</italic>. For example, the caterpillar tree on <inline-formula id="IEq7"><alternatives><tex-math id="M13">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\{A,B,C,D,E,F,G,H\}$$\end{document}</tex-math><mml:math id="M14"><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:mi>A</mml:mi><mml:mo>,</mml:mo><mml:mi>B</mml:mi><mml:mo>,</mml:mo><mml:mi>C</mml:mi><mml:mo>,</mml:mo><mml:mi>D</mml:mi><mml:mo>,</mml:mo><mml:mi>E</mml:mi><mml:mo>,</mml:mo><mml:mi>F</mml:mi><mml:mo>,</mml:mo><mml:mi>G</mml:mi><mml:mo>,</mml:mo><mml:mi>H</mml:mi><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="13015_2019_151_Article_IEq7.gif"/></alternatives></inline-formula> obtained by making a path with the leaves hanging off it in alphabetical order is a compatibility supertree for <inline-formula id="IEq8"><alternatives><tex-math id="M15">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathcal {T}} = \{AC|EG, \; BD|FH\}$$\end{document}</tex-math><mml:math id="M16"><mml:mrow><mml:mi mathvariant="script">T</mml:mi><mml:mo>=</mml:mo><mml:mo stretchy="false">{</mml:mo><mml:mi>A</mml:mi><mml:mi>C</mml:mi><mml:mo stretchy="false">|</mml:mo><mml:mi>E</mml:mi><mml:mi>G</mml:mi><mml:mo>,</mml:mo><mml:mspace width="0.277778em"/><mml:mi>B</mml:mi><mml:mi>D</mml:mi><mml:mo stretchy="false">|</mml:mo><mml:mi>F</mml:mi><mml:mi>H</mml:mi><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="13015_2019_151_Article_IEq8.gif"/></alternatives></inline-formula>, and yet the trees in <inline-formula id="IEq9"><alternatives><tex-math id="M17">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathcal {T}}$$\end{document}</tex-math><mml:math id="M18"><mml:mi mathvariant="script">T</mml:mi></mml:math><inline-graphic xlink:href="13015_2019_151_Article_IEq9.gif"/></alternatives></inline-formula> do not form clades within the caterpillar tree (Fig. <xref rid="Fig2" ref-type="fig">2</xref>). Of course, other compatibility supertrees exist for <inline-formula id="IEq10"><alternatives><tex-math id="M19">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathcal {T}}$$\end{document}</tex-math><mml:math id="M20"><mml:mi mathvariant="script">T</mml:mi></mml:math><inline-graphic xlink:href="13015_2019_151_Article_IEq10.gif"/></alternatives></inline-formula>, and, in some of them, the input constraint trees will form clades. The objective is to find a tree that is close to the true (but unknown) tree from the set of all compatibility supertrees for <inline-formula id="IEq11"><alternatives><tex-math id="M21">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathcal {T}}$$\end{document}</tex-math><mml:math id="M22"><mml:mi mathvariant="script">T</mml:mi></mml:math><inline-graphic xlink:href="13015_2019_151_Article_IEq11.gif"/></alternatives></inline-formula>, and NJMerge tries to achieve this objective by using the dissimilarity matrix <italic>D</italic>.<fig id="Fig1"><label>Fig. 1</label><caption><p>NJMerge input/output example. In this example, NJMerge is given two constraint trees (<inline-formula id="IEq12"><alternatives><tex-math id="M23">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$T_i$$\end{document}</tex-math><mml:math id="M24"><mml:msub><mml:mi>T</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13015_2019_151_Article_IEq12.gif"/></alternatives></inline-formula> and <inline-formula id="IEq13"><alternatives><tex-math id="M25">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$T_j$$\end{document}</tex-math><mml:math id="M26"><mml:msub><mml:mi>T</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13015_2019_151_Article_IEq13.gif"/></alternatives></inline-formula>) and a distance matrix <inline-formula id="IEq14"><alternatives><tex-math id="M27">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$D^{ij}$$\end{document}</tex-math><mml:math id="M28"><mml:msup><mml:mi>D</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msup></mml:math><inline-graphic xlink:href="13015_2019_151_Article_IEq14.gif"/></alternatives></inline-formula> that is additive for the tree (((<italic>A</italic>, <italic>B</italic>), (<italic>C</italic>, <italic>D</italic>)), <italic>E</italic>, (<italic>F</italic>, (<italic>G</italic>, <italic>H</italic>))). NJMerge returns a compatibility supertree, called <inline-formula id="IEq15"><alternatives><tex-math id="M29">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$T_{ij}$$\end{document}</tex-math><mml:math id="M30"><mml:msub><mml:mi>T</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13015_2019_151_Article_IEq15.gif"/></alternatives></inline-formula>, for the two constraint trees (<inline-formula id="IEq16"><alternatives><tex-math id="M31">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$T_i$$\end{document}</tex-math><mml:math id="M32"><mml:msub><mml:mi>T</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13015_2019_151_Article_IEq16.gif"/></alternatives></inline-formula> and <inline-formula id="IEq17"><alternatives><tex-math id="M33">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$T_j$$\end{document}</tex-math><mml:math id="M34"><mml:msub><mml:mi>T</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13015_2019_151_Article_IEq17.gif"/></alternatives></inline-formula>). Note that Neighbor Joining (NJ) applied to the distance matrix <inline-formula id="IEq18"><alternatives><tex-math id="M35">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$D^{ij}$$\end{document}</tex-math><mml:math id="M36"><mml:msup><mml:mi>D</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msup></mml:math><inline-graphic xlink:href="13015_2019_151_Article_IEq18.gif"/></alternatives></inline-formula> would return (((<italic>A</italic>, <italic>B</italic>), (<italic>C</italic>, <italic>D</italic>)), <italic>E</italic>, (<italic>F</italic>, (<italic>G</italic>, <italic>H</italic>))) [<xref ref-type="bibr" rid="CR37">37</xref>]; however, NJMerge rejects the siblinghood proposal (<italic>G</italic>, <italic>H</italic>), because it violates constraint tree <inline-formula id="IEq19"><alternatives><tex-math id="M37">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$T_j$$\end{document}</tex-math><mml:math id="M38"><mml:msub><mml:mi>T</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13015_2019_151_Article_IEq19.gif"/></alternatives></inline-formula>. Instead, NJMerge makes <italic>G</italic> and <italic>F</italic> siblings</p></caption><graphic xlink:href="13015_2019_151_Fig1_HTML" id="MO1"/></fig>
<fig id="Fig2"><label>Fig. 2</label><caption><p>Compatibility supertree example. In this example, two compatibility supertrees for <inline-formula id="IEq20"><alternatives><tex-math id="M39">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathcal {T}} = \{T_i, \; T_j\}$$\end{document}</tex-math><mml:math id="M40"><mml:mrow><mml:mi mathvariant="script">T</mml:mi><mml:mo>=</mml:mo><mml:mo stretchy="false">{</mml:mo><mml:msub><mml:mi>T</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mspace width="0.277778em"/><mml:msub><mml:mi>T</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="13015_2019_151_Article_IEq20.gif"/></alternatives></inline-formula> are shown. Note that the trees in <inline-formula id="IEq21"><alternatives><tex-math id="M41">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathcal {T}}$$\end{document}</tex-math><mml:math id="M42"><mml:mi mathvariant="script">T</mml:mi></mml:math><inline-graphic xlink:href="13015_2019_151_Article_IEq21.gif"/></alternatives></inline-formula> form clades in <inline-formula id="IEq22"><alternatives><tex-math id="M43">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$T'$$\end{document}</tex-math><mml:math id="M44"><mml:msup><mml:mi>T</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:math><inline-graphic xlink:href="13015_2019_151_Article_IEq22.gif"/></alternatives></inline-formula> but do not form clades in <italic>T</italic>. Other compatibility supertrees for <inline-formula id="IEq23"><alternatives><tex-math id="M45">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathcal {T}}$$\end{document}</tex-math><mml:math id="M46"><mml:mi mathvariant="script">T</mml:mi></mml:math><inline-graphic xlink:href="13015_2019_151_Article_IEq23.gif"/></alternatives></inline-formula> exist</p></caption><graphic xlink:href="13015_2019_151_Fig2_HTML" id="MO2"/></fig>
</p>
    <sec id="FPar1">
      <title>
        <bold>Definition 1</bold>
      </title>
      <p id="Par11">Let <italic>T</italic> be a tree on leaf set <italic>S</italic>, and let <inline-formula id="IEq36"><alternatives><tex-math id="M47">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$T'$$\end{document}</tex-math><mml:math id="M48"><mml:msup><mml:mi>T</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:math><inline-graphic xlink:href="13015_2019_151_Article_IEq36.gif"/></alternatives></inline-formula> be a tree on leaf set <inline-formula id="IEq37"><alternatives><tex-math id="M49">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$R \subseteq S$$\end{document}</tex-math><mml:math id="M50"><mml:mrow><mml:mi>R</mml:mi><mml:mo>⊆</mml:mo><mml:mi>S</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="13015_2019_151_Article_IEq37.gif"/></alternatives></inline-formula>. We say that <inline-formula id="IEq38"><alternatives><tex-math id="M51">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$T'$$\end{document}</tex-math><mml:math id="M52"><mml:msup><mml:mi>T</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:math><inline-graphic xlink:href="13015_2019_151_Article_IEq38.gif"/></alternatives></inline-formula>
<italic>agrees with</italic>
<italic>T</italic> if restricting <italic>T</italic> to leaf set <italic>R</italic> induces a binary tree that (after suppressing the internal nodes of degree 2) is isomorphic to <inline-formula id="IEq39"><alternatives><tex-math id="M53">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$T'$$\end{document}</tex-math><mml:math id="M54"><mml:msup><mml:mi>T</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:math><inline-graphic xlink:href="13015_2019_151_Article_IEq39.gif"/></alternatives></inline-formula>.</p>
      <p>Here we briefly describe the NJ algorithm by Saitou and Nei [<xref ref-type="bibr" rid="CR10">10</xref>]. NJ has an iterative design that builds the tree from the bottom up, producing a rooted tree that is then unrooted. Initially, all <italic>n</italic> leaves are in separate components. When a pair of leaves is selected to be siblings, the pair of leaves is effectively replaced by a rooted tree on two leaves, and the number of components is reduced by one. This process repeats until there is only one component: a tree on the full leaf set. At each iteration, NJ updates <italic>D</italic> based on the new sibling pair, derives a new matrix <italic>Q</italic> from <italic>D</italic>, and uses <italic>Q</italic> to determine which pair of the remaining nodes to join. Specifically, NJ accepts siblinghood proposal (<italic>i</italic>, <italic>j</italic>) such that <italic>Q</italic>[<italic>i</italic>, <italic>j</italic>] is minimized. The same formulas used by NJ [<xref ref-type="bibr" rid="CR10">10</xref>] to update <italic>D</italic> and compute <italic>Q</italic> are also used by NJMerge; however, NJMerge can make different siblinghood decisions than NJ—based on the input constraint trees.</p>
      <p>After each siblinghood decision, NJMerge updates the constraint trees. Specifically, when two leaves are made siblings, they are replaced by a new leaf, and the constraint trees are relabeled. For example, if <italic>x</italic> is a leaf in <inline-formula id="IEq40"><alternatives><tex-math id="M55">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$T_i$$\end{document}</tex-math><mml:math id="M56"><mml:msub><mml:mi>T</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13015_2019_151_Article_IEq40.gif"/></alternatives></inline-formula> and <italic>y</italic> is a leaf in <inline-formula id="IEq41"><alternatives><tex-math id="M57">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$T_j$$\end{document}</tex-math><mml:math id="M58"><mml:msub><mml:mi>T</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13015_2019_151_Article_IEq41.gif"/></alternatives></inline-formula>, then the siblinghood proposal <inline-formula id="IEq42"><alternatives><tex-math id="M59">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$z = (x,y)$$\end{document}</tex-math><mml:math id="M60"><mml:mrow><mml:mi>z</mml:mi><mml:mo>=</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="13015_2019_151_Article_IEq42.gif"/></alternatives></inline-formula> requires that <italic>x</italic> and <italic>y</italic> are replaced with <italic>z</italic> in <inline-formula id="IEq43"><alternatives><tex-math id="M61">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$T_i$$\end{document}</tex-math><mml:math id="M62"><mml:msub><mml:mi>T</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13015_2019_151_Article_IEq43.gif"/></alternatives></inline-formula> and <inline-formula id="IEq44"><alternatives><tex-math id="M63">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$T_j$$\end{document}</tex-math><mml:math id="M64"><mml:msub><mml:mi>T</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13015_2019_151_Article_IEq44.gif"/></alternatives></inline-formula>, respectively. Because siblinghood decisions change the set of leaves in the constraint trees, they can result in the constraint trees no longer being disjoint (Fig. <xref rid="Fig3" ref-type="fig">3</xref>). Thus, siblinghood decisions have the potential to make the set of constraint trees incompatible. Determining whether or not a set of unrooted phylogenetic trees is compatible is an NP-complete problem [<xref ref-type="bibr" rid="CR32">32</xref>, <xref ref-type="bibr" rid="CR33">33</xref>], so NJMerge uses a polynomial-time heuristic. In each iteration, NJMerge sorts the entries of the <italic>Q</italic> from least to greatest and accepts the first siblinghood proposal (<italic>x</italic>, <italic>y</italic>) that satisfies the following properties:<fig id="Fig3"><label>Fig. 3</label><caption><p>NJMerge siblinghood proposal example. In this example, NJMerge evaluates the siblinghood proposal (<italic>C</italic>, <italic>D</italic>). Because <inline-formula id="IEq24"><alternatives><tex-math id="M65">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$C \in T_i$$\end{document}</tex-math><mml:math id="M66"><mml:mrow><mml:mi>C</mml:mi><mml:mo>∈</mml:mo><mml:msub><mml:mi>T</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="13015_2019_151_Article_IEq24.gif"/></alternatives></inline-formula> and <inline-formula id="IEq25"><alternatives><tex-math id="M67">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$D \in T_j$$\end{document}</tex-math><mml:math id="M68"><mml:mrow><mml:mi>D</mml:mi><mml:mo>∈</mml:mo><mml:msub><mml:mi>T</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="13015_2019_151_Article_IEq25.gif"/></alternatives></inline-formula>, NJMerge first updates the constraint trees <inline-formula id="IEq26"><alternatives><tex-math id="M69">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$T_i$$\end{document}</tex-math><mml:math id="M70"><mml:msub><mml:mi>T</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13015_2019_151_Article_IEq26.gif"/></alternatives></inline-formula> and <inline-formula id="IEq27"><alternatives><tex-math id="M71">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$T_j$$\end{document}</tex-math><mml:math id="M72"><mml:msub><mml:mi>T</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13015_2019_151_Article_IEq27.gif"/></alternatives></inline-formula> based on the proposed siblinghood to get <inline-formula id="IEq28"><alternatives><tex-math id="M73">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$T'_i$$\end{document}</tex-math><mml:math id="M74"><mml:msubsup><mml:mi>T</mml:mi><mml:mi>i</mml:mi><mml:mo>′</mml:mo></mml:msubsup></mml:math><inline-graphic xlink:href="13015_2019_151_Article_IEq28.gif"/></alternatives></inline-formula> and <inline-formula id="IEq29"><alternatives><tex-math id="M75">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$T'_j$$\end{document}</tex-math><mml:math id="M76"><mml:msubsup><mml:mi>T</mml:mi><mml:mi>j</mml:mi><mml:mo>′</mml:mo></mml:msubsup></mml:math><inline-graphic xlink:href="13015_2019_151_Article_IEq29.gif"/></alternatives></inline-formula>. Specifically, both <inline-formula id="IEq30"><alternatives><tex-math id="M77">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$C \in T_i$$\end{document}</tex-math><mml:math id="M78"><mml:mrow><mml:mi>C</mml:mi><mml:mo>∈</mml:mo><mml:msub><mml:mi>T</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="13015_2019_151_Article_IEq30.gif"/></alternatives></inline-formula> and <inline-formula id="IEq31"><alternatives><tex-math id="M79">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$D \in T_j$$\end{document}</tex-math><mml:math id="M80"><mml:mrow><mml:mi>D</mml:mi><mml:mo>∈</mml:mo><mml:msub><mml:mi>T</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="13015_2019_151_Article_IEq31.gif"/></alternatives></inline-formula> are replaced by <italic>X</italic>, representing the siblinghood (<italic>C</italic>, <italic>D</italic>). The compatibility of the updated constraint trees can be tested by rooting the trees at leaf <italic>X</italic> and using the algorithm proposed in [<xref ref-type="bibr" rid="CR34">34</xref>]. Because the updated constraint trees (<inline-formula id="IEq32"><alternatives><tex-math id="M81">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$T'_i$$\end{document}</tex-math><mml:math id="M82"><mml:msubsup><mml:mi>T</mml:mi><mml:mi>i</mml:mi><mml:mo>′</mml:mo></mml:msubsup></mml:math><inline-graphic xlink:href="13015_2019_151_Article_IEq32.gif"/></alternatives></inline-formula> and <inline-formula id="IEq33"><alternatives><tex-math id="M83">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$T'_j$$\end{document}</tex-math><mml:math id="M84"><mml:msubsup><mml:mi>T</mml:mi><mml:mi>j</mml:mi><mml:mo>′</mml:mo></mml:msubsup></mml:math><inline-graphic xlink:href="13015_2019_151_Article_IEq33.gif"/></alternatives></inline-formula>) are indeed compatible, NJMerge will accept siblinghood proposal (<italic>C</italic>, <italic>D</italic>). Importantly, when NJMerge evaluates the next siblinghood proposal, the two constraint trees will no longer be on disjoint leaf sets</p></caption><graphic xlink:href="13015_2019_151_Fig3_HTML" id="MO3"/></fig>
<list list-type="order"><list-item><p id="Par14">If <italic>x</italic> and <italic>y</italic> are both in some constraint tree <inline-formula id="IEq45"><alternatives><tex-math id="M85">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$T_i$$\end{document}</tex-math><mml:math id="M86"><mml:msub><mml:mi>T</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13015_2019_151_Article_IEq45.gif"/></alternatives></inline-formula>, then they are siblings in <inline-formula id="IEq46"><alternatives><tex-math id="M87">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$T_i$$\end{document}</tex-math><mml:math id="M88"><mml:msub><mml:mi>T</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13015_2019_151_Article_IEq46.gif"/></alternatives></inline-formula>.</p></list-item><list-item><p id="Par15">If <italic>x</italic> or <italic>y</italic> are in more than one constraint trees, then replacing <italic>x</italic> and <italic>y</italic> with a new leaf <inline-formula id="IEq47"><alternatives><tex-math id="M89">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$z = (x,y)$$\end{document}</tex-math><mml:math id="M90"><mml:mrow><mml:mi>z</mml:mi><mml:mo>=</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="13015_2019_151_Article_IEq47.gif"/></alternatives></inline-formula> in all constraint trees does not make any <italic>pair</italic> of constraint trees incompatible, i.e., a compatibility supertree exists for every <italic>pair</italic> of updated constraint trees.</p></list-item></list>Because pairwise compatibility of unrooted trees does not guarantee that the entire set of constraint trees is compatible, it is possible for NJMerge to accept a siblinghood decision that will eventually cause the algorithm to fail when none of the remaining leaves can be joined without violating the pairwise compatibility of constraint trees. Although the “pairwise compatibility heuristic” can fail, it is easy to see that if NJMerge returns a tree, then it is a compatibility supertree for the input set <inline-formula id="IEq48"><alternatives><tex-math id="M91">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathcal {T}}$$\end{document}</tex-math><mml:math id="M92"><mml:mi mathvariant="script">T</mml:mi></mml:math><inline-graphic xlink:href="13015_2019_151_Article_IEq48.gif"/></alternatives></inline-formula> of constraint trees.
</p>
      <p>To determine if some pair of constraint trees becomes incompatible after making <italic>x</italic> and <italic>y</italic> siblings, it suffices to check only those pairs of constraint trees that contain at least one of <italic>x</italic> and <italic>y</italic>; all other pairs of trees are unchanged by accepting the siblinghood proposal and are pairwise compatible by induction. Because the leaves in the two trees labeled <italic>x</italic> or <italic>y</italic> have been relabeled by the new leaf <inline-formula id="IEq55"><alternatives><tex-math id="M93">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$z = (x, y)$$\end{document}</tex-math><mml:math id="M94"><mml:mrow><mml:mi>z</mml:mi><mml:mo>=</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="13015_2019_151_Article_IEq55.gif"/></alternatives></inline-formula>, they can be treated as rooted trees by rooting them at <italic>z</italic>. Testing the compatibility of rooted trees is easily accomplished in polynomial time using [<xref ref-type="bibr" rid="CR34">34</xref>]. In fact, instead of testing pairs of constraint trees, the entire set of trees in <inline-formula id="IEq56"><alternatives><tex-math id="M95">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathcal {T}}$$\end{document}</tex-math><mml:math id="M96"><mml:mi mathvariant="script">T</mml:mi></mml:math><inline-graphic xlink:href="13015_2019_151_Article_IEq56.gif"/></alternatives></inline-formula> containing the new leaf <inline-formula id="IEq57"><alternatives><tex-math id="M97">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$z = (x, y)$$\end{document}</tex-math><mml:math id="M98"><mml:mrow><mml:mi>z</mml:mi><mml:mo>=</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="13015_2019_151_Article_IEq57.gif"/></alternatives></inline-formula> can be tested for compatibility in polynomial time using [<xref ref-type="bibr" rid="CR34">34</xref>]. Furthermore, if at least one leaf exists in all constraint trees, then the compatibility of <inline-formula id="IEq58"><alternatives><tex-math id="M99">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathcal {T}}$$\end{document}</tex-math><mml:math id="M100"><mml:mi mathvariant="script">T</mml:mi></mml:math><inline-graphic xlink:href="13015_2019_151_Article_IEq58.gif"/></alternatives></inline-formula> can be determined in polynomial time. Finally, note the input matrix was referred to as a dissimilarity matrix (and not a distance matrix), because estimated distances between species may not satisfy the triangle inequality [<xref ref-type="bibr" rid="CR24">24</xref>]; however, this matrix is more commonly referred to as a distance matrix, and we use this term henceforth.</p>
    </sec>
    <sec id="Sec3">
      <title>Divide-and-conquer pipelines for phylogeny estimation</title>
      <p id="Par17">NJMerge can be used in divide-and-conquer pipelines for phylogeny estimation as shown in Fig. <xref rid="Fig4" ref-type="fig">4</xref> and described below. In order to run this pipeline, the user must select a method for decomposing the leaf set into pairwise disjoint subsets (step 2), a maximum subset size (step 2), a method for computing a distance matrix <inline-formula id="IEq59"><alternatives><tex-math id="M101">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$M_D$$\end{document}</tex-math><mml:math id="M102"><mml:msub><mml:mi>M</mml:mi><mml:mi>D</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13015_2019_151_Article_IEq59.gif"/></alternatives></inline-formula> (step 1), and a method <inline-formula id="IEq60"><alternatives><tex-math id="M103">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$M_T$$\end{document}</tex-math><mml:math id="M104"><mml:msub><mml:mi>M</mml:mi><mml:mi>T</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13015_2019_151_Article_IEq60.gif"/></alternatives></inline-formula> for computing subset trees (step 3); thus, the user can select <inline-formula id="IEq61"><alternatives><tex-math id="M105">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$M_D$$\end{document}</tex-math><mml:math id="M106"><mml:msub><mml:mi>M</mml:mi><mml:mi>D</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13015_2019_151_Article_IEq61.gif"/></alternatives></inline-formula> and <inline-formula id="IEq62"><alternatives><tex-math id="M107">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$M_T$$\end{document}</tex-math><mml:math id="M108"><mml:msub><mml:mi>M</mml:mi><mml:mi>T</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13015_2019_151_Article_IEq62.gif"/></alternatives></inline-formula> to be appropriate for gene tree estimation or species tree estimation. The pipeline then operates as follows.<fig id="Fig4"><label>Fig. 4</label><caption><p>Divide-and-conquer pipeline using NJMerge. We present a divide-and-conquer pipeline that operates by (1) estimating distances between pairs of species using method <inline-formula id="IEq34"><alternatives><tex-math id="M109">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$M_D$$\end{document}</tex-math><mml:math id="M110"><mml:msub><mml:mi>M</mml:mi><mml:mi>D</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13015_2019_151_Article_IEq34.gif"/></alternatives></inline-formula>, (2) decomposing the species set into pairwise disjoint subsets, (3) building a tree on each subset using method <inline-formula id="IEq35"><alternatives><tex-math id="M111">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$M_T$$\end{document}</tex-math><mml:math id="M112"><mml:msub><mml:mi>M</mml:mi><mml:mi>T</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13015_2019_151_Article_IEq35.gif"/></alternatives></inline-formula>, and (4) merging trees together using the distance matrix using NJMerge. Step 2 can be performed by estimating a tree from the distance matrix (e.g., using NJ) and then decomposing this tree into pairwise disjoint subsets of species (shown in blue). Although not explored in this study, this pipeline can be run in an iterative fashion by using the tree produced in Step 4 to define the next subset decomposition. In this schematic, sets of species are represented by circles, distance matrices are represented by squares, and trees are represented by triangles</p></caption><graphic xlink:href="13015_2019_151_Fig4_HTML" id="MO4"/></fig>
<list list-type="order"><list-item><p id="Par18">Estimate distances between pairs of leaves using method <inline-formula id="IEq63"><alternatives><tex-math id="M113">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$M_D$$\end{document}</tex-math><mml:math id="M114"><mml:msub><mml:mi>M</mml:mi><mml:mi>D</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13015_2019_151_Article_IEq63.gif"/></alternatives></inline-formula>.</p></list-item><list-item><p id="Par19">Decompose the leaf set into pairwise disjoint subsets.<list list-type="alpha-lower"><list-item><p id="Par20">Compute a starting tree by running NJ on the distance matrix computed in Step 1.</p></list-item><list-item><p id="Par21">Decompose the starting tree into pairwise disjoint subsets of leaves with a predefined maximum subset size (e.g., using the centroid tree decomposition described in PASTA [<xref ref-type="bibr" rid="CR35">35</xref>]).</p></list-item></list>
</p></list-item><list-item><p id="Par22">Build a tree on each subset using method <inline-formula id="IEq64"><alternatives><tex-math id="M115">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$M_T$$\end{document}</tex-math><mml:math id="M116"><mml:msub><mml:mi>M</mml:mi><mml:mi>T</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13015_2019_151_Article_IEq64.gif"/></alternatives></inline-formula>, thus producing the set <inline-formula id="IEq65"><alternatives><tex-math id="M117">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathcal {T}}$$\end{document}</tex-math><mml:math id="M118"><mml:mi mathvariant="script">T</mml:mi></mml:math><inline-graphic xlink:href="13015_2019_151_Article_IEq65.gif"/></alternatives></inline-formula> of constraint trees. Note that constraint trees can be estimated in serial or in parallel, depending on the computational resources available.</p></list-item><list-item><p id="Par23">Run NJMerge on the input pair (<inline-formula id="IEq66"><alternatives><tex-math id="M119">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathcal {T}}$$\end{document}</tex-math><mml:math id="M120"><mml:mi mathvariant="script">T</mml:mi></mml:math><inline-graphic xlink:href="13015_2019_151_Article_IEq66.gif"/></alternatives></inline-formula>, <italic>D</italic>).</p></list-item></list>Finally, although not explored in this study, this pipeline can be run in an iterative fashion by using the tree produced in step 4 to define the next subset decomposition.</p>
    </sec>
    <sec id="Sec4">
      <title>Statistical consistency</title>
      <p id="Par24">Neighbor Joining (NJ) has been proven to be statistically consistent [<xref ref-type="bibr" rid="CR36">36</xref>–<xref ref-type="bibr" rid="CR38">38</xref>] under models of evolution for which pairwise distances can be estimated in a statistically consistent manner. This includes standard models of sequence evolution (e.g., the Generalized Time Reversible (GTR) model [<xref ref-type="bibr" rid="CR39">39</xref>], which contains other models of sequence evolution, including Jukes-Cantor [<xref ref-type="bibr" rid="CR15">15</xref>]). More recently, NJ has been used on multi-locus datasets to estimate species trees under the Multi-Species Coalescent (MSC) model; specifically, the method, NJst [<xref ref-type="bibr" rid="CR9">9</xref>] estimates a species tree by running NJ on the average gene tree internode distance (AGID) matrix, calculated by averaging the topological distances between pairs of species in the input set of gene trees. Allman et al. [<xref ref-type="bibr" rid="CR40">40</xref>] showed that the AGID matrix converges to an additive matrix for the species tree, and so NJst and some other methods (e.g., ASTRID [<xref ref-type="bibr" rid="CR41">41</xref>]) that estimate species trees from the AGID matrix are statistically consistent under the MSC model.</p>
      <p id="Par25">We now prove that NJMerge can be used in statistically consistent divide-and-conquer pipelines for estimating gene trees and species trees. These results follow from Theorem <xref ref-type="sec" rid="FPar3">3</xref> that shows NJMerge will return the tree <inline-formula id="IEq67"><alternatives><tex-math id="M121">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$T^*$$\end{document}</tex-math><mml:math id="M122"><mml:msup><mml:mi>T</mml:mi><mml:mo>∗</mml:mo></mml:msup></mml:math><inline-graphic xlink:href="13015_2019_151_Article_IEq67.gif"/></alternatives></inline-formula> when given a nearly additive distance matrix (Definition <xref ref-type="sec" rid="FPar2">2</xref>) for <inline-formula id="IEq68"><alternatives><tex-math id="M123">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$T^*$$\end{document}</tex-math><mml:math id="M124"><mml:msup><mml:mi>T</mml:mi><mml:mo>∗</mml:mo></mml:msup></mml:math><inline-graphic xlink:href="13015_2019_151_Article_IEq68.gif"/></alternatives></inline-formula> and a set <inline-formula id="IEq69"><alternatives><tex-math id="M125">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathcal {T}}$$\end{document}</tex-math><mml:math id="M126"><mml:mi mathvariant="script">T</mml:mi></mml:math><inline-graphic xlink:href="13015_2019_151_Article_IEq69.gif"/></alternatives></inline-formula> of constraint trees that agree with <inline-formula id="IEq70"><alternatives><tex-math id="M127">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$T^*$$\end{document}</tex-math><mml:math id="M128"><mml:msup><mml:mi>T</mml:mi><mml:mo>∗</mml:mo></mml:msup></mml:math><inline-graphic xlink:href="13015_2019_151_Article_IEq70.gif"/></alternatives></inline-formula> (Definition <xref ref-type="sec" rid="FPar1">1</xref>).</p>
      <sec id="FPar2">
        <title>
          <bold>Definition 2</bold>
        </title>
        <p id="Par26">Let <italic>T</italic> be a tree with positive weights on the edges and leaves labeled <inline-formula id="IEq71"><alternatives><tex-math id="M129">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$1, 2, \dots , n$$\end{document}</tex-math><mml:math id="M130"><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mo>⋯</mml:mo><mml:mo>,</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="13015_2019_151_Article_IEq71.gif"/></alternatives></inline-formula>. We say that an <inline-formula id="IEq72"><alternatives><tex-math id="M131">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$n \times n$$\end{document}</tex-math><mml:math id="M132"><mml:mrow><mml:mi>n</mml:mi><mml:mo>×</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="13015_2019_151_Article_IEq72.gif"/></alternatives></inline-formula> matrix <italic>M</italic> is <italic>nearly additive</italic> for <italic>T</italic> if each entry <italic>M</italic>[<italic>i</italic>, <italic>j</italic>] differs from the distance between leaf <italic>i</italic> and leaf <italic>j</italic> in <italic>T</italic> by less than one half of the shortest branch length in <italic>T</italic>.</p>
      </sec>
      <sec id="FPar3">
        <title>
          <bold>Theorem 3</bold>
        </title>
        <p id="Par27"><italic>Let</italic><inline-formula id="IEq73"><alternatives><tex-math id="M133">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathcal {T}}=\{T_1, T_2, \ldots , T_k\}$$\end{document}</tex-math><mml:math id="M134"><mml:mrow><mml:mi mathvariant="script">T</mml:mi><mml:mo>=</mml:mo><mml:mo stretchy="false">{</mml:mo><mml:msub><mml:mi>T</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>T</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>T</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="13015_2019_151_Article_IEq73.gif"/></alternatives></inline-formula><italic>be a set of trees, and let</italic><italic>D</italic><italic>be a distance matrix on</italic><inline-formula id="IEq74"><alternatives><tex-math id="M135">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$S = \bigcup _i S_i$$\end{document}</tex-math><mml:math id="M136"><mml:mrow><mml:mi>S</mml:mi><mml:mo>=</mml:mo><mml:msub><mml:mo>⋃</mml:mo><mml:mi>i</mml:mi></mml:msub><mml:msub><mml:mi>S</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="13015_2019_151_Article_IEq74.gif"/></alternatives></inline-formula>, <italic>where</italic><inline-formula id="IEq75"><alternatives><tex-math id="M137">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$S_i$$\end{document}</tex-math><mml:math id="M138"><mml:msub><mml:mi>S</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13015_2019_151_Article_IEq75.gif"/></alternatives></inline-formula><italic>is the set of leaves in</italic><inline-formula id="IEq76"><alternatives><tex-math id="M139">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$T_i$$\end{document}</tex-math><mml:math id="M140"><mml:msub><mml:mi>T</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13015_2019_151_Article_IEq76.gif"/></alternatives></inline-formula>. <italic>Let</italic><inline-formula id="IEq77"><alternatives><tex-math id="M141">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$T^*$$\end{document}</tex-math><mml:math id="M142"><mml:msup><mml:mi>T</mml:mi><mml:mo>∗</mml:mo></mml:msup></mml:math><inline-graphic xlink:href="13015_2019_151_Article_IEq77.gif"/></alternatives></inline-formula><italic>be a tree on leaf set</italic><italic>S</italic>. <italic>If</italic><italic>D</italic><italic>is a nearly additive matrix for</italic><inline-formula id="IEq78"><alternatives><tex-math id="M143">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$T^*$$\end{document}</tex-math><mml:math id="M144"><mml:msup><mml:mi>T</mml:mi><mml:mo>∗</mml:mo></mml:msup></mml:math><inline-graphic xlink:href="13015_2019_151_Article_IEq78.gif"/></alternatives></inline-formula><italic>and if</italic><inline-formula id="IEq79"><alternatives><tex-math id="M145">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$T_i$$\end{document}</tex-math><mml:math id="M146"><mml:msub><mml:mi>T</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13015_2019_151_Article_IEq79.gif"/></alternatives></inline-formula><italic>agrees with</italic><inline-formula id="IEq80"><alternatives><tex-math id="M147">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$T^*$$\end{document}</tex-math><mml:math id="M148"><mml:msup><mml:mi>T</mml:mi><mml:mo>∗</mml:mo></mml:msup></mml:math><inline-graphic xlink:href="13015_2019_151_Article_IEq80.gif"/></alternatives></inline-formula><italic>for all</italic><inline-formula id="IEq81"><alternatives><tex-math id="M149">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$i \in \{1, \dots , k\}$$\end{document}</tex-math><mml:math id="M150"><mml:mrow><mml:mi>i</mml:mi><mml:mo>∈</mml:mo><mml:mo stretchy="false">{</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>⋯</mml:mo><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="13015_2019_151_Article_IEq81.gif"/></alternatives></inline-formula>, <italic>then NJMerge applied to input</italic><inline-formula id="IEq82"><alternatives><tex-math id="M151">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$({\mathcal {T}}, D)$$\end{document}</tex-math><mml:math id="M152"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="script">T</mml:mi><mml:mo>,</mml:mo><mml:mi>D</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="13015_2019_151_Article_IEq82.gif"/></alternatives></inline-formula><italic>returns</italic><inline-formula id="IEq83"><alternatives><tex-math id="M153">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$T^*$$\end{document}</tex-math><mml:math id="M154"><mml:msup><mml:mi>T</mml:mi><mml:mo>∗</mml:mo></mml:msup></mml:math><inline-graphic xlink:href="13015_2019_151_Article_IEq83.gif"/></alternatives></inline-formula>.</p>
      </sec>
      <sec id="FPar4">
        <title>
          <italic>Proof</italic>
        </title>
        <p id="Par28">NJ applied to a nearly additive distance matrix for <inline-formula id="IEq84"><alternatives><tex-math id="M155">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$T^*$$\end{document}</tex-math><mml:math id="M156"><mml:msup><mml:mi>T</mml:mi><mml:mo>∗</mml:mo></mml:msup></mml:math><inline-graphic xlink:href="13015_2019_151_Article_IEq84.gif"/></alternatives></inline-formula> will return <inline-formula id="IEq85"><alternatives><tex-math id="M157">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$T^*$$\end{document}</tex-math><mml:math id="M158"><mml:msup><mml:mi>T</mml:mi><mml:mo>∗</mml:mo></mml:msup></mml:math><inline-graphic xlink:href="13015_2019_151_Article_IEq85.gif"/></alternatives></inline-formula> [<xref ref-type="bibr" rid="CR37">37</xref>]. Because all trees in <inline-formula id="IEq86"><alternatives><tex-math id="M159">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathcal {T}}$$\end{document}</tex-math><mml:math id="M160"><mml:mi mathvariant="script">T</mml:mi></mml:math><inline-graphic xlink:href="13015_2019_151_Article_IEq86.gif"/></alternatives></inline-formula> agree with <inline-formula id="IEq87"><alternatives><tex-math id="M161">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$T^*$$\end{document}</tex-math><mml:math id="M162"><mml:msup><mml:mi>T</mml:mi><mml:mo>∗</mml:mo></mml:msup></mml:math><inline-graphic xlink:href="13015_2019_151_Article_IEq87.gif"/></alternatives></inline-formula>, the siblinghood proposals suggested by NJ will never violate the trees in <inline-formula id="IEq88"><alternatives><tex-math id="M163">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathcal {T}}$$\end{document}</tex-math><mml:math id="M164"><mml:mi mathvariant="script">T</mml:mi></mml:math><inline-graphic xlink:href="13015_2019_151_Article_IEq88.gif"/></alternatives></inline-formula> or the compatibility of <inline-formula id="IEq89"><alternatives><tex-math id="M165">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathcal {T}}$$\end{document}</tex-math><mml:math id="M166"><mml:mi mathvariant="script">T</mml:mi></mml:math><inline-graphic xlink:href="13015_2019_151_Article_IEq89.gif"/></alternatives></inline-formula>. Thus, NJMerge applied to <inline-formula id="IEq90"><alternatives><tex-math id="M167">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$({\mathcal {T}}, D)$$\end{document}</tex-math><mml:math id="M168"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="script">T</mml:mi><mml:mo>,</mml:mo><mml:mi>D</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="13015_2019_151_Article_IEq90.gif"/></alternatives></inline-formula> will return the same output as NJ applied to <italic>D</italic>, which is <inline-formula id="IEq91"><alternatives><tex-math id="M169">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$T^*$$\end{document}</tex-math><mml:math id="M170"><mml:msup><mml:mi>T</mml:mi><mml:mo>∗</mml:mo></mml:msup></mml:math><inline-graphic xlink:href="13015_2019_151_Article_IEq91.gif"/></alternatives></inline-formula>. <inline-formula id="IEq92"><alternatives><tex-math id="M171">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\square $$\end{document}</tex-math><mml:math id="M172"><mml:mo>□</mml:mo></mml:math><inline-graphic xlink:href="13015_2019_151_Article_IEq92.gif"/></alternatives></inline-formula></p>
        <p>We now define statistical consistency in the context of gene tree estimation (Definition <xref ref-type="sec" rid="FPar5">4</xref>) and show that NJMerge can be used to create statistically consistent divide-and-conquer pipelines for gene tree estimation (Corollary <xref ref-type="sec" rid="FPar6">5</xref>).</p>
      </sec>
      <sec id="FPar5">
        <title>
          <bold>Definition 4</bold>
        </title>
        <p id="Par30">Let <inline-formula id="IEq93"><alternatives><tex-math id="M173">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$(T,\Theta )$$\end{document}</tex-math><mml:math id="M174"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>T</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="normal">Θ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="13015_2019_151_Article_IEq93.gif"/></alternatives></inline-formula> be a GTR model tree with topology <italic>T</italic> and numerical parameters <inline-formula id="IEq94"><alternatives><tex-math id="M175">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\Theta $$\end{document}</tex-math><mml:math id="M176"><mml:mi mathvariant="normal">Θ</mml:mi></mml:math><inline-graphic xlink:href="13015_2019_151_Article_IEq94.gif"/></alternatives></inline-formula> (e.g., substitution rate matrix, branch lengths, etc). A method <italic>M</italic> for constructing gene trees from DNA sequences is <italic>statistically consistent</italic> under the GTR model if, for all <inline-formula id="IEq95"><alternatives><tex-math id="M177">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\epsilon &gt; 0$$\end{document}</tex-math><mml:math id="M178"><mml:mrow><mml:mi>ϵ</mml:mi><mml:mo>&gt;</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="13015_2019_151_Article_IEq95.gif"/></alternatives></inline-formula>, there exists a constant <inline-formula id="IEq96"><alternatives><tex-math id="M179">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$l&gt;0$$\end{document}</tex-math><mml:math id="M180"><mml:mrow><mml:mi>l</mml:mi><mml:mo>&gt;</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="13015_2019_151_Article_IEq96.gif"/></alternatives></inline-formula> such that, given sequences of length at least <italic>l</italic>, <italic>M</italic> returns <italic>T</italic> with probability at least <inline-formula id="IEq97"><alternatives><tex-math id="M181">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$1 - \epsilon $$\end{document}</tex-math><mml:math id="M182"><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mi>ϵ</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="13015_2019_151_Article_IEq97.gif"/></alternatives></inline-formula>.</p>
      </sec>
      <sec id="FPar6">
        <title>
          <bold>Corollary 5</bold>
        </title>
        <p id="Par31">
          <italic>NJMerge can be used in a gene tree estimation pipeline that is statistically consistent under the GTR model of sequence evolution.</italic>
        </p>
      </sec>
      <sec id="FPar7">
        <title>
          <italic>Proof</italic>
        </title>
        <p id="Par32">Let <inline-formula id="IEq98"><alternatives><tex-math id="M183">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$(T^*, \Theta )$$\end{document}</tex-math><mml:math id="M184"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>T</mml:mi><mml:mo>∗</mml:mo></mml:msup><mml:mo>,</mml:mo><mml:mi mathvariant="normal">Θ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="13015_2019_151_Article_IEq98.gif"/></alternatives></inline-formula> be a GTR model tree, let <inline-formula id="IEq99"><alternatives><tex-math id="M185">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$M_D$$\end{document}</tex-math><mml:math id="M186"><mml:msub><mml:mi>M</mml:mi><mml:mi>D</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13015_2019_151_Article_IEq99.gif"/></alternatives></inline-formula> be a method for calculating distances between pairs of sequences, and let <inline-formula id="IEq100"><alternatives><tex-math id="M187">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$M_T$$\end{document}</tex-math><mml:math id="M188"><mml:msub><mml:mi>M</mml:mi><mml:mi>T</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13015_2019_151_Article_IEq100.gif"/></alternatives></inline-formula> be a method for constructing trees from DNA sequences. Suppose that<list list-type="bullet"><list-item><p id="Par33">the divide-and-conquer pipeline produces <italic>k</italic> pairwise disjoint subsets of sequences</p></list-item><list-item><p id="Par34">Neighbor Joining (NJ) applied to a matrix of pairwise distances calculated using <inline-formula id="IEq101"><alternatives><tex-math id="M189">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$M_D$$\end{document}</tex-math><mml:math id="M190"><mml:msub><mml:mi>M</mml:mi><mml:mi>D</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13015_2019_151_Article_IEq101.gif"/></alternatives></inline-formula> is a statistically consistent method for constructing gene trees under the GTR model (e.g., the log-det distance [<xref ref-type="bibr" rid="CR16">16</xref>])</p></list-item><list-item><p id="Par35"><inline-formula id="IEq102"><alternatives><tex-math id="M191">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$M_T$$\end{document}</tex-math><mml:math id="M192"><mml:msub><mml:mi>M</mml:mi><mml:mi>T</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13015_2019_151_Article_IEq102.gif"/></alternatives></inline-formula> is statistically consistent under the GTR model (e.g., maximum likelihood [<xref ref-type="bibr" rid="CR42">42</xref>, <xref ref-type="bibr" rid="CR43">43</xref>])</p></list-item></list>Now let <inline-formula id="IEq103"><alternatives><tex-math id="M193">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\epsilon &gt; 0$$\end{document}</tex-math><mml:math id="M194"><mml:mrow><mml:mi>ϵ</mml:mi><mml:mo>&gt;</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="13015_2019_151_Article_IEq103.gif"/></alternatives></inline-formula>, and select <inline-formula id="IEq104"><alternatives><tex-math id="M195">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\epsilon _D, \epsilon _T &gt; 0$$\end{document}</tex-math><mml:math id="M196"><mml:mrow><mml:msub><mml:mi>ϵ</mml:mi><mml:mi>D</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>ϵ</mml:mi><mml:mi>T</mml:mi></mml:msub><mml:mo>&gt;</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="13015_2019_151_Article_IEq104.gif"/></alternatives></inline-formula> such that <inline-formula id="IEq105"><alternatives><tex-math id="M197">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\epsilon _D + k \epsilon _T &lt; \epsilon $$\end{document}</tex-math><mml:math id="M198"><mml:mrow><mml:msub><mml:mi>ϵ</mml:mi><mml:mi>D</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:mi>k</mml:mi><mml:msub><mml:mi>ϵ</mml:mi><mml:mi>T</mml:mi></mml:msub><mml:mo>&lt;</mml:mo><mml:mi>ϵ</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="13015_2019_151_Article_IEq105.gif"/></alternatives></inline-formula>. By Definition <xref ref-type="sec" rid="FPar5">4</xref>, there exists a constant <inline-formula id="IEq106"><alternatives><tex-math id="M199">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$l_D$$\end{document}</tex-math><mml:math id="M200"><mml:msub><mml:mi>l</mml:mi><mml:mi>D</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13015_2019_151_Article_IEq106.gif"/></alternatives></inline-formula> such that NJ applied to matrix <italic>D</italic> computed from sequences of length at least <inline-formula id="IEq107"><alternatives><tex-math id="M201">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$l_D$$\end{document}</tex-math><mml:math id="M202"><mml:msub><mml:mi>l</mml:mi><mml:mi>D</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13015_2019_151_Article_IEq107.gif"/></alternatives></inline-formula> returns <inline-formula id="IEq108"><alternatives><tex-math id="M203">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$T^*$$\end{document}</tex-math><mml:math id="M204"><mml:msup><mml:mi>T</mml:mi><mml:mo>∗</mml:mo></mml:msup></mml:math><inline-graphic xlink:href="13015_2019_151_Article_IEq108.gif"/></alternatives></inline-formula> with probability at least <inline-formula id="IEq109"><alternatives><tex-math id="M205">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$1 - \epsilon _D$$\end{document}</tex-math><mml:math id="M206"><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:msub><mml:mi>ϵ</mml:mi><mml:mi>D</mml:mi></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="13015_2019_151_Article_IEq109.gif"/></alternatives></inline-formula>, and there exists a constant <inline-formula id="IEq110"><alternatives><tex-math id="M207">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$l_T$$\end{document}</tex-math><mml:math id="M208"><mml:msub><mml:mi>l</mml:mi><mml:mi>T</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13015_2019_151_Article_IEq110.gif"/></alternatives></inline-formula> such that <inline-formula id="IEq111"><alternatives><tex-math id="M209">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$M_T$$\end{document}</tex-math><mml:math id="M210"><mml:msub><mml:mi>M</mml:mi><mml:mi>T</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13015_2019_151_Article_IEq111.gif"/></alternatives></inline-formula> given DNA sequences of length at least <inline-formula id="IEq112"><alternatives><tex-math id="M211">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$l_T$$\end{document}</tex-math><mml:math id="M212"><mml:msub><mml:mi>l</mml:mi><mml:mi>T</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13015_2019_151_Article_IEq112.gif"/></alternatives></inline-formula> returns <inline-formula id="IEq113"><alternatives><tex-math id="M213">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$T^*$$\end{document}</tex-math><mml:math id="M214"><mml:msup><mml:mi>T</mml:mi><mml:mo>∗</mml:mo></mml:msup></mml:math><inline-graphic xlink:href="13015_2019_151_Article_IEq113.gif"/></alternatives></inline-formula> with probability at least <inline-formula id="IEq114"><alternatives><tex-math id="M215">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$1 - \epsilon _T$$\end{document}</tex-math><mml:math id="M216"><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:msub><mml:mi>ϵ</mml:mi><mml:mi>T</mml:mi></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="13015_2019_151_Article_IEq114.gif"/></alternatives></inline-formula>. If a distance matrix <italic>D</italic> is calculated using <inline-formula id="IEq115"><alternatives><tex-math id="M217">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$M_D$$\end{document}</tex-math><mml:math id="M218"><mml:msub><mml:mi>M</mml:mi><mml:mi>D</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13015_2019_151_Article_IEq115.gif"/></alternatives></inline-formula> and a set <inline-formula id="IEq116"><alternatives><tex-math id="M219">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathcal {T}}$$\end{document}</tex-math><mml:math id="M220"><mml:mi mathvariant="script">T</mml:mi></mml:math><inline-graphic xlink:href="13015_2019_151_Article_IEq116.gif"/></alternatives></inline-formula> of <italic>k</italic> constraint trees are constructed using <inline-formula id="IEq117"><alternatives><tex-math id="M221">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$M_T$$\end{document}</tex-math><mml:math id="M222"><mml:msub><mml:mi>M</mml:mi><mml:mi>T</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13015_2019_151_Article_IEq117.gif"/></alternatives></inline-formula>, given sequences of length at least <inline-formula id="IEq118"><alternatives><tex-math id="M223">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\max \{l_D, l_T\}$$\end{document}</tex-math><mml:math id="M224"><mml:mrow><mml:mo movablelimits="true">max</mml:mo><mml:mo stretchy="false">{</mml:mo><mml:msub><mml:mi>l</mml:mi><mml:mi>D</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>l</mml:mi><mml:mi>T</mml:mi></mml:msub><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="13015_2019_151_Article_IEq118.gif"/></alternatives></inline-formula>, then the probability that NJ applied to <italic>D</italic> returns <inline-formula id="IEq119"><alternatives><tex-math id="M225">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$T^*$$\end{document}</tex-math><mml:math id="M226"><mml:msup><mml:mi>T</mml:mi><mml:mo>∗</mml:mo></mml:msup></mml:math><inline-graphic xlink:href="13015_2019_151_Article_IEq119.gif"/></alternatives></inline-formula> and that <inline-formula id="IEq120"><alternatives><tex-math id="M227">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$M_T$$\end{document}</tex-math><mml:math id="M228"><mml:msub><mml:mi>M</mml:mi><mml:mi>T</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13015_2019_151_Article_IEq120.gif"/></alternatives></inline-formula> returns a tree that agrees with <inline-formula id="IEq121"><alternatives><tex-math id="M229">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$T^*$$\end{document}</tex-math><mml:math id="M230"><mml:msup><mml:mi>T</mml:mi><mml:mo>∗</mml:mo></mml:msup></mml:math><inline-graphic xlink:href="13015_2019_151_Article_IEq121.gif"/></alternatives></inline-formula> for all <italic>k</italic> constraint trees in <inline-formula id="IEq122"><alternatives><tex-math id="M231">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathcal {T}}$$\end{document}</tex-math><mml:math id="M232"><mml:mi mathvariant="script">T</mml:mi></mml:math><inline-graphic xlink:href="13015_2019_151_Article_IEq122.gif"/></alternatives></inline-formula> is at least <inline-formula id="IEq123"><alternatives><tex-math id="M233">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$1 - \epsilon $$\end{document}</tex-math><mml:math id="M234"><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mi>ϵ</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="13015_2019_151_Article_IEq123.gif"/></alternatives></inline-formula>, as<disp-formula id="Equ2"><alternatives><tex-math id="M235">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} (1 - \epsilon _D) (1 - \epsilon _T)^k&amp;\ge (1 - \epsilon _D) (1 - k \epsilon _T) \quad \text {by Bernoulli's Inequality [45]} \\&amp;= 1 - \epsilon _D - k \epsilon _T + k \epsilon _D \epsilon _T \\&amp;&gt; 1 - (\epsilon _D + k \epsilon _T) &gt; 1 - \epsilon \end{aligned}$$\end{document}</tex-math><mml:math id="M236" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:msub><mml:mi>ϵ</mml:mi><mml:mi>D</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:msub><mml:mi>ϵ</mml:mi><mml:mi>T</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mi>k</mml:mi></mml:msup></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>≥</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:msub><mml:mi>ϵ</mml:mi><mml:mi>D</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mi>k</mml:mi><mml:msub><mml:mi>ϵ</mml:mi><mml:mi>T</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mspace width="1em"/><mml:mtext>by Bernoulli's Inequality [45]</mml:mtext></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow/></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:msub><mml:mi>ϵ</mml:mi><mml:mi>D</mml:mi></mml:msub><mml:mo>-</mml:mo><mml:mi>k</mml:mi><mml:msub><mml:mi>ϵ</mml:mi><mml:mi>T</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:mi>k</mml:mi><mml:msub><mml:mi>ϵ</mml:mi><mml:mi>D</mml:mi></mml:msub><mml:msub><mml:mi>ϵ</mml:mi><mml:mi>T</mml:mi></mml:msub></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow/></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>&gt;</mml:mo><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>ϵ</mml:mi><mml:mi>D</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:mi>k</mml:mi><mml:msub><mml:mi>ϵ</mml:mi><mml:mi>T</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>&gt;</mml:mo><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mi>ϵ</mml:mi></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="13015_2019_151_Article_Equ2.gif" position="anchor"/></alternatives></disp-formula>Then, by Theorem <xref ref-type="sec" rid="FPar3">3</xref>, NJMerge applied to the input <inline-formula id="IEq124"><alternatives><tex-math id="M237">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$({\mathcal {T}}, D)$$\end{document}</tex-math><mml:math id="M238"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="script">T</mml:mi><mml:mo>,</mml:mo><mml:mi>D</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="13015_2019_151_Article_IEq124.gif"/></alternatives></inline-formula> will return the <inline-formula id="IEq125"><alternatives><tex-math id="M239">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$T^*$$\end{document}</tex-math><mml:math id="M240"><mml:msup><mml:mi>T</mml:mi><mml:mo>∗</mml:mo></mml:msup></mml:math><inline-graphic xlink:href="13015_2019_151_Article_IEq125.gif"/></alternatives></inline-formula> with probability at least <inline-formula id="IEq126"><alternatives><tex-math id="M241">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$1 - \epsilon $$\end{document}</tex-math><mml:math id="M242"><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mi>ϵ</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="13015_2019_151_Article_IEq126.gif"/></alternatives></inline-formula>, and by Definition <xref ref-type="sec" rid="FPar5">4</xref>, NJMerge is statistically consistent under the GTR model. <inline-formula id="IEq127"><alternatives><tex-math id="M243">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\square $$\end{document}</tex-math><mml:math id="M244"><mml:mo>□</mml:mo></mml:math><inline-graphic xlink:href="13015_2019_151_Article_IEq127.gif"/></alternatives></inline-formula></p>
        <p>Finally, we define statistical consistency in the context of species tree estimation (Definition <xref ref-type="sec" rid="FPar9">7</xref>) and show that NJMerge can be used to create statistically consistent divide-and-conquer pipelines for species estimation (Corollary <xref ref-type="sec" rid="FPar9">7</xref>).</p>
      </sec>
      <sec id="FPar8">
        <title>
          <bold>Definition 6</bold>
        </title>
        <p id="Par37">Let <inline-formula id="IEq128"><alternatives><tex-math id="M245">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$(T,\Theta )$$\end{document}</tex-math><mml:math id="M246"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>T</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="normal">Θ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="13015_2019_151_Article_IEq128.gif"/></alternatives></inline-formula> be an MSC model tree with topology <italic>T</italic> and numerical parameters <inline-formula id="IEq129"><alternatives><tex-math id="M247">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\Theta $$\end{document}</tex-math><mml:math id="M248"><mml:mi mathvariant="normal">Θ</mml:mi></mml:math><inline-graphic xlink:href="13015_2019_151_Article_IEq129.gif"/></alternatives></inline-formula> (e.g., substitution rate matrix, branch lengths, etc). A method <italic>M</italic> for constructing species trees from true gene trees is <italic>statistically consistent</italic> under the MSC model if, for all <inline-formula id="IEq130"><alternatives><tex-math id="M249">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\epsilon &gt; 0$$\end{document}</tex-math><mml:math id="M250"><mml:mrow><mml:mi>ϵ</mml:mi><mml:mo>&gt;</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="13015_2019_151_Article_IEq130.gif"/></alternatives></inline-formula>, there exists a constant <inline-formula id="IEq131"><alternatives><tex-math id="M251">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$m&gt;0$$\end{document}</tex-math><mml:math id="M252"><mml:mrow><mml:mi>m</mml:mi><mml:mo>&gt;</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="13015_2019_151_Article_IEq131.gif"/></alternatives></inline-formula> such that, given at least <italic>m</italic> true gene trees, <italic>M</italic> returns <italic>T</italic> with probability at least <inline-formula id="IEq132"><alternatives><tex-math id="M253">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$1 - \epsilon $$\end{document}</tex-math><mml:math id="M254"><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mi>ϵ</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="13015_2019_151_Article_IEq132.gif"/></alternatives></inline-formula>.</p>
      </sec>
      <sec id="FPar9">
        <title>
          <bold>Corollary 7</bold>
        </title>
        <p id="Par38">
          <italic>NJMerge can be used in a species tree estimation pipeline that is statistically consistent under the MSC model.</italic>
        </p>
      </sec>
      <sec id="FPar10">
        <title>
          <italic>Proof</italic>
        </title>
        <p id="Par39">Let <inline-formula id="IEq133"><alternatives><tex-math id="M255">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$(T^*, \Theta )$$\end{document}</tex-math><mml:math id="M256"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>T</mml:mi><mml:mo>∗</mml:mo></mml:msup><mml:mo>,</mml:mo><mml:mi mathvariant="normal">Θ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="13015_2019_151_Article_IEq133.gif"/></alternatives></inline-formula> be an MSC model tree, let <inline-formula id="IEq134"><alternatives><tex-math id="M257">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$M_D$$\end{document}</tex-math><mml:math id="M258"><mml:msub><mml:mi>M</mml:mi><mml:mi>D</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13015_2019_151_Article_IEq134.gif"/></alternatives></inline-formula> be a method for calculating distances between pairs of species from a set of gene trees, and let <inline-formula id="IEq135"><alternatives><tex-math id="M259">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$M_T$$\end{document}</tex-math><mml:math id="M260"><mml:msub><mml:mi>M</mml:mi><mml:mi>T</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13015_2019_151_Article_IEq135.gif"/></alternatives></inline-formula> be a method for constructing species trees from a set of gene trees. Suppose that<list list-type="bullet"><list-item><p id="Par40">the divide-and-conquer pipeline produces <italic>k</italic> pairwise disjoint subsets of sequences</p></list-item><list-item><p id="Par41">Neighbor Joining (NJ) applied to a matrix of pairwise distances calculated using <inline-formula id="IEq136"><alternatives><tex-math id="M261">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$M_D$$\end{document}</tex-math><mml:math id="M262"><mml:msub><mml:mi>M</mml:mi><mml:mi>D</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13015_2019_151_Article_IEq136.gif"/></alternatives></inline-formula> is a statistically consistent method for constructing species trees under the MSC model (e.g., the average topological distance between species in the input set of gene trees [<xref ref-type="bibr" rid="CR40">40</xref>])</p></list-item><list-item><p id="Par42"><inline-formula id="IEq137"><alternatives><tex-math id="M263">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$M_T$$\end{document}</tex-math><mml:math id="M264"><mml:msub><mml:mi>M</mml:mi><mml:mi>T</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13015_2019_151_Article_IEq137.gif"/></alternatives></inline-formula> is statistically consistent under the MSC model (e.g., ASTRAL [<xref ref-type="bibr" rid="CR11">11</xref>, <xref ref-type="bibr" rid="CR45">45</xref>])</p></list-item></list>Now let <inline-formula id="IEq138"><alternatives><tex-math id="M265">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\epsilon &gt; 0$$\end{document}</tex-math><mml:math id="M266"><mml:mrow><mml:mi>ϵ</mml:mi><mml:mo>&gt;</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="13015_2019_151_Article_IEq138.gif"/></alternatives></inline-formula>, and select <inline-formula id="IEq139"><alternatives><tex-math id="M267">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\epsilon _D, \epsilon _T &gt; 0$$\end{document}</tex-math><mml:math id="M268"><mml:mrow><mml:msub><mml:mi>ϵ</mml:mi><mml:mi>D</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>ϵ</mml:mi><mml:mi>T</mml:mi></mml:msub><mml:mo>&gt;</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="13015_2019_151_Article_IEq139.gif"/></alternatives></inline-formula> such that <inline-formula id="IEq140"><alternatives><tex-math id="M269">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\epsilon _D + k \epsilon _T &lt; \epsilon $$\end{document}</tex-math><mml:math id="M270"><mml:mrow><mml:msub><mml:mi>ϵ</mml:mi><mml:mi>D</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:mi>k</mml:mi><mml:msub><mml:mi>ϵ</mml:mi><mml:mi>T</mml:mi></mml:msub><mml:mo>&lt;</mml:mo><mml:mi>ϵ</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="13015_2019_151_Article_IEq140.gif"/></alternatives></inline-formula>. By Definition <xref ref-type="sec" rid="FPar8">6</xref>, there exists a constant <inline-formula id="IEq141"><alternatives><tex-math id="M271">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$m_D$$\end{document}</tex-math><mml:math id="M272"><mml:msub><mml:mi>m</mml:mi><mml:mi>D</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13015_2019_151_Article_IEq141.gif"/></alternatives></inline-formula> such that NJ applied to matrix <italic>D</italic> computed from at least <inline-formula id="IEq142"><alternatives><tex-math id="M273">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$m_D$$\end{document}</tex-math><mml:math id="M274"><mml:msub><mml:mi>m</mml:mi><mml:mi>D</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13015_2019_151_Article_IEq142.gif"/></alternatives></inline-formula> gene trees returns <inline-formula id="IEq143"><alternatives><tex-math id="M275">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$T^*$$\end{document}</tex-math><mml:math id="M276"><mml:msup><mml:mi>T</mml:mi><mml:mo>∗</mml:mo></mml:msup></mml:math><inline-graphic xlink:href="13015_2019_151_Article_IEq143.gif"/></alternatives></inline-formula> with probability at least <inline-formula id="IEq144"><alternatives><tex-math id="M277">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$1 - \epsilon _D$$\end{document}</tex-math><mml:math id="M278"><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:msub><mml:mi>ϵ</mml:mi><mml:mi>D</mml:mi></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="13015_2019_151_Article_IEq144.gif"/></alternatives></inline-formula>, and there exists a constant <inline-formula id="IEq145"><alternatives><tex-math id="M279">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$m_T$$\end{document}</tex-math><mml:math id="M280"><mml:msub><mml:mi>m</mml:mi><mml:mi>T</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13015_2019_151_Article_IEq145.gif"/></alternatives></inline-formula> such that <inline-formula id="IEq146"><alternatives><tex-math id="M281">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$M_T$$\end{document}</tex-math><mml:math id="M282"><mml:msub><mml:mi>M</mml:mi><mml:mi>T</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13015_2019_151_Article_IEq146.gif"/></alternatives></inline-formula> given at least <inline-formula id="IEq147"><alternatives><tex-math id="M283">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$m_T$$\end{document}</tex-math><mml:math id="M284"><mml:msub><mml:mi>m</mml:mi><mml:mi>T</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13015_2019_151_Article_IEq147.gif"/></alternatives></inline-formula> gene trees returns <inline-formula id="IEq148"><alternatives><tex-math id="M285">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$T^*$$\end{document}</tex-math><mml:math id="M286"><mml:msup><mml:mi>T</mml:mi><mml:mo>∗</mml:mo></mml:msup></mml:math><inline-graphic xlink:href="13015_2019_151_Article_IEq148.gif"/></alternatives></inline-formula> with probability at least <inline-formula id="IEq149"><alternatives><tex-math id="M287">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$1 - \epsilon _T$$\end{document}</tex-math><mml:math id="M288"><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:msub><mml:mi>ϵ</mml:mi><mml:mi>T</mml:mi></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="13015_2019_151_Article_IEq149.gif"/></alternatives></inline-formula>. If a distance matrix <italic>D</italic> is calculated using <inline-formula id="IEq150"><alternatives><tex-math id="M289">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$M_D$$\end{document}</tex-math><mml:math id="M290"><mml:msub><mml:mi>M</mml:mi><mml:mi>D</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13015_2019_151_Article_IEq150.gif"/></alternatives></inline-formula> and a set <inline-formula id="IEq151"><alternatives><tex-math id="M291">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathcal {T}}$$\end{document}</tex-math><mml:math id="M292"><mml:mi mathvariant="script">T</mml:mi></mml:math><inline-graphic xlink:href="13015_2019_151_Article_IEq151.gif"/></alternatives></inline-formula> of <italic>k</italic> constraint trees are constructed using <inline-formula id="IEq152"><alternatives><tex-math id="M293">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$M_T$$\end{document}</tex-math><mml:math id="M294"><mml:msub><mml:mi>M</mml:mi><mml:mi>T</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13015_2019_151_Article_IEq152.gif"/></alternatives></inline-formula>, both given at least <inline-formula id="IEq153"><alternatives><tex-math id="M295">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\max \{m_D, m_T\}$$\end{document}</tex-math><mml:math id="M296"><mml:mrow><mml:mo movablelimits="true">max</mml:mo><mml:mo stretchy="false">{</mml:mo><mml:msub><mml:mi>m</mml:mi><mml:mi>D</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>m</mml:mi><mml:mi>T</mml:mi></mml:msub><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="13015_2019_151_Article_IEq153.gif"/></alternatives></inline-formula> gene trees, then the probability that NJ applied to <italic>D</italic> returns <inline-formula id="IEq154"><alternatives><tex-math id="M297">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$T^*$$\end{document}</tex-math><mml:math id="M298"><mml:msup><mml:mi>T</mml:mi><mml:mo>∗</mml:mo></mml:msup></mml:math><inline-graphic xlink:href="13015_2019_151_Article_IEq154.gif"/></alternatives></inline-formula> and that <inline-formula id="IEq155"><alternatives><tex-math id="M299">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$M_T$$\end{document}</tex-math><mml:math id="M300"><mml:msub><mml:mi>M</mml:mi><mml:mi>T</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13015_2019_151_Article_IEq155.gif"/></alternatives></inline-formula> returns a tree that agree with <inline-formula id="IEq156"><alternatives><tex-math id="M301">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$T^*$$\end{document}</tex-math><mml:math id="M302"><mml:msup><mml:mi>T</mml:mi><mml:mo>∗</mml:mo></mml:msup></mml:math><inline-graphic xlink:href="13015_2019_151_Article_IEq156.gif"/></alternatives></inline-formula> for all <italic>k</italic> constraint trees in <inline-formula id="IEq157"><alternatives><tex-math id="M303">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathcal {T}}$$\end{document}</tex-math><mml:math id="M304"><mml:mi mathvariant="script">T</mml:mi></mml:math><inline-graphic xlink:href="13015_2019_151_Article_IEq157.gif"/></alternatives></inline-formula> is at least <inline-formula id="IEq158"><alternatives><tex-math id="M305">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$1 - \epsilon $$\end{document}</tex-math><mml:math id="M306"><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mi>ϵ</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="13015_2019_151_Article_IEq158.gif"/></alternatives></inline-formula>. Then, by Theorem <xref ref-type="sec" rid="FPar3">3</xref>, NJMerge applied to the input <inline-formula id="IEq159"><alternatives><tex-math id="M307">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$({\mathcal {T}}, D)$$\end{document}</tex-math><mml:math id="M308"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="script">T</mml:mi><mml:mo>,</mml:mo><mml:mi>D</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="13015_2019_151_Article_IEq159.gif"/></alternatives></inline-formula> will return the <inline-formula id="IEq160"><alternatives><tex-math id="M309">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$T^*$$\end{document}</tex-math><mml:math id="M310"><mml:msup><mml:mi>T</mml:mi><mml:mo>∗</mml:mo></mml:msup></mml:math><inline-graphic xlink:href="13015_2019_151_Article_IEq160.gif"/></alternatives></inline-formula> with probability at least <inline-formula id="IEq161"><alternatives><tex-math id="M311">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$1 - \epsilon $$\end{document}</tex-math><mml:math id="M312"><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mi>ϵ</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="13015_2019_151_Article_IEq161.gif"/></alternatives></inline-formula>, and by Definition <xref ref-type="sec" rid="FPar8">6</xref>, NJMerge is statistically consistent under the MSC model. <inline-formula id="IEq162"><alternatives><tex-math id="M313">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\square $$\end{document}</tex-math><mml:math id="M314"><mml:mo>□</mml:mo></mml:math><inline-graphic xlink:href="13015_2019_151_Article_IEq162.gif"/></alternatives></inline-formula></p>
      </sec>
    </sec>
  </sec>
  <sec id="Sec5">
    <title>Performance study</title>
    <p id="Par43">Our study evaluated the effectiveness of using NJMerge to estimate species trees on large multi-locus datasets, simulated for this study using the protocol presented in [<xref ref-type="bibr" rid="CR45">45</xref>]. Our simulation produced model conditions, described by two numbers of taxa (100 and 1000) and two levels of ILS (low/moderate and very high), each with 20 replicate datasets. Datasets included both exon-like sequences and intron-like sequences with exon-like sequences (“exons”) characterized by slower rates of evolution across sites (less phylogenetic signal) and intron-like sequences (“introns”) characterized by faster rates of evolution across sites (greater phylogenetic signal). The 100-taxon datasets were analyzed using 25, 100, and 1000 genes, and the 1000-taxon datasets were analyzed using 1000 genes; note that exons and introns were always analyzed separately. For each of these 320 datasets, we constructed distance matrices using two different methods and constraint trees using four different methods. This provided 2560 different tests on which to evaluate NJMerge. NJMerge failed on 11/2560 tests, so the failure rate (in our experiments) was less than 1%. Species tree methods were evaluated in terms of species tree estimation error (computed using normalized Robinson–Foulds (RF) distances [<xref ref-type="bibr" rid="CR46">46</xref>]) and running time. All software commands are provided in Additional file <xref rid="MOESM1" ref-type="media">1</xref>.</p>
    <sec id="Sec6">
      <title>Simulated datasets</title>
      <sec id="Sec7">
        <title>True species and true gene trees</title>
        <p id="Par44">Datasets, each with a true species tree and 2000 true gene trees, were simulated using SimPhy version 1.0.2 [<xref ref-type="bibr" rid="CR47">47</xref>]. All model conditions had deep speciation (towards the root) and 20 replicate datasets. By holding the effective population size constant (200K) and varying the species tree height (in generations), model conditions with different levels of ILS were generated. For species tree heights of 10M and 500K generations, the average distance between the true species tree and the true gene trees (as measured by the normalized RF distance) was 8–10% and 68–69% respectively. Thus, we referred to these levels of ILS as “low/moderate” and “very high” respectively.</p>
      </sec>
      <sec id="Sec8">
        <title>True sequence alignments</title>
        <p id="Par45">Sequence alignments were simulated for each true gene tree using INDELible version 1.03 [<xref ref-type="bibr" rid="CR48">48</xref>] under the GTR+<inline-formula id="IEq163"><alternatives><tex-math id="M315">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\Gamma $$\end{document}</tex-math><mml:math id="M316"><mml:mi mathvariant="normal">Γ</mml:mi></mml:math><inline-graphic xlink:href="13015_2019_151_Article_IEq163.gif"/></alternatives></inline-formula> model of evolution without insertions or deletions. For each gene, the parameters for the GTR+<inline-formula id="IEq164"><alternatives><tex-math id="M317">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\Gamma $$\end{document}</tex-math><mml:math id="M318"><mml:mi mathvariant="normal">Γ</mml:mi></mml:math><inline-graphic xlink:href="13015_2019_151_Article_IEq164.gif"/></alternatives></inline-formula> model of evolution (base frequencies, substitution rates, and alpha) were drawn from distributions based on estimates of these parameters from the Avian Phylogenomics Dataset [<xref ref-type="bibr" rid="CR49">49</xref>]; distributions were fitted for exons and introns, separately (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S1). For each dataset (with 2000 genes), 1000 gene sequences were simulated with parameters drawn from the exon distributions, and 1000 gene sequences were simulated with parameters drawn from the intron distributions. Note that exons and introns were analyzed separately. The sequence lengths were also drawn from a distribution (varying from 300 to 1500 bp).</p>
      </sec>
      <sec id="Sec9">
        <title>Estimated gene trees</title>
        <p id="Par46">Maximum likelihood gene trees were estimated using FastTree-2 [<xref ref-type="bibr" rid="CR50">50</xref>] under the GTR+CAT model of evolution. The average gene tree estimation error across all replicate datasets ranged from 26 to 51% for introns and 38 to 64% for exons and thus was higher for exon datasets (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S2). Note that gene tree estimation error was computed by the normalized symmetric difference between true and estimated gene trees, averaged across all gene trees (the normalized symmetric difference equals the normalized RF distance when both input trees are binary).</p>
      </sec>
    </sec>
    <sec id="Sec10">
      <title>Estimated species trees</title>
      <p id="Par47">For each model condition (described by number of taxa and level of ILS), species trees estimation methods were run on the exon-like genes and the intron-like genes, separately. Species trees were estimated on 25, 100, or 1000 genes for the 100-taxon datasets and 1000 genes for the 1000-taxon datasets using three species tree estimation methods: ASTRAL-III [<xref ref-type="bibr" rid="CR11">11</xref>, <xref ref-type="bibr" rid="CR30">30</xref>, <xref ref-type="bibr" rid="CR45">45</xref>] (as implemented in version 5.6.1), SVDquartets [<xref ref-type="bibr" rid="CR13">13</xref>] (as implemented in PAUP* version 4a161 [<xref ref-type="bibr" rid="CR51">51</xref>]), and concatenation using unpartitioned maximum likelihood under the GTR+<inline-formula id="IEq165"><alternatives><tex-math id="M319">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\Gamma $$\end{document}</tex-math><mml:math id="M320"><mml:mi mathvariant="normal">Γ</mml:mi></mml:math><inline-graphic xlink:href="13015_2019_151_Article_IEq165.gif"/></alternatives></inline-formula> model of evolution (as implemented in RAxML [<xref ref-type="bibr" rid="CR31">31</xref>] version 8.2.12 with pthreads and SSE3).</p>
    </sec>
    <sec id="Sec11">
      <title>NJMerge</title>
      <sec id="Sec12">
        <title>Distance matrices</title>
        <p id="Par48">Distance matrices were created using two different approaches.<list list-type="bullet"><list-item><p id="Par49"><inline-formula id="IEq166"><alternatives><tex-math id="M321">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$D_{AGID}$$\end{document}</tex-math><mml:math id="M322"><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:mi mathvariant="italic">AGID</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13015_2019_151_Article_IEq166.gif"/></alternatives></inline-formula> refers to the average gene tree internode distance (AGID) matrix [<xref ref-type="bibr" rid="CR9">9</xref>], computed from estimated gene trees using ASTRID [<xref ref-type="bibr" rid="CR41">41</xref>] version 1.1.</p></list-item><list-item><p id="Par50"><inline-formula id="IEq167"><alternatives><tex-math id="M323">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$D_{LD}$$\end{document}</tex-math><mml:math id="M324"><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:mi mathvariant="italic">LD</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13015_2019_151_Article_IEq167.gif"/></alternatives></inline-formula> refers to the log-det distance matrix [<xref ref-type="bibr" rid="CR16">16</xref>], computed from concatenated alignment using PAUP* [<xref ref-type="bibr" rid="CR51">51</xref>] version 4a163.</p></list-item></list>Recall that NJ applied to the AGID matrix (i.e., NJst [<xref ref-type="bibr" rid="CR9">9</xref>]) was proven to be statistically consistent method under the MSC model [<xref ref-type="bibr" rid="CR40">40</xref>] and that NJ applied to the log-det distance matrix was proven to be statistically consistent under the MSC model when the sequence evolution models across genes satisfy some additional assumptions (e.g., a relaxed molecular clock) [<xref ref-type="bibr" rid="CR18">18</xref>].</p>
      </sec>
      <sec id="Sec13">
        <title>Subset decomposition</title>
        <p id="Par51">We decomposed the species set into subsets as indicated by the blue dashed arrows in Fig. <xref rid="Fig4" ref-type="fig">4</xref>. Specifically, the NJ tree was computed for each distance matrix using FastME [<xref ref-type="bibr" rid="CR52">52</xref>] version 2.1.5 and then the centroid tree decomposition (described in PASTA [<xref ref-type="bibr" rid="CR35">35</xref>]) was used to create disjoint subsets of taxa from the NJ tree. Datasets with 100 species were decomposed into 4–6 subsets with a maximum subset size of 30 taxa, and datasets with 1000 species were decomposed into 10–15 subsets with a maximum subset size of 120 taxa.</p>
      </sec>
      <sec id="Sec14">
        <title>Constraint trees</title>
        <p id="Par52">Constraint trees were created using four different approaches.<list list-type="bullet"><list-item><p id="Par53"><inline-formula id="IEq168"><alternatives><tex-math id="M325">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathcal {T}}_{true}$$\end{document}</tex-math><mml:math id="M326"><mml:msub><mml:mi mathvariant="script">T</mml:mi><mml:mrow><mml:mi mathvariant="italic">true</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13015_2019_151_Article_IEq168.gif"/></alternatives></inline-formula> refers to constraint trees computed by restricting the true species tree to each subset of species.</p></list-item><list-item><p id="Par54"><inline-formula id="IEq169"><alternatives><tex-math id="M327">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathcal {T}}_{AST}$$\end{document}</tex-math><mml:math id="M328"><mml:msub><mml:mi mathvariant="script">T</mml:mi><mml:mrow><mml:mi mathvariant="italic">AST</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13015_2019_151_Article_IEq169.gif"/></alternatives></inline-formula> refers to constraint trees computed by running ASTRAL-III on each subset, i.e., on the estimated gene trees restricted to each subset of species.</p></list-item><list-item><p id="Par55"><inline-formula id="IEq170"><alternatives><tex-math id="M329">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathcal {T}}_{SVD}$$\end{document}</tex-math><mml:math id="M330"><mml:msub><mml:mi mathvariant="script">T</mml:mi><mml:mrow><mml:mi mathvariant="italic">SVD</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13015_2019_151_Article_IEq170.gif"/></alternatives></inline-formula> refers to constraint trees computed by running SVDquartets on each subset, i.e., on the concatenated alignment restricted to each subset of species.</p></list-item><list-item><p id="Par56"><inline-formula id="IEq171"><alternatives><tex-math id="M331">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathcal {T}}_{RAX}$$\end{document}</tex-math><mml:math id="M332"><mml:msub><mml:mi mathvariant="script">T</mml:mi><mml:mrow><mml:mi mathvariant="italic">RAX</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13015_2019_151_Article_IEq171.gif"/></alternatives></inline-formula> refers to constraint trees computed by running RAxML on each subset, i.e., on the concatenated alignment restricted to each subset of species.</p></list-item></list>
</p>
      </sec>
      <sec id="Sec15">
        <title>Notation</title>
        <p id="Par57">We often specify the inputs to NJ and NJMerge using the following notation: NJ(<italic>D</italic>) and NJMerge(<inline-formula id="IEq172"><alternatives><tex-math id="M333">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathcal {T}}$$\end{document}</tex-math><mml:math id="M334"><mml:mi mathvariant="script">T</mml:mi></mml:math><inline-graphic xlink:href="13015_2019_151_Article_IEq172.gif"/></alternatives></inline-formula>, <italic>D</italic>). For example, NJMerge(<inline-formula id="IEq173"><alternatives><tex-math id="M335">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathcal {T}}_{RAX}$$\end{document}</tex-math><mml:math id="M336"><mml:msub><mml:mi mathvariant="script">T</mml:mi><mml:mrow><mml:mi mathvariant="italic">RAX</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13015_2019_151_Article_IEq173.gif"/></alternatives></inline-formula>, <inline-formula id="IEq174"><alternatives><tex-math id="M337">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$D_{LD}$$\end{document}</tex-math><mml:math id="M338"><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:mi mathvariant="italic">LD</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13015_2019_151_Article_IEq174.gif"/></alternatives></inline-formula>) refers to NJMerge given the RAxML constraint trees and the log-det distance matrix as input, whereas NJMerge(<inline-formula id="IEq175"><alternatives><tex-math id="M339">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathcal {T}}_{RAX}$$\end{document}</tex-math><mml:math id="M340"><mml:msub><mml:mi mathvariant="script">T</mml:mi><mml:mrow><mml:mi mathvariant="italic">RAX</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13015_2019_151_Article_IEq175.gif"/></alternatives></inline-formula>, <italic>D</italic>) refers to NJMerge given the RAxML constraint trees and <italic>either</italic> the AGID <italic>or</italic> the log-det distance matrix as input.</p>
      </sec>
    </sec>
    <sec id="Sec16">
      <title>Evaluation</title>
      <sec id="Sec17">
        <title>Species tree estimation error</title>
        <p id="Par58">Species tree estimation error was measured as the RF error rate, i.e., the normalized RF distance between the true and the estimated species trees both on the full species set. Since both trees were fully resolved or binary, the RF error rate is the proportion of edges in the true tree that are missing in the estimated tree. RF error rates were computed using Dendropy [<xref ref-type="bibr" rid="CR53">53</xref>].</p>
      </sec>
      <sec id="Sec18">
        <title>Running time</title>
        <p id="Par59">All computational experiments were run on the Blue Waters supercomputer, specifically, the XE6 dual-socket nodes with 64 GB of physical memory and two AMD Interlagos model 6276 CPU processors (i.e., one per socket each with 8 floating-point cores). All methods were given access to 16 threads with 1 thread per bulldozer (floating-point) core. SVDquartets and RAxML were explicitly run with 16 threads; however, ASTRAL-III and NJMerge were not implemented with multi-threading at the time of this study. All methods were restricted to a maximum wall-clock time of 48 h.</p>
        <p id="Par60">Running time was measured as the wall-clock time and recorded in seconds for all methods. For ASTRAL, SVDquartets, and RAxML, the timing data was recorded for running the method on the full dataset as well as running the method on subsets of the dataset (to produce constraint trees for NJMerge). RAxML did not complete within the maximum wall-clock time of 48 h on datasets with 1000 taxa, so we used the last checkpoint file to evaluate species tree estimation error and running time. Specifically, running time was measured as the time between the info file being written and the last checkpoint file being written.</p>
        <p id="Par61">We approximated total running time of the NJMerge pipeline by combining the running timing data for estimating the distance matrix, estimating the subset trees, and combining the subset trees using NJMerge. If a user only had access to one compute node, then subset trees would need to be estimated in serial. In this case, the running time of the NJMerge pipeline <inline-formula id="IEq176"><alternatives><tex-math id="M341">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$t_P$$\end{document}</tex-math><mml:math id="M342"><mml:msub><mml:mi>t</mml:mi><mml:mi>P</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13015_2019_151_Article_IEq176.gif"/></alternatives></inline-formula> would be approximated as<disp-formula id="Equ1"><label>1</label><alternatives><tex-math id="M343">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} t_P = t_D + \sum _{i=1}^k t_T(i) + t_M \end{aligned}$$\end{document}</tex-math><mml:math id="M344" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mi>P</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mi>D</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>k</mml:mi></mml:munderover><mml:msub><mml:mi>t</mml:mi><mml:mi>T</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mi>M</mml:mi></mml:msub></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="13015_2019_151_Article_Equ1.gif" position="anchor"/></alternatives></disp-formula>where <italic>k</italic> is the number of subsets, <inline-formula id="IEq177"><alternatives><tex-math id="M345">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$t_D$$\end{document}</tex-math><mml:math id="M346"><mml:msub><mml:mi>t</mml:mi><mml:mi>D</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13015_2019_151_Article_IEq177.gif"/></alternatives></inline-formula> is time to estimate a distance matrix with method <inline-formula id="IEq178"><alternatives><tex-math id="M347">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$M_D$$\end{document}</tex-math><mml:math id="M348"><mml:msub><mml:mi>M</mml:mi><mml:mi>D</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13015_2019_151_Article_IEq178.gif"/></alternatives></inline-formula>, <inline-formula id="IEq179"><alternatives><tex-math id="M349">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$t_T(i)$$\end{document}</tex-math><mml:math id="M350"><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mi>T</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="13015_2019_151_Article_IEq179.gif"/></alternatives></inline-formula> is the time to estimate a species tree on subset <italic>i</italic> with method <inline-formula id="IEq180"><alternatives><tex-math id="M351">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$M_T$$\end{document}</tex-math><mml:math id="M352"><mml:msub><mml:mi>M</mml:mi><mml:mi>T</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13015_2019_151_Article_IEq180.gif"/></alternatives></inline-formula>, and <inline-formula id="IEq181"><alternatives><tex-math id="M353">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$t_M$$\end{document}</tex-math><mml:math id="M354"><mml:msub><mml:mi>t</mml:mi><mml:mi>M</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13015_2019_151_Article_IEq181.gif"/></alternatives></inline-formula> is the time to run NJMerge given the distance matrix and the subset trees as input. The average running times for <inline-formula id="IEq182"><alternatives><tex-math id="M355">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$t_T$$\end{document}</tex-math><mml:math id="M356"><mml:msub><mml:mi>t</mml:mi><mml:mi>T</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13015_2019_151_Article_IEq182.gif"/></alternatives></inline-formula> and <inline-formula id="IEq183"><alternatives><tex-math id="M357">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$t_M$$\end{document}</tex-math><mml:math id="M358"><mml:msub><mml:mi>t</mml:mi><mml:mi>M</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13015_2019_151_Article_IEq183.gif"/></alternatives></inline-formula> are shown in Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Tables S9, S10. The time to estimate the NJ tree from the distance matrix is not included, as this took less than a minute even for datasets with 1000 species. Note that given access to multiple compute nodes (at least 6 for the 100-taxon datasets and at least 15 for the 1000-species datasets), the subset trees could be estimated in parallel, as shown in [<xref ref-type="bibr" rid="CR54">54</xref>].</p>
        <p id="Par62">It is worth noting that running ASTRAL-III and computing the AGID matrix requires gene trees to be estimated. Using the same experimental set-up (a single Blue Waters compute node with 64 GB of memory and 16 floating-point cores), FastTree-2 took on average <inline-formula id="IEq184"><alternatives><tex-math id="M359">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$18 \pm 2$$\end{document}</tex-math><mml:math id="M360"><mml:mrow><mml:mn>18</mml:mn><mml:mo>±</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="13015_2019_151_Article_IEq184.gif"/></alternatives></inline-formula> min to estimate 1000 gene trees for datasets with 100 species and on average <inline-formula id="IEq185"><alternatives><tex-math id="M361">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$217 \pm 20$$\end{document}</tex-math><mml:math id="M362"><mml:mrow><mml:mn>217</mml:mn><mml:mo>±</mml:mo><mml:mn>20</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="13015_2019_151_Article_IEq185.gif"/></alternatives></inline-formula> min to estimate 1000 gene trees for datasets with 1000 species (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Tables S4, S5). The amount of time for gene tree estimation can vary greatly, depending on the method used and the analysis performed (e.g., model of sequence evolution, bootstrapping, etc.); we did <italic>not</italic> include the time to estimate gene trees in the reported running times.</p>
      </sec>
    </sec>
  </sec>
  <sec id="Sec19">
    <title>Results</title>
    <p id="Par63">Pipelines using NJMerge can be thought of in two ways: (1) as techniques for potentially improving the accuracy of NJ (hopefully without a large increase in running time) or (2) as techniques for potentially improving the scalability or speed of the method <inline-formula id="IEq186"><alternatives><tex-math id="M363">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$M_T$$\end{document}</tex-math><mml:math id="M364"><mml:msub><mml:mi>M</mml:mi><mml:mi>T</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13015_2019_151_Article_IEq186.gif"/></alternatives></inline-formula> used to compute constraint trees (hopefully without sacrificing accuracy). When distance-based species tree estimation is not as accurate as some other species tree methods, we would predict that NJMerge (when given constraint trees estimated using highly accurate species tree methods) would be more accurate than traditional NJ. Because NJMerge, like NJ, is typically faster than other species tree methods, we would predict that NJMerge would improve the running time of more computationally intensive methods (such as RAxML) used to estimate constraint trees, hopefully without sacrificing accuracy.</p>
    <p id="Par64">Thus, we compared the accuracy of the NJMerge pipeline to traditional NJ, and we also compared the accuracy and running time of the NJMerge pipeline to running <inline-formula id="IEq187"><alternatives><tex-math id="M365">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$M_T$$\end{document}</tex-math><mml:math id="M366"><mml:msub><mml:mi>M</mml:mi><mml:mi>T</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13015_2019_151_Article_IEq187.gif"/></alternatives></inline-formula> on the full dataset, where <inline-formula id="IEq188"><alternatives><tex-math id="M367">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$M_T$$\end{document}</tex-math><mml:math id="M368"><mml:msub><mml:mi>M</mml:mi><mml:mi>T</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13015_2019_151_Article_IEq188.gif"/></alternatives></inline-formula> is the method used to estimate the constraint trees for NJMerge. Results are shown here for intron-like datasets; results for exon-like datasets are shown in Additional file <xref rid="MOESM1" ref-type="media">1</xref>. Unless otherwise noted, results were similar for both sequence types; however, species trees estimated on the exon datasets had slightly higher error rates than those estimated on the intron datasets. This is expected, as the exons had slower rates of evolution (and thus less phylogenetic signal) than the introns.</p>
    <sec id="Sec20">
      <title>How do pipelines using NJMerge compare to Neighbor Joining (NJ)?</title>
      <p id="Par65">In this section, we report results on the effectiveness of using NJMerge as compared to NJ in terms of accuracy.</p>
      <sec id="Sec21">
        <title>Impact of estimated distance matrix</title>
        <p id="Par66">We compared the accuracy of the NJMerge pipeline to traditional NJ on distance matrices estimated from datasets with 100 taxa and varying numbers of genes (Fig. <xref rid="Fig5" ref-type="fig">5</xref>; Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S1). Because the accuracy of NJMerge also depends on error in the input constraint trees, we considered an idealized case where NJMerge was given true constraint trees (i.e., constraint trees that agree with the true species tree). We found that NJMerge(<inline-formula id="IEq189"><alternatives><tex-math id="M369">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathcal {T}}_{true}$$\end{document}</tex-math><mml:math id="M370"><mml:msub><mml:mi mathvariant="script">T</mml:mi><mml:mrow><mml:mi mathvariant="italic">true</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13015_2019_151_Article_IEq189.gif"/></alternatives></inline-formula>, <italic>D</italic>) was more accurate than NJ(<italic>D</italic>) for all model conditions and that the difference in error was especially large when the number of genes was small and the level of ILS was very high (e.g., the difference in mean error was greater than 15% when matrices were estimated from 25 introns but was closer to 5% when matrices were estimated from 1000 introns). A similar trend was observed for matrices computed using the log-det distance. Interestingly, both NJ(<italic>D</italic>) and NJMerge(<inline-formula id="IEq190"><alternatives><tex-math id="M371">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathcal {T}}_{true}$$\end{document}</tex-math><mml:math id="M372"><mml:msub><mml:mi mathvariant="script">T</mml:mi><mml:mrow><mml:mi mathvariant="italic">true</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13015_2019_151_Article_IEq190.gif"/></alternatives></inline-formula>, <italic>D</italic>) were more accurate when given the AGID matrix rather than the log-det distance matrix as input—even when the level of ILS was low/moderate. In summary, NJMerge(<inline-formula id="IEq191"><alternatives><tex-math id="M373">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathcal {T}}_{true}$$\end{document}</tex-math><mml:math id="M374"><mml:msub><mml:mi mathvariant="script">T</mml:mi><mml:mrow><mml:mi mathvariant="italic">true</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13015_2019_151_Article_IEq191.gif"/></alternatives></inline-formula>, <italic>D</italic>) was always more accurate than NJ(<italic>D</italic>), but the improvement in accuracy was greater under challenging model conditions, suggesting that NJMerge(<inline-formula id="IEq192"><alternatives><tex-math id="M375">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathcal {T}}_{true}$$\end{document}</tex-math><mml:math id="M376"><mml:msub><mml:mi mathvariant="script">T</mml:mi><mml:mrow><mml:mi mathvariant="italic">true</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13015_2019_151_Article_IEq192.gif"/></alternatives></inline-formula>, <italic>D</italic>) was more robust to error in the distance matrix than NJ(<italic>D</italic>).<fig id="Fig5"><label>Fig. 5</label><caption><p>Impact of estimated distance matrix on Neighbor Joining (NJ) and NJMerge. Neighbor Joining (NJ) was run with two different distance matrices, and NJMerge was run with two different distance matrices and constraint trees that agreed with the true species tree (see “<xref rid="Sec5" ref-type="sec">Performance study</xref>” section for more information on the notation). Datasets had two different levels of incomplete lineage sorting (ILS) and numbers of genes varying from 25 to 1000. Species tree estimation error is defined as the normalized Robinson–Foulds (RF) distance between true and estimated species trees. Lines represent the average over replicate datasets, and filled regions indicate the standard error</p></caption><graphic xlink:href="13015_2019_151_Fig5_HTML" id="MO5"/></fig>
</p>
      </sec>
      <sec id="Sec22">
        <title>Impact of estimated constraint trees</title>
        <p id="Par67">We compared traditional NJ to the NJMerge pipeline given estimated constraint trees on datasets with 1000 taxa and 1000 genes (Fig. <xref rid="Fig6" ref-type="fig">6</xref>; Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S2). When the level of ILS was low/moderate, NJMerge outperformed NJ regardless of the method used to estimate species trees. For intron-like datasets with low/moderate ILS, the use of constraint trees reduced the median species tree error from 11–14% (NJ) to less than 3–6% (NJMerge); however, when the level of ILS was very high, the performance of NJMerge varied greatly with the species tree method. Specifically, NJMerge(<inline-formula id="IEq193"><alternatives><tex-math id="M377">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathcal {T}}_{SVD}$$\end{document}</tex-math><mml:math id="M378"><mml:msub><mml:mi mathvariant="script">T</mml:mi><mml:mrow><mml:mi mathvariant="italic">SVD</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13015_2019_151_Article_IEq193.gif"/></alternatives></inline-formula>, <italic>D</italic>) and NJMerge(<inline-formula id="IEq194"><alternatives><tex-math id="M379">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathcal {T}}_{RAX}$$\end{document}</tex-math><mml:math id="M380"><mml:msub><mml:mi mathvariant="script">T</mml:mi><mml:mrow><mml:mi mathvariant="italic">RAX</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13015_2019_151_Article_IEq194.gif"/></alternatives></inline-formula>, <italic>D</italic>) were less accurate than NJ(<italic>D</italic>) by 0–4% on average, whereas NJMerge(<inline-formula id="IEq195"><alternatives><tex-math id="M381">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathcal {T}}_{AST}$$\end{document}</tex-math><mml:math id="M382"><mml:msub><mml:mi mathvariant="script">T</mml:mi><mml:mrow><mml:mi mathvariant="italic">AST</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13015_2019_151_Article_IEq195.gif"/></alternatives></inline-formula>, <italic>D</italic>) was more accurate than NJ(<italic>D</italic>) by 0–1% on average (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Tables S7, S8). These trends were consistent with the relative performance of methods on the 100-taxon datasets (Fig. <xref rid="Fig7" ref-type="fig">7</xref> and Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S3); specifically, when the level of ILS was very high, SVDquartets and RAxML performed worse than running NJ on <italic>either</italic> the AGID matrix or the log-det distance matrix. In summary, NJMerge was highly impacted by the quality of the constraint trees—so that accurate constraint trees resulted in NJMerge being more accurate than NJ, but inaccurate constraint trees resulted in NJMerge being less accurate than NJ.<fig id="Fig6"><label>Fig. 6</label><caption><p>Impact of estimated constraint trees on NJMerge. Neighbor Joining (NJ) was run with two different distance matrices, and NJMerge was run with two different distance matrices and four different sets of constraint trees (see “<xref rid="Sec5" ref-type="sec">Performance study</xref>” section for more information on the notation). Species tree estimation error is defined as the normalized Robinson–Foulds (RF) distance between true and estimated species trees. Note that gray bars represent medians, gray squares represent means, gray circles represent outliers, box plots are defined by quartiles (extending from the first to the third quartiles), and whiskers extend to plus/minus 1.5 times the interquartile distance (unless greater/less than the maximum/minimum value)</p></caption><graphic xlink:href="13015_2019_151_Fig6_HTML" id="MO6"/></fig>
<fig id="Fig7"><label>Fig. 7</label><caption><p>Comparison of species tree methods. All methods were run on the full dataset (i.e., not subsets) with 100 species. Neighbor Joining (NJ) was run with two different distance matrices (“<xref rid="Sec5" ref-type="sec">Performance study</xref>” section for more information on the notation). Species tree estimation error is defined as the normalized Robinson–Foulds (RF) distance between true and estimated species trees. Note that gray bars represent medians, gray squares represent means, gray circles represent outliers, box plots are defined by quartiles (extending from the first to the third quartiles), and whiskers extend to plus/minus 1.5 times the interquartile distance (unless greater/less than the maximum/minimum value)</p></caption><graphic xlink:href="13015_2019_151_Fig7_HTML" id="MO7"/></fig>
</p>
      </sec>
    </sec>
    <sec id="Sec23">
      <title>How do pipelines using NJMerge compare to ASTRAL-III, SVDquartets, and RAxML?</title>
      <p id="Par68">In this section, we compare the running time and the accuracy of the NJMerge pipeline to running <inline-formula id="IEq196"><alternatives><tex-math id="M383">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$M_T$$\end{document}</tex-math><mml:math id="M384"><mml:msub><mml:mi>M</mml:mi><mml:mi>T</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13015_2019_151_Article_IEq196.gif"/></alternatives></inline-formula> on the full dataset, where <inline-formula id="IEq197"><alternatives><tex-math id="M385">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$M_T$$\end{document}</tex-math><mml:math id="M386"><mml:msub><mml:mi>M</mml:mi><mml:mi>T</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13015_2019_151_Article_IEq197.gif"/></alternatives></inline-formula> is the method used to estimate constraint trees for NJMerge. Because NJMerge was more accurate when given the AGID matrix (Fig. <xref rid="Fig5" ref-type="fig">5</xref>; Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S1), results for NJMerge given the AGID distance matrix are shown here, and results for NJMerge given the log-det distance matrix are shown in Additional file <xref rid="MOESM1" ref-type="media">1</xref>.</p>
      <sec id="Sec24">
        <title>ASTRAL-III vs. NJMerge</title>
        <p id="Par69">Both NJMerge(<inline-formula id="IEq198"><alternatives><tex-math id="M387">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathcal {T}}_{AST}$$\end{document}</tex-math><mml:math id="M388"><mml:msub><mml:mi mathvariant="script">T</mml:mi><mml:mrow><mml:mi mathvariant="italic">AST</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13015_2019_151_Article_IEq198.gif"/></alternatives></inline-formula>, <inline-formula id="IEq199"><alternatives><tex-math id="M389">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$D_{AGID}$$\end{document}</tex-math><mml:math id="M390"><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:mi mathvariant="italic">AGID</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13015_2019_151_Article_IEq199.gif"/></alternatives></inline-formula>) and NJMerge(<inline-formula id="IEq200"><alternatives><tex-math id="M391">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathcal {T}}_{AST}$$\end{document}</tex-math><mml:math id="M392"><mml:msub><mml:mi mathvariant="script">T</mml:mi><mml:mrow><mml:mi mathvariant="italic">AST</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13015_2019_151_Article_IEq200.gif"/></alternatives></inline-formula>, <inline-formula id="IEq201"><alternatives><tex-math id="M393">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$D_{LD}$$\end{document}</tex-math><mml:math id="M394"><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:mi mathvariant="italic">LD</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13015_2019_151_Article_IEq201.gif"/></alternatives></inline-formula>) provided running time advantages over ASTRAL-III under some model conditions. While ASTRAL-III completed on all the low/moderate ILS datasets with 1000 taxa and 1000 genes in less than 9 h on average, ASTRAL-III failed to complete within the maximum wall-clock time of 48 h on 23/40 datasets with 1000 taxa, 1000 genes, and very high ILS (Table <xref rid="Tab1" ref-type="table">1</xref>). On the other 17/40 datasets, ASTRAL-III ran for more than 2000 min (approximately 33 h). This difference between the low/moderate ILS and the very high ILS datasets is noteworthy (see discussion). In contrast, NJMerge(<inline-formula id="IEq202"><alternatives><tex-math id="M395">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathcal {T}}_{AST}$$\end{document}</tex-math><mml:math id="M396"><mml:msub><mml:mi mathvariant="script">T</mml:mi><mml:mrow><mml:mi mathvariant="italic">AST</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13015_2019_151_Article_IEq202.gif"/></alternatives></inline-formula>, <inline-formula id="IEq203"><alternatives><tex-math id="M397">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$D_{AGID}$$\end{document}</tex-math><mml:math id="M398"><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:mi mathvariant="italic">AGID</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13015_2019_151_Article_IEq203.gif"/></alternatives></inline-formula>) completed in under 300 min (approximately 5 h) on average, including the time it took to estimate the distance matrix and the ASTRAL-III subset trees in serial (Fig. <xref rid="Fig8" ref-type="fig">8</xref>, Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S4). Note that NJMerge(<inline-formula id="IEq204"><alternatives><tex-math id="M399">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathcal {T}}_{AST}$$\end{document}</tex-math><mml:math id="M400"><mml:msub><mml:mi mathvariant="script">T</mml:mi><mml:mrow><mml:mi mathvariant="italic">AST</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13015_2019_151_Article_IEq204.gif"/></alternatives></inline-formula>, <inline-formula id="IEq205"><alternatives><tex-math id="M401">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$D_{AGID}$$\end{document}</tex-math><mml:math id="M402"><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:mi mathvariant="italic">AGID</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13015_2019_151_Article_IEq205.gif"/></alternatives></inline-formula>) failed on 0 datasets, and NJMerge(<inline-formula id="IEq206"><alternatives><tex-math id="M403">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathcal {T}}_{AST}$$\end{document}</tex-math><mml:math id="M404"><mml:msub><mml:mi mathvariant="script">T</mml:mi><mml:mrow><mml:mi mathvariant="italic">AST</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13015_2019_151_Article_IEq206.gif"/></alternatives></inline-formula>, <inline-formula id="IEq207"><alternatives><tex-math id="M405">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$D_{LD}$$\end{document}</tex-math><mml:math id="M406"><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:mi mathvariant="italic">LD</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13015_2019_151_Article_IEq207.gif"/></alternatives></inline-formula>) failed on 2 datasets (Table <xref rid="Tab1" ref-type="table">1</xref>). In summary, NJMerge substantially reduced the running time of ASTRAL-III on the 1000-taxon, 1000-gene datasets with very high ILS.<fig id="Fig8"><label>Fig. 8</label><caption><p>ASTRAL-III vs. NJMerge given ASTRAL-III constraint trees and average gene tree internode distance (AGID) matrix. Subplots on top row show species tree estimation error (defined as the normalized RF distance between true and estimated species trees); note that gray bars represent medians, gray squares represent means, gray circles represent outliers, box plots are defined by quartiles (extending from the first to the third quartiles), and whiskers extend to plus/minus 1.5 times the interquartile distance (unless greater/less than the maximum/minimum value). Subplots on bottom row show running time (in minutes); bars represent means and error bars represent standard deviations across replicate datasets. NJMerge running times are for computing the subset trees “in serial”; see Eq. (<xref rid="Equ1" ref-type="">1</xref>) in the main text for more information. The numbers of replicates on which the methods completed is shown on the x-axis, e.g., <inline-formula id="IEq49"><alternatives><tex-math id="M407">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$N=X,Y$$\end{document}</tex-math><mml:math id="M408"><mml:mrow><mml:mi>N</mml:mi><mml:mo>=</mml:mo><mml:mi>X</mml:mi><mml:mo>,</mml:mo><mml:mi>Y</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="13015_2019_151_Article_IEq49.gif"/></alternatives></inline-formula> indicates that ASTRAL-III completed on <italic>X</italic> out of 20 replicates and that NJMerge(<inline-formula id="IEq50"><alternatives><tex-math id="M409">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathcal {T}}_{AST},D_{AGID}$$\end{document}</tex-math><mml:math id="M410"><mml:mrow><mml:msub><mml:mi mathvariant="script">T</mml:mi><mml:mrow><mml:mi mathvariant="italic">AST</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:mi mathvariant="italic">AGID</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="13015_2019_151_Article_IEq50.gif"/></alternatives></inline-formula>) completed on <italic>Y</italic> out of 20 replicates. ASTRAL-III did not complete within the maximum wall-clock time of 48 h on 4/40 intron-like datasets with 1000 taxa and very high ILS</p></caption><graphic xlink:href="13015_2019_151_Fig8_HTML" id="MO8"/></fig>
<table-wrap id="Tab1"><label>Table 1</label><caption><p>The number of datasets on which methods failed is indicated below by model condition</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left"># of taxa</th><th align="left"># of genes</th><th align="left">ILS level</th><th align="left">Sequence type</th><th align="left">Method</th><th align="left"># of failures (out of 20)</th></tr></thead><tbody><tr><td align="left">100</td><td char="." align="char">25</td><td align="left">Very high</td><td align="left">Exon</td><td align="left">NJMerge(<inline-formula id="IEq209"><alternatives><tex-math id="M411">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathcal {T}}_{true}$$\end{document}</tex-math><mml:math id="M412"><mml:msub><mml:mi mathvariant="script">T</mml:mi><mml:mrow><mml:mi mathvariant="italic">true</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13015_2019_151_Article_IEq209.gif"/></alternatives></inline-formula>, <inline-formula id="IEq210"><alternatives><tex-math id="M413">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$D_{LD}$$\end{document}</tex-math><mml:math id="M414"><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:mi mathvariant="italic">LD</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13015_2019_151_Article_IEq210.gif"/></alternatives></inline-formula>)</td><td char="." align="char">1</td></tr><tr><td align="left">100</td><td char="." align="char">25</td><td align="left">Very high</td><td align="left">Exon</td><td align="left">NJMerge(<inline-formula id="IEq211"><alternatives><tex-math id="M415">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathcal {T}}_{RAX}$$\end{document}</tex-math><mml:math id="M416"><mml:msub><mml:mi mathvariant="script">T</mml:mi><mml:mrow><mml:mi mathvariant="italic">RAX</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13015_2019_151_Article_IEq211.gif"/></alternatives></inline-formula>, <inline-formula id="IEq212"><alternatives><tex-math id="M417">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$D_{AGID}$$\end{document}</tex-math><mml:math id="M418"><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:mi mathvariant="italic">AGID</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13015_2019_151_Article_IEq212.gif"/></alternatives></inline-formula>)</td><td char="." align="char">1</td></tr><tr><td align="left">100</td><td char="." align="char">25</td><td align="left">Very high</td><td align="left">Intron</td><td align="left">NJMerge(<inline-formula id="IEq213"><alternatives><tex-math id="M419">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathcal {T}}_{true}$$\end{document}</tex-math><mml:math id="M420"><mml:msub><mml:mi mathvariant="script">T</mml:mi><mml:mrow><mml:mi mathvariant="italic">true</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13015_2019_151_Article_IEq213.gif"/></alternatives></inline-formula>,<inline-formula id="IEq214"><alternatives><tex-math id="M421">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ D_{AGID}$$\end{document}</tex-math><mml:math id="M422"><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:mi mathvariant="italic">AGID</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13015_2019_151_Article_IEq214.gif"/></alternatives></inline-formula>)</td><td char="." align="char">1</td></tr><tr><td align="left">1000</td><td char="." align="char">1000</td><td align="left">Low/moderate</td><td align="left">Exon</td><td align="left">SVDquartets</td><td char="." align="char">20</td></tr><tr><td align="left">1000</td><td char="." align="char">1000</td><td align="left">Low/moderate</td><td align="left">Exon</td><td align="left">RAxML</td><td char="." align="char">3</td></tr><tr><td align="left">1000</td><td char="." align="char">1000</td><td align="left">Low/moderate</td><td align="left">Intron</td><td align="left">NJMerge(<inline-formula id="IEq215"><alternatives><tex-math id="M423">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathcal {T}}_{AST}$$\end{document}</tex-math><mml:math id="M424"><mml:msub><mml:mi mathvariant="script">T</mml:mi><mml:mrow><mml:mi mathvariant="italic">AST</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13015_2019_151_Article_IEq215.gif"/></alternatives></inline-formula>, <inline-formula id="IEq216"><alternatives><tex-math id="M425">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$D_{LD}$$\end{document}</tex-math><mml:math id="M426"><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:mi mathvariant="italic">LD</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13015_2019_151_Article_IEq216.gif"/></alternatives></inline-formula>)</td><td char="." align="char">1</td></tr><tr><td align="left">1000</td><td char="." align="char">1000</td><td align="left">Low/moderate</td><td align="left">Intron</td><td align="left">SVDquartets</td><td char="." align="char">20</td></tr><tr><td align="left">1000</td><td char="." align="char">1000</td><td align="left">Low/moderate</td><td align="left">Intron</td><td align="left">RAxML</td><td char="." align="char">20</td></tr><tr><td align="left">1000</td><td char="." align="char">1000</td><td align="left">Very high</td><td align="left">Exon</td><td align="left">ASTRAL-III</td><td char="." align="char">19</td></tr><tr><td align="left">1000</td><td char="." align="char">1000</td><td align="left">Very high</td><td align="left">Exon</td><td align="left">NJMerge(<inline-formula id="IEq217"><alternatives><tex-math id="M427">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathcal {T}}_{true}$$\end{document}</tex-math><mml:math id="M428"><mml:msub><mml:mi mathvariant="script">T</mml:mi><mml:mrow><mml:mi mathvariant="italic">true</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13015_2019_151_Article_IEq217.gif"/></alternatives></inline-formula>, <inline-formula id="IEq218"><alternatives><tex-math id="M429">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$D_{LD}$$\end{document}</tex-math><mml:math id="M430"><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:mi mathvariant="italic">LD</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13015_2019_151_Article_IEq218.gif"/></alternatives></inline-formula>)</td><td char="." align="char">1</td></tr><tr><td align="left">1000</td><td char="." align="char">1000</td><td align="left">Very high</td><td align="left">Exon</td><td align="left">NJMerge(<inline-formula id="IEq219"><alternatives><tex-math id="M431">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathcal {T}}_{AST}$$\end{document}</tex-math><mml:math id="M432"><mml:msub><mml:mi mathvariant="script">T</mml:mi><mml:mrow><mml:mi mathvariant="italic">AST</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13015_2019_151_Article_IEq219.gif"/></alternatives></inline-formula>, <inline-formula id="IEq220"><alternatives><tex-math id="M433">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$D_{LD}$$\end{document}</tex-math><mml:math id="M434"><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:mi mathvariant="italic">LD</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13015_2019_151_Article_IEq220.gif"/></alternatives></inline-formula>)</td><td char="." align="char">1</td></tr><tr><td align="left">1000</td><td char="." align="char">1000</td><td align="left">Very high</td><td align="left">Exon</td><td align="left">NJMerge(<inline-formula id="IEq221"><alternatives><tex-math id="M435">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathcal {T}}_{SVD}$$\end{document}</tex-math><mml:math id="M436"><mml:msub><mml:mi mathvariant="script">T</mml:mi><mml:mrow><mml:mi mathvariant="italic">SVD</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13015_2019_151_Article_IEq221.gif"/></alternatives></inline-formula>, <inline-formula id="IEq222"><alternatives><tex-math id="M437">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$D_{LD}$$\end{document}</tex-math><mml:math id="M438"><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:mi mathvariant="italic">LD</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13015_2019_151_Article_IEq222.gif"/></alternatives></inline-formula>)</td><td char="." align="char">2</td></tr><tr><td align="left">1000</td><td char="." align="char">1000</td><td align="left">Very high</td><td align="left">Exon</td><td align="left">NJMerge(<inline-formula id="IEq223"><alternatives><tex-math id="M439">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathcal {T}}_{RAX}$$\end{document}</tex-math><mml:math id="M440"><mml:msub><mml:mi mathvariant="script">T</mml:mi><mml:mrow><mml:mi mathvariant="italic">RAX</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13015_2019_151_Article_IEq223.gif"/></alternatives></inline-formula>, <inline-formula id="IEq224"><alternatives><tex-math id="M441">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$D_{LD}$$\end{document}</tex-math><mml:math id="M442"><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:mi mathvariant="italic">LD</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13015_2019_151_Article_IEq224.gif"/></alternatives></inline-formula>)</td><td char="." align="char">2</td></tr><tr><td align="left">1000</td><td char="." align="char">1000</td><td align="left">Very high</td><td align="left">Exon</td><td align="left">SVDquartets</td><td char="." align="char">20</td></tr><tr><td align="left">1000</td><td char="." align="char">1000</td><td align="left">Very high</td><td align="left">Intron</td><td align="left">ASTRAL-III</td><td char="." align="char">4</td></tr><tr><td align="left">1000</td><td char="." align="char">1000</td><td align="left">Very high</td><td align="left">Intron</td><td align="left">NJMerge(<inline-formula id="IEq225"><alternatives><tex-math id="M443">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathcal {T}}_{SVD}, D_{LD}$$\end{document}</tex-math><mml:math id="M444"><mml:mrow><mml:msub><mml:mi mathvariant="script">T</mml:mi><mml:mrow><mml:mi mathvariant="italic">SVD</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:mi mathvariant="italic">LD</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="13015_2019_151_Article_IEq225.gif"/></alternatives></inline-formula>)</td><td char="." align="char">1</td></tr><tr><td align="left">1000</td><td char="." align="char">1000</td><td align="left">Very high</td><td align="left">Intron</td><td align="left">SVDquartets</td><td char="." align="char">20</td></tr><tr><td align="left">1000</td><td char="." align="char">1000</td><td align="left">Very high</td><td align="left">Intron</td><td align="left">RAxML</td><td char="." align="char">19</td></tr></tbody></table><table-wrap-foot><p>ASTRAL-III failed due to running beyond the maximum wall clock time of 48 h; SVDquartets failed due to segmentation faults; RAxML failed due to running out of memory; NJMerge failed due to being unable to find a legal siblinghood. Note that NJMerge is described by the input set <inline-formula id="IEq208"><alternatives><tex-math id="M445">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathcal {T}}$$\end{document}</tex-math><mml:math id="M446"><mml:mi mathvariant="script">T</mml:mi></mml:math><inline-graphic xlink:href="13015_2019_151_Article_IEq208.gif"/></alternatives></inline-formula> of constraint trees and input distance matrix <italic>D</italic>; see “<xref rid="Sec5" ref-type="sec">Performance study</xref>” section for more information on the notation</p></table-wrap-foot></table-wrap>
</p>
        <p id="Par70">ASTRAL-III and NJMerge(<inline-formula id="IEq226"><alternatives><tex-math id="M447">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathcal {T}}_{AST}$$\end{document}</tex-math><mml:math id="M448"><mml:msub><mml:mi mathvariant="script">T</mml:mi><mml:mrow><mml:mi mathvariant="italic">AST</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13015_2019_151_Article_IEq226.gif"/></alternatives></inline-formula>, <inline-formula id="IEq227"><alternatives><tex-math id="M449">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$D_{AGID}$$\end{document}</tex-math><mml:math id="M450"><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:mi mathvariant="italic">AGID</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13015_2019_151_Article_IEq227.gif"/></alternatives></inline-formula>) achieved similar levels of accuracy with the mean species tree error within 0–2% for both intron and exon datasets (Fig. <xref rid="Fig8" ref-type="fig">8</xref>; Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S4, Table S7). Trends were similar for NJMerge(<inline-formula id="IEq228"><alternatives><tex-math id="M451">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathcal {T}}_{AST}$$\end{document}</tex-math><mml:math id="M452"><mml:msub><mml:mi mathvariant="script">T</mml:mi><mml:mrow><mml:mi mathvariant="italic">AST</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13015_2019_151_Article_IEq228.gif"/></alternatives></inline-formula>, <inline-formula id="IEq229"><alternatives><tex-math id="M453">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$D_{LD}$$\end{document}</tex-math><mml:math id="M454"><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:mi mathvariant="italic">LD</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13015_2019_151_Article_IEq229.gif"/></alternatives></inline-formula>) except when the level of ILS was very high; under these conditions, the mean error of NJMerge(<inline-formula id="IEq230"><alternatives><tex-math id="M455">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathcal {T}}_{AST}$$\end{document}</tex-math><mml:math id="M456"><mml:msub><mml:mi mathvariant="script">T</mml:mi><mml:mrow><mml:mi mathvariant="italic">AST</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13015_2019_151_Article_IEq230.gif"/></alternatives></inline-formula>, <inline-formula id="IEq231"><alternatives><tex-math id="M457">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$D_{LD}$$\end{document}</tex-math><mml:math id="M458"><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:mi mathvariant="italic">LD</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13015_2019_151_Article_IEq231.gif"/></alternatives></inline-formula>) was 2–6% greater than that of ASTRAL-III (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figures S7 and S8, Table S8).</p>
      </sec>
      <sec id="Sec25">
        <title>NJMerge vs. SVDquartets</title>
        <p id="Par71">Species trees can be estimated with SVDquartets using the full set of <inline-formula id="IEq232"><alternatives><tex-math id="M459">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$n \atopwithdelims ()4$$\end{document}</tex-math><mml:math id="M460"><mml:mfenced close=")" open="(" separators=""><mml:mfrac linethickness="0pt"><mml:mi>n</mml:mi><mml:mn>4</mml:mn></mml:mfrac></mml:mfenced></mml:math><inline-graphic xlink:href="13015_2019_151_Article_IEq232.gif"/></alternatives></inline-formula> quartet trees or a subset of quartet trees. Based on a prior study [<xref ref-type="bibr" rid="CR55">55</xref>], which showed that the best accuracy was obtained when using all quartet trees, we computed all <inline-formula id="IEq233"><alternatives><tex-math id="M461">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$n \atopwithdelims ()4$$\end{document}</tex-math><mml:math id="M462"><mml:mfenced close=")" open="(" separators=""><mml:mfrac linethickness="0pt"><mml:mi>n</mml:mi><mml:mn>4</mml:mn></mml:mfrac></mml:mfenced></mml:math><inline-graphic xlink:href="13015_2019_151_Article_IEq233.gif"/></alternatives></inline-formula> quartet trees for 100-taxon datasets. However, on datasets with 1000 taxa, SVDquartets was run using a random subset of quartet trees (without replacement), because the maximum number of quartets allowed by SVDquartets (as implemented by PAUP*) was <inline-formula id="IEq234"><alternatives><tex-math id="M463">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$4.15833 \times 10^{10}$$\end{document}</tex-math><mml:math id="M464"><mml:mrow><mml:mn>4.15833</mml:mn><mml:mo>×</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mn>10</mml:mn></mml:msup></mml:mrow></mml:math><inline-graphic xlink:href="13015_2019_151_Article_IEq234.gif"/></alternatives></inline-formula>. Running PAUP* resulted in a segmentation fault for all 1000-taxon datasets, i.e., SVDquartets failed on 40/40 datasets with 1000 taxa and 1000 genes. In contrast, NJMerge(<inline-formula id="IEq235"><alternatives><tex-math id="M465">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathcal {T}}_{SVD}$$\end{document}</tex-math><mml:math id="M466"><mml:msub><mml:mi mathvariant="script">T</mml:mi><mml:mrow><mml:mi mathvariant="italic">SVD</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13015_2019_151_Article_IEq235.gif"/></alternatives></inline-formula>, <inline-formula id="IEq236"><alternatives><tex-math id="M467">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$D_{AGID}$$\end{document}</tex-math><mml:math id="M468"><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:mi mathvariant="italic">AGID</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13015_2019_151_Article_IEq236.gif"/></alternatives></inline-formula>) failed on 0 datasets, and NJMerge(<inline-formula id="IEq237"><alternatives><tex-math id="M469">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathcal {T}}_{SVD}$$\end{document}</tex-math><mml:math id="M470"><mml:msub><mml:mi mathvariant="script">T</mml:mi><mml:mrow><mml:mi mathvariant="italic">SVD</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13015_2019_151_Article_IEq237.gif"/></alternatives></inline-formula>, <inline-formula id="IEq238"><alternatives><tex-math id="M471">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$D_{LD}$$\end{document}</tex-math><mml:math id="M472"><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:mi mathvariant="italic">LD</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13015_2019_151_Article_IEq238.gif"/></alternatives></inline-formula>) failed on 3 datasets (Table <xref rid="Tab1" ref-type="table">1</xref>).</p>
        <p id="Par72">NJMerge also improved running time on datasets with 100 taxa; for example, SVDquartets completed in 19–81 min on average, whereas NJMerge(<inline-formula id="IEq239"><alternatives><tex-math id="M473">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathcal {T}}_{SVD}$$\end{document}</tex-math><mml:math id="M474"><mml:msub><mml:mi mathvariant="script">T</mml:mi><mml:mrow><mml:mi mathvariant="italic">SVD</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13015_2019_151_Article_IEq239.gif"/></alternatives></inline-formula>, <inline-formula id="IEq240"><alternatives><tex-math id="M475">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$D_{AGID}$$\end{document}</tex-math><mml:math id="M476"><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:mi mathvariant="italic">AGID</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13015_2019_151_Article_IEq240.gif"/></alternatives></inline-formula>) completed in less than 2 min on average for datasets with 100 taxa and 1000 genes (Fig. <xref rid="Fig9" ref-type="fig">9</xref>; Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S5). This running time comparison does not take into account the time needed to estimate gene trees, which required on average 18 min using FastTree-2 on datasets with 100 taxa and 1000 genes.</p>
        <p id="Par73">NJMerge(<inline-formula id="IEq241"><alternatives><tex-math id="M477">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathcal {T}}_{SVD}$$\end{document}</tex-math><mml:math id="M478"><mml:msub><mml:mi mathvariant="script">T</mml:mi><mml:mrow><mml:mi mathvariant="italic">SVD</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13015_2019_151_Article_IEq241.gif"/></alternatives></inline-formula>, <inline-formula id="IEq242"><alternatives><tex-math id="M479">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$D_{AGID}$$\end{document}</tex-math><mml:math id="M480"><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:mi mathvariant="italic">AGID</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13015_2019_151_Article_IEq242.gif"/></alternatives></inline-formula>) typically produced species trees with less error than SVDquartets. The difference between methods was typically small (between 0 and 2%) when the level of ILS was low/moderate but could be larger than 10% when the level of ILS was very high. Similar trends were observed for NJMerge(<inline-formula id="IEq243"><alternatives><tex-math id="M481">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathcal {T}}_{SVD}$$\end{document}</tex-math><mml:math id="M482"><mml:msub><mml:mi mathvariant="script">T</mml:mi><mml:mrow><mml:mi mathvariant="italic">SVD</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13015_2019_151_Article_IEq243.gif"/></alternatives></inline-formula>, <inline-formula id="IEq244"><alternatives><tex-math id="M483">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$D_{LD}$$\end{document}</tex-math><mml:math id="M484"><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:mi mathvariant="italic">LD</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13015_2019_151_Article_IEq244.gif"/></alternatives></inline-formula>) (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figures S9, S10).</p>
      </sec>
      <sec id="Sec26">
        <title>NJMerge vs. RAxML</title>
        <p id="Par74">NJMerge(<inline-formula id="IEq245"><alternatives><tex-math id="M485">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathcal {T}}_{RAX}$$\end{document}</tex-math><mml:math id="M486"><mml:msub><mml:mi mathvariant="script">T</mml:mi><mml:mrow><mml:mi mathvariant="italic">RAX</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13015_2019_151_Article_IEq245.gif"/></alternatives></inline-formula>, <inline-formula id="IEq246"><alternatives><tex-math id="M487">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$D_{AGID}$$\end{document}</tex-math><mml:math id="M488"><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:mi mathvariant="italic">AGID</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13015_2019_151_Article_IEq246.gif"/></alternatives></inline-formula>) and NJMerge(<inline-formula id="IEq247"><alternatives><tex-math id="M489">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathcal {T}}_{RAX}$$\end{document}</tex-math><mml:math id="M490"><mml:msub><mml:mi mathvariant="script">T</mml:mi><mml:mrow><mml:mi mathvariant="italic">RAX</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13015_2019_151_Article_IEq247.gif"/></alternatives></inline-formula>, <inline-formula id="IEq248"><alternatives><tex-math id="M491">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$D_{LD}$$\end{document}</tex-math><mml:math id="M492"><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:mi mathvariant="italic">LD</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13015_2019_151_Article_IEq248.gif"/></alternatives></inline-formula>) reduced the running time of RAxML by more than half—even though RAxML was run on the subset trees in serial (Fig. <xref rid="Fig10" ref-type="fig">10</xref> and Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S6). For the 1000-taxon datasets, the final checkpoint was written by RAxML after more than 2250 min (<inline-formula id="IEq249"><alternatives><tex-math id="M493">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\sim $$\end{document}</tex-math><mml:math id="M494"><mml:mo>∼</mml:mo></mml:math><inline-graphic xlink:href="13015_2019_151_Article_IEq249.gif"/></alternatives></inline-formula> 37.5 h) on average. In comparison, when RAxML was run on subsets in serial, the average running time of NJMerge(<inline-formula id="IEq250"><alternatives><tex-math id="M495">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathcal {T}}_{RAX}$$\end{document}</tex-math><mml:math id="M496"><mml:msub><mml:mi mathvariant="script">T</mml:mi><mml:mrow><mml:mi mathvariant="italic">RAX</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13015_2019_151_Article_IEq250.gif"/></alternatives></inline-formula>, <inline-formula id="IEq251"><alternatives><tex-math id="M497">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$D_{AGID}$$\end{document}</tex-math><mml:math id="M498"><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:mi mathvariant="italic">AGID</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13015_2019_151_Article_IEq251.gif"/></alternatives></inline-formula>) was between 500 (approximately 8.5 h) and 1500 min (approximately 25 h). Although these running times for NJMerge do not include the time to estimate gene trees, recall that it took on average 217 min (less than 4 h) to estimate 1000 gene trees on datasets with 1000 species using FastTree-2.<fig id="Fig9"><label>Fig. 9</label><caption><p>SVDquartets vs. NJMerge given SVDquartet constraint trees and average gene tree internode distance (AGID) matrix. Subplots on top row show species tree estimation error (defined as the normalized RF distance between true and estimated species trees); note that gray bars represent medians, gray squares represent means, gray circles represent outliers, box plots are defined by quartiles (extending from the first to the third quartiles), and whiskers extend to plus/minus 1.5 times the interquartile distance (unless greater/less than the maximum/minimum value). Subplots on bottom row show running time (in minutes); bars represent means and error bars represent standard deviations across replicate datasets. NJMerge running times are for computing the subset trees “in serial”; see Eq. (<xref rid="Equ1" ref-type="">1</xref>) in the main text for more information. The numbers of replicates on which the methods completed is shown on the x-axis, e.g., <inline-formula id="IEq51"><alternatives><tex-math id="M499">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$N=X,Y$$\end{document}</tex-math><mml:math id="M500"><mml:mrow><mml:mi>N</mml:mi><mml:mo>=</mml:mo><mml:mi>X</mml:mi><mml:mo>,</mml:mo><mml:mi>Y</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="13015_2019_151_Article_IEq51.gif"/></alternatives></inline-formula> indicates that SVDquartets completed on <italic>X</italic> out of 20 replicates and that NJMerge(<inline-formula id="IEq52"><alternatives><tex-math id="M501">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathcal {T}}_{SVD},D_{AGID}$$\end{document}</tex-math><mml:math id="M502"><mml:mrow><mml:msub><mml:mi mathvariant="script">T</mml:mi><mml:mrow><mml:mi mathvariant="italic">SVD</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:mi mathvariant="italic">AGID</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="13015_2019_151_Article_IEq52.gif"/></alternatives></inline-formula>) completed on <italic>Y</italic> out of 20 replicates. SVDquartets did not run any datasets with 1000 taxa due to segmentation faults</p></caption><graphic xlink:href="13015_2019_151_Fig9_HTML" id="MO9"/></fig>
<fig id="Fig10"><label>Fig. 10</label><caption><p>RAxML vs. NJMerge given RAxML constraint trees and and average gene tree internode distance (AGID) matrix. Subplots on top row show species tree estimation error (defined as the normalized RF distance between true and estimated species trees); note that gray bars represent medians, gray squares represent means, gray circles represent outliers, box plots are defined by quartiles (extending from the first to the third quartiles), and whiskers extend to plus/minus 1.5 times the interquartile distance (unless greater/less than the maximum/minimum value). Subplots on bottom row show running time (in minutes); bars represent means and error bars represent standard deviations across replicate datasets. NJMerge running times are for computing the subset trees “in serial”; see Eq. (<xref rid="Equ1" ref-type="">1</xref>) in the main text for more information. The numbers of replicates on which the methods completed is shown on the x-axis, e.g., <inline-formula id="IEq53"><alternatives><tex-math id="M503">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$N=X,Y$$\end{document}</tex-math><mml:math id="M504"><mml:mrow><mml:mi>N</mml:mi><mml:mo>=</mml:mo><mml:mi>X</mml:mi><mml:mo>,</mml:mo><mml:mi>Y</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="13015_2019_151_Article_IEq53.gif"/></alternatives></inline-formula> indicates that RAxML completed on <italic>X</italic> out of 20 replicates and that NJMerge(<inline-formula id="IEq54"><alternatives><tex-math id="M505">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathcal {T}}_{RAX},D_{AGID}$$\end{document}</tex-math><mml:math id="M506"><mml:mrow><mml:msub><mml:mi mathvariant="script">T</mml:mi><mml:mrow><mml:mi mathvariant="italic">RAX</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:mi mathvariant="italic">AGID</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="13015_2019_151_Article_IEq54.gif"/></alternatives></inline-formula>) completed on <italic>Y</italic> out of 20 replicates. RAxML was only able to run on 1/40 intron-like datasets with 1000 taxa due to “Out of Memory” errors</p></caption><graphic xlink:href="13015_2019_151_Fig10_HTML" id="MO10"/></fig>
</p>
        <p id="Par75">While NJMerge can fail to return a tree, NJMerge failed less frequently than RAxML—when both methods were given the same computational resources. NJMerge(<inline-formula id="IEq252"><alternatives><tex-math id="M507">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathcal {T}}_{RAX}$$\end{document}</tex-math><mml:math id="M508"><mml:msub><mml:mi mathvariant="script">T</mml:mi><mml:mrow><mml:mi mathvariant="italic">RAX</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13015_2019_151_Article_IEq252.gif"/></alternatives></inline-formula>, <inline-formula id="IEq253"><alternatives><tex-math id="M509">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$D_{AGID}$$\end{document}</tex-math><mml:math id="M510"><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:mi mathvariant="italic">AGID</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13015_2019_151_Article_IEq253.gif"/></alternatives></inline-formula>) failed on 1 dataset, and NJMerge(<inline-formula id="IEq254"><alternatives><tex-math id="M511">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathcal {T}}_{RAX}$$\end{document}</tex-math><mml:math id="M512"><mml:msub><mml:mi mathvariant="script">T</mml:mi><mml:mrow><mml:mi mathvariant="italic">RAX</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13015_2019_151_Article_IEq254.gif"/></alternatives></inline-formula>, <inline-formula id="IEq255"><alternatives><tex-math id="M513">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$D_{LD}$$\end{document}</tex-math><mml:math id="M514"><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:mi mathvariant="italic">LD</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13015_2019_151_Article_IEq255.gif"/></alternatives></inline-formula>) failed on 2 datasets. In contrast, for datasets with 1000 taxa, RAxML failed to run on 38 intron-like datasets and 3 exon-like datasets due to “Out of Memory” (OOM) errors (Table <xref rid="Tab1" ref-type="table">1</xref>); the difference between the number of intron-like versus the number of exon-like datasets is noteworthy (see discussion).</p>
        <p id="Par76">For datasets with low/moderate levels of ILS, RAxML produced species trees with less error (0–3% on average) than NJMerge(<inline-formula id="IEq256"><alternatives><tex-math id="M515">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathcal {T}}_{RAX}$$\end{document}</tex-math><mml:math id="M516"><mml:msub><mml:mi mathvariant="script">T</mml:mi><mml:mrow><mml:mi mathvariant="italic">RAX</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13015_2019_151_Article_IEq256.gif"/></alternatives></inline-formula>, <inline-formula id="IEq257"><alternatives><tex-math id="M517">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$D_{AGID}$$\end{document}</tex-math><mml:math id="M518"><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:mi mathvariant="italic">AGID</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13015_2019_151_Article_IEq257.gif"/></alternatives></inline-formula>); however, for datasets with very high levels of ILS, NJMerge(<inline-formula id="IEq258"><alternatives><tex-math id="M519">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathcal {T}}_{RAX}$$\end{document}</tex-math><mml:math id="M520"><mml:msub><mml:mi mathvariant="script">T</mml:mi><mml:mrow><mml:mi mathvariant="italic">RAX</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13015_2019_151_Article_IEq258.gif"/></alternatives></inline-formula>, <inline-formula id="IEq259"><alternatives><tex-math id="M521">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$D_{AGID}$$\end{document}</tex-math><mml:math id="M522"><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:mi mathvariant="italic">AGID</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13015_2019_151_Article_IEq259.gif"/></alternatives></inline-formula>) produced species trees with less error (0–4% on average) than RAxML (Fig. <xref rid="Fig10" ref-type="fig">10</xref>; Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S6). Similar trends were observed for NJMerge(<inline-formula id="IEq260"><alternatives><tex-math id="M523">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathcal {T}}_{RAX}$$\end{document}</tex-math><mml:math id="M524"><mml:msub><mml:mi mathvariant="script">T</mml:mi><mml:mrow><mml:mi mathvariant="italic">RAX</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13015_2019_151_Article_IEq260.gif"/></alternatives></inline-formula>, <inline-formula id="IEq261"><alternatives><tex-math id="M525">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$D_{LD}$$\end{document}</tex-math><mml:math id="M526"><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:mi mathvariant="italic">LD</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13015_2019_151_Article_IEq261.gif"/></alternatives></inline-formula>) (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figures S11, S12).</p>
      </sec>
    </sec>
  </sec>
  <sec id="Sec27">
    <title>Discussion</title>
    <sec id="Sec28">
      <title>Remarks on the utility of pipelines using NJMerge</title>
      <p id="Par77">Pipelines using NJMerge can be viewed either as techniques for improving traditional NJ or as techniques for scaling a computationally-intensive base method (previously referred to as <inline-formula id="IEq262"><alternatives><tex-math id="M527">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$M_T$$\end{document}</tex-math><mml:math id="M528"><mml:msub><mml:mi>M</mml:mi><mml:mi>T</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13015_2019_151_Article_IEq262.gif"/></alternatives></inline-formula>) to larger datasets. Thus, in order to maximize the utility of NJMerge, users should select a base method that is both more accurate and more computationally-intensive than NJ. Our results show that selecting base methods for NJMerge may not be trivial when analyzing phylogenomic datasets—because both accuracy and running time were impacted by the level of ILS. For example, ASTRAL-III was very fast when the level of ILS was low/moderate but was substantially slower when the level of ILS was very high. Similarly, SVDquartets and RAxML were both more accurate than NJ(<inline-formula id="IEq263"><alternatives><tex-math id="M529">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$D_{AGID}$$\end{document}</tex-math><mml:math id="M530"><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:mi mathvariant="italic">AGID</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13015_2019_151_Article_IEq263.gif"/></alternatives></inline-formula>), i.e., NJst, when the level of ILS was low/moderate but were less accurate than these methods when the level of ILS was very high; note that this trend is consistent with results from [<xref ref-type="bibr" rid="CR12">12</xref>] (also see the review paper by [<xref ref-type="bibr" rid="CR56">56</xref>]). Overall, our results suggest that constraint trees should be estimated using RAxML when the level of ILS is low/moderate and using ASTRAL-III when the level of ILS is very high, and thus, determining the level of ILS in a given phylogenomic datasets is an important area of future research. Finally, we note that NJMerge, when given constraint trees that agreed with the true species tree, was very accurate (less than 2% error on average) even when the level of ILS was very high, suggesting that NJMerge is a promising technique for scaling Bayesian methods (e.g., Starbeast2 [<xref ref-type="bibr" rid="CR8">8</xref>]) and future species tree methods to larger datasets.</p>
      <p id="Par78">Although NJMerge can fail, this should not discourage potential users, as NJMerge failed on fewer datasets than ASTRAL-III, SVDquartets, or RAxML—when all methods were given the same computational resources, including a maximum wall-clock time of 48 h. In our experiments, NJMerge failed on only 11/2560 test cases from running NJMerge on 320 datasets with two different types of distance matrices and four different types of constraint trees (Table <xref rid="Tab1" ref-type="table">1</xref>).</p>
      <p id="Par79">Importantly, in all our experiments, NJMerge was run within the divide-and-conquer pipeline shown in Fig. <xref rid="Fig4" ref-type="fig">4</xref>, specifically, with subsets of taxa derived from decomposing the NJ tree (blue dashed lines). Because NJMerge was always given inputs generated by this pipeline, our results on the accuracy, the failure rate, and the running time of NJMerge may not generalize to arbitrary inputs.</p>
    </sec>
    <sec id="Sec29">
      <title>Remarks on other results</title>
      <sec id="Sec30">
        <title>Impact of distance matrix on NJ</title>
        <p id="Par80">Our results showed that on average NJ(<inline-formula id="IEq264"><alternatives><tex-math id="M531">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$D_{AGID}$$\end{document}</tex-math><mml:math id="M532"><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:mi mathvariant="italic">AGID</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13015_2019_151_Article_IEq264.gif"/></alternatives></inline-formula>) was either as accurate or else more accurate than NJ(<inline-formula id="IEq265"><alternatives><tex-math id="M533">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$D_{LD}$$\end{document}</tex-math><mml:math id="M534"><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:mi mathvariant="italic">LD</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13015_2019_151_Article_IEq265.gif"/></alternatives></inline-formula>). Notably, there was a clear difference between these two methods on datasets with 100 taxa and low/moderate levels of ILS; specifically NJ(<inline-formula id="IEq266"><alternatives><tex-math id="M535">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$D_{AGID}$$\end{document}</tex-math><mml:math id="M536"><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:mi mathvariant="italic">AGID</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13015_2019_151_Article_IEq266.gif"/></alternatives></inline-formula>) produced trees with less than 5% error on average, whereas NJ(<inline-formula id="IEq267"><alternatives><tex-math id="M537">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$D_{LD}$$\end{document}</tex-math><mml:math id="M538"><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:mi mathvariant="italic">LD</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13015_2019_151_Article_IEq267.gif"/></alternatives></inline-formula>) produced trees with greater than 10% error on average). However, on the exact same model condition but with 1000 taxa, NJ(<inline-formula id="IEq268"><alternatives><tex-math id="M539">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$D_{AGID}$$\end{document}</tex-math><mml:math id="M540"><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:mi mathvariant="italic">AGID</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13015_2019_151_Article_IEq268.gif"/></alternatives></inline-formula>) and NJ(<inline-formula id="IEq269"><alternatives><tex-math id="M541">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$D_{LD}$$\end{document}</tex-math><mml:math id="M542"><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:mi mathvariant="italic">LD</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13015_2019_151_Article_IEq269.gif"/></alternatives></inline-formula>) produced trees with similar levels of accuracy. This may be due to the difference between the median branch length between low/moderate ILS datasets with 100 taxa and 1000 taxa (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S3); furthermore, it is possible that branch length and other factors that limit the accuracy of NJ(<inline-formula id="IEq270"><alternatives><tex-math id="M543">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$D_{LD}$$\end{document}</tex-math><mml:math id="M544"><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:mi mathvariant="italic">LD</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13015_2019_151_Article_IEq270.gif"/></alternatives></inline-formula>) in the context of gene tree estimation would also apply in the context of species tree estimation. However, it is interesting to note that NJ(<inline-formula id="IEq271"><alternatives><tex-math id="M545">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$D_{LD}$$\end{document}</tex-math><mml:math id="M546"><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:mi mathvariant="italic">LD</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13015_2019_151_Article_IEq271.gif"/></alternatives></inline-formula>) was more accurate than either SVDquartets or RAxML when the level of ILS was very high, providing support for Allman et al.’s statement, “The simplicity and speed of distance-based inference suggests log-det based methods should serve as benchmarks for judging more elaborate and computationally-intensive species trees inference methods” [<xref ref-type="bibr" rid="CR18">18</xref>].</p>
      </sec>
      <sec id="Sec31">
        <title>Impact of ILS and sequence type on ASTRAL-III</title>
        <p id="Par81">Our results showed that ASTRAL-III was much faster on the low/moderate ILS datasets than on the very high ILS datasets. This finding makes sense in light of ASTRAL-III’s algorithm design. ASTRAL-III operates by searching for an optimal solution to its search problem within a constrained search space that is defined by the set <inline-formula id="IEq272"><alternatives><tex-math id="M547">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathcal {X}}$$\end{document}</tex-math><mml:math id="M548"><mml:mi mathvariant="script">X</mml:mi></mml:math><inline-graphic xlink:href="13015_2019_151_Article_IEq272.gif"/></alternatives></inline-formula> of bipartitions in the estimated gene trees, and in particular, ASTRAL-III’s running time scales with <inline-formula id="IEq273"><alternatives><tex-math id="M549">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$|{\mathcal {X}}|^{1.726}$$\end{document}</tex-math><mml:math id="M550"><mml:msup><mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:mi mathvariant="script">X</mml:mi><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mrow><mml:mn>1.726</mml:mn></mml:mrow></mml:msup></mml:math><inline-graphic xlink:href="13015_2019_151_Article_IEq273.gif"/></alternatives></inline-formula> [<xref ref-type="bibr" rid="CR30">30</xref>]. The set of gene trees will become more heterogeneous for higher levels of ILS, and thus, the size of <inline-formula id="IEq274"><alternatives><tex-math id="M551">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathcal {X}}$$\end{document}</tex-math><mml:math id="M552"><mml:mi mathvariant="script">X</mml:mi></mml:math><inline-graphic xlink:href="13015_2019_151_Article_IEq274.gif"/></alternatives></inline-formula> will increase, as every gene tree could be different when the level of ILS is very high. In addition, gene tree estimation error can also increase the size of <inline-formula id="IEq275"><alternatives><tex-math id="M553">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathcal {X}}$$\end{document}</tex-math><mml:math id="M554"><mml:mi mathvariant="script">X</mml:mi></mml:math><inline-graphic xlink:href="13015_2019_151_Article_IEq275.gif"/></alternatives></inline-formula>, explaining why ASTRAL-III failed to complete on exon datasets more often than on intron datasets (Table <xref rid="Tab1" ref-type="table">1</xref>, Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S2).</p>
      </sec>
      <sec id="Sec32">
        <title>Impact of sequence type on RAxML</title>
        <p id="Par82">Our results showed that RAxML failed on more intron-like datasets than exon-like datasets. This finding makes sense in light of RAxML’s implementation. RAxML uses redundancy in site patterns to store the input alignment compactly, so that the memory scales with the number of unique site patterns. The intron datasets had more unique site patterns than the exon datasets (i.e., greater phylogenetic signal and lower gene tree estimation error), which explains why RAxML required more memory when analyzing introns.</p>
      </sec>
    </sec>
    <sec id="Sec33">
      <title>Remarks on the statistical consistency of pipelines using NJMerge</title>
      <p id="Par83">Although NJMerge can fail to return a tree, by statistical consistency under the MSC model (Corollary <xref ref-type="sec" rid="FPar9">7</xref>), the probability that NJMerge fails goes to zero as the number of true gene trees goes to infinity. In fact, NJMerge was designed to have this theoretical guarantee via the selection of the heuristic for determining whether or not to accept a siblinghood proposal. It is easy to think of other heuristics that prevent NJMerge from failing but do <italic>not</italic> have the guarantee of correctness (Theorem <xref ref-type="sec" rid="FPar3">3</xref>) and thus do <italic>not</italic> have the guarantee of statistical consistency (Corollary <xref ref-type="sec" rid="FPar9">7</xref>). Designing heuristics that prevent NJMerge from failing but have good theoretical properties is an area of future research.</p>
      <p id="Par84">As mentioned previously, our proof of statistical consistency under the MSC model requires that the number of true gene trees goes to infinity, which is the equivalent of requiring that <italic>both</italic> the number of gene trees and the sequence length per gene tree go to infinity. Roch et al. [<xref ref-type="bibr" rid="CR6">6</xref>] recently showed that essentially all gene tree summary methods (e.g., NJst [<xref ref-type="bibr" rid="CR40">40</xref>], and ASTRAL [<xref ref-type="bibr" rid="CR11">11</xref>]) are not statistically consistent under the MSC if the sequence length per gene is fixed—and these theoretical results apply to NJMerge as well. The failure to be statistically consistent when the sequence length per gene is bounded is not unique to gene tree summary methods or NJMerge, as Roch et al. also showed that fully partitioned maximum likelihood is not consistent under these conditions, and [<xref ref-type="bibr" rid="CR5">5</xref>] had shown that unpartitioned maximum likelihood is also not consistent.</p>
    </sec>
  </sec>
  <sec id="Sec34">
    <title>Conclusions</title>
    <p id="Par85">In this paper, we introduced a divide-and-conquer approach to phylogeny estimation that (1) decomposes a set of species into pairwise disjoint subsets, (2) builds trees on each subset of species using a base method, and (3) merges the subsets trees together using a distance matrix. For the merger step, we presented a new method, called NJMerge, and proved that some divide-and-conquer pipelines using NJMerge are statistically consistent under some models of evolution. We then evaluated pipelines using NJMerge in the context of species tree estimation, specifically using simulated multi-locus datasets with up to 1000 species and two levels of ILS. We found that pipelines using NJMerge provided several benefits to large-scale species tree estimation. Specifically, under some model conditions, pipelines using NJMerge improved the accuracy of traditional NJ and substantially reduced the running time of three popular species tree methods (ASTRAL-III, SVDquartets, and “concatenation” using RAxML) without sacrificing accuracy (see discussion for details as the results depended on the level of ILS). Finally, although NJMerge can fail to return a tree, in our experiments, pipelines using NJMerge failed on only 11 out of 2560 test cases. Together these results suggest that NJMerge is a promising approach for scaling highly accurate but computationally-intensive methods to larger datasets.</p>
    <p id="Par86">This study also suggests several different directions for future research. Since NJMerge uses a heuristic (which can fail) to test for tree compatibility (in deciding whether to accept a siblinghood proposal), a modification to NJMerge to use an exact method for this problem would reduce the failure rate and—if sufficiently fast—would still enable scalability to large datasets. In addition, all aspects of the divide-and-conquer pipeline could be modified and tested; for example, the robustness of NJMerge to the starting tree and initial subset decomposition could be evaluated. Finally, divide-and-conquer pipelines using NJMerge could be compared to traditional divide-and-conquer pipelines (e.g., Disk Covering Methods) when robust implementations become publicly available for species tree estimation. Other agglomerative techniques for merging disjoint subset trees are being developed (e.g., the agglomerative technique described in [<xref ref-type="bibr" rid="CR57">57</xref>] for gene tree estimation has good theoretical properties but has not yet been implemented), and NJMerge should be compared to such techniques when they become publicly available.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Additional file</title>
    <sec id="Sec35">
      <p>
        <supplementary-material content-type="local-data" id="MOESM1">
          <media xlink:href="13015_2019_151_MOESM1_ESM.pdf">
            <caption>
              <p><bold>Additional file 1.</bold> Detailed methods section, including software commands. 12 figures and 10 tables describing additional results, including those for exon-like datasets and those for analyses using log-det distance matrices.</p>
            </caption>
          </media>
        </supplementary-material>
      </p>
    </sec>
  </sec>
</body>
<back>
  <glossary>
    <title>Abbreviations</title>
    <def-list>
      <def-item>
        <term>GTR</term>
        <def>
          <p>Generalized Time Reversible</p>
        </def>
      </def-item>
      <def-item>
        <term>ILS</term>
        <def>
          <p>incomplete lineage sorting</p>
        </def>
      </def-item>
      <def-item>
        <term>MSC</term>
        <def>
          <p>Multi-Species Coalescent</p>
        </def>
      </def-item>
      <def-item>
        <term>NJ</term>
        <def>
          <p>Neighbor Joining</p>
        </def>
      </def-item>
      <def-item>
        <term>RF</term>
        <def>
          <p>Robinson–Foulds</p>
        </def>
      </def-item>
    </def-list>
  </glossary>
  <fn-group>
    <fn>
      <p>
        <bold>Publisher's Note</bold>
      </p>
      <p>Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p>
    </fn>
  </fn-group>
  <ack>
    <title>Acknowledgements</title>
    <p>We thank the anonymous reviewers of our RECOMB-CG paper, whose feedback led to improvements in the quality of this paper.</p>
    <sec id="FPar13">
      <title>Availability and requirements</title>
      <p id="Par90">Project name: NJMerge; Project home page: <ext-link ext-link-type="uri" xlink:href="https://github.com/ekmolloy/njmerge">https://github.com/ekmolloy/njmerge</ext-link>; Operating systems: Platform independent; Programming language: Python version 2.7; Other requirements: Dendropy version 4.3.0; License: BSD 3-Clause; Any restrictions to use by non-academics: None.</p>
    </sec>
  </ack>
  <notes notes-type="author-contribution">
    <title>Authors' contributions</title>
    <p>Both authors designed the study, proved the theorems, and wrote the paper. EKM implemented the algorithm and performed the simulation study. Both authors read and approved the final manuscript.</p>
  </notes>
  <notes notes-type="funding-information">
    <title>Funding</title>
    <p>This work was supported by the U.S. National Science Foundation (grants 1535977 and 1513629) to TW. EKM was supported by the NSF Graduate Research Fellowship (Award DGE-1144245) and the Ira and Debra Cohen Graduate Fellowship in Computer Science. Computational experiments were performed on Blue Waters. This research is part of the Blue Waters sustained-petascale computing project, which is supported by the NSF (Awards OCI-0725070 and ACI-1238993) and the state of Illinois. Blue Waters is a joint effort of the University of Illinois at Urbana-Champaign and its National Center for Supercomputing Applications.</p>
  </notes>
  <notes notes-type="data-availability">
    <title>Availability of data and materials</title>
    <p>The datasets supporting the conclusions of this article are available in the following Illinois Data Bank repositories: 10.13012/B2IDB-1424746_V1 and 10.13012/B2IDB-0569467_V2.</p>
  </notes>
  <notes>
    <title>Ethics approval and consent to participate</title>
    <p id="Par92">Not applicable.</p>
  </notes>
  <notes>
    <title>Consent for publication</title>
    <p id="Par93">Not applicable.</p>
  </notes>
  <notes notes-type="COI-statement">
    <title>Competing interests</title>
    <p id="Par94">The authors declare that they have no competing interests.</p>
  </notes>
  <ref-list id="Bib1">
    <title>References</title>
    <ref id="CR1">
      <label>1.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Maddison</surname>
            <given-names>WP</given-names>
          </name>
        </person-group>
        <article-title>Gene trees in species trees</article-title>
        <source>Syst Biol</source>
        <year>1997</year>
        <volume>46</volume>
        <issue>3</issue>
        <fpage>523</fpage>
        <lpage>536</lpage>
        <pub-id pub-id-type="doi">10.1093/sysbio/46.3.523</pub-id>
      </element-citation>
    </ref>
    <ref id="CR2">
      <label>2.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Pamilo</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Nei</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>Relationships between gene trees and species trees</article-title>
        <source>Mol Biol Evol</source>
        <year>1988</year>
        <volume>5</volume>
        <issue>5</issue>
        <fpage>568</fpage>
        <lpage>583</lpage>
        <?supplied-pmid 3193878?>
        <pub-id pub-id-type="pmid">3193878</pub-id>
      </element-citation>
    </ref>
    <ref id="CR3">
      <label>3.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Rannala</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Yang</surname>
            <given-names>Z</given-names>
          </name>
        </person-group>
        <article-title>Bayes estimation of species divergence times and ancestral population sizes using DNA sequences from multiple loci</article-title>
        <source>Genetics</source>
        <year>2003</year>
        <volume>164</volume>
        <issue>4</issue>
        <fpage>1645</fpage>
        <lpage>1656</lpage>
        <?supplied-pmid 12930768?>
        <pub-id pub-id-type="pmid">12930768</pub-id>
      </element-citation>
    </ref>
    <ref id="CR4">
      <label>4.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Edwards</surname>
            <given-names>SV</given-names>
          </name>
        </person-group>
        <article-title>Is a new and general theory of molecular systematics emerging?</article-title>
        <source>Evolution</source>
        <year>2009</year>
        <volume>63</volume>
        <issue>1</issue>
        <fpage>1</fpage>
        <lpage>19</lpage>
        <pub-id pub-id-type="doi">10.1111/j.1558-5646.2008.00549.x</pub-id>
        <?supplied-pmid 19146594?>
        <pub-id pub-id-type="pmid">19146594</pub-id>
      </element-citation>
    </ref>
    <ref id="CR5">
      <label>5.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Roch</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Steel</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>Likelihood-based tree reconstruction on a concatenation of aligned sequence data sets can be statistically inconsistent</article-title>
        <source>Theor Popul Biol</source>
        <year>2015</year>
        <volume>100</volume>
        <fpage>56</fpage>
        <lpage>62</lpage>
        <pub-id pub-id-type="doi">10.1016/j.tpb.2014.12.005</pub-id>
      </element-citation>
    </ref>
    <ref id="CR6">
      <label>6.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Roch</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Nute</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Warnow</surname>
            <given-names>T</given-names>
          </name>
        </person-group>
        <article-title>Long-branch attraction in species tree estimation: inconsistency of partitioned likelihood and topology-based summary methods</article-title>
        <source>Syst Biol</source>
        <year>2018</year>
        <volume>68</volume>
        <fpage>281</fpage>
        <lpage>297</lpage>
        <pub-id pub-id-type="doi">10.1093/sysbio/syy061</pub-id>
      </element-citation>
    </ref>
    <ref id="CR7">
      <label>7.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Heled</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Drummond</surname>
            <given-names>AJ</given-names>
          </name>
        </person-group>
        <article-title>Bayesian inference of species trees from multilocus data</article-title>
        <source>Mol Biol Evol</source>
        <year>2010</year>
        <volume>27</volume>
        <issue>3</issue>
        <fpage>570</fpage>
        <lpage>580</lpage>
        <pub-id pub-id-type="doi">10.1093/molbev/msp274</pub-id>
        <?supplied-pmid 19906793?>
        <pub-id pub-id-type="pmid">19906793</pub-id>
      </element-citation>
    </ref>
    <ref id="CR8">
      <label>8.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ogilvie</surname>
            <given-names>HA</given-names>
          </name>
          <name>
            <surname>Bouckaert</surname>
            <given-names>RR</given-names>
          </name>
          <name>
            <surname>Drummond</surname>
            <given-names>AJ</given-names>
          </name>
        </person-group>
        <article-title>StarBEAST2 brings faster species tree inference and accurate estimates of substitution rates</article-title>
        <source>Mol Biol Evol</source>
        <year>2017</year>
        <volume>34</volume>
        <issue>8</issue>
        <fpage>2101</fpage>
        <lpage>2114</lpage>
        <pub-id pub-id-type="doi">10.1093/molbev/msx126</pub-id>
        <?supplied-pmid 28431121?>
        <pub-id pub-id-type="pmid">28431121</pub-id>
      </element-citation>
    </ref>
    <ref id="CR9">
      <label>9.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Liu</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Yu</surname>
            <given-names>L</given-names>
          </name>
        </person-group>
        <article-title>Estimating species trees from unrooted gene trees</article-title>
        <source>Syst Biol</source>
        <year>2011</year>
        <volume>60</volume>
        <issue>5</issue>
        <fpage>661</fpage>
        <lpage>667</lpage>
        <pub-id pub-id-type="doi">10.1093/sysbio/syr027</pub-id>
        <?supplied-pmid 21447481?>
        <pub-id pub-id-type="pmid">21447481</pub-id>
      </element-citation>
    </ref>
    <ref id="CR10">
      <label>10.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Saitou</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Nei</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>The neighbor-joining method: a new method for reconstructing phylogenetic trees</article-title>
        <source>Mol Biol Evol</source>
        <year>1987</year>
        <volume>4</volume>
        <issue>4</issue>
        <fpage>406</fpage>
        <lpage>425</lpage>
        <pub-id pub-id-type="doi">10.1093/oxfordjournals.molbev.a040454</pub-id>
        <?supplied-pmid 3447015?>
        <pub-id pub-id-type="pmid">3447015</pub-id>
      </element-citation>
    </ref>
    <ref id="CR11">
      <label>11.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Mirarab</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Reaz</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Bayzid</surname>
            <given-names>MS</given-names>
          </name>
          <name>
            <surname>Zimmermann</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Swenson</surname>
            <given-names>MS</given-names>
          </name>
          <name>
            <surname>Warnow</surname>
            <given-names>T</given-names>
          </name>
        </person-group>
        <article-title>ASTRAL: genome-scale coalescent-based species tree estimation</article-title>
        <source>Bioinformatics</source>
        <year>2014</year>
        <volume>30</volume>
        <issue>17</issue>
        <fpage>541</fpage>
        <lpage>548</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btu462</pub-id>
      </element-citation>
    </ref>
    <ref id="CR12">
      <label>12.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Molloy</surname>
            <given-names>EK</given-names>
          </name>
          <name>
            <surname>Warnow</surname>
            <given-names>T</given-names>
          </name>
        </person-group>
        <article-title>To include or not to include: the impact of gene filtering on species tree estimation methods</article-title>
        <source>Syst Biol</source>
        <year>2018</year>
        <volume>67</volume>
        <issue>2</issue>
        <fpage>285</fpage>
        <lpage>303</lpage>
        <pub-id pub-id-type="doi">10.1093/sysbio/syx077</pub-id>
        <?supplied-pmid 29029338?>
        <pub-id pub-id-type="pmid">29029338</pub-id>
      </element-citation>
    </ref>
    <ref id="CR13">
      <label>13.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Chifman</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Kubatko</surname>
            <given-names>L</given-names>
          </name>
        </person-group>
        <article-title>Quartet inference from SNP data under the coalescent model</article-title>
        <source>Bioinformatics</source>
        <year>2014</year>
        <volume>30</volume>
        <issue>23</issue>
        <fpage>3317</fpage>
        <lpage>3324</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btu530</pub-id>
        <?supplied-pmid 25104814?>
        <pub-id pub-id-type="pmid">25104814</pub-id>
      </element-citation>
    </ref>
    <ref id="CR14">
      <label>14.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Jiang</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Kearney</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>A polynomial time approximation scheme for inferring evolutionary trees from quartet topologies and its application</article-title>
        <source>SIAM J Comput</source>
        <year>2001</year>
        <volume>30</volume>
        <issue>6</issue>
        <fpage>1942</fpage>
        <lpage>1961</lpage>
        <pub-id pub-id-type="doi">10.1137/S0097539799361683</pub-id>
      </element-citation>
    </ref>
    <ref id="CR15">
      <label>15.</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Jukes</surname>
            <given-names>TH</given-names>
          </name>
          <name>
            <surname>Cantor</surname>
            <given-names>CR</given-names>
          </name>
        </person-group>
        <person-group person-group-type="editor">
          <name>
            <surname>Munro</surname>
            <given-names>HN</given-names>
          </name>
        </person-group>
        <article-title>Evolution of protein molecules</article-title>
        <source>Mammalian protein metabolism</source>
        <year>1969</year>
        <publisher-loc>New York</publisher-loc>
        <publisher-name>Academic Press</publisher-name>
        <fpage>21</fpage>
        <lpage>132</lpage>
      </element-citation>
    </ref>
    <ref id="CR16">
      <label>16.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Steel</surname>
            <given-names>MA</given-names>
          </name>
        </person-group>
        <article-title>Recovering a tree from the leaf colourations it generates under a Markov model</article-title>
        <source>Appl Math Lett</source>
        <year>1994</year>
        <volume>7</volume>
        <issue>2</issue>
        <fpage>19</fpage>
        <lpage>24</lpage>
        <pub-id pub-id-type="doi">10.1016/0893-9659(94)90024-8</pub-id>
      </element-citation>
    </ref>
    <ref id="CR17">
      <label>17.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Dasarathy</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Nowak</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Roch</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>Data requirement for phylogenetic inference from multiple loci: a new distance method</article-title>
        <source>IEEE/ACM Trans Comput Biol Bioinform</source>
        <year>2015</year>
        <volume>12</volume>
        <issue>2</issue>
        <fpage>422</fpage>
        <lpage>432</lpage>
        <pub-id pub-id-type="doi">10.1109/TCBB.2014.2361685</pub-id>
        <?supplied-pmid 26357228?>
        <pub-id pub-id-type="pmid">26357228</pub-id>
      </element-citation>
    </ref>
    <ref id="CR18">
      <label>18.</label>
      <mixed-citation publication-type="other">Allman ES, Long C, Rhodes JA. Species tree inference from genomic sequences using the log-det distance. 2018. <ext-link ext-link-type="uri" xlink:href="http://arxiv.org/abs/1806.04974">arXiv:1806.04974</ext-link>.</mixed-citation>
    </ref>
    <ref id="CR19">
      <label>19.</label>
      <mixed-citation publication-type="other">Warnow T, Moret BME, St. John K. Absolute convergence: true trees from short sequences. In: Proceedings of the twelfth annual ACM-SIAM symposium on discrete algorithms. SODA ’01. Philadelphia: Society for Industrial and Applied Mathematics; 2001. p. 186–95.</mixed-citation>
    </ref>
    <ref id="CR20">
      <label>20.</label>
      <mixed-citation publication-type="other">Huson DH, Vawter L, Warnow T. Solving large scale phylogenetic problems using DCM2. In: Proceedings of the seventh international conference on intelligent systems for molecular biology. Palo Alto: AAAI Press; 1999. p. 118–29.</mixed-citation>
    </ref>
    <ref id="CR21">
      <label>21.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lagergren</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>Combining polynomial running time and fast convergence for the disk-covering method</article-title>
        <source>J Comput Syst Sci</source>
        <year>2002</year>
        <volume>65</volume>
        <issue>3</issue>
        <fpage>481</fpage>
        <lpage>493</lpage>
        <pub-id pub-id-type="doi">10.1016/S0022-0000(02)00005-3</pub-id>
      </element-citation>
    </ref>
    <ref id="CR22">
      <label>22.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Nelesen</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Liu</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>L-S</given-names>
          </name>
          <name>
            <surname>Linder</surname>
            <given-names>CR</given-names>
          </name>
          <name>
            <surname>Warnow</surname>
            <given-names>T</given-names>
          </name>
        </person-group>
        <article-title>DACTAL: divide-and-conquer trees (almost) without alignments</article-title>
        <source>Bioinformatics</source>
        <year>2012</year>
        <volume>28</volume>
        <issue>12</issue>
        <fpage>274</fpage>
        <lpage>282</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/bts218</pub-id>
      </element-citation>
    </ref>
    <ref id="CR23">
      <label>23.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bayzid</surname>
            <given-names>MS</given-names>
          </name>
          <name>
            <surname>Hunt</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Warnow</surname>
            <given-names>T</given-names>
          </name>
        </person-group>
        <article-title>Disk covering methods improve phylogenomic analyses</article-title>
        <source>BMC Genom</source>
        <year>2014</year>
        <volume>15</volume>
        <issue>6</issue>
        <fpage>7</fpage>
        <pub-id pub-id-type="doi">10.1186/1471-2164-15-S6-S7</pub-id>
      </element-citation>
    </ref>
    <ref id="CR24">
      <label>24.</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Warnow</surname>
            <given-names>T</given-names>
          </name>
        </person-group>
        <source>Computational phylogenetics: an introduction to designing methods for phylogeny estimation</source>
        <year>2017</year>
        <publisher-loc>Cambridge</publisher-loc>
        <publisher-name>Cambridge University Press</publisher-name>
      </element-citation>
    </ref>
    <ref id="CR25">
      <label>25.</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Bodlaender</surname>
            <given-names>Hans L.</given-names>
          </name>
          <name>
            <surname>Fellows</surname>
            <given-names>Mike R.</given-names>
          </name>
          <name>
            <surname>Warnow</surname>
            <given-names>Tandy J.</given-names>
          </name>
        </person-group>
        <article-title>Two strikes against perfect phylogeny</article-title>
        <source>Automata, Languages and Programming</source>
        <year>1992</year>
        <publisher-loc>Berlin, Heidelberg</publisher-loc>
        <publisher-name>Springer Berlin Heidelberg</publisher-name>
        <fpage>273</fpage>
        <lpage>283</lpage>
      </element-citation>
    </ref>
    <ref id="CR26">
      <label>26.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bansal</surname>
            <given-names>MS</given-names>
          </name>
          <name>
            <surname>Burleigh</surname>
            <given-names>JG</given-names>
          </name>
          <name>
            <surname>Eulenstein</surname>
            <given-names>O</given-names>
          </name>
          <name>
            <surname>Fernández-Baca</surname>
            <given-names>D</given-names>
          </name>
        </person-group>
        <article-title>Robinson–Foulds supertrees</article-title>
        <source>Algorithms Mol Biol</source>
        <year>2010</year>
        <volume>5</volume>
        <issue>1</issue>
        <fpage>18</fpage>
        <pub-id pub-id-type="doi">10.1186/1748-7188-5-18</pub-id>
        <?supplied-pmid 20181274?>
        <pub-id pub-id-type="pmid">20181274</pub-id>
      </element-citation>
    </ref>
    <ref id="CR27">
      <label>27.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ragan</surname>
            <given-names>MA</given-names>
          </name>
        </person-group>
        <article-title>Phylogenetic inference based on matrix representation of trees</article-title>
        <source>Mol Phylogenet Evol</source>
        <year>1992</year>
        <volume>1</volume>
        <issue>1</issue>
        <fpage>53</fpage>
        <lpage>58</lpage>
        <pub-id pub-id-type="doi">10.1016/1055-7903(92)90035-F</pub-id>
        <?supplied-pmid 1342924?>
        <pub-id pub-id-type="pmid">1342924</pub-id>
      </element-citation>
    </ref>
    <ref id="CR28">
      <label>28.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Nguyen</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Mirarab</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Warnow</surname>
            <given-names>T</given-names>
          </name>
        </person-group>
        <article-title>MRL and SuperFine+MRL: new supertree methods</article-title>
        <source>Algorithms Mol Biol</source>
        <year>2012</year>
        <volume>7</volume>
        <issue>1</issue>
        <fpage>3</fpage>
        <pub-id pub-id-type="doi">10.1186/1748-7188-7-3</pub-id>
        <?supplied-pmid 22280525?>
        <pub-id pub-id-type="pmid">22280525</pub-id>
      </element-citation>
    </ref>
    <ref id="CR29">
      <label>29.</label>
      <mixed-citation publication-type="other">Warnow T. Supertree construction: opportunities and challenges. ArXiv e-prints; 2018. <ext-link ext-link-type="uri" xlink:href="http://arxiv.org/abs/1805.03530">arXiv:1805.03530</ext-link></mixed-citation>
    </ref>
    <ref id="CR30">
      <label>30.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zhang</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Rabiee</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Sayyari</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Mirarab</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>ASTRAL-III: polynomial time species tree reconstruction from partially resolved gene trees</article-title>
        <source>BMC Bioinform</source>
        <year>2018</year>
        <volume>19</volume>
        <issue>6</issue>
        <fpage>153</fpage>
        <pub-id pub-id-type="doi">10.1186/s12859-018-2129-y</pub-id>
      </element-citation>
    </ref>
    <ref id="CR31">
      <label>31.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Stamatakis</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>RAxML version 8: a tool for phylogenetic analysis and post-analysis of large phylogenies</article-title>
        <source>Bioinformatics</source>
        <year>2014</year>
        <volume>30</volume>
        <issue>9</issue>
        <fpage>1312</fpage>
        <lpage>1313</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btu033</pub-id>
        <?supplied-pmid 24451623?>
        <pub-id pub-id-type="pmid">24451623</pub-id>
      </element-citation>
    </ref>
    <ref id="CR32">
      <label>32.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Steel</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>The complexity of reconstructing trees from qualitative characters and subtrees</article-title>
        <source>J Classif</source>
        <year>1992</year>
        <volume>9</volume>
        <issue>1</issue>
        <fpage>91</fpage>
        <lpage>116</lpage>
        <pub-id pub-id-type="doi">10.1007/BF02618470</pub-id>
      </element-citation>
    </ref>
    <ref id="CR33">
      <label>33.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Warnow</surname>
            <given-names>TJ</given-names>
          </name>
        </person-group>
        <article-title>Tree compatibility and inferring evolutionary history</article-title>
        <source>J Algorithms</source>
        <year>1994</year>
        <volume>16</volume>
        <issue>3</issue>
        <fpage>388</fpage>
        <lpage>407</lpage>
        <pub-id pub-id-type="doi">10.1006/jagm.1994.1018</pub-id>
      </element-citation>
    </ref>
    <ref id="CR34">
      <label>34.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Aho</surname>
            <given-names>AV</given-names>
          </name>
          <name>
            <surname>Sagiv</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Szymanski</surname>
            <given-names>TG</given-names>
          </name>
          <name>
            <surname>Ullman</surname>
            <given-names>JD</given-names>
          </name>
        </person-group>
        <article-title>Inferring a tree from lowest common ancestors with an application to the optimization of relational expressions</article-title>
        <source>SIAM J Comput</source>
        <year>1981</year>
        <volume>10</volume>
        <issue>3</issue>
        <fpage>405</fpage>
        <lpage>421</lpage>
        <pub-id pub-id-type="doi">10.1137/0210030</pub-id>
      </element-citation>
    </ref>
    <ref id="CR35">
      <label>35.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Mirarab</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Nguyen</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Guo</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>L-S</given-names>
          </name>
          <name>
            <surname>Kim</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Warnow</surname>
            <given-names>T</given-names>
          </name>
        </person-group>
        <article-title>PASTA: ultra-large multiple sequence alignment for nucleotide and amino-acid sequences</article-title>
        <source>J Comput Biol</source>
        <year>2015</year>
        <volume>22</volume>
        <issue>5</issue>
        <fpage>377</fpage>
        <lpage>386</lpage>
        <pub-id pub-id-type="doi">10.1089/cmb.2014.0156</pub-id>
        <?supplied-pmid 25549288?>
        <pub-id pub-id-type="pmid">25549288</pub-id>
      </element-citation>
    </ref>
    <ref id="CR36">
      <label>36.</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Gascuel</surname>
            <given-names>O</given-names>
          </name>
        </person-group>
        <person-group person-group-type="editor">
          <name>
            <surname>Roberts</surname>
            <given-names>FS</given-names>
          </name>
          <name>
            <surname>Rzhetsky</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>Concerning the NJ algorithm and its unweighted version, UNJ</article-title>
        <source>Mathematical hierarchies and biology</source>
        <year>1997</year>
        <publisher-loc>Providence</publisher-loc>
        <publisher-name>American Mathematical Society</publisher-name>
        <fpage>149</fpage>
        <lpage>170</lpage>
      </element-citation>
    </ref>
    <ref id="CR37">
      <label>37.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Atteson</surname>
            <given-names>K</given-names>
          </name>
        </person-group>
        <article-title>The performance of neighbor-joining methods of phylogenetic reconstruction</article-title>
        <source>Algorithmica</source>
        <year>1999</year>
        <volume>25</volume>
        <issue>2–3</issue>
        <fpage>251</fpage>
        <lpage>278</lpage>
        <pub-id pub-id-type="doi">10.1007/PL00008277</pub-id>
      </element-citation>
    </ref>
    <ref id="CR38">
      <label>38.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bryant</surname>
            <given-names>D</given-names>
          </name>
        </person-group>
        <article-title>On the uniqueness of the selection criterion in neighbor-joining</article-title>
        <source>J Classif</source>
        <year>2005</year>
        <volume>22</volume>
        <fpage>3</fpage>
        <lpage>15</lpage>
        <pub-id pub-id-type="doi">10.1007/s00357-005-0003-x</pub-id>
      </element-citation>
    </ref>
    <ref id="CR39">
      <label>39.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Tavaré</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>Some probabilistic and statistical problems in the analysis of DNA sequences</article-title>
        <source>Lect Math Life Sci</source>
        <year>1986</year>
        <volume>17</volume>
        <issue>2</issue>
        <fpage>57</fpage>
        <lpage>86</lpage>
      </element-citation>
    </ref>
    <ref id="CR40">
      <label>40.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Allman</surname>
            <given-names>ES</given-names>
          </name>
          <name>
            <surname>Degnan</surname>
            <given-names>JH</given-names>
          </name>
          <name>
            <surname>Rhodes</surname>
            <given-names>JA</given-names>
          </name>
        </person-group>
        <article-title>Species tree inference from gene splits by unrooted STAR methods</article-title>
        <source>IEEE/ACM Trans Comput Biol Bioinform</source>
        <year>2018</year>
        <volume>15</volume>
        <issue>1</issue>
        <fpage>337</fpage>
        <lpage>342</lpage>
        <pub-id pub-id-type="doi">10.1109/TCBB.2016.2604812</pub-id>
        <?supplied-pmid 28113601?>
        <pub-id pub-id-type="pmid">28113601</pub-id>
      </element-citation>
    </ref>
    <ref id="CR41">
      <label>41.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Vachaspati</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Warnow</surname>
            <given-names>T</given-names>
          </name>
        </person-group>
        <article-title>ASTRID: accurate species trees from internode distances</article-title>
        <source>BMC Genom</source>
        <year>2015</year>
        <volume>16</volume>
        <issue>10</issue>
        <fpage>3</fpage>
        <pub-id pub-id-type="doi">10.1186/1471-2164-16-S10-S3</pub-id>
      </element-citation>
    </ref>
    <ref id="CR42">
      <label>42.</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Neyman</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <person-group person-group-type="editor">
          <name>
            <surname>Gupta</surname>
            <given-names>SS</given-names>
          </name>
          <name>
            <surname>Yackel</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>Molecular studies of evolution: a source of novel statistical problems</article-title>
        <source>Statistical decision theory and related topics</source>
        <year>1971</year>
        <publisher-loc>Cambridge</publisher-loc>
        <publisher-name>Academic Press</publisher-name>
        <fpage>1</fpage>
        <lpage>27</lpage>
      </element-citation>
    </ref>
    <ref id="CR43">
      <label>43.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Felsenstein</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>Evolutionary trees from DNA sequences: a maximum likelihood approach</article-title>
        <source>J Mol Evol</source>
        <year>1981</year>
        <volume>17</volume>
        <issue>6</issue>
        <fpage>368</fpage>
        <lpage>376</lpage>
        <pub-id pub-id-type="doi">10.1007/BF01734359</pub-id>
        <?supplied-pmid 7288891?>
        <pub-id pub-id-type="pmid">7288891</pub-id>
      </element-citation>
    </ref>
    <ref id="CR44">
      <label>44.</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Mitrinović</surname>
            <given-names>DS</given-names>
          </name>
        </person-group>
        <source>Analytic inequalities</source>
        <year>1970</year>
        <publisher-loc>New York</publisher-loc>
        <publisher-name>Springer</publisher-name>
      </element-citation>
    </ref>
    <ref id="CR45">
      <label>45.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Mirarab</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Warnow</surname>
            <given-names>T</given-names>
          </name>
        </person-group>
        <article-title>ASTRAL-II: coalescent-based species tree estimation with many hundreds of taxa and thousands of genes</article-title>
        <source>Bioinformatics</source>
        <year>2015</year>
        <volume>31</volume>
        <issue>12</issue>
        <fpage>44</fpage>
        <lpage>52</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btv234</pub-id>
      </element-citation>
    </ref>
    <ref id="CR46">
      <label>46.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Robinson</surname>
            <given-names>DF</given-names>
          </name>
          <name>
            <surname>Foulds</surname>
            <given-names>LR</given-names>
          </name>
        </person-group>
        <article-title>Comparison of phylogenetic trees</article-title>
        <source>Math Biosci</source>
        <year>1981</year>
        <volume>53</volume>
        <issue>1</issue>
        <fpage>131</fpage>
        <lpage>147</lpage>
        <pub-id pub-id-type="doi">10.1016/0025-5564(81)90043-2</pub-id>
      </element-citation>
    </ref>
    <ref id="CR47">
      <label>47.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Mallo</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>De Oliveira Martins</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Posada</surname>
            <given-names>D</given-names>
          </name>
        </person-group>
        <article-title>SimPhy: phylogenomic simulation of gene, locus, and species trees</article-title>
        <source>Syst Biol</source>
        <year>2016</year>
        <volume>65</volume>
        <issue>2</issue>
        <fpage>334</fpage>
        <lpage>344</lpage>
        <pub-id pub-id-type="doi">10.1093/sysbio/syv082</pub-id>
        <?supplied-pmid 26526427?>
        <pub-id pub-id-type="pmid">26526427</pub-id>
      </element-citation>
    </ref>
    <ref id="CR48">
      <label>48.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Fletcher</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Yang</surname>
            <given-names>Z</given-names>
          </name>
        </person-group>
        <article-title>INDELible: a flexible simulator of biological sequence evolution</article-title>
        <source>Mol Biol Evol</source>
        <year>2009</year>
        <volume>26</volume>
        <issue>8</issue>
        <fpage>1879</fpage>
        <lpage>1888</lpage>
        <pub-id pub-id-type="doi">10.1093/molbev/msp098</pub-id>
        <?supplied-pmid 19423664?>
        <pub-id pub-id-type="pmid">19423664</pub-id>
      </element-citation>
    </ref>
    <ref id="CR49">
      <label>49.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Jarvis</surname>
            <given-names>ED</given-names>
          </name>
          <name>
            <surname>Mirarab</surname>
            <given-names>S</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Whole-genome analyses resolve early branches in the tree of life of modern birds</article-title>
        <source>Science</source>
        <year>2014</year>
        <volume>346</volume>
        <issue>6215</issue>
        <fpage>1320</fpage>
        <lpage>1331</lpage>
        <pub-id pub-id-type="doi">10.1126/science.1253451</pub-id>
        <?supplied-pmid 25504713?>
        <pub-id pub-id-type="pmid">25504713</pub-id>
      </element-citation>
    </ref>
    <ref id="CR50">
      <label>50.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Price</surname>
            <given-names>MN</given-names>
          </name>
          <name>
            <surname>Dehal</surname>
            <given-names>PS</given-names>
          </name>
          <name>
            <surname>Arkin</surname>
            <given-names>AP</given-names>
          </name>
        </person-group>
        <article-title>FastTree 2—approximately maximum-likelihood trees for large alignments</article-title>
        <source>PLoS ONE</source>
        <year>2010</year>
        <volume>5</volume>
        <issue>3</issue>
        <fpage>1</fpage>
        <lpage>10</lpage>
        <pub-id pub-id-type="doi">10.1371/journal.pone.0009490</pub-id>
      </element-citation>
    </ref>
    <ref id="CR51">
      <label>51.</label>
      <mixed-citation publication-type="other">Swofford DL. PAUP* (*Phylogenetic Analysis using PAUP); 2018. <ext-link ext-link-type="uri" xlink:href="http://phylosolutions.com/paup-test/">http://phylosolutions.com/paup-test/</ext-link>.</mixed-citation>
    </ref>
    <ref id="CR52">
      <label>52.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lefort</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Desper</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Gascuel</surname>
            <given-names>O</given-names>
          </name>
        </person-group>
        <article-title>FastME 2.0: a comprehensive, accurate, and fast distance-based phylogeny inference program</article-title>
        <source>Mol Biol Evol</source>
        <year>2015</year>
        <volume>32</volume>
        <issue>10</issue>
        <fpage>2798</fpage>
        <lpage>2800</lpage>
        <pub-id pub-id-type="doi">10.1093/molbev/msv150</pub-id>
        <?supplied-pmid 26130081?>
        <pub-id pub-id-type="pmid">26130081</pub-id>
      </element-citation>
    </ref>
    <ref id="CR53">
      <label>53.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Sukumaran</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Holder</surname>
            <given-names>MT</given-names>
          </name>
        </person-group>
        <article-title>DendroPy: a Python library for phylogenetic computing</article-title>
        <source>Bioinformatics</source>
        <year>2010</year>
        <volume>26</volume>
        <issue>12</issue>
        <fpage>1569</fpage>
        <lpage>1571</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btq228</pub-id>
        <?supplied-pmid 20421198?>
        <pub-id pub-id-type="pmid">20421198</pub-id>
      </element-citation>
    </ref>
    <ref id="CR54">
      <label>54.</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Molloy</surname>
            <given-names>Erin K.</given-names>
          </name>
          <name>
            <surname>Warnow</surname>
            <given-names>Tandy</given-names>
          </name>
        </person-group>
        <article-title>NJMerge: A Generic Technique for Scaling Phylogeny Estimation Methods and Its Application to Species Trees</article-title>
        <source>Comparative Genomics</source>
        <year>2018</year>
        <publisher-loc>Cham</publisher-loc>
        <publisher-name>Springer International Publishing</publisher-name>
        <fpage>260</fpage>
        <lpage>276</lpage>
      </element-citation>
    </ref>
    <ref id="CR55">
      <label>55.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Swenson</surname>
            <given-names>MS</given-names>
          </name>
          <name>
            <surname>Suri</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Linder</surname>
            <given-names>CR</given-names>
          </name>
          <name>
            <surname>Warnow</surname>
            <given-names>T</given-names>
          </name>
        </person-group>
        <article-title>An experimental study of Quartets MaxCut and other supertree methods</article-title>
        <source>Algorithms Mol Biol</source>
        <year>2011</year>
        <volume>6</volume>
        <issue>1</issue>
        <fpage>7</fpage>
        <pub-id pub-id-type="doi">10.1186/1748-7188-6-7</pub-id>
        <?supplied-pmid 21504600?>
        <pub-id pub-id-type="pmid">21504600</pub-id>
      </element-citation>
    </ref>
    <ref id="CR56">
      <label>56.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Xu</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Yang</surname>
            <given-names>Z</given-names>
          </name>
        </person-group>
        <article-title>Challenges in species tree estimation under the multispecies coalescent model</article-title>
        <source>Genetics</source>
        <year>2016</year>
        <volume>204</volume>
        <issue>4</issue>
        <fpage>1353</fpage>
        <lpage>1368</lpage>
        <pub-id pub-id-type="doi">10.1534/genetics.116.190173</pub-id>
        <?supplied-pmid 27927902?>
        <pub-id pub-id-type="pmid">27927902</pub-id>
      </element-citation>
    </ref>
    <ref id="CR57">
      <label>57.</label>
      <mixed-citation publication-type="other">Zhang QR, Rao S, Warnow TJ. New absolute fast converging phylogeny estimation methods with improved scalability and accuracy. In: 18th international workshop on algorithms in bioinformatics, WABI 2018, August 20–22, 2018, Helsinki, Finland. 2018. pp. 8–1812. 10.4230/LIPIcs.WABI.2018.8</mixed-citation>
    </ref>
  </ref-list>
</back>
