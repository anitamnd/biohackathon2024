<?npg-journal-abbreviation?>
<?DTDIdentifier.IdentifierValue -//NPGSJ//DTD full length article DTD version 7.0 XML//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName ajarticle_v7_x.dtd?>
<?SourceDTD.Version 7.0?>
<?ConverterInfo.XSLTName naturesa2nlmx2.xsl?>
<?ConverterInfo.Version 2?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Pharmacogenomics J</journal-id>
    <journal-id journal-id-type="iso-abbrev">Pharmacogenomics J</journal-id>
    <journal-title-group>
      <journal-title>The Pharmacogenomics Journal</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1470-269X</issn>
    <issn pub-type="epub">1473-1150</issn>
    <publisher>
      <publisher-name>Nature Publishing Group</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">3772955</article-id>
    <article-id pub-id-type="pii">tpj201318</article-id>
    <article-id pub-id-type="doi">10.1038/tpj.2013.18</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Original Article</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>HIBAG—HLA genotype imputation with attribute bagging</article-title>
      <alt-title alt-title-type="running">HLA imputation</alt-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Zheng</surname>
          <given-names>X</given-names>
        </name>
        <xref ref-type="aff" rid="aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Shen</surname>
          <given-names>J</given-names>
        </name>
        <xref ref-type="aff" rid="aff2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Cox</surname>
          <given-names>C</given-names>
        </name>
        <xref ref-type="aff" rid="aff3">3</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Wakefield</surname>
          <given-names>J C</given-names>
        </name>
        <xref ref-type="aff" rid="aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Ehm</surname>
          <given-names>M G</given-names>
        </name>
        <xref ref-type="aff" rid="aff2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Nelson</surname>
          <given-names>M R</given-names>
        </name>
        <xref ref-type="aff" rid="aff2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Weir</surname>
          <given-names>B S</given-names>
        </name>
        <xref ref-type="aff" rid="aff1">1</xref>
        <xref ref-type="corresp" rid="caf1">*</xref>
      </contrib>
      <aff id="aff1"><label>1</label><institution>Department of Biostatistics, University of Washington</institution>, Seattle, WA, <country>USA</country></aff>
      <aff id="aff2"><label>2</label><institution>Quantitative Sciences, GlaxoSmithKline</institution>, Research Triangle Park, NC, <country>USA</country></aff>
      <aff id="aff3"><label>3</label><institution>Quantitative Sciences, GlaxoSmithKline</institution>, Stevenage, <country>UK</country></aff>
    </contrib-group>
    <author-notes>
      <corresp id="caf1"><label>*</label><institution>Department of Biostatistics, University of Washington</institution>, Box 357232, Seattle, WA 98195-7232, <country>USA</country>. E-mail: <email>bsweir@u.washington.edu</email></corresp>
    </author-notes>
    <pub-date pub-type="ppub">
      <month>04</month>
      <year>2014</year>
    </pub-date>
    <pub-date pub-type="epub">
      <day>28</day>
      <month>05</month>
      <year>2013</year>
    </pub-date>
    <volume>14</volume>
    <issue>2</issue>
    <fpage>192</fpage>
    <lpage>200</lpage>
    <history>
      <date date-type="received">
        <day>08</day>
        <month>08</month>
        <year>2012</year>
      </date>
      <date date-type="rev-recd">
        <day>15</day>
        <month>02</month>
        <year>2013</year>
      </date>
      <date date-type="accepted">
        <day>18</day>
        <month>03</month>
        <year>2013</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>Copyright © 2014 Macmillan Publishers Limited</copyright-statement>
      <copyright-year>2014</copyright-year>
      <copyright-holder>Macmillan Publishers Limited</copyright-holder>
      <license xmlns:xlink="http://www.w3.org/1999/xlink" license-type="open-access" xlink:href="http://creativecommons.org/licenses/by/3.0/">
        <!--author-paid-->
        <license-p>This work is licensed under a Creative Commons Attribution 3.0 Unported License. To view a copy of this license, visit http://creativecommons.org/licenses/by/3.0/</license-p>
      </license>
    </permissions>
    <abstract>
      <p>Genotyping of classical human leukocyte antigen (HLA) alleles is an essential tool in the analysis of diseases and adverse drug reactions with associations mapping to the major histocompatibility complex (MHC). However, deriving high-resolution HLA types subsequent to whole-genome single-nucleotide polymorphism (SNP) typing or sequencing is often cost prohibitive for large samples. An alternative approach takes advantage of the extended haplotype structure within the MHC to predict HLA alleles using dense SNP genotypes, such as those available from genome-wide SNP panels. Current methods for HLA imputation are difficult to apply or may require the user to have access to large training data sets with SNP and HLA types. We propose HIBAG, HLA Imputation using attribute BAGging, that makes predictions by averaging HLA-type posterior probabilities over an ensemble of classifiers built on bootstrap samples. We assess the performance of HIBAG using our study data (<italic>n</italic>=2668 subjects of European ancestry) as a training set and HLA data from the British 1958 birth cohort study (<italic>n</italic>≈1000 subjects) as independent validation samples. Prediction accuracies for <italic>HLA</italic>-<italic>A</italic>, <italic>B</italic>, <italic>C</italic>, <italic>DRB1</italic> and <italic>DQB1</italic> range from 92.2% to 98.1% using a set of SNP markers common to the Illumina 1M Duo, OmniQuad, OmniExpress, 660K and 550K platforms. HIBAG performed well compared with the other two leading methods, HLA*IMP and BEAGLE. This method is implemented in a freely available HIBAG R package that includes pre-fit classifiers for European, Asian, Hispanic and African ancestries, providing a readily available imputation approach without the need to have access to large training data sets.</p>
    </abstract>
    <kwd-group>
      <kwd>HLA</kwd>
      <kwd>MHC</kwd>
      <kwd>imputation</kwd>
      <kwd>GWAS</kwd>
      <kwd>HLA*IMP</kwd>
      <kwd>BEAGLE</kwd>
    </kwd-group>
  </article-meta>
</front>
<body>
  <sec sec-type="intro">
    <title>Introduction</title>
    <p>The human leukocyte antigen (HLA) system, located in the major histocompatibility complex (MHC) on chromosome 6p21.3, is highly polymorphic. This region has been shown to be important in human disease, adverse drug reactions and organ transplantation.<sup><xref ref-type="bibr" rid="bib1">1</xref></sup> HLA genes have a role in the immune system and autoimmunity as they are central to the presentation of antigens for recognition by T cells. As they have to provide defense against a great diversity of environmental microbes, HLA genes must be able to present a wide range of peptides. Evolutionary pressure at these loci has given rise to a great deal of functional diversity. For example, the <italic>HLA-B</italic> locus has 1898 four-digit alleles listed in the April 2012 release of the IMGT-HLA Database<sup><xref ref-type="bibr" rid="bib2">2</xref></sup> (<ext-link xmlns:xlink="http://www.w3.org/1999/xlink" ext-link-type="uri" xlink:href="http://www.ebi.ac.uk/imgt/hla/">http://www.ebi.ac.uk/imgt/hla/</ext-link>).</p>
    <p>Classical HLA genotyping methodologies have been predominantly developed for tissue typing purposes, with sequence-based typing (SBT) approaches currently considered the gold standard. Although there is widespread availability of vendors offering HLA genotyping services, the complexities involved in performing this to the standard required for diagnostic purposes make using a SBT approach time-consuming and cost-prohibitive for most research studies wishing to look in detail at the involvement of classical HLA genes in disease. Previous studies have suggested that the existence of some HLA alleles can be predicted by a single-nucleotide polymorphism (SNP)-based tagging approach.<sup><xref ref-type="bibr" rid="bib3">3</xref>, <xref ref-type="bibr" rid="bib4">4</xref></sup> However, SNP-based tagging does not offer a definitive solution to HLA genotyping by prediction as many HLA alleles are found on multiple haplotype backgrounds<sup><xref ref-type="bibr" rid="bib5">5</xref></sup> that differ among populations.</p>
    <p>An alternative to tagging is to use more SNP information to impute HLA types. Multiple methods have been developed for this problem, including LDMhc,<sup><xref ref-type="bibr" rid="bib5">5</xref>, <xref ref-type="bibr" rid="bib6">6</xref></sup> as well as applying general genotype imputation methods such as BEAGLE.<sup><xref ref-type="bibr" rid="bib7">7</xref></sup> To be effective, these methods require access to a large and ethnically diverse training data set with both SNP and HLA alleles genotyped. To impute HLA types from multiple SNP markers, Leslie <italic>et al.</italic><sup><xref ref-type="bibr" rid="bib5">5</xref></sup> used an identity-by-descent model based on approximate coalescent models<sup><xref ref-type="bibr" rid="bib8">8</xref></sup> to develop their LDMhc algorithm, and used a leave-one-out cross-validation scheme for SNP selection. Dilthey <italic>et al.</italic><sup><xref ref-type="bibr" rid="bib6">6</xref></sup> subsequently developed integrated software HLA*IMP for imputing classical HLA alleles from SNP genotypes based on LDMhc, with a modified SNP selection function that leads to pronounced increases in call rate. A training set of SNP haplotypes with known HLA alleles are required by LDMhc, as well as a fine genetic map of the region,<sup><xref ref-type="bibr" rid="bib6">6</xref></sup> whereas most experimental techniques for determining SNPs provide genotypes rather than haplotypes. Inferring haplotypes from genotypes can be done with the statistical method of approximating coalescent models, PHASE,<sup><xref ref-type="bibr" rid="bib9">9</xref></sup> or newer algorithms like fastPHASE,<sup><xref ref-type="bibr" rid="bib10">10</xref></sup> MACH<sup><xref ref-type="bibr" rid="bib11">11</xref></sup> and IMPUTE2.<sup><xref ref-type="bibr" rid="bib12">12</xref></sup></p>
    <p>BEAGLE, an alternative imputation method to the approximate coalescent approach, allows for the prediction of multiallelic loci.<sup><xref ref-type="bibr" rid="bib7">7</xref></sup> It locally clusters the observed haplotypes at each position, based on similarity of the haplotypes at markers in the local vicinity.<sup><xref ref-type="bibr" rid="bib13">13</xref></sup> It is a computationally efficient approach with high accuracy for thousands of samples and markers. Recently, it was used for HLA imputation in a genetic association analysis.<sup><xref ref-type="bibr" rid="bib14">14</xref></sup> That study illustrates how imputation of functional variation can help fine-map association signals in the MHC.</p>
    <p>Here we propose a new method for HLA Imputation using attribute BAGging, HIBAG, that is highly accurate, computationally tractable and can be used with published parameter estimates, eliminating the need to access large training samples. It combines the concepts of attribute bagging with haplotype inference from unphased SNPs and HLA types. Attribute bagging is a technique for improving the accuracy and stability of classifier ensembles deduced using bootstrap aggregating and random subsets of variables,<sup><xref ref-type="bibr" rid="bib15">15</xref>, <xref ref-type="bibr" rid="bib16">16</xref>, <xref ref-type="bibr" rid="bib17">17</xref></sup> as shown in <xref ref-type="fig" rid="fig1">Figure 1</xref>. In this case, individual classifiers are created that utilize a subset of SNPs to predict HLA types and haplotype frequencies estimated from a training data set of SNPs and HLA types. Each of the classifiers employs a variable selection algorithm with a random component to select a subset of the SNPs. HLA-type predictions are determined by maximizing the average posterior probabilities from all classifiers. Compared with LDMhc and BEAGLE, HIBAG has only the minimal assumption of Hardy–Weinberg equilibrium (HWE).</p>
    <p>We investigate the overall performance of HIBAG using HLA types and SNP genotypes from HapMap, the British 1958 birth cohort data of the Wellcome Trust Case Control Consortium (WTCCC) and HLARES data from GlaxoSmithKline (GSK) clinical trials. We compare HIBAG with two leading methods, HAP*IMP and BEAGLE v3.3. We provide parameter estimates based on our HLA data and software, implementing our method in the freely available HIBAG R package.</p>
  </sec>
  <sec sec-type="materials|methods">
    <title>Materials and methods</title>
    <p>The numbers of individuals with available four-digit HLA types and the numbers of observed HLA alleles are summarized in <xref rid="tbl1" ref-type="table">Table 1</xref> for the HapMap, WTCCC and HLARES, respectively. Note that sample sizes vary among HLA loci due to missing data. Descriptions of these data follow.</p>
    <sec>
      <title>HapMap data</title>
      <p>The HapMap Phase 2 SNP data set consists of (1) 30 parent–offspring trios of Yoruban ancestry from Ibadan in Nigeria, YRI; (2) 30 CEPH trios of European ancestry from Utah, CEU; (3) 45 unrelated Han Chinese from Beijing, CHB; and (4) 45 unrelated individuals from Tokyo in Japan, JPT. The HapMap SNP genotypes (release #28) were downloaded from <ext-link xmlns:xlink="http://www.w3.org/1999/xlink" ext-link-type="uri" xlink:href="http://hapmap.ncbi.nlm.nih.gov/downloads/genotypes/2010-08_phaseII+III/forward/">http://hapmap.ncbi.nlm.nih.gov/downloads/genotypes/2010-08_phaseII+III/forward/</ext-link>. The data set was created by combining genotyping data from several platforms: Affymetrix, Illumina, Perlegen, and so on. When Mendelian errors were detected in a trio, all genotypes for that SNP in that trio were set to missing. SNP markers were selected within the extended MHC (xMHC)<sup><xref ref-type="bibr" rid="bib18">18</xref></sup> on chromosome 6 ranging from 025759242 to 033534827 bp. With a missing call rate threshold of 10%, there were 16 241, 17 160 and 16 896 SNP markers in the xMHC for CEU, YRI and CHB+JPT, respectively.</p>
      <p>High-resolution classical HLA data for <italic>HLA</italic>-<italic>A</italic>, <italic>B</italic>, <italic>C</italic>, <italic>DRB1</italic>, <italic>DQA1</italic>, <italic>DQB1</italic> and <italic>DPB1</italic> were derived by combining genotypes previously published for these samples<sup><xref ref-type="bibr" rid="bib3">3</xref></sup> with SBT data generated by Conexio Genomics (Perth, WA, Australia).</p>
    </sec>
    <sec>
      <title>WTCCC data</title>
      <p>SNP and HLA genotypes for the British 1958 birth cohort (<ext-link xmlns:xlink="http://www.w3.org/1999/xlink" ext-link-type="uri" xlink:href="http://www.b58cgene.sgul.ac.uk/">http://www.b58cgene.sgul.ac.uk/</ext-link>) were downloaded from the European Genotype Archive (<ext-link xmlns:xlink="http://www.w3.org/1999/xlink" ext-link-type="uri" xlink:href="http://www.ebi.ac.uk/ega/">http://www.ebi.ac.uk/ega/</ext-link>). Candidate SNP markers from Illumina Human1M-Duo platform<sup><xref ref-type="bibr" rid="bib19">19</xref></sup> were selected within the xMHC with a 10% threshold of missing SNP genotypes. The final data set included 2922 unrelated individuals and 7601 SNP markers. The HLA data description is available at <ext-link xmlns:xlink="http://www.w3.org/1999/xlink" ext-link-type="uri" xlink:href="https://www-gene.cimr.cam.ac.uk/todd/public_data/HLA/HLA.shtml">https://www-gene.cimr.cam.ac.uk/todd/public_data/HLA/HLA.shtml</ext-link>. Five HLA loci, <italic>HLA</italic>-<italic>A</italic>, <italic>B</italic>, <italic>C</italic>, <italic>DRB1</italic> and <italic>DQB1</italic>, were typed to four digits using the Sequence Specific Oligonucleotide (SSO) and Sequence Specific Primer (SSP) methodologies.</p>
    </sec>
    <sec>
      <title>HLARES data</title>
      <p>SNP data from the xMHC typed using the Illumina 1M and 1M Duo platforms and HLA data were aggregated from several GlaxoSmithKline clinical trials, including subjects of European (<italic>n</italic>=2668), Asian (<italic>n</italic>=720), Hispanic (<italic>n</italic>=439) and African (<italic>n</italic>=173) ancestries. There were 7976 xMHC SNP markers available with &lt;10% missing data. HLA data for GSK clinical trial samples were generated by Conexio Genomics, HistoGenetics (Ossining, NY, USA) and LabCorp (Burlington, NC, USA) using the SBT, SSO and SSP methodologies for <italic>HLA</italic>-<italic>A</italic>, <italic>B</italic>, <italic>C</italic>, <italic>DRB1</italic>, <italic>DQA1</italic>, <italic>DQB1</italic> and <italic>DPB1</italic>.</p>
    </sec>
    <sec>
      <title>Data for performance assessment</title>
      <p>To assess HIBAG performance and build broadly applicable classifiers included in the HIBAG R package, a set of 1564 SNP markers within the xMHC were selected that were available in all the three samples and common to the Illumina 1M Duo, OmniQuad, OmniExpress, 660K and 550K platforms. In the sensitivity analysis, 5316 SNPs within the xMHC genotyped on Illumina 1M Duo platform were used.</p>
      <p>The individuals of this study were self-reported as being of European, Asian, Hispanic or African descent. HLA and SNP genotypes for performance assessment (hereafter referred to as ‘STUDY Data') consist of (1) HLARES data of European ancestry, (2) HLARES data of Asian ancestry and HapMap CHB+JPT, (3) HLARES data of Hispanic ancestry, and (4) African American HLARES data and 60 African parents from HapMap YRI.</p>
    </sec>
  </sec>
  <sec>
    <title>The HIBAG method</title>
    <p>We propose the HIBAG algorithm to impute HLA types, using the bagging method developed by Breiman,<sup><xref ref-type="bibr" rid="bib15">15</xref>, <xref ref-type="bibr" rid="bib20">20</xref></sup> with improvements of variable subset suggested by Breiman<sup><xref ref-type="bibr" rid="bib16">16</xref></sup> and Bryll <italic>et al.</italic>,<sup><xref ref-type="bibr" rid="bib17">17</xref></sup> applied to a haplotype-based classifier. By randomly sampling sets of individuals from a training data set and randomly selecting SNPs from the available SNPs (as is done in the random forest method), we end up with an ensemble classifier that performs well in predicting HLA types. Here we provide a heuristic description of the process and leave algebraic and algorithmic details in the <xref ref-type="app" rid="app1">Appendix</xref>. We describe how we develop a set of classifier predictors and then how a user may apply these predictors for a particular individual.</p>
    <p>We begin with a set of individuals <italic>T</italic> that have both HLA alleles and SNPs genotyped in the xMHC and we take a series of <italic>K</italic> bootstrap samples (with replacement), <italic>B</italic><sub><italic>k</italic></sub>, of individuals from this set, <italic>k</italic>=1, 2, …, <italic>K</italic>. Each <italic>B</italic><sub><italic>k</italic></sub> is of size <italic>n</italic>, including some individuals from <italic>T</italic> who appear more than once and some who do not appear at all. Unselected samples form an ‘out-of-bag' set for the <italic>k</italic>th selection. Breiman<sup><xref ref-type="bibr" rid="bib21">21</xref></sup> pointed out that about 1/<italic>e</italic>≈37% of <italic>T</italic> are out-of-bag for any <italic>B</italic><sub><italic>k</italic></sub>. We construct a classifier <italic>C</italic><sub><italic>k</italic></sub> for <italic>B</italic><sub><italic>k</italic></sub> that estimates HLA types using an optimal subset, <italic>S</italic><sub><italic>k</italic></sub>, of the SNPs. In the following sections, we describe construction of the classifiers <italic>C</italic><sub><italic>k</italic></sub> and selection of the SNP set <italic>S</italic><sub><italic>k</italic></sub>.</p>
    <sec>
      <title>Individual classifiers</title>
      <p>HLA and SNP genotypes available for individuals for each bootstrap sample <italic>B</italic><sub><italic>k</italic></sub> from <italic>T</italic> are used to form haplotypes and their estimated frequencies (<xref ref-type="fig" rid="fig1">Figure 1</xref>) using the EM algorithm assuming HWE<sup><xref ref-type="bibr" rid="bib22">22</xref></sup> as extended to multiple loci:<sup><xref ref-type="bibr" rid="bib23">23</xref>, <xref ref-type="bibr" rid="bib24">24</xref></sup> multi-locus genotype frequencies are assumed to be the products of haplotype frequencies. As the number of possible resolutions of phase increases exponentially with the number of heterozygous loci, a progressive ligation computational strategy<sup><xref ref-type="bibr" rid="bib25">25</xref></sup> is used, in which rare haplotypes with frequency &lt;10<sup>−5</sup> are ignored in order to achieve a computationally tractable algorithm.</p>
      <p>The individual classifier <italic>C</italic><sub><italic>k</italic></sub> is built using the probability of all possible HLA types given the SNP profile observed at <italic>S</italic><sub><italic>k</italic></sub>. The conditional probability follows from the joint probability of an HLA type and the SNP genotypes, and this, in turn, is the sum, over all pairs of haplotypes that are consistent with the observed genotypes, of the products of frequencies of those two haplotypes. For example, HLA heterozygote <italic>A</italic><sub>1</sub><italic>A</italic><sub>2</sub> and one-locus SNP heterozygote profile <italic>s</italic><sub>1</sub><italic>s</italic><sub>2</sub> requires summation over two pairs of haplotypes (<italic>A</italic><sub>1</sub><italic>s</italic><sub>1</sub>,<italic>A</italic><sub>2</sub><italic>s</italic><sub>2</sub>) and (<italic>A</italic><sub>1</sub><italic>s</italic><sub>2</sub>,<italic>A</italic><sub>2</sub><italic>s</italic><sub>1</sub>).</p>
    </sec>
    <sec>
      <title>SNP selection</title>
      <p>In building each classifier, we select a subset <italic>S</italic><sub><italic>k</italic></sub> of SNPs for predicting HLA types to reduce overfitting and assure a computationally tractable method. The selection of <italic>S</italic><sub><italic>k</italic></sub> includes a random and a deterministic component, iteratively sampling a subset <italic>m</italic><sub>try</sub> of the <italic>m</italic> total SNPs at random, adding each of the <italic>m</italic><sub>try</sub> SNPs to <italic>C</italic><sub><italic>k</italic></sub> one at a time, and adding the SNP that results in the highest out-of-bag prediction accuracy to <italic>S</italic><sub><italic>k</italic></sub>. This process is repeated, adding one SNP at a time to <italic>S</italic><sub><italic>k</italic></sub>, until no further improvement in prediction of HLA types is achieved by adding additional SNPs. In our study, the size of <italic>S</italic><sub><italic>k</italic></sub> ranged from 24 to 56 SNPs.</p>
      <p>We set <italic>m</italic><sub>try</sub> to be much less than <italic>m</italic> (the total number of SNPs) to increase the independence of individual classifiers and reduce the variance of the ensemble by distributing classifiers semi-randomly over all SNPs. If <italic>m</italic><sub>try</sub> is too small compared with <italic>m</italic>, the variable selection approach is likely to select less-informative SNP markers. Although this would not necessarily reduce accuracy, it would require larger numbers of classifiers. In general, reducing <italic>m</italic><sub>try</sub> reduces both the correlation and the strength of individual classifiers, whereas increasing it increases both. We have found a value of <inline-formula id="equ1"><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="tpj201318e1.jpg"/></inline-formula> to perform well, as shown in <xref ref-type="supplementary-material" rid="sup1">Supplementary Table S1</xref>. This rule is a recommendation of the random forest method (Hastie <italic>et al.</italic>,<sup><xref ref-type="bibr" rid="bib26">26</xref></sup>, Section 15.3).</p>
    </sec>
    <sec>
      <title>Bootstrap aggregation</title>
      <p>HIBAG is an ensemble classifer that employs bootstrap aggregation, known as bagging. The ensemble classifier is created from <italic>K</italic> bootstrap samples, each using a different set <italic>S</italic><sub><italic>k</italic></sub> of SNPs to build a single classifier <italic>C</italic><sub><italic>k</italic></sub>. We have found that <italic>K</italic>=25 is generally sufficient to provide good performance, although we use <italic>K</italic>=100 below in Results to maximize or stabilize prediction accuracies. A comparison of accuracies among different model parameters <italic>m</italic><sub>try</sub> and <italic>K</italic> is shown in <xref ref-type="supplementary-material" rid="sup1">Supplementary Table S1</xref>.</p>
      <p>Application of HIBAG to a subject with the observed SNP genotypes estimates the probability of each possible HLA type for all <italic>K</italic> classifiers. The process of aggregating (averaging over) the <italic>K</italic> predictors results in greater precision in the prediction probabilities. In this study, we choose the HLA type with the highest probability averaged over the <italic>K</italic> probabilities as the final predicted genotype for estimating measures of prediction quality. However, in other applications, such as in the analysis of genotype–phenotype relationships, the vector of genotype probabilities may be preferred.</p>
    </sec>
    <sec>
      <title>Implementation</title>
      <p>We implemented the algorithm in an R package—HIBAG, which is available at R CRAN (<ext-link xmlns:xlink="http://www.w3.org/1999/xlink" ext-link-type="uri" xlink:href="http://cran.r-project.org/web/packages/HIBAG/index.html">http://cran.r-project.org/web/packages/HIBAG/index.html</ext-link>). To facilitate future use of this method, we have prepared pre-built classifiers based on STUDY Data (described in ‘Data for performance assessment'), which can be used to impute HLA alleles in new SNP data, which are available at <ext-link xmlns:xlink="http://www.w3.org/1999/xlink" ext-link-type="uri" xlink:href="http://www.biostat.washington.edu/">http://www.biostat.washington.edu/bsweir/HIBAG/</ext-link>. These classifiers were constructed using the training data sets, as reported in this paper with supporting test results. This enables users to apply the HIBAG method without needing access to a training data set. Alternatively, the software can build new classifiers from training data supplied by the user, and HIBAG is computationally feasible for much large training samples. As the construction of individual classifiers is independent from each other, building an ensemble model in parallel is possible. As an example, it takes about 52 min to build an individual classifier of <italic>HLA</italic>-<italic>A</italic> on the training samples of European ancestry data (<italic>n</italic>=1504) with 273 SNP markers on average. More details are shown in <xref ref-type="supplementary-material" rid="sup1">Supplementary Table S2</xref>. The computation time while using the published parameters is much less, for example, the algorithm takes at most 41 min for predicting 100 new individuals at <italic>HLA</italic>-<italic>B</italic> locus, as no training is needed.</p>
    </sec>
  </sec>
  <sec sec-type="results">
    <title>Results</title>
    <p>We evaluated the performance of HIBAG by building the classifier using a training sample and imputing HLA types in an independent testing sample and compared the imputed genotypes with experimentally determined HLA types. As a further evaluation, we compared the performance of HIBAG with HLA*IMP and BEAGLE.</p>
    <sec>
      <title>Measures of prediction quality</title>
      <p>Prediction accuracy was used to assess overall model performance, defined as ‘the number of chromosomes with HLA alleles predicted correctly' over ‘the total number of chromosomes'. In addition, sensitivity, specificity, positive predictive value and negative predictive value were used to evaluate the predictive performance for each HLA allele. These standard statistical quantities are defined in <xref ref-type="supplementary-material" rid="sup1">Supplementary Figure S1</xref>. HIBAG produces a posterior probability for each possible HLA type. Placing a minimum threshold on the posterior genotype probability can increase prediction accuracy at the expense of reducing call rates. ‘Call' and ‘No Call' were determined by whether the posterior probability is greater or less than a call threshold (CT).</p>
    </sec>
    <sec>
      <title>Accuracy of imputed HLA types on individuals of European ancestry</title>
      <p>We compared imputed with experimentally determined HLA types for European ancestries. The HIBAG models were built using the HLARES samples of European ancestry as the training data, and the imputation accuracy was assessed with the independent testing data of the British 1958 birth cohort study. We used the set of 1564 MHC SNPs in common among several Illumina platforms for this analysis. Flanking regions from 50 to 1000 kb were evaluated to identify an appropriate size for predicting HLA alleles, and we conservatively chose to use a 500-kb flanking region, including 1042 SNPs, for our published pre-fit classifiers (<xref ref-type="supplementary-material" rid="sup1">Supplementary Figure S2</xref>).</p>
      <p>The locus-specific calling accuracies were estimated from independent testing data sets (<xref rid="tbl2" ref-type="table">Table 2</xref>). In Europeans, without any CT (CT=0) the accuracies range from 92.2% to 98.1% at the five HLA loci. <italic>HLA</italic>-<italic>A</italic> and <italic>DQB1</italic> yielded the highest prediction accuracies, closely followed by <italic>B</italic> and <italic>C</italic>. The lowest accuracy was observed for <italic>DRB1</italic>. We next investigated the influence that setting CTs on posterior probabilities has on calling accuracy and the trade-off this imposes on call rates. The prediction accuracies can be improved by taking the HIBAG posterior genotype probabilities into account with an appropriate CT, and the improvement in accuracy comes at a cost of lower genotype call rates (94.6–99.5%).</p>
      <p>In order to compare the performance with the Oxford HLA imputation framework, HLA*IMP, HLARES data of European ancestry were employed as independent validation samples. The HLA*IMP method is implemented in a web-based application with access to a training data set consisting of HapMap 30 CEU trios, the British 1958 birth cohort data of WTCCC and a small number of additional samples from other projects.<sup><xref ref-type="bibr" rid="bib6">6</xref></sup> Furthermore, using the Illumina 1M option for HLA*IMP, we were able to identify SNPs used for prediction (<xref ref-type="supplementary-material" rid="sup1">Supplementary Table S4</xref>). To enable a fair comparison, the training data set for HIBAG was limited to the HapMap 30 CEU trios and the British 1958 birth cohort data with the 191 SNPs selected by HLA*IMP for prediction. To illustrate the advantages of utilizing additional SNPs, we provide accuracy results for all the Illumina 1M SNPs using the same training subjects. Results are summarized in <xref rid="tbl3" ref-type="table">Table 3</xref>. On the same set of 191 SNPs, HIBAG outperformed HLA*IMP at each locus, especially for <italic>HLA</italic>-<italic>A</italic> (accuracy=96.7% versus 91.0%, respectively). As expected, using more SNP predictors yielded more accurate predictions, although the gains were fairly modest.</p>
    </sec>
    <sec>
      <title>Cross-validation of accuracy for four ancestries</title>
      <p>Except for the 1958 birth cohort study, we did not have more data for independent validation; therefore cross-validation was also conducted with respect to each ethnic group: European, Asian, Hispanic and African. For each ethnicity, we divided STUDY Data (defined in ‘Data for performance assessment') into equal-sized training and validation data sets. The random partitioning strategy produced training and validation data sets with approximately the same numbers of copies of chromosomes with the same HLA alleles. A set of 1564 MHC SNPs in common among several Illumina platforms was used for this analysis. We evaluated flanking regions from 50 to 1000 kb to identify an appropriate size for predicting HLA alleles. In subjects of European ancestry, the average accuracies reach their maximum values by 250 kb (<xref ref-type="supplementary-material" rid="sup1">Supplementary Figure S3</xref>). We conservatively chose to use a 500-kb flanking region, including 1042 SNPs, for subsequent imputation of all ancestries.</p>
      <p>We next investigated the influence that setting CTs on posterior probabilities has on calling accuracy and the trade-off this imposes on call rates. Using 500 kb of flanking markers around each HLA locus, <inline-formula id="equ2"><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="tpj201318e2.jpg"/></inline-formula> as the number of markers randomly sampled in building each classifier and <italic>K</italic>=100 bootstrap samples, we built the HIBAG models with European, Asian, Hispanic and African ancestry training data sets, respectively. As shown in <xref rid="tbl4" ref-type="table">Table 4</xref>, in Europeans where we have the largest sample size, without any CT (CT=0) the accuracies range from 92.1% to 98.8%. <italic>HLA</italic>-<italic>C</italic> and <italic>DQB1</italic> yielded the highest prediction accuracies, closely followed by <italic>A</italic>, <italic>DQA1</italic> and <italic>B</italic>. The lowest accuracies were observed for <italic>DPB1</italic> and <italic>DRB1</italic>. Among non-Europeans, per locus accuracies were uniformly lower than in Europeans and varied substantially from locus to locus. On average, the prediction accuracy was the lowest in subjects of African ancestry. These patterns are due to the differences in training sample size and several aspects of allelic heterogeneity, including the number of alleles, their frequency distribution and the degree of haplotypic mosaicism within four-digit alleles.<sup><xref ref-type="bibr" rid="bib5">5</xref></sup> The results using all Illumina 1M MHC markers were not noticeably better than the intersection across several commonly used Illumina genome-wide panels (<xref ref-type="supplementary-material" rid="sup1">Supplementary Table S3</xref>). We therefore focused on the intersection as a more broadly applicable panel.</p>
      <p>The prediction accuracy can be improved by taking the HIBAG posterior genotype probabilities into account, as those with higher probabilities have a higher likelihood of being a correct call. An empirical relationship between posterior probability and overall accuracy is shown in <xref ref-type="supplementary-material" rid="sup1">Supplementary Figure S4</xref>. The improvement in accuracy comes at a cost of lower genotype call rates, as illustrated in <xref ref-type="fig" rid="fig2">Figure 2</xref> and <xref ref-type="supplementary-material" rid="sup1">Supplementary Figure S5</xref>. All seven loci can achieve &gt;99% calling accuracy with sufficiently stringent choices of posterior probabilities; however, this would lead to call rates &lt;60% in the case of <italic>DRB1</italic> and <italic>DPB1</italic>. The best choice of CT for each locus will vary based on study criteria. We have selected a threshold of 0.5 as a value that has modest effects on both call rate and accuracy. At this threshold, the accuracy range in Europeans increases from 94.8% to 99.2%, with call rates between 90.1% and 98.8%. Among the non-Europeans, in some instances this threshold led to dramatic improvements in accuracies with corresponding decreases in call rates. For example, the accuracy of <italic>HLA</italic>-<italic>B</italic> types in subjects of African ancestry improved from 76.8% to 96.7%, but with a call rate of only 21.1%. This highlights the importance of careful CT selection.</p>
      <p>The performance summaries by HLA locus presented above are an average of the accuracies of each of the alleles observed in the testing data set, weighted by their corresponding frequencies. Details of the predictive characteristics of each HLA allele using a CT of 0.5 are summarized in <xref ref-type="supplementary-material" rid="sup1">Supplementary Tables S5–8</xref>. Some alleles have very high accuracies, whereas others are much lower. Alleles with low accuracy tend to have lower frequencies, as illustrated in <xref ref-type="supplementary-material" rid="sup1">Supplementary Figure S6</xref>. Our study confirms that having 10 copies of an allele in the database is generally sufficient to provide high sensitivity (&gt;90% except for <italic>HLA</italic>-<italic>B</italic> and <italic>DRB1</italic>).<sup><xref ref-type="bibr" rid="bib5">5</xref></sup> We found that in most instances where alleles are miscalled, there is one particular allele that is substituted for the correct one (<xref ref-type="supplementary-material" rid="sup1">Supplementary Table S5</xref>). For example, <italic>HLA</italic>–<italic>DRB1*01:01</italic> has an 8% allele frequency in Europeans and is miscalled just over 5.6% of the time. In every instance that <italic>DRB1*01:01</italic> is miscalled, it is called as <italic>DRB1*01:02</italic>. This miscall is reasonable as <italic>DRB1*01:01</italic> and <italic>DRB1*01:02</italic> both belong to the same serological antigen carried by an allotype <italic>DRB1*01</italic>.</p>
      <p>BEAGLE is commonly used for genotype imputation and is unique among commonly used methods by accommodating multi-allelic variants.<sup><xref ref-type="bibr" rid="bib7">7</xref></sup> It has been used to impute HLA types.<sup><xref ref-type="bibr" rid="bib14">14</xref></sup> We therefore compared the performance of HIBAG with BEAGLE v3.3 (<xref rid="tbl4" ref-type="table">Table 4</xref> and <xref ref-type="supplementary-material" rid="sup1">Supplementary Table S3</xref>). The default settings for BEAGLE were used, except that we increased the number of iterations from 10 to 50, which improves prediction accuracies. Note that the manner of applying BEAGLE in this study is different from that in Raychaudhuri <italic>et al.</italic><sup><xref ref-type="bibr" rid="bib14">14</xref></sup> We applied BEAGLE to impute HLA alleles gene by gene with flanking SNPs, as the efficiency of BEAGLE could be improved by restricting the number of SNPs that are possibly included in the model.</p>
      <p>As BEAGLE does not provide posterior probabilities for predicted HLA types, we compared BEAGLE's imputed HLA types with HIBAG's HLA types assuming no CT. As shown in <xref rid="tbl4" ref-type="table">Table 4</xref>, the prediction accuracies of HIBAG and BEAGLE are similar. For samples of European ancestry, BEAGLE yields higher prediction accuracies than HIBAG at <italic>HLA</italic>–<italic>DRB1</italic> and <italic>DPB1</italic> (92.9% versus 92.1% and 94.7% versus 93.8%, respectively). However, HIBAG performed better at all other loci. For the non-European ancestries, the accuracies of BEAGLE and HIBAG are similar. A clear advantage of HIBAG over BEAGLE in the context of imputing HLA types is that HIBAG can be run efficiently using published classifiers, whereas BEAGLE requires a training data set.</p>
    </sec>
  </sec>
  <sec sec-type="discussion">
    <title>Discussion</title>
    <p>We propose HIBAG, an ensemble classifier, for the imputation of HLA types from dense SNP data. The HIBAG classifier consists of individual classifiers and makes a prediction by averaging HLA-type posterior probabilities over the collection. Our comparisons indicate that HIBAG performs marginally better than HLA*IMP developed by Dilthey <italic>et al.</italic><sup><xref ref-type="bibr" rid="bib6">6</xref></sup> and is comparable with BEAGLE. HIBAG prediction accuracies for individuals of European ancestry range from 94.8% to 99.2% when using a CT of 0.5 with a subset of SNPs common to several popular Illumina platforms.</p>
    <p>Studies that identify significant associations within the MHC may be limited by the high cost of typing required to investigate the contributions of underlying HLA alleles. Our SNP-based method provides an efficient way of imputing HLA types using genome-wide genotype data. A previous study has indicated that MHC-class-I-mediated events, principally involving <italic>HLA</italic>-<italic>B*39</italic>, contribute to the etiology of type 1 diabetes.<sup><xref ref-type="bibr" rid="bib27">27</xref></sup> HLA alleles are associated with some of the strongest adverse drug reactions, for example, <italic>B*57:01</italic> with Abacavir, which is used to treat HIV and AIDS,<sup><xref ref-type="bibr" rid="bib28">28</xref></sup> and <italic>B*58:01</italic> with Allopurinol used primarily to treat hyperuricemia.<sup><xref ref-type="bibr" rid="bib29">29</xref></sup> Our results show that the predictions of <italic>B*57:01</italic> and <italic>B*58:01</italic> have 100% sensitivities and specificities with call rates &gt;95% for Europeans.</p>
    <p>HIBAG produces the posterior probability of each HLA type. A direct application is to use the best-guess genotypes and CT in downstream association analysis, such as an additive logistic regression model.<sup><xref ref-type="bibr" rid="bib14">14</xref></sup> As shown in <xref ref-type="supplementary-material" rid="sup1">Supplementary Figure S4</xref>, individuals with higher posterior probabilities have a higher likelihood of being a correct call, and a CT of 0.5 approximately corresponds to a prediction accuracy of 80%. An alternative could be to model the uncertainty of prediction via posterior probabilities.</p>
    <p>Our method and parameter estimates are freely available in the HIBAG R package. A typical parameter file for imputing HLA types contains only haplotype frequencies at different SNP subsets rather than individual training genotypes. Further, unlike the web-implemented HLA*IMP, HIBAG does not require the uploading of genotype information to a website, which could raise concerns over data privacy, or having access to large training HLA data sets. To facilitate future use of this method, we have prepared pre-fit classifiers based on STUDY Data (defined in ‘Data for performance assessment'), which can be used to impute HLA types in new SNP data. The SNP markers selected in the pre-fit classifiers are common to the Illumina 1M Duo, OmniQuad, OmniExpress, 660K and 550K platforms within a 500-kb flanking region of each HLA gene.</p>
    <p>In our published pre-fit classifiers, we selected 1042 SNPs in total. However, it is possible to find a smaller set of SNPs without sacrificing accuracy using our method. HLA*IMP has developed a selection approach to identify a small set of most informative SNPs for predicting HLA types. With respect to HIBAG, variable selection is implicitly incorporated during the construction of each individual classifier, and more important SNP markers tend to be used more frequently in the ensemble. This use of selection frequency for SNPs provides information to identify a small set of SNPs. The use frequencies of SNPs in the published pre-fit classifiers are shown in <xref ref-type="supplementary-material" rid="sup1">Supplementary Figure S8</xref>. SNPs with low importance do not tend to contribute to accuracy. For example, a threshold of 25 classifiers was used to filter out less important SNPs for European ancestry, and the total number of SNP predictors for <italic>HLA</italic>-<italic>A</italic>, <italic>B</italic>,..., <italic>DPB1</italic> changes from 1042 to 779 without reducing accuracy (data not shown).</p>
    <p>When HLARES data of European ancestry were investigated, the overall accuracies increase with the training sample size but are only slightly improved after 500 training samples, as shown in <xref ref-type="fig" rid="fig3">Figure 3</xref>. Rare alleles with frequency &lt;1% have significantly lower prediction accuracies than the common alleles. The size of sample sets required to accurately type rare alleles using an imputation methodology is impractical. Although we observed 144 unique <italic>HLA</italic>-<italic>B</italic> alleles in our total study population (<italic>n</italic>=5515), typing of &gt;28 000 individuals for <italic>HLA</italic>-<italic>B</italic> by the Nation Marrow Donor Program<sup><xref ref-type="bibr" rid="bib30">30</xref></sup> identified only 184 unique <italic>HLA</italic>-<italic>B</italic> alleles, still representing &lt;10% of the 1898 four-digit <italic>HLA</italic>-<italic>B</italic> alleles currently identified by IMGT.</p>
    <p>The accuracies of common alleles for <italic>HLA</italic>-<italic>A</italic>, <italic>B</italic>, <italic>C</italic> and <italic>DQB1</italic> are &gt;99%, whereas that of <italic>DPB1</italic> is the lowest (∼97%). Possible reasons for imperfect predictions on the alleles of &gt;1% frequency are data quality of genotypes, the ambiguity of HLA alleles due to typing approach, missing SNPs and loss of distinguishable SNP patterns. Leslie <italic>et al.</italic><sup><xref ref-type="bibr" rid="bib5">5</xref></sup> did observe chromosomes that have nearly identical SNP patterns, yet carry different HLA alleles.<sup><xref ref-type="bibr" rid="bib5">5</xref></sup> Denser SNP markers, especially those SNPs in an HLA gene, may increase overall accuracies.</p>
    <p>A simulation study indicates that the HIBAG method is robust to missing SNP markers with a fraction up to 50%, as shown in <xref ref-type="supplementary-material" rid="sup1">Supplementary Figure S7</xref>. The missing SNP fraction of the original validation set is very small (&lt;0.1%). For each simulation run, we randomly remove a fraction of the SNP predictors used in the ensemble classifier (for example, 10, 20%) for the validation set where every validation sample has the same missing SNPs and repeat this procedure 100 times. The box plots of accuracies (CT=0 and 0.5) and call rate are shown. The missing SNPs do not significantly reduce the accuracies for missing fractions &lt;80%, but it does decrease the call rates.</p>
    <p>Whether the HIBAG algorithm is sensitive to deviations from HWE was assessed with multi-ethnic samples where HWE does not hold. For each ethnicity, STUDY data were divided into training and validation sets with equal sizes as described in the previous section. A multi-ethnic HIBAG model was built using all training samples from multiple ethnicities, and then the accuracies were calculated for each validation set. As shown in <xref ref-type="supplementary-material" rid="sup1">Supplementary Table S9</xref>, the prediction accuracies of multi-ethnic models were similar to those of ethnic-specific models without significant decrease; there was even some improvement on accuracies. Furthermore, our algorithm imputes new study subjects one by one; thereby the imputed HLA type of an individual is not affected by the other new subjects. These results indicate that our method is robust to departures from HWE.</p>
    <p>HLA*IMP relies on high-quality haplotypes in the training data,<sup><xref ref-type="bibr" rid="bib5">5</xref></sup> which contain the HLA locus of interest and SNP predictors. However, most experimental techniques for determining SNPs do not provide haplotype information, and the quality of computational phasing of unrelated individuals may not be satisfactory. On the other hand, BEAGLE assumes variable-length Markov chains besides HWE to represent linkage disequilibrium,<sup><xref ref-type="bibr" rid="bib31">31</xref></sup> which is a bias–variance tradeoff in a possibly very high-dimensional problem.<sup><xref ref-type="bibr" rid="bib32">32</xref></sup> As linkage disequilibrium in the xMHC typically follows a complex pattern, HIBAG does not make any assumption except HWE and is possibly more suitable to the complex MHC region than methods with additional assumptions.</p>
    <p>It is important to realize the potential limitations, and our findings should be interpreted with caution. The numbers of HLA alleles documented in the IMGT-HLA database<sup><xref ref-type="bibr" rid="bib2">2</xref></sup> are much larger than the numbers investigated in our study. For example, the numbers of four-digit HLA alleles from IMGT are 1365, 1898 and 1006 at the <italic>HLA</italic>-<italic>A</italic>, <italic>B</italic> and <italic>C</italic> loci, respectively, and new alleles are routinely being discovered, but we have only 85, 144 and 49 alleles, respectively, in our training samples. The prediction accuracies reported here are computed from restricted validation samples whose HLA alleles are present in the training set. Quite large training sets might be required to successfully predict most of HLA alleles in the IMGT-HLA data set, as 10 copies of an allele in the training database are generally thought to be required to provide high sensitivity.<sup><xref ref-type="bibr" rid="bib5">5</xref></sup></p>
    <p>In summary, we propose a new method for HLA type imputation with performance similar to existing methods, including HLA*IMP and BEAGLE, with several differentiating factors. The HIBAG and BEAGLE utilize all the available SNPs in the region, which results in increased accuracy for these methods versus HLA*IMP. The freely available HIBAG method and accompanying parameter estimates (published in this paper) enable the method to be applied without the need to upload data to an external website (that is, HLA*IMP) or to have access to a training data set (BEAGLE).</p>
  </sec>
</body>
<back>
  <ack>
    <p>We thank the many clinical investigators, research nurses, biostatisticians and database specialists who have conducted the British 1958 birth cohort study from Wellcome Trust Case Control Consortium and the GlaxoSmithKline studies and have supported the SNP and HLA type resource. This work was conducted under a collaborative agreement between the University of Washington and GlaxoSmithKline. It was also supported, in part, by NIH Grant GM 75091.</p>
  </ack>
  <app-group>
    <app id="app1">
      <title>Appendix</title>
      <sec>
        <title>Individual classifier</title>
        <p>Let <italic>y</italic> denote an HLA allele, <italic>x</italic> a SNP allele and <italic>g</italic> a SNP genotype. An HLA type at a specified locus is denoted as an unordered pair of alleles <inline-formula id="equ3"><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="tpj201318e3.jpg"/></inline-formula>. Let <italic>n</italic> be the total number of samples, <italic>m</italic> be the total number of candidate SNPs and the index <italic>j</italic> (1⩽ <italic>j</italic> ⩽ <italic>m</italic>) the <italic>j</italic>th SNP marker. An individual classifier <italic>C</italic><sub><italic>k</italic></sub> (<italic>k</italic>=1, 2,…, <italic>K</italic>) is built from the posterior probabilities of HLA types given by the SNP genotypes at a set of loci <italic>S</italic><sub><italic>k</italic></sub>:</p>
        <p>
          <disp-formula id="equ4">
            <graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="tpj201318e4.jpg"/>
          </disp-formula>
        </p>
        <p>where <italic>K</italic> is the total number of classifiers.</p>
        <p>The joint probability over SNP genotypes for an HLA type <inline-formula id="equ5"><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="tpj201318e5.jpg"/></inline-formula> can be estimated from training genotypes via haplotype frequencies. As unexpected haplotypes sometimes are observed in the genotypes of new individuals due to genotyping error, SNP mutation or rare haplotypes with &lt;10<sup>−5</sup> frequency, an error rate per locus (10<sup>−5</sup>) is used. Under the HWE assumption, the joint probability is the summation of frequencies of two associated haplotypes:</p>
        <p>
          <disp-formula id="equ6">
            <graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="tpj201318e6.jpg"/>
          </disp-formula>
        </p>
        <p>where the set Ω represents all haplotype pairs of <inline-formula id="equ7"><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="tpj201318e7.jpg"/></inline-formula> and <inline-formula id="equ8"><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="tpj201318e8.jpg"/></inline-formula> whose genotypes are consistent with the observed ones <inline-formula id="equ9"><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="tpj201318e9.jpg"/></inline-formula>, and <inline-formula id="equ10"><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="tpj201318e10.jpg"/></inline-formula> denotes the frequency of a haplotype <inline-formula id="equ11"><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="tpj201318e11.jpg"/></inline-formula>.</p>
        <p>The haplotype frequencies <inline-formula id="equ12"><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="tpj201318e12.jpg"/></inline-formula> are estimated from the training data <italic>T</italic> and lead to estimated conditional probabilities of genotypes</p>
        <p>
          <disp-formula id="equ13">
            <graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="tpj201318e13.jpg"/>
          </disp-formula>
        </p>
        <p>in <xref ref-type="disp-formula" rid="equ4">equation (1)</xref>. For a new individual with SNP profile <inline-formula id="equ14"><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="tpj201318e14.jpg"/></inline-formula>, the prediction of <italic>T</italic><sub><italic>k</italic></sub> is</p>
        <p>
          <disp-formula id="equ15">
            <graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="tpj201318e15.jpg"/>
          </disp-formula>
        </p>
        <p>
          <xref ref-type="boxed-text" rid="box1"/>
        </p>
        <p>
          <xref ref-type="boxed-text" rid="box2"/>
        </p>
      </sec>
      <sec>
        <title>Attribute bagging algorithm</title>
        <p>The attribute bagging algorithm is shown in Boxes 1 and 2. <italic>K</italic> is the total number of individual classifiers, and <italic>m</italic><sub>try</sub> is the number of variables randomly sampled as candidates for selection (<inline-formula id="equ20"><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="tpj201318e20.jpg"/></inline-formula> by default). For each step of adding a new predictor, <italic>m</italic><sub>try</sub> variables are re-drawn randomly from the candidate SNPs.</p>
        <p>We find in our experiments that <italic>K</italic>=25 is sufficient to give a highly accurate and stable ensemble classifier, and this number of bootstrap replicates was also used by Breiman.<sup><xref ref-type="bibr" rid="bib15">15</xref></sup> The prediction accuracy is not sensitive to <italic>m</italic><sub>try</sub> as all of SNP markers are determined whether or not they are included in the SNP set for each construction of individual classifier. The motivation for selecting <italic>m</italic><sub>try</sub>&lt;<italic>m</italic> is to increase the independence of individual classifiers and reduce the variance of the ensemble by distributing classifiers randomly over all SNPs. However, if <italic>m</italic><sub>try</sub> is too small compared with <italic>m</italic> (for example, <italic>m</italic><sub>try</sub>=1), the variable selection approach is likely to select non- or less-informative SNP markers. Although this would not necessarily reduce accuracy, it would require larger numbers of classifiers. In general, reducing <italic>m</italic><sub>try</sub> reduces both the correlation and the strength of individual classifiers, and increasing it increases both, therefore the optimal range of <italic>m</italic><sub>try</sub> could be usually quite wide. In our experiments, the parameter setting <inline-formula id="equ21"><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="tpj201318e21.jpg"/></inline-formula> is appropriate for both a small set as well as hundreds of SNP predictors after taking the computational burden into account. In this study, we used the parameter settings <italic>K</italic>=100, <inline-formula id="equ22"><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="tpj201318e22.jpg"/></inline-formula> for all the tables and figures.</p>
      </sec>
      <sec>
        <title>Details of the loss criteria:</title>
        <p>Each bootstrap sample <italic>B</italic><sub><italic>k</italic></sub> leaves out 1/<italic>e</italic>≈37% of the training samples, and these left-out samples can be used to form accurate estimates (called out-of-bag estimation).<sup><xref ref-type="bibr" rid="bib21">21</xref></sup> The 0–1 loss of <italic>C</italic><sub><italic>k</italic></sub> is calculated from the out-of-bag samples to avoid over-fitting of that individual classifier. We minimize the 0–1 loss first, and if the 0–1 losses equal each other then choose the SNP marker with the lowest log likelihood loss. We add SNP markers until it is not possible to further reduce both the losses. Unlike the traditional variable selection with a penalty for the number of parameters, for example, the Akaike criterion, our approach adds as many SNP predictors as possible to avoid variable searching stopping too early. Although more variables in an individual classifier result in greater computational complexity and larger variance of estimates, bagging and use of different variable subsets help to improve the stability of ensemble classifier.<sup><xref ref-type="bibr" rid="bib17">17</xref>, <xref ref-type="bibr" rid="bib15">15</xref></sup> We therefore control model over-fitting twice, first at the level of the individual classifier and then at the level of aggregation in the ensemble.</p>
        <p>The 0–1 loss of <italic>C</italic><sub><italic>k</italic></sub> is calculated from the out-of-bag samples to avoid over-fitting of that individual classifier,</p>
        <p>
          <disp-formula id="equ25">
            <graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="tpj201318e25.jpg"/>
          </disp-formula>
        </p>
        <p>and the log likelihood loss of <italic>C</italic><sub><italic>k</italic></sub> is computed to assess fitting the model of haplotype frequencies with the assumption of HWE using the in-bag samples <italic>B</italic><sub><italic>k</italic></sub>,</p>
        <p>
          <disp-formula id="equ26">
            <graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="tpj201318e26.jpg"/>
          </disp-formula>
        </p>
        <p>where the subscript <italic>i</italic> indicates the <italic>i</italic>th individual in <italic>B</italic><sub><italic>k</italic></sub>.</p>
      </sec>
    </app>
  </app-group>
  <fn-group>
    <fn>
      <p><xref ref-type="supplementary-material" rid="sup1">Supplementary Information</xref> accompanies the paper on the The Pharmacogenomics Journal website (http://www.nature.com/tpj)</p>
    </fn>
  </fn-group>
  <notes>
    <p>The authors declare no conflict of interest.</p>
  </notes>
  <ref-list>
    <ref id="bib1">
      <mixed-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Shiina</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Hosomichi</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Inoko</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Kulski</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>The HLA genomic loci map: expression, interaction, diversity and disease</article-title>
        <source>J Human Genet</source>
        <year>2009</year>
        <volume>54</volume>
        <fpage>15</fpage>
        <lpage>39</lpage>
        <pub-id pub-id-type="pmid">19158813</pub-id>
      </mixed-citation>
    </ref>
    <ref id="bib2">
      <mixed-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Robinson</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Halliwell</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>McWilliam</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Lopez</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Parham</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Marsh</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>The IMGT/HLA database</article-title>
        <source>Nucleic Acids Res</source>
        <year>2013</year>
        <volume>41</volume>
        <fpage>1222</fpage>
        <lpage>1227</lpage>
      </mixed-citation>
    </ref>
    <ref id="bib3">
      <mixed-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>de Bakker</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>McVean</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Sabeti</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Miretti</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Green</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Marchini</surname>
            <given-names>J</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>A high-resolution HLA and SNP haplotype map for disease association studies in the extended human MHC</article-title>
        <source>Nat Genet</source>
        <year>2006</year>
        <volume>38</volume>
        <fpage>1166</fpage>
        <lpage>1172</lpage>
        <pub-id pub-id-type="pmid">16998491</pub-id>
      </mixed-citation>
    </ref>
    <ref id="bib4">
      <mixed-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Evseeva</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Nicodemus</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Bonilla</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Tonks</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Bodmer</surname>
            <given-names>W</given-names>
          </name>
        </person-group>
        <article-title>Linkage disequilibrium and age of HLA region SNPs in relation to classic HLA gene alleles within Europe</article-title>
        <source>Eur J Hum Genet</source>
        <year>2010</year>
        <volume>18</volume>
        <fpage>924</fpage>
        <lpage>932</lpage>
        <pub-id pub-id-type="pmid">20354563</pub-id>
      </mixed-citation>
    </ref>
    <ref id="bib5">
      <mixed-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Leslie</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Donnelly</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>McVean</surname>
            <given-names>G</given-names>
          </name>
        </person-group>
        <article-title>A statistical method for predicting classical HLA alleles from SNP data</article-title>
        <source>Am J Hum Genet</source>
        <year>2008</year>
        <volume>82</volume>
        <fpage>48</fpage>
        <lpage>56</lpage>
        <pub-id pub-id-type="pmid">18179884</pub-id>
      </mixed-citation>
    </ref>
    <ref id="bib6">
      <mixed-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Dilthey</surname>
            <given-names>AT</given-names>
          </name>
          <name>
            <surname>Moutsianas</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Leslie</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>McVean</surname>
            <given-names>G</given-names>
          </name>
        </person-group>
        <article-title>HLA*IMP – an integrated framework for imputing classical HLA alleles from SNP genotypes</article-title>
        <source>Bioinformatics</source>
        <year>2011</year>
        <volume>27</volume>
        <fpage>968</fpage>
        <lpage>972</lpage>
        <pub-id pub-id-type="pmid">21300701</pub-id>
      </mixed-citation>
    </ref>
    <ref id="bib7">
      <mixed-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Browning</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Browning</surname>
            <given-names>B</given-names>
          </name>
        </person-group>
        <article-title>Rapid and accurate haplotype phasing and missing-data inference for whole-genome association studies by use of localized haplotype clustering</article-title>
        <source>Am J Hum Genet</source>
        <year>2007</year>
        <volume>81</volume>
        <fpage>1084</fpage>
        <lpage>1097</lpage>
        <pub-id pub-id-type="pmid">17924348</pub-id>
      </mixed-citation>
    </ref>
    <ref id="bib8">
      <mixed-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>McVean</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Cardin</surname>
            <given-names>N</given-names>
          </name>
        </person-group>
        <article-title>Approximating the coalescent with recombination</article-title>
        <source>Philos Trans R Soc Lond B Biol Sci</source>
        <year>2005</year>
        <volume>360</volume>
        <fpage>1387</fpage>
        <lpage>1393</lpage>
        <pub-id pub-id-type="pmid">16048782</pub-id>
      </mixed-citation>
    </ref>
    <ref id="bib9">
      <mixed-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Stephens</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Scheet</surname>
            <given-names>P</given-names>
          </name>
        </person-group>
        <article-title>Accounting for decay of linkage disequilibrium in haplotype inference and missing-data imputation</article-title>
        <source>Am J Hum Genet</source>
        <year>2005</year>
        <volume>76</volume>
        <fpage>449</fpage>
        <lpage>462</lpage>
        <pub-id pub-id-type="pmid">15700229</pub-id>
      </mixed-citation>
    </ref>
    <ref id="bib10">
      <mixed-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Scheet</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Stephens</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>A fast and flexible statistical model for large-scale population genotype data: applications to inferring missing genotypes and haplotypic phase</article-title>
        <source>Am J Hum Genet</source>
        <year>2006</year>
        <volume>78</volume>
        <fpage>629</fpage>
        <lpage>644</lpage>
        <pub-id pub-id-type="pmid">16532393</pub-id>
      </mixed-citation>
    </ref>
    <ref id="bib11">
      <mixed-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Li</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Willer</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Ding</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Scheet</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Abecasis</surname>
            <given-names>G</given-names>
          </name>
        </person-group>
        <article-title>MaCH: using sequence and genotype data to estimate haplotypes and unobserved genotypes</article-title>
        <source>Genet Epidemiol</source>
        <year>2010</year>
        <volume>34</volume>
        <fpage>816</fpage>
        <lpage>834</lpage>
        <pub-id pub-id-type="pmid">21058334</pub-id>
      </mixed-citation>
    </ref>
    <ref id="bib12">
      <mixed-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Howie</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Donnelly</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Marchini</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>A flexible and accurate genotype imputation method for the next generation of genome-wide association studies</article-title>
        <source>PLoS Genet</source>
        <year>2009</year>
        <volume>5</volume>
        <fpage>e1000529</fpage>
        <pub-id pub-id-type="pmid">19543373</pub-id>
      </mixed-citation>
    </ref>
    <ref id="bib13">
      <mixed-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Browning</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Browning</surname>
            <given-names>B</given-names>
          </name>
        </person-group>
        <article-title>Haplotype phasing: existing methods and new developments</article-title>
        <source>Nat Rev Genet</source>
        <year>2011</year>
        <volume>12</volume>
        <fpage>703</fpage>
        <lpage>714</lpage>
        <pub-id pub-id-type="pmid">21921926</pub-id>
      </mixed-citation>
    </ref>
    <ref id="bib14">
      <mixed-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Raychaudhuri</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Sandor</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Stahl</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Freudenberg</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Lee</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Jia</surname>
            <given-names>X</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Five amino acids in three HLA proteins explain most of the association between MHC and seropositive rheumatoid arthritis</article-title>
        <source>Nat Genet</source>
        <year>2012</year>
        <volume>44</volume>
        <fpage>291</fpage>
        <lpage>296</lpage>
        <pub-id pub-id-type="pmid">22286218</pub-id>
      </mixed-citation>
    </ref>
    <ref id="bib15">
      <mixed-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Breiman</surname>
            <given-names>L</given-names>
          </name>
        </person-group>
        <article-title>Bagging predictors</article-title>
        <source>Mach Learn</source>
        <year>1996</year>
        <volume>24</volume>
        <fpage>123</fpage>
        <lpage>140</lpage>
      </mixed-citation>
    </ref>
    <ref id="bib16">
      <mixed-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Breiman</surname>
            <given-names>L</given-names>
          </name>
        </person-group>
        <article-title>Random forests</article-title>
        <source>Mach Learn</source>
        <year>2001</year>
        <volume>45</volume>
        <fpage>5</fpage>
        <lpage>32</lpage>
      </mixed-citation>
    </ref>
    <ref id="bib17">
      <mixed-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bryll</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Gutierrez-Osuna</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Quek</surname>
            <given-names>F</given-names>
          </name>
        </person-group>
        <article-title>Attribute bagging: improving accuracy of classifier ensembles by using random feature subsets</article-title>
        <source>Pattern Recognit</source>
        <year>2003</year>
        <volume>36</volume>
        <fpage>1291</fpage>
        <lpage>1302</lpage>
      </mixed-citation>
    </ref>
    <ref id="bib18">
      <mixed-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Horton</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Wilming</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Rand</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Lovering</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Bruford</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Khodiyar</surname>
            <given-names>V</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Gene map of the extended human MHC</article-title>
        <source>Nat Rev Genet</source>
        <year>2004</year>
        <volume>5</volume>
        <fpage>889</fpage>
        <lpage>899</lpage>
        <pub-id pub-id-type="pmid">15573121</pub-id>
      </mixed-citation>
    </ref>
    <ref id="bib19">
      <mixed-citation publication-type="journal">
        <person-group person-group-type="author">
          <collab>Wellcome Trust Case Control Consortium</collab>
        </person-group>
        <article-title>Genome-wide association study of 14,000 cases of seven common diseases and 3,000 shared controls</article-title>
        <source>Nature</source>
        <year>2007</year>
        <volume>447</volume>
        <fpage>661</fpage>
        <lpage>678</lpage>
        <pub-id pub-id-type="pmid">17554300</pub-id>
      </mixed-citation>
    </ref>
    <ref id="bib20">
      <mixed-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Breiman</surname>
            <given-names>L</given-names>
          </name>
        </person-group>
        <article-title>Heuristics of instability and stabilization in model selection</article-title>
        <source>Ann Stat</source>
        <year>1996</year>
        <volume>24</volume>
        <fpage>2350</fpage>
        <lpage>2383</lpage>
      </mixed-citation>
    </ref>
    <ref id="bib21">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><name><surname>Breiman</surname><given-names>L</given-names></name></person-group>Out-of-bag estimation. Technical Report. University of California: Berkeley, CA, USA, 1996b. ftp.stat.berkeley.edu/pub/users/breiman/OOBestimation.ps.</mixed-citation>
    </ref>
    <ref id="bib22">
      <mixed-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hill</surname>
            <given-names>W</given-names>
          </name>
        </person-group>
        <article-title>Tests for association of gene frequencies at several loci in random mating diploid populations</article-title>
        <source>Biometrics</source>
        <year>1975</year>
        <volume>31</volume>
        <fpage>881</fpage>
        <lpage>888</lpage>
        <pub-id pub-id-type="pmid">1203429</pub-id>
      </mixed-citation>
    </ref>
    <ref id="bib23">
      <mixed-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Long</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Williams</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Urbanek</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>An E-M algorithm and testing strategy for multiple-locus haplotypes</article-title>
        <source>Am J Hum Genet</source>
        <year>1995</year>
        <volume>56</volume>
        <fpage>799</fpage>
        <lpage>810</lpage>
        <pub-id pub-id-type="pmid">7887436</pub-id>
      </mixed-citation>
    </ref>
    <ref id="bib24">
      <mixed-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Qin</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Niu</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Liu</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>Partition-ligation-expectation-maximization algorithm for haplotype inference with single-nucleotide polymorphisms</article-title>
        <source>Am J Hum Genet</source>
        <year>2002</year>
        <volume>71</volume>
        <fpage>1242</fpage>
        <lpage>1247</lpage>
        <pub-id pub-id-type="pmid">12452179</pub-id>
      </mixed-citation>
    </ref>
    <ref id="bib25">
      <mixed-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Niu</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Qin</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Xu</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Liu</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>Bayesian haplotype inference for multiple linked single-nucleotide polymorphisms</article-title>
        <source>Am J Hum Genet</source>
        <year>2002</year>
        <volume>70</volume>
        <fpage>157</fpage>
        <lpage>169</lpage>
        <pub-id pub-id-type="pmid">11741196</pub-id>
      </mixed-citation>
    </ref>
    <ref id="bib26">
      <mixed-citation publication-type="book"><person-group person-group-type="author"><name><surname>Hastie</surname><given-names>T</given-names></name><name><surname>Tibshirani</surname><given-names>R</given-names></name><name><surname>Friedman</surname><given-names>J</given-names></name></person-group><source>The Elements of Statistical Learning: Data Mining, Inference, and Prediction</source>2nd edn<publisher-name>Springer</publisher-name><year>2009</year></mixed-citation>
    </ref>
    <ref id="bib27">
      <mixed-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Nejentsev</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Howson</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Walker</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Szeszko</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Field</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Stevens</surname>
            <given-names>H</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Localization of type 1 diabetes susceptibility to the MHC class I genes HLA-B and HLA-A</article-title>
        <source>Nature</source>
        <year>2007</year>
        <volume>450</volume>
        <fpage>887</fpage>
        <lpage>892</lpage>
        <pub-id pub-id-type="pmid">18004301</pub-id>
      </mixed-citation>
    </ref>
    <ref id="bib28">
      <mixed-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hetherington</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Hughes</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Mosteller</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Shortino</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Baker</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Spreen</surname>
            <given-names>W</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Genetic variations in HLA-B region and hypersensitivity reactions to abacavir</article-title>
        <source>Lancet</source>
        <year>2002</year>
        <volume>359</volume>
        <fpage>1121</fpage>
        <lpage>1122</lpage>
        <pub-id pub-id-type="pmid">11943262</pub-id>
      </mixed-citation>
    </ref>
    <ref id="bib29">
      <mixed-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hung</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Chung</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Liou</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Chu</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Lin</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Huang</surname>
            <given-names>H</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>HLA-B*5801 allele as a genetic marker for severe cutaneous adverse reactions caused by allopurinol</article-title>
        <source>Proc Natl Acad Sci USA</source>
        <year>2005</year>
        <volume>102</volume>
        <fpage>4134</fpage>
        <lpage>4139</lpage>
        <pub-id pub-id-type="pmid">15743917</pub-id>
      </mixed-citation>
    </ref>
    <ref id="bib30">
      <mixed-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Maiers</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Gragert</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Klitz</surname>
            <given-names>W</given-names>
          </name>
        </person-group>
        <article-title>High-resolution HLA alleles and haplotypes in the United States population</article-title>
        <source>Human Immunol</source>
        <year>2007</year>
        <volume>68</volume>
        <fpage>779</fpage>
        <lpage>788</lpage>
        <pub-id pub-id-type="pmid">17869653</pub-id>
      </mixed-citation>
    </ref>
    <ref id="bib31">
      <mixed-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Browning</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>Multilocus association mapping using variable-length Markov chains</article-title>
        <source>Am J Hum Genet</source>
        <year>2006</year>
        <volume>78</volume>
        <fpage>903</fpage>
        <lpage>913</lpage>
        <pub-id pub-id-type="pmid">16685642</pub-id>
      </mixed-citation>
    </ref>
    <ref id="bib32">
      <mixed-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Buhlmann</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Wyner</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>Variable length markov chains</article-title>
        <source>Ann Stat</source>
        <year>1999</year>
        <volume>27</volume>
        <fpage>480</fpage>
        <lpage>513</lpage>
      </mixed-citation>
    </ref>
  </ref-list>
  <sec sec-type="supplementary-material" id="sup1">
    <title>Supplementary Material</title>
    <supplementary-material content-type="local-data" id="xob1">
      <label>Supplementary Information</label>
      <media xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="tpj201318x1.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</back>
<floats-group>
  <fig id="fig1">
    <label>Figure 1</label>
    <caption>
      <p>Overview of the HIBAG prediction algorithm. HIBAG is an ensemble classifier consisting of individual classifiers (<italic>C</italic><sub><italic>k</italic></sub>) with human leukocyte antigen (HLA) and single-nucleotide polymorphism (SNP) haplotype probabilities estimated from bootstrapped samples (<italic>B</italic><sub><italic>k</italic></sub>) and SNP subsets (<italic>S</italic><sub><italic>k</italic></sub>). The SNP subsets are determined by a variable selection algorithm with a random component. HLA-type predictions are averaged over the posterior probabilities from all classifiers.</p>
    </caption>
    <graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="tpj201318f1"/>
  </fig>
  <fig id="fig2">
    <label>Figure 2</label>
    <caption>
      <p>The relationship between accuracy and call rate when HLARES data for individuals of European ancestry are divided into training and validation sets with equal sizes. On the curve for each HLA (human leukocyte antigen) locus, the 0.5 call threshold is indicated by •.</p>
    </caption>
    <graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="tpj201318f2"/>
  </fig>
  <fig id="fig3">
    <label>Figure 3</label>
    <caption>
      <p>The relationship between training sample size and accuracy. HLARES data of European ancestry were divided into training and validation sets with equal sizes, and random subsets of training samples (<italic>n</italic>=100, 250, 500, 750, 1000 and max) were used to build a HIBAG model, which was applied to the same validation samples. No call threshold was applied.</p>
    </caption>
    <graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="tpj201318f3"/>
  </fig>
  <table-wrap id="tbl1">
    <label>Table 1</label>
    <caption>
      <title>The numbers of individuals with four-digit HLA types and the observed number of HLA alleles for each locus</title>
    </caption>
    <table frame="hsides" rules="groups" border="1">
      <colgroup>
        <col align="left"/>
        <col align="char" char="."/>
        <col align="char" char="."/>
        <col align="char" char="."/>
        <col align="char" char="."/>
        <col align="char" char="."/>
        <col align="char" char="."/>
        <col align="char" char="."/>
      </colgroup>
      <thead valign="bottom">
        <tr>
          <th align="left" valign="top" charoff="50"> </th>
          <th colspan="7" align="center" valign="top" char="." charoff="50">
            <italic>HLA type</italic>
            <hr/>
          </th>
        </tr>
        <tr>
          <th align="left" valign="top" charoff="50"> </th>
          <th align="char" valign="top" char="." charoff="50">
            <italic>A</italic>
          </th>
          <th align="char" valign="top" char="." charoff="50">
            <italic>B</italic>
          </th>
          <th align="char" valign="top" char="." charoff="50">
            <italic>C</italic>
          </th>
          <th align="char" valign="top" char="." charoff="50">
            <italic>DRB1</italic>
          </th>
          <th align="char" valign="top" char="." charoff="50">
            <italic>DQA1</italic>
          </th>
          <th align="char" valign="top" char="." charoff="50">
            <italic>DQB1</italic>
          </th>
          <th align="char" valign="top" char="." charoff="50">
            <italic>DPB1</italic>
          </th>
        </tr>
      </thead>
      <tbody valign="top">
        <tr>
          <td colspan="8" align="left" valign="top" charoff="50">
            <italic>Individuals genotyped</italic>
          </td>
        </tr>
        <tr>
          <td colspan="8" align="left" valign="top" charoff="50">
            <italic> HapMap</italic>
          </td>
        </tr>
        <tr>
          <td align="left" valign="top" charoff="50"><italic>  </italic>CEU</td>
          <td align="char" valign="top" char="." charoff="50">90</td>
          <td align="char" valign="top" char="." charoff="50">68</td>
          <td align="char" valign="top" char="." charoff="50">90</td>
          <td align="char" valign="top" char="." charoff="50">90</td>
          <td align="char" valign="top" char="." charoff="50">90</td>
          <td align="char" valign="top" char="." charoff="50">90</td>
          <td align="char" valign="top" char="." charoff="50">90</td>
        </tr>
        <tr>
          <td align="left" valign="top" charoff="50"><italic>  </italic>YRI</td>
          <td align="char" valign="top" char="." charoff="50">90</td>
          <td align="char" valign="top" char="." charoff="50">88</td>
          <td align="char" valign="top" char="." charoff="50">88</td>
          <td align="char" valign="top" char="." charoff="50">89</td>
          <td align="char" valign="top" char="." charoff="50">90</td>
          <td align="char" valign="top" char="." charoff="50">88</td>
          <td align="char" valign="top" char="." charoff="50">12</td>
        </tr>
        <tr>
          <td align="left" valign="top" charoff="50"><italic>  </italic>CHB+JPT</td>
          <td align="char" valign="top" char="." charoff="50">89</td>
          <td align="char" valign="top" char="." charoff="50">89</td>
          <td align="char" valign="top" char="." charoff="50">89</td>
          <td align="char" valign="top" char="." charoff="50">88</td>
          <td align="char" valign="top" char="." charoff="50">89</td>
          <td align="char" valign="top" char="." charoff="50">87</td>
          <td align="char" valign="top" char="." charoff="50">58</td>
        </tr>
        <tr>
          <td align="left" valign="top" charoff="50"> </td>
          <td align="char" valign="top" char="." charoff="50"> </td>
          <td align="char" valign="top" char="." charoff="50"> </td>
          <td align="char" valign="top" char="." charoff="50"> </td>
          <td align="char" valign="top" char="." charoff="50"> </td>
          <td align="char" valign="top" char="." charoff="50"> </td>
          <td align="char" valign="top" char="." charoff="50"> </td>
          <td align="char" valign="top" char="." charoff="50"> </td>
        </tr>
        <tr>
          <td colspan="8" align="left" valign="top" charoff="50">
            <italic> WTCCC</italic>
          </td>
        </tr>
        <tr>
          <td align="left" valign="top" charoff="50"><italic>  </italic>European</td>
          <td align="char" valign="top" char="." charoff="50">884</td>
          <td align="char" valign="top" char="." charoff="50">1532</td>
          <td align="char" valign="top" char="." charoff="50">840</td>
          <td align="char" valign="top" char="." charoff="50">1129</td>
          <td align="char" valign="top" char="." charoff="50">0</td>
          <td align="char" valign="top" char="." charoff="50">1004</td>
          <td align="char" valign="top" char="." charoff="50">0</td>
        </tr>
        <tr>
          <td align="left" valign="top" charoff="50"> </td>
          <td align="char" valign="top" char="." charoff="50"> </td>
          <td align="char" valign="top" char="." charoff="50"> </td>
          <td align="char" valign="top" char="." charoff="50"> </td>
          <td align="char" valign="top" char="." charoff="50"> </td>
          <td align="char" valign="top" char="." charoff="50"> </td>
          <td align="char" valign="top" char="." charoff="50"> </td>
          <td align="char" valign="top" char="." charoff="50"> </td>
        </tr>
        <tr>
          <td colspan="8" align="left" valign="top" charoff="50">
            <italic> HLARES</italic>
          </td>
        </tr>
        <tr>
          <td align="left" valign="top" charoff="50"><italic>  </italic>European</td>
          <td align="char" valign="top" char="." charoff="50">1857</td>
          <td align="char" valign="top" char="." charoff="50">2572</td>
          <td align="char" valign="top" char="." charoff="50">1866</td>
          <td align="char" valign="top" char="." charoff="50">2436</td>
          <td align="char" valign="top" char="." charoff="50">1740</td>
          <td align="char" valign="top" char="." charoff="50">1924</td>
          <td align="char" valign="top" char="." charoff="50">1624</td>
        </tr>
        <tr>
          <td align="left" valign="top" charoff="50"><italic>  </italic>Asian</td>
          <td align="char" valign="top" char="." charoff="50">517</td>
          <td align="char" valign="top" char="." charoff="50">624</td>
          <td align="char" valign="top" char="." charoff="50">522</td>
          <td align="char" valign="top" char="." charoff="50">608</td>
          <td align="char" valign="top" char="." charoff="50">495</td>
          <td align="char" valign="top" char="." charoff="50">525</td>
          <td align="char" valign="top" char="." charoff="50">469</td>
        </tr>
        <tr>
          <td align="left" valign="top" charoff="50"><italic>  </italic>Hispanic</td>
          <td align="char" valign="top" char="." charoff="50">298</td>
          <td align="char" valign="top" char="." charoff="50">430</td>
          <td align="char" valign="top" char="." charoff="50">300</td>
          <td align="char" valign="top" char="." charoff="50">420</td>
          <td align="char" valign="top" char="." charoff="50">269</td>
          <td align="char" valign="top" char="." charoff="50">312</td>
          <td align="char" valign="top" char="." charoff="50">263</td>
        </tr>
        <tr>
          <td align="left" valign="top" charoff="50"><italic>  </italic>African</td>
          <td align="char" valign="top" char="." charoff="50">80</td>
          <td align="char" valign="top" char="." charoff="50">112</td>
          <td align="char" valign="top" char="." charoff="50">80</td>
          <td align="char" valign="top" char="." charoff="50">102</td>
          <td align="char" valign="top" char="." charoff="50">74</td>
          <td align="char" valign="top" char="." charoff="50">78</td>
          <td align="char" valign="top" char="." charoff="50">69</td>
        </tr>
        <tr>
          <td align="left" valign="top" charoff="50"> </td>
          <td align="char" valign="top" char="." charoff="50"> </td>
          <td align="char" valign="top" char="." charoff="50"> </td>
          <td align="char" valign="top" char="." charoff="50"> </td>
          <td align="char" valign="top" char="." charoff="50"> </td>
          <td align="char" valign="top" char="." charoff="50"> </td>
          <td align="char" valign="top" char="." charoff="50"> </td>
          <td align="char" valign="top" char="." charoff="50"> </td>
        </tr>
        <tr>
          <td colspan="8" align="left" valign="top" charoff="50">
            <italic>Unique HLA alleles</italic>
          </td>
        </tr>
        <tr>
          <td align="left" valign="top" charoff="50"><italic> </italic>European</td>
          <td align="char" valign="top" char="." charoff="50">48</td>
          <td align="char" valign="top" char="." charoff="50">88</td>
          <td align="char" valign="top" char="." charoff="50">37</td>
          <td align="char" valign="top" char="." charoff="50">55</td>
          <td align="char" valign="top" char="." charoff="50">17</td>
          <td align="char" valign="top" char="." charoff="50">21</td>
          <td align="char" valign="top" char="." charoff="50">26</td>
        </tr>
        <tr>
          <td align="left" valign="top" charoff="50"><italic> </italic>Asian</td>
          <td align="char" valign="top" char="." charoff="50">43</td>
          <td align="char" valign="top" char="." charoff="50">72</td>
          <td align="char" valign="top" char="." charoff="50">34</td>
          <td align="char" valign="top" char="." charoff="50">49</td>
          <td align="char" valign="top" char="." charoff="50">17</td>
          <td align="char" valign="top" char="." charoff="50">19</td>
          <td align="char" valign="top" char="." charoff="50">29</td>
        </tr>
        <tr>
          <td align="left" valign="top" charoff="50"><italic> </italic>Hispanic</td>
          <td align="char" valign="top" char="." charoff="50">41</td>
          <td align="char" valign="top" char="." charoff="50">85</td>
          <td align="char" valign="top" char="." charoff="50">31</td>
          <td align="char" valign="top" char="." charoff="50">44</td>
          <td align="char" valign="top" char="." charoff="50">14</td>
          <td align="char" valign="top" char="." charoff="50">17</td>
          <td align="char" valign="top" char="." charoff="50">26</td>
        </tr>
        <tr>
          <td align="left" valign="top" charoff="50"><italic> </italic>African</td>
          <td align="char" valign="top" char="." charoff="50">36</td>
          <td align="char" valign="top" char="." charoff="50">45</td>
          <td align="char" valign="top" char="." charoff="50">24</td>
          <td align="char" valign="top" char="." charoff="50">30</td>
          <td align="char" valign="top" char="." charoff="50">13</td>
          <td align="char" valign="top" char="." charoff="50">17</td>
          <td align="char" valign="top" char="." charoff="50">23</td>
        </tr>
        <tr>
          <td align="left" valign="top" charoff="50"><italic> </italic>Total</td>
          <td align="char" valign="top" char="." charoff="50">85</td>
          <td align="char" valign="top" char="." charoff="50">144</td>
          <td align="char" valign="top" char="." charoff="50">49</td>
          <td align="char" valign="top" char="." charoff="50">80</td>
          <td align="char" valign="top" char="." charoff="50">19</td>
          <td align="char" valign="top" char="." charoff="50">27</td>
          <td align="char" valign="top" char="." charoff="50">49</td>
        </tr>
      </tbody>
    </table>
    <table-wrap-foot>
      <fn id="t1-fn1">
        <p>Abbreviations: HLA, human leukocyte antigen; WTCCC, Wellcome Trust Case Control Consortium.</p>
      </fn>
    </table-wrap-foot>
  </table-wrap>
  <table-wrap id="tbl2">
    <label>Table 2</label>
    <caption>
      <title>Summary of the four-digit prediction accuracies (call rates) for HLARES of European ancestry, using four-digit HLA data from the British 1958 birth cohort study as independent validation samples</title>
    </caption>
    <table frame="hsides" rules="groups" border="1">
      <colgroup>
        <col align="left"/>
        <col align="char" char="."/>
        <col align="char" char="."/>
        <col align="char" char="."/>
        <col align="char" char="."/>
        <col align="char" char="."/>
      </colgroup>
      <thead valign="bottom">
        <tr>
          <th align="left" valign="top" charoff="50"> </th>
          <th colspan="5" align="center" valign="top" char="." charoff="50">
            <italic>HLA type</italic>
            <hr/>
          </th>
        </tr>
        <tr>
          <th align="left" valign="top" charoff="50"> </th>
          <th align="center" valign="top" char="." charoff="50">
            <italic>A</italic>
          </th>
          <th align="center" valign="top" char="." charoff="50">
            <italic>B</italic>
          </th>
          <th align="center" valign="top" char="." charoff="50">
            <italic>C</italic>
          </th>
          <th align="center" valign="top" char="." charoff="50">
            <italic>DRB1</italic>
          </th>
          <th align="center" valign="top" char="." charoff="50">
            <italic>DQB1</italic>
          </th>
        </tr>
      </thead>
      <tbody valign="top">
        <tr>
          <td align="left" valign="top" charoff="50">No. of SNPs<xref ref-type="fn" rid="t2-fn1">a</xref></td>
          <td align="char" valign="top" char="." charoff="50">273</td>
          <td align="char" valign="top" char="." charoff="50">341</td>
          <td align="char" valign="top" char="." charoff="50">356</td>
          <td align="char" valign="top" char="." charoff="50">327</td>
          <td align="char" valign="top" char="." charoff="50">356</td>
        </tr>
        <tr>
          <td align="left" valign="top" charoff="50">No. of training samples</td>
          <td align="char" valign="top" char="." charoff="50">1857</td>
          <td align="char" valign="top" char="." charoff="50">2572</td>
          <td align="char" valign="top" char="." charoff="50">1866</td>
          <td align="char" valign="top" char="." charoff="50">2436</td>
          <td align="char" valign="top" char="." charoff="50">1924</td>
        </tr>
        <tr>
          <td align="left" valign="top" charoff="50">No. of validation samples</td>
          <td align="char" valign="top" char="." charoff="50">884</td>
          <td align="char" valign="top" char="." charoff="50">1532</td>
          <td align="char" valign="top" char="." charoff="50">840</td>
          <td align="char" valign="top" char="." charoff="50">1129</td>
          <td align="char" valign="top" char="." charoff="50">1004</td>
        </tr>
        <tr>
          <td align="left" valign="top" charoff="50"> </td>
          <td align="char" valign="top" char="." charoff="50"> </td>
          <td align="char" valign="top" char="." charoff="50"> </td>
          <td align="char" valign="top" char="." charoff="50"> </td>
          <td align="char" valign="top" char="." charoff="50"> </td>
          <td align="char" valign="top" char="." charoff="50"> </td>
        </tr>
        <tr>
          <td colspan="6" align="left" valign="top" charoff="50">
            <italic>HLARES training data of European ancestry, the published pre-fit classifiers:</italic>
          </td>
        </tr>
        <tr>
          <td align="left" valign="top" charoff="50"> CT=0</td>
          <td align="char" valign="top" char="(" charoff="50">98.1 (100)</td>
          <td align="char" valign="top" char="(" charoff="50">96.9 (100)</td>
          <td align="char" valign="top" char="(" charoff="50">96.5 (100)</td>
          <td align="char" valign="top" char="(" charoff="50">92.2 (100)</td>
          <td align="char" valign="top" char="(" charoff="50">97.8 (100)</td>
        </tr>
        <tr>
          <td align="left" valign="top" charoff="50"> CT=0.5</td>
          <td align="char" valign="top" char="(" charoff="50">98.2 (99.4)</td>
          <td align="char" valign="top" char="(" charoff="50">97.4 (97.3)</td>
          <td align="char" valign="top" char="(" charoff="50">96.6 (99.5)</td>
          <td align="char" valign="top" char="(" charoff="50">94.0 (94.6)</td>
          <td align="char" valign="top" char="(" charoff="50">98.0 (99.0)</td>
        </tr>
      </tbody>
    </table>
    <table-wrap-foot>
      <fn id="t2-fn1">
        <p>Abbreviations: CT, call threshold; HLA, human leukocyte antigen; SNP, single-nucleotide polymorphism.</p>
      </fn>
      <fn id="t2-fn2">
        <p>HIBAG CT of 0 and 0.5 were used.</p>
      </fn>
      <fn id="t2-fn3">
        <label>a</label>
        <p>SNP markers common to the Illumina 1M Duo, OmniQuad, OmniExpress, 660K and 550K platforms within a flanking region of 500 kb were used.</p>
      </fn>
    </table-wrap-foot>
  </table-wrap>
  <table-wrap id="tbl3">
    <label>Table 3</label>
    <caption>
      <title>The comparison of four-digit accuracies for HIBAG and HLA*IMP on HLARES data of European ancestry with no call threshold</title>
    </caption>
    <table frame="hsides" rules="groups" border="1">
      <colgroup>
        <col align="left"/>
        <col align="char" char="."/>
        <col align="char" char="."/>
        <col align="char" char="."/>
        <col align="char" char="."/>
        <col align="char" char="."/>
      </colgroup>
      <thead valign="bottom">
        <tr>
          <th align="left" valign="top" charoff="50"> </th>
          <th colspan="5" align="center" valign="top" char="." charoff="50">
            <italic>HLA type</italic>
            <hr/>
          </th>
        </tr>
        <tr>
          <th align="left" valign="top" charoff="50">
            <italic>Method</italic>
          </th>
          <th align="center" valign="top" char="." charoff="50">
            <italic>A</italic>
          </th>
          <th align="center" valign="top" char="." charoff="50">
            <italic>B</italic>
          </th>
          <th align="center" valign="top" char="." charoff="50">
            <italic>C</italic>
          </th>
          <th align="center" valign="top" char="." charoff="50">
            <italic>DRB1</italic>
          </th>
          <th align="center" valign="top" char="." charoff="50">
            <italic>DQB1</italic>
          </th>
        </tr>
      </thead>
      <tbody valign="top">
        <tr>
          <td align="left" valign="top" charoff="50">No.of validation samples</td>
          <td align="char" valign="top" char="." charoff="50">1787</td>
          <td align="char" valign="top" char="." charoff="50">2471</td>
          <td align="char" valign="top" char="." charoff="50">1830</td>
          <td align="char" valign="top" char="." charoff="50">2383</td>
          <td align="char" valign="top" char="." charoff="50">1917</td>
        </tr>
        <tr>
          <td align="left" valign="top" charoff="50"> </td>
          <td align="char" valign="top" char="." charoff="50"> </td>
          <td align="char" valign="top" char="." charoff="50"> </td>
          <td align="char" valign="top" char="." charoff="50"> </td>
          <td align="char" valign="top" char="." charoff="50"> </td>
          <td align="char" valign="top" char="." charoff="50"> </td>
        </tr>
        <tr>
          <td colspan="6" align="left" valign="top" charoff="50">
            <italic>Using 191 markers on Illumina 1M platform as selected by HLA*IMP</italic>
            <xref ref-type="fn" rid="t3-fn2">a</xref>
          </td>
        </tr>
        <tr>
          <td align="left" valign="top" charoff="50"> No.of SNPs</td>
          <td align="char" valign="top" char="." charoff="50">50</td>
          <td align="char" valign="top" char="." charoff="50">39</td>
          <td align="char" valign="top" char="." charoff="50">27</td>
          <td align="char" valign="top" char="." charoff="50">50</td>
          <td align="char" valign="top" char="." charoff="50">34</td>
        </tr>
        <tr>
          <td align="left" valign="top" charoff="50"> HLA*IMP (%)</td>
          <td align="char" valign="top" char="." charoff="50">91.0</td>
          <td align="char" valign="top" char="." charoff="50">94.4</td>
          <td align="char" valign="top" char="." charoff="50">98.4</td>
          <td align="char" valign="top" char="." charoff="50">87.9</td>
          <td align="char" valign="top" char="." charoff="50">96.2</td>
        </tr>
        <tr>
          <td align="left" valign="top" charoff="50"> HIBAG <xref ref-type="fn" rid="t3-fn3">b</xref> (%)</td>
          <td align="char" valign="top" char="." charoff="50">96.7</td>
          <td align="char" valign="top" char="." charoff="50">94.8</td>
          <td align="char" valign="top" char="." charoff="50">98.7</td>
          <td align="char" valign="top" char="." charoff="50">90.0</td>
          <td align="char" valign="top" char="." charoff="50">98.6</td>
        </tr>
        <tr>
          <td align="left" valign="top" charoff="50"> </td>
          <td align="char" valign="top" char="." charoff="50"> </td>
          <td align="char" valign="top" char="." charoff="50"> </td>
          <td align="char" valign="top" char="." charoff="50"> </td>
          <td align="char" valign="top" char="." charoff="50"> </td>
          <td align="char" valign="top" char="." charoff="50"> </td>
        </tr>
        <tr>
          <td colspan="6" align="left" valign="top" charoff="50">
            <italic>Using all the xMHC markers on Illumina 1M platform</italic>
            <xref ref-type="fn" rid="t3-fn4">c</xref>
          </td>
        </tr>
        <tr>
          <td align="left" valign="top" charoff="50"> No. of SNPs</td>
          <td align="char" valign="top" char="." charoff="50">489</td>
          <td align="char" valign="top" char="." charoff="50">562</td>
          <td align="char" valign="top" char="." charoff="50">554</td>
          <td align="char" valign="top" char="." charoff="50">474</td>
          <td align="char" valign="top" char="." charoff="50">447</td>
        </tr>
        <tr>
          <td align="left" valign="top" charoff="50"> HIBAG<xref ref-type="fn" rid="t3-fn3">b</xref> (%)</td>
          <td align="char" valign="top" char="." charoff="50">97.7</td>
          <td align="char" valign="top" char="." charoff="50">95.1</td>
          <td align="char" valign="top" char="." charoff="50">98.7</td>
          <td align="char" valign="top" char="." charoff="50">91.8</td>
          <td align="char" valign="top" char="." charoff="50">98.4</td>
        </tr>
      </tbody>
    </table>
    <table-wrap-foot>
      <fn id="t3-fn1">
        <p>Abbreviations: HLA, human leukocyte antigen; MHC, major histocompatibility complex; SNP, single-nucleotide polymorphism.</p>
      </fn>
      <fn id="t3-fn2">
        <label>a</label>
        <p>The full SNP list is shown in <xref ref-type="supplementary-material" rid="sup1">Supplementary Table S4</xref>.</p>
      </fn>
      <fn id="t3-fn3">
        <label>b</label>
        <p>The training samples are HapMap 30 CEU trios plus WTCCC samples.</p>
      </fn>
      <fn id="t3-fn4">
        <label>c</label>
        <p>The SNP markers within a flanking region of 250 kb are used.</p>
      </fn>
    </table-wrap-foot>
  </table-wrap>
  <table-wrap id="tbl4">
    <label>Table 4</label>
    <caption>
      <title>Summary of the four-digit prediction accuracies (call rates) stratified by ancestries and HLA loci</title>
    </caption>
    <table frame="hsides" rules="groups" border="1">
      <colgroup>
        <col align="left"/>
        <col align="char" char="("/>
        <col align="char" char="("/>
        <col align="char" char="("/>
        <col align="char" char="("/>
        <col align="char" char="("/>
        <col align="char" char="("/>
        <col align="char" char="("/>
      </colgroup>
      <thead valign="bottom">
        <tr>
          <th align="center" valign="top" charoff="50"> </th>
          <th colspan="7" align="center" valign="top" char="(" charoff="50">
            <italic>HLA type</italic>
            <hr/>
          </th>
        </tr>
        <tr>
          <th align="center" valign="top" charoff="50"> </th>
          <th align="center" valign="top" char="(" charoff="50">
            <italic>A</italic>
          </th>
          <th align="center" valign="top" char="(" charoff="50">
            <italic>B</italic>
          </th>
          <th align="center" valign="top" char="(" charoff="50">
            <italic>C</italic>
          </th>
          <th align="center" valign="top" char="(" charoff="50">
            <italic>DRB1</italic>
          </th>
          <th align="center" valign="top" char="(" charoff="50">
            <italic>DQA1</italic>
          </th>
          <th align="center" valign="top" char="(" charoff="50">
            <italic>DQB1</italic>
          </th>
          <th align="center" valign="top" char="(" charoff="50">
            <italic>DPB1</italic>
          </th>
        </tr>
      </thead>
      <tbody valign="top">
        <tr>
          <td colspan="8" align="left" valign="top" charoff="50">
            <italic>European ancestry</italic>
          </td>
        </tr>
        <tr>
          <td align="left" valign="top" charoff="50"> No. of SNPs<xref ref-type="fn" rid="t4-fn3">a</xref></td>
          <td align="center" valign="top" char="(" charoff="50">273</td>
          <td align="center" valign="top" char="(" charoff="50">341</td>
          <td align="center" valign="top" char="(" charoff="50">356</td>
          <td align="center" valign="top" char="(" charoff="50">327</td>
          <td align="center" valign="top" char="(" charoff="50">349</td>
          <td align="center" valign="top" char="(" charoff="50">356</td>
          <td align="center" valign="top" char="(" charoff="50">279</td>
        </tr>
        <tr>
          <td align="left" valign="top" charoff="50"> </td>
          <td align="char" valign="top" char="(" charoff="50"> </td>
          <td align="char" valign="top" char="(" charoff="50"> </td>
          <td align="char" valign="top" char="(" charoff="50"> </td>
          <td align="char" valign="top" char="(" charoff="50"> </td>
          <td align="char" valign="top" char="(" charoff="50"> </td>
          <td align="char" valign="top" char="(" charoff="50"> </td>
          <td align="char" valign="top" char="(" charoff="50"> </td>
        </tr>
        <tr>
          <td colspan="8" align="left" valign="top" charoff="50">
            <italic>HIBAG</italic>
          </td>
        </tr>
        <tr>
          <td align="left" valign="top" charoff="50"> CT=0.0</td>
          <td align="char" valign="top" char="(" charoff="50">98.2 (100)</td>
          <td align="char" valign="top" char="(" charoff="50">96.6 (100)</td>
          <td align="char" valign="top" char="(" charoff="50">98.8 (100)</td>
          <td align="char" valign="top" char="(" charoff="50">92.1 (100)</td>
          <td align="char" valign="top" char="(" charoff="50">97.3 (100)</td>
          <td align="char" valign="top" char="(" charoff="50">98.8 (100)</td>
          <td align="char" valign="top" char="(" charoff="50">93.8 (100)</td>
        </tr>
        <tr>
          <td align="left" valign="top" charoff="50"> CT=0.5</td>
          <td align="char" valign="top" char="(" charoff="50">98.7 (98.8)</td>
          <td align="char" valign="top" char="(" charoff="50">97.8 (94.2)</td>
          <td align="char" valign="top" char="(" charoff="50">99.2 (98.0)</td>
          <td align="char" valign="top" char="(" charoff="50">94.9 (90.1)</td>
          <td align="char" valign="top" char="(" charoff="50">97.8 (97.9)</td>
          <td align="char" valign="top" char="(" charoff="50">99.2 (97.9)</td>
          <td align="char" valign="top" char="(" charoff="50">94.8 (96.0)</td>
        </tr>
        <tr>
          <td align="left" valign="top" charoff="50"> </td>
          <td align="char" valign="top" char="(" charoff="50"> </td>
          <td align="char" valign="top" char="(" charoff="50"> </td>
          <td align="char" valign="top" char="(" charoff="50"> </td>
          <td align="char" valign="top" char="(" charoff="50"> </td>
          <td align="char" valign="top" char="(" charoff="50"> </td>
          <td align="char" valign="top" char="(" charoff="50"> </td>
          <td align="char" valign="top" char="(" charoff="50"> </td>
        </tr>
        <tr>
          <td colspan="8" align="left" valign="top" charoff="50"> </td>
        </tr>
        <tr>
          <td align="left" valign="top" charoff="50">
            <italic>BEAGLE</italic>
            <xref ref-type="fn" rid="t4-fn4">b</xref>
          </td>
          <td align="char" valign="top" char="(" charoff="50">98.1 (100)</td>
          <td align="char" valign="top" char="(" charoff="50">95.5 (100)</td>
          <td align="char" valign="top" char="(" charoff="50">97.7 (100)</td>
          <td align="char" valign="top" char="(" charoff="50">92.9 (100)</td>
          <td align="char" valign="top" char="(" charoff="50">96.4 (100)</td>
          <td align="char" valign="top" char="(" charoff="50">97.9 (100)</td>
          <td align="char" valign="top" char="(" charoff="50">94.7 (100)</td>
        </tr>
        <tr>
          <td align="left" valign="top" charoff="50"> </td>
          <td align="char" valign="top" char="(" charoff="50"> </td>
          <td align="char" valign="top" char="(" charoff="50"> </td>
          <td align="char" valign="top" char="(" charoff="50"> </td>
          <td align="char" valign="top" char="(" charoff="50"> </td>
          <td align="char" valign="top" char="(" charoff="50"> </td>
          <td align="char" valign="top" char="(" charoff="50"> </td>
          <td align="char" valign="top" char="(" charoff="50"> </td>
        </tr>
        <tr>
          <td colspan="8" align="left" valign="top" charoff="50">
            <italic>Asian ancestry</italic>
          </td>
        </tr>
        <tr>
          <td align="left" valign="top" charoff="50"> No. of SNPs<xref ref-type="fn" rid="t4-fn3">a</xref></td>
          <td align="center" valign="top" char="(" charoff="50">259</td>
          <td align="center" valign="top" char="(" charoff="50">334</td>
          <td align="center" valign="top" char="(" charoff="50">346</td>
          <td align="center" valign="top" char="(" charoff="50">319</td>
          <td align="center" valign="top" char="(" charoff="50">341</td>
          <td align="center" valign="top" char="(" charoff="50">348</td>
          <td align="center" valign="top" char="(" charoff="50">272</td>
        </tr>
        <tr>
          <td align="left" valign="top" charoff="50"> </td>
          <td align="char" valign="top" char="(" charoff="50"> </td>
          <td align="char" valign="top" char="(" charoff="50"> </td>
          <td align="char" valign="top" char="(" charoff="50"> </td>
          <td align="char" valign="top" char="(" charoff="50"> </td>
          <td align="char" valign="top" char="(" charoff="50"> </td>
          <td align="char" valign="top" char="(" charoff="50"> </td>
          <td align="char" valign="top" char="(" charoff="50"> </td>
        </tr>
        <tr>
          <td colspan="8" align="left" valign="top" charoff="50">
            <italic>HIBAG</italic>
          </td>
        </tr>
        <tr>
          <td align="left" valign="top" charoff="50"> CT=0.0</td>
          <td align="char" valign="top" char="(" charoff="50">92.1 (100)</td>
          <td align="char" valign="top" char="(" charoff="50">87.5 (100)</td>
          <td align="char" valign="top" char="(" charoff="50">96.6 (100)</td>
          <td align="char" valign="top" char="(" charoff="50">88.7 (100)</td>
          <td align="char" valign="top" char="(" charoff="50">86.8 (100)</td>
          <td align="char" valign="top" char="(" charoff="50">96.0 (100)</td>
          <td align="char" valign="top" char="(" charoff="50">89.8 (100)</td>
        </tr>
        <tr>
          <td align="left" valign="top" charoff="50"> CT=0.5</td>
          <td align="char" valign="top" char="(" charoff="50">93.8 (91.7)</td>
          <td align="char" valign="top" char="(" charoff="50">94.7 (71.0)</td>
          <td align="char" valign="top" char="(" charoff="50">97.8 (93.9)</td>
          <td align="char" valign="top" char="(" charoff="50">95.8 (71.5)</td>
          <td align="char" valign="top" char="(" charoff="50">90.0 (80.8)</td>
          <td align="char" valign="top" char="(" charoff="50">98.1 (96.3)</td>
          <td align="char" valign="top" char="(" charoff="50">95.3 (82.8)</td>
        </tr>
        <tr>
          <td align="left" valign="top" charoff="50"> </td>
          <td align="char" valign="top" char="(" charoff="50"> </td>
          <td align="char" valign="top" char="(" charoff="50"> </td>
          <td align="char" valign="top" char="(" charoff="50"> </td>
          <td align="char" valign="top" char="(" charoff="50"> </td>
          <td align="char" valign="top" char="(" charoff="50"> </td>
          <td align="char" valign="top" char="(" charoff="50"> </td>
          <td align="char" valign="top" char="(" charoff="50"> </td>
        </tr>
        <tr>
          <td colspan="8" align="left" valign="top" charoff="50"> </td>
        </tr>
        <tr>
          <td align="left" valign="top" charoff="50">
            <italic>BEAGLE</italic>
            <xref ref-type="fn" rid="t4-fn4">b</xref>
          </td>
          <td align="char" valign="top" char="(" charoff="50">93.8 (100)</td>
          <td align="char" valign="top" char="(" charoff="50">83.7 (100)</td>
          <td align="char" valign="top" char="(" charoff="50">94.5 (100)</td>
          <td align="char" valign="top" char="(" charoff="50">87.7 (100)</td>
          <td align="char" valign="top" char="(" charoff="50">86.7 (100)</td>
          <td align="char" valign="top" char="(" charoff="50">97.3 (100)</td>
          <td align="char" valign="top" char="(" charoff="50">91.2 (100)</td>
        </tr>
        <tr>
          <td align="left" valign="top" charoff="50"> </td>
          <td align="char" valign="top" char="(" charoff="50"> </td>
          <td align="char" valign="top" char="(" charoff="50"> </td>
          <td align="char" valign="top" char="(" charoff="50"> </td>
          <td align="char" valign="top" char="(" charoff="50"> </td>
          <td align="char" valign="top" char="(" charoff="50"> </td>
          <td align="char" valign="top" char="(" charoff="50"> </td>
          <td align="char" valign="top" char="(" charoff="50"> </td>
        </tr>
        <tr>
          <td colspan="8" align="left" valign="top" charoff="50">
            <italic>Hispanic ancestry</italic>
          </td>
        </tr>
        <tr>
          <td align="left" valign="top" charoff="50"> No. of SNPs<xref ref-type="fn" rid="t4-fn3">a</xref></td>
          <td align="center" valign="top" char="(" charoff="50">274</td>
          <td align="center" valign="top" char="(" charoff="50">341</td>
          <td align="center" valign="top" char="(" charoff="50">356</td>
          <td align="center" valign="top" char="(" charoff="50">326</td>
          <td align="center" valign="top" char="(" charoff="50">348</td>
          <td align="center" valign="top" char="(" charoff="50">355</td>
          <td align="center" valign="top" char="(" charoff="50">278</td>
        </tr>
        <tr>
          <td align="left" valign="top" charoff="50"> </td>
          <td align="char" valign="top" char="(" charoff="50"> </td>
          <td align="char" valign="top" char="(" charoff="50"> </td>
          <td align="char" valign="top" char="(" charoff="50"> </td>
          <td align="char" valign="top" char="(" charoff="50"> </td>
          <td align="char" valign="top" char="(" charoff="50"> </td>
          <td align="char" valign="top" char="(" charoff="50"> </td>
          <td align="char" valign="top" char="(" charoff="50"> </td>
        </tr>
        <tr>
          <td colspan="8" align="left" valign="top" charoff="50">
            <italic>HIBAG</italic>
          </td>
        </tr>
        <tr>
          <td align="left" valign="top" charoff="50"> CT=0.0</td>
          <td align="char" valign="top" char="(" charoff="50">93.4 (100)</td>
          <td align="char" valign="top" char="(" charoff="50">75.0 (100)</td>
          <td align="char" valign="top" char="(" charoff="50">96.2 (100)</td>
          <td align="char" valign="top" char="(" charoff="50">82.0 (100)</td>
          <td align="char" valign="top" char="(" charoff="50">93.8 (100)</td>
          <td align="char" valign="top" char="(" charoff="50">95.7 (100)</td>
          <td align="char" valign="top" char="(" charoff="50">93.1 (100)</td>
        </tr>
        <tr>
          <td align="left" valign="top" charoff="50"> CT=0.5</td>
          <td align="char" valign="top" char="(" charoff="50">96.0 (82.5)</td>
          <td align="char" valign="top" char="(" charoff="50">93.8 (37.5)</td>
          <td align="char" valign="top" char="(" charoff="50">98.4 (87.4)</td>
          <td align="char" valign="top" char="(" charoff="50">93.5 (50.8)</td>
          <td align="char" valign="top" char="(" charoff="50">95.8 (90.8)</td>
          <td align="char" valign="top" char="(" charoff="50">98.9 (90.0)</td>
          <td align="char" valign="top" char="(" charoff="50">97.5 (81.5)</td>
        </tr>
        <tr>
          <td align="left" valign="top" charoff="50"> </td>
          <td align="char" valign="top" char="(" charoff="50"> </td>
          <td align="char" valign="top" char="(" charoff="50"> </td>
          <td align="char" valign="top" char="(" charoff="50"> </td>
          <td align="char" valign="top" char="(" charoff="50"> </td>
          <td align="char" valign="top" char="(" charoff="50"> </td>
          <td align="char" valign="top" char="(" charoff="50"> </td>
          <td align="char" valign="top" char="(" charoff="50"> </td>
        </tr>
        <tr>
          <td colspan="8" align="left" valign="top" charoff="50"> </td>
        </tr>
        <tr>
          <td align="left" valign="top" charoff="50">
            <italic>BEAGLE</italic>
            <xref ref-type="fn" rid="t4-fn4">b</xref>
          </td>
          <td align="char" valign="top" char="(" charoff="50">89.1 (100)</td>
          <td align="char" valign="top" char="(" charoff="50">75.0 (100)</td>
          <td align="char" valign="top" char="(" charoff="50">92.3 (100)</td>
          <td align="char" valign="top" char="(" charoff="50">78.7 (100)</td>
          <td align="char" valign="top" char="(" charoff="50">94.6 (100)</td>
          <td align="char" valign="top" char="(" charoff="50">96.3 (100)</td>
          <td align="char" valign="top" char="(" charoff="50">91.9 (100)</td>
        </tr>
        <tr>
          <td align="left" valign="top" charoff="50"> </td>
          <td align="char" valign="top" char="(" charoff="50"> </td>
          <td align="char" valign="top" char="(" charoff="50"> </td>
          <td align="char" valign="top" char="(" charoff="50"> </td>
          <td align="char" valign="top" char="(" charoff="50"> </td>
          <td align="char" valign="top" char="(" charoff="50"> </td>
          <td align="char" valign="top" char="(" charoff="50"> </td>
          <td align="char" valign="top" char="(" charoff="50"> </td>
        </tr>
        <tr>
          <td colspan="8" align="left" valign="top" charoff="50">
            <italic>African ancestry</italic>
          </td>
        </tr>
        <tr>
          <td align="left" valign="top" charoff="50"> No. of SNPs<xref ref-type="fn" rid="t4-fn3">a</xref></td>
          <td align="center" valign="top" char="(" charoff="50">266</td>
          <td align="center" valign="top" char="(" charoff="50">335</td>
          <td align="center" valign="top" char="(" charoff="50">349</td>
          <td align="center" valign="top" char="(" charoff="50">325</td>
          <td align="center" valign="top" char="(" charoff="50">343</td>
          <td align="center" valign="top" char="(" charoff="50">351</td>
          <td align="center" valign="top" char="(" charoff="50">269</td>
        </tr>
        <tr>
          <td align="left" valign="top" charoff="50"> </td>
          <td align="char" valign="top" char="(" charoff="50"> </td>
          <td align="char" valign="top" char="(" charoff="50"> </td>
          <td align="char" valign="top" char="(" charoff="50"> </td>
          <td align="char" valign="top" char="(" charoff="50"> </td>
          <td align="char" valign="top" char="(" charoff="50"> </td>
          <td align="char" valign="top" char="(" charoff="50"> </td>
          <td align="char" valign="top" char="(" charoff="50"> </td>
        </tr>
        <tr>
          <td colspan="8" align="left" valign="top" charoff="50">
            <italic>HIBAG</italic>
          </td>
        </tr>
        <tr>
          <td align="left" valign="top" charoff="50"> CT=0.0</td>
          <td align="char" valign="top" char="(" charoff="50">92.4 (100)</td>
          <td align="char" valign="top" char="(" charoff="50">76.8 (100)</td>
          <td align="char" valign="top" char="(" charoff="50">88.5 (100)</td>
          <td align="char" valign="top" char="(" charoff="50">77.1 (100)</td>
          <td align="char" valign="top" char="(" charoff="50">80.0 (100)</td>
          <td align="char" valign="top" char="(" charoff="50">79.4 (100)</td>
          <td align="char" valign="top" char="(" charoff="50">74.2 (100)</td>
        </tr>
        <tr>
          <td align="left" valign="top" charoff="50"> CT=0.5</td>
          <td align="char" valign="top" char="(" charoff="50">100 (74.6)</td>
          <td align="char" valign="top" char="(" charoff="50">96.7 (21.1)</td>
          <td align="char" valign="top" char="(" charoff="50">96.5 (66.2)</td>
          <td align="char" valign="top" char="(" charoff="50">100 (22.2)</td>
          <td align="char" valign="top" char="(" charoff="50">97.2 (27.7)</td>
          <td align="char" valign="top" char="(" charoff="50">97.7 (34.9)</td>
          <td align="char" valign="top" char="(" charoff="50">75.0 (12.9)</td>
        </tr>
        <tr>
          <td align="left" valign="top" charoff="50"> </td>
          <td align="char" valign="top" char="(" charoff="50"> </td>
          <td align="char" valign="top" char="(" charoff="50"> </td>
          <td align="char" valign="top" char="(" charoff="50"> </td>
          <td align="char" valign="top" char="(" charoff="50"> </td>
          <td align="char" valign="top" char="(" charoff="50"> </td>
          <td align="char" valign="top" char="(" charoff="50"> </td>
          <td align="char" valign="top" char="(" charoff="50"> </td>
        </tr>
        <tr>
          <td colspan="8" align="left" valign="top" charoff="50"> </td>
        </tr>
        <tr>
          <td align="left" valign="top" charoff="50">
            <italic>BEAGLE</italic>
            <xref ref-type="fn" rid="t4-fn4">b</xref>
          </td>
          <td align="char" valign="top" char="(" charoff="50">93.2 (100)</td>
          <td align="char" valign="top" char="(" charoff="50">71.1 (100)</td>
          <td align="char" valign="top" char="(" charoff="50">86.9 (100)</td>
          <td align="char" valign="top" char="(" charoff="50">81.2 (100)</td>
          <td align="char" valign="top" char="(" charoff="50">79.2 (100)</td>
          <td align="char" valign="top" char="(" charoff="50">76.2 (100)</td>
          <td align="char" valign="top" char="(" charoff="50">79.0 (100)</td>
        </tr>
      </tbody>
    </table>
    <table-wrap-foot>
      <fn id="t4-fn1">
        <p>Abbreviations: HLA, human leukocyte antigen; SNP, single-nucleotide polymorphism.</p>
      </fn>
      <fn id="t4-fn2">
        <p>STUDY data were divided into training and validation sets with equal sizes. HIBAG call thresholds (CTs) of 0 and 0.5 were used.</p>
      </fn>
      <fn id="t4-fn3">
        <label>a</label>
        <p>SNP markers common to the Illumina 1M Duo, OmniQuad, OmniExpress, 660K and 550K platforms within a flanking region of 500 kb are used.</p>
      </fn>
      <fn id="t4-fn4">
        <label>b</label>
        <p>No call threshold.</p>
      </fn>
    </table-wrap-foot>
  </table-wrap>
  <boxed-text id="box1">
    <caption>
      <title>Box 1 The attribute bagging algorithm</title>
    </caption>
    <p>
      <list list-type="order">
        <list-item>
          <p>For <italic>k</italic>=1 to <italic>K</italic>:
<list list-type="bullet"><list-item><p>Draw a bootstrap sample <italic>B</italic>
<sub><italic>k</italic></sub> of size <italic>n</italic> (no. of training samples) with replacement from the training data, and <italic>B</italic>
<sub><italic>k</italic></sub> contains all candidate SNPs.</p></list-item><list-item><p>Build an individual classifier <italic>C</italic>
<sub><italic>k</italic></sub> on <italic>B</italic>
<sub><italic>k</italic></sub> by variable selection with a random component (in Box 2), where <italic>C</italic>
<sub><italic>k</italic></sub> uses only a small set of SNPs <italic>S</italic>
<sub><italic>k</italic></sub>.</p></list-item></list>
</p>
        </list-item>
        <list-item>
          <p>Output the ensemble of individual classifiers <inline-formula id="equ16"><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="tpj201318e16.jpg"/></inline-formula>.</p>
        </list-item>
        <list-item>
          <p>To predict the HLA type of a new individual with SNP profile <inline-formula id="equ17"><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="tpj201318e17.jpg"/></inline-formula>, we average the posterior probabilities <inline-formula id="equ18"><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="tpj201318e18.jpg"/></inline-formula> among all <italic>C</italic>
<sub><italic>k</italic></sub>. The prediction is</p>
        </list-item>
      </list>
    </p>
    <p>
      <disp-formula id="equ19">
        <graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="tpj201318e19.jpg"/>
      </disp-formula>
    </p>
  </boxed-text>
  <boxed-text id="box2">
    <caption>
      <title>Box 2 The algorithm of variable selection with a random component for an individual classifier <italic>C</italic><sub><italic>k</italic></sub></title>
    </caption>
    <p>
      <list list-type="order">
        <list-item>
          <p>The set of loci for estimating haplotype frequencies is initially set to <inline-formula id="equ23"><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="tpj201318e23.jpg"/></inline-formula>.</p>
        </list-item>
        <list-item>
          <p>Build an individual classifier <italic>C</italic>
<sub><italic>k</italic></sub> on the bootstrapped data <italic>B</italic>
<sub><italic>k</italic></sub>, by recursively repeating the following steps from (i) to (iii) until it is not possible to reduce the losses<sup>1</sup>:
<list list-type="simple"><list-item><p>Select <italic>m</italic>
<sub>try</sub> SNP markers at random without replacement from the <italic>m</italic> total candidate SNPs (<italic>m</italic>
<sub>try</sub>&lt; <italic>m</italic>) except the marker(s) in <italic>S</italic>
<sub><italic>k</italic></sub>.</p></list-item><list-item><p>Select the best SNP marker <italic>j</italic>* based on the criteria of losses<sup>1</sup> among <italic>m</italic>
<sub>try</sub>.</p></list-item><list-item><p>Add the selected SNP marker to the set <inline-formula id="equ24"><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="tpj201318e24.jpg"/></inline-formula>.</p></list-item></list>
</p>
        </list-item>
        <list-item>
          <p>Output <italic>C</italic>
<sub><italic>k</italic></sub> and <italic>S</italic>
<sub><italic>k</italic></sub>.</p>
        </list-item>
      </list>
    </p>
    <p><sup>1</sup>: reduce both the 0–1 loss and log likelihood loss of <italic>C</italic><sub><italic>k</italic></sub> (see the section ‘Details of the loss criteria').</p>
  </boxed-text>
</floats-group>
