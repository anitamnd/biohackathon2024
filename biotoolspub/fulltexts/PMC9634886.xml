<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//ACS//DTD ACS Journal DTD v1.02 20061031//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName ACSJournal-v102.dtd?>
<?SourceDTD.Version 1.02?>
<?ConverterInfo.XSLTName acs2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">J Am Soc Mass Spectrom</journal-id>
    <journal-id journal-id-type="iso-abbrev">J Am Soc Mass Spectrom</journal-id>
    <journal-id journal-id-type="publisher-id">js</journal-id>
    <journal-id journal-id-type="coden">jamsef</journal-id>
    <journal-title-group>
      <journal-title>Journal of the American Society for Mass Spectrometry</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1044-0305</issn>
    <issn pub-type="epub">1879-1123</issn>
    <publisher>
      <publisher-name>American Chemical Society</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">9634886</article-id>
    <article-id pub-id-type="pmid">36223196</article-id>
    <article-id pub-id-type="doi">10.1021/jasms.2c00176</article-id>
    <article-categories>
      <subj-group>
        <subject>Research Article</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Envemind: Accurate
Monoisotopic Mass Determination
Based On Isotopic Envelope</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author" corresp="yes" id="ath1">
        <contrib-id contrib-id-type="orcid" authenticated="true">https://orcid.org/0000-0001-5107-7487</contrib-id>
        <name>
          <surname>Radziński</surname>
          <given-names>Piotr</given-names>
        </name>
        <xref rid="cor1" ref-type="other">*</xref>
        <xref rid="aff1" ref-type="aff">†</xref>
      </contrib>
      <contrib contrib-type="author" id="ath2">
        <name>
          <surname>Valkenborg</surname>
          <given-names>Dirk</given-names>
        </name>
        <xref rid="aff2" ref-type="aff">‡</xref>
      </contrib>
      <contrib contrib-type="author" id="ath3">
        <contrib-id contrib-id-type="orcid" authenticated="true">https://orcid.org/0000-0001-5227-3447</contrib-id>
        <name>
          <surname>Startek</surname>
          <given-names>Michał Piotr</given-names>
        </name>
        <xref rid="aff1" ref-type="aff">†</xref>
        <xref rid="aff3" ref-type="aff">§</xref>
      </contrib>
      <contrib contrib-type="author" id="ath4">
        <name>
          <surname>Gambin</surname>
          <given-names>Anna</given-names>
        </name>
        <xref rid="aff1" ref-type="aff">†</xref>
      </contrib>
      <aff id="aff1"><label>†</label>Institute
of Informatics, <institution>University of Warsaw</institution>, 00-927 Warsaw, <country>Poland</country></aff>
      <aff id="aff2"><label>‡</label>Interuniversity
Institute of Biostatistics and Statistical Bioinformatics, <institution>Hasselt University</institution>, BE3500 Hasselt, <country>Belgium</country></aff>
      <aff id="aff3"><label>§</label>Institute
of Immunology, <institution>University Medical Center
of the Johannes-Gutenberg University Mainz</institution>, 55131 Mainz, <country>Germany</country></aff>
    </contrib-group>
    <author-notes>
      <corresp id="cor1"><label>*</label>E-mail: <email>pmradzinski@mimuw.edu.pl</email>.</corresp>
    </author-notes>
    <pub-date pub-type="epub">
      <day>12</day>
      <month>10</month>
      <year>2022</year>
    </pub-date>
    <pub-date pub-type="ppub">
      <day>02</day>
      <month>11</month>
      <year>2022</year>
    </pub-date>
    <volume>33</volume>
    <issue>11</issue>
    <fpage>2063</fpage>
    <lpage>2069</lpage>
    <history>
      <date date-type="received">
        <day>25</day>
        <month>06</month>
        <year>2022</year>
      </date>
      <date date-type="accepted">
        <day>26</day>
        <month>09</month>
        <year>2022</year>
      </date>
      <date date-type="rev-recd">
        <day>25</day>
        <month>09</month>
        <year>2022</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© 2022 The Authors. Published by American Chemical Society</copyright-statement>
      <copyright-year>2022</copyright-year>
      <copyright-holder>The Authors</copyright-holder>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p>Permits the broadest form of re-use including for commercial purposes, provided that author attribution and integrity are maintained (<ext-link xmlns:xlink="http://www.w3.org/1999/xlink" ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">https://creativecommons.org/licenses/by/4.0/</ext-link>).</license-p>
      </license>
    </permissions>
    <abstract>
      <p content-type="toc-graphic">
        <graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="js2c00176_0007" id="ab-d33e173"/>
      </p>
      <p>Nowadays,
monoisotopic mass is used as an important feature
in
top-down proteomics. Knowing the exact monoisotopic mass is helpful
for precise and quick protein identification in large protein databases.
However, only in spectra of small molecules the monoisotopic peak
is visible. For bigger molecules like proteins, it is hidden in noise
or undetected at all, and therefore its position has to be predicted.
By improving the prediction of the peak, we contribute to a more accurate
identification of molecules, which is crucial in fields such as chemistry
and medicine. In this work, we present the <monospace>envemind</monospace> algorithm, which is a two-step procedure to predict monoisotopic
masses of proteins. The prediction is based on an isotopic envelope.
Therefore, <monospace>envemind</monospace> is dedicated to spectra
where we are able to resolve the one dalton separated isotopic variants.
Furthermore, only single-molecule spectra are allowed, that is, spectra
that do not require prior deconvolution. The algorithm deals with
the problem of off-by-one dalton errors, which are common in monoisotopic
mass prediction. A novel aspect of this work is a mathematical exploration
of the space of molecules, where we equate chemical formulas and their
theoretical spectrum. Since the space of molecules consists of all
possible chemical formulas, this approach is not limited to known
substances only. This makes optimization processes faster and enables
to approximate theoretical spectrum for a given experimental one.
The algorithm is available as a Python package <monospace>envemind</monospace> on our GitHub page <uri xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="https://github.com/PiotrRadzinski/envemind">https://github.com/PiotrRadzinski/envemind</uri>.</p>
    </abstract>
    <kwd-group>
      <kwd>monoisotopic mass</kwd>
      <kwd>linear
model</kwd>
    </kwd-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution>Narodowe Centrum Nauki</institution>
            <institution-id institution-id-type="doi">10.13039/501100004281</institution-id>
          </institution-wrap>
        </funding-source>
        <award-id>2017/26/D/ST6/00304</award-id>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution>Narodowe Centrum Nauki</institution>
            <institution-id institution-id-type="doi">10.13039/501100004281</institution-id>
          </institution-wrap>
        </funding-source>
        <award-id>2018/29/B/ST6/00681</award-id>
      </award-group>
    </funding-group>
    <custom-meta-group>
      <custom-meta>
        <meta-name>document-id-old-9</meta-name>
        <meta-value>js2c00176</meta-value>
      </custom-meta>
      <custom-meta>
        <meta-name>document-id-new-14</meta-name>
        <meta-value>js2c00176</meta-value>
      </custom-meta>
      <custom-meta>
        <meta-name>ccc-price</meta-name>
        <meta-value/>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec id="sec1">
    <title>Introduction</title>
    <p>According to a recent
overview,<sup><xref ref-type="bibr" rid="ref1">1</xref></sup> top-down
proteomics has been transitioning toward clinical research. This change
in focus has been accomplished by sample preparation and cleanup improvements.
Furthermore, technologies for separating intact proteins bring the
characterization of global proteoforms in a range of top-down proteomics,
while advancements in mass spectrometry instrumentation have enabled
the characterization of large proteoforms in complex mixtures. Nonetheless,
despite the aforementioned improvements, some open problems and hurdles
still exist to be taken in the bioinformatic analysis of top-down
proteomics data. A case in point is the effective and accurate determination
of the precursor mass of the unknown proteoforms, as this will reduce
the ambiguity of identification in a database search. However, as
already mentioned by Lermyte et al.,<sup><xref ref-type="bibr" rid="ref2">2</xref></sup> the
concept of <italic>precursor mass</italic> needs some reconsideration,
as the isotope peaks related to the intact proteoforms lead to the
occurrence of broad, complex isotope distributions that do not unveil
the accurate monoisotopic mass.<sup><xref ref-type="bibr" rid="ref3">3</xref></sup> As such,
the monoisotopic and average masses and the mass of the most abundant
(aggregated) isotope peak are possible candidates to determine the
precursor mass. To date, the default mass reported in top-down experiments
is the average mass, which is also experimentally the most easily
accessible value from both resolved as unresolved isotope distributions
in case the resolving power is insufficient to separate the isotope
peaks. However, as indicated by Claesen et al.,<sup><xref ref-type="bibr" rid="ref4">4</xref></sup> this average value is sensitive to natural and technical
variations. The reason is that uncertainty at the level of the elemental
isotope definition or variation in the spectral accuracy will creep
into the equation to compute the average mass values. The consequence
is that the ambiguity in the protein identification will increase
in a database search because of the larger search tolerance set on
the precursor mass. On a more positive note, the average mass is a
metric that can be easily computed for databases and is interoperable
among the various top-down bioinformatics tools.</p>
    <p>In an ideal
situation, one would opt for the monoisotopic precursor
mass, as this value does not depend on the elemental isotopic abundances
nor spectral accuracy. This metric is also easy to compute for databases
and is interoperable with other bioinformatics tools, but unfortunately,
the probability of occurrence of the monoisotopic variant is extremely
low for intact proteins. Therefore, the monoisotopic variant of the
proteoform falls below the detection limit and is not observed in
a mass spectrum.</p>
    <p>As argued by Claesen et al., a good alternative
that strikes a
balance between the ease of detection and reduction of ambiguity would
be to use the mass of the most abundant isotope peak. The uncertainty
hardly influences this mass value in the elemental isotopic abundances,
and there is a robust solution that can prevent interference from
low spectral accuracy. Unfortunately, the mass of the most abundant
aggregated isotope peak is more difficult to compute, as it requires
a computer algorithm like, for example, <monospace>BRAIN</monospace>(<xref ref-type="bibr" rid="ref5">5</xref>) or <monospace>IsoSpec</monospace>,<sup><xref ref-type="bibr" rid="ref6">6</xref></sup> as opposed to the monoisotopic and average mass,
which can be obtained instantly from a chemical formula. Further,
the most abundant mass is not interoperable with other proteomics
software suites and, therefore, is never considered a viable alternative.</p>
    <p>This conundrum was solved by Senko et al.<sup><xref ref-type="bibr" rid="ref7">7</xref></sup> who proposed to use an averagine-scaling method that searches for
a scaled averagine molecule for which its theoretical isotope distribution
best fits the observed isotope distribution in the spectrum. The scaled
averagine molecule acts as a surrogate for the observed molecule,
and the monoisotopic mass can be computed from the atomic composition
of the obtained scaled averagine. This method works very well and
is still used in many software packages. However, the procedure entails
a dynamic fitting procedure that can be demanding for computers, given
the high-throughput nature of current top-down proteomics experiments.</p>
    <p>In the search for an alternative and more static strategy, Dittwald
et al.<sup><xref ref-type="bibr" rid="ref8">8</xref></sup> proposed a linear model to predict
the monoisotopic mass based on the observed most abundant isotope
peak. A concept was further explored and improved by Chen et al.,<sup><xref ref-type="bibr" rid="ref9">9</xref></sup> who serendipitously uncovered a linear correlation
between these two protein masses (sic.). Finally, Lermyte et al.<sup><xref ref-type="bibr" rid="ref2">2</xref></sup> developed the <monospace>MIND</monospace> algorithm
that entails a double linear model to predict the monoisotopic mass
from partially observed isotope patterns along with a robust selection
method to determine the theoretical most abundant peak mass under
a poor ion statistic. This strategy combines the best of both worlds
and allows for an interoperable metric that can be robustly predicted
from the partial isotope distribution.</p>
    <p>An open problem in the
monoisotopic mass prediction is the off-by-one
dalton error also present in the <monospace>MIND</monospace> application.
According to the <monospace>MIND</monospace> manuscript, the off-by-one
errors appear on average in 31.9% of proteins over the specified mass
range, but for heavier proteins, this error can become more abundant
and leads to wrong predictions in 51% of the predicted cases. This
problem needs attention. Therefore, we present an algorithm that relates
observed isotope distribution to the monoisotopic mass of a protein
while it aims at reducing this infamous off-by-one dalton error for
high-resolution spectra. The procedure is composed of three steps.
A first step is inspired by the averagine scaling of Senko et al.
The second step is a first predictor inspired by the <monospace>MIND</monospace> algorithm but with an additional predictor variable that captures
information about the width of the isotope distribution. The third
step is an optimization procedure that searches for the monoisotopic
mass with the highest likelihood over a fine-grained grid. Linear
models in our method are trained on proteins with an 8–400
kDa mass range; however, the <monospace>envemind</monospace> algorithm
was also successfully tested on smaller proteins. The method is compared
against our <monospace>MIND</monospace> algorithm and outperforms <monospace>MIND</monospace> on simulated data in terms of reducing the off-by-one
dalton error.</p>
  </sec>
  <sec id="sec2">
    <title>Methods</title>
    <sec id="sec2.1">
      <title><monospace>Envemind</monospace> Algorithm</title>
      <p>The procedure
of monoisotopic mass determination is divided into two parts. In the
beginning, we look for a theoretical spectrum that best fits a given
experimental one. By <italic>theoretical spectrum</italic>, we mean
a simulated spectrum without any noise, equivalent to the probability
mass function of multinomial distribution with atomic masses as values
and natural isotopic abundances as probabilities.<sup><xref ref-type="bibr" rid="ref10">10</xref></sup> Having the theoretical spectrum simplifies the prediction
problem. It allows us to build a mathematical model that requires
precisely measured features, usually unavailable in experimental spectra
(like variance), which, calibrated on theoretical spectra, provide
accurate predictions. To simplify the presentation, we begin with
a description of prediction on theoretical spectra, and then we describe
how to deal with experimental ones. More technical details are moved
to the <ext-link xmlns:xlink="http://www.w3.org/1999/xlink" ext-link-type="uri" xlink:href="https://pubs.acs.org/doi/suppl/10.1021/jasms.2c00176/suppl_file/js2c00176_si_001.pdf">Supporting Information</ext-link>. A control
flow graph through <monospace>envemind</monospace> containing the
main steps of the algorithm is presented in <xref rid="fig1" ref-type="fig">Figure <xref rid="fig1" ref-type="fig">1</xref></xref>.</p>
      <fig id="fig1" position="float">
        <label>Figure 1</label>
        <caption>
          <p>Control flow graph illustrating methodology
of the <monospace>envemind</monospace> algorithm. It is divided into
two parts. First, <italic>training</italic>, with calibration of linear
models on theoretical spectra, and second, <italic>prediction</italic>, which deals with an experimental spectrum by
a fitting procedure and linear models from the previous part.</p>
        </caption>
        <graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="js2c00176_0001" id="gr1" position="float"/>
      </fig>
    </sec>
    <sec id="sec2.2">
      <title>Theoretical Spectra</title>
      <p>In this part,
we describe the prediction
of the monoisotopic mass <italic>M</italic><sub>mono</sub> for a given
theoretical spectrum. Hence, all computations and calibrations presented
in this section are done on theoretical spectra only. The spectra
were simulated by <monospace>IsoSpec</monospace> based on chemical
formulas randomly chosen from Uniprot database<sup><xref ref-type="bibr" rid="ref11">11</xref></sup> with an 8–400 kDa mass range. In this section, the
theoretical spectra <italic>x</italic>-axis contains daltons. Therefore,
all parameters described are also in daltons. We first take simple
initial predictions from the linear model that uses the average mass
of a protein <italic>M</italic><sub>avg</sub> and the variance of
its spectrum <italic>M</italic><sub>var</sub>. The following linear
model has been trained and tested on approximately 1.9 million spectra:<disp-formula id="eq1"><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="js2c00176_m001" position="anchor"/><label>1</label></disp-formula>with fitted coefficients
β<sub>0</sub> = −0.145 57, β<sub>avg</sub> = 0.999 78,
and β<sub>var</sub> = −0.598 17. For some proteins,
the outcome of this linear predictor (<xref rid="eq1" ref-type="disp-formula">1</xref>) is
erroneously shifted. However, the 10-fold cross-validation yields
the absolute error of prediction below 0.5 Da for ca. 96.6% of proteins.
The next step is intended to reduce this bias by predicting a grid
of possible locations of monoisotopic mass. Recall that isotopologues
in spectra are aggregated into clusters separated by ca. 1 Da. Therefore,
the determination of such a grid enables us to round <italic>M̂</italic><sub>mono</sub> to the closest point on the grid. Let us define the
grid as follows:<disp-formula id="ueq1"><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="js2c00176_m002" position="anchor"/></disp-formula>where ζ is a distance between nodes
of the grid, and Δ is a shift of the grid.</p>
      <sec id="sec2.2.1">
        <title>Estimation of the Grid
Step ζ</title>
        <p>The purpose of
the ζ parameter is to control the spacing between peak clusters.
To determine the distance between two consecutive grid nodes, consider
the circle rolled through the protein’s spectrum like a glue-coated
roller that collects all peaks. The ideal length of the grid step
(circumference of a circle ζ) will make all the peaks stick
in a small section of the circle, cf. <xref rid="fig2" ref-type="fig">Figure <xref rid="fig2" ref-type="fig">2</xref></xref>. If all the isotope peaks can be collected
and encapsulated in a small region on the sticky roller, then the
circumference of the circle is equal to the average distance between
consecutive isotope clusters.</p>
        <fig id="fig2" position="float">
          <label>Figure 2</label>
          <caption>
            <p>Circle that rolls across spectrum. For ζ
that estimates well
the distance between groups of peaks, peaks transformed into the circumference
of a circle should overlap on a small fragment.</p>
          </caption>
          <graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="js2c00176_0002" id="gr2" position="float"/>
        </fig>
        <p>More formally, the sticky roller procedure described
above transforms
all peaks in the spectrum <inline-formula id="d33e385"><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="js2c00176_m003.gif"/></inline-formula>, that is,
pairs <italic>p</italic> = (<italic>p</italic><sup>mass</sup>, <italic>p</italic><sup>prob</sup>), to
complex unit circle, rotates them to average zero (to avoid problems
with logarithm specification on complex plane), and then transforms
to the interval [−ζ/2, ζ/2]. The final transformation
looks as follows:<disp-formula id="ueq2"><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="js2c00176_m004" position="anchor"/></disp-formula></p>
        <p>To quantify the concentration of peaks,
we treat the spectrum <inline-formula id="d33e407"><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="js2c00176_m005.gif"/></inline-formula> as a random
variable and make use of the
notion of variance. Therefore, the optimal ζ minimizes the variance
of the transformed spectrum:<disp-formula id="ueq3"><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="js2c00176_m006" position="anchor"/></disp-formula></p>
        <p>The variance minimization
procedure
requires a few minutes of computation
for the average-size proteins, and this time grows exponentially for
bigger molecules, which can hinder practical applications. For this
reason, we propose the universal grid step ζ̂ based on
the observation that ζ<sup>★</sup> is slightly correlated
with a protein’s average mass (correlations: Pearson: 0.12,
Kendall: 0.07, Spearman: 0.11). Therefore, we adjusted a linear model
ζ<sup>★</sup> ∼ <italic>M</italic><sub>avg</sub>. The linear model for the universal grid step is as follows:<disp-formula id="eq2"><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="js2c00176_m007" position="anchor"/><label>2</label></disp-formula>with coefficients γ<sub>0</sub> = 1.002 355
and γ<sub>avg</sub> = 6.9584 × 10<sup>–10</sup>.
For future use let us note that, since γ<sub>avg</sub> is very
small, measurement error of <italic>M</italic><sub>avg</sub> leads
to negligible change of ζ̂. Therefore, we can also compute
ζ̂ based on the experimental spectrum’s average
mass. More details are given in the <ext-link xmlns:xlink="http://www.w3.org/1999/xlink" ext-link-type="uri" xlink:href="https://pubs.acs.org/doi/suppl/10.1021/jasms.2c00176/suppl_file/js2c00176_si_001.pdf">Supporting Information</ext-link>.</p>
      </sec>
      <sec id="sec2.2.2">
        <title>Estimation of the Grid Shift Δ</title>
        <p>Once we have chosen
ζ̂, we can focus on the grid shift parameter Δ.
In this setting, the Δ matches the spectrum best if it minimizes
the distance between grid points and spectrum peaks, that is, can
be formulated as:<disp-formula id="ueq4"><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="js2c00176_m008" position="anchor"/></disp-formula>However, the computations can be accelerated
by transforming the spectrum to a complex unit circle and finding
the mean point in the complex space:<disp-formula id="ueq5"><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="js2c00176_m009" position="anchor"/></disp-formula>Both approaches return the same Δ̂.
The whole procedure is efficient enough to calculate grid shift for
each protein independently.</p>
      </sec>
      <sec id="sec2.2.3">
        <title>Final Prediction</title>
        <p>Recall that, according to the described
procedure, the final step in prediction of monoisotopic mass <italic>M</italic><sub>mono</sub> is to round the initial prediction <italic>M̂</italic><sub>mono</sub> to the closest point on the grid <inline-formula id="d33e482"><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="js2c00176_m010.gif"/></inline-formula>. However, it turns out that the distances
between clusters of aggregated peaks in a given spectrum are not perfectly
equal. When one considers the distribution of intercluster distances
centered on the most abundant peak, those in the left tail (for smaller
masses) tend to increase slightly. It makes the distribution of errors
after rounding a bit shift from zero. As a remedy, we added the term
λ that centers the distribution of errors to have an expected
value equal to 0, which results in a slightly better prediction. Technical
details on how the shift was constructed can be found in the <ext-link xmlns:xlink="http://www.w3.org/1999/xlink" ext-link-type="uri" xlink:href="https://pubs.acs.org/doi/suppl/10.1021/jasms.2c00176/suppl_file/js2c00176_si_001.pdf">Supporting Information</ext-link>. Summarizing, the final
prediction model reads as follows:<disp-formula id="ueq6"><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="js2c00176_m011" position="anchor"/></disp-formula>where λ = −1.1982 × 10<sup>–7</sup>. Distributions of errors for initial and final predictions
are presented in <xref rid="fig3" ref-type="fig">Figure <xref rid="fig3" ref-type="fig">3</xref></xref>.</p>
        <fig id="fig3" position="float">
          <label>Figure 3</label>
          <caption>
            <p>Comparison between the linear model’s initial prediction
and the final prediction made by adjusting the grid and rounding the
initial prediction to the closest point on it. Orange lines designate
an interval inside which predictions will round to the most appropriate
point on the grid <inline-formula id="d33e506"><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="js2c00176_m021.gif"/></inline-formula>.</p>
          </caption>
          <graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="js2c00176_0003" id="gr3" position="float"/>
        </fig>
      </sec>
    </sec>
    <sec id="sec2.3">
      <title>Experimental Spectra</title>
      <p>We expand the described model
for theoretical spectra to work with experimental ones. First, in
this section, we fix the experimental spectrum denoted by <inline-formula id="d33e515"><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="js2c00176_m012.gif"/></inline-formula>. Notice that
one of the essential predictors
was the variance of the spectra. Unfortunately, having an exact variance
value for experimental spectra is hardly possible. Therefore, we would
like to construct a theoretical spectrum similar to the true theoretical
spectrum of an experimental spectrum’s substance. Also, in
this section, spectra are assumed to contain daltons on the <italic>x</italic>-axis. If a given experimental spectrum would be <italic>m</italic>/<italic>z</italic>, then the preliminary step is recalculating
it into daltons.</p>
      <p>Our construction of the simulated spectrum
is based on the concept of <italic>averagine</italic> proposed by
Senko et al.<sup><xref ref-type="bibr" rid="ref7">7</xref></sup> but is far more complex.
We define averagine as a hypothetical molecule with chemical formula<disp-formula id="ueq7"><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="js2c00176_m013" position="anchor"/></disp-formula>with the average
mass equal to 110.4728 Da.
We followed the methodology of Senko’s work to obtain the formula
on Uniprot database, which is much bigger than in the original work.
Therefore, the new averagine formula is slightly different from the
old one.</p>
      <p>Senko proposed an algorithm to approximate proteins’
chemical
formulas, from which monoisotopic mass can be easily calculated. The
algorithm follows: take multiplied averagine to obtain an average
mass equal to the experimental spectrum’s average mass, round
the formula to integers, and add hydrogen to be close to the experimental
spectrum’s average mass again. Nowadays, using <monospace>IsoSpec</monospace>,<sup><xref ref-type="bibr" rid="ref6">6</xref></sup> we can efficiently simulate the theoretical
spectrum of any chemical formula. Therefore, we consider the 5-dimensional
space of protein chemical formulas, where every dimension corresponds
to the number of atoms of a molecule’s chemical element (C,
H, N, O, and S). In such a vast space, we would like to account not
only for the mass of the protein but also for the different possible
shapes of its isotopic envelope. Hence, we modify Senko’s approach.</p>
      <p>We suggest keeping an eye on <xref rid="fig4" ref-type="fig">Figure <xref rid="fig4" ref-type="fig">4</xref></xref> when reading the following description, as it should
be helpful. Let us define spectrum <inline-formula id="d33e551"><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="js2c00176_m014.gif"/></inline-formula> with two parameters. <inline-formula id="d33e554"><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="js2c00176_m015.gif"/></inline-formula> is Senko’s averagine shifted this
way, that its first aggregated peak to the left of its average mass
is in the place of most abundant peak of <inline-formula id="d33e557"><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="js2c00176_m016.gif"/></inline-formula> (red
frame in <xref rid="fig4" ref-type="fig">Figure <xref rid="fig4" ref-type="fig">4</xref></xref>).</p>
      <fig id="fig4" position="float">
        <label>Figure 4</label>
        <caption>
          <p>Theoretical
(simulated) spectrum searching scheme
for a given experimental
one. In the first row, copies of the experimental spectrum are presented.
The row below shows copies of averagine with different shifts. For
example, a shift by 0 Da means that the most abundant aggregated peak
of the simulated spectrum is in the place of the most abundant peak
of the experimental spectrum (red frame). Then, we optimize variance
for every averagine copy separately due to Wasserstein distance to
the experimental spectrum. Arrows show if intensities grow or decrease
due to the optimization. Finally, the spectrum with the lowest score
will be used to further prediction by linear models (green frame).</p>
        </caption>
        <graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="js2c00176_0004" id="gr4" position="float"/>
      </fig>
      <p>The parameter <italic>k</italic> is responsible
for a shift of
the spectrum and means that spectrum is shifted by <italic>k</italic> · ζ̂ Da. To hold peaks in proper places, we keep <italic>k</italic> as an integer. This way, we can easily obtain copies of
averagine shifted to different locations, but we are sure that the
peaks of the simulated spectra are in locations similar as experimental
ones. An example of such shifted copies of averagine can be seen in
the second row of <xref rid="fig4" ref-type="fig">Figure <xref rid="fig4" ref-type="fig">4</xref></xref>.</p>
      <p>The parameter ρ is responsible for variance
change. We developed
a formula that, by adding it to a given molecule, changes the variance
of the molecule’s spectrum in the fastest possible way but
does not change its average mass (see <ext-link xmlns:xlink="http://www.w3.org/1999/xlink" ext-link-type="uri" xlink:href="https://pubs.acs.org/doi/suppl/10.1021/jasms.2c00176/suppl_file/js2c00176_si_001.pdf">Supporting Information</ext-link> for details). The formula should be added after
checking how many averagine molecules can be contained in a given
mass, but before the rounding. Parameter ρ is a multiplier of
the formula and controls how much the simulated spectrum’s
variance should be modified.</p>
      <p>We have to optimize those two parameters
to obtain the final simulated
spectrum. We use Wasserstein distance <italic>W</italic>(<xref ref-type="bibr" rid="ref12">12</xref>,<xref ref-type="bibr" rid="ref13">13</xref>) to compare spectra, which is fast to compute and gives relatively
good comparison scores. Note that, for every fixed shift <italic>k</italic> of initial averagine, a different parameter value ρ will minimize
the Wasserstein distance. Therefore, for a given <italic>k</italic> the optimal quantity of ρ can be formulated as<disp-formula id="ueq8"><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="js2c00176_m017" position="anchor"/></disp-formula>Then, concerning optimal values of ρ<sub><italic>k</italic></sub>, we can optimize the shift of the spectrum<disp-formula id="ueq9"><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="js2c00176_m018" position="anchor"/></disp-formula>Finally, <inline-formula id="d33e619"><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="js2c00176_m019.gif"/></inline-formula> is the spectrum we look for.
In simpler
words, we optimize the variance separately for different copies of
averagine shifted by <italic>k</italic> · ζ̂ Da and
then pick the spectrum with the smallest Wasserstein distance to the
experimental spectrum <inline-formula id="d33e625"><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="js2c00176_m020.gif"/></inline-formula>. We use the
spectrum to run the prediction
described in the previous <italic>Thoeretical spectra</italic> section
to obtain monoisotopic peak mass. Examples of constructed spectra
with their theoretical and experimental substitutes can be found in <xref rid="fig5" ref-type="fig">Figure <xref rid="fig5" ref-type="fig">5</xref></xref>.</p>
      <fig id="fig5" position="float">
        <label>Figure 5</label>
        <caption>
          <p>Two examples of matched
spectra. In each column, experimental and
theoretical spectra of insulin and myoglobin are presented, respectively
(blue). In the second row, theoretical spectra that were matched (simulated)
to the experimental one are imposed on (orange). Note that, in the
right column, we present a badly matched spectrum for which off-by-dalton
error occurred.</p>
        </caption>
        <graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="js2c00176_0005" id="gr5" position="float"/>
      </fig>
    </sec>
    <sec id="sec2.4">
      <title>Data</title>
      <p>To train
and test linear models on theoretical
spectra, we took proteins from the Uniprot database<sup><xref ref-type="bibr" rid="ref11">11</xref></sup> with 8–400 kDa mass range; other proteins were omitted
due to its minority. From a chemical formula, we computed
a protein’s theoretical spectrum using <monospace>IsoSpec</monospace> isotopic structure calculator. The smallest peaks were not computed
to keep computational time low, and the algorithm stops when the summed
intensity (probability) exceeds 99%. Both linear models (<xref rid="eq1" ref-type="disp-formula">1</xref>) and (<xref rid="eq2" ref-type="disp-formula">2</xref>) were cross-validated on 1.9
million and 80 000 randomly chosen proteins, respectively.</p>
      <p>We used the same spectra as in <monospace>MIND</monospace> for the
proof-of-concept experiments. Spectra were acquired on a Thermo LTQ
OrbitrapVelos, operated at a resolving power of 10<sup>5</sup> at
400 <italic>m</italic>/<italic>z</italic>, and 10<sup>6</sup> charges
were accumulated in the LTQ for analysis in the Orbitrap. Immediately
prior to infusion of the protein, external calibration was performed
via an automatic routine, using a standard calibration mix containing <italic>n</italic>-butylamine, caffeine, MRFA, and Ultramark 1621 (PierceLTQ
Velos ESI Positive Ion Calibration Solution, Thermo catalog no. 88323).
Bovine insulin (Sigma catalogue no. I5500; 50 scans with 3 well visible
charges; monoisotopic mass 5729.60 Da, average mass 5733.58 Da), equine
apo-myoglobin (Sigma catalogue no. M0630; 200 scans with 2 well visible
charges and another 100 scans with 3 well visible charges; monoisotopic
mass 16 940.97 Da, average mass 16 951.50 Da), and equine
cytochrome c (Sigma catalog no. C2506; 400 scans with 3 well visible
charges; monoisotopic mass 12 352.23 Da, average mass 12 360.21
Da) were acquired from Sigma and infused at a concentration of 1 μM
in 49:50:1 H<sub>2</sub>O/MeCN/HCOOH, without further purification,
using nano-ESI (ESI = electrospray ionization) with an Advion Triversa
Nanomateinlet system. In summary, we possess 550 (150 bovine insulin
and 400 equine apo-myoglobin) high-resolution experimental spectra
segments (i.e., selected intervals with a single charge in it) and
1500 (300 equine apo-myoglobin and 1200 equine cytochrome c) lower-quality
spectra segments.</p>
    </sec>
  </sec>
  <sec id="sec3">
    <title>Results and Discussion</title>
    <p>Let us remind
that the <monospace>envemind</monospace> algorithm
is dedicated to spectra with quality good enough to easily distinguish
an isotopic envelope “by eye”. Therefore, we divided
testing into three categories of spectra quality. First, simulated
spectra that were computed by <monospace>IsoSpec</monospace> based
on chemical formulas of actual proteins from the Uniprot database.
The remaining two categories are experimental spectra: with visible
isotopic envelope and somewhat noisy. Finally, we compared our results
to those of the <monospace>MIND</monospace> algorithm for which prediction
is based on the most abundant peak. For experimental spectra, we preprocessed
data to select the reliable most abundant peak as described in their
work and then with use of an online shiny app (<uri xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="https://valkenborg-lab.shinyapps.io/mind/">https://valkenborg-lab.shinyapps.io/mind/</uri>).</p>
    <p>We begin with tests on simulated spectra. Since the <monospace>MIND</monospace> algorithm was trained on proteins within the 8–60
kDa mass range, first, we tested <monospace>envemind</monospace> on
a wider range of 8–400 kDa. The mean absolute error (MAE) of
monoisotopic mass prediction was 0.51 ppm (0.0358 Da). For 96.6% of
proteins, off-by-one dalton errors did not occur. For them, MAE was
0.0526 ppm (0.0020 Da). To compare with <monospace>MIND</monospace>, we ran the prediction in three mass range groups: 8–20,
20–40, and 40–60 kDa. The distribution of off-by-one
dalton errors is presented in <xref rid="fig6" ref-type="fig">Figure <xref rid="fig6" ref-type="fig">6</xref></xref>. Exact results for cases when off-by-one dalton errors
did not occur are presented in the table below in ppm (Da): <array><tbody><tr><td style="border:none;" align="left">kDa</td><td style="border:none;" align="left"><monospace>envemind</monospace></td><td style="border:none;" align="left"><monospace>MIND</monospace></td></tr><tr><td style="border:none;" align="left">8–20</td><td style="border:none;" align="left">0.0693
(0.0009)</td><td style="border:none;" align="left">0.0670 (0.0009)</td></tr><tr><td style="border:none;" align="left">20–40</td><td style="border:none;" align="left">0.0474
(0.0014)</td><td style="border:none;" align="left">0.0549 (0.0016)</td></tr><tr><td style="border:none;" align="left">40–60</td><td style="border:none;" align="left">0.0393
(0.0019)</td><td style="border:none;" align="left">0.0478 (0.0023)</td></tr></tbody></array>For tests on spectra with visible isotopic envelopes,
we used
550 spectra segments. Note that the average mass of insulin is a bit
below the mass range of the training set, but it still provides accurate
results. MAE was equal to 0.0338 Da (2.57 ppm). In 547 cases (99.5%),
the off-by-one dalton errors did not occur. If we consider only these
cases, MAE drops to 0.0286 Da (2.06 ppm). Only 400 used spectra segments
fit in the <monospace>MIND</monospace> mass range. They never got
off-by-one dalton errors, while <monospace>envemind</monospace> had
2 such errors out of 400. MAE when off-by-one dalton errors did not
occur were 0.0349 Da (2.06 ppm) for <monospace>envemind</monospace> and 0.0278 Da (1.64 ppm) for <monospace>MIND</monospace>.</p>
    <fig id="fig6" position="float">
      <label>Figure 6</label>
      <caption>
        <p>Comparison
to find how often off-by-one dalton errors occur for <monospace>envemind</monospace> and <monospace>MIND</monospace> algorithms.
Tests were performed on theoretical spectra of 1000 randomly chosen
proteins in three mass range groups. If the prediction absolute error
is ca. 2 Da or more, we include the error to responding ±1 Da
bar.</p>
      </caption>
      <graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="js2c00176_0006" id="gr6" position="float"/>
    </fig>
    <p>Finally, we tested <monospace>envemind</monospace> on spectra with
lower quality than expected, 1500 spectra segments. Off-by-one dalton
errors occurred in 1258 cases. The MAE was 0.0367 Da (2.53 ppm) for
cases that did not occur. For <monospace>MIND</monospace>, the number
of off-by-one dalton errors was 799, with MAE of 0.0280 Da (2.13 ppm)
for the remaining cases.</p>
    <p>Let us remind about two essential assumptions
of the <monospace>envemind</monospace> algorithm. The first is the
quality of data.
As can be noticed, its performance grows as data quality grows. Therefore,
it should be used for the best quality spectra, where the probability
of off-by-one dalton error has to be minimized. The algorithm also
has a wide mass range, which is another advantage over other algorithms.
Since <monospace>MIND</monospace> for its prediction requires only
mass on the most abundant peak, it is a useful tool for noised spectra,
especially when only a very few peaks are visible. The second assumption
is that the <monospace>envemind</monospace> algorithm only works on
spectra of a single molecule. Hence, the molecule under study has
to be isolated in a mass spectrometer, or deconvolution can be performed
using appropriate algorithms like <monospace>masserstein</monospace>.<sup><xref ref-type="bibr" rid="ref14">14</xref></sup></p>
    <p>Let us discuss a bit more about
simulating theoretical spectra
for experimental ones. In this work, we described a construction method
that provides good prediction in a short computational time. Note
that, for this purpose, we used Wasserstein distance. However, there
are more measures to compare spectra, and new ones are under research.
Unfortunately, modern measures require too much computational time
and sometimes lead to mistakes to be avoided. On the other hand, the <monospace>envemind</monospace> algorithm is very flexible, and applying new
measures will be easy when they appear. That may improve prediction
and extend utility to low-resolution spectra too.</p>
    <p>Also, the
whole procedure of obtaining a simulated spectrum can
be replaced as new measures appear. We developed an alternative method,
which we expect to be more accurate. However, due to long computational
time of modern measures, the method is awkward. The method compares
many theoretical spectra of substances with similar average mass to
an experimental spectrum instead of constructing simulated spectrum
from scratch. A detailed description of this approach is attached
in the <ext-link xmlns:xlink="http://www.w3.org/1999/xlink" ext-link-type="uri" xlink:href="https://pubs.acs.org/doi/suppl/10.1021/jasms.2c00176/suppl_file/js2c00176_si_001.pdf">Supporting Information</ext-link> with the
use of <monospace>masserstein</monospace> measure.</p>
    <p>We argue
that the monoisotopic peak mass prediction can be based
on such artificial but, at the same time, well-fitted spectrum. Notice
that the algorithm fits the inherently noisy experimental spectra,
and only certain peaks are well-visible. Therefore, the obtained spectrum
can differ from the true one. However, it should have the same average
mass and variance, which is essential. On the other hand, one may
ask if we can determine monoisotopic mass directly from the matched
spectrum. Tests show that, on our data, both approaches gave almost
identical results. However, the linear model provides a safe solution
since the model was trained on actual proteins.</p>
    <p>In the end,
we would like to highlight innovative aspects of this
work. Under the <monospace>envemind</monospace> algorithm stands the
idea of mathematical exploring of molecule space, where every 5-dimensional
integer point is considered as chemical formula and theoretical spectrum
simultaneously. Such a point of view lets us elaborate vectors that
added to a chemical formula change (or do not) individual features
of the spectrum, like average mass or variance. We know where the
optimal solution should be looked for in the space with this knowledge.</p>
  </sec>
</body>
<back>
  <notes id="notes-1" notes-type="si">
    <title>Supporting Information Available</title>
    <p>The Supporting Information
is available free of charge at <ext-link xmlns:xlink="http://www.w3.org/1999/xlink" ext-link-type="uri" xlink:href="https://pubs.acs.org/doi/10.1021/jasms.2c00176?goto=supporting-info">https://pubs.acs.org/doi/10.1021/jasms.2c00176</ext-link>.<list id="silist" list-type="simple"><list-item><p>Mathematical details of
the <monospace>envemind</monospace> algorithm and description of alternative
way for matching theoretical
spectra to experimental ones (<ext-link xmlns:xlink="http://www.w3.org/1999/xlink" ext-link-type="uri" xlink:href="https://pubs.acs.org/doi/suppl/10.1021/jasms.2c00176/suppl_file/js2c00176_si_001.pdf">PDF</ext-link>)</p></list-item></list></p>
  </notes>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material content-type="local-data" id="sifile1">
      <media xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="js2c00176_si_001.pdf">
        <caption>
          <p>js2c00176_si_001.pdf</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
  <notes notes-type="COI-statement" id="NOTES-d14e1208-autogenerated">
    <p>The
authors declare no
competing financial interest.</p>
  </notes>
  <ack>
    <title>Acknowledgments</title>
    <p>The work was supported by the Polish National
Science Centre
Grant Nos. 2018/29/B/ST6/00681 and 2017/26/D/ST6/00304.</p>
  </ack>
  <ref-list>
    <title>References</title>
    <ref id="ref1">
      <mixed-citation publication-type="journal" id="cit1"><name><surname>Brown</surname><given-names>K. A.</given-names></name>; <name><surname>Melby</surname><given-names>J. A.</given-names></name>; <name><surname>Roberts</surname><given-names>D. S.</given-names></name>; <name><surname>Ge</surname><given-names>Y.</given-names></name><article-title>Top-down proteomics:
challenges, innovations, and applications in basic and clinical research</article-title>. <source>Expert Rev. Proteomics</source><year>2020</year>, <volume>17</volume>, <fpage>719</fpage>–<lpage>733</lpage>. <pub-id pub-id-type="doi">10.1080/14789450.2020.1855982</pub-id>.<pub-id pub-id-type="pmid">33232185</pub-id></mixed-citation>
      <note>
        <p>PMID: 33232185.</p>
      </note>
    </ref>
    <ref id="ref2">
      <mixed-citation publication-type="journal" id="cit2"><name><surname>Lermyte</surname><given-names>F.</given-names></name>; <name><surname>Dittwald</surname><given-names>P.</given-names></name>; <name><surname>Claesen</surname><given-names>J.</given-names></name>; <name><surname>Baggerman</surname><given-names>G.</given-names></name>; <name><surname>Sobott</surname><given-names>F.</given-names></name>; <name><surname>O’Connor</surname><given-names>P. B.</given-names></name>; <name><surname>Laukens</surname><given-names>K.</given-names></name>; <name><surname>Hooyberghs</surname><given-names>J.</given-names></name>; <name><surname>Gambin</surname><given-names>A.</given-names></name>; <name><surname>Valkenborg</surname><given-names>D.</given-names></name><article-title>MIND: A Double-Linear
Model To Accurately
Determine Monoisotopic Precursor Mass in High-Resolution Top-Down
Proteomics</article-title>. <source>Anal. Chem.</source><year>2019</year>, <volume>91</volume>, <fpage>10310</fpage>–<lpage>10319</lpage>. <pub-id pub-id-type="doi">10.1021/acs.analchem.9b02682</pub-id>.<pub-id pub-id-type="pmid">31283196</pub-id></mixed-citation>
      <note>
        <p>PMID: 31283196.</p>
      </note>
    </ref>
    <ref id="ref3">
      <mixed-citation publication-type="journal" id="cit3"><name><surname>Valkenborg</surname><given-names>D.</given-names></name>; <name><surname>Mertens</surname><given-names>I.</given-names></name>; <name><surname>Lemière</surname><given-names>F.</given-names></name>; <name><surname>Witters</surname><given-names>E.</given-names></name>; <name><surname>Burzykowski</surname><given-names>T.</given-names></name><article-title>The isotopic
distribution conundrum</article-title>. <source>Mass Spectrom. Rev.</source><year>2012</year>, <volume>31</volume>, <fpage>96</fpage>–<lpage>109</lpage>. <pub-id pub-id-type="doi">10.1002/mas.20339</pub-id>.<pub-id pub-id-type="pmid">21590704</pub-id></mixed-citation>
    </ref>
    <ref id="ref4">
      <mixed-citation publication-type="journal" id="cit4"><name><surname>Claesen</surname><given-names>J.</given-names></name>; <name><surname>Lermyte</surname><given-names>F.</given-names></name>; <name><surname>Sobott</surname><given-names>F.</given-names></name>; <name><surname>Burzykowski</surname><given-names>T.</given-names></name>; <name><surname>Valkenborg</surname><given-names>D.</given-names></name><article-title>Differences in the Elemental Isotope
Definition May
Lead to Errors in Modern Mass-Spectrometry-Based Proteomics</article-title>. <source>Anal. Chem.</source><year>2015</year>, <volume>87</volume>, <fpage>10747</fpage>–<lpage>10754</lpage>. <pub-id pub-id-type="doi">10.1021/acs.analchem.5b01165</pub-id>.<pub-id pub-id-type="pmid">26457653</pub-id></mixed-citation>
      <note>
        <p>PMID: 26457653.</p>
      </note>
    </ref>
    <ref id="ref5">
      <mixed-citation publication-type="journal" id="cit5"><name><surname>Claesen</surname><given-names>J.</given-names></name>; <name><surname>Dittwald</surname><given-names>P.</given-names></name>; <name><surname>Burzykowski</surname><given-names>T.</given-names></name>; <name><surname>Valkenborg</surname><given-names>D.</given-names></name><article-title>An Efficient
Method to Calculate the Aggregated Isotopic Distribution and Exact
Center-Masses</article-title>. <source>J. Am. Soc. Mass Spectrom.</source><year>2012</year>, <volume>23</volume>, <fpage>753</fpage>–<lpage>763</lpage>. <pub-id pub-id-type="doi">10.1007/s13361-011-0326-2</pub-id>.<pub-id pub-id-type="pmid">22351289</pub-id></mixed-citation>
    </ref>
    <ref id="ref6">
      <mixed-citation publication-type="journal" id="cit6"><name><surname>Ła̧cki</surname><given-names>M.
K.</given-names></name>; <name><surname>Startek</surname><given-names>M.</given-names></name>; <name><surname>Valkenborg</surname><given-names>D.</given-names></name>; <name><surname>Gambin</surname><given-names>A.</given-names></name><article-title>IsoSpec: Hyperfast
Fine Structure Calculator</article-title>. <source>Anal. Chem.</source><year>2017</year>, <volume>89</volume>, <fpage>3272</fpage>–<lpage>3277</lpage>. <pub-id pub-id-type="doi">10.1021/acs.analchem.6b01459</pub-id>.<pub-id pub-id-type="pmid">28234451</pub-id></mixed-citation>
    </ref>
    <ref id="ref7">
      <mixed-citation publication-type="journal" id="cit7"><name><surname>Senko</surname><given-names>M. W.</given-names></name>; <name><surname>Beu</surname><given-names>S. C.</given-names></name>; <name><surname>McLafferty</surname><given-names>F. W.</given-names></name><article-title>Determination
of monoisotopic masses
and ion populations for large biomolecules from resolved isotopic
distributions</article-title>. <source>J. Am. Soc. Mass Spectrom.</source><year>1995</year>, <volume>6</volume>, <fpage>229</fpage>–<lpage>233</lpage>. <pub-id pub-id-type="doi">10.1016/1044-0305(95)00017-8</pub-id>.<pub-id pub-id-type="pmid">24214167</pub-id></mixed-citation>
    </ref>
    <ref id="ref8">
      <mixed-citation publication-type="journal" id="cit8"><name><surname>Dittwald</surname><given-names>P.</given-names></name>; <name><surname>Claesen</surname><given-names>J.</given-names></name>; <name><surname>Burzykowski</surname><given-names>T.</given-names></name>; <name><surname>Valkenborg</surname><given-names>D.</given-names></name>; <name><surname>Gambin</surname><given-names>A.</given-names></name><article-title>BRAIN: A Universal Tool for High-Throughput
Calculations
of the Isotopic Distribution for Mass Spectrometry</article-title>. <source>Anal. Chem.</source><year>2013</year>, <volume>85</volume>, <fpage>1991</fpage>–<lpage>1994</lpage>. <pub-id pub-id-type="doi">10.1021/ac303439m</pub-id>.<pub-id pub-id-type="pmid">23350948</pub-id></mixed-citation>
      <note>
        <p>PMID: 23350948.</p>
      </note>
    </ref>
    <ref id="ref9">
      <mixed-citation publication-type="journal" id="cit9"><name><surname>Chen</surname><given-names>Y.-F.</given-names></name>; <name><surname>Chang</surname><given-names>C. A.</given-names></name>; <name><surname>Lin</surname><given-names>Y.-H.</given-names></name>; <name><surname>Tsay</surname><given-names>Y.-G.</given-names></name><article-title>Determination of
accurate protein monoisotopic mass with the most abundant mass measurable
using high-resolution mass spectrometry</article-title>. <source>Anal.
Biochem.</source><year>2013</year>, <volume>440</volume>, <fpage>108</fpage>–<lpage>113</lpage>. <pub-id pub-id-type="doi">10.1016/j.ab.2013.05.018</pub-id>.<pub-id pub-id-type="pmid">23743151</pub-id></mixed-citation>
    </ref>
    <ref id="ref10">
      <mixed-citation publication-type="journal" id="cit10"><name><surname>Valkenborg</surname><given-names>D.</given-names></name>; <name><surname>Mertens</surname><given-names>I.</given-names></name>; <name><surname>Lemière</surname><given-names>F.</given-names></name>; <name><surname>Witters</surname><given-names>E.</given-names></name>; <name><surname>Burzykowski</surname><given-names>T.</given-names></name><article-title>The isotopic
distribution conundrum</article-title>. <source>Mass Spectrom. Rev.</source><year>2012</year>, <volume>31</volume>, <fpage>96</fpage>–<lpage>109</lpage>. <pub-id pub-id-type="doi">10.1002/mas.20339</pub-id>.<pub-id pub-id-type="pmid">21590704</pub-id></mixed-citation>
    </ref>
    <ref id="ref11">
      <mixed-citation publication-type="journal" id="cit11"><article-title>UniProt:
a hub for protein information</article-title>. <source>Nucleic Acids
Res.</source><year>2014</year>, <volume>43</volume>, <fpage>D204</fpage>–<lpage>D212</lpage>. <pub-id pub-id-type="doi">10.1093/nar/gku989</pub-id>.<pub-id pub-id-type="pmid">25348405</pub-id></mixed-citation>
    </ref>
    <ref id="ref12">
      <mixed-citation publication-type="book" id="cit12"><person-group person-group-type="allauthors"><name><surname>Villani</surname><given-names>C.</given-names></name></person-group><source>Optimal Transport: Old
and New</source><italic>;</italic> Book Series: Grundlehren der mathematischen
Wissenschaften; <publisher-name>Springer</publisher-name>: <publisher-loc>Berlin, Germany</publisher-loc>, <year>2008</year>; Vol. <volume>338</volume><pub-id pub-id-type="doi">10.1007/978-3-540-71050-9</pub-id>.</mixed-citation>
    </ref>
    <ref id="ref13">
      <mixed-citation publication-type="journal" id="cit13"><name><surname>Rubner</surname><given-names>Y.</given-names></name>; <name><surname>Tomasi</surname><given-names>C.</given-names></name>; <name><surname>Guibas</surname><given-names>L. J.</given-names></name><article-title>The earth mover’s distance
as a metric for image retrieval</article-title>. <source>International
journal of computer vision</source><year>2000</year>, <volume>40</volume>, <fpage>99</fpage>–<lpage>121</lpage>. <pub-id pub-id-type="doi">10.1023/A:1026543900054</pub-id>.</mixed-citation>
    </ref>
    <ref id="ref14">
      <mixed-citation publication-type="journal" id="cit14"><name><surname>Ciach</surname><given-names>M. A.</given-names></name>; <name><surname>Miasojedow</surname><given-names>B.</given-names></name>; <name><surname>Skoraczyński</surname><given-names>G.</given-names></name>; <name><surname>Majewski</surname><given-names>S.</given-names></name>; <name><surname>Startek</surname><given-names>M.</given-names></name>; <name><surname>Valkenborg</surname><given-names>D.</given-names></name>; <name><surname>Gambin</surname><given-names>A.</given-names></name><article-title>Masserstein: Linear regression of
mass spectra by optimal transport</article-title>. <source>Rapid Commun.
Mass Spectrom.</source><year>2020</year>, <fpage>e8956</fpage><pub-id pub-id-type="doi">10.1002/rcm.8956</pub-id>.<pub-id pub-id-type="pmid">32996651</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
