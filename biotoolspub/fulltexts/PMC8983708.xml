<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName A++V2.4.dtd?>
<?SourceDTD.Version 2.4?>
<?ConverterInfo.XSLTName springer2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Nat Commun</journal-id>
    <journal-id journal-id-type="iso-abbrev">Nat Commun</journal-id>
    <journal-title-group>
      <journal-title>Nature Communications</journal-title>
    </journal-title-group>
    <issn pub-type="epub">2041-1723</issn>
    <publisher>
      <publisher-name>Nature Publishing Group UK</publisher-name>
      <publisher-loc>London</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">8983708</article-id>
    <article-id pub-id-type="publisher-id">29497</article-id>
    <article-id pub-id-type="doi">10.1038/s41467-022-29497-w</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Article</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title><italic>acorde</italic> unravels functionally interpretable networks of isoform co-usage from single cell data</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-2959-0134</contrib-id>
        <name>
          <surname>Arzalluz-Luque</surname>
          <given-names>Angeles</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-1879-3374</contrib-id>
        <name>
          <surname>Salguero</surname>
          <given-names>Pedro</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author" corresp="yes" equal-contrib="yes">
        <name>
          <surname>Tarazona</surname>
          <given-names>Sonia</given-names>
        </name>
        <address>
          <email>sotacam@eio.upv</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author" corresp="yes" equal-contrib="yes">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0001-9597-311X</contrib-id>
        <name>
          <surname>Conesa</surname>
          <given-names>Ana</given-names>
        </name>
        <address>
          <email>ana.conesa@csic.es</email>
        </address>
        <xref ref-type="aff" rid="Aff2">2</xref>
        <xref ref-type="aff" rid="Aff3">3</xref>
      </contrib>
      <aff id="Aff1"><label>1</label><institution-wrap><institution-id institution-id-type="GRID">grid.157927.f</institution-id><institution-id institution-id-type="ISNI">0000 0004 1770 5832</institution-id><institution>Department of Applied Statistics, Operations Research and Quality, </institution><institution>Universitat Politècnica de València, </institution></institution-wrap>Valencia, Spain </aff>
      <aff id="Aff2"><label>2</label><institution-wrap><institution-id institution-id-type="GRID">grid.4711.3</institution-id><institution-id institution-id-type="ISNI">0000 0001 2183 4846</institution-id><institution>Institute for Integrative Systems Biology (CSIC-UV), </institution><institution>Spanish National Research Council, </institution></institution-wrap>Paterna, Valencia Spain </aff>
      <aff id="Aff3"><label>3</label><institution-wrap><institution-id institution-id-type="GRID">grid.15276.37</institution-id><institution-id institution-id-type="ISNI">0000 0004 1936 8091</institution-id><institution>Microbiology and Cell Sciences Department, Institute for Food and Agricultural Research, </institution><institution>University of Florida, </institution></institution-wrap>Gainesville, FL USA </aff>
    </contrib-group>
    <pub-date pub-type="epub">
      <day>5</day>
      <month>4</month>
      <year>2022</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>5</day>
      <month>4</month>
      <year>2022</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2022</year>
    </pub-date>
    <volume>13</volume>
    <elocation-id>1828</elocation-id>
    <history>
      <date date-type="received">
        <day>12</day>
        <month>5</month>
        <year>2021</year>
      </date>
      <date date-type="accepted">
        <day>16</day>
        <month>3</month>
        <year>2022</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2022</copyright-statement>
      <license>
        <ali:license_ref specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p><bold>Open Access</bold> This article is licensed under a Creative Commons Attribution 4.0 International License, which permits use, sharing, adaptation, distribution and reproduction in any medium or format, as long as you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons license, and indicate if changes were made. The images or other third party material in this article are included in the article’s Creative Commons license, unless indicated otherwise in a credit line to the material. If material is not included in the article’s Creative Commons license and your intended use is not permitted by statutory regulation or exceeds the permitted use, you will need to obtain permission directly from the copyright holder. To view a copy of this license, visit <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>.</license-p>
      </license>
    </permissions>
    <abstract id="Abs1">
      <p id="Par1">Alternative splicing (AS) is a highly-regulated post-transcriptional mechanism known to modulate isoform expression within genes and contribute to cell-type identity. However, the extent to which alternative isoforms establish co-expression networks that may be relevant in cellular function has not been explored yet. Here, we present <italic>acorde</italic>, a pipeline that successfully leverages bulk long reads and single-cell data to confidently detect alternative isoform co-expression relationships. To achieve this, we develop and validate percentile correlations, an innovative approach that overcomes data sparsity and yields accurate co-expression estimates from single-cell data. Next, <italic>acorde</italic> uses correlations to cluster co-expressed isoforms into a network, unraveling cell type-specific alternative isoform usage patterns. By selecting same-gene isoforms between these clusters, we subsequently detect and characterize genes with co-differential isoform usage (coDIU) across cell types. Finally, we predict functional elements from long read-defined isoforms and provide insight into biological processes, motifs, and domains potentially controlled by the coordination of post-transcriptional regulation. The code for <italic>acorde</italic> is available at <ext-link ext-link-type="uri" xlink:href="https://github.com/ConesaLab/acorde">https://github.com/ConesaLab/acorde</ext-link>.</p>
    </abstract>
    <abstract id="Abs2" abstract-type="web-summary">
      <p id="Par2">Alternative splicing (AS) is a highly-regulated post-transcriptional mechanism known to modulate isoform expression within genes and contribute to cell-type identity. Here, the authors present <italic>acorde</italic>, a pipeline that successfully leverages bulk long reads and single-cell data to confidently detect alternative isoform co-expression relationships.</p>
    </abstract>
    <kwd-group kwd-group-type="npg-subject">
      <title>Subject terms</title>
      <kwd>Computational biology and bioinformatics</kwd>
      <kwd>Systems biology</kwd>
    </kwd-group>
    <custom-meta-group>
      <custom-meta>
        <meta-name>issue-copyright-statement</meta-name>
        <meta-value>© The Author(s) 2022</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec id="Sec1" sec-type="introduction">
    <title>Introduction</title>
    <p id="Par3">Single-cell RNA-seq (scRNA-seq) has revolutionized transcriptomics analysis, especially as the development of technologies with increasingly higher throughputs has enabled the processing of thousands of single cells simultaneously, boosting the amount of biological diversity that can be captured in a sequencing experiment<sup><xref ref-type="bibr" rid="CR1">1</xref></sup>. The technology has been extensively applied to the discovery of new cell types and the characterization of their transcriptional profiles, resulting in the definition of cell type marker genes<sup><xref ref-type="bibr" rid="CR2">2</xref>–<xref ref-type="bibr" rid="CR7">7</xref></sup>. Even though scRNA-seq datasets can encode several levels of granularity in the form of cell subtypes, these studies rely on the low number of features required to recapitulate the cell type structure of the data<sup><xref ref-type="bibr" rid="CR8">8</xref></sup>, which situates cell type characterization efforts at the baseline of understanding the intricacy of single-cell biology. scRNA-seq studies have also tackled transcriptional dynamics and how they relate to cell type properties. These include methods for the study of dynamic processes, namely pseudotime<sup><xref ref-type="bibr" rid="CR9">9</xref>,<xref ref-type="bibr" rid="CR10">10</xref></sup> and RNA-velocity<sup><xref ref-type="bibr" rid="CR11">11</xref></sup> analyses, which have provided insight on cell differentiation and the mechanisms behind cell state transitions<sup><xref ref-type="bibr" rid="CR7">7</xref>,<xref ref-type="bibr" rid="CR12">12</xref>–<xref ref-type="bibr" rid="CR16">16</xref></sup>. Moreover, novel methods have been developed to allow the inference of gene regulatory networks (GRNs) at the single-cell level<sup><xref ref-type="bibr" rid="CR17">17</xref></sup>, in an attempt to combine single-cell information with extant knowledge and infer relationships between genes and transcriptional regulators at a higher resolution.</p>
    <p id="Par4">Single-cell research is nevertheless far from realizing its full potential. On the contrary, the timing is now optimal for the field to undertake the investigation of deeper layers of cellular complexity. In particular, the investigation of alternative splicing (AS) and isoform expression dynamics has remained a challenge to the field. Reasons for this include the uncertainty of short read-based isoform quantification, which is exacerbated by the lower number of available reads per transcript in comparison to bulk libraries<sup><xref ref-type="bibr" rid="CR18">18</xref></sup>, and the fact that the most popular scRNA-seq methods are heavily 3′ end biased, which precludes the unambiguous identification of alternative transcript variants<sup><xref ref-type="bibr" rid="CR19">19</xref></sup>. Current methods for the study of isoforms in single cells, therefore, rely on alternative metrics that either avoid isoform-level expression estimation completely<sup><xref ref-type="bibr" rid="CR20">20</xref>,<xref ref-type="bibr" rid="CR21">21</xref></sup> or exclusively consider individual splicing events<sup><xref ref-type="bibr" rid="CR22">22</xref>–<xref ref-type="bibr" rid="CR26">26</xref></sup>, generally leaving isoform characterization aside, with some recent exceptions<sup><xref ref-type="bibr" rid="CR27">27</xref></sup>. Meanwhile, long read RNA sequencing (lrRNA-seq) of single cells is beginning to emerge an alternative approach to mitigate this ambiguity, given that it successfully grasps how individual events are combined into alternative isoforms<sup><xref ref-type="bibr" rid="CR19">19</xref></sup>. Long read studies have expanded the field’s notions of cell type-specific splicing from event inclusion towards isoform selection patterns and showed that cell type-specific isoform expression can be detected in both broad types as well as cell subtypes<sup><xref ref-type="bibr" rid="CR28">28</xref>–<xref ref-type="bibr" rid="CR32">32</xref></sup>. Unfortunately, the sequencing depth constraints intrinsic to long read protocols<sup><xref ref-type="bibr" rid="CR19">19</xref></sup> have limited the amount of isoform diversity that can be captured by single-cell long read transcriptomics<sup><xref ref-type="bibr" rid="CR28">28</xref>–<xref ref-type="bibr" rid="CR30">30</xref></sup>, and datasets generally show low levels of redundancy between cells of the same cell type.</p>
    <p id="Par5">Notwithstanding this limited scenario, there are a number of relevant questions regarding the importance of splicing for cell identity and function that can only be resolved by evaluating isoform expression at the single-cell level. In fact, splicing differences have been shown to discriminate cell types with an accuracy comparable to that obtained using gene expression<sup><xref ref-type="bibr" rid="CR33">33</xref></sup> while integrating AS and gene expression changes has led to the discovery of cell subtypes and states that were otherwise not detected<sup><xref ref-type="bibr" rid="CR27">27</xref>,<xref ref-type="bibr" rid="CR34">34</xref>–<xref ref-type="bibr" rid="CR36">36</xref></sup>. Especially relevant among these inquiries is the much-debated issue of whether individual cells express one or several isoforms, that is, whether the isoform diversity observed in bulk studies is recapitulated by each single cell or, alternatively, arises as a result of multiple cells expressing one of the gene’s isoforms. Ever since the publication of the first scRNA-seq studies, short reads have been used to answer this question, usually via the characterization of splicing event—rather than isoform expression- modalities. Successive studies have provided non-conclusive results, with evidence of bimodal splicing patterns<sup><xref ref-type="bibr" rid="CR22">22</xref>,<xref ref-type="bibr" rid="CR37">37</xref>,<xref ref-type="bibr" rid="CR38">38</xref></sup> as well as concerns regarding the relationship between bimodal isoform detection and technical noise<sup><xref ref-type="bibr" rid="CR18">18</xref>,<xref ref-type="bibr" rid="CR39">39</xref></sup>, a controversy that suggests that new approaches are needed to understand the isoform landscape of single cells.</p>
    <p id="Par6">Another pending question for the field is whether isoform expression programs involve co-expression relationships between transcript variants from different genes. So far, the application of long read technologies to single-cell data has served to unravel coordinated event choice patterns within isoforms of the same gene<sup><xref ref-type="bibr" rid="CR40">40</xref>,<xref ref-type="bibr" rid="CR41">41</xref></sup>, however, cross-gene isoform expression networks have not been investigated. In other words, there have been no studies addressing potential codependency between genes regarding the selection of transcript variants from their isoform repertoire, or the implications of this coordination for cell-state and cell-type properties. This is not only related to the general constraints of single-cell isoform studies, but also to the lack of computational methods and mathematical models to extract this complex signal from the data. In spite of the present research gap, isoform co-expression networks are an anticipated consequence of the regulation of splicing by RNA binding proteins (RBPs) and other splicing factors, and their investigation constitutes an opportunity to gain insight on the functional role of AS. Moreover, a multiple cell type and high cell throughput context such as that of scRNA-seq data constitutes a far more suitable data scenario to that of bulk RNA-seq. Given this context, this is undoubtedly a timely inquiry to make.</p>
    <p id="Par7">In the present study, we hypothesize that isoform expression coordination exists as a result of AS regulation, and that it can be computationally detected in the form of isoform groups showing co-variation across cell types. To demonstrate this hypothesis, we have designed an end-to-end, data-intensive pipeline for the study of isoform networks (Fig. <xref rid="Fig1" ref-type="fig">1</xref>). First and foremost, we employed a hybrid strategy where bulk long-reads and single-cell Illumina sequencing were integrated to estimate isoform expression at the single cell level. To unlock the limitations of extant correlation metrics in the single-cell context<sup><xref ref-type="bibr" rid="CR42">42</xref></sup>, we developed a strategy to obtain noise-robust correlation estimates in scRNA-seq data, and a semi-automated clustering approach to detect modules of co-expressed isoforms across cell types. We additionally defined and implemented Differential Isoform Usage (DIU) and co-Differential Isoform Usage (coDIU) analyses in order to leverage the multiple cell types contained in single-cell datasets. Finally, to couple these analyses with a biologically interpretable readout, we incorporated a functional annotation step in which several databases and prediction tools were integrated to add isoform-specific functional information (Fig. <xref rid="Fig1" ref-type="fig">1</xref>, <xref rid="MOESM1" ref-type="media">Supplementary Note</xref>).<fig id="Fig1"><label>Fig. 1</label><caption><title><italic>acorde w</italic>orkflow.</title><p>The <italic>acorde</italic> pipeline includes three main analysis modules. First, long read RNA-Seq data is used to define isoform models and short, single-cell RNA-Seq reads are mapped to the long read-generated transcriptome. Isoform are then tested for multi-group differential expression and those that are significantly DE in at least one of the cell types are selected. Next, percentile correlations are computed to cluster isoforms with similar expression patterns across cell types. Finally, gene pairs are tested for co-differential isoform usage, detecting genes that form co-expression relationships for subsequent functional analysis.</p></caption><graphic xlink:href="41467_2022_29497_Fig1_HTML" id="d32e445"/></fig></p>
    <p id="Par8">We have hereby applied this pipeline (Fig. <xref rid="Fig1" ref-type="fig">1</xref>) to the analysis of two publicly available mouse neural datasets, including scRNA-seq Smart-Seq2 (primary visual cortex, generated by Tasic et al.<sup><xref ref-type="bibr" rid="CR43">43</xref>,<xref ref-type="bibr" rid="CR44">44</xref></sup>) and bulk ENCODE PacBio long-read data (mouse cortex and hippocampus, generated by Wyman et al.<sup><xref ref-type="bibr" rid="CR45">45</xref></sup>). As a result, we successfully detected cell type-level co-expression of isoforms in a manner that was independent of gene-level expression. Furthermore, we demonstrated that these isoforms encode shared functional properties, highlighting the role of post-transcriptional processing as in the fine-tuning of cellular functions and the encoding of cell type identity. This pipeline has been implemented in the R package <italic>acorde</italic> (<ext-link ext-link-type="uri" xlink:href="https://github.com/ConesaLab/acorde">https://github.com/ConesaLab/acorde</ext-link>).</p>
  </sec>
  <sec id="Sec2" sec-type="results">
    <title>Results</title>
    <sec id="Sec3">
      <title>Enabling multi-group differential expression (DE) of isoforms in single-cell data</title>
      <p id="Par9">Traditionally, RNA-seq studies have used publicly available reference transcriptomes such as RefSeq and ENSEMBL for short read isoform quantification. However, most tissues and cell types will express only a subset of the genes and isoforms contained in the reference, with previous studies showing that isoform detection accuracy increases when adopting tissue-specific isoform sets as a reference for mapping<sup><xref ref-type="bibr" rid="CR46">46</xref></sup>. Long read technologies have the potential to achieve this, while also expanding the reference with novel isoforms that have not yet been annotated<sup><xref ref-type="bibr" rid="CR47">47</xref></sup>. Given the low depth of single-cell long read datasets<sup><xref ref-type="bibr" rid="CR19">19</xref></sup>, we employed bulk PacBio long-reads obtained from ENCODE<sup><xref ref-type="bibr" rid="CR45">45</xref></sup> to define a mouse, neural-specific transcriptome, that, after extensive curation using the SQANTI3 toolkit (<ext-link ext-link-type="uri" xlink:href="https://github.com/ConesaLab/SQANTI3">https://github.com/ConesaLab/SQANTI3</ext-link>) contained 36,986 isoforms belonging to 12,692 genes (see <xref rid="MOESM1" ref-type="media">Supplementary Note</xref>).</p>
      <p id="Par10">To quantify the expression of the long read-defined isoforms at the single-cell level, we made use of a publicly available, deeply sequenced, full-length, short-read single-cell RNA-seq dataset by Tasic et al.<sup><xref ref-type="bibr" rid="CR43">43</xref></sup>. In total, 1591 cells and 16,240 isoforms from 8814 genes were retained after quality control (see “Methods”). Using the labels from the original characterization of the dataset, we assigned cells to 7 broad cell types, 5 glial (microglia, endothelial cells, oligodendrocytes, oligodendrocyte precursor cells (OPCs) and astrocytes) and 2 neural (GABA-ergic and glutamatergic neurons), each of which can be divided into several, distinct subtypes (Supplementary Fig. <xref rid="MOESM1" ref-type="media">1a</xref>). Next, to select isoforms with robust co-variation and non-constitutive expression, a multi-group strategy was used to detect isoforms showing DE in at least one cell type, combining the ZinBWaVE zero-expression weighting strategy<sup><xref ref-type="bibr" rid="CR48">48</xref></sup> with bulk-designed DE methods DESeq2<sup><xref ref-type="bibr" rid="CR49">49</xref></sup> and edgeR<sup><xref ref-type="bibr" rid="CR50">50</xref></sup> (see “Methods”).</p>
      <p id="Par11">Of note, the Tasic dataset presented a drastic cell number imbalance between neural (~720 cells/cell type) and glial cell types (~30 cells/cell type), which resulted in the underestimation of transcriptional differences between non-neural types (Supplementary Fig. <xref rid="MOESM1" ref-type="media">1b</xref>). To balance sample sizes, we performed 50 rounds of random neural cell sampling (<italic>n</italic> = 45 cells) followed by DE testing using both edgeR and DESeq2 (see “Methods”). Although DESeq2 proved to be slightly more robust across independent runs than edgeR, Jaccard index values indicated that the majority of isoforms were consistently detected as DE (DESeq2: mean no. of DE isoforms = 6908 ± 101, mean Jaccard index = 0.84 ± 0.02; edgeR: mean no. of DE isoforms = 6016 ± 410, mean Jaccard index = 0.74 ± 0.02). In addition, this strategy revealed that considering the union of edgeR and DESeq2 results contributed to improve robustness (mean no. of DE isoforms in union between methods = 9399 ± 248, Jaccard index = 0.82 ± 0.01). Upon testing, we selected a consensus set of isoforms consisting in those transcripts detected as significant (FDR &lt; 0.05) by at least one DE method in ≥50% downsampling runs. This consensus set included 9393 isoforms from 4223 genes, however, minor isoforms (those accumulating &lt;10% of total gene expression) were additionally filtered, resulting in the removal of ~10% of the consensus DE set (969 isoforms). Finally, since two or more isoforms with differential cell type expression are required to form co-splicing relationships (see “Methods”), transcripts with no other same-gene DE counterpart were removed, retaining 6794 isoforms from 2696 genes for downstream analysis.</p>
    </sec>
    <sec id="Sec4">
      <title>Detecting isoforms showing cell type-level co-expression</title>
      <p id="Par12">Co-expression signals in single-cell data are weak and have often resulted in a poor performance of traditional correlation and network inference methods<sup><xref ref-type="bibr" rid="CR42">42</xref>,<xref ref-type="bibr" rid="CR51">51</xref></sup>. Although data transformation approaches<sup><xref ref-type="bibr" rid="CR52">52</xref></sup> and alternative metrics<sup><xref ref-type="bibr" rid="CR42">42</xref></sup> have been proposed, these are more complex to apply and considerably less interpretable, respectively. Furthermore, most of these studies have only investigated gene-level co-expression<sup><xref ref-type="bibr" rid="CR17">17</xref></sup>, often ignoring the AS regulatory landscape. To address these limitations, we implemented a <italic>percentile correlation</italic> strategy: a simple, scalable approach to overcome single-cell noise in isoform co-expression studies (Fig. <xref rid="Fig2" ref-type="fig">2a</xref>).<fig id="Fig2"><label>Fig. 2</label><caption><title>Percentile correlations and isoform clustering.</title><p><bold>a</bold> Percentile correlation algorithm. For each isoform, cell type-level expression is summarized using percentiles (0–10) as a proxy of the isoform’s expression distribution in each of the cell types. Then, Pearson correlations are computed using the percentile-summarized expression of all isoforms, obtaining a percentile correlation matrix. <bold>b</bold> Correlation density distributions. Pairwise isoform correlations were computed using Pearson, Spearman, and percentile+Pearson correlation. <bold>c</bold> Clustering pipeline. The percentile correlation matrix is first used as a distance matrix for hierarchical clustering. After dynamic cluster generation, noisy clusters are refined by a three-step semi-automated process. <bold>d</bold> Clusters generated after applying the <italic>acorde</italic> clustering pipeline to the mouse neural dataset. Cell-level mean expression (scaled, see “Methods”) is computed for all transcripts and then aggregated as the global cell type mean, represented by the red line. Gray area corresponds to cell type mean ± standard deviation. Astr: astrocytes, End: endothelial cells, GABA: GABA-ergic neurons, Glut: glutamatergic neurons, Micr: microglia, Oligo: oligodendrocytes, OPC: oligodendrocyte precursor cells.</p></caption><graphic xlink:href="41467_2022_29497_Fig2_HTML" id="d32e587"/></fig></p>
      <p id="Par13">Our approach considers cell-type identity to be defined by context-specific gene expression and within-cell type stochasticity to arise from a combination of technical noise<sup><xref ref-type="bibr" rid="CR53">53</xref>,<xref ref-type="bibr" rid="CR54">54</xref></sup> and biological mechanisms such as transcriptional bursting<sup><xref ref-type="bibr" rid="CR55">55</xref></sup>. These translate into the sparse and heterogeneous expression patterns typically observed in scRNA-seq (Supplementary Fig. <xref rid="MOESM1" ref-type="media">2a</xref>) and result in high variance across all levels of expression (Supplementary Fig. <xref rid="MOESM1" ref-type="media">2b</xref>). Together, these effects mask the co-expression signal in the data and tend to yield low correlation values when using traditional metrics (Fig. <xref rid="Fig2" ref-type="fig">2b</xref>). To overcome this problem, we treat single cells of the same cell-type as biological replicates, that is, instances that represent the state of a delimited cell population, but are differently affected by the aforementioned combination of technical and biological forces. In this context, the expression distribution of any given isoform across the population can be considered to be the signature of the isoform in that cell-type. To translate these assumptions into a metric, the expression of each isoform within a given cell type was first summarized into an expression profile, where single-cell count values were replaced by 10 percentile values (deciles) (Fig. <xref rid="Fig2" ref-type="fig">2b</xref>, “Methods”). Intuitively, this reduced number of values captures the behavior of that transcript in the cell type, as inferred given cell-level observations. Next, to grasp similarities between expression distributions across cell types, pairwise Pearson correlations were computed using percentile-summarized isoform expression, resulting in a more meaningful distribution of correlation values than obtained with traditional metrics (Fig. <xref rid="Fig2" ref-type="fig">2b</xref>). In this manner, we managed to extend the notion of cell-type markers to rely not only on mean or frequency of expression, but on their actual distributional pattern. Our co-expression metric, therefore, by-passes cell-level matching of individual observations, providing a correlation estimate that is both robust to the uncertainty of single cell expression and interpretable as a measure of expression similarity. Remarkably, changing percentile number did not have a noticeable effect on the resulting correlation values, as long as it ranged between 100 and 4 (Supplementary Fig. <xref rid="MOESM1" ref-type="media">2c</xref>). Nevertheless, using 1 percentile (median expression), substantially disrupted the correlation value distribution (Supplementary Fig. <xref rid="MOESM1" ref-type="media">2d</xref>), stressing the importance of selecting a sufficient number of percentiles to avoid over-summarizing isoform expression.</p>
      <p id="Par14">To detect modules of co-expressed isoforms, we used percentile correlations as a distance metric for hierarchical clustering, and designed a semi-automated cluster refinement approach to ensure maximal profile similarity within clustered modules (Fig. <xref rid="Fig2" ref-type="fig">2c</xref>, see “Methods” for a detailed description). First, the <italic>dynamicTreeCut</italic> R package<sup><xref ref-type="bibr" rid="CR56">56</xref></sup> was used to initialize clustering. The dynamic clustering algorithm enables the selection of adaptive thresholds for better detection of clusters within the dendrogram. 166 clusters were obtained as a result. These were then re-clustered to mitigate the presence of highly similar (i.e., redundant) expression profiles (Supplementary Fig. <xref rid="MOESM1" ref-type="media">3a</xref>). To achieve this, cluster <italic>metatranscripts</italic> (i.e., the mean scaled expression of all isoforms in the cluster, see “Methods”) were computed and hierarchical clustering applied, generating 26 clusters. At this point, 2381 isoforms remained unclustered, including isoforms from 3 groups that presented noisy expression profiles (Supplementary Fig. <xref rid="MOESM1" ref-type="media">3b</xref>). These were assigned by maximizing the similarities between cluster and isoform expression profiles, i.e., using the percentile correlation between isoform expression and cluster metatranscripts (see “Methods”). Finally, clusters were merged again to obtain completely unique profiles. Of note, we spotted two pairs of clusters with clearly similar profiles that were not merged metatranscript clustering. To avoid detection of falsely coDIU genes in downstream analysis, these were merged manually. As a result, we generated a total of 15 distinct clusters (Fig. <xref rid="Fig2" ref-type="fig">2d</xref>) containing all initially analyzed isoforms (6794 total) and representing diverse expression modalities across the 7 broad cell types. The different steps in the clustering process are implemented as functions in the <italic>acorde</italic> R package.</p>
    </sec>
    <sec id="Sec5">
      <title>Validation of percentile correlations on simulated data</title>
      <p id="Par15">Building on studies reporting the poor performance of popular correlation metrics in single-cell data, authors have attempted the implementation of sparsity-aware measurements<sup><xref ref-type="bibr" rid="CR52">52</xref>,<xref ref-type="bibr" rid="CR57">57</xref></sup> and reported the potential of other alternatives to compute similarity, such as proportionality metrics<sup><xref ref-type="bibr" rid="CR42">42</xref></sup>. Here, we present an interpretable, scalable and biology-aware alternative to single-cell co-expression studies based on Pearson or Spearman correlation. However, to better understand how percentile correlation performs in comparison to extant correlation metrics, we compared it to Pearson, Spearman and zero-inflated Kendall correlations<sup><xref ref-type="bibr" rid="CR57">57</xref></sup> and one proportionality metric, rho (<italic>ρ</italic>)<sup><xref ref-type="bibr" rid="CR58">58</xref></sup> using simulated data.</p>
      <p id="Par16">Given that there are -to the best of our knowledge- no scRNA-seq data simulators that include transcript co-expression patterns, we designed a simulation strategy (Supplementary Fig. <xref rid="MOESM1" ref-type="media">4</xref>, “Methods”) to generate an appropriate validation framework for our metric. Briefly, we applied <italic>SymSim</italic><sup><xref ref-type="bibr" rid="CR59">59</xref></sup> to simulate a single-cell RNA-seq dataset (8 cell types, 1000 cells and 8000 transcripts, Supplementary Fig. <xref rid="MOESM1" ref-type="media">5a</xref>) and used the simulated expression values to artificially create 3000 synthetic transcripts showing 15 different expression profiles across the 8 cell types (Supplementary Fig. <xref rid="MOESM1" ref-type="media">5b</xref>). As a result, our simulated dataset contained 15 simulated clusters with distinct expression profiles while preserving the original cell type structure generated by <italic>SymSim</italic> (Supplementary Fig. <xref rid="MOESM1" ref-type="media">5a</xref>). Among them, clusters 1–5, 6–10 and 11–15 included transcripts showing high expression in one, two and three cell types, respectively, gradually increasing simulated pattern complexity (Supplementary Fig. <xref rid="MOESM1" ref-type="media">5b, c</xref>). After refinement (Supplementary Fig. <xref rid="MOESM1" ref-type="media">5c</xref>, “Methods”), 1790 synthetic transcripts remained distributed across the 15 simulated clusters in groups ranging from 180 to 60 transcripts (Supplementary Fig. <xref rid="MOESM1" ref-type="media">5d</xref>).</p>
      <p id="Par17">In order to evaluate how well the 5 correlation methods recapitulated the simulated patterns, we computed these metrics for all synthetic transcript pairs in each simulated cluster (Supplementary Fig. <xref rid="MOESM1" ref-type="media">5e</xref>). Among them, percentile correlation consistently yielded the best proportion of high within-cluster correlations followed by <italic>ρ</italic>. However, rather counter-intuitively, <italic>ρ</italic> had only an average performance when low-complexity patterns were provided, with less than 20% output proportionality values &gt;0.8 within clusters 1–5. Shockingly, zero-inflated Kendall correlation, a single cell-tailored metric, failed to recapitulate the simulated co-expression profiles and showed a considerably lower proportion of high correlations within the simulated clusters than Pearson and Spearman correlations. To better assess the ability of each metric to discriminate true from spurious co-expression, pairwise correlations for isoforms within (intra-cluster) and between (inter-cluster) clusters were compared. Even though results showed overall good separation between pairs from the same cluster, percentile correlation was the only metric to provide a complete lack of overlap between inter and intra-cluster correlation distributions (Supplementary Fig. <xref rid="MOESM1" ref-type="media">5f</xref>). As a result of this evaluation, we can confidently assume that percentile correlations are useful to detect co-variation patterns, yielding overall higher correlation values than all other considered metrics (Supplementary Fig. <xref rid="MOESM1" ref-type="media">5E</xref>) and correctly discriminating true correlated and uncorrelated transcript pairs (Supplementary Fig. <xref rid="MOESM1" ref-type="media">5f</xref>). Of note, and similarly to real data, the simulated dataset showed no detectable effect when varying the number of percentiles used to compute percentile correlations (Supplementary Fig. <xref rid="MOESM1" ref-type="media">6</xref>).</p>
      <p id="Par18">Next, we compared the ability of each co-expression metric to inform clustering and group transcripts with similar expression patterns. To achieve this, we run our clustering pipeline on the simulated isoforms using the 5 metrics as distance (Supplementary Figs. <xref rid="MOESM1" ref-type="media">7</xref>–<xref rid="MOESM1" ref-type="media">11</xref>). To enable benchmarking, clustering was automated to generate a total number of 15 calculated clusters (see “Methods”). In order to evaluate which metric worked best to detect co-expressed transcript groups, we considered internal correlations between the transcripts in the calculated clusters. We observed that <italic>ρ</italic> and percentile-generated clusters, unlike the remaining co-expression metrics, presented consistently high levels of internal correlation (Fig. <xref rid="Fig3" ref-type="fig">3a</xref>). Notably, the distribution of correlation values obtained using percentiles was the most robust among the five metrics (Supplementary Fig. <xref rid="MOESM1" ref-type="media">12</xref>). We next assessed how well the clusters generated using each correlation metric (i.e., calculated clusters) recapitulated the simulated clusters. Calculated and simulated clusters were paired based on the similarities between their mean cluster profiles (Supplementary Fig. <xref rid="MOESM1" ref-type="media">13</xref>, “Methods”), and the Jaccard index was computed for each simulated-calculated pair to measure the agreement in transcript assignment (Fig. <xref rid="Fig3" ref-type="fig">3b</xref>). Interestingly, results were highly heterogeneous for most methods: even though a number of simulated co-expression groups were easily detected by most metrics, no method was able to fully recapitulate the simulated clusters, with <italic>ρ</italic> proportionality, Pearson, and percentile correlations being the most accurate (Fig. <xref rid="Fig4" ref-type="fig">4b</xref>). Zero-inflated Kendall and Spearman correlations, on the other hand, showed consistently low agreement with the simulated transcript groups. Finally, we considered the number of transcripts that remained unclustered (Fig. <xref rid="Fig3" ref-type="fig">3c</xref>) before and after re-clustering unassigned transcripts (cluster expansion step, see “Methods”). Pearson correlation provided successful cluster assignment for practically all transcripts in the simulated dataset, especially when incorporating percentiles (Pearson: ~10% unclustered before expansion, ~1% after; percentile: ~4% unclustered before expansion, 0% after), whilst the rest of metrics performed significantly worse, leaving 20–30% of transcripts unassigned even after cluster expansion, with proportionality (~30% unclustered before expansion, ~25% after) being the less optimal. Altogether, even though <italic>ρ</italic> demonstrated good performance in many aspects of clustering, including intra-cluster correlation and agreement with the simulated clustering, it was outperformed by percentile correlation when globally considering all evaluated parameters (Fig. <xref rid="Fig3" ref-type="fig">3d</xref>). In addition to the fact that <italic>ρ</italic> failed to control for unassigned transcripts, computing means and standard deviations of Jaccard indices across simulated-calculated pairs showed percentile and Pearson correlations as the most consistently accurate methods. All in all, our synthetic data evaluations showed that the percentile correlation approach performed well—and more consistently than <italic>ρ</italic> proportionality- in all the evaluated features, and visibly captured co-expression better than both traditional and zero inflation-aware correlation metrics.<fig id="Fig3"><label>Fig. 3</label><caption><title>Comparative evaluation of percentile correlation on simulated clusters.</title><p><bold>a</bold> Proportion of co-expression values above 0.8 in each empirical cluster, obtained after running the <italic>acorde</italic> clustering pipeline on simulated clusters using several correlation and proportionality methods as a distance metric. <bold>b</bold> Jaccard index of simulated vs calculated clusters obtained with each evaluated co-expression method. Simulated clusters were paired with one calculated cluster based on mean profile similarity, and synthetic transcripts in each of the paired clusters were compared. <bold>c</bold> Percentage of unclustered isoforms generated by each co-expression method. Results are shown before and after re-assigning unclustered isoforms by co-expression with the mean profile of extant clusters (i.e., cluster expansion). <bold>d</bold> Evaluation metric overview. Metrics are specified in the grid headers. <italic>x</italic>-axis shows values of the different metrics, <italic>y</italic>-axis displays evaluated co-expression methods.</p></caption><graphic xlink:href="41467_2022_29497_Fig3_HTML" id="d32e812"/></fig><fig id="Fig4"><label>Fig. 4</label><caption><title>Characterization of genes with co-Differential isoform usage.</title><p><bold>a</bold> Cluster-based definition of Differential Isoform Usage (DIU) across multiple cell types. DIU genes have at least two isoforms assigned to different clusters, indicating a differential isoform selection pattern across the different cell types. <bold>b</bold> Definition of co-Differential Isoform Usage (coDIU) using clusters. CoDIU genes have multiple isoforms assigned to the same clusters, establishinig across-cell type co-expression relationships for at least two of their isoforms. <bold>c</bold> coDIU network. Nodes represent clusters and depict their mean expression profile across cell types. Node color represents cluster size (i.e., no. of isoforms in cluster). Edge width represents number of coDIU genes detected between each pair of clusters. coDIU genes are considered if they have at least one significant isoform co-expression pattern with one other gene. <bold>d</bold> Evaluation of cluster profile similarity and size as a function of the number of coDIU genes detected by <italic>acorde</italic>. <italic>X</italic>-axis corresponds to the sum of isoforms in each possible pair of clusters generated from the data. <italic>Y</italic>-axis contains the number of coDIU genes between the pair. Dot color represents the correlation between the mean expression profiles of each pair of clusters. The number of coDIU genes between a pair of clusters is seemingly related to the size of the clusters involved, and shows no relationship with the degree of similarity between the expression profiles of clustered isoforms. <bold>e</bold> Cell type-level coDIU patterns. For each pair of cell types represented in <italic>x</italic> and <italic>y</italic>-axis, heatmap color corresponds to the total number of genes found to be co-DIU between them. Total coDIU genes are calculated as the sum of coDIU genes detected between all cluster pairs that show high expression of isoforms in these cell types. GABA and Glut cell types share the highest number of coDIU genes, both with each other and with other cell types. Astr: astrocytes, End: endothelial cells, GABA: GABA-ergic neurons, Glut: glutamatergic neurons, Micr: microglia, Oligo: oligodendrocytes, OPC: oligodendrocyte precursor cells.</p></caption><graphic xlink:href="41467_2022_29497_Fig4_HTML" id="d32e853"/></fig></p>
    </sec>
    <sec id="Sec6">
      <title>Co-Differential Isoform Usage analysis of single-cell isoform expression</title>
      <p id="Par19">Isoform clusters represent groups of alternative transcripts that are co-expressed at the cell type level. However, our clustering results did not provide information on iso-transcriptome properties associated with splicing regulation. To facilitate interpretation of the isoform clustering results, we first defined genes with DIU as those whose isoforms were assigned to different clusters (Fig. <xref rid="Fig4" ref-type="fig">4a</xref>). ~23% of total analyzed genes (2017 out of 8814) and 75% of genes with clustered isoforms (total = 2696) were positive for DIU, involving 5278 clustered isoforms. In this context, DIU genes will necessarily have two or more isoforms with significant changes in expression across cell types and simultaneously undergo cell type-dependent post-transcriptional regulation, leading to changes in isoform expression in each cell type.</p>
      <p id="Par20">In order to study isoform co-expression patterns, we defined coDIU genes as those showing coordinated cell-type-specific isoform usage. Specifically, we considered two or more genes to be coDIU if their isoforms had been assigned to the same clusters (Fig. <xref rid="Fig4" ref-type="fig">4b</xref>, “Methods”). This resulted in the definition of an isoform co-splicing network, where nodes were clusters of correlated isoforms and edges represented coDIU genes, i.e., the number of genes for which two or more isoforms are co-expressed across cell types (Fig. <xref rid="Fig4" ref-type="fig">4c</xref>, “Methods”). To ensure the reliability of the detected coDIU patterns, a generalized linear model (GLM) was fitted for every pair of coDIU genes; selecting pairs that showed significant cluster-dependent expression variation across cell types and no significant changes in expression when only accounting for gene-level expression (see “Methods”). CoDIU genes therefore present cell type-dependent co-expression of at least two isoforms, represented by cluster assignment matches, but are not co-expressed when only gene expression is considered. Using this strategy, 1784 genes with at least one significant coDIU partner (<italic>cluster*cell-type</italic> FDR &lt; 0.05, <italic>gene</italic>*<italic>cell-type</italic> FDR &gt; 0.05) were detected, involving 5274 co-expressed isoforms. The number of coDIU genes sharing isoforms across each cluster pair was variable, although it rose up to &gt;130 for highly connected clusters (Fig. <xref rid="Fig4" ref-type="fig">4c</xref>).</p>
      <p id="Par21">We then interrogated the coDIU network to find patterns underlying the splicing coordination signal detected by the <italic>acorde</italic> pipeline. First, in order to measure whether coDIU generated strong or subtle variations in isoform selection across cell types, we investigated the association of coDIU to single or multiple cell type isoform switching events. Note that single isoform switching events involve clusters with patterns that are similar across all cell types except one, leading to high between-cluster correlations. Interestingly, we found that the number of coDIU genes linking isoform co-expression clusters was dependent on cluster sizes, but showed no direct relationship with the similarities between expression profiles (Fig. <xref rid="Fig4" ref-type="fig">4d</xref>). The detection of coDIU genes involving isoforms with highly different expression patterns suggested that coordinated isoform usage is able to produce strong cell type-level shifts in isoform selection.</p>
      <p id="Par22">We next evaluated the cell type-level relationships in the isoform co-expression network, namely the occurrence of coDIU across all possible pairs of cell types in our data. Although co-splicing could potentially occur between any combination of cell types, results showed that a high proportion of coDIU interactions were detected when the isoforms involved had high expression in one of the two neural cell types, i.e., GABA-ergic and glutamatergic neurons (Fig. <xref rid="Fig4" ref-type="fig">4e</xref>). This can be partially explained by the fact that some of the clusters with neuron expression are among the largest generated by the <italic>acorde</italic> pipeline (Fig. <xref rid="Fig4" ref-type="fig">4c</xref>). However, another plausible explanation is that the central role of neurons in the tissue under study (i.e., primary visual cortex) might situate co-splicing at the core of neural function regulation, as well as the modulation of its interaction with glial cell types.</p>
    </sec>
    <sec id="Sec7">
      <title>Functional analysis of the coDIU network</title>
      <p id="Par23">We next set out to investigate the functional implications of our isoform co-expression network. Since, with a few exceptions<sup><xref ref-type="bibr" rid="CR60">60</xref>,<xref ref-type="bibr" rid="CR61">61</xref></sup>, splicing analysis tools rarely integrate functional information, we annotated the long read-defined transcripts using IsoAnnotLite (<ext-link ext-link-type="uri" xlink:href="https://isoannot.tappas.org/isoannot-lite/">https://isoannot.tappas.org/isoannot-lite/</ext-link>). The resulting functional annotation included both transcript and protein-level motifs, sites, and domains, as well as non-positional, gene-level features such as Gene Ontology (GO) terms. A detailed description of the annotation process and a comprehensive list of functional categories and source databases are available in <xref rid="MOESM1" ref-type="media">Supplementary Note</xref>.</p>
      <p id="Par24">First, we analyzed which biological processes and gene functions were potentially controlled by DIU (AS-regulated) and coDIU (co-regulated) mechanisms, that is, which gene functionalities were overrepresented in the DIU and coDIU sets. In order to discriminate the functional properties of AS-regulated genes from those showing no cell type specificity in isoform expression, we performed a functional enrichment test for DIU genes vs genes with DE isoforms, which were used as the background (Supplementary Fig. <xref rid="MOESM1" ref-type="media">14</xref>, see “Methods”). Interestingly, DIU genes showed significant enrichment (FDR &lt; 0.05) in GO terms associated with gene expression regulation, including general mechanisms (nucleic acid metabolic process) and processes related to both DNA (DNA metabolic process) and RNA metabolism (RNA metabolism). In addition, genes annotated as participating in protein-complex mechanisms required for these processes (protein-containing complex) were found to be significantly overrepresented in the DIU group. Remarkably, functional enrichment revealed that DIU genes were enriched in binding sites for miR-412-3p. Even though extant literature includes no functional roles for this miRNA in the brain, miR-412-3p has been found to interact with Mbnl1-AS1<sup><xref ref-type="bibr" rid="CR62">62</xref></sup>, a long non-coding RNA that is also an antisense isoform of Mbnl1, which is an important splicing regulator in the neural context<sup><xref ref-type="bibr" rid="CR63">63</xref>–<xref ref-type="bibr" rid="CR65">65</xref></sup>. We speculate that differential inclusion of miR-412-3p binding sites in the isoforms of coDIU genes might be related to additional regulatory roles of this miRNA in neural cell types.</p>
      <p id="Par25">Next, in order to investigate the cellular processes where coDIU could potentially have a relevant regulatory role, we compared the proportion of coDIU and DIU genes annotated for each functional feature in the transcriptome using a partially-overlapping samples z test<sup><xref ref-type="bibr" rid="CR66">66</xref></sup> (see “Methods”). In total, 91 positional functional features and 59 GO terms were found to be annotated in a significantly higher proportion in coDIU vs DIU genes (FDR &lt; 0.05, Supplementary Data <xref rid="MOESM5" ref-type="media">1</xref>). Given the extensive list of significant features obtained, we focused on the most relevant set of features for visualization and interpretation purposes (Fig. <xref rid="Fig5" ref-type="fig">5a, b</xref>). Full results, however, are available in Supplementary Data <xref rid="MOESM5" ref-type="media">1</xref>. First, to remove redundant functionalities, GO terms were filtered by semantic similarity using Revigo<sup><xref ref-type="bibr" rid="CR67">67</xref></sup> (see “Methods”, Fig. <xref rid="Fig5" ref-type="fig">5a</xref>), resulting in 26 unique terms. Among them, and similarly to DIU genes, coDIU genes showed significant enrichment (FDR &lt; 0.05) in functionalities related to specific aspects of transcriptional regulation (regulation of nitrogen compound metabolic process, regulation of transcription by RNA polymerase II, Fig. <xref rid="Fig5" ref-type="fig">5a</xref>, Supplementary Data <xref rid="MOESM5" ref-type="media">1</xref>). However, genes that were positive for coDIU were also significantly associated with signaling mechanisms (protein kinase activity, protein phosphorylation, signal transduction), membrane transport and cell-to-cell communication (transmembrane signaling receptor activity, cell communication, regulation of response to stimulus), and metabolism (carboxylic acid biosynthetic process, cellular macromolecule catabolic process, lipid metabolic process). Remarkably, coDIU genes showed additional enrichment for post-trancriptional processes and functionalities such as RNA binding and translation. This result links genes participating in RNA metabolism with the coordination of AS, and suggests that the co-expression of alternative isoforms may contribute to the fine-tuning of post-transcriptional regulatory processes. Regarding positional functional features, coDIU genes presented a significantly higher proportion of miRNA binding, 3′UTR and upstream Open Reading Frame (uORF) motifs (FDR &lt; 0.05, Fig. <xref rid="Fig5" ref-type="fig">5b</xref>) as well as several predicted protein elements such as post-translational modifications (PTMs), nuclear localization signals (NLS) and transmembrane domains. These motifs and domains exert a broad variety of roles, including interactions with regulators (e.g., 3′UTR motifs), mRNA turnover control (e.g., uORFs), and protein-specific localization (e.g., NLS, transmembrane), indicating the potential of coDIU to create functional synergies via the co-inclusion of specific domains and motifs in an isoform-specific manner.<fig id="Fig5"><label>Fig. 5</label><caption><title>Functional analysis of DIU and coDIU genes.</title><p><bold>a</bold> Gene Ontology (GO) Functional Enrichment results for co-Differential isoform Usage (coDIU) vs genes with Differential Isoform Usage (DIU) of isoforms. Only terms obtained after Revigo filtering are shown. <italic>x</italic> and <italic>y</italic>-axis indicate semantic similarity, as defined by Revigo (see “Methods”). Dot size represents total coDIU genes annotated for each GO term. Dot color represents significance, i.e., −log10(adjusted <italic>p</italic>-value). <bold>b</bold> Functional Enrichment of positional features for coDIU vs DIU genes. <italic>x</italic>-axis indicates the total number of coDIU genes including the tested annotation feature, <italic>y</italic>-axis shows functional features. Dot color represents the functional category (i.e., annotation source database) and dot size represents −log(adjusted <italic>p</italic>-value). <bold>c</bold> Schematic representation of tappAS’ Functional Diversity Analysis (FDA). The genomic position and present/absence criteria, both of which can be used to detect functional variation among isoforms from the same gene (i.e., label the gene as <italic>varying</italic>), are depicted. <bold>d</bold> FDA results for DE isoform, DIU, and coDIU genes. <italic>y</italic>-axis shows transcript and protein functional categories (see <xref rid="MOESM1" ref-type="media">Supplementary Note</xref> for category definition information). <italic>x</italic>-axis shows the percentage of genes including at least one feature annotation from each of the categories that are detected as functionally <italic>varying</italic>. Both FDA criteria are shown (position: left grid column, presence: right grid column). CoDIU genes show the largest level of functional variation.</p></caption><graphic xlink:href="41467_2022_29497_Fig5_HTML" id="d32e1026"/></fig></p>
      <p id="Par26">To further explore the potential of domain-including (or excluding) isoform co-expression across neural cell types, we performed a Functional Diversity Analysis (FDA, Fig. <xref rid="Fig5" ref-type="fig">5c</xref>). FDA is part of the tappAS framework<sup><xref ref-type="bibr" rid="CR61">61</xref></sup>, and identifies functionally <italic>varying</italic> genes, i.e., genes expressing transcript variants with differences in the inclusion of functional features (see “Methods”). FDA can be evaluated from a presence/absence standpoint (i.e., AS completely removes a feature), or by detecting variation in the transcriptomic positions defining the feature (Fig. <xref rid="Fig5" ref-type="fig">5c</xref>). We, therefore, compared the diversity in transcript-level functional features between DIU, coDIU genes, and genes with more than one DE isoform, for all functional categories provided by IsoAnnotLite (Fig. <xref rid="Fig5" ref-type="fig">5d</xref>). Interestingly, we observed that the percentage of <italic>varying</italic> genes increased with isoform expression complexity, with coDIU resulting in the largest amount of feature inclusion diversity in virtually all protein and transcript feature categories. To measure this effect, we compared the percentages of variation for all pairwise combinations of the three gene sets (paired samples t-test, see “Methods”) and confirmed the observed trend, regardless of whether the variability criteria employed (position/presence). In particular, even though nearly all comparisons were significant, coDIU resulted in the most significant increase in feature variation (coDIU vs DE isoform genes <italic>p</italic>-value: presence = 1.14e−03, position = 8.92e−04; coDIU vs DIU genes <italic>p</italic>-value: presence = NS, position = 2.04e−03). We verified that this increase in functional diversity was not associated to expression level or isoform length biases in coDIU genes (Supplementary Fig. <xref rid="MOESM1" ref-type="media">15a, b</xref>). This result suggests that alternative isoforms that engage in co-expression relationships tend to alter their functional properties significantly more often than other transcripts, namely by changing the inclusion of motifs, sites and/or domains, thereby coupling AS and isoform co-expression with functional potential.</p>
    </sec>
    <sec id="Sec8">
      <title>Functional analysis of neuron-oligodendrocyte isoform co-expression</title>
      <p id="Par27">To further understand the relationship between cell-type identity, isoform co-expression, and the functional properties of coDIU genes, we searched the coDIU network for cluster groups representing biologically-related isoform switches between neural cell types. Namely, we focused on a set of 118 coDIU genes (Fig. <xref rid="Fig4" ref-type="fig">4c</xref>) containing isoforms with higher relative expression in oligodendrocytes (cluster 14), neurons (GABA and Glutamatergic neuron cell types, cluster 1) or both (cluster 4, Fig. <xref rid="Fig6" ref-type="fig">6a</xref>) and analyzed isoform-associated functional variability using FDA (Fig. <xref rid="Fig6" ref-type="fig">6b</xref>). For this set of alternative isoforms, 3′UTR length showed the highest variation rate among annotated transcript-level functional categories (<italic>varying</italic> in ~70% genes, Fig. <xref rid="Fig6" ref-type="fig">6b</xref>). Moreover, we noticed that these changes followed a clear cell type-specific pattern, with the majority of coDIU genes showing higher relative expression of their longest 3′UTR isoforms in neurons (Supplementary Fig. <xref rid="MOESM1" ref-type="media">16a</xref>) and neural-specific isoforms generally expressing longer 3′UTRs than their oligodendrocyte-expressed counterparts (Fig. <xref rid="Fig6" ref-type="fig">6c</xref>).<fig id="Fig6"><label>Fig. 6</label><caption><title>Functional analysis of the 118 coDIU genes detected across neural-oligodendrocyte clusters (no. 1, 4, and 14).</title><p><bold>a</bold> Cell type expression patterns of clusters selected for downstream functional analysis: neural (cluster 1, green), oligodendrocyte (cluster 14, orange) or shared (cluster 4, purple). For each cluster, cell-level mean expression (scaled) is computed for all transcripts, and cell means are aggregated to obtain a global cell type mean, represented by the lines. Colored areas correspond to cell type mean ± standard deviation. <bold>b</bold> Functional Diversity Analysis (FDA) results. <italic>y</italic>-axis: functional annotation categories. <italic>x</italic>-axis: percentage of genes including at least one <italic>varying</italic> feature from a given functional category. <bold>c</bold> Violin and boxplots of normalized 3′UTR lengths for isoforms in each of the three neural-oligodendrocyte clusters (<italic>n</italic> = 177 transcript isoforms from coDIU genes with 3′UTR variability). Normalized lengths are computed by dividing each individual isoform’s 3′UTR length by the sum of 3′UTR lengths of all the gene’s isoforms. Violin plots indicate density distributions. For boxplots, boxes indicate median (middle line), 25th (Q1) and 75th (Q3) percentiles (box hinges); whiskers represent min = Q1 − 1.5 · Interquartile Range (IQR) and max = Q3 + 1.5 · IQR; dots constitute outliers. Significance levels for the comparison of the three groups are indicated above the corresponding braces (<italic>p-</italic>value, Wilcoxon’s test, two-sided). NS: not significant. tappAS view of <bold>d</bold>
<italic>Lrif1</italic> and <bold>e</bold>
<italic>Stau2</italic> protein annotations. Cluster assignments for each isoform are indicated by dot color.</p></caption><graphic xlink:href="41467_2022_29497_Fig6_HTML" id="d32e1131"/></fig></p>
      <p id="Par28">Next, we inspected several 3′UTR-related functional categories (repeat regions, miRNA binding, and 3′UTR motifs) using ID-level FDA (see “Methods”, Supplementary Fig. <xref rid="MOESM1" ref-type="media">16b</xref>) to identify specific functional features associated to isoform usage differences between neurons and oligodendrocytes. Regarding the presence of miRNA binding sites, in spite high varyiation rates, no specific miRNA motif was shared by more than ~10% of genes (maximum of 12 out of 118 genes for miR-495-3p), while some repeats, such as (GT)n, were present in ~25% of coDIU genes across the three clusters with varying rates &gt;50%. Nevertheless, in the case of 3′UTR motifs, we found that Musashi binding motifs presented inclusion changes in ~60% of annotated coDIU genes (Supplementary Fig. <xref rid="MOESM1" ref-type="media">16b</xref>). The Musashi protein is known to be a neural RNA-binding protein that participates in translational control, regulating cell fate and cell cycle<sup><xref ref-type="bibr" rid="CR68">68</xref>,<xref ref-type="bibr" rid="CR69">69</xref></sup>. In line with this, the coDIU network included several genes in which 3′UTR elongation led to neuron-specific co-inclusion of Mushashi binding elements, including kinase-encoding genes <italic>Ppip5k1</italic> (diphosphoinositol pentakisphosphate kinase 1, Supplementary Fig. <xref rid="MOESM1" ref-type="media">17a</xref>) and <italic>Prkcz</italic> (protein kinase C zeta type, Supplementary Fig. <xref rid="MOESM1" ref-type="media">17b</xref>). These results align with the previously shown enrichment of signaling and translation-related genes within the coDIU network (Fig. <xref rid="Fig5" ref-type="fig">5a</xref>) and hints that co-expression of Musashi-binding isoforms may generate 3′ UTR binding-mediated changes in the translation of proteins participating in different signaling pathways.</p>
      <p id="Par29">Importantly, the majority of neuron-oligodendrocyte coDIU genes also presented frequent coding region variation (i.e., CDS, Fig. <xref rid="Fig6" ref-type="fig">6b</xref>), revealing that coordinated isoform usage can modify both transcript and protein functional properties. In particular, protein domains (PFAM) and post-translational modifications (PTMs) presented high variation rates (<italic>varying</italic> in ~30% of genes containing the feature, Fig. <xref rid="Fig6" ref-type="fig">6b</xref>) and thus constituted the categories with the most cell type-dependent functional variation. While ID-FDA reported no specific PFAM domains shared among the analyzed gene set (~1%, maximum of 2 out of 118), up to ~10% of them presented inclusion variation in similar PTMs (12 out of 118) with medium to high variation rates for phosphorylation, acetylation and ubiquitination (Supplementary Fig. <xref rid="MOESM1" ref-type="media">16b</xref>). However, synergies between PTM and domain inclusion changes could still result in differential functional activities at the protein level. As an example, we found two genes involved in different aspects of RNA metabolism, <italic>Lrif1</italic> (ligand-dependent nuclear receptor interacting factor, Fig. <xref rid="Fig6" ref-type="fig">6d</xref>) and <italic>Stau2</italic> (Staufen RNA binding protein homolog, Fig. <xref rid="Fig6" ref-type="fig">6e</xref>), both of which present cell type-level domain inclusion associated to coordinated changes in the expression of alternative protein isoforms. In humans, <italic>Lrif1</italic> has been shown to interact with a number of nuclear receptors, including retinoic acid receptors, to suppress the ligand-mediated transcriptional activator role of these proteins<sup><xref ref-type="bibr" rid="CR70">70</xref></sup>. This interaction occurs at the N-terminal end, which presents differential inclusion of several protein motifs and domains among <italic>Lrif1</italic> isoforms. Specifically, two <italic>Lrif1</italic> isoforms that are depleted in oligodendrocytes present inclusion of a coiled/disordered region as well as binding and phosphorylation sites (Fig. <xref rid="Fig6" ref-type="fig">6d</xref>), which may be connected to a specific transcriptional regulation role in mouse neuron cells. Also regarding the neural-related functionality of these genes, the rat homolog of <italic>Stau2</italic> is known to have a role in mRNA transport from the nucleus to neuron dendrites<sup><xref ref-type="bibr" rid="CR71">71</xref></sup>. In our system, <italic>Stau2</italic> isoforms upregulated in oligodendrocytes show a C-terminal Staufen domain that is not included in neural-specific isoforms (Fig. <xref rid="Fig6" ref-type="fig">6e</xref>) and is responsible for Staufen dimerization in humans<sup><xref ref-type="bibr" rid="CR72">72</xref></sup>. On the other hand, one of the neuron-expressed isoforms includes an extra N-terminal RNA binding domain. Differences among <italic>Stau2</italic> isoforms may be connected to a dual role for this protein in neurons and glia in which enhanced RNA binding activity is required in neurons, while Staufen dimers may be more likely to form in oligodendrocytes. However, further analyses and validation experiments are required to confirm these findings and reveal additional coordination of domain inclusion changes for genes involved in differential RNA processing between neurons and glial types.</p>
      <sec id="Sec9">
        <title>Analysis of coDIU in GABA-ergic neuron subtypes</title>
        <p id="Par30">In order to showcase the applicability of the <italic>acorde</italic> pipeline and test its performance under high-granularity conditions, we analyzed isoform expression in the primary visual cortex among 5 GABA-ergic neuron subtypes (Lamp5, Pvalb, Sncg, Sst, Vip, 4921 total cells post-QC) defined in another recent study by Tasic et al.<sup><xref ref-type="bibr" rid="CR44">44</xref></sup> (hereby referred to as Tasic 2018 dataset). Remarkably, quantification of isoform expression using the previously-defined long read transcriptome (see <xref rid="MOESM1" ref-type="media">Supplementary Note</xref>) resulted in no large transcriptomic differences among the subtypes, as revealed by UMAP<sup><xref ref-type="bibr" rid="CR73">73</xref></sup> dimension reduction (Supplementary Fig. <xref rid="MOESM1" ref-type="media">18a</xref>), with Pvalb neurons showing the largest differences with the rest of the cell types. Accordingly, DE analysis between the five groups only returned 568 significantly DE isoforms (FDR &lt; 0.05, fold-change &gt; 1.5, see “Methods”), which make up only ~4% of all isoforms included in the analysis (13870 isoforms remaining post-QC). Using percentile correlations, DE isoforms were grouped in 171 small clusters, which were then merged into 5 distinct expression profiles (Supplementary Fig. <xref rid="MOESM1" ref-type="media">18b</xref>) using dynamic hierarchical clustering (see “Methods”). The largest among the 5 clusters contained those isoforms with higher relative expression in Pvalb neurons (cluster 2, 184 isoforms, Supplementary Fig. <xref rid="MOESM1" ref-type="media">18b</xref>), in agreement with the global data structure (Supplementary Fig. <xref rid="MOESM1" ref-type="media">18a</xref>).</p>
        <p id="Par31">DIU and coDIU relationships encoded by these co-expressed isoform modules were next investigated. We found 22 DIU genes among the 5 clusters, 16 of which presented significant coDIU relationships with at least one other gene (see “Methods”), involving 36 isoforms in total. In line with the clustering and UMAP results (Supplementary Fig. <xref rid="MOESM1" ref-type="media">18a, b</xref>), most isoforms participating in coDIU relationships presented higher relative expression in Pvalb neurons (Supplementary Fig. <xref rid="MOESM1" ref-type="media">18c</xref>). We, therefore, decided to explore the functional features that varied among coDIU genes that had isoforms in the Pvalb expression cluster. Remarkably, two of the detected coDIU genes were membrane-associated proteoglycans <italic>Gpc1</italic> and <italic>Tmeff2</italic>, which have been described to have neuronal function in previous studies<sup><xref ref-type="bibr" rid="CR74">74</xref>,<xref ref-type="bibr" rid="CR75">75</xref></sup>. These genes presented coordinated switches in isoform expression in the Pvalb (cluster 1) and Scng (cluster2) subtypes (Supplementary Fig. <xref rid="MOESM1" ref-type="media">18d</xref>) as well as cell type-specific changes in the functional properties of their isoforms. Namely, <italic>Gpc1</italic> presented Pvalb-specific increase in expression of a signal peptide-including isoform (Supplementary Fig. <xref rid="MOESM1" ref-type="media">18e</xref>). Meanwhile, for <italic>Tmeff2</italic>, Pvalb-expressed isoforms were missing the C-terminal end, which included the transmembrane domain of the protein and several glycosylation sites (Supplementary Fig. <xref rid="MOESM1" ref-type="media">18f</xref>). Even though these -and other similar results shown in this manuscript- would require further validation, they serve to illustrate the potential of <italic>acorde</italic> to uncover candidates for functionally-relevant isoform co-expression relationships.</p>
        <p id="Par32">Of note, the low number of clusters and DIU/coDIU genes detected by the <italic>acorde</italic> pipeline in this dataset, explained by the high isoform expression homogeneity among GABA cell subtypes, precluded the generation of more comprehensive functional results. Even so, we strongly believe that all in all, these analyses demonstrate that <italic>acorde</italic> can be used to study isoform co-expression even in untoward scenarios, making a case for its usability in datasets with less well-defined cell types or lower signal-to-noise ratio.</p>
      </sec>
    </sec>
  </sec>
  <sec id="Sec10" sec-type="discussion">
    <title>Discussion</title>
    <p id="Par33">AS is known to be a tightly-regulated process in which splicing factors interact to create cell-type-specific isoform expression patterns<sup><xref ref-type="bibr" rid="CR76">76</xref></sup>. The transcriptome-level consequences of AS regulation have been studied in different ways, including, but not limited to, the detection of within-isoform coordination of alternative sites<sup><xref ref-type="bibr" rid="CR40">40</xref>,<xref ref-type="bibr" rid="CR41">41</xref></sup>, the generation of gene-isoform networks to uncover regulatory relationships<sup><xref ref-type="bibr" rid="CR77">77</xref>–<xref ref-type="bibr" rid="CR80">80</xref></sup> and the application of single-cell data to unravel cell type-specific expression patterns for same-gene isoforms<sup><xref ref-type="bibr" rid="CR27">27</xref>,<xref ref-type="bibr" rid="CR81">81</xref></sup>. However, the extent to which AS regulation creates co-expression patterns among alternative isoforms from different genes has not yet been fully addressed. Specifically, previous studies tackling this type of isoform co-expression have either focused on specific event types, such as alternative 3′ exons<sup><xref ref-type="bibr" rid="CR82">82</xref></sup>, or solely on the identification of functionally-relevant alternative isoforms in different biological contexts<sup><xref ref-type="bibr" rid="CR83">83</xref>,<xref ref-type="bibr" rid="CR84">84</xref></sup>.</p>
    <p id="Par34">In this study, we presented <italic>acorde</italic>, an end-to-end pipeline to generate isoform co-expression networks and detect genes with coDIU, and applied it to the study of isoform co-expression among seven neural broad cell types<sup><xref ref-type="bibr" rid="CR43">43</xref></sup> and five GABA-ergic neuron subtypes from an independent dataset<sup><xref ref-type="bibr" rid="CR44">44</xref></sup>. To this end, we leveraged single-cell data by implementing percentile correlations, a metric designed to overcome single-cell noise and sparsity and provide high-confidence estimates of isoform-to-isoform correlation. Here, we show that percentile-summarized Pearson correlations outperform both classic and single-cell specific correlation strategies<sup><xref ref-type="bibr" rid="CR57">57</xref></sup>, including proportionality methods that were recently proposed as one of the best alternatives to measure co-expression in single-cell data<sup><xref ref-type="bibr" rid="CR42">42</xref></sup>. In addition, using a long read-defined, functionally annotated transcriptome enabled us to obtain a biological readout from the isoform network. coDIU genes were found to be enriched in the same biological functions, a number of which were unique in comparison to enrichment results for genes solely reported as DIU. Inter-gene isoform co-expression thus appears to impact a subset of DIU genes sharing specific sets of functions, which suggests that coDIU may contribute with an additional layer of complexity to some cellular processes, operating as a fine-tuning mechanism. Our analyses also revealed that isoforms from coDIU genes encompass higher functional diversity than those belonging to DIU genes, an effect that was not associated to expression or length differences. Importantly, these changes impact both transcript and protein isoform functional features, which pinpoints their ability to globally increase the functional repertoire of coDIU genes. Mechanisms generating isoform co-expression can therefore be thought of as a potential source of functional synergies between alternatively spliced genes, giving rise to simultaneous changes in functional properties among co-expressed isoforms.</p>
    <p id="Par35">To demonstrate the power of the <italic>acorde</italic> pipeline, we include examples from both neural datasets where these kinds of coordinated changes were detected. First, we report a neural-specific pattern of 3′UTR co-elongation that is consistent with the available literature<sup><xref ref-type="bibr" rid="CR85">85</xref>,<xref ref-type="bibr" rid="CR86">86</xref></sup> and results in a simultaneous increase in the number of repeats, Musashi binding elements, and miRNA binding sites in these UTRs. In addition, we describe cell-type-specific co-expression of kinase isoforms that creates divergent functional properties among them, which points to a splicing-mediated coordination of signaling pathways. On a broader note, an interesting finding stemming from our functional analyses concerns the diversity of biological properties that make up the functional signal of the coDIU network. Namely, we found coDIU genes to be involved in a wide array of biological processes and showed how joint changes in isoform expression across cell types can result in the differential inclusion of features from a wide variety of functional categories. These diverse, complex results suggest that AS and post-transcriptional regulation mechanisms can modify the presence of a large variety of functional features in co-expressed isoforms, which may potentially contribute to modulate key cell-level processes encoding cell-type identity. While these insights need to be subject to further experimental validation, they serve to illustrate the hypothesis-generating power of our pipeline.</p>
    <p id="Par36">All in all, we have hereby shown that <italic>acorde</italic> can effectively be used to leverage single-cell RNA-seq data to build isoform co-expression networks, providing tools for the exploration of the post-transcriptional regulation of gene expression from an innovative standpoint, including the disclosure of the cellular processes and functional properties impacted by these mechanisms.</p>
  </sec>
  <sec id="Sec11">
    <title>Methods</title>
    <sec id="Sec12">
      <title>Single-cell data pre-processing and quality control</title>
      <p id="Par37">Mouse neural single-cell RNA-Seq data from mouse primary visual cortex was obtained from Tasic et al.<sup><xref ref-type="bibr" rid="CR43">43</xref></sup> and consists in paired-end Illumina reads generated with the Smart-seq2 protocol<sup><xref ref-type="bibr" rid="CR87">87</xref></sup>, which enables isoform-level quantification. Reads were downloaded from Sequence Read Archive accession SRP061902 (<ext-link ext-link-type="uri" xlink:href="https://www.ncbi.nlm.nih.gov/sra?term=SRP061902">https://www.ncbi.nlm.nih.gov/sra?term=SRP061902</ext-link>) and mapped to the mouse genome (GRCm38.p6) using STAR<sup><xref ref-type="bibr" rid="CR88">88</xref></sup>. We performed isoform expression quantification of the long read-defined isoforms (see <xref rid="MOESM1" ref-type="media">Supplementary Note</xref> for details on long read transcriptome definition) using RSEM<sup><xref ref-type="bibr" rid="CR89">89</xref></sup>, and used the labels provided by Tasic et al. to assign the 1679 cells to 7 broad cell types: 5 glial (microglia, endothelial cells, oligodendrocytes, oligodendrocyte precursor cells (OPCs) and astrocytes) and 2 neural (GABA-ergic and glutamatergic neurons).</p>
      <p id="Par38">Isoform length effect on expression was evaluated using the <italic>NOISeq</italic> R package<sup><xref ref-type="bibr" rid="CR90">90</xref></sup>, where mean expression showed to be highly correlated with transcript length (adjusted <italic>R</italic><sup>2</sup> = 0.81; <italic>p</italic>-value = 2.2e−16). Using isoform <italic>i</italic> effective length (<italic>l</italic><sub><italic>i</italic></sub>) and cell-level <italic>j</italic> estimated counts (<italic>c</italic><sub><italic>ij</italic></sub>), both output by RSEM and, after testing several alternatives, we devised a custom formula to minimize the impact of length on isoform expression for each isoform <italic>i</italic>:<disp-formula id="Equ1"><label>1</label><alternatives><tex-math id="M1">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${y}_{{ij}}=\frac{{c}_{{ij}}}{\left({10}^{-6}{\sum }_{i=1}^{I}{c}_{{ij}}\right)\sqrt{{10}^{-3}{l}_{i}}}$$\end{document}</tex-math><mml:math id="M2"><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mfenced close=")" open="("><mml:mrow><mml:msup><mml:mrow><mml:mn>10</mml:mn></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>6</mml:mn></mml:mrow></mml:msup><mml:msubsup><mml:mrow><mml:mo mathsize="big">∑</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>I</mml:mi></mml:mrow></mml:msubsup><mml:msub><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced><mml:msqrt><mml:mrow><mml:msup><mml:mrow><mml:mn>10</mml:mn></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:msup><mml:msub><mml:mrow><mml:mi>l</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msqrt></mml:mrow></mml:mfrac></mml:math><graphic xlink:href="41467_2022_29497_Article_Equ1.gif" position="anchor"/></alternatives></disp-formula></p>
      <p id="Par39">The transformed expression value for isoform <italic>i</italic> in cell <italic>j</italic> (<italic>y</italic><sub><italic>ij</italic></sub>) was again tested for length bias and a low correlation was found (adjusted <italic>R</italic><sup>2</sup> = 0.25; <italic>p</italic>-value = 6.84e−8). Next, we inspected the library size distribution and filtered both high and low-count outliers due to potential premature cell death or library preparation duplets, with a total of 1591 cells passing quality control. Feature-level quality control was performed in a cell type-aware manner, keeping isoforms that showed non-zero expression in at least 25% of one cell type. Out of the 36,986 isoforms and 12,692 genes in the PacBio-defined transcriptome, we retained 16,240 isoforms and 8814 genes for downstream analysis.</p>
    </sec>
    <sec id="Sec13">
      <title>Differential expression (DE) across multiple groups</title>
      <sec id="Sec14">
        <title>Single-cell DE analysis</title>
        <p id="Par40">DE analysis among the 7 cell types was performed by combining ZinBWaVE weights<sup><xref ref-type="bibr" rid="CR48">48</xref></sup> and bulk-designed DE methods edgeR<sup><xref ref-type="bibr" rid="CR50">50</xref></sup> and DESeq2<sup><xref ref-type="bibr" rid="CR49">49</xref></sup> (i.e., using the corresponding R packages), which enable multiple group testing and were among the best-performing methods when combined with the ZinBWaVE method. Briefly, ZinBWaVE calculates cell-level weights for each isoform, effectively downweighting zeros during modeling for DE in single cell data (see van den Berge et al.<sup><xref ref-type="bibr" rid="CR48">48</xref></sup> for details), and hence unlocking bulk RNA-Seq computational methods for single-cell data. Of note, GLM within edgeR and DESeq2 were built and run following the pipeline used by van den Berge et al.<sup><xref ref-type="bibr" rid="CR48">48</xref></sup> to make them suitable for single-cell RNA-seq data, and are implemented in a wrapper function within our R package as described in Eq. <xref rid="Equ2" ref-type="">2</xref>, where <italic>y</italic><sub><italic>ij</italic></sub> is expression of isoform <italic>i</italic> in cell <italic>j</italic>, <italic>T</italic><sub><italic>kj</italic></sub> is a dummy variable which takes value 1 when cell <italic>j</italic> is assigned to cell type <italic>k</italic> (<italic>k</italic> = 1,…,<italic>K</italic>) and 0 otherwise, <italic>β</italic><sub><italic>ki</italic></sub> are the regression coefficients for isoform <italic>i</italic>, <italic>ε</italic><sub><italic>ij</italic></sub> represents the error term, and <italic>h()</italic> is the link function of the GLM (natural logarithm in this case).<disp-formula id="Equ2"><label>2</label><alternatives><tex-math id="M3">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$h\left({y}_{{ij}}\right)={\beta }_{0i}+{\sum }_{k=2}^{K}{\beta }_{{ki}}{T}_{{kj}}+{\varepsilon }_{{ij}}$$\end{document}</tex-math><mml:math id="M4"><mml:mi>h</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msubsup><mml:mrow><mml:mo mathsize="big">∑</mml:mo></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mi>K</mml:mi></mml:mrow></mml:msubsup><mml:msub><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>ε</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:math><graphic xlink:href="41467_2022_29497_Article_Equ2.gif" position="anchor"/></alternatives></disp-formula></p>
        <p id="Par41">DE was defined using a significance threshold of FDR &lt; 0.05 when testing the significance of the model for each isoform <italic>i</italic>, that is, <italic>H</italic><sub><italic>0</italic></sub><italic>: β</italic><sub><italic>2i</italic></sub>
<italic>=… = β</italic><sub><italic>Ki</italic></sub>. Isoforms considered DE were preserved for downstream analysis if detected by at least one of the two methods edgeR or DESeq2, since this indicates a change in expression for any of the cell types considered rather than a flat expression profile.</p>
      </sec>
      <sec id="Sec15">
        <title>Neural cell sampling strategy to select a consensus set of DE isoforms</title>
        <p id="Par42">Prior to DE testing, and to balance sample sizes across cell types, we performed 50 independent runs of random neural cell sampling (without replacement) followed by zero-expression filtering (expression above zero for at least 25% of cells in at least one cell type to control zero abundance among iterations and avoid problems during GLM modeling) and DE testing with edgeR and DESeq2. Specifically, the two neural cell types (GABA-ergic neurons, <italic>n</italic> = 729; glutamatergic neurons, <italic>n</italic> = 711 cells) were downsampled by randomly selecting 45 cells, keeping <italic>N</italic> = 241 cells for multi-group DE testing.</p>
        <p id="Par43">To measure the consistency of each method independently, we calculated the mean and standard deviation of the number of DE isoforms across all same-method sampling runs (<italic>R</italic> = 50). To check the level of within-method agreement, we next considered isoform IDs labeled as DE in each independent method run, and calculated the Jaccard Index (<italic>J</italic><sub><italic>rs</italic></sub>) between DE results of that same method for all possible pairs of random sampling runs <italic>r</italic> and s (<italic>r</italic>,<italic>s</italic> = 1,…,50, <italic>r</italic> &lt; <italic>s</italic>, a total of 1225 comparisons). To summarize this information, we relied on the mean and standard deviation of these two sets of <italic>J</italic><sub><italic>rs</italic></sub> values. Finally, we measured the level of agreement between edgeR and DESeq2 regarding our DE criteria, that is, considering isoforms detected by at least one of the methods to be significantly DE (FDR &lt; 0.05). To achieve this, we calculated the union of DE isoforms between one-to-one pairs of edgeR and DESeq2 runs (<italic>R</italic> = 50), and computed the Jaccard Index between all possible pairwise combination of global DE results, i.e., isoforms detected by at least one method (again, 1225 comparisons).</p>
        <p id="Par44">Using the 50 independent set of DE results, including both edgeR and DESeq2, we set out to define a consensus set of DE isoforms. To maximize sensitivity, we first considered the union of DE isoforms obtained by edgeR and DESeq2 on each of the downsampled versions of the data (<italic>R</italic> = 50), that is, isoforms detected to be significantly DE (FDR &lt; 0.05) by at least one of the applied methods. Among the 50 lists of DE isoforms, those that were significant in at least 50% of the runs were selected. In addition, minor isoforms, i.e., those accumulating less than a 0.1 proportion of the absolute expression of their gene, were filtered. Finally, we retained only isoforms from genes with more than one DE isoform, hence removing cases where no AS-directed, isoform-level co-expression relationships can be established. This sets a general requirement for the entire study, which is that all isoforms retained must have, at all times, at least one same-gene counterpart to establish regulatory relationships that can be based on differential splicing of that gene, given that no AS regulation can be detected if a gene’s total expression is represented by a single isoform.</p>
      </sec>
    </sec>
    <sec id="Sec16">
      <title>Percentile correlation</title>
      <p id="Par45">In order to assess the similarity of isoform expression profiles across cells, a correlation measurement can be used by taking cells as observations. We propose here instead to first summarize the expression within a given cell type with percentiles and then compute the correlation using all cell types and their percentiles as observations, a method that we refer to as “percentile correlation” (see main text Fig. <xref rid="Fig2" ref-type="fig">2a</xref>).</p>
      <p id="Par46">Percentile correlations rely on the assumption that cell-to-cell differences can be mostly attributed to transcriptional stochasticity or technical noise, and that these within-cell type differences have a smaller effect than between-cell type expression differences. However, expression estimates for transcripts within the same cell are biased in different degrees, mostly depending on their expression levels, with lower expression being generally accompanied by higher noise levels<sup><xref ref-type="bibr" rid="CR53">53</xref></sup>. This modifies the extent to which isoforms are affected by noise in each cell and causes strong cell-level effects that prevent the detection of co-expression relationships using solely cell-level measurements. Instead, we set out to target changes in expression across cell groups. We therefore considered isoform expression levels in the different cell types as a range of possible values, defined by the cell-level measurements in the data. In this context, the expression value of an isoform in a cell is used a proxy to infer the underlying distribution of expression values in the cell type, where the shape and width of this distribution will depend on both biological and technical factors.</p>
      <p id="Par47">To translate this into a metric, we first took the expression values of an isoform in each of the cell types and computed a number of percentiles (<italic>p</italic>). We selected <italic>p =</italic> 10 to achieve a good balance between accuracy and computational burden in downstream analysis. As the minimum expression value (percentile 0) was also included, we obtained 11 values representing the expression range within a given cell type. As a result, each isoform will possess a new, recalculated expression vector where the percentile values computed in each cell type will replace cell-level expression estimates. This process was repeated for each isoform. Next, we computed pairwise Pearson correlations between every pair of isoforms, obtaining a percentile correlation matrix <bold>R</bold>. In this context, high correlations will appear if a pair of isoforms shows a similarly broad expression distribution in most cell types, as well as a similar amount of relative expression change between cell types.</p>
    </sec>
    <sec id="Sec17">
      <title>Semi-automated isoform clustering</title>
      <p id="Par48">In order to obtain modules of tightly co-expressed isoforms, we combined the hierarchical clustering algorithm with several rounds of cluster profile refinement (see main text, Fig. <xref rid="Fig2" ref-type="fig">2c</xref>), in order to automate the most intensive steps of clustering while also granting control over the level of aggregation and within-cluster similarity. Clustering and refinement steps can be combined and re-arranged to best capture co-expression patterns within the data, and their parameters can be defined by potential future users to provide maximum flexibility. Functions for clustering and refinement are implemented and documented in the <italic>acorde</italic> R package. Since the package vignette includes code-level details on how these functions work and how were used to generate the results in this manuscript, this section of methods will focus on describing the underlying processes in the package and how they were combined to obtain isoform clusters.</p>
      <sec id="Sec18">
        <title>Dynamic hierarchical clustering</title>
        <p id="Par49">The previously obtained correlation matrix (<bold>R</bold>), where each element <italic>r</italic><sub><italic>ij</italic></sub> represents the Pearson’s correlation coefficient between the percentiles of isoforms (<italic>i</italic>,<italic>j</italic>), was transformed into a distance metric to be used in the hierarchical clustering. As we aimed to cluster positively correlated isoforms given our biological hypothesis, negative correlation values were discarded by replacing them with zero values, and therefore defined the distance between any pair of isoforms <italic>i</italic> and <italic>j</italic> as in Eq. <xref rid="Equ3" ref-type="">3</xref>.<disp-formula id="Equ3"><label>3</label><alternatives><tex-math id="M5">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${d}_{{ij}}=\left\{\begin{array}{c}1-{r}_{{ij}}\;\tt{if}\;\it{r}_{{ij}}\, &gt; \,0\\ 1\;\;\;\;\;\;\;\;\;\tt{if}\;\it{r}_{{ij}} \le 0\end{array}\right\}$$\end{document}</tex-math><mml:math id="M6"><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfenced close="}" open="{"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="center"><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mspace width="0.16em"/><mml:mi>i</mml:mi><mml:mi>f</mml:mi><mml:mspace width="0.16em"/><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mspace width="0.25em"/><mml:mo>&gt;</mml:mo><mml:mspace width="0.25em"/><mml:mn>0</mml:mn></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="center"><mml:mn>1</mml:mn><mml:mspace width="0.16em"/><mml:mspace width="0.16em"/><mml:mspace width="0.16em"/><mml:mspace width="0.16em"/><mml:mspace width="0.16em"/><mml:mspace width="0.16em"/><mml:mspace width="0.16em"/><mml:mspace width="0.16em"/><mml:mspace width="0.16em"/><mml:mi>i</mml:mi><mml:mi>f</mml:mi><mml:mspace width="0.16em"/><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>≤</mml:mo><mml:mn>0</mml:mn></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mfenced></mml:math><graphic xlink:href="41467_2022_29497_Article_Equ3.gif" position="anchor"/></alternatives></disp-formula></p>
        <p id="Par50">Hierarchical cluster analysis was performed using the <italic>hclust()</italic> function in the R <italic>stats</italic> package<sup><xref ref-type="bibr" rid="CR91">91</xref></sup> with the average linkage criterion, and obtained a dendrogram. To obtain clusters, we used the <italic>cutreeHybrid()</italic> function in the <italic>dynamicTreeCut</italic> R package<sup><xref ref-type="bibr" rid="CR56">56</xref></sup> in order to find different thresholds for different branches of the dendrogram tree, instead of using a fixed threshold for the entire dendrogram. The following non-default parameters were provided to the <italic>cutreeHybrid()</italic> function: <italic>deepSplit = 4, pamStage = FALSE, minClusterSize = 20</italic>. Briefly, <italic>deepSplit</italic> ranges between 0 and 4, and provides smaller clusters, more accurate clusters when set to high values. <italic>pamStage</italic> determines whether a second stage of clustering using an algorithm similar to the Partition Around Medoids (PAM) method will be performed after searching the dendrogram for clusters (see Langfelder et al.<sup><xref ref-type="bibr" rid="CR56">56</xref></sup>). As a result of this PAM-like step, no items are left unassigned to clusters, while setting pamStage to FALSE allows unclustered items. Finally, <italic>minClusterSize</italic> determines the minimum size of the produced clusters, and thus passing a higher value to this argument prevents the generation of too many clusters with a very small number of items.</p>
        <p id="Par51">This initial set of clusters is to be used as “hooks” to gather as much expression profile diversity from the data as possible. Importantly, even though our parametrization allows isoforms to remain unassigned to clusters (see above), some isoforms may still show low similarity to their cluster’s profile. To be able to obtain profiles as consistent as possible for downstream refinement, a cluster quality control step was included in <italic>acorde</italic> to remove isoforms based on a minimum correlation threshold with the rest of the members. For our study, isoforms were moved to the unclustered group if they showed a correlation lower than 0.85 with 3 or more isoforms from their cluster. In this manner, only tightly-correlated groups of isoforms will remain clustered.</p>
      </sec>
      <sec id="Sec19">
        <title>Expanding clusters with unassigned isoforms</title>
        <p id="Par52">To re-assign unclustered isoforms to clusters with which they show high correlation, <italic>acorde</italic> allows correlation-based cluster expansion. In this process, each cluster profile is summarized into an average representative transcript, hereby referred to as “metatranscript”. Metatranscripts are calculated as the mean of the percentile-based expression of all isoforms in the cluster. As a result, 11·<italic>K</italic> (<italic>K</italic> being the number of cell types) mean-summarized percentile expression values are obtained, which can be understood as an approximation to the expression range shown by the isoforms from that cluster in each of the cell types. Next, correlations between metatranscripts and unclustered isoforms are computed and unclustered isoforms assigned if they show percentile correlation values above a specified threshold with at least one cluster. In the present study, we set a correlation threshold of 0.9 with at least one cluster, where the maximally correlated cluster was selected as the best match if there were ties.</p>
      </sec>
      <sec id="Sec20">
        <title>Merging clusters by profile similarity</title>
        <p id="Par53">Prioritizing the reduction of within-cluster variability may lead to obtaining a large number of small, redundant clusters (Supplementary Fig. <xref rid="MOESM1" ref-type="media">3a</xref>). To mitigate this effect while also preserving high correlations between cluster members, <italic>acorde</italic> can be used to merge clusters by profile similarity using the percentile correlations between their metatranscripts. For this study, hierarchical clustering was performed on the metatranscript correlation matrix via the <italic>hclust()</italic> function (<italic>stats</italic> R package), subsequently creating clusters with the <italic>cutree()</italic> function (<italic>stats</italic> R package) and a height cutoff of 0.1. Since this merging process may result in joining clusters with highly uncorrelated profiles (Supplementary Fig. <xref rid="MOESM1" ref-type="media">3b</xref>), the cluster expansion process described above was used for the re-assignment of isoforms from clusters that were flagged as inconsistent.</p>
      </sec>
      <sec id="Sec21">
        <title>Recursive assignment of remaining unclustered isoforms</title>
        <p id="Par54">First, extant clusters were filtered again to maximize similarities between members of the same isoform group and generate reliable profiles for expansion. In this case, isoforms were returned to the unclustered group if they had percentile correlation lower than 0.7 with 10 or more isoforms of their cluster. Next, and following the cluster expansion process described above, percentile correlations between the isoforms to be assigned and cluster metatranscripts were computed. In this case, however, assignment was performed as a recursive process, in which (1) isoforms joined a cluster based on percentile correlation with its metatranscript, (2) metatranscripts were re-calculated for the newly expanded clusters, and (3) assignment was performed again for the remaining unclustered isoforms. The percentile correlation thresholds was sequentially lowered from 0.9 to 0.8 and 0.7. Finally, any isoforms remaining unclustered at this point were assigned to the clusters with which they presented maximum correlation. In doing this, unclustered isoform groups were assigned in order, and highly correlated elements therefore contributed to strengthen within-cluster similarities before assigning more lowly correlated elements.</p>
        <p id="Par55">Finally, expanded clusters were merged again to remove remaining redundancies and generate larger clusters for coDIU detection. The strategy and parameters used were similar to those detailed in the section above.</p>
      </sec>
    </sec>
    <sec id="Sec22">
      <title>Co-expression pattern simulation</title>
      <p id="Par56">To validate percentile correlations and our clustering strategy, we evaluated their performance on synthetic data, where co-expression relationships between simulated features need to be pre-defined as part of the data simulation process. However, there is, to the best of our knowledge, no currently available strategy to simulate single-cell data including modules of co-expressed features. We therefore designed our own simulation strategy by combining the <italic>SymSim</italic> R package<sup><xref ref-type="bibr" rid="CR59">59</xref></sup> to adequately model single-cell RNA-Seq data, and a dedicated strategy to generate co-expression between <italic>SymSim</italic> simulated features.</p>
      <p id="Par57">First, we set the following parameters to the <italic>SimulateTrueCounts()</italic> function in <italic>SymSim</italic> in order to obtain a count matrix consisting in 1000 cells from 8 cell types and 8000 features, with sufficient feature-level variation between the different cell groups:</p>
      <p id="Par58"><italic>SimulateTrueCounts(ncells_total = 1000, min_popsize = 100, i_minpop = 1, ngenes = 8000, nevf = 10, n_de_evf = 9, evf_type = “discrete”, phyla = pbtree(n = 7, type = “discrete), vary = “s”, Sigma = 0.25, gene_effect_prob = 0.5, bimod = 0.4, prop_hge = 0.03, mean_hge = 5)</italic>.</p>
      <p id="Par59">Next, we modeled technical effects on these true counts in order to obtain real, observed counts using the <italic>True2ObservedCounts()</italic> function in <italic>SymSim</italic>, with the following parameters:</p>
      <p id="Par60"><italic>True2ObservedCounts(true_counts$counts, meta_cell = true_counts$cell_meta, protocol = “nonUMI”, alpha_mean = 0.1, alpha_sd = 0.005, lenslope = 0, gene_len = rep(1000, nrow(true_counts$counts)), depth_mean = 4e6, depth_sd = 1e4)</italic>.</p>
      <p id="Par61">To create co-expression patterns, we then re-ranked expression values on a cell type-specific manner to define synthetic features, based on the expression profile of 15 pre-defined co-expression modules.</p>
      <p id="Par62">First, we drafted 15 different co-expression profiles reflecting three levels of expression complexity, that is, showing high expression or expression “peaks” in one, two, or three cell groups, respectively. To generate a count matrix reflecting these expression patterns, we shuffled simulated counts to create new, synthetic features. To achieve this, we first re-ranked features in each cell group by mean expression across cells in the group, breaking feature connectivity between the simulated cell types. Then, the top 1400 features from each cell type were selected, together with the bottom 1400 features. In this manner, we obtained high-expression and low-expression count vectors for each group, which we then combined to create synthetic features following the pre-designed cluster’s co-expression pattern. For each cluster, 200 count vectors from top-expression features were assigned to peaking groups, and 200 count vectors form bottom-expression features to cell groups showing low expression. Of note, 1400 features were selected for simulation in order to grant at least 7 different 200-feature groups could be generated for each cell type, where the cell group with the highest-peaking frequency across clusters showed high expression in 6 clusters only.</p>
      <p id="Par63">All in all, we obtained a simulated count matrix containing 1000 cells from 8 cell types and 3000 synthetic features, all of which belong to one of the 15 simulated co-expression modules. Therefore, by breaking feature-level connectivity between cell types, we benefited from feature-specific properties at the cell type level, while re-creating cell type expression coordination patterns that the SymSim strategy was not able to generate. Finally, to ensure the quality of the simulated clusters, we filtered synthetic features if their Pearson correlation with the cluster’s median profile was below 0.75 (Supplementary Fig. <xref rid="MOESM1" ref-type="media">4b</xref>).</p>
    </sec>
    <sec id="Sec23">
      <title>Benchmarking of isoform correlation metrics for scRNA-seq data</title>
      <p id="Par64">Traditional correlation metrics have been shown to perform poorly when applied to scRNA-seq data, mainly given the increased noise and stochasticity levels in this data type. Recently, extensive benchmarks including single cell-tailored metrics have shed light on how to best select correlation metrics for single-cell data (see review by Skinnider et al.<sup><xref ref-type="bibr" rid="CR42">42</xref></sup>). We, therefore, compared the performance of percentile correlations to a representative set of correlation metrics used in single-cell co-expression studies, namely classical Pearson and Spearman correlations, single-cell designed zero-inflated Kendall<sup><xref ref-type="bibr" rid="CR57">57</xref></sup> correlation, and proportionality metric rho (<italic>ρ</italic>)<sup><xref ref-type="bibr" rid="CR58">58</xref></sup>, in agreement with previous reports showing that proportionality metrics were among the best performing co-expression methods in single-cell data. To measure performance, we computed these five co-expression metrics for all the synthetic features in the previously-simulated dataset, generating five different distance matrices for clustering, and evaluated which metric best recapitulated the simulated co-expression modules when used in our clustering pipeline. Pearson and Spearman correlations were computed using the <italic>cor()</italic> function in the R-base <italic>stats</italic> package. Zero-inflated Kendall correlation and rho (<italic>ρ</italic>) were computed using the <italic>dismay()</italic> function in the <italic>dismay</italic> R package<sup><xref ref-type="bibr" rid="CR42">42</xref></sup>.</p>
      <p id="Par65">To make our benchmarking comparable, we adapted our clustering pipeline to remove all non-automated steps and always generate a fixed number of clusters. First, hierarchical clustering was performed on each correlation matrix using <italic>dynamicTreeCut()</italic><sup><xref ref-type="bibr" rid="CR56">56</xref></sup> and the following non-default parameters to maximize granularity: <italic>deepSplit = 4, pamStage = FALSE, minClusterSize = 10</italic>. Of note, we skipped the quality filtering step based on intra-cluster correlations (see isoform clustering section above) to avoid bias against metrics that tend to yield low values when applied to single-cell data. Since we intended to evaluate the number of features remaining unclustered using each metric, we additionally suppressed the unclustered isoform assignment step (see isoform clustering section above). Finally, the merge process was automated by using the traditional hierarchical clustering algorithm (implemented in the <italic>hclust()</italic> function in the R stats package) to group clusters based on the inferred metatranscripts that summarize the cluster’s expression profile (see isoform clustering section above). Finally, we set the number of clusters to 15, i.e., the number of simulated co-expression modules.</p>
      <p id="Par66">In addition to the number of unclustered isoforms, we used the levels of internal correlation in the empirical clusters, i.e., those obtained by de novo clustering of simulated synthetic features, to evaluate the clustering. We did this by jointly considering all pairwise metric values for features within a cluster and measuring the percentage of metrics that are above a threshold value of 0.8. To assess how well empirical clusters recapitulated the co-expression simulation, we paired empirical with simulated clusters using the correlations between their mean cluster profiles. Simulated clusters were therefore paired with the empirical clustering showing maximum profile correlation. We next compared synthetic feature IDs assigned to the obtained and empirical clusters in each pair using the Jaccard Index (JI).</p>
    </sec>
    <sec id="Sec24">
      <title>Differential isoform usage and co-Differential isoform usage across multiple groups</title>
      <sec id="Sec25">
        <title>Defining DIU across multiple groups</title>
        <p id="Par67">Grouping isoforms into different clusters allows the detection of a number of expression patterns across the multiple cell types included in single-cell data. As previously described, we filtered DE isoforms to ensure that all transcripts had at least one other counterpart from the same gene that was also significantly DE. Intuitively, in order for Differential Isoform Usage (DIU) to occur, a gene must first have at least two DE isoforms. However, we only considered a gene to be positive for DIU if (at least) two isoforms were DE and were assigned to different clusters, indicating that two of the gene’s isoforms show different expression patterns across groups (see main text, Fig. <xref rid="Fig4" ref-type="fig">4a</xref>). Ultimately, this can be interpreted as an indicator that isoform expression regulation is cell type-dependent in that gene.</p>
      </sec>
      <sec id="Sec26">
        <title>Detecting co-splicing patterns across isoform clusters: co-Differential isoform usage</title>
        <p id="Par68">We define coordinated splicing patterns as a situation where post-transcriptional regulation, defined by isoform expression, can be detected independently of transcriptional regulation, i.e., gene-level expression. To detect splicing coordination, we defined coDIU as a pattern where a group of genes shows co-expression of their isoforms, but no co-expression can be detected when only gene expression is considered (see main text, Fig. <xref rid="Fig4" ref-type="fig">4b</xref>). In the context of our pipeline, a set of potentially coDIU genes will have at least two of their isoforms assigned to the same clusters, therefore showing detectable isoform-level co-expression, and suggesting coordinated splicing regulation in that group of genes. However, clustering allows expression pattern variability among members, and therefore some isoforms might be assigned to clusters that do not faithfully represent their expression profile, leading to the detection of false-positive coDIU genes.</p>
        <p id="Par69">To identify groups of genes candidates for coDIU, we applied negative-binomial generalized linear regression models. Let <italic>G</italic> be a group of genes, each of them with <italic>I</italic><sub><italic>g</italic></sub> isoforms, where <italic>g</italic> = 1,…,|<italic>G</italic>|. At least one of the isoforms of each gene <italic>g</italic> in <italic>G</italic> must belong to the same cluster <italic>c</italic>, where <italic>c∈</italic> {1,…,<italic>C</italic>} and <italic>C</italic> is the total number of clusters. Let <bold>z</bold> be the expression vector obtained after concatenating the expression vectors <bold>y</bold><sub><bold>i</bold></sub> of each isoform <italic>i</italic> of every gene <italic>g</italic> = 1,…,|<italic>G</italic>|. For the sake of simplicity, let us assume that |<italic>G</italic>| = 2, <italic>I</italic><sub><italic>g</italic></sub> = 2 <italic>∀g</italic>, and consequently <italic>C</italic> = 2. In this case, vector <bold>z</bold> will contain 4<italic>N</italic> elements, where <italic>N</italic> is the total number of cells in the data (<italic>N</italic> = 1591 in our data) and will be the response variable in our regression model. We need to assess if <bold>z</bold> values follow the trend depicted in Fig. <xref rid="Fig4" ref-type="fig">4b</xref>, that is, the average profile across cell types of the two isoforms in cluster 1 must be significantly different to the average profile of the two isoforms in cluster 2. In addition, the average profile of the two isoforms of gene 1 must not be different to the average profile of the two isoforms of gene 2. To identify groups of genes with these characteristics we proposed to fit the regression model in Eq. <xref rid="Equ4" ref-type="">4</xref> and select the group of tested genes as coDIU candidates when having a significant interaction between cluster and cell type effects, and a non-significant interaction between gene and cell type effects.<disp-formula id="Equ4"><label>4</label><alternatives><tex-math id="M7">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$h\left(z\right) = \,	{\beta }_{0}+{\beta }_{1}{G}_{2}+{\beta }_{2}{C}_{2}+{\sum }_{k=2}^{K}{\gamma }_{k}{T}_{k}+{\beta }_{3}{G}_{2}{C}_{2} \\ 	 +{\sum }_{k=2}^{K}{\delta }_{k}{T}_{k}{G}_{2}+{\sum }_{k=2}^{K}{\tau }_{k}{T}_{k}{C}_{2}+\varepsilon$$\end{document}</tex-math><mml:math id="M8"><mml:mi>h</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:mi>z</mml:mi></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:mspace width="0.25em"/><mml:msub><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>G</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msubsup><mml:mrow><mml:mo mathsize="big">∑</mml:mo></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mi>K</mml:mi></mml:mrow></mml:msubsup><mml:msub><mml:mrow><mml:mi>γ</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:mn>3</mml:mn></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>G</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msubsup><mml:mrow><mml:mo mathsize="big">∑</mml:mo></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mi>K</mml:mi></mml:mrow></mml:msubsup><mml:msub><mml:mrow><mml:mi>δ</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>G</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msubsup><mml:mrow><mml:mo mathsize="big">∑</mml:mo></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mi>K</mml:mi></mml:mrow></mml:msubsup><mml:msub><mml:mrow><mml:mi>τ</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mi>ε</mml:mi></mml:math><graphic xlink:href="41467_2022_29497_Article_Equ4.gif" position="anchor"/></alternatives></disp-formula>Where <italic>G</italic><sub><italic>2</italic></sub> and <italic>C</italic><sub><italic>2</italic></sub> are dummy variables indicating whether the expression value corresponds to gene or cluster 2 (value 1) or 1 (value 0), respectively, <italic>T</italic><sub><italic>k</italic></sub> is a dummy variable which takes value 1 when the corresponding cell is assigned to cell type <italic>k</italic> (<italic>k</italic> = 1,…,<italic>K</italic>) and 0 otherwis<italic>e, β</italic><sub><italic>k</italic></sub><italic>, γ</italic><sub><italic>k</italic></sub><italic>, δ</italic><sub><italic>k</italic></sub> and <italic>τ</italic><sub><italic>k</italic></sub> are the regression coefficients, <italic>ε</italic> represents the error term, and <italic>h()</italic> is the link function of the GLM (natural logarithm in this case).</p>
        <p id="Par70">We fitted the GLM model with the glm() function in the R-base package, and the <italic>negative.binomial()</italic> function in the <italic>MASS</italic> R package<sup><xref ref-type="bibr" rid="CR92">92</xref></sup>, with θ = 10. To test the significance level of the <italic>cluster*cell type</italic> and <italic>gene*cell type</italic> interactions, we calculated type-II analysis-of-variance (ANOVA) tables for the model using a likelihood-ratio Χ<sup>2</sup> test, implemented in the <italic>Anova()</italic> function from the <italic>car</italic> R package<sup><xref ref-type="bibr" rid="CR93">93</xref></sup>, since we had an unbalanced design. <italic>P</italic>-values for each of the interactions were separately adjusted using the Benjamini &amp; Hochberg correction. Gene pairs were considered positive for coDIU if FDR adjusted <italic>p-</italic>value &lt; 0.05 for the <italic>cluster*cell type</italic> interaction and FDR adjusted <italic>p-</italic>value &gt; 0.05 for the <italic>gene*cell type</italic> interaction. In other words, we required expression variance across cell types to be a function of the expression profile captured by the clustering, while imposing the additional limitation that aggregating expression by gene must make this effect undetectable. Given that all genes with clustered isoforms will form pairs with all potentially coDIU counterparts and be repeatedly tested, we considered genes to be positive for coDIU if they met the significance criteria in at least one of these pairwise tests.</p>
      </sec>
    </sec>
    <sec id="Sec27">
      <title>Functional analyses</title>
      <p id="Par71">The analyses in this manuscript are based on a long read-defined transcriptome which, after careful quality control and curation of the isoform models, was further annotated using IsoAnnotLite (<ext-link ext-link-type="uri" xlink:href="https://isoannot.tappas.org/isoannot-lite/">https://isoannot.tappas.org/isoannot-lite/</ext-link>) to include positionally-defined functional features in the annotation (see <xref rid="MOESM1" ref-type="media">Supplementary Note</xref>). <italic>Functional features</italic> are grouped in <italic>functional categories</italic> depending on the database from which the information was retrieved and on the biological functions performed by the features (comprehensive list in <xref rid="MOESM1" ref-type="media">Supplementary Note</xref>). In this manner, we gathered sufficient information to couple our co-expression analyses with a biological readout. The specific analysis strategies used to this end are detailed below.</p>
      <sec id="Sec28">
        <title>Functional enrichment analysis</title>
        <p id="Par72">In order to understand the functional properties of AS-regulated and co-regulated genes, we set out to characterize DIU and coDIU genes using different functional enrichment analysis approaches. In this manner, we intended to gain insight on functional features and categories showing significant overrepresentation in each of these two gene lists, in comparison to different backgrounds, i.e., lists of genes to compare to in order to detect enrichment.</p>
        <p id="Par73">In the case of DIU genes, we calculated enrichment relative to genes with multiple DE isoforms in order to discriminate the functional properties of genes regulated by AS, as opposed to those lacking differential usage of their isoforms. We considered all annotated functional categories and features, and applied tappAS Functional Enrichment Analysis (FEA), which relies on the <italic>GOSeq</italic> R package<sup><xref ref-type="bibr" rid="CR94">94</xref></sup>. Briefly, the method performs an over-representation Fisher’s Exact test for each functional feature, considering the number of genes annotated with the feature in the tests and background lists. tappAS next corrects for multiple testing within each functional category by the Benjamini-Hochberg method, allowing multiple functional databases to be included or excluded from the analysis without influencing the number of significant features after <italic>p</italic>-value adjustment. Significant enrichment for the different tests was defined using a threshold of FDR &lt; 0.05.</p>
        <p id="Par74">For coDIU genes, we designed a different strategy in order to improve the statistical power of our functional enrichment analysis, aiming to compare functional properties between splicing regulation (DIU) and co-regulation (coDIU). As stated above, DIU regulation is best measured by using genes with DE isoforms as background. Intuitively, coDIU-regulated genes should then be characterized by comparing them to DIU genes. To accommodate these two test/background lists in a functional enrichment analysis without ignoring the overlap between the coDIU and DIU gene groups, we computed enrichment using a partially overlapping samples z-test via the <italic>Prop.test()</italic> function in the <italic>Partiallyoverlapping</italic> R package<sup><xref ref-type="bibr" rid="CR66">66</xref></sup>. Specifically, we compared the proportion of coDIU genes containing each of the functional features (relative to DIU genes) with the proportion of DIU genes containing that same annotation (with respect to genes with DE isoforms). In other words, we tested whether the proportion of coDIU vs DIU genes including a given functional feature was significantly higher than that shown in the comparison between DIU and DE genes. We performed the analysis for features with more than 15 annotated genes, and subsequently corrected for multiple testing within functional categories using the Benjamini-Hochberg method. For GO terms, ontologies with more than 150 annotated genes were also removed to eliminate excessively broad—and potentially less meaningful- functions. Functional features were considered to be present in a significantly higher proportion in coDIU genes when FDR &lt; 0.05.</p>
        <p id="Par75">Annotations used in all functional analyses included Gene Ontology (GO) terms. The hierarchical structure of the Gene Ontology database can often result in multiple significantly enriched terms that refer to the same, or very similar, functions, components, and processes. To enhance visualization and result interpretation of coDIU functional enrichment results, we used Revigo<sup><xref ref-type="bibr" rid="CR67">67</xref></sup> to perform a semantic similarity analysis of all significant GO terms obtained in the partially overlapping samples test. We applied a dispensability (i.e., measure of semantic similarity) threshold of 0.5 to assign GO terms to a cluster, and then selected a representative of each term cluster to include in visualization.</p>
      </sec>
      <sec id="Sec29">
        <title>Functional diversity analysis</title>
        <p id="Par76">To obtain insight into the functional changes generated as a consequence of DIU and coDIU, we again used the tappAS tool for the functional analysis of AS<sup><xref ref-type="bibr" rid="CR61">61</xref></sup>. In particular, we first applied tappAS’ Functional Diversity Analysis (FDA) module (see main text Fig. <xref rid="Fig5" ref-type="fig">5c</xref>). Briefly, FDA performs a within-gene comparison of all the isoforms included in the analysis, aiming to detect whether they present variation in the inclusion of a functional feature. In FDA, variation can be positional, i.e., one or more of the gene’s isoforms present a change in the genomic coordinates defining the feature, or be defined by presence/absence, i.e., at least one of the isoforms lacks a feature that is present in the rest. As a result, FDA provides analyzed genes with a label for each of the feature categories included in the transcriptome’s functional annotation file, flagging them as <italic>varying</italic> if at least one of the isoforms presents the variation in a feature from that category, or <italic>not varying</italic> if no changes are detected. For more details on FDA, see the Methods section in de la Fuente et al.<sup><xref ref-type="bibr" rid="CR61">61</xref></sup>.</p>
        <p id="Par77">We run both positional and presence/absence FDA for three gene sets: (1) genes with multiple DE isoforms, (2) DIU genes, and (3) coDIU genes. Next, for each of these gene sets, we computed the proportion of <italic>varying</italic> genes detected for each functional category. <italic>Varying</italic> proportions were calculated relative to the total number of genes including annotations from the category, instead of considering all genes in the set. In this manner, we avoided underestimating variation rates for categories that were less represented in the functional annotation file. In order to check whether any of these gene sets presented a significantly higher mean proportion of <italic>varying</italic> genes across categories, we performed a paired <italic>t</italic>-test for each combination of gene set pairs: DIU vs multiple DE, coDIU vs multiple DE, and coDIU vs DIU. In this analysis, we considered functional categories to be the individuals under evaluation, while the proportion of <italic>varying</italic> genes calculated for each category in the two tested sets constituted the paired observations. As a result, we obtained three <italic>p</italic>-values per FDA analysis type, i.e., presence/absence and positional variation.</p>
        <p id="Par78">To better understand the functional readout that can be obtained using the <italic>acorde</italic> pipeline, we analyzed a subset of the coDIU gene network, namely three clusters showing related isoform co-expression patterns: neuron-specific expression (cluster 1), oligodendrocyte-specific expression (cluster 14) and expression in both neural and oligodendrocyte cell types (cluster 4). To characterize functional variation among the clusters, we used positional/presence FDA (see above) and ID-level FDA. ID-level FDA is also included in tappAS<sup><xref ref-type="bibr" rid="CR61">61</xref></sup> and provides a within-feature summary of FDA results. In other words, ID-level FDA ultimately reports the number of <italic>varying</italic> and <italic>not varying</italic> genes detected for each feature ID included in a given functional category. In this case, <italic>varying</italic> status obeys a similar criterion to the one described above, i.e., genes in which at least one isoform shows differential inclusion/exclusion of the feature. Since each functional category may include several features, ID-level FDA provides a complementary view to that of FDA, allowing users to inspect which particular features are more frequently changing as a result of the category-level functional variation reported in FDA. For more details on ID-level FDA, see the Methods section in de la Fuente et al.<sup><xref ref-type="bibr" rid="CR61">61</xref></sup>.</p>
      </sec>
    </sec>
    <sec id="Sec30">
      <title>Analysis of GABA-ergic neuron subtypes</title>
      <p id="Par79">To illustrate the applicability of the <italic>acorde</italic> approach, we retrieved additional single-cell RNA-Seq data from a second study by Tasic et al.<sup><xref ref-type="bibr" rid="CR44">44</xref></sup>. Single-cell libraries belonging to GABA-ergic neuron cell subtypes from primary visual cortex were retrieved from SRA accession SRP150473 (<ext-link ext-link-type="uri" xlink:href="https://www.ncbi.nlm.nih.gov/sra/?term=SRP150473">https://www.ncbi.nlm.nih.gov/sra/?term=SRP150473</ext-link>) using the cell identity information in GEO accession GSE115746 (<ext-link ext-link-type="uri" xlink:href="https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE115746">https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE115746</ext-link>), i.e., 6147 cells and 7 cell subtypes in total.</p>
      <p id="Par80">Cell-level isoform expression estimates were obtained with Kallisto<sup><xref ref-type="bibr" rid="CR95">95</xref></sup> using our long read-generated neural transcriptome (see <xref rid="MOESM1" ref-type="media">Supplementary Note</xref>). Cell clusters and the cell subtype labels assigned to them by authors in the original study were retrieved and used in the analysis. After quality filtering of cells (1.25e6 &lt; total counts &lt; 2.75e6) and lowly expressed isoforms (counts &gt; 0 in at least 25% of one cell type), we additionally removed isoforms that did not accumulate more than 10% of their gene’s expression in at least one cell type. Cells belonging to cell types <italic>Meis2</italic> (<italic>n</italic> = 43) and <italic>Serpinf1</italic> (<italic>n</italic>
<italic>=</italic> 22) were discarded to balance cell type abundances, as the remaining cell types had ~1000 cells each. Differentially Expressed (DE) isoforms were next computed by combining ZinBWAvE weights<sup><xref ref-type="bibr" rid="CR48">48</xref></sup> (see prior DE section) and DE testing using edgeR<sup><xref ref-type="bibr" rid="CR50">50</xref></sup>. Isoforms with FDR &lt; 0.05 and fold-change &gt; 1.5 between at least one pair of cell types were selected for downstream analysis. After computing percentile correlations with <italic>p</italic> = 10, DE isoforms were clustered using dynamic hierarchical clustering with the following non-default parameters for the <italic>cutreeHybrid()</italic> function in the <italic>dynamicTreeCut</italic> R package:<sup><xref ref-type="bibr" rid="CR56">56</xref></sup>
<italic>deepSplit = 4, pamStage = FALSE, minClusterSize = 2, cutHeight = 0.1</italic>. Parameters were fine-tuned to generate a high number of clusters with as accurate a profile as possible. Unclustered isoforms (34 isoforms in total) were assigned to clusters using the percentile correlation with cluster metatranscripts and successively decreasing thresholds (see section on cluster expansion above). Expanded clusters were then merged by dynamic clustering of their metatranscripts (see Methods section on merging clusters) using the following non-default parameters for the <italic>cutreeHybrid()</italic> function: <italic>pamStage = FALSE, cutHeight = 0.3</italic>. Detection of DIU and coDIU genes was performed as described in the relevant Methods sections.</p>
    </sec>
    <sec id="Sec31">
      <title>Reporting summary</title>
      <p id="Par81">Further information on research design is available in the <xref rid="MOESM2" ref-type="media">Nature Research Reporting Summary</xref> linked to this article.</p>
    </sec>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary information</title>
    <sec id="Sec32">
      <p>
        <supplementary-material content-type="local-data" id="MOESM1">
          <media xlink:href="41467_2022_29497_MOESM1_ESM.pdf">
            <caption>
              <p>Supplementary Information</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM2">
          <media xlink:href="41467_2022_29497_MOESM2_ESM.pdf">
            <caption>
              <p>Reporting Summary</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM3">
          <media xlink:href="41467_2022_29497_MOESM3_ESM.pdf">
            <caption>
              <p>Peer Review File</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM4">
          <media xlink:href="41467_2022_29497_MOESM4_ESM.pdf">
            <caption>
              <p>Description of Additional Supplementary Files</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM5">
          <media xlink:href="41467_2022_29497_MOESM5_ESM.xlsx">
            <caption>
              <p>Supplementary Dataset 1</p>
            </caption>
          </media>
        </supplementary-material>
      </p>
    </sec>
  </sec>
</body>
<back>
  <fn-group>
    <fn>
      <p><bold>Publisher’s note</bold> Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p>
    </fn>
    <fn>
      <p>These authors contributed equally: Sonia Tarazona, Ana Conesa.</p>
    </fn>
  </fn-group>
  <sec>
    <title>Supplementary information</title>
    <p>The online version contains supplementary material available at 10.1038/s41467-022-29497-w.</p>
  </sec>
  <ack>
    <title>Acknowledgements</title>
    <p>This work has been funded by NIH grant R21HG011280 (A.C.) and by the Spanish Ministry of Science grants BIO2015–1658-R (A.C., S.T.), BES-2016-076994 (A.A.L.) and PID2020-119537RB-100 (A.C., S.T.). Funding for open access charge provided by the Universitat Politècnica de València and the Spanish Ministry of Science grant PID2020-119537RB-100.</p>
  </ack>
  <notes notes-type="author-contribution">
    <title>Author contributions</title>
    <p>A.A.L. developed and evaluated computational methods, implemented and documented R package, obtained long read transcriptome, analyzed single-cell data, interpreted results, and wrote the manuscript. P.S. implemented IsoAnnotLite, refined and performed functional annotation strategy. S.T. conducted statistical method development, refined the manuscript, and supervised the study. A.C. conceived the study, supervised all analysis approaches and methods developed, and refined the manuscript.</p>
  </notes>
  <notes notes-type="peer-review">
    <title>Peer review</title>
    <sec id="FPar1">
      <title>Peer review information</title>
      <p id="Par82"><italic>Nature Communications</italic> thanks Xiuwei Zhang and the other, anonymous, reviewer(s) for their contribution to the peer review of this work. Peer reviewer reports are available.</p>
    </sec>
  </notes>
  <notes notes-type="data-availability">
    <title>Data availability</title>
    <p>Single-cell, short-read RNA-Seq data from mouse primary visual cortex used in the analysis of neural broad types, generated by Tasic et al. 2016<sup><xref ref-type="bibr" rid="CR43">43</xref></sup>, was downloaded from SRA accession <ext-link ext-link-type="uri" xlink:href="https://www.ncbi.nlm.nih.gov/sra?term=SRP061902">SRP061902</ext-link>. Single-cell, short-read RNA-Seq data from mouse primary visual cortex used in the analysis of GABA neuron subtypes, generated by Tasic et al. 2018<sup><xref ref-type="bibr" rid="CR44">44</xref></sup>, was downloaded from SRA accession <ext-link ext-link-type="uri" xlink:href="https://www.ncbi.nlm.nih.gov/sra/?term=SRP150473">SRP150473</ext-link>, after selecting accessions corresponding to GABA neurons and primary visual cortex tissue, described by authors in the study metadata available at GEO accession <ext-link ext-link-type="uri" xlink:href="https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE115746">GSE115746</ext-link>. The isoform-level expression matrices obtained using these data and the long read-defined transcriptome are available as data objects within the <italic>acorde</italic> R package (<ext-link ext-link-type="uri" xlink:href="https://github.com/ConesaLab/acorde/data">https://github.com/ConesaLab/acorde/data</ext-link>). Mouse reference genome and transcriptome used for long-read processing were downloaded from the RefSeq<sup><xref ref-type="bibr" rid="CR96">96</xref></sup> database (global release 96, annotation release 108, September 2019, <ext-link ext-link-type="uri" xlink:href="https://ftp.ncbi.nlm.nih.gov/genomes/all/annotation_releases/10090/108">https://ftp.ncbi.nlm.nih.gov/genomes/all/annotation_releases/10090/108</ext-link>), from genome version GRCm38.p6 and assembly accession GCF_00001635.26. Long-read datasets form mouse hippocampus and cortex, generated by Wyman et al.<sup><xref ref-type="bibr" rid="CR45">45</xref></sup>, were downloaded from ENCODE accessions <ext-link ext-link-type="uri" xlink:href="https://www.encodeproject.org/experiments/ENCSR214HSG">ENCSR214HSG</ext-link> and <ext-link ext-link-type="uri" xlink:href="https://www.encodeproject.org/experiments/ENCSR340GWV">ENCSR340GWV</ext-link>, respectively. Long read-defined transcriptome files (generated using above-cited long-read data and reference files, details in <xref rid="MOESM1" ref-type="media">Supplementary Note</xref>) have been made available at the tappAS repository of annotation files. These include the GTF file used for quantification (<ext-link ext-link-type="uri" xlink:href="https://app.tappas.org/resources/downloads/gtfs">https://app.tappas.org/resources/downloads/gtfs</ext-link>) and the GFF3 file obtained after transferring functional features using isoAnnotLite (<ext-link ext-link-type="uri" xlink:href="http://app.tappas.org/resources/downloads/gffs">http://app.tappas.org/resources/downloads/gffs</ext-link>); indicated as Mus_Musculus_GRCm38.p6_PacBioENCODE_RefSeq108.</p>
  </notes>
  <notes notes-type="data-availability">
    <title>Code availability</title>
    <p>The code used to perform the analyses in this manuscript has been implemented in the <italic>acorde</italic> R package, available at <ext-link ext-link-type="uri" xlink:href="https://github.com/ConesaLab/acorde">https://github.com/ConesaLab/acorde</ext-link>. Specifically, all analyses have been run using <italic>acorde</italic> v0.1.0<sup><xref ref-type="bibr" rid="CR97">97</xref></sup>.</p>
  </notes>
  <notes id="FPar2" notes-type="COI-statement">
    <title>Competing interests</title>
    <p id="Par83">The authors declare no competing interests.</p>
  </notes>
  <ref-list id="Bib1">
    <title>References</title>
    <ref id="CR1">
      <label>1.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Svensson</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Vento-Tormo</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Teichmann</surname>
            <given-names>SA</given-names>
          </name>
        </person-group>
        <article-title>Exponential scaling of single-cell RNA-seq in the past decade</article-title>
        <source>Nat. Protoc.</source>
        <year>2018</year>
        <volume>13</volume>
        <fpage>599</fpage>
        <lpage>604</lpage>
        <?supplied-pmid 29494575?>
        <pub-id pub-id-type="pmid">29494575</pub-id>
      </element-citation>
    </ref>
    <ref id="CR2">
      <label>2.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Treutlein</surname>
            <given-names>B</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Reconstructing lineage hierarchies of the distal lung epithelium using single-cell RNA-seq</article-title>
        <source>Nature</source>
        <year>2014</year>
        <volume>509</volume>
        <fpage>371</fpage>
        <lpage>375</lpage>
        <?supplied-pmid 24739965?>
        <pub-id pub-id-type="pmid">24739965</pub-id>
      </element-citation>
    </ref>
    <ref id="CR3">
      <label>3.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zeisel</surname>
            <given-names>A</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Cell types in the mouse cortex and hippocampus revealed by single-cell RNA-seq</article-title>
        <source>Science</source>
        <year>2015</year>
        <volume>347</volume>
        <fpage>1138</fpage>
        <lpage>1142</lpage>
        <pub-id pub-id-type="pmid">25700174</pub-id>
      </element-citation>
    </ref>
    <ref id="CR4">
      <label>4.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Chen</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Wu</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Jiang</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>Y</given-names>
          </name>
        </person-group>
        <article-title>Single-cell RNA-Seq reveals hypothalamic cell diversity</article-title>
        <source>Cell Rep.</source>
        <year>2017</year>
        <volume>18</volume>
        <fpage>3227</fpage>
        <lpage>3241</lpage>
        <?supplied-pmid 28355573?>
        <pub-id pub-id-type="pmid">28355573</pub-id>
      </element-citation>
    </ref>
    <ref id="CR5">
      <label>5.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wu</surname>
            <given-names>YE</given-names>
          </name>
          <name>
            <surname>Pan</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Zuo</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Hong</surname>
            <given-names>W</given-names>
          </name>
        </person-group>
        <article-title>Detecting activated cell populations using single-cell RNA-Seq</article-title>
        <source>Neuron</source>
        <year>2017</year>
        <volume>96</volume>
        <fpage>313</fpage>
        <lpage>329.e6</lpage>
        <?supplied-pmid 29024657?>
        <pub-id pub-id-type="pmid">29024657</pub-id>
      </element-citation>
    </ref>
    <ref id="CR6">
      <label>6.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Villani</surname>
            <given-names>A-C</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Single-cell RNA-seq reveals new types of human blood dendritic cells, monocytes, and progenitors</article-title>
        <source>Science</source>
        <year>2017</year>
        <volume>356</volume>
        <fpage>eaah4573</fpage>
        <?supplied-pmid 5775029?>
        <pub-id pub-id-type="pmid">28428369</pub-id>
      </element-citation>
    </ref>
    <ref id="CR7">
      <label>7.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zhong</surname>
            <given-names>S</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>A single-cell RNA-seq survey of the developmental landscape of the human prefrontal cortex</article-title>
        <source>Nature</source>
        <year>2018</year>
        <volume>555</volume>
        <fpage>524</fpage>
        <lpage>528</lpage>
        <?supplied-pmid 29539641?>
        <pub-id pub-id-type="pmid">29539641</pub-id>
      </element-citation>
    </ref>
    <ref id="CR8">
      <label>8.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Crow</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Gillis</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>Co-expression in single-cell analysis: Saving grace or original sin?</article-title>
        <source>Trends Genet.</source>
        <year>2018</year>
        <volume>34</volume>
        <fpage>823</fpage>
        <lpage>831</lpage>
        <?supplied-pmid 30146183?>
        <pub-id pub-id-type="pmid">30146183</pub-id>
      </element-citation>
    </ref>
    <ref id="CR9">
      <label>9.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Trapnell</surname>
            <given-names>C</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>The dynamics and regulators of cell fate decisions are revealed by pseudotemporal ordering of single cells</article-title>
        <source>Nat. Biotechnol.</source>
        <year>2014</year>
        <volume>32</volume>
        <fpage>381</fpage>
        <lpage>386</lpage>
        <?supplied-pmid 4122333?>
        <pub-id pub-id-type="pmid">24658644</pub-id>
      </element-citation>
    </ref>
    <ref id="CR10">
      <label>10.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Saelens</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Cannoodt</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Todorov</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Saeys</surname>
            <given-names>Y</given-names>
          </name>
        </person-group>
        <article-title>A comparison of single-cell trajectory inference methods</article-title>
        <source>Nat. Biotechnol.</source>
        <year>2019</year>
        <volume>37</volume>
        <fpage>547</fpage>
        <lpage>554</lpage>
        <?supplied-pmid 30936559?>
        <pub-id pub-id-type="pmid">30936559</pub-id>
      </element-citation>
    </ref>
    <ref id="CR11">
      <label>11.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>La Manno</surname>
            <given-names>G</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>RNA velocity of single cells</article-title>
        <source>Nature</source>
        <year>2018</year>
        <volume>560</volume>
        <fpage>494</fpage>
        <lpage>498</lpage>
        <?supplied-pmid 6130801?>
        <pub-id pub-id-type="pmid">30089906</pub-id>
      </element-citation>
    </ref>
    <ref id="CR12">
      <label>12.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Jia</surname>
            <given-names>G</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Single cell RNA-seq and ATAC-seq analysis of cardiac progenitor cell transition states and lineage settlement</article-title>
        <source>Nat. Commun.</source>
        <year>2018</year>
        <volume>9</volume>
        <fpage>4877</fpage>
        <?supplied-pmid 30451828?>
        <pub-id pub-id-type="pmid">30451828</pub-id>
      </element-citation>
    </ref>
    <ref id="CR13">
      <label>13.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Su</surname>
            <given-names>X</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Single-cell RNA-Seq analysis reveals dynamic trajectories during mouse liver development</article-title>
        <source>BMC Genomics</source>
        <year>2017</year>
        <volume>18</volume>
        <fpage>946</fpage>
        <?supplied-pmid 29202695?>
        <pub-id pub-id-type="pmid">29202695</pub-id>
      </element-citation>
    </ref>
    <ref id="CR14">
      <label>14.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Guo</surname>
            <given-names>F</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Single-cell multi-omics sequencing of mouse early embryos and embryonic stem cells</article-title>
        <source>Cell Res.</source>
        <year>2017</year>
        <volume>27</volume>
        <fpage>967</fpage>
        <lpage>988</lpage>
        <?supplied-pmid 28621329?>
        <pub-id pub-id-type="pmid">28621329</pub-id>
      </element-citation>
    </ref>
    <ref id="CR15">
      <label>15.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Le</surname>
            <given-names>J</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Single-cell RNA-Seq mapping of human thymopoiesis reveals lineage specification trajectories and a commitment spectrum in T cell development</article-title>
        <source>Immunity</source>
        <year>2020</year>
        <volume>52</volume>
        <fpage>1105</fpage>
        <lpage>1118.e9</lpage>
        <?supplied-pmid 32553173?>
        <pub-id pub-id-type="pmid">32553173</pub-id>
      </element-citation>
    </ref>
    <ref id="CR16">
      <label>16.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Jerber</surname>
            <given-names>J</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Population-scale single-cell RNA-seq profiling across dopaminergic neuron differentiation</article-title>
        <source>Nat. Genet.</source>
        <year>2021</year>
        <volume>53</volume>
        <fpage>304</fpage>
        <lpage>312</lpage>
        <?supplied-pmid 33664506?>
        <pub-id pub-id-type="pmid">33664506</pub-id>
      </element-citation>
    </ref>
    <ref id="CR17">
      <label>17.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Pratapa</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Jalihal</surname>
            <given-names>AP</given-names>
          </name>
          <name>
            <surname>Law</surname>
            <given-names>JN</given-names>
          </name>
          <name>
            <surname>Bharadwaj</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Murali</surname>
            <given-names>TM</given-names>
          </name>
        </person-group>
        <article-title>Benchmarking algorithms for gene regulatory network inference from single-cell transcriptomic data</article-title>
        <source>Nat. Methods</source>
        <year>2020</year>
        <volume>17</volume>
        <fpage>147</fpage>
        <lpage>154</lpage>
        <?supplied-pmid 31907445?>
        <pub-id pub-id-type="pmid">31907445</pub-id>
      </element-citation>
    </ref>
    <ref id="CR18">
      <label>18.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Westoby</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Artemov</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Hemberg</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Ferguson-Smith</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>Obstacles to detecting isoforms using full-length scRNA-seq data</article-title>
        <source>Genome Biol.</source>
        <year>2020</year>
        <volume>21</volume>
        <fpage>74</fpage>
        <?supplied-pmid 32293520?>
        <pub-id pub-id-type="pmid">32293520</pub-id>
      </element-citation>
    </ref>
    <ref id="CR19">
      <label>19.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Arzalluz-Luque</surname>
            <given-names>Á</given-names>
          </name>
          <name>
            <surname>Conesa</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>Single-cell RNAseq for the study of isoforms—how is that possible?</article-title>
        <source>Genome Biol.</source>
        <year>2018</year>
        <volume>19</volume>
        <fpage>110</fpage>
        <?supplied-pmid 30097058?>
        <pub-id pub-id-type="pmid">30097058</pub-id>
      </element-citation>
    </ref>
    <ref id="CR20">
      <label>20.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ntranos</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Yi</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Melsted</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Pachter</surname>
            <given-names>L</given-names>
          </name>
        </person-group>
        <article-title>A discriminative learning approach to differential expression analysis for single-cell RNA-seq</article-title>
        <source>Nat. Methods</source>
        <year>2019</year>
        <volume>16</volume>
        <fpage>163</fpage>
        <lpage>166</lpage>
        <?supplied-pmid 30664774?>
        <pub-id pub-id-type="pmid">30664774</pub-id>
      </element-citation>
    </ref>
    <ref id="CR21">
      <label>21.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Qiu</surname>
            <given-names>X</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Single-cell mRNA quantification and differential analysis with Census</article-title>
        <source>Nat. Methods</source>
        <year>2017</year>
        <volume>14</volume>
        <fpage>309</fpage>
        <lpage>315</lpage>
        <?supplied-pmid 28114287?>
        <pub-id pub-id-type="pmid">28114287</pub-id>
      </element-citation>
    </ref>
    <ref id="CR22">
      <label>22.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Song</surname>
            <given-names>Y</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Single-cell alternative splicing analysis with expedition reveals splicing dynamics during neuron differentiation</article-title>
        <source>Mol. Cell</source>
        <year>2017</year>
        <volume>67</volume>
        <fpage>148</fpage>
        <lpage>161.e5</lpage>
        <?supplied-pmid 28673540?>
        <pub-id pub-id-type="pmid">28673540</pub-id>
      </element-citation>
    </ref>
    <ref id="CR23">
      <label>23.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Huang</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Sanguinetti</surname>
            <given-names>G</given-names>
          </name>
        </person-group>
        <article-title>BRIE: transcriptome-wide splicing quantification in single cells</article-title>
        <source>Genome Biol.</source>
        <year>2017</year>
        <volume>18</volume>
        <fpage>123</fpage>
        <?supplied-pmid 28655331?>
        <pub-id pub-id-type="pmid">28655331</pub-id>
      </element-citation>
    </ref>
    <ref id="CR24">
      <label>24.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wu</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Liu</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Ye</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Ye</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Ji</surname>
            <given-names>G</given-names>
          </name>
        </person-group>
        <article-title>scAPAtrap: Identification and quantification of alternative polyadenylation sites from single-cell RNA-seq data</article-title>
        <source>Brief. Bioinform.</source>
        <year>2020</year>
        <volume>2020</volume>
        <fpage>1</fpage>
        <lpage>15</lpage>
      </element-citation>
    </ref>
    <ref id="CR25">
      <label>25.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hu</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>Detecting differential alternative splicing events in scRNA-seq with or without Unique Molecular Identifiers</article-title>
        <source>PLoS Comput. Biol.</source>
        <year>2020</year>
        <volume>16</volume>
        <fpage>e1007925</fpage>
        <?supplied-pmid 32502143?>
        <pub-id pub-id-type="pmid">32502143</pub-id>
      </element-citation>
    </ref>
    <ref id="CR26">
      <label>26.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Patrick</surname>
            <given-names>R</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Sierra: Discovery of differential transcript usage from polyA-captured single-cell RNA-seq data</article-title>
        <source>Genome Biol.</source>
        <year>2020</year>
        <volume>21</volume>
        <fpage>1</fpage>
        <lpage>27</lpage>
      </element-citation>
    </ref>
    <ref id="CR27">
      <label>27.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Booeshaghi</surname>
            <given-names>AS</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Isoform cell-type specificity in the mouse primary motor cortex</article-title>
        <source>Nature</source>
        <year>2021</year>
        <volume>598</volume>
        <fpage>195</fpage>
        <lpage>199</lpage>
        <?supplied-pmid 34616073?>
        <pub-id pub-id-type="pmid">34616073</pub-id>
      </element-citation>
    </ref>
    <ref id="CR28">
      <label>28.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Byrne</surname>
            <given-names>A</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Nanopore long-read RNAseq reveals widespread transcriptional variation among the surface receptors of individual B cells</article-title>
        <source>Nat. Commun.</source>
        <year>2017</year>
        <volume>8</volume>
        <fpage>16027</fpage>
        <?supplied-pmid 28722025?>
        <pub-id pub-id-type="pmid">28722025</pub-id>
      </element-citation>
    </ref>
    <ref id="CR29">
      <label>29.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Volden</surname>
            <given-names>R</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Improving nanopore read accuracy with the R2C2 method enables the sequencing of highly multiplexed full-length single-cell cDNA</article-title>
        <source>Proc. Natl Acad. Sci. USA</source>
        <year>2018</year>
        <volume>115</volume>
        <fpage>9726</fpage>
        <lpage>9731</lpage>
        <?supplied-pmid 30201725?>
        <pub-id pub-id-type="pmid">30201725</pub-id>
      </element-citation>
    </ref>
    <ref id="CR30">
      <label>30.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Gupta</surname>
            <given-names>I</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Single-cell isoform RNA sequencing characterizes isoforms in thousands of cerebellar cells</article-title>
        <source>Nat. Biotechnol.</source>
        <year>2018</year>
        <volume>36</volume>
        <fpage>1197</fpage>
        <lpage>1202</lpage>
      </element-citation>
    </ref>
    <ref id="CR31">
      <label>31.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Joglekar</surname>
            <given-names>A</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>A spatially resolved brain region- and cell type-specific isoform atlas of the postnatal mouse brain</article-title>
        <source>Nat. Commun.</source>
        <year>2021</year>
        <volume>12</volume>
        <fpage>463</fpage>
        <?supplied-pmid 33469025?>
        <pub-id pub-id-type="pmid">33469025</pub-id>
      </element-citation>
    </ref>
    <ref id="CR32">
      <label>32.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Tian</surname>
            <given-names>L</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Comprehensive characterization of single-cell full-length isoforms in human and mouse with long-read sequencing</article-title>
        <source>Genome Biol.</source>
        <year>2021</year>
        <volume>22</volume>
        <fpage>310</fpage>
        <?supplied-pmid 34763716?>
        <pub-id pub-id-type="pmid">34763716</pub-id>
      </element-citation>
    </ref>
    <ref id="CR33">
      <label>33.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Feng</surname>
            <given-names>H</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Complexity and graded regulation of neuronal cell-type–specific alternative splicing revealed by single-cell RNA sequencing</article-title>
        <source>Proc. Natl Acad. Sci. USA</source>
        <year>2021</year>
        <volume>118</volume>
        <fpage>e2013056118</fpage>
        <?supplied-pmid 33674385?>
        <pub-id pub-id-type="pmid">33674385</pub-id>
      </element-citation>
    </ref>
    <ref id="CR34">
      <label>34.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Becht</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Zhao</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Amezquita</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Gottardo</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>Aggregating transcript-level analyses for single-cell differential gene expression</article-title>
        <source>Nat. Methods</source>
        <year>2020</year>
        <volume>17</volume>
        <fpage>583</fpage>
        <lpage>585</lpage>
        <?supplied-pmid 32483334?>
        <pub-id pub-id-type="pmid">32483334</pub-id>
      </element-citation>
    </ref>
    <ref id="CR35">
      <label>35.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Yi</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Pimentel</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Bray</surname>
            <given-names>NL</given-names>
          </name>
          <name>
            <surname>Pachter</surname>
            <given-names>L</given-names>
          </name>
        </person-group>
        <article-title>Gene-level differential analysis at transcript-level resolution</article-title>
        <source>Genome Biol.</source>
        <year>2018</year>
        <volume>19</volume>
        <fpage>53</fpage>
        <?supplied-pmid 29650040?>
        <pub-id pub-id-type="pmid">29650040</pub-id>
      </element-citation>
    </ref>
    <ref id="CR36">
      <label>36.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Soneson</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Robinson</surname>
            <given-names>MD</given-names>
          </name>
        </person-group>
        <article-title>Bias, robustness and scalability in single-cell differential expression analysis</article-title>
        <source>Nat. Methods</source>
        <year>2018</year>
        <volume>15</volume>
        <fpage>255</fpage>
        <lpage>261</lpage>
        <?supplied-pmid 29481549?>
        <pub-id pub-id-type="pmid">29481549</pub-id>
      </element-citation>
    </ref>
    <ref id="CR37">
      <label>37.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Shalek</surname>
            <given-names>AK</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Single-cell transcriptomics reveals bimodality in expression and splicing in immune cells</article-title>
        <source>Nature</source>
        <year>2013</year>
        <volume>498</volume>
        <fpage>236</fpage>
        <lpage>240</lpage>
        <?supplied-pmid 23685454?>
        <pub-id pub-id-type="pmid">23685454</pub-id>
      </element-citation>
    </ref>
    <ref id="CR38">
      <label>38.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Liu</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>X</given-names>
          </name>
        </person-group>
        <article-title>Single-cell alternative splicing analysis reveals dominance of single transcript variant</article-title>
        <source>Genomics</source>
        <year>2020</year>
        <volume>112</volume>
        <fpage>2418</fpage>
        <lpage>2425</lpage>
        <?supplied-pmid 31981701?>
        <pub-id pub-id-type="pmid">31981701</pub-id>
      </element-citation>
    </ref>
    <ref id="CR39">
      <label>39.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Buen Abad Najar</surname>
            <given-names>CF</given-names>
          </name>
          <name>
            <surname>Yosef</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Lareau</surname>
            <given-names>LF</given-names>
          </name>
        </person-group>
        <article-title>Coverage-dependent bias creates the appearance of binary splicing in single cells</article-title>
        <source>eLife</source>
        <year>2020</year>
        <volume>9</volume>
        <fpage>1</fpage>
        <lpage>23</lpage>
      </element-citation>
    </ref>
    <ref id="CR40">
      <label>40.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Tilgner</surname>
            <given-names>H</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Microfluidic isoform sequencing shows widespread splicing coordination in the human transcriptome</article-title>
        <source>Genome Res.</source>
        <year>2018</year>
        <volume>28</volume>
        <fpage>231</fpage>
        <lpage>242</lpage>
        <?supplied-pmid 29196558?>
        <pub-id pub-id-type="pmid">29196558</pub-id>
      </element-citation>
    </ref>
    <ref id="CR41">
      <label>41.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Tilgner</surname>
            <given-names>H</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Comprehensive transcriptome analysis using synthetic long-read sequencing reveals molecular co-association of distant splicing events</article-title>
        <source>Nat. Biotechnol.</source>
        <year>2015</year>
        <volume>33</volume>
        <fpage>736</fpage>
        <lpage>742</lpage>
        <?supplied-pmid 25985263?>
        <pub-id pub-id-type="pmid">25985263</pub-id>
      </element-citation>
    </ref>
    <ref id="CR42">
      <label>42.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Skinnider</surname>
            <given-names>MA</given-names>
          </name>
          <name>
            <surname>Squair</surname>
            <given-names>JW</given-names>
          </name>
          <name>
            <surname>Foster</surname>
            <given-names>LJ</given-names>
          </name>
        </person-group>
        <article-title>Evaluating measures of association for single-cell transcriptomics</article-title>
        <source>Nat. Methods</source>
        <year>2019</year>
        <volume>16</volume>
        <fpage>381</fpage>
        <lpage>386</lpage>
        <?supplied-pmid 30962620?>
        <pub-id pub-id-type="pmid">30962620</pub-id>
      </element-citation>
    </ref>
    <ref id="CR43">
      <label>43.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Tasic</surname>
            <given-names>B</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Adult mouse cortical cell taxonomy revealed by single cell transcriptomics</article-title>
        <source>Nat. Neurosci.</source>
        <year>2016</year>
        <volume>19</volume>
        <fpage>335</fpage>
        <lpage>346</lpage>
        <?supplied-pmid 26727548?>
        <pub-id pub-id-type="pmid">26727548</pub-id>
      </element-citation>
    </ref>
    <ref id="CR44">
      <label>44.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Tasic</surname>
            <given-names>B</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Shared and distinct transcriptomic cell types across neocortical areas</article-title>
        <source>Nature</source>
        <year>2018</year>
        <volume>563</volume>
        <fpage>72</fpage>
        <lpage>78</lpage>
        <?supplied-pmid 30382198?>
        <pub-id pub-id-type="pmid">30382198</pub-id>
      </element-citation>
    </ref>
    <ref id="CR45">
      <label>45.</label>
      <mixed-citation publication-type="other">Wyman, D. et al. A technology-agnostic long-read analysis pipeline for transcriptome discovery and quantification. Preprint at <italic>bioRxiv</italic>10.1101/672931 (2019).</mixed-citation>
    </ref>
    <ref id="CR46">
      <label>46.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Soneson</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Matthes</surname>
            <given-names>KL</given-names>
          </name>
          <name>
            <surname>Nowicka</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Law</surname>
            <given-names>CW</given-names>
          </name>
          <name>
            <surname>Robinson</surname>
            <given-names>MD</given-names>
          </name>
        </person-group>
        <article-title>Isoform prefiltering improves performance of count-based methods for analysis of differential transcript usage</article-title>
        <source>Genome Biol.</source>
        <year>2016</year>
        <volume>17</volume>
        <fpage>12</fpage>
        <?supplied-pmid 26813113?>
        <pub-id pub-id-type="pmid">26813113</pub-id>
      </element-citation>
    </ref>
    <ref id="CR47">
      <label>47.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Tardaguila</surname>
            <given-names>M</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>SQANTI: Extensive characterization of long-read transcript sequences for quality control in full-length transcriptome identification and quantification</article-title>
        <source>Genome Res.</source>
        <year>2018</year>
        <volume>28</volume>
        <fpage>396</fpage>
        <lpage>411</lpage>
      </element-citation>
    </ref>
    <ref id="CR48">
      <label>48.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Van den Berge</surname>
            <given-names>K</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Observation weights unlock bulk RNA-seq tools for zero inflation and single-cell applications</article-title>
        <source>Genome Biol.</source>
        <year>2018</year>
        <volume>19</volume>
        <fpage>24</fpage>
        <?supplied-pmid 29478411?>
        <pub-id pub-id-type="pmid">29478411</pub-id>
      </element-citation>
    </ref>
    <ref id="CR49">
      <label>49.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Love</surname>
            <given-names>MI</given-names>
          </name>
          <name>
            <surname>Huber</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Anders</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>Moderated estimation of fold change and dispersion for RNA-seq data with DESeq2</article-title>
        <source>Genome Biol.</source>
        <year>2014</year>
        <volume>15</volume>
        <fpage>550</fpage>
        <?supplied-pmid 4302049?>
        <pub-id pub-id-type="pmid">25516281</pub-id>
      </element-citation>
    </ref>
    <ref id="CR50">
      <label>50.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Robinson</surname>
            <given-names>MD</given-names>
          </name>
          <name>
            <surname>McCarthy</surname>
            <given-names>DJ</given-names>
          </name>
          <name>
            <surname>Smyth</surname>
            <given-names>GK</given-names>
          </name>
        </person-group>
        <article-title>edgeR: A Bioconductor package for differential expression analysis of digital gene expression data</article-title>
        <source>Bioinformatics</source>
        <year>2009</year>
        <volume>26</volume>
        <fpage>139</fpage>
        <lpage>140</lpage>
        <?supplied-pmid 19910308?>
        <pub-id pub-id-type="pmid">19910308</pub-id>
      </element-citation>
    </ref>
    <ref id="CR51">
      <label>51.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Chen</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Mar</surname>
            <given-names>JC</given-names>
          </name>
        </person-group>
        <article-title>Evaluating methods of inferring gene regulatory networks highlights their lack of performance for single cell gene expression data</article-title>
        <source>BMC Bioinform.</source>
        <year>2018</year>
        <volume>19</volume>
        <fpage>232</fpage>
      </element-citation>
    </ref>
    <ref id="CR52">
      <label>52.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Iacono</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Massoni-Badosa</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Heyn</surname>
            <given-names>H</given-names>
          </name>
        </person-group>
        <article-title>Single-cell transcriptomics unveils gene regulatory network plasticity</article-title>
        <source>Genome Biol.</source>
        <year>2019</year>
        <volume>20</volume>
        <fpage>110</fpage>
        <?supplied-pmid 31159854?>
        <pub-id pub-id-type="pmid">31159854</pub-id>
      </element-citation>
    </ref>
    <ref id="CR53">
      <label>53.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Brennecke</surname>
            <given-names>P</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Accounting for technical noise in single-cell RNA-seq experiments</article-title>
        <source>Nat. Methods</source>
        <year>2013</year>
        <volume>10</volume>
        <fpage>1093</fpage>
        <lpage>1095</lpage>
        <?supplied-pmid 24056876?>
        <pub-id pub-id-type="pmid">24056876</pub-id>
      </element-citation>
    </ref>
    <ref id="CR54">
      <label>54.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Grün</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Kester</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>van Oudenaarden</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>Validation of noise models for single-cell transcriptomics</article-title>
        <source>Nat. Methods</source>
        <year>2014</year>
        <volume>11</volume>
        <fpage>637</fpage>
        <lpage>640</lpage>
        <?supplied-pmid 24747814?>
        <pub-id pub-id-type="pmid">24747814</pub-id>
      </element-citation>
    </ref>
    <ref id="CR55">
      <label>55.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Raj</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>van Oudenaarden</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>Nature, nurture, or chance: Stochastic gene expression and its consequences</article-title>
        <source>Cell</source>
        <year>2008</year>
        <volume>135</volume>
        <fpage>216</fpage>
        <lpage>226</lpage>
        <?supplied-pmid 18957198?>
        <pub-id pub-id-type="pmid">18957198</pub-id>
      </element-citation>
    </ref>
    <ref id="CR56">
      <label>56.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Langfelder</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Horvath</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>Defining clusters from a hierarchical cluster tree: The dynamic tree cut package for R</article-title>
        <source>Bioinformatics</source>
        <year>2008</year>
        <volume>24</volume>
        <fpage>719</fpage>
        <lpage>720</lpage>
        <?supplied-pmid 18024473?>
        <pub-id pub-id-type="pmid">18024473</pub-id>
      </element-citation>
    </ref>
    <ref id="CR57">
      <label>57.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Pimentel</surname>
            <given-names>RS</given-names>
          </name>
          <name>
            <surname>Niewiadomska-Bugaj</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>J-C</given-names>
          </name>
        </person-group>
        <article-title>Association of zero-inflated continuous variables</article-title>
        <source>Stat. Probab. Lett.</source>
        <year>2015</year>
        <volume>96</volume>
        <fpage>61</fpage>
        <lpage>67</lpage>
      </element-citation>
    </ref>
    <ref id="CR58">
      <label>58.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Erb</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Notredame</surname>
            <given-names>C</given-names>
          </name>
        </person-group>
        <article-title>How should we measure proportionality on relative gene expression data?</article-title>
        <source>Theory Biosci.</source>
        <year>2016</year>
        <volume>135</volume>
        <fpage>21</fpage>
        <lpage>36</lpage>
        <?supplied-pmid 26762323?>
        <pub-id pub-id-type="pmid">26762323</pub-id>
      </element-citation>
    </ref>
    <ref id="CR59">
      <label>59.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zhang</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Xu</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Yosef</surname>
            <given-names>N</given-names>
          </name>
        </person-group>
        <article-title>Simulating multiple faceted variability in single cell RNA sequencing</article-title>
        <source>Nat. Commun.</source>
        <year>2019</year>
        <volume>10</volume>
        <fpage>2611</fpage>
        <?supplied-pmid 31197158?>
        <pub-id pub-id-type="pmid">31197158</pub-id>
      </element-citation>
    </ref>
    <ref id="CR60">
      <label>60.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Vitting-Seerup</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Sandelin</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>IsoformSwitchAnalyzeR: Analysis of changes in genome-wide patterns of alternative splicing and its functional consequences</article-title>
        <source>Bioinforma. Oxf. Engl.</source>
        <year>2019</year>
        <volume>35</volume>
        <fpage>4469</fpage>
        <lpage>4471</lpage>
      </element-citation>
    </ref>
    <ref id="CR61">
      <label>61.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>de la Fuente</surname>
            <given-names>L</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>tappAS: A comprehensive computational framework for the analysis of the functional impact of differential splicing</article-title>
        <source>Genome Biol.</source>
        <year>2020</year>
        <volume>21</volume>
        <fpage>119</fpage>
        <?supplied-pmid 32423416?>
        <pub-id pub-id-type="pmid">32423416</pub-id>
      </element-citation>
    </ref>
    <ref id="CR62">
      <label>62.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zhu</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Liu</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Yu</surname>
            <given-names>W</given-names>
          </name>
        </person-group>
        <article-title>Long non-coding RNA MBNL1-AS1 regulates proliferation, migration, and invasion of cancer stem cells in colon cancer by interacting with MYL9 via sponging microRNA-412-3p</article-title>
        <source>Clin. Res. Hepatol. Gastroenterol.</source>
        <year>2020</year>
        <volume>44</volume>
        <fpage>101</fpage>
        <lpage>114</lpage>
        <?supplied-pmid 31255531?>
        <pub-id pub-id-type="pmid">31255531</pub-id>
      </element-citation>
    </ref>
    <ref id="CR63">
      <label>63.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lee</surname>
            <given-names>K-Y</given-names>
          </name>
          <name>
            <surname>Chang</surname>
            <given-names>H-C</given-names>
          </name>
          <name>
            <surname>Seah</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Lee</surname>
            <given-names>L-J</given-names>
          </name>
        </person-group>
        <article-title>Deprivation of muscleblind-like proteins causes deficits in cortical neuron distribution and morphological changes in dendritic spines and postsynaptic densities</article-title>
        <source>Front. Neuroanat.</source>
        <year>2019</year>
        <volume>13</volume>
        <fpage>75</fpage>
        <?supplied-pmid 31417371?>
        <pub-id pub-id-type="pmid">31417371</pub-id>
      </element-citation>
    </ref>
    <ref id="CR64">
      <label>64.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wang</surname>
            <given-names>P-Y</given-names>
          </name>
          <name>
            <surname>Chang</surname>
            <given-names>K-T</given-names>
          </name>
          <name>
            <surname>Lin</surname>
            <given-names>Y-M</given-names>
          </name>
          <name>
            <surname>Kuo</surname>
            <given-names>T-Y</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>G-S</given-names>
          </name>
        </person-group>
        <article-title>Ubiquitination of MBNL1 is required for its cytoplasmic localization and function in promoting neurite outgrowth</article-title>
        <source>Cell Rep.</source>
        <year>2018</year>
        <volume>22</volume>
        <fpage>2294</fpage>
        <lpage>2306</lpage>
        <?supplied-pmid 29490267?>
        <pub-id pub-id-type="pmid">29490267</pub-id>
      </element-citation>
    </ref>
    <ref id="CR65">
      <label>65.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Sta Maria</surname>
            <given-names>NS</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Mbnl1 and Mbnl2 regulate brain structural integrity in mice</article-title>
        <source>Commun. Biol.</source>
        <year>2021</year>
        <volume>4</volume>
        <fpage>1342</fpage>
        <?supplied-pmid 34848815?>
        <pub-id pub-id-type="pmid">34848815</pub-id>
      </element-citation>
    </ref>
    <ref id="CR66">
      <label>66.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Derrick</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>White</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Toher</surname>
            <given-names>D</given-names>
          </name>
        </person-group>
        <article-title>Parametric and non-parametric tests for the comparison of two samples which both include paired and unpaired observations</article-title>
        <source>J. Mod. Appl. Stat. Methods</source>
        <year>2019</year>
        <volume>18</volume>
        <fpage>2</fpage>
        <lpage>23</lpage>
      </element-citation>
    </ref>
    <ref id="CR67">
      <label>67.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Supek</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Bošnjak</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Škunca</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Šmuc</surname>
            <given-names>T</given-names>
          </name>
        </person-group>
        <article-title>REVIGO summarizes and visualizes long lists of gene ontology terms</article-title>
        <source>PLoS One</source>
        <year>2011</year>
        <volume>6</volume>
        <fpage>e21800</fpage>
        <?supplied-pmid 21789182?>
        <pub-id pub-id-type="pmid">21789182</pub-id>
      </element-citation>
    </ref>
    <ref id="CR68">
      <label>68.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>MacNicol</surname>
            <given-names>MC</given-names>
          </name>
          <name>
            <surname>Cragle</surname>
            <given-names>CE</given-names>
          </name>
          <name>
            <surname>MacNicol</surname>
            <given-names>AM</given-names>
          </name>
        </person-group>
        <article-title>Context-dependent regulation of Musashi-mediated mRNA translation and cell cycle regulation</article-title>
        <source>Cell Cycle</source>
        <year>2011</year>
        <volume>10</volume>
        <fpage>39</fpage>
        <lpage>44</lpage>
        <?supplied-pmid 21191181?>
        <pub-id pub-id-type="pmid">21191181</pub-id>
      </element-citation>
    </ref>
    <ref id="CR69">
      <label>69.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Okano</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Imai</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Okabe</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>Musashi: A translational regulator of cell fate</article-title>
        <source>J. Cell Sci.</source>
        <year>2002</year>
        <volume>115</volume>
        <fpage>1355</fpage>
        <lpage>1359</lpage>
        <?supplied-pmid 11896183?>
        <pub-id pub-id-type="pmid">11896183</pub-id>
      </element-citation>
    </ref>
    <ref id="CR70">
      <label>70.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Li</surname>
            <given-names>HJ</given-names>
          </name>
          <name>
            <surname>Haque</surname>
            <given-names>ZK</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Mendelsohn</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>RIF-1, a novel nuclear receptor corepressor that associates with the nuclear matrix</article-title>
        <source>J. Cell. Biochem.</source>
        <year>2007</year>
        <volume>102</volume>
        <fpage>1021</fpage>
        <lpage>1035</lpage>
        <?supplied-pmid 17455211?>
        <pub-id pub-id-type="pmid">17455211</pub-id>
      </element-citation>
    </ref>
    <ref id="CR71">
      <label>71.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Tang</surname>
            <given-names>SJ</given-names>
          </name>
          <name>
            <surname>Meulemans</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Vazquez</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Colaco</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Schuman</surname>
            <given-names>E</given-names>
          </name>
        </person-group>
        <article-title>A role for a rat homolog of staufen in the transport of RNA to neuronal dendrites</article-title>
        <source>Neuron</source>
        <year>2001</year>
        <volume>32</volume>
        <fpage>463</fpage>
        <lpage>475</lpage>
        <?supplied-pmid 11709157?>
        <pub-id pub-id-type="pmid">11709157</pub-id>
      </element-citation>
    </ref>
    <ref id="CR72">
      <label>72.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Gleghorn</surname>
            <given-names>ML</given-names>
          </name>
          <name>
            <surname>Gong</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Kielkopf</surname>
            <given-names>CL</given-names>
          </name>
          <name>
            <surname>Maquat</surname>
            <given-names>LE</given-names>
          </name>
        </person-group>
        <article-title>Staufen1 dimerizes through a conserved motif and a degenerate dsRNA-binding domain to promote mRNA decay</article-title>
        <source>Nat. Struct. Mol. Biol.</source>
        <year>2013</year>
        <volume>20</volume>
        <fpage>515</fpage>
        <lpage>524</lpage>
        <?supplied-pmid 23524536?>
        <pub-id pub-id-type="pmid">23524536</pub-id>
      </element-citation>
    </ref>
    <ref id="CR73">
      <label>73.</label>
      <mixed-citation publication-type="other">McInnes, L., Healy, J. &amp; Melville, J. UMAP: Uniform manifold approximation and projection for dimension reduction. Preprint at <ext-link ext-link-type="uri" xlink:href="https://arxiv.org/abs/1802.03426">https://arxiv.org/abs/1802.03426</ext-link> (2020).</mixed-citation>
    </ref>
    <ref id="CR74">
      <label>74.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Masood</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Grimm</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>El-Bahrawy</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Yagüe</surname>
            <given-names>E</given-names>
          </name>
        </person-group>
        <article-title>TMEFF2: A transmembrane proteoglycan with multifaceted actions in cancer and disease</article-title>
        <source>Cancers</source>
        <year>2020</year>
        <volume>12</volume>
        <fpage>E3862</fpage>
        <?supplied-pmid 33371267?>
        <pub-id pub-id-type="pmid">33371267</pub-id>
      </element-citation>
    </ref>
    <ref id="CR75">
      <label>75.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Jen</surname>
            <given-names>Y-HL</given-names>
          </name>
          <name>
            <surname>Musacchio</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Lander</surname>
            <given-names>AD</given-names>
          </name>
        </person-group>
        <article-title>Glypican-1 controls brain size through regulation of fibroblast growth factor signaling in early neurogenesis</article-title>
        <source>Neural Dev.</source>
        <year>2009</year>
        <volume>4</volume>
        <fpage>33</fpage>
        <?supplied-pmid 19732411?>
        <pub-id pub-id-type="pmid">19732411</pub-id>
      </element-citation>
    </ref>
    <ref id="CR76">
      <label>76.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Fu</surname>
            <given-names>XD</given-names>
          </name>
          <name>
            <surname>Ares</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>Context-dependent control of alternative splicing by RNA-binding proteins</article-title>
        <source>Nat. Rev. Genet.</source>
        <year>2014</year>
        <volume>15</volume>
        <fpage>689</fpage>
        <lpage>701</lpage>
        <?supplied-pmid 25112293?>
        <pub-id pub-id-type="pmid">25112293</pub-id>
      </element-citation>
    </ref>
    <ref id="CR77">
      <label>77.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Saha</surname>
            <given-names>A</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Co-expression networks reveal the tissue-specific regulation of transcription and splicing</article-title>
        <source>Genome Res.</source>
        <year>2017</year>
        <volume>27</volume>
        <fpage>1843</fpage>
        <lpage>1858</lpage>
        <?supplied-pmid 29021288?>
        <pub-id pub-id-type="pmid">29021288</pub-id>
      </element-citation>
    </ref>
    <ref id="CR78">
      <label>78.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Aghamirzaie</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Collakova</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Grene</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>CoSpliceNet: a framework for co-splicing network inference from transcriptomics data</article-title>
        <source>BMC Genomics</source>
        <year>2016</year>
        <volume>17</volume>
        <fpage>845</fpage>
        <?supplied-pmid 27793091?>
        <pub-id pub-id-type="pmid">27793091</pub-id>
      </element-citation>
    </ref>
    <ref id="CR79">
      <label>79.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zhang</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Southey</surname>
            <given-names>BR</given-names>
          </name>
          <name>
            <surname>Rodriguez-Zas</surname>
            <given-names>SL</given-names>
          </name>
        </person-group>
        <article-title>Co-expression networks uncover regulation of splicing and transcription markers of disease</article-title>
        <source>EPiC Ser. Comput.</source>
        <year>2020</year>
        <volume>70</volume>
        <fpage>119</fpage>
        <lpage>128</lpage>
      </element-citation>
    </ref>
    <ref id="CR80">
      <label>80.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Chau</surname>
            <given-names>K</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Isoform transcriptome of developing human brain provides new insights into autism</article-title>
        <source>Cell Rep.</source>
        <year>2021</year>
        <volume>36</volume>
        <fpage>109631</fpage>
        <?supplied-pmid 34469739?>
        <pub-id pub-id-type="pmid">34469739</pub-id>
      </element-citation>
    </ref>
    <ref id="CR81">
      <label>81.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Vu</surname>
            <given-names>TN</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Isoform-level gene expression patterns in single-cell RNA-sequencing data</article-title>
        <source>Bioinformatics</source>
        <year>2018</year>
        <volume>10</volume>
        <fpage>1</fpage>
        <lpage>9</lpage>
      </element-citation>
    </ref>
    <ref id="CR82">
      <label>82.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Yap</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Xiao</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Friedman</surname>
            <given-names>BA</given-names>
          </name>
          <name>
            <surname>Je</surname>
            <given-names>HS</given-names>
          </name>
          <name>
            <surname>Makeyev</surname>
            <given-names>EV</given-names>
          </name>
        </person-group>
        <article-title>Polarizing the neuron through sustained co-expression of alternatively spliced isoforms</article-title>
        <source>Cell Rep.</source>
        <year>2016</year>
        <volume>15</volume>
        <fpage>1316</fpage>
        <lpage>1328</lpage>
        <?supplied-pmid 27134173?>
        <pub-id pub-id-type="pmid">27134173</pub-id>
      </element-citation>
    </ref>
    <ref id="CR83">
      <label>83.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ma</surname>
            <given-names>J</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Comprehensive expression-based isoform biomarkers predictive of drug responses based on isoform co-expression networks and clinical data</article-title>
        <source>Genomics</source>
        <year>2020</year>
        <volume>112</volume>
        <fpage>647</fpage>
        <lpage>658</lpage>
        <?supplied-pmid 31029864?>
        <pub-id pub-id-type="pmid">31029864</pub-id>
      </element-citation>
    </ref>
    <ref id="CR84">
      <label>84.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ma</surname>
            <given-names>J-Q</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Differential alternative splicing genes and isoform regulation networks of rapeseed (Brassica napus L.) infected with Sclerotinia sclerotiorum</article-title>
        <source>Genes</source>
        <year>2020</year>
        <volume>11</volume>
        <fpage>784</fpage>
      </element-citation>
    </ref>
    <ref id="CR85">
      <label>85.</label>
      <mixed-citation publication-type="other">Bray, N. The power of 3′ UTRs. <italic>Nat. Rev. Neurosci</italic>. 10.1038/s41583-018-0011-6 (2018).</mixed-citation>
    </ref>
    <ref id="CR86">
      <label>86.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bae</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Miura</surname>
            <given-names>P</given-names>
          </name>
        </person-group>
        <article-title>Emerging roles for 3′ UTRs in neurons</article-title>
        <source>Int. J. Mol. Sci.</source>
        <year>2020</year>
        <volume>21</volume>
        <fpage>3413</fpage>
      </element-citation>
    </ref>
    <ref id="CR87">
      <label>87.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Picelli</surname>
            <given-names>S</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Tn5 transposase and tagmentation procedures for massively scaled sequencing projects</article-title>
        <source>Genome Res.</source>
        <year>2014</year>
        <volume>24</volume>
        <fpage>2033</fpage>
        <lpage>2040</lpage>
        <?supplied-pmid 25079858?>
        <pub-id pub-id-type="pmid">25079858</pub-id>
      </element-citation>
    </ref>
    <ref id="CR88">
      <label>88.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Dobin</surname>
            <given-names>A</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>STAR: Ultrafast universal RNA-seq aligner</article-title>
        <source>Bioinformatics</source>
        <year>2013</year>
        <volume>29</volume>
        <fpage>15</fpage>
        <lpage>21</lpage>
        <?supplied-pmid 23104886?>
        <pub-id pub-id-type="pmid">23104886</pub-id>
      </element-citation>
    </ref>
    <ref id="CR89">
      <label>89.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Li</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Dewey</surname>
            <given-names>CN</given-names>
          </name>
        </person-group>
        <article-title>RSEM: Accurate transcript quantification from RNA-Seq data with or without a reference genome</article-title>
        <source>BMC Bioinform.</source>
        <year>2011</year>
        <volume>12</volume>
        <fpage>323</fpage>
      </element-citation>
    </ref>
    <ref id="CR90">
      <label>90.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Tarazona</surname>
            <given-names>S</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Data quality aware analysis of differential expression in RNA-seq with NOISeq R/Bioc package</article-title>
        <source>Nucleic Acids Res.</source>
        <year>2015</year>
        <volume>43</volume>
        <fpage>gkv711</fpage>
      </element-citation>
    </ref>
    <ref id="CR91">
      <label>91.</label>
      <mixed-citation publication-type="other">R Core Team. <italic>R: A Language and Environment for Statistical Computing</italic> (R Foundation for Statistical Computing, 2021).</mixed-citation>
    </ref>
    <ref id="CR92">
      <label>92.</label>
      <mixed-citation publication-type="other">Venables, W. &amp; Ripley, B. <italic>Modern Applied Statistics with S</italic> (Springer, 2002).</mixed-citation>
    </ref>
    <ref id="CR93">
      <label>93.</label>
      <mixed-citation publication-type="other">Fox, J. &amp; Weisberg, S. <italic>An R Companion to Applied Regression</italic> (Sage, 2019).</mixed-citation>
    </ref>
    <ref id="CR94">
      <label>94.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Young</surname>
            <given-names>MD</given-names>
          </name>
          <name>
            <surname>Wakefield</surname>
            <given-names>MJ</given-names>
          </name>
          <name>
            <surname>Smyth</surname>
            <given-names>GK</given-names>
          </name>
          <name>
            <surname>Oshlack</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>Gene ontology analysis for RNA-seq: accounting for selection bias</article-title>
        <source>Genome Biol.</source>
        <year>2010</year>
        <volume>11</volume>
        <fpage>R14</fpage>
        <?supplied-pmid 2872874?>
        <pub-id pub-id-type="pmid">20132535</pub-id>
      </element-citation>
    </ref>
    <ref id="CR95">
      <label>95.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bray</surname>
            <given-names>NL</given-names>
          </name>
          <name>
            <surname>Pimentel</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Melsted</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Pachter</surname>
            <given-names>L</given-names>
          </name>
        </person-group>
        <article-title>Near-optimal probabilistic RNA-seq quantification</article-title>
        <source>Nat. Biotechnol.</source>
        <year>2016</year>
        <volume>34</volume>
        <fpage>525</fpage>
        <lpage>527</lpage>
        <?supplied-pmid 27043002?>
        <pub-id pub-id-type="pmid">27043002</pub-id>
      </element-citation>
    </ref>
    <ref id="CR96">
      <label>96.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>O’Leary</surname>
            <given-names>NA</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Reference sequence (RefSeq) database at NCBI: Current status, taxonomic expansion, and functional annotation</article-title>
        <source>Nucleic Acids Res.</source>
        <year>2016</year>
        <volume>44</volume>
        <fpage>D733</fpage>
        <lpage>D745</lpage>
        <?supplied-pmid 26553804?>
        <pub-id pub-id-type="pmid">26553804</pub-id>
      </element-citation>
    </ref>
    <ref id="CR97">
      <label>97.</label>
      <mixed-citation publication-type="other">Arzalluz-Luque, A. acorde: Unraveling functionally interpretable networks of isoform co-usage from single cell data. <italic>GitHub</italic>10.5281/zenodo.6341636 (2022).</mixed-citation>
    </ref>
  </ref-list>
</back>
<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName A++V2.4.dtd?>
<?SourceDTD.Version 2.4?>
<?ConverterInfo.XSLTName springer2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Nat Commun</journal-id>
    <journal-id journal-id-type="iso-abbrev">Nat Commun</journal-id>
    <journal-title-group>
      <journal-title>Nature Communications</journal-title>
    </journal-title-group>
    <issn pub-type="epub">2041-1723</issn>
    <publisher>
      <publisher-name>Nature Publishing Group UK</publisher-name>
      <publisher-loc>London</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">8983708</article-id>
    <article-id pub-id-type="publisher-id">29497</article-id>
    <article-id pub-id-type="doi">10.1038/s41467-022-29497-w</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Article</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title><italic>acorde</italic> unravels functionally interpretable networks of isoform co-usage from single cell data</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-2959-0134</contrib-id>
        <name>
          <surname>Arzalluz-Luque</surname>
          <given-names>Angeles</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-1879-3374</contrib-id>
        <name>
          <surname>Salguero</surname>
          <given-names>Pedro</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author" corresp="yes" equal-contrib="yes">
        <name>
          <surname>Tarazona</surname>
          <given-names>Sonia</given-names>
        </name>
        <address>
          <email>sotacam@eio.upv</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author" corresp="yes" equal-contrib="yes">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0001-9597-311X</contrib-id>
        <name>
          <surname>Conesa</surname>
          <given-names>Ana</given-names>
        </name>
        <address>
          <email>ana.conesa@csic.es</email>
        </address>
        <xref ref-type="aff" rid="Aff2">2</xref>
        <xref ref-type="aff" rid="Aff3">3</xref>
      </contrib>
      <aff id="Aff1"><label>1</label><institution-wrap><institution-id institution-id-type="GRID">grid.157927.f</institution-id><institution-id institution-id-type="ISNI">0000 0004 1770 5832</institution-id><institution>Department of Applied Statistics, Operations Research and Quality, </institution><institution>Universitat Politècnica de València, </institution></institution-wrap>Valencia, Spain </aff>
      <aff id="Aff2"><label>2</label><institution-wrap><institution-id institution-id-type="GRID">grid.4711.3</institution-id><institution-id institution-id-type="ISNI">0000 0001 2183 4846</institution-id><institution>Institute for Integrative Systems Biology (CSIC-UV), </institution><institution>Spanish National Research Council, </institution></institution-wrap>Paterna, Valencia Spain </aff>
      <aff id="Aff3"><label>3</label><institution-wrap><institution-id institution-id-type="GRID">grid.15276.37</institution-id><institution-id institution-id-type="ISNI">0000 0004 1936 8091</institution-id><institution>Microbiology and Cell Sciences Department, Institute for Food and Agricultural Research, </institution><institution>University of Florida, </institution></institution-wrap>Gainesville, FL USA </aff>
    </contrib-group>
    <pub-date pub-type="epub">
      <day>5</day>
      <month>4</month>
      <year>2022</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>5</day>
      <month>4</month>
      <year>2022</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2022</year>
    </pub-date>
    <volume>13</volume>
    <elocation-id>1828</elocation-id>
    <history>
      <date date-type="received">
        <day>12</day>
        <month>5</month>
        <year>2021</year>
      </date>
      <date date-type="accepted">
        <day>16</day>
        <month>3</month>
        <year>2022</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2022</copyright-statement>
      <license>
        <ali:license_ref specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p><bold>Open Access</bold> This article is licensed under a Creative Commons Attribution 4.0 International License, which permits use, sharing, adaptation, distribution and reproduction in any medium or format, as long as you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons license, and indicate if changes were made. The images or other third party material in this article are included in the article’s Creative Commons license, unless indicated otherwise in a credit line to the material. If material is not included in the article’s Creative Commons license and your intended use is not permitted by statutory regulation or exceeds the permitted use, you will need to obtain permission directly from the copyright holder. To view a copy of this license, visit <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>.</license-p>
      </license>
    </permissions>
    <abstract id="Abs1">
      <p id="Par1">Alternative splicing (AS) is a highly-regulated post-transcriptional mechanism known to modulate isoform expression within genes and contribute to cell-type identity. However, the extent to which alternative isoforms establish co-expression networks that may be relevant in cellular function has not been explored yet. Here, we present <italic>acorde</italic>, a pipeline that successfully leverages bulk long reads and single-cell data to confidently detect alternative isoform co-expression relationships. To achieve this, we develop and validate percentile correlations, an innovative approach that overcomes data sparsity and yields accurate co-expression estimates from single-cell data. Next, <italic>acorde</italic> uses correlations to cluster co-expressed isoforms into a network, unraveling cell type-specific alternative isoform usage patterns. By selecting same-gene isoforms between these clusters, we subsequently detect and characterize genes with co-differential isoform usage (coDIU) across cell types. Finally, we predict functional elements from long read-defined isoforms and provide insight into biological processes, motifs, and domains potentially controlled by the coordination of post-transcriptional regulation. The code for <italic>acorde</italic> is available at <ext-link ext-link-type="uri" xlink:href="https://github.com/ConesaLab/acorde">https://github.com/ConesaLab/acorde</ext-link>.</p>
    </abstract>
    <abstract id="Abs2" abstract-type="web-summary">
      <p id="Par2">Alternative splicing (AS) is a highly-regulated post-transcriptional mechanism known to modulate isoform expression within genes and contribute to cell-type identity. Here, the authors present <italic>acorde</italic>, a pipeline that successfully leverages bulk long reads and single-cell data to confidently detect alternative isoform co-expression relationships.</p>
    </abstract>
    <kwd-group kwd-group-type="npg-subject">
      <title>Subject terms</title>
      <kwd>Computational biology and bioinformatics</kwd>
      <kwd>Systems biology</kwd>
    </kwd-group>
    <custom-meta-group>
      <custom-meta>
        <meta-name>issue-copyright-statement</meta-name>
        <meta-value>© The Author(s) 2022</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec id="Sec1" sec-type="introduction">
    <title>Introduction</title>
    <p id="Par3">Single-cell RNA-seq (scRNA-seq) has revolutionized transcriptomics analysis, especially as the development of technologies with increasingly higher throughputs has enabled the processing of thousands of single cells simultaneously, boosting the amount of biological diversity that can be captured in a sequencing experiment<sup><xref ref-type="bibr" rid="CR1">1</xref></sup>. The technology has been extensively applied to the discovery of new cell types and the characterization of their transcriptional profiles, resulting in the definition of cell type marker genes<sup><xref ref-type="bibr" rid="CR2">2</xref>–<xref ref-type="bibr" rid="CR7">7</xref></sup>. Even though scRNA-seq datasets can encode several levels of granularity in the form of cell subtypes, these studies rely on the low number of features required to recapitulate the cell type structure of the data<sup><xref ref-type="bibr" rid="CR8">8</xref></sup>, which situates cell type characterization efforts at the baseline of understanding the intricacy of single-cell biology. scRNA-seq studies have also tackled transcriptional dynamics and how they relate to cell type properties. These include methods for the study of dynamic processes, namely pseudotime<sup><xref ref-type="bibr" rid="CR9">9</xref>,<xref ref-type="bibr" rid="CR10">10</xref></sup> and RNA-velocity<sup><xref ref-type="bibr" rid="CR11">11</xref></sup> analyses, which have provided insight on cell differentiation and the mechanisms behind cell state transitions<sup><xref ref-type="bibr" rid="CR7">7</xref>,<xref ref-type="bibr" rid="CR12">12</xref>–<xref ref-type="bibr" rid="CR16">16</xref></sup>. Moreover, novel methods have been developed to allow the inference of gene regulatory networks (GRNs) at the single-cell level<sup><xref ref-type="bibr" rid="CR17">17</xref></sup>, in an attempt to combine single-cell information with extant knowledge and infer relationships between genes and transcriptional regulators at a higher resolution.</p>
    <p id="Par4">Single-cell research is nevertheless far from realizing its full potential. On the contrary, the timing is now optimal for the field to undertake the investigation of deeper layers of cellular complexity. In particular, the investigation of alternative splicing (AS) and isoform expression dynamics has remained a challenge to the field. Reasons for this include the uncertainty of short read-based isoform quantification, which is exacerbated by the lower number of available reads per transcript in comparison to bulk libraries<sup><xref ref-type="bibr" rid="CR18">18</xref></sup>, and the fact that the most popular scRNA-seq methods are heavily 3′ end biased, which precludes the unambiguous identification of alternative transcript variants<sup><xref ref-type="bibr" rid="CR19">19</xref></sup>. Current methods for the study of isoforms in single cells, therefore, rely on alternative metrics that either avoid isoform-level expression estimation completely<sup><xref ref-type="bibr" rid="CR20">20</xref>,<xref ref-type="bibr" rid="CR21">21</xref></sup> or exclusively consider individual splicing events<sup><xref ref-type="bibr" rid="CR22">22</xref>–<xref ref-type="bibr" rid="CR26">26</xref></sup>, generally leaving isoform characterization aside, with some recent exceptions<sup><xref ref-type="bibr" rid="CR27">27</xref></sup>. Meanwhile, long read RNA sequencing (lrRNA-seq) of single cells is beginning to emerge an alternative approach to mitigate this ambiguity, given that it successfully grasps how individual events are combined into alternative isoforms<sup><xref ref-type="bibr" rid="CR19">19</xref></sup>. Long read studies have expanded the field’s notions of cell type-specific splicing from event inclusion towards isoform selection patterns and showed that cell type-specific isoform expression can be detected in both broad types as well as cell subtypes<sup><xref ref-type="bibr" rid="CR28">28</xref>–<xref ref-type="bibr" rid="CR32">32</xref></sup>. Unfortunately, the sequencing depth constraints intrinsic to long read protocols<sup><xref ref-type="bibr" rid="CR19">19</xref></sup> have limited the amount of isoform diversity that can be captured by single-cell long read transcriptomics<sup><xref ref-type="bibr" rid="CR28">28</xref>–<xref ref-type="bibr" rid="CR30">30</xref></sup>, and datasets generally show low levels of redundancy between cells of the same cell type.</p>
    <p id="Par5">Notwithstanding this limited scenario, there are a number of relevant questions regarding the importance of splicing for cell identity and function that can only be resolved by evaluating isoform expression at the single-cell level. In fact, splicing differences have been shown to discriminate cell types with an accuracy comparable to that obtained using gene expression<sup><xref ref-type="bibr" rid="CR33">33</xref></sup> while integrating AS and gene expression changes has led to the discovery of cell subtypes and states that were otherwise not detected<sup><xref ref-type="bibr" rid="CR27">27</xref>,<xref ref-type="bibr" rid="CR34">34</xref>–<xref ref-type="bibr" rid="CR36">36</xref></sup>. Especially relevant among these inquiries is the much-debated issue of whether individual cells express one or several isoforms, that is, whether the isoform diversity observed in bulk studies is recapitulated by each single cell or, alternatively, arises as a result of multiple cells expressing one of the gene’s isoforms. Ever since the publication of the first scRNA-seq studies, short reads have been used to answer this question, usually via the characterization of splicing event—rather than isoform expression- modalities. Successive studies have provided non-conclusive results, with evidence of bimodal splicing patterns<sup><xref ref-type="bibr" rid="CR22">22</xref>,<xref ref-type="bibr" rid="CR37">37</xref>,<xref ref-type="bibr" rid="CR38">38</xref></sup> as well as concerns regarding the relationship between bimodal isoform detection and technical noise<sup><xref ref-type="bibr" rid="CR18">18</xref>,<xref ref-type="bibr" rid="CR39">39</xref></sup>, a controversy that suggests that new approaches are needed to understand the isoform landscape of single cells.</p>
    <p id="Par6">Another pending question for the field is whether isoform expression programs involve co-expression relationships between transcript variants from different genes. So far, the application of long read technologies to single-cell data has served to unravel coordinated event choice patterns within isoforms of the same gene<sup><xref ref-type="bibr" rid="CR40">40</xref>,<xref ref-type="bibr" rid="CR41">41</xref></sup>, however, cross-gene isoform expression networks have not been investigated. In other words, there have been no studies addressing potential codependency between genes regarding the selection of transcript variants from their isoform repertoire, or the implications of this coordination for cell-state and cell-type properties. This is not only related to the general constraints of single-cell isoform studies, but also to the lack of computational methods and mathematical models to extract this complex signal from the data. In spite of the present research gap, isoform co-expression networks are an anticipated consequence of the regulation of splicing by RNA binding proteins (RBPs) and other splicing factors, and their investigation constitutes an opportunity to gain insight on the functional role of AS. Moreover, a multiple cell type and high cell throughput context such as that of scRNA-seq data constitutes a far more suitable data scenario to that of bulk RNA-seq. Given this context, this is undoubtedly a timely inquiry to make.</p>
    <p id="Par7">In the present study, we hypothesize that isoform expression coordination exists as a result of AS regulation, and that it can be computationally detected in the form of isoform groups showing co-variation across cell types. To demonstrate this hypothesis, we have designed an end-to-end, data-intensive pipeline for the study of isoform networks (Fig. <xref rid="Fig1" ref-type="fig">1</xref>). First and foremost, we employed a hybrid strategy where bulk long-reads and single-cell Illumina sequencing were integrated to estimate isoform expression at the single cell level. To unlock the limitations of extant correlation metrics in the single-cell context<sup><xref ref-type="bibr" rid="CR42">42</xref></sup>, we developed a strategy to obtain noise-robust correlation estimates in scRNA-seq data, and a semi-automated clustering approach to detect modules of co-expressed isoforms across cell types. We additionally defined and implemented Differential Isoform Usage (DIU) and co-Differential Isoform Usage (coDIU) analyses in order to leverage the multiple cell types contained in single-cell datasets. Finally, to couple these analyses with a biologically interpretable readout, we incorporated a functional annotation step in which several databases and prediction tools were integrated to add isoform-specific functional information (Fig. <xref rid="Fig1" ref-type="fig">1</xref>, <xref rid="MOESM1" ref-type="media">Supplementary Note</xref>).<fig id="Fig1"><label>Fig. 1</label><caption><title><italic>acorde w</italic>orkflow.</title><p>The <italic>acorde</italic> pipeline includes three main analysis modules. First, long read RNA-Seq data is used to define isoform models and short, single-cell RNA-Seq reads are mapped to the long read-generated transcriptome. Isoform are then tested for multi-group differential expression and those that are significantly DE in at least one of the cell types are selected. Next, percentile correlations are computed to cluster isoforms with similar expression patterns across cell types. Finally, gene pairs are tested for co-differential isoform usage, detecting genes that form co-expression relationships for subsequent functional analysis.</p></caption><graphic xlink:href="41467_2022_29497_Fig1_HTML" id="d32e445"/></fig></p>
    <p id="Par8">We have hereby applied this pipeline (Fig. <xref rid="Fig1" ref-type="fig">1</xref>) to the analysis of two publicly available mouse neural datasets, including scRNA-seq Smart-Seq2 (primary visual cortex, generated by Tasic et al.<sup><xref ref-type="bibr" rid="CR43">43</xref>,<xref ref-type="bibr" rid="CR44">44</xref></sup>) and bulk ENCODE PacBio long-read data (mouse cortex and hippocampus, generated by Wyman et al.<sup><xref ref-type="bibr" rid="CR45">45</xref></sup>). As a result, we successfully detected cell type-level co-expression of isoforms in a manner that was independent of gene-level expression. Furthermore, we demonstrated that these isoforms encode shared functional properties, highlighting the role of post-transcriptional processing as in the fine-tuning of cellular functions and the encoding of cell type identity. This pipeline has been implemented in the R package <italic>acorde</italic> (<ext-link ext-link-type="uri" xlink:href="https://github.com/ConesaLab/acorde">https://github.com/ConesaLab/acorde</ext-link>).</p>
  </sec>
  <sec id="Sec2" sec-type="results">
    <title>Results</title>
    <sec id="Sec3">
      <title>Enabling multi-group differential expression (DE) of isoforms in single-cell data</title>
      <p id="Par9">Traditionally, RNA-seq studies have used publicly available reference transcriptomes such as RefSeq and ENSEMBL for short read isoform quantification. However, most tissues and cell types will express only a subset of the genes and isoforms contained in the reference, with previous studies showing that isoform detection accuracy increases when adopting tissue-specific isoform sets as a reference for mapping<sup><xref ref-type="bibr" rid="CR46">46</xref></sup>. Long read technologies have the potential to achieve this, while also expanding the reference with novel isoforms that have not yet been annotated<sup><xref ref-type="bibr" rid="CR47">47</xref></sup>. Given the low depth of single-cell long read datasets<sup><xref ref-type="bibr" rid="CR19">19</xref></sup>, we employed bulk PacBio long-reads obtained from ENCODE<sup><xref ref-type="bibr" rid="CR45">45</xref></sup> to define a mouse, neural-specific transcriptome, that, after extensive curation using the SQANTI3 toolkit (<ext-link ext-link-type="uri" xlink:href="https://github.com/ConesaLab/SQANTI3">https://github.com/ConesaLab/SQANTI3</ext-link>) contained 36,986 isoforms belonging to 12,692 genes (see <xref rid="MOESM1" ref-type="media">Supplementary Note</xref>).</p>
      <p id="Par10">To quantify the expression of the long read-defined isoforms at the single-cell level, we made use of a publicly available, deeply sequenced, full-length, short-read single-cell RNA-seq dataset by Tasic et al.<sup><xref ref-type="bibr" rid="CR43">43</xref></sup>. In total, 1591 cells and 16,240 isoforms from 8814 genes were retained after quality control (see “Methods”). Using the labels from the original characterization of the dataset, we assigned cells to 7 broad cell types, 5 glial (microglia, endothelial cells, oligodendrocytes, oligodendrocyte precursor cells (OPCs) and astrocytes) and 2 neural (GABA-ergic and glutamatergic neurons), each of which can be divided into several, distinct subtypes (Supplementary Fig. <xref rid="MOESM1" ref-type="media">1a</xref>). Next, to select isoforms with robust co-variation and non-constitutive expression, a multi-group strategy was used to detect isoforms showing DE in at least one cell type, combining the ZinBWaVE zero-expression weighting strategy<sup><xref ref-type="bibr" rid="CR48">48</xref></sup> with bulk-designed DE methods DESeq2<sup><xref ref-type="bibr" rid="CR49">49</xref></sup> and edgeR<sup><xref ref-type="bibr" rid="CR50">50</xref></sup> (see “Methods”).</p>
      <p id="Par11">Of note, the Tasic dataset presented a drastic cell number imbalance between neural (~720 cells/cell type) and glial cell types (~30 cells/cell type), which resulted in the underestimation of transcriptional differences between non-neural types (Supplementary Fig. <xref rid="MOESM1" ref-type="media">1b</xref>). To balance sample sizes, we performed 50 rounds of random neural cell sampling (<italic>n</italic> = 45 cells) followed by DE testing using both edgeR and DESeq2 (see “Methods”). Although DESeq2 proved to be slightly more robust across independent runs than edgeR, Jaccard index values indicated that the majority of isoforms were consistently detected as DE (DESeq2: mean no. of DE isoforms = 6908 ± 101, mean Jaccard index = 0.84 ± 0.02; edgeR: mean no. of DE isoforms = 6016 ± 410, mean Jaccard index = 0.74 ± 0.02). In addition, this strategy revealed that considering the union of edgeR and DESeq2 results contributed to improve robustness (mean no. of DE isoforms in union between methods = 9399 ± 248, Jaccard index = 0.82 ± 0.01). Upon testing, we selected a consensus set of isoforms consisting in those transcripts detected as significant (FDR &lt; 0.05) by at least one DE method in ≥50% downsampling runs. This consensus set included 9393 isoforms from 4223 genes, however, minor isoforms (those accumulating &lt;10% of total gene expression) were additionally filtered, resulting in the removal of ~10% of the consensus DE set (969 isoforms). Finally, since two or more isoforms with differential cell type expression are required to form co-splicing relationships (see “Methods”), transcripts with no other same-gene DE counterpart were removed, retaining 6794 isoforms from 2696 genes for downstream analysis.</p>
    </sec>
    <sec id="Sec4">
      <title>Detecting isoforms showing cell type-level co-expression</title>
      <p id="Par12">Co-expression signals in single-cell data are weak and have often resulted in a poor performance of traditional correlation and network inference methods<sup><xref ref-type="bibr" rid="CR42">42</xref>,<xref ref-type="bibr" rid="CR51">51</xref></sup>. Although data transformation approaches<sup><xref ref-type="bibr" rid="CR52">52</xref></sup> and alternative metrics<sup><xref ref-type="bibr" rid="CR42">42</xref></sup> have been proposed, these are more complex to apply and considerably less interpretable, respectively. Furthermore, most of these studies have only investigated gene-level co-expression<sup><xref ref-type="bibr" rid="CR17">17</xref></sup>, often ignoring the AS regulatory landscape. To address these limitations, we implemented a <italic>percentile correlation</italic> strategy: a simple, scalable approach to overcome single-cell noise in isoform co-expression studies (Fig. <xref rid="Fig2" ref-type="fig">2a</xref>).<fig id="Fig2"><label>Fig. 2</label><caption><title>Percentile correlations and isoform clustering.</title><p><bold>a</bold> Percentile correlation algorithm. For each isoform, cell type-level expression is summarized using percentiles (0–10) as a proxy of the isoform’s expression distribution in each of the cell types. Then, Pearson correlations are computed using the percentile-summarized expression of all isoforms, obtaining a percentile correlation matrix. <bold>b</bold> Correlation density distributions. Pairwise isoform correlations were computed using Pearson, Spearman, and percentile+Pearson correlation. <bold>c</bold> Clustering pipeline. The percentile correlation matrix is first used as a distance matrix for hierarchical clustering. After dynamic cluster generation, noisy clusters are refined by a three-step semi-automated process. <bold>d</bold> Clusters generated after applying the <italic>acorde</italic> clustering pipeline to the mouse neural dataset. Cell-level mean expression (scaled, see “Methods”) is computed for all transcripts and then aggregated as the global cell type mean, represented by the red line. Gray area corresponds to cell type mean ± standard deviation. Astr: astrocytes, End: endothelial cells, GABA: GABA-ergic neurons, Glut: glutamatergic neurons, Micr: microglia, Oligo: oligodendrocytes, OPC: oligodendrocyte precursor cells.</p></caption><graphic xlink:href="41467_2022_29497_Fig2_HTML" id="d32e587"/></fig></p>
      <p id="Par13">Our approach considers cell-type identity to be defined by context-specific gene expression and within-cell type stochasticity to arise from a combination of technical noise<sup><xref ref-type="bibr" rid="CR53">53</xref>,<xref ref-type="bibr" rid="CR54">54</xref></sup> and biological mechanisms such as transcriptional bursting<sup><xref ref-type="bibr" rid="CR55">55</xref></sup>. These translate into the sparse and heterogeneous expression patterns typically observed in scRNA-seq (Supplementary Fig. <xref rid="MOESM1" ref-type="media">2a</xref>) and result in high variance across all levels of expression (Supplementary Fig. <xref rid="MOESM1" ref-type="media">2b</xref>). Together, these effects mask the co-expression signal in the data and tend to yield low correlation values when using traditional metrics (Fig. <xref rid="Fig2" ref-type="fig">2b</xref>). To overcome this problem, we treat single cells of the same cell-type as biological replicates, that is, instances that represent the state of a delimited cell population, but are differently affected by the aforementioned combination of technical and biological forces. In this context, the expression distribution of any given isoform across the population can be considered to be the signature of the isoform in that cell-type. To translate these assumptions into a metric, the expression of each isoform within a given cell type was first summarized into an expression profile, where single-cell count values were replaced by 10 percentile values (deciles) (Fig. <xref rid="Fig2" ref-type="fig">2b</xref>, “Methods”). Intuitively, this reduced number of values captures the behavior of that transcript in the cell type, as inferred given cell-level observations. Next, to grasp similarities between expression distributions across cell types, pairwise Pearson correlations were computed using percentile-summarized isoform expression, resulting in a more meaningful distribution of correlation values than obtained with traditional metrics (Fig. <xref rid="Fig2" ref-type="fig">2b</xref>). In this manner, we managed to extend the notion of cell-type markers to rely not only on mean or frequency of expression, but on their actual distributional pattern. Our co-expression metric, therefore, by-passes cell-level matching of individual observations, providing a correlation estimate that is both robust to the uncertainty of single cell expression and interpretable as a measure of expression similarity. Remarkably, changing percentile number did not have a noticeable effect on the resulting correlation values, as long as it ranged between 100 and 4 (Supplementary Fig. <xref rid="MOESM1" ref-type="media">2c</xref>). Nevertheless, using 1 percentile (median expression), substantially disrupted the correlation value distribution (Supplementary Fig. <xref rid="MOESM1" ref-type="media">2d</xref>), stressing the importance of selecting a sufficient number of percentiles to avoid over-summarizing isoform expression.</p>
      <p id="Par14">To detect modules of co-expressed isoforms, we used percentile correlations as a distance metric for hierarchical clustering, and designed a semi-automated cluster refinement approach to ensure maximal profile similarity within clustered modules (Fig. <xref rid="Fig2" ref-type="fig">2c</xref>, see “Methods” for a detailed description). First, the <italic>dynamicTreeCut</italic> R package<sup><xref ref-type="bibr" rid="CR56">56</xref></sup> was used to initialize clustering. The dynamic clustering algorithm enables the selection of adaptive thresholds for better detection of clusters within the dendrogram. 166 clusters were obtained as a result. These were then re-clustered to mitigate the presence of highly similar (i.e., redundant) expression profiles (Supplementary Fig. <xref rid="MOESM1" ref-type="media">3a</xref>). To achieve this, cluster <italic>metatranscripts</italic> (i.e., the mean scaled expression of all isoforms in the cluster, see “Methods”) were computed and hierarchical clustering applied, generating 26 clusters. At this point, 2381 isoforms remained unclustered, including isoforms from 3 groups that presented noisy expression profiles (Supplementary Fig. <xref rid="MOESM1" ref-type="media">3b</xref>). These were assigned by maximizing the similarities between cluster and isoform expression profiles, i.e., using the percentile correlation between isoform expression and cluster metatranscripts (see “Methods”). Finally, clusters were merged again to obtain completely unique profiles. Of note, we spotted two pairs of clusters with clearly similar profiles that were not merged metatranscript clustering. To avoid detection of falsely coDIU genes in downstream analysis, these were merged manually. As a result, we generated a total of 15 distinct clusters (Fig. <xref rid="Fig2" ref-type="fig">2d</xref>) containing all initially analyzed isoforms (6794 total) and representing diverse expression modalities across the 7 broad cell types. The different steps in the clustering process are implemented as functions in the <italic>acorde</italic> R package.</p>
    </sec>
    <sec id="Sec5">
      <title>Validation of percentile correlations on simulated data</title>
      <p id="Par15">Building on studies reporting the poor performance of popular correlation metrics in single-cell data, authors have attempted the implementation of sparsity-aware measurements<sup><xref ref-type="bibr" rid="CR52">52</xref>,<xref ref-type="bibr" rid="CR57">57</xref></sup> and reported the potential of other alternatives to compute similarity, such as proportionality metrics<sup><xref ref-type="bibr" rid="CR42">42</xref></sup>. Here, we present an interpretable, scalable and biology-aware alternative to single-cell co-expression studies based on Pearson or Spearman correlation. However, to better understand how percentile correlation performs in comparison to extant correlation metrics, we compared it to Pearson, Spearman and zero-inflated Kendall correlations<sup><xref ref-type="bibr" rid="CR57">57</xref></sup> and one proportionality metric, rho (<italic>ρ</italic>)<sup><xref ref-type="bibr" rid="CR58">58</xref></sup> using simulated data.</p>
      <p id="Par16">Given that there are -to the best of our knowledge- no scRNA-seq data simulators that include transcript co-expression patterns, we designed a simulation strategy (Supplementary Fig. <xref rid="MOESM1" ref-type="media">4</xref>, “Methods”) to generate an appropriate validation framework for our metric. Briefly, we applied <italic>SymSim</italic><sup><xref ref-type="bibr" rid="CR59">59</xref></sup> to simulate a single-cell RNA-seq dataset (8 cell types, 1000 cells and 8000 transcripts, Supplementary Fig. <xref rid="MOESM1" ref-type="media">5a</xref>) and used the simulated expression values to artificially create 3000 synthetic transcripts showing 15 different expression profiles across the 8 cell types (Supplementary Fig. <xref rid="MOESM1" ref-type="media">5b</xref>). As a result, our simulated dataset contained 15 simulated clusters with distinct expression profiles while preserving the original cell type structure generated by <italic>SymSim</italic> (Supplementary Fig. <xref rid="MOESM1" ref-type="media">5a</xref>). Among them, clusters 1–5, 6–10 and 11–15 included transcripts showing high expression in one, two and three cell types, respectively, gradually increasing simulated pattern complexity (Supplementary Fig. <xref rid="MOESM1" ref-type="media">5b, c</xref>). After refinement (Supplementary Fig. <xref rid="MOESM1" ref-type="media">5c</xref>, “Methods”), 1790 synthetic transcripts remained distributed across the 15 simulated clusters in groups ranging from 180 to 60 transcripts (Supplementary Fig. <xref rid="MOESM1" ref-type="media">5d</xref>).</p>
      <p id="Par17">In order to evaluate how well the 5 correlation methods recapitulated the simulated patterns, we computed these metrics for all synthetic transcript pairs in each simulated cluster (Supplementary Fig. <xref rid="MOESM1" ref-type="media">5e</xref>). Among them, percentile correlation consistently yielded the best proportion of high within-cluster correlations followed by <italic>ρ</italic>. However, rather counter-intuitively, <italic>ρ</italic> had only an average performance when low-complexity patterns were provided, with less than 20% output proportionality values &gt;0.8 within clusters 1–5. Shockingly, zero-inflated Kendall correlation, a single cell-tailored metric, failed to recapitulate the simulated co-expression profiles and showed a considerably lower proportion of high correlations within the simulated clusters than Pearson and Spearman correlations. To better assess the ability of each metric to discriminate true from spurious co-expression, pairwise correlations for isoforms within (intra-cluster) and between (inter-cluster) clusters were compared. Even though results showed overall good separation between pairs from the same cluster, percentile correlation was the only metric to provide a complete lack of overlap between inter and intra-cluster correlation distributions (Supplementary Fig. <xref rid="MOESM1" ref-type="media">5f</xref>). As a result of this evaluation, we can confidently assume that percentile correlations are useful to detect co-variation patterns, yielding overall higher correlation values than all other considered metrics (Supplementary Fig. <xref rid="MOESM1" ref-type="media">5E</xref>) and correctly discriminating true correlated and uncorrelated transcript pairs (Supplementary Fig. <xref rid="MOESM1" ref-type="media">5f</xref>). Of note, and similarly to real data, the simulated dataset showed no detectable effect when varying the number of percentiles used to compute percentile correlations (Supplementary Fig. <xref rid="MOESM1" ref-type="media">6</xref>).</p>
      <p id="Par18">Next, we compared the ability of each co-expression metric to inform clustering and group transcripts with similar expression patterns. To achieve this, we run our clustering pipeline on the simulated isoforms using the 5 metrics as distance (Supplementary Figs. <xref rid="MOESM1" ref-type="media">7</xref>–<xref rid="MOESM1" ref-type="media">11</xref>). To enable benchmarking, clustering was automated to generate a total number of 15 calculated clusters (see “Methods”). In order to evaluate which metric worked best to detect co-expressed transcript groups, we considered internal correlations between the transcripts in the calculated clusters. We observed that <italic>ρ</italic> and percentile-generated clusters, unlike the remaining co-expression metrics, presented consistently high levels of internal correlation (Fig. <xref rid="Fig3" ref-type="fig">3a</xref>). Notably, the distribution of correlation values obtained using percentiles was the most robust among the five metrics (Supplementary Fig. <xref rid="MOESM1" ref-type="media">12</xref>). We next assessed how well the clusters generated using each correlation metric (i.e., calculated clusters) recapitulated the simulated clusters. Calculated and simulated clusters were paired based on the similarities between their mean cluster profiles (Supplementary Fig. <xref rid="MOESM1" ref-type="media">13</xref>, “Methods”), and the Jaccard index was computed for each simulated-calculated pair to measure the agreement in transcript assignment (Fig. <xref rid="Fig3" ref-type="fig">3b</xref>). Interestingly, results were highly heterogeneous for most methods: even though a number of simulated co-expression groups were easily detected by most metrics, no method was able to fully recapitulate the simulated clusters, with <italic>ρ</italic> proportionality, Pearson, and percentile correlations being the most accurate (Fig. <xref rid="Fig4" ref-type="fig">4b</xref>). Zero-inflated Kendall and Spearman correlations, on the other hand, showed consistently low agreement with the simulated transcript groups. Finally, we considered the number of transcripts that remained unclustered (Fig. <xref rid="Fig3" ref-type="fig">3c</xref>) before and after re-clustering unassigned transcripts (cluster expansion step, see “Methods”). Pearson correlation provided successful cluster assignment for practically all transcripts in the simulated dataset, especially when incorporating percentiles (Pearson: ~10% unclustered before expansion, ~1% after; percentile: ~4% unclustered before expansion, 0% after), whilst the rest of metrics performed significantly worse, leaving 20–30% of transcripts unassigned even after cluster expansion, with proportionality (~30% unclustered before expansion, ~25% after) being the less optimal. Altogether, even though <italic>ρ</italic> demonstrated good performance in many aspects of clustering, including intra-cluster correlation and agreement with the simulated clustering, it was outperformed by percentile correlation when globally considering all evaluated parameters (Fig. <xref rid="Fig3" ref-type="fig">3d</xref>). In addition to the fact that <italic>ρ</italic> failed to control for unassigned transcripts, computing means and standard deviations of Jaccard indices across simulated-calculated pairs showed percentile and Pearson correlations as the most consistently accurate methods. All in all, our synthetic data evaluations showed that the percentile correlation approach performed well—and more consistently than <italic>ρ</italic> proportionality- in all the evaluated features, and visibly captured co-expression better than both traditional and zero inflation-aware correlation metrics.<fig id="Fig3"><label>Fig. 3</label><caption><title>Comparative evaluation of percentile correlation on simulated clusters.</title><p><bold>a</bold> Proportion of co-expression values above 0.8 in each empirical cluster, obtained after running the <italic>acorde</italic> clustering pipeline on simulated clusters using several correlation and proportionality methods as a distance metric. <bold>b</bold> Jaccard index of simulated vs calculated clusters obtained with each evaluated co-expression method. Simulated clusters were paired with one calculated cluster based on mean profile similarity, and synthetic transcripts in each of the paired clusters were compared. <bold>c</bold> Percentage of unclustered isoforms generated by each co-expression method. Results are shown before and after re-assigning unclustered isoforms by co-expression with the mean profile of extant clusters (i.e., cluster expansion). <bold>d</bold> Evaluation metric overview. Metrics are specified in the grid headers. <italic>x</italic>-axis shows values of the different metrics, <italic>y</italic>-axis displays evaluated co-expression methods.</p></caption><graphic xlink:href="41467_2022_29497_Fig3_HTML" id="d32e812"/></fig><fig id="Fig4"><label>Fig. 4</label><caption><title>Characterization of genes with co-Differential isoform usage.</title><p><bold>a</bold> Cluster-based definition of Differential Isoform Usage (DIU) across multiple cell types. DIU genes have at least two isoforms assigned to different clusters, indicating a differential isoform selection pattern across the different cell types. <bold>b</bold> Definition of co-Differential Isoform Usage (coDIU) using clusters. CoDIU genes have multiple isoforms assigned to the same clusters, establishinig across-cell type co-expression relationships for at least two of their isoforms. <bold>c</bold> coDIU network. Nodes represent clusters and depict their mean expression profile across cell types. Node color represents cluster size (i.e., no. of isoforms in cluster). Edge width represents number of coDIU genes detected between each pair of clusters. coDIU genes are considered if they have at least one significant isoform co-expression pattern with one other gene. <bold>d</bold> Evaluation of cluster profile similarity and size as a function of the number of coDIU genes detected by <italic>acorde</italic>. <italic>X</italic>-axis corresponds to the sum of isoforms in each possible pair of clusters generated from the data. <italic>Y</italic>-axis contains the number of coDIU genes between the pair. Dot color represents the correlation between the mean expression profiles of each pair of clusters. The number of coDIU genes between a pair of clusters is seemingly related to the size of the clusters involved, and shows no relationship with the degree of similarity between the expression profiles of clustered isoforms. <bold>e</bold> Cell type-level coDIU patterns. For each pair of cell types represented in <italic>x</italic> and <italic>y</italic>-axis, heatmap color corresponds to the total number of genes found to be co-DIU between them. Total coDIU genes are calculated as the sum of coDIU genes detected between all cluster pairs that show high expression of isoforms in these cell types. GABA and Glut cell types share the highest number of coDIU genes, both with each other and with other cell types. Astr: astrocytes, End: endothelial cells, GABA: GABA-ergic neurons, Glut: glutamatergic neurons, Micr: microglia, Oligo: oligodendrocytes, OPC: oligodendrocyte precursor cells.</p></caption><graphic xlink:href="41467_2022_29497_Fig4_HTML" id="d32e853"/></fig></p>
    </sec>
    <sec id="Sec6">
      <title>Co-Differential Isoform Usage analysis of single-cell isoform expression</title>
      <p id="Par19">Isoform clusters represent groups of alternative transcripts that are co-expressed at the cell type level. However, our clustering results did not provide information on iso-transcriptome properties associated with splicing regulation. To facilitate interpretation of the isoform clustering results, we first defined genes with DIU as those whose isoforms were assigned to different clusters (Fig. <xref rid="Fig4" ref-type="fig">4a</xref>). ~23% of total analyzed genes (2017 out of 8814) and 75% of genes with clustered isoforms (total = 2696) were positive for DIU, involving 5278 clustered isoforms. In this context, DIU genes will necessarily have two or more isoforms with significant changes in expression across cell types and simultaneously undergo cell type-dependent post-transcriptional regulation, leading to changes in isoform expression in each cell type.</p>
      <p id="Par20">In order to study isoform co-expression patterns, we defined coDIU genes as those showing coordinated cell-type-specific isoform usage. Specifically, we considered two or more genes to be coDIU if their isoforms had been assigned to the same clusters (Fig. <xref rid="Fig4" ref-type="fig">4b</xref>, “Methods”). This resulted in the definition of an isoform co-splicing network, where nodes were clusters of correlated isoforms and edges represented coDIU genes, i.e., the number of genes for which two or more isoforms are co-expressed across cell types (Fig. <xref rid="Fig4" ref-type="fig">4c</xref>, “Methods”). To ensure the reliability of the detected coDIU patterns, a generalized linear model (GLM) was fitted for every pair of coDIU genes; selecting pairs that showed significant cluster-dependent expression variation across cell types and no significant changes in expression when only accounting for gene-level expression (see “Methods”). CoDIU genes therefore present cell type-dependent co-expression of at least two isoforms, represented by cluster assignment matches, but are not co-expressed when only gene expression is considered. Using this strategy, 1784 genes with at least one significant coDIU partner (<italic>cluster*cell-type</italic> FDR &lt; 0.05, <italic>gene</italic>*<italic>cell-type</italic> FDR &gt; 0.05) were detected, involving 5274 co-expressed isoforms. The number of coDIU genes sharing isoforms across each cluster pair was variable, although it rose up to &gt;130 for highly connected clusters (Fig. <xref rid="Fig4" ref-type="fig">4c</xref>).</p>
      <p id="Par21">We then interrogated the coDIU network to find patterns underlying the splicing coordination signal detected by the <italic>acorde</italic> pipeline. First, in order to measure whether coDIU generated strong or subtle variations in isoform selection across cell types, we investigated the association of coDIU to single or multiple cell type isoform switching events. Note that single isoform switching events involve clusters with patterns that are similar across all cell types except one, leading to high between-cluster correlations. Interestingly, we found that the number of coDIU genes linking isoform co-expression clusters was dependent on cluster sizes, but showed no direct relationship with the similarities between expression profiles (Fig. <xref rid="Fig4" ref-type="fig">4d</xref>). The detection of coDIU genes involving isoforms with highly different expression patterns suggested that coordinated isoform usage is able to produce strong cell type-level shifts in isoform selection.</p>
      <p id="Par22">We next evaluated the cell type-level relationships in the isoform co-expression network, namely the occurrence of coDIU across all possible pairs of cell types in our data. Although co-splicing could potentially occur between any combination of cell types, results showed that a high proportion of coDIU interactions were detected when the isoforms involved had high expression in one of the two neural cell types, i.e., GABA-ergic and glutamatergic neurons (Fig. <xref rid="Fig4" ref-type="fig">4e</xref>). This can be partially explained by the fact that some of the clusters with neuron expression are among the largest generated by the <italic>acorde</italic> pipeline (Fig. <xref rid="Fig4" ref-type="fig">4c</xref>). However, another plausible explanation is that the central role of neurons in the tissue under study (i.e., primary visual cortex) might situate co-splicing at the core of neural function regulation, as well as the modulation of its interaction with glial cell types.</p>
    </sec>
    <sec id="Sec7">
      <title>Functional analysis of the coDIU network</title>
      <p id="Par23">We next set out to investigate the functional implications of our isoform co-expression network. Since, with a few exceptions<sup><xref ref-type="bibr" rid="CR60">60</xref>,<xref ref-type="bibr" rid="CR61">61</xref></sup>, splicing analysis tools rarely integrate functional information, we annotated the long read-defined transcripts using IsoAnnotLite (<ext-link ext-link-type="uri" xlink:href="https://isoannot.tappas.org/isoannot-lite/">https://isoannot.tappas.org/isoannot-lite/</ext-link>). The resulting functional annotation included both transcript and protein-level motifs, sites, and domains, as well as non-positional, gene-level features such as Gene Ontology (GO) terms. A detailed description of the annotation process and a comprehensive list of functional categories and source databases are available in <xref rid="MOESM1" ref-type="media">Supplementary Note</xref>.</p>
      <p id="Par24">First, we analyzed which biological processes and gene functions were potentially controlled by DIU (AS-regulated) and coDIU (co-regulated) mechanisms, that is, which gene functionalities were overrepresented in the DIU and coDIU sets. In order to discriminate the functional properties of AS-regulated genes from those showing no cell type specificity in isoform expression, we performed a functional enrichment test for DIU genes vs genes with DE isoforms, which were used as the background (Supplementary Fig. <xref rid="MOESM1" ref-type="media">14</xref>, see “Methods”). Interestingly, DIU genes showed significant enrichment (FDR &lt; 0.05) in GO terms associated with gene expression regulation, including general mechanisms (nucleic acid metabolic process) and processes related to both DNA (DNA metabolic process) and RNA metabolism (RNA metabolism). In addition, genes annotated as participating in protein-complex mechanisms required for these processes (protein-containing complex) were found to be significantly overrepresented in the DIU group. Remarkably, functional enrichment revealed that DIU genes were enriched in binding sites for miR-412-3p. Even though extant literature includes no functional roles for this miRNA in the brain, miR-412-3p has been found to interact with Mbnl1-AS1<sup><xref ref-type="bibr" rid="CR62">62</xref></sup>, a long non-coding RNA that is also an antisense isoform of Mbnl1, which is an important splicing regulator in the neural context<sup><xref ref-type="bibr" rid="CR63">63</xref>–<xref ref-type="bibr" rid="CR65">65</xref></sup>. We speculate that differential inclusion of miR-412-3p binding sites in the isoforms of coDIU genes might be related to additional regulatory roles of this miRNA in neural cell types.</p>
      <p id="Par25">Next, in order to investigate the cellular processes where coDIU could potentially have a relevant regulatory role, we compared the proportion of coDIU and DIU genes annotated for each functional feature in the transcriptome using a partially-overlapping samples z test<sup><xref ref-type="bibr" rid="CR66">66</xref></sup> (see “Methods”). In total, 91 positional functional features and 59 GO terms were found to be annotated in a significantly higher proportion in coDIU vs DIU genes (FDR &lt; 0.05, Supplementary Data <xref rid="MOESM5" ref-type="media">1</xref>). Given the extensive list of significant features obtained, we focused on the most relevant set of features for visualization and interpretation purposes (Fig. <xref rid="Fig5" ref-type="fig">5a, b</xref>). Full results, however, are available in Supplementary Data <xref rid="MOESM5" ref-type="media">1</xref>. First, to remove redundant functionalities, GO terms were filtered by semantic similarity using Revigo<sup><xref ref-type="bibr" rid="CR67">67</xref></sup> (see “Methods”, Fig. <xref rid="Fig5" ref-type="fig">5a</xref>), resulting in 26 unique terms. Among them, and similarly to DIU genes, coDIU genes showed significant enrichment (FDR &lt; 0.05) in functionalities related to specific aspects of transcriptional regulation (regulation of nitrogen compound metabolic process, regulation of transcription by RNA polymerase II, Fig. <xref rid="Fig5" ref-type="fig">5a</xref>, Supplementary Data <xref rid="MOESM5" ref-type="media">1</xref>). However, genes that were positive for coDIU were also significantly associated with signaling mechanisms (protein kinase activity, protein phosphorylation, signal transduction), membrane transport and cell-to-cell communication (transmembrane signaling receptor activity, cell communication, regulation of response to stimulus), and metabolism (carboxylic acid biosynthetic process, cellular macromolecule catabolic process, lipid metabolic process). Remarkably, coDIU genes showed additional enrichment for post-trancriptional processes and functionalities such as RNA binding and translation. This result links genes participating in RNA metabolism with the coordination of AS, and suggests that the co-expression of alternative isoforms may contribute to the fine-tuning of post-transcriptional regulatory processes. Regarding positional functional features, coDIU genes presented a significantly higher proportion of miRNA binding, 3′UTR and upstream Open Reading Frame (uORF) motifs (FDR &lt; 0.05, Fig. <xref rid="Fig5" ref-type="fig">5b</xref>) as well as several predicted protein elements such as post-translational modifications (PTMs), nuclear localization signals (NLS) and transmembrane domains. These motifs and domains exert a broad variety of roles, including interactions with regulators (e.g., 3′UTR motifs), mRNA turnover control (e.g., uORFs), and protein-specific localization (e.g., NLS, transmembrane), indicating the potential of coDIU to create functional synergies via the co-inclusion of specific domains and motifs in an isoform-specific manner.<fig id="Fig5"><label>Fig. 5</label><caption><title>Functional analysis of DIU and coDIU genes.</title><p><bold>a</bold> Gene Ontology (GO) Functional Enrichment results for co-Differential isoform Usage (coDIU) vs genes with Differential Isoform Usage (DIU) of isoforms. Only terms obtained after Revigo filtering are shown. <italic>x</italic> and <italic>y</italic>-axis indicate semantic similarity, as defined by Revigo (see “Methods”). Dot size represents total coDIU genes annotated for each GO term. Dot color represents significance, i.e., −log10(adjusted <italic>p</italic>-value). <bold>b</bold> Functional Enrichment of positional features for coDIU vs DIU genes. <italic>x</italic>-axis indicates the total number of coDIU genes including the tested annotation feature, <italic>y</italic>-axis shows functional features. Dot color represents the functional category (i.e., annotation source database) and dot size represents −log(adjusted <italic>p</italic>-value). <bold>c</bold> Schematic representation of tappAS’ Functional Diversity Analysis (FDA). The genomic position and present/absence criteria, both of which can be used to detect functional variation among isoforms from the same gene (i.e., label the gene as <italic>varying</italic>), are depicted. <bold>d</bold> FDA results for DE isoform, DIU, and coDIU genes. <italic>y</italic>-axis shows transcript and protein functional categories (see <xref rid="MOESM1" ref-type="media">Supplementary Note</xref> for category definition information). <italic>x</italic>-axis shows the percentage of genes including at least one feature annotation from each of the categories that are detected as functionally <italic>varying</italic>. Both FDA criteria are shown (position: left grid column, presence: right grid column). CoDIU genes show the largest level of functional variation.</p></caption><graphic xlink:href="41467_2022_29497_Fig5_HTML" id="d32e1026"/></fig></p>
      <p id="Par26">To further explore the potential of domain-including (or excluding) isoform co-expression across neural cell types, we performed a Functional Diversity Analysis (FDA, Fig. <xref rid="Fig5" ref-type="fig">5c</xref>). FDA is part of the tappAS framework<sup><xref ref-type="bibr" rid="CR61">61</xref></sup>, and identifies functionally <italic>varying</italic> genes, i.e., genes expressing transcript variants with differences in the inclusion of functional features (see “Methods”). FDA can be evaluated from a presence/absence standpoint (i.e., AS completely removes a feature), or by detecting variation in the transcriptomic positions defining the feature (Fig. <xref rid="Fig5" ref-type="fig">5c</xref>). We, therefore, compared the diversity in transcript-level functional features between DIU, coDIU genes, and genes with more than one DE isoform, for all functional categories provided by IsoAnnotLite (Fig. <xref rid="Fig5" ref-type="fig">5d</xref>). Interestingly, we observed that the percentage of <italic>varying</italic> genes increased with isoform expression complexity, with coDIU resulting in the largest amount of feature inclusion diversity in virtually all protein and transcript feature categories. To measure this effect, we compared the percentages of variation for all pairwise combinations of the three gene sets (paired samples t-test, see “Methods”) and confirmed the observed trend, regardless of whether the variability criteria employed (position/presence). In particular, even though nearly all comparisons were significant, coDIU resulted in the most significant increase in feature variation (coDIU vs DE isoform genes <italic>p</italic>-value: presence = 1.14e−03, position = 8.92e−04; coDIU vs DIU genes <italic>p</italic>-value: presence = NS, position = 2.04e−03). We verified that this increase in functional diversity was not associated to expression level or isoform length biases in coDIU genes (Supplementary Fig. <xref rid="MOESM1" ref-type="media">15a, b</xref>). This result suggests that alternative isoforms that engage in co-expression relationships tend to alter their functional properties significantly more often than other transcripts, namely by changing the inclusion of motifs, sites and/or domains, thereby coupling AS and isoform co-expression with functional potential.</p>
    </sec>
    <sec id="Sec8">
      <title>Functional analysis of neuron-oligodendrocyte isoform co-expression</title>
      <p id="Par27">To further understand the relationship between cell-type identity, isoform co-expression, and the functional properties of coDIU genes, we searched the coDIU network for cluster groups representing biologically-related isoform switches between neural cell types. Namely, we focused on a set of 118 coDIU genes (Fig. <xref rid="Fig4" ref-type="fig">4c</xref>) containing isoforms with higher relative expression in oligodendrocytes (cluster 14), neurons (GABA and Glutamatergic neuron cell types, cluster 1) or both (cluster 4, Fig. <xref rid="Fig6" ref-type="fig">6a</xref>) and analyzed isoform-associated functional variability using FDA (Fig. <xref rid="Fig6" ref-type="fig">6b</xref>). For this set of alternative isoforms, 3′UTR length showed the highest variation rate among annotated transcript-level functional categories (<italic>varying</italic> in ~70% genes, Fig. <xref rid="Fig6" ref-type="fig">6b</xref>). Moreover, we noticed that these changes followed a clear cell type-specific pattern, with the majority of coDIU genes showing higher relative expression of their longest 3′UTR isoforms in neurons (Supplementary Fig. <xref rid="MOESM1" ref-type="media">16a</xref>) and neural-specific isoforms generally expressing longer 3′UTRs than their oligodendrocyte-expressed counterparts (Fig. <xref rid="Fig6" ref-type="fig">6c</xref>).<fig id="Fig6"><label>Fig. 6</label><caption><title>Functional analysis of the 118 coDIU genes detected across neural-oligodendrocyte clusters (no. 1, 4, and 14).</title><p><bold>a</bold> Cell type expression patterns of clusters selected for downstream functional analysis: neural (cluster 1, green), oligodendrocyte (cluster 14, orange) or shared (cluster 4, purple). For each cluster, cell-level mean expression (scaled) is computed for all transcripts, and cell means are aggregated to obtain a global cell type mean, represented by the lines. Colored areas correspond to cell type mean ± standard deviation. <bold>b</bold> Functional Diversity Analysis (FDA) results. <italic>y</italic>-axis: functional annotation categories. <italic>x</italic>-axis: percentage of genes including at least one <italic>varying</italic> feature from a given functional category. <bold>c</bold> Violin and boxplots of normalized 3′UTR lengths for isoforms in each of the three neural-oligodendrocyte clusters (<italic>n</italic> = 177 transcript isoforms from coDIU genes with 3′UTR variability). Normalized lengths are computed by dividing each individual isoform’s 3′UTR length by the sum of 3′UTR lengths of all the gene’s isoforms. Violin plots indicate density distributions. For boxplots, boxes indicate median (middle line), 25th (Q1) and 75th (Q3) percentiles (box hinges); whiskers represent min = Q1 − 1.5 · Interquartile Range (IQR) and max = Q3 + 1.5 · IQR; dots constitute outliers. Significance levels for the comparison of the three groups are indicated above the corresponding braces (<italic>p-</italic>value, Wilcoxon’s test, two-sided). NS: not significant. tappAS view of <bold>d</bold>
<italic>Lrif1</italic> and <bold>e</bold>
<italic>Stau2</italic> protein annotations. Cluster assignments for each isoform are indicated by dot color.</p></caption><graphic xlink:href="41467_2022_29497_Fig6_HTML" id="d32e1131"/></fig></p>
      <p id="Par28">Next, we inspected several 3′UTR-related functional categories (repeat regions, miRNA binding, and 3′UTR motifs) using ID-level FDA (see “Methods”, Supplementary Fig. <xref rid="MOESM1" ref-type="media">16b</xref>) to identify specific functional features associated to isoform usage differences between neurons and oligodendrocytes. Regarding the presence of miRNA binding sites, in spite high varyiation rates, no specific miRNA motif was shared by more than ~10% of genes (maximum of 12 out of 118 genes for miR-495-3p), while some repeats, such as (GT)n, were present in ~25% of coDIU genes across the three clusters with varying rates &gt;50%. Nevertheless, in the case of 3′UTR motifs, we found that Musashi binding motifs presented inclusion changes in ~60% of annotated coDIU genes (Supplementary Fig. <xref rid="MOESM1" ref-type="media">16b</xref>). The Musashi protein is known to be a neural RNA-binding protein that participates in translational control, regulating cell fate and cell cycle<sup><xref ref-type="bibr" rid="CR68">68</xref>,<xref ref-type="bibr" rid="CR69">69</xref></sup>. In line with this, the coDIU network included several genes in which 3′UTR elongation led to neuron-specific co-inclusion of Mushashi binding elements, including kinase-encoding genes <italic>Ppip5k1</italic> (diphosphoinositol pentakisphosphate kinase 1, Supplementary Fig. <xref rid="MOESM1" ref-type="media">17a</xref>) and <italic>Prkcz</italic> (protein kinase C zeta type, Supplementary Fig. <xref rid="MOESM1" ref-type="media">17b</xref>). These results align with the previously shown enrichment of signaling and translation-related genes within the coDIU network (Fig. <xref rid="Fig5" ref-type="fig">5a</xref>) and hints that co-expression of Musashi-binding isoforms may generate 3′ UTR binding-mediated changes in the translation of proteins participating in different signaling pathways.</p>
      <p id="Par29">Importantly, the majority of neuron-oligodendrocyte coDIU genes also presented frequent coding region variation (i.e., CDS, Fig. <xref rid="Fig6" ref-type="fig">6b</xref>), revealing that coordinated isoform usage can modify both transcript and protein functional properties. In particular, protein domains (PFAM) and post-translational modifications (PTMs) presented high variation rates (<italic>varying</italic> in ~30% of genes containing the feature, Fig. <xref rid="Fig6" ref-type="fig">6b</xref>) and thus constituted the categories with the most cell type-dependent functional variation. While ID-FDA reported no specific PFAM domains shared among the analyzed gene set (~1%, maximum of 2 out of 118), up to ~10% of them presented inclusion variation in similar PTMs (12 out of 118) with medium to high variation rates for phosphorylation, acetylation and ubiquitination (Supplementary Fig. <xref rid="MOESM1" ref-type="media">16b</xref>). However, synergies between PTM and domain inclusion changes could still result in differential functional activities at the protein level. As an example, we found two genes involved in different aspects of RNA metabolism, <italic>Lrif1</italic> (ligand-dependent nuclear receptor interacting factor, Fig. <xref rid="Fig6" ref-type="fig">6d</xref>) and <italic>Stau2</italic> (Staufen RNA binding protein homolog, Fig. <xref rid="Fig6" ref-type="fig">6e</xref>), both of which present cell type-level domain inclusion associated to coordinated changes in the expression of alternative protein isoforms. In humans, <italic>Lrif1</italic> has been shown to interact with a number of nuclear receptors, including retinoic acid receptors, to suppress the ligand-mediated transcriptional activator role of these proteins<sup><xref ref-type="bibr" rid="CR70">70</xref></sup>. This interaction occurs at the N-terminal end, which presents differential inclusion of several protein motifs and domains among <italic>Lrif1</italic> isoforms. Specifically, two <italic>Lrif1</italic> isoforms that are depleted in oligodendrocytes present inclusion of a coiled/disordered region as well as binding and phosphorylation sites (Fig. <xref rid="Fig6" ref-type="fig">6d</xref>), which may be connected to a specific transcriptional regulation role in mouse neuron cells. Also regarding the neural-related functionality of these genes, the rat homolog of <italic>Stau2</italic> is known to have a role in mRNA transport from the nucleus to neuron dendrites<sup><xref ref-type="bibr" rid="CR71">71</xref></sup>. In our system, <italic>Stau2</italic> isoforms upregulated in oligodendrocytes show a C-terminal Staufen domain that is not included in neural-specific isoforms (Fig. <xref rid="Fig6" ref-type="fig">6e</xref>) and is responsible for Staufen dimerization in humans<sup><xref ref-type="bibr" rid="CR72">72</xref></sup>. On the other hand, one of the neuron-expressed isoforms includes an extra N-terminal RNA binding domain. Differences among <italic>Stau2</italic> isoforms may be connected to a dual role for this protein in neurons and glia in which enhanced RNA binding activity is required in neurons, while Staufen dimers may be more likely to form in oligodendrocytes. However, further analyses and validation experiments are required to confirm these findings and reveal additional coordination of domain inclusion changes for genes involved in differential RNA processing between neurons and glial types.</p>
      <sec id="Sec9">
        <title>Analysis of coDIU in GABA-ergic neuron subtypes</title>
        <p id="Par30">In order to showcase the applicability of the <italic>acorde</italic> pipeline and test its performance under high-granularity conditions, we analyzed isoform expression in the primary visual cortex among 5 GABA-ergic neuron subtypes (Lamp5, Pvalb, Sncg, Sst, Vip, 4921 total cells post-QC) defined in another recent study by Tasic et al.<sup><xref ref-type="bibr" rid="CR44">44</xref></sup> (hereby referred to as Tasic 2018 dataset). Remarkably, quantification of isoform expression using the previously-defined long read transcriptome (see <xref rid="MOESM1" ref-type="media">Supplementary Note</xref>) resulted in no large transcriptomic differences among the subtypes, as revealed by UMAP<sup><xref ref-type="bibr" rid="CR73">73</xref></sup> dimension reduction (Supplementary Fig. <xref rid="MOESM1" ref-type="media">18a</xref>), with Pvalb neurons showing the largest differences with the rest of the cell types. Accordingly, DE analysis between the five groups only returned 568 significantly DE isoforms (FDR &lt; 0.05, fold-change &gt; 1.5, see “Methods”), which make up only ~4% of all isoforms included in the analysis (13870 isoforms remaining post-QC). Using percentile correlations, DE isoforms were grouped in 171 small clusters, which were then merged into 5 distinct expression profiles (Supplementary Fig. <xref rid="MOESM1" ref-type="media">18b</xref>) using dynamic hierarchical clustering (see “Methods”). The largest among the 5 clusters contained those isoforms with higher relative expression in Pvalb neurons (cluster 2, 184 isoforms, Supplementary Fig. <xref rid="MOESM1" ref-type="media">18b</xref>), in agreement with the global data structure (Supplementary Fig. <xref rid="MOESM1" ref-type="media">18a</xref>).</p>
        <p id="Par31">DIU and coDIU relationships encoded by these co-expressed isoform modules were next investigated. We found 22 DIU genes among the 5 clusters, 16 of which presented significant coDIU relationships with at least one other gene (see “Methods”), involving 36 isoforms in total. In line with the clustering and UMAP results (Supplementary Fig. <xref rid="MOESM1" ref-type="media">18a, b</xref>), most isoforms participating in coDIU relationships presented higher relative expression in Pvalb neurons (Supplementary Fig. <xref rid="MOESM1" ref-type="media">18c</xref>). We, therefore, decided to explore the functional features that varied among coDIU genes that had isoforms in the Pvalb expression cluster. Remarkably, two of the detected coDIU genes were membrane-associated proteoglycans <italic>Gpc1</italic> and <italic>Tmeff2</italic>, which have been described to have neuronal function in previous studies<sup><xref ref-type="bibr" rid="CR74">74</xref>,<xref ref-type="bibr" rid="CR75">75</xref></sup>. These genes presented coordinated switches in isoform expression in the Pvalb (cluster 1) and Scng (cluster2) subtypes (Supplementary Fig. <xref rid="MOESM1" ref-type="media">18d</xref>) as well as cell type-specific changes in the functional properties of their isoforms. Namely, <italic>Gpc1</italic> presented Pvalb-specific increase in expression of a signal peptide-including isoform (Supplementary Fig. <xref rid="MOESM1" ref-type="media">18e</xref>). Meanwhile, for <italic>Tmeff2</italic>, Pvalb-expressed isoforms were missing the C-terminal end, which included the transmembrane domain of the protein and several glycosylation sites (Supplementary Fig. <xref rid="MOESM1" ref-type="media">18f</xref>). Even though these -and other similar results shown in this manuscript- would require further validation, they serve to illustrate the potential of <italic>acorde</italic> to uncover candidates for functionally-relevant isoform co-expression relationships.</p>
        <p id="Par32">Of note, the low number of clusters and DIU/coDIU genes detected by the <italic>acorde</italic> pipeline in this dataset, explained by the high isoform expression homogeneity among GABA cell subtypes, precluded the generation of more comprehensive functional results. Even so, we strongly believe that all in all, these analyses demonstrate that <italic>acorde</italic> can be used to study isoform co-expression even in untoward scenarios, making a case for its usability in datasets with less well-defined cell types or lower signal-to-noise ratio.</p>
      </sec>
    </sec>
  </sec>
  <sec id="Sec10" sec-type="discussion">
    <title>Discussion</title>
    <p id="Par33">AS is known to be a tightly-regulated process in which splicing factors interact to create cell-type-specific isoform expression patterns<sup><xref ref-type="bibr" rid="CR76">76</xref></sup>. The transcriptome-level consequences of AS regulation have been studied in different ways, including, but not limited to, the detection of within-isoform coordination of alternative sites<sup><xref ref-type="bibr" rid="CR40">40</xref>,<xref ref-type="bibr" rid="CR41">41</xref></sup>, the generation of gene-isoform networks to uncover regulatory relationships<sup><xref ref-type="bibr" rid="CR77">77</xref>–<xref ref-type="bibr" rid="CR80">80</xref></sup> and the application of single-cell data to unravel cell type-specific expression patterns for same-gene isoforms<sup><xref ref-type="bibr" rid="CR27">27</xref>,<xref ref-type="bibr" rid="CR81">81</xref></sup>. However, the extent to which AS regulation creates co-expression patterns among alternative isoforms from different genes has not yet been fully addressed. Specifically, previous studies tackling this type of isoform co-expression have either focused on specific event types, such as alternative 3′ exons<sup><xref ref-type="bibr" rid="CR82">82</xref></sup>, or solely on the identification of functionally-relevant alternative isoforms in different biological contexts<sup><xref ref-type="bibr" rid="CR83">83</xref>,<xref ref-type="bibr" rid="CR84">84</xref></sup>.</p>
    <p id="Par34">In this study, we presented <italic>acorde</italic>, an end-to-end pipeline to generate isoform co-expression networks and detect genes with coDIU, and applied it to the study of isoform co-expression among seven neural broad cell types<sup><xref ref-type="bibr" rid="CR43">43</xref></sup> and five GABA-ergic neuron subtypes from an independent dataset<sup><xref ref-type="bibr" rid="CR44">44</xref></sup>. To this end, we leveraged single-cell data by implementing percentile correlations, a metric designed to overcome single-cell noise and sparsity and provide high-confidence estimates of isoform-to-isoform correlation. Here, we show that percentile-summarized Pearson correlations outperform both classic and single-cell specific correlation strategies<sup><xref ref-type="bibr" rid="CR57">57</xref></sup>, including proportionality methods that were recently proposed as one of the best alternatives to measure co-expression in single-cell data<sup><xref ref-type="bibr" rid="CR42">42</xref></sup>. In addition, using a long read-defined, functionally annotated transcriptome enabled us to obtain a biological readout from the isoform network. coDIU genes were found to be enriched in the same biological functions, a number of which were unique in comparison to enrichment results for genes solely reported as DIU. Inter-gene isoform co-expression thus appears to impact a subset of DIU genes sharing specific sets of functions, which suggests that coDIU may contribute with an additional layer of complexity to some cellular processes, operating as a fine-tuning mechanism. Our analyses also revealed that isoforms from coDIU genes encompass higher functional diversity than those belonging to DIU genes, an effect that was not associated to expression or length differences. Importantly, these changes impact both transcript and protein isoform functional features, which pinpoints their ability to globally increase the functional repertoire of coDIU genes. Mechanisms generating isoform co-expression can therefore be thought of as a potential source of functional synergies between alternatively spliced genes, giving rise to simultaneous changes in functional properties among co-expressed isoforms.</p>
    <p id="Par35">To demonstrate the power of the <italic>acorde</italic> pipeline, we include examples from both neural datasets where these kinds of coordinated changes were detected. First, we report a neural-specific pattern of 3′UTR co-elongation that is consistent with the available literature<sup><xref ref-type="bibr" rid="CR85">85</xref>,<xref ref-type="bibr" rid="CR86">86</xref></sup> and results in a simultaneous increase in the number of repeats, Musashi binding elements, and miRNA binding sites in these UTRs. In addition, we describe cell-type-specific co-expression of kinase isoforms that creates divergent functional properties among them, which points to a splicing-mediated coordination of signaling pathways. On a broader note, an interesting finding stemming from our functional analyses concerns the diversity of biological properties that make up the functional signal of the coDIU network. Namely, we found coDIU genes to be involved in a wide array of biological processes and showed how joint changes in isoform expression across cell types can result in the differential inclusion of features from a wide variety of functional categories. These diverse, complex results suggest that AS and post-transcriptional regulation mechanisms can modify the presence of a large variety of functional features in co-expressed isoforms, which may potentially contribute to modulate key cell-level processes encoding cell-type identity. While these insights need to be subject to further experimental validation, they serve to illustrate the hypothesis-generating power of our pipeline.</p>
    <p id="Par36">All in all, we have hereby shown that <italic>acorde</italic> can effectively be used to leverage single-cell RNA-seq data to build isoform co-expression networks, providing tools for the exploration of the post-transcriptional regulation of gene expression from an innovative standpoint, including the disclosure of the cellular processes and functional properties impacted by these mechanisms.</p>
  </sec>
  <sec id="Sec11">
    <title>Methods</title>
    <sec id="Sec12">
      <title>Single-cell data pre-processing and quality control</title>
      <p id="Par37">Mouse neural single-cell RNA-Seq data from mouse primary visual cortex was obtained from Tasic et al.<sup><xref ref-type="bibr" rid="CR43">43</xref></sup> and consists in paired-end Illumina reads generated with the Smart-seq2 protocol<sup><xref ref-type="bibr" rid="CR87">87</xref></sup>, which enables isoform-level quantification. Reads were downloaded from Sequence Read Archive accession SRP061902 (<ext-link ext-link-type="uri" xlink:href="https://www.ncbi.nlm.nih.gov/sra?term=SRP061902">https://www.ncbi.nlm.nih.gov/sra?term=SRP061902</ext-link>) and mapped to the mouse genome (GRCm38.p6) using STAR<sup><xref ref-type="bibr" rid="CR88">88</xref></sup>. We performed isoform expression quantification of the long read-defined isoforms (see <xref rid="MOESM1" ref-type="media">Supplementary Note</xref> for details on long read transcriptome definition) using RSEM<sup><xref ref-type="bibr" rid="CR89">89</xref></sup>, and used the labels provided by Tasic et al. to assign the 1679 cells to 7 broad cell types: 5 glial (microglia, endothelial cells, oligodendrocytes, oligodendrocyte precursor cells (OPCs) and astrocytes) and 2 neural (GABA-ergic and glutamatergic neurons).</p>
      <p id="Par38">Isoform length effect on expression was evaluated using the <italic>NOISeq</italic> R package<sup><xref ref-type="bibr" rid="CR90">90</xref></sup>, where mean expression showed to be highly correlated with transcript length (adjusted <italic>R</italic><sup>2</sup> = 0.81; <italic>p</italic>-value = 2.2e−16). Using isoform <italic>i</italic> effective length (<italic>l</italic><sub><italic>i</italic></sub>) and cell-level <italic>j</italic> estimated counts (<italic>c</italic><sub><italic>ij</italic></sub>), both output by RSEM and, after testing several alternatives, we devised a custom formula to minimize the impact of length on isoform expression for each isoform <italic>i</italic>:<disp-formula id="Equ1"><label>1</label><alternatives><tex-math id="M1">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${y}_{{ij}}=\frac{{c}_{{ij}}}{\left({10}^{-6}{\sum }_{i=1}^{I}{c}_{{ij}}\right)\sqrt{{10}^{-3}{l}_{i}}}$$\end{document}</tex-math><mml:math id="M2"><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mfenced close=")" open="("><mml:mrow><mml:msup><mml:mrow><mml:mn>10</mml:mn></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>6</mml:mn></mml:mrow></mml:msup><mml:msubsup><mml:mrow><mml:mo mathsize="big">∑</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>I</mml:mi></mml:mrow></mml:msubsup><mml:msub><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced><mml:msqrt><mml:mrow><mml:msup><mml:mrow><mml:mn>10</mml:mn></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:msup><mml:msub><mml:mrow><mml:mi>l</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msqrt></mml:mrow></mml:mfrac></mml:math><graphic xlink:href="41467_2022_29497_Article_Equ1.gif" position="anchor"/></alternatives></disp-formula></p>
      <p id="Par39">The transformed expression value for isoform <italic>i</italic> in cell <italic>j</italic> (<italic>y</italic><sub><italic>ij</italic></sub>) was again tested for length bias and a low correlation was found (adjusted <italic>R</italic><sup>2</sup> = 0.25; <italic>p</italic>-value = 6.84e−8). Next, we inspected the library size distribution and filtered both high and low-count outliers due to potential premature cell death or library preparation duplets, with a total of 1591 cells passing quality control. Feature-level quality control was performed in a cell type-aware manner, keeping isoforms that showed non-zero expression in at least 25% of one cell type. Out of the 36,986 isoforms and 12,692 genes in the PacBio-defined transcriptome, we retained 16,240 isoforms and 8814 genes for downstream analysis.</p>
    </sec>
    <sec id="Sec13">
      <title>Differential expression (DE) across multiple groups</title>
      <sec id="Sec14">
        <title>Single-cell DE analysis</title>
        <p id="Par40">DE analysis among the 7 cell types was performed by combining ZinBWaVE weights<sup><xref ref-type="bibr" rid="CR48">48</xref></sup> and bulk-designed DE methods edgeR<sup><xref ref-type="bibr" rid="CR50">50</xref></sup> and DESeq2<sup><xref ref-type="bibr" rid="CR49">49</xref></sup> (i.e., using the corresponding R packages), which enable multiple group testing and were among the best-performing methods when combined with the ZinBWaVE method. Briefly, ZinBWaVE calculates cell-level weights for each isoform, effectively downweighting zeros during modeling for DE in single cell data (see van den Berge et al.<sup><xref ref-type="bibr" rid="CR48">48</xref></sup> for details), and hence unlocking bulk RNA-Seq computational methods for single-cell data. Of note, GLM within edgeR and DESeq2 were built and run following the pipeline used by van den Berge et al.<sup><xref ref-type="bibr" rid="CR48">48</xref></sup> to make them suitable for single-cell RNA-seq data, and are implemented in a wrapper function within our R package as described in Eq. <xref rid="Equ2" ref-type="">2</xref>, where <italic>y</italic><sub><italic>ij</italic></sub> is expression of isoform <italic>i</italic> in cell <italic>j</italic>, <italic>T</italic><sub><italic>kj</italic></sub> is a dummy variable which takes value 1 when cell <italic>j</italic> is assigned to cell type <italic>k</italic> (<italic>k</italic> = 1,…,<italic>K</italic>) and 0 otherwise, <italic>β</italic><sub><italic>ki</italic></sub> are the regression coefficients for isoform <italic>i</italic>, <italic>ε</italic><sub><italic>ij</italic></sub> represents the error term, and <italic>h()</italic> is the link function of the GLM (natural logarithm in this case).<disp-formula id="Equ2"><label>2</label><alternatives><tex-math id="M3">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$h\left({y}_{{ij}}\right)={\beta }_{0i}+{\sum }_{k=2}^{K}{\beta }_{{ki}}{T}_{{kj}}+{\varepsilon }_{{ij}}$$\end{document}</tex-math><mml:math id="M4"><mml:mi>h</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msubsup><mml:mrow><mml:mo mathsize="big">∑</mml:mo></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mi>K</mml:mi></mml:mrow></mml:msubsup><mml:msub><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>ε</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:math><graphic xlink:href="41467_2022_29497_Article_Equ2.gif" position="anchor"/></alternatives></disp-formula></p>
        <p id="Par41">DE was defined using a significance threshold of FDR &lt; 0.05 when testing the significance of the model for each isoform <italic>i</italic>, that is, <italic>H</italic><sub><italic>0</italic></sub><italic>: β</italic><sub><italic>2i</italic></sub>
<italic>=… = β</italic><sub><italic>Ki</italic></sub>. Isoforms considered DE were preserved for downstream analysis if detected by at least one of the two methods edgeR or DESeq2, since this indicates a change in expression for any of the cell types considered rather than a flat expression profile.</p>
      </sec>
      <sec id="Sec15">
        <title>Neural cell sampling strategy to select a consensus set of DE isoforms</title>
        <p id="Par42">Prior to DE testing, and to balance sample sizes across cell types, we performed 50 independent runs of random neural cell sampling (without replacement) followed by zero-expression filtering (expression above zero for at least 25% of cells in at least one cell type to control zero abundance among iterations and avoid problems during GLM modeling) and DE testing with edgeR and DESeq2. Specifically, the two neural cell types (GABA-ergic neurons, <italic>n</italic> = 729; glutamatergic neurons, <italic>n</italic> = 711 cells) were downsampled by randomly selecting 45 cells, keeping <italic>N</italic> = 241 cells for multi-group DE testing.</p>
        <p id="Par43">To measure the consistency of each method independently, we calculated the mean and standard deviation of the number of DE isoforms across all same-method sampling runs (<italic>R</italic> = 50). To check the level of within-method agreement, we next considered isoform IDs labeled as DE in each independent method run, and calculated the Jaccard Index (<italic>J</italic><sub><italic>rs</italic></sub>) between DE results of that same method for all possible pairs of random sampling runs <italic>r</italic> and s (<italic>r</italic>,<italic>s</italic> = 1,…,50, <italic>r</italic> &lt; <italic>s</italic>, a total of 1225 comparisons). To summarize this information, we relied on the mean and standard deviation of these two sets of <italic>J</italic><sub><italic>rs</italic></sub> values. Finally, we measured the level of agreement between edgeR and DESeq2 regarding our DE criteria, that is, considering isoforms detected by at least one of the methods to be significantly DE (FDR &lt; 0.05). To achieve this, we calculated the union of DE isoforms between one-to-one pairs of edgeR and DESeq2 runs (<italic>R</italic> = 50), and computed the Jaccard Index between all possible pairwise combination of global DE results, i.e., isoforms detected by at least one method (again, 1225 comparisons).</p>
        <p id="Par44">Using the 50 independent set of DE results, including both edgeR and DESeq2, we set out to define a consensus set of DE isoforms. To maximize sensitivity, we first considered the union of DE isoforms obtained by edgeR and DESeq2 on each of the downsampled versions of the data (<italic>R</italic> = 50), that is, isoforms detected to be significantly DE (FDR &lt; 0.05) by at least one of the applied methods. Among the 50 lists of DE isoforms, those that were significant in at least 50% of the runs were selected. In addition, minor isoforms, i.e., those accumulating less than a 0.1 proportion of the absolute expression of their gene, were filtered. Finally, we retained only isoforms from genes with more than one DE isoform, hence removing cases where no AS-directed, isoform-level co-expression relationships can be established. This sets a general requirement for the entire study, which is that all isoforms retained must have, at all times, at least one same-gene counterpart to establish regulatory relationships that can be based on differential splicing of that gene, given that no AS regulation can be detected if a gene’s total expression is represented by a single isoform.</p>
      </sec>
    </sec>
    <sec id="Sec16">
      <title>Percentile correlation</title>
      <p id="Par45">In order to assess the similarity of isoform expression profiles across cells, a correlation measurement can be used by taking cells as observations. We propose here instead to first summarize the expression within a given cell type with percentiles and then compute the correlation using all cell types and their percentiles as observations, a method that we refer to as “percentile correlation” (see main text Fig. <xref rid="Fig2" ref-type="fig">2a</xref>).</p>
      <p id="Par46">Percentile correlations rely on the assumption that cell-to-cell differences can be mostly attributed to transcriptional stochasticity or technical noise, and that these within-cell type differences have a smaller effect than between-cell type expression differences. However, expression estimates for transcripts within the same cell are biased in different degrees, mostly depending on their expression levels, with lower expression being generally accompanied by higher noise levels<sup><xref ref-type="bibr" rid="CR53">53</xref></sup>. This modifies the extent to which isoforms are affected by noise in each cell and causes strong cell-level effects that prevent the detection of co-expression relationships using solely cell-level measurements. Instead, we set out to target changes in expression across cell groups. We therefore considered isoform expression levels in the different cell types as a range of possible values, defined by the cell-level measurements in the data. In this context, the expression value of an isoform in a cell is used a proxy to infer the underlying distribution of expression values in the cell type, where the shape and width of this distribution will depend on both biological and technical factors.</p>
      <p id="Par47">To translate this into a metric, we first took the expression values of an isoform in each of the cell types and computed a number of percentiles (<italic>p</italic>). We selected <italic>p =</italic> 10 to achieve a good balance between accuracy and computational burden in downstream analysis. As the minimum expression value (percentile 0) was also included, we obtained 11 values representing the expression range within a given cell type. As a result, each isoform will possess a new, recalculated expression vector where the percentile values computed in each cell type will replace cell-level expression estimates. This process was repeated for each isoform. Next, we computed pairwise Pearson correlations between every pair of isoforms, obtaining a percentile correlation matrix <bold>R</bold>. In this context, high correlations will appear if a pair of isoforms shows a similarly broad expression distribution in most cell types, as well as a similar amount of relative expression change between cell types.</p>
    </sec>
    <sec id="Sec17">
      <title>Semi-automated isoform clustering</title>
      <p id="Par48">In order to obtain modules of tightly co-expressed isoforms, we combined the hierarchical clustering algorithm with several rounds of cluster profile refinement (see main text, Fig. <xref rid="Fig2" ref-type="fig">2c</xref>), in order to automate the most intensive steps of clustering while also granting control over the level of aggregation and within-cluster similarity. Clustering and refinement steps can be combined and re-arranged to best capture co-expression patterns within the data, and their parameters can be defined by potential future users to provide maximum flexibility. Functions for clustering and refinement are implemented and documented in the <italic>acorde</italic> R package. Since the package vignette includes code-level details on how these functions work and how were used to generate the results in this manuscript, this section of methods will focus on describing the underlying processes in the package and how they were combined to obtain isoform clusters.</p>
      <sec id="Sec18">
        <title>Dynamic hierarchical clustering</title>
        <p id="Par49">The previously obtained correlation matrix (<bold>R</bold>), where each element <italic>r</italic><sub><italic>ij</italic></sub> represents the Pearson’s correlation coefficient between the percentiles of isoforms (<italic>i</italic>,<italic>j</italic>), was transformed into a distance metric to be used in the hierarchical clustering. As we aimed to cluster positively correlated isoforms given our biological hypothesis, negative correlation values were discarded by replacing them with zero values, and therefore defined the distance between any pair of isoforms <italic>i</italic> and <italic>j</italic> as in Eq. <xref rid="Equ3" ref-type="">3</xref>.<disp-formula id="Equ3"><label>3</label><alternatives><tex-math id="M5">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${d}_{{ij}}=\left\{\begin{array}{c}1-{r}_{{ij}}\;\tt{if}\;\it{r}_{{ij}}\, &gt; \,0\\ 1\;\;\;\;\;\;\;\;\;\tt{if}\;\it{r}_{{ij}} \le 0\end{array}\right\}$$\end{document}</tex-math><mml:math id="M6"><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfenced close="}" open="{"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="center"><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mspace width="0.16em"/><mml:mi>i</mml:mi><mml:mi>f</mml:mi><mml:mspace width="0.16em"/><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mspace width="0.25em"/><mml:mo>&gt;</mml:mo><mml:mspace width="0.25em"/><mml:mn>0</mml:mn></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="center"><mml:mn>1</mml:mn><mml:mspace width="0.16em"/><mml:mspace width="0.16em"/><mml:mspace width="0.16em"/><mml:mspace width="0.16em"/><mml:mspace width="0.16em"/><mml:mspace width="0.16em"/><mml:mspace width="0.16em"/><mml:mspace width="0.16em"/><mml:mspace width="0.16em"/><mml:mi>i</mml:mi><mml:mi>f</mml:mi><mml:mspace width="0.16em"/><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>≤</mml:mo><mml:mn>0</mml:mn></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mfenced></mml:math><graphic xlink:href="41467_2022_29497_Article_Equ3.gif" position="anchor"/></alternatives></disp-formula></p>
        <p id="Par50">Hierarchical cluster analysis was performed using the <italic>hclust()</italic> function in the R <italic>stats</italic> package<sup><xref ref-type="bibr" rid="CR91">91</xref></sup> with the average linkage criterion, and obtained a dendrogram. To obtain clusters, we used the <italic>cutreeHybrid()</italic> function in the <italic>dynamicTreeCut</italic> R package<sup><xref ref-type="bibr" rid="CR56">56</xref></sup> in order to find different thresholds for different branches of the dendrogram tree, instead of using a fixed threshold for the entire dendrogram. The following non-default parameters were provided to the <italic>cutreeHybrid()</italic> function: <italic>deepSplit = 4, pamStage = FALSE, minClusterSize = 20</italic>. Briefly, <italic>deepSplit</italic> ranges between 0 and 4, and provides smaller clusters, more accurate clusters when set to high values. <italic>pamStage</italic> determines whether a second stage of clustering using an algorithm similar to the Partition Around Medoids (PAM) method will be performed after searching the dendrogram for clusters (see Langfelder et al.<sup><xref ref-type="bibr" rid="CR56">56</xref></sup>). As a result of this PAM-like step, no items are left unassigned to clusters, while setting pamStage to FALSE allows unclustered items. Finally, <italic>minClusterSize</italic> determines the minimum size of the produced clusters, and thus passing a higher value to this argument prevents the generation of too many clusters with a very small number of items.</p>
        <p id="Par51">This initial set of clusters is to be used as “hooks” to gather as much expression profile diversity from the data as possible. Importantly, even though our parametrization allows isoforms to remain unassigned to clusters (see above), some isoforms may still show low similarity to their cluster’s profile. To be able to obtain profiles as consistent as possible for downstream refinement, a cluster quality control step was included in <italic>acorde</italic> to remove isoforms based on a minimum correlation threshold with the rest of the members. For our study, isoforms were moved to the unclustered group if they showed a correlation lower than 0.85 with 3 or more isoforms from their cluster. In this manner, only tightly-correlated groups of isoforms will remain clustered.</p>
      </sec>
      <sec id="Sec19">
        <title>Expanding clusters with unassigned isoforms</title>
        <p id="Par52">To re-assign unclustered isoforms to clusters with which they show high correlation, <italic>acorde</italic> allows correlation-based cluster expansion. In this process, each cluster profile is summarized into an average representative transcript, hereby referred to as “metatranscript”. Metatranscripts are calculated as the mean of the percentile-based expression of all isoforms in the cluster. As a result, 11·<italic>K</italic> (<italic>K</italic> being the number of cell types) mean-summarized percentile expression values are obtained, which can be understood as an approximation to the expression range shown by the isoforms from that cluster in each of the cell types. Next, correlations between metatranscripts and unclustered isoforms are computed and unclustered isoforms assigned if they show percentile correlation values above a specified threshold with at least one cluster. In the present study, we set a correlation threshold of 0.9 with at least one cluster, where the maximally correlated cluster was selected as the best match if there were ties.</p>
      </sec>
      <sec id="Sec20">
        <title>Merging clusters by profile similarity</title>
        <p id="Par53">Prioritizing the reduction of within-cluster variability may lead to obtaining a large number of small, redundant clusters (Supplementary Fig. <xref rid="MOESM1" ref-type="media">3a</xref>). To mitigate this effect while also preserving high correlations between cluster members, <italic>acorde</italic> can be used to merge clusters by profile similarity using the percentile correlations between their metatranscripts. For this study, hierarchical clustering was performed on the metatranscript correlation matrix via the <italic>hclust()</italic> function (<italic>stats</italic> R package), subsequently creating clusters with the <italic>cutree()</italic> function (<italic>stats</italic> R package) and a height cutoff of 0.1. Since this merging process may result in joining clusters with highly uncorrelated profiles (Supplementary Fig. <xref rid="MOESM1" ref-type="media">3b</xref>), the cluster expansion process described above was used for the re-assignment of isoforms from clusters that were flagged as inconsistent.</p>
      </sec>
      <sec id="Sec21">
        <title>Recursive assignment of remaining unclustered isoforms</title>
        <p id="Par54">First, extant clusters were filtered again to maximize similarities between members of the same isoform group and generate reliable profiles for expansion. In this case, isoforms were returned to the unclustered group if they had percentile correlation lower than 0.7 with 10 or more isoforms of their cluster. Next, and following the cluster expansion process described above, percentile correlations between the isoforms to be assigned and cluster metatranscripts were computed. In this case, however, assignment was performed as a recursive process, in which (1) isoforms joined a cluster based on percentile correlation with its metatranscript, (2) metatranscripts were re-calculated for the newly expanded clusters, and (3) assignment was performed again for the remaining unclustered isoforms. The percentile correlation thresholds was sequentially lowered from 0.9 to 0.8 and 0.7. Finally, any isoforms remaining unclustered at this point were assigned to the clusters with which they presented maximum correlation. In doing this, unclustered isoform groups were assigned in order, and highly correlated elements therefore contributed to strengthen within-cluster similarities before assigning more lowly correlated elements.</p>
        <p id="Par55">Finally, expanded clusters were merged again to remove remaining redundancies and generate larger clusters for coDIU detection. The strategy and parameters used were similar to those detailed in the section above.</p>
      </sec>
    </sec>
    <sec id="Sec22">
      <title>Co-expression pattern simulation</title>
      <p id="Par56">To validate percentile correlations and our clustering strategy, we evaluated their performance on synthetic data, where co-expression relationships between simulated features need to be pre-defined as part of the data simulation process. However, there is, to the best of our knowledge, no currently available strategy to simulate single-cell data including modules of co-expressed features. We therefore designed our own simulation strategy by combining the <italic>SymSim</italic> R package<sup><xref ref-type="bibr" rid="CR59">59</xref></sup> to adequately model single-cell RNA-Seq data, and a dedicated strategy to generate co-expression between <italic>SymSim</italic> simulated features.</p>
      <p id="Par57">First, we set the following parameters to the <italic>SimulateTrueCounts()</italic> function in <italic>SymSim</italic> in order to obtain a count matrix consisting in 1000 cells from 8 cell types and 8000 features, with sufficient feature-level variation between the different cell groups:</p>
      <p id="Par58"><italic>SimulateTrueCounts(ncells_total = 1000, min_popsize = 100, i_minpop = 1, ngenes = 8000, nevf = 10, n_de_evf = 9, evf_type = “discrete”, phyla = pbtree(n = 7, type = “discrete), vary = “s”, Sigma = 0.25, gene_effect_prob = 0.5, bimod = 0.4, prop_hge = 0.03, mean_hge = 5)</italic>.</p>
      <p id="Par59">Next, we modeled technical effects on these true counts in order to obtain real, observed counts using the <italic>True2ObservedCounts()</italic> function in <italic>SymSim</italic>, with the following parameters:</p>
      <p id="Par60"><italic>True2ObservedCounts(true_counts$counts, meta_cell = true_counts$cell_meta, protocol = “nonUMI”, alpha_mean = 0.1, alpha_sd = 0.005, lenslope = 0, gene_len = rep(1000, nrow(true_counts$counts)), depth_mean = 4e6, depth_sd = 1e4)</italic>.</p>
      <p id="Par61">To create co-expression patterns, we then re-ranked expression values on a cell type-specific manner to define synthetic features, based on the expression profile of 15 pre-defined co-expression modules.</p>
      <p id="Par62">First, we drafted 15 different co-expression profiles reflecting three levels of expression complexity, that is, showing high expression or expression “peaks” in one, two, or three cell groups, respectively. To generate a count matrix reflecting these expression patterns, we shuffled simulated counts to create new, synthetic features. To achieve this, we first re-ranked features in each cell group by mean expression across cells in the group, breaking feature connectivity between the simulated cell types. Then, the top 1400 features from each cell type were selected, together with the bottom 1400 features. In this manner, we obtained high-expression and low-expression count vectors for each group, which we then combined to create synthetic features following the pre-designed cluster’s co-expression pattern. For each cluster, 200 count vectors from top-expression features were assigned to peaking groups, and 200 count vectors form bottom-expression features to cell groups showing low expression. Of note, 1400 features were selected for simulation in order to grant at least 7 different 200-feature groups could be generated for each cell type, where the cell group with the highest-peaking frequency across clusters showed high expression in 6 clusters only.</p>
      <p id="Par63">All in all, we obtained a simulated count matrix containing 1000 cells from 8 cell types and 3000 synthetic features, all of which belong to one of the 15 simulated co-expression modules. Therefore, by breaking feature-level connectivity between cell types, we benefited from feature-specific properties at the cell type level, while re-creating cell type expression coordination patterns that the SymSim strategy was not able to generate. Finally, to ensure the quality of the simulated clusters, we filtered synthetic features if their Pearson correlation with the cluster’s median profile was below 0.75 (Supplementary Fig. <xref rid="MOESM1" ref-type="media">4b</xref>).</p>
    </sec>
    <sec id="Sec23">
      <title>Benchmarking of isoform correlation metrics for scRNA-seq data</title>
      <p id="Par64">Traditional correlation metrics have been shown to perform poorly when applied to scRNA-seq data, mainly given the increased noise and stochasticity levels in this data type. Recently, extensive benchmarks including single cell-tailored metrics have shed light on how to best select correlation metrics for single-cell data (see review by Skinnider et al.<sup><xref ref-type="bibr" rid="CR42">42</xref></sup>). We, therefore, compared the performance of percentile correlations to a representative set of correlation metrics used in single-cell co-expression studies, namely classical Pearson and Spearman correlations, single-cell designed zero-inflated Kendall<sup><xref ref-type="bibr" rid="CR57">57</xref></sup> correlation, and proportionality metric rho (<italic>ρ</italic>)<sup><xref ref-type="bibr" rid="CR58">58</xref></sup>, in agreement with previous reports showing that proportionality metrics were among the best performing co-expression methods in single-cell data. To measure performance, we computed these five co-expression metrics for all the synthetic features in the previously-simulated dataset, generating five different distance matrices for clustering, and evaluated which metric best recapitulated the simulated co-expression modules when used in our clustering pipeline. Pearson and Spearman correlations were computed using the <italic>cor()</italic> function in the R-base <italic>stats</italic> package. Zero-inflated Kendall correlation and rho (<italic>ρ</italic>) were computed using the <italic>dismay()</italic> function in the <italic>dismay</italic> R package<sup><xref ref-type="bibr" rid="CR42">42</xref></sup>.</p>
      <p id="Par65">To make our benchmarking comparable, we adapted our clustering pipeline to remove all non-automated steps and always generate a fixed number of clusters. First, hierarchical clustering was performed on each correlation matrix using <italic>dynamicTreeCut()</italic><sup><xref ref-type="bibr" rid="CR56">56</xref></sup> and the following non-default parameters to maximize granularity: <italic>deepSplit = 4, pamStage = FALSE, minClusterSize = 10</italic>. Of note, we skipped the quality filtering step based on intra-cluster correlations (see isoform clustering section above) to avoid bias against metrics that tend to yield low values when applied to single-cell data. Since we intended to evaluate the number of features remaining unclustered using each metric, we additionally suppressed the unclustered isoform assignment step (see isoform clustering section above). Finally, the merge process was automated by using the traditional hierarchical clustering algorithm (implemented in the <italic>hclust()</italic> function in the R stats package) to group clusters based on the inferred metatranscripts that summarize the cluster’s expression profile (see isoform clustering section above). Finally, we set the number of clusters to 15, i.e., the number of simulated co-expression modules.</p>
      <p id="Par66">In addition to the number of unclustered isoforms, we used the levels of internal correlation in the empirical clusters, i.e., those obtained by de novo clustering of simulated synthetic features, to evaluate the clustering. We did this by jointly considering all pairwise metric values for features within a cluster and measuring the percentage of metrics that are above a threshold value of 0.8. To assess how well empirical clusters recapitulated the co-expression simulation, we paired empirical with simulated clusters using the correlations between their mean cluster profiles. Simulated clusters were therefore paired with the empirical clustering showing maximum profile correlation. We next compared synthetic feature IDs assigned to the obtained and empirical clusters in each pair using the Jaccard Index (JI).</p>
    </sec>
    <sec id="Sec24">
      <title>Differential isoform usage and co-Differential isoform usage across multiple groups</title>
      <sec id="Sec25">
        <title>Defining DIU across multiple groups</title>
        <p id="Par67">Grouping isoforms into different clusters allows the detection of a number of expression patterns across the multiple cell types included in single-cell data. As previously described, we filtered DE isoforms to ensure that all transcripts had at least one other counterpart from the same gene that was also significantly DE. Intuitively, in order for Differential Isoform Usage (DIU) to occur, a gene must first have at least two DE isoforms. However, we only considered a gene to be positive for DIU if (at least) two isoforms were DE and were assigned to different clusters, indicating that two of the gene’s isoforms show different expression patterns across groups (see main text, Fig. <xref rid="Fig4" ref-type="fig">4a</xref>). Ultimately, this can be interpreted as an indicator that isoform expression regulation is cell type-dependent in that gene.</p>
      </sec>
      <sec id="Sec26">
        <title>Detecting co-splicing patterns across isoform clusters: co-Differential isoform usage</title>
        <p id="Par68">We define coordinated splicing patterns as a situation where post-transcriptional regulation, defined by isoform expression, can be detected independently of transcriptional regulation, i.e., gene-level expression. To detect splicing coordination, we defined coDIU as a pattern where a group of genes shows co-expression of their isoforms, but no co-expression can be detected when only gene expression is considered (see main text, Fig. <xref rid="Fig4" ref-type="fig">4b</xref>). In the context of our pipeline, a set of potentially coDIU genes will have at least two of their isoforms assigned to the same clusters, therefore showing detectable isoform-level co-expression, and suggesting coordinated splicing regulation in that group of genes. However, clustering allows expression pattern variability among members, and therefore some isoforms might be assigned to clusters that do not faithfully represent their expression profile, leading to the detection of false-positive coDIU genes.</p>
        <p id="Par69">To identify groups of genes candidates for coDIU, we applied negative-binomial generalized linear regression models. Let <italic>G</italic> be a group of genes, each of them with <italic>I</italic><sub><italic>g</italic></sub> isoforms, where <italic>g</italic> = 1,…,|<italic>G</italic>|. At least one of the isoforms of each gene <italic>g</italic> in <italic>G</italic> must belong to the same cluster <italic>c</italic>, where <italic>c∈</italic> {1,…,<italic>C</italic>} and <italic>C</italic> is the total number of clusters. Let <bold>z</bold> be the expression vector obtained after concatenating the expression vectors <bold>y</bold><sub><bold>i</bold></sub> of each isoform <italic>i</italic> of every gene <italic>g</italic> = 1,…,|<italic>G</italic>|. For the sake of simplicity, let us assume that |<italic>G</italic>| = 2, <italic>I</italic><sub><italic>g</italic></sub> = 2 <italic>∀g</italic>, and consequently <italic>C</italic> = 2. In this case, vector <bold>z</bold> will contain 4<italic>N</italic> elements, where <italic>N</italic> is the total number of cells in the data (<italic>N</italic> = 1591 in our data) and will be the response variable in our regression model. We need to assess if <bold>z</bold> values follow the trend depicted in Fig. <xref rid="Fig4" ref-type="fig">4b</xref>, that is, the average profile across cell types of the two isoforms in cluster 1 must be significantly different to the average profile of the two isoforms in cluster 2. In addition, the average profile of the two isoforms of gene 1 must not be different to the average profile of the two isoforms of gene 2. To identify groups of genes with these characteristics we proposed to fit the regression model in Eq. <xref rid="Equ4" ref-type="">4</xref> and select the group of tested genes as coDIU candidates when having a significant interaction between cluster and cell type effects, and a non-significant interaction between gene and cell type effects.<disp-formula id="Equ4"><label>4</label><alternatives><tex-math id="M7">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$h\left(z\right) = \,	{\beta }_{0}+{\beta }_{1}{G}_{2}+{\beta }_{2}{C}_{2}+{\sum }_{k=2}^{K}{\gamma }_{k}{T}_{k}+{\beta }_{3}{G}_{2}{C}_{2} \\ 	 +{\sum }_{k=2}^{K}{\delta }_{k}{T}_{k}{G}_{2}+{\sum }_{k=2}^{K}{\tau }_{k}{T}_{k}{C}_{2}+\varepsilon$$\end{document}</tex-math><mml:math id="M8"><mml:mi>h</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:mi>z</mml:mi></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:mspace width="0.25em"/><mml:msub><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>G</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msubsup><mml:mrow><mml:mo mathsize="big">∑</mml:mo></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mi>K</mml:mi></mml:mrow></mml:msubsup><mml:msub><mml:mrow><mml:mi>γ</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:mn>3</mml:mn></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>G</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msubsup><mml:mrow><mml:mo mathsize="big">∑</mml:mo></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mi>K</mml:mi></mml:mrow></mml:msubsup><mml:msub><mml:mrow><mml:mi>δ</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>G</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msubsup><mml:mrow><mml:mo mathsize="big">∑</mml:mo></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mi>K</mml:mi></mml:mrow></mml:msubsup><mml:msub><mml:mrow><mml:mi>τ</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mi>ε</mml:mi></mml:math><graphic xlink:href="41467_2022_29497_Article_Equ4.gif" position="anchor"/></alternatives></disp-formula>Where <italic>G</italic><sub><italic>2</italic></sub> and <italic>C</italic><sub><italic>2</italic></sub> are dummy variables indicating whether the expression value corresponds to gene or cluster 2 (value 1) or 1 (value 0), respectively, <italic>T</italic><sub><italic>k</italic></sub> is a dummy variable which takes value 1 when the corresponding cell is assigned to cell type <italic>k</italic> (<italic>k</italic> = 1,…,<italic>K</italic>) and 0 otherwis<italic>e, β</italic><sub><italic>k</italic></sub><italic>, γ</italic><sub><italic>k</italic></sub><italic>, δ</italic><sub><italic>k</italic></sub> and <italic>τ</italic><sub><italic>k</italic></sub> are the regression coefficients, <italic>ε</italic> represents the error term, and <italic>h()</italic> is the link function of the GLM (natural logarithm in this case).</p>
        <p id="Par70">We fitted the GLM model with the glm() function in the R-base package, and the <italic>negative.binomial()</italic> function in the <italic>MASS</italic> R package<sup><xref ref-type="bibr" rid="CR92">92</xref></sup>, with θ = 10. To test the significance level of the <italic>cluster*cell type</italic> and <italic>gene*cell type</italic> interactions, we calculated type-II analysis-of-variance (ANOVA) tables for the model using a likelihood-ratio Χ<sup>2</sup> test, implemented in the <italic>Anova()</italic> function from the <italic>car</italic> R package<sup><xref ref-type="bibr" rid="CR93">93</xref></sup>, since we had an unbalanced design. <italic>P</italic>-values for each of the interactions were separately adjusted using the Benjamini &amp; Hochberg correction. Gene pairs were considered positive for coDIU if FDR adjusted <italic>p-</italic>value &lt; 0.05 for the <italic>cluster*cell type</italic> interaction and FDR adjusted <italic>p-</italic>value &gt; 0.05 for the <italic>gene*cell type</italic> interaction. In other words, we required expression variance across cell types to be a function of the expression profile captured by the clustering, while imposing the additional limitation that aggregating expression by gene must make this effect undetectable. Given that all genes with clustered isoforms will form pairs with all potentially coDIU counterparts and be repeatedly tested, we considered genes to be positive for coDIU if they met the significance criteria in at least one of these pairwise tests.</p>
      </sec>
    </sec>
    <sec id="Sec27">
      <title>Functional analyses</title>
      <p id="Par71">The analyses in this manuscript are based on a long read-defined transcriptome which, after careful quality control and curation of the isoform models, was further annotated using IsoAnnotLite (<ext-link ext-link-type="uri" xlink:href="https://isoannot.tappas.org/isoannot-lite/">https://isoannot.tappas.org/isoannot-lite/</ext-link>) to include positionally-defined functional features in the annotation (see <xref rid="MOESM1" ref-type="media">Supplementary Note</xref>). <italic>Functional features</italic> are grouped in <italic>functional categories</italic> depending on the database from which the information was retrieved and on the biological functions performed by the features (comprehensive list in <xref rid="MOESM1" ref-type="media">Supplementary Note</xref>). In this manner, we gathered sufficient information to couple our co-expression analyses with a biological readout. The specific analysis strategies used to this end are detailed below.</p>
      <sec id="Sec28">
        <title>Functional enrichment analysis</title>
        <p id="Par72">In order to understand the functional properties of AS-regulated and co-regulated genes, we set out to characterize DIU and coDIU genes using different functional enrichment analysis approaches. In this manner, we intended to gain insight on functional features and categories showing significant overrepresentation in each of these two gene lists, in comparison to different backgrounds, i.e., lists of genes to compare to in order to detect enrichment.</p>
        <p id="Par73">In the case of DIU genes, we calculated enrichment relative to genes with multiple DE isoforms in order to discriminate the functional properties of genes regulated by AS, as opposed to those lacking differential usage of their isoforms. We considered all annotated functional categories and features, and applied tappAS Functional Enrichment Analysis (FEA), which relies on the <italic>GOSeq</italic> R package<sup><xref ref-type="bibr" rid="CR94">94</xref></sup>. Briefly, the method performs an over-representation Fisher’s Exact test for each functional feature, considering the number of genes annotated with the feature in the tests and background lists. tappAS next corrects for multiple testing within each functional category by the Benjamini-Hochberg method, allowing multiple functional databases to be included or excluded from the analysis without influencing the number of significant features after <italic>p</italic>-value adjustment. Significant enrichment for the different tests was defined using a threshold of FDR &lt; 0.05.</p>
        <p id="Par74">For coDIU genes, we designed a different strategy in order to improve the statistical power of our functional enrichment analysis, aiming to compare functional properties between splicing regulation (DIU) and co-regulation (coDIU). As stated above, DIU regulation is best measured by using genes with DE isoforms as background. Intuitively, coDIU-regulated genes should then be characterized by comparing them to DIU genes. To accommodate these two test/background lists in a functional enrichment analysis without ignoring the overlap between the coDIU and DIU gene groups, we computed enrichment using a partially overlapping samples z-test via the <italic>Prop.test()</italic> function in the <italic>Partiallyoverlapping</italic> R package<sup><xref ref-type="bibr" rid="CR66">66</xref></sup>. Specifically, we compared the proportion of coDIU genes containing each of the functional features (relative to DIU genes) with the proportion of DIU genes containing that same annotation (with respect to genes with DE isoforms). In other words, we tested whether the proportion of coDIU vs DIU genes including a given functional feature was significantly higher than that shown in the comparison between DIU and DE genes. We performed the analysis for features with more than 15 annotated genes, and subsequently corrected for multiple testing within functional categories using the Benjamini-Hochberg method. For GO terms, ontologies with more than 150 annotated genes were also removed to eliminate excessively broad—and potentially less meaningful- functions. Functional features were considered to be present in a significantly higher proportion in coDIU genes when FDR &lt; 0.05.</p>
        <p id="Par75">Annotations used in all functional analyses included Gene Ontology (GO) terms. The hierarchical structure of the Gene Ontology database can often result in multiple significantly enriched terms that refer to the same, or very similar, functions, components, and processes. To enhance visualization and result interpretation of coDIU functional enrichment results, we used Revigo<sup><xref ref-type="bibr" rid="CR67">67</xref></sup> to perform a semantic similarity analysis of all significant GO terms obtained in the partially overlapping samples test. We applied a dispensability (i.e., measure of semantic similarity) threshold of 0.5 to assign GO terms to a cluster, and then selected a representative of each term cluster to include in visualization.</p>
      </sec>
      <sec id="Sec29">
        <title>Functional diversity analysis</title>
        <p id="Par76">To obtain insight into the functional changes generated as a consequence of DIU and coDIU, we again used the tappAS tool for the functional analysis of AS<sup><xref ref-type="bibr" rid="CR61">61</xref></sup>. In particular, we first applied tappAS’ Functional Diversity Analysis (FDA) module (see main text Fig. <xref rid="Fig5" ref-type="fig">5c</xref>). Briefly, FDA performs a within-gene comparison of all the isoforms included in the analysis, aiming to detect whether they present variation in the inclusion of a functional feature. In FDA, variation can be positional, i.e., one or more of the gene’s isoforms present a change in the genomic coordinates defining the feature, or be defined by presence/absence, i.e., at least one of the isoforms lacks a feature that is present in the rest. As a result, FDA provides analyzed genes with a label for each of the feature categories included in the transcriptome’s functional annotation file, flagging them as <italic>varying</italic> if at least one of the isoforms presents the variation in a feature from that category, or <italic>not varying</italic> if no changes are detected. For more details on FDA, see the Methods section in de la Fuente et al.<sup><xref ref-type="bibr" rid="CR61">61</xref></sup>.</p>
        <p id="Par77">We run both positional and presence/absence FDA for three gene sets: (1) genes with multiple DE isoforms, (2) DIU genes, and (3) coDIU genes. Next, for each of these gene sets, we computed the proportion of <italic>varying</italic> genes detected for each functional category. <italic>Varying</italic> proportions were calculated relative to the total number of genes including annotations from the category, instead of considering all genes in the set. In this manner, we avoided underestimating variation rates for categories that were less represented in the functional annotation file. In order to check whether any of these gene sets presented a significantly higher mean proportion of <italic>varying</italic> genes across categories, we performed a paired <italic>t</italic>-test for each combination of gene set pairs: DIU vs multiple DE, coDIU vs multiple DE, and coDIU vs DIU. In this analysis, we considered functional categories to be the individuals under evaluation, while the proportion of <italic>varying</italic> genes calculated for each category in the two tested sets constituted the paired observations. As a result, we obtained three <italic>p</italic>-values per FDA analysis type, i.e., presence/absence and positional variation.</p>
        <p id="Par78">To better understand the functional readout that can be obtained using the <italic>acorde</italic> pipeline, we analyzed a subset of the coDIU gene network, namely three clusters showing related isoform co-expression patterns: neuron-specific expression (cluster 1), oligodendrocyte-specific expression (cluster 14) and expression in both neural and oligodendrocyte cell types (cluster 4). To characterize functional variation among the clusters, we used positional/presence FDA (see above) and ID-level FDA. ID-level FDA is also included in tappAS<sup><xref ref-type="bibr" rid="CR61">61</xref></sup> and provides a within-feature summary of FDA results. In other words, ID-level FDA ultimately reports the number of <italic>varying</italic> and <italic>not varying</italic> genes detected for each feature ID included in a given functional category. In this case, <italic>varying</italic> status obeys a similar criterion to the one described above, i.e., genes in which at least one isoform shows differential inclusion/exclusion of the feature. Since each functional category may include several features, ID-level FDA provides a complementary view to that of FDA, allowing users to inspect which particular features are more frequently changing as a result of the category-level functional variation reported in FDA. For more details on ID-level FDA, see the Methods section in de la Fuente et al.<sup><xref ref-type="bibr" rid="CR61">61</xref></sup>.</p>
      </sec>
    </sec>
    <sec id="Sec30">
      <title>Analysis of GABA-ergic neuron subtypes</title>
      <p id="Par79">To illustrate the applicability of the <italic>acorde</italic> approach, we retrieved additional single-cell RNA-Seq data from a second study by Tasic et al.<sup><xref ref-type="bibr" rid="CR44">44</xref></sup>. Single-cell libraries belonging to GABA-ergic neuron cell subtypes from primary visual cortex were retrieved from SRA accession SRP150473 (<ext-link ext-link-type="uri" xlink:href="https://www.ncbi.nlm.nih.gov/sra/?term=SRP150473">https://www.ncbi.nlm.nih.gov/sra/?term=SRP150473</ext-link>) using the cell identity information in GEO accession GSE115746 (<ext-link ext-link-type="uri" xlink:href="https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE115746">https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE115746</ext-link>), i.e., 6147 cells and 7 cell subtypes in total.</p>
      <p id="Par80">Cell-level isoform expression estimates were obtained with Kallisto<sup><xref ref-type="bibr" rid="CR95">95</xref></sup> using our long read-generated neural transcriptome (see <xref rid="MOESM1" ref-type="media">Supplementary Note</xref>). Cell clusters and the cell subtype labels assigned to them by authors in the original study were retrieved and used in the analysis. After quality filtering of cells (1.25e6 &lt; total counts &lt; 2.75e6) and lowly expressed isoforms (counts &gt; 0 in at least 25% of one cell type), we additionally removed isoforms that did not accumulate more than 10% of their gene’s expression in at least one cell type. Cells belonging to cell types <italic>Meis2</italic> (<italic>n</italic> = 43) and <italic>Serpinf1</italic> (<italic>n</italic>
<italic>=</italic> 22) were discarded to balance cell type abundances, as the remaining cell types had ~1000 cells each. Differentially Expressed (DE) isoforms were next computed by combining ZinBWAvE weights<sup><xref ref-type="bibr" rid="CR48">48</xref></sup> (see prior DE section) and DE testing using edgeR<sup><xref ref-type="bibr" rid="CR50">50</xref></sup>. Isoforms with FDR &lt; 0.05 and fold-change &gt; 1.5 between at least one pair of cell types were selected for downstream analysis. After computing percentile correlations with <italic>p</italic> = 10, DE isoforms were clustered using dynamic hierarchical clustering with the following non-default parameters for the <italic>cutreeHybrid()</italic> function in the <italic>dynamicTreeCut</italic> R package:<sup><xref ref-type="bibr" rid="CR56">56</xref></sup>
<italic>deepSplit = 4, pamStage = FALSE, minClusterSize = 2, cutHeight = 0.1</italic>. Parameters were fine-tuned to generate a high number of clusters with as accurate a profile as possible. Unclustered isoforms (34 isoforms in total) were assigned to clusters using the percentile correlation with cluster metatranscripts and successively decreasing thresholds (see section on cluster expansion above). Expanded clusters were then merged by dynamic clustering of their metatranscripts (see Methods section on merging clusters) using the following non-default parameters for the <italic>cutreeHybrid()</italic> function: <italic>pamStage = FALSE, cutHeight = 0.3</italic>. Detection of DIU and coDIU genes was performed as described in the relevant Methods sections.</p>
    </sec>
    <sec id="Sec31">
      <title>Reporting summary</title>
      <p id="Par81">Further information on research design is available in the <xref rid="MOESM2" ref-type="media">Nature Research Reporting Summary</xref> linked to this article.</p>
    </sec>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary information</title>
    <sec id="Sec32">
      <p>
        <supplementary-material content-type="local-data" id="MOESM1">
          <media xlink:href="41467_2022_29497_MOESM1_ESM.pdf">
            <caption>
              <p>Supplementary Information</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM2">
          <media xlink:href="41467_2022_29497_MOESM2_ESM.pdf">
            <caption>
              <p>Reporting Summary</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM3">
          <media xlink:href="41467_2022_29497_MOESM3_ESM.pdf">
            <caption>
              <p>Peer Review File</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM4">
          <media xlink:href="41467_2022_29497_MOESM4_ESM.pdf">
            <caption>
              <p>Description of Additional Supplementary Files</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM5">
          <media xlink:href="41467_2022_29497_MOESM5_ESM.xlsx">
            <caption>
              <p>Supplementary Dataset 1</p>
            </caption>
          </media>
        </supplementary-material>
      </p>
    </sec>
  </sec>
</body>
<back>
  <fn-group>
    <fn>
      <p><bold>Publisher’s note</bold> Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p>
    </fn>
    <fn>
      <p>These authors contributed equally: Sonia Tarazona, Ana Conesa.</p>
    </fn>
  </fn-group>
  <sec>
    <title>Supplementary information</title>
    <p>The online version contains supplementary material available at 10.1038/s41467-022-29497-w.</p>
  </sec>
  <ack>
    <title>Acknowledgements</title>
    <p>This work has been funded by NIH grant R21HG011280 (A.C.) and by the Spanish Ministry of Science grants BIO2015–1658-R (A.C., S.T.), BES-2016-076994 (A.A.L.) and PID2020-119537RB-100 (A.C., S.T.). Funding for open access charge provided by the Universitat Politècnica de València and the Spanish Ministry of Science grant PID2020-119537RB-100.</p>
  </ack>
  <notes notes-type="author-contribution">
    <title>Author contributions</title>
    <p>A.A.L. developed and evaluated computational methods, implemented and documented R package, obtained long read transcriptome, analyzed single-cell data, interpreted results, and wrote the manuscript. P.S. implemented IsoAnnotLite, refined and performed functional annotation strategy. S.T. conducted statistical method development, refined the manuscript, and supervised the study. A.C. conceived the study, supervised all analysis approaches and methods developed, and refined the manuscript.</p>
  </notes>
  <notes notes-type="peer-review">
    <title>Peer review</title>
    <sec id="FPar1">
      <title>Peer review information</title>
      <p id="Par82"><italic>Nature Communications</italic> thanks Xiuwei Zhang and the other, anonymous, reviewer(s) for their contribution to the peer review of this work. Peer reviewer reports are available.</p>
    </sec>
  </notes>
  <notes notes-type="data-availability">
    <title>Data availability</title>
    <p>Single-cell, short-read RNA-Seq data from mouse primary visual cortex used in the analysis of neural broad types, generated by Tasic et al. 2016<sup><xref ref-type="bibr" rid="CR43">43</xref></sup>, was downloaded from SRA accession <ext-link ext-link-type="uri" xlink:href="https://www.ncbi.nlm.nih.gov/sra?term=SRP061902">SRP061902</ext-link>. Single-cell, short-read RNA-Seq data from mouse primary visual cortex used in the analysis of GABA neuron subtypes, generated by Tasic et al. 2018<sup><xref ref-type="bibr" rid="CR44">44</xref></sup>, was downloaded from SRA accession <ext-link ext-link-type="uri" xlink:href="https://www.ncbi.nlm.nih.gov/sra/?term=SRP150473">SRP150473</ext-link>, after selecting accessions corresponding to GABA neurons and primary visual cortex tissue, described by authors in the study metadata available at GEO accession <ext-link ext-link-type="uri" xlink:href="https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE115746">GSE115746</ext-link>. The isoform-level expression matrices obtained using these data and the long read-defined transcriptome are available as data objects within the <italic>acorde</italic> R package (<ext-link ext-link-type="uri" xlink:href="https://github.com/ConesaLab/acorde/data">https://github.com/ConesaLab/acorde/data</ext-link>). Mouse reference genome and transcriptome used for long-read processing were downloaded from the RefSeq<sup><xref ref-type="bibr" rid="CR96">96</xref></sup> database (global release 96, annotation release 108, September 2019, <ext-link ext-link-type="uri" xlink:href="https://ftp.ncbi.nlm.nih.gov/genomes/all/annotation_releases/10090/108">https://ftp.ncbi.nlm.nih.gov/genomes/all/annotation_releases/10090/108</ext-link>), from genome version GRCm38.p6 and assembly accession GCF_00001635.26. Long-read datasets form mouse hippocampus and cortex, generated by Wyman et al.<sup><xref ref-type="bibr" rid="CR45">45</xref></sup>, were downloaded from ENCODE accessions <ext-link ext-link-type="uri" xlink:href="https://www.encodeproject.org/experiments/ENCSR214HSG">ENCSR214HSG</ext-link> and <ext-link ext-link-type="uri" xlink:href="https://www.encodeproject.org/experiments/ENCSR340GWV">ENCSR340GWV</ext-link>, respectively. Long read-defined transcriptome files (generated using above-cited long-read data and reference files, details in <xref rid="MOESM1" ref-type="media">Supplementary Note</xref>) have been made available at the tappAS repository of annotation files. These include the GTF file used for quantification (<ext-link ext-link-type="uri" xlink:href="https://app.tappas.org/resources/downloads/gtfs">https://app.tappas.org/resources/downloads/gtfs</ext-link>) and the GFF3 file obtained after transferring functional features using isoAnnotLite (<ext-link ext-link-type="uri" xlink:href="http://app.tappas.org/resources/downloads/gffs">http://app.tappas.org/resources/downloads/gffs</ext-link>); indicated as Mus_Musculus_GRCm38.p6_PacBioENCODE_RefSeq108.</p>
  </notes>
  <notes notes-type="data-availability">
    <title>Code availability</title>
    <p>The code used to perform the analyses in this manuscript has been implemented in the <italic>acorde</italic> R package, available at <ext-link ext-link-type="uri" xlink:href="https://github.com/ConesaLab/acorde">https://github.com/ConesaLab/acorde</ext-link>. Specifically, all analyses have been run using <italic>acorde</italic> v0.1.0<sup><xref ref-type="bibr" rid="CR97">97</xref></sup>.</p>
  </notes>
  <notes id="FPar2" notes-type="COI-statement">
    <title>Competing interests</title>
    <p id="Par83">The authors declare no competing interests.</p>
  </notes>
  <ref-list id="Bib1">
    <title>References</title>
    <ref id="CR1">
      <label>1.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Svensson</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Vento-Tormo</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Teichmann</surname>
            <given-names>SA</given-names>
          </name>
        </person-group>
        <article-title>Exponential scaling of single-cell RNA-seq in the past decade</article-title>
        <source>Nat. Protoc.</source>
        <year>2018</year>
        <volume>13</volume>
        <fpage>599</fpage>
        <lpage>604</lpage>
        <?supplied-pmid 29494575?>
        <pub-id pub-id-type="pmid">29494575</pub-id>
      </element-citation>
    </ref>
    <ref id="CR2">
      <label>2.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Treutlein</surname>
            <given-names>B</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Reconstructing lineage hierarchies of the distal lung epithelium using single-cell RNA-seq</article-title>
        <source>Nature</source>
        <year>2014</year>
        <volume>509</volume>
        <fpage>371</fpage>
        <lpage>375</lpage>
        <?supplied-pmid 24739965?>
        <pub-id pub-id-type="pmid">24739965</pub-id>
      </element-citation>
    </ref>
    <ref id="CR3">
      <label>3.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zeisel</surname>
            <given-names>A</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Cell types in the mouse cortex and hippocampus revealed by single-cell RNA-seq</article-title>
        <source>Science</source>
        <year>2015</year>
        <volume>347</volume>
        <fpage>1138</fpage>
        <lpage>1142</lpage>
        <pub-id pub-id-type="pmid">25700174</pub-id>
      </element-citation>
    </ref>
    <ref id="CR4">
      <label>4.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Chen</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Wu</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Jiang</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>Y</given-names>
          </name>
        </person-group>
        <article-title>Single-cell RNA-Seq reveals hypothalamic cell diversity</article-title>
        <source>Cell Rep.</source>
        <year>2017</year>
        <volume>18</volume>
        <fpage>3227</fpage>
        <lpage>3241</lpage>
        <?supplied-pmid 28355573?>
        <pub-id pub-id-type="pmid">28355573</pub-id>
      </element-citation>
    </ref>
    <ref id="CR5">
      <label>5.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wu</surname>
            <given-names>YE</given-names>
          </name>
          <name>
            <surname>Pan</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Zuo</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Hong</surname>
            <given-names>W</given-names>
          </name>
        </person-group>
        <article-title>Detecting activated cell populations using single-cell RNA-Seq</article-title>
        <source>Neuron</source>
        <year>2017</year>
        <volume>96</volume>
        <fpage>313</fpage>
        <lpage>329.e6</lpage>
        <?supplied-pmid 29024657?>
        <pub-id pub-id-type="pmid">29024657</pub-id>
      </element-citation>
    </ref>
    <ref id="CR6">
      <label>6.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Villani</surname>
            <given-names>A-C</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Single-cell RNA-seq reveals new types of human blood dendritic cells, monocytes, and progenitors</article-title>
        <source>Science</source>
        <year>2017</year>
        <volume>356</volume>
        <fpage>eaah4573</fpage>
        <?supplied-pmid 5775029?>
        <pub-id pub-id-type="pmid">28428369</pub-id>
      </element-citation>
    </ref>
    <ref id="CR7">
      <label>7.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zhong</surname>
            <given-names>S</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>A single-cell RNA-seq survey of the developmental landscape of the human prefrontal cortex</article-title>
        <source>Nature</source>
        <year>2018</year>
        <volume>555</volume>
        <fpage>524</fpage>
        <lpage>528</lpage>
        <?supplied-pmid 29539641?>
        <pub-id pub-id-type="pmid">29539641</pub-id>
      </element-citation>
    </ref>
    <ref id="CR8">
      <label>8.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Crow</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Gillis</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>Co-expression in single-cell analysis: Saving grace or original sin?</article-title>
        <source>Trends Genet.</source>
        <year>2018</year>
        <volume>34</volume>
        <fpage>823</fpage>
        <lpage>831</lpage>
        <?supplied-pmid 30146183?>
        <pub-id pub-id-type="pmid">30146183</pub-id>
      </element-citation>
    </ref>
    <ref id="CR9">
      <label>9.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Trapnell</surname>
            <given-names>C</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>The dynamics and regulators of cell fate decisions are revealed by pseudotemporal ordering of single cells</article-title>
        <source>Nat. Biotechnol.</source>
        <year>2014</year>
        <volume>32</volume>
        <fpage>381</fpage>
        <lpage>386</lpage>
        <?supplied-pmid 4122333?>
        <pub-id pub-id-type="pmid">24658644</pub-id>
      </element-citation>
    </ref>
    <ref id="CR10">
      <label>10.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Saelens</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Cannoodt</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Todorov</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Saeys</surname>
            <given-names>Y</given-names>
          </name>
        </person-group>
        <article-title>A comparison of single-cell trajectory inference methods</article-title>
        <source>Nat. Biotechnol.</source>
        <year>2019</year>
        <volume>37</volume>
        <fpage>547</fpage>
        <lpage>554</lpage>
        <?supplied-pmid 30936559?>
        <pub-id pub-id-type="pmid">30936559</pub-id>
      </element-citation>
    </ref>
    <ref id="CR11">
      <label>11.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>La Manno</surname>
            <given-names>G</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>RNA velocity of single cells</article-title>
        <source>Nature</source>
        <year>2018</year>
        <volume>560</volume>
        <fpage>494</fpage>
        <lpage>498</lpage>
        <?supplied-pmid 6130801?>
        <pub-id pub-id-type="pmid">30089906</pub-id>
      </element-citation>
    </ref>
    <ref id="CR12">
      <label>12.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Jia</surname>
            <given-names>G</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Single cell RNA-seq and ATAC-seq analysis of cardiac progenitor cell transition states and lineage settlement</article-title>
        <source>Nat. Commun.</source>
        <year>2018</year>
        <volume>9</volume>
        <fpage>4877</fpage>
        <?supplied-pmid 30451828?>
        <pub-id pub-id-type="pmid">30451828</pub-id>
      </element-citation>
    </ref>
    <ref id="CR13">
      <label>13.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Su</surname>
            <given-names>X</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Single-cell RNA-Seq analysis reveals dynamic trajectories during mouse liver development</article-title>
        <source>BMC Genomics</source>
        <year>2017</year>
        <volume>18</volume>
        <fpage>946</fpage>
        <?supplied-pmid 29202695?>
        <pub-id pub-id-type="pmid">29202695</pub-id>
      </element-citation>
    </ref>
    <ref id="CR14">
      <label>14.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Guo</surname>
            <given-names>F</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Single-cell multi-omics sequencing of mouse early embryos and embryonic stem cells</article-title>
        <source>Cell Res.</source>
        <year>2017</year>
        <volume>27</volume>
        <fpage>967</fpage>
        <lpage>988</lpage>
        <?supplied-pmid 28621329?>
        <pub-id pub-id-type="pmid">28621329</pub-id>
      </element-citation>
    </ref>
    <ref id="CR15">
      <label>15.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Le</surname>
            <given-names>J</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Single-cell RNA-Seq mapping of human thymopoiesis reveals lineage specification trajectories and a commitment spectrum in T cell development</article-title>
        <source>Immunity</source>
        <year>2020</year>
        <volume>52</volume>
        <fpage>1105</fpage>
        <lpage>1118.e9</lpage>
        <?supplied-pmid 32553173?>
        <pub-id pub-id-type="pmid">32553173</pub-id>
      </element-citation>
    </ref>
    <ref id="CR16">
      <label>16.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Jerber</surname>
            <given-names>J</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Population-scale single-cell RNA-seq profiling across dopaminergic neuron differentiation</article-title>
        <source>Nat. Genet.</source>
        <year>2021</year>
        <volume>53</volume>
        <fpage>304</fpage>
        <lpage>312</lpage>
        <?supplied-pmid 33664506?>
        <pub-id pub-id-type="pmid">33664506</pub-id>
      </element-citation>
    </ref>
    <ref id="CR17">
      <label>17.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Pratapa</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Jalihal</surname>
            <given-names>AP</given-names>
          </name>
          <name>
            <surname>Law</surname>
            <given-names>JN</given-names>
          </name>
          <name>
            <surname>Bharadwaj</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Murali</surname>
            <given-names>TM</given-names>
          </name>
        </person-group>
        <article-title>Benchmarking algorithms for gene regulatory network inference from single-cell transcriptomic data</article-title>
        <source>Nat. Methods</source>
        <year>2020</year>
        <volume>17</volume>
        <fpage>147</fpage>
        <lpage>154</lpage>
        <?supplied-pmid 31907445?>
        <pub-id pub-id-type="pmid">31907445</pub-id>
      </element-citation>
    </ref>
    <ref id="CR18">
      <label>18.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Westoby</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Artemov</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Hemberg</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Ferguson-Smith</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>Obstacles to detecting isoforms using full-length scRNA-seq data</article-title>
        <source>Genome Biol.</source>
        <year>2020</year>
        <volume>21</volume>
        <fpage>74</fpage>
        <?supplied-pmid 32293520?>
        <pub-id pub-id-type="pmid">32293520</pub-id>
      </element-citation>
    </ref>
    <ref id="CR19">
      <label>19.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Arzalluz-Luque</surname>
            <given-names>Á</given-names>
          </name>
          <name>
            <surname>Conesa</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>Single-cell RNAseq for the study of isoforms—how is that possible?</article-title>
        <source>Genome Biol.</source>
        <year>2018</year>
        <volume>19</volume>
        <fpage>110</fpage>
        <?supplied-pmid 30097058?>
        <pub-id pub-id-type="pmid">30097058</pub-id>
      </element-citation>
    </ref>
    <ref id="CR20">
      <label>20.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ntranos</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Yi</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Melsted</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Pachter</surname>
            <given-names>L</given-names>
          </name>
        </person-group>
        <article-title>A discriminative learning approach to differential expression analysis for single-cell RNA-seq</article-title>
        <source>Nat. Methods</source>
        <year>2019</year>
        <volume>16</volume>
        <fpage>163</fpage>
        <lpage>166</lpage>
        <?supplied-pmid 30664774?>
        <pub-id pub-id-type="pmid">30664774</pub-id>
      </element-citation>
    </ref>
    <ref id="CR21">
      <label>21.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Qiu</surname>
            <given-names>X</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Single-cell mRNA quantification and differential analysis with Census</article-title>
        <source>Nat. Methods</source>
        <year>2017</year>
        <volume>14</volume>
        <fpage>309</fpage>
        <lpage>315</lpage>
        <?supplied-pmid 28114287?>
        <pub-id pub-id-type="pmid">28114287</pub-id>
      </element-citation>
    </ref>
    <ref id="CR22">
      <label>22.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Song</surname>
            <given-names>Y</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Single-cell alternative splicing analysis with expedition reveals splicing dynamics during neuron differentiation</article-title>
        <source>Mol. Cell</source>
        <year>2017</year>
        <volume>67</volume>
        <fpage>148</fpage>
        <lpage>161.e5</lpage>
        <?supplied-pmid 28673540?>
        <pub-id pub-id-type="pmid">28673540</pub-id>
      </element-citation>
    </ref>
    <ref id="CR23">
      <label>23.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Huang</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Sanguinetti</surname>
            <given-names>G</given-names>
          </name>
        </person-group>
        <article-title>BRIE: transcriptome-wide splicing quantification in single cells</article-title>
        <source>Genome Biol.</source>
        <year>2017</year>
        <volume>18</volume>
        <fpage>123</fpage>
        <?supplied-pmid 28655331?>
        <pub-id pub-id-type="pmid">28655331</pub-id>
      </element-citation>
    </ref>
    <ref id="CR24">
      <label>24.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wu</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Liu</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Ye</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Ye</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Ji</surname>
            <given-names>G</given-names>
          </name>
        </person-group>
        <article-title>scAPAtrap: Identification and quantification of alternative polyadenylation sites from single-cell RNA-seq data</article-title>
        <source>Brief. Bioinform.</source>
        <year>2020</year>
        <volume>2020</volume>
        <fpage>1</fpage>
        <lpage>15</lpage>
      </element-citation>
    </ref>
    <ref id="CR25">
      <label>25.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hu</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>Detecting differential alternative splicing events in scRNA-seq with or without Unique Molecular Identifiers</article-title>
        <source>PLoS Comput. Biol.</source>
        <year>2020</year>
        <volume>16</volume>
        <fpage>e1007925</fpage>
        <?supplied-pmid 32502143?>
        <pub-id pub-id-type="pmid">32502143</pub-id>
      </element-citation>
    </ref>
    <ref id="CR26">
      <label>26.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Patrick</surname>
            <given-names>R</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Sierra: Discovery of differential transcript usage from polyA-captured single-cell RNA-seq data</article-title>
        <source>Genome Biol.</source>
        <year>2020</year>
        <volume>21</volume>
        <fpage>1</fpage>
        <lpage>27</lpage>
      </element-citation>
    </ref>
    <ref id="CR27">
      <label>27.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Booeshaghi</surname>
            <given-names>AS</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Isoform cell-type specificity in the mouse primary motor cortex</article-title>
        <source>Nature</source>
        <year>2021</year>
        <volume>598</volume>
        <fpage>195</fpage>
        <lpage>199</lpage>
        <?supplied-pmid 34616073?>
        <pub-id pub-id-type="pmid">34616073</pub-id>
      </element-citation>
    </ref>
    <ref id="CR28">
      <label>28.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Byrne</surname>
            <given-names>A</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Nanopore long-read RNAseq reveals widespread transcriptional variation among the surface receptors of individual B cells</article-title>
        <source>Nat. Commun.</source>
        <year>2017</year>
        <volume>8</volume>
        <fpage>16027</fpage>
        <?supplied-pmid 28722025?>
        <pub-id pub-id-type="pmid">28722025</pub-id>
      </element-citation>
    </ref>
    <ref id="CR29">
      <label>29.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Volden</surname>
            <given-names>R</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Improving nanopore read accuracy with the R2C2 method enables the sequencing of highly multiplexed full-length single-cell cDNA</article-title>
        <source>Proc. Natl Acad. Sci. USA</source>
        <year>2018</year>
        <volume>115</volume>
        <fpage>9726</fpage>
        <lpage>9731</lpage>
        <?supplied-pmid 30201725?>
        <pub-id pub-id-type="pmid">30201725</pub-id>
      </element-citation>
    </ref>
    <ref id="CR30">
      <label>30.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Gupta</surname>
            <given-names>I</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Single-cell isoform RNA sequencing characterizes isoforms in thousands of cerebellar cells</article-title>
        <source>Nat. Biotechnol.</source>
        <year>2018</year>
        <volume>36</volume>
        <fpage>1197</fpage>
        <lpage>1202</lpage>
      </element-citation>
    </ref>
    <ref id="CR31">
      <label>31.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Joglekar</surname>
            <given-names>A</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>A spatially resolved brain region- and cell type-specific isoform atlas of the postnatal mouse brain</article-title>
        <source>Nat. Commun.</source>
        <year>2021</year>
        <volume>12</volume>
        <fpage>463</fpage>
        <?supplied-pmid 33469025?>
        <pub-id pub-id-type="pmid">33469025</pub-id>
      </element-citation>
    </ref>
    <ref id="CR32">
      <label>32.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Tian</surname>
            <given-names>L</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Comprehensive characterization of single-cell full-length isoforms in human and mouse with long-read sequencing</article-title>
        <source>Genome Biol.</source>
        <year>2021</year>
        <volume>22</volume>
        <fpage>310</fpage>
        <?supplied-pmid 34763716?>
        <pub-id pub-id-type="pmid">34763716</pub-id>
      </element-citation>
    </ref>
    <ref id="CR33">
      <label>33.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Feng</surname>
            <given-names>H</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Complexity and graded regulation of neuronal cell-type–specific alternative splicing revealed by single-cell RNA sequencing</article-title>
        <source>Proc. Natl Acad. Sci. USA</source>
        <year>2021</year>
        <volume>118</volume>
        <fpage>e2013056118</fpage>
        <?supplied-pmid 33674385?>
        <pub-id pub-id-type="pmid">33674385</pub-id>
      </element-citation>
    </ref>
    <ref id="CR34">
      <label>34.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Becht</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Zhao</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Amezquita</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Gottardo</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>Aggregating transcript-level analyses for single-cell differential gene expression</article-title>
        <source>Nat. Methods</source>
        <year>2020</year>
        <volume>17</volume>
        <fpage>583</fpage>
        <lpage>585</lpage>
        <?supplied-pmid 32483334?>
        <pub-id pub-id-type="pmid">32483334</pub-id>
      </element-citation>
    </ref>
    <ref id="CR35">
      <label>35.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Yi</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Pimentel</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Bray</surname>
            <given-names>NL</given-names>
          </name>
          <name>
            <surname>Pachter</surname>
            <given-names>L</given-names>
          </name>
        </person-group>
        <article-title>Gene-level differential analysis at transcript-level resolution</article-title>
        <source>Genome Biol.</source>
        <year>2018</year>
        <volume>19</volume>
        <fpage>53</fpage>
        <?supplied-pmid 29650040?>
        <pub-id pub-id-type="pmid">29650040</pub-id>
      </element-citation>
    </ref>
    <ref id="CR36">
      <label>36.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Soneson</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Robinson</surname>
            <given-names>MD</given-names>
          </name>
        </person-group>
        <article-title>Bias, robustness and scalability in single-cell differential expression analysis</article-title>
        <source>Nat. Methods</source>
        <year>2018</year>
        <volume>15</volume>
        <fpage>255</fpage>
        <lpage>261</lpage>
        <?supplied-pmid 29481549?>
        <pub-id pub-id-type="pmid">29481549</pub-id>
      </element-citation>
    </ref>
    <ref id="CR37">
      <label>37.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Shalek</surname>
            <given-names>AK</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Single-cell transcriptomics reveals bimodality in expression and splicing in immune cells</article-title>
        <source>Nature</source>
        <year>2013</year>
        <volume>498</volume>
        <fpage>236</fpage>
        <lpage>240</lpage>
        <?supplied-pmid 23685454?>
        <pub-id pub-id-type="pmid">23685454</pub-id>
      </element-citation>
    </ref>
    <ref id="CR38">
      <label>38.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Liu</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>X</given-names>
          </name>
        </person-group>
        <article-title>Single-cell alternative splicing analysis reveals dominance of single transcript variant</article-title>
        <source>Genomics</source>
        <year>2020</year>
        <volume>112</volume>
        <fpage>2418</fpage>
        <lpage>2425</lpage>
        <?supplied-pmid 31981701?>
        <pub-id pub-id-type="pmid">31981701</pub-id>
      </element-citation>
    </ref>
    <ref id="CR39">
      <label>39.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Buen Abad Najar</surname>
            <given-names>CF</given-names>
          </name>
          <name>
            <surname>Yosef</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Lareau</surname>
            <given-names>LF</given-names>
          </name>
        </person-group>
        <article-title>Coverage-dependent bias creates the appearance of binary splicing in single cells</article-title>
        <source>eLife</source>
        <year>2020</year>
        <volume>9</volume>
        <fpage>1</fpage>
        <lpage>23</lpage>
      </element-citation>
    </ref>
    <ref id="CR40">
      <label>40.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Tilgner</surname>
            <given-names>H</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Microfluidic isoform sequencing shows widespread splicing coordination in the human transcriptome</article-title>
        <source>Genome Res.</source>
        <year>2018</year>
        <volume>28</volume>
        <fpage>231</fpage>
        <lpage>242</lpage>
        <?supplied-pmid 29196558?>
        <pub-id pub-id-type="pmid">29196558</pub-id>
      </element-citation>
    </ref>
    <ref id="CR41">
      <label>41.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Tilgner</surname>
            <given-names>H</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Comprehensive transcriptome analysis using synthetic long-read sequencing reveals molecular co-association of distant splicing events</article-title>
        <source>Nat. Biotechnol.</source>
        <year>2015</year>
        <volume>33</volume>
        <fpage>736</fpage>
        <lpage>742</lpage>
        <?supplied-pmid 25985263?>
        <pub-id pub-id-type="pmid">25985263</pub-id>
      </element-citation>
    </ref>
    <ref id="CR42">
      <label>42.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Skinnider</surname>
            <given-names>MA</given-names>
          </name>
          <name>
            <surname>Squair</surname>
            <given-names>JW</given-names>
          </name>
          <name>
            <surname>Foster</surname>
            <given-names>LJ</given-names>
          </name>
        </person-group>
        <article-title>Evaluating measures of association for single-cell transcriptomics</article-title>
        <source>Nat. Methods</source>
        <year>2019</year>
        <volume>16</volume>
        <fpage>381</fpage>
        <lpage>386</lpage>
        <?supplied-pmid 30962620?>
        <pub-id pub-id-type="pmid">30962620</pub-id>
      </element-citation>
    </ref>
    <ref id="CR43">
      <label>43.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Tasic</surname>
            <given-names>B</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Adult mouse cortical cell taxonomy revealed by single cell transcriptomics</article-title>
        <source>Nat. Neurosci.</source>
        <year>2016</year>
        <volume>19</volume>
        <fpage>335</fpage>
        <lpage>346</lpage>
        <?supplied-pmid 26727548?>
        <pub-id pub-id-type="pmid">26727548</pub-id>
      </element-citation>
    </ref>
    <ref id="CR44">
      <label>44.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Tasic</surname>
            <given-names>B</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Shared and distinct transcriptomic cell types across neocortical areas</article-title>
        <source>Nature</source>
        <year>2018</year>
        <volume>563</volume>
        <fpage>72</fpage>
        <lpage>78</lpage>
        <?supplied-pmid 30382198?>
        <pub-id pub-id-type="pmid">30382198</pub-id>
      </element-citation>
    </ref>
    <ref id="CR45">
      <label>45.</label>
      <mixed-citation publication-type="other">Wyman, D. et al. A technology-agnostic long-read analysis pipeline for transcriptome discovery and quantification. Preprint at <italic>bioRxiv</italic>10.1101/672931 (2019).</mixed-citation>
    </ref>
    <ref id="CR46">
      <label>46.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Soneson</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Matthes</surname>
            <given-names>KL</given-names>
          </name>
          <name>
            <surname>Nowicka</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Law</surname>
            <given-names>CW</given-names>
          </name>
          <name>
            <surname>Robinson</surname>
            <given-names>MD</given-names>
          </name>
        </person-group>
        <article-title>Isoform prefiltering improves performance of count-based methods for analysis of differential transcript usage</article-title>
        <source>Genome Biol.</source>
        <year>2016</year>
        <volume>17</volume>
        <fpage>12</fpage>
        <?supplied-pmid 26813113?>
        <pub-id pub-id-type="pmid">26813113</pub-id>
      </element-citation>
    </ref>
    <ref id="CR47">
      <label>47.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Tardaguila</surname>
            <given-names>M</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>SQANTI: Extensive characterization of long-read transcript sequences for quality control in full-length transcriptome identification and quantification</article-title>
        <source>Genome Res.</source>
        <year>2018</year>
        <volume>28</volume>
        <fpage>396</fpage>
        <lpage>411</lpage>
      </element-citation>
    </ref>
    <ref id="CR48">
      <label>48.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Van den Berge</surname>
            <given-names>K</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Observation weights unlock bulk RNA-seq tools for zero inflation and single-cell applications</article-title>
        <source>Genome Biol.</source>
        <year>2018</year>
        <volume>19</volume>
        <fpage>24</fpage>
        <?supplied-pmid 29478411?>
        <pub-id pub-id-type="pmid">29478411</pub-id>
      </element-citation>
    </ref>
    <ref id="CR49">
      <label>49.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Love</surname>
            <given-names>MI</given-names>
          </name>
          <name>
            <surname>Huber</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Anders</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>Moderated estimation of fold change and dispersion for RNA-seq data with DESeq2</article-title>
        <source>Genome Biol.</source>
        <year>2014</year>
        <volume>15</volume>
        <fpage>550</fpage>
        <?supplied-pmid 4302049?>
        <pub-id pub-id-type="pmid">25516281</pub-id>
      </element-citation>
    </ref>
    <ref id="CR50">
      <label>50.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Robinson</surname>
            <given-names>MD</given-names>
          </name>
          <name>
            <surname>McCarthy</surname>
            <given-names>DJ</given-names>
          </name>
          <name>
            <surname>Smyth</surname>
            <given-names>GK</given-names>
          </name>
        </person-group>
        <article-title>edgeR: A Bioconductor package for differential expression analysis of digital gene expression data</article-title>
        <source>Bioinformatics</source>
        <year>2009</year>
        <volume>26</volume>
        <fpage>139</fpage>
        <lpage>140</lpage>
        <?supplied-pmid 19910308?>
        <pub-id pub-id-type="pmid">19910308</pub-id>
      </element-citation>
    </ref>
    <ref id="CR51">
      <label>51.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Chen</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Mar</surname>
            <given-names>JC</given-names>
          </name>
        </person-group>
        <article-title>Evaluating methods of inferring gene regulatory networks highlights their lack of performance for single cell gene expression data</article-title>
        <source>BMC Bioinform.</source>
        <year>2018</year>
        <volume>19</volume>
        <fpage>232</fpage>
      </element-citation>
    </ref>
    <ref id="CR52">
      <label>52.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Iacono</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Massoni-Badosa</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Heyn</surname>
            <given-names>H</given-names>
          </name>
        </person-group>
        <article-title>Single-cell transcriptomics unveils gene regulatory network plasticity</article-title>
        <source>Genome Biol.</source>
        <year>2019</year>
        <volume>20</volume>
        <fpage>110</fpage>
        <?supplied-pmid 31159854?>
        <pub-id pub-id-type="pmid">31159854</pub-id>
      </element-citation>
    </ref>
    <ref id="CR53">
      <label>53.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Brennecke</surname>
            <given-names>P</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Accounting for technical noise in single-cell RNA-seq experiments</article-title>
        <source>Nat. Methods</source>
        <year>2013</year>
        <volume>10</volume>
        <fpage>1093</fpage>
        <lpage>1095</lpage>
        <?supplied-pmid 24056876?>
        <pub-id pub-id-type="pmid">24056876</pub-id>
      </element-citation>
    </ref>
    <ref id="CR54">
      <label>54.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Grün</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Kester</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>van Oudenaarden</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>Validation of noise models for single-cell transcriptomics</article-title>
        <source>Nat. Methods</source>
        <year>2014</year>
        <volume>11</volume>
        <fpage>637</fpage>
        <lpage>640</lpage>
        <?supplied-pmid 24747814?>
        <pub-id pub-id-type="pmid">24747814</pub-id>
      </element-citation>
    </ref>
    <ref id="CR55">
      <label>55.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Raj</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>van Oudenaarden</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>Nature, nurture, or chance: Stochastic gene expression and its consequences</article-title>
        <source>Cell</source>
        <year>2008</year>
        <volume>135</volume>
        <fpage>216</fpage>
        <lpage>226</lpage>
        <?supplied-pmid 18957198?>
        <pub-id pub-id-type="pmid">18957198</pub-id>
      </element-citation>
    </ref>
    <ref id="CR56">
      <label>56.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Langfelder</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Horvath</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>Defining clusters from a hierarchical cluster tree: The dynamic tree cut package for R</article-title>
        <source>Bioinformatics</source>
        <year>2008</year>
        <volume>24</volume>
        <fpage>719</fpage>
        <lpage>720</lpage>
        <?supplied-pmid 18024473?>
        <pub-id pub-id-type="pmid">18024473</pub-id>
      </element-citation>
    </ref>
    <ref id="CR57">
      <label>57.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Pimentel</surname>
            <given-names>RS</given-names>
          </name>
          <name>
            <surname>Niewiadomska-Bugaj</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>J-C</given-names>
          </name>
        </person-group>
        <article-title>Association of zero-inflated continuous variables</article-title>
        <source>Stat. Probab. Lett.</source>
        <year>2015</year>
        <volume>96</volume>
        <fpage>61</fpage>
        <lpage>67</lpage>
      </element-citation>
    </ref>
    <ref id="CR58">
      <label>58.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Erb</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Notredame</surname>
            <given-names>C</given-names>
          </name>
        </person-group>
        <article-title>How should we measure proportionality on relative gene expression data?</article-title>
        <source>Theory Biosci.</source>
        <year>2016</year>
        <volume>135</volume>
        <fpage>21</fpage>
        <lpage>36</lpage>
        <?supplied-pmid 26762323?>
        <pub-id pub-id-type="pmid">26762323</pub-id>
      </element-citation>
    </ref>
    <ref id="CR59">
      <label>59.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zhang</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Xu</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Yosef</surname>
            <given-names>N</given-names>
          </name>
        </person-group>
        <article-title>Simulating multiple faceted variability in single cell RNA sequencing</article-title>
        <source>Nat. Commun.</source>
        <year>2019</year>
        <volume>10</volume>
        <fpage>2611</fpage>
        <?supplied-pmid 31197158?>
        <pub-id pub-id-type="pmid">31197158</pub-id>
      </element-citation>
    </ref>
    <ref id="CR60">
      <label>60.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Vitting-Seerup</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Sandelin</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>IsoformSwitchAnalyzeR: Analysis of changes in genome-wide patterns of alternative splicing and its functional consequences</article-title>
        <source>Bioinforma. Oxf. Engl.</source>
        <year>2019</year>
        <volume>35</volume>
        <fpage>4469</fpage>
        <lpage>4471</lpage>
      </element-citation>
    </ref>
    <ref id="CR61">
      <label>61.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>de la Fuente</surname>
            <given-names>L</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>tappAS: A comprehensive computational framework for the analysis of the functional impact of differential splicing</article-title>
        <source>Genome Biol.</source>
        <year>2020</year>
        <volume>21</volume>
        <fpage>119</fpage>
        <?supplied-pmid 32423416?>
        <pub-id pub-id-type="pmid">32423416</pub-id>
      </element-citation>
    </ref>
    <ref id="CR62">
      <label>62.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zhu</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Liu</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Yu</surname>
            <given-names>W</given-names>
          </name>
        </person-group>
        <article-title>Long non-coding RNA MBNL1-AS1 regulates proliferation, migration, and invasion of cancer stem cells in colon cancer by interacting with MYL9 via sponging microRNA-412-3p</article-title>
        <source>Clin. Res. Hepatol. Gastroenterol.</source>
        <year>2020</year>
        <volume>44</volume>
        <fpage>101</fpage>
        <lpage>114</lpage>
        <?supplied-pmid 31255531?>
        <pub-id pub-id-type="pmid">31255531</pub-id>
      </element-citation>
    </ref>
    <ref id="CR63">
      <label>63.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lee</surname>
            <given-names>K-Y</given-names>
          </name>
          <name>
            <surname>Chang</surname>
            <given-names>H-C</given-names>
          </name>
          <name>
            <surname>Seah</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Lee</surname>
            <given-names>L-J</given-names>
          </name>
        </person-group>
        <article-title>Deprivation of muscleblind-like proteins causes deficits in cortical neuron distribution and morphological changes in dendritic spines and postsynaptic densities</article-title>
        <source>Front. Neuroanat.</source>
        <year>2019</year>
        <volume>13</volume>
        <fpage>75</fpage>
        <?supplied-pmid 31417371?>
        <pub-id pub-id-type="pmid">31417371</pub-id>
      </element-citation>
    </ref>
    <ref id="CR64">
      <label>64.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wang</surname>
            <given-names>P-Y</given-names>
          </name>
          <name>
            <surname>Chang</surname>
            <given-names>K-T</given-names>
          </name>
          <name>
            <surname>Lin</surname>
            <given-names>Y-M</given-names>
          </name>
          <name>
            <surname>Kuo</surname>
            <given-names>T-Y</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>G-S</given-names>
          </name>
        </person-group>
        <article-title>Ubiquitination of MBNL1 is required for its cytoplasmic localization and function in promoting neurite outgrowth</article-title>
        <source>Cell Rep.</source>
        <year>2018</year>
        <volume>22</volume>
        <fpage>2294</fpage>
        <lpage>2306</lpage>
        <?supplied-pmid 29490267?>
        <pub-id pub-id-type="pmid">29490267</pub-id>
      </element-citation>
    </ref>
    <ref id="CR65">
      <label>65.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Sta Maria</surname>
            <given-names>NS</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Mbnl1 and Mbnl2 regulate brain structural integrity in mice</article-title>
        <source>Commun. Biol.</source>
        <year>2021</year>
        <volume>4</volume>
        <fpage>1342</fpage>
        <?supplied-pmid 34848815?>
        <pub-id pub-id-type="pmid">34848815</pub-id>
      </element-citation>
    </ref>
    <ref id="CR66">
      <label>66.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Derrick</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>White</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Toher</surname>
            <given-names>D</given-names>
          </name>
        </person-group>
        <article-title>Parametric and non-parametric tests for the comparison of two samples which both include paired and unpaired observations</article-title>
        <source>J. Mod. Appl. Stat. Methods</source>
        <year>2019</year>
        <volume>18</volume>
        <fpage>2</fpage>
        <lpage>23</lpage>
      </element-citation>
    </ref>
    <ref id="CR67">
      <label>67.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Supek</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Bošnjak</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Škunca</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Šmuc</surname>
            <given-names>T</given-names>
          </name>
        </person-group>
        <article-title>REVIGO summarizes and visualizes long lists of gene ontology terms</article-title>
        <source>PLoS One</source>
        <year>2011</year>
        <volume>6</volume>
        <fpage>e21800</fpage>
        <?supplied-pmid 21789182?>
        <pub-id pub-id-type="pmid">21789182</pub-id>
      </element-citation>
    </ref>
    <ref id="CR68">
      <label>68.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>MacNicol</surname>
            <given-names>MC</given-names>
          </name>
          <name>
            <surname>Cragle</surname>
            <given-names>CE</given-names>
          </name>
          <name>
            <surname>MacNicol</surname>
            <given-names>AM</given-names>
          </name>
        </person-group>
        <article-title>Context-dependent regulation of Musashi-mediated mRNA translation and cell cycle regulation</article-title>
        <source>Cell Cycle</source>
        <year>2011</year>
        <volume>10</volume>
        <fpage>39</fpage>
        <lpage>44</lpage>
        <?supplied-pmid 21191181?>
        <pub-id pub-id-type="pmid">21191181</pub-id>
      </element-citation>
    </ref>
    <ref id="CR69">
      <label>69.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Okano</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Imai</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Okabe</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>Musashi: A translational regulator of cell fate</article-title>
        <source>J. Cell Sci.</source>
        <year>2002</year>
        <volume>115</volume>
        <fpage>1355</fpage>
        <lpage>1359</lpage>
        <?supplied-pmid 11896183?>
        <pub-id pub-id-type="pmid">11896183</pub-id>
      </element-citation>
    </ref>
    <ref id="CR70">
      <label>70.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Li</surname>
            <given-names>HJ</given-names>
          </name>
          <name>
            <surname>Haque</surname>
            <given-names>ZK</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Mendelsohn</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>RIF-1, a novel nuclear receptor corepressor that associates with the nuclear matrix</article-title>
        <source>J. Cell. Biochem.</source>
        <year>2007</year>
        <volume>102</volume>
        <fpage>1021</fpage>
        <lpage>1035</lpage>
        <?supplied-pmid 17455211?>
        <pub-id pub-id-type="pmid">17455211</pub-id>
      </element-citation>
    </ref>
    <ref id="CR71">
      <label>71.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Tang</surname>
            <given-names>SJ</given-names>
          </name>
          <name>
            <surname>Meulemans</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Vazquez</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Colaco</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Schuman</surname>
            <given-names>E</given-names>
          </name>
        </person-group>
        <article-title>A role for a rat homolog of staufen in the transport of RNA to neuronal dendrites</article-title>
        <source>Neuron</source>
        <year>2001</year>
        <volume>32</volume>
        <fpage>463</fpage>
        <lpage>475</lpage>
        <?supplied-pmid 11709157?>
        <pub-id pub-id-type="pmid">11709157</pub-id>
      </element-citation>
    </ref>
    <ref id="CR72">
      <label>72.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Gleghorn</surname>
            <given-names>ML</given-names>
          </name>
          <name>
            <surname>Gong</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Kielkopf</surname>
            <given-names>CL</given-names>
          </name>
          <name>
            <surname>Maquat</surname>
            <given-names>LE</given-names>
          </name>
        </person-group>
        <article-title>Staufen1 dimerizes through a conserved motif and a degenerate dsRNA-binding domain to promote mRNA decay</article-title>
        <source>Nat. Struct. Mol. Biol.</source>
        <year>2013</year>
        <volume>20</volume>
        <fpage>515</fpage>
        <lpage>524</lpage>
        <?supplied-pmid 23524536?>
        <pub-id pub-id-type="pmid">23524536</pub-id>
      </element-citation>
    </ref>
    <ref id="CR73">
      <label>73.</label>
      <mixed-citation publication-type="other">McInnes, L., Healy, J. &amp; Melville, J. UMAP: Uniform manifold approximation and projection for dimension reduction. Preprint at <ext-link ext-link-type="uri" xlink:href="https://arxiv.org/abs/1802.03426">https://arxiv.org/abs/1802.03426</ext-link> (2020).</mixed-citation>
    </ref>
    <ref id="CR74">
      <label>74.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Masood</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Grimm</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>El-Bahrawy</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Yagüe</surname>
            <given-names>E</given-names>
          </name>
        </person-group>
        <article-title>TMEFF2: A transmembrane proteoglycan with multifaceted actions in cancer and disease</article-title>
        <source>Cancers</source>
        <year>2020</year>
        <volume>12</volume>
        <fpage>E3862</fpage>
        <?supplied-pmid 33371267?>
        <pub-id pub-id-type="pmid">33371267</pub-id>
      </element-citation>
    </ref>
    <ref id="CR75">
      <label>75.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Jen</surname>
            <given-names>Y-HL</given-names>
          </name>
          <name>
            <surname>Musacchio</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Lander</surname>
            <given-names>AD</given-names>
          </name>
        </person-group>
        <article-title>Glypican-1 controls brain size through regulation of fibroblast growth factor signaling in early neurogenesis</article-title>
        <source>Neural Dev.</source>
        <year>2009</year>
        <volume>4</volume>
        <fpage>33</fpage>
        <?supplied-pmid 19732411?>
        <pub-id pub-id-type="pmid">19732411</pub-id>
      </element-citation>
    </ref>
    <ref id="CR76">
      <label>76.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Fu</surname>
            <given-names>XD</given-names>
          </name>
          <name>
            <surname>Ares</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>Context-dependent control of alternative splicing by RNA-binding proteins</article-title>
        <source>Nat. Rev. Genet.</source>
        <year>2014</year>
        <volume>15</volume>
        <fpage>689</fpage>
        <lpage>701</lpage>
        <?supplied-pmid 25112293?>
        <pub-id pub-id-type="pmid">25112293</pub-id>
      </element-citation>
    </ref>
    <ref id="CR77">
      <label>77.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Saha</surname>
            <given-names>A</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Co-expression networks reveal the tissue-specific regulation of transcription and splicing</article-title>
        <source>Genome Res.</source>
        <year>2017</year>
        <volume>27</volume>
        <fpage>1843</fpage>
        <lpage>1858</lpage>
        <?supplied-pmid 29021288?>
        <pub-id pub-id-type="pmid">29021288</pub-id>
      </element-citation>
    </ref>
    <ref id="CR78">
      <label>78.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Aghamirzaie</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Collakova</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Grene</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>CoSpliceNet: a framework for co-splicing network inference from transcriptomics data</article-title>
        <source>BMC Genomics</source>
        <year>2016</year>
        <volume>17</volume>
        <fpage>845</fpage>
        <?supplied-pmid 27793091?>
        <pub-id pub-id-type="pmid">27793091</pub-id>
      </element-citation>
    </ref>
    <ref id="CR79">
      <label>79.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zhang</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Southey</surname>
            <given-names>BR</given-names>
          </name>
          <name>
            <surname>Rodriguez-Zas</surname>
            <given-names>SL</given-names>
          </name>
        </person-group>
        <article-title>Co-expression networks uncover regulation of splicing and transcription markers of disease</article-title>
        <source>EPiC Ser. Comput.</source>
        <year>2020</year>
        <volume>70</volume>
        <fpage>119</fpage>
        <lpage>128</lpage>
      </element-citation>
    </ref>
    <ref id="CR80">
      <label>80.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Chau</surname>
            <given-names>K</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Isoform transcriptome of developing human brain provides new insights into autism</article-title>
        <source>Cell Rep.</source>
        <year>2021</year>
        <volume>36</volume>
        <fpage>109631</fpage>
        <?supplied-pmid 34469739?>
        <pub-id pub-id-type="pmid">34469739</pub-id>
      </element-citation>
    </ref>
    <ref id="CR81">
      <label>81.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Vu</surname>
            <given-names>TN</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Isoform-level gene expression patterns in single-cell RNA-sequencing data</article-title>
        <source>Bioinformatics</source>
        <year>2018</year>
        <volume>10</volume>
        <fpage>1</fpage>
        <lpage>9</lpage>
      </element-citation>
    </ref>
    <ref id="CR82">
      <label>82.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Yap</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Xiao</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Friedman</surname>
            <given-names>BA</given-names>
          </name>
          <name>
            <surname>Je</surname>
            <given-names>HS</given-names>
          </name>
          <name>
            <surname>Makeyev</surname>
            <given-names>EV</given-names>
          </name>
        </person-group>
        <article-title>Polarizing the neuron through sustained co-expression of alternatively spliced isoforms</article-title>
        <source>Cell Rep.</source>
        <year>2016</year>
        <volume>15</volume>
        <fpage>1316</fpage>
        <lpage>1328</lpage>
        <?supplied-pmid 27134173?>
        <pub-id pub-id-type="pmid">27134173</pub-id>
      </element-citation>
    </ref>
    <ref id="CR83">
      <label>83.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ma</surname>
            <given-names>J</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Comprehensive expression-based isoform biomarkers predictive of drug responses based on isoform co-expression networks and clinical data</article-title>
        <source>Genomics</source>
        <year>2020</year>
        <volume>112</volume>
        <fpage>647</fpage>
        <lpage>658</lpage>
        <?supplied-pmid 31029864?>
        <pub-id pub-id-type="pmid">31029864</pub-id>
      </element-citation>
    </ref>
    <ref id="CR84">
      <label>84.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ma</surname>
            <given-names>J-Q</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Differential alternative splicing genes and isoform regulation networks of rapeseed (Brassica napus L.) infected with Sclerotinia sclerotiorum</article-title>
        <source>Genes</source>
        <year>2020</year>
        <volume>11</volume>
        <fpage>784</fpage>
      </element-citation>
    </ref>
    <ref id="CR85">
      <label>85.</label>
      <mixed-citation publication-type="other">Bray, N. The power of 3′ UTRs. <italic>Nat. Rev. Neurosci</italic>. 10.1038/s41583-018-0011-6 (2018).</mixed-citation>
    </ref>
    <ref id="CR86">
      <label>86.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bae</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Miura</surname>
            <given-names>P</given-names>
          </name>
        </person-group>
        <article-title>Emerging roles for 3′ UTRs in neurons</article-title>
        <source>Int. J. Mol. Sci.</source>
        <year>2020</year>
        <volume>21</volume>
        <fpage>3413</fpage>
      </element-citation>
    </ref>
    <ref id="CR87">
      <label>87.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Picelli</surname>
            <given-names>S</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Tn5 transposase and tagmentation procedures for massively scaled sequencing projects</article-title>
        <source>Genome Res.</source>
        <year>2014</year>
        <volume>24</volume>
        <fpage>2033</fpage>
        <lpage>2040</lpage>
        <?supplied-pmid 25079858?>
        <pub-id pub-id-type="pmid">25079858</pub-id>
      </element-citation>
    </ref>
    <ref id="CR88">
      <label>88.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Dobin</surname>
            <given-names>A</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>STAR: Ultrafast universal RNA-seq aligner</article-title>
        <source>Bioinformatics</source>
        <year>2013</year>
        <volume>29</volume>
        <fpage>15</fpage>
        <lpage>21</lpage>
        <?supplied-pmid 23104886?>
        <pub-id pub-id-type="pmid">23104886</pub-id>
      </element-citation>
    </ref>
    <ref id="CR89">
      <label>89.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Li</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Dewey</surname>
            <given-names>CN</given-names>
          </name>
        </person-group>
        <article-title>RSEM: Accurate transcript quantification from RNA-Seq data with or without a reference genome</article-title>
        <source>BMC Bioinform.</source>
        <year>2011</year>
        <volume>12</volume>
        <fpage>323</fpage>
      </element-citation>
    </ref>
    <ref id="CR90">
      <label>90.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Tarazona</surname>
            <given-names>S</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Data quality aware analysis of differential expression in RNA-seq with NOISeq R/Bioc package</article-title>
        <source>Nucleic Acids Res.</source>
        <year>2015</year>
        <volume>43</volume>
        <fpage>gkv711</fpage>
      </element-citation>
    </ref>
    <ref id="CR91">
      <label>91.</label>
      <mixed-citation publication-type="other">R Core Team. <italic>R: A Language and Environment for Statistical Computing</italic> (R Foundation for Statistical Computing, 2021).</mixed-citation>
    </ref>
    <ref id="CR92">
      <label>92.</label>
      <mixed-citation publication-type="other">Venables, W. &amp; Ripley, B. <italic>Modern Applied Statistics with S</italic> (Springer, 2002).</mixed-citation>
    </ref>
    <ref id="CR93">
      <label>93.</label>
      <mixed-citation publication-type="other">Fox, J. &amp; Weisberg, S. <italic>An R Companion to Applied Regression</italic> (Sage, 2019).</mixed-citation>
    </ref>
    <ref id="CR94">
      <label>94.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Young</surname>
            <given-names>MD</given-names>
          </name>
          <name>
            <surname>Wakefield</surname>
            <given-names>MJ</given-names>
          </name>
          <name>
            <surname>Smyth</surname>
            <given-names>GK</given-names>
          </name>
          <name>
            <surname>Oshlack</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>Gene ontology analysis for RNA-seq: accounting for selection bias</article-title>
        <source>Genome Biol.</source>
        <year>2010</year>
        <volume>11</volume>
        <fpage>R14</fpage>
        <?supplied-pmid 2872874?>
        <pub-id pub-id-type="pmid">20132535</pub-id>
      </element-citation>
    </ref>
    <ref id="CR95">
      <label>95.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bray</surname>
            <given-names>NL</given-names>
          </name>
          <name>
            <surname>Pimentel</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Melsted</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Pachter</surname>
            <given-names>L</given-names>
          </name>
        </person-group>
        <article-title>Near-optimal probabilistic RNA-seq quantification</article-title>
        <source>Nat. Biotechnol.</source>
        <year>2016</year>
        <volume>34</volume>
        <fpage>525</fpage>
        <lpage>527</lpage>
        <?supplied-pmid 27043002?>
        <pub-id pub-id-type="pmid">27043002</pub-id>
      </element-citation>
    </ref>
    <ref id="CR96">
      <label>96.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>O’Leary</surname>
            <given-names>NA</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Reference sequence (RefSeq) database at NCBI: Current status, taxonomic expansion, and functional annotation</article-title>
        <source>Nucleic Acids Res.</source>
        <year>2016</year>
        <volume>44</volume>
        <fpage>D733</fpage>
        <lpage>D745</lpage>
        <?supplied-pmid 26553804?>
        <pub-id pub-id-type="pmid">26553804</pub-id>
      </element-citation>
    </ref>
    <ref id="CR97">
      <label>97.</label>
      <mixed-citation publication-type="other">Arzalluz-Luque, A. acorde: Unraveling functionally interpretable networks of isoform co-usage from single cell data. <italic>GitHub</italic>10.5281/zenodo.6341636 (2022).</mixed-citation>
    </ref>
  </ref-list>
</back>
