<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.2 20190208//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.2?>
<?ConverterInfo.XSLTName jats2jats3.xsl?>
<?ConverterInfo.Version 1?>
<?properties open_access?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Brief Bioinform</journal-id>
    <journal-id journal-id-type="iso-abbrev">Brief Bioinform</journal-id>
    <journal-id journal-id-type="publisher-id">bib</journal-id>
    <journal-title-group>
      <journal-title>Briefings in Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1467-5463</issn>
    <issn pub-type="epub">1477-4054</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">10981759</article-id>
    <article-id pub-id-type="pmid">38555470</article-id>
    <article-id pub-id-type="doi">10.1093/bib/bbae112</article-id>
    <article-id pub-id-type="publisher-id">bbae112</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Problem Solving Protocol</subject>
      </subj-group>
      <subj-group subj-group-type="category-taxonomy-collection">
        <subject>AcademicSubjects/SCI01060</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>scNovel: a scalable deep learning-based network for novel rare cell discovery in single-cell transcriptomics</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Zheng</surname>
          <given-names>Chuanyang</given-names>
        </name>
        <aff><institution>Department of Computer Science and Engineering</institution>, <addr-line>CUHK, Hong Kong SAR</addr-line>, <country country="CN">China</country></aff>
        <xref rid="afn1" ref-type="author-notes"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Wang</surname>
          <given-names>Yixuan</given-names>
        </name>
        <aff><institution>Department of Computer Science and Engineering</institution>, <addr-line>CUHK, Hong Kong SAR</addr-line>, <country country="CN">China</country></aff>
        <xref rid="afn1" ref-type="author-notes"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Cheng</surname>
          <given-names>Yuqi</given-names>
        </name>
        <aff><institution>College of Computing, Georgia Institute of Technology</institution>, <addr-line>Atlanta, GA</addr-line>, <country country="US">USA</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Wang</surname>
          <given-names>Xuesong</given-names>
        </name>
        <aff><institution>Department of Computer Science and Engineering</institution>, <addr-line>CUHK, Hong Kong SAR</addr-line>, <country country="CN">China</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Wei</surname>
          <given-names>Hongxin</given-names>
        </name>
        <aff>
          <institution>MLR Lab, Southern University of Science and Technology</institution>
        </aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>King</surname>
          <given-names>Irwin</given-names>
        </name>
        <aff><institution>Department of Computer Science and Engineering</institution>, <addr-line>CUHK, Hong Kong SAR</addr-line>, <country country="CN">China</country></aff>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <name>
          <surname>Li</surname>
          <given-names>Yu</given-names>
        </name>
        <!--liyu@cse.cuhk.edu.hk-->
        <aff><institution>Department of Computer Science and Engineering</institution>, <addr-line>CUHK, Hong Kong SAR</addr-line>, <country country="CN">China</country></aff>
        <aff><institution>The CUHK Shenzhen Research Institute</institution>, <addr-line>Hi-Tech Park, Nanshan, Shenzhen 518057</addr-line>, <country country="CN">China</country></aff>
        <aff><institution>Institute for Medical Enginering and Science, Massachusetts Institute of Technology</institution>, <addr-line>Cambridge, MA</addr-line>, <country country="US">USA</country></aff>
        <aff><institution>Wyss Institute for Biologically Inspired Engineering, Harvard University</institution>, <addr-line>Boston, MA</addr-line>, <country country="US">USA</country></aff>
        <aff><institution>Broad Institute of MIT and Harvard, Cambridge</institution>, <addr-line>MA</addr-line>, <country country="US">USA</country></aff>
        <xref rid="cor1" ref-type="corresp"/>
      </contrib>
    </contrib-group>
    <author-notes>
      <corresp id="cor1">Corresponding author. Yu Li, E-mail: <email>liyu@cse.cuhk.edu.hk</email></corresp>
      <fn id="afn1">
        <p>Chuanyang Zheng and Yixuan Wang contributed equally.</p>
      </fn>
    </author-notes>
    <pub-date pub-type="collection">
      <month>5</month>
      <year>2024</year>
    </pub-date>
    <pub-date pub-type="epub" iso-8601-date="2024-03-28">
      <day>28</day>
      <month>3</month>
      <year>2024</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>28</day>
      <month>3</month>
      <year>2024</year>
    </pub-date>
    <volume>25</volume>
    <issue>3</issue>
    <elocation-id>bbae112</elocation-id>
    <history>
      <date date-type="received">
        <day>13</day>
        <month>12</month>
        <year>2023</year>
      </date>
      <date date-type="rev-recd">
        <day>5</day>
        <month>2</month>
        <year>2024</year>
      </date>
      <date date-type="accepted">
        <day>20</day>
        <month>2</month>
        <year>2024</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2024. Published by Oxford University Press.</copyright-statement>
      <copyright-year>2024</copyright-year>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">https://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted reuse, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <self-uri xlink:href="bbae112.pdf"/>
    <abstract>
      <title>Abstract</title>
      <p>Single-cell RNA sequencing has achieved massive success in biological research fields. Discovering novel cell types from single-cell transcriptomics has been demonstrated to be essential in the field of biomedicine, yet is time-consuming and needs prior knowledge. With the unprecedented boom in cell atlases, auto-annotation tools have become more prevalent due to their speed, accuracy and user-friendly features. However, existing tools have mostly focused on general cell-type annotation and have not adequately addressed the challenge of discovering novel rare cell types. In this work, we introduce scNovel, a powerful deep learning-based neural network that specifically focuses on novel rare cell discovery. By testing our model on diverse datasets with different scales, protocols and degrees of imbalance, we demonstrate that scNovel significantly outperforms previous state-of-the-art novel cell detection models, reaching the most AUROC performance(the only one method whose averaged AUROC results are above 94%, up to 16.26% more comparing to the second-best method). We validate scNovel’s performance on a million-scale dataset to illustrate the scalability of scNovel further. Applying scNovel on a clinical COVID-19 dataset, three potential novel subtypes of Macrophages are identified, where the COVID-related differential genes are also detected to have consistent expression patterns through deeper analysis. We believe that our proposed pipeline will be an important tool for high-throughput clinical data in a wide range of applications.</p>
    </abstract>
    <kwd-group>
      <kwd>novel rare cell discovery</kwd>
      <kwd>single-cell analysis</kwd>
      <kwd>neural network</kwd>
    </kwd-group>
    <funding-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>Research Grants Council of the Hong Kong Special Administrative Region</institution>
          </institution-wrap>
        </funding-source>
        <award-id>CUHK 24204023</award-id>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>Innovation and Technology Commission of the Hong Kong Special Administrative Region</institution>
          </institution-wrap>
        </funding-source>
        <award-id>GHP/065/21SZ</award-id>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>Chinese University of Hong Kong</institution>
            <institution-id institution-id-type="DOI">10.13039/501100004853</institution-id>
          </institution-wrap>
        </funding-source>
        <award-id>4937025</award-id>
        <award-id>4937026</award-id>
        <award-id>5501517</award-id>
        <award-id>5501329</award-id>
      </award-group>
    </funding-group>
    <counts>
      <page-count count="15"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec id="sec1">
    <title>INTRODUCTION</title>
    <p>Single-cell RNA sequencing (scRNA-seq), established by Tang et al. in 2009 [<xref rid="ref1" ref-type="bibr">1</xref>], rapidly becomes popular and important in various biological research field analyses. As a powerful method to profile cell-specific level transcriptome, scRNA-seq makes it possible to analyze individual cells and provide insight into cell heterogeneity and has been widely used in organismal atlases generation [<xref rid="ref2" ref-type="bibr">2–6</xref>], COVID analysis [<xref rid="ref7" ref-type="bibr">7–9</xref>], cancer research [<xref rid="ref10" ref-type="bibr">10</xref>, <xref rid="ref11" ref-type="bibr">11</xref>], developmental biology research [<xref rid="ref12" ref-type="bibr">12</xref>], and so on.</p>
    <p>Cell type-specific analysis is a crucial topic in single-cell research and is traditionally carried out by grouping the cell points and then labeling them with marker genes [<xref rid="ref13" ref-type="bibr">13–15</xref>]. Auto-annotation tools are taking over as a result of the unheard-of surge in the production of cell atlases and their advantages in terms of speed, accuracy, and user-friendliness [<xref rid="ref16" ref-type="bibr">16</xref>]. In real-world single-cell analysis scenarios, the query dataset may contain novel cell types unseen in the reference set, and the distributions of the reference set and query set usually differ significantly. Hence, it is essential for a tool to not only precisely categorize cell types for query cells but also identify novel cell types that are not present in the reference dataset. Studies have shown the importance of discovering novel rare cells in the fields of biology and medicine. For instance, malignant tumors consist of a minority group of specific cancer stem cells (usually less than 1–2% of the total tumor cells based on the expression of certain cell surface markers) that possess a significant proliferative capacity [<xref rid="ref17" ref-type="bibr">17</xref>]. Thus, the capability of identifying novel rare cells in individual patients could lead to more personalized treatment approaches based on their unique cellular makeup [<xref rid="ref18" ref-type="bibr">18</xref>, <xref rid="ref19" ref-type="bibr">19</xref>]. However, most prior auto-annotation research concentrated on generic cell-type annotation [<xref rid="ref20" ref-type="bibr">20–24</xref>] and paid little attention to novel rare cell discovery.</p>
    <p>There have been previous endeavors in the field of novel cell discovery. scmap-cluster performs a nearest neighbor search to identify potential matches between cells from different datasets, and uses this information to construct a graph that captures the relationships between cells and clusters them based on their similarity [<xref rid="ref25" ref-type="bibr">25</xref>]. Similarly, scmap-cell uses an approximate nearest neighbor search method to efficiently find the K-nearest neighbors between the reference and query datasets, which helps reduce the computational complexity and improve the scalability of the algorithm when dealing with large datasets [<xref rid="ref25" ref-type="bibr">25</xref>]. scPred adopted a random forest classifier to predict cell-type labels, and incorporates unbiased feature selection and dimensionality reduction techniques to improve the accuracy and interpretability of the model [<xref rid="ref26" ref-type="bibr">26</xref>]. Through routine normalization, discriminative component analysis and learned transformation matrix, scLearn [<xref rid="ref27" ref-type="bibr">27</xref>] achieves the best performance on novel class detection, compared to the other previous methods. The major limitation of previous work is no one focused on novel rare cell detection and mainly utilized principal component analysis or discriminative component analysis for feature extraction so that the generated novel rare cell feature may lose information [<xref rid="ref28" ref-type="bibr">28</xref>]. The previous SOTA model scLearn even adds a method named rare cell-type filtering to remove rare cells from datasets.</p>
    <p>In this paper, we propose an integrated neural network framework, scNovel, that leverages barcode preprocessing for the auto-detection task. We develop two optional query stage options: the parallel query stage and the sequential query stage. Accordingly, barcode preprocessing is utilized to boost model performance via four modes of novel cell detection. To demonstrate the performance of novel rare cell detection performance of our method, we validate scNovel on various real datasets with different scales, different protocols, and different imbalance degrees. scNovel significantly outperforms previous state-of-the-art novel cell detection models, achieving the highest AUROC performance with statistical significance. scNovel is the only method whose averaged AUROC results are above 94%, up to 16.26% more compared to the second-best one. Furthermore, the scalability of scNovel is demonstrated through the robustness and efficiency across different scales of datasets. It is worth noticing that our work is the first and only novel rare cell discovery tool validated on a million-level atlas [<xref rid="ref29" ref-type="bibr">29</xref>]. We further apply scNovel on a clinical COVID-19 dataset, discover three potential novel subtypes of Macrophages and conduct a deeper analysis of the disease-related genes’ expression pattern.</p>
  </sec>
  <sec id="sec2">
    <title>METHODS</title>
    <sec id="sec2a">
      <title>A scalable neural nNetwork for novel rare cell-type discovery</title>
      <p>The basic architecture of our propsoed scNovel is a deep-neural-network-based classifier. As shown in <xref rid="f1" ref-type="fig">Figure 1</xref>, scNovel takes single-cell gene expression as input and outputs the novel cell detection result based on the classifier cell-type probability and the threshold <inline-formula><tex-math notation="LaTeX" id="ImEquation1">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\lambda $\end{document}</tex-math></inline-formula>. There are two stages of using scNovel. During the training stage, we adopt cross-entropy loss to train the model to output cell types’ probability prediction after the classifier. During the query stage, if <inline-formula><tex-math notation="LaTeX" id="ImEquation2">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$p(x)$\end{document}</tex-math></inline-formula> is smaller than the threshold, then the corresponding cells are determined as novel. To assess the novelty of a given cell type, we design four novel cell detection modes according to the selected query stage option, namely traditional classification mode, single plus-composition mode, parallel composition mode, as well as sequential composition mode (refer to more details in <xref rid="f7" ref-type="fig">Appendix Figure 1</xref>. A thorough explanation of the model framework and training strategy can be found in <xref rid="app3" ref-type="app">Appendix C</xref>. Once the considered score is over the threshold <inline-formula><tex-math notation="LaTeX" id="ImEquation3">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\lambda $\end{document}</tex-math></inline-formula> (usually defined as 0.5), we ascertain it to be novel. Through the conduction of comprehensive experiments, the predictive power of scNovel is promising even if the cell number and proportion are very small (17 cells out of a million cells). We use AUROC as our main evaluation metric while adopting AUPR and FPR95 metrics for additional reference. Please consult <xref rid="app2" ref-type="app">Appendix B</xref> for a detailed description of the evaluation metrics.</p>
      <fig position="float" id="f1">
        <label>Figure 1</label>
        <caption>
          <p>Overview of scNovel. The input <inline-formula><tex-math notation="LaTeX" id="ImEquation4">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\boldsymbol{x}$\end{document}</tex-math></inline-formula> is a single-cell gene expression. We employ a neural network to extract the single-cell feature. Then, map it <inline-formula><tex-math notation="LaTeX" id="ImEquation5">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$C^{ref}$\end{document}</tex-math></inline-formula> dimension to get cell-type probability prediction <inline-formula><tex-math notation="LaTeX" id="ImEquation6">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$p( \boldsymbol{x})$\end{document}</tex-math></inline-formula>. During the training stage, we employ the cross-entropy loss to optimize the network. We introduce two optional query stages, where barcode preprocessing is utilized to augment the predictive capabilities of scNovel. During the query stage, if <inline-formula><tex-math notation="LaTeX" id="ImEquation7">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$p(x)$\end{document}</tex-math></inline-formula> is smaller than the threshold, then the corresponding cells are determined as novel. In addition to separating novel cells from typical ones, scNovel could be extended to downstream analysis, including novel rare cell clusters detection and gene analysis.</p>
        </caption>
        <graphic xlink:href="bbae112f1" position="float"/>
      </fig>
    </sec>
  </sec>
  <sec id="sec3">
    <title>RESULTS</title>
    <sec id="sec3a">
      <title>Comprehensive assessment of the detection performance of scNovel</title>
      <p>In this section, we compare the performance of our method against existing cell-type classification tools, including scmap-cell and scmap-cluster [<xref rid="ref25" ref-type="bibr">25</xref>], scPred [<xref rid="ref26" ref-type="bibr">26</xref>] and scLearn [<xref rid="ref27" ref-type="bibr">27</xref>]. To ensure that our benchmark comparison is conducted under equitable experimental conditions, we employed a standardized preprocessing procedure for all the benchmark datasets and maintained the default values of all parameters for each method. We considered datasets from diverse imbalance degrees, diverse cell numbers, as well as diverse sequencing platforms to guarantee a more comprehensive comparison. Detailed re-implement and datasets’ information can be found in Appendices <xref rid="app1" ref-type="app">A</xref> and <xref rid="app3f" ref-type="sec">C.6</xref>. As detailed in <xref rid="TB1" ref-type="table">Appendix Table 1</xref>, our selection of datasets encompasses a wide range of widely utilized single-cell sequencing technologies, including 10Xv2 and 10Xv3, and so on. This broad spectrum of technologies was deliberately chosen to provide a robust validation of our method across different platforms, ensuring its generalizability and reliability in various single-cell sequencing contexts.</p>
      <p>As shown in <xref rid="TB2" ref-type="table">Appendix Table 2</xref>, compared with previous models, our proposed scNovel significantly improves the averaged performance via having the lowest FPR95 score, the highest AUROC and the highest AUPR scores on the novel rare cells discovery task among different datasets. Detailed description of the above-mentioned evaluation metrics can be found in the <xref rid="app2" ref-type="app">Appendix B</xref>. Given our emphasis on the detection of novel and rare cells, our initial evaluation of scNovel concentrates on its performance with a limited set of novel cell classes that are absent from the training data. In this context, we use the notation <inline-formula><tex-math notation="LaTeX" id="ImEquation15">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$C^{novel}$\end{document}</tex-math></inline-formula> to represent the number of novel classes present in the test set. From the results presented in <xref rid="TB2" ref-type="table">Appendix Table 2</xref>, it is noticeable that there is a decreasing trend in performance as the number of novel classes (<inline-formula><tex-math notation="LaTeX" id="ImEquation16">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$C^{novel}$\end{document}</tex-math></inline-formula>) increases. This indicates that the task becomes progressively more challenging as the number of novel classes in the test set increases. Namely, scNovel achieves a 96.33% AUROC when <inline-formula><tex-math notation="LaTeX" id="ImEquation17">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$C^{novel}$\end{document}</tex-math></inline-formula> is equal to 1, surpassing the next best performing method, scLearn, by a substantial margin of 12.33% AUROC. Across all <inline-formula><tex-math notation="LaTeX" id="ImEquation18">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$C^{novel}$\end{document}</tex-math></inline-formula>, our scNovel gains on an average 11.75% AUROC more compared to the second best method scLearn, demonstrating that scNovel is robust for different <inline-formula><tex-math notation="LaTeX" id="ImEquation19">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$C^{novel}$\end{document}</tex-math></inline-formula>, and is outstanding compared to other models. The box plots in <xref rid="f2" ref-type="fig">Figure 2(A)</xref> further demonstrate the robustness of scNovel by showing not only higher AUROC values but also smaller interquartile ranges across various dataset sizes (<inline-formula><tex-math notation="LaTeX" id="ImEquation20">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\sim $\end{document}</tex-math></inline-formula> 1k cells to <inline-formula><tex-math notation="LaTeX" id="ImEquation21">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\sim $\end{document}</tex-math></inline-formula> 60k cells) and different protocols. The statistical analysis, using a one-tailed <italic toggle="yes">t</italic>-test, consistently demonstrates that scNovel outperforms other methods with significant statistical significance in most scenarios. This indicates that the adopted neural network shows robust performance for single-cell sequencing feature extraction and works well for novel rare-cell feature extraction. The cell-type distribution and detection results are visualized in <xref rid="f2" ref-type="fig">Figure 2(B)</xref>.</p>
      <fig position="float" id="f2">
        <label>Figure 2</label>
        <caption>
          <p>(<bold>A</bold>) AUROCs of different methods with various <inline-formula><tex-math notation="LaTeX" id="ImEquation52">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$C^{novel}$\end{document}</tex-math></inline-formula>. The box plots show that scNovel has higher mean but smaller interquartile range of AUROCs than all the other methods, showing a stable novel rare cell detection ability among various datasets and <inline-formula><tex-math notation="LaTeX" id="ImEquation53">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$C^{novel}$\end{document}</tex-math></inline-formula>. <italic toggle="yes">P</italic>-value with notation * means <italic toggle="yes">P</italic>¡0.05, with notation <inline-formula><tex-math notation="LaTeX" id="ImEquation54">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$ns$\end{document}</tex-math></inline-formula> means no significance. The heatmaps show the detailed AUROC values of different methods and datasets. (<bold>B</bold>) Cell-type UMAP visualization of Zilionis dataset. (<bold>C</bold>) The AUROC curves of various methods are evaluated, with scNovel demonstrating superior TPR over all other methods, regardless of the FPR. (<bold>D</bold>) UMAP visualization of the novel cell discovery task on the Zilionis dataset with <inline-formula><tex-math notation="LaTeX" id="ImEquation55">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$C^{novel}$\end{document}</tex-math></inline-formula>=2. The result of scNovel is the closest to the ground truth, while the other ones have too many false positive predictions. scNovel outperforms other methods in detecting novel rare cell types, uniquely identifying pDC and RBC. Unlike scLearn, scPred, scmap-cell and scmap-cluster, which inaccurately annotate T cells and Neutrophils, scNovel achieves the most precise detection across all cell types, successfully pinpointing RBC and pDC.</p>
        </caption>
        <graphic xlink:href="bbae112f2" position="float"/>
      </fig>
      <p>We also show the AUROC curves in <xref rid="f2" ref-type="fig">Figure 2(C)</xref>. for the Zilionis dataset with <inline-formula><tex-math notation="LaTeX" id="ImEquation56">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$C^{novel}=2$\end{document}</tex-math></inline-formula>. According to the AUROC curve, we could find that scNovel not only dominates in AUROC space [<xref rid="ref30" ref-type="bibr">30</xref>] but also achieves superior true positive rate (TPR) over all other methods, regardless of the FPR. As shown in <xref rid="f2" ref-type="fig">Figure 2(B and D)</xref>, Notably, scNovel has the best novel rare cell detection performance and is the only method that can detect the two novel rare cell types, including plasmacytoid dendritic cell (pDC) and red blood cell (RBC). Compared with the ground truth label, scLearn, scPred, scmap-cell and scmap-cluster give more incorrect annotations on the T cell and Neutrophils than scNovel. scPred even almost fails on this task, as it detects the majority of cells to be novel. In contrast, scNovel demonstrates the most accurate novel rare cell detection result on all cell types and successfully finds the two novel rare cells, RBC and pDC.</p>
    </sec>
    <sec id="sec3b">
      <title>Consistent performance with various C<sup>novel</sup> in different modes</title>
      <p>In this section, we investigate our model performance with various novel cell class numbers <inline-formula><tex-math notation="LaTeX" id="ImEquation58">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$C^{novel}$\end{document}</tex-math></inline-formula> in different modes. We begin with showing our model performance with four different query modes:</p>
      <list list-type="bullet">
        <list-item>
          <p><inline-formula><tex-math notation="LaTeX" id="ImEquation59">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$S^{MSP}$\end{document}</tex-math></inline-formula> in Equation (<xref rid="deqn06" ref-type="disp-formula">C6</xref>), which uses the maximum prediction probability as score;</p>
        </list-item>
        <list-item>
          <p><inline-formula><tex-math notation="LaTeX" id="ImEquation60">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$S^{ODIN}$\end{document}</tex-math></inline-formula> in Equation (<xref rid="deqn10" ref-type="disp-formula">C10</xref>), which utilizes only <inline-formula><tex-math notation="LaTeX" id="ImEquation61">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$T_{minus}$\end{document}</tex-math></inline-formula> barcode preprocessing;</p>
        </list-item>
        <list-item>
          <p><inline-formula><tex-math notation="LaTeX" id="ImEquation62">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$S^{SEQ}$\end{document}</tex-math></inline-formula> in Equation (<xref rid="deqn13" ref-type="disp-formula">C13</xref>), which sequentially utilizes <inline-formula><tex-math notation="LaTeX" id="ImEquation63">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$T_{minus}$\end{document}</tex-math></inline-formula> and <inline-formula><tex-math notation="LaTeX" id="ImEquation64">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$T_{plus}$\end{document}</tex-math></inline-formula> barcode preprocessing;</p>
        </list-item>
        <list-item>
          <p><inline-formula><tex-math notation="LaTeX" id="ImEquation65">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$S^{SIM}$\end{document}</tex-math></inline-formula> in Equation (<xref rid="deqn12" ref-type="disp-formula">C12</xref>), which simultaneously employs <inline-formula><tex-math notation="LaTeX" id="ImEquation66">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$T_{minus}$\end{document}</tex-math></inline-formula> and <inline-formula><tex-math notation="LaTeX" id="ImEquation67">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$T_{plus}$\end{document}</tex-math></inline-formula> barcode preprocessing.</p>
        </list-item>
      </list>
      <p>Through the detailed ablation study (<xref rid="TB4" ref-type="table">Appendix Table 4</xref> and <xref rid="f3" ref-type="fig">Figure 3A</xref>), we come to the conclusion that <inline-formula><tex-math notation="LaTeX" id="ImEquation68">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$S^{SIM}$\end{document}</tex-math></inline-formula> should be the best mode for novel rare cell-type discovery tasks. Therefore, future efforts will focus on devising more sophisticated methods, potentially exploring various forms of sharpness metrics (as shown in Equations <xref rid="deqn12" ref-type="disp-formula">C12</xref> and <xref rid="deqn13" ref-type="disp-formula">C13</xref>), to enhance the distinction between typical and novel cells, thereby further elevating the model’s performance. We then investigate scNovel’s performance with different <inline-formula><tex-math notation="LaTeX" id="ImEquation69">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$C^{novel}$\end{document}</tex-math></inline-formula> of <inline-formula><tex-math notation="LaTeX" id="ImEquation70">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$S^{SIM}$\end{document}</tex-math></inline-formula> mode in <xref rid="f3" ref-type="fig">Figure 3(B and C)</xref> in detail. Overall, scNovel has the best average performance across all datasets, as well as has the smallest variance (<xref rid="f3" ref-type="fig">Figure 3C</xref>) when <inline-formula><tex-math notation="LaTeX" id="ImEquation71">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$C^{novel}$\end{document}</tex-math></inline-formula> is 1. To be specific, scNovel gets 22.82% FPR95, 96.33% AUROC and 99.76% AUPR when the model is only required to predict one novel cell type. Detailed AUROC performance on each dataset is shown in <xref rid="f3" ref-type="fig">Figure 3(B)</xref>. Intuitively, as <inline-formula><tex-math notation="LaTeX" id="ImEquation72">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$C^{novel}$\end{document}</tex-math></inline-formula> increases, the novel cell distribution <inline-formula><tex-math notation="LaTeX" id="ImEquation73">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\mathcal{P}_{novel}$\end{document}</tex-math></inline-formula> becomes more and more complicated. As a consequence, the AUROCs of <inline-formula><tex-math notation="LaTeX" id="ImEquation74">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$C^{novel}$\end{document}</tex-math></inline-formula>=2, 3 and 4 decrease to 94.29, 94.6 and 94.16%, respectively. <xref rid="f3" ref-type="fig">Figure 3(D)</xref> shows the accumulated AUROCs of each novel cell type of dataset Zillion with various <inline-formula><tex-math notation="LaTeX" id="ImEquation75">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$C^{novel}$\end{document}</tex-math></inline-formula>. <xref rid="f3" ref-type="fig">Figure 3(E)</xref> shows the corresponding data-split settings of the four <inline-formula><tex-math notation="LaTeX" id="ImEquation76">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$C^{novel}$\end{document}</tex-math></inline-formula>. With the increase of <inline-formula><tex-math notation="LaTeX" id="ImEquation77">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$C^{novel}$\end{document}</tex-math></inline-formula>, the AUROCs of RBC are stable. This also suggests that the novel rare cell detection performance of scNovel is mainly affected by the cell type, and it is robust to the various <inline-formula><tex-math notation="LaTeX" id="ImEquation78">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$C^{novel}$\end{document}</tex-math></inline-formula>. In <xref rid="f3" ref-type="fig">Figure 3(F)</xref>, we have presented a comparative analysis of UMAP visualizations for scNovel, utilizing a threshold of 0.5, against the ground truth for the task of novel cell discovery within the Zilionis dataset. This comparison indicates that our proposed scNovel method achieves consistently meaningful visualization performance across different values of <inline-formula><tex-math notation="LaTeX" id="ImEquation79">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$C^{novel}$\end{document}</tex-math></inline-formula>, employing a default threshold of 0.5.</p>
      <fig position="float" id="f3">
        <label>Figure 3</label>
        <caption>
          <p>(<bold>A</bold>) The box plots of AUROCs of different novel cell detection modes with <inline-formula><tex-math notation="LaTeX" id="ImEquation109">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$C^{novel}$\end{document}</tex-math></inline-formula> ranging from 1 to 4. (<bold>B</bold>) Heatmap of the detailed AUROC values of <inline-formula><tex-math notation="LaTeX" id="ImEquation110">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$S^{SIM}$\end{document}</tex-math></inline-formula> mode on all the considered datasets. (<bold>C</bold>) The violin plot of the <inline-formula><tex-math notation="LaTeX" id="ImEquation111">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$S^{SIM}$\end{document}</tex-math></inline-formula> mode of scNovel’s AUROCs with different novel class numbers <inline-formula><tex-math notation="LaTeX" id="ImEquation112">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$C^{novel}$\end{document}</tex-math></inline-formula> on various datasets. We could find that the performance of scNovel is stable with various <inline-formula><tex-math notation="LaTeX" id="ImEquation113">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$C^{novel}$\end{document}</tex-math></inline-formula>. (<bold>D</bold>) The accumulation bar plot of AUROC values of each novel rare cell detected from the Zillion dataset with <inline-formula><tex-math notation="LaTeX" id="ImEquation114">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$C^{novel}$\end{document}</tex-math></inline-formula> ranging from 1 to 4. (<bold>E</bold>) Taking the Zillion dataset as an example, the bar plot shows the experimental setting with different <inline-formula><tex-math notation="LaTeX" id="ImEquation115">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$C^{novel}$\end{document}</tex-math></inline-formula>. (<bold>F</bold>) The UMAP visualization comparison between scNovel and the ground truth of the novel cell discovery task on the Zilionis dataset with different <inline-formula><tex-math notation="LaTeX" id="ImEquation116">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$C^{novel}$\end{document}</tex-math></inline-formula>.</p>
        </caption>
        <graphic xlink:href="bbae112f3" position="float"/>
      </fig>
    </sec>
    <sec id="sec3c">
      <title>Superiority in rare population identification under batch effects</title>
      <p>In the real application scenario, training and applying the rare cell detection tools can be conducted on different dataset protocols and platforms with heavy batch effects. These systematic variations are crucial, particularly when analyzing rare cell populations, and must be carefully addressed to ensure accurate and reliable results. Therefore, as shown in <xref rid="f4" ref-type="fig">Figure 4(A and B)</xref>, we collect PBMCbench datasets from 10Xv2, 10Xv3, Drop-Seq, Cel-Seq, InDrop and Seq-Well are considered to evaluate scNovel’s ability to detect novel rare cells across platforms</p>
      <fig position="float" id="f4">
        <label>Figure 4</label>
        <caption>
          <p>(<bold>A</bold>) Overall novel rare cell detection AUROCs on the datasets generated by different protocols, with reference dataset PBMC Cel-Seq. (<bold>B</bold>) Overall novel rare cell detection AUROCs on the datasets generated by different protocols, with the reference dataset PBMC 10X Chromium v3. (<bold>C</bold>) The UMAP visualization of ground truth cell-type, AUROC curves and the UMAP visualization of novel cell discovery task of various methods. All methods are trained on PBMC Cel-Seq, and tested on PBMC 10X Chromium v3. Only scNovel and scLearn detect all Megakaryocyte cells, while scNovel has few false positive predictions than scLearn.</p>
        </caption>
        <graphic xlink:href="bbae112f4" position="float"/>
      </fig>
      <p>scLearn, which is the second-best model in intra-platform experiments, is shown to suffer from the effect of batch effects, achieving only 78.95% for Cel-Seq reference dataset (<xref rid="f4" ref-type="fig">Figure 4A</xref>) and 80.61% for 10Xv3 reference dataset (<xref rid="f4" ref-type="fig">Figure 4B</xref>). Our proposed scNovel outperforms scmap-cluster by 6% and scLearn by 16%, suggesting that scNovel is robust to the potential obstacles in cross-platform annotation tasks. To further investigate the performance of model performance under batch effect, we show the UMAP visualization result and AUROC results in <xref rid="f4" ref-type="fig">Figure 4(C)</xref>, with Cel-Seq as reference set and test on 10Xv3 set query set. There are two novel cell types, including Dentritic cells and Megakaryocyte. Only scNovel and scLearn successfully detect all Megakaryocyte cells, while scmap-cell, scmap-cluster, and scPred miss a part of Megakaryocyte cells. Compared with scLearn, our proposed scNovel has even fewer false positive predictions, while scLearn wrongly detects CD16+ monocyte and Cytotoxic T Cell to be novel. Also, according to the AUROC curve, we could find that our proposed scNovel has a better TPR than all other models, regardless of the FPR. This proves that our proposed scNovel upholds its excellent performance in the novel rare cell-type discovery tasks under the impact of systematic variations.</p>
    </sec>
    <sec id="sec3d">
      <title>Enhanced scalability of scNovel through robust processing efficiency in million-level dataset</title>
      <p>In the context of real-world single-cell analysis, computational efficiency is of vital importance and is viewed as the main impediment to achieving scalability. From <xref rid="f5" ref-type="fig">Figure 5A</xref>, the running time of scNovel remains relatively consistent across datasets with varying samples. For the datasets with more than 30k cells, scNovel reduces the runtime by up to 25% compared to the fastest of our four comparison models, scmap-cluster. On the analysis of the largest dataset, TM, scNovel provides a computation speed over 120 times faster than scPred, showing that our proposed method has the potential to facilitate rapid novel cell detection of large-scale datasets. Our analysis shows the model’s running time is mainly influenced by two factors: computation and weight updates, and Pytorch Dataloader preparation, which remains constant across datasets. However, smaller datasets require more frequent Dataloader preparations, leading to longer running times, as seen with the Darmanis dataset compared to the larger Zilionis dataset. Hence, dataset size directly affects the model’s overall running time. The significance of scalability for detection tools becomes more pronounced as the size of the cell atlas increases.</p>
      <fig position="float" id="f5">
        <label>Figure 5</label>
        <caption>
          <p>(<bold>A</bold>) Time complexity analysis of different methods on datasets with different scales. scNovel exhibits exceptional scalability, requiring the least amount of time even when processing TM dataset that scales up to 60k cells. (<bold>B</bold>) Experiment setting of COVID Altas. (<bold>C</bold>) The <inline-formula><tex-math notation="LaTeX" id="ImEquation117">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\mathcal{D}_{query}^{novel}$\end{document}</tex-math></inline-formula> cell number statistic and each cell-type detection results. The <inline-formula><tex-math notation="LaTeX" id="ImEquation118">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\mathcal{D}_{query}^{novel}$\end{document}</tex-math></inline-formula> has 10 cell types and total of 9332 cells. We could find that the novel rare cell detection results are not affected by the cell number. The mast, the rarest cell, is detected better than Macro-EREG, whose cell number is large. (<bold>D</bold>) Results of novel rare cell detection with different score functions. (<bold>E</bold>) Cell-type UMAP visualization of the considered COVID-19 immune atlas. (<bold>F</bold>) UMAP visualization of the novel cell discovery task of scNovel on the COVID-19 immune atlas with <inline-formula><tex-math notation="LaTeX" id="ImEquation119">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$C^{novel}$\end{document}</tex-math></inline-formula> = 10.</p>
        </caption>
        <graphic xlink:href="bbae112f5" position="float"/>
      </fig>
      <p>To further validate the robustness of our performance on a large, imbalanced dataset, we apply scNovel to a million-scale scRNA-seq dataset COVID-19 immune atlas [<xref rid="ref29" ref-type="bibr">29</xref>](1 462 702 cells). The scRNA-seq dataset COVID-19 immune atlas has 64 cell types, divided into three groups, including healthy, moderate (COVID) and severe(COVID). The healthy group has 54 cell types,while 10 cell types only appear in COVID groups (shown in <xref rid="f5" ref-type="fig">Figure 5B</xref>), and the 10 cell types are selected as novel cell types. We further elaborate on the impact of the 10 specific cell types on our experimental outcomes, as illustrated in the results presented in <xref rid="f5" ref-type="fig">Figure 5(C)</xref>. Shown in <xref rid="f5" ref-type="fig">Figure 5(D)</xref>, the performance of <inline-formula><tex-math notation="LaTeX" id="ImEquation120">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$S^{MSP}$\end{document}</tex-math></inline-formula> mode is lower than that of <inline-formula><tex-math notation="LaTeX" id="ImEquation121">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$S^{ODIN}$\end{document}</tex-math></inline-formula> mode, <inline-formula><tex-math notation="LaTeX" id="ImEquation122">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$S^{SEQ}$\end{document}</tex-math></inline-formula> mode and <inline-formula><tex-math notation="LaTeX" id="ImEquation123">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$S^{SIM}$\end{document}</tex-math></inline-formula> mode, which suggests the importance of barcode preprocessing. <xref rid="f5" ref-type="fig">Figure 5(C)</xref> shows that the Epi cell types, including Epi-Squamous, Epi-Secretory, Epi-Ciliated, and Epi-AT2, have low FPR95, high AUROC, and high AUPR. The underlying reason is that Epi cell types only appear in <inline-formula><tex-math notation="LaTeX" id="ImEquation124">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\mathcal{D}_{query}^{novel}$\end{document}</tex-math></inline-formula> so that it is easier for our model to detect them. For the same reason, the Mast, which only has 17 cells, has the same high AUROC. In contrast, the performance is relatively lower in Macro-DNAJB1, Macro-EREG, Neu-FGF23, Neu-RSAD2 and DC-LAMP3. For Macro-DNAJB1 and Macro-EREG, there are other subgroup cells of Macro in <inline-formula><tex-math notation="LaTeX" id="ImEquation125">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\mathcal{D}_{ref}$\end{document}</tex-math></inline-formula>, such as Macro-C1QC and Macro-CCL3L1. For Neu-FGF23 and Neu-RSAD2, there are Neu-IL1B and Neu-CST7 in <inline-formula><tex-math notation="LaTeX" id="ImEquation126">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\mathcal{D}_{ref}$\end{document}</tex-math></inline-formula>. For DC-LAMP3, the <inline-formula><tex-math notation="LaTeX" id="ImEquation127">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\mathcal{D}_{ref}$\end{document}</tex-math></inline-formula> contains DC-CLEC9A and DC-LILRA4. We could notice that the novel rare cell detection performance is not related to the cell numbers. The mast, the rarest cell, is detected better than Macro-EREG, whose cell number is large. As shown in <xref rid="f5" ref-type="fig">Figure 5(E) and (F)</xref>, scNovel is capable of accurately identifying 10 novel rare cell types that are exclusively present in COVID-19 cases within datasets comprising millions of cells. This achievement underscores the scalability of scNovel and highlights its potential for deployment in large-scale real-world applications.</p>
    </sec>
    <sec id="sec3e">
      <title>Potential novel subtypes discovery and functional investigation in bronchoalveolar immune cell atlas in COVID patient</title>
      <p>Studies have shown the importance of cell-type-specific analysis of the genetic heterogeneity of specific cell types in the field of biomedicine [<xref rid="ref31" ref-type="bibr">31</xref>]. For instance, COVID single-cell atlas [<xref rid="ref29" ref-type="bibr">29</xref>] detects 64 cell types further to analyze the relationship between cell gene expression and diseases. However, the detection process of novel cell types is time-consuming and needs prior knowledge. Our proposed scNovel could find novel rare cells automatically: (1) detect the novel cells of the query set; (2) employ Leiden clustering to generate cell clusters; and (3) utilize the novel cell clusters for further analysis.</p>
      <p>In this study, with a 1.5-million-scale dataset as the reference set, we apply the above analysis pipeline to a published COVID-19 dataset [<xref rid="ref32" ref-type="bibr">32</xref>] (GEO accession number GSE171524), containing 116 314 cells collected from 7 healthy controls and 20 COVID-19 samples. We show the UMAP visualization of cell-type annotation (<xref rid="f6" ref-type="fig">Figure 6A</xref>) and patient annotation (<xref rid="f6" ref-type="fig">Figure 6B</xref>). <xref rid="f6" ref-type="fig">Figure 6C</xref> presents the novel cell detection result. In our setting, B cell and T cell are present in the reference set, while AT1 and AT2 are left for testing. <xref rid="f6" ref-type="fig">Figure 6D</xref>, as detected by scNovel, illustrates the distributions of typical and novel cells, demonstrating the tool’s effectiveness in identifying and differentiating between cell types. Combining the results in <xref rid="f6" ref-type="fig">Figure 6C</xref> and <xref rid="f6" ref-type="fig">Figure 6D</xref>, we can find that B cell and T cell are less likely to be predicted to be novel, but AT1 and AT2 are detected as novel cells successfully. To further ensure the discovered novel cells are different from the cells in the reference set, we present the gene expression in <xref rid="f6" ref-type="fig">Figure 6E</xref>. It directly supports that the newly discovered cells are different from the cells in the reference set. We also carry out analysis on the gene differentiation of different novel cell clusters by showing the highest gene expression of each novel cell cluster and their relation in <xref rid="f6" ref-type="fig">Figure 6F</xref>. We find that clusters 3, 5, and 12 have high CD163 expression, which means that they may be subtypes of Macrophage. Then, we conduct deeper analyses of the selected three clusters to study the relationship between their gene expression and COVID-19. We show the expression level between the top 8 biomarkers in each cluster (<xref rid="f6" ref-type="fig">Figure 6G</xref>). From the volcano figure in <xref rid="f6" ref-type="fig">Figure 6H</xref>, seven genes have higher expression in COVID patients, and some are already supported by past research, including ADAMTS2 [<xref rid="ref33" ref-type="bibr">33</xref>], CD163 [<xref rid="ref34" ref-type="bibr">34</xref>, <xref rid="ref35" ref-type="bibr">35</xref>], CEBPB [<xref rid="ref36" ref-type="bibr">36</xref>], CTSD, LDLRAD3, NEAT1 [<xref rid="ref37" ref-type="bibr">37</xref>] and TPST1. Moreover, nine genes have lower expression in COVID patients, which are also supported by the existing works, including ATG77 [<xref rid="ref38" ref-type="bibr">38</xref>], CSF2RA [<xref rid="ref39" ref-type="bibr">39</xref>], DST, FARP1, FRMD4A, HLA-DPB1, HLA-DRB1, RASAL2 and TFRC. Rather than only analyzing differential gene expression in a single cluster, selecting biomarkers that satisfy all three criteria in the dependent clusters makes the analysis results more reliable. Finally, we conducted a Gene Ontology (GO) analysis in <xref rid="f6" ref-type="fig">Figure 6I</xref>, supplemented by gene set enrichment analysis, to investigate changes in biological pathways between macrophages with differing COVID statuses. Our results indicate significant upregulation in COVID samples, particularly in neutrophil activation related to immune response, neutrophil degranulation, and neutrophil-mediated immunity. By applying scNovel to a COVID-19 dataset, we have demonstrated its effectiveness in accurately identifying unique cell types. This success suggests the potential of scNovel as a critical tool in accelerating diagnostics and response in future pandemics or diseases.</p>
      <fig position="float" id="f6">
        <label>Figure 6</label>
        <caption>
          <p>(<bold>A</bold>) UMAP visualization of each cell type in the query dataset. There are a total of 19 cell types. (<bold>B</bold>) UMAP visualization of patient distribution. (<bold>C</bold>) The Leiden clustering results of detected novel cells. In total, there are 24 new cell types. (<bold>D</bold>) UMAP visualization of the novel cell detection result via scNovel with threshold 0.45. (<bold>E</bold>) The stacked violin plot overview of the gene expression in typical cells of reference set and new cell types. According to the gene expression, the new cell clusters are different from the typical cells in the reference set. (<bold>F</bold>) The stacked dot plot overview of the top-important marker genes expression for each cell type. (<bold>G</bold>) The comparison of the expression level between the top 8 biomarkers in the COVID group and the rest of the patients. (<bold>H</bold>) The Volcano figure of cluster 3, cluster 5 and cluster 12. (<bold>I</bold>) GO analysis in novel Macrophages between COVID samples and Healthy Samples. </p>
        </caption>
        <graphic xlink:href="bbae112f6" position="float"/>
      </fig>
    </sec>
  </sec>
  <sec id="sec4">
    <title>DISCUSSION</title>
    <p>The development of scRNA-seq methods has increased the demand for single-cell analysis tools. Previous research works mainly focus on cell-type annotation, but pay little attention to novel rare cell discovery task, which is important for classifier’s reliability and cell discovery. To the best of our knowledge, we are the first one focusing on novel rare cell discovery, and we propose the first corresponding auto-detection model named scNovel, an open-source Python package that integrates neural network and barcode preprocessing. With extensive experiments on several scRNA-seq datasets with different scales, different generation protocols and different <inline-formula><tex-math notation="LaTeX" id="ImEquation128">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$C^{novel}$\end{document}</tex-math></inline-formula>, we have demonstrated an effective novel rare cell discovery ability. We have also shown the fast running speed of scNovel on datasets with different scales, which proves the scalability. Moreover, we evaluate our model on a million-level dataset, which further shown the scalability and novel rare cell discovery capacity. Also, we employ the scNovel to detect novel rare cell clusters for more trustable disease gene analysis.</p>
    <p>In future work, we have several suggestions for scNovel improvement. Firstly, a better score function could improve scNovel performance. Specifically, we could utilize up-sharpness and down-sharpness multiple times. Secondly, we could employ more biology information. For instance, we leverage both scRNA-Seq and single-cell chromatin accessibility sequencing for novel rare cell discovery. In all, we believe that scNovel is an effective and efficient tool for single-cell analysis, especially its ability and scalability of rare cell types.</p>
    <boxed-text id="box01" position="float">
      <sec id="sec27">
        <title>Key Points</title>
        <list list-type="bullet">
          <list-item>
            <p>scNovel is a scalable deep learning-based network for novel rare cell discovery in single-cell transcriptomics, and the first method to use the barcode preprocessing on novel rare cell detection on the scRNA-seq data.</p>
          </list-item>
          <list-item>
            <p>We apply scNovel on extensive intra-dataset and inter-protocol novel rare cell detection experiments, even considering a large, imbalanced million-scale dataset. Notably, it achieves an average AUROC performance exceeding 94%, surpassing the second-best method by up to 16.26%.</p>
          </list-item>
          <list-item>
            <p>Within the context of the profoundly imbalanced clinical COVID-19 dataset, a comprehensive analysis has unveiled the existence of three promising novel subtypes of macrophages.</p>
          </list-item>
          <list-item>
            <p>We developed a pipeline for the identification of novel rare cells and the analysis of differential gene expression. Our proposed scNovel-based analytical framework extends beyond its application to COVID-19, as it can be seamlessly tailored to investigate genes associated with various other diseases.</p>
          </list-item>
        </list>
      </sec>
    </boxed-text>
  </sec>
</body>
<back>
  <sec id="sec7a">
    <title>ACKNOWLEDGEMENT</title>
    <p>The work described in this paper was partially supported by a grant from the Research Grants Council of the Hong Kong Special Administrative Region, China [Project No.: CUHK 24204023], and a grant from Innovation and Technology Commission of the Hong Kong Special Administrative Region, China [Project No.: GHP/065/21SZ]. This research is funded by Chinese University of Hong Kong (CUHK) with the award number 4937025, 4937026, 5501517, 5501329.</p>
  </sec>
  <sec id="sec7">
    <title>AUTHOR CONTRIBUTIONS</title>
    <p>Y.L. conceived and supervised the project. C.Z., Y.C. and H.W. designed the method and all benchmark experiments. C.Z. implemented the tool in Python. C.Z, X.W. and Y.W performed data analysis and all computational experiments. C.Z., Y.W. Y.C. and H.W. wrote the manuscript together. All authors reviewed the manuscript.</p>
  </sec>
  <sec id="sec6">
    <title>CODE AVAILABILITY</title>
    <p>scNovel is available as an independent python package at <ext-link xlink:href="https://github.com/chuanyang-Zheng/scNovel" ext-link-type="uri">https://github.com/chuanyang-Zheng/scNovel</ext-link>.</p>
  </sec>
  <sec sec-type="data-availability" id="sec5">
    <title>DATA AVAILABILITY</title>
    <p>No new data was generated from this study. All data used in this study is publicly available as shown in <xref rid="TB1" ref-type="table">Appendix Table 1</xref>.</p>
  </sec>
  <ref-list id="bib1">
    <title>References</title>
    <ref id="ref1">
      <label>1.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Tang</surname><given-names>F</given-names></string-name>, <string-name><surname>Barbacioru</surname><given-names>C</given-names></string-name>, <string-name><surname>Wang</surname><given-names>Y</given-names></string-name>, <etal>et al.</etal></person-group><article-title>mRNA-Seq whole-transcriptome analysis of a single cell</article-title>. <source>Nat Methods</source><year>2009</year>;<volume>6</volume>:<fpage>377</fpage>–<lpage>82</lpage>.<pub-id pub-id-type="pmid">19349980</pub-id></mixed-citation>
    </ref>
    <ref id="ref2">
      <label>2.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Klein</surname><given-names>AM</given-names></string-name>, <string-name><surname>Mazutis</surname><given-names>L</given-names></string-name>, <string-name><surname>Akartuna</surname><given-names>I</given-names></string-name>, <etal>et al.</etal></person-group><article-title>Droplet barcoding for single-cell transcriptomics applied to embryonic stem cells</article-title>. <source>Cell</source><year>2015</year>;<volume>161</volume>:<fpage>1187</fpage>–<lpage>201</lpage>.<pub-id pub-id-type="pmid">26000487</pub-id></mixed-citation>
    </ref>
    <ref id="ref3">
      <label>3.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Guo</surname><given-names>G</given-names></string-name>, <string-name><surname>Huss</surname><given-names>M</given-names></string-name>, <string-name><surname>Tong</surname><given-names>GQ</given-names></string-name>, <etal>et al.</etal></person-group><article-title>Resolution of cell fate decisions revealed by single-cell gene expression analysis from zygote to blastocyst</article-title>. <source>Dev Cell</source><year>2010</year>;<volume>18</volume>:<fpage>675</fpage>–<lpage>85</lpage>.<pub-id pub-id-type="pmid">20412781</pub-id></mixed-citation>
    </ref>
    <ref id="ref4">
      <label>4.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><collab>Tabula Muris Consortium</collab>.</person-group><article-title>Single-cell transcriptomics of 20 mouse organs creates a Tabula Muris</article-title>. <source>Nature</source><year>2018</year>;<volume>562</volume>:<fpage>367</fpage>–<lpage>72</lpage>.<pub-id pub-id-type="pmid">30283141</pub-id></mixed-citation>
    </ref>
    <ref id="ref5">
      <label>5.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Zheng</surname><given-names>GX</given-names></string-name>, <string-name><surname>Terry</surname><given-names>JM</given-names></string-name>, <string-name><surname>Belgrader</surname><given-names>P</given-names></string-name>, <etal>et al.</etal></person-group><article-title>Massively parallel digital transcriptional profiling of single cells</article-title>. <source>Nat Commun</source><year>2017</year>;<volume>8</volume>:<fpage>1</fpage>–<lpage>12</lpage>.<pub-id pub-id-type="pmid">28232747</pub-id></mixed-citation>
    </ref>
    <ref id="ref6">
      <label>6.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Davie</surname><given-names>K</given-names></string-name>, <string-name><surname>Janssens</surname><given-names>J</given-names></string-name>, <string-name><surname>Koldere</surname><given-names>D</given-names></string-name>, <etal>et al.</etal></person-group><article-title>A single-cell transcriptome atlas of the aging drosophila brain</article-title>. <source>Cell</source><year>2018</year>;<volume>174</volume>:<fpage>982</fpage>–<lpage>998.e20</lpage>.<pub-id pub-id-type="pmid">29909982</pub-id></mixed-citation>
    </ref>
    <ref id="ref7">
      <label>7.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Horning</surname><given-names>AM</given-names></string-name>, <string-name><surname>Wang</surname><given-names>Y</given-names></string-name>, <string-name><surname>Lin</surname><given-names>CK</given-names></string-name>, <etal>et al.</etal></person-group><article-title>Single-cell RNA-seq reveals a subpopulation of prostate cancer cells with enhanced cell-cycle–related transcription and attenuated androgen response</article-title>. <source>Cancer Res</source><year>2018</year>;<volume>78</volume>:<fpage>853</fpage>–<lpage>64</lpage>.<pub-id pub-id-type="pmid">29233929</pub-id></mixed-citation>
    </ref>
    <ref id="ref8">
      <label>8.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Nyquist</surname><given-names>MD</given-names></string-name>, <string-name><surname>Corella</surname><given-names>A</given-names></string-name>, <string-name><surname>Coleman</surname><given-names>I</given-names></string-name>, <etal>et al.</etal></person-group><article-title>Combined TP53 and RB1 loss promotes prostate cancer resistance to a spectrum of therapeutics and confers vulnerability to replication stress</article-title>. <source>Cell Rep</source><year>2020</year>;<volume>31</volume>:107669.</mixed-citation>
    </ref>
    <ref id="ref9">
      <label>9.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Chen</surname><given-names>Y</given-names></string-name>, <string-name><surname>Wang</surname><given-names>Y</given-names></string-name>, <string-name><surname>Chen</surname><given-names>Y</given-names></string-name>, <etal>et al.</etal></person-group><article-title>Deep autoencoder for interpretable tissue-adaptive deconvolution and cell-type-specific gene analysis</article-title>. <source>Nat Commun</source><year>2022</year>;<volume>13</volume>:<fpage>6735</fpage>.<pub-id pub-id-type="pmid">36347853</pub-id></mixed-citation>
    </ref>
    <ref id="ref10">
      <label>10.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Guo</surname><given-names>C</given-names></string-name>, <string-name><surname>Li</surname><given-names>B</given-names></string-name>, <string-name><surname>Ma</surname><given-names>H</given-names></string-name>, <etal>et al.</etal></person-group><article-title>Single-cell analysis of two severe Covid-19 patients reveals a monocyte-associated and tocilizumab-responding cytokine storm</article-title>. <source>Nat Commun</source><year>2020</year>;<volume>11</volume>:<fpage>1</fpage>–<lpage>11</lpage>.<pub-id pub-id-type="pmid">31911652</pub-id></mixed-citation>
    </ref>
    <ref id="ref11">
      <label>11.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Wilk</surname><given-names>AJ</given-names></string-name>, <string-name><surname>Rustagi</surname><given-names>A</given-names></string-name>, <string-name><surname>Zhao</surname><given-names>NQ</given-names></string-name>, <etal>et al.</etal></person-group><article-title>A single-cell atlas of the peripheral immune response in patients with severe Covid-19</article-title>. <source>Nat Med</source><year>2020</year>;<volume>26</volume>:<fpage>1070</fpage>–<lpage>6</lpage>.<pub-id pub-id-type="pmid">32514174</pub-id></mixed-citation>
    </ref>
    <ref id="ref12">
      <label>12.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Guo</surname><given-names>L</given-names></string-name>, <string-name><surname>Lin</surname><given-names>L</given-names></string-name>, <string-name><surname>Wang</surname><given-names>X</given-names></string-name>, <etal>et al.</etal></person-group><article-title>Resolving cell fate decisions during somatic cell reprogramming by single-cell RNA-seq</article-title>. <source>Mol Cell</source><year>2019</year>;<volume>73</volume>:<fpage>815</fpage>–<lpage>829.e7</lpage>.<pub-id pub-id-type="pmid">30772174</pub-id></mixed-citation>
    </ref>
    <ref id="ref13">
      <label>13.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Ianevski</surname><given-names>A</given-names></string-name>, <string-name><surname>Giri</surname><given-names>AK</given-names></string-name>, <string-name><surname>Aittokallio</surname><given-names>T</given-names></string-name></person-group>. <article-title>Fully-automated and ultra-fast cell-type identification using specific marker combinations from single-cell transcriptomic data</article-title>. <source>Nat Commun</source><year>2022</year>;<volume>13</volume>:<fpage>1</fpage>–<lpage>10</lpage>.<pub-id pub-id-type="pmid">34983933</pub-id></mixed-citation>
    </ref>
    <ref id="ref14">
      <label>14.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Pasquini</surname><given-names>G</given-names></string-name>, <string-name><surname>Arias</surname><given-names>JER</given-names></string-name>, <string-name><surname>Schäfer</surname><given-names>P</given-names></string-name>, <string-name><surname>Busskamp</surname><given-names>V</given-names></string-name></person-group>. <article-title>Automated methods for cell type annotation on scRNA-seq data</article-title>. <source>Comput Struct Biotechnol J</source><year>2021</year>;<volume>19</volume>:<fpage>961</fpage>–<lpage>9</lpage>.<pub-id pub-id-type="pmid">33613863</pub-id></mixed-citation>
    </ref>
    <ref id="ref15">
      <label>15.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Han</surname><given-names>W</given-names></string-name>, <string-name><surname>Cheng</surname><given-names>Y</given-names></string-name>, <string-name><surname>Chen</surname><given-names>J</given-names></string-name>, <etal>et al.</etal></person-group><article-title>Self-supervised contrastive learning for integrative single cell RNA-seq data analysis</article-title>. <source>Brief Bioinform</source><year>2022</year>;<volume>23</volume>.</mixed-citation>
    </ref>
    <ref id="ref16">
      <label>16.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Cheng</surname><given-names>Y</given-names></string-name>, <string-name><surname>Fan</surname><given-names>X</given-names></string-name>, <string-name><surname>Zhang</surname><given-names>J</given-names></string-name>, <string-name><surname>Li</surname><given-names>Y</given-names></string-name></person-group>. <article-title>A scalable sparse neural network framework for rare cell type annotation of single-cell transcriptome data</article-title>. <source>Commun Biol</source><year>2023</year>;<volume>6</volume>:<fpage>545</fpage>.<pub-id pub-id-type="pmid">37210444</pub-id></mixed-citation>
    </ref>
    <ref id="ref17">
      <label>17.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Huang</surname><given-names>EH</given-names></string-name>, <string-name><surname>Heidt</surname><given-names>DG</given-names></string-name>, <string-name><surname>Li</surname><given-names>C-W</given-names></string-name>, <string-name><surname>Simeone</surname><given-names>DM</given-names></string-name></person-group>. <article-title>Cancer stem cells: a new paradigm for understanding tumor progression and therapeutic resistance</article-title>. <source>Surgery</source><year>2007</year>;<volume>141</volume>:<fpage>415</fpage>–<lpage>9</lpage>.<pub-id pub-id-type="pmid">17383517</pub-id></mixed-citation>
    </ref>
    <ref id="ref18">
      <label>18.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Garraway</surname><given-names>LA</given-names></string-name>, <string-name><surname>Jänne</surname><given-names>PA</given-names></string-name></person-group>. <article-title>Circumventing cancer drug resistance in the era of personalized medicine</article-title>. <source>Cancer Discov</source><year>2012</year>;<volume>2</volume>:<fpage>214</fpage>–<lpage>26</lpage>.<pub-id pub-id-type="pmid">22585993</pub-id></mixed-citation>
    </ref>
    <ref id="ref19">
      <label>19.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Krepler</surname><given-names>C</given-names></string-name>, <string-name><surname>Xiao</surname><given-names>M</given-names></string-name>, <string-name><surname>Sproesser</surname><given-names>K</given-names></string-name>, <etal>et al.</etal></person-group><article-title>Personalized preclinical trials in BRAF inhibitor–resistant patient-derived xenograft models identify second-line combination therapies</article-title>. <source>Clin Cancer Res</source><year>2016</year>;<volume>22</volume>:<fpage>1592</fpage>–<lpage>602</lpage>.<pub-id pub-id-type="pmid">26673799</pub-id></mixed-citation>
    </ref>
    <ref id="ref20">
      <label>20.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Butler</surname><given-names>A</given-names></string-name>, <string-name><surname>Hoffman</surname><given-names>P</given-names></string-name>, <string-name><surname>Smibert</surname><given-names>P</given-names></string-name>, <etal>et al.</etal></person-group><article-title>Integrating single-cell transcriptomic data across different conditions, technologies, and species</article-title>. <source>Nat Biotechnol</source><year>2018</year>;<volume>36</volume>:<fpage>411</fpage>–<lpage>20</lpage>.<pub-id pub-id-type="pmid">29608179</pub-id></mixed-citation>
    </ref>
    <ref id="ref21">
      <label>21.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Wolf</surname><given-names>FA</given-names></string-name>, <string-name><surname>Angerer</surname><given-names>P</given-names></string-name>, <string-name><surname>Theis</surname><given-names>FJ</given-names></string-name></person-group>. <article-title>SCANPY: large-scale single-cell gene expression data analysis</article-title>. <source>Genome Biol</source><year>2018</year>;<volume>19</volume>:<fpage>1</fpage>–<lpage>5</lpage>.<pub-id pub-id-type="pmid">29301551</pub-id></mixed-citation>
    </ref>
    <ref id="ref22">
      <label>22.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Tan</surname><given-names>Y</given-names></string-name>, <string-name><surname>Cahan</surname><given-names>P</given-names></string-name></person-group>. <article-title>SingleCellNet: a computational tool to classify single cell RNA-seq data across platforms and across species</article-title>. <source>Cell Syst</source><year>2019</year>;<volume>9</volume>:<fpage>207</fpage>–<lpage>213.e2</lpage>.<pub-id pub-id-type="pmid">31377170</pub-id></mixed-citation>
    </ref>
    <ref id="ref23">
      <label>23.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Aran</surname><given-names>D</given-names></string-name>, <string-name><surname>Looney</surname><given-names>AP</given-names></string-name>, <string-name><surname>Liu</surname><given-names>L</given-names></string-name>, <etal>et al.</etal></person-group><article-title>Reference-based analysis of lung single-cell sequencing reveals a transitional profibrotic macrophage</article-title>. <source>Nat Immunol</source><year>2019</year>;<volume>20</volume>:<fpage>163</fpage>–<lpage>72</lpage>.<pub-id pub-id-type="pmid">30643263</pub-id></mixed-citation>
    </ref>
    <ref id="ref24">
      <label>24.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Lopez</surname><given-names>R</given-names></string-name>, <string-name><surname>Regier</surname><given-names>J</given-names></string-name>, <string-name><surname>Cole</surname><given-names>MB</given-names></string-name>, <etal>et al.</etal></person-group><article-title>Deep generative modeling for single-cell transcriptomics</article-title>. <source>Nat Methods</source><year>2018</year>;<volume>15</volume>:<fpage>1053</fpage>–<lpage>8</lpage>.<pub-id pub-id-type="pmid">30504886</pub-id></mixed-citation>
    </ref>
    <ref id="ref25">
      <label>25.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Kiselev</surname><given-names>VY</given-names></string-name>, <string-name><surname>Yiu</surname><given-names>A</given-names></string-name>, <string-name><surname>Hemberg</surname><given-names>M</given-names></string-name></person-group>. <article-title>scmap: projection of single-cell RNA-seq data across data sets</article-title>. <source>Nat Methods</source><year>2018</year>;<volume>15</volume>:<fpage>359</fpage>–<lpage>62</lpage>.<pub-id pub-id-type="pmid">29608555</pub-id></mixed-citation>
    </ref>
    <ref id="ref26">
      <label>26.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Alquicira-Hernandez</surname><given-names>J</given-names></string-name>, <string-name><surname>Sathe</surname><given-names>A</given-names></string-name>, <string-name><surname>Ji</surname><given-names>HP</given-names></string-name>, <etal>et al.</etal></person-group><article-title>scPRED: accurate supervised method for cell-type classification from single-cell RNA-seq data</article-title>. <source>Genome Biol</source><year>2019</year>;<volume>20</volume>:<fpage>1</fpage>–<lpage>17</lpage>.<pub-id pub-id-type="pmid">30606230</pub-id></mixed-citation>
    </ref>
    <ref id="ref27">
      <label>27.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Duan</surname><given-names>B</given-names></string-name>, <etal>et al.</etal></person-group><article-title>Learning for single-cell assignment</article-title>. <source>Sci Adv</source><year>2020</year>;<volume>6</volume>:<fpage>eabd0855</fpage>.<pub-id pub-id-type="pmid">33127686</pub-id></mixed-citation>
    </ref>
    <ref id="ref28">
      <label>28.</label>
      <mixed-citation publication-type="book"><person-group person-group-type="author"><string-name><surname>Xanthopoulos</surname><given-names>P</given-names></string-name>, <string-name><surname>Pardalos</surname><given-names>PM</given-names></string-name>, <string-name><surname>Trafalis</surname><given-names>TB</given-names></string-name></person-group>. <article-title>Principal component analysis</article-title>. In: <source>Robust Data Mining</source>.
<publisher-name>Springer</publisher-name>. Springer Science &amp; Business Media <year>2013</year>, <fpage>21</fpage>–<lpage>6</lpage>.</mixed-citation>
    </ref>
    <ref id="ref29">
      <label>29.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Ren</surname><given-names>X</given-names></string-name>, <string-name><surname>Wen</surname><given-names>W</given-names></string-name>, <string-name><surname>Fan</surname><given-names>X</given-names></string-name>, <etal>et al.</etal></person-group><article-title>Covid-19 immune features revealed by a large-scale single-cell transcriptome atlas</article-title>. <source>Cell</source><year>2021</year>;<volume>184</volume>:<fpage>1895</fpage>–<lpage>1913.e19</lpage>.<pub-id pub-id-type="pmid">33657410</pub-id></mixed-citation>
    </ref>
    <ref id="ref30">
      <label>30.</label>
      <mixed-citation publication-type="other"><person-group person-group-type="author"><string-name><surname>Davis</surname><given-names>J</given-names></string-name>, <string-name><surname>Goadrich</surname><given-names>M</given-names></string-name></person-group><article-title>The relationship between precision-recall and ROC curves</article-title>. In <source><italic toggle="yes">Proceedings of the 23rd international conference on Machine learning</italic></source>. Pennsylvania, USA: MIT Press, <year>2006</year>, <fpage>pp. 233</fpage>–<lpage>240</lpage>.</mixed-citation>
    </ref>
    <ref id="ref31">
      <label>31.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Velmeshev</surname><given-names>D</given-names></string-name>, <string-name><surname>Schirmer</surname><given-names>L</given-names></string-name>, <string-name><surname>Jung</surname><given-names>D</given-names></string-name>, <etal>et al.</etal></person-group><article-title>Single-cell genomics identifies cell type–specific molecular changes in autism</article-title>. <source>Science</source><year>2019</year>;<volume>364</volume>:<fpage>685</fpage>–<lpage>9</lpage>.<pub-id pub-id-type="pmid">31097668</pub-id></mixed-citation>
    </ref>
    <ref id="ref32">
      <label>32.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Melms</surname><given-names>JC</given-names></string-name>, <string-name><surname>Biermann</surname><given-names>J</given-names></string-name>, <string-name><surname>Huang</surname><given-names>H</given-names></string-name>, <etal>et al.</etal></person-group><article-title>A molecular single-cell lung atlas of lethal Covid-19</article-title>. <source>Nature</source><year>2021</year>;<volume>595</volume>:<fpage>114</fpage>–<lpage>9</lpage>.<pub-id pub-id-type="pmid">33915568</pub-id></mixed-citation>
    </ref>
    <ref id="ref33">
      <label>33.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Giovannoni</surname><given-names>F</given-names></string-name>, <string-name><surname>Li</surname><given-names>Z</given-names></string-name>, <string-name><surname>Remes-Lenicov</surname><given-names>F</given-names></string-name>, <etal>et al.</etal></person-group><article-title>AHR signaling is induced by infection with Coronaviruses</article-title>. <source>Nat Commun</source><year>2021</year>;<volume>12</volume>:<fpage>1</fpage>–<lpage>12</lpage>.<pub-id pub-id-type="pmid">33397941</pub-id></mixed-citation>
    </ref>
    <ref id="ref34">
      <label>34.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Delorey</surname><given-names>TM</given-names></string-name>, <string-name><surname>Ziegler</surname><given-names>CGK</given-names></string-name>, <string-name><surname>Heimberg</surname><given-names>G</given-names></string-name>, <etal>et al.</etal></person-group><article-title>Covid-19 tissue atlases reveal SARS-CoV-2 pathology and cellular targets</article-title>. <source>Nature</source><year>2021</year>;<volume>595</volume>:<fpage>107</fpage>–<lpage>13</lpage>.<pub-id pub-id-type="pmid">33915569</pub-id></mixed-citation>
    </ref>
    <ref id="ref35">
      <label>35.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Sacco</surname><given-names>K</given-names></string-name>, <string-name><surname>Castagnoli</surname><given-names>R</given-names></string-name>, <string-name><surname>Vakkilainen</surname><given-names>S</given-names></string-name>, <etal>et al.</etal></person-group><article-title>Immunopathological signatures in multisystem inflammatory syndrome in children and pediatric Covid-19</article-title>. <source>Nat Med</source><year>2022</year>;<volume>28</volume>:<fpage>1050</fpage>–<lpage>62</lpage>.<pub-id pub-id-type="pmid">35177862</pub-id></mixed-citation>
    </ref>
    <ref id="ref36">
      <label>36.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Amrute</surname><given-names>JM</given-names></string-name>, <string-name><surname>Perry</surname><given-names>AM</given-names></string-name>, <string-name><surname>Anand</surname><given-names>G</given-names></string-name>, <etal>et al.</etal></person-group><article-title>Cell specific peripheral immune responses predict survival in critical Covid-19 patients</article-title>. <source>Nat Commun</source><year>2022</year>;<volume>13</volume>:<fpage>1</fpage>–<lpage>11</lpage>.<pub-id pub-id-type="pmid">34983933</pub-id></mixed-citation>
    </ref>
    <ref id="ref37">
      <label>37.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Huang</surname><given-names>K</given-names></string-name>, <string-name><surname>Wang</surname><given-names>C</given-names></string-name>, <string-name><surname>Vagts</surname><given-names>C</given-names></string-name>, <etal>et al.</etal></person-group><article-title>Long non-coding RNAs (lncRNAs) NEAT1 and MALAT1 are differentially expressed in severe Covid-19 patients: an integrated single-cell analysis</article-title>. <source>PloS One</source><year>2022</year>;<volume>17</volume>:e0261242.</mixed-citation>
    </ref>
    <ref id="ref38">
      <label>38.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Baggen</surname><given-names>J</given-names></string-name>, <string-name><surname>Persoons</surname><given-names>L</given-names></string-name>, <string-name><surname>Vanstreels</surname><given-names>E</given-names></string-name>, <etal>et al.</etal></person-group><article-title>Genome-wide CRISPR screening identifies TMEM106B as a proviral host factor for SARS-CoV-2</article-title>. <source>Nat Genet</source><year>2021</year>;<volume>53</volume>:<fpage>435</fpage>–<lpage>44</lpage>.<pub-id pub-id-type="pmid">33686287</pub-id></mixed-citation>
    </ref>
    <ref id="ref39">
      <label>39.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Ruan</surname><given-names>D</given-names></string-name>, <string-name><surname>Ye</surname><given-names>ZW</given-names></string-name>, <string-name><surname>Yuan</surname><given-names>S</given-names></string-name>, <etal>et al.</etal></person-group><article-title>Human early syncytiotrophoblasts are highly susceptible to SARS-CoV-2 infection</article-title>. <source>Cell Rep Med</source><year>2022</year>;<volume>3</volume>:<fpage>100849</fpage>.<pub-id pub-id-type="pmid">36495872</pub-id></mixed-citation>
    </ref>
    <ref id="ref40">
      <label>40.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Darmanis</surname><given-names>S</given-names></string-name>, <string-name><surname>Sloan</surname><given-names>SA</given-names></string-name>, <string-name><surname>Zhang</surname><given-names>Y</given-names></string-name>, <etal>et al.</etal></person-group><article-title>A survey of human brain transcriptome diversity at the single cell level</article-title>. <source>Proc Natl Acad Sci</source><year>2015</year>;<volume>112</volume>:<fpage>7285</fpage>–<lpage>90</lpage>.<pub-id pub-id-type="pmid">26060301</pub-id></mixed-citation>
    </ref>
    <ref id="ref41">
      <label>41.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Muraro</surname><given-names>MJ</given-names></string-name>, <string-name><surname>Dharmadhikari</surname><given-names>G</given-names></string-name>, <string-name><surname>Grün</surname><given-names>D</given-names></string-name>, <etal>et al.</etal></person-group><article-title>A single-cell transcriptome atlas of the human pancreas</article-title>. <source>Cell Syst</source><year>2016</year>;<volume>3</volume>:<fpage>385</fpage>–<lpage>394.e3</lpage>.<pub-id pub-id-type="pmid">27693023</pub-id></mixed-citation>
    </ref>
    <ref id="ref42">
      <label>42.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Baron</surname><given-names>M</given-names></string-name>, <string-name><surname>Veres</surname><given-names>A</given-names></string-name>, <string-name><surname>Wolock</surname><given-names>SL</given-names></string-name>, <etal>et al.</etal></person-group><article-title>A single-cell transcriptomic map of the human and mouse pancreas reveals inter-and intra-cell population structure</article-title>. <source>Cell Syst</source><year>2016</year>;<volume>3</volume>:<fpage>346</fpage>–<lpage>360.e4</lpage>.<pub-id pub-id-type="pmid">27667365</pub-id></mixed-citation>
    </ref>
    <ref id="ref43">
      <label>43.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Ding</surname><given-names>J</given-names></string-name>, <string-name><surname>Adiconis</surname><given-names>X</given-names></string-name>, <string-name><surname>Simmons</surname><given-names>SK</given-names></string-name>, <etal>et al.</etal></person-group><article-title>Systematic comparison of single-cell and single-nucleus RNA-sequencing methods</article-title>. <source>Nat Biotechnol</source><year>2020</year>;<volume>38</volume>:<fpage>737</fpage>–<lpage>46</lpage>.<pub-id pub-id-type="pmid">32341560</pub-id></mixed-citation>
    </ref>
    <ref id="ref44">
      <label>44.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Campbell</surname><given-names>JN</given-names></string-name>, <string-name><surname>Macosko</surname><given-names>EZ</given-names></string-name>, <string-name><surname>Fenselau</surname><given-names>H</given-names></string-name>, <etal>et al.</etal></person-group><article-title>A molecular census of arcuate hypothalamus and median eminence cell types</article-title>. <source>Nat Neurosci</source><year>2017</year>;<volume>20</volume>:<fpage>484</fpage>–<lpage>96</lpage>.<pub-id pub-id-type="pmid">28166221</pub-id></mixed-citation>
    </ref>
    <ref id="ref45">
      <label>45.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Zilionis</surname><given-names>R</given-names></string-name>, <string-name><surname>Engblom</surname><given-names>C</given-names></string-name>, <string-name><surname>Pfirschke</surname><given-names>C</given-names></string-name>, <etal>et al.</etal></person-group><article-title>Single-cell transcriptomics of human and mouse lung cancers reveals conserved myeloid populations across individuals and species</article-title>. <source>Immunity</source><year>2019</year>;<volume>50</volume>:<fpage>1317</fpage>–<lpage>1334.e10</lpage>.<pub-id pub-id-type="pmid">30979687</pub-id></mixed-citation>
    </ref>
    <ref id="ref46">
      <label>46.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Schaum</surname><given-names>N</given-names></string-name>, <etal>et al.</etal></person-group><article-title>Single-cell transcriptomics of 20 mouse organs creates a Tabula Muris: the Tabula Muris consortium</article-title>. <source>Nature</source><year>2018</year>;<volume>562</volume>:<fpage>367</fpage>–<lpage>72</lpage>.<pub-id pub-id-type="pmid">30283141</pub-id></mixed-citation>
    </ref>
    <ref id="ref47">
      <label>47.</label>
      <mixed-citation publication-type="other"><person-group person-group-type="author"><string-name><surname>Liang</surname><given-names>S</given-names></string-name>, <string-name><surname>Li</surname><given-names>Y</given-names></string-name>, <string-name><surname>Srikant</surname><given-names>R</given-names></string-name></person-group><article-title>Enhancing the reliability of out-of-distribution image detection in neural networks</article-title>. In: <source>International Conference on Learning Representations</source>. Vancouver, Canada: Openreview.net, <year>2018</year>.</mixed-citation>
    </ref>
    <ref id="ref48">
      <label>48.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Fawcett</surname><given-names>T</given-names></string-name></person-group>. <article-title>An introduction to ROC analysis</article-title>. <source>Pattern Recogn Lett</source><year>2006</year>;<volume>27</volume>:<fpage>861</fpage>–<lpage>74</lpage>.</mixed-citation>
    </ref>
    <ref id="ref49">
      <label>49.</label>
      <mixed-citation publication-type="book"><person-group person-group-type="author"><string-name><surname>Manning</surname><given-names>C</given-names></string-name>, <string-name><surname>Schutze</surname><given-names>H</given-names></string-name></person-group>. <source>Foundations of Statistical Natural Language Processing</source>.USA,
<publisher-name>MIT press</publisher-name>, <year>1999</year>.</mixed-citation>
    </ref>
    <ref id="ref50">
      <label>50.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Saito</surname><given-names>T</given-names></string-name>, <string-name><surname>Rehmsmeier</surname><given-names>M</given-names></string-name></person-group>. <article-title>The precision-recall plot is more informative than the ROC plot when evaluating binary classifiers on imbalanced datasets</article-title>. <source>PloS One</source><year>2015</year>;<volume>10</volume>:e0118432.</mixed-citation>
    </ref>
    <ref id="ref51">
      <label>51.</label>
      <mixed-citation publication-type="other"><person-group person-group-type="author"><string-name><surname>Zhong</surname>, <given-names>Z.</given-names></string-name>, <string-name><surname>Cui</surname>, <given-names>J.</given-names></string-name>, <string-name><surname>Liu</surname>, <given-names>S.</given-names></string-name> &amp; <string-name><surname>Jia</surname>, <given-names>J.</given-names></string-name></person-group><article-title>Improving calibration for long-tailed recognition</article-title>. In: <source>Proceedings of the IEEE CVF Conference on Computer Vision and Pattern Recognition</source>. Nashville, USA: Institute of Electrical and Electronics Engineers, <year>2021</year>, pp. <fpage>16489</fpage>–<lpage>16498</lpage>.</mixed-citation>
    </ref>
    <ref id="ref52">
      <label>52.</label>
      <mixed-citation publication-type="other"><person-group person-group-type="author"><string-name><surname>Samuel</surname>, <given-names>D.</given-names></string-name> &amp; <string-name><surname>Chechik</surname>, <given-names>G.</given-names></string-name></person-group><article-title>Distributional robustness loss for long-tail learning</article-title>. In: <source>Proceedings of the IEEE CVF International Conference on Computer Vision</source>. Montreal, Canada: Institute of Electrical and Electronics Engineers, <year>2021</year>, pp. <fpage>9495</fpage>–<lpage>9504</lpage>.</mixed-citation>
    </ref>
    <ref id="ref53">
      <label>53.</label>
      <mixed-citation publication-type="other"><person-group person-group-type="author"><string-name><surname>Hendrycks</surname>, <given-names>D.</given-names></string-name> &amp; <string-name><surname>Gimpel</surname>, <given-names>K.</given-names></string-name></person-group><article-title>A baseline for detecting misclassified and out-of-distribution examples in neural networks</article-title>. <source>International Conference on Learning Representations</source>. Toulon, France: Openreviewer.net, <year>2017</year>.</mixed-citation>
    </ref>
    <ref id="ref54">
      <label>54.</label>
      <mixed-citation publication-type="other"><person-group person-group-type="author"><string-name><surname>Loshchilov</surname>, <given-names>I.</given-names></string-name> &amp; <string-name><surname>Hutter</surname>, <given-names>F.</given-names></string-name></person-group><article-title>Decoupled weight decay regularization</article-title>. In: <source>International Conference on Learning Representations</source>. New Orleans, USA: Openreview.net, <year>2019</year>.</mixed-citation>
    </ref>
  </ref-list>
  <app-group>
    <app id="app1a">
      <title>APPENDIX</title>
    </app>
    <app id="app1">
      <title>A. Datasets and preprocessings</title>
      <p>In this work, we considered a total of 15 single-cell expression datasets from small scale (<inline-formula><tex-math notation="LaTeX" id="ImEquation129">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\sim $\end{document}</tex-math></inline-formula>1k cells) to large scale (<inline-formula><tex-math notation="LaTeX" id="ImEquation130">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\sim $\end{document}</tex-math></inline-formula>1.5m cells). Detailed information on cell numbers, class numbers, sequencing protocols and sources of each dataset is shown in <xref rid="TB1" ref-type="table">Appendix Table 1</xref>. We incorporated datasets with different complexity and sequencing protocols to show the effectiveness and generalization of our proposed scNovel. We obtain the corresponding cell-type labels from their original paper to achieve the learning in a supervised manner.</p>
      <p>All of these labeled single-cell profiles went through the same preprocessing procedure to achieve more precise prediction results. To mitigate the impact of outlier genes, log transformation and normalization steps were implemented following the standard preprocessing pipeline outlined in the Scanpy [<xref rid="ref21" ref-type="bibr">21</xref>] tutorial, where the scale parameter was manually adjusted in the normalization function. We then split all the datasets using the following steps: (1) select the single-cell sequences of the top <inline-formula><tex-math notation="LaTeX" id="ImEquation131">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$C^{novel} \in \mathbb{N}^{+}$\end{document}</tex-math></inline-formula> most rare cell types from the dataset and utilize them to build <inline-formula><tex-math notation="LaTeX" id="ImEquation132">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\mathcal{D}_{query}^{novel}$\end{document}</tex-math></inline-formula>; (2) utilize 75% of the remaining data as <inline-formula><tex-math notation="LaTeX" id="ImEquation133">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\mathcal{D}_{ref}$\end{document}</tex-math></inline-formula>, and the other 25% of the remaining data as <inline-formula><tex-math notation="LaTeX" id="ImEquation134">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\mathcal{D}_{query}^{typical}$\end{document}</tex-math></inline-formula>; and (3) the <inline-formula><tex-math notation="LaTeX" id="ImEquation135">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\mathcal{D}_{ref}$\end{document}</tex-math></inline-formula> is employed for the reference set, while <inline-formula><tex-math notation="LaTeX" id="ImEquation136">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\mathcal{D}_{query}^{typical}$\end{document}</tex-math></inline-formula> and <inline-formula><tex-math notation="LaTeX" id="ImEquation137">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\mathcal{D}_{query}^{novel}$\end{document}</tex-math></inline-formula> are combined to build query set <inline-formula><tex-math notation="LaTeX" id="ImEquation138">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\mathcal{D}_{query}$\end{document}</tex-math></inline-formula>.</p>
    </app>
    <app id="app2">
      <title>B. Evaluation metrics</title>
      <p>We adopt the following three metrics to measure the performance of different models on the novel rare cell discovery task. A better model should have lower FPR95, higher AUROC and higher AUPR, following the previous works [<xref rid="ref26" ref-type="bibr">26</xref>, <xref rid="ref47" ref-type="bibr">47</xref>]. The AUROC is the most important evaluation metric as our dataset is imbalanced:</p>
      <list list-type="simple">
        <list-item>
          <p>(1) <bold>FPR95</bold>: FPR at 95% TPR is the probability that a negative sample (novel sample) is misclassified as a positive sample (typical sample) when the TPR is 95%.</p>
        </list-item>
        <list-item>
          <p>(2) <bold>AUROC</bold>: AUROC is the Area Under the Receiver Operating Characteristic curve, which is a threshold independent metric [<xref rid="ref30" ref-type="bibr">30</xref>]. The AUROC shows the relationship between TPR and FPR. It could be interpreted as the probability that a positive sample has a higher score than a negative sample [<xref rid="ref48" ref-type="bibr">48</xref>].</p>
        </list-item>
        <list-item>
          <p>(3) <bold>AUPR</bold>: AUPR is the Area Under the Precision-Recall curve, which is also a threshold independent metric [<xref rid="ref49" ref-type="bibr">49</xref>, <xref rid="ref50" ref-type="bibr">50</xref>]. It depicts the relationship between precision =<inline-formula><tex-math notation="LaTeX" id="ImEquation139">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\frac{TP}{TP+FP}$\end{document}</tex-math></inline-formula>and recall=<inline-formula><tex-math notation="LaTeX" id="ImEquation140">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\frac{TP}{TP+FN}$\end{document}</tex-math></inline-formula>. The AUPR is high in our experiments because the amount of novel cells is small compared to typical cells.</p>
        </list-item>
      </list>
    </app>
    <app id="app3">
      <title>C. Appendix methods</title>
      <sec id="app3a">
        <title>C.1 Neural network for rare cell feature extraction</title>
        <p>To better extract input features, we employ a neural network classifier. The single-cell transcriptome data are processed by a neural network classifier <inline-formula><tex-math notation="LaTeX" id="ImEquation141">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$f$\end{document}</tex-math></inline-formula> to get prediction probability <inline-formula><tex-math notation="LaTeX" id="ImEquation142">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$p(\boldsymbol{x})$\end{document}</tex-math></inline-formula>. The classifier has several hidden layers, whose structure is shown in <xref rid="f7" ref-type="fig">Appendix Figure 1</xref>. Besides a Fully-Connected Layer (FC) in each hidden layer, we utilize batch normalization (BN), Exponential Linear Unit (ELU) activation function and dropout sequentially to speed up training, avoid overfitting and elevate predictive performance. Our network design encompasses architecture, activation functions, and loss functions that are consistent with methodologies applied in similar studies focusing on rare cells and classes with limited quantities [<xref rid="ref16" ref-type="bibr">16</xref>, <xref rid="ref51" ref-type="bibr">51</xref>, <xref rid="ref52" ref-type="bibr">52</xref>]. This alignment underscores our commitment to precisely handling rare cells to enhance feature extraction and improve performance: </p>
        <disp-formula id="deqn01">
          <label>(C.1)</label>
          <tex-math notation="LaTeX" id="DmEquation1">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
\begin{align*}&amp; \begin{split} \boldsymbol{x}^{l-1}_{BN}&amp;=BN(\boldsymbol{x}^{l-1}),\\ \boldsymbol{x}^{l-1}_{ELU}&amp;=ELU(\boldsymbol{x}^{l-1}_{BN}),\\ \boldsymbol{x}^{l-1}_{Dropout}&amp;=Dropout(\boldsymbol{x}^{l-1}_{ELU}), \end{split}\end{align*}\end{document}</tex-math>
        </disp-formula>
        <p>where <inline-formula><tex-math notation="LaTeX" id="ImEquation143">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\boldsymbol{x}^{l-1}$\end{document}</tex-math></inline-formula> is the feature output of the <inline-formula><tex-math notation="LaTeX" id="ImEquation144">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$(l-1)$\end{document}</tex-math></inline-formula>th FC layer; ELU processes features with Equation (<xref rid="deqn02" ref-type="disp-formula">C.2</xref>) </p>
        <disp-formula id="deqn02">
          <label>(C.2)</label>
          <tex-math notation="LaTeX" id="DmEquation2">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
\begin{align*}&amp; ELU(\boldsymbol{x})=\left\{ \begin{array}{@{}lr} x,\quad if\ \boldsymbol{x} \geq 0, &amp;\\ \alpha e(e^{\boldsymbol{x}}-1),\quad if\ \boldsymbol{x} &lt; 0. &amp;\\ \end{array} \right.\end{align*}\end{document}</tex-math>
        </disp-formula>
        <table-wrap position="anchor" id="TB1">
          <label>Appendix Table 1</label>
          <caption>
            <p>Datasets considered</p>
          </caption>
          <table frame="hsides" rules="groups">
            <colgroup span="1">
              <col span="1" align="left"/>
              <col span="1" align="left"/>
              <col span="1" align="left"/>
              <col span="1" align="left"/>
              <col span="1" align="left"/>
            </colgroup>
            <thead>
              <tr>
                <th align="left" rowspan="1" colspan="1">Datasets</th>
                <th align="left" rowspan="1" colspan="1">Cell numbers</th>
                <th align="left" rowspan="1" colspan="1">Class numbers</th>
                <th align="left" rowspan="1" colspan="1">Protocols</th>
                <th align="left" rowspan="1" colspan="1">Source</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td rowspan="1" colspan="1">Darmains</td>
                <td rowspan="1" colspan="1">466</td>
                <td rowspan="1" colspan="1">9</td>
                <td rowspan="1" colspan="1">SMARTer</td>
                <td rowspan="1" colspan="1">Darmains <italic toggle="yes">et al</italic>. [<xref rid="ref40" ref-type="bibr">40</xref>]</td>
              </tr>
              <tr>
                <td rowspan="1" colspan="1">Muraro</td>
                <td rowspan="1" colspan="1">2122</td>
                <td rowspan="1" colspan="1">9</td>
                <td rowspan="1" colspan="1">Cel-Seq2</td>
                <td rowspan="1" colspan="1">Muraro <italic toggle="yes">et al</italic>. [<xref rid="ref41" ref-type="bibr">41</xref>]</td>
              </tr>
              <tr>
                <td rowspan="1" colspan="1">Baron Mouse</td>
                <td rowspan="1" colspan="1">1886</td>
                <td rowspan="1" colspan="1">13</td>
                <td rowspan="1" colspan="1">inDrop</td>
                <td rowspan="1" colspan="1">Baron <italic toggle="yes">et al</italic>. [<xref rid="ref42" ref-type="bibr">42</xref>]</td>
              </tr>
              <tr>
                <td rowspan="1" colspan="1">Baron Human</td>
                <td rowspan="1" colspan="1">8569</td>
                <td rowspan="1" colspan="1">14</td>
                <td rowspan="1" colspan="1">inDrop</td>
                <td rowspan="1" colspan="1">Baron <italic toggle="yes">et al</italic>. [<xref rid="ref42" ref-type="bibr">42</xref>]</td>
              </tr>
              <tr>
                <td rowspan="1" colspan="1">Seq-Well</td>
                <td rowspan="1" colspan="1">18 966</td>
                <td rowspan="1" colspan="1">7</td>
                <td rowspan="1" colspan="1">Seq-Well</td>
                <td rowspan="1" colspan="1">Ding <italic toggle="yes">et al</italic>. [<xref rid="ref43" ref-type="bibr">43</xref>]</td>
              </tr>
              <tr>
                <td rowspan="1" colspan="1">Campbell</td>
                <td rowspan="1" colspan="1">21 086</td>
                <td rowspan="1" colspan="1">35</td>
                <td rowspan="1" colspan="1">Drop-Seq</td>
                <td rowspan="1" colspan="1">Campbell <italic toggle="yes">et al</italic>. [<xref rid="ref44" ref-type="bibr">44</xref>]</td>
              </tr>
              <tr>
                <td rowspan="1" colspan="1">Zilionis</td>
                <td rowspan="1" colspan="1">34 558</td>
                <td rowspan="1" colspan="1">9</td>
                <td rowspan="1" colspan="1">inDrop</td>
                <td rowspan="1" colspan="1">Zilionis <italic toggle="yes">et al</italic>. [<xref rid="ref45" ref-type="bibr">45</xref>]</td>
              </tr>
              <tr>
                <td rowspan="1" colspan="1">TM</td>
                <td rowspan="1" colspan="1">54 865</td>
                <td rowspan="1" colspan="1">55</td>
                <td rowspan="1" colspan="1">10X Genomics</td>
                <td rowspan="1" colspan="1">Schaum <italic toggle="yes">et al</italic>. [<xref rid="ref46" ref-type="bibr">46</xref>]</td>
              </tr>
              <tr>
                <td rowspan="1" colspan="1">PbmcBench 10X (V2)</td>
                <td rowspan="1" colspan="1">23 154</td>
                <td rowspan="1" colspan="1">9</td>
                <td rowspan="1" colspan="1">10X Genomics (v2)</td>
                <td rowspan="1" colspan="1">Ding <italic toggle="yes">et al</italic>. [<xref rid="ref43" ref-type="bibr">43</xref>]</td>
              </tr>
              <tr>
                <td rowspan="1" colspan="1">PbmcBench 10X (V3)</td>
                <td rowspan="1" colspan="1">19 690</td>
                <td rowspan="1" colspan="1">8</td>
                <td rowspan="1" colspan="1">10X Genomics (v3)</td>
                <td rowspan="1" colspan="1">Ding <italic toggle="yes">et al</italic>. [<xref rid="ref43" ref-type="bibr">43</xref>]</td>
              </tr>
              <tr>
                <td rowspan="1" colspan="1">PbmcBench (CEL-Seq)</td>
                <td rowspan="1" colspan="1">19 754</td>
                <td rowspan="1" colspan="1">7</td>
                <td rowspan="1" colspan="1">CEL-Seq2</td>
                <td rowspan="1" colspan="1">Ding <italic toggle="yes">et al</italic>. [<xref rid="ref43" ref-type="bibr">43</xref>]</td>
              </tr>
              <tr>
                <td rowspan="1" colspan="1">PbmcBench (Drop-Seq)</td>
                <td rowspan="1" colspan="1">23 154</td>
                <td rowspan="1" colspan="1">9</td>
                <td rowspan="1" colspan="1">Drop-Seq</td>
                <td rowspan="1" colspan="1">Ding <italic toggle="yes">et al</italic>. [<xref rid="ref43" ref-type="bibr">43</xref>]</td>
              </tr>
              <tr>
                <td rowspan="1" colspan="1">PbmcBench (inDrop)</td>
                <td rowspan="1" colspan="1">21 832</td>
                <td rowspan="1" colspan="1">7</td>
                <td rowspan="1" colspan="1">inDrop</td>
                <td rowspan="1" colspan="1">Ding <italic toggle="yes">et al</italic>. [<xref rid="ref43" ref-type="bibr">43</xref>]</td>
              </tr>
              <tr>
                <td rowspan="1" colspan="1">PKU-Covid Atlas</td>
                <td rowspan="1" colspan="1">1 462 702</td>
                <td rowspan="1" colspan="1">64</td>
                <td rowspan="1" colspan="1">10X Genomics</td>
                <td rowspan="1" colspan="1">Ren et al. [<xref rid="ref29" ref-type="bibr">29</xref>]</td>
              </tr>
              <tr>
                <td rowspan="1" colspan="1">GSE171524</td>
                <td rowspan="1" colspan="1">116 314</td>
                <td rowspan="1" colspan="1">19</td>
                <td rowspan="1" colspan="1">10X Genomics</td>
                <td rowspan="1" colspan="1">Melms et al. [<xref rid="ref32" ref-type="bibr">32</xref>]</td>
              </tr>
            </tbody>
          </table>
        </table-wrap>
        <fig position="anchor" id="f7">
          <label>Appendix Figure 1</label>
          <caption>
            <p>Detailed Framework of scNovel. The input <inline-formula><tex-math notation="LaTeX" id="ImEquation8">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\boldsymbol{x}$\end{document}</tex-math></inline-formula> is a single-cell gene expression. We employ a neural network to extract the single-cell feature. Then, map it <inline-formula><tex-math notation="LaTeX" id="ImEquation9">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$C^{ref}$\end{document}</tex-math></inline-formula> dimension to get cell-type probability prediction <inline-formula><tex-math notation="LaTeX" id="ImEquation10">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$p( \boldsymbol{x})$\end{document}</tex-math></inline-formula>. During the training stage, we employ the cross-entropy loss to optimize the network. We introduce two optional query stages, where barcode preprocessing is utilized to augment the predictive capabilities of scNovel. During the parallel query stage, <inline-formula><tex-math notation="LaTeX" id="ImEquation11">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$T_{plus}(x)$\end{document}</tex-math></inline-formula> and <inline-formula><tex-math notation="LaTeX" id="ImEquation12">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$T_{minus}(x)$\end{document}</tex-math></inline-formula> are obtained through different operations that composite the input <inline-formula><tex-math notation="LaTeX" id="ImEquation13">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\boldsymbol{x}$\end{document}</tex-math></inline-formula> and the processed barcode data to one vector. Then, at the sequential query stage, <inline-formula><tex-math notation="LaTeX" id="ImEquation14">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$T_{minus}(T_{plus}(x))$\end{document}</tex-math></inline-formula> is leveraged for further refinement of the barcode data. We define four modes of novel cell detection based on the proposed query stages.</p>
          </caption>
          <graphic xlink:href="bbae112fx1" position="float"/>
        </fig>
        <p>Given input <inline-formula><tex-math notation="LaTeX" id="ImEquation145">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\boldsymbol{x}$\end{document}</tex-math></inline-formula>, the proposed network process is defined as the following: </p>
        <disp-formula id="deqn03">
          <label>(C.3)</label>
          <tex-math notation="LaTeX" id="DmEquation3">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
\begin{align*}&amp; \begin{split} \boldsymbol{x}_{1}&amp;=InputLayer(\boldsymbol{x}),\quad\quad\quad \boldsymbol{x}_{2}=HiddenLayer_{1}(\boldsymbol{x}_{1}),\\ \boldsymbol{x}_{3}&amp;=HiddenLayer_{2}(\boldsymbol{x}_{2}),\quad \boldsymbol{x}_{4}=HiddenLayer_{3}(\boldsymbol{x}_{3}),\\ f(\boldsymbol{x})&amp;=FC(x_{4}),\quad\quad\quad\quad\quad p(\boldsymbol{x})=Softmax(f(\boldsymbol{x})), \end{split}\end{align*}\end{document}</tex-math>
        </disp-formula>
        <p>where <inline-formula><tex-math notation="LaTeX" id="ImEquation146">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\,\boldsymbol{x}_{1}$\end{document}</tex-math></inline-formula> is the feature output after <inline-formula><tex-math notation="LaTeX" id="ImEquation147">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$InputLayer$\end{document}</tex-math></inline-formula>; <inline-formula><tex-math notation="LaTeX" id="ImEquation148">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\boldsymbol{x}_{2}$\end{document}</tex-math></inline-formula>, <inline-formula><tex-math notation="LaTeX" id="ImEquation149">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\boldsymbol{x}_{3}$\end{document}</tex-math></inline-formula> and <inline-formula><tex-math notation="LaTeX" id="ImEquation150">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\boldsymbol{x}_{4}$\end{document}</tex-math></inline-formula> are the features after <inline-formula><tex-math notation="LaTeX" id="ImEquation151">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$HiddenLayer_{1}$\end{document}</tex-math></inline-formula>, <inline-formula><tex-math notation="LaTeX" id="ImEquation152">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$HiddenLayer_{2}$\end{document}</tex-math></inline-formula> and <inline-formula><tex-math notation="LaTeX" id="ImEquation153">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$HiddenLayer_{3}$\end{document}</tex-math></inline-formula> respectively; <inline-formula><tex-math notation="LaTeX" id="ImEquation154">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$f(\boldsymbol{x})$\end{document}</tex-math></inline-formula>, processed by FC, is the feature of input <inline-formula><tex-math notation="LaTeX" id="ImEquation155">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\boldsymbol{x}$\end{document}</tex-math></inline-formula>; <inline-formula><tex-math notation="LaTeX" id="ImEquation156">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$p(\boldsymbol{x})$\end{document}</tex-math></inline-formula> is the prediction probability. More details can be found in Appendix <xref rid="app3" ref-type="app">C</xref>.</p>
      </sec>
      <sec id="app3b">
        <title>C.2 Training stage</title>
        <p>scNovel takes a single-cell RNA expression matrix M as an input, where each column corresponds to a gene and each row corresponds to a cell. As shown in <xref rid="f7" ref-type="fig">Appendix Figure 1</xref>, we first consider a supervised multi-class classification task problem. We denote <inline-formula><tex-math notation="LaTeX" id="ImEquation157">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\mathcal{D}_{ref}=\{\boldsymbol{x_{i}},y_{i}\}_{i=1}^{n^{ref}}$\end{document}</tex-math></inline-formula> as the reference set with <inline-formula><tex-math notation="LaTeX" id="ImEquation158">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$C^{ref} \in \mathbb{N}^{+}$\end{document}</tex-math></inline-formula> cell types. <inline-formula><tex-math notation="LaTeX" id="ImEquation159">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\mathcal{X}$\end{document}</tex-math></inline-formula> represents the input space, while <inline-formula><tex-math notation="LaTeX" id="ImEquation160">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\mathcal{Y}=\{1,2...,C^{ref}\}$\end{document}</tex-math></inline-formula> signifies the label space with <inline-formula><tex-math notation="LaTeX" id="ImEquation161">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$C^{ref}$\end{document}</tex-math></inline-formula> classes. <inline-formula><tex-math notation="LaTeX" id="ImEquation162">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\mathcal{P}_{typical}$\end{document}</tex-math></inline-formula> and <inline-formula><tex-math notation="LaTeX" id="ImEquation163">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\mathcal{P}_{novel}$\end{document}</tex-math></inline-formula> represent the distribution of typical cells and novel cells. Given a dataset, with trainable parameter <inline-formula><tex-math notation="LaTeX" id="ImEquation164">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\theta \in \mathbb{R}^{p}$\end{document}</tex-math></inline-formula>, a classifier f: <inline-formula><tex-math notation="LaTeX" id="ImEquation165">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\mathcal{X} \rightarrow \mathbb{R}^{C^{ref}}$\end{document}</tex-math></inline-formula> maps an input to the output space <inline-formula><tex-math notation="LaTeX" id="ImEquation166">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\mathbb{R}^{C^{ref}}$\end{document}</tex-math></inline-formula>. Here, the cross-entropy loss is calculated for optimization: </p>
        <disp-formula id="deqn04">
          <label>(C.4)</label>
          <tex-math notation="LaTeX" id="DmEquation4">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
\begin{align*} &amp; p(\boldsymbol{x})=\operatorname{softmax}(f(\boldsymbol{x};\theta),j)=\frac{e^{f_{j}(\boldsymbol{x};\theta)/T}}{\sum_{i=1}^{k}e^{f_{i}(\boldsymbol{x};\theta)/T}},\end{align*}\end{document}</tex-math>
        </disp-formula>
        <disp-formula id="deqn05">
          <label>(C.5)</label>
          <tex-math notation="LaTeX" id="DmEquation5">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
\begin{align*}&amp; \mathcal{L}_{\mathrm{CE}}(f(x;\theta),y)=-\log p(y\lvert\boldsymbol{x})=-\log p_{y}(\boldsymbol{x}),\end{align*}\end{document}</tex-math>
        </disp-formula>
        <p>where input <inline-formula><tex-math notation="LaTeX" id="ImEquation167">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\boldsymbol{x}$\end{document}</tex-math></inline-formula> is the gene expression profile of a cell, which is a row of single-cell RNA expression matrix M; <inline-formula><tex-math notation="LaTeX" id="ImEquation168">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$f(\boldsymbol{x})$\end{document}</tex-math></inline-formula> is the feature of input <inline-formula><tex-math notation="LaTeX" id="ImEquation169">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\boldsymbol{x}$\end{document}</tex-math></inline-formula>; <inline-formula><tex-math notation="LaTeX" id="ImEquation170">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$f_{i}(\boldsymbol{x})$\end{document}</tex-math></inline-formula> is the <inline-formula><tex-math notation="LaTeX" id="ImEquation171">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$i^{th}$\end{document}</tex-math></inline-formula> element of <inline-formula><tex-math notation="LaTeX" id="ImEquation172">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$f(\boldsymbol{x})$\end{document}</tex-math></inline-formula>, given the label <inline-formula><tex-math notation="LaTeX" id="ImEquation173">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$i$\end{document}</tex-math></inline-formula>; <inline-formula><tex-math notation="LaTeX" id="ImEquation174">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$p(\boldsymbol{x})$\end{document}</tex-math></inline-formula> is the prediction probability of input <inline-formula><tex-math notation="LaTeX" id="ImEquation175">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\boldsymbol{x}$\end{document}</tex-math></inline-formula>; <inline-formula><tex-math notation="LaTeX" id="ImEquation176">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$p(y\lvert \boldsymbol{x})$\end{document}</tex-math></inline-formula> is <inline-formula><tex-math notation="LaTeX" id="ImEquation177">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$y^{th}$\end{document}</tex-math></inline-formula> element of <inline-formula><tex-math notation="LaTeX" id="ImEquation178">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$p(\boldsymbol{x})$\end{document}</tex-math></inline-formula>, given the ground truth label <inline-formula><tex-math notation="LaTeX" id="ImEquation179">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$y$\end{document}</tex-math></inline-formula>; T is a hyperparameter, and we use 1000 as the default value (follow the parameter setting in [<xref rid="ref47" ref-type="bibr">47</xref>]).</p>
        <p>In the training stage, we minimize the cross-entropy loss in Equation (<xref rid="deqn05" ref-type="disp-formula">C.5</xref>) with the reference set <inline-formula><tex-math notation="LaTeX" id="ImEquation180">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\mathcal{D}_{ref}$\end{document}</tex-math></inline-formula>. In the query stage, samples from novel distributions <inline-formula><tex-math notation="LaTeX" id="ImEquation181">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\mathcal{P}_{novel}$\end{document}</tex-math></inline-formula> may appear, and the cell-type set of <inline-formula><tex-math notation="LaTeX" id="ImEquation182">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\mathcal{P}_{novel}$\end{document}</tex-math></inline-formula> has no intersection with the reference set label space <inline-formula><tex-math notation="LaTeX" id="ImEquation183">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\mathcal{Y}$\end{document}</tex-math></inline-formula>. Such samples come from novel distribution <inline-formula><tex-math notation="LaTeX" id="ImEquation184">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\mathcal{P}_{novel}$\end{document}</tex-math></inline-formula> should be detected by our proposed model.</p>
      </sec>
      <sec id="app3c">
        <title>C.3 Barcode preprocessing</title>
        <p>The novel rare cell discovery task could be formulated as a binary classification problem. We determine an input <inline-formula><tex-math notation="LaTeX" id="ImEquation185">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\boldsymbol{x} \in \mathcal{X}$\end{document}</tex-math></inline-formula> coming from <inline-formula><tex-math notation="LaTeX" id="ImEquation186">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\mathcal{P}_{typical}$\end{document}</tex-math></inline-formula> or <inline-formula><tex-math notation="LaTeX" id="ImEquation187">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\mathcal{P}_{novel}$\end{document}</tex-math></inline-formula> via the process shown in <xref rid="f7" ref-type="fig">Appendix Figure 1</xref>. Given an input, we utilize a classifier to get prediction probability <inline-formula><tex-math notation="LaTeX" id="ImEquation188">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$p(\boldsymbol{x})$\end{document}</tex-math></inline-formula>. The simplest score function, named traditional classification model, is defined as the following [<xref rid="ref53" ref-type="bibr">53</xref>]: </p>
        <disp-formula id="deqn06">
          <label>(C.6)</label>
          <tex-math notation="LaTeX" id="DmEquation6">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
\begin{align*}&amp; S^{MSP}(\boldsymbol{x})=\underset{j \in \mathcal{Y}}{max}\ \ p_{j}(\boldsymbol{x}),\end{align*}\end{document}</tex-math>
        </disp-formula>
        <p>where we choose the max probability as the decision score; <inline-formula><tex-math notation="LaTeX" id="ImEquation189">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$p_{j}(\boldsymbol{x})$\end{document}</tex-math></inline-formula> is the <inline-formula><tex-math notation="LaTeX" id="ImEquation190">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$j^{th}$\end{document}</tex-math></inline-formula> element of <inline-formula><tex-math notation="LaTeX" id="ImEquation191">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$p(\boldsymbol{x})$\end{document}</tex-math></inline-formula>. Based on this setting, we define the binary decision function to be </p>
        <disp-formula id="deqn07">
          <label>(C.7)</label>
          <tex-math notation="LaTeX" id="DmEquation7">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
\begin{align*}&amp; G(\boldsymbol{x})=\left\{ \begin{array}{@{}lr} Typical,\quad if\ S(\boldsymbol{x}) \geq \lambda, &amp;\\ Novel,\quad if\ S(\boldsymbol{x}) &lt; \lambda. &amp;\\ \end{array} \right.\end{align*}\end{document}</tex-math>
        </disp-formula>
        <p>where <inline-formula><tex-math notation="LaTeX" id="ImEquation192">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$S(*)$\end{document}</tex-math></inline-formula> is the score function and <inline-formula><tex-math notation="LaTeX" id="ImEquation193">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$G(*)$\end{document}</tex-math></inline-formula> is the novelty classification that <inline-formula><tex-math notation="LaTeX" id="ImEquation194">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$x$\end{document}</tex-math></inline-formula> belongs to; <inline-formula><tex-math notation="LaTeX" id="ImEquation195">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\lambda $\end{document}</tex-math></inline-formula> is a hyperparameter that we set as a threshold with a default value of 0.5 (recommended). Usually, samples with a score that reaches the threshold are classified as typical of a certain cell type that the max probability corresponds to, and those with a score below the threshold are classified to be novel. To be more specific, the higher the score is, the lower probability that the cell type is novel.</p>
        <p><bold>Parallel query stage</bold> To further improve the model performance, we add barcode preprocessing when testing on the query dataset. The core idea is that adding input perturbations to the sample could help enlarge the margin between typical cell data and novel cell data [<xref rid="ref47" ref-type="bibr">47</xref>]. Hence, the barcode preprocessing can have a higher effect on typical cell types (the score will be changed more, including increasing more and decreasing more), and it has a lower effect on novel cell types ( the score will not change too much). As shown in <xref rid="f7" ref-type="fig">Appendix Figure 1</xref>, we design two types of barcode preprocessing <inline-formula><tex-math notation="LaTeX" id="ImEquation196">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$T_{minus}$\end{document}</tex-math></inline-formula> and <inline-formula><tex-math notation="LaTeX" id="ImEquation197">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$T_{plus}$\end{document}</tex-math></inline-formula> with different composition operations: </p>
        <disp-formula id="deqn08">
          <label>(C.8)</label>
          <tex-math notation="LaTeX" id="DmEquation8">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
\begin{align*} &amp; \begin{aligned} S_{\hat{y}}(\boldsymbol{x})= \underset{j \in \mathcal{Y}}{max}\ p_{j}(\boldsymbol{x}), \end{aligned}\end{align*}\end{document}</tex-math>
        </disp-formula>
        <disp-formula id="deqn09">
          <label>(C.9)</label>
          <tex-math notation="LaTeX" id="DmEquation9">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
\begin{align*}&amp; \begin{aligned} T_{plus}(\boldsymbol{x})=\boldsymbol{x}-\epsilon sign(-\nabla_{\boldsymbol{x}}\ logS_{\hat{y}}(x) ) = \boldsymbol{x}+\epsilon sign(\nabla_{\boldsymbol{x}}\ logS_{\hat{y}}(x) ),\\ T_{minus}(\boldsymbol{x})=\boldsymbol{x}+\epsilon sign(-\nabla_{\boldsymbol{x}}\ logS_{\hat{y}}(\boldsymbol{x}) ) =\boldsymbol{x}-\epsilon sign(\nabla_{\boldsymbol{x}}\ logS_{\hat{y}}(\boldsymbol{x}) ). \end{aligned}\end{align*}\end{document}</tex-math>
        </disp-formula>
        <p>where <inline-formula><tex-math notation="LaTeX" id="ImEquation198">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\epsilon $\end{document}</tex-math></inline-formula> is the perturbation hyperparameter, whose default value is 0.0014; for the two barcode preprocessing methods, we first compute the gradient via backpropagation, and then the gradient will multiply by hyperparameter <inline-formula><tex-math notation="LaTeX" id="ImEquation199">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\epsilon $\end{document}</tex-math></inline-formula>; <inline-formula><tex-math notation="LaTeX" id="ImEquation200">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$T_{minus}(x)$\end{document}</tex-math></inline-formula> minus the multiplication result, while <inline-formula><tex-math notation="LaTeX" id="ImEquation201">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$T_{plus}(x)$\end{document}</tex-math></inline-formula> plus the multiplication result; usually, <inline-formula><tex-math notation="LaTeX" id="ImEquation202">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$S(T_{minus}(x))$\end{document}</tex-math></inline-formula> is larger than S(x), while <inline-formula><tex-math notation="LaTeX" id="ImEquation203">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$S(T_{plus}(x))$\end{document}</tex-math></inline-formula> is smaller than <inline-formula><tex-math notation="LaTeX" id="ImEquation204">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$S(x)$\end{document}</tex-math></inline-formula>. We design Single Plus-Composition Mode, denoted as <inline-formula><tex-math notation="LaTeX" id="ImEquation205">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$S^{ODIN}$\end{document}</tex-math></inline-formula>, which employs the following equation for barcode preprocessing [<xref rid="ref47" ref-type="bibr">47</xref>]: </p>
        <disp-formula id="deqn10">
          <label>(C.10)</label>
          <tex-math notation="LaTeX" id="DmEquation10">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
\begin{align*}&amp; S^{ODIN}(\boldsymbol{x})=\underset{j \in \mathcal{Y}}{max}\ \ p_{j}(T_{plus}(\boldsymbol{x})).\end{align*}\end{document}</tex-math>
        </disp-formula>
        <p>In fact, we could write a general formulation of Equation (<xref rid="deqn10" ref-type="disp-formula">C.10</xref>) as follows: </p>
        <disp-formula id="deqn11">
          <label>(C.11)</label>
          <tex-math notation="LaTeX" id="DmEquation11">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
\begin{align*}&amp; \begin{aligned} S^{ODIN}(\boldsymbol{x})&amp;=\underset{j \in \mathcal{Y}}{max}\ \ \{ \underbrace{p_{j}(\boldsymbol{x})}_{magnitude}+ \underbrace{p_{j}(T_{plus}(\boldsymbol{x}))-p_{j}(\boldsymbol{x})}_{up-sharpness}\}, \end{aligned}\end{align*}\end{document}</tex-math>
        </disp-formula>
        <p>
where the magnitude is the score of input <inline-formula><tex-math notation="LaTeX" id="ImEquation206">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$x$\end{document}</tex-math></inline-formula> without barcode preprocessing; the up-sharpness is the increment in score after the <inline-formula><tex-math notation="LaTeX" id="ImEquation207">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$T_{plus}$\end{document}</tex-math></inline-formula> process. The limitation of <inline-formula><tex-math notation="LaTeX" id="ImEquation208">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$S^{ODIN}$\end{document}</tex-math></inline-formula> is that it only considers up-sharpness but does not consider down-sharpness, which is the decrease in score after the <inline-formula><tex-math notation="LaTeX" id="ImEquation209">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$T_{minus}$\end{document}</tex-math></inline-formula> process. Hence, we could simultaneously calculate up-sharpness and down-sharpness at the same input <inline-formula><tex-math notation="LaTeX" id="ImEquation210">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$x$\end{document}</tex-math></inline-formula>, which is <inline-formula><tex-math notation="LaTeX" id="ImEquation211">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$S^{SIM}$\end{document}</tex-math></inline-formula>, named Parallel Composition Mode defined in the following: </p>
        <disp-formula id="deqn12">
          <label>(C.12)</label>
          <tex-math notation="LaTeX" id="DmEquation12">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
\begin{align*} S^{SIM}(\boldsymbol{x})&amp;=\,\underset{j \in \mathcal{Y}}{max}\{ \underbrace{p_{j}(\boldsymbol{x}) }_{magnitude}+ \underbrace{p_{j}(T_{plus}(\boldsymbol{x}))-p_{j}(\boldsymbol{x})}_{up-sharpness}+\underbrace{p_{j}(\boldsymbol{x})-p_{j}(T_{minus}(\boldsymbol{x}))}_{down-sharpness}\}\nonumber\\ &amp;=\,\underset{j \in \mathcal{Y}}{max}\{ p_{j}(\boldsymbol{x})+p_{j}(T_{plus}(\boldsymbol{x}))-p_{j}(T_{minus}(\boldsymbol{x}))\}. \end{align*}\end{document}</tex-math>
        </disp-formula>
        <p>To summarize, the parallel query stage considers two novel cell detection modes, namely Single Plus-Composition Mode and Parallel Composition Mode. Score functions <inline-formula><tex-math notation="LaTeX" id="ImEquation212">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$S^{SIM}$\end{document}</tex-math></inline-formula> consider both up-sharpness and down-sharpness, while <inline-formula><tex-math notation="LaTeX" id="ImEquation213">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$S^{ODIN}$\end{document}</tex-math></inline-formula> only considers up-sharpness.</p>
        <p><bold>Sequential query stage</bold> Moreover, we could also sequentially calculate up-sharpness and down-sharpness using the same input <inline-formula><tex-math notation="LaTeX" id="ImEquation214">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$x$\end{document}</tex-math></inline-formula> using the Sequential Composition Mode. Score <inline-formula><tex-math notation="LaTeX" id="ImEquation215">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$S^{SEQ}$\end{document}</tex-math></inline-formula> is defined as follows: </p>
        <disp-formula id="deqn13">
          <label>(C.13)</label>
          <tex-math notation="LaTeX" id="DmEquation13">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
\begin{align*}&amp; \begin{aligned} S^{SEQ}(\boldsymbol{x})&amp;=\underset{j \in \mathcal{Y}}{max}\{ \underbrace{p_{j}(\boldsymbol{x})} _{magnitude}+ \underbrace{p_{j}(T_{plus}(\boldsymbol{x}))-p_{j}(\boldsymbol{x})}_{up-sharpness}\\&amp;\quad+\underbrace{p_{j}(T_{plus}(\boldsymbol{x}))-p_{j}(T_{minus}(T_{plus}(\boldsymbol{x})))}_{down-sharpness}\}\\ &amp;=\underset{j \in \mathcal{Y}}{max}\{ 2*p_{j}(T_{plus}(\boldsymbol{x}))- p_{j}(T_{minus}(T_{plus}(\boldsymbol{x})))\}.\\ \end{aligned}\end{align*}\end{document}</tex-math>
        </disp-formula>
        <p>In this mode, we sequentially calculate up-sharpness at the input x and down-sharpness at <inline-formula><tex-math notation="LaTeX" id="ImEquation216">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$T_{plus}(x)$\end{document}</tex-math></inline-formula>.</p>
        <p>
          <inline-graphic xlink:href="bbae112fx2.jpg" id="bbae112fx2"/>
        </p>
      </sec>
      <sec id="app3d">
        <title>C.4 Score normalization</title>
        <p>The score normalization is employed to resize the score obtained from the score function. The scores will become relatively small with the increase of hyperparameter <inline-formula><tex-math notation="LaTeX" id="ImEquation217">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$T$\end{document}</tex-math></inline-formula> proposed in Equation (<xref rid="deqn04" ref-type="disp-formula">C.4</xref>). Hence, we employ the following equations to normalize our scores: </p>
        <disp-formula id="deqn14">
          <label>(C.14)</label>
          <tex-math notation="LaTeX" id="DmEquation15">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
\begin{align*} \begin{split} S_{refMax}&amp;=\underset{\boldsymbol{x} \in \mathcal{D}_{ref}} {max}\ S(\boldsymbol{x}), \end{split}\end{align*}\end{document}</tex-math>
        </disp-formula>
        <disp-formula id="deqn15">
          <label>(C.15)</label>
          <tex-math notation="LaTeX" id="DmEquation16">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
\begin{align*} \begin{split} S^{norm}(\boldsymbol{x})&amp;=\frac{S(x)-1/C^{ref}}{S_{refMax}-1/C^{ref}},\\ \end{split}\end{align*}\end{document}</tex-math>
        </disp-formula>
        <p>
where <inline-formula><tex-math notation="LaTeX" id="ImEquation218">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$S_{refMax}$\end{document}</tex-math></inline-formula> is the max score obtained from the reference set via our proposed score functions; <inline-formula><tex-math notation="LaTeX" id="ImEquation219">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$S^{norm}(\boldsymbol{x})$\end{document}</tex-math></inline-formula> is the normalization score of input <inline-formula><tex-math notation="LaTeX" id="ImEquation220">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\boldsymbol{x}$\end{document}</tex-math></inline-formula>, which is within the range of <inline-formula><tex-math notation="LaTeX" id="ImEquation221">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$[0,1]$\end{document}</tex-math></inline-formula>.</p>
      </sec>
      <sec id="app3e">
        <title>C.5 Architecture and hyperparameters</title>
        <p>We show the overall pipeline in Algorithm 1. We train a classifier <inline-formula><tex-math notation="LaTeX" id="ImEquation222">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$f$\end{document}</tex-math></inline-formula> with the reference set <inline-formula><tex-math notation="LaTeX" id="ImEquation223">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\mathcal{D}_{ref}$\end{document}</tex-math></inline-formula> sampled from <inline-formula><tex-math notation="LaTeX" id="ImEquation224">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\mathcal{P}_{typical}$\end{document}</tex-math></inline-formula>. Model parameter <inline-formula><tex-math notation="LaTeX" id="ImEquation225">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\theta $\end{document}</tex-math></inline-formula> is updated via backpropagation with the cross-entropy loss <inline-formula><tex-math notation="LaTeX" id="ImEquation226">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\mathcal{L}_{CE}$\end{document}</tex-math></inline-formula> described in Equation (<xref rid="deqn05" ref-type="disp-formula">C.5</xref>). The number of neurons in the input layer is equal to the number of genes in the scRNA-seq dataset. The three subsequent hidden layers include 128, 64 and 32 units, respectively. The dropout rate of the dropout layer is 0.5 by default. We utilize AdamW [<xref rid="ref54" ref-type="bibr">54</xref>] with <inline-formula><tex-math notation="LaTeX" id="ImEquation227">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$1e-4$\end{document}</tex-math></inline-formula> as the learning rate to optimize the network. The hyperparameter <inline-formula><tex-math notation="LaTeX" id="ImEquation228">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$T$\end{document}</tex-math></inline-formula> is set to be 1000, and the perturbation hyperparameter <inline-formula><tex-math notation="LaTeX" id="ImEquation229">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\epsilon $\end{document}</tex-math></inline-formula> is 0.0014 (follow the parameter setting in [<xref rid="ref47" ref-type="bibr">47</xref>]). The training batch size and iteration number are flexible for users, and we recommend users set the training batch size to at least 32 and the iteration number to at least 3000 to train the model well. All experiments are conducted on a GTX2080 Ti.</p>
      </sec>
      <sec id="app3f">
        <title>C.6 Softeware comparison and settings</title>
        <p>To evaluate the effectiveness of scNovel, we conducted a comparative analysis with various commonly employed techniques, including Scmap-cell, Scmap-cluster, scPred and scLearn. The evaluation criteria, as well as the input data, were obtained following the instructions and tutorials provided by each respective package. In order to maintain a level playing field, we adhered to the default parameters for all the methods utilized, including that of scNovel. </p>
        <p>The software applications utilized in our study are as follows:</p>
        <list list-type="bullet">
          <list-item>
            <p>scmap-Cell and scmap-Cluster, both of which were sourced from BioManager (<ext-link xlink:href="https://github.com/hemberg-lab/scmap" ext-link-type="uri">https://git hub.com/hemberg-lab/scmap</ext-link>). The parameter settings for these functions were in accordance with the accompanying instructions.</p>
          </list-item>
          <list-item>
            <p>scPred, which was obtained from BiocManager (<ext-link xlink:href="https://github.com/powellgenomicslab/scPred" ext-link-type="uri">https://github.com/powellgenomicslab/scPred</ext-link>), was executed under default parameters. The algorithm selected the category with the highest score to generate the final result. It should be noted that scPred is better suited for processing relatively smaller datasets, as larger ones could require a considerable amount of time.</p>
          </list-item>
          <list-item>
            <p>scLearn sourced from Github (<ext-link xlink:href="https://github.com/bm2-lab/scLearn" ext-link-type="uri">https://github.com/bm2-lab/scLearn</ext-link>) was also executed under the default parameter configuration.</p>
          </list-item>
        </list>
      </sec>
    </app>
    <app id="app4">
      <title>D. Appendix results</title>
      <table-wrap position="anchor" id="TB2">
        <label>Appendix Table 2</label>
        <caption>
          <p>Averaged experimental results among different datasets of scNovel and baseline methods. The <inline-formula><tex-math notation="LaTeX" id="ImEquation87e">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\color{red}{\mathrm{{red\ bold}}}$\end{document}</tex-math></inline-formula> and <inline-formula><tex-math notation="LaTeX" id="ImEquation87g">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\color{blue}{\mathrm{{blue\ bold}}}$\end{document}</tex-math></inline-formula> are the best result and second-best result, respectively, in corresponding evaluation metrics and <inline-formula><tex-math notation="LaTeX" id="ImEquation22">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$C^{novel}$\end{document}</tex-math></inline-formula></p>
        </caption>
        <table frame="hsides" rules="groups">
          <colgroup span="1">
            <col span="1" align="left"/>
            <col span="1" align="left"/>
            <col span="1" align="left"/>
            <col span="1" align="left"/>
            <col span="1" align="left"/>
            <col span="1" align="left"/>
          </colgroup>
          <thead>
            <tr>
              <th align="left" rowspan="1" colspan="1">Evaluation</th>
              <th align="left" rowspan="1" colspan="1">Methods</th>
              <th colspan="4" align="left" rowspan="1">
                <inline-formula>
                  <tex-math notation="LaTeX" id="ImEquation23">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$C^{novel}$\end{document}</tex-math>
                </inline-formula>
              </th>
            </tr>
            <tr>
              <th rowspan="1" colspan="1"/>
              <th rowspan="1" colspan="1"/>
              <th align="left" rowspan="1" colspan="1">1</th>
              <th align="left" rowspan="1" colspan="1">2</th>
              <th align="left" rowspan="1" colspan="1">3</th>
              <th align="left" rowspan="1" colspan="1">4</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td rowspan="1" colspan="1">FPR95(%)<inline-formula><tex-math notation="LaTeX" id="ImEquation24">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\downarrow $\end{document}</tex-math></inline-formula></td>
              <td rowspan="1" colspan="1">scmap-cluster [<xref rid="ref25" ref-type="bibr">25</xref>]</td>
              <td rowspan="1" colspan="1">55.85</td>
              <td rowspan="1" colspan="1">54.56</td>
              <td rowspan="1" colspan="1">42.17</td>
              <td rowspan="1" colspan="1">
                <inline-formula>
                  <tex-math notation="LaTeX" id="ImEquation25">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\color{blue}{\boldsymbol{{47.62}}}$\end{document}</tex-math>
                </inline-formula>
              </td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1">scmap-cell [<xref rid="ref25" ref-type="bibr">25</xref>]</td>
              <td rowspan="1" colspan="1">68.74</td>
              <td rowspan="1" colspan="1">70.23</td>
              <td rowspan="1" colspan="1">79.44</td>
              <td rowspan="1" colspan="1">73.84</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1">scPred [<xref rid="ref26" ref-type="bibr">26</xref>]</td>
              <td rowspan="1" colspan="1">60.43</td>
              <td rowspan="1" colspan="1">65.09</td>
              <td rowspan="1" colspan="1">73.86</td>
              <td rowspan="1" colspan="1">66.96</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1">scLearn [<xref rid="ref27" ref-type="bibr">27</xref>]</td>
              <td rowspan="1" colspan="1">
                <inline-formula>
                  <tex-math notation="LaTeX" id="ImEquation26">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\color{blue}{\boldsymbol{{40.74}}}$\end{document}</tex-math>
                </inline-formula>
              </td>
              <td rowspan="1" colspan="1">
                <inline-formula>
                  <tex-math notation="LaTeX" id="ImEquation27">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\color{blue}{\boldsymbol{{47.62}}}$\end{document}</tex-math>
                </inline-formula>
              </td>
              <td rowspan="1" colspan="1">
                <inline-formula>
                  <tex-math notation="LaTeX" id="ImEquation28">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\color{blue}{\boldsymbol{{39.29}}}$\end{document}</tex-math>
                </inline-formula>
              </td>
              <td rowspan="1" colspan="1">54.52</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1">scNovel</td>
              <td rowspan="1" colspan="1">
                <inline-formula>
                  <tex-math notation="LaTeX" id="ImEquation29">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\color{red}{\boldsymbol{{22.82}}}$\end{document}</tex-math>
                </inline-formula>
              </td>
              <td rowspan="1" colspan="1">
                <inline-formula>
                  <tex-math notation="LaTeX" id="ImEquation30">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\color{red}{\boldsymbol{{21.31}}}$\end{document}</tex-math>
                </inline-formula>
              </td>
              <td rowspan="1" colspan="1">
                <inline-formula>
                  <tex-math notation="LaTeX" id="ImEquation31">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\color{red}{\boldsymbol{{28.74}}}$\end{document}</tex-math>
                </inline-formula>
              </td>
              <td rowspan="1" colspan="1">
                <inline-formula>
                  <tex-math notation="LaTeX" id="ImEquation32">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\color{red}{\boldsymbol{{25.95}}}$\end{document}</tex-math>
                </inline-formula>
              </td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">
                <bold>AUROC(<inline-formula><tex-math notation="LaTeX" id="ImEquation33">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\%$\end{document}</tex-math></inline-formula>)<inline-formula><tex-math notation="LaTeX" id="ImEquation34">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\uparrow $\end{document}</tex-math></inline-formula></bold>
              </td>
              <td rowspan="1" colspan="1">scmap-cluster [<xref rid="ref25" ref-type="bibr">25</xref>]</td>
              <td rowspan="1" colspan="1">80.78</td>
              <td rowspan="1" colspan="1">78.38</td>
              <td rowspan="1" colspan="1">83.56</td>
              <td rowspan="1" colspan="1">
                <inline-formula>
                  <tex-math notation="LaTeX" id="ImEquation35">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\color{blue}{\boldsymbol{{80.68}}}$\end{document}</tex-math>
                </inline-formula>
              </td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1">scmap-cell [<xref rid="ref25" ref-type="bibr">25</xref>]</td>
              <td rowspan="1" colspan="1">84.01</td>
              <td rowspan="1" colspan="1">77.60</td>
              <td rowspan="1" colspan="1">81.65</td>
              <td rowspan="1" colspan="1">80.63</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1">scPred [<xref rid="ref26" ref-type="bibr">26</xref>]</td>
              <td rowspan="1" colspan="1">78.45</td>
              <td rowspan="1" colspan="1">73.48</td>
              <td rowspan="1" colspan="1">76.63</td>
              <td rowspan="1" colspan="1">70.49</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1">scLearn [<xref rid="ref27" ref-type="bibr">27</xref>]</td>
              <td rowspan="1" colspan="1">
                <inline-formula>
                  <tex-math notation="LaTeX" id="ImEquation36">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\color{blue}{\boldsymbol{{84.30}}}$\end{document}</tex-math>
                </inline-formula>
              </td>
              <td rowspan="1" colspan="1">
                <inline-formula>
                  <tex-math notation="LaTeX" id="ImEquation37">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\color{blue}{\boldsymbol{{83.07}}}$\end{document}</tex-math>
                </inline-formula>
              </td>
              <td rowspan="1" colspan="1">
                <inline-formula>
                  <tex-math notation="LaTeX" id="ImEquation38">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\color{blue}{\boldsymbol{{87.45}}}$\end{document}</tex-math>
                </inline-formula>
              </td>
              <td rowspan="1" colspan="1">77.61</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1">scNovel</td>
              <td rowspan="1" colspan="1">
                <inline-formula>
                  <tex-math notation="LaTeX" id="ImEquation39">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\color{red}{\boldsymbol{{96.33}}}$\end{document}</tex-math>
                </inline-formula>
              </td>
              <td rowspan="1" colspan="1">
                <inline-formula>
                  <tex-math notation="LaTeX" id="ImEquation40">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\color{red}{\boldsymbol{{94.29}}}$\end{document}</tex-math>
                </inline-formula>
              </td>
              <td rowspan="1" colspan="1">
                <inline-formula>
                  <tex-math notation="LaTeX" id="ImEquation41">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\color{red}{\boldsymbol{{94.64}}}$\end{document}</tex-math>
                </inline-formula>
              </td>
              <td rowspan="1" colspan="1">
                <inline-formula>
                  <tex-math notation="LaTeX" id="ImEquation42">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\color{red}{\boldsymbol{{94.16}}}$\end{document}</tex-math>
                </inline-formula>
              </td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">AUPR(%)<inline-formula><tex-math notation="LaTeX" id="ImEquation43">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\uparrow $\end{document}</tex-math></inline-formula></td>
              <td rowspan="1" colspan="1">scmap-cluster [<xref rid="ref25" ref-type="bibr">25</xref>]</td>
              <td rowspan="1" colspan="1">
                <inline-formula>
                  <tex-math notation="LaTeX" id="ImEquation44">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\color{blue}{\boldsymbol{{99.42}}}$\end{document}</tex-math>
                </inline-formula>
              </td>
              <td rowspan="1" colspan="1">
                <inline-formula>
                  <tex-math notation="LaTeX" id="ImEquation45">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\color{blue}{\boldsymbol{{98.59}}}$\end{document}</tex-math>
                </inline-formula>
              </td>
              <td rowspan="1" colspan="1">97.62</td>
              <td rowspan="1" colspan="1">
                <inline-formula>
                  <tex-math notation="LaTeX" id="ImEquation46">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\color{blue}{\boldsymbol{{93.16}}}$\end{document}</tex-math>
                </inline-formula>
              </td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1">scmap-cell [<xref rid="ref25" ref-type="bibr">25</xref>]</td>
              <td rowspan="1" colspan="1">99.30</td>
              <td rowspan="1" colspan="1">97.23</td>
              <td rowspan="1" colspan="1">95.44</td>
              <td rowspan="1" colspan="1">91.27</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1">scPred [<xref rid="ref26" ref-type="bibr">26</xref>]</td>
              <td rowspan="1" colspan="1">99.24</td>
              <td rowspan="1" colspan="1">97.85</td>
              <td rowspan="1" colspan="1">94.08</td>
              <td rowspan="1" colspan="1">86.00</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1">scLearn [<xref rid="ref27" ref-type="bibr">27</xref>]</td>
              <td rowspan="1" colspan="1">98.15</td>
              <td rowspan="1" colspan="1">97.70</td>
              <td rowspan="1" colspan="1">
                <inline-formula>
                  <tex-math notation="LaTeX" id="ImEquation47">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\color{blue}{\boldsymbol{{97.71}}}$\end{document}</tex-math>
                </inline-formula>
              </td>
              <td rowspan="1" colspan="1">91.60</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1">scNovel</td>
              <td rowspan="1" colspan="1">
                <inline-formula>
                  <tex-math notation="LaTeX" id="ImEquation48">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\color{red}{\boldsymbol{{99.78}}}$\end{document}</tex-math>
                </inline-formula>
              </td>
              <td rowspan="1" colspan="1">
                <inline-formula>
                  <tex-math notation="LaTeX" id="ImEquation49">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\color{red}{\boldsymbol{{99.41}}}$\end{document}</tex-math>
                </inline-formula>
              </td>
              <td rowspan="1" colspan="1">
                <inline-formula>
                  <tex-math notation="LaTeX" id="ImEquation50">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\color{red}{\boldsymbol{{98.70}}}$\end{document}</tex-math>
                </inline-formula>
              </td>
              <td rowspan="1" colspan="1">
                <inline-formula>
                  <tex-math notation="LaTeX" id="ImEquation51">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\color{red}{\boldsymbol{{97.72}}}$\end{document}</tex-math>
                </inline-formula>
              </td>
            </tr>
          </tbody>
        </table>
      </table-wrap>
      <table-wrap position="anchor" id="TB3">
        <label>Appendix Table 3</label>
        <caption>
          <p>Experimental results with different score functions. The <inline-formula><tex-math notation="LaTeX" id="ImEquation87c">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\color{red}{\mathrm{{red\ bold}}}$\end{document}</tex-math></inline-formula> and <inline-formula><tex-math notation="LaTeX" id="ImEquation87d">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\color{blue}{\mathrm{{blue\ bold}}}$\end{document}</tex-math></inline-formula> are the best and second-best results, respectively, in corresponding evaluation metrics and <inline-formula><tex-math notation="LaTeX" id="ImEquation234">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$C^{novel}$\end{document}</tex-math></inline-formula></p>
        </caption>
        <table frame="hsides" rules="groups">
          <colgroup span="1">
            <col span="1" align="left"/>
            <col span="1" align="left"/>
            <col span="1" align="left"/>
            <col span="1" align="left"/>
            <col span="1" align="left"/>
            <col span="1" align="left"/>
          </colgroup>
          <thead>
            <tr>
              <th align="left" rowspan="1" colspan="1">Evaluation</th>
              <th align="left" rowspan="1" colspan="1">Methods</th>
              <th colspan="4" align="left" rowspan="1">
                <inline-formula>
                  <tex-math notation="LaTeX" id="ImEquation235">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$C^{novel}$\end{document}</tex-math>
                </inline-formula>
              </th>
            </tr>
            <tr>
              <th rowspan="1" colspan="1"/>
              <th rowspan="1" colspan="1"/>
              <th align="left" rowspan="1" colspan="1">1</th>
              <th align="left" rowspan="1" colspan="1">2</th>
              <th align="left" rowspan="1" colspan="1">3</th>
              <th align="left" rowspan="1" colspan="1">4</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td rowspan="1" colspan="1">FPR95(%)<inline-formula><tex-math notation="LaTeX" id="ImEquation236">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\downarrow $\end{document}</tex-math></inline-formula></td>
              <td rowspan="1" colspan="1">
                <inline-formula>
                  <tex-math notation="LaTeX" id="ImEquation237">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$S^{MSP}$\end{document}</tex-math>
                </inline-formula>
              </td>
              <td rowspan="1" colspan="1">32.19</td>
              <td rowspan="1" colspan="1">29.21</td>
              <td rowspan="1" colspan="1">34.92</td>
              <td rowspan="1" colspan="1">32.71</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1">
                <inline-formula>
                  <tex-math notation="LaTeX" id="ImEquation238">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$S^{ODIN}$\end{document}</tex-math>
                </inline-formula>
              </td>
              <td rowspan="1" colspan="1">24.03</td>
              <td rowspan="1" colspan="1">22.05</td>
              <td rowspan="1" colspan="1">29.32</td>
              <td rowspan="1" colspan="1">26.39</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1">
                <inline-formula>
                  <tex-math notation="LaTeX" id="ImEquation239">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$S^{SEQ}$\end{document}</tex-math>
                </inline-formula>
              </td>
              <td rowspan="1" colspan="1">
                <inline-formula>
                  <tex-math notation="LaTeX" id="ImEquation240">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\color{blue}{\boldsymbol{{22.94}}}$\end{document}</tex-math>
                </inline-formula>
              </td>
              <td rowspan="1" colspan="1">
                <inline-formula>
                  <tex-math notation="LaTeX" id="ImEquation241">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\color{red}{\boldsymbol{{20.99}}}$\end{document}</tex-math>
                </inline-formula>
              </td>
              <td rowspan="1" colspan="1">
                <inline-formula>
                  <tex-math notation="LaTeX" id="ImEquation242">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\color{blue}{\boldsymbol{{28.96}}}$\end{document}</tex-math>
                </inline-formula>
              </td>
              <td rowspan="1" colspan="1">
                <inline-formula>
                  <tex-math notation="LaTeX" id="ImEquation243">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\color{red}{\boldsymbol{{25.64}}}$\end{document}</tex-math>
                </inline-formula>
              </td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1">
                <inline-formula>
                  <tex-math notation="LaTeX" id="ImEquation244">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$S^{SIM}$\end{document}</tex-math>
                </inline-formula>
              </td>
              <td rowspan="1" colspan="1">
                <inline-formula>
                  <tex-math notation="LaTeX" id="ImEquation245">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\color{red}{\boldsymbol{{22.82}}}$\end{document}</tex-math>
                </inline-formula>
              </td>
              <td rowspan="1" colspan="1">
                <inline-formula>
                  <tex-math notation="LaTeX" id="ImEquation246">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\color{blue}{\boldsymbol{{21.31}}}$\end{document}</tex-math>
                </inline-formula>
              </td>
              <td rowspan="1" colspan="1">
                <inline-formula>
                  <tex-math notation="LaTeX" id="ImEquation247">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\color{red}{\boldsymbol{{28.74}}}$\end{document}</tex-math>
                </inline-formula>
              </td>
              <td rowspan="1" colspan="1">
                <inline-formula>
                  <tex-math notation="LaTeX" id="ImEquation248">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\color{blue}{\boldsymbol{{25.95}}}$\end{document}</tex-math>
                </inline-formula>
              </td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">
                <bold>AUROC(%)<inline-formula><tex-math notation="LaTeX" id="ImEquation249">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\uparrow $\end{document}</tex-math></inline-formula></bold>
              </td>
              <td rowspan="1" colspan="1">
                <inline-formula>
                  <tex-math notation="LaTeX" id="ImEquation250">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$S^{MSP}$\end{document}</tex-math>
                </inline-formula>
              </td>
              <td rowspan="1" colspan="1">94.53</td>
              <td rowspan="1" colspan="1">93.55</td>
              <td rowspan="1" colspan="1">93.73</td>
              <td rowspan="1" colspan="1">92.98</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1">
                <inline-formula>
                  <tex-math notation="LaTeX" id="ImEquation251">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$S^{ODIN}$\end{document}</tex-math>
                </inline-formula>
              </td>
              <td rowspan="1" colspan="1">96.06</td>
              <td rowspan="1" colspan="1">94.11</td>
              <td rowspan="1" colspan="1">94.55</td>
              <td rowspan="1" colspan="1">
                <inline-formula>
                  <tex-math notation="LaTeX" id="ImEquation252">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\color{blue}{\boldsymbol{{93.94}}}$\end{document}</tex-math>
                </inline-formula>
              </td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1">
                <inline-formula>
                  <tex-math notation="LaTeX" id="ImEquation253">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$S^{SEQ}$\end{document}</tex-math>
                </inline-formula>
              </td>
              <td rowspan="1" colspan="1">
                <inline-formula>
                  <tex-math notation="LaTeX" id="ImEquation254">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\color{blue}{\boldsymbol{{96.32}}}$\end{document}</tex-math>
                </inline-formula>
              </td>
              <td rowspan="1" colspan="1">
                <inline-formula>
                  <tex-math notation="LaTeX" id="ImEquation255">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\color{blue}{\boldsymbol{{94.26}}}$\end{document}</tex-math>
                </inline-formula>
              </td>
              <td rowspan="1" colspan="1">
                <inline-formula>
                  <tex-math notation="LaTeX" id="ImEquation256">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\color{blue}{\boldsymbol{{94.60}}}$\end{document}</tex-math>
                </inline-formula>
              </td>
              <td rowspan="1" colspan="1">
                <inline-formula>
                  <tex-math notation="LaTeX" id="ImEquation257">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\color{red}{\boldsymbol{{94.16}}}$\end{document}</tex-math>
                </inline-formula>
              </td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1">
                <inline-formula>
                  <tex-math notation="LaTeX" id="ImEquation258">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$S^{SIM}$\end{document}</tex-math>
                </inline-formula>
              </td>
              <td rowspan="1" colspan="1">
                <inline-formula>
                  <tex-math notation="LaTeX" id="ImEquation259">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\color{red}{\boldsymbol{{96.33}}}$\end{document}</tex-math>
                </inline-formula>
              </td>
              <td rowspan="1" colspan="1">
                <inline-formula>
                  <tex-math notation="LaTeX" id="ImEquation260">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\color{red}{\boldsymbol{{94.29}}}$\end{document}</tex-math>
                </inline-formula>
              </td>
              <td rowspan="1" colspan="1">
                <inline-formula>
                  <tex-math notation="LaTeX" id="ImEquation261">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\color{red}{\boldsymbol{{94.64}}}$\end{document}</tex-math>
                </inline-formula>
              </td>
              <td rowspan="1" colspan="1">
                <inline-formula>
                  <tex-math notation="LaTeX" id="ImEquation262">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\color{red}{\boldsymbol{{94.16}}}$\end{document}</tex-math>
                </inline-formula>
              </td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">AUPR(%)<inline-formula><tex-math notation="LaTeX" id="ImEquation263">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\uparrow $\end{document}</tex-math></inline-formula></td>
              <td rowspan="1" colspan="1">
                <inline-formula>
                  <tex-math notation="LaTeX" id="ImEquation264">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$S^{MSP}$\end{document}</tex-math>
                </inline-formula>
              </td>
              <td rowspan="1" colspan="1">99.65</td>
              <td rowspan="1" colspan="1">
                <inline-formula>
                  <tex-math notation="LaTeX" id="ImEquation265">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\color{red}{\boldsymbol{{99.41}}}$\end{document}</tex-math>
                </inline-formula>
              </td>
              <td rowspan="1" colspan="1">98.56</td>
              <td rowspan="1" colspan="1">97.14</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1">
                <inline-formula>
                  <tex-math notation="LaTeX" id="ImEquation266">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$S^{ODIN}$\end{document}</tex-math>
                </inline-formula>
              </td>
              <td rowspan="1" colspan="1">
                <inline-formula>
                  <tex-math notation="LaTeX" id="ImEquation267">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\color{blue}{\boldsymbol{{99.75}}}$\end{document}</tex-math>
                </inline-formula>
              </td>
              <td rowspan="1" colspan="1">
                <inline-formula>
                  <tex-math notation="LaTeX" id="ImEquation268">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\color{red}{\boldsymbol{{99.41}}}$\end{document}</tex-math>
                </inline-formula>
              </td>
              <td rowspan="1" colspan="1">98.66</td>
              <td rowspan="1" colspan="1">97.48</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1">
                <inline-formula>
                  <tex-math notation="LaTeX" id="ImEquation269">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$S^{SEQ}$\end{document}</tex-math>
                </inline-formula>
              </td>
              <td rowspan="1" colspan="1">
                <inline-formula>
                  <tex-math notation="LaTeX" id="ImEquation270">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\color{red}{\boldsymbol{{99.78}}}$\end{document}</tex-math>
                </inline-formula>
              </td>
              <td rowspan="1" colspan="1">
                <inline-formula>
                  <tex-math notation="LaTeX" id="ImEquation271">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\color{red}{\boldsymbol{{99.41}}}$\end{document}</tex-math>
                </inline-formula>
              </td>
              <td rowspan="1" colspan="1">
                <inline-formula>
                  <tex-math notation="LaTeX" id="ImEquation272">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\color{blue}{\boldsymbol{{98.69}}}$\end{document}</tex-math>
                </inline-formula>
              </td>
              <td rowspan="1" colspan="1">
                <inline-formula>
                  <tex-math notation="LaTeX" id="ImEquation273">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\color{blue}{\boldsymbol{{97.71}}}$\end{document}</tex-math>
                </inline-formula>
              </td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1">
                <inline-formula>
                  <tex-math notation="LaTeX" id="ImEquation274">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$S^{SIM}$\end{document}</tex-math>
                </inline-formula>
              </td>
              <td rowspan="1" colspan="1">
                <inline-formula>
                  <tex-math notation="LaTeX" id="ImEquation275">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\color{red}{\boldsymbol{{99.78}}}$\end{document}</tex-math>
                </inline-formula>
              </td>
              <td rowspan="1" colspan="1">
                <inline-formula>
                  <tex-math notation="LaTeX" id="ImEquation276">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\color{red}{\boldsymbol{{99.41}}}$\end{document}</tex-math>
                </inline-formula>
              </td>
              <td rowspan="1" colspan="1">
                <inline-formula>
                  <tex-math notation="LaTeX" id="ImEquation277">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\color{red}{\boldsymbol{{98.70}}}$\end{document}</tex-math>
                </inline-formula>
              </td>
              <td rowspan="1" colspan="1">
                <inline-formula>
                  <tex-math notation="LaTeX" id="ImEquation278">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\color{red}{\boldsymbol{{97.72}}}$\end{document}</tex-math>
                </inline-formula>
              </td>
            </tr>
          </tbody>
        </table>
      </table-wrap>
      <table-wrap position="anchor" id="TB4">
        <label>Appendix Table 4</label>
        <caption>
          <p>Experimental results with different neural network architecture, including removing BN (scNovel w/o BN) and removing ELU activation function (scNovel w/o BN). The <inline-formula><tex-math notation="LaTeX" id="ImEquation87a">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\color{red}{\mathrm{{red\ bold}}}$\end{document}</tex-math></inline-formula> and <inline-formula><tex-math notation="LaTeX" id="ImEquation87b">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\color{blue}{\mathrm{{blue\ bold}}}$\end{document}</tex-math></inline-formula> are the best and second-best results, respectively, in corresponding evaluation metrics and <inline-formula><tex-math notation="LaTeX" id="ImEquation80">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$C^{novel}$\end{document}</tex-math></inline-formula>. The experiment results suggest that both BN and ELU are useful to boost performance</p>
        </caption>
        <table frame="hsides" rules="groups">
          <colgroup span="1">
            <col span="1" align="left"/>
            <col span="1" align="left"/>
            <col span="1" align="left"/>
            <col span="1" align="left"/>
            <col span="1" align="left"/>
            <col span="1" align="left"/>
          </colgroup>
          <thead>
            <tr>
              <th align="left" rowspan="1" colspan="1">Evaluation</th>
              <th align="left" rowspan="1" colspan="1">Methods</th>
              <th colspan="4" align="left" rowspan="1">
                <inline-formula>
                  <tex-math notation="LaTeX" id="ImEquation81">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$C^{novel}$\end{document}</tex-math>
                </inline-formula>
              </th>
            </tr>
            <tr>
              <th rowspan="1" colspan="1"/>
              <th rowspan="1" colspan="1"/>
              <th align="left" rowspan="1" colspan="1">1</th>
              <th align="left" rowspan="1" colspan="1">2</th>
              <th align="left" rowspan="1" colspan="1">3</th>
              <th align="left" rowspan="1" colspan="1">4</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td rowspan="1" colspan="1">FPR95(%)<inline-formula><tex-math notation="LaTeX" id="ImEquation82">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\downarrow $\end{document}</tex-math></inline-formula></td>
              <td rowspan="1" colspan="1">scNovel w/o BN</td>
              <td rowspan="1" colspan="1">
                <inline-formula>
                  <tex-math notation="LaTeX" id="ImEquation83">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\color{blue}{\boldsymbol{{24.28}}}$\end{document}</tex-math>
                </inline-formula>
              </td>
              <td rowspan="1" colspan="1">26.63</td>
              <td rowspan="1" colspan="1">
                <inline-formula>
                  <tex-math notation="LaTeX" id="ImEquation84">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\color{red}{\boldsymbol{{23.32}}}$\end{document}</tex-math>
                </inline-formula>
              </td>
              <td rowspan="1" colspan="1">
                <inline-formula>
                  <tex-math notation="LaTeX" id="ImEquation85">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\color{blue}{\boldsymbol{{30.17}}}$\end{document}</tex-math>
                </inline-formula>
              </td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1">scNovel w/o ELU</td>
              <td rowspan="1" colspan="1">26.44</td>
              <td rowspan="1" colspan="1">
                <inline-formula>
                  <tex-math notation="LaTeX" id="ImEquation86">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\color{blue}{\boldsymbol{{22.88}}}$\end{document}</tex-math>
                </inline-formula>
              </td>
              <td rowspan="1" colspan="1">31.13</td>
              <td rowspan="1" colspan="1">31.63</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1">scNovel</td>
              <td rowspan="1" colspan="1">
                <inline-formula>
                  <tex-math notation="LaTeX" id="ImEquation87">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\color{red}{\boldsymbol{{22.82}}}$\end{document}</tex-math>
                </inline-formula>
              </td>
              <td rowspan="1" colspan="1">
                <inline-formula>
                  <tex-math notation="LaTeX" id="ImEquation88">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\color{red}{\boldsymbol{{21.31}}}$\end{document}</tex-math>
                </inline-formula>
              </td>
              <td rowspan="1" colspan="1">
                <inline-formula>
                  <tex-math notation="LaTeX" id="ImEquation89">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\color{blue}{\boldsymbol{{28.74}}}$\end{document}</tex-math>
                </inline-formula>
              </td>
              <td rowspan="1" colspan="1">
                <inline-formula>
                  <tex-math notation="LaTeX" id="ImEquation90">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\color{red}{\boldsymbol{{25.95}}}$\end{document}</tex-math>
                </inline-formula>
              </td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">
                <bold>AUROC(%)<inline-formula><tex-math notation="LaTeX" id="ImEquation91">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\uparrow $\end{document}</tex-math></inline-formula></bold>
              </td>
              <td rowspan="1" colspan="1">scNovel w/o BN</td>
              <td rowspan="1" colspan="1">94.85</td>
              <td rowspan="1" colspan="1">89.15</td>
              <td rowspan="1" colspan="1">93.42</td>
              <td rowspan="1" colspan="1">91.58</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1">scNovel w/o ELU</td>
              <td rowspan="1" colspan="1">
                <inline-formula>
                  <tex-math notation="LaTeX" id="ImEquation92">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\color{blue}{\boldsymbol{{96.03}}}$\end{document}</tex-math>
                </inline-formula>
              </td>
              <td rowspan="1" colspan="1">
                <inline-formula>
                  <tex-math notation="LaTeX" id="ImEquation93">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\color{blue}{\boldsymbol{{93.47}}}$\end{document}</tex-math>
                </inline-formula>
              </td>
              <td rowspan="1" colspan="1">
                <inline-formula>
                  <tex-math notation="LaTeX" id="ImEquation94">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\color{blue}{\boldsymbol{{94.24}}}$\end{document}</tex-math>
                </inline-formula>
              </td>
              <td rowspan="1" colspan="1">
                <inline-formula>
                  <tex-math notation="LaTeX" id="ImEquation95">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\color{blue}{\boldsymbol{{93.01}}}$\end{document}</tex-math>
                </inline-formula>
              </td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1">scNovel</td>
              <td rowspan="1" colspan="1">
                <inline-formula>
                  <tex-math notation="LaTeX" id="ImEquation96">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\color{red}{\boldsymbol{{96.33}}}$\end{document}</tex-math>
                </inline-formula>
              </td>
              <td rowspan="1" colspan="1">
                <inline-formula>
                  <tex-math notation="LaTeX" id="ImEquation97">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\color{red}{\boldsymbol{{94.29}}}$\end{document}</tex-math>
                </inline-formula>
              </td>
              <td rowspan="1" colspan="1">
                <inline-formula>
                  <tex-math notation="LaTeX" id="ImEquation98">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\color{red}{\boldsymbol{{94.64}}}$\end{document}</tex-math>
                </inline-formula>
              </td>
              <td rowspan="1" colspan="1">
                <inline-formula>
                  <tex-math notation="LaTeX" id="ImEquation99">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\color{red}{\boldsymbol{{94.16}}}$\end{document}</tex-math>
                </inline-formula>
              </td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">AUPR(%)<inline-formula><tex-math notation="LaTeX" id="ImEquation100">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\uparrow $\end{document}</tex-math></inline-formula></td>
              <td rowspan="1" colspan="1">scNovel w/o BN</td>
              <td rowspan="1" colspan="1">99.74</td>
              <td rowspan="1" colspan="1">99.09</td>
              <td rowspan="1" colspan="1">98.46</td>
              <td rowspan="1" colspan="1">95.88</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1">scNovel w/o ELU</td>
              <td rowspan="1" colspan="1">
                <inline-formula>
                  <tex-math notation="LaTeX" id="ImEquation101">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\color{blue}{\boldsymbol{{99.77}}}$\end{document}</tex-math>
                </inline-formula>
              </td>
              <td rowspan="1" colspan="1">
                <inline-formula>
                  <tex-math notation="LaTeX" id="ImEquation102">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\color{blue}{\boldsymbol{{99.35}}}$\end{document}</tex-math>
                </inline-formula>
              </td>
              <td rowspan="1" colspan="1">
                <inline-formula>
                  <tex-math notation="LaTeX" id="ImEquation103">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\color{blue}{\boldsymbol{{98.56}}}$\end{document}</tex-math>
                </inline-formula>
              </td>
              <td rowspan="1" colspan="1">
                <inline-formula>
                  <tex-math notation="LaTeX" id="ImEquation104">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\color{blue}{\boldsymbol{{97.03}}}$\end{document}</tex-math>
                </inline-formula>
              </td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1">scNovel</td>
              <td rowspan="1" colspan="1">
                <inline-formula>
                  <tex-math notation="LaTeX" id="ImEquation105">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\color{red}{\boldsymbol{{99.78}}}$\end{document}</tex-math>
                </inline-formula>
              </td>
              <td rowspan="1" colspan="1">
                <inline-formula>
                  <tex-math notation="LaTeX" id="ImEquation106">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\color{red}{\boldsymbol{{99.41}}}$\end{document}</tex-math>
                </inline-formula>
              </td>
              <td rowspan="1" colspan="1">
                <inline-formula>
                  <tex-math notation="LaTeX" id="ImEquation107">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\color{red}{\boldsymbol{{98.70}}}$\end{document}</tex-math>
                </inline-formula>
              </td>
              <td rowspan="1" colspan="1">
                <inline-formula>
                  <tex-math notation="LaTeX" id="ImEquation108">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\color{red}{\boldsymbol{{97.72}}}$\end{document}</tex-math>
                </inline-formula>
              </td>
            </tr>
          </tbody>
        </table>
      </table-wrap>
    </app>
    <app>
      <title>E. Discussion of scNovel and scBalance</title>
      <p>The recent work named scBalance [<xref rid="ref16" ref-type="bibr">16</xref>] focuses on identifying rare cell types in large datasets, while we focus on novel rare cell detection. We explain it in detail below. The scBalance specializes in classifying rare cells into known categories within single-cell sequencing datasets, unable to identify previously unknown cell types. In contrast, scNovel is aimed at detecting novel rare cell types by determining if a cell type has been observed before, thus capable of identifying new cell types beyond mere classification. The main limitation of scBalance is its inability to classify cells outside its trained categories, leading to potential misclassification. scNovel addresses this by detecting cells that don’t fit into known categories, improving accuracy in identifying novel cell types. However, scNovel could be enhanced with a more robust architecture and refined scoring function to better distinguish between typical and novel cell distributions, indicating areas for future improvement in both models. We employ the same network architecture like scBalance and loss function, while we propose new score functions (<inline-formula><tex-math notation="LaTeX" id="ImEquation230">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$S^{ODIN}$\end{document}</tex-math></inline-formula>, <inline-formula><tex-math notation="LaTeX" id="ImEquation231">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$S^{SEQ}$\end{document}</tex-math></inline-formula> and <inline-formula><tex-math notation="LaTeX" id="ImEquation232">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$S^{SIM}$\end{document}</tex-math></inline-formula>) to further improve performance. Therefore, if we directly apply scBalance for novel rare cell detection, the performance will be degraded to the performance of SMSP. Therefore, the experiment comparison between scNovel and scBalance is shown in <xref rid="TB3" ref-type="table">Appendix Table 3</xref>, while <inline-formula><tex-math notation="LaTeX" id="ImEquation233">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$S^{MSP}$\end{document}</tex-math></inline-formula> is the performance of scBalance.</p>
    </app>
  </app-group>
</back>
<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.2 20190208//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.2?>
<?ConverterInfo.XSLTName jats2jats3.xsl?>
<?ConverterInfo.Version 1?>
<?properties open_access?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Brief Bioinform</journal-id>
    <journal-id journal-id-type="iso-abbrev">Brief Bioinform</journal-id>
    <journal-id journal-id-type="publisher-id">bib</journal-id>
    <journal-title-group>
      <journal-title>Briefings in Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1467-5463</issn>
    <issn pub-type="epub">1477-4054</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">10981759</article-id>
    <article-id pub-id-type="pmid">38555470</article-id>
    <article-id pub-id-type="doi">10.1093/bib/bbae112</article-id>
    <article-id pub-id-type="publisher-id">bbae112</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Problem Solving Protocol</subject>
      </subj-group>
      <subj-group subj-group-type="category-taxonomy-collection">
        <subject>AcademicSubjects/SCI01060</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>scNovel: a scalable deep learning-based network for novel rare cell discovery in single-cell transcriptomics</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Zheng</surname>
          <given-names>Chuanyang</given-names>
        </name>
        <aff><institution>Department of Computer Science and Engineering</institution>, <addr-line>CUHK, Hong Kong SAR</addr-line>, <country country="CN">China</country></aff>
        <xref rid="afn1" ref-type="author-notes"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Wang</surname>
          <given-names>Yixuan</given-names>
        </name>
        <aff><institution>Department of Computer Science and Engineering</institution>, <addr-line>CUHK, Hong Kong SAR</addr-line>, <country country="CN">China</country></aff>
        <xref rid="afn1" ref-type="author-notes"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Cheng</surname>
          <given-names>Yuqi</given-names>
        </name>
        <aff><institution>College of Computing, Georgia Institute of Technology</institution>, <addr-line>Atlanta, GA</addr-line>, <country country="US">USA</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Wang</surname>
          <given-names>Xuesong</given-names>
        </name>
        <aff><institution>Department of Computer Science and Engineering</institution>, <addr-line>CUHK, Hong Kong SAR</addr-line>, <country country="CN">China</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Wei</surname>
          <given-names>Hongxin</given-names>
        </name>
        <aff>
          <institution>MLR Lab, Southern University of Science and Technology</institution>
        </aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>King</surname>
          <given-names>Irwin</given-names>
        </name>
        <aff><institution>Department of Computer Science and Engineering</institution>, <addr-line>CUHK, Hong Kong SAR</addr-line>, <country country="CN">China</country></aff>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <name>
          <surname>Li</surname>
          <given-names>Yu</given-names>
        </name>
        <!--liyu@cse.cuhk.edu.hk-->
        <aff><institution>Department of Computer Science and Engineering</institution>, <addr-line>CUHK, Hong Kong SAR</addr-line>, <country country="CN">China</country></aff>
        <aff><institution>The CUHK Shenzhen Research Institute</institution>, <addr-line>Hi-Tech Park, Nanshan, Shenzhen 518057</addr-line>, <country country="CN">China</country></aff>
        <aff><institution>Institute for Medical Enginering and Science, Massachusetts Institute of Technology</institution>, <addr-line>Cambridge, MA</addr-line>, <country country="US">USA</country></aff>
        <aff><institution>Wyss Institute for Biologically Inspired Engineering, Harvard University</institution>, <addr-line>Boston, MA</addr-line>, <country country="US">USA</country></aff>
        <aff><institution>Broad Institute of MIT and Harvard, Cambridge</institution>, <addr-line>MA</addr-line>, <country country="US">USA</country></aff>
        <xref rid="cor1" ref-type="corresp"/>
      </contrib>
    </contrib-group>
    <author-notes>
      <corresp id="cor1">Corresponding author. Yu Li, E-mail: <email>liyu@cse.cuhk.edu.hk</email></corresp>
      <fn id="afn1">
        <p>Chuanyang Zheng and Yixuan Wang contributed equally.</p>
      </fn>
    </author-notes>
    <pub-date pub-type="collection">
      <month>5</month>
      <year>2024</year>
    </pub-date>
    <pub-date pub-type="epub" iso-8601-date="2024-03-28">
      <day>28</day>
      <month>3</month>
      <year>2024</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>28</day>
      <month>3</month>
      <year>2024</year>
    </pub-date>
    <volume>25</volume>
    <issue>3</issue>
    <elocation-id>bbae112</elocation-id>
    <history>
      <date date-type="received">
        <day>13</day>
        <month>12</month>
        <year>2023</year>
      </date>
      <date date-type="rev-recd">
        <day>5</day>
        <month>2</month>
        <year>2024</year>
      </date>
      <date date-type="accepted">
        <day>20</day>
        <month>2</month>
        <year>2024</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2024. Published by Oxford University Press.</copyright-statement>
      <copyright-year>2024</copyright-year>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">https://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted reuse, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <self-uri xlink:href="bbae112.pdf"/>
    <abstract>
      <title>Abstract</title>
      <p>Single-cell RNA sequencing has achieved massive success in biological research fields. Discovering novel cell types from single-cell transcriptomics has been demonstrated to be essential in the field of biomedicine, yet is time-consuming and needs prior knowledge. With the unprecedented boom in cell atlases, auto-annotation tools have become more prevalent due to their speed, accuracy and user-friendly features. However, existing tools have mostly focused on general cell-type annotation and have not adequately addressed the challenge of discovering novel rare cell types. In this work, we introduce scNovel, a powerful deep learning-based neural network that specifically focuses on novel rare cell discovery. By testing our model on diverse datasets with different scales, protocols and degrees of imbalance, we demonstrate that scNovel significantly outperforms previous state-of-the-art novel cell detection models, reaching the most AUROC performance(the only one method whose averaged AUROC results are above 94%, up to 16.26% more comparing to the second-best method). We validate scNovel’s performance on a million-scale dataset to illustrate the scalability of scNovel further. Applying scNovel on a clinical COVID-19 dataset, three potential novel subtypes of Macrophages are identified, where the COVID-related differential genes are also detected to have consistent expression patterns through deeper analysis. We believe that our proposed pipeline will be an important tool for high-throughput clinical data in a wide range of applications.</p>
    </abstract>
    <kwd-group>
      <kwd>novel rare cell discovery</kwd>
      <kwd>single-cell analysis</kwd>
      <kwd>neural network</kwd>
    </kwd-group>
    <funding-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>Research Grants Council of the Hong Kong Special Administrative Region</institution>
          </institution-wrap>
        </funding-source>
        <award-id>CUHK 24204023</award-id>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>Innovation and Technology Commission of the Hong Kong Special Administrative Region</institution>
          </institution-wrap>
        </funding-source>
        <award-id>GHP/065/21SZ</award-id>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>Chinese University of Hong Kong</institution>
            <institution-id institution-id-type="DOI">10.13039/501100004853</institution-id>
          </institution-wrap>
        </funding-source>
        <award-id>4937025</award-id>
        <award-id>4937026</award-id>
        <award-id>5501517</award-id>
        <award-id>5501329</award-id>
      </award-group>
    </funding-group>
    <counts>
      <page-count count="15"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec id="sec1">
    <title>INTRODUCTION</title>
    <p>Single-cell RNA sequencing (scRNA-seq), established by Tang et al. in 2009 [<xref rid="ref1" ref-type="bibr">1</xref>], rapidly becomes popular and important in various biological research field analyses. As a powerful method to profile cell-specific level transcriptome, scRNA-seq makes it possible to analyze individual cells and provide insight into cell heterogeneity and has been widely used in organismal atlases generation [<xref rid="ref2" ref-type="bibr">2–6</xref>], COVID analysis [<xref rid="ref7" ref-type="bibr">7–9</xref>], cancer research [<xref rid="ref10" ref-type="bibr">10</xref>, <xref rid="ref11" ref-type="bibr">11</xref>], developmental biology research [<xref rid="ref12" ref-type="bibr">12</xref>], and so on.</p>
    <p>Cell type-specific analysis is a crucial topic in single-cell research and is traditionally carried out by grouping the cell points and then labeling them with marker genes [<xref rid="ref13" ref-type="bibr">13–15</xref>]. Auto-annotation tools are taking over as a result of the unheard-of surge in the production of cell atlases and their advantages in terms of speed, accuracy, and user-friendliness [<xref rid="ref16" ref-type="bibr">16</xref>]. In real-world single-cell analysis scenarios, the query dataset may contain novel cell types unseen in the reference set, and the distributions of the reference set and query set usually differ significantly. Hence, it is essential for a tool to not only precisely categorize cell types for query cells but also identify novel cell types that are not present in the reference dataset. Studies have shown the importance of discovering novel rare cells in the fields of biology and medicine. For instance, malignant tumors consist of a minority group of specific cancer stem cells (usually less than 1–2% of the total tumor cells based on the expression of certain cell surface markers) that possess a significant proliferative capacity [<xref rid="ref17" ref-type="bibr">17</xref>]. Thus, the capability of identifying novel rare cells in individual patients could lead to more personalized treatment approaches based on their unique cellular makeup [<xref rid="ref18" ref-type="bibr">18</xref>, <xref rid="ref19" ref-type="bibr">19</xref>]. However, most prior auto-annotation research concentrated on generic cell-type annotation [<xref rid="ref20" ref-type="bibr">20–24</xref>] and paid little attention to novel rare cell discovery.</p>
    <p>There have been previous endeavors in the field of novel cell discovery. scmap-cluster performs a nearest neighbor search to identify potential matches between cells from different datasets, and uses this information to construct a graph that captures the relationships between cells and clusters them based on their similarity [<xref rid="ref25" ref-type="bibr">25</xref>]. Similarly, scmap-cell uses an approximate nearest neighbor search method to efficiently find the K-nearest neighbors between the reference and query datasets, which helps reduce the computational complexity and improve the scalability of the algorithm when dealing with large datasets [<xref rid="ref25" ref-type="bibr">25</xref>]. scPred adopted a random forest classifier to predict cell-type labels, and incorporates unbiased feature selection and dimensionality reduction techniques to improve the accuracy and interpretability of the model [<xref rid="ref26" ref-type="bibr">26</xref>]. Through routine normalization, discriminative component analysis and learned transformation matrix, scLearn [<xref rid="ref27" ref-type="bibr">27</xref>] achieves the best performance on novel class detection, compared to the other previous methods. The major limitation of previous work is no one focused on novel rare cell detection and mainly utilized principal component analysis or discriminative component analysis for feature extraction so that the generated novel rare cell feature may lose information [<xref rid="ref28" ref-type="bibr">28</xref>]. The previous SOTA model scLearn even adds a method named rare cell-type filtering to remove rare cells from datasets.</p>
    <p>In this paper, we propose an integrated neural network framework, scNovel, that leverages barcode preprocessing for the auto-detection task. We develop two optional query stage options: the parallel query stage and the sequential query stage. Accordingly, barcode preprocessing is utilized to boost model performance via four modes of novel cell detection. To demonstrate the performance of novel rare cell detection performance of our method, we validate scNovel on various real datasets with different scales, different protocols, and different imbalance degrees. scNovel significantly outperforms previous state-of-the-art novel cell detection models, achieving the highest AUROC performance with statistical significance. scNovel is the only method whose averaged AUROC results are above 94%, up to 16.26% more compared to the second-best one. Furthermore, the scalability of scNovel is demonstrated through the robustness and efficiency across different scales of datasets. It is worth noticing that our work is the first and only novel rare cell discovery tool validated on a million-level atlas [<xref rid="ref29" ref-type="bibr">29</xref>]. We further apply scNovel on a clinical COVID-19 dataset, discover three potential novel subtypes of Macrophages and conduct a deeper analysis of the disease-related genes’ expression pattern.</p>
  </sec>
  <sec id="sec2">
    <title>METHODS</title>
    <sec id="sec2a">
      <title>A scalable neural nNetwork for novel rare cell-type discovery</title>
      <p>The basic architecture of our propsoed scNovel is a deep-neural-network-based classifier. As shown in <xref rid="f1" ref-type="fig">Figure 1</xref>, scNovel takes single-cell gene expression as input and outputs the novel cell detection result based on the classifier cell-type probability and the threshold <inline-formula><tex-math notation="LaTeX" id="ImEquation1">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\lambda $\end{document}</tex-math></inline-formula>. There are two stages of using scNovel. During the training stage, we adopt cross-entropy loss to train the model to output cell types’ probability prediction after the classifier. During the query stage, if <inline-formula><tex-math notation="LaTeX" id="ImEquation2">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$p(x)$\end{document}</tex-math></inline-formula> is smaller than the threshold, then the corresponding cells are determined as novel. To assess the novelty of a given cell type, we design four novel cell detection modes according to the selected query stage option, namely traditional classification mode, single plus-composition mode, parallel composition mode, as well as sequential composition mode (refer to more details in <xref rid="f7" ref-type="fig">Appendix Figure 1</xref>. A thorough explanation of the model framework and training strategy can be found in <xref rid="app3" ref-type="app">Appendix C</xref>. Once the considered score is over the threshold <inline-formula><tex-math notation="LaTeX" id="ImEquation3">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\lambda $\end{document}</tex-math></inline-formula> (usually defined as 0.5), we ascertain it to be novel. Through the conduction of comprehensive experiments, the predictive power of scNovel is promising even if the cell number and proportion are very small (17 cells out of a million cells). We use AUROC as our main evaluation metric while adopting AUPR and FPR95 metrics for additional reference. Please consult <xref rid="app2" ref-type="app">Appendix B</xref> for a detailed description of the evaluation metrics.</p>
      <fig position="float" id="f1">
        <label>Figure 1</label>
        <caption>
          <p>Overview of scNovel. The input <inline-formula><tex-math notation="LaTeX" id="ImEquation4">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\boldsymbol{x}$\end{document}</tex-math></inline-formula> is a single-cell gene expression. We employ a neural network to extract the single-cell feature. Then, map it <inline-formula><tex-math notation="LaTeX" id="ImEquation5">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$C^{ref}$\end{document}</tex-math></inline-formula> dimension to get cell-type probability prediction <inline-formula><tex-math notation="LaTeX" id="ImEquation6">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$p( \boldsymbol{x})$\end{document}</tex-math></inline-formula>. During the training stage, we employ the cross-entropy loss to optimize the network. We introduce two optional query stages, where barcode preprocessing is utilized to augment the predictive capabilities of scNovel. During the query stage, if <inline-formula><tex-math notation="LaTeX" id="ImEquation7">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$p(x)$\end{document}</tex-math></inline-formula> is smaller than the threshold, then the corresponding cells are determined as novel. In addition to separating novel cells from typical ones, scNovel could be extended to downstream analysis, including novel rare cell clusters detection and gene analysis.</p>
        </caption>
        <graphic xlink:href="bbae112f1" position="float"/>
      </fig>
    </sec>
  </sec>
  <sec id="sec3">
    <title>RESULTS</title>
    <sec id="sec3a">
      <title>Comprehensive assessment of the detection performance of scNovel</title>
      <p>In this section, we compare the performance of our method against existing cell-type classification tools, including scmap-cell and scmap-cluster [<xref rid="ref25" ref-type="bibr">25</xref>], scPred [<xref rid="ref26" ref-type="bibr">26</xref>] and scLearn [<xref rid="ref27" ref-type="bibr">27</xref>]. To ensure that our benchmark comparison is conducted under equitable experimental conditions, we employed a standardized preprocessing procedure for all the benchmark datasets and maintained the default values of all parameters for each method. We considered datasets from diverse imbalance degrees, diverse cell numbers, as well as diverse sequencing platforms to guarantee a more comprehensive comparison. Detailed re-implement and datasets’ information can be found in Appendices <xref rid="app1" ref-type="app">A</xref> and <xref rid="app3f" ref-type="sec">C.6</xref>. As detailed in <xref rid="TB1" ref-type="table">Appendix Table 1</xref>, our selection of datasets encompasses a wide range of widely utilized single-cell sequencing technologies, including 10Xv2 and 10Xv3, and so on. This broad spectrum of technologies was deliberately chosen to provide a robust validation of our method across different platforms, ensuring its generalizability and reliability in various single-cell sequencing contexts.</p>
      <p>As shown in <xref rid="TB2" ref-type="table">Appendix Table 2</xref>, compared with previous models, our proposed scNovel significantly improves the averaged performance via having the lowest FPR95 score, the highest AUROC and the highest AUPR scores on the novel rare cells discovery task among different datasets. Detailed description of the above-mentioned evaluation metrics can be found in the <xref rid="app2" ref-type="app">Appendix B</xref>. Given our emphasis on the detection of novel and rare cells, our initial evaluation of scNovel concentrates on its performance with a limited set of novel cell classes that are absent from the training data. In this context, we use the notation <inline-formula><tex-math notation="LaTeX" id="ImEquation15">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$C^{novel}$\end{document}</tex-math></inline-formula> to represent the number of novel classes present in the test set. From the results presented in <xref rid="TB2" ref-type="table">Appendix Table 2</xref>, it is noticeable that there is a decreasing trend in performance as the number of novel classes (<inline-formula><tex-math notation="LaTeX" id="ImEquation16">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$C^{novel}$\end{document}</tex-math></inline-formula>) increases. This indicates that the task becomes progressively more challenging as the number of novel classes in the test set increases. Namely, scNovel achieves a 96.33% AUROC when <inline-formula><tex-math notation="LaTeX" id="ImEquation17">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$C^{novel}$\end{document}</tex-math></inline-formula> is equal to 1, surpassing the next best performing method, scLearn, by a substantial margin of 12.33% AUROC. Across all <inline-formula><tex-math notation="LaTeX" id="ImEquation18">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$C^{novel}$\end{document}</tex-math></inline-formula>, our scNovel gains on an average 11.75% AUROC more compared to the second best method scLearn, demonstrating that scNovel is robust for different <inline-formula><tex-math notation="LaTeX" id="ImEquation19">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$C^{novel}$\end{document}</tex-math></inline-formula>, and is outstanding compared to other models. The box plots in <xref rid="f2" ref-type="fig">Figure 2(A)</xref> further demonstrate the robustness of scNovel by showing not only higher AUROC values but also smaller interquartile ranges across various dataset sizes (<inline-formula><tex-math notation="LaTeX" id="ImEquation20">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\sim $\end{document}</tex-math></inline-formula> 1k cells to <inline-formula><tex-math notation="LaTeX" id="ImEquation21">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\sim $\end{document}</tex-math></inline-formula> 60k cells) and different protocols. The statistical analysis, using a one-tailed <italic toggle="yes">t</italic>-test, consistently demonstrates that scNovel outperforms other methods with significant statistical significance in most scenarios. This indicates that the adopted neural network shows robust performance for single-cell sequencing feature extraction and works well for novel rare-cell feature extraction. The cell-type distribution and detection results are visualized in <xref rid="f2" ref-type="fig">Figure 2(B)</xref>.</p>
      <fig position="float" id="f2">
        <label>Figure 2</label>
        <caption>
          <p>(<bold>A</bold>) AUROCs of different methods with various <inline-formula><tex-math notation="LaTeX" id="ImEquation52">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$C^{novel}$\end{document}</tex-math></inline-formula>. The box plots show that scNovel has higher mean but smaller interquartile range of AUROCs than all the other methods, showing a stable novel rare cell detection ability among various datasets and <inline-formula><tex-math notation="LaTeX" id="ImEquation53">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$C^{novel}$\end{document}</tex-math></inline-formula>. <italic toggle="yes">P</italic>-value with notation * means <italic toggle="yes">P</italic>¡0.05, with notation <inline-formula><tex-math notation="LaTeX" id="ImEquation54">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$ns$\end{document}</tex-math></inline-formula> means no significance. The heatmaps show the detailed AUROC values of different methods and datasets. (<bold>B</bold>) Cell-type UMAP visualization of Zilionis dataset. (<bold>C</bold>) The AUROC curves of various methods are evaluated, with scNovel demonstrating superior TPR over all other methods, regardless of the FPR. (<bold>D</bold>) UMAP visualization of the novel cell discovery task on the Zilionis dataset with <inline-formula><tex-math notation="LaTeX" id="ImEquation55">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$C^{novel}$\end{document}</tex-math></inline-formula>=2. The result of scNovel is the closest to the ground truth, while the other ones have too many false positive predictions. scNovel outperforms other methods in detecting novel rare cell types, uniquely identifying pDC and RBC. Unlike scLearn, scPred, scmap-cell and scmap-cluster, which inaccurately annotate T cells and Neutrophils, scNovel achieves the most precise detection across all cell types, successfully pinpointing RBC and pDC.</p>
        </caption>
        <graphic xlink:href="bbae112f2" position="float"/>
      </fig>
      <p>We also show the AUROC curves in <xref rid="f2" ref-type="fig">Figure 2(C)</xref>. for the Zilionis dataset with <inline-formula><tex-math notation="LaTeX" id="ImEquation56">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$C^{novel}=2$\end{document}</tex-math></inline-formula>. According to the AUROC curve, we could find that scNovel not only dominates in AUROC space [<xref rid="ref30" ref-type="bibr">30</xref>] but also achieves superior true positive rate (TPR) over all other methods, regardless of the FPR. As shown in <xref rid="f2" ref-type="fig">Figure 2(B and D)</xref>, Notably, scNovel has the best novel rare cell detection performance and is the only method that can detect the two novel rare cell types, including plasmacytoid dendritic cell (pDC) and red blood cell (RBC). Compared with the ground truth label, scLearn, scPred, scmap-cell and scmap-cluster give more incorrect annotations on the T cell and Neutrophils than scNovel. scPred even almost fails on this task, as it detects the majority of cells to be novel. In contrast, scNovel demonstrates the most accurate novel rare cell detection result on all cell types and successfully finds the two novel rare cells, RBC and pDC.</p>
    </sec>
    <sec id="sec3b">
      <title>Consistent performance with various C<sup>novel</sup> in different modes</title>
      <p>In this section, we investigate our model performance with various novel cell class numbers <inline-formula><tex-math notation="LaTeX" id="ImEquation58">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$C^{novel}$\end{document}</tex-math></inline-formula> in different modes. We begin with showing our model performance with four different query modes:</p>
      <list list-type="bullet">
        <list-item>
          <p><inline-formula><tex-math notation="LaTeX" id="ImEquation59">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$S^{MSP}$\end{document}</tex-math></inline-formula> in Equation (<xref rid="deqn06" ref-type="disp-formula">C6</xref>), which uses the maximum prediction probability as score;</p>
        </list-item>
        <list-item>
          <p><inline-formula><tex-math notation="LaTeX" id="ImEquation60">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$S^{ODIN}$\end{document}</tex-math></inline-formula> in Equation (<xref rid="deqn10" ref-type="disp-formula">C10</xref>), which utilizes only <inline-formula><tex-math notation="LaTeX" id="ImEquation61">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$T_{minus}$\end{document}</tex-math></inline-formula> barcode preprocessing;</p>
        </list-item>
        <list-item>
          <p><inline-formula><tex-math notation="LaTeX" id="ImEquation62">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$S^{SEQ}$\end{document}</tex-math></inline-formula> in Equation (<xref rid="deqn13" ref-type="disp-formula">C13</xref>), which sequentially utilizes <inline-formula><tex-math notation="LaTeX" id="ImEquation63">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$T_{minus}$\end{document}</tex-math></inline-formula> and <inline-formula><tex-math notation="LaTeX" id="ImEquation64">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$T_{plus}$\end{document}</tex-math></inline-formula> barcode preprocessing;</p>
        </list-item>
        <list-item>
          <p><inline-formula><tex-math notation="LaTeX" id="ImEquation65">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$S^{SIM}$\end{document}</tex-math></inline-formula> in Equation (<xref rid="deqn12" ref-type="disp-formula">C12</xref>), which simultaneously employs <inline-formula><tex-math notation="LaTeX" id="ImEquation66">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$T_{minus}$\end{document}</tex-math></inline-formula> and <inline-formula><tex-math notation="LaTeX" id="ImEquation67">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$T_{plus}$\end{document}</tex-math></inline-formula> barcode preprocessing.</p>
        </list-item>
      </list>
      <p>Through the detailed ablation study (<xref rid="TB4" ref-type="table">Appendix Table 4</xref> and <xref rid="f3" ref-type="fig">Figure 3A</xref>), we come to the conclusion that <inline-formula><tex-math notation="LaTeX" id="ImEquation68">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$S^{SIM}$\end{document}</tex-math></inline-formula> should be the best mode for novel rare cell-type discovery tasks. Therefore, future efforts will focus on devising more sophisticated methods, potentially exploring various forms of sharpness metrics (as shown in Equations <xref rid="deqn12" ref-type="disp-formula">C12</xref> and <xref rid="deqn13" ref-type="disp-formula">C13</xref>), to enhance the distinction between typical and novel cells, thereby further elevating the model’s performance. We then investigate scNovel’s performance with different <inline-formula><tex-math notation="LaTeX" id="ImEquation69">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$C^{novel}$\end{document}</tex-math></inline-formula> of <inline-formula><tex-math notation="LaTeX" id="ImEquation70">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$S^{SIM}$\end{document}</tex-math></inline-formula> mode in <xref rid="f3" ref-type="fig">Figure 3(B and C)</xref> in detail. Overall, scNovel has the best average performance across all datasets, as well as has the smallest variance (<xref rid="f3" ref-type="fig">Figure 3C</xref>) when <inline-formula><tex-math notation="LaTeX" id="ImEquation71">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$C^{novel}$\end{document}</tex-math></inline-formula> is 1. To be specific, scNovel gets 22.82% FPR95, 96.33% AUROC and 99.76% AUPR when the model is only required to predict one novel cell type. Detailed AUROC performance on each dataset is shown in <xref rid="f3" ref-type="fig">Figure 3(B)</xref>. Intuitively, as <inline-formula><tex-math notation="LaTeX" id="ImEquation72">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$C^{novel}$\end{document}</tex-math></inline-formula> increases, the novel cell distribution <inline-formula><tex-math notation="LaTeX" id="ImEquation73">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\mathcal{P}_{novel}$\end{document}</tex-math></inline-formula> becomes more and more complicated. As a consequence, the AUROCs of <inline-formula><tex-math notation="LaTeX" id="ImEquation74">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$C^{novel}$\end{document}</tex-math></inline-formula>=2, 3 and 4 decrease to 94.29, 94.6 and 94.16%, respectively. <xref rid="f3" ref-type="fig">Figure 3(D)</xref> shows the accumulated AUROCs of each novel cell type of dataset Zillion with various <inline-formula><tex-math notation="LaTeX" id="ImEquation75">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$C^{novel}$\end{document}</tex-math></inline-formula>. <xref rid="f3" ref-type="fig">Figure 3(E)</xref> shows the corresponding data-split settings of the four <inline-formula><tex-math notation="LaTeX" id="ImEquation76">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$C^{novel}$\end{document}</tex-math></inline-formula>. With the increase of <inline-formula><tex-math notation="LaTeX" id="ImEquation77">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$C^{novel}$\end{document}</tex-math></inline-formula>, the AUROCs of RBC are stable. This also suggests that the novel rare cell detection performance of scNovel is mainly affected by the cell type, and it is robust to the various <inline-formula><tex-math notation="LaTeX" id="ImEquation78">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$C^{novel}$\end{document}</tex-math></inline-formula>. In <xref rid="f3" ref-type="fig">Figure 3(F)</xref>, we have presented a comparative analysis of UMAP visualizations for scNovel, utilizing a threshold of 0.5, against the ground truth for the task of novel cell discovery within the Zilionis dataset. This comparison indicates that our proposed scNovel method achieves consistently meaningful visualization performance across different values of <inline-formula><tex-math notation="LaTeX" id="ImEquation79">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$C^{novel}$\end{document}</tex-math></inline-formula>, employing a default threshold of 0.5.</p>
      <fig position="float" id="f3">
        <label>Figure 3</label>
        <caption>
          <p>(<bold>A</bold>) The box plots of AUROCs of different novel cell detection modes with <inline-formula><tex-math notation="LaTeX" id="ImEquation109">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$C^{novel}$\end{document}</tex-math></inline-formula> ranging from 1 to 4. (<bold>B</bold>) Heatmap of the detailed AUROC values of <inline-formula><tex-math notation="LaTeX" id="ImEquation110">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$S^{SIM}$\end{document}</tex-math></inline-formula> mode on all the considered datasets. (<bold>C</bold>) The violin plot of the <inline-formula><tex-math notation="LaTeX" id="ImEquation111">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$S^{SIM}$\end{document}</tex-math></inline-formula> mode of scNovel’s AUROCs with different novel class numbers <inline-formula><tex-math notation="LaTeX" id="ImEquation112">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$C^{novel}$\end{document}</tex-math></inline-formula> on various datasets. We could find that the performance of scNovel is stable with various <inline-formula><tex-math notation="LaTeX" id="ImEquation113">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$C^{novel}$\end{document}</tex-math></inline-formula>. (<bold>D</bold>) The accumulation bar plot of AUROC values of each novel rare cell detected from the Zillion dataset with <inline-formula><tex-math notation="LaTeX" id="ImEquation114">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$C^{novel}$\end{document}</tex-math></inline-formula> ranging from 1 to 4. (<bold>E</bold>) Taking the Zillion dataset as an example, the bar plot shows the experimental setting with different <inline-formula><tex-math notation="LaTeX" id="ImEquation115">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$C^{novel}$\end{document}</tex-math></inline-formula>. (<bold>F</bold>) The UMAP visualization comparison between scNovel and the ground truth of the novel cell discovery task on the Zilionis dataset with different <inline-formula><tex-math notation="LaTeX" id="ImEquation116">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$C^{novel}$\end{document}</tex-math></inline-formula>.</p>
        </caption>
        <graphic xlink:href="bbae112f3" position="float"/>
      </fig>
    </sec>
    <sec id="sec3c">
      <title>Superiority in rare population identification under batch effects</title>
      <p>In the real application scenario, training and applying the rare cell detection tools can be conducted on different dataset protocols and platforms with heavy batch effects. These systematic variations are crucial, particularly when analyzing rare cell populations, and must be carefully addressed to ensure accurate and reliable results. Therefore, as shown in <xref rid="f4" ref-type="fig">Figure 4(A and B)</xref>, we collect PBMCbench datasets from 10Xv2, 10Xv3, Drop-Seq, Cel-Seq, InDrop and Seq-Well are considered to evaluate scNovel’s ability to detect novel rare cells across platforms</p>
      <fig position="float" id="f4">
        <label>Figure 4</label>
        <caption>
          <p>(<bold>A</bold>) Overall novel rare cell detection AUROCs on the datasets generated by different protocols, with reference dataset PBMC Cel-Seq. (<bold>B</bold>) Overall novel rare cell detection AUROCs on the datasets generated by different protocols, with the reference dataset PBMC 10X Chromium v3. (<bold>C</bold>) The UMAP visualization of ground truth cell-type, AUROC curves and the UMAP visualization of novel cell discovery task of various methods. All methods are trained on PBMC Cel-Seq, and tested on PBMC 10X Chromium v3. Only scNovel and scLearn detect all Megakaryocyte cells, while scNovel has few false positive predictions than scLearn.</p>
        </caption>
        <graphic xlink:href="bbae112f4" position="float"/>
      </fig>
      <p>scLearn, which is the second-best model in intra-platform experiments, is shown to suffer from the effect of batch effects, achieving only 78.95% for Cel-Seq reference dataset (<xref rid="f4" ref-type="fig">Figure 4A</xref>) and 80.61% for 10Xv3 reference dataset (<xref rid="f4" ref-type="fig">Figure 4B</xref>). Our proposed scNovel outperforms scmap-cluster by 6% and scLearn by 16%, suggesting that scNovel is robust to the potential obstacles in cross-platform annotation tasks. To further investigate the performance of model performance under batch effect, we show the UMAP visualization result and AUROC results in <xref rid="f4" ref-type="fig">Figure 4(C)</xref>, with Cel-Seq as reference set and test on 10Xv3 set query set. There are two novel cell types, including Dentritic cells and Megakaryocyte. Only scNovel and scLearn successfully detect all Megakaryocyte cells, while scmap-cell, scmap-cluster, and scPred miss a part of Megakaryocyte cells. Compared with scLearn, our proposed scNovel has even fewer false positive predictions, while scLearn wrongly detects CD16+ monocyte and Cytotoxic T Cell to be novel. Also, according to the AUROC curve, we could find that our proposed scNovel has a better TPR than all other models, regardless of the FPR. This proves that our proposed scNovel upholds its excellent performance in the novel rare cell-type discovery tasks under the impact of systematic variations.</p>
    </sec>
    <sec id="sec3d">
      <title>Enhanced scalability of scNovel through robust processing efficiency in million-level dataset</title>
      <p>In the context of real-world single-cell analysis, computational efficiency is of vital importance and is viewed as the main impediment to achieving scalability. From <xref rid="f5" ref-type="fig">Figure 5A</xref>, the running time of scNovel remains relatively consistent across datasets with varying samples. For the datasets with more than 30k cells, scNovel reduces the runtime by up to 25% compared to the fastest of our four comparison models, scmap-cluster. On the analysis of the largest dataset, TM, scNovel provides a computation speed over 120 times faster than scPred, showing that our proposed method has the potential to facilitate rapid novel cell detection of large-scale datasets. Our analysis shows the model’s running time is mainly influenced by two factors: computation and weight updates, and Pytorch Dataloader preparation, which remains constant across datasets. However, smaller datasets require more frequent Dataloader preparations, leading to longer running times, as seen with the Darmanis dataset compared to the larger Zilionis dataset. Hence, dataset size directly affects the model’s overall running time. The significance of scalability for detection tools becomes more pronounced as the size of the cell atlas increases.</p>
      <fig position="float" id="f5">
        <label>Figure 5</label>
        <caption>
          <p>(<bold>A</bold>) Time complexity analysis of different methods on datasets with different scales. scNovel exhibits exceptional scalability, requiring the least amount of time even when processing TM dataset that scales up to 60k cells. (<bold>B</bold>) Experiment setting of COVID Altas. (<bold>C</bold>) The <inline-formula><tex-math notation="LaTeX" id="ImEquation117">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\mathcal{D}_{query}^{novel}$\end{document}</tex-math></inline-formula> cell number statistic and each cell-type detection results. The <inline-formula><tex-math notation="LaTeX" id="ImEquation118">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\mathcal{D}_{query}^{novel}$\end{document}</tex-math></inline-formula> has 10 cell types and total of 9332 cells. We could find that the novel rare cell detection results are not affected by the cell number. The mast, the rarest cell, is detected better than Macro-EREG, whose cell number is large. (<bold>D</bold>) Results of novel rare cell detection with different score functions. (<bold>E</bold>) Cell-type UMAP visualization of the considered COVID-19 immune atlas. (<bold>F</bold>) UMAP visualization of the novel cell discovery task of scNovel on the COVID-19 immune atlas with <inline-formula><tex-math notation="LaTeX" id="ImEquation119">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$C^{novel}$\end{document}</tex-math></inline-formula> = 10.</p>
        </caption>
        <graphic xlink:href="bbae112f5" position="float"/>
      </fig>
      <p>To further validate the robustness of our performance on a large, imbalanced dataset, we apply scNovel to a million-scale scRNA-seq dataset COVID-19 immune atlas [<xref rid="ref29" ref-type="bibr">29</xref>](1 462 702 cells). The scRNA-seq dataset COVID-19 immune atlas has 64 cell types, divided into three groups, including healthy, moderate (COVID) and severe(COVID). The healthy group has 54 cell types,while 10 cell types only appear in COVID groups (shown in <xref rid="f5" ref-type="fig">Figure 5B</xref>), and the 10 cell types are selected as novel cell types. We further elaborate on the impact of the 10 specific cell types on our experimental outcomes, as illustrated in the results presented in <xref rid="f5" ref-type="fig">Figure 5(C)</xref>. Shown in <xref rid="f5" ref-type="fig">Figure 5(D)</xref>, the performance of <inline-formula><tex-math notation="LaTeX" id="ImEquation120">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$S^{MSP}$\end{document}</tex-math></inline-formula> mode is lower than that of <inline-formula><tex-math notation="LaTeX" id="ImEquation121">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$S^{ODIN}$\end{document}</tex-math></inline-formula> mode, <inline-formula><tex-math notation="LaTeX" id="ImEquation122">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$S^{SEQ}$\end{document}</tex-math></inline-formula> mode and <inline-formula><tex-math notation="LaTeX" id="ImEquation123">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$S^{SIM}$\end{document}</tex-math></inline-formula> mode, which suggests the importance of barcode preprocessing. <xref rid="f5" ref-type="fig">Figure 5(C)</xref> shows that the Epi cell types, including Epi-Squamous, Epi-Secretory, Epi-Ciliated, and Epi-AT2, have low FPR95, high AUROC, and high AUPR. The underlying reason is that Epi cell types only appear in <inline-formula><tex-math notation="LaTeX" id="ImEquation124">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\mathcal{D}_{query}^{novel}$\end{document}</tex-math></inline-formula> so that it is easier for our model to detect them. For the same reason, the Mast, which only has 17 cells, has the same high AUROC. In contrast, the performance is relatively lower in Macro-DNAJB1, Macro-EREG, Neu-FGF23, Neu-RSAD2 and DC-LAMP3. For Macro-DNAJB1 and Macro-EREG, there are other subgroup cells of Macro in <inline-formula><tex-math notation="LaTeX" id="ImEquation125">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\mathcal{D}_{ref}$\end{document}</tex-math></inline-formula>, such as Macro-C1QC and Macro-CCL3L1. For Neu-FGF23 and Neu-RSAD2, there are Neu-IL1B and Neu-CST7 in <inline-formula><tex-math notation="LaTeX" id="ImEquation126">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\mathcal{D}_{ref}$\end{document}</tex-math></inline-formula>. For DC-LAMP3, the <inline-formula><tex-math notation="LaTeX" id="ImEquation127">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\mathcal{D}_{ref}$\end{document}</tex-math></inline-formula> contains DC-CLEC9A and DC-LILRA4. We could notice that the novel rare cell detection performance is not related to the cell numbers. The mast, the rarest cell, is detected better than Macro-EREG, whose cell number is large. As shown in <xref rid="f5" ref-type="fig">Figure 5(E) and (F)</xref>, scNovel is capable of accurately identifying 10 novel rare cell types that are exclusively present in COVID-19 cases within datasets comprising millions of cells. This achievement underscores the scalability of scNovel and highlights its potential for deployment in large-scale real-world applications.</p>
    </sec>
    <sec id="sec3e">
      <title>Potential novel subtypes discovery and functional investigation in bronchoalveolar immune cell atlas in COVID patient</title>
      <p>Studies have shown the importance of cell-type-specific analysis of the genetic heterogeneity of specific cell types in the field of biomedicine [<xref rid="ref31" ref-type="bibr">31</xref>]. For instance, COVID single-cell atlas [<xref rid="ref29" ref-type="bibr">29</xref>] detects 64 cell types further to analyze the relationship between cell gene expression and diseases. However, the detection process of novel cell types is time-consuming and needs prior knowledge. Our proposed scNovel could find novel rare cells automatically: (1) detect the novel cells of the query set; (2) employ Leiden clustering to generate cell clusters; and (3) utilize the novel cell clusters for further analysis.</p>
      <p>In this study, with a 1.5-million-scale dataset as the reference set, we apply the above analysis pipeline to a published COVID-19 dataset [<xref rid="ref32" ref-type="bibr">32</xref>] (GEO accession number GSE171524), containing 116 314 cells collected from 7 healthy controls and 20 COVID-19 samples. We show the UMAP visualization of cell-type annotation (<xref rid="f6" ref-type="fig">Figure 6A</xref>) and patient annotation (<xref rid="f6" ref-type="fig">Figure 6B</xref>). <xref rid="f6" ref-type="fig">Figure 6C</xref> presents the novel cell detection result. In our setting, B cell and T cell are present in the reference set, while AT1 and AT2 are left for testing. <xref rid="f6" ref-type="fig">Figure 6D</xref>, as detected by scNovel, illustrates the distributions of typical and novel cells, demonstrating the tool’s effectiveness in identifying and differentiating between cell types. Combining the results in <xref rid="f6" ref-type="fig">Figure 6C</xref> and <xref rid="f6" ref-type="fig">Figure 6D</xref>, we can find that B cell and T cell are less likely to be predicted to be novel, but AT1 and AT2 are detected as novel cells successfully. To further ensure the discovered novel cells are different from the cells in the reference set, we present the gene expression in <xref rid="f6" ref-type="fig">Figure 6E</xref>. It directly supports that the newly discovered cells are different from the cells in the reference set. We also carry out analysis on the gene differentiation of different novel cell clusters by showing the highest gene expression of each novel cell cluster and their relation in <xref rid="f6" ref-type="fig">Figure 6F</xref>. We find that clusters 3, 5, and 12 have high CD163 expression, which means that they may be subtypes of Macrophage. Then, we conduct deeper analyses of the selected three clusters to study the relationship between their gene expression and COVID-19. We show the expression level between the top 8 biomarkers in each cluster (<xref rid="f6" ref-type="fig">Figure 6G</xref>). From the volcano figure in <xref rid="f6" ref-type="fig">Figure 6H</xref>, seven genes have higher expression in COVID patients, and some are already supported by past research, including ADAMTS2 [<xref rid="ref33" ref-type="bibr">33</xref>], CD163 [<xref rid="ref34" ref-type="bibr">34</xref>, <xref rid="ref35" ref-type="bibr">35</xref>], CEBPB [<xref rid="ref36" ref-type="bibr">36</xref>], CTSD, LDLRAD3, NEAT1 [<xref rid="ref37" ref-type="bibr">37</xref>] and TPST1. Moreover, nine genes have lower expression in COVID patients, which are also supported by the existing works, including ATG77 [<xref rid="ref38" ref-type="bibr">38</xref>], CSF2RA [<xref rid="ref39" ref-type="bibr">39</xref>], DST, FARP1, FRMD4A, HLA-DPB1, HLA-DRB1, RASAL2 and TFRC. Rather than only analyzing differential gene expression in a single cluster, selecting biomarkers that satisfy all three criteria in the dependent clusters makes the analysis results more reliable. Finally, we conducted a Gene Ontology (GO) analysis in <xref rid="f6" ref-type="fig">Figure 6I</xref>, supplemented by gene set enrichment analysis, to investigate changes in biological pathways between macrophages with differing COVID statuses. Our results indicate significant upregulation in COVID samples, particularly in neutrophil activation related to immune response, neutrophil degranulation, and neutrophil-mediated immunity. By applying scNovel to a COVID-19 dataset, we have demonstrated its effectiveness in accurately identifying unique cell types. This success suggests the potential of scNovel as a critical tool in accelerating diagnostics and response in future pandemics or diseases.</p>
      <fig position="float" id="f6">
        <label>Figure 6</label>
        <caption>
          <p>(<bold>A</bold>) UMAP visualization of each cell type in the query dataset. There are a total of 19 cell types. (<bold>B</bold>) UMAP visualization of patient distribution. (<bold>C</bold>) The Leiden clustering results of detected novel cells. In total, there are 24 new cell types. (<bold>D</bold>) UMAP visualization of the novel cell detection result via scNovel with threshold 0.45. (<bold>E</bold>) The stacked violin plot overview of the gene expression in typical cells of reference set and new cell types. According to the gene expression, the new cell clusters are different from the typical cells in the reference set. (<bold>F</bold>) The stacked dot plot overview of the top-important marker genes expression for each cell type. (<bold>G</bold>) The comparison of the expression level between the top 8 biomarkers in the COVID group and the rest of the patients. (<bold>H</bold>) The Volcano figure of cluster 3, cluster 5 and cluster 12. (<bold>I</bold>) GO analysis in novel Macrophages between COVID samples and Healthy Samples. </p>
        </caption>
        <graphic xlink:href="bbae112f6" position="float"/>
      </fig>
    </sec>
  </sec>
  <sec id="sec4">
    <title>DISCUSSION</title>
    <p>The development of scRNA-seq methods has increased the demand for single-cell analysis tools. Previous research works mainly focus on cell-type annotation, but pay little attention to novel rare cell discovery task, which is important for classifier’s reliability and cell discovery. To the best of our knowledge, we are the first one focusing on novel rare cell discovery, and we propose the first corresponding auto-detection model named scNovel, an open-source Python package that integrates neural network and barcode preprocessing. With extensive experiments on several scRNA-seq datasets with different scales, different generation protocols and different <inline-formula><tex-math notation="LaTeX" id="ImEquation128">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$C^{novel}$\end{document}</tex-math></inline-formula>, we have demonstrated an effective novel rare cell discovery ability. We have also shown the fast running speed of scNovel on datasets with different scales, which proves the scalability. Moreover, we evaluate our model on a million-level dataset, which further shown the scalability and novel rare cell discovery capacity. Also, we employ the scNovel to detect novel rare cell clusters for more trustable disease gene analysis.</p>
    <p>In future work, we have several suggestions for scNovel improvement. Firstly, a better score function could improve scNovel performance. Specifically, we could utilize up-sharpness and down-sharpness multiple times. Secondly, we could employ more biology information. For instance, we leverage both scRNA-Seq and single-cell chromatin accessibility sequencing for novel rare cell discovery. In all, we believe that scNovel is an effective and efficient tool for single-cell analysis, especially its ability and scalability of rare cell types.</p>
    <boxed-text id="box01" position="float">
      <sec id="sec27">
        <title>Key Points</title>
        <list list-type="bullet">
          <list-item>
            <p>scNovel is a scalable deep learning-based network for novel rare cell discovery in single-cell transcriptomics, and the first method to use the barcode preprocessing on novel rare cell detection on the scRNA-seq data.</p>
          </list-item>
          <list-item>
            <p>We apply scNovel on extensive intra-dataset and inter-protocol novel rare cell detection experiments, even considering a large, imbalanced million-scale dataset. Notably, it achieves an average AUROC performance exceeding 94%, surpassing the second-best method by up to 16.26%.</p>
          </list-item>
          <list-item>
            <p>Within the context of the profoundly imbalanced clinical COVID-19 dataset, a comprehensive analysis has unveiled the existence of three promising novel subtypes of macrophages.</p>
          </list-item>
          <list-item>
            <p>We developed a pipeline for the identification of novel rare cells and the analysis of differential gene expression. Our proposed scNovel-based analytical framework extends beyond its application to COVID-19, as it can be seamlessly tailored to investigate genes associated with various other diseases.</p>
          </list-item>
        </list>
      </sec>
    </boxed-text>
  </sec>
</body>
<back>
  <sec id="sec7a">
    <title>ACKNOWLEDGEMENT</title>
    <p>The work described in this paper was partially supported by a grant from the Research Grants Council of the Hong Kong Special Administrative Region, China [Project No.: CUHK 24204023], and a grant from Innovation and Technology Commission of the Hong Kong Special Administrative Region, China [Project No.: GHP/065/21SZ]. This research is funded by Chinese University of Hong Kong (CUHK) with the award number 4937025, 4937026, 5501517, 5501329.</p>
  </sec>
  <sec id="sec7">
    <title>AUTHOR CONTRIBUTIONS</title>
    <p>Y.L. conceived and supervised the project. C.Z., Y.C. and H.W. designed the method and all benchmark experiments. C.Z. implemented the tool in Python. C.Z, X.W. and Y.W performed data analysis and all computational experiments. C.Z., Y.W. Y.C. and H.W. wrote the manuscript together. All authors reviewed the manuscript.</p>
  </sec>
  <sec id="sec6">
    <title>CODE AVAILABILITY</title>
    <p>scNovel is available as an independent python package at <ext-link xlink:href="https://github.com/chuanyang-Zheng/scNovel" ext-link-type="uri">https://github.com/chuanyang-Zheng/scNovel</ext-link>.</p>
  </sec>
  <sec sec-type="data-availability" id="sec5">
    <title>DATA AVAILABILITY</title>
    <p>No new data was generated from this study. All data used in this study is publicly available as shown in <xref rid="TB1" ref-type="table">Appendix Table 1</xref>.</p>
  </sec>
  <ref-list id="bib1">
    <title>References</title>
    <ref id="ref1">
      <label>1.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Tang</surname><given-names>F</given-names></string-name>, <string-name><surname>Barbacioru</surname><given-names>C</given-names></string-name>, <string-name><surname>Wang</surname><given-names>Y</given-names></string-name>, <etal>et al.</etal></person-group><article-title>mRNA-Seq whole-transcriptome analysis of a single cell</article-title>. <source>Nat Methods</source><year>2009</year>;<volume>6</volume>:<fpage>377</fpage>–<lpage>82</lpage>.<pub-id pub-id-type="pmid">19349980</pub-id></mixed-citation>
    </ref>
    <ref id="ref2">
      <label>2.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Klein</surname><given-names>AM</given-names></string-name>, <string-name><surname>Mazutis</surname><given-names>L</given-names></string-name>, <string-name><surname>Akartuna</surname><given-names>I</given-names></string-name>, <etal>et al.</etal></person-group><article-title>Droplet barcoding for single-cell transcriptomics applied to embryonic stem cells</article-title>. <source>Cell</source><year>2015</year>;<volume>161</volume>:<fpage>1187</fpage>–<lpage>201</lpage>.<pub-id pub-id-type="pmid">26000487</pub-id></mixed-citation>
    </ref>
    <ref id="ref3">
      <label>3.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Guo</surname><given-names>G</given-names></string-name>, <string-name><surname>Huss</surname><given-names>M</given-names></string-name>, <string-name><surname>Tong</surname><given-names>GQ</given-names></string-name>, <etal>et al.</etal></person-group><article-title>Resolution of cell fate decisions revealed by single-cell gene expression analysis from zygote to blastocyst</article-title>. <source>Dev Cell</source><year>2010</year>;<volume>18</volume>:<fpage>675</fpage>–<lpage>85</lpage>.<pub-id pub-id-type="pmid">20412781</pub-id></mixed-citation>
    </ref>
    <ref id="ref4">
      <label>4.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><collab>Tabula Muris Consortium</collab>.</person-group><article-title>Single-cell transcriptomics of 20 mouse organs creates a Tabula Muris</article-title>. <source>Nature</source><year>2018</year>;<volume>562</volume>:<fpage>367</fpage>–<lpage>72</lpage>.<pub-id pub-id-type="pmid">30283141</pub-id></mixed-citation>
    </ref>
    <ref id="ref5">
      <label>5.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Zheng</surname><given-names>GX</given-names></string-name>, <string-name><surname>Terry</surname><given-names>JM</given-names></string-name>, <string-name><surname>Belgrader</surname><given-names>P</given-names></string-name>, <etal>et al.</etal></person-group><article-title>Massively parallel digital transcriptional profiling of single cells</article-title>. <source>Nat Commun</source><year>2017</year>;<volume>8</volume>:<fpage>1</fpage>–<lpage>12</lpage>.<pub-id pub-id-type="pmid">28232747</pub-id></mixed-citation>
    </ref>
    <ref id="ref6">
      <label>6.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Davie</surname><given-names>K</given-names></string-name>, <string-name><surname>Janssens</surname><given-names>J</given-names></string-name>, <string-name><surname>Koldere</surname><given-names>D</given-names></string-name>, <etal>et al.</etal></person-group><article-title>A single-cell transcriptome atlas of the aging drosophila brain</article-title>. <source>Cell</source><year>2018</year>;<volume>174</volume>:<fpage>982</fpage>–<lpage>998.e20</lpage>.<pub-id pub-id-type="pmid">29909982</pub-id></mixed-citation>
    </ref>
    <ref id="ref7">
      <label>7.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Horning</surname><given-names>AM</given-names></string-name>, <string-name><surname>Wang</surname><given-names>Y</given-names></string-name>, <string-name><surname>Lin</surname><given-names>CK</given-names></string-name>, <etal>et al.</etal></person-group><article-title>Single-cell RNA-seq reveals a subpopulation of prostate cancer cells with enhanced cell-cycle–related transcription and attenuated androgen response</article-title>. <source>Cancer Res</source><year>2018</year>;<volume>78</volume>:<fpage>853</fpage>–<lpage>64</lpage>.<pub-id pub-id-type="pmid">29233929</pub-id></mixed-citation>
    </ref>
    <ref id="ref8">
      <label>8.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Nyquist</surname><given-names>MD</given-names></string-name>, <string-name><surname>Corella</surname><given-names>A</given-names></string-name>, <string-name><surname>Coleman</surname><given-names>I</given-names></string-name>, <etal>et al.</etal></person-group><article-title>Combined TP53 and RB1 loss promotes prostate cancer resistance to a spectrum of therapeutics and confers vulnerability to replication stress</article-title>. <source>Cell Rep</source><year>2020</year>;<volume>31</volume>:107669.</mixed-citation>
    </ref>
    <ref id="ref9">
      <label>9.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Chen</surname><given-names>Y</given-names></string-name>, <string-name><surname>Wang</surname><given-names>Y</given-names></string-name>, <string-name><surname>Chen</surname><given-names>Y</given-names></string-name>, <etal>et al.</etal></person-group><article-title>Deep autoencoder for interpretable tissue-adaptive deconvolution and cell-type-specific gene analysis</article-title>. <source>Nat Commun</source><year>2022</year>;<volume>13</volume>:<fpage>6735</fpage>.<pub-id pub-id-type="pmid">36347853</pub-id></mixed-citation>
    </ref>
    <ref id="ref10">
      <label>10.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Guo</surname><given-names>C</given-names></string-name>, <string-name><surname>Li</surname><given-names>B</given-names></string-name>, <string-name><surname>Ma</surname><given-names>H</given-names></string-name>, <etal>et al.</etal></person-group><article-title>Single-cell analysis of two severe Covid-19 patients reveals a monocyte-associated and tocilizumab-responding cytokine storm</article-title>. <source>Nat Commun</source><year>2020</year>;<volume>11</volume>:<fpage>1</fpage>–<lpage>11</lpage>.<pub-id pub-id-type="pmid">31911652</pub-id></mixed-citation>
    </ref>
    <ref id="ref11">
      <label>11.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Wilk</surname><given-names>AJ</given-names></string-name>, <string-name><surname>Rustagi</surname><given-names>A</given-names></string-name>, <string-name><surname>Zhao</surname><given-names>NQ</given-names></string-name>, <etal>et al.</etal></person-group><article-title>A single-cell atlas of the peripheral immune response in patients with severe Covid-19</article-title>. <source>Nat Med</source><year>2020</year>;<volume>26</volume>:<fpage>1070</fpage>–<lpage>6</lpage>.<pub-id pub-id-type="pmid">32514174</pub-id></mixed-citation>
    </ref>
    <ref id="ref12">
      <label>12.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Guo</surname><given-names>L</given-names></string-name>, <string-name><surname>Lin</surname><given-names>L</given-names></string-name>, <string-name><surname>Wang</surname><given-names>X</given-names></string-name>, <etal>et al.</etal></person-group><article-title>Resolving cell fate decisions during somatic cell reprogramming by single-cell RNA-seq</article-title>. <source>Mol Cell</source><year>2019</year>;<volume>73</volume>:<fpage>815</fpage>–<lpage>829.e7</lpage>.<pub-id pub-id-type="pmid">30772174</pub-id></mixed-citation>
    </ref>
    <ref id="ref13">
      <label>13.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Ianevski</surname><given-names>A</given-names></string-name>, <string-name><surname>Giri</surname><given-names>AK</given-names></string-name>, <string-name><surname>Aittokallio</surname><given-names>T</given-names></string-name></person-group>. <article-title>Fully-automated and ultra-fast cell-type identification using specific marker combinations from single-cell transcriptomic data</article-title>. <source>Nat Commun</source><year>2022</year>;<volume>13</volume>:<fpage>1</fpage>–<lpage>10</lpage>.<pub-id pub-id-type="pmid">34983933</pub-id></mixed-citation>
    </ref>
    <ref id="ref14">
      <label>14.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Pasquini</surname><given-names>G</given-names></string-name>, <string-name><surname>Arias</surname><given-names>JER</given-names></string-name>, <string-name><surname>Schäfer</surname><given-names>P</given-names></string-name>, <string-name><surname>Busskamp</surname><given-names>V</given-names></string-name></person-group>. <article-title>Automated methods for cell type annotation on scRNA-seq data</article-title>. <source>Comput Struct Biotechnol J</source><year>2021</year>;<volume>19</volume>:<fpage>961</fpage>–<lpage>9</lpage>.<pub-id pub-id-type="pmid">33613863</pub-id></mixed-citation>
    </ref>
    <ref id="ref15">
      <label>15.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Han</surname><given-names>W</given-names></string-name>, <string-name><surname>Cheng</surname><given-names>Y</given-names></string-name>, <string-name><surname>Chen</surname><given-names>J</given-names></string-name>, <etal>et al.</etal></person-group><article-title>Self-supervised contrastive learning for integrative single cell RNA-seq data analysis</article-title>. <source>Brief Bioinform</source><year>2022</year>;<volume>23</volume>.</mixed-citation>
    </ref>
    <ref id="ref16">
      <label>16.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Cheng</surname><given-names>Y</given-names></string-name>, <string-name><surname>Fan</surname><given-names>X</given-names></string-name>, <string-name><surname>Zhang</surname><given-names>J</given-names></string-name>, <string-name><surname>Li</surname><given-names>Y</given-names></string-name></person-group>. <article-title>A scalable sparse neural network framework for rare cell type annotation of single-cell transcriptome data</article-title>. <source>Commun Biol</source><year>2023</year>;<volume>6</volume>:<fpage>545</fpage>.<pub-id pub-id-type="pmid">37210444</pub-id></mixed-citation>
    </ref>
    <ref id="ref17">
      <label>17.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Huang</surname><given-names>EH</given-names></string-name>, <string-name><surname>Heidt</surname><given-names>DG</given-names></string-name>, <string-name><surname>Li</surname><given-names>C-W</given-names></string-name>, <string-name><surname>Simeone</surname><given-names>DM</given-names></string-name></person-group>. <article-title>Cancer stem cells: a new paradigm for understanding tumor progression and therapeutic resistance</article-title>. <source>Surgery</source><year>2007</year>;<volume>141</volume>:<fpage>415</fpage>–<lpage>9</lpage>.<pub-id pub-id-type="pmid">17383517</pub-id></mixed-citation>
    </ref>
    <ref id="ref18">
      <label>18.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Garraway</surname><given-names>LA</given-names></string-name>, <string-name><surname>Jänne</surname><given-names>PA</given-names></string-name></person-group>. <article-title>Circumventing cancer drug resistance in the era of personalized medicine</article-title>. <source>Cancer Discov</source><year>2012</year>;<volume>2</volume>:<fpage>214</fpage>–<lpage>26</lpage>.<pub-id pub-id-type="pmid">22585993</pub-id></mixed-citation>
    </ref>
    <ref id="ref19">
      <label>19.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Krepler</surname><given-names>C</given-names></string-name>, <string-name><surname>Xiao</surname><given-names>M</given-names></string-name>, <string-name><surname>Sproesser</surname><given-names>K</given-names></string-name>, <etal>et al.</etal></person-group><article-title>Personalized preclinical trials in BRAF inhibitor–resistant patient-derived xenograft models identify second-line combination therapies</article-title>. <source>Clin Cancer Res</source><year>2016</year>;<volume>22</volume>:<fpage>1592</fpage>–<lpage>602</lpage>.<pub-id pub-id-type="pmid">26673799</pub-id></mixed-citation>
    </ref>
    <ref id="ref20">
      <label>20.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Butler</surname><given-names>A</given-names></string-name>, <string-name><surname>Hoffman</surname><given-names>P</given-names></string-name>, <string-name><surname>Smibert</surname><given-names>P</given-names></string-name>, <etal>et al.</etal></person-group><article-title>Integrating single-cell transcriptomic data across different conditions, technologies, and species</article-title>. <source>Nat Biotechnol</source><year>2018</year>;<volume>36</volume>:<fpage>411</fpage>–<lpage>20</lpage>.<pub-id pub-id-type="pmid">29608179</pub-id></mixed-citation>
    </ref>
    <ref id="ref21">
      <label>21.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Wolf</surname><given-names>FA</given-names></string-name>, <string-name><surname>Angerer</surname><given-names>P</given-names></string-name>, <string-name><surname>Theis</surname><given-names>FJ</given-names></string-name></person-group>. <article-title>SCANPY: large-scale single-cell gene expression data analysis</article-title>. <source>Genome Biol</source><year>2018</year>;<volume>19</volume>:<fpage>1</fpage>–<lpage>5</lpage>.<pub-id pub-id-type="pmid">29301551</pub-id></mixed-citation>
    </ref>
    <ref id="ref22">
      <label>22.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Tan</surname><given-names>Y</given-names></string-name>, <string-name><surname>Cahan</surname><given-names>P</given-names></string-name></person-group>. <article-title>SingleCellNet: a computational tool to classify single cell RNA-seq data across platforms and across species</article-title>. <source>Cell Syst</source><year>2019</year>;<volume>9</volume>:<fpage>207</fpage>–<lpage>213.e2</lpage>.<pub-id pub-id-type="pmid">31377170</pub-id></mixed-citation>
    </ref>
    <ref id="ref23">
      <label>23.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Aran</surname><given-names>D</given-names></string-name>, <string-name><surname>Looney</surname><given-names>AP</given-names></string-name>, <string-name><surname>Liu</surname><given-names>L</given-names></string-name>, <etal>et al.</etal></person-group><article-title>Reference-based analysis of lung single-cell sequencing reveals a transitional profibrotic macrophage</article-title>. <source>Nat Immunol</source><year>2019</year>;<volume>20</volume>:<fpage>163</fpage>–<lpage>72</lpage>.<pub-id pub-id-type="pmid">30643263</pub-id></mixed-citation>
    </ref>
    <ref id="ref24">
      <label>24.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Lopez</surname><given-names>R</given-names></string-name>, <string-name><surname>Regier</surname><given-names>J</given-names></string-name>, <string-name><surname>Cole</surname><given-names>MB</given-names></string-name>, <etal>et al.</etal></person-group><article-title>Deep generative modeling for single-cell transcriptomics</article-title>. <source>Nat Methods</source><year>2018</year>;<volume>15</volume>:<fpage>1053</fpage>–<lpage>8</lpage>.<pub-id pub-id-type="pmid">30504886</pub-id></mixed-citation>
    </ref>
    <ref id="ref25">
      <label>25.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Kiselev</surname><given-names>VY</given-names></string-name>, <string-name><surname>Yiu</surname><given-names>A</given-names></string-name>, <string-name><surname>Hemberg</surname><given-names>M</given-names></string-name></person-group>. <article-title>scmap: projection of single-cell RNA-seq data across data sets</article-title>. <source>Nat Methods</source><year>2018</year>;<volume>15</volume>:<fpage>359</fpage>–<lpage>62</lpage>.<pub-id pub-id-type="pmid">29608555</pub-id></mixed-citation>
    </ref>
    <ref id="ref26">
      <label>26.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Alquicira-Hernandez</surname><given-names>J</given-names></string-name>, <string-name><surname>Sathe</surname><given-names>A</given-names></string-name>, <string-name><surname>Ji</surname><given-names>HP</given-names></string-name>, <etal>et al.</etal></person-group><article-title>scPRED: accurate supervised method for cell-type classification from single-cell RNA-seq data</article-title>. <source>Genome Biol</source><year>2019</year>;<volume>20</volume>:<fpage>1</fpage>–<lpage>17</lpage>.<pub-id pub-id-type="pmid">30606230</pub-id></mixed-citation>
    </ref>
    <ref id="ref27">
      <label>27.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Duan</surname><given-names>B</given-names></string-name>, <etal>et al.</etal></person-group><article-title>Learning for single-cell assignment</article-title>. <source>Sci Adv</source><year>2020</year>;<volume>6</volume>:<fpage>eabd0855</fpage>.<pub-id pub-id-type="pmid">33127686</pub-id></mixed-citation>
    </ref>
    <ref id="ref28">
      <label>28.</label>
      <mixed-citation publication-type="book"><person-group person-group-type="author"><string-name><surname>Xanthopoulos</surname><given-names>P</given-names></string-name>, <string-name><surname>Pardalos</surname><given-names>PM</given-names></string-name>, <string-name><surname>Trafalis</surname><given-names>TB</given-names></string-name></person-group>. <article-title>Principal component analysis</article-title>. In: <source>Robust Data Mining</source>.
<publisher-name>Springer</publisher-name>. Springer Science &amp; Business Media <year>2013</year>, <fpage>21</fpage>–<lpage>6</lpage>.</mixed-citation>
    </ref>
    <ref id="ref29">
      <label>29.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Ren</surname><given-names>X</given-names></string-name>, <string-name><surname>Wen</surname><given-names>W</given-names></string-name>, <string-name><surname>Fan</surname><given-names>X</given-names></string-name>, <etal>et al.</etal></person-group><article-title>Covid-19 immune features revealed by a large-scale single-cell transcriptome atlas</article-title>. <source>Cell</source><year>2021</year>;<volume>184</volume>:<fpage>1895</fpage>–<lpage>1913.e19</lpage>.<pub-id pub-id-type="pmid">33657410</pub-id></mixed-citation>
    </ref>
    <ref id="ref30">
      <label>30.</label>
      <mixed-citation publication-type="other"><person-group person-group-type="author"><string-name><surname>Davis</surname><given-names>J</given-names></string-name>, <string-name><surname>Goadrich</surname><given-names>M</given-names></string-name></person-group><article-title>The relationship between precision-recall and ROC curves</article-title>. In <source><italic toggle="yes">Proceedings of the 23rd international conference on Machine learning</italic></source>. Pennsylvania, USA: MIT Press, <year>2006</year>, <fpage>pp. 233</fpage>–<lpage>240</lpage>.</mixed-citation>
    </ref>
    <ref id="ref31">
      <label>31.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Velmeshev</surname><given-names>D</given-names></string-name>, <string-name><surname>Schirmer</surname><given-names>L</given-names></string-name>, <string-name><surname>Jung</surname><given-names>D</given-names></string-name>, <etal>et al.</etal></person-group><article-title>Single-cell genomics identifies cell type–specific molecular changes in autism</article-title>. <source>Science</source><year>2019</year>;<volume>364</volume>:<fpage>685</fpage>–<lpage>9</lpage>.<pub-id pub-id-type="pmid">31097668</pub-id></mixed-citation>
    </ref>
    <ref id="ref32">
      <label>32.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Melms</surname><given-names>JC</given-names></string-name>, <string-name><surname>Biermann</surname><given-names>J</given-names></string-name>, <string-name><surname>Huang</surname><given-names>H</given-names></string-name>, <etal>et al.</etal></person-group><article-title>A molecular single-cell lung atlas of lethal Covid-19</article-title>. <source>Nature</source><year>2021</year>;<volume>595</volume>:<fpage>114</fpage>–<lpage>9</lpage>.<pub-id pub-id-type="pmid">33915568</pub-id></mixed-citation>
    </ref>
    <ref id="ref33">
      <label>33.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Giovannoni</surname><given-names>F</given-names></string-name>, <string-name><surname>Li</surname><given-names>Z</given-names></string-name>, <string-name><surname>Remes-Lenicov</surname><given-names>F</given-names></string-name>, <etal>et al.</etal></person-group><article-title>AHR signaling is induced by infection with Coronaviruses</article-title>. <source>Nat Commun</source><year>2021</year>;<volume>12</volume>:<fpage>1</fpage>–<lpage>12</lpage>.<pub-id pub-id-type="pmid">33397941</pub-id></mixed-citation>
    </ref>
    <ref id="ref34">
      <label>34.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Delorey</surname><given-names>TM</given-names></string-name>, <string-name><surname>Ziegler</surname><given-names>CGK</given-names></string-name>, <string-name><surname>Heimberg</surname><given-names>G</given-names></string-name>, <etal>et al.</etal></person-group><article-title>Covid-19 tissue atlases reveal SARS-CoV-2 pathology and cellular targets</article-title>. <source>Nature</source><year>2021</year>;<volume>595</volume>:<fpage>107</fpage>–<lpage>13</lpage>.<pub-id pub-id-type="pmid">33915569</pub-id></mixed-citation>
    </ref>
    <ref id="ref35">
      <label>35.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Sacco</surname><given-names>K</given-names></string-name>, <string-name><surname>Castagnoli</surname><given-names>R</given-names></string-name>, <string-name><surname>Vakkilainen</surname><given-names>S</given-names></string-name>, <etal>et al.</etal></person-group><article-title>Immunopathological signatures in multisystem inflammatory syndrome in children and pediatric Covid-19</article-title>. <source>Nat Med</source><year>2022</year>;<volume>28</volume>:<fpage>1050</fpage>–<lpage>62</lpage>.<pub-id pub-id-type="pmid">35177862</pub-id></mixed-citation>
    </ref>
    <ref id="ref36">
      <label>36.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Amrute</surname><given-names>JM</given-names></string-name>, <string-name><surname>Perry</surname><given-names>AM</given-names></string-name>, <string-name><surname>Anand</surname><given-names>G</given-names></string-name>, <etal>et al.</etal></person-group><article-title>Cell specific peripheral immune responses predict survival in critical Covid-19 patients</article-title>. <source>Nat Commun</source><year>2022</year>;<volume>13</volume>:<fpage>1</fpage>–<lpage>11</lpage>.<pub-id pub-id-type="pmid">34983933</pub-id></mixed-citation>
    </ref>
    <ref id="ref37">
      <label>37.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Huang</surname><given-names>K</given-names></string-name>, <string-name><surname>Wang</surname><given-names>C</given-names></string-name>, <string-name><surname>Vagts</surname><given-names>C</given-names></string-name>, <etal>et al.</etal></person-group><article-title>Long non-coding RNAs (lncRNAs) NEAT1 and MALAT1 are differentially expressed in severe Covid-19 patients: an integrated single-cell analysis</article-title>. <source>PloS One</source><year>2022</year>;<volume>17</volume>:e0261242.</mixed-citation>
    </ref>
    <ref id="ref38">
      <label>38.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Baggen</surname><given-names>J</given-names></string-name>, <string-name><surname>Persoons</surname><given-names>L</given-names></string-name>, <string-name><surname>Vanstreels</surname><given-names>E</given-names></string-name>, <etal>et al.</etal></person-group><article-title>Genome-wide CRISPR screening identifies TMEM106B as a proviral host factor for SARS-CoV-2</article-title>. <source>Nat Genet</source><year>2021</year>;<volume>53</volume>:<fpage>435</fpage>–<lpage>44</lpage>.<pub-id pub-id-type="pmid">33686287</pub-id></mixed-citation>
    </ref>
    <ref id="ref39">
      <label>39.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Ruan</surname><given-names>D</given-names></string-name>, <string-name><surname>Ye</surname><given-names>ZW</given-names></string-name>, <string-name><surname>Yuan</surname><given-names>S</given-names></string-name>, <etal>et al.</etal></person-group><article-title>Human early syncytiotrophoblasts are highly susceptible to SARS-CoV-2 infection</article-title>. <source>Cell Rep Med</source><year>2022</year>;<volume>3</volume>:<fpage>100849</fpage>.<pub-id pub-id-type="pmid">36495872</pub-id></mixed-citation>
    </ref>
    <ref id="ref40">
      <label>40.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Darmanis</surname><given-names>S</given-names></string-name>, <string-name><surname>Sloan</surname><given-names>SA</given-names></string-name>, <string-name><surname>Zhang</surname><given-names>Y</given-names></string-name>, <etal>et al.</etal></person-group><article-title>A survey of human brain transcriptome diversity at the single cell level</article-title>. <source>Proc Natl Acad Sci</source><year>2015</year>;<volume>112</volume>:<fpage>7285</fpage>–<lpage>90</lpage>.<pub-id pub-id-type="pmid">26060301</pub-id></mixed-citation>
    </ref>
    <ref id="ref41">
      <label>41.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Muraro</surname><given-names>MJ</given-names></string-name>, <string-name><surname>Dharmadhikari</surname><given-names>G</given-names></string-name>, <string-name><surname>Grün</surname><given-names>D</given-names></string-name>, <etal>et al.</etal></person-group><article-title>A single-cell transcriptome atlas of the human pancreas</article-title>. <source>Cell Syst</source><year>2016</year>;<volume>3</volume>:<fpage>385</fpage>–<lpage>394.e3</lpage>.<pub-id pub-id-type="pmid">27693023</pub-id></mixed-citation>
    </ref>
    <ref id="ref42">
      <label>42.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Baron</surname><given-names>M</given-names></string-name>, <string-name><surname>Veres</surname><given-names>A</given-names></string-name>, <string-name><surname>Wolock</surname><given-names>SL</given-names></string-name>, <etal>et al.</etal></person-group><article-title>A single-cell transcriptomic map of the human and mouse pancreas reveals inter-and intra-cell population structure</article-title>. <source>Cell Syst</source><year>2016</year>;<volume>3</volume>:<fpage>346</fpage>–<lpage>360.e4</lpage>.<pub-id pub-id-type="pmid">27667365</pub-id></mixed-citation>
    </ref>
    <ref id="ref43">
      <label>43.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Ding</surname><given-names>J</given-names></string-name>, <string-name><surname>Adiconis</surname><given-names>X</given-names></string-name>, <string-name><surname>Simmons</surname><given-names>SK</given-names></string-name>, <etal>et al.</etal></person-group><article-title>Systematic comparison of single-cell and single-nucleus RNA-sequencing methods</article-title>. <source>Nat Biotechnol</source><year>2020</year>;<volume>38</volume>:<fpage>737</fpage>–<lpage>46</lpage>.<pub-id pub-id-type="pmid">32341560</pub-id></mixed-citation>
    </ref>
    <ref id="ref44">
      <label>44.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Campbell</surname><given-names>JN</given-names></string-name>, <string-name><surname>Macosko</surname><given-names>EZ</given-names></string-name>, <string-name><surname>Fenselau</surname><given-names>H</given-names></string-name>, <etal>et al.</etal></person-group><article-title>A molecular census of arcuate hypothalamus and median eminence cell types</article-title>. <source>Nat Neurosci</source><year>2017</year>;<volume>20</volume>:<fpage>484</fpage>–<lpage>96</lpage>.<pub-id pub-id-type="pmid">28166221</pub-id></mixed-citation>
    </ref>
    <ref id="ref45">
      <label>45.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Zilionis</surname><given-names>R</given-names></string-name>, <string-name><surname>Engblom</surname><given-names>C</given-names></string-name>, <string-name><surname>Pfirschke</surname><given-names>C</given-names></string-name>, <etal>et al.</etal></person-group><article-title>Single-cell transcriptomics of human and mouse lung cancers reveals conserved myeloid populations across individuals and species</article-title>. <source>Immunity</source><year>2019</year>;<volume>50</volume>:<fpage>1317</fpage>–<lpage>1334.e10</lpage>.<pub-id pub-id-type="pmid">30979687</pub-id></mixed-citation>
    </ref>
    <ref id="ref46">
      <label>46.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Schaum</surname><given-names>N</given-names></string-name>, <etal>et al.</etal></person-group><article-title>Single-cell transcriptomics of 20 mouse organs creates a Tabula Muris: the Tabula Muris consortium</article-title>. <source>Nature</source><year>2018</year>;<volume>562</volume>:<fpage>367</fpage>–<lpage>72</lpage>.<pub-id pub-id-type="pmid">30283141</pub-id></mixed-citation>
    </ref>
    <ref id="ref47">
      <label>47.</label>
      <mixed-citation publication-type="other"><person-group person-group-type="author"><string-name><surname>Liang</surname><given-names>S</given-names></string-name>, <string-name><surname>Li</surname><given-names>Y</given-names></string-name>, <string-name><surname>Srikant</surname><given-names>R</given-names></string-name></person-group><article-title>Enhancing the reliability of out-of-distribution image detection in neural networks</article-title>. In: <source>International Conference on Learning Representations</source>. Vancouver, Canada: Openreview.net, <year>2018</year>.</mixed-citation>
    </ref>
    <ref id="ref48">
      <label>48.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Fawcett</surname><given-names>T</given-names></string-name></person-group>. <article-title>An introduction to ROC analysis</article-title>. <source>Pattern Recogn Lett</source><year>2006</year>;<volume>27</volume>:<fpage>861</fpage>–<lpage>74</lpage>.</mixed-citation>
    </ref>
    <ref id="ref49">
      <label>49.</label>
      <mixed-citation publication-type="book"><person-group person-group-type="author"><string-name><surname>Manning</surname><given-names>C</given-names></string-name>, <string-name><surname>Schutze</surname><given-names>H</given-names></string-name></person-group>. <source>Foundations of Statistical Natural Language Processing</source>.USA,
<publisher-name>MIT press</publisher-name>, <year>1999</year>.</mixed-citation>
    </ref>
    <ref id="ref50">
      <label>50.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Saito</surname><given-names>T</given-names></string-name>, <string-name><surname>Rehmsmeier</surname><given-names>M</given-names></string-name></person-group>. <article-title>The precision-recall plot is more informative than the ROC plot when evaluating binary classifiers on imbalanced datasets</article-title>. <source>PloS One</source><year>2015</year>;<volume>10</volume>:e0118432.</mixed-citation>
    </ref>
    <ref id="ref51">
      <label>51.</label>
      <mixed-citation publication-type="other"><person-group person-group-type="author"><string-name><surname>Zhong</surname>, <given-names>Z.</given-names></string-name>, <string-name><surname>Cui</surname>, <given-names>J.</given-names></string-name>, <string-name><surname>Liu</surname>, <given-names>S.</given-names></string-name> &amp; <string-name><surname>Jia</surname>, <given-names>J.</given-names></string-name></person-group><article-title>Improving calibration for long-tailed recognition</article-title>. In: <source>Proceedings of the IEEE CVF Conference on Computer Vision and Pattern Recognition</source>. Nashville, USA: Institute of Electrical and Electronics Engineers, <year>2021</year>, pp. <fpage>16489</fpage>–<lpage>16498</lpage>.</mixed-citation>
    </ref>
    <ref id="ref52">
      <label>52.</label>
      <mixed-citation publication-type="other"><person-group person-group-type="author"><string-name><surname>Samuel</surname>, <given-names>D.</given-names></string-name> &amp; <string-name><surname>Chechik</surname>, <given-names>G.</given-names></string-name></person-group><article-title>Distributional robustness loss for long-tail learning</article-title>. In: <source>Proceedings of the IEEE CVF International Conference on Computer Vision</source>. Montreal, Canada: Institute of Electrical and Electronics Engineers, <year>2021</year>, pp. <fpage>9495</fpage>–<lpage>9504</lpage>.</mixed-citation>
    </ref>
    <ref id="ref53">
      <label>53.</label>
      <mixed-citation publication-type="other"><person-group person-group-type="author"><string-name><surname>Hendrycks</surname>, <given-names>D.</given-names></string-name> &amp; <string-name><surname>Gimpel</surname>, <given-names>K.</given-names></string-name></person-group><article-title>A baseline for detecting misclassified and out-of-distribution examples in neural networks</article-title>. <source>International Conference on Learning Representations</source>. Toulon, France: Openreviewer.net, <year>2017</year>.</mixed-citation>
    </ref>
    <ref id="ref54">
      <label>54.</label>
      <mixed-citation publication-type="other"><person-group person-group-type="author"><string-name><surname>Loshchilov</surname>, <given-names>I.</given-names></string-name> &amp; <string-name><surname>Hutter</surname>, <given-names>F.</given-names></string-name></person-group><article-title>Decoupled weight decay regularization</article-title>. In: <source>International Conference on Learning Representations</source>. New Orleans, USA: Openreview.net, <year>2019</year>.</mixed-citation>
    </ref>
  </ref-list>
  <app-group>
    <app id="app1a">
      <title>APPENDIX</title>
    </app>
    <app id="app1">
      <title>A. Datasets and preprocessings</title>
      <p>In this work, we considered a total of 15 single-cell expression datasets from small scale (<inline-formula><tex-math notation="LaTeX" id="ImEquation129">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\sim $\end{document}</tex-math></inline-formula>1k cells) to large scale (<inline-formula><tex-math notation="LaTeX" id="ImEquation130">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\sim $\end{document}</tex-math></inline-formula>1.5m cells). Detailed information on cell numbers, class numbers, sequencing protocols and sources of each dataset is shown in <xref rid="TB1" ref-type="table">Appendix Table 1</xref>. We incorporated datasets with different complexity and sequencing protocols to show the effectiveness and generalization of our proposed scNovel. We obtain the corresponding cell-type labels from their original paper to achieve the learning in a supervised manner.</p>
      <p>All of these labeled single-cell profiles went through the same preprocessing procedure to achieve more precise prediction results. To mitigate the impact of outlier genes, log transformation and normalization steps were implemented following the standard preprocessing pipeline outlined in the Scanpy [<xref rid="ref21" ref-type="bibr">21</xref>] tutorial, where the scale parameter was manually adjusted in the normalization function. We then split all the datasets using the following steps: (1) select the single-cell sequences of the top <inline-formula><tex-math notation="LaTeX" id="ImEquation131">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$C^{novel} \in \mathbb{N}^{+}$\end{document}</tex-math></inline-formula> most rare cell types from the dataset and utilize them to build <inline-formula><tex-math notation="LaTeX" id="ImEquation132">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\mathcal{D}_{query}^{novel}$\end{document}</tex-math></inline-formula>; (2) utilize 75% of the remaining data as <inline-formula><tex-math notation="LaTeX" id="ImEquation133">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\mathcal{D}_{ref}$\end{document}</tex-math></inline-formula>, and the other 25% of the remaining data as <inline-formula><tex-math notation="LaTeX" id="ImEquation134">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\mathcal{D}_{query}^{typical}$\end{document}</tex-math></inline-formula>; and (3) the <inline-formula><tex-math notation="LaTeX" id="ImEquation135">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\mathcal{D}_{ref}$\end{document}</tex-math></inline-formula> is employed for the reference set, while <inline-formula><tex-math notation="LaTeX" id="ImEquation136">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\mathcal{D}_{query}^{typical}$\end{document}</tex-math></inline-formula> and <inline-formula><tex-math notation="LaTeX" id="ImEquation137">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\mathcal{D}_{query}^{novel}$\end{document}</tex-math></inline-formula> are combined to build query set <inline-formula><tex-math notation="LaTeX" id="ImEquation138">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\mathcal{D}_{query}$\end{document}</tex-math></inline-formula>.</p>
    </app>
    <app id="app2">
      <title>B. Evaluation metrics</title>
      <p>We adopt the following three metrics to measure the performance of different models on the novel rare cell discovery task. A better model should have lower FPR95, higher AUROC and higher AUPR, following the previous works [<xref rid="ref26" ref-type="bibr">26</xref>, <xref rid="ref47" ref-type="bibr">47</xref>]. The AUROC is the most important evaluation metric as our dataset is imbalanced:</p>
      <list list-type="simple">
        <list-item>
          <p>(1) <bold>FPR95</bold>: FPR at 95% TPR is the probability that a negative sample (novel sample) is misclassified as a positive sample (typical sample) when the TPR is 95%.</p>
        </list-item>
        <list-item>
          <p>(2) <bold>AUROC</bold>: AUROC is the Area Under the Receiver Operating Characteristic curve, which is a threshold independent metric [<xref rid="ref30" ref-type="bibr">30</xref>]. The AUROC shows the relationship between TPR and FPR. It could be interpreted as the probability that a positive sample has a higher score than a negative sample [<xref rid="ref48" ref-type="bibr">48</xref>].</p>
        </list-item>
        <list-item>
          <p>(3) <bold>AUPR</bold>: AUPR is the Area Under the Precision-Recall curve, which is also a threshold independent metric [<xref rid="ref49" ref-type="bibr">49</xref>, <xref rid="ref50" ref-type="bibr">50</xref>]. It depicts the relationship between precision =<inline-formula><tex-math notation="LaTeX" id="ImEquation139">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\frac{TP}{TP+FP}$\end{document}</tex-math></inline-formula>and recall=<inline-formula><tex-math notation="LaTeX" id="ImEquation140">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\frac{TP}{TP+FN}$\end{document}</tex-math></inline-formula>. The AUPR is high in our experiments because the amount of novel cells is small compared to typical cells.</p>
        </list-item>
      </list>
    </app>
    <app id="app3">
      <title>C. Appendix methods</title>
      <sec id="app3a">
        <title>C.1 Neural network for rare cell feature extraction</title>
        <p>To better extract input features, we employ a neural network classifier. The single-cell transcriptome data are processed by a neural network classifier <inline-formula><tex-math notation="LaTeX" id="ImEquation141">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$f$\end{document}</tex-math></inline-formula> to get prediction probability <inline-formula><tex-math notation="LaTeX" id="ImEquation142">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$p(\boldsymbol{x})$\end{document}</tex-math></inline-formula>. The classifier has several hidden layers, whose structure is shown in <xref rid="f7" ref-type="fig">Appendix Figure 1</xref>. Besides a Fully-Connected Layer (FC) in each hidden layer, we utilize batch normalization (BN), Exponential Linear Unit (ELU) activation function and dropout sequentially to speed up training, avoid overfitting and elevate predictive performance. Our network design encompasses architecture, activation functions, and loss functions that are consistent with methodologies applied in similar studies focusing on rare cells and classes with limited quantities [<xref rid="ref16" ref-type="bibr">16</xref>, <xref rid="ref51" ref-type="bibr">51</xref>, <xref rid="ref52" ref-type="bibr">52</xref>]. This alignment underscores our commitment to precisely handling rare cells to enhance feature extraction and improve performance: </p>
        <disp-formula id="deqn01">
          <label>(C.1)</label>
          <tex-math notation="LaTeX" id="DmEquation1">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
\begin{align*}&amp; \begin{split} \boldsymbol{x}^{l-1}_{BN}&amp;=BN(\boldsymbol{x}^{l-1}),\\ \boldsymbol{x}^{l-1}_{ELU}&amp;=ELU(\boldsymbol{x}^{l-1}_{BN}),\\ \boldsymbol{x}^{l-1}_{Dropout}&amp;=Dropout(\boldsymbol{x}^{l-1}_{ELU}), \end{split}\end{align*}\end{document}</tex-math>
        </disp-formula>
        <p>where <inline-formula><tex-math notation="LaTeX" id="ImEquation143">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\boldsymbol{x}^{l-1}$\end{document}</tex-math></inline-formula> is the feature output of the <inline-formula><tex-math notation="LaTeX" id="ImEquation144">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$(l-1)$\end{document}</tex-math></inline-formula>th FC layer; ELU processes features with Equation (<xref rid="deqn02" ref-type="disp-formula">C.2</xref>) </p>
        <disp-formula id="deqn02">
          <label>(C.2)</label>
          <tex-math notation="LaTeX" id="DmEquation2">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
\begin{align*}&amp; ELU(\boldsymbol{x})=\left\{ \begin{array}{@{}lr} x,\quad if\ \boldsymbol{x} \geq 0, &amp;\\ \alpha e(e^{\boldsymbol{x}}-1),\quad if\ \boldsymbol{x} &lt; 0. &amp;\\ \end{array} \right.\end{align*}\end{document}</tex-math>
        </disp-formula>
        <table-wrap position="anchor" id="TB1">
          <label>Appendix Table 1</label>
          <caption>
            <p>Datasets considered</p>
          </caption>
          <table frame="hsides" rules="groups">
            <colgroup span="1">
              <col span="1" align="left"/>
              <col span="1" align="left"/>
              <col span="1" align="left"/>
              <col span="1" align="left"/>
              <col span="1" align="left"/>
            </colgroup>
            <thead>
              <tr>
                <th align="left" rowspan="1" colspan="1">Datasets</th>
                <th align="left" rowspan="1" colspan="1">Cell numbers</th>
                <th align="left" rowspan="1" colspan="1">Class numbers</th>
                <th align="left" rowspan="1" colspan="1">Protocols</th>
                <th align="left" rowspan="1" colspan="1">Source</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td rowspan="1" colspan="1">Darmains</td>
                <td rowspan="1" colspan="1">466</td>
                <td rowspan="1" colspan="1">9</td>
                <td rowspan="1" colspan="1">SMARTer</td>
                <td rowspan="1" colspan="1">Darmains <italic toggle="yes">et al</italic>. [<xref rid="ref40" ref-type="bibr">40</xref>]</td>
              </tr>
              <tr>
                <td rowspan="1" colspan="1">Muraro</td>
                <td rowspan="1" colspan="1">2122</td>
                <td rowspan="1" colspan="1">9</td>
                <td rowspan="1" colspan="1">Cel-Seq2</td>
                <td rowspan="1" colspan="1">Muraro <italic toggle="yes">et al</italic>. [<xref rid="ref41" ref-type="bibr">41</xref>]</td>
              </tr>
              <tr>
                <td rowspan="1" colspan="1">Baron Mouse</td>
                <td rowspan="1" colspan="1">1886</td>
                <td rowspan="1" colspan="1">13</td>
                <td rowspan="1" colspan="1">inDrop</td>
                <td rowspan="1" colspan="1">Baron <italic toggle="yes">et al</italic>. [<xref rid="ref42" ref-type="bibr">42</xref>]</td>
              </tr>
              <tr>
                <td rowspan="1" colspan="1">Baron Human</td>
                <td rowspan="1" colspan="1">8569</td>
                <td rowspan="1" colspan="1">14</td>
                <td rowspan="1" colspan="1">inDrop</td>
                <td rowspan="1" colspan="1">Baron <italic toggle="yes">et al</italic>. [<xref rid="ref42" ref-type="bibr">42</xref>]</td>
              </tr>
              <tr>
                <td rowspan="1" colspan="1">Seq-Well</td>
                <td rowspan="1" colspan="1">18 966</td>
                <td rowspan="1" colspan="1">7</td>
                <td rowspan="1" colspan="1">Seq-Well</td>
                <td rowspan="1" colspan="1">Ding <italic toggle="yes">et al</italic>. [<xref rid="ref43" ref-type="bibr">43</xref>]</td>
              </tr>
              <tr>
                <td rowspan="1" colspan="1">Campbell</td>
                <td rowspan="1" colspan="1">21 086</td>
                <td rowspan="1" colspan="1">35</td>
                <td rowspan="1" colspan="1">Drop-Seq</td>
                <td rowspan="1" colspan="1">Campbell <italic toggle="yes">et al</italic>. [<xref rid="ref44" ref-type="bibr">44</xref>]</td>
              </tr>
              <tr>
                <td rowspan="1" colspan="1">Zilionis</td>
                <td rowspan="1" colspan="1">34 558</td>
                <td rowspan="1" colspan="1">9</td>
                <td rowspan="1" colspan="1">inDrop</td>
                <td rowspan="1" colspan="1">Zilionis <italic toggle="yes">et al</italic>. [<xref rid="ref45" ref-type="bibr">45</xref>]</td>
              </tr>
              <tr>
                <td rowspan="1" colspan="1">TM</td>
                <td rowspan="1" colspan="1">54 865</td>
                <td rowspan="1" colspan="1">55</td>
                <td rowspan="1" colspan="1">10X Genomics</td>
                <td rowspan="1" colspan="1">Schaum <italic toggle="yes">et al</italic>. [<xref rid="ref46" ref-type="bibr">46</xref>]</td>
              </tr>
              <tr>
                <td rowspan="1" colspan="1">PbmcBench 10X (V2)</td>
                <td rowspan="1" colspan="1">23 154</td>
                <td rowspan="1" colspan="1">9</td>
                <td rowspan="1" colspan="1">10X Genomics (v2)</td>
                <td rowspan="1" colspan="1">Ding <italic toggle="yes">et al</italic>. [<xref rid="ref43" ref-type="bibr">43</xref>]</td>
              </tr>
              <tr>
                <td rowspan="1" colspan="1">PbmcBench 10X (V3)</td>
                <td rowspan="1" colspan="1">19 690</td>
                <td rowspan="1" colspan="1">8</td>
                <td rowspan="1" colspan="1">10X Genomics (v3)</td>
                <td rowspan="1" colspan="1">Ding <italic toggle="yes">et al</italic>. [<xref rid="ref43" ref-type="bibr">43</xref>]</td>
              </tr>
              <tr>
                <td rowspan="1" colspan="1">PbmcBench (CEL-Seq)</td>
                <td rowspan="1" colspan="1">19 754</td>
                <td rowspan="1" colspan="1">7</td>
                <td rowspan="1" colspan="1">CEL-Seq2</td>
                <td rowspan="1" colspan="1">Ding <italic toggle="yes">et al</italic>. [<xref rid="ref43" ref-type="bibr">43</xref>]</td>
              </tr>
              <tr>
                <td rowspan="1" colspan="1">PbmcBench (Drop-Seq)</td>
                <td rowspan="1" colspan="1">23 154</td>
                <td rowspan="1" colspan="1">9</td>
                <td rowspan="1" colspan="1">Drop-Seq</td>
                <td rowspan="1" colspan="1">Ding <italic toggle="yes">et al</italic>. [<xref rid="ref43" ref-type="bibr">43</xref>]</td>
              </tr>
              <tr>
                <td rowspan="1" colspan="1">PbmcBench (inDrop)</td>
                <td rowspan="1" colspan="1">21 832</td>
                <td rowspan="1" colspan="1">7</td>
                <td rowspan="1" colspan="1">inDrop</td>
                <td rowspan="1" colspan="1">Ding <italic toggle="yes">et al</italic>. [<xref rid="ref43" ref-type="bibr">43</xref>]</td>
              </tr>
              <tr>
                <td rowspan="1" colspan="1">PKU-Covid Atlas</td>
                <td rowspan="1" colspan="1">1 462 702</td>
                <td rowspan="1" colspan="1">64</td>
                <td rowspan="1" colspan="1">10X Genomics</td>
                <td rowspan="1" colspan="1">Ren et al. [<xref rid="ref29" ref-type="bibr">29</xref>]</td>
              </tr>
              <tr>
                <td rowspan="1" colspan="1">GSE171524</td>
                <td rowspan="1" colspan="1">116 314</td>
                <td rowspan="1" colspan="1">19</td>
                <td rowspan="1" colspan="1">10X Genomics</td>
                <td rowspan="1" colspan="1">Melms et al. [<xref rid="ref32" ref-type="bibr">32</xref>]</td>
              </tr>
            </tbody>
          </table>
        </table-wrap>
        <fig position="anchor" id="f7">
          <label>Appendix Figure 1</label>
          <caption>
            <p>Detailed Framework of scNovel. The input <inline-formula><tex-math notation="LaTeX" id="ImEquation8">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\boldsymbol{x}$\end{document}</tex-math></inline-formula> is a single-cell gene expression. We employ a neural network to extract the single-cell feature. Then, map it <inline-formula><tex-math notation="LaTeX" id="ImEquation9">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$C^{ref}$\end{document}</tex-math></inline-formula> dimension to get cell-type probability prediction <inline-formula><tex-math notation="LaTeX" id="ImEquation10">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$p( \boldsymbol{x})$\end{document}</tex-math></inline-formula>. During the training stage, we employ the cross-entropy loss to optimize the network. We introduce two optional query stages, where barcode preprocessing is utilized to augment the predictive capabilities of scNovel. During the parallel query stage, <inline-formula><tex-math notation="LaTeX" id="ImEquation11">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$T_{plus}(x)$\end{document}</tex-math></inline-formula> and <inline-formula><tex-math notation="LaTeX" id="ImEquation12">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$T_{minus}(x)$\end{document}</tex-math></inline-formula> are obtained through different operations that composite the input <inline-formula><tex-math notation="LaTeX" id="ImEquation13">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\boldsymbol{x}$\end{document}</tex-math></inline-formula> and the processed barcode data to one vector. Then, at the sequential query stage, <inline-formula><tex-math notation="LaTeX" id="ImEquation14">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$T_{minus}(T_{plus}(x))$\end{document}</tex-math></inline-formula> is leveraged for further refinement of the barcode data. We define four modes of novel cell detection based on the proposed query stages.</p>
          </caption>
          <graphic xlink:href="bbae112fx1" position="float"/>
        </fig>
        <p>Given input <inline-formula><tex-math notation="LaTeX" id="ImEquation145">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\boldsymbol{x}$\end{document}</tex-math></inline-formula>, the proposed network process is defined as the following: </p>
        <disp-formula id="deqn03">
          <label>(C.3)</label>
          <tex-math notation="LaTeX" id="DmEquation3">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
\begin{align*}&amp; \begin{split} \boldsymbol{x}_{1}&amp;=InputLayer(\boldsymbol{x}),\quad\quad\quad \boldsymbol{x}_{2}=HiddenLayer_{1}(\boldsymbol{x}_{1}),\\ \boldsymbol{x}_{3}&amp;=HiddenLayer_{2}(\boldsymbol{x}_{2}),\quad \boldsymbol{x}_{4}=HiddenLayer_{3}(\boldsymbol{x}_{3}),\\ f(\boldsymbol{x})&amp;=FC(x_{4}),\quad\quad\quad\quad\quad p(\boldsymbol{x})=Softmax(f(\boldsymbol{x})), \end{split}\end{align*}\end{document}</tex-math>
        </disp-formula>
        <p>where <inline-formula><tex-math notation="LaTeX" id="ImEquation146">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\,\boldsymbol{x}_{1}$\end{document}</tex-math></inline-formula> is the feature output after <inline-formula><tex-math notation="LaTeX" id="ImEquation147">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$InputLayer$\end{document}</tex-math></inline-formula>; <inline-formula><tex-math notation="LaTeX" id="ImEquation148">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\boldsymbol{x}_{2}$\end{document}</tex-math></inline-formula>, <inline-formula><tex-math notation="LaTeX" id="ImEquation149">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\boldsymbol{x}_{3}$\end{document}</tex-math></inline-formula> and <inline-formula><tex-math notation="LaTeX" id="ImEquation150">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\boldsymbol{x}_{4}$\end{document}</tex-math></inline-formula> are the features after <inline-formula><tex-math notation="LaTeX" id="ImEquation151">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$HiddenLayer_{1}$\end{document}</tex-math></inline-formula>, <inline-formula><tex-math notation="LaTeX" id="ImEquation152">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$HiddenLayer_{2}$\end{document}</tex-math></inline-formula> and <inline-formula><tex-math notation="LaTeX" id="ImEquation153">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$HiddenLayer_{3}$\end{document}</tex-math></inline-formula> respectively; <inline-formula><tex-math notation="LaTeX" id="ImEquation154">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$f(\boldsymbol{x})$\end{document}</tex-math></inline-formula>, processed by FC, is the feature of input <inline-formula><tex-math notation="LaTeX" id="ImEquation155">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\boldsymbol{x}$\end{document}</tex-math></inline-formula>; <inline-formula><tex-math notation="LaTeX" id="ImEquation156">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$p(\boldsymbol{x})$\end{document}</tex-math></inline-formula> is the prediction probability. More details can be found in Appendix <xref rid="app3" ref-type="app">C</xref>.</p>
      </sec>
      <sec id="app3b">
        <title>C.2 Training stage</title>
        <p>scNovel takes a single-cell RNA expression matrix M as an input, where each column corresponds to a gene and each row corresponds to a cell. As shown in <xref rid="f7" ref-type="fig">Appendix Figure 1</xref>, we first consider a supervised multi-class classification task problem. We denote <inline-formula><tex-math notation="LaTeX" id="ImEquation157">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\mathcal{D}_{ref}=\{\boldsymbol{x_{i}},y_{i}\}_{i=1}^{n^{ref}}$\end{document}</tex-math></inline-formula> as the reference set with <inline-formula><tex-math notation="LaTeX" id="ImEquation158">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$C^{ref} \in \mathbb{N}^{+}$\end{document}</tex-math></inline-formula> cell types. <inline-formula><tex-math notation="LaTeX" id="ImEquation159">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\mathcal{X}$\end{document}</tex-math></inline-formula> represents the input space, while <inline-formula><tex-math notation="LaTeX" id="ImEquation160">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\mathcal{Y}=\{1,2...,C^{ref}\}$\end{document}</tex-math></inline-formula> signifies the label space with <inline-formula><tex-math notation="LaTeX" id="ImEquation161">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$C^{ref}$\end{document}</tex-math></inline-formula> classes. <inline-formula><tex-math notation="LaTeX" id="ImEquation162">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\mathcal{P}_{typical}$\end{document}</tex-math></inline-formula> and <inline-formula><tex-math notation="LaTeX" id="ImEquation163">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\mathcal{P}_{novel}$\end{document}</tex-math></inline-formula> represent the distribution of typical cells and novel cells. Given a dataset, with trainable parameter <inline-formula><tex-math notation="LaTeX" id="ImEquation164">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\theta \in \mathbb{R}^{p}$\end{document}</tex-math></inline-formula>, a classifier f: <inline-formula><tex-math notation="LaTeX" id="ImEquation165">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\mathcal{X} \rightarrow \mathbb{R}^{C^{ref}}$\end{document}</tex-math></inline-formula> maps an input to the output space <inline-formula><tex-math notation="LaTeX" id="ImEquation166">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\mathbb{R}^{C^{ref}}$\end{document}</tex-math></inline-formula>. Here, the cross-entropy loss is calculated for optimization: </p>
        <disp-formula id="deqn04">
          <label>(C.4)</label>
          <tex-math notation="LaTeX" id="DmEquation4">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
\begin{align*} &amp; p(\boldsymbol{x})=\operatorname{softmax}(f(\boldsymbol{x};\theta),j)=\frac{e^{f_{j}(\boldsymbol{x};\theta)/T}}{\sum_{i=1}^{k}e^{f_{i}(\boldsymbol{x};\theta)/T}},\end{align*}\end{document}</tex-math>
        </disp-formula>
        <disp-formula id="deqn05">
          <label>(C.5)</label>
          <tex-math notation="LaTeX" id="DmEquation5">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
\begin{align*}&amp; \mathcal{L}_{\mathrm{CE}}(f(x;\theta),y)=-\log p(y\lvert\boldsymbol{x})=-\log p_{y}(\boldsymbol{x}),\end{align*}\end{document}</tex-math>
        </disp-formula>
        <p>where input <inline-formula><tex-math notation="LaTeX" id="ImEquation167">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\boldsymbol{x}$\end{document}</tex-math></inline-formula> is the gene expression profile of a cell, which is a row of single-cell RNA expression matrix M; <inline-formula><tex-math notation="LaTeX" id="ImEquation168">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$f(\boldsymbol{x})$\end{document}</tex-math></inline-formula> is the feature of input <inline-formula><tex-math notation="LaTeX" id="ImEquation169">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\boldsymbol{x}$\end{document}</tex-math></inline-formula>; <inline-formula><tex-math notation="LaTeX" id="ImEquation170">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$f_{i}(\boldsymbol{x})$\end{document}</tex-math></inline-formula> is the <inline-formula><tex-math notation="LaTeX" id="ImEquation171">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$i^{th}$\end{document}</tex-math></inline-formula> element of <inline-formula><tex-math notation="LaTeX" id="ImEquation172">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$f(\boldsymbol{x})$\end{document}</tex-math></inline-formula>, given the label <inline-formula><tex-math notation="LaTeX" id="ImEquation173">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$i$\end{document}</tex-math></inline-formula>; <inline-formula><tex-math notation="LaTeX" id="ImEquation174">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$p(\boldsymbol{x})$\end{document}</tex-math></inline-formula> is the prediction probability of input <inline-formula><tex-math notation="LaTeX" id="ImEquation175">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\boldsymbol{x}$\end{document}</tex-math></inline-formula>; <inline-formula><tex-math notation="LaTeX" id="ImEquation176">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$p(y\lvert \boldsymbol{x})$\end{document}</tex-math></inline-formula> is <inline-formula><tex-math notation="LaTeX" id="ImEquation177">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$y^{th}$\end{document}</tex-math></inline-formula> element of <inline-formula><tex-math notation="LaTeX" id="ImEquation178">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$p(\boldsymbol{x})$\end{document}</tex-math></inline-formula>, given the ground truth label <inline-formula><tex-math notation="LaTeX" id="ImEquation179">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$y$\end{document}</tex-math></inline-formula>; T is a hyperparameter, and we use 1000 as the default value (follow the parameter setting in [<xref rid="ref47" ref-type="bibr">47</xref>]).</p>
        <p>In the training stage, we minimize the cross-entropy loss in Equation (<xref rid="deqn05" ref-type="disp-formula">C.5</xref>) with the reference set <inline-formula><tex-math notation="LaTeX" id="ImEquation180">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\mathcal{D}_{ref}$\end{document}</tex-math></inline-formula>. In the query stage, samples from novel distributions <inline-formula><tex-math notation="LaTeX" id="ImEquation181">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\mathcal{P}_{novel}$\end{document}</tex-math></inline-formula> may appear, and the cell-type set of <inline-formula><tex-math notation="LaTeX" id="ImEquation182">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\mathcal{P}_{novel}$\end{document}</tex-math></inline-formula> has no intersection with the reference set label space <inline-formula><tex-math notation="LaTeX" id="ImEquation183">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\mathcal{Y}$\end{document}</tex-math></inline-formula>. Such samples come from novel distribution <inline-formula><tex-math notation="LaTeX" id="ImEquation184">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\mathcal{P}_{novel}$\end{document}</tex-math></inline-formula> should be detected by our proposed model.</p>
      </sec>
      <sec id="app3c">
        <title>C.3 Barcode preprocessing</title>
        <p>The novel rare cell discovery task could be formulated as a binary classification problem. We determine an input <inline-formula><tex-math notation="LaTeX" id="ImEquation185">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\boldsymbol{x} \in \mathcal{X}$\end{document}</tex-math></inline-formula> coming from <inline-formula><tex-math notation="LaTeX" id="ImEquation186">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\mathcal{P}_{typical}$\end{document}</tex-math></inline-formula> or <inline-formula><tex-math notation="LaTeX" id="ImEquation187">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\mathcal{P}_{novel}$\end{document}</tex-math></inline-formula> via the process shown in <xref rid="f7" ref-type="fig">Appendix Figure 1</xref>. Given an input, we utilize a classifier to get prediction probability <inline-formula><tex-math notation="LaTeX" id="ImEquation188">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$p(\boldsymbol{x})$\end{document}</tex-math></inline-formula>. The simplest score function, named traditional classification model, is defined as the following [<xref rid="ref53" ref-type="bibr">53</xref>]: </p>
        <disp-formula id="deqn06">
          <label>(C.6)</label>
          <tex-math notation="LaTeX" id="DmEquation6">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
\begin{align*}&amp; S^{MSP}(\boldsymbol{x})=\underset{j \in \mathcal{Y}}{max}\ \ p_{j}(\boldsymbol{x}),\end{align*}\end{document}</tex-math>
        </disp-formula>
        <p>where we choose the max probability as the decision score; <inline-formula><tex-math notation="LaTeX" id="ImEquation189">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$p_{j}(\boldsymbol{x})$\end{document}</tex-math></inline-formula> is the <inline-formula><tex-math notation="LaTeX" id="ImEquation190">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$j^{th}$\end{document}</tex-math></inline-formula> element of <inline-formula><tex-math notation="LaTeX" id="ImEquation191">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$p(\boldsymbol{x})$\end{document}</tex-math></inline-formula>. Based on this setting, we define the binary decision function to be </p>
        <disp-formula id="deqn07">
          <label>(C.7)</label>
          <tex-math notation="LaTeX" id="DmEquation7">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
\begin{align*}&amp; G(\boldsymbol{x})=\left\{ \begin{array}{@{}lr} Typical,\quad if\ S(\boldsymbol{x}) \geq \lambda, &amp;\\ Novel,\quad if\ S(\boldsymbol{x}) &lt; \lambda. &amp;\\ \end{array} \right.\end{align*}\end{document}</tex-math>
        </disp-formula>
        <p>where <inline-formula><tex-math notation="LaTeX" id="ImEquation192">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$S(*)$\end{document}</tex-math></inline-formula> is the score function and <inline-formula><tex-math notation="LaTeX" id="ImEquation193">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$G(*)$\end{document}</tex-math></inline-formula> is the novelty classification that <inline-formula><tex-math notation="LaTeX" id="ImEquation194">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$x$\end{document}</tex-math></inline-formula> belongs to; <inline-formula><tex-math notation="LaTeX" id="ImEquation195">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\lambda $\end{document}</tex-math></inline-formula> is a hyperparameter that we set as a threshold with a default value of 0.5 (recommended). Usually, samples with a score that reaches the threshold are classified as typical of a certain cell type that the max probability corresponds to, and those with a score below the threshold are classified to be novel. To be more specific, the higher the score is, the lower probability that the cell type is novel.</p>
        <p><bold>Parallel query stage</bold> To further improve the model performance, we add barcode preprocessing when testing on the query dataset. The core idea is that adding input perturbations to the sample could help enlarge the margin between typical cell data and novel cell data [<xref rid="ref47" ref-type="bibr">47</xref>]. Hence, the barcode preprocessing can have a higher effect on typical cell types (the score will be changed more, including increasing more and decreasing more), and it has a lower effect on novel cell types ( the score will not change too much). As shown in <xref rid="f7" ref-type="fig">Appendix Figure 1</xref>, we design two types of barcode preprocessing <inline-formula><tex-math notation="LaTeX" id="ImEquation196">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$T_{minus}$\end{document}</tex-math></inline-formula> and <inline-formula><tex-math notation="LaTeX" id="ImEquation197">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$T_{plus}$\end{document}</tex-math></inline-formula> with different composition operations: </p>
        <disp-formula id="deqn08">
          <label>(C.8)</label>
          <tex-math notation="LaTeX" id="DmEquation8">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
\begin{align*} &amp; \begin{aligned} S_{\hat{y}}(\boldsymbol{x})= \underset{j \in \mathcal{Y}}{max}\ p_{j}(\boldsymbol{x}), \end{aligned}\end{align*}\end{document}</tex-math>
        </disp-formula>
        <disp-formula id="deqn09">
          <label>(C.9)</label>
          <tex-math notation="LaTeX" id="DmEquation9">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
\begin{align*}&amp; \begin{aligned} T_{plus}(\boldsymbol{x})=\boldsymbol{x}-\epsilon sign(-\nabla_{\boldsymbol{x}}\ logS_{\hat{y}}(x) ) = \boldsymbol{x}+\epsilon sign(\nabla_{\boldsymbol{x}}\ logS_{\hat{y}}(x) ),\\ T_{minus}(\boldsymbol{x})=\boldsymbol{x}+\epsilon sign(-\nabla_{\boldsymbol{x}}\ logS_{\hat{y}}(\boldsymbol{x}) ) =\boldsymbol{x}-\epsilon sign(\nabla_{\boldsymbol{x}}\ logS_{\hat{y}}(\boldsymbol{x}) ). \end{aligned}\end{align*}\end{document}</tex-math>
        </disp-formula>
        <p>where <inline-formula><tex-math notation="LaTeX" id="ImEquation198">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\epsilon $\end{document}</tex-math></inline-formula> is the perturbation hyperparameter, whose default value is 0.0014; for the two barcode preprocessing methods, we first compute the gradient via backpropagation, and then the gradient will multiply by hyperparameter <inline-formula><tex-math notation="LaTeX" id="ImEquation199">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\epsilon $\end{document}</tex-math></inline-formula>; <inline-formula><tex-math notation="LaTeX" id="ImEquation200">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$T_{minus}(x)$\end{document}</tex-math></inline-formula> minus the multiplication result, while <inline-formula><tex-math notation="LaTeX" id="ImEquation201">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$T_{plus}(x)$\end{document}</tex-math></inline-formula> plus the multiplication result; usually, <inline-formula><tex-math notation="LaTeX" id="ImEquation202">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$S(T_{minus}(x))$\end{document}</tex-math></inline-formula> is larger than S(x), while <inline-formula><tex-math notation="LaTeX" id="ImEquation203">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$S(T_{plus}(x))$\end{document}</tex-math></inline-formula> is smaller than <inline-formula><tex-math notation="LaTeX" id="ImEquation204">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$S(x)$\end{document}</tex-math></inline-formula>. We design Single Plus-Composition Mode, denoted as <inline-formula><tex-math notation="LaTeX" id="ImEquation205">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$S^{ODIN}$\end{document}</tex-math></inline-formula>, which employs the following equation for barcode preprocessing [<xref rid="ref47" ref-type="bibr">47</xref>]: </p>
        <disp-formula id="deqn10">
          <label>(C.10)</label>
          <tex-math notation="LaTeX" id="DmEquation10">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
\begin{align*}&amp; S^{ODIN}(\boldsymbol{x})=\underset{j \in \mathcal{Y}}{max}\ \ p_{j}(T_{plus}(\boldsymbol{x})).\end{align*}\end{document}</tex-math>
        </disp-formula>
        <p>In fact, we could write a general formulation of Equation (<xref rid="deqn10" ref-type="disp-formula">C.10</xref>) as follows: </p>
        <disp-formula id="deqn11">
          <label>(C.11)</label>
          <tex-math notation="LaTeX" id="DmEquation11">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
\begin{align*}&amp; \begin{aligned} S^{ODIN}(\boldsymbol{x})&amp;=\underset{j \in \mathcal{Y}}{max}\ \ \{ \underbrace{p_{j}(\boldsymbol{x})}_{magnitude}+ \underbrace{p_{j}(T_{plus}(\boldsymbol{x}))-p_{j}(\boldsymbol{x})}_{up-sharpness}\}, \end{aligned}\end{align*}\end{document}</tex-math>
        </disp-formula>
        <p>
where the magnitude is the score of input <inline-formula><tex-math notation="LaTeX" id="ImEquation206">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$x$\end{document}</tex-math></inline-formula> without barcode preprocessing; the up-sharpness is the increment in score after the <inline-formula><tex-math notation="LaTeX" id="ImEquation207">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$T_{plus}$\end{document}</tex-math></inline-formula> process. The limitation of <inline-formula><tex-math notation="LaTeX" id="ImEquation208">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$S^{ODIN}$\end{document}</tex-math></inline-formula> is that it only considers up-sharpness but does not consider down-sharpness, which is the decrease in score after the <inline-formula><tex-math notation="LaTeX" id="ImEquation209">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$T_{minus}$\end{document}</tex-math></inline-formula> process. Hence, we could simultaneously calculate up-sharpness and down-sharpness at the same input <inline-formula><tex-math notation="LaTeX" id="ImEquation210">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$x$\end{document}</tex-math></inline-formula>, which is <inline-formula><tex-math notation="LaTeX" id="ImEquation211">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$S^{SIM}$\end{document}</tex-math></inline-formula>, named Parallel Composition Mode defined in the following: </p>
        <disp-formula id="deqn12">
          <label>(C.12)</label>
          <tex-math notation="LaTeX" id="DmEquation12">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
\begin{align*} S^{SIM}(\boldsymbol{x})&amp;=\,\underset{j \in \mathcal{Y}}{max}\{ \underbrace{p_{j}(\boldsymbol{x}) }_{magnitude}+ \underbrace{p_{j}(T_{plus}(\boldsymbol{x}))-p_{j}(\boldsymbol{x})}_{up-sharpness}+\underbrace{p_{j}(\boldsymbol{x})-p_{j}(T_{minus}(\boldsymbol{x}))}_{down-sharpness}\}\nonumber\\ &amp;=\,\underset{j \in \mathcal{Y}}{max}\{ p_{j}(\boldsymbol{x})+p_{j}(T_{plus}(\boldsymbol{x}))-p_{j}(T_{minus}(\boldsymbol{x}))\}. \end{align*}\end{document}</tex-math>
        </disp-formula>
        <p>To summarize, the parallel query stage considers two novel cell detection modes, namely Single Plus-Composition Mode and Parallel Composition Mode. Score functions <inline-formula><tex-math notation="LaTeX" id="ImEquation212">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$S^{SIM}$\end{document}</tex-math></inline-formula> consider both up-sharpness and down-sharpness, while <inline-formula><tex-math notation="LaTeX" id="ImEquation213">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$S^{ODIN}$\end{document}</tex-math></inline-formula> only considers up-sharpness.</p>
        <p><bold>Sequential query stage</bold> Moreover, we could also sequentially calculate up-sharpness and down-sharpness using the same input <inline-formula><tex-math notation="LaTeX" id="ImEquation214">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$x$\end{document}</tex-math></inline-formula> using the Sequential Composition Mode. Score <inline-formula><tex-math notation="LaTeX" id="ImEquation215">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$S^{SEQ}$\end{document}</tex-math></inline-formula> is defined as follows: </p>
        <disp-formula id="deqn13">
          <label>(C.13)</label>
          <tex-math notation="LaTeX" id="DmEquation13">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
\begin{align*}&amp; \begin{aligned} S^{SEQ}(\boldsymbol{x})&amp;=\underset{j \in \mathcal{Y}}{max}\{ \underbrace{p_{j}(\boldsymbol{x})} _{magnitude}+ \underbrace{p_{j}(T_{plus}(\boldsymbol{x}))-p_{j}(\boldsymbol{x})}_{up-sharpness}\\&amp;\quad+\underbrace{p_{j}(T_{plus}(\boldsymbol{x}))-p_{j}(T_{minus}(T_{plus}(\boldsymbol{x})))}_{down-sharpness}\}\\ &amp;=\underset{j \in \mathcal{Y}}{max}\{ 2*p_{j}(T_{plus}(\boldsymbol{x}))- p_{j}(T_{minus}(T_{plus}(\boldsymbol{x})))\}.\\ \end{aligned}\end{align*}\end{document}</tex-math>
        </disp-formula>
        <p>In this mode, we sequentially calculate up-sharpness at the input x and down-sharpness at <inline-formula><tex-math notation="LaTeX" id="ImEquation216">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$T_{plus}(x)$\end{document}</tex-math></inline-formula>.</p>
        <p>
          <inline-graphic xlink:href="bbae112fx2.jpg" id="bbae112fx2"/>
        </p>
      </sec>
      <sec id="app3d">
        <title>C.4 Score normalization</title>
        <p>The score normalization is employed to resize the score obtained from the score function. The scores will become relatively small with the increase of hyperparameter <inline-formula><tex-math notation="LaTeX" id="ImEquation217">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$T$\end{document}</tex-math></inline-formula> proposed in Equation (<xref rid="deqn04" ref-type="disp-formula">C.4</xref>). Hence, we employ the following equations to normalize our scores: </p>
        <disp-formula id="deqn14">
          <label>(C.14)</label>
          <tex-math notation="LaTeX" id="DmEquation15">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
\begin{align*} \begin{split} S_{refMax}&amp;=\underset{\boldsymbol{x} \in \mathcal{D}_{ref}} {max}\ S(\boldsymbol{x}), \end{split}\end{align*}\end{document}</tex-math>
        </disp-formula>
        <disp-formula id="deqn15">
          <label>(C.15)</label>
          <tex-math notation="LaTeX" id="DmEquation16">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
\begin{align*} \begin{split} S^{norm}(\boldsymbol{x})&amp;=\frac{S(x)-1/C^{ref}}{S_{refMax}-1/C^{ref}},\\ \end{split}\end{align*}\end{document}</tex-math>
        </disp-formula>
        <p>
where <inline-formula><tex-math notation="LaTeX" id="ImEquation218">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$S_{refMax}$\end{document}</tex-math></inline-formula> is the max score obtained from the reference set via our proposed score functions; <inline-formula><tex-math notation="LaTeX" id="ImEquation219">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$S^{norm}(\boldsymbol{x})$\end{document}</tex-math></inline-formula> is the normalization score of input <inline-formula><tex-math notation="LaTeX" id="ImEquation220">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\boldsymbol{x}$\end{document}</tex-math></inline-formula>, which is within the range of <inline-formula><tex-math notation="LaTeX" id="ImEquation221">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$[0,1]$\end{document}</tex-math></inline-formula>.</p>
      </sec>
      <sec id="app3e">
        <title>C.5 Architecture and hyperparameters</title>
        <p>We show the overall pipeline in Algorithm 1. We train a classifier <inline-formula><tex-math notation="LaTeX" id="ImEquation222">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$f$\end{document}</tex-math></inline-formula> with the reference set <inline-formula><tex-math notation="LaTeX" id="ImEquation223">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\mathcal{D}_{ref}$\end{document}</tex-math></inline-formula> sampled from <inline-formula><tex-math notation="LaTeX" id="ImEquation224">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\mathcal{P}_{typical}$\end{document}</tex-math></inline-formula>. Model parameter <inline-formula><tex-math notation="LaTeX" id="ImEquation225">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\theta $\end{document}</tex-math></inline-formula> is updated via backpropagation with the cross-entropy loss <inline-formula><tex-math notation="LaTeX" id="ImEquation226">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\mathcal{L}_{CE}$\end{document}</tex-math></inline-formula> described in Equation (<xref rid="deqn05" ref-type="disp-formula">C.5</xref>). The number of neurons in the input layer is equal to the number of genes in the scRNA-seq dataset. The three subsequent hidden layers include 128, 64 and 32 units, respectively. The dropout rate of the dropout layer is 0.5 by default. We utilize AdamW [<xref rid="ref54" ref-type="bibr">54</xref>] with <inline-formula><tex-math notation="LaTeX" id="ImEquation227">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$1e-4$\end{document}</tex-math></inline-formula> as the learning rate to optimize the network. The hyperparameter <inline-formula><tex-math notation="LaTeX" id="ImEquation228">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$T$\end{document}</tex-math></inline-formula> is set to be 1000, and the perturbation hyperparameter <inline-formula><tex-math notation="LaTeX" id="ImEquation229">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\epsilon $\end{document}</tex-math></inline-formula> is 0.0014 (follow the parameter setting in [<xref rid="ref47" ref-type="bibr">47</xref>]). The training batch size and iteration number are flexible for users, and we recommend users set the training batch size to at least 32 and the iteration number to at least 3000 to train the model well. All experiments are conducted on a GTX2080 Ti.</p>
      </sec>
      <sec id="app3f">
        <title>C.6 Softeware comparison and settings</title>
        <p>To evaluate the effectiveness of scNovel, we conducted a comparative analysis with various commonly employed techniques, including Scmap-cell, Scmap-cluster, scPred and scLearn. The evaluation criteria, as well as the input data, were obtained following the instructions and tutorials provided by each respective package. In order to maintain a level playing field, we adhered to the default parameters for all the methods utilized, including that of scNovel. </p>
        <p>The software applications utilized in our study are as follows:</p>
        <list list-type="bullet">
          <list-item>
            <p>scmap-Cell and scmap-Cluster, both of which were sourced from BioManager (<ext-link xlink:href="https://github.com/hemberg-lab/scmap" ext-link-type="uri">https://git hub.com/hemberg-lab/scmap</ext-link>). The parameter settings for these functions were in accordance with the accompanying instructions.</p>
          </list-item>
          <list-item>
            <p>scPred, which was obtained from BiocManager (<ext-link xlink:href="https://github.com/powellgenomicslab/scPred" ext-link-type="uri">https://github.com/powellgenomicslab/scPred</ext-link>), was executed under default parameters. The algorithm selected the category with the highest score to generate the final result. It should be noted that scPred is better suited for processing relatively smaller datasets, as larger ones could require a considerable amount of time.</p>
          </list-item>
          <list-item>
            <p>scLearn sourced from Github (<ext-link xlink:href="https://github.com/bm2-lab/scLearn" ext-link-type="uri">https://github.com/bm2-lab/scLearn</ext-link>) was also executed under the default parameter configuration.</p>
          </list-item>
        </list>
      </sec>
    </app>
    <app id="app4">
      <title>D. Appendix results</title>
      <table-wrap position="anchor" id="TB2">
        <label>Appendix Table 2</label>
        <caption>
          <p>Averaged experimental results among different datasets of scNovel and baseline methods. The <inline-formula><tex-math notation="LaTeX" id="ImEquation87e">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\color{red}{\mathrm{{red\ bold}}}$\end{document}</tex-math></inline-formula> and <inline-formula><tex-math notation="LaTeX" id="ImEquation87g">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\color{blue}{\mathrm{{blue\ bold}}}$\end{document}</tex-math></inline-formula> are the best result and second-best result, respectively, in corresponding evaluation metrics and <inline-formula><tex-math notation="LaTeX" id="ImEquation22">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$C^{novel}$\end{document}</tex-math></inline-formula></p>
        </caption>
        <table frame="hsides" rules="groups">
          <colgroup span="1">
            <col span="1" align="left"/>
            <col span="1" align="left"/>
            <col span="1" align="left"/>
            <col span="1" align="left"/>
            <col span="1" align="left"/>
            <col span="1" align="left"/>
          </colgroup>
          <thead>
            <tr>
              <th align="left" rowspan="1" colspan="1">Evaluation</th>
              <th align="left" rowspan="1" colspan="1">Methods</th>
              <th colspan="4" align="left" rowspan="1">
                <inline-formula>
                  <tex-math notation="LaTeX" id="ImEquation23">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$C^{novel}$\end{document}</tex-math>
                </inline-formula>
              </th>
            </tr>
            <tr>
              <th rowspan="1" colspan="1"/>
              <th rowspan="1" colspan="1"/>
              <th align="left" rowspan="1" colspan="1">1</th>
              <th align="left" rowspan="1" colspan="1">2</th>
              <th align="left" rowspan="1" colspan="1">3</th>
              <th align="left" rowspan="1" colspan="1">4</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td rowspan="1" colspan="1">FPR95(%)<inline-formula><tex-math notation="LaTeX" id="ImEquation24">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\downarrow $\end{document}</tex-math></inline-formula></td>
              <td rowspan="1" colspan="1">scmap-cluster [<xref rid="ref25" ref-type="bibr">25</xref>]</td>
              <td rowspan="1" colspan="1">55.85</td>
              <td rowspan="1" colspan="1">54.56</td>
              <td rowspan="1" colspan="1">42.17</td>
              <td rowspan="1" colspan="1">
                <inline-formula>
                  <tex-math notation="LaTeX" id="ImEquation25">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\color{blue}{\boldsymbol{{47.62}}}$\end{document}</tex-math>
                </inline-formula>
              </td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1">scmap-cell [<xref rid="ref25" ref-type="bibr">25</xref>]</td>
              <td rowspan="1" colspan="1">68.74</td>
              <td rowspan="1" colspan="1">70.23</td>
              <td rowspan="1" colspan="1">79.44</td>
              <td rowspan="1" colspan="1">73.84</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1">scPred [<xref rid="ref26" ref-type="bibr">26</xref>]</td>
              <td rowspan="1" colspan="1">60.43</td>
              <td rowspan="1" colspan="1">65.09</td>
              <td rowspan="1" colspan="1">73.86</td>
              <td rowspan="1" colspan="1">66.96</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1">scLearn [<xref rid="ref27" ref-type="bibr">27</xref>]</td>
              <td rowspan="1" colspan="1">
                <inline-formula>
                  <tex-math notation="LaTeX" id="ImEquation26">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\color{blue}{\boldsymbol{{40.74}}}$\end{document}</tex-math>
                </inline-formula>
              </td>
              <td rowspan="1" colspan="1">
                <inline-formula>
                  <tex-math notation="LaTeX" id="ImEquation27">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\color{blue}{\boldsymbol{{47.62}}}$\end{document}</tex-math>
                </inline-formula>
              </td>
              <td rowspan="1" colspan="1">
                <inline-formula>
                  <tex-math notation="LaTeX" id="ImEquation28">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\color{blue}{\boldsymbol{{39.29}}}$\end{document}</tex-math>
                </inline-formula>
              </td>
              <td rowspan="1" colspan="1">54.52</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1">scNovel</td>
              <td rowspan="1" colspan="1">
                <inline-formula>
                  <tex-math notation="LaTeX" id="ImEquation29">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\color{red}{\boldsymbol{{22.82}}}$\end{document}</tex-math>
                </inline-formula>
              </td>
              <td rowspan="1" colspan="1">
                <inline-formula>
                  <tex-math notation="LaTeX" id="ImEquation30">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\color{red}{\boldsymbol{{21.31}}}$\end{document}</tex-math>
                </inline-formula>
              </td>
              <td rowspan="1" colspan="1">
                <inline-formula>
                  <tex-math notation="LaTeX" id="ImEquation31">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\color{red}{\boldsymbol{{28.74}}}$\end{document}</tex-math>
                </inline-formula>
              </td>
              <td rowspan="1" colspan="1">
                <inline-formula>
                  <tex-math notation="LaTeX" id="ImEquation32">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\color{red}{\boldsymbol{{25.95}}}$\end{document}</tex-math>
                </inline-formula>
              </td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">
                <bold>AUROC(<inline-formula><tex-math notation="LaTeX" id="ImEquation33">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\%$\end{document}</tex-math></inline-formula>)<inline-formula><tex-math notation="LaTeX" id="ImEquation34">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\uparrow $\end{document}</tex-math></inline-formula></bold>
              </td>
              <td rowspan="1" colspan="1">scmap-cluster [<xref rid="ref25" ref-type="bibr">25</xref>]</td>
              <td rowspan="1" colspan="1">80.78</td>
              <td rowspan="1" colspan="1">78.38</td>
              <td rowspan="1" colspan="1">83.56</td>
              <td rowspan="1" colspan="1">
                <inline-formula>
                  <tex-math notation="LaTeX" id="ImEquation35">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\color{blue}{\boldsymbol{{80.68}}}$\end{document}</tex-math>
                </inline-formula>
              </td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1">scmap-cell [<xref rid="ref25" ref-type="bibr">25</xref>]</td>
              <td rowspan="1" colspan="1">84.01</td>
              <td rowspan="1" colspan="1">77.60</td>
              <td rowspan="1" colspan="1">81.65</td>
              <td rowspan="1" colspan="1">80.63</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1">scPred [<xref rid="ref26" ref-type="bibr">26</xref>]</td>
              <td rowspan="1" colspan="1">78.45</td>
              <td rowspan="1" colspan="1">73.48</td>
              <td rowspan="1" colspan="1">76.63</td>
              <td rowspan="1" colspan="1">70.49</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1">scLearn [<xref rid="ref27" ref-type="bibr">27</xref>]</td>
              <td rowspan="1" colspan="1">
                <inline-formula>
                  <tex-math notation="LaTeX" id="ImEquation36">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\color{blue}{\boldsymbol{{84.30}}}$\end{document}</tex-math>
                </inline-formula>
              </td>
              <td rowspan="1" colspan="1">
                <inline-formula>
                  <tex-math notation="LaTeX" id="ImEquation37">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\color{blue}{\boldsymbol{{83.07}}}$\end{document}</tex-math>
                </inline-formula>
              </td>
              <td rowspan="1" colspan="1">
                <inline-formula>
                  <tex-math notation="LaTeX" id="ImEquation38">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\color{blue}{\boldsymbol{{87.45}}}$\end{document}</tex-math>
                </inline-formula>
              </td>
              <td rowspan="1" colspan="1">77.61</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1">scNovel</td>
              <td rowspan="1" colspan="1">
                <inline-formula>
                  <tex-math notation="LaTeX" id="ImEquation39">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\color{red}{\boldsymbol{{96.33}}}$\end{document}</tex-math>
                </inline-formula>
              </td>
              <td rowspan="1" colspan="1">
                <inline-formula>
                  <tex-math notation="LaTeX" id="ImEquation40">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\color{red}{\boldsymbol{{94.29}}}$\end{document}</tex-math>
                </inline-formula>
              </td>
              <td rowspan="1" colspan="1">
                <inline-formula>
                  <tex-math notation="LaTeX" id="ImEquation41">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\color{red}{\boldsymbol{{94.64}}}$\end{document}</tex-math>
                </inline-formula>
              </td>
              <td rowspan="1" colspan="1">
                <inline-formula>
                  <tex-math notation="LaTeX" id="ImEquation42">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\color{red}{\boldsymbol{{94.16}}}$\end{document}</tex-math>
                </inline-formula>
              </td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">AUPR(%)<inline-formula><tex-math notation="LaTeX" id="ImEquation43">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\uparrow $\end{document}</tex-math></inline-formula></td>
              <td rowspan="1" colspan="1">scmap-cluster [<xref rid="ref25" ref-type="bibr">25</xref>]</td>
              <td rowspan="1" colspan="1">
                <inline-formula>
                  <tex-math notation="LaTeX" id="ImEquation44">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\color{blue}{\boldsymbol{{99.42}}}$\end{document}</tex-math>
                </inline-formula>
              </td>
              <td rowspan="1" colspan="1">
                <inline-formula>
                  <tex-math notation="LaTeX" id="ImEquation45">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\color{blue}{\boldsymbol{{98.59}}}$\end{document}</tex-math>
                </inline-formula>
              </td>
              <td rowspan="1" colspan="1">97.62</td>
              <td rowspan="1" colspan="1">
                <inline-formula>
                  <tex-math notation="LaTeX" id="ImEquation46">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\color{blue}{\boldsymbol{{93.16}}}$\end{document}</tex-math>
                </inline-formula>
              </td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1">scmap-cell [<xref rid="ref25" ref-type="bibr">25</xref>]</td>
              <td rowspan="1" colspan="1">99.30</td>
              <td rowspan="1" colspan="1">97.23</td>
              <td rowspan="1" colspan="1">95.44</td>
              <td rowspan="1" colspan="1">91.27</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1">scPred [<xref rid="ref26" ref-type="bibr">26</xref>]</td>
              <td rowspan="1" colspan="1">99.24</td>
              <td rowspan="1" colspan="1">97.85</td>
              <td rowspan="1" colspan="1">94.08</td>
              <td rowspan="1" colspan="1">86.00</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1">scLearn [<xref rid="ref27" ref-type="bibr">27</xref>]</td>
              <td rowspan="1" colspan="1">98.15</td>
              <td rowspan="1" colspan="1">97.70</td>
              <td rowspan="1" colspan="1">
                <inline-formula>
                  <tex-math notation="LaTeX" id="ImEquation47">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\color{blue}{\boldsymbol{{97.71}}}$\end{document}</tex-math>
                </inline-formula>
              </td>
              <td rowspan="1" colspan="1">91.60</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1">scNovel</td>
              <td rowspan="1" colspan="1">
                <inline-formula>
                  <tex-math notation="LaTeX" id="ImEquation48">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\color{red}{\boldsymbol{{99.78}}}$\end{document}</tex-math>
                </inline-formula>
              </td>
              <td rowspan="1" colspan="1">
                <inline-formula>
                  <tex-math notation="LaTeX" id="ImEquation49">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\color{red}{\boldsymbol{{99.41}}}$\end{document}</tex-math>
                </inline-formula>
              </td>
              <td rowspan="1" colspan="1">
                <inline-formula>
                  <tex-math notation="LaTeX" id="ImEquation50">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\color{red}{\boldsymbol{{98.70}}}$\end{document}</tex-math>
                </inline-formula>
              </td>
              <td rowspan="1" colspan="1">
                <inline-formula>
                  <tex-math notation="LaTeX" id="ImEquation51">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\color{red}{\boldsymbol{{97.72}}}$\end{document}</tex-math>
                </inline-formula>
              </td>
            </tr>
          </tbody>
        </table>
      </table-wrap>
      <table-wrap position="anchor" id="TB3">
        <label>Appendix Table 3</label>
        <caption>
          <p>Experimental results with different score functions. The <inline-formula><tex-math notation="LaTeX" id="ImEquation87c">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\color{red}{\mathrm{{red\ bold}}}$\end{document}</tex-math></inline-formula> and <inline-formula><tex-math notation="LaTeX" id="ImEquation87d">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\color{blue}{\mathrm{{blue\ bold}}}$\end{document}</tex-math></inline-formula> are the best and second-best results, respectively, in corresponding evaluation metrics and <inline-formula><tex-math notation="LaTeX" id="ImEquation234">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$C^{novel}$\end{document}</tex-math></inline-formula></p>
        </caption>
        <table frame="hsides" rules="groups">
          <colgroup span="1">
            <col span="1" align="left"/>
            <col span="1" align="left"/>
            <col span="1" align="left"/>
            <col span="1" align="left"/>
            <col span="1" align="left"/>
            <col span="1" align="left"/>
          </colgroup>
          <thead>
            <tr>
              <th align="left" rowspan="1" colspan="1">Evaluation</th>
              <th align="left" rowspan="1" colspan="1">Methods</th>
              <th colspan="4" align="left" rowspan="1">
                <inline-formula>
                  <tex-math notation="LaTeX" id="ImEquation235">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$C^{novel}$\end{document}</tex-math>
                </inline-formula>
              </th>
            </tr>
            <tr>
              <th rowspan="1" colspan="1"/>
              <th rowspan="1" colspan="1"/>
              <th align="left" rowspan="1" colspan="1">1</th>
              <th align="left" rowspan="1" colspan="1">2</th>
              <th align="left" rowspan="1" colspan="1">3</th>
              <th align="left" rowspan="1" colspan="1">4</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td rowspan="1" colspan="1">FPR95(%)<inline-formula><tex-math notation="LaTeX" id="ImEquation236">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\downarrow $\end{document}</tex-math></inline-formula></td>
              <td rowspan="1" colspan="1">
                <inline-formula>
                  <tex-math notation="LaTeX" id="ImEquation237">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$S^{MSP}$\end{document}</tex-math>
                </inline-formula>
              </td>
              <td rowspan="1" colspan="1">32.19</td>
              <td rowspan="1" colspan="1">29.21</td>
              <td rowspan="1" colspan="1">34.92</td>
              <td rowspan="1" colspan="1">32.71</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1">
                <inline-formula>
                  <tex-math notation="LaTeX" id="ImEquation238">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$S^{ODIN}$\end{document}</tex-math>
                </inline-formula>
              </td>
              <td rowspan="1" colspan="1">24.03</td>
              <td rowspan="1" colspan="1">22.05</td>
              <td rowspan="1" colspan="1">29.32</td>
              <td rowspan="1" colspan="1">26.39</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1">
                <inline-formula>
                  <tex-math notation="LaTeX" id="ImEquation239">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$S^{SEQ}$\end{document}</tex-math>
                </inline-formula>
              </td>
              <td rowspan="1" colspan="1">
                <inline-formula>
                  <tex-math notation="LaTeX" id="ImEquation240">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\color{blue}{\boldsymbol{{22.94}}}$\end{document}</tex-math>
                </inline-formula>
              </td>
              <td rowspan="1" colspan="1">
                <inline-formula>
                  <tex-math notation="LaTeX" id="ImEquation241">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\color{red}{\boldsymbol{{20.99}}}$\end{document}</tex-math>
                </inline-formula>
              </td>
              <td rowspan="1" colspan="1">
                <inline-formula>
                  <tex-math notation="LaTeX" id="ImEquation242">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\color{blue}{\boldsymbol{{28.96}}}$\end{document}</tex-math>
                </inline-formula>
              </td>
              <td rowspan="1" colspan="1">
                <inline-formula>
                  <tex-math notation="LaTeX" id="ImEquation243">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\color{red}{\boldsymbol{{25.64}}}$\end{document}</tex-math>
                </inline-formula>
              </td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1">
                <inline-formula>
                  <tex-math notation="LaTeX" id="ImEquation244">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$S^{SIM}$\end{document}</tex-math>
                </inline-formula>
              </td>
              <td rowspan="1" colspan="1">
                <inline-formula>
                  <tex-math notation="LaTeX" id="ImEquation245">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\color{red}{\boldsymbol{{22.82}}}$\end{document}</tex-math>
                </inline-formula>
              </td>
              <td rowspan="1" colspan="1">
                <inline-formula>
                  <tex-math notation="LaTeX" id="ImEquation246">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\color{blue}{\boldsymbol{{21.31}}}$\end{document}</tex-math>
                </inline-formula>
              </td>
              <td rowspan="1" colspan="1">
                <inline-formula>
                  <tex-math notation="LaTeX" id="ImEquation247">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\color{red}{\boldsymbol{{28.74}}}$\end{document}</tex-math>
                </inline-formula>
              </td>
              <td rowspan="1" colspan="1">
                <inline-formula>
                  <tex-math notation="LaTeX" id="ImEquation248">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\color{blue}{\boldsymbol{{25.95}}}$\end{document}</tex-math>
                </inline-formula>
              </td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">
                <bold>AUROC(%)<inline-formula><tex-math notation="LaTeX" id="ImEquation249">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\uparrow $\end{document}</tex-math></inline-formula></bold>
              </td>
              <td rowspan="1" colspan="1">
                <inline-formula>
                  <tex-math notation="LaTeX" id="ImEquation250">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$S^{MSP}$\end{document}</tex-math>
                </inline-formula>
              </td>
              <td rowspan="1" colspan="1">94.53</td>
              <td rowspan="1" colspan="1">93.55</td>
              <td rowspan="1" colspan="1">93.73</td>
              <td rowspan="1" colspan="1">92.98</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1">
                <inline-formula>
                  <tex-math notation="LaTeX" id="ImEquation251">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$S^{ODIN}$\end{document}</tex-math>
                </inline-formula>
              </td>
              <td rowspan="1" colspan="1">96.06</td>
              <td rowspan="1" colspan="1">94.11</td>
              <td rowspan="1" colspan="1">94.55</td>
              <td rowspan="1" colspan="1">
                <inline-formula>
                  <tex-math notation="LaTeX" id="ImEquation252">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\color{blue}{\boldsymbol{{93.94}}}$\end{document}</tex-math>
                </inline-formula>
              </td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1">
                <inline-formula>
                  <tex-math notation="LaTeX" id="ImEquation253">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$S^{SEQ}$\end{document}</tex-math>
                </inline-formula>
              </td>
              <td rowspan="1" colspan="1">
                <inline-formula>
                  <tex-math notation="LaTeX" id="ImEquation254">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\color{blue}{\boldsymbol{{96.32}}}$\end{document}</tex-math>
                </inline-formula>
              </td>
              <td rowspan="1" colspan="1">
                <inline-formula>
                  <tex-math notation="LaTeX" id="ImEquation255">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\color{blue}{\boldsymbol{{94.26}}}$\end{document}</tex-math>
                </inline-formula>
              </td>
              <td rowspan="1" colspan="1">
                <inline-formula>
                  <tex-math notation="LaTeX" id="ImEquation256">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\color{blue}{\boldsymbol{{94.60}}}$\end{document}</tex-math>
                </inline-formula>
              </td>
              <td rowspan="1" colspan="1">
                <inline-formula>
                  <tex-math notation="LaTeX" id="ImEquation257">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\color{red}{\boldsymbol{{94.16}}}$\end{document}</tex-math>
                </inline-formula>
              </td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1">
                <inline-formula>
                  <tex-math notation="LaTeX" id="ImEquation258">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$S^{SIM}$\end{document}</tex-math>
                </inline-formula>
              </td>
              <td rowspan="1" colspan="1">
                <inline-formula>
                  <tex-math notation="LaTeX" id="ImEquation259">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\color{red}{\boldsymbol{{96.33}}}$\end{document}</tex-math>
                </inline-formula>
              </td>
              <td rowspan="1" colspan="1">
                <inline-formula>
                  <tex-math notation="LaTeX" id="ImEquation260">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\color{red}{\boldsymbol{{94.29}}}$\end{document}</tex-math>
                </inline-formula>
              </td>
              <td rowspan="1" colspan="1">
                <inline-formula>
                  <tex-math notation="LaTeX" id="ImEquation261">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\color{red}{\boldsymbol{{94.64}}}$\end{document}</tex-math>
                </inline-formula>
              </td>
              <td rowspan="1" colspan="1">
                <inline-formula>
                  <tex-math notation="LaTeX" id="ImEquation262">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\color{red}{\boldsymbol{{94.16}}}$\end{document}</tex-math>
                </inline-formula>
              </td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">AUPR(%)<inline-formula><tex-math notation="LaTeX" id="ImEquation263">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\uparrow $\end{document}</tex-math></inline-formula></td>
              <td rowspan="1" colspan="1">
                <inline-formula>
                  <tex-math notation="LaTeX" id="ImEquation264">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$S^{MSP}$\end{document}</tex-math>
                </inline-formula>
              </td>
              <td rowspan="1" colspan="1">99.65</td>
              <td rowspan="1" colspan="1">
                <inline-formula>
                  <tex-math notation="LaTeX" id="ImEquation265">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\color{red}{\boldsymbol{{99.41}}}$\end{document}</tex-math>
                </inline-formula>
              </td>
              <td rowspan="1" colspan="1">98.56</td>
              <td rowspan="1" colspan="1">97.14</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1">
                <inline-formula>
                  <tex-math notation="LaTeX" id="ImEquation266">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$S^{ODIN}$\end{document}</tex-math>
                </inline-formula>
              </td>
              <td rowspan="1" colspan="1">
                <inline-formula>
                  <tex-math notation="LaTeX" id="ImEquation267">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\color{blue}{\boldsymbol{{99.75}}}$\end{document}</tex-math>
                </inline-formula>
              </td>
              <td rowspan="1" colspan="1">
                <inline-formula>
                  <tex-math notation="LaTeX" id="ImEquation268">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\color{red}{\boldsymbol{{99.41}}}$\end{document}</tex-math>
                </inline-formula>
              </td>
              <td rowspan="1" colspan="1">98.66</td>
              <td rowspan="1" colspan="1">97.48</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1">
                <inline-formula>
                  <tex-math notation="LaTeX" id="ImEquation269">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$S^{SEQ}$\end{document}</tex-math>
                </inline-formula>
              </td>
              <td rowspan="1" colspan="1">
                <inline-formula>
                  <tex-math notation="LaTeX" id="ImEquation270">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\color{red}{\boldsymbol{{99.78}}}$\end{document}</tex-math>
                </inline-formula>
              </td>
              <td rowspan="1" colspan="1">
                <inline-formula>
                  <tex-math notation="LaTeX" id="ImEquation271">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\color{red}{\boldsymbol{{99.41}}}$\end{document}</tex-math>
                </inline-formula>
              </td>
              <td rowspan="1" colspan="1">
                <inline-formula>
                  <tex-math notation="LaTeX" id="ImEquation272">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\color{blue}{\boldsymbol{{98.69}}}$\end{document}</tex-math>
                </inline-formula>
              </td>
              <td rowspan="1" colspan="1">
                <inline-formula>
                  <tex-math notation="LaTeX" id="ImEquation273">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\color{blue}{\boldsymbol{{97.71}}}$\end{document}</tex-math>
                </inline-formula>
              </td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1">
                <inline-formula>
                  <tex-math notation="LaTeX" id="ImEquation274">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$S^{SIM}$\end{document}</tex-math>
                </inline-formula>
              </td>
              <td rowspan="1" colspan="1">
                <inline-formula>
                  <tex-math notation="LaTeX" id="ImEquation275">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\color{red}{\boldsymbol{{99.78}}}$\end{document}</tex-math>
                </inline-formula>
              </td>
              <td rowspan="1" colspan="1">
                <inline-formula>
                  <tex-math notation="LaTeX" id="ImEquation276">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\color{red}{\boldsymbol{{99.41}}}$\end{document}</tex-math>
                </inline-formula>
              </td>
              <td rowspan="1" colspan="1">
                <inline-formula>
                  <tex-math notation="LaTeX" id="ImEquation277">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\color{red}{\boldsymbol{{98.70}}}$\end{document}</tex-math>
                </inline-formula>
              </td>
              <td rowspan="1" colspan="1">
                <inline-formula>
                  <tex-math notation="LaTeX" id="ImEquation278">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\color{red}{\boldsymbol{{97.72}}}$\end{document}</tex-math>
                </inline-formula>
              </td>
            </tr>
          </tbody>
        </table>
      </table-wrap>
      <table-wrap position="anchor" id="TB4">
        <label>Appendix Table 4</label>
        <caption>
          <p>Experimental results with different neural network architecture, including removing BN (scNovel w/o BN) and removing ELU activation function (scNovel w/o BN). The <inline-formula><tex-math notation="LaTeX" id="ImEquation87a">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\color{red}{\mathrm{{red\ bold}}}$\end{document}</tex-math></inline-formula> and <inline-formula><tex-math notation="LaTeX" id="ImEquation87b">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\color{blue}{\mathrm{{blue\ bold}}}$\end{document}</tex-math></inline-formula> are the best and second-best results, respectively, in corresponding evaluation metrics and <inline-formula><tex-math notation="LaTeX" id="ImEquation80">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$C^{novel}$\end{document}</tex-math></inline-formula>. The experiment results suggest that both BN and ELU are useful to boost performance</p>
        </caption>
        <table frame="hsides" rules="groups">
          <colgroup span="1">
            <col span="1" align="left"/>
            <col span="1" align="left"/>
            <col span="1" align="left"/>
            <col span="1" align="left"/>
            <col span="1" align="left"/>
            <col span="1" align="left"/>
          </colgroup>
          <thead>
            <tr>
              <th align="left" rowspan="1" colspan="1">Evaluation</th>
              <th align="left" rowspan="1" colspan="1">Methods</th>
              <th colspan="4" align="left" rowspan="1">
                <inline-formula>
                  <tex-math notation="LaTeX" id="ImEquation81">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$C^{novel}$\end{document}</tex-math>
                </inline-formula>
              </th>
            </tr>
            <tr>
              <th rowspan="1" colspan="1"/>
              <th rowspan="1" colspan="1"/>
              <th align="left" rowspan="1" colspan="1">1</th>
              <th align="left" rowspan="1" colspan="1">2</th>
              <th align="left" rowspan="1" colspan="1">3</th>
              <th align="left" rowspan="1" colspan="1">4</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td rowspan="1" colspan="1">FPR95(%)<inline-formula><tex-math notation="LaTeX" id="ImEquation82">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\downarrow $\end{document}</tex-math></inline-formula></td>
              <td rowspan="1" colspan="1">scNovel w/o BN</td>
              <td rowspan="1" colspan="1">
                <inline-formula>
                  <tex-math notation="LaTeX" id="ImEquation83">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\color{blue}{\boldsymbol{{24.28}}}$\end{document}</tex-math>
                </inline-formula>
              </td>
              <td rowspan="1" colspan="1">26.63</td>
              <td rowspan="1" colspan="1">
                <inline-formula>
                  <tex-math notation="LaTeX" id="ImEquation84">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\color{red}{\boldsymbol{{23.32}}}$\end{document}</tex-math>
                </inline-formula>
              </td>
              <td rowspan="1" colspan="1">
                <inline-formula>
                  <tex-math notation="LaTeX" id="ImEquation85">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\color{blue}{\boldsymbol{{30.17}}}$\end{document}</tex-math>
                </inline-formula>
              </td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1">scNovel w/o ELU</td>
              <td rowspan="1" colspan="1">26.44</td>
              <td rowspan="1" colspan="1">
                <inline-formula>
                  <tex-math notation="LaTeX" id="ImEquation86">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\color{blue}{\boldsymbol{{22.88}}}$\end{document}</tex-math>
                </inline-formula>
              </td>
              <td rowspan="1" colspan="1">31.13</td>
              <td rowspan="1" colspan="1">31.63</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1">scNovel</td>
              <td rowspan="1" colspan="1">
                <inline-formula>
                  <tex-math notation="LaTeX" id="ImEquation87">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\color{red}{\boldsymbol{{22.82}}}$\end{document}</tex-math>
                </inline-formula>
              </td>
              <td rowspan="1" colspan="1">
                <inline-formula>
                  <tex-math notation="LaTeX" id="ImEquation88">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\color{red}{\boldsymbol{{21.31}}}$\end{document}</tex-math>
                </inline-formula>
              </td>
              <td rowspan="1" colspan="1">
                <inline-formula>
                  <tex-math notation="LaTeX" id="ImEquation89">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\color{blue}{\boldsymbol{{28.74}}}$\end{document}</tex-math>
                </inline-formula>
              </td>
              <td rowspan="1" colspan="1">
                <inline-formula>
                  <tex-math notation="LaTeX" id="ImEquation90">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\color{red}{\boldsymbol{{25.95}}}$\end{document}</tex-math>
                </inline-formula>
              </td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">
                <bold>AUROC(%)<inline-formula><tex-math notation="LaTeX" id="ImEquation91">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\uparrow $\end{document}</tex-math></inline-formula></bold>
              </td>
              <td rowspan="1" colspan="1">scNovel w/o BN</td>
              <td rowspan="1" colspan="1">94.85</td>
              <td rowspan="1" colspan="1">89.15</td>
              <td rowspan="1" colspan="1">93.42</td>
              <td rowspan="1" colspan="1">91.58</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1">scNovel w/o ELU</td>
              <td rowspan="1" colspan="1">
                <inline-formula>
                  <tex-math notation="LaTeX" id="ImEquation92">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\color{blue}{\boldsymbol{{96.03}}}$\end{document}</tex-math>
                </inline-formula>
              </td>
              <td rowspan="1" colspan="1">
                <inline-formula>
                  <tex-math notation="LaTeX" id="ImEquation93">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\color{blue}{\boldsymbol{{93.47}}}$\end{document}</tex-math>
                </inline-formula>
              </td>
              <td rowspan="1" colspan="1">
                <inline-formula>
                  <tex-math notation="LaTeX" id="ImEquation94">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\color{blue}{\boldsymbol{{94.24}}}$\end{document}</tex-math>
                </inline-formula>
              </td>
              <td rowspan="1" colspan="1">
                <inline-formula>
                  <tex-math notation="LaTeX" id="ImEquation95">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\color{blue}{\boldsymbol{{93.01}}}$\end{document}</tex-math>
                </inline-formula>
              </td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1">scNovel</td>
              <td rowspan="1" colspan="1">
                <inline-formula>
                  <tex-math notation="LaTeX" id="ImEquation96">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\color{red}{\boldsymbol{{96.33}}}$\end{document}</tex-math>
                </inline-formula>
              </td>
              <td rowspan="1" colspan="1">
                <inline-formula>
                  <tex-math notation="LaTeX" id="ImEquation97">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\color{red}{\boldsymbol{{94.29}}}$\end{document}</tex-math>
                </inline-formula>
              </td>
              <td rowspan="1" colspan="1">
                <inline-formula>
                  <tex-math notation="LaTeX" id="ImEquation98">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\color{red}{\boldsymbol{{94.64}}}$\end{document}</tex-math>
                </inline-formula>
              </td>
              <td rowspan="1" colspan="1">
                <inline-formula>
                  <tex-math notation="LaTeX" id="ImEquation99">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\color{red}{\boldsymbol{{94.16}}}$\end{document}</tex-math>
                </inline-formula>
              </td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">AUPR(%)<inline-formula><tex-math notation="LaTeX" id="ImEquation100">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\uparrow $\end{document}</tex-math></inline-formula></td>
              <td rowspan="1" colspan="1">scNovel w/o BN</td>
              <td rowspan="1" colspan="1">99.74</td>
              <td rowspan="1" colspan="1">99.09</td>
              <td rowspan="1" colspan="1">98.46</td>
              <td rowspan="1" colspan="1">95.88</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1">scNovel w/o ELU</td>
              <td rowspan="1" colspan="1">
                <inline-formula>
                  <tex-math notation="LaTeX" id="ImEquation101">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\color{blue}{\boldsymbol{{99.77}}}$\end{document}</tex-math>
                </inline-formula>
              </td>
              <td rowspan="1" colspan="1">
                <inline-formula>
                  <tex-math notation="LaTeX" id="ImEquation102">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\color{blue}{\boldsymbol{{99.35}}}$\end{document}</tex-math>
                </inline-formula>
              </td>
              <td rowspan="1" colspan="1">
                <inline-formula>
                  <tex-math notation="LaTeX" id="ImEquation103">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\color{blue}{\boldsymbol{{98.56}}}$\end{document}</tex-math>
                </inline-formula>
              </td>
              <td rowspan="1" colspan="1">
                <inline-formula>
                  <tex-math notation="LaTeX" id="ImEquation104">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\color{blue}{\boldsymbol{{97.03}}}$\end{document}</tex-math>
                </inline-formula>
              </td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1">scNovel</td>
              <td rowspan="1" colspan="1">
                <inline-formula>
                  <tex-math notation="LaTeX" id="ImEquation105">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\color{red}{\boldsymbol{{99.78}}}$\end{document}</tex-math>
                </inline-formula>
              </td>
              <td rowspan="1" colspan="1">
                <inline-formula>
                  <tex-math notation="LaTeX" id="ImEquation106">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\color{red}{\boldsymbol{{99.41}}}$\end{document}</tex-math>
                </inline-formula>
              </td>
              <td rowspan="1" colspan="1">
                <inline-formula>
                  <tex-math notation="LaTeX" id="ImEquation107">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\color{red}{\boldsymbol{{98.70}}}$\end{document}</tex-math>
                </inline-formula>
              </td>
              <td rowspan="1" colspan="1">
                <inline-formula>
                  <tex-math notation="LaTeX" id="ImEquation108">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\color{red}{\boldsymbol{{97.72}}}$\end{document}</tex-math>
                </inline-formula>
              </td>
            </tr>
          </tbody>
        </table>
      </table-wrap>
    </app>
    <app>
      <title>E. Discussion of scNovel and scBalance</title>
      <p>The recent work named scBalance [<xref rid="ref16" ref-type="bibr">16</xref>] focuses on identifying rare cell types in large datasets, while we focus on novel rare cell detection. We explain it in detail below. The scBalance specializes in classifying rare cells into known categories within single-cell sequencing datasets, unable to identify previously unknown cell types. In contrast, scNovel is aimed at detecting novel rare cell types by determining if a cell type has been observed before, thus capable of identifying new cell types beyond mere classification. The main limitation of scBalance is its inability to classify cells outside its trained categories, leading to potential misclassification. scNovel addresses this by detecting cells that don’t fit into known categories, improving accuracy in identifying novel cell types. However, scNovel could be enhanced with a more robust architecture and refined scoring function to better distinguish between typical and novel cell distributions, indicating areas for future improvement in both models. We employ the same network architecture like scBalance and loss function, while we propose new score functions (<inline-formula><tex-math notation="LaTeX" id="ImEquation230">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$S^{ODIN}$\end{document}</tex-math></inline-formula>, <inline-formula><tex-math notation="LaTeX" id="ImEquation231">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$S^{SEQ}$\end{document}</tex-math></inline-formula> and <inline-formula><tex-math notation="LaTeX" id="ImEquation232">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$S^{SIM}$\end{document}</tex-math></inline-formula>) to further improve performance. Therefore, if we directly apply scBalance for novel rare cell detection, the performance will be degraded to the performance of SMSP. Therefore, the experiment comparison between scNovel and scBalance is shown in <xref rid="TB3" ref-type="table">Appendix Table 3</xref>, while <inline-formula><tex-math notation="LaTeX" id="ImEquation233">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$S^{MSP}$\end{document}</tex-math></inline-formula> is the performance of scBalance.</p>
    </app>
  </app-group>
</back>
<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.2 20190208//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.2?>
<?ConverterInfo.XSLTName jats2jats3.xsl?>
<?ConverterInfo.Version 1?>
<?properties open_access?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Brief Bioinform</journal-id>
    <journal-id journal-id-type="iso-abbrev">Brief Bioinform</journal-id>
    <journal-id journal-id-type="publisher-id">bib</journal-id>
    <journal-title-group>
      <journal-title>Briefings in Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1467-5463</issn>
    <issn pub-type="epub">1477-4054</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">10981759</article-id>
    <article-id pub-id-type="pmid">38555470</article-id>
    <article-id pub-id-type="doi">10.1093/bib/bbae112</article-id>
    <article-id pub-id-type="publisher-id">bbae112</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Problem Solving Protocol</subject>
      </subj-group>
      <subj-group subj-group-type="category-taxonomy-collection">
        <subject>AcademicSubjects/SCI01060</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>scNovel: a scalable deep learning-based network for novel rare cell discovery in single-cell transcriptomics</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Zheng</surname>
          <given-names>Chuanyang</given-names>
        </name>
        <aff><institution>Department of Computer Science and Engineering</institution>, <addr-line>CUHK, Hong Kong SAR</addr-line>, <country country="CN">China</country></aff>
        <xref rid="afn1" ref-type="author-notes"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Wang</surname>
          <given-names>Yixuan</given-names>
        </name>
        <aff><institution>Department of Computer Science and Engineering</institution>, <addr-line>CUHK, Hong Kong SAR</addr-line>, <country country="CN">China</country></aff>
        <xref rid="afn1" ref-type="author-notes"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Cheng</surname>
          <given-names>Yuqi</given-names>
        </name>
        <aff><institution>College of Computing, Georgia Institute of Technology</institution>, <addr-line>Atlanta, GA</addr-line>, <country country="US">USA</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Wang</surname>
          <given-names>Xuesong</given-names>
        </name>
        <aff><institution>Department of Computer Science and Engineering</institution>, <addr-line>CUHK, Hong Kong SAR</addr-line>, <country country="CN">China</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Wei</surname>
          <given-names>Hongxin</given-names>
        </name>
        <aff>
          <institution>MLR Lab, Southern University of Science and Technology</institution>
        </aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>King</surname>
          <given-names>Irwin</given-names>
        </name>
        <aff><institution>Department of Computer Science and Engineering</institution>, <addr-line>CUHK, Hong Kong SAR</addr-line>, <country country="CN">China</country></aff>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <name>
          <surname>Li</surname>
          <given-names>Yu</given-names>
        </name>
        <!--liyu@cse.cuhk.edu.hk-->
        <aff><institution>Department of Computer Science and Engineering</institution>, <addr-line>CUHK, Hong Kong SAR</addr-line>, <country country="CN">China</country></aff>
        <aff><institution>The CUHK Shenzhen Research Institute</institution>, <addr-line>Hi-Tech Park, Nanshan, Shenzhen 518057</addr-line>, <country country="CN">China</country></aff>
        <aff><institution>Institute for Medical Enginering and Science, Massachusetts Institute of Technology</institution>, <addr-line>Cambridge, MA</addr-line>, <country country="US">USA</country></aff>
        <aff><institution>Wyss Institute for Biologically Inspired Engineering, Harvard University</institution>, <addr-line>Boston, MA</addr-line>, <country country="US">USA</country></aff>
        <aff><institution>Broad Institute of MIT and Harvard, Cambridge</institution>, <addr-line>MA</addr-line>, <country country="US">USA</country></aff>
        <xref rid="cor1" ref-type="corresp"/>
      </contrib>
    </contrib-group>
    <author-notes>
      <corresp id="cor1">Corresponding author. Yu Li, E-mail: <email>liyu@cse.cuhk.edu.hk</email></corresp>
      <fn id="afn1">
        <p>Chuanyang Zheng and Yixuan Wang contributed equally.</p>
      </fn>
    </author-notes>
    <pub-date pub-type="collection">
      <month>5</month>
      <year>2024</year>
    </pub-date>
    <pub-date pub-type="epub" iso-8601-date="2024-03-28">
      <day>28</day>
      <month>3</month>
      <year>2024</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>28</day>
      <month>3</month>
      <year>2024</year>
    </pub-date>
    <volume>25</volume>
    <issue>3</issue>
    <elocation-id>bbae112</elocation-id>
    <history>
      <date date-type="received">
        <day>13</day>
        <month>12</month>
        <year>2023</year>
      </date>
      <date date-type="rev-recd">
        <day>5</day>
        <month>2</month>
        <year>2024</year>
      </date>
      <date date-type="accepted">
        <day>20</day>
        <month>2</month>
        <year>2024</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2024. Published by Oxford University Press.</copyright-statement>
      <copyright-year>2024</copyright-year>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">https://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted reuse, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <self-uri xlink:href="bbae112.pdf"/>
    <abstract>
      <title>Abstract</title>
      <p>Single-cell RNA sequencing has achieved massive success in biological research fields. Discovering novel cell types from single-cell transcriptomics has been demonstrated to be essential in the field of biomedicine, yet is time-consuming and needs prior knowledge. With the unprecedented boom in cell atlases, auto-annotation tools have become more prevalent due to their speed, accuracy and user-friendly features. However, existing tools have mostly focused on general cell-type annotation and have not adequately addressed the challenge of discovering novel rare cell types. In this work, we introduce scNovel, a powerful deep learning-based neural network that specifically focuses on novel rare cell discovery. By testing our model on diverse datasets with different scales, protocols and degrees of imbalance, we demonstrate that scNovel significantly outperforms previous state-of-the-art novel cell detection models, reaching the most AUROC performance(the only one method whose averaged AUROC results are above 94%, up to 16.26% more comparing to the second-best method). We validate scNovel’s performance on a million-scale dataset to illustrate the scalability of scNovel further. Applying scNovel on a clinical COVID-19 dataset, three potential novel subtypes of Macrophages are identified, where the COVID-related differential genes are also detected to have consistent expression patterns through deeper analysis. We believe that our proposed pipeline will be an important tool for high-throughput clinical data in a wide range of applications.</p>
    </abstract>
    <kwd-group>
      <kwd>novel rare cell discovery</kwd>
      <kwd>single-cell analysis</kwd>
      <kwd>neural network</kwd>
    </kwd-group>
    <funding-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>Research Grants Council of the Hong Kong Special Administrative Region</institution>
          </institution-wrap>
        </funding-source>
        <award-id>CUHK 24204023</award-id>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>Innovation and Technology Commission of the Hong Kong Special Administrative Region</institution>
          </institution-wrap>
        </funding-source>
        <award-id>GHP/065/21SZ</award-id>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>Chinese University of Hong Kong</institution>
            <institution-id institution-id-type="DOI">10.13039/501100004853</institution-id>
          </institution-wrap>
        </funding-source>
        <award-id>4937025</award-id>
        <award-id>4937026</award-id>
        <award-id>5501517</award-id>
        <award-id>5501329</award-id>
      </award-group>
    </funding-group>
    <counts>
      <page-count count="15"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec id="sec1">
    <title>INTRODUCTION</title>
    <p>Single-cell RNA sequencing (scRNA-seq), established by Tang et al. in 2009 [<xref rid="ref1" ref-type="bibr">1</xref>], rapidly becomes popular and important in various biological research field analyses. As a powerful method to profile cell-specific level transcriptome, scRNA-seq makes it possible to analyze individual cells and provide insight into cell heterogeneity and has been widely used in organismal atlases generation [<xref rid="ref2" ref-type="bibr">2–6</xref>], COVID analysis [<xref rid="ref7" ref-type="bibr">7–9</xref>], cancer research [<xref rid="ref10" ref-type="bibr">10</xref>, <xref rid="ref11" ref-type="bibr">11</xref>], developmental biology research [<xref rid="ref12" ref-type="bibr">12</xref>], and so on.</p>
    <p>Cell type-specific analysis is a crucial topic in single-cell research and is traditionally carried out by grouping the cell points and then labeling them with marker genes [<xref rid="ref13" ref-type="bibr">13–15</xref>]. Auto-annotation tools are taking over as a result of the unheard-of surge in the production of cell atlases and their advantages in terms of speed, accuracy, and user-friendliness [<xref rid="ref16" ref-type="bibr">16</xref>]. In real-world single-cell analysis scenarios, the query dataset may contain novel cell types unseen in the reference set, and the distributions of the reference set and query set usually differ significantly. Hence, it is essential for a tool to not only precisely categorize cell types for query cells but also identify novel cell types that are not present in the reference dataset. Studies have shown the importance of discovering novel rare cells in the fields of biology and medicine. For instance, malignant tumors consist of a minority group of specific cancer stem cells (usually less than 1–2% of the total tumor cells based on the expression of certain cell surface markers) that possess a significant proliferative capacity [<xref rid="ref17" ref-type="bibr">17</xref>]. Thus, the capability of identifying novel rare cells in individual patients could lead to more personalized treatment approaches based on their unique cellular makeup [<xref rid="ref18" ref-type="bibr">18</xref>, <xref rid="ref19" ref-type="bibr">19</xref>]. However, most prior auto-annotation research concentrated on generic cell-type annotation [<xref rid="ref20" ref-type="bibr">20–24</xref>] and paid little attention to novel rare cell discovery.</p>
    <p>There have been previous endeavors in the field of novel cell discovery. scmap-cluster performs a nearest neighbor search to identify potential matches between cells from different datasets, and uses this information to construct a graph that captures the relationships between cells and clusters them based on their similarity [<xref rid="ref25" ref-type="bibr">25</xref>]. Similarly, scmap-cell uses an approximate nearest neighbor search method to efficiently find the K-nearest neighbors between the reference and query datasets, which helps reduce the computational complexity and improve the scalability of the algorithm when dealing with large datasets [<xref rid="ref25" ref-type="bibr">25</xref>]. scPred adopted a random forest classifier to predict cell-type labels, and incorporates unbiased feature selection and dimensionality reduction techniques to improve the accuracy and interpretability of the model [<xref rid="ref26" ref-type="bibr">26</xref>]. Through routine normalization, discriminative component analysis and learned transformation matrix, scLearn [<xref rid="ref27" ref-type="bibr">27</xref>] achieves the best performance on novel class detection, compared to the other previous methods. The major limitation of previous work is no one focused on novel rare cell detection and mainly utilized principal component analysis or discriminative component analysis for feature extraction so that the generated novel rare cell feature may lose information [<xref rid="ref28" ref-type="bibr">28</xref>]. The previous SOTA model scLearn even adds a method named rare cell-type filtering to remove rare cells from datasets.</p>
    <p>In this paper, we propose an integrated neural network framework, scNovel, that leverages barcode preprocessing for the auto-detection task. We develop two optional query stage options: the parallel query stage and the sequential query stage. Accordingly, barcode preprocessing is utilized to boost model performance via four modes of novel cell detection. To demonstrate the performance of novel rare cell detection performance of our method, we validate scNovel on various real datasets with different scales, different protocols, and different imbalance degrees. scNovel significantly outperforms previous state-of-the-art novel cell detection models, achieving the highest AUROC performance with statistical significance. scNovel is the only method whose averaged AUROC results are above 94%, up to 16.26% more compared to the second-best one. Furthermore, the scalability of scNovel is demonstrated through the robustness and efficiency across different scales of datasets. It is worth noticing that our work is the first and only novel rare cell discovery tool validated on a million-level atlas [<xref rid="ref29" ref-type="bibr">29</xref>]. We further apply scNovel on a clinical COVID-19 dataset, discover three potential novel subtypes of Macrophages and conduct a deeper analysis of the disease-related genes’ expression pattern.</p>
  </sec>
  <sec id="sec2">
    <title>METHODS</title>
    <sec id="sec2a">
      <title>A scalable neural nNetwork for novel rare cell-type discovery</title>
      <p>The basic architecture of our propsoed scNovel is a deep-neural-network-based classifier. As shown in <xref rid="f1" ref-type="fig">Figure 1</xref>, scNovel takes single-cell gene expression as input and outputs the novel cell detection result based on the classifier cell-type probability and the threshold <inline-formula><tex-math notation="LaTeX" id="ImEquation1">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\lambda $\end{document}</tex-math></inline-formula>. There are two stages of using scNovel. During the training stage, we adopt cross-entropy loss to train the model to output cell types’ probability prediction after the classifier. During the query stage, if <inline-formula><tex-math notation="LaTeX" id="ImEquation2">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$p(x)$\end{document}</tex-math></inline-formula> is smaller than the threshold, then the corresponding cells are determined as novel. To assess the novelty of a given cell type, we design four novel cell detection modes according to the selected query stage option, namely traditional classification mode, single plus-composition mode, parallel composition mode, as well as sequential composition mode (refer to more details in <xref rid="f7" ref-type="fig">Appendix Figure 1</xref>. A thorough explanation of the model framework and training strategy can be found in <xref rid="app3" ref-type="app">Appendix C</xref>. Once the considered score is over the threshold <inline-formula><tex-math notation="LaTeX" id="ImEquation3">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\lambda $\end{document}</tex-math></inline-formula> (usually defined as 0.5), we ascertain it to be novel. Through the conduction of comprehensive experiments, the predictive power of scNovel is promising even if the cell number and proportion are very small (17 cells out of a million cells). We use AUROC as our main evaluation metric while adopting AUPR and FPR95 metrics for additional reference. Please consult <xref rid="app2" ref-type="app">Appendix B</xref> for a detailed description of the evaluation metrics.</p>
      <fig position="float" id="f1">
        <label>Figure 1</label>
        <caption>
          <p>Overview of scNovel. The input <inline-formula><tex-math notation="LaTeX" id="ImEquation4">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\boldsymbol{x}$\end{document}</tex-math></inline-formula> is a single-cell gene expression. We employ a neural network to extract the single-cell feature. Then, map it <inline-formula><tex-math notation="LaTeX" id="ImEquation5">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$C^{ref}$\end{document}</tex-math></inline-formula> dimension to get cell-type probability prediction <inline-formula><tex-math notation="LaTeX" id="ImEquation6">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$p( \boldsymbol{x})$\end{document}</tex-math></inline-formula>. During the training stage, we employ the cross-entropy loss to optimize the network. We introduce two optional query stages, where barcode preprocessing is utilized to augment the predictive capabilities of scNovel. During the query stage, if <inline-formula><tex-math notation="LaTeX" id="ImEquation7">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$p(x)$\end{document}</tex-math></inline-formula> is smaller than the threshold, then the corresponding cells are determined as novel. In addition to separating novel cells from typical ones, scNovel could be extended to downstream analysis, including novel rare cell clusters detection and gene analysis.</p>
        </caption>
        <graphic xlink:href="bbae112f1" position="float"/>
      </fig>
    </sec>
  </sec>
  <sec id="sec3">
    <title>RESULTS</title>
    <sec id="sec3a">
      <title>Comprehensive assessment of the detection performance of scNovel</title>
      <p>In this section, we compare the performance of our method against existing cell-type classification tools, including scmap-cell and scmap-cluster [<xref rid="ref25" ref-type="bibr">25</xref>], scPred [<xref rid="ref26" ref-type="bibr">26</xref>] and scLearn [<xref rid="ref27" ref-type="bibr">27</xref>]. To ensure that our benchmark comparison is conducted under equitable experimental conditions, we employed a standardized preprocessing procedure for all the benchmark datasets and maintained the default values of all parameters for each method. We considered datasets from diverse imbalance degrees, diverse cell numbers, as well as diverse sequencing platforms to guarantee a more comprehensive comparison. Detailed re-implement and datasets’ information can be found in Appendices <xref rid="app1" ref-type="app">A</xref> and <xref rid="app3f" ref-type="sec">C.6</xref>. As detailed in <xref rid="TB1" ref-type="table">Appendix Table 1</xref>, our selection of datasets encompasses a wide range of widely utilized single-cell sequencing technologies, including 10Xv2 and 10Xv3, and so on. This broad spectrum of technologies was deliberately chosen to provide a robust validation of our method across different platforms, ensuring its generalizability and reliability in various single-cell sequencing contexts.</p>
      <p>As shown in <xref rid="TB2" ref-type="table">Appendix Table 2</xref>, compared with previous models, our proposed scNovel significantly improves the averaged performance via having the lowest FPR95 score, the highest AUROC and the highest AUPR scores on the novel rare cells discovery task among different datasets. Detailed description of the above-mentioned evaluation metrics can be found in the <xref rid="app2" ref-type="app">Appendix B</xref>. Given our emphasis on the detection of novel and rare cells, our initial evaluation of scNovel concentrates on its performance with a limited set of novel cell classes that are absent from the training data. In this context, we use the notation <inline-formula><tex-math notation="LaTeX" id="ImEquation15">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$C^{novel}$\end{document}</tex-math></inline-formula> to represent the number of novel classes present in the test set. From the results presented in <xref rid="TB2" ref-type="table">Appendix Table 2</xref>, it is noticeable that there is a decreasing trend in performance as the number of novel classes (<inline-formula><tex-math notation="LaTeX" id="ImEquation16">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$C^{novel}$\end{document}</tex-math></inline-formula>) increases. This indicates that the task becomes progressively more challenging as the number of novel classes in the test set increases. Namely, scNovel achieves a 96.33% AUROC when <inline-formula><tex-math notation="LaTeX" id="ImEquation17">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$C^{novel}$\end{document}</tex-math></inline-formula> is equal to 1, surpassing the next best performing method, scLearn, by a substantial margin of 12.33% AUROC. Across all <inline-formula><tex-math notation="LaTeX" id="ImEquation18">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$C^{novel}$\end{document}</tex-math></inline-formula>, our scNovel gains on an average 11.75% AUROC more compared to the second best method scLearn, demonstrating that scNovel is robust for different <inline-formula><tex-math notation="LaTeX" id="ImEquation19">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$C^{novel}$\end{document}</tex-math></inline-formula>, and is outstanding compared to other models. The box plots in <xref rid="f2" ref-type="fig">Figure 2(A)</xref> further demonstrate the robustness of scNovel by showing not only higher AUROC values but also smaller interquartile ranges across various dataset sizes (<inline-formula><tex-math notation="LaTeX" id="ImEquation20">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\sim $\end{document}</tex-math></inline-formula> 1k cells to <inline-formula><tex-math notation="LaTeX" id="ImEquation21">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\sim $\end{document}</tex-math></inline-formula> 60k cells) and different protocols. The statistical analysis, using a one-tailed <italic toggle="yes">t</italic>-test, consistently demonstrates that scNovel outperforms other methods with significant statistical significance in most scenarios. This indicates that the adopted neural network shows robust performance for single-cell sequencing feature extraction and works well for novel rare-cell feature extraction. The cell-type distribution and detection results are visualized in <xref rid="f2" ref-type="fig">Figure 2(B)</xref>.</p>
      <fig position="float" id="f2">
        <label>Figure 2</label>
        <caption>
          <p>(<bold>A</bold>) AUROCs of different methods with various <inline-formula><tex-math notation="LaTeX" id="ImEquation52">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$C^{novel}$\end{document}</tex-math></inline-formula>. The box plots show that scNovel has higher mean but smaller interquartile range of AUROCs than all the other methods, showing a stable novel rare cell detection ability among various datasets and <inline-formula><tex-math notation="LaTeX" id="ImEquation53">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$C^{novel}$\end{document}</tex-math></inline-formula>. <italic toggle="yes">P</italic>-value with notation * means <italic toggle="yes">P</italic>¡0.05, with notation <inline-formula><tex-math notation="LaTeX" id="ImEquation54">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$ns$\end{document}</tex-math></inline-formula> means no significance. The heatmaps show the detailed AUROC values of different methods and datasets. (<bold>B</bold>) Cell-type UMAP visualization of Zilionis dataset. (<bold>C</bold>) The AUROC curves of various methods are evaluated, with scNovel demonstrating superior TPR over all other methods, regardless of the FPR. (<bold>D</bold>) UMAP visualization of the novel cell discovery task on the Zilionis dataset with <inline-formula><tex-math notation="LaTeX" id="ImEquation55">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$C^{novel}$\end{document}</tex-math></inline-formula>=2. The result of scNovel is the closest to the ground truth, while the other ones have too many false positive predictions. scNovel outperforms other methods in detecting novel rare cell types, uniquely identifying pDC and RBC. Unlike scLearn, scPred, scmap-cell and scmap-cluster, which inaccurately annotate T cells and Neutrophils, scNovel achieves the most precise detection across all cell types, successfully pinpointing RBC and pDC.</p>
        </caption>
        <graphic xlink:href="bbae112f2" position="float"/>
      </fig>
      <p>We also show the AUROC curves in <xref rid="f2" ref-type="fig">Figure 2(C)</xref>. for the Zilionis dataset with <inline-formula><tex-math notation="LaTeX" id="ImEquation56">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$C^{novel}=2$\end{document}</tex-math></inline-formula>. According to the AUROC curve, we could find that scNovel not only dominates in AUROC space [<xref rid="ref30" ref-type="bibr">30</xref>] but also achieves superior true positive rate (TPR) over all other methods, regardless of the FPR. As shown in <xref rid="f2" ref-type="fig">Figure 2(B and D)</xref>, Notably, scNovel has the best novel rare cell detection performance and is the only method that can detect the two novel rare cell types, including plasmacytoid dendritic cell (pDC) and red blood cell (RBC). Compared with the ground truth label, scLearn, scPred, scmap-cell and scmap-cluster give more incorrect annotations on the T cell and Neutrophils than scNovel. scPred even almost fails on this task, as it detects the majority of cells to be novel. In contrast, scNovel demonstrates the most accurate novel rare cell detection result on all cell types and successfully finds the two novel rare cells, RBC and pDC.</p>
    </sec>
    <sec id="sec3b">
      <title>Consistent performance with various C<sup>novel</sup> in different modes</title>
      <p>In this section, we investigate our model performance with various novel cell class numbers <inline-formula><tex-math notation="LaTeX" id="ImEquation58">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$C^{novel}$\end{document}</tex-math></inline-formula> in different modes. We begin with showing our model performance with four different query modes:</p>
      <list list-type="bullet">
        <list-item>
          <p><inline-formula><tex-math notation="LaTeX" id="ImEquation59">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$S^{MSP}$\end{document}</tex-math></inline-formula> in Equation (<xref rid="deqn06" ref-type="disp-formula">C6</xref>), which uses the maximum prediction probability as score;</p>
        </list-item>
        <list-item>
          <p><inline-formula><tex-math notation="LaTeX" id="ImEquation60">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$S^{ODIN}$\end{document}</tex-math></inline-formula> in Equation (<xref rid="deqn10" ref-type="disp-formula">C10</xref>), which utilizes only <inline-formula><tex-math notation="LaTeX" id="ImEquation61">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$T_{minus}$\end{document}</tex-math></inline-formula> barcode preprocessing;</p>
        </list-item>
        <list-item>
          <p><inline-formula><tex-math notation="LaTeX" id="ImEquation62">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$S^{SEQ}$\end{document}</tex-math></inline-formula> in Equation (<xref rid="deqn13" ref-type="disp-formula">C13</xref>), which sequentially utilizes <inline-formula><tex-math notation="LaTeX" id="ImEquation63">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$T_{minus}$\end{document}</tex-math></inline-formula> and <inline-formula><tex-math notation="LaTeX" id="ImEquation64">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$T_{plus}$\end{document}</tex-math></inline-formula> barcode preprocessing;</p>
        </list-item>
        <list-item>
          <p><inline-formula><tex-math notation="LaTeX" id="ImEquation65">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$S^{SIM}$\end{document}</tex-math></inline-formula> in Equation (<xref rid="deqn12" ref-type="disp-formula">C12</xref>), which simultaneously employs <inline-formula><tex-math notation="LaTeX" id="ImEquation66">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$T_{minus}$\end{document}</tex-math></inline-formula> and <inline-formula><tex-math notation="LaTeX" id="ImEquation67">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$T_{plus}$\end{document}</tex-math></inline-formula> barcode preprocessing.</p>
        </list-item>
      </list>
      <p>Through the detailed ablation study (<xref rid="TB4" ref-type="table">Appendix Table 4</xref> and <xref rid="f3" ref-type="fig">Figure 3A</xref>), we come to the conclusion that <inline-formula><tex-math notation="LaTeX" id="ImEquation68">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$S^{SIM}$\end{document}</tex-math></inline-formula> should be the best mode for novel rare cell-type discovery tasks. Therefore, future efforts will focus on devising more sophisticated methods, potentially exploring various forms of sharpness metrics (as shown in Equations <xref rid="deqn12" ref-type="disp-formula">C12</xref> and <xref rid="deqn13" ref-type="disp-formula">C13</xref>), to enhance the distinction between typical and novel cells, thereby further elevating the model’s performance. We then investigate scNovel’s performance with different <inline-formula><tex-math notation="LaTeX" id="ImEquation69">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$C^{novel}$\end{document}</tex-math></inline-formula> of <inline-formula><tex-math notation="LaTeX" id="ImEquation70">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$S^{SIM}$\end{document}</tex-math></inline-formula> mode in <xref rid="f3" ref-type="fig">Figure 3(B and C)</xref> in detail. Overall, scNovel has the best average performance across all datasets, as well as has the smallest variance (<xref rid="f3" ref-type="fig">Figure 3C</xref>) when <inline-formula><tex-math notation="LaTeX" id="ImEquation71">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$C^{novel}$\end{document}</tex-math></inline-formula> is 1. To be specific, scNovel gets 22.82% FPR95, 96.33% AUROC and 99.76% AUPR when the model is only required to predict one novel cell type. Detailed AUROC performance on each dataset is shown in <xref rid="f3" ref-type="fig">Figure 3(B)</xref>. Intuitively, as <inline-formula><tex-math notation="LaTeX" id="ImEquation72">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$C^{novel}$\end{document}</tex-math></inline-formula> increases, the novel cell distribution <inline-formula><tex-math notation="LaTeX" id="ImEquation73">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\mathcal{P}_{novel}$\end{document}</tex-math></inline-formula> becomes more and more complicated. As a consequence, the AUROCs of <inline-formula><tex-math notation="LaTeX" id="ImEquation74">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$C^{novel}$\end{document}</tex-math></inline-formula>=2, 3 and 4 decrease to 94.29, 94.6 and 94.16%, respectively. <xref rid="f3" ref-type="fig">Figure 3(D)</xref> shows the accumulated AUROCs of each novel cell type of dataset Zillion with various <inline-formula><tex-math notation="LaTeX" id="ImEquation75">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$C^{novel}$\end{document}</tex-math></inline-formula>. <xref rid="f3" ref-type="fig">Figure 3(E)</xref> shows the corresponding data-split settings of the four <inline-formula><tex-math notation="LaTeX" id="ImEquation76">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$C^{novel}$\end{document}</tex-math></inline-formula>. With the increase of <inline-formula><tex-math notation="LaTeX" id="ImEquation77">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$C^{novel}$\end{document}</tex-math></inline-formula>, the AUROCs of RBC are stable. This also suggests that the novel rare cell detection performance of scNovel is mainly affected by the cell type, and it is robust to the various <inline-formula><tex-math notation="LaTeX" id="ImEquation78">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$C^{novel}$\end{document}</tex-math></inline-formula>. In <xref rid="f3" ref-type="fig">Figure 3(F)</xref>, we have presented a comparative analysis of UMAP visualizations for scNovel, utilizing a threshold of 0.5, against the ground truth for the task of novel cell discovery within the Zilionis dataset. This comparison indicates that our proposed scNovel method achieves consistently meaningful visualization performance across different values of <inline-formula><tex-math notation="LaTeX" id="ImEquation79">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$C^{novel}$\end{document}</tex-math></inline-formula>, employing a default threshold of 0.5.</p>
      <fig position="float" id="f3">
        <label>Figure 3</label>
        <caption>
          <p>(<bold>A</bold>) The box plots of AUROCs of different novel cell detection modes with <inline-formula><tex-math notation="LaTeX" id="ImEquation109">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$C^{novel}$\end{document}</tex-math></inline-formula> ranging from 1 to 4. (<bold>B</bold>) Heatmap of the detailed AUROC values of <inline-formula><tex-math notation="LaTeX" id="ImEquation110">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$S^{SIM}$\end{document}</tex-math></inline-formula> mode on all the considered datasets. (<bold>C</bold>) The violin plot of the <inline-formula><tex-math notation="LaTeX" id="ImEquation111">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$S^{SIM}$\end{document}</tex-math></inline-formula> mode of scNovel’s AUROCs with different novel class numbers <inline-formula><tex-math notation="LaTeX" id="ImEquation112">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$C^{novel}$\end{document}</tex-math></inline-formula> on various datasets. We could find that the performance of scNovel is stable with various <inline-formula><tex-math notation="LaTeX" id="ImEquation113">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$C^{novel}$\end{document}</tex-math></inline-formula>. (<bold>D</bold>) The accumulation bar plot of AUROC values of each novel rare cell detected from the Zillion dataset with <inline-formula><tex-math notation="LaTeX" id="ImEquation114">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$C^{novel}$\end{document}</tex-math></inline-formula> ranging from 1 to 4. (<bold>E</bold>) Taking the Zillion dataset as an example, the bar plot shows the experimental setting with different <inline-formula><tex-math notation="LaTeX" id="ImEquation115">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$C^{novel}$\end{document}</tex-math></inline-formula>. (<bold>F</bold>) The UMAP visualization comparison between scNovel and the ground truth of the novel cell discovery task on the Zilionis dataset with different <inline-formula><tex-math notation="LaTeX" id="ImEquation116">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$C^{novel}$\end{document}</tex-math></inline-formula>.</p>
        </caption>
        <graphic xlink:href="bbae112f3" position="float"/>
      </fig>
    </sec>
    <sec id="sec3c">
      <title>Superiority in rare population identification under batch effects</title>
      <p>In the real application scenario, training and applying the rare cell detection tools can be conducted on different dataset protocols and platforms with heavy batch effects. These systematic variations are crucial, particularly when analyzing rare cell populations, and must be carefully addressed to ensure accurate and reliable results. Therefore, as shown in <xref rid="f4" ref-type="fig">Figure 4(A and B)</xref>, we collect PBMCbench datasets from 10Xv2, 10Xv3, Drop-Seq, Cel-Seq, InDrop and Seq-Well are considered to evaluate scNovel’s ability to detect novel rare cells across platforms</p>
      <fig position="float" id="f4">
        <label>Figure 4</label>
        <caption>
          <p>(<bold>A</bold>) Overall novel rare cell detection AUROCs on the datasets generated by different protocols, with reference dataset PBMC Cel-Seq. (<bold>B</bold>) Overall novel rare cell detection AUROCs on the datasets generated by different protocols, with the reference dataset PBMC 10X Chromium v3. (<bold>C</bold>) The UMAP visualization of ground truth cell-type, AUROC curves and the UMAP visualization of novel cell discovery task of various methods. All methods are trained on PBMC Cel-Seq, and tested on PBMC 10X Chromium v3. Only scNovel and scLearn detect all Megakaryocyte cells, while scNovel has few false positive predictions than scLearn.</p>
        </caption>
        <graphic xlink:href="bbae112f4" position="float"/>
      </fig>
      <p>scLearn, which is the second-best model in intra-platform experiments, is shown to suffer from the effect of batch effects, achieving only 78.95% for Cel-Seq reference dataset (<xref rid="f4" ref-type="fig">Figure 4A</xref>) and 80.61% for 10Xv3 reference dataset (<xref rid="f4" ref-type="fig">Figure 4B</xref>). Our proposed scNovel outperforms scmap-cluster by 6% and scLearn by 16%, suggesting that scNovel is robust to the potential obstacles in cross-platform annotation tasks. To further investigate the performance of model performance under batch effect, we show the UMAP visualization result and AUROC results in <xref rid="f4" ref-type="fig">Figure 4(C)</xref>, with Cel-Seq as reference set and test on 10Xv3 set query set. There are two novel cell types, including Dentritic cells and Megakaryocyte. Only scNovel and scLearn successfully detect all Megakaryocyte cells, while scmap-cell, scmap-cluster, and scPred miss a part of Megakaryocyte cells. Compared with scLearn, our proposed scNovel has even fewer false positive predictions, while scLearn wrongly detects CD16+ monocyte and Cytotoxic T Cell to be novel. Also, according to the AUROC curve, we could find that our proposed scNovel has a better TPR than all other models, regardless of the FPR. This proves that our proposed scNovel upholds its excellent performance in the novel rare cell-type discovery tasks under the impact of systematic variations.</p>
    </sec>
    <sec id="sec3d">
      <title>Enhanced scalability of scNovel through robust processing efficiency in million-level dataset</title>
      <p>In the context of real-world single-cell analysis, computational efficiency is of vital importance and is viewed as the main impediment to achieving scalability. From <xref rid="f5" ref-type="fig">Figure 5A</xref>, the running time of scNovel remains relatively consistent across datasets with varying samples. For the datasets with more than 30k cells, scNovel reduces the runtime by up to 25% compared to the fastest of our four comparison models, scmap-cluster. On the analysis of the largest dataset, TM, scNovel provides a computation speed over 120 times faster than scPred, showing that our proposed method has the potential to facilitate rapid novel cell detection of large-scale datasets. Our analysis shows the model’s running time is mainly influenced by two factors: computation and weight updates, and Pytorch Dataloader preparation, which remains constant across datasets. However, smaller datasets require more frequent Dataloader preparations, leading to longer running times, as seen with the Darmanis dataset compared to the larger Zilionis dataset. Hence, dataset size directly affects the model’s overall running time. The significance of scalability for detection tools becomes more pronounced as the size of the cell atlas increases.</p>
      <fig position="float" id="f5">
        <label>Figure 5</label>
        <caption>
          <p>(<bold>A</bold>) Time complexity analysis of different methods on datasets with different scales. scNovel exhibits exceptional scalability, requiring the least amount of time even when processing TM dataset that scales up to 60k cells. (<bold>B</bold>) Experiment setting of COVID Altas. (<bold>C</bold>) The <inline-formula><tex-math notation="LaTeX" id="ImEquation117">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\mathcal{D}_{query}^{novel}$\end{document}</tex-math></inline-formula> cell number statistic and each cell-type detection results. The <inline-formula><tex-math notation="LaTeX" id="ImEquation118">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\mathcal{D}_{query}^{novel}$\end{document}</tex-math></inline-formula> has 10 cell types and total of 9332 cells. We could find that the novel rare cell detection results are not affected by the cell number. The mast, the rarest cell, is detected better than Macro-EREG, whose cell number is large. (<bold>D</bold>) Results of novel rare cell detection with different score functions. (<bold>E</bold>) Cell-type UMAP visualization of the considered COVID-19 immune atlas. (<bold>F</bold>) UMAP visualization of the novel cell discovery task of scNovel on the COVID-19 immune atlas with <inline-formula><tex-math notation="LaTeX" id="ImEquation119">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$C^{novel}$\end{document}</tex-math></inline-formula> = 10.</p>
        </caption>
        <graphic xlink:href="bbae112f5" position="float"/>
      </fig>
      <p>To further validate the robustness of our performance on a large, imbalanced dataset, we apply scNovel to a million-scale scRNA-seq dataset COVID-19 immune atlas [<xref rid="ref29" ref-type="bibr">29</xref>](1 462 702 cells). The scRNA-seq dataset COVID-19 immune atlas has 64 cell types, divided into three groups, including healthy, moderate (COVID) and severe(COVID). The healthy group has 54 cell types,while 10 cell types only appear in COVID groups (shown in <xref rid="f5" ref-type="fig">Figure 5B</xref>), and the 10 cell types are selected as novel cell types. We further elaborate on the impact of the 10 specific cell types on our experimental outcomes, as illustrated in the results presented in <xref rid="f5" ref-type="fig">Figure 5(C)</xref>. Shown in <xref rid="f5" ref-type="fig">Figure 5(D)</xref>, the performance of <inline-formula><tex-math notation="LaTeX" id="ImEquation120">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$S^{MSP}$\end{document}</tex-math></inline-formula> mode is lower than that of <inline-formula><tex-math notation="LaTeX" id="ImEquation121">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$S^{ODIN}$\end{document}</tex-math></inline-formula> mode, <inline-formula><tex-math notation="LaTeX" id="ImEquation122">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$S^{SEQ}$\end{document}</tex-math></inline-formula> mode and <inline-formula><tex-math notation="LaTeX" id="ImEquation123">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$S^{SIM}$\end{document}</tex-math></inline-formula> mode, which suggests the importance of barcode preprocessing. <xref rid="f5" ref-type="fig">Figure 5(C)</xref> shows that the Epi cell types, including Epi-Squamous, Epi-Secretory, Epi-Ciliated, and Epi-AT2, have low FPR95, high AUROC, and high AUPR. The underlying reason is that Epi cell types only appear in <inline-formula><tex-math notation="LaTeX" id="ImEquation124">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\mathcal{D}_{query}^{novel}$\end{document}</tex-math></inline-formula> so that it is easier for our model to detect them. For the same reason, the Mast, which only has 17 cells, has the same high AUROC. In contrast, the performance is relatively lower in Macro-DNAJB1, Macro-EREG, Neu-FGF23, Neu-RSAD2 and DC-LAMP3. For Macro-DNAJB1 and Macro-EREG, there are other subgroup cells of Macro in <inline-formula><tex-math notation="LaTeX" id="ImEquation125">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\mathcal{D}_{ref}$\end{document}</tex-math></inline-formula>, such as Macro-C1QC and Macro-CCL3L1. For Neu-FGF23 and Neu-RSAD2, there are Neu-IL1B and Neu-CST7 in <inline-formula><tex-math notation="LaTeX" id="ImEquation126">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\mathcal{D}_{ref}$\end{document}</tex-math></inline-formula>. For DC-LAMP3, the <inline-formula><tex-math notation="LaTeX" id="ImEquation127">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\mathcal{D}_{ref}$\end{document}</tex-math></inline-formula> contains DC-CLEC9A and DC-LILRA4. We could notice that the novel rare cell detection performance is not related to the cell numbers. The mast, the rarest cell, is detected better than Macro-EREG, whose cell number is large. As shown in <xref rid="f5" ref-type="fig">Figure 5(E) and (F)</xref>, scNovel is capable of accurately identifying 10 novel rare cell types that are exclusively present in COVID-19 cases within datasets comprising millions of cells. This achievement underscores the scalability of scNovel and highlights its potential for deployment in large-scale real-world applications.</p>
    </sec>
    <sec id="sec3e">
      <title>Potential novel subtypes discovery and functional investigation in bronchoalveolar immune cell atlas in COVID patient</title>
      <p>Studies have shown the importance of cell-type-specific analysis of the genetic heterogeneity of specific cell types in the field of biomedicine [<xref rid="ref31" ref-type="bibr">31</xref>]. For instance, COVID single-cell atlas [<xref rid="ref29" ref-type="bibr">29</xref>] detects 64 cell types further to analyze the relationship between cell gene expression and diseases. However, the detection process of novel cell types is time-consuming and needs prior knowledge. Our proposed scNovel could find novel rare cells automatically: (1) detect the novel cells of the query set; (2) employ Leiden clustering to generate cell clusters; and (3) utilize the novel cell clusters for further analysis.</p>
      <p>In this study, with a 1.5-million-scale dataset as the reference set, we apply the above analysis pipeline to a published COVID-19 dataset [<xref rid="ref32" ref-type="bibr">32</xref>] (GEO accession number GSE171524), containing 116 314 cells collected from 7 healthy controls and 20 COVID-19 samples. We show the UMAP visualization of cell-type annotation (<xref rid="f6" ref-type="fig">Figure 6A</xref>) and patient annotation (<xref rid="f6" ref-type="fig">Figure 6B</xref>). <xref rid="f6" ref-type="fig">Figure 6C</xref> presents the novel cell detection result. In our setting, B cell and T cell are present in the reference set, while AT1 and AT2 are left for testing. <xref rid="f6" ref-type="fig">Figure 6D</xref>, as detected by scNovel, illustrates the distributions of typical and novel cells, demonstrating the tool’s effectiveness in identifying and differentiating between cell types. Combining the results in <xref rid="f6" ref-type="fig">Figure 6C</xref> and <xref rid="f6" ref-type="fig">Figure 6D</xref>, we can find that B cell and T cell are less likely to be predicted to be novel, but AT1 and AT2 are detected as novel cells successfully. To further ensure the discovered novel cells are different from the cells in the reference set, we present the gene expression in <xref rid="f6" ref-type="fig">Figure 6E</xref>. It directly supports that the newly discovered cells are different from the cells in the reference set. We also carry out analysis on the gene differentiation of different novel cell clusters by showing the highest gene expression of each novel cell cluster and their relation in <xref rid="f6" ref-type="fig">Figure 6F</xref>. We find that clusters 3, 5, and 12 have high CD163 expression, which means that they may be subtypes of Macrophage. Then, we conduct deeper analyses of the selected three clusters to study the relationship between their gene expression and COVID-19. We show the expression level between the top 8 biomarkers in each cluster (<xref rid="f6" ref-type="fig">Figure 6G</xref>). From the volcano figure in <xref rid="f6" ref-type="fig">Figure 6H</xref>, seven genes have higher expression in COVID patients, and some are already supported by past research, including ADAMTS2 [<xref rid="ref33" ref-type="bibr">33</xref>], CD163 [<xref rid="ref34" ref-type="bibr">34</xref>, <xref rid="ref35" ref-type="bibr">35</xref>], CEBPB [<xref rid="ref36" ref-type="bibr">36</xref>], CTSD, LDLRAD3, NEAT1 [<xref rid="ref37" ref-type="bibr">37</xref>] and TPST1. Moreover, nine genes have lower expression in COVID patients, which are also supported by the existing works, including ATG77 [<xref rid="ref38" ref-type="bibr">38</xref>], CSF2RA [<xref rid="ref39" ref-type="bibr">39</xref>], DST, FARP1, FRMD4A, HLA-DPB1, HLA-DRB1, RASAL2 and TFRC. Rather than only analyzing differential gene expression in a single cluster, selecting biomarkers that satisfy all three criteria in the dependent clusters makes the analysis results more reliable. Finally, we conducted a Gene Ontology (GO) analysis in <xref rid="f6" ref-type="fig">Figure 6I</xref>, supplemented by gene set enrichment analysis, to investigate changes in biological pathways between macrophages with differing COVID statuses. Our results indicate significant upregulation in COVID samples, particularly in neutrophil activation related to immune response, neutrophil degranulation, and neutrophil-mediated immunity. By applying scNovel to a COVID-19 dataset, we have demonstrated its effectiveness in accurately identifying unique cell types. This success suggests the potential of scNovel as a critical tool in accelerating diagnostics and response in future pandemics or diseases.</p>
      <fig position="float" id="f6">
        <label>Figure 6</label>
        <caption>
          <p>(<bold>A</bold>) UMAP visualization of each cell type in the query dataset. There are a total of 19 cell types. (<bold>B</bold>) UMAP visualization of patient distribution. (<bold>C</bold>) The Leiden clustering results of detected novel cells. In total, there are 24 new cell types. (<bold>D</bold>) UMAP visualization of the novel cell detection result via scNovel with threshold 0.45. (<bold>E</bold>) The stacked violin plot overview of the gene expression in typical cells of reference set and new cell types. According to the gene expression, the new cell clusters are different from the typical cells in the reference set. (<bold>F</bold>) The stacked dot plot overview of the top-important marker genes expression for each cell type. (<bold>G</bold>) The comparison of the expression level between the top 8 biomarkers in the COVID group and the rest of the patients. (<bold>H</bold>) The Volcano figure of cluster 3, cluster 5 and cluster 12. (<bold>I</bold>) GO analysis in novel Macrophages between COVID samples and Healthy Samples. </p>
        </caption>
        <graphic xlink:href="bbae112f6" position="float"/>
      </fig>
    </sec>
  </sec>
  <sec id="sec4">
    <title>DISCUSSION</title>
    <p>The development of scRNA-seq methods has increased the demand for single-cell analysis tools. Previous research works mainly focus on cell-type annotation, but pay little attention to novel rare cell discovery task, which is important for classifier’s reliability and cell discovery. To the best of our knowledge, we are the first one focusing on novel rare cell discovery, and we propose the first corresponding auto-detection model named scNovel, an open-source Python package that integrates neural network and barcode preprocessing. With extensive experiments on several scRNA-seq datasets with different scales, different generation protocols and different <inline-formula><tex-math notation="LaTeX" id="ImEquation128">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$C^{novel}$\end{document}</tex-math></inline-formula>, we have demonstrated an effective novel rare cell discovery ability. We have also shown the fast running speed of scNovel on datasets with different scales, which proves the scalability. Moreover, we evaluate our model on a million-level dataset, which further shown the scalability and novel rare cell discovery capacity. Also, we employ the scNovel to detect novel rare cell clusters for more trustable disease gene analysis.</p>
    <p>In future work, we have several suggestions for scNovel improvement. Firstly, a better score function could improve scNovel performance. Specifically, we could utilize up-sharpness and down-sharpness multiple times. Secondly, we could employ more biology information. For instance, we leverage both scRNA-Seq and single-cell chromatin accessibility sequencing for novel rare cell discovery. In all, we believe that scNovel is an effective and efficient tool for single-cell analysis, especially its ability and scalability of rare cell types.</p>
    <boxed-text id="box01" position="float">
      <sec id="sec27">
        <title>Key Points</title>
        <list list-type="bullet">
          <list-item>
            <p>scNovel is a scalable deep learning-based network for novel rare cell discovery in single-cell transcriptomics, and the first method to use the barcode preprocessing on novel rare cell detection on the scRNA-seq data.</p>
          </list-item>
          <list-item>
            <p>We apply scNovel on extensive intra-dataset and inter-protocol novel rare cell detection experiments, even considering a large, imbalanced million-scale dataset. Notably, it achieves an average AUROC performance exceeding 94%, surpassing the second-best method by up to 16.26%.</p>
          </list-item>
          <list-item>
            <p>Within the context of the profoundly imbalanced clinical COVID-19 dataset, a comprehensive analysis has unveiled the existence of three promising novel subtypes of macrophages.</p>
          </list-item>
          <list-item>
            <p>We developed a pipeline for the identification of novel rare cells and the analysis of differential gene expression. Our proposed scNovel-based analytical framework extends beyond its application to COVID-19, as it can be seamlessly tailored to investigate genes associated with various other diseases.</p>
          </list-item>
        </list>
      </sec>
    </boxed-text>
  </sec>
</body>
<back>
  <sec id="sec7a">
    <title>ACKNOWLEDGEMENT</title>
    <p>The work described in this paper was partially supported by a grant from the Research Grants Council of the Hong Kong Special Administrative Region, China [Project No.: CUHK 24204023], and a grant from Innovation and Technology Commission of the Hong Kong Special Administrative Region, China [Project No.: GHP/065/21SZ]. This research is funded by Chinese University of Hong Kong (CUHK) with the award number 4937025, 4937026, 5501517, 5501329.</p>
  </sec>
  <sec id="sec7">
    <title>AUTHOR CONTRIBUTIONS</title>
    <p>Y.L. conceived and supervised the project. C.Z., Y.C. and H.W. designed the method and all benchmark experiments. C.Z. implemented the tool in Python. C.Z, X.W. and Y.W performed data analysis and all computational experiments. C.Z., Y.W. Y.C. and H.W. wrote the manuscript together. All authors reviewed the manuscript.</p>
  </sec>
  <sec id="sec6">
    <title>CODE AVAILABILITY</title>
    <p>scNovel is available as an independent python package at <ext-link xlink:href="https://github.com/chuanyang-Zheng/scNovel" ext-link-type="uri">https://github.com/chuanyang-Zheng/scNovel</ext-link>.</p>
  </sec>
  <sec sec-type="data-availability" id="sec5">
    <title>DATA AVAILABILITY</title>
    <p>No new data was generated from this study. All data used in this study is publicly available as shown in <xref rid="TB1" ref-type="table">Appendix Table 1</xref>.</p>
  </sec>
  <ref-list id="bib1">
    <title>References</title>
    <ref id="ref1">
      <label>1.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Tang</surname><given-names>F</given-names></string-name>, <string-name><surname>Barbacioru</surname><given-names>C</given-names></string-name>, <string-name><surname>Wang</surname><given-names>Y</given-names></string-name>, <etal>et al.</etal></person-group><article-title>mRNA-Seq whole-transcriptome analysis of a single cell</article-title>. <source>Nat Methods</source><year>2009</year>;<volume>6</volume>:<fpage>377</fpage>–<lpage>82</lpage>.<pub-id pub-id-type="pmid">19349980</pub-id></mixed-citation>
    </ref>
    <ref id="ref2">
      <label>2.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Klein</surname><given-names>AM</given-names></string-name>, <string-name><surname>Mazutis</surname><given-names>L</given-names></string-name>, <string-name><surname>Akartuna</surname><given-names>I</given-names></string-name>, <etal>et al.</etal></person-group><article-title>Droplet barcoding for single-cell transcriptomics applied to embryonic stem cells</article-title>. <source>Cell</source><year>2015</year>;<volume>161</volume>:<fpage>1187</fpage>–<lpage>201</lpage>.<pub-id pub-id-type="pmid">26000487</pub-id></mixed-citation>
    </ref>
    <ref id="ref3">
      <label>3.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Guo</surname><given-names>G</given-names></string-name>, <string-name><surname>Huss</surname><given-names>M</given-names></string-name>, <string-name><surname>Tong</surname><given-names>GQ</given-names></string-name>, <etal>et al.</etal></person-group><article-title>Resolution of cell fate decisions revealed by single-cell gene expression analysis from zygote to blastocyst</article-title>. <source>Dev Cell</source><year>2010</year>;<volume>18</volume>:<fpage>675</fpage>–<lpage>85</lpage>.<pub-id pub-id-type="pmid">20412781</pub-id></mixed-citation>
    </ref>
    <ref id="ref4">
      <label>4.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><collab>Tabula Muris Consortium</collab>.</person-group><article-title>Single-cell transcriptomics of 20 mouse organs creates a Tabula Muris</article-title>. <source>Nature</source><year>2018</year>;<volume>562</volume>:<fpage>367</fpage>–<lpage>72</lpage>.<pub-id pub-id-type="pmid">30283141</pub-id></mixed-citation>
    </ref>
    <ref id="ref5">
      <label>5.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Zheng</surname><given-names>GX</given-names></string-name>, <string-name><surname>Terry</surname><given-names>JM</given-names></string-name>, <string-name><surname>Belgrader</surname><given-names>P</given-names></string-name>, <etal>et al.</etal></person-group><article-title>Massively parallel digital transcriptional profiling of single cells</article-title>. <source>Nat Commun</source><year>2017</year>;<volume>8</volume>:<fpage>1</fpage>–<lpage>12</lpage>.<pub-id pub-id-type="pmid">28232747</pub-id></mixed-citation>
    </ref>
    <ref id="ref6">
      <label>6.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Davie</surname><given-names>K</given-names></string-name>, <string-name><surname>Janssens</surname><given-names>J</given-names></string-name>, <string-name><surname>Koldere</surname><given-names>D</given-names></string-name>, <etal>et al.</etal></person-group><article-title>A single-cell transcriptome atlas of the aging drosophila brain</article-title>. <source>Cell</source><year>2018</year>;<volume>174</volume>:<fpage>982</fpage>–<lpage>998.e20</lpage>.<pub-id pub-id-type="pmid">29909982</pub-id></mixed-citation>
    </ref>
    <ref id="ref7">
      <label>7.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Horning</surname><given-names>AM</given-names></string-name>, <string-name><surname>Wang</surname><given-names>Y</given-names></string-name>, <string-name><surname>Lin</surname><given-names>CK</given-names></string-name>, <etal>et al.</etal></person-group><article-title>Single-cell RNA-seq reveals a subpopulation of prostate cancer cells with enhanced cell-cycle–related transcription and attenuated androgen response</article-title>. <source>Cancer Res</source><year>2018</year>;<volume>78</volume>:<fpage>853</fpage>–<lpage>64</lpage>.<pub-id pub-id-type="pmid">29233929</pub-id></mixed-citation>
    </ref>
    <ref id="ref8">
      <label>8.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Nyquist</surname><given-names>MD</given-names></string-name>, <string-name><surname>Corella</surname><given-names>A</given-names></string-name>, <string-name><surname>Coleman</surname><given-names>I</given-names></string-name>, <etal>et al.</etal></person-group><article-title>Combined TP53 and RB1 loss promotes prostate cancer resistance to a spectrum of therapeutics and confers vulnerability to replication stress</article-title>. <source>Cell Rep</source><year>2020</year>;<volume>31</volume>:107669.</mixed-citation>
    </ref>
    <ref id="ref9">
      <label>9.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Chen</surname><given-names>Y</given-names></string-name>, <string-name><surname>Wang</surname><given-names>Y</given-names></string-name>, <string-name><surname>Chen</surname><given-names>Y</given-names></string-name>, <etal>et al.</etal></person-group><article-title>Deep autoencoder for interpretable tissue-adaptive deconvolution and cell-type-specific gene analysis</article-title>. <source>Nat Commun</source><year>2022</year>;<volume>13</volume>:<fpage>6735</fpage>.<pub-id pub-id-type="pmid">36347853</pub-id></mixed-citation>
    </ref>
    <ref id="ref10">
      <label>10.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Guo</surname><given-names>C</given-names></string-name>, <string-name><surname>Li</surname><given-names>B</given-names></string-name>, <string-name><surname>Ma</surname><given-names>H</given-names></string-name>, <etal>et al.</etal></person-group><article-title>Single-cell analysis of two severe Covid-19 patients reveals a monocyte-associated and tocilizumab-responding cytokine storm</article-title>. <source>Nat Commun</source><year>2020</year>;<volume>11</volume>:<fpage>1</fpage>–<lpage>11</lpage>.<pub-id pub-id-type="pmid">31911652</pub-id></mixed-citation>
    </ref>
    <ref id="ref11">
      <label>11.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Wilk</surname><given-names>AJ</given-names></string-name>, <string-name><surname>Rustagi</surname><given-names>A</given-names></string-name>, <string-name><surname>Zhao</surname><given-names>NQ</given-names></string-name>, <etal>et al.</etal></person-group><article-title>A single-cell atlas of the peripheral immune response in patients with severe Covid-19</article-title>. <source>Nat Med</source><year>2020</year>;<volume>26</volume>:<fpage>1070</fpage>–<lpage>6</lpage>.<pub-id pub-id-type="pmid">32514174</pub-id></mixed-citation>
    </ref>
    <ref id="ref12">
      <label>12.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Guo</surname><given-names>L</given-names></string-name>, <string-name><surname>Lin</surname><given-names>L</given-names></string-name>, <string-name><surname>Wang</surname><given-names>X</given-names></string-name>, <etal>et al.</etal></person-group><article-title>Resolving cell fate decisions during somatic cell reprogramming by single-cell RNA-seq</article-title>. <source>Mol Cell</source><year>2019</year>;<volume>73</volume>:<fpage>815</fpage>–<lpage>829.e7</lpage>.<pub-id pub-id-type="pmid">30772174</pub-id></mixed-citation>
    </ref>
    <ref id="ref13">
      <label>13.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Ianevski</surname><given-names>A</given-names></string-name>, <string-name><surname>Giri</surname><given-names>AK</given-names></string-name>, <string-name><surname>Aittokallio</surname><given-names>T</given-names></string-name></person-group>. <article-title>Fully-automated and ultra-fast cell-type identification using specific marker combinations from single-cell transcriptomic data</article-title>. <source>Nat Commun</source><year>2022</year>;<volume>13</volume>:<fpage>1</fpage>–<lpage>10</lpage>.<pub-id pub-id-type="pmid">34983933</pub-id></mixed-citation>
    </ref>
    <ref id="ref14">
      <label>14.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Pasquini</surname><given-names>G</given-names></string-name>, <string-name><surname>Arias</surname><given-names>JER</given-names></string-name>, <string-name><surname>Schäfer</surname><given-names>P</given-names></string-name>, <string-name><surname>Busskamp</surname><given-names>V</given-names></string-name></person-group>. <article-title>Automated methods for cell type annotation on scRNA-seq data</article-title>. <source>Comput Struct Biotechnol J</source><year>2021</year>;<volume>19</volume>:<fpage>961</fpage>–<lpage>9</lpage>.<pub-id pub-id-type="pmid">33613863</pub-id></mixed-citation>
    </ref>
    <ref id="ref15">
      <label>15.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Han</surname><given-names>W</given-names></string-name>, <string-name><surname>Cheng</surname><given-names>Y</given-names></string-name>, <string-name><surname>Chen</surname><given-names>J</given-names></string-name>, <etal>et al.</etal></person-group><article-title>Self-supervised contrastive learning for integrative single cell RNA-seq data analysis</article-title>. <source>Brief Bioinform</source><year>2022</year>;<volume>23</volume>.</mixed-citation>
    </ref>
    <ref id="ref16">
      <label>16.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Cheng</surname><given-names>Y</given-names></string-name>, <string-name><surname>Fan</surname><given-names>X</given-names></string-name>, <string-name><surname>Zhang</surname><given-names>J</given-names></string-name>, <string-name><surname>Li</surname><given-names>Y</given-names></string-name></person-group>. <article-title>A scalable sparse neural network framework for rare cell type annotation of single-cell transcriptome data</article-title>. <source>Commun Biol</source><year>2023</year>;<volume>6</volume>:<fpage>545</fpage>.<pub-id pub-id-type="pmid">37210444</pub-id></mixed-citation>
    </ref>
    <ref id="ref17">
      <label>17.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Huang</surname><given-names>EH</given-names></string-name>, <string-name><surname>Heidt</surname><given-names>DG</given-names></string-name>, <string-name><surname>Li</surname><given-names>C-W</given-names></string-name>, <string-name><surname>Simeone</surname><given-names>DM</given-names></string-name></person-group>. <article-title>Cancer stem cells: a new paradigm for understanding tumor progression and therapeutic resistance</article-title>. <source>Surgery</source><year>2007</year>;<volume>141</volume>:<fpage>415</fpage>–<lpage>9</lpage>.<pub-id pub-id-type="pmid">17383517</pub-id></mixed-citation>
    </ref>
    <ref id="ref18">
      <label>18.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Garraway</surname><given-names>LA</given-names></string-name>, <string-name><surname>Jänne</surname><given-names>PA</given-names></string-name></person-group>. <article-title>Circumventing cancer drug resistance in the era of personalized medicine</article-title>. <source>Cancer Discov</source><year>2012</year>;<volume>2</volume>:<fpage>214</fpage>–<lpage>26</lpage>.<pub-id pub-id-type="pmid">22585993</pub-id></mixed-citation>
    </ref>
    <ref id="ref19">
      <label>19.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Krepler</surname><given-names>C</given-names></string-name>, <string-name><surname>Xiao</surname><given-names>M</given-names></string-name>, <string-name><surname>Sproesser</surname><given-names>K</given-names></string-name>, <etal>et al.</etal></person-group><article-title>Personalized preclinical trials in BRAF inhibitor–resistant patient-derived xenograft models identify second-line combination therapies</article-title>. <source>Clin Cancer Res</source><year>2016</year>;<volume>22</volume>:<fpage>1592</fpage>–<lpage>602</lpage>.<pub-id pub-id-type="pmid">26673799</pub-id></mixed-citation>
    </ref>
    <ref id="ref20">
      <label>20.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Butler</surname><given-names>A</given-names></string-name>, <string-name><surname>Hoffman</surname><given-names>P</given-names></string-name>, <string-name><surname>Smibert</surname><given-names>P</given-names></string-name>, <etal>et al.</etal></person-group><article-title>Integrating single-cell transcriptomic data across different conditions, technologies, and species</article-title>. <source>Nat Biotechnol</source><year>2018</year>;<volume>36</volume>:<fpage>411</fpage>–<lpage>20</lpage>.<pub-id pub-id-type="pmid">29608179</pub-id></mixed-citation>
    </ref>
    <ref id="ref21">
      <label>21.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Wolf</surname><given-names>FA</given-names></string-name>, <string-name><surname>Angerer</surname><given-names>P</given-names></string-name>, <string-name><surname>Theis</surname><given-names>FJ</given-names></string-name></person-group>. <article-title>SCANPY: large-scale single-cell gene expression data analysis</article-title>. <source>Genome Biol</source><year>2018</year>;<volume>19</volume>:<fpage>1</fpage>–<lpage>5</lpage>.<pub-id pub-id-type="pmid">29301551</pub-id></mixed-citation>
    </ref>
    <ref id="ref22">
      <label>22.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Tan</surname><given-names>Y</given-names></string-name>, <string-name><surname>Cahan</surname><given-names>P</given-names></string-name></person-group>. <article-title>SingleCellNet: a computational tool to classify single cell RNA-seq data across platforms and across species</article-title>. <source>Cell Syst</source><year>2019</year>;<volume>9</volume>:<fpage>207</fpage>–<lpage>213.e2</lpage>.<pub-id pub-id-type="pmid">31377170</pub-id></mixed-citation>
    </ref>
    <ref id="ref23">
      <label>23.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Aran</surname><given-names>D</given-names></string-name>, <string-name><surname>Looney</surname><given-names>AP</given-names></string-name>, <string-name><surname>Liu</surname><given-names>L</given-names></string-name>, <etal>et al.</etal></person-group><article-title>Reference-based analysis of lung single-cell sequencing reveals a transitional profibrotic macrophage</article-title>. <source>Nat Immunol</source><year>2019</year>;<volume>20</volume>:<fpage>163</fpage>–<lpage>72</lpage>.<pub-id pub-id-type="pmid">30643263</pub-id></mixed-citation>
    </ref>
    <ref id="ref24">
      <label>24.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Lopez</surname><given-names>R</given-names></string-name>, <string-name><surname>Regier</surname><given-names>J</given-names></string-name>, <string-name><surname>Cole</surname><given-names>MB</given-names></string-name>, <etal>et al.</etal></person-group><article-title>Deep generative modeling for single-cell transcriptomics</article-title>. <source>Nat Methods</source><year>2018</year>;<volume>15</volume>:<fpage>1053</fpage>–<lpage>8</lpage>.<pub-id pub-id-type="pmid">30504886</pub-id></mixed-citation>
    </ref>
    <ref id="ref25">
      <label>25.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Kiselev</surname><given-names>VY</given-names></string-name>, <string-name><surname>Yiu</surname><given-names>A</given-names></string-name>, <string-name><surname>Hemberg</surname><given-names>M</given-names></string-name></person-group>. <article-title>scmap: projection of single-cell RNA-seq data across data sets</article-title>. <source>Nat Methods</source><year>2018</year>;<volume>15</volume>:<fpage>359</fpage>–<lpage>62</lpage>.<pub-id pub-id-type="pmid">29608555</pub-id></mixed-citation>
    </ref>
    <ref id="ref26">
      <label>26.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Alquicira-Hernandez</surname><given-names>J</given-names></string-name>, <string-name><surname>Sathe</surname><given-names>A</given-names></string-name>, <string-name><surname>Ji</surname><given-names>HP</given-names></string-name>, <etal>et al.</etal></person-group><article-title>scPRED: accurate supervised method for cell-type classification from single-cell RNA-seq data</article-title>. <source>Genome Biol</source><year>2019</year>;<volume>20</volume>:<fpage>1</fpage>–<lpage>17</lpage>.<pub-id pub-id-type="pmid">30606230</pub-id></mixed-citation>
    </ref>
    <ref id="ref27">
      <label>27.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Duan</surname><given-names>B</given-names></string-name>, <etal>et al.</etal></person-group><article-title>Learning for single-cell assignment</article-title>. <source>Sci Adv</source><year>2020</year>;<volume>6</volume>:<fpage>eabd0855</fpage>.<pub-id pub-id-type="pmid">33127686</pub-id></mixed-citation>
    </ref>
    <ref id="ref28">
      <label>28.</label>
      <mixed-citation publication-type="book"><person-group person-group-type="author"><string-name><surname>Xanthopoulos</surname><given-names>P</given-names></string-name>, <string-name><surname>Pardalos</surname><given-names>PM</given-names></string-name>, <string-name><surname>Trafalis</surname><given-names>TB</given-names></string-name></person-group>. <article-title>Principal component analysis</article-title>. In: <source>Robust Data Mining</source>.
<publisher-name>Springer</publisher-name>. Springer Science &amp; Business Media <year>2013</year>, <fpage>21</fpage>–<lpage>6</lpage>.</mixed-citation>
    </ref>
    <ref id="ref29">
      <label>29.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Ren</surname><given-names>X</given-names></string-name>, <string-name><surname>Wen</surname><given-names>W</given-names></string-name>, <string-name><surname>Fan</surname><given-names>X</given-names></string-name>, <etal>et al.</etal></person-group><article-title>Covid-19 immune features revealed by a large-scale single-cell transcriptome atlas</article-title>. <source>Cell</source><year>2021</year>;<volume>184</volume>:<fpage>1895</fpage>–<lpage>1913.e19</lpage>.<pub-id pub-id-type="pmid">33657410</pub-id></mixed-citation>
    </ref>
    <ref id="ref30">
      <label>30.</label>
      <mixed-citation publication-type="other"><person-group person-group-type="author"><string-name><surname>Davis</surname><given-names>J</given-names></string-name>, <string-name><surname>Goadrich</surname><given-names>M</given-names></string-name></person-group><article-title>The relationship between precision-recall and ROC curves</article-title>. In <source><italic toggle="yes">Proceedings of the 23rd international conference on Machine learning</italic></source>. Pennsylvania, USA: MIT Press, <year>2006</year>, <fpage>pp. 233</fpage>–<lpage>240</lpage>.</mixed-citation>
    </ref>
    <ref id="ref31">
      <label>31.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Velmeshev</surname><given-names>D</given-names></string-name>, <string-name><surname>Schirmer</surname><given-names>L</given-names></string-name>, <string-name><surname>Jung</surname><given-names>D</given-names></string-name>, <etal>et al.</etal></person-group><article-title>Single-cell genomics identifies cell type–specific molecular changes in autism</article-title>. <source>Science</source><year>2019</year>;<volume>364</volume>:<fpage>685</fpage>–<lpage>9</lpage>.<pub-id pub-id-type="pmid">31097668</pub-id></mixed-citation>
    </ref>
    <ref id="ref32">
      <label>32.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Melms</surname><given-names>JC</given-names></string-name>, <string-name><surname>Biermann</surname><given-names>J</given-names></string-name>, <string-name><surname>Huang</surname><given-names>H</given-names></string-name>, <etal>et al.</etal></person-group><article-title>A molecular single-cell lung atlas of lethal Covid-19</article-title>. <source>Nature</source><year>2021</year>;<volume>595</volume>:<fpage>114</fpage>–<lpage>9</lpage>.<pub-id pub-id-type="pmid">33915568</pub-id></mixed-citation>
    </ref>
    <ref id="ref33">
      <label>33.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Giovannoni</surname><given-names>F</given-names></string-name>, <string-name><surname>Li</surname><given-names>Z</given-names></string-name>, <string-name><surname>Remes-Lenicov</surname><given-names>F</given-names></string-name>, <etal>et al.</etal></person-group><article-title>AHR signaling is induced by infection with Coronaviruses</article-title>. <source>Nat Commun</source><year>2021</year>;<volume>12</volume>:<fpage>1</fpage>–<lpage>12</lpage>.<pub-id pub-id-type="pmid">33397941</pub-id></mixed-citation>
    </ref>
    <ref id="ref34">
      <label>34.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Delorey</surname><given-names>TM</given-names></string-name>, <string-name><surname>Ziegler</surname><given-names>CGK</given-names></string-name>, <string-name><surname>Heimberg</surname><given-names>G</given-names></string-name>, <etal>et al.</etal></person-group><article-title>Covid-19 tissue atlases reveal SARS-CoV-2 pathology and cellular targets</article-title>. <source>Nature</source><year>2021</year>;<volume>595</volume>:<fpage>107</fpage>–<lpage>13</lpage>.<pub-id pub-id-type="pmid">33915569</pub-id></mixed-citation>
    </ref>
    <ref id="ref35">
      <label>35.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Sacco</surname><given-names>K</given-names></string-name>, <string-name><surname>Castagnoli</surname><given-names>R</given-names></string-name>, <string-name><surname>Vakkilainen</surname><given-names>S</given-names></string-name>, <etal>et al.</etal></person-group><article-title>Immunopathological signatures in multisystem inflammatory syndrome in children and pediatric Covid-19</article-title>. <source>Nat Med</source><year>2022</year>;<volume>28</volume>:<fpage>1050</fpage>–<lpage>62</lpage>.<pub-id pub-id-type="pmid">35177862</pub-id></mixed-citation>
    </ref>
    <ref id="ref36">
      <label>36.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Amrute</surname><given-names>JM</given-names></string-name>, <string-name><surname>Perry</surname><given-names>AM</given-names></string-name>, <string-name><surname>Anand</surname><given-names>G</given-names></string-name>, <etal>et al.</etal></person-group><article-title>Cell specific peripheral immune responses predict survival in critical Covid-19 patients</article-title>. <source>Nat Commun</source><year>2022</year>;<volume>13</volume>:<fpage>1</fpage>–<lpage>11</lpage>.<pub-id pub-id-type="pmid">34983933</pub-id></mixed-citation>
    </ref>
    <ref id="ref37">
      <label>37.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Huang</surname><given-names>K</given-names></string-name>, <string-name><surname>Wang</surname><given-names>C</given-names></string-name>, <string-name><surname>Vagts</surname><given-names>C</given-names></string-name>, <etal>et al.</etal></person-group><article-title>Long non-coding RNAs (lncRNAs) NEAT1 and MALAT1 are differentially expressed in severe Covid-19 patients: an integrated single-cell analysis</article-title>. <source>PloS One</source><year>2022</year>;<volume>17</volume>:e0261242.</mixed-citation>
    </ref>
    <ref id="ref38">
      <label>38.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Baggen</surname><given-names>J</given-names></string-name>, <string-name><surname>Persoons</surname><given-names>L</given-names></string-name>, <string-name><surname>Vanstreels</surname><given-names>E</given-names></string-name>, <etal>et al.</etal></person-group><article-title>Genome-wide CRISPR screening identifies TMEM106B as a proviral host factor for SARS-CoV-2</article-title>. <source>Nat Genet</source><year>2021</year>;<volume>53</volume>:<fpage>435</fpage>–<lpage>44</lpage>.<pub-id pub-id-type="pmid">33686287</pub-id></mixed-citation>
    </ref>
    <ref id="ref39">
      <label>39.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Ruan</surname><given-names>D</given-names></string-name>, <string-name><surname>Ye</surname><given-names>ZW</given-names></string-name>, <string-name><surname>Yuan</surname><given-names>S</given-names></string-name>, <etal>et al.</etal></person-group><article-title>Human early syncytiotrophoblasts are highly susceptible to SARS-CoV-2 infection</article-title>. <source>Cell Rep Med</source><year>2022</year>;<volume>3</volume>:<fpage>100849</fpage>.<pub-id pub-id-type="pmid">36495872</pub-id></mixed-citation>
    </ref>
    <ref id="ref40">
      <label>40.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Darmanis</surname><given-names>S</given-names></string-name>, <string-name><surname>Sloan</surname><given-names>SA</given-names></string-name>, <string-name><surname>Zhang</surname><given-names>Y</given-names></string-name>, <etal>et al.</etal></person-group><article-title>A survey of human brain transcriptome diversity at the single cell level</article-title>. <source>Proc Natl Acad Sci</source><year>2015</year>;<volume>112</volume>:<fpage>7285</fpage>–<lpage>90</lpage>.<pub-id pub-id-type="pmid">26060301</pub-id></mixed-citation>
    </ref>
    <ref id="ref41">
      <label>41.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Muraro</surname><given-names>MJ</given-names></string-name>, <string-name><surname>Dharmadhikari</surname><given-names>G</given-names></string-name>, <string-name><surname>Grün</surname><given-names>D</given-names></string-name>, <etal>et al.</etal></person-group><article-title>A single-cell transcriptome atlas of the human pancreas</article-title>. <source>Cell Syst</source><year>2016</year>;<volume>3</volume>:<fpage>385</fpage>–<lpage>394.e3</lpage>.<pub-id pub-id-type="pmid">27693023</pub-id></mixed-citation>
    </ref>
    <ref id="ref42">
      <label>42.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Baron</surname><given-names>M</given-names></string-name>, <string-name><surname>Veres</surname><given-names>A</given-names></string-name>, <string-name><surname>Wolock</surname><given-names>SL</given-names></string-name>, <etal>et al.</etal></person-group><article-title>A single-cell transcriptomic map of the human and mouse pancreas reveals inter-and intra-cell population structure</article-title>. <source>Cell Syst</source><year>2016</year>;<volume>3</volume>:<fpage>346</fpage>–<lpage>360.e4</lpage>.<pub-id pub-id-type="pmid">27667365</pub-id></mixed-citation>
    </ref>
    <ref id="ref43">
      <label>43.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Ding</surname><given-names>J</given-names></string-name>, <string-name><surname>Adiconis</surname><given-names>X</given-names></string-name>, <string-name><surname>Simmons</surname><given-names>SK</given-names></string-name>, <etal>et al.</etal></person-group><article-title>Systematic comparison of single-cell and single-nucleus RNA-sequencing methods</article-title>. <source>Nat Biotechnol</source><year>2020</year>;<volume>38</volume>:<fpage>737</fpage>–<lpage>46</lpage>.<pub-id pub-id-type="pmid">32341560</pub-id></mixed-citation>
    </ref>
    <ref id="ref44">
      <label>44.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Campbell</surname><given-names>JN</given-names></string-name>, <string-name><surname>Macosko</surname><given-names>EZ</given-names></string-name>, <string-name><surname>Fenselau</surname><given-names>H</given-names></string-name>, <etal>et al.</etal></person-group><article-title>A molecular census of arcuate hypothalamus and median eminence cell types</article-title>. <source>Nat Neurosci</source><year>2017</year>;<volume>20</volume>:<fpage>484</fpage>–<lpage>96</lpage>.<pub-id pub-id-type="pmid">28166221</pub-id></mixed-citation>
    </ref>
    <ref id="ref45">
      <label>45.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Zilionis</surname><given-names>R</given-names></string-name>, <string-name><surname>Engblom</surname><given-names>C</given-names></string-name>, <string-name><surname>Pfirschke</surname><given-names>C</given-names></string-name>, <etal>et al.</etal></person-group><article-title>Single-cell transcriptomics of human and mouse lung cancers reveals conserved myeloid populations across individuals and species</article-title>. <source>Immunity</source><year>2019</year>;<volume>50</volume>:<fpage>1317</fpage>–<lpage>1334.e10</lpage>.<pub-id pub-id-type="pmid">30979687</pub-id></mixed-citation>
    </ref>
    <ref id="ref46">
      <label>46.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Schaum</surname><given-names>N</given-names></string-name>, <etal>et al.</etal></person-group><article-title>Single-cell transcriptomics of 20 mouse organs creates a Tabula Muris: the Tabula Muris consortium</article-title>. <source>Nature</source><year>2018</year>;<volume>562</volume>:<fpage>367</fpage>–<lpage>72</lpage>.<pub-id pub-id-type="pmid">30283141</pub-id></mixed-citation>
    </ref>
    <ref id="ref47">
      <label>47.</label>
      <mixed-citation publication-type="other"><person-group person-group-type="author"><string-name><surname>Liang</surname><given-names>S</given-names></string-name>, <string-name><surname>Li</surname><given-names>Y</given-names></string-name>, <string-name><surname>Srikant</surname><given-names>R</given-names></string-name></person-group><article-title>Enhancing the reliability of out-of-distribution image detection in neural networks</article-title>. In: <source>International Conference on Learning Representations</source>. Vancouver, Canada: Openreview.net, <year>2018</year>.</mixed-citation>
    </ref>
    <ref id="ref48">
      <label>48.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Fawcett</surname><given-names>T</given-names></string-name></person-group>. <article-title>An introduction to ROC analysis</article-title>. <source>Pattern Recogn Lett</source><year>2006</year>;<volume>27</volume>:<fpage>861</fpage>–<lpage>74</lpage>.</mixed-citation>
    </ref>
    <ref id="ref49">
      <label>49.</label>
      <mixed-citation publication-type="book"><person-group person-group-type="author"><string-name><surname>Manning</surname><given-names>C</given-names></string-name>, <string-name><surname>Schutze</surname><given-names>H</given-names></string-name></person-group>. <source>Foundations of Statistical Natural Language Processing</source>.USA,
<publisher-name>MIT press</publisher-name>, <year>1999</year>.</mixed-citation>
    </ref>
    <ref id="ref50">
      <label>50.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Saito</surname><given-names>T</given-names></string-name>, <string-name><surname>Rehmsmeier</surname><given-names>M</given-names></string-name></person-group>. <article-title>The precision-recall plot is more informative than the ROC plot when evaluating binary classifiers on imbalanced datasets</article-title>. <source>PloS One</source><year>2015</year>;<volume>10</volume>:e0118432.</mixed-citation>
    </ref>
    <ref id="ref51">
      <label>51.</label>
      <mixed-citation publication-type="other"><person-group person-group-type="author"><string-name><surname>Zhong</surname>, <given-names>Z.</given-names></string-name>, <string-name><surname>Cui</surname>, <given-names>J.</given-names></string-name>, <string-name><surname>Liu</surname>, <given-names>S.</given-names></string-name> &amp; <string-name><surname>Jia</surname>, <given-names>J.</given-names></string-name></person-group><article-title>Improving calibration for long-tailed recognition</article-title>. In: <source>Proceedings of the IEEE CVF Conference on Computer Vision and Pattern Recognition</source>. Nashville, USA: Institute of Electrical and Electronics Engineers, <year>2021</year>, pp. <fpage>16489</fpage>–<lpage>16498</lpage>.</mixed-citation>
    </ref>
    <ref id="ref52">
      <label>52.</label>
      <mixed-citation publication-type="other"><person-group person-group-type="author"><string-name><surname>Samuel</surname>, <given-names>D.</given-names></string-name> &amp; <string-name><surname>Chechik</surname>, <given-names>G.</given-names></string-name></person-group><article-title>Distributional robustness loss for long-tail learning</article-title>. In: <source>Proceedings of the IEEE CVF International Conference on Computer Vision</source>. Montreal, Canada: Institute of Electrical and Electronics Engineers, <year>2021</year>, pp. <fpage>9495</fpage>–<lpage>9504</lpage>.</mixed-citation>
    </ref>
    <ref id="ref53">
      <label>53.</label>
      <mixed-citation publication-type="other"><person-group person-group-type="author"><string-name><surname>Hendrycks</surname>, <given-names>D.</given-names></string-name> &amp; <string-name><surname>Gimpel</surname>, <given-names>K.</given-names></string-name></person-group><article-title>A baseline for detecting misclassified and out-of-distribution examples in neural networks</article-title>. <source>International Conference on Learning Representations</source>. Toulon, France: Openreviewer.net, <year>2017</year>.</mixed-citation>
    </ref>
    <ref id="ref54">
      <label>54.</label>
      <mixed-citation publication-type="other"><person-group person-group-type="author"><string-name><surname>Loshchilov</surname>, <given-names>I.</given-names></string-name> &amp; <string-name><surname>Hutter</surname>, <given-names>F.</given-names></string-name></person-group><article-title>Decoupled weight decay regularization</article-title>. In: <source>International Conference on Learning Representations</source>. New Orleans, USA: Openreview.net, <year>2019</year>.</mixed-citation>
    </ref>
  </ref-list>
  <app-group>
    <app id="app1a">
      <title>APPENDIX</title>
    </app>
    <app id="app1">
      <title>A. Datasets and preprocessings</title>
      <p>In this work, we considered a total of 15 single-cell expression datasets from small scale (<inline-formula><tex-math notation="LaTeX" id="ImEquation129">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\sim $\end{document}</tex-math></inline-formula>1k cells) to large scale (<inline-formula><tex-math notation="LaTeX" id="ImEquation130">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\sim $\end{document}</tex-math></inline-formula>1.5m cells). Detailed information on cell numbers, class numbers, sequencing protocols and sources of each dataset is shown in <xref rid="TB1" ref-type="table">Appendix Table 1</xref>. We incorporated datasets with different complexity and sequencing protocols to show the effectiveness and generalization of our proposed scNovel. We obtain the corresponding cell-type labels from their original paper to achieve the learning in a supervised manner.</p>
      <p>All of these labeled single-cell profiles went through the same preprocessing procedure to achieve more precise prediction results. To mitigate the impact of outlier genes, log transformation and normalization steps were implemented following the standard preprocessing pipeline outlined in the Scanpy [<xref rid="ref21" ref-type="bibr">21</xref>] tutorial, where the scale parameter was manually adjusted in the normalization function. We then split all the datasets using the following steps: (1) select the single-cell sequences of the top <inline-formula><tex-math notation="LaTeX" id="ImEquation131">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$C^{novel} \in \mathbb{N}^{+}$\end{document}</tex-math></inline-formula> most rare cell types from the dataset and utilize them to build <inline-formula><tex-math notation="LaTeX" id="ImEquation132">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\mathcal{D}_{query}^{novel}$\end{document}</tex-math></inline-formula>; (2) utilize 75% of the remaining data as <inline-formula><tex-math notation="LaTeX" id="ImEquation133">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\mathcal{D}_{ref}$\end{document}</tex-math></inline-formula>, and the other 25% of the remaining data as <inline-formula><tex-math notation="LaTeX" id="ImEquation134">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\mathcal{D}_{query}^{typical}$\end{document}</tex-math></inline-formula>; and (3) the <inline-formula><tex-math notation="LaTeX" id="ImEquation135">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\mathcal{D}_{ref}$\end{document}</tex-math></inline-formula> is employed for the reference set, while <inline-formula><tex-math notation="LaTeX" id="ImEquation136">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\mathcal{D}_{query}^{typical}$\end{document}</tex-math></inline-formula> and <inline-formula><tex-math notation="LaTeX" id="ImEquation137">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\mathcal{D}_{query}^{novel}$\end{document}</tex-math></inline-formula> are combined to build query set <inline-formula><tex-math notation="LaTeX" id="ImEquation138">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\mathcal{D}_{query}$\end{document}</tex-math></inline-formula>.</p>
    </app>
    <app id="app2">
      <title>B. Evaluation metrics</title>
      <p>We adopt the following three metrics to measure the performance of different models on the novel rare cell discovery task. A better model should have lower FPR95, higher AUROC and higher AUPR, following the previous works [<xref rid="ref26" ref-type="bibr">26</xref>, <xref rid="ref47" ref-type="bibr">47</xref>]. The AUROC is the most important evaluation metric as our dataset is imbalanced:</p>
      <list list-type="simple">
        <list-item>
          <p>(1) <bold>FPR95</bold>: FPR at 95% TPR is the probability that a negative sample (novel sample) is misclassified as a positive sample (typical sample) when the TPR is 95%.</p>
        </list-item>
        <list-item>
          <p>(2) <bold>AUROC</bold>: AUROC is the Area Under the Receiver Operating Characteristic curve, which is a threshold independent metric [<xref rid="ref30" ref-type="bibr">30</xref>]. The AUROC shows the relationship between TPR and FPR. It could be interpreted as the probability that a positive sample has a higher score than a negative sample [<xref rid="ref48" ref-type="bibr">48</xref>].</p>
        </list-item>
        <list-item>
          <p>(3) <bold>AUPR</bold>: AUPR is the Area Under the Precision-Recall curve, which is also a threshold independent metric [<xref rid="ref49" ref-type="bibr">49</xref>, <xref rid="ref50" ref-type="bibr">50</xref>]. It depicts the relationship between precision =<inline-formula><tex-math notation="LaTeX" id="ImEquation139">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\frac{TP}{TP+FP}$\end{document}</tex-math></inline-formula>and recall=<inline-formula><tex-math notation="LaTeX" id="ImEquation140">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\frac{TP}{TP+FN}$\end{document}</tex-math></inline-formula>. The AUPR is high in our experiments because the amount of novel cells is small compared to typical cells.</p>
        </list-item>
      </list>
    </app>
    <app id="app3">
      <title>C. Appendix methods</title>
      <sec id="app3a">
        <title>C.1 Neural network for rare cell feature extraction</title>
        <p>To better extract input features, we employ a neural network classifier. The single-cell transcriptome data are processed by a neural network classifier <inline-formula><tex-math notation="LaTeX" id="ImEquation141">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$f$\end{document}</tex-math></inline-formula> to get prediction probability <inline-formula><tex-math notation="LaTeX" id="ImEquation142">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$p(\boldsymbol{x})$\end{document}</tex-math></inline-formula>. The classifier has several hidden layers, whose structure is shown in <xref rid="f7" ref-type="fig">Appendix Figure 1</xref>. Besides a Fully-Connected Layer (FC) in each hidden layer, we utilize batch normalization (BN), Exponential Linear Unit (ELU) activation function and dropout sequentially to speed up training, avoid overfitting and elevate predictive performance. Our network design encompasses architecture, activation functions, and loss functions that are consistent with methodologies applied in similar studies focusing on rare cells and classes with limited quantities [<xref rid="ref16" ref-type="bibr">16</xref>, <xref rid="ref51" ref-type="bibr">51</xref>, <xref rid="ref52" ref-type="bibr">52</xref>]. This alignment underscores our commitment to precisely handling rare cells to enhance feature extraction and improve performance: </p>
        <disp-formula id="deqn01">
          <label>(C.1)</label>
          <tex-math notation="LaTeX" id="DmEquation1">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
\begin{align*}&amp; \begin{split} \boldsymbol{x}^{l-1}_{BN}&amp;=BN(\boldsymbol{x}^{l-1}),\\ \boldsymbol{x}^{l-1}_{ELU}&amp;=ELU(\boldsymbol{x}^{l-1}_{BN}),\\ \boldsymbol{x}^{l-1}_{Dropout}&amp;=Dropout(\boldsymbol{x}^{l-1}_{ELU}), \end{split}\end{align*}\end{document}</tex-math>
        </disp-formula>
        <p>where <inline-formula><tex-math notation="LaTeX" id="ImEquation143">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\boldsymbol{x}^{l-1}$\end{document}</tex-math></inline-formula> is the feature output of the <inline-formula><tex-math notation="LaTeX" id="ImEquation144">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$(l-1)$\end{document}</tex-math></inline-formula>th FC layer; ELU processes features with Equation (<xref rid="deqn02" ref-type="disp-formula">C.2</xref>) </p>
        <disp-formula id="deqn02">
          <label>(C.2)</label>
          <tex-math notation="LaTeX" id="DmEquation2">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
\begin{align*}&amp; ELU(\boldsymbol{x})=\left\{ \begin{array}{@{}lr} x,\quad if\ \boldsymbol{x} \geq 0, &amp;\\ \alpha e(e^{\boldsymbol{x}}-1),\quad if\ \boldsymbol{x} &lt; 0. &amp;\\ \end{array} \right.\end{align*}\end{document}</tex-math>
        </disp-formula>
        <table-wrap position="anchor" id="TB1">
          <label>Appendix Table 1</label>
          <caption>
            <p>Datasets considered</p>
          </caption>
          <table frame="hsides" rules="groups">
            <colgroup span="1">
              <col span="1" align="left"/>
              <col span="1" align="left"/>
              <col span="1" align="left"/>
              <col span="1" align="left"/>
              <col span="1" align="left"/>
            </colgroup>
            <thead>
              <tr>
                <th align="left" rowspan="1" colspan="1">Datasets</th>
                <th align="left" rowspan="1" colspan="1">Cell numbers</th>
                <th align="left" rowspan="1" colspan="1">Class numbers</th>
                <th align="left" rowspan="1" colspan="1">Protocols</th>
                <th align="left" rowspan="1" colspan="1">Source</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td rowspan="1" colspan="1">Darmains</td>
                <td rowspan="1" colspan="1">466</td>
                <td rowspan="1" colspan="1">9</td>
                <td rowspan="1" colspan="1">SMARTer</td>
                <td rowspan="1" colspan="1">Darmains <italic toggle="yes">et al</italic>. [<xref rid="ref40" ref-type="bibr">40</xref>]</td>
              </tr>
              <tr>
                <td rowspan="1" colspan="1">Muraro</td>
                <td rowspan="1" colspan="1">2122</td>
                <td rowspan="1" colspan="1">9</td>
                <td rowspan="1" colspan="1">Cel-Seq2</td>
                <td rowspan="1" colspan="1">Muraro <italic toggle="yes">et al</italic>. [<xref rid="ref41" ref-type="bibr">41</xref>]</td>
              </tr>
              <tr>
                <td rowspan="1" colspan="1">Baron Mouse</td>
                <td rowspan="1" colspan="1">1886</td>
                <td rowspan="1" colspan="1">13</td>
                <td rowspan="1" colspan="1">inDrop</td>
                <td rowspan="1" colspan="1">Baron <italic toggle="yes">et al</italic>. [<xref rid="ref42" ref-type="bibr">42</xref>]</td>
              </tr>
              <tr>
                <td rowspan="1" colspan="1">Baron Human</td>
                <td rowspan="1" colspan="1">8569</td>
                <td rowspan="1" colspan="1">14</td>
                <td rowspan="1" colspan="1">inDrop</td>
                <td rowspan="1" colspan="1">Baron <italic toggle="yes">et al</italic>. [<xref rid="ref42" ref-type="bibr">42</xref>]</td>
              </tr>
              <tr>
                <td rowspan="1" colspan="1">Seq-Well</td>
                <td rowspan="1" colspan="1">18 966</td>
                <td rowspan="1" colspan="1">7</td>
                <td rowspan="1" colspan="1">Seq-Well</td>
                <td rowspan="1" colspan="1">Ding <italic toggle="yes">et al</italic>. [<xref rid="ref43" ref-type="bibr">43</xref>]</td>
              </tr>
              <tr>
                <td rowspan="1" colspan="1">Campbell</td>
                <td rowspan="1" colspan="1">21 086</td>
                <td rowspan="1" colspan="1">35</td>
                <td rowspan="1" colspan="1">Drop-Seq</td>
                <td rowspan="1" colspan="1">Campbell <italic toggle="yes">et al</italic>. [<xref rid="ref44" ref-type="bibr">44</xref>]</td>
              </tr>
              <tr>
                <td rowspan="1" colspan="1">Zilionis</td>
                <td rowspan="1" colspan="1">34 558</td>
                <td rowspan="1" colspan="1">9</td>
                <td rowspan="1" colspan="1">inDrop</td>
                <td rowspan="1" colspan="1">Zilionis <italic toggle="yes">et al</italic>. [<xref rid="ref45" ref-type="bibr">45</xref>]</td>
              </tr>
              <tr>
                <td rowspan="1" colspan="1">TM</td>
                <td rowspan="1" colspan="1">54 865</td>
                <td rowspan="1" colspan="1">55</td>
                <td rowspan="1" colspan="1">10X Genomics</td>
                <td rowspan="1" colspan="1">Schaum <italic toggle="yes">et al</italic>. [<xref rid="ref46" ref-type="bibr">46</xref>]</td>
              </tr>
              <tr>
                <td rowspan="1" colspan="1">PbmcBench 10X (V2)</td>
                <td rowspan="1" colspan="1">23 154</td>
                <td rowspan="1" colspan="1">9</td>
                <td rowspan="1" colspan="1">10X Genomics (v2)</td>
                <td rowspan="1" colspan="1">Ding <italic toggle="yes">et al</italic>. [<xref rid="ref43" ref-type="bibr">43</xref>]</td>
              </tr>
              <tr>
                <td rowspan="1" colspan="1">PbmcBench 10X (V3)</td>
                <td rowspan="1" colspan="1">19 690</td>
                <td rowspan="1" colspan="1">8</td>
                <td rowspan="1" colspan="1">10X Genomics (v3)</td>
                <td rowspan="1" colspan="1">Ding <italic toggle="yes">et al</italic>. [<xref rid="ref43" ref-type="bibr">43</xref>]</td>
              </tr>
              <tr>
                <td rowspan="1" colspan="1">PbmcBench (CEL-Seq)</td>
                <td rowspan="1" colspan="1">19 754</td>
                <td rowspan="1" colspan="1">7</td>
                <td rowspan="1" colspan="1">CEL-Seq2</td>
                <td rowspan="1" colspan="1">Ding <italic toggle="yes">et al</italic>. [<xref rid="ref43" ref-type="bibr">43</xref>]</td>
              </tr>
              <tr>
                <td rowspan="1" colspan="1">PbmcBench (Drop-Seq)</td>
                <td rowspan="1" colspan="1">23 154</td>
                <td rowspan="1" colspan="1">9</td>
                <td rowspan="1" colspan="1">Drop-Seq</td>
                <td rowspan="1" colspan="1">Ding <italic toggle="yes">et al</italic>. [<xref rid="ref43" ref-type="bibr">43</xref>]</td>
              </tr>
              <tr>
                <td rowspan="1" colspan="1">PbmcBench (inDrop)</td>
                <td rowspan="1" colspan="1">21 832</td>
                <td rowspan="1" colspan="1">7</td>
                <td rowspan="1" colspan="1">inDrop</td>
                <td rowspan="1" colspan="1">Ding <italic toggle="yes">et al</italic>. [<xref rid="ref43" ref-type="bibr">43</xref>]</td>
              </tr>
              <tr>
                <td rowspan="1" colspan="1">PKU-Covid Atlas</td>
                <td rowspan="1" colspan="1">1 462 702</td>
                <td rowspan="1" colspan="1">64</td>
                <td rowspan="1" colspan="1">10X Genomics</td>
                <td rowspan="1" colspan="1">Ren et al. [<xref rid="ref29" ref-type="bibr">29</xref>]</td>
              </tr>
              <tr>
                <td rowspan="1" colspan="1">GSE171524</td>
                <td rowspan="1" colspan="1">116 314</td>
                <td rowspan="1" colspan="1">19</td>
                <td rowspan="1" colspan="1">10X Genomics</td>
                <td rowspan="1" colspan="1">Melms et al. [<xref rid="ref32" ref-type="bibr">32</xref>]</td>
              </tr>
            </tbody>
          </table>
        </table-wrap>
        <fig position="anchor" id="f7">
          <label>Appendix Figure 1</label>
          <caption>
            <p>Detailed Framework of scNovel. The input <inline-formula><tex-math notation="LaTeX" id="ImEquation8">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\boldsymbol{x}$\end{document}</tex-math></inline-formula> is a single-cell gene expression. We employ a neural network to extract the single-cell feature. Then, map it <inline-formula><tex-math notation="LaTeX" id="ImEquation9">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$C^{ref}$\end{document}</tex-math></inline-formula> dimension to get cell-type probability prediction <inline-formula><tex-math notation="LaTeX" id="ImEquation10">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$p( \boldsymbol{x})$\end{document}</tex-math></inline-formula>. During the training stage, we employ the cross-entropy loss to optimize the network. We introduce two optional query stages, where barcode preprocessing is utilized to augment the predictive capabilities of scNovel. During the parallel query stage, <inline-formula><tex-math notation="LaTeX" id="ImEquation11">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$T_{plus}(x)$\end{document}</tex-math></inline-formula> and <inline-formula><tex-math notation="LaTeX" id="ImEquation12">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$T_{minus}(x)$\end{document}</tex-math></inline-formula> are obtained through different operations that composite the input <inline-formula><tex-math notation="LaTeX" id="ImEquation13">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\boldsymbol{x}$\end{document}</tex-math></inline-formula> and the processed barcode data to one vector. Then, at the sequential query stage, <inline-formula><tex-math notation="LaTeX" id="ImEquation14">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$T_{minus}(T_{plus}(x))$\end{document}</tex-math></inline-formula> is leveraged for further refinement of the barcode data. We define four modes of novel cell detection based on the proposed query stages.</p>
          </caption>
          <graphic xlink:href="bbae112fx1" position="float"/>
        </fig>
        <p>Given input <inline-formula><tex-math notation="LaTeX" id="ImEquation145">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\boldsymbol{x}$\end{document}</tex-math></inline-formula>, the proposed network process is defined as the following: </p>
        <disp-formula id="deqn03">
          <label>(C.3)</label>
          <tex-math notation="LaTeX" id="DmEquation3">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
\begin{align*}&amp; \begin{split} \boldsymbol{x}_{1}&amp;=InputLayer(\boldsymbol{x}),\quad\quad\quad \boldsymbol{x}_{2}=HiddenLayer_{1}(\boldsymbol{x}_{1}),\\ \boldsymbol{x}_{3}&amp;=HiddenLayer_{2}(\boldsymbol{x}_{2}),\quad \boldsymbol{x}_{4}=HiddenLayer_{3}(\boldsymbol{x}_{3}),\\ f(\boldsymbol{x})&amp;=FC(x_{4}),\quad\quad\quad\quad\quad p(\boldsymbol{x})=Softmax(f(\boldsymbol{x})), \end{split}\end{align*}\end{document}</tex-math>
        </disp-formula>
        <p>where <inline-formula><tex-math notation="LaTeX" id="ImEquation146">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\,\boldsymbol{x}_{1}$\end{document}</tex-math></inline-formula> is the feature output after <inline-formula><tex-math notation="LaTeX" id="ImEquation147">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$InputLayer$\end{document}</tex-math></inline-formula>; <inline-formula><tex-math notation="LaTeX" id="ImEquation148">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\boldsymbol{x}_{2}$\end{document}</tex-math></inline-formula>, <inline-formula><tex-math notation="LaTeX" id="ImEquation149">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\boldsymbol{x}_{3}$\end{document}</tex-math></inline-formula> and <inline-formula><tex-math notation="LaTeX" id="ImEquation150">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\boldsymbol{x}_{4}$\end{document}</tex-math></inline-formula> are the features after <inline-formula><tex-math notation="LaTeX" id="ImEquation151">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$HiddenLayer_{1}$\end{document}</tex-math></inline-formula>, <inline-formula><tex-math notation="LaTeX" id="ImEquation152">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$HiddenLayer_{2}$\end{document}</tex-math></inline-formula> and <inline-formula><tex-math notation="LaTeX" id="ImEquation153">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$HiddenLayer_{3}$\end{document}</tex-math></inline-formula> respectively; <inline-formula><tex-math notation="LaTeX" id="ImEquation154">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$f(\boldsymbol{x})$\end{document}</tex-math></inline-formula>, processed by FC, is the feature of input <inline-formula><tex-math notation="LaTeX" id="ImEquation155">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\boldsymbol{x}$\end{document}</tex-math></inline-formula>; <inline-formula><tex-math notation="LaTeX" id="ImEquation156">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$p(\boldsymbol{x})$\end{document}</tex-math></inline-formula> is the prediction probability. More details can be found in Appendix <xref rid="app3" ref-type="app">C</xref>.</p>
      </sec>
      <sec id="app3b">
        <title>C.2 Training stage</title>
        <p>scNovel takes a single-cell RNA expression matrix M as an input, where each column corresponds to a gene and each row corresponds to a cell. As shown in <xref rid="f7" ref-type="fig">Appendix Figure 1</xref>, we first consider a supervised multi-class classification task problem. We denote <inline-formula><tex-math notation="LaTeX" id="ImEquation157">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\mathcal{D}_{ref}=\{\boldsymbol{x_{i}},y_{i}\}_{i=1}^{n^{ref}}$\end{document}</tex-math></inline-formula> as the reference set with <inline-formula><tex-math notation="LaTeX" id="ImEquation158">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$C^{ref} \in \mathbb{N}^{+}$\end{document}</tex-math></inline-formula> cell types. <inline-formula><tex-math notation="LaTeX" id="ImEquation159">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\mathcal{X}$\end{document}</tex-math></inline-formula> represents the input space, while <inline-formula><tex-math notation="LaTeX" id="ImEquation160">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\mathcal{Y}=\{1,2...,C^{ref}\}$\end{document}</tex-math></inline-formula> signifies the label space with <inline-formula><tex-math notation="LaTeX" id="ImEquation161">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$C^{ref}$\end{document}</tex-math></inline-formula> classes. <inline-formula><tex-math notation="LaTeX" id="ImEquation162">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\mathcal{P}_{typical}$\end{document}</tex-math></inline-formula> and <inline-formula><tex-math notation="LaTeX" id="ImEquation163">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\mathcal{P}_{novel}$\end{document}</tex-math></inline-formula> represent the distribution of typical cells and novel cells. Given a dataset, with trainable parameter <inline-formula><tex-math notation="LaTeX" id="ImEquation164">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\theta \in \mathbb{R}^{p}$\end{document}</tex-math></inline-formula>, a classifier f: <inline-formula><tex-math notation="LaTeX" id="ImEquation165">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\mathcal{X} \rightarrow \mathbb{R}^{C^{ref}}$\end{document}</tex-math></inline-formula> maps an input to the output space <inline-formula><tex-math notation="LaTeX" id="ImEquation166">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\mathbb{R}^{C^{ref}}$\end{document}</tex-math></inline-formula>. Here, the cross-entropy loss is calculated for optimization: </p>
        <disp-formula id="deqn04">
          <label>(C.4)</label>
          <tex-math notation="LaTeX" id="DmEquation4">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
\begin{align*} &amp; p(\boldsymbol{x})=\operatorname{softmax}(f(\boldsymbol{x};\theta),j)=\frac{e^{f_{j}(\boldsymbol{x};\theta)/T}}{\sum_{i=1}^{k}e^{f_{i}(\boldsymbol{x};\theta)/T}},\end{align*}\end{document}</tex-math>
        </disp-formula>
        <disp-formula id="deqn05">
          <label>(C.5)</label>
          <tex-math notation="LaTeX" id="DmEquation5">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
\begin{align*}&amp; \mathcal{L}_{\mathrm{CE}}(f(x;\theta),y)=-\log p(y\lvert\boldsymbol{x})=-\log p_{y}(\boldsymbol{x}),\end{align*}\end{document}</tex-math>
        </disp-formula>
        <p>where input <inline-formula><tex-math notation="LaTeX" id="ImEquation167">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\boldsymbol{x}$\end{document}</tex-math></inline-formula> is the gene expression profile of a cell, which is a row of single-cell RNA expression matrix M; <inline-formula><tex-math notation="LaTeX" id="ImEquation168">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$f(\boldsymbol{x})$\end{document}</tex-math></inline-formula> is the feature of input <inline-formula><tex-math notation="LaTeX" id="ImEquation169">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\boldsymbol{x}$\end{document}</tex-math></inline-formula>; <inline-formula><tex-math notation="LaTeX" id="ImEquation170">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$f_{i}(\boldsymbol{x})$\end{document}</tex-math></inline-formula> is the <inline-formula><tex-math notation="LaTeX" id="ImEquation171">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$i^{th}$\end{document}</tex-math></inline-formula> element of <inline-formula><tex-math notation="LaTeX" id="ImEquation172">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$f(\boldsymbol{x})$\end{document}</tex-math></inline-formula>, given the label <inline-formula><tex-math notation="LaTeX" id="ImEquation173">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$i$\end{document}</tex-math></inline-formula>; <inline-formula><tex-math notation="LaTeX" id="ImEquation174">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$p(\boldsymbol{x})$\end{document}</tex-math></inline-formula> is the prediction probability of input <inline-formula><tex-math notation="LaTeX" id="ImEquation175">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\boldsymbol{x}$\end{document}</tex-math></inline-formula>; <inline-formula><tex-math notation="LaTeX" id="ImEquation176">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$p(y\lvert \boldsymbol{x})$\end{document}</tex-math></inline-formula> is <inline-formula><tex-math notation="LaTeX" id="ImEquation177">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$y^{th}$\end{document}</tex-math></inline-formula> element of <inline-formula><tex-math notation="LaTeX" id="ImEquation178">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$p(\boldsymbol{x})$\end{document}</tex-math></inline-formula>, given the ground truth label <inline-formula><tex-math notation="LaTeX" id="ImEquation179">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$y$\end{document}</tex-math></inline-formula>; T is a hyperparameter, and we use 1000 as the default value (follow the parameter setting in [<xref rid="ref47" ref-type="bibr">47</xref>]).</p>
        <p>In the training stage, we minimize the cross-entropy loss in Equation (<xref rid="deqn05" ref-type="disp-formula">C.5</xref>) with the reference set <inline-formula><tex-math notation="LaTeX" id="ImEquation180">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\mathcal{D}_{ref}$\end{document}</tex-math></inline-formula>. In the query stage, samples from novel distributions <inline-formula><tex-math notation="LaTeX" id="ImEquation181">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\mathcal{P}_{novel}$\end{document}</tex-math></inline-formula> may appear, and the cell-type set of <inline-formula><tex-math notation="LaTeX" id="ImEquation182">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\mathcal{P}_{novel}$\end{document}</tex-math></inline-formula> has no intersection with the reference set label space <inline-formula><tex-math notation="LaTeX" id="ImEquation183">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\mathcal{Y}$\end{document}</tex-math></inline-formula>. Such samples come from novel distribution <inline-formula><tex-math notation="LaTeX" id="ImEquation184">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\mathcal{P}_{novel}$\end{document}</tex-math></inline-formula> should be detected by our proposed model.</p>
      </sec>
      <sec id="app3c">
        <title>C.3 Barcode preprocessing</title>
        <p>The novel rare cell discovery task could be formulated as a binary classification problem. We determine an input <inline-formula><tex-math notation="LaTeX" id="ImEquation185">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\boldsymbol{x} \in \mathcal{X}$\end{document}</tex-math></inline-formula> coming from <inline-formula><tex-math notation="LaTeX" id="ImEquation186">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\mathcal{P}_{typical}$\end{document}</tex-math></inline-formula> or <inline-formula><tex-math notation="LaTeX" id="ImEquation187">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\mathcal{P}_{novel}$\end{document}</tex-math></inline-formula> via the process shown in <xref rid="f7" ref-type="fig">Appendix Figure 1</xref>. Given an input, we utilize a classifier to get prediction probability <inline-formula><tex-math notation="LaTeX" id="ImEquation188">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$p(\boldsymbol{x})$\end{document}</tex-math></inline-formula>. The simplest score function, named traditional classification model, is defined as the following [<xref rid="ref53" ref-type="bibr">53</xref>]: </p>
        <disp-formula id="deqn06">
          <label>(C.6)</label>
          <tex-math notation="LaTeX" id="DmEquation6">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
\begin{align*}&amp; S^{MSP}(\boldsymbol{x})=\underset{j \in \mathcal{Y}}{max}\ \ p_{j}(\boldsymbol{x}),\end{align*}\end{document}</tex-math>
        </disp-formula>
        <p>where we choose the max probability as the decision score; <inline-formula><tex-math notation="LaTeX" id="ImEquation189">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$p_{j}(\boldsymbol{x})$\end{document}</tex-math></inline-formula> is the <inline-formula><tex-math notation="LaTeX" id="ImEquation190">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$j^{th}$\end{document}</tex-math></inline-formula> element of <inline-formula><tex-math notation="LaTeX" id="ImEquation191">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$p(\boldsymbol{x})$\end{document}</tex-math></inline-formula>. Based on this setting, we define the binary decision function to be </p>
        <disp-formula id="deqn07">
          <label>(C.7)</label>
          <tex-math notation="LaTeX" id="DmEquation7">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
\begin{align*}&amp; G(\boldsymbol{x})=\left\{ \begin{array}{@{}lr} Typical,\quad if\ S(\boldsymbol{x}) \geq \lambda, &amp;\\ Novel,\quad if\ S(\boldsymbol{x}) &lt; \lambda. &amp;\\ \end{array} \right.\end{align*}\end{document}</tex-math>
        </disp-formula>
        <p>where <inline-formula><tex-math notation="LaTeX" id="ImEquation192">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$S(*)$\end{document}</tex-math></inline-formula> is the score function and <inline-formula><tex-math notation="LaTeX" id="ImEquation193">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$G(*)$\end{document}</tex-math></inline-formula> is the novelty classification that <inline-formula><tex-math notation="LaTeX" id="ImEquation194">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$x$\end{document}</tex-math></inline-formula> belongs to; <inline-formula><tex-math notation="LaTeX" id="ImEquation195">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\lambda $\end{document}</tex-math></inline-formula> is a hyperparameter that we set as a threshold with a default value of 0.5 (recommended). Usually, samples with a score that reaches the threshold are classified as typical of a certain cell type that the max probability corresponds to, and those with a score below the threshold are classified to be novel. To be more specific, the higher the score is, the lower probability that the cell type is novel.</p>
        <p><bold>Parallel query stage</bold> To further improve the model performance, we add barcode preprocessing when testing on the query dataset. The core idea is that adding input perturbations to the sample could help enlarge the margin between typical cell data and novel cell data [<xref rid="ref47" ref-type="bibr">47</xref>]. Hence, the barcode preprocessing can have a higher effect on typical cell types (the score will be changed more, including increasing more and decreasing more), and it has a lower effect on novel cell types ( the score will not change too much). As shown in <xref rid="f7" ref-type="fig">Appendix Figure 1</xref>, we design two types of barcode preprocessing <inline-formula><tex-math notation="LaTeX" id="ImEquation196">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$T_{minus}$\end{document}</tex-math></inline-formula> and <inline-formula><tex-math notation="LaTeX" id="ImEquation197">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$T_{plus}$\end{document}</tex-math></inline-formula> with different composition operations: </p>
        <disp-formula id="deqn08">
          <label>(C.8)</label>
          <tex-math notation="LaTeX" id="DmEquation8">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
\begin{align*} &amp; \begin{aligned} S_{\hat{y}}(\boldsymbol{x})= \underset{j \in \mathcal{Y}}{max}\ p_{j}(\boldsymbol{x}), \end{aligned}\end{align*}\end{document}</tex-math>
        </disp-formula>
        <disp-formula id="deqn09">
          <label>(C.9)</label>
          <tex-math notation="LaTeX" id="DmEquation9">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
\begin{align*}&amp; \begin{aligned} T_{plus}(\boldsymbol{x})=\boldsymbol{x}-\epsilon sign(-\nabla_{\boldsymbol{x}}\ logS_{\hat{y}}(x) ) = \boldsymbol{x}+\epsilon sign(\nabla_{\boldsymbol{x}}\ logS_{\hat{y}}(x) ),\\ T_{minus}(\boldsymbol{x})=\boldsymbol{x}+\epsilon sign(-\nabla_{\boldsymbol{x}}\ logS_{\hat{y}}(\boldsymbol{x}) ) =\boldsymbol{x}-\epsilon sign(\nabla_{\boldsymbol{x}}\ logS_{\hat{y}}(\boldsymbol{x}) ). \end{aligned}\end{align*}\end{document}</tex-math>
        </disp-formula>
        <p>where <inline-formula><tex-math notation="LaTeX" id="ImEquation198">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\epsilon $\end{document}</tex-math></inline-formula> is the perturbation hyperparameter, whose default value is 0.0014; for the two barcode preprocessing methods, we first compute the gradient via backpropagation, and then the gradient will multiply by hyperparameter <inline-formula><tex-math notation="LaTeX" id="ImEquation199">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\epsilon $\end{document}</tex-math></inline-formula>; <inline-formula><tex-math notation="LaTeX" id="ImEquation200">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$T_{minus}(x)$\end{document}</tex-math></inline-formula> minus the multiplication result, while <inline-formula><tex-math notation="LaTeX" id="ImEquation201">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$T_{plus}(x)$\end{document}</tex-math></inline-formula> plus the multiplication result; usually, <inline-formula><tex-math notation="LaTeX" id="ImEquation202">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$S(T_{minus}(x))$\end{document}</tex-math></inline-formula> is larger than S(x), while <inline-formula><tex-math notation="LaTeX" id="ImEquation203">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$S(T_{plus}(x))$\end{document}</tex-math></inline-formula> is smaller than <inline-formula><tex-math notation="LaTeX" id="ImEquation204">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$S(x)$\end{document}</tex-math></inline-formula>. We design Single Plus-Composition Mode, denoted as <inline-formula><tex-math notation="LaTeX" id="ImEquation205">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$S^{ODIN}$\end{document}</tex-math></inline-formula>, which employs the following equation for barcode preprocessing [<xref rid="ref47" ref-type="bibr">47</xref>]: </p>
        <disp-formula id="deqn10">
          <label>(C.10)</label>
          <tex-math notation="LaTeX" id="DmEquation10">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
\begin{align*}&amp; S^{ODIN}(\boldsymbol{x})=\underset{j \in \mathcal{Y}}{max}\ \ p_{j}(T_{plus}(\boldsymbol{x})).\end{align*}\end{document}</tex-math>
        </disp-formula>
        <p>In fact, we could write a general formulation of Equation (<xref rid="deqn10" ref-type="disp-formula">C.10</xref>) as follows: </p>
        <disp-formula id="deqn11">
          <label>(C.11)</label>
          <tex-math notation="LaTeX" id="DmEquation11">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
\begin{align*}&amp; \begin{aligned} S^{ODIN}(\boldsymbol{x})&amp;=\underset{j \in \mathcal{Y}}{max}\ \ \{ \underbrace{p_{j}(\boldsymbol{x})}_{magnitude}+ \underbrace{p_{j}(T_{plus}(\boldsymbol{x}))-p_{j}(\boldsymbol{x})}_{up-sharpness}\}, \end{aligned}\end{align*}\end{document}</tex-math>
        </disp-formula>
        <p>
where the magnitude is the score of input <inline-formula><tex-math notation="LaTeX" id="ImEquation206">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$x$\end{document}</tex-math></inline-formula> without barcode preprocessing; the up-sharpness is the increment in score after the <inline-formula><tex-math notation="LaTeX" id="ImEquation207">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$T_{plus}$\end{document}</tex-math></inline-formula> process. The limitation of <inline-formula><tex-math notation="LaTeX" id="ImEquation208">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$S^{ODIN}$\end{document}</tex-math></inline-formula> is that it only considers up-sharpness but does not consider down-sharpness, which is the decrease in score after the <inline-formula><tex-math notation="LaTeX" id="ImEquation209">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$T_{minus}$\end{document}</tex-math></inline-formula> process. Hence, we could simultaneously calculate up-sharpness and down-sharpness at the same input <inline-formula><tex-math notation="LaTeX" id="ImEquation210">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$x$\end{document}</tex-math></inline-formula>, which is <inline-formula><tex-math notation="LaTeX" id="ImEquation211">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$S^{SIM}$\end{document}</tex-math></inline-formula>, named Parallel Composition Mode defined in the following: </p>
        <disp-formula id="deqn12">
          <label>(C.12)</label>
          <tex-math notation="LaTeX" id="DmEquation12">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
\begin{align*} S^{SIM}(\boldsymbol{x})&amp;=\,\underset{j \in \mathcal{Y}}{max}\{ \underbrace{p_{j}(\boldsymbol{x}) }_{magnitude}+ \underbrace{p_{j}(T_{plus}(\boldsymbol{x}))-p_{j}(\boldsymbol{x})}_{up-sharpness}+\underbrace{p_{j}(\boldsymbol{x})-p_{j}(T_{minus}(\boldsymbol{x}))}_{down-sharpness}\}\nonumber\\ &amp;=\,\underset{j \in \mathcal{Y}}{max}\{ p_{j}(\boldsymbol{x})+p_{j}(T_{plus}(\boldsymbol{x}))-p_{j}(T_{minus}(\boldsymbol{x}))\}. \end{align*}\end{document}</tex-math>
        </disp-formula>
        <p>To summarize, the parallel query stage considers two novel cell detection modes, namely Single Plus-Composition Mode and Parallel Composition Mode. Score functions <inline-formula><tex-math notation="LaTeX" id="ImEquation212">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$S^{SIM}$\end{document}</tex-math></inline-formula> consider both up-sharpness and down-sharpness, while <inline-formula><tex-math notation="LaTeX" id="ImEquation213">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$S^{ODIN}$\end{document}</tex-math></inline-formula> only considers up-sharpness.</p>
        <p><bold>Sequential query stage</bold> Moreover, we could also sequentially calculate up-sharpness and down-sharpness using the same input <inline-formula><tex-math notation="LaTeX" id="ImEquation214">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$x$\end{document}</tex-math></inline-formula> using the Sequential Composition Mode. Score <inline-formula><tex-math notation="LaTeX" id="ImEquation215">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$S^{SEQ}$\end{document}</tex-math></inline-formula> is defined as follows: </p>
        <disp-formula id="deqn13">
          <label>(C.13)</label>
          <tex-math notation="LaTeX" id="DmEquation13">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
\begin{align*}&amp; \begin{aligned} S^{SEQ}(\boldsymbol{x})&amp;=\underset{j \in \mathcal{Y}}{max}\{ \underbrace{p_{j}(\boldsymbol{x})} _{magnitude}+ \underbrace{p_{j}(T_{plus}(\boldsymbol{x}))-p_{j}(\boldsymbol{x})}_{up-sharpness}\\&amp;\quad+\underbrace{p_{j}(T_{plus}(\boldsymbol{x}))-p_{j}(T_{minus}(T_{plus}(\boldsymbol{x})))}_{down-sharpness}\}\\ &amp;=\underset{j \in \mathcal{Y}}{max}\{ 2*p_{j}(T_{plus}(\boldsymbol{x}))- p_{j}(T_{minus}(T_{plus}(\boldsymbol{x})))\}.\\ \end{aligned}\end{align*}\end{document}</tex-math>
        </disp-formula>
        <p>In this mode, we sequentially calculate up-sharpness at the input x and down-sharpness at <inline-formula><tex-math notation="LaTeX" id="ImEquation216">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$T_{plus}(x)$\end{document}</tex-math></inline-formula>.</p>
        <p>
          <inline-graphic xlink:href="bbae112fx2.jpg" id="bbae112fx2"/>
        </p>
      </sec>
      <sec id="app3d">
        <title>C.4 Score normalization</title>
        <p>The score normalization is employed to resize the score obtained from the score function. The scores will become relatively small with the increase of hyperparameter <inline-formula><tex-math notation="LaTeX" id="ImEquation217">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$T$\end{document}</tex-math></inline-formula> proposed in Equation (<xref rid="deqn04" ref-type="disp-formula">C.4</xref>). Hence, we employ the following equations to normalize our scores: </p>
        <disp-formula id="deqn14">
          <label>(C.14)</label>
          <tex-math notation="LaTeX" id="DmEquation15">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
\begin{align*} \begin{split} S_{refMax}&amp;=\underset{\boldsymbol{x} \in \mathcal{D}_{ref}} {max}\ S(\boldsymbol{x}), \end{split}\end{align*}\end{document}</tex-math>
        </disp-formula>
        <disp-formula id="deqn15">
          <label>(C.15)</label>
          <tex-math notation="LaTeX" id="DmEquation16">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
\begin{align*} \begin{split} S^{norm}(\boldsymbol{x})&amp;=\frac{S(x)-1/C^{ref}}{S_{refMax}-1/C^{ref}},\\ \end{split}\end{align*}\end{document}</tex-math>
        </disp-formula>
        <p>
where <inline-formula><tex-math notation="LaTeX" id="ImEquation218">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$S_{refMax}$\end{document}</tex-math></inline-formula> is the max score obtained from the reference set via our proposed score functions; <inline-formula><tex-math notation="LaTeX" id="ImEquation219">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$S^{norm}(\boldsymbol{x})$\end{document}</tex-math></inline-formula> is the normalization score of input <inline-formula><tex-math notation="LaTeX" id="ImEquation220">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\boldsymbol{x}$\end{document}</tex-math></inline-formula>, which is within the range of <inline-formula><tex-math notation="LaTeX" id="ImEquation221">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$[0,1]$\end{document}</tex-math></inline-formula>.</p>
      </sec>
      <sec id="app3e">
        <title>C.5 Architecture and hyperparameters</title>
        <p>We show the overall pipeline in Algorithm 1. We train a classifier <inline-formula><tex-math notation="LaTeX" id="ImEquation222">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$f$\end{document}</tex-math></inline-formula> with the reference set <inline-formula><tex-math notation="LaTeX" id="ImEquation223">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\mathcal{D}_{ref}$\end{document}</tex-math></inline-formula> sampled from <inline-formula><tex-math notation="LaTeX" id="ImEquation224">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\mathcal{P}_{typical}$\end{document}</tex-math></inline-formula>. Model parameter <inline-formula><tex-math notation="LaTeX" id="ImEquation225">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\theta $\end{document}</tex-math></inline-formula> is updated via backpropagation with the cross-entropy loss <inline-formula><tex-math notation="LaTeX" id="ImEquation226">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\mathcal{L}_{CE}$\end{document}</tex-math></inline-formula> described in Equation (<xref rid="deqn05" ref-type="disp-formula">C.5</xref>). The number of neurons in the input layer is equal to the number of genes in the scRNA-seq dataset. The three subsequent hidden layers include 128, 64 and 32 units, respectively. The dropout rate of the dropout layer is 0.5 by default. We utilize AdamW [<xref rid="ref54" ref-type="bibr">54</xref>] with <inline-formula><tex-math notation="LaTeX" id="ImEquation227">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$1e-4$\end{document}</tex-math></inline-formula> as the learning rate to optimize the network. The hyperparameter <inline-formula><tex-math notation="LaTeX" id="ImEquation228">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$T$\end{document}</tex-math></inline-formula> is set to be 1000, and the perturbation hyperparameter <inline-formula><tex-math notation="LaTeX" id="ImEquation229">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\epsilon $\end{document}</tex-math></inline-formula> is 0.0014 (follow the parameter setting in [<xref rid="ref47" ref-type="bibr">47</xref>]). The training batch size and iteration number are flexible for users, and we recommend users set the training batch size to at least 32 and the iteration number to at least 3000 to train the model well. All experiments are conducted on a GTX2080 Ti.</p>
      </sec>
      <sec id="app3f">
        <title>C.6 Softeware comparison and settings</title>
        <p>To evaluate the effectiveness of scNovel, we conducted a comparative analysis with various commonly employed techniques, including Scmap-cell, Scmap-cluster, scPred and scLearn. The evaluation criteria, as well as the input data, were obtained following the instructions and tutorials provided by each respective package. In order to maintain a level playing field, we adhered to the default parameters for all the methods utilized, including that of scNovel. </p>
        <p>The software applications utilized in our study are as follows:</p>
        <list list-type="bullet">
          <list-item>
            <p>scmap-Cell and scmap-Cluster, both of which were sourced from BioManager (<ext-link xlink:href="https://github.com/hemberg-lab/scmap" ext-link-type="uri">https://git hub.com/hemberg-lab/scmap</ext-link>). The parameter settings for these functions were in accordance with the accompanying instructions.</p>
          </list-item>
          <list-item>
            <p>scPred, which was obtained from BiocManager (<ext-link xlink:href="https://github.com/powellgenomicslab/scPred" ext-link-type="uri">https://github.com/powellgenomicslab/scPred</ext-link>), was executed under default parameters. The algorithm selected the category with the highest score to generate the final result. It should be noted that scPred is better suited for processing relatively smaller datasets, as larger ones could require a considerable amount of time.</p>
          </list-item>
          <list-item>
            <p>scLearn sourced from Github (<ext-link xlink:href="https://github.com/bm2-lab/scLearn" ext-link-type="uri">https://github.com/bm2-lab/scLearn</ext-link>) was also executed under the default parameter configuration.</p>
          </list-item>
        </list>
      </sec>
    </app>
    <app id="app4">
      <title>D. Appendix results</title>
      <table-wrap position="anchor" id="TB2">
        <label>Appendix Table 2</label>
        <caption>
          <p>Averaged experimental results among different datasets of scNovel and baseline methods. The <inline-formula><tex-math notation="LaTeX" id="ImEquation87e">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\color{red}{\mathrm{{red\ bold}}}$\end{document}</tex-math></inline-formula> and <inline-formula><tex-math notation="LaTeX" id="ImEquation87g">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\color{blue}{\mathrm{{blue\ bold}}}$\end{document}</tex-math></inline-formula> are the best result and second-best result, respectively, in corresponding evaluation metrics and <inline-formula><tex-math notation="LaTeX" id="ImEquation22">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$C^{novel}$\end{document}</tex-math></inline-formula></p>
        </caption>
        <table frame="hsides" rules="groups">
          <colgroup span="1">
            <col span="1" align="left"/>
            <col span="1" align="left"/>
            <col span="1" align="left"/>
            <col span="1" align="left"/>
            <col span="1" align="left"/>
            <col span="1" align="left"/>
          </colgroup>
          <thead>
            <tr>
              <th align="left" rowspan="1" colspan="1">Evaluation</th>
              <th align="left" rowspan="1" colspan="1">Methods</th>
              <th colspan="4" align="left" rowspan="1">
                <inline-formula>
                  <tex-math notation="LaTeX" id="ImEquation23">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$C^{novel}$\end{document}</tex-math>
                </inline-formula>
              </th>
            </tr>
            <tr>
              <th rowspan="1" colspan="1"/>
              <th rowspan="1" colspan="1"/>
              <th align="left" rowspan="1" colspan="1">1</th>
              <th align="left" rowspan="1" colspan="1">2</th>
              <th align="left" rowspan="1" colspan="1">3</th>
              <th align="left" rowspan="1" colspan="1">4</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td rowspan="1" colspan="1">FPR95(%)<inline-formula><tex-math notation="LaTeX" id="ImEquation24">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\downarrow $\end{document}</tex-math></inline-formula></td>
              <td rowspan="1" colspan="1">scmap-cluster [<xref rid="ref25" ref-type="bibr">25</xref>]</td>
              <td rowspan="1" colspan="1">55.85</td>
              <td rowspan="1" colspan="1">54.56</td>
              <td rowspan="1" colspan="1">42.17</td>
              <td rowspan="1" colspan="1">
                <inline-formula>
                  <tex-math notation="LaTeX" id="ImEquation25">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\color{blue}{\boldsymbol{{47.62}}}$\end{document}</tex-math>
                </inline-formula>
              </td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1">scmap-cell [<xref rid="ref25" ref-type="bibr">25</xref>]</td>
              <td rowspan="1" colspan="1">68.74</td>
              <td rowspan="1" colspan="1">70.23</td>
              <td rowspan="1" colspan="1">79.44</td>
              <td rowspan="1" colspan="1">73.84</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1">scPred [<xref rid="ref26" ref-type="bibr">26</xref>]</td>
              <td rowspan="1" colspan="1">60.43</td>
              <td rowspan="1" colspan="1">65.09</td>
              <td rowspan="1" colspan="1">73.86</td>
              <td rowspan="1" colspan="1">66.96</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1">scLearn [<xref rid="ref27" ref-type="bibr">27</xref>]</td>
              <td rowspan="1" colspan="1">
                <inline-formula>
                  <tex-math notation="LaTeX" id="ImEquation26">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\color{blue}{\boldsymbol{{40.74}}}$\end{document}</tex-math>
                </inline-formula>
              </td>
              <td rowspan="1" colspan="1">
                <inline-formula>
                  <tex-math notation="LaTeX" id="ImEquation27">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\color{blue}{\boldsymbol{{47.62}}}$\end{document}</tex-math>
                </inline-formula>
              </td>
              <td rowspan="1" colspan="1">
                <inline-formula>
                  <tex-math notation="LaTeX" id="ImEquation28">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\color{blue}{\boldsymbol{{39.29}}}$\end{document}</tex-math>
                </inline-formula>
              </td>
              <td rowspan="1" colspan="1">54.52</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1">scNovel</td>
              <td rowspan="1" colspan="1">
                <inline-formula>
                  <tex-math notation="LaTeX" id="ImEquation29">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\color{red}{\boldsymbol{{22.82}}}$\end{document}</tex-math>
                </inline-formula>
              </td>
              <td rowspan="1" colspan="1">
                <inline-formula>
                  <tex-math notation="LaTeX" id="ImEquation30">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\color{red}{\boldsymbol{{21.31}}}$\end{document}</tex-math>
                </inline-formula>
              </td>
              <td rowspan="1" colspan="1">
                <inline-formula>
                  <tex-math notation="LaTeX" id="ImEquation31">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\color{red}{\boldsymbol{{28.74}}}$\end{document}</tex-math>
                </inline-formula>
              </td>
              <td rowspan="1" colspan="1">
                <inline-formula>
                  <tex-math notation="LaTeX" id="ImEquation32">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\color{red}{\boldsymbol{{25.95}}}$\end{document}</tex-math>
                </inline-formula>
              </td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">
                <bold>AUROC(<inline-formula><tex-math notation="LaTeX" id="ImEquation33">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\%$\end{document}</tex-math></inline-formula>)<inline-formula><tex-math notation="LaTeX" id="ImEquation34">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\uparrow $\end{document}</tex-math></inline-formula></bold>
              </td>
              <td rowspan="1" colspan="1">scmap-cluster [<xref rid="ref25" ref-type="bibr">25</xref>]</td>
              <td rowspan="1" colspan="1">80.78</td>
              <td rowspan="1" colspan="1">78.38</td>
              <td rowspan="1" colspan="1">83.56</td>
              <td rowspan="1" colspan="1">
                <inline-formula>
                  <tex-math notation="LaTeX" id="ImEquation35">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\color{blue}{\boldsymbol{{80.68}}}$\end{document}</tex-math>
                </inline-formula>
              </td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1">scmap-cell [<xref rid="ref25" ref-type="bibr">25</xref>]</td>
              <td rowspan="1" colspan="1">84.01</td>
              <td rowspan="1" colspan="1">77.60</td>
              <td rowspan="1" colspan="1">81.65</td>
              <td rowspan="1" colspan="1">80.63</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1">scPred [<xref rid="ref26" ref-type="bibr">26</xref>]</td>
              <td rowspan="1" colspan="1">78.45</td>
              <td rowspan="1" colspan="1">73.48</td>
              <td rowspan="1" colspan="1">76.63</td>
              <td rowspan="1" colspan="1">70.49</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1">scLearn [<xref rid="ref27" ref-type="bibr">27</xref>]</td>
              <td rowspan="1" colspan="1">
                <inline-formula>
                  <tex-math notation="LaTeX" id="ImEquation36">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\color{blue}{\boldsymbol{{84.30}}}$\end{document}</tex-math>
                </inline-formula>
              </td>
              <td rowspan="1" colspan="1">
                <inline-formula>
                  <tex-math notation="LaTeX" id="ImEquation37">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\color{blue}{\boldsymbol{{83.07}}}$\end{document}</tex-math>
                </inline-formula>
              </td>
              <td rowspan="1" colspan="1">
                <inline-formula>
                  <tex-math notation="LaTeX" id="ImEquation38">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\color{blue}{\boldsymbol{{87.45}}}$\end{document}</tex-math>
                </inline-formula>
              </td>
              <td rowspan="1" colspan="1">77.61</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1">scNovel</td>
              <td rowspan="1" colspan="1">
                <inline-formula>
                  <tex-math notation="LaTeX" id="ImEquation39">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\color{red}{\boldsymbol{{96.33}}}$\end{document}</tex-math>
                </inline-formula>
              </td>
              <td rowspan="1" colspan="1">
                <inline-formula>
                  <tex-math notation="LaTeX" id="ImEquation40">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\color{red}{\boldsymbol{{94.29}}}$\end{document}</tex-math>
                </inline-formula>
              </td>
              <td rowspan="1" colspan="1">
                <inline-formula>
                  <tex-math notation="LaTeX" id="ImEquation41">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\color{red}{\boldsymbol{{94.64}}}$\end{document}</tex-math>
                </inline-formula>
              </td>
              <td rowspan="1" colspan="1">
                <inline-formula>
                  <tex-math notation="LaTeX" id="ImEquation42">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\color{red}{\boldsymbol{{94.16}}}$\end{document}</tex-math>
                </inline-formula>
              </td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">AUPR(%)<inline-formula><tex-math notation="LaTeX" id="ImEquation43">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\uparrow $\end{document}</tex-math></inline-formula></td>
              <td rowspan="1" colspan="1">scmap-cluster [<xref rid="ref25" ref-type="bibr">25</xref>]</td>
              <td rowspan="1" colspan="1">
                <inline-formula>
                  <tex-math notation="LaTeX" id="ImEquation44">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\color{blue}{\boldsymbol{{99.42}}}$\end{document}</tex-math>
                </inline-formula>
              </td>
              <td rowspan="1" colspan="1">
                <inline-formula>
                  <tex-math notation="LaTeX" id="ImEquation45">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\color{blue}{\boldsymbol{{98.59}}}$\end{document}</tex-math>
                </inline-formula>
              </td>
              <td rowspan="1" colspan="1">97.62</td>
              <td rowspan="1" colspan="1">
                <inline-formula>
                  <tex-math notation="LaTeX" id="ImEquation46">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\color{blue}{\boldsymbol{{93.16}}}$\end{document}</tex-math>
                </inline-formula>
              </td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1">scmap-cell [<xref rid="ref25" ref-type="bibr">25</xref>]</td>
              <td rowspan="1" colspan="1">99.30</td>
              <td rowspan="1" colspan="1">97.23</td>
              <td rowspan="1" colspan="1">95.44</td>
              <td rowspan="1" colspan="1">91.27</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1">scPred [<xref rid="ref26" ref-type="bibr">26</xref>]</td>
              <td rowspan="1" colspan="1">99.24</td>
              <td rowspan="1" colspan="1">97.85</td>
              <td rowspan="1" colspan="1">94.08</td>
              <td rowspan="1" colspan="1">86.00</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1">scLearn [<xref rid="ref27" ref-type="bibr">27</xref>]</td>
              <td rowspan="1" colspan="1">98.15</td>
              <td rowspan="1" colspan="1">97.70</td>
              <td rowspan="1" colspan="1">
                <inline-formula>
                  <tex-math notation="LaTeX" id="ImEquation47">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\color{blue}{\boldsymbol{{97.71}}}$\end{document}</tex-math>
                </inline-formula>
              </td>
              <td rowspan="1" colspan="1">91.60</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1">scNovel</td>
              <td rowspan="1" colspan="1">
                <inline-formula>
                  <tex-math notation="LaTeX" id="ImEquation48">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\color{red}{\boldsymbol{{99.78}}}$\end{document}</tex-math>
                </inline-formula>
              </td>
              <td rowspan="1" colspan="1">
                <inline-formula>
                  <tex-math notation="LaTeX" id="ImEquation49">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\color{red}{\boldsymbol{{99.41}}}$\end{document}</tex-math>
                </inline-formula>
              </td>
              <td rowspan="1" colspan="1">
                <inline-formula>
                  <tex-math notation="LaTeX" id="ImEquation50">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\color{red}{\boldsymbol{{98.70}}}$\end{document}</tex-math>
                </inline-formula>
              </td>
              <td rowspan="1" colspan="1">
                <inline-formula>
                  <tex-math notation="LaTeX" id="ImEquation51">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\color{red}{\boldsymbol{{97.72}}}$\end{document}</tex-math>
                </inline-formula>
              </td>
            </tr>
          </tbody>
        </table>
      </table-wrap>
      <table-wrap position="anchor" id="TB3">
        <label>Appendix Table 3</label>
        <caption>
          <p>Experimental results with different score functions. The <inline-formula><tex-math notation="LaTeX" id="ImEquation87c">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\color{red}{\mathrm{{red\ bold}}}$\end{document}</tex-math></inline-formula> and <inline-formula><tex-math notation="LaTeX" id="ImEquation87d">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\color{blue}{\mathrm{{blue\ bold}}}$\end{document}</tex-math></inline-formula> are the best and second-best results, respectively, in corresponding evaluation metrics and <inline-formula><tex-math notation="LaTeX" id="ImEquation234">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$C^{novel}$\end{document}</tex-math></inline-formula></p>
        </caption>
        <table frame="hsides" rules="groups">
          <colgroup span="1">
            <col span="1" align="left"/>
            <col span="1" align="left"/>
            <col span="1" align="left"/>
            <col span="1" align="left"/>
            <col span="1" align="left"/>
            <col span="1" align="left"/>
          </colgroup>
          <thead>
            <tr>
              <th align="left" rowspan="1" colspan="1">Evaluation</th>
              <th align="left" rowspan="1" colspan="1">Methods</th>
              <th colspan="4" align="left" rowspan="1">
                <inline-formula>
                  <tex-math notation="LaTeX" id="ImEquation235">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$C^{novel}$\end{document}</tex-math>
                </inline-formula>
              </th>
            </tr>
            <tr>
              <th rowspan="1" colspan="1"/>
              <th rowspan="1" colspan="1"/>
              <th align="left" rowspan="1" colspan="1">1</th>
              <th align="left" rowspan="1" colspan="1">2</th>
              <th align="left" rowspan="1" colspan="1">3</th>
              <th align="left" rowspan="1" colspan="1">4</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td rowspan="1" colspan="1">FPR95(%)<inline-formula><tex-math notation="LaTeX" id="ImEquation236">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\downarrow $\end{document}</tex-math></inline-formula></td>
              <td rowspan="1" colspan="1">
                <inline-formula>
                  <tex-math notation="LaTeX" id="ImEquation237">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$S^{MSP}$\end{document}</tex-math>
                </inline-formula>
              </td>
              <td rowspan="1" colspan="1">32.19</td>
              <td rowspan="1" colspan="1">29.21</td>
              <td rowspan="1" colspan="1">34.92</td>
              <td rowspan="1" colspan="1">32.71</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1">
                <inline-formula>
                  <tex-math notation="LaTeX" id="ImEquation238">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$S^{ODIN}$\end{document}</tex-math>
                </inline-formula>
              </td>
              <td rowspan="1" colspan="1">24.03</td>
              <td rowspan="1" colspan="1">22.05</td>
              <td rowspan="1" colspan="1">29.32</td>
              <td rowspan="1" colspan="1">26.39</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1">
                <inline-formula>
                  <tex-math notation="LaTeX" id="ImEquation239">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$S^{SEQ}$\end{document}</tex-math>
                </inline-formula>
              </td>
              <td rowspan="1" colspan="1">
                <inline-formula>
                  <tex-math notation="LaTeX" id="ImEquation240">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\color{blue}{\boldsymbol{{22.94}}}$\end{document}</tex-math>
                </inline-formula>
              </td>
              <td rowspan="1" colspan="1">
                <inline-formula>
                  <tex-math notation="LaTeX" id="ImEquation241">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\color{red}{\boldsymbol{{20.99}}}$\end{document}</tex-math>
                </inline-formula>
              </td>
              <td rowspan="1" colspan="1">
                <inline-formula>
                  <tex-math notation="LaTeX" id="ImEquation242">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\color{blue}{\boldsymbol{{28.96}}}$\end{document}</tex-math>
                </inline-formula>
              </td>
              <td rowspan="1" colspan="1">
                <inline-formula>
                  <tex-math notation="LaTeX" id="ImEquation243">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\color{red}{\boldsymbol{{25.64}}}$\end{document}</tex-math>
                </inline-formula>
              </td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1">
                <inline-formula>
                  <tex-math notation="LaTeX" id="ImEquation244">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$S^{SIM}$\end{document}</tex-math>
                </inline-formula>
              </td>
              <td rowspan="1" colspan="1">
                <inline-formula>
                  <tex-math notation="LaTeX" id="ImEquation245">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\color{red}{\boldsymbol{{22.82}}}$\end{document}</tex-math>
                </inline-formula>
              </td>
              <td rowspan="1" colspan="1">
                <inline-formula>
                  <tex-math notation="LaTeX" id="ImEquation246">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\color{blue}{\boldsymbol{{21.31}}}$\end{document}</tex-math>
                </inline-formula>
              </td>
              <td rowspan="1" colspan="1">
                <inline-formula>
                  <tex-math notation="LaTeX" id="ImEquation247">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\color{red}{\boldsymbol{{28.74}}}$\end{document}</tex-math>
                </inline-formula>
              </td>
              <td rowspan="1" colspan="1">
                <inline-formula>
                  <tex-math notation="LaTeX" id="ImEquation248">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\color{blue}{\boldsymbol{{25.95}}}$\end{document}</tex-math>
                </inline-formula>
              </td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">
                <bold>AUROC(%)<inline-formula><tex-math notation="LaTeX" id="ImEquation249">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\uparrow $\end{document}</tex-math></inline-formula></bold>
              </td>
              <td rowspan="1" colspan="1">
                <inline-formula>
                  <tex-math notation="LaTeX" id="ImEquation250">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$S^{MSP}$\end{document}</tex-math>
                </inline-formula>
              </td>
              <td rowspan="1" colspan="1">94.53</td>
              <td rowspan="1" colspan="1">93.55</td>
              <td rowspan="1" colspan="1">93.73</td>
              <td rowspan="1" colspan="1">92.98</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1">
                <inline-formula>
                  <tex-math notation="LaTeX" id="ImEquation251">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$S^{ODIN}$\end{document}</tex-math>
                </inline-formula>
              </td>
              <td rowspan="1" colspan="1">96.06</td>
              <td rowspan="1" colspan="1">94.11</td>
              <td rowspan="1" colspan="1">94.55</td>
              <td rowspan="1" colspan="1">
                <inline-formula>
                  <tex-math notation="LaTeX" id="ImEquation252">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\color{blue}{\boldsymbol{{93.94}}}$\end{document}</tex-math>
                </inline-formula>
              </td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1">
                <inline-formula>
                  <tex-math notation="LaTeX" id="ImEquation253">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$S^{SEQ}$\end{document}</tex-math>
                </inline-formula>
              </td>
              <td rowspan="1" colspan="1">
                <inline-formula>
                  <tex-math notation="LaTeX" id="ImEquation254">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\color{blue}{\boldsymbol{{96.32}}}$\end{document}</tex-math>
                </inline-formula>
              </td>
              <td rowspan="1" colspan="1">
                <inline-formula>
                  <tex-math notation="LaTeX" id="ImEquation255">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\color{blue}{\boldsymbol{{94.26}}}$\end{document}</tex-math>
                </inline-formula>
              </td>
              <td rowspan="1" colspan="1">
                <inline-formula>
                  <tex-math notation="LaTeX" id="ImEquation256">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\color{blue}{\boldsymbol{{94.60}}}$\end{document}</tex-math>
                </inline-formula>
              </td>
              <td rowspan="1" colspan="1">
                <inline-formula>
                  <tex-math notation="LaTeX" id="ImEquation257">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\color{red}{\boldsymbol{{94.16}}}$\end{document}</tex-math>
                </inline-formula>
              </td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1">
                <inline-formula>
                  <tex-math notation="LaTeX" id="ImEquation258">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$S^{SIM}$\end{document}</tex-math>
                </inline-formula>
              </td>
              <td rowspan="1" colspan="1">
                <inline-formula>
                  <tex-math notation="LaTeX" id="ImEquation259">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\color{red}{\boldsymbol{{96.33}}}$\end{document}</tex-math>
                </inline-formula>
              </td>
              <td rowspan="1" colspan="1">
                <inline-formula>
                  <tex-math notation="LaTeX" id="ImEquation260">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\color{red}{\boldsymbol{{94.29}}}$\end{document}</tex-math>
                </inline-formula>
              </td>
              <td rowspan="1" colspan="1">
                <inline-formula>
                  <tex-math notation="LaTeX" id="ImEquation261">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\color{red}{\boldsymbol{{94.64}}}$\end{document}</tex-math>
                </inline-formula>
              </td>
              <td rowspan="1" colspan="1">
                <inline-formula>
                  <tex-math notation="LaTeX" id="ImEquation262">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\color{red}{\boldsymbol{{94.16}}}$\end{document}</tex-math>
                </inline-formula>
              </td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">AUPR(%)<inline-formula><tex-math notation="LaTeX" id="ImEquation263">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\uparrow $\end{document}</tex-math></inline-formula></td>
              <td rowspan="1" colspan="1">
                <inline-formula>
                  <tex-math notation="LaTeX" id="ImEquation264">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$S^{MSP}$\end{document}</tex-math>
                </inline-formula>
              </td>
              <td rowspan="1" colspan="1">99.65</td>
              <td rowspan="1" colspan="1">
                <inline-formula>
                  <tex-math notation="LaTeX" id="ImEquation265">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\color{red}{\boldsymbol{{99.41}}}$\end{document}</tex-math>
                </inline-formula>
              </td>
              <td rowspan="1" colspan="1">98.56</td>
              <td rowspan="1" colspan="1">97.14</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1">
                <inline-formula>
                  <tex-math notation="LaTeX" id="ImEquation266">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$S^{ODIN}$\end{document}</tex-math>
                </inline-formula>
              </td>
              <td rowspan="1" colspan="1">
                <inline-formula>
                  <tex-math notation="LaTeX" id="ImEquation267">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\color{blue}{\boldsymbol{{99.75}}}$\end{document}</tex-math>
                </inline-formula>
              </td>
              <td rowspan="1" colspan="1">
                <inline-formula>
                  <tex-math notation="LaTeX" id="ImEquation268">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\color{red}{\boldsymbol{{99.41}}}$\end{document}</tex-math>
                </inline-formula>
              </td>
              <td rowspan="1" colspan="1">98.66</td>
              <td rowspan="1" colspan="1">97.48</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1">
                <inline-formula>
                  <tex-math notation="LaTeX" id="ImEquation269">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$S^{SEQ}$\end{document}</tex-math>
                </inline-formula>
              </td>
              <td rowspan="1" colspan="1">
                <inline-formula>
                  <tex-math notation="LaTeX" id="ImEquation270">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\color{red}{\boldsymbol{{99.78}}}$\end{document}</tex-math>
                </inline-formula>
              </td>
              <td rowspan="1" colspan="1">
                <inline-formula>
                  <tex-math notation="LaTeX" id="ImEquation271">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\color{red}{\boldsymbol{{99.41}}}$\end{document}</tex-math>
                </inline-formula>
              </td>
              <td rowspan="1" colspan="1">
                <inline-formula>
                  <tex-math notation="LaTeX" id="ImEquation272">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\color{blue}{\boldsymbol{{98.69}}}$\end{document}</tex-math>
                </inline-formula>
              </td>
              <td rowspan="1" colspan="1">
                <inline-formula>
                  <tex-math notation="LaTeX" id="ImEquation273">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\color{blue}{\boldsymbol{{97.71}}}$\end{document}</tex-math>
                </inline-formula>
              </td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1">
                <inline-formula>
                  <tex-math notation="LaTeX" id="ImEquation274">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$S^{SIM}$\end{document}</tex-math>
                </inline-formula>
              </td>
              <td rowspan="1" colspan="1">
                <inline-formula>
                  <tex-math notation="LaTeX" id="ImEquation275">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\color{red}{\boldsymbol{{99.78}}}$\end{document}</tex-math>
                </inline-formula>
              </td>
              <td rowspan="1" colspan="1">
                <inline-formula>
                  <tex-math notation="LaTeX" id="ImEquation276">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\color{red}{\boldsymbol{{99.41}}}$\end{document}</tex-math>
                </inline-formula>
              </td>
              <td rowspan="1" colspan="1">
                <inline-formula>
                  <tex-math notation="LaTeX" id="ImEquation277">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\color{red}{\boldsymbol{{98.70}}}$\end{document}</tex-math>
                </inline-formula>
              </td>
              <td rowspan="1" colspan="1">
                <inline-formula>
                  <tex-math notation="LaTeX" id="ImEquation278">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\color{red}{\boldsymbol{{97.72}}}$\end{document}</tex-math>
                </inline-formula>
              </td>
            </tr>
          </tbody>
        </table>
      </table-wrap>
      <table-wrap position="anchor" id="TB4">
        <label>Appendix Table 4</label>
        <caption>
          <p>Experimental results with different neural network architecture, including removing BN (scNovel w/o BN) and removing ELU activation function (scNovel w/o BN). The <inline-formula><tex-math notation="LaTeX" id="ImEquation87a">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\color{red}{\mathrm{{red\ bold}}}$\end{document}</tex-math></inline-formula> and <inline-formula><tex-math notation="LaTeX" id="ImEquation87b">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\color{blue}{\mathrm{{blue\ bold}}}$\end{document}</tex-math></inline-formula> are the best and second-best results, respectively, in corresponding evaluation metrics and <inline-formula><tex-math notation="LaTeX" id="ImEquation80">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$C^{novel}$\end{document}</tex-math></inline-formula>. The experiment results suggest that both BN and ELU are useful to boost performance</p>
        </caption>
        <table frame="hsides" rules="groups">
          <colgroup span="1">
            <col span="1" align="left"/>
            <col span="1" align="left"/>
            <col span="1" align="left"/>
            <col span="1" align="left"/>
            <col span="1" align="left"/>
            <col span="1" align="left"/>
          </colgroup>
          <thead>
            <tr>
              <th align="left" rowspan="1" colspan="1">Evaluation</th>
              <th align="left" rowspan="1" colspan="1">Methods</th>
              <th colspan="4" align="left" rowspan="1">
                <inline-formula>
                  <tex-math notation="LaTeX" id="ImEquation81">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$C^{novel}$\end{document}</tex-math>
                </inline-formula>
              </th>
            </tr>
            <tr>
              <th rowspan="1" colspan="1"/>
              <th rowspan="1" colspan="1"/>
              <th align="left" rowspan="1" colspan="1">1</th>
              <th align="left" rowspan="1" colspan="1">2</th>
              <th align="left" rowspan="1" colspan="1">3</th>
              <th align="left" rowspan="1" colspan="1">4</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td rowspan="1" colspan="1">FPR95(%)<inline-formula><tex-math notation="LaTeX" id="ImEquation82">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\downarrow $\end{document}</tex-math></inline-formula></td>
              <td rowspan="1" colspan="1">scNovel w/o BN</td>
              <td rowspan="1" colspan="1">
                <inline-formula>
                  <tex-math notation="LaTeX" id="ImEquation83">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\color{blue}{\boldsymbol{{24.28}}}$\end{document}</tex-math>
                </inline-formula>
              </td>
              <td rowspan="1" colspan="1">26.63</td>
              <td rowspan="1" colspan="1">
                <inline-formula>
                  <tex-math notation="LaTeX" id="ImEquation84">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\color{red}{\boldsymbol{{23.32}}}$\end{document}</tex-math>
                </inline-formula>
              </td>
              <td rowspan="1" colspan="1">
                <inline-formula>
                  <tex-math notation="LaTeX" id="ImEquation85">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\color{blue}{\boldsymbol{{30.17}}}$\end{document}</tex-math>
                </inline-formula>
              </td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1">scNovel w/o ELU</td>
              <td rowspan="1" colspan="1">26.44</td>
              <td rowspan="1" colspan="1">
                <inline-formula>
                  <tex-math notation="LaTeX" id="ImEquation86">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\color{blue}{\boldsymbol{{22.88}}}$\end{document}</tex-math>
                </inline-formula>
              </td>
              <td rowspan="1" colspan="1">31.13</td>
              <td rowspan="1" colspan="1">31.63</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1">scNovel</td>
              <td rowspan="1" colspan="1">
                <inline-formula>
                  <tex-math notation="LaTeX" id="ImEquation87">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\color{red}{\boldsymbol{{22.82}}}$\end{document}</tex-math>
                </inline-formula>
              </td>
              <td rowspan="1" colspan="1">
                <inline-formula>
                  <tex-math notation="LaTeX" id="ImEquation88">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\color{red}{\boldsymbol{{21.31}}}$\end{document}</tex-math>
                </inline-formula>
              </td>
              <td rowspan="1" colspan="1">
                <inline-formula>
                  <tex-math notation="LaTeX" id="ImEquation89">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\color{blue}{\boldsymbol{{28.74}}}$\end{document}</tex-math>
                </inline-formula>
              </td>
              <td rowspan="1" colspan="1">
                <inline-formula>
                  <tex-math notation="LaTeX" id="ImEquation90">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\color{red}{\boldsymbol{{25.95}}}$\end{document}</tex-math>
                </inline-formula>
              </td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">
                <bold>AUROC(%)<inline-formula><tex-math notation="LaTeX" id="ImEquation91">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\uparrow $\end{document}</tex-math></inline-formula></bold>
              </td>
              <td rowspan="1" colspan="1">scNovel w/o BN</td>
              <td rowspan="1" colspan="1">94.85</td>
              <td rowspan="1" colspan="1">89.15</td>
              <td rowspan="1" colspan="1">93.42</td>
              <td rowspan="1" colspan="1">91.58</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1">scNovel w/o ELU</td>
              <td rowspan="1" colspan="1">
                <inline-formula>
                  <tex-math notation="LaTeX" id="ImEquation92">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\color{blue}{\boldsymbol{{96.03}}}$\end{document}</tex-math>
                </inline-formula>
              </td>
              <td rowspan="1" colspan="1">
                <inline-formula>
                  <tex-math notation="LaTeX" id="ImEquation93">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\color{blue}{\boldsymbol{{93.47}}}$\end{document}</tex-math>
                </inline-formula>
              </td>
              <td rowspan="1" colspan="1">
                <inline-formula>
                  <tex-math notation="LaTeX" id="ImEquation94">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\color{blue}{\boldsymbol{{94.24}}}$\end{document}</tex-math>
                </inline-formula>
              </td>
              <td rowspan="1" colspan="1">
                <inline-formula>
                  <tex-math notation="LaTeX" id="ImEquation95">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\color{blue}{\boldsymbol{{93.01}}}$\end{document}</tex-math>
                </inline-formula>
              </td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1">scNovel</td>
              <td rowspan="1" colspan="1">
                <inline-formula>
                  <tex-math notation="LaTeX" id="ImEquation96">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\color{red}{\boldsymbol{{96.33}}}$\end{document}</tex-math>
                </inline-formula>
              </td>
              <td rowspan="1" colspan="1">
                <inline-formula>
                  <tex-math notation="LaTeX" id="ImEquation97">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\color{red}{\boldsymbol{{94.29}}}$\end{document}</tex-math>
                </inline-formula>
              </td>
              <td rowspan="1" colspan="1">
                <inline-formula>
                  <tex-math notation="LaTeX" id="ImEquation98">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\color{red}{\boldsymbol{{94.64}}}$\end{document}</tex-math>
                </inline-formula>
              </td>
              <td rowspan="1" colspan="1">
                <inline-formula>
                  <tex-math notation="LaTeX" id="ImEquation99">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\color{red}{\boldsymbol{{94.16}}}$\end{document}</tex-math>
                </inline-formula>
              </td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">AUPR(%)<inline-formula><tex-math notation="LaTeX" id="ImEquation100">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\uparrow $\end{document}</tex-math></inline-formula></td>
              <td rowspan="1" colspan="1">scNovel w/o BN</td>
              <td rowspan="1" colspan="1">99.74</td>
              <td rowspan="1" colspan="1">99.09</td>
              <td rowspan="1" colspan="1">98.46</td>
              <td rowspan="1" colspan="1">95.88</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1">scNovel w/o ELU</td>
              <td rowspan="1" colspan="1">
                <inline-formula>
                  <tex-math notation="LaTeX" id="ImEquation101">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\color{blue}{\boldsymbol{{99.77}}}$\end{document}</tex-math>
                </inline-formula>
              </td>
              <td rowspan="1" colspan="1">
                <inline-formula>
                  <tex-math notation="LaTeX" id="ImEquation102">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\color{blue}{\boldsymbol{{99.35}}}$\end{document}</tex-math>
                </inline-formula>
              </td>
              <td rowspan="1" colspan="1">
                <inline-formula>
                  <tex-math notation="LaTeX" id="ImEquation103">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\color{blue}{\boldsymbol{{98.56}}}$\end{document}</tex-math>
                </inline-formula>
              </td>
              <td rowspan="1" colspan="1">
                <inline-formula>
                  <tex-math notation="LaTeX" id="ImEquation104">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\color{blue}{\boldsymbol{{97.03}}}$\end{document}</tex-math>
                </inline-formula>
              </td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1">scNovel</td>
              <td rowspan="1" colspan="1">
                <inline-formula>
                  <tex-math notation="LaTeX" id="ImEquation105">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\color{red}{\boldsymbol{{99.78}}}$\end{document}</tex-math>
                </inline-formula>
              </td>
              <td rowspan="1" colspan="1">
                <inline-formula>
                  <tex-math notation="LaTeX" id="ImEquation106">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\color{red}{\boldsymbol{{99.41}}}$\end{document}</tex-math>
                </inline-formula>
              </td>
              <td rowspan="1" colspan="1">
                <inline-formula>
                  <tex-math notation="LaTeX" id="ImEquation107">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\color{red}{\boldsymbol{{98.70}}}$\end{document}</tex-math>
                </inline-formula>
              </td>
              <td rowspan="1" colspan="1">
                <inline-formula>
                  <tex-math notation="LaTeX" id="ImEquation108">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\color{red}{\boldsymbol{{97.72}}}$\end{document}</tex-math>
                </inline-formula>
              </td>
            </tr>
          </tbody>
        </table>
      </table-wrap>
    </app>
    <app>
      <title>E. Discussion of scNovel and scBalance</title>
      <p>The recent work named scBalance [<xref rid="ref16" ref-type="bibr">16</xref>] focuses on identifying rare cell types in large datasets, while we focus on novel rare cell detection. We explain it in detail below. The scBalance specializes in classifying rare cells into known categories within single-cell sequencing datasets, unable to identify previously unknown cell types. In contrast, scNovel is aimed at detecting novel rare cell types by determining if a cell type has been observed before, thus capable of identifying new cell types beyond mere classification. The main limitation of scBalance is its inability to classify cells outside its trained categories, leading to potential misclassification. scNovel addresses this by detecting cells that don’t fit into known categories, improving accuracy in identifying novel cell types. However, scNovel could be enhanced with a more robust architecture and refined scoring function to better distinguish between typical and novel cell distributions, indicating areas for future improvement in both models. We employ the same network architecture like scBalance and loss function, while we propose new score functions (<inline-formula><tex-math notation="LaTeX" id="ImEquation230">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$S^{ODIN}$\end{document}</tex-math></inline-formula>, <inline-formula><tex-math notation="LaTeX" id="ImEquation231">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$S^{SEQ}$\end{document}</tex-math></inline-formula> and <inline-formula><tex-math notation="LaTeX" id="ImEquation232">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$S^{SIM}$\end{document}</tex-math></inline-formula>) to further improve performance. Therefore, if we directly apply scBalance for novel rare cell detection, the performance will be degraded to the performance of SMSP. Therefore, the experiment comparison between scNovel and scBalance is shown in <xref rid="TB3" ref-type="table">Appendix Table 3</xref>, while <inline-formula><tex-math notation="LaTeX" id="ImEquation233">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$S^{MSP}$\end{document}</tex-math></inline-formula> is the performance of scBalance.</p>
    </app>
  </app-group>
</back>
