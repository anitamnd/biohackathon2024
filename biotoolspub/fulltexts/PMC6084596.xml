<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.1 20151215//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.1?>
<?ConverterInfo.XSLTName jp2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">Bioinformatics</journal-id>
    <journal-id journal-id-type="publisher-id">bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1367-4803</issn>
    <issn pub-type="epub">1367-4811</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">6084596</article-id>
    <article-id pub-id-type="doi">10.1093/bioinformatics/bty193</article-id>
    <article-id pub-id-type="publisher-id">bty193</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Original Papers</subject>
        <subj-group subj-group-type="category-toc-heading">
          <subject>Data and Text Mining</subject>
        </subj-group>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Predicting serious rare adverse reactions of novel chemicals</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Poleksic</surname>
          <given-names>Aleksandar</given-names>
        </name>
        <xref ref-type="aff" rid="bty193-aff1">1</xref>
        <xref ref-type="corresp" rid="bty193-cor1"/>
        <!--<email>poleksic@cs.uni.edu</email>-->
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Xie</surname>
          <given-names>Lei</given-names>
        </name>
        <xref ref-type="aff" rid="bty193-aff2">2</xref>
        <xref ref-type="aff" rid="bty193-aff3">3</xref>
        <xref ref-type="corresp" rid="bty193-cor1"/>
        <!--<email>lei.xie@hunter.cuny.edu</email>-->
      </contrib>
    </contrib-group>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Wren</surname>
          <given-names>Jonathan</given-names>
        </name>
        <role>Associate Editor</role>
      </contrib>
    </contrib-group>
    <aff id="bty193-aff1"><label>1</label>Department of Computer Science, University of Northern Iowa, Cedar Falls, IA, USA</aff>
    <aff id="bty193-aff2"><label>2</label>Department of Computer Science, Hunter College, The Graduate Center, The City University of New York, New York, NY, USA</aff>
    <aff id="bty193-aff3"><label>3</label>Ph.D. Program in Computer Science, Biochemistry and Biology, The Graduate Center, The City University of New York, New York, NY, USA</aff>
    <author-notes>
      <corresp id="bty193-cor1">To whom correspondence should be addressed. Email: <email>poleksic@cs.uni.edu</email> or <email>lei.xie@hunter.cuny.edu</email></corresp>
    </author-notes>
    <pub-date pub-type="ppub">
      <day>15</day>
      <month>8</month>
      <year>2018</year>
    </pub-date>
    <pub-date pub-type="epub" iso-8601-date="2018-03-29">
      <day>29</day>
      <month>3</month>
      <year>2018</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>29</day>
      <month>3</month>
      <year>2018</year>
    </pub-date>
    <!-- PMC Release delay is 0 months and 0 days and was based on the <pub-date pub-type="epub"/>. -->
    <volume>34</volume>
    <issue>16</issue>
    <fpage>2835</fpage>
    <lpage>2842</lpage>
    <history>
      <date date-type="received">
        <day>28</day>
        <month>10</month>
        <year>2017</year>
      </date>
      <date date-type="rev-recd">
        <day>19</day>
        <month>3</month>
        <year>2018</year>
      </date>
      <date date-type="accepted">
        <day>28</day>
        <month>3</month>
        <year>2018</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2018. Published by Oxford University Press.</copyright-statement>
      <copyright-year>2018</copyright-year>
      <license license-type="cc-by-nc" xlink:href="http://creativecommons.org/licenses/by-nc/4.0/">
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution Non-Commercial License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by-nc/4.0/">http://creativecommons.org/licenses/by-nc/4.0/</ext-link>), which permits non-commercial re-use, distribution, and reproduction in any medium, provided the original work is properly cited. For commercial re-use, please contact journals.permissions@oup.com</license-p>
      </license>
    </permissions>
    <self-uri xlink:href="bty193.pdf"/>
    <abstract>
      <title>Abstract</title>
      <sec id="s1">
        <title>Motivation</title>
        <p>Adverse drug reactions (ADRs) are one of the main causes of death and a major financial burden on the world’s economy. Due to the limitations of the animal model, computational prediction of serious and rare ADRs is invaluable. However, current state-of-the-art computational methods do not yield significantly better predictions of rare ADRs than random guessing.</p>
      </sec>
      <sec id="s2">
        <title>Results</title>
        <p>We present a novel method, based on the theory of ‘compressed sensing’ (CS), which can accurately predict serious side-effects of candidate and market drugs. Not only is our method able to infer new chemical-ADR associations using existing noisy, biased and incomplete databases, but our data also demonstrate that the accuracy of CS in predicting a serious ADR for a candidate drug increases with increasing knowledge of other ADRs associated with the drug. In practice, this means that as the candidate drug moves up the different stages of clinical trials, the prediction accuracy of our method will increase accordingly.</p>
      </sec>
      <sec id="s3">
        <title>Availability and implementation</title>
        <p>The program is available at <ext-link ext-link-type="uri" xlink:href="https://github.com/poleksic/side-effects">https://github.com/poleksic/side-effects</ext-link>.</p>
      </sec>
      <sec id="s4">
        <title>Supplementary information</title>
        <p><xref ref-type="supplementary-material" rid="sup1">Supplementary data</xref> are available at <italic>Bioinformatics</italic> online.</p>
      </sec>
    </abstract>
    <funding-group>
      <award-group award-type="grant">
        <funding-source>
          <named-content content-type="funder-name">National Library of Medicine</named-content>
        </funding-source>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <named-content content-type="funder-name">National Institute of Health</named-content>
        </funding-source>
        <award-id>R01LM011986</award-id>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <named-content content-type="funder-name">National Institute of General Medical Sciences</named-content>
          <named-content content-type="funder-identifier">10.13039/100000057</named-content>
        </funding-source>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <named-content content-type="funder-name">National Institute of Health</named-content>
        </funding-source>
        <award-id>R01GM122845</award-id>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <named-content content-type="funder-name">National Science Foundation</named-content>
          <named-content content-type="funder-identifier">10.13039/100000001</named-content>
        </funding-source>
        <award-id>CNS-0958379</award-id>
        <award-id>CNS-0855217</award-id>
        <award-id>ACI-1126113</award-id>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <named-content content-type="funder-name">City University of New York High Performance Computing Center</named-content>
        </funding-source>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <named-content content-type="funder-name">College of Staten Island</named-content>
        </funding-source>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <named-content content-type="funder-name">University of Northern Iowa Equipment</named-content>
        </funding-source>
      </award-group>
    </funding-group>
    <counts>
      <page-count count="8"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec>
    <title>1 Introduction</title>
    <sec>
      <title>1.1 Background</title>
      <p>Adverse drug reactions (ADRs) are one of the main burdens in modern drug discovery (<xref rid="bty193-B1" ref-type="bibr">Bouvy <italic>et al.</italic>, 2015</xref>). Rare and serious ADRs are responsible for failed drug discovery pipelines and for drug market withdrawals. Cumulative costs of the management of ADRs have been estimated at more than 30 billion per year in the USA alone (<xref rid="bty193-B23" ref-type="bibr">Sultana <italic>et al.</italic>, 2013</xref>). Clinical impact, including emergency department visits and prolonged hospital stay, account for a large portion of health care cost. Up to one-third of emergency visits by older adults are due to ADRs (<xref rid="bty193-B4" ref-type="bibr">Budnitz <italic>et al.</italic>, 2007</xref>), while more than one-third of ADRs in the pediatric population are potentially life threatening (<xref rid="bty193-B11" ref-type="bibr">Impicciatore <italic>et al.</italic>, 2001</xref>). According to a nationwide Swedish study, ADRs rank seventh among all causes of death (<xref rid="bty193-B25" ref-type="bibr">Wester <italic>et al.</italic>, 2008</xref>). The figures from US studies are even more alarming as they place ADRs as the fourth most common cause of death, ahead of diabetes, pulmonary disease, AIDS, pneumonia, general accidents and automobile accidents (<xref rid="bty193-B13" ref-type="bibr">Lazarou <italic>et al.</italic>, 1998</xref>).</p>
      <p>Finding ADRs for a drug before the drug reaches the market is a difficult and an error prone task. The results of testing a chemical on animals do not always correlate to those obtained when testing the same chemical on humans. Moreover, the patient population recruited during clinical trials is small and biased and hence the data are not statistically robust. Most importantly, clinical trials fail to identify rare and serious side-effects, due to relatively small study duration.</p>
      <p>Post marketing surveillance allows for a statistically significant patient population that is followed for a longer period of time. However, the results of post-marketing studies are mostly based on combination drugs and thus are difficult to interpret. More specifically, it is challenging to tell which drug, among multiple ones given to the patient, gives rise to the reported side-effect.</p>
      <p>Recent years have seen development of computational approaches to predicting ADRs. <xref rid="bty193-B21" ref-type="bibr">Pauwels <italic>et al.</italic> (2011)</xref> and <xref rid="bty193-B19" ref-type="bibr">Mizutani <italic>et al.</italic> (2012)</xref> employed canonical correlation analysis (CCA) using the information about chemical substructures and drug’s protein targets. <xref rid="bty193-B10" ref-type="bibr">Huang <italic>et al.</italic> (2013)</xref> used the support vector machines to predict ADR profiles by integrating chemical structures with protein–protein interaction networks. <xref rid="bty193-B2" ref-type="bibr">Bresso <italic>et al.</italic> (2013)</xref> applied machine learning on integrated functional annotation, pathways and drug characteristics to predict and understand ADR mechanisms. <xref rid="bty193-B16" ref-type="bibr">Liu <italic>et al.</italic> (2012)</xref> use machine-learning to integrate drugs’ characteristics, such as indications and known ADRs, with the drug's chemical structures, known targets and pathways. <xref rid="bty193-B28" ref-type="bibr">Zhang <italic>et al.</italic> (2015)</xref> viewed ADR prediction as a multi-label learning (ML) and ensemble learning task. In their ML algorithm, drug features are associated with side-effects while feature dimensions represent biological components. <xref rid="bty193-B27" ref-type="bibr">Xiao <italic>et al.</italic> (2017)</xref> applied symbolic latent Dirichlet allocation to learn hidden topics that represents biochemical mechanism that associates drugs to ADRs.</p>
      <p>While the advances in the area of computational ADR prediction are encouraging, the field is still at its infancy when it comes to predicting rare and serious ADRs. A harmful ADR often surfaces years or even decades after the drug has been approved. Inability to predict these events leads to complications in diseases and treatments, which can have long-term consequences and fatal outcomes. Drug pipeline failures and post-marketing drug withdrawals result in loss of effective compounds (those for which the benefit-to-harm balance is unfavorable), which in turn results in loss of revenue by the drug manufacturer. A methodology capable of predicting ADRs long before the drug reaches the market or even before the drug is withdrawn from the market would significantly enhance drug discovery and improve human health.</p>
    </sec>
    <sec>
      <title>1.2 Compressed sensing for ADR prediction</title>
      <p>We show that a variant of the ‘compressed sensing’ (CS) technique, namely the ‘low-rank matrix completion’ (LRMC), from the digital signal processing field, can be easily adapted and used to predict drug-ADR associations with unmatched accuracy. Originally proposed to solve problems arising in coding and data acquisition, CS has proved to be an efficient way of recovering any type of signal from few and erroneous samples (<xref rid="bty193-B5" ref-type="bibr">Candès, 2006</xref>; <xref rid="bty193-B6" ref-type="bibr">Candès <italic>et al.</italic>, 2006</xref>; <xref rid="bty193-B8" ref-type="bibr">Donoho, 2006</xref>). In the framework of ADR prediction, the ‘signal’ can be thought of as the set of all drug-ADR associations (those already observed and those yet to be found). The ‘sample’ represents known (reported) associations, identified and stored in the existing drug-ADR databases, such as SIDER (<xref rid="bty193-B12" ref-type="bibr">Kuhn <italic>et al.</italic>, 2010</xref>). The key observation is that the sample, defined this way, is both sparse and noisy, due to the well-known difficulty of identifying ADRs during clinical trials and post-marketing studies. Therefore, just like the problems in imaging and face recognition, or problems in optical systems research or wireless networking, the drug-ADR association prediction problem is highly amenable to ‘CS’ solution.</p>
    </sec>
  </sec>
  <sec>
    <title>2 Materials and methods</title>
    <sec>
      <title>2.1 Algorithm</title>
      <p>We cast drug-ADR prediction as a signal recovery problem, in which the signal represents the collection of all drug-ADR associations, i.e. those already observed and those yet to be found. The sample is a weak and sparse representation of the signal, consisting only of known (observed) drug-ADR associations, i.e. the associations stored in the existing drug-ADR association databases (in our case SIDER). Assuming that the true (recovered) matrix of drug-ADR associations is of small rank, the drug-ADR signal reconstruction becomes amenable to a variant of CS known as the ‘LRMC’. We note that the small rank assumption is reasonable since a typical ADR is only associated with the low dimensional space of chemical substructures shared by the drugs.</p>
      <p>Starting from a known (in practice, noisy and incomplete) binary matrix of drug-ADR associations <inline-formula id="IE1"><mml:math id="IM1"><mml:mi>R</mml:mi><mml:mo>=</mml:mo><mml:mfenced separators="|"><mml:mrow><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:math></inline-formula>, a pairwise ADR similarity matrix <inline-formula id="IE2"><mml:math id="IM2"><mml:mi>M</mml:mi><mml:mo>=</mml:mo><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:math></inline-formula> and a pairwise drug similarity matrix <inline-formula id="IE3"><mml:math id="IM3"><mml:mi>N</mml:mi><mml:mo>=</mml:mo><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:math></inline-formula>, our algorithm outputs the ‘latent’ ADR and drug preferences <inline-formula id="IE4"><mml:math id="IM4"><mml:mi>F</mml:mi><mml:mo>=</mml:mo><mml:mfenced separators="|"><mml:mrow><mml:msub><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:math></inline-formula> and <inline-formula id="IE5"><mml:math id="IM5"><mml:mi>G</mml:mi><mml:mo>=</mml:mo><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>g</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:math></inline-formula> by minimizing the loss function
<disp-formula id="E1"><label>(1)</label><mml:math id="M1"><mml:mrow><mml:munder><mml:mo stretchy="false">∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:munder><mml:mrow><mml:msub><mml:mrow><mml:mi>w</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mfenced open="{" close="}" separators="|"><mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="italic">ln</mml:mi></mml:mrow><mml:mo>⁡</mml:mo><mml:mrow><mml:mfenced separators="|"><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:msup><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:msubsup><mml:mrow><mml:mi>g</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">'</mml:mi></mml:mrow></mml:msubsup><mml:mi mathvariant="normal"> </mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mfenced></mml:mrow></mml:mrow><mml:mo>-</mml:mo><mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>q</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo><mml:msub><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:msubsup><mml:mrow><mml:mi>g</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">'</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:mfenced></mml:mrow></mml:mrow><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mo>λ</mml:mo></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:msubsup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mfenced open="‖" close="‖" separators="|"><mml:mi>|| </mml:mi><mml:mrow><mml:mi>F</mml:mi><mml:mi> ||</mml:mi></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo>+</mml:mo><mml:msubsup><mml:mrow><mml:mfenced open="‖" close="‖" separators="|"><mml:mrow><mml:mi>|| </mml:mi><mml:mi>G</mml:mi><mml:mi> ||</mml:mi></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo stretchy="false">)</mml:mo><mml:mi mathvariant="normal"> </mml:mi><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="normal"> </mml:mi><mml:mo>λ</mml:mo></mml:mrow><mml:mrow><mml:mi>M</mml:mi></mml:mrow></mml:msub><mml:mi>t</mml:mi><mml:mi>r</mml:mi><mml:mfenced separators="|"><mml:mrow><mml:msup><mml:mrow><mml:mi>F</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">'</mml:mi></mml:mrow></mml:msup><mml:mfenced separators="|"><mml:mrow><mml:msub><mml:mrow><mml:mi>D</mml:mi></mml:mrow><mml:mrow><mml:mi>M</mml:mi></mml:mrow></mml:msub><mml:mo>-</mml:mo><mml:mi>M</mml:mi></mml:mrow></mml:mfenced><mml:mi>F</mml:mi></mml:mrow></mml:mfenced><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mo>λ</mml:mo></mml:mrow><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:msub><mml:mi>t</mml:mi><mml:mi>r</mml:mi><mml:mfenced separators="|"><mml:mrow><mml:msup><mml:mrow><mml:mi>G</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">'</mml:mi></mml:mrow></mml:msup><mml:mfenced separators="|"><mml:mrow><mml:msub><mml:mrow><mml:mi>D</mml:mi></mml:mrow><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:msub><mml:mo>-</mml:mo><mml:mi>N</mml:mi></mml:mrow></mml:mfenced><mml:mi>G</mml:mi></mml:mrow></mml:mfenced></mml:math></disp-formula>
In the function (1) above, <inline-formula id="IE6"><mml:math id="IM6"><mml:mi>F</mml:mi><mml:mi>'</mml:mi></mml:math></inline-formula> is the transpose of <inline-formula id="IE7"><mml:math id="IM7"><mml:mi>F</mml:mi></mml:math></inline-formula> and <inline-formula id="IE8"><mml:math id="IM8"><mml:mi>||</mml:mi><mml:msub><mml:mi>||</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:math></inline-formula> represents the Frobenius norm. We use <inline-formula id="IE9"><mml:math id="IM9"><mml:mi>t</mml:mi><mml:mi>r</mml:mi></mml:math></inline-formula> to denote the ‘matrix trace’ and <inline-formula id="IE10"><mml:math id="IM10"><mml:msub><mml:mrow><mml:mi>D</mml:mi></mml:mrow><mml:mrow><mml:mi>M</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> to denote the ‘degree matrix’ of <inline-formula id="IE11"><mml:math id="IM11"><mml:mi>M</mml:mi></mml:math></inline-formula> (namely the diagonal matrix whose diagonal element in row <inline-formula id="IE12"><mml:math id="IM12"><mml:mi>i</mml:mi></mml:math></inline-formula> represents the sum of all elements of <inline-formula id="IE13"><mml:math id="IM13"><mml:mi>M</mml:mi></mml:math></inline-formula> that belong to row <inline-formula id="IE14"><mml:math id="IM14"><mml:mi>i</mml:mi></mml:math></inline-formula>). The lambdas (<inline-formula id="IE15"><mml:math id="IM15"><mml:mo>λ</mml:mo><mml:mi>'</mml:mi><mml:mi>s</mml:mi></mml:math></inline-formula>) are optimizable parameters. The output matrix of drug-ADR associations is computed according to the formula <inline-formula id="IE16"><mml:math id="IM16"><mml:mi>P</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:mi mathvariant="normal">exp</mml:mi></mml:mrow><mml:mo>⁡</mml:mo><mml:mrow><mml:mfenced separators="|"><mml:mrow><mml:mi>F</mml:mi><mml:msup><mml:mrow><mml:mi>G</mml:mi></mml:mrow><mml:mrow><mml:mi>'</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mfenced></mml:mrow></mml:mrow><mml:mo>/</mml:mo><mml:mo>(</mml:mo><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mrow><mml:mrow><mml:mi mathvariant="normal">exp</mml:mi></mml:mrow><mml:mo>⁡</mml:mo><mml:mrow><mml:mfenced separators="|"><mml:mrow><mml:mi>F</mml:mi><mml:msup><mml:mrow><mml:mi>G</mml:mi></mml:mrow><mml:mrow><mml:mi>'</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mfenced></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:math></inline-formula>, where <inline-formula id="IE17"><mml:math id="IM17"><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">x</mml:mi><mml:mi mathvariant="normal">p</mml:mi><mml:mo>(</mml:mo><mml:mo>)</mml:mo></mml:math></inline-formula> represents the matrix exponential. A schematic diagram illustrating the flow of our algorithm is given in <xref ref-type="fig" rid="bty193-F1">Figure 1</xref>.
</p>
      <fig id="bty193-F1" orientation="portrait" position="float">
        <label>Fig. 1.</label>
        <caption>
          <p>Algorithm flow<bold>.</bold> R: known drug-ADR associations (sample); M: pairwise ADR similarity matrix; N: pairwise drug similarity matrix; W: drug-ADR frequencies; Q: impute values; F: latent ADR preferences; G: latent drug preferences; P: output drug-ADR probabilities (recovered signal)</p>
        </caption>
        <graphic xlink:href="bty193f1"/>
      </fig>
      <p>The first two terms in <xref ref-type="disp-formula" rid="E1">Equation (1)</xref> drive the ‘signal recovery’ (matrix completion) process, whereas the last two terms mandate that similar drugs have similar side-effects and vice versa. Although our method is capable of factoring in the drug-ADR frequency values <inline-formula id="IE18"><mml:math id="IM18"><mml:msub><mml:mrow><mml:mi>w</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> and the drug-ADR impute values <inline-formula id="IE19"><mml:math id="IM19"><mml:msub><mml:mrow><mml:mi>q</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>, this information is currently not been taken advantage of and <inline-formula id="IE20"><mml:math id="IM20"><mml:msub><mml:mrow><mml:mi>w</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> and <inline-formula id="IE21"><mml:math id="IM21"><mml:msub><mml:mrow><mml:mi>q</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> are set to 1’s and 0’s, respectively.</p>
      <p>The matrices of latent ADR and drug preferences (<inline-formula id="IE22"><mml:math id="IM22"><mml:mi>F</mml:mi></mml:math></inline-formula> and <inline-formula id="IE23"><mml:math id="IM23"><mml:mi>G</mml:mi></mml:math></inline-formula>, respectively) are found during the standard minimization procedure. For the sake of brevity, we skip technical details, but emphasize that the key idea behind our approach is to demand that <inline-formula id="IE24"><mml:math id="IM24"><mml:mi>F</mml:mi></mml:math></inline-formula> and <inline-formula id="IE25"><mml:math id="IM25"><mml:mi>G</mml:mi></mml:math></inline-formula> are small in one dimension. That way, the output matrix <inline-formula id="IE26"><mml:math id="IM26"><mml:mi>P</mml:mi></mml:math></inline-formula> of predicted interaction probabilities (recovered signal) must be of small rank and, in turn, free of noise. An efficient optimization of the objective function (1) is achieved using a stochastic gradient descent method (<xref rid="bty193-B9" ref-type="bibr">Duchi <italic>et al.</italic>, 2011</xref>). For more details on that method, we refer the reader to <xref rid="bty193-B15" ref-type="bibr">Lim <italic>et al.</italic> (2016)</xref> and the accompanying <xref ref-type="supplementary-material" rid="sup1">Supplementary Material</xref>.</p>
      <p>While the pairwise drug similarity scores (<inline-formula id="IE27"><mml:math id="IM27"><mml:mi>N</mml:mi><mml:mo>)</mml:mo></mml:math></inline-formula> are computed using the classical Jaccard index (<xref rid="bty193-B22" ref-type="bibr">Rogers and Tanimoto, 1960</xref>), the notion of pairwise ADR similarity scores (along with the notion of frequencies and impute values) is unique to our method and improves the prediction accuracy. Our pairwise ADR similarity scores are defined as the average of semantic and relatedness measures (<italic>path</italic> and <italic>lesk</italic>, respectively) and are computed by running the <italic>umls-similarity</italic> software (<xref rid="bty193-B18" ref-type="bibr">McInnes <italic>et al.</italic>, 2009</xref>) on MedDRA vocabulary (<xref rid="bty193-B3" ref-type="bibr">Brown <italic>et al.</italic>, 1999</xref>).</p>
      <p>An added benefit of our loss function (1) is that it allows one to take advantage of the frequencies of known drug-ADR associations and the drug-ADR impute values. Each <inline-formula id="IE28"><mml:math id="IM28"><mml:msub><mml:mrow><mml:mi>w</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> represents the frequency at which the drug <inline-formula id="IE29"><mml:math id="IM29"><mml:mi>j</mml:mi></mml:math></inline-formula> causes the side-effect <inline-formula id="IE30"><mml:math id="IM30"><mml:mi>i</mml:mi></mml:math></inline-formula>, while each <inline-formula id="IE31"><mml:math id="IM31"><mml:msub><mml:mrow><mml:mi>q</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> can be used to explicitly specify the likelihood of a drug-ADR association. To explain how the impute values can be useful in predicting drug-ADR associations, consider, for instance, an ambiguous case of a newly discovered drug-ADR association that has not yet been observed and recorded in the database (<inline-formula id="IE32"><mml:math id="IM32"><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:math></inline-formula>). This new knowledge can be easily incorporated into our method by setting <inline-formula id="IE33"><mml:math id="IM33"><mml:msub><mml:mrow><mml:mi>q</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:math></inline-formula>, while adjusting the corresponding weight <inline-formula id="IE34"><mml:math id="IM34"><mml:msub><mml:mrow><mml:mi>w</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> to account for any uncertainty in the imputed value. Unfortunately, our current experiments use neither the weight nor the impute value functionality, due to the lack of data on drug-ADR frequencies. This might change in the future, as more comprehensive databases, containing frequency information, become available.</p>
      <p>While we have originally developed and published the analytical framework (1) for the drug–target interaction problem (<xref rid="bty193-B15" ref-type="bibr">Lim <italic>et al.</italic>, 2016</xref>), we subsequently noticed that the CS is much more amenable to predicting ADRs. In contrast to drug–target interaction problem, where the baseline data are already clean but incomplete, the drug-ADR association data are both incomplete and noisy. CS is particularly suited to deal with such data.</p>
      <p>We compared our approach to two recent state-of-the-art algorithms for drug-ADR association prediction: ML (<xref rid="bty193-B28" ref-type="bibr">Zhang <italic>et al.</italic>, 2015</xref>) and CCA (<xref rid="bty193-B19" ref-type="bibr">Mizutani <italic>et al.</italic>, 2012</xref>; <xref rid="bty193-B21" ref-type="bibr">Pauwels <italic>et al.</italic>, 2011</xref>). In recent benchmarking studies, these two methods exhibited superior accuracy when compared to other methods for the same problem (<xref rid="bty193-B28" ref-type="bibr">Zhang <italic>et al.</italic>, 2015</xref>). For a fair comparison, the benchmarks presented here use the same dataset and the same test protocols as in <xref rid="bty193-B28" ref-type="bibr">Zhang <italic>et al.</italic> (2015)</xref>.</p>
      <p>In an attempt to gain insight into the progress in the field, we also submitted to our benchmark a naïve, reference method (here called REF). This straightforward method sets the probability that a given drug will give rise to a particular ADR to the overall promiscuity of that ADR. In other words, the probability of a side-effect <inline-formula id="IE35"><mml:math id="IM35"><mml:mi>i</mml:mi></mml:math></inline-formula> being associated with any drug is the same for all drugs and is set to the overall frequency of occurrence of <inline-formula id="IE36"><mml:math id="IM36"><mml:mi>i</mml:mi></mml:math></inline-formula>.</p>
    </sec>
    <sec>
      <title>2.2 Description of the methods compared</title>
      <p>ML and CCA are conceptually different from one another and different from the method we propose. CCA attempts to find the weight vectors <inline-formula id="IE37"><mml:math id="IM37"><mml:mi>u</mml:mi></mml:math></inline-formula> and <inline-formula id="IE38"><mml:math id="IM38"><mml:mi>v</mml:mi></mml:math></inline-formula> that maximize the correlation between the side-effects and drugs’ chemical substructure feature vectors (<xref rid="bty193-B21" ref-type="bibr">Pauwels <italic>et al.</italic>, 2011</xref>; <xref rid="bty193-B19" ref-type="bibr">Mizutani <italic>et al.</italic>, 2012</xref>). To accomplish this, the algorithm uses the penalized matrix decomposition (PMD) which can be viewed as a regularized version of the singular value decomposition method. More specifically, let <inline-formula id="IE39"><mml:math id="IM39"><mml:mi>R</mml:mi></mml:math></inline-formula> denotes an (incomplete) <inline-formula id="IE40"><mml:math id="IM40"><mml:mi>m</mml:mi><mml:mo>× </mml:mo><mml:mi>n</mml:mi></mml:math></inline-formula> matrix of drug-ADR association and let <inline-formula id="IE41"><mml:math id="IM41"><mml:mi>Y</mml:mi></mml:math></inline-formula> denotes a <inline-formula id="IE42"><mml:math id="IM42"><mml:mi>n</mml:mi><mml:mo>×</mml:mo><mml:mi>p</mml:mi></mml:math></inline-formula> matrix of binary fingerprints for <inline-formula id="IE43"><mml:math id="IM43"><mml:mi>n</mml:mi></mml:math></inline-formula> drugs (each represented by a PubChem substructure feature vector of length <inline-formula id="IE44"><mml:math id="IM44"><mml:mi>p</mml:mi><mml:mo>=</mml:mo><mml:mn>881</mml:mn></mml:math></inline-formula>). Using the PMD technique, the CCA algorithm finds the representation (approximation) <inline-formula id="IE45"><mml:math id="IM45"><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mo>∼</mml:mo></mml:mover></mml:mrow></mml:math></inline-formula> of the matrix <inline-formula id="IE46"><mml:math id="IM46"><mml:mi>X</mml:mi><mml:mo>=</mml:mo><mml:mi>R</mml:mi><mml:mi>Y</mml:mi></mml:math></inline-formula> of the form <inline-formula id="IE47"><mml:math id="IM47"><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mo>∼</mml:mo></mml:mover></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:msubsup><mml:mo stretchy="false">∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>K</mml:mi></mml:mrow></mml:msubsup><mml:mrow><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>u</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:msubsup><mml:mrow><mml:mi>v</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mi>'</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:mrow></mml:math></inline-formula>, where <inline-formula id="IE48"><mml:math id="IM48"><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>, <inline-formula id="IE49"><mml:math id="IM49"><mml:msub><mml:mrow><mml:mi>u</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> and <inline-formula id="IE50"><mml:math id="IM50"><mml:msubsup><mml:mrow><mml:mi>v</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mi> '</mml:mi></mml:mrow></mml:msubsup></mml:math></inline-formula> minimize the squared Frobenius norm, subject to penalties on vectors <inline-formula id="IE51"><mml:math id="IM51"><mml:msub><mml:mrow><mml:mi>u</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> and <inline-formula id="IE52"><mml:math id="IM52"><mml:msub><mml:mrow><mml:mi>v</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>. The more advanced variant of the CCA algorithm, which we tested here, uses the <inline-formula id="IE53"><mml:math id="IM53"><mml:msub><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:math></inline-formula> penalties (where the <inline-formula id="IE54"><mml:math id="IM54"><mml:msub><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:math></inline-formula> norm of a vector is defined as the sum of the absolute values of its coordinates), yielding a decomposition of <inline-formula id="IE55"><mml:math id="IM55"><mml:mi>X</mml:mi></mml:math></inline-formula> that utilizes sparse vectors <inline-formula id="IE56"><mml:math id="IM56"><mml:msub><mml:mrow><mml:mi>u</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> and <inline-formula id="IE57"><mml:math id="IM57"><mml:msub><mml:mrow><mml:mi>v</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>. The recovered matrix of drug-ADR associations is computed as the matrix product <inline-formula id="IE58"><mml:math id="IM58"><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mo>∼</mml:mo></mml:mover></mml:mrow><mml:mi>Y</mml:mi><mml:mi>'</mml:mi></mml:math></inline-formula>. For technical details on PMD, the reader is referred to <xref rid="bty193-B26" ref-type="bibr">Witten <italic>et al.</italic> (2009)</xref>.</p>
      <p>In the ML algorithm, the side-effect prediction problem is viewed as a ‘ML’ task (<xref rid="bty193-B28" ref-type="bibr">Zhang <italic>et al.</italic>, 2015</xref>). Specifically, let <inline-formula id="IE59"><mml:math id="IM59"><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> represents the binary side-effect vector defined by
<disp-formula id="E2"><mml:math id="M2"><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mfenced separators="|"><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:mfenced open="{" close="" separators="|"><mml:mrow><mml:mtable columnalign="left"><mml:mtr><mml:mtd><mml:mn>1</mml:mn><mml:mi mathvariant="normal"> </mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">f</mml:mi><mml:mi mathvariant="normal"> </mml:mi><mml:mi mathvariant="normal">d</mml:mi><mml:mi mathvariant="normal">r</mml:mi><mml:mi mathvariant="normal">u</mml:mi><mml:mi mathvariant="normal">g</mml:mi><mml:mi mathvariant="normal"> </mml:mi><mml:mi>i</mml:mi><mml:mi mathvariant="normal"> </mml:mi><mml:mi mathvariant="normal">c</mml:mi><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">u</mml:mi><mml:mi mathvariant="normal">s</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">s</mml:mi><mml:mi mathvariant="normal"> </mml:mi><mml:mi mathvariant="normal">A</mml:mi><mml:mi mathvariant="normal">D</mml:mi><mml:mi mathvariant="normal">R</mml:mi><mml:mi mathvariant="normal"> </mml:mi><mml:mi>l</mml:mi></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mn>0</mml:mn><mml:mi mathvariant="normal"> </mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">h</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">r</mml:mi><mml:mi mathvariant="normal">w</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">s</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal"> </mml:mi></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mfenced></mml:math></disp-formula>
The ML algorithm calculates <inline-formula id="IE60"><mml:math id="IM60"><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mfenced separators="|"><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:mfenced></mml:math></inline-formula> for a test drug as
<disp-formula id="E3"><mml:math id="M3"><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mfenced separators="|"><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:munder><mml:mrow><mml:mi mathvariant="normal">argmax</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi><mml:mo>∈</mml:mo><mml:mo>{</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi mathvariant="normal"> </mml:mi><mml:mn>1</mml:mn><mml:mo>}</mml:mo></mml:mrow></mml:munder></mml:mrow><mml:mo>⁡</mml:mo><mml:mrow><mml:mi>P</mml:mi><mml:mo stretchy="true">(</mml:mo><mml:msubsup><mml:mrow><mml:mi>H</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:msubsup><mml:mo>|</mml:mo><mml:msubsup><mml:mrow><mml:mi>E</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mi>l</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:math></disp-formula>
In the above formula, <inline-formula id="IE61"><mml:math id="IM61"><mml:msubsup><mml:mrow><mml:mi>H</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:msubsup></mml:math></inline-formula> represents the event that a drug has <inline-formula id="IE62"><mml:math id="IM62"><mml:msup><mml:mrow><mml:mi>l</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mi>h</mml:mi></mml:mrow></mml:msup></mml:math></inline-formula> side effect, <inline-formula id="IE63"><mml:math id="IM63"><mml:msubsup><mml:mrow><mml:mi>H</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:msubsup></mml:math></inline-formula> is the event that it does not, <inline-formula id="IE64"><mml:math id="IM64"><mml:msubsup><mml:mrow><mml:mi>E</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:msubsup></mml:math></inline-formula> is the event that a drug has <inline-formula id="IE65"><mml:math id="IM65"><mml:mi>j</mml:mi></mml:math></inline-formula> neighbors with <inline-formula id="IE66"><mml:math id="IM66"><mml:msup><mml:mrow><mml:mi>l</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mi>h</mml:mi></mml:mrow></mml:msup></mml:math></inline-formula> side-effects in its <inline-formula id="IE67"><mml:math id="IM67"><mml:mi>k</mml:mi></mml:math></inline-formula> nearest neighbors and <inline-formula id="IE68"><mml:math id="IM68"><mml:msub><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mfenced separators="|"><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:mfenced></mml:math></inline-formula> is the number of nearest neighbors of the drug <inline-formula id="IE69"><mml:math id="IM69"><mml:mi>i</mml:mi></mml:math></inline-formula> inducing the side-effect <inline-formula id="IE70"><mml:math id="IM70"><mml:mi>l</mml:mi></mml:math></inline-formula>. Using the Bayesian rule, <inline-formula id="IE71"><mml:math id="IM71"><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mi>l</mml:mi><mml:mo>)</mml:mo></mml:math></inline-formula> can be written as
<disp-formula id="E4"><mml:math id="M4"><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mfenced separators="|"><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:munder><mml:mrow><mml:mi mathvariant="normal">argmax</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi><mml:mo>∈</mml:mo><mml:mo>{</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi mathvariant="normal"> </mml:mi><mml:mn>1</mml:mn><mml:mo>}</mml:mo></mml:mrow></mml:munder></mml:mrow><mml:mo>⁡</mml:mo><mml:mrow><mml:mi>P</mml:mi><mml:mo>(</mml:mo><mml:msubsup><mml:mrow><mml:mi>H</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:msubsup><mml:mo>)</mml:mo><mml:mi>P</mml:mi><mml:mo stretchy="true">(</mml:mo><mml:msubsup><mml:mrow><mml:mi>E</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mi>l</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:mrow><mml:mo>|</mml:mo><mml:msubsup><mml:mrow><mml:mi>H</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:msubsup><mml:mo>)</mml:mo></mml:math></disp-formula></p>
      <p><inline-formula id="IE72"><mml:math id="IM72"><mml:mi>P</mml:mi><mml:mo>(</mml:mo><mml:msubsup><mml:mrow><mml:mi>H</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:msubsup><mml:mo>)</mml:mo></mml:math></inline-formula> and <inline-formula id="IE73"><mml:math id="IM73"><mml:mi>P</mml:mi><mml:mo>(</mml:mo><mml:msubsup><mml:mrow><mml:mi>E</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mfenced separators="|"><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:msubsup><mml:mo>|</mml:mo><mml:msubsup><mml:mrow><mml:mi>H</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:msubsup><mml:mo>)</mml:mo></mml:math></inline-formula> are computed from the training set.</p>
    </sec>
    <sec>
      <title>2.3 Description of the test set and benchmarking measures</title>
      <p>We ran several cross-validation tests on the set of all drug-ADR associations from the SIDER database. SIDER 4.1 contains drug-ADR association data for 1430 FDA approved drugs and 5868 ADRs. This data are represented as a binary matrix <inline-formula id="IE74"><mml:math id="IM74"><mml:mi>R</mml:mi></mml:math></inline-formula>, whose entry <inline-formula id="IE75"><mml:math id="IM75"><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> is equal to 1 if the drug <inline-formula id="IE76"><mml:math id="IM76"><mml:mi>j</mml:mi><mml:mo> </mml:mo></mml:math></inline-formula>is known to cause ADR <inline-formula id="IE77"><mml:math id="IM77"><mml:mi>i</mml:mi></mml:math></inline-formula> and 0 otherwise.</p>
      <p>Each method submitted to our benchmarks was run using its default parameters. Consistent with the procedure in <xref rid="bty193-B28" ref-type="bibr">Zhang <italic>et al.</italic> (2015)</xref>, we provided CS and ML with the same matrix of Tanimoto similarity scores (<xref rid="bty193-B22" ref-type="bibr">Rogers and Tanimoto, 1960</xref>) between pairs of drugs. In contrast to CS and ML, the CCA algorithm takes encoding of drugs’ chemical structures as input. To ensure a fair comparison, we supplied CCA with the set of PubChem fingerprints of lengths 881 (<xref rid="bty193-B14" ref-type="bibr">Li <italic>et al.</italic>, 2010</xref>), identical to those used by the authors of the CCA algorithm.</p>
      <p>To test the accuracy of CS in various settings, we performed multiple cross-validation experiments on different sets of selected drug-ADR pairs. In all but one experiment, we ran five rounds of 10-fold cross-validation on selected drug-ADR pairs. To assess the algorithm’s accuracy in predicting ADRs for chemicals of novel structures, we resorted to leave-one-cross-validation (LOOCV) due to technical reasons (details given in the Results section).</p>
      <p>Our tests employ two classical performance measures, namely the area under the ROC curve (AUC) and the area under the PR curve (AUPR). The receiver operating characteristic (ROC) represents the relationship between the false-positive and the true-positive rate while the precision-recall (PR) curve represents the relationship between the sensitivity (true positive rate or recall) and the positive predictive value (precision).</p>
    </sec>
  </sec>
  <sec>
    <title>3 Results</title>
    <p>Below we show that the CS algorithm is able to reliably infer new chemical-ADR associations using existing noisy, biased and incomplete data stored in the SIDER database. Not only is CS highly tolerant to database errors (mislabeled drug-ADR associations), but it also handles sparse data (yet unknown/unrecorded associations) well. Our method is particularly accurate in predicting severe rare ADRs in cases where some (but not necessarily rare) ADRs for the drug are already known.</p>
    <sec>
      <title>3.1 State of the field of computational ADR prediction</title>
      <p>To assess methods’ accuracies on rare ADRs, we first ran multiple, independent and statistically robust, cross-validation experiments, one for each selected ADR promiscuity cutoff (12, 25, 50, 100, 200, 400, 800, ∞), where the ‘promiscuity’ of an ADR is defined as the number of FDA approved drugs that are known to cause the ADR. For each promiscuity cutoff <italic>x</italic>, a cross-validation experiment was performed on the set of randomly selected drug-ADR pairs in which the ADR’s promiscuity is below <italic>x</italic>. It should be emphasized that the ADR promiscuity can only serve as a crude estimate of how harmful an ADR is (mild ADRs tend to be frequent while harmful ADRs are relatively rare).</p>
      <p>The analysis presented in <xref ref-type="fig" rid="bty193-F2">Figure 2</xref> not only confirms the published accuracy of current methods but also provides an insight into the performance of the state-of-the-art algorithms as well as the accuracy improvement offered by CS.
</p>
      <fig id="bty193-F2" orientation="portrait" position="float">
        <label>Fig. 2.</label>
        <caption>
          <p>State-of-the-art in ADR prediction and the value added by CS, ML, CCA, REF: naïve (reference) method. The values on the x-axis represent ADR promiscuities. The <inline-formula id="IE78"><mml:math id="IM78"><mml:mi>y</mml:mi></mml:math></inline-formula>-axis represents the performance metrics, defined as the AUC. The results were obtained using a statistically rigorous cross-validation experiment on the set of drug-ADR pairs (STDERR is too small to show)</p>
        </caption>
        <graphic xlink:href="bty193f2"/>
      </fig>
      <p>We can summarize the results shown in <xref ref-type="fig" rid="bty193-F2">Figure 2</xref> as follows:
<list list-type="roman-lower"><list-item><p><italic>The existing algorithms are unable to predict serious rare side-effects</italic>. While published accuracies of current methods are more or less satisfactory (balanced and unbalanced AUC and balanced AUPR ∼0.9; unbalanced AUPR ∼0.35), they should be interpreted properly as they only represent the average accuracies computed for all ADRs combined (the right side of <xref ref-type="fig" rid="bty193-F2">Fig. 2</xref>). The cumulative accuracies are driven strongly by easy predictions of frequent and innocuous ADRs, those of little interest in drug discovery. For rare and serious ADRs, the accuracy of current algorithms quickly approaches the accuracy a purely random classifier (AUC ∼0.5).</p></list-item><list-item><p><italic>To date, the progress in the field of computational prediction of rare severe ADRs has been dismal at best</italic>. To assert this claim, it is enough to glance over the line that traces the performance of the naïve and straightforward REF method in <xref ref-type="fig" rid="bty193-F2">Figure 2</xref>. Going beyond this simple approach and implementing more sophisticated techniques, such as ML and CCA, yields a low diminishing return.</p></list-item><list-item><p><italic>CS overcomes current obstacles in predicting drug-ADR associations</italic>. Our method is so efficient in extracting relevant information from noisy, biased and incomplete data (stored in the SIDER database) that its performance in predicting severe ADR (left part of <xref ref-type="fig" rid="bty193-F2">Fig. 2</xref>) matches or even exceeds the cumulative performances of current methods on all side-effects combined (right part of <xref ref-type="fig" rid="bty193-F2">Fig. 2</xref>).</p></list-item></list></p>
    </sec>
    <sec>
      <title>3.2 Compressed sensing learns on the fly</title>
      <p>Not only is CS able to predict rare ADRs, but also, as we will demonstrate later, the performance of CS in predicting ADRs for a particular chemical improves with the increasing knowledge of other ADRs associated with the chemical. In practice, this means that the ability of CS to predict a serious ADR for a candidate chemical would increase as the drug moves up the different stages of clinical trials. Other methods are unable to take advantage of accumulating information on ADRs. This comes as no surprise to us, since a closer look into the ML algorithm reveals that, when predicting whether a drug <inline-formula id="IE79"><mml:math id="IM79"><mml:mi>j</mml:mi></mml:math></inline-formula> is likely to cause an ADR <inline-formula id="IE80"><mml:math id="IM80"><mml:mi>i</mml:mi></mml:math></inline-formula>, ML utilizes the information on other drugs that cause the side-effect <inline-formula id="IE81"><mml:math id="IM81"><mml:mi>i</mml:mi></mml:math></inline-formula>, but not the information on other ADRs associated to <inline-formula id="IE82"><mml:math id="IM82"><mml:mi>j</mml:mi></mml:math></inline-formula>.</p>
      <p>Before running a more comprehensive benchmark, we tested the performance of CS in predicting selected serious side-effects, including hepatotoxicity, cardiotoxicity, carcinogenicity, neurotoxicity, as well as thrombocytopenia, leukopenia, anaemia, nepropathy and death. Those nine ADRs represent some of the main side-effects responsible for drug market withdrawals (<xref rid="bty193-B20" ref-type="bibr">Onakpoya <italic>et al.</italic>, 2016</xref>).</p>
      <p>Starting with hepatotoxicity, we selected all drugs that, according to SIDER classification, are known to cause that ADR (‘cases’) and the same number of randomly selected drugs that are known not to cause hepatotoxicity (‘controls’). We let each method access different amount of information on other ADRs caused by the drugs (10%, 25%, 50%). <xref ref-type="fig" rid="bty193-F3">Figure 3</xref> illustrates the differences in normalized raw scores obtained by CS, ML and CCA on ‘case’ and ‘control’ drugs.
</p>
      <fig id="bty193-F3" orientation="portrait" position="float">
        <label>Fig. 3.</label>
        <caption>
          <p>Predicting hepatotoxicity of drugs. Drugs known to cause hepatotoxicity (‘cases’) are shown in “yes” column, while “no” column (“controls”) represents randomly chosen drugs known not to cause hepatotoxicity. The vertical axis gives normalized prediction scores</p>
        </caption>
        <graphic xlink:href="bty193f3"/>
      </fig>
      <p>While it is obvious that only CS can differentiate between the two sets of drugs (‘cases’ and ‘controls’), it should be noted that the performance of our method might be better than suggested in <xref ref-type="fig" rid="bty193-F3">Figure 3</xref>. For instance, the ‘control’ outlier shown in the middle subfigure of <xref ref-type="fig" rid="bty193-F3">Figure 3</xref> corresponds to the drug <italic>minoxidil</italic> and clearly stands out by its high CS score. Despite being classified as a non-hepatotoxicity drug in SIDER, <italic>minoxidil</italic> is, according to FDA reports, in fact, known to cause hepatotoxicity in patients over the age of 60.</p>
      <p>The performance statistics (AUC and AUPR) obtained from the algorithms’ raw scores (after averaging the raw scores over a dozen of randomly chosen sets of ‘control’ drugs) is presented in <xref ref-type="fig" rid="bty193-F4">Figure 4</xref>. Summary performance data for cardiotoxicity, hepatotoxicity, and neurotoxicity are shown in <xref ref-type="fig" rid="bty193-F5">Figure 5</xref>. As illustrated in the <xref ref-type="supplementary-material" rid="sup1">Supplementary Figure S1</xref>, the results for the remaining six ADRs show similar trends.
</p>
      <fig id="bty193-F4" orientation="portrait" position="float">
        <label>Fig. 4.</label>
        <caption>
          <p>Accuracy of hepatotoxicity predictions. The ROC (top) and PR (bottom) curves are generated based upon the raw scores obtained on ‘case’ and ‘control’ drugs. We performed a number of different tests, each time letting the methods under study (CS, ML, CCA) access different amount of information (10%, 25%, 50%) on other, non-hepatotoxicity ADRs associated with ‘case’ and ‘control’ drugs, thus mimicking methods’ accuracy and reliability during clinical trials. We use “balanced” AUPR for better visualization. Unbalanced AUPR scores are easily obtained by multiplying the balanced scores by the fraction of condition positives in the test set</p>
        </caption>
        <graphic xlink:href="bty193f4"/>
      </fig>
      <fig id="bty193-F5" orientation="portrait" position="float">
        <label>Fig. 5.</label>
        <caption>
          <p>Predicting ADRs responsible for drug market withdrawals<bold>.</bold> The <italic>x</italic>-axis represents the percentage (0%, 10%, 25%, 50%) of other ADRs for the drugs made available to the algorithms under study. The <italic>y</italic>-axis represents the AUC values. The mean AUC values shown in the figures are obtained over multiple runs on ‘control’ drugs to achieve robust statistics (STDERR too small to show). Corresponding figures for other selected ADRs are given in the <xref ref-type="supplementary-material" rid="sup1">Supplementary Material</xref></p>
        </caption>
        <graphic xlink:href="bty193f5"/>
      </fig>
    </sec>
    <sec>
      <title>3.3 Significant performance gains of CS in comprehensive cross-validation benchmarks</title>
      <p>We now return to the comprehensive benchmark from the beginning of this section to provide a more detailed and more illustrative performance analysis.</p>
      <p>Aside from showing the raw scores, <xref ref-type="fig" rid="bty193-F6">Figure 6</xref> illustrates the ‘fold enrichment’ offered by the methods compared. The ‘fold enrichment’ represents the improvement in a method’s performance over the random predictor (one that generates prediction scores uniformly at random). In other words, defined as the quotient of two scores, ‘fold enrichment’ shows how many times is the method’s AUC (or AUPR) better than the AUC (respectively, AUPR) obtained by the purely random classifier. This measure is particularly useful when interpreting the AUPR scores (<xref ref-type="fig" rid="bty193-F6">Fig. 6B</xref>), because (in contrast to the intuitive AUC scores) the AUPR scores depend on the property of the test set. It is important to note that the AUPR score achieved by the purely random classifier is equal to the fraction of condition positives in the test set (<inline-formula id="IE83"><mml:math id="IM83"><mml:mrow><mml:mo stretchy="false">∑</mml:mo><mml:mrow><mml:mi mathvariant="normal">c</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">n</mml:mi><mml:mi mathvariant="normal">d</mml:mi><mml:mo>.</mml:mo><mml:mi mathvariant="normal">p</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">s</mml:mi></mml:mrow></mml:mrow><mml:mo>/</mml:mo><mml:mo>(</mml:mo><mml:mrow><mml:mo stretchy="false">∑</mml:mo><mml:mrow><mml:mi mathvariant="normal">c</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">n</mml:mi><mml:mi mathvariant="normal">d</mml:mi><mml:mo>.</mml:mo><mml:mi mathvariant="normal">p</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">s</mml:mi></mml:mrow></mml:mrow><mml:mo>+</mml:mo><mml:mo> </mml:mo><mml:mrow><mml:mo stretchy="false">∑</mml:mo><mml:mrow><mml:mi mathvariant="normal">c</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">n</mml:mi><mml:mi mathvariant="normal">d</mml:mi><mml:mo>.</mml:mo><mml:mi mathvariant="normal">n</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">g</mml:mi></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:math></inline-formula>).
</p>
      <fig id="bty193-F6" orientation="portrait" position="float">
        <label>Fig. 6.</label>
        <caption>
          <p>Value added by CS in AUC and AUPR benchmarks. The data tables beneath the graphs give the mean methods’ AUC (<bold>A</bold>) and AUPR (<bold>B</bold>) scores obtained in five rounds of 10-fold CV benchmark (STDERR too small to show)</p>
        </caption>
        <graphic xlink:href="bty193f6"/>
      </fig>
      <p>As seen in <xref ref-type="fig" rid="bty193-F6">Figure 6</xref>, CS enriches prediction of ADRs at an almost uniform rate, irrespective of the ADR promiscuity and the type of test performed (AUC or AUPR). For extremely rare ADRs, those associated with less than 12 FDA drugs (such as <italic>carcinogenicity</italic>), the performance of </p>
      <p>CS, as measured by AUPR, is about 27 times better than the performance of the random classifier, while the performance of the better of the two remaining methods (in this case ML) is only about eight times better. For the more frequent serious ADRs, those associated with &lt;50 drugs (such as, for example, <italic>neurotoxicity</italic> or <italic>cardiotoxicity</italic>) the AUPR fold enrichments of CS and SOA are 34 and 12, respectively.</p>
      <p>We also tested the methods accuracy using the Matthews correlation coefficient (MCC) (<xref rid="bty193-B17" ref-type="bibr">Matthews, 1975</xref>. For this purpose, each method was turned into a binary classifier by splitting the SIDER data into training, validation and test set, in the ratio 80/10/10. The benchmarking results are given in <xref ref-type="supplementary-material" rid="sup1">Supplementary Figure S2</xref>. As shown in this figure, the MCC score of CS is significantly higher than that of ML and CCA.</p>
      <p>We note that the cutoff scores required by MCC provide a single set of predictions for a given dataset and each method compared. This approach is advantageous as it provides insight into the benchmarking performance beyond what is available using the cutoff independent metrics such as AUC and AUPR. It is important to emphasize that the actual MCC scores achieved by the three classifiers should be viewed in light of an incomplete and biased test set. First, we note that SIDER contains only ‘positive’ data, namely only the drug-ADR associations observed during clinical trials, which are of limited duration and performed on small patient population groups. More specifically, on average SIDER has 69 ADRs per drug while, in reality, this number is several times higher (<xref rid="bty193-B24" ref-type="bibr">Tatonetti <italic>et al.</italic>, 2012</xref>). For instance, a study of FAERS (FDA Adverse Event Reporting System) postmarketing data reveals at least 329 ADRs per drug on average (<xref rid="bty193-B24" ref-type="bibr">Tatonetti <italic>et al.</italic>, 2012</xref>). This makes the MCC scores close to 1 out of reach of highly accurate classifiers. Even if one errs on conservative side and assumes only 200 ADRs per drug, the top MCC score achieved by a perfect classifier would only be about 0.5807. On the other hand, each classifier in our study uses information beyond what is encoded in SIDER (e.g. the pairwise similarity of drug chemical structures) and thus is potentially capable of detecting the true drug-ADR associations that have not been observed during clinical trials. Liver injury caused by <italic>minoxidil</italic> therapy, discussed earlier, is one such example.</p>
    </sec>
    <sec>
      <title>3.4 Predicting ADRs for novel chemicals with no known ADRs</title>
      <p>A cross-validation benchmarks segregated by drugs was performed to assess the methods’ accuracy in predicting ADRs for chemicals with no known ADRs. The results of AUC and AUPR benchmarks are summarized in <xref ref-type="fig" rid="bty193-F7">Figure 7A and B</xref> and are consistent with those seen on example ADRs presented earlier.
</p>
      <fig id="bty193-F7" orientation="portrait" position="float">
        <label>Fig. 7.</label>
        <caption>
          <p>Value added by CS in the ‘cold-start’ setting<bold>.</bold> AUC and AUPR scores shown in subfigures (<bold>A</bold>) and (<bold>B</bold>) represent the mean values obtained in five rounds of the 10-fold cross-validation on the set of ‘new’ drugs, those with all ADRs hidden (masked out). Subfigures (<bold>C</bold>) and (<bold>D</bold>) show the methods’ performances in CV segregated by ADRs (enrichment scores given in parentheses). STDERR values are too small to show</p>
        </caption>
        <graphic xlink:href="bty193f7"/>
      </fig>
      <p><xref ref-type="fig" rid="bty193-F7">Figure 7C and D</xref> show the methods performance in the CV segregated by ADRs using the AUC and AUPR measures, respectively. As seen in those figures, the accuracies of ML and CCA in predicting drugs associated with ‘new’ ADRs do not improve the accuracies of the random classifier.</p>
      <p>The results of the previously described MCC benchmark in ‘cold start’ setting are given in <xref ref-type="supplementary-material" rid="sup1">Supplementary Figure S3</xref>. As seen in this figure, the MCC scores achieved by CS range from &lt;0.1 to about 0.4. Nevertheless, CS outperforms ML and CCA, especially on rare ADRs.</p>
    </sec>
    <sec>
      <title>3.5 Predicting ADRs for chemicals with no known rare ADRs</title>
      <p><xref ref-type="fig" rid="bty193-F7">Figure 7</xref> shows that CS has advantage over the other methods when applied to chemicals with no known ADRs. Furthermore, <xref ref-type="fig" rid="bty193-F5">Figure 5</xref> suggests that such an advantage might sharply increase with the increasing number of ADRs discovered for the drug (right side of the <xref ref-type="fig" rid="bty193-F5">Fig. 5</xref> plots). To test this hypothesis, we removed and then tried to re-discover all associations between drugs and their severe, rare ADRs (those that have promiscuity below the specified cutoff). The results of our analysis are summarized in <xref ref-type="fig" rid="bty193-F8">Figure 8</xref>.
</p>
      <fig id="bty193-F8" orientation="portrait" position="float">
        <label>Fig. 8.</label>
        <caption>
          <p>Test for rare ADRs<bold>.</bold> The mean values obtained in five rounds of 10-fold CV test on the set of drugs with no known rare ADRs. STDERR is too small to show</p>
        </caption>
        <graphic xlink:href="bty193f8"/>
      </fig>
      <p>As seen in <xref ref-type="fig" rid="bty193-F8">Figure 8B</xref>, the AUPR fold enrichment achieved by CS is significant and, in case of very rare ADRs, about twice as large as the one obtained using the better of the two remaining methods. <xref ref-type="supplementary-material" rid="sup1">Supplementary Figure S4</xref> illustrates the results of the MCC benchmark in this setting.</p>
      <p>It should be noted that the benchmark presented in this section measures methods’ accuracy and reliability in predicting severe rare ADRs for a drug of interest, given that some (relatively mild) side-effects for the drug have already been observed. Unlike the other two methods, CS is capable of taking advantage of the information of other ADRs associated with a drug of interest. In practice, this means that the ability of CS to predict rare ADRs for a candidate chemical increases as the drug progresses through various stages of clinical trials. Moreover, the results of this benchmark suggest potential ability of CS to predict drug market withdrawal ahead of time.</p>
    </sec>
    <sec>
      <title>3.6 Predicting ADRs for chemicals of novel structure</title>
      <p>Finally, we used cross-validation to test the ability of our method to correctly predict side-effects of novel chemicals. For the purpose of this study, a chemical is considered to have a ‘novel’ structure if its Tanimoto similarity to each other database chemical is below the upfront specified cutoff.</p>
      <p>To perform cross-validation, the training set had to be altered by removing all chemicals (along with their ADR associations) that had above the threshold Tanimoto similarity to any chemical from the test set. This intervention rendered 10-fold cross-validation unfeasible, due to the training set in each fold being nearly or completely empty. Hence, in order to gain insight into methods’ performance in discovering rare ADRs for novel drugs, we resorted to LOOCV on the set of drugs. For each drug in the test set, we hide, and then try to recover, all rare ADRs (those of drug-promiscuity below the specified cutoff).</p>
      <p>The plot in <xref ref-type="fig" rid="bty193-F9">Figure 9</xref> shows a head-to-head comparison between CS, ML and CCA in recovering hidden ADRs associated with less than 25 drugs, using varying Tanimoto cutoffs for excluding ‘similar’ drugs from the training set. As seen in this figure, even if provided with a severely reducedtraining set (Tanimoto cutoff = 0.1), our algorithm exhibits accuracy superior to the accuracies of other state-of-the-art methods even in cases where the other methods are trained on comprehensive data sets (Tanimoto cutoff = 1.0). Additional data are presented in the table beneath the graph. Complete benchmarking results are given in the <xref ref-type="supplementary-material" rid="sup1">Supplementary Tables S1 and S2</xref>.
</p>
      <fig id="bty193-F9" orientation="portrait" position="float">
        <label>Fig. 9.</label>
        <caption>
          <p>LOOCV on chemicals of novel 3 D structure. Recorded are the mean values obtained in five rounds of the LOOCV test on the sets of 100 randomly chosen drugs. The top figure shows the AUC values obtained on ADRs associated with &lt;25 FDA approved drugs. The table beneath the figure shows the AUC values for selected Tanimoto and ADR promiscuity cutoff values. The fold enrichment is given in parentheses</p>
        </caption>
        <graphic xlink:href="bty193f9"/>
      </fig>
      <p>Using a subset of drugs (of the same size as the test set) from SIDER as ‘validation’ drugs, we derived the optimal cutoff score for each method and tested the method’s accuracy in a benchmark that uses MCC as the test measure The results are given in the <xref ref-type="supplementary-material" rid="sup1">Supplementary Table S3</xref>.</p>
    </sec>
    <sec>
      <title>3.7 Algorithm’s complexity</title>
      <p>The running time of our program is comparable to that of CCA but worse than the running time of ML. When tested on a 2.5 GHz Intel<sup>®</sup> Core i7 CPU with 16GB of RAM, the running times of the three algorithms in completing the SIDER matrix are as follows: CS 58 s, ML 2 s and CCA 93 s. It should be noted that the straightforward parallel implementation can make CS program practical, even for large-scale studies.</p>
    </sec>
  </sec>
  <sec>
    <title>4 Discussion</title>
    <p>ADRs play a major role in drug discovery and human health. Despite significant efforts made over the last decade, the progress in developing computational tools capable of predicting serious side-effects of novel chemicals and market drugs has been dismal at best. No current computational method is able to predict whether a novel and promising compound will eventually cause hepatotoxicity, carcinogenicity, cardiotoxicity, neurotoxicity, immune reaction thrombocytopenia, leukopenia, anaemia or any other harmful and potentially fatal ADRs. Moreover, advances in the area of drug-ADR association prediction are hindered by a lack of clean and comprehensive databases that store drug-ADR associations and by the difficulty of current methods to deal with noisy and sparse information.</p>
    <p>Using the ‘CS’ framework from the digital signal processing field, we developed a computational method that can reliably infer new chemical-ADR associations using existing noisy, biased and incomplete databases. Not only is our method able to detect rare ADRs associated with novel chemicals, but also our data demonstrate that the accuracy of CS in predicting a serious ADR for a candidate drug increases with increasing knowledge of other ADRs associated with the drug. In practice, this means that, as the candidate drug moves up the different stages of clinical trials, the prediction accuracy of our method will increase accordingly.</p>
    <p>CS represents an important first step in the development of a fully automated and accurate computational method for predicting serious ADRs. Ultimately, accurate and reliable prediction of ADRs will accelerate drug discovery and reduce the risks of drug treatment.</p>
    <p>The difficulty in identifying ADRs during clinical trials and the complexity of parsing side-effect data from drug package inserts and post-marketing reports gives rise to incomplete and noisy databases of drug-ADR associations. On the other hand, clean and comprehensive databases represent a straightforward way of improving the performance of prediction methods. For instance, we were able to increase the accuracy of our method in predicting drug-induced liver injury by replacing the hepatotoxicity associations stored in SIDER by those stored in LTKB-BD (<xref rid="bty193-B7" ref-type="bibr">Chen <italic>et al.</italic>, 2011</xref>). LTKB-BD represents an expert classification of only 287 drugs with respect to drug-induced liver injury.</p>
    <p>Aside from utilizing cleaner data, we believe that much more accurate predictions of drug-ADR associations can be made by taking advantage of gender-, age- and demographics-specific drug-ADR associations, drug-dose specific associations and data on side-effects arising from combination drugs (<xref rid="bty193-B24" ref-type="bibr">Tatonetti <italic>et al.</italic>, 2012</xref>).</p>
  </sec>
  <sec>
    <title>Funding</title>
    <p>This research was supported by the National Library of Medicine of the National Institute of Health under the award number [R01LM011986] (L.X.), the National Institute of General Medical Sciences of the National Institute of Health under the award number [R01GM122845] (L.X.), National Science Foundation under the award number [CNS-0958379, CNS-0855217, ACI-1126113], the City University of New York High Performance Computing Center at the College of Staten Island, and University of Northern Iowa Equipment Grant (A.P.).</p>
    <p><italic>Conflict of Interest</italic>: none declared.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material content-type="local-data" id="sup1">
      <label>Supplementary Data</label>
      <media xlink:href="bty193_supplementary_material.docx">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <ref-list>
    <title>References</title>
    <ref id="bty193-B1">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Bouvy</surname><given-names>J.C.</given-names></name></person-group><etal>et al</etal> (<year>2015</year>) 
<article-title>Epidemiology of adverse drug reactions in Europe: a review of recent observational studies</article-title>. <source>Drug Safety</source>, <volume>38</volume>, <fpage>437</fpage>–<lpage>453</lpage>.<pub-id pub-id-type="pmid">25822400</pub-id></mixed-citation>
    </ref>
    <ref id="bty193-B2">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Bresso</surname><given-names>E.</given-names></name></person-group><etal>et al</etal> (<year>2013</year>) 
<article-title>Integrative relational machine-learning approach for understanding drug side-effect profiles</article-title>. <source>BMC Bioinformatics</source>, <volume>14</volume>, <fpage>207.</fpage><pub-id pub-id-type="pmid">23802887</pub-id></mixed-citation>
    </ref>
    <ref id="bty193-B3">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Brown</surname><given-names>E.G.</given-names></name></person-group><etal>et al</etal> (<year>1999</year>) 
<article-title>The medical dictionary for regulatory activities (MedDRA)</article-title>. <source>Drug Safety</source>, <volume>20</volume>, <fpage>109</fpage>–<lpage>117</lpage>.<pub-id pub-id-type="pmid">10082069</pub-id></mixed-citation>
    </ref>
    <ref id="bty193-B4">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Budnitz</surname><given-names>D.S.</given-names></name></person-group><etal>et al</etal> (<year>2007</year>) 
<article-title>Medication use leading to emergency department visits for adverse drug events in older adults</article-title>. <source>Ann. Intern. Med</source>., <volume>147</volume>, <fpage>755</fpage>–<lpage>765</lpage>.<pub-id pub-id-type="pmid">18056659</pub-id></mixed-citation>
    </ref>
    <ref id="bty193-B5">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Candès</surname><given-names>E.J.</given-names></name></person-group> (<year>2006</year>) 
<article-title>Compressive sampling</article-title>. <source>ICM Proc</source>., <volume>3</volume>, <fpage>1433</fpage>–<lpage>1452</lpage>.</mixed-citation>
    </ref>
    <ref id="bty193-B6">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Candès</surname><given-names>E.J.</given-names></name></person-group><etal>et al</etal> (<year>2006</year>) 
<article-title>Stable signal recovery from incomplete and inaccurate measurements</article-title>. <source>Commun. Pure Appl. Math</source>., <volume>59</volume>, <fpage>1207</fpage>–<lpage>1223</lpage>.</mixed-citation>
    </ref>
    <ref id="bty193-B7">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Chen</surname><given-names>M.</given-names></name></person-group><etal>et al</etal> (<year>2011</year>) 
<article-title>FDA-approved drug labeling for the study of drug-induced liver injury</article-title>. <source>Drug Discov. Today</source>, <volume>16</volume>, <fpage>697</fpage>–<lpage>703</lpage>.<pub-id pub-id-type="pmid">21624500</pub-id></mixed-citation>
    </ref>
    <ref id="bty193-B8">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Donoho</surname><given-names>D.L.</given-names></name></person-group> (<year>2006</year>) 
<article-title>Compressed sensing</article-title>. <source>IEEE Trans. Inf. Theor</source>., <volume>52</volume>, <fpage>1289</fpage>–<lpage>1306</lpage>.</mixed-citation>
    </ref>
    <ref id="bty193-B9">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Duchi</surname><given-names>J.</given-names></name></person-group><etal>et al</etal> (<year>2011</year>) 
<article-title>Adaptive subgradient methods for online learning and stochastic optimization</article-title>. <source>J. Mach. Learn. Res</source>., <volume>12</volume>, <fpage>2121</fpage>–<lpage>2159</lpage>.</mixed-citation>
    </ref>
    <ref id="bty193-B10">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Huang</surname><given-names>L.C.</given-names></name></person-group><etal>et al</etal> (<year>2013</year>) 
<article-title>Predicting adverse drug reaction profiles by integrating protein interaction networks with drug structures</article-title>. <source>Proteomics</source>, <volume>13</volume>, <fpage>313</fpage>–<lpage>324</lpage>.<pub-id pub-id-type="pmid">23184540</pub-id></mixed-citation>
    </ref>
    <ref id="bty193-B11">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Impicciatore</surname><given-names>P.</given-names></name></person-group><etal>et al</etal> (<year>2001</year>) 
<article-title>Incidence of adverse drug reactions in paediatric in/out‐patients: a systematic review and meta‐analysis of prospective studies</article-title>. <source>Br. J. Clin. Pharmacol</source>., <volume>52</volume>, <fpage>77</fpage>–<lpage>83</lpage>.<pub-id pub-id-type="pmid">11453893</pub-id></mixed-citation>
    </ref>
    <ref id="bty193-B12">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Kuhn</surname><given-names>M.</given-names></name></person-group><etal>et al</etal> (<year>2010</year>) 
<article-title>A side effect resource to capture phenotypic effects of drugs</article-title>. <source>Mol. Syst. Biol</source>., <volume>6</volume>, <fpage>343.</fpage><pub-id pub-id-type="pmid">20087340</pub-id></mixed-citation>
    </ref>
    <ref id="bty193-B13">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Lazarou</surname><given-names>J.</given-names></name></person-group><etal>et al</etal> (<year>1998</year>) 
<article-title>Incidence of adverse drug reactions in hospitalized patients: a meta-analysis of prospective studies</article-title>. <source>JAMA</source>, <volume>279</volume>, <fpage>1200</fpage>–<lpage>1205</lpage>.<pub-id pub-id-type="pmid">9555760</pub-id></mixed-citation>
    </ref>
    <ref id="bty193-B14">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Li</surname><given-names>Q.</given-names></name></person-group><etal>et al</etal> (<year>2010</year>) 
<article-title>PubChem as a public resource for drug discovery</article-title>. <source>Drug Discov. Today</source>, <volume>15</volume>, <fpage>1052</fpage>–<lpage>1057</lpage>.<pub-id pub-id-type="pmid">20970519</pub-id></mixed-citation>
    </ref>
    <ref id="bty193-B15">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Lim</surname><given-names>H.</given-names></name></person-group><etal>et al</etal> (<year>2016</year>) 
<article-title>Improved genome-scale multi-target virtual screening via a novel collaborative filtering approach to cold-start problem</article-title>. <source>Sci. Rep</source>., <volume>6</volume>, <fpage>38860</fpage>.<pub-id pub-id-type="pmid">27958331</pub-id></mixed-citation>
    </ref>
    <ref id="bty193-B16">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Liu</surname><given-names>M.</given-names></name></person-group><etal>et al</etal> (<year>2012</year>) 
<article-title>Large-scale prediction of adverse drug reactions using chemical, biological, and phenotypic properties of drugs</article-title>. <source>J. Am. Med. Inform. Assoc</source>., <volume>19</volume>, <fpage>e28</fpage>–<lpage>e35</lpage>.<pub-id pub-id-type="pmid">22718037</pub-id></mixed-citation>
    </ref>
    <ref id="bty193-B17">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Matthews</surname><given-names>B.W.</given-names></name></person-group> (<year>1975</year>) 
<article-title>Comparison of the predicted and observed secondary structure of T4 phage lysozyme</article-title>. <source>Biochim Biophys Acta</source>, <volume>405</volume>, <fpage>442</fpage>–<lpage>451</lpage>.<pub-id pub-id-type="pmid">1180967</pub-id></mixed-citation>
    </ref>
    <ref id="bty193-B18">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><name name-style="western"><surname>McInnes</surname><given-names>B.T.</given-names></name></person-group><etal>et al</etal> (<year>2009</year>) UMLS-Interface and UMLS-Similarity: open source software for measuring paths and semantic similarity. In <italic>AMIA Annual Symposium Proceedings</italic>, Vol. 2009, American Medical Informatics Association, p. 431.</mixed-citation>
    </ref>
    <ref id="bty193-B19">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Mizutani</surname><given-names>S.</given-names></name></person-group><etal>et al</etal> (<year>2012</year>) 
<article-title>Relating drug–protein interaction network with drug side effects</article-title>. <source>Bioinformatics</source>, <volume>28</volume>, <fpage>i522</fpage>–<lpage>i528</lpage>.<pub-id pub-id-type="pmid">22962476</pub-id></mixed-citation>
    </ref>
    <ref id="bty193-B20">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Onakpoya</surname><given-names>I.J.</given-names></name></person-group><etal>et al</etal> (<year>2016</year>) 
<article-title>Post-marketing withdrawal of 462 medicinal products because of adverse drug reactions: a systematic review of the world literature</article-title>. <source>BMC Med</source>., <volume>14</volume>, <fpage>10</fpage>.<pub-id pub-id-type="pmid">26843061</pub-id></mixed-citation>
    </ref>
    <ref id="bty193-B21">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Pauwels</surname><given-names>E.</given-names></name></person-group><etal>et al</etal> (<year>2011</year>) 
<article-title>Predicting drug side-effect profiles: a chemical fragment-based approach</article-title>. <source>BMC Bioinformatics</source>, <volume>12</volume>, <fpage>169</fpage>.<pub-id pub-id-type="pmid">21586169</pub-id></mixed-citation>
    </ref>
    <ref id="bty193-B22">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Rogers</surname><given-names>D.J.</given-names></name>, <name name-style="western"><surname>Tanimoto</surname><given-names>T.T.</given-names></name></person-group> (<year>1960</year>) 
<article-title>A computer program for classifying plants</article-title>. <source>Science</source>, <volume>132</volume>, <fpage>1115</fpage>–<lpage>1118</lpage>.<pub-id pub-id-type="pmid">17790723</pub-id></mixed-citation>
    </ref>
    <ref id="bty193-B23">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Sultana</surname><given-names>J.</given-names></name></person-group><etal>et al</etal> (<year>2013</year>) 
<article-title>Clinical and economic burden of adverse drug reactions</article-title>. <source>J. Pharmacol. Pharmacother</source>., <volume>4</volume>, <fpage>73.</fpage></mixed-citation>
    </ref>
    <ref id="bty193-B24">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Tatonetti</surname><given-names>N.P.</given-names></name></person-group><etal>et al</etal> (<year>2012</year>) 
<article-title>Data-driven prediction of drug effects and interactions</article-title>. <source>Sci. Transl. Med</source>., <volume>4</volume>, <fpage>125ra31.</fpage></mixed-citation>
    </ref>
    <ref id="bty193-B25">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Wester</surname><given-names>K.</given-names></name></person-group><etal>et al</etal> (<year>2008</year>) 
<article-title>Incidence of fatal adverse drug reactions: a population based study</article-title>. <source>Br. J. Clin. Pharmacol</source>., <volume>65</volume>, <fpage>573</fpage>–<lpage>579</lpage>.<pub-id pub-id-type="pmid">18070216</pub-id></mixed-citation>
    </ref>
    <ref id="bty193-B26">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Witten</surname><given-names>D.M.</given-names></name></person-group><etal>et al</etal> (<year>2009</year>) 
<article-title>A penalized matrix decomposition, with applications to sparse principal components and canonical correlation analysis</article-title>. <source>Biostatistics</source>, <volume>10</volume>, <fpage>515</fpage>–<lpage>534</lpage>.<pub-id pub-id-type="pmid">19377034</pub-id></mixed-citation>
    </ref>
    <ref id="bty193-B27">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><name name-style="western"><surname>Xiao</surname><given-names>C.</given-names></name></person-group><etal>et al</etal> (<year>2017</year>) Adverse drug reaction prediction with symbolic latent Dirichlet allocation. In <italic>Proceedings of the AAAI</italic> 2017, pp. <fpage>1590</fpage>–<lpage>1596</lpage>.</mixed-citation>
    </ref>
    <ref id="bty193-B28">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Zhang</surname><given-names>W.</given-names></name></person-group><etal>et al</etal> (<year>2015</year>) 
<article-title>Predicting drug side effects by multi-label learning and ensemble learning</article-title>. <source>BMC Bioinformatics</source>, <volume>16</volume>, <fpage>365</fpage>.<pub-id pub-id-type="pmid">26537615</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
