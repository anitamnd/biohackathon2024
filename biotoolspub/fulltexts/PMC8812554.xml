<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.1 20151215//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.1?>
<?ConverterInfo.XSLTName jats2jats3.xsl?>
<?ConverterInfo.Version 1?>
<?properties open_access?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Proc Natl Acad Sci U S A</journal-id>
    <journal-id journal-id-type="iso-abbrev">Proc Natl Acad Sci U S A</journal-id>
    <journal-id journal-id-type="hwp">pnas</journal-id>
    <journal-id journal-id-type="publisher-id">PNAS</journal-id>
    <journal-title-group>
      <journal-title>Proceedings of the National Academy of Sciences of the United States of America</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">0027-8424</issn>
    <issn pub-type="epub">1091-6490</issn>
    <publisher>
      <publisher-name>National Academy of Sciences</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">8812554</article-id>
    <article-id pub-id-type="pmid">35086932</article-id>
    <article-id pub-id-type="publisher-id">202119767</article-id>
    <article-id pub-id-type="doi">10.1073/pnas.2119767119</article-id>
    <article-categories>
      <subj-group subj-group-type="hwp-journal-coll">
        <subject>408</subject>
      </subj-group>
      <subj-group subj-group-type="heading">
        <subject>Biological Sciences</subject>
        <subj-group>
          <subject>Biophysics and Computational Biology</subject>
        </subj-group>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>LINEAGE: Label-free identification of endogenous informative single-cell mitochondrial RNA mutation for lineage analysis</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0001-8705-8472</contrib-id>
        <name>
          <surname>Lin</surname>
          <given-names>Li</given-names>
        </name>
        <xref rid="aff1" ref-type="aff">
          <sup>a</sup>
        </xref>
        <xref rid="fn5" ref-type="author-notes">
          <sup>1</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Zhang</surname>
          <given-names>Yufeng</given-names>
        </name>
        <xref rid="aff2" ref-type="aff">
          <sup>b</sup>
        </xref>
        <xref rid="fn5" ref-type="author-notes">
          <sup>1</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0003-3884-7920</contrib-id>
        <name>
          <surname>Qian</surname>
          <given-names>Weizhou</given-names>
        </name>
        <xref rid="aff1" ref-type="aff">
          <sup>a</sup>
        </xref>
        <xref rid="fn5" ref-type="author-notes">
          <sup>1</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Liu</surname>
          <given-names>Yao</given-names>
        </name>
        <xref rid="aff3" ref-type="aff">
          <sup>c</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0001-5707-2863</contrib-id>
        <name>
          <surname>Zhang</surname>
          <given-names>Yingkun</given-names>
        </name>
        <xref rid="aff1" ref-type="aff">
          <sup>a</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Lin</surname>
          <given-names>Fanghe</given-names>
        </name>
        <xref rid="aff1" ref-type="aff">
          <sup>a</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Liu</surname>
          <given-names>Cenxi</given-names>
        </name>
        <xref rid="aff2" ref-type="aff">
          <sup>b</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Lu</surname>
          <given-names>Guangxing</given-names>
        </name>
        <xref rid="aff2" ref-type="aff">
          <sup>b</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Sun</surname>
          <given-names>Di</given-names>
        </name>
        <xref rid="aff4" ref-type="aff">
          <sup>d</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Guo</surname>
          <given-names>Xiaoxu</given-names>
        </name>
        <xref rid="aff1" ref-type="aff">
          <sup>a</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0002-6793-6685</contrib-id>
        <name>
          <surname>Song</surname>
          <given-names>YanLing</given-names>
        </name>
        <xref rid="aff1" ref-type="aff">
          <sup>a</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Song</surname>
          <given-names>Jia</given-names>
        </name>
        <xref rid="aff4" ref-type="aff">
          <sup>d</sup>
        </xref>
        <xref rid="cor1" ref-type="corresp">
          <sup>2</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0002-2374-5342</contrib-id>
        <name>
          <surname>Yang</surname>
          <given-names>Chaoyong</given-names>
        </name>
        <xref rid="aff1" ref-type="aff">
          <sup>a</sup>
        </xref>
        <xref rid="aff4" ref-type="aff">
          <sup>d</sup>
        </xref>
        <xref rid="cor1" ref-type="corresp">
          <sup>2</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0002-7957-1476</contrib-id>
        <name>
          <surname>Li</surname>
          <given-names>Jin</given-names>
        </name>
        <xref rid="aff2" ref-type="aff">
          <sup>b</sup>
        </xref>
        <xref rid="aff5" ref-type="aff">
          <sup>e</sup>
        </xref>
        <xref rid="cor1" ref-type="corresp">
          <sup>2</sup>
        </xref>
      </contrib>
      <aff id="aff1"><sup>a</sup>State Key Laboratory for Physical Chemistry of Solid Surfaces, Key Laboratory for Chemical Biology of Fujian Province, Key Laboratory of Analytical Chemistry, and Department of Chemical Biology, College of Chemistry and Chemical Engineering, <institution>Xiamen University</institution>, Xiamen 361005, <country>People’s Republic of China</country>;</aff>
      <aff id="aff2"><sup>b</sup>State Key Laboratory of Genetic Engineering and School of Life Sciences, <institution>Fudan University</institution>, Shanghai 200433, <country>China</country>;</aff>
      <aff id="aff3"><sup>c</sup>Department of Endocrinology and Metabolism, Shanghai Tenth People’s Hospital, School of Medicine, <institution>Tongji University</institution>, Shanghai 200072, <country>China</country>;</aff>
      <aff id="aff4"><sup>d</sup>Institute of Molecular Medicine, Renji Hospital, School of Medicine, <institution>Shanghai Jiao Tong University</institution>, Shanghai 200127, <country>China</country>;</aff>
      <aff id="aff5"><sup>e</sup>Institute of Cell Biology and Biophysics, <institution>Leibniz University Hannover</institution>, Hanover 30167, <country>Germany</country></aff>
    </contrib-group>
    <author-notes>
      <corresp id="cor1"><sup>2</sup>To whom correspondence may be addressed. Email: <email>li_jin_lifescience@fudan.edu.cn</email>, <email>songjiajia2010@shsmu.edu.cn</email>, or <email>cyyang@xmu.edu.cn</email>.</corresp>
      <fn id="fn1" fn-type="edited-by">
        <p>Edited by David Weitz, Department of Physics, Division of Engineering and Applied Science, Harvard University, Cambridge, MA; received November 3, 2021; accepted December 20, 2021</p>
      </fn>
      <fn id="fn2" fn-type="con">
        <p>Author contributions: L.L., Yufeng Zhang, W.Q., J.S., C.Y., and J.L. designed research; L.L., Yufeng Zhang, W.Q., Y.L., Yingkun Zhang., F.L., C.L., G.L., D.S., X.G., Y.S., J.S., C.Y., and J.L. performed research; L.L., Yufeng Zhang, W.Q., J.S., C.Y., and J.L. analyzed data; and L.L., Yufeng Zhang, W.Q., Y.L., Yingkun Zhang, F.L., C.L., G.L., D.S., X.G., Y.S., J.S., C.Y., and J.L. wrote the paper.</p>
      </fn>
      <fn id="fn5" fn-type="equal">
        <p><sup>1</sup>L.L., Yufeng Zhang, and W.Q. contributed equally to this work.</p>
      </fn>
    </author-notes>
    <pub-date pub-type="epub">
      <day>27</day>
      <month>1</month>
      <year>2022</year>
    </pub-date>
    <pub-date pub-type="ppub">
      <day>1</day>
      <month>2</month>
      <year>2022</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>27</day>
      <month>1</month>
      <year>2022</year>
    </pub-date>
    <volume>119</volume>
    <issue>5</issue>
    <elocation-id>e2119767119</elocation-id>
    <history>
      <date date-type="accepted">
        <day>20</day>
        <month>12</month>
        <year>2021</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>Copyright © 2022 the Author(s). Published by PNAS.</copyright-statement>
      <copyright-year>2022</copyright-year>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbyncndlicense">https://creativecommons.org/licenses/by-nc-nd/4.0/</ali:license_ref>
        <license-p>This article is distributed under <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by-nc-nd/4.0/">Creative Commons Attribution-NonCommercial-NoDerivatives License 4.0 (CC BY-NC-ND)</ext-link>.</license-p>
      </license>
    </permissions>
    <self-uri content-type="pdf" xlink:href="pnas.202119767.pdf"/>
    <abstract abstract-type="executive-summary">
      <title>Significance</title>
      <p>Lineage analysis is an important assay for developmental biology, cancer biology, etc. Traditional tools in this field are time consuming, technically challenging, and in demand of preexisting knowledge. By integrating exogenous barcodes into cells, single-cell RNA-sequencing (scRNA-seq) can be used to conduct such tasks, but these assays required significant expertise in both wet- and dry-laboratory experiments. We developed a user-friendly algorithm to conduct cell-lineage inference solely based on endogenous markers of label-free scRNA-seq. This algorithm is able to identify lineage-informative mutations from a bunch of interfering mitochondrial RNA variants with high accuracy and efficiency. With this algorithm, we removed most of the technical hurdles of lineage analysis on scRNA-seq and will dramatically accelerate its application in biological research.</p>
    </abstract>
    <abstract>
      <p>Single-cell RNA-sequencing (scRNA-seq) has become a powerful tool for biomedical research by providing a variety of valuable information with the advancement of computational tools. Lineage analysis based on scRNA-seq provides key insights into the fate of individual cells in various systems. However, such analysis is limited by several technical challenges. On top of the considerable computational expertise and resources, these analyses also require specific types of matching data such as exogenous barcode information or bulk assay for transposase-accessible chromatin with high throughput sequencing (ATAC-seq) data. To overcome these technical challenges, we developed a user-friendly computational algorithm called “LINEAGE” (label-free identification of endogenous informative single-cell mitochondrial RNA mutation for lineage analysis). Aiming to screen out endogenous markers of lineage located on mitochondrial reads from label-free scRNA-seq data to conduct lineage inference, LINEAGE integrates a marker selection strategy by feature subspace separation and de novo “low cross-entropy subspaces” identification. In this process, the mutation type and subspace–subspace “cross-entropy” of features were both taken into consideration. LINEAGE outperformed three other methods, which were designed for similar tasks as testified with two standard datasets in terms of biological accuracy and computational efficiency. Applied on a label-free scRNA-seq dataset of BRAF-mutated cancer cells, LINEAGE also revealed genes that contribute to BRAF inhibitor resistance. LINEAGE removes most of the technical hurdles of lineage analysis, which will remarkably accelerate the discovery of the important genes or cell-lineage clusters from scRNA-seq data.</p>
    </abstract>
    <kwd-group>
      <kwd>single-cell RNA-seq</kwd>
      <kwd>lineage analysis</kwd>
      <kwd>BRAF inhibitor resistance</kwd>
    </kwd-group>
    <counts>
      <page-count count="8"/>
    </counts>
  </article-meta>
</front>
<body>
  <p content-type="flushleft">Lineage analysis is an important assay for developmental biology, cancer biology, etc. Classical lineage analysis in developmental biology study is hypothesis driven and relies on the “pulse-chase” model with an inducible Cre-LoxP system (<xref rid="r1" ref-type="bibr">1</xref>, <xref rid="r2" ref-type="bibr">2</xref>). This system labels the progenitors permanently so the source of a mature cell type can be identified via lineage tracing. Lineage analysis also can be used to identify the genes correlated to the clonal evolution of cancer cells upon treatment, which can be done on either primary cancer samples or cancer cell lines based on the somatic mutations. Traditionally, lineage analysis is time consuming, technically challenging, and in demand of much preexisting knowledge. A tool is desired to simplify the lineage analysis on complex tissues.</p>
  <p>Single-cell RNA-sequencing (scRNA-seq) has become a powerful tool for biomedical research (<xref rid="r3" ref-type="bibr">3</xref><xref rid="r4" ref-type="bibr"/><xref rid="r5" ref-type="bibr"/>–<xref rid="r6" ref-type="bibr">6</xref>). Initially employed as an assay to identify clusters of cells with distinct transcriptomic features, scRNA-seq data now can provide additional information with the advancement of computational tools (<xref rid="r7" ref-type="bibr">7</xref><xref rid="r8" ref-type="bibr"/><xref rid="r9" ref-type="bibr"/>–<xref rid="r10" ref-type="bibr">10</xref>). Because scRNA-seq can profile many cell types simultaneously, potentially, it is a useful tool for lineage analysis. However, this application normally relies on exogenous barcodes created by transforming barcode libraries (<xref rid="r11" ref-type="bibr">11</xref>) or Cas9-based genome-editing tools (<xref rid="r12" ref-type="bibr">12</xref>). These cellular barcodes therefore are used as reference for clonal clustering. Regardless of the complexity of performing such experiments, it is impossible to directly analyze the lineage information of clinical samples with this strategy. We therefore aim to simplify the lineage analysis by developing a user-friendly computational algorithm based on endogenous markers of scRNA-seq data.</p>
  <p>The whole-genome RNA single nucleotide polymorphisms (SNP) has been used as endogenous markers for lineage study (<xref rid="r13" ref-type="bibr">13</xref>), though the requirement of high sequencing coverage limits its application. In comparison, the size of mitochondrial genome is relatively small. Thus, mitochondrial RNA variant is a great resource as endogenous makers. We have shown that it is possible to perform lineage analysis with mitochondrial RNA variants based on scRNA-seq data on human islet (<xref rid="r14" ref-type="bibr">14</xref>). Unfortunately, the challenge for lineage analysis with mitochondrial RNA variants is to identify the informative variants (mutations) for following inference, without knowing the features of clones in the cells. Ludwig et al. (<xref rid="r15" ref-type="bibr">15</xref>) tried to solve this problem by analyzing bulk assay for transposase-accessible chromatin with high throughput sequencing (ATAC-seq) data, which can provide reliable and informative mitochondria genome variants as reference, from the same sample at first. Clustering is then performed on scRNA-seq data based on these variants identified from the bulk ATAC-seq data. The requirement of parallel bulk ATAC-seq obviously limits the application of this strategy. A tool solely based on scRNA-seq is more desirable.</p>
  <p>The bottleneck of performing de novo and label-free lineage analysis solely based on scRNA-seq is to identify the informative variants for clones, so called clonal features, without preexisting knowledge. The clonal features are rather sparse and more sensitive to sequencing error and coverages in comparison to expression features. Due to their unique properties, the clonal features cannot be identified with the similar strategies as expression features of scRNA-seq data.</p>
  <p>Thus, we developed an algorithm to call the clonal features efficiently based on “low cross-entropy subspace” separation and identification. Instead of using whole-genome SNPs as endogenous markers (<xref rid="r13" ref-type="bibr">13</xref>), we employed the mitochondrial RNA SNP for the analysis to avoid the limitation of sequencing coverage. The initial feature calling still showed an unignorable level of noise, due to sequencing errors and low coverage. We therefore improved the feature-selection process by integrating mutation type and subspace–subspace cross-entropy into consideration. Cross-entropy is a loss function that can be used to quantify the difference between two probability distributions (<xref rid="r16" ref-type="bibr">16</xref>). Based on this concept from information theory, we defined a ‘cross-entropy’ measure to quantify the difference of the embedded cluster structures among subspaces. The “low cross-entropy subspaces” discovered in this strategy could well capture lineage information from scRNA-seq. Meanwhile, we also integrated an optimized consensus-clustering process with a refinement step to further fully capture and refine the lineage structure from the “low cross-entropy subspaces.”</p>
  <p>This computational algorithm, called label-free identification of endogenous informative single-ccll mitochondrial RNA mutation for lineage analysis (LINEAGE), is one for de novo label-free lineage analysis of scRNA-seq based on endogenous lineage markers selection. We applied LINEAGE on a label-free BRAF inhibitor resistance study to identify and validate the genes associated to the resistance in melanoma. We expect the application of LINEAGE to dramatically accelerate lineage analysis–related studies.</p>
  <sec sec-type="results" id="s1">
    <title>Results</title>
    <sec id="s2">
      <title>Working Principle of the Lineage Analysis in LINEAGE.</title>
      <p>Full-length scRNA-seq data generated by Smart-seq2 (<xref rid="r17" ref-type="bibr">17</xref>) protocol was used for lineage analysis. The mitochondrial RNA variants were called and the allele frequency (AF<sub>x,b</sub>) was calculated to produce the variants frequency matrix (<xref rid="fig01" ref-type="fig">Fig. 1<italic toggle="yes">A</italic>;</xref> our preprocessing codes can be downloaded at <ext-link xlink:href="https://github.com/songjiajia2018/ppl" ext-link-type="uri">https://github.com/songjiajia2018/ppl</ext-link>).</p>
      <fig position="float" id="fig01" fig-type="figure">
        <label>Fig. 1.</label>
        <caption>
          <p>A schematic representation of LINEAGE. (<italic toggle="yes">A</italic>) The whole analysis process of LINEAGE. Using full-length scRNA-seq dataset as input, mitochondrial RNA variants are called and the variant-frequency matrix is generated for lineage inference. (<italic toggle="yes">B</italic>) Feature selection. LINEAGE firstly screens highly variable variants across cells with different mutation types and then separates the merged highly variable variant-frequency matrix into subspaces according to their dynamic frequency patterns across cells. Subspace–subspace cross-entropy calculation is then conducted based on ARI calculation among clusters from different subspaces to find out the “low cross-entropy subspaces,” which show higher consensus among subspaces than other subspaces. (<italic toggle="yes">C</italic>) Consensus clustering. LINEAGE learns a strong, informative similarity matrix by using similarity and cell group information from selected low–cross-entropy subspaces. LINEAGE then applies the learned similarity for initial cell-clustering and group marker identification. The group markers are then used as lineage-related mutations to refine the inference.</p>
        </caption>
        <graphic xlink:href="pnas.2119767119fig01" position="float"/>
      </fig>
      <p>Due to its nature, variant frequency has many more noises than gene expression. These noises may come from many aspects of data including sequencing errors and low coverage. Therefore, variant-related analysis (<xref rid="r18" ref-type="bibr">18</xref><xref rid="r19" ref-type="bibr"/><xref rid="r20" ref-type="bibr"/><xref rid="r21" ref-type="bibr"/>–<xref rid="r22" ref-type="bibr">22</xref>) normally needs bulk sequencing data with high coverage. However, scRNA-seq data are highly sparse, which makes it difficult to do feature selection. Here, we performed feature selection on the variant frequency from cells containing distinct clones with Seruat version 3.0/version 4.0 (<xref rid="r8" ref-type="bibr">8</xref>, <xref rid="r23" ref-type="bibr">23</xref>) and Entropy subspace separation-based clustering for noise reduction (ENCORE). Unfortunately, neither of these computational algorithms managed to identify features with clonal information (<ext-link xlink:href="https://www.pnas.org/lookup/suppl/doi:10.1073/pnas.2119767119/-/DCSupplemental" ext-link-type="uri" xlink:show="new"><italic toggle="yes">SI Appendix</italic>, Fig. S1</ext-link>). These results suggested that traditional feature-selection strategies, which were designed for screening expression features, need to be revised for the analysis of variants frequency.</p>
      <p>To address this point, LINEAGE (<ext-link xlink:href="https://github.com/songjiajia2018/LINEAGE" ext-link-type="uri">https://github.com/songjiajia2018/LINEAGE</ext-link>) developed a feature-selection strategy to efficiently pick out lineage-informative variants (defined as clonal features) from scRNA-seq datasets. Firstly, the variant-frequency matrix is separated into 12 submatrices according to the mutation types, and highly variable sites are discovered in each submatrix. A merged-frequency matrix with 12*20 highly variable variants is generated. This process guarantees that the initial selected highly variable features contain variants with different mutation types. So, the downstream analysis may avoid being misled by mutational type–specific systemic noises such as sequencing errors. Then, we applied the same hypothesis as ENCORE that features with similar dynamic pattern tend to capture similar cell cluster structures. Thus, subspace separation was performed on the merged matrix to generate 20 subspaces based on the dynamic patterns of variants frequency. In this way, variants with similar frequency dynamic patterns would be clustered into the same subspace, and cluster signals resulted from different events (noise, lineage, or other events) tend to be clearly separated. Then to find out informative feature subspaces for lineage inference, LINEAGE used a method to define the “cross-entropy” among subspaces and pick out “low cross-entropy subspaces” as informative subspaces. In detail, the consensus status among subspaces is indicated by “cross-entropy,” which is defined based on the adjusted rand index (ARI, detailed in <ext-link xlink:href="https://www.pnas.org/lookup/suppl/doi:10.1073/pnas.2119767119/-/DCSupplemental" ext-link-type="uri" xlink:show="new"><italic toggle="yes">SI Appendix</italic>, Supplementary Note 1</ext-link>). This is based on the hypothesis that cluster structures with more consensus information among subspaces are more likely generated by informative events as lineage structures. By default, six subspaces with lowest cross-entropy among subspaces are selected for downstream analysis (<xref rid="s6" ref-type="sec"><italic toggle="yes">Materials and Methods</italic></xref> and <xref rid="fig01" ref-type="fig">Fig. 1<italic toggle="yes">B</italic></xref>).</p>
      <p>Then LINEAGE performed consensus clustering to get the initial clusters with clonal information based on these “low cross-entropy subspaces.” Candidate endogenous markers were subsequently identified for each candidate cluster. To improve the accuracy, LINEAGE applied a refinement process by refining the distance between cells based on these marker variants (<xref rid="fig01" ref-type="fig">Fig. 1<italic toggle="yes">C</italic></xref>). The final result of clonal identification was presented as t-distributed stochastic neighbor embedding (t-SNE)/Uniform Manifold Approximation and Projection (UMAP) plot as well as heatmap. The details of variant-frequency matrix generation, subspace separation, low cross-entropy subspace selection, and consensus clustering are described in <xref rid="s6" ref-type="sec"><italic toggle="yes">Materials and Methods</italic></xref>.</p>
    </sec>
    <sec id="s3">
      <title>LINEAGE Identified Clones from ScRNA-Seq Data in a De Novo and Label-Free Fashion.</title>
      <p>We firstly tested LINEAGE on a simulated dataset, which consists of two human melanoma cell lines, A375 and 451Lu (<xref rid="r24" ref-type="bibr">24</xref>) (dataset description is detailed in <ext-link xlink:href="https://www.pnas.org/lookup/suppl/doi:10.1073/pnas.2119767119/-/DCSupplemental" ext-link-type="uri" xlink:show="new"><italic toggle="yes">SI Appendix</italic>, Table S1</ext-link>). LINEAGE can separate the cells from different cell lines accurately (<ext-link xlink:href="https://www.pnas.org/lookup/suppl/doi:10.1073/pnas.2119767119/-/DCSupplemental" ext-link-type="uri" xlink:show="new"><italic toggle="yes">SI Appendix</italic>, Fig. S2 <italic toggle="yes">A</italic> and <italic toggle="yes">B</italic></ext-link>). To further test the performance of LINEAGE on datasets with cells from close lineages, we tested LINEAGE on a scRNA-seq dataset (named as TF1 clones) containing 70 cells with exogenous barcoding from three clones and a more-complicated scRNA-seq dataset (named as TF1 barcoding) containing 158 cells with exogenous barcoding from 11 clones (<xref rid="r15" ref-type="bibr">15</xref>) (dataset description is detailed in <ext-link xlink:href="https://www.pnas.org/lookup/suppl/doi:10.1073/pnas.2119767119/-/DCSupplemental" ext-link-type="uri" xlink:show="new"><italic toggle="yes">SI Appendix</italic>, Table S1</ext-link>). In both cases, data from six subspaces were selected. We found that the lineage information of different clones was captured in different subspaces (<xref rid="fig02" ref-type="fig">Fig. 2</xref>). In comparison, the unselected subspaces (high–cross-entropy subspaces) showed little lineage structure (<ext-link xlink:href="https://www.pnas.org/lookup/suppl/doi:10.1073/pnas.2119767119/-/DCSupplemental" ext-link-type="uri" xlink:show="new"><italic toggle="yes">SI Appendix</italic>, Fig. S3</ext-link>).</p>
      <fig position="float" id="fig02" fig-type="figure">
        <label>Fig. 2.</label>
        <caption>
          <p>Low–cross-entropy subspaces selected by LINEAGE. (<italic toggle="yes">A</italic>) Low–cross-entropy subspaces of a scRNA-seq dataset (TF1 clones) containing 70 cells with exogenous barcoding from three clones. The different clones are labeled in different colors. The distinctive clone groups in the subspaces are circled in red. (<italic toggle="yes">B</italic>) Low–cross-entropy subspaces of a scRNA-seq dataset (TF1 barcoding) containing 158 cells with exogenous barcoding from 11 clones. The different clones are labeled in different colors. The distinctive clone groups in the subspaces are circled in red.</p>
        </caption>
        <graphic xlink:href="pnas.2119767119fig02" position="float"/>
      </fig>
      <p>The capability of accurate lineage inference was compared among LINEAGE and three other methods, including Ludwig et al. (<xref rid="r15" ref-type="bibr">15</xref>) (mitochondrial SNPs from both bulk ATAC-seq + scRNA-seq), trajectory inference based on SNP information (TBSP) (<xref rid="r13" ref-type="bibr">13</xref>) (whole-genome RNA SNPs + expression), and Seurat version 3 (<xref rid="r23" ref-type="bibr">23</xref>) (gene expression). In the dataset containing 70 cells/three clones, LINEAGE outperformed the other methods as correctly sorting all the cells into corresponding clones (<xref rid="fig03" ref-type="fig">Fig. 3<italic toggle="yes">A</italic></xref> and <ext-link xlink:href="https://www.pnas.org/lookup/suppl/doi:10.1073/pnas.2119767119/-/DCSupplemental" ext-link-type="uri" xlink:show="new"><italic toggle="yes">SI Appendix</italic>, Fig. S4<italic toggle="yes">A</italic></ext-link>). For the dataset containing 158 cells/11 clones, LINEAGE identified clones with comparable accuracy as Ludwig et al. (<xref rid="r15" ref-type="bibr">15</xref>) and much-higher accuracy than the other two methods (<xref rid="fig03" ref-type="fig">Fig. 3<italic toggle="yes">B</italic></xref> and <ext-link xlink:href="https://www.pnas.org/lookup/suppl/doi:10.1073/pnas.2119767119/-/DCSupplemental" ext-link-type="uri" xlink:show="new"><italic toggle="yes">SI Appendix</italic>, Fig. S4<italic toggle="yes">B</italic></ext-link>). Especially, there is a large overlap of the markers selected by Ludwig et al. (<xref rid="r15" ref-type="bibr">15</xref>) and LINEAGE (<ext-link xlink:href="https://www.pnas.org/lookup/suppl/doi:10.1073/pnas.2119767119/-/DCSupplemental" ext-link-type="uri" xlink:show="new"><italic toggle="yes">SI Appendix</italic>, Fig. S5 and Table S2</ext-link>), although LINEAGE does not require high-depth bulk ATAC-seq data from same samples.</p>
      <fig position="float" id="fig03" fig-type="figure">
        <label>Fig. 3.</label>
        <caption>
          <p>Performance comparison among four methods. (<italic toggle="yes">A</italic>) Performance comparison on a standard dataset with three clones. Clone information is labeled by “Clones” annotation bars above the heatmap. The cluster groups inferred by TBSP and Seurat are also labeled by the “Group” annotation bars above the heatmap. (<italic toggle="yes">B</italic>) Performance comparison on a standard dataset with 11 clones. Clone information is labeled by “Clones” annotation bars above the heatmap. The cluster groups inferred by TBSP and Seurat are also labeled by the “Group” annotation bars above the heatmap. (<italic toggle="yes">C</italic>) Performance comparison based on NNE, which was inferred with the t-SNE distribution, resulted from all of the four methods.</p>
        </caption>
        <graphic xlink:href="pnas.2119767119fig03" position="float"/>
      </fig>
      <p>The performance of the four methods was also quantified by the Nearest Neighbor Error (NNE) (<xref rid="r25" ref-type="bibr">25</xref>), which represents the error neighbor relationships among cells captured by each method (<xref rid="fig03" ref-type="fig">Fig. 3<italic toggle="yes">C</italic></xref>). The calculation process of NNE is detailed in <ext-link xlink:href="https://www.pnas.org/lookup/suppl/doi:10.1073/pnas.2119767119/-/DCSupplemental" ext-link-type="uri" xlink:show="new"><italic toggle="yes">SI Appendix</italic>, Supplementary Note 2</ext-link>. LINEAGE performed as good as Ludwig et al. (<xref rid="r15" ref-type="bibr">15</xref>) as their NNE scores were comparable. The running time and the required input data of these four methods are shown in <ext-link xlink:href="https://www.pnas.org/lookup/suppl/doi:10.1073/pnas.2119767119/-/DCSupplemental" ext-link-type="uri" xlink:show="new"><italic toggle="yes">SI Appendix</italic>, Table S3</ext-link>. Obviously, LINEAGE has the higher computational efficiency than other variant-based methods. In general, LINEAGE can perform lineage analysis well on label-free scRNA-seq solely, without the requirement of preexisting bulk ATAC-seq data and exogenous barcodes.</p>
    </sec>
    <sec id="s4">
      <title>LINEAGE Reveals Transcriptomic Features of BRAF Inhibitor–Resistant Clones in Cancer Cells with BRAF V600E Mutation.</title>
      <p>We then applied LINEAGE on a scRNA-seq dataset of BRAF V600E mutated melanoma cells 451Lu, which contains parental cells and BRAF inhibitor–resistant cells (<xref rid="r24" ref-type="bibr">24</xref>). By performing lineage analysis, we aimed to analyze the clonal evolution with BRAF inhibitor treatment and identify the genes correlated to BRAF inhibitor resistance. Two clusters with distinct clonal features were discovered (<xref rid="fig04" ref-type="fig">Fig. 4 <italic toggle="yes">A</italic> and <italic toggle="yes">B</italic></xref> and <ext-link xlink:href="https://www.pnas.org/lookup/suppl/doi:10.1073/pnas.2119767119/-/DCSupplemental" ext-link-type="uri" xlink:show="new"><italic toggle="yes">SI Appendix</italic>, Fig. S6</ext-link>), defined as either sensitive Cluster A (the majority are parental cells) or resistant Cluster B (the majority are BRAF inhibitor–resistant cells). The differential distribution of parental and resistant cells in Clusters A and B indicated that the clonal evolution process happened in the selection process. Gene-expression comparison was performed between Clusters A and B. In total, 64 significantly changed genes were found (<ext-link xlink:href="https://www.pnas.org/lookup/suppl/doi:10.1073/pnas.2119767119/-/DCSupplemental" ext-link-type="uri" xlink:show="new"><italic toggle="yes">SI Appendix</italic>, Figs. S7–S9</ext-link>; method is detailed in <ext-link xlink:href="https://www.pnas.org/lookup/suppl/doi:10.1073/pnas.2119767119/-/DCSupplemental" ext-link-type="uri" xlink:show="new"><italic toggle="yes">SI Appendix</italic>, Supplementary Note 3</ext-link>). The originally reported resistant gene <italic toggle="yes">DCT</italic> showed elevation in both sensitive and resistant clones, indicating that it may not be directly correlated to the clonal evolution (<xref rid="fig04" ref-type="fig">Fig. 4<italic toggle="yes">C</italic></xref>).</p>
      <fig position="float" id="fig04" fig-type="figure">
        <label>Fig. 4.</label>
        <caption>
          <p>LINEAGE identified important clonal evolution–related genes from a cancer dataset. (<italic toggle="yes">A</italic>) The lineage analysis result visualized by t-SNE plot from LINEAGE. Cells are labeled according to its BRAF inhibitor resistance status. (<italic toggle="yes">B</italic>) The lineage tree from LINEAGE. Cells are labeled according to its BRAF inhibitor resistance status as well as clonal status. (<italic toggle="yes">C</italic>) The expression levels of <italic toggle="yes">DCT</italic> and <italic toggle="yes">GSTP1</italic> across resistant and clonal status (<italic toggle="yes">P</italic> = 0.39 for "ns" in cluster A, <italic toggle="yes">P</italic> = 0.22 for "ns" in cluster B). (<italic toggle="yes">D</italic>) Gene ontology enrichment results of 64 differential expressed genes. (<italic toggle="yes">E</italic>) Cell viability determination under treatment of BRAF inhibitor Vemurafenib and GST inhibitor GSTO-IN-2 in two melanoma cell lines carrying BRAF V600E mutation (A2058: 4 μM V,1.25 μM G and A375: 8 μM V, 2.5 μM G. *<italic toggle="yes">P</italic> &lt; 0.05, ****<italic toggle="yes">P</italic> &lt; 0.0001).</p>
        </caption>
        <graphic xlink:href="pnas.2119767119fig04" position="float"/>
      </fig>
      <p>Many of these genes were enriched in gene ontology (GO) term “GO_CC: MITOCHONDRION” with Gene Set Enrichment Analysis (<xref rid="fig04" ref-type="fig">Fig. 4<italic toggle="yes">D</italic></xref>) (<xref rid="r26" ref-type="bibr">26</xref>). Since the connection between mitochondria and BRAF inhibitor resistance has been widely observed (<xref rid="r27" ref-type="bibr">27</xref>, <xref rid="r28" ref-type="bibr">28</xref>), this result actually validated the function of LINEAGE. We then explored the detailed mechanism of the mitochondria–BRAF connection by focusing on the top differentially expressed gene <italic toggle="yes">GSTP1</italic> (<xref rid="fig04" ref-type="fig">Fig. 4<italic toggle="yes">C</italic></xref>), which encodes an important redox regulator glutathione-S-transferase (GST). It is known that GST inhibitor can regulate the pigment generation in melanocytes (<xref rid="r29" ref-type="bibr">29</xref>). It has also been reported that the disruption of redox balance, which is an important function of GST, may conquer the resistance to BRAF inhibitor in melanoma cells (<xref rid="r30" ref-type="bibr">30</xref>). In consistence, combinational treatment of BRAF inhibitor Vemurafenib and GST inhibitor GSTO-IN-2 (<xref rid="r31" ref-type="bibr">31</xref>) synergistically decreased the cell viability of two melanoma cell lines (<xref rid="fig04" ref-type="fig">Fig. 4<italic toggle="yes">E</italic></xref>). GST can be a target to induce synthetic lethality in BRAF V600E mutated cancer cells.</p>
    </sec>
  </sec>
  <sec sec-type="discussion" id="s5">
    <title>Discussion</title>
    <p content-type="flushleft">Many lineage analysis–related studies, such as carcinogenesis studies, cancer resistance studies (<xref rid="r32" ref-type="bibr">32</xref>), or even developmental biology studies (<xref rid="r33" ref-type="bibr">33</xref>), have used scRNA-seq to understand the detailed mechanism. However, the requirement of exogenous barcode prevents many scientists from performing such kind of studies. Although several computational algorithms claimed that they can perform lineage analysis without exogenous barcodes, the requirement of preexisting knowledge such as parallel bulk WGS/ATAC-seq data on the same samples is certainly a technical challenge. In addition, the demand of extensive computational expertise and resource is also beyond many laboratories’ capability.</p>
    <p>We created a “low cross-entropy subspace” separation and consensus clustering–based analysis as LINEAGE. LINEAGE uses informative mitochondrial RNA variants as endogenous markers, which has relatively small size, and its polymorphism is a frequent event across different tissues and ages (<xref rid="r34" ref-type="bibr">34</xref>). In comparison to the method from Ludwig et al. (<xref rid="r15" ref-type="bibr">15</xref>), LINEAGE simplifies the endogenous markers identification process and can be applied to scRNA-seq studies without preexisting bulk WGS/ATAC-seq data. In comparison to TBSP, LINEAGE requires shorter running time and has largely improved performance.</p>
    <p>We tested LINEAGE on a classical clonal evolution study of BRAF inhibitor–resistant melanoma cells. By analyzing the label-free scRNA-seq dataset from this study, we discovered the sensitive and resistant clones. Differential expression analysis identified <italic toggle="yes">GSTP1</italic> as a BRAF V600E mutation resistance–related gene. GST inhibitor can sensitize melanoma cells to BRAF inhibitor treatment. Therefore, it may serve as the target to develop synthetic lethality therapies for BRAF V600E mutated cancer cells if this result can be validated by in vivo experiment.</p>
    <p>In summary, LINEAGE removes most of the technical hurdles on performing lineage analysis by a “low cross-entropy subspace” separation and consensus clustering–based analysis. Due to the requirement of sequencing depth to call variants, it is still difficult to perform lineage analysis on scRNA-seq data from 3′/5′-end-directed scRNA-seq technologies. However, with LINEAGE, it is possible to perform lineage analysis on much existing Smart-seq2 data if desired. Biologists can spare their time and energy on answering biological questions instead of establishing complex labeling system or perform intensive computational analysis. The application of LINEAGE may remarkably accelerate the discovery of the important genes or cell clusters in the diverse context of biomedical research.</p>
  </sec>
  <sec sec-type="materials|methods" id="s6">
    <title>Materials and Methods</title>
    <sec id="s7">
      <title>Data Preprocessing.</title>
      <sec id="s8">
        <title>Read alignment.</title>
        <p>All scRNA-seq datasets used in this study were obtained from National Center for Biotechnology Information (<ext-link xlink:href="https://www.ncbi.nlm.nih.gov/" ext-link-type="uri">https://www.ncbi.nlm.nih.gov/</ext-link>) with following accessions: Gene Expression Omnibus (GEO): GSE115218 (TF1_clones_scRNA, TF1_barcoding_scRNA) (<xref rid="r15" ref-type="bibr">15</xref>) and GEO: GSE108383 (scRNA-seq of A375 and 451Lu cell lines were used) (<xref rid="r24" ref-type="bibr">24</xref>). The reads were aligned to the GRCh38 human genome and its associated annotations (GRCh38.98) using Spliced Transcripts Alignment to a Reference (STAR) version 2.7.1a (<xref rid="r35" ref-type="bibr">35</xref>) with default parameters.</p>
      </sec>
      <sec id="s9">
        <title>Mitochondrial genotype matrix generating.</title>
        <p>A bam file consisting of mitochondrial DNA records, which were extracted from the alignment result with Samtools (version 1.9) (<xref rid="r36" ref-type="bibr">36</xref>), was obtained. The total number of reads aligned to per allele on each site of mitochondrial genome were counted using a Python script (<xref rid="r15" ref-type="bibr">15</xref>). Here, nucleotides with minimum base quality or minimum read’s alignment quality &lt;30 were filtered out. The variant frequency (<italic toggle="yes">AF<sub>x</sub></italic><sub>,</sub><italic toggle="yes"><sub>b</sub></italic>) was defined as the following:<disp-formula id="ueqn1"><mml:math id="me1" display="block" overflow="scroll"><mml:mrow><mml:mi>A</mml:mi><mml:msub><mml:mrow><mml:mi>F</mml:mi></mml:mrow><mml:mrow><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>b</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mi>b</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mstyle displaystyle="true"><mml:mo>∑</mml:mo></mml:mstyle><mml:mrow><mml:mi>b</mml:mi><mml:mo>∈</mml:mo><mml:mrow><mml:mo stretchy="true">{</mml:mo><mml:mrow><mml:mi>A</mml:mi><mml:mo>,</mml:mo><mml:mi>G</mml:mi><mml:mo>,</mml:mo><mml:mi>C</mml:mi><mml:mo>,</mml:mo><mml:mi>T</mml:mi></mml:mrow><mml:mo stretchy="true">}</mml:mo></mml:mrow></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mi>b</mml:mi></mml:msub></mml:mrow></mml:mfrac><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p>
        <p><italic toggle="yes">R<sub>b</sub></italic> is the number of reads holding base <italic toggle="yes">b</italic> at position x; <inline-formula><mml:math id="i1" display="inline" overflow="scroll"><mml:mrow><mml:mstyle displaystyle="true"><mml:msub><mml:mo>∑</mml:mo><mml:mrow><mml:mi>b</mml:mi><mml:mo>∈</mml:mo><mml:mrow><mml:mo stretchy="true">{</mml:mo><mml:mrow><mml:mi>A</mml:mi><mml:mo>,</mml:mo><mml:mi>G</mml:mi><mml:mo>,</mml:mo><mml:mi>C</mml:mi><mml:mo>,</mml:mo><mml:mi>T</mml:mi></mml:mrow><mml:mo stretchy="true">}</mml:mo></mml:mrow></mml:mrow></mml:msub><mml:mrow><mml:msub><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mi>b</mml:mi></mml:msub></mml:mrow></mml:mstyle></mml:mrow></mml:math></inline-formula> is the total coverage of position ×. Mitochondrial genotype matrix (M), where a column represented a single cell and a row represented variant frequency of a specific mitochondrial genotype, was thus generated.</p>
      </sec>
      <sec id="s10">
        <title>Highly variable site identification.</title>
        <p>To screen out highly variable sites with different mutation types, M was split into 12 submatrices (Mi, <italic toggle="yes">i</italic> = 1, 2, 3…12) according to mutation types. The 20 highest-variable sites were then called by identifying the rows with highest SD across cells in each submatrix. Considering the sparsity of the matrix, which heavily affected the SD values, LINEAGE transformed the zeroes into ones when the median of the nonzero frequencies in the same row ≥0.6. Thus, a merged submatrix M<sub>240</sub> of M was obtained by merging the resulted highly variable sites into a matrix.</p>
      </sec>
    </sec>
    <sec id="s11">
      <title>Subspace Separation.</title>
      <p>Hierarchical clustering was carried out to reseparate the M<sub>240</sub> into 20 submatrices according to the frequency dynamic patterns. In detail, the similarity between pairs of rows in M<sub>240</sub> was commonly quantified by Pearson's correlation tests. The distance matrix (<italic toggle="yes">D<sub>f</sub></italic>) was then generated as:<disp-formula id="ueqn2"><mml:math id="me2" display="block" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>D</mml:mi></mml:mrow><mml:mi>f</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mi>J</mml:mi><mml:mo>−</mml:mo><mml:mi>S</mml:mi><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>where <italic toggle="yes">J</italic> is an all-ones matrix and <italic toggle="yes">S</italic> is the similarity matrix. Hierarchical clusters were obtained based on this distance matrix, and the feature spaces with features (variants) from each resulted cluster were defined as “feature subspaces.” In this way, highly variable sites with similar frequency dynamic patterns would be grouped into the same feature subspace; thus, similar clonal cluster signals can be concentrated in same subspace.</p>
      <sec id="s12">
        <title>Entropy evaluation.</title>
        <p>In each subspace, LINEAGE used t-SNE followed by k-means clustering to realize cell-clustering (we defined these cluster results as C<sub>subs</sub>). The k, which indicated the number of clusters, in the k-means clustering process was set to 3 for datasets with cells &gt;100 and otherwise was set to 2. To effectively identify subspaces that might contain clone lineage information, LINEAGE calculated ARI between pairs of subspaces as consensus indicator and got the consensus index matrix as A. LINEAGE defined entropy based on the cell distribution similarity among subspaces, so called “cross-entropy” here. The subspaces with lowest “cross-entropy” (<italic toggle="yes">I<sub>i</sub></italic>, <italic toggle="yes">i</italic> = 1, 2, 3…20), which indicated highest consensus with other subspaces, were selected for subsequent consensus clustering. In this study, six low–cross-entropy subspaces were selected in all cases, and the number of subspaces can be adjusted by parameter. Here, I was defined as:<disp-formula id="ueqn3"><mml:math id="me3" display="block" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>I</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:mi>max</mml:mi><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo stretchy="true">)</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>∈</mml:mo><mml:mn>20</mml:mn><mml:mo> </mml:mo><mml:mtext>subspaces</mml:mtext><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:mi>i</mml:mi><mml:mo>≠</mml:mo><mml:mi>j</mml:mi><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p>
      </sec>
    </sec>
    <sec id="s13">
      <title>Consensus Clustering.</title>
      <p>Then, LINEAGE generated a combined distance matrix as follows:<disp-formula id="ueqn4"><mml:math id="me4" display="block" overflow="scroll"><mml:mrow><mml:mover accent="true"><mml:mi>D</mml:mi><mml:mo>˜</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:msup><mml:mstyle displaystyle="true"><mml:mo>∑</mml:mo></mml:mstyle><mml:mtext>​</mml:mtext></mml:msup><mml:msub><mml:mrow><mml:mi>D</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:mi>i</mml:mi><mml:mo> </mml:mo><mml:mo>∈</mml:mo><mml:mtext>selected</mml:mtext><mml:mo> </mml:mo><mml:mtext>subspaces,</mml:mtext></mml:mrow></mml:math></disp-formula>where <italic toggle="yes">D<sub>i</sub></italic> is the distance matrix from a selected subspace.</p>
      <p>Meanwhile, LINEAGE also characterized consensus information across subspaces by calculating a consensus-factor matrix based on the clustering results (C<sub>subs</sub>) from the selected subspaces:<disp-formula id="ueqn5"><mml:math id="me5" display="block" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mover accent="true"><mml:mi>W</mml:mi><mml:mo>˜</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mo stretchy="true">{</mml:mo><mml:mrow><mml:mtable columnalign="left"><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:msub><mml:mrow><mml:mrow><mml:mtext>if</mml:mtext><mml:mo> </mml:mo><mml:mtext>cell</mml:mtext></mml:mrow></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo> </mml:mo><mml:msub><mml:mrow><mml:mrow><mml:mtext>and</mml:mtext><mml:mo> </mml:mo><mml:mtext>cell</mml:mtext></mml:mrow></mml:mrow><mml:mi>j</mml:mi></mml:msub><mml:mo> </mml:mo><mml:mtext>are</mml:mtext><mml:mo> </mml:mo><mml:mtext>never</mml:mtext><mml:mo> </mml:mo><mml:mtext>located</mml:mtext><mml:mo> </mml:mo><mml:mtext>in</mml:mtext><mml:mo> </mml:mo><mml:mtext>same</mml:mtext><mml:mo> </mml:mo><mml:mtext>cluster</mml:mtext></mml:mrow></mml:mtd></mml:mtr><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:msub><mml:mrow><mml:mrow><mml:mtext>if</mml:mtext><mml:mo> </mml:mo><mml:mtext>cell</mml:mtext></mml:mrow></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:msub><mml:mrow><mml:mrow><mml:mo> </mml:mo><mml:mtext>and</mml:mtext><mml:mo> </mml:mo><mml:mtext>cell</mml:mtext></mml:mrow></mml:mrow><mml:mi>j</mml:mi></mml:msub><mml:mo> </mml:mo><mml:mtext>are</mml:mtext><mml:mo> </mml:mo><mml:mtext>located</mml:mtext><mml:mo> </mml:mo><mml:mtext>in</mml:mtext><mml:mo> </mml:mo><mml:mtext>same</mml:mtext><mml:mo> </mml:mo><mml:mtext>cluster</mml:mtext><mml:mo> </mml:mo><mml:mtext>in</mml:mtext><mml:mo> </mml:mo><mml:mtext>one</mml:mtext><mml:mo> </mml:mo><mml:mtext>subspace</mml:mtext></mml:mrow></mml:mtd></mml:mtr><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow><mml:mn>2</mml:mn><mml:mo>,</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:msub><mml:mrow><mml:mrow><mml:mtext>if</mml:mtext><mml:mo> </mml:mo><mml:mtext>cell</mml:mtext></mml:mrow></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:msub><mml:mrow><mml:mrow><mml:mo> </mml:mo><mml:mtext>and</mml:mtext><mml:mo> </mml:mo><mml:mtext>cell</mml:mtext></mml:mrow></mml:mrow><mml:mi>j</mml:mi></mml:msub><mml:mo> </mml:mo><mml:mtext>are</mml:mtext><mml:mo> </mml:mo><mml:mtext>located</mml:mtext><mml:mo> </mml:mo><mml:mtext>in</mml:mtext><mml:mo> </mml:mo><mml:mtext>same</mml:mtext><mml:mo> </mml:mo><mml:mtext>cluster</mml:mtext><mml:mo> </mml:mo><mml:mtext>in</mml:mtext><mml:mo> </mml:mo><mml:mtext>two</mml:mtext><mml:mo> </mml:mo><mml:mtext>subspaces</mml:mtext></mml:mrow></mml:mtd></mml:mtr><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow><mml:mo>…</mml:mo><mml:mo> </mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow/></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p>
      <p>By integrating distance information and consensus information, LINEAGE generated a more-integrative distance matrix <italic toggle="yes">D</italic> as follows:<disp-formula id="ueqn6"><mml:math id="me6" display="block" overflow="scroll"><mml:mrow><mml:mi>D</mml:mi><mml:mo>=</mml:mo><mml:mover accent="true"><mml:mi>D</mml:mi><mml:mo>˜</mml:mo></mml:mover><mml:mo>⋅</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mn>3</mml:mn><mml:mover accent="true"><mml:mi>W</mml:mi><mml:mo>˜</mml:mo></mml:mover><mml:mo>+</mml:mo><mml:mi>J</mml:mi></mml:mrow></mml:mfrac><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>where J is an all-ones matrix. Basing on distance matrix D, t-SNE followed by k-means clustering strategy was used to infer the initial consensus cell clone clusters. Here, an adaptive density peak detection algorithm implemented in the ADPclust package in R (<xref rid="r37" ref-type="bibr">37</xref>) was integrated to accurately infer the number of clusters.</p>
    </sec>
    <sec id="s14">
      <title>Marker Variants Identification.</title>
      <sec id="s15">
        <title>Group marker identification.</title>
        <p>To screen out the marker variants, LINEAGE transformed the consensus-clustering result into a binary cluster: for a cell group, if a cell is in this group, set its cluster label as 1; if not, set as 0. For each highly variable variant, a receiver operating characteristic (<xref rid="r38" ref-type="bibr">38</xref>) curve was built, and the area under the receiver operating characteristic (AUC) score was thus calculated with the frequency distribution as predictor and the binary cluster labels of each group as response. Pearson's correlation coefficient was also calculated between the binary cluster labels and the frequency distribution. Variants with <italic toggle="yes">P</italic> values &lt;0.05 were considered as cell group markers. These markers were ranked by AUC scores, since higher AUC scores indicated more-reliable markers. Subsequently, 10 to 20 markers with the highest AUC scores were used to refine the consensus-clustering result.</p>
      </sec>
      <sec id="s16">
        <title>Refinement based on marker variants.</title>
        <p>After the frequency submatrix consisting of frequencies of markers (M<sub>m</sub>) was gotten, cells with zeroes on all markers were removed. LINEAGE integrated both t-SNE and UMAP (<xref rid="r39" ref-type="bibr">39</xref>) for dimension reduction and got refined consensus-clustering results based on the dimension-reduction results separately.</p>
      </sec>
      <sec id="s17">
        <title>Iterative optimization.</title>
        <p>Considering the randomness from clustering and dimension-reduction processes, an iteration process was implemented in LINEAGE to guarantee a more-stable and -reliable cell-clustering/clone-tracing result. Based on the assumption that real clone clusters always show more-reliable markers and cell cluster information from more-effective subspaces with larger information capacity, a measurement <italic toggle="yes">S</italic><sub>score</sub> was defined for optimization as follows:<disp-formula id="ueqn7"><mml:math id="me7" display="block" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mtext>score</mml:mtext></mml:mrow></mml:msub><mml:mo> </mml:mo><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>D</mml:mi></mml:mrow><mml:mrow><mml:mtext>score</mml:mtext></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mfrac><mml:mrow><mml:mn>2.5</mml:mn><mml:mo>⋅</mml:mo><mml:msubsup><mml:mstyle displaystyle="true"><mml:mo>∑</mml:mo></mml:mstyle><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>10</mml:mn></mml:mrow></mml:msubsup><mml:mi>A</mml:mi><mml:mi>U</mml:mi><mml:msub><mml:mrow><mml:mtext>C</mml:mtext></mml:mrow><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:mn>10</mml:mn></mml:mrow></mml:mfrac><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>where <inline-formula><mml:math id="i2" display="inline" overflow="scroll"><mml:mrow><mml:mstyle displaystyle="true"><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>10</mml:mn></mml:mrow></mml:msubsup><mml:mrow><mml:mi>A</mml:mi><mml:mi>U</mml:mi><mml:msub><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mstyle></mml:mrow></mml:math></inline-formula> is the sum of the 10 greatest AUC scores of inferred markers. <italic toggle="yes">D</italic><sub>score</sub> is a score calculated in the refinement process. Concretely, LINEAGE calculated ARIs between the refined clustering results (resulted from t-SNE or UMAP-Kmeans procedures) and the clustering results in the selected subspaces (C<sub>subs</sub>). Subspaces with ARI &gt; 0.1 were recorded as effective subspaces and the number of effective subspaces was labeled as n. To evaluate the information capacity of the consensus results, a <italic toggle="yes">D</italic><sub>score</sub> was defined to reflect the consensus among the refined results and the selected subspaces:<disp-formula id="ueqn8"><mml:math id="me8" display="block" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>D</mml:mi></mml:mrow><mml:mrow><mml:mtext>score</mml:mtext></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>n</mml:mi><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mrow><mml:mtext>max</mml:mtext></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mn>2</mml:mn><mml:msub><mml:mrow><mml:mi>D</mml:mi></mml:mrow><mml:mrow><mml:mtext>ARI</mml:mtext></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:mtext>and</mml:mtext><mml:mo> </mml:mo><mml:msub><mml:mrow><mml:mi>D</mml:mi></mml:mrow><mml:mrow><mml:mtext>ARI</mml:mtext></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mn>0.5</mml:mn><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mtext>if</mml:mtext><mml:mo> </mml:mo><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mover accent="true"><mml:mrow><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mtext>subs</mml:mtext></mml:mrow></mml:msub></mml:mrow><mml:mo stretchy="true">¯</mml:mo></mml:mover><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mtext>if</mml:mtext><mml:mo> </mml:mo><mml:mi>n</mml:mi><mml:mo>&gt;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula></p>
        <p content-type="flushleft">where <italic toggle="yes">B</italic><sub>max</sub> represents the maximum ARI between the refined consensus-clustering result and the clusters in effective subspaces; thus, <italic toggle="yes">n</italic>+<italic toggle="yes">B</italic><sub>max</sub> indicates the consensus information capacity from effective subspaces. Meanwhile, <inline-formula><mml:math id="i3" display="inline" overflow="scroll"><mml:mrow><mml:mover accent="true"><mml:mrow><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mtext>subs</mml:mtext></mml:mrow></mml:msub></mml:mrow><mml:mo stretchy="true">¯</mml:mo></mml:mover></mml:mrow></mml:math></inline-formula> represents the average of a submatrix of <italic toggle="yes">A</italic>, which consists of ARI values among effective subspaces, and D<sub>ARI</sub> represents the information overlap status among effective subspaces. Lower <italic toggle="yes">D</italic><sub>ARI</sub> means higher overlap. In this way, consensus result-containing cluster structures from various subspaces with low-overlap cluster information is more preferred.</p>
        <p>Among the iteration with same or different parameters, the one with highest <inline-formula><mml:math id="i4" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mtext>score</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> was reserved as the best result.</p>
      </sec>
    </sec>
    <sec id="s18">
      <title>Methods Performance Evaluation and Comparison.</title>
      <p>A simulated dataset was generated by mixing two human melanoma cell lines A375 and 451Lu. LINEAGE processes described as above (<italic toggle="yes">Data Preprocessing</italic>, <italic toggle="yes">Subspace Separation</italic>, <italic toggle="yes">Consensus Clustering</italic>, and <italic toggle="yes">Marker Variants Identification</italic>) were carried out on the simulated and the two standard benchmark datasets. Codes of Seurat version 3 and version 4 (<xref rid="r8" ref-type="bibr">8</xref>, <xref rid="r23" ref-type="bibr">23</xref>), ENCORE (<xref rid="r40" ref-type="bibr">40</xref>), the method developed by Ludwig et al. (<xref rid="r15" ref-type="bibr">15</xref>), and TBSP (<xref rid="r13" ref-type="bibr">13</xref>) were downloaded and run according to their manuals on the two benchmark datasets.</p>
    </sec>
    <sec id="s19">
      <title>Cell Culture.</title>
      <p>A2058 and A375 were cultured in Dulbecco's modified Eagle medium (Thermo Fisher Scientific) with 10% fetal bovine serum (Yeasen) and 5% penicillin/streptomycin (Gibco) at 37 °C with 5% CO<sub>2</sub>. Cell viability was performed with Cell Counting Kit-8 (CCK-8; Yeasen) according to the manufacturer's instructions. Briefly, cells were seeded into 96-well plate at a density of 1,000 cells per well. Cells were treated with different chemical combinations (Vemurafenib, GSTO-IN-2; MCE) and examined at the time point of 0, 24, 48, and 72 hours. At each time point, CCK-8 (10%) was added to the wells, and after an incubation of 1 h at 37 °C, absorbance was measured at 450 nm with a Microplate Reader Infinite F50 (Tecan).</p>
    </sec>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material content-type="local-data">
      <label>Supplementary File</label>
      <media xlink:href="pnas.2119767119.sapp.pdf" id="d64e1638" position="anchor"/>
    </supplementary-material>
  </sec>
</body>
<back>
  <ack>
    <p>This work was supported by Chinese Ministry of Science and Technology (MOST) 2018YFA0801300 and 2020YFA0803601 and National Natural Science Foundation of China (NSFC) 32071138 to J. L., NSFC 22104080 to J. S., and NSFC 21735004 and 21927806 to C. Y. We thank Vijay G. Sankaran (Broad Institute of MIT and Harvard) for providing their open-source code for performing mitochondrial genotyping.</p>
  </ack>
  <fn-group>
    <fn id="fn3" fn-type="COI-statement">
      <p>The authors declare no competing interest.</p>
    </fn>
    <fn id="fn4" fn-type="other">
      <p>This article is a PNAS Direct Submission.</p>
    </fn>
    <fn id="fn6" fn-type="supplementary-material">
      <p>This article contains supporting information online at <ext-link xlink:href="https://www.pnas.org/lookup/suppl/doi:10.1073/pnas.2119767119/-/DCSupplemental" ext-link-type="uri">https://www.pnas.org/lookup/suppl/doi:10.1073/pnas.2119767119/-/DCSupplemental</ext-link>.</p>
    </fn>
  </fn-group>
  <sec sec-type="data-availability" id="s20">
    <title>Data Availability</title>
    <p>The scripts for mitochondrial genotype matrix preparation and examples are available at GitHub, <ext-link xlink:href="https://github.com/songjiajia2018/ppl" ext-link-type="uri">https://github.com/songjiajia2018/ppl</ext-link>. The scripts for lineage analysis and example data are available at GitHub, <ext-link xlink:href="https://github.com/songjiajia2018/LINEAGE" ext-link-type="uri">https://github.com/songjiajia2018/LINEAGE</ext-link>.</p>
  </sec>
  <ref-list>
    <ref id="r1">
      <label>1</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>L.</given-names><surname>He</surname></string-name><etal/></person-group>, <article-title>Proliferation tracing reveals regional hepatocyte generation in liver homeostasis and repair</article-title>. <source>Science</source><volume>371</volume>, <fpage>eabc4346</fpage> (<year>2021</year>).<pub-id pub-id-type="pmid">33632818</pub-id></mixed-citation>
    </ref>
    <ref id="r2">
      <label>2</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>P.</given-names><surname>Collombat</surname></string-name><etal/></person-group>, <article-title>The ectopic expression of Pax4 in the mouse pancreas converts progenitor cells into alpha and subsequently beta cells</article-title>. <source>Cell</source><volume>138</volume>, <fpage>449</fpage>–<lpage>462</lpage> (<year>2009</year>).<pub-id pub-id-type="pmid">19665969</pub-id></mixed-citation>
    </ref>
    <ref id="r3">
      <label>3</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>Z.</given-names><surname>Song</surname></string-name>, <string-name><given-names>A. M.</given-names><surname>Xiaoli</surname></string-name>, <string-name><given-names>F.</given-names><surname>Yang</surname></string-name></person-group>, <article-title>Regulation and metabolic significance of <italic toggle="yes">de novo</italic> lipogenesis in adipose tissues</article-title>. <source>Nutrients</source><volume>10</volume>, <fpage>1383</fpage> (<year>2018</year>).</mixed-citation>
    </ref>
    <ref id="r4">
      <label>4</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>X.</given-names><surname>Fan</surname></string-name><etal/></person-group>, <article-title>Spatial transcriptomic survey of human embryonic cerebral cortex by single-cell RNA-seq analysis</article-title>. <source>Cell Res.</source><volume>28</volume>, <fpage>730</fpage>–<lpage>745</lpage> (<year>2018</year>).<pub-id pub-id-type="pmid">29867213</pub-id></mixed-citation>
    </ref>
    <ref id="r5">
      <label>5</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>X.</given-names><surname>Han</surname></string-name><etal/></person-group>, <article-title>Mapping the mouse cell atlas by microwell-seq</article-title>. <source>Cell</source><volume>172</volume>, <fpage>1091</fpage>–<lpage>1107.e17</lpage> (<year>2018</year>).<pub-id pub-id-type="pmid">29474909</pub-id></mixed-citation>
    </ref>
    <ref id="r6">
      <label>6</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>S. R.</given-names><surname>Srivatsan</surname></string-name><etal/></person-group>, <article-title>Massively multiplex chemical transcriptomics at single-cell resolution</article-title>. <source>Science</source><volume>367</volume>, <fpage>45</fpage>–<lpage>51</lpage> (<year>2020</year>).<pub-id pub-id-type="pmid">31806696</pub-id></mixed-citation>
    </ref>
    <ref id="r7">
      <label>7</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>Y.</given-names><surname>Li</surname></string-name>, <string-name><given-names>Q.</given-names><surname>Xu</surname></string-name>, <string-name><given-names>D.</given-names><surname>Wu</surname></string-name>, <string-name><given-names>G.</given-names><surname>Chen</surname></string-name></person-group>, <article-title>Exploring additional valuable information from single-cell RNA-seq data</article-title>. <source>Front. Cell Dev. Biol.</source><volume>8</volume>, <fpage>593007</fpage> (<year>2020</year>).<pub-id pub-id-type="pmid">33335900</pub-id></mixed-citation>
    </ref>
    <ref id="r8">
      <label>8</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>Y.</given-names><surname>Hao</surname></string-name><etal/></person-group>, <article-title>Integrated analysis of multimodal single-cell data</article-title>. <source>Cell</source><volume>184</volume>, <fpage>3573</fpage>–<lpage>3587.e29</lpage> (<year>2021</year>).<pub-id pub-id-type="pmid">34062119</pub-id></mixed-citation>
    </ref>
    <ref id="r9">
      <label>9</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>W.</given-names><surname>Gong</surname></string-name><etal/></person-group>, <article-title>Benchmarked approaches for reconstruction of in vitro cell lineages and in silico models of C. elegans and M. musculus developmental trees</article-title>. <source>Cell Syst.</source><volume>12</volume>, <fpage>810</fpage>–<lpage>826.e4</lpage> (<year>2021</year>).<pub-id pub-id-type="pmid">34146472</pub-id></mixed-citation>
    </ref>
    <ref id="r10">
      <label>10</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>D. E.</given-names><surname>Wagner</surname></string-name>, <string-name><given-names>A. M.</given-names><surname>Klein</surname></string-name></person-group>, <article-title>Lineage tracing meets single-cell omics: Opportunities and challenges</article-title>. <source>Nat. Rev. Genet.</source><volume>21</volume>, <fpage>410</fpage>–<lpage>427</lpage> (<year>2020</year>).<pub-id pub-id-type="pmid">32235876</pub-id></mixed-citation>
    </ref>
    <ref id="r11">
      <label>11</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>C.</given-names><surname>Weinreb</surname></string-name>, <string-name><given-names>A.</given-names><surname>Rodriguez-Fraticelli</surname></string-name>, <string-name><given-names>F. D.</given-names><surname>Camargo</surname></string-name>, <string-name><given-names>A. M.</given-names><surname>Klein</surname></string-name></person-group>, <article-title>Lineage tracing on transcriptional landscapes links state to fate during differentiation</article-title>. <source>Science</source><volume>367</volume>, <fpage>eaaw3381</fpage> (<year>2020</year>).<pub-id pub-id-type="pmid">31974159</pub-id></mixed-citation>
    </ref>
    <ref id="r12">
      <label>12</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>J. J.</given-names><surname>Quinn</surname></string-name><etal/></person-group>, <article-title>Single-cell lineages reveal the rates, routes, and drivers of metastasis in cancer xenografts</article-title>. <source>Science</source><volume>371</volume>, <fpage>eabc1944</fpage> (<year>2021</year>).<pub-id pub-id-type="pmid">33479121</pub-id></mixed-citation>
    </ref>
    <ref id="r13">
      <label>13</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>J.</given-names><surname>Ding</surname></string-name>, <string-name><given-names>C.</given-names><surname>Lin</surname></string-name>, <string-name><given-names>Z.</given-names><surname>Bar-Joseph</surname></string-name></person-group>, <article-title>Cell lineage inference from SNP and scRNA-seq data</article-title>. <source>Nucleic Acids Res.</source><volume>47</volume>, <fpage>e56</fpage> (<year>2019</year>).<pub-id pub-id-type="pmid">30820578</pub-id></mixed-citation>
    </ref>
    <ref id="r14">
      <label>14</label>
      <mixed-citation publication-type="other"><person-group person-group-type="author"><string-name><given-names>L.</given-names><surname>Lin</surname></string-name><etal/></person-group>, <article-title>Single-cell transcriptome lineage tracing of human pancreatic development identifies distinct developmental trajectories of alpha and beta cells</article-title>. bioRxiv [Preprint] (<year>2021</year>). <pub-id pub-id-type="doi">10.1101/2021.01.14.426320</pub-id> (Accessed 15 January 2021).</mixed-citation>
    </ref>
    <ref id="r15">
      <label>15</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>L. S.</given-names><surname>Ludwig</surname></string-name><etal/></person-group>, <article-title>Lineage tracing in humans enabled by mitochondrial mutations and single-cell genomics</article-title>. <source>Cell</source><volume>176</volume>, <fpage>1325</fpage>–<lpage>1339.e22</lpage> (<year>2019</year>).<pub-id pub-id-type="pmid">30827679</pub-id></mixed-citation>
    </ref>
    <ref id="r16">
      <label>16</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>C.</given-names><surname>Shannon</surname></string-name></person-group>, <article-title>A mathematical theory of communication</article-title>. <source>Bell Syst. Tech. J.</source><volume>27</volume>, <fpage>379</fpage>–<lpage>423</lpage> (<year>1948</year>).</mixed-citation>
    </ref>
    <ref id="r17">
      <label>17</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>S.</given-names><surname>Picelli</surname></string-name><etal/></person-group>, <article-title>Smart-seq2 for sensitive full-length transcriptome profiling in single cells</article-title>. <source>Nat. Methods</source><volume>10</volume>, <fpage>1096</fpage>–<lpage>1098</lpage> (<year>2013</year>).<pub-id pub-id-type="pmid">24056875</pub-id></mixed-citation>
    </ref>
    <ref id="r18">
      <label>18</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>S.</given-names><surname>Behjati</surname></string-name><etal/></person-group>, <article-title>Genome sequencing of normal cells reveals developmental lineages and mutational processes</article-title>. <source>Nature</source><volume>513</volume>, <fpage>422</fpage>–<lpage>425</lpage> (<year>2014</year>).<pub-id pub-id-type="pmid">25043003</pub-id></mixed-citation>
    </ref>
    <ref id="r19">
      <label>19</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>D.</given-names><surname>Frumkin</surname></string-name>, <string-name><given-names>A.</given-names><surname>Wasserstrom</surname></string-name>, <string-name><given-names>S.</given-names><surname>Kaplan</surname></string-name>, <string-name><given-names>U.</given-names><surname>Feige</surname></string-name>, <string-name><given-names>E.</given-names><surname>Shapiro</surname></string-name></person-group>, <article-title>Genomic variability within an organism exposes its cell lineage tree</article-title>. <source>PLoS Comput. Biol.</source><volume>1</volume>, <fpage>e50</fpage> (<year>2005</year>).<pub-id pub-id-type="pmid">16261192</pub-id></mixed-citation>
    </ref>
    <ref id="r20">
      <label>20</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>G. D.</given-names><surname>Evrony</surname></string-name><etal/></person-group>, <article-title>Cell lineage analysis in human brain using endogenous retroelements</article-title>. <source>Neuron</source><volume>85</volume>, <fpage>49</fpage>–<lpage>59</lpage> (<year>2015</year>).<pub-id pub-id-type="pmid">25569347</pub-id></mixed-citation>
    </ref>
    <ref id="r21">
      <label>21</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>M. A.</given-names><surname>Lodato</surname></string-name><etal/></person-group>, <article-title>Somatic mutation in single human neurons tracks developmental and transcriptional history</article-title>. <source>Science</source><volume>350</volume>, <fpage>94</fpage>–<lpage>98</lpage> (<year>2015</year>).<pub-id pub-id-type="pmid">26430121</pub-id></mixed-citation>
    </ref>
    <ref id="r22">
      <label>22</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>S.</given-names><surname>Becattini</surname></string-name><etal/></person-group>, <article-title>T cell immunity. Functional heterogeneity of human memory CD4<sup>+</sup> T cell clones primed by pathogens or vaccines</article-title>. <source>Science</source><volume>347</volume>, <fpage>400</fpage>–<lpage>406</lpage> (<year>2015</year>).<pub-id pub-id-type="pmid">25477212</pub-id></mixed-citation>
    </ref>
    <ref id="r23">
      <label>23</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>T.</given-names><surname>Stuart</surname></string-name><etal/></person-group>, <article-title>Comprehensive integration of single-cell data</article-title>. <source>Cell</source><volume>177</volume>, <fpage>1888</fpage>–<lpage>1902.e21</lpage> (<year>2019</year>).<pub-id pub-id-type="pmid">31178118</pub-id></mixed-citation>
    </ref>
    <ref id="r24">
      <label>24</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>Y. J.</given-names><surname>Ho</surname></string-name><etal/></person-group>, <article-title>Single-cell RNA-seq analysis identifies markers of resistance to targeted BRAF inhibitors in melanoma cell populations</article-title>. <source>Genome Res.</source><volume>28</volume>, <fpage>1353</fpage>–<lpage>1363</lpage> (<year>2018</year>).<pub-id pub-id-type="pmid">30061114</pub-id></mixed-citation>
    </ref>
    <ref id="r25">
      <label>25</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>B.</given-names><surname>Wang</surname></string-name>, <string-name><given-names>J.</given-names><surname>Zhu</surname></string-name>, <string-name><given-names>E.</given-names><surname>Pierson</surname></string-name>, <string-name><given-names>D.</given-names><surname>Ramazzotti</surname></string-name>, <string-name><given-names>S.</given-names><surname>Batzoglou</surname></string-name></person-group>, <article-title>Visualization and analysis of single-cell RNA-seq data by kernel-based similarity learning</article-title>. <source>Nat. Methods</source><volume>14</volume>, <fpage>414</fpage>–<lpage>416</lpage> (<year>2017</year>).<pub-id pub-id-type="pmid">28263960</pub-id></mixed-citation>
    </ref>
    <ref id="r26">
      <label>26</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>A.</given-names><surname>Subramanian</surname></string-name><etal/></person-group>, <article-title>Gene set enrichment analysis: A knowledge-based approach for interpreting genome-wide expression profiles</article-title>. <source>Proc. Natl. Acad. Sci. U.S.A.</source><volume>102</volume>, <fpage>15545</fpage>–<lpage>15550</lpage> (<year>2005</year>).<pub-id pub-id-type="pmid">16199517</pub-id></mixed-citation>
    </ref>
    <ref id="r27">
      <label>27</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>J.</given-names><surname>Kaplon</surname></string-name><etal/></person-group>, <article-title>A key role for mitochondrial gatekeeper pyruvate dehydrogenase in oncogene-induced senescence</article-title>. <source>Nature</source><volume>498</volume>, <fpage>109</fpage>–<lpage>112</lpage> (<year>2013</year>).<pub-id pub-id-type="pmid">23685455</pub-id></mixed-citation>
    </ref>
    <ref id="r28">
      <label>28</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>M. R.</given-names><surname>Ruocco</surname></string-name><etal/></person-group>, <article-title>Metabolic flexibility in melanoma: A potential therapeutic target</article-title>. <source>Semin. Cancer Biol.</source><volume>59</volume>, <fpage>187</fpage>–<lpage>207</lpage> (<year>2019</year>).<pub-id pub-id-type="pmid">31362075</pub-id></mixed-citation>
    </ref>
    <ref id="r29">
      <label>29</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>Q.</given-names><surname>Cong</surname></string-name><etal/></person-group>, <article-title>HCV poly U/UC sequence-induced inflammation leads to metabolic disorders in vulvar lichen sclerosis</article-title>. <source>Life Sci. Alliance</source><volume>4</volume>, <fpage>e202000906</fpage> (<year>2021</year>).<pub-id pub-id-type="pmid">34145025</pub-id></mixed-citation>
    </ref>
    <ref id="r30">
      <label>30</label>
      <mixed-citation publication-type="other"><person-group person-group-type="author"><string-name><given-names>B. B.</given-names><surname>Paudel</surname></string-name><etal/></person-group>, <article-title>Disruption of redox balance enhances the effects of BRAF-inhibition in melanoma cells</article-title>. bioRxiv [Preprint] (<year>2019</year>). <pub-id pub-id-type="doi">10.1101/818989</pub-id> (Accessed 28 October 2019).</mixed-citation>
    </ref>
    <ref id="r31">
      <label>31</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>K. H.</given-names><surname>Chang</surname></string-name>, <string-name><given-names>L.</given-names><surname>Lee</surname></string-name>, <string-name><given-names>J.</given-names><surname>Chen</surname></string-name>, <string-name><given-names>W. S.</given-names><surname>Li</surname></string-name></person-group>, <article-title>Lithocholic acid analogues, new and potent alpha-2,3-sialyltransferase inhibitors</article-title>. <source>Chem. Commun.</source> (<issue>6</issue>), <fpage>629</fpage>–<lpage>631</lpage> (<year>2006</year>).</mixed-citation>
    </ref>
    <ref id="r32">
      <label>32</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>C. E.</given-names><surname>Eyler</surname></string-name><etal/></person-group>, <article-title>Single-cell lineage analysis reveals genetic and epigenetic interplay in glioblastoma drug resistance</article-title>. <source>Genome Biol.</source><volume>21</volume>, <fpage>174</fpage> (<year>2020</year>).<pub-id pub-id-type="pmid">32669109</pub-id></mixed-citation>
    </ref>
    <ref id="r33">
      <label>33</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>C.</given-names><surname>Weng</surname></string-name><etal/></person-group>, <article-title>Single-cell lineage analysis reveals extensive multimodal transcriptional control during directed beta-cell differentiation</article-title>. <source>Nat. Metab.</source><volume>2</volume>, <fpage>1443</fpage>–<lpage>1458</lpage> (<year>2020</year>).<pub-id pub-id-type="pmid">33257854</pub-id></mixed-citation>
    </ref>
    <ref id="r34">
      <label>34</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>J.</given-names><surname>Naue</surname></string-name><etal/></person-group>, <article-title>Evidence for frequent and tissue-specific sequence heteroplasmy in human mitochondrial DNA</article-title>. <source>Mitochondrion</source><volume>20</volume>, <fpage>82</fpage>–<lpage>94</lpage> (<year>2015</year>).<pub-id pub-id-type="pmid">25526677</pub-id></mixed-citation>
    </ref>
    <ref id="r35">
      <label>35</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>A.</given-names><surname>Dobin</surname></string-name><etal/></person-group>, <article-title>STAR: Ultrafast universal RNA-seq aligner</article-title>. <source>Bioinformatics</source><volume>29</volume>, <fpage>15</fpage>–<lpage>21</lpage> (<year>2013</year>).<pub-id pub-id-type="pmid">23104886</pub-id></mixed-citation>
    </ref>
    <ref id="r36">
      <label>36</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>H.</given-names><surname>Li</surname></string-name></person-group>, <article-title>A statistical framework for SNP calling, mutation discovery, association mapping and population genetical parameter estimation from sequencing data</article-title>. <source>Bioinformatics</source><volume>27</volume>, <fpage>2987</fpage>–<lpage>2993</lpage> (<year>2011</year>).<pub-id pub-id-type="pmid">21903627</pub-id></mixed-citation>
    </ref>
    <ref id="r37">
      <label>37</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>X.-F.</given-names><surname>Wang</surname></string-name>, <string-name><given-names>Y.</given-names><surname>Xu</surname></string-name></person-group>, <article-title>Fast clustering using adaptive density peak detection</article-title>. <source>Stat. Methods Med. Res.</source><volume>26</volume>, <fpage>2800</fpage>–<lpage>2811</lpage> (<year>2017</year>).<pub-id pub-id-type="pmid">26475830</pub-id></mixed-citation>
    </ref>
    <ref id="r38">
      <label>38</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>X.</given-names><surname>Robin</surname></string-name><etal/></person-group>, <article-title>pROC: An open-source package for R and S+ to analyze and compare ROC curves</article-title>. <source>BMC Bioinformatics</source><volume>12</volume>, <fpage>77</fpage> (<year>2011</year>).<pub-id pub-id-type="pmid">21414208</pub-id></mixed-citation>
    </ref>
    <ref id="r39">
      <label>39</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>E.</given-names><surname>Becht</surname></string-name><etal/></person-group>, <article-title>Dimensionality reduction for visualizing single-cell data using UMAP</article-title>. <source>Nat. Biotechnol.</source><volume>37</volume>, <fpage>38</fpage>–<lpage>44</lpage> (<year>2018</year>).</mixed-citation>
    </ref>
    <ref id="r40">
      <label>40</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>J.</given-names><surname>Song</surname></string-name><etal/></person-group>, <article-title>Entropy subspace separation-based clustering for noise reduction (ENCORE) of scRNA-seq data</article-title>. <source>Nucleic Acids Res.</source><volume>49</volume>, <fpage>e18</fpage> (<year>2021</year>).<pub-id pub-id-type="pmid">33305325</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
