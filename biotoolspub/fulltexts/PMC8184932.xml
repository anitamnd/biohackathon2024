<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName A++V2.4.dtd?>
<?SourceDTD.Version 2.4?>
<?ConverterInfo.XSLTName springer2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Nat Commun</journal-id>
    <journal-id journal-id-type="iso-abbrev">Nat Commun</journal-id>
    <journal-title-group>
      <journal-title>Nature Communications</journal-title>
    </journal-title-group>
    <issn pub-type="epub">2041-1723</issn>
    <publisher>
      <publisher-name>Nature Publishing Group UK</publisher-name>
      <publisher-loc>London</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">8184932</article-id>
    <article-id pub-id-type="publisher-id">23749</article-id>
    <article-id pub-id-type="doi">10.1038/s41467-021-23749-x</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Article</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>HiC-DC+ enables systematic 3D interaction calls and differential analysis for Hi-C and HiChIP</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0003-3858-8332</contrib-id>
        <name>
          <surname>Sahin</surname>
          <given-names>Merve</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Wong</surname>
          <given-names>Wilfred</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-3548-9227</contrib-id>
        <name>
          <surname>Zhan</surname>
          <given-names>Yingqian</given-names>
        </name>
        <xref ref-type="aff" rid="Aff3">3</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Van Deynze</surname>
          <given-names>Kinsey</given-names>
        </name>
        <xref ref-type="aff" rid="Aff4">4</xref>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-6820-5083</contrib-id>
        <name>
          <surname>Koche</surname>
          <given-names>Richard</given-names>
        </name>
        <xref ref-type="aff" rid="Aff3">3</xref>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-4571-5910</contrib-id>
        <name>
          <surname>Leslie</surname>
          <given-names>Christina S.</given-names>
        </name>
        <address>
          <email>cleslie@cbio.mskcc.org</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <aff id="Aff1"><label>1</label><institution-wrap><institution-id institution-id-type="GRID">grid.51462.34</institution-id><institution-id institution-id-type="ISNI">0000 0001 2171 9952</institution-id><institution>Computational and Systems Biology Program, </institution><institution>Memorial Sloan Kettering Cancer Center, </institution></institution-wrap>New York, NY USA </aff>
      <aff id="Aff2"><label>2</label>Tri-Institutional Training Program in Computational Biology and Medicine, New York, NY USA </aff>
      <aff id="Aff3"><label>3</label><institution-wrap><institution-id institution-id-type="GRID">grid.51462.34</institution-id><institution-id institution-id-type="ISNI">0000 0001 2171 9952</institution-id><institution>Center for Epigenetics Research, </institution><institution>Memorial Sloan Kettering Cancer Center, </institution></institution-wrap>New York, NY USA </aff>
      <aff id="Aff4"><label>4</label><institution-wrap><institution-id institution-id-type="GRID">grid.266100.3</institution-id><institution-id institution-id-type="ISNI">0000 0001 2107 4242</institution-id><institution>Bioinformatics Program, </institution><institution>University of California at San Diego, </institution></institution-wrap>San Diego, CA USA </aff>
    </contrib-group>
    <pub-date pub-type="epub">
      <day>7</day>
      <month>6</month>
      <year>2021</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>7</day>
      <month>6</month>
      <year>2021</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2021</year>
    </pub-date>
    <volume>12</volume>
    <elocation-id>3366</elocation-id>
    <history>
      <date date-type="received">
        <day>19</day>
        <month>10</month>
        <year>2020</year>
      </date>
      <date date-type="accepted">
        <day>14</day>
        <month>5</month>
        <year>2021</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2021</copyright-statement>
      <license>
        <ali:license_ref specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p><bold>Open Access</bold> This article is licensed under a Creative Commons Attribution 4.0 International License, which permits use, sharing, adaptation, distribution and reproduction in any medium or format, as long as you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons license, and indicate if changes were made. The images or other third party material in this article are included in the article’s Creative Commons license, unless indicated otherwise in a credit line to the material. If material is not included in the article’s Creative Commons license and your intended use is not permitted by statutory regulation or exceeds the permitted use, you will need to obtain permission directly from the copyright holder. To view a copy of this license, visit <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>.</license-p>
      </license>
    </permissions>
    <abstract id="Abs1">
      <p id="Par1">Recent genome-wide chromosome conformation capture assays such as Hi-C and HiChIP have vastly expanded the resolution and throughput with which we can study 3D genomic architecture and function. Here, we present HiC-DC+, a software tool for Hi-C/HiChIP interaction calling and differential analysis using an efficient implementation of the HiC-DC statistical framework. HiC-DC+ integrates with popular preprocessing and visualization tools and includes topologically associating domain (TAD) and A/B compartment callers. We found that HiC-DC+ can more accurately identify enhancer-promoter interactions in H3K27ac HiChIP, as validated by CRISPRi-FlowFISH experiments, compared to existing methods. Differential HiC-DC+ analyses of published HiChIP and Hi-C data sets in settings of cellular differentiation and cohesin perturbation systematically and quantitatively recovers biological findings, including enhancer hubs, TAD aggregation, and the relationship between promoter-enhancer loop dynamics and gene expression changes. HiC-DC+ therefore provides a principled statistical analysis tool to empower genome-wide studies of 3D chromatin architecture and function.</p>
    </abstract>
    <abstract id="Abs2" abstract-type="web-summary">
      <p id="Par2">The genome-wide investigation of chromatin organization enables insights into global gene expression control. Here, the authors present a computationally efficient method for the analysis of chromatin organization data and use it to recover principles of 3D organization across conditions.</p>
    </abstract>
    <kwd-group kwd-group-type="npg-subject">
      <title>Subject terms</title>
      <kwd>Chromosomes</kwd>
      <kwd>Software</kwd>
      <kwd>Statistical methods</kwd>
    </kwd-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">https://doi.org/10.13039/100000051</institution-id>
            <institution>U.S. Department of Health &amp; Human Services | NIH | National Human Genome Research Institute (NHGRI)</institution>
          </institution-wrap>
        </funding-source>
        <award-id>HG009395</award-id>
        <principal-award-recipient>
          <name>
            <surname>Leslie</surname>
            <given-names>Christina S.</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
    </funding-group>
    <custom-meta-group>
      <custom-meta>
        <meta-name>issue-copyright-statement</meta-name>
        <meta-value>© The Author(s) 2021</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec id="Sec1" sec-type="introduction">
    <title>Introduction</title>
    <p id="Par3">Recent years have seen major improvements in genome-wide chromosome conformation capture technologies to facilitate the generation of high-quality, high-resolution maps of 3D genomic interactions. These developments include streamlined, low-input protocols and commercially available kits for Hi-C as well as alternative genome-wide assays such as Micro-C<sup><xref ref-type="bibr" rid="CR1">1</xref>,<xref ref-type="bibr" rid="CR2">2</xref></sup> and HiCAR<sup><xref ref-type="bibr" rid="CR3">3</xref></sup> that improve recovery of shorter range and regulatory interactions. Meanwhile, multiple assays that enrich for specific classes of 3D interactions now allow high-resolution mapping of components of the 3D interactome with lower sequencing costs. In particular, HiChIP<sup><xref ref-type="bibr" rid="CR4">4</xref></sup> couples Hi-C with chromatin immunoprecipitation for a protein or histone mark of interest, and capture Hi-C<sup><xref ref-type="bibr" rid="CR5">5</xref></sup> uses an oligonucleotide probe library to enrich for interactions with specific loci. These advances in technology make possible the generation of high-resolution interaction data sets in multiple cell types, together with biological replicates, for studying changes in genomic architecture with cellular context and how 3D interaction changes are related to epigenomic and transcriptional changes.</p>
    <p id="Par4">However, high-resolution Hi-C, HiChIP, and other chromosome conformation capture data sets present many challenges for principled computational analysis and meaningful biological interpretation. First, these data sets are very large—~2B sequenced read pairs for “loop resolution” Hi-C maps and ~200M read pairs per replicate for HiChIP in human or mouse genomes—and therefore require considerable computational resources both for preprocessing to generate raw contact matrices and for downstream analyses. Second, while there are well-developed tools for visualization of Hi-C experiments (e.g., Juicebox<sup><xref ref-type="bibr" rid="CR6">6</xref></sup> and the HiCExplorer Python tool<sup><xref ref-type="bibr" rid="CR7">7</xref></sup>), there is no consensus on statistical methods for calling significant 3D interactions or for determining differential interactions between cell types, and published methods give highly discordant results. In particular, some well-established loop callers like HiCCUPS<sup><xref ref-type="bibr" rid="CR8">8</xref></sup> are very conservative and best suited for identifying cohesin- and CTCF-mediated structural loops rather than regulatory interactions, while other methods are extremely permissive, as we have described previously<sup><xref ref-type="bibr" rid="CR9">9</xref></sup>. Consequently, 3D genomic architecture studies sometimes lean on visualizations at specific loci at the expense of more comprehensive genome-wide analyses. Third, there are no “gold standard” data sets of validated 3D interactions, making it difficult to objectively benchmark Hi-C and HiChIP analysis tools. Finally, interpreting Hi-C data requires integrative analyses with 1D epigenomic data sets (chromatin accessibility, transcription factor, and histone mark ChIP-seq) and transcriptomic data that are informed by principles of gene regulation and chromatin biology, and these genome-wide integrative analyses remain challenging.</p>
    <p id="Par5">Here we present HiC-DC+ (Hi-C/HiChIP direct caller plus), a new Bioconductor package that enables principled statistical analysis of Hi-C and HiChIP data sets by building on the HiC-DC framework<sup><xref ref-type="bibr" rid="CR9">9</xref></sup>. HiC-DC+ includes an efficient and parallelizable implementation of the HiC-DC background model to scale to high-resolution contact matrices and call significant 3D interactions in Hi-C, Hi-ChIP, and related assays. Additionally, HiC-DC+ performs differential analysis between conditions given replicate experiments using appropriate differential read count statistics by combining distance-dependent library scaling factors with DESeq2<sup><xref ref-type="bibr" rid="CR10">10</xref></sup>. The package includes an implementation of A/B compartment and TAD callers to facilitate global integrative studies, and HiC-DC+ significant and differential interaction calls can be viewed with popular Hi-C visualization tools.</p>
    <p id="Par6">To address the difficulty of evaluating performance in the absence of gold standard benchmark data sets, we assembled a diverse collection of published Hi-C and HiChIP studies and defined biologically well-founded assessment metrics for method comparison. First, we found that HiC-DC+ outperforms other HiChIP interaction callers for the task of identifying H3K27ac HiChIP promoter-anchored interactions as validated by CRISPRi-FlowFISH<sup><xref ref-type="bibr" rid="CR11">11</xref></sup>. HiC-DC+ SMC1A HiChIP analysis also yields greater enrichment at subTAD boundaries than other methods. We next showed that differential Hi-C analysis by HiC-DC+ correctly recovers 3D architectural changes associated with knockout of the cohesin release factor WAPL<sup><xref ref-type="bibr" rid="CR12">12</xref></sup>, outperforming other differential tools at specific loci and in global assessments. Moreover, HiC-DC+ H3K27ac HiChIP differential analysis in mouse embryonic stem cells (mESCs) vs. mouse embryonic fibroblasts (MEFs) identifies experimentally validated mESC-specific enhancer hubs<sup><xref ref-type="bibr" rid="CR13">13</xref></sup>. Finally, we analyzed very high coverage Hi-C data from a study of THP-1 monocyte to macrophage differentiation that reported modest changes in 3D loops<sup><xref ref-type="bibr" rid="CR14">14</xref></sup>. Here, HiC-DC+ instead identifies widespread differential enhancer–promoter interactions that are associated with concordant gain or loss of H3K27ac-marked accessible elements and gene expression changes. Together, these analyses demonstrate the power of HiC-DC+ for systematic global analysis of 3D genomic interactions, including regulatory interactions, and biological interpretation.</p>
  </sec>
  <sec id="Sec2" sec-type="results">
    <title>Results</title>
    <sec id="Sec3">
      <title>HiC-DC+ enables systematic analysis of Hi-C and HiChIP data</title>
      <p id="Par7">HiC-DC+ estimates significant interactions in a Hi-C or HiChIP experiment directly from the raw contact matrix for each chromosome up to a specified genomic distance, binned by uniform genomic intervals or restriction enzyme (RE) fragments, by training a background model to account for random polymer ligation and systematic sources of read count variation. Similar to HiC-DC<sup><xref ref-type="bibr" rid="CR9">9</xref></sup>, HiC-DC+ uses negative binomial (NB) regression to estimate the expected read count in an interaction bin based on genomic distance and the GC content, mappability, and effective bin size based on RE sites in the corresponding pair of genomic intervals (Methods); genomic features derived from the set of RE recognition sites are provided as input to the model. As in HiC-DC and Fit-Hi-C<sup><xref ref-type="bibr" rid="CR15">15</xref></sup>, HiC-DC+ uses a two-step model fitting procedure to increase power (Methods). Given the higher coverage of current Hi-C and HiChIP experiments, by default HiC-DC+ does not use zero truncation in the background model, resulting in a somewhat simpler statistical model than in HiC-DC.</p>
      <p id="Par8">HiC-DC+ also enables differential analysis of Hi-C or HiChIP interactions between a pair of conditions, given replicate experiments. To do this, HiC-DC+ estimates genomic distance-dependent scaling factors from the data and uses DESeq2 to assess the significance of differential interactions (Methods). This approach is similar to the ACCOST method<sup><xref ref-type="bibr" rid="CR16">16</xref></sup> but exploits existing capabilities of DESeq2 to perform the statistical test.</p>
      <p id="Par9">The HiC-DC+ Bioconductor R package features major improvements over HiC-DC. First, HiC-DC+ has greater time and memory efficiency (Supplementary Tables <xref rid="MOESM1" ref-type="media">1</xref>–<xref rid="MOESM1" ref-type="media">5</xref>), which is required to process very deep (≥2B reads) data sets at high resolution. Second, HiC-DC+ supports standard Hi-C contact matrix file formats (.hic, .matrix, .allValidPairs) generated by HiC-Pro<sup><xref ref-type="bibr" rid="CR7">7</xref></sup> or Juicer<sup><xref ref-type="bibr" rid="CR17">17</xref></sup> as input (Fig. <xref rid="Fig1" ref-type="fig">1a</xref>). For convenience, the HiC-DC+ package also implements callers for topologically associating domains (TADs), through an implementation of the TopDom<sup><xref ref-type="bibr" rid="CR18">18</xref></sup> algorithm, and A/B compartments<sup><xref ref-type="bibr" rid="CR17">17</xref></sup>. The TAD caller can be run on contact matrices that have been normalized by HiC-DC+, namely observed/expected (O/E) counts or NB <italic>Z</italic>-score values (Fig. <xref rid="Fig1" ref-type="fig">1a</xref>, Methods), or by other methods such as ICE<sup><xref ref-type="bibr" rid="CR19">19</xref></sup>. In addition, the HiC-DC+ package offers flexible modeling options. The dependence on genomic distance can either be defined using splines as in HiC-DC or using power decay, covariates can be easily removed or new covariates added, and the background model for counts can be estimated using either hurdle or NB regression. Finally, in addition to the default constant dispersion model, HiC-DC+ implements a variable distance-dependent dispersion model within the GLM framework. While our benchmarking focuses on Hi-C and HiChIP, the flexibility of HiC-DC+ potentially enables applications to diverse chromatin capture data sets. For example, the variable dispersion option appeared to be useful for Micro-C, where the dispersion highly varies with distance, while the hurdle regression option seemed helpful for ChIA-PET (Supplementary Fig. <xref rid="MOESM1" ref-type="media">1a</xref>).<fig id="Fig1"><label>Fig. 1</label><caption><title>HiC-DC+ workflow and capabilities.</title><p><bold>a</bold> Overview of the HiC-DC+ pipeline. <bold>b</bold> Visualization of HiC-DC+ results in Juicer: FDR-corrected <italic>P</italic> values estimated by HiC-DC+ shown in the upper triangle heatmap, KR normalized counts in the bottom triangle, for SMC1A HiChIP in GM12878 (merged replicates of <ext-link ext-link-type="uri" xlink:href="https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSM2138324">GSM2138324</ext-link>, <ext-link ext-link-type="uri" xlink:href="https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSM2138325">GSM2138325</ext-link>, <ext-link ext-link-type="uri" xlink:href="https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSM2138326">GSM2138326</ext-link>, and <ext-link ext-link-type="uri" xlink:href="https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSM2138327">GSM2138327</ext-link>) at 5 kb resolution. <bold>c</bold> Visualization of HiC-DC+ differential interactions in HiCExplorer: HiC-DC+ <italic>Z</italic>-score normalized Hi-C counts in THP-1 monocytes and macrophages (<ext-link ext-link-type="uri" xlink:href="https://www.ncbi.nlm.nih.gov/bioproject/385337">PRJNA385337</ext-link>) at 5 kb resolution are shown as heatmaps, along with differential Hi-C interactions as arcs and H3K27ac (<ext-link ext-link-type="uri" xlink:href="https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSM2544236">GSM2544236</ext-link>, <ext-link ext-link-type="uri" xlink:href="https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSM2544237">GSM2544237</ext-link>, <ext-link ext-link-type="uri" xlink:href="https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSM2544238">GSM2544238</ext-link>, and <ext-link ext-link-type="uri" xlink:href="https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSM2544239">GSM2544239</ext-link>) and CTCF (<ext-link ext-link-type="uri" xlink:href="https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSM2544244">GSM2544244</ext-link>, <ext-link ext-link-type="uri" xlink:href="https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSM2544245">GSM2544245</ext-link>, <ext-link ext-link-type="uri" xlink:href="https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSM2544246">GSM2544246</ext-link>, and <ext-link ext-link-type="uri" xlink:href="https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSM2544247">GSM2544247</ext-link>) ChIP-seq and ATAC-seq (<ext-link ext-link-type="uri" xlink:href="https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSM2544216">GSM2544216</ext-link>, <ext-link ext-link-type="uri" xlink:href="https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSM2544217">GSM2544217</ext-link>, <ext-link ext-link-type="uri" xlink:href="https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSM2544220">GSM2544220</ext-link>, <ext-link ext-link-type="uri" xlink:href="https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSM2544221">GSM2544221</ext-link>, <ext-link ext-link-type="uri" xlink:href="https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSM2544224">GSM2544224</ext-link>, <ext-link ext-link-type="uri" xlink:href="https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSM2544225">GSM2544225</ext-link>, <ext-link ext-link-type="uri" xlink:href="https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSM2544228">GSM2544228</ext-link>, <ext-link ext-link-type="uri" xlink:href="https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSM2544229">GSM2544229</ext-link>, <ext-link ext-link-type="uri" xlink:href="https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSM2544218">GSM2544218</ext-link>, <ext-link ext-link-type="uri" xlink:href="https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSM2544219">GSM2544219</ext-link>, <ext-link ext-link-type="uri" xlink:href="https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSM2544222">GSM2544222</ext-link>, <ext-link ext-link-type="uri" xlink:href="https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSM2544223">GSM2544223</ext-link>, <ext-link ext-link-type="uri" xlink:href="https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSM2544226">GSM2544226</ext-link>, <ext-link ext-link-type="uri" xlink:href="https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSM2544227">GSM2544227</ext-link>, <ext-link ext-link-type="uri" xlink:href="https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSM2544230">GSM2544230</ext-link>, and <ext-link ext-link-type="uri" xlink:href="https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSM2544231"> GSM2544231</ext-link>) as signal tracks for a region encompassing the gene <italic>MAFB</italic>.</p></caption><graphic xlink:href="41467_2021_23749_Fig1_HTML" id="d32e591"/></fig></p>
      <p id="Par10">To visualize significant HiC-DC+ 3D interactions and differential loops, results from the package (FDR-corrected <italic>P</italic> values, or O/E or <italic>Z</italic>-score normalized counts in .hic file format) can be readily supplied to popular visualization tools such as Juicer<sup><xref ref-type="bibr" rid="CR17">17</xref></sup> and HiCExplorer<sup><xref ref-type="bibr" rid="CR7">7</xref></sup>. For example, Fig. <xref rid="Fig1" ref-type="fig">1b</xref> shows the results of HiC-DC+ analysis of a SMC1A HiChIP data set in the GM12878 lymphoblastoid cell line<sup><xref ref-type="bibr" rid="CR4">4</xref>,<xref ref-type="bibr" rid="CR8">8</xref></sup> in a 1.2 Mb region of chr 6 using Juicer, with KR normalized count data below the diagonal and significant interactions at FDR &lt; 0.05 above the diagonal. HiCExplorer is useful for visualizing HiC-DC+ normalized contact matrices in triangular format and significant interactions as arcs, alongside other genomic tracks. In Fig. <xref rid="Fig1" ref-type="fig">1c</xref>, HiC-DC+ <italic>Z</italic>-score normalized Hi-C data in untreated and PMA-treated THP-1 cells<sup><xref ref-type="bibr" rid="CR14">14</xref></sup> are shown at a 1 Mb region encompassing <italic>MAFB</italic>, an important regulator of monocyte to macrophage differentiation, together with HiC-DC+ differentially gained enhancer–promoter interactions and signal tracks for ATAC-seq, H3K27ac, and CTCF ChIP-seq.</p>
      <p id="Par11">We used interactions called from pooled replicates for most of our benchmarking case studies; however, we also tested the robustness of our significant interactions. In the THP-1 Hi-C data set as well as in mESC H3K27ac HiChIP data<sup><xref ref-type="bibr" rid="CR4">4</xref></sup>, scatter plots of −log10(<italic>P</italic>) and <italic>Z</italic>-scores for each pair of replicates show that the significance of interactions is in high agreement between replicates, suggesting strong reproducibility of results for Hi-C and HiChIP (Supplementary Fig. <xref rid="MOESM1" ref-type="media">2</xref>). We also checked the consistency of HiC-DC+ interactions at different bin resolutions and found ~80% of interactions called at 5, 25, and 50 kb also as significant at 10, 50, and 100 kb, respectively, in THP-1 monocytes and macrophages (Supplementary Fig. <xref rid="MOESM1" ref-type="media">3</xref>).</p>
    </sec>
    <sec id="Sec4">
      <title>HiC-DC+ detects enhancer–promoter interactions from HiChIP</title>
      <p id="Par12">HiChIP enriches for 3D interactions associated with a protein or histone modification of interest by applying ChIP to the contact library after nuclear lysis<sup><xref ref-type="bibr" rid="CR4">4</xref></sup>. The HiC-DC+ statistical model proved to be well suited for HiChIP analysis without requiring any additional covariates, such as signal from a parallel ChIP-seq experiment or HiChIP self-ligation read counts, which have been used to mimic the ChIP-seq signal<sup><xref ref-type="bibr" rid="CR4">4</xref></sup>. Since HiC-DC+ covariates such as GC content and mappability account for sources of systematic biases in high-throughput sequencing, we may already be implicitly modeling a component of ChIP bias. By contrast, some existing HiChIP analysis methods like hichipper<sup><xref ref-type="bibr" rid="CR20">20</xref></sup> and FitHiChIP<sup><xref ref-type="bibr" rid="CR21">21</xref></sup> indeed attempt to call genomic peaks directly from HiChIP or use a parallel ChIP-seq experiment as a step in their modeling.</p>
      <p id="Par13">To benchmark HiC-DC+ on HiChIP, we ran the model on existing H3K27ac HiChIP in K562 cells<sup><xref ref-type="bibr" rid="CR4">4</xref></sup> at 5 kb resolution and assessed using recently generated CRISPRi-FlowFISH data for 22 genes<sup><xref ref-type="bibr" rid="CR11">11</xref></sup> (Methods). CRISPRi-FlowFISH quantifies enhancer function in terms of the estimated log fold change of target gene expression due to enhancer inactivation by using a pooled CRISPRi screen against candidate enhancers and sorting cells using RNA fluorescence in situ hybridization (FISH) against the target gene. We reasoned that a successful H3K27ac HiChIP analysis pipeline should identify significant loops between the target gene promoter and FlowFISH-validated accessible sites, and rank these loops above interactions between the target promoter and accessible sites with insignificant FlowFISH effect.</p>
      <p id="Par14">Therefore, we ranked candidate interactions at 5 kb between the target promoter and each tested regulatory element by HiC-DC+ <italic>P</italic> value. Similarly, we ranked candidate interactions using three other published methods: FitHiChIP<sup><xref ref-type="bibr" rid="CR21">21</xref></sup>, an adaptation of Fit-Hi-C for HiChIP (using the loose background model(L)); MAPS<sup><xref ref-type="bibr" rid="CR22">22</xref></sup>, another approach based on fitting a generalized linear model to estimate a background distribution; and hichipper<sup><xref ref-type="bibr" rid="CR20">20</xref></sup>, a method that models the background read density in terms of proximity to RE sites. When we evaluated performance per target gene by auPR (area under the precision-recall curve), HiC-DC+ outperformed hichipper and MAPS (Fig. <xref rid="Fig2" ref-type="fig">2a</xref>, <italic>P</italic> &lt; 0.01, signed rank test). Although per gene auPR was not significantly different between HiC-DC+ and FitHiChIP (<italic>P</italic> = 0.15, signed rank test), HiC-DC+ had a higher median per gene auPR (0.307 for HiC-DC+ vs 0.245 for FitHiChIP); HiC-DC+ also significantly outperformed other model variants of FitHiChIP (Supplementary Fig. <xref rid="MOESM1" ref-type="media">4, <italic>P</italic></xref> &lt; 0.01, signed rank test). Moreover, when we examined the predicted interactions at FDR &lt; 0.01 across all genes for each method, we found that HiC-DC+ was most successful in identifying promoter–enhancer loops of enhancers with large effect size on target gene expression as assessed by CRISPRi-FlowFISH (Fig. <xref rid="Fig2" ref-type="fig">2b</xref>, <italic>P</italic> &lt; 0.011 for FitHiChIP, <italic>P</italic> &lt; 0.005 for MAPS, and <italic>P</italic> &lt; 0.001 for hichipper, rank sum test).<fig id="Fig2"><label>Fig. 2</label><caption><title>HiC-DC+ accurately identifies enhancer–promoter interactions from H3K27ac HiChIP.</title><p><bold>a</bold> Evaluation of method performance by per gene auPR values. For each target gene, we ranked the candidate regulatory elements tested by CRISPRi-FlowFISH in K562 cells<sup><xref ref-type="bibr" rid="CR11">11</xref></sup> based on the significance (<italic>P</italic> value) of corresponding 5 kb HiChIP interactions (merged replicates of <ext-link ext-link-type="uri" xlink:href="https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSM2705043">GSM2705043</ext-link>, <ext-link ext-link-type="uri" xlink:href="https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSM2705044">GSM2705044</ext-link>, and <ext-link ext-link-type="uri" xlink:href="https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSM2705045">GSM2705045</ext-link>) with the target promoter as estimated by each method (<italic>n</italic> = 22 genes; Methods). Centers of the boxes indicate median values, the lower and upper hinges correspond to the first and third quartiles and the upper (lower) whiskers extend from the hinge to the largest (smallest) value no further than 1.5 times the distance between the first and third quartiles. <bold>b</bold> Comparison of performance for identifying promoter–enhancer loops with large effect sizes on target gene expression as assessed by CRISPRi-FlowFISH. Each dot in the scatterplots represents one tested promoter–enhancer pair: true positives resulting in decreased target gene expression upon enhancer inactivation are shown in red, true positives resulting in increased target gene expression shown in blue, false positives in gray. <bold>c</bold> Promoter–enhancer loops identified by HiC-DC+ and FitHiChIP (FDR &lt;0.01) are shown as arcs for <italic>PLP2</italic> gene, along with all candidate enhancers tested by CRISPRi-FlowFISH<sup><xref ref-type="bibr" rid="CR11">11</xref></sup> and signal tracks for K562 DNase-seq (<ext-link ext-link-type="uri" xlink:href="https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSM816655">GSM816655</ext-link>) and H3K27ac ChIP-seq (<ext-link ext-link-type="uri" xlink:href="https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSM733656">GSM733656</ext-link>). <bold>d</bold> Promoter–enhancer loops identified by HiC-DC+ and FitHiChIP (FDR &lt; 10<sup>−7</sup>) are shown as arcs for <italic>FTL</italic> gene, along with all candidate enhancers tested by CRISPRi-FlowFISH and K562 DNase-seq and H3K27ac ChIP-seq signal tracks.</p></caption><graphic xlink:href="41467_2021_23749_Fig2_HTML" id="d32e797"/></fig></p>
      <p id="Par15">While FitHiChIP was the runner-up in terms of overall auPR (Supplementary Fig. <xref rid="MOESM1" ref-type="media">5a</xref>, 0.180 for FitHiChIP vs. 0.205 for HiC-DC+), suggesting a reasonable ranking of promoter-to-candidate–enhancer interactions, it called many more interactions than HiC-DC+ at a fixed FDR &lt;0.01 threshold, suggesting that its <italic>P</italic> values may be somewhat inflated. Indeed, at the <italic>PLP2</italic> and <italic>FTL</italic> loci (Fig. <xref rid="Fig2" ref-type="fig">2c, d</xref>), FitHiChIP identifies both positive and negative enhancers but generates a large number of false positive interactions, whereas HiC-DC+ identifies significant interactions that coincide with positive enhancers and H3K27ac peaks. We further compared the performance of HiC-DC+ and FitHiChIP on mESC H3K27ac HiChIP<sup><xref ref-type="bibr" rid="CR4">4</xref></sup> based on CRISPRi-validated enhancer–promoter pairs in mESC<sup><xref ref-type="bibr" rid="CR11">11</xref></sup> and found that HiC-DC+ was more successful in identifying promoter–enhancer loops of enhancers with large effect size on target gene expression (Supplementary Fig. <xref rid="MOESM1" ref-type="media">6</xref>, overall auPR of 0.54 for HiC-DC+ vs. 0.29 for FitHiChIP(L)).</p>
      <p id="Par16">We also generated aggregate peak analysis (APA) plots using HiChIP interactions unique to HiC-DC+ and to FitHiChIP and found that interactions exclusive to HiC-DC+ had higher APA scores (Methods, Supplementary Fig. <xref rid="MOESM1" ref-type="media">7</xref>, <xref rid="MOESM1" ref-type="media">1</xref>.28 vs. 1.16 for K562 H3K27ac HiChIP, 3.29 vs. 1.45 for mESC H3K27ac HiChIP).</p>
      <p id="Par17">Finally, we sought to directly address the issue of whether it is preferable to normalize for ChIP-seq bias in HiChIP analysis, or conversely whether explicitly incorporating ChIP signal in the model normalizes away the true signal and decreases power. At least in the context of H3K27ac HiChIP analysis for the detection of functional regulatory interactions, we found the latter to be the case. We incorporated parallel H3K27ac ChIP-seq signal in K562 cells either as a continuous or a categorical covariate in the HiC-DC+ model in several ways, analogous to other methods (Supplementary Note 1). In all cases, we found that normalization for ChIP bias decreased performance for detection of functional promoter–enhancer interactions as validated by CRISPRi-FlowFISH (Supplementary Fig. <xref rid="MOESM1" ref-type="media">8</xref>). Moreover, the performance advantage of HiC-DC+ over FitHiChIP cannot be attributed to stronger H3K27ac ChIP enrichment in HiC-DC+ HiChIP interactions. Indeed, for high confidence interactions (recall ≤ 2) of each method in the CRISPRi-FlowFISH candidate set, there was no significant difference in ChIP signal between HiC-DC+ and FitHiChIP, and for lower confidence interactions (recall &gt; 0.2) where FitHiChIP outperforms HiC-DC+ in precision (Supplementary Fig. <xref rid="MOESM1" ref-type="media">5</xref>), FitHiChIP interactions overlapping the candidate pairs actually had slightly but significantly higher ChIP signal than HiC-DC+ interactions (Supplementary Fig. <xref rid="MOESM1" ref-type="media">9</xref>). Furthermore, we found that top 100,000 interactions identified by HiC-DC+ had lower average normalized ChIP signal levels in both anchors compared to FitHiChIP (Supplementary Fig. <xref rid="MOESM1" ref-type="media">10</xref>).</p>
      <p id="Par18">Despite evidence that promoter–enhancer interactions identified by CRISPRi-FlowFISH are enriched for shorter range interactions that are detectable by H3K27ac signal and accessibility alone (Supplementary Note 2 and Supplementary Fig. <xref rid="MOESM1" ref-type="media">11</xref>), enhancer screening data provides a useful benchmark data set for comparing HiChIP interaction callers.</p>
    </sec>
    <sec id="Sec5">
      <title>HiC-DC+ accurately identifies cohesin-mediated loops</title>
      <p id="Par19">As a second test case, we benchmarked HiC-DC+ and existing HiChIP interaction callers on published HiChIP data for SMC1A, a subunit of the cohesin complex, in GM12878<sup><xref ref-type="bibr" rid="CR4">4</xref></sup>. The other HiChIP interaction calling methods identified vastly different numbers of significant cohesin-mediated loops at 5 kb resolution with genome-wide FDR &lt; 0.01 (Supplementary Table <xref rid="MOESM1" ref-type="media">6</xref>). When we restricted to loops whose anchors both contained CTCF motifs, a majority of such loops (75–84%) for all methods except hichipper (49%) were associated with a pair of convergently oriented motifs (Supplementary Fig. <xref rid="MOESM1" ref-type="media">12</xref>). We also examined the enrichment of significant interactions from each method at the boundaries of previously reported subTADs in GM12878 based on Hi-C analysis<sup><xref ref-type="bibr" rid="CR8">8</xref></sup>. We found that HiC-DC+ interactions were most highly enriched at subTAD boundaries, with FitHiChIP as runner-up (Supplementary Figs. <xref rid="MOESM1" ref-type="media">13</xref>, <xref rid="MOESM1" ref-type="media">14</xref>). We alternatively used HiCCUPS loops on Hi-C data in GM12878 as the ground truth and found that detection of these loops by SMC1A HiChIP in GM12878 without modeling ChIP bias gives very similar performance to FitHiChIP with modeling ChIP bias (Supplementary Fig. <xref rid="MOESM1" ref-type="media">15</xref>).</p>
    </sec>
    <sec id="Sec6">
      <title>Differential Hi-C analysis recovers TAD aggregation</title>
      <p id="Par20">To call differential Hi-C and HiChIP interactions between a pair of conditions, we estimate distance dependent DESeq2 size factors so that the median normalized count for pairs of bins at each given distance in each matrix is the same (Methods). We first pool all replicates to call significant interactions for each cell type and assemble an atlas of significant 3D interactions, and then we use count data from replicates in DESeq2 to find differential interactions. Dispersion and MA plots behave as expected, suggesting that our normalization works appropriately (Supplementary Fig. <xref rid="MOESM1" ref-type="media">16</xref>). We tested the reproducibility of HiC-DC+ differential interactions using Hi-C data with four replicates in mESC and neural precursor cells (NPC)<sup><xref ref-type="bibr" rid="CR23">23</xref></sup> and called differential interactions between mESC and NPC using all three replicates (123), and all pairwise combinations of replicates (12, 13, and 23). We found that only about 10% of differential interactions called using two replicates at a time are exclusive to individual pairs, suggesting high reproducibility of differential interactions (Supplementary Fig. <xref rid="MOESM1" ref-type="media">17</xref>). As expected, using all three replicates gave more power to detect interactions than any pair of replicates.</p>
      <p id="Par21">To benchmark our differential Hi-C interactions against diffHic<sup><xref ref-type="bibr" rid="CR24">24</xref></sup>, multiHiCcompare<sup><xref ref-type="bibr" rid="CR25">25</xref></sup>, and Selfish<sup><xref ref-type="bibr" rid="CR26">26</xref></sup>, we ran HiC-DC+ and other tools on Hi-C data in HAP1 and WAPL knockout HAP1 cells at 25 kb resolution<sup><xref ref-type="bibr" rid="CR12">12</xref></sup>. Haarhuis et al. showed that removing WAPL affects chromosome topology on a global scale through the formation of longer loops and strongly increased interaction frequencies between nearby TADs<sup><xref ref-type="bibr" rid="CR12">12</xref></sup>. In particular, they highlighted three genomic regions to show accumulation of contacts at TAD corners (Fig. <xref rid="Fig3" ref-type="fig">3a</xref>, top row) and loop extension linked to TAD aggregation (Fig. <xref rid="Fig3" ref-type="fig">3a</xref>, middle and bottom rows) upon WAPL loss. HiC-DC+ can detect these enriched loops more effectively than other methods at FDR &lt;0.05. Other methods also call at least two times more significant interactions than HiC-DC+, suggesting <italic>P</italic> value inflation (Supplementary Fig. <xref rid="MOESM1" ref-type="media">18</xref>). The loop lengths of differential interactions with HiC-DC+ span a wide range, while other methods appear biased towards short- or long-range interactions (Supplementary Fig. <xref rid="MOESM1" ref-type="media">19</xref>). In addition, differential interactions that are unique to HiC-DC+ have higher APA scores than those unique to other methods tested, suggesting that HiC-DC+ differential interactions are highly enriched in Hi-C contacts (Methods, Supplementary Figs. <xref rid="MOESM1" ref-type="media">20</xref>, <xref rid="MOESM1" ref-type="media">21</xref>, and <xref rid="MOESM1" ref-type="media">22</xref>).<fig id="Fig3"><label>Fig. 3</label><caption><title>HiC-DC+ differential Hi-C and HiChIP analysis validates global chromatin folding changes during cohesin perturbation and cellular differentiation.</title><p><bold>a</bold> ICE-normalized Hi-C counts for HAP1 WT (lower triangle) (merged replicates of <ext-link ext-link-type="uri" xlink:href="https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE74072">GSE74072</ext-link>) and HAP1 WAPL knockout (upper triangle) (merged replicates of <ext-link ext-link-type="uri" xlink:href="https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSM2515800">GSM2515800</ext-link>, <ext-link ext-link-type="uri" xlink:href="https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSM2515801">GSM2515801</ext-link>, and <ext-link ext-link-type="uri" xlink:href="https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSM2515802">GSM2515802</ext-link>) at 10 kb resolution were visualized for three genomic regions highlighted in Haarhuis et al., 2017<sup><xref ref-type="bibr" rid="CR12">12</xref></sup>. For each of these regions, differential Hi-C interactions between <italic>ΔWAPL</italic> knockout vs. WT cells identified by each method at 25 kb resolution are shown as blue squares. <bold>b</bold> Differential interaction analysis between each TAD and its five flanking TADs. The barplots show the number of differential interactions in <italic>ΔWAPL</italic> vs wild type belonging to each category as identified by each method at FDR &lt; 0.05. <bold>c</bold> HiC-DC+ mESC-specific H3K27ac HiChIP (replicates of <ext-link ext-link-type="uri" xlink:href="https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSM3103921">GSM3103921</ext-link>, <ext-link ext-link-type="uri" xlink:href="https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSM3103922">GSM3103922</ext-link>, <ext-link ext-link-type="uri" xlink:href="https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSM3103923">GSM3103923</ext-link>, and <ext-link ext-link-type="uri" xlink:href="https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSM3103924">GSM3103924</ext-link>) interactions recover the <italic>Tbx3</italic> enhancer hub with <italic>Aw545942</italic>, <italic>Gm16063</italic>, and <italic>Tbx3</italic> genes at 5 kb resolution, all validated targets from Di Giammartino et al., 2019. Black and red triangles show the TADs called in mESC Hi-C (merged replicates of <ext-link ext-link-type="uri" xlink:href="https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSM2533818">GSM2533818</ext-link>, <ext-link ext-link-type="uri" xlink:href="https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSM2533819">GSM2533819</ext-link>, <ext-link ext-link-type="uri" xlink:href="https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSM2533820">GSM2533820</ext-link>, and <ext-link ext-link-type="uri" xlink:href="https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSM2533821">GSM2533821</ext-link>). <bold>d</bold> Distribution of log fold changes of statistically significant looping events identified by HiC-DC+ and modified Juicer (Phanstiel et al., 2017) as a function of genomic distance (log scale). <bold>e</bold> Log fold changes of Hi-C interactions (<ext-link ext-link-type="uri" xlink:href="https://www.ncbi.nlm.nih.gov/bioproject/385337">PJNA385337</ext-link>) and gene expression (<ext-link ext-link-type="uri" xlink:href="https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSM2599707">GSM2599707</ext-link>, <ext-link ext-link-type="uri" xlink:href="https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSM2599708">GSM2599708</ext-link>, <ext-link ext-link-type="uri" xlink:href="https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSM2599709">GSM2599709</ext-link>, and <ext-link ext-link-type="uri" xlink:href="https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSM2599710">GSM2599710</ext-link>) between THP-1 macrophages vs. monocytes. Each dot in the Hi-C plot represents an interaction between the promoter of a differentially expressed gene and a putative enhancer (Methods), while each dot in the RNA-seq plot represents a differentially expressed gene. <bold>f</bold>. Log fold changes of H3K27ac ChIP-seq (<ext-link ext-link-type="uri" xlink:href="https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSM2544236">GSM2544236</ext-link>, <ext-link ext-link-type="uri" xlink:href="https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSM2544237">GSM2544237</ext-link>, <ext-link ext-link-type="uri" xlink:href="https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSM2544238">GSM2544238</ext-link>, and <ext-link ext-link-type="uri" xlink:href="https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSM2544239">GSM2544239</ext-link>) and ATAC-seq (<ext-link ext-link-type="uri" xlink:href="https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSM2544216">GSM2544216</ext-link>, <ext-link ext-link-type="uri" xlink:href="https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSM2544217">GSM2544217</ext-link>, <ext-link ext-link-type="uri" xlink:href="https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSM2544220">GSM2544220</ext-link>, <ext-link ext-link-type="uri" xlink:href="https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSM2544221">GSM2544221</ext-link>, <ext-link ext-link-type="uri" xlink:href="https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSM2544224">GSM2544224</ext-link>, <ext-link ext-link-type="uri" xlink:href="https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSM2544225">GSM2544225</ext-link>, <ext-link ext-link-type="uri" xlink:href="https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSM2544228">GSM2544228</ext-link>, <ext-link ext-link-type="uri" xlink:href="https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSM2544229">GSM2544229</ext-link>, <ext-link ext-link-type="uri" xlink:href="https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSM2544218">GSM2544218</ext-link>, <ext-link ext-link-type="uri" xlink:href="https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSM2544219">GSM2544219</ext-link>, <ext-link ext-link-type="uri" xlink:href="https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSM2544222">GSM2544222</ext-link>, <ext-link ext-link-type="uri" xlink:href="https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSM2544223">GSM2544223</ext-link>, <ext-link ext-link-type="uri" xlink:href="https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSM2544226">GSM2544226</ext-link>, <ext-link ext-link-type="uri" xlink:href="https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSM2544227">GSM2544227</ext-link>, <ext-link ext-link-type="uri" xlink:href="https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSM2544230">GSM2544230</ext-link>, and <ext-link ext-link-type="uri" xlink:href="https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSM2544231">GSM2544231</ext-link>) signal between THP-1 macrophages vs. monocytes at enhancer anchors of the differential promoter–enhancer loops identified by HiC-DC+ at 5 kb resolution. Each dot represents a putative enhancer.</p></caption><graphic xlink:href="41467_2021_23749_Fig3_HTML" id="d32e1188"/></fig></p>
      <p id="Par22">We also performed contact frequency analysis between each TAD and its five flanking TADs to assess whether differential interaction analysis can reveal the TAD aggregation upon WAPL deficiency. We plotted the number of differential interactions identified by each method at FDR &lt; 0.05 that are lost or gained in <italic>ΔWAPL</italic> vs wild type (Fig. <xref rid="Fig3" ref-type="fig">3b</xref>). Haarhuis et al. claimed that WAPL deficiency mediated gains in interactions at the corners of TADs and loss of intra-TAD interactions. Of the methods tested, HiC-DC+ and Selfish recovered both findings: a majority of gained interactions connected neighboring TADs together with a drastic loss of intra-TAD interactions. However, Selfish was not able to find differential interactions at the three highlighted loci in Fig. <xref rid="Fig3" ref-type="fig">3a</xref>.</p>
    </sec>
    <sec id="Sec7">
      <title>Differential HiChIP analysis identifies enhancer hubs</title>
      <p id="Par23">To evaluate differential HiChIP interactions, we examined H3K27ac HiChIP data from Di Giammartino et al.<sup><xref ref-type="bibr" rid="CR13">13</xref></sup> This study mapped high-resolution regulatory loops in MEF and mESC and discovered enhancer hubs, defined as sets of highly connected enhancers interacting with cell-type-specific genes. Further, they disrupted KLF binding motifs within mESC enhancer hubs using CRISPR-Cas9 to test the hypothesis that enhancer hubs coordinate the expression of pluripotency-associated genes. Inactivation of enhancer hubs resulted in coordinated downregulation of all connected genes without affecting the neighboring non-hub genes in mESC. We used HiC-DC+ differential HiChIP analysis to identify mESC-specific enhancer hubs that are lost in MEF. HiC-DC+ detected mESC-specific interactions of the <italic>Tbx3</italic> enhancer hub with <italic>Aw545942</italic>, <italic>Gm16063</italic>, and <italic>Tbx3</italic> genes, all validated target genes; consistent with validation experiments, HiC-DC+ did not find a differential interaction with <italic>Med13l</italic>, whose expression is not affected by inactivation of this hub (Fig. <xref rid="Fig3" ref-type="fig">3c</xref>). HiC-DC+ also captured increased interaction of <italic>Zfp42</italic> enhancer hub with <italic>Zfp42</italic> and <italic>Triml2</italic> genes in mESC (Supplementary Fig. <xref rid="MOESM1" ref-type="media">23</xref>). Notably, another differential HiChIP interaction tool, diffloop<sup><xref ref-type="bibr" rid="CR27">27</xref></sup>, could not detect any differential interactions comprising these two hubs.</p>
    </sec>
    <sec id="Sec8">
      <title>Differential HiChIP interactions are not due to ChIP bias</title>
      <p id="Par24">One concern that has been raised in differential HiChIP analysis is whether detected cell-type specific events can arise due to differential ChIP signal alone rather than a true change in the underlying 3D interaction<sup><xref ref-type="bibr" rid="CR21">21</xref></sup>. Two problematic scenarios have been proposed: first, that the differential HiChIP interaction might arise purely due to bias from differential ChIP signal in one cell type; or second, that there is a stable 3D interaction across both cell types with a gain or loss in ChIP signal, altering the biological interpretation of the event. These scenarios have been put forward as motivation to use parallel ChIP-seq signal, or HiChIP self-ligation signal as a proxy for ChIP, to normalize or at least annotate HiChIP interactions<sup><xref ref-type="bibr" rid="CR20">20</xref>,<xref ref-type="bibr" rid="CR21">21</xref></sup>.</p>
      <p id="Par25">To address these concerns, at least in the context of regulatory interactions and H3K27ac HiChIP analysis, we analyzed HiC-DC+ differential analysis results for two ENCODE cell lines, GM12878 and K562) in the context of parallel Hi-C and H3K27ac ChIP-seq data (Supplementary Note 3).</p>
      <p id="Par26">We found that a majority of all differential HiChIP interactions called by HiC-DC+—with no normalization for ChIP—were in fact supported by a concordant change in Hi-C signal (58%, <italic>n</italic> = 269,995) or in ChIP-seq signal at one or both anchors (70%, <italic>n</italic> = 327,437) or concordant changes in both Hi-C and ChIP-seq signals (42%, <italic>n</italic> = 199,029) (Supplementary Fig. <xref rid="MOESM1" ref-type="media">24</xref>). Most of the differential HiChIP interactions with a concordant change in ChIP-seq signal also exhibit a concordant change in Hi-C signal (61%), suggesting that the gain/loss of the ChIP signal most often happens simultaneously with change in the underlying 3D interaction, confounding the notion of normalizing for ChIP bias in HiChIP analysis.</p>
      <p id="Par27">We also identified differential HiChIP interactions with concordant differential ChIP signal in one of the anchors but only a small change in Hi-C signal (27%, <italic>n</italic> = 128,408 of all differential HiChIP interactions). We hypothesized that these differential interactions included real enhancer–promoter interactions that are not captured with high sensitivity in Hi-C. Indeed, we found that differential HiChIP interactions linked to a promoter in one anchor with small changes in Hi-C but substantial changes in ChIP intensity in the other anchor are depleted in significant Hi-C interactions (odds ratio = 0.71, <italic>P</italic> &lt; 1.0 × 10<sup>−16</sup>, Fisher’s exact test) but enriched in differentially expressed genes (odds ratio = 1.11, <italic>P</italic> &lt; 7 × 10<sup>−3</sup>, Fisher’s exact test) compared to other promoter-anchored HiChIP interactions, suggesting that Hi-C lacked the sensitivity to detect these promoter-anchored interactions in either cell type, at least at the sequencing depth of the available experiments (Supplementary Fig. 25).</p>
      <p id="Par28">Therefore, we did not find strong evidence of differential HiChIP interactions arising as an artifact due to differential ChIP bias, or even of differential HiChIP interactions associated with a stable 3D interaction and differential ChIP. While we cannot exclude these possibilities, our systematic analysis suggests that HiChIP normalization by ChIP-seq may not be helpful and supports the validity of HiC-DC+ differential HiChIP interactions, at least in the context of H3K27ac HiChIP analysis.</p>
    </sec>
    <sec id="Sec9">
      <title>Differential HiC-DC+ interactions link to expression changes</title>
      <p id="Par29">Finally, to demonstrate the value of HiC-DC+’s rigorous differential analysis, we reanalyzed very high resolution in situ Hi-C data from the THP-1 cell line model of monocyte to macrophage differentiation, together with epigenomic and transcriptomic data sets, to relate chromatin dynamics to gene expression changes<sup><xref ref-type="bibr" rid="CR14">14</xref></sup>.</p>
      <p id="Par30">The original study used Juicer (HiCCUPS) to call interactions and adapted DESeq2 for differential interaction analysis but identified only 217 differential looping events genome-wide at a 10 kb resolution (nominal <italic>P</italic> &lt; 0.001). This modest number led the authors to propose a model where macrophage-specific genes are upregulated through activation of preexisting DNA loops together with a smaller number of gained loops. By contrast, HiC-DC+ identified 64,844 differential interaction events at 10 kb resolution (adjusted <italic>P</italic> &lt; 0.01). Of the original differential loop calls, 169 were also called by HiC-DC+ (FDR &lt; 0.01) and 147 of these were found to be differential (adjusted <italic>P</italic> &lt; 0.01). Indeed, we found that HiC-DC+ identified more differential interaction events at every genomic distance, and these differential interactions exhibited stronger effect sizes than those in the original study (Fig. <xref rid="Fig3" ref-type="fig">3d</xref>). These results suggest that Juicer is not only too conservative in calling loops but also preferentially identifies loops that exhibit little dynamic behavior. Therefore, we revisited the association of regulatory loop dynamics and gene expression changes.</p>
      <p id="Par31">We reran HiC-DC+ at 5 kb resolution in order to more precisely identify potentially regulatory interactions and found 25,691 differential events (adjusted <italic>P</italic> &lt; 0.05). We next considered differentially expressed genes between THP-1 monocyte and macrophages (FDR &lt; 0.05) and found that 1673 (out of 6782) had at least one promoter-anchored differential interaction. Strikingly, upregulated genes were associated with gained/strengthened promoter-anchored interactions, while downregulated genes were associated with lost/weakened promoter-anchored interactions. Moreover, differential promoter-anchored interactions at upregulated genes tended to be shorter range (median genomic distance 135 kb), while those at downregulated genes were longer range (Supplementary Fig. <xref rid="MOESM1" ref-type="media">26a, b</xref> median genomic distance 185 kb). GO enrichment for genes with differential promoter-anchored interactions identified functional annotations associated to monocyte to macrophage differentiation (Supplementary Fig. <xref rid="MOESM1" ref-type="media">27</xref>). These results all suggest that gain or loss of promoter-anchored interactions lead respectively to up- or downregulation of gene expression in monocyte to macrophage differentiation, presumably through differential connections to enhancers.</p>
      <p id="Par32">To investigate whether differential promoter-anchored interactions indeed include promoter–enhancer events, we next constructed an atlas of enhancers using ATAC-seq peaks that overlap with H3K27ac ChIP-seq peaks as a proxy for active enhancer elements (Methods). We then restricted analysis to looping events between enhancers in the atlas and promoters (Fig. <xref rid="Fig3" ref-type="fig">3e</xref>). Upregulated genes were associated with gained/strengthened promoter–enhancer interactions, while almost all lost/weakened promoter–enhancer interactions were associated with genes with no significant expression change or those that were significantly downregulated. Further, H3K27ac ChIP-seq and ATAC-seq changes at the interacting enhancer elements correlated with expression changes of the target gene, while weaker changes in ATAC and H3K27ac signal were observed at the promoter (Fig. <xref rid="Fig3" ref-type="fig">3e, f</xref> and Supplementary Fig. <xref rid="MOESM1" ref-type="media">28</xref>). Interestingly, CTCF changes at those promoter anchors were strongly associated with the changes in gene expression, although the enhancer sites displayed at best weakly concordant changes in ATAC-seq or CTCF ChIP-seq signal (Supplementary Fig. <xref rid="MOESM1" ref-type="media">28</xref>). Phanstiel et al. identified multiple gained loops at the <italic>MAFB</italic> locus, and HiC-DC+ analysis also found many enhancer–promoter interactions for <italic>MAFB</italic> (Fig. <xref rid="Fig1" ref-type="fig">1c</xref>). We also recovered additional genes with previously unidentified differential looping events such as <italic>GALNT4</italic>, a gene involved in the mucin glycosylation pathway (Supplementary Fig. <xref rid="MOESM1" ref-type="media">29</xref>).</p>
    </sec>
  </sec>
  <sec id="Sec10" sec-type="discussion">
    <title>Discussion</title>
    <p id="Par33">We have shown that HiC-DC+ facilitates genome-wide analyses of Hi-C and HiChIP data sets and integration with 1D epigenomic and transcriptomic data, recovering previous biological findings in a systematic and global fashion while enabling new insights on the role of 3D genomic architecture in gene regulation. Therefore, HiC-DC+ addresses an important gap in currently available tools for 3D interaction calls and differential analysis and can enable advances in genome-wide understanding of chromatin architecture and dynamics. As the HiC-DC+ package offers flexibility in feature and statistical model definition (options to use NB or hurdle regression, constant or distance-dependent variable dispersion) along with substantially improved efficiency, it has the potential to be applied to a wide range of chromatin capture data sets. For example, we tested HiC-DC+ on Micro-C and CTCF ChIA-PET data sets utilizing NB regression with variable dispersion at 5 kb for Micro-C and hurdle regression at 10 kb for ChIA-PET. Our initial analyses show high overlap with HiCCUPS loops for both CTCF ChIA-PET and Micro-C, suggesting promising results for future exploration (Supplementary Fig. <xref rid="MOESM1" ref-type="media">1</xref>).</p>
    <p id="Par34">One contribution of our study is the development of benchmark datasets and analysis tasks to assess the performance of significant and differential 3D interaction callers. For example, we used enhancer screening results from CRISPRi-FlowFISH and individual CRISPRi experiments to assess the performance of H3K27ac HiChIP interaction calls in K562 and mES cells. This analysis confirmed that HiC-DC+ outperforms other HiChIP analysis methods for identifying functional enhancer–promoter interactions, as validated by CRISPRi. One caveat is that the set of “positive” enhancer–promoter interactions are those for which CRISPRi perturbation of the enhancer leads to a significant change in expression of the target gene. It is possible that there are true physical H3K27ac-associated 3D enhancer–promoter interactions that are not detected by CRISPRi due to lack of detectable impact on target expression, for example due to buffering effects of additional interactions involving the target promoter. Another limitation of existing CRISPRi-FlowFISH is the relative paucity of validated long-range enhancer–promoter interactions among the screened elements. Finally, when comparing against HiChIP methods that correct for ChIP-seq bias, there is the confounding issue that strong H3K27ac ChIP-seq signal at accessible elements is associated with true functional enhancer–promoter interactions with detectable effect size in CRISPRi-FlowFISH, especially at close proximity to the promoter, as shown by activity-by-contact and activity-by-distance analysis (Supplementary Fig. <xref rid="MOESM1" ref-type="media">11</xref> and Supplementary Note 2). This raises the possibility that HiC-DC+, by not normalizing for ChIP-seq signal, is implicitly using ChIP bias to perform well in the CRISPRi-FlowFISH task. However, there is in fact no significant difference in ChIP signal between the high confidence interactions predicted by HiC-DC+ vs. FitHiChIP, a method that does correct for ChIP bias (Supplementary Fig. <xref rid="MOESM1" ref-type="media">9</xref>). Since the goal of H3K27ac HiChIP is to enrich for regulatory interactions, including enhancer–promoter interactions that are expected to influence target gene regulation, we believe CRISPRi-FlowFISH is a useful benchmark data set for HiChIP interaction callers, despite the limitations described here.</p>
    <p id="Par35">Many interactions detected in H3K27ac HiChIP data are putative enhancer–enhancer interactions, for which there is no gold standard data set for evaluation. Higher-resolution assays like HiCAR and Micro-C appear to enrich for shorter range regulatory interactions, so a careful analysis of these chromatin conformation assays together with parallel H3K27ac ChIP-seq could establish a curated set of enhancer–enhancer interactions on which to benchmark H3K27ac HiChIP calls. One could also try to validate HiChIP-based interactions involving specific enhancers using independent 4C experiments with the enhancer locus as viewpoint. Still, such analyses depend on statistical analysis of high-throughput 3C-based experiments and are therefore not entirely orthogonal to HiChIP. Moreover, we would ultimately want a functional validation for enhancer–enhancer interactions, and for this we would need a better understanding of their regulatory role. For example, one might perform CRISPRi experiments that target one enhancer participating in the putative enhancer–enhancer interaction and perform H3K27ac qPCR at the other enhancer to assess if there is distal loss of activity. Data sets of this nature may emerge in the next few years.</p>
    <p id="Par36">The issue of whether and how to normalize for chromatin IP signal in HiChIP experiments—either using parallel ChIP-seq data or self-ligation reads as a surrogate for ChIP<sup><xref ref-type="bibr" rid="CR20">20</xref>,<xref ref-type="bibr" rid="CR21">21</xref></sup>—is not resolved in the literature. The concern often raised is that without normalization, HiChIP interactions may be biased for higher ChIP enrichment, and differential HiChIP interactions may be due to differential ChIP enrichment rather than an underlying 3D interaction change. Conversely, there is the possibility that explicitly modeling ChIP enrichment may decrease the power to detect interactions or differential interactions by normalizing away the true signal. In our analyses, we found evidence that the latter is the case. We first found that normalizing for ChIP-seq bias by including this signal either as a continuous or categorical covariate in the HiC-DC+ model decreased power to detect CRISPRi-FlowFISH validated interactions (Supplementary Note 1 and Supplementary Fig. <xref rid="MOESM1" ref-type="media">8</xref>). In fact, since HiC-DC+ covariates such as GC content and mappability account for sources of systematic biases in high-throughput sequencing, we may already be implicitly correcting for a component of ChIP bias. Second, we systematically examined differential HiC-DC+ H3K27ac HiChIP results between two ENCODE cell lines using parallel Hi-C and H3K27ac ChIP-seq data (Supplementary Note 3). This analysis revealed that HiC-DC+ differential HiChIP events generally do not occur due to ChIP bias alone. Rather, we found that most differential HiChIP interactions with a concordant differential ChIP signal at one or both anchors exhibit simultaneous and concordant differential Hi-C signal. Promoter-anchored differential HiChIP interactions with no Hi-C signal change but differential ChIP at the promoter-distal anchor were enriched for differential target gene expression and depleted for significant Hi-C interactions. This suggests enrichment for true regulatory interactions that are not detected in Hi-C due to lack of sensitivity. We acknowledge that these differential analyses were limited to H3K27ac HiChIP and ChIP-seq due to availability of data sets. Our results confound the notion of normalization by ChIP in the case of regulatory interactions and address an important gap in the literature on this topic.</p>
    <p id="Par37">Several of our analysis vignettes demonstrated the effectiveness of HiC-DC+ for detecting significant and differential regulatory interactions, both in H3K27ac HiChIP experiments and in very high-coverage Hi-C data sets. In particular, using deep Hi-C data with ~5B reads per condition in the THP-1 cell line model of monocyte to macrophage differentiation, we found widespread gain of putative enhancer–promoter interactions in the macrophage state that were associated with gain of accessibility and H3K27ac at the non-promoter anchor and upregulation of targeted genes. By contrast, the widely used HiCCUPS method is well suited for detection of CTCF-mediated structural loops but appears to lack sensitivity for regulatory loops. Differential analysis applied to HiCCUPS loops identified few differential interactions, and those largely had smaller effect size (log fold change), showing the dichotomy between the relative stability of the structural interactome and the dynamics of the regulatory interactome. Therefore, as a statistically principled and all-purpose significant and differential interaction caller, HiC-DC+ complements structural loop callers and empowers examination of the role of 3D genomic interactions in the regulation of gene expression.</p>
  </sec>
  <sec id="Sec11">
    <title>Methods</title>
    <sec id="Sec12">
      <title>Pre-processing of Hi-C and HiChIP data</title>
      <p id="Par38">We aligned HiChIP reads to hg19 or mm10 genomes and filtered out reads that are duplicate or invalid ligation products using the HiC-Pro pipeline (v_2.11.1) with default settings. We processed Hi-C reads using Juicer pipeline (v_1.7.6) with default settings. For benchmarking with CRISPRi in mESCs from Fulco et al.<sup><xref ref-type="bibr" rid="CR11">11</xref></sup>, we used mESC H3K27ac HiChIP reads aligned to mm9. For all the other mouse data, we mapped reads to mm10 genome.</p>
    </sec>
    <sec id="Sec13">
      <title>TAD annotations</title>
      <p id="Par39">We used sub-TAD annotations from Arrowhead for GM12878 Hi-C data (<ext-link ext-link-type="uri" xlink:href="https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE63525">GSE63525</ext-link>). We found TADs at 50 kb resolution using TopDom (v_0.0.2) with “w” as 10 on ICE normalized Hi-C counts.</p>
    </sec>
    <sec id="Sec14">
      <title>Calling loops using FitHiChIP, MAPS, and hichipper</title>
      <p id="Par40">We used 5 kb-binned hichipper interactions in GM12878 SMC1A and K562 H3K27ac HiChIP reported by Bhattacharyya et al., 2019<sup><xref ref-type="bibr" rid="CR21">21</xref></sup> (GM12878 SMC1A from Table_GC-ALL table and K562 H3K27ac from Table_KH-ALL table). MAPS and FitHiChIP (L) interactions (FDR &lt;0.01) were also obtained from Bhattacharyya et al., 2019<sup><xref ref-type="bibr" rid="CR21">21</xref></sup> (GM12878 SMC1A from Table_GC-ALL table) and interactions, called using pooled replicates, up to 1.5M were used for comparisons.</p>
      <p id="Par41">We ran MAPS (v_1.1.0) for H3K27ac HiChIP in K562 data with HiChIP inferred ChIP peaks (Table Table_KH-L-H from<sup><xref ref-type="bibr" rid="CR21">21</xref></sup>, with the following parameters: “bin_size = 5000; fdr = 0; filter_file = None; generate_hic = 0; mapq = 30; length_cutoff = 1000; threads = 10; per_chr = True, binning_range = 1500000” using pooled allValidPairs file.</p>
      <p id="Par42">We ran FitHiChIP (v_8.1.0) on pooled H3K27ac HiChIP in K562 data with HiChIP inferred ChIP peaks (Table Table_KH-L-H from<sup><xref ref-type="bibr" rid="CR21">21</xref></sup>), with the following parameters: IntType = 3; BINSIZE = 5000; LowDistThr = 5000; UppDistThr = 1500000; UseP2PBackgrnd = 0; BiasType=1; MergeInt=1; QVALUE = 0.01” by providing pooled allValidPairs file.</p>
    </sec>
    <sec id="Sec15">
      <title>Benchmarking with CRISPRi-FlowFISH results</title>
      <p id="Par43">We use the 5091 candidate enhancer–promoter-target gene data from Fulco et al.<sup><xref ref-type="bibr" rid="CR11">11</xref></sup> reported in Supplementary Table <xref rid="MOESM1" ref-type="media">6a</xref> for K562 cells and add 15 singleton experiments for candidate enhancer–promoter pairs along with their tested target genes<sup><xref ref-type="bibr" rid="CR28">28</xref></sup> for K562 cells reported in Table <xref rid="MOESM1" ref-type="media">S3A</xref>. Because other methods (all except ABC and HiC-DC+) do not check for interactions shorter than 5 kb (17 candidates) and HiC-DC+ longer than 1.5 Mb (324 candidates) for K562 H3K27ac HiChIP, we removed these candidates from consideration. Among those within the distance range, we also removed candidate elements on gene promoters (1147 candidates) following Fulco et al.<sup><xref ref-type="bibr" rid="CR11">11</xref></sup>. This leaves a set of 3618 candidate enhancer–promoter-target gene experiments. We treated enhancer–promoter pairs reported at FDR &lt; 0.05 as significant enhancer–promoter candidates for the tested target gene.</p>
      <p id="Par44">We also use validated enhancer–promoter pairs in mESCs from Fulco et al.<sup><xref ref-type="bibr" rid="CR11">11</xref></sup>, reported in Table <xref rid="MOESM1" ref-type="media">S6b</xref>. There were a total of 57 regulatory element-gene pairs (excluding promoter–promoter pairs) for a total of 56 genes. Fourteen of those elements were found to significantly regulate target gene expression using CRISPRi, while the rest were not. We performed our benchmarking on these 57 enhancer–promoter pairs.</p>
    </sec>
    <sec id="Sec16">
      <title>Effect size comparison</title>
      <p id="Par45">We collected significant (FDR &lt; 0.01) looping events identified in K562 H3K27ac HiChIP at 5 kb bins overlapping with candidate enhancer–promoter pairs for each of the benchmarked methods (PET count ≥2 for hichipper) and compared the reported fraction change in gene expression using one-sided Wilcoxon rank sum test with the alternative hypothesis being HiC-DC+ having greater reduction in gene expression on the CRISPR-perturbed candidates.</p>
    </sec>
    <sec id="Sec17">
      <title>Gene-wise performance comparison</title>
      <p id="Par46">We grouped 3618 candidate enhancer–-promoter pairs by their 71 target genes, chose 22 target genes (2609 candidates) that has at least one significant pair and one insignificant pair, and computed the auPR for each target gene and for each benchmarked method using significance scores collected from overlapping 5 kb bins for each candidate. We ordered the precision-recall curve in an increasing order of <italic>P</italic> values for HiC-DC+, FitHiChIP, and MAPS, and in decreasing order of PET counts for hichipper. We compared the range of auPR values across methods using one-sided Wilcoxon signed rank tests with the alternative hypothesis being HiC-DC+ having greater auPR. For the comparison between ABD and ABC methods (Wilcoxon signed rank test, <italic>P</italic> = 0.39, <italic>N</italic> = 23, alternative: ABD is greater), we included candidate enhancer–promoter pairs closer than 5 kb as well.</p>
    </sec>
    <sec id="Sec18">
      <title>Finding CTCF motif orientation</title>
      <p id="Par47">We found the CTCF motif orientation of the significant GM12878 SMC1A HiChIP loop anchors (FDR &lt;0.01, 20 kb ≤ loop distance ≤ 1.5M) identified by each method using Juicer tool command MotifFinder (v_1.7.6). We used IDR-thresholded GM12878 CTCF peaks available from ENCODE (<ext-link ext-link-type="uri" xlink:href="https://www.encodeproject.org/files/ENCFF710VEH/">ENCFF710VEH</ext-link>).</p>
    </sec>
    <sec id="Sec19">
      <title>SubTAD metaplot generation</title>
      <p id="Par48">For each method, we found the number of significant GM12878 SMC1A HiChIP interactions (FDR &lt; 0.01, 20 kb ≤ loop distance ≤ 1.5M) a 5 kb bin makes with other regions. Then, using deepTools (v_3.1.1) computeMatrix “scale-regions” and plotProfile, we generated a metaplot of significant interactions over GM12878 subTADs (<ext-link ext-link-type="uri" xlink:href="https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE63525">GSE63525</ext-link>).</p>
    </sec>
    <sec id="Sec20">
      <title>APA plot generation</title>
      <p id="Par49">We used Juicer Tools (v1.6.2) to perform APA on the corresponding Hi-C data with all default settings either at a resolution of 5 or 25 kb (for comparison of differential calling methods on HAP1 data). APA output were then <italic>z</italic>-score normalized to retrieve pixel intensities, and then rescaled to [−1,1]. Smoothed images were then rendered using ggplot. We used the corresponding Hi-C data to generate APA plots for HiChIP calls. For each APA plot, P2LL scores were computed to determine enrichment of the signal to the lower left corner and reported as APA scores.</p>
    </sec>
    <sec id="Sec21">
      <title>Statistical modeling of interaction bin count data</title>
      <p id="Par50">HiC-DC+ follows the feature selections and model specifications outlined in Carty et al.<sup><xref ref-type="bibr" rid="CR9">9</xref></sup> with the choice of a NB model for the read counts rather than a zero-truncated negative binomial distribution. Specifically, we used a GLM based on NB regression to model the Hi-C read counts, and we used the fitted model to estimate the statistical significance (<italic>P</italic> value) to the Hi-C interaction bin counts. Following previous notation<sup><xref ref-type="bibr" rid="CR9">9</xref></sup>, we let <bold>Y</bold> = <bold>(</bold><italic>y</italic><sub><italic>ij</italic></sub>) represent the Hi-C contact map of intra-chromosomal interactions, where <italic>i</italic> and <italic>j</italic> are a pair of genomic intervals (either through uniform binning of the genome or fixed size bins of consecutive RE fragments) and the tuple (<italic>i</italic>,<italic>j</italic>) defines an interaction bin. Each bin has an associated vector of covariates, which we denote as <bold>X</bold> = (<italic>x</italic><sup>dist</sup>; <italic>x</italic><sup>gc</sup>; <italic>x</italic><sup>map</sup>), and <italic>y</italic><sub><italic>ij</italic></sub> is modeled as a random variable that follows a NB distribution. The regression model is defined as: P(<bold>Y</bold> = <italic>y</italic><sub><italic>ij</italic></sub>|<bold>X</bold>) = <inline-formula id="IEq1"><alternatives><tex-math id="M1">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$f({k;}{\mu }_{{ij}};\alpha )$$\end{document}</tex-math><mml:math id="M2"><mml:mi>f</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>;</mml:mo><mml:msub><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>;</mml:mo><mml:mi>α</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="41467_2021_23749_Article_IEq1.gif"/></alternatives></inline-formula>, where the distribution <inline-formula id="IEq2"><alternatives><tex-math id="M3">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$f({k;}{\mu }_{{ij}};\alpha )$$\end{document}</tex-math><mml:math id="M4"><mml:mi>f</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>;</mml:mo><mml:msub><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>;</mml:mo><mml:mi>α</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="41467_2021_23749_Article_IEq2.gif"/></alternatives></inline-formula> is a NB distribution with dispersion parameter <italic>ɑ</italic>. The NB mean parameter <inline-formula id="IEq3"><alternatives><tex-math id="M5">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mu }_{{ij}}$$\end{document}</tex-math><mml:math id="M6"><mml:msub><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2021_23749_Article_IEq3.gif"/></alternatives></inline-formula> is described with a log-linear model:<disp-formula id="Equ1"><label>1</label><alternatives><tex-math id="M7">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\log }({\mu }_{{ij}})={\beta }_{0}+\mathop{\sum}\limits_{k}{\beta }_{k}{B}_{k,l}({x}_{{ij}}^{{{\mathrm{dist}}}})+{\beta }_{{{\mathrm{gc}}}}{x}_{{ij}}^{{{\mathrm{gc}}}}+{\beta }_{{{\mathrm{map}}}}{x}_{{ij}}^{{{\mathrm{map}}}}$$\end{document}</tex-math><mml:math id="M8"><mml:mi>log</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:munder><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:munder><mml:msub><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>l</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msubsup><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">dist</mml:mi></mml:mrow></mml:msubsup></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">gc</mml:mi></mml:mrow></mml:msub><mml:msubsup><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">gc</mml:mi></mml:mrow></mml:msubsup><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">map</mml:mi></mml:mrow></mml:msub><mml:msubsup><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">map</mml:mi></mml:mrow></mml:msubsup></mml:math><graphic xlink:href="41467_2021_23749_Article_Equ1.gif" position="anchor"/></alternatives></disp-formula></p>
      <p id="Par51">where <inline-formula id="IEq4"><alternatives><tex-math id="M9">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\beta }_{0}$$\end{document}</tex-math><mml:math id="M10"><mml:msub><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2021_23749_Article_IEq4.gif"/></alternatives></inline-formula> is the intercept term, and <inline-formula id="IEq5"><alternatives><tex-math id="M11">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\beta }_{\rm{gc}}$$\end{document}</tex-math><mml:math id="M12"><mml:msub><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">gc</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2021_23749_Article_IEq5.gif"/></alternatives></inline-formula> and <inline-formula id="IEq6"><alternatives><tex-math id="M13">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\beta }_{\rm{map}}$$\end{document}</tex-math><mml:math id="M14"><mml:msub><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">map</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2021_23749_Article_IEq6.gif"/></alternatives></inline-formula> are coefficients for GC content and mappability features, respectively. In the case of uniform binning, the effective bin size due to RE site occurrences is included as a covariate, as in the HiC-DC model. We modeled the relationship between genomic distance and contact significance with a third order B-spline, which takes the distance covariate as input, and the B-spline basis functions are as previously described<sup><xref ref-type="bibr" rid="CR9">9</xref></sup>. Specifically, we use six degrees of freedom for fitting the spline and have three inner knots. These inner knots are at the 25, 50, and 75% quantiles of the linear genomic distance.</p>
      <p id="Par52">To increase the statistical power of the model, we removed bins with counts that exceed the 97.5% percentile of null distribution that we deem as positive outliers, corresponding to potentially nonrandom contacts, and then refit the model to the remainder of the data. We use the function glm.nb in the R library <italic>MASS</italic> to fit the NB regression model.</p>
      <p id="Par53">HiC-DC+ assesses the significance of bin counts based on the corresponding estimated NB distribution for that bin. The <italic>P</italic> value associated with each interaction bin becomes 1 minus the cumulative distribution function fit for that bin given its feature values, i.e., <inline-formula id="IEq7"><alternatives><tex-math id="M15">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$1-{\sum }_{k=0}^{{y}_{{ij}}}f({k;}{\mu }_{{ij}};\alpha )$$\end{document}</tex-math><mml:math id="M16"><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msubsup><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msubsup><mml:mi>f</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>;</mml:mo><mml:msub><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>;</mml:mo><mml:mi>α</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="41467_2021_23749_Article_IEq7.gif"/></alternatives></inline-formula>. Significant bins can then be selected on the basis of adjusted <italic>P</italic> values following the Benjamini–Hochberg procedure to control for FDR.</p>
      <p id="Par54">The R package <italic>HiCDCPlus</italic> allows for model selection for other interaction bin count data by providing an option to choose the zero-truncated NB distribution, as well as optional parameters to (i) add/remove/change local genomic features as desired and (ii) use the logarithm of genomic distance as the distance covariate instead of using B-splines.</p>
    </sec>
    <sec id="Sec22">
      <title>Differential interaction calling</title>
      <p id="Par55">We call differential interactions using DESeq2 and raw counts, with two modifications. First, analyzed loci are the interaction bins in the union set of significant interactions (FDR &lt; 0.1) across all conditions to be pairwise tested. Second, size factors for these loci are determined for each genomic distance separately. Following DESeq2 assumptions, we enforce that the median normalized count for interaction bins at each genomic distance should be similar across conditions. Specifically, for a given distance <inline-formula id="IEq8"><alternatives><tex-math id="M17">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\left|i-j\right|=d$$\end{document}</tex-math><mml:math id="M18"><mml:mfenced close="∣" open="∣"><mml:mrow><mml:mi>i</mml:mi><mml:mo>−</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:mi>d</mml:mi></mml:math><inline-graphic xlink:href="41467_2021_23749_Article_IEq8.gif"/></alternatives></inline-formula>, the size factor for condition <inline-formula id="IEq9"><alternatives><tex-math id="M19">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$k$$\end{document}</tex-math><mml:math id="M20"><mml:mi>k</mml:mi></mml:math><inline-graphic xlink:href="41467_2021_23749_Article_IEq9.gif"/></alternatives></inline-formula> is chosen to be <inline-formula id="IEq10"><alternatives><tex-math id="M21">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\widehat{{s}_{d}}={\mathrm{median}}_{|i-j|=d}{y}_{ij}^{k}$$\end{document}</tex-math><mml:math id="M22"><mml:mover accent="true"><mml:mrow><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi>d</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>^</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="normal">median</mml:mi></mml:mrow><mml:mrow><mml:mo>∣</mml:mo><mml:mi>i</mml:mi><mml:mo>−</mml:mo><mml:mi>j</mml:mi><mml:mo>∣</mml:mo><mml:mo>=</mml:mo><mml:mi>d</mml:mi></mml:mrow></mml:msub><mml:msubsup><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="41467_2021_23749_Article_IEq10.gif"/></alternatives></inline-formula>, so that normalized counts become <inline-formula id="IEq11"><alternatives><tex-math id="M23">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\frac{{y}_{ij}^{k}}{\widehat{{s}_{d}}}$$\end{document}</tex-math><mml:math id="M24"><mml:mfrac><mml:mrow><mml:msubsup><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msubsup></mml:mrow><mml:mrow><mml:mover accent="true"><mml:mrow><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi>d</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow></mml:mfrac></mml:math><inline-graphic xlink:href="41467_2021_23749_Article_IEq11.gif"/></alternatives></inline-formula>.</p>
    </sec>
    <sec id="Sec23">
      <title>Calling differential interactions using other tools</title>
      <p id="Par56">For H3K27ac HiChIP data in mESC and MEF<sup><xref ref-type="bibr" rid="CR13">13</xref></sup>, we called differential loops at 5 kb using diffloop (v_1.16.0)<sup><xref ref-type="bibr" rid="CR27">27</xref></sup> using R version 3.6. Since the published interactions were called by an approach similar to Mango<sup><xref ref-type="bibr" rid="CR29">29</xref></sup>, we implemented the Mango correction function to remove biases associated with the method. The loops were then filtered at FDR &lt; 0.05 and absolute fold change &gt;1.5. We performed the differential contact calling on Hi-C data in HAP1 and WAPL knockout HAP1 cells at 25 kb resolution using mutliHiCcompare<sup><xref ref-type="bibr" rid="CR25">25</xref></sup>, Selfish<sup><xref ref-type="bibr" rid="CR26">26</xref></sup>, and diffHic<sup><xref ref-type="bibr" rid="CR24">24</xref></sup>. All differential interactions were filtered at FDR &lt; 0.05 and absolute fold change &gt;1.5. After loading raw matrices into multiHiCcompare (v_1.6.0), we normalized samples with cyclic loess normalization and called the differential interactions by exact test. The python3 version of Selfish (v_1.10.2) was used to detect differential interactions by applying the method to HiC-DC+ (O/E) normalized matrices. For diffHic (v_1.14.0) analysis, we loaded raw contact count data as InteractionSet objects, filtered by average counts, used loess normalization, and applied the tool’s statistical model function to estimate <italic>P</italic> values.</p>
    </sec>
    <sec id="Sec24">
      <title>ChIP-seq analysis</title>
      <p id="Par57">We aligned CTCF and H3K27ac ChIP-seq reads to hg19 using BWA (v_0.7.17-r1188). Then, we extracted uniquely aligned paired reads using SAMtools (v_1.9) and removed PCR duplicates using Picard tools (v_2.18.16). Peak calling was performed for each individual and pooled replicates of each cell type using MACS2 (v_2.1.2) with parameters “-g hs -p 0.0”. To find reproducible peaks across replicates for each histone mark, we calculated the irreproducible discovery rate (IDR) using IDR (v_2.0.3) with parameters “—samples rep1.narrowPeak rep2.narrowPeak—peak-list pooled.narrowPeak -o—plot”. We combined peaks passing an IDR threshold of 0.05 in each condition for each mark. We used featureCounts (v_1.6.4) to obtain ChIP-seq read counts in the peak atlas, and applied DESeq2 (v_1.24.0) to these counts to find the differential occupancy of each mark between conditions. Bedtools genomeCoverageBed (v_2.27.1) was used to generate bedgraph files scaled with DESeq2 sample size factors and bedgraph files were converted to bigwig using UCSC bedgraph2bigwig (v_4).</p>
    </sec>
    <sec id="Sec25">
      <title>ATAC-seq analysis</title>
      <p id="Par58">We trimmed the raw reads and filtered for quality using cutadapt (v_2.3). Trimmed reads were aligned to the hg19 genome using Bowtie2 (v_2.3.4.3) and uniquely mapped reads were retained. After centering the reads on the transposase binding event by shifting all positive-strand reads by 4 bp downstream and all negative-strand reads 5 bp upstream, peak calling was performed on each replicate and all replicated pooled together using MACS2 (v_2.1.2) with parameters “-g hs—nomodel”. We calculated the IDR using IDR (v_2.0.3) to find reproducible peaks across replicates. We combined peaks passing an IDR threshold of 0.05 to generate an atlas of peaks. Differential accessibility analysis of the peaks and generation of normalized bigwig tracks was performed as described in ChIP-seq analysis.</p>
    </sec>
    <sec id="Sec26">
      <title>Annotation of peaks</title>
      <p id="Par59">We used the GENCODE transcript annotations of the hg19 (v19) genome to define the genomic location of transcription units. ATAC-seq and ChIP-seq peaks were annotated as promoter peaks if they were within 2 kb of a transcription start site. Non-promoter peaks were annotated according to the relevant transcript annotation in the following order of priority: intronic, exonic, or intergenic. Intergenic peaks were assigned to the gene whose TSS or 3′ end was closest to the peak. In this way, each peak was unambiguously assigned to one gene.</p>
    </sec>
    <sec id="Sec27">
      <title>RNA-seq and analysis</title>
      <p id="Par60">We conducted differential gene expression analysis on the gene counts tables provided in <ext-link ext-link-type="uri" xlink:href="https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE96800">GSE96800</ext-link> using DESeq2 (v_1.24.0).</p>
    </sec>
    <sec id="Sec28">
      <title>Comparison of macrophage to monocyte differential loops</title>
      <p id="Par61">We reported shared looping events by calling HiC-DC+ differential interactions at 10 kb at an FDR of 0.01 and overlapping with interactions reported by Phanstiel et al.<sup><xref ref-type="bibr" rid="CR14">14</xref></sup>, requiring anchors for our interactions to fall within a 10 kb flank of previously the reported anchors.</p>
    </sec>
    <sec id="Sec29">
      <title>Candidate enhancers and promoter-anchored loops</title>
      <p id="Par62">To identify candidate regulatory elements, we first assembled the atlas of reproducible H3K27ac ChIP-seq and ATAC-seq peaks in each the two conditions filtered at an IDR threshold of 0.05. We defined candidate enhancers by taking the intersection of genomic intervals containing both an H3K27ac ChIP and an ATAC peak from this atlas. We identified promoter regions as within 2 kb of transcription start sites (TSS) of genes annotated by GENCODE GRCh37.p13. We identified elements with differential accessibility or activity of candidate enhancers as based on DESeq2 applied to ATAC or H3K27ac read counts, respectively, with adjusted <italic>P</italic> &lt; 0.05. We described candidate enhancers as static if neither signal was significantly differential. We overlapped CTCF peaks called at IDR 0.05 with candidate enhancer regions and similarly defined differential and static CTCF binding events.</p>
      <p id="Par63">We define promoter-anchored loops as loops and those where one of the anchors overlaps a promoter region. Likewise, enhancer–promoter interactions are promoter-anchored loops with one anchor overlapping a promoter region and the other anchor overlapping a candidate enhancer from the atlas.</p>
    </sec>
    <sec id="Sec30">
      <title>GREAT analysis of differential looping events</title>
      <p id="Par64">We used enhancer–promoter interactions as defined above for GREAT (v_4.0.4) analysis. We filtered results for significance (hypergeometric test, adjusted <italic>P</italic> &lt; 0.05) while restricting to GO terms associated with at most 300 genes.</p>
    </sec>
    <sec id="Sec31">
      <title>Reporting summary</title>
      <p id="Par65">Further information on research design is available in the <xref rid="MOESM5" ref-type="media">Nature Research Reporting Summary</xref> linked to this article.</p>
    </sec>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary information</title>
    <sec id="Sec32">
      <supplementary-material content-type="local-data" id="MOESM1">
        <media xlink:href="41467_2021_23749_MOESM1_ESM.pdf">
          <caption>
            <p>Supplementary Information</p>
          </caption>
        </media>
      </supplementary-material>
      <supplementary-material content-type="local-data" id="MOESM2">
        <media xlink:href="41467_2021_23749_MOESM2_ESM.pdf">
          <caption>
            <p>Peer Review File</p>
          </caption>
        </media>
      </supplementary-material>
      <supplementary-material content-type="local-data" id="MOESM3">
        <media xlink:href="41467_2021_23749_MOESM3_ESM.pdf">
          <caption>
            <p>Description of Additional Supplementary Files</p>
          </caption>
        </media>
      </supplementary-material>
      <supplementary-material content-type="local-data" id="MOESM4">
        <media xlink:href="41467_2021_23749_MOESM4_ESM.xlsx">
          <caption>
            <p>Supplementary Data 1</p>
          </caption>
        </media>
      </supplementary-material>
      <supplementary-material content-type="local-data" id="MOESM5">
        <media xlink:href="41467_2021_23749_MOESM5_ESM.pdf">
          <caption>
            <p>Reporting Summary</p>
          </caption>
        </media>
      </supplementary-material>
    </sec>
  </sec>
</body>
<back>
  <fn-group>
    <fn>
      <p><bold>Peer review information</bold><italic>Nature Communications</italic> thanks the anonymous reviewers for their contribution to the peer review of this work. Peer reviewer reports are available.</p>
    </fn>
    <fn>
      <p><bold>Publisher’s note</bold> Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p>
    </fn>
  </fn-group>
  <sec>
    <title>Supplementary information</title>
    <p>The online version contains supplementary material available at 10.1038/s41467-021-23749-x.</p>
  </sec>
  <ack>
    <title>Acknowledgements</title>
    <p>This work was supported by NIH/NHGRI U01 award HG009395 and NIH/NIDDK U01 award DK128852.</p>
  </ack>
  <notes notes-type="author-contribution">
    <title>Author contributions</title>
    <p>M.S. and C.S.L. conceived of the project, designed the statistical methods, and wrote the manuscript. M.S. developed and implemented the methods, developed the software package, and performed benchmarking analyses. W.W. performed computational analyses for monocyte to macrophage differentiation and contributed to writing the manuscript. Y.Z. performed benchmarking experiments for differential analysis under the supervision of R.K. K.V.D. performed statistical analyses for HiChIP benchmarking. C.S.L. supervised the research. All authors read and approved the final version of the manuscript.</p>
  </notes>
  <notes notes-type="data-availability">
    <title>Data availability</title>
    <p>All data sets used in this study are publicly available and summarized in Supplementary Data <xref rid="MOESM4" ref-type="media">1</xref> with accession codes. All relevant analyzed data is available upon request.</p>
  </notes>
  <notes notes-type="data-availability">
    <title>Code availability</title>
    <p>The source code and the documentation for the HiCDCPlus R package is available at <ext-link ext-link-type="uri" xlink:href="https://bitbucket.org/leslielab/hicdcplus">https://bitbucket.org/leslielab/hicdcplus</ext-link>.</p>
  </notes>
  <notes id="FPar1" notes-type="COI-statement">
    <title>Competing interests</title>
    <p id="Par66">The authors declare no competing interests.</p>
  </notes>
  <ref-list id="Bib1">
    <title>References</title>
    <ref id="CR1">
      <label>1.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Krietenstein</surname>
            <given-names>N</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Ultrastructural details of mammalian chromosome architecture</article-title>
        <source>Mol. Cell</source>
        <year>2020</year>
        <volume>78</volume>
        <fpage>554</fpage>
        <lpage>565 e557</lpage>
        <pub-id pub-id-type="doi">10.1016/j.molcel.2020.03.003</pub-id>
        <pub-id pub-id-type="pmid">32213324</pub-id>
      </element-citation>
    </ref>
    <ref id="CR2">
      <label>2.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hsieh</surname>
            <given-names>TH</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Mapping nucleosome resolution chromosome folding in yeast by Micro-C</article-title>
        <source>Cell</source>
        <year>2015</year>
        <volume>162</volume>
        <fpage>108</fpage>
        <lpage>119</lpage>
        <pub-id pub-id-type="doi">10.1016/j.cell.2015.05.048</pub-id>
        <pub-id pub-id-type="pmid">26119342</pub-id>
      </element-citation>
    </ref>
    <ref id="CR3">
      <label>3.</label>
      <mixed-citation publication-type="other">Wei, X. et al. Multi-omics analysis of chromatin accessibility and interactions with transcriptome by HiCAR. Preprint at <italic>bioRxiv</italic>10.1101/2020.11.02.366062 (2020).</mixed-citation>
    </ref>
    <ref id="CR4">
      <label>4.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Mumbach</surname>
            <given-names>MR</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>HiChIP: efficient and sensitive analysis of protein-directed genome architecture</article-title>
        <source>Nat. Methods</source>
        <year>2016</year>
        <volume>13</volume>
        <fpage>919</fpage>
        <lpage>922</lpage>
        <pub-id pub-id-type="doi">10.1038/nmeth.3999</pub-id>
        <pub-id pub-id-type="pmid">27643841</pub-id>
      </element-citation>
    </ref>
    <ref id="CR5">
      <label>5.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hughes</surname>
            <given-names>JR</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Analysis of hundreds of cis-regulatory landscapes at high resolution in a single, high-throughput experiment</article-title>
        <source>Nat. Genet.</source>
        <year>2014</year>
        <volume>46</volume>
        <fpage>205</fpage>
        <lpage>212</lpage>
        <pub-id pub-id-type="doi">10.1038/ng.2871</pub-id>
        <pub-id pub-id-type="pmid">24413732</pub-id>
      </element-citation>
    </ref>
    <ref id="CR6">
      <label>6.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Durand</surname>
            <given-names>NC</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Juicebox provides a visualization system for Hi-C contact maps with unlimited zoom</article-title>
        <source>Cell Syst.</source>
        <year>2016</year>
        <volume>3</volume>
        <fpage>99</fpage>
        <lpage>101</lpage>
        <pub-id pub-id-type="doi">10.1016/j.cels.2015.07.012</pub-id>
        <pub-id pub-id-type="pmid">27467250</pub-id>
      </element-citation>
    </ref>
    <ref id="CR7">
      <label>7.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ramirez</surname>
            <given-names>F</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>High-resolution TADs reveal DNA sequences underlying genome organization in flies</article-title>
        <source>Nat. Commun.</source>
        <year>2018</year>
        <volume>9</volume>
        <fpage>189</fpage>
        <pub-id pub-id-type="doi">10.1038/s41467-017-02525-w</pub-id>
        <pub-id pub-id-type="pmid">29335486</pub-id>
      </element-citation>
    </ref>
    <ref id="CR8">
      <label>8.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Rao</surname>
            <given-names>SS</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>A 3D map of the human genome at kilobase resolution reveals principles of chromatin looping</article-title>
        <source>Cell</source>
        <year>2014</year>
        <volume>159</volume>
        <fpage>1665</fpage>
        <lpage>1680</lpage>
        <pub-id pub-id-type="doi">10.1016/j.cell.2014.11.021</pub-id>
        <pub-id pub-id-type="pmid">25497547</pub-id>
      </element-citation>
    </ref>
    <ref id="CR9">
      <label>9.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Carty</surname>
            <given-names>M</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>An integrated model for detecting significant chromatin interactions from high-resolution Hi-C data</article-title>
        <source>Nat. Commun.</source>
        <year>2017</year>
        <volume>8</volume>
        <fpage>15454</fpage>
        <pub-id pub-id-type="doi">10.1038/ncomms15454</pub-id>
        <pub-id pub-id-type="pmid">28513628</pub-id>
      </element-citation>
    </ref>
    <ref id="CR10">
      <label>10.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Love</surname>
            <given-names>MI</given-names>
          </name>
          <name>
            <surname>Huber</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Anders</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>Moderated estimation of fold change and dispersion for RNA-seq data with DESeq2</article-title>
        <source>Genome Biol.</source>
        <year>2014</year>
        <volume>15</volume>
        <fpage>550</fpage>
        <pub-id pub-id-type="doi">10.1186/s13059-014-0550-8</pub-id>
        <pub-id pub-id-type="pmid">25516281</pub-id>
      </element-citation>
    </ref>
    <ref id="CR11">
      <label>11.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Fulco</surname>
            <given-names>CP</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Activity-by-contact model of enhancer-promoter regulation from thousands of CRISPR perturbations</article-title>
        <source>Nat. Genet.</source>
        <year>2019</year>
        <volume>51</volume>
        <fpage>1664</fpage>
        <lpage>1669</lpage>
        <pub-id pub-id-type="doi">10.1038/s41588-019-0538-0</pub-id>
        <pub-id pub-id-type="pmid">31784727</pub-id>
      </element-citation>
    </ref>
    <ref id="CR12">
      <label>12.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Haarhuis</surname>
            <given-names>JHI</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>The cohesin release factor WAPL restricts chromatin loop extension</article-title>
        <source>Cell</source>
        <year>2017</year>
        <volume>169</volume>
        <fpage>693</fpage>
        <lpage>707 e614</lpage>
        <pub-id pub-id-type="doi">10.1016/j.cell.2017.04.013</pub-id>
        <pub-id pub-id-type="pmid">28475897</pub-id>
      </element-citation>
    </ref>
    <ref id="CR13">
      <label>13.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Di Giammartino</surname>
            <given-names>DC</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>KLF4 is involved in the organization and regulation of pluripotency-associated three-dimensional enhancer networks</article-title>
        <source>Nat. Cell Biol.</source>
        <year>2019</year>
        <volume>21</volume>
        <fpage>1179</fpage>
        <lpage>1190</lpage>
        <pub-id pub-id-type="doi">10.1038/s41556-019-0390-6</pub-id>
        <pub-id pub-id-type="pmid">31548608</pub-id>
      </element-citation>
    </ref>
    <ref id="CR14">
      <label>14.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Phanstiel</surname>
            <given-names>DH</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Static and dynamic DNA loops form AP-1-bound activation hubs during macrophage development</article-title>
        <source>Mol. Cell</source>
        <year>2017</year>
        <volume>67</volume>
        <fpage>1037</fpage>
        <lpage>1048 e1036</lpage>
        <pub-id pub-id-type="doi">10.1016/j.molcel.2017.08.006</pub-id>
        <pub-id pub-id-type="pmid">28890333</pub-id>
      </element-citation>
    </ref>
    <ref id="CR15">
      <label>15.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ay</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Bailey</surname>
            <given-names>TL</given-names>
          </name>
          <name>
            <surname>Noble</surname>
            <given-names>WS</given-names>
          </name>
        </person-group>
        <article-title>Statistical confidence estimation for Hi-C data reveals regulatory chromatin contacts</article-title>
        <source>Genome Res.</source>
        <year>2014</year>
        <volume>24</volume>
        <fpage>999</fpage>
        <lpage>1011</lpage>
        <pub-id pub-id-type="doi">10.1101/gr.160374.113</pub-id>
        <pub-id pub-id-type="pmid">24501021</pub-id>
      </element-citation>
    </ref>
    <ref id="CR16">
      <label>16.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Cook</surname>
            <given-names>KB</given-names>
          </name>
          <name>
            <surname>Hristov</surname>
            <given-names>BH</given-names>
          </name>
          <name>
            <surname>Le Roch</surname>
            <given-names>KG</given-names>
          </name>
          <name>
            <surname>Vert</surname>
            <given-names>JP</given-names>
          </name>
          <name>
            <surname>Noble</surname>
            <given-names>WS</given-names>
          </name>
        </person-group>
        <article-title>Measuring significant changes in chromatin conformation with ACCOST</article-title>
        <source>Nucleic Acids Res.</source>
        <year>2020</year>
        <volume>48</volume>
        <fpage>2303</fpage>
        <lpage>2311</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/gkaa069</pub-id>
        <pub-id pub-id-type="pmid">32034421</pub-id>
      </element-citation>
    </ref>
    <ref id="CR17">
      <label>17.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Durand</surname>
            <given-names>NC</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Juicer provides a one-click system for analyzing loop-resolution Hi-C experiments</article-title>
        <source>Cell Syst.</source>
        <year>2016</year>
        <volume>3</volume>
        <fpage>95</fpage>
        <lpage>98</lpage>
        <pub-id pub-id-type="doi">10.1016/j.cels.2016.07.002</pub-id>
        <pub-id pub-id-type="pmid">27467249</pub-id>
      </element-citation>
    </ref>
    <ref id="CR18">
      <label>18.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Shin</surname>
            <given-names>H</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>TopDom: an efficient and deterministic method for identifying topological domains in genomes</article-title>
        <source>Nucleic Acids Res</source>
        <year>2016</year>
        <volume>44</volume>
        <fpage>e70</fpage>
        <pub-id pub-id-type="doi">10.1093/nar/gkv1505</pub-id>
        <pub-id pub-id-type="pmid">26704975</pub-id>
      </element-citation>
    </ref>
    <ref id="CR19">
      <label>19.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Imakaev</surname>
            <given-names>M</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Iterative correction of Hi-C data reveals hallmarks of chromosome organization</article-title>
        <source>Nat. Methods</source>
        <year>2012</year>
        <volume>9</volume>
        <fpage>999</fpage>
        <lpage>1003</lpage>
        <pub-id pub-id-type="doi">10.1038/nmeth.2148</pub-id>
        <pub-id pub-id-type="pmid">22941365</pub-id>
      </element-citation>
    </ref>
    <ref id="CR20">
      <label>20.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lareau</surname>
            <given-names>CA</given-names>
          </name>
          <name>
            <surname>Aryee</surname>
            <given-names>MJ</given-names>
          </name>
        </person-group>
        <article-title>hichipper: a preprocessing pipeline for calling DNA loops from HiChIP data</article-title>
        <source>Nat. Methods</source>
        <year>2018</year>
        <volume>15</volume>
        <fpage>155</fpage>
        <lpage>156</lpage>
        <pub-id pub-id-type="doi">10.1038/nmeth.4583</pub-id>
        <pub-id pub-id-type="pmid">29489746</pub-id>
      </element-citation>
    </ref>
    <ref id="CR21">
      <label>21.</label>
      <mixed-citation publication-type="other">Bhattacharyya, S., Chandra, V., Vijayanand, P. &amp; Ay, F. Identification of significant chromatin contacts from HiChIP data by FitHiChIP. <italic>Nat Commun.</italic><bold>10</bold>, 4221 (2019).</mixed-citation>
    </ref>
    <ref id="CR22">
      <label>22.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Juric</surname>
            <given-names>I</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>MAPS: model-based analysis of long-range chromatin interactions from PLAC-seq and HiChIP experiments</article-title>
        <source>PLoS Comput. Biol.</source>
        <year>2019</year>
        <volume>15</volume>
        <fpage>e1006982</fpage>
        <pub-id pub-id-type="doi">10.1371/journal.pcbi.1006982</pub-id>
        <pub-id pub-id-type="pmid">30986246</pub-id>
      </element-citation>
    </ref>
    <ref id="CR23">
      <label>23.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bonev</surname>
            <given-names>B</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Multiscale 3D genome rewiring during mouse neural development</article-title>
        <source>Cell</source>
        <year>2017</year>
        <volume>171</volume>
        <fpage>557</fpage>
        <lpage>572 e524</lpage>
        <pub-id pub-id-type="doi">10.1016/j.cell.2017.09.043</pub-id>
        <pub-id pub-id-type="pmid">29053968</pub-id>
      </element-citation>
    </ref>
    <ref id="CR24">
      <label>24.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lun</surname>
            <given-names>AT</given-names>
          </name>
          <name>
            <surname>Smyth</surname>
            <given-names>GK</given-names>
          </name>
        </person-group>
        <article-title>diffHic: a bioconductor package to detect differential genomic interactions in Hi-C data</article-title>
        <source>BMC Bioinforma.</source>
        <year>2015</year>
        <volume>16</volume>
        <fpage>258</fpage>
        <pub-id pub-id-type="doi">10.1186/s12859-015-0683-0</pub-id>
      </element-citation>
    </ref>
    <ref id="CR25">
      <label>25.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Stansfield</surname>
            <given-names>JC</given-names>
          </name>
          <name>
            <surname>Cresswell</surname>
            <given-names>KG</given-names>
          </name>
          <name>
            <surname>Dozmorov</surname>
            <given-names>MG</given-names>
          </name>
        </person-group>
        <article-title>multiHiCcompare: joint normalization and comparative analysis of complex Hi-C experiments</article-title>
        <source>Bioinformatics</source>
        <year>2019</year>
        <volume>35</volume>
        <fpage>2916</fpage>
        <lpage>2923</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btz048</pub-id>
        <pub-id pub-id-type="pmid">30668639</pub-id>
      </element-citation>
    </ref>
    <ref id="CR26">
      <label>26.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ardakany</surname>
            <given-names>AR</given-names>
          </name>
          <name>
            <surname>Ay</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Lonardi</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>Selfish: discovery of differential chromatin interactions via a self-similarity measure</article-title>
        <source>Bioinformatics</source>
        <year>2019</year>
        <volume>35</volume>
        <fpage>i145</fpage>
        <lpage>i153</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btz362</pub-id>
        <pub-id pub-id-type="pmid">31510653</pub-id>
      </element-citation>
    </ref>
    <ref id="CR27">
      <label>27.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lareau</surname>
            <given-names>CA</given-names>
          </name>
          <name>
            <surname>Aryee</surname>
            <given-names>MJ</given-names>
          </name>
        </person-group>
        <article-title>diffloop: a computational framework for identifying and analyzing differential DNA loops from sequencing data</article-title>
        <source>Bioinformatics</source>
        <year>2018</year>
        <volume>34</volume>
        <fpage>672</fpage>
        <lpage>674</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btx623</pub-id>
        <pub-id pub-id-type="pmid">29028898</pub-id>
      </element-citation>
    </ref>
    <ref id="CR28">
      <label>28.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Gasperini</surname>
            <given-names>M</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>A genome-wide framework for mapping gene regulation via</article-title>
        <source>Cell. Genet. Screens Cell</source>
        <year>2019</year>
        <volume>176</volume>
        <fpage>377</fpage>
        <lpage>390 e319</lpage>
      </element-citation>
    </ref>
    <ref id="CR29">
      <label>29.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Phanstiel</surname>
            <given-names>DH</given-names>
          </name>
          <name>
            <surname>Boyle</surname>
            <given-names>AP</given-names>
          </name>
          <name>
            <surname>Heidari</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Snyder</surname>
            <given-names>MP</given-names>
          </name>
        </person-group>
        <article-title>Mango: a bias-correcting ChIA-PET analysis pipeline</article-title>
        <source>Bioinformatics</source>
        <year>2015</year>
        <volume>31</volume>
        <fpage>3092</fpage>
        <lpage>3098</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btv336</pub-id>
        <pub-id pub-id-type="pmid">26034063</pub-id>
      </element-citation>
    </ref>
  </ref-list>
</back>
