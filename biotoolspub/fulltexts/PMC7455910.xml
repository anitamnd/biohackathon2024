<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName A++V2.4.dtd?>
<?SourceDTD.Version 2.4?>
<?ConverterInfo.XSLTName springer2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">BMC Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">BMC Bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>BMC Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="epub">1471-2105</issn>
    <publisher>
      <publisher-name>BioMed Central</publisher-name>
      <publisher-loc>London</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">7455910</article-id>
    <article-id pub-id-type="publisher-id">3715</article-id>
    <article-id pub-id-type="doi">10.1186/s12859-020-03715-y</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Methodology Article</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>MCMSeq: Bayesian hierarchical modeling of clustered and repeated measures RNA sequencing experiments</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author" equal-contrib="yes">
        <name>
          <surname>Vestal</surname>
          <given-names>Brian E.</given-names>
        </name>
        <address>
          <email>vestalb@njheath.org</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author" corresp="yes" equal-contrib="yes">
        <name>
          <surname>Moore</surname>
          <given-names>Camille M.</given-names>
        </name>
        <address>
          <email>mooreca@njheath.org</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Wynn</surname>
          <given-names>Elizabeth</given-names>
        </name>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Saba</surname>
          <given-names>Laura</given-names>
        </name>
        <xref ref-type="aff" rid="Aff3">3</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Fingerlin</surname>
          <given-names>Tasha</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Kechris</surname>
          <given-names>Katerina</given-names>
        </name>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <aff id="Aff1"><label>1</label><institution-wrap><institution-id institution-id-type="GRID">grid.240341.0</institution-id><institution-id institution-id-type="ISNI">0000 0004 0396 0728</institution-id><institution>Center for Genes, Environment and Health, National Jewish Health, </institution></institution-wrap>1400 Jackson St, Denver, 80206 CO USA </aff>
      <aff id="Aff2"><label>2</label><institution-wrap><institution-id institution-id-type="GRID">grid.430503.1</institution-id><institution-id institution-id-type="ISNI">0000 0001 0703 675X</institution-id><institution>Department of Biostatistics and Informatics, University of Colorado, Anschutz Medical Campus, </institution></institution-wrap>Aurora, CO USA </aff>
      <aff id="Aff3"><label>3</label><institution-wrap><institution-id institution-id-type="GRID">grid.266185.e</institution-id><institution-id institution-id-type="ISNI">0000000121090824</institution-id><institution>Department of Pharmaceutical Sciences, University of Colorado Skaggs School of Pharmacy and Pharmaceutical Sciences, </institution></institution-wrap>Aurora, CO USA </aff>
    </contrib-group>
    <pub-date pub-type="epub">
      <day>28</day>
      <month>8</month>
      <year>2020</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>28</day>
      <month>8</month>
      <year>2020</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2020</year>
    </pub-date>
    <volume>21</volume>
    <elocation-id>375</elocation-id>
    <history>
      <date date-type="received">
        <day>8</day>
        <month>5</month>
        <year>2020</year>
      </date>
      <date date-type="accepted">
        <day>18</day>
        <month>8</month>
        <year>2020</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2020</copyright-statement>
      <license license-type="OpenAccess">
        <license-p><bold>Open Access</bold> This article is licensed under a Creative Commons Attribution 4.0 International License, which permits use, sharing, adaptation, distribution and reproduction in any medium or format, as long as you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons licence, and indicate if changes were made. The images or other third party material in this article are included in the article’s Creative Commons licence, unless indicated otherwise in a credit line to the material. If material is not included in the article’s Creative Commons licence and your intended use is not permitted by statutory regulation or exceeds the permitted use, you will need to obtain permission directly from the copyright holder. To view a copy of this licence, visit <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>. The Creative Commons Public Domain Dedication waiver (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/publicdomain/zero/1.0/">http://creativecommons.org/publicdomain/zero/1.0/</ext-link>) applies to the data made available in this article, unless otherwise stated in a credit line to the data.</license-p>
      </license>
    </permissions>
    <abstract id="Abs1">
      <sec>
        <title>Background</title>
        <p id="Par1">As the barriers to incorporating RNA sequencing (RNA-Seq) into biomedical studies continue to decrease, the complexity and size of RNA-Seq experiments are rapidly growing. Paired, longitudinal, and other correlated designs are becoming commonplace, and these studies offer immense potential for understanding how transcriptional changes within an individual over time differ depending on treatment or environmental conditions. While several methods have been proposed for dealing with repeated measures within RNA-Seq analyses, they are either restricted to handling only paired measurements, can only test for differences between two groups, and/or have issues with maintaining nominal false positive and false discovery rates. In this work, we propose a Bayesian hierarchical negative binomial generalized linear mixed model framework that can flexibly model RNA-Seq counts from studies with arbitrarily many repeated observations, can include covariates, and also maintains nominal false positive and false discovery rates in its posterior inference.</p>
      </sec>
      <sec>
        <title>Results</title>
        <p id="Par2">In simulation studies, we showed that our proposed method (MCMSeq) best combines high statistical power (i.e. sensitivity or recall) with maintenance of nominal false positive and false discovery rates compared the other available strategies, especially at the smaller sample sizes investigated. This behavior was then replicated in an application to real RNA-Seq data where MCMSeq was able to find previously reported genes associated with tuberculosis infection in a cohort with longitudinal measurements.</p>
      </sec>
      <sec>
        <title>Conclusions</title>
        <p id="Par3">Failing to account for repeated measurements when analyzing RNA-Seq experiments can result in significantly inflated false positive and false discovery rates. Of the methods we investigated, whether they model RNA-Seq counts directly or worked on transformed values, the Bayesian hierarchical model implemented in the mcmseq R package (available at <ext-link ext-link-type="uri" xlink:href="https://github.com/stop-pre16/mcmseq">https://github.com/stop-pre16/mcmseq</ext-link>) best combined sensitivity and nominal error rate control.</p>
      </sec>
    </abstract>
    <kwd-group xml:lang="en">
      <title>Keywords</title>
      <kwd>RNA-Seq</kwd>
      <kwd>Markov chain Monte Carlo</kwd>
      <kwd>Longitudinal data</kwd>
      <kwd>Correlated data</kwd>
    </kwd-group>
    <custom-meta-group>
      <custom-meta>
        <meta-name>issue-copyright-statement</meta-name>
        <meta-value>© The Author(s) 2020</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec id="Sec1">
    <title>Background</title>
    <p>As the cost of sequencing decreases, the complexity and size of RNA sequencing (RNA-Seq) experiments are rapidly growing. In particular, paired, longitudinal and other correlated study designs are becoming commonplace [<xref ref-type="bibr" rid="CR1">1</xref>, <xref ref-type="bibr" rid="CR2">2</xref>]. Longitudinal studies of how gene expression changes over the disease course and under differing treatment and environmental conditions are critical to understanding how disease evolves in individual patients and for developing accurate biomarkers of disease progression and treatment response. However, the most popular RNA-Seq data analysis tools are not equipped to analyze correlated and longitudinal data [<xref ref-type="bibr" rid="CR3">3</xref>].</p>
    <p>Failing to account for correlation between repeated measurements can result in misleading inferences [<xref ref-type="bibr" rid="CR4">4</xref>]. For example, when estimating changes in gene expression over time, if there is strong within-subject correlation, estimated standard errors will be too large if correlation is ignored, reducing power to detect differential expression. As well-developed statistical methods and software tools are lacking, some have proposed analyzing correlated RNA-Seq data with DESeq2 or edgeR by including all levels of the clustering variable as fixed effects in the regression model [<xref ref-type="bibr" rid="CR3">3</xref>, <xref ref-type="bibr" rid="CR5">5</xref>]. In this case, the number of parameters necessary to account for correlation is equal to the number of subjects or clusters. This may result in a model that is too complex for the number of observations in the study, leading to overfitting. When overfitting is present, some of the findings of the analysis come from fitting noise, resulting in spurious associations that cannot be reproduced in future studies [<xref ref-type="bibr" rid="CR6">6</xref>]. Cui <italic>et al</italic> (2016) also noted that this strategy led to inflated false positive rates [<xref ref-type="bibr" rid="CR3">3</xref>]. In addition, if a regression parameter for each subject is included in a model, other effects of interest, such as group differences at individual time points, may not be estimable. Consequently, a method that can analyze RNA-Seq data in a flexible manner while including covariates and accounting for repeated measures is needed.</p>
    <p>As RNA-Seq data are over-dispersed counts, traditional linear mixed models, which assume a normal distribution, are inappropriate. In non-correlated settings, RNA-Seq data are typically modeled using a negative binomial (NB) distribution in a generalized linear model framework [<xref ref-type="bibr" rid="CR7">7</xref><italic>,</italic><xref ref-type="bibr" rid="CR8">8</xref>]. Since estimation of the dispersion parameter can be unstable or biased, particularly for data with low mean counts and small sample sizes [<xref ref-type="bibr" rid="CR9">9</xref><italic>–</italic><xref ref-type="bibr" rid="CR13">13</xref>], specialized RNA-Seq analysis packages, such as DESeq2 and edgeR, shrink estimates of dispersion parameters for individual genes towards a common estimate [<xref ref-type="bibr" rid="CR14">14</xref><italic>–</italic><xref ref-type="bibr" rid="CR16">16</xref>].</p>
    <p>The NB generalized linear mixed model (NBGLMM) is an extension of NB regression that allows for the inclusion of random effects to account for correlation between observations [<xref ref-type="bibr" rid="CR4">4</xref><italic>,</italic><xref ref-type="bibr" rid="CR17">17</xref>], and would seem a natural choice for the analysis of correlated RNA-Seq data. However, NBGLMMs do not have closed form solutions, and thus numerical optimization algorithms must be used to maximize the likelihood to obtain parameter estimates [<xref ref-type="bibr" rid="CR17">17</xref>]. With small to modest sample sizes, achieving a reliable level of convergence can be even more problematic than in traditional NB regression. There are also concerns about inflated false positive rates for both NB generalized linear models (NBGLM) and NBGLMMs, since standard errors for regression coefficients are estimated assuming that the NB dispersion parameter is known rather than estimated from the data [<xref ref-type="bibr" rid="CR18">18</xref>].</p>
    <p>There have been several recent developments in the analysis of correlated RNA-Seq data. For studies of related individuals, MACAU (Mixed model Association for Count data via data AUgmentation) [<xref ref-type="bibr" rid="CR19">19</xref>] uses a Poisson mixed model to account for relatedness and population structure within an RNA-Seq experiment by allowing the user to supply a known kinship matrix. Since the correlation structure is specified a priori, this method is not designed to analyze data from longitudinal studies where the expected correlation among samples is unknown. PLNSeq [<xref ref-type="bibr" rid="CR20">20</xref>] conducts differential expression analysis on RNA-Seq data generated from correlated samples, assuming the marginal distribution of the read counts is the compounding of the Poisson and the lognormal distributions; however, the method cannot adjust for covariates and can only be used to analyze data from single group study designs. The authors have also published a similar model using a Poisson Gamma formulation of the NB [<xref ref-type="bibr" rid="CR21">21</xref>].</p>
    <p>PairedFB is a Bayesian model that can test for differential expression between two groups when there are paired observations [<xref ref-type="bibr" rid="CR22">22</xref>]. However, this model is limited to paired observations and does not allow for additional covariates. ShrinkBayes is another Bayesian approach which uses a NB hierarchical model to account for clustering and to share information across genes when estimating dispersion parameters [<xref ref-type="bibr" rid="CR23">23</xref>]. Spike and slab shrinkage priors are used in an attempt to control false discovery rates (FDRs). The main drawbacks of this approach are that it is computationally intensive, it can be difficult for those unfamiliar with the method to develop reasonable priors (e.g. choose the form of prior for NB dispersion parameter) or make other modeling choices, and others have noted inflated error rates in some applications [<xref ref-type="bibr" rid="CR22">22</xref><italic>,</italic><xref ref-type="bibr" rid="CR24">24</xref>]. The VarSeq method from the tcgsaseq R package uses a variance component score test to identify gene sets whose expression varies over time and can account for repeated measures [<xref ref-type="bibr" rid="CR25">25</xref>]. While it is possible to apply these tests to individual genes, the method was developed and validated specifically for gene sets and testing characteristics for performing gene-wise tests is unknown. Lastly, tools from the limma R package, which was originally developed for the analysis of microarray experiments but can be applied to RNA-Seq data via the VOOM transformation, have also been proposed for situations with repeated measures [<xref ref-type="bibr" rid="CR26">26</xref><italic>–</italic><xref ref-type="bibr" rid="CR28">28</xref>]. In this process, the average correlation between repeated or clustered observations across all genes is computed, and this value is then accounted for during the linear model fits in a standard limma analysis. While mixed models are fit to estimate the duplicate-correlation measure, final inference is performed using standard limma regression models.</p>
    <p>In this work, we propose to model correlated and longitudinal RNA-Seq data using a simple Bayesian NB hierarchical model. This model allows for the inclusion of random effects that can be used to account for correlation between samples, which may occur in studies where subjects are followed over time, in studies of related individuals, such as paired siblings, or when multiple samples are taken from the same subject (for example, RNA-Seq on paired blood and biopsy samples). We use non-informative priors with large variances, making prior selection straightforward. If desired, information can be borrowed across genes when developing the prior for the dispersion parameter in a way that mimics the information sharing in edgeR and DESeq2. Unlike frequentist methods of estimation, estimates of variability for parameters and statistical tests account for the fact that dispersion parameters are estimated, resulting in better controlled false positive rates than frequentist NBGLMMs. We calculate a contour probability from the posterior distribution, a corollary to a two-sided <italic>p</italic>-value, which can undergo common FDR corrections. These methods are implemented in the mcmseq R package, which fits models with a Markov-chain Monte Carlo (MCMC) algorithm that has been optimized in C++ and can be run in parallel to speed computation time. We illustrate our methods in the analysis of publicly available longitudinal whole-blood RNA-Seq data from subjects with latent tuberculosis (TB) infection.</p>
  </sec>
  <sec id="Sec2">
    <title>Methods</title>
    <sec id="Sec3">
      <title>MCMSeq: a Bayesian NBGLMM for RNA-Seq data</title>
      <p>Similar to other commonly used RNA-Seq analysis tools, we model the observed data with a NB distribution using a log link function. To account for correlation, we allow random effects to be included in the model in a NBGLMM framework. Let <italic>Y</italic><sub><italic>gij</italic></sub> be the expression of gene <italic>g</italic> from subject <italic>i</italic> at time point or observation <italic>j</italic>, then
<disp-formula id="Equ1"><label>1</label><alternatives><tex-math id="M1">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$\begin{array}{@{}rcl@{}}  Y_{gij} &amp;\sim&amp; \mathcal{NB}\left(\mu_{gij}, \alpha_{g}\right) \\ \log\left(\mu_{gij}\right) &amp;=&amp; X_{ij}\boldsymbol{\beta_{g}} + Z_{ij}\boldsymbol{b_{gi}} + \rho_{ij}\\ \boldsymbol{b_{gi}} &amp;\sim&amp; \mathcal{N}\left(0, \Sigma_{g}\right)  \end{array} $$ \end{document}</tex-math><mml:math id="M2"><mml:mtable class="eqnarray" columnalign="left center right"><mml:mtr><mml:mtd class="eqnarray-1"><mml:msub><mml:mrow><mml:mi>Y</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">gij</mml:mtext></mml:mrow></mml:msub></mml:mtd><mml:mtd class="eqnarray-2"><mml:mo>∼</mml:mo></mml:mtd><mml:mtd class="eqnarray-3"><mml:mi mathvariant="script">N</mml:mi><mml:mi mathvariant="script">ℬ</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">gij</mml:mtext></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mi>g</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:mtd><mml:mtd><mml:mtext/></mml:mtd></mml:mtr><mml:mtr><mml:mtd class="eqnarray-1"><mml:mo>log</mml:mo><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">gij</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:mtd><mml:mtd class="eqnarray-2"><mml:mo>=</mml:mo></mml:mtd><mml:mtd class="eqnarray-3"><mml:msub><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ij</mml:mtext></mml:mrow></mml:msub><mml:mstyle mathvariant="bold-italic"><mml:msub><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:mi>g</mml:mi></mml:mrow></mml:msub></mml:mstyle><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>Z</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ij</mml:mtext></mml:mrow></mml:msub><mml:mstyle mathvariant="bold-italic"><mml:msub><mml:mrow><mml:mi>b</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">gi</mml:mtext></mml:mrow></mml:msub></mml:mstyle><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>ρ</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ij</mml:mtext></mml:mrow></mml:msub></mml:mtd></mml:mtr><mml:mtr><mml:mtd class="eqnarray-1"><mml:mstyle mathvariant="bold-italic"><mml:msub><mml:mrow><mml:mi>b</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">gi</mml:mtext></mml:mrow></mml:msub></mml:mstyle></mml:mtd><mml:mtd class="eqnarray-2"><mml:mo>∼</mml:mo></mml:mtd><mml:mtd class="eqnarray-3"><mml:mi mathvariant="script">N</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>Σ</mml:mi></mml:mrow><mml:mrow><mml:mi>g</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:mtd><mml:mtd><mml:mtext/></mml:mtd></mml:mtr></mml:mtable></mml:math><graphic xlink:href="12859_2020_3715_Article_Equ1.gif" position="anchor"/></alternatives></disp-formula></p>
      <p>where <italic>μ</italic><sub><italic>gij</italic></sub> is the mean expression of gene <italic>g</italic>∈{1,⋯,<italic>G</italic>} in subject <italic>i</italic>∈{1,⋯,<italic>I</italic>} at observation <italic>j</italic>∈{1,⋯,<italic>n</italic><sub><italic>i</italic></sub>} and <italic>α</italic><sub><italic>g</italic></sub> is the dispersion parameter for gene <italic>g</italic>, which is related to the variance of <italic>Y</italic><sub><italic>gij</italic></sub> by Var (<italic>Y</italic><sub><italic>gij</italic></sub>) = <inline-formula id="IEq1"><alternatives><tex-math id="M3">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\mu _{gij} + \alpha _{g} \mu _{gij}^{2}$\end{document}</tex-math><mml:math id="M4"><mml:msub><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">gij</mml:mtext></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mi>g</mml:mi></mml:mrow></mml:msub><mml:msubsup><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">gij</mml:mtext></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="12859_2020_3715_Article_IEq1.gif"/></alternatives></inline-formula>. <bold><italic>β</italic></bold><sub><bold><italic>g</italic></bold></sub> is a <italic>p</italic> x 1 vector of fixed effect regression coefficients for gene <italic>g</italic>, <italic>X</italic><sub><italic>ij</italic></sub> is a 1 x <italic>p</italic> row vector of fixed effects covariates for subject <italic>i</italic> at observation <italic>j</italic>, <bold><italic>b</italic></bold><sub><bold><italic>gi</italic></bold></sub> is a <italic>q</italic> x 1 vector of random effects for gene <italic>g</italic> and subject <italic>i</italic>, <italic>Z</italic><sub><italic>ij</italic></sub> is a 1 x <italic>q</italic> row vector of random effect covariates for subject <italic>i</italic> at observation <italic>j</italic>, and <italic>ρ</italic><sub><italic>ij</italic></sub> is an offset for subject <italic>i</italic> at observation <italic>j</italic>, which can be used to account for differences in sequencing depth between samples. A graphical representation of the hierarchical model is presented in Fig. <xref rid="Fig1" ref-type="fig">1</xref>. We assume that for each gene, the subject-specific random effects (e.g. random intercepts, random slopes or time effects for individuals or clusters) are normally distributed with mean 0 and variance <italic>Σ</italic><sub><italic>g</italic></sub>. In addition to accounting for repeated measures made on subjects in longitudinal studies, random effects can be used to account for correlation in other study designs, such as studies of related family members or paired siblings or studies in which RNA-Seq is performed on multiple types of samples (e.g. blood and biopsied tissue) from the same subject. This flexible framework also allows for the inclusion of both categorical and continuous covariates, where the latter can be modeled in a number of different ways (e.g. linear relationships, higher order polynomial terms, or even regression splines).
<fig id="Fig1"><label>Fig. 1</label><caption><p>Directed acyclic graph of the MCMSeq Model. Squares represent observed data, while circles represent model parameters to be estimated. Diamonds represent prior parameters and hyper-parameters. Solid arrows indicate stochastic dependence, while dashed arrows indicate deterministic dependence</p></caption><graphic xlink:href="12859_2020_3715_Fig1_HTML" id="MO1"/></fig></p>
    </sec>
    <sec id="Sec4">
      <title>Prior specification</title>
      <p>We fit the NBGLMM as a Bayesian hierarchical model using MCMC. The Bayesian NBGLMM is completed by specifying priors (and hyper-priors) for <bold><italic>β</italic></bold><sub><bold><italic>g</italic></bold></sub>, <italic>Σ</italic><sub><italic>g</italic></sub>, and <italic>α</italic><sub><italic>g</italic></sub>:
<disp-formula id="Equa"><alternatives><tex-math id="M5">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$\begin{array}{@{}rcl@{}} \boldsymbol{\beta_{g}} &amp;\sim&amp; \mathcal{MVN}\left(M_{g}, T\right)  \\ \Sigma_{g} &amp;\sim&amp; \mathcal{IW}(U, V) \\ \log\left(\alpha_{g}\right) &amp;\sim&amp; \mathcal{N}\left(A_{g}, B\right)  \end{array} $$ \end{document}</tex-math><mml:math id="M6"><mml:mtable class="eqnarray" columnalign="left center right"><mml:mtr><mml:mtd class="eqnarray-1"><mml:mstyle mathvariant="bold-italic"><mml:msub><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:mi>g</mml:mi></mml:mrow></mml:msub></mml:mstyle></mml:mtd><mml:mtd class="eqnarray-2"><mml:mo>∼</mml:mo></mml:mtd><mml:mtd class="eqnarray-3"><mml:mi mathvariant="script">ℳ</mml:mi><mml:mi mathvariant="script">V</mml:mi><mml:mi mathvariant="script">N</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mrow><mml:mi>M</mml:mi></mml:mrow><mml:mrow><mml:mi>g</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>T</mml:mi></mml:mrow></mml:mfenced></mml:mtd><mml:mtd><mml:mtext/></mml:mtd></mml:mtr><mml:mtr><mml:mtd class="eqnarray-1"><mml:msub><mml:mrow><mml:mi>Σ</mml:mi></mml:mrow><mml:mrow><mml:mi>g</mml:mi></mml:mrow></mml:msub></mml:mtd><mml:mtd class="eqnarray-2"><mml:mo>∼</mml:mo></mml:mtd><mml:mtd class="eqnarray-3"><mml:mi mathvariant="script">I</mml:mi><mml:mi mathvariant="script">W</mml:mi><mml:mo>(</mml:mo><mml:mi>U</mml:mi><mml:mo>,</mml:mo><mml:mi>V</mml:mi><mml:mo>)</mml:mo></mml:mtd><mml:mtd><mml:mtext/></mml:mtd></mml:mtr><mml:mtr><mml:mtd class="eqnarray-1"><mml:mo>log</mml:mo><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mi>g</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:mtd><mml:mtd class="eqnarray-2"><mml:mo>∼</mml:mo></mml:mtd><mml:mtd class="eqnarray-3"><mml:mi mathvariant="script">N</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mi>g</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>B</mml:mi></mml:mrow></mml:mfenced></mml:mtd><mml:mtd><mml:mtext/></mml:mtd></mml:mtr></mml:mtable></mml:math><graphic xlink:href="12859_2020_3715_Article_Equa.gif" position="anchor"/></alternatives></disp-formula></p>
      <p>where <italic>M</italic><sub><italic>g</italic></sub> is a vector of length <italic>p</italic> containing the prior means for the regression coefficients for gene <italic>g</italic>, <italic>T</italic> is a <italic>p</italic> x <italic>p</italic> covariance matrix, <inline-formula id="IEq2"><alternatives><tex-math id="M7">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\mathcal {MVN}$\end{document}</tex-math><mml:math id="M8"><mml:mi mathvariant="script">ℳ</mml:mi><mml:mi mathvariant="script">V</mml:mi><mml:mi mathvariant="script">N</mml:mi></mml:math><inline-graphic xlink:href="12859_2020_3715_Article_IEq2.gif"/></alternatives></inline-formula> is the multivariate normal distribution, and <inline-formula id="IEq3"><alternatives><tex-math id="M9">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\mathcal {IW}$\end{document}</tex-math><mml:math id="M10"><mml:mi mathvariant="script">I</mml:mi><mml:mi mathvariant="script">W</mml:mi></mml:math><inline-graphic xlink:href="12859_2020_3715_Article_IEq3.gif"/></alternatives></inline-formula> is the inverse Wishart distribution with <italic>q</italic> x <italic>q</italic> scale matrix <italic>U</italic> and <italic>V</italic>&gt;<italic>q</italic>−1 degrees of freedom. <italic>A</italic><sub><italic>g</italic></sub> is the prior mean of the log normal distribution for the dispersion parameter for gene <italic>g</italic> and <italic>B</italic> is the prior variance, which is common across genes.</p>
      <p>In practice, we set the first element of <italic>M</italic><sub><italic>g</italic></sub> (the prior mean for the intercept) to be the log of the mean number of counts across samples for that gene; all other elements of <italic>M</italic><sub><italic>g</italic></sub> are set to 0. This prior is uninformative, as it assumes that observations come from a common distribution with a single mean and that there are no differences between groups or time points. For <italic>T</italic>, we use a diagonal matrix with <italic>s</italic><sup>2</sup> on the diagonal, and choose <italic>s</italic><sup>2</sup>, the prior variance, to be large. We have used a prior variance of 7<sup>2</sup>=49 for all analyses in this paper. The influence of these hyperparameters on inference is well known. Choosing non-zero means for regression coefficients is uncommon and we do not recommend it; this could result in increases in type 1 errors for truly null genes and could also increase type 2 errors for differentially expressed genes if the differential expression is in the opposite direction of the assumed prior mean. For the prior variance <italic>T</italic>, choosing smaller values increases the influence of the prior on inference; assuming the priors for the regression coefficients are centered at zero, this could lead to a loss of power. The influence of prior hyper-parameters on inference diminishes with increasing sample size.</p>
      <p>We specify <italic>U</italic> as a <italic>q</italic> x <italic>q</italic> identity matrix and <italic>V</italic>=<italic>q</italic>+1. For models including a single random effect for each subject (i.e. <italic>q</italic>=1 as in our simulation study using a random intercept for each subject), we assume <italic>Σ</italic><sub><italic>g</italic></sub> has an inverse gamma prior with parameters <italic>U</italic> and <italic>V</italic>. The prior becomes more diffuse and uninformative as <italic>U</italic> and <italic>V</italic> decrease; therefore, we set these parameters to small values (e.g. 0.01) in order to be uninformative. We investigated the influence of choice of <italic>U</italic> and <italic>V</italic> in our simulation study in <xref rid="MOESM1" ref-type="media">Supplementary materials</xref> Section 2.3.5 and found values of 0.1, 0.01, 0.001 all maintained false discovery rates at or below their nominal levels; however, the most informative prior (value of 0.1) resulted in a loss of power for between subject tests and slightly inflated type 1 error rates for within subject and interaction tests. Therefore, we recommend values of 0.01 and smaller.</p>
      <p>To stabilize estimation of the dispersion parameter at small sample sizes, we share information across genes when specifying the log normal prior for the dispersion parameter in a similar spirit to the dispersion estimation in the DESeq2 pipeline [<xref ref-type="bibr" rid="CR15">15</xref>]. First, for each gene, we calculate the average log(CPM) across samples and a naïve method-of-moments estimate of the dispersion parameter. The naïve estimate is calculated by first scaling the data to the median library size and then calculating the mean, <italic>m</italic><sub><italic>g</italic></sub>, and variance, <italic>v</italic><sub><italic>g</italic></sub> of the scaled counts for each gene. The naïve dispersion estimate for each gene is given by <inline-formula id="IEq4"><alternatives><tex-math id="M11">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\frac {v_{g} - m_{g}}{m_{g}^{2}}$\end{document}</tex-math><mml:math id="M12"><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi>v</mml:mi></mml:mrow><mml:mrow><mml:mi>g</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mi>g</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msubsup><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mi>g</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:mrow></mml:mfrac></mml:math><inline-graphic xlink:href="12859_2020_3715_Article_IEq4.gif"/></alternatives></inline-formula>. Locally weighted polynomial regression (LOESS) is then used to model the relationship between the log of the method-of-moments dispersion estimates and the average log(CPM). <italic>A</italic><sub><italic>g</italic></sub> is then set to the expected log(dispersion) at the average log(CPM) for gene <italic>g</italic> based on the LOESS regression. <italic>B</italic> is set to (<italic>k</italic>·<italic>τ</italic>)<sup>2</sup> where <italic>k</italic> is an inflation factor and <italic>τ</italic> is the residual standard deviation from the LOESS fit. The method-of-moments dispersion estimates are over-estimates since they do not take into account fixed or random effects that explain variability in the data. Therefore, we typically choose <italic>k</italic>&gt;1 in order to include a larger range of potential dispersion values in our prior. In practice, we have found a <italic>k</italic> of 2 tends to work well and use <italic>k</italic>=2 for all analyses presented in this paper (See <xref rid="MOESM1" ref-type="media">Supplementary material</xref> Section 2.3.6 for simulation studies showing the influence of <italic>k</italic> on testing characteristics). Type 1 error rates and FDR increase with k, such that values of <italic>k</italic>&lt;2 tend to be more conservative and values of <italic>k</italic>&gt;2 are more liberal. As sample size increases, the dispersion prior has less influence and all values of <italic>k</italic> perform similarly.</p>
    </sec>
    <sec id="Sec5">
      <title>Posterior estimation and convergence criteria</title>
      <p>Posterior estimation is performed with a hybrid Metropolis-Hastings/Gibbs MCMC sampler (see <xref rid="MOESM1" ref-type="media">Supplementary materials</xref> Section 1.1 for detailed steps). A weighted least squares (WLS) proposal, as introduced by Gamerman [<xref ref-type="bibr" rid="CR29">29</xref>], is used to jointly update <bold><italic>β</italic></bold><sub><bold><italic>g</italic></bold></sub> and <bold><italic>b</italic></bold><sub><bold><italic>g</italic></bold></sub>; <italic>α</italic><sub><italic>g</italic></sub> is updated using a random walk proposal and <italic>Σ</italic><sub><italic>g</italic></sub> can be updated using an appropriate Gibbs step. In this framework, the posterior distribution of regression coefficients naturally incorporates the uncertainty associated with simultaneous estimation of the dispersion parameter. Access to the full posterior distribution also makes inference about quantities that involve complex combinations of model parameters (e.g. the heritability calculation from Rudra et al.) straightforward [<xref ref-type="bibr" rid="CR30">30</xref>].</p>
      <p>Convergence of the chain for each gene is examined in two ways: acceptance rate and Geweke statistics comparing the first 20% of the chain (after discarding burn-in) to the final 50% of the chain [<xref ref-type="bibr" rid="CR31">31</xref>]. For each gene, acceptance probabilities are computed for the vector of regression coefficients <bold><italic>β</italic></bold><sub><bold><italic>g</italic></bold></sub> and the dispersion parameter <italic>α</italic><sub><italic>g</italic></sub>; <italic>Σ</italic><sub><italic>g</italic></sub> is always accepted and thus ignored for this diagnostic. Additionally, <italic>p</italic>-values for the Geweke statistics (i.e. t-tests) are calculated for all model parameters, and are then adjusted for multiple comparisons across genes using the Benjamini-Hochberg method [<xref ref-type="bibr" rid="CR32">32</xref>]. We deemed any gene that had an acceptance rate &lt;10% or an adjusted Geweke p-vlaue &lt;0.05 for any model parameter to be a convergence failure. See <xref rid="MOESM1" ref-type="media">Supplementary materials</xref> Section 1.3 for more details.</p>
    </sec>
    <sec id="Sec6">
      <title>Posterior inference and adjustments for multiple comparisons</title>
      <p>To perform posterior inference on individual regression parameters (or linear combinations of regression parameters), there are multiple potential approaches. One option is to use Bayes factors to compare the likelihood of a given parameter value in the prior versus the posterior distribution. A major drawback of this approach is that adjusting for multiple comparisons when using Bayes factors is not well characterized. Alternatively, we use the contour probability originally proposed by Box and Tiao [<xref ref-type="bibr" rid="CR33">33</xref>], which can be thought of as the Bayesian corollary to a two-sided <italic>p</italic>-value for the null hypothesis that a parameter <italic>θ</italic> equals a given value <italic>θ</italic><sub>0</sub> (See <xref rid="MOESM1" ref-type="media">Supplementary</xref> Fig. 1). Formally, the contour probability <italic>p</italic><sub><italic>c</italic></sub> is defined as
<disp-formula id="Equ2"><label>2</label><alternatives><tex-math id="M13">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$ p_{c} = 1 - P\left(p(\theta|Y) &gt; p(\theta_{0}|Y)\right)  $$ \end{document}</tex-math><mml:math id="M14"><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mi>c</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>P</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:mi>p</mml:mi><mml:mo>(</mml:mo><mml:mi>θ</mml:mi><mml:mo>|</mml:mo><mml:mi>Y</mml:mi><mml:mo>)</mml:mo><mml:mo>&gt;</mml:mo><mml:mi>p</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>θ</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:mi>Y</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mfenced></mml:math><graphic xlink:href="12859_2020_3715_Article_Equ2.gif" position="anchor"/></alternatives></disp-formula></p>
      <p>Since the NBGLMM does not have a closed-form posterior distribution, Monte Carlo estimation is required. One strategy for computing <italic>p</italic><sub><italic>c</italic></sub> in this scenario is to construct a smoothed approximation of the posterior distribution using kernel density estimation with the MCMC sample {<italic>θ</italic><sup>(1)</sup>,⋯,<italic>θ</italic><sup><italic>k</italic></sup>}, and to then estimate <italic>p</italic><sub><italic>c</italic></sub> as the proportion of samples for which <italic>p</italic>(<italic>θ</italic><sub>0</sub>|<italic>Y</italic>)&gt;<italic>p</italic>(<italic>θ</italic><sup>(<italic>k</italic>)</sup>|<italic>Y</italic>). However, the results are dependent on the choice of kernel function and smoothing bandwidth [<xref ref-type="bibr" rid="CR34">34</xref><italic>,</italic><xref ref-type="bibr" rid="CR35">35</xref>]. To avoid this problem, we instead take a simplified approach by estimating the contour probability as
<disp-formula id="Equ3"><label>3</label><alternatives><tex-math id="M15">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$ p_{c} = 2 \cdot \frac{1}{k} \sum\limits_{j=1}^{k} I_{\left(\theta^{(j)} \cdot \hat{\theta}\right) &lt; 0}  $$ \end{document}</tex-math><mml:math id="M16"><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mi>c</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>2</mml:mn><mml:mo>·</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:mfrac><mml:munderover accent="false" accentunder="false"><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:munderover><mml:msub><mml:mrow><mml:mi>I</mml:mi></mml:mrow><mml:mrow><mml:mfenced close=")" open="("><mml:mrow><mml:msup><mml:mrow><mml:mi>θ</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>j</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msup><mml:mo>·</mml:mo><mml:mover accent="true"><mml:mrow><mml:mi>θ</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow></mml:mfenced><mml:mo>&lt;</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:math><graphic xlink:href="12859_2020_3715_Article_Equ3.gif" position="anchor"/></alternatives></disp-formula></p>
      <p>where <italic>I</italic> is an indicator function and <inline-formula id="IEq5"><alternatives><tex-math id="M17">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\hat {\theta }$\end{document}</tex-math><mml:math id="M18"><mml:mover accent="true"><mml:mrow><mml:mi>θ</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:math><inline-graphic xlink:href="12859_2020_3715_Article_IEq5.gif"/></alternatives></inline-formula> is the posterior median of <italic>θ</italic>. That is, we estimate the contour probability as twice the proportion of MCMC samples that lie on the opposite side of 0 as the posterior median, which is twice the posterior probability of the null in a one-sided hypothesis testing framework (See <xref rid="MOESM1" ref-type="media">Supplementary</xref> Fig. 2).</p>
      <p>The final step is to account for multiple comparisons. A common Bayesian FDR control approach is to construct a set of features (i.e. genes) for which the average posterior probability of being differentially expressed is above some threshold (or equivalently, that the average probability of being equally expressed is below some threshold) [<xref ref-type="bibr" rid="CR36">36</xref>]. In this context with contour probabilities and a target FDR level <italic>α</italic>, the procedure would entail sorting the gene-specific <inline-formula id="IEq6"><alternatives><tex-math id="M19">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$p_{c}^{(g)}$\end{document}</tex-math><mml:math id="M20"><mml:msubsup><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>g</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="12859_2020_3715_Article_IEq6.gif"/></alternatives></inline-formula>’s for a given parameter in ascending order, and then finding the cutoff point <inline-formula id="IEq7"><alternatives><tex-math id="M21">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$l^{*} = \max \left \{l: \frac {1}{l} {\sum \nolimits }_{j=1}^{l} p_{c}^{(j)} &lt; \alpha \right \}$\end{document}</tex-math><mml:math id="M22"><mml:msup><mml:mrow><mml:mi>l</mml:mi></mml:mrow><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mo>max</mml:mo><mml:mfenced close="}" open="{"><mml:mrow><mml:mi>l</mml:mi><mml:mo>:</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:mfrac><mml:munderover accent="false" accentunder="false"><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:munderover><mml:msubsup><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>j</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msubsup><mml:mo>&lt;</mml:mo><mml:mi>α</mml:mi></mml:mrow></mml:mfenced></mml:math><inline-graphic xlink:href="12859_2020_3715_Article_IEq7.gif"/></alternatives></inline-formula>. We investigated using this strategy, but found it resulted in substantial FDR inflation (see <xref rid="MOESM1" ref-type="media">Supplementary</xref> Table 2), and thus quickly abandoned it. Instead we apply a Benjamini-Hochberg procedure for controlling FDRs to the contour probabilities. While the Benjamini-Hochberg method was developed for application to <italic>p</italic>-values, the relationship between one-sided posterior probabilities and one-sided <italic>p</italic>-values has been discussed by Casella and Berger [<xref ref-type="bibr" rid="CR37">37</xref>]. Moreover, in our simulations, contour probabilities behaved very much like traditional <italic>p</italic>-values for features that showed no true differences; their distributions were nearly uniform (<xref rid="MOESM1" ref-type="media">Supplementary</xref> Fig. 3). We found this method controlled FDRs very well in our simulation studies and has been used to generate all results presented in this paper. For more details see <xref rid="MOESM1" ref-type="media">Supplementary materials</xref> Section 1.2.</p>
    </sec>
    <sec id="Sec7">
      <title>Implementation</title>
      <p>The MCMSeq method is implemented in the mcmseq R package, which contains a detailed vignette that illustrates these methods on a simulated data set. The package is written in C++ via the Rcpp, RcppArmadillo, and RcppParallel R packages, the last of which allows the chains for each gene to be automatically run in parallel to shorten computation time [<xref ref-type="bibr" rid="CR38">38</xref><italic>–</italic><xref ref-type="bibr" rid="CR40">40</xref>]. In the fitting function, users can specify all hyper-parameters in the priors, though non-informative values that generally worked well in the simulation studies and real data applications are provided as defaults.</p>
      <p>While MCMC samplers for Bayesian hierarchical negative binomial models can be developed and fit with other packages or software, such as STAN [<xref ref-type="bibr" rid="CR41">41</xref>], OpenBugs [<xref ref-type="bibr" rid="CR42">42</xref>], or SAS software’s MCMC procedure, these are general Bayesian model fitting tools that have not been optimized for high-throughput analysis of RNA-Seq data. As such, the user would be required to write additional code to specify the model, fit the model to each gene, and to summarize results over all genes. In addition, since these are general tools, samplers may not be the most efficient for fitting NBGLMMs. For example, we explored fitting our proposed model to a single feature in the N=3 simulated datasets using the rstan package [<xref ref-type="bibr" rid="CR43">43</xref>]. This took approximately 2.5 minutes; for a typical RNA-Seq dataset of 15,000 genes, this would result in 620 hours of computation time, compared to approximately 30 minutes for the same dataset using mcmseq. The mcmseq package makes fitting Bayesian NBGLMMs more accessible by automating the process of model fitting and summarizing results over tens of thousands of genes typically found in an RNA-Seq analysis.</p>
    </sec>
    <sec id="Sec8">
      <title>Simulation study</title>
      <sec id="Sec9">
        <title>Data generation</title>
        <p>To evaluate the testing characteristics of MCMSeq and to compare to other potential analysis strategies, we performed a simulation study. Datasets were simulated using a two group design (e.g. treatment and control) with paired observations (e.g. baseline and follow-up) on each subject. Count data were simulated from a NB distribution as follows:
<disp-formula id="Equ4"><label>4</label><alternatives><tex-math id="M23">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$\begin{array}{@{}rcl@{}}  Y_{gij} &amp;\sim&amp; \mathcal{NB}\left(\mu_{gij}, \alpha_{g}\right)  \\ \log\left(\mu_{gij}\right) &amp;=&amp; \beta_{g0} + \beta_{g1} I_{T_{i}} + \beta_{g2} I_{F_{ij}} + \beta_{g3}I_{T_{i}} I_{F_{ij}} + b_{gi}  \\ b_{gi} &amp;\sim&amp; \mathcal{N}\left(0, \sigma_{gb}^{2}\right) \end{array} $$ \end{document}</tex-math><mml:math id="M24"><mml:mtable class="eqnarray" columnalign="left center right"><mml:mtr><mml:mtd class="eqnarray-1"><mml:msub><mml:mrow><mml:mi>Y</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">gij</mml:mtext></mml:mrow></mml:msub></mml:mtd><mml:mtd class="eqnarray-2"><mml:mo>∼</mml:mo></mml:mtd><mml:mtd class="eqnarray-3"><mml:mi mathvariant="script">N</mml:mi><mml:mi mathvariant="script">ℬ</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">gij</mml:mtext></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mi>g</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:mtd><mml:mtd><mml:mtext/></mml:mtd></mml:mtr><mml:mtr><mml:mtd class="eqnarray-1"><mml:mo>log</mml:mo><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">gij</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:mtd><mml:mtd class="eqnarray-2"><mml:mo>=</mml:mo></mml:mtd><mml:mtd class="eqnarray-3"><mml:msub><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:mi>g</mml:mi><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:mi>g</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>I</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:mi>g</mml:mi><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>I</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>F</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ij</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:mi>g</mml:mi><mml:mn>3</mml:mn></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>I</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>I</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>F</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ij</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>b</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">gi</mml:mtext></mml:mrow></mml:msub></mml:mtd><mml:mtd><mml:mtext/></mml:mtd></mml:mtr><mml:mtr><mml:mtd class="eqnarray-1"><mml:msub><mml:mrow><mml:mi>b</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">gi</mml:mtext></mml:mrow></mml:msub></mml:mtd><mml:mtd class="eqnarray-2"><mml:mo>∼</mml:mo></mml:mtd><mml:mtd class="eqnarray-3"><mml:mi mathvariant="script">N</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">gb</mml:mtext></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:mrow></mml:mfenced></mml:mtd></mml:mtr></mml:mtable></mml:math><graphic xlink:href="12859_2020_3715_Article_Equ4.gif" position="anchor"/></alternatives></disp-formula></p>
        <p>where <inline-formula id="IEq8"><alternatives><tex-math id="M25">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$I_{T_{i}}$\end{document}</tex-math><mml:math id="M26"><mml:msub><mml:mrow><mml:mi>I</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12859_2020_3715_Article_IEq8.gif"/></alternatives></inline-formula> is an indicator function that equals 1 if subject <italic>i</italic> is in the treatment group, <inline-formula id="IEq9"><alternatives><tex-math id="M27">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$I_{F_{ij}}$\end{document}</tex-math><mml:math id="M28"><mml:msub><mml:mrow><mml:mi>I</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>F</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ij</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12859_2020_3715_Article_IEq9.gif"/></alternatives></inline-formula> is a similar indicator for if observation <italic>j</italic> is the follow-up, and <italic>b</italic><sub><italic>gi</italic></sub> is the random intercept for gene <italic>g</italic> and subject <italic>i</italic>. Simulated data sets were generated with a combination of null and differentially expressed (mixed effect sizes) features, as summarized in Table <xref rid="Tab1" ref-type="table">1</xref>. In order to mimic real data as much as possible, values for <italic>β</italic><sub><italic>g</italic>0</sub>, <italic>α</italic><sub><italic>g</italic></sub>, and <inline-formula id="IEq10"><alternatives><tex-math id="M29">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\sigma _{gb}^{2}$\end{document}</tex-math><mml:math id="M30"><mml:msubsup><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">gb</mml:mtext></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="12859_2020_3715_Article_IEq10.gif"/></alternatives></inline-formula> were drawn from an empirical distribution of mean counts per million (CPM), dispersion (<italic>α</italic><sub><italic>g</italic></sub>), and random intercept variance <inline-formula id="IEq11"><alternatives><tex-math id="M31">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\left (\sigma _{gb}^{2}\right)$\end{document}</tex-math><mml:math id="M32"><mml:mfenced close=")" open="("><mml:mrow><mml:msubsup><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">gb</mml:mtext></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:mrow></mml:mfenced></mml:math><inline-graphic xlink:href="12859_2020_3715_Article_IEq11.gif"/></alternatives></inline-formula> observed across human samples in several real RNA-Seq data sets that had repeated measures [<xref ref-type="bibr" rid="CR1">1</xref><italic>,</italic><xref ref-type="bibr" rid="CR2">2</xref>] (<xref rid="MOESM1" ref-type="media">Supplementary materials</xref> Section 2.1).
<table-wrap id="Tab1"><label>Table 1</label><caption><p>Summary of simulated datasets</p></caption><table frame="hsides" rules="groups"><tbody><tr><td align="left"><bold>Number of datasets</bold></td><td align="left">10</td></tr><tr><td align="left"><bold>Number of features per dataset</bold></td><td align="left">15,000</td></tr><tr><td align="left"><bold>Sample sizes</bold></td><td align="left">3, 5, and 10 per group</td></tr><tr><td align="left"/><td align="left">(6, 10 and 20 total)</td></tr><tr><td align="left"><bold>Model parameters</bold></td><td align="left"/></tr><tr><td align="left"><italic>β</italic><sub><italic>g</italic>1</sub>: Difference in log(expression) between</td><td align="left">0 (all features)</td></tr><tr><td align="left">treatment and control at baseline</td><td align="left"/></tr><tr><td align="left"><italic>β</italic><sub><italic>g</italic>2</sub>: Change in log(expression) over time</td><td align="left">0 (all features)</td></tr><tr><td align="left">in the control group</td><td align="left"/></tr><tr><td align="left"><italic>β</italic><sub><italic>g</italic>3</sub>: Difference in change in log(expression)</td><td align="left">0 (80% of features)</td></tr><tr><td align="left">over time between the treatment and</td><td align="left">ES<sup>1</sup> (10% of features), -ES (10% of features)</td></tr><tr><td align="left">control groups</td><td align="left"/></tr><tr><td align="left"><italic>β</italic><sub><italic>g</italic>0</sub>, <italic>α</italic><sub><italic>g</italic></sub>, <inline-formula id="IEq12"><alternatives><tex-math id="M33">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\sigma _{gb}^{2}$\end{document}</tex-math><mml:math id="M34"><mml:msubsup><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">gb</mml:mtext></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="12859_2020_3715_Article_IEq12.gif"/></alternatives></inline-formula></td><td align="left">Drawn from an empirical distribution based on human</td></tr><tr><td align="left"/><td align="left">samples in real RNA-Seq data sets with repeated measures</td></tr><tr><td align="left"><bold>Additional comparisons</bold></td><td align="left"/></tr><tr><td align="left"><italic>β</italic><sub><italic>g</italic>1</sub>+<italic>β</italic><sub><italic>g</italic>3</sub>: difference in log(expression)</td><td align="left">0 (80% of features)</td></tr><tr><td align="left">between control and treatment at</td><td align="left">ES (10% of features), -ES (10% of features)</td></tr><tr><td align="left">follow-up</td><td align="left"/></tr><tr><td align="left"><italic>β</italic><sub><italic>g</italic>2</sub>+<italic>β</italic><sub><italic>g</italic>3</sub>: Change in log(expression)</td><td align="left">0 (80% of features)</td></tr><tr><td align="left">over time in the treatment group</td><td align="left">ES (10% of features), -ES (10% of features)</td></tr></tbody></table><table-wrap-foot><p><sup>1</sup>ES is drawn from a Gamma distribution with mode of log(2) and a standard deviation of 0.5</p></table-wrap-foot></table-wrap></p>
      </sec>
      <sec id="Sec10">
        <title>Methods compared and implementation</title>
        <p>We analyzed each simulated data set using the methods described in Table <xref rid="Tab2" ref-type="table">2</xref> (see also <xref rid="MOESM1" ref-type="media">Supplementary materials</xref> Section 2.2). Genes were filtered from the analysis if &gt;75% of the samples had less than 1 CPM (i.e. at least <italic>m</italic> samples must have a CPM &gt;1 where <italic>m</italic> is the number of samples in the smallest experimental unit of interest). We also tested the sensitivity of our simulation results to additional filtering schemes and found similar testing characteristics and relative performance of the methods. See <xref rid="MOESM1" ref-type="media">Supplementary materials</xref> Section 2.3.7 for full details. To account for differences in library size between samples, we used the default median of ratios method for DESeq2 and the trimmed mean of M values for edgeR. For MCMSeq, CPGLMM, NBGLMM and ShrinkBayes, we took the natural log of the DESeq2 median of ratios values as an offset. VarSeq, limma, and LMM use transformed counts and do not require an offset. For edgeR and DESeq2, models were fit ignoring correlation (dropping the random effect terms from Eq. <xref rid="Equ4" ref-type="">4</xref>) and accounting for correlation by replacing the random effects <italic>b</italic><sub><italic>gi</italic></sub> from Eq. <xref rid="Equ4" ref-type="">4</xref> with fixed effects (edgeR* and DESeq2*). This requires removing both the intercept (<italic>β</italic><sub><italic>g</italic>0</sub>) and the main effect of treatment (<italic>β</italic><sub><italic>g</italic>1</sub>) from the model, as they are not estimable. For all other methods, both fixed and random effects were included in the model as specified in Eq. <xref rid="Equ4" ref-type="">4</xref>. A summary of the practical and theoretical advantages and disadvantages for each of the methods and their software implementations can be found in <xref rid="MOESM1" ref-type="media">Supplementary</xref> Table 1.
<table-wrap id="Tab2"><label>Table 2</label><caption><p>Summary of methods compared</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left"><bold>Method</bold></th><th align="left"><bold>R-Package</bold></th><th align="left"><bold>Description</bold></th><th align="left"><bold>Reference</bold></th></tr></thead><tbody><tr><td align="left">MCMSeq</td><td align="left">mcmseq</td><td align="left">Bayesian negative binomial hierarchical model, assuming the following</td><td align="left"/></tr><tr><td align="left"/><td align="left"/><td align="left">hyper-parameters: <italic>T</italic>=7<sup>2</sup><italic>I</italic><sub>4</sub>, where <italic>I</italic><sub>4</sub> is a 4 x 4 identity matrix, <italic>U</italic>=</td><td align="left"/></tr><tr><td align="left"/><td align="left"/><td align="left"><italic>V</italic>=0.01, <italic>A</italic><sub><italic>g</italic></sub>= centered on empirical prior as described in 2.3, <inline-formula id="IEq13"><alternatives><tex-math id="M35">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$B=4\cdot \sigma ^{2}_{re}$\end{document}</tex-math><mml:math id="M36"><mml:mi>B</mml:mi><mml:mo>=</mml:mo><mml:mn>4</mml:mn><mml:mo>·</mml:mo><mml:msubsup><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">re</mml:mtext></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="12859_2020_3715_Article_IEq13.gif"/></alternatives></inline-formula></td><td align="left"/></tr><tr><td align="left"/><td align="left"/><td align="left">Chains were run for 30,000 iterations and 10% was discarded as burn-in.</td><td align="left"/></tr><tr><td align="left">CPGLMM <sup><italic>‡</italic></sup></td><td align="left">cplm</td><td align="left">Compound Poisson generalized linear mixed model fit using maximum</td><td align="left">[<xref ref-type="bibr" rid="CR44">44</xref>]</td></tr><tr><td align="left"/><td align="left"/><td align="left">likelihood.</td><td align="left"/></tr><tr><td align="left">DESeq2*</td><td align="left">DESeq2</td><td align="left">DESeq2 analysis using default settings. To account for correlation,</td><td align="left">[<xref ref-type="bibr" rid="CR15">15</xref>]</td></tr><tr><td align="left"/><td align="left"/><td align="left">subjects are included as fixed effects in the model by replacing the</td><td align="left"/></tr><tr><td align="left"/><td align="left"/><td align="left">random effects in Equation 4 with fixed effects.</td><td align="left"/></tr><tr><td align="left">DESeq2</td><td align="left">DESeq2</td><td align="left">DESeq2 analysis using default settings, including only fixed effects in</td><td align="left">[<xref ref-type="bibr" rid="CR15">15</xref>]</td></tr><tr><td align="left"/><td align="left"/><td align="left">Equation 4. Correlation is ignored.</td><td align="left"/></tr><tr><td align="left">edgeR*</td><td align="left">edgeR</td><td align="left">edgeR analysis using default settings. To account for correlation,</td><td align="left">[<xref ref-type="bibr" rid="CR14">14</xref>]</td></tr><tr><td align="left"/><td align="left"/><td align="left">subjects are included as fixed effects in the model by replacing the</td><td align="left"/></tr><tr><td align="left"/><td align="left"/><td align="left">random effects in Equation 4 with fixed effects.</td><td align="left"/></tr><tr><td align="left">edgeR</td><td align="left">edgeR</td><td align="left">edgeR analysis using default settings, including only fixed effects in</td><td align="left">[<xref ref-type="bibr" rid="CR14">14</xref>]</td></tr><tr><td align="left"/><td align="left"/><td align="left">Equation 4. Correlation is ignored.</td><td align="left"/></tr><tr><td align="left">limma</td><td align="left">limma</td><td align="left">Count data were transformed for analysis with limma using voom.</td><td align="left">[<xref ref-type="bibr" rid="CR26">26</xref>]</td></tr><tr><td align="left"/><td align="left"/><td align="left">The duplicateCorrelation function using subject id as the blocking</td><td align="left">[<xref ref-type="bibr" rid="CR27">27</xref>]</td></tr><tr><td align="left"/><td align="left"/><td align="left">factor was used to account for correlation.</td><td align="left"/></tr><tr><td align="left">LMM</td><td align="left">lmerTest</td><td align="left">Data were first transformed using DESeq2’s variance stabilizing</td><td align="left">[<xref ref-type="bibr" rid="CR45">45</xref>]</td></tr><tr><td align="left"/><td align="left"/><td align="left">transformation. Linear mixed models, which assume a normally</td><td align="left"/></tr><tr><td align="left"/><td align="left"/><td align="left">distributed errors, were then fit to the transformed counts.</td><td align="left"/></tr><tr><td align="left">MACAU</td><td align="left">MACAU2</td><td align="left">Poisson GLMM with random effects to account for over-dispersion and</td><td align="left">[<xref ref-type="bibr" rid="CR19">19</xref>]</td></tr><tr><td align="left"/><td align="left"/><td align="left">correlation among observations. A known covariance matrix must be supplied;</td><td align="left"/></tr><tr><td align="left"/><td align="left"/><td align="left">we used the covariance of the centered and scaled gene expression matrix as</td><td align="left"/></tr><tr><td align="left"/><td align="left"/><td align="left">shown in the third example of [<xref ref-type="bibr" rid="CR19">19</xref>].</td><td align="left"/></tr><tr><td align="left">NBGLMM</td><td align="left">glmmADMB</td><td align="left">Frequentist negative binomial generalized linear mixed model fit using</td><td align="left">[<xref ref-type="bibr" rid="CR46">46</xref>]</td></tr><tr><td align="left"/><td align="left"/><td align="left">maximum likelihood.</td><td align="left"/></tr><tr><td align="left">ShrinkBayes</td><td align="left">ShrinkBayes</td><td align="left">Bayesian hierarchical model using shrinkage priors to control false</td><td align="left">[<xref ref-type="bibr" rid="CR23">23</xref>]</td></tr><tr><td align="left"/><td align="left"/><td align="left">discovery rates. We used a negative binomial distribution for the count</td><td align="left"/></tr><tr><td align="left"/><td align="left"/><td align="left">data and shrinkage priors for all model parameters involved in statistical</td><td align="left"/></tr><tr><td align="left"/><td align="left"/><td align="left">tests. All other parameters were set to default values.</td><td align="left"/></tr><tr><td align="left">VarSeq <sup><italic>‡</italic></sup></td><td align="left">tcgsaseq</td><td align="left">Model free method for identifying gene sets whose expression changes</td><td align="left">[<xref ref-type="bibr" rid="CR25">25</xref>]</td></tr><tr><td align="left"/><td align="left"/><td align="left">over time. Counts are transformed to log(CPM) for analysis. The</td><td align="left"/></tr><tr><td align="left"/><td align="left"/><td align="left">asymptotic test was used to generate <italic>p</italic>-values.</td><td align="left"/></tr></tbody></table><table-wrap-foot><p><sup><italic>‡</italic></sup>Results presented in <xref rid="MOESM1" ref-type="media">Supplementary materials</xref>, Section 2.3</p></table-wrap-foot></table-wrap></p>
        <p>We compare the performance of these analysis strategies in terms of type 1 error rate, FDR, and power (recall) for three statistical tests. First, <italic>β</italic><sub><italic>g</italic>1</sub>+<italic>β</italic><sub><italic>g</italic>3</sub>=0 tests for differences in expression between the treatment and the control group at follow-up. We refer to this as a “between-subject” test, as inference involves only independent observations. Second, <italic>β</italic><sub><italic>g</italic>2</sub>+<italic>β</italic><sub><italic>g</italic>3</sub>=0 tests for a change in expression over time in the treatment group. We refer to this as a “within-subject” test as inference involves the paired observations. Lastly <italic>β</italic><sub><italic>g</italic>3</sub>=0 tests if there is a difference in the change in expression over time between the treatment and control groups. We refer to this as an “interaction” test, which depends on both between- and within-subject information. For each simulation scenario, we calculate type 1 error rate, FDR, and power for each contrast within each dataset and then average across the 10 datasets. We evaluate these characteristics over a range of significance thresholds (Table <xref rid="Tab3" ref-type="table">3</xref>). To evaluate power and FDR, we first applied a Benjamini-Hochberg correction to the <italic>p</italic>-values for each contrast within each dataset[<xref ref-type="bibr" rid="CR32">32</xref>]. However, this correction was not applied to results from ShrinkBayes, as ShrinkBayes reports Bayesian FDR values rather than <italic>p</italic>-values.
<table-wrap id="Tab3"><label>Table 3</label><caption><p>Testing characteristics compared</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left">Characteristic</th><th align="left">Description</th><th align="left">Significance Thresholds</th><th align="left">P-Value</th></tr></thead><tbody><tr><td align="left">Type 1 Error Rate</td><td align="left"><inline-formula id="IEq14"><alternatives><tex-math id="M37">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\frac {\text {N false positives}} {\text {N null genes}}$\end{document}</tex-math><mml:math id="M38"><mml:mfrac><mml:mrow><mml:mtext>N false positives</mml:mtext></mml:mrow><mml:mrow><mml:mtext>N null genes</mml:mtext></mml:mrow></mml:mfrac></mml:math><inline-graphic xlink:href="12859_2020_3715_Article_IEq14.gif"/></alternatives></inline-formula></td><td align="left">0.0001, 0.01, 0.05, 0.1</td><td align="left">Unadjusted</td></tr><tr><td align="left">(False Positive Rate)</td><td align="left"/><td align="left">for unadjusted <italic>p</italic>-values</td><td align="left"/></tr><tr><td align="left">False Discovery Rate</td><td align="left"><inline-formula id="IEq15"><alternatives><tex-math id="M39">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\frac {\text {N false positives}} {\text {N significant genes}}$\end{document}</tex-math><mml:math id="M40"><mml:mfrac><mml:mrow><mml:mtext>N false positives</mml:mtext></mml:mrow><mml:mrow><mml:mtext>N significant genes</mml:mtext></mml:mrow></mml:mfrac></mml:math><inline-graphic xlink:href="12859_2020_3715_Article_IEq15.gif"/></alternatives></inline-formula></td><td align="left">0.01, 0.05, 0.1</td><td align="left">FDR Adjusted</td></tr><tr><td align="left">Power (Recall)</td><td align="left"><inline-formula id="IEq16"><alternatives><tex-math id="M41">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\frac {\text {N true positives}} {\text {N Differntially Expressed Genes}}$\end{document}</tex-math><mml:math id="M42"><mml:mfrac><mml:mrow><mml:mtext>N true positives</mml:mtext></mml:mrow><mml:mrow><mml:mtext>N Differntially Expressed Genes</mml:mtext></mml:mrow></mml:mfrac></mml:math><inline-graphic xlink:href="12859_2020_3715_Article_IEq16.gif"/></alternatives></inline-formula></td><td align="left">0.01, 0.05, 0.1</td><td align="left">FDR Adjusted</td></tr></tbody></table></table-wrap></p>
      </sec>
    </sec>
    <sec id="Sec11">
      <title>Real data analysis</title>
      <p>We apply the analysis strategies described above to a publicly available longitudinal RNA-Seq dataset of 112 whole blood samples from 40 subjects in recent contact with patients with active TB infection (GEO Datasets: GSE107994, GSE107993). The cohort was recruited between September 2015 and September 2016 at the Glenfield Hospital, University Hospitals of Leicester NHS Trust, Leicester, UK. The study design and methods have been described in detail elsewhere [<xref ref-type="bibr" rid="CR1">1</xref>]. Subjects were followed for a median of 86 days and had a median of 3 observations per subject.</p>
      <p>Over the course of the study, 9 subjects developed active TB infection and were classified as TB progressors (TBP). Of the remaining 31 subjects, 16 tested positive on the M. tuberculosis antigen-specific interferon-gamma (IFN- <italic>γ</italic>) release assay (IGRA) and were classified as having latent TB infection (LTBI). The remaining 15 subjects tested negative on the IGRA and were classified as controls. Previous analyses of the data evaluated a risk score based on a panel of 20 genes designed to distinguish LTBI from TBP and found that among subjects that remained healthy over the course of the study, risk scores were stable over time, while for most subjects that developed active TB, risk scores increased over time. In addition, it was noted that at baseline (first study observation after recruitment) the risk score was, on average, slightly elevated in the LTBI and TBP groups compared to the control group [<xref ref-type="bibr" rid="CR1">1</xref>].</p>
      <sec id="Sec12">
        <title>Data pre-processing and implementation</title>
        <p>Count tables and metadata were downloaded from the GEO DataSets website. The data included 17,793 genes with at least 1 non-zero count. Before analysis, we filtered out lowly expressed genes using the same general strategy as for the simulated data. Here, this meant all genes that did not have greater than 1 CPM in at least 9 of the 112 samples (9 was the sample size in the smallest experimental group of interest) were dropped, which reduced the total number of genes analyzed to 15,993.</p>
        <p>The goal of our analysis is to compare longitudinal changes in gene expression between subjects that develop active TB infection and others. As the number and timing of observations differed greatly between subjects, we chose to include time as a continuous predictor in our models. Since there were relatively few observations per subject, with 80% of all subjects having 3 or fewer observations and with 20% of controls, 56% of progressors and 44% of LTBI having 2 or fewer observations, we decided to model time using a linear effect. For studies with larger numbers of repeated measures, regression splines or polynomials could be used to model potentially non-linear changes over time. We included group by time interactions in the model to allow the 3 groups to have different changes in expression over time, in addition to different expression at baseline. We used the following basic regression model:
<disp-formula id="Equ5"><label>5</label><alternatives><tex-math id="M43">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$\begin{array}{@{}rcl@{}}  \log\left(\mu_{gij}\right) &amp;=&amp; \beta_{g0} + \beta_{g1} I_{L_{i}} + \beta_{g2} I_{P_{i}} + \\ &amp;&amp; \beta_{g3}t_{ij} + \beta_{g4}t_{ij} I_{L_{i}} + \beta_{g5}t_{ij} I_{P_{i}} + b_{gi} +\rho_{ij}  \end{array} $$ \end{document}</tex-math><mml:math id="M44"><mml:mtable class="eqnarray" columnalign="left center right"><mml:mtr><mml:mtd class="eqnarray-1"><mml:mo>log</mml:mo><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">gij</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:mtd><mml:mtd class="eqnarray-2"><mml:mo>=</mml:mo></mml:mtd><mml:mtd class="eqnarray-3"><mml:msub><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:mi>g</mml:mi><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:mi>g</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>I</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:mi>g</mml:mi><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>I</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo>+</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd class="eqnarray-1"/><mml:mtd class="eqnarray-2"/><mml:mtd class="eqnarray-3"><mml:msub><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:mi>g</mml:mi><mml:mn>3</mml:mn></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ij</mml:mtext></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:mi>g</mml:mi><mml:mn>4</mml:mn></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ij</mml:mtext></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>I</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:mi>g</mml:mi><mml:mn>5</mml:mn></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ij</mml:mtext></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>I</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>b</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">gi</mml:mtext></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>ρ</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ij</mml:mtext></mml:mrow></mml:msub></mml:mtd><mml:mtd><mml:mtext/></mml:mtd></mml:mtr></mml:mtable></mml:math><graphic xlink:href="12859_2020_3715_Article_Equ5.gif" position="anchor"/></alternatives></disp-formula></p>
        <p>where <italic>t</italic><sub><italic>ij</italic></sub> is the number of days since baseline for subject <italic>i</italic> at observation <italic>j</italic>, <inline-formula id="IEq17"><alternatives><tex-math id="M45">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$I_{L_{i}}$\end{document}</tex-math><mml:math id="M46"><mml:msub><mml:mrow><mml:mi>I</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12859_2020_3715_Article_IEq17.gif"/></alternatives></inline-formula> is an indicator function that equals 1 if subject <italic>i</italic> is in the LTBI group, <inline-formula id="IEq18"><alternatives><tex-math id="M47">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$I_{P_{i}}$\end{document}</tex-math><mml:math id="M48"><mml:msub><mml:mrow><mml:mi>I</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12859_2020_3715_Article_IEq18.gif"/></alternatives></inline-formula> is a similar indicator for if subject <italic>i</italic> is in the TBP group, <italic>b</italic><sub><italic>gi</italic></sub> is the random intercept for gene <italic>g</italic> and subject <italic>i</italic>, and <italic>ρ</italic><sub><italic>ij</italic></sub> is an offset. In this model, <inline-formula id="IEq19"><alternatives><tex-math id="M49">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$e^{\beta _{g0}}\phantom {\dot {i}\!}$\end{document}</tex-math><mml:math id="M50"><mml:msup><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:mi>g</mml:mi><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:msup></mml:math><inline-graphic xlink:href="12859_2020_3715_Article_IEq19.gif"/></alternatives></inline-formula> represents the mean expression of gene <italic>g</italic> in the control group at baseline, <italic>β</italic><sub><italic>g</italic>1</sub> is the log(fold change) comparing the LTBI group to the control group at baseline, and <italic>β</italic><sub><italic>g</italic>2</sub> is the log(fold change) comparing the TBP group to the control group at baseline. <italic>β</italic><sub><italic>g</italic>3</sub> is the change in log expression per day for the control group, <italic>β</italic><sub><italic>g</italic>4</sub> is the difference in the change in log(expression) per day between the LTBI and controls groups, and <italic>β</italic><sub><italic>g</italic>5</sub> is the difference in the change in log(expression) per day between the TBP and controls groups. Additional contrasts of interest include <italic>β</italic><sub><italic>g</italic>3</sub>+<italic>β</italic><sub><italic>g</italic>4</sub> (change per day in the LTBI group), <italic>β</italic><sub><italic>g</italic>3</sub>+<italic>β</italic><sub><italic>g</italic>5</sub> (change per day in the TBP group), <italic>β</italic><sub><italic>g</italic>2</sub>−<italic>β</italic><sub><italic>g</italic>1</sub> (difference between TBP and LTBI groups at baseline), and <italic>β</italic><sub><italic>g</italic>5</sub>−<italic>β</italic><sub><italic>g</italic>4</sub> (the difference in change per day between TBP and LTBI groups). All models were fit as described in the “<xref rid="Sec8" ref-type="sec">Simulation study</xref>” section. The Benjamini Hochberg method was used to adjust <italic>p</italic>-values for all methods except ShrinkBayes, which reports a Bayesian FDR [<xref ref-type="bibr" rid="CR32">32</xref>]. Numbers of models that failed to converge and number of significant genes for regression coefficients and contrasts of interest were compared between the analysis strategies.</p>
      </sec>
      <sec id="Sec13">
        <title>Functional enrichment analyses</title>
        <p>To better understand the genes that significantly changed over time in the TBP group, we performed functional enrichment analysis on the differentially expressed genes (DEGs) identified with the MCMSeq method using Panther 14.0 with the GO Biologic Process Complete annotation database. We used a 0.05 FDR level to identify GO terms that were significantly enriched. We further filtered results to include only GO terms with at least 50 genes, ≥ 10% overlap of the GO terms with the DEG list, and a raw <italic>p</italic>-value of less than 0.001.</p>
        <p>In addition, cross-sectional microarray [<xref ref-type="bibr" rid="CR47">47</xref><italic>,</italic><xref ref-type="bibr" rid="CR48">48</xref>] and RNA-Seq studies of whole blood gene expression [<xref ref-type="bibr" rid="CR49">49</xref>], have identified sets of genes with differential expression between LTBI and active TB groups. To understand if these genes also show changes over time in subjects that develop active TB, we performed an enrichment analysis. Fisher’s exact test was used to determine if the cross-sectional gene sets were over-represented in the MCMSeq DEG list for changes in expression over time in the TBP group. To calculate the expected number of overlapping genes, we multiplied the number of DEG’s by the size of the gene set and divided by the total number of genes analyzed (15,993).</p>
      </sec>
    </sec>
  </sec>
  <sec id="Sec14" sec-type="results">
    <title>Results</title>
    <sec id="Sec15">
      <title>Simulation results</title>
      <sec id="Sec16">
        <title>Convergence</title>
        <p>Across all sample sizes, NBGLMM and LMM methods had substantial proportions of models that failed to converge (Table <xref rid="Tab4" ref-type="table">4</xref>), ranging from ≈4<italic>%</italic> to ≈20<italic>%</italic> of all genes tested at a given sample size. DESeq2 ignoring correlation had minor convergence issues at smaller sample sizes. MCMSeq had minor issues at the largest sample size, but the number of genes affected was &lt;1<italic>%</italic>. Features that failed to converge in both MCMSeq and DESeq2 ignoring correlation shared similar characteristics: small counts, large dispersion, large random intercept variance, repeated zero values, and fewer unique count values. The NBGLMM had the opposite pattern, with the genes that failed to converge tending to have larger counts, smaller dispersion, and smaller random intercept variance. For the LMM, there were no obvious distinguishing features of the genes that failed to converge (<xref rid="MOESM1" ref-type="media">Supplementary</xref> Table 3).
<table-wrap id="Tab4"><label>Table 4</label><caption><p>Number of models that failed to converge out of the 150,000 simulated genes in the null + mixed effect size simulation</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left">Method</th><th align="left">N = 3</th><th align="left">N = 5</th><th align="left">N = 10</th></tr></thead><tbody><tr><td align="left">MCMSeq</td><td align="left">184</td><td align="left">335</td><td align="left">1,526</td></tr><tr><td align="left">DESeq2*</td><td align="left">0</td><td align="left">0</td><td align="left">0</td></tr><tr><td align="left">DESeq2</td><td align="left">1,295</td><td align="left">979</td><td align="left">0</td></tr><tr><td align="left">edgeR*</td><td align="left">0</td><td align="left">0</td><td align="left">0</td></tr><tr><td align="left">edgeR</td><td align="left">0</td><td align="left">0</td><td align="left">0</td></tr><tr><td align="left">limma</td><td align="left">0</td><td align="left">0</td><td align="left">0</td></tr><tr><td align="left">LMM</td><td align="left">32,060</td><td align="left">23,300</td><td align="left">14,150</td></tr><tr><td align="left">MACAU</td><td align="left">39</td><td align="left">5</td><td align="left">2</td></tr><tr><td align="left">NBGLMM</td><td align="left">6,113</td><td align="left">9,992</td><td align="left">11,995</td></tr><tr><td align="left">ShrinkBayes</td><td align="left">0</td><td align="left">0</td><td align="left">0</td></tr></tbody></table></table-wrap></p>
      </sec>
      <sec id="Sec17">
        <title>Type 1 error rates</title>
        <p>In Fig. <xref rid="Fig2" ref-type="fig">2</xref>, we compare type 1 error rates between analysis strategies using just the null genes (also see <xref rid="MOESM1" ref-type="media">Supplementary</xref> Fig. 6 and <xref rid="MOESM1" ref-type="media">Supplementary</xref> Table 4). ShrinkBayes was not evaluated in terms of type 1 error, since it only reports Bayesian FDR’s. Estimated error inflation is based on averages across the 10 simulated data sets, with each data set tending to produce consistent results (see <xref rid="MOESM1" ref-type="media">Supplementary</xref> Fig. 5). For “between-subject effects,” such as differences between groups at a single time point, MCMSeq and the LMM on transformed counts have observed rates at or slightly below the nominal levels. Conversely, the NBGLMM and DESeq2 (ignoring correlation) have inflated type 1 error rates. For these methods, type 1 error rate inflation worsens with smaller significance thresholds, though this behavior is attenuated with increasing sample size. edgeR ignoring correlation maintains 0.05 and 0.1 significance levels, but has inflated type 1 error rates for 0.001 and 0.01 levels. MACAU had significant inflation at <italic>n</italic>=3 and <italic>n</italic>=5, but was overly conservative at <italic>n</italic>=10. At <italic>n</italic>=3, limma performed reasonably well, but as the sample size increased, the type 1 error inflation worsened to the point of being one of the most inflated methods at <italic>n</italic>=10.
<fig id="Fig2"><label>Fig. 2</label><caption><p>Relative type 1 error rates (false positive rates) for the 3 tests of interest. Relative rates are plotted on the log2 scale, for the 4 different testing thresholds at each of the 3 sample sizes examined. Values greater than 0 indicate type 1 error rates higher than nominal levels (e.g. a value of 1 means the observed rate was double what one would expect), while values less than 0 indicate conservative behavior (e.g. -1 means observed rate was half of what is expected). Values in the figure are based on the average rate calculated across the 10 data sets simulated at each sample size. <xref rid="MOESM1" ref-type="media">Supplementary</xref> Fig. 5 shows the variability in observed rates for each of the methods. Results are consistent across the data sets, indicating the mean of the results is an accurate reflection of each method’s performance</p></caption><graphic xlink:href="12859_2020_3715_Fig2_HTML" id="MO2"/></fig></p>
        <p>For “within-subject effects,” such as changes over time within a single group, NBGLMM and DESeq2 including subject as a fixed effect have severely inflated type 1 error rates. Conversely, edgeR and DESeq2 ignoring correlation are overly conservative, with observed rates below the nominal level. edgeR including subjects as fixed effects shows a mix of conservative and anti-conservative behavior. Again, MACAU has inflated rates at smaller sample sizes but is overly conservative at <italic>n</italic>=10. The pattern for limma is similar to the between-subject test, with observed rates slightly inflated at <italic>n</italic>=3, but worsening behavior with increasing sample size. MCMSeq and LMM were consistently closest to nominal levels out of all the methods. Again, increasing sample size typically improved performance across all methods (limma being the noticeable exception), and brings the type 1 error rates very close to nominal levels for the MCMSeq and LMM methods. Overall, similar results were seen for the interaction term.</p>
        <p>The results for CPGLMM and VarSeq are presented only in the supplementary materials as the results for the CPGLMM were virtually identical to the NBGLMM, and VarSeq either found no significant features or had highly inflated error rates.</p>
      </sec>
      <sec id="Sec18">
        <title>False discovery rates</title>
        <p>Figure <xref rid="Fig3" ref-type="fig">3</xref> compares the relative FDR (again averaged across the 10 simulated data sets) between the methods. In general, the patterns of behavior for FDRs mimic what was observed for type 1 error rates; if a method has inflated type 1 error rates, it also has inflated FDRs. Also similar to the type 1 error results, most methods tend to be closer to the nominal rates with increasing sample size (also see <xref rid="MOESM1" ref-type="media">Supplementary</xref> Figs. 7-8 and <xref rid="MOESM1" ref-type="media">Supplementary</xref> Table 5).
<fig id="Fig3"><label>Fig. 3</label><caption><p>Relative FDRs for the 3 tests of interest. Relative rates are plotted on the log2 scale, for the 3 different testing thresholds at each of the 3 sample sizes examined. Values greater than 0 indicate FDRs higher than nominal levels (e.g. a value of 1 means the observed rate was double what one would expect), while values less than 0 indicate conservative behavior (e.g. -1 means observed rate was half of what is expected). Values in the figure are based on the average rate calculated across the 10 data sets simulated at each sample size. Triangular plotting symbols indicate that no differentially expressed genes were identified at the given threshold</p></caption><graphic xlink:href="12859_2020_3715_Fig3_HTML" id="MO3"/></fig></p>
        <p>When testing within-subject and interaction effects, DESeq2 and edgeR ignoring correlation are conservative, especially at the larger sample sizes. However, when including subjects as fixed effects, DESeq2 has severely inflated FDRs, while edgeR displays inflation at <italic>n</italic>=3 per group, but conservative behavior at <italic>n</italic>=10 per group. At all sample sizes and testing thresholds, the observed FDRs for the NBGLMM were inflated. ShrinkBayes is conservative at small sample sizes, but has FDR inflation at 10 subjects per group, showing worse performance with increasing sample size. MACAU has similar behavior to its type 1 error profile, with FDR inflation at <italic>n</italic>=3 and very conservative behavior at the largest sample size. Again, limma performs best at <italic>n</italic>=3 and has worsening FDR inflation with increasing sample size. The LMM and MCMSeq again came closest to the nominal levels with both tending to be slightly conservative at the lower sample sizes.</p>
      </sec>
      <sec id="Sec19">
        <title>Power</title>
        <p>Power (recall) for the various methods can be seen in Fig. <xref rid="Fig4" ref-type="fig">4</xref> (see also <xref rid="MOESM1" ref-type="media">Supplementary</xref> Figs. 9-10 and <xref rid="MOESM1" ref-type="media">Supplementary</xref> Table 6). For between-subject tests with 3 subjects per group, MCMSeq has the lowest power to detect DEGs, which is expected given its conservative performance in terms of FDR and type 1 error rate for between subject effects. However, as sample size increases, MCMSeq’s performance substantially improves, having higher power than the LMM, ShrinkBayes and NBGLMM methods at 10 subjects per group, despite the fact that ShrinkBayes and the NBGLMM have inflated type 1 error and FDRs. At 10 subjects per group, the methods with higher power than MCMseq fail to control type 1 error rates and FDRs at their nominal levels.
<fig id="Fig4"><label>Fig. 4</label><caption><p>Statistical power (recall) for the 3 tests of interest. Values in the figure are based on the average power calculated across the 10 data sets simulated at each sample size</p></caption><graphic xlink:href="12859_2020_3715_Fig4_HTML" id="MO4"/></fig></p>
        <p>For within-subject tests, ShrinkBayes has the lowest power, followed by edgeR ignoring correlation and the LMM. The conservative behavior of edgeR may be driven by failing to account for the paired structure of the data, while the poor performance of the LMM may be driven by the large number of models that failed to converge. For the interaction test, at 3 and 5 subjects per group, ShrinkBayes has the lowest power, but at N=10 per group has the highest power (though FDR was also very inflated). The power for MACAU remains relatively constant across the various sample sizes, increasing only marginally from <italic>n</italic>=3 to <italic>n</italic>=10. For limma, power is typically about average for all of the methods, in spite of having significant type 1 error and FDR inflation at <italic>N</italic>=5 and <italic>N</italic>=10. For both the within subject and interaction tests, the relative performance of the MCMSeq method improves with increasing sample size. Again, at 10 subjects per group, the only methods with higher power than MCMseq fail to control type 1 error rates and/or FDRs at their nominal levels.</p>
        <p>Figure <xref rid="Fig5" ref-type="fig">5</xref> shows the relationship between FDR and power for the various methods in the <italic>n</italic>=5 simulated datasets at the commonly used 0.05 FDR level (See <xref rid="MOESM1" ref-type="media">Supplementary</xref> Fig. 11 for <italic>N</italic>=3 and <italic>N</italic>=10). Here we see that for each type of test, MCMSeq has the highest power of the methods that maintain the nominal FDR level. Again, the only methods that have higher power also have substantially inflated FDRs.
<fig id="Fig5"><label>Fig. 5</label><caption><p>Scatter plot of power versus observed FDR for the 3 contrasts of interest in the <italic>n</italic>=5 simulated datasets. Significance was determined at the 0.05 FDR level. Points that lie to the left of the dashed vertical line represent methods that have an observed FDR less than the nominal rate of 5%, while points to the right represent methods with FDR inflation</p></caption><graphic xlink:href="12859_2020_3715_Fig5_HTML" id="MO5"/></fig></p>
      </sec>
    </sec>
    <sec id="Sec20">
      <title>Real data results</title>
      <sec id="Sec21">
        <title>Model convergence and stability</title>
        <p>The NBGLMM had the largest number of models that failed to converge (≈8.4%), followed by the LMM (≈2.5%). Convergence rates were higher in the TB dataset compared to our simulation studies. This difference is likely due to the larger number of observations (112) and subjects (N=40, median of 3 observations per subject) compared to our simulations, which included a maximum of 40 observations. To explore this, we subsampled 2 observations from 5 subjects in both the Control and Latent groups in the TB dataset to create a scenario similar to our 5 subject per group simulations. We found that convergence rates were similar to our simulation study, with 18.1% of LMMs, 17.6% of NBGLMMs, 0.4% of DESeq models, and &lt;1<italic>%</italic> of MCMSeq models failing to converge. For MCMSeq, we also ran the sampler four separate times to evaluate the consistency of the results, as this method is based on a stochastic estimation process. In general, we found the results were highly consistent between the multiple runs, as the Spearman correlation of <italic>p</italic>-values was at least 0.9996 between any combination of runs, and typically over 99% of differential expression calls for the contrasts we tested were congruent. More details can be found in <xref rid="MOESM1" ref-type="media">Supplementary</xref> Tables 10 and 11.</p>
      </sec>
      <sec id="Sec22">
        <title>Number of significant genes</title>
        <p>For brevity, we focus our discussion on the edgeR, edgeR*, limma, LMM, MCMSeq, NBGLMM and ShrinkBayes methods; however, full results for all methods can be found in the <xref rid="MOESM1" ref-type="media">Supplementary materials</xref> (Supp. Table 9). CPGLMM results were similar to the NBGLMM. VarSeq and MACAU did not find any differentially expressed genes for any of the contrasts testing for changes over time or differences in changes over time between the groups. The numbers of significant genes at the 0.05 FDR level identified using each analysis method are presented in Table <xref rid="Tab5" ref-type="table">5</xref>. For between-subject contrasts, such as differences between groups at baseline, edgeR and ShrinkBayes found the highest number of significant genes, followed by the NBGLMM and limma. This is not surprising as these methods had inflated FDR for between subject effects in our simulations, even at the largest sample size. LMM and MCMSeq found over 50% fewer DEGs between the TBP and LTBI and TBP and control groups compared to these methods. Previous analyses of a 20 gene TB risk score showed no or small differences between TBP and LTBI and TBP and control groups at baseline [<xref ref-type="bibr" rid="CR1">1</xref>].
<table-wrap id="Tab5"><label>Table 5</label><caption><p>Number of significant genes by contrast in the tuberculosis dataset. 15,993 genes were included in the analysis. Genes were called significant if the FDR adjusted <italic>p</italic>-value was &lt;0.05</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left"/><th align="left">edgeR</th><th align="left">edgeR <sup>∗</sup></th><th align="left">limma</th><th align="left">LMM</th><th align="left">MCMSeq</th><th align="left">NBGLMM</th><th align="left">ShrinkBayes<sup>1</sup></th></tr></thead><tbody><tr><td align="left">Number Failed to Converge</td><td align="left">0</td><td align="left">0</td><td align="left">0</td><td align="left">392</td><td align="left">132</td><td align="left">1348</td><td align="left">0</td></tr><tr><td align="left" colspan="8"><bold>Baseline Differences</bold></td></tr><tr><td align="left">Latent vs. Control</td><td align="left">279</td><td align="left">-</td><td align="left">11</td><td align="left">2</td><td align="left">3</td><td align="left">9</td><td align="left">416, 407</td></tr><tr><td align="left">Progressor vs. Control</td><td align="left">2221</td><td align="left">-</td><td align="left">1009</td><td align="left">752</td><td align="left">650</td><td align="left">1130</td><td align="left">1821, 1013</td></tr><tr><td align="left">Progressor vs. Latent</td><td align="left">1643</td><td align="left">-</td><td align="left">552</td><td align="left">299</td><td align="left">256</td><td align="left">667</td><td align="left">1369, 708</td></tr><tr><td align="left" colspan="8"><bold>Changes Over Time</bold></td></tr><tr><td align="left">Control</td><td align="left">1</td><td align="left">0</td><td align="left">0</td><td align="left">0</td><td align="left">0</td><td align="left">0</td><td align="left">2977</td></tr><tr><td align="left">Latent</td><td align="left">2</td><td align="left">0</td><td align="left">0</td><td align="left">0</td><td align="left">3</td><td align="left">2</td><td align="left">3171</td></tr><tr><td align="left">Progressor</td><td align="left">664</td><td align="left">790</td><td align="left">2460</td><td align="left">1413</td><td align="left">1463</td><td align="left">1878</td><td align="left">7848</td></tr><tr><td align="left" colspan="8"><bold>Differences in Changes</bold></td></tr><tr><td align="left" colspan="8"><bold>Over Time</bold></td></tr><tr><td align="left">Latent vs. Control</td><td align="left">0</td><td align="left">0</td><td align="left">0</td><td align="left">0</td><td align="left">3</td><td align="left">0</td><td align="left">3331, 3230</td></tr><tr><td align="left">Progressor vs. Control</td><td align="left">16</td><td align="left">272</td><td align="left">310</td><td align="left">537</td><td align="left">635</td><td align="left">794</td><td align="left">7199, 6429</td></tr><tr><td align="left">Progressor vs. Latent</td><td align="left">170</td><td align="left">278</td><td align="left">1852</td><td align="left">825</td><td align="left">852</td><td align="left">1328</td><td align="left">6681, 7390</td></tr></tbody></table><table-wrap-foot><p><sup>1</sup>In order to test all contrasts of interest, ShrinkBayes models were fit three times, using a different reference group each time. This resulted in some contrasts being evaluated twice. As ShrinkBayes is a stochastic method, the number of significant genes can differ between model fits. We present the results from both models when tests were performed multiple times</p></table-wrap-foot></table-wrap></p>
        <p>For within-subject tests of changes in gene expression over time, changes in gene expression were expected in the TBP group, which developed active TB over the course of the study. Expression was expected to be relatively stable in the control and LTBI groups. As expected, most methods identified few or no genes that significantly changed over time in both the control and LTBI groups. However, ShrinkBayes found nearly 3,000 genes with significant changes over time in these groups. For the TBP group, ShrinkBayes found the largest number of significant genes, with over 5,000 more DEGs than NBGLMM and limma, which had the next highest numbers. In our simulation studies, the NBGLMM and limma had inflated FDRs, even at 10 subjects per group. The large number of additional significant genes found with ShrinkBayes may reflect the pattern of increased FDR with increasing sample sizes noted in the simulation study. For the TBP group, edgeR identified fewer genes than the MCMSeq and LMM methods. edgeR ignoring correlation identified fewer genes than when subjects were included as fixed effects, which also aligns with our simulation results showing that failing to account for correlation caused DESeq2 and edgeR to produce conservative results for tests of within-subject effects. The results for the interaction effects (differences in change over time between groups) largely follow the same patterns as the within subject tests for change in gene expression over time.</p>
        <p>We also calculated pairwise Jaccard indices and Kappa agreement statistics to compare the similarity of differential expression calls between methods (<xref rid="MOESM1" ref-type="media">Supplementary materials</xref> Section 3.2). MCMSeq had the highest agreement with LMM, followed by CPGLMM and NBGLMM. MCMSeq had the lowest agreement with VarSeq and MACAU, which did not find any genes with significant changes in expression over time or with differential changes over time between groups.</p>
      </sec>
      <sec id="Sec23">
        <title>Enrichment analysis</title>
        <p>Results from MCMSeq for the top GO terms are presented in Table <xref rid="Tab6" ref-type="table">6</xref> and full results can be found in the <xref rid="MOESM1" ref-type="media">Supplementary materials</xref> as a.csv file. We found 575 significantly enriched GO terms at the 0.05 FDR level. After filtering, 308 GO terms were identified as significantly enriched. The results were enriched for genes relating to immune response, pathways associated with myeloid cell function or activation, T and B cell activation and more general inflammation processes, and both Type I interferon and interferon gamma signaling. Similar results have been reported in cross sectional studies of TB infection [<xref ref-type="bibr" rid="CR1">1</xref><italic>,</italic><xref ref-type="bibr" rid="CR50">50</xref><italic>,</italic><xref ref-type="bibr" rid="CR51">51</xref>]. In addition, the MCMSeq results for longitudinal changes in expression in the TBP group were enriched for genes associated with active TB infection in cross-sectional studies, indicating that expression of many of these genes is also changing within subjects as they progress from latent to active TB.
<table-wrap id="Tab6"><label>Table 6</label><caption><p>Functional enrichment analysis</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left"/><th align="left">Description</th><th align="left">N Genes</th><th align="left">N Genes</th><th align="left">N</th><th align="left">Fold</th></tr><tr><th align="left"/><th align="left"/><th align="left">in Set</th><th align="left">in DEG List</th><th align="left">Expected</th><th align="left">Enrichment</th></tr></thead><tbody><tr><td align="left" colspan="6"><bold>GO Terms</bold></td></tr><tr><td align="left">0019221</td><td align="left">cytokine-mediated</td><td align="left">659</td><td align="left">110</td><td align="left">42.28</td><td align="left">2.6</td></tr><tr><td align="left"/><td align="left" colspan="5">signaling pathway</td></tr><tr><td align="left">0043312</td><td align="left">neutrophil degranulation</td><td align="left">483</td><td align="left">88</td><td align="left">30.99</td><td align="left">2.84</td></tr><tr><td align="left">0045088</td><td align="left">regulation of innate</td><td align="left">434</td><td align="left">75</td><td align="left">27.84</td><td align="left">2.69</td></tr><tr><td align="left"/><td align="left" colspan="5">immune response</td></tr><tr><td align="left">0001817</td><td align="left">regulation of cytokine</td><td align="left">676</td><td align="left">98</td><td align="left">43.37</td><td align="left">2.26</td></tr><tr><td align="left"/><td align="left" colspan="5">production</td></tr><tr><td align="left">0002684</td><td align="left">positive regulation of</td><td align="left">1125</td><td align="left">137</td><td align="left">72.17</td><td align="left">1.9</td></tr><tr><td align="left"/><td align="left" colspan="5">immune system process</td></tr><tr><td align="left">0010608</td><td align="left">post-transcriptional</td><td align="left">512</td><td align="left">77</td><td align="left">32.85</td><td align="left">2.34</td></tr><tr><td align="left"/><td align="left" colspan="5">regulation of gene</td></tr><tr><td align="left"/><td align="left" colspan="5">expression</td></tr><tr><td align="left">0016032</td><td align="left">viral process</td><td align="left">690</td><td align="left">93</td><td align="left">44.27</td><td align="left">2.1</td></tr><tr><td align="left">1903706</td><td align="left">regulation of hemopoiesis</td><td align="left">442</td><td align="left">69</td><td align="left">28.36</td><td align="left">2.43</td></tr><tr><td align="left">0051248</td><td align="left">negative regulation of</td><td align="left">1087</td><td align="left">128</td><td align="left">69.74</td><td align="left">1.84</td></tr><tr><td align="left"/><td align="left" colspan="5">protein metabolic process</td></tr><tr><td align="left">0033554</td><td align="left">cellular response to stress</td><td align="left">1662</td><td align="left">175</td><td align="left">106.63</td><td align="left">1.64</td></tr><tr><td align="left">0046649</td><td align="left">lymphocyte activation</td><td align="left">369</td><td align="left">60</td><td align="left">23.67</td><td align="left">2.53</td></tr><tr><td align="left">0002683</td><td align="left">negative regulation of</td><td align="left">434</td><td align="left">66</td><td align="left">27.84</td><td align="left">2.37</td></tr><tr><td align="left"/><td align="left" colspan="5">immune system process</td></tr><tr><td align="left">0034660</td><td align="left">ncRNA metabolic process</td><td align="left">542</td><td align="left">76</td><td align="left">34.77</td><td align="left">2.19</td></tr><tr><td align="left">0034341</td><td align="left">response to interferon-</td><td align="left">182</td><td align="left">38</td><td align="left">11.68</td><td align="left">3.25</td></tr><tr><td align="left"/><td align="left" colspan="5">gamma</td></tr><tr><td align="left" colspan="6"><bold>Previously Published Gene Sets</bold></td></tr><tr><td align="left">Blankley</td><td align="left"/><td align="left">327</td><td align="left">123</td><td align="left">30.4</td><td align="left">4.1</td></tr><tr><td align="left">Kafouru</td><td align="left"/><td align="left">18</td><td align="left">13</td><td align="left">1.7</td><td align="left">7.8</td></tr><tr><td align="left">Zak</td><td align="left"/><td align="left">14</td><td align="left">9</td><td align="left">1.3</td><td align="left">6.9</td></tr></tbody></table><table-wrap-foot><p>Top GO terms were selected as follows: the top 50 GO terms were selected by <italic>p</italic>-value</p><p>The list was then reduced to include only the most specific subclass in an ontology</p><p>All results included had BH adjusted <italic>p</italic>-values &lt;0.0001</p></table-wrap-foot></table-wrap></p>
      </sec>
    </sec>
  </sec>
  <sec id="Sec24" sec-type="discussion">
    <title>Discussion</title>
    <p>Longitudinal RNA-Seq experiments have the potential to be a powerful tool for understanding how transcriptional changes that occur over time are related to disease progression, changes in treatment, or changes in environmental exposures. However, currently available RNA-Seq specific analysis tools are not equipped to handle the modeling requirements necessary for these types of data. Of the methods we tested, the LMM and MCMSeq performed best in terms of maintaining type 1 error rates and FDRs at or near their nominal levels for tests of between-subject, within-subject, and interaction effects. In general, MCMSeq tended to be slightly more conservative than the LMM. At higher sample sizes both methods neared nominal rates. Even though the LMM and MCMSeq methods had similar type 1 error rates at 10 samples per group, MCMSeq had much higher power. One concern using the LMM is the large number of models that failed to converge in our simulation study, even after filtering out lowly expressed genes.</p>
    <p>Of the methods tested that explicitly model RNA-Seq counts, only MCMSeq was able to combine both good statistical power with control of error rates at the nominal levels. In contrast, using both edgeR or DESeq2, which are not designed to handle repeated measures, lead to sub-optimal performance in terms of low power (ignoring correlation in within-subject and interaction tests) or inflated type 1 error rates and FDRs (including subjects as fixed effects). While limma performed relatively well at small sample sizes, false discovery and type 1 error rates became increasingly inflated as sample size increased, having one of the highest levels of error inflation in our <italic>N</italic>=10 simulations. VarSeq, a model-free method based on a variance component score test that can accommodate repeated measures, was validated for testing gene sets rather than individual genes. In our simulations, it alternated between having low power to detect differential expression and having very inflated error rates, depending on the combination of contrast tested and sample size. MACAU had inflated false discovery and type 1 error rates at <italic>N</italic>=3, but become overly conservative at larger sample sizes.</p>
    <p>Both the NBGLMM and CPGLMM consistently had highly inflated type 1 error rates and FDRs when fit under a frequentist paradigm. This could, in part, be a result of the statistical tests for these models being designed for larger sample sizes, while many of the other RNA-Seq specific methods we examined have some modifications due to the expectation of low sample sizes. Lastly, ShrinkBayes is similar to MCMSeq in that both take a Bayesian approach to fitting hierarchical NB models. However, ShrinkBayes had mixed behavior, with a lack of power at the smallest sample size investigated that transitioned into inflated FDRs at the largest sample size. The Bayesian FDR used in ShrinkBayes was originally validated in a simulation using a 2 group comparison with N=8 per group, without correlation or repeated measures [<xref ref-type="bibr" rid="CR23">23</xref>]. While the Bayesian FDR may perform well in this scenario, it did not maintain nominal FDRs in our simulations with paired data, varying sample sizes, and differing effect sizes. Additionally, as others have noted, we encountered installation and memory issues when attempting to run ShrinkBayes on our personal computers (Windows desktop, Mac Pro desktop, MacBook Pro laptops) [<xref ref-type="bibr" rid="CR22">22</xref>]. We were able to get the method to run on a Linux HPC, but were forced to break the analysis up into smaller chunks. Implementation of the ShrinkBayes method was non-trivial given its computationally intensive nature, the large number of modeling options, and the limited documentation for the software package.</p>
    <p>MCMSeq did struggle with power at the smaller sample sizes for the between-subject test. This is not unexpected as this type of test does not require the extra complexity of the mixed model since there are no repeated measures involved in this contrast. Of the methods examined, MCMSeq was best able to adequately control type 1 error rates and FDRs while maintaining good power for the tests that involved changes over time.</p>
    <p>The results from applying the various methods to the TB data set largely mirror the behavior observed in the simulations as the methods that generally had inflated error rates tended to find the largest number of significant features (e.g. CPGLMM, NBGLMM). Methods that showed conservative behavior at larger sample sizes, such as VarSeq and MACAU, failed to find any genes that significantly changed over time. For the two methods that were best able to maintain type 1 error rates in our simulation study (MCMSeq and the LMM), MCMSeq found more significant genes for tests of changes over time and differences in changes over time between groups, which aligns with the results of our simulation study, where MCMSeq had more power than the LMM.</p>
    <p>In our application, ShrinkBayes was an outlier, especially for the “changes over time” and “differences in changes over time” contrasts. For changes over time in both the control and latent groups, all of the other methods find no or very few genes showing significant changes. However, ShrinkBayes finds about 3,000 genes for both tests. The same is true for comparing the change over time in the latent group to the change over time in the control group. ShrinkBayes also finds several thousand more significant genes than all the other methods for changes over time in the TB progression group. This could be a continuation of the behavior seen in the simulation study where ShrinkBayes had significant FDR inflation at the largest sample size, which is smaller than the number of subjects in the TB dataset. However, as others have noted, ShrinkBayes produces a large number of integrated nested Laplace approximation (INLA) errors during model fitting which the ShrinkBayes documentation instructs users to ignore [<xref ref-type="bibr" rid="CR22">22</xref>]. Therefore, it is also possible that these anomalous results are due to problems in model fitting. ShrinkBayes also showed inconsistent results in that the number of significant genes for a given test depended on the parametrization. For example, testing for baseline differences between treatment and control groups in the TB data resulted in 963 significant genes for one parametrization and 1,561 for a different parametrization, a relative difference of about 50%.</p>
    <p>While fitting the NBGLMM using MCMC in MCMSeq is computationally intensive and run times are significantly longer than using either edgeR or DESeq2 (1.4 and 2.3 minutes respectively to analyze all contrasts for a single <italic>n</italic>=10 simulated data set), our implementation available in the mcmseq R package (196 min) was actually faster than fitting the frequentist NBGLMM (803 min) or the CPGLMM (492 min). It is also faster than ShrinkBayes (474 min), which uses Laplace approximations rather than MCMC, but involves computationally expensive steps needed to estimate the more complicated priors utilized in their model. Moreover, the fitting function in mcmseq allows the user to specify contrasts so as to test combinations of the regression parameters. The frequentist NBGLMM and CPGLMM both had to be fit multiple times to test all of the contrasts we were interested in for both the relatively simple design of the simulated data sets and the more complicated study design of the TB data. ShrinkBayes also suffers from this issue and had to be fit twice for the simulations and three times for the TB data, leading to much longer run times to complete the whole analysis. Additionally, due to the way genes are analyzed and summarized in parallel, MCMSeq does not require large amounts of RAM to be run. For example, the analysis of the TB dataset required only around 300 MB of RAM at its peak consumption (See <xref rid="MOESM1" ref-type="media">Supplementary</xref> Section 2.3.8 for more information).</p>
    <p>In general, our results are consistent with another recently published methodology for analyzing RNA-Seq data with repeated measures [<xref ref-type="bibr" rid="CR52">52</xref>]. Their strategy largely mirrors our use of the VST paired with fitting normal LMMs, with the major differences being the transformation used (VOOM versus the VST) and the specification of the correlation structure (auto-regressive versus compound symmetric as implied by the use of a random intercept in our implementation). They also found that methods that do not account for the correlation induced by repeated measures could not match those that do.</p>
    <p>One limitation of the current implementation of the mcmseq R package is that only a single random intercept can be included in the models. While a random intercept is a relatively simple treatment of the correlation structure, it is a quite commonly used convention in the face of repeated measures, especially when the number of repeated measures is small. While we recognize this is a limitation of our current implementation, accounting for correlation even with a simple random intercept is an improvement over models that do not account for correlation. We plan to add the capability to include a random slope in the near future and will investigate auto-correlation. Accounting for auto-correlation in our GLMM framework will be a non-trivial extension, since unlike linear mixed models for normally distributed outcomes, there is not a covariance matrix for the errors and correlation must be accounted for through specially constructed random effect priors [<xref ref-type="bibr" rid="CR53">53</xref>].</p>
    <p>Model mis-specification is an issue for all RNASeq analysis methods, as omission of important fixed or random effect covariates or incorrect distributional assumptions can impact testing characteristics. Others have investigated the impact of model mis-specification in log-linear generalized linear mixed models for count data in a frequentist context, and found that under-specification of the random effects can result in underestimated standard errors for fixed effects [<xref ref-type="bibr" rid="CR54">54</xref>]. The magnitude of the underestimation is dependent on several factors, including the sample size, random slope variance and the number of repeated measurements per subject, with the amount of underestimation increasing with increasing variance and number of repeated measurements. In studies with a small samples size and few repeated measurements, as is common in RNA-Seq, there is limited information to estimate complex random effect or covariance structures, such that using a simpler (e.g. random intercept only) random effects structure may not have a substantial influence on inference.</p>
    <p>While in the future we intend to extend the package to allow for multiple levels of clustering and additional random effects, such as a random slope, the current version should prove adequate for many studies with repeated or paired measurements. We also hope to add features allowing users to simultaneously test multiple fixed effects regression parameters (i.e. ANOVA type tests). Another limitation is the precision with which the MCMC <italic>p</italic>-value (i.e. contour probability) can be calculated. Since a Monte Carlo estimate is used to compute the tail probability, the precision is determined by the number of MCMC iterations that are run. We found that chains of length 30k were generally sufficient for type 1 error and FDR control, but if greater accuracy is needed the only solution is to run longer chains. Using normal approximations for the posteriors of regression coefficients was investigated, but this strategy was unable to maintain nominal error rates, even at <italic>n</italic>=10. We also explored using Integrated Nested Laplace Approximations (INLA) as an alternative approach to fitting the Bayesian hierarchical model utilized in MCMSeq. Using the INLA R package we found that both type 1 errors and FDR rates were inflated, similar to the inflation we noted when using normal approximations based on the MCMC output. This is not surprising as INLA is an approximate method as compared to MCMC, which is asymptotically exact. While the custom sampler implemented in the mcmseq R package was faster than INLA at the sample sizes we tested, we are interested in further exploring both INLA and variational methods in future work. Though our motivation for developing MCMSeq was to create a tool for analyzing longitudinal RNA-Seq experiments, we have also included functions in the mcmseq R package that can fit NBGLMs that do not include random effects. In a similar set of simulations that did not include random effects, we found that using MCMC to fit a NBGLM gave similar improvements for maintaining nominal FDRs and type 1 error rates, likely due to incorporating uncertainty in the dispersion parameter into the posteriors of the regression coefficients (data not shown).</p>
  </sec>
  <sec id="Sec25" sec-type="conclusion">
    <title>Conclusions</title>
    <p>Failing to account for repeated measurements when analyzing RNA-Seq experiments can result in significantly inflated false positive and false discovery rates. The most used RNA-Seq analysis software cannot inherently account for repeated measures, and though some workarounds have been proposed, our simulations show they are not particularly effective. Ultimately, the Bayesian hierarchical model underlying MCMSeq was best able model RNA-Seq expression from study designs with repeated/clustered measurements based on its ability to combine good power with maintenance of nominal false positive and false discovery rates. Additionally, MCMSeq’s NBGLMM framework is able to flexibly model mean expression with the inclusion of covariates, and it can handle arbitrarily many repeated measurements which can also vary in number between individuals. Finally, the implementation found in the mcmseq R package makes utilizing Bayesian NBGLMMs more accessible by automating and parallelizing the process of fitting and summarizing results from these models over the tens of thousands of genes typically analyzed in an RNA-Seq experiment.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary information</title>
    <sec id="Sec26">
      <p>
        <supplementary-material content-type="local-data" id="MOESM1">
          <media xlink:href="12859_2020_3715_MOESM1_ESM.pdf">
            <caption>
              <p><bold>Additional file 1</bold> Supplementary materials. Supplementary methods, results, tables, and figures.</p>
            </caption>
          </media>
        </supplementary-material>
      </p>
    </sec>
  </sec>
</body>
<back>
  <glossary>
    <title>Abbreviations</title>
    <def-list>
      <def-item>
        <term>ANOVA</term>
        <def>
          <p>Analysis of Variance</p>
        </def>
      </def-item>
      <def-item>
        <term>CPM</term>
        <def>
          <p>Counts per Million</p>
        </def>
      </def-item>
      <def-item>
        <term>CP</term>
        <def>
          <p>Compound Poisson</p>
        </def>
      </def-item>
      <def-item>
        <term>CPGLMM</term>
        <def>
          <p>Compound Poisson Generalized Linear Mixed Model</p>
        </def>
      </def-item>
      <def-item>
        <term>DEG</term>
        <def>
          <p>Differentially Expressed Gene</p>
        </def>
      </def-item>
      <def-item>
        <term>FDR</term>
        <def>
          <p>False Discovery Rate</p>
        </def>
      </def-item>
      <def-item>
        <term>GO</term>
        <def>
          <p>Gene Ontology</p>
        </def>
      </def-item>
      <def-item>
        <term>GLM</term>
        <def>
          <p>Generalized Linear Model</p>
        </def>
      </def-item>
      <def-item>
        <term>GLMM</term>
        <def>
          <p>Generalized Linear Mixed Model</p>
        </def>
      </def-item>
      <def-item>
        <term>IGRA</term>
        <def>
          <p>interferon-gamma (IFN- <italic>γ</italic>) release assay</p>
        </def>
      </def-item>
      <def-item>
        <term>INLA</term>
        <def>
          <p>Integrated Nested Laplace Approximation</p>
        </def>
      </def-item>
      <def-item>
        <term>LTBI</term>
        <def>
          <p>Latent Tuberculosis Infection</p>
        </def>
      </def-item>
      <def-item>
        <term>LMM</term>
        <def>
          <p>Linear Mixed Model</p>
        </def>
      </def-item>
      <def-item>
        <term>LOESS</term>
        <def>
          <p>Locally weighted polynomial regression</p>
        </def>
      </def-item>
      <def-item>
        <term>MCMC</term>
        <def>
          <p>Markov-chain Monte Carlo</p>
        </def>
      </def-item>
      <def-item>
        <term>NB</term>
        <def>
          <p>Negative Binomial</p>
        </def>
      </def-item>
      <def-item>
        <term>NBGLMM</term>
        <def>
          <p>Negative Binomial Generalized Linear Mixed Model</p>
        </def>
      </def-item>
      <def-item>
        <term>NBGLM</term>
        <def>
          <p>Negative Binomial Generalized Linear Model</p>
        </def>
      </def-item>
      <def-item>
        <term>RAM</term>
        <def>
          <p>Random Access Memory</p>
        </def>
      </def-item>
      <def-item>
        <term>RNA-Seq</term>
        <def>
          <p>RNA Sequencing</p>
        </def>
      </def-item>
      <def-item>
        <term>TB</term>
        <def>
          <p>Tuberculosis</p>
        </def>
      </def-item>
      <def-item>
        <term>TBP</term>
        <def>
          <p>Tuberculosis Progressor</p>
        </def>
      </def-item>
      <def-item>
        <term>WLS</term>
        <def>
          <p>Weighted Least Squares</p>
        </def>
      </def-item>
    </def-list>
  </glossary>
  <fn-group>
    <fn>
      <p>
        <bold>Publisher’s Note</bold>
      </p>
      <p>Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p>
    </fn>
    <fn>
      <p>Brian E. Vestal and Camille M. Moore contributed equally to this work.</p>
    </fn>
  </fn-group>
  <sec>
    <title>Supplementary information</title>
    <p><bold>Supplementary information</bold> accompanies this paper at 10.1186/s12859-020-03715-y.</p>
  </sec>
  <ack>
    <p>We would like to thank Dr. Edward Bedrick, PhD for his contributions to this work.</p>
  </ack>
  <notes notes-type="author-contribution">
    <title>Authors’ contributions</title>
    <p>CMM and BEV developed and tested the MCMSeq methods and R package, designed and implemented the simulation studies, and wrote the manuscript. EW assisted in performing the simulation studies and application data analysis, prepared tables and figures, and reviewed the manuscript. KK, TF and LS contributed to the development of the MCMSeq methods, the design of the simulation study, and reviewed the manuscript. All author(s) read and approved the final manuscript.</p>
  </notes>
  <notes notes-type="funding-information">
    <title>Funding</title>
    <p>CMM and EW were funded by a Webb-Waring Early Career Investigator Award from the Boettcher Foundation. BEV, LS, and KK were funded by NIH/NIAAA R01 AA021131. The content is solely the responsibility of the authors and does not necessarily represent the official views of the National Institutes of Health.</p>
  </notes>
  <notes notes-type="data-availability">
    <title>Availability of data and materials</title>
    <p>Datasets used in the simulation studies are available from the corresponding author upon request. The real RNA-Seq data was originally published in [<xref ref-type="bibr" rid="CR1">1</xref>], and was downloaded for this application from the GEO DataSets website (GEO Datasets: GSE107994, GSE107993)</p>
  </notes>
  <notes id="FPar1">
    <title>Ethics approval and consent to participate</title>
    <p>No ethics approval was required for this study. All data analyzed in this manuscript was either simulated or downloaded from publicly available sources.</p>
  </notes>
  <notes id="FPar2">
    <title>Consent for publication</title>
    <p>Not Applicable.</p>
  </notes>
  <notes id="FPar3" notes-type="COI-statement">
    <title>Competing interests</title>
    <p>Katerina Kechris was a member of the editorial board of <italic>BMC Bioinformatics</italic> from 2015-2019. All other authors declare that they have no competing interests.</p>
  </notes>
  <ref-list id="Bib1">
    <title>References</title>
    <ref id="CR1">
      <label>1</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Singhania</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Verma</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Graham</surname>
            <given-names>CM</given-names>
          </name>
          <name>
            <surname>Lee</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Tran</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Richardson</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Lecine</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Leissner</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Berry</surname>
            <given-names>MP</given-names>
          </name>
          <name>
            <surname>Wilkinson</surname>
            <given-names>RJ</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>A modular transcriptional signature identifies phenotypic heterogeneity of human tuberculosis infection</article-title>
        <source>Nat Commun</source>
        <year>2018</year>
        <volume>9</volume>
        <issue>1</issue>
        <fpage>2308</fpage>
        <?supplied-pmid 29921861?>
        <pub-id pub-id-type="pmid">29921861</pub-id>
      </element-citation>
    </ref>
    <ref id="CR2">
      <label>2</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Rosenberg</surname>
            <given-names>BR</given-names>
          </name>
          <name>
            <surname>Depla</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Freije</surname>
            <given-names>CA</given-names>
          </name>
          <name>
            <surname>Gaucher</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Mazouz</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Boisvert</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Bédard</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Bruneau</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Rice</surname>
            <given-names>CM</given-names>
          </name>
          <name>
            <surname>Shoukry</surname>
            <given-names>NH</given-names>
          </name>
        </person-group>
        <article-title>Longitudinal transcriptomic characterization of the immune response to acute hepatitis c virus infection in patients with spontaneous viral clearance</article-title>
        <source>PLoS Pathog</source>
        <year>2018</year>
        <volume>14</volume>
        <issue>9</issue>
        <fpage>1007290</fpage>
      </element-citation>
    </ref>
    <ref id="CR3">
      <label>3</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Cui</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Ji</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Cheng</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Qiu</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>What if we ignore the random effects when analyzing rna-seq data in a multifactor experiment</article-title>
        <source>SStat Appl Genet Mol Biol</source>
        <year>2016</year>
        <volume>15</volume>
        <issue>2</issue>
        <fpage>87</fpage>
        <lpage>105</lpage>
      </element-citation>
    </ref>
    <ref id="CR4">
      <label>4</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Fitzmaurice</surname>
            <given-names>GM</given-names>
          </name>
          <name>
            <surname>Laird</surname>
            <given-names>NM</given-names>
          </name>
          <name>
            <surname>Ware</surname>
            <given-names>JH</given-names>
          </name>
        </person-group>
        <source>Applied longitudinal analysis, vol. 998</source>
        <year>2012</year>
        <publisher-loc>Hoboken</publisher-loc>
        <publisher-name>John Wiley &amp; Sons</publisher-name>
      </element-citation>
    </ref>
    <ref id="CR5">
      <label>5</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>McCarthy</surname>
            <given-names>DJ</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Smyth</surname>
            <given-names>GK</given-names>
          </name>
        </person-group>
        <article-title>Differential expression analysis of multifactor rna-seq experiments with respect to biological variation</article-title>
        <source>Nucleic Acids Res</source>
        <year>2012</year>
        <volume>40</volume>
        <issue>10</issue>
        <fpage>4288</fpage>
        <lpage>97</lpage>
        <?supplied-pmid 22287627?>
        <pub-id pub-id-type="pmid">22287627</pub-id>
      </element-citation>
    </ref>
    <ref id="CR6">
      <label>6</label>
      <mixed-citation publication-type="other">Harrell FE. Regression modeling strategies: with applications to linear models, logistic and ordinal regression, and survival analysis: Springer; 2015.</mixed-citation>
    </ref>
    <ref id="CR7">
      <label>7</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Robinson</surname>
            <given-names>MD</given-names>
          </name>
          <name>
            <surname>Smyth</surname>
            <given-names>GK</given-names>
          </name>
        </person-group>
        <article-title>Moderated statistical tests for assessing differences in tag abundance</article-title>
        <source>Bioinformatics</source>
        <year>2007</year>
        <volume>23</volume>
        <issue>21</issue>
        <fpage>2881</fpage>
        <lpage>7</lpage>
        <?supplied-pmid 17881408?>
        <pub-id pub-id-type="pmid">17881408</pub-id>
      </element-citation>
    </ref>
    <ref id="CR8">
      <label>8</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Robinson</surname>
            <given-names>MD</given-names>
          </name>
          <name>
            <surname>Smyth</surname>
            <given-names>GK</given-names>
          </name>
        </person-group>
        <article-title>Small-sample estimation of negative binomial dispersion, with applications to sage data</article-title>
        <source>Biostatistics</source>
        <year>2007</year>
        <volume>9</volume>
        <issue>2</issue>
        <fpage>321</fpage>
        <lpage>32</lpage>
        <?supplied-pmid 17728317?>
        <pub-id pub-id-type="pmid">17728317</pub-id>
      </element-citation>
    </ref>
    <ref id="CR9">
      <label>9</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Piegorsch</surname>
            <given-names>WW</given-names>
          </name>
        </person-group>
        <article-title>Maximum likelihood estimation for the negative binomial dispersion parameter</article-title>
        <source>Biometrics</source>
        <year>1990</year>
        <volume>46</volume>
        <issue>3</issue>
        <fpage>863</fpage>
        <lpage>7</lpage>
        <?supplied-pmid 2242417?>
        <pub-id pub-id-type="pmid">2242417</pub-id>
      </element-citation>
    </ref>
    <ref id="CR10">
      <label>10</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Clark</surname>
            <given-names>SJ</given-names>
          </name>
          <name>
            <surname>Perry</surname>
            <given-names>JN</given-names>
          </name>
        </person-group>
        <article-title>Estimation of the negative binomial parameter <italic>κ</italic> by maximum quasi-likelihood</article-title>
        <source>Biometrics</source>
        <year>1989</year>
        <volume>45</volume>
        <issue>1</issue>
        <fpage>309</fpage>
        <lpage>16</lpage>
      </element-citation>
    </ref>
    <ref id="CR11">
      <label>11</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Anscombe</surname>
            <given-names>FJ</given-names>
          </name>
        </person-group>
        <article-title>Sampling theory of the negative binomial and logarithmic series distributions</article-title>
        <source>Biometrika</source>
        <year>1950</year>
        <volume>37</volume>
        <issue>3/4</issue>
        <fpage>358</fpage>
        <lpage>82</lpage>
        <?supplied-pmid 14801062?>
        <pub-id pub-id-type="pmid">14801062</pub-id>
      </element-citation>
    </ref>
    <ref id="CR12">
      <label>12</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Willson</surname>
            <given-names>LJ</given-names>
          </name>
          <name>
            <surname>Folks</surname>
            <given-names>JL</given-names>
          </name>
          <name>
            <surname>Young</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>Multistage estimation compared with fixed-sample-size estimation of the negative binomial parameter k</article-title>
        <source>Biometrics</source>
        <year>1984</year>
        <volume>40</volume>
        <issue>1</issue>
        <fpage>109</fpage>
        <lpage>17</lpage>
      </element-citation>
    </ref>
    <ref id="CR13">
      <label>13</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bliss</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Owen</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>Negative binomial distributions with a common k</article-title>
        <source>Biometrika</source>
        <year>1958</year>
        <volume>45</volume>
        <issue>1/2</issue>
        <fpage>37</fpage>
        <lpage>58</lpage>
      </element-citation>
    </ref>
    <ref id="CR14">
      <label>14</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Robinson</surname>
            <given-names>MD</given-names>
          </name>
          <name>
            <surname>McCarthy</surname>
            <given-names>DJ</given-names>
          </name>
          <name>
            <surname>Smyth</surname>
            <given-names>GK</given-names>
          </name>
        </person-group>
        <article-title>Edger: a bioconductor package for differential expression analysis of digital gene expression data</article-title>
        <source>Bioinformatics</source>
        <year>2010</year>
        <volume>26</volume>
        <issue>1</issue>
        <fpage>139</fpage>
        <lpage>40</lpage>
        <?supplied-pmid 19910308?>
        <pub-id pub-id-type="pmid">19910308</pub-id>
      </element-citation>
    </ref>
    <ref id="CR15">
      <label>15</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Love</surname>
            <given-names>MI</given-names>
          </name>
          <name>
            <surname>Huber</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Anders</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>Moderated estimation of fold change and dispersion for rna-seq data with deseq2</article-title>
        <source>Genome Biol</source>
        <year>2014</year>
        <volume>15</volume>
        <issue>12</issue>
        <fpage>550</fpage>
        <?supplied-pmid 25516281?>
        <pub-id pub-id-type="pmid">25516281</pub-id>
      </element-citation>
    </ref>
    <ref id="CR16">
      <label>16</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Soneson</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Delorenzi</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>A comparison of methods for differential expression analysis of rna-seq data</article-title>
        <source>BMC Bioinformatics</source>
        <year>2013</year>
        <volume>14</volume>
        <issue>1</issue>
        <fpage>91</fpage>
        <?supplied-pmid 23497356?>
        <pub-id pub-id-type="pmid">23497356</pub-id>
      </element-citation>
    </ref>
    <ref id="CR17">
      <label>17</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Breslow</surname>
            <given-names>NE</given-names>
          </name>
          <name>
            <surname>Clayton</surname>
            <given-names>DG</given-names>
          </name>
        </person-group>
        <article-title>Approximate inference in generalized linear mixed models</article-title>
        <source>J Am Stat Assoc</source>
        <year>1993</year>
        <volume>88</volume>
        <issue>421</issue>
        <fpage>9</fpage>
        <lpage>25</lpage>
      </element-citation>
    </ref>
    <ref id="CR18">
      <label>18</label>
      <mixed-citation publication-type="other">Rocke D. Excess false positives in negative-binomial based analysis of data from rna-seq experiments. <ext-link ext-link-type="uri" xlink:href="http://dmrocke.ucdavis.edu/papers/RNA-Seq%20UVA%20Seminar2016-03.pdf">http://dmrocke.ucdavis.edu/papers/RNA-Seq%20UVA%20Seminar2016-03.pdf</ext-link>. Accessed 15 Aug 2019.</mixed-citation>
    </ref>
    <ref id="CR19">
      <label>19</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Sun</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Hood</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Scott</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Peng</surname>
            <given-names>Q</given-names>
          </name>
          <name>
            <surname>Mukherjee</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Tung</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Zhou</surname>
            <given-names>X</given-names>
          </name>
        </person-group>
        <article-title>Differential expression analysis for rnaseq using poisson mixed models</article-title>
        <source>Nucleic Acids Res</source>
        <year>2017</year>
        <volume>45</volume>
        <issue>11</issue>
        <fpage>106</fpage>
        <pub-id pub-id-type="pmid">27664222</pub-id>
      </element-citation>
    </ref>
    <ref id="CR20">
      <label>20</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zhang</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Xu</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Jiang</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Hu</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Luo</surname>
            <given-names>Z</given-names>
          </name>
        </person-group>
        <article-title>Plnseq: a multivariate poisson lognormal distribution for high-throughput matched rna-sequencing read count data</article-title>
        <source>Stat Med</source>
        <year>2015</year>
        <volume>34</volume>
        <issue>9</issue>
        <fpage>1577</fpage>
        <lpage>89</lpage>
        <?supplied-pmid 25641202?>
        <pub-id pub-id-type="pmid">25641202</pub-id>
      </element-citation>
    </ref>
    <ref id="CR21">
      <label>21</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kang</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Du</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>H</given-names>
          </name>
        </person-group>
        <article-title>multide: a dimension reduced model based statistical method for differential expression analysis using rna-sequencing data with multiple treatment conditions</article-title>
        <source>BMC Bioinformatics</source>
        <year>2016</year>
        <volume>17</volume>
        <issue>1</issue>
        <fpage>248</fpage>
        <?supplied-pmid 27334001?>
        <pub-id pub-id-type="pmid">27334001</pub-id>
      </element-citation>
    </ref>
    <ref id="CR22">
      <label>22</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bian</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>He</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Hou</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Cheng</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Qiu</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>PairedFB: a full hierarchical bayesian model for paired rna-seq data with heterogeneous treatment effects</article-title>
        <source>Bioinformatics</source>
        <year>2019</year>
        <volume>35</volume>
        <issue>5</issue>
        <fpage>787</fpage>
        <lpage>97</lpage>
        <?supplied-pmid 30753300?>
        <pub-id pub-id-type="pmid">30753300</pub-id>
      </element-citation>
    </ref>
    <ref id="CR23">
      <label>23</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>van de Wiel</surname>
            <given-names>MA</given-names>
          </name>
          <name>
            <surname>Neerincx</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Buffart</surname>
            <given-names>TE</given-names>
          </name>
          <name>
            <surname>Sie</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Verheul</surname>
            <given-names>HM</given-names>
          </name>
        </person-group>
        <article-title>Shrinkbayes: a versatile r-package for analysis of count-based sequencing data in complex study designs</article-title>
        <source>BMC Bioinformatics</source>
        <year>2014</year>
        <volume>15</volume>
        <issue>1</issue>
        <fpage>116</fpage>
        <?supplied-pmid 24766777?>
        <pub-id pub-id-type="pmid">24766777</pub-id>
      </element-citation>
    </ref>
    <ref id="CR24">
      <label>24</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Datta</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Nettleton</surname>
            <given-names>D</given-names>
          </name>
        </person-group>
        <source>Statistical analysis of next generation sequencing data</source>
        <year>2014</year>
        <publisher-loc>New York</publisher-loc>
        <publisher-name>Springer</publisher-name>
      </element-citation>
    </ref>
    <ref id="CR25">
      <label>25</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Agniel</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Hejblum</surname>
            <given-names>BP</given-names>
          </name>
        </person-group>
        <article-title>Variance component score test for time-course gene set analysis of longitudinal rna-seq data</article-title>
        <source>Biostatistics</source>
        <year>2017</year>
        <volume>18</volume>
        <issue>4</issue>
        <fpage>589</fpage>
        <lpage>604</lpage>
        <?supplied-pmid 28334305?>
        <pub-id pub-id-type="pmid">28334305</pub-id>
      </element-citation>
    </ref>
    <ref id="CR26">
      <label>26</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ritchie</surname>
            <given-names>ME</given-names>
          </name>
          <name>
            <surname>Phipson</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Wu</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Hu</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Law</surname>
            <given-names>CW</given-names>
          </name>
          <name>
            <surname>Shi</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Smyth</surname>
            <given-names>GK</given-names>
          </name>
        </person-group>
        <article-title>Limma powers differential expression analyses for rna-sequencing and microarray studies</article-title>
        <source>Nucleic Acids Res</source>
        <year>2015</year>
        <volume>43</volume>
        <issue>7</issue>
        <fpage>47</fpage>
      </element-citation>
    </ref>
    <ref id="CR27">
      <label>27</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Law</surname>
            <given-names>CW</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Shi</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Smyth</surname>
            <given-names>GK</given-names>
          </name>
        </person-group>
        <article-title>Voom: Precision weights unlock linear model analysis tools for rna-seq read counts</article-title>
        <source>Genome Biol</source>
        <year>2014</year>
        <volume>15</volume>
        <issue>2</issue>
        <fpage>29</fpage>
      </element-citation>
    </ref>
    <ref id="CR28">
      <label>28</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Smyth</surname>
            <given-names>GK</given-names>
          </name>
        </person-group>
        <article-title>Limma: linear models for microarray data</article-title>
        <source>Bioinformatics and Computational Biology Solutions Using R and Bioconductor</source>
        <year>2005</year>
        <publisher-loc>New York</publisher-loc>
        <publisher-name>Springer</publisher-name>
      </element-citation>
    </ref>
    <ref id="CR29">
      <label>29</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Gamerman</surname>
            <given-names>D</given-names>
          </name>
        </person-group>
        <article-title>Sampling from the posterior distribution in generalized linear mixed models</article-title>
        <source>Stat Comput</source>
        <year>1997</year>
        <volume>7</volume>
        <issue>1</issue>
        <fpage>57</fpage>
        <lpage>68</lpage>
      </element-citation>
    </ref>
    <ref id="CR30">
      <label>30</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Rudra</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Shi</surname>
            <given-names>WJ</given-names>
          </name>
          <name>
            <surname>Vestal</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Russell</surname>
            <given-names>PH</given-names>
          </name>
          <name>
            <surname>Odell</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Dowell</surname>
            <given-names>RD</given-names>
          </name>
          <name>
            <surname>Radcliffe</surname>
            <given-names>RA</given-names>
          </name>
          <name>
            <surname>Saba</surname>
            <given-names>LM</given-names>
          </name>
          <name>
            <surname>Kechris</surname>
            <given-names>K</given-names>
          </name>
        </person-group>
        <article-title>Model based heritability scores for high-throughput sequencing data</article-title>
        <source>BMC Bioinformatics</source>
        <year>2017</year>
        <volume>18</volume>
        <issue>1</issue>
        <fpage>143</fpage>
        <?supplied-pmid 28253840?>
        <pub-id pub-id-type="pmid">28253840</pub-id>
      </element-citation>
    </ref>
    <ref id="CR31">
      <label>31</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Geweke</surname>
            <given-names>J</given-names>
          </name>
          <etal/>
        </person-group>
        <source>Evaluating the accuracy of sampling-based approaches to the calculation of posterior moments, vol. 196</source>
        <year>1991</year>
        <publisher-loc>Minneapolis</publisher-loc>
        <publisher-name>Federal Reserve Bank of Minneapolis, Research Department Minneapolis, MN</publisher-name>
      </element-citation>
    </ref>
    <ref id="CR32">
      <label>32</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Benjamini</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Hochberg</surname>
            <given-names>Y</given-names>
          </name>
        </person-group>
        <article-title>Controlling the false discovery rate: a practical and powerful approach to multiple testing</article-title>
        <source>J R Stat Soc Ser B Methodol</source>
        <year>1995</year>
        <volume>57</volume>
        <issue>1</issue>
        <fpage>289</fpage>
        <lpage>300</lpage>
      </element-citation>
    </ref>
    <ref id="CR33">
      <label>33</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Box</surname>
            <given-names>GE</given-names>
          </name>
          <name>
            <surname>Tiao</surname>
            <given-names>GC</given-names>
          </name>
        </person-group>
        <source>Bayesian inference in statistical analysis, vol. 40</source>
        <year>2011</year>
        <publisher-loc>Hoboken</publisher-loc>
        <publisher-name>John Wiley &amp; Sons</publisher-name>
      </element-citation>
    </ref>
    <ref id="CR34">
      <label>34</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Lesaffre</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Lawson</surname>
            <given-names>AB</given-names>
          </name>
        </person-group>
        <source>Bayesian biostatistics</source>
        <year>2012</year>
        <publisher-loc>New York</publisher-loc>
        <publisher-name>Wiley</publisher-name>
      </element-citation>
    </ref>
    <ref id="CR35">
      <label>35</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Turlach</surname>
            <given-names>BA</given-names>
          </name>
        </person-group>
        <article-title>Bandwidth selection in kernel density estimation: A review</article-title>
        <source>CORE and Institut de Statistique</source>
        <year>1993</year>
        <publisher-loc>Berlin</publisher-loc>
        <publisher-name>Springer</publisher-name>
      </element-citation>
    </ref>
    <ref id="CR36">
      <label>36</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Morris</surname>
            <given-names>JS</given-names>
          </name>
          <name>
            <surname>Brown</surname>
            <given-names>PJ</given-names>
          </name>
          <name>
            <surname>Herrick</surname>
            <given-names>RC</given-names>
          </name>
          <name>
            <surname>Baggerly</surname>
            <given-names>KA</given-names>
          </name>
          <name>
            <surname>Coombes</surname>
            <given-names>KR</given-names>
          </name>
        </person-group>
        <article-title>Bayesian analysis of mass spectrometry proteomic data using wavelet-based functional mixed models</article-title>
        <source>Biometrics</source>
        <year>2008</year>
        <volume>64</volume>
        <issue>2</issue>
        <fpage>479</fpage>
        <lpage>89</lpage>
        <?supplied-pmid 17888041?>
        <pub-id pub-id-type="pmid">17888041</pub-id>
      </element-citation>
    </ref>
    <ref id="CR37">
      <label>37</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Casella</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Berger</surname>
            <given-names>RL</given-names>
          </name>
        </person-group>
        <article-title>Reconciling bayesian and frequentist evidence in the one-sided testing problem</article-title>
        <source>J Am Stat Assoc</source>
        <year>1987</year>
        <volume>82</volume>
        <issue>397</issue>
        <fpage>106</fpage>
        <lpage>11</lpage>
      </element-citation>
    </ref>
    <ref id="CR38">
      <label>38</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Eddelbuettel</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Balamuta</surname>
            <given-names>JJ</given-names>
          </name>
        </person-group>
        <article-title>Extending extitR with extitC++: a brief introduction to extitRcpp</article-title>
        <source>PeerJ Prepr</source>
        <year>2017</year>
        <volume>5</volume>
        <fpage>3188</fpage>
        <lpage>1</lpage>
      </element-citation>
    </ref>
    <ref id="CR39">
      <label>39</label>
      <mixed-citation publication-type="other">Allaire J, Francois R, Ushey K, Vandenbrouck G, Geelnard M, Intel. RcppParallel: Parallel Programming Tools for ’Rcpp’. R package version 4.4.1. 2018.</mixed-citation>
    </ref>
    <ref id="CR40">
      <label>40</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Eddelbuettel</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Sanderson</surname>
            <given-names>C</given-names>
          </name>
        </person-group>
        <article-title>Rcpparmadillo: Accelerating r with high-performance c++ linear algebra</article-title>
        <source>Comput Stat Data Anal</source>
        <year>2014</year>
        <volume>71</volume>
        <fpage>1054</fpage>
        <lpage>63</lpage>
      </element-citation>
    </ref>
    <ref id="CR41">
      <label>41</label>
      <mixed-citation publication-type="other">Carpenter B, Gelman A, Hoffman MD, Lee D, Goodrich B, Betancourt M, Brubaker M, Guo J, Li P, Riddell A. Stan: A probabilistic programming language. J Stat Softw. 2017;76(1).</mixed-citation>
    </ref>
    <ref id="CR42">
      <label>42</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lunn</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Spiegelhalter</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Thomas</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Best</surname>
            <given-names>N</given-names>
          </name>
        </person-group>
        <article-title>The bugs project: Evolution, critique and future directions</article-title>
        <source>Stat Med</source>
        <year>2009</year>
        <volume>28</volume>
        <issue>25</issue>
        <fpage>3049</fpage>
        <lpage>67</lpage>
        <?supplied-pmid 19630097?>
        <pub-id pub-id-type="pmid">19630097</pub-id>
      </element-citation>
    </ref>
    <ref id="CR43">
      <label>43</label>
      <mixed-citation publication-type="other">Team S. Rstan: the r interface to stan. R package version. 2016;2(1).</mixed-citation>
    </ref>
    <ref id="CR44">
      <label>44</label>
      <mixed-citation publication-type="other">Zhang W. cplm: Monte carlo em algorithms and bayesian methods for fitting tweedie compound poisson linear models. R package version 0.2-1. 2011.</mixed-citation>
    </ref>
    <ref id="CR45">
      <label>45</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kuznetsova</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Brockhoff</surname>
            <given-names>PB</given-names>
          </name>
          <name>
            <surname>Christensen</surname>
            <given-names>RHB</given-names>
          </name>
        </person-group>
        <article-title>lmerTest package: Tests in linear mixed effects models</article-title>
        <source>J Stat Softw</source>
        <year>2017</year>
        <volume>82</volume>
        <issue>13</issue>
        <fpage>1</fpage>
        <lpage>26</lpage>
      </element-citation>
    </ref>
    <ref id="CR46">
      <label>46</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Fournier</surname>
            <given-names>DA</given-names>
          </name>
          <name>
            <surname>Skaug</surname>
            <given-names>HJ</given-names>
          </name>
          <name>
            <surname>Ancheta</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Ianelli</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Magnusson</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Maunder</surname>
            <given-names>MN</given-names>
          </name>
          <name>
            <surname>Nielsen</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Sibert</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>AD Model Builder: using automatic differentiation for statistical inference of highly parameterized complex nonlinear models</article-title>
        <source>Optim Methods Softw</source>
        <year>2012</year>
        <volume>27</volume>
        <fpage>233</fpage>
        <lpage>49</lpage>
      </element-citation>
    </ref>
    <ref id="CR47">
      <label>47</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Blankley</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Graham</surname>
            <given-names>CM</given-names>
          </name>
          <name>
            <surname>Levin</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Turner</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Berry</surname>
            <given-names>MP</given-names>
          </name>
          <name>
            <surname>Bloom</surname>
            <given-names>CI</given-names>
          </name>
          <name>
            <surname>Xu</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Pascual</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Banchereau</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Chaussabel</surname>
            <given-names>D</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>A 380-gene meta-signature of active tuberculosis compared with healthy controls</article-title>
        <source>Eur Respir J</source>
        <year>2016</year>
        <volume>47</volume>
        <issue>6</issue>
        <fpage>1873</fpage>
        <lpage>6</lpage>
        <?supplied-pmid 27076596?>
        <pub-id pub-id-type="pmid">27076596</pub-id>
      </element-citation>
    </ref>
    <ref id="CR48">
      <label>48</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zak</surname>
            <given-names>DE</given-names>
          </name>
          <name>
            <surname>Penn-Nicholson</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Scriba</surname>
            <given-names>TJ</given-names>
          </name>
          <name>
            <surname>Thompson</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Suliman</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Amon</surname>
            <given-names>LM</given-names>
          </name>
          <name>
            <surname>Mahomed</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Erasmus</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Whatney</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Hussey</surname>
            <given-names>GD</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>A blood rna signature for tuberculosis disease risk: a prospective cohort study</article-title>
        <source>Lancet</source>
        <year>2016</year>
        <volume>387</volume>
        <issue>10035</issue>
        <fpage>2312</fpage>
        <lpage>22</lpage>
        <?supplied-pmid 27017310?>
        <pub-id pub-id-type="pmid">27017310</pub-id>
      </element-citation>
    </ref>
    <ref id="CR49">
      <label>49</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kaforou</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Wright</surname>
            <given-names>VJ</given-names>
          </name>
          <name>
            <surname>Oni</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>French</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Anderson</surname>
            <given-names>ST</given-names>
          </name>
          <name>
            <surname>Bangani</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Banwell</surname>
            <given-names>CM</given-names>
          </name>
          <name>
            <surname>Brent</surname>
            <given-names>AJ</given-names>
          </name>
          <name>
            <surname>Crampin</surname>
            <given-names>AC</given-names>
          </name>
          <name>
            <surname>Dockrell</surname>
            <given-names>HM</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Detection of tuberculosis in hiv-infected and-uninfected african adults using whole blood rna expression signatures: a case-control study</article-title>
        <source>PLoS Med</source>
        <year>2013</year>
        <volume>10</volume>
        <issue>10</issue>
        <fpage>1001538</fpage>
      </element-citation>
    </ref>
    <ref id="CR50">
      <label>50</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Joosten</surname>
            <given-names>SA</given-names>
          </name>
          <name>
            <surname>Fletcher</surname>
            <given-names>HA</given-names>
          </name>
          <name>
            <surname>Ottenhoff</surname>
            <given-names>TH</given-names>
          </name>
        </person-group>
        <article-title>A helicopter perspective on tb biomarkers: pathway and process based analysis of gene expression data provides new insight into tb pathogenesis</article-title>
        <source>PloS ONE</source>
        <year>2013</year>
        <volume>8</volume>
        <issue>9</issue>
        <fpage>73230</fpage>
      </element-citation>
    </ref>
    <ref id="CR51">
      <label>51</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Maertzdorf</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Repsilber</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Parida</surname>
            <given-names>SK</given-names>
          </name>
          <name>
            <surname>Stanley</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Roberts</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Black</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Walzl</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Kaufmann</surname>
            <given-names>SH</given-names>
          </name>
        </person-group>
        <article-title>Human gene expression profiles of susceptibility and resistance in tuberculosis</article-title>
        <source>Genes Immun</source>
        <year>2011</year>
        <volume>12</volume>
        <issue>1</issue>
        <fpage>15</fpage>
        <?supplied-pmid 20861863?>
        <pub-id pub-id-type="pmid">20861863</pub-id>
      </element-citation>
    </ref>
    <ref id="CR52">
      <label>52</label>
      <mixed-citation publication-type="other">Nguyen Y, Nettleton D. rmrnaseq Differential expression analysis for repeated-measures rna-seq data. Bioinformatics. 2020.</mixed-citation>
    </ref>
    <ref id="CR53">
      <label>53</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Clayton</surname>
            <given-names>D</given-names>
          </name>
        </person-group>
        <person-group person-group-type="editor">
          <name>
            <surname>Gilks</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Richardson</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Spiegelhalter</surname>
            <given-names>D</given-names>
          </name>
        </person-group>
        <article-title>Generalized linear mixed models</article-title>
        <source>Markov Chain Montecarlo in Practice</source>
        <year>1996</year>
        <publisher-loc>London</publisher-loc>
        <publisher-name>Chapman and Hall</publisher-name>
      </element-citation>
    </ref>
    <ref id="CR54">
      <label>54</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Chavance</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Escolano</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>Misspecification of the covariance structure in generalized linear mixed models</article-title>
        <source>Stat Methods Med Res</source>
        <year>2016</year>
        <volume>25</volume>
        <issue>2</issue>
        <fpage>630</fpage>
        <lpage>43</lpage>
        <?supplied-pmid 23070599?>
        <pub-id pub-id-type="pmid">23070599</pub-id>
      </element-citation>
    </ref>
  </ref-list>
</back>
