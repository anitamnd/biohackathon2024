<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//NLM//DTD Journal Publishing DTD v2.3 20070202//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName journalpublishing.dtd?>
<?SourceDTD.Version 2.3?>
<?ConverterInfo.XSLTName jp2nlmx2.xsl?>
<?ConverterInfo.Version 2?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">Bioinformatics</journal-id>
    <journal-id journal-id-type="publisher-id">bioinformatics</journal-id>
    <journal-id journal-id-type="hwp">bioinfo</journal-id>
    <journal-title-group>
      <journal-title>Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1367-4803</issn>
    <issn pub-type="epub">1367-4811</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">4058922</article-id>
    <article-id pub-id-type="doi">10.1093/bioinformatics/btu295</article-id>
    <article-id pub-id-type="publisher-id">btu295</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Ismb 2014 Proceedings Papers Committee</subject>
        <subj-group subj-group-type="heading">
          <subject>Original Papers</subject>
          <subj-group subj-group-type="heading">
            <subject>Sequence Analysis</subject>
          </subj-group>
        </subj-group>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Accurate viral population assembly from ultra-deep sequencing data</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Mangul</surname>
          <given-names>Serghei</given-names>
        </name>
        <xref ref-type="aff" rid="btu295-AFF1">
          <sup>1</sup>
        </xref>
        <xref ref-type="corresp" rid="btu295-COR1">*</xref>
        <xref ref-type="author-notes" rid="btu295-FN1">
          <sup>†</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <name>
          <surname>Wu</surname>
          <given-names>Nicholas C.</given-names>
        </name>
        <xref ref-type="aff" rid="btu295-AFF1">
          <sup>2</sup>
        </xref>
        <xref ref-type="author-notes" rid="btu295-FN1">
          <sup>†</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <name>
          <surname>Mancuso</surname>
          <given-names>Nicholas</given-names>
        </name>
        <xref ref-type="aff" rid="btu295-AFF1">
          <sup>3</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <name>
          <surname>Zelikovsky</surname>
          <given-names>Alex</given-names>
        </name>
        <xref ref-type="aff" rid="btu295-AFF1">
          <sup>3</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <name>
          <surname>Sun</surname>
          <given-names>Ren</given-names>
        </name>
        <xref ref-type="aff" rid="btu295-AFF1">
          <sup>2</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Eskin</surname>
          <given-names>Eleazar</given-names>
        </name>
        <xref ref-type="aff" rid="btu295-AFF1">
          <sup>1</sup>
        </xref>
        <xref ref-type="aff" rid="btu295-AFF1">
          <sup>4</sup>
        </xref>
        <xref ref-type="corresp" rid="btu295-COR1">*</xref>
      </contrib>
    </contrib-group>
    <aff id="btu295-AFF1"><sup>1</sup>Computer Science Department, <sup>2</sup>Department of Molecular and Medical Pharmacology, University of California, Los Angeles, CA 90095, USA, <sup>3</sup>Department of Computer Science, Georgia State University, Atlanta, GA, 30303 and <sup>4</sup>Department of Human Genetics, University of California, Los Angeles, CA 90095, USA</aff>
    <author-notes>
      <corresp id="btu295-COR1">*To whom correspondence should be addressed.</corresp>
      <fn id="btu295-FN1">
        <p><sup>†</sup>The authors wish it to be known that, in their opinion, the first two authors should be regarded as Joint First Authors.</p>
      </fn>
    </author-notes>
    <pub-date pub-type="ppub">
      <day>15</day>
      <month>6</month>
      <year>2014</year>
    </pub-date>
    <pub-date pub-type="epub">
      <day>11</day>
      <month>6</month>
      <year>2014</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>11</day>
      <month>6</month>
      <year>2014</year>
    </pub-date>
    <!-- PMC Release delay is 0 months and 0 days and was based on the
							<pub-date pub-type="epub"/>. -->
    <volume>30</volume>
    <issue>12</issue>
    <fpage>i329</fpage>
    <lpage>i337</lpage>
    <permissions>
      <copyright-statement>© The Author 2014. Published by Oxford University Press.</copyright-statement>
      <copyright-year>2014</copyright-year>
      <license license-type="creative-commons" xlink:href="http://creativecommons.org/licenses/by-nc/3.0">
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution Non-Commercial License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by-nc/3.0/">http://creativecommons.org/licenses/by-nc/3.0/</ext-link>), which permits non-commercial re-use, distribution, and reproduction in any medium, provided the original work is properly cited. For commercial re-use, please contact journals.permissions@oup.com</license-p>
      </license>
    </permissions>
    <abstract>
      <p><bold>Motivation:</bold> Next-generation sequencing technologies sequence viruses with ultra-deep coverage, thus promising to revolutionize our understanding of the underlying diversity of viral populations. While the sequencing coverage is high enough that even rare viral variants are sequenced, the presence of sequencing errors makes it difficult to distinguish between rare variants and sequencing errors. <bold>Results:</bold> In this article, we present a method to overcome the limitations of sequencing technologies and assemble a diverse viral population that allows for the detection of previously undiscovered rare variants. The proposed method consists of a high-fidelity sequencing protocol and an accurate viral population assembly method, referred to as Viral Genome Assembler (VGA). The proposed protocol is able to eliminate sequencing errors by using individual barcodes attached to the sequencing fragments. Highly accurate data in combination with deep coverage allow VGA to assemble rare variants. VGA uses an expectation–maximization algorithm to estimate abundances of the assembled viral variants in the population. Results on both synthetic and real datasets show that our method is able to accurately assemble an HIV viral population and detect rare variants previously undetectable due to sequencing errors. VGA outperforms state-of-the-art methods for genome-wide viral assembly. Furthermore, our method is the first viral assembly method that scales to millions of sequencing reads. <bold>Availability:</bold> Our tool VGA is freely available at <ext-link ext-link-type="uri" xlink:href="http://genetics.cs.ucla.edu/vga/">http://genetics.cs.ucla.edu/vga/</ext-link></p>
      <p><bold>Contact:</bold><email>serghei@cs.ucla.edu</email>; <email>eeskin@cs.ucla.edu</email></p>
    </abstract>
    <counts>
      <page-count count="9"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec>
    <title>1 INTRODUCTION</title>
    <p>Human immunodeficiency virus (HIV) exhibits high genomic diversity within an infected host, which affects many clinically important phenotypic traits such as escape from vaccine-induced immunity, virulence and response to antiviral therapies (<xref rid="btu295-B14" ref-type="bibr">Lauring and Andino, 2010</xref>). To accurately characterize an intra-host HIV population, sequencing technologies must be sensitive enough to detect and quantify rare variants (<xref rid="btu295-B8" ref-type="bibr">Henn <italic>et al.</italic>, 2012</xref>; <xref rid="btu295-B25" ref-type="bibr">Tsibris <italic>et al.</italic>, 2009</xref>). Next-generation sequencing (NGS) technologies offer deep coverage of genomic data in the form of millions of sequencing reads (<xref rid="btu295-B19" ref-type="bibr">Metzker, 2009</xref>). While the sequencing coverage is high enough to capture rare variants, the presence of sequencing errors makes it difficult to distinguish between rare variants and sequencing err0ors. Additionally, low viral population variability (i.e. pairs of individual viral genomes that have small genetic distance) and the presence of individual variants having low abundance complicates accessing viral diversity and assembling full-length viral variants.</p>
    <p>The full picture of viral diversity in a population remains undiscovered due to errors produced by sequencing platforms. Current sequencing technologies use different underlying chemistry and offer trade-offs among throughput, read length and cost (<xref rid="btu295-B19" ref-type="bibr">Metzker, 2009</xref>). While the current sequencing platforms can potentially detect point-mutations, error rates may result in false-positive single nucleotide variant (SNV) calls or wrong genome variant sequences. Computational error correction techniques are able to partially correct the sequencing error and provide an opportunity to discover highly expressed individual viral genomes, but low abundant variants remain undiscovered. Current methods (<xref rid="btu295-B3" ref-type="bibr">Astrovskaya, 2011</xref>; <xref rid="btu295-B17" ref-type="bibr">Mancuso <italic>et al.</italic>, 2011</xref>; <xref rid="btu295-B24" ref-type="bibr">Prosperi and Salemi, 2012</xref>; <xref rid="btu295-B30" ref-type="bibr">Zagordi <italic>et al.</italic>, 2011</xref>, <xref rid="btu295-B32" ref-type="bibr">2012</xref>) are not able to differentiate true biological mutations from sequencing artifacts, thus significantly limiting the possibility of a method to assemble the underlying viral population.</p>
    <p>In this article, we propose a method to overcome these limitations by coupling a high-fidelity sequencing protocol (<xref rid="btu295-B12" ref-type="bibr">Kinde <italic>et al.</italic>, 2011</xref>) with an accurate method, referred to as <bold>V</bold>iral <bold>G</bold>enome <bold>A</bold>ssembler (VGA), to assemble a heterogeneous viral population. High-fidelity sequencing protocol, known as Safe-SeqS, has been applied to detect rare somatic mutations, but its application on detecting rare viral mutations has been neglected. Similar to Safe-SeqS we apply a special library preparation technique that eliminates sequencing errors during the de-multiplexing step. The proposed protocol attaches individual barcode sequences during the library preparation step for every fragment, then amplifies each tagged fragment. Reads are clustered according to the original fragment based on the attached barcode. An error-correction protocol is then applied for every read group resulting in a method that corrects errors inside the group and produces a corrected consensus read. Highly accurate data in combination with deep coverage allows for accurate estimation of the underlying diversity of a viral population. Importantly, the low per-base sequencing cost of the Illumina platform makes it realistic to greatly increase coverage to detect ultra-rare variants. Our sequencing protocol introduces novel challenges for virus assembly and we develop a novel assembly approach for reconstructing and estimating the frequency of a large number of closely related viral variants. Our method does not rely on the availability of a reference genome. This makes our method applicable to newly emerged viruses in which genome sequences are unknown.</p>
    <p>The ability to discover rare viral variants makes our tool applicable for monitoring and quantifying an HIV population structure to dissect its evolutionary landscape and study genomic interaction. In particular, our approach allows for the discovery of rare mutations and variants that are of particular interest because of their potential influence on drug resistance and treatment failure (<xref rid="btu295-B15" ref-type="bibr">Liu <italic>et al.</italic>, 2011</xref>; <xref rid="btu295-B23" ref-type="bibr">Palmer <italic>et al.</italic>, 2006</xref>; <xref rid="btu295-B26" ref-type="bibr">Wang <italic>et al.</italic>, 2007</xref>).</p>
  </sec>
  <sec>
    <title>2 METHODS</title>
    <sec sec-type="intro">
      <title>2.1 Overview</title>
      <p>Advances in NGS and the ability to generate deep coverage data in the form of millions of reads provide exceptional resolution for studying the underlying genetic diversity of complex viral populations. However, errors produced by most sequencing protocols complicate distinguishing between true biological mutations and technical artifacts that confound detection of rare mutations and rare individual genome variants. A common approach is to use post-sequencing error correction techniques able to partially correct the sequencing errors. In contrast to clonal samples, the post-sequencing error correction methods are not well suited for mixed viral samples and may lead to filtering out true biological mutations. For this reason, current viral assembly methods are able to detect only highly abundant SNV, thus limiting the discovery of rare viral genomes.</p>
      <p>Additional difficulty arises from the genomic architectures of viruses. Long common regions shared across viral population (known as conserved regions) introduce ambiguity in the assembly process. Conserved regions may be due low-diversity population or due to recombination with multiple cross-overs. In contrast to repeats in genome assembly, conserved regions may be phased based on relative abundances of viral variants. Low-diversity viral populations in which all pairs of individual genomes within a viral population have a small genetic distance from each other may represent additional challenges for the assembly procedure.</p>
      <p>We apply a high-fidelity sequencing protocol to study viral population structure (<xref ref-type="fig" rid="btu295-F1">Fig. 1</xref>). This protocol is able to eliminate errors from sequencing data by attaching individual barcodes during the library preparation step. After the fragments are sequenced, the barcodes identify clusters of reads that originated from the same fragment, thus facilitating error correction. Given that many reads are required to sequence each fragment, we are trading off an increase in sequence coverage for a reduction in error rate. Prior to assembly, we utilize the <italic>de novo</italic> consensus reconstruction tool, Vicuna (<xref rid="btu295-B28" ref-type="bibr">Yang <italic>et al.</italic>, 2012</xref>), to produce a linear consensus directly from the sequence data. This approach offers more flexibility for samples that do not have ‘close’ reference sequences available. Traditional assembly methods (<xref rid="btu295-B7" ref-type="bibr">Gnerre <italic>et al.</italic>, 2011</xref>; <xref rid="btu295-B16" ref-type="bibr">Luo <italic>et al.</italic>, 2012</xref>; <xref rid="btu295-B33" ref-type="bibr">Zerbino and Birney, 2008</xref>) aim to reconstruct a linear consensus sequence and are not well-suited for assembling a large number of highly similar but distinct viral genomes. We instead take our ideas from haplotype assembly methods (<xref rid="btu295-B4" ref-type="bibr">Bansal and Bafna, 2008</xref>; <xref rid="btu295-B27" ref-type="bibr">Yang <italic>et al.</italic>, 2013</xref>), which aim to reconstruct two closely related haplotypes. However, these methods are not applicable for assembly of a large (<italic>a priori</italic> unknown) number of individual genomes. Many existing viral assemblers estimate local population diversity and are not well suited for assembling full-length quasi-species variants spanning the entire viral genome. Available genome-wide assemblers able to reconstruct full-length quasi-species variants are originally designed for low throughput and are impractical for high throughput technologies containing millions of sequencing reads.
<fig id="btu295-F1" position="float"><label>Fig. 1.</label><caption><p>Overview of high-fidelity sequencing protocol. (<bold>A</bold>) DNA material from a viral population is cleaved into sequence fragments using any suitable restriction enzyme. (<bold>B</bold>) Individual barcode sequences are attached to the fragments. Each tagged fragment is amplified by the polymerase chain reaction (PCR). (<bold>C</bold>) Amplified fragments are then sequenced. (<bold>D</bold>) Reads are grouped according to the fragment of origin based on their individual barcode sequence. An error-correction protocol is applied for every read group, correcting the sequencing errors inside the group and producing corrected consensus reads. (<bold>E</bold>) Error-corrected reads are mapped to the population consensus. (<bold>F</bold>) SNVs are detected and assembled into individual viral genomes. The ordinary protocol lacks steps (B) and (D)</p></caption><graphic xlink:href="btu295f1"/></fig></p>
      <p>We introduce a viral population assembly method (<xref ref-type="fig" rid="btu295-F2">Fig. 2</xref>) working on highly accurate sequencing data able to detect rare variants and tolerate conserved regions shared across the population. Our method is coupled with post-assembly procedures able to detect and resolve ambiguity raised from long conserved regions using expression profiles (<xref ref-type="fig" rid="btu295-F2">Fig. 2</xref>F). After a consensus has been reconstructed directly from the sequence data, our method detects SNVs from the aligned sequencing reads. Read overlapping is used to link individual SNVs and distinguish between genome variants in the population. The viral population is condensed in a conflict graph built from aligned sequencing data. Two reads are originated from different viral genomes if they share different SNVs in the overlapping region. Viral variants are identified from the graph as independent sets of non-conflicting reads. Non-continuous coverage of rare viral variants may limit assembly capacities, indicating that increase in coverage is required to increase the assembly accuracy. Frequencies of identified variants are then estimated using an expectation–maximization algorithm. Compared with existing approaches, we are able to detect rare population variants while achieving high assembly accuracy.
<fig id="btu295-F2" position="float"><label>Fig. 2.</label><caption><p>Overview of VGA. (<bold>A</bold>) The algorithm takes as input paired-end reads that have been mapped to the population consensus. (<bold>B</bold>) The first step in the assembly is to determine pairs of conflicting reads that share different SNVs in the overlapping region. Pairs of conflicting reads are connected in the ‘conflict graph’. Each read has a node in the graph, and an edge is placed between each pair of conflicting reads. (<bold>C</bold>) The graph is colored into a minimal set of colors to distinguish between genome variants in the population. Colors of the graph correspond to independent sets of non-conflicting reads that are assembled into genome variants. In this example, the conflict graph can be minimally colored with four colors (red, green, violet and turquoise), each representing individual viral genomes. (<bold>D</bold>) Reads of the same color are then assembled into individual viral genomes. Only fully covered viral genomes are reported. (<bold>E</bold>) Reads are assigned to assembled viral genomes. Read may be shared across two or more viral genomes. VGA infers relative abundances of viral genomes using the expectation–maximization algorithm. (<bold>F</bold>) Long conserved regions are detected and phased based on expression profiles. In this example red and green viral genome share a long conserved region (colored in black). There is no direct evidence how the viral sub-genomes across the conserved region should be connected. In this example four possible phasing are valid. VGA use the expression information of every sub-genome to resolve ambiguous phasing</p></caption><graphic xlink:href="btu295f2"/></fig></p>
    </sec>
    <sec id="SEC2.2">
      <title>2.2 Error correction</title>
      <p>The proposed sequencing is able to eliminate errors from sequencing data and produce highly accurate read sequences. It uses a high-fidelity sequencing protocol that attaches individual barcodes during the library preparation step. The barcodes are then used to identify reads originated from the same fragment, allowing to access multiple sequencing data of the same fragment. It follows that every sequenced position of the fragment would have multiple independent evidence, suitably promoting highly accurate consensus reads. By applying an error-correction procedure of the protocol, we are able to address both sequencing and PCR errors, which leads to high assembly accuracy.</p>
    </sec>
    <sec id="SEC2.3">
      <title>2.3 Consensus construction</title>
      <p>We build a consensus from paired-end reads using Vicuna (<xref rid="btu295-B28" ref-type="bibr">Yang <italic>et al.</italic>, 2012</xref>). Our sequencing method should not contain any particularly low coverage region allowing reconstruction of population consensus for viral sample. In the event that Vicuna produces multiple contigs rather than a complete consensus, we use BLAST to merge contigs. We require 50 nt overlap to merge any pair of contigs. In the next step, the population consensus is used as a reference genome to map reads. Building the reference genome from actual sequencing data rather than using an annotated genome provides us with an accurate and unique mapping.</p>
    </sec>
    <sec id="SEC2.4">
      <title>2.4 Read mapping</title>
      <p>As with many viral population analyses, the first step of VGA is to map the reads. We map reads onto the <italic>de novo</italic> consensus using InDelFixer (<xref rid="btu295-B2" ref-type="bibr">Armin and Beerenwinkel, 2013</xref>) with default parameters. False read alignments are filtered out using fragment length distribution inferred from the mapping data. Assuming that the fragment length follows a normal distribution (<xref rid="btu295-B9" ref-type="bibr">Hormozdiari <italic>et al.</italic>, 2009</xref>), we only keep reads with fragment length within three standard deviations from the mean. In total 1.2% of reads have been filtered out versus expected .3% according to the three-sigma rule.</p>
    </sec>
    <sec id="SEC2.5">
      <title>2.5 Viral population assembly</title>
      <p>The combination of deep coverage with high accuracy provides an unprecedented opportunity for estimating genomic diversity in a viral population. The viral population assembly starts with determining pairs of mapped reads conflicting with each other in the overlapping region. Following <xref rid="btu295-B10" ref-type="bibr">Huang <italic>et al.</italic> (2011)</xref>, we construct the conflict graph <inline-formula><mml:math id="n1"><mml:mrow><mml:mi>G</mml:mi><mml:mo>=</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>V</mml:mi><mml:mo>,</mml:mo><mml:mi>E</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> with vertices corresponding paired-end reads, i.e. <italic>V</italic> = <italic>R</italic>, and edges connecting conflicting pairs of paired-end reads.</p>
      <p>Obviously, any true viral genome corresponds to a maximal independent set in the conflict graph (i.e. a maximal set of pairwise nonadjacent vertices), although not every maximal independent set necessarily corresponds to a true viral genome. We adopt a parsimonious approach requiring to cover the conflict graph with the minimum number of maximal independent sets. This problem is equivalent to MIN-GRAPH-COLORING which is NP-hard. There exists many heuristics for solving this problem [see, e.g. <xref rid="btu295-B11" ref-type="bibr">Johnson and Trick, 1996</xref>; <xref rid="btu295-B13" ref-type="bibr">Kubale, 2004</xref>] based on greedy selection of a maximal independent set. Unfortunately, our attempts to build even a single viral genome failed, as it is difficult to arrange paired-end reads into a connected single path. Indeed, a greedy algorithm runs out of any possible extension after just a few steps while concatenating paired-end reads from left-to-right.</p>
      <p>Instead, we apply an alternative ‘top–down’ approach of recursive graph partitioning along the maximum cut (Max Cut) which has been previously successfully applied for human haplotyping (<xref rid="btu295-B5" ref-type="bibr">Duitama <italic>et al.</italic>, 2012</xref>). Given a graph <inline-formula><mml:math id="n2"><mml:mrow><mml:mi>G</mml:mi><mml:mo>=</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>V</mml:mi><mml:mo>,</mml:mo><mml:mi>E</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>, the Max Cut problem asks for partitioning of the vertices into two components <inline-formula><mml:math id="n3"><mml:mrow><mml:mi>V</mml:mi><mml:mo>=</mml:mo><mml:msub><mml:mi>V</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>∪</mml:mo><mml:msub><mml:mi>V</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> maximizing the total number of edges which have one endpoint in <italic>V</italic><sub>1</sub> and the other in <italic>V</italic><sub>2</sub>. The Max Cut problem though NP-hard is well approximated by a simple 0.5-approximation algorithm that randomly assigns vertex to one of the two components (<xref rid="btu295-B20" ref-type="bibr">Mitzenmacher and Upfal, 2005</xref>). Our Max Cut heuristic starts with alternatively assigning left-to-right sorted mapped reads to two components and then repeatedly moves one vertex at a time from one component to another, improving the solution at each step, until no more improvements of this type can be made.</p>
      <p>Our coloring heuristic recursively partitions the conflict graph until each component becomes independent. If reads of a given color completely cover the consensus genome, then the resulted sequence is accepted as the next viral genome. Otherwise, if assembled genome contains gaps, we add non-conflicting reads from other color classes in left-to-right order in attempt to fill the gaps. If all SNV positions are covered, then a newly reconstructed viral genome is added to the set <inline-formula><mml:math id="n4"><mml:mrow><mml:mi mathvariant="script" class="calligraphy">V</mml:mi><mml:mi mathvariant="script" class="calligraphy">G</mml:mi></mml:mrow></mml:math></inline-formula>. Finally, the genomes whose gaps cannot be filled with the above procedure are dropped.</p>
      <p>
        <boxed-text id="btu295-BOX1" position="float">
          <caption>
            <title>Algorithm 1: VGA Assembly Algorithm.</title>
          </caption>
          <p><bold>Input:</bold> Set of reads R aligned to the consensus genome</p>
          <p>Build conflict graph G = (V,E) from set R</p>
          <p>Recursively color G into color classes <inline-formula><mml:math id="n5"><mml:mi mathvariant="script" class="calligraphy">C</mml:mi></mml:math></inline-formula> using Max Cut</p>
          <p>Initialize the set of complete viral genomes <inline-formula><mml:math id="n6"><mml:mrow><mml:mi mathvariant="script" class="calligraphy">V</mml:mi><mml:mi mathvariant="script" class="calligraphy">G</mml:mi><mml:mo>←</mml:mo><mml:mo>∅</mml:mo></mml:mrow></mml:math></inline-formula></p>
          <p><bold>for</bold> each color class <inline-formula><mml:math id="n7"><mml:mrow><mml:msub><mml:mi>c</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>∈</mml:mo><mml:mi mathvariant="script" class="calligraphy">C</mml:mi></mml:mrow></mml:math></inline-formula>
<bold>do</bold></p>
          <p> Compute maximal independent set in <inline-formula><mml:math id="n8"><mml:mrow><mml:mi>G</mml:mi><mml:mo>=</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>V</mml:mi><mml:mo>,</mml:mo><mml:mi>E</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> containing <italic>c<sub>i</sub></italic></p>
          <p> Assemble reads in <italic>c<sub>i</sub></italic> into viral genome <italic>g<sub>i</sub></italic></p>
          <p> <bold>if</bold>
<italic>g<sub>i</sub></italic> covers all positions in the consensus genome <bold>then</bold></p>
          <p>  <inline-formula><mml:math id="n9"><mml:mrow><mml:mi mathvariant="script" class="calligraphy">V</mml:mi><mml:mi mathvariant="script" class="calligraphy">G</mml:mi><mml:mo>←</mml:mo><mml:mi mathvariant="script" class="calligraphy">V</mml:mi><mml:mi mathvariant="script" class="calligraphy">G</mml:mi><mml:mo>∪</mml:mo></mml:mrow></mml:math></inline-formula>{<inline-formula><mml:math id="n10"><mml:mrow><mml:msub><mml:mi>g</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula>}</p>
          <p> <bold>end if</bold></p>
          <p>
            <bold>end for</bold>
          </p>
          <p><bold>Output:</bold> Set of complete viral genomes <inline-formula><mml:math id="n11"><mml:mrow><mml:mi mathvariant="script" class="calligraphy">V</mml:mi><mml:mi mathvariant="script" class="calligraphy">G</mml:mi></mml:mrow></mml:math></inline-formula></p>
        </boxed-text>
      </p>
    </sec>
    <sec id="SEC2.6">
      <title>2.6 Viral population quantification</title>
      <p>In the final step of the workflow, an expectation–maximization algorithm is used to infer the relative abundances of assembled viral quasi-species similar to what is described in <xref rid="btu295-B6" ref-type="bibr">Eriksson <italic>et al.</italic> (2008)</xref>. We extend the previous EM and likelihood formulation to incorporate a prior probability for the viral population and compute the <italic>maximum a-posteriori</italic> estimate, rather than the MLE.</p>
      <p>Let <italic>H</italic> be a random variable over the set of viral variant genomes <inline-formula><mml:math id="n12"><mml:mrow><mml:mi mathvariant="script" class="calligraphy">H</mml:mi><mml:mo>=</mml:mo><mml:mi mathvariant="script" class="calligraphy">V</mml:mi><mml:mi mathvariant="script" class="calligraphy">G</mml:mi></mml:mrow></mml:math></inline-formula> and let <italic>R</italic> be a random variable over the set of reads <inline-formula><mml:math id="n13"><mml:mi mathvariant="script" class="calligraphy">R</mml:mi></mml:math></inline-formula>. Let <inline-formula><mml:math id="n14"><mml:mrow><mml:mi>p</mml:mi><mml:mo stretchy="false">[</mml:mo><mml:mi mathvariant="script" class="calligraphy">H</mml:mi><mml:mo stretchy="false">]</mml:mo><mml:mo>∼</mml:mo><mml:mtext>Dir</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mi>α</mml:mi><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mi>α</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> be the prior probability of observing a given set of variants and denote <inline-formula><mml:math id="n15"><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mi>h</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mi>Pr</mml:mi><mml:mo>⁡</mml:mo><mml:mo stretchy="false">[</mml:mo><mml:mi>H</mml:mi><mml:mo>=</mml:mo><mml:mi>h</mml:mi><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:math></inline-formula> to be the probability of observing a particular variant <italic>h</italic>. The probability of observing read <inline-formula><mml:math id="n16"><mml:mrow><mml:mi>r</mml:mi><mml:mo>∈</mml:mo><mml:mi mathvariant="script" class="calligraphy">R</mml:mi></mml:mrow></mml:math></inline-formula> is given by marginalizing over all variants
<disp-formula><mml:math id="n17"><mml:mrow><mml:mi>Pr</mml:mi><mml:mo>⁡</mml:mo><mml:mo stretchy="false">[</mml:mo><mml:mi>R</mml:mi><mml:mo>=</mml:mo><mml:mi>r</mml:mi><mml:mo stretchy="false">]</mml:mo><mml:mo>=</mml:mo><mml:mstyle displaystyle="true"><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>h</mml:mi><mml:mo>∈</mml:mo><mml:mi mathvariant="script" class="calligraphy">H</mml:mi></mml:mrow></mml:munder><mml:mrow><mml:mi>Pr</mml:mi><mml:mo>⁡</mml:mo></mml:mrow></mml:mstyle><mml:mo stretchy="false">[</mml:mo><mml:mi>R</mml:mi><mml:mo>=</mml:mo><mml:mi>r</mml:mi><mml:mo stretchy="false">|</mml:mo><mml:mi>H</mml:mi><mml:mo>=</mml:mo><mml:mi>h</mml:mi><mml:mo stretchy="false">]</mml:mo><mml:mo>·</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mi>h</mml:mi></mml:msub></mml:mrow></mml:math></disp-formula>
where
<disp-formula><mml:math id="n18"><mml:mrow><mml:mi>Pr</mml:mi><mml:mo>⁡</mml:mo><mml:mo stretchy="false">[</mml:mo><mml:mi>R</mml:mi><mml:mo>=</mml:mo><mml:mi>r</mml:mi><mml:mo stretchy="false">|</mml:mo><mml:mi>H</mml:mi><mml:mo>=</mml:mo><mml:mi>h</mml:mi><mml:mo stretchy="false">]</mml:mo><mml:mo>=</mml:mo><mml:mrow><mml:mo stretchy="true">{</mml:mo><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:msub><mml:mi>K</mml:mi><mml:mi>h</mml:mi></mml:msub></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mtext>if</mml:mtext><mml:mspace width=".3em"/><mml:mi>r</mml:mi><mml:mspace width=".3em"/><mml:mtext>is consistent with</mml:mtext><mml:mspace width=".3em"/><mml:mi>h</mml:mi></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mrow><mml:mtext>otherwise</mml:mtext></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mrow></mml:mrow></mml:math></disp-formula>
and <italic>K<sub>h</sub></italic> is the number of reads consistent with <italic>h</italic>. We can now define the log-posterior as
<disp-formula><mml:math id="n19"><mml:mrow><mml:mi>log</mml:mi><mml:mo>⁡</mml:mo><mml:mi>Pr</mml:mi><mml:mo>⁡</mml:mo><mml:mo stretchy="false">[</mml:mo><mml:mi mathvariant="script" class="calligraphy">H</mml:mi><mml:mo stretchy="false">|</mml:mo><mml:mi mathvariant="script" class="calligraphy">R</mml:mi><mml:mo stretchy="false">]</mml:mo><mml:mo>=</mml:mo><mml:mstyle displaystyle="true"><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>r</mml:mi><mml:mo>∈</mml:mo><mml:mi mathvariant="script" class="calligraphy">R</mml:mi></mml:mrow></mml:munder><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mi>r</mml:mi></mml:msub></mml:mrow></mml:mstyle><mml:mo>·</mml:mo><mml:mi>log</mml:mi><mml:mo>⁡</mml:mo><mml:mi>Pr</mml:mi><mml:mo>⁡</mml:mo><mml:mo stretchy="false">[</mml:mo><mml:mi>R</mml:mi><mml:mo>=</mml:mo><mml:mi>r</mml:mi><mml:mo stretchy="false">]</mml:mo><mml:mo>+</mml:mo><mml:mi>α</mml:mi><mml:mo>·</mml:mo><mml:mstyle displaystyle="true"><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>h</mml:mi><mml:mo>∈</mml:mo><mml:mi mathvariant="script" class="calligraphy">H</mml:mi></mml:mrow></mml:munder><mml:mrow><mml:mi>log</mml:mi><mml:mo>⁡</mml:mo></mml:mrow></mml:mstyle><mml:msub><mml:mi>p</mml:mi><mml:mi>h</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mi mathvariant="script" class="calligraphy">R</mml:mi></mml:msub></mml:mrow></mml:math></disp-formula>
where <inline-formula><mml:math id="n20"><mml:mrow><mml:msub><mml:mi>C</mml:mi><mml:mi mathvariant="script" class="calligraphy">R</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> is a constant and <italic>n<sub>r</sub></italic> is the number of reads <italic>r</italic>. As this function is non-convex and difficult to optimize, we solve the easier problem of maximizing its lower-bound,
<disp-formula><mml:math id="n21"><mml:mrow><mml:mstyle displaystyle="true"><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>r</mml:mi><mml:mo>∈</mml:mo><mml:mi mathvariant="script" class="calligraphy">R</mml:mi></mml:mrow></mml:munder><mml:mrow><mml:mstyle displaystyle="true"><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>h</mml:mi><mml:mo>∈</mml:mo><mml:mi mathvariant="script" class="calligraphy">H</mml:mi></mml:mrow></mml:munder><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>r</mml:mi><mml:mi>h</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:mrow></mml:mstyle><mml:mo>·</mml:mo><mml:mi>log</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mrow><mml:mi>Pr</mml:mi><mml:mo>⁡</mml:mo><mml:mo stretchy="false">[</mml:mo><mml:mi>R</mml:mi><mml:mo>=</mml:mo><mml:mi>r</mml:mi><mml:mo stretchy="false">|</mml:mo><mml:mi>H</mml:mi><mml:mo>=</mml:mo><mml:mi>h</mml:mi><mml:mo stretchy="false">]</mml:mo><mml:mo>·</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mi>h</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="true">)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mi>α</mml:mi><mml:mo>·</mml:mo><mml:mstyle displaystyle="true"><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>h</mml:mi><mml:mo>∈</mml:mo><mml:mi mathvariant="script" class="calligraphy">H</mml:mi></mml:mrow></mml:munder><mml:mrow><mml:mi>log</mml:mi><mml:mo>⁡</mml:mo></mml:mrow></mml:mstyle><mml:msub><mml:mi>p</mml:mi><mml:mi>h</mml:mi></mml:msub></mml:mrow></mml:math></disp-formula>
where <italic>n<sub>rh</sub></italic> is the expected number of reads <italic>r</italic> generated by variant <italic>h</italic>. The EM algorithm computes this by
<disp-formula><mml:math id="n22"><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>r</mml:mi><mml:mi>h</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mi>r</mml:mi></mml:msub><mml:mo>·</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mi>h</mml:mi></mml:msub><mml:mo>·</mml:mo><mml:mi>Pr</mml:mi><mml:mo>⁡</mml:mo><mml:mo stretchy="false">[</mml:mo><mml:mi>R</mml:mi><mml:mo>=</mml:mo><mml:mi>r</mml:mi><mml:mo stretchy="false">|</mml:mo><mml:mi>H</mml:mi><mml:mo>=</mml:mo><mml:mi>h</mml:mi><mml:mo stretchy="false">]</mml:mo></mml:mrow><mml:mrow><mml:mi>Pr</mml:mi><mml:mo>⁡</mml:mo><mml:mo stretchy="false">[</mml:mo><mml:mi>R</mml:mi><mml:mo>=</mml:mo><mml:mi>r</mml:mi><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:mfrac><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>
and subsequently maximizes the log-posterior with the MAP estimate given by
<disp-formula><mml:math id="n23"><mml:mrow><mml:mover accent="true"><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mi>h</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="true">^</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mrow><mml:mi>α</mml:mi><mml:mo>+</mml:mo><mml:mstyle displaystyle="true"><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>r</mml:mi><mml:mo>∈</mml:mo><mml:mi mathvariant="script" class="calligraphy">R</mml:mi></mml:mrow></mml:munder><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>r</mml:mi><mml:mi>h</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:mrow><mml:mo stretchy="true">)</mml:mo></mml:mrow><mml:mo>/</mml:mo><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mrow><mml:mi>α</mml:mi><mml:mo>+</mml:mo><mml:mstyle displaystyle="true"><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>r</mml:mi><mml:mo>∈</mml:mo><mml:mi mathvariant="script" class="calligraphy">R</mml:mi></mml:mrow></mml:munder><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mi>r</mml:mi></mml:msub></mml:mrow></mml:mstyle></mml:mrow><mml:mo stretchy="true">)</mml:mo></mml:mrow></mml:mrow></mml:math></disp-formula>
</p>
    </sec>
  </sec>
  <sec>
    <title>3 RESULTS</title>
    <sec id="SEC3.1">
      <title>3.1 Performance of VGA on simulated data</title>
      <p>Because the ground truth is unknown for sequenced viral populations, simulations present a standardized way to assess the performance of viral assembly tools. The proposed high-fidelity protocol allows to correct sequencing errors, thus giving access to highly accurate sequencing data. Post-sequencing error-correction techniques are available for reads obtained by regular protocol offering the possibility to partially correct sequencing errors trading off for real biological mutations. Grinder (<xref rid="btu295-B1" ref-type="bibr">Angly <italic>et al.</italic>, 2012</xref>) is used to generate reads from both the high-fidelity and regular sequencing protocol. Reads are generated from both real and synthetic viral variants with different sequencing parameters and viral expression profiles. Grinder is a state-of-the-art sequencing read simulator able to produce shotgun sequencing data from a viral population with different expression profiles. We mapped the simulated paired-end reads onto the consensus using Mosaik. The consensus was constructed using Vicuna (<xref rid="btu295-B28" ref-type="bibr">Yang <italic>et al.</italic>, 2012</xref>), a <italic>de novo</italic> assembly tool able to produce a linear consensus from deep paired-end sequencing data (see Section 2.3 for details).</p>
      <p>We use sensitivity and positive predictive value (PPV) to evaluate the quality of viral genomes assembled by VGA. We consider fully assembled viral genome without errors. Sensitivity is defined as the portion of assembled quasi-species that match true quasi-species, i.e. <inline-formula><mml:math id="n24"><mml:mrow><mml:mi>S</mml:mi><mml:mi>e</mml:mi><mml:mi>n</mml:mi><mml:mi>s</mml:mi><mml:mi>i</mml:mi><mml:mi>t</mml:mi><mml:mi>i</mml:mi><mml:mi>v</mml:mi><mml:mi>i</mml:mi><mml:mi>t</mml:mi><mml:mi>y</mml:mi><mml:mo>=</mml:mo><mml:mi>T</mml:mi><mml:mi>P</mml:mi><mml:mo>/</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>T</mml:mi><mml:mi>P</mml:mi><mml:mo>+</mml:mo><mml:mi>F</mml:mi><mml:mi>N</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>. Positive predictive value is defined as the portion of true sequences among assembled sequences, i.e., <inline-formula><mml:math id="n25"><mml:mrow><mml:mi>P</mml:mi><mml:mi>P</mml:mi><mml:mi>V</mml:mi><mml:mo>=</mml:mo><mml:mi>T</mml:mi><mml:mi>P</mml:mi><mml:mo>/</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>T</mml:mi><mml:mi>P</mml:mi><mml:mo>+</mml:mo><mml:mi>F</mml:mi><mml:mi>P</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>. Additionally, we evaluate ability of our method to estimate population size (i.e. number of viral genomes in the population). Accuracy of population size prediction is defined as a ratio between estimated and true population sizes. Finally, we use Jensen–Shannon divergence (JSD) to measure the accuracy of frequency estimation. Given two probability distributions, JSD measures the ‘distance’ between them, or in other words, the quality of approximation of one probability distribution by the other distribution. It is defined as the Kullback–Leibler divergence from distributions <italic>P</italic> and <italic>Q</italic> to their mixture. Formally, the JSD between true distribution <italic>P</italic> and approximation distribution <italic>Q</italic> is given by the formula
<disp-formula><mml:math id="n26"><mml:mrow><mml:mtext>JSD</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mi>P</mml:mi><mml:mo stretchy="false">|</mml:mo><mml:mo stretchy="false">|</mml:mo><mml:mi>Q</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac><mml:msub><mml:mtext>D</mml:mtext><mml:mrow><mml:mi>K</mml:mi><mml:mi>L</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>P</mml:mi><mml:mo stretchy="false">|</mml:mo><mml:mo stretchy="false">|</mml:mo><mml:mi>M</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac><mml:msub><mml:mtext>D</mml:mtext><mml:mrow><mml:mi>K</mml:mi><mml:mi>L</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>Q</mml:mi><mml:mo stretchy="false">|</mml:mo><mml:mo stretchy="false">|</mml:mo><mml:mi>M</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></disp-formula>
where Kullback–Leibler divergence <inline-formula><mml:math id="n27"><mml:mrow><mml:msub><mml:mtext>D</mml:mtext><mml:mrow><mml:mi>K</mml:mi><mml:mi>L</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> is
<disp-formula><mml:math id="n28"><mml:mrow><mml:msub><mml:mtext>D</mml:mtext><mml:mrow><mml:mi>K</mml:mi><mml:mi>L</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>P</mml:mi><mml:mo stretchy="false">|</mml:mo><mml:mo stretchy="false">|</mml:mo><mml:mi>Q</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mstyle displaystyle="true"><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>n</mml:mi></mml:munderover><mml:mi>P</mml:mi></mml:mstyle><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mi>log</mml:mi><mml:mo>⁡</mml:mo><mml:mfrac><mml:mrow><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mi>Q</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfrac></mml:mrow></mml:math></disp-formula>
and <inline-formula><mml:math id="n29"><mml:mrow><mml:mi>M</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac><mml:mo stretchy="false">(</mml:mo><mml:mi>P</mml:mi><mml:mo>+</mml:mo><mml:mi>Q</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>. The motivation for using JSD is a consequence of KL divergence being undefined when assembly methods fail to reconstruct some variant <italic>i</italic>, hence forcing <italic>Q</italic>(<italic>i</italic>) to be 0. JSD averts this by measuring the distance to the mixture, which contains all true and called variants (TP and FP).</p>
      <p>Our first simulated study compares the assembly accuracy across different virus species. We focus on effect of read-length and throughput on assembly quality for different types of viruses. Paired-end reads of various length corresponding to high-fidelity and regular sequencing protocols are simulated from HIV and HCV populations assuming uniform and power-law distributions. A power-law distribution (i.e. frequency of an individual viral genome is a power of the previous one) corresponds to a population with several dominant variants and many rare variants. The uniform distribution has equal frequencies for all viral genomes. HCV population is presented by 1739-bp-long fragment from the E1E2 region of 44 real HCV sequences. HIV population consist of 10 real intra-host viral variants mixture from 1.3-kb-long HIV-1 region, which included pol protease and part of the pol reverse transcriptase (<xref rid="btu295-B31" ref-type="bibr">Zagordi <italic>et al.</italic>, 2010</xref>).</p>
      <p>The genomic architecture across virus species was investigated and its influence on assembly accuracy was studied. HCV virus exhibits more complex genomic architecture with lower population diversity and longer conserved regions (<xref ref-type="fig" rid="btu295-F3">Fig. 3</xref>) than HIV. Conserved regions were present in both viruses, although only HCV contains conserved regions longer then 450 bp. Conserved regions longer then the average fragment length (450 bp) may introduce ambiguity in the assembly process due to a lack of direct evidence of sub-genomes phasing across the conserved region. We performed simulated sequencing experiment where the average fragment amplification rate is 5, resulting in a five time decrease in throughput due to the consensus error correction performed by the high-fidelity sequencing protocol. Also the simulation experiments were adjusted to simulate a non-uniform amplification rate. Non-uniform amplification rate results in discarding fragments with insufficient amplification rate (&lt;3). From real studies it is known that around 10% of fragments are amplified less than three times. Sequencing errors produced by the regular protocol limited the ability of VGA to accurately assemble a viral population. All assembled variants contained large number of mismatches, additionally VGA significantly overestimated population size.
<fig id="btu295-F3" position="float"><label>Fig. 3.</label><caption><p>Genomic architecture of 44 real HCV viral genomes from 1739-bp-long fragment of E1E2 region. Length of longest common region shared between any two viral genomes is represented by color</p></caption><graphic xlink:href="btu295f3"/></fig></p>
      <p>As expected, short read lengths dramatically inhibit reconstruction, which is evidenced by VGA failing to produce any full-length genomes when given 2 × 36 bp reads (<xref ref-type="fig" rid="btu295-F4">Fig. 4</xref>). Because common regions for distinct HCV viral genomes are significantly longer than for HIV, it is not surprising that performance of VGA is worse on HCV data—for 3 M 2 × 150 bp reads simulated from 44 1739-bp-long viral genomes, sensitivity is 50%, PPV is 80%. Results on HCV data confirm that the lower mutation rate and presence of conserved regions have a negative impact on the ability to accurately reconstruct individual viral genomes. Surprisingly, increasing the read length for HIV from 100 to 150 bp yields no benefits for reconstruction accuracy suggesting that 100 bp read length is enough to distinguish between HIV viral variants with high mutation rate. Although further experiments are needed to determine optimum read length, our simulations suggest that 2 × 100 bp is recommended for small HIV viral populations and 2 × 150 bp is recommended for medium HCV population with complex genomic architecture.
<fig id="btu295-F4" position="float"><label>Fig. 4.</label><caption><p>Accuracy of population size prediction. Up to 200 viral genomes were generated from the Gag/Pol 3.4 kb HIV region. The population diversity is 5–10%. Viral genome abundances follow power-law and uniform distributions. Consensus error-corrected 1002 bp paired-end reads were simulated from HIV population</p></caption><graphic xlink:href="btu295f4"/></fig></p>
      <p>We separately analyzed the ability of our method to estimate the viral population size (i.e. number of genomic variants present in the population). Non-continuous coverage limits the ability of the method to assemble full-length viral variants. To evaluate the accuracy of population size estimation, we compared the true population size known from simulated data with estimated results. Continuous coverage of each individual viral genome present in the sample has a strong impact on quality of population assembly. The probability of non-continuous coverage increases dramatically for viral genomes with low abundance. Thus, the presence of coverage gaps for rare variants introduces additional challenges in the assembly process, making rare genomes unreachable by assembly tools. The number of problematic genomes can be reduced by increasing sequencing depth; however, it does not guarantee complete elimination. While complete assembly of all such genomes is unrealistic, it is still possible to estimate the number of viral genomes present in the sample (population size). The number of independent sets reported by VGA provides us with an accurate population size estimation. Intuitively, predicting the population size of a large viral population with many rare variants is more difficult than predicting for uniformly distributed or small populations (<xref ref-type="fig" rid="btu295-F5">Fig. 5</xref>). The predicted population size may serve as an indication of insufficient coverage to detect the full viral diversity present in the sample.
<fig id="btu295-F5" position="float"><label>Fig. 5.</label><caption><p>Assembly accuracy estimation. Up to 200 viral genomes were generated from the Gag/Pol 3.4 kb HIV region. The population diversity is 3–20%. Viral genome abundances follow power-law and uniform distributions. Consensus error-corrected 2100 bp paired-end reads were simulated from HIV population</p></caption><graphic xlink:href="btu295f5"/></fig></p>
      <p>Deep coverage is a key for accurate estimation of underlying viral diversity. One such platform capable of offering millions of sequencing reads is Illumina HiSeq. The relatively short length of the produced reads is compensated for by sequencing the same fragment from both ends; therefore, producing coupled reads separated by a ‘gap’, known as paired-end read. To our knowledge, VGA is the first method scalable to millions of short paired-end sequencing reads able to produce full-length viral variants spanning the entire viral genome. We explore the influence of sequencing depth on the reconstruction accuracy for varying population structures (uniform and power-law distributions of viral genomes within the population). HIV-1 is known to have greater genetic variability than any other known virus (<xref rid="btu295-B21" ref-type="bibr">Ndungu and Weiss, 2012</xref>). The diversity among viral genomes in an HIV population can vary from 3 to 20% depending on regions (<xref rid="btu295-B18" ref-type="bibr">Martins <italic>et al.</italic>, 1992</xref>; <xref rid="btu295-B29" ref-type="bibr">Yoshimura <italic>et al.</italic>, 1996</xref>). Heterogeneous viral samples were prepared by generating viral populations from the Gag/Pol 3.4 kb HIV region. We simulated variant abundances adhering to either a uniform or power-law distribution. Not surprisingly, our simulations suggest that increased sequencing depth has a direct positive effect on the discovery of rare variants and improves the overall assembly accuracy. <xref ref-type="fig" rid="btu295-F6">Figure 6</xref> shows the effect of coverage and population size on assembly for reads of length 100 bp. Throughout all experiments, VGA maintained a PPV value of 100%.
<fig id="btu295-F6" position="float"><label>Fig. 6.</label><caption><p>Assembly accuracy estimation. Up to 200 viral genomes were generated from the Gag/Pol 3.4 kb HIV region. The population diversity is 3–20%. Viral genome abundances follow power-law and uniform distributions. Consensus error-corrected 2 × 100 bp paired-end reads were simulated from HIV population</p></caption><graphic xlink:href="btu295f6"/></fig></p>
      <p>In addition to point mutations, genetic recombination facilitates rapid evolution and production of diverse HIV genomes. Indeed, co-infected cells may produce recombinant viral progeny at levels lower than mutation rates in an intra-patient environment (<xref rid="btu295-B22" ref-type="bibr">Neher and Leitner, 2010</xref>). Hence, simulated datasets must account for both possible phenomena when determining the quality of assembly. We utilize a simulation model able to integrate both point mutations and recombination in the generated viral population depending on the amount of diversity required. A mixture of 10 real intra-host viral variants from 1.3-kb-long HIV-1 form the basis population. In addition to point mutations, our simulation model implicitly produces recombinant genomes by first constructing the genotype (i.e. sequence of SNVs) for the population. A random walk is performed over this genotype as specified number of times. Any cross-over that occurs represents a new recombination between the ‘left’ and ‘right’ original genomes. Recombinations are implicitly produced, and no control is imposed over number and length of the recombination. This model produces highly recombinant data on average, posing challenges for assembly and can be used to assess assembly quality. Simulation model incorporate mutation into the process by selecting a position and nucleotide-swap uniformly at random. Simulation results (<xref ref-type="fig" rid="btu295-F7">Fig. 7</xref>) suggest that our method can accurately assemble viral population in presence of recombinations and point mutations, maintaining PPV of 100%.
<fig id="btu295-F7" position="float"><label>Fig. 7.</label><caption><p>Assembly accuracy estimation. Consensus error-corrected paired-end reads of various lengths were simulated from a mixture of 10 real viral clones from 1.3-kb-long HIV-1 region. Assembly accuracy as measured by PPV and sensitivity. Results are for 50 000 reads, no improvement was observed when increasing the number of reads</p></caption><graphic xlink:href="btu295f7"/></fig></p>
      <p>Finally, we evaluate population quantification accuracy, i.e. the accuracy of our method in predicting abundances of the assembled variants. Taking the results from VGA on 10 real HIV clones with 50 000 reads and 2 × 100 bp, the JSD was 2.93e-05 for the Power-law and 0.001 for the Uniform-based populations. This already small measure only decreases as the size of the input grows.</p>
    </sec>
    <sec id="SEC3.2">
      <title>3.2 Performance of existing viral assemblers on simulated consensus error-corrected reads</title>
      <p>We have evaluated the performance of ShoRAH (<xref rid="btu295-B30" ref-type="bibr">Zagordi <italic>et al.</italic>, 2011</xref>) and QuasiRecomb (<xref rid="btu295-B32" ref-type="bibr">Zagordi <italic>et al.</italic>, 2012</xref>) for simulated consensus error-corrected read data.</p>
      <p>ShoRAH disregards pairing information of reads, but it is scalable enough to handle up to 1 M reads. ShoRAH fails to produce full-length viral genome but reliably spans 98% of the consensus genome. It reasonably estimates the number of different viral genome, but even the most accurate ShoRAH-assembled viral genome differs from the closest true 1.3-kb-long viral genome in five nucleotides.</p>
      <p>QuasiRecomb is designed to handle paired-end read data and manages to produce full-length viral genomes. Unfortunately it can reliably process no more than 100 K reads. Also the number of assembled distinct viral genomes is 10–200 times more than the number of true distinct viral genomes. The most accurate QuasiRecomb-assembled viral genome still differs from the closest true 1.3-kb-long viral genome in four nucleotides.</p>
      <p>Unfortunately we could not compare our method with QColors (<xref rid="btu295-B10" ref-type="bibr">Huang <italic>et al.</italic>, 2011</xref>) assembly algorithm, which uses a similar conflict graph to represent viral population. A CSP solver is used by QColors for coloring the graph which may limit its scalability to high-throughput datasets consisting of millions of sequencing reads. Currently, QColors is not publicly available (Upon querying for information on obtaining QColors, the authors were informed that the original software was tightly coupled for the analyses done in its original manuscript, and is not currently available for general use.).</p>
    </sec>
    <sec id="SEC3.3">
      <title>3.3 Performance of VGA on real HIV data</title>
      <p>To further test the ability of VGA to accurately assemble a diverse natural occurring population and predict variant abundance levels, we used an Illumina HiSeq HIV dataset, which consisted of 15 M 2 × 100 bp paired-end reads with attached barcodes. Next, the high-fidelity sequencing protocol able to eliminate sequencing errors was applied resulting in 3.2 M consensus error-corrected reads (further referred to as reads). The reads were then used to build <italic>de novo</italic> population consensus using Vicuna 1.3 (<xref rid="btu295-B28" ref-type="bibr">Yang <italic>et al.</italic>, 2012</xref>). When run on our real data, Vicuna produced four contigs of average length 1195 bp. Each contig was then run through BLAST to check for overlaps. Once overlaps were found, the contigs were assembled into a final consensus of length 4337 bp.</p>
      <p><bold>Validation of <italic>de novo</italic> consensus</bold>. A <italic>de novo</italic> assembled consensus was compared against reference-based consensus. To produce reference-based consensus, we iteratively map reads onto the HIV reference (Gag/Pol 3.4 kb HIV region) using InDelFixer. InDelFixer iteratively changes the reference genome based on the mapping of the current iteration. Also, we used InDelFixer in single iteration mode to map reads onto the constructed <italic>de novo</italic> consensus. <italic>De novo</italic> consensus is longer (4337 bp) than the reference-based consensus (3440 bp) and contained two regions with extremely peaked coverage compared with the surrounding regions. Both regions were considered to be the result of technical artifacts and removed from further consideration. After removing both regions, the length of new <italic>de novo</italic> consensus becomes 3452 bp. We also filtered reads that belonged to regions with extreme coverage. Finally we compared the number of reads mapped to the reference-based consensus versus the <italic>de novo</italic> consensus. A larger amount of reads mapped to the assembled consensus, thereby highlighting the advantage of <italic>de novo</italic> procedure for consensus construction over a reference-based.</p>
      <p>From the <italic>de novo</italic> consensus, VGA assembled 32 full-length viral genomes that differ from each other in 2145 SNVs. Among known HIV sequences, Gag/Pol is the closest to the <italic>de novo</italic> consensus. Each of the 32 full-length viral genomes do not contain stop codons inside two known coding regions of Gag/Pol of length 1520 and 1820 bp, respectively. Alternatively, when VGA is applied to all 15 M original uncorrected reads, 57 distinct viral genomes are assembled among which 36 contain stop codons in the two coding regions. This shows that a regular sequencing protocol is unsuitable for viral genome reconstruction.</p>
    </sec>
  </sec>
  <sec>
    <title>4 DISCUSSION</title>
    <p>We have presented VGA, an accurate method for viral population assembly from ultra-deep sequencing data. The proposed algorithm is coupled with a high-fidelity sequencing protocol able to eliminate errors from sequencing data. Deep coverage in combination with highly accurate data allows our method to accurately estimate the underlying diversity of a viral population. In particular, it makes possible to distinguish true biological mutations from sequencing errors, facilitating assembly of rare individual genomes. Our method condenses the viral population into a conflict graph built from aligned reads. To distinguish between viral variants, the conflict graph is colored into a minimal set of colors. Each color represents individual viral genomes composed from the set of non-conflicting reads. An expectation-maximization algorithm was used to estimate relative abundance frequencies of assembled viral genomes.</p>
    <p>To our knowledge, our method is the first viral assembly method that scales to millions of paired-end sequencing reads. Experiments on both real and synthetic HIV datasets generated with various sequencing parameters and distribution assumptions suggest that VGA is able to assemble diverse viral population from millions of paired-end reads. The ability of our method to maintain 100% assembly accuracy makes it suitable for clinical applications. In addition, the constant increase of sequencing depth offered by high-throughput technologies provide us with unprecedented resolution promising to increase number of discovered ultra-rare viral variants in the population.</p>
  </sec>
</body>
<back>
  <ack>
    <title>ACKNOWLEDGEMENTS</title>
    <p>The authors thank three anonymous reviewers for helpful comments, UCLA Clinical Microarray Core for performing the high-throughput sequencing experiment.</p>
    <p><italic>Funding</italic>: S.M. and E.E. are supported by <funding-source>National Science Foundation</funding-source> grants <award-id>0513612</award-id>, <award-id>0731455</award-id>, <award-id>0729049</award-id>, <award-id>0916676</award-id>, <award-id>1065276</award-id>, <award-id>1302448</award-id> and <award-id>1320589</award-id>, and <funding-source>National Institutes of Health</funding-source> grants <award-id>K25-HL080079</award-id>, <award-id>U01-DA024417</award-id>, <award-id>P01- HL30568</award-id>, <award-id>P01-HL28481</award-id>, <award-id>R01-GM083198</award-id>, <award-id>R01-MH101782</award-id> and <award-id>R01-ES022282</award-id>. S.M. was supported in part by Institute for Quantitative &amp; Computational Biosciences Fellowship, UCLA. N.C.W. was supported by Molecular Biology Whitcome Pre- Doctoral Fellowship, UCLA. A.Z. was partially supported by <funding-source>Agriculture and Food Research Initiative Competitive</funding-source> Grant no. <award-id>201167016-30331</award-id> from the <funding-source>USDA National Institute of Food and Agriculture and NSF</funding-source> award <award-id>IIS-0916401</award-id>. N.M. was partially supported by <funding-source>Second Century Initiative, Georgia State University</funding-source>.</p>
    <p><italic>Conflict of Interest</italic>: none declared.</p>
  </ack>
  <ref-list>
    <title>REFERENCES</title>
    <ref id="btu295-B1">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Angly</surname>
            <given-names>FE</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Grinder: a versatile amplicon and shotgun sequence simulator</article-title>
        <source>Nucleic Acids Res.</source>
        <year>2012</year>
        <volume>40</volume>
        <fpage>e94</fpage>
        <lpage>e94</lpage>
        <pub-id pub-id-type="pmid">22434876</pub-id>
      </element-citation>
    </ref>
    <ref id="btu295-B2">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Armin, </surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Beerenwinkel</surname>
            <given-names>N</given-names>
          </name>
        </person-group>
        <year>2013</year>
        <comment>
          <ext-link ext-link-type="uri" xlink:href="http://www.bsse.ethz.ch/cbg/software/InDelFixer">http://www.bsse.ethz.ch/cbg/software/InDelFixer</ext-link>
        </comment>
      </element-citation>
    </ref>
    <ref id="btu295-B3">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Astrovskaya</surname>
            <given-names>I</given-names>
          </name>
        </person-group>
        <article-title>Inferring viral quasispecies spectra from 454 pyrosequencing reads</article-title>
        <source>BMC Bioinformatics</source>
        <year>2011</year>
        <volume>12</volume>
        <issue>Suppl. 6</issue>
        <fpage>S1</fpage>
        <pub-id pub-id-type="pmid">21989211</pub-id>
      </element-citation>
    </ref>
    <ref id="btu295-B4">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bansal</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Bafna</surname>
            <given-names>V</given-names>
          </name>
        </person-group>
        <article-title>HapCUT: an efficient and accurate algorithm for the haplotype assembly problem</article-title>
        <source>Bioinformatics</source>
        <year>2008</year>
        <volume>24</volume>
        <fpage>i153</fpage>
        <lpage>i159</lpage>
        <pub-id pub-id-type="pmid">18689818</pub-id>
      </element-citation>
    </ref>
    <ref id="btu295-B5">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Duitama</surname>
            <given-names>J</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Fosmid-based whole genome haplotyping of a hapmap trio child: evaluation of single individual haplotyping techniques</article-title>
        <source>Nucleic Acids Res.</source>
        <year>2012</year>
        <volume>40</volume>
        <fpage>2041</fpage>
        <lpage>2053</lpage>
        <pub-id pub-id-type="pmid">22102577</pub-id>
      </element-citation>
    </ref>
    <ref id="btu295-B6">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Eriksson</surname>
            <given-names>N</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Viral population estimation using pyrosequencing</article-title>
        <source>PLoS Comput. Biol.</source>
        <year>2008</year>
        <volume>4</volume>
        <fpage>e1000074</fpage>
        <pub-id pub-id-type="pmid">18437230</pub-id>
      </element-citation>
    </ref>
    <ref id="btu295-B7">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Gnerre</surname>
            <given-names>S</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>High-quality draft assemblies of mammalian genomes from massively parallel sequence data</article-title>
        <source>Proc. Natl Acad. Sci. USA</source>
        <year>2011</year>
        <volume>108</volume>
        <fpage>1513</fpage>
        <lpage>1518</lpage>
        <pub-id pub-id-type="pmid">21187386</pub-id>
      </element-citation>
    </ref>
    <ref id="btu295-B8">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Henn</surname>
            <given-names>MR</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Whole genome deep sequencing of HIV-1 reveals the impact of early minor variants upon immune recognition during acute infection</article-title>
        <source>PLoS Pathog.</source>
        <year>2012</year>
        <volume>8</volume>
        <fpage>e1002529</fpage>
        <pub-id pub-id-type="pmid">22412369</pub-id>
      </element-citation>
    </ref>
    <ref id="btu295-B9">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hormozdiari</surname>
            <given-names>F</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Combinatorial algorithms for structural variation detection in high-throughput sequenced genomes</article-title>
        <source>Genome Res.</source>
        <year>2009</year>
        <volume>19</volume>
        <fpage>1270</fpage>
        <lpage>1278</lpage>
        <pub-id pub-id-type="pmid">19447966</pub-id>
      </element-citation>
    </ref>
    <ref id="btu295-B10">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Huang</surname>
            <given-names>A</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>QColors: an algorithm for conservative viral quasispecies reconstruction from short and non-contiguous next generation sequencing reads</article-title>
        <source>In Silico Biol.</source>
        <year>2011</year>
        <volume>11</volume>
        <fpage>193</fpage>
        <lpage>201</lpage>
        <pub-id pub-id-type="pmid">23202421</pub-id>
      </element-citation>
    </ref>
    <ref id="btu295-B11">
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Johnson</surname>
            <given-names>DS</given-names>
          </name>
          <name>
            <surname>Trick</surname>
            <given-names>MA</given-names>
          </name>
        </person-group>
        <source>Cliques, Coloring, and Satisfiability: Second DIMACS Implementation Challenge, October 11-13, 1993</source>
        <year>1996</year>
        <volume>Vol. 26</volume>
        <publisher-name>American Mathematical Society, USA</publisher-name>
      </element-citation>
    </ref>
    <ref id="btu295-B12">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kinde</surname>
            <given-names>I</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Detection and quantification of rare mutations with massively parallel sequencing</article-title>
        <source>Proc. Natl Acad. Sci. USA</source>
        <year>2011</year>
        <volume>108</volume>
        <fpage>9530</fpage>
        <lpage>9535</lpage>
        <pub-id pub-id-type="pmid">21586637</pub-id>
      </element-citation>
    </ref>
    <ref id="btu295-B13">
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Kubale</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <source>Graph Colorings</source>
        <year>2004</year>
        <volume>Vol. 352</volume>
        <publisher-name>American Mathematical Society, USA</publisher-name>
      </element-citation>
    </ref>
    <ref id="btu295-B14">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lauring</surname>
            <given-names>AS</given-names>
          </name>
          <name>
            <surname>Andino</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>Quasispecies theory and the behavior of RNA viruses</article-title>
        <source>PLoS Pathog.</source>
        <year>2010</year>
        <volume>6</volume>
        <fpage>e1001005</fpage>
        <pub-id pub-id-type="pmid">20661479</pub-id>
      </element-citation>
    </ref>
    <ref id="btu295-B15">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Liu</surname>
            <given-names>J</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Analysis of low-frequency mutations associated with drug resistance to raltegravir before antiretroviral treatment</article-title>
        <source>Antimicrob. Agents Chemother.</source>
        <year>2011</year>
        <volume>55</volume>
        <fpage>1114</fpage>
        <lpage>1119</lpage>
        <pub-id pub-id-type="pmid">21173185</pub-id>
      </element-citation>
    </ref>
    <ref id="btu295-B16">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Luo</surname>
            <given-names>R</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>SOAPdenovo2: an empirically improved memory-efficient short-read <italic>de novo</italic> assembler</article-title>
        <source>Gigascience</source>
        <year>2012</year>
        <volume>1</volume>
        <fpage>18</fpage>
        <pub-id pub-id-type="pmid">23587118</pub-id>
      </element-citation>
    </ref>
    <ref id="btu295-B17">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Mancuso</surname>
            <given-names>N</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Reconstructing viral quasispecies from NGS amplicon reads</article-title>
        <source>In Silico Biol.</source>
        <year>2011</year>
        <volume>11</volume>
        <fpage>237</fpage>
        <lpage>249</lpage>
        <pub-id pub-id-type="pmid">23202425</pub-id>
      </element-citation>
    </ref>
    <ref id="btu295-B18">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Martins</surname>
            <given-names>LP</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Complex intrapatient sequence variation in the V1 and V2 hypervariable regions of the HIV-1 gp120 envelope sequence</article-title>
        <source>Virology</source>
        <year>1992</year>
        <volume>191</volume>
        <fpage>837</fpage>
        <lpage>845</lpage>
        <pub-id pub-id-type="pmid">1448927</pub-id>
      </element-citation>
    </ref>
    <ref id="btu295-B19">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Metzker</surname>
            <given-names>ML</given-names>
          </name>
        </person-group>
        <article-title>Sequencing technologiesthe next generation</article-title>
        <source>Nat. Rev. Genet.</source>
        <year>2009</year>
        <volume>11</volume>
        <fpage>31</fpage>
        <lpage>46</lpage>
        <pub-id pub-id-type="pmid">19997069</pub-id>
      </element-citation>
    </ref>
    <ref id="btu295-B20">
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Mitzenmacher</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Eli</surname>
            <given-names>U</given-names>
          </name>
        </person-group>
        <source>Probability and Computing: Randomized Algorithms and Probabilistic Analysis</source>
        <year>2005</year>
        <publisher-loc>Cambridge</publisher-loc>
        <publisher-name>Cambridge University Press</publisher-name>
      </element-citation>
    </ref>
    <ref id="btu295-B21">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ndungu</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Weiss</surname>
            <given-names>RA</given-names>
          </name>
        </person-group>
        <article-title>On HIV diversity</article-title>
        <source>AIDS</source>
        <year>2012</year>
        <volume>26</volume>
        <fpage>1255</fpage>
        <lpage>1260</lpage>
        <pub-id pub-id-type="pmid">22706010</pub-id>
      </element-citation>
    </ref>
    <ref id="btu295-B22">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Neher</surname>
            <given-names>RA</given-names>
          </name>
          <name>
            <surname>Leitner</surname>
            <given-names>T</given-names>
          </name>
        </person-group>
        <article-title>Recombination rate and selection strength in hiv intra-patient evolution</article-title>
        <source>PLoS Comput. Biol.</source>
        <year>2010</year>
        <volume>6</volume>
        <fpage>e1000660</fpage>
        <pub-id pub-id-type="pmid">20126527</pub-id>
      </element-citation>
    </ref>
    <ref id="btu295-B23">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Palmer</surname>
            <given-names>S</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Selection and persistence of non-nucleoside reverse transcriptase inhibitor-resistant HIV-1 in patients starting and stopping non-nucleoside therapy</article-title>
        <source>AIDS</source>
        <year>2006</year>
        <volume>20</volume>
        <fpage>701</fpage>
        <lpage>710</lpage>
        <pub-id pub-id-type="pmid">16514300</pub-id>
      </element-citation>
    </ref>
    <ref id="btu295-B24">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Prosperi</surname>
            <given-names>MC</given-names>
          </name>
          <name>
            <surname>Salemi</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>QuRe: software for viral quasispecies reconstruction from next-generation sequencing data</article-title>
        <source>Bioinformatics</source>
        <year>2012</year>
        <volume>28</volume>
        <fpage>132</fpage>
        <lpage>133</lpage>
        <pub-id pub-id-type="pmid">22088846</pub-id>
      </element-citation>
    </ref>
    <ref id="btu295-B25">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Tsibris</surname>
            <given-names>AM</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Quantitative deep sequencing reveals dynamic HIV-1 escape and large population shifts during CCR5 antagonist therapy <italic>in vivo</italic></article-title>
        <source>PLoS One</source>
        <year>2009</year>
        <volume>4</volume>
        <fpage>e5683</fpage>
        <pub-id pub-id-type="pmid">19479085</pub-id>
      </element-citation>
    </ref>
    <ref id="btu295-B26">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wang</surname>
            <given-names>C</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Characterization of mutation spectra with ultra-deep pyrosequencing: application to HIV-1 drug resistance</article-title>
        <source>Genome Res.</source>
        <year>2007</year>
        <volume>17</volume>
        <fpage>1195</fpage>
        <lpage>1201</lpage>
        <pub-id pub-id-type="pmid">17600086</pub-id>
      </element-citation>
    </ref>
    <ref id="btu295-B27">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Yang</surname>
            <given-names>W-Y</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Leveraging multi-SNP reads from sequencing data for haplotype inference</article-title>
        <source>Bioinformatics</source>
        <year>2013</year>
        <volume>29</volume>
        <fpage>2245</fpage>
        <lpage>2252</lpage>
        <pub-id pub-id-type="pmid">23825370</pub-id>
      </element-citation>
    </ref>
    <ref id="btu295-B28">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Yang</surname>
            <given-names>X</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title><italic>De novo</italic> assembly of highly diverse viral populations</article-title>
        <source>BMC Genomics</source>
        <year>2012</year>
        <volume>13</volume>
        <fpage>475</fpage>
        <pub-id pub-id-type="pmid">22974120</pub-id>
      </element-citation>
    </ref>
    <ref id="btu295-B29">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Yoshimura</surname>
            <given-names>FK</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Intrapatient sequence variation of the gag gene of human immunodeficiency virus type 1 plasma virions</article-title>
        <source>J. Virol.</source>
        <year>1996</year>
        <volume>70</volume>
        <fpage>8879</fpage>
        <lpage>8887</lpage>
        <pub-id pub-id-type="pmid">8971017</pub-id>
      </element-citation>
    </ref>
    <ref id="btu295-B30">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zagordi</surname>
            <given-names>O</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>ShoRAH: estimating the genetic diversity of a mixed sample from next-generation sequencing data</article-title>
        <source>BMC Bioinformatics</source>
        <year>2011</year>
        <volume>12</volume>
        <fpage>119</fpage>
        <pub-id pub-id-type="pmid">21521499</pub-id>
      </element-citation>
    </ref>
    <ref id="btu295-B31">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zagordi</surname>
            <given-names>O</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Deep sequencing of a genetically heterogeneous sample: local haplotype reconstruction and read error correction</article-title>
        <source>J. Comput. Biol.</source>
        <year>2010</year>
        <volume>17</volume>
        <fpage>417</fpage>
        <lpage>428</lpage>
        <pub-id pub-id-type="pmid">20377454</pub-id>
      </element-citation>
    </ref>
    <ref id="btu295-B32">
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Zagordi</surname>
            <given-names>O</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Probabilistic inference of viral quasispecies subject to recombination</article-title>
        <source>Research in Computational Molecular Biology</source>
        <year>2012</year>
        <publisher-name>Springer Berlin Heidelberg</publisher-name>
        <fpage>342</fpage>
        <lpage>354</lpage>
      </element-citation>
    </ref>
    <ref id="btu295-B33">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zerbino</surname>
            <given-names>DR</given-names>
          </name>
          <name>
            <surname>Birney</surname>
            <given-names>E</given-names>
          </name>
        </person-group>
        <article-title>Velvet: algorithms for <italic>de novo</italic> short read assembly using de Bruijn graphs</article-title>
        <source>Genome Res.</source>
        <year>2008</year>
        <volume>18</volume>
        <fpage>821</fpage>
        <lpage>829</lpage>
        <pub-id pub-id-type="pmid">18349386</pub-id>
      </element-citation>
    </ref>
  </ref-list>
</back>
