<?properties open_access?>
<?subarticle pcbi.1008249.r001?>
<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.1d3 20150301//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 39.96?>
<?ConverterInfo.XSLTName jp2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">PLoS Comput Biol</journal-id>
    <journal-id journal-id-type="iso-abbrev">PLoS Comput Biol</journal-id>
    <journal-id journal-id-type="publisher-id">plos</journal-id>
    <journal-id journal-id-type="pmc">ploscomp</journal-id>
    <journal-title-group>
      <journal-title>PLoS Computational Biology</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1553-734X</issn>
    <issn pub-type="epub">1553-7358</issn>
    <publisher>
      <publisher-name>Public Library of Science</publisher-name>
      <publisher-loc>San Francisco, CA USA</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">7595628</article-id>
    <article-id pub-id-type="pmid">33075044</article-id>
    <article-id pub-id-type="publisher-id">PCOMPBIOL-D-20-00375</article-id>
    <article-id pub-id-type="doi">10.1371/journal.pcbi.1008249</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Research Article</subject>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Cell Biology</subject>
          <subj-group>
            <subject>Cellular Types</subject>
            <subj-group>
              <subject>Animal Cells</subject>
              <subj-group>
                <subject>Blood Cells</subject>
                <subj-group>
                  <subject>Red Blood Cells</subject>
                </subj-group>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Physical Sciences</subject>
        <subj-group>
          <subject>Materials Science</subject>
          <subj-group>
            <subject>Material Properties</subject>
            <subj-group>
              <subject>Elasticity</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Physical Sciences</subject>
        <subj-group>
          <subject>Physics</subject>
          <subj-group>
            <subject>Classical Mechanics</subject>
            <subj-group>
              <subject>Continuum Mechanics</subject>
              <subj-group>
                <subject>Fluid Mechanics</subject>
                <subj-group>
                  <subject>Fluid Dynamics</subject>
                  <subj-group>
                    <subject>Fluid Flow</subject>
                  </subj-group>
                </subj-group>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Cell Biology</subject>
          <subj-group>
            <subject>Cellular Structures and Organelles</subject>
            <subj-group>
              <subject>Cell Membranes</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Anatomy</subject>
          <subj-group>
            <subject>Body Fluids</subject>
            <subj-group>
              <subject>Blood</subject>
              <subj-group>
                <subject>Blood Flow</subject>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Medicine and Health Sciences</subject>
        <subj-group>
          <subject>Anatomy</subject>
          <subj-group>
            <subject>Body Fluids</subject>
            <subj-group>
              <subject>Blood</subject>
              <subj-group>
                <subject>Blood Flow</subject>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Physiology</subject>
          <subj-group>
            <subject>Body Fluids</subject>
            <subj-group>
              <subject>Blood</subject>
              <subj-group>
                <subject>Blood Flow</subject>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Physiology</subject>
          <subj-group>
            <subject>Electrophysiology</subject>
            <subj-group>
              <subject>Membrane Potential</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Engineering and Technology</subject>
        <subj-group>
          <subject>Fluidics</subject>
          <subj-group>
            <subject>Microfluidics</subject>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Physical Sciences</subject>
        <subj-group>
          <subject>Physics</subject>
          <subj-group>
            <subject>States of Matter</subject>
            <subj-group>
              <subject>Fluids</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>PyOIF: Computational tool for modelling of multi-cell flows in complex geometries</article-title>
      <alt-title alt-title-type="running-head">PyOIF: Computational tool for modelling of multi-cell flows</alt-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0002-0928-6354</contrib-id>
        <name>
          <surname>Jančigová</surname>
          <given-names>Iveta</given-names>
        </name>
        <role content-type="https://casrai.org/credit/">Conceptualization</role>
        <role content-type="https://casrai.org/credit/">Investigation</role>
        <role content-type="https://casrai.org/credit/">Methodology</role>
        <role content-type="https://casrai.org/credit/">Software</role>
        <role content-type="https://casrai.org/credit/">Validation</role>
        <role content-type="https://casrai.org/credit/">Visualization</role>
        <role content-type="https://casrai.org/credit/">Writing – original draft</role>
        <role content-type="https://casrai.org/credit/">Writing – review &amp; editing</role>
        <xref ref-type="aff" rid="aff001">
          <sup>1</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0002-1308-0068</contrib-id>
        <name>
          <surname>Kovalčíková</surname>
          <given-names>Kristína</given-names>
        </name>
        <role content-type="https://casrai.org/credit/">Investigation</role>
        <role content-type="https://casrai.org/credit/">Methodology</role>
        <role content-type="https://casrai.org/credit/">Validation</role>
        <role content-type="https://casrai.org/credit/">Writing – original draft</role>
        <role content-type="https://casrai.org/credit/">Writing – review &amp; editing</role>
        <xref ref-type="aff" rid="aff001">
          <sup>1</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0003-1128-2093</contrib-id>
        <name>
          <surname>Weeber</surname>
          <given-names>Rudolf</given-names>
        </name>
        <role content-type="https://casrai.org/credit/">Conceptualization</role>
        <role content-type="https://casrai.org/credit/">Formal analysis</role>
        <role content-type="https://casrai.org/credit/">Writing – review &amp; editing</role>
        <xref ref-type="aff" rid="aff002">
          <sup>2</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0002-0389-7891</contrib-id>
        <name>
          <surname>Cimrák</surname>
          <given-names>Ivan</given-names>
        </name>
        <role content-type="https://casrai.org/credit/">Conceptualization</role>
        <role content-type="https://casrai.org/credit/">Formal analysis</role>
        <role content-type="https://casrai.org/credit/">Funding acquisition</role>
        <role content-type="https://casrai.org/credit/">Investigation</role>
        <role content-type="https://casrai.org/credit/">Methodology</role>
        <role content-type="https://casrai.org/credit/">Software</role>
        <role content-type="https://casrai.org/credit/">Supervision</role>
        <role content-type="https://casrai.org/credit/">Validation</role>
        <role content-type="https://casrai.org/credit/">Visualization</role>
        <role content-type="https://casrai.org/credit/">Writing – original draft</role>
        <role content-type="https://casrai.org/credit/">Writing – review &amp; editing</role>
        <xref ref-type="aff" rid="aff001">
          <sup>1</sup>
        </xref>
        <xref ref-type="corresp" rid="cor001">*</xref>
      </contrib>
    </contrib-group>
    <aff id="aff001">
      <label>1</label>
      <addr-line>Cell-in-fluid Biomedical Modelling and Computation Group, University of Žilina, Žilina, Slovakia</addr-line>
    </aff>
    <aff id="aff002">
      <label>2</label>
      <addr-line>Institute for Computational Physics, University of Stuttgart, Stuttgart, Germany</addr-line>
    </aff>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Schneidman-Duhovny</surname>
          <given-names>Dina</given-names>
        </name>
        <role>Editor</role>
        <xref ref-type="aff" rid="edit1"/>
      </contrib>
    </contrib-group>
    <aff id="edit1">
      <addr-line>Hebrew University of Jerusalem, ISRAEL</addr-line>
    </aff>
    <author-notes>
      <fn fn-type="COI-statement" id="coi001">
        <p>The authors have declared that no competing interests exist.</p>
      </fn>
      <corresp id="cor001">* E-mail: <email>ivan.cimrak@fri.uniza.sk</email></corresp>
    </author-notes>
    <pub-date pub-type="collection">
      <month>10</month>
      <year>2020</year>
    </pub-date>
    <pub-date pub-type="epub">
      <day>19</day>
      <month>10</month>
      <year>2020</year>
    </pub-date>
    <volume>16</volume>
    <issue>10</issue>
    <elocation-id>e1008249</elocation-id>
    <history>
      <date date-type="received">
        <day>8</day>
        <month>3</month>
        <year>2020</year>
      </date>
      <date date-type="accepted">
        <day>14</day>
        <month>8</month>
        <year>2020</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© 2020 Jančigová et al</copyright-statement>
      <copyright-year>2020</copyright-year>
      <copyright-holder>Jančigová et al</copyright-holder>
      <license xlink:href="http://creativecommons.org/licenses/by/4.0/">
        <license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
      </license>
    </permissions>
    <self-uri content-type="pdf" xlink:href="pcbi.1008249.pdf"/>
    <abstract>
      <p>A user ready, well documented software package PyOIF contains an implementation of a robust validated computational model for cell flow modelling. The software is capable of simulating processes involving biological cells immersed in a fluid. The examples of such processes are flows in microfluidic channels with numerous applications such as cell sorting, rare cell isolation or flow fractionation. Besides the typical usage of such computational model in the design process of microfluidic devices, PyOIF has been used in the computer-aided discovery involving mechanical properties of cell membranes. With this software, single cell, many cell, as well as dense cell suspensions can be simulated. Many cell simulations include cell-cell interactions and analyse their effect on the cells. PyOIF can be used to test the influence of mechanical properties of the membrane in flows and in membrane-membrane interactions. Dense suspensions may be used to study the effect of cell volume fraction on macroscopic phenomena such as cell-free layer, apparent suspension viscosity or cell degradation. The PyOIF module is based on the official ESPResSo distribution with few modifications and is available under the terms of the GNU General Public Licence. PyOIF is based on Python objects representing the cells and on the C++ computational core for fluid and interaction dynamics. The source code is freely available at GitHub repository, runs natively under Linux and MacOS and can be used in Windows Subsystem for Linux. The communication among PyOIF users and developers is maintained using active mailing lists. This work provides a basic background to the underlying computational models and to the implementation of interactions within this framework. We provide the prospective PyOIF users with a practical example of simulation script with reference to our publicly available User Guide.</p>
    </abstract>
    <funding-group>
      <award-group id="award001">
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="funder-id">http://dx.doi.org/10.13039/501100005357</institution-id>
            <institution>Agentúra na Podporu Výskumu a Vývoja</institution>
          </institution-wrap>
        </funding-source>
        <award-id>APVV-15-0751</award-id>
        <principal-award-recipient>
          <contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0002-0928-6354</contrib-id>
          <name>
            <surname>Jancigova</surname>
            <given-names>Iveta</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
      <award-group id="award002">
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="funder-id">http://dx.doi.org/10.13039/501100003194</institution-id>
            <institution>Agentúra Ministerstva Školstva, Vedy, Výskumu a Športu SR</institution>
          </institution-wrap>
        </funding-source>
        <award-id>VEGA 1/0643/17</award-id>
        <principal-award-recipient>
          <contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0002-0389-7891</contrib-id>
          <name>
            <surname>Cimrak</surname>
            <given-names>Ivan</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
      <funding-statement>KK and IJ were supported by the Slovak Research and Development Agency (contract number APVV-15-0751, <ext-link ext-link-type="uri" xlink:href="https://www.apvv.sk">www.apvv.sk</ext-link>). IC was supported by the Ministry of Education, Science, Research and Sport of the Slovak Republic (contract number VEGA 1/0643/17, <ext-link ext-link-type="uri" xlink:href="https://www.minedu.sk/vedecka-grantova-agentura-msvvas-sr-a-sav-vega/">https://www.minedu.sk/vedecka-grantova-agentura-msvvas-sr-a-sav-vega/</ext-link>). The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.</funding-statement>
    </funding-group>
    <counts>
      <fig-count count="6"/>
      <table-count count="1"/>
      <page-count count="21"/>
    </counts>
    <custom-meta-group>
      <custom-meta>
        <meta-name>PLOS Publication Stage</meta-name>
        <meta-value>vor-update-to-uncorrected-proof</meta-value>
      </custom-meta>
      <custom-meta>
        <meta-name>Publication Update</meta-name>
        <meta-value>2020-10-29</meta-value>
      </custom-meta>
      <custom-meta id="data-availability">
        <meta-name>Data Availability</meta-name>
        <meta-value>All relevant data are within the manuscript and its Supporting Information files.</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
  <notes>
    <title>Data Availability</title>
    <p>All relevant data are within the manuscript and its Supporting Information files.</p>
  </notes>
</front>
<body>
  <disp-quote>
    <p>This is a <italic>PLOS Computational Biology</italic> Software paper.</p>
  </disp-quote>
  <sec sec-type="intro" id="sec001">
    <title>Introduction</title>
    <sec id="sec002">
      <title>Computational problem description</title>
      <p>Microfluidics has been widely adopted by biological and biomedical research fields including (but not limited to) lateral flow tests [<xref rid="pcbi.1008249.ref001" ref-type="bibr">1</xref>], mixing [<xref rid="pcbi.1008249.ref002" ref-type="bibr">2</xref>] or cell sorting [<xref rid="pcbi.1008249.ref003" ref-type="bibr">3</xref>]. Due to the very nature of the problems, in the design phase, the microfluidic applications may greatly benefit from simulations. Also, computational models of fluidic systems involving flow of cells and their manipulation may lead to computer-aided discovery in biology as demonstrated in [<xref rid="pcbi.1008249.ref004" ref-type="bibr">4</xref>] and the references therein.</p>
      <p>Computational models serve a wide variety of roles, including hypothesis testing, generating new insights, deepening understanding, suggesting and interpreting experiments, tracing chains of causation or performing sensitivity analyses. Models cannot replace experiments but they can demonstrate whether or not a proposed mechanism is sufficient to produce an observed phenomenon.</p>
      <p>To make it easier for people with biological or biomedical background who typically do not have extensive computational experience to actually use the computational models for these purposes the usage should be relatively easy. To the best of our knowledge, there is no such case among the available computer implementations of cell flow models.</p>
      <p>With our work we aim to fulfill two goals: 1. We provide a robust and validated computational model for cell flow modelling. 2. We keep the usage of the implementation easy enough for non-experts on cell modelling. We make the computer implementation available under GPL.</p>
    </sec>
    <sec id="sec003">
      <title>Similar methods and tools</title>
      <p>There are numerous computational models that govern flow of cells inside microchannels. Continuum models treat the membrane as a thin shell and track its deformations in time [<xref rid="pcbi.1008249.ref005" ref-type="bibr">5</xref>, <xref rid="pcbi.1008249.ref006" ref-type="bibr">6</xref>]. The fine network-based models look in detail at the membrane as a lipid bilayer with the underlying spectrin filament network [<xref rid="pcbi.1008249.ref007" ref-type="bibr">7</xref>–<xref rid="pcbi.1008249.ref009" ref-type="bibr">9</xref>]. Coarse-grained models enable simulations of many cell applications [<xref rid="pcbi.1008249.ref010" ref-type="bibr">10</xref>, <xref rid="pcbi.1008249.ref011" ref-type="bibr">11</xref>]. Mesh-based models study the biomechanical properties of the cell membrane by means of a triangular network coupled to a lattice-Boltzmann (or any other fluid solver) representation of the fluid [<xref rid="pcbi.1008249.ref012" ref-type="bibr">12</xref>–<xref rid="pcbi.1008249.ref016" ref-type="bibr">16</xref>].</p>
      <p>The actual computer implementation of the computational model makes the model useful for the potential user. In-house codes typically have very few users, e.g. in [<xref rid="pcbi.1008249.ref017" ref-type="bibr">17</xref>], the authors develop a multiscale and multiphysics computational method to investigate the transport of magnetic particles as drug carriers in blood flow. The method is implemented on top of the open-source molecular dynamics simulator LAMMPS [<xref rid="pcbi.1008249.ref018" ref-type="bibr">18</xref>], however, the code for the method itself is not available. Some computational methods are published with open access. An example of such code [<xref rid="pcbi.1008249.ref019" ref-type="bibr">19</xref>] is a parallel fluid-solid coupling model using the existing code of LAMMPS for particle propagation of the deformable solids and Palabos [<xref rid="pcbi.1008249.ref020" ref-type="bibr">20</xref>] for the simulation of fluid using lattice-Boltzmann method. Other examples include immersed boundary lattice-Boltzmann finite element method for modelling deformable objects in a fluid [<xref rid="pcbi.1008249.ref014" ref-type="bibr">14</xref>, <xref rid="pcbi.1008249.ref021" ref-type="bibr">21</xref>] and the work [<xref rid="pcbi.1008249.ref022" ref-type="bibr">22</xref>] that uses LAMMPS code with GPU accelerated package using dissipative particle dynamics to implement the model of red blood cell introduced in [<xref rid="pcbi.1008249.ref023" ref-type="bibr">23</xref>]. Generally, the usage of computational models is limited only to those experts that have day-to-day experience with them and these codes have a very long learning curve for new users. The advantage of PyOIF is the Python interface, which makes the setup relatively easy.</p>
      <p>Several other software tools attempt to provide an easy-to-use interface together with a well-written documentation. The OpenRBC project [<xref rid="pcbi.1008249.ref024" ref-type="bibr">24</xref>] aims at modelling of red blood cells at protein resolution, using multiple millions of mesoscopic particles, thus unsuitable for simulating larger number of cells. Therefore, case studies involving analysis of mesoscopic phenomena, like cell free layer or rheological properties of blood, are impossible to perform using OpenRBC. Another tool, Hemocell [<xref rid="pcbi.1008249.ref025" ref-type="bibr">25</xref>], provides implementation of computational model of red blood cell presented in [<xref rid="pcbi.1008249.ref026" ref-type="bibr">26</xref>]. The implementation allows simulations of many cells thus, unlike the previous tool, enables analysis of mesoscopic phenomena. The installation of Hemocell requires installation of an external software Palabos.</p>
    </sec>
    <sec id="sec004">
      <title>Extensible user-friendly tool for computational cell modelling</title>
      <p>The PyOIF module fills a niche among the coarse-grained simulation tools. It is open-source, efficiently handles both single and many-cell simulations, requires only simple user input and lightweight scripting in Python and is easily extensible.</p>
    </sec>
  </sec>
  <sec sec-type="materials|methods" id="sec005">
    <title>Design and implementation</title>
    <sec id="sec006">
      <title>Underlying computational model</title>
      <p>The PyOIF module is based on two-component model of fluid and immersed objects. The fluid dynamics is governed by the lattice-Boltzmann method (LBM) [<xref rid="pcbi.1008249.ref027" ref-type="bibr">27</xref>] while the deformable surface is represented by tracking particles propagated with molecular dynamics. Both components are linked via a two-way momentum conserving force interaction. A simplified version of this model was introduced in our earlier work [<xref rid="pcbi.1008249.ref028" ref-type="bibr">28</xref>].</p>
      <sec id="sec007">
        <title>Fluid component</title>
        <p>LBM uses probability distribution functions that propagate and collide over a fixed three-dimensional discrete lattice. We use the existing D3Q19 LBM implementation in ESPResSo that defines 19 discrete directions along the edges and diagonals of the lattice. The particle density functions are defined for each of these directions at every lattice position and time. The propagation is performed using the velocity Verlet scheme and the collision operator satisfies the constraints of mass and momentum conservation.</p>
      </sec>
      <sec id="sec008">
        <title>Coupling of the model components</title>
        <p>The fluid is coupled to mesh points by forces. In this coupling, opposite forces exerted on the mesh points and fluid nodes penalize the difference between the local fluid velocity <inline-formula id="pcbi.1008249.e001"><alternatives><graphic xlink:href="pcbi.1008249.e001.jpg" id="pcbi.1008249.e001g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M1"><mml:mover accent="true"><mml:mi>u</mml:mi><mml:mo>→</mml:mo></mml:mover></mml:math></alternatives></inline-formula> and mesh points velocities <inline-formula id="pcbi.1008249.e002"><alternatives><graphic xlink:href="pcbi.1008249.e002.jpg" id="pcbi.1008249.e002g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M2"><mml:mover accent="true"><mml:mi>v</mml:mi><mml:mo>→</mml:mo></mml:mover></mml:math></alternatives></inline-formula>
<disp-formula id="pcbi.1008249.e003"><alternatives><graphic xlink:href="pcbi.1008249.e003.jpg" id="pcbi.1008249.e003g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M3"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mover accent="true"><mml:mi>F</mml:mi><mml:mo>→</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:mi>γ</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mover accent="true"><mml:mi>u</mml:mi><mml:mo>→</mml:mo></mml:mover><mml:mo>-</mml:mo><mml:mover accent="true"><mml:mi>v</mml:mi><mml:mo>→</mml:mo></mml:mover><mml:mo>)</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives><label>(1)</label></disp-formula>
This way, we approximate the no-slip condition.</p>
      </sec>
      <sec id="sec009">
        <title>Immersed objects component</title>
        <p>Besides the fluid force, elastic forces are exerted on mesh points that are evaluated from the deformation of the cell. The resultant force <inline-formula id="pcbi.1008249.e004"><alternatives><graphic xlink:href="pcbi.1008249.e004.jpg" id="pcbi.1008249.e004g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M4"><mml:msub><mml:mover accent="true"><mml:mi>F</mml:mi><mml:mo>→</mml:mo></mml:mover><mml:mrow><mml:mi>t</mml:mi><mml:mi>o</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:math></alternatives></inline-formula> is the driving force according which the mesh points are propagated in space following Newton’s equation:
<disp-formula id="pcbi.1008249.e005"><alternatives><graphic xlink:href="pcbi.1008249.e005.jpg" id="pcbi.1008249.e005g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M5"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>m</mml:mi><mml:mfrac><mml:mrow><mml:msup><mml:mi>∂</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mover accent="true"><mml:mi>x</mml:mi><mml:mo>→</mml:mo></mml:mover><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mi>∂</mml:mi><mml:msup><mml:mi>t</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>F</mml:mi><mml:mo>→</mml:mo></mml:mover><mml:mrow><mml:mi>t</mml:mi><mml:mi>o</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives><label>(2)</label></disp-formula>
where <italic>m</italic> is the mass of the mesh points. The sources of <inline-formula id="pcbi.1008249.e006"><alternatives><graphic xlink:href="pcbi.1008249.e006.jpg" id="pcbi.1008249.e006g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M6"><mml:msub><mml:mover accent="true"><mml:mi>F</mml:mi><mml:mo>→</mml:mo></mml:mover><mml:mrow><mml:mi>t</mml:mi><mml:mi>o</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:math></alternatives></inline-formula> are the elasto-mechanical properties of the cell membrane, the fluid-structure interaction or possibly other external stimuli.</p>
      </sec>
      <sec id="sec010">
        <title>Elastic membrane</title>
        <p>Next we briefly describe the elastic components of the spring network that is formed by mesh points linked together by elastic forces. A more detailed discussion and comparison to similar approaches that use these types of elastic forces, e.g. [<xref rid="pcbi.1008249.ref016" ref-type="bibr">16</xref>, <xref rid="pcbi.1008249.ref029" ref-type="bibr">29</xref>], can be found in [<xref rid="pcbi.1008249.ref030" ref-type="bibr">30</xref>].</p>
        <p>The spring network is a physical model that consists of mesh points located on the surface of the immersed object connected by generalised springs. Part of such spring network is depicted in the left bottom part of <xref ref-type="fig" rid="pcbi.1008249.g001">Fig 1</xref>. To capture the membrane properties, we use the following moduli acting in the network.</p>
        <fig id="pcbi.1008249.g001" orientation="portrait" position="float">
          <object-id pub-id-type="doi">10.1371/journal.pcbi.1008249.g001</object-id>
          <label>Fig 1</label>
          <caption>
            <p>Left bottom: Part of the triangular mesh. Geometric entities used to define the elasticity are highlighted: four points (bold dots), three edges (full bold lines), two triangles (dotted lines) and two angles between neighbouring triangles (dashed lines and an arc). Right: Scheme of basic PyOIF classes. Linking of classes and geometrical entities (depicted in the left part of the figure) is emphasized by bold dots (mesh points), full bold lines (edges), dotted lines (triangles), dashed lines (angles) and bold grey lines (mesh).</p>
          </caption>
          <graphic xlink:href="pcbi.1008249.g001"/>
        </fig>
        <p>Stretching modulus generates a nonlinear stretching force between two mesh points <italic>A</italic> and <italic>B</italic> connected with an edge in the mesh. This force is symmetrically applied at both mesh points and for point <italic>A</italic> it is defined as
<disp-formula id="pcbi.1008249.e007"><alternatives><graphic xlink:href="pcbi.1008249.e007.jpg" id="pcbi.1008249.e007g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M7"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>F</mml:mi><mml:mo>→</mml:mo></mml:mover><mml:mi>s</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>A</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mi>k</mml:mi><mml:mi>s</mml:mi></mml:msub><mml:mi>κ</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mo>λ</mml:mo><mml:mo>)</mml:mo></mml:mrow><mml:mo>Δ</mml:mo><mml:msub><mml:mi>l</mml:mi><mml:mrow><mml:mi>A</mml:mi><mml:mi>B</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mover accent="true"><mml:mi>p</mml:mi><mml:mo>→</mml:mo></mml:mover><mml:mrow><mml:mi>A</mml:mi><mml:mi>B</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives><label>(3)</label></disp-formula>
where <italic>k</italic><sub><italic>s</italic></sub> is the stretching coefficient, <inline-formula id="pcbi.1008249.e008"><alternatives><graphic xlink:href="pcbi.1008249.e008.jpg" id="pcbi.1008249.e008g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M8"><mml:msub><mml:mover accent="true"><mml:mi>p</mml:mi><mml:mo>→</mml:mo></mml:mover><mml:mrow><mml:mi>A</mml:mi><mml:mi>B</mml:mi></mml:mrow></mml:msub></mml:math></alternatives></inline-formula> is a unit vector pointing from <italic>A</italic> to <italic>B</italic>, <italic>κ</italic> represents the neo-Hookean nonlinearity <italic>κ</italic>(λ) = (λ<sup>0.5</sup> + λ<sup>−2.5</sup>)/(λ + λ<sup>−3</sup>), λ = <italic>l</italic><sub><italic>AB</italic></sub>/<italic>l</italic><sub><italic>AB</italic>0</sub>, <italic>l</italic><sub><italic>AB</italic>0</sub> is the relaxed length of the edge <italic>AB</italic>, <italic>l</italic><sub><italic>AB</italic></sub> is the current length, Δ<italic>l</italic><sub><italic>AB</italic></sub> = <italic>l</italic><sub><italic>AB</italic></sub> − <italic>l</italic><sub><italic>AB</italic>0</sub> is the prolongation of this edge.</p>
        <p>Bending modulus is derived from the Helfrich energy [<xref rid="pcbi.1008249.ref031" ref-type="bibr">31</xref>]. It is a potential linked to four mesh points belonging to two neighbouring triangles in a mesh. This energy acts to preserve the angle between the triangles. The expressions for bending force calculations involve position vectors <italic>A</italic>, <italic>B</italic>, <italic>C</italic> and <italic>D</italic> of two triangles <italic>ABC</italic> and <italic>ABD</italic> that share a common edge <italic>AB</italic> and current angle <italic>θ</italic>, see also left bottom part of <xref ref-type="fig" rid="pcbi.1008249.g001">Fig 1</xref>:
<disp-formula id="pcbi.1008249.e009"><alternatives><graphic xlink:href="pcbi.1008249.e009.jpg" id="pcbi.1008249.e009g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M9"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>F</mml:mi><mml:mo>→</mml:mo></mml:mover><mml:mi>b</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>A</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd><mml:mtd><mml:mo>=</mml:mo></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>-</mml:mo><mml:msub><mml:mi>k</mml:mi><mml:mi>b</mml:mi></mml:msub><mml:mo>Δ</mml:mo><mml:mi>θ</mml:mi><mml:mo>(</mml:mo><mml:mfrac><mml:msub><mml:mover accent="true"><mml:mi>N</mml:mi><mml:mo>→</mml:mo></mml:mover><mml:mi>C</mml:mi></mml:msub><mml:mrow><mml:mrow><mml:mo>|</mml:mo></mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>N</mml:mi><mml:mo>→</mml:mo></mml:mover><mml:mi>C</mml:mi></mml:msub><mml:msup><mml:mrow><mml:mo>|</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mfrac><mml:mfrac><mml:mrow><mml:mo>(</mml:mo><mml:mi>A</mml:mi><mml:mo>-</mml:mo><mml:mi>B</mml:mi><mml:mo>,</mml:mo><mml:mi>C</mml:mi><mml:mo>-</mml:mo><mml:mi>B</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mo>|</mml:mo><mml:mi>B</mml:mi><mml:mo>-</mml:mo><mml:mi>A</mml:mi><mml:mo>|</mml:mo></mml:mrow></mml:mfrac><mml:mo>+</mml:mo><mml:mfrac><mml:msub><mml:mover accent="true"><mml:mi>N</mml:mi><mml:mo>→</mml:mo></mml:mover><mml:mi>D</mml:mi></mml:msub><mml:mrow><mml:mrow><mml:mo>|</mml:mo></mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>N</mml:mi><mml:mo>→</mml:mo></mml:mover><mml:mi>D</mml:mi></mml:msub><mml:msup><mml:mrow><mml:mo>|</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mfrac><mml:mfrac><mml:mrow><mml:mo>(</mml:mo><mml:mi>A</mml:mi><mml:mo>-</mml:mo><mml:mi>B</mml:mi><mml:mo>,</mml:mo><mml:mi>D</mml:mi><mml:mo>-</mml:mo><mml:mi>B</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mo>|</mml:mo><mml:mi>B</mml:mi><mml:mo>-</mml:mo><mml:mi>A</mml:mi><mml:mo>|</mml:mo></mml:mrow></mml:mfrac><mml:mo>)</mml:mo><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>F</mml:mi><mml:mo>→</mml:mo></mml:mover><mml:mi>b</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>B</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd><mml:mtd><mml:mo>=</mml:mo></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>-</mml:mo><mml:msub><mml:mi>k</mml:mi><mml:mi>b</mml:mi></mml:msub><mml:mo>Δ</mml:mo><mml:mi>θ</mml:mi><mml:mo>(</mml:mo><mml:mfrac><mml:msub><mml:mover accent="true"><mml:mi>N</mml:mi><mml:mo>→</mml:mo></mml:mover><mml:mi>C</mml:mi></mml:msub><mml:mrow><mml:mrow><mml:mo>|</mml:mo></mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>N</mml:mi><mml:mo>→</mml:mo></mml:mover><mml:mi>C</mml:mi></mml:msub><mml:msup><mml:mrow><mml:mo>|</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mfrac><mml:mfrac><mml:mrow><mml:mo>(</mml:mo><mml:mi>A</mml:mi><mml:mo>-</mml:mo><mml:mi>B</mml:mi><mml:mo>,</mml:mo><mml:mi>A</mml:mi><mml:mo>-</mml:mo><mml:mi>C</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mo>|</mml:mo><mml:mi>B</mml:mi><mml:mo>-</mml:mo><mml:mi>A</mml:mi><mml:mo>|</mml:mo></mml:mrow></mml:mfrac><mml:mo>+</mml:mo><mml:mfrac><mml:msub><mml:mover accent="true"><mml:mi>N</mml:mi><mml:mo>→</mml:mo></mml:mover><mml:mi>D</mml:mi></mml:msub><mml:mrow><mml:mrow><mml:mo>|</mml:mo></mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>N</mml:mi><mml:mo>→</mml:mo></mml:mover><mml:mi>D</mml:mi></mml:msub><mml:msup><mml:mrow><mml:mo>|</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mfrac><mml:mfrac><mml:mrow><mml:mo>(</mml:mo><mml:mi>A</mml:mi><mml:mo>-</mml:mo><mml:mi>B</mml:mi><mml:mo>,</mml:mo><mml:mi>A</mml:mi><mml:mo>-</mml:mo><mml:mi>D</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mo>|</mml:mo><mml:mi>B</mml:mi><mml:mo>-</mml:mo><mml:mi>A</mml:mi><mml:mo>|</mml:mo></mml:mrow></mml:mfrac><mml:mo>)</mml:mo><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>F</mml:mi><mml:mo>→</mml:mo></mml:mover><mml:mi>b</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>C</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd><mml:mtd><mml:mo>=</mml:mo></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:msub><mml:mi>k</mml:mi><mml:mi>b</mml:mi></mml:msub><mml:mo>Δ</mml:mo><mml:mi>θ</mml:mi><mml:mrow><mml:mo>|</mml:mo><mml:mi>B</mml:mi><mml:mo>-</mml:mo><mml:mi>A</mml:mi><mml:mo>|</mml:mo></mml:mrow><mml:mfrac><mml:msub><mml:mover accent="true"><mml:mi>N</mml:mi><mml:mo>→</mml:mo></mml:mover><mml:mi>C</mml:mi></mml:msub><mml:mrow><mml:mrow><mml:mo>|</mml:mo></mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>N</mml:mi><mml:mo>→</mml:mo></mml:mover><mml:mi>C</mml:mi></mml:msub><mml:msup><mml:mrow><mml:mo>|</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mfrac><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>F</mml:mi><mml:mo>→</mml:mo></mml:mover><mml:mi>b</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>D</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd><mml:mtd><mml:mo>=</mml:mo></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:msub><mml:mi>k</mml:mi><mml:mi>b</mml:mi></mml:msub><mml:mo>Δ</mml:mo><mml:mi>θ</mml:mi><mml:mrow><mml:mo>|</mml:mo><mml:mi>B</mml:mi><mml:mo>-</mml:mo><mml:mi>A</mml:mi><mml:mo>|</mml:mo></mml:mrow><mml:mfrac><mml:msub><mml:mover accent="true"><mml:mi>N</mml:mi><mml:mo>→</mml:mo></mml:mover><mml:mi>D</mml:mi></mml:msub><mml:mrow><mml:mrow><mml:mo>|</mml:mo></mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>N</mml:mi><mml:mo>→</mml:mo></mml:mover><mml:mi>D</mml:mi></mml:msub><mml:msup><mml:mrow><mml:mo>|</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mfrac><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives><label>(4)</label></disp-formula>
where <italic>k</italic><sub><italic>b</italic></sub> is the bending coefficient, Δ<italic>θ</italic> is the difference between <italic>θ</italic> and <italic>θ</italic><sub>0</sub>, the angle between these triangles in relaxed state. The vector <inline-formula id="pcbi.1008249.e010"><alternatives><graphic xlink:href="pcbi.1008249.e010.jpg" id="pcbi.1008249.e010g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M10"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>N</mml:mi><mml:mo>→</mml:mo></mml:mover><mml:mi>C</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mi>A</mml:mi><mml:mo>-</mml:mo><mml:mi>C</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>×</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mi>B</mml:mi><mml:mo>-</mml:mo><mml:mi>C</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> is the normal vector to triangle <italic>ABC</italic> and <inline-formula id="pcbi.1008249.e011"><alternatives><graphic xlink:href="pcbi.1008249.e011.jpg" id="pcbi.1008249.e011g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M11"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>N</mml:mi><mml:mo>→</mml:mo></mml:mover><mml:mi>D</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mi>B</mml:mi><mml:mo>-</mml:mo><mml:mi>D</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>×</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mi>A</mml:mi><mml:mo>-</mml:mo><mml:mi>D</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> is the normal vector to triangle <italic>ABD</italic>. <inline-formula id="pcbi.1008249.e012"><alternatives><graphic xlink:href="pcbi.1008249.e012.jpg" id="pcbi.1008249.e012g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M12"><mml:mrow><mml:mo>(</mml:mo><mml:mover accent="true"><mml:mi>a</mml:mi><mml:mo>→</mml:mo></mml:mover><mml:mo>,</mml:mo><mml:mover accent="true"><mml:mi>b</mml:mi><mml:mo>→</mml:mo></mml:mover><mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> denotes the dot product.</p>
        <p>The local area modulus generates forces corresponding to one triangle. The force applied at vertex <italic>A</italic> of triangle <italic>ABC</italic> with area <italic>S</italic><sub><italic>ABC</italic></sub> and centroid <italic>T</italic> is
<disp-formula id="pcbi.1008249.e013"><alternatives><graphic xlink:href="pcbi.1008249.e013.jpg" id="pcbi.1008249.e013g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M13"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>F</mml:mi><mml:mo>→</mml:mo></mml:mover><mml:mrow><mml:mi>a</mml:mi><mml:mi>l</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>A</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mi>k</mml:mi><mml:mrow><mml:mi>a</mml:mi><mml:mi>l</mml:mi></mml:mrow></mml:msub><mml:mfrac><mml:mrow><mml:mo>Δ</mml:mo><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mi>A</mml:mi><mml:mi>B</mml:mi><mml:mi>C</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msubsup><mml:mi>t</mml:mi><mml:mi>a</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:mo>+</mml:mo><mml:msubsup><mml:mi>t</mml:mi><mml:mi>b</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:mo>+</mml:mo><mml:msubsup><mml:mi>t</mml:mi><mml:mi>c</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:mfrac><mml:mover accent="true"><mml:mrow><mml:mi>A</mml:mi><mml:mi>T</mml:mi></mml:mrow><mml:mo>→</mml:mo></mml:mover><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives><label>(5)</label></disp-formula>
where <italic>k</italic><sub><italic>al</italic></sub> is the local area coefficient, Δ<italic>S</italic><sub><italic>ABC</italic></sub> is the difference between current <italic>S</italic><sub><italic>ABC</italic></sub> and area <italic>S</italic><sub><italic>ABC</italic>0</sub> of the triangle in the relaxed state and <italic>t</italic><sub><italic>a</italic></sub>, <italic>t</italic><sub><italic>b</italic></sub>, <italic>t</italic><sub><italic>c</italic></sub> are the distances from points <italic>A</italic>, <italic>B</italic>, <italic>C</italic> to centroid <italic>T</italic>. It has been shown in [<xref rid="pcbi.1008249.ref032" ref-type="bibr">32</xref>] that this approach is force- and torque-free. Analogous forces are assigned to vertices <italic>B</italic> and <italic>C</italic>.</p>
        <p>The global area modulus ensures that the surface area of the cell remains fairly constant. The application of this force is similar to the local area: we have the proportional distribution according to the distance of vertices from centroid <italic>t</italic><sub><italic>a</italic></sub>, <italic>t</italic><sub><italic>b</italic></sub>, <italic>t</italic><sub><italic>c</italic></sub>. In addition to that we have a weight that takes into account the area of the triangle with respect to the total surface area of the cell:
<disp-formula id="pcbi.1008249.e014"><alternatives><graphic xlink:href="pcbi.1008249.e014.jpg" id="pcbi.1008249.e014g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M14"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>F</mml:mi><mml:mo>→</mml:mo></mml:mover><mml:mrow><mml:mi>a</mml:mi><mml:mi>g</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>A</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mi>k</mml:mi><mml:mrow><mml:mi>a</mml:mi><mml:mi>g</mml:mi></mml:mrow></mml:msub><mml:mo>Δ</mml:mo><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mi>c</mml:mi><mml:mi>e</mml:mi><mml:mi>l</mml:mi><mml:mi>l</mml:mi></mml:mrow></mml:msub><mml:mfrac><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mi>A</mml:mi><mml:mi>B</mml:mi><mml:mi>C</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mi>c</mml:mi><mml:mi>e</mml:mi><mml:mi>l</mml:mi><mml:mi>l</mml:mi><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:mfrac><mml:mfrac><mml:mover accent="true"><mml:mrow><mml:mi>A</mml:mi><mml:mi>T</mml:mi></mml:mrow><mml:mo>→</mml:mo></mml:mover><mml:mrow><mml:msubsup><mml:mi>t</mml:mi><mml:mi>a</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:mo>+</mml:mo><mml:msubsup><mml:mi>t</mml:mi><mml:mi>b</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:mo>+</mml:mo><mml:msubsup><mml:mi>t</mml:mi><mml:mi>c</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:mfrac><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives><label>(6)</label></disp-formula>
where <italic>k</italic><sub><italic>ag</italic></sub> is the global area coefficient, Δ<italic>S</italic><sub><italic>cell</italic></sub> is the difference between the current <italic>S</italic><sub><italic>cell</italic></sub> and area <italic>S</italic><sub><italic>cell</italic>0</sub> in relaxed state. The global area contribution described by this formula is due to the triangle <italic>ABC</italic> with area <italic>S</italic><sub><italic>ABC</italic></sub> and vector <inline-formula id="pcbi.1008249.e015"><alternatives><graphic xlink:href="pcbi.1008249.e015.jpg" id="pcbi.1008249.e015g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M15"><mml:mover accent="true"><mml:mrow><mml:mi>A</mml:mi><mml:mi>T</mml:mi></mml:mrow><mml:mo>→</mml:mo></mml:mover></mml:math></alternatives></inline-formula>. There are other contributions of this kind from other triangles in which <italic>A</italic> is a vertex.</p>
        <p>The volume modulus ensures that the volume of the cell remains fairly constant. Thus, it is also a global modulus, similar to global area. The force as described here, corresponds to triangle <italic>ABC</italic> and in practice is divided by three and then applied at vertices of the triangle:
<disp-formula id="pcbi.1008249.e016"><alternatives><graphic xlink:href="pcbi.1008249.e016.jpg" id="pcbi.1008249.e016g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M16"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>F</mml:mi><mml:mo>→</mml:mo></mml:mover><mml:mi>v</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>A</mml:mi><mml:mi>B</mml:mi><mml:mi>C</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mo>-</mml:mo><mml:msub><mml:mi>k</mml:mi><mml:mi>v</mml:mi></mml:msub><mml:mfrac><mml:mrow><mml:mo>Δ</mml:mo><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi>c</mml:mi><mml:mi>e</mml:mi><mml:mi>l</mml:mi><mml:mi>l</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi>c</mml:mi><mml:mi>e</mml:mi><mml:mi>l</mml:mi><mml:mi>l</mml:mi><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:mfrac><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mi>A</mml:mi><mml:mi>B</mml:mi><mml:mi>C</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mover accent="true"><mml:mi>n</mml:mi><mml:mo>→</mml:mo></mml:mover><mml:mrow><mml:mi>A</mml:mi><mml:mi>B</mml:mi><mml:mi>C</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives><label>(7)</label></disp-formula>
where <italic>k</italic><sub><italic>v</italic></sub> is the volume coefficient, Δ<italic>V</italic><sub><italic>cell</italic></sub> is the difference between the current volume <italic>V</italic><sub><italic>cell</italic></sub> and volume <italic>V</italic><sub><italic>cell</italic>0</sub> in relaxed state. The vector <inline-formula id="pcbi.1008249.e017"><alternatives><graphic xlink:href="pcbi.1008249.e017.jpg" id="pcbi.1008249.e017g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M17"><mml:msub><mml:mover accent="true"><mml:mi>n</mml:mi><mml:mo>→</mml:mo></mml:mover><mml:mrow><mml:mi>A</mml:mi><mml:mi>B</mml:mi><mml:mi>C</mml:mi></mml:mrow></mml:msub></mml:math></alternatives></inline-formula> is the unit normal vector to the plane <italic>ABC</italic>, thus the direction of the force is along the triangle’s normal pointing inside the cell. The forces are scaled by the triangle area so that the triangle annihilation does not occur.</p>
      </sec>
      <sec id="sec011">
        <title>Interactions</title>
        <p>In addition to the fluid-object coupling, there are three more types of interactions.</p>
        <p>One of them addresses the object-wall encounters. A natural approach in the spring network models is to transform the object-wall interaction into a set of particle-wall interactions. A repulsive force is then applied at the particles when they get too close to the wall. The forces correspond to the soft-sphere potential:
<disp-formula id="pcbi.1008249.e018"><alternatives><graphic xlink:href="pcbi.1008249.e018.jpg" id="pcbi.1008249.e018g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M18"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>V</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>d</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mi>a</mml:mi><mml:msup><mml:mi>d</mml:mi><mml:mrow><mml:mo>-</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:mspace width="2em"/><mml:mi>d</mml:mi><mml:mo>&lt;</mml:mo><mml:msub><mml:mi>d</mml:mi><mml:mrow><mml:mi>c</mml:mi><mml:mi>u</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives><label>(8)</label></disp-formula>
where <italic>d</italic> is the distance between the particle and the wall, <italic>d</italic><sub><italic>cut</italic></sub> is the threshold at which this potential starts acting (for larger distances, no force is applied), <italic>a</italic> is a scaling parameter and <italic>n</italic> (typically greater than 1) determines how steep the response gets as particles get close to the wall.</p>
        <p>The second type of coupling pertains to the object-object interactions, which are transformed into a set of particle-particle interactions. These work similarly to the soft-sphere potential, but take into account not only the distance of the two points but also the normal vectors of the two corresponding objects at these two points. Based on these two vectors, we determine whether the two membranes have crossed each other and apply the membrane collision repulsive forces in the proper direction,
<disp-formula id="pcbi.1008249.e019"><alternatives><graphic xlink:href="pcbi.1008249.e019.jpg" id="pcbi.1008249.e019g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M19"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>V</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>d</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mi>a</mml:mi><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mi>n</mml:mi><mml:mi>d</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mfrac><mml:mspace width="2em"/><mml:mi>d</mml:mi><mml:mo>&lt;</mml:mo><mml:msub><mml:mi>d</mml:mi><mml:mrow><mml:mi>c</mml:mi><mml:mi>u</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives><label>(9)</label></disp-formula>
where <italic>d</italic> is the distance between the two particles, <italic>d</italic><sub><italic>cut</italic></sub> is the threshold, at which this potential starts acting, <italic>a</italic> is a scaling parameter and <italic>n</italic> determines how steep the response gets as particles approach one another.</p>
        <p>Finally, in very confined flows, it is useful to consider also self-cell interactions that ensure that the membrane does not self-overlap. To this end we can again use the particle-based soft-sphere potential.</p>
      </sec>
    </sec>
    <sec id="sec012">
      <title>Model calibration and validation</title>
      <p>The model of cell flow has been validated in terms of comparison to analytical and experimental data.</p>
      <p>The calibration of RBC elastic parameters was done using the cell stretching experiment described in [<xref rid="pcbi.1008249.ref033" ref-type="bibr">33</xref>]. The detailed procedure of calibration and discussion about suitable values of parameters are available in [<xref rid="pcbi.1008249.ref034" ref-type="bibr">34</xref>].</p>
      <p>The fluid-structure interaction in the numerical model is represented by a dissipative coupling parameter. The calibration of this numerical parameter was done in [<xref rid="pcbi.1008249.ref035" ref-type="bibr">35</xref>].</p>
      <p>Red blood cells exhibit rich behavioral patterns in a shear flow. Under certain flow conditions, a red blood cell in shear flow may tumble or exhibit a tank-treading motion of the membrane, depending on the shear rate [<xref rid="pcbi.1008249.ref036" ref-type="bibr">36</xref>]. We have investigated the inclination angle in [<xref rid="pcbi.1008249.ref039" ref-type="bibr">39</xref>] and confirmed that our model corresponds to the experimental measurements of the inclination angle reported in [<xref rid="pcbi.1008249.ref040" ref-type="bibr">40</xref>]. Further, in [<xref rid="pcbi.1008249.ref034" ref-type="bibr">34</xref>] we performed computational experiments of tank-treading frequency also reproducing the experimental results and thus validating the model.</p>
    </sec>
    <sec id="sec013">
      <title>Design principles</title>
      <p>The model is implemented in the open source software ESPResSo [<xref rid="pcbi.1008249.ref041" ref-type="bibr">41</xref>] as a module called PyOIF [<xref rid="pcbi.1008249.ref042" ref-type="bibr">42</xref>]. The computational core of ESPResSo and PyOIF is written in C++ and provides efficient calculations of fluid flow and deformations of elastic objects on both desktop machines and high performance clusters. The users write simulation scripts in Python, which gives them great flexibility while keeping the code clean and simple.</p>
      <p>ESPResSo is a widely used simulation package for research on soft matter, originally developed in 2004 [<xref rid="pcbi.1008249.ref043" ref-type="bibr">43</xref>] for coarse-grained simulations of charged systems based on particle formulation. Later in 2006 it was extended with lattice-Boltzmann solver for hydrodynamic problems [<xref rid="pcbi.1008249.ref044" ref-type="bibr">44</xref>] and over the years, functionality such as rigid body mechanics and a lattice-Boltzmann solver running on graphics processors have been added [<xref rid="pcbi.1008249.ref045" ref-type="bibr">45</xref>]. This setting was ideal for the next step: Grouping particles into objects representing e.g. cells immersed in a fluid, thus creating PyOIF.</p>
      <p>The predecessor of PyOIF was OIF framework [<xref rid="pcbi.1008249.ref046" ref-type="bibr">46</xref>] implemented in Tcl scripting language. OIF was an implementation of a simplified computational model of red blood cells [<xref rid="pcbi.1008249.ref028" ref-type="bibr">28</xref>]. This model has some modelling issues such as triangle annihilation and non-force-free and non-torque-free calculation of elastic forces. Since its introduction, the model has evolved and these issues have been thoroughly discussed and solved in [<xref rid="pcbi.1008249.ref030" ref-type="bibr">30</xref>, <xref rid="pcbi.1008249.ref032" ref-type="bibr">32</xref>] and the force calculations for three out of five elastic moduli have been changed.</p>
      <p>During the year 2018, the ESPResSo package itself underwent a significant transition from Tcl scripting interface to Python. The main changes have been reported in [<xref rid="pcbi.1008249.ref041" ref-type="bibr">41</xref>]. This was not a merely a translation from one computer language to another, but rather a comprehensive refactoring and restructuring of the whole code base. We followed this transition and we restructured the underlying computational model for cells accordingly. This work resulted in the new Python module PyOIF and involved a completely new object-oriented design that also brought greater memory and computational efficiency.</p>
      <p>The best features of the module are its flexibility, extensibility, documentation and simplicity of user input.</p>
      <p><italic>Flexibility</italic> lies in the possibility of setting various computational geometries (including flat or rough walls, periodic obstacle arrays, different cross-sections of microchannels, narrow constrictions). Further, different types of deformable objects (e.g. cells) can be modelled by adapting the elasticity parameters.</p>
      <p><italic>Extensibility</italic> of the module manifests in at several levels. For example, new deformable objects can be introduced by defining their surface triangulation and their elastic or rigid properties. Another example could include more advanced models of cells including their inner structure. Also, the existing classes may be easily extended with further functionality involving analysis of the object’s deformation. An advanced user may consider the development of new concepts covering e.g. cell adhesion to surfaces or creation of cell clusters.</p>
      <p><italic>Documentation</italic> provides detailed description of the underlying classes as well as case studies of the module usage. The project webpage features examples of different cell types, different geometries, etc. The book [<xref rid="pcbi.1008249.ref030" ref-type="bibr">30</xref>] uses the PyOIF module to illustrate various concepts and while it cannot directly serve as a documentation material, it contains detailed explanations and derivation of the underlying model.</p>
      <p><italic>Simplicity</italic> of user input is documented by commented python script available as supplementary material <xref ref-type="supplementary-material" rid="pcbi.1008249.s001">S1 Script</xref>.</p>
    </sec>
    <sec id="sec014">
      <title>General workflow</title>
      <p>When performing a simulation, we need to first prepare the surface triangulations of all types of objects that enter the simulation. These can be prepared using various software packages, e.g. Gmsh [<xref rid="pcbi.1008249.ref047" ref-type="bibr">47</xref>].</p>
      <p>In the simulation script we specify the geometry of the domain (size of the simulation box, walls, obstacles), flow conditions (fluid density, viscosity, flow direction, flow velocity), cell types of all objects (e.g. red blood cells, larger spherical cells with their size, relaxed shape, elasticity), individual cells (position, rotation), their interactions (cell-fluid, cell-wall, cell-cell, self-cell if needed).</p>
      <p>Then follows the integration loop, which in addition to the propagation of cells typically includes data output both for visualisation and subsequent analysis.</p>
      <p>The simulation script is run by calling the pypresso binary with the script as an argument and may take user defined optional parameters as further input. These parameters are typically the variables of the performed simulation study. During the execution of the python script, the individual commands are parsed and call the corresponding C++ methods. This combination of languages provides user-friendly python interface together with efficient computational C++ core.</p>
      <p>Development, preparation and testing of simulation scripts is done on a desktop machine or a laptop, but larger simulation studies are typically performed using HPC clusters. The PyOIF implementation relies on mpi framework for parallelisation. Proper parallelisation can significantly decrease the computational time. For more information and practical usage we refer the user to the documentation [<xref rid="pcbi.1008249.ref048" ref-type="bibr">48</xref>].</p>
    </sec>
    <sec id="sec015">
      <title>Classes and architecture</title>
      <p>The elastic forces that govern the behavior of the cell membrane imply the basic elements of the computational representation of the cell model, depicted in left bottom part of <xref ref-type="fig" rid="pcbi.1008249.g001">Fig 1</xref>: nodes, edges, triangles and angles. Each of these elements is described by a class, depicted in the right part of <xref ref-type="fig" rid="pcbi.1008249.g001">Fig 1</xref>.</p>
      <p>The class <monospace>Angle</monospace> represents two triangles that share an edge, i.e. it carries information about four nodes. This is useful for two reasons. Firstly, one of the five elastic moduli that we use—the bending force—preserves the angle between two neighboring triangles and thus can use instances of this class to calculate the acting bending forces. And secondly, in order to reduce the number of loops necessary to evaluate the elastic forces, we combine the calculation of all the local forces into one loop over the angles. When looking at a particular angle, besides the bending, the stretching force is calculated for the edge shared by the two triangles and local area forces are calculated for the triangles themselves.</p>
      <p>The implementation includes two different types of nodes: <monospace>FixedPoint</monospace> and <monospace>PartPoint</monospace>. This allows us to create first an abstract <monospace>Mesh</monospace> (using instances of <monospace>FixedPoint</monospace>), which carries information about the object geometry and properties in relaxed state and is represented by <monospace>OifCellType</monospace>. This information can then be shared by all instances of <monospace>OifCell</monospace> that have the same properties, but differ in current positions and deformations. Their <monospace>Mesh</monospace>es are then created as modified copies of the pre-calculated <monospace>OifCellType</monospace> mesh, but this time with instances of <monospace>PartPoint</monospace> that have mass and can move in the computational domain.</p>
      <p>All interactions happen point-wise. These include cell-wall interactions modeled using the built-in <monospace>soft-sphere</monospace> potentials at points that get closer to boundaries than a pre-defined threshold.</p>
      <p>For cell-cell interactions we developed the <monospace>membrane-collision</monospace> potential [<xref rid="pcbi.1008249.ref049" ref-type="bibr">49</xref>]. These interactions calculate the current outer normals for pairs of nodes that belong to two cells that are close to each other. Depending on the relative orientation of the two normals a phenomenological repulsive forces are applied to the nodes. The calibration of this interaction is described in [<xref rid="pcbi.1008249.ref050" ref-type="bibr">50</xref>].</p>
      <p>In confined flows or in other situations when the cells undergo very large deformations, different parts of membrane might get close or in extreme cases even intersect due to the local nature of the model. To prevent such unphysical behavior, it is possible to include the self-cell interactions as repulsive <monospace>soft-sphere</monospace> potentials. The <monospace>OifCell</monospace> class then allows specification of neighbor exclusions so that the potential is not applied to the nearest points on the mesh.</p>
    </sec>
    <sec id="sec016">
      <title>Input-output</title>
      <p>The initial geometry including the shape and size in the relaxed state of one cell (or another object) is specified by two input files: <monospace>nodes.dat</monospace> and <monospace>triangles.dat</monospace>. The first file contains triplets of floats (one triplet per line), where each triplet represents the <italic>x</italic>, <italic>y</italic> and <italic>z</italic> coordinates of one node of the surface triangulation. The order of the triplets defines IDs of the mesh points. The second file contains triplets of numbers, this time integers. These refer to the IDs of the nodes in <monospace>nodes.dat</monospace> file and specify which three nodes form a triangle together. The documentation available at [<xref rid="pcbi.1008249.ref042" ref-type="bibr">42</xref>] contains further information on how the <monospace>OifCellType</monospace> ensures that the triangles are properly oriented.</p>
      <p>The typical output are user-defined data files (.txt, .dat) that contain information about positions, velocities and other properties of cells that can be post-processed and analyzed.</p>
      <p>The second type of output, using the method <monospace>cell.output_vtk_pos</monospace>, is a .vtk file for visualisation. The PyOIF module allows the user to perform mesh analysis of any elastic object during the simulation. It includes information about acting forces or other local properties, which can also be included in the .vtk output files. Boundaries, walls and fluid can also be saved in .vtk files.</p>
    </sec>
    <sec id="sec017">
      <title>Units scaling</title>
      <p>In ESPResSo, no units are predefined. The user needs to choose a scaling (for example time, length and energy scale) and all other remaining units are derived from these primary choices. For further details on units in ESPResSo we refer to [<xref rid="pcbi.1008249.ref048" ref-type="bibr">48</xref>], Section Introduction.</p>
      <p>Since PyOIF is built upon the core of ESPResSo, we adopt this notion and define the time scale in microseconds, the length scale in microns and the mass scale in 10<sup>−15</sup>
<italic>kg</italic>. The units of other physical quantities used in simulations, such as pressure or force, can be derived as proper combinations of the time, length and mass units. In the following, we refer to all these scaled physical quantities as lattice units. Also the numerical values of parameters in the example script are listed in the lattice unit system. We use the SI unit system when referring to the values of parameters measured in biomedical experiments.</p>
      <p>With the lattice unit system, the order of magnitude of relevant parameters in our simulations is generally from 10<sup>−3</sup> to 10<sup>3</sup>. However, this is not the only correct way how to set the unit system, and it depends strongly on dimensions and the nature of the simulated phenomenon. Other examples of the unit systems can be found in [<xref rid="pcbi.1008249.ref030" ref-type="bibr">30</xref>].</p>
    </sec>
    <sec id="sec018">
      <title>Analysis and visualisation</title>
      <p>There are two basic types of output from PyOIF. One serves for visualisation and typically consists of .vtk files that can be visualised using the software ParaView [<xref rid="pcbi.1008249.ref051" ref-type="bibr">51</xref>]. If the data is in the form of a time series, it can also be exported as a video.</p>
      <p>The second type involves quantitative data that is post-processed and analysed. The PyOIF module offers various methods to provide this data. Some of them describe the current geometry of the cell, such as <monospace>min_edge_length()</monospace>, <monospace>max_edge_length()</monospace>, <monospace>aver_edge_length()</monospace>, <monospace>surface()</monospace>, <monospace>volume()</monospace>, <monospace>diameter()</monospace>. Others are related to the cell location and dynamics, such as <monospace>get_origin()</monospace>, <monospace>get_approx_origin()</monospace>, <monospace>get_velocity()</monospace>, <monospace>pos_bounds()</monospace>. And yet another provides information about local stresses: <monospace>elastic_forces(parameters)</monospace>. User can easily add new methods to access cell-related information.</p>
    </sec>
    <sec id="sec019">
      <title>Geometry considerations</title>
      <p>The default configuration of the simulation domain is a box with periodic boundary conditions in all three dimensions. Obstacles are typically simple geometric shapes, e.g. 3-dimensional rhomboids or cylinders. The combination of the periodic boundary conditions of the box and the immersed obstacles allows us to model microfluidic devices with infinite periodic arrays of obstacles. More complex obstacle structures can be modeled by superposition of simpler shapes that may also overlap.</p>
      <p>In principle, it is possible to simulate domains that are not periodic, but it requires further thought. In non-periodic domains it might be necessary to re-seed the cells that exit the computational domain and place them at another location (possibly rotated) so that they can enter the domain again as in e.g. [<xref rid="pcbi.1008249.ref052" ref-type="bibr">52</xref>]. This can be done by the built-in methods for saving the mesh nodes and then using the saved nodes to recreate the cells.</p>
    </sec>
    <sec id="sec020">
      <title>Extensibility</title>
      <p>To demonstrate how a new feature may be implemented in PyOIF, let us assume that we need to identify a location on a cell’s surface where the membrane is currently bent the most. Such feature is not included in PyOIF at this time. In geometric terms, this means that the angle between two neighbouring triangles in such spot is an outlier from the relaxed state. In the relaxed state, most angles are close to <italic>π</italic> radians. Therefore, the outliers will be either close to zero or close to 2<italic>π</italic> radians. In the former case, the membrane is bent in such a way that it is locally convex, while in the latter case it is locally concave. In what follows, we consider the locally convex case identifying the minimal angle in the mesh. The other case could be implemented in a similar manner.</p>
      <p>To demonstrate the simplicity of the needed code, let us implement a new method <monospace>min_angle</monospace> for the class <monospace>Mesh</monospace>. The loop over the angles gives us the minimal angle and the IDs of four points forming the two neighbouring triangles. Then the minimal angle is returned together with the IDs.</p>
      <p>
        <monospace>class Mesh(object):</monospace>
      </p>
      <p>
        <monospace>  def min_angle(self):</monospace>
      </p>
      <p>
        <monospace>    min_angle = 2*numpy.pi</monospace>
      </p>
      <p>
        <monospace>    ids = []</monospace>
      </p>
      <p>
        <monospace>    for angle in self.angles:</monospace>
      </p>
      <p>
        <monospace>      alpha = angle.size()</monospace>
      </p>
      <p>
        <monospace>      if (alpha &lt; min_angle):</monospace>
      </p>
      <p>
        <monospace>        min_angle = alpha</monospace>
      </p>
      <p>
        <monospace>        ids = [angle.A.get_part_id(),angle.B.get_part_id(),</monospace>
      </p>
      <p>
        <monospace>            angle.C.get_part_id(),angle.D.get_part_id()]</monospace>
      </p>
      <p>
        <monospace>    return [min_angle,ids]</monospace>
      </p>
    </sec>
  </sec>
  <sec sec-type="results" id="sec021">
    <title>Results</title>
    <p>To demonstrate the PyOIF capabilities, we present an illustrative case—a simulation of cell flow in bifurcations. It includes a study of cell distribution in the channel. We focus on the explicit details of the simulation script to highlight the connection between the scripting commands and physical setting, as well as on demonstrating how the model can be used to analyse the behavior of many cells in flow.</p>
    <p>Besides this case, the PyOIF module has already been used in several application areas. In [<xref rid="pcbi.1008249.ref053" ref-type="bibr">53</xref>] we have modelled the flow of blood with circulating tumor cells in periodic obstacle arrays. We stated how the density of red cells influences the probability of tumor cell capture. Recently, we have analysed blood cell damage in specific geometries and we developed an indicator for it—the cell damage index [<xref rid="pcbi.1008249.ref052" ref-type="bibr">52</xref>].</p>
    <p>The PyOIF has been further used by external research groups for evaluation of VAD rotatory blood pumps [<xref rid="pcbi.1008249.ref054" ref-type="bibr">54</xref>], for analysis of micro-roughness and its consequences for platelets activation and platelet catching [<xref rid="pcbi.1008249.ref055" ref-type="bibr">55</xref>, <xref rid="pcbi.1008249.ref056" ref-type="bibr">56</xref>], for simulation of magnetic active polymers for versatile microfluidic devices [<xref rid="pcbi.1008249.ref057" ref-type="bibr">57</xref>]. Recently, the PyOIF module has been used to investigate the equilibrium structure and quasi-static deformational response of a magnetic polymersome, a hollow object whose magnetoactive part is its shell [<xref rid="pcbi.1008249.ref058" ref-type="bibr">58</xref>].</p>
    <sec id="sec022">
      <title>Cell flow in a bifurcation</title>
      <p>There are two basic types of bifurcations: a partition of a single flow channel into two daughter branches or a confluence of two flow channels into one.</p>
      <p>The diverging bifurcations are responsible for non-uniform partitioning of red blood cells within the network [<xref rid="pcbi.1008249.ref061" ref-type="bibr">61</xref>]. While there are quantitative data available on the RBC velocity and flux in the daughter branches and it is known that the RBCs have the tendency to enter the daughter branch with the higher flow rate (Zweifach-Fung effect), in some cases an inversion of this effect was observed [<xref rid="pcbi.1008249.ref062" ref-type="bibr">62</xref>], so further investigation is needed.</p>
      <p>The converging bifurcations are helpful in controlling the concentration of cells at a given position across the width of a channel and thus also need to be considered in the process of design of microfluidic devices.</p>
      <p>The PyOIF module allows us to include different types of cells in a single simulation. In [<xref rid="pcbi.1008249.ref067" ref-type="bibr">67</xref>] we modeled a channel that included both a diverging and a converging bifurcation, see <xref ref-type="fig" rid="pcbi.1008249.g002">Fig 2</xref>, and observed the effect of a single larger stiffer cell (e.g. a white blood cell or a circulating tumor cell) on the RBC flow. The commented script <monospace>cell_flow_in_bifurcation.py</monospace> is provided as part of the supplementary material <xref ref-type="supplementary-material" rid="pcbi.1008249.s001">S1 Script</xref>.</p>
      <fig id="pcbi.1008249.g002" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pcbi.1008249.g002</object-id>
        <label>Fig 2</label>
        <caption>
          <title>Distribution of red blood cells in daughter branches and after the confluence.</title>
          <p>The histograms indicate <italic>y</italic>-coordinates of RBC centers as the cells crossed the <italic>x</italic> = 75<italic>μm</italic> and <italic>x</italic> = 130<italic>μm</italic> positions. The ratio of sizes of daughter branches is 1:2 in case A and 2:3 in case B. In the two cases on the left, there were 40 red blood cells (<italic>Ht</italic> ≈ 4%) and in the two cases on the right, there were 60 red blood cells (<italic>Ht</italic> ≈ 6%). The indicated dimensions are in micrometers. The height of the channel was <italic>h</italic> = 20<italic>μm</italic>.</p>
        </caption>
        <graphic xlink:href="pcbi.1008249.g002"/>
      </fig>
      <sec id="sec023">
        <title>Simulation parameters</title>
        <p>The simulated domain was a periodic channel with bifurcation into two daughter branches that later converge together. The width of the primary channel was <italic>w</italic><sub><italic>p</italic></sub> = 30<italic>μm</italic>. For the two daughter branches (denoted upper and lower), we considered a symmetric case (C: <italic>w</italic><sub><italic>u</italic></sub> = <italic>w</italic><sub><italic>l</italic></sub> = 15<italic>μm</italic>) and two asymmetric cases. In one of them the ratio of sizes of daughter branches was 1:2 (A: <italic>w</italic><sub><italic>u</italic></sub> = 10<italic>μm</italic>, <italic>w</italic><sub><italic>l</italic></sub> = 20<italic>μm</italic>) and in the other 2:3 (B: <italic>w</italic><sub><italic>u</italic></sub> = 12<italic>μm</italic>, <italic>w</italic><sub><italic>l</italic></sub> = 18<italic>μm</italic>).</p>
        <p>The RBCs in this simulation have a discocyte shape. They are represented by their membranes. The membrane of red blood cell is characterized by its shear modulus, area compression modulus and bending modulus. For the shear modulus we used the value <italic>μ</italic><sub>0</sub> = 5.5<italic>μNm</italic><sup>−1</sup> from the review paper [<xref rid="pcbi.1008249.ref059" ref-type="bibr">59</xref>]. For the area expansion modulus we worked with <italic>K</italic> = 0.025<italic>mNm</italic><sup>−1</sup> obtained by dynamic membrane fluctuations [<xref rid="pcbi.1008249.ref060" ref-type="bibr">60</xref>]. The value of bending modulus was calculated using the biological value <italic>k</italic><sub><italic>c</italic></sub> = 1.15 × 10<sup>−19</sup>
<italic>Nm</italic> from [<xref rid="pcbi.1008249.ref059" ref-type="bibr">59</xref>]. The simulation parameters corresponding to <italic>μ</italic><sub>0</sub>, <italic>K</italic> and <italic>k</italic><sub><italic>c</italic></sub> are <monospace>k_s, k_b, k_al</monospace>. The correspondence is however not direct. The linking of PyOIF elastic parameters to the mechanical properties of cell membrane is described in detail in [<xref rid="pcbi.1008249.ref034" ref-type="bibr">34</xref>]. We use values (in lattice units)
<disp-formula id="pcbi.1008249.e020"><alternatives><graphic xlink:href="pcbi.1008249.e020.jpg" id="pcbi.1008249.e020g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M20"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mrow><mml:mi mathvariant="monospace">k</mml:mi><mml:mo>_</mml:mo><mml:mi mathvariant="monospace">s</mml:mi><mml:mspace width="3.33333pt"/><mml:mo>=</mml:mo><mml:mspace width="3.33333pt"/><mml:mn mathvariant="monospace">0</mml:mn><mml:mo>.</mml:mo><mml:mn mathvariant="monospace">005</mml:mn></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:mi mathvariant="monospace">k</mml:mi><mml:mo>_</mml:mo><mml:mi mathvariant="monospace">b</mml:mi><mml:mspace width="3.33333pt"/><mml:mo>=</mml:mo><mml:mspace width="3.33333pt"/><mml:mn mathvariant="monospace">0</mml:mn><mml:mo>.</mml:mo><mml:mn mathvariant="monospace">02</mml:mn></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:mi mathvariant="monospace">k</mml:mi><mml:mo>_</mml:mo><mml:mi mathvariant="monospace">a</mml:mi><mml:mi mathvariant="monospace">l</mml:mi><mml:mspace width="3.33333pt"/><mml:mo>=</mml:mo><mml:mspace width="3.33333pt"/><mml:mn mathvariant="monospace">0</mml:mn><mml:mo>.</mml:mo><mml:mn mathvariant="monospace">007</mml:mn><mml:mo>.</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives></disp-formula></p>
        <p>To ensure that surface and volume of the simulated red blood cell remains fairly constant, we use <monospace>k_ag = 0.7</monospace>, <monospace>k_v = 0.9</monospace> (in lattice units). For the physical quantities we use standard scaling described in Section Design and implementation.</p>
        <p>The definition of CellType is done using the <monospace>oif.OifCellType</monospace> command which takes several parameters, e.g. the mesh files and the size and elastic parameters of the cell. The cell can be scaled in each of the three dimensions using the parameter <monospace>resize</monospace>.</p>
        <p>To set the correct interaction between the fluid and the particles (forming the spring network) we have to set the frictional coupling parameter <italic>γ</italic>. In case we only have one type of cells in the simulation, we can use the <monospace>suggest_LBgamma</monospace> method of the <monospace>oif.OifCell</monospace> class that returns the value of <italic>γ</italic> linked to the specific cell based on the analysis from [<xref rid="pcbi.1008249.ref035" ref-type="bibr">35</xref>]. All types of cells we might want to add to the simulation need to conform to the same <italic>γ</italic> setting. The way to do that is to discretise all new cell types in such a way that the meshes have similar density.</p>
        <p>The main integration loop contains outputs for the cell and fluid visualization, integration command containing number of timesteps performed on the C++ level without coming back to the Python level, and the necessary calculations and outputs for the post-processing.</p>
        <p>In this simulation, the radius of red blood cells was 3.91<italic>μm</italic> and they were represented by meshes with 374 nodes.</p>
        <p>In the following we discuss simulations with 40 cells (<italic>Ht</italic> ≈ 4%) and with 60 cells (<italic>Ht</italic> ≈ 6%). Each of these was repeated 10 times with a different random initial seeding of cells. The results are aggregated into six cases by geometry and hematocrit: A40, A60, B40, B60, C40, C60.</p>
        <p>The stiffer larger cell was spherical with radius 7.5<italic>μm</italic> and in all cases, it was seeded at the center of the parent channel. From the analysis of the dissipative coupling parameter <italic>γ</italic>, the discretisation of this cell resulted in 642 mesh nodes.</p>
        <p>The dynamic viscosity of the fluid was 1.5<italic>mPa s</italic>, the density 1000<italic>kgm</italic><sup>−3</sup>. The stabilized fluid velocity at the center of the parent channel was 1.3 × 10<sup>−3</sup>
<italic>ms</italic><sup>−1</sup> similar to the value reported in [<xref rid="pcbi.1008249.ref065" ref-type="bibr">65</xref>].</p>
      </sec>
      <sec id="sec024">
        <title>Observations</title>
        <p>We can observe the distribution of red blood cells in the daughter branches.</p>
        <p>As expected, the wider branches receive a larger proportion of red blood cells and we observe a fairly equal split when the daughter branches have the same width, <xref ref-type="fig" rid="pcbi.1008249.g003">Fig 3</xref>. We compare the situations when the rare cell is in the parent branch to the situation when it is inside the daughter branch. In the latter case, for larger hematocrit, the narrow/wider split is more pronounced. For smaller hematocrit values, we see a slight shift both ways, which may indicate that the random seeding influences the split more than the flow itself.</p>
        <fig id="pcbi.1008249.g003" orientation="portrait" position="float">
          <object-id pub-id-type="doi">10.1371/journal.pcbi.1008249.g003</object-id>
          <label>Fig 3</label>
          <caption>
            <title>Percentage split of RBCs as they enter the daughter branches.</title>
            <p>(a) The <italic>out</italic> column shows the situation when the rare cell is in the parent channel and the <italic>in</italic> column when the rare cell is in the daughter channel. (b) Comparison of geometries and hematocrits. In the C cases, where both daughter branches have equal width, the one reported as wider is the one the rare cell entered.</p>
          </caption>
          <graphic xlink:href="pcbi.1008249.g003"/>
        </fig>
        <p>When looking at red blood cells in the asymmetric bifurcations, we observe that they tend to travel closer to the wall towards the wider branch, see <xref ref-type="fig" rid="pcbi.1008249.g002">Fig 2</xref>. The histograms of <italic>y</italic>-coordinates of cell centers shown at <italic>x</italic> = 75<italic>μm</italic> (middle of the daughter branch) indicate that the cells are the closer to the <italic>right</italic> wall (with respect to the direction of the flow). The double peak distribution in the wider branch is due to the presence of the spherical rare cell. While it travels through the branch, the red blood cells <italic>try to squeeze past it</italic> on the sides.</p>
        <p>In addition to local elastic stresses, it is possible to calculate an approximation of fluid force acting on a single red blood cell as a difference between the mesh node velocity and fluid velocity at the mesh node position, summed over all mesh nodes.</p>
        <p>Besides quantitative observation, visual inspection of the cell flow may bring additional insights. We present a video of the cell flow as supplementary material <xref ref-type="supplementary-material" rid="pcbi.1008249.s002">S1 Video</xref>.</p>
        <p>During the simulation, <monospace>OifCell</monospace> class offers numerous observables such as cell’s surface, volume, diameter, different stresses on the surface etc. For a complete list we refer to the PyOIF User Guide. Such data may give valuable insight into the studied problem. To demonstrate this, in <xref ref-type="fig" rid="pcbi.1008249.g004">Fig 4</xref> we present plots from one particular simulation representing the time evolution of the cell’s data. From this kind of quantitative output we can for example notice the following interesting observation:</p>
        <fig id="pcbi.1008249.g004" orientation="portrait" position="float">
          <object-id pub-id-type="doi">10.1371/journal.pcbi.1008249.g004</object-id>
          <label>Fig 4</label>
          <caption>
            <title>Quantitative characteristics of cells in bifurcation.</title>
            <p>The horizontal axis shows the <italic>x</italic>-coordinate of the cell’s center of mass. The cell’s surface, diameter and rotation angle during the first pass (purple line), the second pass (green line) and the third pass (blue line) through the bifurcation are shown on the <italic>y</italic>-axis. First row: data for the red blood cell passing through the narrower top branch, second row: data for the red blood cell passing through the wider bottom branch. The bifurcation depicted as a background image helps to link the data to the spatial location of the cell inside the channel.</p>
          </caption>
          <graphic xlink:href="pcbi.1008249.g004"/>
        </fig>
        <p>A red blood cell in the narrower branch is less deformed than the one in the wider branch. Indeed, the surface, diameter and volume for the top branch cell oscillates less than for the cell in the bottom branch. This could be counter-intuitive, since the wider branch suggests lower deformation. The explanation lies in the velocity difference: The fluid flows more slowly in top branch than in the bottom branch. This results in lower shear flow in the top branch and thus lower deformation.</p>
        <p>We can also observe bulk properties of simulated cells, such as hematocrit shown in <xref ref-type="fig" rid="pcbi.1008249.g005">Fig 5</xref> and compare different initial conditions. In this case we looked at uniform seeding of 100 red blood cells in which the elastic properties of all cells corresponded to those calibrated by the stretching experiment and at mixed seeding, in which half of the cells were significantly stiffer. The stiffer cells may represent those affected by disease, e.g. malaria.</p>
        <fig id="pcbi.1008249.g005" orientation="portrait" position="float">
          <object-id pub-id-type="doi">10.1371/journal.pcbi.1008249.g005</object-id>
          <label>Fig 5</label>
          <caption>
            <title>Hematocrit in the main parent channel and two daughter branches averaged over 10ms.</title>
            <p>In the uniform seeding, all red blood cells had the same elastic properties as calibrated using the stretching experiment. In the mixed seeding, the cells were placed at the same starting positions, but randomly selected half of them were significantly stiffer.</p>
          </caption>
          <graphic xlink:href="pcbi.1008249.g005"/>
        </fig>
        <p>In both cases, the cells were seeded at the same positions, but the seeding was not spatially-homogeneous, i.e. there was a cell-free spherical area in the main channel that gradually dissipated. In the uniform seeding chart we can observe the complementary oscillations of hematocrit values in the parent channel and the wider lower branch, as the cell-free area moves with the flow until it dissipates.</p>
        <p>Interestingly, with the mixed seeding the hematocrit values stabilize sooner than with the uniform seeding. Observations such as this one can serve as a starting point for further investigation of how blood properties influence flow in various geometries.</p>
      </sec>
      <sec id="sec025">
        <title>Time complexity</title>
        <p>In this section we present an overview of the CPU time for this simulation. All the simulations were run on CPUs of a Threadripper 2950X machine with 16 cores and 32 logical processors with 32 GB RAM and 1x Samsung 970 Evo NVME SSD.</p>
        <p>To show the scalability of the computations, we performed test simulations with various numbers of cells on various numbers of computational cores. We used 0, 5, 10, 20, 40 and 60 cells and we parallelized the computation onto 1, 3, 5, 6, and 10 cores by splitting the simulation box in <italic>x</italic> or in both <italic>x</italic> and <italic>y</italic> directions. <xref rid="pcbi.1008249.t001" ref-type="table">Table 1</xref> shows the CPU time in seconds for simulating 0.1 <italic>ms</italic> of the cell flow averaged over 2<italic>ms</italic>. The data in the parentheses show the CPU time devoted to one blood cell. It was computed by subtracting the CPU time for fluid only from the respective CPU time for <italic>n</italic> cells and fluid, divided by <italic>n</italic>. In this simulation, the fluid was discretized with spatial grid of 1<italic>μm</italic> and each RBC had 374 mesh nodes.</p>
        <table-wrap id="pcbi.1008249.t001" orientation="portrait" position="float">
          <object-id pub-id-type="doi">10.1371/journal.pcbi.1008249.t001</object-id>
          <label>Table 1</label>
          <caption>
            <title>CPU times in seconds for different number of cores and number of cells for 1000 simulation time steps which correspond to 0.1<italic>ms</italic> of cell flow.</title>
            <p>The corresponding time per one blood cell is given in parentheses. The reference simulation is in bold.</p>
          </caption>
          <alternatives>
            <graphic id="pcbi.1008249.t001g" xlink:href="pcbi.1008249.t001"/>
            <table frame="box" rules="all" border="0">
              <colgroup span="1">
                <col align="left" valign="middle" span="1"/>
                <col align="left" valign="middle" span="1"/>
                <col align="left" valign="middle" span="1"/>
                <col align="left" valign="middle" span="1"/>
                <col align="left" valign="middle" span="1"/>
                <col align="left" valign="middle" span="1"/>
                <col align="left" valign="middle" span="1"/>
              </colgroup>
              <thead>
                <tr>
                  <th align="left" rowspan="1" colspan="1"/>
                  <th align="center" rowspan="1" colspan="1"/>
                  <th align="center" rowspan="1" colspan="1"/>
                  <th align="center" rowspan="1" colspan="1">n_cells</th>
                  <th align="center" rowspan="1" colspan="1"/>
                  <th align="center" rowspan="1" colspan="1"/>
                  <th align="center" rowspan="1" colspan="1"/>
                </tr>
                <tr>
                  <th align="left" rowspan="1" colspan="1">n_proc</th>
                  <th align="center" rowspan="1" colspan="1">0</th>
                  <th align="center" rowspan="1" colspan="1">5</th>
                  <th align="center" rowspan="1" colspan="1">10</th>
                  <th align="center" rowspan="1" colspan="1">20</th>
                  <th align="center" rowspan="1" colspan="1">40</th>
                  <th align="center" rowspan="1" colspan="1">60</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td align="left" rowspan="1" colspan="1">1</td>
                  <td align="char" char="." rowspan="1" colspan="1">48.14</td>
                  <td align="center" rowspan="1" colspan="1">55.90 (1.55)</td>
                  <td align="center" rowspan="1" colspan="1">62.68 (1.45)</td>
                  <td align="center" rowspan="1" colspan="1">84.37 (1.81)</td>
                  <td align="center" rowspan="1" colspan="1">145.00 (2.42)</td>
                  <td align="center" rowspan="1" colspan="1">242.47 (3.23)</td>
                </tr>
                <tr>
                  <td align="left" rowspan="1" colspan="1">3</td>
                  <td align="char" char="." rowspan="1" colspan="1">17.40</td>
                  <td align="center" rowspan="1" colspan="1">21.27 (0.77)</td>
                  <td align="center" rowspan="1" colspan="1">22.70 (0.53)</td>
                  <td align="center" rowspan="1" colspan="1">32.14 (0.74)</td>
                  <td align="center" rowspan="1" colspan="1">53.56 (0.90)</td>
                  <td align="center" rowspan="1" colspan="1">93.56 (1.26)</td>
                </tr>
                <tr>
                  <td align="left" rowspan="1" colspan="1">5</td>
                  <td align="char" char="." rowspan="1" colspan="1">12.79</td>
                  <td align="center" rowspan="1" colspan="1">16.88 (0.81)</td>
                  <td align="center" rowspan="1" colspan="1">19.13 (0.63)</td>
                  <td align="center" rowspan="1" colspan="1">23.78 (0.55)</td>
                  <td align="center" rowspan="1" colspan="1">37.35 (0.61)</td>
                  <td align="center" rowspan="1" colspan="1">58.97 (0.76)</td>
                </tr>
                <tr>
                  <td align="left" rowspan="1" colspan="1">6</td>
                  <td align="char" char="." rowspan="1" colspan="1">11.02</td>
                  <td align="center" rowspan="1" colspan="1">14.82 (0.76)</td>
                  <td align="center" rowspan="1" colspan="1">15.98 (0.49)</td>
                  <td align="center" rowspan="1" colspan="1">22.90 (0.0.59)</td>
                  <td align="center" rowspan="1" colspan="1">
                    <bold>36.04 (0.62)</bold>
                  </td>
                  <td align="center" rowspan="1" colspan="1">53.31 (0.70)</td>
                </tr>
                <tr>
                  <td align="left" rowspan="1" colspan="1">10</td>
                  <td align="char" char="." rowspan="1" colspan="1">8.31</td>
                  <td align="center" rowspan="1" colspan="1">11.61 (0.66)</td>
                  <td align="center" rowspan="1" colspan="1">13.96 (0.56)</td>
                  <td align="center" rowspan="1" colspan="1">18.31 (0.50)</td>
                  <td align="center" rowspan="1" colspan="1">26.67 (0.45)</td>
                  <td align="center" rowspan="1" colspan="1">40.22 (0.53)</td>
                </tr>
              </tbody>
            </table>
          </alternatives>
        </table-wrap>
        <p>From the table we can clearly see that increasing the number of processors decreases the CPU time and increasing the number of cells increases the CPU time. We calculated the parallel efficiency <italic>E</italic> and in <xref ref-type="fig" rid="pcbi.1008249.g006">Fig 6</xref> we depict the values <italic>E</italic> = <italic>S</italic>/<italic>N</italic>, where <italic>S</italic> is the speed-up ratio <italic>S</italic> = <italic>T</italic><sub>1</sub>/<italic>T</italic><sub><italic>N</italic></sub>, <italic>N</italic> is the number of computational cores and <italic>T</italic><sub><italic>N</italic></sub> is the CPU time for simulation with <italic>N</italic> computational cores. We can see that parallel efficiency drops with the increasing number of cores to around 60% with 10 cores.</p>
        <fig id="pcbi.1008249.g006" orientation="portrait" position="float">
          <object-id pub-id-type="doi">10.1371/journal.pcbi.1008249.g006</object-id>
          <label>Fig 6</label>
          <caption>
            <title>Parallel efficiency of the code.</title>
          </caption>
          <graphic xlink:href="pcbi.1008249.g006"/>
        </fig>
        <p>To provide the reference time consumption, we measured the time needed to simulate one pass of the rare cell through the bifurcation channel which amounts to approximately 138<italic>ms</italic> of flow. With the <italic>x</italic>-distance 150<italic>μm</italic> traveled by the rare cell, this leads to the average velocity of 1.085<italic>mm</italic>/<italic>s</italic>. The reference simulation was parallelized onto 6 cores and took 16 hours.</p>
      </sec>
    </sec>
  </sec>
  <sec id="sec026">
    <title>Availability and future directions</title>
    <p>Since the PyOIF module is part of the ESPResSo package, it is available from the github repository [<xref rid="pcbi.1008249.ref071" ref-type="bibr">71</xref>] forked from the main ESPResSo branch [<xref rid="pcbi.1008249.ref072" ref-type="bibr">72</xref>] and it is distributed under the terms of the GNU General Public Licence. The ESPResSo code is developed and maintained primarily at the Institute for Computational Physics of the University of Stuttgart, Germany, but has contributors from all over the world. The PyOIF is developed and maintained at Cell-in-fluid Biomedical Modelling and Computations Group [<xref rid="pcbi.1008249.ref073" ref-type="bibr">73</xref>] at University of Zilina, Slovakia. We are open to cooperation with other contributors who would like to add new features to the PyOIF module. Their work would be integrated into the main package using the same processes as the current developers use, i.e. pull requests to review new features and bug fixes.</p>
    <p>The community actively uses two mailinglists: <email>espressomd-devel@nongnu.org</email> for developers and <email>espressomd-users@nongnu.org</email> for users. Both work on a subscription basis, are archived and are a good starting point and resource for anybody who wants to actively use or develop this computational tool. The questions related to PyOIF module are typically answered by its developers who are actively using it. There has also been development of new features per users’ requests.</p>
    <p>The source code available at the repository contains sample examples with simple simulations of cells. More advanced examples involving cell random seeding, testing of cell-wall interactions, stretching tests of red blood cells are available at PyOIF webpage [<xref rid="pcbi.1008249.ref042" ref-type="bibr">42</xref>]. We strongly recommend following the steps in the user guide to install PyOIF. And as any scientific software, this module should not be used as a black box. The users should be familiar with the underlying model and meaning of the parameters they use.</p>
    <p>Currently, there are two features under development:</p>
    <list list-type="bullet">
      <list-item>
        <p>Inclusion of the cell nucleus: While not applicable to red blood cells which do not posses one, this will allow us to model other type of cells. Two different approaches are being evaluated, one using bonded and one using non-bonded potentials [<xref rid="pcbi.1008249.ref074" ref-type="bibr">74</xref>].</p>
      </list-item>
      <list-item>
        <p>Variable viscosity: Currently, both the fluid and the inside of immersed objects have the same (constant) viscosity. In blood, this is not the case. The blood plasma has about five times lower viscosity than the fluid inside the red blood cells. We are implementing an option that would allow setting a different viscosity inside the immersed objects [<xref rid="pcbi.1008249.ref075" ref-type="bibr">75</xref>].</p>
      </list-item>
    </list>
    <p>The near-future plans include the development of a checkpointing system that would allow saving the the complete state of an elastic object. Currently, we can save and reconstruct the geometry, but not the acting forces, which introduces certain inaccuracy when re-seeding cells.</p>
    <p>To conclude, PyOIF is a user-friendly powerful computational tool that has already been successfully used for simulations of blood flow in microfluidic devices and can be used for predictive simulations of elastic objects in flow. We hope that it will become a valuable resource both for computational and experimental biomedical community.</p>
  </sec>
  <sec sec-type="supplementary-material" id="sec027">
    <title>Supporting information</title>
    <supplementary-material content-type="local-data" id="pcbi.1008249.s001">
      <label>S1 Script</label>
      <caption>
        <title>Commented simulation script, including input files.</title>
        <p>(ZIP)</p>
      </caption>
      <media xlink:href="pcbi.1008249.s001.zip">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pcbi.1008249.s002">
      <label>S1 Video</label>
      <caption>
        <title>Video of cell flow through bifurcation.</title>
        <p>(MP4)</p>
      </caption>
      <media xlink:href="pcbi.1008249.s002.mp4">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <ack>
    <p>We thank Martin Slavík for his contribution to the rewriting of the Tcl code into Python and all the members of the Cif-BMCG research group for extensive testing of PyOIF.</p>
  </ack>
  <ref-list>
    <title>References</title>
    <ref id="pcbi.1008249.ref001">
      <label>1</label>
      <mixed-citation publication-type="journal"><name><surname>Vernekar</surname><given-names>R</given-names></name>, <name><surname>Krueger</surname><given-names>T</given-names></name>, <name><surname>Loutherback</surname><given-names>K</given-names></name>, <name><surname>Morton</surname><given-names>K</given-names></name>, <name><surname>Inglis</surname><given-names>D</given-names></name>. <article-title>Anisotropic permeability in deterministic lateral displacement arrays</article-title>. <source>Lab on a Chip</source>. <year>2017</year>;<volume>17</volume>:<fpage>3318</fpage>–<lpage>3330</lpage>. <pub-id pub-id-type="doi">10.1039/C7LC00785J</pub-id><?supplied-pmid 28861573?><pub-id pub-id-type="pmid">28861573</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008249.ref002">
      <label>2</label>
      <mixed-citation publication-type="journal"><name><surname>Zhai</surname><given-names>Y</given-names></name>, <name><surname>Wang</surname><given-names>A</given-names></name>, <name><surname>Koh</surname><given-names>D</given-names></name>, <name><surname>Schneidera</surname><given-names>P</given-names></name>, <name><surname>Oh</surname><given-names>KW</given-names></name>. <article-title>A robust, portable and backflow-free micromixing device based on both capillary- and vacuum-driven flow</article-title>. <source>Lab on a Chip</source>. <year>2018</year>;<volume>18</volume>(<issue>2</issue>):<fpage>276</fpage>–<lpage>284</lpage>. <pub-id pub-id-type="doi">10.1039/C7LC01077J</pub-id><?supplied-pmid 29199733?><pub-id pub-id-type="pmid">29199733</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008249.ref003">
      <label>3</label>
      <mixed-citation publication-type="journal"><name><surname>Pamme</surname><given-names>N</given-names></name>. <article-title>Continuous flow separations in microfluidic devices</article-title>. <source>Lab on a Chip</source>. <year>2007</year>;<volume>7</volume>:<fpage>1644</fpage>–<lpage>1659</lpage>. <pub-id pub-id-type="doi">10.1039/b712784g</pub-id><pub-id pub-id-type="pmid">18030382</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008249.ref004">
      <label>4</label>
      <mixed-citation publication-type="journal"><name><surname>Brodland</surname><given-names>G</given-names></name>. <article-title>Computational modeling of cell sorting, tissue engulfment, and related phenomena: A review</article-title>. <source>Applied Mechanics Reviews</source>. <year>2004</year>;<volume>57</volume>(<issue>1</issue>):<fpage>47</fpage>–<lpage>76</lpage>. <pub-id pub-id-type="doi">10.1115/1.1583758</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008249.ref005">
      <label>5</label>
      <mixed-citation publication-type="book"><name><surname>Gompper</surname><given-names>G</given-names></name>, <name><surname>Schick</surname><given-names>M</given-names></name>. <source>Soft matter: Lipid bilayers and red blood cells</source>. <publisher-name>Wiley</publisher-name>; <year>2008</year>.</mixed-citation>
    </ref>
    <ref id="pcbi.1008249.ref006">
      <label>6</label>
      <mixed-citation publication-type="journal"><name><surname>Pozrikidis</surname><given-names>C</given-names></name>. <article-title>Effect of membrane bending stiffness on the deformation of capsules in simple shear flow</article-title>. <source>Journal of Fluid Mechanics</source>. <year>2001</year>;<volume>440</volume>:<fpage>269</fpage>–<lpage>291</lpage>. <pub-id pub-id-type="doi">10.1017/S0022112001004657</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008249.ref007">
      <label>7</label>
      <mixed-citation publication-type="journal"><name><surname>Li</surname><given-names>H</given-names></name>, <name><surname>Lykotrafitis</surname><given-names>G</given-names></name>. <article-title>Erythrocyte membrane model with explicit description of the lipid bilayer and the spectrin network</article-title>. <source>Biophysical Journal</source>. <year>2014</year>;<volume>107</volume>(<issue>3</issue>):<fpage>642</fpage>–<lpage>653</lpage>. <pub-id pub-id-type="doi">10.1016/j.bpj.2014.06.031</pub-id><?supplied-pmid 25099803?><pub-id pub-id-type="pmid">25099803</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008249.ref008">
      <label>8</label>
      <mixed-citation publication-type="journal"><name><surname>Li</surname><given-names>J</given-names></name>, <name><surname>Dao</surname><given-names>M</given-names></name>, <name><surname>Lim</surname><given-names>CT</given-names></name>, <name><surname>Suresh</surname><given-names>S</given-names></name>. <article-title>Spectrin-level modeling of the cytoskeleton and optical tweezers stretching of the erythrocyte</article-title>. <source>Biophysical Journal</source>. <year>2005</year>;<volume>88</volume>:<fpage>3707</fpage>–<lpage>3719</lpage>. <pub-id pub-id-type="doi">10.1529/biophysj.104.047332</pub-id><?supplied-pmid 15749778?><pub-id pub-id-type="pmid">15749778</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008249.ref009">
      <label>9</label>
      <mixed-citation publication-type="journal"><name><surname>Saiz</surname><given-names>L</given-names></name>, <name><surname>Bandyopadhyay</surname><given-names>S</given-names></name>, <name><surname>Klein</surname><given-names>ML</given-names></name>. <article-title>Towards an understanding of complex biological membranes from atomistic molecular dynamics simulations</article-title>. <source>Bioscience Reports</source>. <year>2002</year>;<volume>22</volume>:<fpage>151</fpage>–<lpage>173</lpage>. <pub-id pub-id-type="doi">10.1023/A:1020130420869</pub-id><?supplied-pmid 12428899?><pub-id pub-id-type="pmid">12428899</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008249.ref010">
      <label>10</label>
      <mixed-citation publication-type="journal"><name><surname>Fedosov</surname><given-names>DA</given-names></name>, <name><surname>Caswell</surname><given-names>B</given-names></name>, <name><surname>Karniadakis</surname><given-names>GE</given-names></name>. <article-title>A multiscale red blood cell model with accurate mechanics, rheology and dynamics</article-title>. <source>Biophysical Journal</source>. <year>2010</year>;<volume>98</volume>(<issue>10</issue>):<fpage>2215</fpage>–<lpage>2225</lpage>. <pub-id pub-id-type="doi">10.1016/j.bpj.2010.02.002</pub-id><?supplied-pmid 20483330?><pub-id pub-id-type="pmid">20483330</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008249.ref011">
      <label>11</label>
      <mixed-citation publication-type="journal"><name><surname>Pivkin</surname><given-names>IV</given-names></name>, <name><surname>Karniadakis</surname><given-names>GE</given-names></name>. <article-title>Accurate coarse-grained modeling of red blood cells</article-title>. <source>Physical Review Letters</source>. <year>2008</year>;<volume>101</volume><pub-id pub-id-type="doi">10.1103/PhysRevLett.101.118105</pub-id><?supplied-pmid 18851338?><pub-id pub-id-type="pmid">18851338</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008249.ref012">
      <label>12</label>
      <mixed-citation publication-type="journal"><name><surname>Zhang</surname><given-names>J</given-names></name>. <article-title>Lattice Boltzmann method for microfluidics: Models and applications</article-title>. <source>Microfluidics and Nanofluidics</source>. <year>2011</year>;<volume>10</volume>:<fpage>1</fpage>–<lpage>28</lpage>. <pub-id pub-id-type="doi">10.1007/s10404-010-0624-1</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008249.ref013">
      <label>13</label>
      <mixed-citation publication-type="journal"><name><surname>Peskin</surname><given-names>CS</given-names></name>. <article-title>Numerical analysis of blood flow in the heart</article-title>. <source>Journal of Computational Physics</source>. <year>1977</year>;<volume>25</volume>:<fpage>220</fpage>–<lpage>252</lpage>. <pub-id pub-id-type="doi">10.1016/0021-9991(77)90100-0</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008249.ref014">
      <label>14</label>
      <mixed-citation publication-type="journal"><name><surname>Krueger</surname><given-names>T</given-names></name>, <name><surname>Varnik</surname><given-names>F</given-names></name>, <name><surname>Raabe</surname><given-names>D</given-names></name>. <article-title>Efficient and accurate simulations of deformable particles immersed in a fluid using a combined immersed boundary lattice Boltzmann finite element method</article-title>. <source>Computers and Mathematics with Applications</source>. <year>2011</year>;<volume>61</volume>:<fpage>3485</fpage>–<lpage>3505</lpage>. <pub-id pub-id-type="doi">10.1016/j.camwa.2010.03.057</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008249.ref015">
      <label>15</label>
      <mixed-citation publication-type="journal"><name><surname>Tsubota</surname><given-names>K</given-names></name>, <name><surname>Wada</surname><given-names>S</given-names></name>. <article-title>Elastic force of red blood cell membrane during tank-treading motion: Consideration of the membrane’s natural state</article-title>. <source>International Journal of Mechanical Sciences</source>. <year>2010</year>;<volume>52</volume>:<fpage>356</fpage>–<lpage>364</lpage>. <pub-id pub-id-type="doi">10.1016/j.ijmecsci.2009.10.007</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008249.ref016">
      <label>16</label>
      <mixed-citation publication-type="journal"><name><surname>Gekle</surname><given-names>S</given-names></name>. <article-title>Strongly accelerated margination of active particles in blood flow</article-title>. <source>Biophysical Journal</source>. <year>2016</year>;<volume>110</volume>:<fpage>514</fpage>–<lpage>520</lpage>. <pub-id pub-id-type="doi">10.1016/j.bpj.2015.12.005</pub-id><?supplied-pmid 26789773?><pub-id pub-id-type="pmid">26789773</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008249.ref017">
      <label>17</label>
      <mixed-citation publication-type="journal"><name><surname>Ye</surname><given-names>H</given-names></name>, <name><surname>Shen</surname><given-names>Z</given-names></name>, <name><surname>Li</surname><given-names>Y</given-names></name>. <article-title>Computational modeling of magnetic particle margination within blood flow through LAMMPS</article-title>. <source>Computational Mechanics</source>. <year>2018</year>;<volume>62</volume>(<issue>3</issue>):<fpage>457</fpage>–<lpage>476</lpage>.</mixed-citation>
    </ref>
    <ref id="pcbi.1008249.ref018">
      <label>18</label>
      <mixed-citation publication-type="journal"><name><surname>Plimpton</surname><given-names>S</given-names></name>. <article-title>Fast parallel algorithms for short-range molecular dynamics</article-title>. <source>Journal of Computational Physics</source>. <year>1995</year>;<volume>117</volume>(<issue>1</issue>):<fpage>1</fpage>–<lpage>19</lpage>. <pub-id pub-id-type="doi">10.1006/jcph.1995.1039</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008249.ref019">
      <label>19</label>
      <mixed-citation publication-type="journal"><name><surname>Tan</surname><given-names>J</given-names></name>, <name><surname>Sinno</surname><given-names>TR</given-names></name>, <name><surname>Diamond</surname><given-names>SL</given-names></name>. <article-title>A parallel fluid-solid coupling model using LAMMPS and Palabos based on the immersed boundary method</article-title>. <source>Journal of Computational Science</source>. <year>2018</year>;<volume>25</volume>:<fpage>89</fpage>–<lpage>100</lpage>. <pub-id pub-id-type="doi">10.1016/j.jocs.2018.02.006</pub-id><?supplied-pmid 30220942?><pub-id pub-id-type="pmid">30220942</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008249.ref020">
      <label>20</label>
      <mixed-citation publication-type="other">Latt J. Palabos, parallel lattice Boltzmann solver; 2019. Available from: <ext-link ext-link-type="uri" xlink:href="http://www.palabos.org">http://www.palabos.org</ext-link>.</mixed-citation>
    </ref>
    <ref id="pcbi.1008249.ref021">
      <label>21</label>
      <mixed-citation publication-type="other">Krueger T. Personal website; 2019. Available from: <ext-link ext-link-type="uri" xlink:href="http://www.timm-krueger.de/downloads.html">http://www.timm-krueger.de/downloads.html</ext-link>.</mixed-citation>
    </ref>
    <ref id="pcbi.1008249.ref022">
      <label>22</label>
      <mixed-citation publication-type="journal"><name><surname>Blumers</surname><given-names>AL</given-names></name>, <name><surname>Tang</surname><given-names>YH</given-names></name>, <name><surname>Li</surname><given-names>Z</given-names></name>, <name><surname>Li</surname><given-names>XJ</given-names></name>, <name><surname>Karniadakis</surname><given-names>GE</given-names></name>. <article-title>GPU-accelerated red blood cells simulations with transport dissipative particle dynamics</article-title>. <source>Computer Physics Communications</source>. <year>2017</year>;<volume>217</volume>:<fpage>171</fpage>–<lpage>179</lpage>. <pub-id pub-id-type="doi">10.1016/j.cpc.2017.03.016</pub-id><?supplied-pmid 29104303?><pub-id pub-id-type="pmid">29104303</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008249.ref023">
      <label>23</label>
      <mixed-citation publication-type="journal"><name><surname>Fedosov</surname><given-names>DA</given-names></name>, <name><surname>Caswell</surname><given-names>B</given-names></name>, <name><surname>Karniadakis</surname><given-names>GE</given-names></name>. <article-title>Wall shear stress-based model for adhesive dynamics of red blood cells in malaria</article-title>. <source>Biophysical Journal</source>. <year>2011</year>;<volume>100</volume>:<fpage>2084</fpage>–<lpage>2093</lpage>. <pub-id pub-id-type="doi">10.1016/j.bpj.2011.03.027</pub-id><?supplied-pmid 21539775?><pub-id pub-id-type="pmid">21539775</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008249.ref024">
      <label>24</label>
      <mixed-citation publication-type="journal"><name><surname>Tang</surname><given-names>YH</given-names></name>, <name><surname>Lu</surname><given-names>L</given-names></name>, <name><surname>Li</surname><given-names>H</given-names></name>, <name><surname>Evangelinos</surname><given-names>C</given-names></name>, <name><surname>Grinberg</surname><given-names>L</given-names></name>, <name><surname>Sachdeva</surname><given-names>V</given-names></name>, <etal>et al</etal><article-title>OpenRBC: A fast simulator of red blood cells at protein resolution</article-title>. <source>Biophysical Journal</source>. <year>2017</year>;<volume>112</volume>:<fpage>2030</fpage>–<lpage>2037</lpage>. <pub-id pub-id-type="doi">10.1016/j.bpj.2017.04.020</pub-id><?supplied-pmid 28538143?><pub-id pub-id-type="pmid">28538143</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008249.ref025">
      <label>25</label>
      <mixed-citation publication-type="other">Zavodszky G, van Rooij B, Azizi V, Alowayyed S, Hoekstra A. Hemocell: A high-performance microscopic cellular library. In: Procedia Computer Science 108C, International Conference on Computational Science, ICCS 2017, 12-14 June 2017, Zurich, Switzerland; 2017. p. 159–165.</mixed-citation>
    </ref>
    <ref id="pcbi.1008249.ref026">
      <label>26</label>
      <mixed-citation publication-type="journal"><name><surname>Mountrakis</surname><given-names>L</given-names></name>, <name><surname>Lorenz</surname><given-names>E</given-names></name>, <name><surname>Malaspinas</surname><given-names>O</given-names></name>, <name><surname>Alowayyed</surname><given-names>S</given-names></name>, <name><surname>Chopard</surname><given-names>B</given-names></name>, <name><surname>Hoekstra</surname><given-names>AG</given-names></name>. <article-title>Parallel performance of an IB-LBM suspension simulation framework</article-title>. <source>Journal of Computational Science</source>. <year>2015</year>;<volume>9</volume>:<fpage>45</fpage>–<lpage>50</lpage>. <pub-id pub-id-type="doi">10.1016/j.jocs.2015.04.006</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008249.ref027">
      <label>27</label>
      <mixed-citation publication-type="journal"><name><surname>Ahlrichs</surname><given-names>P</given-names></name>, <name><surname>Dunweg</surname><given-names>B</given-names></name>. <article-title>Lattice-Boltzmann simulation of polymer-solvent systems</article-title>. <source>International Journal of Modern Physics C</source>. <year>1998</year>;<volume>8</volume>:<fpage>1429</fpage>–<lpage>1438</lpage>. <pub-id pub-id-type="doi">10.1142/S0129183198001291</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008249.ref028">
      <label>28</label>
      <mixed-citation publication-type="journal"><name><surname>Cimrák</surname><given-names>I</given-names></name>, <name><surname>Gusenbauer</surname><given-names>M</given-names></name>, <name><surname>Schrefl</surname><given-names>T</given-names></name>. <article-title>Modelling and simulation of processes in microfluidic devices for biomedical applications</article-title>. <source>Computers and Mathematics with Applications</source>. <year>2012</year>;<volume>64</volume>(<issue>3</issue>):<fpage>278</fpage>–<lpage>288</lpage>. <pub-id pub-id-type="doi">10.1016/j.camwa.2012.01.062</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008249.ref029">
      <label>29</label>
      <mixed-citation publication-type="journal"><name><surname>Krueger</surname><given-names>T</given-names></name>, <name><surname>Holmes</surname><given-names>D</given-names></name>, <name><surname>Coveney</surname><given-names>PV</given-names></name>. <article-title>Deformability-based red blood cell separation in deterministic lateral displacement devices—A simulation study</article-title>. <source>Biomicrofluidics</source>. <year>2014</year>;<volume>8</volume>(<issue>5</issue>):<fpage>054114</fpage><pub-id pub-id-type="doi">10.1063/1.4897913</pub-id><pub-id pub-id-type="pmid">25584112</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008249.ref030">
      <label>30</label>
      <mixed-citation publication-type="book"><name><surname>Cimrák</surname><given-names>I</given-names></name>, <name><surname>Jančigová</surname><given-names>I</given-names></name>. <source>Computational Blood Cell Mechanics</source>. <edition>1st ed</edition><publisher-name>CRC Press</publisher-name>; <year>2018</year>.</mixed-citation>
    </ref>
    <ref id="pcbi.1008249.ref031">
      <label>31</label>
      <mixed-citation publication-type="journal"><name><surname>Helfrich</surname><given-names>W</given-names></name>. <article-title>Elastic properties of lipid bilayers: Theory and possible experiments</article-title>. <source>Zeitschrift f ur Naturforschung C</source>. <year>1973</year>;<volume>28</volume>:<fpage>693</fpage>–<lpage>703</lpage>. <pub-id pub-id-type="doi">10.1515/znc-1973-11-1209</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008249.ref032">
      <label>32</label>
      <mixed-citation publication-type="journal"><name><surname>Jančigová</surname><given-names>I</given-names></name>, <name><surname>Cimrák</surname><given-names>I</given-names></name>. <article-title>Non-uniform force allocation for area preservation in spring network models</article-title>. <source>International Journal for Numerical Methods in Biomedical Engineering</source>. <year>2016</year>;<volume>32</volume>(<issue>10</issue>):<fpage>e02757</fpage><pub-id pub-id-type="doi">10.1002/cnm.2757</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008249.ref033">
      <label>33</label>
      <mixed-citation publication-type="journal"><name><surname>Dao</surname><given-names>M</given-names></name>, <name><surname>Li</surname><given-names>J</given-names></name>, <name><surname>Suresh</surname><given-names>S</given-names></name>. <article-title>Molecularly based analysis of deformation of spectrin network and human erythrocyte</article-title>. <source>Materials Science and Engineering C</source>. <year>2006</year>;<volume>26</volume>:<fpage>1232</fpage>–<lpage>1244</lpage>. <pub-id pub-id-type="doi">10.1016/j.msec.2005.08.020</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008249.ref034">
      <label>34</label>
      <mixed-citation publication-type="journal"><name><surname>Jančigová</surname><given-names>I</given-names></name>, <name><surname>Kovalčíková</surname><given-names>K</given-names></name>, <name><surname>Bohiniková</surname><given-names>A</given-names></name>, <name><surname>Cimrák</surname><given-names>I</given-names></name>. <article-title>Spring-network model of red blood cell: From membrane mechanics to validation</article-title>. <source>International Journal for Numerical Methods in Fluids</source>. <year>2020</year>; <volume>2020</volume>;<volume>92</volume>(<issue>10</issue>):<fpage>1368</fpage>–<lpage>1393</lpage>. <pub-id pub-id-type="doi">10.1002/fld.4832</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008249.ref035">
      <label>35</label>
      <mixed-citation publication-type="journal"><name><surname>Bušík</surname><given-names>M</given-names></name>, <name><surname>Slavík</surname><given-names>M</given-names></name>, <name><surname>Cimrák</surname><given-names>I</given-names></name>. <article-title>Dissipative coupling of fluid and immersed objects for modelling of cells in flow</article-title>. <source>Computational and Mathematical Methods in Medicine</source>. <year>2018</year>;<volume>2018</volume>:<fpage>7842857</fpage><pub-id pub-id-type="doi">10.1155/2018/7842857</pub-id><?supplied-pmid 30363716?><pub-id pub-id-type="pmid">30363716</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008249.ref036">
      <label>36</label>
      <mixed-citation publication-type="journal"><name><surname>Nakamura</surname><given-names>M</given-names></name>, <name><surname>Bessho</surname><given-names>S</given-names></name>, <name><surname>Wada</surname><given-names>S</given-names></name>. <article-title>Spring network based model of a red blood cell for simulating mesoscopic blood flow</article-title>. <source>International Journal for Numerical Methods in Biomedical Engineering</source>. <year>2013</year>;<volume>29</volume>(<issue>1</issue>):<fpage>114</fpage>–<lpage>128</lpage>. <pub-id pub-id-type="doi">10.1002/cnm.2501</pub-id><?supplied-pmid 23293072?><pub-id pub-id-type="pmid">23293072</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008249.ref037">
      <label>37</label>
      <mixed-citation publication-type="journal"><name><surname>Fischer</surname><given-names>TM</given-names></name>. <article-title>Tank-tread frequency of the red cell membrane: Dependence on the viscosity of the suspending medium</article-title>. <source>Biophysics Journal</source>. <year>2007</year>;<volume>93</volume>:<fpage>2553</fpage>–<lpage>2561</lpage>. <pub-id pub-id-type="doi">10.1529/biophysj.107.104505</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008249.ref038">
      <label>38</label>
      <mixed-citation publication-type="journal"><name><surname>Tran-Son-Tay</surname><given-names>R</given-names></name>, <name><surname>Sutera</surname><given-names>SP</given-names></name>, <name><surname>Rao</surname><given-names>PR</given-names></name>. <article-title>Determination of red blood cell membrane viscosity from rheoscopic observations of tank-treading motion</article-title>. <source>Biophysical Journal</source>. <year>1984</year>;<volume>46</volume>(<issue>1</issue>):<fpage>65</fpage>–<lpage>72</lpage>. <pub-id pub-id-type="doi">10.1016/S0006-3495(84)83999-5</pub-id><?supplied-pmid 6743758?><pub-id pub-id-type="pmid">6743758</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008249.ref039">
      <label>39</label>
      <mixed-citation publication-type="other">Cimrák I. Effect of dissipative coupling parameter in a computational model on the inclination angle of red blood cells in a shear flow. In: Proceedings of the 9th International Conference on Computational Systems-Biology and Bioinformatics. CSBio 2018. KMUTT. New York, NY, USA: ACM; 2018. p. 11:1–11:5.</mixed-citation>
    </ref>
    <ref id="pcbi.1008249.ref040">
      <label>40</label>
      <mixed-citation publication-type="journal"><name><surname>Fischer</surname><given-names>T</given-names></name>, <name><surname>Korzeniewski</surname><given-names>R</given-names></name>. <article-title>Angle of inclination of tank-treading red cells: Dependence on shear rate and suspending medium</article-title>. <source>Biophysical Journal</source>. <year>2015</year>;<volume>108</volume>(<issue>6</issue>):<fpage>1352</fpage>–<lpage>1360</lpage>. <pub-id pub-id-type="doi">10.1016/j.bpj.2015.01.028</pub-id><?supplied-pmid 25809249?><pub-id pub-id-type="pmid">25809249</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008249.ref041">
      <label>41</label>
      <mixed-citation publication-type="journal"><name><surname>Weik</surname><given-names>F</given-names></name>, <name><surname>Weeber</surname><given-names>R</given-names></name>, <name><surname>Szuttor</surname><given-names>K</given-names></name>, <name><surname>Breitsprecher</surname><given-names>K</given-names></name>, <name><surname>de Graaf</surname><given-names>J</given-names></name>, <name><surname>Kuron</surname><given-names>M</given-names></name>, <etal>et al</etal><article-title>ESPResSo 4.0—An extensible software package for simulating soft matter systems</article-title>. <source>The European Physical Journal Special Topics</source>. <year>2019</year>;<volume>227</volume>(<issue>14</issue>):<fpage>1789</fpage>–<lpage>1816</lpage>. <pub-id pub-id-type="doi">10.1140/epjst/e2019-800186-9</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008249.ref042">
      <label>42</label>
      <mixed-citation publication-type="other">PyOIF: Computational tool for modelling of multi-cell flows in complex geometries. Resources webpage for PyOIF; January, 2020, <ext-link ext-link-type="uri" xlink:href="http://www.pyoif.eu">http://www.pyoif.eu</ext-link>.</mixed-citation>
    </ref>
    <ref id="pcbi.1008249.ref043">
      <label>43</label>
      <mixed-citation publication-type="other">Arnold A, Mann BA, Limbach HJ, Holm C. ESPResSo—An extensible simulation package for research on soft matter systems. In: Kremer K, Macho V, editors. Forschung und wissenschaftliches, Rechnen 2003, GWDG-Bericht, vol. 63, Gesellschaft fur wissenschaftliche Datenverarbeitung mbh, Gottingen, Germany. vol. 63; 2004. p. 43–59.</mixed-citation>
    </ref>
    <ref id="pcbi.1008249.ref044">
      <label>44</label>
      <mixed-citation publication-type="journal"><name><surname>Limbach</surname><given-names>HJ</given-names></name>, <name><surname>Arnold</surname><given-names>A</given-names></name>, <name><surname>Mann</surname><given-names>BA</given-names></name>, <name><surname>Holm</surname><given-names>C</given-names></name>. <article-title>ESPResSo—An extensible simulation package for research on soft matter systems</article-title>. <source>Computer Physics Communications</source>. <year>2006</year>;<volume>174</volume>(<issue>9</issue>):<fpage>704</fpage>–<lpage>727</lpage>. <pub-id pub-id-type="doi">10.1016/j.cpc.2005.10.005</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008249.ref045">
      <label>45</label>
      <mixed-citation publication-type="other">Arnold A, Lenz O, Kesselheim S, Weeber R, Fahrenberger F, Roehm D, et al. ESPResSo 3.1—Molecular dynamics software for coarse–grained models. In: Griebel M, Schweitzer MA, editors. Meshfree Methods for Partial Differential Equations VI, Lecture Notes in Computational Science and Engineering. vol. 89; 2013. p. 1–23.</mixed-citation>
    </ref>
    <ref id="pcbi.1008249.ref046">
      <label>46</label>
      <mixed-citation publication-type="journal"><name><surname>Cimrák</surname><given-names>I</given-names></name>, <name><surname>Gusenbauer</surname><given-names>M</given-names></name>, <name><surname>Jančigová</surname><given-names>I</given-names></name>. <article-title>An ESPResSo implementation of elastic objects immersed in a fluid</article-title>. <source>Computer Physics Communications</source>. <year>2014</year>;<volume>185</volume>(<issue>3</issue>):<fpage>900</fpage>–<lpage>907</lpage>. <pub-id pub-id-type="doi">10.1016/j.cpc.2013.12.013</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008249.ref047">
      <label>47</label>
      <mixed-citation publication-type="journal"><name><surname>Geuzaine</surname><given-names>C</given-names></name>, <name><surname>Remacle</surname><given-names>JF</given-names></name>. <article-title>Gmsh: a three-dimensional finite element mesh generator with built-in pre- and post-processing facilities</article-title>. <source>International Journal for Numerical Methods in Engineering</source>. <year>2009</year>;<volume>79</volume>(<issue>11</issue>):<fpage>1309</fpage>–<lpage>1331</lpage>. <pub-id pub-id-type="doi">10.1002/nme.2579</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008249.ref048">
      <label>48</label>
      <mixed-citation publication-type="other">Holm C, Arnold A, Lenz O, Kesselheim S. ESPResSo documentation; 2018.</mixed-citation>
    </ref>
    <ref id="pcbi.1008249.ref049">
      <label>49</label>
      <mixed-citation publication-type="other">Jančigová I. Modeling elastic objects in fluid flow with biomedical applications. University of Žilina; 2015.</mixed-citation>
    </ref>
    <ref id="pcbi.1008249.ref050">
      <label>50</label>
      <mixed-citation publication-type="other">Smiešková M, Bachratá K, Guimaraes IM. Calibration of cell-cell interactions in fluid flow for the simulation model. Proceedings of Experimental fluid mechanics 2019. preprint.</mixed-citation>
    </ref>
    <ref id="pcbi.1008249.ref051">
      <label>51</label>
      <mixed-citation publication-type="book"><name><surname>Henderson</surname><given-names>A</given-names></name>. <source>ParaView guide, A parallel visualization application</source>. <publisher-name>Kitware Inc</publisher-name>; <year>2007</year>.</mixed-citation>
    </ref>
    <ref id="pcbi.1008249.ref052">
      <label>52</label>
      <mixed-citation publication-type="journal"><name><surname>Gusenbauer</surname><given-names>M</given-names></name>, <name><surname>Tóthová</surname><given-names>R</given-names></name>, <name><surname>Mazza</surname><given-names>G</given-names></name>, <name><surname>Brandl</surname><given-names>M</given-names></name>, <name><surname>Schrefl</surname><given-names>T</given-names></name>, <name><surname>Jančigová</surname><given-names>I</given-names></name>, <etal>et al</etal><article-title>Cell damage index as computational indicator for blood cell activation and damage</article-title>. <source>Artificial Organs</source>. <year>2018</year>;<volume>42</volume>(<issue>7</issue>):<fpage>746</fpage>–<lpage>755</lpage>. <pub-id pub-id-type="doi">10.1111/aor.13111</pub-id><?supplied-pmid 29608016?><pub-id pub-id-type="pmid">29608016</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008249.ref053">
      <label>53</label>
      <mixed-citation publication-type="journal"><name><surname>Bušík</surname><given-names>M</given-names></name>, <name><surname>Jančigová</surname><given-names>I</given-names></name>, <name><surname>Tóthová</surname><given-names>R</given-names></name>, <name><surname>Cimrák</surname><given-names>I</given-names></name>. <article-title>Simulation study of rare cell trajectories and capture rate in periodic obstacle arrays</article-title>. <source>Journal of Computational Science</source>. <year>2016</year>;<volume>17</volume>(<issue>2</issue>):<fpage>370</fpage>–<lpage>376</lpage>.</mixed-citation>
    </ref>
    <ref id="pcbi.1008249.ref054">
      <label>54</label>
      <mixed-citation publication-type="other">Studer A. Modeling red blood cell deformation in a rotary blood pump. ETH Zurich; 2016.</mixed-citation>
    </ref>
    <ref id="pcbi.1008249.ref055">
      <label>55</label>
      <mixed-citation publication-type="journal"><name><surname>Belyaev</surname><given-names>AV</given-names></name>. <article-title>Hydrodynamic repulsion of spheroidal microparticles from micro-rough surfaces</article-title>. <source>PLoS ONE</source>. <year>2017</year>;<volume>12</volume>(<issue>8</issue>):<fpage>e0183093</fpage><pub-id pub-id-type="doi">10.1371/journal.pone.0183093</pub-id><?supplied-pmid 28806767?><pub-id pub-id-type="pmid">28806767</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008249.ref056">
      <label>56</label>
      <mixed-citation publication-type="journal"><name><surname>Belyaev</surname><given-names>AV</given-names></name>. <article-title>Catching platelets from the bloodflow: the role of the conformation of von Willebrand factor</article-title>. <source>Mathematical Modelling of Natural Phenomena</source>. <year>2017</year>;<volume>13</volume>(<issue>8</issue>):ID 44.</mixed-citation>
    </ref>
    <ref id="pcbi.1008249.ref057">
      <label>57</label>
      <mixed-citation publication-type="other">Gusenbauer M, Ozelt H, Fischbacher J, Reichel F, Exl L, Bance S, et al. Simulation of magnetic active polymers for versatile microfluidic devices. EPJ Web of Conferences. 2013;40:ID 02001.</mixed-citation>
    </ref>
    <ref id="pcbi.1008249.ref058">
      <label>58</label>
      <mixed-citation publication-type="journal"><name><surname>Ryzhkov</surname><given-names>A</given-names></name>, <name><surname>Raikher</surname><given-names>Y</given-names></name>. <article-title>Coarse-grained molecular dynamics modelling of a magnetic polymersome</article-title>. <source>Nanomaterials</source>. <year>2018</year>;<volume>8</volume>(<issue>10</issue>). <pub-id pub-id-type="doi">10.3390/nano8100763</pub-id><?supplied-pmid 30261672?><pub-id pub-id-type="pmid">30261672</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008249.ref059">
      <label>59</label>
      <mixed-citation publication-type="journal"><name><surname>Tomaiuolo</surname><given-names>G</given-names></name>. <article-title>Biomechanical properties of red blood cells in health and disease towards microfluidics</article-title>. <source>Biomicrofluidics</source>. <year>2014</year>;<volume>8</volume>:<fpage>051501</fpage><pub-id pub-id-type="doi">10.1063/1.4895755</pub-id><?supplied-pmid 25332724?><pub-id pub-id-type="pmid">25332724</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008249.ref060">
      <label>60</label>
      <mixed-citation publication-type="journal"><name><surname>Park</surname><given-names>Y</given-names></name>, <name><surname>Best</surname><given-names>CA</given-names></name>, <name><surname>Kuriabova</surname><given-names>T</given-names></name>, <name><surname>Henle</surname><given-names>ML</given-names></name>, <name><surname>Feld</surname><given-names>MS</given-names></name>, <name><surname>Levine</surname><given-names>AJ</given-names></name>, <etal>et al</etal><article-title>Measurement of the nonlinear elasticity of red blood cell membranes</article-title>. <source>Physical Review E, Statistical, nonlinear, and soft matter physics</source>. <year>2011</year>;<volume>83</volume>(<issue>5</issue>). <pub-id pub-id-type="doi">10.1103/PhysRevE.83.051925</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008249.ref061">
      <label>61</label>
      <mixed-citation publication-type="journal"><name><surname>Medhi</surname><given-names>B</given-names></name>, <name><surname>Agrawal</surname><given-names>V</given-names></name>, <name><surname>Singh</surname><given-names>A</given-names></name>. <article-title>Experimental investigation of particle migration in suspension flow through bifurcating microchannels</article-title>. <source>American Institute of Chemical Engineers Journal</source>. <year>2018</year>;<volume>64</volume><pub-id pub-id-type="doi">10.1002/aic.16084</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008249.ref062">
      <label>62</label>
      <mixed-citation publication-type="journal"><name><surname>Clavica</surname><given-names>F</given-names></name>, <name><surname>Homsy</surname><given-names>A</given-names></name>, <name><surname>Jeandupeux</surname><given-names>L</given-names></name>, <name><surname>Obrist</surname><given-names>D</given-names></name>. <article-title>Red blood cell phase separation in symmetric and asymmetric microchannel networks: effect of capillary dilation and inflow velocity</article-title>. <source>Nature Scientific Report</source>. <year>2016</year>;<volume>6</volume>:<fpage>36763</fpage><pub-id pub-id-type="doi">10.1038/srep36763</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008249.ref063">
      <label>63</label>
      <mixed-citation publication-type="journal"><name><surname>Chuang</surname><given-names>C</given-names></name>, <name><surname>Kikuchi</surname><given-names>K</given-names></name>, <name><surname>Ueno</surname><given-names>H</given-names></name>. <article-title>Collective spreading of red blood cells flowing in a microchannel</article-title>. <source>Journal of Biomechanics</source>. <year>2018</year>;<volume>69</volume>:<fpage>64</fpage>–<lpage>69</lpage>. <pub-id pub-id-type="doi">10.1016/j.jbiomech.2018.01.009</pub-id><?supplied-pmid 29397999?><pub-id pub-id-type="pmid">29397999</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008249.ref064">
      <label>64</label>
      <mixed-citation publication-type="journal"><name><surname>Wang</surname><given-names>T</given-names></name>, <name><surname>Rongin</surname><given-names>U</given-names></name>, <name><surname>Xing</surname><given-names>Z</given-names></name>. <article-title>A micro-scale simulation of red blood cell passage through symmetric and asymmetric bifurcated vessels</article-title>. <source>Nature Scientific Reports</source>. <year>2016</year>;<volume>6</volume>:<fpage>20262</fpage><pub-id pub-id-type="doi">10.1038/srep20262</pub-id><?supplied-pmid 26830454?><pub-id pub-id-type="pmid">26830454</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008249.ref065">
      <label>65</label>
      <mixed-citation publication-type="journal"><name><surname>Ye</surname><given-names>T</given-names></name>, <name><surname>Peng</surname><given-names>L</given-names></name>, <name><surname>Li</surname><given-names>Y</given-names></name>. <article-title>Three-dimensional motion and deformation of a red blood cell in bifurcated microvessels</article-title>. <source>Journal of Applied Physics</source>. <year>2018</year>;<volume>123</volume>:<fpage>064701</fpage><pub-id pub-id-type="doi">10.1063/1.5013174</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008249.ref066">
      <label>66</label>
      <mixed-citation publication-type="journal"><name><surname>Balogh</surname><given-names>P</given-names></name>, <name><surname>Bagchi</surname><given-names>P</given-names></name>. <article-title>Analysis of red blood cell partitioning at bifurcations in simulated microvascular networks</article-title>. <source>Physics of Fluids</source>. <year>2018</year>;<volume>30</volume>:<fpage>051902</fpage><pub-id pub-id-type="doi">10.1063/1.5024783</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008249.ref067">
      <label>67</label>
      <mixed-citation publication-type="other">Jančigová I. Computational modeling of blood flow with rare cell in a microbifurcation. In: Computer Methods, Imaging and Visualization in Biomechanics and Biomedical Engineering. Taylor and Francis; 2020. p. 518–525.</mixed-citation>
    </ref>
    <ref id="pcbi.1008249.ref068">
      <label>68</label>
      <mixed-citation publication-type="journal"><name><surname>Krueger</surname><given-names>T</given-names></name>, <name><surname>Holmes</surname><given-names>D</given-names></name>, <name><surname>Coveney</surname><given-names>PV</given-names></name>. <article-title>Deformability-based red blood cell separation in deterministic lateral displacement devices—A simulation study</article-title>. <source>Biomicrofluidics</source>. <year>2014</year>;<volume>8</volume>(<issue>5</issue>).</mixed-citation>
    </ref>
    <ref id="pcbi.1008249.ref069">
      <label>69</label>
      <mixed-citation publication-type="journal"><name><surname>Gleghorn</surname><given-names>JP</given-names></name>, <name><surname>Smith</surname><given-names>JP</given-names></name>, <name><surname>Kirby</surname><given-names>BJ</given-names></name>. <article-title>Transport and collision dynamics in periodic asymmetric obstacle arrays: Rational design of microfluidic rare-cell immunocapture devices</article-title>. <source>Physical Review E</source>. <year>2013</year>;<volume>88</volume>:<fpage>032136</fpage><pub-id pub-id-type="doi">10.1103/PhysRevE.88.032136</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008249.ref070">
      <label>70</label>
      <mixed-citation publication-type="journal"><name><surname>Cimrák</surname><given-names>I</given-names></name>. <article-title>Collision rates for rare cell capture in periodic obstacle arrays strongly depend on density of cell suspension</article-title>. <source>Computer Methods in Biomechanics and Biomedical Engineering</source>. <year>2016</year>;<volume>19</volume>(<issue>14</issue>):<fpage>1525</fpage>–<lpage>1530</lpage>. <pub-id pub-id-type="doi">10.1080/10255842.2016.1165806</pub-id><?supplied-pmid 27023645?><pub-id pub-id-type="pmid">27023645</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008249.ref071">
      <label>71</label>
      <mixed-citation publication-type="other">Cimrák I. PyOIF release; 2020. <ext-link ext-link-type="uri" xlink:href="https://github.com/icimrak/espresso/releases/tag/pyoif-v2.0">https://github.com/icimrak/espresso/releases/tag/pyoif-v2.0</ext-link>.</mixed-citation>
    </ref>
    <ref id="pcbi.1008249.ref072">
      <label>72</label>
      <mixed-citation publication-type="other">Weik F, Weeber R, Szuttor K, Breitsprecher K, de Graaf J, Kuron M, et al. ESPResSo 4.1—An extensible software package for simulating soft matter systems; 2020. <ext-link ext-link-type="uri" xlink:href="https://github.com/espressomd/espresso/tree/4.1">https://github.com/espressomd/espresso/tree/4.1</ext-link>.</mixed-citation>
    </ref>
    <ref id="pcbi.1008249.ref073">
      <label>73</label>
      <mixed-citation publication-type="other">Cell-in-fluid Biomedical Modelling and Computation Group. Research group webpage; January, 2020, <ext-link ext-link-type="uri" xlink:href="http://cellinfluid.fri.uniza.sk">http://cellinfluid.fri.uniza.sk</ext-link>.</mixed-citation>
    </ref>
    <ref id="pcbi.1008249.ref074">
      <label>74</label>
      <mixed-citation publication-type="other">Bohiniková A. Computational modelling of elastic cells with nucleus. In: Proceedings of 6th International conference on Computational and mathematical biomedical engineering; 2019. p. 622–625.</mixed-citation>
    </ref>
    <ref id="pcbi.1008249.ref075">
      <label>75</label>
      <mixed-citation publication-type="other">Poštek T. Fluid dynamics model of cells with variable inner and outer fluid viscosity. In: Mathematics in science and technologies: Proceedings of the MIST conference 2019; 2019. p. 65–72.</mixed-citation>
    </ref>
  </ref-list>
</back>
<sub-article id="pcbi.1008249.r001" article-type="aggregated-review-documents">
  <front-stub>
    <article-id pub-id-type="doi">10.1371/journal.pcbi.1008249.r001</article-id>
    <title-group>
      <article-title>Decision Letter 0</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Schneidman-Duhovny</surname>
          <given-names>Dina</given-names>
        </name>
        <role>Software Editor</role>
      </contrib>
    </contrib-group>
    <permissions>
      <copyright-statement>© 2020 Dina Schneidman-Duhovny</copyright-statement>
      <copyright-year>2020</copyright-year>
      <copyright-holder>Dina Schneidman-Duhovny</copyright-holder>
      <license xlink:href="http://creativecommons.org/licenses/by/4.0/">
        <license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
      </license>
    </permissions>
    <related-article id="rel-obj001" ext-link-type="doi" xlink:href="10.1371/journal.pcbi.1008249" related-article-type="reviewed-article"/>
    <custom-meta-group>
      <custom-meta>
        <meta-name>Submission Version</meta-name>
        <meta-value>0</meta-value>
      </custom-meta>
    </custom-meta-group>
  </front-stub>
  <body>
    <p>
      <named-content content-type="letter-date">12 May 2020</named-content>
    </p>
    <p>Dear Prof. Cimrak,</p>
    <p>Thank you very much for submitting your manuscript "PyOIF: Computational Tool for Modelling of Multi-Cell Flows in Complex Geometries" for consideration at PLOS Computational Biology.</p>
    <p>As with all papers reviewed by the journal, your manuscript was reviewed by members of the editorial board and by several independent reviewers. In light of the reviews (below this email), we would like to invite the resubmission of a significantly-revised version that takes into account the reviewers' comments.</p>
    <p>I suggest you shorten the paper, so it doesn't include in-depth presentations of previously published methods and results. Instead, please focus on the software, usage, and capabilities to provide the user information that goes beyond published methods and tutorials.</p>
    <p>We cannot make any decision about publication until we have seen the revised manuscript and your response to the reviewers' comments. Your revised manuscript is also likely to be sent to reviewers for further evaluation.</p>
    <p>When you are ready to resubmit, please upload the following:</p>
    <p>[1] A letter containing a detailed list of your responses to the review comments and a description of the changes you have made in the manuscript. Please note while forming your response, if your article is accepted, you may have the opportunity to make the peer review history publicly available. The record will include editor decision letters (with reviews) and your responses to reviewer comments. If eligible, we will contact you to opt in or out.</p>
    <p>[2] Two versions of the revised manuscript: one with either highlights or tracked changes denoting where the text has been changed; the other a clean version (uploaded as the manuscript file).</p>
    <p>Important additional instructions are given below your reviewer comments.</p>
    <p>Please prepare and submit your revised manuscript within 60 days. If you anticipate any delay, please let us know the expected resubmission date by replying to this email. Please note that revised manuscripts received after the 60-day due date may require evaluation and peer review similar to newly submitted manuscripts.</p>
    <p>Thank you again for your submission. We hope that our editorial process has been constructive so far, and we welcome your feedback at any time. Please don't hesitate to contact us if you have any questions or comments.</p>
    <p>Sincerely,</p>
    <p>Dina Schneidman-Duhovny</p>
    <p>Software Editor</p>
    <p>PLOS Computational Biology</p>
    <p>***********************</p>
    <p>Reviewer's Responses to Questions</p>
    <p>
      <bold>Comments to the Authors:</bold>
    </p>
    <p>
      <bold>Please note here if the review is uploaded as an attachment.</bold>
    </p>
    <p>Reviewer #1: The paper presents a open source software for the simulation of red blood cells in flows. The model is based on a Lattice Boltzmann approach for the fluid part and a spring-based approach couple to the LB for the modelling of the soft matter. The paper starts with an overview of the model, followed by its validation and its application to 3 different cases. While the interest and availability of such a model is surely important for the biology community, the paper itself, is, in my opinion, simply a compilation of the previous authors' works. For example, the model calibration and validation is purely based on previous published papers and thus the section could be largely shorten. The general workflow section is based on the user guide documentation already available online with the source codes, while the design principles sound more a compilation of the advantages of the code provided with technical justification and/or evidence. In section 3, results, line 398, page 11, the authors explicitly state that those results 'have been thoroughly described elsewhere'. While they do not add the corresponding references, my question is thus as followed: what is the benefit for the community to have a paper repeating results that have already been published? For example, the case of section 3.1 has been published in ref[34]. Section 3.3 states that the authors 'are able to track more detailed information' (line 605, page 17), however, none of the listed information is actually presented in the paper. Moreover, only a video is provided and no quantitative data presented nor any validation for this case. Also, from the video, it looks like the cells are spherical and do not have a discocyte shape for the most common shape of a healthy RBC. Can the authors explain if the code handles discocyte and other RBC shapes?</p>
    <p>While the proposed tool has some significance for the community, I do not think the paper is acceptable for publication in PLoS Computational Biology as I can't clearly see any new understanding of the physics of RBC motion and the model itself has already been published.</p>
    <p>Reviewer #2: The manuscript introduces a software package for simulations of deformable cells in flow. Fluid flow is modeled using lattice Boltzmann method, whose implementation is performed within the ESPRESSO package. Deformable particles or cells are modeled using discrete network-based model, which is implemented in the new PyOIF package. The models are based on state of the art developments, and their implementation should be useful for researchers working on modeling deformable particles and cells in fluid flow. The main advantage of the described software package is its open access, as only a few open packages of potentially similar capabilities are available at the moment. It is difficult to estimate whether this software package will generate a lot of interest, but I think it deserves to be announced (or published). From the description, it sounds that the authors are planning its continuous maintenance and improvement, and they also provide some help and information to the users. I am in favor of publishing this manuscript, and would like to ask the authors to address a few rather minor concerns.</p>
    <p>1) The authors mention a couple of software packages, which may have similar/comparable possibilities. I think it would be useful to discuss similarities/differences advantages/disadvantages in more detail. Why should I choose the proposed software over another one? Maybe some sort of a summarizing table would be useful.</p>
    <p>2) Clearly, sophisticated models are complex and have a number of parameters. Therefore, it is probably impossible to use them as black boxes and some level of understanding is needed. The authors mention several times that certain parameters were calibrated in previous works. Does a user need to understand all these previously performed tests, in order to have a good idea of possible pitfalls? Would the software give some suggestions or warnings?</p>
    <p>3) It is difficult to judge software performance. Therefore, I would like to ask the authors to mention explicitly the performance numbers for different tests. How long each simulation takes? How well it is paralleled (speed-up, strong and weak scaling)? What is the most expensive part LBM or cell modeling? I think it would be useful to give running times for different examples to have an idea of the performance.</p>
    <p>4) Are you planning collective software development, so that users can contribute to this? How can you enable this efficiently?</p>
    <p>**********</p>
    <p>
      <bold>Have all data underlying the figures and results presented in the manuscript been provided?</bold>
    </p>
    <p>Large-scale datasets should be made available via a public repository as described in the <italic>PLOS Computational Biology</italic>
<ext-link ext-link-type="uri" xlink:href="http://journals.plos.org/ploscompbiol/s/data-availability">data availability policy</ext-link>, and numerical data that underlies graphs or summary statistics should be provided in spreadsheet form as supporting information.</p>
    <p>Reviewer #1: Yes</p>
    <p>Reviewer #2: Yes</p>
    <p>**********</p>
    <p>PLOS authors have the option to publish the peer review history of their article (<ext-link ext-link-type="uri" xlink:href="https://journals.plos.org/ploscompbiol/s/editorial-and-peer-review-process#loc-peer-review-history">what does this mean?</ext-link>). If published, this will include your full peer review and any attached files.</p>
    <p>If you choose “no”, your identity will remain anonymous but your review may still be made public.</p>
    <p><bold>Do you want your identity to be public for this peer review?</bold> For information about this choice, including consent withdrawal, please see our <ext-link ext-link-type="uri" xlink:href="https://www.plos.org/privacy-policy">Privacy Policy</ext-link>.</p>
    <p>Reviewer #1: No</p>
    <p>Reviewer #2: Yes: Dmitry Fedosov</p>
    <p>
      <underline>Figure Files:</underline>
    </p>
    <p>While revising your submission, please upload your figure files to the Preflight Analysis and Conversion Engine (PACE) digital diagnostic tool, <underline><ext-link ext-link-type="uri" xlink:href="https://pacev2.apexcovantage.com/" xlink:type="simple">https://pacev2.apexcovantage.com</ext-link></underline>. PACE helps ensure that figures meet PLOS requirements. To use PACE, you must first register as a user. Then, login and navigate to the UPLOAD tab, where you will find detailed instructions on how to use the tool. If you encounter any issues or have any questions when using PACE, please email us at <underline><email xlink:type="simple">figures@plos.org</email></underline>.</p>
    <p>
      <underline>Data Requirements:</underline>
    </p>
    <p>Please note that, as a condition of publication, PLOS' data policy requires that you make available all data used to draw the conclusions outlined in your manuscript. Data must be deposited in an appropriate repository, included within the body of the manuscript, or uploaded as supporting information. This includes all numerical values that were used to generate graphs, histograms etc.. For an example in PLOS Biology see here: <ext-link ext-link-type="uri" xlink:href="http://www.plosbiology.org/article/info%3Adoi%2F10.1371%2Fjournal.pbio.1001908#s5">http://www.plosbiology.org/article/info%3Adoi%2F10.1371%2Fjournal.pbio.1001908#s5</ext-link>.</p>
    <p>
      <underline>Reproducibility:</underline>
    </p>
    <p>To enhance the reproducibility of your results, PLOS recommends that you deposit laboratory protocols in protocols.io, where a protocol can be assigned its own identifier (DOI) such that it can be cited independently in the future. For instructions, please see <underline><ext-link ext-link-type="uri" xlink:href="http://journals.plos.org/plospathogens/s/submission-guidelines" xlink:type="simple">http://journals.plos.org/compbiol/s/submission-guidelines#loc-materials-and-methods</ext-link></underline></p>
  </body>
</sub-article>
<sub-article id="pcbi.1008249.r002" article-type="author-comment">
  <front-stub>
    <article-id pub-id-type="doi">10.1371/journal.pcbi.1008249.r002</article-id>
    <title-group>
      <article-title>Author response to Decision Letter 0</article-title>
    </title-group>
    <related-article id="rel-obj002" ext-link-type="doi" xlink:href="10.1371/journal.pcbi.1008249" related-article-type="editor-report"/>
    <custom-meta-group>
      <custom-meta>
        <meta-name>Submission Version</meta-name>
        <meta-value>1</meta-value>
      </custom-meta>
    </custom-meta-group>
  </front-stub>
  <body>
    <p>
      <named-content content-type="author-response-date">13 Jul 2020</named-content>
    </p>
    <supplementary-material content-type="local-data" id="pcbi.1008249.s003">
      <label>Attachment</label>
      <caption>
        <p>Submitted filename: <named-content content-type="submitted-filename">response_to_reviewers.pdf</named-content></p>
      </caption>
      <media xlink:href="pcbi.1008249.s003.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </body>
</sub-article>
<sub-article id="pcbi.1008249.r003" article-type="aggregated-review-documents">
  <front-stub>
    <article-id pub-id-type="doi">10.1371/journal.pcbi.1008249.r003</article-id>
    <title-group>
      <article-title>Decision Letter 1</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Schneidman-Duhovny</surname>
          <given-names>Dina</given-names>
        </name>
        <role>Software Editor</role>
      </contrib>
    </contrib-group>
    <permissions>
      <copyright-statement>© 2020 Dina Schneidman-Duhovny</copyright-statement>
      <copyright-year>2020</copyright-year>
      <copyright-holder>Dina Schneidman-Duhovny</copyright-holder>
      <license xlink:href="http://creativecommons.org/licenses/by/4.0/">
        <license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
      </license>
    </permissions>
    <related-article id="rel-obj003" ext-link-type="doi" xlink:href="10.1371/journal.pcbi.1008249" related-article-type="reviewed-article"/>
    <custom-meta-group>
      <custom-meta>
        <meta-name>Submission Version</meta-name>
        <meta-value>1</meta-value>
      </custom-meta>
    </custom-meta-group>
  </front-stub>
  <body>
    <p>
      <named-content content-type="letter-date">14 Aug 2020</named-content>
    </p>
    <p>Dear Prof. Cimrak,</p>
    <p>We are pleased to inform you that your manuscript 'PyOIF: Computational tool for modelling of multi-cell flows in complex geometries' has been provisionally accepted for publication in PLOS Computational Biology.</p>
    <p>Before your manuscript can be formally accepted you will need to complete some formatting changes, which you will receive in a follow up email. A member of our team will be in touch with a set of requests.</p>
    <p>Please note that your manuscript will not be scheduled for publication until you have made the required changes, so a swift response is appreciated.</p>
    <p>IMPORTANT: The editorial review process is now complete. PLOS will only permit corrections to spelling, formatting or significant scientific errors from this point onwards. Requests for major changes, or any which affect the scientific understanding of your work, will cause delays to the publication date of your manuscript.</p>
    <p>Should you, your institution's press office or the journal office choose to press release your paper, you will automatically be opted out of early publication. We ask that you notify us now if you or your institution is planning to press release the article. All press must be co-ordinated with PLOS.</p>
    <p>Thank you again for supporting Open Access publishing; we are looking forward to publishing your work in PLOS Computational Biology. </p>
    <p>Best regards,</p>
    <p>Dina Schneidman</p>
    <p>Software Editor</p>
    <p>PLOS Computational Biology</p>
    <p>***********************************************************</p>
    <p>Reviewer's Responses to Questions</p>
    <p>
      <bold>Comments to the Authors:</bold>
    </p>
    <p>
      <bold>Please note here if the review is uploaded as an attachment.</bold>
    </p>
    <p>Reviewer #2: The authors have given satisfactory answers to all of my concerns, so I have no further comments and recommend the manuscript for publication.</p>
    <p>**********</p>
    <p>
      <bold>Have all data underlying the figures and results presented in the manuscript been provided?</bold>
    </p>
    <p>Large-scale datasets should be made available via a public repository as described in the <italic>PLOS Computational Biology</italic>
<ext-link ext-link-type="uri" xlink:href="http://journals.plos.org/ploscompbiol/s/data-availability">data availability policy</ext-link>, and numerical data that underlies graphs or summary statistics should be provided in spreadsheet form as supporting information.</p>
    <p>Reviewer #2: Yes</p>
    <p>**********</p>
    <p>PLOS authors have the option to publish the peer review history of their article (<ext-link ext-link-type="uri" xlink:href="https://journals.plos.org/ploscompbiol/s/editorial-and-peer-review-process#loc-peer-review-history">what does this mean?</ext-link>). If published, this will include your full peer review and any attached files.</p>
    <p>If you choose “no”, your identity will remain anonymous but your review may still be made public.</p>
    <p><bold>Do you want your identity to be public for this peer review?</bold> For information about this choice, including consent withdrawal, please see our <ext-link ext-link-type="uri" xlink:href="https://www.plos.org/privacy-policy">Privacy Policy</ext-link>.</p>
    <p>Reviewer #2: No</p>
  </body>
</sub-article>
<sub-article id="pcbi.1008249.r004" article-type="editor-report">
  <front-stub>
    <article-id pub-id-type="doi">10.1371/journal.pcbi.1008249.r004</article-id>
    <title-group>
      <article-title>Acceptance letter</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Schneidman-Duhovny</surname>
          <given-names>Dina</given-names>
        </name>
        <role>Software Editor</role>
      </contrib>
    </contrib-group>
    <permissions>
      <copyright-statement>© 2020 Dina Schneidman-Duhovny</copyright-statement>
      <copyright-year>2020</copyright-year>
      <copyright-holder>Dina Schneidman-Duhovny</copyright-holder>
      <license xlink:href="http://creativecommons.org/licenses/by/4.0/">
        <license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
      </license>
    </permissions>
    <related-article id="rel-obj004" ext-link-type="doi" xlink:href="10.1371/journal.pcbi.1008249" related-article-type="reviewed-article"/>
  </front-stub>
  <body>
    <p>
      <named-content content-type="letter-date">8 Oct 2020</named-content>
    </p>
    <p>PCOMPBIOL-D-20-00375R1 </p>
    <p>PyOIF: Computational tool for modelling of multi-cell flows in complex geometries</p>
    <p>Dear Dr Cimrak,</p>
    <p>I am pleased to inform you that your manuscript has been formally accepted for publication in PLOS Computational Biology. Your manuscript is now with our production department and you will be notified of the publication date in due course.</p>
    <p>The corresponding author will soon be receiving a typeset proof for review, to ensure errors have not been introduced during production. Please review the PDF proof of your manuscript carefully, as this is the last chance to correct any errors. Please note that major changes, or those which affect the scientific understanding of the work, will likely cause delays to the publication date of your manuscript. </p>
    <p>Soon after your final files are uploaded, unless you have opted out, the early version of your manuscript will be published online. The date of the early version will be your article's publication date. The final article will be published to the same URL, and all versions of the paper will be accessible to readers.</p>
    <p>Thank you again for supporting PLOS Computational Biology and open-access publishing. We are looking forward to publishing your work! </p>
    <p>With kind regards,</p>
    <p>Laura Mallard</p>
    <p>PLOS Computational Biology | Carlyle House, Carlyle Road, Cambridge CB4 3DN | United Kingdom <email>ploscompbiol@plos.org</email> | Phone +44 (0) 1223-442824 | <ext-link ext-link-type="uri" xlink:href="http://ploscompbiol.org">ploscompbiol.org</ext-link> | @PLOSCompBiol</p>
  </body>
</sub-article>
