<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.1 20151215//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.1?>
<?ConverterInfo.XSLTName jp2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">Bioinformatics</journal-id>
    <journal-id journal-id-type="publisher-id">bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1367-4803</issn>
    <issn pub-type="epub">1367-4811</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">6612809</article-id>
    <article-id pub-id-type="doi">10.1093/bioinformatics/btz368</article-id>
    <article-id pub-id-type="publisher-id">btz368</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Ismb/Eccb 2019 Conference Proceedings</subject>
        <subj-group subj-group-type="category-toc-heading">
          <subject>Macromolecular Sequence, Structure, and Function</subject>
        </subj-group>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Statistical compression of protein sequences and inference of marginal probability landscapes over competing alignments using finite state models and Dirichlet priors</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Sumanaweera</surname>
          <given-names>Dinithi</given-names>
        </name>
        <xref ref-type="aff" rid="btz368-aff1"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Allison</surname>
          <given-names>Lloyd</given-names>
        </name>
        <xref ref-type="corresp" rid="btz368-cor1"/>
        <!--<email>lloyd.allison@monash.edu</email>-->
        <xref ref-type="aff" rid="btz368-aff1"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Konagurthu</surname>
          <given-names>Arun S</given-names>
        </name>
        <xref ref-type="corresp" rid="btz368-cor1"/>
        <!--<email>arun.konagurthu@monash.edu</email>-->
        <xref ref-type="aff" rid="btz368-aff1"/>
      </contrib>
    </contrib-group>
    <aff id="btz368-aff1">Faculty of Information Technology, Monash University, Clayton, VIC, Australia</aff>
    <author-notes>
      <corresp id="btz368-cor1">To whom correspondence should be addressed. <email>arun.konagurthu@monash.edu</email> or <email>lloyd.allison@monash.edu</email></corresp>
    </author-notes>
    <pub-date pub-type="ppub">
      <month>7</month>
      <year>2019</year>
    </pub-date>
    <pub-date pub-type="epub" iso-8601-date="2019-07-05">
      <day>05</day>
      <month>7</month>
      <year>2019</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>05</day>
      <month>7</month>
      <year>2019</year>
    </pub-date>
    <!-- PMC Release delay is 0 months and 0 days and was based on the <pub-date pub-type="epub"/>. -->
    <volume>35</volume>
    <issue>14</issue>
    <fpage>i360</fpage>
    <lpage>i369</lpage>
    <permissions>
      <copyright-statement>© The Author(s) 2019. Published by Oxford University Press.</copyright-statement>
      <copyright-year>2019</copyright-year>
      <license license-type="cc-by-nc" xlink:href="http://creativecommons.org/licenses/by-nc/4.0/">
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution Non-Commercial License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by-nc/4.0/">http://creativecommons.org/licenses/by-nc/4.0/</ext-link>), which permits non-commercial re-use, distribution, and reproduction in any medium, provided the original work is properly cited. For commercial re-use, please contact journals.permissions@oup.com</license-p>
      </license>
    </permissions>
    <self-uri xlink:href="btz368.pdf"/>
    <abstract>
      <title>Abstract</title>
      <sec id="s1">
        <title/>
        <p>The information criterion of minimum message length (MML) provides a powerful statistical framework for inductive reasoning from observed data. We apply MML to the problem of protein sequence comparison using finite state models with Dirichlet distributions. The resulting framework allows us to supersede the <italic>ad hoc</italic> cost functions commonly used in the field, by systematically addressing the problem of arbitrariness in alignment parameters, and the disconnect between substitution scores and gap costs. Furthermore, our framework enables the generation of marginal probability landscapes over all possible alignment hypotheses, with potential to facilitate the users to simultaneously rationalize and assess competing alignment relationships between protein sequences, beyond simply reporting a single (best) alignment. We demonstrate the performance of our program on benchmarks containing distantly related protein sequences.</p>
      </sec>
      <sec id="s2">
        <title>Availability and implementation</title>
        <p>The open-source program supporting this work is available from: <ext-link ext-link-type="uri" xlink:href="http://lcb.infotech.monash.edu.au/seqmmligner">http://lcb.infotech.monash.edu.au/seqmmligner</ext-link>.</p>
      </sec>
      <sec id="s3">
        <title>Supplementary information</title>
        <p><xref ref-type="supplementary-material" rid="sup1">Supplementary data</xref> are available at <italic>Bioinformatics</italic> online.</p>
      </sec>
    </abstract>
    <funding-group>
      <award-group award-type="grant">
        <funding-source>
          <named-content content-type="funder-name">Australian Research Council</named-content>
          <named-content content-type="funder-identifier">10.13039/501100000923</named-content>
        </funding-source>
        <award-id>DP150100894</award-id>
      </award-group>
    </funding-group>
    <counts>
      <page-count count="10"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec>
    <title>1 Introduction</title>
    <p>Identifying the evolutionarily retained similarities between macro-molecular sequences remains an indispensable first step of many biological studies (<xref rid="btz368-B22" ref-type="bibr">Lesk, 2017</xref>). Comparison of sequences are carried out using the computational technique of <italic>alignment</italic>. An alignment is used as a surrogate for how two (or more) sequences are evolutionarily related and provides a quantitative measure of their similarity (<xref rid="btz368-B2" ref-type="bibr">Allison <italic>et al.</italic>, 1992</xref>, <xref rid="btz368-B3" ref-type="bibr">1999</xref>; <xref rid="btz368-B4" ref-type="bibr">Barton and Sternberg, 1987</xref>; <xref rid="btz368-B22" ref-type="bibr">Lesk, 2017</xref>).</p>
    <p>Alignment techniques commonly depend on choosing a model for relating two sequences with stated parameters to score matched and penalize unmatched (gap) regions in any alignment. However, in practice, it is left for the users to fine-tune these parameters in their quest for meaningful sequence relationships. This parameter tuning remains a ‘black art based on trial and error’ (<xref rid="btz368-B10" ref-type="bibr">Do <italic>et al.</italic>, 2005</xref>), and several studies have underscored major problems with parameter tuning and demonstrated the conflicting effects this has on resulting alignments (<xref rid="btz368-B11" ref-type="bibr">Do <italic>et al.</italic>, 2006</xref>; <xref rid="btz368-B24" ref-type="bibr">Löytynoja and Goldman, 2008</xref>; <xref rid="btz368-B29" ref-type="bibr">Rivas and Eddy, 2015</xref>; Vingron and Waterman, <xref rid="btz368-B37" ref-type="bibr">1994</xref>). These limitations were best summarized by <xref rid="btz368-B24" ref-type="bibr">Löytynoja and Goldman (2008</xref>) in their observation that ‘alignment is still a highly error-prone step in comparative sequence analysis’.</p>
    <p>The problem becomes more pronounced when comparing amino acid sequences of proteins, which additionally rely on substitution matrices. A protein sequence alignment gives a one-to-one correspondence between amino acids symbols, and substitution scores are used to quantify these correspondences. A substitution matrix over the standard amino acid alphabet is parameterized on a distance (or alternatively a similarity) parameter between sequences, and conveys the mutability of one amino acid changing into another. PAM (<xref rid="btz368-B9" ref-type="bibr">Dayhoff <italic>et al.</italic>, 1978</xref>) and BLOSUM (<xref rid="btz368-B17" ref-type="bibr">Henikoff and Henikoff, 1992</xref>) are widely used series of substitution matrices.</p>
    <p>Yet, in the use of these substitution matrices, there remains a severe disconnect between the substitution scores (used to score the matched amino acid correspondences) and gap parameters (used to penalize the unmatched regions of alignments). Previous studies have shown that, different protein sequence alignment programs with varying choices of substitution and gap parameters convey radically different alignments (<xref rid="btz368-B4" ref-type="bibr">Barton and Sternberg, 1987</xref>; <xref rid="btz368-B7" ref-type="bibr">Blake and Cohen, 2001</xref>; <xref rid="btz368-B15" ref-type="bibr">Fitch and Smith, 1983</xref>; <xref rid="btz368-B24" ref-type="bibr">Löytynoja and Goldman, 2008</xref>; <xref rid="btz368-B37" ref-type="bibr">Vingron and Waterman, 1994</xref>). Further, the confidence of reported relationship in an alignment plummets when comparing protein sequences from the <italic>twilight zone</italic> [by common consensus defined as sequences sharing less than 35% sequence identity (<xref rid="btz368-B12" ref-type="bibr">Doolittle, 1986</xref>)]. <xref rid="btz368-B11" ref-type="bibr">Do <italic>et al.</italic> (2006</xref>) observed that the correctness of a reported sequence alignment is highly questionable when it is below a 25% sequence identity.</p>
    <p>Beyond the problem with tuning alignment parameters, another major shortcoming is that most current programs report a single alignment. Many studies have demonstrated that optimizing an objective function under a specified model of sequence relatedness does not necessarily imply an optimization in homology (<xref rid="btz368-B15" ref-type="bibr">Fitch and Smith, 1983</xref>; <xref rid="btz368-B13" ref-type="bibr">Durbin <italic>et al.</italic>, 1998</xref>; <xref rid="btz368-B23" ref-type="bibr">Levy Karin <italic>et al.</italic>, 2019</xref>; <xref rid="btz368-B28" ref-type="bibr">Redelings and Suchard, 2005</xref>; <xref rid="btz368-B30" ref-type="bibr">Rosenberg, 2009</xref>) (see <xref ref-type="supplementary-material" rid="sup1">Supplementary note</xref>s for a more detailed discussion).</p>
    <p>Aforementioned deficiencies provide a motivation for the work presented here. Specifically for comparing protein sequences, we attempt to rectify: (i) the problem of arbitrariness of alignment parameters, (ii) the disconnect between substitution scores and gap parameters, and (iii) the lack of a rigorous statistical framework where all competing alignments can be simultaneously rationalized and assessed, beyond reporting just a single (best) alignment.</p>
    <p>Our work uses the statistical inductive inference method of minimum message length (MML) encoding (<xref rid="btz368-B1" ref-type="bibr">Allison, 2018</xref>; <xref rid="btz368-B38" ref-type="bibr">Wallace, 2005</xref>; <xref rid="btz368-B39" ref-type="bibr">Wallace and Boulton, 1968</xref>) to compare the relatedness of protein sequences in information-theoretic terms, measurable in <italic>bits</italic>. In this framework, any alignment between protein sequences is a string generated by a three-state alignment machine with <bold><monospace>match</monospace></bold>, <bold><monospace>insert</monospace></bold> and <bold><monospace>delete</monospace></bold> states. This allows us to compute robust probability estimates of sequence alignments.</p>
    <p>Independently, we infer from a set of 118 384 structural alignments between protein domains, the parameters of Dirichlet probability distributions that allow us to link the distance parameter of existing substitution matrices (e.g. parameter ‘<italic>n</italic>’ of PAM-<italic>n</italic>) with the state machine (transition probability) parameters that produce the three-state alignment strings. These parameters provide a substantial statistical rationalization of the otherwise <italic>ad hoc</italic> use of gap penalties. In statistical learning theory, the Dirichlet distribution is often used as a prior distribution over the parameters of finite-state models. It is a conjugate prior for multistate models, which implies that the resultant posterior is also a Dirichlet distribution (<xref rid="btz368-B1" ref-type="bibr">Allison, 2018</xref>).</p>
    <p>Furthermore, building on these inferred Dirichlet priors, we design a statistical compression based alignment methodology with automatically estimated parameters, to compute the marginal probability landscape of any given protein sequence pair (e.g. see <xref ref-type="fig" rid="btz368-F1">Fig. 1(a)</xref>). Marginal probability estimation (<xref rid="btz368-B34" ref-type="bibr">Trumpler and Weaver, 1953</xref>) applied to sequence alignment provides a powerful technique to highlight the relationship between sequences, by <italic>marginalizing</italic> over all the alignments between the sequences. Specifically, for a pair of sequences <inline-formula id="IE1"><mml:math id="IM1"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold">S</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>…</mml:mo><mml:mo>|</mml:mo><mml:mi mathvariant="bold">S</mml:mi><mml:mo>|</mml:mo></mml:mrow></mml:msub><mml:mo>:</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold">T</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>…</mml:mo><mml:mo>|</mml:mo><mml:mi mathvariant="bold">T</mml:mi><mml:mo>|</mml:mo></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula>, any cell (<italic>i</italic>, <italic>j</italic>) in this landscape gives the product of marginal probabilities that the prefixes <inline-formula id="IE2"><mml:math id="IM2"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold">S</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>…</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>:</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold">T</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>…</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> and suffixes <inline-formula id="IE3"><mml:math id="IM3"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold">S</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo>…</mml:mo><mml:mo>|</mml:mo><mml:mi mathvariant="bold">S</mml:mi><mml:mo>|</mml:mo></mml:mrow></mml:msub><mml:mo>:</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold">T</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo>…</mml:mo><mml:mo>|</mml:mo><mml:mi mathvariant="bold">T</mml:mi><mml:mo>|</mml:mo></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> are related. This involves integrating over all possible alignments passing through the cell (<italic>i</italic>, <italic>j</italic>) in any of the three alignment states. Since these are rigorous estimates of probabilities of relationship between sequences, the resultant landscape allows the user to visualize not just the most probable alignment, but also interactively query closely competing alignments passing through any cell (e.g. see <xref ref-type="fig" rid="btz368-F1">Fig. 1(b)</xref>).
</p>
    <fig id="btz368-F1" orientation="portrait" position="float">
      <label>Fig. 1.</label>
      <caption>
        <p>(<bold>a</bold>) Marginal probability landscape to visualize the relatedness of two protein sequences over all competing alignments. (<bold>b</bold>) Most probable alignments passing through a set of specific cells (<italic>i</italic>, <italic>j</italic>) in the sequence landscape, including the most probable over all cells (shown in black)</p>
      </caption>
      <graphic xlink:href="btz368f1"/>
    </fig>
    <p>Most importantly, the MML framework provides a natural statistical significance test when assessing any alignment or comparing one with another. This is measurable in bits of compression with respect to the <italic>null model</italic> message length that gives the Shannon’s information content (<xref rid="btz368-B31" ref-type="bibr">Shannon, 1948</xref>) [related to the Kolmogorov complexity (<xref rid="btz368-B19" ref-type="bibr">Kolmogorov, 1963</xref>)] of each of the two sequences independently summed up.</p>
    <p>Finally, asymptotic computational complexity to compare sequences under this framework and generate these marginal alignment landscapes is <inline-formula id="IE4"><mml:math id="IM4"><mml:mrow><mml:mi>O</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mo>|</mml:mo><mml:mi mathvariant="bold">S</mml:mi><mml:mo>|</mml:mo><mml:mo>|</mml:mo><mml:mi mathvariant="bold">T</mml:mi><mml:mo>|</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>. Any specific competing alignment can be probed and reported in <inline-formula id="IE5"><mml:math id="IM5"><mml:mrow><mml:mi>O</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mo>|</mml:mo><mml:mi mathvariant="bold">S</mml:mi><mml:mo>|</mml:mo><mml:mo>+</mml:mo><mml:mo>|</mml:mo><mml:mi mathvariant="bold">T</mml:mi><mml:mo>|</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> time after the initial <inline-formula id="IE6"><mml:math id="IM6"><mml:mrow><mml:mi>O</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mo>|</mml:mo><mml:mi mathvariant="bold">S</mml:mi><mml:mo>|</mml:mo><mml:mo>|</mml:mo><mml:mi mathvariant="bold">T</mml:mi><mml:mo>|</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> effort.</p>
    <p>We note that our work develops and significantly extends the basic ideas of finite state models for alignment introduced by <xref rid="btz368-B2" ref-type="bibr">Allison <italic>et al.</italic> (1992</xref>, <xref rid="btz368-B3" ref-type="bibr">1999</xref>), <xref rid="btz368-B27" ref-type="bibr">Powell <italic>et al.</italic> (2004</xref>) and <xref rid="btz368-B32" ref-type="bibr">Sumanaweera <italic>et al.</italic> (2018</xref>). More generally, other noteworthy attempts at probabilistic modeling of alignments, although with different aims and motivations, include: <xref rid="btz368-B13" ref-type="bibr">Durbin <italic>et al.</italic> (1998</xref>), <xref rid="btz368-B42" ref-type="bibr">Zhu <italic>et al.</italic> (1998</xref>), <xref rid="btz368-B10" ref-type="bibr">Do <italic>et al.</italic> (2005</xref>, <xref rid="btz368-B11" ref-type="bibr">2006</xref>) and <xref rid="btz368-B29" ref-type="bibr">Rivas and Eddy (2015</xref>). See <xref ref-type="supplementary-material" rid="sup1">supplementary Section S4</xref> for an overview of the literature on this topic.</p>
  </sec>
  <sec>
    <title>2 Materials and methods</title>
    <sec>
      <title>2.1 Primer on MML criterion</title>
      <p>MML encoding is a Bayesian method for hypothesis (model) selection that is grounded in information and coding theory (<xref rid="btz368-B1" ref-type="bibr">Allison, 2018</xref>; <xref rid="btz368-B38" ref-type="bibr">Wallace, 2005</xref>; <xref rid="btz368-B39" ref-type="bibr">Wallace and Boulton, 1968</xref>).</p>
      <p>For any hypothesis <italic>H</italic> on observed data <italic>D</italic>, their joint probability is given by: <inline-formula id="IE7"><mml:math id="IM7"><mml:mrow><mml:mi>Pr</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>H</mml:mi><mml:mo>,</mml:mo><mml:mi>D</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mi>Pr</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>H</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mi>Pr</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>D</mml:mi><mml:mo>|</mml:mo><mml:mi>H</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mi>Pr</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>D</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mi>Pr</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>H</mml:mi><mml:mo>|</mml:mo><mml:mi>D</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>. Independently, <xref rid="btz368-B31" ref-type="bibr">Shannon (1948</xref>) in his <italic>Mathematical Theory of Communication</italic> quantified the information content (measurable in <italic>bits</italic>) in any event <italic>E</italic> that occurs with a probability of Pr(<italic>E</italic>) as <inline-formula id="IE8"><mml:math id="IM8"><mml:mrow><mml:mi mathvariant="normal">I</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>E</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mrow><mml:mo> </mml:mo><mml:mtext>log</mml:mtext><mml:mo> </mml:mo></mml:mrow></mml:mrow><mml:mn>2</mml:mn></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>Pr</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>E</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>. In other words, I(<italic>E</italic>) is the shortest message length required to communicate <italic>losslessly</italic> the information conveyed by <italic>E</italic>. Applying Shannon’s insight, the joint probability between any hypothesis and data can be expressed in terms of Shannon’s information content as: <inline-formula id="IE9"><mml:math id="IM9"><mml:mrow><mml:mi mathvariant="normal">I</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>H</mml:mi><mml:mo>,</mml:mo><mml:mi>D</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mi mathvariant="normal">I</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>H</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:mi mathvariant="normal">I</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>D</mml:mi><mml:mo>|</mml:mo><mml:mi>H</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mi mathvariant="normal">I</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>D</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:mi mathvariant="normal">I</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>H</mml:mi><mml:mo>|</mml:mo><mml:mi>D</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>. This can be rationalized as the length of the message communicated between an imaginary transmitter-receiver pair; the transmitter’s goal is to encode and send the data <italic>D</italic> over a chosen hypothesis <italic>H</italic> as efficiently as possible, so that the receiver can decode the message and losslessly recover <italic>D</italic>. The transmission message is in two parts: the first deals with encoding and sending the hypothesis, taking I(<italic>H</italic>) bits; the second deals with encoding the data given the hypothesis, taking <inline-formula id="IE10"><mml:math id="IM10"><mml:mrow><mml:mi mathvariant="normal">I</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>D</mml:mi><mml:mo>|</mml:mo><mml:mi>H</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> bits.</p>
      <p>The difference in the message lengths, <inline-formula id="IE11"><mml:math id="IM11"><mml:mrow><mml:mi mathvariant="normal">I</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>H</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mi>D</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>−</mml:mo><mml:mi mathvariant="normal">I</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>H</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mi>D</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>, between any two hypotheses <italic>H</italic><sub>1</sub> and <italic>H</italic><sub>2</sub> explaining the same data <italic>D</italic> gives the log-odds posterior ratio test:
<disp-formula id="E1"><mml:math id="M1"><mml:mrow><mml:mi mathvariant="normal">I</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>H</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mi>D</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>−</mml:mo><mml:mi mathvariant="normal">I</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>H</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mi>D</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:mtext>log</mml:mtext><mml:mo> </mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mfrac><mml:mrow><mml:mi>Pr</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>D</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mi>Pr</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>H</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>|</mml:mo><mml:mi>D</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mi>Pr</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>D</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mi>Pr</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>H</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msub><mml:mo>|</mml:mo><mml:mi>D</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfrac></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mtext>log</mml:mtext><mml:mo> </mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mfrac><mml:mrow><mml:mi>Pr</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>H</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msub><mml:mo>|</mml:mo><mml:mi>D</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mi>Pr</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>H</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>|</mml:mo><mml:mi>D</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfrac></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>.</mml:mo></mml:math></disp-formula></p>
      <p>More importantly, implicit in this framework is a null hypothesis (or model). The null model message involves stating <italic>D</italic> without venturing a hypothesis—i.e. stating <italic>D</italic> raw, but as efficiently as possible—taking I<sub>NULL</sub> (<italic>D</italic>) bits. If the best hypothesis <italic>H</italic>*, the one that yields the shortest message length <inline-formula id="IE12"><mml:math id="IM12"><mml:mrow><mml:mi mathvariant="normal">I</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mrow><mml:mi>H</mml:mi></mml:mrow><mml:mo>*</mml:mo></mml:msup><mml:mo>,</mml:mo><mml:mi>D</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> over the space of all possible hypotheses, does not beat the null model (i.e. <inline-formula id="IE13"><mml:math id="IM13"><mml:mrow><mml:mi mathvariant="normal">I</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mrow><mml:mi>H</mml:mi></mml:mrow><mml:mo>*</mml:mo></mml:msup><mml:mo>,</mml:mo><mml:mi>D</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>&gt;</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="normal">I</mml:mi></mml:mrow><mml:mrow><mml:mtext>NULL</mml:mtext></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>D</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>), then that hypothesis has to be <italic>rejected</italic>.</p>
      <p>The MML paradigm for hypothesis selection provides a direct tradeoff between hypothesis complexity I(<italic>H</italic>) and its fit to the data <inline-formula id="IE14"><mml:math id="IM14"><mml:mrow><mml:mi mathvariant="normal">I</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>D</mml:mi><mml:mo>|</mml:mo><mml:mi>H</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>: a more complex hypothesis results in a higher value of I(<italic>H</italic>) but may describe the data better with a lower value of <inline-formula id="IE15"><mml:math id="IM15"><mml:mrow><mml:mi mathvariant="normal">I</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>D</mml:mi><mml:mo>|</mml:mo><mml:mi>H</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>, and vice versa. Furthermore, MML ensures complete transparency in communication. Any information that is not common knowledge or based on preconceived notions implicit in the data has to be included as part of the message sent by the transmitter. Otherwise the transmission is not lossless, and the message sent will be indecipherable by the receiver. No parameters can be hidden from the communication, and the precision of statement of real-valued parameters has to be directly dealt with as part of the MML framework (<xref rid="btz368-B38" ref-type="bibr">Wallace, 2005</xref>; <xref rid="btz368-B40" ref-type="bibr">Wallace and Freeman, 1987</xref>). Note, the practical realization of MML is built on strong statistical foundations developed over 40 years in the general statistical learning literature outside molecular biology (<xref rid="btz368-B1" ref-type="bibr">Allison, 2018</xref>; <xref rid="btz368-B38" ref-type="bibr">Wallace, 2005</xref>; <xref rid="btz368-B40" ref-type="bibr">Wallace and Freeman, 1987</xref>).</p>
    </sec>
    <sec>
      <title>2.2 Protein sequence comparison in MML paradigm</title>
      <p>Given two protein sequences <bold>S</bold> and <bold>T</bold>, we want to know if they are related, and if so, how? Any alignment <inline-formula id="IE16"><mml:math id="IM16"><mml:mi mathvariant="script">A</mml:mi></mml:math></inline-formula> between <inline-formula id="IE17"><mml:math id="IM17"><mml:mrow><mml:mo>〈</mml:mo><mml:mi mathvariant="bold">S</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold">T</mml:mi><mml:mo>〉</mml:mo></mml:mrow></mml:math></inline-formula> proposes a specific hypothesis of their relationship. Consequently, using the MML framework, the fitness of any alignment relationship between sequences can be quantified over a two-part message. The first part encodes the explanation of the relationship specified by <inline-formula id="IE18"><mml:math id="IM18"><mml:mi mathvariant="script">A</mml:mi></mml:math></inline-formula>, while the second part encodes the details of the amino acid symbols of <bold>S</bold> and <bold>T</bold> under the relationship specified by <inline-formula id="IE19"><mml:math id="IM19"><mml:mi mathvariant="script">A</mml:mi></mml:math></inline-formula>. We call this form of transmission of sequences using an alignment, the <italic>alignment-model</italic> message. This model gives the following message length terms:
<disp-formula id="E2"><label>(1)</label><mml:math id="M2"><mml:mrow><mml:mi mathvariant="normal">I</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="script">A</mml:mi><mml:mo>,</mml:mo><mml:mo>〈</mml:mo><mml:mi mathvariant="bold">S</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold">T</mml:mi><mml:mo>〉</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:munder><mml:munder><mml:mrow><mml:mi mathvariant="normal">I</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="script">A</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo stretchy="false">︸</mml:mo></mml:munder><mml:mrow><mml:mtext>First</mml:mtext><mml:mo> </mml:mo><mml:mtext>part</mml:mtext></mml:mrow></mml:munder><mml:mo>+</mml:mo><mml:munder><mml:munder><mml:mrow><mml:mi mathvariant="normal">I</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mo>〈</mml:mo><mml:mi mathvariant="bold">S</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold">T</mml:mi><mml:mo>〉</mml:mo><mml:mo>|</mml:mo><mml:mi mathvariant="script">A</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo stretchy="false">︸</mml:mo></mml:munder><mml:mrow><mml:mtext>Second</mml:mtext><mml:mo> </mml:mo><mml:mtext>part</mml:mtext></mml:mrow></mml:munder><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mtext>bits</mml:mtext></mml:mrow></mml:math></disp-formula></p>
      <p>Any alignment hypothesis <inline-formula id="IE20"><mml:math id="IM20"><mml:mi mathvariant="script">A</mml:mi></mml:math></inline-formula> over the sequences <inline-formula id="IE21"><mml:math id="IM21"><mml:mrow><mml:mo>〈</mml:mo><mml:mi mathvariant="bold">S</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold">T</mml:mi><mml:mo>〉</mml:mo></mml:mrow></mml:math></inline-formula> specifies a string over three states, <bold><monospace>match</monospace></bold> (<bold><monospace>m</monospace></bold>), <bold><monospace>insert</monospace></bold> (<bold><monospace>i</monospace></bold>) and <bold><monospace>delete</monospace></bold> (<bold><monospace>d</monospace></bold>), generated from a three-state machine with unknown parameters (<xref ref-type="fig" rid="btz368-F2">Fig. 2</xref>). For a given pair of sequences, these state-machine parameters are to be inferred in concert with the distance parameter (also unknown) between the two sequences. (These details together with computation of the message length terms denoted in <xref ref-type="disp-formula" rid="E2">Equation 1</xref> are specified in Sections 2.3–2.4.)
</p>
      <fig id="btz368-F2" orientation="portrait" position="float">
        <label>Fig. 2.</label>
        <caption>
          <p>Three-state machine for alignment string modeling</p>
        </caption>
        <graphic xlink:href="btz368f2"/>
      </fig>
      <p>Thus in this framework, the best alignment hypothesis <inline-formula id="IE22"><mml:math id="IM22"><mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="script">A</mml:mi></mml:mrow><mml:mo>*</mml:mo></mml:msup></mml:mrow></mml:math></inline-formula> is the one that yields the shortest two-part message, <inline-formula id="IE23"><mml:math id="IM23"><mml:mrow><mml:mi mathvariant="normal">I</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="script">A</mml:mi></mml:mrow><mml:mo>*</mml:mo></mml:msup><mml:mo>,</mml:mo><mml:mo>〈</mml:mo><mml:mi mathvariant="bold">S</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold">T</mml:mi><mml:mo>〉</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>. More importantly, in reasoning about the relationship between the sequences, MML allows the contribution of <italic>all</italic> alignments to be considered according to their respective probabilities. In probabilistic terms, this is equivalent to computing the marginal probability <inline-formula id="IE24"><mml:math id="IM24"><mml:mrow><mml:mi>Pr</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mo>〈</mml:mo><mml:mi mathvariant="bold">S</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold">T</mml:mi><mml:mo>〉</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> that the sequences are related. More formally, since the set of all possible alignments (say <bold>A</bold>) contains alignment hypotheses that are pairwise disjoint from each other, by the law of total probability (<xref rid="btz368-B5" ref-type="bibr">Bayes, 1763</xref>), we have:
<disp-formula id="E3"><label>(2)</label><mml:math id="M3"><mml:mrow><mml:mi>Pr</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mo>〈</mml:mo><mml:mi mathvariant="bold">S</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold">T</mml:mi><mml:mo>〉</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mo>∀</mml:mo><mml:mi mathvariant="script">A</mml:mi><mml:mo>∈</mml:mo><mml:mi mathvariant="bold">A</mml:mi></mml:mrow></mml:munder><mml:mrow><mml:mi>Pr</mml:mi></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="script">A</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mi>Pr</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mo>〈</mml:mo><mml:mi mathvariant="bold">S</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold">T</mml:mi><mml:mo>〉</mml:mo><mml:mo>|</mml:mo><mml:mi mathvariant="script">A</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p>
      <p>The summation over all possible alignments as per <xref ref-type="disp-formula" rid="E3">Equation 2</xref> gives the marginal probability of the relationship between two sequences <inline-formula id="IE25"><mml:math id="IM25"><mml:mrow><mml:mo>〈</mml:mo><mml:mi mathvariant="bold">S</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold">T</mml:mi><mml:mo>〉</mml:mo></mml:mrow></mml:math></inline-formula>. The corresponding message length takes <inline-formula id="IE26"><mml:math id="IM26"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="normal">I</mml:mi></mml:mrow><mml:mrow><mml:mtext>marginal</mml:mtext></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mo>〈</mml:mo><mml:mi mathvariant="bold">S</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold">T</mml:mi><mml:mo>〉</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mrow><mml:mo> </mml:mo><mml:mtext>log</mml:mtext><mml:mo> </mml:mo></mml:mrow></mml:mrow><mml:mn>2</mml:mn></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>Pr</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mo>〈</mml:mo><mml:mi mathvariant="bold">S</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold">T</mml:mi><mml:mo>〉</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> bits. Marginal probability provides a general and unbiased probability estimate of the relationship compared with that of any specified alignment (see <xref ref-type="disp-formula" rid="E2">Equation 1</xref>). It follows that <inline-formula id="IE27"><mml:math id="IM27"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="normal">I</mml:mi></mml:mrow><mml:mrow><mml:mtext>marginal</mml:mtext></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mo>〈</mml:mo><mml:mi mathvariant="bold">S</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold">T</mml:mi><mml:mo>〉</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:mo>&lt;</mml:mo><mml:mi mathvariant="normal">I</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="script">A</mml:mi></mml:mrow><mml:mo>*</mml:mo></mml:msup><mml:mo>,</mml:mo><mml:mo>〈</mml:mo><mml:mi mathvariant="bold">S</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold">T</mml:mi><mml:mo>〉</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>.</p>
      <p>Finally, MML framework provides a natural null hypothesis test to verify the significance of any hypothesis (see Section 2.1). This involves explaining <bold>S</bold> and <bold>T</bold> independently, assuming they are unrelated. We refer to this as the <italic>null-model</italic> message whose length is given by:
<disp-formula id="E4"><label>(3)</label><mml:math id="M4"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="normal">I</mml:mi></mml:mrow><mml:mrow><mml:mtext>NULL</mml:mtext></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mo>〈</mml:mo><mml:mi mathvariant="bold">S</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold">T</mml:mi><mml:mo>〉</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="normal">I</mml:mi></mml:mrow><mml:mrow><mml:mtext>NULL</mml:mtext></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold">S</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="normal">I</mml:mi></mml:mrow><mml:mrow><mml:mtext>NULL</mml:mtext></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold">T</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mtext>bits</mml:mtext></mml:mrow></mml:math></disp-formula></p>
      <p>In general, if <inline-formula id="IE28"><mml:math id="IM28"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="normal">I</mml:mi></mml:mrow><mml:mrow><mml:mtext>NULL</mml:mtext></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mo>〈</mml:mo><mml:mi mathvariant="bold">S</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold">T</mml:mi><mml:mo>〉</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="normal">I</mml:mi></mml:mrow><mml:mrow><mml:mtext>marginal</mml:mtext></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mo>〈</mml:mo><mml:mi mathvariant="bold">S</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold">T</mml:mi><mml:mo>〉</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:mo>&gt;</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula>, the hypothesis that <inline-formula id="IE29"><mml:math id="IM29"><mml:mrow><mml:mo>〈</mml:mo><mml:mi mathvariant="bold">S</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold">T</mml:mi><mml:mo>〉</mml:mo></mml:mrow></mml:math></inline-formula> are related is accepted. Specifically, if <inline-formula id="IE30"><mml:math id="IM30"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="normal">I</mml:mi></mml:mrow><mml:mrow><mml:mtext>NULL</mml:mtext></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mo>〈</mml:mo><mml:mi mathvariant="bold">S</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold">T</mml:mi><mml:mo>〉</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:mo>−</mml:mo><mml:mi mathvariant="normal">I</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="script">A</mml:mi></mml:mrow><mml:mo>*</mml:mo></mml:msup><mml:mo>,</mml:mo><mml:mo>〈</mml:mo><mml:mi mathvariant="bold">S</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold">T</mml:mi><mml:mo>〉</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:mo>&gt;</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula>, then <inline-formula id="IE31"><mml:math id="IM31"><mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="script">A</mml:mi></mml:mrow><mml:mo>*</mml:mo></mml:msup></mml:mrow></mml:math></inline-formula> provides the best hypothesis of their relationship. Otherwise, both the marginal and optimal hypotheses are rejected.</p>
    </sec>
    <sec>
      <title>2.3 MML inference of Dirichlet priors on state machine parameters as a function of sequence distance</title>
      <p>As introduced in Section 2.2, any alignment <inline-formula id="IE32"><mml:math id="IM32"><mml:mi mathvariant="script">A</mml:mi></mml:math></inline-formula> of <inline-formula id="IE33"><mml:math id="IM33"><mml:mrow><mml:mo>〈</mml:mo><mml:mi mathvariant="bold">S</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold">T</mml:mi><mml:mo>〉</mml:mo></mml:mrow></mml:math></inline-formula> is a string produced by a three-state machine. <xref ref-type="fig" rid="btz368-F2">Figure 2</xref> illustrates the three-state machine over <bold><monospace>match</monospace></bold> (<bold><monospace>m</monospace></bold>), <bold><monospace>insert</monospace></bold> (<bold><monospace>i</monospace></bold>) and <bold><monospace>delete</monospace></bold> (<bold><monospace>d</monospace></bold>) states, with nine one-step transition probabilities. This machine has an implicit constraint that the sum of one-step transitions out of each state should add up to the probability of 1: <inline-formula id="IE34"><mml:math id="IM34"><mml:mrow><mml:mo>∑</mml:mo><mml:mrow><mml:mi>Pr</mml:mi></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mo>*</mml:mo><mml:mo>|</mml:mo><mml:mi mathvariant="monospace">m</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mo>∑</mml:mo><mml:mrow><mml:mi>Pr</mml:mi></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mo>*</mml:mo><mml:mo>|</mml:mo><mml:mi mathvariant="monospace">i</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mo>∑</mml:mo><mml:mrow><mml:mi>Pr</mml:mi></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mo>*</mml:mo><mml:mo>|</mml:mo><mml:mi mathvariant="monospace">m</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>∀</mml:mo><mml:mo>*</mml:mo><mml:mo>∈</mml:mo><mml:mo>{</mml:mo><mml:mi mathvariant="monospace">m</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="monospace">i</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="monospace">d</mml:mi><mml:mo>}</mml:mo></mml:mrow></mml:math></inline-formula>. Consistent to the accepted practice of aligning macromolecular sequences, the following transition symmetries are additionally enforced in this work: <inline-formula id="IE35"><mml:math id="IM35"><mml:mrow><mml:mi>Pr</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="monospace">i</mml:mi><mml:mo>|</mml:mo><mml:mi mathvariant="monospace">m</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mi>Pr</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="monospace">d</mml:mi><mml:mo>|</mml:mo><mml:mi mathvariant="monospace">m</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>; <inline-formula id="IE36"><mml:math id="IM36"><mml:mrow><mml:mi>Pr</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="monospace">m</mml:mi><mml:mo>|</mml:mo><mml:mi mathvariant="monospace">i</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mi>Pr</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="monospace">m</mml:mi><mml:mo>|</mml:mo><mml:mi mathvariant="monospace">d</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>; <inline-formula id="IE37"><mml:math id="IM37"><mml:mrow><mml:mi>Pr</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="monospace">d</mml:mi><mml:mo>|</mml:mo><mml:mi mathvariant="monospace">i</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mi>Pr</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="monospace">i</mml:mi><mml:mo>|</mml:mo><mml:mi mathvariant="monospace">d</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>; <inline-formula id="IE38"><mml:math id="IM38"><mml:mrow><mml:mi>Pr</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="monospace">i</mml:mi><mml:mo>|</mml:mo><mml:mi mathvariant="monospace">i</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mi>Pr</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="monospace">d</mml:mi><mml:mo>|</mml:mo><mml:mi mathvariant="monospace">d</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>. With these symmetries, the three-state alignment machine now has three free (unknown) parameters. Notionally, these are: (i) <inline-formula id="IE39"><mml:math id="IM39"><mml:mrow><mml:mi>Pr</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="monospace">m</mml:mi><mml:mo>|</mml:mo><mml:mi mathvariant="monospace">m</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>, (ii) <inline-formula id="IE40"><mml:math id="IM40"><mml:mrow><mml:mi>Pr</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="monospace">i</mml:mi><mml:mo>|</mml:mo><mml:mi mathvariant="monospace">i</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> and (iii) <inline-formula id="IE41"><mml:math id="IM41"><mml:mrow><mml:mi>Pr</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="monospace">m</mml:mi><mml:mo>|</mml:mo><mml:mi mathvariant="monospace">i</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>. Once these free parameters are estimated, the enforced symmetries allow the remaining transition probabilities to be assigned as follows: <inline-formula id="IE42"><mml:math id="IM42"><mml:mrow><mml:mi>Pr</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="monospace">i</mml:mi><mml:mo>|</mml:mo><mml:mi mathvariant="monospace">m</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mi>Pr</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="monospace">d</mml:mi><mml:mo>|</mml:mo><mml:mi mathvariant="monospace">m</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>Pr</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="monospace">m</mml:mi><mml:mo>|</mml:mo><mml:mi mathvariant="monospace">m</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:mfrac></mml:mrow></mml:math></inline-formula>; <inline-formula id="IE43"><mml:math id="IM43"><mml:mrow><mml:mi>Pr</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="monospace">d</mml:mi><mml:mo>|</mml:mo><mml:mi mathvariant="monospace">i</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mi>Pr</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="monospace">i</mml:mi><mml:mo>|</mml:mo><mml:mi mathvariant="monospace">d</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>Pr</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="monospace">i</mml:mi><mml:mo>|</mml:mo><mml:mi mathvariant="monospace">i</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>−</mml:mo><mml:mi>Pr</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="monospace">m</mml:mi><mml:mo>|</mml:mo><mml:mi mathvariant="monospace">i</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>; <inline-formula id="IE44"><mml:math id="IM44"><mml:mrow><mml:mi>Pr</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="monospace">d</mml:mi><mml:mo>|</mml:mo><mml:mi mathvariant="monospace">d</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mi>Pr</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="monospace">i</mml:mi><mml:mo>|</mml:mo><mml:mi mathvariant="monospace">i</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>; <inline-formula id="IE45"><mml:math id="IM45"><mml:mrow><mml:mi>Pr</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="monospace">m</mml:mi><mml:mo>|</mml:mo><mml:mi mathvariant="monospace">d</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mi>Pr</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="monospace">m</mml:mi><mml:mo>|</mml:mo><mml:mi mathvariant="monospace">i</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>.</p>
      <p>Therefore, our use of the symmetric three-state alignment machine entails estimation of the three free parameters distributed over a 1-simplex for <inline-formula id="IE46"><mml:math id="IM46"><mml:mrow><mml:mi>Pr</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="monospace">m</mml:mi><mml:mo>|</mml:mo><mml:mi mathvariant="monospace">m</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>, and a 2-simplex for <inline-formula id="IE47"><mml:math id="IM47"><mml:mrow><mml:mi>Pr</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="monospace">i</mml:mi><mml:mo>|</mml:mo><mml:mi mathvariant="monospace">i</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> and <inline-formula id="IE48"><mml:math id="IM48"><mml:mrow><mml:mi>Pr</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="monospace">m</mml:mi><mml:mo>|</mml:mo><mml:mi mathvariant="monospace">i</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>. We note that the unit <inline-formula id="IE49"><mml:math id="IM49"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>k</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>-simplex involves L1 normalized, <italic>k</italic> dimensional vectors (<xref rid="btz368-B1" ref-type="bibr">Allison, 2018</xref>). Thus, a vector of <italic>k</italic> probabilities corresponding to mutually exclusive events can be represented as a point in a unit (<italic>k</italic> − 1)-simplex.</p>
      <p>To estimate the state machine parameters, especially as a function of the distance between two sequences, we undertake the following one-time probabilistic modeling exercise using Dirichlet distributions over simplexes. These derived Dirichlet priors support the parameter estimation in our MML based protein sequence comparison framework.</p>
      <sec>
        <title>2.3.1 Preparation of datasets for inference</title>
        <p>We randomly sampled from SCOP (ver. 2.07) (<xref rid="btz368-B25" ref-type="bibr">Murzin <italic>et al.</italic>, 1995</xref>) a set of 118 384 protein structural domain-pairs, containing 47 687 domain-pairs that are related at a family level and 70 697 domain pairs related more distantly at a superfamily level. See <xref ref-type="supplementary-material" rid="sup1">Supplementary Section S3</xref> for details of the domain-pairs and the method used for random selection. All 118 384 domain pairs are <italic>structurally aligned</italic> using their 3D coordinate information (<xref rid="btz368-B8" ref-type="bibr">Collier <italic>et al.</italic>, 2017</xref>). These structural alignments are used in our modeling exercise below.</p>
        <p>Furthermore, these structural alignments are partitioned into subsets based on the observed sequence-distance between their corresponding SCOP domain-pairs. A surrogate measure of sequence-distance was provided by <xref rid="btz368-B9" ref-type="bibr">Dayhoff <italic>et al.</italic> (1978</xref>) in terms of Point Accepted Mutation (PAM) units. They derived PAM-1 transition probability matrix over the standard 20-letter amino acid alphabet that gives the probability of one amino acid mutating into another in a unit PAM distance step. The PAM-1 matrix can be generalized to any PAM-<italic>n</italic> via exponentiation, PAM-<italic>n</italic> = (PAM-1)<sup><italic>n</italic></sup>, which gives the probability of one amino acid mutating into another in <italic>n</italic> PAM distance steps. (Indeed other notions of sequence-distances could be used (e.g. BLOSUM). We use PAM in this work only for its convenience that allows us to generalize it systematically to arbitrary distances between sequences.)</p>
        <p>Therefore, for each structural alignment in our set of alignments, we identify the best integer <italic>n</italic> in the range [1, 1000] that maximizes the probability of matched amino acids in that alignment using PAM-<italic>n</italic>, yielding 1000 subsets of alignments. These alignment subsets are used to infer 1000 Dirichlet priors, one for each subset of observed alignments as a function of their corresponding sequence-distance.</p>
        <p>Dirichlet distributions are conjugate priors for multistate models over finite-state strings with any fixed <italic>k</italic> discrete states. Multistate models define <italic>k</italic> parameters <inline-formula id="IE50"><mml:math id="IM50"><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:msub><mml:mrow><mml:mo>θ</mml:mo></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mo>θ</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:msub><mml:mrow><mml:mo>θ</mml:mo></mml:mrow><mml:mi>k</mml:mi></mml:msub><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:math></inline-formula> (of which <italic>k</italic> − 1 are free) that lie in a (<italic>k</italic> − 1)-simplex. In our work, for each subset corresponding to the sequence-distance parameter <italic>n</italic> in the range [1, 1000], we have a set of observed three-state alignment strings. Our goal is to model these and infer Dirichlet prior parameters over the corresponding multistate transition probability parameters. As discussed above, the three free parameters of the symmetric three-state alignment machine (see <xref ref-type="fig" rid="btz368-F2">Fig. 2</xref>) can be decomposed and modeled using Dirichlet distributions over a unit 1-simplex (accounting for the free parameter <inline-formula id="IE51"><mml:math id="IM51"><mml:mrow><mml:mi>Pr</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="monospace">m</mml:mi><mml:mo>|</mml:mo><mml:mi mathvariant="monospace">m</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>), and a unit 2-simplex (accounting for the remaining free parameters <inline-formula id="IE52"><mml:math id="IM52"><mml:mrow><mml:mi>Pr</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="monospace">i</mml:mi><mml:mo>|</mml:mo><mml:mi mathvariant="monospace">i</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> and <inline-formula id="IE53"><mml:math id="IM53"><mml:mrow><mml:mi>Pr</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="monospace">m</mml:mi><mml:mo>|</mml:mo><mml:mi mathvariant="monospace">i</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>).</p>
        <p>Below we summarize the MML method of inferring free parameters from an observed dataset containing finite-state strings, along with their optimal Dirichlet prior parameters.</p>
      </sec>
      <sec>
        <title>2.3.2 Estimation of finite state transition probabilities over any Dirichlet prior</title>
        <p>Let <inline-formula id="IE54"><mml:math id="IM54"><mml:mrow><mml:mtext>Dir</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mstyle displaystyle="true"><mml:mover><mml:mi>α</mml:mi><mml:mo>→</mml:mo></mml:mover></mml:mstyle></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> be a Dirichlet distribution with model parameters <inline-formula id="IE55"><mml:math id="IM55"><mml:mrow><mml:mstyle displaystyle="true"><mml:mover><mml:mi>α</mml:mi><mml:mo>→</mml:mo></mml:mover></mml:mstyle><mml:mo>=</mml:mo><mml:mo stretchy="false">[</mml:mo><mml:msub><mml:mrow><mml:mo>α</mml:mo></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mo>α</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:msub><mml:mrow><mml:mo>α</mml:mo></mml:mrow><mml:mi>k</mml:mi></mml:msub><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:math></inline-formula> (for <italic>α<sub>i</sub></italic> &gt; 0) that describes a random variable (data sample) <inline-formula id="IE56"><mml:math id="IM56"><mml:mrow><mml:mstyle displaystyle="true"><mml:mover><mml:mi>Θ</mml:mi><mml:mo>→</mml:mo></mml:mover></mml:mstyle><mml:mo>=</mml:mo><mml:mo stretchy="false">[</mml:mo><mml:msub><mml:mrow><mml:mo>θ</mml:mo></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mo>θ</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:msub><mml:mrow><mml:mo>θ</mml:mo></mml:mrow><mml:mi>k</mml:mi></mml:msub><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:math></inline-formula> representing a point in the unit (<italic>k</italic> − 1)-simplex (i.e. <inline-formula id="IE57"><mml:math id="IM57"><mml:mrow><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>k</mml:mi></mml:munderover><mml:mrow><mml:msub><mml:mrow><mml:mo>θ</mml:mo></mml:mrow><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula>). The <inline-formula id="IE58"><mml:math id="IM58"><mml:mrow><mml:mstyle displaystyle="true"><mml:mover><mml:mi>α</mml:mi><mml:mo>→</mml:mo></mml:mover></mml:mstyle></mml:mrow></mml:math></inline-formula> can be reparameterized as <inline-formula id="IE59"><mml:math id="IM59"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mo>κ</mml:mo><mml:mo>,</mml:mo><mml:mrow><mml:mover accent="true"><mml:mi>μ</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> to intuitively show how the distribution concentrates with a concentration parameter <italic>κ</italic> around its L1-normalized mean vector <inline-formula id="IE60"><mml:math id="IM60"><mml:mrow><mml:mover accent="true"><mml:mi>μ</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mrow></mml:math></inline-formula> in the <italic>k</italic> − 1 simplex:
<disp-formula id="E5"><mml:math id="M5"><mml:mrow><mml:mstyle displaystyle="true"><mml:mover><mml:mi>α</mml:mi><mml:mo>→</mml:mo></mml:mover></mml:mstyle><mml:mo>=</mml:mo><mml:munder><mml:munder><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>k</mml:mi></mml:munderover><mml:mrow><mml:msub><mml:mrow><mml:mo>α</mml:mo></mml:mrow><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo stretchy="true">︸</mml:mo></mml:munder><mml:mrow><mml:mo>κ</mml:mo><mml:mo>=</mml:mo><mml:mtext>concentration</mml:mtext></mml:mrow></mml:munder><mml:mo>×</mml:mo><mml:munder><mml:munder><mml:mrow><mml:mo stretchy="true">[</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mo>α</mml:mo></mml:mrow><mml:mn>1</mml:mn></mml:msub></mml:mrow><mml:mrow><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>k</mml:mi></mml:msubsup><mml:mrow><mml:msub><mml:mrow><mml:mo>α</mml:mo></mml:mrow><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:mfrac><mml:mo>,</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mo>α</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msub></mml:mrow><mml:mrow><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>k</mml:mi></mml:msubsup><mml:mrow><mml:msub><mml:mrow><mml:mo>α</mml:mo></mml:mrow><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:mfrac><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mo>α</mml:mo></mml:mrow><mml:mi>k</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>k</mml:mi></mml:msubsup><mml:mrow><mml:msub><mml:mrow><mml:mo>α</mml:mo></mml:mrow><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:mfrac><mml:mo stretchy="true">]</mml:mo></mml:mrow><mml:mo stretchy="true">︸</mml:mo></mml:munder><mml:mrow><mml:mover accent="true"><mml:mi>μ</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:mtext>mean</mml:mtext><mml:mo> </mml:mo><mml:mtext>vector</mml:mtext></mml:mrow></mml:munder><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p>
        <p>Dirichlet probability density function is given by:
<disp-formula id="E6"><mml:math id="M6"><mml:mrow><mml:mi>f</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mstyle displaystyle="true"><mml:mover><mml:mi>Θ</mml:mi><mml:mo>→</mml:mo></mml:mover></mml:mstyle></mml:mrow><mml:mo>|</mml:mo><mml:mrow><mml:mstyle displaystyle="true"><mml:mover><mml:mi>α</mml:mi><mml:mo>→</mml:mo></mml:mover></mml:mstyle></mml:mrow><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mi mathvariant="normal">B</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mstyle displaystyle="true"><mml:mover><mml:mi>α</mml:mi><mml:mo>→</mml:mo></mml:mover></mml:mstyle></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfrac><mml:msubsup><mml:mo>∏</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>k</mml:mi></mml:msubsup><mml:mrow><mml:msup><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mo>θ</mml:mo></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mo>α</mml:mo></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mrow></mml:math></disp-formula>
where <inline-formula id="IE61"><mml:math id="IM61"><mml:mrow><mml:mi mathvariant="normal">B</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mstyle displaystyle="true"><mml:mover><mml:mi>α</mml:mi><mml:mo>→</mml:mo></mml:mover></mml:mstyle></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> is the multivariate Beta function written in terms of Gamma functions: <inline-formula id="IE62"><mml:math id="IM62"><mml:mrow><mml:mi mathvariant="normal">B</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mstyle displaystyle="true"><mml:mover><mml:mi>α</mml:mi><mml:mo>→</mml:mo></mml:mover></mml:mstyle></mml:mrow><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:msubsup><mml:mrow><mml:mo>Π</mml:mo></mml:mrow><mml:mn>1</mml:mn><mml:mi>k</mml:mi></mml:msubsup><mml:mo>Γ</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mo>α</mml:mo></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>/</mml:mo><mml:mo>Γ</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mo>κ</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>. The likelihood over data <inline-formula id="IE63"><mml:math id="IM63"><mml:mi mathvariant="bold">Θ</mml:mi></mml:math></inline-formula> with N data samples: <inline-formula id="IE64"><mml:math id="IM64"><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:msup><mml:mrow><mml:mstyle displaystyle="true"><mml:mover><mml:mi>Θ</mml:mi><mml:mo>→</mml:mo></mml:mover></mml:mstyle></mml:mrow><mml:mn>1</mml:mn></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mrow><mml:mstyle displaystyle="true"><mml:mover><mml:mi>Θ</mml:mi><mml:mo>→</mml:mo></mml:mover></mml:mstyle></mml:mrow><mml:mn>2</mml:mn></mml:msup><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:msup><mml:mrow><mml:mstyle displaystyle="true"><mml:mover><mml:mi>Θ</mml:mi><mml:mo>→</mml:mo></mml:mover></mml:mstyle></mml:mrow><mml:mi>N</mml:mi></mml:msup><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:math></inline-formula> is defined as: <inline-formula id="IE65"><mml:math id="IM65"><mml:mrow><mml:mi>f</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>Θ</mml:mi></mml:mstyle><mml:mo>|</mml:mo><mml:mstyle displaystyle="true"><mml:mover><mml:mi>α</mml:mi><mml:mo>→</mml:mo></mml:mover></mml:mstyle><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mstyle displaystyle="true"><mml:msubsup><mml:mo>∏</mml:mo><mml:mrow><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mtext>N</mml:mtext></mml:msubsup><mml:mtext> </mml:mtext></mml:mstyle><mml:mi>f</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mrow><mml:mstyle displaystyle="true"><mml:mover><mml:mi>Θ</mml:mi><mml:mo>→</mml:mo></mml:mover></mml:mstyle></mml:mrow><mml:mi>n</mml:mi></mml:msup><mml:mo>|</mml:mo><mml:mstyle displaystyle="true"><mml:mover><mml:mi>α</mml:mi><mml:mo>→</mml:mo></mml:mover></mml:mstyle><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>. Thus, the negative log likelihood function is:
<disp-formula id="E7"><mml:math id="M7"><mml:mrow><mml:mi mathvariant="script">L</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mstyle displaystyle="true"><mml:mover><mml:mi>α</mml:mi><mml:mo>→</mml:mo></mml:mover></mml:mstyle></mml:mrow><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:mi mathvariant="normal">N</mml:mi><mml:mo> </mml:mo><mml:mtext>log</mml:mtext><mml:mo> </mml:mo><mml:mo>Γ</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mo>κ</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:mi mathvariant="normal">N</mml:mi><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>k</mml:mi></mml:munderover><mml:mrow><mml:mo> </mml:mo><mml:mtext>log</mml:mtext><mml:mo> </mml:mo></mml:mrow><mml:mo>Γ</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mo>α</mml:mo></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>−</mml:mo><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi mathvariant="normal">N</mml:mi></mml:munderover><mml:mrow><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>k</mml:mi></mml:munderover><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mo>α</mml:mo></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo> </mml:mo><mml:mtext>log</mml:mtext><mml:mo> </mml:mo><mml:msubsup><mml:mrow><mml:mo>θ</mml:mo></mml:mrow><mml:mi>i</mml:mi><mml:mi>n</mml:mi></mml:msubsup></mml:mrow></mml:math></disp-formula></p>
        <p>The determinant of the Fisher matrix, which indicates the sensitivity of the expected negative log likelihood function to the changes of <inline-formula id="IE66"><mml:math id="IM66"><mml:mrow><mml:mstyle displaystyle="true"><mml:mover><mml:mi>α</mml:mi><mml:mo>→</mml:mo></mml:mover></mml:mstyle></mml:mrow></mml:math></inline-formula> is given by <xref rid="btz368-B1" ref-type="bibr">Allison (2018</xref>):
<disp-formula id="E8"><mml:math id="M8"><mml:mrow><mml:mtext>det</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mtext>Fisher</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mstyle displaystyle="true"><mml:mover><mml:mi>α</mml:mi><mml:mo>→</mml:mo></mml:mover></mml:mstyle></mml:mrow><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="normal">N</mml:mi></mml:mrow><mml:mi>k</mml:mi></mml:msup><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mrow><mml:munderover><mml:mo>∏</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>k</mml:mi></mml:munderover><mml:mrow><mml:msub><mml:mrow><mml:mo>ψ</mml:mo></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mo>α</mml:mo></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo stretchy="true">)</mml:mo></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mo>ψ</mml:mo></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mo>κ</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>k</mml:mi></mml:munderover><mml:mrow><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:msub><mml:mrow><mml:mo>ψ</mml:mo></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mo>α</mml:mo></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfrac></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>
where <inline-formula id="IE67"><mml:math id="IM67"><mml:mrow><mml:msub><mml:mrow><mml:mo>ψ</mml:mo></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>z</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msup><mml:mrow><mml:mo>∂</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow><mml:mrow><mml:mo>∂</mml:mo><mml:msup><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mfrac><mml:mtext>log</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mo>Γ</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="normal">z</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> is the Trigamma function.</p>
        <p>The general estimation method of <xref rid="btz368-B40" ref-type="bibr">Wallace and Freeman (1987</xref>) is used to derive the MML estimates of the free parameters of a multistate model with a specified Dirichlet prior <inline-formula id="IE68"><mml:math id="IM68"><mml:mrow><mml:mtext>Dir</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mstyle displaystyle="true"><mml:mover><mml:mi>α</mml:mi><mml:mo>→</mml:mo></mml:mover></mml:mstyle></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>:
<disp-formula id="E9"><label>(4)</label><mml:math id="M9"><mml:mrow><mml:mover accent="true"><mml:mrow><mml:msub><mml:mrow><mml:mi>θ</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="true">^</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mo>α</mml:mo></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:mn>0.5</mml:mn></mml:mrow><mml:mrow><mml:mi>X</mml:mi><mml:mo>+</mml:mo><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>k</mml:mi></mml:munderover><mml:mrow><mml:msub><mml:mrow><mml:mo>α</mml:mo></mml:mrow><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mo>−</mml:mo><mml:mfrac><mml:mi>k</mml:mi><mml:mn>2</mml:mn></mml:mfrac></mml:mrow></mml:mfrac></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></disp-formula>
where <italic>x<sub>i</sub></italic> is the number of observations of the <italic>i</italic>-th state-transitions (corresponding to the <italic>i</italic>-th parameter) in the multistate model, <italic>X</italic> is the total number of state-transitions over all states and <inline-formula id="IE69"><mml:math id="IM69"><mml:mrow><mml:msub><mml:mrow><mml:mo>α</mml:mo></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo>∈</mml:mo><mml:mrow><mml:mstyle displaystyle="true"><mml:mover><mml:mi>α</mml:mi><mml:mo>→</mml:mo></mml:mover></mml:mstyle></mml:mrow></mml:mrow></mml:math></inline-formula> is the corresponding Dirichlet prior parameter (see <xref ref-type="supplementary-material" rid="sup1">Supplementary Sections S1</xref>). The inference of the optimal Dirichlet parameters is discussed below.</p>
      </sec>
      <sec>
        <title>2.3.3 Estimation of Dirichlet parameters over finite-state strings</title>
        <p>Let <bold>A</bold> be a set of <italic>N</italic> finite-state strings, each with <italic>k</italic> discrete states, and <inline-formula id="IE70"><mml:math id="IM70"><mml:mrow><mml:mi mathvariant="bold">Θ</mml:mi><mml:mo>=</mml:mo><mml:mo stretchy="false">[</mml:mo><mml:msup><mml:mrow><mml:mstyle displaystyle="true"><mml:mover><mml:mi>Θ</mml:mi><mml:mo>→</mml:mo></mml:mover></mml:mstyle></mml:mrow><mml:mn>1</mml:mn></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mrow><mml:mstyle displaystyle="true"><mml:mover><mml:mi>Θ</mml:mi><mml:mo>→</mml:mo></mml:mover></mml:mstyle></mml:mrow><mml:mn>2</mml:mn></mml:msup><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:msup><mml:mrow><mml:mstyle displaystyle="true"><mml:mover><mml:mi>Θ</mml:mi><mml:mo>→</mml:mo></mml:mover></mml:mstyle></mml:mrow><mml:mi>N</mml:mi></mml:msup><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:math></inline-formula> be their corresponding set of <italic>N</italic> state parameter vectors each lying in a (<italic>k</italic> − 1)-simplex. The MML estimate <inline-formula id="IE71"><mml:math id="IM71"><mml:mrow><mml:msup><mml:mrow><mml:mstyle displaystyle="true"><mml:mover><mml:mi>α</mml:mi><mml:mo>→</mml:mo></mml:mover></mml:mstyle></mml:mrow><mml:mrow><mml:mtext>MML</mml:mtext></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula> of the Dirichlet parameters over the set <bold>A</bold> and <inline-formula id="IE72"><mml:math id="IM72"><mml:mi mathvariant="bold">Θ</mml:mi></mml:math></inline-formula> is the one that minimizes the two-part message length, as follows:
<disp-formula id="E10"><label>(5)</label><mml:math id="M10"><mml:mrow><mml:mtext>arg</mml:mtext><mml:munder><mml:mrow><mml:mi>min</mml:mi></mml:mrow><mml:mstyle displaystyle="true"><mml:mover><mml:mi>α</mml:mi><mml:mo>→</mml:mo></mml:mover></mml:mstyle></mml:munder><mml:mtext> </mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mtext>I</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mstyle displaystyle="true"><mml:mover><mml:mi>α</mml:mi><mml:mo>→</mml:mo></mml:mover></mml:mstyle><mml:mo>,</mml:mo><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>Θ</mml:mi></mml:mstyle><mml:mo>,</mml:mo><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>A</mml:mi></mml:mstyle><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:munder><mml:munder><mml:mrow><mml:mtext>I</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mstyle displaystyle="true"><mml:mover><mml:mi>α</mml:mi><mml:mo>→</mml:mo></mml:mover></mml:mstyle><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:mtext>I</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>Θ</mml:mi></mml:mstyle><mml:mo>|</mml:mo><mml:mstyle displaystyle="true"><mml:mover><mml:mi>α</mml:mi><mml:mo>→</mml:mo></mml:mover></mml:mstyle><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo stretchy="true">︸</mml:mo></mml:munder><mml:mrow><mml:mtext>First part</mml:mtext></mml:mrow></mml:munder><mml:mo>+</mml:mo><mml:munder><mml:munder><mml:mrow><mml:mtext>I</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>A</mml:mi></mml:mstyle><mml:mo>|</mml:mo><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>Θ</mml:mi></mml:mstyle><mml:mo>,</mml:mo><mml:mstyle displaystyle="true"><mml:mover><mml:mi>α</mml:mi><mml:mo>→</mml:mo></mml:mover></mml:mstyle><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo stretchy="true">︸</mml:mo></mml:munder><mml:mrow><mml:mtext>Second part</mml:mtext></mml:mrow></mml:munder><mml:mo stretchy="false">)</mml:mo><mml:mtext> bits</mml:mtext></mml:mrow></mml:math></disp-formula></p>
        <p><inline-formula id="IE73"><mml:math id="IM73"><mml:mrow><mml:mi mathvariant="normal">I</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mstyle displaystyle="true"><mml:mover><mml:mi>α</mml:mi><mml:mo>→</mml:mo></mml:mover></mml:mstyle></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> and <inline-formula id="IE74"><mml:math id="IM74"><mml:mrow><mml:mi>I</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold">Θ</mml:mi><mml:mo>|</mml:mo><mml:mrow><mml:mstyle displaystyle="true"><mml:mover><mml:mi>α</mml:mi><mml:mo>→</mml:mo></mml:mover></mml:mstyle></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> deal with the message length terms required to transmit the Dirichlet and state parameters, respectively. Finally, <inline-formula id="IE75"><mml:math id="IM75"><mml:mrow><mml:mi>I</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold">A</mml:mi><mml:mo>|</mml:mo><mml:mi mathvariant="bold">Θ</mml:mi><mml:mo>,</mml:mo><mml:mrow><mml:mstyle displaystyle="true"><mml:mover><mml:mi>α</mml:mi><mml:mo>→</mml:mo></mml:mover></mml:mstyle></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> deals with the transmission of all finite-state strings in <bold>A</bold>, using the corresponding state parameters <inline-formula id="IE76"><mml:math id="IM76"><mml:mi mathvariant="bold">Θ</mml:mi></mml:math></inline-formula> and Dirichlet prior <inline-formula id="IE77"><mml:math id="IM77"><mml:mrow><mml:mstyle displaystyle="true"><mml:mover><mml:mi>α</mml:mi><mml:mo>→</mml:mo></mml:mover></mml:mstyle></mml:mrow></mml:math></inline-formula> (see <xref ref-type="supplementary-material" rid="sup1">Supplementary Section S2</xref>).</p>
        <p>The Dirichlet parameter estimator defined by <xref ref-type="disp-formula" rid="E10">Equation 5</xref> is used on the subsets of structural alignments defined over PAM-based sequence distances in the range <inline-formula id="IE78"><mml:math id="IM78"><mml:mrow><mml:mi>n</mml:mi><mml:mo>∈</mml:mo><mml:mo stretchy="false">[</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>1000</mml:mn><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:math></inline-formula>, to derive 1000 Dirichlet priors as a function of sequence-distance parameter <italic>n</italic> (see Section 3). These precomputed priors are employed to assign alignment state machine parameters when comparing any two sequences, as discussed below.</p>
      </sec>
    </sec>
    <sec>
      <title>2.4 Practical considerations for protein sequence comparison and alignment using the MML framework</title>
      <sec>
        <title>2.4.1 Estimation of null-model message length</title>
        <p><xref ref-type="disp-formula" rid="E4">Equation 3</xref> in Section 2.2 involves the computation of null model message lengths of individual amino acid sequences, <bold>S</bold> and <bold>T</bold>. This in turn involves the statement of each amino acid symbol in these sequences using their respective null probabilities.</p>
        <p>The MML estimate of the null probability for any amino acid symbol is computed over the large corpus of protein sequences derived from the Universal Protein Resource (UniProt-Consortium <italic>et al.</italic>, <xref rid="btz368-B35" ref-type="bibr">2017</xref>). Specifically, <inline-formula id="IE79"><mml:math id="IM79"><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:msub><mml:mrow><mml:mo>θ</mml:mo></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mo>θ</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:msub><mml:mrow><mml:mo>θ</mml:mo></mml:mrow><mml:mrow><mml:mn>20</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:math></inline-formula> corresponding to the 20-state amino acid strings are computed using <xref ref-type="disp-formula" rid="E9">Equation 4</xref> by setting the 20-dimensional Dirichlet parameter vector to <inline-formula id="IE80"><mml:math id="IM80"><mml:mrow><mml:mstyle displaystyle="true"><mml:mover><mml:mi>α</mml:mi><mml:mo>→</mml:mo></mml:mover></mml:mstyle><mml:mo>=</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>. This is same as using a uniform prior for the estimation of the null probabilities. We note that the estimation of null probabilities for amino acid sequences is one-off and independent of any particular sequence comparison.</p>
        <p>The individual encoding of any sequence <inline-formula id="IE81"><mml:math id="IM81"><mml:mrow><mml:mi mathvariant="bold">Y</mml:mi><mml:mo>=</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msub><mml:mo>…</mml:mo><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mo>|</mml:mo><mml:mi mathvariant="bold">Y</mml:mi><mml:mo>|</mml:mo></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> first encodes the length <inline-formula id="IE82"><mml:math id="IM82"><mml:mrow><mml:mo>|</mml:mo><mml:mi mathvariant="bold">Y</mml:mi><mml:mo>|</mml:mo></mml:mrow></mml:math></inline-formula> over a universal integer code—we use Wallace Tree Codes (<xref rid="btz368-B38" ref-type="bibr">Wallace, 2005</xref>; <xref rid="btz368-B41" ref-type="bibr">Wallace and Patrick, 1993</xref>)—followed by successive statements of individual amino acids in the sequence using the null probability estimates:
<disp-formula id="E11"><mml:math id="M11"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold">I</mml:mi></mml:mrow><mml:mrow><mml:mtext>NULL</mml:mtext></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold">Y</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold">I</mml:mi></mml:mrow><mml:mrow><mml:mtext>integer</mml:mtext></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mo>|</mml:mo><mml:mi mathvariant="bold">Y</mml:mi><mml:mo>|</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mo>|</mml:mo><mml:mi mathvariant="bold">Y</mml:mi><mml:mo>|</mml:mo></mml:mrow></mml:munderover><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold">I</mml:mi></mml:mrow><mml:mrow><mml:mtext>NULL</mml:mtext></mml:mrow></mml:msub></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo> </mml:mo><mml:mtext>bits</mml:mtext></mml:mrow></mml:math></disp-formula></p>
        <p>Applying the above equation to <bold>S</bold> and <bold>T</bold> yields the required null-model message length, <inline-formula id="IE83"><mml:math id="IM83"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="normal">I</mml:mi></mml:mrow><mml:mrow><mml:mtext>NULL</mml:mtext></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mo>〈</mml:mo><mml:mi mathvariant="bold">S</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold">T</mml:mi><mml:mo>〉</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>.</p>
      </sec>
      <sec>
        <title>2.4.2 Estimation of alignment-model message length</title>
        <p><xref ref-type="disp-formula" rid="E2">Equation 1</xref> in Section 2.2 gives the length of the two-part message to communicate any sequence pair <inline-formula id="IE84"><mml:math id="IM84"><mml:mrow><mml:mo>〈</mml:mo><mml:mi mathvariant="bold">S</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold">T</mml:mi><mml:mo>〉</mml:mo></mml:mrow></mml:math></inline-formula> over an alignment hypothesis <inline-formula id="IE85"><mml:math id="IM85"><mml:mi mathvariant="script">A</mml:mi></mml:math></inline-formula>. The first part encoding deals with the statement of an alignment hypothesis <inline-formula id="IE86"><mml:math id="IM86"><mml:mi mathvariant="script">A</mml:mi></mml:math></inline-formula> as a three-state string over the finite state machine with <bold><monospace>m</monospace></bold>, <bold><monospace>i</monospace></bold> and <bold><monospace>d</monospace></bold> states, as depicted in <xref ref-type="fig" rid="btz368-F2">Figure 2</xref>. From the Dirichlet modeling exercise carried out in Section 2.3, for any stated PAM-<italic>n</italic> distance between <inline-formula id="IE87"><mml:math id="IM87"><mml:mrow><mml:mo>〈</mml:mo><mml:mi mathvariant="bold">S</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold">T</mml:mi><mml:mo>〉</mml:mo></mml:mrow></mml:math></inline-formula> with <inline-formula id="IE88"><mml:math id="IM88"><mml:mrow><mml:mi>n</mml:mi><mml:mo>∈</mml:mo><mml:mo stretchy="false">[</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>1000</mml:mn><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:math></inline-formula>, we have an associated Dirichlet prior. In this work, we chose the mode (i.e. point of maximum probability density) of the nominated Dirichlet distribution to define the nine state transition parameters. Since Dirichlet priors can be treated as common knowledge between the transmitter and receiver, the transmitter needs only to state the parameter <italic>n</italic>. (Under a uniform assumption of <inline-formula id="IE89"><mml:math id="IM89"><mml:mrow><mml:mi>n</mml:mi><mml:mo>∈</mml:mo><mml:mo stretchy="false">[</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>1000</mml:mn><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:math></inline-formula>, the code length to state <italic>n</italic> is estimated as <inline-formula id="IE90"><mml:math id="IM90"><mml:mrow><mml:mi mathvariant="bold">I</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mrow><mml:mo> </mml:mo><mml:mtext>log</mml:mtext><mml:mo> </mml:mo></mml:mrow></mml:mrow><mml:mn>2</mml:mn></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mn>1000</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mn>9.965</mml:mn></mml:mrow></mml:math></inline-formula> bits.) Once <italic>n</italic> is decoded, the receiver gains knowledge of the precise state transition probabilities used in the transmission of <inline-formula id="IE91"><mml:math id="IM91"><mml:mi mathvariant="script">A</mml:mi></mml:math></inline-formula>.</p>
        <p>Consequently, the first part message length can be decomposed into its constituents as follow.
<disp-formula id="E12"><mml:math id="M12"><mml:mrow><mml:mi mathvariant="normal">I</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="script">A</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:munder><mml:munder><mml:mrow><mml:mi mathvariant="bold">I</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo stretchy="false">︸</mml:mo></mml:munder><mml:mrow><mml:mtext>distance</mml:mtext></mml:mrow></mml:munder><mml:mo>+</mml:mo><mml:mo> </mml:mo><mml:munder><mml:munder><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="normal">I</mml:mi></mml:mrow><mml:mrow><mml:mtext>integer</mml:mtext></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mo>|</mml:mo><mml:mi mathvariant="script">A</mml:mi><mml:mo>|</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo stretchy="false">︸</mml:mo></mml:munder><mml:mrow><mml:mtext>length</mml:mtext></mml:mrow></mml:munder><mml:mo> </mml:mo><mml:mo>+</mml:mo><mml:munder><mml:munder><mml:mrow><mml:mi mathvariant="normal">I</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="script">A</mml:mi><mml:mo>|</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo stretchy="false">︸</mml:mo></mml:munder><mml:mrow><mml:mn>3</mml:mn><mml:mo>-</mml:mo><mml:mtext>state</mml:mtext><mml:mo> </mml:mo><mml:mtext>string</mml:mtext></mml:mrow></mml:munder><mml:mtext>bits</mml:mtext></mml:mrow></mml:math></disp-formula></p>
        <p>The second part encoding involves explaining the amino acid symbols in <inline-formula id="IE92"><mml:math id="IM92"><mml:mrow><mml:mo>〈</mml:mo><mml:mi mathvariant="bold">S</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold">T</mml:mi><mml:mo>〉</mml:mo></mml:mrow></mml:math></inline-formula> using the alignment hypothesis <inline-formula id="IE93"><mml:math id="IM93"><mml:mi mathvariant="script">A</mml:mi></mml:math></inline-formula> and the distance parameter <italic>n</italic> (both communicated in the first part). Each position in the alignment indicates one of the three possibilities: (i) an amino acid symbol <inline-formula id="IE94"><mml:math id="IM94"><mml:mrow><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo>∈</mml:mo><mml:mi mathvariant="bold">S</mml:mi></mml:mrow></mml:math></inline-formula> is unmatched (<bold><monospace>delete</monospace></bold>); (ii) an amino acid symbol <inline-formula id="IE95"><mml:math id="IM95"><mml:mrow><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mi>j</mml:mi></mml:msub><mml:mo>∈</mml:mo><mml:mi mathvariant="bold">T</mml:mi></mml:mrow></mml:math></inline-formula> is unmatched (<bold><monospace>insert</monospace></bold>); and (iii) a pair of amino acid symbols <inline-formula id="IE96"><mml:math id="IM96"><mml:mrow><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo>∈</mml:mo><mml:mi mathvariant="bold">S</mml:mi></mml:mrow></mml:math></inline-formula> and <inline-formula id="IE97"><mml:math id="IM97"><mml:mrow><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mi>j</mml:mi></mml:msub><mml:mo>∈</mml:mo><mml:mi mathvariant="bold">T</mml:mi></mml:mrow></mml:math></inline-formula> are matched (<bold><monospace>match</monospace></bold>).</p>
        <p>The statement of unmatched amino acid symbols in <bold>S</bold> and <bold>T</bold> are carried out using their null probabilities as defined in Section 2.4.1. For the matched amino acid symbols <italic>s<sub>i</sub></italic>: <italic>t<sub>j</sub></italic>, given the knowledge of their sequence distance <italic>n</italic>, their joint probability is computed using PAM-<italic>n</italic> as:
<disp-formula id="E13"><mml:math id="M13"><mml:mrow><mml:mi>Pr</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mo>〈</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mi>j</mml:mi></mml:msub></mml:mrow><mml:mo>〉</mml:mo></mml:mrow><mml:mo>|</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>Pr</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mi>Pr</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mi>j</mml:mi></mml:msub><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:mi>Pr</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mi>j</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mi>Pr</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mi>j</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:mo>/</mml:mo><mml:mn>2.</mml:mn></mml:mrow></mml:math></disp-formula></p>
        <p>This joint probability estimate is a symmetric measure independent of the assumed order of the two sequences being considered. Negative logarithm of this joint probability gives the Shannon’s information content (i.e. statement length) of communicating the matched amino acid pair. The total length of stating <inline-formula id="IE98"><mml:math id="IM98"><mml:mrow><mml:mo>〈</mml:mo><mml:mi mathvariant="bold">S</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold">T</mml:mi><mml:mo>〉</mml:mo></mml:mrow></mml:math></inline-formula> over any alignment <inline-formula id="IE99"><mml:math id="IM99"><mml:mi mathvariant="script">A</mml:mi></mml:math></inline-formula>, <inline-formula id="IE100"><mml:math id="IM100"><mml:mrow><mml:mi mathvariant="normal">I</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mo>〈</mml:mo><mml:mi mathvariant="bold">S</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold">T</mml:mi><mml:mo>〉</mml:mo><mml:mo>|</mml:mo><mml:mi mathvariant="script">A</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>, sums up the statement lengths over all matched and unmatched positions in <inline-formula id="IE101"><mml:math id="IM101"><mml:mi mathvariant="script">A</mml:mi></mml:math></inline-formula>, as described above.</p>
      </sec>
      <sec>
        <title>2.4.3 Dynamic programming algorithm to compute the marginal probability of sequences</title>
        <p>Here, we propose a <inline-formula id="IE102"><mml:math id="IM102"><mml:mrow><mml:mi>O</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mo>|</mml:mo><mml:mi mathvariant="bold">S</mml:mi><mml:mo>|</mml:mo><mml:mo>|</mml:mo><mml:mi mathvariant="bold">T</mml:mi><mml:mo>|</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>-time and space algorithm to compute the marginal probability of <inline-formula id="IE103"><mml:math id="IM103"><mml:mrow><mml:mo>〈</mml:mo><mml:mi mathvariant="bold">S</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold">T</mml:mi><mml:mo>〉</mml:mo></mml:mrow></mml:math></inline-formula>, as defined in Section 2.2. The approach requires storing three dynamic programming algorithm (DPA) history matrices: <inline-formula id="IE104"><mml:math id="IM104"><mml:mrow><mml:msub><mml:mrow><mml:mrow><mml:mtext>Tot</mml:mtext></mml:mrow></mml:mrow><mml:mi mathvariant="monospace">m</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:msub><mml:mrow><mml:mrow><mml:mtext>Tot</mml:mtext></mml:mrow></mml:mrow><mml:mi mathvariant="monospace">i</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula>, and <inline-formula id="IE105"><mml:math id="IM105"><mml:mrow><mml:msub><mml:mrow><mml:mrow><mml:mtext>Tot</mml:mtext></mml:mrow></mml:mrow><mml:mi mathvariant="monospace">d</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula>. Each cell (<italic>i</italic>, <italic>j</italic>) in these matrices stores the negative logarithm of the marginal probability that the prefixes <inline-formula id="IE106"><mml:math id="IM106"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold">S</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>…</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>:</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold">T</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>…</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> are related, by summing over all alignments ending in a <bold><monospace>match</monospace></bold>, <bold><monospace>insert</monospace></bold> and <bold><monospace>delete</monospace></bold> state, respectively. This can be efficiently computed using the negative LogSumExp (LSE) function under the dynamic programming recurrences given below, where LSE computes the logarithm of the sum of exponentials of its arguments:
<disp-formula id="E14"><mml:math id="M14"><mml:mtable><mml:mtr><mml:mtd><mml:msub><mml:mrow><mml:mtext>Tot</mml:mtext></mml:mrow><mml:mi mathvariant="monospace">m</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:mtext>LSE</mml:mtext><mml:mrow><mml:mo stretchy="true">{</mml:mo><mml:mrow><mml:mtable><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow><mml:msub><mml:mrow><mml:mrow><mml:mtext>Tot</mml:mtext></mml:mrow></mml:mrow><mml:mi mathvariant="monospace">m</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo>−</mml:mo><mml:mtext>log</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mi>Pr</mml:mi><mml:mo>(</mml:mo><mml:mi mathvariant="monospace">m</mml:mi><mml:mo>|</mml:mo><mml:mi mathvariant="monospace">m</mml:mi><mml:mo>)</mml:mo><mml:mi>Pr</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mo>〈</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mi>j</mml:mi></mml:msub></mml:mrow><mml:mo>〉</mml:mo></mml:mrow><mml:mo>|</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow><mml:msub><mml:mrow><mml:mrow><mml:mtext>Tot</mml:mtext></mml:mrow></mml:mrow><mml:mi mathvariant="monospace">d</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo>−</mml:mo><mml:mtext>log</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mi>Pr</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="monospace">m</mml:mi><mml:mo>|</mml:mo><mml:mi mathvariant="monospace">d</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mi>Pr</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mo>〈</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mi>j</mml:mi></mml:msub></mml:mrow><mml:mo>〉</mml:mo></mml:mrow><mml:mo>|</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow><mml:msub><mml:mrow><mml:mrow><mml:mtext>Tot</mml:mtext></mml:mrow></mml:mrow><mml:mi mathvariant="monospace">i</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo>−</mml:mo><mml:mtext>log</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mi>Pr</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="monospace">m</mml:mi><mml:mo>|</mml:mo><mml:mi mathvariant="monospace">i</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mi>Pr</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mo>〈</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mi>j</mml:mi></mml:msub></mml:mrow><mml:mo>〉</mml:mo></mml:mrow><mml:mo>|</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></disp-formula><disp-formula id="E14a"><mml:math id="M15"><mml:mtable><mml:mtr><mml:mtd><mml:msub><mml:mrow><mml:mtext>Tot</mml:mtext></mml:mrow><mml:mi mathvariant="monospace">d</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:mtext>LSE</mml:mtext><mml:mrow><mml:mo stretchy="true">{</mml:mo><mml:mrow><mml:mtable><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow><mml:msub><mml:mrow><mml:mrow><mml:mtext>Tot</mml:mtext></mml:mrow></mml:mrow><mml:mi mathvariant="monospace">m</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>−</mml:mo><mml:mtext>log</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mi>Pr</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="monospace">d</mml:mi><mml:mo>|</mml:mo><mml:mi mathvariant="monospace">m</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mi>Pr</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow><mml:msub><mml:mrow><mml:mrow><mml:mtext>Tot</mml:mtext></mml:mrow></mml:mrow><mml:mi mathvariant="monospace">d</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>−</mml:mo><mml:mtext>log</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mi>Pr</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="monospace">d</mml:mi><mml:mo>|</mml:mo><mml:mi mathvariant="monospace">d</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mi>Pr</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow><mml:msub><mml:mrow><mml:mrow><mml:mtext>Tot</mml:mtext></mml:mrow></mml:mrow><mml:mi mathvariant="monospace">i</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>−</mml:mo><mml:mtext>log</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mi>Pr</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="monospace">d</mml:mi><mml:mo>|</mml:mo><mml:mi mathvariant="monospace">i</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mi>Pr</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></disp-formula><disp-formula id="E14c"><mml:math id="M16"><mml:mtable><mml:mtr><mml:mtd><mml:msub><mml:mrow><mml:mtext>Tot</mml:mtext></mml:mrow><mml:mi mathvariant="monospace">i</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:mtext>LSE</mml:mtext><mml:mrow><mml:mo stretchy="true">{</mml:mo><mml:mrow><mml:mtable><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow><mml:msub><mml:mrow><mml:mrow><mml:mtext>Tot</mml:mtext></mml:mrow></mml:mrow><mml:mi mathvariant="monospace">m</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo>−</mml:mo><mml:mtext>log</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mi>Pr</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="monospace">i</mml:mi><mml:mo>|</mml:mo><mml:mi mathvariant="monospace">m</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mi>Pr</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mi>j</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow><mml:msub><mml:mrow><mml:mrow><mml:mtext>Tot</mml:mtext></mml:mrow></mml:mrow><mml:mi mathvariant="monospace">d</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo>−</mml:mo><mml:mtext>log</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mi>Pr</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="monospace">i</mml:mi><mml:mo>|</mml:mo><mml:mi mathvariant="monospace">d</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mi>Pr</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mi>j</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow><mml:msub><mml:mrow><mml:mrow><mml:mtext>Tot</mml:mtext></mml:mrow></mml:mrow><mml:mi mathvariant="monospace">i</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo>−</mml:mo><mml:mtext>log</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mi>Pr</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="monospace">i</mml:mi><mml:mo>|</mml:mo><mml:mi mathvariant="monospace">i</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mi>Pr</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mi>j</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></disp-formula></p>
        <p>Thus, the negative logarithm of the marginal probability that <inline-formula id="IE107"><mml:math id="IM107"><mml:mrow><mml:mi mathvariant="bold">S</mml:mi><mml:mo>:</mml:mo><mml:mi mathvariant="bold">T</mml:mi></mml:mrow></mml:math></inline-formula> are related is given by <inline-formula id="IE108"><mml:math id="IM108"><mml:mrow><mml:mo>−</mml:mo><mml:mtext>LSE</mml:mtext><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mrow><mml:mtext>Tot</mml:mtext></mml:mrow></mml:mrow><mml:mi mathvariant="monospace">m</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mo>|</mml:mo><mml:mi mathvariant="bold">S</mml:mi><mml:mo>|</mml:mo><mml:mo>,</mml:mo><mml:mo>|</mml:mo><mml:mi mathvariant="bold">T</mml:mi><mml:mo>|</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mrow><mml:mtext>Tot</mml:mtext></mml:mrow></mml:mrow><mml:mi mathvariant="monospace">d</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mo>|</mml:mo><mml:mi mathvariant="bold">S</mml:mi><mml:mo>|</mml:mo><mml:mo>,</mml:mo><mml:mo>|</mml:mo><mml:mi mathvariant="bold">T</mml:mi><mml:mo>|</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mrow><mml:mtext>Tot</mml:mtext></mml:mrow></mml:mrow><mml:mi mathvariant="monospace">i</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mo>|</mml:mo><mml:mi mathvariant="bold">S</mml:mi><mml:mo>|</mml:mo><mml:mo>,</mml:mo><mml:mo>|</mml:mo><mml:mi mathvariant="bold">T</mml:mi><mml:mo>|</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>}</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>, plus the constants associated with stating <italic>n</italic>, taking <inline-formula id="IE109"><mml:math id="IM109"><mml:mrow><mml:mtext>log</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mn>1000</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> bits, and the sum of lengths of the two sequences, <inline-formula id="IE110"><mml:math id="IM110"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="normal">I</mml:mi></mml:mrow><mml:mrow><mml:mtext>integer</mml:mtext></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mo>|</mml:mo><mml:mi mathvariant="bold">S</mml:mi><mml:mo>|</mml:mo><mml:mo>+</mml:mo><mml:mo>|</mml:mo><mml:mi mathvariant="bold">T</mml:mi><mml:mo>|</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>. Furthermore, in the above set of DPA recurrences, replacing –LSE function by min function yields the method to compute the best alignment hypothesis under our MML framework.</p>
        <p>Finally, an approach similar to the bisection method is used to identify the corresponding optimal distance parameter <italic>n</italic> that yields the best estimate for <inline-formula id="IE111"><mml:math id="IM111"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="normal">I</mml:mi></mml:mrow><mml:mrow><mml:mtext>marginal</mml:mtext></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mo>〈</mml:mo><mml:mi mathvariant="bold">S</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold">T</mml:mi><mml:mo>〉</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>, and separately for <inline-formula id="IE112"><mml:math id="IM112"><mml:mrow><mml:mi mathvariant="normal">I</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="script">A</mml:mi></mml:mrow><mml:mo>*</mml:mo></mml:msup><mml:mo>,</mml:mo><mml:mo>〈</mml:mo><mml:mi mathvariant="bold">S</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold">T</mml:mi><mml:mo>〉</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>, searching over the domain <inline-formula id="IE113"><mml:math id="IM113"><mml:mrow><mml:mi mathvariant="italic">lo</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>≤</mml:mo><mml:mi>n</mml:mi><mml:mo>≤</mml:mo><mml:mn>1000</mml:mn><mml:mo>=</mml:mo><mml:mi mathvariant="italic">hi</mml:mi></mml:mrow></mml:math></inline-formula>. In each iteration, this approach truncates the search domain from [<italic>lo</italic>, <italic>hi</italic>] to either <inline-formula id="IE114"><mml:math id="IM114"><mml:mrow><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mi mathvariant="italic">lo</mml:mi><mml:mo>+</mml:mo><mml:mrow><mml:mo>⌊</mml:mo><mml:mrow><mml:mfrac><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="italic">hi</mml:mi><mml:mo>−</mml:mo><mml:mi mathvariant="italic">lo</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mn>4</mml:mn></mml:mfrac></mml:mrow><mml:mo>⌋</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:mi mathvariant="italic">hi</mml:mi></mml:mrow><mml:mo>]</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> or <inline-formula id="IE115"><mml:math id="IM115"><mml:mrow><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mi mathvariant="italic">lo</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="italic">hi</mml:mi><mml:mo>−</mml:mo><mml:mrow><mml:mo>⌊</mml:mo><mml:mrow><mml:mfrac><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="italic">hi</mml:mi><mml:mo>−</mml:mo><mml:mi mathvariant="italic">lo</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mn>4</mml:mn></mml:mfrac></mml:mrow><mml:mo>⌋</mml:mo></mml:mrow></mml:mrow><mml:mo>]</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math></inline-formula> by removing either the first or the last quarter of the domain after evaluating the marginal probability (or similarly, the best alignment hypothesis) at those two quarter points. The value of <italic>lo</italic> upon termination is taken to be the optimal estimate of <italic>n</italic>.</p>
      </sec>
      <sec>
        <title>2.4.4 Marginal probability landscapes</title>
        <p>In order to generate the marginal probability landscapes that allow users to visualize all competing alignments simultaneously, the following approach is used. For a given <inline-formula id="IE116"><mml:math id="IM116"><mml:mrow><mml:mo>〈</mml:mo><mml:mi mathvariant="bold">S</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold">T</mml:mi><mml:mo>〉</mml:mo></mml:mrow></mml:math></inline-formula>, the DPA is run in the forward direction (i.e. natural direction of the sequences). This yields the inferred distance parameter <italic>n</italic> and the dynamic programming history matrices <inline-formula id="IE117"><mml:math id="IM117"><mml:mrow><mml:mstyle displaystyle="true"><mml:mover><mml:mrow><mml:msub><mml:mrow><mml:mrow><mml:mtext>Tot</mml:mtext></mml:mrow></mml:mrow><mml:mi mathvariant="monospace">m</mml:mi></mml:msub></mml:mrow><mml:mstyle mathsize="130%" displaystyle="true"><mml:mo>→</mml:mo></mml:mstyle></mml:mover></mml:mstyle><mml:mo>,</mml:mo><mml:mrow><mml:mstyle displaystyle="true"><mml:mover><mml:mrow><mml:msub><mml:mrow><mml:mrow><mml:mtext>Tot</mml:mtext></mml:mrow></mml:mrow><mml:mi mathvariant="monospace">i</mml:mi></mml:msub></mml:mrow><mml:mstyle mathsize="130%" displaystyle="true"><mml:mo>→</mml:mo></mml:mstyle></mml:mover></mml:mstyle></mml:mrow></mml:mrow></mml:math></inline-formula> and <inline-formula id="IE118"><mml:math id="IM118"><mml:mrow><mml:mstyle displaystyle="true"><mml:mover><mml:mrow><mml:msub><mml:mrow><mml:mrow><mml:mtext>Tot</mml:mtext></mml:mrow></mml:mrow><mml:mi mathvariant="monospace">d</mml:mi></mml:msub></mml:mrow><mml:mstyle mathsize="130%" displaystyle="true"><mml:mo>→</mml:mo></mml:mstyle></mml:mover></mml:mstyle></mml:mrow></mml:math></inline-formula>. Using the inferred distance parameter from the forward run, the DPA is run in the backward direction (i.e. reverse direction of the sequences), yielding the history matrices <inline-formula id="IE119"><mml:math id="IM119"><mml:mrow><mml:mstyle displaystyle="true"><mml:mover><mml:mrow><mml:msub><mml:mrow><mml:mrow><mml:mtext>Tot</mml:mtext></mml:mrow></mml:mrow><mml:mi mathvariant="monospace">m</mml:mi></mml:msub></mml:mrow><mml:mstyle mathsize="130%" displaystyle="true"><mml:mo>←</mml:mo></mml:mstyle></mml:mover></mml:mstyle><mml:mo>,</mml:mo><mml:mrow><mml:mstyle displaystyle="true"><mml:mover><mml:mrow><mml:msub><mml:mrow><mml:mrow><mml:mtext>Tot</mml:mtext></mml:mrow></mml:mrow><mml:mi mathvariant="monospace">i</mml:mi></mml:msub></mml:mrow><mml:mstyle mathsize="130%" displaystyle="true"><mml:mo>←</mml:mo></mml:mstyle></mml:mover></mml:mstyle></mml:mrow></mml:mrow></mml:math></inline-formula> and <inline-formula id="IE120"><mml:math id="IM120"><mml:mrow><mml:mstyle displaystyle="true"><mml:mover><mml:mrow><mml:msub><mml:mrow><mml:mrow><mml:mtext>Tot</mml:mtext></mml:mrow></mml:mrow><mml:mi mathvariant="monospace">d</mml:mi></mml:msub></mml:mrow><mml:mstyle mathsize="130%" displaystyle="true"><mml:mo>←</mml:mo></mml:mstyle></mml:mover></mml:mstyle></mml:mrow></mml:math></inline-formula>.</p>
        <p>A combined landscape matrix is derived by computing, for each cell (<italic>i</italic>, <italic>j</italic>), the negative LSE function over the following nine arguments: (i) <inline-formula id="IE121"><mml:math id="IM121"><mml:mrow><mml:mstyle displaystyle="true"><mml:mover><mml:mrow><mml:msub><mml:mrow><mml:mrow><mml:mtext>Tot</mml:mtext></mml:mrow></mml:mrow><mml:mi mathvariant="monospace">m</mml:mi></mml:msub></mml:mrow><mml:mstyle mathsize="130%" displaystyle="true"><mml:mo>→</mml:mo></mml:mstyle></mml:mover></mml:mstyle><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>−</mml:mo><mml:mtext>log</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mi>Pr</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="monospace">m</mml:mi><mml:mo>|</mml:mo><mml:mi mathvariant="monospace">m</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:mrow><mml:mstyle displaystyle="true"><mml:mover><mml:mrow><mml:msub><mml:mrow><mml:mrow><mml:mtext>Tot</mml:mtext></mml:mrow></mml:mrow><mml:mi mathvariant="monospace">m</mml:mi></mml:msub></mml:mrow><mml:mstyle mathsize="130%" displaystyle="true"><mml:mo>←</mml:mo></mml:mstyle></mml:mover></mml:mstyle></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>, (ii) <inline-formula id="IE122"><mml:math id="IM122"><mml:mrow><mml:mstyle displaystyle="true"><mml:mover><mml:mrow><mml:msub><mml:mrow><mml:mrow><mml:mtext>Tot</mml:mtext></mml:mrow></mml:mrow><mml:mi mathvariant="monospace">m</mml:mi></mml:msub></mml:mrow><mml:mstyle mathsize="130%" displaystyle="true"><mml:mo>→</mml:mo></mml:mstyle></mml:mover></mml:mstyle><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo> </mml:mo><mml:mo>−</mml:mo><mml:mtext>log</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mi>Pr</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="monospace">i</mml:mi><mml:mo>|</mml:mo><mml:mi mathvariant="monospace">m</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:mrow><mml:mstyle displaystyle="true"><mml:mover><mml:mrow><mml:msub><mml:mrow><mml:mrow><mml:mtext>Tot</mml:mtext></mml:mrow></mml:mrow><mml:mi mathvariant="monospace">i</mml:mi></mml:msub></mml:mrow><mml:mstyle mathsize="130%" displaystyle="true"><mml:mo>←</mml:mo></mml:mstyle></mml:mover></mml:mstyle></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>, (iii) <inline-formula id="IE123"><mml:math id="IM123"><mml:mrow><mml:mstyle displaystyle="true"><mml:mover><mml:mrow><mml:msub><mml:mrow><mml:mrow><mml:mtext>Tot</mml:mtext></mml:mrow></mml:mrow><mml:mi mathvariant="monospace">m</mml:mi></mml:msub></mml:mrow><mml:mstyle mathsize="130%" displaystyle="true"><mml:mo>→</mml:mo></mml:mstyle></mml:mover></mml:mstyle><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>−</mml:mo><mml:mtext>log</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mi>Pr</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="monospace">d</mml:mi><mml:mo>|</mml:mo><mml:mi mathvariant="monospace">m</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:mrow><mml:mstyle displaystyle="true"><mml:mover><mml:mrow><mml:msub><mml:mrow><mml:mrow><mml:mtext>Tot</mml:mtext></mml:mrow></mml:mrow><mml:mi mathvariant="monospace">d</mml:mi></mml:msub></mml:mrow><mml:mstyle mathsize="130%" displaystyle="true"><mml:mo>←</mml:mo></mml:mstyle></mml:mover></mml:mstyle></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>, (iv) <inline-formula id="IE124"><mml:math id="IM124"><mml:mrow><mml:mstyle displaystyle="true"><mml:mover><mml:mrow><mml:msub><mml:mrow><mml:mrow><mml:mtext>Tot</mml:mtext></mml:mrow></mml:mrow><mml:mi mathvariant="monospace">i</mml:mi></mml:msub></mml:mrow><mml:mstyle mathsize="130%" displaystyle="true"><mml:mo>→</mml:mo></mml:mstyle></mml:mover></mml:mstyle><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>−</mml:mo><mml:mtext>log</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mi>Pr</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="monospace">m</mml:mi><mml:mo>|</mml:mo><mml:mi mathvariant="monospace">i</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:mrow><mml:mstyle displaystyle="true"><mml:mover><mml:mrow><mml:msub><mml:mrow><mml:mrow><mml:mtext>Tot</mml:mtext></mml:mrow></mml:mrow><mml:mi mathvariant="monospace">i</mml:mi></mml:msub></mml:mrow><mml:mstyle mathsize="130%" displaystyle="true"><mml:mo>←</mml:mo></mml:mstyle></mml:mover></mml:mstyle></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>, (v) <inline-formula id="IE125"><mml:math id="IM125"><mml:mrow><mml:mstyle displaystyle="true"><mml:mover><mml:mrow><mml:msub><mml:mrow><mml:mrow><mml:mtext>Tot</mml:mtext></mml:mrow></mml:mrow><mml:mi mathvariant="monospace">i</mml:mi></mml:msub></mml:mrow><mml:mstyle mathsize="130%" displaystyle="true"><mml:mo>→</mml:mo></mml:mstyle></mml:mover></mml:mstyle><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo> </mml:mo><mml:mo>−</mml:mo><mml:mtext>log</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mi>Pr</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="monospace">i</mml:mi><mml:mo>|</mml:mo><mml:mi mathvariant="monospace">i</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:mrow><mml:mstyle displaystyle="true"><mml:mover><mml:mrow><mml:msub><mml:mrow><mml:mrow><mml:mtext>Tot</mml:mtext></mml:mrow></mml:mrow><mml:mi mathvariant="monospace">i</mml:mi></mml:msub></mml:mrow><mml:mstyle mathsize="130%" displaystyle="true"><mml:mo>←</mml:mo></mml:mstyle></mml:mover></mml:mstyle></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>, (vi) <inline-formula id="IE126"><mml:math id="IM126"><mml:mrow><mml:mstyle displaystyle="true"><mml:mover><mml:mrow><mml:msub><mml:mrow><mml:mrow><mml:mtext>Tot</mml:mtext></mml:mrow></mml:mrow><mml:mi mathvariant="monospace">i</mml:mi></mml:msub></mml:mrow><mml:mstyle mathsize="130%" displaystyle="true"><mml:mo>→</mml:mo></mml:mstyle></mml:mover></mml:mstyle><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>−</mml:mo><mml:mtext>log</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mi>Pr</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="monospace">d</mml:mi><mml:mo>|</mml:mo><mml:mi mathvariant="monospace">i</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:mrow><mml:mstyle displaystyle="true"><mml:mover><mml:mrow><mml:msub><mml:mrow><mml:mrow><mml:mtext>Tot</mml:mtext></mml:mrow></mml:mrow><mml:mi mathvariant="monospace">d</mml:mi></mml:msub></mml:mrow><mml:mstyle mathsize="130%" displaystyle="true"><mml:mo>←</mml:mo></mml:mstyle></mml:mover></mml:mstyle></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>, (vii) <inline-formula id="IE127"><mml:math id="IM127"><mml:mrow><mml:mstyle displaystyle="true"><mml:mover><mml:mrow><mml:msub><mml:mrow><mml:mrow><mml:mtext>Tot</mml:mtext></mml:mrow></mml:mrow><mml:mi mathvariant="monospace">d</mml:mi></mml:msub></mml:mrow><mml:mstyle mathsize="130%" displaystyle="true"><mml:mo>→</mml:mo></mml:mstyle></mml:mover></mml:mstyle><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo> </mml:mo><mml:mo>−</mml:mo><mml:mtext>log</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mi>Pr</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="monospace">m</mml:mi><mml:mo>|</mml:mo><mml:mi mathvariant="monospace">d</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:mrow><mml:mstyle displaystyle="true"><mml:mover><mml:mrow><mml:msub><mml:mrow><mml:mrow><mml:mtext>Tot</mml:mtext></mml:mrow></mml:mrow><mml:mi mathvariant="monospace">m</mml:mi></mml:msub></mml:mrow><mml:mstyle mathsize="130%" displaystyle="true"><mml:mo>←</mml:mo></mml:mstyle></mml:mover></mml:mstyle></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>, (viii) <inline-formula id="IE128"><mml:math id="IM128"><mml:mrow><mml:mstyle displaystyle="true"><mml:mover><mml:mrow><mml:msub><mml:mrow><mml:mrow><mml:mtext>Tot</mml:mtext></mml:mrow></mml:mrow><mml:mi mathvariant="monospace">d</mml:mi></mml:msub></mml:mrow><mml:mstyle mathsize="130%" displaystyle="true"><mml:mo>→</mml:mo></mml:mstyle></mml:mover></mml:mstyle><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>−</mml:mo><mml:mtext>log</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mi>Pr</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="monospace">i</mml:mi><mml:mo>|</mml:mo><mml:mi mathvariant="monospace">d</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:mrow><mml:mstyle displaystyle="true"><mml:mover><mml:mrow><mml:msub><mml:mrow><mml:mrow><mml:mtext>Tot</mml:mtext></mml:mrow></mml:mrow><mml:mi mathvariant="monospace">i</mml:mi></mml:msub></mml:mrow><mml:mstyle mathsize="130%" displaystyle="true"><mml:mo>←</mml:mo></mml:mstyle></mml:mover></mml:mstyle></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> and (ix) <inline-formula id="IE129"><mml:math id="IM129"><mml:mrow><mml:mstyle displaystyle="true"><mml:mover><mml:mrow><mml:msub><mml:mrow><mml:mrow><mml:mtext>Tot</mml:mtext></mml:mrow></mml:mrow><mml:mi mathvariant="monospace">d</mml:mi></mml:msub></mml:mrow><mml:mstyle mathsize="130%" displaystyle="true"><mml:mo>→</mml:mo></mml:mstyle></mml:mover></mml:mstyle><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>−</mml:mo><mml:mtext>log</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mi>Pr</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="monospace">d</mml:mi><mml:mo>|</mml:mo><mml:mi mathvariant="monospace">d</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:mrow><mml:mstyle displaystyle="true"><mml:mover><mml:mrow><mml:msub><mml:mrow><mml:mrow><mml:mtext>Tot</mml:mtext></mml:mrow></mml:mrow><mml:mi mathvariant="monospace">d</mml:mi></mml:msub></mml:mrow><mml:mstyle mathsize="130%" displaystyle="true"><mml:mo>←</mml:mo></mml:mstyle></mml:mover></mml:mstyle></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>.</p>
        <p>Any cell (<italic>i</italic>, <italic>j</italic>) in this landscape gives the product of marginal probabilities that the prefixes <inline-formula id="IE130"><mml:math id="IM130"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold">S</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>…</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>:</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold">T</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>…</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> and suffixes <inline-formula id="IE131"><mml:math id="IM131"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold">S</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo>…</mml:mo><mml:mo>|</mml:mo><mml:mi mathvariant="bold">S</mml:mi><mml:mo>|</mml:mo></mml:mrow></mml:msub><mml:mo>:</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold">T</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo>…</mml:mo><mml:mo>|</mml:mo><mml:mi mathvariant="bold">T</mml:mi><mml:mo>|</mml:mo></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> are related. The marginal probability landscape provides insightful visualization of alignment relationships between two sequences. It also allows users to interactively generate competing alignments passing through any specified cell (<italic>i</italic>, <italic>j</italic>) in the landscape (see Section 3).</p>
      </sec>
    </sec>
  </sec>
  <sec>
    <title>3 Results and discussion</title>
    <sec>
      <title>3.1 Inferred Dirichlet priors</title>
      <p>Using the inference method described in Section 2.3, we derived 1000 Dirichlet priors to model the observed distributions of state machine parameters, as a function of sequence distance <inline-formula id="IE132"><mml:math id="IM132"><mml:mrow><mml:mi>n</mml:mi><mml:mo>∈</mml:mo><mml:mo stretchy="false">[</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>1000</mml:mn><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:math></inline-formula> measured in terms of Point Accepted Mutations (<xref rid="btz368-B9" ref-type="bibr">Dayhoff <italic>et al.</italic>, 1978</xref>) (see <xref ref-type="supplementary-material" rid="sup1">Supplementary Section S3</xref>).</p>
      <p><xref ref-type="fig" rid="btz368-F3">Figure 3(a)</xref> shows all the 1000 distributions of the free parameter <inline-formula id="IE133"><mml:math id="IM133"><mml:mrow><mml:mi>Pr</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="monospace">m</mml:mi><mml:mo>|</mml:mo><mml:mi mathvariant="monospace">m</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> associated with the <bold><monospace>match</monospace></bold> state. This parameter influences the observed lengths of the matched blocks produced by the three-state machine. These lengths are geometrically distributed, and the probability of seeing a matched block of length <italic>L</italic> is <inline-formula id="IE134"><mml:math id="IM134"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>Pr</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="monospace">m</mml:mi><mml:mo>|</mml:mo><mml:mi mathvariant="monospace">m</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:mo>×</mml:mo><mml:mi>Pr</mml:mi><mml:msup><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="monospace">m</mml:mi><mml:mo>|</mml:mo><mml:mi mathvariant="monospace">m</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mi>L</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula>. The expected length of the matched block is given by <inline-formula id="IE135"><mml:math id="IM135"><mml:mrow><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>Pr</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="monospace">m</mml:mi><mml:mo>|</mml:mo><mml:mi mathvariant="monospace">m</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>. Furthermore, due to the enforced symmetry of state transitions from <bold><monospace>match</monospace></bold> state to <bold><monospace>insert</monospace></bold> or <bold><monospace>delete</monospace></bold> states (see Section 2.3), we have: <inline-formula id="IE136"><mml:math id="IM136"><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>Pr</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="monospace">m</mml:mi><mml:mo>|</mml:mo><mml:mi mathvariant="monospace">m</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mi>Pr</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="monospace">i</mml:mi><mml:mo>|</mml:mo><mml:mi mathvariant="monospace">m</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:mi>Pr</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="monospace">d</mml:mi><mml:mo>|</mml:mo><mml:mi mathvariant="monospace">m</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>. This value informs the probability of observing a gap in any alignment produced by the state machine. <xref ref-type="fig" rid="btz368-F3">Figure 3(c)</xref> plots the expected probability of observing a gap as a function of distance <italic>n</italic>, when <inline-formula id="IE137"><mml:math id="IM137"><mml:mrow><mml:mi>Pr</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="monospace">m</mml:mi><mml:mo>|</mml:mo><mml:mi mathvariant="monospace">m</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> is set to the mean (red) and mode (blue) values under the Dirichlet distributions shown in <xref ref-type="fig" rid="btz368-F3">Figure 3(a)</xref>. We notice the trend that the probability of a gap increases linearly with <italic>n</italic> in the range [1, 350], and stays relatively flat when <italic>n </italic>&gt;<italic> </italic>350. This linear trend agrees with the observations by <xref rid="btz368-B16" ref-type="bibr">Gonnet <italic>et al.</italic> (1992</xref>) and <xref rid="btz368-B6" ref-type="bibr">Benner <italic>et al.</italic> (1993</xref>).
</p>
      <fig id="btz368-F3" orientation="portrait" position="float">
        <label>Fig. 3.</label>
        <caption>
          <p>Visualization of the inferred Dirichlet distributions modeling the three free parameters of the finite-state machine, and their associated statistics. (<bold>a</bold>) One-simplex distributions of <inline-formula id="IE138"><mml:math id="IM138"><mml:mrow><mml:mi>Pr</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold">m</mml:mi><mml:mo>|</mml:mo><mml:mi mathvariant="bold">m</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> associated with the <bold><monospace>match</monospace></bold>, as a function of sequence-distance <inline-formula id="IE139"><mml:math id="IM139"><mml:mrow><mml:mi>n</mml:mi><mml:mo>∈</mml:mo><mml:mo stretchy="false">[</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>1000</mml:mn><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:math></inline-formula>. (<bold>b</bold>) 2-simplex distributions of <inline-formula id="IE140"><mml:math id="IM140"><mml:mrow><mml:mi>Pr</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold">i</mml:mi><mml:mo>|</mml:mo><mml:mi mathvariant="bold">i</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> and <inline-formula id="IE141"><mml:math id="IM141"><mml:mrow><mml:mi>Pr</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold">m</mml:mi><mml:mo>|</mml:mo><mml:mi mathvariant="bold">i</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> associated with <bold><monospace>insert</monospace></bold> (and by symmetry, <bold><monospace>delete</monospace></bold>), as a function of sequence-distance <inline-formula id="IE142"><mml:math id="IM142"><mml:mrow><mml:mi>n</mml:mi><mml:mo>∈</mml:mo><mml:mo>{</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>40</mml:mn><mml:mo>,</mml:mo><mml:mn>80</mml:mn><mml:mo>,</mml:mo><mml:mn>120</mml:mn><mml:mo>,</mml:mo><mml:mn>160</mml:mn><mml:mo>,</mml:mo><mml:mn>200</mml:mn><mml:mo>,</mml:mo><mml:mn>400</mml:mn><mml:mo>,</mml:mo><mml:mn>600</mml:mn><mml:mo>,</mml:mo><mml:mn>800</mml:mn><mml:mo>}</mml:mo></mml:mrow></mml:math></inline-formula>. Since the values of <inline-formula id="IE143"><mml:math id="IM143"><mml:mrow><mml:mi>Pr</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold">i</mml:mi><mml:mo>|</mml:mo><mml:mi mathvariant="bold">i</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> (estimated from the mode) are in the range of [0.81, 0.93] for <inline-formula id="IE144"><mml:math id="IM144"><mml:mrow><mml:mi>n</mml:mi><mml:mo>∈</mml:mo><mml:mo stretchy="false">[</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>1000</mml:mn><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:math></inline-formula>, its simplex support shown above has been truncated for clarity to the range of [0.5, 1.0]. (<bold>c</bold>) The distribution of mean and mode values of <inline-formula id="IE145"><mml:math id="IM145"><mml:mrow><mml:mi>Pr</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold">i</mml:mi><mml:mo>|</mml:mo><mml:mi mathvariant="bold">m</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:mi>Pr</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold">d</mml:mi><mml:mo>|</mml:mo><mml:mi mathvariant="bold">m</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> under the Dirichlet priors, as a function of <italic>n</italic>. (<bold>d</bold>) The distribution of expected gap lengths derived from the mode-estimate of <inline-formula id="IE146"><mml:math id="IM146"><mml:mrow><mml:mi>Pr</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold">i</mml:mi><mml:mo>|</mml:mo><mml:mi mathvariant="bold">i</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> under the inferred Dirichlet priors</p>
        </caption>
        <graphic xlink:href="btz368f3"/>
      </fig>
      <p>On the other hand, <xref ref-type="fig" rid="btz368-F3">Figure 3(b)</xref> shows a small selection of nine Dirichlet distributions, for specific values of <inline-formula id="IE147"><mml:math id="IM147"><mml:mrow><mml:mi>n</mml:mi><mml:mo>∈</mml:mo><mml:mo>{</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>40</mml:mn><mml:mo>,</mml:mo><mml:mn>80</mml:mn><mml:mo>,</mml:mo><mml:mn>120</mml:mn><mml:mo>,</mml:mo><mml:mn>160</mml:mn><mml:mo>,</mml:mo><mml:mn>200</mml:mn><mml:mo>,</mml:mo><mml:mn>400</mml:mn><mml:mo>,</mml:mo><mml:mn>600</mml:mn><mml:mo>,</mml:mo><mml:mn>800</mml:mn><mml:mo>}</mml:mo></mml:mrow></mml:math></inline-formula>, associated with the <bold><monospace>insert</monospace></bold> state parameters. (By symmetry, <italic><monospace>insert</monospace></italic> and <italic><monospace>delete</monospace></italic> state parameters are equivalent.) The heat map shows the inferred concentration (refer Section 2.3.2) of the probability density about the mode shown as a yellow dot (at the center of the heat map). The black dot shows the mean under the same distribution. The three corners (bottom-left, bottom-right, top) of each triangle (denoting the 2-simplex support for L1-normalized transition probabilities of <italic><monospace>insert</monospace></italic> state) show the points where <inline-formula id="IE148"><mml:math id="IM148"><mml:mrow><mml:mi>Pr</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="monospace">i</mml:mi><mml:mo>|</mml:mo><mml:mi mathvariant="monospace">i</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo><mml:mi>Pr</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="monospace">m</mml:mi><mml:mo>|</mml:mo><mml:mi mathvariant="monospace">i</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>, and <inline-formula id="IE149"><mml:math id="IM149"><mml:mrow><mml:mi>Pr</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="monospace">d</mml:mi><mml:mo>|</mml:mo><mml:mi mathvariant="monospace">i</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> become exactly 1, while remaining two parameters become 0.</p>
      <p>As <italic>n</italic> increases, it can be seen from <xref ref-type="fig" rid="btz368-F3">Figure 3(b)</xref> that <inline-formula id="IE150"><mml:math id="IM150"><mml:mrow><mml:mi>Pr</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="monospace">i</mml:mi><mml:mo>|</mml:mo><mml:mi mathvariant="monospace">i</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> also increases (see mean and mode—yellow and black dots in the plots—approach the bottom-left corner). This parameter influences the observed length of an <bold><monospace>insert</monospace></bold> (and, by symmetry, <bold><monospace>delete</monospace></bold>) block in an alignment. Again, these block lengths are geometrically distributed, with the probability of seeing a gap of length <italic>L</italic> defined by <inline-formula id="IE151"><mml:math id="IM151"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>Pr</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="monospace">i</mml:mi><mml:mo>|</mml:mo><mml:mi mathvariant="monospace">i</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:mo>×</mml:mo><mml:mi>Pr</mml:mi><mml:msup><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="monospace">i</mml:mi><mml:mo>|</mml:mo><mml:mi mathvariant="monospace">i</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mi>L</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula>, and whose expected gap length is given by <inline-formula id="IE152"><mml:math id="IM152"><mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>Pr</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="monospace">i</mml:mi><mml:mo>|</mml:mo><mml:mi mathvariant="monospace">i</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula>.</p>
      <p><xref ref-type="fig" rid="btz368-F3">Figure 3(d)</xref> plots the expected gap length as a function of <italic>n</italic> with the mode estimate assigned to the parameter <inline-formula id="IE153"><mml:math id="IM153"><mml:mrow><mml:mi>Pr</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="monospace">i</mml:mi><mml:mo>|</mml:mo><mml:mi mathvariant="monospace">i</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>. On average, the expected gap length is about five amino acid residues for <italic>n</italic> in the range [1, 120], and barring a few outliers at <italic>n</italic> = [43, 44, 45, 91, 94], the trend is flat. Examining the source structural alignment data of these outliers (i.e. <italic>n</italic>-based alignment subsets on which the Dirichlet priors have been inferred), we find protein domain pairs with circularly permuted amino acid sequences and other pairs with plastic deformations in their structures. We note that a circular permutation between proteins results in a <italic>non-sequential</italic> relationship. Enforcing a <italic>sequence alignment</italic> on such a relationship yields regions that cannot be sequentially-aligned, which are then misinterpreted as long gaps. Similarly, domain pairs with plastic deformations have the same effect on gap lengths.</p>
      <p>Further, in the range of <inline-formula id="IE154"><mml:math id="IM154"><mml:mrow><mml:mi>n</mml:mi><mml:mo>∈</mml:mo><mml:mo stretchy="false">[</mml:mo><mml:mn>120</mml:mn><mml:mo>,</mml:mo><mml:mn>350</mml:mn><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:math></inline-formula>, we see in <xref ref-type="fig" rid="btz368-F3">Figure 3(d)</xref> that the expected gap length increases linearly as a function of <italic>n</italic>. This contradicts the observation by <xref rid="btz368-B6" ref-type="bibr">Benner <italic>et al.</italic> (1993</xref>) who have stated that ‘the distribution of gap size is essentially independent of the evolutionary distance between two sequences, with only a modest decrease in average gap length at increasing PAM distance’.</p>
      <p>Finally, in the range of <italic>n </italic>&gt;<italic> </italic>350, the expected gap length in <xref ref-type="fig" rid="btz368-F3">Figure 3(d)</xref> shows a noisy-yet-flat trend line, averaging about 13 to 15 amino acid residues. This trend more likely reveals the limits of applicability of PAM (Markov) matrix, and its convergence to its stationary distribution for large <italic>n</italic> (<xref rid="btz368-B9" ref-type="bibr">Dayhoff <italic>et al.</italic>, 1978</xref>). To test this, we measure the Kullback–Leibler (KL) divergence of each amino acid with varying PAM-<italic>n</italic> against its stationary distribution. We note that the KL-divergence between any two discrete probability distributions <italic>f</italic> and <italic>g</italic> over <italic>N</italic> mutually exclusive events, measures the additional number of bits required to encode samples drawn from <italic>f</italic> using <italic>g</italic> (i.e. it measures their relative Shannon entropy): <inline-formula id="IE155"><mml:math id="IM155"><mml:mrow><mml:mtext>KL</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mi>f</mml:mi><mml:mo>,</mml:mo><mml:mi>g</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>x</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>N</mml:mi></mml:msubsup><mml:mi>f</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo> </mml:mo><mml:mtext>log</mml:mtext><mml:mo stretchy="true">(</mml:mo><mml:mfrac><mml:mrow><mml:mi>f</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mi>g</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfrac><mml:mo stretchy="true">)</mml:mo><mml:mo>.</mml:mo></mml:mrow></mml:math></inline-formula> By varying the value of <inline-formula id="IE156"><mml:math id="IM156"><mml:mrow><mml:mi>n</mml:mi><mml:mo>∈</mml:mo><mml:mo stretchy="false">[</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>1000</mml:mn><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:math></inline-formula>, we computed the KL-divergence between each amino-acid’s substitution probability distribution (i.e. each column of PAM-<italic>n</italic>) and the stationary distribution (i.e. the eigenvector associated with the dominant eigenvalue of 1 of PAM matrices). <xref ref-type="fig" rid="btz368-F4">Figure 4</xref> plots the KL-divergence for each amino acid with varying PAM-<italic>n</italic>. We observe that, for <italic>n </italic>&gt;<italic> </italic>350, most columns of PAM-<italic>n</italic> (i.e. amino acid substitution probabilities) converge to the stationary distribution. This indicates the limits of PAM’s ability to differentiate amino acid substitutions at larger evolutionary distances.
</p>
      <fig id="btz368-F4" orientation="portrait" position="float">
        <label>Fig. 4.</label>
        <caption>
          <p>Kullback–Leibler divergence between each amino acid related column in the PAM-<italic>n</italic> matrix and its stationary distribution, measured in bits. The black partitions define the [1, 120], [120, 350] and [350, 1000] regions corresponding to the PAM-<italic>n</italic> ranges where we see different trends for the expected gap length</p>
        </caption>
        <graphic xlink:href="btz368f4"/>
      </fig>
    </sec>
    <sec>
      <title>3.2 Comparison with other programs on distantly related pairs of protein sequences</title>
      <p>We used two types of benchmark datasets to test the performance of our sequence comparison framework. The first is a set of experimentally verified remote orthologs reported by <xref rid="btz368-B33" ref-type="bibr">Szklarczyk <italic>et al.</italic> (2012</xref>), containing a total of 877 protein sequence pairs spread over two groups. The second is the entire <italic>twilight</italic> zone dataset from SABmark (<xref rid="btz368-B36" ref-type="bibr">Van Walle <italic>et al.</italic>, 2005</xref>) containing 10 250 protein sequence pairs, spread over 209 groups.</p>
      <p>Specifically, the dataset of <xref rid="btz368-B33" ref-type="bibr">Szklarczyk <italic>et al.</italic> (2012</xref>) include, in the first group, 405 pairs of human orthologous fungal mitochondrial proteins found in <italic>Saccharomyces cerevisiae</italic>, and in the second group, 472 pairs of orthologs found in <italic>Schizosaccharomyces pombe</italic>. Their average percentage sequence identity is reported as 27.7%, with about 40% of this dataset having pairs with &lt;25% sequence identity and 36% between 25% and 35% sequence identity.</p>
      <p>We ran our MML based alignment program in two separate modes. The first mode finds the best alignment hypothesis that minimizes the message length term given in <xref ref-type="disp-formula" rid="E2">Equation 1</xref>. This yields the <inline-formula id="IE157"><mml:math id="IM157"><mml:mrow><mml:mi mathvariant="normal">I</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="script">A</mml:mi><mml:mo>,</mml:mo><mml:mrow><mml:mo>〈</mml:mo><mml:mrow><mml:mi mathvariant="bold">S</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold">T</mml:mi></mml:mrow><mml:mo>〉</mml:mo></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> statistic, together with the information measures of alignment complexity <inline-formula id="IE158"><mml:math id="IM158"><mml:mrow><mml:mi mathvariant="normal">I</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="script">A</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> and alignment fidelity <inline-formula id="IE159"><mml:math id="IM159"><mml:mrow><mml:mi mathvariant="normal">I</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mo>〈</mml:mo><mml:mi mathvariant="bold">S</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold">T</mml:mi><mml:mo>〉</mml:mo><mml:mo>|</mml:mo><mml:mi mathvariant="script">A</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>. The second mode, which is the main focus of this work, is the one that estimates the negative logarithm of the marginal probability as per <xref ref-type="disp-formula" rid="E3">Equation 2</xref> that yields <inline-formula id="IE160"><mml:math id="IM160"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="normal">I</mml:mi></mml:mrow><mml:mrow><mml:mtext>marginal</mml:mtext></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mo>〈</mml:mo><mml:mrow><mml:mi mathvariant="bold">S</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold">T</mml:mi></mml:mrow><mml:mo>〉</mml:mo></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> statistic. Both <inline-formula id="IE161"><mml:math id="IM161"><mml:mrow><mml:mi mathvariant="normal">I</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="script">A</mml:mi><mml:mo>,</mml:mo><mml:mo>〈</mml:mo><mml:mi mathvariant="bold">S</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold">T</mml:mi><mml:mo>〉</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> and <inline-formula id="IE162"><mml:math id="IM162"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="normal">I</mml:mi></mml:mrow><mml:mrow><mml:mtext>marginal</mml:mtext></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mo>〈</mml:mo><mml:mi mathvariant="bold">S</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold">T</mml:mi><mml:mo>〉</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> are compared with their corresponding null model message length, <inline-formula id="IE163"><mml:math id="IM163"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="normal">I</mml:mi></mml:mrow><mml:mrow><mml:mtext>NULL</mml:mtext></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mo>〈</mml:mo><mml:mi mathvariant="bold">S</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold">T</mml:mi><mml:mo>〉</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> as per <xref ref-type="disp-formula" rid="E4">Equation 3</xref>, yielding the bits of ‘Compression’ statistic.</p>
      <p>Further, we compare the results of this dataset against seven widely-used protein sequence alignment programs: ClustalW (<xref rid="btz368-B20" ref-type="bibr">Larkin, 2007</xref>), CONTRAlign (<xref rid="btz368-B11" ref-type="bibr">Do <italic>et al.</italic>, 2006</xref>), KAlign (<xref rid="btz368-B21" ref-type="bibr">Lassmann and Sonnhammer, 2005</xref>), MAFFT (<xref rid="btz368-B18" ref-type="bibr">Katoh and Standley, 2013</xref>), MUSCLE (<xref rid="btz368-B14" ref-type="bibr">Edgar, 2004</xref>), ProbCons (<xref rid="btz368-B10" ref-type="bibr">Do <italic>et al.</italic>, 2005</xref>) and T-COFFEE (<xref rid="btz368-B26" ref-type="bibr">Notredame <italic>et al.</italic>, 2000</xref>). We evaluate the performance across all these program using the ‘Compression’ statistic. For each alignment produced by the programs, we infer the best parameters that minimize their <inline-formula id="IE164"><mml:math id="IM164"><mml:mrow><mml:mi mathvariant="normal">I</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="script">A</mml:mi><mml:mo>,</mml:mo><mml:mo>〈</mml:mo><mml:mi mathvariant="bold">S</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold">T</mml:mi><mml:mo>〉</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> measure. This allows us to compare various message length terms against <inline-formula id="IE165"><mml:math id="IM165"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="normal">I</mml:mi></mml:mrow><mml:mrow><mml:mtext>NULL</mml:mtext></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mo>〈</mml:mo><mml:mi mathvariant="bold">S</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold">T</mml:mi><mml:mo>〉</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> to find its ‘Compression’. We consider as <italic>hits</italic> (i.e. pairs that are correctly identified as related), only those alignments whose <inline-formula id="IE166"><mml:math id="IM166"><mml:mrow><mml:mi mathvariant="normal">I</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="script">A</mml:mi><mml:mo>,</mml:mo><mml:mo>〈</mml:mo><mml:mi mathvariant="bold">S</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold">T</mml:mi><mml:mo>〉</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> is shorter than <inline-formula id="IE167"><mml:math id="IM167"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="normal">I</mml:mi></mml:mrow><mml:mrow><mml:mtext>NULL</mml:mtext></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mo>〈</mml:mo><mml:mi mathvariant="bold">S</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold">T</mml:mi><mml:mo>〉</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> (refer statistical significance test in Section 2.2). This allows us to compute the percentage of the total number of sequence pairs that pass the null hypothesis test for significance (%-Hits). <xref rid="btz368-T1" ref-type="table">Table 1</xref> presents these results across the two benchmark groups of human remote orthologs (<xref rid="btz368-B33" ref-type="bibr">Szklarczyk <italic>et al.</italic>, 2012</xref>). In the table, we report the corresponding median values (across the whole group) against <inline-formula id="IE168"><mml:math id="IM168"><mml:mrow><mml:mi mathvariant="normal">I</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="script">A</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:mi mathvariant="normal">I</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mo>〈</mml:mo><mml:mi mathvariant="bold">S</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold">T</mml:mi><mml:mo>〉</mml:mo><mml:mo>|</mml:mo><mml:mi mathvariant="script">A</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>, and ‘Compression’ entries.</p>
      <table-wrap id="btz368-T1" orientation="portrait" position="float">
        <label>Table 1.</label>
        <caption>
          <p>Comparison of various programs over two benchmark datasets: Human versus fungal ortholog groups reported by <xref rid="btz368-B33" ref-type="bibr">Szklarczyk <italic>et al.</italic> (2012)</xref>, and SABmark (<xref rid="btz368-B36" ref-type="bibr">Van Walle <italic>et al.</italic>, 2005</xref>) twilight zone dataset</p>
        </caption>
        <table frame="hsides" rules="groups">
          <colgroup span="1">
            <col valign="top" align="left" span="1"/>
            <col valign="top" align="char" char="." span="1"/>
            <col valign="top" align="char" char="." span="1"/>
            <col valign="top" align="char" char="." span="1"/>
            <col valign="top" align="char" char="." span="1"/>
            <col valign="top" align="char" char="." span="1"/>
            <col valign="top" align="char" char="." span="1"/>
            <col valign="top" align="char" char="." span="1"/>
            <col valign="top" align="char" char="." span="1"/>
            <col valign="top" align="char" char="." span="1"/>
          </colgroup>
          <thead>
            <tr>
              <th rowspan="1" colspan="1"/>
              <th colspan="8" rowspan="1">Human remote orthologs of fungal mitochondrial proteins<hr/></th>
              <th rowspan="1" colspan="1">SABmark proteins</th>
            </tr>
            <tr>
              <th rowspan="1" colspan="1"/>
              <th colspan="4" rowspan="1">Human versus <italic>S.cerevisiae</italic> (405 pairs)<hr/></th>
              <th colspan="4" rowspan="1">Human versus <italic>S.pombe</italic> (472 pairs)<hr/></th>
              <th rowspan="1" colspan="1">Twilight (10 250 pairs)</th>
            </tr>
            <tr>
              <th rowspan="1" colspan="1">Program</th>
              <th rowspan="1" colspan="1">%-Hits</th>
              <th rowspan="1" colspan="1">
                <inline-formula id="IE169">
                  <mml:math id="IM169">
                    <mml:mrow>
                      <mml:mi mathvariant="normal">I</mml:mi>
                      <mml:mo stretchy="false">(</mml:mo>
                      <mml:mi mathvariant="script">A</mml:mi>
                      <mml:mo stretchy="false">)</mml:mo>
                    </mml:mrow>
                  </mml:math>
                </inline-formula>
              </th>
              <th rowspan="1" colspan="1">
                <inline-formula id="IE170">
                  <mml:math id="IM170">
                    <mml:mrow>
                      <mml:mi mathvariant="normal">I</mml:mi>
                      <mml:mo stretchy="false">(</mml:mo>
                      <mml:mi mathvariant="bold">S</mml:mi>
                      <mml:mo>,</mml:mo>
                      <mml:mi mathvariant="bold">T</mml:mi>
                      <mml:mo>|</mml:mo>
                      <mml:mi mathvariant="script">A</mml:mi>
                      <mml:mo stretchy="false">)</mml:mo>
                    </mml:mrow>
                  </mml:math>
                </inline-formula>
              </th>
              <th rowspan="1" colspan="1">Compression</th>
              <th rowspan="1" colspan="1">%-Hits</th>
              <th rowspan="1" colspan="1">
                <inline-formula id="IE171">
                  <mml:math id="IM171">
                    <mml:mrow>
                      <mml:mi mathvariant="normal">I</mml:mi>
                      <mml:mo stretchy="false">(</mml:mo>
                      <mml:mi mathvariant="script">A</mml:mi>
                      <mml:mo stretchy="false">)</mml:mo>
                    </mml:mrow>
                  </mml:math>
                </inline-formula>
              </th>
              <th rowspan="1" colspan="1">
                <inline-formula id="IE172">
                  <mml:math id="IM172">
                    <mml:mrow>
                      <mml:mi mathvariant="normal">I</mml:mi>
                      <mml:mo stretchy="false">(</mml:mo>
                      <mml:mi mathvariant="bold">S</mml:mi>
                      <mml:mo>,</mml:mo>
                      <mml:mi mathvariant="bold">T</mml:mi>
                      <mml:mo>|</mml:mo>
                      <mml:mi mathvariant="script">A</mml:mi>
                      <mml:mo stretchy="false">)</mml:mo>
                    </mml:mrow>
                  </mml:math>
                </inline-formula>
              </th>
              <th rowspan="1" colspan="1">Compression</th>
              <th align="center" rowspan="1" colspan="1">%-Hits</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td rowspan="1" colspan="1">ClustalW</td>
              <td rowspan="1" colspan="1">71.85</td>
              <td rowspan="1" colspan="1">117.4</td>
              <td rowspan="1" colspan="1">2678.1</td>
              <td rowspan="1" colspan="1">82.6</td>
              <td rowspan="1" colspan="1">74.58</td>
              <td rowspan="1" colspan="1">110.3</td>
              <td rowspan="1" colspan="1">2575.0</td>
              <td rowspan="1" colspan="1">77.1</td>
              <td rowspan="1" colspan="1">1.7951</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">CONTRAlign</td>
              <td rowspan="1" colspan="1">71.11</td>
              <td rowspan="1" colspan="1">117.8</td>
              <td rowspan="1" colspan="1">2679.9</td>
              <td rowspan="1" colspan="1">75.7</td>
              <td rowspan="1" colspan="1">72.03</td>
              <td rowspan="1" colspan="1">108.8</td>
              <td rowspan="1" colspan="1">2573.6</td>
              <td rowspan="1" colspan="1">70.7</td>
              <td rowspan="1" colspan="1">2.3512</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">KAlign</td>
              <td rowspan="1" colspan="1">73.83</td>
              <td rowspan="1" colspan="1">134.3</td>
              <td rowspan="1" colspan="1">2639.3</td>
              <td rowspan="1" colspan="1">84.9</td>
              <td rowspan="1" colspan="1">74.79</td>
              <td rowspan="1" colspan="1">24.8</td>
              <td rowspan="1" colspan="1">2533.1</td>
              <td rowspan="1" colspan="1">81.8</td>
              <td rowspan="1" colspan="1">2.4878</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">MAFFT</td>
              <td rowspan="1" colspan="1">70.79</td>
              <td rowspan="1" colspan="1">163.9</td>
              <td rowspan="1" colspan="1">2622.1</td>
              <td rowspan="1" colspan="1">81.8</td>
              <td rowspan="1" colspan="1">71.91</td>
              <td rowspan="1" colspan="1">150.9</td>
              <td rowspan="1" colspan="1">2535.7</td>
              <td rowspan="1" colspan="1">76.7</td>
              <td rowspan="1" colspan="1">1.8187</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">MUSCLE</td>
              <td rowspan="1" colspan="1">73.83</td>
              <td rowspan="1" colspan="1">136.5</td>
              <td rowspan="1" colspan="1">2639.3</td>
              <td rowspan="1" colspan="1">86.1</td>
              <td rowspan="1" colspan="1">76.06</td>
              <td rowspan="1" colspan="1">129.8</td>
              <td rowspan="1" colspan="1">2539.1</td>
              <td rowspan="1" colspan="1">84.9</td>
              <td rowspan="1" colspan="1">2.4976</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">ProbCons</td>
              <td rowspan="1" colspan="1">70.12</td>
              <td rowspan="1" colspan="1">143.5</td>
              <td rowspan="1" colspan="1">2639.3</td>
              <td rowspan="1" colspan="1">78.9</td>
              <td rowspan="1" colspan="1">71.61</td>
              <td rowspan="1" colspan="1">130.4</td>
              <td rowspan="1" colspan="1">2543.9</td>
              <td rowspan="1" colspan="1">75.9</td>
              <td rowspan="1" colspan="1">1.6683</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">TCoffee</td>
              <td rowspan="1" colspan="1">69.14</td>
              <td rowspan="1" colspan="1">141.8</td>
              <td rowspan="1" colspan="1">2640.9</td>
              <td rowspan="1" colspan="1">76.5</td>
              <td rowspan="1" colspan="1">71.19</td>
              <td rowspan="1" colspan="1">130.8</td>
              <td rowspan="1" colspan="1">2544.4</td>
              <td rowspan="1" colspan="1">71.1</td>
              <td rowspan="1" colspan="1">1.6390</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">MML (<inline-formula id="IE173"><mml:math id="IM173"><mml:mrow><mml:mi mathvariant="normal">I</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="script">A</mml:mi></mml:mrow><mml:mo>*</mml:mo></mml:msup><mml:mo>,</mml:mo><mml:mrow><mml:mo>〈</mml:mo><mml:mrow><mml:mi mathvariant="bold">S</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold">T</mml:mi></mml:mrow><mml:mo>〉</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>)</td>
              <td rowspan="1" colspan="1">79.26</td>
              <td rowspan="1" colspan="1">119.1</td>
              <td rowspan="1" colspan="1">2666.5</td>
              <td rowspan="1" colspan="1">93.7</td>
              <td rowspan="1" colspan="1">80.51</td>
              <td rowspan="1" colspan="1">109.5</td>
              <td rowspan="1" colspan="1">2548.85</td>
              <td rowspan="1" colspan="1">94.2</td>
              <td rowspan="1" colspan="1">4.1399</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">MML (<inline-formula id="IE174"><mml:math id="IM174"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="normal">I</mml:mi></mml:mrow><mml:mrow><mml:mtext>marginal</mml:mtext></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mrow><mml:mo>〈</mml:mo><mml:mrow><mml:mi mathvariant="bold">S</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold">T</mml:mi></mml:mrow><mml:mo>〉</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>)</td>
              <td rowspan="1" colspan="1">94.57</td>
              <td align="center" rowspan="1" colspan="1">N/A</td>
              <td align="center" rowspan="1" colspan="1">N/A</td>
              <td rowspan="1" colspan="1">125.0</td>
              <td rowspan="1" colspan="1">94.49</td>
              <td align="center" rowspan="1" colspan="1">N/A</td>
              <td align="center" rowspan="1" colspan="1">N/A</td>
              <td rowspan="1" colspan="1">117.9</td>
              <td rowspan="1" colspan="1">34.9951</td>
            </tr>
          </tbody>
        </table>
        <table-wrap-foot>
          <fn id="tblfn1">
            <p><italic>Note:</italic> The reported <inline-formula id="IE175"><mml:math id="IM175"><mml:mrow><mml:mi mathvariant="normal">I</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="script">A</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo><mml:mi mathvariant="normal">I</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mo>〈</mml:mo><mml:mi mathvariant="bold">S</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold">T</mml:mi><mml:mo>〉</mml:mo><mml:mo>|</mml:mo><mml:mi mathvariant="script">A</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>, and ‘Compression’ values are median statistics across the respective groups. These are information measures, reported in <italic>bits</italic>. (Only ‘%-Hits’ statistic is shown for SABmark dataset. For full details of other statistics, see <xref ref-type="supplementary-material" rid="sup1">Supplementary Section S5</xref>.) N/A = Not Applicable.</p>
          </fn>
        </table-wrap-foot>
      </table-wrap>
      <p>Our MML based marginal probability method has the highest percentage of hits (94.57% and 94.49% across the two groups, respectively). This is followed by our MML based method to identify the best alignment hypothesis (79.26% and 80.51%). MUSCLE and KAlign (both with 73.83% hits in the first group; 76.06% and 74.79% hits respectively in the second) are the next best performers.</p>
      <p>We also compared the performance of all programs on the SABmark <italic>twilight</italic> zone sequences covering 10 250 sequence pairs. This is a substantially difficult dataset for most programs, especially those that rely on reporting a single alignment. <xref rid="btz368-T1" ref-type="table">Table 1</xref> gives the results. As it can be seen, methods that rely on finding the best alignment under their respective criteria fare far worse than our MML based method that estimates the marginal probability of relationship between two sequences, and ascertains its statistical significance with the null model. The MML based marginal probability is able to identify significantly more number of hits (34.9%). A far second is our MML based best alignment approach (4.1%), followed by MUSCLE (2.5%).</p>
      <sec>
        <title>3.2.1 Marginal probability landscapes</title>
        <p>As suggested in the introduction (<xref ref-type="fig" rid="btz368-F1">Fig. 1</xref>), our work is able to produce the entire landscape of competing alignments based on marginal probability, for users to interactively study regions (and alignments) of interest, rather than just relying on the single best. <xref ref-type="fig" rid="btz368-F5">Figure 5</xref> gives a few more examples for randomly chosen pairs from our benchmark. This landscape can be queried to generate competing alignments, shown as paths in <xref ref-type="fig" rid="btz368-F5">Figure 5</xref>. The <xref ref-type="supplementary-material" rid="sup1">Supplementary Section S5</xref> provides a wider selection of landscapes comparing sequences across varying distances.
</p>
        <fig id="btz368-F5" orientation="portrait" position="float">
          <label>Fig. 5.</label>
          <caption>
            <p>Landscapes generated for two randomly selected pairs, one pair taken from the Human ortholog benchmark, and the other from SABmark benchmark. For more, see <xref ref-type="supplementary-material" rid="sup1">Supplementary Section S5</xref></p>
          </caption>
          <graphic xlink:href="btz368f5"/>
        </fig>
      </sec>
      <sec>
        <title>3.2.2 Computational complexity and run times</title>
        <p>The asymptotic time complexity to align any two sequences in our MML framework grows as <inline-formula id="IE176"><mml:math id="IM176"><mml:mrow><mml:mi>O</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mo>|</mml:mo><mml:mi mathvariant="bold">S</mml:mi><mml:mo>|</mml:mo><mml:mo>|</mml:mo><mml:mi mathvariant="bold">T</mml:mi><mml:mo>|</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>. Any specific competing alignment can be probed and reported in <inline-formula id="IE177"><mml:math id="IM177"><mml:mrow><mml:mi>O</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mo>|</mml:mo><mml:mi mathvariant="bold">S</mml:mi><mml:mo>|</mml:mo><mml:mo>+</mml:mo><mml:mo>|</mml:mo><mml:mi mathvariant="bold">T</mml:mi><mml:mo>|</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> time after the initial <inline-formula id="IE178"><mml:math id="IM178"><mml:mrow><mml:mi>O</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mo>|</mml:mo><mml:mi mathvariant="bold">S</mml:mi><mml:mo>|</mml:mo><mml:mo>|</mml:mo><mml:mi mathvariant="bold">T</mml:mi><mml:mo>|</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>-effort to compute the marginal landscape. Using our distributed alignment program, the average run time required to compute <inline-formula id="IE179"><mml:math id="IM179"><mml:mrow><mml:mi mathvariant="normal">I</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="script">A</mml:mi></mml:mrow><mml:mo>*</mml:mo></mml:msup><mml:mo>,</mml:mo><mml:mrow><mml:mo>〈</mml:mo><mml:mrow><mml:mi mathvariant="bold">S</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold">T</mml:mi></mml:mrow><mml:mo>〉</mml:mo></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> and <inline-formula id="IE180"><mml:math id="IM180"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="normal">I</mml:mi></mml:mrow><mml:mrow><mml:mtext>marginal</mml:mtext></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mo>〈</mml:mo><mml:mrow><mml:mi mathvariant="bold">S</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold">T</mml:mi></mml:mrow><mml:mo>〉</mml:mo></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> for a sequence pair from SABmark benchmark (on a standard Linux-based computer) is approximately 1.5 s and 1.7 s, respectively.</p>
      </sec>
    </sec>
  </sec>
  <sec>
    <title>Acknowledgements</title>
    <p>The authors thank Françios Petitjean for helpful suggestions on parameterizing Dirichlet distributions.</p>
  </sec>
  <sec>
    <title>Funding</title>
    <p>D.S.’s PhD scholarship is funded by Monash University. A.K.’s research is funded by Australian Research Council’s Discovery Project (DP150100894).</p>
    <p><italic>Conflict of Interest</italic>: none declared.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material content-type="local-data" id="sup1">
      <label>btz368_Supplementary_Data</label>
      <media xlink:href="btz368_supplementary_data.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <ref-list id="ref1">
    <title>References</title>
    <ref id="btz368-B1">
      <mixed-citation publication-type="book"><person-group person-group-type="author"><name name-style="western"><surname>Allison</surname><given-names>L.</given-names></name></person-group> (<year>2018</year>) <source>Coding Ockham’s Razor</source>. 
<publisher-name>Springer</publisher-name>, 
<publisher-loc>Cham, Switzerland</publisher-loc>.</mixed-citation>
    </ref>
    <ref id="btz368-B2">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Allison</surname><given-names>L.</given-names></name></person-group><etal>et al</etal> (<year>1992</year>) 
<article-title>Finite-state models in the alignment of macromolecules</article-title>. <source>J. Mol. Evol</source>., <volume>35</volume>, <fpage>77</fpage>–<lpage>89</lpage>.<pub-id pub-id-type="pmid">1518085</pub-id></mixed-citation>
    </ref>
    <ref id="btz368-B3">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Allison</surname><given-names>L.</given-names></name></person-group><etal>et al</etal> (<year>1999</year>) 
<article-title>Compression and approximate matching</article-title>. <source>Comput. J</source>., <volume>42</volume>, <fpage>1</fpage>–<lpage>10</lpage>.</mixed-citation>
    </ref>
    <ref id="btz368-B4">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Barton</surname><given-names>G.J.</given-names></name>, <name name-style="western"><surname>Sternberg</surname><given-names>M.J.</given-names></name></person-group> (<year>1987</year>) 
<article-title>Evaluation and improvements in the automatic alignment of protein sequences</article-title>. <source>Protein Eng</source>., <volume>1</volume>, <fpage>89</fpage>–<lpage>94</lpage>.<pub-id pub-id-type="pmid">3507699</pub-id></mixed-citation>
    </ref>
    <ref id="btz368-B5">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Bayes</surname><given-names>T.</given-names></name></person-group> (<year>1763</year>) 
<article-title>A letter from the late Reverend Mr. Thomas Bayes, FRS to John Canton, MA and FRS</article-title>. <source>Philos. Trans</source>., <volume>53</volume>, <fpage>269</fpage>–<lpage>271</lpage>.</mixed-citation>
    </ref>
    <ref id="btz368-B6">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Benner</surname><given-names>S.A.</given-names></name></person-group><etal>et al</etal> (<year>1993</year>) 
<article-title>Empirical and structural models for insertions and deletions in the divergent evolution of proteins</article-title>. <source>J. Mol. Biol</source>., <volume>229</volume>, <fpage>1065</fpage>–<lpage>1082</lpage>.<pub-id pub-id-type="pmid">8445636</pub-id></mixed-citation>
    </ref>
    <ref id="btz368-B7">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Blake</surname><given-names>J.D.</given-names></name>, <name name-style="western"><surname>Cohen</surname><given-names>F.E.</given-names></name></person-group> (<year>2001</year>) 
<article-title>Pairwise sequence alignment below the twilight zone1</article-title>. <source>J. Mol. Biol</source>., <volume>307</volume>, <fpage>721</fpage>–<lpage>735</lpage>.<pub-id pub-id-type="pmid">11254392</pub-id></mixed-citation>
    </ref>
    <ref id="btz368-B8">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Collier</surname><given-names>J.H.</given-names></name></person-group><etal>et al</etal> (<year>2017</year>) 
<article-title>Statistical inference of protein structural alignments using information and compression</article-title>. <source>Bioinformatics</source>, <volume>33</volume>, <fpage>1005</fpage>–<lpage>1013</lpage>.<pub-id pub-id-type="pmid">28065899</pub-id></mixed-citation>
    </ref>
    <ref id="btz368-B9">
      <mixed-citation publication-type="book"><person-group person-group-type="author"><name name-style="western"><surname>Dayhoff</surname><given-names>O.M.</given-names></name></person-group><etal>et al</etal> (ed.) (<year>1978</year>) <chapter-title>22 a model of evolutionary change in proteins</chapter-title> In: <source>Atlas of Protein Sequence and Structure</source>. Vol. <volume>5</volume>
<publisher-name>National Biomedical Research Foundation</publisher-name>, 
<publisher-loc>Silver Spring, MD</publisher-loc>, pp. <fpage>345</fpage>–<lpage>352</lpage>.</mixed-citation>
    </ref>
    <ref id="btz368-B10">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Do</surname><given-names>C.B.</given-names></name></person-group><etal>et al</etal> (<year>2005</year>) 
<article-title>ProbCons: probabilistic consistency-based multiple sequence alignment</article-title>. <source>Genome Res</source>., <volume>15</volume>, <fpage>330</fpage>–<lpage>340</lpage>.<pub-id pub-id-type="pmid">15687296</pub-id></mixed-citation>
    </ref>
    <ref id="btz368-B11">
      <mixed-citation publication-type="book"><person-group person-group-type="author"><name name-style="western"><surname>Do</surname><given-names>C.B.</given-names></name></person-group><etal>et al</etal> (<year>2006</year>) <chapter-title>CONTRAlign: discriminative training for protein sequence alignment</chapter-title> In: <source>Annual International Conference on Research in Computational Molecular Biology, Venice, Italy</source>. 
<publisher-name>Springer</publisher-name>, pp. <fpage>160</fpage>–<lpage>174</lpage>.</mixed-citation>
    </ref>
    <ref id="btz368-B12">
      <mixed-citation publication-type="book"><person-group person-group-type="author"><name name-style="western"><surname>Doolittle</surname><given-names>R.F.</given-names></name></person-group> (<year>1986</year>) <source>Of URFs and ORFs: A Primer on How to Analyze Derived Amino Acid Sequences</source>. 
<publisher-name>University Science Books</publisher-name>, 
<publisher-loc>CA, USA</publisher-loc>.</mixed-citation>
    </ref>
    <ref id="btz368-B13">
      <mixed-citation publication-type="book"><person-group person-group-type="author"><name name-style="western"><surname>Durbin</surname><given-names>R.</given-names></name></person-group><etal>et al</etal> (<year>1998</year>) <source>Biological Sequence Analysis: Probabilistic Models of Proteins and Nucleic Acids</source>. 
<publisher-name>Cambridge University Press</publisher-name>, 
<publisher-loc>New York, USA</publisher-loc>.</mixed-citation>
    </ref>
    <ref id="btz368-B14">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Edgar</surname><given-names>R.</given-names></name></person-group> (<year>2004</year>) 
<article-title>MUSCLE: multiple sequence alignment with high accuracy and high throughput</article-title>. <source>Nucleic Acids Res</source>., <volume>32</volume>, <fpage>1792</fpage>–<lpage>1797</lpage>.<pub-id pub-id-type="pmid">15034147</pub-id></mixed-citation>
    </ref>
    <ref id="btz368-B15">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Fitch</surname><given-names>W.M.</given-names></name>, <name name-style="western"><surname>Smith</surname><given-names>T.F.</given-names></name></person-group> (<year>1983</year>) 
<article-title>Optimal sequence alignments</article-title>. <source>Proc. Natl. Acad. Sci. USA</source>, <volume>80</volume>, <fpage>1382</fpage>–<lpage>1386</lpage>.<pub-id pub-id-type="pmid">16593289</pub-id></mixed-citation>
    </ref>
    <ref id="btz368-B16">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Gonnet</surname><given-names>G.H.</given-names></name></person-group><etal>et al</etal> (<year>1992</year>) 
<article-title>Exhaustive matching of the entire protein sequence database</article-title>. <source>Science</source>, <volume>256</volume>, <fpage>1443</fpage>–<lpage>1445</lpage>.<pub-id pub-id-type="pmid">1604319</pub-id></mixed-citation>
    </ref>
    <ref id="btz368-B17">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Henikoff</surname><given-names>S.</given-names></name>, <name name-style="western"><surname>Henikoff</surname><given-names>J.G.</given-names></name></person-group> (<year>1992</year>) 
<article-title>Amino acid substitution matrices from protein blocks</article-title>. <source>Proc. Natl. Acad. Sci. USA</source>, <volume>89</volume>, <fpage>10915</fpage>–<lpage>10919</lpage>.<pub-id pub-id-type="pmid">1438297</pub-id></mixed-citation>
    </ref>
    <ref id="btz368-B18">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Katoh</surname><given-names>K.</given-names></name>, <name name-style="western"><surname>Standley</surname><given-names>D.M.</given-names></name></person-group> (<year>2013</year>) 
<article-title>Mafft multiple sequence alignment software version 7: improvements in performance and usability</article-title>. <source>Mol. Biol. Evol</source>., <volume>30</volume>, <fpage>772</fpage>–<lpage>780</lpage>.<pub-id pub-id-type="pmid">23329690</pub-id></mixed-citation>
    </ref>
    <ref id="btz368-B19">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Kolmogorov</surname><given-names>A.N.</given-names></name></person-group> (<year>1963</year>) 
<article-title>On tables of random numbers</article-title>. <source>Sankhyā</source>, <volume>25</volume>, <fpage>369</fpage>–<lpage>376</lpage>.</mixed-citation>
    </ref>
    <ref id="btz368-B20">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Larkin</surname><given-names>M.A.</given-names></name></person-group><etal>et al</etal> (<year>2007</year>) 
<article-title>Clustal W and Clustal X version 2.0</article-title>. <source>Bioinformatics</source>, <volume>23</volume>, <fpage>2947</fpage>–<lpage>2948</lpage>.<pub-id pub-id-type="pmid">17846036</pub-id></mixed-citation>
    </ref>
    <ref id="btz368-B21">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Lassmann</surname><given-names>T.</given-names></name>, <name name-style="western"><surname>Sonnhammer</surname><given-names>E.L.</given-names></name></person-group> (<year>2005</year>) 
<article-title>KAlign—an accurate and fast multiple sequence alignment algorithm</article-title>. <source>BMC Bioinformatics</source>, <volume>6</volume>, <fpage>298.</fpage><pub-id pub-id-type="pmid">16343337</pub-id></mixed-citation>
    </ref>
    <ref id="btz368-B22">
      <mixed-citation publication-type="book"><person-group person-group-type="author"><name name-style="western"><surname>Lesk</surname><given-names>A.M.</given-names></name></person-group> (<year>2017</year>) <source>Introduction to Genomics</source>. 
<publisher-name>Oxford University Press</publisher-name>, 
<publisher-loc>New York, USA</publisher-loc>.</mixed-citation>
    </ref>
    <ref id="btz368-B23">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Levy Karin</surname><given-names>E.</given-names></name></person-group><etal>et al</etal> (<year>2019</year>) 
<article-title>A simulation-based approach to statistical alignment</article-title>. <source>Syst. Biol</source>. <volume>68</volume>, <fpage>252</fpage>–<lpage>266</lpage>.<pub-id pub-id-type="pmid">30239957</pub-id></mixed-citation>
    </ref>
    <ref id="btz368-B24">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Löytynoja</surname><given-names>A.</given-names></name>, <name name-style="western"><surname>Goldman</surname><given-names>N.</given-names></name></person-group> (<year>2008</year>) 
<article-title>Phylogeny-aware gap placement prevents errors in sequence alignment and evolutionary analysis</article-title>. <source>Science</source>, <volume>320</volume>, <fpage>1632</fpage>–<lpage>1635</lpage>.<pub-id pub-id-type="pmid">18566285</pub-id></mixed-citation>
    </ref>
    <ref id="btz368-B25">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Murzin</surname><given-names>A.G.</given-names></name></person-group><etal>et al</etal> (<year>1995</year>) 
<article-title>SCOP: a structural classification of proteins database for the investigation of sequences and structures</article-title>. <source>J. Mol. Biol</source>., <volume>247</volume>, <fpage>536</fpage>–<lpage>540</lpage>.<pub-id pub-id-type="pmid">7723011</pub-id></mixed-citation>
    </ref>
    <ref id="btz368-B26">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Notredame</surname><given-names>C.</given-names></name></person-group><etal>et al</etal> (<year>2000</year>) 
<article-title>T-coffee: a novel method for fast and accurate multiple sequence alignment1</article-title>. <source>J. Mol. Biol</source>., <volume>302</volume>, <fpage>205</fpage>–<lpage>217</lpage>.<pub-id pub-id-type="pmid">10964570</pub-id></mixed-citation>
    </ref>
    <ref id="btz368-B27">
      <mixed-citation publication-type="book"><person-group person-group-type="author"><name name-style="western"><surname>Powell</surname><given-names>D.R.</given-names></name></person-group><etal>et al</etal> (<year>2004</year>) <chapter-title>Modelling-alignment for non-random sequences</chapter-title> In: <source>Australian Conference on Artificial Intelligence</source>. 
<publisher-name>Springer</publisher-name>, 
<publisher-loc>Cairns, Australia</publisher-loc>, pp. <fpage>203</fpage>–<lpage>214</lpage>.</mixed-citation>
    </ref>
    <ref id="btz368-B28">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Redelings</surname><given-names>B.D.</given-names></name>, <name name-style="western"><surname>Suchard</surname><given-names>M.A.</given-names></name></person-group> (<year>2005</year>) 
<article-title>Joint bayesian estimation of alignment and phylogeny</article-title>. <source>Syst. Biol</source>., <volume>54</volume>, <fpage>401</fpage>–<lpage>418</lpage>.<pub-id pub-id-type="pmid">16012107</pub-id></mixed-citation>
    </ref>
    <ref id="btz368-B29">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Rivas</surname><given-names>E.</given-names></name>, <name name-style="western"><surname>Eddy</surname><given-names>S.R.</given-names></name></person-group> (<year>2015</year>) 
<article-title>Parameterizing sequence alignment with an explicit evolutionary model</article-title>. <source>BMC Bioinformatics</source>, <volume>16</volume>, <fpage>406.</fpage><pub-id pub-id-type="pmid">26652060</pub-id></mixed-citation>
    </ref>
    <ref id="btz368-B30">
      <mixed-citation publication-type="book"><person-group person-group-type="author"><name name-style="western"><surname>Rosenberg</surname><given-names>M.S.</given-names></name></person-group> (<year>2009</year>) <source>Sequence Alignment: Methods, Models, Concepts, and Strategies.</source><publisher-name>University of California Press</publisher-name>, 
<publisher-loc>Los Angeles, USA</publisher-loc>.</mixed-citation>
    </ref>
    <ref id="btz368-B31">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Shannon</surname><given-names>C.E.</given-names></name></person-group> (<year>1948</year>) 
<article-title>A mathematical theory of communication</article-title>. <source>Bell Syst. Tech. J</source>., <volume>27</volume>, <fpage>379</fpage>–<lpage>423</lpage>.</mixed-citation>
    </ref>
    <ref id="btz368-B32">
      <mixed-citation publication-type="book"><person-group person-group-type="author"><name name-style="western"><surname>Sumanaweera</surname><given-names>D.</given-names></name></person-group><etal>et al</etal> (<year>2018</year>) <chapter-title>The bits between proteins</chapter-title> In: <source>2018 Data Compression Conference, Snowbird, USA</source>. 
<publisher-name>IEEE</publisher-name>, pp. <fpage>177</fpage>–<lpage>186</lpage>.</mixed-citation>
    </ref>
    <ref id="btz368-B33">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Szklarczyk</surname><given-names>R.</given-names></name></person-group><etal>et al</etal> (<year>2012</year>) 
<article-title>Iterative orthology prediction uncovers new mitochondrial proteins and identifies c12orf62 as the human ortholog of cox14, a protein involved in the assembly of cytochrome c oxidase</article-title>. <source>Genome Biol</source>., <volume>13</volume>, <fpage>R12</fpage>.<pub-id pub-id-type="pmid">22356826</pub-id></mixed-citation>
    </ref>
    <ref id="btz368-B34">
      <mixed-citation publication-type="book"><person-group person-group-type="author"><name name-style="western"><surname>Trumpler</surname><given-names>R.J.</given-names></name>, <name name-style="western"><surname>Weaver</surname><given-names>H.F.</given-names></name></person-group> (<year>1953</year>) <source>Statistical Astronomy</source>. 
<publisher-name>University of California Press</publisher-name>, 
<publisher-loc>Berkeley and Los Angeles, USA</publisher-loc>.</mixed-citation>
    </ref>
    <ref id="btz368-B35">
      <mixed-citation publication-type="journal">UniProt-Consortium <etal>et al</etal> (<year>2017</year>) 
<article-title>UniProt: the universal protein knowledgebase</article-title>. <source>Nucleic Acids Res</source>., <volume>45</volume>, <fpage>D158</fpage>–<lpage>D169</lpage>.<pub-id pub-id-type="pmid">27899622</pub-id></mixed-citation>
    </ref>
    <ref id="btz368-B36">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Van Walle</surname><given-names>I.</given-names></name></person-group><etal>et al</etal> (<year>2005</year>) 
<article-title>Sabmark-a benchmark for sequence alignment that covers the entire known fold space</article-title>. <source>Bioinformatics</source>, <volume>21</volume>, <fpage>1267</fpage>–<lpage>1268</lpage>.<pub-id pub-id-type="pmid">15333456</pub-id></mixed-citation>
    </ref>
    <ref id="btz368-B37">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Vingron</surname><given-names>M.</given-names></name>, <name name-style="western"><surname>Waterman</surname><given-names>M.S.</given-names></name></person-group> (<year>1994</year>) 
<article-title>Sequence alignment and penalty choice: review of concepts, case studies and implications</article-title>. <source>J. Mol. Biol</source>., <volume>235</volume>, <fpage>1</fpage>–<lpage>12</lpage>.<pub-id pub-id-type="pmid">8289235</pub-id></mixed-citation>
    </ref>
    <ref id="btz368-B38">
      <mixed-citation publication-type="book"><person-group person-group-type="author"><name name-style="western"><surname>Wallace</surname><given-names>C.S.</given-names></name></person-group> (<year>2005</year>) <source>Statistical and Inductive Inference by Minimum Message Length</source>. 
<publisher-name>Springer</publisher-name>, 
<publisher-loc>New York, USA</publisher-loc>.</mixed-citation>
    </ref>
    <ref id="btz368-B39">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Wallace</surname><given-names>C.S.</given-names></name>, <name name-style="western"><surname>Boulton</surname><given-names>D.M.</given-names></name></person-group> (<year>1968</year>) 
<article-title>An information measure for classification</article-title>. <source>Comput. J</source>., <volume>11</volume>, <fpage>185</fpage>–<lpage>194</lpage>.</mixed-citation>
    </ref>
    <ref id="btz368-B40">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Wallace</surname><given-names>C.S.</given-names></name>, <name name-style="western"><surname>Freeman</surname><given-names>P.R.</given-names></name></person-group> (<year>1987</year>) 
<article-title>Estimation and inference by compact coding</article-title>. <source>J. R. Stat. Soc. Series B Methodol</source>., <volume>49</volume>, <fpage>240</fpage>–<lpage>265</lpage>. pages</mixed-citation>
    </ref>
    <ref id="btz368-B41">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Wallace</surname><given-names>C.S.</given-names></name>, <name name-style="western"><surname>Patrick</surname><given-names>J.D.</given-names></name></person-group> (<year>1993</year>) 
<article-title>Coding decision trees</article-title>. <source>Machine Learning</source>, <volume>11</volume>, <fpage>7</fpage>–<lpage>22</lpage>.</mixed-citation>
    </ref>
    <ref id="btz368-B42">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Zhu</surname><given-names>J.</given-names></name></person-group><etal>et al</etal> (<year>1998</year>) 
<article-title>Bayesian adaptive sequence alignment algorithms</article-title>. <source>Bioinformatics</source>, <volume>14</volume>, <fpage>25</fpage>–<lpage>39</lpage>.<pub-id pub-id-type="pmid">9520499</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
