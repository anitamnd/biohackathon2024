<?DTDIdentifier.IdentifierValue article.dtd?>
<?DTDIdentifier.IdentifierType system?>
<?SourceDTD.DTDName article.dtd?>
<?SourceDTD.Version v40?>
<?ConverterInfo.XSLTName bmc2nlm.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">BMC Bioinformatics</journal-id>
    <journal-title>BMC Bioinformatics</journal-title>
    <issn pub-type="epub">1471-2105</issn>
    <publisher>
      <publisher-name>BioMed Central</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">2701419</article-id>
    <article-id pub-id-type="publisher-id">1471-2105-10-145</article-id>
    <article-id pub-id-type="pmid">19442304</article-id>
    <article-id pub-id-type="doi">10.1186/1471-2105-10-145</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Software</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>flowClust: a Bioconductor package for automated gating of flow cytometry data</article-title>
    </title-group>
    <contrib-group>
      <contrib id="A1" corresp="yes" contrib-type="author">
        <name>
          <surname>Lo</surname>
          <given-names>Kenneth</given-names>
        </name>
        <xref ref-type="aff" rid="I1">1</xref>
        <email>c.lo@stat.ubc.ca</email>
      </contrib>
      <contrib id="A2" contrib-type="author">
        <name>
          <surname>Hahne</surname>
          <given-names>Florian</given-names>
        </name>
        <xref ref-type="aff" rid="I2">2</xref>
        <email>fhahne@fhcrc.org</email>
      </contrib>
      <contrib id="A3" contrib-type="author">
        <name>
          <surname>Brinkman</surname>
          <given-names>Ryan R</given-names>
        </name>
        <xref ref-type="aff" rid="I3">3</xref>
        <email>rbrinkman@bccrc.ca</email>
      </contrib>
      <contrib id="A4" contrib-type="author">
        <name>
          <surname>Gottardo</surname>
          <given-names>Raphael</given-names>
        </name>
        <xref ref-type="aff" rid="I4">4</xref>
        <xref ref-type="aff" rid="I5">5</xref>
        <email>raphael.gottardo@ircm.qc.ca</email>
      </contrib>
    </contrib-group>
    <aff id="I1"><label>1</label>Department of Statistics, University of British Columbia, 333-6356 Agricultural Road, Vancouver, BC, V6T1Z2, Canada</aff>
    <aff id="I2"><label>2</label>Fred Hutchinson Cancer Research Center, 1100 Fairview Avenue North, Seattle, WA 98109, USA</aff>
    <aff id="I3"><label>3</label>Terry Fox Laboratory, BC Cancer Research Center, 675 West 10th Avenue, Vancouver, BC, V5Z1L3, Canada</aff>
    <aff id="I4"><label>4</label>Institut de recherches cliniques de Montreal, 110, avenue des Pins Ouest, Montreal, QC, H2W 1R7, Canada</aff>
    <aff id="I5"><label>5</label>Département de biochimie, Université de Montreal, 2900, boul Edouard-Montpetit, Montreal, QC, H3T 1J4, Canada</aff>
    <pub-date pub-type="collection">
      <year>2009</year>
    </pub-date>
    <pub-date pub-type="epub">
      <day>14</day>
      <month>5</month>
      <year>2009</year>
    </pub-date>
    <volume>10</volume>
    <fpage>145</fpage>
    <lpage>145</lpage>
    <ext-link ext-link-type="uri" xlink:href="http://www.biomedcentral.com/1471-2105/10/145"/>
    <history>
      <date date-type="received">
        <day>10</day>
        <month>1</month>
        <year>2009</year>
      </date>
      <date date-type="accepted">
        <day>14</day>
        <month>5</month>
        <year>2009</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>Copyright © 2009 Lo et al; licensee BioMed Central Ltd.</copyright-statement>
      <copyright-year>2009</copyright-year>
      <copyright-holder>Lo et al; licensee BioMed Central Ltd.</copyright-holder>
      <license license-type="open-access" xlink:href="http://creativecommons.org/licenses/by/2.0">
        <p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/2.0"/>), which permits unrestricted use, distribution, and reproduction in any medium, provided the original work is properly cited.</p>
        <!--<rdf xmlns="http://web.resource.org/cc/" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:dc="http://purl.org/dc/elements/1.1" xmlns:dcterms="http://purl.org/dc/terms"><Work xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:dcterms="http://purl.org/dc/terms/" rdf:about=""><license rdf:resource="http://creativecommons.org/licenses/by/2.0"/><dc:type rdf:resource="http://purl.org/dc/dcmitype/Text"/><dc:author>
               Lo
               Kenneth
               
               c.lo@stat.ubc.ca
            </dc:author><dc:title>
            flowClust: a Bioconductor package for automated gating of flow cytometry data
         </dc:title><dc:date>2009</dc:date><dcterms:bibliographicCitation>BMC Bioinformatics 10(1): 145-. (2009)</dcterms:bibliographicCitation><dc:identifier type="sici">1471-2105(2009)10:1&#x0003c;145&#x0003e;</dc:identifier><dcterms:isPartOf>urn:ISSN:1471-2105</dcterms:isPartOf><License rdf:about="http://creativecommons.org/licenses/by/2.0"><permits rdf:resource="http://web.resource.org/cc/Reproduction" xmlns=""/><permits rdf:resource="http://web.resource.org/cc/Distribution" xmlns=""/><requires rdf:resource="http://web.resource.org/cc/Notice" xmlns=""/><requires rdf:resource="http://web.resource.org/cc/Attribution" xmlns=""/><permits rdf:resource="http://web.resource.org/cc/DerivativeWorks" xmlns=""/></License></Work></rdf>-->
      </license>
    </permissions>
    <abstract>
      <sec>
        <title>Background</title>
        <p>As a high-throughput technology that offers rapid quantification of multidimensional characteristics for millions of cells, flow cytometry (FCM) is widely used in health research, medical diagnosis and treatment, and vaccine development. Nevertheless, there is an increasing concern about the lack of appropriate software tools to provide an automated analysis platform to parallelize the high-throughput data-generation platform. Currently, to a large extent, FCM data analysis relies on the manual selection of sequential regions in 2-D graphical projections to extract the cell populations of interest. This is a time-consuming task that ignores the high-dimensionality of FCM data.</p>
      </sec>
      <sec>
        <title>Results</title>
        <p>In view of the aforementioned issues, we have developed an <bold>R </bold>package called <bold>flowClust </bold>to automate FCM analysis. <bold>flowClust </bold>implements a robust model-based clustering approach based on multivariate <italic>t </italic>mixture models with the Box-Cox transformation. The package provides the functionality to identify cell populations whilst simultaneously handling the commonly encountered issues of outlier identification and data transformation. It offers various tools to summarize and visualize a wealth of features of the clustering results. In addition, to ensure its convenience of use, <bold>flowClust </bold>has been adapted for the current FCM data format, and integrated with existing Bioconductor packages dedicated to FCM analysis.</p>
      </sec>
      <sec>
        <title>Conclusion</title>
        <p><bold>flowClust </bold>addresses the issue of a dearth of software that helps automate FCM analysis with a sound theoretical foundation. It tends to give reproducible results, and helps reduce the significant subjectivity and human time cost encountered in FCM analysis. The package contributes to the cytometry community by offering an efficient, automated analysis platform which facilitates the active, ongoing technological advancement.</p>
      </sec>
    </abstract>
  </article-meta>
</front>
<body>
  <sec>
    <title>Background</title>
    <p>Flow cytometry (FCM) is a high-throughput technology that offers rapid quantification of a set of physical and chemical characteristics for a large number of cells in a sample. FCM is widely used in health research and treatment for a variety of tasks, such as providing the counts of helper-T lymphocytes needed to monitor the course and treatment of HIV infection, in the diagnosis and monitoring of leukemia and lymphoma patients, the evaluation of peripheral blood hematopoietic stem cell grafts, and many other diseases [<xref ref-type="bibr" rid="B1">1</xref>-<xref ref-type="bibr" rid="B8">8</xref>]. The technology is also used in cross-matching organs for transplantation and in research involving stem cells, vaccine development, apoptosis, phagocytosis, and a wide range of cellular properties including phenotype, cytokine expression, and cell-cycle status [<xref ref-type="bibr" rid="B9">9</xref>-<xref ref-type="bibr" rid="B14">14</xref>].</p>
    <p>Currently, FCM can be applied to analyze thousands of samples per day. Nevertheless, despite its widespread use, FCM has not reached its full potential due to the lack of an automated analysis platform to parallel the high-throughput data-generation platform. In contrast to the tremendous interest in the FCM technology, there is a dearth of statistical and bioinformatics tools to manage, analyze, present, and disseminate FCM data. There is considerable demand for the development of appropriate software tools, as manual analysis of individual samples is error-prone, non-reproducible, non-standardized, not open to re-evaluation, and requires an inordinate amount of time, making it a limiting aspect of the technology [<xref ref-type="bibr" rid="B1">1</xref>,<xref ref-type="bibr" rid="B7">7</xref>,<xref ref-type="bibr" rid="B15">15</xref>-<xref ref-type="bibr" rid="B21">21</xref>].</p>
    <p>One core component of FCM analysis involves gating, the process of identifying cell populations that share a set of common properties or display a particular biological function. Currently, to a large extent, gating relies on the sequential application of a series of manually drawn gates (i.e., data filters) that define regions in 1- or 2-D graphical projections of FCM data. This process is manually time-consuming and subjective as researchers have traditionally relied on intuition rather than standardized statistical inference [<xref ref-type="bibr" rid="B7">7</xref>,<xref ref-type="bibr" rid="B22">22</xref>,<xref ref-type="bibr" rid="B23">23</xref>]. In addition, this process ignores the high-dimensionality of FCM data, which may convey more information than that provided by only looking at 1- or 2-D projections.</p>
    <p>Recently, a suite of several <bold>R </bold>packages providing infrastructure for FCM analysis have been released though Bioconductor [<xref ref-type="bibr" rid="B24">24</xref>], an open source software development project for the analysis of genomic data. <bold>flowCore </bold>[<xref ref-type="bibr" rid="B25">25</xref>], the core package among them, provides data structures and basic manipulation of FCM data. <bold>flowViz </bold>[<xref ref-type="bibr" rid="B26">26</xref>] offers visualization tools, while <bold>flowQ </bold>provides quality control and quality assessment tools for FCM data. Finally, <bold>flowUtils </bold>provides utilities to deal with data import/export for <bold>flowCore</bold>. In spite of these low-level tools, there is still a dearth of software that helps automate FCM gating analysis with a sound theoretical foundation [<xref ref-type="bibr" rid="B15">15</xref>].</p>
    <p>In view of these issues, based on a formal statistical clustering approach, we have developed the <bold>flowClust </bold>package (Additional file <xref ref-type="supplementary-material" rid="S1">1</xref>) to help resolve the current bottleneck. <bold>flowClust </bold>implements a robust model-based clustering approach [<xref ref-type="bibr" rid="B27">27</xref>-<xref ref-type="bibr" rid="B29">29</xref>] which extends the multivariate <italic>t </italic>mixture model with the Box-Cox transformation originally proposed in [<xref ref-type="bibr" rid="B30">30</xref>]. As a result of the extensions made, <bold>flowClust </bold>has included options allowing for a cluster-specific estimation of the Box-Cox transformation parameter and/or the degrees of freedom parameter; the Implementation section and the Results and Discussion section provide a detailed account of these extensions.</p>
  </sec>
  <sec>
    <title>Implementation</title>
    <sec>
      <title>The model</title>
      <p>In statistics, model-based clustering [<xref ref-type="bibr" rid="B28">28</xref>,<xref ref-type="bibr" rid="B29">29</xref>,<xref ref-type="bibr" rid="B31">31</xref>,<xref ref-type="bibr" rid="B32">32</xref>] is a popular unsupervised approach to look for homogeneous groups of observations. The most commonly used model-based clustering approach is based on finite Gaussian mixture models, which have been shown to give good results in various applied fields [<xref ref-type="bibr" rid="B28">28</xref>,<xref ref-type="bibr" rid="B29">29</xref>,<xref ref-type="bibr" rid="B33">33</xref>,<xref ref-type="bibr" rid="B34">34</xref>]. However, Gaussian mixture models might give poor representations of clusters in the presence of outliers, or when the clusters are far from elliptical in shape, phenomena commonly observed in FCM data. In view of this, we have proposed in [<xref ref-type="bibr" rid="B30">30</xref>] an approach based on <italic>t </italic>mixture models [<xref ref-type="bibr" rid="B27">27</xref>,<xref ref-type="bibr" rid="B28">28</xref>] with the Box-Cox transformation to handle these two issues simultaneously. Formally, given independent <italic>p</italic>-dimensional multivariate observations <bold>y</bold><sub>1</sub>, <bold>y</bold><sub>2</sub>,...,<bold>y</bold><sub><italic>n</italic></sub>, and denoting by <italic>Ψ </italic>the collection of all unknown parameters, the likelihood for a mixture model with <italic>G </italic>components is</p>
      <p>
        <disp-formula id="bmcM1">
          <label>(1)</label>
          <graphic xlink:href="1471-2105-10-145-i1.gif"/>
        </disp-formula>
      </p>
      <p>where <italic>w</italic><sub><italic>g </italic></sub>is the probability that an observation belongs to the <italic>g</italic>-th component, and <italic>φ</italic><sub><italic>p</italic></sub>(·|<bold><italic>μ</italic></bold><sub><italic>g</italic></sub>, <bold>Σ</bold><sub><italic>g</italic></sub>, <italic>ν</italic><sub><italic>g</italic></sub>) is the <italic>p</italic>-dimensional multivariate <italic>t </italic>density with mean <bold><italic>μ</italic></bold><sub><italic>g </italic></sub>(<italic>ν</italic><sub><italic>g </italic></sub>&gt; 1), covariance matrix <italic>ν</italic><sub><italic>g </italic></sub>(<italic>ν</italic><sub><italic>g </italic></sub>- 2)<sup>-1 </sup><bold>Σ</bold><sub><italic>g </italic></sub>(<italic>ν</italic><sub><italic>g </italic></sub>&gt; 2) and <italic>ν</italic><sub><italic>g </italic></sub>degrees of freedom. <inline-formula><inline-graphic xlink:href="1471-2105-10-145-i2.gif"/></inline-formula> is the value obtained upon transforming <bold>y</bold><sub><italic>i </italic></sub>with the Box-Cox parameter <italic>λ</italic><sub><italic>g</italic></sub>; the transformation used is a variant of the original Box-Cox transformation which is also defined for negative-valued data [<xref ref-type="bibr" rid="B35">35</xref>]. Finally, <inline-formula><inline-graphic xlink:href="1471-2105-10-145-i3.gif"/></inline-formula> is the Jacobian induced by the transformation. Please refer to [<xref ref-type="bibr" rid="B30">30</xref>] for a detailed account of an Expectation-Maximization (EM) algorithm [<xref ref-type="bibr" rid="B36">36</xref>] for the simultaneous estimation of all unknown parameters <bold>Ψ </bold>= (<bold>Ψ</bold><sub>1</sub>,...,<bold>Ψ</bold><sub><italic>G</italic></sub>) where <bold>Ψ</bold><sub><italic>g </italic></sub>= (<italic>w</italic><sub><italic>g</italic></sub>, <bold><italic>μ</italic></bold><sub><italic>g</italic></sub>, <bold>Σ</bold><sub><italic>g</italic></sub>, <italic>ν</italic><sub><italic>g</italic></sub>, <italic>λ</italic><sub><italic>g</italic></sub>).</p>
      <p>The EM algorithm needs to be initialized. By default, random partitioning is performed 10 times in parallel, and the one delivering the highest likelihood value after a few EM runs will be selected as the initial configuration for the eventual EM algorithm.</p>
      <p>Note that, in the model originally proposed in [<xref ref-type="bibr" rid="B30">30</xref>], the Box-Cox parameter <italic>λ </italic>is set common to all components of the mixture, and the degrees of freedom parameter <italic>ν </italic>is fixed at a predetermined common value. In the latest development of our software, we have generalized the model such that <italic>ν </italic>may also be estimated, and both <italic>λ </italic>and <italic>ν </italic>are allowed to be component-specific, as reflected in Equation (1).</p>
      <p>When the number of clusters is unknown, we use the Bayesian Information Criterion (BIC) [<xref ref-type="bibr" rid="B37">37</xref>], which gives good results in the context of mixture models [<xref ref-type="bibr" rid="B29">29</xref>,<xref ref-type="bibr" rid="B38">38</xref>].</p>
    </sec>
    <sec>
      <title>The package</title>
      <p>With the aforementioned theoretical basis, we have developed <bold>flowClust</bold>, an <bold>R </bold>package to conduct an automated FCM gating analysis and produce visualizations for the results. Its source code is written in C for optimal utilization of system resources and makes use of the Basic Linear Algebra Subprograms (BLAS) library, which facilitates multithreaded processes when an optimized library is provided.</p>
      <p><bold>flowClust </bold>is released through Bioconductor [<xref ref-type="bibr" rid="B24">24</xref>], along with those <bold>R </bold>packages mentioned in the Background section. The GNU Scientific Library (GSL) is needed for successful installation of <bold>flowClust</bold>. Please refer to the vignette that comes with <bold>flowClust </bold>for details about installation; Windows users may also consult the README file included in the package for procedures of linking GSL to <bold>R</bold>.</p>
      <p>The package adopts a formal object-oriented programming discipline, making use of the S4 system [<xref ref-type="bibr" rid="B39">39</xref>] to define classes and methods. The core function, <monospace>flowClust</monospace>, implements the clustering methodology and returns an object of class <monospace>flowClust</monospace>. A <monospace>flowClust</monospace> object stores essential information related to the clustering result which can be retrieved through various methods such as <monospace>summary, Map, getEstimates</monospace>, etc. To visualize the clustering results, the <monospace>plot</monospace> and <monospace>hist</monospace> methods can be applied to produce scatterplots, contour/image plots and histograms.</p>
      <p>To enhance communications with other Bioconductor packages designed for the cytometry community, <bold>flowClust </bold>has been built with the aim of being highly integrated with <bold>flowCore</bold>. Methods in <bold>flowClust </bold>can be directly applied on a <monospace>flowFrame</monospace>, the standard <bold>R </bold>implementation of a Flow Cytometry Standard (FCS) file defined in <bold>flowCore</bold>; FCS is the typical storage mode for FCM data. Another step towards integration is to overload basic filtering methods defined in <bold>flowCore </bold>(e.g., <monospace>filter, %in%, Subset</monospace> and <monospace>split</monospace>) in order to provide similar functionality for classes defined in <bold>flowClust</bold>.</p>
    </sec>
  </sec>
  <sec>
    <title>Results and discussion</title>
    <sec>
      <title>Analysis of real FCM data</title>
      <p>In this section, we illustrate how to use <bold>flowClust </bold>to conduct an automated gating analysis of real FCM data. For demonstration, we use the graft-versus-host disease (GvHD) data (Additional file <xref ref-type="supplementary-material" rid="S2">2</xref>) [<xref ref-type="bibr" rid="B40">40</xref>]. The data are stored in FCS files, and consist of measurements of four fluorescently conjugated antibodies, namely, anti-CD4, anti-CD8<italic>β</italic>, anti-CD3 and anti-CD8, in addition to the forward scatter and sideward scatter parameters. One objective of the gating analysis is to look for the CD3<sup>+</sup>CD4<sup>+</sup>CD8<italic>β</italic><sup>+ </sup>cell population, a distinctive feature found in GvHD-positive samples. We have adopted a two-stage strategy [<xref ref-type="bibr" rid="B30">30</xref>]: we first cluster the data by using the two scatter parameters to identify basic cell populations, and then perform clustering on the population of interest using all fluorescence parameters.</p>
      <p>At the initial stage, we extract the lymphocyte population using the forward scatter (<monospace>FSC-H</monospace>) and sideward scatter (<monospace>SSC-H</monospace>) parameters:</p>
      <p>GvHD &lt;- read.FCS("B07", trans = FALSE)</p>
      <p>res1 &lt;- flowClust(GvHD, varNames = c("FSC-H", "SSC-H"), K = 1:8)</p>
      <p>To estimate the number of clusters, we run <monospace>flowClust</monospace> on the data repetitively with <monospace>K = 1</monospace> up to <monospace>K = 8</monospace> clusters in turn, and apply the BIC to guide the choice. Values of the BIC can be retrieved through the <monospace>criterion</monospace> method. Figure <xref ref-type="fig" rid="F1">1</xref> shows that the BIC curve remains relatively flat beyond four clusters. We therefore choose the model with four clusters. Below is a summary of the corresponding clustering result.</p>
      <fig position="float" id="F1">
        <label>Figure 1</label>
        <caption>
          <p><bold>A plot of BIC against the number of clusters for the first-stage cluster analysis</bold>. The BIC curve remains relatively flat beyond four clusters, suggesting that the model fit using four clusters is appropriate.</p>
        </caption>
        <graphic xlink:href="1471-2105-10-145-1"/>
      </fig>
      <p>** Experiment Information **</p>
      <p>Experiment name: Flow Experiment</p>
      <p>Variables used: FSC-H SSC-H</p>
      <p>** Clustering Summary **</p>
      <p>Number of clusters: 4</p>
      <p>Proportions: 0.1779686 0.1622115 0.3882043 0.2716157</p>
      <p>** Transformation Parameter **</p>
      <p>lambda: 0.1126388</p>
      <p>** Information Criteria **</p>
      <p>Log likelihood: -146769.5</p>
      <p>BIC: -293765.9</p>
      <p>ICL: -300546.2</p>
      <p>** Data Quality **</p>
      <p>Number of points filtered from above: 168 (1.31%)</p>
      <p>Number of points filtered from below: 0 (0%)</p>
      <p>Rule of identifying outliers: 90% quantile</p>
      <p>Number of outliers: 506 (3.93%)</p>
      <p>Uncertainty summary:</p>
      <p>Min.       1st Qu.   Median    Mean      3rd Qu.   Max.      NA's</p>
      <p>9.941e-04 1.211e-02 3.512e-02 8.787e-02 1.070e-01 6.531e-01 1.680e+02</p>
      <p>The estimate of the Box-Cox parameter <italic>λ </italic>is 0.11, implying a transformation close to a logarithmic one (<italic>λ </italic>= 0).</p>
      <p>Note that, by default, <monospace>flowClust</monospace> selects the same transformation for all clusters. We have also enabled the option of estimating the Box-Cox parameter <italic>λ </italic>for each cluster. For instance, if a user finds the shapes of the clusters significantly deviate from one another and opts for a different transformation for each cluster, he may write the following line of code:</p>
      <p>flowClust(GvHD, varNames = c("FSC-H", "SSC-H"), K = 4, trans = 2)</p>
      <p>The <monospace>trans</monospace> argument acts as a switch to govern how <italic>λ </italic>is handled: fixed at a predetermined value (<monospace>trans = 0</monospace>), estimated and set common to all clusters (<monospace>trans = 1</monospace>), or estimated for each cluster (<monospace>trans = 2</monospace>). Incidentally, the option of estimating the degrees of freedom parameter <italic>ν </italic>has also been made available, either common to all clusters or specific to each of them. The nu.est argument is the corresponding switch and takes a similar interpretation to <monospace>trans</monospace>. Such an option of estimating <italic>ν </italic>further fine-tunes the model-fitting process such that the fitted model can reflect the data-specific level of abundance of outliers. To compare the models adopting a different combination of these options, one may make use of the BIC again. See Additional file <xref ref-type="supplementary-material" rid="S3">3</xref> for a graph with two BIC curves corresponding to the default setting (common <italic>λ</italic>) and the setting with cluster-specific <italic>λ</italic>, respectively. Little difference in the BIC values between the two settings can be observed. In accordance with the principle of parsimony in Statistics which favors a simpler model, we opt for the default setting here.</p>
      <p>Graphical functionalities are available to users for visualizing a wealth of features of the clustering results, including the cluster assignment, outliers, and the size and shape of the clusters. Figure <xref ref-type="fig" rid="F2">2</xref> is a scatterplot showing the cluster assignment of points upon the removal of outliers. Outliers are shown in grey with the + symbols. The black solid lines represent the 90% quantile region of the clusters which defines the cluster boundaries. The summary shown above states that the default rule used to identify outliers is <monospace>90% quantile</monospace>, which means that a point outside the 90% quantile region of the cluster to which it is assigned will be called an outlier. In most applications, the default rule should be appropriate for identifying outliers. In case a user wants finer control and would like to specify a different rule, he may apply the <monospace>ruleOutliers</monospace> replacement method:</p>
      <fig position="float" id="F2">
        <label>Figure 2</label>
        <caption>
          <p><bold>A scatterplot revealing the cluster assignment in the first-stage analysis</bold>. Clusters 1, 3 and 4 correspond to the lymphocyte population, while cluster 2 is referred to as the dead cell population. The black solid lines represent the 90% quantile region of the clusters which define the cluster boundaries. Points outside the boundary of the cluster to which they are assigned are called outliers and marked with "+".</p>
        </caption>
        <graphic xlink:href="1471-2105-10-145-2"/>
      </fig>
      <p>ruleOutliers(res1[[4]]) &lt;- list(level = 0.95)</p>
      <p>See Additional file <xref ref-type="supplementary-material" rid="S4">4</xref> for the corresponding summary. As shown in the summary, this rule is more stringent than the <monospace>90% quantile</monospace> rule: 133 points (1.03%) are now called outliers, as opposed to 506 points (3.93%) in the default rule.</p>
      <p>Clusters 1, 3 and 4 in Figure <xref ref-type="fig" rid="F2">2</xref> correspond to the lymphocyte population defined with a manual gating strategy adopted in [<xref ref-type="bibr" rid="B40">40</xref>]. We then extract these three clusters to proceed with the second-stage analysis:</p>
      <p>GvHD2 &lt;- split(GvHD, res1[[4]], population = list(lymphocyte = c(1,3,4), deadcells = 2))</p>
      <p>The subsetting method <monospace>split</monospace> allows us to split the data into several <monospace>flowFrames</monospace> representing the different cell populations. To extract the lymphocyte population (clusters 1, 3 and 4), we may type <monospace>GvHD2$lymphocyte</monospace> or <monospace>GvHD2[[1]]</monospace>, which is a <monospace>flowFrame</monospace>. By default, <monospace>split</monospace> removes outliers upon extraction. The <monospace>deadcells = 2</monospace> list element is included above for demonstration purpose; it is needed only if we want to extract the dead cell population (cluster 2), too.</p>
      <p>In the second-stage analysis, in order to fully utilize the multidimensionality of FCM data we cluster the lymphocyte population using all the four fluorescence parameters, namely, anti-CD4 (<monospace>FL1-H</monospace>), anti-CD8<italic>β </italic>(<monospace>FL2-H</monospace>), anti-CD3 (<monospace>FL3-H</monospace>) and anti-CD8 (<monospace>FL4-H</monospace>), at once:</p>
      <p>res2 &lt;- flowClust(GvHD2$lymphocyte, varNames = c("FL1-H", "FL2-H", "FL3-H", "FL4-H"), K = 1:15)</p>
      <p>The BIC curve remains relatively flat beyond 11 clusters (Figure <xref ref-type="fig" rid="F3">3</xref>), suggesting that the model with 11 clusters provides a good fit. Figure <xref ref-type="fig" rid="F4">4</xref> shows a contour plot superimposed on a scatterplot of CD8<italic>β </italic>against CD4 for the sub-population of CD3-stained cells, which were selected based on a threshold obtained from a negative control sample [<xref ref-type="bibr" rid="B40">40</xref>]. We can easily identify from it the red and purple clusters at the upper right as the CD3<sup>+</sup>CD4<sup>+</sup>CD8<italic>β</italic><sup>+ </sup>cell population. A corresponding image plot is given by Figure <xref ref-type="fig" rid="F5">5</xref>. Also, see Additional file <xref ref-type="supplementary-material" rid="S5">5</xref> for the code used to produce all the plots shown in this article.</p>
      <fig position="float" id="F3">
        <label>Figure 3</label>
        <caption>
          <p><bold>A plot of BIC against the number of clusters for the second-stage cluster analysis</bold>. The BIC curve remains relatively flat beyond 11 clusters, suggesting that the model fit using 11 clusters is appropriate.</p>
        </caption>
        <graphic xlink:href="1471-2105-10-145-3"/>
      </fig>
      <fig position="float" id="F4">
        <label>Figure 4</label>
        <caption>
          <p><bold>A contour plot superimposed on a scatterplot of CD8<italic>β </italic>against CD4 for the CD3<sup>+ </sup>population</bold>. The red and purple clusters at the upper right correspond to the CD3<sup>+</sup>CD4<sup>+</sup>CD8<italic>β</italic><sup>+ </sup>cell population, indicative of the GvHD.</p>
        </caption>
        <graphic xlink:href="1471-2105-10-145-4"/>
      </fig>
      <fig position="float" id="F5">
        <label>Figure 5</label>
        <caption>
          <p><bold>An image plot of CD8<italic>β </italic>against CD4 for the CD3<sup>+ </sup>population</bold>. The five clusters corresponding to the CD3<sup>+ </sup>population shown in Figure 5 can also be identified clearly on this image plot.</p>
        </caption>
        <graphic xlink:href="1471-2105-10-145-5"/>
      </fig>
      <p>The example above shows how an FCM analysis is conducted with the aid of <bold>flowClust</bold>. When the number of cell populations is not known in advance, and the BIC values are relatively close over a range of the possible number of clusters, the researcher may be presented with a set of possible solutions instead of a clear-cut single one. In such a case, the level of automation may be undermined as the researcher may need to select the best one based on his expertise. We acknowledge that more effort is needed to extend our proposed methodology towards a higher level of automation. Currently, we are working on an approach which successively merges the clusters in the solution as suggested by the BIC using some entropy criterion to give a more reasonable estimate of the number of clusters.</p>
    </sec>
    <sec>
      <title>Integration with flowCore</title>
      <p>As introduced in the Background section, <bold>flowClust </bold>has been built in a way such that it is highly integrated with the <bold>flowCore </bold>package. The core function <monospace>flowClust</monospace> which performs the clustering operation may be replaced by a call to the constructor <monospace>tmixFilter</monospace> creating a <monospace>filter</monospace>  object similar to the ones used in other gating or filtering operations found in <bold>flowCore </bold>(e.g., <monospace>rectangleGate, norm2Filter, kmeansFilter</monospace>). As an example, the code</p>
      <p>res1 &lt;- flowClust(GvHD, varNames = c("FSC-H", "SSC-H"), K = 1:8)</p>
      <p>used in the first-stage analysis of the GvHD data may be replaced by:</p>
      <p>s1filter &lt;- tmixFilter("lymphocyte", c("FSC-H", "SSC-H"), K = 1:8)</p>
      <p>res1f &lt;- filter(GvHD, s1filter)</p>
      <p>The use of a dedicated <monospace>tmixFilter</monospace>-class object separates the task of specifying the settings (<monospace>tmixFilter</monospace>) from the actual filtering operation (<monospace>filter</monospace>), facilitating the common scenario in FCM gating analysis that filtering with the same settings is performed upon a large number of data files. The <monospace>filter</monospace> method returns a list object <monospace>res1f</monospace> with elements each of class <monospace>tmixFilterResult</monospace>, which directly extends the <monospace>filterResult</monospace> class defined in <bold>flowCore</bold>. Users may apply various subsetting operations defined for the <monospace>filterResult</monospace> class in a similar fashion on a <monospace>tmixFilterResult</monospace> object. For instance,</p>
      <p>Subset(GvHD [, c("FSC-H", "SSC-H")], res1f[[4]])</p>
      <p>outputs a <monospace>flowFrame</monospace> that is the subset of the GvHD data upon the removal of outliers, consisting of the two selected parameters, <monospace>FSC-H</monospace> and <monospace>SSC-H</monospace>, only. Another example is given by the <monospace>split</monospace> method introduced earlier in this section.</p>
      <p>We realize that occasionally a researcher may opt to combine the use of <bold>flowClust </bold>with filtering operations in <bold>flowCore </bold>to define the whole sequence of an FCM gating analysis. To enable the exchange of results between the two packages, filters created by <monospace>tmixFilter</monospace> may be treated like those from <bold>flowCore</bold>; users of <bold>flowCore </bold>will find that filter operators, namely, <monospace>&amp;</monospace>, <monospace>|</monospace>, <monospace>!</monospace> and <monospace>%subset%</monospace>, also work in the <bold>flowClust </bold>package. For instance, suppose the researcher is interested in clustering the CD3<sup>+ </sup>cell population which he defines by constructing an interval gate with the lower end-point at 270 on the CD3 parameter. He may use the following code to perform the analysis:</p>
      <p>rectGate &lt;- rectangleGate(filterId="CD3+", "FL3-H" =c(270, Inf))</p>
      <p>s2filter &lt;- tmixFilter("s2filter", c("FL1-H", "FL2-H", "FL3-H", "FL4-H"), K = 5)</p>
      <p>res2f &lt;- filter(GvHD2$lymphocyte, s2filter %subset% rectGate)</p>
      <p>The constructors <monospace>rectangleGate</monospace> and <monospace>tmixFilter</monospace> create two <monospace>filter</monospace> objects storing the settings of the interval gate and <monospace>flowClust</monospace>, respectively. When the last line of code is run, the interval gate will first be applied to the GvHD data. <monospace>flowClust</monospace> is then performed on a subset of the GvHD data contained by the interval gate.</p>
    </sec>
  </sec>
  <sec>
    <title>Conclusion</title>
    <p><bold>flowClust </bold>is an <bold>R </bold>package dedicated to FCM gating analysis, addressing the increasing demand for software capable of processing and analyzing the voluminous amount of FCM data efficiently via an objective, reproducible and automated means. The package implements a statistical clustering approach using multivariate <italic>t </italic>mixture models with the Box-Cox transformation [<xref ref-type="bibr" rid="B30">30</xref>], and provides tools to summarize and visualize results of the analysis. The statistical model underlying <bold>flowClust </bold>extends the one originally proposed in [<xref ref-type="bibr" rid="B30">30</xref>]. The extensions have included modeling options allowing for a cluster-specific estimation of the Box-Cox parameter <italic>λ </italic>and the degrees of freedom parameter <italic>ν</italic>. The package contributes to the cytometry community by offering an efficient, automated analysis platform which facilitates the active, ongoing technological advancement.</p>
  </sec>
  <sec>
    <title>Availability and requirements</title>
    <p>Project name: flowClust</p>
    <p>Project homepage: <ext-link ext-link-type="uri" xlink:href="http://bioconductor.org"/></p>
    <p>Operating systems: Platform independent</p>
    <p>Programming language: C, R</p>
    <p>Other requirements: GSL, R, Bioconductor</p>
    <p>License: Artistic 2.0</p>
    <p>Any restrictions to use by non-academics: <bold>flowClust </bold>depends on the <bold>mclust </bold>software, the use of which needs to abide by the terms stated in <ext-link ext-link-type="uri" xlink:href="http://www.stat.washington.edu/mclust/license.txt"/>.</p>
  </sec>
  <sec>
    <title>Authors' contributions</title>
    <p>KL and RG developed the methodology and software, and performed the analyses. FH participated in the development of the software. RRB and RG conceived of the study, and participated in its design and coordination. FH, RRB and RG helped KL draft the manuscript. All authors read and approved the final manuscript.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material content-type="local-data" id="S1">
      <caption>
        <title>Additional file 1</title>
        <p><bold>A copy of the flowClust package</bold>. The zip file contains the source code of the <bold>flowClust </bold>package (version 2.2.0) as a gzipped tarball for direct installation into R from a command-line interface. This current release is also available from Bioconductor at <ext-link ext-link-type="uri" xlink:href="http://bioconductor.org/packages/2.4/bioc/html/flowClust.html"/>.</p>
      </caption>
      <media xlink:href="1471-2105-10-145-S1.zip" mimetype="application" mime-subtype="x-zip-compressed">
        <caption>
          <p>Click here for file</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="S2">
      <caption>
        <title>Additional file 2</title>
        <p><bold>A copy of the GvHD data file used in this article</bold>. The zip file contains the data file in FCS format used in the GvHD analysis. Interested readers may go to <ext-link ext-link-type="uri" xlink:href="http://www.ficcs.org/software.html#Data_Files"/> for a complete set of data files for the GvHD study [<xref ref-type="bibr" rid="B40">40</xref>].</p>
      </caption>
      <media xlink:href="1471-2105-10-145-S2.zip" mimetype="application" mime-subtype="x-zip-compressed">
        <caption>
          <p>Click here for file</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="S3">
      <caption>
        <title>Additional file 3</title>
        <p><bold>A graph with two BIC curves corresponding to the settings with a common λ and cluster-specific λ respectively for the first-stage cluster analysis</bold>. Little difference in the BIC values between the two settings is observed. In accordance with the principle of parsimony which favors a simpler model, we opt for the default setting here.</p>
      </caption>
      <media xlink:href="1471-2105-10-145-S3.pdf" mimetype="application" mime-subtype="pdf">
        <caption>
          <p>Click here for file</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="S4">
      <caption>
        <title>Additional file 4</title>
        <p><bold>Result summary of the first-stage analysis with four clusters of the GvHD data</bold>. The rule used to identify outliers is <monospace>95% quantile</monospace>. 133 points (1.03%) are called outliers.</p>
      </caption>
      <media xlink:href="1471-2105-10-145-S4.txt" mimetype="text" mime-subtype="plain">
        <caption>
          <p>Click here for file</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="S5">
      <caption>
        <title>Additional file 5</title>
        <p><bold>Code to produce the plots in this article</bold>. R code to produce the plots in the GvHD analysis.</p>
      </caption>
      <media xlink:href="1471-2105-10-145-S5.r" mimetype="text" mime-subtype="plain">
        <caption>
          <p>Click here for file</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <ack>
    <sec>
      <title>Acknowledgements</title>
      <p>The authors thank Martin Morgan, Patrick Aboyoun and Marc Carlson for their advice on the technical issues of building the <bold>flowClust </bold>package, and the two reviewers for suggestions that improved an earlier draft of the article. This work was supported by the NIH grants EB005034 and EB008400, and by the Michael Smith Foundation for Health Research.</p>
    </sec>
  </ack>
  <ref-list>
    <ref id="B1">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Braylan</surname>
            <given-names>RC</given-names>
          </name>
        </person-group>
        <article-title>Impact of flow cytometry on the diagnosis and characterization of lymphomas, chronic lymphoproliferative disorders and plasma cell neoplasias</article-title>
        <source>Cytometry A</source>
        <year>2004</year>
        <volume>58A</volume>
        <fpage>57</fpage>
        <lpage>61</lpage>
        <pub-id pub-id-type="pmid">14994222</pub-id>
        <pub-id pub-id-type="doi">10.1002/cyto.a.10101</pub-id>
      </citation>
    </ref>
    <ref id="B2">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hengel</surname>
            <given-names>RL</given-names>
          </name>
          <name>
            <surname>Nicholson</surname>
            <given-names>JK</given-names>
          </name>
        </person-group>
        <article-title>An update on the use of flow cytometry in HIV infection and AIDS</article-title>
        <source>Clin Lab Med</source>
        <year>2001</year>
        <volume>21</volume>
        <fpage>841</fpage>
        <lpage>856</lpage>
        <pub-id pub-id-type="pmid">11770291</pub-id>
      </citation>
    </ref>
    <ref id="B3">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Illoh</surname>
            <given-names>OC</given-names>
          </name>
        </person-group>
        <article-title>Current applications of flow cytometry in the diagnosis of primary immunodeficiency diseases</article-title>
        <source>Arch Pathol Lab Med</source>
        <year>2004</year>
        <volume>128</volume>
        <fpage>23</fpage>
        <lpage>31</lpage>
        <pub-id pub-id-type="pmid">14692816</pub-id>
      </citation>
    </ref>
    <ref id="B4">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kiechle</surname>
            <given-names>FL</given-names>
          </name>
          <name>
            <surname>Holland-Staley</surname>
            <given-names>CA</given-names>
          </name>
        </person-group>
        <article-title>Genomics, transcriptomics, proteomics, and numbers</article-title>
        <source>Arch Pathol Lab Med</source>
        <year>2003</year>
        <volume>127</volume>
        <fpage>1089</fpage>
        <lpage>1097</lpage>
        <pub-id pub-id-type="pmid">12946210</pub-id>
      </citation>
    </ref>
    <ref id="B5">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Mandy</surname>
            <given-names>FF</given-names>
          </name>
        </person-group>
        <article-title>Twenty-five years of clinical flow cytometry: AIDS accelerated global instrument distribution</article-title>
        <source>Cytometry A</source>
        <year>2004</year>
        <volume>58A</volume>
        <fpage>55</fpage>
        <lpage>56</lpage>
        <pub-id pub-id-type="pmid">14994221</pub-id>
        <pub-id pub-id-type="doi">10.1002/cyto.a.10102</pub-id>
      </citation>
    </ref>
    <ref id="B6">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Orfao</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Ortuno</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>de Santiago</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Lopez</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>San Miguel</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>Immunophenotyping of acute leukemias and myelodysplastic syndromes</article-title>
        <source>Cytometry A</source>
        <year>2004</year>
        <volume>58A</volume>
        <fpage>62</fpage>
        <lpage>71</lpage>
        <pub-id pub-id-type="pmid">14994223</pub-id>
        <pub-id pub-id-type="doi">10.1002/cyto.a.10104</pub-id>
      </citation>
    </ref>
    <ref id="B7">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bagwell</surname>
            <given-names>CB</given-names>
          </name>
        </person-group>
        <article-title>DNA histogram analysis for node-negative breast cancer</article-title>
        <source>Cytometry A</source>
        <year>2004</year>
        <volume>58A</volume>
        <fpage>76</fpage>
        <lpage>78</lpage>
        <pub-id pub-id-type="pmid">14994225</pub-id>
        <pub-id pub-id-type="doi">10.1002/cyto.a.90004</pub-id>
      </citation>
    </ref>
    <ref id="B8">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Keeney</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Gratama</surname>
            <given-names>JW</given-names>
          </name>
          <name>
            <surname>Sutherland</surname>
            <given-names>DR</given-names>
          </name>
        </person-group>
        <article-title>Critical role of flow cytometry in evaluating peripheral blood hematopoietic stem cell grafts</article-title>
        <source>Cytometry A</source>
        <year>2004</year>
        <volume>58A</volume>
        <fpage>72</fpage>
        <lpage>75</lpage>
        <pub-id pub-id-type="pmid">14994224</pub-id>
        <pub-id pub-id-type="doi">10.1002/cyto.a.10103</pub-id>
      </citation>
    </ref>
    <ref id="B9">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Krutzik</surname>
            <given-names>PO</given-names>
          </name>
          <name>
            <surname>Irish</surname>
            <given-names>JM</given-names>
          </name>
          <name>
            <surname>Nolan</surname>
            <given-names>GP</given-names>
          </name>
          <name>
            <surname>Perez</surname>
            <given-names>OD</given-names>
          </name>
        </person-group>
        <article-title>Analysis of protein phosphorylation and cellular signaling events by flow cytometry: techniques and clinical applications</article-title>
        <source>Clin Immunol</source>
        <year>2004</year>
        <volume>110</volume>
        <fpage>206</fpage>
        <lpage>221</lpage>
        <pub-id pub-id-type="pmid">15047199</pub-id>
        <pub-id pub-id-type="doi">10.1016/j.clim.2003.11.009</pub-id>
      </citation>
    </ref>
    <ref id="B10">
      <citation citation-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Maecker</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Maino</surname>
            <given-names>V</given-names>
          </name>
        </person-group>
        <source>Flow cytometric analysis of cytokines</source>
        <year>2002</year>
        <edition>6</edition>
        <publisher-name>Washington, DC: ASM Press. Manual of Clinical Laboratory Immunology</publisher-name>
      </citation>
    </ref>
    <ref id="B11">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Pozarowski</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Darzynkiewicz</surname>
            <given-names>Z</given-names>
          </name>
        </person-group>
        <article-title>Analysis of cell cycle by flow cytometry</article-title>
        <source>Methods Mol Biol</source>
        <year>2004</year>
        <volume>281</volume>
        <fpage>301</fpage>
        <lpage>312</lpage>
        <pub-id pub-id-type="pmid">15220539</pub-id>
      </citation>
    </ref>
    <ref id="B12">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Pala</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Hussell</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Openshaw</surname>
            <given-names>PJ</given-names>
          </name>
        </person-group>
        <article-title>Flow cytometric measurement of intracellular cytokines</article-title>
        <source>J Immunol Methods</source>
        <year>2000</year>
        <volume>243</volume>
        <fpage>107</fpage>
        <lpage>124</lpage>
        <pub-id pub-id-type="pmid">10986410</pub-id>
        <pub-id pub-id-type="doi">10.1016/S0022-1759(00)00230-1</pub-id>
      </citation>
    </ref>
    <ref id="B13">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Vermes</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Haanen</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Reutelingsperger</surname>
            <given-names>C</given-names>
          </name>
        </person-group>
        <article-title>Flow cytometry of apoptotic cell death</article-title>
        <source>J Immunol Methods</source>
        <year>2000</year>
        <volume>243</volume>
        <fpage>167</fpage>
        <lpage>190</lpage>
        <pub-id pub-id-type="pmid">10986414</pub-id>
        <pub-id pub-id-type="doi">10.1016/S0022-1759(00)00233-7</pub-id>
      </citation>
    </ref>
    <ref id="B14">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lehmann</surname>
            <given-names>AK</given-names>
          </name>
          <name>
            <surname>Sornes</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Halstensen</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>Phagocytosis: measurement by flow cytometry</article-title>
        <source>J Immunol Methods</source>
        <year>2000</year>
        <volume>243</volume>
        <fpage>229</fpage>
        <lpage>242</lpage>
        <pub-id pub-id-type="pmid">10986417</pub-id>
        <pub-id pub-id-type="doi">10.1016/S0022-1759(00)00237-4</pub-id>
      </citation>
    </ref>
    <ref id="B15">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lizard</surname>
            <given-names>G</given-names>
          </name>
        </person-group>
        <article-title>Flow cytometry analyses and bioinformatics: Interest in new softwares to optimize novel technologies and to favor the emergence of innovative concepts in cell research</article-title>
        <source>Cytometry A</source>
        <year>2007</year>
        <volume>71A</volume>
        <fpage>646</fpage>
        <lpage>647</lpage>
        <pub-id pub-id-type="pmid">17680704</pub-id>
        <pub-id pub-id-type="doi">10.1002/cyto.a.20444</pub-id>
      </citation>
    </ref>
    <ref id="B16">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>de Rosa</surname>
            <given-names>SC</given-names>
          </name>
          <name>
            <surname>Brenchley</surname>
            <given-names>JM</given-names>
          </name>
          <name>
            <surname>Roederer</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>Beyond six colors: a new era in flow cytometry</article-title>
        <source>Nat Med</source>
        <year>2003</year>
        <volume>9</volume>
        <fpage>112</fpage>
        <lpage>117</lpage>
        <pub-id pub-id-type="pmid">12514723</pub-id>
        <pub-id pub-id-type="doi">10.1038/nm0103-112</pub-id>
      </citation>
    </ref>
    <ref id="B17">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Redelman</surname>
            <given-names>D</given-names>
          </name>
        </person-group>
        <article-title>CytometryML</article-title>
        <source>Cytometry A</source>
        <year>2004</year>
        <volume>62A</volume>
        <fpage>70</fpage>
        <lpage>73</lpage>
        <pub-id pub-id-type="pmid">15455412</pub-id>
        <pub-id pub-id-type="doi">10.1002/cyto.a.10093</pub-id>
      </citation>
    </ref>
    <ref id="B18">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Roederer</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Treister</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Moore</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Herzenberg</surname>
            <given-names>LA</given-names>
          </name>
        </person-group>
        <article-title>Probability binning comparison: a metric for quantitating univariate distribution differences</article-title>
        <source>Cytometry</source>
        <year>2001</year>
        <volume>45</volume>
        <fpage>37</fpage>
        <lpage>46</lpage>
        <pub-id pub-id-type="pmid">11598945</pub-id>
        <pub-id pub-id-type="doi">10.1002/1097-0320(20010901)45:1&lt;37::AID-CYTO1142&gt;3.0.CO;2-E</pub-id>
      </citation>
    </ref>
    <ref id="B19">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Roederer</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Moore</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Treister</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Hardy</surname>
            <given-names>RR</given-names>
          </name>
          <name>
            <surname>Herzenberg</surname>
            <given-names>LA</given-names>
          </name>
        </person-group>
        <article-title>Probability binning comparison: a metric for quantitating multivariate distribution differences</article-title>
        <source>Cytometry</source>
        <year>2001</year>
        <volume>45</volume>
        <fpage>47</fpage>
        <lpage>55</lpage>
        <pub-id pub-id-type="pmid">11598946</pub-id>
        <pub-id pub-id-type="doi">10.1002/1097-0320(20010901)45:1&lt;47::AID-CYTO1143&gt;3.0.CO;2-A</pub-id>
      </citation>
    </ref>
    <ref id="B20">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Tzircotis</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Thorne</surname>
            <given-names>RF</given-names>
          </name>
          <name>
            <surname>Isacke</surname>
            <given-names>CM</given-names>
          </name>
        </person-group>
        <article-title>A new spreadsheet method for the analysis of bivariate flow cytometric data</article-title>
        <source>BMC Cell Biol</source>
        <year>2004</year>
        <volume>5</volume>
        <fpage>10</fpage>
        <pub-id pub-id-type="pmid">15035676</pub-id>
        <pub-id pub-id-type="doi">10.1186/1471-2121-5-10</pub-id>
      </citation>
    </ref>
    <ref id="B21">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Spidlen</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Gentleman</surname>
            <given-names>RC</given-names>
          </name>
          <name>
            <surname>Haaland</surname>
            <given-names>PD</given-names>
          </name>
          <name>
            <surname>Langille</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Le Meur</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Ochs</surname>
            <given-names>MF</given-names>
          </name>
          <name>
            <surname>Schmitt</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Smith</surname>
            <given-names>CA</given-names>
          </name>
          <name>
            <surname>Treister</surname>
            <given-names>AS</given-names>
          </name>
          <name>
            <surname>Brinkman</surname>
            <given-names>RR</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Data standards for flow cytometry</article-title>
        <source>OMICS</source>
        <year>2006</year>
        <volume>10</volume>
        <fpage>209</fpage>
        <lpage>214</lpage>
        <pub-id pub-id-type="pmid">16901228</pub-id>
        <pub-id pub-id-type="doi">10.1089/omi.2006.10.209</pub-id>
      </citation>
    </ref>
    <ref id="B22">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Suni</surname>
            <given-names>MA</given-names>
          </name>
          <name>
            <surname>Dunn</surname>
            <given-names>HS</given-names>
          </name>
          <name>
            <surname>Orr</surname>
            <given-names>PL</given-names>
          </name>
          <name>
            <surname>de Laat</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Sinclair</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Ghanekar</surname>
            <given-names>SA</given-names>
          </name>
          <name>
            <surname>Bredt</surname>
            <given-names>BM</given-names>
          </name>
          <name>
            <surname>Dunne</surname>
            <given-names>JF</given-names>
          </name>
          <name>
            <surname>Maino</surname>
            <given-names>VC</given-names>
          </name>
          <name>
            <surname>Maecker</surname>
            <given-names>HT</given-names>
          </name>
        </person-group>
        <article-title>Performance of plate-based cytokine flow cytometry with automated data analysis</article-title>
        <source>BMC Immunol</source>
        <year>2003</year>
        <volume>4</volume>
        <fpage>9</fpage>
        <pub-id pub-id-type="pmid">12952557</pub-id>
        <pub-id pub-id-type="doi">10.1186/1471-2172-4-9</pub-id>
      </citation>
    </ref>
    <ref id="B23">
      <citation citation-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Parks</surname>
            <given-names>DR</given-names>
          </name>
        </person-group>
        <article-title>Data processing and analysis: Data management</article-title>
        <source>Current Protocols in Cytometry</source>
        <year>1997</year>
        <volume>chap. 10</volume>
        <publisher-name>New York: John Wiley &amp; Sons, Inc.</publisher-name>
        <fpage>10.1.1</fpage>
        <lpage>10.1.6</lpage>
      </citation>
    </ref>
    <ref id="B24">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Gentleman</surname>
            <given-names>RC</given-names>
          </name>
          <name>
            <surname>Carey</surname>
            <given-names>VJ</given-names>
          </name>
          <name>
            <surname>Bates</surname>
            <given-names>DM</given-names>
          </name>
          <name>
            <surname>Bolstad</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Dettling</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Dudoit</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Ellis</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Gautier</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Ge</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Gentry</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Hornik</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Hothorn</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Huber</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Iacus</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Irizarry</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Leisch</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Maechler</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Rossini</surname>
            <given-names>AJ</given-names>
          </name>
          <name>
            <surname>Sawitzki</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Smith</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Smyth</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Tierney</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Yang</surname>
            <given-names>JYH</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>Bioconductor: Open software development for computational biology and bioinformatics</article-title>
        <source>Genome Biol</source>
        <year>2004</year>
        <volume>5</volume>
        <fpage>R80</fpage>
        <pub-id pub-id-type="pmid">15461798</pub-id>
        <pub-id pub-id-type="doi">10.1186/gb-2004-5-10-r80</pub-id>
      </citation>
    </ref>
    <ref id="B25">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hahne</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Le Meur</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Brinkman</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Ellis</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Haaland</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Sarkar</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Spidlen</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Strain</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Gentleman</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>flowCore: A Bioconductor software package for high throughput flow cytometry data analysis</article-title>
        <source>BMC Bioinformatics</source>
        <year>2008</year>
        <volume>10</volume>
        <fpage>106</fpage>
        <pub-id pub-id-type="pmid">19358741</pub-id>
        <pub-id pub-id-type="doi">10.1186/1471-2105-10-106</pub-id>
      </citation>
    </ref>
    <ref id="B26">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Sarkar</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Le Meur</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Gentleman</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>Using flowViz to visualize flow cytometry data</article-title>
        <source>Bioinformatics</source>
        <year>2008</year>
        <volume>24</volume>
        <fpage>878</fpage>
        <lpage>879</lpage>
        <pub-id pub-id-type="pmid">18245128</pub-id>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btn021</pub-id>
      </citation>
    </ref>
    <ref id="B27">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Peel</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>McLachlan</surname>
            <given-names>GJ</given-names>
          </name>
        </person-group>
        <article-title>Robust mixture modelling using the t distribution</article-title>
        <source>Stat Comput</source>
        <year>2000</year>
        <volume>10</volume>
        <fpage>339</fpage>
        <lpage>348</lpage>
        <pub-id pub-id-type="doi">10.1023/A:1008981510081</pub-id>
      </citation>
    </ref>
    <ref id="B28">
      <citation citation-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>McLachlan</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Peel</surname>
            <given-names>D</given-names>
          </name>
        </person-group>
        <source>Finite Mixture Models</source>
        <year>2000</year>
        <publisher-name>Wiley Series in Probability and Statistics: Applied Probability and Statistics, New York: Wiley-Interscience</publisher-name>
      </citation>
    </ref>
    <ref id="B29">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Fraley</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Raftery</surname>
            <given-names>AE</given-names>
          </name>
        </person-group>
        <article-title>Model-based clustering, discriminant analysis, and density estimation</article-title>
        <source>J Amer Statist Assoc</source>
        <year>2002</year>
        <volume>97</volume>
        <fpage>611</fpage>
        <lpage>631</lpage>
        <pub-id pub-id-type="doi">10.1198/016214502760047131</pub-id>
      </citation>
    </ref>
    <ref id="B30">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lo</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Brinkman</surname>
            <given-names>RR</given-names>
          </name>
          <name>
            <surname>Gottardo</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>Automated gating of flow cytometry data via robust model-based clustering</article-title>
        <source>Cytometry A</source>
        <year>2008</year>
        <volume>73</volume>
        <fpage>321</fpage>
        <lpage>332</lpage>
        <pub-id pub-id-type="pmid">18307272</pub-id>
      </citation>
    </ref>
    <ref id="B31">
      <citation citation-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Titterington</surname>
            <given-names>DM</given-names>
          </name>
          <name>
            <surname>Smith</surname>
            <given-names>AFM</given-names>
          </name>
          <name>
            <surname>Makov</surname>
            <given-names>UE</given-names>
          </name>
        </person-group>
        <source>Statistical Analysis of Finite Mixture Distributions</source>
        <year>1985</year>
        <publisher-name>Chichester, UK: John Wiley &amp; Sons</publisher-name>
      </citation>
    </ref>
    <ref id="B32">
      <citation citation-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>McLachlan</surname>
            <given-names>GJ</given-names>
          </name>
          <name>
            <surname>Basford</surname>
            <given-names>KE</given-names>
          </name>
        </person-group>
        <source>Mixture Models: Inference and Applications to Clustering</source>
        <year>1988</year>
        <publisher-name>New York, NY: Marcel Dekker Inc</publisher-name>
      </citation>
    </ref>
    <ref id="B33">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Banfield</surname>
            <given-names>JD</given-names>
          </name>
          <name>
            <surname>Raftery</surname>
            <given-names>AE</given-names>
          </name>
        </person-group>
        <article-title>Model-based Gaussian and Non-Gaussian Clustering</article-title>
        <source>Biometrics</source>
        <year>1993</year>
        <volume>49</volume>
        <fpage>803</fpage>
        <lpage>821</lpage>
        <pub-id pub-id-type="doi">10.2307/2532201</pub-id>
      </citation>
    </ref>
    <ref id="B34">
      <citation citation-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Fraley</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Raftery</surname>
            <given-names>AE</given-names>
          </name>
        </person-group>
        <article-title>MCLUST Version 3 for R: Normal Mixture Modeling and Model-Based Clustering</article-title>
        <source>Technical Report</source>
        <year>2006</year>
        <publisher-name>Department of Statistics, University of Washington</publisher-name>
      </citation>
    </ref>
    <ref id="B35">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bickel</surname>
            <given-names>PJ</given-names>
          </name>
          <name>
            <surname>Doksum</surname>
            <given-names>KA</given-names>
          </name>
        </person-group>
        <article-title>An analysis of transformations revisited</article-title>
        <source>J Amer Statist Assoc</source>
        <year>1981</year>
        <volume>76</volume>
        <fpage>296</fpage>
        <lpage>311</lpage>
        <pub-id pub-id-type="doi">10.2307/2287831</pub-id>
      </citation>
    </ref>
    <ref id="B36">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Dempster</surname>
            <given-names>AP</given-names>
          </name>
          <name>
            <surname>Laird</surname>
            <given-names>NM</given-names>
          </name>
          <name>
            <surname>Rubin</surname>
            <given-names>DB</given-names>
          </name>
        </person-group>
        <article-title>Maximum likelihood from incomplete data via the EM algorithm</article-title>
        <source>J R Statist Soc B</source>
        <year>1977</year>
        <volume>39</volume>
        <fpage>1</fpage>
        <lpage>22</lpage>
      </citation>
    </ref>
    <ref id="B37">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Schwarz</surname>
            <given-names>G</given-names>
          </name>
        </person-group>
        <article-title>Estimating the Dimension of a Model</article-title>
        <source>Ann Statist</source>
        <year>1978</year>
        <volume>6</volume>
        <fpage>461</fpage>
        <lpage>464</lpage>
        <pub-id pub-id-type="doi">10.1214/aos/1176344136</pub-id>
      </citation>
    </ref>
    <ref id="B38">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Fraley</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Raftery</surname>
            <given-names>AE</given-names>
          </name>
        </person-group>
        <article-title>How many clusters? Which clustering method? Answers via model-based cluster analysis</article-title>
        <source>Comput J</source>
        <year>1998</year>
        <volume>41</volume>
        <fpage>578</fpage>
        <lpage>588</lpage>
        <pub-id pub-id-type="doi">10.1093/comjnl/41.8.578</pub-id>
      </citation>
    </ref>
    <ref id="B39">
      <citation citation-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Chambers</surname>
            <given-names>JM</given-names>
          </name>
        </person-group>
        <source>Programming with Data: A Guide to the S Language</source>
        <year>2004</year>
        <publisher-name>New York, NY: Springer</publisher-name>
      </citation>
    </ref>
    <ref id="B40">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Brinkman</surname>
            <given-names>RR</given-names>
          </name>
          <name>
            <surname>Gasparetto</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Lee</surname>
            <given-names>SJJ</given-names>
          </name>
          <name>
            <surname>Ribickas</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Perkins</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Janssen</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Smiley</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Smith</surname>
            <given-names>C</given-names>
          </name>
        </person-group>
        <article-title>High-content flow cytometry and temporal data analysis for defining a cellular signature of Graft-versus-Host disease</article-title>
        <source>Biol Blood Marrow Transplant</source>
        <year>2007</year>
        <volume>13</volume>
        <fpage>691</fpage>
        <lpage>700</lpage>
        <pub-id pub-id-type="pmid">17531779</pub-id>
        <pub-id pub-id-type="doi">10.1016/j.bbmt.2007.02.002</pub-id>
      </citation>
    </ref>
  </ref-list>
</back>
