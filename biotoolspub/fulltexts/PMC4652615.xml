<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//NLM//DTD Journal Publishing DTD v2.3 20070202//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName journalpublishing.dtd?>
<?SourceDTD.Version 2.3?>
<?ConverterInfo.XSLTName jp2nlmx2.xsl?>
<?ConverterInfo.Version 2?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Brief Bioinform</journal-id>
    <journal-id journal-id-type="iso-abbrev">Brief. Bioinformatics</journal-id>
    <journal-id journal-id-type="publisher-id">bib</journal-id>
    <journal-id journal-id-type="hwp">bib</journal-id>
    <journal-title-group>
      <journal-title>Briefings in Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1467-5463</issn>
    <issn pub-type="epub">1477-4054</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">4652615</article-id>
    <article-id pub-id-type="doi">10.1093/bib/bbv007</article-id>
    <article-id pub-id-type="publisher-id">bbv007</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Papers</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>A comparative study of RNA-seq analysis strategies</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Jänes</surname>
          <given-names>Jürgen</given-names>
        </name>
        <xref ref-type="author-notes" rid="bbv007-FN1">*</xref>
        <xref ref-type="bio" rid="d35e38">*</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Hu</surname>
          <given-names>Fengyuan</given-names>
        </name>
        <xref ref-type="author-notes" rid="bbv007-FN1">*</xref>
        <xref ref-type="bio" rid="d35e51">*</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Lewin</surname>
          <given-names>Alexandra</given-names>
        </name>
        <xref ref-type="bio" rid="d35e62">*</xref>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <name>
          <surname>Turro</surname>
          <given-names>Ernest</given-names>
        </name>
        <xref ref-type="bio" rid="d35e73">*</xref>
      </contrib>
    </contrib-group>
    <author-notes>
      <corresp>Corresponding author. Ernest Turro, Department of Haematology, University of Cambridge and MRC Biostatistics Unit. Tel.: <phone>+44 (0)1223 588174</phone>; E-mail: <email>et341@cam.ac.uk</email></corresp>
      <fn id="bbv007-FN1">
        <p>*These authors contributed equally to this work.</p>
      </fn>
    </author-notes>
    <pub-date pub-type="ppub">
      <month>11</month>
      <year>2015</year>
    </pub-date>
    <pub-date pub-type="epub">
      <day>18</day>
      <month>3</month>
      <year>2015</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>18</day>
      <month>3</month>
      <year>2015</year>
    </pub-date>
    <!-- PMC Release delay is 0 months and 0 days and was based on the
							<pub-date pub-type="epub"/>. -->
    <volume>16</volume>
    <issue>6</issue>
    <fpage>932</fpage>
    <lpage>940</lpage>
    <history>
      <date date-type="received">
        <day>16</day>
        <month>12</month>
        <year>2014</year>
      </date>
      <date date-type="rev-recd">
        <day>14</day>
        <month>1</month>
        <year>2015</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author 2015. Published by Oxford University Press.</copyright-statement>
      <copyright-year>2015</copyright-year>
      <license license-type="creative-commons" xlink:href="http://creativecommons.org/licenses/by/4.0/">
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted reuse, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <abstract>
      <p>Three principal approaches have been proposed for inferring the set of transcripts expressed in RNA samples using RNA-seq. The simplest approach uses curated annotations, which assumes the transcripts in a sample are a subset of the transcripts listed in a curated database. A more ambitious method involves aligning reads to a reference genome and using the alignments to infer the transcript structures, possibly with the aid of a curated transcript database. The most challenging approach is to assemble reads into putative transcripts <italic>de novo</italic> without the aid of reference data. We have systematically assessed the properties of these three approaches through a simulation study. We have found that the sensitivity of computational transcript set estimation is severely limited. Computational approaches (both genome-guided and <italic>de novo</italic> assembly) produce a large number of artefacts, which are assigned large expression estimates and absorb a substantial proportion of the signal when performing expression analysis. The approach using curated annotations shows good expression correlation even when the annotations are incomplete. Furthermore, any incorrect transcripts present in a curated set do not absorb much signal, so it is preferable to have a curation set with high sensitivity than high precision. Software to simulate transcript sets, expression values and sequence reads under a wider range of parameter values and to compare sensitivity, precision and signal-to-noise ratios of different methods is freely available online (<ext-link ext-link-type="uri" xlink:href="https://github.com/boboppie/RSSS">https://github.com/boboppie/RSSS</ext-link>) and can be expanded by interested parties to include methods other than the exemplars presented in this article.</p>
    </abstract>
    <kwd-group>
      <kwd>RNA-seq</kwd>
      <kwd>transcriptome assembly</kwd>
      <kwd>gene expression</kwd>
      <kwd>RNA splicing</kwd>
    </kwd-group>
    <counts>
      <page-count count="9"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec sec-type="intro">
    <title>Introduction</title>
    <p>Recent advances in sequencing technologies have enhanced significantly our ability to profile the transcriptomic content of cells. However, it is currently not feasible to obtain full-length (end-to-end) sequences of RNA transcripts in a high-throughput manner because high-throughput sequencers can only cope with a narrow range of complementary DNA (cDNA) fragment sizes. Thus, expression quantification is typically done via massively parallel short-read sequencing of small fragments, also known as RNA-seq. Although emergent long-read sequencing technologies are capable of producing reads matching the length of a large proportion of transcripts [<xref rid="bbv007-B1" ref-type="bibr">1</xref>], they currently suffer from low accuracy and yield compared with established short-read technology.</p>
    <p>There are two basic objectives that may be tackled with RNA-seq. The first is to determine precisely which regions of the genome are being transcribed in a sample. The second is to quantify the expression of these transcripts. The latter objective typically relies on completion of the former: to quantify expression of individual transcripts, a set of full-length transcript sequences is needed. This dependency is a consequence of the limited read length of RNA-seq. The requirement by high-throughput sequencers to fragment cDNA induces uncertainty in the process of reconstructing transcript sequences by assembly of short reads or alignments.</p>
    <p>Three broad approaches have been proposed for estimating the set of transcripts in RNA samples using RNA-seq [<xref rid="bbv007-B2" ref-type="bibr">2</xref>, <xref rid="bbv007-B3" ref-type="bibr">3</xref>]. The simplest approach is to assume the transcripts in a sample are a subset of the transcripts listed in a curated database, such as Ensembl [<xref rid="bbv007-B4" ref-type="bibr">4</xref>]: reads are aligned to reference genome or transcriptome sequences, and statistical models are used to estimate expression or test for differential expression. A more ambitious strategy involves aligning reads to a reference genome and using the alignments to infer the transcript structures. Generally, maximally parsimonious solutions are preferred [<xref rid="bbv007-B5" ref-type="bibr">5</xref>] although some methods opt for maximum sensitivity subject to constraints imposed by the alignments [<xref rid="bbv007-B6" ref-type="bibr">6</xref>]. The most challenging approach is to assemble reads into putative transcripts <italic>de novo</italic> without the aid of a reference genome. The high dynamic range of expression values leads to difficulties in selecting the <italic>k</italic>-mer lengths for constructing de Bruijn graphs [<xref rid="bbv007-B7" ref-type="bibr">7</xref>], while alternative splicing leads to much higher complexity in the assembly graphs than in traditional assembly of DNA-seq reads. Thus, <italic>de novo</italic> assembly is most fruitfully applied in the context of large-scale discovery of transcripts expressed in species with poorly characterized or absent reference genomes.</p>
    <p>There has been a great deal of expectation that high-throughput sequencing technologies would allow a global and unbiased characterization of the transcriptome compared with microarrays and, consequently, several methods have been proposed for inferring transcript structures using sequence data. A recent assessment of a broad range of computational tools for reconstruction of transcripts from RNA-seq data has shown that low sensitivity with respect to reference annotations is a common weakness of these methods, especially as applied to eukaryotic transcriptome data [<xref rid="bbv007-B8" ref-type="bibr">8</xref>]. However, these approaches have not been systematically compared with each other in the context of a controlled simulation study in which the true set of expressed transcripts and their expression levels are known, nor have they been compared with annotation-based inference under a range of assumptions about the accuracy of the annotations.</p>
  </sec>
  <sec sec-type="methods">
    <title>Methods</title>
    <p>We have conceived a simulation study for comparing the three approaches to expression analysis under a range of scenarios. We recall that the methods fall into three categories: those that use curated annotations to align reads and infer expression, those that use genome-guided assembly and those relying solely on <italic>de novo</italic> assembly of reads.</p>
    <p>The general outline of the simulation study is illustrated in <xref ref-type="fig" rid="bbv007-F1">Figure 1</xref> and can be summarized as follows.
<list list-type="simple"><list-item><p>(i) Define a realistic set of transcripts as a ‘transcript pool’ and define a subset of the transcript pool as the ‘truly expressed set’.</p></list-item><list-item><p>(ii) Assign an expression value to each element of the truly expressed set and simulate RNA-seq reads accordingly.</p></list-item><list-item><p>(iii) Define the ‘discovered transcript set’ as one of
<list list-type="alpha-lower"><list-item><p>a set of simulated annotated transcripts that does not depend on the read data (this is a simulation of a curated annotation),</p></list-item><list-item><p>a set obtained through genome-guided assembly of the simulated reads or</p></list-item><list-item><p>a set obtained through <italic>de novo</italic> assembly of the simulated reads.</p></list-item></list></p></list-item><list-item><p>For each of the above, sensitivity and precision with respect to the truly expressed set can be computed.</p></list-item><list-item><p>(iv) For the transcript sets found by assembly methods, compare the discovered transcript set to the set of truly expressed transcripts.</p></list-item><list-item><p>(v) Estimate expression values for all transcripts in the discovered set.</p></list-item><list-item><p>(vi) Compare estimated and true expression values to assess the accuracy of each approach.</p></list-item></list>
<fig id="bbv007-F1" position="float"><label>Figure 1.</label><caption><p>Sampling of expressed transcripts and simulated annotations from the transcript pool. We randomly designate <italic>f<sub>g</sub></italic> of genes as active genes and leave the remaining 1 − <italic>f<sub>g</sub></italic> as silent genes. A fraction <italic>f<sub>t</sub></italic> of transcripts in active genes are designated as <italic>N<sub>e</sub></italic> expressed transcripts, leaving the remaining 1 − <italic>f<sub>t</sub></italic> as <italic>N<sub>u</sub></italic> unexpressed transcripts (from active genes). Transcripts from silent genes are designated as <italic>N<sub>s</sub></italic> silent transcripts. Expressed transcripts <italic>N<sub>e</sub></italic> are assigned expression values and used as the ground truth when evaluating reconstructions. Simulated annotations of desired sensitivity <italic>s</italic> and precision <italic>p</italic> are obtained by partitioning expressed transcripts into <italic>TP</italic> and <italic>FN</italic> transcripts to reach the desired sensitivity <italic>s</italic>, followed by random sampling of <italic>FP<sub>a</sub></italic> transcripts from unexpressed transcripts of active genes and <italic>FP<sub>s</sub></italic> transcripts from silent genes to reach desired precision <italic>p</italic>.</p></caption><graphic xlink:href="bbv007f1p"/></fig>
</p>
    <sec>
      <title>Selecting the transcript pool</title>
      <p>We select our transcript pool from the Ensembl 66 cDNA sequences. We use transcripts from subsets of the genomes throughout our study for convenience (chromosomes 21 and 22 on human, chromosomes 2 and 3 on mouse and chromosomes III and V on worm). For genome-assisted reconstruction, we use the corresponding GRCh37 reference genome. We filter out duplicate transcripts (transcripts sharing exonic coordinates and thus differing only in the locations of their untranslated regions) and alternative haplotype/supercontig entries from the cDNA sequences and the genome assembly.</p>
    </sec>
    <sec>
      <title>Simulating expression values</title>
      <p>We simulate expressed transcripts by sampling from the transcript pool (<xref ref-type="fig" rid="bbv007-F1">Figure 1</xref>). This is close to what we would expect in reality: a large fraction of genes and transcripts are expressed only in specific tissues, developmental stages or other biological conditions. We partition the transcript pool as follows:
<list list-type="roman-lower"><list-item><p>Label a fraction <italic>f<sub>g</sub></italic> of genes in the transcript pool as active and the remainder as silent.</p></list-item><list-item><p>Label a fraction <italic>f<sub>t</sub></italic> of transcripts belonging to active genes as ‘expressed’ and the remainder as ‘unexpressed from active genes’. We denote the number of expressed transcripts as <italic>N<sub>e</sub></italic> and the number of unexpressed transcripts from active genes as <italic>N<sub>u</sub></italic>.</p></list-item><list-item><p>We denote the number of (unexpressed) transcripts from the 1 − <italic>f<sub>g</sub></italic> fraction of genes, which are silent as <italic>N<sub>s</sub></italic>.</p></list-item></list></p>
      <p>The values of <italic>f<sub>g</sub></italic> and <italic>f<sub>t</sub></italic> were set as described in the <ext-link ext-link-type="uri" xlink:href="http://bib.oxfordjournals.org/lookup/suppl/doi:10.1093/bib/bbv007/-/DC1">Supplementary Note</ext-link>. We hypothesized that transcripts that are often found to be highly expressed are more likely to be annotated than those that are lowly expressed or expressed only under specific conditions. We tested this hypothesis by binning transcripts by date in which they were added to the Ensembl database and examining the proportion, which were estimated to be moderately expressed (estimated FPKM &gt; 1) in a randomly chosen sample from the Illumina BodyMap data set (<ext-link ext-link-type="uri" xlink:href="http://www.ebi.ac.uk/arrayexpress/experiments/E-MTAB-513">http://www.ebi.ac.uk/arrayexpress/experiments/E-MTAB-513</ext-link>). We found that the longer a transcript had been in the database, the more likely it was to be highly expressed (<xref ref-type="fig" rid="bbv007-F2">Figure 2</xref>). This suggests that a realistic simulation would incorporate different sampling distributions for the expression values of annotated compared with unannotated transcripts and that this difference would depend on the quality of the annotation at a particular point in time. Naturally, such a realistic set-up would make transcript reconstruction a more challenging proposition. However, we include only the results of the more conservative analysis using a single sampling distribution, which would tend to favour reconstruction approaches. We generate artificial expression values for all expressed transcripts by sampling from a gamma distribution with shape <italic>α</italic> = 1.2 and rate <italic>β</italic> = 0.001, which captures the wide range of expression values typically found in a real sample.
<fig id="bbv007-F2" position="float"><label>Figure 2.</label><caption><p>The proportion of Ensembl 70 transcripts, binned by their creation date, estimated to be moderately expressed in the thyroid sample from the Illumina BodyMap data set (accession ID ERR030872 only). The proportions are significantly different between each pair of successive bins (<inline-formula><mml:math id="MM1"><mml:mrow><mml:mi>p</mml:mi><mml:mo>&lt;</mml:mo><mml:msup><mml:mrow><mml:mn>10</mml:mn></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>8</mml:mn></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:mtext> </mml:mtext><mml:msup><mml:mi>χ</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:math></inline-formula> test for equality of proportions).</p></caption><graphic xlink:href="bbv007f2p"/></fig>
</p>
    </sec>
    <sec>
      <title>Simulating RNA-seq reads</title>
      <p>Having generated the set of expressed transcripts and the corresponding expression values, we simulate 75 bp paired-end error-free reads. We sample the insert size (outer distance between the two paired reads) in base pairs from a normal distribution with mean <italic>μ</italic> = 250 and standard deviation <italic>σ</italic> = 30. We note that our set-up (error-free reads, a lack of sequencing biases, a single sampling distributions for transcripts designated as annotated or unannotated) generally favours reconstruction approaches and that any weaknesses in these approaches are therefore despite the use of particularly favourable assumptions. We also prefer this relatively simple set-up to more complicated simulators (e.g. [<xref rid="bbv007-B9" ref-type="bibr">9</xref>, <xref rid="bbv007-B10" ref-type="bibr">10</xref>]), as it provides a neutral framework for comparing widely differing methods.</p>
    </sec>
    <sec>
      <title>Simulating imperfect transcript annotations</title>
      <p>We simulate the set of curated, annotated transcripts after the expression values because we want to specify its sensitivity and precision with respect to the truly expressed transcripts. We can then compare the expression estimates of transcript sets found by assembly methods with the estimates obtained using a simulated annotation for different levels of annotation accuracy.</p>
      <p>We randomly partition <italic>N<sub>e</sub></italic> expressed transcripts into annotated transcripts (true positive, <italic>TP</italic>) and unannotated transcripts (false negative, <italic>FN</italic>) to achieve the desired sensitivity <italic>s</italic>.
<disp-formula><mml:math id="MM2"><mml:mtable columnalign="left"><mml:mtr><mml:mtd><mml:mi>s</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi>T</mml:mi><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mi>T</mml:mi><mml:mi>P</mml:mi><mml:mo>+</mml:mo><mml:mi>F</mml:mi><mml:mi>N</mml:mi></mml:mrow></mml:mfrac></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msub><mml:mi>N</mml:mi><mml:mi>e</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mi>T</mml:mi><mml:mi>P</mml:mi><mml:mo>+</mml:mo><mml:mi>F</mml:mi><mml:mi>N</mml:mi></mml:mtd></mml:mtr></mml:mtable></mml:math></disp-formula>
<disp-formula>We then randomly sample <italic>FP<sub>a</sub></italic> false positives from <italic>N<sub>u</sub></italic> unexpressed transcripts from active genes and <italic>FP<sub>s</sub></italic> false positives from <italic>N<sub>s</sub></italic> unexpressed transcripts from silent genes to obtain the desired precision <italic>p</italic>.</disp-formula>
<disp-formula><mml:math id="MM3"><mml:mrow><mml:mi>p</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi>T</mml:mi><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mi>T</mml:mi><mml:mi>P</mml:mi><mml:mo>+</mml:mo><mml:mi>F</mml:mi><mml:msub><mml:mi>P</mml:mi><mml:mi>a</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:mi>F</mml:mi><mml:msub><mml:mi>P</mml:mi><mml:mi>s</mml:mi></mml:msub></mml:mrow></mml:mfrac></mml:mrow></mml:math></disp-formula>
</p>
      <p>The sampling of the two different kinds of false positive (FP) transcripts (<italic>FP<sub>a</sub></italic> and <italic>FP<sub>s</sub></italic>) is based on the assumption that the fraction of annotated transcripts is the same for both active and silent genes.
<disp-formula><mml:math id="MM4"><mml:mrow><mml:mfrac><mml:mrow><mml:mi>T</mml:mi><mml:mi>P</mml:mi><mml:mo>+</mml:mo><mml:mi>F</mml:mi><mml:msub><mml:mi>P</mml:mi><mml:mi>a</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:mi>F</mml:mi><mml:msub><mml:mi>P</mml:mi><mml:mi>s</mml:mi></mml:msub></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>f</mml:mi><mml:mi>g</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msub><mml:mi>f</mml:mi><mml:mi>g</mml:mi></mml:msub></mml:mrow></mml:mfrac></mml:mrow></mml:math></disp-formula>
</p>
      <p>This gives us four simultaneous equations, which we can solve for the four parameters <italic>TP</italic>, <italic>FN</italic>, <italic>FP<sub>a</sub></italic> and <italic>FP<sub>s</sub></italic>, given the required sensitivity <italic>s</italic> and precision <italic>p</italic>.</p>
    </sec>
    <sec>
      <title>Assessing transcript reconstruction (assembly methods only)</title>
      <p>We compare the reconstructed/estimated transcripts to the simulated/expressed transcripts by producing a one-to-one matching between them (we describe the matching algorithm below). We proceed by classifying transcripts into three groups:<disp-quote content-type="extract"><p><bold>True</bold><bold>positive</bold> transcripts are present in the estimated transcript set and can be matched to an expressed transcript.</p><p><bold>False</bold><bold>negative</bold> transcripts are present in expressed transcripts that cannot be matched with a transcript from the estimated transcript set.</p><p><bold>False</bold><bold>positive</bold> transcripts are present in the estimated transcript set and cannot be matched to an expressed transcript.</p></disp-quote></p>
      <p>We characterize the accuracy of an estimated transcript set via sensitivity and precision. Sensitivity and precision are calculated from the labelling obtained from comparing the transcript set to expressed transcripts and using the standard definitions [sensitivity <italic>s</italic> = <italic>TP</italic>/(<italic>TP</italic> + <italic>FN</italic>), precision <italic>p</italic> = <italic>TP</italic>/(<italic>TP</italic> + <italic>FP</italic>)].</p>
    </sec>
    <sec>
      <title>Matching reconstructed transcripts to expressed transcripts</title>
      <p>In principle, a one-to-one mapping of reconstructed transcripts to expressed transcripts could be achieved by finding pairs of equal transcripts between the expressed transcripts and the assembled transcripts. However, we prefer to allow flexible matching between the start and end coordinates of the assembled transcripts and the true start and end coordinates as assembly methods are known to have difficulties in recovering these exactly [<xref rid="bbv007-B11" ref-type="bibr">11</xref>], and yet, such approximate reconstructions could still be informative and provide reasonably reliable expression estimates. On the other hand, as one of the main promises of RNA-seq is the ability to study splicing patterns, we follow [<xref rid="bbv007-B8" ref-type="bibr">8</xref>] and require exact matching of all the exon boundaries that are not also the 5′ and 3′ ends of the transcripts.</p>
      <p>We use the following algorithm to match reconstructed transcripts to expressed transcripts.
<list list-type="roman-lower"><list-item><p>Create a list of ‘match candidates’ by iterating over all expressed transcripts and reconstructed transcripts. A match candidate is a pair consisting of an expressed transcript and a reconstructed transcript that fulfils the following criteria:
<list list-type="alpha-lower"><list-item><p>The length of the longest common subsequence of the reconstructed transcript and the true transcript is at least 80% of the length of the true transcript.</p></list-item><list-item><p>The longest common subsequence of the reconstruction and the true transcript contains all inner exons of the true transcript.</p></list-item><list-item><p>The total length of the reconstructed transcript does not differ from the total length of the true transcript by &gt;20%.</p></list-item></list></p></list-item><list-item><p>For every match candidate of expressed transcript <italic>i</italic> and reconstructed transcript <italic>j</italic>, we calculate a mismatch score <inline-formula><mml:math id="MM5"><mml:mrow><mml:msub><mml:mi>m</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msubsup><mml:mi>d</mml:mi><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:msubsup><mml:mo>+</mml:mo><mml:msubsup><mml:mi>d</mml:mi><mml:mn>2</mml:mn><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:math></inline-formula>. Here, <italic>d</italic><sub>1</sub> and <italic>d</italic><sub>2</sub> are lengths of the mismatching sequences at the two ends when transcripts have been aligned such that the inner exon sequences match (<xref ref-type="fig" rid="bbv007-F3">Figure 3</xref>). If several alignments are possible, we select the alignment that minimizes the mismatch score.</p></list-item><list-item><p>We then traverse the list of match candidates sorted by increasing mismatch score. At each step, we designate the pairing (<italic>i</italic>, <italic>j</italic>) with the smallest score as a true match and, in order to obtain a one-to-one mapping between reconstructed transcripts and expressed transcripts, remove all match candidates containing the <italic>i</italic>-th expressed transcript or the <italic>j</italic>-th reconstructed transcript from the match candidate list.</p></list-item></list>
<fig id="bbv007-F3" position="float"><label>Figure 3.</label><caption><p>Matching reconstructed transcripts with true transcripts. The highlighted region on the right end of the reconstructed transcript indicates a mismatching sequence with the true transcript above it. Solid vertical lines indicate exon boundaries. A colour version of this figure is available at BIB online: <ext-link ext-link-type="uri" xlink:href="http://bib.oxfordjournals.org">http://bib.oxfordjournals.org</ext-link>.</p></caption><graphic xlink:href="bbv007f3p"/></fig>
</p>
    </sec>
    <sec>
      <title>Estimating transcript expression</title>
      <p>Once the discovered transcript set has been established through any of the three routes described above, expression estimates are obtained using MMSEQ [<xref rid="bbv007-B12" ref-type="bibr">12</xref>]. We run MMSEQ on the entire discovered transcript set (including both TP and FP transcripts), as that is what would occur in a real RNA-seq experiment. The estimated expression values are compared with the known expression values using the matching procedure described above for the computational methods and the ‘known’ values for FP transcripts are set to zero as, by definition, FP transcripts are not present in the sample.</p>
    </sec>
  </sec>
  <sec sec-type="results">
    <title>Results</title>
    <p>Here we present the results of our analysis comparing the three approaches. We selected Cufflinks to assess genome-guided assembly and Oases to assess <italic>de novo</italic> assembly. We limit ourselves to one method within each category to simplify our exposition and because the categories are so much more different from each other than implementations within any given category. Additionally, we assess a fourth approach, the RABT+Cufflinks method [<xref rid="bbv007-B13" ref-type="bibr">13</xref>], which supplements a set of annotated transcripts with reconstructed transcripts using Cufflinks. Parameter settings are described in the <ext-link ext-link-type="uri" xlink:href="http://bib.oxfordjournals.org/lookup/suppl/doi:10.1093/bib/bbv007/-/DC1">Supplementary Note</ext-link> and in general have been left as default or set to recommended values based on the literature. Intricate parameter tweaking and data post-processing are beyond the scope of this work, as our objective is to compare the general properties of these methods under standard use. Unless stated otherwise, we simulate data using human transcripts as our reference.</p>
    <sec>
      <title>Reconstruction methods have low sensitivity and precision</title>
      <p>First we consider the differences between <italic>de novo</italic> assembly and genome-guided assembly for the reconstruction of the transcript set. We assess the sensitivity and precision achieved by these two approaches for a range of coverage values, computed as twice the number of fragments times the read length divided by the total sequence length of truly expressed transcripts. As the number of sequenced fragments increases, we observe an increase in sensitivity, which saturates at roughly <italic>s</italic> = 0.36 for both Cufflinks and Oases. Saturation of the number of reconstructed transcripts has been reported previously for Cufflinks assembly [<xref rid="bbv007-B14" ref-type="bibr">14</xref>]. It was thought that saturation was reached when virtually all true transcripts had been reconstructed but we show here that saturation can be reached at low sensitivities in human (<xref ref-type="fig" rid="bbv007-F4">Figure 4</xref>A). These results suggest that <italic>de novo</italic> and genome-guided assembly have a similar ability to reconstruct truly expressed transcripts.
<fig id="bbv007-F4" position="float"><label>Figure 4.</label><caption><p>Transcriptome reconstruction accuracy for varying coverage values. Sensitivity (top panels, labelled <bold>A</bold> and <bold>B</bold>) and precision (bottom panels, labelled <bold>C</bold> and <bold>D</bold>) of transcripts reconstructed using Cufflinks (triangles) and Oases (crosses) as a function of simulated read coverage for human (left panels, labelled <bold>A</bold> and <bold>C</bold>) and worm (right panels, labelled <bold>B</bold> and <bold>D</bold>) transcriptomes. A colour version of this figure is available at BIB online: <ext-link ext-link-type="uri" xlink:href="http://bib.oxfordjournals.org">http://bib.oxfordjournals.org</ext-link>.</p></caption><graphic xlink:href="bbv007f4p"/></fig>
</p>
      <p>We also observe saturation for the precision of the estimated transcript sets (<xref ref-type="fig" rid="bbv007-F4">Figure 4</xref>C). Cufflinks saturates at <italic>p</italic> ≃ 0.45, whereas Oases saturates at <italic>p</italic> ≃ 0.17. This means that a significant majority of the transcripts produced by Cufflinks and Oases are false, even under very favourable simulation conditions. We stress that the false reconstructed transcripts are not technical or biological artefacts that may be found in real samples (e.g. partially transcribed RNA) as we only simulate reads from <italic>bona fide</italic> transcripts in our pool. The low precision observed is loosely supported by previous observations made on real data. In the Cufflinks paper [<xref rid="bbv007-B5" ref-type="bibr">5</xref>], almost half of the constructed transcripts were unknown isoforms of known genes. In an application to a human RNA-seq data set, Cufflinks has been reported to produce a significant number of transcripts not present in Ensembl [<xref rid="bbv007-B14" ref-type="bibr">14</xref>]. Both of these examples are based on experimental RNA-seq data, meaning that it was not possible to determine whether the ‘novel transcripts’ missing from existing annotations were true or false positives. The results presented here suggest that a large proportion of the ‘novel transcripts’ are likely to fall to the latter category.</p>
      <p>We have repeated this analysis in mouse and worm (<italic>C</italic><italic>aenorhabditis </italic><italic>elegans</italic>) to assess how reconstruction accuracy varies with transcriptome complexity. The saturation levels of both sensitivity and precision were similar in mouse compared with human for both Cufflinks and Oases (<ext-link ext-link-type="uri" xlink:href="http://bib.oxfordjournals.org/lookup/suppl/doi:10.1093/bib/bbv007/-/DC1">Supplementary Note</ext-link>). However, we see much greater accuracy in reconstructing the low-complexity worm transcriptome using Cufflinks (<italic>s</italic> = 0.68, <italic>p</italic> = 0.80) and Oases (<italic>s</italic> = 0.72, <italic>p</italic> = 0.67) (<xref ref-type="fig" rid="bbv007-F4">Figure 4</xref>B, D). The improved accuracy is most likely a consequence of the reduced mean number of isoforms per gene in worm compared with human and mouse (<xref ref-type="fig" rid="bbv007-F5">Figure 5</xref>). Reduced paralogy in the worm, as measured by the proportion of simulated read pairs mapping to multiple genes, may also play a role in this improvement (0.050, 0.023 and 0.013 for human, mouse and worm, respectively).
<fig id="bbv007-F5" position="float"><label>Figure 5.</label><caption><p>The mean number of isoforms per gene by chromosome in human, mouse and worm.</p></caption><graphic xlink:href="bbv007f5p"/></fig>
</p>
    </sec>
    <sec>
      <title>Unexpressed annotated transcripts absorb a small proportion of the expression signal</title>
      <p>Here we consider how the choice of annotation database affects expression estimation for methods that use a predefined reference transcriptome. We vary the sensitivity and precision of the simulated annotation set to assess the impact of incompleteness and inaccuracy of annotations on expression estimation. We use the simulated transcript sets to estimate expression levels and then compare the resulting expression estimates with the true (simulated) values. Our simulation set-up generates both false positives (incorrect transcripts) and false negatives (missing transcripts).</p>
      <p><xref ref-type="table" rid="bbv007-T1">Table 1</xref> (left) shows the correlation between the log expression estimates of TP transcripts and the true log expression values of the TP transcripts for transcript sets obtained using annotations that have a range of sensitivities and precisions. More sensitive annotations (those with a greater proportion of the truly existing transcripts) clearly lead to improved estimates. However, for a fixed sensitivity, the precision of the annotations does not have a discernible effect on the accuracy of expression estimates. This has implications for the choice of reference annotation set to be used for estimation: more sensitive annotations, such as Ensembl, which contains 190 243 (release 66) human transcripts, should be preferred over more specific annotations, such as RefSeq [<xref rid="bbv007-B15" ref-type="bibr">15</xref>], which contains 50 029 human transcripts, if the aim is to obtain accurate expression estimates. The addition of false positives (i.e. unexpressed transcripts) into the annotation set does not have a significant impact on accuracy within the range of precision that we have considered.
<table-wrap id="bbv007-T1" position="float"><label>Table 1.</label><caption><p>Performance of the simulated annotations approach</p></caption><table frame="hsides" rules="groups"><thead align="left"><tr><th rowspan="1" colspan="1"/><th rowspan="1" colspan="1"/><th colspan="5" align="center" rowspan="1">Correlation of TPs<hr/></th><th colspan="5" align="center" rowspan="1"><inline-formula><mml:math id="MM8"><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mtext>FP</mml:mtext></mml:mrow><mml:mo stretchy="true">¯</mml:mo></mml:mover><mml:mo>/</mml:mo><mml:mover accent="true"><mml:mrow><mml:mtext>TP</mml:mtext></mml:mrow><mml:mo stretchy="true">¯</mml:mo></mml:mover></mml:mrow></mml:math></inline-formula><hr/></th></tr><tr><th rowspan="1" colspan="1"/><th rowspan="1" colspan="1"/><th colspan="10" align="center" rowspan="1">Sensitivity<hr/></th></tr><tr><th rowspan="1" colspan="1"/><th rowspan="1" colspan="1"/><th align="center" rowspan="1" colspan="1">0.2</th><th align="center" rowspan="1" colspan="1">0.4</th><th align="center" rowspan="1" colspan="1">0.6</th><th align="center" rowspan="1" colspan="1">0.8</th><th align="center" rowspan="1" colspan="1">1.0</th><th align="center" rowspan="1" colspan="1">0.2</th><th align="center" rowspan="1" colspan="1">0.4</th><th align="center" rowspan="1" colspan="1">0.6</th><th align="center" rowspan="1" colspan="1">0.8</th><th align="center" rowspan="1" colspan="1">1.0</th></tr></thead><tbody align="left"><tr><td rowspan="5" colspan="1">Precision</td><td rowspan="1" colspan="1">0.40</td><td rowspan="1" colspan="1"><bold>0.82</bold> (0.88)</td><td rowspan="1" colspan="1"><bold>0.85</bold> (0.87)</td><td rowspan="1" colspan="1"><bold>0.89</bold> (0.89)</td><td rowspan="1" colspan="1"><bold>0.93</bold> (0.92)</td><td rowspan="1" colspan="1"><bold>0.96</bold> (0.96)</td><td rowspan="1" colspan="1"><bold>0.16</bold> (0.45)</td><td rowspan="1" colspan="1"><bold>0.10</bold> (0.28)</td><td rowspan="1" colspan="1"><bold>0.06</bold> (0.16)</td><td rowspan="1" colspan="1"><bold>0.04</bold> (0.08)</td><td rowspan="1" colspan="1"><bold>0.02</bold> (0.03)</td></tr><tr><td rowspan="1" colspan="1">0.35</td><td rowspan="1" colspan="1"><bold>0.78</bold> (0.86)</td><td rowspan="1" colspan="1"><bold>0.88</bold> (0.91)</td><td rowspan="1" colspan="1"><bold>0.89</bold> (0.87)</td><td rowspan="1" colspan="1"><bold>0.94</bold> (0.92)</td><td rowspan="1" colspan="1"><bold>0.96</bold> (0.96)</td><td rowspan="1" colspan="1"><bold>0.14</bold> (0.41)</td><td rowspan="1" colspan="1"><bold>0.10</bold> (0.25)</td><td rowspan="1" colspan="1"><bold>0.06</bold> (0.15)</td><td rowspan="1" colspan="1"><bold>0.03</bold> (0.08)</td><td rowspan="1" colspan="1"><bold>0.02</bold> (0.03)</td></tr><tr><td rowspan="1" colspan="1">0.30</td><td rowspan="1" colspan="1"><bold>0.82</bold> (0.87)</td><td rowspan="1" colspan="1"><bold>0.89</bold> (0.89)</td><td rowspan="1" colspan="1"><bold>0.90</bold> (0.90)</td><td rowspan="1" colspan="1"><bold>0.93</bold> (0.93)</td><td rowspan="1" colspan="1"><bold>0.96</bold> (0.96)</td><td rowspan="1" colspan="1"><bold>0.14</bold> (0.37)</td><td rowspan="1" colspan="1"><bold>0.09</bold> (0.19)</td><td rowspan="1" colspan="1"><bold>0.06</bold> (0.12)</td><td rowspan="1" colspan="1"><bold>0.03</bold> (0.06)</td><td rowspan="1" colspan="1"><bold>0.02</bold> (0.02)</td></tr><tr><td rowspan="1" colspan="1">0.25</td><td rowspan="1" colspan="1"><bold>0.81</bold> (0.89)</td><td rowspan="1" colspan="1"><bold>0.88</bold> (0.91)</td><td rowspan="1" colspan="1"><bold>0.90</bold> (0.88)</td><td rowspan="1" colspan="1"><bold>0.94</bold> (0.93)</td><td rowspan="1" colspan="1"><bold>0.96</bold> (0.96)</td><td rowspan="1" colspan="1"><bold>0.13</bold> (0.31)</td><td rowspan="1" colspan="1"><bold>0.09</bold> (0.17)</td><td rowspan="1" colspan="1"><bold>0.05</bold> (0.10)</td><td rowspan="1" colspan="1"><bold>0.03</bold> (0.06)</td><td rowspan="1" colspan="1"><bold>0.02</bold> (0.02)</td></tr><tr><td rowspan="1" colspan="1">0.20</td><td rowspan="1" colspan="1"><bold>0.79</bold> (0.86)</td><td rowspan="1" colspan="1"><bold>0.90</bold> (0.88)</td><td rowspan="1" colspan="1"><bold>0.89</bold> (0.89)</td><td rowspan="1" colspan="1"><bold>0.94</bold> (0.92)</td><td rowspan="1" colspan="1"><bold>0.96</bold> (0.96)</td><td rowspan="1" colspan="1"><bold>0.12</bold> (0.27)</td><td rowspan="1" colspan="1"><bold>0.08</bold> (0.15)</td><td rowspan="1" colspan="1"><bold>0.05</bold> (0.08)</td><td rowspan="1" colspan="1"><bold>0.03</bold> (0.04)</td><td rowspan="1" colspan="1"><bold>0.02</bold> (0.02)</td></tr></tbody></table><table-wrap-foot><fn id="bbv007-TF1"><p>In bold, correlation between true and estimated expression of TP transcripts (left) and <inline-formula><mml:math id="MM9"><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mtext>FP</mml:mtext></mml:mrow><mml:mo stretchy="true">¯</mml:mo></mml:mover><mml:mo>/</mml:mo><mml:mover accent="true"><mml:mrow><mml:mtext>TP</mml:mtext></mml:mrow><mml:mo stretchy="true">¯</mml:mo></mml:mover></mml:mrow></mml:math></inline-formula> (right) for simulated annotations of varying sensitivities and precisions (shown in the table margins). The values in brackets correspond to the correlations obtained after supplementation of transcript sets using RABT. Values shown are the mean over three independent simulations.</p></fn></table-wrap-foot></table-wrap></p>
      <p>We also assess the propensity of different approaches to mis-assign expression signal to FP transcripts. For each method, we compute the ratio between the mean expression estimate of FP transcripts and the mean expression estimate of TP transcripts (<inline-formula><mml:math id="MM10"><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mtext>FP</mml:mtext></mml:mrow><mml:mo stretchy="true">¯</mml:mo></mml:mover><mml:mo>/</mml:mo><mml:mover accent="true"><mml:mrow><mml:mtext>TP</mml:mtext></mml:mrow><mml:mo stretchy="true">¯</mml:mo></mml:mover></mml:mrow></mml:math></inline-formula>). A value of zero implies perfect differentiation between FP and TP expression values, whereas a ratio of 1 implies that on average FP transcripts are assigned much of the expression signal as TP transcripts (<xref ref-type="table" rid="bbv007-T1">Table 1</xref>, right). Using curated annotations, <inline-formula><mml:math id="MM11"><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mtext>FP</mml:mtext></mml:mrow><mml:mo stretchy="true">¯</mml:mo></mml:mover><mml:mo>/</mml:mo><mml:mover accent="true"><mml:mrow><mml:mtext>TP</mml:mtext></mml:mrow><mml:mo stretchy="true">¯</mml:mo></mml:mover></mml:mrow></mml:math></inline-formula> is 0.14 on average for the lowest sensitivities we have simulated and decreases with increasing sensitivity (≤0.07 for sensitivities &gt;0.6 irrespective of precision).</p>
    </sec>
    <sec>
      <title>Transcript reconstruction induces high expression estimates in FP transcripts</title>
      <p>We now consider the performance of expression estimation using transcript sets obtained through computational reconstruction. For the two purely computationally reconstructed sets (Cufflinks and Oases), we use the transcript sets obtained at the saturated sensitivity and precision values (<xref ref-type="table" rid="bbv007-T2">Table 2</xref>). These sets are obtained when mean coverage is equal to 100 and comprise the best reconstruction achievable using these methods with standard parameter settings.
<table-wrap id="bbv007-T2" position="float"><label>Table 2.</label><caption><p>Performance of the computational transcriptome reconstruction methods</p></caption><table frame="hsides" rules="groups"><thead align="left"><tr><th rowspan="1" colspan="1"/><th rowspan="1" colspan="1">Cufflinks</th><th rowspan="1" colspan="1">Oases</th></tr></thead><tbody align="left"><tr><td rowspan="1" colspan="1">Sensitivity</td><td rowspan="1" colspan="1">0.36</td><td rowspan="1" colspan="1">0.36</td></tr><tr><td rowspan="1" colspan="1">Precision</td><td rowspan="1" colspan="1">0.45</td><td rowspan="1" colspan="1">0.17</td></tr><tr><td rowspan="1" colspan="1">Correlation of TPs</td><td rowspan="1" colspan="1">0.95</td><td rowspan="1" colspan="1">0.85</td></tr><tr><td rowspan="1" colspan="1"><inline-formula><mml:math id="MM12"><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mtext>FP</mml:mtext></mml:mrow><mml:mo stretchy="true">¯</mml:mo></mml:mover><mml:mo>/</mml:mo><mml:mover accent="true"><mml:mrow><mml:mtext>TP</mml:mtext></mml:mrow><mml:mo stretchy="true">¯</mml:mo></mml:mover></mml:mrow></mml:math></inline-formula></td><td rowspan="1" colspan="1">0.81</td><td rowspan="1" colspan="1">0.41</td></tr></tbody></table><table-wrap-foot><fn id="bbv007-TF2"><p>Sensitivity, precision, correlation between true and estimated expression of TP transcripts and <inline-formula><mml:math id="MM13"><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mtext>FP</mml:mtext></mml:mrow><mml:mo stretchy="true">¯</mml:mo></mml:mover><mml:mo>/</mml:mo><mml:mover accent="true"><mml:mrow><mml:mtext>TP</mml:mtext></mml:mrow><mml:mo stretchy="true">¯</mml:mo></mml:mover></mml:mrow></mml:math></inline-formula> for the computational transcriptome reconstruction methods.</p></fn></table-wrap-foot></table-wrap></p>
      <p>For these transcript sets, the correlation between true and estimated expression values of TP transcripts for Cufflinks is 0.95 and for Oases is 0.85 (<xref ref-type="table" rid="bbv007-T2">Table 2</xref>). A lower correlation for the <italic>de novo</italic> set is expected, given that the corresponding transcript set contains more non-existent transcripts, which absorb some of the true expression signal. The correlation for Cufflinks is comparable with that of some of the simulated curated annotation sets.</p>
      <p>The <inline-formula><mml:math id="MM14"><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mtext>FP</mml:mtext></mml:mrow><mml:mo stretchy="true">¯</mml:mo></mml:mover><mml:mo>/</mml:mo><mml:mover accent="true"><mml:mrow><mml:mtext>TP</mml:mtext></mml:mrow><mml:mo stretchy="true">¯</mml:mo></mml:mover></mml:mrow></mml:math></inline-formula> ratio is significantly higher for computational methods than for reference-based methods using annotations with similar accuracy. This is because FP transcripts that are reconstructed from the data are necessarily supported by reads, and thus have expression signal assigned to them, whereas sequence in FP transcripts in a curated annotation set will in general not coincide with read sequence in the data, and so will be assigned low expression values. Cufflinks appears worse in this respect, as on average it assigns the equivalent of 81% of mean TP expression to FP transcripts, while for Oases this value is only 41% (<xref ref-type="table" rid="bbv007-T2">Table 2</xref>). This is consistent with Cufflinks assembling fewer incorrect transcripts than Oases, which concentrates the signal in a smaller number of FP transcripts.</p>
      <p>The correlation of TP transcripts reconstructed by Cufflinks is high relative to the low sensitivity (<italic>s</italic> = 0.36) of the method. As the more highly expressed transcripts are more likely to be reconstructed accurately (<xref ref-type="fig" rid="bbv007-F6">Figure 6</xref>) than the more lowly expressed transcripts and as highly expressed transcripts are easier to estimate accurately (on the logarithmic scale), the result is a high correlation for a small subset of the truly expressed transcripts.
<fig id="bbv007-F6" position="float"><label>Figure 6.</label><caption><p>Estimated expression levels of reconstructed transcripts by Cufflinks. Densities of the log expression estimates of transcripts properly reconstructed and incorrectly reconstructed by Cufflinks (<inline-formula><mml:math id="MM15"><mml:mrow><mml:mi>p</mml:mi><mml:mo>=</mml:mo><mml:mn>2.17</mml:mn><mml:mo>×</mml:mo><mml:msup><mml:mrow><mml:mn>10</mml:mn></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>6</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula>, Kolmogorov–Smirnov test). A colour version of this figure is available at BIB online: <ext-link ext-link-type="uri" xlink:href="http://bib.oxfordjournals.org">http://bib.oxfordjournals.org</ext-link>.</p></caption><graphic xlink:href="bbv007f6p"/></fig>
</p>
      <p>We note that the sampling of TP annotated transcripts in our simulations does not depend on the expression level, which is favourable towards reconstruction methods. As we have shown (<xref ref-type="fig" rid="bbv007-F2">Figure 2</xref>), the annotated fraction of truly expressed transcripts tends to be more highly expressed than the unannotated fraction. Thus, the TP correlations for the annotation-based approach are conservative.</p>
    </sec>
    <sec>
      <title>Transcriptome reference-guided reconstruction provides modest improvements in accuracy of expression estimates</title>
      <p>The Cufflinks + RABT approach supplements a curated annotation transcript set with additional reconstructed transcripts required to explain the data. In our simulation set-up, we consider the range of annotation sets with different sensitivities and precisions, as above. We present two aspects of the results: firstly the effect that RABT has on the sensitivity and precision of the final transcript set, and secondly the correlation between true and estimated expression of the TP transcripts and the overall <inline-formula><mml:math id="MM16"><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mtext>FP</mml:mtext></mml:mrow><mml:mo stretchy="true">¯</mml:mo></mml:mover><mml:mo>/</mml:mo><mml:mover accent="true"><mml:mrow><mml:mtext>TP</mml:mtext></mml:mrow><mml:mo stretchy="true">¯</mml:mo></mml:mover></mml:mrow></mml:math></inline-formula> ratio.</p>
      <p>Supplementing annotated transcripts with reconstructed transcripts using Cufflinks+RABT generally increases sensitivity (the starts and ends of the arrows in <xref ref-type="fig" rid="bbv007-F7">Figure 7</xref> point to the annotated and supplemented sensitivities and precisions, respectively). When using annotations with the lowest sensitivity of <italic>s</italic> = 0.2, RABT roughly doubles sensitivity of the transcript set. The gains in sensitivity decrease substantially as the sensitivity of the annotations increases and are not noticeable beyond <italic>s</italic> = 0.6. Thus, Cufflinks+RABT is no better than an annotation-based approach overall when the sensitivity of annotations is moderate to high.
<fig id="bbv007-F7" position="float"><label>Figure 7.</label><caption><p>Log expression estimates for FP transcripts obtained using RABT. Densities of the log expression estimates of FP transcripts reconstructed by RABT and FP transcripts present in the simulated annotation set used by RABT as a starting point (<italic>s</italic> = 0.6, <italic>p</italic> = 0.4). A colour version of this figure is available at BIB online: <ext-link ext-link-type="uri" xlink:href="http://bib.oxfordjournals.org">http://bib.oxfordjournals.org</ext-link>.</p></caption><graphic xlink:href="bbv007f7p"/></fig>
</p>
      <p>Surprisingly, we also observe decreases in RABT sensitivity (e.g. at <italic>s</italic> = 1.0 and <italic>p</italic> = 0.35), which is inconsistent with the Cufflinks’ manual’s statement that the RABT assembly includes ‘all reference transcripts as well as any novel genes and isoforms that are assembled’. We have found that some of these transcripts are missing from RABT output completely, whereas some are present but are missing short inner exons (and thus cannot be matched back to their true counterparts).</p>
      <p><xref ref-type="table" rid="bbv007-T1">Table 1</xref> shows the expression correlation between true and estimated expression for TP transcripts. There is little improvement in TP transcript correlation using RABT over using annotations alone, except at some of the lowest sensitivity values for the reference annotations.</p>
      <p>RABT leads to a noticeable increase in FP expression compared with using only annotated transcripts (<xref ref-type="table" rid="bbv007-T1">Table 1</xref>). This is similar to what is seen in the reconstruction methods above: by definition FP transcripts constructed by RABT are supported by reads, and so will have higher expression estimates than the FP transcripts in the annotation sets, which in general will not be supported by reads. We look at two components of FP transcripts constructed by RABT: the transcripts have a match with annotation sets and the novel ones constructed by RABT (<xref ref-type="fig" rid="bbv007-F8">Figure 8</xref>). Regardless of the accuracy of the reference annotation, the novel FP transcripts have higher expression estimates than the FP transcripts present in the annotation (<ext-link ext-link-type="uri" xlink:href="http://bib.oxfordjournals.org/lookup/suppl/doi:10.1093/bib/bbv007/-/DC1">Supplementary Note</ext-link>). This is consistent with the principal difference of FP transcripts coming from curated annotations and FP transcripts created by RNA-seq based transcriptome reconstruction methods: FP transcripts inferred by computational methods are (wrongly) supported by the data, making them more difficult to differentiate from TP transcripts than typical FP transcripts from curated annotations, which were derived from independent experiments.
<fig id="bbv007-F8" position="float"><label>Figure 8.</label><caption><p>Sensitivity and precision of starting and final transcript sets obtained by RABT. Arrows start at the sensitivity and precision values of the simulated annotations and point to the final sensitivity and precision of the RABT output. Sensitivity decreases are sometimes observed when the starting sensitivity is &gt;0.8. Values shown are the mean over three independent simulations.</p></caption><graphic xlink:href="bbv007f8p"/></fig>
</p>
    </sec>
  </sec>
  <sec sec-type="discussion">
    <title>Discussion</title>
    <p>We have presented a comparison of analysis approaches for RNA-seq data that use curated annotations, genome-guided reconstruction or <italic>de novo</italic> reconstruction. We have shown that curated annotations lead to more accurate gene expression estimates than transcriptome reconstruction methods, even when the annotations are of fairly low quality.</p>
    <p>The main reason for this conclusion is the low sensitivity and precision of purely computational reconstruction strategies, even when assisted by a reference genome. For both <italic>de novo</italic> and genome-guided read assembly, our simulations show that the sensitivity of computational transcript set estimation saturates at <italic>s</italic> ≃ 0.36 for human RNA-seq data, meaning that many transcripts present in a sample would be missed in reconstruction—a finding that is consistent with the conclusions of [<xref rid="bbv007-B8" ref-type="bibr">8</xref>]. The correlation between simulated and estimated expression values for the correctly reconstructed transcripts is high, but it appears that this is driven by a small number of highly expressed transcripts (see Section 3.3). Further, computational methods introduce a large number of FP transcripts (we find a precision of 0.45 for Cufflinks and 0.17 for Oases). When estimating expression, these FP transcripts absorb a substantial fraction of the overall expression signal. In contrast, even when curated annotation sets contain FP transcripts, they absorb a considerably smaller amount of the expression signal compared with computational methods (∼10% of the TP expression even at extremely low sensitivities). Curated annotations also show good expression correlation even at low sensitivities (&gt;0.8 for an extremely low sensitivity of 0.2). The RABT approach, which supplements a curated annotation with transcripts assembled from the read data, improves sensitivity noticeably only for relatively low baseline sensitivities of the annotation set. FP transcripts introduced by RABT exhibit the same signal absorption properties as FP transcripts of pure computational methods.</p>
    <p>Studies searching for novel elements in a transcriptome that is generally well-annotated may benefit from using a computational reconstruction or a curated annotation approach on a locus-by-locus basis. Specifically, computational reconstructions could be used in cases that strongly contradict curated annotations, such as regions with high RNA-seq counts that have no gene annotations at all and for which an approximate reconstruction would be preferred over no reconstruction at all. A straightforward implementation of this approach would be to filter from RABT output all novel transcripts that overlap known genes. Alternatively, computational predictions could be made more conservative by using reconstructed transcripts detected by several methods [<xref rid="bbv007-B11" ref-type="bibr">11</xref>]. In analyses of data from an unannotated species without a reference genome, the use of curated annotations from a closely related species might be considered. Even if a sizeable number of transcripts differ between species, FP transcripts in the annotations would not be expected to bias expression measurements excessively.</p>
    <p>We have restricted our exposition to a limited number of methods and animal species to assess each RNA-seq analysis strategy. We note that other <italic>de novo</italic> methods, such as the popular Trinity assembler [<xref rid="bbv007-B16" ref-type="bibr">16</xref>], are becoming increasingly refined and widely used. Also, here we have not assessed the relative performance of analysis strategies in plants or bacteria, for example. We have thus made our software freely available so that new methods and species may be assessed systematically in future under a controlled simulation set-up.</p>
    <p>Our results suggest that, despite valiant efforts, accurate estimation of the transcripts sequences in RNA samples will ultimately rely on emerging fragmentation-free sequencing technology in which read lengths can match transcript lengths. However, as the throughput of such technologies is at present still relatively low, this step may require removal of highly expressed transcripts using custom oligonucleotide capture kits [<xref rid="bbv007-B14" ref-type="bibr">14</xref>] to ensure lowly expressed transcripts are sequenced. The use of long read technology to identify the distinct set of transcripts in a sample combined with high-throughput short read technology to estimate expression levels may be the optimal approach for the time being for accurate characterization of RNA samples.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary data</title>
    <p><ext-link ext-link-type="uri" xlink:href="http://bib.oxfordjournals.org/lookup/suppl/doi:10.1093/bib/bbv007/-/DC1">Supplementary data</ext-link> are available online at <ext-link ext-link-type="uri" xlink:href="http://bib.oxfordjournals.org/">http://bib.oxfordjournals.org/</ext-link>.</p>
    <p>
      <boxed-text id="bbv007-BOX1" position="float">
        <caption>
          <title>Key Points</title>
        </caption>
        <p>
          <list list-type="bullet">
            <list-item>
              <p>We have surveyed the three main approaches to selecting transcripts for expression estimation using RNA-seq data: reliance on database annotations, genome-guided assembly and <italic>de novo</italic> assembly.</p>
            </list-item>
            <list-item>
              <p>The sensitivity and precision of computational approaches—both genome-guided and <italic>de novo</italic> transcriptome assembly—are severely limited.</p>
            </list-item>
            <list-item>
              <p>Assembled artefactual transcripts absorb a substantial proportion of the expression signal, whereas incorrect transcripts appearing in a reference set do not absorb much signal. Thus, it is preferable to use reference sets with high sensitivity rather than with high precision. Furthermore, approaches based on annotations show good expression correlation even when annotations are incomplete.</p>
            </list-item>
            <list-item>
              <p>We have developed free software to simulate transcript sets, expression values and sequence reads under a wider range of parameter values and to compare sensitivity, precision and signal-to-noise ratios of different methods.</p>
            </list-item>
            <list-item>
              <p>Accurate estimation of the transcripts sequences in RNA samples will ultimately depend on emerging fragmentation-free long-read sequencing technology.</p>
            </list-item>
          </list>
        </p>
      </boxed-text>
    </p>
    <supplementary-material id="PMC_1" content-type="local-data">
      <caption>
        <title>Supplementary Data</title>
      </caption>
      <media mimetype="text" mime-subtype="html" xlink:href="supp_16_6_932__index.html"/>
      <media xlink:role="associated-file" mimetype="application" mime-subtype="pdf" xlink:href="supp_bbv007_S1.pdf"/>
    </supplementary-material>
  </sec>
</body>
<back>
  <ack>
    <title>Acknowledgements</title>
    <p>The authors thank Myrto Kostadima for helpful feedback on a draft of their manuscript.</p>
  </ack>
  <bio id="d35e38">
    <p><bold>Jürgen Jänes</bold> is a PhD student enrolled in the Wellcome Trust Mathematical Genomics and Medicine programme.</p>
  </bio>
  <bio id="d35e51">
    <p><bold>Fengyuan Hu</bold> is a scientific programmer in the Department of Haematology, University of Cambridge.</p>
  </bio>
  <bio id="d35e62">
    <p><bold>Alexandra Lewin</bold> is a Lecturer in Biostatistics at the Department of Epidemiology and Biostatistics, Imperial College London.</p>
  </bio>
  <bio id="d35e73">
    <p><bold>Ernest Turro</bold> is a Senior Research Associate at the Department of Haematology, University of Cambridge and Visiting Worker at the MRC Biostatistics Unit. He has developed statistical methods for analysing RNA sequencing data and has co-authored a book chapter on the subject with Alexandra Lewin. Over the past 5 years, he has taught bioinformatics on numerous courses in the UK and abroad.</p>
  </bio>
  <sec>
    <title>Funding</title>
    <p>This work was supported by the <funding-source>Wellcome Trust</funding-source> (<award-id>WT097679</award-id>); the <funding-source>Cambridge Biomedical Research Centre</funding-source>; <funding-source>Cancer Research UK</funding-source> (<award-id>C14303/A10825</award-id>) and the <funding-source>Medical Research Council</funding-source> (<award-id>G1002319</award-id>).</p>
  </sec>
  <ref-list>
    <title>References</title>
    <ref id="bbv007-B1">
      <label>1</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Tilgner</surname><given-names>H</given-names></name><name><surname>Grubert</surname><given-names>F</given-names></name><name><surname>Sharon</surname><given-names>D</given-names></name><etal/></person-group><article-title>Defining a personal, allele-specific, and single-molecule long-read transcriptome</article-title>. <source>Proc Natl Acad Sci USA</source><year>2014</year>;<volume>111</volume>(<issue>27</issue>):<fpage>9869</fpage>–<lpage>74</lpage>.<pub-id pub-id-type="pmid">24961374</pub-id></mixed-citation>
    </ref>
    <ref id="bbv007-B2">
      <label>2</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Garber</surname><given-names>M</given-names></name><name><surname>Grabherr</surname><given-names>MG</given-names></name><name><surname>Guttman</surname><given-names>M</given-names></name><etal/></person-group><article-title>Computational methods for transcriptome annotation and quantification using RNA-seq</article-title>. <source>Nat Methods</source><year>2011</year>;<volume>8</volume>(<issue>6</issue>):<fpage>469</fpage>–<lpage>77</lpage>.<pub-id pub-id-type="pmid">21623353</pub-id></mixed-citation>
    </ref>
    <ref id="bbv007-B3">
      <label>3</label>
      <mixed-citation publication-type="book"><person-group person-group-type="author"><name><surname>Turro</surname><given-names>E</given-names></name><name><surname>Lewin</surname><given-names>A</given-names></name></person-group><article-title>Statistical analysis of mapped reads from mRNA-seq data, Chapter 4</article-title>. In: <person-group person-group-type="editor"><name><surname>Do</surname><given-names>KA</given-names></name><name><surname>Qin</surname><given-names>S</given-names></name><name><surname>Vannucci</surname><given-names>M</given-names></name></person-group> (eds). <publisher-loc>Cambridge, UK</publisher-loc>: <publisher-name>Cambridge University Press</publisher-name>, <year>2013</year>.</mixed-citation>
    </ref>
    <ref id="bbv007-B4">
      <label>4</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Flicek</surname><given-names>P</given-names></name><name><surname>Aken</surname><given-names>BL</given-names></name><name><surname>Ballester</surname><given-names>B</given-names></name><etal/></person-group><article-title>Ensembl’s 10th year</article-title>. <source>Nucleic Acids Res</source><year>2009</year>;<volume>38</volume>:<fpage>D557</fpage>–<lpage>62</lpage>.<pub-id pub-id-type="pmid">19906699</pub-id></mixed-citation>
    </ref>
    <ref id="bbv007-B5">
      <label>5</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Trapnell</surname><given-names>C</given-names></name><name><surname>Williams</surname><given-names>BA</given-names></name><name><surname>Pertea</surname><given-names>G</given-names></name><etal/></person-group><article-title>Transcript assembly and quantification by RNA-Seq reveals unannotated transcripts and isoform switching during cell differentiation</article-title>. <source>Nat Biotechnol</source><year>2010</year>;<volume>28</volume>(<issue>5</issue>):<fpage>511</fpage>–<lpage>15</lpage>.<pub-id pub-id-type="pmid">20436464</pub-id></mixed-citation>
    </ref>
    <ref id="bbv007-B6">
      <label>6</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Guttman</surname><given-names>M</given-names></name><name><surname>Garber</surname><given-names>M</given-names></name><name><surname>Levin</surname><given-names>JZ</given-names></name><etal/></person-group><article-title><italic>Ab initio</italic> reconstruction of cell type-specific transcriptomes in mouse reveals the conserved multi-exonic structure of lincRNAs</article-title>. <source>Nat Biotechnol</source><year>2010</year>;<volume>28</volume>(<issue>5</issue>)<comment>L:503–10</comment>.</mixed-citation>
    </ref>
    <ref id="bbv007-B7">
      <label>7</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Robertson</surname><given-names>G</given-names></name><name><surname>Schein</surname><given-names>J</given-names></name><name><surname>Chiu</surname><given-names>R</given-names></name><etal/></person-group><article-title><italic>De novo</italic> assembly and analysis of RNA-seq data</article-title>. <source>Nat Methods</source><year>2010</year>;<volume>7</volume>(<issue>11</issue>):<fpage>909</fpage>–<lpage>12</lpage>.<pub-id pub-id-type="pmid">20935650</pub-id></mixed-citation>
    </ref>
    <ref id="bbv007-B8">
      <label>8</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Steijger</surname><given-names>T</given-names></name><name><surname>Abril</surname><given-names>JF</given-names></name><name><surname>Engström</surname><given-names>PG</given-names></name><etal/></person-group><article-title>Assessment of transcript reconstruction methods for RNA-seq</article-title>. <source>Nat Methods</source><year>2013</year>;<volume>10</volume>:<fpage>1177</fpage>–<lpage>84</lpage>. <comment>ISSN: 1548-7091</comment>.<pub-id pub-id-type="pmid">24185837</pub-id></mixed-citation>
    </ref>
    <ref id="bbv007-B9">
      <label>9</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Sipos</surname><given-names>B</given-names></name><name><surname>Slodkowicz</surname><given-names>G</given-names></name><name><surname>Massingham</surname><given-names>T</given-names></name><etal/></person-group><article-title>Realistic simulations reveal extensive sample-specificity of RNA-seq biases</article-title>. <source>arXiv preprint arXiv</source><year>2013</year>;<comment>1308.3172</comment>.</mixed-citation>
    </ref>
    <ref id="bbv007-B10">
      <label>10</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Griebel</surname><given-names>T</given-names></name><name><surname>Zacher</surname><given-names>B</given-names></name><name><surname>Ribeca</surname><given-names>P</given-names></name><etal/></person-group><article-title>Modelling and simulating generic RNA-seq experiments with the flux simulator</article-title>. <source>Nucleic Acids Res</source><year>2012</year>;<volume>40</volume>(<issue>20</issue>):<fpage>10073</fpage>–<lpage>83</lpage>.<pub-id pub-id-type="pmid">22962361</pub-id></mixed-citation>
    </ref>
    <ref id="bbv007-B11">
      <label>11</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Schulz</surname><given-names>MH</given-names></name><name><surname>Zerbino</surname><given-names>DR</given-names></name><name><surname>Vingron</surname><given-names>M</given-names></name><etal/></person-group><article-title>Oases: robust de novo RNA-seq assembly across the dynamic range of expression levels</article-title>. <source>Bioinformatics</source><year>2012</year>;<volume>28</volume>(<issue>8</issue>):<fpage>1086</fpage>–<lpage>92</lpage>.<pub-id pub-id-type="pmid">22368243</pub-id></mixed-citation>
    </ref>
    <ref id="bbv007-B12">
      <label>12</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Turro</surname><given-names>E</given-names></name><name><surname>Su</surname><given-names>SY</given-names></name><name><surname>Goncalves</surname><given-names>A</given-names></name><etal/></person-group><article-title>Haplotype and isoform specific expression estimation using multi-mapping RNA-seq reads</article-title>. <source>Genome Biol</source><year>2011</year>;<volume>12</volume>(<issue>2</issue>):<fpage>R13</fpage>.<pub-id pub-id-type="pmid">21310039</pub-id></mixed-citation>
    </ref>
    <ref id="bbv007-B13">
      <label>13</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Roberts</surname><given-names>A</given-names></name><name><surname>Pimentel</surname><given-names>H</given-names></name><name><surname>Trapnell</surname><given-names>C</given-names></name><etal/></person-group><article-title>Identification of novel transcripts in annotated genomes using RNA-seq</article-title>. <source>Bioinformatics</source><year>2011</year>;<volume>27</volume>:<fpage>2325</fpage>–<lpage>9</lpage>. <comment>ISSN: 13674803</comment>.<pub-id pub-id-type="pmid">21697122</pub-id></mixed-citation>
    </ref>
    <ref id="bbv007-B14">
      <label>14</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Labaj</surname><given-names>PP</given-names></name><name><surname>Leparc</surname><given-names>GG</given-names></name><name><surname>Linggi</surname><given-names>BE</given-names></name><etal/></person-group><article-title>Characterization and improvement of RNA-Seq precision in quantitative transcript expression profiling</article-title>. <source>Bioinformatics</source><year>2011</year>;<volume>27</volume>(<issue>13</issue>):<fpage>i383</fpage>–<lpage>91</lpage>.<pub-id pub-id-type="pmid">21685096</pub-id></mixed-citation>
    </ref>
    <ref id="bbv007-B15">
      <label>15</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Pruitt</surname><given-names>KD</given-names></name><name><surname>Tatusova</surname><given-names>T</given-names></name><name><surname>Brown</surname><given-names>GR</given-names></name><etal/></person-group><article-title>NCBI Reference Sequences (RefSeq): current status, new features and genome annotation policy</article-title>. <source>Nucleic Acids Res</source><year>2012</year>;<volume>40</volume>(<issue>D1</issue>):<fpage>D130</fpage>–<lpage>5</lpage>.<pub-id pub-id-type="pmid">22121212</pub-id></mixed-citation>
    </ref>
    <ref id="bbv007-B16">
      <label>16</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Grabherr</surname><given-names>MG</given-names></name><name><surname>Haas</surname><given-names>BJ</given-names></name><name><surname>Yassour</surname><given-names>M</given-names></name><etal/></person-group><article-title>Full-length transcriptome assembly from rna-seq data without a reference genome</article-title>. <source>Nat Biotechnol</source><year>2011</year>;<volume>29</volume>(<issue>7</issue>):<fpage>644</fpage>–<lpage>52</lpage>.<pub-id pub-id-type="pmid">21572440</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
