<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName A++V2.4.dtd?>
<?SourceDTD.Version 2.4?>
<?ConverterInfo.XSLTName springer2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Nat Commun</journal-id>
    <journal-id journal-id-type="iso-abbrev">Nat Commun</journal-id>
    <journal-title-group>
      <journal-title>Nature Communications</journal-title>
    </journal-title-group>
    <issn pub-type="epub">2041-1723</issn>
    <publisher>
      <publisher-name>Nature Publishing Group UK</publisher-name>
      <publisher-loc>London</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">7058077</article-id>
    <article-id pub-id-type="publisher-id">14766</article-id>
    <article-id pub-id-type="doi">10.1038/s41467-020-14766-3</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Article</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Trajectory-based differential expression analysis for single-cell sequencing data</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-1833-8478</contrib-id>
        <name>
          <surname>Van den Berge</surname>
          <given-names>Koen</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff2">2</xref>
        <xref ref-type="aff" rid="Aff3">3</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Roux de Bézieux</surname>
          <given-names>Hector</given-names>
        </name>
        <xref ref-type="aff" rid="Aff4">4</xref>
        <xref ref-type="aff" rid="Aff5">5</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Street</surname>
          <given-names>Kelly</given-names>
        </name>
        <xref ref-type="aff" rid="Aff6">6</xref>
        <xref ref-type="aff" rid="Aff7">7</xref>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-7114-6248</contrib-id>
        <name>
          <surname>Saelens</surname>
          <given-names>Wouter</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff8">8</xref>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0003-3641-729X</contrib-id>
        <name>
          <surname>Cannoodt</surname>
          <given-names>Robrecht</given-names>
        </name>
        <xref ref-type="aff" rid="Aff8">8</xref>
        <xref ref-type="aff" rid="Aff9">9</xref>
        <xref ref-type="aff" rid="Aff10">10</xref>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-0415-1506</contrib-id>
        <name>
          <surname>Saeys</surname>
          <given-names>Yvan</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff8">8</xref>
      </contrib>
      <contrib contrib-type="author" corresp="yes" equal-contrib="yes">
        <name>
          <surname>Dudoit</surname>
          <given-names>Sandrine</given-names>
        </name>
        <address>
          <email>sandrine@stat.berkeley.edu</email>
        </address>
        <xref ref-type="aff" rid="Aff3">3</xref>
        <xref ref-type="aff" rid="Aff4">4</xref>
        <xref ref-type="aff" rid="Aff5">5</xref>
      </contrib>
      <contrib contrib-type="author" corresp="yes" equal-contrib="yes">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-9050-4370</contrib-id>
        <name>
          <surname>Clement</surname>
          <given-names>Lieven</given-names>
        </name>
        <address>
          <email>lieven.clement@ugent.be</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <aff id="Aff1"><label>1</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0001 2069 7798</institution-id><institution-id institution-id-type="GRID">grid.5342.0</institution-id><institution>Department of Applied Mathematics, Computer Science and Statistics, </institution><institution>Ghent University, </institution></institution-wrap>Ghent, Belgium </aff>
      <aff id="Aff2"><label>2</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0001 2069 7798</institution-id><institution-id institution-id-type="GRID">grid.5342.0</institution-id><institution>Bioinformatics Institute Ghent, </institution><institution>Ghent University, </institution></institution-wrap>Ghent, Belgium </aff>
      <aff id="Aff3"><label>3</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0001 2181 7878</institution-id><institution-id institution-id-type="GRID">grid.47840.3f</institution-id><institution>Department of Statistics, </institution><institution>University of California, </institution></institution-wrap>Berkeley, CA USA </aff>
      <aff id="Aff4"><label>4</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0001 2181 7878</institution-id><institution-id institution-id-type="GRID">grid.47840.3f</institution-id><institution>Division of Biostatistics, School of Public Health, </institution><institution>University of California, </institution></institution-wrap>Berkeley, CA USA </aff>
      <aff id="Aff5"><label>5</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0001 2181 7878</institution-id><institution-id institution-id-type="GRID">grid.47840.3f</institution-id><institution>Center for Computational Biology, </institution><institution>University of California, </institution></institution-wrap>Berkeley, CA USA </aff>
      <aff id="Aff6"><label>6</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0001 2106 9910</institution-id><institution-id institution-id-type="GRID">grid.65499.37</institution-id><institution>Department of Data Sciences, </institution><institution>Dana-Farber Cancer Institute, </institution></institution-wrap>Boston, MA USA </aff>
      <aff id="Aff7"><label>7</label><institution-wrap><institution-id institution-id-type="ISNI">000000041936754X</institution-id><institution-id institution-id-type="GRID">grid.38142.3c</institution-id><institution>Department of Biostatistics, </institution><institution>Harvard T.H. Chan School of Public Health, </institution></institution-wrap>Boston, MA USA </aff>
      <aff id="Aff8"><label>8</label><institution-wrap><institution-id institution-id-type="ISNI">0000000104788040</institution-id><institution-id institution-id-type="GRID">grid.11486.3a</institution-id><institution>Data mining and Modelling for Biomedicine, </institution><institution>VIB Center for Inflammation Research, </institution></institution-wrap>Ghent, Belgium </aff>
      <aff id="Aff9"><label>9</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0004 0626 3303</institution-id><institution-id institution-id-type="GRID">grid.410566.0</institution-id><institution>Center for Medical Genetics, </institution><institution>Ghent University Hospital, </institution></institution-wrap>Ghent, Belgium </aff>
      <aff id="Aff10"><label>10</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0001 2069 7798</institution-id><institution-id institution-id-type="GRID">grid.5342.0</institution-id><institution>Department of Biomolecular Medicine, </institution><institution>Ghent University, </institution></institution-wrap>Ghent, Belgium </aff>
    </contrib-group>
    <pub-date pub-type="epub">
      <day>5</day>
      <month>3</month>
      <year>2020</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>5</day>
      <month>3</month>
      <year>2020</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2020</year>
    </pub-date>
    <volume>11</volume>
    <elocation-id>1201</elocation-id>
    <history>
      <date date-type="received">
        <day>30</day>
        <month>4</month>
        <year>2019</year>
      </date>
      <date date-type="accepted">
        <day>14</day>
        <month>1</month>
        <year>2020</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2020</copyright-statement>
      <license license-type="OpenAccess">
        <license-p><bold>Open Access</bold> This article is licensed under a Creative Commons Attribution 4.0 International License, which permits use, sharing, adaptation, distribution and reproduction in any medium or format, as long as you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons license, and indicate if changes were made. The images or other third party material in this article are included in the article’s Creative Commons license, unless indicated otherwise in a credit line to the material. If material is not included in the article’s Creative Commons license and your intended use is not permitted by statutory regulation or exceeds the permitted use, you will need to obtain permission directly from the copyright holder. To view a copy of this license, visit <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>.</license-p>
      </license>
    </permissions>
    <abstract id="Abs1">
      <p id="Par1">Trajectory inference has radically enhanced single-cell RNA-seq research by enabling the study of dynamic changes in gene expression. Downstream of trajectory inference, it is vital to discover genes that are (i) associated with the lineages in the trajectory, or (ii) differentially expressed between lineages, to illuminate the underlying biological processes. Current data analysis procedures, however, either fail to exploit the continuous resolution provided by trajectory inference, or fail to pinpoint the exact types of differential expression. We introduce tradeSeq, a powerful generalized additive model framework based on the negative binomial distribution that allows flexible inference of both within-lineage and between-lineage differential expression. By incorporating observation-level weights, the model additionally allows to account for zero inflation. We evaluate the method on simulated datasets and on real datasets from droplet-based and full-length protocols, and show that it yields biological insights through a clear interpretation of the data.</p>
    </abstract>
    <abstract id="Abs2" abstract-type="web-summary">
      <p id="Par2">Downstream of trajectory inference for cell lineages based on scRNA-seq data, differential expression analysis yields insight into biological processes. Here, Van den Berge et al. develop tradeSeq, a framework for the inference of within and between-lineage differential expression, based on negative binomial generalized additive models.</p>
    </abstract>
    <kwd-group kwd-group-type="npg-subject">
      <title>Subject terms</title>
      <kwd>Software</kwd>
      <kwd>Statistical methods</kwd>
      <kwd>RNA sequencing</kwd>
      <kwd>Transcriptomics</kwd>
    </kwd-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">https://doi.org/10.13039/100001491</institution-id>
            <institution>Belgian American Educational Foundation (Belgian American Educational Foundation Inc.)</institution>
          </institution-wrap>
        </funding-source>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">https://doi.org/10.13039/501100003130</institution-id>
            <institution>Fonds Wetenschappelijk Onderzoek (Research Foundation Flanders)</institution>
          </institution-wrap>
        </funding-source>
        <award-id>G062219N</award-id>
        <award-id>1246220N</award-id>
        <award-id>148095</award-id>
        <award-id>G062219N</award-id>
        <principal-award-recipient>
          <name>
            <surname>Van den Berge</surname>
            <given-names>Koen</given-names>
          </name>
          <name>
            <surname>Clement</surname>
            <given-names>Lieven</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
    </funding-group>
    <custom-meta-group>
      <custom-meta>
        <meta-name>issue-copyright-statement</meta-name>
        <meta-value>© The Author(s) 2020</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec id="Sec1" sec-type="introduction">
    <title>Introduction</title>
    <p id="Par3">Single-cell transcriptome sequencing (scRNA-seq) has revolutionized modern biology by allowing researchers to profile transcript abundance at the resolution of an individual cell. This has opened new avenues of research to study cellular pathways during the cell cycle, cell-type differentiation, or cellular activation. Indeed, scRNA-seq can provide a snapshot of the transcriptome of thousands of single cells in a cell population, which are each at distinct points of the dynamic process under study. This wealth of transcriptional information, however, presents many data analysis challenges. Until recently, statistical and computational efforts have focused mostly on trajectory inference (TI) methods, which aim to first allocate cells to lineages and then order them based on pseudotimes within these lineages. A wide range of TI methods have been proposed; 45 of which are extensively benchmarked in Saelens et al.<sup><xref ref-type="bibr" rid="CR1">1</xref></sup>. Note that we use the term ‘trajectory’ to refer to the collection of ‘lineages’ for the process under study.</p>
    <p id="Par4">Most TI methods share a common workflow: dimensionality reduction followed by inference of lineages and pseudotimes in the reduced dimensional space<sup><xref ref-type="bibr" rid="CR2">2</xref></sup>. In that reduced dimensional space, a cell’s pseudotime for a given lineage is the distance, along the lineage, between the cell and the origin of the lineage. As such, while pseudotime can be interpreted as an increasing function of true chronological time, there is no guarantee that the two follow a linear relationship. Recent developments have allowed the inference of complex trajectories<sup><xref ref-type="bibr" rid="CR3">3</xref>–<xref ref-type="bibr" rid="CR5">5</xref></sup>. These advances enable researchers to study dynamic biological processes, such as complex differentiation patterns from a progenitor population to multiple differentiated cellular states<sup><xref ref-type="bibr" rid="CR6">6</xref>,<xref ref-type="bibr" rid="CR7">7</xref></sup>, and have the promise to provide transcriptome-wide insights into these processes.</p>
    <p id="Par5">Unfortunately, statistical inference methods are lacking to identify genes associated with lineage differentiation and to unravel how their corresponding transcriptional profiles are driving the dynamic processes under study. Indeed, differential expression (DE) analysis of individual genes along lineages is often performed on discrete groups of cells in the developmental pathway, e.g., by comparing clusters of cells along the trajectory or clusters of differentiated cell types. Such discrete DE approaches do not exploit the continuous expression resolution that can be obtained from the pseudotemporal ordering of cells along lineages provided by TI methods. Moreover, comparing cell clusters within or between lineages can obscure interpretation: it is often unclear which clusters should be compared, how to properly combine the results of several pairwise cluster comparisons, or how to account for the fact that not all of these comparisons are independent of each other.</p>
    <p id="Par6">A number of methods have been developed for the analysis of bulk RNA-seq time-series data, which can exploit the temporal resolution of samples assayed at different times<sup><xref ref-type="bibr" rid="CR8">8</xref>–<xref ref-type="bibr" rid="CR10">10</xref></sup>. However, in scRNA-seq, the relationship between gene expression and pseudotime is more complex. In addition, the pseudotimes are continuous, and cells are never at the exact same pseudotime value.</p>
    <p id="Par7">A few methods have been published with the aim of improving trajectory-based differential expression analysis by modeling gene expression as a smooth function of pseudotime along lineages. Monocle<sup><xref ref-type="bibr" rid="CR11">11</xref></sup> tests whether gene expression is associated with pseudotime by fitting additive models of gene expression as a function of pseudotime. However, the method can only handle a single lineage. A similar approach has been adopted by TSCAN<sup><xref ref-type="bibr" rid="CR12">12</xref></sup>. GPfates<sup><xref ref-type="bibr" rid="CR4">4</xref></sup> relies on a mixture of overlapping Gaussian processes<sup><xref ref-type="bibr" rid="CR13">13</xref></sup>, where each component of the mixture model represents a different lineage. For each gene, the method tests whether a model with a bifurcation significantly increases the likelihood of the data as compared with a model without a bifurcation, essentially testing whether gene expression is differentially associated with the two lineages. Similarly, the BEAM approach in Monocle 2<sup><xref ref-type="bibr" rid="CR5">5</xref></sup> allows users to test whether differences in gene expression are associated with particular branching events on the trajectory. These trajectory-based methods improve upon discrete cluster-based approaches by (1) exploiting the continuous expression resolution along the trajectory and (2) comparing lineages using a single test based on entire gene expression profiles. However, both GPfates and Monocle 2 lack interpretability, as they cannot pinpoint the regions of the gene expression profiles that are responsible for the differences in expression between lineages. Moreover, the GPfates model is restricted to trajectories consisting of just one bifurcation, essentially precluding its application to biological systems with more than two lineages (i.e., a multifurcation or more than one bifurcation). BEAM is restricted to the few dimensionality reduction methods that are implemented in the Monocle 2 software, namely, independent component analysis (ICA) and DDRTree<sup><xref ref-type="bibr" rid="CR5">5</xref></sup>. Hence, novel methods to infer differences in gene expression patterns within or between transcriptional lineages with complex branching patterns are vital to further advance the field.</p>
    <p id="Par8">In this paper, we introduce tradeSeq, a method and software package for trajectory-based differential <bold>e</bold>xpression analysis for sequencing data. tradeSeq provides a flexible framework that can be used downstream of any dimensionality reduction and TI method. Unlike previously proposed approaches, tradeSeq provides several tests that each identify a distinct type of differential expression pattern along a lineage or between lineages, leading to clear interpretation of the results (Fig. <xref rid="Fig1" ref-type="fig">1</xref>). In practice, tradeSeq infers smooth functions for the gene expression measures along pseudotime for each lineage using generalized additive models and tests biologically meaningful hypotheses based on parameters of these smoothers. By allowing cell-level weights for each individual count in the gene-by-cell expression matrix, tradeSeq can handle zero inflation, which is essential for dealing with dropouts in full-length scRNA-seq protocols<sup><xref ref-type="bibr" rid="CR14">14</xref></sup>. As it is agnostic to the dimensionality reduction and TI methodology, the approach scales from simple to complex trajectories with multiple bifurcations: tradeSeq only requires the original expression count matrix of the individual cells, estimated pseudotimes, and a hard or soft assignment (weights) of the cells to the lineages to infer the lineage-specific smoothers. We benchmark our method against current state-of-the-art methods using simulated data sets (with cyclic, bifurcating, and multifurcating trajectories) and demonstrate its functionality and versatility on four real data sets. These case studies highlight the enhanced interpretability of tradeSeq’s results, which lead to improved understanding of the underlying biology.<fig id="Fig1"><label>Fig. 1</label><caption><title>Overview of tradeSeq functionality.</title><p><bold>a</bold> A scatterplot of expression measures vs. pseudotimes for a single gene, where each lineage is represented by a different color (top left). <bold>b</bold> A negative binomial generalized additive model (NB-GAM) is fitted using the fitGAM function. The locations of the knots for the splines are displayed with gray dashed vertical lines. <bold>c</bold> The NB-GAM can then be used to perform a variety of tests of differential expression within or between lineages. In the table, we assume that the earlyDETest is used to assess differences in expression patterns early on in the lineage, e.g., with option knots = c(1, 2), meaning that we test for differential patterns between the first and second dashed gray lines from panel (<bold>b</bold>). <bold>d</bold> Interesting genes can finally be clustered to display the different patterns of expression.</p></caption><graphic xlink:href="41467_2020_14766_Fig1_HTML" id="d29e489"/></fig></p>
  </sec>
  <sec id="Sec2" sec-type="results">
    <title>Results</title>
    <sec id="Sec3">
      <title>Statistical model and inference using tradeSeq</title>
      <p id="Par9">We model gene expression measures as nonlinear functions of pseudotime using a generalized additive model (GAM). In the GAM, each lineage is represented by a separate cubic smoothing spline, and the flexibility of GAMs allows us to adjust for other covariates or confounders as fixed effects in the model. The read counts <italic>Y</italic><sub><italic>g</italic><italic>i</italic></sub>, for a given gene <italic>g</italic> ∈ {1, …, <italic>G</italic>} across cells <italic>i</italic> ∈ {1, …, <italic>n</italic>} are modeled using a negative binomial GAM (NB-GAM) with cell and gene-specific means <italic>μ</italic><sub><italic>g</italic><italic>i</italic></sub> and gene-specific dispersion parameters <italic>ϕ</italic><sub><italic>g</italic></sub>:<disp-formula id="Equ1"><label>1</label><alternatives><tex-math id="M1">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\left\{\begin{array}{lll}{Y}_{gi} \sim NB({\mu }_{gi},{\phi }_{g})\\ {\mathrm{log}}\,({\mu }_{gi})={\eta }_{gi} \quad \\ {\eta }_{gi}=\sum _{l=1}^{L}{s}_{gl}({T}_{li}){Z}_{li}+{{\bf{U}}}_{i}{{\boldsymbol{\alpha }}}_{g}+{\mathrm{log}}\,({N}_{i}).\end{array}\right.$$\end{document}</tex-math><mml:math id="M2"><mml:mfenced close="" open="{" separators=""><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="left"><mml:msub><mml:mrow><mml:mi>Y</mml:mi></mml:mrow><mml:mrow><mml:mi>g</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>~</mml:mo><mml:mi>N</mml:mi><mml:mi>B</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mi>g</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>ϕ</mml:mi></mml:mrow><mml:mrow><mml:mi>g</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:mi mathvariant="normal">log</mml:mi><mml:mspace width="0.25em"/><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mi>g</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>η</mml:mi></mml:mrow><mml:mrow><mml:mi>g</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mspace width="1.0em"/></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:msub><mml:mrow><mml:mi>η</mml:mi></mml:mrow><mml:mrow><mml:mi>g</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:munderover accent="false" accentunder="false"><mml:mrow><mml:mo mathsize="big"> ∑</mml:mo></mml:mrow><mml:mrow><mml:mi>l</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>L</mml:mi></mml:mrow></mml:munderover><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi>g</mml:mi><mml:mi>l</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:msub><mml:mrow><mml:mi>Z</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold">U</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">α</mml:mi></mml:mrow><mml:mrow><mml:mi>g</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mi mathvariant="normal">log</mml:mi><mml:mspace width="0.25em"/><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mfenced></mml:math><graphic xlink:href="41467_2020_14766_Article_Equ1.gif" position="anchor"/></alternatives></disp-formula>The gene-wise additive predictor <italic>η</italic><sub><italic>g</italic><italic>i</italic></sub> consists of lineage-specific smoothing splines <italic>s</italic><sub><italic>g</italic><italic>l</italic></sub>, that are functions of pseudotime <italic>T</italic><sub><italic>l</italic><italic>i</italic></sub>, for lineages <italic>l</italic> ∈ {1, …, <italic>L</italic>}. The binary matrix <bold>Z</bold> = (<italic>Z</italic><sub><italic>l</italic><italic>i</italic></sub> ∈ {0, 1}:  <italic>l</italic> ∈ {1, …, <italic>L</italic>}, <italic>i</italic> ∈ {1, …, <italic>n</italic>}) assigns every cell to a particular lineage based on user-supplied weights (e.g., from slingshot<sup><xref ref-type="bibr" rid="CR3">3</xref></sup> or GPfates<sup><xref ref-type="bibr" rid="CR4">4</xref></sup>, see details in Supplementary Methods). We let <inline-formula id="IEq1"><alternatives><tex-math id="M3">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{\mathcal{L}}}_{l}=\{i:{Z}_{li}=1\}$$\end{document}</tex-math><mml:math id="M4"><mml:msub><mml:mrow><mml:mi class="MJX-tex-caligraphic" mathvariant="script">L</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>:</mml:mo><mml:msub><mml:mrow><mml:mi>Z</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>}</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="41467_2020_14766_Article_IEq1.gif"/></alternatives></inline-formula> denote the set of cells assigned to lineage <italic>l</italic>. In addition, we allow the inclusion of <italic>p</italic> known cell-level covariates (e.g., batch, age, or gender), represented by an <italic>n</italic> × <italic>p</italic> matrix <bold>U</bold>, with <italic>i</italic>th row <bold>U</bold><sub><italic>i</italic></sub> corresponding to the <italic>i</italic>th cell, and regression parameters <bold>α</bold><sub><italic>g</italic></sub> of dimension <italic>p</italic> × 1. Differences in sequencing depth or capture efficiency between cells are accounted for by cell-specific offsets <italic>N</italic><sub><italic>i</italic></sub>.</p>
      <p id="Par10">The smoothing spline <italic>s</italic><sub><italic>g</italic><italic>l</italic></sub>, for a given gene <italic>g</italic> and lineage <italic>l</italic>, can be represented as a linear combination of <italic>K</italic> cubic basis functions,<disp-formula id="Equ2"><label>2</label><alternatives><tex-math id="M5">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${s}_{gl}(t)=\sum _{k=1}^{K}{b}_{k}(t){\beta }_{glk},$$\end{document}</tex-math><mml:math id="M6"><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi>g</mml:mi><mml:mi>l</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:munderover accent="false" accentunder="false"><mml:mrow><mml:mo mathsize="big"> ∑</mml:mo></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>K</mml:mi></mml:mrow></mml:munderover><mml:msub><mml:mrow><mml:mi>b</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:msub><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:mi>g</mml:mi><mml:mi>l</mml:mi><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo></mml:math><graphic xlink:href="41467_2020_14766_Article_Equ2.gif" position="anchor"/></alternatives></disp-formula>where the cubic basis functions <italic>b</italic><sub><italic>k</italic></sub>(<italic>t</italic>) are enforced to be the same for all genes and lineages.</p>
      <p id="Par11">Since a separate smoothing spline is estimated for every lineage in the trajectory, we can assess DE within or between lineages by comparing the parameters <italic>β</italic><sub><italic>g</italic><italic>l</italic><italic>k</italic></sub> of these smoothing splines, see “Methods” for details. In tradeSeq, we have implemented Wald tests to assess DE and provide a range of different testing procedures that allow biologists to interpret complex trajectories in dynamic biological systems (see Fig. <xref rid="Fig2" ref-type="fig">2</xref>).<fig id="Fig2"><label>Fig. 2</label><caption><title>Tests currently implemented in the tradeSeq package.</title><p>Each column corresponds to a test. Tests are broken down into two categories, depending on whether they concern a within-lineage comparison, i.e., properties of the orange curve, or a between-lineage comparison, i.e., contrasting the blue and orange curves. For each test, we have two toy examples of gene expression patterns. The top one corresponds to a differentially expressed gene according to the test, while the bottom one does not.</p></caption><graphic xlink:href="41467_2020_14766_Fig2_HTML" id="d29e989"/></fig></p>
    </sec>
    <sec id="Sec4">
      <title>Simulation study</title>
      <p id="Par12">To benchmark relevant differential expression methods, we generated multiple data sets, spanning three distinct trajectory topologies (Fig. <xref rid="Fig3" ref-type="fig">3</xref>a–c), using the independently developed dynverse toolbox<sup><xref ref-type="bibr" rid="CR1">1</xref></sup> (see “Methods”). Note that the simulated data sets are relatively “clean”, as reflected by the high sensitivity and specificity of most methods. In particular, cells are approximately uniformly distributed along each lineage and often balanced between lineages. The data sets are, however, still useful to provide a relative ranking of the methods.<fig id="Fig3"><label>Fig. 3</label><caption><title>Simulation study results.</title><p>PCA plots for the (<bold>a</bold>) cyclic, (<bold>b</bold>) bifurcating, and (<bold>c</bold>) multifurcating simulated trajectories. The plotting symbol for each cell is colored according to its true pseudotime; trajectories (in black) were inferred by princurve in (<bold>a</bold>) and slingshot in (<bold>b</bold>) and (<bold>c</bold>). <bold>d</bold>–<bold>f</bold> Scatterplot of the true positive rate (TPR) vs. the false discovery rate (FDR) or false discovery proportion (FDP) for various DE methods applied to the simulated data sets. Panel (<bold>d</bold>) displays the average performance curves of DE methods across seven out of ten cyclic data sets for which all DE methods worked (Monocle 3 errored on three data sets). The associationTest from tradeSeq has superior performance for discovering genes whose expression is associated with pseudotime, as compared with Monocle 3. When investigating differential expression between lineages of a trajectory, the patternTest of tradeSeq consistently outperforms the diffEndTest across all three TI methods, since it is capable of comparing expression across entire lineages. Panel (<bold>e</bold>) displays the average performance curves across the three bifurcating data sets where all TI methods recovered the correct topology. Here, all tradeSeq patternTest workflows, tradeSeq_slingshot_end, and edgeR have similar performance and all are superior to BEAM, ImpulseDE2, and GPfates. Note that the performance of tradeSeq_Monocle2_end deteriorates as compared with tradeSeq_slingshot_end; the curve for tradeSeq_GPfates_end is not visible in this panel due to its low performance. For the multifurcating data set of panel (<bold>f</bold>), tradeSeq_slingshot has the highest performance, closely followed by tradeSeq_Monocle2 and edgeR.</p></caption><graphic xlink:href="41467_2020_14766_Fig3_HTML" id="d29e1059"/></fig></p>
      <p id="Par13">We demonstrate the versatility of tradeSeq by using it downstream of three trajectory inference methods, slingshot<sup><xref ref-type="bibr" rid="CR3">3</xref></sup>, Monocle 2<sup><xref ref-type="bibr" rid="CR5">5</xref></sup>, and GPfates<sup><xref ref-type="bibr" rid="CR4">4</xref></sup>, which will be denoted by tradeSeq_slingshot, tradeSeq_Monocle2, and tradeSeq_Gpfates, respectively. However, we find that GPfates fails to recover the expected trajectory topology if run in an unsupervised way (Supplementary Fig. <xref rid="MOESM2" ref-type="media">3</xref>a). Feeding the true pseudotimes as input to GPfates may, however, result in meaningful trajectories (Supplementary Fig. <xref rid="MOESM2" ref-type="media">3</xref>b). We therefore adopt this approach in the simulation study, but note that this may provide an a priori competitive advantage to GPfates over other TI methods and that this would be impossible for real data sets.</p>
      <p id="Par14">Existing frameworks for differential expression analysis are not modular, in the sense that the DE method is tied to the TI method implemented in the same software package. Because of this, the comparison of DE methods is confounded with the quality of the upstream trajectory inference. We therefore also evaluate all trajectory-based DE methods by using the simulation ground truth as input for the DE analysis, which avoids such a confounding. GPfates was left out of this comparison, since we were not able to input the simulation ground truth to the method.</p>
      <p id="Par15">Within-lineage DE: First, we look for genes whose expression is associated with pseudotime for data sets with a cyclic topology (e.g., Fig. <xref rid="Fig3" ref-type="fig">3</xref>a). We compare the associationTest of a tradeSeq_slingshot analysis to the Moran’s I test implemented in Monocle 3. We apply tradeSeq using 5 knots, as determined using the AIC (Supplementary Fig. <xref rid="MOESM2" ref-type="media">4</xref>). We only consider Monocle 3 because it is the only method that provides a test of the association between gene expression and pseudotime within a single lineage. For each TI method, we use the default/recommended dimensionality reduction method, which is PCA for slingshot and UMAP for Monocle 3.</p>
      <p id="Par16">Monocle 3, however, often fails to reconstruct the cyclic topology and instead may fit a disconnected or branching trajectory (Supplementary Fig. <xref rid="MOESM2" ref-type="media">5</xref>). The Moran’s I test still has reasonably high sensitivity, possibly because it relies on nearest neighbors in the reduced dimensional space and not on the inferred trajectory. tradeSeq downstream of slingshot provides superior performance to discover genes whose expression is associated with pseudotime (Fig. <xref rid="Fig3" ref-type="fig">3</xref>d). We also compared both methods using the same dimensionality reduction input, by having slingshot infer trajectories in the UMAP space that is used by Monocle 3. The performance of tradeSeq was generally similar for both dimensionality reduction methods, except for two out of ten data sets (Supplementary Fig. <xref rid="MOESM2" ref-type="media">6</xref>). In all data sets, tradeSeq had better performance than Monocle 3. Finally, we evaluate an edgeR-based associationTest through fitting the NB-GAMs with edgeR instead of with mgcv (method edgeR_assoc, see “Methods” for details), and note that its performance is similar to the tradeSeq associationTest (Supplementary Fig. <xref rid="MOESM2" ref-type="media">7</xref>). This could be expected because few basis functions were selected for this simulation setting. In applications that require a rich basis, however, the edgeR implementation will be prone to overfitting.</p>
      <p id="Par17">Between-lineage DE: For the bifurcating data sets (e.g., Fig. <xref rid="Fig3" ref-type="fig">3</xref>b), we assess differential expression between lineages using the diffEndTest and the patternTest from tradeSeq, downstream of TI methods slingshot, Monocle 2, and GPfates. We apply tradeSeq with four knots, as determined using the AIC (Supplementary Fig. <xref rid="MOESM2" ref-type="media">8</xref>). We compare these tests with available approaches for trajectory-based differential expression analysis, namely, BEAM (implemented in Monocle 2), GPfates, and ImpulseDE2. Furthermore, we compare against the discrete DE method edgeR, where we supervise the test to assess DE between the clusters at the true endpoints of each lineage, as derived through <italic>k</italic>-means clustering in PCA space. For each TI method, we use the default/recommended dimensionality reduction, which is PCA for slingshot, GPLVM for GPfates, and DDRTree for Monocle 2. For ImpulseDE2, we use the same input as for tradeSeq, i.e., derived by slingshot TI.</p>
      <p id="Par18">Monocle 2 and GPfates fail to detect the correct topology of the trajectory (i.e., a bifurcation) in, respectively, three and four out of the ten data sets (Supplementary Figs. <xref rid="MOESM2" ref-type="media">9</xref> and <xref rid="MOESM2" ref-type="media">10</xref>). In addition, out of the remaining seven data sets, Monocle 2 misplaces the bifurcation in four of them, causing the two simulated lineages to be merged into the same lineage and creating another incorrect lineage (Supplementary Fig. <xref rid="MOESM2" ref-type="media">9</xref>). This strongly obscures the DE testing results. slingshot, on the other hand, correctly identifies the topology and reconstructs the trajectory for all ten data sets.</p>
      <p id="Par19">Figure <xref rid="Fig3" ref-type="fig">3</xref>e shows performance curves for the three data sets for which all methods are able to recover the true topology of the simulated trajectory. The tradeSeq patternTest has superior performance regardless of the TI method. Only edgeR achieves a similar performance. This is not surprising since the edgeR analysis is supervised to compare the true cell populations at the endpoints of the lineages. Interestingly, tradeSeq’s diffEndTest based on the slingshot trajectory performs comparably with a supervised edgeR analysis. This is especially encouraging, since the diffEndTest is a smoother-based analog of discrete DE. For TI methods Monocle 2 and GPfates, diffEndTest performs poorly, which is not surprising since the endpoints are typically ill-defined or artificially extended in the inferred trajectories for these methods (Supplementary Figs. <xref rid="MOESM2" ref-type="media">9</xref> and <xref rid="MOESM2" ref-type="media">10</xref>). In general, BEAM, ImpulseDE2, and GPfates are outperformed by the other methods. Across all methods, tradeSeq_slingshot has the best performance. Finally, we recapitulate that the performance curves in Fig. <xref rid="Fig3" ref-type="fig">3</xref>e do not provide a complete view of method performance, since seven out of ten data sets were not used because at least one method failed to recover the simulated trajectory. Supplementary Fig. <xref rid="MOESM2" ref-type="media">11</xref> shows mean performance curves across all ten data sets for all methods, which clearly demonstrates the superiority of tradeSeq as a DE method and of slingshot as an upstream TI method. The performance and trajectories for all ten individual data sets are shown in Supplementary Fig. <xref rid="MOESM2" ref-type="media">12</xref>.</p>
      <p id="Par20">In order to avoid the comparison of DE methods being obscured by differences in the upstream dimensionality reduction and trajectory inference methods, we compared tradeSeq, BEAM, and ImpulseDE2 on the simulation ground truth. We fit the tradeSeq NB-GAM once with three knots, for comparability with the BEAM approach that also uses three knots, and once with four knots, which was found to be optimal according to the AIC (Supplementary Fig. <xref rid="MOESM2" ref-type="media">8</xref>). The tradeSeq patternTest is unaffected by the change in the number of knots and outperforms all other methods for differential expression analysis (Supplementary Fig. <xref rid="MOESM2" ref-type="media">13</xref>). The performance of the tradeSeq diffEndTest is somewhat sensitive to the number of knots, but still better than that of ImpulseDE2 and BEAM. Generally, ImpulseDE2 performs better than the BEAM approach.</p>
      <p id="Par21">For the multifurcating data set, we forego a comparison with GPfates, since it is restricted to discovering only a single bifurcation (Supplementary Fig. <xref rid="MOESM2" ref-type="media">14</xref>). We fit tradeSeq with three knots, as determined using the AIC (Supplementary Fig. <xref rid="MOESM2" ref-type="media">15</xref>). The patternTest from tradeSeq_slingshot and tradeSeq_Monocle2 have highest performance, closely followed by edgeR and the diffEndTest for these respective TI methods (Fig. <xref rid="Fig3" ref-type="fig">3</xref>f). BEAM was found to have the lowest performance.</p>
      <p id="Par22">Taken together, these results suggest that tradeSeq is a powerful and flexible procedure for assessing DE along and between lineages. Although tradeSeq is modular and can be used downstream of any TI method that provides pseudotime estimates, the choice of dimensionality reduction and TI method is crucial for the performance of the downstream analysis. The best performance was found for a tradeSeq_slingshot analysis, so we will mainly focus on slingshot as TI method for the real data sets.</p>
    </sec>
    <sec id="Sec5">
      <title>Computation time and memory-usage benchmark</title>
      <p id="Par23">To assess time and memory requirements, scRNA-seq data sets with a bifurcating trajectory were simulated using the same framework as in the simulation study; the results are shown in Fig. <xref rid="Fig4" ref-type="fig">4</xref>, and more extensively described in Supplementary Note <xref rid="MOESM2" ref-type="media">1</xref>. Briefly, ImpulseDE2 is by far the slowest, taking over 3.5 h to run on a small data set of 100 cells. GPfates runs fast ( ~30 s) on the small data set, but scales poorly. BEAM, edgeR, and tradeSeq are quite fast and scale very well, even to large data sets, with BEAM scaling the best. In terms of memory requirements, all methods scale well to 10,000 cells.<fig id="Fig4"><label>Fig. 4</label><caption><title>Benchmark of computation time and memory usage.</title><p>Data sets with 100, 1000, and 10,000 cells are simulated and each method is evaluated, respectively, 10, 2, and 2 times on each data set to assess computation time and memory usage. The average across iterations is plotted for each method. Methods that went over a 4-h mark were stopped and deemed taking too long.</p></caption><graphic xlink:href="41467_2020_14766_Fig4_HTML" id="d29e1230"/></fig></p>
    </sec>
    <sec id="Sec6">
      <title>Case studies</title>
      <p id="Par24">We analyze four case study data sets with tradeSeq: a bulk RNA-seq time-course and scRNA-seq MARS-seq, Smart-Seq, and 10× data sets. While we discuss the MARS-seq and Smart-seq data sets in the main paper and their corresponding Supplementary Notes (see below), we only report the results for the bulk RNA-seq time-course and 10× data sets in Supplementary Notes <xref rid="MOESM2" ref-type="media">2</xref> and <xref rid="MOESM2" ref-type="media">3</xref>, respectively.</p>
    </sec>
    <sec id="Sec7">
      <title>Mouse bone marrow data set</title>
      <p id="Par25">Paul et al.<sup><xref ref-type="bibr" rid="CR15">15</xref></sup> study the evolution of gene expression for myeloid progenitors in mouse bone marrow. They construct a reference compendium of marker genes that are indicative of development from myeloid multipotent progenitors to erythrocytes and several types of leukocytes.</p>
      <p id="Par26">In order to compare our approach with BEAM, we are restricted to the dimensionality reduction procedures implemented in Monocle 2. We therefore first used ICA as dimensionality reduction method (Fig. <xref rid="Fig5" ref-type="fig">5</xref>a) in the “Discovering cell type markers” paragraph, but observed that this approach does not fully preserve the underlying biology (Supplementary Note <xref rid="MOESM2" ref-type="media">4</xref>). In subsequent sections, we will therefore demonstrate the powerful interpretation of a tradeSeq_slingshot analysis based on UMAP dimensionality reduction (Fig. <xref rid="Fig5" ref-type="fig">5</xref>b). This additionally illustrates the flexibility of tradeSeq (and slingshot) to be applied downstream of any dimensionality reduction method.<fig id="Fig5"><label>Fig. 5</label><caption><title>Mouse bone marrow case study.</title><p><bold>a</bold> Two-dimensional representation of a subset of the data using independent components analysis (ICA). The myeloid trajectory inferred by slingshot is displayed. <bold>b</bold> Two-dimensional representation of a subset of the data using UMAP. The myeloid trajectory inferred by slingshot is displayed. The UMAP dimensionality reduction method better captures the smooth differentiation process than ICA. <bold>c</bold> Estimated smoothers for the top six genes identified by the tradeSeq patternTest procedure on the trajectory from (<bold>b</bold>). <bold>d</bold> Six clusters for the top 500 genes with different expression patterns between the two lineages (as identified by patternTest from tradeSeq).</p></caption><graphic xlink:href="41467_2020_14766_Fig5_HTML" id="d29e1293"/></fig></p>
      <p id="Par27">In this case study, we apply tradeSeq with six knots, as found to be optimal by the AIC (Supplementary Fig. <xref rid="MOESM2" ref-type="media">22</xref>). We first identify marker genes for the progenitor and differentiated cell types in the “Discovering cell type markers” paragraph. Next, we assess which genes behave differently along the two lineages in the “Discovering progenitor population markers” paragraph. Finally, we demonstrate how one can group genes in clusters that share similar expression patterns in the “Gene expression families” paragraph.</p>
      <p id="Par28">Discovering cell type markers: tradeSeq provides the flexibility to test several interesting and distinct hypotheses for this data set, that cannot always be considered with other methods. For instance, we can find marker genes for the progenitor cell population vs. the differentiated leukocytes or erythrocytes with the startVsEndTest procedure (results shown in Supplementary Fig. <xref rid="MOESM2" ref-type="media">23</xref>). By contrasting the endpoints of the smoothers with the diffEndTest procedure, i.e., comparing the differentiated leukocyte and erythrocyte cells themselves, we can also discover marker genes for the differentiated cell types. For the latter, tradeSeq finds 2233 significantly differentially expressed genes at a 5% nominal FDR level, while BEAM discovers 584 genes at a 5% nominal FDR level when testing whether the association between gene expression and pseudotime depends on the lineage (Benjamini-Hochberg FDR-controlling procedure<sup><xref ref-type="bibr" rid="CR16">16</xref></sup>). In Supplementary Note <xref rid="MOESM2" ref-type="media">4</xref>, we confirm that tradeSeq provides relevant biological results as compared with both BEAM and a cluster (cell type)-based comparison with edgeR. tradeSeq can thus provide relevant biological results without using the cell-type labels. Moreover, while cluster-based comparisons can be powerful in some cases, many hypotheses are difficult to assess with discrete DE, as demonstrated in the following paragraphs.</p>
      <p id="Par29">Discovering progenitor population markers: In addition to looking for markers at the differentiated cell-type level, we could also look for markers of developing myeloid cells. tradeSeq’s patternTest can accommodate this by identifying genes with significantly different expression patterns between lineages. Remarkably, the top six genes (<italic>Mpo</italic>, <italic>Prtn3</italic>, <italic>Ctsg</italic>, <italic>Car2</italic>, <italic>Elane</italic>, and <italic>Srgn</italic>, Fig. <xref rid="Fig5" ref-type="fig">5</xref>c) are all confirmed as biomarkers in the extensive analysis of the original manuscript of Paul et al.<sup><xref ref-type="bibr" rid="CR15">15</xref></sup>, confirming the relevant ranking of patternTest. Indeed, <italic>Prtn3</italic> was found to be monocyte-specific, while <italic>Mpo</italic> and <italic>Car2</italic> discriminated between erythroid lineage progenitors and myeloid lineage progenitors. The cluster of genes <italic>Elane</italic>, <italic>Prtn3</italic>, and <italic>Mpo</italic> were the strongest markers for myeloid lineage progenitors and monocytes. In summary, all six top genes were labeled as “key genes” for hematopoiesis<sup><xref ref-type="bibr" rid="CR15">15</xref></sup>.</p>
      <p id="Par30">It might also be interesting to examine genes with significantly different expression patterns between lineages, that show little evidence for DE at the endpoints. In Supplementary Note <xref rid="MOESM2" ref-type="media">4</xref>, we show how the combination of the results from patternTest and diffEndTest yields highly informative genes showing transient expression differences between the lineages. Note that this analysis is not possible with any other method available, since these only test for global differential gene expression between lineages.</p>
      <p id="Par31">Gene expression families: Modeling gene expression in terms of smooth functions of pseudotime opens the door for additional downstream interpretation of results that are impossible with discrete DE methods, such as the clustering of genes based on their fitted expression patterns. In general, we found that RSEC clustering provides a more stable clustering than partitioning around medoids (PAM) (Supplementary Fig. <xref rid="MOESM2" ref-type="media">25</xref>), the latter of which is also used by Monocle to cluster genes. For example, we can cluster the expression patterns for genes that were deemed significant by tradeSeq’s patternTest (see “Methods”, section “Clustering gene expression patterns”). This identifies gene families that have similar expression patterns within every lineage, and also similar fold changes between the two lineages (Fig. <xref rid="Fig5" ref-type="fig">5</xref>d shows six clusters). These gene sets can then be further screened for interesting patterns and validated by the biologist. Note that, for instance, the expression smoothers can be used to assess specific transient changes in expression during development, the signal for which might be diluted in cluster-based DE.</p>
    </sec>
    <sec id="Sec8">
      <title>Mouse olfactory epithelium data set</title>
      <p id="Par32">Fletcher et al.<sup><xref ref-type="bibr" rid="CR17">17</xref></sup> study the development of horizontal basal cells (HBC) in the olfactory epithelium (OE) of mice. They activate the HBCs to be primed for development, which subsequently give rise to three different cell types: sustentacular cells, microvillous cells, and olfactory sensory neurons (Fig. <xref rid="Fig6" ref-type="fig">6</xref>a, b). The olfactory sensory neurons are connected to the olfactory bulb for signal transduction of smell, and the sustentacular cells are general supportive cells in the OE. The function of microvillous cells, however, is not well understood; while some cells have axons ranging to the olfactory bulb, potentially indicating a sensory neuron function, others lack a basal process or axon<sup><xref ref-type="bibr" rid="CR18">18</xref></sup>. The samples from Fletcher et al.<sup><xref ref-type="bibr" rid="CR17">17</xref></sup> were processed using the Fluidigm C1 system with SMART-Seq library preparation, hence we expect zero inflation to be present in this data set. We therefore fit ZINB-GAMs to analyze the data using tradeSeq downstream of slingshot. Zero inflation weights are estimated with the ZINB-WaVE method<sup><xref ref-type="bibr" rid="CR19">19</xref></sup>, using the cluster labels and batch as covariates. We fit tradeSeq with six knots, as determined using the AIC (Supplementary Fig. <xref rid="MOESM2" ref-type="media">26</xref>). We were unable to fit a model for 0.8% of all 14,261 genes due to convergence issues of the ZINB-GAM. Note that currently no other trajectory-based DE method can account for zero inflation or provide the range of tests available in tradeSeq; hence, we forgo a comparison with other methods aside from a ZINB-edgeR analysis<sup><xref ref-type="bibr" rid="CR14">14</xref></sup>.<fig id="Fig6"><label>Fig. 6</label><caption><title>Mouse olfactory epithelium case study.</title><p><bold>a</bold> Three-dimensional PCA plot of the scRNA-seq data, where cells are colored according to their cluster membership as defined in the original paper (see “Methods”). The simultaneous principal curves for the lineages inferred by slingshot are displayed. This Figure is reprinted from Fletcher et al.<sup><xref ref-type="bibr" rid="CR17">17</xref></sup> with permission from the publisher. <bold>b</bold> Schematic of the cell types and their ordering along the lineages. <bold>c</bold> Heatmap for the top 200 genes that are associated with the neuronal lineage, as identified with the associationTest procedure from tradeSeq. Five clear gene clusters can be identified, each with a different region of activity during the developmental process. <bold>d</bold> Four transcription factors discovered by the earlyDETest between the pseudotimes of knots one and three (knots indicated with vertical dashed lines) and that are involved in epithelial cell differentiation.</p></caption><graphic xlink:href="41467_2020_14766_Fig6_HTML" id="d29e1460"/></fig></p>
      <p id="Par33">In this case study, we first consider differential expression within each lineage in the “Within-lineage DE” paragraph, after which we assess differences between the three developmental lineages in the “Between-lineage DE” paragraph.</p>
      <p id="Par34">Within-lineage DE: We first consider differential expression along the neuronal lineage (the orange lineage in Fig. <xref rid="Fig6" ref-type="fig">6</xref>a). Using the associationTest implemented in tradeSeq, we recover 2730 genes at a 5% nominal FDR level. Within the top DE genes, clear clusters of expression can be observed (Fig. <xref rid="Fig6" ref-type="fig">6</xref>c), that are more active either at the beginning of the lineage, at specific locations along the lineage, or at the end of the lineage. Since Fletcher et al.<sup><xref ref-type="bibr" rid="CR17">17</xref></sup> observed that cells associated with the neuronal lineage undergo mitotic division during differentiation, we investigate whether we can recover the cell cycle biology using the associationTest. Indeed, many of the top genes are related to the cell cycle (Supplementary Fig. <xref rid="MOESM2" ref-type="media">27</xref>).</p>
      <p id="Par35">We also seek biological markers that differentiate the progenitor cells from the differentiated cell types in any of the three lineages using the startVsEndTest procedure as part of a global test (i.e., gene expression is compared between the start and end states for each lineage and the evidence is aggregated across the three lineages using a global test; see “Methods”) and then look for enriched gene sets for the top 250 genes. The results for the top 20 gene sets (Supplementary Table <xref rid="MOESM2" ref-type="media">1</xref>) clearly reflect the biology of the experiment (Supplementary Note <xref rid="MOESM2" ref-type="media">5</xref>).</p>
      <p id="Par36">Between-lineage DE: Next, we compare the three lineages by assessing differences in their expression patterns through stage-wise testing with the patternTest procedure (see “Methods”). At the screening stage, we first test whether any two lineages have significantly different expression patterns. The genes that pass the screening stage are then further assessed to discover which specific pairs of lineages are deviating in their expression pattern. The screening stage identifies 3275 genes that have different expression patterns between any pair of lineages, at a 5% nominal FDR level (as reference, the top six genes are plotted in Supplementary Fig. <xref rid="MOESM2" ref-type="media">28</xref>). As could be expected, a large majority of the genes (2481) are significant in the neuronal–sustentacular lineage comparison. However, remarkably, we discover more DE genes when comparing the microvillous and neuronal lineages (2149 genes) than when comparing the microvillous and sustentacular lineages (1374 genes), even though the microvillous lineage shares a longer path with the neuronal lineage. Out of all significant genes, 827 genes were identified in all three pairwise comparisons. Investigating the top 20 enriched gene sets based on the MSigDB database reveals that 12/20 of the top gene sets are related to the mitotic cell cycle (Supplementary Table <xref rid="MOESM2" ref-type="media">2</xref>). This is reassuring, since only the neuronal and microvillous lineages go through the cell cycle, according to Fletcher et al.<sup><xref ref-type="bibr" rid="CR17">17</xref></sup>. In addition, we find gene sets related to neurogenesis, referring to the development of olfactory sensory neurons. The functional interpretation of the results from the combined ZINB and tradeSeq analysis hence confirms the biology of the experiment and the battery of possible tests unlock a more detailed and meaningful interpretation of the results.</p>
      <p id="Par37">None of the previously developed trajectory-based methods for assessing differential expression between lineages can currently accommodate zero inflation. In Supplementary Note <xref rid="MOESM2" ref-type="media">5</xref>, we compare the ZINB-tradeSeq analysis with a ZINB-edgeR analysis, and demonstrate the relevance of the genes uniquely found by tradeSeq. In addition, we illustrate the functionality of the earlyDETest to identify genes that may drive the differentiation around the first branching point.</p>
    </sec>
  </sec>
  <sec id="Sec9" sec-type="discussion">
    <title>Discussion</title>
    <p id="Par38">We have proposed tradeSeq, a novel suite of tests for identifying dynamic temporal gene regulation using single-cell RNA-seq data. These tests allow researchers to investigate a range of hypotheses related to temporal gene expression, ranging from the general to the highly specific. Whereas previous methods only provide global tests of differential expression along or between lineages, tradeSeq offers a highly flexible framework that can be adapted to a single lineage, multiple lineages, or specific points or ranges along lineages. The flexibility provided by tradeSeq is crucial, as trajectory-based DE is often the final (or near final) step in a much longer analysis pipeline.</p>
    <p id="Par39">Our analyses are based on the NB-GAM of Eq. (<xref rid="Equ1" ref-type="">1</xref>), which conditions on cell pseudotimes and hence ignores the fact that pseudotimes are typically inferred random variables. We therefore expect some uncertainty in pseudotime values, which may or may not be quantified by a particular TI method. Even when measures of pseudotime variability are available, neither tradeSeq nor other methods such as BEAM and GPfates currently make use of this information. Instead, all of these methods treat the pseudotimes as fixed and known. The BranchedGP method allows for uncertainty in the assignment of cells to lineages and relies on branching Gaussian processes to identify gene-specific branching dynamics<sup><xref ref-type="bibr" rid="CR20">20</xref></sup>. However, it is computationally very intensive, with reported computation time of 2 min per gene on a data set that has been subsampled to 467 cells<sup><xref ref-type="bibr" rid="CR20">20</xref></sup>; we therefore did not consider this method in our evaluation.</p>
    <p id="Par40">While we generally assume that pseudotime values are on similar scales across lineages, this may not always be the case. Furthermore, Trapnell et al.<sup><xref ref-type="bibr" rid="CR11">11</xref></sup> noted that any trajectory inference method can produce pseudotime values that are not necessarily reflective of true biological time. At best, pseudotime values represent some monotonic transformation of the true maturity of each cell. Therefore, some authors have proposed the use of dynamic time warping to align pseudotime values from different experiments on potentially different scales<sup><xref ref-type="bibr" rid="CR21">21</xref></sup>. This approach can be beneficial in cases where, for example, one lineage is much longer or shorter than another. If a gene, in reality, has a similar pattern of expression along two such lineages, this pattern could, for instance, consume 75% of the shorter lineage, but only 25% of the longer lineage. As such, the gene could be called DE by the patternTest procedure. However, applying the same test after dynamic time warping may yield a negative result. Since tradeSeq only requires the estimated pseudotimes as input, which could be warped or not, it is compatible with any form of warping between lineages. We urge users to carefully consider whether pseudotime values across lineages are comparable and, if not, consider such warping strategies before comparing patterns of expression with tradeSeq.</p>
    <p id="Par41">Moving forward, it may be possible to fit ZINB-GAMs in a single step by numerically maximizing the ZINB-GAM likelihood. This could improve upon the two-step approach that we have taken in this paper, where (i) posterior probabilities of zero inflation are first estimated using ZINB-WaVE and (ii) subsequently used to unlock the NB-GAM for DE analysis in the presence of excess zeros.</p>
    <p id="Par42">In this paper, we have demonstrated tradeSeq on several scRNA-seq data sets. However, the tests that we provide downstream of the fitGAM function are applicable beyond this setting. Indeed, the framework may also be applicable to, e.g., downstream analysis of chromatin accessibility trajectories in scATAC-seq data sets (e.g., Chen et al.<sup><xref ref-type="bibr" rid="CR22">22</xref></sup>) or bulk RNA-seq time-course studies; we have demonstrated the latter in Supplementary Note <xref rid="MOESM2" ref-type="media">2</xref>.</p>
    <p id="Par43">While we propose a number of tests based on the NB-GAM, it is important to realize that users may also implement their own statistical tests related to their specific hypotheses of interest. We therefore welcome contributions of new tests to the GitHub repository (<ext-link ext-link-type="uri" xlink:href="https://github.com/statOmics/tradeSeq">https://github.com/statOmics/tradeSeq</ext-link>) of the package.</p>
    <p id="Par44">Single-cell RNA-seq tends to produce noisy data requiring long analysis pipelines in order to glean biological insight. While “all-in-one” tools that simplify this analysis may be attractive from a user’s standpoint, they are not guaranteed to offer the best methods for each individual step. We therefore propose a more modular approach that expands upon previous work and opens up new classes of questions to be asked and hypotheses to be tested.</p>
  </sec>
  <sec id="Sec10">
    <title>Methods</title>
    <sec id="Sec11">
      <title>Negative binomial generalized additive model</title>
      <p id="Par45">We build on the generalized additive model (GAM) methodology to model gene expression profiles as nonlinear functions of pseudotime for the different lineages in a complex trajectory. In our GAM framework, each lineage is represented by a separate cubic smoothing spline, i.e., a linear combination of cubic basis functions of pseudotime. The flexibility of GAM also allows us to easily adjust for other covariates or confounders such as treatment and batch. The discrete nature and the overdispersion of read counts is addressed by modeling the expression measures <italic>Y</italic><sub><italic>g</italic><italic>i</italic></sub>, for a given gene <italic>g</italic> ∈ {1, …, <italic>G</italic>} across cells <italic>i</italic> ∈ {1, …, <italic>n</italic>}, using a negative binomial (NB) distribution with cell and gene-specific means <italic>μ</italic><sub><italic>g</italic><italic>i</italic></sub> and gene-specific dispersion parameters <italic>ϕ</italic><sub><italic>g</italic></sub>. Hence, we propose a gene-wise negative binomial generalized additive model (NB-GAM), represented by Eq. (<xref rid="Equ1" ref-type="">1</xref>) (see Results section), where the mean <italic>μ</italic><sub><italic>g</italic><italic>i</italic></sub> of the NB distribution is linked to the additive predictor <italic>η</italic><sub><italic>g</italic><italic>i</italic></sub> using a logarithmic link function. The gene-wise additive predictor consists of lineage-specific smoothing splines <italic>s</italic><sub><italic>g</italic><italic>l</italic></sub>, that are functions of pseudotime <italic>T</italic><sub><italic>l</italic><italic>i</italic></sub>, for lineages <italic>l</italic> ∈ {1, …, <italic>L</italic>}. The binary matrix <bold>Z</bold> = (<italic>Z</italic><sub><italic>l</italic><italic>i</italic></sub> ∈ {0, 1}: <italic>l</italic> ∈ {1, …, <italic>L</italic>}, <italic>i</italic> ∈ {1, …, <italic>n</italic>}) assigns every cell to a particular lineage based on user-supplied weights (e.g., from slingshot<sup><xref ref-type="bibr" rid="CR3">3</xref></sup> or GPfates<sup><xref ref-type="bibr" rid="CR4">4</xref></sup>, see details in Supplementary Methods). We let <inline-formula id="IEq2"><alternatives><tex-math id="M7">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{\mathcal{L}}}_{l}=\{i:{Z}_{li}=1\}$$\end{document}</tex-math><mml:math id="M8"><mml:msub><mml:mrow><mml:mi class="MJX-tex-caligraphic" mathvariant="script">L</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>:</mml:mo><mml:msub><mml:mrow><mml:mi>Z</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>}</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="41467_2020_14766_Article_IEq2.gif"/></alternatives></inline-formula> denote the set of cells assigned to lineage <italic>l</italic>. In addition, we allow the inclusion of <italic>p</italic> known cell-level covariates (e.g., batch, age, or gender), represented by an <italic>n</italic> × <italic>p</italic> matrix <bold>U</bold>, with <italic>i</italic>th row <bold>U</bold><sub><italic>i</italic></sub> corresponding to the <italic>i</italic>th cell, and regression parameters <bold>α</bold><sub><italic>g</italic></sub> of dimension <italic>p</italic> × 1. Differences in sequencing depth or capture efficiency between cells are accounted for by cell-specific offsets <italic>N</italic><sub><italic>i</italic></sub>.</p>
      <p id="Par46">The smoothing spline <italic>s</italic><sub><italic>g</italic><italic>l</italic></sub>, for a given gene <italic>g</italic> and lineage <italic>l</italic>, can be represented as a linear combination of <italic>K</italic> cubic basis functions (Eq. (<xref rid="Equ2" ref-type="">2</xref>), see Results section), where the cubic basis functions <italic>b</italic><sub><italic>k</italic></sub>(<italic>t</italic>) are enforced to be the same for all genes and lineages. Our default computational implementation sets <italic>K</italic> = 6. Thus, for each gene and each lineage in the trajectory, we estimate <italic>K</italic> = 6 regression coefficients <italic>β</italic><sub><italic>g</italic><italic>l</italic><italic>k</italic></sub>. The number of parameters in the gene-wise model is <italic>L</italic> × <italic>K</italic> + <italic>p</italic> + 1, which is typically much lower than the number of cells <italic>n</italic> in the data set.</p>
      <p id="Par47">The NB-GAM is fitted gene by gene using the fitGAM function from the tradeSeq package, which relies on the mgcv package in R. We build upon recent developments in mgcv that allow the joint estimation of the NB regression parameters in <italic>μ</italic><sub><italic>g</italic><italic>i</italic></sub> and dispersion parameter <italic>ϕ</italic><sub><italic>g</italic></sub><sup><xref ref-type="bibr" rid="CR23">23</xref></sup>. In order to control the smoothness of the spline, the coefficients <bold><italic>β</italic></bold><sub><italic>g</italic><italic>l</italic><italic>k</italic></sub> are shrunken by substracting a penalty <inline-formula id="IEq3"><alternatives><tex-math id="M9">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\lambda }_{g}{{\boldsymbol{\beta }}}_{g}^{T}{\bf{S}}{{\boldsymbol{\beta }}}_{g}$$\end{document}</tex-math><mml:math id="M10"><mml:msub><mml:mrow><mml:mi>λ</mml:mi></mml:mrow><mml:mrow><mml:mi>g</mml:mi></mml:mrow></mml:msub><mml:msubsup><mml:mrow><mml:mi mathvariant="bold-italic">β</mml:mi></mml:mrow><mml:mrow><mml:mi>g</mml:mi></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msubsup><mml:mi mathvariant="bold">S</mml:mi><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">β</mml:mi></mml:mrow><mml:mrow><mml:mi>g</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2020_14766_Article_IEq3.gif"/></alternatives></inline-formula> from the log-likelihood function, where <bold><italic>β</italic></bold><sub><italic>g</italic></sub> denotes the concatenation of the <italic>L</italic><italic>K</italic>-dimensional column vectors <italic>β</italic><sub><italic>g</italic><italic>l</italic></sub> of lineage-specific smoother coefficients and <bold>S</bold> is an (<italic>L</italic><italic>K</italic>) × (<italic>L</italic><italic>K</italic>) diagonal matrix that indicates which coefficients in <bold><italic>β</italic></bold><sub><italic>g</italic></sub> are to be penalized. The magnitude of penalization is controlled by the smoothing parameter <italic>λ</italic><sub><italic>g</italic></sub>, which is selected using generalized cross-validation<sup><xref ref-type="bibr" rid="CR24">24</xref></sup>. Note that we enforce identical basis functions between lineages, i.e., <italic>b</italic><sub><italic>k</italic></sub> does not depend on <italic>l</italic>, as well as identical smoothing parameter <italic>λ</italic><sub><italic>g</italic></sub>, in order to ensure that the smoothers are comparable across lineages.</p>
      <p id="Par48">Importantly, the model of Eq. (<xref rid="Equ1" ref-type="">1</xref>) can accommodate zero-inflated counts typical for full-length scRNA-seq protocols by using observation-level (i.e., cell-level) weights obtained, for instance, from the zero-inflated negative binomial (ZINB) approach of Van den Berge et al.<sup><xref ref-type="bibr" rid="CR14">14</xref></sup> and Risso et al.<sup><xref ref-type="bibr" rid="CR19">19</xref></sup>.</p>
    </sec>
    <sec id="Sec12">
      <title>Choosing an appropriate number of knots</title>
      <p id="Par49">Ideally, the number of knots <italic>K</italic> should be selected to reach an optimal bias-variance trade-off for the smoother, where one explains as much variability in the expression data as possible with only a few regression coefficients (see Supplementary Fig. <xref rid="MOESM2" ref-type="media">1</xref>). In practice, the number of knots <italic>K</italic> may be selected by evaluating the Akaike information criterion (AIC) using the evaluateK function implemented in tradeSeq. We have deliberately chosen the AIC as evaluation criterion, since the Bayesian information criterion (BIC) seemed to favor overly complex models (i.e., an excessively high number of knots). The knots are by default positioned according to the quantiles of the pseudotime values. For example, if a smoother is fit with three knots, then there will be a knot at the minimum, median, and maximum pseudotime values. The knots may be interpreted as relative markers of progress along the trajectory. However, it is important to realize that this might not necessarily linearly correlate with true chronological time.</p>
    </sec>
    <sec id="Sec13">
      <title>Statistical inference</title>
      <p id="Par50">We propose a general and flexible testing framework for (linear combinations of) the parameters <bold><italic>β</italic></bold><sub><italic>g</italic></sub>, which allows us to pinpoint specific types of differences in gene expression both within and between lineages; see Fig. <xref rid="Fig1" ref-type="fig">1</xref> for an overview. We first present the general approach and then detail the implementation and interpretation of specific DE tests.</p>
      <p id="Par51">All proposed DE procedures involve testing null hypotheses of the form <italic>H</italic><sub>0</sub>: <bold>C</bold><sup><italic>T</italic></sup><bold><italic>β</italic></bold><sub><italic>g</italic></sub> = 0 using Wald test statistics<disp-formula id="Equ3"><label>3</label><alternatives><tex-math id="M11">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${W}_{g}={\hat{{\boldsymbol{\beta }}}}_{g}^{T}{\bf{C}}{({{\bf{C}}}^{T}{\hat{{\mathbf{\Sigma }}}}_{{\hat{{\boldsymbol{\beta }}}}_{g}}{\bf{C}})}^{-1}{{\bf{C}}}^{T}{\hat{{\boldsymbol{\beta }}}}_{g},$$\end{document}</tex-math><mml:math id="M12"><mml:msub><mml:mrow><mml:mi>W</mml:mi></mml:mrow><mml:mrow><mml:mi>g</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msubsup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold-italic">β</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>g</mml:mi></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msubsup><mml:mi mathvariant="bold">C</mml:mi><mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="bold">C</mml:mi></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msup><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold">Σ</mml:mi></mml:mrow><mml:mo> ^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold-italic">β</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>g</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mi mathvariant="bold">C</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:msup><mml:mrow><mml:mi mathvariant="bold">C</mml:mi></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msup><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold-italic">β</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>g</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo></mml:math><graphic xlink:href="41467_2020_14766_Article_Equ3.gif" position="anchor"/></alternatives></disp-formula>where <inline-formula id="IEq4"><alternatives><tex-math id="M13">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\hat{{\boldsymbol{\beta }}}}_{g}$$\end{document}</tex-math><mml:math id="M14"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold-italic">β</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>g</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2020_14766_Article_IEq4.gif"/></alternatives></inline-formula> denotes an estimator of <bold><italic>β</italic></bold><sub><italic>g</italic></sub>, <inline-formula id="IEq5"><alternatives><tex-math id="M15">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\hat{\mathbf{\Sigma }}}_{{\hat{{\boldsymbol{\beta }}}}_{g}}$$\end{document}</tex-math><mml:math id="M16"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold">Σ</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold-italic">β</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>g</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2020_14766_Article_IEq5.gif"/></alternatives></inline-formula> represents an estimator of the covariance matrix <inline-formula id="IEq6"><alternatives><tex-math id="M17">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{\mathbf{\Sigma }}}_{{\hat{{\boldsymbol{\beta }}}}_{g}}$$\end{document}</tex-math><mml:math id="M18"><mml:msub><mml:mrow><mml:mi mathvariant="bold">Σ</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold-italic">β</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>g</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2020_14766_Article_IEq6.gif"/></alternatives></inline-formula> of <inline-formula id="IEq7"><alternatives><tex-math id="M19">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\hat{{\boldsymbol{\beta }}}}_{g}$$\end{document}</tex-math><mml:math id="M20"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold-italic">β</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>g</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2020_14766_Article_IEq7.gif"/></alternatives></inline-formula>, and <bold>C</bold> is an (<italic>L</italic><italic>K</italic>) × <italic>C</italic> matrix representing the <italic>C</italic> contrasts of interest for the DE test.</p>
      <p id="Par52">For each gene, we compute <italic>p</italic>-values based on the nominal chi-squared asymptotic null distribution of the Wald statistics (with degrees of freedom equal to the column rank of <bold>C</bold>). Rather than attaching strong probabilistic interpretations to the <italic>p</italic>-values (which, as in most RNA-seq applications, would involve a variety of hard-to-verify assumptions and would not necessarily add much value to the analysis), we view the <italic>p</italic>-values simply as useful numerical summaries for ranking the genes for further inspection. There are five tests currently implemented in the tradeSeq package, which are introduced in detail in the sections below. Fig. <xref rid="Fig2" ref-type="fig">2</xref> provides a visual overview of the scope of each test.</p>
    </sec>
    <sec id="Sec14">
      <title>Within-lineage comparison tests</title>
      <p id="Par53">associationTest: A relevant first question is whether gene expression is associated with pseudotime along a given lineage, i.e., whether the smoother is flat or varying along pseudotime. To address this question, the associationTest tests the null hypothesis that all smoother coefficients within the lineage are equal, i.e., <inline-formula id="IEq8"><alternatives><tex-math id="M21">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${H}_{0}:{\beta }_{glk}={\beta }_{glk^{\prime} }$$\end{document}</tex-math><mml:math id="M22"><mml:msub><mml:mrow><mml:mi>H</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>:</mml:mo><mml:msub><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:mi>g</mml:mi><mml:mi>l</mml:mi><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:mi>g</mml:mi><mml:mi>l</mml:mi><mml:msup><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2020_14766_Article_IEq8.gif"/></alternatives></inline-formula> for all <inline-formula id="IEq9"><alternatives><tex-math id="M23">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$k\;\ne\; k^{\prime} \in \{1,\ldots ,K\}$$\end{document}</tex-math><mml:math id="M24"><mml:mi>k</mml:mi><mml:mspace width="0.16em"/><mml:mo>≠</mml:mo><mml:mspace width="0.16em"/><mml:msup><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup><mml:mo>∈</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mi>K</mml:mi></mml:mrow><mml:mo>}</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="41467_2020_14766_Article_IEq9.gif"/></alternatives></inline-formula>. This null hypothesis can be encoded in several ways; here, we chose the contrast matrix <bold>C</bold> to be an <italic>L</italic><italic>K</italic> × <italic>L</italic> (<italic>K</italic> − 1) matrix, where each column corresponds to a contrast between two consecutive <italic>β</italic><sub><italic>g</italic><italic>l</italic><italic>k</italic></sub> and <italic>β</italic><sub><italic>g</italic><italic>l</italic>(<italic>k</italic>+1)</sub> and where we have <italic>K</italic> − 1 contrasts per lineage for a total of <italic>L</italic> (<italic>K</italic> − 1) contrasts.</p>
      <p id="Par54">startVsEndTest: By default, the startVsEndTest compares mean expression at the progenitor state (i.e., the start of the lineage) to mean expression at the differentiated state (i.e., the end of the lineage). Specifically, <bold>C</bold> is an (<italic>L</italic><italic>K</italic>) × <italic>L</italic> matrix, whose entry in row <italic>k</italic> + (<italic>l</italic> − 1)<italic>K</italic> and column <italic>l</italic> encodes the contrast for lineage <italic>l</italic> and knot <italic>k</italic> and is defined by <inline-formula id="IEq10"><alternatives><tex-math id="M25">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${b}_{k}({T}_{l,{\mathrm{max}}})-{b}_{k}({T}_{l,{\mathrm{min}}})$$\end{document}</tex-math><mml:math id="M26"><mml:msub><mml:mrow><mml:mi>b</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="normal">max</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi>b</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="normal">min</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="41467_2020_14766_Article_IEq10.gif"/></alternatives></inline-formula>, where <italic>T</italic><sub><italic>l</italic>,max</sub> =  <inline-formula id="IEq11"><alternatives><tex-math id="M27">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\max }_{\{i:i\in {{\mathcal{L}}}_{l}\}}$$\end{document}</tex-math><mml:math id="M28"><mml:msub><mml:mrow><mml:mi>max</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>:</mml:mo><mml:mi>i</mml:mi><mml:mo>∈</mml:mo><mml:msub><mml:mrow><mml:mi class="MJX-tex-caligraphic" mathvariant="script">L</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>}</mml:mo></mml:mrow></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2020_14766_Article_IEq11.gif"/></alternatives></inline-formula> <italic>T</italic><sub><italic>l</italic><italic>i</italic></sub> and <italic>T</italic><sub><italic>l</italic>,min</sub>= <inline-formula id="IEq12"><alternatives><tex-math id="M29">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\min }_{\{i:i\in {{\mathcal{L}}}_{l}\}}$$\end{document}</tex-math><mml:math id="M30"><mml:msub><mml:mrow><mml:mi>min</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>:</mml:mo><mml:mi>i</mml:mi><mml:mo>∈</mml:mo><mml:msub><mml:mrow><mml:mi class="MJX-tex-caligraphic" mathvariant="script">L</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>}</mml:mo></mml:mrow></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2020_14766_Article_IEq12.gif"/></alternatives></inline-formula> <italic>T</italic><sub><italic>l</italic><italic>i</italic></sub> denote, respectively, the maximum and minimum pseudotime across all cells assigned to lineage <italic>l</italic>. Other entries of <bold>C</bold> are set to zero. Therefore, the <italic>l</italic><sup>th</sup> element of the vector <bold>C</bold><sup><italic>T</italic></sup><bold><italic>β</italic></bold><sub><italic>g</italic></sub> is <inline-formula id="IEq13"><alternatives><tex-math id="M31">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\sum }_{k = 1}^{K}({b}_{k}({T}_{l,{\mathrm{max}}})-{b}_{k}({T}_{l,{\mathrm{min}}})){{\boldsymbol{\beta }}}_{glk}={s}_{gl}({T}_{l,{\mathrm{max}}})-{s}_{gl}({T}_{l,{\mathrm{min}}})$$\end{document}</tex-math><mml:math id="M32"><mml:msubsup><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>K</mml:mi></mml:mrow></mml:msubsup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>b</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="normal">max</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi>b</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="normal">min</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">β</mml:mi></mml:mrow><mml:mrow><mml:mi>g</mml:mi><mml:mi>l</mml:mi><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi>g</mml:mi><mml:mi>l</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="normal">max</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi>g</mml:mi><mml:mi>l</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="normal">min</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="41467_2020_14766_Article_IEq13.gif"/></alternatives></inline-formula>, which contrasts mean expression at the beginning and at the end of the lineage. Note that contrasting the start and endpoints of a lineage is a special case of a more general capability of tradeSeq to compare the mean expression between any two regions of a given lineage. As such, this test can be considered a generalization of cluster-based discrete DE within a lineage (e.g., Risso et al.<sup><xref ref-type="bibr" rid="CR25">25</xref></sup>).</p>
    </sec>
    <sec id="Sec15">
      <title>Between-lineage comparison tests</title>
      <p id="Par55">diffEndTest: The diffEndTest compares average expression at the differentiated states of multiple lineages, i.e., it compares the endpoints of different lineage-specific smoothers. It can be viewed as an analog of discrete DE for the differentiated cell types. The test is implemented using a Wald test statistic, as described above, where <bold>C</bold> is an (<italic>L</italic><italic>K</italic>) × <italic>L</italic> (<italic>L</italic> − 1)∕2 matrix. Each column of <bold>C</bold> encodes a pairwise contrast between the endpoints of two lineages, such that the corresponding element of <bold>C</bold><sup><italic>T</italic></sup><bold><italic>β</italic></bold><sub><italic>g</italic></sub> is <inline-formula id="IEq14"><alternatives><tex-math id="M33">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${s}_{g{l}_{1}}({T}_{{l}_{1},{\mathrm{max}}})-{s}_{g{l}_{2}}({T}_{{l}_{2},{\mathrm{max}}})$$\end{document}</tex-math><mml:math id="M34"><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi>g</mml:mi><mml:msub><mml:mrow><mml:mi>l</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>l</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi mathvariant="normal">max</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi>g</mml:mi><mml:msub><mml:mrow><mml:mi>l</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>l</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi mathvariant="normal">max</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="41467_2020_14766_Article_IEq14.gif"/></alternatives></inline-formula> for lineages <italic>l</italic><sub>1</sub> and <italic>l</italic><sub>2</sub>.</p>
      <p id="Par56">patternTest: This test compares the expression patterns along pseudotime between lineages by contrasting a fixed set of equally spaced pseudotimes (<italic>M</italic> = 100 by default). First selecting the pseudotimes and subsequently comparing their expression levels between lineages, allows for comparisons between smoothers of different lengths. Specifically, for lineage <italic>l</italic>, let <italic>P</italic><sub><italic>l</italic><italic>m</italic></sub> denote the <italic>m</italic>th equally spaced pseudotime between <inline-formula id="IEq15"><alternatives><tex-math id="M35">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${T}_{l,\min }$$\end{document}</tex-math><mml:math id="M36"><mml:msub><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi><mml:mo>,</mml:mo><mml:mi>min</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2020_14766_Article_IEq15.gif"/></alternatives></inline-formula> and <inline-formula id="IEq16"><alternatives><tex-math id="M37">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${T}_{l,\max }$$\end{document}</tex-math><mml:math id="M38"><mml:msub><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi><mml:mo>,</mml:mo><mml:mi>max</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2020_14766_Article_IEq16.gif"/></alternatives></inline-formula>. The contrast of <italic>M</italic> points corresponds to testing the null hypothesis that a gene has the same expression pattern along pseudotime across the lineages under comparison, while normalizing for the length of the lineages. The test is implemented using a Wald test statistic, as described above, where <bold>C</bold> is an (<italic>L</italic><italic>K</italic>) × <italic>L</italic> (<italic>L</italic> − 1)<italic>M</italic>∕2 matrix. Each column of <bold>C</bold> encodes a pairwise comparison between two pseudotimes of two different lineages, such that the corresponding element of <bold>C</bold><sup><italic>T</italic></sup><bold><italic>β</italic></bold><sub><italic>g</italic></sub> is <inline-formula id="IEq17"><alternatives><tex-math id="M39">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${s}_{g{l}_{1}}({P}_{{l}_{1}m})-{s}_{g{l}_{2}}({P}_{{l}_{2}m})$$\end{document}</tex-math><mml:math id="M40"><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi>g</mml:mi><mml:msub><mml:mrow><mml:mi>l</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>l</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mi>m</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi>g</mml:mi><mml:msub><mml:mrow><mml:mi>l</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>l</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mi>m</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="41467_2020_14766_Article_IEq17.gif"/></alternatives></inline-formula> for lineages <italic>l</italic><sub>1</sub> and <italic>l</italic><sub>2</sub> and <italic>m</italic> ∈ {1, …, <italic>M</italic>}. The test is implemented through the eigendecomposition of the estimated variance–covariance matrix of the contrasts to avoid singularity problems<sup><xref ref-type="bibr" rid="CR26">26</xref></sup> (see Supplementary Methods). It should be noted that this test is a general test, able to identify both differences in patterns of expression as well as genes with similar patterns but different mean expression across the pseudotime range. It is therefore most useful as a screening test to identify any form of differential expression between the lineages.</p>
      <p id="Par57">earlyDETest: The earlyDETest aims to identify genes that are differentiating around a branching of the trajectory. It is similar to the patternTest, in that it also compares the expression patterns along pseudotime between lineages by contrasting a fixed set of equally spaced pseudotimes (<italic>M</italic> = 100 by default). However, instead of using points distributed from the beginning <inline-formula id="IEq18"><alternatives><tex-math id="M41">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${T}_{l,\min }$$\end{document}</tex-math><mml:math id="M42"><mml:msub><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi><mml:mo>,</mml:mo><mml:mi>min</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2020_14766_Article_IEq18.gif"/></alternatives></inline-formula> to the end <inline-formula id="IEq19"><alternatives><tex-math id="M43">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${T}_{l,\max }$$\end{document}</tex-math><mml:math id="M44"><mml:msub><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi><mml:mo>,</mml:mo><mml:mi>max</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2020_14766_Article_IEq19.gif"/></alternatives></inline-formula> of the lineages as in the patternTest, it relies on points over a shorter range of time. In the current implementation, this range is delimited by the pseudotimes of two user-specified knots. The knots should be chosen to enclose the branching event (or any event of interest) and do not need to be consecutive.</p>
    </sec>
    <sec id="Sec16">
      <title>Global testing</title>
      <p id="Par58">While the statistical tests introduced above can assess DE within one lineage or between a pair of lineages, one may want to investigate multiple (i.e., more than two) lineages. For example, if a trajectory consists of three lineages, one may wish to test the global null hypothesis that, for each of the three lineages, there is no association between gene expression and pseudotime using the associationTest. The null hypothesis that would be tested can be expressed as <inline-formula id="IEq20"><alternatives><tex-math id="M45">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${H}_{0}:\forall l\,\text{and}\,\forall k\;\ne \;k^{\prime} ,\,{\beta }_{glk}={\beta }_{glk^{\prime} }$$\end{document}</tex-math><mml:math id="M46"><mml:msub><mml:mrow><mml:mi>H</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>:</mml:mo><mml:mo>∀</mml:mo><mml:mi>l</mml:mi><mml:mspace width="0.25em"/><mml:mi mathvariant="normal">and</mml:mi><mml:mspace width="0.25em"/><mml:mo>∀</mml:mo><mml:mi>k</mml:mi><mml:mspace width="0.16em"/><mml:mo>≠</mml:mo><mml:mspace width="0.16em"/><mml:msup><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:mspace width="0.25em"/><mml:msub><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:mi>g</mml:mi><mml:mi>l</mml:mi><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:mi>g</mml:mi><mml:mi>l</mml:mi><mml:msup><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2020_14766_Article_IEq20.gif"/></alternatives></inline-formula>, i.e., within each of the three lineages, all <italic>K</italic> regression coefficients are equal. We refer to such a test as a “global test”. The tradeSeq package provides functionality for global testing for each of the within and between-lineage tests described above. For within-lineage tests, the user can specify whether the test should be done for each lineage individually or at the global level (i.e., for all lineages). For between-lineage tests, the user can specify if a global test should be performed or whether all pairwise comparisons should be performed.</p>
    </sec>
    <sec id="Sec17">
      <title>Stage-wise testing</title>
      <p id="Par59">For the mouse olfactory epithelium case study<sup><xref ref-type="bibr" rid="CR17">17</xref></sup>, we apply stage-wise testing, as implemented in stageR<sup><xref ref-type="bibr" rid="CR27">27</xref>,<xref ref-type="bibr" rid="CR28">28</xref></sup>, to assess DE between lineages using multiple tests for each gene. Stage-wise testing aims to control the overall false discovery rate (OFDR)<sup><xref ref-type="bibr" rid="CR27">27</xref></sup>, i.e., the expected proportion of genes with at least one falsely rejected null hypothesis among all genes declared DE. In our case, the OFDR can be interpreted as a gene-level FDR<sup><xref ref-type="bibr" rid="CR28">28</xref></sup>. Stage-wise testing is performed in two stages, a screening and a confirmation stage. At the screening stage, each gene is screened by performing a global test across all null hypotheses of interest, essentially testing whether at least one of these hypotheses can be rejected. At that stage, the FDR is controlled across genes at level <italic>α</italic><sub><italic>I</italic></sub>. At the confirmation stage, each specific hypothesis is assessed, but only for the genes that have passed the screening stage. For each gene, the family-wise error rate (FWER) is controlled across hypotheses at level <inline-formula id="IEq21"><alternatives><tex-math id="M47">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\alpha }_{II}=\frac{R}{G}{\alpha }_{I}$$\end{document}</tex-math><mml:math id="M48"><mml:msub><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mi>I</mml:mi><mml:mi>I</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mrow><mml:mi>G</mml:mi></mml:mrow></mml:mfrac><mml:msub><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mi>I</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2020_14766_Article_IEq21.gif"/></alternatives></inline-formula>, where <italic>R</italic> denotes the number of genes that had their global null hypothesis rejected at the screening stage and <italic>G</italic> the total number of genes assessed. Heller et al.<sup><xref ref-type="bibr" rid="CR27">27</xref></sup> proved that this procedure controls the overall FDR at level <italic>α</italic><sub><italic>I</italic></sub>. It should be noted that, while the stage-wise testing paradigm theoretically controls the OFDR (given underlying assumptions are satisfied), the resulting <italic>p</italic>-values might still be too liberal since the same data are used for trajectory inference and differential expression. As mentioned before, we use <italic>p</italic>-values simply as numerical summaries for ranking the genes for further inspection.</p>
    </sec>
    <sec id="Sec18">
      <title>Clustering gene expression patterns</title>
      <p id="Par60">The NB-GAM can also be used to cluster genes according to their expression patterns, as shown in Fig. <xref rid="Fig1" ref-type="fig">1</xref>. Specifically, for each gene, we extract a number of fitted values for each lineage (100 by default). We can then use resampling-based sequential ensemble clustering (RSEC), as implemented in clusterExperiment<sup><xref ref-type="bibr" rid="CR25">25</xref></sup>, to perform the clustering based on (the top principal components of) the standardized fitted values matrix (i.e., the fitted values are standardized to have zero mean and unit variance across cells for each gene). Importantly, we allow for any clustering algorithm that is built-in into clusterExperiment or chosen by the user to perform the clustering. This clustering approach is implemented in the tradeSeq package (<italic>clusterExpressionPatterns</italic> function) for downstream analysis facilitating the interpretation of DE genes.</p>
    </sec>
    <sec id="Sec19">
      <title>Implementation</title>
      <p id="Par61">The above described fitting procedure, DE tests, and clustering of expression patterns are implemented in the open-source R package tradeSeq, available through the Bioconductor Project (<ext-link ext-link-type="uri" xlink:href="http://www.bioconductor.org/packages/release/bioc/html/tradeSeq.html">http://www.bioconductor.org/packages/release/bioc/html/tradeSeq.html</ext-link>). We provide an extensive vignette along with the package, as well as a cheat sheet describing the different types of DE patterns detected with each test.</p>
    </sec>
    <sec id="Sec20">
      <title>Methods comparison</title>
      <p id="Par62">slingshot is a fast and robust method for TI that was shown to be among the top-performing methods in a recent large-scale benchmarking study<sup><xref ref-type="bibr" rid="CR1">1</xref></sup>. Hence, we evaluate tradeSeq downstream of a slingshot analysis, which can work with any dimensionality reduction and clustering methods. slingshot builds a cluster-based minimum spanning tree (MST) to infer the global lineage topology and make an initial assignment of cells to lineages. This structure is then smoothed by fitting simultaneous principal curves, which refine the assignment of cells to lineages. This process results in lineage-specific pseudotimes and weights of assignment for each cell.</p>
      <p id="Par63">GPfates<sup><xref ref-type="bibr" rid="CR4">4</xref></sup> is a Python package that adopts Gaussian processes in reduced dimension to infer trajectories. Dimensionality reduction is performed using Gaussian process latent variable models (GPLVM)<sup><xref ref-type="bibr" rid="CR29">29</xref></sup>. GPfates is able to identify bifurcation points and assess how well a bifurcation fits the expression pattern of each gene, i.e., whether the patterns of gene expression are different between the lineages. This allows us to compare a slingshot + tradeSeq analysis with a GPfates analysis. In addition, we also evaluate a tradeSeq analysis downstream of TI with GPfates, since GPfates also calculates posterior probabilities that each cell belongs to a particular lineage. We then compare the complete GPfates (TI and DE) analysis to a GPfates + tradeSeq analysis.</p>
      <p id="Par64">Monocle 2<sup><xref ref-type="bibr" rid="CR5">5</xref></sup> applies reverse graph embedding to infer trajectories and yields a principal graph that is allowed to branch. It provides a similar approach as tradeSeq with the branch expression analysis modeling (BEAM) method. It assumes a gene-wise negative binomial model for gene expression, where the mean is expressed in terms of lineage-dependent smooth functions of pseudotime, i.e.,<disp-formula id="Equ4"><label>4</label><alternatives><tex-math id="M49">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathrm{log}}\,({\mu }_{gi})=\sum _{l=1}^{L}({\beta }_{0gl}+{s}_{gl}({T}_{li})).$$\end{document}</tex-math><mml:math id="M50"><mml:mi mathvariant="normal">log</mml:mi><mml:mspace width="0.25em"/><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mi>g</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:munderover accent="false" accentunder="false"><mml:mrow><mml:mo mathsize="big"> ∑</mml:mo></mml:mrow><mml:mrow><mml:mi>l</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>L</mml:mi></mml:mrow></mml:munderover><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn><mml:mi>g</mml:mi><mml:mi>l</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi>g</mml:mi><mml:mi>l</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:math><graphic xlink:href="41467_2020_14766_Article_Equ4.gif" position="anchor"/></alternatives></disp-formula>In this model, the lineage-specific intercepts <italic>β</italic><sub>0<italic>g</italic><italic>l</italic></sub> account for mean differences in expression between lineages, while the lineage-specific smoothers <italic>s</italic><sub><italic>g</italic><italic>l</italic></sub>(<italic>t</italic>) model the expression change along pseudotime. To test for lineage-dependent expression, the full model is compared with a null model of the form<disp-formula id="Equc"><alternatives><tex-math id="M51">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathrm{log}}\,({\mu }_{gi})={\beta }_{g0}+{s}_{g}({T}_{i})$$\end{document}</tex-math><mml:math id="M52"><mml:mi mathvariant="normal">log</mml:mi><mml:mspace width="0.25em"/><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mi>g</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:mi>g</mml:mi><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi>g</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:math><graphic xlink:href="41467_2020_14766_Article_Equc.gif" position="anchor"/></alternatives></disp-formula>using a likelihood ratio test. Thus, BEAM tests whether the smooth functions of gene expression along pseudotime are different between lineages. Importantly, BEAM is restricted to the dimensionality reduction methods that are implemented in Monocle 2, namely DDRTree<sup><xref ref-type="bibr" rid="CR5">5</xref></sup> and Independent Components Analysis (ICA). In addition, it only provides a screening test (like the patternTest in tradeSeq), as it only allows testing for any difference in expression profiles between lineages and does not specify the exact type of divergence.</p>
      <p id="Par65">An alpha release for Monocle 3 is available online (downloaded August 30, 2018 from the <ext-link ext-link-type="uri" xlink:href="https://github.com/cole-trapnell-lab/monocle-release/tree/monocle3_alpha">https://github.com/cole-trapnell-lab/monocle-release/tree/monocle3_alpha</ext-link>Monocle GitHub repository) which, unlike Monocle 2, performs uniform manifold approximation and projection (UMAP)<sup><xref ref-type="bibr" rid="CR30">30</xref></sup> dimensionality reduction upstream of the trajectory inference. In addition, Monocle 3 implements the Moran’s I test to discover genes whose expression is significantly associated with pseudotime; a functionality that is unavailable in Monocle 2.</p>
      <p id="Par66">ImpulseDE2<sup><xref ref-type="bibr" rid="CR31">31</xref></sup> also assumes a gene-wise negative binomial model for the expression counts, where the mean is expressed as a weighted combination of two sigmoid functions. This model essentially allows the estimation of three “state-specific expression values”, where the transitions between the states are modeled with the two sigmoid functions. The DE method is not linked to any trajectory inference procedure since it assumes that the pseudotime for each cell is known. In this paper, we use ImpulseDE2 downstream of slingshot. Prior to the fitting, ImpulseDE2 relies on DESeq2 for normalization and estimation of the NB dispersion parameter. However, DESeq2 cannot handle genes having at least one zero count, which is common in scRNA-seq. In such a scenario, we therefore “manually” estimate size factors and dispersion parameters using the DESeq2 poscounts normalization, which was developed to deal with this issue<sup><xref ref-type="bibr" rid="CR14">14</xref>,<xref ref-type="bibr" rid="CR32">32</xref></sup>.</p>
      <p id="Par67">edgeR<sup><xref ref-type="bibr" rid="CR33">33</xref></sup> is a discrete differential expression method, where the groups under comparison must be defined a priori. It is therefore useful for assessing DE between, for example, annotated clusters or different treatment groups. For such comparisons, edgeR is a powerful method with high sensitivity. Note that, while edgeR was originally developed for group-based differential expression, it would be possible to incorporate the basis functions of the smoothers as continuous covariates in the model. However, no regularization would be performed on the estimation of the smoother regression coefficients, hence the model would be prone to overfitting. A similar approach was evaluated in Fischer et al.<sup><xref ref-type="bibr" rid="CR31">31</xref></sup>, where DESeq2<sup><xref ref-type="bibr" rid="CR34">34</xref></sup> was used to fit splines by incorporating natural cubic basis functions in the linear predictor. In addition, edgeR does not provide an implementation of the DE tests in tradeSeq. Only the associationTest is readily available in edgeR by testing whether all basis function parameters are equal to zero; the other tests would require a similar development as presented in tradeSeq. Hence, while it is possible to fit smoothers by using edgeR, instead of mgcv, we emphasize that this would merely be an alternative and less general approach to fitting the NB-GAMs we propose in our paper.</p>
    </sec>
    <sec id="Sec21">
      <title>Simulation study</title>
      <p id="Par68">The simulation study evaluates methods that (differentially) associate gene expression with pseudotime for three different trajectory topologies, i.e., a cyclic, a bifurcating, and a multifurcating trajectory. As independent evaluation, we use the extensive trajectory simulation framework dynverse that previously served for benchmarking trajectory inference methods in Saelens et al.<sup><xref ref-type="bibr" rid="CR1">1</xref></sup>. Interested readers should refer to the original publication for details on the data simulation procedure. Data set characteristics are listed in Table <xref rid="Tab1" ref-type="table">1</xref>.<table-wrap id="Tab1"><label>Table 1</label><caption><p>Overview of simulated data sets.</p></caption><table frame="hsides" rules="groups"><thead><tr><th/><th>Cyclic data set</th><th>Bifurcating data set</th><th>Multifurcating data set</th></tr></thead><tbody><tr><td>Simulation framework</td><td><ext-link ext-link-type="uri" xlink:href="https://github.com/dynverse/dyngen">dyngen</ext-link></td><td><ext-link ext-link-type="uri" xlink:href="https://github.com/dynverse/dyntoy">dyntoy</ext-link></td><td><ext-link ext-link-type="uri" xlink:href="https://github.com/dynverse/dyntoy">dyntoy</ext-link></td></tr><tr><td>Number of cells</td><td>505–508</td><td>500</td><td>750</td></tr><tr><td>Number of genes</td><td>312–444</td><td>5000</td><td>5000</td></tr><tr><td>% of DE genes</td><td>42–47%</td><td>20%</td><td>20%</td></tr><tr><td>Number of lineages</td><td>1</td><td>2</td><td>3</td></tr><tr><td>Topology</td><td>Cyclic</td><td>Bifurcating</td><td>Multifurcating</td></tr><tr><td>Number of data sets</td><td>10</td><td>10</td><td>1</td></tr></tbody></table><table-wrap-foot><p>Each data set is simulated using one of the frameworks from the dynverse toolbox (dyngen or dyntoy), which are designed to simulate scRNA-seq data according to trajectory topologies. Each data set can be characterized by the topology of the trajectory, as well as the number of cells and genes. Low-dimensional representations of representative data sets can be found in Fig. <xref rid="Fig3" ref-type="fig">3</xref>. Note that the cyclic data sets have some variation in the numbers of genes and cells and in the amount of differential expression, which is inherent to the dyngen simulation framework.</p></table-wrap-foot></table-wrap></p>
      <p id="Par69">For each of the cyclic and bifurcating topologies, we generate and analyze ten data sets. Since the multifurcating topology is very variable across simulations due to its flexible definition, its analysis requires substantial supervision. Therefore, we analyze only one representative multifurcating data set.</p>
      <p id="Par70">Prior to trajectory inference, the simulated counts are normalized using full-quantile normalization<sup><xref ref-type="bibr" rid="CR35">35</xref>,<xref ref-type="bibr" rid="CR36">36</xref></sup>. For TI with slingshot, we apply principal component analysis (PCA) dimensionality reduction to the normalized counts and <italic>k</italic>-means clustering in PCA space. For the bifurcating and multifurcating trajectories, the start and end clusters of the true trajectory are provided to slingshot to aid it in inferring the trajectory. For the edgeR analysis, we assess DE between the end clusters that are also provided to slingshot. The BEAM method can only test one bifurcation point at a time. For the multifurcating data set, we therefore assessed both branching points separately and aggregated the <italic>p</italic>-values using Fisher’s method<sup><xref ref-type="bibr" rid="CR37">37</xref></sup>. For the tradeSeq and edgeR analyses of the multifurcating data set, we perform global tests across all three lineages.</p>
      <p id="Par71">We assess performance based on scatterplots of the true positive rate (TPR) vs. the false discovery proportion (FDP), according to the following definitions<disp-formula id="Equd"><alternatives><tex-math id="M53">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathrm{FDP}}= 	\, \frac{FP}{\max (1,FP\;+\;TP)}\\ {\mathrm{TPR}}= 	\, \frac{TP}{TP\;+\;FN},$$\end{document}</tex-math><mml:math id="M54"><mml:mi mathvariant="normal">FDP</mml:mi><mml:mo>=</mml:mo><mml:mspace width="0.25em"/><mml:mfrac><mml:mrow><mml:mi>F</mml:mi><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mi>max</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>F</mml:mi><mml:mi>P</mml:mi><mml:mspace width="0.16em"/><mml:mo>+</mml:mo><mml:mspace width="0.16em"/><mml:mi>T</mml:mi><mml:mi>P</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mfrac><mml:mi mathvariant="normal">TPR</mml:mi><mml:mo>=</mml:mo><mml:mspace width="0.25em"/><mml:mfrac><mml:mrow><mml:mi>T</mml:mi><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mi>T</mml:mi><mml:mi>P</mml:mi><mml:mspace width="0.16em"/><mml:mo>+</mml:mo><mml:mspace width="0.16em"/><mml:mi>F</mml:mi><mml:mi>N</mml:mi></mml:mrow></mml:mfrac><mml:mo>,</mml:mo></mml:math><graphic xlink:href="41467_2020_14766_Article_Equd.gif" position="anchor"/></alternatives></disp-formula>where <italic>F</italic><italic>N</italic>, <italic>F</italic><italic>P</italic>, and <italic>T</italic><italic>P</italic> denote, respectively, the numbers of false negatives, false positives, and true positives. FDP-TPR curves are calculated and plotted with the Bioconductor R package iCOBRA<sup><xref ref-type="bibr" rid="CR38">38</xref></sup>.</p>
    </sec>
    <sec id="Sec22">
      <title>Case studies</title>
      <p id="Par72">Bulk RNA-seq time-course data set: As proof-of-principle case study, we analyze a bulk RNA-seq time-course data set from Kiselev et al.<sup><xref ref-type="bibr" rid="CR39">39</xref></sup> with tradeSeq. The data were downloaded from the GitHub repository at <ext-link ext-link-type="uri" xlink:href="https://github.com/daniel-spies/rna-seq_tcComp">https://github.com/daniel-spies/rna-seq_tcComp</ext-link>, and the original differential expression results were downloaded from <ext-link ext-link-type="uri" xlink:href="https://github.com/wikiselev/rnaseq.mcf10a/tree/master/data">https://github.com/wikiselev/rnaseq.mcf10a/tree/master/data</ext-link>.</p>
      <p id="Par73">Mouse bone marrow data set: We use as second case study the mouse haematopoiesis scRNA-seq data set of Paul et al.<sup><xref ref-type="bibr" rid="CR15">15</xref></sup>. Two small cell clusters corresponding to the dendritic and eosinophyl cell types were removed from the trajectory inference and downstream DE analysis, since these are outlying cell types that do not seem to belong to any particular lineage (Supplementary Fig. <xref rid="MOESM2" ref-type="media">2</xref>). We use the same data set as the Monocle 3 vignette, which was prefiltered to contain genes with relatively high expression. After filtering, the data set consists of 3004 genes and 2660 cells.</p>
      <p id="Par74">tradeSeq downstream of slingshot is compared with the BEAM approach from Monocle 2. Since BEAM is restricted to the dimensionality reduction methods implemented in the package, we use independent components analysis for both slingshot and Monocle 2 in this comparison. For Monocle 2, we specify the argument num_paths=2 to aid it in inferring two lineages.</p>
      <p id="Par75">Subsequently, we demonstrate a tradeSeq analysis downstream of slingshot by performing dimensionality reduction using UMAP<sup><xref ref-type="bibr" rid="CR30">30</xref></sup>, following the data processing pipeline described in the <ext-link ext-link-type="uri" xlink:href="http://cole-trapnell-lab.github.io/monocle-release/monocle3/#tutorial-1-learning-trajectories-with-monocle-3">http://cole-trapnell-lab.github.io/monocle-release/monocle3/#tutorial-1-learning-trajectories-with-monocle-3</ext-link>Monocle 3 vignette, since this better reflects the biology of the experiment.</p>
      <p id="Par76">In this case study, we show how one can perform multiple tests to identify genes with distinct types of behavior, specifically, genes that are deemed DE for one test (test 1), but not another (test 2). Let <inline-formula id="IEq22"><alternatives><tex-math id="M55">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${W}_{g}^{(\tau )}$$\end{document}</tex-math><mml:math id="M56"><mml:msubsup><mml:mrow><mml:mi>W</mml:mi></mml:mrow><mml:mrow><mml:mi>g</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>τ</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="41467_2020_14766_Article_IEq22.gif"/></alternatives></inline-formula> denotes the test statistic for gene <italic>g</italic> in test <italic>τ</italic> ∈ {1, 2} and <inline-formula id="IEq23"><alternatives><tex-math id="M57">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\,\text{rk}\,}_{g}^{(\tau )}$$\end{document}</tex-math><mml:math id="M58"><mml:msubsup><mml:mrow><mml:mspace width="0.25em"/><mml:mi mathvariant="normal">rk</mml:mi><mml:mspace width="0.25em"/></mml:mrow><mml:mrow><mml:mi>g</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>τ</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="41467_2020_14766_Article_IEq23.gif"/></alternatives></inline-formula> denotes the rank (in terms of ordering from low to high) of <inline-formula id="IEq24"><alternatives><tex-math id="M59">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${W}_{g}^{(\tau )}$$\end{document}</tex-math><mml:math id="M60"><mml:msubsup><mml:mrow><mml:mi>W</mml:mi></mml:mrow><mml:mrow><mml:mi>g</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>τ</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="41467_2020_14766_Article_IEq24.gif"/></alternatives></inline-formula> among all <italic>G</italic> test statistics associated with the <italic>G</italic> genes. Then, define a score for each gene <italic>g</italic> as <inline-formula id="IEq25"><alternatives><tex-math id="M61">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\text{score}}_{g}={({\text{rk}}_{g}^{(1)})}^{2}+{(G-{\text{rk}}_{g}^{(2)})}^{2}$$\end{document}</tex-math><mml:math id="M62"><mml:msub><mml:mrow><mml:mi mathvariant="normal">score</mml:mi></mml:mrow><mml:mrow><mml:mi>g</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msubsup><mml:mrow><mml:mi mathvariant="normal">rk</mml:mi></mml:mrow><mml:mrow><mml:mi>g</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:msubsup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo>+</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>G</mml:mi><mml:mo>−</mml:mo><mml:msubsup><mml:mrow><mml:mi mathvariant="normal">rk</mml:mi></mml:mrow><mml:mrow><mml:mi>g</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:msubsup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:math><inline-graphic xlink:href="41467_2020_14766_Article_IEq25.gif"/></alternatives></inline-formula>. Genes with high scores are genes which are expected to be DE for test 1, but not DE for test 2 and vice versa. This is used to identify genes that are DE with the patternTest (test 1) but not the diffEndTest (test 2), i.e., genes that are transiently DE between lineages. Note that the procedure only provides a ranking of the genes and not an evaluation of statistical significance.</p>
      <p id="Par77">Mouse olfactory epithelium data set: The olfactory epithelium (OE) data set from Fletcher et al.<sup><xref ref-type="bibr" rid="CR17">17</xref></sup> is our third case study. We use the lineages discovered in the original paper. Prior to the analysis, the data set is filtered to retain genes with reasonably high expression; we consider 14,261 genes and 616 cells for downstream analysis. In brief, counts are normalized using full-quantile normalization<sup><xref ref-type="bibr" rid="CR35">35</xref>,<xref ref-type="bibr" rid="CR36">36</xref></sup> followed by regression-based adjustment for quality control variables<sup><xref ref-type="bibr" rid="CR17">17</xref></sup>. Dimensionality reduction is performed through PCA on the normalized log-transformed counts that are offset by 1 to avoid taking the log of zero, i.e., <inline-formula id="IEq26"><alternatives><tex-math id="M63">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathrm{log}}\,(y+1)$$\end{document}</tex-math><mml:math id="M64"><mml:mi mathvariant="normal">log</mml:mi><mml:mspace width="0.25em"/><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>y</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="41467_2020_14766_Article_IEq26.gif"/></alternatives></inline-formula>. Clustering is performed through <italic>k</italic>-means on the first 50 principal components by varying the number of clusters <italic>k</italic> ∈ {4, …, 15}; stable clusters are derived using clusterExperiment<sup><xref ref-type="bibr" rid="CR25">25</xref></sup>, yielding a final repertoire of 13 cell clusters. Next, slingshot is used to infer trajectories with the initial cluster chosen by known marker genes of horizontal basal cells (HBC), an adult stem cell population. A double bifurcation is discovered, with the first giving rise to sustentacular cells and two more lineages that split into microvillous cells and olfactory sensory neurons. The data were downloaded from GEO with accession number GSE95601.</p>
      <p id="Par78">Adipocyte differentiation data set: As final case study, we analyze a 10× Genomics adipocyte differentiation data set described in Merrick et al.<sup><xref ref-type="bibr" rid="CR40">40</xref></sup>. The gene expression counts were downloaded from GEO with accession number GSE128889. We focus the analysis on the single cells collected from 12-day-old mice. The raw data set consists of 27,998 genes and 11,423 cells. We only retain genes with a count of at least 2 in at least 400 cells, and normalize the data using full-quantile normalization<sup><xref ref-type="bibr" rid="CR35">35</xref></sup>. Since not all cells in the data set are involved in the adipocyte differentiation process, we first identify the relevant clusters of cells using the marker genes described in the original manuscript. We apply <italic>k</italic>-means clustering (<italic>k</italic> = 10) to the top eight principal components of log-transformed counts. Using this clustering, we identify the relevant clusters based on the reported markers, and subsequently apply UMAP dimensionality reduction<sup><xref ref-type="bibr" rid="CR30">30</xref>,<xref ref-type="bibr" rid="CR41">41</xref></sup> to the top 20 principal components for that subset of cells. The processed data set consists of 2851 genes and 8071 cells. We use slingshot<sup><xref ref-type="bibr" rid="CR3">3</xref></sup> for trajectory inference in two-dimensional UMAP space.</p>
    </sec>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary information</title>
    <sec id="Sec23">
      <p>
        <supplementary-material content-type="local-data" id="MOESM1">
          <media xlink:href="41467_2020_14766_MOESM1_ESM.pdf">
            <caption>
              <p>Peer Review File</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM2">
          <media xlink:href="41467_2020_14766_MOESM2_ESM.pdf">
            <caption>
              <p>Supplementary Information</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM3">
          <media xlink:href="41467_2020_14766_MOESM3_ESM.pdf">
            <caption>
              <p>Peer Review File</p>
            </caption>
          </media>
        </supplementary-material>
      </p>
    </sec>
  </sec>
</body>
<back>
  <fn-group>
    <fn>
      <p><bold>Peer review information</bold> <italic>Nature Communications</italic> thanks the anonymous reviewers for their contribution to the peer review of this work. Peer reviewer reports are available</p>
    </fn>
    <fn>
      <p><bold>Publisher’s note</bold> Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p>
    </fn>
    <fn>
      <p>These authors contributed equally: Sandrine Dudoit, Lieven Clement.</p>
    </fn>
  </fn-group>
  <sec>
    <title>Supplementary information</title>
    <p><bold>Supplementary information</bold> is available for this paper at 10.1038/s41467-020-14766-3.</p>
  </sec>
  <ack>
    <title>Acknowledgements</title>
    <p>We thank Valentine Svensson for his help on the implementation and interpretation of the output of the GPfates method. Olivier Thas and Catalina Vallejos provided constructive feedback on a draft of the paper. K.V.d.B. is a postdoctoral fellow from the Belgian Americal Educational Foundation (BAEF) and is supported by the Research Foundation Flanders (FWO), research grants G062219N, 1S41818N, and 1246220N, and travel grant 148095. W.S. and R.C. are supported by the Research Foundation Flanders (FWO, grants 11Z4518N and 11Y6218N, respectively). Y.S. is an ISAC Marylou Ingram scholar. S.D., and H.R.d.B. are supported by a grant from the National Institutes of Health BRAIN Initiative Cell Census Program (1U19MH114830-01). L.C. is supported by the Research Foundation Flanders (FWO), grant G062219N. This research received funding from the Flemish Government under the “Onderzoeksprogramma Artificiële Intelligentie (AI) Vlaanderen” program.</p>
  </ack>
  <notes notes-type="author-contribution">
    <title>Author contributions</title>
    <p>K.V.d.B., H.R.d.B., K.S., S.D., and L.C. conceived and designed the study. K.V.d.B. and H.R.d.B. implemented the method. K.V.d.B., H.R.d.B., and K.S. analyzed the data. W.S., R.C., and Y.S. generated the synthetic data. K.V.d.B., H.R.d.B., K.S., S.D., and L.C. wrote the paper; and W.S., R.C., and Y.S. contributed to revisions of an initial draft.</p>
  </notes>
  <notes notes-type="data-availability">
    <title>Data availability</title>
    <p>The code to generate all simulated data sets is included in the GitHub repository of the paper at <ext-link ext-link-type="uri" xlink:href="https://github.com/statOmics/tradeSeqPaper">https://github.com/statOmics/tradeSeqPaper</ext-link>. The data for the mouse bone marrow case study were downloaded from <ext-link ext-link-type="uri" xlink:href="http://trapnell-lab.gs.washington.edu/public_share/valid_subset_GSE72857_cds2.RDS">http://trapnell-lab.gs.washington.edu/public_share/valid_subset_GSE72857_cds2.RDS</ext-link>. The raw data for the olfactory epithelium case study are available on GEO with accession number <ext-link ext-link-type="uri" xlink:href="https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE95601">https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE95601</ext-link>.</p>
  </notes>
  <notes notes-type="data-availability">
    <title>Code availability</title>
    <p>The code to reproduce the analyses, figures, and tables in the paper is available on GitHub at <ext-link ext-link-type="uri" xlink:href="https://github.com/statOmics/tradeSeqPaper">https://github.com/statOmics/tradeSeqPaper</ext-link>. The tradeSeq open-source R package is available through the Bioconductor Project at <ext-link ext-link-type="uri" xlink:href="http://www.bioconductor.org/packages/release/bioc/html/tradeSeq.html">http://www.bioconductor.org/packages/release/bioc/html/tradeSeq.html</ext-link>.</p>
  </notes>
  <notes notes-type="COI-statement">
    <title>Competing interests</title>
    <p id="Par79">The authors declare no competing interests.</p>
  </notes>
  <ref-list id="Bib1">
    <title>References</title>
    <ref id="CR1">
      <label>1.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Saelens</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Cannoodt</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Todorov</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Saeys</surname>
            <given-names>Y</given-names>
          </name>
        </person-group>
        <article-title>A comparison of single-cell trajectory inference methods</article-title>
        <source>Nat. Biotechnol.</source>
        <year>2019</year>
        <volume>37</volume>
        <fpage>547</fpage>
        <lpage>554</lpage>
        <pub-id pub-id-type="doi">10.1038/s41587-019-0071-9</pub-id>
        <pub-id pub-id-type="pmid">30936559</pub-id>
      </element-citation>
    </ref>
    <ref id="CR2">
      <label>2.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Cannoodt</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Saelens</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Saeys</surname>
            <given-names>Y</given-names>
          </name>
        </person-group>
        <article-title>Computational methods for trajectory inference from single-cell transcriptomics</article-title>
        <source>Eur. J. Immunol.</source>
        <year>2016</year>
        <volume>46</volume>
        <fpage>2496</fpage>
        <lpage>2506</lpage>
        <pub-id pub-id-type="doi">10.1002/eji.201646347</pub-id>
        <pub-id pub-id-type="pmid">27682842</pub-id>
      </element-citation>
    </ref>
    <ref id="CR3">
      <label>3.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Street</surname>
            <given-names>K</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Slingshot: cell lineage and pseudotime inference for single-cell transcriptomics</article-title>
        <source>BMC Genomics</source>
        <year>2018</year>
        <volume>19</volume>
        <fpage>477</fpage>
        <pub-id pub-id-type="doi">10.1186/s12864-018-4772-0</pub-id>
        <pub-id pub-id-type="pmid">29914354</pub-id>
      </element-citation>
    </ref>
    <ref id="CR4">
      <label>4.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lönnberg</surname>
            <given-names>T</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Single-cell RNA-seq and computational analysis using temporal mixture modelling resolves Th1/Tfh fate bifurcation in malaria</article-title>
        <source>Sci. Immunol.</source>
        <year>2017</year>
        <volume>2</volume>
        <fpage>3</fpage>
        <pub-id pub-id-type="doi">10.1126/sciimmunol.aal2192</pub-id>
      </element-citation>
    </ref>
    <ref id="CR5">
      <label>5.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Qiu</surname>
            <given-names>X</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Reversed graph embedding resolves complex single-cell trajectories</article-title>
        <source>Nat. Methods</source>
        <year>2017</year>
        <volume>14</volume>
        <fpage>979</fpage>
        <lpage>982</lpage>
        <pub-id pub-id-type="doi">10.1038/nmeth.4402</pub-id>
        <pub-id pub-id-type="pmid">28825705</pub-id>
      </element-citation>
    </ref>
    <ref id="CR6">
      <label>6.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Byrnes</surname>
            <given-names>LE</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Lineage dynamics of murine pancreatic development at single-cell resolution</article-title>
        <source>Nat. Commun.</source>
        <year>2018</year>
        <volume>9</volume>
        <fpage>3922</fpage>
        <pub-id pub-id-type="doi">10.1038/s41467-018-06176-3</pub-id>
        <pub-id pub-id-type="pmid">30254276</pub-id>
      </element-citation>
    </ref>
    <ref id="CR7">
      <label>7.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Herring</surname>
            <given-names>CA</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Unsupervised trajectory analysis of single-cell RNA-Seq and imaging data reveals alternative tuft cell origins in the gut</article-title>
        <source>Cell Syst.</source>
        <year>2018</year>
        <volume>6</volume>
        <fpage>37</fpage>
        <lpage>51</lpage>
        <pub-id pub-id-type="doi">10.1016/j.cels.2017.10.012</pub-id>
        <pub-id pub-id-type="pmid">29153838</pub-id>
      </element-citation>
    </ref>
    <ref id="CR8">
      <label>8.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Nueda</surname>
            <given-names>MJ</given-names>
          </name>
          <name>
            <surname>Tarazona</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Conesa</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>Next maSigPro: updating maSigPro bioconductor package for RNA-seq time series</article-title>
        <source>Bioinformatics</source>
        <year>2014</year>
        <volume>30</volume>
        <fpage>2598</fpage>
        <lpage>2602</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btu333</pub-id>
        <pub-id pub-id-type="pmid">24894503</pub-id>
      </element-citation>
    </ref>
    <ref id="CR9">
      <label>9.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Sanavia</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Finotello</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Di Camillo</surname>
            <given-names>B</given-names>
          </name>
        </person-group>
        <article-title>FunPat: function-based pattern analysis on RNA-seq time series data</article-title>
        <source>BMC Genomics</source>
        <year>2015</year>
        <volume>16</volume>
        <fpage>S2</fpage>
        <pub-id pub-id-type="doi">10.1186/1471-2164-16-S6-S2</pub-id>
      </element-citation>
    </ref>
    <ref id="CR10">
      <label>10.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bacher</surname>
            <given-names>R</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Trendy: segmented regression analysis of expression dynamics in high-throughput ordered profiling experiments</article-title>
        <source>BMC Bioinform.</source>
        <year>2018</year>
        <volume>19</volume>
        <fpage>380</fpage>
        <pub-id pub-id-type="doi">10.1186/s12859-018-2405-x</pub-id>
      </element-citation>
    </ref>
    <ref id="CR11">
      <label>11.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Trapnell</surname>
            <given-names>C</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>The dynamics and regulators of cell fate decisions are revealed by pseudotemporal ordering of single cells</article-title>
        <source>Nat. Biotechnol.</source>
        <year>2014</year>
        <volume>32</volume>
        <fpage>381</fpage>
        <lpage>386</lpage>
        <pub-id pub-id-type="doi">10.1038/nbt.2859</pub-id>
        <pub-id pub-id-type="pmid">24658644</pub-id>
      </element-citation>
    </ref>
    <ref id="CR12">
      <label>12.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ji</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Ji</surname>
            <given-names>H</given-names>
          </name>
        </person-group>
        <article-title>TSCAN: Pseudo-time reconstruction and evaluation in single-cell RNA-seq analysis</article-title>
        <source>Nucleic Acids Res.</source>
        <year>2016</year>
        <volume>44</volume>
        <fpage>e117</fpage>
        <lpage>e117</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/gkw430</pub-id>
        <pub-id pub-id-type="pmid">27179027</pub-id>
      </element-citation>
    </ref>
    <ref id="CR13">
      <label>13.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lázaro-Gredilla</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Van Vaerenbergh</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Lawrence</surname>
            <given-names>ND</given-names>
          </name>
        </person-group>
        <article-title>Overlapping mixtures of Gaussian processes for the data association problem</article-title>
        <source>Pattern Recogn.</source>
        <year>2012</year>
        <volume>45</volume>
        <fpage>1386</fpage>
        <lpage>1395</lpage>
        <pub-id pub-id-type="doi">10.1016/j.patcog.2011.10.004</pub-id>
      </element-citation>
    </ref>
    <ref id="CR14">
      <label>14.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Van den Berge</surname>
            <given-names>K</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Observation weights unlock bulk RNA-seq tools for zero inflation and single-cell applications</article-title>
        <source>Genome Biol.</source>
        <year>2018</year>
        <volume>19</volume>
        <fpage>24</fpage>
        <pub-id pub-id-type="doi">10.1186/s13059-018-1406-4</pub-id>
        <pub-id pub-id-type="pmid">29478411</pub-id>
      </element-citation>
    </ref>
    <ref id="CR15">
      <label>15.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Paul</surname>
            <given-names>F</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Transcriptional heterogeneity and lineage commitment in myeloid progenitors</article-title>
        <source>Cell</source>
        <year>2015</year>
        <volume>163</volume>
        <fpage>1663</fpage>
        <lpage>1677</lpage>
        <pub-id pub-id-type="doi">10.1016/j.cell.2015.11.013</pub-id>
        <pub-id pub-id-type="pmid">26627738</pub-id>
      </element-citation>
    </ref>
    <ref id="CR16">
      <label>16.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Benjamini</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Hochberg</surname>
            <given-names>Y</given-names>
          </name>
        </person-group>
        <article-title>Controlling the false discovery rate: a practical and powerful approach to multiple testing</article-title>
        <source>J. R. Stat. Soc. Series B</source>
        <year>1995</year>
        <volume>57</volume>
        <fpage>289</fpage>
        <lpage>300</lpage>
      </element-citation>
    </ref>
    <ref id="CR17">
      <label>17.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Fletcher</surname>
            <given-names>RB</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Deconstructing olfactory stem cell trajectories at single-cell resolution</article-title>
        <source>Cell Stem Cell</source>
        <year>2017</year>
        <volume>20</volume>
        <fpage>817</fpage>
        <lpage>830</lpage>
        <pub-id pub-id-type="doi">10.1016/j.stem.2017.04.003</pub-id>
        <pub-id pub-id-type="pmid">28506465</pub-id>
      </element-citation>
    </ref>
    <ref id="CR18">
      <label>18.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hegg</surname>
            <given-names>CC</given-names>
          </name>
          <name>
            <surname>Jia</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Chick</surname>
            <given-names>WS</given-names>
          </name>
          <name>
            <surname>Restrepo</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Hansen</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>Microvillous cells expressing IP3 receptor type 3 in the olfactory epithelium of mice</article-title>
        <source>Eur. J. Neurosci.</source>
        <year>2010</year>
        <volume>32</volume>
        <fpage>1632</fpage>
        <lpage>1645</lpage>
        <pub-id pub-id-type="doi">10.1111/j.1460-9568.2010.07449.x</pub-id>
        <pub-id pub-id-type="pmid">20958798</pub-id>
      </element-citation>
    </ref>
    <ref id="CR19">
      <label>19.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Risso</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Perraudeau</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Gribkova</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Dudoit</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Vert</surname>
            <given-names>J-P</given-names>
          </name>
        </person-group>
        <article-title>A general and flexible method for signal extraction from single-cell RNA-seq data</article-title>
        <source>Nat. Commun.</source>
        <year>2018</year>
        <volume>9</volume>
        <fpage>284</fpage>
        <pub-id pub-id-type="doi">10.1038/s41467-017-02554-5</pub-id>
        <pub-id pub-id-type="pmid">29348443</pub-id>
      </element-citation>
    </ref>
    <ref id="CR20">
      <label>20.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Boukouvalas</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Hensman</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Rattray</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>BGP: identifying gene-specific branching dynamics from single-cell data with a branching Gaussian process</article-title>
        <source>Genome Biol.</source>
        <year>2018</year>
        <volume>19</volume>
        <fpage>65</fpage>
        <pub-id pub-id-type="doi">10.1186/s13059-018-1440-2</pub-id>
        <pub-id pub-id-type="pmid">29843817</pub-id>
      </element-citation>
    </ref>
    <ref id="CR21">
      <label>21.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Alpert</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Moore</surname>
            <given-names>LS</given-names>
          </name>
          <name>
            <surname>Dubovik</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Shen-Orr</surname>
            <given-names>SS</given-names>
          </name>
        </person-group>
        <article-title>Alignment of single-cell trajectories to compare cellular expression dynamics</article-title>
        <source>Nat. Methods</source>
        <year>2018</year>
        <volume>15</volume>
        <fpage>267</fpage>
        <lpage>270</lpage>
        <pub-id pub-id-type="doi">10.1038/nmeth.4628</pub-id>
        <pub-id pub-id-type="pmid">29529018</pub-id>
      </element-citation>
    </ref>
    <ref id="CR22">
      <label>22.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Chen</surname>
            <given-names>H</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Single-cell trajectories reconstruction, exploration and mapping of omics data with STREAM</article-title>
        <source>Nat. Commun.</source>
        <year>2019</year>
        <volume>10</volume>
        <fpage>1903</fpage>
        <pub-id pub-id-type="doi">10.1038/s41467-019-09670-4</pub-id>
        <pub-id pub-id-type="pmid">31015418</pub-id>
      </element-citation>
    </ref>
    <ref id="CR23">
      <label>23.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wood</surname>
            <given-names>SN</given-names>
          </name>
          <name>
            <surname>Pya</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Säfken</surname>
            <given-names>B</given-names>
          </name>
        </person-group>
        <article-title>Smoothing parameter and model selection for general smooth models</article-title>
        <source>J. Am. Stat. Assoc.</source>
        <year>2016</year>
        <volume>111</volume>
        <fpage>1548</fpage>
        <lpage>1563</lpage>
        <pub-id pub-id-type="doi">10.1080/01621459.2016.1180986</pub-id>
      </element-citation>
    </ref>
    <ref id="CR24">
      <label>24.</label>
      <mixed-citation publication-type="other">Wood, S. N.   <italic>Generalized Additive Models: An Introduction with R</italic>., 2nd edn. (Chapman and Hall/CRC, Boca Ration, FL, 2017).</mixed-citation>
    </ref>
    <ref id="CR25">
      <label>25.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Risso</surname>
            <given-names>D</given-names>
          </name>
        </person-group>
        <article-title>clusterExperiment and RSEC: A Bioconductor package and framework for clustering of single-cell and other large gene expression datasets</article-title>
        <source>PLoS Comput. Biol.</source>
        <year>2018</year>
        <volume>14</volume>
        <fpage>e1006378</fpage>
        <pub-id pub-id-type="doi">10.1371/journal.pcbi.1006378</pub-id>
        <pub-id pub-id-type="pmid">30180157</pub-id>
      </element-citation>
    </ref>
    <ref id="CR26">
      <label>26.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Smyth</surname>
            <given-names>GK</given-names>
          </name>
        </person-group>
        <article-title>Linear models and empirical bayes methods for assessing differential expression in microarray experiments</article-title>
        <source>Stat. Appl. Genet. Mol. Biol.</source>
        <year>2004</year>
        <volume>3</volume>
        <fpage>1</fpage>
        <lpage>26</lpage>
        <pub-id pub-id-type="doi">10.2202/1544-6115.1027</pub-id>
      </element-citation>
    </ref>
    <ref id="CR27">
      <label>27.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Heller</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Manduchi</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Grant</surname>
            <given-names>GR</given-names>
          </name>
          <name>
            <surname>Ewens</surname>
            <given-names>WJ</given-names>
          </name>
        </person-group>
        <article-title>A flexible two-stage procedure for identifying gene sets that are differentially expressed</article-title>
        <source>Bioinformatics</source>
        <year>2009</year>
        <volume>25</volume>
        <fpage>1019</fpage>
        <lpage>1025</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btp076</pub-id>
        <pub-id pub-id-type="pmid">19213738</pub-id>
      </element-citation>
    </ref>
    <ref id="CR28">
      <label>28.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Van den Berge</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Soneson</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Robinson</surname>
            <given-names>MD</given-names>
          </name>
          <name>
            <surname>Clement</surname>
            <given-names>L</given-names>
          </name>
        </person-group>
        <article-title>stageR: a general stage-wise method for controlling the gene-level false discovery rate in differential expression and differential transcript usage</article-title>
        <source>Genome Biol.</source>
        <year>2017</year>
        <volume>18</volume>
        <fpage>151</fpage>
        <pub-id pub-id-type="doi">10.1186/s13059-017-1277-0</pub-id>
        <pub-id pub-id-type="pmid">28784146</pub-id>
      </element-citation>
    </ref>
    <ref id="CR29">
      <label>29.</label>
      <mixed-citation publication-type="other">Lawrence, N. D.  Gaussian process latent variable models for visualisation of high dimensional data. in <italic>NIPS’03 Proceedings of the 16th International Conference on Neural Information Processing Systems</italic>, Advances in neural information processing systems 16, 329–336 (2003).</mixed-citation>
    </ref>
    <ref id="CR30">
      <label>30.</label>
      <mixed-citation publication-type="other">McInnes, L., Healy, J. &amp; Melville, J. UMAP: uniform manifold approximation and projection for dimension reduction. Preprint at <ext-link ext-link-type="uri" xlink:href="https://arxiv.org/abs/1802.03426">https://arxiv.org/abs/1802.03426</ext-link> (2018).</mixed-citation>
    </ref>
    <ref id="CR31">
      <label>31.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Fischer</surname>
            <given-names>DS</given-names>
          </name>
          <name>
            <surname>Theis</surname>
            <given-names>FJ</given-names>
          </name>
          <name>
            <surname>Yosef</surname>
            <given-names>N</given-names>
          </name>
        </person-group>
        <article-title>Impulse model-based differential expression analysis of time course sequencing data</article-title>
        <source>Nucleic Acids Res.</source>
        <year>2018</year>
        <volume>46</volume>
        <fpage>e119</fpage>
        <lpage>e119</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/gky221</pub-id>
        <pub-id pub-id-type="pmid">30102402</pub-id>
      </element-citation>
    </ref>
    <ref id="CR32">
      <label>32.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>McMurdie</surname>
            <given-names>PJ</given-names>
          </name>
          <name>
            <surname>Holmes</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>phyloseq: an R package for reproducible interactive analysis and graphics of microbiome census data</article-title>
        <source>PLoS One</source>
        <year>2013</year>
        <volume>8</volume>
        <fpage>e61217</fpage>
        <pub-id pub-id-type="doi">10.1371/journal.pone.0061217</pub-id>
        <pub-id pub-id-type="pmid">23630581</pub-id>
      </element-citation>
    </ref>
    <ref id="CR33">
      <label>33.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>McCarthy</surname>
            <given-names>DJ</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Smyth</surname>
            <given-names>GK</given-names>
          </name>
        </person-group>
        <article-title>Differential expression analysis of multifactor RNA-Seq experiments with respect to biological variation</article-title>
        <source>Nucleic Acids Res.</source>
        <year>2012</year>
        <volume>40</volume>
        <fpage>4288</fpage>
        <lpage>4297</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/gks042</pub-id>
        <pub-id pub-id-type="pmid">22287627</pub-id>
      </element-citation>
    </ref>
    <ref id="CR34">
      <label>34.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Love</surname>
            <given-names>MI</given-names>
          </name>
          <name>
            <surname>Huber</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Anders</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>Moderated estimation of fold change and dispersion for RNA-seq data with DESeq2</article-title>
        <source>Genome Biol.</source>
        <year>2014</year>
        <volume>15</volume>
        <fpage>550</fpage>
        <pub-id pub-id-type="doi">10.1186/s13059-014-0550-8</pub-id>
        <pub-id pub-id-type="pmid">25516281</pub-id>
      </element-citation>
    </ref>
    <ref id="CR35">
      <label>35.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bolstad</surname>
            <given-names>BM</given-names>
          </name>
          <name>
            <surname>Irizarry</surname>
            <given-names>RA</given-names>
          </name>
          <name>
            <surname>Astrand</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Speed</surname>
            <given-names>TP</given-names>
          </name>
        </person-group>
        <article-title>A comparison of normalization methods for high density oligonucleotide array data based on variance and bias</article-title>
        <source>Bioinformatics</source>
        <year>2003</year>
        <volume>19</volume>
        <fpage>185</fpage>
        <lpage>93</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/19.2.185</pub-id>
        <pub-id pub-id-type="pmid">12538238</pub-id>
      </element-citation>
    </ref>
    <ref id="CR36">
      <label>36.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bullard</surname>
            <given-names>JH</given-names>
          </name>
          <name>
            <surname>Purdom</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Hansen</surname>
            <given-names>KD</given-names>
          </name>
          <name>
            <surname>Dudoit</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>Evaluation of statistical methods for normalization and differential expression in {mRNA-Seq} experiments</article-title>
        <source>BMC Bioinform.</source>
        <year>2010</year>
        <volume>11</volume>
        <fpage>94</fpage>
        <pub-id pub-id-type="doi">10.1186/1471-2105-11-94</pub-id>
      </element-citation>
    </ref>
    <ref id="CR37">
      <label>37.</label>
      <mixed-citation publication-type="other">Fisher, R. A.  <italic>Statistical Methods for Research Workers</italic>. <ext-link ext-link-type="uri" xlink:href="https://scholar.google.com/scholar_lookup?title=Statisticalmethodsforresearchworkers&amp;author=RA.Fisher&amp;publication_year=1932">https://scholar.google.com/scholar_lookup?title=Statisticalmethodsforresearchworkers&amp;author=RA.Fisher&amp;publication_year=1932</ext-link> (Oliver &amp; Boyd, Edinburgh, 1925).</mixed-citation>
    </ref>
    <ref id="CR38">
      <label>38.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Soneson</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Robinson</surname>
            <given-names>MD</given-names>
          </name>
        </person-group>
        <article-title>iCOBRA: open, reproducible, standardized and live method benchmarking</article-title>
        <source>Nat. Methods</source>
        <year>2016</year>
        <volume>13</volume>
        <fpage>283</fpage>
        <lpage>283</lpage>
        <pub-id pub-id-type="doi">10.1038/nmeth.3805</pub-id>
        <pub-id pub-id-type="pmid">27027585</pub-id>
      </element-citation>
    </ref>
    <ref id="CR39">
      <label>39.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kiselev</surname>
            <given-names>VY</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Perturbations of PIP3 signalling trigger a global remodelling of mRNA landscape and reveal a transcriptional feedback loop</article-title>
        <source>Nucleic Acids Res.</source>
        <year>2015</year>
        <volume>43</volume>
        <fpage>gkv1015</fpage>
        <pub-id pub-id-type="doi">10.1093/nar/gkv1015</pub-id>
      </element-citation>
    </ref>
    <ref id="CR40">
      <label>40.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Merrick</surname>
            <given-names>D</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Identification of a mesenchymal progenitor cell hierarchy in adipose tissue</article-title>
        <source>Science</source>
        <year>2019</year>
        <volume>364</volume>
        <fpage>eaav2501</fpage>
        <pub-id pub-id-type="doi">10.1126/science.aav2501</pub-id>
        <pub-id pub-id-type="pmid">31023895</pub-id>
      </element-citation>
    </ref>
    <ref id="CR41">
      <label>41.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Becht</surname>
            <given-names>E</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Dimensionality reduction for visualizing single-cell data using UMAP</article-title>
        <source>Nat. Biotechnol.</source>
        <year>2019</year>
        <volume>37</volume>
        <fpage>38</fpage>
        <lpage>44</lpage>
      </element-citation>
    </ref>
  </ref-list>
</back>
