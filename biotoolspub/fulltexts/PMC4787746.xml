<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.1d1 20130915//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 39.96?>
<?ConverterInfo.XSLTName jp2nlmx2.xsl?>
<?ConverterInfo.Version 2?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Nucleic Acids Res</journal-id>
    <journal-id journal-id-type="iso-abbrev">Nucleic Acids Res</journal-id>
    <journal-id journal-id-type="hwp">nar</journal-id>
    <journal-id journal-id-type="publisher-id">nar</journal-id>
    <journal-title-group>
      <journal-title>Nucleic Acids Research</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">0305-1048</issn>
    <issn pub-type="epub">1362-4962</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">4787746</article-id>
    <article-id pub-id-type="pmid">26160885</article-id>
    <article-id pub-id-type="doi">10.1093/nar/gkv696</article-id>
    <article-categories>
      <subj-group subj-group-type="hwp-journal-coll">
        <subject>28</subject>
      </subj-group>
      <subj-group subj-group-type="heading">
        <subject>Methods Online</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Count ratio model reveals bias affecting NGS fold changes</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Erhard</surname>
          <given-names>Florian</given-names>
        </name>
        <xref ref-type="corresp" rid="COR1">*</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Zimmer</surname>
          <given-names>Ralf</given-names>
        </name>
      </contrib>
      <aff id="AFF1">Institut für Informatik, Ludwig-Maximilians-Universität München, Amalienstraße 17, 80333 München, Germany</aff>
    </contrib-group>
    <author-notes>
      <corresp id="COR1"><label>*</label>To whom correspondence should be addressed. Tel: +49 89 2180 4066; Fax: +49 89 2180 99 4066; Email: <email>Florian.Erhard@bio.ifi.lmu.de</email></corresp>
    </author-notes>
    <pub-date pub-type="ppub">
      <day>16</day>
      <month>11</month>
      <year>2015</year>
    </pub-date>
    <pub-date pub-type="epub">
      <day>08</day>
      <month>7</month>
      <year>2015</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>08</day>
      <month>7</month>
      <year>2015</year>
    </pub-date>
    <!-- PMC Release delay is 0 months and 0 days and was based on the
							<pub-date pub-type="epub"/>. -->
    <volume>43</volume>
    <issue>20</issue>
    <fpage>e136</fpage>
    <lpage>e136</lpage>
    <history>
      <date date-type="accepted">
        <day>25</day>
        <month>6</month>
        <year>2015</year>
      </date>
      <date date-type="rev-recd">
        <day>09</day>
        <month>6</month>
        <year>2015</year>
      </date>
      <date date-type="received">
        <day>23</day>
        <month>12</month>
        <year>2014</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2015. Published by Oxford University Press on behalf of Nucleic Acids Research.</copyright-statement>
      <copyright-year>2015</copyright-year>
      <license license-type="creative-commons" xlink:href="http://creativecommons.org/licenses/by-nc/4.0/">
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by-nc/4.0/">http://creativecommons.org/licenses/by-nc/4.0/</ext-link>), which permits non-commercial re-use, distribution, and reproduction in any medium, provided the original work is properly cited. For commercial re-use, please contact <email>journals.permissions@oup.com</email></license-p>
      </license>
    </permissions>
    <self-uri xlink:title="pdf" xlink:href="gkv696.pdf"/>
    <abstract>
      <p>Various biases affect high-throughput sequencing read counts. Contrary to the general assumption, we show that bias does not always cancel out when fold changes are computed and that bias affects more than 20% of genes that are called differentially regulated in RNA-seq experiments with drastic effects on subsequent biological interpretation. Here, we propose a novel approach to estimate fold changes. Our method is based on a probabilistic model that directly incorporates count ratios instead of read counts. It provides a theoretical foundation for pseudo-counts and can be used to estimate fold change credible intervals as well as normalization factors that outperform currently used normalization methods. We show that fold change estimates are significantly improved by our method by comparing RNA-seq derived fold changes to qPCR data from the MAQC/SEQC project as a reference and analyzing random barcoded sequencing data. Our software implementation is freely available from the project website <ext-link ext-link-type="uri" xlink:href="http://www.bio.ifi.lmu.de/software/lfc">http://www.bio.ifi.lmu.de/software/lfc</ext-link>.</p>
    </abstract>
    <counts>
      <page-count count="14"/>
    </counts>
    <custom-meta-group>
      <custom-meta>
        <meta-name>cover-date</meta-name>
        <meta-value>16 November 2015</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec sec-type="intro" id="SEC1">
    <title>INTRODUCTION</title>
    <p>Quantitative RNA measurement is an essential tool in biological research. The established method is next generation sequencing (NGS), where RNA is converted to cDNA, amplified and sequenced, leaving the researcher with hundreds of millions of 30–100 bases long reads. The most prominent application for quantitative NGS is mRNA-seq (<xref rid="B1" ref-type="bibr">1</xref>,<xref rid="B2" ref-type="bibr">2</xref>), where the abundance of mRNA is determined. Other examples are ribosomal profiling (<xref rid="B3" ref-type="bibr">3</xref>), DNAse-seq (<xref rid="B4" ref-type="bibr">4</xref>), RIP-seq (<xref rid="B5" ref-type="bibr">5</xref>), CLIP-seq (<xref rid="B6" ref-type="bibr">6</xref>–<xref rid="B8" ref-type="bibr">8</xref>), ChIP-seq (<xref rid="B9" ref-type="bibr">9</xref>,<xref rid="B10" ref-type="bibr">10</xref>) and PARS (<xref rid="B11" ref-type="bibr">11</xref>).</p>
    <p>The basic principle of quantitative NGS is to count sequences belonging to the entities of interest and to take these counts as a measure of abundance of these entities in a biological sample. For example, in mRNA-seq, sequences of random mRNA fragments are determined (in fact, either the prefix in single-end sequencing or the prefix and the suffix in paired-end sequencing of each fragment is sequenced) and the number of all sequences or fragments matching an mRNA is used for quantification. Due to the amplification step during sample preparation, only the relative abundance within the sample can be determined. The often used RPKM or FPKM (<xref rid="B1" ref-type="bibr">1</xref>,<xref rid="B12" ref-type="bibr">12</xref>) measures for this correspond to the respective fraction of all mRNA in the sample but not the absolute abundance of the mRNA (i.e. the copy numbers per cell).</p>
    <p>However, such single-sample or per-experiment measurements are hampered by known biases introduced during sample preparation, e.g. by polymerase chain reaction (PCR) amplification (<xref rid="B13" ref-type="bibr">13</xref>,<xref rid="B14" ref-type="bibr">14</xref>) or adapter ligation (<xref rid="B15" ref-type="bibr">15</xref>,<xref rid="B16" ref-type="bibr">16</xref>). As a consequence, some sequences from the same entity are observed orders of magnitude more often than others (<xref rid="B1" ref-type="bibr">1</xref>,<xref rid="B17" ref-type="bibr">17</xref>). Several computational ad-hoc attempts have been made to correct for such bias (<xref rid="B18" ref-type="bibr">18</xref>–<xref rid="B20" ref-type="bibr">20</xref>), but cannot remove it completely.</p>
    <p>Differential quantification is deemed more reliable, since bias affects all samples equally and should therefore cancel out when samples are compared, e.g. by taking ratios. For several NGS based experiments, differential quantification is inherently necessary. For instance, in ribosomal profiling (<xref rid="B3" ref-type="bibr">3</xref>), the observed reads are not only dependent on the translation rate (which is the quantity of interest) but also on the corresponding mRNA expression level, i.e. in order to derive the translation rate, the ribosomal profiling read counts must be compared to corresponding mRNA-seq read counts (<xref rid="B21" ref-type="bibr">21</xref>). Analogously, in RIP-seq, the observations are dependent on the rate of bound RNA binding proteins and the total mRNA level (<xref rid="B5" ref-type="bibr">5</xref>). For other experiments, differential quantification is not inherently necessary for the experiment itself, but for the biological question. For instance, we have shown that by treating CLIP-seq read counts in a differential manner, context-dependent microRNA binding can be analyzed (<xref rid="B22" ref-type="bibr">22</xref>).</p>
    <p>Our initial goal was to analyze differential quantification for entities with few reads. This is important for small exons in differentially spliced mRNAs in mRNA-seq or local translation rate changes in ribosomal profiling. It is also of special interest for CLIP-seq, where the sequenced target sites are as short as 30 nucleotides and as few as 5 reads are often deemed enough for a reliable site (<xref rid="B6" ref-type="bibr">6</xref>,<xref rid="B23" ref-type="bibr">23</xref>). The main problem here is to handle the inherent sampling noise of count data appropriately. For instance, if 4 and 2 reads are observed for a certain entity in two conditions, the actual fold change most certainly was not exactly 2, but rather within some interval around 2. Thus, a credible interval gives more information on the true fold change. Intuitively, we would assume a relatively large interval if only as few reads as 4 and 2 are observed, and a smaller interval for higher counts.</p>
    <p>Importantly, the purpose of such credible intervals is different from <italic>P</italic>-values of available methods such as DEseq (<xref rid="B24" ref-type="bibr">24</xref>) or others (<xref rid="B25" ref-type="bibr">25</xref>): those methods test for each gene X the null hypothesis <italic>H</italic><sub>0</sub> = <italic>the treatment does not affect expression of X</italic>. An hypothesis test for <italic>H</italic><sub>0</sub> is only reasonable when many replicates are available that repeatedly measure expression of X with and without treatment. In contrast, the credible intervals here characterize the measurement uncertainty inherent for sampled count data and can be computed for any pair of experiments, i.e. also when no replicates are available.</p>
    <p>We developed a probabilistic model to estimate credible intervals and show that the intuition <italic>more sequenced reads means more accurate fold changes</italic> is misleading when raw NGS read counts are used. Moreover, using this model we show that known bias does not cancel out when ratios are computed leading to inaccurate fold change estimates. Bias can be handled experimentally by labeling RNA fragments using random barcodes before PCR (<xref rid="B14" ref-type="bibr">14</xref>). Thus, additional experimental steps are necessary, that so far have only been applied in a few published studies (<xref rid="B7" ref-type="bibr">7</xref>,<xref rid="B14" ref-type="bibr">14</xref>). To handle such bias in available data sets, we introduce a novel method to estimate fold changes. We show that fold change estimates are significantly improved by our method using data from the MAQC project (<xref rid="B26" ref-type="bibr">26</xref>,<xref rid="B27" ref-type="bibr">27</xref>) and that about 20% of genes that are called differentially expressed are affected in a standard RNA-seq setting. Finally, we show that the method can also be applied to the estimation of normalization constants and show that it outperforms the widely used median based normalization.</p>
  </sec>
  <sec sec-type="materials|methods" id="SEC2">
    <title>MATERIALS AND METHODS</title>
    <sec id="SEC2-1">
      <title>Data sets</title>
      <p>We downloaded the SAM files of the sequencing data of (<xref rid="B14" ref-type="bibr">14</xref>) from GEO (accession numbers GSM849370 and GSM849371). For both replicates, SAM files corresponding to “digital” counts (respecting random barcodes) and “conventional” counts (disrespecting random barcodes) were provided and utilized to generate Figures <xref ref-type="fig" rid="F2">2</xref> and <xref ref-type="fig" rid="F4">4</xref>, respectively. All genome aligned reads from those SAM files were mapped to <italic>Escherichia coli</italic> genes using Genbank annotations (accession U00096.2). For both digital and conventional counts, normalization constants were computed such that the median log fold change of genes with more than 50 counts in both replicates was 0. For all genes, the Maximum-A-Posteriori (MAP) estimate with no pseudocounts and its 99% symmetric credible interval (see below) were computed. As the true fold change of all genes should correspond to the normalization constant, genes where the normalization constant was outside of the computed credible interval were marked in Figures <xref ref-type="fig" rid="F2">2A</xref> and <xref ref-type="fig" rid="F4">4B</xref>. Furthermore, we computed all MAP estimates of local fold changes along all genes, their 99% credible intervals and the median of the posterior distribution. These statistics were plotted on to of the alignment start position to generate Figures <xref ref-type="fig" rid="F2">2D</xref> and <xref ref-type="fig" rid="F4">4D</xref>. To test local deviations from the gene fold change (Figures <xref ref-type="fig" rid="F2">2E</xref> and <xref ref-type="fig" rid="F4">4E</xref>), the Positive predictive distribution of our Bayesian model was used as follows: we computed the cumulative distribution function for local read counts of the first replicate using the Beta-Binomial distribution parameterized with the sum of the local read counts and the total counts from each replicate.</p>
      <p>For the validation, we downloaded TaqMan qPCR data from GEO (accession number GPL4097) and computed gene fold changes as described (<xref rid="B26" ref-type="bibr">26</xref>). Sequencing data for the same sample were downloaded from SRA (accession number SRA010153), aligned to the human genome (hg19) and transcriptome (Ensembl v70) using bowtie 1.0 (<xref rid="B28" ref-type="bibr">28</xref>).</p>
      <p>Data from (<xref rid="B29" ref-type="bibr">29</xref>) were downloaded from yeastgenome.org and aligned to the yeast genome using STAR (<xref rid="B30" ref-type="bibr">30</xref>). Data from the SEQC project (<xref rid="B31" ref-type="bibr">31</xref>) have been downloaded from SRA and aligned to the human genome using STAR (<xref rid="B30" ref-type="bibr">30</xref>). We only used the data from the official sequencing site <italic>Beijing Genomics Institute</italic> (BGI), replicates a and b and pooled all lanes from flow cell <italic>AC0AYTACXX</italic>, as according to the SEQC publication, all data sets were of similar quality.</p>
    </sec>
    <sec id="SEC2-2">
      <title>Hellinger distance and resampling</title>
      <p>The squared Hellinger distance between two Beta distributions with parameters (α<sub>1</sub>, β<sub>1</sub>) and (α<sub>2</sub>, β<sub>2</sub>) is computed according to
<disp-formula id="M1"><label>(1)</label><tex-math id="M19">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}\begin{equation*} d(\alpha _1,\beta _1,\alpha _2,\beta _2) = 1-\frac{B(\frac{\alpha _1+\alpha _2}{2}, \frac{\beta _1+\beta _2}{2})}{B(\alpha _1,\beta _1)^{\frac{1}{2}} \cdot B(\alpha _2,\beta _2)^{\frac{1}{2}}} \end{equation*}\end{document}</tex-math></disp-formula>
where <italic>B</italic> is the Beta function. In order to estimate the influence of sampling alone, the following resampling procedure was applied: for gene <italic>g</italic> with observed count pair <italic>o</italic><sub><italic>A</italic></sub>, <italic>o</italic><sub><italic>B</italic></sub>, sample a new count <italic>c</italic><sub><italic>A</italic></sub> according to a Binomial distribution with parameters <italic>n</italic> = <italic>o</italic><sub><italic>A</italic></sub> + <italic>o</italic><sub><italic>B</italic></sub> and <italic>p</italic> = <italic>p</italic>(<italic>l</italic>) + <italic>n</italic> where <italic>l</italic> is the qPCR log fold change <italic>p</italic> as defined in equation <xref ref-type="disp-formula" rid="M2">2</xref> and <italic>n</italic> a normalization factor computed for this replicate. For the other condition, we set <italic>c</italic><sub><italic>B</italic></sub> = <italic>o</italic><sub><italic>A</italic></sub> + <italic>o</italic><sub><italic>B</italic></sub> − <italic>c</italic><sub><italic>A</italic></sub>.</p>
    </sec>
    <sec id="SEC2-3">
      <title>Read count ratio model</title>
      <p>The following considerations are based on mRNA-seq data, because it is the most widely used quantitative NGS technique and other models have been developed and described specifically for it. However, all results also apply to any quantitative NGS experiment where two conditions are compared.</p>
      <p>Probabilistic models for mRNA-seq data draw reads per experiment across all possible genes (<xref rid="B1" ref-type="bibr">1</xref>,<xref rid="B12" ref-type="bibr">12</xref>,<xref rid="B24" ref-type="bibr">24</xref>,<xref rid="B25" ref-type="bibr">25</xref>). The basic per-experiment model is as follows: when we have <italic>N</italic> reads in our experiment and a gene <italic>g</italic> with relative frequency <italic>p</italic><sub><italic>g</italic></sub>, the number of reads mapping to <italic>g</italic> is distributed according to a binomial distribution with parameters <italic>N</italic> and <italic>p</italic><sub><italic>g</italic></sub>. Since <italic>N</italic> is large and <italic>p</italic><sub><italic>g</italic></sub> is small, the Poisson distribution is a good approximation. The single parameter of the Poisson distribution is its mean and can be estimated using replicate experiments. Then, significantly differentially expressed genes can easily be determined since for the Poisson distribution, mean and variance are equal. However overdispersion (greater variance than mean) is generally observed for per-experiment models (<xref rid="B24" ref-type="bibr">24</xref>,<xref rid="B25" ref-type="bibr">25</xref>). As a solution, population based estimates of more general distributions, e.g. negative binomial (<xref rid="B24" ref-type="bibr">24</xref>) or generalized Poisson (<xref rid="B25" ref-type="bibr">25</xref>) are fitted and used for estimating significance. There are a few other variations of this basic model, e.g. to incorporate multi-mapping reads, paired-end reads, to handle positional or sequence bias or to handle sequencing errors (<xref rid="B18" ref-type="bibr">18</xref>–<xref rid="B20" ref-type="bibr">20</xref>).</p>
      <p>We take a fundamentally different approach: instead of drawing reads across entities in a single experiment, we draw the number of reads with the same sequence across two experiments. Then, we estimate a local fold change for the corresponding position within a gene between the experiments. The main advantage of this approach is that any sequence-specific factor that may bias the read count should affect both conditions equally, so it is important to handle such bias as early as possible in the probabilistic model. In contrast, the established method of computing a fold change for a transcript is to first sum all the read counts belonging to it and then to compute the ratio. The major disadvantage of local fold changes is the loss of accuracy: in most cases there are very few reads at a certain position and random sampling strongly affects the estimated fold changes. Thus, the main challenge in our approach is to give a reliable interval estimate for fold changes instead of a point estimate and to find a way to combine multiple local estimates to an overall per-transcript estimate.</p>
    </sec>
    <sec id="SEC2-4">
      <title>Maximum likelihood estimators</title>
      <p>Let <italic>c</italic><sub>1</sub> and <italic>c</italic><sub>2</sub> reads be observed for a certain sequence in two conditions. We call <italic>c</italic><sub>1</sub> and <italic>c</italic><sub>2</sub> local counts, the sum <italic>c</italic><sub>1</sub> + <italic>c</italic><sub>2</sub> the total local count and the ratio <inline-formula><tex-math id="M20">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$\frac{c_1}{c_2}$\end{document}</tex-math></inline-formula> local fold change. For fixed log<sub>2</sub> local fold change <italic>l</italic> and total count <italic>n</italic> = <italic>c</italic><sub>1</sub> + <italic>c</italic><sub>2</sub>, the probability of getting a local count <italic>c</italic><sub>1</sub> follows a binomial distribution with parameters <italic>n</italic> and <italic>p</italic>. Here,
<disp-formula id="M2"><label>(2)</label><tex-math id="M21">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}\begin{equation*} p(l) = \frac{2^l}{1+2^l} \end{equation*}\end{document}</tex-math></disp-formula></p>
      <p>is the probability of drawing a read from the first experiment when the true log<sub>2</sub> local fold change is <italic>l</italic>. The rationale behind the logistic function <italic>p</italic>(<italic>l</italic>) is as follows: if there is abundance <italic>a</italic> for an RNA fragment in one of the conditions and the true log<sub>2</sub> fold change is <italic>l</italic>, the abundance in the other sample is <italic>a</italic> · 2<sup><italic>l</italic></sup>. If both samples are pooled and a read is drawn at random, the probability of getting a read from the second condition is <inline-formula><tex-math id="M22">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$\frac{a \cdot 2^l}{a+a \cdot 2^l} = p(l)$\end{document}</tex-math></inline-formula>. Importantly, the binomial distribution is fundamentally different from the above mentioned per-experiment model. Also, the magnitudes of the parameters involved here do <bold>not</bold> allow for a Poisson approximation.</p>
      <p>The goal is to estimate <italic>l</italic> from data, which can be done by transforming an estimator for <italic>p</italic> by
<disp-formula id="M3"><label>(3)</label><tex-math id="M23">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}\begin{equation*} l(p) = \log _2 \frac{p}{1-p} \end{equation*}\end{document}</tex-math></disp-formula></p>
      <p>Given the i.i.d. read counts <italic>c</italic><sub><italic>i</italic>, <italic>j</italic></sub>, with <italic>i</italic> = 1...<italic>N</italic> denoting the <italic>N</italic> positions in a gene and <italic>j</italic> = 1, 2 denoting the two experiments, the maximum likelihood estimators (ML) for <italic>p</italic> and <italic>l</italic> are
<disp-formula id="M4"><label>(4)</label><tex-math id="M24">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}\begin{eqnarray*} \hat{p}^{ML} &amp; = &amp; \frac{\sum _{i=1}^N c_{i,1}}{\sum _{i=1}^N ( c_{i,1}+c_{i,2} )} \end{eqnarray*}\end{document}</tex-math></disp-formula>
<disp-formula id="M5"><label>(5)</label><tex-math id="M25">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}\begin{eqnarray*} \hat{l}^{ML} &amp; = &amp; \log _2 \frac{\sum _{i=1}^N c_{i,1}}{\sum _{i=1}^N c_{i,2}}\hskip1em \end{eqnarray*}\end{document}</tex-math></disp-formula></p>
      <p>Thus, the ML estimator is equal to the usually used per-transcript count ratio and, thus, disregarding normalization constants, to the RPKM or FPKM ratio (<xref rid="B1" ref-type="bibr">1</xref>,<xref rid="B12" ref-type="bibr">12</xref>). Furthermore, the ML estimator can be seen as a weighted average of the local counts <italic>c</italic><sub><italic>i</italic>, 1</sub> and <italic>c</italic><sub><italic>i</italic>, 2</sub>. Large local counts contribute more to the total fold change than small counts.</p>
    </sec>
    <sec id="SEC2-5">
      <title>MAP estimators</title>
      <p>However, this point estimator does not tell us anything about our degree of belief in the estimated log fold change. Therefore, we generalize this estimator using Bayesian inference: we assume a Beta distribution as prior for <italic>p</italic>. Due to its domain and its flexibility the Beta distribution is often used as a prior for probability parameters. Furthermore, it is a conjugate prior to the binomial distribution. Therefore, assuming the prior to be Beta(α,β) and i.i.d. read counts <italic>c</italic><sub><italic>i</italic>, <italic>j</italic></sub>, the posterior distribution also is a Beta distribution:
<disp-formula id="M6"><label>(6)</label><tex-math id="M26">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}\begin{equation*} p(l) \sim \mbox{Beta}( \alpha + \sum _{i=1}^N c_{i,1}, \beta + \sum _{i=1}^N c_{i,2}) \end{equation*}\end{document}</tex-math></disp-formula></p>
      <p>The mode of a Beta(α,β) is at <inline-formula><tex-math id="M27">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$\frac{\alpha -1}{\alpha +\beta -2}$\end{document}</tex-math></inline-formula> and thus, the MAP estimators are
<disp-formula id="M7"><label>(7)</label><tex-math id="M28">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}\begin{eqnarray*} \hat{p}^{MAP} &amp; = &amp; \frac{\alpha +\sum _{i=1}^N c_{i,1}-1}{\alpha +\sum _{i=1}^N c_{i,1}+\beta +\sum _{i=1}^N c_{i,2}-2} \end{eqnarray*}\end{document}</tex-math></disp-formula>
<disp-formula id="M8"><label>(8)</label><tex-math id="M29">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}\begin{eqnarray*} \hat{l}^{MAP} &amp; = &amp; \log _2 \frac{\sum _{i=1}^N c_{i,1} + \alpha -1}{\sum _{i=1}^N c_{i,2} + \beta -1}\hskip4.5em \end{eqnarray*}\end{document}</tex-math></disp-formula></p>
      <p>Beta(1,1) is the [0,1]-uniform distribution, therefore for α = β = 1, the MAP estimator is equal to the ML estimator. At first glance, using the Beta distribution seems arbitrary. However, its two parameters α and β have an intuitive meaning: α − 1 and β − 1 are pseudocounts that are often used to avoid division by zero when taking the ratio of counts. Importantly, using no pseudocounts is equivalent to a uniform distribution of the proportion parameter <italic>p</italic>. However, it does not correspond to a uniform log fold change distribution.</p>
    </sec>
    <sec id="SEC2-6">
      <title>Log fold change distribution</title>
      <p>In order to derive the density function of the log fold change corresponding to the binomial proportion parameter, we use the method of substitution.</p>
      <p>The density and probability function of the Beta distribution with parameters (α, β) are
<disp-formula id="M9"><label>(9)</label><tex-math id="M30">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}\begin{eqnarray*} g(p|\alpha ,\beta ) &amp; = &amp; \frac{p^{\alpha -1} \cdot (1-p)^{\beta -1}}{B(\alpha ,\beta )} \end{eqnarray*}\end{document}</tex-math></disp-formula>
<disp-formula id="M10"><label>(10)</label><tex-math id="M31">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}\begin{eqnarray*} G(p|\alpha ,\beta ) &amp; = &amp; \int _{0}^p g(x|\alpha ,\beta ) dx \end{eqnarray*}\end{document}</tex-math></disp-formula></p>
      <p>where <italic>B</italic> is the beta function. By substitution, the probability function of a random variable transformed by equation <xref ref-type="disp-formula" rid="M2">2</xref> can be expressed as
<disp-formula id="M11"><label>(11)</label><tex-math id="M32">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}\begin{eqnarray*} F(l|\alpha ,\beta ) &amp; = &amp; G(p(l)|\alpha ,\beta ) \end{eqnarray*}\end{document}</tex-math></disp-formula>
<disp-formula id="M12"><label>(12)</label><tex-math id="M33">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}\begin{eqnarray*}\hskip6em &amp; = &amp; \int _{-\infty }^{p(l)} g(x|\alpha ,\beta ) dx \end{eqnarray*}\end{document}</tex-math></disp-formula>
<disp-formula id="M13"><label>(13)</label><tex-math id="M34">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}\begin{eqnarray*}\hskip8.5em &amp; = &amp; \int _{-\infty }^{l} g(p(x)|\alpha ,\beta ) \frac{dp}{dx} dx \end{eqnarray*}\end{document}</tex-math></disp-formula></p>
      <p>Hence, the density function is
<disp-formula id="M14"><label>(14)</label><tex-math id="M35">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}\begin{eqnarray*} f(l|\alpha ,\beta ) &amp; = &amp; g(p(l)) \frac{dp}{dl} \hskip14em\end{eqnarray*}\end{document}</tex-math></disp-formula>
<disp-formula id="M15"><label>(15)</label><tex-math id="M36">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}\begin{eqnarray*} &amp; = &amp; \frac{(\frac{2^l}{1+2^l})^{\alpha -1} \cdot (1-\frac{2^l}{1+2^l})^{\beta -1}}{B(\alpha ,\beta )} \cdot \frac{2^l \log (2)}{(1+2^l)^2} \end{eqnarray*}\end{document}</tex-math></disp-formula>
<disp-formula id="M16"><label>(16)</label><tex-math id="M37">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}\begin{eqnarray*} &amp; = &amp; \frac{(2^l)^\alpha \cdot \log (2)}{B(\alpha ,\beta ) \cdot (1+2^l)^{\alpha +\beta }} \hskip6em\end{eqnarray*}\end{document}</tex-math></disp-formula></p>
    </sec>
    <sec id="SEC2-7">
      <title>Compute prior parameters</title>
      <p>Given the knowledge of an expected log<sub>2</sub> fold change μ with a log<sub>2</sub> tolerance of <italic>t</italic> with certainty <italic>c</italic>, the parameters α and β can be computed by numerically via
<disp-formula id="M17"><label>(17)</label><tex-math id="M38">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}\begin{equation*} {F( \mu +0.5 \cdot t | \alpha ,\beta ) - F( \mu -0.5 \cdot t | \alpha ,\beta ) = c } \end{equation*}\end{document}</tex-math></disp-formula>
under the constraint that α = 2<sup>μ</sup> · β (e.g. by using the bisection method after exponential search for start values). The probability function <italic>F</italic> of the posterior log fold change distribution can be computed in an efficient and numerically stable way using Beta functions in log space.</p>
    </sec>
  </sec>
  <sec sec-type="results" id="SEC3">
    <title>RESULTS</title>
    <p>Quantitative experiments can be affected by two sources of error, noise and bias. <italic>Noise</italic> is the random variation observed from repeated measurements and can be controlled using appropriate probabilistic models. In contrast, <italic>bias</italic> is the systematic deviation of measurements from the true quantity, i.e. in repeated experiments, measurements may not scatter around the true quantity (due to noise), but may deviate reproducibly from it. Removing bias often is much more difficult than handling noise, as the source, type and extent of bias must be known and predictable.</p>
    <p>However, under certain conditions, correcting for bias is straight-forward: when the experimenter is interested in ratios of measurements and bias is linear, it cancels out. Linear means that the expected effect of bias can be represented by a fixed multiplicative factor. In many NGS experiments, these conditions appear to hold. First, many NGS experiments are inherently differential, i.e. the quantity of interest is already fold change (see above). And second, linearity can safely be assumed based on the following considerations, exemplary for bias introduced by PCR: during a single PCR cycle a fragment with sequence <italic>s</italic> is amplified by a certain probability <italic>p</italic><sub><italic>s</italic></sub>. The expected yield of <italic>n</italic> copies before this PCR cycle then is (1 + <italic>p</italic><sub><italic>s</italic></sub>) · <italic>n</italic> and (1 + <italic>p</italic><sub><italic>s</italic></sub>)<sup><italic>c</italic></sup> · <italic>n</italic> after <italic>c</italic> cycles. Here, (1 + <italic>p</italic><sub><italic>s</italic></sub>)<sup><italic>c</italic></sup> is the fixed multiplicative factor that determines a sequence specific linear bias. Thus, PCR may indeed meet the condition of linearity, and a similar argument can be made for the other processes involved in an NGS experiment. If all experimental steps produce linear bias, the total bias is also linear as the product of the biases of the individual steps result in another overall fixed multiplicative factor.</p>
    <p>However, it is important to make the distinction what is measured and consequently affected by bias, and what are the entities the experimenter is interested in. In NGS, read counts are measured, i.e. the number of times a certain read sequence is observed. However, the experimenter is not interested in read counts but in the quantity of more coarse-grained objects, e.g. transcripts in RNA-seq or binding sites of transcription factors in ChIP-seq. Thus, distinct measurements (read counts) must be aggregated across these objects.</p>
    <p>As a consequence, the fold change of the wanted entity may still be affected by bias. Assume that in one mRNA-seq experiment, only a single fragment <italic>i</italic> is isolated for a certain mRNA that is amplified poorly (i.e. <italic>p</italic><sub><italic>i</italic></sub> is small). Furthermore, assume that in another experiment, again a single fragment <italic>j</italic> is isolated for the same mRNA that is different from fragment <italic>i</italic> and amplified very efficiently (i.e. <italic>p</italic><sub><italic>j</italic></sub> is large). The total fold change estimate then is <inline-formula><tex-math id="M39">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$\frac{(1+p_i)^c \cdot n_1}{(1+p_j)^c \cdot n_2}$\end{document}</tex-math></inline-formula>. Even if the true mixing ratio is 1 (i.e. <italic>n</italic><sub>1</sub> = <italic>n</italic><sub>2</sub>), the estimated fold change is heavily biased.</p>
    <p>In summary, when neglecting bias, there are three building blocks in the differential analysis of NGS data: aggregation, controlling noise and computing ratios. We do not consider replicate experiments or normalization at this stage. Replicate experiments can be incorporated by pooling reads prior to this analysis and normalization can be performed afterward (see analysis and discussion below). Existing methods follow one specific path (see Figure <xref ref-type="fig" rid="F1">1</xref>). First, reads are aggregated, then the parameters of a probabilistic model are estimated to control noise and finally, fold changes are computed. This is true for the most basic method (<xref rid="B1" ref-type="bibr">1</xref>), where read counts are summed up for mRNAs, the mean of a Poisson distribution using measurements of replicate experiments is estimated and the ratio of two means from two conditions is computed. This is also true for more sophisticated methods such as DEseq (<xref rid="B24" ref-type="bibr">24</xref>) or others (<xref rid="B12" ref-type="bibr">12</xref>,<xref rid="B25" ref-type="bibr">25</xref>), where the simple Poisson model is replaced by more general distributions. When bias has to be accounted for, bias correction methods (<xref rid="B18" ref-type="bibr">18</xref>–<xref rid="B20" ref-type="bibr">20</xref>) have to be incorporated in this workflow <italic>prior</italic> to read aggregation. Hence, such methods do not exploit the linearity assumption for differential analysis of NGS data.</p>
    <fig id="F1" orientation="portrait" position="float">
      <label>Figure 1.</label>
      <caption>
        <p>Workflows for differential NGS analysis. Differential analysis of NGS data starts with the aligned reads of two conditions, here exemplified as RNA-seq reads from samples A and B aligned to an mRNA. Existing models take one specific route through the necessary steps defined in the main text: (I) For each sample, reads are aggregated and an appropriate probabilistic model is used to control noise and estimate the sample specific mRNA abundance. (II) These abundance estimates are then divided to give an estimate of the mRNA fold change. Our approach takes a different route by first computing local ratios for all read sequences and then aggregating them using an appropriate noise model for count ratios to estimate the total mRNA fold change. Using a basic noise model for the second step makes both routes equivalent. However, using extensions to it leads to more accurate fold change estimates by exploiting the fact that bias cancels out when taking the ratio of counts of individual sequences. Note that two important aspects of NGS (replicate experiments and normalization) are left out in this figure and are analyzed and discussed below.</p>
      </caption>
      <graphic xlink:href="gkv696fig1"/>
    </fig>
    <p>To make use of linearity, we assemble these building blocks in a different order in our approach. First we take ratios of read counts to let bias cancel out, and then aggregate ratios and estimate a model built upon aggregated ratios to handle noise (see Figure <xref ref-type="fig" rid="F1">1</xref>). The major advantage of this workflow is that bias is completely removed under the assumption of linearity. The major problem is that individual read counts and thus individual ratios are heavily affected by noise. Thus, the effectiveness of such an approach depends on the ability of the probabilistic model to handle this random variation.</p>
    <p>Here, we develop such a model. First we introduce a basic version and show that its point estimate is equivalent to existing approaches, indicating that the operations <italic>aggregate and control noise</italic> and <italic>compute ratio</italic> can be commutative (see again Figure <xref ref-type="fig" rid="F1">1</xref>). We further show that this basic model introduces two new notions: prior knowledge can be utilized and credible interval estimates can be computed. Then, we test the basic model using a data set where bias can be detected and removed by a clever experimental setup. Finally, we show that the basic model severely underestimates noise in the presence of read count bias and propose and test a more conservative noise model.</p>
    <sec id="SEC3-1">
      <title>Count ratio model</title>
      <p>We define <italic>local read counts</italic> as the number of reads that have been aligned to a certain genomic position. Importantly, genomic position does not only refer to the start position of the alignment, but also includes all potential splice junctions and the alignment end (which is important when reads have different length due to trimming). A <italic>local count ratio</italic> is the ratio of two local read counts from two conditions or samples or aggregated numbers from sets of replicates or sets of samples/conditions.</p>
      <p>Our model is based on the following considerations: given two lists of local read counts we want to determine the true mixing ratio that has led to these counts. If we assume that all <italic>n</italic> reads belonging to a pair of local read counts were pooled, the local read count from the first condition is binomially distributed with parameters <italic>n</italic> and <italic>p</italic>, where <italic>p</italic> is related to the true log fold change between the two conditions. The lists of local read counts represent repeated and independent measurements of this binomial distribution with the same parameter <italic>p</italic>. Thus, these lists of local read counts can be used to estimate <italic>p</italic>, and, by transformation, the true log fold change. In fact, the Maximum Likelihood Estimate (MLE) of this model is mathematically equivalent to the obvious and widely used log fold change, which is the total number of reads in condition 1 divided by the total number of reads in condition 2 (see Methods section for further details).</p>
      <p>Furthermore, the Bayesian MAP estimate extends the MLE and introduces the parameters of its prior distribution as pseudocounts that are added to both total numbers of reads. Of note, pseudocounts are widely in use as well to avoid division by zero.</p>
      <p>Thus, the basic statistics from the count ratio model are already widely in use. However, it brings three additional benefits for NGS data analysis. First, it introduces a theoretical justification for ad-hoc pseudocounts. Second, we can analytically compute the full posterior distribution or credible intervals for the true log fold change in addition to the above introduced point estimates. And third, our model indicates that the total number of reads can be decomposed into many local read counts, which allows to handle bias in a straight-forward way (see below).</p>
    </sec>
    <sec id="SEC3-2">
      <title>Credible intervals</title>
      <p>To test whether our model and its posterior distribution for the log fold change are indeed appropriate, we tested symmetric credible intervals derived by our model using a special RNA-seq data set that recently became available. Usually, it is not possible to distinguish whether high copy numbers of observed sequences are the product of PCR amplification or indeed correspond to multiple copies of the same RNA fragment in the sample before amplification. By using random barcodes in the sequencing adapters, it is possible to make this distinction. In (<xref rid="B14" ref-type="bibr">14</xref>) 32+26 million paired-end mRNA-seq reads of two replicates for <italic>E. coli</italic> were generated that correspond to less than 85.000+58.000 original fragments. Thus, fragment counts should well fit the basic experimental model introduced above. Figure <xref ref-type="fig" rid="F2">2A</xref> shows a scatterplot of fragment counts for each gene in the two replicates. All genes should lie on a diagonal with slope 1 and an offset corresponding to the difference in sequencing depth of the two libraries and all deviations should be due to sampling noise according to our model. Indeed, only for 18 of 2193 genes, the diagonal is outside of their 99% credible interval. Without our model, we could only check how many genes are deviating more than 2-fold from this line (in this case 467 out of 2193), which could lead to wrong conclusions about the variability of the replicates.</p>
      <fig id="F2" orientation="portrait" position="float">
        <label>Figure 2.</label>
        <caption>
          <p>Credible intervals for random barcode RNA-seq data. (<bold>A</bold>) A scatter plot of the fragment counts from two replicate RNA-seq experiments for each gene is shown. The dashed line corresponds to a log<sub>2</sub> fold change (lfc) of 0, the dotted lines to a lfc of 1 and −1. Black dots correspond to genes where the normalization constant is outside of the 99% fold change credible interval. (<bold>B,C</bold>) The number of not credible genes and genes deviating more than 2-fold are illustrated; i.e. the number of black dots and dots outside of the dotted lines in Figure <xref ref-type="fig" rid="F2">2A</xref>, respectively. (<bold>D</bold>) The MAP fold changes of the local fragment coverage of <italic>fumA</italic>, their 99% credible intervals as well as the median of the posterior distribution (MED). The horizontal line corresponds to the estimated total fold change of fumA (total MAP). At several positions, the MAP is undefined due to zero coverage in one of the replicates. (<bold>E</bold>) The distribution of <italic>P</italic>-values computed by the posterior predictive function is shown for all positions in D. It is essentially a uniform distribution, i.e. the local fold changes indeed are distributed according to the beta binomial distribution, as predicted by our model.</p>
        </caption>
        <graphic xlink:href="gkv696fig2"/>
      </fig>
      <p>Moreover, we can graphically check the consistency of local fold changes across an mRNA by plotting local credible intervals (i.e. by computing the credible interval not for the whole mRNA but for each individual read count pair; illustrated for <italic>fumA</italic> in Figure <xref ref-type="fig" rid="F2">2D</xref>). The estimated mRNA log fold change should be within the bounds of the credible intervals along the whole mRNA (as for <italic>fumA</italic>; see Figure <xref ref-type="fig" rid="F2">2D</xref>). If not, deviations cannot be explained by sampling noise introduced by sequencing, but must be due to technical (see below) or biological reasons, e.g. differential splicing.</p>
      <p>This can also be tested formally by computing <italic>P</italic>-values of local fold changes using the Bayesian <italic>posterior predictive distribution</italic> that computes the probability of observing the measured read count pairs while respecting the uncertainty of the estimated mRNA log fold change (see Figure <xref ref-type="fig" rid="F2">2E</xref> for the <italic>P</italic>-value distribution for <italic>fumA</italic>). Without technical or biological influences, the distributions of these <italic>P</italic>-values for a single mRNA should resemble a uniform distribution, which can be tested using any hypothesis test for uniformity.</p>
    </sec>
    <sec id="SEC3-3">
      <title>Prior knowledge</title>
      <p>Often, prior knowledge is available for differential expression of genes. For instance, the experimenter could be 99% sure that the fold change of a certain gene is 2 with a tolerance of 0.5 fold. Or, when the two conditions under investigation are quite different, we would like to tolerate high fold changes in general, and only small changes, when conditions are highly similar.</p>
      <p>Our model allows to incorporate such prior information by transforming it into corresponding pseudocounts α and β (see Methods section for details).</p>
      <p>There are a few remarks here. First, even if no pseudocounts are used, i.e. α = β = 1, a specific <italic>log</italic><sub>2</sub> fold change distribution is imposed on the fold change estimator (see Figure <xref ref-type="fig" rid="F3">3A</xref> and <xref ref-type="fig" rid="F3">B</xref>). Specifically, deviations of at most 10 are tolerated with a certainty of about 90%. This does not mean that larger deviations are not allowed: the more data are used for the inference, the less influence has the prior distribution. However, this plays an important role especially for entities with few reads. Second, it is possible to intentionally bias fold changes toward specific values known a-priori by using asymmetric pseudocounts and our framework provides the theoretical background for specifying the intended value as well as its tolerance. For instance, if the log<sub>2</sub> fold change is supposed to lie between 0 and 2 with 50% certainty, α = 3.26 and β = 1.63 must be used. And, finally, α and β may be smaller than 1 (but strictly greater than 0), corresponding to a wider prior log<sub>2</sub> fold change distribution than when no pseudocounts are used (see Figure <xref ref-type="fig" rid="F3">3A</xref> and <xref ref-type="fig" rid="F3">B</xref>).</p>
      <fig id="F3" orientation="portrait" position="float">
        <label>Figure 3.</label>
        <caption>
          <p>Count ratio priors and posteriors. (<bold>A</bold>) log<sub>2</sub> densities of beta priors for different parameters are shown. Note that the prior density for the log<sub>2</sub> fold change is different from the prior density of the beta proportion <italic>p</italic>. The prior without pseudocounts (α = β = 1) has most of its mass between roughly -5 and 5. Smaller or greater tolerances can be achieved by using different choices for α and β. This is especially of importance when sample data are sparse (i.e. NGS read count is small). (<bold>B</bold>) The same distributions are illustrated by their cumulative probability of absolute log<sub>2</sub> fold changes, i.e. for each symmetric credible interval the probability is shown. More clearly than in (A), this shows that the prior belief of a deviation of at most 5 in both directions is about 75%. If larger deviations need to be tolerated, smaller parameter values have to be chosen. (<bold>C</bold>) Size of the 95% credible interval for different observed total read counts <italic>c</italic><sub>1</sub> + <italic>c</italic><sub>2</sub> in two conditions. <inline-formula><tex-math id="M40">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$l = \log _2 \frac{c_1}{c_2}$\end{document}</tex-math></inline-formula> is the estimated log<sub>2</sub> fold change, i.e. the black line corresponds to the cases where <italic>c</italic><sub>1</sub> = <italic>c</italic><sub>2</sub>. The measurement uncertainty is high for small and unbalanced <italic>c</italic><sub>1</sub>, <italic>c</italic><sub>2</sub> and slowly approaches 0 for larger read counts.</p>
        </caption>
        <graphic xlink:href="gkv696fig3"/>
      </fig>
    </sec>
    <sec id="SEC3-4">
      <title>Sampling accuracy</title>
      <p>An important benefit of our model is that it allows to estimate measurement uncertainty due to sampling (see Figure <xref ref-type="fig" rid="F3">3C</xref>). For instance, given the observed data, a 95% credible interval contains the true log fold change with a probability of 95%. If 50+50 reads have been observed, indicating a likely log fold change of 0, the 95% credible interval is greater than 1, indicating that the range of log fold changes that could have produced those read counts is between −0.5 and 0.5 (see Figure <xref ref-type="fig" rid="F3">3C</xref>). There are two interesting observations here. First, even for larger number of reads, the size of the credible interval approaches 0 only slowly, e.g. for 250+250 reads, the 95% interval is still greater than 0.5. And second, when the read counts are more unbalanced, the uncertainty is even greater (e.g. for 97+3 reads corresponding to a log fold change <italic>l</italic> ≈ 5, the interval spans log fold changes 3.5 to 6.5, which is a more than 8-fold difference). This clearly shows that although only considering the point estimate may be convenient, but gives only part of the truth.</p>
    </sec>
    <sec id="SEC3-5">
      <title>Conservative noise estimation</title>
      <p>So far we have provided evidence that this basic model is appropriate for data without PCR bias, e.g. when random barcodes are included to distinguish PCR duplicates from duplicate RNA fragments in the sample. First, the fold changes of genes between replicates are highly consistent and deviations can be explained by sampling noise (see above and Figure <xref ref-type="fig" rid="F2">2A</xref>–<xref ref-type="fig" rid="F2">C</xref>). And second, the same is true for local fold changes within genes (see Figure <xref ref-type="fig" rid="F2">2D</xref> and <xref ref-type="fig" rid="F2">E</xref>). However, this model should not directly be applied to standard RNA-seq data. If random barcodes are ignored in the <italic>E. coli</italic> RNA-seq data set, replicate gene fold changes are highly inconsistent, i.e. outside of their credible intervals (see Figure <xref ref-type="fig" rid="F4">4B</xref>). In addition, the quantiles from the posterior predictive distribution indicate extreme deviations and the estimated local fold change is clearly outside of the credible interval in almost all cases (see Figure <xref ref-type="fig" rid="F4">4D</xref> and <xref ref-type="fig" rid="F4">E</xref>). This indicates that the basic model severely underestimates noise in the presence of PCR amplified and biased read counts.</p>
      <fig id="F4" orientation="portrait" position="float">
        <label>Figure 4.</label>
        <caption>
          <p>Credible intervals for RNA-seq data. The same plots are shown as in Figure <xref ref-type="fig" rid="F2">2</xref>, but with reads instead of fragments, i.e. the random barcodes have not been used to infer fragment counts. Thus, this figure and its differences to Figure <xref ref-type="fig" rid="F2">2</xref> illustrate the expected results for an RNA-seq without random barcodes. Due to PCR amplification, read counts are artificially inflated, resulting in grossly underestimated sampling noise. See main text for a discussion.</p>
        </caption>
        <graphic xlink:href="gkv696fig4"/>
      </fig>
      <p>Furthermore, when ignoring random barcodes, 599 out of 2193 genes deviate more than 2-fold from the normalization constant (see Figure <xref ref-type="fig" rid="F4">4C</xref>) as compared to 467 genes, when random barcodes are respected. This clearly shows that PCR bias does not only affect quantification within a single experiment (<xref rid="B1" ref-type="bibr">1</xref>,<xref rid="B17" ref-type="bibr">17</xref>), but also differential quantification. Importantly, as the fold change estimate of the basic model is equivalent to fold changes derived from existing approaches, this is not only a problem of the proposed basic model but also of the standard method of taking the ratio of total read counts.</p>
      <p>The aggregation strategy in the basic model intrinsically assigns high weights to local fold changes derived from large read counts. This is an appropriate way to estimate noise, when large counts are produced by sampling, i.e. the corresponding fold changes are not heavily affected by noise and, thus, relatively stable. However, this is not reasonable, when read counts are artificially increased by PCR. Thus, the idea of the conservative version of this model is to reduce read counts.</p>
      <p>We propose and test several ad-hoc procedures for reducing the read count in order to reduce weights of local fold changes. We either compute the logarithm (LOG) or the square root (SQRT) of the original read count, or we divide both read counts <italic>c</italic><sub>1</sub> and <italic>c</italic><sub>2</sub> by a constant factor, either by max(<italic>c</italic><sub>1</sub>, <italic>c</italic><sub>2</sub>) (MAX), log<sub>2</sub>(max(<italic>c</italic><sub>1</sub>, <italic>c</italic><sub>2</sub>)) (LOGSC) or min(<italic>c</italic><sub>1</sub>, <italic>c</italic><sub>2</sub>) (MIN). MAX is the most conservative way of reducing the counts, i.e. it produces the smallest estimates of the fragment counts, and produced the best results, comparable to the estimates exploiting the barcodes(see Table <xref ref-type="table" rid="tbl1">1</xref>). Note that this is different from simply collapsing multi-copy sequences to a single read, which would restrict the dynamic range of fold changes severely.</p>
      <table-wrap id="tbl1" orientation="portrait" position="float">
        <label>Table 1.</label>
        <caption>
          <title>Outlier genes for different methods</title>
        </caption>
        <table frame="hsides" rules="groups">
          <thead>
            <tr>
              <th rowspan="1" colspan="1"/>
              <th rowspan="1" colspan="1">barcode</th>
              <th rowspan="1" colspan="1">reads</th>
              <th rowspan="1" colspan="1">MAX</th>
              <th rowspan="1" colspan="1">MIN</th>
              <th rowspan="1" colspan="1">LOGSC</th>
              <th rowspan="1" colspan="1">LOG</th>
              <th rowspan="1" colspan="1">SQRT</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td rowspan="1" colspan="1">Deviating &gt;2-fold</td>
              <td rowspan="1" colspan="1">
                <bold>467</bold>
              </td>
              <td rowspan="1" colspan="1">599</td>
              <td rowspan="1" colspan="1">
                <bold>477</bold>
              </td>
              <td rowspan="1" colspan="1">504</td>
              <td rowspan="1" colspan="1">496</td>
              <td rowspan="1" colspan="1">500</td>
              <td rowspan="1" colspan="1">525</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">Outside 99% credible interval</td>
              <td rowspan="1" colspan="1">
                <bold>18</bold>
              </td>
              <td rowspan="1" colspan="1">1970</td>
              <td rowspan="1" colspan="1">
                <bold>16</bold>
              </td>
              <td rowspan="1" colspan="1">60</td>
              <td rowspan="1" colspan="1">770</td>
              <td rowspan="1" colspan="1">767</td>
              <td rowspan="1" colspan="1">1233</td>
            </tr>
          </tbody>
        </table>
        <table-wrap-foot>
          <fn id="TFN001">
            <p>Downsampling significantly affects the number of genes outside of the 99% credible interval and deviating more than 2-fold.</p>
          </fn>
        </table-wrap-foot>
      </table-wrap>
    </sec>
    <sec id="SEC3-6">
      <title>Evaluation</title>
      <p>A crucial point in evaluating the performance of downsampling in estimation of fold changes is the availability of a gold standard to compare to. Quantitative real time PCR (qPCR) is often used as a targeted validation method for sequencing data, albeit issues about its accuracy have been raised recently (<xref rid="B31" ref-type="bibr">31</xref>). For the MAQC/SEQC projects (<xref rid="B27" ref-type="bibr">27</xref>,<xref rid="B31" ref-type="bibr">31</xref>), qPCR measurements have been performed for a large number of genes for standardized samples. Two publications report sequencing data for these two samples. In (<xref rid="B26" ref-type="bibr">26</xref>), the samples were sequenced in single-end mode on an Illumina Genome Analyzer II (subsequently called <italic>Bullard</italic> data set), and in (<xref rid="B31" ref-type="bibr">31</xref>), paired-end sequencing was used on an Illumina HiSeq 2000 (subsequently called <italic>SEQC</italic> data set). Furthermore, Bullard et al. used an older sample preparation protocol than the SEQC study. Comparing fold changes from both NGS data sets to the MAQC qPCR measurements allowed us to investigate whether downsampling is able to improve fold change estimates for NGS data measured using technology a few years old, and whether improvements are still observable for very recent and optimized sequencing techniques.</p>
      <p>Consistent with the results from the replicate comparison above, all downsampling methods improve deviations from the qPCR reference significantly (see Figure <xref ref-type="fig" rid="F5">5</xref>). Importantly, in all cases, there are also many genes where the deviation increases slightly upon downsampling. This can be a consequence of the fact that the qPCR fold changes are in fact not a gold standard and suffer from inaccuracies as well (<xref rid="B31" ref-type="bibr">31</xref>). Importantly, the accuracy gain for SEQC data set are less pronounced indicating that sequencing quality may have improved in recent years. However, it is unclear, whether this is a consequence of the sequencing mode (single-end versus paired-end), the sequencing device or differences in sample preparation. Nevertheless, even for the recent data set, downsampling still leads to significantly more accurate fold changes, indicating that there is still room for improvement by computational analysis methods.</p>
      <fig id="F5" orientation="portrait" position="float">
        <label>Figure 5.</label>
        <caption>
          <p>Validation of downsampling. (<bold>A/C</bold>) qPCR measurements from the MAQC/SEQC project are scattered against corresponding the mRNA-seq derived fold changes (A) for the older data set (<xref rid="B26" ref-type="bibr">26</xref>) and (B) for the more recent data set (C). Arrows are drawn for each gene indicating the fold changes before (arrow start) and after (arrow tip) downsampling by LOGSC. Improved fold changes are indicated in blue, worse fold changes in red. Fold changes whose deviation is smaller than two-fold with and without correction are indicated in gray. (<bold>B/D</bold>) Results are summarized for all procedures. The <italic>x</italic>-axis corresponds to the absolute difference of log2 fold change upon downsampling, i.e. to the length of an arrow in (A) and (C). Plotted is the log ratio comparing the number of genes that are improved to the number of genes that are made worse by downsampling for a minimal value of absolute difference. Dots correspond to statistically significant odds ratios according to a binomial test (<italic>p</italic> &lt; 0.01). In (B) especially for LOGSC and MAX, there are significantly more genes where downsampling leads to smaller deviations from the gold-standard than genes with larger deviation. In (D), differences between the downsampling approaches are less pronounced and odds are more modest (but still significantly in favor of improved fold changes).</p>
        </caption>
        <graphic xlink:href="gkv696fig5"/>
      </fig>
      <p>Furthermore, we tested how many genes are affected in a typical mRNA-seq experimental setting (<xref rid="B29" ref-type="bibr">29</xref>). Here, due to a missing reference, we cannot check whether corrected fold changes are more accurate than raw fold changes. However, we are interested in the number of genes that are called differentially expressed and affected by correction. In many cases, a set of differentially regulated genes is defined by imposing a cutoff on statistical significance and log fold change, or only on the log fold change if no or too few replicates are available (where the latter is the typical case). For default choices of this cutoff the set of differentially called genes changes by about 20%, i.e. a surprisingly large fraction of genes falls below or exceeds the cutoff due to the correction (see Figure <xref ref-type="fig" rid="F6">6</xref>). Thus, even if the correction affects fold changes only slightly, the gene sets from typical experiments may change dramatically after correction.</p>
      <fig id="F6" orientation="portrait" position="float">
        <label>Figure 6.</label>
        <caption>
          <p>Affected genes in a typical RNA-seq experiment. (<bold>A</bold>) In (<xref rid="B29" ref-type="bibr">29</xref>), the yeast transcriptome was analyzed using RNA-seq under 18 environmental conditions and here, results are shown for one possible comparison (<italic>congo red</italic> vs. <italic>DNA damage</italic>). The <italic>x</italic>-axis corresponds to absolute log<sub>2</sub> fold change thresholds. The <italic>y</italic>-axis shows which fraction of all genes that are above the threshold before <bold>or</bold> after correction are not above the threshold in both cases (black) and, how many genes are called differential before or after correction (gray). (<bold>B</bold>) The maximal fractions of different calls for log fold change thresholds between 1 and 3 is summarized for all 153 pairwise combinations of these 18 conditions.</p>
        </caption>
        <graphic xlink:href="gkv696fig6"/>
      </fig>
    </sec>
    <sec id="SEC3-7">
      <title>Handling replicates</title>
      <p>Replicate fold change measurements may be affected by noise (measurement uncertainty due to sampling) and potentially by bias. Here, by replicates we mean technical replicates where repeated sample preparations are sequenced from the same biological sample. Biological replicates may further be affected by natural variation between two equally treated samples.</p>
      <p>If the count ratio model is appropriate for NGS data, log fold change credible intervals from technical replicates should overlap (potentially after downsampling has been applied). To test this, we computed the squared Hellinger distance between posterior distributions from technical replicates of the SEQC data set (Replicates a and b for samples A and B measured at BGI; see Figure <xref ref-type="fig" rid="F7">7A</xref> and <xref ref-type="fig" rid="F7">B</xref>). The Hellinger distance (see Methods above) quantifies the similarity between two probability distributions and is 0 when the distributions are equal and approaches 1 when the distributions differ.</p>
      <fig id="F7" orientation="portrait" position="float">
        <label>Figure 7.</label>
        <caption>
          <p>Handling replicates. (<bold>A/B</bold>) Distribution of the squared Hellinger distance for the posterior distributions of the fold change between replicates for the genes with qPCR measurement without (A) and with LOGSC downsampling (B). Candlesticks show mean ± standard deviation from 100 resampled fold change posterior distributions. Without downsampling, distances are greater than expected, which means that estimates of the credible intervals are too small. This again is evidence that bias is involved for this data set. Indeed, upon controlling bias via downsampling, credible intervals are conservative estimates of the sampling noise. (<bold>C</bold>) The correlation of replicate log fold changes for genes with qPCR measurement is improved upon downsampling. Here, the coefficient of determination <italic>R</italic><sup>2</sup> is shown when <italic>n</italic> = 1...8 of the 8 lanes are considered (both replicates from sample A and B were measured on 8 lanes of a flow cell; thus, the number of lanes corresponds to sequencing depth). (<bold>D</bold>) Fold change estimates are improved for the average fold change computed for replicates (compare to Figure <xref ref-type="fig" rid="F5">5D</xref>).</p>
        </caption>
        <graphic xlink:href="gkv696fig7"/>
      </fig>
      <p>When no downsampling is applied, the squared Hellinger distances are slightly larger than expected from a resampling approach (see Methods). Thus, credible intervals overlap less than expected from a model that only incorporates sampling, or, equivalently, credible intervals are slightly to small without downsampling. This is expected, as from the above analyses we know, that bias indeed plays a role in this data set (see Figure <xref ref-type="fig" rid="F5">5</xref>). However, when downsampling is applied, credible intervals overlap more often than expected, which means that they are a conservative estimate of the range of fold changes with a (in a Bayesian sense) high degree of belief and that the count ratio model with downsampling is appropriate for this data set.</p>
      <p>Moreover, as indicated above, when multiple replicates are available, the experimenter may be interested in an average fold change. This can be estimated by pooling all reads before analysis. However, subjecting the pool of all replicates for the same condition to downsampling is not reasonable, as downsampling is supposed to remove PCR duplicates and two reads from distinct replicates may not be the result of the same amplified RNA fragment. Thus, we downsample each replicate separately and sum up downsampled read counts per replicate. Interestingly, this mode of downsampling improves the overall correlation between replicate fold changes (see Figure <xref ref-type="fig" rid="F7">7C</xref>). Furthermore, the average fold change is improved to a similar extend as for a single replicate upon downsampling (see Figure <xref ref-type="fig" rid="F7">7D</xref>).</p>
    </sec>
    <sec id="SEC3-8">
      <title>Bayesian modeling suggests a normalization procedure</title>
      <p>Due to different sequencing depths, normalization between experiments is necessary. The underlying principle of most normalization procedures is the assumption that either all or some specific genes are not changed on average. Often, a normalization factor is used to transform all fold changes such that they fulfill this assumption. Effectively, in DESeq (<xref rid="B24" ref-type="bibr">24</xref>), the median log<sub>2</sub> fold change of all genes is subtracted from all log<sub>2</sub> fold changes, i.e. after normalization, half of all genes appear downregulated, the other half upregulated.</p>
      <p>We can extend our computation of gene fold changes to a genome fold change which can be used as a normalization constant. Given the local read counts <italic>c</italic><sub><italic>g</italic>, <italic>i</italic>, <italic>j</italic></sub>, with <italic>g</italic> = 1.<italic>..G</italic> corresponding to all genes, <italic>i</italic> = 1.<italic>..N</italic><sub><italic>g</italic></sub> denoting the <italic>N</italic><sub><italic>g</italic></sub> positions in gene <italic>g</italic> and <italic>j</italic> = 1, 2 denoting the two experiments, the maximum likelihood estimator of the genome fold change is
<disp-formula id="M18"><label>(18)</label><tex-math id="M41">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}\begin{equation*} \hat{l_g}^{ML} = \log _2 \frac{\sum _{g=1}^G \sum _{i=1}^{N_g} c_{g,i,1}}{\sum _{g=1}^G \sum _{i=1}^{N_g} c_{g,i,2}} \end{equation*}\end{document}</tex-math></disp-formula></p>
      <p>This is equivalent to normalization by RPKM/FPKM. However, as before, this is only reasonable when read counts are not distorted by PCR amplification, i.e. when random barcodes have been used or bias has been reduced by proper downsampling procedures. Indeed, both possibilities, random barcodes and downsampled reads, result in similar normalization constants (see Figure <xref ref-type="fig" rid="F8">8A</xref>) that perform very well for the whole range of expression in the <italic>E. coli</italic> experiment (see Figure <xref ref-type="fig" rid="F8">8B</xref>). Surprisingly, when applied to random barcode data, the robust normalization constant estimate of DESeq appears to be questionable especially for medium to highly expressed genes (e.g. about 70% of all genes with total read count over 50 appear to be upregulated in replicate A; see Figure <xref ref-type="fig" rid="F8">8B</xref>). Moreover, when the normalization constant is estimated without random barcodes by DESeq (as in a normal RNA-seq experiment), the number of upregulated genes increases even further (see Figure <xref ref-type="fig" rid="F8">8B</xref>). Overall, for this data set, estimates based on the median of all <italic>log</italic><sub>2</sub> fold changes appear to be implausible and would imply questionable conclusions on differentially regulated genes.</p>
      <fig id="F8" orientation="portrait" position="float">
        <label>Figure 8.</label>
        <caption>
          <p>Evaluation of normalization procedures. (<bold>A</bold>) The four normalization constants correspond to horizontal lines in the MA plot of the observed (random barcode corrected) count data. Constants are either computed using the maximum likelihood estimate from random barcode corrected data (ML barcodes) or from MAX-downsampled read count data (ML downsampled reads), or by using DESeq applied to random barcode corrected (DESeq barcodes) or uncorrected data (DESeq reads). Both ML estimates are almost equal and different from DESeq estimates. Moreover, in contrast to the DESeq estimates, the ML estimates appear to lie in the middle of the points. This trend is more clear in (<bold>B</bold>), where the fraction of genes that appear upregulated in replicate A is shown for all minimal total expression thresholds. The median-based procedure of DESeq only leads to a 50%-50% ratio for the complete set of genes, but, for instance, about 70% of all genes with total read count of more than 50 appear to be upregulated. In contrast, the ML-based normalization factors behave very well over the whole range of expression thresholds.</p>
        </caption>
        <graphic xlink:href="gkv696fig8"/>
      </fig>
    </sec>
  </sec>
  <sec sec-type="discussion" id="SEC4">
    <title>DISCUSSION</title>
    <p>The standard way of computing fold changes from quantitative NGS data is to compute the ratio of the number of all reads belonging to a certain biological object in condition A and the number of all reads belonging to the same object in condition B. As introduced above, this total fold change is a weighted average of local fold changes, where positions with many reads contribute more to the total fold change than positions with few reads.</p>
    <p>Using RNA-seq data where PCR duplicates can be detected using a special experimental setup, we have shown that these weights are only reasonable when no bias is involved in local read counts and that read count bias does not generally cancel out when fold changes are computed. This unexpected result stems from the fact that read counts are aggregated for larger biological objects such as mRNAs, which leads to the fact, that linear bias of read counts is not linear for the larger objects. One way to deal with bias is to develop models that try to predict read count bias based on the observed read sequences. However, such methods suffer from several drawbacks. First, sequencing is a multistep protocol, and each step may introduce some sort of bias into the measurements that might still be unknown. Second, even if the source of bias is known, the biochemical processes behind it are highly complex and existing models gross oversimplifications. Third, even if those models were appropriate, incomplete observations could complicate bias predictions, as only prefixes (for single-end sequencing) or prefixes and suffixes (for paired-end sequencing) of the RNA molecules are usually observed in NGS.</p>
    <p>Therefore, we take a different route in the differential analysis of NGS data, which exploits the linearity assumption for bias acting on read counts and avoids the nonlinearity for bias acting on larger biological objects. Instead of first aggregating reads per biological entity for each sample and then computing ratios, we first compute all read count ratios and aggregate them to a total fold change. We have demonstrated that both workflows are equivalent when our proposed basic noise model is used. This means that taking the other route does not cancel out bias for free. If read counts are indeed biased, the basic model will underestimate noise. However, we have also shown that the basic model allows for straight-forward extensions to estimate noise in a more conservative manner, leading to more accurate fold change estimates as established for the MAQC data set.</p>
    <p>The proposed extensions are downsampling techniques that effectively reduce read counts proportionally. Instead of giving high-copy number reads high weights for the total fold change, all local fold changes are weighted similarly. Thus, our estimation draws its power from the large number of positions instead of the large number of reads. This is superior whenever amplification and not high-copy number fragments before amplification are the cause for large read counts. And indeed, based on the random barcode data and on the MAQC data, amplification appears to be the main cause for large read counts. However, depending on the extent of amplification bias in a specific data set, preserving at least the order of magnitude of two local read counts (e.g. by using the LOGSC procedure) may lead to more accurate fold change estimates.</p>
    <p>Our method does not only provide accurate fold changes, but it computes the full posterior distribution of (log) fold changes. Thus, if either the measurements are unbiased by the experimental design (e.g. by random barcodes), or by applying the proposed downsampling procedures, our model is able to compute reliable credible intervals for fold changes. However, we note that biological relevance of fold changes must be determined by other methods. Biological relevance is often measured by a <italic>P</italic>-value testing the null hypothesis that some treatment between conditions does not have an effect on a certain mRNA. Checking whether the log fold change 0 is outside of some credible interval does not test biological relevance, as here the null hypothesis only is that the two samples have the exact same copy number of mRNA. To find genes that are indeed affected by a treatment, biological replicates and an appropriate test are necessary, preferably respecting the estimated log fold change intervals (Erhard &amp; Zimmer, manuscript in preparation). Thus, the methods proposed here are especially appropriate for technical replicates, as the noise and bias involved therein is effectively handled. Our methods can nevertheless be applied to biological replicates, e.g. to estimate the effect size of a treatment or the average fold change, but not to estimate biological relevance of treatments.</p>
    <p>For all experiments, with or without replicates, proper normalization of samples is an important issue. When the total number of reads is used for normalization, as for RPKM/FPKM, a few high-count and differentially expressed genes may have great influence on the fold change. To avoid this bias, a robust normalization factor as in DESeq is often used. However, we have shown that incorporating many low-count genes may also lead to unrealistic normalization. Thus, we propose to return to the original idea of RPKM/FPKM and either use random barcodes in the experiments or downsampling procedures to overcome the problem of the strong influence of high-count genes. Depending on the experiment, however, it may be necessary to exclude differentially expressed genes from the computation of the normalization constant (<xref rid="B32" ref-type="bibr">32</xref>).</p>
    <p>mRNA-seq is arguably the most often and widely applied quantitative NGS technique. An important aspect in differential mRNA-seq analysis, which has not been investigated here, is differential splicing, i.e. the differential usage of alternative isoforms of genes between conditions. Visually, such genes can easily be analyzed by plotting local fold changes with credible intervals as in Figure <xref ref-type="fig" rid="F2">2D</xref>. For example, if the usage of an exon is differential, all local fold changes belonging to it should be distinct from local fold changes from other exons and credible intervals should not overlap. However, to detect differential isoform usage in an automated manner demands further work and evaluation.</p>
  </sec>
  <sec sec-type="conclusions" id="SEC5">
    <title>CONCLUSION</title>
    <p>We demonstrated that bias significantly affects computed fold changes for NGS experiments and proposed a method to remove such bias. We proposed a novel approach to estimate fold changes from NGS data that is based on the aggregation of many local fold changes instead of computing the fold change of aggregated read counts. We used our method to compare RNA-seq derived fold changes to qPCR derived fold changes from the MAQC project (<xref rid="B26" ref-type="bibr">26</xref>,<xref rid="B27" ref-type="bibr">27</xref>) and to analyze RNA-seq data where random barcodes have been incorporated to control PCR amplification bias. These analyses provided evidence that our method significantly improves estimates of fold changes. Furthermore, by analyzing additional RNA-seq data sets, we show that bias affects about 20% of genes that are called differentially expressed in a typical RNA-seq setting. Finally, our method can also be used to derive credible intervals and to incorporate prior knowledge for fold changes. It can be applied to standard RNA-seq data as an alternative to state-of-the-art methods for fold changes and normalization.</p>
  </sec>
</body>
<back>
  <ack>
    <p>The authors thank Gergely Csaba for providing STAR mappings of the Yeast and SEQC datasets and the anonymous reviewers for providing helpful comments on the manuscript.</p>
  </ack>
  <sec id="SEC6">
    <title>FUNDING</title>
    <p>This work was supported by the DFG collaborative research centers SFB 1035 (Conformational switches) and SFB 1123 (Atherosclerosis). Furthermore, the work was supported by the Bavarian Research Network of Molecular Biosystems (BioSysnet).</p>
    <p><italic>Conflict of interest statement</italic>. None declared.</p>
  </sec>
  <ref-list>
    <title>REFERENCES</title>
    <ref id="B1">
      <label>1.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Mortazavi</surname>
            <given-names>A.</given-names>
          </name>
          <name>
            <surname>Williams</surname>
            <given-names>B.A.</given-names>
          </name>
          <name>
            <surname>McCue</surname>
            <given-names>K.</given-names>
          </name>
          <name>
            <surname>Schaeffer</surname>
            <given-names>L.</given-names>
          </name>
          <name>
            <surname>Wold</surname>
            <given-names>B.</given-names>
          </name>
        </person-group>
        <article-title>Mapping and quantifying mammalian transcriptomes by RNA-Seq</article-title>
        <source>Nat. Methods</source>
        <year>2008</year>
        <volume>5</volume>
        <fpage>621</fpage>
        <lpage>628</lpage>
        <pub-id pub-id-type="pmid">18516045</pub-id>
      </element-citation>
    </ref>
    <ref id="B2">
      <label>2.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wang</surname>
            <given-names>Z.</given-names>
          </name>
          <name>
            <surname>Gerstein</surname>
            <given-names>M.</given-names>
          </name>
          <name>
            <surname>Snyder</surname>
            <given-names>M.</given-names>
          </name>
        </person-group>
        <article-title>RNA-Seq: a revolutionary tool for transcriptomics</article-title>
        <source>Nat. Rev. Genet.</source>
        <year>2009</year>
        <volume>10</volume>
        <fpage>57</fpage>
        <lpage>63</lpage>
        <pub-id pub-id-type="pmid">19015660</pub-id>
      </element-citation>
    </ref>
    <ref id="B3">
      <label>3.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ingolia</surname>
            <given-names>N.T.</given-names>
          </name>
          <name>
            <surname>Ghaemmaghami</surname>
            <given-names>S.</given-names>
          </name>
          <name>
            <surname>Newman</surname>
            <given-names>J.R.S.</given-names>
          </name>
          <name>
            <surname>Weissman</surname>
            <given-names>J.S.</given-names>
          </name>
        </person-group>
        <article-title>Genome-wide analysis in vivo of translation with nucleotide resolution using ribosome profiling</article-title>
        <source>Science</source>
        <year>2009</year>
        <volume>324</volume>
        <fpage>218</fpage>
        <lpage>223</lpage>
        <pub-id pub-id-type="pmid">19213877</pub-id>
      </element-citation>
    </ref>
    <ref id="B4">
      <label>4.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Crawford</surname>
            <given-names>G.E.</given-names>
          </name>
          <name>
            <surname>Holt</surname>
            <given-names>I.E.</given-names>
          </name>
          <name>
            <surname>Whittle</surname>
            <given-names>J.</given-names>
          </name>
          <name>
            <surname>Webb</surname>
            <given-names>B.D.</given-names>
          </name>
          <name>
            <surname>Tai</surname>
            <given-names>D.</given-names>
          </name>
          <name>
            <surname>Davis</surname>
            <given-names>S.</given-names>
          </name>
          <name>
            <surname>Margulies</surname>
            <given-names>E.H.</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>Y.</given-names>
          </name>
          <name>
            <surname>Bernat</surname>
            <given-names>J.A.</given-names>
          </name>
          <name>
            <surname>Ginsburg</surname>
            <given-names>D.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Genome-wide mapping of DNase hypersensitive sites using massively parallel signature sequencing (MPSS)</article-title>
        <source>Genome Res.</source>
        <year>2006</year>
        <volume>16</volume>
        <fpage>123</fpage>
        <lpage>131</lpage>
        <pub-id pub-id-type="pmid">16344561</pub-id>
      </element-citation>
    </ref>
    <ref id="B5">
      <label>5.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zhao</surname>
            <given-names>J.</given-names>
          </name>
          <name>
            <surname>Ohsumi</surname>
            <given-names>T.K.</given-names>
          </name>
          <name>
            <surname>Kung</surname>
            <given-names>J.T.</given-names>
          </name>
          <name>
            <surname>Ogawa</surname>
            <given-names>Y.</given-names>
          </name>
          <name>
            <surname>Grau</surname>
            <given-names>D.J.</given-names>
          </name>
          <name>
            <surname>Sarma</surname>
            <given-names>K.</given-names>
          </name>
          <name>
            <surname>Song</surname>
            <given-names>J.J.</given-names>
          </name>
          <name>
            <surname>Kingston</surname>
            <given-names>R.E.</given-names>
          </name>
          <name>
            <surname>Borowsky</surname>
            <given-names>M.</given-names>
          </name>
          <name>
            <surname>Lee</surname>
            <given-names>J.T.</given-names>
          </name>
        </person-group>
        <article-title>Genome-wide identification of polycomb-associated RNAs by RIP-seq</article-title>
        <source>Mol. Cell</source>
        <year>2010</year>
        <volume>40</volume>
        <fpage>939</fpage>
        <lpage>953</lpage>
        <pub-id pub-id-type="pmid">21172659</pub-id>
      </element-citation>
    </ref>
    <ref id="B6">
      <label>6.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hafner</surname>
            <given-names>M.</given-names>
          </name>
          <name>
            <surname>Landthaler</surname>
            <given-names>M.</given-names>
          </name>
          <name>
            <surname>Burger</surname>
            <given-names>L.</given-names>
          </name>
          <name>
            <surname>Khorshid</surname>
            <given-names>M.</given-names>
          </name>
          <name>
            <surname>Hausser</surname>
            <given-names>J.</given-names>
          </name>
          <name>
            <surname>Berninger</surname>
            <given-names>P.</given-names>
          </name>
          <name>
            <surname>Rothballer</surname>
            <given-names>A.</given-names>
          </name>
          <name>
            <surname>Ascano</surname>
            <given-names>Manuel, J.</given-names>
          </name>
          <name>
            <surname>Jungkamp</surname>
            <given-names>A.-C.</given-names>
          </name>
          <name>
            <surname>Munschauer</surname>
            <given-names>M.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Transcriptome-wide identification of RNA-binding protein and microRNA target sites by PAR-CLIP</article-title>
        <source>Cell</source>
        <year>2010</year>
        <volume>141</volume>
        <fpage>129</fpage>
        <lpage>141</lpage>
        <pub-id pub-id-type="pmid">20371350</pub-id>
      </element-citation>
    </ref>
    <ref id="B7">
      <label>7.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>König</surname>
            <given-names>J.</given-names>
          </name>
          <name>
            <surname>Zarnack</surname>
            <given-names>K.</given-names>
          </name>
          <name>
            <surname>Rot</surname>
            <given-names>G.</given-names>
          </name>
          <name>
            <surname>Curk</surname>
            <given-names>T.</given-names>
          </name>
          <name>
            <surname>Kayikci</surname>
            <given-names>M.</given-names>
          </name>
          <name>
            <surname>Zupan</surname>
            <given-names>B.</given-names>
          </name>
          <name>
            <surname>Turner</surname>
            <given-names>D.J.</given-names>
          </name>
          <name>
            <surname>Luscombe</surname>
            <given-names>N.M.</given-names>
          </name>
          <name>
            <surname>Ule</surname>
            <given-names>J.</given-names>
          </name>
        </person-group>
        <article-title>iCLIP reveals the function of hnRNP particles in splicing at individual nucleotide resolution</article-title>
        <source>Nat. Struct. Mol. Biol.</source>
        <year>2010</year>
        <volume>17</volume>
        <fpage>909</fpage>
        <lpage>915</lpage>
        <pub-id pub-id-type="pmid">20601959</pub-id>
      </element-citation>
    </ref>
    <ref id="B8">
      <label>8.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Licatalosi</surname>
            <given-names>D.D.</given-names>
          </name>
          <name>
            <surname>Mele</surname>
            <given-names>A.</given-names>
          </name>
          <name>
            <surname>Fak</surname>
            <given-names>J.J.</given-names>
          </name>
          <name>
            <surname>Ule</surname>
            <given-names>J.</given-names>
          </name>
          <name>
            <surname>Kayikci</surname>
            <given-names>M.</given-names>
          </name>
          <name>
            <surname>Chi</surname>
            <given-names>S.W.</given-names>
          </name>
          <name>
            <surname>Clark</surname>
            <given-names>T.A.</given-names>
          </name>
          <name>
            <surname>Schweitzer</surname>
            <given-names>A.C.</given-names>
          </name>
          <name>
            <surname>Blume</surname>
            <given-names>J.E.</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>X.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>HITS-CLIP yields genome-wide insights into brain alternative RNA processing</article-title>
        <source>Nature</source>
        <year>2008</year>
        <volume>456</volume>
        <fpage>464</fpage>
        <lpage>469</lpage>
        <pub-id pub-id-type="pmid">18978773</pub-id>
      </element-citation>
    </ref>
    <ref id="B9">
      <label>9.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bhinge</surname>
            <given-names>A.A.</given-names>
          </name>
          <name>
            <surname>Kim</surname>
            <given-names>J.</given-names>
          </name>
          <name>
            <surname>Euskirchen</surname>
            <given-names>G.M.</given-names>
          </name>
          <name>
            <surname>Snyder</surname>
            <given-names>M.</given-names>
          </name>
          <name>
            <surname>Iyer</surname>
            <given-names>V.R.</given-names>
          </name>
        </person-group>
        <article-title>Mapping the chromosomal targets of STAT1 by Sequence Tag Analysis of Genomic Enrichment (STAGE)</article-title>
        <source>Genome Res.</source>
        <year>2007</year>
        <volume>17</volume>
        <fpage>910</fpage>
        <lpage>916</lpage>
        <pub-id pub-id-type="pmid">17568006</pub-id>
      </element-citation>
    </ref>
    <ref id="B10">
      <label>10.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Furey</surname>
            <given-names>T.S.</given-names>
          </name>
        </person-group>
        <article-title>ChIP-seq and beyond: new and improved methodologies to detect and characterize protein-DNA interactions</article-title>
        <source>Nat. Rev. Genet.</source>
        <year>2012</year>
        <volume>13</volume>
        <fpage>840</fpage>
        <lpage>852</lpage>
        <pub-id pub-id-type="pmid">23090257</pub-id>
      </element-citation>
    </ref>
    <ref id="B11">
      <label>11.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kertesz</surname>
            <given-names>M.</given-names>
          </name>
          <name>
            <surname>Wan</surname>
            <given-names>Y.</given-names>
          </name>
          <name>
            <surname>Mazor</surname>
            <given-names>E.</given-names>
          </name>
          <name>
            <surname>Rinn</surname>
            <given-names>J.L.</given-names>
          </name>
          <name>
            <surname>Nutter</surname>
            <given-names>R.C.</given-names>
          </name>
          <name>
            <surname>Chang</surname>
            <given-names>H.Y.</given-names>
          </name>
          <name>
            <surname>Segal</surname>
            <given-names>E.</given-names>
          </name>
        </person-group>
        <article-title>Genome-wide measurement of RNA secondary structure in yeast</article-title>
        <source>Nature</source>
        <year>2010</year>
        <volume>467</volume>
        <fpage>103</fpage>
        <lpage>107</lpage>
        <pub-id pub-id-type="pmid">20811459</pub-id>
      </element-citation>
    </ref>
    <ref id="B12">
      <label>12.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Trapnell</surname>
            <given-names>C.</given-names>
          </name>
          <name>
            <surname>Hendrickson</surname>
            <given-names>D.G.</given-names>
          </name>
          <name>
            <surname>Sauvageau</surname>
            <given-names>M.</given-names>
          </name>
          <name>
            <surname>Goff</surname>
            <given-names>L.</given-names>
          </name>
          <name>
            <surname>Rinn</surname>
            <given-names>J.L.</given-names>
          </name>
          <name>
            <surname>Pachter</surname>
            <given-names>L.</given-names>
          </name>
        </person-group>
        <article-title>Differential analysis of gene regulation at transcript resolution with RNA-seq</article-title>
        <source>Nat. Biotechnol.</source>
        <year>2013</year>
        <volume>31</volume>
        <fpage>46</fpage>
        <lpage>53</lpage>
        <pub-id pub-id-type="pmid">23222703</pub-id>
      </element-citation>
    </ref>
    <ref id="B13">
      <label>13.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Aird</surname>
            <given-names>D.</given-names>
          </name>
          <name>
            <surname>Ross</surname>
            <given-names>M.G.</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>W.-S.</given-names>
          </name>
          <name>
            <surname>Danielsson</surname>
            <given-names>M.</given-names>
          </name>
          <name>
            <surname>Fennell</surname>
            <given-names>T.</given-names>
          </name>
          <name>
            <surname>Russ</surname>
            <given-names>C.</given-names>
          </name>
          <name>
            <surname>Jaffe</surname>
            <given-names>D.B.</given-names>
          </name>
          <name>
            <surname>Nusbaum</surname>
            <given-names>C.</given-names>
          </name>
          <name>
            <surname>Gnirke</surname>
            <given-names>A.</given-names>
          </name>
        </person-group>
        <article-title>Analyzing and minimizing PCR amplification bias in Illumina sequencing libraries</article-title>
        <source>Genome Biol.</source>
        <year>2011</year>
        <volume>12</volume>
        <fpage>R18</fpage>
        <pub-id pub-id-type="pmid">21338519</pub-id>
      </element-citation>
    </ref>
    <ref id="B14">
      <label>14.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Shiroguchi</surname>
            <given-names>K.</given-names>
          </name>
          <name>
            <surname>Jia</surname>
            <given-names>T.Z.</given-names>
          </name>
          <name>
            <surname>Sims</surname>
            <given-names>P.A.</given-names>
          </name>
          <name>
            <surname>Xie</surname>
            <given-names>X.S.</given-names>
          </name>
        </person-group>
        <article-title>Digital RNA sequencing minimizes sequence-dependent bias and amplification noise with optimized single-molecule barcodes</article-title>
        <source>Proc. Natl. Acad. Sci. U.S.A.</source>
        <year>2012</year>
        <volume>109</volume>
        <fpage>1347</fpage>
        <lpage>1352</lpage>
        <pub-id pub-id-type="pmid">22232676</pub-id>
      </element-citation>
    </ref>
    <ref id="B15">
      <label>15.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Raabe</surname>
            <given-names>C.A.</given-names>
          </name>
          <name>
            <surname>Hoe</surname>
            <given-names>C.H.</given-names>
          </name>
          <name>
            <surname>Randau</surname>
            <given-names>G.</given-names>
          </name>
          <name>
            <surname>Brosius</surname>
            <given-names>J.</given-names>
          </name>
          <name>
            <surname>Tang</surname>
            <given-names>T.H.</given-names>
          </name>
          <name>
            <surname>Rozhdestvensky</surname>
            <given-names>T.S.</given-names>
          </name>
        </person-group>
        <article-title>The rocks and shallows of deep RNA sequencing: Examples in the Vibrio cholerae RNome</article-title>
        <source>RNA</source>
        <year>2011</year>
        <volume>17</volume>
        <fpage>1357</fpage>
        <lpage>1366</lpage>
        <pub-id pub-id-type="pmid">21610211</pub-id>
      </element-citation>
    </ref>
    <ref id="B16">
      <label>16.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zhuang</surname>
            <given-names>F.</given-names>
          </name>
          <name>
            <surname>Fuchs</surname>
            <given-names>R.T.</given-names>
          </name>
          <name>
            <surname>Sun</surname>
            <given-names>Z.</given-names>
          </name>
          <name>
            <surname>Zheng</surname>
            <given-names>Y.</given-names>
          </name>
          <name>
            <surname>Robb</surname>
            <given-names>G.B.</given-names>
          </name>
        </person-group>
        <article-title>Structural bias in T4 RNA ligase-mediated 3’-adapter ligation</article-title>
        <source>Nucleic Acids Res.</source>
        <year>2012</year>
        <volume>40</volume>
        <fpage>e54</fpage>
        <pub-id pub-id-type="pmid">22241775</pub-id>
      </element-citation>
    </ref>
    <ref id="B17">
      <label>17.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Evans</surname>
            <given-names>S.N.</given-names>
          </name>
          <name>
            <surname>Hower</surname>
            <given-names>V.</given-names>
          </name>
          <name>
            <surname>Pachter</surname>
            <given-names>L.</given-names>
          </name>
        </person-group>
        <article-title>Coverage statistics for sequence census methods</article-title>
        <source>BMC Bioinformatics</source>
        <year>2010</year>
        <volume>11</volume>
        <fpage>430</fpage>
        <pub-id pub-id-type="pmid">20718980</pub-id>
      </element-citation>
    </ref>
    <ref id="B18">
      <label>18.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Li</surname>
            <given-names>J.</given-names>
          </name>
          <name>
            <surname>Jiang</surname>
            <given-names>H.</given-names>
          </name>
          <name>
            <surname>Wong</surname>
            <given-names>W.H.</given-names>
          </name>
        </person-group>
        <article-title>Modeling non-uniformity in short-read rates in RNA-Seq data</article-title>
        <source>Genome Biol.</source>
        <year>2010</year>
        <volume>11</volume>
        <fpage>R50</fpage>
        <pub-id pub-id-type="pmid">20459815</pub-id>
      </element-citation>
    </ref>
    <ref id="B19">
      <label>19.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Linsen</surname>
            <given-names>S.E.V.</given-names>
          </name>
          <name>
            <surname>de Wit</surname>
            <given-names>E.</given-names>
          </name>
          <name>
            <surname>Janssens</surname>
            <given-names>G.</given-names>
          </name>
          <name>
            <surname>Heater</surname>
            <given-names>S.</given-names>
          </name>
          <name>
            <surname>Chapman</surname>
            <given-names>L.</given-names>
          </name>
          <name>
            <surname>Parkin</surname>
            <given-names>R.K.</given-names>
          </name>
          <name>
            <surname>Fritz</surname>
            <given-names>B.</given-names>
          </name>
          <name>
            <surname>Wyman</surname>
            <given-names>S.K.</given-names>
          </name>
          <name>
            <surname>de Bruijn</surname>
            <given-names>E.</given-names>
          </name>
          <name>
            <surname>Voest</surname>
            <given-names>E.E.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Limitations and possibilities of small RNA digital gene expression profiling</article-title>
        <source>Nat. Methods</source>
        <year>2009</year>
        <volume>6</volume>
        <fpage>474</fpage>
        <lpage>476</lpage>
        <pub-id pub-id-type="pmid">19564845</pub-id>
      </element-citation>
    </ref>
    <ref id="B20">
      <label>20.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Roberts</surname>
            <given-names>A.</given-names>
          </name>
          <name>
            <surname>Trapnell</surname>
            <given-names>C.</given-names>
          </name>
          <name>
            <surname>Donaghey</surname>
            <given-names>J.</given-names>
          </name>
          <name>
            <surname>Rinn</surname>
            <given-names>J.L.</given-names>
          </name>
          <name>
            <surname>Pachter</surname>
            <given-names>L.</given-names>
          </name>
        </person-group>
        <article-title>Improving RNA-Seq expression estimates by correcting for fragment bias</article-title>
        <source>Genome Biol.</source>
        <year>2011</year>
        <volume>12</volume>
        <fpage>R22</fpage>
        <pub-id pub-id-type="pmid">21410973</pub-id>
      </element-citation>
    </ref>
    <ref id="B21">
      <label>21.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Guo</surname>
            <given-names>H.</given-names>
          </name>
          <name>
            <surname>Ingolia</surname>
            <given-names>N.T.</given-names>
          </name>
          <name>
            <surname>Weissman</surname>
            <given-names>J.S.</given-names>
          </name>
          <name>
            <surname>Bartel</surname>
            <given-names>D.P.</given-names>
          </name>
        </person-group>
        <article-title>Mammalian microRNAs predominantly act to decrease target mRNA levels</article-title>
        <source>Nature</source>
        <year>2010</year>
        <volume>466</volume>
        <fpage>835</fpage>
        <lpage>840</lpage>
        <pub-id pub-id-type="pmid">20703300</pub-id>
      </element-citation>
    </ref>
    <ref id="B22">
      <label>22.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Erhard</surname>
            <given-names>F.</given-names>
          </name>
          <name>
            <surname>Haas</surname>
            <given-names>J.</given-names>
          </name>
          <name>
            <surname>Lieber</surname>
            <given-names>D.</given-names>
          </name>
          <name>
            <surname>Malterer</surname>
            <given-names>G.</given-names>
          </name>
          <name>
            <surname>Jaskiewicz</surname>
            <given-names>L.</given-names>
          </name>
          <name>
            <surname>Zavolan</surname>
            <given-names>M.</given-names>
          </name>
          <name>
            <surname>Dölken</surname>
            <given-names>L.</given-names>
          </name>
          <name>
            <surname>Zimmer</surname>
            <given-names>R.</given-names>
          </name>
        </person-group>
        <article-title>Widespread context dependency of microRNA-mediated regulation</article-title>
        <source>Genome Res.</source>
        <year>2014</year>
        <volume>24</volume>
        <fpage>906</fpage>
        <lpage>919</lpage>
        <pub-id pub-id-type="pmid">24668909</pub-id>
      </element-citation>
    </ref>
    <ref id="B23">
      <label>23.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Erhard</surname>
            <given-names>F.</given-names>
          </name>
          <name>
            <surname>Dolken</surname>
            <given-names>L.</given-names>
          </name>
          <name>
            <surname>Jaskiewicz</surname>
            <given-names>L.</given-names>
          </name>
          <name>
            <surname>Zimmer</surname>
            <given-names>R.</given-names>
          </name>
        </person-group>
        <article-title>PARma: identification of microRNA target sites in AGO-PAR-CLIP data</article-title>
        <source>Genome Biol.</source>
        <year>2013</year>
        <volume>14</volume>
        <fpage>R79</fpage>
        <pub-id pub-id-type="pmid">23895117</pub-id>
      </element-citation>
    </ref>
    <ref id="B24">
      <label>24.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Anders</surname>
            <given-names>S.</given-names>
          </name>
          <name>
            <surname>Huber</surname>
            <given-names>W.</given-names>
          </name>
        </person-group>
        <article-title>Differential expression analysis for sequence count data</article-title>
        <source>Genome Biol.</source>
        <year>2010</year>
        <volume>11</volume>
        <fpage>R106</fpage>
        <pub-id pub-id-type="pmid">20979621</pub-id>
      </element-citation>
    </ref>
    <ref id="B25">
      <label>25.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Srivastava</surname>
            <given-names>S.</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>L.</given-names>
          </name>
        </person-group>
        <article-title>A two-parameter generalized Poisson model to improve the analysis of RNA-seq data</article-title>
        <source>Nucleic Acids Res.</source>
        <year>2010</year>
        <volume>38</volume>
        <fpage>e170</fpage>
        <pub-id pub-id-type="pmid">20671027</pub-id>
      </element-citation>
    </ref>
    <ref id="B26">
      <label>26.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bullard</surname>
            <given-names>J.H.</given-names>
          </name>
          <name>
            <surname>Purdom</surname>
            <given-names>E.</given-names>
          </name>
          <name>
            <surname>Hansen</surname>
            <given-names>K.D.</given-names>
          </name>
          <name>
            <surname>Dudoit</surname>
            <given-names>S.</given-names>
          </name>
        </person-group>
        <article-title>Evaluation of statistical methods for normalization and differential expression in mRNA-Seq experiments</article-title>
        <source>BMC Bioinformatics</source>
        <year>2010</year>
        <volume>11</volume>
        <fpage>94</fpage>
        <pub-id pub-id-type="pmid">20167110</pub-id>
      </element-citation>
    </ref>
    <ref id="B27">
      <label>27.</label>
      <element-citation publication-type="journal">
        <collab>The MAQC Consortium</collab>
        <article-title>The MicroArray Quality Control (MAQC)-II study of common practices for the development and validation of microarray-based predictive models</article-title>
        <source>Nat. Biotechnol.</source>
        <year>2010</year>
        <volume>28</volume>
        <fpage>827</fpage>
        <lpage>838</lpage>
        <pub-id pub-id-type="pmid">20676074</pub-id>
      </element-citation>
    </ref>
    <ref id="B28">
      <label>28.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Langmead</surname>
            <given-names>B.</given-names>
          </name>
          <name>
            <surname>Trapnell</surname>
            <given-names>C.</given-names>
          </name>
          <name>
            <surname>Pop</surname>
            <given-names>M.</given-names>
          </name>
          <name>
            <surname>Salzberg</surname>
            <given-names>S.L.</given-names>
          </name>
        </person-group>
        <article-title>Ultrafast and memory-efficient alignment of short DNA sequences to the human genome</article-title>
        <source>Genome Biol.</source>
        <year>2009</year>
        <volume>10</volume>
        <fpage>R25</fpage>
        <pub-id pub-id-type="pmid">19261174</pub-id>
      </element-citation>
    </ref>
    <ref id="B29">
      <label>29.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Waern</surname>
            <given-names>K.</given-names>
          </name>
          <name>
            <surname>Snyder</surname>
            <given-names>M.</given-names>
          </name>
        </person-group>
        <article-title>Extensive transcript diversity and novel upstream open reading frame regulation in yeast</article-title>
        <source>G3 (Bethesda, Md.)</source>
        <year>2013</year>
        <volume>3</volume>
        <fpage>343</fpage>
        <lpage>352</lpage>
      </element-citation>
    </ref>
    <ref id="B30">
      <label>30.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Dobin</surname>
            <given-names>A.</given-names>
          </name>
          <name>
            <surname>Davis</surname>
            <given-names>C.A.</given-names>
          </name>
          <name>
            <surname>Schlesinger</surname>
            <given-names>F.</given-names>
          </name>
          <name>
            <surname>Drenkow</surname>
            <given-names>J.</given-names>
          </name>
          <name>
            <surname>Zaleski</surname>
            <given-names>C.</given-names>
          </name>
          <name>
            <surname>Jha</surname>
            <given-names>S.</given-names>
          </name>
          <name>
            <surname>Batut</surname>
            <given-names>P.</given-names>
          </name>
          <name>
            <surname>Chaisson</surname>
            <given-names>M.</given-names>
          </name>
          <name>
            <surname>Gingeras</surname>
            <given-names>T.R.</given-names>
          </name>
        </person-group>
        <article-title>STAR: ultrafast universal RNA-seq aligner</article-title>
        <source>Bioinformatics</source>
        <year>2013</year>
        <volume>29</volume>
        <fpage>15</fpage>
        <lpage>21</lpage>
        <pub-id pub-id-type="pmid">23104886</pub-id>
      </element-citation>
    </ref>
    <ref id="B31">
      <label>31.</label>
      <element-citation publication-type="journal">
        <collab>Seqc/Maqc-Iii Consortium</collab>
        <article-title>A comprehensive assessment of RNA-seq accuracy, reproducibility and information content by the Sequencing Quality Control Consortium</article-title>
        <source>Nat. Biotechnol.</source>
        <year>2014</year>
        <volume>32</volume>
        <fpage>903</fpage>
        <lpage>914</lpage>
        <pub-id pub-id-type="pmid">25150838</pub-id>
      </element-citation>
    </ref>
    <ref id="B32">
      <label>32.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zien</surname>
            <given-names>A.</given-names>
          </name>
          <name>
            <surname>Aigner</surname>
            <given-names>T.</given-names>
          </name>
          <name>
            <surname>Zimmer</surname>
            <given-names>R.</given-names>
          </name>
          <name>
            <surname>Lengauer</surname>
            <given-names>T.</given-names>
          </name>
        </person-group>
        <article-title>Centralization: a new method for the normalization of gene expression data</article-title>
        <source>Bioinformatics</source>
        <year>2001</year>
        <volume>17</volume>
        <fpage>S323</fpage>
        <lpage>S331</lpage>
        <pub-id pub-id-type="pmid">11473024</pub-id>
      </element-citation>
    </ref>
  </ref-list>
</back>
