<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//NLM//DTD Journal Publishing DTD v2.3 20070202//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName journalpublishing.dtd?>
<?SourceDTD.Version 2.3?>
<?ConverterInfo.XSLTName jp2nlmx2.xsl?>
<?ConverterInfo.Version 2?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Bioinformatics</journal-id>
    <journal-id journal-id-type="publisher-id">bioinformatics</journal-id>
    <journal-id journal-id-type="hwp">bioinfo</journal-id>
    <journal-title-group>
      <journal-title>Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1367-4803</issn>
    <issn pub-type="epub">1367-4811</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">2796818</article-id>
    <article-id pub-id-type="doi">10.1093/bioinformatics/btp616</article-id>
    <article-id pub-id-type="publisher-id">btp616</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Applications Note</subject>
        <subj-group>
          <subject>Gene Expression</subject>
        </subj-group>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title><monospace>edgeR</monospace>: a Bioconductor package for differential expression analysis of digital gene expression data</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Robinson</surname>
          <given-names>Mark D.</given-names>
        </name>
        <xref ref-type="aff" rid="AFF1">
          <sup>1</sup>
        </xref>
        <xref ref-type="aff" rid="AFF1">
          <sup>2</sup>
        </xref>
        <xref ref-type="corresp" rid="COR1">*</xref>
        <xref ref-type="author-notes" rid="FN1">
          <sup>†</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <name>
          <surname>McCarthy</surname>
          <given-names>Davis J.</given-names>
        </name>
        <xref ref-type="aff" rid="AFF1">
          <sup>2</sup>
        </xref>
        <xref ref-type="author-notes" rid="FN1">
          <sup>†</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Smyth</surname>
          <given-names>Gordon K.</given-names>
        </name>
        <xref ref-type="aff" rid="AFF1">
          <sup>2</sup>
        </xref>
      </contrib>
    </contrib-group>
    <aff id="AFF1"><sup>1</sup> Cancer Program, Garvan Institute of Medical Research, 384 Victoria Street, Darlinghurst, NSW 2010 and <sup>2</sup> Bioinformatics Division, The Walter and Eliza Hall Institute of Medical Research, 1G Royal Parade, Parkville, Victoria 3052, Australia</aff>
    <author-notes>
      <corresp id="COR1">* To whom correspondence should be addressed</corresp>
      <fn id="FN1">
        <p><sup>†</sup> The authors wish it to be known that, in their opinion, the first two authors should be regarded as joint First Authors.</p>
      </fn>
      <fn>
        <p>Associate Editor: Joaquin Dopazo</p>
      </fn>
    </author-notes>
    <pub-date pub-type="ppub">
      <day>1</day>
      <month>1</month>
      <year>2010</year>
    </pub-date>
    <pub-date pub-type="epub">
      <day>11</day>
      <month>11</month>
      <year>2009</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>11</day>
      <month>11</month>
      <year>2009</year>
    </pub-date>
    <!-- PMC Release delay is 0 months and 0 days and was based on the
							<pub-date pub-type="epub"/>. -->
    <volume>26</volume>
    <issue>1</issue>
    <fpage>139</fpage>
    <lpage>140</lpage>
    <history>
      <date date-type="received">
        <day>29</day>
        <month>3</month>
        <year>2009</year>
      </date>
      <date date-type="rev-recd">
        <day>19</day>
        <month>10</month>
        <year>2009</year>
      </date>
      <date date-type="accepted">
        <day>23</day>
        <month>10</month>
        <year>2009</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2009. Published by Oxford University Press.</copyright-statement>
      <copyright-year>2009</copyright-year>
      <license license-type="creative-commons" xlink:href="http://creativecommons.org/licenses/by-nc/2.0/uk/">
        <license-p><!--CREATIVE COMMONS-->This is an Open Access article distributed under the terms of the Creative Commons Attribution Non-Commercial License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by-nc/2.5/uk/">http://creativecommons.org/licenses/by-nc/2.5/uk/</ext-link>) which permits unrestricted non-commercial use, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <abstract>
      <p><bold>Summary:</bold> It is expected that emerging digital gene expression (DGE) technologies will overtake microarray technologies in the near future for many functional genomics applications. One of the fundamental data analysis tasks, especially for gene expression studies, involves determining whether there is evidence that <italic>counts</italic> for a transcript or exon are significantly different across experimental conditions. <monospace>edgeR</monospace> is a Bioconductor software package for examining differential expression of replicated count data. An overdispersed Poisson model is used to account for both biological and technical variability. Empirical Bayes methods are used to moderate the degree of overdispersion across transcripts, improving the reliability of inference. The methodology can be used even with the most minimal levels of replication, provided at least one phenotype or experimental condition is replicated. The software may have other applications beyond sequencing data, such as proteome peptide count data.</p>
      <p><bold>Availability:</bold> The package is freely available under the LGPL licence from the Bioconductor web site (<ext-link ext-link-type="uri" xlink:href="http://bioconductor.org">http://bioconductor.org</ext-link>).</p>
      <p>
        <bold>Contact:</bold>
        <email>mrobinson@wehi.edu.au</email>
      </p>
    </abstract>
  </article-meta>
</front>
<body>
  <sec sec-type="intro" id="SEC1">
    <title>1 INTRODUCTION</title>
    <p>Modern molecular biology data present major challenges for the statistical methods that are used to detect differential expression, such as the requirement of multiple testing procedures and increasingly, empirical Bayes or similar methods that share information across all observations to improve inference. For microarrays, the abundance of a particular transcript is measured as a fluorescence intensity, effectively a continuous response, whereas for digital gene expression (DGE) data the abundance is observed as a count. Therefore, procedures that are successful for microarray data are not directly applicable to DGE data.</p>
    <p>This note describes the software package <monospace>edgeR</monospace> (empirical analysis of DGE in <monospace>R</monospace>), which forms part of the Bioconductor project (Gentleman <italic>et al.</italic>, <xref ref-type="bibr" rid="B2">2004</xref>). <monospace>edgeR</monospace> is designed for the analysis of replicated count-based expression data and is an implementation of methology developed by Robinson and Smyth (<xref ref-type="bibr" rid="B5">2007</xref>, <xref ref-type="bibr" rid="B6">2008</xref>). Although initially developed for serial analysis of gene expression (SAGE), the methods and software should be equally applicable to emerging technologies such as RNA-seq (Li <italic>et al.</italic>, <xref ref-type="bibr" rid="B3">2008</xref>; Marioni <italic>et al.</italic>, <xref ref-type="bibr" rid="B4">2008</xref>) giving rise to digital expression data. <monospace>edgeR</monospace> may also be useful in other experiments that generate counts, such as ChIP-seq, in proteomics experiments where spectral counts are used to summarize the peptide abundance (Wong <italic>et al.</italic>, <xref ref-type="bibr" rid="B9">2008</xref>), or in barcoding experiments where several species are counted (Andersson <italic>et al.</italic>, <xref ref-type="bibr" rid="B1">2008</xref>). The software is designed for finding changes between two or more groups when at least one of the groups has replicated measurements.</p>
  </sec>
  <sec id="SEC2">
    <title>2 MODEL</title>
    <p>Bioinformatics researchers have learned many things from the analysis of microarray data. For instance, power to detect differential expression can be improved and false discoveries reduced by sharing information across all probes. One such procedure is <monospace>limma</monospace> (Smyth, <xref ref-type="bibr" rid="B7">2004</xref>), where an empirical Bayes model is used to moderate the probe-wise variances. The moderated variances replace the probe-wise variances in the <italic>t</italic>- and <italic>F</italic>-statistic calculations. In a closely analogous but mathematically more complex procedure, <monospace>edgeR</monospace> models count data using an overdispersed Poisson model, and uses an empirical Bayes procedure to moderate the degree of overdispersion across genes.</p>
    <p>We assume the data can be summarized into a table of counts, with rows corresponding to genes (or tags or exons or transcripts) and columns to samples. For RNA-seq experiments, these may be counts at the exon, transcript or gene-level. We model the data as negative binomial (NB) distributed,
<disp-formula id="M1"><label>(1)</label><graphic xlink:href="btp616m1"/></disp-formula>
for gene <italic>g</italic> and sample <italic>i</italic>. Here, <italic>M</italic><sub><italic>i</italic></sub> is the library size (total number of reads), ϕ<sub><italic>g</italic></sub> is the dispersion and <italic>p</italic><sub><italic>gj</italic></sub> is the relative abundance of gene <italic>g</italic> in experimental group <italic>j</italic> to which sample <italic>i</italic> belongs. We use the NB parameterization where the mean is μ<sub><italic>gi</italic></sub>=<italic>M</italic><sub><italic>i</italic></sub><italic>p</italic><sub><italic>gj</italic></sub> and variance is μ<sub><italic>gi</italic></sub> (1+μ<sub><italic>gi</italic></sub>ϕ<sub><italic>g</italic></sub>). For differential expression analysis, the parameters of interest are <italic>p</italic><sub><italic>gj</italic></sub>.</p>
    <p>The NB distribution reduces to Poisson when ϕ<sub><italic>g</italic></sub>=0. In some DGE applications, technical variation can be treated as Poisson. In general, ϕ<sub><italic>g</italic></sub> represents the coefficient of variation of biological variation between the samples. In this way, our model is able to separate biological from technical variation.</p>
    <p><monospace>edgeR</monospace> estimates the genewise dispersions by conditional maximum likelihood, conditioning on the total count for that gene (Smyth and Verbyla, <xref ref-type="bibr" rid="B8">1996</xref>). An empirical Bayes procedure is used to shrink the dispersions towards a consensus value, effectively borrowing information between genes (Robinson and Smyth, <xref ref-type="bibr" rid="B5">2007</xref>). Finally, differential expression is assessed for each gene using an exact test analogous to Fisher's exact test, but adapted for overdispersed data (Robinson and Smyth, <xref ref-type="bibr" rid="B6">2008</xref>).</p>
  </sec>
  <sec id="SEC3">
    <title>3 FEATURES</title>
    <p>The required inputs for <monospace>edgeR</monospace> are the table of counts and two vectors annotating the samples: the vector of the library sizes (i.e. total number of reads) and a factor specifying the experimental group or condition for each sample.</p>
    <p>For users of <monospace>limma</monospace>, the <monospace>edgeR</monospace> package has a number of analogous functions. Once the data have been processed and the dispersion estimates are moderated, the <monospace>topTags</monospace> function can be used to tabulate the top differentially expressed genes (or tags or exons, etc.). Also, MA (log ratio versus abundance) plots can be created using the <monospace>plotSmear</monospace> function, allowing the same visualizations for DGE data as used for microarray data analysis (<xref ref-type="fig" rid="F1">Fig. 1</xref>).
<fig id="F1" position="float"><label>Fig. 1.</label><caption><p>DGE data can be visualized as ‘MA’ plots (log ratio versus abundance), just as with microarray data where each dot represents a gene. This plot shows RNA-seq gene expression for DHT-stimulated versus Control LNCaP cells, as described in Li <italic>et al.</italic> (<xref ref-type="bibr" rid="B3">2008</xref>). The smear of points on the left side signifies that genes were observed in only one group of replicate samples and the points marked ‘×’ denote the top 500 differentially expressed genes.</p></caption><graphic xlink:href="btp616f1"/></fig>
</p>
    <p>A number of features have been added to the <monospace>edgeR</monospace> package since the initial publications. The initial methodology worked only for a two-group comparison. The extension to estimating and moderating the dispersion for multiple groups is straightforward and has been implemented recently. At present, testing for differential expression is supported only for pairwise comparisons; the user must specify which two groups to compare. We are currently investigating tests for more general cases.</p>
    <p>Many of the early RNA-seq datasets involve sequence reads from technical replicates (e.g. same source of RNA) as opposed to biological replicates (e.g. RNA from different individuals). Technical replicates will generally have lower variability than biological replicates and in our experience, the dispersion parameter (and the moderation procedure in <monospace>edgeR</monospace>) may not be necessary. For experiments with technical replicates, the data may be fitted well by the Poisson distribution, as demonstrated in Marioni <italic>et al.</italic> (<xref ref-type="bibr" rid="B4">2008</xref>). Since the Poisson distribution is a special case of the NB distribution (ϕ=0), <monospace>edgeR</monospace> can perform a Poisson-based analysis. The pairwise exact testing procedure will still be useful for these datasets.</p>
  </sec>
  <sec sec-type="discussion" id="SEC4">
    <title>4 DISCUSSION</title>
    <p>We have developed a Bioconductor package <monospace>edgeR</monospace> that addresses one of the fundamental downstream data analysis tasks for count-based expression data: determining differential expression. The package and methods are general, and can work on other sources of count data, such as barcoding experiments and peptide counts. To the authors' knowledge, <monospace>edgeR</monospace> is the only software for SAGE or DGE data at this time which can account for biological variability when there are only one or two replicate samples.</p>
    <p><italic>Funding</italic>: National Health and Medical Research Council Program (Grant 406657 to G.K.S.); NHMRC, Independent Research Institutes Infrastructure Support Scheme (Grant 361646); Victorian State Government OIS grant (awarded to the WEHI); a Melbourne International Research Scholarship (to M.D.R.); Belz, Harris and IBS Honours scholarships (to D.J.M.).</p>
    <p><italic>Conflict of Interest</italic>: none declared.</p>
  </sec>
</body>
<back>
  <ref-list>
    <title>REFERENCES</title>
    <ref id="B1">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Andersson</surname>
            <given-names>AF</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Comparative analysis of human gut microbiota by barcoded pyrosequencing</article-title>
        <source>PLoS ONE</source>
        <year>2008</year>
        <volume>3</volume>
        <fpage>e2836</fpage>
        <pub-id pub-id-type="pmid">18665274</pub-id>
      </element-citation>
    </ref>
    <ref id="B2">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Gentleman</surname>
            <given-names>RC</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Bioconductor: open software development for computational biology and bioinformatics</article-title>
        <source>Genome Biol.</source>
        <year>2004</year>
        <volume>5</volume>
        <fpage>R80</fpage>
        <pub-id pub-id-type="pmid">15461798</pub-id>
      </element-citation>
    </ref>
    <ref id="B3">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Li</surname>
            <given-names>H</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Determination of tag density required for digital transcriptome analysis: application to an androgen-sensitive prostate cancer model</article-title>
        <source>Proc. Natl Acad. Sci. USA</source>
        <year>2008</year>
        <volume>105</volume>
        <fpage>20179</fpage>
        <lpage>20184</lpage>
        <pub-id pub-id-type="pmid">19088194</pub-id>
      </element-citation>
    </ref>
    <ref id="B4">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Marioni</surname>
            <given-names>JC</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>RNA-seq: an assessment of technical reproducibility and comparison with gene expression arrays</article-title>
        <source>Genome Res.</source>
        <year>2008</year>
        <volume>18</volume>
        <fpage>1509</fpage>
        <lpage>1517</lpage>
        <pub-id pub-id-type="pmid">18550803</pub-id>
      </element-citation>
    </ref>
    <ref id="B5">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Robinson</surname>
            <given-names>MD</given-names>
          </name>
          <name>
            <surname>Smyth</surname>
            <given-names>GK</given-names>
          </name>
        </person-group>
        <article-title>Moderated statistical tests for assessing differences in tag abundance</article-title>
        <source>Bioinformatics</source>
        <year>2007</year>
        <volume>23</volume>
        <fpage>2881</fpage>
        <lpage>2887</lpage>
        <pub-id pub-id-type="pmid">17881408</pub-id>
      </element-citation>
    </ref>
    <ref id="B6">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Robinson</surname>
            <given-names>MD</given-names>
          </name>
          <name>
            <surname>Smyth</surname>
            <given-names>GK</given-names>
          </name>
        </person-group>
        <article-title>Small sample estimation of negative binomial dispersion, with applications to SAGE data</article-title>
        <source>Biostatistics</source>
        <year>2008</year>
        <volume>9</volume>
        <fpage>321</fpage>
        <lpage>332</lpage>
        <pub-id pub-id-type="pmid">17728317</pub-id>
      </element-citation>
    </ref>
    <ref id="B7">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Smyth</surname>
            <given-names>GK</given-names>
          </name>
        </person-group>
        <article-title>Linear models and empirical Bayes methods for assessing differential expression in microarray experiments</article-title>
        <source>Stat. Appl. Genet. Mol. Biol.</source>
        <year>2004</year>
        <volume>1</volume>
        <comment>Art 3</comment>
      </element-citation>
    </ref>
    <ref id="B8">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Smyth</surname>
            <given-names>GK</given-names>
          </name>
          <name>
            <surname>Verbyla</surname>
            <given-names>AP</given-names>
          </name>
        </person-group>
        <article-title>A conditional approach to residual maximum likelihood estimation in generalized linear models</article-title>
        <source>J. R. Stat. Soc. B</source>
        <year>1996</year>
        <volume>58</volume>
        <fpage>565</fpage>
        <lpage>572</lpage>
      </element-citation>
    </ref>
    <ref id="B9">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wong</surname>
            <given-names>JWH</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Computational methods for the comparative quantification of proteins in label-free LCn-MS experiments</article-title>
        <source>Brief. Bioinform.</source>
        <year>2008</year>
        <volume>9</volume>
        <fpage>156</fpage>
        <lpage>165</lpage>
        <pub-id pub-id-type="pmid">17905794</pub-id>
      </element-citation>
    </ref>
  </ref-list>
</back>
