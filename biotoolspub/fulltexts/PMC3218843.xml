<?DTDIdentifier.IdentifierValue article.dtd?>
<?DTDIdentifier.IdentifierType system?>
<?SourceDTD.DTDName article.dtd?>
<?SourceDTD.Version 1.0?>
<?ConverterInfo.XSLTName bmc2nlmx2.xsl?>
<?ConverterInfo.Version 2?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Genome Biol</journal-id>
    <journal-id journal-id-type="iso-abbrev">Genome Biol</journal-id>
    <journal-title-group>
      <journal-title>Genome Biology</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1465-6906</issn>
    <issn pub-type="epub">1465-6914</issn>
    <publisher>
      <publisher-name>BioMed Central</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">3218843</article-id>
    <article-id pub-id-type="publisher-id">gb-2011-12-6-r55</article-id>
    <article-id pub-id-type="pmid">21689413</article-id>
    <article-id pub-id-type="doi">10.1186/gb-2011-12-6-r55</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Method</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Sniper: improved SNP discovery by multiply mapping deep sequenced reads</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author" id="A1">
        <name>
          <surname>Simola</surname>
          <given-names>Daniel F</given-names>
        </name>
        <xref ref-type="aff" rid="I1">1</xref>
        <xref ref-type="aff" rid="I2">2</xref>
        <email>simola@mail.med.upenn.edu</email>
      </contrib>
      <contrib contrib-type="author" corresp="yes" id="A2">
        <name>
          <surname>Kim</surname>
          <given-names>Junhyong</given-names>
        </name>
        <xref ref-type="aff" rid="I1">1</xref>
        <xref ref-type="aff" rid="I3">3</xref>
        <email>junhyong@sas.upenn.edu</email>
      </contrib>
    </contrib-group>
    <aff id="I1"><label>1</label>Department of Biology, University of Pennsylvania, 433 S. University Ave, Philadelphia, PA 19104, USA</aff>
    <aff id="I2"><label>2</label>Department of Cell and Developmental Biology, University of Pennsylvania, 421 Curie Blvd, Philadelphia, PA 19104, USA</aff>
    <aff id="I3"><label>3</label>Penn Genome Frontiers Institute, University of Pennsylvania, 433 S. University Ave, Philadelphia, PA 19104, USA</aff>
    <pub-date pub-type="ppub">
      <year>2011</year>
    </pub-date>
    <pub-date pub-type="epub">
      <day>20</day>
      <month>6</month>
      <year>2011</year>
    </pub-date>
    <volume>12</volume>
    <issue>6</issue>
    <fpage>R55</fpage>
    <lpage>R55</lpage>
    <history>
      <date date-type="received">
        <day>26</day>
        <month>1</month>
        <year>2011</year>
      </date>
      <date date-type="rev-recd">
        <day>22</day>
        <month>4</month>
        <year>2011</year>
      </date>
      <date date-type="accepted">
        <day>20</day>
        <month>6</month>
        <year>2011</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>Copyright ©2011 Simola and Kim; licensee BioMed Central Ltd</copyright-statement>
      <copyright-year>2011</copyright-year>
      <copyright-holder>Simola and Kim; licensee BioMed Central Ltd</copyright-holder>
      <license license-type="open-access" xlink:href="http://creativecommons.org/licenses/by/2.0">
        <license-p>This is an open access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/2.0">http://creativecommons.org/licenses/by/2.0</ext-link>), which permits unrestricted use, distribution, and reproduction in any medium, provided the original work is properly cited</license-p>
      </license>
    </permissions>
    <self-uri xlink:href="http://genomebiology.com/2011/12/6/R55"/>
    <abstract>
      <p>SNP (single nucleotide polymorphism) discovery using next-generation sequencing data remains difficult primarily because of redundant genomic regions, such as interspersed repetitive elements and paralogous genes, present in all eukaryotic genomes. To address this problem, we developed Sniper, a novel multi-locus Bayesian probabilistic model and a computationally efficient algorithm that explicitly incorporates sequence reads that map to multiple genomic loci. Our model fully accounts for sequencing error, template bias, and multi-locus SNP combinations, maintaining high sensitivity and specificity under a broad range of conditions. An implementation of Sniper is freely available at <ext-link ext-link-type="uri" xlink:href="http://kim.bio.upenn.edu/software/sniper.shtml">http://kim.bio.upenn.edu/software/sniper.shtml</ext-link>.</p>
    </abstract>
  </article-meta>
</front>
<body>
  <sec>
    <title>Background</title>
    <p>The advent of next-generation, short-read sequencing (NGS) technologies has enabled large-scale, whole-genome resequencing studies that aim to discover novel SNPs and other population genetic variations. Perhaps the most ambitious of these studies involves sequencing over 1,000 individual human genomes in order to map human genetic variation at a fine scale and to support genome-wide phenotypic and disease association studies [<xref ref-type="bibr" rid="B1">1</xref>]. Previous genome resequencing efforts have developed a variety of approaches to identify SNPs, including straightforward decision rules such as minimum coverage and quality cutoffs along with filters that mask reads aligning to repetitive genomic templates [<xref ref-type="bibr" rid="B2">2</xref>]; Bayesian algorithms that explicitly model sequencing chemistry and take full advantage of read-specific quality scores [<xref ref-type="bibr" rid="B3">3</xref>,<xref ref-type="bibr" rid="B4">4</xref>]; unsupervised [<xref ref-type="bibr" rid="B5">5</xref>] and supervised [<xref ref-type="bibr" rid="B6">6</xref>,<xref ref-type="bibr" rid="B7">7</xref>] machine-learning algorithms trained to distinguish sequencing errors from SNPs; and an alignment method that performs read mapping using all four nucleotide probabilities per-locus instead of the most probable call [<xref ref-type="bibr" rid="B8">8</xref>]. Although these tools have successfully predicted many novel SNPs, genomes themselves contain inherent degeneracy due to redundant paralogous sequences and low complexity repetitive elements, while NGS data exhibit non-negligible sequencing errors and severe biases in sequencing coverage generated during genomic DNA library preparation [<xref ref-type="bibr" rid="B9">9</xref>]. These practical issues make it difficult, even with sophisticated procedures, to discover true SNPs accurately without concurrently predicting many false SNPs. A recent study evaluated the performance of three NGS technologies (Illumina, ABI Solid, 454) using near-saturating sequence coverage (approximately 188×) over the same genomic sequence, reporting false positive and false negative SNP discovery rates of 3 to 12% and 1 to 8%, respectively [<xref ref-type="bibr" rid="B9">9</xref>]. While these error rates may seem manageable, they were estimated using SNPs occurring in high complexity (that is, unique) regions of the human genome and fail to account for errors resulting from repetitive or degenerate genomic sequence. Our investigations reported below suggest that the standard methods of SNP discovery will have much higher error rates when accounting for degenerate sequence. Furthermore, even moderate error rates can severely affect the use of SNPs in genome-wide association studies. As a simple example, suppose we have a genome-wide association study with 1,000 cases and 1,000 controls, a SNP segregating at 5% frequency, and a simple contrast of homozygous reference genotype versus heterozygous SNP genotype. Genome-wide significance can be obtained if the case:control SNP frequency ratio is approximately 3:1. With a 8% false negative rate and a 12% false positive rate, we need approximately 40% larger sample size for both cases and controls to obtain the same genome-wide significance.</p>
    <p>Although weaknesses associated with current sequencing technologies <italic>per se </italic>may be mitigated by future improvements that yield sufficiently longer reads or improved genomic coverage or sequencing error rate, the genome sequences of most organisms contain inherent redundancies that will nevertheless impede variant detection. A variety of sequence elements are repeated with high similarity and occur at various length scales, including simple sequence repeats (&lt; 0.1 kb) [<xref ref-type="bibr" rid="B10">10</xref>], Alus (0.3 kb), DNA transposons (1 to 2 kb), non-long terminal repeat (4 to 6 kb) and long terminal repeat (&lt; 10 kb) transposons [<xref ref-type="bibr" rid="B11">11</xref>], duplicated protein domains (&lt; 0.5 kb) [<xref ref-type="bibr" rid="B12">12</xref>], and paralogous and duplicated open reading frames (&gt; 1 kb) [<xref ref-type="bibr" rid="B13">13</xref>]. In particular, many repetitive elements remain actively mobile within the human genome, contribute to human genomic diversity [<xref ref-type="bibr" rid="B14">14</xref>,<xref ref-type="bibr" rid="B15">15</xref>], and have been implicated in various human diseases [<xref ref-type="bibr" rid="B16">16</xref>]. Therefore, SNP discovery in redundant sequence contexts - beyond just a proof of principle - is relevant for genome-wide association studies. Detecting true SNPs in these degenerate sequence contexts is difficult because an individual sequence read can show significant alignment to multiple genomic locations, making it difficult to distinguish between a SNP and a base-call error (Figure <xref ref-type="fig" rid="F1">1a</xref>). Although a SNP occurring within a repetitive sequence may be identified from overlapping reads that are anchored by unique flanking template, accurate mapping may be impossible if the length of the repetitive sequence is greater than the length of the read. For this reason previous SNP identification methods have utilized only the subset of sequenced reads that can be mapped uniquely to a reference genome [<xref ref-type="bibr" rid="B1">1</xref>,<xref ref-type="bibr" rid="B3">3</xref>-<xref ref-type="bibr" rid="B5">5</xref>]. A standard, quality-blind definition of uniqueness allows few sequence mismatches between a read and its potential genomic template (typically ≤3 mismatches, but the exact cutoff is a function of expected heterozygosity and sequencing error), discarding a read that has more than one such alignment (Figure <xref ref-type="fig" rid="F1">1b</xref>). Thus, focusing solely on uniquely mapped reads commonly results in discarding a significant percentage of otherwise mappable reads. Discarding reads especially disproportionately affects low complexity regions such as centromeric or telomeric regions, which end up with much lower coverage than expected from the average coverage. Consequently, SNPs occurring in redundant sequence contexts may be missed.</p>
    <fig id="F1" position="float">
      <label>Figure 1</label>
      <caption>
        <p><bold>Multi-locus model for SNP discovery using multiply mapped reads</bold>. <bold>(a) </bold>Distinct SNPs occurring in paralogous genomic regions are largely undetectable using either unique or best-guess read mapping because sequence reads containing a SNP can map to multiple paralogous loci with equal confidence. The figure shows an example with three paralogous loci and possible combinations for the multi-locus genome for up to one SNP in the exact paralogous loci (cases labeled 'No SNP' and '1 SNP'). Sequences in positions other than the exact paralogous loci may have other variations (shown as gray bars). Higher order configurations are possible, as shown in the bottom '2 SNP' case. However, such configurations can only arise through exact parallel mutation or segregating SNPs prior to genomic duplication. <bold>(b) </bold>Overview of read mapping strategies employed in this study. Quality-blind means that per-base quality estimates (probability that a base call is correct) are not considered during the mapping process.</p>
      </caption>
      <graphic xlink:href="gb-2011-12-6-r55-1"/>
    </fig>
    <p>In our results below, we first investigate the effect of redundant sequences on unique read coverage based on current NGS parameters. Exclusive use of uniquely mapped reads can significantly reduce information for SNP discovery (increasing the chance of false negative or incorrectly genotyped SNPs) and can, in some cases, create spurious map locations (increasing the chance of false positive SNPs). We then propose a novel SNP discovery algorithm that uses information from all mappable reads, including non-unique (multiply mapped) reads. Our method significantly improves the false SNP discovery error rate while maximizing prediction accuracy by utilizing a complete read map that includes both singly mapped and multiply mapped reads together with a Bayesian probabilistic model that explicitly accounts for multi-locus variation arising from multiply mapped reads. We describe this model below and provide a computationally efficient algorithm that prevents an explosion in the size of a read map via an approximation strategy. We validated our algorithm's performance on an ABI Sanger verified portion of the human genome using Illumina 1G sequencing data; on a simulation test suite derived from concatenations of yeast ribosomal protein loci; and on a single high-coverage (trio) individual from the 1000 Genomes Project.</p>
  </sec>
  <sec>
    <title>Results</title>
    <sec>
      <title>Redundancy structure of the human genome</title>
      <p>To evaluate the extent to which genomic sequence redundancy affects read mapping, we first analyzed the redundancy structure of the human genome by randomly sampling paired-end (PE) reads from the reference sequence and estimating the fraction of reads exhibiting only one versus multiple valid alignments (read multiplicity), using chromosome 1 as a representative sample. We defined a read to be unique if it aligns to exactly one location in the genome allowing at most <italic>k </italic>mismatches. We simulated 16 sequencing experiments by generating independent sets of 25 × 10<sup>6 </sup>PE reads without addition of base-call errors or sequence divergence (that is, perfect resequencing); read sets were simulated for four read lengths (30, 60, 90, and 120 nucleotides) and four template (fragment) lengths (means of 250, 500, 750, and 1,000 nucleotides), yielding 0.47, 0.94, 1.41, and 1.88-fold coverage genome-wide, respectively. Assuming a constant base-call sequencing error rate across the length of a read, we set the number of allowable mismatches to be proportional to read length, starting with a 1-mismatch cutoff for 30-mer reads and ending with a 3-mismatch cutoff for 120-mer reads. (Reads of 60 and 90 nucleotides are aligned with 2 and 3 mismatches, respectively.) Following PE alignment, we also aligned unmapped reads as single-end (SE) reads, resulting in a conservative estimate of uniqueness. From 15 to 55% of nucleotide loci on chromosome 1 (average 37.4%) are covered uniquely in any experiment, with longer read lengths yielding greater coverage, as expected (Figure <xref ref-type="fig" rid="F2">2a</xref>). This relatively low coverage suggests that a large portion of the human genome is composed of low complexity sequences that are highly degenerate by edit distance. Interestingly, template length appears to have negligible effect on unique coverage, suggesting that the distribution of redundant sequence elements extends across a range of length scales (see Text S1 in Additional file <xref ref-type="supplementary-material" rid="S1">1</xref>). Since we sampled PE reads without error, all of the remaining non-unique reads must also map to the genome, although via multiple alignments (Additional file <xref ref-type="supplementary-material" rid="S2">2</xref>). Thus, in the context of whole-genome sequencing, uniquely mapped reads show an inherently limited ability to cover the human genome (see also [<xref ref-type="bibr" rid="B1">1</xref>,<xref ref-type="bibr" rid="B17">17</xref>]). By mapping non-unique reads together with unique reads - retaining only those reads with at most 50 alignments (6.5% of the remaining 17.5% of reads on average) - 17 to 37% of the resulting read map (average 24.5%) correspond to non-unique reads. Including these redundant alignments yields a moderate 3.5 to 8.3% (average 4.8%) increase in the number of covered genomic loci and a substantial 26.4 to 45.3% (average 38%) increase in read depth per locus compared to the unique read map (Additional file <xref ref-type="supplementary-material" rid="S3">3</xref>). This suggests that while the majority of loci are covered by at least one unique subsequence, using unique reads only may bias genotyping over even mildly degenerate loci. Thus, significant improvement in both number of loci covered by at least one read and read depth per locus can be achieved by including just a portion of the entire non-unique read map.</p>
      <fig id="F2" position="float">
        <label>Figure 2</label>
        <caption>
          <p><bold>Redundancy structure analysis of the human genome</bold>. <bold>(a) </bold>We generated 2 × 10<sup>6 </sup>PE reads randomly and with perfect fidelity (error rate e = 0; divergence p = 0) from the NCBI <italic>Homo sapiens</italic>genome. Read sets were generated for four different fragment lengths (250, 500, 750, and 1,000 nucleotides) and four different sequencing read lengths (30, 60, 90, and 120 nucleotides) and mapped to their respective genome using Bowtie, allowing 1, 2, 3, or 3 alignment mismatches depending on read length. Heat map cells represent the percent of sampled reads having more than one valid alignment, averaged over the total number of reads for that data set. The distributions of the number of alignments per read are shown in Additional file 2. <bold>(b) </bold>Six experimental and four simulated read sets containing both base-call sequencing errors (e ≈ 0.001) and population sequence divergence (p ≈ 0.001) were mapped to the reference human genome. The percent of non-unique alignments is shown for each read set. Percent of loci covered by at least one unique alignment was computed after pooling all experimental or simulated read maps. Nt, nucleotide.</p>
        </caption>
        <graphic xlink:href="gb-2011-12-6-r55-2"/>
      </fig>
      <p>Our estimates of the impact of non-unique reads are likely conservative: the above results do not account for population-level divergence, nor do they explicitly account for base-call errors. To evaluate the extent of non-unique mapping in the presence of sequencing error and genomic divergence, we mapped 250 × 10<sup>6 </sup>PE reads taken from the 1000 Genomes Project as well as 181 × 10<sup>6 </sup>PE reads sampled from the reference human genome at different read and template lengths; this corresponds to 7.5-fold and 4.7-fold expected genome-wide coverage for experimental and simulated read sets, respectively. For simulated reads we randomly introduced base-call sequencing errors uniformly using a 0.1% error rate. We mapped reads to the reference genome allowing up to 2 mismatches and 200 valid alignments per read. Under these conditions, a substantial percentage of alignments correspond to non-unique reads for all read maps, averaging 50% for simulated and 72% for experimental maps (Figure <xref ref-type="fig" rid="F2">2b</xref>). Pooling all experimental or simulated reads, the percentage of the human genome covered solely by unique reads is 29.91% and 84.27%, respectively (30.03% and 74.23% for chromosome 1). Thus, we estimate that approximately 15% of the human genome cannot be covered by unique reads alone using current NGS parameters (similar to estimates reported in [<xref ref-type="bibr" rid="B1">1</xref>]). As expected, endogenous repetitive elements, including functionally relevant elements, are important determinants of this redundant portion of the human genome (Text S1 in Additional file <xref ref-type="supplementary-material" rid="S1">1</xref>). We note that the discrepancy between Figures <xref ref-type="fig" rid="F2">2a</xref> and <xref ref-type="fig" rid="F2">2b</xref> for simulated maps (approximately 55% versus approximately 74%) is explained first by the lower coverage in Figure <xref ref-type="fig" rid="F2">2a</xref> and second by the difference in mismatches (three versus two, respectively); there is a negative correlation between mismatches and unique coverage, so using two mismatches should yield more mapped reads than three mismatches (in the presence of sequencing error). The estimates of unique mapping in Figure <xref ref-type="fig" rid="F2">2b</xref> thus may be conservative for very long reads where 3' ends show a rapidly increasing base-call error rate. In addition, experimental data map 36% fewer unique reads than synthetic reads, indicating the presence of more extensive genomic differences or elevated error rates among experimental NGS data sets. While our estimate of the redundant portion of the human genome is based on PE reads, many existing data sets utilize SE reads with shorter read lengths; these data can yield severely reduced unique mapping. For example, in our 1000 Genomes analysis above, 48.2% of the uniquely mapped reads only map as singletons rather than PE reads. Also, analysis of a <italic>Saccharomyces cerevisiae </italic>genome sequenced using 36-nucleotide Illumina 1G PE reads revealed that 52.0 to 65.5% of reads map non-uniquely when treated as singletons compared to 8.2 to 9.3% when treated as paired (depending on mismatches; data not shown). Thus, when considering NGS data sets containing genomic changes, using a unique read map impedes discovery of novel polymorphisms for a significant portion of any genome, while non-unique alignments become increasingly prevalent.</p>
    </sec>
    <sec>
      <title>Extent of spurious alignments due to mapping strategy</title>
      <p>Given the prevalence of singleton mapping among PE data sets (as described above), we wondered whether SE reads show reduced coverage over SNP loci in particular, and whether they tend to be mapped to the wrong genomic location. For example, a read could be mapped incorrectly if it corresponds to a region that is redundant and by chance shows more similarity to an incorrect paralogous region. Such spurious read mapping may occur if the sequenced read has either base-call errors or true polymorphisms (Additional file <xref ref-type="supplementary-material" rid="S4">4</xref>). While this scenario applies to unique mapping as described above, it may be of particular relevance when employing a greedy approximation strategy to utilize additional reads that are not strictly unique (for example, the 'best' strategies in Figure <xref ref-type="fig" rid="F1">1b</xref>). With these approximations, although multiple valid alignments may exist for a read, the one containing the fewest mismatches is selected as the correct alignment.</p>
      <p>We evaluated the occurrence of discarded and spuriously mapped reads in the presence of true genomic divergence by considering four scenarios: (1) error-free sequencing and unique mapping; (2) error-free sequencing and best-guess mapping; (3) error-prone sequencing and unique mapping; (4) error-prone sequencing and best-guess mapping. Note that the error-free scenarios are equivalent to error-prone scenarios without sequence divergence, which could affect confidence in a SNP call at a false locus. Also, we did not evaluate the best no-guess strategy here since it essentially behaves like the unique strategy when error and divergence rates are low, as in the following analysis. Using human chromosome 1 as a reference, we randomly introduced 1% polymorphic divergence and extracted all read strings that overlap every SNP locus, for 30, 60, 90, and 120-nucleotide read lengths. For error-prone scenarios we randomly introduced 1% base-call errors uniformly over read strings. In this manner we generated five independent replicate read sets for each read length. We then aligned these read strings back to the entire human genome allowing two mismatches and counted the average number of reads that map (1) uniquely to the corresponding SNP locus, (2) to the SNP locus with fewest mismatches (best-guess), (3) somewhere else in the genome. Overall, we found negligible false alignments with the unique map, with or without sequencing error (Table <xref ref-type="table" rid="T1">1</xref>). However, the best-guess map yielded 12.1% false alignments for error-free reads and 13.0% false alignments for error-prone reads with 30-nucleotide reads; longer reads showed up to 3.5% false mapping. This suggests that the potential for false mapping is largely restricted to 'best' strategies and shorter read lengths, whereas unique mapping almost always yields correct alignments (at least over true SNP loci). Thus, spurious mapping becomes most relevant when short, SE reads are used extensively, such as for low-coverage 1000 Genomes Project data (as well as ChIP-seq and RNA-seq data).</p>
      <table-wrap id="T1" position="float">
        <label>Table 1</label>
        <caption>
          <p>Extent of spurious alignment due to unique or best-guess mapping strategies</p>
        </caption>
        <table frame="hsides" rules="groups">
          <thead>
            <tr>
              <th align="left">Condition</th>
              <th align="left">Read length</th>
              <th align="left">SNP reads</th>
              <th align="left">Total aligned</th>
              <th align="left">Discarded</th>
              <th align="left">Misaligned</th>
              <th align="left">Misaligned/Aligned</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td align="left">Best, no error</td>
              <td align="left">30</td>
              <td align="left">7,413,324</td>
              <td align="left">99.96%</td>
              <td align="left">0.04%</td>
              <td align="left">12.11%</td>
              <td align="left">12.11%</td>
            </tr>
            <tr>
              <td/>
              <td align="left">60</td>
              <td align="left">14,826,840</td>
              <td align="left">99.81%</td>
              <td align="left">0.19%</td>
              <td align="left">3.02%</td>
              <td align="left">3.02%</td>
            </tr>
            <tr>
              <td/>
              <td align="left">90</td>
              <td align="left">22,240,926</td>
              <td align="left">99.55%</td>
              <td align="left">0.45%</td>
              <td align="left">1.15%</td>
              <td align="left">1.15%</td>
            </tr>
            <tr>
              <td/>
              <td align="left">120</td>
              <td align="left">29,654,088</td>
              <td align="left">99.21%</td>
              <td align="left">0.79%</td>
              <td align="left">0.66%</td>
              <td align="left">0.67%</td>
            </tr>
            <tr>
              <td align="left">Uni, no error</td>
              <td align="left">30</td>
              <td align="left">7,413,324</td>
              <td align="left">74.94%</td>
              <td align="left">25.06%</td>
              <td align="left">0.00%</td>
              <td align="left">0.00%</td>
            </tr>
            <tr>
              <td/>
              <td align="left">60</td>
              <td align="left">14,826,840</td>
              <td align="left">89.20%</td>
              <td align="left">10.80%</td>
              <td align="left">0.00%</td>
              <td align="left">0.00%</td>
            </tr>
            <tr>
              <td/>
              <td align="left">90</td>
              <td align="left">22,240,836</td>
              <td align="left">93.74%</td>
              <td align="left">6.26%</td>
              <td align="left">0.00%</td>
              <td align="left">0.00%</td>
            </tr>
            <tr>
              <td/>
              <td align="left">120</td>
              <td align="left">29,654,088</td>
              <td align="left">94.98%</td>
              <td align="left">5.02%</td>
              <td align="left">0.00%</td>
              <td align="left">0.00%</td>
            </tr>
            <tr>
              <td align="left">Best, 1% error</td>
              <td align="left">30</td>
              <td align="left">4,388,175</td>
              <td align="left">96.40%</td>
              <td align="left">3.60%</td>
              <td align="left">12.53%</td>
              <td align="left">13.00%</td>
            </tr>
            <tr>
              <td/>
              <td align="left">60</td>
              <td align="left">2,771,304</td>
              <td align="left">86.33%</td>
              <td align="left">13.67%</td>
              <td align="left">2.99%</td>
              <td align="left">3.46%</td>
            </tr>
            <tr>
              <td/>
              <td align="left">90</td>
              <td align="left">2,252,588</td>
              <td align="left">74.20%</td>
              <td align="left">20.62%</td>
              <td align="left">1.02%</td>
              <td align="left">1.38%</td>
            </tr>
            <tr>
              <td/>
              <td align="left">120</td>
              <td align="left">2,132,976</td>
              <td align="left">62.14%</td>
              <td align="left">37.86%</td>
              <td align="left">0.51%</td>
              <td align="left">0.82%</td>
            </tr>
            <tr>
              <td align="left">Uni, 1% error</td>
              <td align="left">30</td>
              <td align="left">4,388,175</td>
              <td align="left">72.98%</td>
              <td align="left">27.02%</td>
              <td align="left">0.07%</td>
              <td align="left">0.09%</td>
            </tr>
            <tr>
              <td/>
              <td align="left">60</td>
              <td align="left">2,771,304</td>
              <td align="left">78.01%</td>
              <td align="left">21.99%</td>
              <td align="left">0.06%</td>
              <td align="left">0.08%</td>
            </tr>
            <tr>
              <td/>
              <td align="left">90</td>
              <td align="left">2,252,588</td>
              <td align="left">70.34%</td>
              <td align="left">29.66%</td>
              <td align="left">0.03%</td>
              <td align="left">0.05%</td>
            </tr>
            <tr>
              <td/>
              <td align="left">120</td>
              <td align="left">2,132,976</td>
              <td align="left">59.82%</td>
              <td align="left">40.18%</td>
              <td align="left">0.02%</td>
              <td align="left">0.03%</td>
            </tr>
          </tbody>
        </table>
        <table-wrap-foot>
          <p>Mapping of reads that overlap synthetic SNPs on human chromosome 1 was performed allowing up to <italic>k </italic>= 2 mismatches per read under four mapping conditions (best-guess without base-call error; best-guess with 1% base-call error; unique without error; unique with 1% base-call error) and four read lengths (30, 60, 90, and 120 nucleotides). Total mapped SNP reads and percentages of aligned, discarded, misaligned, and the ratio of misaligned to aligned reads are shown for each experiment. A read is considered misaligned if it does not overlap the SNP locus used to generate the read. See Figure 1b for a description of mapping strategies.</p>
        </table-wrap-foot>
      </table-wrap>
      <p>We also counted reads that overlap a SNP locus and are discarded because no valid map location could be identified (because these reads would have more than <italic>k </italic>bases that differ from any location in the reference genome). This is an important consideration for many recent long read NGS data sets, since longer reads tend to have more base-call errors than short reads. For example, for a 1% base-call error rate, one mismatch mapping, and no sequence divergence, this is expected to occur for approximately 3.6% of 30-nucleotide reads, 12.1% of 60-nucleotide reads, 22.7% of 90-nucleotide reads, and 33.8% of 120-nucleotide reads. Using our SNP-derived read sets and two mismatches, we found that 5 to 25% of error-free and 22 to 40% of error-prone reads are discarded for unique mapping, and 0 to 1% of error-free and 4 to 38% of error-prone reads are discarded for best-guess mapping. Using only one mismatch exacerbates read loss: 3 to 21% of error-free and 25 to 74% of error-prone reads that overlap SNP loci are discarded (Additional file <xref ref-type="supplementary-material" rid="S5">5</xref>).</p>
      <p>Thus, when using mapping conditions that are currently standard for SNP discovery in the human genome (strictly or approximately unique mapping using two mismatches), we find that a significant number of reads that overlap true SNP loci are discarded during mapping - regardless of sequencing errors and read length - because they have more differences than allowed compared to the reference genome. Moreover, false mapping appears to be a relevant concern for best-guess strategies; although the extent of false mapping decreases substantially for longer reads, just a few spurious alignments may be sufficient to add significant bias to SNP calls (as implied by our results below). Alternatively, a multiple read mapping strategy will recover many of the reads discarded by strictly unique mapping while avoiding the possibility of spurious alignment. (While reads discarded by best-guess mapping cannot be recovered, this strategy may tolerate more mismatches.) Based on these considerations, we developed a Bayesian model for SNP discovery that integrates the joint information from multiply mapped genomic locations for any given read.</p>
    </sec>
    <sec>
      <title>Overview of the Bayesian genotyping model</title>
      <p>A full probabilistic model for SNP discovery can be specified in a straightforward manner, but a model that incorporates the full joint probability of genotypes at all loci and all possible sequencing reads would be computationally prohibitive. Here, we employ three assumptions to manage this complexity: (1) the sequencing chemistry is sufficiently accurate that the probability of a given sequenced read being generated from a genomic template that is very different from the read string is negligible; (2) the resequenced genome is sufficiently similar to the reference genome such that the alignment of the read strings to the reference genome accurately delineates the possible genomic positions of the resequenced genome; and (3) that for any multiply mapped reads, at most only one of the possible mapped loci have sequence deviation from the reference genome at the exact same position within the sequenced read string. Assumptions 1 and 2 are standard to current short read mapping analyses that employ <italic>k</italic>-bounded approaches to map sequenced reads. We assume that the user chooses the bound <italic>k</italic>, based on prior ideas about the resequenced genome. (Note that all read map algorithms have such a bound as a user-selected parameter.) Assumption 3 restricts the joint combination of possible genomic variants in the resequenced genome. Figure <xref ref-type="fig" rid="F1">1a</xref> shows an example of three paralogous loci that may be the template for a given sequence read, where black bars show a possible SNP genotype of interest while gray bars show sequence variation around the loci. The multi-locus genomic genotypes for the SNP locus may be identical to the reference genome (labeled 'No SNP') or have a SNP in one of three possible paralogous loci (labeled '1 SNP'). Our model allows for all 'No SNP' or '1 SNP' multi-locus combinations. The bottom example in Figure <xref ref-type="fig" rid="F1">1a</xref> shows an example of a highly unlikely '2 SNP' combination. Identical SNPs in the same paralogous loci can only arise if there were exact parallel mutations or if a single SNP arose in an ancestral genome before the multiplication of the paralogous loci. Both of these events have very low probability: the probability of exact parallel mutations that segregate at appreciable frequency or the probability that a SNP in an ancestral genome that is different from the reference genome is segregating at both copies of descendent paralogs would both be close to zero.</p>
      <p>A detailed elaboration of the probability model is given in Text S2 in Additional file <xref ref-type="supplementary-material" rid="S1">1</xref>. Here we outline the main features of the model. We first define:<disp-formula id="bmcM1"><label>(1)</label><graphic xlink:href="gb-2011-12-6-r55-i1.gif"/></disp-formula></p>
      <p>as the probability of observing the read string <italic>r<sub>i </sub></italic>given that the particular genomic substring <italic>s </italic>of reference genome <italic>G </italic>served as the sequencing template; therefore, <italic>P</italic>(<italic>r<sub>i</sub>|s,G) </italic>is determined by the fidelity of the sequencing chemistry. This probability can be modeled based on known error rates of the sequencing platform or by the quality (phred) scores for individual sequenced nucleotides. The template string <italic>s </italic>may correspond to multiple locations in the genome with sufficient similarity to the read string. Thus, we model the probability:<disp-formula id="bmcM2"><label>(2)</label><graphic xlink:href="gb-2011-12-6-r55-i2.gif"/></disp-formula></p>
      <p>which is the probability that a particular substring <italic>s </italic>of genome <italic>G </italic>became the template for the read string <italic>r<sub>i</sub></italic>. This probability is determined by the process of template preparation and may be affected by biases of the library preparation chemistry. The probability models Equation 1 and Equation 2 can be put together to compute the probability:<disp-formula id="bmcM3"><label>(3)</label><graphic xlink:href="gb-2011-12-6-r55-i3.gif"/></disp-formula></p>
      <p>where <italic>d </italic>is the number of possible template strings for read <italic>r<sub>i</sub></italic>. Assuming independence of read strings <italic>r<sub>i </sub></italic>given the genome and applying the Bayesian formula yields:<disp-formula id="bmcM4"><label>(4)</label><graphic xlink:href="gb-2011-12-6-r55-i4.gif"/></disp-formula></p>
      <p>where <italic>G<sub>xy </sub></italic>denotes one possible genome with the genotype <italic>xy </italic>at a locus of interest, and where the denominator is a summation over all possible genotypes <italic>XY</italic>. The term <italic>P</italic>(<italic>G<sub>xy</sub></italic>) is the prior probability of the genome and can be modeled, for example, from the population-level expected heterozygosity. Finally, since many different genomic configurations (whole-genome sequences) can have the same genotype <italic>xy </italic>at any particular locus, the marginal probability of the genotype at <italic>xy </italic>at locus <italic>g<sub>l </sub></italic>is:<disp-formula id="bmcM5"><label>(5)</label><graphic xlink:href="gb-2011-12-6-r55-i5.gif"/></disp-formula></p>
      <p>where <italic>C</italic>(<italic>G<sub>xy</sub></italic>) denotes the possible configurations of the unknown genome <italic>G</italic>, fixing genotype <italic>xy </italic>at locus <italic>g<sub>l</sub></italic>.</p>
      <p>The possible configurations can be enumerated from assumptions about how different the sampled genome <italic>G </italic>is compared to the reference genome (Text S2 in Additional file <xref ref-type="supplementary-material" rid="S1">1</xref>). In practice, by assumptions 1 to 3 noted above, the possible genomic configurations are restricted to loci that are homologous to read strings (within <italic>k</italic>-bounded differences from the reference sequence) and having at most one SNP within the multiply mapped positions (as shown below and in Figure <xref ref-type="fig" rid="F1">1a</xref>).</p>
      <p>Finally, using our Bayesian scheme, we can set a threshold that defines the minimum posterior probability to accept a SNP as significantly different from the reference genome. This threshold can be interpreted as a stringency parameter reflecting minimum confidence in a set of genotypes.</p>
    </sec>
    <sec>
      <title>Model analysis</title>
      <p>The posterior probability of a given genotype is determined by the likelihood of the reads given the prior probability (the numerator of Equation 4), normalized by the total marginal probability of the reads (the denominator of Equation 4). The main component of the numerator determining the posterior probability is the likelihood of the reads. Taking Equation 3 above, the likelihood of any given read is decomposed into two terms (see also Equation 4 in Text S2 in Additional file <xref ref-type="supplementary-material" rid="S1">1</xref>):<disp-formula id="bmcM6"><label>(6)</label><graphic xlink:href="gb-2011-12-6-r55-i6.gif"/></disp-formula></p>
      <p>where <italic>p<sub>xy </sub></italic>are the terms whose probability is a function of the genotype <italic>g<sub>l </sub></italic>at the locus of interest and <italic>p<sub>bg </sub></italic>represent the 'background' probability of reads contributed from other genomic alignments. Suppose there is an equal probability that any of the <italic>k</italic>-bounded error regions of the genome might have acted as the template for the read string <italic>r<sub>i</sub></italic>. Then we have:<disp-formula id="bmcM7"><label>(7)</label><graphic xlink:href="gb-2011-12-6-r55-i7.gif"/></disp-formula></p>
      <p>Here, <italic>d </italic>is the number of alignments to other genomic loci. (Note that we use a slightly different accounting of the number of alignments than used in Text S2 in Additional file <xref ref-type="supplementary-material" rid="S1">1</xref> to avoid notational complexity from considering diploid states.) From Equation 7, it is immediate that if a read aligns to many genomic loci (<italic>d </italic>is large), then <italic>P</italic>(<italic>r<sub>i</sub>|G</italic>) goes to a constant regardless of the genotype <italic>g<sub>l</sub></italic>, and each genotype's posterior probability becomes equally probable. Therefore, as expected, if a locus of interest is covered by sequence reads with a large number of possible alignments to other genomic loci, we have no confidence in the genotype of the locus.</p>
      <p>The likelihood of the entire read set at a locus of interest is given by <inline-formula><inline-graphic xlink:href="gb-2011-12-6-r55-i8.gif"/></inline-formula>, the product of Equation 6 over the aligned reads. Suppose that we have a read depth of <italic>n</italic>, and assume that each of the reads aligns to <italic>d </italic>other genomic loci. For the purposes of analysis only, also assume that the likelihood of each read is an identical function of the genotype, denoted <italic>p<sub>xy</sub></italic>, regardless of the read itself. The odds ratio of the posterior probability of genotype <italic>xy </italic>versus <italic>x</italic>'<italic>y</italic>' is given as:<disp-formula id="bmcM8"><label>(8)</label><graphic xlink:href="gb-2011-12-6-r55-i9.gif"/></disp-formula></p>
      <p>where the last term is by Taylor expansion. The log-odds ratio is meaningful (that is, different from 1) if <italic>O</italic>(<italic>n|d</italic>) ≠ 0. Equation 8 intuitively shows that the log-odds ratio becomes different from even-odds in proportion to the read depth <italic>n </italic>and is inversely proportional to the number of alignments per read <italic>d</italic>. Equation 8 suggests that if the number of alignments at a given locus is much larger than the read depth, then we will not have meaningful information about the genotype, and thus such loci should be considered unknown. Consistent with this, we find a clear negative correlation between posterior probability and degeneracy (r = -0.98, <italic>P </italic>&lt; 10<sup>-6</sup>) when plotting the distribution of posterior probabilities for loci whose maximum <italic>a posteriori </italic>(MAP) genotype indicates a SNP, grouped by the ratio <italic>d/n </italic>(Additional file <xref ref-type="supplementary-material" rid="S6">6</xref>).</p>
      <p>Expected read depth of a sequencing run can be used as a cutoff for the maximum number of alignments considered at a given locus. This would greatly reduce the computational load for genotyping. In practice, alignment algorithms for next-generation sequencing produce read alignments up to a user-specified mismatch cutoff, denoted <italic>k</italic>. As the cutoff value <italic>k </italic>is increased, the read depth is expected to go up for any given locus as more of the sequencing reads are relevant to any given locus. However, the number of alignments <italic>d </italic>is also an increasing function of <italic>k</italic>. That is, we expect <inline-formula><inline-graphic xlink:href="gb-2011-12-6-r55-i10.gif"/></inline-formula>, where <italic>α </italic>and <italic>β </italic>are increasing functions of <italic>k</italic>. The exact behavior of <italic>α </italic>and <italic>β </italic>are genome-dependent. Therefore, one strategy would be to apply an alignment algorithm at various values of <italic>k </italic>and chose a resulting read map that maximizes the ratio of average read depth versus average number of alignments. Additional file <xref ref-type="supplementary-material" rid="S7">7</xref> shows this ratio for various alignment mismatch values of <italic>k </italic>and datasets used in this paper.</p>
    </sec>
    <sec>
      <title>Multiply mapped reads improve accuracy and false discovery rate</title>
      <p>To validate the performance of our method, called Sniper (SNP Identification using the Probability of Every Read), we estimated genotypes for 261 kb of the human genome for 4 individuals using 36-nucleotide Illumina 1G SE read data, previously described in Harsimendy <italic>et al</italic>. [<xref ref-type="bibr" rid="B9">9</xref>]. Notably, this public data set offers very high coverage (approximately 188×), and SNP calls for a large portion of these loci have also been generated by ABI Sanger sequencing, allowing direct estimation of true positive and false positive error rates. To assess how SNP calling differs by mapping strategy, we computed genotypes using unique (UNI), best-guess (BEST), and total max-<italic>d </italic>(ALL) read mapping strategies (Figure <xref ref-type="fig" rid="F1">1b</xref>). We also compared our method to Maq [<xref ref-type="bibr" rid="B4">4</xref>] and SOAPsnp [<xref ref-type="bibr" rid="B3">3</xref>], two alternative methods that generate SNP calls using either unique or best-guess strategies (Text S3 in Additional file <xref ref-type="supplementary-material" rid="S1">1</xref>). Sniper shows excellent, but comparable, performance across the majority of conditions tested, yielding a true positive rate (TPR) of 97.2% and a false discovery rate (FDR) of 0.0%, averaged across the four genotyped individuals and the nine mismatch and read map combinations tested (Additional file <xref ref-type="supplementary-material" rid="S8">8</xref>). However, we found that this region is very atypical of the human genome in general and in fact was especially chosen because of its lack of redundant sequence [<xref ref-type="bibr" rid="B9">9</xref>]. Comparison of read maps indicated minimal difference in the number of alignments within the 261-kb template region: averaging over <italic>k </italic>= 1 to 3, the ALL map includes only 0.87% more reads than BEST and 8.25% more reads than UNI (Additional file <xref ref-type="supplementary-material" rid="S9">9</xref>). Moreover, 78% of loci at <italic>k </italic>= 1 show at least 100-fold enrichment of singly to multiply mapped reads, while 87% show a 10-fold enrichment (Figure S4A in Additional file <xref ref-type="supplementary-material" rid="S7">7</xref>). Thus ALL, UNI, and BEST maps are essentially identical for the 261-kb template region, explaining similar performance across methods (Additional file <xref ref-type="supplementary-material" rid="S10">10</xref>). Therefore, we carried out an extensive suite of simulation tests to assess performance on genomes containing multiple paralogous loci (resulting in lower sequence complexity).</p>
      <p>We generated a panel of five homozygous diploid synthetic DNA templates that exhibit varying levels of sequence degeneracy (Table <xref ref-type="table" rid="T2">2</xref>). These templates were derived from an intrinsically redundant concatenation of 85 ribosomal protein sequences taken from the yeast genome; in fact, these loci are generally difficult to PCR amplify because of this redundancy [<xref ref-type="bibr" rid="B18">18</xref>]. We evaluated the performance of Sniper using ALL, UNI, and both BEST guess and BEST no-guess maps on unknown genomic configurations derived from each of these five templates, following the addition of 0.1% polymorphic variation (see Materials and methods). Briefly, we first generated a positive control template (ribosomal protein loci (RPL)) with 85% degeneracy and an average number of alignments per read of 1.88; however, less than 3% of reads are expected to have more than two alignments (Table <xref ref-type="table" rid="T2">2</xref>). A negative control (2 × RPL + 0%) consists of two identical copies of RPL, so in principle no SNPs should be identifiable by unique or best read mapping. Finally, three test templates were generated where 2%, 5%, or 10% sequence divergence was added to the second copy of RPL. These synthetic DNA templates represent genomes with two-fold paralogous degeneracy but with decreasing similarity of the paralogs. They have more than two alignments per read on average, 98.6%, 97.9%, and 86.8% degeneracy, and 29.9%, 6.8%, and 1.9% of reads with at least three valid alignments, respectively.</p>
      <table-wrap id="T2" position="float">
        <label>Table 2</label>
        <caption>
          <p>Data sets used in this study</p>
        </caption>
        <table frame="hsides" rules="groups">
          <thead>
            <tr>
              <th align="left">Region name</th>
              <th align="left">Type<sup>a</sup></th>
              <th align="left">Loci<sup>b</sup></th>
              <th align="left">Difficulty<sup>c</sup></th>
              <th align="left">% deg.<sup>d</sup></th>
              <th align="left">APR<sup>e</sup></th>
              <th align="left">% ≥ 3</th>
              <th align="left">% ≥ 5</th>
              <th align="left">% ≥ 10</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td align="left">Human 261 k</td>
              <td align="left">Exp.</td>
              <td align="left">261,475</td>
              <td align="left">Low</td>
              <td align="left">90.4</td>
              <td align="left">1.91</td>
              <td align="left">0.21</td>
              <td align="left">0.05</td>
              <td align="left">0.02</td>
            </tr>
            <tr>
              <td align="left">Yeast RPL</td>
              <td align="left">Sim.</td>
              <td align="left">94,678</td>
              <td align="left">Low</td>
              <td align="left">85.1</td>
              <td align="left">1.88</td>
              <td align="left">2.60</td>
              <td align="left">0.00</td>
              <td align="left">0.00</td>
            </tr>
            <tr>
              <td align="left">Yeast 2 × RPL +0%</td>
              <td align="left">Sim.</td>
              <td align="left">189,356</td>
              <td align="left">Extreme</td>
              <td align="left">97.1</td>
              <td align="left">3.01</td>
              <td align="left">96.90</td>
              <td align="left">3.20</td>
              <td align="left">0.00</td>
            </tr>
            <tr>
              <td align="left">Yeast 2 × RPL +2%</td>
              <td align="left">Sim.</td>
              <td align="left">189,356</td>
              <td align="left">High</td>
              <td align="left">98.6</td>
              <td align="left">2.18</td>
              <td align="left">29.90</td>
              <td align="left">0.52</td>
              <td align="left">0.00</td>
            </tr>
            <tr>
              <td align="left">Yeast 2 × RPL +5%</td>
              <td align="left">Sim.</td>
              <td align="left">189,356</td>
              <td align="left">Medium/high</td>
              <td align="left">97.9</td>
              <td align="left">2.05</td>
              <td align="left">6.83</td>
              <td align="left">0.06</td>
              <td align="left">0.00</td>
            </tr>
            <tr>
              <td align="left">Yeast 2 × RPL +10%</td>
              <td align="left">Sim.</td>
              <td align="left">189,356</td>
              <td align="left">Medium</td>
              <td align="left">86.8</td>
              <td align="left">2.01</td>
              <td align="left">1.86</td>
              <td align="left">0.57</td>
              <td align="left">0.00</td>
            </tr>
          </tbody>
        </table>
        <table-wrap-foot>
          <p>Genomic templates used in this study: Human 261 k [<xref ref-type="bibr" rid="B9">9</xref>]; synthetic concatenation of yeast ribosomal proteins (RPL); perfect tandem duplication of RPL (2 × RPL +0%); tandem duplication of RPL adding 2% sequence divergence to the second copy (2 × RPL +2%); tandem duplication of RPL adding 5% sequence divergence to the second copy (2 × RPL +5%); tandem duplication of RPL adding 10% sequence divergence to the second copy (2 × RPL +10%). See main text for more details. <sup>a</sup>Whether the sequenced reads were obtained experimentally (Exp.) or by simulation (Sim.). <sup>b</sup>Indicates the number of positions genotyped. <sup>c</sup>Determined in the following manner: 100,000 36-nucleotide PE reads were sampled randomly from the template region with perfect fidelity. Sampled reads were aligned to the template with <italic>k </italic>= 3 mismatches. <sup>d</sup>Percentage of sampled reads with more than one alignment (percentage degeneracy). <sup>e</sup>Average number of alignments for each sampled read across all reads (alignments per read). The last three columns report the percentage of reads aligning to at least three, five, or ten different loci in the template.</p>
        </table-wrap-foot>
      </table-wrap>
      <p>Results for the positive control and test templates genotyped at 50-fold coverage are shown in Figure <xref ref-type="fig" rid="F3">3</xref>. (Negative control results are shown in Additional file <xref ref-type="supplementary-material" rid="S11">11</xref>.) In Figure <xref ref-type="fig" rid="F3">3a</xref>, we report accuracy - (TP + TPFG + TN)/(TP + TPFG + FP + TN + FN), where TP = true positive loci, TN = true negative loci, FP = false positive loci, FN = false negative loci, and TPFG = true position, false genotype loci - as a single performance measure that summarizes all hypotheses as a function of stringency (the minimum posterior probability for a SNP). The total map (ALL) yields maximum accuracy for all 12 comparisons of template and <italic>k </italic>(Figure <xref ref-type="fig" rid="F3">3a</xref>), all of which show significantly greater accuracy than unique, best-guess or best-no-guess maps (<italic>P </italic>&lt; 0.05). This indicates that the use of multiply mapped reads improves accuracy regardless of template sequence complexity or the number of mismatches used to generate the read map. ALL also shows maximal accuracy over a broad stringency range. The only exception is for the six comparisons at highest stringency (Q ≥ 160) for 2 × RPL +2% and 2 × RPL +5% data sets; however, this occurs because ALL uses a max-<italic>d </italic>strategy that prohibits a few reads that BEST does use. Similar results are found comparing the three read maps at different coverage levels (Additional file <xref ref-type="supplementary-material" rid="S12">12</xref>) with a few notable exceptions: as expected, all of the read maps tend to display similar accuracy for predominantly unique templates at very low coverage (for example, RPL at four-fold coverage); and best-guess maps compare well to total maps for more degenerate templates at high coverage (for example, 2 × RPL +2% at 200-fold coverage), due to greater overall sensitivity and greedy mapping strategy. It is also worthwhile to note that for these simulations, restricting successful alignments to <italic>k </italic>= 1 yields little, if any, decrease in accuracy. This likely results from our use of a relatively low base-call sequencing error rate (0.001) and low levels of polymorphic divergence between sample and template sequence (0.001), such that the expected number of mismatches between a sequenced read and the reference template is less than 1 (see Discussion). That said, these parameter values reflect those determined from the experimental 261-kb human data set.</p>
      <fig id="F3" position="float">
        <label>Figure 3</label>
        <caption>
          <p><bold>Genotyping performance on simulated data sets</bold>. <bold>(a) </bold>Bar charts report Sniper genotyping accuracy based on resequencing of four different synthetic genomic DNA templates. Sample genomes were generated from each known template by introducing single nucleotide sequence variation randomly to 0.1%. We simulated 36-nucleotide PE reads from each unknown genome to 50-fold coverage and mapped them to the respective known genomic template according to a unique (red), best no-guess (yellow), best guess (green), or total (blue) mapping strategy using <italic>k </italic>= 1, 2, or 3 mismatches, as shown. Accuracy for each bar was determined using only those genotype loci identified at or above the specified stringency level Q = -10 log<sub>10</sub>(1 - <italic>P</italic>), where <italic>P </italic>is the posterior probability of the MAP genotype at a single nucleotide locus. Error bars represent ± standard deviation across five replicate simulations of generating a new sample genome and simulating reads from this genome. <bold>(b) </bold>Receiver operating characteristic (ROC) styled plot relating genotyping sensitivity, TPR = (TP + TPFG)/(TP + TPFG + FN) (where TP = true positive loci, FN = false negative loci, and TPFG = true position, false genotype loci, to number of false positives (FPs) for simulation results genotyping the moderate difficulty Yeast 2 × RPL + 5% template at 50-fold coverage; as in (a), each point represents the average over five replicates. Points representing stringency levels Q ≥ 40 and Q ≥ 90 are labeled for clarity. <bold>(c) </bold>Bar chart reporting the estimated false discovery rate FDR = (FP + TPFG)/(TP + FP + TPFG) for genotyping the Yeast 2 × RPL + 5% template at 50-fold coverage using Q ≥ 40 confidence. Error bars represent ± standard deviation over five replicates, as in (a). See Additional file 14 for a complete description of estimates.</p>
        </caption>
        <graphic xlink:href="gb-2011-12-6-r55-3"/>
      </fig>
      <p>While achieving the greatest overall accuracy, ALL maintains high sensitivity and specificity, regardless of mismatches or template degeneracy (Figure <xref ref-type="fig" rid="F3">3b</xref>; Additional files <xref ref-type="supplementary-material" rid="S13">13</xref> and <xref ref-type="supplementary-material" rid="S14">14</xref>). In contrast, BEST, which shows the most comparable accuracy, yields highest overall sensitivity but also the worst specificity. Computing FDRs for the 2 × RPL + 5% template reveals that ALL performs most optimally on degenerate sequence, with FDRs of 0.1%, 0.6%, and 0.6% with 1, 2, or 3 mismatches, respectively. Despite fully utilizing multiply mapped reads, ALL achieves specificity comparable to UNI for <italic>k </italic>= 1 (0.0%) and <italic>k </italic>= 2 (0.3%) and exceeds UNI at <italic>k </italic>= 3 (1.1%). In contrast, BEST and best-no-guess (BESTNO) maps perform significantly worse (Figure <xref ref-type="fig" rid="F3">3c</xref>; Additional file <xref ref-type="supplementary-material" rid="S14">14</xref>). We also evaluated performance with BESTNO maps aligned using read quality scores, which revealed slightly improved, but still high, FDRs (Additional file <xref ref-type="supplementary-material" rid="S14">14</xref>). By pooling estimated genotypes across all synthetic templates, mismatches, and coverage levels, we estimated overall error rates for Sniper using each read map strategy at a stringency cutoff of Q ≥ 40 (Table <xref ref-type="table" rid="T3">3</xref>). ALL provides a high sensitivity of 0.744 (compared to UNI with 0.648) while maintaining the minimum FDR of 0.027 (compared to UNI with 0.028); in contrast, BESTNO and BEST yield FDRs of 0.176 and 0.400, respectively. Estimates based on a typical experimental design (Q ≥ 40 and 50-fold coverage) and broken down by template reveal even better performance; ALL has an estimated FDR of only 0.58% for <italic>k </italic>= 2 on our most difficult template (compared to 9.57% with UNI; Additional file <xref ref-type="supplementary-material" rid="S14">14</xref>). Furthermore, these estimates are robust to approximately ten-fold discrepancies in sequencing error rate (Text S4 in Additional file <xref ref-type="supplementary-material" rid="S1">1</xref>; Additional file <xref ref-type="supplementary-material" rid="S15">15</xref>). This demonstrates that using multiply mapped reads results in significant improvements in accuracy and specificity compared to single-alignment mapping strategies, without substantial loss of sensitivity compared to greedy approaches. Moreover, read maps containing both unique and multiply mapped reads can, in principle, infer genotypes for all resequenced loci, which is otherwise impossible for all but the simplest genomes.</p>
      <table-wrap id="T3" position="float">
        <label>Table 3</label>
        <caption>
          <p>Overall performance estimates based on synthetic template simulations</p>
        </caption>
        <table frame="hsides" rules="groups">
          <thead>
            <tr>
              <th/>
              <th align="left">TPR</th>
              <th align="left">FPR</th>
              <th align="left">FDR</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td align="left">UNI</td>
              <td align="left">0.648</td>
              <td align="left">2.475e-5</td>
              <td align="left">0.028</td>
            </tr>
            <tr>
              <td align="left">BESTNO</td>
              <td align="left">0.751</td>
              <td align="left">2.213e-4</td>
              <td align="left">0.176</td>
            </tr>
            <tr>
              <td align="left">BESTNO-Q</td>
              <td align="left">0.673</td>
              <td align="left">1.939e-5</td>
              <td align="left">0.044</td>
            </tr>
            <tr>
              <td align="left">BEST</td>
              <td align="left">0.816</td>
              <td align="left">1.106e-3</td>
              <td align="left">0.400</td>
            </tr>
            <tr>
              <td align="left">ALL</td>
              <td align="left">0.744</td>
              <td align="left">3.679e-5</td>
              <td align="left">0.027</td>
            </tr>
          </tbody>
        </table>
        <table-wrap-foot>
          <p>Sniper performance estimates reflect averages taken across a range of mismatches (1 ≤ <italic>k </italic>≤ 3) and coverage levels (10×, 25×, 32×, 50×, 75×, 100×, 150×) over five independently sampled replicates and four synthetic reference templates (Table 2) at our recommended stringency cutoff of Q ≥ 40. Note, these performance estimates are conservative because the majority of genotyped loci come from non-unique templates. See Additional file 14 for estimates broken down by template. See Figure 1b for complete descriptions of mapping strategies. See Materials and methods for corresponding equations. ALL, unique and multiply mapped reads; BEST, best guess; BESTNO, best no-guess mapping; BESTNO-Q, same as BESTNO but uses read quality values for mapping; FDR, false discovery rate; FPR, false positive rate; TPR, true positive rate; UNI, strictly unique mapping.</p>
        </table-wrap-foot>
      </table-wrap>
    </sec>
    <sec>
      <title>Discovery of novel SNPs in repetitive regions of the human genome</title>
      <p>As a preliminary demonstration of the application of Sniper to experimental data, we identified SNPs in one human individual (NA19240 from Yoruba) using high coverage (approximately 42-fold) SE and PE Illumina sequencing data generated by the 1000 Genomes Project Consortium and compared the results to the final release of pilot project SNP calls (March 2010) [<xref ref-type="bibr" rid="B1">1</xref>]. We focused this preliminary analysis on chromosomes 20 to 22 only. Compared to the 165,544 pilot project SNP calls (1 KG SNPs) over these three chromosomes, Sniper identified 168,252 SNPs at moderate stringency (Q ≥ 40) and 198,105 SNPs at lower stringency (Q ≥ 13, <italic>P </italic>&lt; 0.05). Figure <xref ref-type="fig" rid="F4">4a</xref> shows the proportion of SNPs that agree between Sniper and 1 KG (concordance rate) across a range of stringency thresholds for the Sniper SNPs. As expected, concordance normalized to 1 KG SNPs decreases with stringency, while concordance normalized to Sniper SNPs increases with stringency. The maximum 1 KG-normalized concordance of 92.5% is reached at Sniper's lowest stringency (Q ≥ MAP; simply, maximum <italic>a posteriori </italic>SNP calls); that is, 7.5% (12,416 SNPs) of the 1000 Genomes Project SNPs are not shared with Sniper. Sniper-normalized concordance, on the other hand, is lowest (71.9%) at MAP stringency and increases to a maximum of 84.4% at Q ≥ 120. Sniper's relatively stable curve and high average concordance indicate that a large majority of Sniper SNP calls are high confidence and suggest that most SNPs are most likely to be real. At the same time, many of Sniper's SNP calls (32,932 SNPs at Q ≥ 40) are not concordant with 1 KG. Notably, this discordant portion represents 19.6% of the total set of SNPs identified as significant by Sniper.</p>
      <fig id="F4" position="float">
        <label>Figure 4</label>
        <caption>
          <p><bold>SNP calls for a high-coverage 1000 Genomes Project individual</bold>. <bold>(a) </bold>Concordance rate (Matching/(Matching + Discordant) SNP calls) across a range of stringency thresholds (MAPthrough <italic>P </italic>&lt; 10<sup>-160</sup>) between Sniper SNP calls and SNP calls from the March 2010 release of the 1000 Genomes Project Consortium for human individual NA19240 chromosomes 20 to 22. Solid lines depict concordance rates using all SNP calls; dashed lines depict concordance rates using the subset of Sniper SNPs covered exclusively by unique alignments <bold>(b) </bold>Estimates of read depth, stringency, variant allele frequency, alignments per read, and proportion of non-unique SNPs averaged over the concordant, Sniper-specific, and 1000 Genomes Project-specific (1 KG) SNP calls (using Q ≥ 40 cutoff for Sniper). Significant comparisons resulting from a two-sample unequal variance <italic>t</italic>-test are indicated. ***<italic>P </italic>&lt; 10<sup>-10</sup>. No test was performed for the lower right panel due to sample sizes of 1. <bold>(c) </bold>Comparison of Sniper SNPs across mapping strategies, showing total loci assayed and SNP calls at Q ≥ 13 and Q ≥ 40 stringency cutoffs. See Figure 1b for complete descriptions of mapping strategies. <bold>(d) </bold>Comparison of SNPs across SNP calling algorithms (Sniper, SAMtools/Maq, GATK) given an identical read map generated with Bowtie using the best no-guess (BESTNO) strategy. SNPs were filtered using Q ≥ 13 (Sniper and SAMtools) and recommended settings for GATK (DP &gt; 100 || MQ0 &gt; 40 || SB &gt; -0.1). <bold>(e) </bold>Isolation of high confidence false positive (FP; left) and true positive (TP; right) SNPs by intersecting 1 KG-specific and Sniper-specific SNPs with calls from GATK to control for read map differences between this study and the 1 KG study [<xref ref-type="bibr" rid="B1">1</xref>]. ALL, unique and multiply mapped reads; BEST, best guess; BESTNO, best no-guess mapping; FDR, false discovery rate; FP, false positive; MAP, maximum <italic>a posteriori</italic>; TP, true positive; UNI, strictly unique mapping.</p>
        </caption>
        <graphic xlink:href="gb-2011-12-6-r55-4"/>
      </fig>
      <p>Since one key aspect of Sniper's methodology is the use of multiply mapped reads, it is possible that many SNPs harbored in redundant genomic contexts have gone undetected by the 1 KG methodology; in particular, variant calls over approximately 20% of the reference genome were masked primarily due to non-unique read mapping (non-'accessibility') [<xref ref-type="bibr" rid="B1">1</xref>]. To evaluate this hypothesis, we first isolated the subset of Sniper calls that only overlapped unique reads and compared genotypes to 1 KG SNPs (Figure <xref ref-type="fig" rid="F4">4a</xref>). In contrast to all Sniper SNPs, unique Sniper SNPs show greatly increased maximum and minimum concordances of 98.1% (Q ≥ 80) and 93.6% (Q = MAP), respectively. This indicates that when restricted to a comparable read map, Sniper largely recapitulates the same SNPs produced by the 1 KG approach for the unique genomic regions. Consequently, most of the remaining SNPs are non-unique and are not presented in the 1 KG SNP set. However, the maximum 1 KG-normalized concordance compared to these unique Sniper SNPs drops to 80.0% (compared to 92.5%), suggesting either that Sniper is less sensitive than the 1 KG approach or that the 1 KG approach is both less sensitive (since it fails to detect non-unique SNPs) and less specific (because it calls many additional SNPs) than Sniper. To distinguish these possibilities, we characterized the average read depth, confidence, variant allele frequency, degeneracy, and proportion of non-unique SNPs for those non-concordant SNPs exclusively reported by Sniper (32,932 SNPs at Q ≥ 40) or 1 KG (30,224 SNPs). We compared these values to corresponding estimates from the set of 135,284 SNPs concordant between methods (at Q ≥ 40) - assuming that concordant SNPs represent true positive calls - and found a clear disparity between the Sniper-specific and 1 KG-specific sets (Figure <xref ref-type="fig" rid="F4">4b</xref>). On average, 1 KG-specific SNPs exhibit significantly lower read depth (16.4 alignments/SNP, <italic>P </italic>&lt; 10<sup>-10</sup>), stringency (Q = 30.2, <italic>P </italic>&lt; 10<sup>-10</sup>), and variant allele frequency (14.4%, <italic>P </italic>&lt; 10<sup>-10</sup>) compared to concordant SNPs, suggesting that Sniper did not identify these loci as significant because of weak support for variant alleles. Conversely, Sniper-specific SNPs have significantly elevated average read depth (67.7 alignments/SNP, <italic>P </italic>&lt; 10<sup>-10</sup>) and comparable variant allele frequency (29.3%, <italic>P </italic>= 0.68), while maintaining very high confidence (Q = 91.4). These results suggest that Sniper-specific SNPs have much higher quality than 1 KG-specific SNPs in general. Yet despite these characteristics, Sniper-specific SNPs are 1.7-fold more degenerate than either concordant or 1 KG-specific SNPs (<italic>P </italic>&lt; 10<sup>-10</sup>; Figure <xref ref-type="fig" rid="F4">4b</xref>); reads align to 1.79 loci on average compared to 1.05 and 1.02 loci, respectively. Using a relaxed criterion for SNP uniqueness (&gt; 25% of overlapping reads must be uniquely mapped), 89% of Sniper-specific SNPs are not unique compared to 13% for concordant and 1 KG-specific SNPs. Thus, the approximately 33,000 SNPs exclusively identified by Sniper exhibit characteristics associated with the putatively true, concordant SNPs, yet notably are located in moderately redundant genomic contexts. At the same time, characteristics of the approximately 30,000 1 KG-specific SNPs suggest that the majority might be spurious, yielding a possible FDR up to 20% for this individual. Notably, this estimate closely matches the approximately 20% error rate expected from subsampling simulations reported by Harsimendy <italic>et al</italic>. for 42-fold coverage (Figure 5b in [<xref ref-type="bibr" rid="B9">9</xref>]).</p>
      <p>We validated this discrepancy between Sniper and 1 KG SNP calls by comparison with SNPs generated using UNI, BEST, or BESTNO maps. Since BEST and BESTNO maps yield the highest FDRs on our simulated data sets (Table <xref ref-type="table" rid="T3">3</xref>), the 32,932 Sniper-specific SNPs (which were generated from the ALL map) are more likely to be valid if ALL yields fewer SNP calls than BEST or BESTNO on this experimental data set. As expected, the total number of loci with positive read depth varied by mapping strategy, with ALL yielding the most hypotheses and UNI the least (Figure <xref ref-type="fig" rid="F4">4c</xref>). In contrast, BEST reported the most significant SNPs while the other maps reported comparable numbers; this is true at both moderate (Q ≥ 40) and lower stringency (Q ≥ 13; Figure <xref ref-type="fig" rid="F4">4c</xref>). Thus, ALL does not predict more SNPs compared to maps with elevated FDR, further suggesting the validity of Sniper-specific SNPs. An alternative possibility is that Q ≥ 40 is an overly stringent cutoff, thus predisposing Sniper to miss true SNPs (false negatives). In support of this, decreasing stringency increases concordance between ALL and 1 KG calls (Figure <xref ref-type="fig" rid="F4">4a</xref>). To control for this putative loss of sensitivity, we compared 1 KG-specific SNPs to Sniper SNPs from the more sensitive BEST and BESTNO maps. However, at Q ≥ 40 only 1.54% of 1 KG-specific SNPs match BEST SNPs (<italic>n </italic>= 465), and only 0.82% match BESTNO SNPs (<italic>n </italic>= 248). While reducing stringency to Q ≥ 13 does increase concordance substantially to 45.2% (BEST) and 44.9% (BESTNO), these are nevertheless comparable to concordance with ALL at Q ≥ 13 (44.7%, <italic>n </italic>= 13,491). Thus, even assuming that all SNPs matching at this low stringency are true, the argument of decreased sensitivity fails to explain the majority of 1 KG-specific SNPs.</p>
      <p>Since our Bowtie read maps likely differ from the map used to generate the 1 KG SNPs (for example, we did not control for biased SNP calling near possible indels), we also assessed the effect of using different read maps to explain the discrepant SNP calls. We compared Sniper calls with those produced by GATK [<xref ref-type="bibr" rid="B19">19</xref>] and Maq/SAMtools [<xref ref-type="bibr" rid="B4">4</xref>,<xref ref-type="bibr" rid="B20">20</xref>] (using the authors' recommended filtering criteria) given the same BESTNO map as input. Both methods largely agree with Sniper (Q ≥ 13) calls (90.1% and 99.3% concordance, respectively; Figure <xref ref-type="fig" rid="F4">4d</xref>), indicating that the discrepancy between Sniper and 1 KG is not due to implementation-specific factors independent of the read map (for example, filtering criteria). While at best Sniper matches 44.9% of 1 KG-specific SNPs (see above), GATK matches 62.2%, indicating that after controlling for read map differences, GATK (notably one of the methods used to generate the 1 KG SNPs) yields results that are much more similar to 1 KG than does Sniper. Of course, since GATK also shows partial concordance with 1 KG SNPs, this does indicate there is a read map effect (that is, our Bowtie maps differ from the 1 KG map). We controlled for this difference in two ways. First, we checked for potential indels using GATK and generated a new read map based on local realignment of reads near indels. However, none of GATK's SNP calls were altered by this procedure. Second, we restricted attention to the subset of 18,674 1 KG-specific SNPs that were matched by GATK (Figure <xref ref-type="fig" rid="F4">4e</xref>); aside from minimizing the read map effect, this provides a further control for indel bias because these SNPs were thus identified with a global-alignment map. Only 30.0% of this reduced set of 1KG SNPs (5,594 at Q ≥ 13) is concordant with Sniper, while increasing stringency to Q ≥ 40 results in 0% concordance. Thus, after controlling for read map differences, indel bias, and potential false negatives 13,000 to 18,000 of the 1 KG SNP calls are discordant with Sniper. Given this result, we estimate that the FDR for 1000 Genomes Project SNPs lies between 3.63% and 12.13% when restricted to the uniquely accessible portion of the human genome. Notably, this FDR range closely matches that provided by Harsimendy <italic>et al</italic>. [<xref ref-type="bibr" rid="B9">9</xref>] based on first-generation sequencing technology and older SNP calling methodology, indicating little if any improvement in the rate of false SNP discovery has been made using newer sequencing platforms or improved methodology. Furthermore, the 1000 Genomes Project Consortium itself reported that the FDR for their low-coverage SNPs (determined by consensus of three different methods) was reduced by 30 to 50% compared to any single method, while high-coverage 1 KG SNPs (that is, 42-fold coverage) were only based on the consensus of two methods. They also used variants in the dbSNP database to estimate a FDR around 5% for SNP calls from high-coverage individuals [<xref ref-type="bibr" rid="B1">1</xref>]. Thus, we conclude that current, sophisticated methods that rely on singly mapped reads for variant discovery still face a significant FDR, even when carefully masking redundant genomic contexts. In contrast, Sniper yields an estimated FDR of only 0.27% at 42-fold coverage, averaged across both unique and redundant contexts and using a similar two-mismatch cutoff (Additional file <xref ref-type="supplementary-material" rid="S14">14</xref>). Thus, by integrating unique and non-unique reads, Sniper appears to provide significantly greater specificity than the 1 KG methodology, even using a nominal significance cutoff.</p>
      <p>Next, we assessed whether the 32,932 Sniper-specific SNPs not present in the 1 KG data set also exhibit a read map effect. We compared them to SNP calls generated by GATK (using the BESTNO map) and by Sniper (using the BEST map) and found that 98.6% and 98.3% are matched, respectively. Thus, the vast majority of Sniper-specific SNPs can be explained by a difference in read maps, notably through the use of redundant positions masked in the 1 KG results. Regardless, concordance of Sniper-specific SNPs by GATK validates the majority of the Sniper-specific calls. Moreover, 454 SNPs were not identified by GATK, suggesting a possible increase in SNP occurrence rate by 0.2% (Figure <xref ref-type="fig" rid="F4">4e</xref>); 412 other variants are identified by GATK, but at these positions it proposes differing genotypes. Similar to the bulk of Sniper-specific SNPs, these discordant loci average 1.41 non-unique alignments per read, confidence of 80.7, depth of 417 reads (median 62), and variant allele frequency of 0.245. In contrast, analyzing these loci using the BESTNO map shows reduced confidence of 60.6, reduced depth of 121 reads (median 25), and reduced variant frequency of 0.130, suggesting that the Sniper-specific genotypes are correct. Thus, for SNPs covered by a mixture of unique and non-unique reads, accurate genotyping requires utilizing the information from all alignable reads.</p>
      <p>We then queried the HapMap SNP collection [<xref ref-type="bibr" rid="B21">21</xref>] to determine whether any of Sniper's SNP calls could be independently validated. Overall, HapMap provides 82,381 SNP loci for individual NA19240, 68,237 of which (82.8%) are present in the set of 168,252 Sniper (Q ≥ 40) SNPs (and 90.2% using Q ≥ 13). Another 837 variants match in position but differ in genotype, and 1,064 variants are genotyped by Sniper but lack a genotype in the HapMap collection. For comparison, GATK matches a similar, but slightly lower, number of HapMap SNPs (68,179) and predicts discordant genotypes at 853 additional loci. Notably, GATK matches 820 of Sniper's 837 discordant SNPs (98.0%), suggesting that corresponding HapMap alleles may be incorrect. Thus, compared to HapMap SNPs, Sniper using the ALL map shows slightly greater sensitivity than GATK using a BESTNO map. Focusing on the subset of 32,932 Sniper-specific SNPs not found in the 1 KG data set, 1,577 positions (4.8%) have a matching genotype, and 227 variant positions differ in genotype; in contrast, none of the 1 KG-specific SNP calls are present in HapMap. Finally, only two of the 454 SNPs predicted only by Sniper were found among HapMap variants, one of which showed a different genotype (Additional file <xref ref-type="supplementary-material" rid="S16">16</xref>). Of the 412 SNPs with discrepant genotypes compared to GATK, 28 were also identified, half of which disagree with the HapMap genotype; note that these 14 SNPs have nearly twice as much confidence and significantly lower degeneracy than the 14 SNPs that do match in HapMap (<italic>P </italic>= 10<sup>-4</sup>), suggesting they are valid (Additional file <xref ref-type="supplementary-material" rid="S16">16</xref>). Thus, since Sniper and GATK show similar concordance with the HapMap collection over the three chromosomes we analyzed, and since Sniper-specific SNPs show much better concordance compared to 1 KG-specific SNPs, we conclude that the majority of Sniper SNP calls are likely to be correct. Also, since chromosomes 20 to 22 represent only approximately 3.5% of the entire human genome, we anticipate that Sniper would identify approximately 13,500 SNPs in redundant genomic contexts throughout the genome; notably, this estimate only considers SNPs that would be unidentifiable by methods utilizing unique reads alone. Moreover, given the sensitivity estimates described in our study, we anticipate that human genome data sets incorporating greater than 42-fold sequencing coverage would identify an abundance of additional SNPs in both unique and redundant genomic contexts.</p>
    </sec>
  </sec>
  <sec>
    <title>Discussion</title>
    <p>The primary aim of genome resequencing studies is to discover accurately all loci that are polymorphic in a population. To this end the methods used to discover polymorphisms using NGS data aim to consider the possibility of variation at any and all genomic loci and to accurately report genotypes for all variant loci. Existing methods rely on singly mapped near-optimal alignments to achieve high specificity, whether by a strict definition of uniqueness or by approximation (Figure <xref ref-type="fig" rid="F1">1b</xref>). Consequently, NGS studies typically under-utilize available sequencing data, especially reads that overlap the true, unknown polymorphisms - precisely the loci under investigation. While exclusive use of unique reads does generally yield fewer false calls over unique contexts, this strategy presents two primary drawbacks: SNP loci often occur in mildly redundant contexts, resulting in biased genotyping estimates at true SNP loci and increased rate of false SNP discovery (Figure <xref ref-type="fig" rid="F4">4e</xref>); and significant portions of a reference genome simply may not be mappable, or are only mappable at a low coverage rate, due to inherently redundant, paralogous sequences. Thus, redundant genomic contexts are a major factor limiting both sensitivity and specificity of SNP discovery. While adopting a more lenient unique mapping strategy (such as best guess or best no-guess) does increase the number of mapped loci compared to a strictly unique strategy, this risks introducing sampling bias among repetitive elements and paralogs and, given sufficiently short reads or high sequencing error rates, can yield spurious alignments. Thus, lenient mapping strategies tend to improve sensitivity in unique genomic contexts at the cost of an elevated FDR. To reduce false calls, current approaches have supplemented careful read mapping and genotyping with quality score recalibration, cumbersome multifaceted filtering strategies, and masking of redundant loci. Alternatively, as we have shown using our novel method Sniper, simply considering multiply mapped reads and unique reads using probabilistic integration can successfully provide both maximal coverage, accuracy, and specificity at the cost of slightly reduced sensitivity. Given available sequencing data, our method evaluates both unique and redundant loci in a unified, Bayesian probabilistic framework and successfully refrains from calling false SNPs by correcting for sequence degeneracy across paralogous loci. Our model framework offers a complete representation of the problem of SNP discovery using NGS data, allowing for further principled generalizations. Here, we limited our implementation to the most critical parameters only. However, our model's generality allows for much greater specification to incorporate, for example, platform-specific error models and more realistic models of population heterozygosity, not to mention inclusion of quality score recalibration and other sophisticated data corrections.</p>
    <p>In this study we focused our analysis on a variety of quality-blind mapping strategies. Incorporating base call qualities into single-alignment maps can help (Additional file <xref ref-type="supplementary-material" rid="S14">14</xref>), but our analysis of existing 1000 Genomes Project data strongly argues that it is still prone to generating false positives at a rate comparable to older methods applied to older sequencing chemistry (FDR ≈ 3 to 12%). In our current implementation, base-call qualities were incorporated into SNP probabilities but not into prior template location probabilities. Yet, we found relatively optimal performance using Sniper over a broad range of conditions. Without the Sniper strategy, at least 15% of the human genome would not be assayable using a single-alignment read map without risking unwieldy increases in FDR (Figure <xref ref-type="fig" rid="F3">3c</xref>; Additional file <xref ref-type="supplementary-material" rid="S14">14</xref>).</p>
    <p>Since genome resequencing remains a costly exercise, most studies are currently limited to low or moderate sequence coverage. Thus, optimal use of available data is crucial. Using our method, we find that between 10-fold and 25-fold coverage is required to be able to identify a simple majority of true SNPs in realistic data sets, while at least 50-fold coverage is desired to approach full sensitivity with confidence (Additional files <xref ref-type="supplementary-material" rid="S10">10</xref> and <xref ref-type="supplementary-material" rid="S13">13</xref>). Since reads that align to multiple locations are informative for all overlapping loci, our method tends to boost accuracy at low coverage (≤25-fold) without sacrificing specificity (Additional files <xref ref-type="supplementary-material" rid="S12">12</xref> and <xref ref-type="supplementary-material" rid="S13">13</xref>). Further gains in accuracy may be achieved by increasing the maximum number of multiple alignments <italic>d </italic>+ 1 and by increasing the number of allowed mismatches per locus <italic>k</italic>, both of which will increase the number of mapped reads and the number of alignments per read. It is important to note, however, that increasing either <italic>k </italic>or <italic>d </italic>can end up reducing variant sensitivity <italic>per se</italic>, at the expense of accuracy. As <italic>k </italic>and <italic>d </italic>increase, information from a single read becomes diluted across multiple alignments. For example, more NGS reads will typically map uniquely to a given template using <italic>k </italic>= 1 than with <italic>k </italic>= 2. As discussed in our results, variant sensitivity is maximized when using a value of <italic>k </italic>that maximizes the genome-wide ratio of average read depth versus average number of alignments per read. Of course for a given <italic>k</italic>, one can approximate this simply by reducing the number of alignments returned by the mapping algorithm (that is, by reducing the parameter <italic>d</italic>), thereby concentrating sequence information over fewer loci; in the limit where <italic>d </italic>= 0, this becomes the best-guess strategy. As we have shown, this approximation does work well for long read lengths over unique genomic sequence. However, unless non-unique regions of the genome are explicitly masked, this strategy will fail on realistic data sets. While recent methods have been developed to improve specificity further by integrating unique mapping with imputation using population-based SNP information [<xref ref-type="bibr" rid="B22">22</xref>] - essentially how low-coverage 1000 Genomes Project data have been analyzed [<xref ref-type="bibr" rid="B1">1</xref>] - this strategy still cannot be used to investigate redundant or paralogous loci.</p>
    <p>Finally, our analysis of synthetic genomic templates (Additional files <xref ref-type="supplementary-material" rid="S12">12</xref> and <xref ref-type="supplementary-material" rid="S13">13</xref>) may be used to guide selection of an appropriate stringency level for novel genome resequencing studies. While our method is highly accurate in principle because the probability of a SNP at any given nucleotide site is estimated within the context of that site's paralogous loci, many factors influence genotyping performance, including coverage level, unknown sequencing errors, number of mismatches, reads missing due to library preparation bias, the short-range correlation between adjacent sites due to shared overlapping reads, and the long-range correlation due to positional paralogy. Our results suggest that, while maximum sensitivity is achieved at or below a baseline stringency of Q ≥ 13 (<italic>P </italic>&lt; 0.05), maximum specificity is achieved at Q ≥ 90 (<italic>P </italic>&lt; 10<sup>-9</sup>), especially for low complexity sequences. We find that a good balance is generally achieved using a Q ≥ 40 cutoff (<italic>P </italic>&lt; 10<sup>-4</sup>), which is approximately the stringency needed to correct a <italic>P </italic>&lt; 0.01 model error for the correlation across adjacent loci using a Bonferroni-style multiple test correction. To obtain a more comprehensive cutoff, our implementation of Sniper also applies a broader Bonferroni-style correction across both adjacent and paralogous sites by determining the necessary stringency level for each individual SNP based on that site's overall read degeneracy.</p>
  </sec>
  <sec>
    <title>Conclusions</title>
    <p>In this paper, we presented a new probabilistic method for SNP discovery using NGS data. But regardless of the SNP inference method itself, we found several rules-of-thumb applicable to any NGS-based study: (1) use all mappable reads to increase accuracy; (2) use long, PE reads with short template lengths to minimize multiply mapped reads; (3) generate at least 25-fold coverage, ideally ≥50-fold coverage to minimize sampling error; (4) use a posterior probability error threshold of <italic>P </italic>&lt; 10<sup>-4 </sup>to maintain high SNP confidence; (5) set <italic>k </italic>≤ 0.03 mismatches per base of each read for sequence alignment. Note that <italic>k </italic>is most likely platform-dependent. Local fluctuations in sequencing quality, non-constant sequencing error rates across the length of an individual read, use of a reference genome containing sequence divergence in excess of 0.1%, and occurrence of multiple SNPs within one read length may necessitate larger <italic>k</italic>. So, in general, one should set <italic>k </italic>≈ 1/<italic>|r| </italic>+ <italic>e<sub>max </sub></italic>+ π, where <italic>|r| </italic>is the read length, <italic>e<sub>max </sub></italic>is the maximum expected sequencing error rate per base per read, and p is the expected divergence per site between reference and (unknown) sample genomes.</p>
    <p>Genome resequencing using multiply mapped reads improves our ability to discover novel SNPs precisely without loss of sensitivity. Our method is especially useful for polymorphism detection in redundant genomic contexts, such as repetitive elements, paralogous genes, segmental duplications, and copy number variants, which are typically ignored because of their tendency to generate multiply mapped reads. The probability model also contains explicit components for sequencing errors and library template biases that may be parameterized in more detail in the future, allowing the method to be extensible and adaptable for specific sequencing platforms.</p>
  </sec>
  <sec sec-type="materials|methods">
    <title>Materials and methods</title>
    <sec>
      <title>Read sampling strategy</title>
      <p>For perfect resequencing (Figure <xref ref-type="fig" rid="F2">2a</xref>), 16 sequencing experiments were simulated by generating independent sets of 25 × 10<sup>6 </sup>PE reads without addition of base-call errors or sequence divergence; read sets were simulated for four read lengths (30, 60, 90, and 120 nucleotides) and four template, or fragment lengths (means of 250, 500, 750, and 1,000 nucleotides), yielding 0.47, 0.94, 1.41, and 1.88-fold coverage genome-wide, respectively. Fragment lengths were sampled for each PE read using a Gaussian distribution with mean <italic>μ </italic>and standard deviation 30, where <italic>μ </italic>is 250, 500, 750, or 1,000. Read quality values were sampled for each nucleotide along a read according to an empirical distribution (see next section, 'NGS data sets'). Reads were mapped allowing up to 1, 2, 3, or 3 mismatches, respectively. PE reads were aligned first, then unmapped reads were aligned individually as SE reads. For error-prone sequencing (Figure <xref ref-type="fig" rid="F2">2b</xref>), four sequencing experiments were simulated (30-, 60-, 90-, and 120-nucleotide read lengths) by generating independent sets of approximately 180 × 10<sup>6 </sup>PE reads (approximately 4.7-fold coverage) followed by random addition of 1% base-call errors. Fragment lengths and quality values were determined as described above. All reads were mapped using <italic>k </italic>= 2 mismatches.</p>
    </sec>
    <sec>
      <title>NGS data sets</title>
      <p>Analyses were performed using both experimental and simulated NGS data. We obtained 36-nucleotide SE Illumina 1G reads sequenced from 261 kb of genomic template for four <italic>Homo sapiens </italic>individuals (NA17156, NA17275, NA17460, NA17773) from Harsimendy <italic>et al</italic>. [<xref ref-type="bibr" rid="B9">9</xref>]. Simulated 36-nucleotide PE reads were generated from known genomic sequences, following the addition of sequence variation to constitute an unknown sample genome (see next section, 'Synthetic genomic DNA templates'). The chromosome and starting position of each PE read were chosen randomly. The insert size for each read was drawn from a Gaussian distribution with mean 250 and standard deviation 30, following standard experimental guidelines for the Illumina platform. Each pair of sequences was copied from the genomic template using the randomly sampled coordinates, reading from each terminal boundary inward. Sequencing errors were introduced randomly at each sequenced position at a rate of 0.001 errors per position. A quality score was associated with each base by drawing a Phred score from a Gaussian distribution with standard deviation 10 and position-specific mean determined using 36-nucleotide PE Illumina data from a <italic>Saccharomyces cerevisiae </italic>genome we generated (data not shown). The following 36 means were used: 32.8, 32.6, 32.5, 32.5, 31.9, 31.8, 31.7, 31.8, 31.5, 31.3, 31.2, 31.0, 30.5, 30.4, 29.9, 30.0, 29.3, 29.5, 29.3, 29.2, 29.1, 29.3, 29.4, 29.6, 29.3, 29.3, 28.6, 28.4, 28.0, 27.7, 27.2, 26.3, 26.2, 26.0, 24.8, 24.2. The magnitude and pattern of these quality scores generally match those calculated from our human NGS data. Simulated reads were generated using up to one of nine different genome-wide average coverage depths: 4-fold, 10-fold, 25-fold, 32-fold, 50-fold, 75-fold, 100-fold, 150-fold, 200-fold. Five independent replicate read sets were generated for each reference genomic template and for each coverage level.</p>
      <p>NGS data from the 1000 Genomes Project were downloaded from [<xref ref-type="bibr" rid="B23">23</xref>]. For redundancy structure analysis, we selected three PE data sets for each of twoindividuals (NA12892, CEU; NA19238, YRI) that show differences in read length (36 to 76 nucleotides) and template size (175 to 458 nucleotides) (Additional file <xref ref-type="supplementary-material" rid="S3">3</xref>). Reads were mapped using two mismatches as described above; PE reads were mapped using the specified insert size boundaries (Additional file <xref ref-type="supplementary-material" rid="S3">3</xref>). For full genotyping, we downloaded and mapped 245 'high coverage' PE data sets produced from one individual (NA19240, YRI). All reads were mapped allowing only <italic>k </italic>= 1 mismatch and <italic>d </italic>= 5 alignments per read against the hg18/NCBIv36 reference human genome [<xref ref-type="bibr" rid="B24">24</xref>]. Mapping of mixed-length reads was permitted. The final release of SNP calls generated by the 1000 Genomes Project Consortium were used for comparison (March 2010) [<xref ref-type="bibr" rid="B25">25</xref>]. SNP calls from the HapMap project were downloaded from [<xref ref-type="bibr" rid="B26">26</xref>].</p>
    </sec>
    <sec>
      <title>Synthetic genomic DNA templates</title>
      <p>A panel of five synthetic genomic DNA templates were generated (from <italic>S. cerevisiae </italic>S288c genomic sequence) that exhibit varying levels of sequence degeneracy (Table <xref ref-type="table" rid="T2">2</xref>). Each synthetic template is considered homozygous diploid. Five of the templates are based on a common 94,678-nucleotide sequence that is the concatenation of 85 RPL from the yeast genome, including 500-nucleotide flanking sequence upstream and downstream of each locus. For the other RPL-derived templates, two copies of the RPL sequence were concatenated (totaling 189,256 nucleotides), and varying amounts of divergence (0%, 2%, 5%, and 10%) were added randomly across the template. Sample genomes were obtained from these synthetic templates by introducing sequence variation (corresponding to population-level genomic divergence) randomly at each position at a rate of 0.0005 heterozygous polymorphisms per locus and 0.0005 homozygous polymorphisms per locus, for a total proportion of variation of 0.001. This yielded 94 SNPs for the RPL template and 188 SNPs for the four different 2 × RPL templates. These derived genomic templates represent the unknown genomic configurations whose sequence we wish to infer.</p>
    </sec>
    <sec>
      <title>Read map generation using sequence alignment</title>
      <p>Sequence reads were aligned to a reference genome using Bowtie version 0.11.3 [<xref ref-type="bibr" rid="B27">27</xref>] (for Sniper and Maq analysis) or SOAPaligner version 2.20 [<xref ref-type="bibr" rid="B3">3</xref>] (for SOAPsnp analysis). NCBI v36 (hg18) of the human genome was used as the known reference genome to align human experimental reads [<xref ref-type="bibr" rid="B24">24</xref>]. Synthetic genomic DNA templates were used to align simulated reads. Three different approaches were used to map sequence reads to a reference genome: unique (UNI), best-guess (BEST), and total (ALL). The UNI map consists of reads that align exactly once to the reference genome, given the specified number of mismatches <italic>k </italic>(in Bowtie, '-a -m 1 -best'). The BEST map consists of reads having one or more valid alignments, but only a single alignment (the one with fewest mismatches, '-k 1 --best') is used. The ALL map consists of all reads with one or more valid alignments. In principle, the top <italic>d </italic>+ 1 alignments for each read ('-k <italic>d</italic>+1 --best') or simply all reads ('-a') should be returned for ALL; however, either option results in an explosion in the size of the read map (for the human genome especially), likely due to reads aligning to very low complexity repetitive elements. To avoid this explosion, we instead focused on reads with a maximum of <italic>d </italic>+ 1 alignments ('-a -m <italic>d</italic>+1 --best'), rather than the top <italic>d </italic>+ 1 alignments. These three read mapping approaches are parameterized by <italic>k</italic>, the number of mismatches allowed to map each read to the reference genome, and <italic>d </italic>+ 1, the number of genomic loci to which a read can align. For UNI and BEST <italic>d </italic>+ 1 = 1; for ALL <italic>d </italic>+ 1 = 200 (approximately the expected genome-wide sequencing coverage for our human data) unless otherwise stated. Read maps were generated using <italic>k </italic>= 1, 2, or 3. Sequence quality scores were ignored during the alignment process ('-v <italic>k</italic>' mode for Bowtie). When using SOAPalign, the BEST approach was used exclusively ('-M 4'). Default settings for Maq and SOAPalign were used otherwise. For PE read mapping, valid alignments allow <italic>k </italic>mismatches for each of the paired reads as well as valid spacing between the mapped locations of each mate pair. A range of 150 to 300 base pairs was used to define valid spacings. PE read maps were obtained by aligning PE reads first and then aligning the remaining unmapped reads as if they were SE reads.</p>
    </sec>
    <sec>
      <title>Genotyping overview</title>
      <p>Since all unknown sample genomes are diploid, ten genotype values (AA, AT, AC, AG, TT, TC, TG, CC, CG, GG) are considered for every genomic locus (position). For all loci with read depth &gt;0, a genotype call was produced as the genotype having MAP probability. Significant SNPs (that is, those significantly different from the corresponding reference genotype) were determined by removing those loci whose MAP probability did not meet a specified stringency cutoff <italic>Q</italic>.</p>
    </sec>
    <sec>
      <title>Performance comparisons</title>
      <p>ABI Sanger data were downloaded from dbSNP (handle: RSG_JCVI) [<xref ref-type="bibr" rid="B28">28</xref>] for the four individuals genotyped in Harsimendy <italic>et al</italic>. [<xref ref-type="bibr" rid="B9">9</xref>]: NA17156, NA17275, NA17460, NA17773. Chromosomal positions for these SNPs were obtained by nucleotide BLAST against build v.36 (hg18) of the human genome [<xref ref-type="bibr" rid="B24">24</xref>]. We utilized two benchmark data sets for performance comparisons, called <italic>Sanger </italic>and <italic>Sanger\NGS</italic>. For the <italic>Sanger </italic>benchmark, the total number of positions sequenced by ABI Sanger and that overlap genomic subsequences selected by Harsimendy <italic>et al</italic>. [<xref ref-type="bibr" rid="B9">9</xref>] are 449, 206, 279, and 250 for the four individuals, respectively, totaling 1,184 loci; this includes polymorphic and non-polymorphic positions (and excludes unknown alleles 'N'). From these loci, Sanger sequencing identified 111, 60, 79, and 94 variant positions, totaling 344 SNPs. The <italic>Sanger\NGS </italic>benchmark is composed of the subset of <italic>Sanger </italic>loci where genotype calls are identical across the three NGS platforms (ABI SOLiD, Roche 454, and Illumina Solexa) as reported by Harsimendy <italic>et al</italic>. [<xref ref-type="bibr" rid="B9">9</xref>]. This set includes 253 SNPs, 73, 50, 66, and 64 SNPs for each individual. For simulation performance comparisons, SNPs identified from simulated read sets were compared to the true polymorphisms that we introduced randomly to each of the synthetic genomic DNA templates. We used the following performance metrics (where TP = true positive loci, TN = true negative loci, FP = false positive loci, and TPFG = true position, false genotype loci): true positive rate, TP/(TP + FN); false negative rate, FN/(TP + FN); false positive rate, (FP + TPFG)/(FP + TPFG + TN); false discovery rate, (FP + TPFG)/(TP + FP + TPFG); and accuracy, (TP + TN)/(TP + FP + TPFG + TN + FN). Simulated accuracy values are reported on a log scale, using a log transformation similar to phred scores: -10 log<sub>10</sub>(1 - Accuracy). Transformed accuracy values range from 0 to + ∞. For example, an accuracy value of 0.99999 (1 - 1e-5) becomes 50.0 on this scale. Thus, a 10-unit increase in accuracy on this scale (for example, from 20 to 30) represents a 10-fold increase in the original accuracy proportion (from 0.99 to 0.999). Human accuracy values (Additional file <xref ref-type="supplementary-material" rid="S10">10</xref>) are reported as -log<sub>10</sub>(1 - Accuracy) without the coefficient of 10. Thus, an accuracy value of 0.96 corresponds to a transformed accuracy of 1.4.</p>
    </sec>
    <sec>
      <title>Likelihood model</title>
      <p>Read likelihoods are modeled as:<disp-formula><graphic xlink:href="gb-2011-12-6-r55-i11.gif"/></disp-formula></p>
      <p>where <italic>S<sup>G </sup></italic>denotes the locations of the reference genomic substrings <italic>s<sub>j </sub></italic>whose Hamming distance is at most <italic>k </italic>bases from the read <italic>r<sub>i</sub></italic>. The probability of read <italic>r<sub>i </sub></italic>originating from a genomic substring <italic>s </italic>was computed as a weighted average of a global error model computed from binomial probability <italic>P<sub>bin</sub></italic>(<italic>n,k,e</italic>) and a read-specific quality score probability <italic>P<sub>read</sub></italic>(<italic>q</italic>) as follows:<disp-formula><graphic xlink:href="gb-2011-12-6-r55-i12.gif"/></disp-formula></p>
      <p>For <italic>P<sub>bin</sub>, n </italic>= |<italic>r</italic>| is the sequence read length, <italic>k </italic>= selected number of alignment mismatches, and <italic>e </italic>= expected per-locus sequencing error rate, where <italic>e </italic>= 0.0003 was selected by empirical testing; note this is three-fold smaller than Illumina's advertised error rate (<italic>e </italic>&lt; 0.001). The parameter <italic>e </italic>can be estimated, for example, as the mean or median error-probability using read quality scores; however, this approach proved too stringent for our human data. The parameter <italic>P<sub>read </sub></italic>was computed using a read's per-base quality scores:<disp-formula id="bmcM9"><label>(9)</label><graphic xlink:href="gb-2011-12-6-r55-i13.gif"/></disp-formula></p>
      <p>where <italic>p<sub>i </sub></italic>is the position-specific probability of sequencing error. We selected a weighting factor <italic>λ </italic>= 0.67, which maximized agreement with human Sanger genotype calls. (Again we found Illumina quality scores to be slightly conservative for our data.) In general, the weighting factor <italic>λ </italic>can be used to tune read probabilities between global and read-specific models, although we found that results were very robust to variation in <italic>λ </italic>(data not shown).</p>
    </sec>
    <sec>
      <title>Prior probability model</title>
      <p>A weighted prior probability distribution was used, consisting of four possibilities: Pr{homozygous reference} = <italic>P</italic>(<italic>G<sub>xy</sub></italic>) = 1 - ϑ - ϑ<sup>2</sup>; Pr{heterozygous with 1 alternative allele} <italic>P</italic>(<italic>G<sub>x'y</sub></italic>) = ϑ/2; Pr{homozygous alternative} = <italic>P</italic>(<italic>G<sub>x'x'</sub></italic>) = ϑ/2; Pr{heterozygous with 2 alternative alleles} <italic>P</italic>(<italic>G<sub>x'y'</sub></italic>) = ϑ<sup>2</sup>. ϑ = 0.001 was used for human and simulated data to match expected genome-wide heterozygosity.</p>
    </sec>
    <sec>
      <title>Software implementation and computational complexity</title>
      <p>Sniper (SNP Identification using Probability of Every Read) is an implementation of our algorithm written in Python (and tested under versions 2.5 and 2.6); core computations have also been implemented in C for (optional) runtime improvement. Sniper takes as input a set of raw sequence files in fasta or fastq format along with a map file that specifies for each sequence file if it is single or PE, the reference genome to map against, and whether multiple files (lanes) should be pooled together. Sniper can perform all steps of analysis, including read map generation, organization of read maps into singly mapped and multiply mapped partitions, and SNP calling. Although Sniper is designed to use Bowtie for read alignment, any alignment program can be specified, as long as the read map output is stored in a SAM-formatted file [<xref ref-type="bibr" rid="B24">24</xref>]. The SNP discovery aspect of the algorithm has a runtime complexity of <italic>O</italic>(<italic>n |G|</italic>), where <italic>|G| </italic>is the length of the reference genome and <italic>n </italic>is the expected per-locus read depth (which is a function of <italic>k </italic>and <italic>d</italic>). Memory complexity is <italic>O</italic>(<italic>|G|+|M|</italic>), where <italic>|M| </italic>is the size of the read map index for non-unique alignments; this is implemented as a dictionary of read IDs and byte locations in the read map relevant to the specified genomic region. In practice, |M| can range from 0 bytes (if stream-loaded from disk) up to a few gigabytes depending on genome and data set. Also, a subset <italic>d</italic>' ≤ <italic>d </italic>of all alignments per read can be loaded (using the -d &lt;INT&gt; flag). To reduce computation time, genotyping can be subdivided into separate processes (for example, by chromosome or subsets thereof). Sniper has built-in support for multiprocessor job distribution on a single machine as well as distributed across machines using the Sun Grid Engine [<xref ref-type="bibr" rid="B29">29</xref>].</p>
      <p>To calibrate the runtime of Sniper, genotyping a 250e6 nucleotides sequence at approximately 70× coverage using the hybrid Python + C implementation took approximately 85 hours using a single 3.3Ghz 64-bit Intel Xeon CPU. Extrapolating, we anticipate processing the entire human genome at similar coverage would take approximately 50 days using a single CPU. However, this could be reduced to 13 days on a four-CPU machine, or less than 1 day if distributed on a computing cluster. Note that overall sequencing coverage and the values for parameters <italic>k </italic>and <italic>d </italic>will affect runtime significantly. Genotyping with <italic>d </italic>= 2 compared to <italic>d </italic>= 200 reduced runtime by about 50% on the Harsimendy <italic>et al</italic>. data. Our software implementation is available on our web site [<xref ref-type="bibr" rid="B30">30</xref>] and as Additional file <xref ref-type="supplementary-material" rid="S17">17</xref> of this article.</p>
    </sec>
  </sec>
  <sec>
    <title>Abbreviations</title>
    <p>FDR: false discovery rate; NGS: next-generation sequencing; PE: paired-end; RPL: ribosomal protein loci; SE: single-end; SNP: single nucleotide polymorphism; TPR: true positive rate.</p>
  </sec>
  <sec>
    <title>Authors' contributions</title>
    <p>JK conceived and developed the model; DS implemented the model and performed the experiments and analysis. DS and JK wrote the paper. Both authors have read and approved the final manuscript for publication.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material content-type="local-data" id="S1">
      <caption>
        <title>Additional file 1</title>
        <p><bold>Texts S1 to S4</bold>. Text S1: description of the analysis of repetitive elements contributing to non-unique alignments. Text S2: details of our Bayesian probability model for SNP detection. Text S3: performance estimates based on comparison to the Sanger validated data set reported in Harsimendy <italic>et al</italic>. [<xref ref-type="bibr" rid="B9">9</xref>]. Text S4: performance estimates obtained when varying the expected base-call sequencing error rate parameter compared to actual error rate.</p>
      </caption>
      <media xlink:href="gb-2011-12-6-r55-S1.PDF" mimetype="application" mime-subtype="pdf">
        <caption>
          <p>Click here for file</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="S2">
      <caption>
        <title>Additional file 2</title>
        <p><bold>Figure S1 - simulated paired-end read multiplicity distributions for the human genome</bold>. The number of valid alignments against the <italic>Homo sapiens </italic>genome is reported as a proportion of the 2 × 10<sup>6 </sup>randomly sampled PE reads used in alignment, varying fragment length (250, 500, 750, or 1,000 nucleotides) and read length (30, 60, 90, or 120 nucleotides). The proportion of read multiplicity averaged over reads of the same length is shown in each figure.</p>
      </caption>
      <media xlink:href="gb-2011-12-6-r55-S2.PDF" mimetype="application" mime-subtype="pdf">
        <caption>
          <p>Click here for file</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="S3">
      <caption>
        <title>Additional file 3</title>
        <p><bold>Table S1 - redundancy structure analysis for human NGS data</bold>. This Excel file describes the number of reads and number of alignments for each read map type (unique (UNI), best-guess (BEST), and total max-<italic>d </italic>(ALL)) associated with the human genome.</p>
      </caption>
      <media xlink:href="gb-2011-12-6-r55-S3.XLS" mimetype="application" mime-subtype="vnd.ms-excel">
        <caption>
          <p>Click here for file</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="S4">
      <caption>
        <title>Additional file 4</title>
        <p><bold>Figure S2 - examples of false read mapping</bold>. False read mapping occurs when a sequenced read is incorrectly aligned to its reference sequence (that is, to the incorrect location in the genome). This is most likely to occur in the presence of closely related sequences existing in replicate in the reference sequence and can result from either <bold>(a) </bold>SNP occurrence or <bold>(b) </bold>base-call sequencing error in the sample genome, such that the similarity between reads containing a variant (or false) allele and the reference genome decreases at one locus and increases at another (false) locus. Instances of false mapping consequently decrease the chance of a SNP call at a true locus and increase the chance of a false SNP call at the wrong locus.</p>
      </caption>
      <media xlink:href="gb-2011-12-6-r55-S4.PDF" mimetype="application" mime-subtype="pdf">
        <caption>
          <p>Click here for file</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="S5">
      <caption>
        <title>Additional file 5</title>
        <p><bold>Table S2 - complete spurious mapping statistics</bold>. This Excel file contains read map statistics for reads that overlap SNP loci.</p>
      </caption>
      <media xlink:href="gb-2011-12-6-r55-S5.XLS" mimetype="application" mime-subtype="vnd.ms-excel">
        <caption>
          <p>Click here for file</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="S6">
      <caption>
        <title>Additional file 6</title>
        <p><bold>Figure S3 - relationship between posterior probability and read degeneracy</bold>. Box and whisker plots showing the distribution of posterior probabilities Q (stringency) for all SNPs identified in each of five replicates for two different simulations (ribosomal protein loci (RPL) and 2 × RPL + 10%), grouped by per-locus degeneracy. For example, the 0 ≤ &lt;<italic>d </italic>&lt; 0.1 group contains loci with at least a 1/10 ratio of alignments at another locus versus alignments overlapping the locus of interest. Box plots represent the entire distribution of Q values for each degeneracy bin, where the red line indicates median and the box indicates the 25th and 75th percentiles. SNPs were obtained using the 25-fold coverage simulations allowing <italic>k </italic>≤ 1 mismatch.</p>
      </caption>
      <media xlink:href="gb-2011-12-6-r55-S6.PDF" mimetype="application" mime-subtype="pdf">
        <caption>
          <p>Click here for file</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="S7">
      <caption>
        <title>Additional file 7</title>
        <p><bold>Figure S4 - per-locus distributions of degeneracy</bold>. Cumulative distributions of per-locus degeneracy are shown for each of the six reference genomic DNA templates used in this study. Degeneracy is defined as the ratio of <italic>d</italic>, the number of alignments for a read that overlap loci other than the locus of interest, to the read depth at a locus of interest. (Alternatively, Alignments/Reads - 1.) For example, a ratio of 1 indicates that every read overlapping the locus of interest has two valid alignments in the reference genome. Loci are binned into 12 groups and the cumulative frequency of all loci is reported at each degeneracy group. Estimates are shown using the ALL read map with <italic>k </italic>= 1, 2, and 3 mismatches.</p>
      </caption>
      <media xlink:href="gb-2011-12-6-r55-S7.PDF" mimetype="application" mime-subtype="pdf">
        <caption>
          <p>Click here for file</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="S8">
      <caption>
        <title>Additional file 8</title>
        <p><bold>Table S3 - complete statistics for human genotyping performance comparison</bold>. This file contains performance statistics based on the Harsimendy <italic>et al</italic>. [<xref ref-type="bibr" rid="B9">9</xref>] human data set for Sniper, Maq, and SOAPsnp at different stringency levels for ALL, UNI, and BEST read map types; total SNP loci identified; and putative novel SNPs identified by Sniper. For each program and read map approach, genotypes for four individuals were compared to those determined by ABI Sanger sequencing. The benchmark set (Sanger \ NGS) contains 253 SNPs. True positive rates (TPRs) and false discovery error rates (FDRs) were estimated from these comparisons (top rows). In parentheses, from left to right: matching genotypes; positions identified as SNP but differing in genotype; SNPs not identified by Sanger; Sanger SNPs not identified by program. Sniper SNPs are reported using a stringency threshold on the phred-like posterior probability: Q = -10 log<sub>10</sub>(1 - <italic>P</italic>), where Q ≥ 13 (<italic>P </italic>&lt; 0.05). Maq SNPs were generated using Q ≥ 13 minimum consensus quality, Q<sub>adj </sub>≥ 13 minimum adjacent quality, and prior probability of SNP <italic>P<sub>SNP </sub></italic>= 0.001, with default settings otherwise. Soap SNPs were generated using default settings, '-t -u -n', and a 2:1 transition:transversion ratio for prior probability, and <italic>P<sub>SNP </sub></italic>= 0.001. Four SNPs are predicted by Sniper, Maq, and SOAPsnp for <italic>k </italic>= 2 mismatches, identified by comparison to Sanger benchmark data (Additional file 8). Statistics were generated using Sniper.</p>
      </caption>
      <media xlink:href="gb-2011-12-6-r55-S8.XLS" mimetype="application" mime-subtype="vnd.ms-excel">
        <caption>
          <p>Click here for file</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="S9">
      <caption>
        <title>Additional file 9</title>
        <p><bold>Table S4 - read map statistics for the Harsimendy <italic>et al</italic>. NGS data set</bold>. This Excel file details our read maps for the Harsimendy <italic>et al</italic>. [<xref ref-type="bibr" rid="B9">9</xref>] human NGS data.</p>
      </caption>
      <media xlink:href="gb-2011-12-6-r55-S9.XLS" mimetype="application" mime-subtype="vnd.ms-excel">
        <caption>
          <p>Click here for file</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="S10">
      <caption>
        <title>Additional file 10</title>
        <p><bold>Figure S5 - human genotyping performance across coverage levels</bold>. Accuracy bar charts and Receiver operating characteristic (ROC)-style curves for human SNP identification at six coverage levels. Reads from one individual (NA17156) were subsampled randomly from the complete approximately 188-fold coverage data in five replicates. Each subsampled read set was independently aligned to the human genome using ALL, UNI, or BEST maps with <italic>k </italic>= 1, 2, or 3 mismatches and genotyped using Sniper. <bold>(a) </bold>Bar charts reporting genotyping accuracy for each condition. Error bars show ± standard error of the mean. <bold>(b) </bold>ROC-style curves are shown as 1 - accuracy versus sensitivity. Three stringency levels (Q ≥ 13, 40, 90) are shown for each curve.</p>
      </caption>
      <media xlink:href="gb-2011-12-6-r55-S10.PDF" mimetype="application" mime-subtype="pdf">
        <caption>
          <p>Click here for file</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="S11">
      <caption>
        <title>Additional file 11</title>
        <p><bold>Figure S6 - simulation negative control. (a) </bold>Accuracy bar charts and <bold>(b) </bold>ROC-style curves showing performance of ALL, UNI, and BEST maps on our negative control synthetic DNA template (2 × RPL +0%). Five unknown sample genomes were generated from each reference template by adding SNPs randomly to a proportion of 0.001. Read sets were sampled from each sample genome to one of four coverage levels (25-fold, 50-fold, 100-fold, 200-fold). Read sets were independently aligned to their respective reference genome using ALL, UNI, or BEST maps with <italic>k </italic>= 1, 2, or 3 mismatches and genotyped using Sniper. <bold>(a) </bold>Bar charts report genotyping accuracy for each condition. Error bars show ± standard error of the mean over five replicates. <bold>(b) </bold>ROC-style curves are shown as the number of false positive calls versus sensitivity. Three stringency levels for Q (13, 40, 90) are shown for each curve.</p>
      </caption>
      <media xlink:href="gb-2011-12-6-r55-S11.PDF" mimetype="application" mime-subtype="pdf">
        <caption>
          <p>Click here for file</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="S12">
      <caption>
        <title>Additional file 12</title>
        <p><bold>Figure S7 - genotyping accuracy for simulated data</bold>. Bar charts are shown reporting SNP identification accuracy on four synthetic genomic DNA templates (RPL, 2 × RPL +2%, 2 × RPL +5%, 2 × RPL +10%). Five unknown sample genomes were generated from each reference template by adding SNPs randomly to a proportion of 0.001. Read sets were sampled from each sample genome to one of nine coverage levels (4-fold, 10-fold, 25-fold, 32-fold, 50-fold, 75-fold, 100-fold, 150-fold, 200-fold). Read sets were independently aligned to their respective reference genome using ALL, UNI, or BEST maps with <italic>k </italic>= 1, 2, or 3 mismatches and genotyped using Sniper. Error bars show ± standard error of the mean over five replicates.</p>
      </caption>
      <media xlink:href="gb-2011-12-6-r55-S12.PDF" mimetype="application" mime-subtype="pdf">
        <caption>
          <p>Click here for file</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="S13">
      <caption>
        <title>Additional file 13</title>
        <p><bold>Figure S8 - genotyping receiver operating characteristic curves for simulated data sets</bold>. Receiver operating characteristic (ROC)-style curves are shown reporting SNP identification performance on four synthetic genomic DNA templates (RPL, 2 × RPL + 2%, 2 × RPL + 5%, 2 × RPL + 10%). Five unknown sample genomes were generated from each reference template by adding SNPs randomly to a proportion of 0.001. Read sets were sampled from each sample genome to one of nine coverage levels (4-fold, 10-fold, 25-fold, 32-fold, 50-fold, 75-fold, 100-fold, 150-fold, 200-fold). Read sets were independently aligned to their respective reference genome using ALL, UNI, or BEST maps with <italic>k </italic>= 1, 2, or 3 mismatches and genotyped using Sniper. Plots show the number of false positive SNPs plus the number of calls with no read coverage versus sensitivity.</p>
      </caption>
      <media xlink:href="gb-2011-12-6-r55-S13.PDF" mimetype="application" mime-subtype="pdf">
        <caption>
          <p>Click here for file</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="S14">
      <caption>
        <title>Additional file 14</title>
        <p><bold>Figure S9 - genotyping performance for simulated data</bold>. Estimates of true positive rate, false positive rate, and false discovery rate are provided for our four synthetic templates for all mapping strategies and mismatch conditions, based on 50× simulated read sets and genotyped using a Q ≥ 40 stringency cutoff. Estimates for the BESTNO-Q strategy (best no-guess mapping using read quality values for mapping) were based on default Bowtie settings (-n mode with -l 28 -e 70).</p>
      </caption>
      <media xlink:href="gb-2011-12-6-r55-S14.PDF" mimetype="application" mime-subtype="pdf">
        <caption>
          <p>Click here for file</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="S15">
      <caption>
        <title>Additional file 15</title>
        <p><bold>Table S5 - performance estimates under variable sequencing error rates</bold>. This Excel file provides performance estimates as described in Text S4 in Additional file 1.</p>
      </caption>
      <media xlink:href="gb-2011-12-6-r55-S15.XLS" mimetype="application" mime-subtype="vnd.ms-excel">
        <caption>
          <p>Click here for file</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="S16">
      <caption>
        <title>Additional file 16</title>
        <p><bold>Table S6 - comparison of novel Sniper SNPs with the HapMap collection</bold>. This Excel file contains SNP calls and statistics for a HapMap-intersecting subset of the 454 Sniper SNPs not identified by GATK and the 412 SNPs differing in genotype from GATK.</p>
      </caption>
      <media xlink:href="gb-2011-12-6-r55-S16.XLSX" mimetype="application" mime-subtype="vnd.ms-excel">
        <caption>
          <p>Click here for file</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="S17">
      <caption>
        <title>Additional file 17</title>
        <p>Python software implementation of Sniper (version 1.5.8).</p>
      </caption>
      <media xlink:href="gb-2011-12-6-r55-S17.ZIP" mimetype="application" mime-subtype="x-zip-compressed">
        <caption>
          <p>Click here for file</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <sec>
    <title>Acknowledgements</title>
    <p>We wish to acknowledge Samuel Levy for sharing human NGS data and members of the Kim lab for helpful advice. DS would like to offer special thanks to Nancy Cox for graciously supporting his postdoctoral training. This work was supported by a HRFF grant to University of Pennsylvania from the Pennsylvania Common Wealth and by the Penn Genome Frontiers Institute and a grant with the Pennsylvania Department of Health. The Department of Health specifically disclaims responsibility for any analyses, interpretations, or conclusions.</p>
  </sec>
  <ref-list>
    <ref id="B1">
      <mixed-citation publication-type="journal">
        <collab>The 1000 Genomes Project Consortium</collab>
        <article-title>A map of human genome variation from population-scale sequencing.</article-title>
        <source>Nature</source>
        <year>2010</year>
        <volume>467</volume>
        <fpage>1061</fpage>
        <lpage>1073</lpage>
        <pub-id pub-id-type="doi">10.1038/nature09534</pub-id>
        <pub-id pub-id-type="pmid">20981092</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B2">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Lynch</surname>
          <given-names>M</given-names>
        </name>
        <name>
          <surname>Sung</surname>
          <given-names>W</given-names>
        </name>
        <name>
          <surname>Morris</surname>
          <given-names>K</given-names>
        </name>
        <name>
          <surname>Coffey</surname>
          <given-names>N</given-names>
        </name>
        <name>
          <surname>Landry</surname>
          <given-names>CR</given-names>
        </name>
        <name>
          <surname>Dopman</surname>
          <given-names>EB</given-names>
        </name>
        <name>
          <surname>Dickinson</surname>
          <given-names>WJ</given-names>
        </name>
        <name>
          <surname>Okamoto</surname>
          <given-names>K</given-names>
        </name>
        <name>
          <surname>Kulkarni</surname>
          <given-names>S</given-names>
        </name>
        <name>
          <surname>Hartl</surname>
          <given-names>DL</given-names>
        </name>
        <name>
          <surname>Thomas</surname>
          <given-names>WK</given-names>
        </name>
        <article-title>A genome-wide view of the spectrum of spontaneous mutations in yeast.</article-title>
        <source>Proc Natl Acad Sci USA</source>
        <year>2008</year>
        <volume>105</volume>
        <fpage>9272</fpage>
        <lpage>9277</lpage>
        <pub-id pub-id-type="doi">10.1073/pnas.0803466105</pub-id>
        <pub-id pub-id-type="pmid">18583475</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B3">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Ruiqiang</surname>
          <given-names>L</given-names>
        </name>
        <name>
          <surname>Yingrui</surname>
          <given-names>L</given-names>
        </name>
        <name>
          <surname>Xiaodong</surname>
          <given-names>F</given-names>
        </name>
        <name>
          <surname>Yang</surname>
          <given-names>H</given-names>
        </name>
        <name>
          <surname>Wang</surname>
          <given-names>J</given-names>
        </name>
        <name>
          <surname>Kristiansen</surname>
          <given-names>K</given-names>
        </name>
        <name>
          <surname>Wang</surname>
          <given-names>J</given-names>
        </name>
        <article-title>SNP detection for massively parallel whole-genome resequencing.</article-title>
        <source>Genome Res</source>
        <year>2009</year>
        <volume>19</volume>
        <fpage>1124</fpage>
        <lpage>1132</lpage>
        <pub-id pub-id-type="doi">10.1101/gr.088013.108</pub-id>
        <pub-id pub-id-type="pmid">19420381</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B4">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Li</surname>
          <given-names>H</given-names>
        </name>
        <name>
          <surname>Ruan</surname>
          <given-names>J</given-names>
        </name>
        <name>
          <surname>Durbin</surname>
          <given-names>R</given-names>
        </name>
        <article-title>Mapping short DNA sequencing reads and calling variants using mapping quality scores.</article-title>
        <source>Genome Res</source>
        <year>2008</year>
        <volume>18</volume>
        <fpage>1851</fpage>
        <lpage>1858</lpage>
        <pub-id pub-id-type="doi">10.1101/gr.078212.108</pub-id>
        <pub-id pub-id-type="pmid">18714091</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B5">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Brockman</surname>
          <given-names>W</given-names>
        </name>
        <name>
          <surname>Alvarez</surname>
          <given-names>P</given-names>
        </name>
        <name>
          <surname>Young</surname>
          <given-names>S</given-names>
        </name>
        <name>
          <surname>Garber</surname>
          <given-names>M</given-names>
        </name>
        <name>
          <surname>Giannoukos</surname>
          <given-names>G</given-names>
        </name>
        <name>
          <surname>Lee</surname>
          <given-names>WL</given-names>
        </name>
        <name>
          <surname>Russ</surname>
          <given-names>C</given-names>
        </name>
        <name>
          <surname>Lander</surname>
          <given-names>ES</given-names>
        </name>
        <name>
          <surname>Nusbaum</surname>
          <given-names>C</given-names>
        </name>
        <name>
          <surname>Jaffe</surname>
          <given-names>DB</given-names>
        </name>
        <article-title>Quality scores and SNP detection in sequencing-by-synthesis systems.</article-title>
        <source>Genome Res</source>
        <year>2008</year>
        <volume>18</volume>
        <fpage>763</fpage>
        <lpage>770</lpage>
        <pub-id pub-id-type="doi">10.1101/gr.070227.107</pub-id>
        <pub-id pub-id-type="pmid">18212088</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B6">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Shen</surname>
          <given-names>Y</given-names>
        </name>
        <name>
          <surname>Wan</surname>
          <given-names>Z</given-names>
        </name>
        <name>
          <surname>Coarfa</surname>
          <given-names>C</given-names>
        </name>
        <name>
          <surname>Drabek</surname>
          <given-names>R</given-names>
        </name>
        <name>
          <surname>Chen</surname>
          <given-names>L</given-names>
        </name>
        <name>
          <surname>Ostrowski</surname>
          <given-names>EA</given-names>
        </name>
        <name>
          <surname>Liu</surname>
          <given-names>Y</given-names>
        </name>
        <name>
          <surname>Weinstock</surname>
          <given-names>GM</given-names>
        </name>
        <name>
          <surname>Wheeler</surname>
          <given-names>DA</given-names>
        </name>
        <name>
          <surname>Gibbs</surname>
          <given-names>RA</given-names>
        </name>
        <name>
          <surname>Yu</surname>
          <given-names>F</given-names>
        </name>
        <article-title>A SNP discovery method to assess variant allele probability from next-generation resequencing data.</article-title>
        <source>Genome Res</source>
        <year>2010</year>
        <volume>20</volume>
        <fpage>273</fpage>
        <lpage>280</lpage>
        <pub-id pub-id-type="doi">10.1101/gr.096388.109</pub-id>
        <pub-id pub-id-type="pmid">20019143</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B7">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Hoberman</surname>
          <given-names>R</given-names>
        </name>
        <name>
          <surname>Dias</surname>
          <given-names>J</given-names>
        </name>
        <name>
          <surname>Ge</surname>
          <given-names>B</given-names>
        </name>
        <name>
          <surname>Harmsen</surname>
          <given-names>E</given-names>
        </name>
        <name>
          <surname>Mayhew</surname>
          <given-names>M</given-names>
        </name>
        <name>
          <surname>Verlaan</surname>
          <given-names>DJ</given-names>
        </name>
        <name>
          <surname>Kwan</surname>
          <given-names>T</given-names>
        </name>
        <name>
          <surname>Dewar</surname>
          <given-names>K</given-names>
        </name>
        <name>
          <surname>Blanchette</surname>
          <given-names>M</given-names>
        </name>
        <name>
          <surname>Pastinen</surname>
          <given-names>T</given-names>
        </name>
        <article-title>A probabilistic approach for SNP discovery in high-throughput human resequencing data.</article-title>
        <source>Genome Res</source>
        <year>2009</year>
        <volume>19</volume>
        <fpage>1542</fpage>
        <lpage>1552</lpage>
        <pub-id pub-id-type="doi">10.1101/gr.092072.109</pub-id>
        <pub-id pub-id-type="pmid">19605794</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B8">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Malhis</surname>
          <given-names>N</given-names>
        </name>
        <name>
          <surname>Jones</surname>
          <given-names>SJM</given-names>
        </name>
        <article-title>High quality SNP calling using Illumina data at shallow coverage.</article-title>
        <source>Bioinformatics</source>
        <year>2010</year>
        <volume>26</volume>
        <fpage>1029</fpage>
        <lpage>1035</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btq092</pub-id>
        <pub-id pub-id-type="pmid">20190250</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B9">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Harismendy</surname>
          <given-names>O</given-names>
        </name>
        <name>
          <surname>Ng</surname>
          <given-names>PC</given-names>
        </name>
        <name>
          <surname>Strausberg</surname>
          <given-names>RL</given-names>
        </name>
        <name>
          <surname>Wang</surname>
          <given-names>X</given-names>
        </name>
        <name>
          <surname>Stockwell</surname>
          <given-names>TB</given-names>
        </name>
        <name>
          <surname>Beeson</surname>
          <given-names>KY</given-names>
        </name>
        <name>
          <surname>Schork</surname>
          <given-names>NJ</given-names>
        </name>
        <name>
          <surname>Murray</surname>
          <given-names>SS</given-names>
        </name>
        <name>
          <surname>Topol</surname>
          <given-names>EJ</given-names>
        </name>
        <name>
          <surname>Levy</surname>
          <given-names>S</given-names>
        </name>
        <name>
          <surname>Frazer</surname>
          <given-names>KA</given-names>
        </name>
        <article-title>Evaluation of next generation sequencing platforms for population targeted sequencing studies.</article-title>
        <source>Genome Biol</source>
        <year>2009</year>
        <volume>10</volume>
        <fpage>R32</fpage>
        <pub-id pub-id-type="doi">10.1186/gb-2009-10-3-r32</pub-id>
        <pub-id pub-id-type="pmid">19327155</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B10">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Beckmann</surname>
          <given-names>J</given-names>
        </name>
        <name>
          <surname>Weber</surname>
          <given-names>J</given-names>
        </name>
        <article-title>Survey of human and rat microsatellites.</article-title>
        <source>Genomics</source>
        <year>1992</year>
        <volume>12</volume>
        <fpage>627</fpage>
        <lpage>631</lpage>
        <pub-id pub-id-type="doi">10.1016/0888-7543(92)90285-Z</pub-id>
        <pub-id pub-id-type="pmid">1572635</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B11">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Kazazian</surname>
          <given-names>HH</given-names>
          <suffix>Jr</suffix>
        </name>
        <article-title>Mobile elements: drivers of genome evolution.</article-title>
        <source>Science</source>
        <year>2004</year>
        <volume>303</volume>
        <fpage>1626</fpage>
        <lpage>1632</lpage>
        <pub-id pub-id-type="doi">10.1126/science.1089670</pub-id>
        <pub-id pub-id-type="pmid">15016989</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B12">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Wheelan</surname>
          <given-names>SJ</given-names>
        </name>
        <name>
          <surname>Marchler-Bauer</surname>
          <given-names>A</given-names>
        </name>
        <name>
          <surname>Bryant</surname>
          <given-names>SH</given-names>
        </name>
        <article-title>Domain size distributions can predict domain boundaries.</article-title>
        <source>Bioinformatics</source>
        <year>2000</year>
        <volume>16</volume>
        <fpage>613</fpage>
        <lpage>618</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/16.7.613</pub-id>
        <pub-id pub-id-type="pmid">11038331</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B13">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Imanishi</surname>
          <given-names>T</given-names>
        </name>
        <name>
          <surname>Itoh</surname>
          <given-names>T</given-names>
        </name>
        <name>
          <surname>Suzuki</surname>
          <given-names>Y</given-names>
        </name>
        <name>
          <surname>O'Donovan</surname>
          <given-names>C</given-names>
        </name>
        <name>
          <surname>Fukuchi</surname>
          <given-names>S</given-names>
        </name>
        <name>
          <surname>Koyanagi</surname>
          <given-names>KO</given-names>
        </name>
        <name>
          <surname>Barrero</surname>
          <given-names>RA</given-names>
        </name>
        <name>
          <surname>Tamura</surname>
          <given-names>T</given-names>
        </name>
        <name>
          <surname>Yamaguchi-Kabata</surname>
          <given-names>Y</given-names>
        </name>
        <name>
          <surname>Tanino</surname>
          <given-names>M</given-names>
        </name>
        <name>
          <surname>Yura</surname>
          <given-names>K</given-names>
        </name>
        <name>
          <surname>Miyazaki</surname>
          <given-names>S</given-names>
        </name>
        <name>
          <surname>Ikeo</surname>
          <given-names>K</given-names>
        </name>
        <name>
          <surname>Homma</surname>
          <given-names>K</given-names>
        </name>
        <name>
          <surname>Kasprzyk</surname>
          <given-names>A</given-names>
        </name>
        <name>
          <surname>Nishikawa</surname>
          <given-names>T</given-names>
        </name>
        <name>
          <surname>Hirakawa</surname>
          <given-names>M</given-names>
        </name>
        <name>
          <surname>Thierry-Mieg</surname>
          <given-names>J</given-names>
        </name>
        <name>
          <surname>Thierry-Mieg</surname>
          <given-names>D</given-names>
        </name>
        <name>
          <surname>Ashurst</surname>
          <given-names>J</given-names>
        </name>
        <name>
          <surname>Jia</surname>
          <given-names>L</given-names>
        </name>
        <name>
          <surname>Nakao</surname>
          <given-names>M</given-names>
        </name>
        <name>
          <surname>Thomas</surname>
          <given-names>MA</given-names>
        </name>
        <name>
          <surname>Mulder</surname>
          <given-names>N</given-names>
        </name>
        <name>
          <surname>Karavidopoulou</surname>
          <given-names>Y</given-names>
        </name>
        <name>
          <surname>Jin</surname>
          <given-names>L</given-names>
        </name>
        <name>
          <surname>Kim</surname>
          <given-names>S</given-names>
        </name>
        <name>
          <surname>Yasuda</surname>
          <given-names>T</given-names>
        </name>
        <name>
          <surname>Lenhard</surname>
          <given-names>B</given-names>
        </name>
        <name>
          <surname>Eveno</surname>
          <given-names>E</given-names>
        </name>
        <etal/>
        <article-title>Integrative annotation of 21,037 human genes validated by full-length cDNA clones.</article-title>
        <source>PLoS Biol</source>
        <year>2004</year>
        <volume>2</volume>
        <fpage>e162</fpage>
        <pub-id pub-id-type="doi">10.1371/journal.pbio.0020162</pub-id>
        <pub-id pub-id-type="pmid">15103394</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B14">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Batzer</surname>
          <given-names>M</given-names>
        </name>
        <name>
          <surname>Deininger</surname>
          <given-names>PL</given-names>
        </name>
        <article-title>Alu repeats and human genomic diversity.</article-title>
        <source>Nat Rev Genet</source>
        <year>2002</year>
        <volume>3</volume>
        <fpage>370</fpage>
        <lpage>379</lpage>
        <pub-id pub-id-type="doi">10.1038/nrg798</pub-id>
        <pub-id pub-id-type="pmid">11988762</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B15">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Lowe</surname>
          <given-names>CB</given-names>
        </name>
        <name>
          <surname>Bejerano</surname>
          <given-names>G</given-names>
        </name>
        <name>
          <surname>Haussler</surname>
          <given-names>D</given-names>
        </name>
        <article-title>Thousands of human mobile element fragments undergo strong purifying selection near developmental genes.</article-title>
        <source>Proc Natl Acad Sci USA</source>
        <year>2007</year>
        <volume>104</volume>
        <fpage>8005</fpage>
        <lpage>8010</lpage>
        <pub-id pub-id-type="doi">10.1073/pnas.0611223104</pub-id>
        <pub-id pub-id-type="pmid">17463089</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B16">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Deininger</surname>
          <given-names>PL</given-names>
        </name>
        <name>
          <surname>Batzer</surname>
          <given-names>M</given-names>
        </name>
        <article-title>Alu repeats and human disease.</article-title>
        <source>Mol Genet Metab</source>
        <year>1999</year>
        <volume>67</volume>
        <fpage>183</fpage>
        <lpage>193</lpage>
        <pub-id pub-id-type="doi">10.1006/mgme.1999.2864</pub-id>
        <pub-id pub-id-type="pmid">10381326</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B17">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Koehler</surname>
          <given-names>R</given-names>
        </name>
        <name>
          <surname>Issac</surname>
          <given-names>H</given-names>
        </name>
        <name>
          <surname>Cloonan</surname>
          <given-names>N</given-names>
        </name>
        <name>
          <surname>Grimmond</surname>
          <given-names>SM</given-names>
        </name>
        <article-title>The uniqueome: a mappability resource for short-tag sequencing.</article-title>
        <source>Bioinformatics</source>
        <year>2011</year>
        <volume>27</volume>
        <fpage>272</fpage>
        <lpage>274</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btq640</pub-id>
        <pub-id pub-id-type="pmid">21075741</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B18">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Planta</surname>
          <given-names>R</given-names>
        </name>
        <name>
          <surname>Mager</surname>
          <given-names>WH</given-names>
        </name>
        <article-title>The list of cytoplasmic ribosomal proteins of Saccharomyces cerevisiae.</article-title>
        <source>Yeast</source>
        <year>1998</year>
        <volume>14</volume>
        <fpage>471</fpage>
        <lpage>477</lpage>
        <pub-id pub-id-type="doi">10.1002/(SICI)1097-0061(19980330)14:5&lt;471::AID-YEA241&gt;3.0.CO;2-U</pub-id>
        <pub-id pub-id-type="pmid">9559554</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B19">
      <mixed-citation publication-type="journal">
        <name>
          <surname>McKenna</surname>
          <given-names>A</given-names>
        </name>
        <name>
          <surname>Hanna</surname>
          <given-names>M</given-names>
        </name>
        <name>
          <surname>Banks</surname>
          <given-names>E</given-names>
        </name>
        <name>
          <surname>Sivachenko</surname>
          <given-names>A</given-names>
        </name>
        <name>
          <surname>Cibulskis</surname>
          <given-names>K</given-names>
        </name>
        <name>
          <surname>Kernytsky</surname>
          <given-names>A</given-names>
        </name>
        <name>
          <surname>Garimella</surname>
          <given-names>K</given-names>
        </name>
        <name>
          <surname>Altshuler</surname>
          <given-names>D</given-names>
        </name>
        <name>
          <surname>Gabriel</surname>
          <given-names>S</given-names>
        </name>
        <name>
          <surname>Daly</surname>
          <given-names>M</given-names>
        </name>
        <name>
          <surname>DePristo</surname>
          <given-names>MA</given-names>
        </name>
        <article-title>The Genome Analysis Toolkit: A MapReduce framework for analyzing next-generation DNA sequencing data.</article-title>
        <source>Genome Res</source>
        <year>2010</year>
        <volume>20</volume>
        <fpage>1297</fpage>
        <lpage>1303</lpage>
        <pub-id pub-id-type="doi">10.1101/gr.107524.110</pub-id>
        <pub-id pub-id-type="pmid">20644199</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B20">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Li</surname>
          <given-names>H</given-names>
        </name>
        <name>
          <surname>Handsaker</surname>
          <given-names>B</given-names>
        </name>
        <name>
          <surname>Wysoker</surname>
          <given-names>A</given-names>
        </name>
        <name>
          <surname>Fennell</surname>
          <given-names>T</given-names>
        </name>
        <name>
          <surname>Ruan</surname>
          <given-names>J</given-names>
        </name>
        <name>
          <surname>Homer</surname>
          <given-names>N</given-names>
        </name>
        <name>
          <surname>Marth</surname>
          <given-names>G</given-names>
        </name>
        <name>
          <surname>Abecassis</surname>
          <given-names>G</given-names>
        </name>
        <name>
          <surname>Durbin</surname>
          <given-names>R</given-names>
        </name>
        <article-title>The Sequence Alignment/Map format and SAMtools.</article-title>
        <source>Bioinformatics</source>
        <year>2009</year>
        <volume>25</volume>
        <fpage>2078</fpage>
        <lpage>2079</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btp352</pub-id>
        <pub-id pub-id-type="pmid">19505943</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B21">
      <mixed-citation publication-type="journal">
        <collab>The International HapMap Consortium</collab>
        <article-title>A second generation human haplotype map of over 3.1 million SNPs.</article-title>
        <source>Nature</source>
        <year>2007</year>
        <volume>449</volume>
        <fpage>851</fpage>
        <lpage>861</lpage>
        <pub-id pub-id-type="doi">10.1038/nature06258</pub-id>
        <pub-id pub-id-type="pmid">17943122</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B22">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Le</surname>
          <given-names>SQ</given-names>
        </name>
        <name>
          <surname>Durbin</surname>
          <given-names>R</given-names>
        </name>
        <article-title>SNP detection and genotyping from low-coverage sequencing data on multiple diploid samples.</article-title>
        <source>Genome Res</source>
        <year>2010</year>
        <volume>21</volume>
        <fpage>1</fpage>
        <lpage>9</lpage>
        <pub-id pub-id-type="pmid">21147912</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B23">
      <mixed-citation publication-type="other">
        <article-title>1000 genomes database.</article-title>
        <ext-link ext-link-type="ftp" xlink:href="ftp://ftp-trace.ncbi.nih.gov/1000genomes/">ftp://ftp-trace.ncbi.nih.gov/1000genomes/</ext-link>
      </mixed-citation>
    </ref>
    <ref id="B24">
      <mixed-citation publication-type="other">
        <article-title>NCBI hg18/v36 human genome.</article-title>
        <ext-link ext-link-type="ftp" xlink:href="ftp://hgdownload.cse.ucsc.edu/goldenPath/hg18/chromosomes">ftp://hgdownload.cse.ucsc.edu/goldenPath/hg18/chromosomes</ext-link>
      </mixed-citation>
    </ref>
    <ref id="B25">
      <mixed-citation publication-type="other">
        <article-title>NA19240 1000 genomes genotypes.</article-title>
        <ext-link ext-link-type="ftp" xlink:href="ftp://ftp-trace.ncbi.nih.gov/1000genomes/ftp/pilot_data/release/2010_07/trio/snps/YRI.trio.2010_03.genotypes.vcf.gz">ftp://ftp-trace.ncbi.nih.gov/1000genomes/ftp/pilot_data/release/2010_07/trio/snps/YRI.trio.2010_03.genotypes.vcf.gz</ext-link>
      </mixed-citation>
    </ref>
    <ref id="B26">
      <mixed-citation publication-type="other">
        <article-title>HapMap Database.</article-title>
        <ext-link ext-link-type="uri" xlink:href="http://hapmap.ncbi.nlm.nih.gov/downloads/genotypes/2010-08_phaseII+III/">http://hapmap.ncbi.nlm.nih.gov/downloads/genotypes/2010-08_phaseII+III/</ext-link>
      </mixed-citation>
    </ref>
    <ref id="B27">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Langmead</surname>
          <given-names>B</given-names>
        </name>
        <name>
          <surname>Trapnell</surname>
          <given-names>C</given-names>
        </name>
        <name>
          <surname>Pop</surname>
          <given-names>M</given-names>
        </name>
        <name>
          <surname>Salzberg</surname>
          <given-names>SL</given-names>
        </name>
        <article-title>Ultrafast and memory-efficient alignment of short DNA sequences to the human genome.</article-title>
        <source>Genome Biol</source>
        <year>2009</year>
        <volume>10</volume>
        <fpage>R25</fpage>
        <pub-id pub-id-type="doi">10.1186/gb-2009-10-3-r25</pub-id>
        <pub-id pub-id-type="pmid">19261174</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B28">
      <mixed-citation publication-type="other">
        <article-title>dbSNP Database.</article-title>
        <ext-link ext-link-type="uri" xlink:href="http://www.ncbi.nlm.nih.gov/projects/SNP">http://www.ncbi.nlm.nih.gov/projects/SNP</ext-link>
      </mixed-citation>
    </ref>
    <ref id="B29">
      <mixed-citation publication-type="other">
        <article-title>Sun Grid Engine.</article-title>
        <ext-link ext-link-type="uri" xlink:href="http://wikis.sun.com/display/GridEngine/Home">http://wikis.sun.com/display/GridEngine/Home</ext-link>
      </mixed-citation>
    </ref>
    <ref id="B30">
      <mixed-citation publication-type="other">
        <article-title>Sniper.</article-title>
        <ext-link ext-link-type="uri" xlink:href="http://kim.bio.upenn.edu/software/sniper.shtml">http://kim.bio.upenn.edu/software/sniper.shtml</ext-link>
      </mixed-citation>
    </ref>
  </ref-list>
</back>
