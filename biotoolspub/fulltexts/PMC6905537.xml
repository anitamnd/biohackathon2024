<?properties open_access?>
<?subarticle pone.0219235.r001?>
<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.1d3 20150301//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 39.96?>
<?ConverterInfo.XSLTName jp2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">PLoS One</journal-id>
    <journal-id journal-id-type="iso-abbrev">PLoS ONE</journal-id>
    <journal-id journal-id-type="publisher-id">plos</journal-id>
    <journal-id journal-id-type="pmc">plosone</journal-id>
    <journal-title-group>
      <journal-title>PLoS ONE</journal-title>
    </journal-title-group>
    <issn pub-type="epub">1932-6203</issn>
    <publisher>
      <publisher-name>Public Library of Science</publisher-name>
      <publisher-loc>San Francisco, CA USA</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">6905537</article-id>
    <article-id pub-id-type="doi">10.1371/journal.pone.0219235</article-id>
    <article-id pub-id-type="publisher-id">PONE-D-19-17255</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Research Article</subject>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Genetics</subject>
          <subj-group>
            <subject>Genomics</subject>
            <subj-group>
              <subject>Metagenomics</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and life sciences</subject>
        <subj-group>
          <subject>Biochemistry</subject>
          <subj-group>
            <subject>Nucleic acids</subject>
            <subj-group>
              <subject>RNA</subject>
              <subj-group>
                <subject>Non-coding RNA</subject>
                <subj-group>
                  <subject>Ribosomal RNA</subject>
                </subj-group>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and life sciences</subject>
        <subj-group>
          <subject>Biochemistry</subject>
          <subj-group>
            <subject>Ribosomes</subject>
            <subj-group>
              <subject>Ribosomal RNA</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and life sciences</subject>
        <subj-group>
          <subject>Cell biology</subject>
          <subj-group>
            <subject>Cellular structures and organelles</subject>
            <subj-group>
              <subject>Ribosomes</subject>
              <subj-group>
                <subject>Ribosomal RNA</subject>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Microbiology</subject>
          <subj-group>
            <subject>Medical Microbiology</subject>
            <subj-group>
              <subject>Microbiome</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Genetics</subject>
          <subj-group>
            <subject>Genomics</subject>
            <subj-group>
              <subject>Microbial Genomics</subject>
              <subj-group>
                <subject>Microbiome</subject>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Microbiology</subject>
          <subj-group>
            <subject>Microbial Genomics</subject>
            <subj-group>
              <subject>Microbiome</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Taxonomy</subject>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Computer and Information Sciences</subject>
        <subj-group>
          <subject>Data Management</subject>
          <subj-group>
            <subject>Taxonomy</subject>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Computational Biology</subject>
          <subj-group>
            <subject>Genome Analysis</subject>
            <subj-group>
              <subject>Gene Prediction</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Genetics</subject>
          <subj-group>
            <subject>Genomics</subject>
            <subj-group>
              <subject>Genome Analysis</subject>
              <subj-group>
                <subject>Gene Prediction</subject>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and life sciences</subject>
        <subj-group>
          <subject>Molecular biology</subject>
          <subj-group>
            <subject>Molecular biology techniques</subject>
            <subj-group>
              <subject>Cloning</subject>
              <subj-group>
                <subject>DNA cloning</subject>
                <subj-group>
                  <subject>Shotgun Sequencing</subject>
                </subj-group>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Research and analysis methods</subject>
        <subj-group>
          <subject>Molecular biology techniques</subject>
          <subj-group>
            <subject>Cloning</subject>
            <subj-group>
              <subject>DNA cloning</subject>
              <subj-group>
                <subject>Shotgun Sequencing</subject>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Molecular Biology</subject>
          <subj-group>
            <subject>Molecular Biology Techniques</subject>
            <subj-group>
              <subject>Sequencing Techniques</subject>
              <subj-group>
                <subject>Shotgun Sequencing</subject>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Research and Analysis Methods</subject>
        <subj-group>
          <subject>Molecular Biology Techniques</subject>
          <subj-group>
            <subject>Sequencing Techniques</subject>
            <subj-group>
              <subject>Shotgun Sequencing</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Taxonomy</subject>
          <subj-group>
            <subject>Microbial Taxonomy</subject>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Computer and Information Sciences</subject>
        <subj-group>
          <subject>Data Management</subject>
          <subj-group>
            <subject>Taxonomy</subject>
            <subj-group>
              <subject>Microbial Taxonomy</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Medicine and Health Sciences</subject>
        <subj-group>
          <subject>Clinical Medicine</subject>
          <subj-group>
            <subject>Clinical Immunology</subject>
            <subj-group>
              <subject>Autoimmune Diseases</subject>
              <subj-group>
                <subject>Crohn's Disease</subject>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Immunology</subject>
          <subj-group>
            <subject>Clinical Immunology</subject>
            <subj-group>
              <subject>Autoimmune Diseases</subject>
              <subj-group>
                <subject>Crohn's Disease</subject>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Medicine and Health Sciences</subject>
        <subj-group>
          <subject>Immunology</subject>
          <subj-group>
            <subject>Clinical Immunology</subject>
            <subj-group>
              <subject>Autoimmune Diseases</subject>
              <subj-group>
                <subject>Crohn's Disease</subject>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Medicine and Health Sciences</subject>
        <subj-group>
          <subject>Gastroenterology and Hepatology</subject>
          <subj-group>
            <subject>Inflammatory Bowel Disease</subject>
            <subj-group>
              <subject>Crohn's Disease</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Exploring thematic structure and predicted functionality of 16S rRNA amplicon data</article-title>
      <alt-title alt-title-type="running-head">Thematic structure of 16S rRNA amplicon data</alt-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0003-0568-298X</contrib-id>
        <name>
          <surname>Woloszynek</surname>
          <given-names>Stephen</given-names>
        </name>
        <role content-type="http://credit.casrai.org/">Conceptualization</role>
        <role content-type="http://credit.casrai.org/">Data curation</role>
        <role content-type="http://credit.casrai.org/">Formal analysis</role>
        <role content-type="http://credit.casrai.org/">Investigation</role>
        <role content-type="http://credit.casrai.org/">Methodology</role>
        <role content-type="http://credit.casrai.org/">Software</role>
        <role content-type="http://credit.casrai.org/">Supervision</role>
        <role content-type="http://credit.casrai.org/">Validation</role>
        <role content-type="http://credit.casrai.org/">Visualization</role>
        <role content-type="http://credit.casrai.org/">Writing – original draft</role>
        <role content-type="http://credit.casrai.org/">Writing – review &amp; editing</role>
        <xref ref-type="aff" rid="aff001">
          <sup>1</sup>
        </xref>
        <xref ref-type="corresp" rid="cor001">*</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Mell</surname>
          <given-names>Joshua Chang</given-names>
        </name>
        <role content-type="http://credit.casrai.org/">Conceptualization</role>
        <role content-type="http://credit.casrai.org/">Methodology</role>
        <role content-type="http://credit.casrai.org/">Supervision</role>
        <role content-type="http://credit.casrai.org/">Writing – review &amp; editing</role>
        <xref ref-type="aff" rid="aff002">
          <sup>2</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Zhao</surname>
          <given-names>Zhengqiao</given-names>
        </name>
        <role content-type="http://credit.casrai.org/">Data curation</role>
        <role content-type="http://credit.casrai.org/">Formal analysis</role>
        <role content-type="http://credit.casrai.org/">Investigation</role>
        <role content-type="http://credit.casrai.org/">Methodology</role>
        <role content-type="http://credit.casrai.org/">Validation</role>
        <role content-type="http://credit.casrai.org/">Visualization</role>
        <role content-type="http://credit.casrai.org/">Writing – original draft</role>
        <role content-type="http://credit.casrai.org/">Writing – review &amp; editing</role>
        <xref ref-type="aff" rid="aff001">
          <sup>1</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Simpson</surname>
          <given-names>Gideon</given-names>
        </name>
        <role content-type="http://credit.casrai.org/">Methodology</role>
        <role content-type="http://credit.casrai.org/">Supervision</role>
        <role content-type="http://credit.casrai.org/">Writing – review &amp; editing</role>
        <xref ref-type="aff" rid="aff003">
          <sup>3</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>O’Connor</surname>
          <given-names>Michael P.</given-names>
        </name>
        <role content-type="http://credit.casrai.org/">Methodology</role>
        <role content-type="http://credit.casrai.org/">Supervision</role>
        <role content-type="http://credit.casrai.org/">Writing – review &amp; editing</role>
        <xref ref-type="aff" rid="aff004">
          <sup>4</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Rosen</surname>
          <given-names>Gail L.</given-names>
        </name>
        <role content-type="http://credit.casrai.org/">Funding acquisition</role>
        <role content-type="http://credit.casrai.org/">Investigation</role>
        <role content-type="http://credit.casrai.org/">Methodology</role>
        <role content-type="http://credit.casrai.org/">Resources</role>
        <role content-type="http://credit.casrai.org/">Supervision</role>
        <role content-type="http://credit.casrai.org/">Writing – review &amp; editing</role>
        <xref ref-type="aff" rid="aff001">
          <sup>1</sup>
        </xref>
        <xref ref-type="corresp" rid="cor001">*</xref>
      </contrib>
    </contrib-group>
    <aff id="aff001">
      <label>1</label>
      <addr-line>Department of Electrical and Computer Engineering, Drexel University, Philadelphia, Pennsylvania, United States of America</addr-line>
    </aff>
    <aff id="aff002">
      <label>2</label>
      <addr-line>Department of Microbiology and Immunology, Drexel University College of Medicine, Philadelphia, Pennsylvania, United States of America</addr-line>
    </aff>
    <aff id="aff003">
      <label>3</label>
      <addr-line>Department of Mathematics, Drexel University, Philadelphia, Pennsylvania, United States of America</addr-line>
    </aff>
    <aff id="aff004">
      <label>4</label>
      <addr-line>Department of Biodiversity, Earth, and Environmental Science, Drexel University, Philadelphia, Pennsylvania, United States of America</addr-line>
    </aff>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Loor</surname>
          <given-names>Juan J</given-names>
        </name>
        <role>Editor</role>
        <xref ref-type="aff" rid="edit1"/>
      </contrib>
    </contrib-group>
    <aff id="edit1">
      <addr-line>University of Illinois, UNITED STATES</addr-line>
    </aff>
    <author-notes>
      <fn fn-type="COI-statement" id="coi001">
        <p><bold>Competing Interests: </bold>The authors have declared that no competing interests exist.</p>
      </fn>
      <corresp id="cor001">* E-mail: <email>sw424@drexel.edu</email> (SW); <email>glr26@drexel.edu</email> (GLR)</corresp>
    </author-notes>
    <pub-date pub-type="epub">
      <day>11</day>
      <month>12</month>
      <year>2019</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2019</year>
    </pub-date>
    <volume>14</volume>
    <issue>12</issue>
    <elocation-id>e0219235</elocation-id>
    <history>
      <date date-type="received">
        <day>18</day>
        <month>6</month>
        <year>2019</year>
      </date>
      <date date-type="accepted">
        <day>19</day>
        <month>10</month>
        <year>2019</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© 2019 Woloszynek et al</copyright-statement>
      <copyright-year>2019</copyright-year>
      <copyright-holder>Woloszynek et al</copyright-holder>
      <license xlink:href="http://creativecommons.org/licenses/by/4.0/">
        <license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
      </license>
    </permissions>
    <self-uri content-type="pdf" xlink:href="pone.0219235.pdf"/>
    <abstract>
      <p>Analysis of microbiome data involves identifying co-occurring groups of taxa associated with sample features of interest (e.g., disease state). Elucidating such relations is often difficult as microbiome data are compositional, sparse, and have high dimensionality. Also, the configuration of co-occurring taxa may represent overlapping subcommunities that contribute to sample characteristics such as host status. Preserving the configuration of co-occurring microbes rather than detecting specific indicator species is more likely to facilitate biologically meaningful interpretations. Additionally, analyses that use taxonomic relative abundances to predict the abundances of different gene functions aggregate predicted functional profiles across taxa. This precludes straightforward identification of predicted functional components associated with subsets of co-occurring taxa. We provide an approach to explore co-occurring taxa using “topics” generated via a topic model and link these topics to specific sample features (e.g., disease state). Rather than inferring predicted functional content based on overall taxonomic relative abundances, we instead focus on inference of functional content within topics, which we parse by estimating interactions between topics and pathways through a multilevel, fully Bayesian regression model. We apply our methods to three publicly available 16S amplicon sequencing datasets: an inflammatory bowel disease dataset, an oral cancer dataset, and a time-series dataset. Using our topic model approach to uncover latent structure in 16S rRNA amplicon surveys, investigators can (1) capture groups of co-occurring taxa termed topics; (2) uncover within-topic functional potential; (3) link taxa co-occurrence, gene function, and environmental/host features; and (4) explore the way in which sets of co-occurring taxa behave and evolve over time. These methods have been implemented in a freely available R package: <ext-link ext-link-type="uri" xlink:href="https://cran.r-project.org/package=themetagenomics">https://cran.r-project.org/package=themetagenomics</ext-link>, <ext-link ext-link-type="uri" xlink:href="https://github.com/EESI/themetagenomics">https://github.com/EESI/themetagenomics</ext-link>.</p>
    </abstract>
    <funding-group>
      <award-group id="award001">
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="funder-id">http://dx.doi.org/10.13039/100000001</institution-id>
            <institution>National Science Foundation</institution>
          </institution-wrap>
        </funding-source>
        <award-id>1120622</award-id>
        <principal-award-recipient>
          <name>
            <surname>Rosen</surname>
            <given-names>Gail L.</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
      <funding-statement>This work was supported by the National Science Foundation under grant #1120622 to GLR. The funder had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.</funding-statement>
    </funding-group>
    <counts>
      <fig-count count="5"/>
      <table-count count="1"/>
      <page-count count="23"/>
    </counts>
    <custom-meta-group>
      <custom-meta id="data-availability">
        <meta-name>Data Availability</meta-name>
        <meta-value>All code for analyses is available on github at <ext-link ext-link-type="uri" xlink:href="https://github.com/EESI/exploring_thematic_structure">https://github.com/EESI/exploring_thematic_structure</ext-link>. The package is available on CRAN at <ext-link ext-link-type="uri" xlink:href="https://CRAN.R-project.org/package=themetagenomics">https://CRAN.R-project.org/package=themetagenomics</ext-link>. The developmental version of the package and code is located at <ext-link ext-link-type="uri" xlink:href="https://github.com/EESI/themetagenomics">https://github.com/EESI/themetagenomics</ext-link>. Data are already publicly available; accession numbers are provided in manuscript.</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
  <notes>
    <title>Data Availability</title>
    <p>All code for analyses is available on github at <ext-link ext-link-type="uri" xlink:href="https://github.com/EESI/exploring_thematic_structure">https://github.com/EESI/exploring_thematic_structure</ext-link>. The package is available on CRAN at <ext-link ext-link-type="uri" xlink:href="https://CRAN.R-project.org/package=themetagenomics">https://CRAN.R-project.org/package=themetagenomics</ext-link>. The developmental version of the package and code is located at <ext-link ext-link-type="uri" xlink:href="https://github.com/EESI/themetagenomics">https://github.com/EESI/themetagenomics</ext-link>. Data are already publicly available; accession numbers are provided in manuscript.</p>
  </notes>
</front>
<body>
  <sec sec-type="intro" id="sec001">
    <title>Introduction</title>
    <p>High-throughput sequencing now permits for the analysis of multiple large datasets on the microbiome and diseases of interest. Historically, researchers have sought to reduce the dimensionality of the data and/or perform feature selection to identify species (or other taxa) of interest that are correlated with sample/community-level attributes (which we will refer to as “phenotypic” attributes or “phenotypes”) like host health status. Unfortunately, these phenotype-associated species may co-occur with the same or different proportions across samples within the same phenotype. Capturing these configurations is of interest to us, as we contend it is more informative than merely finding specific taxa [<xref rid="pone.0219235.ref001" ref-type="bibr">1</xref>,<xref rid="pone.0219235.ref002" ref-type="bibr">2</xref>].</p>
    <p>Nevertheless, obtaining meaningful configurations or subsets of taxa is often a daunting task. These high-dimensional microbiome datasets include categorical and numeric features associated with each sample. These, in turn, may be linked to a set of taxonomic abundances that are derived from clustering similar sequencing reads. Typically, taxonomic markers, such as variable regions of the 16S rRNA gene common to all prokaryotes, are used to perform the clustering based on a fixed degree of sequence similarity among reads. Such clusters are termed Operational Taxonomic Units (OTUs), and each OTU is usually assigned to some level of taxonomy, such as a genus. Identifying OTUs correlating with specific sample features (e.g., body site, disease presence, diet, age) can be done via unsupervised exploratory methods [<xref rid="pone.0219235.ref003" ref-type="bibr">3</xref>]. Unfortunately, complexities inherent to taxonomic abundance data hinders many of these methods. These complexities include vastly more OTUs relative to the number of available samples [<xref rid="pone.0219235.ref004" ref-type="bibr">4</xref>], substantial sparsity in the OTU counts (absence of organisms in most samples), and differences in sampling depth among samples. The sampling depth issue then requires normalization, introducing additional challenges. In particular, the normalization transforms the abundances into relative abundances within each sample (compositional data) [<xref rid="pone.0219235.ref005" ref-type="bibr">5</xref>,<xref rid="pone.0219235.ref006" ref-type="bibr">6</xref>]. Common approaches (e.g., differential abundance analysis [<xref rid="pone.0219235.ref003" ref-type="bibr">3</xref>,<xref rid="pone.0219235.ref007" ref-type="bibr">7</xref>,<xref rid="pone.0219235.ref008" ref-type="bibr">8</xref>] and regularized regression [<xref rid="pone.0219235.ref009" ref-type="bibr">9</xref>,<xref rid="pone.0219235.ref010" ref-type="bibr">10</xref>]) associate indicator taxa with sample information, leading to overly simplified biological interpretations.</p>
    <p>From an ecological perspective, co-occurring OTUs may represent related subcommunities of taxa, which consist of OTUs that are common to (or overlap with) each sample. This overlap is due to taxa that covary with host or environmental factors; thus, identifying important subcommunities (groups of taxa) and configurations of taxa (the grouping and ratios/relative abundances of co-occurring taxa) may allow for a more biologically meaningful interpretation than identifying indicator OTUs, because identifying subcommunities preserves the groupings and abundances of taxa [<xref rid="pone.0219235.ref002" ref-type="bibr">2</xref>,<xref rid="pone.0219235.ref011" ref-type="bibr">11</xref>–<xref rid="pone.0219235.ref013" ref-type="bibr">13</xref>]. Developing techniques for identifying subcommunities is a fundamental goal of this work.</p>
    <p>Methods that predict functional profiles from 16S rRNA survey data usually report the overall function of a sample and do not provide granularity on how each subcommunity provides specific functions (<xref ref-type="fig" rid="pone.0219235.g001">Fig 1</xref>). Standard methods that predict function from 16S rRNA survey data include PICRUSt, Tax4fun, Piphillin, and SINAPS [<xref rid="pone.0219235.ref014" ref-type="bibr">14</xref>–<xref rid="pone.0219235.ref017" ref-type="bibr">17</xref>]. These simulate gene abundances from the OTU relative abundance profile by assigning pre-existing gene ontologies, based on whole genome sequences, to the OTUs. The simulation is trivial for known microbes, but for novel OTUs, gene content is interpolated through its neighbors’ genes. These are determined via an unsupervised phylogenetic tree reconstruction. However, after the gene abundance profiles are simulated for an entire sample, a user cannot view which functional content associates with which taxa, nor how subcommunities contribute to function.</p>
    <fig id="pone.0219235.g001" orientation="portrait" position="float">
      <object-id pub-id-type="doi">10.1371/journal.pone.0219235.g001</object-id>
      <label>Fig 1</label>
      <caption>
        <p>(Thematic Approach) Given a 16S rRNA gene abundance table, a topic model is used to uncover the thematic structure of the data in the form of two latent distributions: The samples-over-topics frequencies and the topics-over-OTUs frequencies. The samples-over-topics frequencies are regressed against sample features of interest to identify the strength of a topic-covariate relationship to rank topics (top). The topics-over-OTUs frequencies are used in a gene function prediction (FP) algorithm to predict gene content. Important functional categories are identified via a fully Bayesian multilevel negative binomial (NBR) regression model (middle). The topics-over-OTUs distribution is hierarchically clustered to infer relationships between clusters of co-occurring OTUs and topics (bottom). The result is the ability to identify key topics that associate clusters of bacteria and their associated functional content to sample information of interest. (Alternative Approach). A common alternative approach currently used in the literature involves independently (1) characterizing the taxonomic configuration and (2) predicting the functional configuration of the OTU abundance table. Gene function prediction is performed on the full OTU abundance table, followed by a differential abundance analysis to infer differences in specific genes between sample features of interest (top). The OTU table is normalized to overcome library size inconsistencies and then analyzed via two methods: (1) an elastic net (EN) to find sparse sets of OTUs that are predictive for the sample feature of interest (middle) and (2) a multivariate (MV) analysis to identify relationships between beta diversity and the sample feature of interest (bottom). The result are three analyses that summarize the entire OTU relative abundance table, unlike the thematic approach, which characterizes co-occurring sets of OTUs (configurations) in three ways.</p>
      </caption>
      <graphic xlink:href="pone.0219235.g001"/>
    </fig>
    <p>We consequently have developed themetagenomics, a novel pipeline for analyzing 16S rRNA amplicon surveys that (1) identifies subcommunities associated with specific sample features and (2) uncovers functional profiles that further characterize these subcommunities. We use a topic model approach to uncover subcommunity structure by estimating taxonomic co-occurrence. Topic models are dimensionality reduction techniques that have had considerable use in natural language processing to represent, as topics, co-occurrence relationships between words from a corpus of documents. They have more recently shown promise as a method for exploring taxonomic abundance data [<xref rid="pone.0219235.ref002" ref-type="bibr">2</xref>,<xref rid="pone.0219235.ref018" ref-type="bibr">18</xref>], where topics act as low-dimensional representations of co-occurring sets of taxa given a set of samples, i.e., far fewer topics than OTUs (<xref rid="pone.0219235.t001" ref-type="table">Table 1</xref>). Unlike other dimensional reduction techniques common to microbiome data analysis (e.g., principal coordinate analysis), topic models provide a new set of features (topics) that should be familiar to microbiome researchers in that they have a form similar to relative abundances: each sample is represented as a vector of frequencies across topics and each topic is represented as a vector of frequencies across taxa. Lower dimensional features that are also familiar may ease their interpretation.</p>
    <table-wrap id="pone.0219235.t001" orientation="portrait" position="float">
      <object-id pub-id-type="doi">10.1371/journal.pone.0219235.t001</object-id>
      <label>Table 1</label>
      <caption>
        <title>Relationship of terms.</title>
      </caption>
      <alternatives>
        <graphic id="pone.0219235.t001g" xlink:href="pone.0219235.t001"/>
        <table frame="hsides" rules="groups">
          <colgroup span="1">
            <col align="left" valign="middle" span="1"/>
            <col align="left" valign="middle" span="1"/>
            <col align="left" valign="middle" span="1"/>
          </colgroup>
          <thead>
            <tr>
              <th align="left" rowspan="1" colspan="1">Topic Model</th>
              <th align="left" rowspan="1" colspan="1">Pipeline</th>
              <th align="left" rowspan="1" colspan="1">Description</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td align="left" rowspan="1" colspan="1">Document</td>
              <td align="left" rowspan="1" colspan="1">Sample</td>
              <td align="left" rowspan="1" colspan="1">Collection of reads from subject <italic>m</italic> at time <italic>t</italic></td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">Topic</td>
              <td align="left" rowspan="1" colspan="1">Topic</td>
              <td align="left" rowspan="1" colspan="1">Collection of co-occurring taxa, subcommunity</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">Word</td>
              <td align="left" rowspan="1" colspan="1">OTU, Gene, Taxa</td>
              <td align="left" rowspan="1" colspan="1">Features from taxonomic abundance table or predicted functional content</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">Document-Level Covariate</td>
              <td align="left" rowspan="1" colspan="1">Sample information, Sample class</td>
              <td align="left" rowspan="1" colspan="1">Sample-level variable of interest–e.g., disease presence, diet, rainfall, time</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">θ</td>
              <td align="left" rowspan="1" colspan="1">Samples-Over-Topics Distribution</td>
              <td align="left" rowspan="1" colspan="1">Vector of topic frequencies in a given sample; probability of a topic occurring in a given sample</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">β</td>
              <td align="left" rowspan="1" colspan="1">Topics-Over-OTUs Distribution</td>
              <td align="left" rowspan="1" colspan="1">Vector of OTU frequencies in a given topic; probability of an OTU occurring in a given topic</td>
            </tr>
          </tbody>
        </table>
      </alternatives>
    </table-wrap>
    <p>Our pipeline aims to concisely summarize high-dimensional data in the form of OTU abundances as low-dimensional sets of co-occurring taxa (topics) with their corresponding predicted functional potential. When additional high-dimensional data is available (e.g., predicted gene function abundances), interpretability becomes increasingly difficult. Although topic models have been applied to microbiome data because of their interpretable features, no work has been done to leverage their interpretability to link low-dimensional representations of OTU and predicted gene function abundances. In addition, little research addresses ways to fully leverage the latent features topic models extract from microbiome data. For example, correlated topic models [<xref rid="pone.0219235.ref019" ref-type="bibr">19</xref>] not only capture taxonomic co-occurrence but also topic co-occurrence, such that the frequency of two topics, with different sets of co-occurring taxa, occurring in any given sample, may be positively correlated. This is the basis of our novel approach to exploit the correlation structure of topics across samples to resolve long-term temporal behavior of subcommunities (represented as topics) in microbiome time-series datasets.</p>
    <p>Our approach at linking taxonomic composition to predicted functional content (obtained via methods that leverage preexisting gene ontologies) within topics is unique. We apply a recently developed structural topic model (STM) [<xref rid="pone.0219235.ref020" ref-type="bibr">20</xref>] to a novel domain (16S rRNA amplicon surveys), where each topic represents a cluster of co-occurring OTUs and each OTU can occur in multiple topics with varying frequency. Functional content is then predicted within-topic, allowing the topics to act as low-dimensional taxonomic and functional summaries of the input data. The topics are then linked to sample-information that reflects host or environment status. Topics-of-interest (e.g., those that contain differentially-enriched functional profiles) can easily be identified in our pipeline via a fully Bayesian multilevel regression model. We also apply our approach to empirical time-series data where we characterized events in terms of sets of correlated topics to explore how the taxonomic configurations evolved over time.</p>
    <p>Our pipeline has been implemented in the R package themetagenomics: <ext-link ext-link-type="uri" xlink:href="https://cran.r-project.org/package=themetagenomics">https://cran.r-project.org/package=themetagenomics</ext-link>, <ext-link ext-link-type="uri" xlink:href="https://github.com/EESI/themetagenomics">https://github.com/EESI/themetagenomics</ext-link>.</p>
  </sec>
  <sec sec-type="conclusions" id="sec002">
    <title>Results and discussion</title>
    <p>Here we explore the use of themetagenomics on publicly available datasets studying Crohn’s disease microbiota (Gevers et al. [<xref rid="pone.0219235.ref021" ref-type="bibr">21</xref>]), oral cancer microbiota (Schmidt et al. [<xref rid="pone.0219235.ref022" ref-type="bibr">22</xref>]), and the variation of microbiota as a function of time (David et al. [<xref rid="pone.0219235.ref023" ref-type="bibr">23</xref>]). With the larger Gevers et al. Crohn’s dataset, we validate the ability of themetagenomics to capture microbial profile “signatures” (configurations of taxa which are groups with specific ratios/relative abundances of co-occurring taxa). We show that (1) topics generalize well to test data not initially seen by the model (generalizable topics are topics robust to overfitting, such that they avoid fitting noise and thus can capture important signals representative of true taxonomic co-occurrence profiles), and (2) topics capture distinct microbial signatures found in the original OTU relative abundance data.</p>
    <p>After validating the configuration of taxa within-topic (by assessing classification performance to evaluate topic generalizability and OTU co-occurrence to evaluate topic quality) and the configuration of predicted gene functions within-topic (via a permutation test using metagenomic data), we assess the biological relevance of our low-dimensional summaries (topics). We then apply our complete pipeline to Gevers et al. [<xref rid="pone.0219235.ref021" ref-type="bibr">21</xref>] to link a topic’s functional content, taxonomic co-occurrence, and sample information (clinical diagnosis of Crohn’s disease (CD)), and we compare these results to those obtained by the original authors. We compare our results to those obtained by DESeq2 and an alternative topic-model based microbiome analysis tool, BioMiCo [<xref rid="pone.0219235.ref002" ref-type="bibr">2</xref>]. We validate the functional prediction of our pipeline with the oral cancer Schmidt et al. [<xref rid="pone.0219235.ref022" ref-type="bibr">22</xref>] dataset by showing the low-dimensional topic profiles identified by themetagenomics are also present in complementary metagenomic shotgun (MGS) sequence data. We lastly implement our approach on time-series gut microbiome data from David et al. [<xref rid="pone.0219235.ref023" ref-type="bibr">23</xref>]. We interpret the results in terms of topics and posterior uncertainty and compare our findings to those obtained by a HC approach, as well as the results reported by David et al. [<xref rid="pone.0219235.ref023" ref-type="bibr">23</xref>].</p>
    <sec id="sec003">
      <title>Topic modeling Feasibility and generalizability</title>
      <p>We assess (1) if topics correlate to sample phenotypes (e.g., disease state) and (2) whether those topics generalize well–that is, can the learned topics predict phenotypes from new data. Using a random forest classifier, we compared the classification performance between two different sets of predictors: (1) frequencies of topics-across-samples, θ, from the STM, and (2) OTU relative abundances across samples generated from QIIME [<xref rid="pone.0219235.ref024" ref-type="bibr">24</xref>]. For this analysis, we focused on the Crohn’s disease study from Gevers et al. [<xref rid="pone.0219235.ref021" ref-type="bibr">21</xref>] given its large sample size (555 terminal ileum samples).</p>
      <p>To assess generalizability, we used a training/testing approach. We randomly selected 80% of samples as our training set; the remaining 20% were set aside for testing (Table A in <xref ref-type="supplementary-material" rid="pone.0219235.s002">S1 File</xref>). Class labels were binary, with positive (CD+) and negative (CD-) clinical diagnoses acting as the positive and negative classes, respectively. For classifying CD diagnosis, we hypothesized that using topics as predictors would outperform using relative abundances of OTUs, since the relative abundance-based predictors are sparser, whereas topic modeling performs dimensionality reduction, resulting in a relatively smaller set of topics that are less sparse relative to OTUs. There was little difference between the topic model with at least 25 topics and the OTU table to train the classifier (Fig A and Table B in <xref ref-type="supplementary-material" rid="pone.0219235.s002">S1 File</xref>). During testing, however, using topics as features outperformed relative abundances, particularly in the F1 score, with relative abundances achieving 80.8% and at least 25 topics achieving greater than 82.1% (Table C in <xref ref-type="supplementary-material" rid="pone.0219235.s002">S1 File</xref>). Using OTU relative abundances as predictive features resulted in a larger proportion of false negatives, which was likely due to its reliance on few, relatively rare taxa. Topics, on the other hand, are less reliant on rare taxa because dimensionality reduction generates less sparse features (<xref ref-type="supplementary-material" rid="pone.0219235.s001">S1 Appendix</xref>).</p>
    </sec>
    <sec id="sec004">
      <title>Correlation between topics and phenotype</title>
      <p>To identify topics of interest that were strongly associated with phenotype, we again implemented themetagenomics on the Crohn’s disease dataset, using the same binary indicator for CD diagnosis as above. We then performed posterior inference. The primary output of the topic model, as with any Bayesian analysis, is a posterior distribution of quantities that estimate latent variables-of-interest (e.g., the frequencies of topics, θ, in a particular sample) given the observed data (e.g., OTU abundances). Posterior inference involves sampling these latent variables-of-interest from the posterior distribution of the fitted topic model to calculate expected means and assess uncertainty in those expectations.</p>
      <p>With the posterior distribution, we identified topics-of-interest based on their “topic-sample-effects”–the regression coefficients that represent differences in topic frequencies between CD+ and CD- samples. We performed permutation tests to ensure that detected topic-sample-effects were not spurious (<xref ref-type="supplementary-material" rid="pone.0219235.s001">S1 Appendix</xref>). For the model with 25 topics (K25), we performed 25 permutations, where we randomly permuted class label assignments (CD+, CD-), refit the topic model, and calculated the mean regression coefficient for each topic. Of the 25 topics, 8 topics had 95% uncertainty intervals for the effect size (differences between CD+ and CD-) that did not span 0 (Figure B in <xref ref-type="supplementary-material" rid="pone.0219235.s002">S1 File</xref>). We consider these “high-ranking-topics.” Topics T15, T12, T2, and T14 had estimates greater than 0 (implying robust associations with CD+), whereas topics T11, T25, T13, and T19 had estimates less than 0 (implying robust associations with CD-). Increasing the number of fitted topics gave similar results; for K75, 14 topics did not span 0 (Figure C in <xref ref-type="supplementary-material" rid="pone.0219235.s002">S1 File</xref>).</p>
      <p>We next tested how well a topic model (fit with the binary CD encoding) could capture the severity of disease using the Pediatric Crohn’s Disease Activity Index (PCDAI) associated with CD+ that increases as CD severity increases (CD- samples were set to PCDAI = 0). The frequency of a sample containing a particular topic given its PCDAI is shown in <xref ref-type="fig" rid="pone.0219235.g002">Fig 2A</xref> for models K25 and K75. Topics are color-coded based on their association with CD, which is estimated using their topic-sample-effects (yellow and violet represent topics most and least associated with CD, respectively). Each overlapping line represents one of 25 replicate simulations. Both panels demonstrate that as PCDAI increases, the thematic profile shifts from one dominated by a single CD- associated topic (T8) to a set of CD+ topics (T12, T15, T45). The transition occurs at approximately PCDAI = 35. Because the K25 model had greater separation of high probability topics, it will be the focus for the remainder of analyses involving Gevers et al. [<xref rid="pone.0219235.ref021" ref-type="bibr">21</xref>] data.</p>
      <fig id="pone.0219235.g002" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pone.0219235.g002</object-id>
        <label>Fig 2</label>
        <caption>
          <p>(A). The relationship between topic frequency within a sample and that sample’s Crohn’s Disease (CD) severity (PCDAI score) for the 25-topic STM. Each line represents the frequency of a topic as a function of sample PCDAI score. High frequency topics are labeled. Violet and yellow color-coded trajectories designate CD- and CD+ associated topics, respectively. Posterior sampling was performed across 25 replicates, with each line plotted to represent the distribution of the topic frequency trajectories. (B). Trajectories for the 75-topic model. (C). The relative abundance of OTUs in the (input) OTU relative abundance table for “noteworthy” OTUs from high-ranking-topics. The left and right panels show the relative abundance of these OTUs in each CD- and CD+ sample, respectively. Noteworthy OTUs are defined as high-frequency OTUs, sampled from the posterior distribution, that concentrate into high-ranking-topics (yellow = CD+ topic group, violet = CD- topic group, green = unassociated topic group). The horizontal line marks a subset of samples that contain a large proportion of the OTU profile associated with CD+ high-ranking-topics.</p>
        </caption>
        <graphic xlink:href="pone.0219235.g002"/>
      </fig>
      <p>From the posterior topics-over-OTUs distribution (β) for the K25 model, we identified OTUs highly associated with CD, that is, OTUs with high frequency in high-ranking-topics (CD+ associated topics T19, T13, T25, T11; CD- associated topics T14, T2, T12, T15) in more than 99% of posterior samples (arbitrary threshold). We categorized these OTUs as CD+ associated OTUs, CD- associated OTUs, and unassociated OTUs. <xref ref-type="fig" rid="pone.0219235.g002">Fig 2C</xref> shows the relative abundances of the 3 groups for each sample in the QIIME-generated OTU abundance table. Of CD+ samples (right of vertical black bar), approximately 25% were characterized by a greater proportion of CD+ associated OTUs relative to CD- (marked by the horizontal black bar). The ratio of CD- associated OTUs to unassociated OTUs had a similar distribution among CD+ and CD- samples, suggesting that the OTU profile from CD+ high-ranking-topics is specific for the CD+ disease status. Lastly, when we regressed PCDAI against the relative abundances of the CD+ associated OTU profile, we found a significant positive relationship (β = 0.057, p = 0.01, 100 permutations), albeit explanatory for only a small portion of the variation (R<sup>2</sup> = 8.64%), suggesting that presence of this OTU profile may be weakly indicative of severe cases of CD (<xref ref-type="supplementary-material" rid="pone.0219235.s001">S1 Appendix</xref>).</p>
      <sec id="sec005">
        <title>Comparison to BioMiCo</title>
        <p>We compared our approach’s performance to BioMiCo, a topic model that identifies meaningful sets of “assemblages” (analogous to topics–i.e., sets of cooccurring taxa) by directly incorporating sample- or environmental level features (labels) during the training procedure. It is fully supervised and assumes that a sample is comprised of a mixture of communities that share sample- or environmental level features. These communities are described by a set of high probability assemblages which are in turn described by a set of high probability taxa.</p>
        <p>We fit BioMiCo using 25 and 50 assemblages and compared its ability to distinguish CD from control using held-out testing data (same train/test splits as described previously) and then compared these results to the prediction performance of the STM. Testing performance was similar between the two approaches (Table C and Table F in <xref ref-type="supplementary-material" rid="pone.0219235.s002">S1 File</xref>). The balanced accuracy was highest for the 25-topic STM model, but the STM’s performance varied as a function of topic number. F1 score, however, was much worse for BioMiCo due to its low precision.</p>
        <p>For the 25-assemblage model, there were roughly four assemblages with high posterior probability for CD samples and low posterior probability for controls. If we focused on the taxa with the top-10 highest posterior probability of belonging to these assemblages, no more than 2 taxa were present in the top-10 highest probability taxa in the STM’s CD-topics that were most associated with CD, suggesting little correspondence between the composition of assemblages and topics. Alternatively, when focusing on assemblages with high posterior probability for control but not CD, one assemblage had 4 genera in common with the STM’s topic 13: <italic>Parabacteroides</italic>, <italic>Bacteroides</italic>, <italic>Ruminoccous</italic>, and <italic>Roseburia</italic>.</p>
        <p>It is worth noting, however, that the STM and BioMiCo aim to characterize data differently and hence the distribution of taxa within a given topic are expected to be different. Still, both approaches show they similarly generalize to new data. An advantage of themetagenomics is that it leverages output inherent to the design of the STM that is not available via BioMiCo, notably topic-topic correlation. Also, the STM is appreciably faster, taking minutes to run on the Gevers data whereas BioMiCo took days. Unlike BioMiCo–as well as the STM which is aimed for more general use–themetagenomics delivers a framework that facilitates ease-of-use microbiome analysis using a topic model via an R package with a variety of intuitive functions for preprocessing, analyses, and visualizations. It also provides novel downstream approaches such as time series analysis which leverages the STM’s estimation of topic-topic correlation, as well as methods to associate a topic’s taxonomic composition to its predicted gene functions.</p>
      </sec>
    </sec>
    <sec id="sec006">
      <title>Linking function to taxonomy with topics</title>
      <p>We wanted to discern whether the topics would continue to identify meaningful relationships upon introducing another layer of information: predicted function (via abundances of metabolic pathways). Consequently, we applied our full themetagenomics pipeline to the Crohn’s disease dataset and compared our findings to those of the original authors. To further characterize topics, we applied PICRUSt to the topics-over-OTUs distribution, β, to predict the functional gene content within topics. The genes were then annotated in terms of their KEGG functional hierarchy designation [<xref rid="pone.0219235.ref025" ref-type="bibr">25</xref>], thereby providing each gene with a metabolic pathway label. We then performed a fully Bayesian multilevel regression analysis on the predicted abundances of each gene to identify strong topic-pathway interactions.</p>
      <p>Like Gevers et al. [<xref rid="pone.0219235.ref021" ref-type="bibr">21</xref>], we identified an increase in membrane transport associated with CD+ subjects’ gut microbiome; however, using themetagenomics, we were able to pinpoint the specific topics associated with the enrichment of these functional categories, T2 and T12 (<xref ref-type="fig" rid="pone.0219235.g003">Fig 3A</xref>). We then could link enrichment of membrane transport genes to the taxa that were also enriched in this topic. For example, topics T2 and T12 were dominated by Enterobacteriaceae. These Enterobacteriaceae-enriched topics were also enriched for siderophore and secretion system related genes. Like T2 and T12, T15 was highly associated with CD+; however, it was less enriched for membrane transport genes. This suggests that the cluster of bacteria found in T15 (<italic>Haemophilus</italic> spp., <italic>Neisseria</italic>, and <italic>Fusobacteria</italic>) may have contributed less to the shift of transport genes reported by Gevers et al. [<xref rid="pone.0219235.ref021" ref-type="bibr">21</xref>] and instead have distinct pathway associations with CD.</p>
      <fig id="pone.0219235.g003" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pone.0219235.g003</object-id>
        <label>Fig 3</label>
        <caption>
          <p>(A). Level-3 pathway category-topic interaction regression coefficients from the multiple level negative binomial model. Red asterisks indicate estimated pathway-topic interaction weights that do not span 0 at 80% uncertainty (pathways lacking robust interactions are omitted). Green = large positive coefficients thus enrichment for that pathway in that topic, Violet = large negative coefficients thus depletion for that pathway in that topic. Topics are ordered from CD- associated (left, T19) to CD+ associated (right, T15). High-ranking-topics are delineated by the vertical dotted lines (CD-: T19-T11; CD+: T14-T15). (B). Volcano plot showing DESeq2 results for differentially abundant predicted level-3 KEGG categories. Functions were predicted using PICRUSt on the copy number normalized OTU abundance table. Blue points represent categories significantly enriched for CD- and red points are categories enriched for CD+, respectively. Gray points are categories with p-values greater than 0.1 after Bonferroni correction.</p>
        </caption>
        <graphic xlink:href="pone.0219235.g003"/>
      </fig>
      <p>The strongest topic-pathway interaction was found in T19 for genes encoding bacterial motility proteins. For T19, three motility-related pathways (bacterial motility proteins, bacterial chemotaxis, flagellar assembly) had topic-pathway interactions that did not span 0 at 80% uncertainty, suggesting that T19 was more enriched in cell motility genes relative to all other topics. The pathways inferred from T19 are consistent with this taxonomic profile, which consisted of motile bacteria belonging to Lachnospiraceae, Roseburia, and Clostridiales. Enrichment of two lipopolysaccharide (LPS) synthesis categories were associated with CD+ topics; however, one of these categories was specific for only T15 (Table D in <xref ref-type="supplementary-material" rid="pone.0219235.s002">S1 File</xref>).</p>
      <sec id="sec007">
        <title>Comparison to DeSeq2</title>
        <p>We compared the topics’ functional profiles to the results obtained by performing a DESeq2 differential abundance analysis on functional predictions obtained by applying PICRUSt to the QIIME-generated OTU abundance table. Of the 160 (level-3) KEGG pathway categories, more than half (87) were found significant (α &lt; 0.1) in the DESeq2 approach, despite using Bonferoni correction (a conservative approach to correct for multiple comparisons), complicating interpretation (<xref ref-type="fig" rid="pone.0219235.g003">Fig 3B</xref>). Despite minor differences in specific pathway enrichment between themetagenomics and the DESeq2 approach (<xref ref-type="supplementary-material" rid="pone.0219235.s001">S1 Appendix</xref>) the major difference was the greater number of low-uncertainty/significant pathway categories found by DESeq2. While one could reduce the significance level when applying DESeq2 to achieve a smaller subset of significant pathway categories, the choice is arbitrary. Moreover, the predicted functional abundances (via PICRUSt, Tax4fun, etc.) are scaled based on the abundance of taxa from which they were derived. Thus, high taxonomic abundances will often yield high functional abundances. Many of the significant pathway categories identified by DESeq2 may be driven by a small subset of highly abundant taxa. Themetagenomics, on the other hand, first groups co-occurring taxa into topics. Because functional prediction is performed within a topic, taxa that are highly abundant in the input OTU abundance table can only affect the topics in which they are present at high frequency. Thus, this prevents high abundance taxa associated with a subset of samples (e.g., CD+), and their corresponding predicted pathway abundances, from disproportionately influencing the statistical significance of these pathways.</p>
      </sec>
    </sec>
    <sec id="sec008">
      <title>Validating the functional predictions of themetagenomics via Paired MGS samples</title>
      <p>Using sample-matched (N = 12) oral cancer microbiome samples from Schmidt et al. [<xref rid="pone.0219235.ref022" ref-type="bibr">22</xref>] that underwent both 16S rRNA amplicon sequencing and metagenomic shotgun sequencing, we verified enrichment or depletion of predicted functional content (collapsed into metabolic pathway categories) of the themetagenomics pipeline. The pipeline processed the 16S rRNA samples and compared the results to metagenome-based gene functional abundance data. <xref ref-type="fig" rid="pone.0219235.g004">Fig 4A</xref> shows the relative enrichment/depletion of various topic-pathway combinations identified by themetagenomics. For example, bacterial motility genes were enriched in topic 25 (positive coefficient, shaded green), whereas bacterial motility genes were depleted in topics 3 and 9 (negative coefficients, shaded violet).</p>
      <fig id="pone.0219235.g004" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pone.0219235.g004</object-id>
        <label>Fig 4</label>
        <caption>
          <p>(A). KEGG (level-3) pathway category-topic interaction regression coefficients from the multilevel negative binomial model as a measure of association between pathway and topic. Only pathways present in both the themetagenomics analysis of 16S rRNA data and HUMAnN2 analysis of the metagenomics shotgun sequencing data are shown. Green = associated samples with positive cancer diagnosis, Purple = associated with healthy samples. (B). Pathway category-topic interaction regression coefficients for metagenomic data. Topics were generated based on KOs that belonged to high frequency taxa in the themetagenomics pipeline. (C). Example topic-pathway heatmaps, similar to Fig 4A and 4B from four of the 100 permuted metagenomic datasets using in the permutation test. (D). Distribution of root-mean-squared-error (RMSE) scores (between the topic-pathway interaction regression coefficients between themetagenomics and the metagenomic data) from the 100 permuted metagenomic datasets. The RMSE score (0.56) for the unpermuted metagenomic dataset is delineated by the red dotted line.</p>
        </caption>
        <graphic xlink:href="pone.0219235.g004"/>
      </fig>
      <p>To compare the results from themetagenomics to gene function abundances inferred from metagenomic shotgun sequencing for each topic, we first identified high frequency taxa (those with frequencies greater than 1% in that topic) then identified all reads belonging to these taxa in the metagenomic shotgun data. To identify pathway-topic enrichment/depletion, we then applied a multilevel regression model. The results indicate that the taxa belonging to a topic are associated with an enrichment/depletion of genes present in the shotgun data (<xref ref-type="fig" rid="pone.0219235.g004">Fig 4B</xref>). Notably, LPS biosynthesis proteins and porphyrin metabolism pathways were depleted in multiple topics in both sets of results. The relative enrichment/depletion of phosphotransferase system genes was also similar.</p>
      <p>We performed a permutation test to determine whether the similarities in gene enrichments/depletions between themetagenomics and the metagenomic data were spurious. We randomly permuted the topic and gene pathway labels in the metagenomic data, refit the multilevel regression model, and then calculated the root mean square error (RMSE) for each topic-pathway interaction regression weight between the themetagenomics and permuted metagenomic models. After 100 replicate simulations, the RMSE for the unpermuted metagenomic model was smaller than every permuted metagenomic model (p &lt; 0.05) (<xref ref-type="fig" rid="pone.0219235.g004">Fig 4C and 4D</xref>). Therefore, the apparent similarities in the gene enrichment/depletion profiles between themetagenomics and the shotgun data were not due to random chance, indicating that using predicted gene enrichment/depletion from 16S rRNA amplicon surveys resulted in similar within-topic predicted functional profiles to those obtained by directly measuring functional content via metagenomic shotgun sequencing.</p>
    </sec>
    <sec id="sec009">
      <title>Detection of events in subject B from David et al. [<xref rid="pone.0219235.ref023" ref-type="bibr">23</xref>]</title>
      <p>The David et al. [<xref rid="pone.0219235.ref023" ref-type="bibr">23</xref>] dataset contains fecal and salivary 16S rRNA gene surveys from two subjects. We focused on fecal samples from subject B. We compared our results to the three profiles described by David et al. [<xref rid="pone.0219235.ref023" ref-type="bibr">23</xref>], which consisted of a pre-food-poisoning profile (days 1–150), food-poisoning profile (151–159), and post-food-poisoning profile (150–318).</p>
      <sec id="sec010">
        <title>The topic model approach identified 3 distinct gut configurations</title>
        <p>In the topic correlation network (<xref ref-type="fig" rid="pone.0219235.g005">Fig 5A</xref>), we identified a small subnetwork of three topics (marked by violet bracket) and two large subnetworks that contained 24 and 14 topics each (red and green brackets, respectively). The large subnetworks were connected by a chain of four topics (T9, T24, T2, T37) (blue bracket). We defined the four sets of correlated topics as topic clusters and sampled topic frequencies (across samples) and taxa frequencies (across topics) from the topic model’s posterior distribution to assess how often topics and taxa occurred within these clusters.</p>
        <fig id="pone.0219235.g005" orientation="portrait" position="float">
          <object-id pub-id-type="doi">10.1371/journal.pone.0219235.g005</object-id>
          <label>Fig 5</label>
          <caption>
            <title>Application of the topic model approach to David et al. [<xref rid="pone.0219235.ref023" ref-type="bibr">23</xref>] data.</title>
            <p>(A). The topic-to-topic correlation graph showing two topic clusters (clusters 1 and 3) connected by a linear chain of topics (cluster 2) that follow the time progression of the taxonomic change due to the food poisoning infection. (B). Distribution of topic assignments as a function of day and cluster (panels), indicating 3 distinct profiles. The interval in which food poisoning symptoms presented (per David et al. [<xref rid="pone.0219235.ref023" ref-type="bibr">23</xref>]) are marked with dotted vertical lines. Gray shading indicated 80% uncertainty intervals. (C). Frequency of cluster assignments as a function of day, indicated day 153 marking the shift from profiles 1 to 2 and day 159 marking the shift from profiles 2 to 3. (D). Frequency of taxa assignments given a cluster assignment. Cluster 2 is shown in terms of its topics (9, 24, 2, 37). Topic 20 is also shown (misc. cluster), which lacked any edges in the correlation graph, but marks the initial appearance of <italic>Enterobacteriaceae</italic> on day 153 (representing the start of the infection). (E). The probability of the topic assignments given each day for cluster 2. The progression of topics also follows the progression of taxonomic change shown in the correlation graph.</p>
          </caption>
          <graphic xlink:href="pone.0219235.g005"/>
        </fig>
        <p><xref ref-type="fig" rid="pone.0219235.g005">Fig 5B</xref> shows the posterior frequency in which the topic clusters occurred given the day in which the sample was collected (the estimated posterior probability of a cluster occurring on a given day). There were two clear periods of rapid change in cluster frequency, specifically when transitioning from cluster 1 to 2 (days 152–154) and clusters 2 to 3 (day 161). Our intervals are similar to the original study’s transition points at days 144–145 and 162–163, where the shift from a topic cluster 1 to topic cluster 2 corresponded with subject B’s food poisoning diagnosis. The transition between topic clusters 1 and 2 is abrupt and likely occurred around day 153. Taxonomically, this transition is marked by a shift from Bacteroideaceae (posterior frequency = 0.338), Lachnospiraceara (0.276), and Rumunococcaceae (0.266) to Enterbacteriaceae (0.246) and Clostridiaceae (0.195) families (<xref ref-type="fig" rid="pone.0219235.g005">Fig 5D</xref>). In particular, day 153 was distinctive for topic 20. This rare topic was not correlated with any other topics and hence did not belong to any topic cluster. While its taxonomic profile was quite similar to topic cluster 1, it was distinctly enriched for <italic>Enterobacteriaceaea spp</italic>., which is consistent with the subject’s <italic>Salmonella</italic> diagnosis. Topic 20 likely marks the event of initial exposure to the pathogen.</p>
        <p>The distribution of topic assignments for topic cluster 2 followed the order in which its topics were positioned in the topic correlation network (the linear chain of topics) (<xref ref-type="fig" rid="pone.0219235.g005">Fig 5E</xref>). The start of topic cluster 2, day 155, was dominated by topic 9, characterized by taxa substantially different from topic cluster 1. Bacteria enriched in this topic included <italic>Haemophilus parainfluenzae</italic>, <italic>Clostridium perfringens</italic>, and, notably, <italic>Enterobacteriaceaea spp</italic>. Thus, topic 9 likely represented the disrupted configuration of microbiota due to exposure to <italic>Salmonella</italic>. Enterbacteriaceae spp. and <italic>C</italic>. <italic>perfringens</italic>, via topic 24, continued to dominate on day 156. Day 157 was best described by topic 2, a topic rich in <italic>Enterobacteriaceae spp</italic>. as well as <italic>Veillonella spp</italic>. It should be noted, however, that our results were more conservative than David et al. [<xref rid="pone.0219235.ref023" ref-type="bibr">23</xref>] in that we confidently estimated that topic cluster 2 lasted roughly 4 days (155 to 158), which is much shorter than the original study’s estimate (145 to 162). Our estimated length of illness (153 to 158) was more consistent to David et al. [<xref rid="pone.0219235.ref023" ref-type="bibr">23</xref>] (151 to 159), however. At approximately day 159, the taxonomic profile shifted toward cluster 3, which was similar to cluster 1 in terms of Bacteroidaceae (0.369), but enriched in Lachnospiraceae (0.360) and depleted in Rumunoicoccaceae (0.165) (<xref ref-type="fig" rid="pone.0219235.g005">Fig 5D</xref>).</p>
      </sec>
      <sec id="sec011">
        <title>HC was unable to separate the transition between during- and post-illness periods</title>
        <p>We compared our approach to one using HC. HC cluster 4 contained 360 taxa and corresponded well to the pre-illness period, spanning days 1 to 150. The set of taxa was similar to the taxa identified in topic cluster 1 (Figure D in <xref ref-type="supplementary-material" rid="pone.0219235.s002">S1 File</xref>). The post-illness period was captured by HC clusters 1 and 3, but these clusters failed to completely separate the during- and post-illness periods; they spanned days 151 to 318.</p>
      </sec>
    </sec>
    <sec id="sec012">
      <title>Limitations</title>
      <p>There are limitations to our approach. First, the topic-pathway inference step currently scales poorly in terms of computation time for large numbers of topics, which may be more important as datasets grow. Regularization and sparsity-inducing priors help limit the number of important topics; hence, exploring only a subset of topics during the final regression step can offer substantial speed improvements at little cost, but utilizing the complete set of topic information would be ideal. Second, we are capable of separately estimating the uncertainty in our topic model, the multilevel regression model, and the functional predictions from PICRUSt, but we currently do not propagate the uncertainty throughout the pipeline. Doing so would improve downstream interpretation with better estimation of the uncertainty in topic-sample covariates and topic-pathway interactions, which in turn would greatly improve one’s confidence in focusing on within-topic gene sets. Third, we do not incorporate phylogenetic branch length information, which could lead to more meaningful topics. Fourth, we can only provide our best estimations regarding how the model behaves with different sample and feature sizes. Our simulations (<xref ref-type="supplementary-material" rid="pone.0219235.s001">S1 Appendix</xref>) suggested that by effectively decreasing the number of samples, either through rarefying or using sparser data, power decreases. As expected, we were able to detect more sample effects using 500 samples compared to 100 samples. However, as we increased the sparsity of our feature space, our ability to capture known subcommunities was compromised, which would certainly have detrimental effects on detecting sample-level effects. The degree in which sparsity, feature space size, and sample size affect power and the ability of topics to capture meaningful co-occurrences will vary depending on the dataset, which in turns will vary in terms of diversity, range of counts, and sample-level information.</p>
    </sec>
  </sec>
  <sec sec-type="conclusions" id="sec013">
    <title>Conclusion</title>
    <p>We present our approach at a time when easily-to-interpret analyses for complex microbiome data are direly needed. Current methods often link the relative abundance of a single OTU to a sample information of interest (e.g., disease state). These methods routinely identify important subsets of taxa but ignore OTU co-occurrence and ratios. Network methods can overcome this concern, but typically don’t incorporate phenotypic information within the model; consequently, they are incapable of directly linking sections of the OTU correlation network with sample metadata of interest. Constrained ordination methods, such as canonical correspondence analysis, do in fact couple inter-community distance with sample information, but the user is limited to specific distance metrics (e.g., Chi-squared) and must follow key assumptions (e.g., the distributions of taxa along environmental gradients are unimodal) [<xref rid="pone.0219235.ref026" ref-type="bibr">26</xref>]. Moreover, interpretation of biplots becomes increasingly difficult as more covariates are included. While linking key taxa to functional content can be accomplished via sparse canonical correlation analysis [<xref rid="pone.0219235.ref027" ref-type="bibr">27</xref>], this approach is susceptible to many of the interpretability problems found in other ordination approaches, and exploring inferred relationships in the context of taxonomic co-occurrence is not straightforward.</p>
    <p>The ability to make meaningful inferences using current methods is further limited by the fact that microbiome data is often inadequately sampled (thus justifying some type of normalization procedure), compositional (due to normalization), sparse, and overdispersed. Thus, recent work has explored the use of Dirichlet-Multinomial models, which are well equipped at managing overdispersed count data [<xref rid="pone.0219235.ref028" ref-type="bibr">28</xref>–<xref rid="pone.0219235.ref030" ref-type="bibr">30</xref>]. The fact that Dirichlet-Multinomial conjugacy is exploited in many topics models hints at their applicability for relative abundance data. We selected the recently developed STM for our workflow because of its ability to not only utilize sample data as prior information as in the Dirichlet-Multinomial regression topic model [<xref rid="pone.0219235.ref031" ref-type="bibr">31</xref>], but also capture topic correlation structure and apply partial pooling over samples or regularization across regression weights.</p>
    <p>Thus, we have proposed an approach for uncovering latent thematic structure in 16S rRNA amplicon data that provides a low-dimensional, biologically interpretable representation of taxonomic and predicted functional content. Rather than inferring functional content independently of taxonomic relative abundances, our approach shifts the focus to investigating within-topic functional content. Unlike other methods, by exploring our topics, we can link categories of functional content to specific clusters of taxa which can in turn be linked to sample features of interest. For example, like Gevers et al. [<xref rid="pone.0219235.ref021" ref-type="bibr">21</xref>], we detected a relationship between membrane transport genes and CD+, but our approach also allowed us to determine which bacteria (OTUs belonging to Enterobacteriaceae) were the prime contributors to the enrichment of membrane transport genes. Moreover, the pathogenic set of bacteria reported by Gevers et al. [<xref rid="pone.0219235.ref021" ref-type="bibr">21</xref>] (<italic>Haemophilus</italic> spp., <italic>Neisseria</italic>, and <italic>Fusobacteria</italic>) contributed less to the predicted abundance of membrane transport genes. By independently applying statistical approaches to the OTU and predicted functional content, as is typical, the apparent relationship between membrane transport genes and specific configurations of bacteria would be lost.</p>
    <p>We have also shown that our approach drastically reduces the dimensionality of two high-dimensional sources of information, taxonomic relative abundances and predicted functional content, increasing the ease in which these data can be interpreted. For Gevers et al. [<xref rid="pone.0219235.ref021" ref-type="bibr">21</xref>], we determined that T15 is (1) associated with CD+ samples; (2) dominated by a cluster of bacteria previously associated with CD; and (3) uniquely enriched for a subset of LPS synthesis genes. With a gene profile from a topic of interest, one could focus on gene subsets associated with topic-specific bacterial clusters that are known disease biomarkers, which in turn may facilitate targeted approaches for future research endeavors.</p>
    <p>Lastly, our complete pipeline is computationally manageable. Fitting the topic model to a dataset with nearly 5000 samples reached convergence in minutes. Functional prediction via PICRUSt also only takes minutes (using our C++ implementation in themetagenomics). Inferring topic-pathway interactions via our multilevel, negative binomial regression approach is comparatively slower, however, taking hours for large datasets. However, this is still manageable. Thus, we offer a viable package that can help researchers discover configurations of taxa and functions that correlate to sample metadata. This is because we implement this model in the probabilistic programming language Stan, which uses Hamiltonian Monte Carlo. Maximum likelihood (a much faster alternative) does not provide estimates of uncertainty and generally fails to converge for these data, although the regression weight estimates tend to be quite similar based on our experience.</p>
  </sec>
  <sec sec-type="materials|methods" id="sec014">
    <title>Methods</title>
    <sec id="sec015">
      <title>Review of the Structural topic model</title>
      <p>The STM [<xref rid="pone.0219235.ref020" ref-type="bibr">20</xref>] is a Bayesian generative topic model. It begins with a given a set of M samples, each consisting of N OTUs. These N OTUs are, in turn, elements of a fixed vocabulary of V unique OTU IDs. From this, K (a fixed number chosen a priori) latent topics are assumed to be generated from the data. These topics consist of overlapping sets of co-occurring OTUs. Note that we will describe the STM in the context of the analyses perform herein; for a complete description of the STM, see [<xref rid="pone.0219235.ref020" ref-type="bibr">20</xref>]. The observations include the presence of OTU w<sub>n</sub> occurring in sample m and an <italic>M</italic> × <italic>P</italic> matrix of sample-level information such as disease state or age.</p>
      <p>For our purposes, the posterior distribution of unobserved (latent) parameters given the observed data is given by:
<disp-formula id="pone.0219235.e001"><alternatives><graphic xlink:href="pone.0219235.e001.jpg" id="pone.0219235.e001g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M1"><mml:mtext>Posterior</mml:mtext><mml:mspace width="4pt"/><mml:mtext>Distribution</mml:mtext><mml:mo>:</mml:mo><mml:mi>p</mml:mi><mml:mo>(</mml:mo><mml:mrow><mml:mi>θ</mml:mi><mml:mo>,</mml:mo><mml:mi>β</mml:mi><mml:mo>,</mml:mo><mml:mo>Σ</mml:mo><mml:mo>,</mml:mo><mml:mo>Γ</mml:mo><mml:mo>,</mml:mo><mml:mi>z</mml:mi></mml:mrow><mml:mrow><mml:mi>w</mml:mi><mml:mo>,</mml:mo><mml:mi>X</mml:mi></mml:mrow><mml:mo>)</mml:mo><mml:mo>.</mml:mo></mml:math></alternatives></disp-formula></p>
      <p>The generative process is formulated by first specifying the probability
<disp-formula id="pone.0219235.e002"><alternatives><graphic xlink:href="pone.0219235.e002.jpg" id="pone.0219235.e002g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M2"><mml:mrow><mml:mi>P</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mtext>Topic</mml:mtext><mml:mspace width="4pt"/><mml:mi>k</mml:mi><mml:mspace width="4pt"/><mml:mtext>occurs</mml:mtext><mml:mspace width="4pt"/><mml:mtext>in</mml:mtext><mml:mspace width="4pt"/><mml:mtext>Sample</mml:mtext><mml:mspace width="4pt"/><mml:mi>m</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mi>θ</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mstyle displaystyle="true"><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>K</mml:mi></mml:msubsup><mml:mrow><mml:msub><mml:mi>θ</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mstyle></mml:mrow></mml:math></alternatives></disp-formula>
and, for each of the samples, is assumed to follow logistic normal distributions,
<disp-formula id="pone.0219235.e003"><alternatives><graphic xlink:href="pone.0219235.e003.jpg" id="pone.0219235.e003g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M3"><mml:mi>θ</mml:mi><mml:mo>∼</mml:mo><mml:mi>L</mml:mi><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mi>K</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:msup><mml:mrow><mml:mo>Γ</mml:mo></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msup><mml:msubsup><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:mo>Σ</mml:mo><mml:mo>)</mml:mo></mml:math></alternatives></disp-formula>
where Γ is a <italic>P</italic> × (<italic>K</italic> − 1) matrix of regression coefficients that estimate the degree of influence a covariate X<sub>p</sub> has on <italic>θ</italic>; and Σ is a <italic>K</italic> × <italic>K</italic> covariance matrix. In addition to <italic>θ</italic>, the probability
<disp-formula id="pone.0219235.e004"><alternatives><graphic xlink:href="pone.0219235.e004.jpg" id="pone.0219235.e004g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M4"><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:mi>P</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mtext>OTU</mml:mtext><mml:mspace width="4pt"/><mml:mi>n</mml:mi><mml:mspace width="4pt"/><mml:mtext>occurs</mml:mtext><mml:mspace width="4pt"/><mml:mtext>in</mml:mtext><mml:mspace width="4pt"/><mml:mtext>Topic</mml:mtext><mml:mspace width="4pt"/><mml:mi>k</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mo>β</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo></mml:mrow><mml:mrow><mml:mstyle displaystyle="true"><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>N</mml:mi></mml:msubsup><mml:mrow><mml:msub><mml:mi>β</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mstyle></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math></alternatives></disp-formula></p>
      <p>For each topic, β<sub>k</sub> is assumed to be Dirichlet distributed. Finally, both topic assignments z<sub>m,n</sub> for each OTU w<sub>m,n</sub>, along with each OTU, obey multinomial distributions,
<disp-formula id="pone.0219235.e005"><alternatives><graphic xlink:href="pone.0219235.e005.jpg" id="pone.0219235.e005g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M5"><mml:msub><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo>∼</mml:mo><mml:mtext>Multinomial</mml:mtext><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>θ</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:math></alternatives></disp-formula>
<disp-formula id="pone.0219235.e006"><alternatives><graphic xlink:href="pone.0219235.e006.jpg" id="pone.0219235.e006g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M6"><mml:msub><mml:mrow><mml:mi>w</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo>∼</mml:mo><mml:mtext>Multinomial</mml:mtext><mml:mo>(</mml:mo><mml:mrow><mml:mi>β</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:math></alternatives></disp-formula></p>
      <p>For the relationships between topic model nomenclature and our terminology, see <xref rid="pone.0219235.t001" ref-type="table">Table 1</xref>. The posterior distribution is estimated by a semi-collapsed variational expectation maximization procedure. Convergence is reached when the relative change in the variational objective (i.e., the estimated lower bound) in successive iterations falls below a predetermined tolerance.</p>
    </sec>
    <sec id="sec016">
      <title>Empirical datasets</title>
      <p>The Gevers et al. [<xref rid="pone.0219235.ref021" ref-type="bibr">21</xref>] dataset (PRJNA237362, 03/30/2016) is a multicohort, IBD dataset that includes 16S rRNA amplicon data from control, CD, and ulcerative colitis samples taken from multiple locations throughout the gastrointestinal tract. The Schmidt et al. [<xref rid="pone.0219235.ref022" ref-type="bibr">22</xref>] dataset (PRJEB4953, 08/14/2017) consists of human oral microbiota obtained from control subjects and subjects diagnosed with oral cancer. These samples underwent 16S rRNA amplicon sequencing, and a subset (N = 12) also underwent metagenomic shotgun sequencing.</p>
    </sec>
    <sec id="sec017">
      <title>16S rRNA amplicon data preparation and OTU picking</title>
      <p>Paired-end reads were joined and quality filtered via QIIME v 1.9.1 and dada2 for Gevers et al. [<xref rid="pone.0219235.ref021" ref-type="bibr">21</xref>] and Schmidt et al. [<xref rid="pone.0219235.ref022" ref-type="bibr">22</xref>] data, respectively. Closed-reference OTU picking was performed with QIIME using SortMeRNA against GreenGenes v13.5 at 97% sequence identity. This was followed by copy number normalization via PICRUSt version 1.0.0 [<xref rid="pone.0219235.ref032" ref-type="bibr">32</xref>]. Samples with fewer than 1000 total reads were omitted. OTUs that lacked a known classification at the phylum level were removed. For Gevers et al. [<xref rid="pone.0219235.ref021" ref-type="bibr">21</xref>], we selected only terminal ileum samples and filtered OTUs with fewer than 10 total reads across samples, yielding 555 samples over 1500 OTUs. For Schmidt et al. [<xref rid="pone.0219235.ref022" ref-type="bibr">22</xref>], we filtered any OTU with non-zero abundances in fewer than two samples, yielding 81 samples over 1029 OTUs.</p>
    </sec>
    <sec id="sec018">
      <title>Metagenomic shotgun sequence data preparation and functional genomic profiling</title>
      <p>Low quality reads and human genomic sequences were filtered via KneadData. Functional profiles were then generated using HUMAnN2 with the ChocoPhlAn nucleotide database and UniRef90 protein database. The UniRef90 protein families were collapsed into KEGG orthologies (KOs), yielding abundances (copies per million (CPM)) for 12 samples over 36,806 KOs.</p>
    </sec>
    <sec id="sec019">
      <title>Structural topic model fitting</title>
      <p>The OTU abundance tables consisted of counts normalized by 16S rRNA gene copy number (to be consistent with the PICRUSt approach for functional prediction, which we use downstream after model fitting). No other normalization (e.g., rarefying, DESeq2 method, or dividing by total reads) was performed based on the simulation results in (<xref ref-type="supplementary-material" rid="pone.0219235.s001">S1 Appendix</xref>). STMs with different parameterizations in terms of topic number (K ∈ 15, 25, 50, 75, 100, 150, 250) and sample features (e.g., no features, indicators for presence of disease, diet type, etc.) were fit to the OTU tables generated from Gevers et al. [<xref rid="pone.0219235.ref021" ref-type="bibr">21</xref>] data via the R package stm [<xref rid="pone.0219235.ref033" ref-type="bibr">33</xref>]. We evaluated each model fit for presence of overdispersed residuals and conducted permutation tests (permTest in the stm package) where the sample feature of interest is randomly assigned to a sample prior to fitting the STM. To compare parameterizations between models, we evaluated predictive performance using held-out likelihood estimation [<xref rid="pone.0219235.ref034" ref-type="bibr">34</xref>].</p>
    </sec>
    <sec id="sec020">
      <title>Assessing topic generalizability</title>
      <p>We performed classification to assess the generalizability of the extracted topics. No sample information was used as covariates in the logistic normal component of the STM. Samples were split into 80/20 training-testing datasets. For different number of topics (K ∈ 15, 25, 50, 75, 100, 150), an STM was trained to estimate the topics-over-OTUs distribution (β). We then held this distribution fixed; hence, only the testing set’s samples-over-topics distribution (θ) was estimated. For both the training and testing sets, simulated posterior samples from the samples-over-topics distribution (θ) were averaged. The resulting posterior topic frequencies in the training set were then used as features to classify sample labels, similar to using <inline-formula id="pone.0219235.e007"><alternatives><graphic xlink:href="pone.0219235.e007.jpg" id="pone.0219235.e007g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M7"><mml:mover accent="true"><mml:mrow><mml:mi>Z</mml:mi></mml:mrow><mml:mo>-</mml:mo></mml:mover></mml:math></alternatives></inline-formula> in supervised LDA [<xref rid="pone.0219235.ref035" ref-type="bibr">35</xref>]. Generalization (testing) error was assessed using the optimal parametrization based on cross-validation performance on the test set topic frequencies. Classification was performed using a random forest classifier, which underwent parameter tuning to determine the number of variables for each split. This was accomplished through repeated (10x) 10-fold cross-validation, using up-sampling to overcome class imbalance. We performed a parameter sweep over the number of randomly selected OTU features, while setting the number of trees fixed at 128. The optimal parameterizations were selected based on maximizing ROC area under the curve.</p>
      <p>The performance of the STMs was compared to the performance using OTUs as features from the original OTU abundance table. Separately, training and testing set OTU abundances were converted to relative abundances with the following equation: <italic>OTU</italic><sub><italic>n</italic>,<italic>m</italic></sub>/Σ<sub><italic>n</italic></sub>
<italic>OTU</italic><sub><italic>n</italic>,<italic>m</italic></sub>. In words, OTU <italic>n</italic> for sample <italic>m</italic> is scaled by the library size of sample <italic>m</italic> (the total abundance of sample <italic>m</italic>). The resulting OTU relative abundance tables were separately z-score normalized. Training cross-validation and testing using a random forest was then performed as above.</p>
    </sec>
    <sec id="sec021">
      <title>Identifying within-topic clusters of high frequency OTUs</title>
      <p>Using the topics-over-OTUs distribution, we performed hierarchical clustering via Ward’s method on Bray-Curtis distances. We refer to high frequency groups of OTUs as “clusters.”</p>
    </sec>
    <sec id="sec022">
      <title>Inferring within-topic functional potential</title>
      <p>We obtained the topics-over-OTUs distribution (β) for each fitted model and mapped the within-topic OTU probabilities to integers (“pseudo-counts”) using a constant: 10000 × <italic>β</italic>. A large constant was chosen to prevent low frequency OTUs from being set to zero, although their contribution to downstream analysis was likely negligible. Gene prediction was performed on each topic-OTU pseudo-count table using PICRUSt version 1.0.0 [<xref rid="pone.0219235.ref014" ref-type="bibr">14</xref>]. (Normalization of 16S copy number was performed prior to topic model fitting using PICRUSt.) Predicted gene content was classified in terms of KOs [<xref rid="pone.0219235.ref036" ref-type="bibr">36</xref>].</p>
    </sec>
    <sec id="sec023">
      <title>Identifying topics of interest</title>
      <p>Topics of interest were identified using the samples-over-topics distribution, where each column represents the frequency of topic <italic>k</italic> for each sample. Each column was regressed against CD diagnosis. We calculated 95% uncertainty intervals using an approximation that accounts for uncertainty in estimation of both the sample covariate coefficients and the topic frequencies. We refer to these coefficients as “topic-sample-effects.” Coefficients whose 95% uncertainty intervals do not span 0 are referred to as “high-ranking-topics.”</p>
    </sec>
    <sec id="sec024">
      <title>Validating within-topic co-occurrence</title>
      <p>To determine how well the high-ranking-topics captured co-occurrence in the original OTU relative abundance table, we sampled the top-10 highest frequency taxa in each high-ranking topic’s topics-over-OTUs distribution (β). We then normalized the original OTU table using the centered-log-ratio transformation and then evaluated how the high frequency taxa vary as a function of CD diagnosis and PCDAI.</p>
    </sec>
    <sec id="sec025">
      <title>Posterior inference</title>
      <p>To determine how well the high-ranking-topics captured the taxonomic profile associated with CD, we performed the following posterior simulation over R = 1000 iterations. First, for iteration r, for all samples <italic>m</italic> ∈ <italic>M</italic> (e.g., subject 134), we obtained 100 posterior samples (<italic>i</italic> ∈ {1, …, 100}) of <inline-formula id="pone.0219235.e008"><alternatives><graphic xlink:href="pone.0219235.e008.jpg" id="pone.0219235.e008g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M8"><mml:msubsup><mml:mrow><mml:mi>θ</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula> from the posterior distribution, <italic>p</italic>(<italic>θ</italic>, <italic>β</italic>, Σ, Γ, <italic>z</italic>|<italic>w</italic>, <italic>X</italic>). For each of these <inline-formula id="pone.0219235.e009"><alternatives><graphic xlink:href="pone.0219235.e009.jpg" id="pone.0219235.e009g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M9"><mml:msubsup><mml:mrow><mml:mi>θ</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula>, we sampled topic assignments <inline-formula id="pone.0219235.e010"><alternatives><graphic xlink:href="pone.0219235.e010.jpg" id="pone.0219235.e010g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M10"><mml:msubsup><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:msubsup><mml:mo>∼</mml:mo><mml:mtext>Multinomial</mml:mtext><mml:mo>(</mml:mo><mml:msubsup><mml:mrow><mml:mi>θ</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:msubsup><mml:mo>)</mml:mo></mml:math></alternatives></inline-formula>, and then OTUs <inline-formula id="pone.0219235.e011"><alternatives><graphic xlink:href="pone.0219235.e011.jpg" id="pone.0219235.e011g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M11"><mml:msubsup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>w</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:msubsup><mml:mo>|</mml:mo><mml:msubsup><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>i</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msubsup><mml:mo>∼</mml:mo><mml:mtext>Multinomial</mml:mtext><mml:mo>(</mml:mo><mml:msubsup><mml:mrow><mml:mtext>z</mml:mtext></mml:mrow><mml:mrow><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:mo>β</mml:mo><mml:mo>)</mml:mo></mml:math></alternatives></inline-formula>.</p>
      <p>We then recorded whether the topic assignments <inline-formula id="pone.0219235.e012"><alternatives><graphic xlink:href="pone.0219235.e012.jpg" id="pone.0219235.e012g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M12"><mml:msubsup><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula> belonged to one of the high-ranking-topics and whether they have a positive or negative association with sample covariates of interest, resulting in positive-, negative-, and no-association topic groups. We calculated the frequency <inline-formula id="pone.0219235.e013"><alternatives><graphic xlink:href="pone.0219235.e013.jpg" id="pone.0219235.e013g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M13"><mml:msubsup><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>g</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula> in which OTUs <inline-formula id="pone.0219235.e014"><alternatives><graphic xlink:href="pone.0219235.e014.jpg" id="pone.0219235.e014g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M14"><mml:msubsup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>w</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula> were sampled from a given topic group g:
<disp-formula id="pone.0219235.e015"><alternatives><graphic xlink:href="pone.0219235.e015.jpg" id="pone.0219235.e015g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M15"><mml:msubsup><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>g</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mrow><mml:munder><mml:mo stretchy="false">∑</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:munder><mml:mrow><mml:mrow><mml:munder><mml:mo stretchy="false">∑</mml:mo><mml:mrow><mml:msubsup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>w</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:msubsup><mml:mo>|</mml:mo><mml:msubsup><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>i</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:munder><mml:mrow><mml:mn>1</mml:mn><mml:mo>[</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo>∈</mml:mo><mml:mi>g</mml:mi></mml:mrow><mml:mo>]</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:mrow></mml:math></alternatives></disp-formula>
where 1[·] is the indicator function. For each OTU, we calculated which group had the largest sampling frequency:
<disp-formula id="pone.0219235.e016"><alternatives><graphic xlink:href="pone.0219235.e016.jpg" id="pone.0219235.e016g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M16"><mml:msubsup><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>g</mml:mi></mml:mrow><mml:mo>)</mml:mo><mml:mo>*</mml:mo></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>[</mml:mo><mml:mrow><mml:msubsup><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>g</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:munder><mml:mrow><mml:mtext>argmin</mml:mtext><mml:mspace width="4pt"/></mml:mrow><mml:mrow><mml:mi>g</mml:mi></mml:mrow></mml:munder></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:mrow><mml:mo>]</mml:mo></mml:math></alternatives></disp-formula></p>
      <p>After 1000 iterations, we calculated
<disp-formula id="pone.0219235.e017"><alternatives><graphic xlink:href="pone.0219235.e017.jpg" id="pone.0219235.e017g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M17"><mml:msubsup><mml:mrow><mml:mi>F</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>g</mml:mi></mml:mrow><mml:mo>)</mml:mo><mml:mo>*</mml:mo></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>R</mml:mi></mml:mrow></mml:mfrac><mml:mrow><mml:munder><mml:mo stretchy="false">∑</mml:mo><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:munder><mml:mrow><mml:msubsup><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>g</mml:mi></mml:mrow><mml:mo>)</mml:mo><mml:mo>*</mml:mo><mml:mo>(</mml:mo><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:mrow></mml:math></alternatives></disp-formula></p>
      <p>For each topic group, we extracted a subset of OTUs that had frequencies above 0.99. In the original relative abundance table, for each sample, we calculated the relative abundance of each group of OTUs.</p>
    </sec>
    <sec id="sec026">
      <title>Identifying functional content that distinguishes topics</title>
      <p>To determine which predicted functional gene content best distinguished topics, we used the following multilevel negative binomial regression model:
<disp-formula id="pone.0219235.e018"><alternatives><graphic xlink:href="pone.0219235.e018.jpg" id="pone.0219235.e018g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M18"><mml:msub><mml:mrow><mml:mi>θ</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>c</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:mtext>exp</mml:mtext></mml:mrow><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mi>μ</mml:mi><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:mi>c</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>c</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>]</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></disp-formula>
<disp-formula id="pone.0219235.e019"><alternatives><graphic xlink:href="pone.0219235.e019.jpg" id="pone.0219235.e019g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M19"><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>c</mml:mi></mml:mrow></mml:msub><mml:mo>~</mml:mo><mml:mtext>NB</mml:mtext><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>θ</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>c</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>λ</mml:mi><mml:mo>)</mml:mo></mml:math></alternatives></disp-formula>
where <italic>μ</italic> is the intercept, <italic>β</italic><sub><italic>k</italic></sub> is the per topic weight, <italic>β</italic><sub><italic>c</italic></sub> is the per level-3 gene category weight, <italic>β</italic><sub><italic>k</italic>,<italic>c</italic></sub> is the interaction weight for a given topic-function (gene category) combination, <italic>y</italic><sub><italic>k</italic>,<italic>c</italic></sub> is the count for a given topic-function combination, and <italic>λ</italic> is the dispersion parameter. The intercept <italic>μ</italic> was given a Normal(0, 10) prior; all weights were given Normal(0, 2.5) priors; and the dispersion parameter <italic>λ</italic> was given a Cauchy(0, 5) prior. Model inference was performed using Hamiltonian Monte Carlo in the R package rstanarm [<xref rid="pone.0219235.ref037" ref-type="bibr">37</xref>]. Convergence was evaluated across four parallel chains using diagnostic plots to assess mixing and by evaluating the Gelman-Rubin convergence diagnostic [<xref rid="pone.0219235.ref038" ref-type="bibr">38</xref>]. To reduce model size, we used genes belonging to only 15 (arbitrary number) level-2 KEGG pathway categories (Table E in <xref ref-type="supplementary-material" rid="pone.0219235.s002">S1 File</xref>). For large topic models, we fit only the top 25 topics, ranked in terms of topic-sample-effects that measure the degree of association between samples-over-topics probabilities and our sample feature of interest.</p>
    </sec>
    <sec id="sec027">
      <title>Assessing relationships between sample information of interest and taxonomic relative abundance</title>
      <p>To quantify the relationship between taxonomic relative abundance and continuous sample features (such as PCDAI), we performed negative binomial regression (log-link), using sample library size (sum of OTU abundances across samples) as an offset. The family-wise error rate was adjusted via Bonferroni correction. Significance levels for hypothesis testing was set at 0.05.</p>
    </sec>
    <sec id="sec028">
      <title>Comparing within-topic functional profiles to an OTU-relative-abundance-based approach</title>
      <p>We compared the results from the hierarchical negative binomial model to a differential abundance approach. We performed predicted functional content using PICRUSt on copy number normalized OTU abundances. The resulting functional abundances were collapsed into level-3 KEGG pathways. Note that, for consistency, we again restricted the KOs to the 15 level-2 KEGG pathways used previously. The resulting level-3 pathway abundances underwent DESeq2 differential abundance analysis, which uses negative binomial regression and variance stabilizing transformations to infer the difference log-fold change of OTU relative abundance [<xref rid="pone.0219235.ref007" ref-type="bibr">7</xref>,<xref rid="pone.0219235.ref008" ref-type="bibr">8</xref>]. The resulting p-values were corrected via the Bonferroni method. Adjusted p-values below 0.1 were considered significant.</p>
    </sec>
    <sec id="sec029">
      <title>Fitting BioMico</title>
      <p>The same training and testing sets were used as described above. Assemblages of 25 and 50 were trained with default parameters unless specified: burnin = 5000, delay = 500 (25 assemblages) or delay = 100 (50 assemblages), rarefaction_depth = 1000. Parameters were adjusted to decrease training time to less than 3 days. Posterior distributions were evaluated to ensure MCMC convergence.</p>
    </sec>
    <sec id="sec030">
      <title>Validating extracted functional profiles using metagenomic shotgun sequencing data</title>
      <p>The themetagenomics pipeline was applied to the Schmidt et al. [<xref rid="pone.0219235.ref022" ref-type="bibr">22</xref>] OTU table: (1) data were normalized for 16S rRNA gene copy number; (2) normalized OTU abundances were fit using a 25 topic STM with cancer diagnosis as a binary covariate; (3) within-topic functional content was predicted using PICRUSt; and then (4) topic-pathway effects were detected using the multilevel regression model.</p>
      <p>For each topic, we identified the high probability OTUs (those with frequencies greater than 1% in that topic), obtained their genus classification, and then subset the metagenomic KO table such that only KOs corresponding to these genera are present. Then, for each level-3 KEGG pathway, we summed the abundances of all remaining KO members. Topic-pathway effects were then detected with the following multilevel regression model:
<disp-formula id="pone.0219235.e020"><alternatives><graphic xlink:href="pone.0219235.e020.jpg" id="pone.0219235.e020g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M20"><mml:msub><mml:mrow><mml:mi>θ</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>c</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:mtext>exp</mml:mtext></mml:mrow><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mi>μ</mml:mi><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mi>X</mml:mi><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:mi>c</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>c</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mrow><mml:mrow><mml:mtext>log</mml:mtext></mml:mrow><mml:mrow><mml:mspace width="4pt"/><mml:mi>Z</mml:mi></mml:mrow></mml:mrow></mml:mrow><mml:mo>]</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></disp-formula>
<disp-formula id="pone.0219235.e021"><alternatives><graphic xlink:href="pone.0219235.e021.jpg" id="pone.0219235.e021g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M21"><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>c</mml:mi></mml:mrow></mml:msub><mml:mo>~</mml:mo><mml:mtext>NB</mml:mtext><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>θ</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>c</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>λ</mml:mi><mml:mo>)</mml:mo></mml:math></alternatives></disp-formula>
where X is a binary column vector indicating positive cancer diagnosis, <italic>β</italic><sub>1</sub> is the coefficient for cancer diagnosis, and log <italic>Z</italic> is an offset accounting for sample library size (sample sum). The remaining parameters are analogous to the model described above.</p>
      <p>A permutation test was performed to compare the similarity in topic-pathway effects between themetagenomics and the metagenomic model to random sampling. In the metagenomic KO table, topic and pathway labels were randomly permuted. The permuted table was then refit with the regression model described. The root mean squared error was calculated between the topic-pathway regression coefficient β<sub>k,c</sub> for themetagenomics and the metagenomic model:
<disp-formula id="pone.0219235.e022"><alternatives><graphic xlink:href="pone.0219235.e022.jpg" id="pone.0219235.e022g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M22"><mml:mi>R</mml:mi><mml:mi>M</mml:mi><mml:mi>S</mml:mi><mml:mi>E</mml:mi><mml:mo>=</mml:mo><mml:msqrt><mml:mfrac><mml:mrow><mml:mrow><mml:munder><mml:mo stretchy="false">∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>c</mml:mi></mml:mrow></mml:munder><mml:mrow><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msubsup><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>t</mml:mi><mml:mi>h</mml:mi><mml:mi>e</mml:mi><mml:mi>m</mml:mi><mml:mi>e</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:msubsup><mml:mo>-</mml:mo><mml:msubsup><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mtext>meta</mml:mtext></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mrow></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:mfrac></mml:msqrt></mml:math></alternatives></disp-formula></p>
      <p>This process was repeated over 100 permuted replicates to calculate a null distribution of RMSE scores, which was then compared to the true RMSE between the unpermuted metagenomic KO table and <italic>themetagenomics</italic>. A p-value (α = 0.05) was calculated as the proportion of RMSE scores from the 100 permuted metagenomic KO tables that were less than the RMSE score for the unpermuted metagenomic KO table.</p>
    </sec>
    <sec id="sec031">
      <title>Exploring thematic structure in David et al. [<xref rid="pone.0219235.ref023" ref-type="bibr">23</xref>]</title>
      <sec id="sec032">
        <title>Data preparation and OTU picking</title>
        <p>The David et al. [<xref rid="pone.0219235.ref023" ref-type="bibr">23</xref>] dataset contains fecal and salivary 16S rRNA surveys from two subjects. The samples were obtained at uneven sampled times from 318 days. Data from were downloaded from the European Bioinformatics Institute (EBI) European Nucleotide Archive (ENA) (accession number ERP006059). It consisted of 1.7 million 16S rRNA gene (V4 region) sequencing reads, 100 bp in length. The reads were quality filtered using the fastqFilter command in the dada2 package [<xref rid="pone.0219235.ref039" ref-type="bibr">39</xref>]. Closed reference OTU picking was then performed with QIIME version 1.9.1. using SortMeRNA again GreenGenes v13.5 at 97% sequence identity [<xref rid="pone.0219235.ref024" ref-type="bibr">24</xref>].</p>
      </sec>
      <sec id="sec033">
        <title>Data preprocessing and STM fitting</title>
        <p>From the OTU table, we removed any samples with fewer than 1000 total reads, were not of fecal origin, were not from donor B, and did not include sample data for day, donor, and body site. OTUs lacking a known phylum classification or present in fewer than 1% of the remaining samples were removed. The remaining OTUs were normalized in terms of 16S rRNA gene copy number per the table provided by PICRUSt [<xref rid="pone.0219235.ref014" ref-type="bibr">14</xref>]. The final OTU table consisted of 1562 OTUs across 189 samples.</p>
        <p>We fit 7 STMs that varied in terms of topic number K ∈ {15, 25, 50, 75, 105, 155, 250}. To infer the relationship between sample data and the samples-over-topics distribution θ, we used two sample covariates: two continuous, integer valued sequences representing the day number in the sequence and the DOW. Given our assumption that fluctuations in microbiota likely varied nonlinearly with respect to day, we used a smoothing spline with 10 degrees of freedom on day and a second-degree polynomial on DOW.</p>
      </sec>
      <sec id="sec034">
        <title>Event detection</title>
        <p>To detect events in subject B, we repeated the approach described for simulation 2 (<xref ref-type="supplementary-material" rid="pone.0219235.s001">S1 Appendix</xref>).</p>
      </sec>
      <sec id="sec035">
        <title>Hierarchical clustering</title>
        <p>We performed HC for comparison. The David et al. [<xref rid="pone.0219235.ref023" ref-type="bibr">23</xref>] data were normalized using the sample geometric mean to correct for library size imbalance. Each feature was then centered and scaled as described for simulation 2. Clustering was performed as detailed for simulation 2. The resulting tree was cut to produce 6 clusters. The choice of 6 clusters was based on the three profiles identified by David et al. [<xref rid="pone.0219235.ref023" ref-type="bibr">23</xref>] (days 1–150, 151–159, and 160–318). We included three additional clusters to account for the background taxonomic variation lacking one of the three profiles of interest. Because we are basing our parameter choice on what can be considered the truth, this can be considered a best-case-scenario.</p>
      </sec>
      <sec id="sec036">
        <title>Themetagenomics</title>
        <p>An R package, where the user provides a taxonomic abundance table, sample-level information, and taxonomy information. A topic model is fit, and the user is provided interactive Shiny applications, allowing the user to visualize, graphically, (1) which taxa dominant which topics, and hence which taxa co-occur; (2) which functional content dominant which topics, and (3) relationships between sample-level information (e.g., age) and the relative frequency of co-occurring taxa. The figures can be exported as image files.</p>
      </sec>
    </sec>
  </sec>
  <sec sec-type="supplementary-material" id="sec037">
    <title>Supporting information</title>
    <supplementary-material content-type="local-data" id="pone.0219235.s001">
      <label>S1 Appendix</label>
      <caption>
        <title>Contains additional information regarding the following: (1) simulation 1 which explores different normalization approaches, (2) time series analysis methods for David et al. [<xref rid="pone.0219235.ref023" ref-type="bibr">23</xref>] data including simulation 2; and (3) additional results for Crohn’s disease data as well as expansion of results detailed above and comparisons to other approaches such as SPIEC-EASI.</title>
        <p>(DOCX)</p>
      </caption>
      <media xlink:href="pone.0219235.s001.docx">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pone.0219235.s002">
      <label>S1 File</label>
      <caption>
        <title>Contains figures A-D and tables A-F.</title>
        <p>(DOCX)</p>
      </caption>
      <media xlink:href="pone.0219235.s002.docx">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <ref-list>
    <title>References</title>
    <ref id="pone.0219235.ref001">
      <label>1</label>
      <mixed-citation publication-type="journal"><name><surname>Kurtz</surname><given-names>ZD</given-names></name>, <name><surname>Mueller</surname><given-names>CL</given-names></name>, <name><surname>Miraldi</surname><given-names>ER</given-names></name>, <name><surname>Littman</surname><given-names>DR</given-names></name>, <name><surname>Blaser</surname><given-names>MJ</given-names></name>, <name><surname>Bonneau</surname><given-names>RA</given-names></name>. <article-title>Sparse and Compositionally Robust Inference of Microbial Ecological Networks</article-title>. <source>PLoS Comput Biol</source>. <year>2015</year>;<volume>11</volume>: <fpage>1</fpage>–<lpage>25</lpage>. <pub-id pub-id-type="doi">10.1371/journal.pcbi.1004226</pub-id><?supplied-pmid 25950956?><pub-id pub-id-type="pmid">25950956</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0219235.ref002">
      <label>2</label>
      <mixed-citation publication-type="journal"><name><surname>Shafiei</surname><given-names>M</given-names></name>, <name><surname>Dunn</surname><given-names>KA</given-names></name>, <name><surname>Boon</surname><given-names>E</given-names></name>, <name><surname>MacDonald</surname><given-names>SM</given-names></name>, <name><surname>Walsh</surname><given-names>DA</given-names></name>, <name><surname>Gu</surname><given-names>H</given-names></name>, <etal>et al</etal><article-title>BioMiCo: a supervised Bayesian model for inference of microbial community structure</article-title>. <source>Microbiome</source>. <year>2015</year>;<volume>3</volume>: <fpage>8</fpage><pub-id pub-id-type="doi">10.1186/s40168-015-0073-x</pub-id><?supplied-pmid 25774293?><pub-id pub-id-type="pmid">25774293</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0219235.ref003">
      <label>3</label>
      <mixed-citation publication-type="journal"><name><surname>Callahan</surname><given-names>BJ</given-names></name>, <name><surname>Sankaran</surname><given-names>K</given-names></name>, <name><surname>Fukuyama</surname><given-names>JA</given-names></name>, <name><surname>McMurdie</surname><given-names>PJ</given-names></name>, <name><surname>Holmes</surname><given-names>SP</given-names></name>. <article-title>Bioconductor workflow for microbiome data analysis: from raw reads to community analyses</article-title>. <source>F1000Research</source>. <year>2016</year>;<volume>5</volume>: <fpage>1492</fpage><pub-id pub-id-type="doi">10.12688/f1000research.8986.1</pub-id><?supplied-pmid 27508062?><pub-id pub-id-type="pmid">27508062</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0219235.ref004">
      <label>4</label>
      <mixed-citation publication-type="journal"><name><surname>Knights</surname><given-names>D</given-names></name>, <name><surname>Costello</surname><given-names>E</given-names></name>, <name><surname>Knight</surname><given-names>R</given-names></name>. <article-title>Supervised classification of human microbiota</article-title>. <source>FEMS Microbiol Rev</source>. <year>2011</year>;<volume>35</volume>: <fpage>343</fpage>–<lpage>59</lpage>. <pub-id pub-id-type="doi">10.1111/j.1574-6976.2010.00251.x</pub-id><?supplied-pmid 21039646?><pub-id pub-id-type="pmid">21039646</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0219235.ref005">
      <label>5</label>
      <mixed-citation publication-type="journal"><name><surname>Li</surname><given-names>H</given-names></name>. <article-title>Microbiome, Metagenomics, and High-Dimensional Compositional Data Analysis</article-title>. <source>Annu Rev Stat Its Appl</source>. <year>2015</year>;<volume>2</volume>: <fpage>73</fpage>–<lpage>94</lpage>. <pub-id pub-id-type="doi">10.1146/annurev-statistics-010814-020351</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0219235.ref006">
      <label>6</label>
      <mixed-citation publication-type="journal"><name><surname>Gilbert</surname><given-names>JA</given-names></name>, <name><surname>Quinn</surname><given-names>RA</given-names></name>, <name><surname>Debelius</surname><given-names>J</given-names></name>, <name><surname>Xu</surname><given-names>ZZ</given-names></name>, <name><surname>Morton</surname><given-names>J</given-names></name>, <name><surname>Garg</surname><given-names>N</given-names></name>, <etal>et al</etal><article-title>Microbiome-wide association studies link dynamic microbial consortia to disease</article-title>. <source>Nature</source>. <year>2016</year>;<volume>535</volume>: <fpage>94</fpage>–<lpage>103</lpage>. <pub-id pub-id-type="doi">10.1038/nature18850</pub-id><?supplied-pmid 27383984?><pub-id pub-id-type="pmid">27383984</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0219235.ref007">
      <label>7</label>
      <mixed-citation publication-type="journal"><name><surname>McMurdie</surname><given-names>PJ</given-names></name>, <name><surname>Holmes</surname><given-names>S</given-names></name>. <article-title>Waste Not, Want Not: Why Rarefying Microbiome Data Is Inadmissible</article-title>. <source>PLoS Comput Biol</source>. <year>2014</year>;<volume>10</volume><pub-id pub-id-type="doi">10.1371/journal.pcbi.1003531</pub-id><?supplied-pmid 24699258?><pub-id pub-id-type="pmid">24699258</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0219235.ref008">
      <label>8</label>
      <mixed-citation publication-type="other">Love MI, Anders S, Huber W. Differential analysis of count data—the DESeq2 package [Internet]. Genome Biology. 2014.</mixed-citation>
    </ref>
    <ref id="pone.0219235.ref009">
      <label>9</label>
      <mixed-citation publication-type="journal"><name><surname>Friedman</surname><given-names>J</given-names></name>, <name><surname>Hastie</surname><given-names>T</given-names></name>, <name><surname>Tibshirani</surname><given-names>R</given-names></name>. <article-title>Regularization Paths for Generalized Linear Models via Coordinate Descent</article-title>. <source>J Stat Softw</source>. <year>2010</year>;<volume>33</volume>: <fpage>1</fpage>–<lpage>22</lpage>. <pub-id pub-id-type="doi">10.1359/JBMR.0301229</pub-id><?supplied-pmid 20808728?><pub-id pub-id-type="pmid">20808728</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0219235.ref010">
      <label>10</label>
      <mixed-citation publication-type="journal"><name><surname>Zou</surname><given-names>H</given-names></name>, <name><surname>Hastie</surname><given-names>T</given-names></name>. <article-title>Regularization and variable selection via the elastic net</article-title>. <source>J R Stat Soc Ser B Stat Methodol</source>. <year>2005</year>;<volume>67</volume>: <fpage>301</fpage>–<lpage>320</lpage>. <pub-id pub-id-type="doi">10.1111/j.1467-9868.2005.00503.x</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0219235.ref011">
      <label>11</label>
      <mixed-citation publication-type="other">Jiang X, Dushoff J, Chen X, Hu X. Identifying enterotype in human microbiome by decomposing probabilistic topics into components. 2012 IEEE Int Conf Bioinforma Biomed. Ieee; 2012; 1–4.</mixed-citation>
    </ref>
    <ref id="pone.0219235.ref012">
      <label>12</label>
      <mixed-citation publication-type="journal"><name><surname>Ning</surname><given-names>J</given-names></name>, <name><surname>Beiko</surname><given-names>RG</given-names></name>. <article-title>Phylogenetic approaches to microbial community classification</article-title>. <source>Microbiome. Microbiome</source>; <year>2015</year>;<volume>3</volume>: <fpage>47</fpage><pub-id pub-id-type="doi">10.1186/s40168-015-0114-5</pub-id><?supplied-pmid 26437943?><pub-id pub-id-type="pmid">26437943</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0219235.ref013">
      <label>13</label>
      <mixed-citation publication-type="journal"><name><surname>Ren</surname><given-names>B</given-names></name>, <name><surname>Bacallado</surname><given-names>S</given-names></name>, <name><surname>Favaro</surname><given-names>S</given-names></name>, <name><surname>Holmes</surname><given-names>S</given-names></name>, <name><surname>Trippa</surname><given-names>L</given-names></name>. <article-title>Bayesian Nonparametric Ordination for the Analysis of Microbial Communities</article-title>. <source>arXiv Prepr arXiv160105156</source>. <year>2016</year>; <fpage>1</fpage>–<lpage>25</lpage>. <ext-link ext-link-type="uri" xlink:href="http://arxiv.org/abs/1601.05156">http://arxiv.org/abs/1601.05156</ext-link></mixed-citation>
    </ref>
    <ref id="pone.0219235.ref014">
      <label>14</label>
      <mixed-citation publication-type="journal"><name><surname>Langille</surname><given-names>MGI</given-names></name>, <name><surname>Zaneveld</surname><given-names>J</given-names></name>, <name><surname>Caporaso</surname><given-names>JG</given-names></name>, <name><surname>McDonald</surname><given-names>D</given-names></name>, <name><surname>Knights</surname><given-names>D</given-names></name>, <name><surname>Reyes</surname><given-names>J a</given-names></name>, <etal>et al</etal><article-title>Predictive functional profiling of microbial communities using 16S rRNA marker gene sequences</article-title>. <source>Nat Biotechnol. Nature Publishing Group</source>; <year>2013</year>;<volume>31</volume>: <fpage>814</fpage>–<lpage>21</lpage>. <pub-id pub-id-type="doi">10.1038/nbt.2676</pub-id><?supplied-pmid 23975157?><pub-id pub-id-type="pmid">23975157</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0219235.ref015">
      <label>15</label>
      <mixed-citation publication-type="journal"><name><surname>Aßhauer</surname><given-names>KP</given-names></name>, <name><surname>Wemheuer</surname><given-names>B</given-names></name>, <name><surname>Daniel</surname><given-names>R</given-names></name>, <name><surname>Meinicke</surname><given-names>P</given-names></name>. <article-title>Tax4Fun: predicting functional profiles from metagenomic 16S rRNA data</article-title>. <source>Bioinformatics</source>. <year>2015</year>;<volume>31</volume>: <fpage>2882</fpage>–<lpage>2884</lpage>. <pub-id pub-id-type="doi">10.1093/bioinformatics/btv287</pub-id><?supplied-pmid 25957349?><pub-id pub-id-type="pmid">25957349</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0219235.ref016">
      <label>16</label>
      <mixed-citation publication-type="journal"><name><surname>Iwai</surname><given-names>S</given-names></name>, <name><surname>Weinmaier</surname><given-names>T</given-names></name>, <name><surname>Schmidt</surname><given-names>BL</given-names></name>, <name><surname>Albertson</surname><given-names>DG</given-names></name>, <name><surname>Poloso</surname><given-names>NJ</given-names></name>, <name><surname>Dabbagh</surname><given-names>K</given-names></name>, <etal>et al</etal><article-title>Piphillin: Improved prediction of metagenomic content by direct inference from human microbiomes</article-title>. <source>PLoS One</source>. <year>2016</year>;<volume>11</volume>: <fpage>1</fpage>–<lpage>18</lpage>. <pub-id pub-id-type="doi">10.1371/journal.pone.0166104</pub-id><?supplied-pmid 27820856?><pub-id pub-id-type="pmid">27820856</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0219235.ref017">
      <label>17</label>
      <mixed-citation publication-type="journal"><name><surname>Edgar</surname><given-names>RC</given-names></name>. <article-title>SINAPS: Prediction of microbial traits from marker gene sequences</article-title>. <source>bioRxiv</source>. <year>2017</year>; <pub-id pub-id-type="doi">10.1101/124156</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0219235.ref018">
      <label>18</label>
      <mixed-citation publication-type="journal"><name><surname>Knights</surname><given-names>D</given-names></name>, <name><surname>Kuczynski</surname><given-names>J</given-names></name>, <name><surname>Charlson</surname><given-names>ES</given-names></name>, <name><surname>Zaneveld</surname><given-names>J</given-names></name>, <name><surname>Mozer</surname><given-names>MC</given-names></name>, <name><surname>Collman</surname><given-names>RG</given-names></name>, <etal>et al</etal><article-title>Bayesian community-wide culture-independent microbial source tracking</article-title>. <source>Nat Methods</source>. <year>2013</year>;<volume>8</volume>: <fpage>761</fpage>–<lpage>763</lpage>.</mixed-citation>
    </ref>
    <ref id="pone.0219235.ref019">
      <label>19</label>
      <mixed-citation publication-type="journal"><name><surname>Blei</surname><given-names>DM</given-names></name>, <name><surname>Lafferty</surname><given-names>JD</given-names></name>. <article-title>A correlated topic model of Science</article-title>. <source>Ann Appl Stat</source>. <year>2007</year>;<volume>1</volume>: <fpage>17</fpage>–<lpage>35</lpage>. <pub-id pub-id-type="doi">10.1214/07-AOAS136</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0219235.ref020">
      <label>20</label>
      <mixed-citation publication-type="journal"><name><surname>Roberts</surname><given-names>ME</given-names></name>, <name><surname>Stewart</surname><given-names>BM</given-names></name>, <name><surname>Tingley</surname><given-names>D</given-names></name>, <name><surname>Lucas</surname><given-names>C</given-names></name>, <name><surname>Leder-Luis</surname><given-names>J</given-names></name>, <name><surname>Gadarian</surname><given-names>SK</given-names></name>, <etal>et al</etal><article-title>Structural topic models for open-ended survey responses</article-title>. <source>Am J Pol Sci</source>. <year>2014</year>;<volume>58</volume>: <fpage>1064</fpage>–<lpage>1082</lpage>. <pub-id pub-id-type="doi">10.1111/ajps.12103</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0219235.ref021">
      <label>21</label>
      <mixed-citation publication-type="journal"><name><surname>Gevers</surname><given-names>D</given-names></name>, <name><surname>Kugathasan</surname><given-names>S</given-names></name>, <name><surname>Denson</surname><given-names>LA</given-names></name>, <name><surname>Vázquez-Baeza</surname><given-names>Y</given-names></name>, <name><surname>Van Treuren</surname><given-names>W</given-names></name>, <name><surname>Ren</surname><given-names>B</given-names></name>, <etal>et al</etal><article-title>The Treatment-Naive Microbiome in New-Onset Crohn’s Disease</article-title>. <source>Cell Host Microbe</source>. <year>2014</year>;<volume>15</volume>: <fpage>382</fpage>–<lpage>392</lpage>. <pub-id pub-id-type="doi">10.1016/j.chom.2014.02.005</pub-id><?supplied-pmid 24629344?><pub-id pub-id-type="pmid">24629344</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0219235.ref022">
      <label>22</label>
      <mixed-citation publication-type="journal"><name><surname>Schmidt</surname><given-names>BL</given-names></name>, <name><surname>Kuczynski</surname><given-names>J</given-names></name>, <name><surname>Bhattacharya</surname><given-names>A</given-names></name>, <name><surname>Huey</surname><given-names>B</given-names></name>, <name><surname>Corby</surname><given-names>PM</given-names></name>, <name><surname>Queiroz</surname><given-names>EL</given-names></name>, <etal>et al</etal><article-title>Changes in abundance of oral microbiota associated with oral cancer</article-title>. <source>PLoS One</source>. <year>2014</year>;<volume>9</volume>: <fpage>e98741</fpage><pub-id pub-id-type="doi">10.1371/journal.pone.0098741</pub-id><?supplied-pmid 24887397?><pub-id pub-id-type="pmid">24887397</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0219235.ref023">
      <label>23</label>
      <mixed-citation publication-type="journal"><name><surname>David</surname><given-names>LA</given-names></name>, <name><surname>Materna</surname><given-names>AC</given-names></name>, <name><surname>Friedman</surname><given-names>J</given-names></name>, <name><surname>Baptista</surname><given-names>MIC</given-names></name>, <name><surname>Blackburn</surname><given-names>MC</given-names></name>, <name><surname>Perrotta</surname><given-names>A</given-names></name>, <etal>et al</etal><article-title>Host lifestyle affects human microbiota on daily timescales</article-title>. <source>Genome Biol</source>. <year>2016</year>;<volume>17</volume>: <fpage>117</fpage><pub-id pub-id-type="doi">10.1186/s13059-016-0988-y</pub-id><?supplied-pmid 27246704?><pub-id pub-id-type="pmid">27246704</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0219235.ref024">
      <label>24</label>
      <mixed-citation publication-type="journal"><name><surname>Caporaso</surname><given-names>J</given-names></name>, <name><surname>Kuczynski</surname><given-names>J</given-names></name>, <name><surname>Stombaugh</surname><given-names>J</given-names></name>, <name><surname>Bittinger</surname><given-names>K</given-names></name>, <name><surname>Bushman</surname></name>. <article-title>QIIME allows analysis of high-throughput community sequencing data</article-title>. <source>Nat Methods</source>. <year>2012</year>;<volume>7</volume>: <fpage>335</fpage>–<lpage>336</lpage>. <pub-id pub-id-type="doi">10.1038/nmeth.f.303</pub-id><?supplied-pmid 20383131?><pub-id pub-id-type="pmid">20383131</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0219235.ref025">
      <label>25</label>
      <mixed-citation publication-type="journal"><name><surname>Ogata</surname><given-names>H</given-names></name>, <name><surname>Goto</surname><given-names>S</given-names></name>, <name><surname>Sato</surname><given-names>K</given-names></name>, <name><surname>Fujibuchi</surname><given-names>W</given-names></name>, <name><surname>Bono</surname><given-names>H</given-names></name>, <name><surname>Kanehisa</surname><given-names>M</given-names></name>. <article-title>KEGG: Kyoto encyclopedia of genes and genomes</article-title>. <source>Nucleic Acids Research</source>. <year>1999</year> pp. <fpage>29</fpage>–<lpage>34</lpage>. <pub-id pub-id-type="doi">10.1093/nar/27.1.29</pub-id>
<?supplied-pmid 9847135?><pub-id pub-id-type="pmid">9847135</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0219235.ref026">
      <label>26</label>
      <mixed-citation publication-type="book"><name><surname>Legendre</surname><given-names>P</given-names></name>, <name><surname>Legendre</surname><given-names>L</given-names></name>. <chapter-title>Numerical Ecology</chapter-title>—<edition>Second English Edition</edition><source>Developments in Environmental Modelling</source>. <year>1998</year>.</mixed-citation>
    </ref>
    <ref id="pone.0219235.ref027">
      <label>27</label>
      <mixed-citation publication-type="journal"><name><surname>Hardoon</surname><given-names>DDR</given-names></name>, <name><surname>Shawe-Taylor</surname><given-names>J</given-names></name>. <article-title>Sparse canonical correlation analysis</article-title>. <source>Mach Learn</source>. <year>2011</year>;<volume>10</volume>: <fpage>1</fpage>–<lpage>15</lpage>. <pub-id pub-id-type="doi">10.1007/s10994-010-5222-7</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0219235.ref028">
      <label>28</label>
      <mixed-citation publication-type="journal"><name><surname>De Valpine</surname><given-names>P</given-names></name>, <name><surname>Harmon-Threatt</surname><given-names>AN</given-names></name>. <article-title>General models for resource use or other compositional count data using the Dirichlet-multinomial distribution</article-title>. <source>Ecology</source>. <year>2013</year>;<volume>94</volume>: <fpage>2678</fpage>–<lpage>2687</lpage>. <pub-id pub-id-type="doi">10.1890/12-0416.1</pub-id><?supplied-pmid 24597215?><pub-id pub-id-type="pmid">24597215</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0219235.ref029">
      <label>29</label>
      <mixed-citation publication-type="journal"><name><surname>Holmes</surname><given-names>I</given-names></name>, <name><surname>Harris</surname><given-names>K</given-names></name>, <name><surname>Quince</surname><given-names>C</given-names></name>. <article-title>Dirichlet multinomial mixtures: Generative models for microbial metagenomics</article-title>. <source>PLoS One</source>. <year>2012</year>;<volume>7</volume><pub-id pub-id-type="doi">10.1371/journal.pone.0030126</pub-id><?supplied-pmid 22319561?><pub-id pub-id-type="pmid">22319561</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0219235.ref030">
      <label>30</label>
      <mixed-citation publication-type="journal"><name><surname>Brien</surname><given-names>JDO</given-names></name>, <name><surname>Record</surname><given-names>N</given-names></name>. <article-title>The power and pitfalls of Dirichlet-multinomial mixture models for ecological count data</article-title>. <source>bioRxiv</source>. <year>2016</year>; <fpage>1</fpage>–<lpage>22</lpage>. <pub-id pub-id-type="doi">10.1101/045468</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0219235.ref031">
      <label>31</label>
      <mixed-citation publication-type="journal"><name><surname>Mimno</surname><given-names>D</given-names></name>, <name><surname>McCallum</surname><given-names>A</given-names></name>. <article-title>Topic models conditioned on arbitrary features with dirichlet-multinomial regression</article-title>. <source>arXiv Prepr arXiv12063278</source>. <year>2012</year>;</mixed-citation>
    </ref>
    <ref id="pone.0219235.ref032">
      <label>32</label>
      <mixed-citation publication-type="journal"><name><surname>Kembel</surname><given-names>SW</given-names></name>, <name><surname>Wu</surname><given-names>M</given-names></name>, <name><surname>Eisen</surname><given-names>JA</given-names></name>, <name><surname>Green</surname><given-names>JL</given-names></name>. <article-title>Incorporating 16S Gene Copy Number Information Improves Estimates of Microbial Diversity and Abundance</article-title>. <source>PLoS Comput Biol</source>. <year>2012</year>;<volume>8</volume>: <fpage>16</fpage>–<lpage>18</lpage>. <pub-id pub-id-type="doi">10.1371/journal.pcbi.1002743</pub-id><?supplied-pmid 23133348?><pub-id pub-id-type="pmid">23133348</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0219235.ref033">
      <label>33</label>
      <mixed-citation publication-type="other">Roberts, Margaret E., Stewart BM, Tingley D. stm: R Package for Structural Topic Models [Internet]. 2017. <ext-link ext-link-type="uri" xlink:href="http://www.structuraltopicmodel.com">http://www.structuraltopicmodel.com</ext-link>.</mixed-citation>
    </ref>
    <ref id="pone.0219235.ref034">
      <label>34</label>
      <mixed-citation publication-type="journal"><name><surname>Blei</surname><given-names>DM</given-names></name>, <name><surname>Ng</surname><given-names>AY</given-names></name>, <name><surname>Jordan</surname><given-names>MI</given-names></name>. <source>Latent Dirichlet Allocation</source>. <year>2003</year>;<volume>3</volume>: <fpage>993</fpage>–<lpage>1022</lpage>.</mixed-citation>
    </ref>
    <ref id="pone.0219235.ref035">
      <label>35</label>
      <mixed-citation publication-type="journal"><name><surname>Blei</surname><given-names>DM</given-names></name>, <name><surname>McAuliffe</surname><given-names>JD</given-names></name>, <name><surname>Blei</surname><given-names>DM</given-names></name>. <article-title>Supervised Topic Models</article-title>. <source>Adv Neural Inf Process Syst 20</source>. <year>2008</year>;<volume>21</volume>: <fpage>1</fpage>–<lpage>22</lpage>.</mixed-citation>
    </ref>
    <ref id="pone.0219235.ref036">
      <label>36</label>
      <mixed-citation publication-type="journal"><name><surname>Kanehisa</surname><given-names>M</given-names></name>, <name><surname>Goto</surname><given-names>S</given-names></name>, <name><surname>Sato</surname><given-names>Y</given-names></name>, <name><surname>Furumichi</surname><given-names>M</given-names></name>, <name><surname>Tanabe</surname><given-names>M</given-names></name>. <article-title>KEGG for integration and interpretation of large-scale molecular data sets</article-title>. <source>Nucleic Acids Res</source>. <year>2012</year>;<volume>40</volume><pub-id pub-id-type="doi">10.1093/nar/gkr988</pub-id><?supplied-pmid 22080510?><pub-id pub-id-type="pmid">22080510</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0219235.ref037">
      <label>37</label>
      <mixed-citation publication-type="other">Stan Development Team. rstanarm: Bayesian applied regression modeling via Stan [Internet]. 2016. <ext-link ext-link-type="uri" xlink:href="http://mc-stan.org/">http://mc-stan.org/</ext-link></mixed-citation>
    </ref>
    <ref id="pone.0219235.ref038">
      <label>38</label>
      <mixed-citation publication-type="journal"><name><surname>Gelman</surname><given-names>A</given-names></name>, <name><surname>Rubin</surname><given-names>DB</given-names></name>. <article-title>Inference from Iterative Simulation Using Multiple Sequences</article-title>. <source>Stat Sci</source>. <year>1992</year>;<volume>7</volume>: <fpage>457</fpage>–<lpage>511</lpage>. <pub-id pub-id-type="doi">10.1214/ss/1177011136</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0219235.ref039">
      <label>39</label>
      <mixed-citation publication-type="journal"><name><surname>Callahan</surname><given-names>BJ</given-names></name>, <name><surname>Mcmurdie</surname><given-names>PJ</given-names></name>, <name><surname>Rosen</surname><given-names>MJ</given-names></name>, <name><surname>Han</surname><given-names>AW</given-names></name>, <name><surname>Johnson</surname><given-names>AJ</given-names></name>, <name><surname>Holmes</surname><given-names>SP</given-names></name>. <article-title>DADA2 : High resolution sample inference from amplicon data</article-title>. <source>bioRxiv</source>. <year>2015</year>;<volume>13</volume>: <fpage>0</fpage>–<lpage>14</lpage>. <pub-id pub-id-type="doi">10.1101/024034</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
<sub-article id="pone.0219235.r001" article-type="aggregated-review-documents">
  <front-stub>
    <article-id pub-id-type="doi">10.1371/journal.pone.0219235.r001</article-id>
    <title-group>
      <article-title>Decision Letter 0</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Loor</surname>
          <given-names>Juan J</given-names>
        </name>
        <role>Academic Editor</role>
      </contrib>
    </contrib-group>
    <permissions>
      <copyright-statement>© 2019 Juan J Loor</copyright-statement>
      <copyright-year>2019</copyright-year>
      <copyright-holder>Juan J Loor</copyright-holder>
      <license xlink:href="http://creativecommons.org/licenses/by/4.0/">
        <license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
      </license>
    </permissions>
    <related-article id="rel-obj001" ext-link-type="doi" xlink:href="10.1371/journal.pone.0219235" related-article-type="reviewed-article"/>
    <custom-meta-group>
      <custom-meta>
        <meta-name>Submission Version</meta-name>
        <meta-value>0</meta-value>
      </custom-meta>
    </custom-meta-group>
  </front-stub>
  <body>
    <p>
      <named-content content-type="letter-date">12 Aug 2019</named-content>
    </p>
    <p>PONE-D-19-17255</p>
    <p>Themetagenomics: Exploring Thematic Structure and Predicted Functionality of 16s rRNA Amplicon Data</p>
    <p>PLOS ONE</p>
    <p>Dear Mr. Woloszynek,</p>
    <p>Thank you for submitting your manuscript to PLOS ONE. After careful consideration, we feel that it has merit but does not fully meet PLOS ONE’s publication criteria as it currently stands. Therefore, we invite you to submit a revised version of the manuscript that addresses the points raised during the review process.</p>
    <p>We would appreciate receiving your revised manuscript by Sep 26 2019 11:59PM. When you are ready to submit your revision, log on to <ext-link ext-link-type="uri" xlink:href="https://www.editorialmanager.com/pone/">https://www.editorialmanager.com/pone/</ext-link> and select the 'Submissions Needing Revision' folder to locate your manuscript file.</p>
    <p>If you would like to make changes to your financial disclosure, please include your updated statement in your cover letter.</p>
    <p>To enhance the reproducibility of your results, we recommend that if applicable you deposit your laboratory protocols in protocols.io, where a protocol can be assigned its own identifier (DOI) such that it can be cited independently in the future. For instructions see: <ext-link ext-link-type="uri" xlink:href="http://journals.plos.org/plosone/s/submission-guidelines#loc-laboratory-protocols">http://journals.plos.org/plosone/s/submission-guidelines#loc-laboratory-protocols</ext-link></p>
    <p>Please include the following items when submitting your revised manuscript:</p>
    <p>
      <list list-type="bullet">
        <list-item>
          <p>A rebuttal letter that responds to each point raised by the academic editor and reviewer(s). This letter should be uploaded as separate file and labeled 'Response to Reviewers'.</p>
        </list-item>
        <list-item>
          <p>A marked-up copy of your manuscript that highlights changes made to the original version. This file should be uploaded as separate file and labeled 'Revised Manuscript with Track Changes'.</p>
        </list-item>
        <list-item>
          <p>An unmarked version of your revised paper without tracked changes. This file should be uploaded as separate file and labeled 'Manuscript'.</p>
        </list-item>
      </list>
    </p>
    <p>Please note while forming your response, if your article is accepted, you may have the opportunity to make the peer review history publicly available. The record will include editor decision letters (with reviews) and your responses to reviewer comments. If eligible, we will contact you to opt in or out.</p>
    <p>We look forward to receiving your revised manuscript.</p>
    <p>Kind regards,</p>
    <p>Juan J Loor</p>
    <p>Academic Editor</p>
    <p>PLOS ONE</p>
    <p>Journal requirements:</p>
    <p>When submitting your revision, we need you to address these additional requirements.</p>
    <p>1. Please ensure that your manuscript meets PLOS ONE's style requirements, including those for file naming. The PLOS ONE style templates can be found at</p>
    <p><ext-link ext-link-type="uri" xlink:href="http://www.journals.plos.org/plosone/s/file?id=wjVg/PLOSOne_formatting_sample_main_body.pdf">http://www.journals.plos.org/plosone/s/file?id=wjVg/PLOSOne_formatting_sample_main_body.pdf</ext-link> and <ext-link ext-link-type="uri" xlink:href="http://www.journals.plos.org/plosone/s/file?id=ba62/PLOSOne_formatting_sample_title_authors_affiliations.pdf">http://www.journals.plos.org/plosone/s/file?id=ba62/PLOSOne_formatting_sample_title_authors_affiliations.pdf</ext-link></p>
    <p>2. We note that you have stated that you will provide repository information for your data at acceptance. Should your manuscript be accepted for publication, we will hold it until you provide the relevant accession numbers or DOIs necessary to access your data. If you wish to make changes to your Data Availability statement, please describe these changes in your cover letter and we will update your Data Availability statement to reflect the information you provide.</p>
    <p>[Note: HTML markup is below. Please do not edit.]</p>
    <p>Reviewers' comments:</p>
    <p>Reviewer's Responses to Questions</p>
    <p>
      <bold>Comments to the Author</bold>
    </p>
    <p>1. Is the manuscript technically sound, and do the data support the conclusions?</p>
    <p>The manuscript must describe a technically sound piece of scientific research with data that supports the conclusions. Experiments must have been conducted rigorously, with appropriate controls, replication, and sample sizes. The conclusions must be drawn appropriately based on the data presented. </p>
    <p>Reviewer #1: Yes</p>
    <p>Reviewer #2: Yes</p>
    <p>Reviewer #3: Partly</p>
    <p>**********</p>
    <p>2. Has the statistical analysis been performed appropriately and rigorously? </p>
    <p>Reviewer #1: Yes</p>
    <p>Reviewer #2: Yes</p>
    <p>Reviewer #3: Yes</p>
    <p>**********</p>
    <p>3. Have the authors made all data underlying the findings in their manuscript fully available?</p>
    <p>The <ext-link ext-link-type="uri" xlink:href="http://www.plosone.org/static/policies.action#sharing">PLOS Data policy</ext-link> requires authors to make all data underlying the findings described in their manuscript fully available without restriction, with rare exception (please refer to the Data Availability Statement in the manuscript PDF file). The data should be provided as part of the manuscript or its supporting information, or deposited to a public repository. For example, in addition to summary statistics, the data points behind means, medians and variance measures should be available. If there are restrictions on publicly sharing data—e.g. participant privacy or use of data from a third party—those must be specified.</p>
    <p>Reviewer #1: Yes</p>
    <p>Reviewer #2: Yes</p>
    <p>Reviewer #3: Yes</p>
    <p>**********</p>
    <p>4. Is the manuscript presented in an intelligible fashion and written in standard English?</p>
    <p>PLOS ONE does not copyedit accepted manuscripts, so the language in submitted articles must be clear, correct, and unambiguous. Any typographical or grammatical errors should be corrected at revision, so please note any specific errors here.</p>
    <p>Reviewer #1: Yes</p>
    <p>Reviewer #2: Yes</p>
    <p>Reviewer #3: Yes</p>
    <p>**********</p>
    <p>5. Review Comments to the Author</p>
    <p>Please use the space provided to explain your answers to the questions above. You may also include additional comments for the author, including concerns about dual publication, research ethics, or publication ethics. (Please upload your review as an attachment if it exceeds 20,000 characters)</p>
    <p>Reviewer #1: The manuscript by Woloszynek et al. presented an interesting tool based on STM to link co-occurring groups of taxa with sample metadata and enable to analyze the interactions between topics and pathways. The tool is a good addition to or extension of several recently developed balance-based approaches, such as selbal (Rivera-Pinto et al., 2018).</p>
    <p>1. When the discussion of limitations of the approach is particularly interesting, the authors may consider adding the discussion of the minimal value for M (samples) and/or sequencing depth L560 and its implications.</p>
    <p>2. For the tool to be widely utilized by bench biologists in the microbiome community, the reviewer strongly recommended to publish a Galaxy version.</p>
    <p>3. It would be very helpful if the authors add a section on typical output formats/files so that readers can have a better evaluation of the tool utility without actually running the algorithm.</p>
    <p>4. The provided link <ext-link ext-link-type="uri" xlink:href="https://github.com/EESI/themetagenomics">https://github.com/EESI/themetagenomics</ext-link> has not been updated and it does not include a user-friendly manual.</p>
    <p>Reviewer #2: Comments to the Author</p>
    <p>Overview</p>
    <p>This paper describes a workflow and a tool to conduct a topic model based inference of microbial taxonomic and functional signatures of specific metadata from 16S rRNA gene amplicon sequencing data. Although shotgun metagenomics become cheaper and more common, still the amplicon sequencing is widely used in microbial community analyses. The topic model is already applied to the taxonomic composition data of microbial community in some studies [Chen et al. 2011, Shafiei et al. 2015, Yan et al. 2017, Higashi et al. 2018]. But this manuscript and the R-based package "themetagenomics" provide seamless workflow of taxonomic composition data to taxonomic and functional signatures of specific metadata. This package will promote the topic model -based microbial community analyses for many researchers.</p>
    <p>General Comments</p>
    <p>In this manuscript, the reviewer thinks different taxonomic ranks (e.g, species, genus, family) are mixed without any consideration. The taxonomic assignment threshold of 16S rRNA gene sequences in this manuscript is based on the 97% sequence identity. This threshold is usually for species assignment. Therefore, the taxonomic composition should be the species composition (although nearly half of sequences generally cannot be assigned to species).</p>
    <p>However, the combination of QIIME and GreenGenes produce the problematic mixed taxonomic rank composition.</p>
    <p>In the taxonomic composition data in this manuscript, which types of taxonomic composition are used for topic model analyses?</p>
    <p>(i) the abundance of each taxon (e.g., Roseburia) is the sum of the abundances of more detailed taxa (e.g., Roseburia intestinalis, R. hominis, etc.) and the abundance of that taxon (e.g., Roseburia).</p>
    <p>(i.e., Roseburia abundance = R. intestinalis abundance (150 sequences) + Roseburia abundance (50 sequences)).</p>
    <p>(ii) the abundance of each taxon (e.g., Roseburia) is independent of the abundances of more detailed taxa (e.g., Roseburia intestinalis, R. hominis, etc.).</p>
    <p>(i.e., Roseburia abundance = Roseburia abundance (50 sequences)).</p>
    <p>Both types of composition can be calculated from the QIIME and GreenGenes based taxonomic assignment results.</p>
    <p>Line 397</p>
    <p>GreenGenes taxonomic hierarchy (GreenGenes), ChocoPhlAn taxonomic hierarchy (NCBI Taxonomy), and KEGG taxonomic hierarchy (KEGG) are different.</p>
    <p>For example, the species belong to a genus Clostridium are different among three taxonomic hierarchies.</p>
    <p>How to identified all reads belonging to the high frequency taxa (taxonomic name is based on GreenGenes) of each topic in the metagenomic shotgun data (taxonomic name is based on NCBI Taxonomy or KEGG)?</p>
    <p>Specific Comments</p>
    <p>Title</p>
    <p>16s --&gt; 16S</p>
    <p>Line 70</p>
    <p>The authors describe "the normalization transforms the abundances into relative abundances within each sample (compositional data)". However, the sequenced reads data are generally already relative abundance data.</p>
    <p>When the sequencing, almost all of sequencing run contains multiple samples. Then, to avoid extremely different read number per sample, the DNA molecular weight per sample is normalized among samples within each sequencing run by wet experiments. Therefore, the number of sequenced reads generally does not comparable among samples directly without the normalization of total number of reads or the subsampling of reads.</p>
    <p>Line 477</p>
    <p>Supplementary Figure number is wrong.</p>
    <p>Line 614</p>
    <p>Normalization of number of total reads per sample or subsampling of reads was not performed?</p>
    <p>Line 681</p>
    <p>Mulinomial --&gt; Multinomial</p>
    <p>Reviewer #3: 1. The “Thematogenomics” terminology seems rather an arbitrary measurement of the co-occurring microbial functional attributes in a microbial community without a strong scientific basis. The authors should revisit the title and consider revising. It is a “catchy” title but lacks a strong scientific basis for which the authors attempted to establish a unique bioinformatics tool.</p>
    <p>2. The analysis is based upon the HTS of 16S rRNA gene amplicons within the microbial metacommunity DNA to determine predictive metabolic function like the PiCrust analysis of a co-occurring subset of the microbial community (based on the CoNet analysis). The CoNet analysis may produce highly variable keystone taxa including the nodes on the same HTS sample. Thus the reproducibility of the CoNet results may not be achieved.</p>
    <p>3. How do the microbial functional attributes and co-occurring microbial community from 16S rRNA amplicon HTS data if conducted compares to the shotgun metagenomics? Would microbial taxa (OTUs) be different between the two approaches? Validation is necessary.</p>
    <p>4. The primary objective of this study seems the development of a new and unique bioinformatics tool to precisely identify the co-occurring microbial sub-community and the keystone taxa and then use them to determine the predictive functional attributes. The key issue with this manuscript is that the approach uses bias when pre-selecting the functions. If that is correct then how this approach would address the outcome of unknown sample properties during double-blinded studies? There seem to be a flaw in this approach, particularly when unknown samples are tested. The authors should address this limitation.</p>
    <p>5. The study needs to use more than one sample type (multiple clinical as well as environmental) in order to establish a broadly applicable bioinformatics tool. Moreover, the authors used the HTS files available on the open-access database. However, for this study, the authors may consider designing experiments with variable sample parameters to demonstate the modulation of the co-occurring microbial community as well as the keystone taxa resulting into he changes in microbial metabolic functional attributes.</p>
    <p>**********</p>
    <p>6. PLOS authors have the option to publish the peer review history of their article (<ext-link ext-link-type="uri" xlink:href="https://journals.plos.org/plosone/s/editorial-and-peer-review-process#loc-peer-review-history">what does this mean?</ext-link>). If published, this will include your full peer review and any attached files.</p>
    <p>If you choose “no”, your identity will remain anonymous but your review may still be made public.</p>
    <p><bold>Do you want your identity to be public for this peer review?</bold> For information about this choice, including consent withdrawal, please see our <ext-link ext-link-type="uri" xlink:href="https://www.plos.org/privacy-policy">Privacy Policy</ext-link>.</p>
    <p>Reviewer #1: No</p>
    <p>Reviewer #2: No</p>
    <p>Reviewer #3: No</p>
    <p>[NOTE: If reviewer comments were submitted as an attachment file, they will be attached to this email and accessible via the submission site. Please log into your account, locate the manuscript record, and check for the action link "View Attachments". If this link does not appear, there are no attachment files to be viewed.]</p>
    <p>While revising your submission, please upload your figure files to the Preflight Analysis and Conversion Engine (PACE) digital diagnostic tool, <ext-link ext-link-type="uri" xlink:href="https://pacev2.apexcovantage.com/">https://pacev2.apexcovantage.com/</ext-link>. PACE helps ensure that figures meet PLOS requirements. To use PACE, you must first register as a user. Registration is free. Then, login and navigate to the UPLOAD tab, where you will find detailed instructions on how to use the tool. If you encounter any issues or have any questions when using PACE, please email us at <email>figures@plos.org</email>. Please note that Supporting Information files do not need this step.</p>
  </body>
</sub-article>
<sub-article id="pone.0219235.r002" article-type="author-comment">
  <front-stub>
    <article-id pub-id-type="doi">10.1371/journal.pone.0219235.r002</article-id>
    <title-group>
      <article-title>Author response to Decision Letter 0</article-title>
    </title-group>
    <related-article id="rel-obj002" ext-link-type="doi" xlink:href="10.1371/journal.pone.0219235" related-article-type="editor-report"/>
    <custom-meta-group>
      <custom-meta>
        <meta-name>Submission Version</meta-name>
        <meta-value>1</meta-value>
      </custom-meta>
    </custom-meta-group>
  </front-stub>
  <body>
    <p>
      <named-content content-type="author-response-date">25 Sep 2019</named-content>
    </p>
    <p>See attached document for color coded version.</p>
    <p>Reviewer #1: The manuscript by Woloszynek et al. presented an interesting tool based on STM to link co-occurring groups of taxa with sample metadata and enable to analyze the interactions between topics and pathways. The tool is a good addition to or extension of several recently developed balance-based approaches, such as selbal (Rivera-Pinto et al., 2018).</p>
    <p>1. When the discussion of limitations of the approach is particularly interesting, the authors may consider adding the discussion of the minimal value for M (samples) and/or sequencing depth L560 and its implications. -- We added a 4th limitation to the limitations section to address this. We mentioned some of our simulation results from S2_appendix to address this and expanded on that as well. See lines 494-504 of the manuscript.</p>
    <p>2. For the tool to be widely utilized by bench biologists in the microbiome community, the reviewer strongly recommended to publish a Galaxy version. -- We would love to have our package available in other languages and software. We made our selection of R carefully: (1) the STM, which we argue is the topic model of choice for our pipeline, already has a very well written package available in R which we could easily use; (2) R is a popular language for both computational and bench biologists since it has bioconductor and phyloseq, among other packages; (3) R is open source, free to use, and easy to write basic scripts in. We have our package easily available on CRAN -- it and its dependencies are easily installed in R. With that said, we are open to a galaxy implementation of our package -- as it seems straightforward to run R packages in Galaxy. We currently are working on releasing a 1.0 version of themetagenomics in R given the feedback we have received. Once that is complete, we will focus on other ports.</p>
    <p>3. It would be very helpful if the authors add a section on typical output formats/files so that readers can have a better evaluation of the tool utility without actually running the algorithm. -- We added a section at the end of the methods section named “themetagenomics” that describes the input files needed and the outputs generated.</p>
    <p>4. The provided link <ext-link ext-link-type="uri" xlink:href="https://github.com/EESI/themetagenomics">https://github.com/EESI/themetagenomics</ext-link> has not been updated and it does not include a user-friendly manual. -- Themetagenomics is an R package that will have future updates. That site houses the currently working, publicly available code. Because it’s an R package, the package is housed on CRAN where all packages are available (<ext-link ext-link-type="uri" xlink:href="https://cran.r-project.org/web/packages/themetagenomics/index.html">https://cran.r-project.org/web/packages/themetagenomics/index.html</ext-link>) and that page contains basic information as well as vignettes for the user to learn about the package. We have added the CRAN link to the manuscript.</p>
    <p>Reviewer #2: Comments to the Author</p>
    <p>Overview</p>
    <p>This paper describes a workflow and a tool to conduct a topic model based inference of microbial taxonomic and functional signatures of specific metadata from 16S rRNA gene amplicon sequencing data. Although shotgun metagenomics become cheaper and more common, still the amplicon sequencing is widely used in microbial community analyses. The topic model is already applied to the taxonomic composition data of microbial community in some studies [Chen et al. 2011, Shafiei et al. 2015, Yan et al. 2017, Higashi et al. 2018]. But this manuscript and the R-based package "themetagenomics" provide seamless workflow of taxonomic composition data to taxonomic and functional signatures of specific metadata. This package will promote the topic model -based microbial community analyses for many researchers.</p>
    <p>General Comments</p>
    <p>In this manuscript, the reviewer thinks different taxonomic ranks (e.g, species, genus, family) are mixed without any consideration. The taxonomic assignment threshold of 16S rRNA gene sequences in this manuscript is based on the 97% sequence identity. This threshold is usually for species assignment. Therefore, the taxonomic composition should be the species composition (although nearly half of sequences generally cannot be assigned to species).</p>
    <p>However, the combination of QIIME and GreenGenes produce the problematic mixed taxonomic rank composition.</p>
    <p>In the taxonomic composition data in this manuscript, which types of taxonomic composition are used for topic model analyses?</p>
    <p>(i) the abundance of each taxon (e.g., Roseburia) is the sum of the abundances of more detailed taxa (e.g., Roseburia intestinalis, R. hominis, etc.) and the abundance of that taxon (e.g., Roseburia).</p>
    <p>(i.e., Roseburia abundance = R. intestinalis abundance (150 sequences) + Roseburia abundance (50 sequences)).</p>
    <p>(ii) the abundance of each taxon (e.g., Roseburia) is independent of the abundances of more detailed taxa (e.g., Roseburia intestinalis, R. hominis, etc.).</p>
    <p>(i.e., Roseburia abundance = Roseburia abundance (50 sequences)).</p>
    <p>Both types of composition can be calculated from the QIIME and GreenGenes based taxonomic assignment results. -- We use an OTU table, generated via QIIME with GreenGenes at 97% sequence identify, which is loosely considered a “species cutoff,” but just as often includes 16S rRNA from many species or even more than one genus. Once those OTUs and their abundances are put into the table (which is what themetagenomics operates on), taxonomic labels are assigned to the OTUs (via Greengenes in QIIME). For many OTUs, no species-level assignment exists and it’s common not to have OTUs that have genus- or even order- level labels. Only a subset of taxonomies in GreenGenes (or other databases) even report at the species level. But most importantly, we are not fitting the model at any particular taxonomic level. Instead, OTU abundances are used. The OTUs can be mapped to their taxonomic annotations using the Greengenes taxonomic hierarchy provided by QIIME. Doing this mapping does not affect the model fit, since that has already been done. Because we know which OTUs belong to a given topic and their frequency (how frequent they are in that topic), and we know each OTU’s taxonomic hierarchy (again, via QIIME, typically with high-confidence assignments to the genus level), we can extrapolate the frequency of any given family (or other taxonomic level) in that topic as well. </p>
    <p>Line 397</p>
    <p>GreenGenes taxonomic hierarchy (GreenGenes), ChocoPhlAn taxonomic hierarchy (NCBI Taxonomy), and KEGG taxonomic hierarchy (KEGG) are different.</p>
    <p>For example, the species belong to a genus Clostridium are different among three taxonomic hierarchies.</p>
    <p>How to identified all reads belonging to the high frequency taxa (taxonomic name is based on GreenGenes) of each topic in the metagenomic shotgun data (taxonomic name is based on NCBI Taxonomy or KEGG)? -- It is true that there are numerous different extant taxonomic hierarchies, and indeed they are under continued revision. We use GreenGenes, because it has the most comprehensive database of 16S rRNA gene sequences. Fortunately, we made our cross-data comparisons in the functional space, and therefore, we did not have to rely on the differing taxonomies in our comparison of 16S rRNA data to metagenomic data. We converted the 16S rRNA to the functional capacity of its genome via PICRUSt and compared to the functional capacity of the metagenome via KEGG Orthology. (While PICRUSt software converts 16S rRNA to KEGG orthologies, the metagenome data was mapped to UniRef90 protein families that mapped into KEGG orthologies (KOs)). So, all comparisons were on the functional level. Mapping between taxonomies is beyond the scope of this manuscript, though we note that the DSMZ maintains an up-to-date list that includes synonyms (<ext-link ext-link-type="uri" xlink:href="https://www.dsmz.de/services/online-tools/prokaryotic-nomenclature-up-to-date">https://www.dsmz.de/services/online-tools/prokaryotic-nomenclature-up-to-date</ext-link>), and some studies have attempted to map different taxonomies onto each other (<ext-link ext-link-type="uri" xlink:href="https://bmcgenomics.biomedcentral.com/articles/10.1186/s12864-017-3501-4">https://bmcgenomics.biomedcentral.com/articles/10.1186/s12864-017-3501-4</ext-link>). .</p>
    <p>Specific Comments</p>
    <p>Title</p>
    <p>16s --&gt; 16S -- done</p>
    <p>Line 70</p>
    <p>The authors describe "the normalization transforms the abundances into relative abundances within each sample (compositional data)". However, the sequenced reads data are generally already relative abundance data.</p>
    <p>When the sequencing, almost all of sequencing run contains multiple samples. Then, to avoid extremely different read number per sample, the DNA molecular weight per sample is normalized among samples within each sequencing run by wet experiments. Therefore, the number of sequenced reads generally does not comparable among samples directly without the normalization of total number of reads or the subsampling of reads. -- Yes. We are not challenging normalization and its importance. We are saying that methods that simply subsample or normalize a sample’s reads by the total number of reads in a sample present their own issues (and that is why normalization method should be carefully chosen), which are detailed in the cited papers, notably 5-8, which are all cited in this section.</p>
    <p>Line 477</p>
    <p>Supplementary Figure number is wrong. -- figure number is correct. It is figure S4 in the supplementary figures file, so “Figure S4. Clusters via hierarchical clustering (k=12) applied to the David et al. dataset (subset B). Red lines signify the presentation of illness” in “S1_supporting_figures.docx”</p>
    <p>Line 614</p>
    <p>Normalization of number of total reads per sample or subsampling of reads was not performed? -- the topic model measures the frequency of features/OTUs within samples, so it essentially normalizing by the total number of reads. But this is done via the topic model, so no additional normalization was done before fitting the model besides normalizing by 16S copy number differences (an approach done in PICRUSt). The cited article (33) is referring to an early preprint of these results where we compared different normalization approaches used before fitting the topic model, to see if additional normalization is warranted. We compared rarefying, the DESeq2 approach, and simply dividing by the total number of reads (which again, is done implicitly by the topic model). Our results indicated that no additional normalization was necessary. We now point out that these points are detailed in the appendix (S2_appendix.docx) which is now mentioned. Also, we mentioned that we do copy number normalization for downstream PICRUSt use.</p>
    <p>Line 681</p>
    <p>Mulinomial --&gt; Multinomial -- done</p>
    <p>Reviewer #3: 1. The “Themetagenomics” terminology seems rather an arbitrary measurement of the co-occurring microbial functional attributes in a microbial community without a strong scientific basis. The authors should revisit the title and consider revising. It is a “catchy” title but lacks a strong scientific basis for which the authors attempted to establish a unique bioinformatics tool. -- We like our package name, but after consideration of this comment, we are dropping themetagenomics from the title.</p>
    <p>2. The analysis is based upon the HTS of 16S rRNA gene amplicons within the microbial metacommunity DNA to determine predictive metabolic function like the PiCrust analysis of a co-occurring subset of the microbial community (based on the CoNet analysis). The CoNet analysis may produce highly variable keystone taxa including the nodes on the same HTS sample. Thus the reproducibility of the CoNet results may not be achieved. -- Functional prediction from taxonomic abundances faces many challenges. One advantage of using topics instead of co-occurrence networks is that each topic consists of estimated relative frequencies of OTUs, which allows for downstream approaches such as using PICRUSt to gain insight into functional content differences among topics. Also, topics need not be “pruned” to find distinct groups of co-occurring taxa; the topics themselves are the groups. Also, given that the topic model presents relative frequencies of OTUs within topics and relative frequencies of topics within samples, these frequencies can easily be used to identify associations with sample-level information via familiar methods such as regression. Lastly, the structural topic model can be given an initialization (or initial seed) that yields the same results every time -- therefore reproducibility is ensured and the taxa-to-topic mapping will not change with the same initializations.</p>
    <p>3. How do the microbial functional attributes and co-occurring microbial community from 16S rRNA amplicon HTS data if conducted compares to the shotgun metagenomics? Would microbial taxa (OTUs) be different between the two approaches? Validation is necessary. -- We address this in the section titled “Validating the Functional Predictions of Themetagenomics via Paired MGS Samples.” We showed that the predicted functional content between sample matched 16S rRNA amplicon surveys matched the functional content found in the same topics using metagenomic shotgun sequencing data. The purpose of this simulation was to show that, despite multiple steps, the signal can be trusted. We are fitting topics with 16S rRNA gene amplicon surveys, then using PICRUSt to predict within-topic functional content, and then fitting a fully Bayesian multi-level model to extract topic-gene pathway interactions. We were concerned about spurious correlations/false positives given the number of steps. Hence, we validated our approach using MGS data.</p>
    <p>In terms of comparing topic/OTU frequency using 16S rRNA amplicon surveys and topic/taxa frequencies using MGS data, we don’t believe this will provide much beyond showing that the two datasets are consistent, which is done in the paper describing the data we used. Topic models have been used for quite some time and have been shown to accurately estimate feature co-occurrence. Given our simulations in the supplement, previous topic model literature, and topic models used in microbiome work, there is a strong foundation that shows the “clustering” is accurate. Comparing topics between the two datasets will simply show that the datasets themselves are similar, which is described in the paper that generated the data.</p>
    <p>4. The primary objective of this study seems the development of a new and unique bioinformatics tool to precisely identify the co-occurring microbial sub-community and the keystone taxa and then use them to determine the predictive functional attributes. The key issue with this manuscript is that the approach uses bias when pre-selecting the functions. If that is correct then how this approach would address the outcome of unknown sample properties during double-blinded studies? There seem to be a flaw in this approach, particularly when unknown samples are tested. The authors should address this limitation. -- We don’t understand the reviewer when s/he states that “bias” was used to “pre-select” function. Although we did omit pathway categories with little-to-no applicability to microbes, we did not influence the way in which our topics “cluster,” nor did we influence which gene functions fell into which topics. Again, we omitted categories that the genes can be annotated with. We never manipulated in anyway which gene fell into which topic. A given gene may have 5 potential pathways it can be annotated with. If one of those pathways was a human CNS pathway, we omitted it. This was done for computational concerns. More pathways led to more combinations and hence a larger feature space to work with for the Bayesian multi-level model, which are already computationally expensive.</p>
    <p>We are also confused about where double blinding and unknown sample properties come into play. If a given dataset had no sample level information, then one would simply fit topics without any associated co-variates and explore taxa or gene function co-occurrence. S/he would not be able to link these topics to sample-level information because that information is not available, but this would not render the model obsolete, nor would one not be able to fit the model. Still, it is certainly common for a microbiome study to have sample-level information.</p>
    <p>In terms of “unknown” samples. We are unsure what the author is suggesting. Samples without labels for training? The topic model is completely unsupervised. It does not need labels to be fitted, nor does it perform prediction, so cross validation and the like is not necessary. If one were to have “completely unknown samples,” that person can simply fit the topic model, predict the gene function, and explore the co-occurrence. Labels are not necessary, but if they are available, then additional exploration can be done to identify interesting sample-level/topic relationships, similar to any analyses that can be done on any given microbiome dataset. </p>
    <p>5. The study needs to use more than one sample type (multiple clinical as well as environmental) in order to establish a broadly applicable bioinformatics tool. Moreover, the authors used the HTS files available on the open-access database. However, for this study, the authors may consider designing experiments with variable sample parameters to demonstate the modulation of the co-occurring microbial community as well as the keystone taxa resulting into he changes in microbial metabolic functional attributes. -- We appreciate the suggestion by the author. In terms of “more than one sample type,” our work uses multiple human microbiome studies given their sample depth and sample-level data that’s available. These studies are well cited, well understood, and often used as datasets for methods development. So they act as a good baseline for us to interpret our results. The sample “types” are the same, however. They are all microbiome count data generated via 16S rRNA amplicon sequencing, and they all come from human subjects. </p>
    <p>Also, in the supplement, we generate multiple synthetic count datasets that demonstrates different modulation configurations of the co-occurring microbial communities. We vary characteristics ranging from sparsity to sample-level feature effect size of the communities. These simulations thoroughly test the topic models capability of capturing co-occurring taxa under various co-occurrence scenarios, and the results should be applicable to potential datasets from a variety of situations.</p>
    <supplementary-material content-type="local-data" id="pone.0219235.s003">
      <label>Attachment</label>
      <caption>
        <p>Submitted filename: <named-content content-type="submitted-filename">Response to Reviewers.pdf</named-content></p>
      </caption>
      <media xlink:href="pone.0219235.s003.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </body>
</sub-article>
<sub-article id="pone.0219235.r003" article-type="aggregated-review-documents">
  <front-stub>
    <article-id pub-id-type="doi">10.1371/journal.pone.0219235.r003</article-id>
    <title-group>
      <article-title>Decision Letter 1</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Loor</surname>
          <given-names>Juan J</given-names>
        </name>
        <role>Academic Editor</role>
      </contrib>
    </contrib-group>
    <permissions>
      <copyright-statement>© 2019 Juan J Loor</copyright-statement>
      <copyright-year>2019</copyright-year>
      <copyright-holder>Juan J Loor</copyright-holder>
      <license xlink:href="http://creativecommons.org/licenses/by/4.0/">
        <license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
      </license>
    </permissions>
    <related-article id="rel-obj003" ext-link-type="doi" xlink:href="10.1371/journal.pone.0219235" related-article-type="reviewed-article"/>
    <custom-meta-group>
      <custom-meta>
        <meta-name>Submission Version</meta-name>
        <meta-value>1</meta-value>
      </custom-meta>
    </custom-meta-group>
  </front-stub>
  <body>
    <p>
      <named-content content-type="letter-date">21 Oct 2019</named-content>
    </p>
    <p>Exploring Thematic Structure and Predicted Functionality of 16S rRNA Amplicon Data</p>
    <p>PONE-D-19-17255R1</p>
    <p>Dear Dr. Woloszynek,</p>
    <p>We are pleased to inform you that your manuscript has been judged scientifically suitable for publication and will be formally accepted for publication once it complies with all outstanding technical requirements.</p>
    <p>Within one week, you will receive an e-mail containing information on the amendments required prior to publication. When all required modifications have been addressed, you will receive a formal acceptance letter and your manuscript will proceed to our production department and be scheduled for publication.</p>
    <p>Shortly after the formal acceptance letter is sent, an invoice for payment will follow. To ensure an efficient production and billing process, please log into Editorial Manager at <ext-link ext-link-type="uri" xlink:href="https://www.editorialmanager.com/pone/">https://www.editorialmanager.com/pone/</ext-link>, click the "Update My Information" link at the top of the page, and update your user information. If you have any billing related questions, please contact our Author Billing department directly at <email>authorbilling@plos.org</email>.</p>
    <p>If your institution or institutions have a press office, please notify them about your upcoming paper to enable them to help maximize its impact. If they will be preparing press materials for this manuscript, you must inform our press team as soon as possible and no later than 48 hours after receiving the formal acceptance. Your manuscript will remain under strict press embargo until 2 pm Eastern Time on the date of publication. For more information, please contact <email>onepress@plos.org</email>.</p>
    <p>With kind regards,</p>
    <p>Juan J Loor</p>
    <p>Academic Editor</p>
    <p>PLOS ONE</p>
    <p>Additional Editor Comments (optional):</p>
    <p>Reviewers' comments:</p>
    <p>Reviewer's Responses to Questions</p>
    <p>
      <bold>Comments to the Author</bold>
    </p>
    <p>1. If the authors have adequately addressed your comments raised in a previous round of review and you feel that this manuscript is now acceptable for publication, you may indicate that here to bypass the “Comments to the Author” section, enter your conflict of interest statement in the “Confidential to Editor” section, and submit your "Accept" recommendation.</p>
    <p>Reviewer #1: All comments have been addressed</p>
    <p>Reviewer #2: All comments have been addressed</p>
    <p>**********</p>
    <p>2. Is the manuscript technically sound, and do the data support the conclusions?</p>
    <p>The manuscript must describe a technically sound piece of scientific research with data that supports the conclusions. Experiments must have been conducted rigorously, with appropriate controls, replication, and sample sizes. The conclusions must be drawn appropriately based on the data presented. </p>
    <p>Reviewer #1: Yes</p>
    <p>Reviewer #2: Yes</p>
    <p>**********</p>
    <p>3. Has the statistical analysis been performed appropriately and rigorously? </p>
    <p>Reviewer #1: Yes</p>
    <p>Reviewer #2: Yes</p>
    <p>**********</p>
    <p>4. Have the authors made all data underlying the findings in their manuscript fully available?</p>
    <p>The <ext-link ext-link-type="uri" xlink:href="http://www.plosone.org/static/policies.action#sharing">PLOS Data policy</ext-link> requires authors to make all data underlying the findings described in their manuscript fully available without restriction, with rare exception (please refer to the Data Availability Statement in the manuscript PDF file). The data should be provided as part of the manuscript or its supporting information, or deposited to a public repository. For example, in addition to summary statistics, the data points behind means, medians and variance measures should be available. If there are restrictions on publicly sharing data—e.g. participant privacy or use of data from a third party—those must be specified.</p>
    <p>Reviewer #1: Yes</p>
    <p>Reviewer #2: Yes</p>
    <p>**********</p>
    <p>5. Is the manuscript presented in an intelligible fashion and written in standard English?</p>
    <p>PLOS ONE does not copyedit accepted manuscripts, so the language in submitted articles must be clear, correct, and unambiguous. Any typographical or grammatical errors should be corrected at revision, so please note any specific errors here.</p>
    <p>Reviewer #1: Yes</p>
    <p>Reviewer #2: Yes</p>
    <p>**********</p>
    <p>6. Review Comments to the Author</p>
    <p>Please use the space provided to explain your answers to the questions above. You may also include additional comments for the author, including concerns about dual publication, research ethics, or publication ethics. (Please upload your review as an attachment if it exceeds 20,000 characters)</p>
    <p>Reviewer #1: (No Response)</p>
    <p>Reviewer #2: (No Response)</p>
    <p>**********</p>
    <p>7. PLOS authors have the option to publish the peer review history of their article (<ext-link ext-link-type="uri" xlink:href="https://journals.plos.org/plosone/s/editorial-and-peer-review-process#loc-peer-review-history">what does this mean?</ext-link>). If published, this will include your full peer review and any attached files.</p>
    <p>If you choose “no”, your identity will remain anonymous but your review may still be made public.</p>
    <p><bold>Do you want your identity to be public for this peer review?</bold> For information about this choice, including consent withdrawal, please see our <ext-link ext-link-type="uri" xlink:href="https://www.plos.org/privacy-policy">Privacy Policy</ext-link>.</p>
    <p>Reviewer #1: No</p>
    <p>Reviewer #2: No</p>
  </body>
</sub-article>
<sub-article id="pone.0219235.r004" article-type="editor-report">
  <front-stub>
    <article-id pub-id-type="doi">10.1371/journal.pone.0219235.r004</article-id>
    <title-group>
      <article-title>Acceptance letter</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Loor</surname>
          <given-names>Juan J</given-names>
        </name>
        <role>Academic Editor</role>
      </contrib>
    </contrib-group>
    <permissions>
      <copyright-statement>© 2019 Juan J Loor</copyright-statement>
      <copyright-year>2019</copyright-year>
      <copyright-holder>Juan J Loor</copyright-holder>
      <license xlink:href="http://creativecommons.org/licenses/by/4.0/">
        <license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
      </license>
    </permissions>
    <related-article id="rel-obj004" ext-link-type="doi" xlink:href="10.1371/journal.pone.0219235" related-article-type="reviewed-article"/>
  </front-stub>
  <body>
    <p>
      <named-content content-type="letter-date">25 Nov 2019</named-content>
    </p>
    <p>PONE-D-19-17255R1 </p>
    <p>Exploring Thematic Structure and Predicted Functionality of 16S rRNA Amplicon Data </p>
    <p>Dear Dr. Woloszynek:</p>
    <p>I am pleased to inform you that your manuscript has been deemed suitable for publication in PLOS ONE. Congratulations! Your manuscript is now with our production department. </p>
    <p>If your institution or institutions have a press office, please notify them about your upcoming paper at this point, to enable them to help maximize its impact. If they will be preparing press materials for this manuscript, please inform our press team within the next 48 hours. Your manuscript will remain under strict press embargo until 2 pm Eastern Time on the date of publication. For more information please contact <email>onepress@plos.org</email>.</p>
    <p>For any other questions or concerns, please email <email>plosone@plos.org</email>. </p>
    <p>Thank you for submitting your work to PLOS ONE.</p>
    <p>With kind regards,</p>
    <p>PLOS ONE Editorial Office Staff</p>
    <p>on behalf of</p>
    <p>Dr. Juan J Loor </p>
    <p>Academic Editor</p>
    <p>PLOS ONE</p>
  </body>
</sub-article>
