<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName A++V2.4.dtd?>
<?SourceDTD.Version 2.4?>
<?ConverterInfo.XSLTName springer2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">J Cheminform</journal-id>
    <journal-id journal-id-type="iso-abbrev">J Cheminform</journal-id>
    <journal-title-group>
      <journal-title>Journal of Cheminformatics</journal-title>
    </journal-title-group>
    <issn pub-type="epub">1758-2946</issn>
    <publisher>
      <publisher-name>Springer International Publishing</publisher-name>
      <publisher-loc>Cham</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">7465358</article-id>
    <article-id pub-id-type="publisher-id">452</article-id>
    <article-id pub-id-type="doi">10.1186/s13321-020-00452-5</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Preliminary Communication</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>CompRet: a comprehensive recommendation framework for chemical synthesis planning with algorithmic enumeration</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author" equal-contrib="yes">
        <contrib-id contrib-id-type="orcid">https://orcid.org/0000-0003-1173-3157</contrib-id>
        <name>
          <surname>Shibukawa</surname>
          <given-names>Ryosuke</given-names>
        </name>
        <address>
          <email>rs1018bio8.utokyo@gmail.com</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author" equal-contrib="yes">
        <contrib-id contrib-id-type="orcid">https://orcid.org/0000-0002-5638-3579</contrib-id>
        <name>
          <surname>Ishida</surname>
          <given-names>Shoichi</given-names>
        </name>
        <address>
          <email>ishida.shouichi.57a@st.kyoto-u.ac.jp</email>
        </address>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Yoshizoe</surname>
          <given-names>Kazuki</given-names>
        </name>
        <address>
          <email>kazuki.yoshizoe@riken.jp</email>
        </address>
        <xref ref-type="aff" rid="Aff3">3</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Wasa</surname>
          <given-names>Kunihiro</given-names>
        </name>
        <address>
          <email>takasu.kiyosei.6r@kyoto-u.ac.jp</email>
        </address>
        <xref ref-type="aff" rid="Aff4">4</xref>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid">https://orcid.org/0000-0002-1798-7919</contrib-id>
        <name>
          <surname>Takasu</surname>
          <given-names>Kiyosei</given-names>
        </name>
        <address>
          <email>kay-t@pharm.kyoto-u.ac.jp</email>
        </address>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid">https://orcid.org/0000-0003-3596-4208</contrib-id>
        <name>
          <surname>Okuno</surname>
          <given-names>Yasushi</given-names>
        </name>
        <address>
          <email>okuno.yasushi.4c@kyoto-u.ac.jp</email>
        </address>
        <xref ref-type="aff" rid="Aff5">5</xref>
        <xref ref-type="aff" rid="Aff6">6</xref>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0003-3914-248X</contrib-id>
        <name>
          <surname>Terayama</surname>
          <given-names>Kei</given-names>
        </name>
        <address>
          <email>terayama@yokohama-cu.ac.jp</email>
        </address>
        <xref ref-type="aff" rid="Aff3">3</xref>
        <xref ref-type="aff" rid="Aff5">5</xref>
        <xref ref-type="aff" rid="Aff6">6</xref>
        <xref ref-type="aff" rid="Aff7">7</xref>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid">https://orcid.org/0000-0002-4288-1606</contrib-id>
        <name>
          <surname>Tsuda</surname>
          <given-names>Koji</given-names>
        </name>
        <address>
          <email>tsuda@k.u-tokyo.ac.jp</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff3">3</xref>
        <xref ref-type="aff" rid="Aff8">8</xref>
      </contrib>
      <aff id="Aff1"><label>1</label><institution-wrap><institution-id institution-id-type="GRID">grid.26999.3d</institution-id><institution-id institution-id-type="ISNI">0000 0001 2151 536X</institution-id><institution>Graduate School of Frontier Sciences, </institution><institution>The University of Tokyo, </institution></institution-wrap>Kashiwa, Chiba, Japan </aff>
      <aff id="Aff2"><label>2</label><institution-wrap><institution-id institution-id-type="GRID">grid.258799.8</institution-id><institution-id institution-id-type="ISNI">0000 0004 0372 2033</institution-id><institution>Graduate School of Pharmaceutical Sciences, </institution><institution>Kyoto University, </institution></institution-wrap>Sakyo-ku, 606-8501 Kyoto, Japan </aff>
      <aff id="Aff3"><label>3</label><institution-wrap><institution-id institution-id-type="GRID">grid.7597.c</institution-id><institution-id institution-id-type="ISNI">0000000094465255</institution-id><institution>RIKEN Center for Advanced Intelligence Project, </institution></institution-wrap>Tokyo, Japan </aff>
      <aff id="Aff4"><label>4</label><institution-wrap><institution-id institution-id-type="GRID">grid.412804.b</institution-id><institution-id institution-id-type="ISNI">0000 0001 0945 2394</institution-id><institution>Toyohashi University of Technology, </institution></institution-wrap>Aichi, Japan </aff>
      <aff id="Aff5"><label>5</label><institution-wrap><institution-id institution-id-type="GRID">grid.258799.8</institution-id><institution-id institution-id-type="ISNI">0000 0004 0372 2033</institution-id><institution>Graduate School of Medicine, </institution><institution>Kyoto University, </institution></institution-wrap>Kyoto, Japan </aff>
      <aff id="Aff6"><label>6</label><institution-wrap><institution-id institution-id-type="GRID">grid.7597.c</institution-id><institution-id institution-id-type="ISNI">0000000094465255</institution-id><institution>Medical Sciences Innovation Hub Program, RIKEN, </institution></institution-wrap>Kanagawa, Japan </aff>
      <aff id="Aff7"><label>7</label><institution-wrap><institution-id institution-id-type="GRID">grid.268441.d</institution-id><institution-id institution-id-type="ISNI">0000 0001 1033 6139</institution-id><institution>Graduate School of Medical Life Science, </institution><institution>Yokohama City University, </institution></institution-wrap>Kanagawa, Japan </aff>
      <aff id="Aff8"><label>8</label><institution-wrap><institution-id institution-id-type="GRID">grid.21941.3f</institution-id><institution-id institution-id-type="ISNI">0000 0001 0789 6880</institution-id><institution>Research and Services Division of Materials Data and Integrated System, National Institute for Materials Science, </institution></institution-wrap>Kyoto, Japan </aff>
    </contrib-group>
    <pub-date pub-type="epub">
      <day>1</day>
      <month>9</month>
      <year>2020</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>1</day>
      <month>9</month>
      <year>2020</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2020</year>
    </pub-date>
    <volume>12</volume>
    <elocation-id>52</elocation-id>
    <history>
      <date date-type="received">
        <day>24</day>
        <month>5</month>
        <year>2020</year>
      </date>
      <date date-type="accepted">
        <day>8</day>
        <month>8</month>
        <year>2020</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>Â© The Author(s) 2020</copyright-statement>
      <license license-type="OpenAccess">
        <license-p><bold>Open Access</bold>This article is licensed under a Creative Commons Attribution 4.0 International License, which permits use, sharing, adaptation, distribution and reproduction in any medium or format, as long as you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons licence, and indicate if changes were made. The images or other third party material in this article are included in the article's Creative Commons licence, unless indicated otherwise in a credit line to the material. If material is not included in the article's Creative Commons licence and your intended use is not permitted by statutory regulation or exceeds the permitted use, you will need to obtain permission directly from the copyright holder. To view a copy of this licence, visit <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>. The Creative Commons Public Domain Dedication waiver (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/publicdomain/zero/1.0/">http://creativecommons.org/publicdomain/zero/1.0/</ext-link>) applies to the data made available in this article, unless otherwise stated in a credit line to the data.</license-p>
      </license>
    </permissions>
    <abstract id="Abs1">
      <p id="Par1">In computer-assisted synthesis planning (CASP) programs, providing as many chemical synthetic routes as possible is essential for considering optimal and alternative routes in a chemical reaction network. As the majority of CASP programs have been designed to provide one or a few optimal routes, it is likely that the desired one will not be included. To avoid this, an exact algorithm that lists possible synthetic routes within the chemical reaction network is required, alongside a recommendation of synthetic routes that meet specified criteria based on the chemistâs objectives. Herein, we propose a chemical-reaction-network-based synthetic route recommendation framework called âCompRetâ with a mathematically guaranteed enumeration algorithm. In a preliminary experiment, CompRet was shown to successfully provide alternative routes for a known antihistaminic drug, cetirizine. CompRet is expected to promote desirable enumeration-based chemical synthesis searches and aid the development of an interactive CASP framework for chemists.</p>
    </abstract>
    <kwd-group xml:lang="en">
      <title>Keywords</title>
      <kwd>Retosynthesis</kwd>
      <kwd>Enumeration</kwd>
      <kwd>Computer-assisted synthesis planning</kwd>
    </kwd-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/501100001863</institution-id>
            <institution>New Energy and Industrial Technology Development Organization</institution>
          </institution-wrap>
        </funding-source>
        <award-id>P15009</award-id>
        <principal-award-recipient>
          <name>
            <surname>Tsuda</surname>
            <given-names>Koji</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution>SIP (Technology for Smart Bio-industry and Agriculture)</institution>
        </funding-source>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution>Core Research for Evolutional Science and Technology</institution>
        </funding-source>
        <award-id>JPMJCR1502</award-id>
        <principal-award-recipient>
          <name>
            <surname>Tsuda</surname>
            <given-names>Koji</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/501100009024</institution-id>
            <institution>Exploratory Research for Advanced Technology</institution>
          </institution-wrap>
        </funding-source>
        <award-id>JPMJER1903</award-id>
        <principal-award-recipient>
          <name>
            <surname>Tsuda</surname>
            <given-names>Koji</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
    </funding-group>
    <custom-meta-group>
      <custom-meta>
        <meta-name>issue-copyright-statement</meta-name>
        <meta-value>Â© The Author(s) 2020</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec id="Sec1">
    <title>Introduction</title>
    <p id="Par2">Since the 1960s, several researchers have proposed computer-assisted chemical synthetic route designs. Various computer-assisted synthesis planning (CASP) programs have been developed to assist synthetic organic chemists in their work [<xref ref-type="bibr" rid="CR1">1</xref>â<xref ref-type="bibr" rid="CR3">3</xref>]. While expert systems and knowledge-based programs were the primary focus of CASP during the early stages [<xref ref-type="bibr" rid="CR4">4</xref>â<xref ref-type="bibr" rid="CR8">8</xref>], recent breakthroughs in the field of deep learning and widespread availability of reaction datasets have accelerated its development [<xref ref-type="bibr" rid="CR9">9</xref>â<xref ref-type="bibr" rid="CR17">17</xref>]. In particular, data-driven approaches have received attention across research fields [<xref ref-type="bibr" rid="CR18">18</xref>â<xref ref-type="bibr" rid="CR21">21</xref>]. These approaches for multi-step synthesis planning have shown outstanding performance at every stage, and more recently, they have provided realistic and preferable synthetic routes.</p>
    <p id="Par3">The pioneers of CASP, Corey and Wipke, stated the following requirements related to the above strategy in their paper [<xref ref-type="bibr" rid="CR2">2</xref>]: the program needs to provide as many useful routes as possible, chemists can decide the depth of search or analysis of the synthetic route, and the given routes are evaluated by the chemists. As discussed above, several CASP approaches have been developed; however, the majority of them have aimed to directly obtain the optimal chemical synthetic route rather than attempting to provide multiple route candidates. According to Corey [<xref ref-type="bibr" rid="CR2">2</xref>], examining as many useful chemical synthetic routes as possible is an essential part of retrosynthetic analysis. It is well known that evaluation criteria used for the presented synthetic routes depend on the chemistâs situation, objectives, and/or needs [<xref ref-type="bibr" rid="CR22">22</xref>], such as the early-stage derivatization of hits, optimization of lead compounds, or large-scale synthesis of drug candidates. Thus, a desirable framework should provide as many useful routes as possible under specific conditions (e.g., room and high temperatures) and choose multiple reliable routes based on given situations (e.g., drug discovery or drug development stages).</p>
    <p id="Par4">As a framework for providing multiple reliable routes, Kowalik et al. have developed a promising approach using the Network of Organic Chemistry (NOC) [<xref ref-type="bibr" rid="CR23">23</xref>â<xref ref-type="bibr" rid="CR27">27</xref>] and an enumeration algorithm of possible synthetic routes [<xref ref-type="bibr" rid="CR28">28</xref>]. The NOC consists of all possible molecules and reactions that represent links from reactants to products. [<xref ref-type="bibr" rid="CR27">27</xref>] The reactions are practically represented as templates that include the conditional/contextual rules of chemistry. Additionally, they implemented a recommendation system of multiple synthetic routes for a target molecule as follows [<xref ref-type="bibr" rid="CR28">28</xref>]. Firstly, they extracted the network of molecules and reactions (chemical reaction network) related to the target from the NOC. Secondly, they enumerated all possible synthetic routes from the chemical reaction network, and then, selected promising candidate routes. Although they showed a vast number of synthetic routes for some molecules and presented realistic solutions, their approach has two potential issues: the NOC is very large, and thus, uneconomical for obtaining optimal routes for a specific target molecule, and the enumeration algorithm does not always provide all possible routes. Hence, an efficient algorithm for constructing a chemical reaction network is required for practical application. Further, an exact enumeration algorithm without loss or duplication is needed for practical usage and finding reliable alternative routes.</p>
    <p id="Par5">In this study, we propose a CASP framework called âCompRet,â which enumerates possible synthetic routes using a novel enumeration algorithm with a theoretical guarantee, and then selects useful routes based on several score functions. CompRet implements the following three steps to recommend synthetic routes: (1) constructing a chemical reaction network based on the depth-first proof number search (DFPN) and template-based retrosynthesis [<xref ref-type="bibr" rid="CR29">29</xref>, <xref ref-type="bibr" rid="CR30">30</xref>], without a large chemical reaction network such as the NOC, (2) enumerating all synthetic routes from the network using a novel algorithm, and (3) recommending multiple synthetic routes by developing a naive visualization method and simple score functions. DFPN was initially developed by Nagai et al. in the context of artificial intelligence for games such as Shogi and Go [<xref ref-type="bibr" rid="CR31">31</xref>â<xref ref-type="bibr" rid="CR33">33</xref>]. In application to CASP, it has shown superior or comparable performance to that of depth-first search or Monte Carlo tree search [<xref ref-type="bibr" rid="CR34">34</xref>, <xref ref-type="bibr" rid="CR35">35</xref>]. Therefore, DFPN was adopted to construct the chemical reaction network proposed herein. The number of possible synthetic routes provided by the enumeration may reach or exceed several millions. As it would be impossible for chemists to manually examine all of them, several score functions and a visualization method have been introduced into the framework to simplify the process.</p>
    <p id="Par6">Here, we report the development of CompRet and mathematically prove the completeness and soundness of the proposed enumeration algorithm, which can precisely enumerate all synthetic routes from a given constructed chemical reaction network. To demonstrate the approach, possible synthetic routes were found for cetirizine, an antihistaminic drug. In addition to sorting routes by scores, an embedding method to obtain an overview of millions of synthetic routes by defining a route fingerprint was attempted.</p>
  </sec>
  <sec id="Sec2">
    <title>Method</title>
    <p id="Par7">
      <fig id="Fig1">
        <label>Fig. 1</label>
        <caption>
          <p>Illustration of CompRetâs overall processes. Step 1: Construction of a chemical reaction network. Step 2: Enumeration of synthetic routes. Step 3: Ranking synthetic routes based on the scoring function</p>
        </caption>
        <graphic xlink:href="13321_2020_452_Fig1_HTML" id="d30e479"/>
      </fig>
    </p>
    <p id="Par8">Compret consists of three steps (Fig.Â <xref rid="Fig1" ref-type="fig">1</xref>). Each step is described as follows.</p>
    <sec id="Sec3">
      <title>Construction of chemical reaction network</title>
      <p id="Par9">A synthetic route for a target molecule can be represented as a tree-like structure in which molecule nodes (circles) and chemical reactions (rectangles) appear alternately, as shown in Fig.Â <xref rid="Fig2" ref-type="fig">2</xref>(a). In order to make a route feasible, the end molecule nodes (molecules in the blue circles in Fig.Â <xref rid="Fig2" ref-type="fig">2</xref>(a)) must consist of starting materials (e.g., commercially available molecules), and each synthesis step should be reasonable [<xref ref-type="bibr" rid="CR29">29</xref>, <xref ref-type="bibr" rid="CR30">30</xref>].<fig id="Fig2"><label>Fig. 2</label><caption><p>AND/OR representation of synthetic routes.<bold> a </bold>Example of a single synthetic route for cetirizine. Retrosynthetic computation is performed recursively from the topmost node (target) until it reaches to the starting materials at the bottom.<bold> b</bold> The synthetic route can be represented as an AND/OR tree in which the OR and AND nodes denote molecules and reactions, respectively.<bold> c</bold> A chemical reaction network ideally consists of all possible synthetic routes to a target (red sphere) molecule</p></caption><graphic xlink:href="13321_2020_452_Fig2_HTML" id="MO2"/></fig></p>
      <p id="Par10">The chemical reaction network of a target molecule is typically large and can efficiently express (ideally all) possible synthetic routes to the target represented by the molecule and reaction nodes [<xref ref-type="bibr" rid="CR27">27</xref>, <xref ref-type="bibr" rid="CR36">36</xref>]. In this study, we represent synthetic routes and chemical reaction networks as AND/OR trees, as shown in Fig.Â <xref rid="Fig2" ref-type="fig">2</xref>(b), to efficiently construct chemical reaction networks and precisely perform enumeration (see Additonal file <xref rid="MOESM1" ref-type="media">1</xref>: for details on the AND/OR tree and chemical reaction network). The synthetic route in Fig.Â <xref rid="Fig2" ref-type="fig">2</xref>(a) is represented as the black route in Fig.Â <xref rid="Fig2" ref-type="fig">2</xref>(b) by expressing the molecule and reaction nodes as OR and AND nodes, respectively. The gray route in Fig.Â <xref rid="Fig2" ref-type="fig">2</xref>(b) shows another route to synthesize the same reactant. In an AND/OR tree, a molecule is represented as an OR node because either black âORâ gray routes are available to synthesize the same reactant, as shown in Fig.Â <xref rid="Fig2" ref-type="fig">2</xref>(b). On the other hand, a reaction is represented as an AND node because all the reactants (e.g., B âANDâ C OR nodes in Fig.Â <xref rid="Fig2" ref-type="fig">2</xref>(b)) of the reaction (AND node A in Fig.Â <xref rid="Fig2" ref-type="fig">2</xref>(b)) are required to synthesize the product. Merging the molecule and reaction nodes that appear in different synthetic routes in this manner (Fig.Â <xref rid="Fig2" ref-type="fig">2</xref>(b)) enables an efficient representation of a large number of routes as a chemical reaction network (Fig.Â <xref rid="Fig2" ref-type="fig">2</xref>(c)).</p>
      <p id="Par11">CompRet efficiently constructs the chemical reaction network for a given target molecule based on DFPN, a search method based on the AND/OR tree using proof and disproof numbers for each node (see Additonal file <xref rid="MOESM1" ref-type="media">1</xref>: for details on the DFPN algorithm). To design a synthetic route, reaction templates are applied to a target to transform it into reactants. For the retrosynthetic computation, Reactor version 20.11.0 (ChemAxon [<xref ref-type="bibr" rid="CR37">37</xref>]), which can consider stereochemistry in reaction templates, was used. The relevance of the transformed reactants was checked by computing the product of the template and the reactants. By recursively performing this transformation according to the DFPN algorithm, all possible synthetic routes for a target molecule can be obtained upon reaching the preset maximum depth <italic>md</italic>. The algorithm can design longer synthetic routes with a larger <italic>md</italic> value. Furthermore, CompRet repeatedly searches for a new route and merges it into a chemical reaction network (see the section 1 and 2, and Fig. S1 in Additional file <xref rid="MOESM1" ref-type="media">1</xref>: for details on the construction algorithm).</p>
    </sec>
    <sec id="Sec4">
      <title>Enumeration algorithm</title>
      <p id="Par12">Enumerating all synthetic routes in the chemical reaction network of a given target may appear to be a simple problem, as described in the literature reported by Kowalik et al [<xref ref-type="bibr" rid="CR28">28</xref>]. For example, in Fig.Â <xref rid="Fig3" ref-type="fig">3</xref>(a), the target (molecule 1) can be synthesized via any one of the reactions A, B, or C. Here, we consider how to count all possible synthetic routes. Synthetic routes for the target can be counted using the following equation:<disp-formula id="Equ1"><label>1</label><alternatives><tex-math id="M1">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} mol(1).count = rxn(A).count+rxn(B).count+rxn(C).count, \end{aligned}$$\end{document}</tex-math><mml:math id="M2" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>m</mml:mi><mml:mi>o</mml:mi><mml:mi>l</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo>.</mml:mo><mml:mi>c</mml:mi><mml:mi>o</mml:mi><mml:mi>u</mml:mi><mml:mi>n</mml:mi><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:mi>r</mml:mi><mml:mi>x</mml:mi><mml:mi>n</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>A</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>.</mml:mo><mml:mi>c</mml:mi><mml:mi>o</mml:mi><mml:mi>u</mml:mi><mml:mi>n</mml:mi><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mi>r</mml:mi><mml:mi>x</mml:mi><mml:mi>n</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>B</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>.</mml:mo><mml:mi>c</mml:mi><mml:mi>o</mml:mi><mml:mi>u</mml:mi><mml:mi>n</mml:mi><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mi>r</mml:mi><mml:mi>x</mml:mi><mml:mi>n</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>C</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>.</mml:mo><mml:mi>c</mml:mi><mml:mi>o</mml:mi><mml:mi>u</mml:mi><mml:mi>n</mml:mi><mml:mi>t</mml:mi><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="13321_2020_452_Article_Equ1.gif" position="anchor"/></alternatives></disp-formula>where <italic>mol</italic>(1) and <italic>rxn</italic>(<italic>X</italic>).<italic>count</italic> denote the number of routes to synthesize the molecule 1 and the number of routes that use the reaction <italic>X</italic>, respectively. On the other hand, the number of ways to prepare reactants for a reaction is calculated as follows. In the case of <italic>A</italic>,<disp-formula id="Equ2"><label>2</label><alternatives><tex-math id="M3">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} rxn(A).count = mol(2).count \times mol(3).count. \end{aligned}$$\end{document}</tex-math><mml:math id="M4" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>r</mml:mi><mml:mi>x</mml:mi><mml:mi>n</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>A</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>.</mml:mo><mml:mi>c</mml:mi><mml:mi>o</mml:mi><mml:mi>u</mml:mi><mml:mi>n</mml:mi><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:mi>m</mml:mi><mml:mi>o</mml:mi><mml:mi>l</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mn>2</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo>.</mml:mo><mml:mi>c</mml:mi><mml:mi>o</mml:mi><mml:mi>u</mml:mi><mml:mi>n</mml:mi><mml:mi>t</mml:mi><mml:mo>Ã</mml:mo><mml:mi>m</mml:mi><mml:mi>o</mml:mi><mml:mi>l</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mn>3</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo>.</mml:mo><mml:mi>c</mml:mi><mml:mi>o</mml:mi><mml:mi>u</mml:mi><mml:mi>n</mml:mi><mml:mi>t</mml:mi><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="13321_2020_452_Article_Equ2.gif" position="anchor"/></alternatives></disp-formula>These calculations are performed recursively until starting materials for which <italic>mol</italic>.<italic>count</italic> is assigned one (e.g., <inline-formula id="IEq1"><alternatives><tex-math id="M5">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$mol(3).count=1$$\end{document}</tex-math><mml:math id="M6"><mml:mrow><mml:mi>m</mml:mi><mml:mi>o</mml:mi><mml:mi>l</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mn>3</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo>.</mml:mo><mml:mi>c</mml:mi><mml:mi>o</mml:mi><mml:mi>u</mml:mi><mml:mi>n</mml:mi><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="13321_2020_452_Article_IEq1.gif"/></alternatives></inline-formula>).</p>
      <p id="Par13">However, as mentioned in the literature [<xref ref-type="bibr" rid="CR28">28</xref>], this procedure does not count the exact number of synthetic routes because it assumes that each reactant is synthesized independently. In the actual network, a single molecule can act as a reactant for several reactions; for example, the molecule 4 in Fig.Â <xref rid="Fig3" ref-type="fig">3</xref>(b). Note that both molecules 2 and 3 are required for the reaction <italic>A</italic>. The network depicted in Fig.Â <xref rid="Fig3" ref-type="fig">3</xref>(b) includes only two synthetic routes for the molecule 1, i.e., a choice of the reactions <italic>D</italic> or <italic>E</italic> for synthesizing the molecule 4, while the number of synthetic routes is calculated to be 4 according to the above equations. Therefore, we propose an enumeration algorithm that extracts all possible routes in a network by considering âjoined nodesâ, as shown in Fig.Â <xref rid="Fig3" ref-type="fig">3</xref>(b). A brief description of the enumeration algorithm is given in Fig.Â <xref rid="Fig4" ref-type="fig">4</xref>. The details of the enumeration algorithm are described in the Additonal file <xref rid="MOESM1" ref-type="media">1</xref>.<fig id="Fig3"><label>Fig. 3</label><caption><p>Example of the local structure of a chemical reaction network to illustrate the method used to calculate the number of synthetic routes. <bold>a</bold> Ideal structure of a network for which the naive method can count the exact number of synthetic routes for a target molecule. <bold>b</bold> The naive method cannot count synthetic routes precisely in this case. The number of synthetic routes for the target molecule, <italic>mol</italic>(1).<italic>count</italic>, is calculated as <inline-formula id="IEq2"><alternatives><tex-math id="M7">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$mol(5).count=1, mol(6).count=1, rxn(D).count=mol(5).count=1, rxn(E).count=mol(6).count=1, mol(4).count=rxn(D).count+rxn(E).count=2$$\end{document}</tex-math><mml:math id="M8"><mml:mrow><mml:mi>m</mml:mi><mml:mi>o</mml:mi><mml:mi>l</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mn>5</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo>.</mml:mo><mml:mi>c</mml:mi><mml:mi>o</mml:mi><mml:mi>u</mml:mi><mml:mi>n</mml:mi><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>m</mml:mi><mml:mi>o</mml:mi><mml:mi>l</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mn>6</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo>.</mml:mo><mml:mi>c</mml:mi><mml:mi>o</mml:mi><mml:mi>u</mml:mi><mml:mi>n</mml:mi><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>r</mml:mi><mml:mi>x</mml:mi><mml:mi>n</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>D</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>.</mml:mo><mml:mi>c</mml:mi><mml:mi>o</mml:mi><mml:mi>u</mml:mi><mml:mi>n</mml:mi><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:mi>m</mml:mi><mml:mi>o</mml:mi><mml:mi>l</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mn>5</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo>.</mml:mo><mml:mi>c</mml:mi><mml:mi>o</mml:mi><mml:mi>u</mml:mi><mml:mi>n</mml:mi><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>r</mml:mi><mml:mi>x</mml:mi><mml:mi>n</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>E</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>.</mml:mo><mml:mi>c</mml:mi><mml:mi>o</mml:mi><mml:mi>u</mml:mi><mml:mi>n</mml:mi><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:mi>m</mml:mi><mml:mi>o</mml:mi><mml:mi>l</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mn>6</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo>.</mml:mo><mml:mi>c</mml:mi><mml:mi>o</mml:mi><mml:mi>u</mml:mi><mml:mi>n</mml:mi><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>m</mml:mi><mml:mi>o</mml:mi><mml:mi>l</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mn>4</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo>.</mml:mo><mml:mi>c</mml:mi><mml:mi>o</mml:mi><mml:mi>u</mml:mi><mml:mi>n</mml:mi><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:mi>r</mml:mi><mml:mi>x</mml:mi><mml:mi>n</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>D</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>.</mml:mo><mml:mi>c</mml:mi><mml:mi>o</mml:mi><mml:mi>u</mml:mi><mml:mi>n</mml:mi><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mi>r</mml:mi><mml:mi>x</mml:mi><mml:mi>n</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>E</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>.</mml:mo><mml:mi>c</mml:mi><mml:mi>o</mml:mi><mml:mi>u</mml:mi><mml:mi>n</mml:mi><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="13321_2020_452_Article_IEq2.gif"/></alternatives></inline-formula>, and finally <inline-formula id="IEq3"><alternatives><tex-math id="M9">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$mol(a).count=4$$\end{document}</tex-math><mml:math id="M10"><mml:mrow><mml:mi>m</mml:mi><mml:mi>o</mml:mi><mml:mi>l</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>a</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>.</mml:mo><mml:mi>c</mml:mi><mml:mi>o</mml:mi><mml:mi>u</mml:mi><mml:mi>n</mml:mi><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:mn>4</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="13321_2020_452_Article_IEq3.gif"/></alternatives></inline-formula>, while the true number of synthetic routes is 2</p></caption><graphic xlink:href="13321_2020_452_Fig3_HTML" id="MO5"/></fig><fig id="Fig4"><label>Fig. 4</label><caption><p>Illustration of the enumeration algorithm. <bold>a</bold> An example of an input chemical reaction network. <bold>b</bold> Visualized procedures of the enumeration algorithm. The black filled circle is a node to focus on. X is a terminal state where a synthetic route is constructed. Y is also a terminal state where there is no node to focus on because all child nodes (1, 2) are already checked</p></caption><graphic xlink:href="13321_2020_452_Fig4_HTML" id="MO6"/></fig></p>
    </sec>
    <sec id="Sec5">
      <title>Route ranking for recommendation</title>
      <p id="Par14">Three scoring functions were utilized for recommendation from the enumerated synthetic routes: the step-based method (STEP), mean synthetic complexity score (MSCS), and reference route-based method (REF). STEP is a simple method that outputs the longest number of synthesis steps for a given synthetic route. Synthetic complexity score (SCScore) was developed by Coley et al. [<xref ref-type="bibr" rid="CR12">12</xref>] to evaluate the complexity of the molecule. Like the SCScore, the MSCS for a synthetic route ranges from 0 to 5. As the SCScore of a molecule is directly proportional to the complexity of its synthesis, a molecule with a lower SCScore is preferred in synthesis planning. Here, MSCS is defined as the average of the SCScores of all molecules in a synthetic route. MSCS takes into account the complexity of intermediate molecules. REF is calculated only if a reference synthetic route is given. First, all the molecules that appear in the reference route are extracted and sorted by molecular weight. A list of sorted molecules is similarly prepared for a designed synthetic route. Then, the sum of fingerprint-based similarities between the sorted molecules of the reference and given routes is calculated. The RDKit fingerprint [<xref ref-type="bibr" rid="CR38">38</xref>, <xref ref-type="bibr" rid="CR39">39</xref>] and Tanimoto metrics [<xref ref-type="bibr" rid="CR40">40</xref>] were employed for this similarity evaluation. If the lengths of the sorted molecule lists differ, REF is set to 0. This score function is designed to find synthetic routes that are slightly different from the reference route, using the same number of intermediate molecules. Smaller STEP and MSCS values indicate a superior route, whereas REF is designed such that a larger value indicates a more desired route.</p>
    </sec>
    <sec id="Sec6">
      <title>Visualization for confirming route distribution</title>
      <p id="Par15">To confirm that the CompRet framework is capable of designing a wide variety of synthetic routes, we developed a simple method to plot the routes in a 2D space by converting a synthetic route into a vector. For the conversion, route fingerprint <inline-formula id="IEq4"><alternatives><tex-math id="M11">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\varvec{f}_r$$\end{document}</tex-math><mml:math id="M12"><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">f</mml:mi></mml:mrow><mml:mi>r</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13321_2020_452_Article_IEq4.gif"/></alternatives></inline-formula> for a route <italic>r</italic> is defined as<disp-formula id="Equ3"><label>3</label><alternatives><tex-math id="M13">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} \varvec{f}_r&amp;= \sum _{t \in r} \varvec{f}_p(t), \end{aligned}$$\end{document}</tex-math><mml:math id="M14" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">f</mml:mi></mml:mrow><mml:mi>r</mml:mi></mml:msub></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo><mml:munder><mml:mo>â</mml:mo><mml:mrow><mml:mi>t</mml:mi><mml:mo>â</mml:mo><mml:mi>r</mml:mi></mml:mrow></mml:munder><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">f</mml:mi></mml:mrow><mml:mi>p</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="13321_2020_452_Article_Equ3.gif" position="anchor"/></alternatives></disp-formula>where <italic>t</italic> is a reaction template and <inline-formula id="IEq5"><alternatives><tex-math id="M15">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\varvec{f}_p(t)$$\end{document}</tex-math><mml:math id="M16"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">f</mml:mi></mml:mrow><mml:mi>p</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="13321_2020_452_Article_IEq5.gif"/></alternatives></inline-formula> is the structural reaction fingerprint [<xref ref-type="bibr" rid="CR41">41</xref>] of <italic>t</italic> computed by RDKit [<xref ref-type="bibr" rid="CR39">39</xref>]. Following the computation of route fingerprints for 3,000 sampled routes, t-SNE embedding [<xref ref-type="bibr" rid="CR42">42</xref>] was computed using scikit-learn [<xref ref-type="bibr" rid="CR43">43</xref>].</p>
    </sec>
    <sec id="Sec7">
      <title>Reaction template and building block</title>
      <p id="Par16">Template-based approaches generally require both reaction templates and starting materials. A reaction template is represented as a generalized chemical reaction, and technically represented as a reactive center and the first neighboring atoms and bonds in a reaction. The reaction templates were extracted from 27 million single-step reactions obtained from Reaxys (from 1795 to 2019) [<xref ref-type="bibr" rid="CR44">44</xref>], following the method used in a previous study. [<xref ref-type="bibr" rid="CR17">17</xref>] Here, the single-step reactions obtained from Reaxys were filtered on the condition that a reaction has a product and up to three reactants. Five hundred reaction templates were used in the order of occurrence frequency. In total, about 13 million reaction templates were extracted; in the top 500 templates, frequency counts are range from 1,906 to 188,460. Starting materials were defined as commercially available chemical compounds and used as stopping criteria for DFPN. For these, 157,544 molecules from Enamine building blocks [<xref ref-type="bibr" rid="CR45">45</xref>] were used.</p>
    </sec>
  </sec>
  <sec id="Sec8">
    <title>Results and discussion</title>
    <sec id="Sec9">
      <title>Proof of enumeration algorithm</title>
      <p id="Par17">The proposed algorithm can enumerate all possible routes without loss or duplication from a given chemical reaction network of a target molecule. To prove this, it is necessary to show that (1) the algorithm outputs only synthetic routes, (2) there are no duplicate outputs, and (3) the algorithm outputs all synthetic routes in a given chemical reaction network. Here, these properties have been proven using the partition method [<xref ref-type="bibr" rid="CR46">46</xref>, <xref ref-type="bibr" rid="CR47">47</xref>], which is widely used for enumeration algorithms, and mathematical induction. Details of these proofs are given in the Additonal file <xref rid="MOESM1" ref-type="media">1</xref>. The properties (1), (2), and (3) are shown in Theorem 4.1, Lemma 4.1, and Theorem 4.2, respectively. The algorithm described in the literature reported by Kowalik et al. [<xref ref-type="bibr" rid="CR28">28</xref>] cannot count the number of synthetic routes accurately, as discussed in the Methods section. On the other hand, the proposed enumeration algorithm outputs all synthetic routes without loss or duplication, based on the idea of the âprohibited listâ (variable <italic>P</italic>) and related procedures in Algorithm S3.</p>
    </sec>
    <sec id="Sec10">
      <title>Route enumeration for Heifetsâ benchmark</title>
      <p id="Par18">For the first demonstration, Heifetsâ benchmark molecules (<ext-link ext-link-type="uri" xlink:href="http://www.cs.toronto.edu/%7eaheifets/ChemicalPlanning/BENCHMARK.tar.gz">http://www.cs.toronto.edu/~aheifets/ChemicalPlanning/BENCHMARK.tar.gz</ext-link> ) [<xref ref-type="bibr" rid="CR34">34</xref>] were used to show the scale of the chemical reaction networks constructed by CompRet and the synthetic route enumeration for the networks. The top 100 reaction templates of the prepared template data were used, and <italic>md</italic> was set to six. All calculations were conducted using a single CPU core (Intel(R) Xeon(R) CPU E5-2690 v3 @ 2.60GHz) with 256 GB of RAM.</p>
      <p id="Par19">TableÂ <xref rid="Tab1" ref-type="table">1</xref> shows the results of the construction of chemical reaction networks and enumerations for the target molecules.<table-wrap id="Tab1"><label>Table 1</label><caption><p>Experimental result of chemical reaction network construction and synthetic route enumeration for Heifetsâ benchmark molecules</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left">Target molecule</th><th align="left">The number of OR nodes</th><th align="left">The number of AND nodes</th><th align="left">The number of edges</th><th align="left">The number of synthetic routes</th><th align="left">Memory size of the network</th><th align="left">Memory size of total routes</th><th align="left">Construction time (sec)</th><th align="left">Enumeration time (sec)</th></tr></thead><tbody><tr><td align="left"><inline-graphic xlink:href="13321_2020_452_Figb_HTML.gif" id="d30e1487"/></td><td char="." align="char">29</td><td char="." align="char">61</td><td char="." align="char">149</td><td char="." align="char">70</td><td char="." align="char">10.9 KB</td><td align="left">58.6 KB</td><td char="." align="char">2.68</td><td align="left"><inline-formula id="IEq6"><alternatives><tex-math id="M17">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$2.91\times 10^{(-2)}$$\end{document}</tex-math><mml:math id="M18"><mml:mrow><mml:mn>2.91</mml:mn><mml:mo>Ã</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mo>-</mml:mo><mml:mn>2</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:math><inline-graphic xlink:href="13321_2020_452_Article_IEq6.gif"/></alternatives></inline-formula></td></tr><tr><td align="left"><inline-graphic xlink:href="13321_2020_452_Figc_HTML.gif" id="d30e1540"/></td><td char="." align="char">66</td><td char="." align="char">153</td><td char="." align="char">405</td><td char="." align="char">781</td><td char="." align="char">27.5 KB</td><td align="left">1.15 MB</td><td char="." align="char">6.02</td><td align="left">0.185</td></tr><tr><td align="left"><inline-graphic xlink:href="13321_2020_452_Figd_HTML.gif" id="d30e1570"/></td><td char="." align="char">8</td><td char="." align="char">11</td><td char="." align="char">25</td><td char="." align="char">8</td><td char="." align="char">2.11 KB</td><td align="left">7.33 KB</td><td char="." align="char">2.96</td><td align="left"><inline-formula id="IEq7"><alternatives><tex-math id="M19">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$9.26\times 10^{(-4)}$$\end{document}</tex-math><mml:math id="M20"><mml:mrow><mml:mn>9.26</mml:mn><mml:mo>Ã</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mo>-</mml:mo><mml:mn>4</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:math><inline-graphic xlink:href="13321_2020_452_Article_IEq7.gif"/></alternatives></inline-formula></td></tr><tr><td align="left"><inline-graphic xlink:href="13321_2020_452_Fige_HTML.gif" id="d30e1623"/></td><td char="." align="char">22</td><td char="." align="char">29</td><td char="." align="char">58</td><td char="." align="char">32</td><td char="." align="char">5.38 KB</td><td align="left">22.9 KB</td><td char="." align="char">2.57</td><td align="left"><inline-formula id="IEq8"><alternatives><tex-math id="M21">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${9.01}\times {10^{(-3)}}$$\end{document}</tex-math><mml:math id="M22"><mml:mrow><mml:mrow><mml:mn>9.01</mml:mn></mml:mrow><mml:mo>Ã</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mo>-</mml:mo><mml:mn>3</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:math><inline-graphic xlink:href="13321_2020_452_Article_IEq8.gif"/></alternatives></inline-formula></td></tr><tr><td align="left"><inline-graphic xlink:href="13321_2020_452_Figf_HTML.gif" id="d30e1677"/></td><td char="." align="char">92</td><td char="." align="char">376</td><td char="." align="char">1040</td><td char="." align="char">127707</td><td char="." align="char">62.6 KB</td><td align="left">311 MB</td><td char="." align="char">11.7</td><td align="left">63.5</td></tr><tr><td align="left"><inline-graphic xlink:href="13321_2020_452_Figg_HTML.gif" id="d30e1707"/></td><td char="." align="char">34</td><td char="." align="char">78</td><td char="." align="char">175</td><td char="." align="char">108385</td><td char="." align="char">13.1 KB</td><td align="left">416 MB</td><td char="." align="char">6.33</td><td align="left">97.6</td></tr><tr><td align="left"><inline-graphic xlink:href="13321_2020_452_Figh_HTML.gif" id="d30e1737"/></td><td char="." align="char">17</td><td char="." align="char">19</td><td char="." align="char">42</td><td char="." align="char">12</td><td char="." align="char">4.00 KB</td><td align="left">6.77 KB</td><td char="." align="char">4.30</td><td align="left"><inline-formula id="IEq9"><alternatives><tex-math id="M23">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${6.20\times 10^{(-4)}}$$\end{document}</tex-math><mml:math id="M24"><mml:mrow><mml:mn>6.20</mml:mn><mml:mo>Ã</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mo>-</mml:mo><mml:mn>4</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:math><inline-graphic xlink:href="13321_2020_452_Article_IEq9.gif"/></alternatives></inline-formula></td></tr><tr><td align="left"><inline-graphic xlink:href="13321_2020_452_Figi_HTML.gif" id="d30e1790"/></td><td char="." align="char">38</td><td char="." align="char">58</td><td char="." align="char">143</td><td char="." align="char">67</td><td char="." align="char">11.0 KB</td><td align="left">64.5 KB</td><td char="." align="char">3.84</td><td align="left">0.146</td></tr><tr><td align="left"><inline-graphic xlink:href="13321_2020_452_Figj_HTML.gif" id="d30e1820"/></td><td char="." align="char">74</td><td char="." align="char">213</td><td char="." align="char">567</td><td char="." align="char">5213</td><td char="." align="char">36.4 KB</td><td align="left">9.19 MB</td><td char="." align="char">6.35</td><td align="left">0.645</td></tr><tr><td align="left"><inline-graphic xlink:href="13321_2020_452_Figk_HTML.gif" id="d30e1850"/></td><td char="." align="char">45</td><td char="." align="char">93</td><td char="." align="char">208</td><td char="." align="char">1042</td><td char="." align="char">16.3 KB</td><td align="left">178 MB</td><td char="." align="char">27.5</td><td align="left">0.393</td></tr><tr><td align="left"><inline-graphic xlink:href="13321_2020_452_Figl_HTML.gif" id="d30e1880"/></td><td char="." align="char">65</td><td char="." align="char">139</td><td char="." align="char">359</td><td char="." align="char">2520</td><td char="." align="char">25.9 KB</td><td align="left">5.10 MB</td><td char="." align="char">9.85</td><td align="left">0.346</td></tr></tbody></table><table-wrap-foot><p>The numbers of OR and AND nodes indicate the corresponding number of nodes contained in the constructed chemical reaction network. The number of synthetic routes represents the number of enumerated possible routes in the network. The memory sizes of the network and total routes are calculated by converting objects into DOT files. The construction time indicates the computation time required for the construction of the network. The enumeration time indicates the computation time required to enumerate all possible synthetic routes from the network</p></table-wrap-foot></table-wrap></p>
      <p id="Par20">In TableÂ <xref rid="Tab1" ref-type="table">1</xref>, benchmark molecules whose synthetic routes were designed by CompRet using the top 100 reaction templates are shown. Note that the template set prepared in their study [<xref ref-type="bibr" rid="CR34">34</xref>] consisted of 50 reactions that were selected to be suitable for synthesis of the benchmark molecules, although they succeeded in finding synthetic routes for most molecules in the benchmark. In TableÂ <xref rid="Tab1" ref-type="table">1</xref>, the second and third columns indicate the number of constituent OR and AND nodes, respectively, that is, the size of the chemical reaction network for the molecule depicted in the first column. The sizes of the generated chemical reaction networks differed significantly between the molecules. The fourth column from the left shows the number of enumeration results of the synthetic routes extracted from each chemical reaction network. More than 100,000 synthetic routes have been successfully enumerated for the fifth and sixth molecules. This number may appear excessive considering the molecules; however, as reported in prior studies [<xref ref-type="bibr" rid="CR27">27</xref>, <xref ref-type="bibr" rid="CR28">28</xref>], the number of synthetic routes can reach <inline-formula id="IEq10"><alternatives><tex-math id="M25">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\approx 10^5$$\end{document}</tex-math><mml:math id="M26"><mml:mrow><mml:mo>â</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mn>5</mml:mn></mml:msup></mml:mrow></mml:math><inline-graphic xlink:href="13321_2020_452_Article_IEq10.gif"/></alternatives></inline-formula> depending on the molecules. Thus, the obtained results are consistent with previous findings. The fifth and sixth columns denote the memory sizes of the constructed network and enumerated routes, respectively. Each object is converted into DOT format [<xref ref-type="bibr" rid="CR48">48</xref>] to calculate the total amount of memory. The seventh and eighth columns show the generation time of the chemical reaction network and the calculation time of enumeration, respectively. It can be seen that the time for construction tends to be much longer than that for the enumeration of the chemical reaction network. This is because searching for applicable templates for a molecule, and then, using them to divide it into its substances are time-consuming tasks. Besides, enumeration from a larger and more complex network tends to require more time because the number of synthetic routes in a chemical reaction network increases combinatorially. It should be noted that the benchmark originally consists of 20 molecules, half of which remain unsolved. This would be because the reaction templates we used did not include the reactions or starting materials needed to solve the problems (Additional file <xref rid="MOESM1" ref-type="media">1</xref>).</p>
    </sec>
    <sec id="Sec11">
      <title>Route recommendation for cetirizine</title>
      <p id="Par21">To examine the synthetic routes designed by CompRet in detail, we have applied CompRet to cetirizine, a drug whose reported synthetic route is relatively simple [<xref ref-type="bibr" rid="CR49">49</xref>, <xref ref-type="bibr" rid="CR50">50</xref>]. Here, the results of changing the template set size and the maximum depth <italic>md</italic> are shown, followed by the routes recommended by CompRet using three scoring methods: REF, MSCS, and STEP. We also performed additional experiments for several molecules; the results are shown in Fig. S5 in Additional file <xref rid="MOESM1" ref-type="media">1</xref>. First, the construction of the chemical reaction network and the synthetic routes for different template set sizes (top 50, 100, and 500) were investigated. The value of <italic>md</italic> was fixed to six. FigureÂ <xref rid="Fig5" ref-type="fig">5</xref> shows the time taken for the network constructions. The dotted line indicates that the first route has been found. Finding a single route for the top 100 (orange line) and 500 (green line) template cases required an extended period of time, because the number of candidate routes increased exponentially with the increase in the number of templates. The blue line shows the result for size 50. In this case, the network construction was completed in approximately 30 seconds. In the cases of size 100 and 500, the number of routes increased significantly; thus, enumeration was halted when the number of routes exceeded 1,500,000. In the case of size 500, the time taken to find 1,500,000 routes was less than 2,000 seconds.<fig id="Fig5"><label>Fig. 5</label><caption><p>Searched synthetic routes for cetirizine with different template sets. The number of the routes for each chemical reaction network is counted at several time points. The labels <italic>size</italic> 50, <italic>size</italic> 100, and <italic>size</italic> 500 respectively indicate that the top 50, 100, and 500 reaction templates have been utilized. Counting is aborted when the total number of routes exceeds 1,500,000. The dotted line at the bottom indicates that the first synthetic route has been discovered</p></caption><graphic xlink:href="13321_2020_452_Fig5_HTML" id="MO19"/></fig></p>
      <p id="Par22">FigureÂ <xref rid="Fig6" ref-type="fig">6</xref> shows the scattered routes with the t-SNE embedding of the obtained synthetic routes, respectively. For ease of viewing, 1,000 randomly sampled routes are shown for each template set size. Three synthetic routes sampled from the distant plot at the top of Fig.Â <xref rid="Fig6" ref-type="fig">6</xref> have different respective starting materials and reactions. The distribution of the synthetic routes designed for size 50 does not seem to be a subset of those for size 100 because the total numbers of designed routes are different, but the sampled size is the same. Additionally, the precursors of cetirizine in the middle and left routes contain carboxylic acid, while the precursor in the reported route [<xref ref-type="bibr" rid="CR50">50</xref>], shown as the black sphere route in Fig.Â <xref rid="Fig8" ref-type="fig">8</xref>, contains carboxylate ester.<fig id="Fig6"><label>Fig. 6</label><caption><p>Sampled route distribution by t-SNE embedding. The blue, orange, and green points denote sampled routes from the network constructed with the top 50, 100, and 500 reaction templates, respectively. <italic>md</italic> is fixed to 6. For each setting, 1,000 routes are sampled out of millions of candidates. The black rhombus indicates a chemically unreasonable reaction. Such a reaction may sometimes occur because CompRet algorithmically enumerates synthetic routes</p></caption><graphic xlink:href="13321_2020_452_Fig6_HTML" id="MO20"/></fig><fig id="Fig7"><label>Fig. 7</label><caption><p>Searched synthetic routes for cetirizine are enumerated, and the number of the routes for each chemical reaction network is counted at several time points. The value of <italic>md</italic> shows the maximum depth of the search algorithm. Counting is aborted when the total number of routes exceeds 1,500,000. The dotted line at the bottom indicates that the first synthetic route has been discovered</p></caption><graphic xlink:href="13321_2020_452_Fig7_HTML" id="MO21"/></fig></p>
      <p id="Par23">The results of constructing the chemical reaction network with the respective <italic>md</italic> values of 4, 6, and 8 are shown in Fig.Â <xref rid="Fig7" ref-type="fig">7</xref>. The top 100 reaction templates were used throughout. The blue line in Fig.Â <xref rid="Fig7" ref-type="fig">7</xref> is the result for <italic>md</italic> = 4, where the chemical reaction network was constructed in less than 10 seconds, and 853 routes were obtained. The orange line is identical to that in Fig.Â <xref rid="Fig5" ref-type="fig">5</xref>, that is, the result of construction with <italic>md</italic> = 6. Enumeration was halted when the number of routes exceeded 1,500,000. Figure S4 in Additional file <xref rid="MOESM1" ref-type="media">1</xref> depicts the scattered routes explored with each <italic>md</italic> using t-SNE embedding and several examples of them. This visualization also shows a variety of routes explored by CompRet.</p>
      <p id="Par24">Finally, the results of route recommendation using the route scoring methods REF, MSCS, and STEP are shown in Fig.Â <xref rid="Fig8" ref-type="fig">8</xref>. The figure illustrates several examples of synthetic routes recommended by these methods, explored using the top 500 templates and an <italic>md</italic> of 6. We also show the details of REF and MSCS distributions in Fig. S2 and S3, and Table S1 and S2 in Additional file <xref rid="MOESM1" ref-type="media">1</xref>. Compret successfully obtained the synthetic route reported in the literature [<xref ref-type="bibr" rid="CR50">50</xref>], denoted by the black sphere in Fig.Â <xref rid="Fig8" ref-type="fig">8</xref>. Using this known route as the reference for the REF methods, CompRet recommended the yellow route that changed chloride to bromine in the reference route. Its similarity score was the highest (6.32) among the enumerated routes. This result indicates that the REF method is suitable for finding routes similar to the reference route. Using MSCS, CompRet recommended the orange and purple routes, whose MSCS scores were 1.80 (lowest) and 2.28, respectively. The two routes are different from the reference route; thus, the MSCS method would have the potential to provide a variety of synthetic routes. Using STEP, CompRet recommended the red and light blue routes, whose number of steps was the smallest. The green route also has a smaller number of synthetic steps. While these routes had smaller numbers of synthetic steps, their starting materials and reactions differed. Consequently, the recommendation of routes that differed slightly from the known route, as well as diverse alternatives, demonstrates the effectiveness of the CompRet framework.<fig id="Fig8"><label>Fig. 8</label><caption><p>Examples of multiple synthetic routes for cetirizine recommended by CompRet. Each synthetic route is distinguished based on color. Parts of some routes may overlap, denoted by split spheres. In particular, the black sphere depicts the reported routes of cetirizine [<xref ref-type="bibr" rid="CR50">50</xref>]</p></caption><graphic xlink:href="13321_2020_452_Fig8_HTML" id="MO22"/></fig></p>
    </sec>
  </sec>
  <sec id="Sec12">
    <title>Conclusions</title>
    <p id="Par25">In summary, we developed CompRet, a new recommendation framework for CASP. It consists of three parts: DFPN-based chemical reaction network construction of a given target, enumeration of synthetic routes from a given chemical reaction network, and recommendation from the enumerated synthetic routes. In this study, the DFPN algorithm, which was employed to search for synthetic routes [<xref ref-type="bibr" rid="CR34">34</xref>], is extended to construct a chemical reaction network. Furthermore, we have mathematically proven the validity of the enumeration algorithm. Since a chemical reaction network is built for the target compound each time, synthetic routes can be designed for the new compound as well. This algorithm works in general for a given appropriate chemical reaction network with a mathematical guarantee. CompRet was also applied to Heifetsâ benchmark molecules and cetirizine. It was demonstrated to be able to construct chemical reaction networks, containing over a million routes in some cases, with a relatively small computational cost. Furthermore, the recommendation and visualization methods could be useful to suggest a wide variety of conceivable synthetic routes, from a slight deviation from the existing route to significantly different alternatives.</p>
    <p id="Par26">The current version of CompRet is not at the stage of practical use and has room for improvement as follows. Naively enumerating all synthetic routes leads to exponential growth of a chemical reaction network. Although the exponential growth is essentially difficult to overcome, parallel tree search algorithms [<xref ref-type="bibr" rid="CR51">51</xref>] have the potential to hand this problem. In-scope filter [<xref ref-type="bibr" rid="CR18">18</xref>] or other graph pruning algorithms [<xref ref-type="bibr" rid="CR21">21</xref>] will also provide solutions. As shown in the demonstration of chemical reaction network constructions, the explored synthetic routes depend on the template set and maximum depth <italic>md</italic>. The set of starting materials also affects the search results. Basically, CompRet can find a larger number of routes with a larger dataset and deeper depth setting. However, for practical applications, such a dataset and parameters should be determined adaptively based on the given case.</p>
    <p id="Par27">Further, template-based methods possess weaknesses such as computationally expensive subgraph isomorphism calculation [<xref ref-type="bibr" rid="CR52">52</xref>]. In the future, it may be effective to construct chemical reaction networks by using refined template extraction methods [<xref ref-type="bibr" rid="CR20">20</xref>], user-defined reaction templates, and template-free methods [<xref ref-type="bibr" rid="CR9">9</xref>, <xref ref-type="bibr" rid="CR11">11</xref>, <xref ref-type="bibr" rid="CR52">52</xref>â<xref ref-type="bibr" rid="CR54">54</xref>]. Although CompRet employs Reactor for retrosynthetic computation, other engines, such as RDChiral [<xref ref-type="bibr" rid="CR55">55</xref>], ASKCOS [<xref ref-type="bibr" rid="CR19">19</xref>] and RTSA [<xref ref-type="bibr" rid="CR15">15</xref>], would be effective alternatives. This study only considered simple methods for route recommendation. Designing synthetic route evaluation metrics that are effective in all situations is a challenging task because critical aspects of route design depend on the chemistâs objectives and/or needs [<xref ref-type="bibr" rid="CR56">56</xref>]. However, various route evaluation methods, including SCScore with reformulation [<xref ref-type="bibr" rid="CR12">12</xref>, <xref ref-type="bibr" rid="CR21">21</xref>] and other deep learning-based methods [<xref ref-type="bibr" rid="CR57">57</xref>], have been proposed in recent years. If these methods are appropriately combined with CompRet, the customized framework could function as a user-friendly route recommendation system. The results obtained in this work are considered to be a successful example of bridging CASP and the field of discrete mathematics and developing an enumeration algorithm from a new perspective. This can enable the practical improvement of CASP through algorithmic techniques. Finally, to improve usability of the framework, we plan to provide the Docker image and the web application of CompRet.</p>
  </sec>
  <sec id="Sec13">
    <title>Availability and requirements</title>
    <p id="Par28">
      <list list-type="bullet">
        <list-item>
          <p id="Par29">Project name: CompRet</p>
        </list-item>
        <list-item>
          <p id="Par30">Project home page: <ext-link ext-link-type="uri" xlink:href="https://github.com/fullswing/CompRet">https://github.com/fullswing/CompRet</ext-link></p>
        </list-item>
        <list-item>
          <p id="Par31">Operating system(s): Platform independent</p>
        </list-item>
        <list-item>
          <p id="Par32">Programming languages: Java, Python</p>
        </list-item>
        <list-item>
          <p id="Par33">Other requirements: ChemAxon</p>
        </list-item>
      </list>
    </p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary information</title>
    <sec id="Sec100">
      <p>
        <supplementary-material content-type="local-data" id="MOESM1">
          <media xlink:href="13321_2020_452_MOESM1_ESM.pdf">
            <caption>
              <p><bold>Additional file 1.</bold> CompRet: a comprehensive recommendation framework for chemical synthesis planning with algorithmic enumeration. <bold>Figure S1</bold>: Illustration of (<bold>a</bold>) basic depth-first proof number search and (<bold>b</bold>) procedures to continue searching after finding a proof tree. <bold>Figure S2</bold>: Distribution of the REF scores of the found synthetic routes for cetirizine. <bold>Figure S3</bold>: Distribution of the MSCS scores of the found synthetic routes for cetirizine. <bold>Figure S4</bold>: Examples of sampled routes' t-SNE embedding. <bold>Table S1</bold>: Detailed information of the REF distribution. <bold>Table S2</bold>: Detailed information of the MSCS distribution.</p>
            </caption>
          </media>
        </supplementary-material>
      </p>
    </sec>
  </sec>
</body>
<back>
  <fn-group>
    <fn>
      <p>
        <bold>Publisher's Note</bold>
      </p>
      <p>Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p>
    </fn>
    <fn>
      <p>Ryosuke Shibukawa and Shoichi Ishida Contributed equally</p>
    </fn>
  </fn-group>
  <sec>
    <title>Supplementary information</title>
    <p><bold>Supplementary information</bold> accompanies this paper at 10.1186/s13321-020-00452-5.
</p>
  </sec>
  <ack>
    <title>Acknowledgements</title>
    <p>We would like to thank Dr. Nobuo Cho for the valuable discussions and comments from the perspective of an expert synthetic organic chemist. This work was supported by MEXT as âProgram for Promoting Researches on the Supercomputer Fugakuâ (Application of Molecular Dynamics Simulation to Precision Medicine Using Big Data Integration System for Drug Discovery).</p>
  </ack>
  <notes notes-type="author-contribution">
    <title>Authorsâ contributions</title>
    <p>RS implemented the method, performed experiments, and wrote the manuscript. SI implemented the method, prepared data, and wrote the manuscript. KY supervised implementation of the network construction and enumeration algorithm. KW supervised implementation and proof of the enumeration algorithm. K.Takasu, YO, K.Terayama and K.Tsuda supervised the whole project. All authors provided critical feedback and helped shape the research, analysis and manuscript. All authors read and approved the final manuscript.</p>
  </notes>
  <notes notes-type="funding-information">
    <title>Funding</title>
    <p>K. Tsuda is supported by NEDO P15009, SIP (Technologies for Smart Bio-industry and Agriculture), JST CREST JPMJCR1502 and JST ERATO JPMJER1903.</p>
  </notes>
  <notes notes-type="data-availability">
    <title>Availability of data and materials</title>
    <p>The data extracted from industrial datasets from Reaxys, cannot be provided to the public. The source code of the network construction and enumeration algorithm is available at <ext-link ext-link-type="uri" xlink:href="https://github.com/fullswing/CompRet">https://github.com/fullswing/CompRet</ext-link>.</p>
  </notes>
  <notes id="FPar1" notes-type="COI-statement">
    <title>Competing interests</title>
    <p id="Par38">The authors declare that they have no competing interests.</p>
  </notes>
  <ref-list id="Bib1">
    <title>References</title>
    <ref id="CR1">
      <label>1.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Corey</surname>
            <given-names>EJ</given-names>
          </name>
        </person-group>
        <article-title>General methods for the construction of complex molecules</article-title>
        <source>Pure Appl Chem</source>
        <year>1967</year>
        <volume>14</volume>
        <issue>1</issue>
        <fpage>19</fpage>
        <lpage>38</lpage>
      </element-citation>
    </ref>
    <ref id="CR2">
      <label>2.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Corey</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Wipke</surname>
            <given-names>WT</given-names>
          </name>
        </person-group>
        <article-title>Computer-assisted design of complex organic syntheses</article-title>
        <source>Science</source>
        <year>1969</year>
        <volume>166</volume>
        <issue>3902</issue>
        <fpage>178</fpage>
        <lpage>192</lpage>
        <?supplied-pmid 17731475?>
        <pub-id pub-id-type="pmid">17731475</pub-id>
      </element-citation>
    </ref>
    <ref id="CR3">
      <label>3.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Corey</surname>
            <given-names>EJ</given-names>
          </name>
        </person-group>
        <article-title>The logic of chemical synthesis: multistep synthesis of complex carbogenic molecules (nobel lecture)</article-title>
        <source>Angew Chem Int Ed Engl</source>
        <year>1991</year>
        <volume>30</volume>
        <issue>5</issue>
        <fpage>455</fpage>
        <lpage>465</lpage>
      </element-citation>
    </ref>
    <ref id="CR4">
      <label>4.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wipke</surname>
            <given-names>WT</given-names>
          </name>
          <name>
            <surname>Ouchi</surname>
            <given-names>GI</given-names>
          </name>
          <name>
            <surname>Krishnan</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>Simulation and evaluation of chemical synthesis-secs</article-title>
        <source>Artif Intell</source>
        <year>1978</year>
        <volume>11</volume>
        <fpage>173</fpage>
        <lpage>193</lpage>
      </element-citation>
    </ref>
    <ref id="CR5">
      <label>5.</label>
      <mixed-citation publication-type="other">Gasteiger J, Hutchings MG, Christoph B, Gann L, Hiller C, LÃ¶w P, Marsili M, Saller H, Yuki K (1987) A new treatment of chemical reactivity: Development of eros, an expert system for reaction prediction and synthesis design. Organic Synthesis. Reactions and Mechanisms. Springer, Berlin, pp 19â73</mixed-citation>
    </ref>
    <ref id="CR6">
      <label>6.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hendrickson</surname>
            <given-names>JB</given-names>
          </name>
        </person-group>
        <article-title>Systematic synthesis design. 6. yield analysis and convergency</article-title>
        <source>J Am Chem Soc</source>
        <year>1977</year>
        <volume>99</volume>
        <issue>16</issue>
        <fpage>5439</fpage>
        <lpage>5450</lpage>
      </element-citation>
    </ref>
    <ref id="CR7">
      <label>7.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wipke</surname>
            <given-names>WT</given-names>
          </name>
          <name>
            <surname>Ouchi</surname>
            <given-names>GI</given-names>
          </name>
          <name>
            <surname>Krishnan</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>Simulation and evaluation of chemical synthesis-SECS: An application of artificial intelligence techniques</article-title>
        <source>Artif Intell</source>
        <year>1978</year>
        <volume>11</volume>
        <issue>1</issue>
        <fpage>173</fpage>
        <lpage>193</lpage>
      </element-citation>
    </ref>
    <ref id="CR8">
      <label>8.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Funatsu</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Sasaki</surname>
            <given-names>S-I</given-names>
          </name>
        </person-group>
        <article-title>Computer-assisted organic synthesis design and reaction prediction system, âaiphosâ</article-title>
        <source>Tetrahedron Comput Methodol</source>
        <year>1988</year>
        <volume>1</volume>
        <issue>1</issue>
        <fpage>27</fpage>
        <lpage>37</lpage>
      </element-citation>
    </ref>
    <ref id="CR9">
      <label>9.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Liu</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Ramsundar</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Kawthekar</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Shi</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Gomes</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Luu Nguyen</surname>
            <given-names>Q</given-names>
          </name>
          <name>
            <surname>Ho</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Sloane</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Wender</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Pande</surname>
            <given-names>V</given-names>
          </name>
        </person-group>
        <article-title>Retrosynthetic reaction prediction using neural sequence-to-sequence models</article-title>
        <source>ACS Cent Sci</source>
        <year>2017</year>
        <volume>3</volume>
        <issue>10</issue>
        <fpage>1103</fpage>
        <lpage>1113</lpage>
        <?supplied-pmid 29104927?>
        <pub-id pub-id-type="pmid">29104927</pub-id>
      </element-citation>
    </ref>
    <ref id="CR10">
      <label>10.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Coley</surname>
            <given-names>CW</given-names>
          </name>
          <name>
            <surname>Rogers</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Green</surname>
            <given-names>WH</given-names>
          </name>
          <name>
            <surname>Jensen</surname>
            <given-names>KF</given-names>
          </name>
        </person-group>
        <article-title>Computer-assisted retrosynthesis based on molecular similarity</article-title>
        <source>ACS Cent Sci</source>
        <year>2017</year>
        <volume>3</volume>
        <issue>12</issue>
        <fpage>1237</fpage>
        <lpage>1245</lpage>
        <?supplied-pmid 29296663?>
        <pub-id pub-id-type="pmid">29296663</pub-id>
      </element-citation>
    </ref>
    <ref id="CR11">
      <label>11.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lin</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Xu</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Pei</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Lai</surname>
            <given-names>L</given-names>
          </name>
        </person-group>
        <article-title>Automatic retrosynthetic route planning using template-free models</article-title>
        <source>Chem Sci</source>
        <year>2020</year>
        <volume>11</volume>
        <issue>12</issue>
        <fpage>3355</fpage>
        <lpage>3364</lpage>
      </element-citation>
    </ref>
    <ref id="CR12">
      <label>12.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Coley</surname>
            <given-names>CW</given-names>
          </name>
          <name>
            <surname>Rogers</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Green</surname>
            <given-names>WH</given-names>
          </name>
          <name>
            <surname>Jensen</surname>
            <given-names>KF</given-names>
          </name>
        </person-group>
        <article-title>SCScore: Synthetic complexity learned from a reaction corpus</article-title>
        <source>J Chem Inf Model</source>
        <year>2018</year>
        <volume>58</volume>
        <issue>2</issue>
        <fpage>252</fpage>
        <lpage>261</lpage>
        <?supplied-pmid 29309147?>
        <pub-id pub-id-type="pmid">29309147</pub-id>
      </element-citation>
    </ref>
    <ref id="CR13">
      <label>13.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Coley</surname>
            <given-names>CW</given-names>
          </name>
          <name>
            <surname>Barzilay</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Jaakkola</surname>
            <given-names>TS</given-names>
          </name>
          <name>
            <surname>Green</surname>
            <given-names>WH</given-names>
          </name>
          <name>
            <surname>Jensen</surname>
            <given-names>KF</given-names>
          </name>
        </person-group>
        <article-title>Prediction of organic reaction outcomes using machine learning</article-title>
        <source>ACS Cent Sci</source>
        <year>2017</year>
        <volume>3</volume>
        <issue>5</issue>
        <fpage>434</fpage>
        <lpage>443</lpage>
        <?supplied-pmid 28573205?>
        <pub-id pub-id-type="pmid">28573205</pub-id>
      </element-citation>
    </ref>
    <ref id="CR14">
      <label>14.</label>
      <mixed-citation publication-type="other">Schreck JS, Coley CW, Bishop KJ (2019) Learning retrosynthetic planning through simulated experience. ACS Cent Sci</mixed-citation>
    </ref>
    <ref id="CR15">
      <label>15.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Watson</surname>
            <given-names>IA</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Nicolaou</surname>
            <given-names>CA</given-names>
          </name>
        </person-group>
        <article-title>A retrosynthetic analysis algorithm implementation</article-title>
        <source>J Cheminf</source>
        <year>2019</year>
        <volume>11</volume>
        <issue>1</issue>
        <fpage>1</fpage>
      </element-citation>
    </ref>
    <ref id="CR16">
      <label>16.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Baylon</surname>
            <given-names>JL</given-names>
          </name>
          <name>
            <surname>Cilfone</surname>
            <given-names>NA</given-names>
          </name>
          <name>
            <surname>Gulcher</surname>
            <given-names>JR</given-names>
          </name>
          <name>
            <surname>Chittenden</surname>
            <given-names>TW</given-names>
          </name>
        </person-group>
        <article-title>Enhancing retrosynthetic reaction prediction with deep learning using multiscale reaction classification</article-title>
        <source>J Chem Inf Model</source>
        <year>2019</year>
        <volume>59</volume>
        <issue>2</issue>
        <fpage>673</fpage>
        <lpage>688</lpage>
        <?supplied-pmid 30642173?>
        <pub-id pub-id-type="pmid">30642173</pub-id>
      </element-citation>
    </ref>
    <ref id="CR17">
      <label>17.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ishida</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Terayama</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Kojima</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Takasu</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Okuno</surname>
            <given-names>Y</given-names>
          </name>
        </person-group>
        <article-title>Prediction and interpretable visualization of retrosynthetic reactions using graph convolutional networks</article-title>
        <source>J Chem Inf Model</source>
        <year>2019</year>
        <volume>59</volume>
        <issue>12</issue>
        <fpage>5026</fpage>
        <lpage>33</lpage>
        <?supplied-pmid 31769668?>
        <pub-id pub-id-type="pmid">31769668</pub-id>
      </element-citation>
    </ref>
    <ref id="CR18">
      <label>18.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Segler</surname>
            <given-names>MH</given-names>
          </name>
          <name>
            <surname>Preuss</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Waller</surname>
            <given-names>MP</given-names>
          </name>
        </person-group>
        <article-title>Planning chemical syntheses with deep neural networks and symbolic ai</article-title>
        <source>Nature</source>
        <year>2018</year>
        <volume>555</volume>
        <issue>7698</issue>
        <fpage>604</fpage>
        <?supplied-pmid 29595767?>
        <pub-id pub-id-type="pmid">29595767</pub-id>
      </element-citation>
    </ref>
    <ref id="CR19">
      <label>19.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Coley</surname>
            <given-names>CW</given-names>
          </name>
          <name>
            <surname>Thomas</surname>
            <given-names>DA</given-names>
          </name>
          <name>
            <surname>Lummiss</surname>
            <given-names>JA</given-names>
          </name>
          <name>
            <surname>Jaworski</surname>
            <given-names>JN</given-names>
          </name>
          <name>
            <surname>Breen</surname>
            <given-names>CP</given-names>
          </name>
          <name>
            <surname>Schultz</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Hart</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Fishman</surname>
            <given-names>JS</given-names>
          </name>
          <name>
            <surname>Rogers</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Gao</surname>
            <given-names>H</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>A robotic platform for flow synthesis of organic compounds informed by ai planning</article-title>
        <source>Science</source>
        <year>2019</year>
        <volume>365</volume>
        <issue>6453</issue>
        <fpage>1566</fpage>
      </element-citation>
    </ref>
    <ref id="CR20">
      <label>20.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Thakkar</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Kogej</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Reymond</surname>
            <given-names>J-L</given-names>
          </name>
          <name>
            <surname>Engkvist</surname>
            <given-names>O</given-names>
          </name>
          <name>
            <surname>Bjerrum</surname>
            <given-names>EJ</given-names>
          </name>
        </person-group>
        <article-title>Datasets and their influence on the development of computer assisted synthesis planning tools in the pharmaceutical domain</article-title>
        <source>Chem Sci</source>
        <year>2020</year>
        <volume>11</volume>
        <issue>1</issue>
        <fpage>154</fpage>
        <lpage>168</lpage>
        <?supplied-pmid 32110367?>
        <pub-id pub-id-type="pmid">32110367</pub-id>
      </element-citation>
    </ref>
    <ref id="CR21">
      <label>21.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Schwaller</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Petraglia</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Zullo</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Nair</surname>
            <given-names>VH</given-names>
          </name>
          <name>
            <surname>Haeuselmann</surname>
            <given-names>RA</given-names>
          </name>
          <name>
            <surname>Pisoni</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Bekas</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Iuliano</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Laino</surname>
            <given-names>T</given-names>
          </name>
        </person-group>
        <article-title>Predicting retrosynthetic pathways using transformer-based models and a hyper-graph exploration strategy</article-title>
        <source>Chem Sci</source>
        <year>2020</year>
        <volume>11</volume>
        <issue>12</issue>
        <fpage>3316</fpage>
        <lpage>3325</lpage>
      </element-citation>
    </ref>
    <ref id="CR22">
      <label>22.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Satyanarayanajois</surname>
            <given-names>SD</given-names>
          </name>
          <name>
            <surname>Hill</surname>
            <given-names>RA</given-names>
          </name>
        </person-group>
        <article-title>Medicinal chemistry for 2020</article-title>
        <source>Future Med Chem</source>
        <year>2011</year>
        <volume>3</volume>
        <issue>14</issue>
        <fpage>1765</fpage>
        <lpage>1786</lpage>
        <?supplied-pmid 22004084?>
        <pub-id pub-id-type="pmid">22004084</pub-id>
      </element-citation>
    </ref>
    <ref id="CR23">
      <label>23.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Grzybowski</surname>
            <given-names>BA</given-names>
          </name>
          <name>
            <surname>Bishop</surname>
            <given-names>KJ</given-names>
          </name>
          <name>
            <surname>Kowalczyk</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Wilmer</surname>
            <given-names>CE</given-names>
          </name>
        </person-group>
        <article-title>Theâwiredâuniverse of organic chemistry</article-title>
        <source>Nat Chem</source>
        <year>2009</year>
        <volume>1</volume>
        <issue>1</issue>
        <fpage>31</fpage>
        <?supplied-pmid 21378798?>
        <pub-id pub-id-type="pmid">21378798</pub-id>
      </element-citation>
    </ref>
    <ref id="CR24">
      <label>24.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kowalczyk</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Bishop</surname>
            <given-names>KJ</given-names>
          </name>
          <name>
            <surname>Smoukov</surname>
            <given-names>SK</given-names>
          </name>
          <name>
            <surname>Grzybowski</surname>
            <given-names>BA</given-names>
          </name>
        </person-group>
        <article-title>Synthetic popularity reflects chemical reactivity</article-title>
        <source>J Phys Org Chem</source>
        <year>2009</year>
        <volume>22</volume>
        <issue>9</issue>
        <fpage>897</fpage>
        <lpage>902</lpage>
      </element-citation>
    </ref>
    <ref id="CR25">
      <label>25.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Fialkowski</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Bishop</surname>
            <given-names>KJ</given-names>
          </name>
          <name>
            <surname>Chubukov</surname>
            <given-names>VA</given-names>
          </name>
          <name>
            <surname>Campbell</surname>
            <given-names>CJ</given-names>
          </name>
          <name>
            <surname>Grzybowski</surname>
            <given-names>BA</given-names>
          </name>
        </person-group>
        <article-title>Architecture and evolution of organic chemistry</article-title>
        <source>Angew Chem Int Ed Engl</source>
        <year>2005</year>
        <volume>44</volume>
        <issue>44</issue>
        <fpage>7263</fpage>
        <lpage>7269</lpage>
        <?supplied-pmid 16276556?>
        <pub-id pub-id-type="pmid">16276556</pub-id>
      </element-citation>
    </ref>
    <ref id="CR26">
      <label>26.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bishop</surname>
            <given-names>KJ</given-names>
          </name>
          <name>
            <surname>Klajn</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Grzybowski</surname>
            <given-names>BA</given-names>
          </name>
        </person-group>
        <article-title>The core and most useful molecules in organic chemistry</article-title>
        <source>Angew Chem Int Ed Engl</source>
        <year>2006</year>
        <volume>45</volume>
        <issue>32</issue>
        <fpage>5348</fpage>
        <lpage>5354</lpage>
        <?supplied-pmid 16835857?>
        <pub-id pub-id-type="pmid">16835857</pub-id>
      </element-citation>
    </ref>
    <ref id="CR27">
      <label>27.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>SzymkuÄ</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Gajewska</surname>
            <given-names>EP</given-names>
          </name>
          <name>
            <surname>Klucznik</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Molga</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Dittwald</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Startek</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Bajczyk</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Grzybowski</surname>
            <given-names>BA</given-names>
          </name>
        </person-group>
        <article-title>Computer-assisted synthetic planning: The end of the beginning</article-title>
        <source>Angew Chem Int Ed Engl</source>
        <year>2016</year>
        <volume>55</volume>
        <issue>20</issue>
        <fpage>5904</fpage>
        <lpage>5937</lpage>
        <?supplied-pmid 27062365?>
        <pub-id pub-id-type="pmid">27062365</pub-id>
      </element-citation>
    </ref>
    <ref id="CR28">
      <label>28.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kowalik</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Gothard</surname>
            <given-names>CM</given-names>
          </name>
          <name>
            <surname>Drews</surname>
            <given-names>AM</given-names>
          </name>
          <name>
            <surname>Gothard</surname>
            <given-names>NA</given-names>
          </name>
          <name>
            <surname>Weckiewicz</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Fuller</surname>
            <given-names>PE</given-names>
          </name>
          <name>
            <surname>Grzybowski</surname>
            <given-names>BA</given-names>
          </name>
          <name>
            <surname>Bishop</surname>
            <given-names>KJ</given-names>
          </name>
        </person-group>
        <article-title>Parallel optimization of synthetic pathways within the network of organic chemistry</article-title>
        <source>Angew Chem Int Ed Engl</source>
        <year>2012</year>
        <volume>51</volume>
        <issue>32</issue>
        <fpage>7928</fpage>
        <lpage>7932</lpage>
        <?supplied-pmid 22807100?>
        <pub-id pub-id-type="pmid">22807100</pub-id>
      </element-citation>
    </ref>
    <ref id="CR29">
      <label>29.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wender</surname>
            <given-names>PA</given-names>
          </name>
        </person-group>
        <article-title>Toward the ideal synthesis and molecular function through synthesis-informed design</article-title>
        <source>Nat Prod Rep</source>
        <year>2014</year>
        <volume>31</volume>
        <issue>4</issue>
        <fpage>433</fpage>
        <lpage>440</lpage>
        <?supplied-pmid 24589860?>
        <pub-id pub-id-type="pmid">24589860</pub-id>
      </element-citation>
    </ref>
    <ref id="CR30">
      <label>30.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wender</surname>
            <given-names>PA</given-names>
          </name>
          <name>
            <surname>Quiroz</surname>
            <given-names>RV</given-names>
          </name>
          <name>
            <surname>Stevens</surname>
            <given-names>MC</given-names>
          </name>
        </person-group>
        <article-title>Function through synthesis-informed design</article-title>
        <source>Acc Chem Res</source>
        <year>2015</year>
        <volume>48</volume>
        <issue>3</issue>
        <fpage>752</fpage>
        <lpage>760</lpage>
        <?supplied-pmid 25742599?>
        <pub-id pub-id-type="pmid">25742599</pub-id>
      </element-citation>
    </ref>
    <ref id="CR31">
      <label>31.</label>
      <mixed-citation publication-type="other">Nagai A (1999) Application of df-pn+ to othello endgames. In: Proceedings of Game Programming Workshopâ99</mixed-citation>
    </ref>
    <ref id="CR32">
      <label>32.</label>
      <mixed-citation publication-type="other">Nagai A (2002) Df-pn algorithm for searching and/or trees and its applications. PhD thesis, Department of Information Science, University of Tokyo</mixed-citation>
    </ref>
    <ref id="CR33">
      <label>33.</label>
      <mixed-citation publication-type="other">Kishimoto A, MÃ¼ller M (2005) Search versus knowledge for solving life and death problems in go. In: AAAI, pp. 1374â1379</mixed-citation>
    </ref>
    <ref id="CR34">
      <label>34.</label>
      <mixed-citation publication-type="other">Heifets A, Jurisica I (2012) Construction of new medicines via game proof search. In: Twenty-Sixth AAAI Conference on Artificial Intelligence</mixed-citation>
    </ref>
    <ref id="CR35">
      <label>35.</label>
      <mixed-citation publication-type="other">Kishimoto A, Buesser B, Chen B, Botea A (2019) Depth-first proof-number search with heuristic edge cost and application to chemical synthesis planning. In: Advances in Neural Information Processing Systems, pp. 7224â7234</mixed-citation>
    </ref>
    <ref id="CR36">
      <label>36.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Chaouiya</surname>
            <given-names>C</given-names>
          </name>
        </person-group>
        <article-title>Petri net modelling of biological networks</article-title>
        <source>Briefings Bioinf.</source>
        <year>2007</year>
        <volume>8</volume>
        <issue>4</issue>
        <fpage>210</fpage>
        <lpage>219</lpage>
      </element-citation>
    </ref>
    <ref id="CR37">
      <label>37.</label>
      <mixed-citation publication-type="other">ChemAxon: Reactor. <ext-link ext-link-type="uri" xlink:href="https://chemaxon.com/">https://chemaxon.com/</ext-link>. Accessed on 2020-05-01</mixed-citation>
    </ref>
    <ref id="CR38">
      <label>38.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Riniker</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Landrum</surname>
            <given-names>GA</given-names>
          </name>
        </person-group>
        <article-title>Open-source platform to benchmark fingerprints for ligand-based virtual screening</article-title>
        <source>J Cheminf</source>
        <year>2013</year>
        <volume>5</volume>
        <issue>1</issue>
        <fpage>26</fpage>
      </element-citation>
    </ref>
    <ref id="CR39">
      <label>39.</label>
      <mixed-citation publication-type="other">Landrum G et al. RDKit: Open-source cheminformatics. <ext-link ext-link-type="uri" xlink:href="http://www.rdkit.org/">http://www.rdkit.org/</ext-link>. Accessed on 2020-05-01</mixed-citation>
    </ref>
    <ref id="CR40">
      <label>40.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bajusz</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>RÃ¡cz</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>HÃ©berger</surname>
            <given-names>K</given-names>
          </name>
        </person-group>
        <article-title>Why is tanimoto index an appropriate choice for fingerprint-based similarity calculations?</article-title>
        <source>J Cheminf</source>
        <year>2015</year>
        <volume>7</volume>
        <issue>1</issue>
        <fpage>20</fpage>
      </element-citation>
    </ref>
    <ref id="CR41">
      <label>41.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Schneider</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Lowe</surname>
            <given-names>DM</given-names>
          </name>
          <name>
            <surname>Sayle</surname>
            <given-names>RA</given-names>
          </name>
          <name>
            <surname>Landrum</surname>
            <given-names>GA</given-names>
          </name>
        </person-group>
        <article-title>Development of a novel fingerprint for chemical reactions and its application to large-scale reaction classification and similarity</article-title>
        <source>J Chem Inf Model</source>
        <year>2015</year>
        <volume>55</volume>
        <issue>1</issue>
        <fpage>39</fpage>
        <lpage>53</lpage>
        <?supplied-pmid 25541888?>
        <pub-id pub-id-type="pmid">25541888</pub-id>
      </element-citation>
    </ref>
    <ref id="CR42">
      <label>42.</label>
      <mixed-citation publication-type="other">Maaten Lvd, Hinton G (2008) Visualizing data using t-sne. J. Mach. Learn. Res. 9(Nov): 2579â2605</mixed-citation>
    </ref>
    <ref id="CR43">
      <label>43.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Pedregosa</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Varoquaux</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Gramfort</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Michel</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Thirion</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Grisel</surname>
            <given-names>O</given-names>
          </name>
          <name>
            <surname>Blondel</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Prettenhofer</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Weiss</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Dubourg</surname>
            <given-names>V</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Scikit-learn: Machine learning in python</article-title>
        <source>J Machine Learning Res</source>
        <year>2011</year>
        <volume>12</volume>
        <issue>Oct</issue>
        <fpage>2825</fpage>
        <lpage>2830</lpage>
      </element-citation>
    </ref>
    <ref id="CR44">
      <label>44.</label>
      <mixed-citation publication-type="other">Reaxys. <ext-link ext-link-type="uri" xlink:href="https://www.reaxys.com/">https://www.reaxys.com/</ext-link>. Accessed on 2020-05-01</mixed-citation>
    </ref>
    <ref id="CR45">
      <label>45.</label>
      <mixed-citation publication-type="other">Enamine. <ext-link ext-link-type="uri" xlink:href="https://enamine.net/building-blocks">https://enamine.net/building-blocks</ext-link>. Accessed on 2020-05-01</mixed-citation>
    </ref>
    <ref id="CR46">
      <label>46.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Savage</surname>
            <given-names>C</given-names>
          </name>
        </person-group>
        <article-title>A survey of combinatorial gray codes</article-title>
        <source>SIAM Rev</source>
        <year>1997</year>
        <volume>39</volume>
        <issue>4</issue>
        <fpage>605</fpage>
        <lpage>629</lpage>
      </element-citation>
    </ref>
    <ref id="CR47">
      <label>47.</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Marino</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <source>Analysis and Enumeration</source>
        <year>2015</year>
        <publisher-loc>Paris</publisher-loc>
        <publisher-name>Atlantis Press</publisher-name>
      </element-citation>
    </ref>
    <ref id="CR48">
      <label>48.</label>
      <mixed-citation publication-type="other">Gansner E, Koutsofios E, North S (2006) Drawing graphs with dot. AT&amp;T Research. Accessed on 2020-05-01</mixed-citation>
    </ref>
    <ref id="CR49">
      <label>49.</label>
      <mixed-citation publication-type="other">WebMD. <ext-link ext-link-type="uri" xlink:href="https://www.webmd.com/drugs/2/drug-12065/cetirizine-oral/details">https://www.webmd.com/drugs/2/drug-12065/cetirizine-oral/details</ext-link>. Accessed on 2020-05-01</mixed-citation>
    </ref>
    <ref id="CR50">
      <label>50.</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Saunders</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <source>Top Drugs: Top Synthetic Routes</source>
        <year>2011</year>
        <publisher-loc>Oxford</publisher-loc>
        <publisher-name>Oxford University Press</publisher-name>
      </element-citation>
    </ref>
    <ref id="CR51">
      <label>51.</label>
      <mixed-citation publication-type="other">Kaneko T (2010) Parallel depth first proof number search. In: Twenty-Fourth AAAI Conference on Artificial Intelligence</mixed-citation>
    </ref>
    <ref id="CR52">
      <label>52.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Coley</surname>
            <given-names>CW</given-names>
          </name>
          <name>
            <surname>Green</surname>
            <given-names>WH</given-names>
          </name>
          <name>
            <surname>Jensen</surname>
            <given-names>KF</given-names>
          </name>
        </person-group>
        <article-title>Machine learning in computer-aided synthesis planning</article-title>
        <source>Acc Chem Res</source>
        <year>2018</year>
        <volume>51</volume>
        <issue>5</issue>
        <fpage>1281</fpage>
        <lpage>1289</lpage>
        <?supplied-pmid 29715002?>
        <pub-id pub-id-type="pmid">29715002</pub-id>
      </element-citation>
    </ref>
    <ref id="CR53">
      <label>53.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kayala</surname>
            <given-names>MA</given-names>
          </name>
          <name>
            <surname>Azencott</surname>
            <given-names>C-A</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>JH</given-names>
          </name>
          <name>
            <surname>Baldi</surname>
            <given-names>P</given-names>
          </name>
        </person-group>
        <article-title>Learning to predict chemical reactions</article-title>
        <source>J Chem Inf Model</source>
        <year>2011</year>
        <volume>51</volume>
        <issue>9</issue>
        <fpage>2209</fpage>
        <lpage>2222</lpage>
        <?supplied-pmid 21819139?>
        <pub-id pub-id-type="pmid">21819139</pub-id>
      </element-citation>
    </ref>
    <ref id="CR54">
      <label>54.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kayala</surname>
            <given-names>MA</given-names>
          </name>
          <name>
            <surname>Baldi</surname>
            <given-names>P</given-names>
          </name>
        </person-group>
        <article-title>Reactionpredictor: prediction of complex chemical reactions at the mechanistic level using machine learning</article-title>
        <source>J Chem Inf Model</source>
        <year>2012</year>
        <volume>52</volume>
        <issue>10</issue>
        <fpage>2526</fpage>
        <lpage>2540</lpage>
        <?supplied-pmid 22978639?>
        <pub-id pub-id-type="pmid">22978639</pub-id>
      </element-citation>
    </ref>
    <ref id="CR55">
      <label>55.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Coley</surname>
            <given-names>CW</given-names>
          </name>
          <name>
            <surname>Green</surname>
            <given-names>WH</given-names>
          </name>
          <name>
            <surname>Jensen</surname>
            <given-names>KF</given-names>
          </name>
        </person-group>
        <article-title>RDChiral: An RDKit wrapper for handling stereochemistry in retrosynthetic template extraction and application</article-title>
        <source>J Chem Inf Model</source>
        <year>2019</year>
        <volume>59</volume>
        <issue>6</issue>
        <fpage>2529</fpage>
        <lpage>2537</lpage>
        <?supplied-pmid 31190540?>
        <pub-id pub-id-type="pmid">31190540</pub-id>
      </element-citation>
    </ref>
    <ref id="CR56">
      <label>56.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Soh</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Wei</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Kowalczyk</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Gothard</surname>
            <given-names>CM</given-names>
          </name>
          <name>
            <surname>Baytekin</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Gothard</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Grzybowski</surname>
            <given-names>BA</given-names>
          </name>
        </person-group>
        <article-title>Estimating chemical reactivity and cross-influence from collective chemical knowledge</article-title>
        <source>Chem Sci</source>
        <year>2012</year>
        <volume>3</volume>
        <issue>5</issue>
        <fpage>1497</fpage>
        <lpage>1502</lpage>
      </element-citation>
    </ref>
    <ref id="CR57">
      <label>57.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Gao</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Coley</surname>
            <given-names>CW</given-names>
          </name>
        </person-group>
        <article-title>The synthesizability of molecules proposed by generative models</article-title>
        <source>J Chem Inf Model</source>
        <year>2020</year>
        <pub-id pub-id-type="doi">10.1021/acs.jcim.0c00174</pub-id>
        <?supplied-pmid 32804489?>
        <pub-id pub-id-type="pmid">32804489</pub-id>
      </element-citation>
    </ref>
  </ref-list>
</back>
