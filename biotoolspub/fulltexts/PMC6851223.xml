<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName A++V2.4.dtd?>
<?SourceDTD.Version 2.4?>
<?ConverterInfo.XSLTName springer2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Int J Comput Assist Radiol Surg</journal-id>
    <journal-id journal-id-type="iso-abbrev">Int J Comput Assist Radiol Surg</journal-id>
    <journal-title-group>
      <journal-title>International Journal of Computer Assisted Radiology and Surgery</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1861-6410</issn>
    <issn pub-type="epub">1861-6429</issn>
    <publisher>
      <publisher-name>Springer International Publishing</publisher-name>
      <publisher-loc>Cham</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">6851223</article-id>
    <article-id pub-id-type="publisher-id">2053</article-id>
    <article-id pub-id-type="doi">10.1007/s11548-019-02053-6</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Original Article</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>FAConstructor: an interactive tool for geometric modeling of nerve fiber architectures in the brain</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author" corresp="yes" equal-contrib="yes">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-1219-0310</contrib-id>
        <name>
          <surname>Reuter</surname>
          <given-names>Jan André</given-names>
        </name>
        <address>
          <phone>+49-2461-61-96360</phone>
          <email>j.reuter@fz-juelich.de</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author" equal-contrib="yes">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0001-6435-5351</contrib-id>
        <name>
          <surname>Matuschke</surname>
          <given-names>Felix</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-6042-7490</contrib-id>
        <name>
          <surname>Menzel</surname>
          <given-names>Miriam</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-6012-4211</contrib-id>
        <name>
          <surname>Schubert</surname>
          <given-names>Nicole</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-8170-9964</contrib-id>
        <name>
          <surname>Ginsburger</surname>
          <given-names>Kévin</given-names>
        </name>
        <xref ref-type="aff" rid="Aff3">3</xref>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0001-7906-8945</contrib-id>
        <name>
          <surname>Poupon</surname>
          <given-names>Cyril</given-names>
        </name>
        <xref ref-type="aff" rid="Aff3">3</xref>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0001-5828-0867</contrib-id>
        <name>
          <surname>Amunts</surname>
          <given-names>Katrin</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0001-5871-9331</contrib-id>
        <name>
          <surname>Axer</surname>
          <given-names>Markus</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <aff id="Aff1"><label>1</label><institution-wrap><institution-id institution-id-type="GRID">grid.8385.6</institution-id><institution-id institution-id-type="ISNI">0000 0001 2297 375X</institution-id><institution>Institute of Neuroscience and Medicine (INM-1), </institution><institution>Forschungszentrum Jülich GmbH, </institution></institution-wrap>52425 Jülich, Germany </aff>
      <aff id="Aff2"><label>2</label><institution-wrap><institution-id institution-id-type="GRID">grid.411327.2</institution-id><institution-id institution-id-type="ISNI">0000 0001 2176 9917</institution-id><institution>Cécile and Oskar Vogt Institute for Brain Research, University Hospital Düsseldorf, </institution><institution>University of Düsseldorf, </institution></institution-wrap>40204 Düsseldorf, Germany </aff>
      <aff id="Aff3"><label>3</label><institution-wrap><institution-id institution-id-type="GRID">grid.457334.2</institution-id><institution>Imaging and Spectroscopy Laboratory, </institution><institution>CEA Saclay, Neurospin, </institution></institution-wrap>Gif-sur-Yvette, France </aff>
    </contrib-group>
    <pub-date pub-type="epub">
      <day>11</day>
      <month>8</month>
      <year>2019</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>11</day>
      <month>8</month>
      <year>2019</year>
    </pub-date>
    <pub-date pub-type="ppub">
      <year>2019</year>
    </pub-date>
    <volume>14</volume>
    <issue>11</issue>
    <fpage>1881</fpage>
    <lpage>1889</lpage>
    <history>
      <date date-type="received">
        <day>25</day>
        <month>2</month>
        <year>2019</year>
      </date>
      <date date-type="accepted">
        <day>5</day>
        <month>8</month>
        <year>2019</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2019</copyright-statement>
      <license license-type="OpenAccess">
        <license-p><bold>Open Access</bold>This article is distributed under the terms of the Creative Commons Attribution 4.0 International License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted use, distribution, and reproduction in any medium, provided you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons license, and indicate if changes were made.</license-p>
      </license>
    </permissions>
    <abstract id="Abs1">
      <sec>
        <title>Purpose</title>
        <p id="Par1">The technique <italic>3D polarized light imaging</italic> (3D-PLI) allows to reconstruct nerve fiber orientations of postmortem brains with ultra-high resolution. To better understand the physical principles behind 3D-PLI and improve the accuracy and reliability of the reconstructed fiber orientations, numerical simulations are employed which use synthetic nerve fiber models as input. As the generation of fiber models can be challenging and very time-consuming, we have developed the open source <italic>FAConstructor</italic> tool which enables a fast and efficient generation of synthetic fiber models for 3D-PLI simulations.</p>
      </sec>
      <sec>
        <title>Methods </title>
        <p id="Par2">The program was developed as an interactive tool, allowing the user to define fiber pathways with interpolation methods or parametric functions and providing visual feedback.</p>
      </sec>
      <sec>
        <title>Results </title>
        <p id="Par3">Performance tests showed that most processes scale almost linearly with the amount of fiber points in <italic>FAConstructor</italic>. Fiber models consisting of &lt; 1.6 million data points retain a frame rate of more than 30 frames per second, which guarantees a stable and fluent workflow. The applicability of <italic>FAConstructor</italic> was demonstrated on a well-defined fiber model (<italic>Fiber Cup</italic> phantom) for two different simulation approaches, reproducing effects known from 3D-PLI measurements.</p>
      </sec>
      <sec>
        <title>Conclusion </title>
        <p id="Par4">We have implemented a user-friendly and efficient tool that enables an interactive and fast generation of synthetic nerve fiber configurations for 3D-PLI simulations. Already existing fiber models can easily be modified, allowing to simulate many different fiber models in a reasonable amount of time.
</p>
      </sec>
      <sec>
        <title>Electronic supplementary material</title>
        <p>The online version of this article (10.1007/s11548-019-02053-6) contains supplementary material, which is available to authorized users.</p>
      </sec>
    </abstract>
    <kwd-group xml:lang="en">
      <title>Keywords</title>
      <kwd>Nerve fiber structure</kwd>
      <kwd>White matter phantom</kwd>
      <kwd>Interactive visualization</kwd>
      <kwd>Simulation model</kwd>
      <kwd>3D polarized light imaging</kwd>
    </kwd-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/501100007601</institution-id>
            <institution>Horizon 2020</institution>
          </institution-wrap>
        </funding-source>
        <award-id>785907</award-id>
      </award-group>
    </funding-group>
    <custom-meta-group>
      <custom-meta>
        <meta-name>issue-copyright-statement</meta-name>
        <meta-value>© CARS 2019</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec id="Sec1">
    <title>Introduction</title>
    <p id="Par5">
      <fig id="Fig1">
        <label>Fig. 1</label>
        <caption>
          <p>Fiber orientation maps of a coronal section through the human brain obtained with 3D-PLI. The determined nerve fiber orientations are color-coded as indicated by the color sphere on the top left. <bold>a</bold> Whole brain section with long- and short-range fibers at a glance. <bold>b</bold> Deep white matter fascicles of fibers (close-up of the region shown in <bold>a</bold>). The fascicle dimensions vary from mm to <inline-formula id="IEq1"><alternatives><tex-math id="M1">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\upmu \hbox {m}$$\end{document}</tex-math><mml:math id="M2"><mml:mrow><mml:mi mathvariant="normal">μ</mml:mi><mml:mtext>m</mml:mtext></mml:mrow></mml:math><inline-graphic xlink:href="11548_2019_2053_Article_IEq1.gif"/></alternatives></inline-formula> scales. <bold>c</bold> Cortical fiber tracts and individual fibers (close-up of the region shown in <bold>a</bold>). Typical fiber diameters lie below <inline-formula id="IEq2"><alternatives><tex-math id="M3">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$10\,\upmu \hbox {m}$$\end{document}</tex-math><mml:math id="M4"><mml:mrow><mml:mn>10</mml:mn><mml:mspace width="0.166667em"/><mml:mi mathvariant="normal">μ</mml:mi><mml:mtext>m</mml:mtext></mml:mrow></mml:math><inline-graphic xlink:href="11548_2019_2053_Article_IEq2.gif"/></alternatives></inline-formula> [<xref ref-type="bibr" rid="CR12">12</xref>]. <bold>d</bold> Schematic drawing of a neuron with a myelinated axon</p>
        </caption>
        <graphic xlink:href="11548_2019_2053_Fig1_HTML" id="MO1"/>
      </fig>
    </p>
    <p id="Par6">Decoding the highly complex distribution and connectivity of neurons in the human brain is of major interest in neuroscience. Various neuroimaging techniques arose in recent years, each revealing specific characteristics of the brain’s nerve fiber architecture (e. g. individual myelinated axons, bundles of fibers, pathways) [<xref ref-type="bibr" rid="CR3">3</xref>]. The most prominent techniques are diffusion magnetic resonance imaging (dMRI) [<xref ref-type="bibr" rid="CR29">29</xref>], lightsheet fluorescence microscopy [<xref ref-type="bibr" rid="CR26">26</xref>], (polarization-sensitive) optical coherence tomography [<xref ref-type="bibr" rid="CR13">13</xref>, <xref ref-type="bibr" rid="CR27">27</xref>], and <italic>3D polarized light imaging</italic> (3D-PLI) [<xref ref-type="bibr" rid="CR1">1</xref>, <xref ref-type="bibr" rid="CR2">2</xref>, <xref ref-type="bibr" rid="CR30">30</xref>]. None of these techniques has a real ground truth to compare with, leading indispensably to the idea of cross-modality research and technology-specific simulation approaches. Well-defined bio-mimicking numerical phantoms subjected to dMRI simulators have already been proven to be essential tools for better understanding of the underlying physical mechanisms (e. g. water diffusion, magnetic field dependencies) and, ultimately, improving the interpretation of the measured signals [<xref ref-type="bibr" rid="CR7">7</xref>, <xref ref-type="bibr" rid="CR9">9</xref>, <xref ref-type="bibr" rid="CR10">10</xref>, <xref ref-type="bibr" rid="CR14">14</xref>].</p>
    <p id="Par7">In the present study, we focus on fiber modeling and simulation aspects of the microscopic neuroimaging technique 3D-PLI, which enables the reconstruction of the nerve fiber architecture of whole postmortem brains at micrometer resolution [<xref ref-type="bibr" rid="CR1">1</xref>, <xref ref-type="bibr" rid="CR2">2</xref>, <xref ref-type="bibr" rid="CR30">30</xref>]. With 3D-PLI, the spatial orientations of fibers are derived from unstained histological brain sections in a polarimetric system that measures the local birefringence. This birefringence is mainly caused by the highly ordered molecular arrangement of the myelin sheaths wrapped around many axons in the white matter. Figure <xref rid="Fig1" ref-type="fig">1</xref> demonstrates the unique potential of 3D-PLI to carve out the entire spectrum of real nerve fiber structures ranging from individual cortical fibers (<inline-formula id="IEq3"><alternatives><tex-math id="M5">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\upmu \hbox {m}$$\end{document}</tex-math><mml:math id="M6"><mml:mrow><mml:mi mathvariant="normal">μ</mml:mi><mml:mtext>m</mml:mtext></mml:mrow></mml:math><inline-graphic xlink:href="11548_2019_2053_Article_IEq3.gif"/></alternatives></inline-formula> scale) to long-distance fiber bundles or fascicles (mm to cm scales), even within one coronal human brain section. However, in brain regions where fiber structures show dispersed orientations within one volume element, the derived orientations might be misinterpreted. In order to underpin or improve fiber orientation estimations by means of 3D-PLI, two complementary numerical simulation approaches have recently been implemented: (i) the matrix calculus simulation (<italic>simPLI</italic>) [<xref ref-type="bibr" rid="CR6">6</xref>, <xref ref-type="bibr" rid="CR16">16</xref>, <xref ref-type="bibr" rid="CR17">17</xref>] and (ii) the <italic>finite-difference time-domain</italic> (FDTD) simulation [<xref ref-type="bibr" rid="CR18">18</xref>, <xref ref-type="bibr" rid="CR19">19</xref>].</p>
    <p id="Par8">Both types of simulation require numerical fiber phantoms as input, describing anatomical and optical properties and mimicking brain tissue to a certain degree of realism. In the present study, the focus was on white matter phantoms defined by numerous fiber models with specified fiber diameter, myelin thickness, spatial course, refractive indices, etc. The generation of such fiber models and resultant phantoms, however, is challenging and time-consuming, especially when targeting complex and large-scale models.</p>
    <p id="Par9">We introduce the easy-to-use open source software tool <italic>Fiber Architecture Constructor (FAConstructor)</italic> enabling fast and efficient generation of white matter phantoms. It allows to define <italic>fiber objects</italic> (e. g. individual fibers, tracts, bundles) which can be rotated, (re)moved, duplicated, and spatially integrated into complex large-scale phantoms. To enable modification of a large amount of fibers, fiber objects can be arranged in groups. By this means, the brain’s multiscale characteristics can be built from small numerical tissue units complying with the specific requirements posed by the different simulation approaches. The implemented graphical user interface allows the user to examine and interact with the generated fiber models in 3D space and provides direct visual feedback prior to simulation.</p>
    <p id="Par10">We demonstrate the applicability of <italic>FAConstructor</italic> by using the example of the so-called <italic>Fiber Cup</italic> phantom [<xref ref-type="bibr" rid="CR7">7</xref>], which has initially been designed for an international competition on fiber reconstruction approaches (i. e. tractography algorithms) based on dMRI-like data. The resulting phantom is finally subjected to both the <italic>simPLI</italic> and the FDTD simulations.<fig id="Fig2"><label>Fig. 2</label><caption><p><bold>a</bold> Fiber object representing a fiber bundle (envelope) as generated by <italic>FAConstructor</italic>. The main monitor shows the fiber object from a certain view. Objects can be rotated, scaled, or translated by the user. Lists of all generated fibers and groups are shown on the top right. Objects can be selectively shown by the corresponding checkboxes next to their labels. The parametric functions describing the coordinates and radii of the displayed objects are also displayed. Here, the object has been generated by the parametric functions <inline-formula id="IEq4"><alternatives><tex-math id="M7">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\left( x(t) = 50 \cdot \sin (t\cdot \pi ),\ y(t) = 50 \cdot \cos (t\cdot \pi ),\ z(t) = 50\cdot t,\ r(t) = -\,|15 \cdot t |+ 15, t \in \left[ -\,0.5, 0.5\right] \right) $$\end{document}</tex-math><mml:math id="M8"><mml:mfenced close=")" open="("><mml:mi>x</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mn>50</mml:mn><mml:mo>·</mml:mo><mml:mo>sin</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo>·</mml:mo><mml:mi>π</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:mspace width="4pt"/><mml:mi>y</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mn>50</mml:mn><mml:mo>·</mml:mo><mml:mo>cos</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo>·</mml:mo><mml:mi>π</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:mspace width="4pt"/><mml:mi>z</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mn>50</mml:mn><mml:mo>·</mml:mo><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:mspace width="4pt"/><mml:mi>r</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mo>-</mml:mo><mml:mspace width="0.166667em"/><mml:mo stretchy="false">|</mml:mo><mml:mn>15</mml:mn><mml:mo>·</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">|</mml:mo><mml:mo>+</mml:mo><mml:mn>15</mml:mn><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo>∈</mml:mo></mml:mrow><mml:mfenced close="]" open="["><mml:mo>-</mml:mo><mml:mspace width="0.166667em"/><mml:mn>0.5</mml:mn><mml:mo>,</mml:mo><mml:mn>0.5</mml:mn></mml:mfenced></mml:mfenced></mml:math><inline-graphic xlink:href="11548_2019_2053_Article_IEq4.gif"/></alternatives></inline-formula>. All other options are accessible through the menu bar at the top. <bold>b</bold> Fiber object filled with fibers. With increasing radius of the fiber object, the distance between the fibers increases accordingly</p></caption><graphic xlink:href="11548_2019_2053_Fig2_HTML" id="MO2"/></fig></p>
  </sec>
  <sec id="Sec2">
    <title>The fiber architecture constructor (FAConstructor)</title>
    <p id="Par11">The <italic>FAConstructor</italic> is a simple, effective, and interactive tool to generate and visualize fiber objects as input for simulations or similar purposes. An open source version of the code and a detailed description of compilation and usage are provided through the following GitHub repository: <ext-link ext-link-type="uri" xlink:href="https://github.com/3d-pli/FAConstructor">https://github.com/3d-pli/FAConstructor</ext-link>.</p>
    <p id="Par12">The tool allows an exact definition of curves using parametric functions or interpolation methods. Each curve contains a number of data points consisting of coordinates in three-dimensional space and radii for each data point. By this means, individual fibers or entire fiber bundles will be described in the following and referred to as <italic>fiber objects</italic>.</p>
    <sec id="Sec3">
      <title>Generation of fiber objects</title>
      <p id="Par13">A key feature of the <italic>FAConstructor</italic> is the generation of fiber objects with defined pathways and geometries. The user is able to define arbitrary fiber pathways using either interpolation methods with given coordinates or parametric functions. As the tool allows fiber objects to overlap, postprocessing might become necessary to avoid fiber intersections.</p>
      <p id="Par14">The manual input of three-dimensional coordinates allows a precise definition of fiber pathways. A different radius can be assigned to each coordinate, allowing each object to grow or shrink along its trajectory. In addition, the user can apply cubic spline interpolation to smooth the fiber object. In this case, both coordinates and radii are interpolated.</p>
      <p id="Par15">A major advantage of the developed tool is that individual fiber objects can be modified without need to regenerate the whole model. Both whole fiber objects and individual fiber coordinates can be rotated, translated, or duplicated. In this way, the user can modify an already existing fiber model and build large-scale models without much effort. Furthermore, it is possible to group several fiber objects together and change or duplicate them at the same time. The groups can be exported for future usage.</p>
      <p id="Par16">To facilitate the generation of nested fiber objects, the <italic>FAConstructor</italic> allows to fill a parent fiber object with multiple child objects, which can be filled by other fiber objects and so on. Here, we only consider fiber objects that were once filled with individual fibers, so we refer to the parent fiber object as fiber bundle and to the child objects as fibers.</p>
      <p id="Par17">When filling a fiber bundle with fibers, the cross section with minimum radius is used as starting point. The fibers are arranged on a triangular grid (see Fig. <xref rid="Fig2" ref-type="fig">2</xref>b), and the radius of every fiber and the minimum distance between neighbored fibers are defined by the user. The triangular grid is rotated from one data point to the next using the tangents of each point and computing the rotation angle using the Rodrigues formula [<xref ref-type="bibr" rid="CR5">5</xref>].</p>
      <p id="Par18">If the radius increases along the course of the fiber bundle, the distance between the fibers increases accordingly. This guarantees that the fibers in the bundle do not intersect with each other, provided that the user-defined minimum distance does not fall below the diameter of the fibers. The generated fibers are stored as a group, allowing efficient modifications of the fiber bundle.<fig id="Fig3"><label>Fig. 3</label><caption><p>Performance measurements of four scenarios during the generation of a fiber object. The <italic>x</italic>-axis shows the number of data points used for the respective measurements, and the <italic>y</italic>-axis shows the elapsed time or the frame rate. The used parameters are shown in Eqs. <xref rid="Equ1" ref-type="">1</xref>–<xref rid="Equ2" ref-type="">2</xref>: <bold>a</bold> Generation of fiber objects by manual input. The data points are defined and connected using cubic spline interpolation. <bold>b</bold> Generation of a helix using parametric functions. <bold>c</bold> Filling <italic>n</italic> fiber objects containing 1000 data points with 21 nested fiber objects each. The peaks in plot are most likely due to the memory utilization of the data type. <bold>d</bold> Frame rate while interacting with <italic>n</italic> fiber objects on screen</p></caption><graphic xlink:href="11548_2019_2053_Fig3_HTML" id="MO3"/></fig></p>
      <p id="Par19">Coordinates and radii of the fiber objects are defined as single-precision floating-point values, which can be saved either in a hierarchical file system-like data format (HDF5, <ext-link ext-link-type="uri" xlink:href="https://www.hdfgroup.org">https://www.hdfgroup.org</ext-link>) or, alternatively, in a plain text file format. HDF5 is advantageous, because it allows to handle metadata, it has no limitation on the number or size of data objects in the collection, giving great flexibility for big data, and it provides high-performance I/O with a rich set of integrated performance features.</p>
    </sec>
    <sec id="Sec4">
      <title>Rendering</title>
      <p id="Par20">As the <italic>FAConstructor</italic> allows to generate fiber objects interactively, an efficient rendering of the data is crucial. Therefore, a new frame is only rendered when the user interacts with the fiber objects by rotating or translating them, allowing fluent interaction. Rendering is realized with the <italic>OpenGL</italic> 3.3 framework of <italic>Qt5</italic> [<xref ref-type="bibr" rid="CR4">4</xref>, <xref ref-type="bibr" rid="CR25">25</xref>] which enables the use of widgets for applying options and generating fibers, while rendering is done in a single central widget. In addition, <italic>OpenMP</italic> [<xref ref-type="bibr" rid="CR22">22</xref>] can be used optionally for several tasks granting performance improvements. Fiber objects and individual fibers are approximated by cylindrical shapes using the defined coordinates and radii. As circular objects cannot be rendered without approximation, they are represented by <italic>n</italic>-sided regular polygons. Even when displaying a large amount of fibers, the tool maintains a sufficient frame rate: The parameter <italic>n</italic> is dynamically adjusted to ensure a frame rate above 30. In addition, double-buffered <italic>V-Sync</italic> is used to reduce stutter which might occur when encountering a fluctuating frame rate. Nonvisible fiber objects are culled out using the <italic>Cohen–Sutherland</italic> algorithm [<xref ref-type="bibr" rid="CR8">8</xref>]. As the fiber object trajectory is a line until drawn in the <italic>OpenGL</italic> shaders, this algorithm can be applied. The user is able to interact with the rendering area by moving, rotating, and scaling the shown content. When losing focus of the current object, the user can reset the view, displaying the whole object in the center. It is also possible to display different orthogonal views of the model and walk through the model using keyboard shortcuts. The user is able to hide certain fiber objects or whole groups by deselecting the checkboxes next to their corresponding labels (cf. Fig. <xref rid="Fig2" ref-type="fig">2</xref>b). This helps to keep an overview and improves performance.</p>
      <p id="Par21">Fiber bundles are colored according to their respective orientation in three-dimensional space, using either an <italic>RGB</italic> (red–green–blue) or an <italic>HSV</italic> (hue–saturation–value) color map which are also used to visualize 3D-PLI data shown in Fig. <xref rid="Fig1" ref-type="fig">1</xref>. In the right bottom corner of the rendering area, a color sphere displays the orientation of the fiber objects. The sphere changes when the user rotates the model. To distinguish individual fibers, it is also possible to assign each fiber bundle a randomized color based on the fiber index.</p>
    </sec>
    <sec id="Sec5">
      <title>Performance measurements</title>
      <p id="Par22">To ensure that the user can work fluently with a large number of fiber points in <italic>FAConstructor</italic>, performance optimizations were implemented as mentioned in “Rendering” section and tested on the generation and rendering of fiber objects. Performance measurements were performed using a PC with an Intel Core i5-3570 processor paired with an NVIDIA GTX 1070 and 16 GB RAM running Ubuntu 18.04.</p>
      <p id="Par23">Figure <xref rid="Fig3" ref-type="fig">3</xref> shows the measured performance of the program. The corresponding datasets were created with the following parameters:<disp-formula id="Equ1"><label>1</label><alternatives><tex-math id="M9">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned}&amp;(A), (C) : x(t) = t, \quad y(t) = t,\nonumber \\&amp;z(t) = t, \quad r(t) = t, \quad t \in [0, 1, \ldots , N] \end{aligned}$$\end{document}</tex-math><mml:math id="M10" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd/><mml:mtd columnalign="left"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>A</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>C</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>:</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:mspace width="1em"/><mml:mi>y</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mi>t</mml:mi><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow/></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mi>z</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:mspace width="1em"/><mml:mi>r</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:mspace width="1em"/><mml:mi>t</mml:mi><mml:mo>∈</mml:mo><mml:mo stretchy="false">[</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mi>N</mml:mi><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="11548_2019_2053_Article_Equ1.gif" position="anchor"/></alternatives></disp-formula><disp-formula id="Equ2"><label>2</label><alternatives><tex-math id="M11">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned}&amp;(B) : x(t) = \sin (t), \quad y(t) = \cos (t), \nonumber \\&amp;z(t) = t, \quad r(t) = 1, \quad t \in [0, 1, \ldots , N] \end{aligned}$$\end{document}</tex-math><mml:math id="M12" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd/><mml:mtd columnalign="left"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>B</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>:</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mo>sin</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo><mml:mspace width="1em"/><mml:mi>y</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mo>cos</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow/></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mi>z</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:mspace width="1em"/><mml:mi>r</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mspace width="1em"/><mml:mi>t</mml:mi><mml:mo>∈</mml:mo><mml:mo stretchy="false">[</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mi>N</mml:mi><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="11548_2019_2053_Article_Equ2.gif" position="anchor"/></alternatives></disp-formula>where <italic>x</italic>(<italic>t</italic>), <italic>y</italic>(<italic>t</italic>), <italic>z</italic>(<italic>t</italic>) are space coordinates and <italic>r</italic>(<italic>t</italic>) is the radius of the fiber object at this position. The functions describe fiber objects consisting of <inline-formula id="IEq5"><alternatives><tex-math id="M13">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$N-1$$\end{document}</tex-math><mml:math id="M14"><mml:mrow><mml:mi>N</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="11548_2019_2053_Article_IEq5.gif"/></alternatives></inline-formula> segments. This allows to conduct performance measurements as a function of the number of objects.</p>
      <p id="Par24">The test procedures to generate Fig. <xref rid="Fig3" ref-type="fig">3</xref>a, b, d consisted of starting the program, creating or loading the corresponding data points, and measuring the time or frame rate. Afterward, the program was closed to avoid possible influence on the following iteration. This procedure was repeated ten times for each data point. Measuring the performance when filling the fiber bundles was done by creating a dataset containing <italic>n</italic> fiber objects with 1000 data points each using Eq. <xref rid="Equ1" ref-type="">1</xref>. The fiber objects were filled with fibers with a distance of <inline-formula id="IEq6"><alternatives><tex-math id="M15">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$d = 0.2$$\end{document}</tex-math><mml:math id="M16"><mml:mrow><mml:mi>d</mml:mi><mml:mo>=</mml:mo><mml:mn>0.2</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="11548_2019_2053_Article_IEq6.gif"/></alternatives></inline-formula> and a radius of <inline-formula id="IEq7"><alternatives><tex-math id="M17">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$r = 0.1$$\end{document}</tex-math><mml:math id="M18"><mml:mrow><mml:mi>r</mml:mi><mml:mo>=</mml:mo><mml:mn>0.1</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="11548_2019_2053_Article_IEq7.gif"/></alternatives></inline-formula>, yielding 21 fibers. The measured time of 20 separate runs was taken and averaged. As the program can use <italic>OpenMP</italic> for parallelization, both variants were measured individually.</p>
      <p id="Par25">As seen in Fig. <xref rid="Fig3" ref-type="fig">3</xref>a–c, the program tends to scale linearly with the produced amount of data points. The usage of <italic>OpenMP</italic> shows a speedup of 1.21 to 2.1 depending on the measured part of the program. The frame rate in (D) maintains the 30 fps target when the amount of fiber points lies below 1.6 million. This is due to the insufficient performance of the graphics card to display all data points simultaneously. Even when rendering around 60 million data points, 11 GiB RAM and 2.3 GiB video memory are consumed, indicating that neither is a limiting factor. When rendering, the CPU usage stays around 0% to 10%.</p>
    </sec>
  </sec>
  <sec id="Sec6">
    <title>Usecase: Fiber Cup phantom</title>
    <p id="Par26">The <italic>Fiber Cup</italic> phantom introduced by Fillard et al. [<xref ref-type="bibr" rid="CR7">7</xref>] was used for qualitative and quantitative evaluation of tractography methods in dMRI. It was inspired by nerve fiber configurations in a coronal human brain section, including regions with fiber crossings, fanning, and bending. Both the reconstruction of crossing and that of fanning fibers represent a challenge for 3D-PLI. The reconstructed phantom used for our simulations was similar to the original <italic>Fiber Cup</italic> phantom, only deviating slightly in the crossing angles between the fiber bundles.</p>
    <p id="Par27">The <italic>Fiber Cup</italic> phantom was built using parametric functions as well as user-defined fiber points with cubic spline interpolation. When generating the <italic>Fiber Cup</italic> phantom, some of the fiber objects partially overlap. This leads to a higher density of fibers when filling the objects. Fiber bundles 4 to 6, for example, merge into one bundle (see Fig. <xref rid="Fig4" ref-type="fig">4</xref>), resulting in a three times higher fiber density as compared to the transverse bundle 3.</p>
    <p id="Par28">The fiber objects were filled with equidistant seed points on a triangular grid (see “Generation of fiber objects” section), yielding 10,149 fibers in total. The fibers have diameters of <inline-formula id="IEq8"><alternatives><tex-math id="M19">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$1.5\,\upmu \hbox {m}$$\end{document}</tex-math><mml:math id="M20"><mml:mrow><mml:mn>1.5</mml:mn><mml:mspace width="0.166667em"/><mml:mi mathvariant="normal">μ</mml:mi><mml:mtext>m</mml:mtext></mml:mrow></mml:math><inline-graphic xlink:href="11548_2019_2053_Article_IEq8.gif"/></alternatives></inline-formula> and lie <inline-formula id="IEq9"><alternatives><tex-math id="M21">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$1.5\,\upmu \hbox {m}$$\end{document}</tex-math><mml:math id="M22"><mml:mrow><mml:mn>1.5</mml:mn><mml:mspace width="0.166667em"/><mml:mi mathvariant="normal">μ</mml:mi><mml:mtext>m</mml:mtext></mml:mrow></mml:math><inline-graphic xlink:href="11548_2019_2053_Article_IEq9.gif"/></alternatives></inline-formula> apart, and the diameter of the fiber bundles is <inline-formula id="IEq10"><alternatives><tex-math id="M23">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$120\,\upmu \hbox {m}$$\end{document}</tex-math><mml:math id="M24"><mml:mrow><mml:mn>120</mml:mn><mml:mspace width="0.166667em"/><mml:mi mathvariant="normal">μ</mml:mi><mml:mtext>m</mml:mtext></mml:mrow></mml:math><inline-graphic xlink:href="11548_2019_2053_Article_IEq10.gif"/></alternatives></inline-formula>. The result is shown in Fig. <xref rid="Fig4" ref-type="fig">4</xref>.</p>
    <p id="Par29">However, as two distinct nerve fibers in real brain tissue do not occupy the same point in space in a crossing situation, the generated fiber configurations were checked for such unrealistic collisions and solved using an additional in-house developed software [<xref ref-type="bibr" rid="CR15">15</xref>] before performing the imaging/measurement simulations. Depending on the initial objects’ fraction of overlap, the density of the fibers can change during this process. Most likely, this results in a decrease in density, since the fiber objects are designed as rigid objects. In the <italic>Fiber Cup</italic> example, the fiber densities within the intersecting regions 1 to 3 in Fig. <xref rid="Fig5" ref-type="fig">5</xref> decreased by <inline-formula id="IEq11"><alternatives><tex-math id="M25">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$29\%(1), 25\%(2)$$\end{document}</tex-math><mml:math id="M26"><mml:mrow><mml:mn>29</mml:mn><mml:mo>%</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo><mml:mn>25</mml:mn><mml:mo>%</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mn>2</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="11548_2019_2053_Article_IEq11.gif"/></alternatives></inline-formula>, and <inline-formula id="IEq12"><alternatives><tex-math id="M27">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$3\%(3)$$\end{document}</tex-math><mml:math id="M28"><mml:mrow><mml:mn>3</mml:mn><mml:mo>%</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mn>3</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="11548_2019_2053_Article_IEq12.gif"/></alternatives></inline-formula>, respectively.<fig id="Fig4"><label>Fig. 4</label><caption><p><italic>Fiber Cup</italic> phantom filled with fibers. The different fiber bundles (numbered from 1 to 7) were generated as described in “Usecase: Fiber Cup phantom” section</p></caption><graphic xlink:href="11548_2019_2053_Fig4_HTML" id="MO6"/></fig></p>
    <sec id="Sec7">
      <title>Three-dimensional polarized light imaging (3D-PLI)</title>
      <p id="Par30">3D-PLI is a postmortem imaging technique for unstained histological brain sections. Due to the birefringence (optical anisotropy) of the nerve fibers, the state of polarization changes when light passes through brain tissue. In 3D-PLI, this change of polarization is measured with a polarimetric setup (polarizer, specimen, quarter-wave retarder, analyzer), allowing to determine the spatial orientations of the nerve fibers with micrometer resolution. The measurement and signal analysis of 3D-PLI have been described in detail by Axer et al. [<xref ref-type="bibr" rid="CR2">2</xref>]. As the investigated brain sections are about <inline-formula id="IEq13"><alternatives><tex-math id="M29">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$60\,\upmu \hbox {m}$$\end{document}</tex-math><mml:math id="M30"><mml:mrow><mml:mn>60</mml:mn><mml:mspace width="0.166667em"/><mml:mi mathvariant="normal">μ</mml:mi><mml:mtext>m</mml:mtext></mml:mrow></mml:math><inline-graphic xlink:href="11548_2019_2053_Article_IEq13.gif"/></alternatives></inline-formula> thick, each measured volume element contains several nerve fibers. 3D-PLI extracts only the predominant fiber orientation, and the orientations of individual nerve fibers within deep white matter structures can therefore not be determined. Inhomogeneous nerve fiber structures, like crossing fibers or regions with varying fiber densities, influence the measured birefringence signal and may lead to misinterpretations in the reconstructed fiber orientations.<fig id="Fig5"><label>Fig. 5</label><caption><p><bold>a</bold> Vector field obtained from <italic>simPLI</italic> simulations of the collision-free <italic>Fiber Cup</italic> phantom, overlaid with the employed fiber model. The orientation of the vectors are color-coded. Visualization has been realized with in-house developed software [<xref ref-type="bibr" rid="CR24">24</xref>]. <bold>b</bold> FDTD simulations of the three selected regions (fiber crossings) in the collision-free <italic>Fiber Cup</italic> phantom shown in (<bold>a</bold>). The images on the left show a cross section (<italic>xy</italic>-plane) through the middle of the simulated fiber volume (<inline-formula id="IEq14"><alternatives><tex-math id="M31">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$128 \times 128 \times 60\,\upmu \hbox {m}^3$$\end{document}</tex-math><mml:math id="M32"><mml:mrow><mml:mn>128</mml:mn><mml:mo>×</mml:mo><mml:mn>128</mml:mn><mml:mo>×</mml:mo><mml:mn>60</mml:mn><mml:mspace width="0.166667em"/><mml:mi mathvariant="normal">μ</mml:mi><mml:msup><mml:mtext>m</mml:mtext><mml:mn>3</mml:mn></mml:msup></mml:mrow></mml:math><inline-graphic xlink:href="11548_2019_2053_Article_IEq14.gif"/></alternatives></inline-formula>). The images on the right show the corresponding scattering patterns (intensity per wave vector). The white circles indicate steps of <inline-formula id="IEq15"><alternatives><tex-math id="M33">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$10^{\circ }$$\end{document}</tex-math><mml:math id="M34"><mml:msup><mml:mn>10</mml:mn><mml:mo>∘</mml:mo></mml:msup></mml:math><inline-graphic xlink:href="11548_2019_2053_Article_IEq15.gif"/></alternatives></inline-formula>, from <inline-formula id="IEq16"><alternatives><tex-math id="M35">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$0^{\circ }$$\end{document}</tex-math><mml:math id="M36"><mml:msup><mml:mn>0</mml:mn><mml:mo>∘</mml:mo></mml:msup></mml:math><inline-graphic xlink:href="11548_2019_2053_Article_IEq16.gif"/></alternatives></inline-formula> (center) to <inline-formula id="IEq17"><alternatives><tex-math id="M37">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$90^{\circ }$$\end{document}</tex-math><mml:math id="M38"><mml:msup><mml:mn>90</mml:mn><mml:mo>∘</mml:mo></mml:msup></mml:math><inline-graphic xlink:href="11548_2019_2053_Article_IEq17.gif"/></alternatives></inline-formula> (outer circle). The straight colored lines around the scattering patterns indicate the axes perpendicular to the fiber bundles in the phantom (colors were chosen according to the colors of the fiber bundles shown in <bold>a</bold>)</p></caption><graphic xlink:href="11548_2019_2053_Fig5_HTML" id="MO7"/></fig></p>
    </sec>
    <sec id="Sec8">
      <title>Simulation methods</title>
      <p id="Par31"><italic>Matrix calculus (simPLI)</italic> The in-house developed software <italic>simPLI</italic> [<xref ref-type="bibr" rid="CR6">6</xref>] computes the change of polarization of a light beam when passing through a brain tissue sample. The light beam is modeled by Stokes vectors, the optical elements of the polarimeter and the brain tissue by Müller matrices [<xref ref-type="bibr" rid="CR21">21</xref>]. The birefringence of the nerve fibers is modeled by optical retarder matrices, with the retarder axis oriented along the fiber axis [<xref ref-type="bibr" rid="CR16">16</xref>]. To account for the imaging system, the image is downsampled and blurred with a Gaussian function with <inline-formula id="IEq18"><alternatives><tex-math id="M39">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\sigma = 0.714\,\Delta {x}$$\end{document}</tex-math><mml:math id="M40"><mml:mrow><mml:mi>σ</mml:mi><mml:mo>=</mml:mo><mml:mn>0.714</mml:mn><mml:mspace width="0.166667em"/><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>x</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="11548_2019_2053_Article_IEq18.gif"/></alternatives></inline-formula> as described by Menzel et al. [<xref ref-type="bibr" rid="CR16">16</xref>]. Finally, noise is modeled according to Schmitz et al. [<xref ref-type="bibr" rid="CR23">23</xref>]. The resulting signals are analyzed using the <italic>ROFL</italic> algorithm [<xref ref-type="bibr" rid="CR23">23</xref>], resulting in fiber orientation maps.</p>
      <p id="Par32"><italic>Finite-Difference Time-Domain (FDTD) simulation </italic> To study more complex light–matter interactions like scattering and interference, <italic>Finite-Difference Time-Domain</italic> (FDTD) simulations are used. With FDTD simulations, it is possible to study light transmitted through artificial nerve fiber models as well as scattering of light [<xref ref-type="bibr" rid="CR18">18</xref>, <xref ref-type="bibr" rid="CR19">19</xref>]. The propagation of the electromagnetic light wave through the sample was computed by <inline-formula id="IEq19"><alternatives><tex-math id="M41">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\textit{TDME3D}^{{\mathrm{TM}}}$$\end{document}</tex-math><mml:math id="M42"><mml:mrow><mml:mi mathvariant="italic">TDME</mml:mi><mml:mn mathvariant="italic">3</mml:mn><mml:msup><mml:mi mathvariant="italic">D</mml:mi><mml:mi mathvariant="normal">TM</mml:mi></mml:msup></mml:mrow></mml:math><inline-graphic xlink:href="11548_2019_2053_Article_IEq19.gif"/></alternatives></inline-formula>, a massively parallel three-dimensional Maxwell Solver based on a conditionally stable FDTD algorithm [<xref ref-type="bibr" rid="CR20">20</xref>, <xref ref-type="bibr" rid="CR28">28</xref>]: The electromagnetic field components are computed numerically by discretizing space and time and approximating the spatial and temporal derivatives in Maxwell’s curl equations by second-order central differences. More details about the algorithm can be found in Menzel et al. [<xref ref-type="bibr" rid="CR17">17</xref>].</p>
    </sec>
    <sec id="Sec9">
      <title>Simulation results</title>
      <p id="Par33"><italic>Matrix calculus (simPLI)</italic> The collision-free <italic>Fiber Cup</italic> phantom was used as input for <italic>simPLI</italic> (see “Simulation methods” section). The fibers were modeled as homogeneous materials with an absorption of <inline-formula id="IEq20"><alternatives><tex-math id="M43">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mu = 5\hbox { mm}^{-1}$$\end{document}</tex-math><mml:math id="M44"><mml:mrow><mml:mi>μ</mml:mi><mml:mo>=</mml:mo><mml:mn>5</mml:mn><mml:mspace width="0.333333em"/><mml:msup><mml:mtext>mm</mml:mtext><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math><inline-graphic xlink:href="11548_2019_2053_Article_IEq20.gif"/></alternatives></inline-formula>, and the birefringence was modeled with a strength of <inline-formula id="IEq21"><alternatives><tex-math id="M45">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\Delta {n} = 0.001$$\end{document}</tex-math><mml:math id="M46"><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:mn>0.001</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="11548_2019_2053_Article_IEq21.gif"/></alternatives></inline-formula> and one axis of anisotropy oriented along the longitudinal fiber axis [<xref ref-type="bibr" rid="CR16">16</xref>]. For the simulation, a section of <inline-formula id="IEq22"><alternatives><tex-math id="M47">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$60\,\upmu \hbox {m}$$\end{document}</tex-math><mml:math id="M48"><mml:mrow><mml:mn>60</mml:mn><mml:mspace width="0.166667em"/><mml:mi mathvariant="normal">μ</mml:mi><mml:mtext>m</mml:mtext></mml:mrow></mml:math><inline-graphic xlink:href="11548_2019_2053_Article_IEq22.gif"/></alternatives></inline-formula> thickness from the mid-plane of the <italic>Fiber Cup</italic> phantom was used, discretized into voxels of <inline-formula id="IEq23"><alternatives><tex-math id="M49">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$1\,\upmu \hbox {m}$$\end{document}</tex-math><mml:math id="M50"><mml:mrow><mml:mn>1</mml:mn><mml:mspace width="0.166667em"/><mml:mi mathvariant="normal">μ</mml:mi><mml:mtext>m</mml:mtext></mml:mrow></mml:math><inline-graphic xlink:href="11548_2019_2053_Article_IEq23.gif"/></alternatives></inline-formula> side length. The simulations were performed with wavelength <inline-formula id="IEq24"><alternatives><tex-math id="M51">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\lambda = 525\hbox { nm}$$\end{document}</tex-math><mml:math id="M52"><mml:mrow><mml:mi>λ</mml:mi><mml:mo>=</mml:mo><mml:mn>525</mml:mn><mml:mspace width="0.333333em"/><mml:mtext>nm</mml:mtext></mml:mrow></mml:math><inline-graphic xlink:href="11548_2019_2053_Article_IEq24.gif"/></alternatives></inline-formula>, ingoing light intensity <inline-formula id="IEq25"><alternatives><tex-math id="M53">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$I_{{0}} = 26{,}000$$\end{document}</tex-math><mml:math id="M54"><mml:mrow><mml:msub><mml:mi>I</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mn>26</mml:mn><mml:mo>,</mml:mo><mml:mn>000</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="11548_2019_2053_Article_IEq25.gif"/></alternatives></inline-formula>, and image pixel size <inline-formula id="IEq26"><alternatives><tex-math id="M55">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\Delta {x} = 20\,\upmu \hbox {m}$$\end{document}</tex-math><mml:math id="M56"><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>x</mml:mi><mml:mo>=</mml:mo><mml:mn>20</mml:mn><mml:mspace width="0.166667em"/><mml:mi mathvariant="normal">μ</mml:mi><mml:mtext>m</mml:mtext></mml:mrow></mml:math><inline-graphic xlink:href="11548_2019_2053_Article_IEq26.gif"/></alternatives></inline-formula>.</p>
      <p id="Par34">Figure <xref rid="Fig5" ref-type="fig">5</xref>a shows the resulting fiber orientations as a vector field, overlaid with the original fiber model. In regions with straight fiber bundles, the fiber orientations are in good agreement with the underlying fiber structure. In crossing regions, however, some fiber orientations are misinterpreted. In region (3), where both crossing fiber bundles contain the same amount of fibers, the resulting vector field shows the average orientation of the two underlying fiber bundles (pink). If fiber tractography, algorithms were applied to the vector field, and the crossing fibers (<inline-formula id="IEq27"><alternatives><tex-math id="M57">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\times $$\end{document}</tex-math><mml:math id="M58"><mml:mo>×</mml:mo></mml:math><inline-graphic xlink:href="11548_2019_2053_Article_IEq27.gif"/></alternatives></inline-formula>) could be misinterpreted as kissing fibers (<inline-formula id="IEq28"><alternatives><tex-math id="M59">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$&gt;
&lt;$$\end{document}</tex-math><mml:math id="M60"><mml:mrow><mml:mo>&gt;</mml:mo><mml:mo>&lt;</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="11548_2019_2053_Article_IEq28.gif"/></alternatives></inline-formula>). In region (1), the resulting vector field is dominated by the orientation of the fiber bundle (green) that consists of three bundles (nos. 4, 5, and 6, see Fig. <xref rid="Fig4" ref-type="fig">4</xref>). The orientation of the other fiber bundles (purple) is not visible in the resulting vector field so that the crossing of the fiber bundles is not detected. In region (2), the three fiber bundles (4, 5, and 6) join each other. Bundles 4 and 5 (green) have similar orientations and are already indistinguishable when they merge with bundle 6 (red). The resulting orientation vectors of bundle 6 assimilate with the orientation vectors of the other two bundles. The original course of bundle 6 in the crossing regions is not visible in the resulting vector field.</p>
      <p id="Par35"><italic>Finite-Difference Time-Domain (FDTD) simulation </italic> The three selected regions of the <italic>Fiber Cup</italic> phantom in Fig. <xref rid="Fig5" ref-type="fig">5</xref>a were also studied with FDTD simulations to investigate the scattering of light. For this purpose, a volume of <inline-formula id="IEq29"><alternatives><tex-math id="M61">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$128 \times 128 \times 60\,\upmu \hbox {m}^3$$\end{document}</tex-math><mml:math id="M62"><mml:mrow><mml:mn>128</mml:mn><mml:mo>×</mml:mo><mml:mn>128</mml:mn><mml:mo>×</mml:mo><mml:mn>60</mml:mn><mml:mspace width="0.166667em"/><mml:mi mathvariant="normal">μ</mml:mi><mml:msup><mml:mtext>m</mml:mtext><mml:mn>3</mml:mn></mml:msup></mml:mrow></mml:math><inline-graphic xlink:href="11548_2019_2053_Article_IEq29.gif"/></alternatives></inline-formula> was selected in each region and the propagation of the light wave through the sample was simulated as described in the “Simulation methods” section. The simulations were performed for uniaxial perfectly matched layer absorbing boundaries with a thickness of <inline-formula id="IEq30"><alternatives><tex-math id="M63">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$1\,\upmu \hbox {m}$$\end{document}</tex-math><mml:math id="M64"><mml:mrow><mml:mn>1</mml:mn><mml:mspace width="0.166667em"/><mml:mi mathvariant="normal">μ</mml:mi><mml:mtext>m</mml:mtext></mml:mrow></mml:math><inline-graphic xlink:href="11548_2019_2053_Article_IEq30.gif"/></alternatives></inline-formula>, a Yee mesh size of 25 nm, a duration of 400 periods, a Courant factor of 0.8, and normally incident light with 550 nm wavelength (modeling the polarizing microscope) [<xref ref-type="bibr" rid="CR18">18</xref>, <xref ref-type="bibr" rid="CR19">19</xref>]. All tissue components of the sample (fibers and surrounding tissue) were modeled by dielectric materials with real refractive indices (neglecting absorption). Each fiber was modeled by an inner axon and a surrounding myelin sheath with two layers, as described by Menzel et al. [<xref ref-type="bibr" rid="CR18">18</xref>]. The simulations were performed on the supercomputer <italic>JURECA</italic> [<xref ref-type="bibr" rid="CR11">11</xref>] at Forschungszentrum Jülich GmbH, Germany. Figure <xref rid="Fig5" ref-type="fig">5</xref>b shows the resulting scattering patterns, i. e. the intensity per wave vector, for the three selected regions. The scattering patterns reveal the underlying fiber structure and crossing angles of the fiber bundles. The light is always scattered under angles perpendicular to the principal axis of the corresponding fiber bundle. For reference, the perpendicular axes are indicated by straight colored lines around the scattering patterns. (Colors were chosen according to the colors of the fiber bundles shown in Fig. <xref rid="Fig5" ref-type="fig">5</xref>a.) In contrast to <italic>simPLI</italic>, the FDTD simulations allow to resolve individual fiber orientations also in regions with crossing fibers. The determined angles correspond to the angles of the <italic>Fiber Cup</italic> phantom (cf. Figs.  <xref rid="Fig4" ref-type="fig">4</xref> and <xref rid="Fig5" ref-type="fig">5</xref>b). Bundles with a larger amount of fibers (regions (1), (2), in green) cause stronger scattering than bundles with a smaller amount of fibers.</p>
    </sec>
  </sec>
  <sec id="Sec10">
    <title>Discussion and conclusion</title>
    <p id="Par36">We have introduced the <italic>FAConstructor</italic> tool enabling the interactive generation of synthetic nerve fiber models both in an accurate and efficient way. The fast generation of many different fiber models is a prerequisite for imaging simulation tools to study physical effects in virtual brain tissue. Functionalities like modification of fiber objects (translation, rotation, scaling, filling), grouping of several fiber objects (e. g. fibers to a fiber bundle) and successive generation of building blocks (as groups) up to the final model allow a fast generation and easy (re)production of phantoms. By defining the radius as a function along the fibers, it is also possible to build multiple layers (e. g. myelin with nodes of Ranvier) around an axon.</p>
    <p id="Par37">Evaluating the performance of the developed tool shows that most processes scale almost linearly with the amount of data points used to describe the fiber models. When working with simple, unfilled objects, the program guarantees a smooth interaction proven by the performance measurements shown. Models with less than 1.6 million data points retain a frame rate of more than 30 frames per second. Assuming a constant diameter of nerve fibers in the human brain of <inline-formula id="IEq31"><alternatives><tex-math id="M65">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$0.5\,\upmu \hbox {m}$$\end{document}</tex-math><mml:math id="M66"><mml:mrow><mml:mn>0.5</mml:mn><mml:mspace width="0.166667em"/><mml:mi mathvariant="normal">μ</mml:mi><mml:mtext>m</mml:mtext></mml:mrow></mml:math><inline-graphic xlink:href="11548_2019_2053_Article_IEq31.gif"/></alternatives></inline-formula> [<xref ref-type="bibr" rid="CR12">12</xref>] and, for a high detailed model, a step size of about <inline-formula id="IEq32"><alternatives><tex-math id="M67">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$1\,\upmu \hbox {m}$$\end{document}</tex-math><mml:math id="M68"><mml:mrow><mml:mn>1</mml:mn><mml:mspace width="0.166667em"/><mml:mi mathvariant="normal">μ</mml:mi><mml:mtext>m</mml:mtext></mml:mrow></mml:math><inline-graphic xlink:href="11548_2019_2053_Article_IEq32.gif"/></alternatives></inline-formula>, the here used hardware could render a stable frame rate for a filled cubic volume of about <inline-formula id="IEq33"><alternatives><tex-math id="M69">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$80\,\upmu \hbox {m}^{3}$$\end{document}</tex-math><mml:math id="M70"><mml:mrow><mml:mn>80</mml:mn><mml:mspace width="0.166667em"/><mml:mi mathvariant="normal">μ</mml:mi><mml:msup><mml:mtext>m</mml:mtext><mml:mn>3</mml:mn></mml:msup></mml:mrow></mml:math><inline-graphic xlink:href="11548_2019_2053_Article_IEq33.gif"/></alternatives></inline-formula>. It is therefore also capable of visualizing a high detailed model for the FDTD simulation. For building larger models, the usage of hiding groups can improve the rendering temporarily, where the final model can still be rendered when necessary.</p>
    <p id="Par38">As the 3D-PLI simulations only model sections of brain tissue with <inline-formula id="IEq34"><alternatives><tex-math id="M71">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$60\,\upmu \hbox {m}$$\end{document}</tex-math><mml:math id="M72"><mml:mrow><mml:mn>60</mml:mn><mml:mspace width="0.166667em"/><mml:mi mathvariant="normal">μ</mml:mi><mml:mtext>m</mml:mtext></mml:mrow></mml:math><inline-graphic xlink:href="11548_2019_2053_Article_IEq34.gif"/></alternatives></inline-formula> thickness, more than 1.6 million data points are rarely necessary, which guarantees a stable and fluent workflow. For comparison, the newly generated <italic>Fiber Cup</italic> phantom contains 426,300 data points after filling and the original fiber bundle contains only 290 data points. This indicates that even large fiber models can be rendered on similar hardware. However, to create even more detailed and/or larger brain tissue models beyond pure white matter phantoms (e. g. cerebral cortex phantoms including astrocytes, glial cells, and neuropil), a supercomputing environment is required. First tests of the <italic>FAConstructor</italic> on one visualization node of the supercomputer <italic>JURECA</italic> [<xref ref-type="bibr" rid="CR11">11</xref>] at the Supercomputing Center at Forschungszentrum Jülich GmbH, Germany, showed promising performance. This aspect will be addressed in future studies.</p>
    <p id="Par39">The applicability of <italic>FAConstructor</italic> was demonstrated for two different simulation approaches using the example of the <italic>Fiber Cup</italic> phantom. The generation of the phantom took around ten minutes for an instructed user, indicating the user-friendly environment of <italic>FAConstructor</italic>. Since the tool can be used to generate large-scale fiber models with small-scale detail, it is suited for both large-scale <italic>simPLI</italic> and small-scale FDTD simulations. It will help to generate the models quickly and, if necessary, to modify them accordingly so that the underlying fiber structure can be tested from experimental data in an appropriate time.</p>
    <p id="Par40">In order to enable faster and more intuitive changes to the models, mouse interactions with the scene need to be implemented. This would allow more intuitive modification of fiber objects, such as moving fiber points or changing entire objects or groups. Another improvement would be the visualization of the 3D-PLI data or more general gray-scale and RGB images, or three-dimensional vector data. By this means, it would be possible to visualize the generated structures with the experimental results and the resulting simulation data. Therefore, not only the construction process of the models would be improved, but also the interpretation and analysis process of the simulation results in relation to the models used. A future implementation could also provide an interface for plug-ins that would allow algorithms, analyses, or even the simulation process to be run. Since a model without colliding fibers is very important for 3D-PLI simulations, the colliding solving process could be executed and visualized step-by-step.</p>
    <p id="Par41">Due to the general definition of fibers as geometric objects defined by points and radii, other neuroimaging simulation techniques like dMRI are also capable of using the models generated by <italic>FAConstructor</italic>. Since the technological and analytical methods in dMRI improve continuously, highly detailed microstructured models are required for simulations to address the impact of underlying neuronal components on the diffusion behavior [<xref ref-type="bibr" rid="CR9">9</xref>].</p>
    <p id="Par42">In conclusion, we have implemented a user-friendly and efficient tool that enables a fast generation of complex and realistic synthetic nerve fiber configurations (i. e. numerical brain tissue phantoms) ideally suited for the simulation of neuroimaging techniques like 3D polarized light imaging. The generated fiber bundles can be visualized simultaneously and edited interactively. This ultimately enables the production of application-specific well-defined ground truth datasets.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Electronic supplementary material</title>
    <sec id="Sec11">
      <p>Below is the link to the electronic supplementary material.
<supplementary-material content-type="local-data" id="MOESM1"><media xlink:href="11548_2019_2053_MOESM1_ESM.mp4"><caption><p>Supplementary material 1 (mp4 92543 KB)</p></caption></media></supplementary-material></p>
    </sec>
  </sec>
</body>
<back>
  <fn-group>
    <fn>
      <p>
        <bold>Publisher's Note</bold>
      </p>
      <p>Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p>
    </fn>
    <fn>
      <p>Jan André Reuter and Felix Matuschke have contributed equally to this work.</p>
    </fn>
  </fn-group>
  <ack>
    <title>Acknowledgements</title>
    <p>This study was funded by the European Union’s Horizon 2020 Research and Innovation Program under Grant Agreement No. 785907 (HBP SGA2). We gratefully acknowledge the computing time granted through JARA-HPC on the supercomputer JURECA [<xref ref-type="bibr" rid="CR11">11</xref>] at Forschungszentrum Jülich. This open source software code was developed in part or in whole in the Human Brain Project, funded from the European Union’s Horizon 2020 Framework Program for Research and Innovation under the Specific Grant Agreement No. 785907 (HBP SGA2).</p>
  </ack>
  <notes notes-type="ethics">
    <title>Compliance with ethical standards</title>
    <notes notes-type="COI-statement">
      <title>Conflict of interest</title>
      <p id="Par44">The authors declare that they have no conflict of interest.</p>
    </notes>
    <notes>
      <title>Ethical approval</title>
      <p id="Par45">This article does not contain any studies with human participants or animals performed by any of the authors.</p>
    </notes>
  </notes>
  <ref-list id="Bib1">
    <title>References</title>
    <ref id="CR1">
      <label>1.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Axer</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Amunts</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Grässel</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Palm</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Dammers</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Axer</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Pietrzyk</surname>
            <given-names>U</given-names>
          </name>
          <name>
            <surname>Zilles</surname>
            <given-names>K</given-names>
          </name>
        </person-group>
        <article-title>A novel approach to the human connectome: ultra-high resolution mapping of fiber tracts in the brain</article-title>
        <source>NeuroImage</source>
        <year>2011</year>
        <volume>54</volume>
        <issue>2</issue>
        <fpage>1091</fpage>
        <lpage>1101</lpage>
        <pub-id pub-id-type="doi">10.1016/j.neuroimage.2010.08.075</pub-id>
        <pub-id pub-id-type="pmid">20832489</pub-id>
      </element-citation>
    </ref>
    <ref id="CR2">
      <label>2.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Axer</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Grässel</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Kleiner</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Dammers</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Dickscheid</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Reckfort</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Hütz</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Eiben</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Pietrzyk</surname>
            <given-names>U</given-names>
          </name>
          <name>
            <surname>Zilles</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Amunts</surname>
            <given-names>K</given-names>
          </name>
        </person-group>
        <article-title>High-resolution fiber tract reconstruction in the human brain by means of three-dimensional polarized light imaging</article-title>
        <source>Front Neuroinform</source>
        <year>2011</year>
        <volume>5</volume>
        <issue>34</issue>
        <fpage>1</fpage>
        <lpage>13</lpage>
        <pub-id pub-id-type="pmid">21472085</pub-id>
      </element-citation>
    </ref>
    <ref id="CR3">
      <label>3.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Caspers</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Axer</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>Decoding the microstructural correlate of diffusion MRI</article-title>
        <source>NMR Biomed</source>
        <year>2017</year>
        <volume>0</volume>
        <issue>0</issue>
        <fpage>e3779</fpage>
      </element-citation>
    </ref>
    <ref id="CR4">
      <label>4.</label>
      <mixed-citation publication-type="other">Company TQ (2018) About Qt. <ext-link ext-link-type="uri" xlink:href="https://wiki.qt.io/About_Qt">https://wiki.qt.io/About_Qt</ext-link></mixed-citation>
    </ref>
    <ref id="CR5">
      <label>5.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Dai</surname>
            <given-names>JS</given-names>
          </name>
        </person-group>
        <article-title>Euler-Rodrigues formula variations, quaternion conjugation and intrinsic connections</article-title>
        <source>Mech Mach Theory</source>
        <year>2015</year>
        <volume>92</volume>
        <fpage>144</fpage>
        <lpage>152</lpage>
        <pub-id pub-id-type="doi">10.1016/j.mechmachtheory.2015.03.004</pub-id>
      </element-citation>
    </ref>
    <ref id="CR6">
      <label>6.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Dohmen</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Menzel</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Wiese</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Reckfort</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Hanke</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Pietrzyk</surname>
            <given-names>U</given-names>
          </name>
          <name>
            <surname>Zilles</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Amunts</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Axer</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>Understanding fiber mixture by simulation in 3D Polarized Light Imaging</article-title>
        <source>NeuroImage</source>
        <year>2015</year>
        <volume>111</volume>
        <fpage>464</fpage>
        <lpage>475</lpage>
        <pub-id pub-id-type="doi">10.1016/j.neuroimage.2015.02.020</pub-id>
        <pub-id pub-id-type="pmid">25700950</pub-id>
      </element-citation>
    </ref>
    <ref id="CR7">
      <label>7.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Fillard</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Descoteaux</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Goh</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Gouttard</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Jeurissen</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Malcolm</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Ramirez-Manzanares</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Reisert</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Sakaie</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Tensaouti</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Yo</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Mangin</surname>
            <given-names>JF</given-names>
          </name>
          <name>
            <surname>Poupon</surname>
            <given-names>C</given-names>
          </name>
        </person-group>
        <article-title>Quantitative evaluation of 10 tractography algorithms on a realistic diffusion MR phantom</article-title>
        <source>NeuroImage</source>
        <year>2011</year>
        <volume>56</volume>
        <issue>1</issue>
        <fpage>220</fpage>
        <lpage>234</lpage>
        <pub-id pub-id-type="doi">10.1016/j.neuroimage.2011.01.032</pub-id>
        <pub-id pub-id-type="pmid">21256221</pub-id>
      </element-citation>
    </ref>
    <ref id="CR8">
      <label>8.</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Foley</surname>
            <given-names>JD</given-names>
          </name>
          <name>
            <surname>Van</surname>
            <given-names>FD</given-names>
          </name>
          <name>
            <surname>Van Dam</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Feiner</surname>
            <given-names>SK</given-names>
          </name>
          <name>
            <surname>Hughes</surname>
            <given-names>JF</given-names>
          </name>
          <name>
            <surname>ANGEL</surname>
            <given-names>E</given-names>
          </name>
        </person-group>
        <source>Computer graphics: principles and practice</source>
        <year>1996</year>
        <publisher-loc>Boston</publisher-loc>
        <publisher-name>Addison-Wesley</publisher-name>
      </element-citation>
    </ref>
    <ref id="CR9">
      <label>9.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ginsburger</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Poupon</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Beaujoin</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Estournet</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Matuschke</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Mangin</surname>
            <given-names>JF</given-names>
          </name>
          <name>
            <surname>Axer</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Poupon</surname>
            <given-names>C</given-names>
          </name>
        </person-group>
        <article-title>Improving the realism of white matter numerical phantoms: a step toward a better understanding of the influence of structural disorders in diffusion MRI</article-title>
        <source>Front Phys</source>
        <year>2018</year>
        <volume>6</volume>
        <fpage>12</fpage>
        <pub-id pub-id-type="doi">10.3389/fphy.2018.00012</pub-id>
      </element-citation>
    </ref>
    <ref id="CR10">
      <label>10.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Jeurissen</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Leemans</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Tournier</surname>
            <given-names>JD</given-names>
          </name>
          <name>
            <surname>Jones</surname>
            <given-names>DK</given-names>
          </name>
          <name>
            <surname>Sijbers</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>Investigating the prevalence of complex fiber configurations in white matter tissue with diffusion magnetic resonance imaging</article-title>
        <source>Hum Brain Mapp</source>
        <year>2013</year>
        <volume>34</volume>
        <issue>11</issue>
        <fpage>2747</fpage>
        <lpage>66</lpage>
        <pub-id pub-id-type="doi">10.1002/hbm.22099</pub-id>
        <pub-id pub-id-type="pmid">22611035</pub-id>
      </element-citation>
    </ref>
    <ref id="CR11">
      <label>11.</label>
      <mixed-citation publication-type="other">Jülich Supercomputing Centre (2016) JURECA: General-purpose supercomputer at Jülich Supercomputing Centre. J Large Scale Res Facil 2:A62</mixed-citation>
    </ref>
    <ref id="CR12">
      <label>12.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Liewald</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Miller</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Logothetis</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Wagner</surname>
            <given-names>HJ</given-names>
          </name>
          <name>
            <surname>Schüz</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>Distribution of axon diameters in cortical white matter: an electron-microscopic study on three human brains and a macaque</article-title>
        <source>Biol Cybern</source>
        <year>2014</year>
        <volume>108</volume>
        <issue>5</issue>
        <fpage>541</fpage>
        <lpage>557</lpage>
        <pub-id pub-id-type="doi">10.1007/s00422-014-0626-2</pub-id>
        <pub-id pub-id-type="pmid">25142940</pub-id>
      </element-citation>
    </ref>
    <ref id="CR13">
      <label>13.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Magnain</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Augustinack</surname>
            <given-names>JC</given-names>
          </name>
          <name>
            <surname>Tirrell</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Fogarty</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Frosch</surname>
            <given-names>MP</given-names>
          </name>
          <name>
            <surname>Boas</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Fischl</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Rockland</surname>
            <given-names>KS</given-names>
          </name>
        </person-group>
        <article-title>Colocalization of neurons in optical coherence microscopy and Nissl-stained histology in Brodmann’s area 32 and area 21</article-title>
        <source>Brain Struct Funct</source>
        <year>2019</year>
        <volume>224</volume>
        <issue>1</issue>
        <fpage>351</fpage>
        <lpage>362</lpage>
        <pub-id pub-id-type="doi">10.1007/s00429-018-1777-z</pub-id>
        <pub-id pub-id-type="pmid">30328512</pub-id>
      </element-citation>
    </ref>
    <ref id="CR14">
      <label>14.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Maier-Hein</surname>
            <given-names>KH</given-names>
          </name>
          <name>
            <surname>Neher</surname>
            <given-names>PF</given-names>
          </name>
          <name>
            <surname>Houde</surname>
            <given-names>JC</given-names>
          </name>
          <name>
            <surname>Côté</surname>
            <given-names>MA</given-names>
          </name>
          <name>
            <surname>Garyfallidis</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Zhong</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Chamberland</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Yeh</surname>
            <given-names>FC</given-names>
          </name>
          <name>
            <surname>Lin</surname>
            <given-names>YC</given-names>
          </name>
          <name>
            <surname>Ji</surname>
            <given-names>Q</given-names>
          </name>
          <name>
            <surname>Reddick</surname>
            <given-names>WE</given-names>
          </name>
          <name>
            <surname>Glass</surname>
            <given-names>JO</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>DQ</given-names>
          </name>
          <name>
            <surname>Feng</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Gao</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Wu</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Ma</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Renjie</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>Q</given-names>
          </name>
          <name>
            <surname>Westin</surname>
            <given-names>CF</given-names>
          </name>
          <name>
            <surname>Deslauriers-Gauthier</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>González</surname>
            <given-names>JOO</given-names>
          </name>
          <name>
            <surname>Paquette</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>St-Jean</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Girard</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Rheault</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Sidhu</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Tax</surname>
            <given-names>CMW</given-names>
          </name>
          <name>
            <surname>Guo</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Mesri</surname>
            <given-names>HY</given-names>
          </name>
          <name>
            <surname>Dávid</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Froeling</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Heemskerk</surname>
            <given-names>AM</given-names>
          </name>
          <name>
            <surname>Leemans</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Boré</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Pinsard</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Bedetti</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Desrosiers</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Brambati</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Doyon</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Sarica</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Vasta</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Cerasa</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Quattrone</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Yeatman</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Khan</surname>
            <given-names>AR</given-names>
          </name>
          <name>
            <surname>Hodges</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Alexander</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Romascano</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Barakovic</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Auría</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Esteban</surname>
            <given-names>O</given-names>
          </name>
          <name>
            <surname>Lemkaddem</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Thiran</surname>
            <given-names>JP</given-names>
          </name>
          <name>
            <surname>Cetingul</surname>
            <given-names>HE</given-names>
          </name>
          <name>
            <surname>Odry</surname>
            <given-names>BL</given-names>
          </name>
          <name>
            <surname>Mailhe</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Nadar</surname>
            <given-names>MS</given-names>
          </name>
          <name>
            <surname>Pizzagalli</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Prasad</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Villalon-Reina</surname>
            <given-names>JE</given-names>
          </name>
          <name>
            <surname>Galvis</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Thompson</surname>
            <given-names>PM</given-names>
          </name>
          <name>
            <surname>Requejo</surname>
            <given-names>FDS</given-names>
          </name>
          <name>
            <surname>Laguna</surname>
            <given-names>PL</given-names>
          </name>
          <name>
            <surname>Lacerda</surname>
            <given-names>LM</given-names>
          </name>
          <name>
            <surname>Barrett</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Dell’Acqua</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Catani</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Petit</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Caruyer</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Daducci</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Dyrby</surname>
            <given-names>TB</given-names>
          </name>
          <name>
            <surname>Holland-Letz</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Hilgetag</surname>
            <given-names>CC</given-names>
          </name>
          <name>
            <surname>Stieltjes</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Descoteaux</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>The challenge of mapping the human connectome based on diffusion tractography</article-title>
        <source>Nat Commun</source>
        <year>2017</year>
        <volume>8</volume>
        <issue>1</issue>
        <fpage>1349</fpage>
        <pub-id pub-id-type="doi">10.1038/s41467-017-01285-x</pub-id>
        <pub-id pub-id-type="pmid">29116093</pub-id>
      </element-citation>
    </ref>
    <ref id="CR15">
      <label>15.</label>
      <mixed-citation publication-type="other">Matuschke F, Ginsburger K, Poupon C, Amunts K, Axer M (2019) Dense fiber modeling for 3D-Polarized Light Imaging simulations. <ext-link ext-link-type="uri" xlink:href="http://arxiv.org/abs/1901.10284">arXiv:1901.10284</ext-link></mixed-citation>
    </ref>
    <ref id="CR16">
      <label>16.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Menzel</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Michielsen</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>De Raedt</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Reckfort</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Amunts</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Axer</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>A Jones matrix formalism for simulating three-dimensional polarized light imaging of brain tissue</article-title>
        <source>J R Soc Interface</source>
        <year>2015</year>
        <volume>12</volume>
        <fpage>20150734</fpage>
        <pub-id pub-id-type="doi">10.1098/rsif.2015.0734</pub-id>
        <pub-id pub-id-type="pmid">26446561</pub-id>
      </element-citation>
    </ref>
    <ref id="CR17">
      <label>17.</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Menzel</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Axer</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>De Raedt</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Michielsen</surname>
            <given-names>K</given-names>
          </name>
        </person-group>
        <person-group person-group-type="editor">
          <name>
            <surname>Amunts</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Grandinetti</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Lippert</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Petkov</surname>
            <given-names>N</given-names>
          </name>
        </person-group>
        <article-title>Finite-difference time-domain simulation for three-dimensional polarized light imaging</article-title>
        <source>Brain-inspired computing</source>
        <year>2016</year>
        <publisher-loc>Cham</publisher-loc>
        <publisher-name>Springer</publisher-name>
        <fpage>73</fpage>
        <lpage>85</lpage>
      </element-citation>
    </ref>
    <ref id="CR18">
      <label>18.</label>
      <mixed-citation publication-type="other">Menzel M, Axer M, De Raedt H, Costantini I, Silvestri L, Pavone FS, Amunts K, Michielsen K (2019) Finite-difference time-domain simulations of transmission microscopy enable a better interpretation of 3D nerve fiber architectures in the brain. <ext-link ext-link-type="uri" xlink:href="http://arxiv.org/abs/1806.07157">arXiv:1806.07157</ext-link></mixed-citation>
    </ref>
    <ref id="CR19">
      <label>19.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Menzel</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Axer</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Amunts</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>De Raedt</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Michielsen</surname>
            <given-names>K</given-names>
          </name>
        </person-group>
        <article-title>Diattenuation Imaging reveals different brain tissue properties</article-title>
        <source>Sci Rep</source>
        <year>2019</year>
        <volume>9</volume>
        <fpage>1939</fpage>
        <pub-id pub-id-type="doi">10.1038/s41598-019-38506-w</pub-id>
        <pub-id pub-id-type="pmid">30760789</pub-id>
      </element-citation>
    </ref>
    <ref id="CR20">
      <label>20.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Michielsen</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>De Raedt</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Stavenga</surname>
            <given-names>DG</given-names>
          </name>
        </person-group>
        <article-title>Reflectivity of the gyroid biophotonic crystals in the ventral wing scales of the Green Hairstreak butterfly, <italic>Callophrys rubi</italic></article-title>
        <source>J R Soc Interface</source>
        <year>2010</year>
        <volume>7</volume>
        <issue>46</issue>
        <fpage>765</fpage>
        <lpage>771</lpage>
        <pub-id pub-id-type="doi">10.1098/rsif.2009.0352</pub-id>
        <pub-id pub-id-type="pmid">19828506</pub-id>
      </element-citation>
    </ref>
    <ref id="CR21">
      <label>21.</label>
      <mixed-citation publication-type="other">Müller H (1943) Memorandum on the polarization optics of the photoelastic shutter. Report No 2 of the OSRD project OEMsr-576</mixed-citation>
    </ref>
    <ref id="CR22">
      <label>22.</label>
      <mixed-citation publication-type="other">OpenMP Architecture Review Board (2015) OpenMP application program interface version 3.0. <ext-link ext-link-type="uri" xlink:href="https://www.openmp.org/wp-content/uploads/openmp-4.5.pdf">https://www.openmp.org/wp-content/uploads/openmp-4.5.pdf</ext-link></mixed-citation>
    </ref>
    <ref id="CR23">
      <label>23.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Schmitz</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Muenzing</surname>
            <given-names>SEA</given-names>
          </name>
          <name>
            <surname>Schober</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Schubert</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Minnerop</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Lippert</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Amunts</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Axer</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>Derivation of fiber orientations from oblique views through human brain sections in 3D-polarized light imaging</article-title>
        <source>Front Neuroanat</source>
        <year>2018</year>
        <volume>12</volume>
        <fpage>75</fpage>
        <pub-id pub-id-type="doi">10.3389/fnana.2018.00075</pub-id>
        <pub-id pub-id-type="pmid">30323745</pub-id>
      </element-citation>
    </ref>
    <ref id="CR24">
      <label>24.</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Schubert</surname>
            <given-names>Nicole</given-names>
          </name>
          <name>
            <surname>Axer</surname>
            <given-names>Markus</given-names>
          </name>
          <name>
            <surname>Pietrzyk</surname>
            <given-names>Uwe</given-names>
          </name>
          <name>
            <surname>Amunts</surname>
            <given-names>Katrin</given-names>
          </name>
        </person-group>
        <article-title>3D Polarized Light Imaging Portrayed: Visualization of Fiber Architecture Derived from 3D-PLI</article-title>
        <source>High-Resolution Neuroimaging - Basic Physical Principles and Clinical Applications</source>
        <year>2018</year>
      </element-citation>
    </ref>
    <ref id="CR25">
      <label>25.</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Shreiner</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Sellers</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Kessenich</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Licea-Kane</surname>
            <given-names>B</given-names>
          </name>
        </person-group>
        <source>OpenGL programming guide: The Official guide to learning OpenGL, version 4.3</source>
        <year>2013</year>
        <publisher-loc>Boston</publisher-loc>
        <publisher-name>Addison-Wesley</publisher-name>
      </element-citation>
    </ref>
    <ref id="CR26">
      <label>26.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Silvestri</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Costantini</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Sacconi</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Pavone</surname>
            <given-names>FS</given-names>
          </name>
        </person-group>
        <article-title>Clearing of fixed tissue: a review from a microscopist’s perspective</article-title>
        <source>J Biomed Opt</source>
        <year>2016</year>
        <volume>21</volume>
        <issue>8</issue>
        <fpage>081205</fpage>
        <pub-id pub-id-type="doi">10.1117/1.JBO.21.8.081205</pub-id>
        <pub-id pub-id-type="pmid">27020691</pub-id>
      </element-citation>
    </ref>
    <ref id="CR27">
      <label>27.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wang</surname>
            <given-names>Hui</given-names>
          </name>
          <name>
            <surname>Akkin</surname>
            <given-names>Taner</given-names>
          </name>
          <name>
            <surname>Magnain</surname>
            <given-names>Caroline</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>Ruopeng</given-names>
          </name>
          <name>
            <surname>Dubb</surname>
            <given-names>Jay</given-names>
          </name>
          <name>
            <surname>Kostis</surname>
            <given-names>William J</given-names>
          </name>
          <name>
            <surname>Yaseen</surname>
            <given-names>Mohammad A</given-names>
          </name>
          <name>
            <surname>Cramer</surname>
            <given-names>Avilash</given-names>
          </name>
          <name>
            <surname>Sakadžić</surname>
            <given-names>Sava</given-names>
          </name>
          <name>
            <surname>Boas</surname>
            <given-names>David</given-names>
          </name>
        </person-group>
        <article-title>Polarization sensitive optical coherence microscopy for brain imaging</article-title>
        <source>Optics Letters</source>
        <year>2016</year>
        <volume>41</volume>
        <issue>10</issue>
        <fpage>2213</fpage>
        <pub-id pub-id-type="doi">10.1364/OL.41.002213</pub-id>
        <pub-id pub-id-type="pmid">27176965</pub-id>
      </element-citation>
    </ref>
    <ref id="CR28">
      <label>28.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wilts</surname>
            <given-names>BD</given-names>
          </name>
          <name>
            <surname>Michielsen</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>De Raedt</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Stavenga</surname>
            <given-names>DG</given-names>
          </name>
        </person-group>
        <article-title>Sparkling feather reflections of a bird-of-paradise explained by finite-difference time-domain modeling</article-title>
        <source>PNAS</source>
        <year>2014</year>
        <volume>111</volume>
        <issue>12</issue>
        <fpage>4363</fpage>
        <lpage>4368</lpage>
        <pub-id pub-id-type="doi">10.1073/pnas.1323611111</pub-id>
        <pub-id pub-id-type="pmid">24591592</pub-id>
      </element-citation>
    </ref>
    <ref id="CR29">
      <label>29.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wu</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Miller</surname>
            <given-names>KL</given-names>
          </name>
        </person-group>
        <article-title>Image formation in diffusion MRI: a review of recent technical developments</article-title>
        <source>J Magn Reson Imaging</source>
        <year>2017</year>
        <volume>46</volume>
        <issue>3</issue>
        <fpage>646</fpage>
        <lpage>662</lpage>
        <pub-id pub-id-type="doi">10.1002/jmri.25664</pub-id>
        <pub-id pub-id-type="pmid">28194821</pub-id>
      </element-citation>
    </ref>
    <ref id="CR30">
      <label>30.</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Zilles</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Palomero-Gallagher</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Gräßel</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Schlömer</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Cremer</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Woods</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Amunts</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Axer</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <source>High-resolution fiber and fiber tract imaging using polarized light microscopy in the human, monkey, rat, and mouse brain</source>
        <year>2015</year>
        <publisher-loc>London</publisher-loc>
        <publisher-name>Elsevier</publisher-name>
        <fpage>369</fpage>
        <lpage>389</lpage>
      </element-citation>
    </ref>
  </ref-list>
</back>
