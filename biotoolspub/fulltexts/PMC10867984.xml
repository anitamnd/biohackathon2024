<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName A++V2.4.dtd?>
<?SourceDTD.Version 2.4?>
<?ConverterInfo.XSLTName springer2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">BMC Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">BMC Bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>BMC Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="epub">1471-2105</issn>
    <publisher>
      <publisher-name>BioMed Central</publisher-name>
      <publisher-loc>London</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">10867984</article-id>
    <article-id pub-id-type="pmid">38355413</article-id>
    <article-id pub-id-type="publisher-id">5670</article-id>
    <article-id pub-id-type="doi">10.1186/s12859-024-05670-4</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Software</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Torch-eCpG: a fast and scalable eQTM mapper for thousands of molecular phenotypes with graphical processing units</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author" corresp="yes">
        <name>
          <surname>Kober</surname>
          <given-names>Kord M.</given-names>
        </name>
        <address>
          <email>kord.kober@ucsf.edu</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff2">2</xref>
        <xref ref-type="aff" rid="Aff3">3</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Berger</surname>
          <given-names>Liam</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Roy</surname>
          <given-names>Ritu</given-names>
        </name>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Olshen</surname>
          <given-names>Adam</given-names>
        </name>
        <xref ref-type="aff" rid="Aff2">2</xref>
        <xref ref-type="aff" rid="Aff3">3</xref>
      </contrib>
      <aff id="Aff1"><label>1</label><institution-wrap><institution-id institution-id-type="ROR">https://ror.org/043mz5j54</institution-id><institution-id institution-id-type="GRID">grid.266102.1</institution-id><institution-id institution-id-type="ISNI">0000 0001 2297 6811</institution-id><institution>School of Nursing, </institution><institution>University of California San Francisco, </institution></institution-wrap>San Francisco, CA USA </aff>
      <aff id="Aff2"><label>2</label><institution-wrap><institution-id institution-id-type="GRID">grid.266102.1</institution-id><institution-id institution-id-type="ISNI">0000 0001 2297 6811</institution-id><institution>Helen Diller Family Comprehensive Cancer Center, </institution><institution>University of California San Francisco, </institution></institution-wrap>San Francisco, CA USA </aff>
      <aff id="Aff3"><label>3</label><institution-wrap><institution-id institution-id-type="ROR">https://ror.org/043mz5j54</institution-id><institution-id institution-id-type="GRID">grid.266102.1</institution-id><institution-id institution-id-type="ISNI">0000 0001 2297 6811</institution-id><institution>Bakar Computational Health Sciences Institute, </institution><institution>University of California San Francisco, </institution></institution-wrap>San Francisco, CA USA </aff>
    </contrib-group>
    <pub-date pub-type="epub">
      <day>14</day>
      <month>2</month>
      <year>2024</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>14</day>
      <month>2</month>
      <year>2024</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2024</year>
    </pub-date>
    <volume>25</volume>
    <elocation-id>71</elocation-id>
    <history>
      <date date-type="received">
        <day>8</day>
        <month>3</month>
        <year>2023</year>
      </date>
      <date date-type="accepted">
        <day>22</day>
        <month>1</month>
        <year>2024</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2024</copyright-statement>
      <license>
        <ali:license_ref specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p><bold>Open Access</bold> This article is licensed under a Creative Commons Attribution 4.0 International License, which permits use, sharing, adaptation, distribution and reproduction in any medium or format, as long as you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons licence, and indicate if changes were made. The images or other third party material in this article are included in the article's Creative Commons licence, unless indicated otherwise in a credit line to the material. If material is not included in the article's Creative Commons licence and your intended use is not permitted by statutory regulation or exceeds the permitted use, you will need to obtain permission directly from the copyright holder. To view a copy of this licence, visit <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>. The Creative Commons Public Domain Dedication waiver (<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/publicdomain/zero/1.0/">http://creativecommons.org/publicdomain/zero/1.0/</ext-link>) applies to the data made available in this article, unless otherwise stated in a credit line to the data.</license-p>
      </license>
    </permissions>
    <abstract id="Abs1">
      <sec>
        <title>Background</title>
        <p id="Par1">Gene expression may be regulated by the DNA methylation of regulatory elements in <italic>cis</italic>, <italic>distal</italic>, and <italic>trans</italic> regions. One method to evaluate the relationship between DNA methylation and gene expression is the mapping of expression quantitative trait methylation (eQTM) loci (also called expression associated CpG loci, eCpG). However, no open-source tools are available to provide eQTM mapping. In addition, eQTM mapping can involve a large number of comparisons which may prevent the analyses due to limitations of computational resources. Here, we describe Torch-eCpG, an open-source tool to perform eQTM mapping that includes an optimized implementation that can use the graphical processing unit (GPU) to reduce runtime.</p>
      </sec>
      <sec>
        <title>Results</title>
        <p id="Par2">We demonstrate the analyses using the tool are reproducible, up to 18 × faster using the GPU, and scale linearly with increasing methylation loci.</p>
      </sec>
      <sec>
        <title>Conclusions</title>
        <p id="Par3">Torch-eCpG is a fast, reliable, and scalable tool to perform eQTM mapping. Source code for Torch-eCpG is available at <ext-link ext-link-type="uri" xlink:href="https://github.com/kordk/torch-ecpg">https://github.com/kordk/torch-ecpg</ext-link>.</p>
      </sec>
    </abstract>
    <kwd-group xml:lang="en">
      <title>Keywords</title>
      <kwd>DNA methylation</kwd>
      <kwd>Gene expression</kwd>
      <kwd>Transcriptional regulation</kwd>
      <kwd>Expression quantitative trait methylation</kwd>
      <kwd>eQTM</kwd>
      <kwd>eCpG</kwd>
      <kwd>GPU</kwd>
      <kwd>Tensor</kwd>
    </kwd-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100000054</institution-id>
            <institution>National Cancer Institute</institution>
          </institution-wrap>
        </funding-source>
        <award-id>CA233774</award-id>
        <award-id>CA082103</award-id>
        <principal-award-recipient>
          <name>
            <surname>Kober</surname>
            <given-names>Kord M.</given-names>
          </name>
          <name>
            <surname>Olshen</surname>
            <given-names>Adam</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
    </funding-group>
    <custom-meta-group>
      <custom-meta>
        <meta-name>issue-copyright-statement</meta-name>
        <meta-value>© BioMed Central Ltd., part of Springer Nature 2024</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec id="Sec1">
    <title>Background</title>
    <p id="Par17">Gene expression is regulated, in part, by epigenetic mechanisms. A major unanswered question in genomics research is the functional contribution of epigenetic variation on gene expression [<xref ref-type="bibr" rid="CR1">1</xref>, <xref ref-type="bibr" rid="CR2">2</xref>]. One method to evaluate for the potential functional effect of a methylation variation is to test for an association between levels of methylation and gene expression from the same samples. These expression-associated quantitative trait methylation (eQTM) loci may contribute to the regulation of gene expression (also called expression associated CpG loci, eCpG). These associations may be local (e.g., methylation located in the promoter region of a gene) or remote (e.g. methylation loci in a distant enhancer regions of a gene or on a different chromosome). There is growing interest in the integration of these data modalities and evaluating for eQTMs. For example, in terms of clinical research, recent studies have identified eQTMs from a variety of tissue types and outcomes [<xref ref-type="bibr" rid="CR3">3</xref>–<xref ref-type="bibr" rid="CR7">7</xref>].</p>
    <p id="Par18">Recent advances in high throughput molecular methods allow for the collection of complementary methylation and gene expression data from the same sample in large numbers. Although an increasing number of recent studies have provided eQTM datasets [<xref ref-type="bibr" rid="CR3">3</xref>, <xref ref-type="bibr" rid="CR8">8</xref>], there are no open-source tools currently available to investigators to implement these analyses on their own.</p>
    <p id="Par19">Given the increase in the availability of complementary datasets and the biological utility of identifying eQTMs, analytic tools must be made available, free to use, and able to scale to handle thousands to millions of samples (e.g., patients or single cells). Current methylation array datasets provide hundreds of thousands of loci (e.g., Infinium MethylationEPIC, Illumina, San Diego, CA) and RNA-sequencing and microarray methods provide expression levels for tens of thousands of genes. An exhaustive evaluation of these datasets would result in tens of billions of tests for hundreds or thousands of samples, quickly outreaching the computing capacity of a desktop computer and requiring larger workstations, clusters, or cloud computing [<xref ref-type="bibr" rid="CR9">9</xref>]. Future datasets will likely include more loci for evaluation and larger sample sizes. This need for computational resources will also require improvements in efficiency. Graphical processing units (GPUs) have provided major improvements in computation efficiency (i.e., runtime) for many bioinformatic software tools [<xref ref-type="bibr" rid="CR10">10</xref>]. Readily available open source libraries implement numerous general-purpose methods and mathematical primitives that allow for major improvements in computational efficiency at relatively lower costs as compared to CPUs [<xref ref-type="bibr" rid="CR11">11</xref>].</p>
    <p id="Par20">Given the analytic utility of evaluating for eQTMs to identify relationships between gene expression and epigenetic changes, a lack of an available open-source tool to implement an eQTM analysis, and the performance benefits of utilizing a GPU, the objectives of this project were to develop an open source, general-use tool for eQTM mapping and evaluate for performance increases of a GPU implementation. Here, we present the Torch-eCpG tool (tecpg).</p>
  </sec>
  <sec id="Sec2">
    <title>Implementation</title>
    <sec id="Sec3">
      <title>Association analyses</title>
      <p id="Par21">Two methods are available to test for the associations between CpG methylation and gene expression (eCpGs). First, a Pearson correlation can be computed between the methylation level and gene expression level. Second, a multivariate linear regression (MLR) method can model the relationship between gene expression and methylation level while including while adjusting for covariates (e.g., age, batch, cell type composition, population structure). Although more complex mapping approaches are available [<xref ref-type="bibr" rid="CR3">3</xref>], this approach is commonly used and the methods are easily accessible [<xref ref-type="bibr" rid="CR4">4</xref>, <xref ref-type="bibr" rid="CR8">8</xref>, <xref ref-type="bibr" rid="CR12">12</xref>]. Future versions of the tool may include additional mapping approaches. We tested for an association between methylation at CpG <italic>j</italic> and the expression level of transcript <italic>k</italic>, by fitting the model<disp-formula id="Equ1"><label>1</label><alternatives><tex-math id="M1">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$y_{k} = M_{j} a_{jk} + Xb_{jk} ,\;\; \, j = 1,..,n,\;\;k = 1,..,m$$\end{document}</tex-math><mml:math id="M2" display="block"><mml:mrow><mml:msub><mml:mi>y</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>M</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:msub><mml:mi>a</mml:mi><mml:mrow><mml:mi mathvariant="italic">jk</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mi>X</mml:mi><mml:msub><mml:mi>b</mml:mi><mml:mrow><mml:mi mathvariant="italic">jk</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mspace width="0.277778em"/><mml:mspace width="0.277778em"/><mml:mspace width="0.166667em"/><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mo>,</mml:mo><mml:mi>n</mml:mi><mml:mo>,</mml:mo><mml:mspace width="0.277778em"/><mml:mspace width="0.277778em"/><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mo>,</mml:mo><mml:mi>m</mml:mi></mml:mrow></mml:math><graphic xlink:href="12859_2024_5670_Article_Equ1.gif" position="anchor"/></alternatives></disp-formula>where <italic>y</italic><sub><italic>k</italic></sub> is a vector of log expression levels at gene <italic>k</italic> with length <italic>m</italic>, <italic>M</italic><sub><italic>j</italic></sub> is a size <italic>n</italic> vector of methylation values (i.e., Beta scores) at CpG <italic>j</italic>, <italic>m</italic> is the number of covariates, and <italic>X</italic> is a <italic>n</italic> × <italic>m</italic> matrix of covariates.</p>
      <p id="Par22">Given the PyTorch toolkit does not currently include a function to estimate the cumulative distribution function (CDF) for the Student’s t-distribution, and thus it is not easily possible to compute a p-value based on the t-distribution, we used a Gaussian distribution CDF to estimate p-values. The Gaussian distribution converges to the Student’s t-distribution as the degrees of freedom (e.g., the number of samples) increases. For smaller sample sizes (e.g., &lt; 20 samples) the difference between the t and the Gaussian distributions may have a noticeable impact. The MLR feature of tecpg is optimized to increase performance for large input datasets. Optimizations include the minimization of repeated calculations, parallelizing tasks, memory use management, data chunking, and selective use of tensors on the GPU.</p>
      <p id="Par23">Gene expression, methylation, and phenotypic (i.e., covariate) data are provided as comma-separated value (CSV) files. Gene expression and methylation data are provided with samples in columns and loci in rows. Sample metadata (i.e., phenotypic) are provided with the covariate in the columns and samples in rows. Gene and methylation loci genomic region annotations are provided as browser extensible data (BED) files [<xref ref-type="bibr" rid="CR13">13</xref>]. Examples of annotation files are provided for the HumanMethylation450 (n = 349,220 CpG loci) and HumanHT-12 (n = 39,353 expression probes) arrays. For evaluation, the tool can either create simulated random data (i.e., `tecpg data dummy`) or download and format data from the Grady Trauma Project (GTP) [Gene Expression Omnibus (GEO) accession numbers GSE72680, GSE58137] (i.e., `tecpg data gtp`).</p>
      <p id="Par24">Four eCpG mappings modalities are implemented:<list list-type="bullet"><list-item><p id="Par25"><italic>Cis</italic>-eCPG: associations between all methylation loci-gene expression pairs within a specified window (default + 1 Mb) around the transcript start site for genes.</p></list-item><list-item><p id="Par26"><italic>Distal</italic>-eCpG: associations between all methylation loci-gene expression pairs outside of a specified window (default 50 Kb) from the transcript start site for genes, but on the same chromosome.</p></list-item><list-item><p id="Par27"><italic>Trans</italic>-eCpG: associations between all methylation loci-gene expression pairs. The computation is performed for each chromosome using methylation loci on all other chromosomes. To reduce output size, only associations below a given <italic>p</italic> value threshold (default 1 × 10<sup>–5</sup>) are stored.</p></list-item><list-item><p id="Par28"><italic>All</italic>-<italic>by-all</italic>: associations between all methylation loci-gene expression pairs across all regions. To reduce output size, only associations below a given <italic>p</italic> value threshold (default 1 × 10<sup>–5</sup>) are stored.</p></list-item></list></p>
      <p id="Par29">Numerous user-friendly features are provided. The tool will attempt to automatically detect a CUDA supported GPU. If a supported GPU is not available, or upon user request, the analyses will be performed using a CPU. The number of CPU threads is configurable and threaded CPU processing is available. In the case where data sizes exceed the CPU or GPU memory, the tool can be set to batch the analyses into chunks of gene expression and/or methylation data. Torch-eCpG can chunk the data for analysis as requested by the user through the settings. For users needing guidance to select settings, an option is available to estimate the number of gene expression loci per chunk. Chunking of the data was used for the evaluations described below. Finally, to limit the size of the output and associated time writing the file out, the user can set a p-value threshold to filter the reported analyses and can select the columns of the MLR analyses to report.</p>
    </sec>
    <sec id="Sec4">
      <title>Evaluation</title>
      <p id="Par30">To evaluate for the replicability of the regression analyses implemented in tecpg, we compared our regression analyses with similar analyses using the cor() and lm() functions in the stat package in R. To benchmark tecpg, we compared <italic>cis</italic>-eCpG, <italic>distal</italic>-eCpG and <italic>trans</italic>-eCpG mapping performance with and without a GPU. For CPU-based comparisons of the individual regions, computations were limited to a single core [<xref ref-type="bibr" rid="CR11">11</xref>]. We also evaluated tecpg performance using a range of CPU core counts (i.e., 1, 2, 4, 8, 16, 24). These analyses used a dataset of whole blood samples collected from 333 participants (76% female) aged 18–78 years in the GTP (GSE72680, GSE58137). To facilitate the evaluation of the scaling performance of the GPU implementation when mapping <italic>trans</italic>-eCpGs across a wide range of eCpG counts, we sampled with replacement from the GTP dataset to obtain a sample size of 1000. All tecpg benchmarks were conducted on a physical server running Linux having 28 Xeon cores (2.3 GHz), 256 GB CPU memory, and a A2 GPU with 16 GB of memory (Nvidia Corporation, Santa Clara, CA).</p>
    </sec>
  </sec>
  <sec id="Sec5">
    <title>Results and discussion</title>
    <p id="Par31">To provide an open-source tool for eQTM mapping, we developed the Torch-eCpG software package. To evaluate the reproducibility of the linear regression analysis, we compared our results with those implemented in the lm() function in the stats package in R. As shown in Fig. <xref rid="Fig1" ref-type="fig">1</xref>, our implementation of the linear regression demonstrates high reproducibility.<fig id="Fig1"><label>Fig. 1</label><caption><p>Comparisons of the first 1000 CpG-transcript pair linear regression analyses results between tecpg and lm() function in the stats package in R for a simulated dataset generated by sampling with replacement (n = 1000 samples). Simulated patient data was generated from real patient data in the Grady Trauma Project</p></caption><graphic xlink:href="12859_2024_5670_Fig1_HTML" id="MO1"/></fig></p>
    <p id="Par32">For tecpg benchmarking, we evaluated eQTM mapping using the CPU and GPU implementation in tecgp for 300 patients from the GTP patient dataset (422,442 methylation loci and 17,653 genes). Across the mapping modalities, the GPU outperformed the CPU analysis by up to 18x. Our implementation of the <italic>cis-</italic>eCpG mapping was 1.4 × faster on the GPU than that of the CPU (Fig. <xref rid="Fig2" ref-type="fig">2</xref>A). For <italic>distal-</italic>eCpG mapping, our implementation was 5 × faster on the GPU (Fig. <xref rid="Fig2" ref-type="fig">2</xref>B). Finally, for <italic>trans</italic>-eCpG mapping, our implementation was 18 × faster on the GPU (Fig. <xref rid="Fig2" ref-type="fig">2</xref>C). In terms of tecpg using additional cores, we found that major incremental improvements were realized by increasing the CPU core count up to 8, after which the gains were minimal (Fig. <xref rid="Fig3" ref-type="fig">3</xref>). Although the CPU performance did improve with additional cores, the GPU implementation was still 2 × faster than the 24-core CPU implementation.<fig id="Fig2"><label>Fig. 2</label><caption><p>Performance of GPU implementations for eQTM mapping. Comparison of runtimes for tecpg analyses on CPU and GPU for <bold>A</bold>
<italic>cis</italic>-eCpG, <bold>B</bold>
<italic>distal</italic>-eCpG, and <bold>C</bold>
<italic>trans</italic>-eCpG. The analyses evaluated 340 patients from the Grady Trauma Project dataset and included 422,442 methylation loci and 17,653 genes</p></caption><graphic xlink:href="12859_2024_5670_Fig2_HTML" id="MO2"/></fig><fig id="Fig3"><label>Fig. 3</label><caption><p>CPU runtimes for tecpg using 1, 2, 4, 8, 16, and 24 CPU cores. The analyses evaluated 340 patients from the Grady Trauma Project dataset and included 422,442 methylation loci and 17,653 genes</p></caption><graphic xlink:href="12859_2024_5670_Fig3_HTML" id="MO3"/></fig></p>
    <p id="Par33">We found tecpg scales linearly across a wide range of methylation loci for a reasonably large sample size (n = 1000 patients) (Fig. <xref rid="Fig4" ref-type="fig">4</xref>). In addition, the total time to evaluate 1000 patients for whole transcriptome (2 × 10<sup>4</sup> genes) and whole methylome array data (8.5 × 10<sup>5</sup>) was &lt; 15 h. The short time needed to evaluate a dataset sized to the largest currently available methylation array (i.e., Infinium MethylationEPIC) highlights the utility of this tool to evaluate eQTM mapping of dataset of realistic size. The linear scaling demonstrates the memory efficiency of the chunking of genes and CpG loci for analysis and is concordant with the embarrassingly parallel nature of this analysis (i.e., all gene × CpG loci comparisons are independent). This efficiency and scaling suggest the tool will be useful for larger datasets in the future (e.g., &gt; 10,000 patients) (Table <xref rid="Tab1" ref-type="table">1</xref>, Fig. <xref rid="Fig5" ref-type="fig">5</xref>) and is accessible to perform on smaller hardware setups (i.e., GPUs with smaller memory specifications). <fig id="Fig4"><label>Fig. 4</label><caption><p>GPU runtime of tecpg for 1000 simulated patient samples for 20,000 genes and 20 × 10<sup>3</sup>, 100 × 10<sup>3</sup>, 250 × 10<sup>3</sup>, 450 × 10<sup>3</sup> and 850 × 10<sup>3</sup> CpG loci. Simulated patient data was generated from real patient data in the Grady Trauma Project. Data chunking was performed using 100 genes and 100,000 CpGs using 6.2 GB of GPU memory</p></caption><graphic xlink:href="12859_2024_5670_Fig4_HTML" id="MO5"/></fig><table-wrap id="Tab1"><label>Table 1</label><caption><p>Runtime performance of Torch eCpG GPU implementation for the indicated number of samples, CpG loci, and gene expression loci. Data are plotted in Fig. <xref rid="Fig5" ref-type="fig">5</xref></p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left">Number of samples</th><th align="left">Number of CpG loci</th><th align="left">Number of genes</th><th align="left">Runtime (minutes)</th></tr></thead><tbody><tr><td align="left">100</td><td align="left">25,000</td><td char="," align="char">40,000</td><td char="." align="char">6.29</td></tr><tr><td align="left">100</td><td align="left">500,000</td><td char="," align="char">40,000</td><td char="." align="char">121.42</td></tr><tr><td align="left">100</td><td align="left">1,000,000</td><td char="," align="char">40,000</td><td char="." align="char">241.24</td></tr><tr><td align="left">100</td><td align="left">25,000</td><td char="," align="char">20,000</td><td char="." align="char">3.06</td></tr><tr><td align="left">100</td><td align="left">500,000</td><td char="," align="char">20,000</td><td char="." align="char">62.04</td></tr><tr><td align="left">100</td><td align="left">1,000,000</td><td char="," align="char">20,000</td><td char="." align="char">123.80</td></tr><tr><td align="left">1000</td><td align="left">25,000</td><td char="," align="char">40,000</td><td char="." align="char">16.48</td></tr><tr><td align="left">1000</td><td align="left">500,000</td><td char="," align="char">40,000</td><td char="." align="char">327.85</td></tr><tr><td align="left">1000</td><td align="left">1,000,000</td><td char="," align="char">40,000</td><td char="." align="char">654.57</td></tr><tr><td align="left">1000</td><td align="left">25,000</td><td char="," align="char">20,000</td><td char="." align="char">8.35</td></tr><tr><td align="left">1000</td><td align="left">500,000</td><td char="," align="char">20,000</td><td char="." align="char">167.03</td></tr><tr><td align="left">1000</td><td align="left">1,000,000</td><td char="," align="char">20,000</td><td char="." align="char">334.29</td></tr><tr><td align="left">10,000</td><td align="left">25,000</td><td char="," align="char">40,000</td><td char="." align="char">147.18</td></tr><tr><td align="left">10,000</td><td align="left">500,000</td><td char="," align="char">40,000</td><td char="." align="char">2926.99</td></tr><tr><td align="left">10,000</td><td align="left">1,000,000</td><td char="," align="char">40,000</td><td char="." align="char">5892.98</td></tr><tr><td align="left">10,000</td><td align="left">25,000</td><td char="," align="char">20,000</td><td char="." align="char">73.57</td></tr><tr><td align="left">10,000</td><td align="left">500,000</td><td char="," align="char">20,000</td><td char="." align="char">1470.24</td></tr><tr><td align="left">10,000</td><td align="left">1,000,000</td><td char="," align="char">20,000</td><td char="." align="char">2937.30</td></tr></tbody></table></table-wrap><fig id="Fig5"><label>Fig. 5</label><caption><p>Runtime performance of Torch eCpG GPU implementation for the indicated number of samples, CpG loci, and gene expression loci. <bold>A</bold> n = 100 and n = 1000 samples. <bold>B</bold> n = 100, n = 1000, n = 10,000 samples. Simulated patient data was generated from real patient data in the Grady Trauma Project</p></caption><graphic xlink:href="12859_2024_5670_Fig5_HTML" id="MO4"/></fig></p>
    <p id="Par34">Given the increased availability of whole genome bisulfite sequencing (WGBS) data, we fit a linear model to the range of methylation loci shown in Fig. <xref rid="Fig4" ref-type="fig">4</xref> to estimate the time it would take to map larger datasets. With this model, we estimate it would take 6.35 days (9146.04 min) to complete an analysis of 28 million CpG loci for 20,000 genes from 10,000 patients. To evaluate this estimate empirically, we simulated a dataset of 28 million CpG loci for 20,000 genes from 10,000 patients. The major resource limitation to the analysis was the size of the input data, which is limited by the available CPU memory. The maximum resident set size of dataset with 100,000 and 1 million CpGs was approximately 4.8 GB and 20 GB of RAM, respectively. Larger CpG datasets (e.g., all 28 million CpGs) required memory resources outside the assumptions of a reasonably sized workstation (i.e., &gt; 32 GB RAM). To manage the CPU memory usage to store the datasets in memory prior to analysis, the total dataset was split into smaller pieces, with each split of data using approximately 20 GB of RAM to load. To manage the GPU memory during analysis, we set the chunking sizes of 100 genes and 100,000 CpGs. The GPU memory usage was 6.2 GB. With this approach, the analysis of a simulated WGBS dataset completed in 6.75 days, similar to our estimated time for completion.</p>
  </sec>
  <sec id="Sec6">
    <title>Conclusions</title>
    <p id="Par35">Torch-eCpG is the first freely available open-source tool to perform eQTM mapping. It provides a scalable and high-performance implementation that supports GPU enabled systems. By reducing computing time the tool offers cost-savings on shared systems (e.g., clusters) or cloud-based computing resources that charge by units of time. This tool allows for individual research labs with limited computational resources to perform analyses on affordable computer equipment or cloud-based virtual machines.</p>
    <sec id="Sec7">
      <title>Availability and requirements</title>
      <p id="Par36">
        <list list-type="bullet">
          <list-item>
            <p id="Par37">Project name: Torch-eCpG</p>
          </list-item>
          <list-item>
            <p id="Par38">Project home page: <ext-link ext-link-type="uri" xlink:href="http://www.github.com/kordk/torch-ecpg">http://www.github.com/kordk/torch-ecpg</ext-link></p>
          </list-item>
          <list-item>
            <p id="Par39">Operating system(s): Platform independent</p>
          </list-item>
          <list-item>
            <p id="Par40">Programming language: Python 3.10 or higher</p>
          </list-item>
          <list-item>
            <p id="Par41">Other requirements: click ~= 8.0.3, colorama ~= 0.4.4, matplotlib ~= 3.5.1, numpy ~= 1.24.1, pandas ~= 1.3.5, psutil ~= 5.9.4, requests ~  = 2.26.0, scipy ~= 1.10.0, setuptools ~= 63.3.0, torch ~= 1.13.1 + cu116</p>
          </list-item>
          <list-item>
            <p id="Par42">License: BSD-3-Clause</p>
          </list-item>
          <list-item>
            <p id="Par43">Any restrictions to use by non-academics: license needed.</p>
          </list-item>
        </list>
      </p>
    </sec>
  </sec>
</body>
<back>
  <glossary>
    <title>Abbreviations</title>
    <def-list>
      <def-item>
        <term>BED</term>
        <def>
          <p id="Par4">Browser extensible data</p>
        </def>
      </def-item>
      <def-item>
        <term>CDF</term>
        <def>
          <p id="Par5">Cumulative distribution function</p>
        </def>
      </def-item>
      <def-item>
        <term>CpG</term>
        <def>
          <p id="Par6">Cytosine phosphate guanine</p>
        </def>
      </def-item>
      <def-item>
        <term>CPU</term>
        <def>
          <p id="Par7">Central processing unit</p>
        </def>
      </def-item>
      <def-item>
        <term>CSV</term>
        <def>
          <p id="Par8">Comma separated value</p>
        </def>
      </def-item>
      <def-item>
        <term>DNA</term>
        <def>
          <p id="Par9">Deoxyribonucleic acid</p>
        </def>
      </def-item>
      <def-item>
        <term>eCpG</term>
        <def>
          <p id="Par10">Expression associated CpG</p>
        </def>
      </def-item>
      <def-item>
        <term>eQTM</term>
        <def>
          <p id="Par11">Expression quantitative trait methylation</p>
        </def>
      </def-item>
      <def-item>
        <term>GEO</term>
        <def>
          <p id="Par12">Gene expression omnibus</p>
        </def>
      </def-item>
      <def-item>
        <term>GB</term>
        <def>
          <p id="Par13">Gigabyte</p>
        </def>
      </def-item>
      <def-item>
        <term>GHz</term>
        <def>
          <p id="Par14">Gigahertz</p>
        </def>
      </def-item>
      <def-item>
        <term>GPU</term>
        <def>
          <p id="Par15">Graphical processing unit</p>
        </def>
      </def-item>
      <def-item>
        <term>GTP</term>
        <def>
          <p id="Par16">Grady trauma project</p>
        </def>
      </def-item>
    </def-list>
  </glossary>
  <fn-group>
    <fn>
      <p>
        <bold>Publisher's Note</bold>
      </p>
      <p>Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p>
    </fn>
  </fn-group>
  <ack>
    <title>Acknowledgements</title>
    <p>Not applicable.</p>
  </ack>
  <notes notes-type="author-contribution">
    <title>Author contributions</title>
    <p>KMK originated the idea and developed the initial project plan. KMK and LB outlined and planned the tool development. LB and KMK developed the Torch-eCpG tool. All authors were involved in the planning and testing of Torch-eCpG. RR ran the simulations. KMK and RR prepared and reviewed the tables and figures. KMK prepared and reviewed the manuscript. All authors reviewed and edited the manuscript.</p>
  </notes>
  <notes notes-type="funding-information">
    <title>Funding</title>
    <p>This work was partially supported by an NIH NCI MERIT award (R37, CA233774, PI: Kober) and Cancer Center Support Grant (P30, CA082103, Co-I: Olshen).</p>
  </notes>
  <notes notes-type="data-availability">
    <title>Availability of data and materials</title>
    <p>The datasets analyzed in this study are publicly available in the Gene Expression Omnibus repository (<ext-link ext-link-type="uri" xlink:href="https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE72680">https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE72680</ext-link> and <ext-link ext-link-type="uri" xlink:href="https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE58137">https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE58137</ext-link>).</p>
  </notes>
  <notes>
    <title>Declarations</title>
    <notes id="FPar1">
      <title>Ethics approval and consent to participate</title>
      <p id="Par44">Not applicable.</p>
    </notes>
    <notes id="FPar2">
      <title>Consent for publication</title>
      <p id="Par45">Not applicable.</p>
    </notes>
    <notes id="FPar3" notes-type="COI-statement">
      <title>Competing interests</title>
      <p id="Par46">The authors have no competing interests.</p>
    </notes>
  </notes>
  <ref-list id="Bib1">
    <title>References</title>
    <ref id="CR1">
      <label>1.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Feinberg</surname>
            <given-names>AP</given-names>
          </name>
        </person-group>
        <article-title>The key role of epigenetics in human disease prevention and mitigation</article-title>
        <source>N Engl J Med</source>
        <year>2018</year>
        <volume>378</volume>
        <issue>14</issue>
        <fpage>1323</fpage>
        <lpage>1334</lpage>
        <pub-id pub-id-type="doi">10.1056/NEJMra1402513</pub-id>
        <?supplied-pmid 29617578?>
        <pub-id pub-id-type="pmid">29617578</pub-id>
      </element-citation>
    </ref>
    <ref id="CR2">
      <label>2.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lappalainen</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Greally</surname>
            <given-names>JM</given-names>
          </name>
        </person-group>
        <article-title>Associating cellular epigenetic models with human phenotypes</article-title>
        <source>Nat Rev Genet</source>
        <year>2017</year>
        <volume>18</volume>
        <issue>7</issue>
        <fpage>441</fpage>
        <lpage>451</lpage>
        <pub-id pub-id-type="doi">10.1038/nrg.2017.32</pub-id>
        <?supplied-pmid 28555657?>
        <pub-id pub-id-type="pmid">28555657</pub-id>
      </element-citation>
    </ref>
    <ref id="CR3">
      <label>3.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kennedy</surname>
            <given-names>EM</given-names>
          </name>
          <name>
            <surname>Goehring</surname>
            <given-names>GN</given-names>
          </name>
          <name>
            <surname>Nichols</surname>
            <given-names>MH</given-names>
          </name>
          <name>
            <surname>Robins</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Mehta</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Klengel</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Eskin</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Smith</surname>
            <given-names>AK</given-names>
          </name>
          <name>
            <surname>Conneely</surname>
            <given-names>KN</given-names>
          </name>
        </person-group>
        <article-title>An integrated -omics analysis of the epigenetic landscape of gene expression in human blood cells</article-title>
        <source>BMC Genomics</source>
        <year>2018</year>
        <volume>19</volume>
        <issue>1</issue>
        <fpage>476</fpage>
        <pub-id pub-id-type="doi">10.1186/s12864-018-4842-3</pub-id>
        <?supplied-pmid 29914364?>
        <pub-id pub-id-type="pmid">29914364</pub-id>
      </element-citation>
    </ref>
    <ref id="CR4">
      <label>4.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ruiz-Arenas</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Hernandez-Ferrer</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Vives-Usano</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Mari</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Quintela</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Mason</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Cadiou</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Casas</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Andrusaityte</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Gutzkow</surname>
            <given-names>KB</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Identification of autosomal cis expression quantitative trait methylation (cis eQTMs) in children's blood</article-title>
        <source>Elife</source>
        <year>2022</year>
        <volume>11</volume>
        <fpage>e65310</fpage>
        <pub-id pub-id-type="doi">10.7554/eLife.65310</pub-id>
        <?supplied-pmid 35302492?>
        <pub-id pub-id-type="pmid">35302492</pub-id>
      </element-citation>
    </ref>
    <ref id="CR5">
      <label>5.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kim</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Forno</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Park</surname>
            <given-names>HJ</given-names>
          </name>
          <name>
            <surname>Xu</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Yan</surname>
            <given-names>Q</given-names>
          </name>
          <name>
            <surname>Boutaoui</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Acosta-Perez</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Canino</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>W</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Expression quantitative trait methylation analysis reveals methylomic associations with gene expression in childhood asthma</article-title>
        <source>Chest</source>
        <year>2020</year>
        <volume>158</volume>
        <issue>5</issue>
        <fpage>1841</fpage>
        <lpage>1856</lpage>
        <pub-id pub-id-type="doi">10.1016/j.chest.2020.05.601</pub-id>
        <?supplied-pmid 32569636?>
        <pub-id pub-id-type="pmid">32569636</pub-id>
      </element-citation>
    </ref>
    <ref id="CR6">
      <label>6.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Taylor</surname>
            <given-names>DL</given-names>
          </name>
          <name>
            <surname>Jackson</surname>
            <given-names>AU</given-names>
          </name>
          <name>
            <surname>Narisu</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Hemani</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Erdos</surname>
            <given-names>MR</given-names>
          </name>
          <name>
            <surname>Chines</surname>
            <given-names>PS</given-names>
          </name>
          <name>
            <surname>Swift</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Idol</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Didion</surname>
            <given-names>JP</given-names>
          </name>
          <name>
            <surname>Welch</surname>
            <given-names>RP</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Integrative analysis of gene expression, DNA methylation, physiological traits, and genetic variation in human skeletal muscle</article-title>
        <source>Proc Natl Acad Sci U S A</source>
        <year>2019</year>
        <volume>116</volume>
        <issue>22</issue>
        <fpage>10883</fpage>
        <lpage>10888</lpage>
        <pub-id pub-id-type="doi">10.1073/pnas.1814263116</pub-id>
        <?supplied-pmid 31076557?>
        <pub-id pub-id-type="pmid">31076557</pub-id>
      </element-citation>
    </ref>
    <ref id="CR7">
      <label>7.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Yu</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Cen</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>YA</given-names>
          </name>
          <name>
            <surname>Markowitz</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Shaw</surname>
            <given-names>TI</given-names>
          </name>
          <name>
            <surname>Tsai</surname>
            <given-names>KY</given-names>
          </name>
          <name>
            <surname>Conejo-Garcia</surname>
            <given-names>JR</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>X</given-names>
          </name>
        </person-group>
        <article-title>Tumor expression quantitative trait methylation screening reveals distinct CpG panels for deconvolving cancer immune signatures</article-title>
        <source>Cancer Res</source>
        <year>2022</year>
        <volume>82</volume>
        <issue>9</issue>
        <fpage>1724</fpage>
        <lpage>1735</lpage>
        <pub-id pub-id-type="doi">10.1158/0008-5472.CAN-21-3113</pub-id>
        <?supplied-pmid 35176128?>
        <pub-id pub-id-type="pmid">35176128</pub-id>
      </element-citation>
    </ref>
    <ref id="CR8">
      <label>8.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Komaki</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Shiwa</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Furukawa</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Hachiya</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Ohmomo</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Otomo</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Satoh</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Hitomi</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Sobue</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Sasaki</surname>
            <given-names>M</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>iMETHYL: an integrative database of human DNA methylation, gene expression, and genomic variation</article-title>
        <source>Hum Genome Var</source>
        <year>2018</year>
        <volume>5</volume>
        <fpage>18008</fpage>
        <pub-id pub-id-type="doi">10.1038/hgv.2018.8</pub-id>
        <?supplied-pmid 29619235?>
        <pub-id pub-id-type="pmid">29619235</pub-id>
      </element-citation>
    </ref>
    <ref id="CR9">
      <label>9.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Koppad</surname>
            <given-names>S</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Cloud computing enabled big multi-omics data analytics</article-title>
        <source>Bioinform Biol Insights</source>
        <year>2021</year>
        <volume>15</volume>
        <fpage>11779322211035921</fpage>
        <pub-id pub-id-type="doi">10.1177/11779322211035921</pub-id>
        <?supplied-pmid 34376975?>
        <pub-id pub-id-type="pmid">34376975</pub-id>
      </element-citation>
    </ref>
    <ref id="CR10">
      <label>10.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Nobile</surname>
            <given-names>MS</given-names>
          </name>
          <name>
            <surname>Cazzaniga</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Tangherloni</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Besozzi</surname>
            <given-names>D</given-names>
          </name>
        </person-group>
        <article-title>Graphics processing units in bioinformatics, computational biology and systems biology</article-title>
        <source>Brief Bioinform</source>
        <year>2017</year>
        <volume>18</volume>
        <issue>5</issue>
        <fpage>870</fpage>
        <lpage>885</lpage>
        <?supplied-pmid 27402792?>
        <pub-id pub-id-type="pmid">27402792</pub-id>
      </element-citation>
    </ref>
    <ref id="CR11">
      <label>11.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Taylor-Weiner</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Aguet</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Haradhvala</surname>
            <given-names>NJ</given-names>
          </name>
          <name>
            <surname>Gosai</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Anand</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Kim</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Ardlie</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Van Allen</surname>
            <given-names>EM</given-names>
          </name>
          <name>
            <surname>Getz</surname>
            <given-names>G</given-names>
          </name>
        </person-group>
        <article-title>Scaling computational genomics to millions of individuals with GPUs</article-title>
        <source>Genome Biol</source>
        <year>2019</year>
        <volume>20</volume>
        <issue>1</issue>
        <fpage>228</fpage>
        <pub-id pub-id-type="doi">10.1186/s13059-019-1836-7</pub-id>
        <?supplied-pmid 31675989?>
        <pub-id pub-id-type="pmid">31675989</pub-id>
      </element-citation>
    </ref>
    <ref id="CR12">
      <label>12.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hanson</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Cairns</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Sinha</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>Principled multi-omic analysis reveals gene regulatory mechanisms of phenotype variation</article-title>
        <source>Genome Res</source>
        <year>2018</year>
        <volume>28</volume>
        <issue>8</issue>
        <fpage>1207</fpage>
        <lpage>1216</lpage>
        <pub-id pub-id-type="doi">10.1101/gr.227066.117</pub-id>
        <?supplied-pmid 29898900?>
        <pub-id pub-id-type="pmid">29898900</pub-id>
      </element-citation>
    </ref>
    <ref id="CR13">
      <label>13.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kent</surname>
            <given-names>WJ</given-names>
          </name>
          <name>
            <surname>Sugnet</surname>
            <given-names>CW</given-names>
          </name>
          <name>
            <surname>Furey</surname>
            <given-names>TS</given-names>
          </name>
          <name>
            <surname>Roskin</surname>
            <given-names>KM</given-names>
          </name>
          <name>
            <surname>Pringle</surname>
            <given-names>TH</given-names>
          </name>
          <name>
            <surname>Zahler</surname>
            <given-names>AM</given-names>
          </name>
          <name>
            <surname>Haussler</surname>
            <given-names>D</given-names>
          </name>
        </person-group>
        <article-title>The human genome browser at UCSC</article-title>
        <source>Genome Res</source>
        <year>2002</year>
        <volume>12</volume>
        <issue>6</issue>
        <fpage>996</fpage>
        <lpage>1006</lpage>
        <pub-id pub-id-type="doi">10.1101/gr.229102</pub-id>
        <?supplied-pmid 12045153?>
        <pub-id pub-id-type="pmid">12045153</pub-id>
      </element-citation>
    </ref>
  </ref-list>
</back>
<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName A++V2.4.dtd?>
<?SourceDTD.Version 2.4?>
<?ConverterInfo.XSLTName springer2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">BMC Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">BMC Bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>BMC Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="epub">1471-2105</issn>
    <publisher>
      <publisher-name>BioMed Central</publisher-name>
      <publisher-loc>London</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">10867984</article-id>
    <article-id pub-id-type="pmid">38355413</article-id>
    <article-id pub-id-type="publisher-id">5670</article-id>
    <article-id pub-id-type="doi">10.1186/s12859-024-05670-4</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Software</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Torch-eCpG: a fast and scalable eQTM mapper for thousands of molecular phenotypes with graphical processing units</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author" corresp="yes">
        <name>
          <surname>Kober</surname>
          <given-names>Kord M.</given-names>
        </name>
        <address>
          <email>kord.kober@ucsf.edu</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff2">2</xref>
        <xref ref-type="aff" rid="Aff3">3</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Berger</surname>
          <given-names>Liam</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Roy</surname>
          <given-names>Ritu</given-names>
        </name>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Olshen</surname>
          <given-names>Adam</given-names>
        </name>
        <xref ref-type="aff" rid="Aff2">2</xref>
        <xref ref-type="aff" rid="Aff3">3</xref>
      </contrib>
      <aff id="Aff1"><label>1</label><institution-wrap><institution-id institution-id-type="ROR">https://ror.org/043mz5j54</institution-id><institution-id institution-id-type="GRID">grid.266102.1</institution-id><institution-id institution-id-type="ISNI">0000 0001 2297 6811</institution-id><institution>School of Nursing, </institution><institution>University of California San Francisco, </institution></institution-wrap>San Francisco, CA USA </aff>
      <aff id="Aff2"><label>2</label><institution-wrap><institution-id institution-id-type="GRID">grid.266102.1</institution-id><institution-id institution-id-type="ISNI">0000 0001 2297 6811</institution-id><institution>Helen Diller Family Comprehensive Cancer Center, </institution><institution>University of California San Francisco, </institution></institution-wrap>San Francisco, CA USA </aff>
      <aff id="Aff3"><label>3</label><institution-wrap><institution-id institution-id-type="ROR">https://ror.org/043mz5j54</institution-id><institution-id institution-id-type="GRID">grid.266102.1</institution-id><institution-id institution-id-type="ISNI">0000 0001 2297 6811</institution-id><institution>Bakar Computational Health Sciences Institute, </institution><institution>University of California San Francisco, </institution></institution-wrap>San Francisco, CA USA </aff>
    </contrib-group>
    <pub-date pub-type="epub">
      <day>14</day>
      <month>2</month>
      <year>2024</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>14</day>
      <month>2</month>
      <year>2024</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2024</year>
    </pub-date>
    <volume>25</volume>
    <elocation-id>71</elocation-id>
    <history>
      <date date-type="received">
        <day>8</day>
        <month>3</month>
        <year>2023</year>
      </date>
      <date date-type="accepted">
        <day>22</day>
        <month>1</month>
        <year>2024</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2024</copyright-statement>
      <license>
        <ali:license_ref specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p><bold>Open Access</bold> This article is licensed under a Creative Commons Attribution 4.0 International License, which permits use, sharing, adaptation, distribution and reproduction in any medium or format, as long as you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons licence, and indicate if changes were made. The images or other third party material in this article are included in the article's Creative Commons licence, unless indicated otherwise in a credit line to the material. If material is not included in the article's Creative Commons licence and your intended use is not permitted by statutory regulation or exceeds the permitted use, you will need to obtain permission directly from the copyright holder. To view a copy of this licence, visit <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>. The Creative Commons Public Domain Dedication waiver (<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/publicdomain/zero/1.0/">http://creativecommons.org/publicdomain/zero/1.0/</ext-link>) applies to the data made available in this article, unless otherwise stated in a credit line to the data.</license-p>
      </license>
    </permissions>
    <abstract id="Abs1">
      <sec>
        <title>Background</title>
        <p id="Par1">Gene expression may be regulated by the DNA methylation of regulatory elements in <italic>cis</italic>, <italic>distal</italic>, and <italic>trans</italic> regions. One method to evaluate the relationship between DNA methylation and gene expression is the mapping of expression quantitative trait methylation (eQTM) loci (also called expression associated CpG loci, eCpG). However, no open-source tools are available to provide eQTM mapping. In addition, eQTM mapping can involve a large number of comparisons which may prevent the analyses due to limitations of computational resources. Here, we describe Torch-eCpG, an open-source tool to perform eQTM mapping that includes an optimized implementation that can use the graphical processing unit (GPU) to reduce runtime.</p>
      </sec>
      <sec>
        <title>Results</title>
        <p id="Par2">We demonstrate the analyses using the tool are reproducible, up to 18 × faster using the GPU, and scale linearly with increasing methylation loci.</p>
      </sec>
      <sec>
        <title>Conclusions</title>
        <p id="Par3">Torch-eCpG is a fast, reliable, and scalable tool to perform eQTM mapping. Source code for Torch-eCpG is available at <ext-link ext-link-type="uri" xlink:href="https://github.com/kordk/torch-ecpg">https://github.com/kordk/torch-ecpg</ext-link>.</p>
      </sec>
    </abstract>
    <kwd-group xml:lang="en">
      <title>Keywords</title>
      <kwd>DNA methylation</kwd>
      <kwd>Gene expression</kwd>
      <kwd>Transcriptional regulation</kwd>
      <kwd>Expression quantitative trait methylation</kwd>
      <kwd>eQTM</kwd>
      <kwd>eCpG</kwd>
      <kwd>GPU</kwd>
      <kwd>Tensor</kwd>
    </kwd-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100000054</institution-id>
            <institution>National Cancer Institute</institution>
          </institution-wrap>
        </funding-source>
        <award-id>CA233774</award-id>
        <award-id>CA082103</award-id>
        <principal-award-recipient>
          <name>
            <surname>Kober</surname>
            <given-names>Kord M.</given-names>
          </name>
          <name>
            <surname>Olshen</surname>
            <given-names>Adam</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
    </funding-group>
    <custom-meta-group>
      <custom-meta>
        <meta-name>issue-copyright-statement</meta-name>
        <meta-value>© BioMed Central Ltd., part of Springer Nature 2024</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec id="Sec1">
    <title>Background</title>
    <p id="Par17">Gene expression is regulated, in part, by epigenetic mechanisms. A major unanswered question in genomics research is the functional contribution of epigenetic variation on gene expression [<xref ref-type="bibr" rid="CR1">1</xref>, <xref ref-type="bibr" rid="CR2">2</xref>]. One method to evaluate for the potential functional effect of a methylation variation is to test for an association between levels of methylation and gene expression from the same samples. These expression-associated quantitative trait methylation (eQTM) loci may contribute to the regulation of gene expression (also called expression associated CpG loci, eCpG). These associations may be local (e.g., methylation located in the promoter region of a gene) or remote (e.g. methylation loci in a distant enhancer regions of a gene or on a different chromosome). There is growing interest in the integration of these data modalities and evaluating for eQTMs. For example, in terms of clinical research, recent studies have identified eQTMs from a variety of tissue types and outcomes [<xref ref-type="bibr" rid="CR3">3</xref>–<xref ref-type="bibr" rid="CR7">7</xref>].</p>
    <p id="Par18">Recent advances in high throughput molecular methods allow for the collection of complementary methylation and gene expression data from the same sample in large numbers. Although an increasing number of recent studies have provided eQTM datasets [<xref ref-type="bibr" rid="CR3">3</xref>, <xref ref-type="bibr" rid="CR8">8</xref>], there are no open-source tools currently available to investigators to implement these analyses on their own.</p>
    <p id="Par19">Given the increase in the availability of complementary datasets and the biological utility of identifying eQTMs, analytic tools must be made available, free to use, and able to scale to handle thousands to millions of samples (e.g., patients or single cells). Current methylation array datasets provide hundreds of thousands of loci (e.g., Infinium MethylationEPIC, Illumina, San Diego, CA) and RNA-sequencing and microarray methods provide expression levels for tens of thousands of genes. An exhaustive evaluation of these datasets would result in tens of billions of tests for hundreds or thousands of samples, quickly outreaching the computing capacity of a desktop computer and requiring larger workstations, clusters, or cloud computing [<xref ref-type="bibr" rid="CR9">9</xref>]. Future datasets will likely include more loci for evaluation and larger sample sizes. This need for computational resources will also require improvements in efficiency. Graphical processing units (GPUs) have provided major improvements in computation efficiency (i.e., runtime) for many bioinformatic software tools [<xref ref-type="bibr" rid="CR10">10</xref>]. Readily available open source libraries implement numerous general-purpose methods and mathematical primitives that allow for major improvements in computational efficiency at relatively lower costs as compared to CPUs [<xref ref-type="bibr" rid="CR11">11</xref>].</p>
    <p id="Par20">Given the analytic utility of evaluating for eQTMs to identify relationships between gene expression and epigenetic changes, a lack of an available open-source tool to implement an eQTM analysis, and the performance benefits of utilizing a GPU, the objectives of this project were to develop an open source, general-use tool for eQTM mapping and evaluate for performance increases of a GPU implementation. Here, we present the Torch-eCpG tool (tecpg).</p>
  </sec>
  <sec id="Sec2">
    <title>Implementation</title>
    <sec id="Sec3">
      <title>Association analyses</title>
      <p id="Par21">Two methods are available to test for the associations between CpG methylation and gene expression (eCpGs). First, a Pearson correlation can be computed between the methylation level and gene expression level. Second, a multivariate linear regression (MLR) method can model the relationship between gene expression and methylation level while including while adjusting for covariates (e.g., age, batch, cell type composition, population structure). Although more complex mapping approaches are available [<xref ref-type="bibr" rid="CR3">3</xref>], this approach is commonly used and the methods are easily accessible [<xref ref-type="bibr" rid="CR4">4</xref>, <xref ref-type="bibr" rid="CR8">8</xref>, <xref ref-type="bibr" rid="CR12">12</xref>]. Future versions of the tool may include additional mapping approaches. We tested for an association between methylation at CpG <italic>j</italic> and the expression level of transcript <italic>k</italic>, by fitting the model<disp-formula id="Equ1"><label>1</label><alternatives><tex-math id="M1">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$y_{k} = M_{j} a_{jk} + Xb_{jk} ,\;\; \, j = 1,..,n,\;\;k = 1,..,m$$\end{document}</tex-math><mml:math id="M2" display="block"><mml:mrow><mml:msub><mml:mi>y</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>M</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:msub><mml:mi>a</mml:mi><mml:mrow><mml:mi mathvariant="italic">jk</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mi>X</mml:mi><mml:msub><mml:mi>b</mml:mi><mml:mrow><mml:mi mathvariant="italic">jk</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mspace width="0.277778em"/><mml:mspace width="0.277778em"/><mml:mspace width="0.166667em"/><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mo>,</mml:mo><mml:mi>n</mml:mi><mml:mo>,</mml:mo><mml:mspace width="0.277778em"/><mml:mspace width="0.277778em"/><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mo>,</mml:mo><mml:mi>m</mml:mi></mml:mrow></mml:math><graphic xlink:href="12859_2024_5670_Article_Equ1.gif" position="anchor"/></alternatives></disp-formula>where <italic>y</italic><sub><italic>k</italic></sub> is a vector of log expression levels at gene <italic>k</italic> with length <italic>m</italic>, <italic>M</italic><sub><italic>j</italic></sub> is a size <italic>n</italic> vector of methylation values (i.e., Beta scores) at CpG <italic>j</italic>, <italic>m</italic> is the number of covariates, and <italic>X</italic> is a <italic>n</italic> × <italic>m</italic> matrix of covariates.</p>
      <p id="Par22">Given the PyTorch toolkit does not currently include a function to estimate the cumulative distribution function (CDF) for the Student’s t-distribution, and thus it is not easily possible to compute a p-value based on the t-distribution, we used a Gaussian distribution CDF to estimate p-values. The Gaussian distribution converges to the Student’s t-distribution as the degrees of freedom (e.g., the number of samples) increases. For smaller sample sizes (e.g., &lt; 20 samples) the difference between the t and the Gaussian distributions may have a noticeable impact. The MLR feature of tecpg is optimized to increase performance for large input datasets. Optimizations include the minimization of repeated calculations, parallelizing tasks, memory use management, data chunking, and selective use of tensors on the GPU.</p>
      <p id="Par23">Gene expression, methylation, and phenotypic (i.e., covariate) data are provided as comma-separated value (CSV) files. Gene expression and methylation data are provided with samples in columns and loci in rows. Sample metadata (i.e., phenotypic) are provided with the covariate in the columns and samples in rows. Gene and methylation loci genomic region annotations are provided as browser extensible data (BED) files [<xref ref-type="bibr" rid="CR13">13</xref>]. Examples of annotation files are provided for the HumanMethylation450 (n = 349,220 CpG loci) and HumanHT-12 (n = 39,353 expression probes) arrays. For evaluation, the tool can either create simulated random data (i.e., `tecpg data dummy`) or download and format data from the Grady Trauma Project (GTP) [Gene Expression Omnibus (GEO) accession numbers GSE72680, GSE58137] (i.e., `tecpg data gtp`).</p>
      <p id="Par24">Four eCpG mappings modalities are implemented:<list list-type="bullet"><list-item><p id="Par25"><italic>Cis</italic>-eCPG: associations between all methylation loci-gene expression pairs within a specified window (default + 1 Mb) around the transcript start site for genes.</p></list-item><list-item><p id="Par26"><italic>Distal</italic>-eCpG: associations between all methylation loci-gene expression pairs outside of a specified window (default 50 Kb) from the transcript start site for genes, but on the same chromosome.</p></list-item><list-item><p id="Par27"><italic>Trans</italic>-eCpG: associations between all methylation loci-gene expression pairs. The computation is performed for each chromosome using methylation loci on all other chromosomes. To reduce output size, only associations below a given <italic>p</italic> value threshold (default 1 × 10<sup>–5</sup>) are stored.</p></list-item><list-item><p id="Par28"><italic>All</italic>-<italic>by-all</italic>: associations between all methylation loci-gene expression pairs across all regions. To reduce output size, only associations below a given <italic>p</italic> value threshold (default 1 × 10<sup>–5</sup>) are stored.</p></list-item></list></p>
      <p id="Par29">Numerous user-friendly features are provided. The tool will attempt to automatically detect a CUDA supported GPU. If a supported GPU is not available, or upon user request, the analyses will be performed using a CPU. The number of CPU threads is configurable and threaded CPU processing is available. In the case where data sizes exceed the CPU or GPU memory, the tool can be set to batch the analyses into chunks of gene expression and/or methylation data. Torch-eCpG can chunk the data for analysis as requested by the user through the settings. For users needing guidance to select settings, an option is available to estimate the number of gene expression loci per chunk. Chunking of the data was used for the evaluations described below. Finally, to limit the size of the output and associated time writing the file out, the user can set a p-value threshold to filter the reported analyses and can select the columns of the MLR analyses to report.</p>
    </sec>
    <sec id="Sec4">
      <title>Evaluation</title>
      <p id="Par30">To evaluate for the replicability of the regression analyses implemented in tecpg, we compared our regression analyses with similar analyses using the cor() and lm() functions in the stat package in R. To benchmark tecpg, we compared <italic>cis</italic>-eCpG, <italic>distal</italic>-eCpG and <italic>trans</italic>-eCpG mapping performance with and without a GPU. For CPU-based comparisons of the individual regions, computations were limited to a single core [<xref ref-type="bibr" rid="CR11">11</xref>]. We also evaluated tecpg performance using a range of CPU core counts (i.e., 1, 2, 4, 8, 16, 24). These analyses used a dataset of whole blood samples collected from 333 participants (76% female) aged 18–78 years in the GTP (GSE72680, GSE58137). To facilitate the evaluation of the scaling performance of the GPU implementation when mapping <italic>trans</italic>-eCpGs across a wide range of eCpG counts, we sampled with replacement from the GTP dataset to obtain a sample size of 1000. All tecpg benchmarks were conducted on a physical server running Linux having 28 Xeon cores (2.3 GHz), 256 GB CPU memory, and a A2 GPU with 16 GB of memory (Nvidia Corporation, Santa Clara, CA).</p>
    </sec>
  </sec>
  <sec id="Sec5">
    <title>Results and discussion</title>
    <p id="Par31">To provide an open-source tool for eQTM mapping, we developed the Torch-eCpG software package. To evaluate the reproducibility of the linear regression analysis, we compared our results with those implemented in the lm() function in the stats package in R. As shown in Fig. <xref rid="Fig1" ref-type="fig">1</xref>, our implementation of the linear regression demonstrates high reproducibility.<fig id="Fig1"><label>Fig. 1</label><caption><p>Comparisons of the first 1000 CpG-transcript pair linear regression analyses results between tecpg and lm() function in the stats package in R for a simulated dataset generated by sampling with replacement (n = 1000 samples). Simulated patient data was generated from real patient data in the Grady Trauma Project</p></caption><graphic xlink:href="12859_2024_5670_Fig1_HTML" id="MO1"/></fig></p>
    <p id="Par32">For tecpg benchmarking, we evaluated eQTM mapping using the CPU and GPU implementation in tecgp for 300 patients from the GTP patient dataset (422,442 methylation loci and 17,653 genes). Across the mapping modalities, the GPU outperformed the CPU analysis by up to 18x. Our implementation of the <italic>cis-</italic>eCpG mapping was 1.4 × faster on the GPU than that of the CPU (Fig. <xref rid="Fig2" ref-type="fig">2</xref>A). For <italic>distal-</italic>eCpG mapping, our implementation was 5 × faster on the GPU (Fig. <xref rid="Fig2" ref-type="fig">2</xref>B). Finally, for <italic>trans</italic>-eCpG mapping, our implementation was 18 × faster on the GPU (Fig. <xref rid="Fig2" ref-type="fig">2</xref>C). In terms of tecpg using additional cores, we found that major incremental improvements were realized by increasing the CPU core count up to 8, after which the gains were minimal (Fig. <xref rid="Fig3" ref-type="fig">3</xref>). Although the CPU performance did improve with additional cores, the GPU implementation was still 2 × faster than the 24-core CPU implementation.<fig id="Fig2"><label>Fig. 2</label><caption><p>Performance of GPU implementations for eQTM mapping. Comparison of runtimes for tecpg analyses on CPU and GPU for <bold>A</bold>
<italic>cis</italic>-eCpG, <bold>B</bold>
<italic>distal</italic>-eCpG, and <bold>C</bold>
<italic>trans</italic>-eCpG. The analyses evaluated 340 patients from the Grady Trauma Project dataset and included 422,442 methylation loci and 17,653 genes</p></caption><graphic xlink:href="12859_2024_5670_Fig2_HTML" id="MO2"/></fig><fig id="Fig3"><label>Fig. 3</label><caption><p>CPU runtimes for tecpg using 1, 2, 4, 8, 16, and 24 CPU cores. The analyses evaluated 340 patients from the Grady Trauma Project dataset and included 422,442 methylation loci and 17,653 genes</p></caption><graphic xlink:href="12859_2024_5670_Fig3_HTML" id="MO3"/></fig></p>
    <p id="Par33">We found tecpg scales linearly across a wide range of methylation loci for a reasonably large sample size (n = 1000 patients) (Fig. <xref rid="Fig4" ref-type="fig">4</xref>). In addition, the total time to evaluate 1000 patients for whole transcriptome (2 × 10<sup>4</sup> genes) and whole methylome array data (8.5 × 10<sup>5</sup>) was &lt; 15 h. The short time needed to evaluate a dataset sized to the largest currently available methylation array (i.e., Infinium MethylationEPIC) highlights the utility of this tool to evaluate eQTM mapping of dataset of realistic size. The linear scaling demonstrates the memory efficiency of the chunking of genes and CpG loci for analysis and is concordant with the embarrassingly parallel nature of this analysis (i.e., all gene × CpG loci comparisons are independent). This efficiency and scaling suggest the tool will be useful for larger datasets in the future (e.g., &gt; 10,000 patients) (Table <xref rid="Tab1" ref-type="table">1</xref>, Fig. <xref rid="Fig5" ref-type="fig">5</xref>) and is accessible to perform on smaller hardware setups (i.e., GPUs with smaller memory specifications). <fig id="Fig4"><label>Fig. 4</label><caption><p>GPU runtime of tecpg for 1000 simulated patient samples for 20,000 genes and 20 × 10<sup>3</sup>, 100 × 10<sup>3</sup>, 250 × 10<sup>3</sup>, 450 × 10<sup>3</sup> and 850 × 10<sup>3</sup> CpG loci. Simulated patient data was generated from real patient data in the Grady Trauma Project. Data chunking was performed using 100 genes and 100,000 CpGs using 6.2 GB of GPU memory</p></caption><graphic xlink:href="12859_2024_5670_Fig4_HTML" id="MO5"/></fig><table-wrap id="Tab1"><label>Table 1</label><caption><p>Runtime performance of Torch eCpG GPU implementation for the indicated number of samples, CpG loci, and gene expression loci. Data are plotted in Fig. <xref rid="Fig5" ref-type="fig">5</xref></p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left">Number of samples</th><th align="left">Number of CpG loci</th><th align="left">Number of genes</th><th align="left">Runtime (minutes)</th></tr></thead><tbody><tr><td align="left">100</td><td align="left">25,000</td><td char="," align="char">40,000</td><td char="." align="char">6.29</td></tr><tr><td align="left">100</td><td align="left">500,000</td><td char="," align="char">40,000</td><td char="." align="char">121.42</td></tr><tr><td align="left">100</td><td align="left">1,000,000</td><td char="," align="char">40,000</td><td char="." align="char">241.24</td></tr><tr><td align="left">100</td><td align="left">25,000</td><td char="," align="char">20,000</td><td char="." align="char">3.06</td></tr><tr><td align="left">100</td><td align="left">500,000</td><td char="," align="char">20,000</td><td char="." align="char">62.04</td></tr><tr><td align="left">100</td><td align="left">1,000,000</td><td char="," align="char">20,000</td><td char="." align="char">123.80</td></tr><tr><td align="left">1000</td><td align="left">25,000</td><td char="," align="char">40,000</td><td char="." align="char">16.48</td></tr><tr><td align="left">1000</td><td align="left">500,000</td><td char="," align="char">40,000</td><td char="." align="char">327.85</td></tr><tr><td align="left">1000</td><td align="left">1,000,000</td><td char="," align="char">40,000</td><td char="." align="char">654.57</td></tr><tr><td align="left">1000</td><td align="left">25,000</td><td char="," align="char">20,000</td><td char="." align="char">8.35</td></tr><tr><td align="left">1000</td><td align="left">500,000</td><td char="," align="char">20,000</td><td char="." align="char">167.03</td></tr><tr><td align="left">1000</td><td align="left">1,000,000</td><td char="," align="char">20,000</td><td char="." align="char">334.29</td></tr><tr><td align="left">10,000</td><td align="left">25,000</td><td char="," align="char">40,000</td><td char="." align="char">147.18</td></tr><tr><td align="left">10,000</td><td align="left">500,000</td><td char="," align="char">40,000</td><td char="." align="char">2926.99</td></tr><tr><td align="left">10,000</td><td align="left">1,000,000</td><td char="," align="char">40,000</td><td char="." align="char">5892.98</td></tr><tr><td align="left">10,000</td><td align="left">25,000</td><td char="," align="char">20,000</td><td char="." align="char">73.57</td></tr><tr><td align="left">10,000</td><td align="left">500,000</td><td char="," align="char">20,000</td><td char="." align="char">1470.24</td></tr><tr><td align="left">10,000</td><td align="left">1,000,000</td><td char="," align="char">20,000</td><td char="." align="char">2937.30</td></tr></tbody></table></table-wrap><fig id="Fig5"><label>Fig. 5</label><caption><p>Runtime performance of Torch eCpG GPU implementation for the indicated number of samples, CpG loci, and gene expression loci. <bold>A</bold> n = 100 and n = 1000 samples. <bold>B</bold> n = 100, n = 1000, n = 10,000 samples. Simulated patient data was generated from real patient data in the Grady Trauma Project</p></caption><graphic xlink:href="12859_2024_5670_Fig5_HTML" id="MO4"/></fig></p>
    <p id="Par34">Given the increased availability of whole genome bisulfite sequencing (WGBS) data, we fit a linear model to the range of methylation loci shown in Fig. <xref rid="Fig4" ref-type="fig">4</xref> to estimate the time it would take to map larger datasets. With this model, we estimate it would take 6.35 days (9146.04 min) to complete an analysis of 28 million CpG loci for 20,000 genes from 10,000 patients. To evaluate this estimate empirically, we simulated a dataset of 28 million CpG loci for 20,000 genes from 10,000 patients. The major resource limitation to the analysis was the size of the input data, which is limited by the available CPU memory. The maximum resident set size of dataset with 100,000 and 1 million CpGs was approximately 4.8 GB and 20 GB of RAM, respectively. Larger CpG datasets (e.g., all 28 million CpGs) required memory resources outside the assumptions of a reasonably sized workstation (i.e., &gt; 32 GB RAM). To manage the CPU memory usage to store the datasets in memory prior to analysis, the total dataset was split into smaller pieces, with each split of data using approximately 20 GB of RAM to load. To manage the GPU memory during analysis, we set the chunking sizes of 100 genes and 100,000 CpGs. The GPU memory usage was 6.2 GB. With this approach, the analysis of a simulated WGBS dataset completed in 6.75 days, similar to our estimated time for completion.</p>
  </sec>
  <sec id="Sec6">
    <title>Conclusions</title>
    <p id="Par35">Torch-eCpG is the first freely available open-source tool to perform eQTM mapping. It provides a scalable and high-performance implementation that supports GPU enabled systems. By reducing computing time the tool offers cost-savings on shared systems (e.g., clusters) or cloud-based computing resources that charge by units of time. This tool allows for individual research labs with limited computational resources to perform analyses on affordable computer equipment or cloud-based virtual machines.</p>
    <sec id="Sec7">
      <title>Availability and requirements</title>
      <p id="Par36">
        <list list-type="bullet">
          <list-item>
            <p id="Par37">Project name: Torch-eCpG</p>
          </list-item>
          <list-item>
            <p id="Par38">Project home page: <ext-link ext-link-type="uri" xlink:href="http://www.github.com/kordk/torch-ecpg">http://www.github.com/kordk/torch-ecpg</ext-link></p>
          </list-item>
          <list-item>
            <p id="Par39">Operating system(s): Platform independent</p>
          </list-item>
          <list-item>
            <p id="Par40">Programming language: Python 3.10 or higher</p>
          </list-item>
          <list-item>
            <p id="Par41">Other requirements: click ~= 8.0.3, colorama ~= 0.4.4, matplotlib ~= 3.5.1, numpy ~= 1.24.1, pandas ~= 1.3.5, psutil ~= 5.9.4, requests ~  = 2.26.0, scipy ~= 1.10.0, setuptools ~= 63.3.0, torch ~= 1.13.1 + cu116</p>
          </list-item>
          <list-item>
            <p id="Par42">License: BSD-3-Clause</p>
          </list-item>
          <list-item>
            <p id="Par43">Any restrictions to use by non-academics: license needed.</p>
          </list-item>
        </list>
      </p>
    </sec>
  </sec>
</body>
<back>
  <glossary>
    <title>Abbreviations</title>
    <def-list>
      <def-item>
        <term>BED</term>
        <def>
          <p id="Par4">Browser extensible data</p>
        </def>
      </def-item>
      <def-item>
        <term>CDF</term>
        <def>
          <p id="Par5">Cumulative distribution function</p>
        </def>
      </def-item>
      <def-item>
        <term>CpG</term>
        <def>
          <p id="Par6">Cytosine phosphate guanine</p>
        </def>
      </def-item>
      <def-item>
        <term>CPU</term>
        <def>
          <p id="Par7">Central processing unit</p>
        </def>
      </def-item>
      <def-item>
        <term>CSV</term>
        <def>
          <p id="Par8">Comma separated value</p>
        </def>
      </def-item>
      <def-item>
        <term>DNA</term>
        <def>
          <p id="Par9">Deoxyribonucleic acid</p>
        </def>
      </def-item>
      <def-item>
        <term>eCpG</term>
        <def>
          <p id="Par10">Expression associated CpG</p>
        </def>
      </def-item>
      <def-item>
        <term>eQTM</term>
        <def>
          <p id="Par11">Expression quantitative trait methylation</p>
        </def>
      </def-item>
      <def-item>
        <term>GEO</term>
        <def>
          <p id="Par12">Gene expression omnibus</p>
        </def>
      </def-item>
      <def-item>
        <term>GB</term>
        <def>
          <p id="Par13">Gigabyte</p>
        </def>
      </def-item>
      <def-item>
        <term>GHz</term>
        <def>
          <p id="Par14">Gigahertz</p>
        </def>
      </def-item>
      <def-item>
        <term>GPU</term>
        <def>
          <p id="Par15">Graphical processing unit</p>
        </def>
      </def-item>
      <def-item>
        <term>GTP</term>
        <def>
          <p id="Par16">Grady trauma project</p>
        </def>
      </def-item>
    </def-list>
  </glossary>
  <fn-group>
    <fn>
      <p>
        <bold>Publisher's Note</bold>
      </p>
      <p>Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p>
    </fn>
  </fn-group>
  <ack>
    <title>Acknowledgements</title>
    <p>Not applicable.</p>
  </ack>
  <notes notes-type="author-contribution">
    <title>Author contributions</title>
    <p>KMK originated the idea and developed the initial project plan. KMK and LB outlined and planned the tool development. LB and KMK developed the Torch-eCpG tool. All authors were involved in the planning and testing of Torch-eCpG. RR ran the simulations. KMK and RR prepared and reviewed the tables and figures. KMK prepared and reviewed the manuscript. All authors reviewed and edited the manuscript.</p>
  </notes>
  <notes notes-type="funding-information">
    <title>Funding</title>
    <p>This work was partially supported by an NIH NCI MERIT award (R37, CA233774, PI: Kober) and Cancer Center Support Grant (P30, CA082103, Co-I: Olshen).</p>
  </notes>
  <notes notes-type="data-availability">
    <title>Availability of data and materials</title>
    <p>The datasets analyzed in this study are publicly available in the Gene Expression Omnibus repository (<ext-link ext-link-type="uri" xlink:href="https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE72680">https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE72680</ext-link> and <ext-link ext-link-type="uri" xlink:href="https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE58137">https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE58137</ext-link>).</p>
  </notes>
  <notes>
    <title>Declarations</title>
    <notes id="FPar1">
      <title>Ethics approval and consent to participate</title>
      <p id="Par44">Not applicable.</p>
    </notes>
    <notes id="FPar2">
      <title>Consent for publication</title>
      <p id="Par45">Not applicable.</p>
    </notes>
    <notes id="FPar3" notes-type="COI-statement">
      <title>Competing interests</title>
      <p id="Par46">The authors have no competing interests.</p>
    </notes>
  </notes>
  <ref-list id="Bib1">
    <title>References</title>
    <ref id="CR1">
      <label>1.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Feinberg</surname>
            <given-names>AP</given-names>
          </name>
        </person-group>
        <article-title>The key role of epigenetics in human disease prevention and mitigation</article-title>
        <source>N Engl J Med</source>
        <year>2018</year>
        <volume>378</volume>
        <issue>14</issue>
        <fpage>1323</fpage>
        <lpage>1334</lpage>
        <pub-id pub-id-type="doi">10.1056/NEJMra1402513</pub-id>
        <?supplied-pmid 29617578?>
        <pub-id pub-id-type="pmid">29617578</pub-id>
      </element-citation>
    </ref>
    <ref id="CR2">
      <label>2.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lappalainen</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Greally</surname>
            <given-names>JM</given-names>
          </name>
        </person-group>
        <article-title>Associating cellular epigenetic models with human phenotypes</article-title>
        <source>Nat Rev Genet</source>
        <year>2017</year>
        <volume>18</volume>
        <issue>7</issue>
        <fpage>441</fpage>
        <lpage>451</lpage>
        <pub-id pub-id-type="doi">10.1038/nrg.2017.32</pub-id>
        <?supplied-pmid 28555657?>
        <pub-id pub-id-type="pmid">28555657</pub-id>
      </element-citation>
    </ref>
    <ref id="CR3">
      <label>3.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kennedy</surname>
            <given-names>EM</given-names>
          </name>
          <name>
            <surname>Goehring</surname>
            <given-names>GN</given-names>
          </name>
          <name>
            <surname>Nichols</surname>
            <given-names>MH</given-names>
          </name>
          <name>
            <surname>Robins</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Mehta</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Klengel</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Eskin</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Smith</surname>
            <given-names>AK</given-names>
          </name>
          <name>
            <surname>Conneely</surname>
            <given-names>KN</given-names>
          </name>
        </person-group>
        <article-title>An integrated -omics analysis of the epigenetic landscape of gene expression in human blood cells</article-title>
        <source>BMC Genomics</source>
        <year>2018</year>
        <volume>19</volume>
        <issue>1</issue>
        <fpage>476</fpage>
        <pub-id pub-id-type="doi">10.1186/s12864-018-4842-3</pub-id>
        <?supplied-pmid 29914364?>
        <pub-id pub-id-type="pmid">29914364</pub-id>
      </element-citation>
    </ref>
    <ref id="CR4">
      <label>4.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ruiz-Arenas</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Hernandez-Ferrer</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Vives-Usano</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Mari</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Quintela</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Mason</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Cadiou</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Casas</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Andrusaityte</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Gutzkow</surname>
            <given-names>KB</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Identification of autosomal cis expression quantitative trait methylation (cis eQTMs) in children's blood</article-title>
        <source>Elife</source>
        <year>2022</year>
        <volume>11</volume>
        <fpage>e65310</fpage>
        <pub-id pub-id-type="doi">10.7554/eLife.65310</pub-id>
        <?supplied-pmid 35302492?>
        <pub-id pub-id-type="pmid">35302492</pub-id>
      </element-citation>
    </ref>
    <ref id="CR5">
      <label>5.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kim</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Forno</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Park</surname>
            <given-names>HJ</given-names>
          </name>
          <name>
            <surname>Xu</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Yan</surname>
            <given-names>Q</given-names>
          </name>
          <name>
            <surname>Boutaoui</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Acosta-Perez</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Canino</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>W</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Expression quantitative trait methylation analysis reveals methylomic associations with gene expression in childhood asthma</article-title>
        <source>Chest</source>
        <year>2020</year>
        <volume>158</volume>
        <issue>5</issue>
        <fpage>1841</fpage>
        <lpage>1856</lpage>
        <pub-id pub-id-type="doi">10.1016/j.chest.2020.05.601</pub-id>
        <?supplied-pmid 32569636?>
        <pub-id pub-id-type="pmid">32569636</pub-id>
      </element-citation>
    </ref>
    <ref id="CR6">
      <label>6.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Taylor</surname>
            <given-names>DL</given-names>
          </name>
          <name>
            <surname>Jackson</surname>
            <given-names>AU</given-names>
          </name>
          <name>
            <surname>Narisu</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Hemani</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Erdos</surname>
            <given-names>MR</given-names>
          </name>
          <name>
            <surname>Chines</surname>
            <given-names>PS</given-names>
          </name>
          <name>
            <surname>Swift</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Idol</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Didion</surname>
            <given-names>JP</given-names>
          </name>
          <name>
            <surname>Welch</surname>
            <given-names>RP</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Integrative analysis of gene expression, DNA methylation, physiological traits, and genetic variation in human skeletal muscle</article-title>
        <source>Proc Natl Acad Sci U S A</source>
        <year>2019</year>
        <volume>116</volume>
        <issue>22</issue>
        <fpage>10883</fpage>
        <lpage>10888</lpage>
        <pub-id pub-id-type="doi">10.1073/pnas.1814263116</pub-id>
        <?supplied-pmid 31076557?>
        <pub-id pub-id-type="pmid">31076557</pub-id>
      </element-citation>
    </ref>
    <ref id="CR7">
      <label>7.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Yu</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Cen</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>YA</given-names>
          </name>
          <name>
            <surname>Markowitz</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Shaw</surname>
            <given-names>TI</given-names>
          </name>
          <name>
            <surname>Tsai</surname>
            <given-names>KY</given-names>
          </name>
          <name>
            <surname>Conejo-Garcia</surname>
            <given-names>JR</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>X</given-names>
          </name>
        </person-group>
        <article-title>Tumor expression quantitative trait methylation screening reveals distinct CpG panels for deconvolving cancer immune signatures</article-title>
        <source>Cancer Res</source>
        <year>2022</year>
        <volume>82</volume>
        <issue>9</issue>
        <fpage>1724</fpage>
        <lpage>1735</lpage>
        <pub-id pub-id-type="doi">10.1158/0008-5472.CAN-21-3113</pub-id>
        <?supplied-pmid 35176128?>
        <pub-id pub-id-type="pmid">35176128</pub-id>
      </element-citation>
    </ref>
    <ref id="CR8">
      <label>8.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Komaki</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Shiwa</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Furukawa</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Hachiya</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Ohmomo</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Otomo</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Satoh</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Hitomi</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Sobue</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Sasaki</surname>
            <given-names>M</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>iMETHYL: an integrative database of human DNA methylation, gene expression, and genomic variation</article-title>
        <source>Hum Genome Var</source>
        <year>2018</year>
        <volume>5</volume>
        <fpage>18008</fpage>
        <pub-id pub-id-type="doi">10.1038/hgv.2018.8</pub-id>
        <?supplied-pmid 29619235?>
        <pub-id pub-id-type="pmid">29619235</pub-id>
      </element-citation>
    </ref>
    <ref id="CR9">
      <label>9.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Koppad</surname>
            <given-names>S</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Cloud computing enabled big multi-omics data analytics</article-title>
        <source>Bioinform Biol Insights</source>
        <year>2021</year>
        <volume>15</volume>
        <fpage>11779322211035921</fpage>
        <pub-id pub-id-type="doi">10.1177/11779322211035921</pub-id>
        <?supplied-pmid 34376975?>
        <pub-id pub-id-type="pmid">34376975</pub-id>
      </element-citation>
    </ref>
    <ref id="CR10">
      <label>10.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Nobile</surname>
            <given-names>MS</given-names>
          </name>
          <name>
            <surname>Cazzaniga</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Tangherloni</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Besozzi</surname>
            <given-names>D</given-names>
          </name>
        </person-group>
        <article-title>Graphics processing units in bioinformatics, computational biology and systems biology</article-title>
        <source>Brief Bioinform</source>
        <year>2017</year>
        <volume>18</volume>
        <issue>5</issue>
        <fpage>870</fpage>
        <lpage>885</lpage>
        <?supplied-pmid 27402792?>
        <pub-id pub-id-type="pmid">27402792</pub-id>
      </element-citation>
    </ref>
    <ref id="CR11">
      <label>11.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Taylor-Weiner</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Aguet</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Haradhvala</surname>
            <given-names>NJ</given-names>
          </name>
          <name>
            <surname>Gosai</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Anand</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Kim</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Ardlie</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Van Allen</surname>
            <given-names>EM</given-names>
          </name>
          <name>
            <surname>Getz</surname>
            <given-names>G</given-names>
          </name>
        </person-group>
        <article-title>Scaling computational genomics to millions of individuals with GPUs</article-title>
        <source>Genome Biol</source>
        <year>2019</year>
        <volume>20</volume>
        <issue>1</issue>
        <fpage>228</fpage>
        <pub-id pub-id-type="doi">10.1186/s13059-019-1836-7</pub-id>
        <?supplied-pmid 31675989?>
        <pub-id pub-id-type="pmid">31675989</pub-id>
      </element-citation>
    </ref>
    <ref id="CR12">
      <label>12.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hanson</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Cairns</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Sinha</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>Principled multi-omic analysis reveals gene regulatory mechanisms of phenotype variation</article-title>
        <source>Genome Res</source>
        <year>2018</year>
        <volume>28</volume>
        <issue>8</issue>
        <fpage>1207</fpage>
        <lpage>1216</lpage>
        <pub-id pub-id-type="doi">10.1101/gr.227066.117</pub-id>
        <?supplied-pmid 29898900?>
        <pub-id pub-id-type="pmid">29898900</pub-id>
      </element-citation>
    </ref>
    <ref id="CR13">
      <label>13.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kent</surname>
            <given-names>WJ</given-names>
          </name>
          <name>
            <surname>Sugnet</surname>
            <given-names>CW</given-names>
          </name>
          <name>
            <surname>Furey</surname>
            <given-names>TS</given-names>
          </name>
          <name>
            <surname>Roskin</surname>
            <given-names>KM</given-names>
          </name>
          <name>
            <surname>Pringle</surname>
            <given-names>TH</given-names>
          </name>
          <name>
            <surname>Zahler</surname>
            <given-names>AM</given-names>
          </name>
          <name>
            <surname>Haussler</surname>
            <given-names>D</given-names>
          </name>
        </person-group>
        <article-title>The human genome browser at UCSC</article-title>
        <source>Genome Res</source>
        <year>2002</year>
        <volume>12</volume>
        <issue>6</issue>
        <fpage>996</fpage>
        <lpage>1006</lpage>
        <pub-id pub-id-type="doi">10.1101/gr.229102</pub-id>
        <?supplied-pmid 12045153?>
        <pub-id pub-id-type="pmid">12045153</pub-id>
      </element-citation>
    </ref>
  </ref-list>
</back>
<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName A++V2.4.dtd?>
<?SourceDTD.Version 2.4?>
<?ConverterInfo.XSLTName springer2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">BMC Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">BMC Bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>BMC Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="epub">1471-2105</issn>
    <publisher>
      <publisher-name>BioMed Central</publisher-name>
      <publisher-loc>London</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">10867984</article-id>
    <article-id pub-id-type="pmid">38355413</article-id>
    <article-id pub-id-type="publisher-id">5670</article-id>
    <article-id pub-id-type="doi">10.1186/s12859-024-05670-4</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Software</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Torch-eCpG: a fast and scalable eQTM mapper for thousands of molecular phenotypes with graphical processing units</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author" corresp="yes">
        <name>
          <surname>Kober</surname>
          <given-names>Kord M.</given-names>
        </name>
        <address>
          <email>kord.kober@ucsf.edu</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff2">2</xref>
        <xref ref-type="aff" rid="Aff3">3</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Berger</surname>
          <given-names>Liam</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Roy</surname>
          <given-names>Ritu</given-names>
        </name>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Olshen</surname>
          <given-names>Adam</given-names>
        </name>
        <xref ref-type="aff" rid="Aff2">2</xref>
        <xref ref-type="aff" rid="Aff3">3</xref>
      </contrib>
      <aff id="Aff1"><label>1</label><institution-wrap><institution-id institution-id-type="ROR">https://ror.org/043mz5j54</institution-id><institution-id institution-id-type="GRID">grid.266102.1</institution-id><institution-id institution-id-type="ISNI">0000 0001 2297 6811</institution-id><institution>School of Nursing, </institution><institution>University of California San Francisco, </institution></institution-wrap>San Francisco, CA USA </aff>
      <aff id="Aff2"><label>2</label><institution-wrap><institution-id institution-id-type="GRID">grid.266102.1</institution-id><institution-id institution-id-type="ISNI">0000 0001 2297 6811</institution-id><institution>Helen Diller Family Comprehensive Cancer Center, </institution><institution>University of California San Francisco, </institution></institution-wrap>San Francisco, CA USA </aff>
      <aff id="Aff3"><label>3</label><institution-wrap><institution-id institution-id-type="ROR">https://ror.org/043mz5j54</institution-id><institution-id institution-id-type="GRID">grid.266102.1</institution-id><institution-id institution-id-type="ISNI">0000 0001 2297 6811</institution-id><institution>Bakar Computational Health Sciences Institute, </institution><institution>University of California San Francisco, </institution></institution-wrap>San Francisco, CA USA </aff>
    </contrib-group>
    <pub-date pub-type="epub">
      <day>14</day>
      <month>2</month>
      <year>2024</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>14</day>
      <month>2</month>
      <year>2024</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2024</year>
    </pub-date>
    <volume>25</volume>
    <elocation-id>71</elocation-id>
    <history>
      <date date-type="received">
        <day>8</day>
        <month>3</month>
        <year>2023</year>
      </date>
      <date date-type="accepted">
        <day>22</day>
        <month>1</month>
        <year>2024</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2024</copyright-statement>
      <license>
        <ali:license_ref specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p><bold>Open Access</bold> This article is licensed under a Creative Commons Attribution 4.0 International License, which permits use, sharing, adaptation, distribution and reproduction in any medium or format, as long as you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons licence, and indicate if changes were made. The images or other third party material in this article are included in the article's Creative Commons licence, unless indicated otherwise in a credit line to the material. If material is not included in the article's Creative Commons licence and your intended use is not permitted by statutory regulation or exceeds the permitted use, you will need to obtain permission directly from the copyright holder. To view a copy of this licence, visit <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>. The Creative Commons Public Domain Dedication waiver (<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/publicdomain/zero/1.0/">http://creativecommons.org/publicdomain/zero/1.0/</ext-link>) applies to the data made available in this article, unless otherwise stated in a credit line to the data.</license-p>
      </license>
    </permissions>
    <abstract id="Abs1">
      <sec>
        <title>Background</title>
        <p id="Par1">Gene expression may be regulated by the DNA methylation of regulatory elements in <italic>cis</italic>, <italic>distal</italic>, and <italic>trans</italic> regions. One method to evaluate the relationship between DNA methylation and gene expression is the mapping of expression quantitative trait methylation (eQTM) loci (also called expression associated CpG loci, eCpG). However, no open-source tools are available to provide eQTM mapping. In addition, eQTM mapping can involve a large number of comparisons which may prevent the analyses due to limitations of computational resources. Here, we describe Torch-eCpG, an open-source tool to perform eQTM mapping that includes an optimized implementation that can use the graphical processing unit (GPU) to reduce runtime.</p>
      </sec>
      <sec>
        <title>Results</title>
        <p id="Par2">We demonstrate the analyses using the tool are reproducible, up to 18 × faster using the GPU, and scale linearly with increasing methylation loci.</p>
      </sec>
      <sec>
        <title>Conclusions</title>
        <p id="Par3">Torch-eCpG is a fast, reliable, and scalable tool to perform eQTM mapping. Source code for Torch-eCpG is available at <ext-link ext-link-type="uri" xlink:href="https://github.com/kordk/torch-ecpg">https://github.com/kordk/torch-ecpg</ext-link>.</p>
      </sec>
    </abstract>
    <kwd-group xml:lang="en">
      <title>Keywords</title>
      <kwd>DNA methylation</kwd>
      <kwd>Gene expression</kwd>
      <kwd>Transcriptional regulation</kwd>
      <kwd>Expression quantitative trait methylation</kwd>
      <kwd>eQTM</kwd>
      <kwd>eCpG</kwd>
      <kwd>GPU</kwd>
      <kwd>Tensor</kwd>
    </kwd-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100000054</institution-id>
            <institution>National Cancer Institute</institution>
          </institution-wrap>
        </funding-source>
        <award-id>CA233774</award-id>
        <award-id>CA082103</award-id>
        <principal-award-recipient>
          <name>
            <surname>Kober</surname>
            <given-names>Kord M.</given-names>
          </name>
          <name>
            <surname>Olshen</surname>
            <given-names>Adam</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
    </funding-group>
    <custom-meta-group>
      <custom-meta>
        <meta-name>issue-copyright-statement</meta-name>
        <meta-value>© BioMed Central Ltd., part of Springer Nature 2024</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec id="Sec1">
    <title>Background</title>
    <p id="Par17">Gene expression is regulated, in part, by epigenetic mechanisms. A major unanswered question in genomics research is the functional contribution of epigenetic variation on gene expression [<xref ref-type="bibr" rid="CR1">1</xref>, <xref ref-type="bibr" rid="CR2">2</xref>]. One method to evaluate for the potential functional effect of a methylation variation is to test for an association between levels of methylation and gene expression from the same samples. These expression-associated quantitative trait methylation (eQTM) loci may contribute to the regulation of gene expression (also called expression associated CpG loci, eCpG). These associations may be local (e.g., methylation located in the promoter region of a gene) or remote (e.g. methylation loci in a distant enhancer regions of a gene or on a different chromosome). There is growing interest in the integration of these data modalities and evaluating for eQTMs. For example, in terms of clinical research, recent studies have identified eQTMs from a variety of tissue types and outcomes [<xref ref-type="bibr" rid="CR3">3</xref>–<xref ref-type="bibr" rid="CR7">7</xref>].</p>
    <p id="Par18">Recent advances in high throughput molecular methods allow for the collection of complementary methylation and gene expression data from the same sample in large numbers. Although an increasing number of recent studies have provided eQTM datasets [<xref ref-type="bibr" rid="CR3">3</xref>, <xref ref-type="bibr" rid="CR8">8</xref>], there are no open-source tools currently available to investigators to implement these analyses on their own.</p>
    <p id="Par19">Given the increase in the availability of complementary datasets and the biological utility of identifying eQTMs, analytic tools must be made available, free to use, and able to scale to handle thousands to millions of samples (e.g., patients or single cells). Current methylation array datasets provide hundreds of thousands of loci (e.g., Infinium MethylationEPIC, Illumina, San Diego, CA) and RNA-sequencing and microarray methods provide expression levels for tens of thousands of genes. An exhaustive evaluation of these datasets would result in tens of billions of tests for hundreds or thousands of samples, quickly outreaching the computing capacity of a desktop computer and requiring larger workstations, clusters, or cloud computing [<xref ref-type="bibr" rid="CR9">9</xref>]. Future datasets will likely include more loci for evaluation and larger sample sizes. This need for computational resources will also require improvements in efficiency. Graphical processing units (GPUs) have provided major improvements in computation efficiency (i.e., runtime) for many bioinformatic software tools [<xref ref-type="bibr" rid="CR10">10</xref>]. Readily available open source libraries implement numerous general-purpose methods and mathematical primitives that allow for major improvements in computational efficiency at relatively lower costs as compared to CPUs [<xref ref-type="bibr" rid="CR11">11</xref>].</p>
    <p id="Par20">Given the analytic utility of evaluating for eQTMs to identify relationships between gene expression and epigenetic changes, a lack of an available open-source tool to implement an eQTM analysis, and the performance benefits of utilizing a GPU, the objectives of this project were to develop an open source, general-use tool for eQTM mapping and evaluate for performance increases of a GPU implementation. Here, we present the Torch-eCpG tool (tecpg).</p>
  </sec>
  <sec id="Sec2">
    <title>Implementation</title>
    <sec id="Sec3">
      <title>Association analyses</title>
      <p id="Par21">Two methods are available to test for the associations between CpG methylation and gene expression (eCpGs). First, a Pearson correlation can be computed between the methylation level and gene expression level. Second, a multivariate linear regression (MLR) method can model the relationship between gene expression and methylation level while including while adjusting for covariates (e.g., age, batch, cell type composition, population structure). Although more complex mapping approaches are available [<xref ref-type="bibr" rid="CR3">3</xref>], this approach is commonly used and the methods are easily accessible [<xref ref-type="bibr" rid="CR4">4</xref>, <xref ref-type="bibr" rid="CR8">8</xref>, <xref ref-type="bibr" rid="CR12">12</xref>]. Future versions of the tool may include additional mapping approaches. We tested for an association between methylation at CpG <italic>j</italic> and the expression level of transcript <italic>k</italic>, by fitting the model<disp-formula id="Equ1"><label>1</label><alternatives><tex-math id="M1">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$y_{k} = M_{j} a_{jk} + Xb_{jk} ,\;\; \, j = 1,..,n,\;\;k = 1,..,m$$\end{document}</tex-math><mml:math id="M2" display="block"><mml:mrow><mml:msub><mml:mi>y</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>M</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:msub><mml:mi>a</mml:mi><mml:mrow><mml:mi mathvariant="italic">jk</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mi>X</mml:mi><mml:msub><mml:mi>b</mml:mi><mml:mrow><mml:mi mathvariant="italic">jk</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mspace width="0.277778em"/><mml:mspace width="0.277778em"/><mml:mspace width="0.166667em"/><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mo>,</mml:mo><mml:mi>n</mml:mi><mml:mo>,</mml:mo><mml:mspace width="0.277778em"/><mml:mspace width="0.277778em"/><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mo>,</mml:mo><mml:mi>m</mml:mi></mml:mrow></mml:math><graphic xlink:href="12859_2024_5670_Article_Equ1.gif" position="anchor"/></alternatives></disp-formula>where <italic>y</italic><sub><italic>k</italic></sub> is a vector of log expression levels at gene <italic>k</italic> with length <italic>m</italic>, <italic>M</italic><sub><italic>j</italic></sub> is a size <italic>n</italic> vector of methylation values (i.e., Beta scores) at CpG <italic>j</italic>, <italic>m</italic> is the number of covariates, and <italic>X</italic> is a <italic>n</italic> × <italic>m</italic> matrix of covariates.</p>
      <p id="Par22">Given the PyTorch toolkit does not currently include a function to estimate the cumulative distribution function (CDF) for the Student’s t-distribution, and thus it is not easily possible to compute a p-value based on the t-distribution, we used a Gaussian distribution CDF to estimate p-values. The Gaussian distribution converges to the Student’s t-distribution as the degrees of freedom (e.g., the number of samples) increases. For smaller sample sizes (e.g., &lt; 20 samples) the difference between the t and the Gaussian distributions may have a noticeable impact. The MLR feature of tecpg is optimized to increase performance for large input datasets. Optimizations include the minimization of repeated calculations, parallelizing tasks, memory use management, data chunking, and selective use of tensors on the GPU.</p>
      <p id="Par23">Gene expression, methylation, and phenotypic (i.e., covariate) data are provided as comma-separated value (CSV) files. Gene expression and methylation data are provided with samples in columns and loci in rows. Sample metadata (i.e., phenotypic) are provided with the covariate in the columns and samples in rows. Gene and methylation loci genomic region annotations are provided as browser extensible data (BED) files [<xref ref-type="bibr" rid="CR13">13</xref>]. Examples of annotation files are provided for the HumanMethylation450 (n = 349,220 CpG loci) and HumanHT-12 (n = 39,353 expression probes) arrays. For evaluation, the tool can either create simulated random data (i.e., `tecpg data dummy`) or download and format data from the Grady Trauma Project (GTP) [Gene Expression Omnibus (GEO) accession numbers GSE72680, GSE58137] (i.e., `tecpg data gtp`).</p>
      <p id="Par24">Four eCpG mappings modalities are implemented:<list list-type="bullet"><list-item><p id="Par25"><italic>Cis</italic>-eCPG: associations between all methylation loci-gene expression pairs within a specified window (default + 1 Mb) around the transcript start site for genes.</p></list-item><list-item><p id="Par26"><italic>Distal</italic>-eCpG: associations between all methylation loci-gene expression pairs outside of a specified window (default 50 Kb) from the transcript start site for genes, but on the same chromosome.</p></list-item><list-item><p id="Par27"><italic>Trans</italic>-eCpG: associations between all methylation loci-gene expression pairs. The computation is performed for each chromosome using methylation loci on all other chromosomes. To reduce output size, only associations below a given <italic>p</italic> value threshold (default 1 × 10<sup>–5</sup>) are stored.</p></list-item><list-item><p id="Par28"><italic>All</italic>-<italic>by-all</italic>: associations between all methylation loci-gene expression pairs across all regions. To reduce output size, only associations below a given <italic>p</italic> value threshold (default 1 × 10<sup>–5</sup>) are stored.</p></list-item></list></p>
      <p id="Par29">Numerous user-friendly features are provided. The tool will attempt to automatically detect a CUDA supported GPU. If a supported GPU is not available, or upon user request, the analyses will be performed using a CPU. The number of CPU threads is configurable and threaded CPU processing is available. In the case where data sizes exceed the CPU or GPU memory, the tool can be set to batch the analyses into chunks of gene expression and/or methylation data. Torch-eCpG can chunk the data for analysis as requested by the user through the settings. For users needing guidance to select settings, an option is available to estimate the number of gene expression loci per chunk. Chunking of the data was used for the evaluations described below. Finally, to limit the size of the output and associated time writing the file out, the user can set a p-value threshold to filter the reported analyses and can select the columns of the MLR analyses to report.</p>
    </sec>
    <sec id="Sec4">
      <title>Evaluation</title>
      <p id="Par30">To evaluate for the replicability of the regression analyses implemented in tecpg, we compared our regression analyses with similar analyses using the cor() and lm() functions in the stat package in R. To benchmark tecpg, we compared <italic>cis</italic>-eCpG, <italic>distal</italic>-eCpG and <italic>trans</italic>-eCpG mapping performance with and without a GPU. For CPU-based comparisons of the individual regions, computations were limited to a single core [<xref ref-type="bibr" rid="CR11">11</xref>]. We also evaluated tecpg performance using a range of CPU core counts (i.e., 1, 2, 4, 8, 16, 24). These analyses used a dataset of whole blood samples collected from 333 participants (76% female) aged 18–78 years in the GTP (GSE72680, GSE58137). To facilitate the evaluation of the scaling performance of the GPU implementation when mapping <italic>trans</italic>-eCpGs across a wide range of eCpG counts, we sampled with replacement from the GTP dataset to obtain a sample size of 1000. All tecpg benchmarks were conducted on a physical server running Linux having 28 Xeon cores (2.3 GHz), 256 GB CPU memory, and a A2 GPU with 16 GB of memory (Nvidia Corporation, Santa Clara, CA).</p>
    </sec>
  </sec>
  <sec id="Sec5">
    <title>Results and discussion</title>
    <p id="Par31">To provide an open-source tool for eQTM mapping, we developed the Torch-eCpG software package. To evaluate the reproducibility of the linear regression analysis, we compared our results with those implemented in the lm() function in the stats package in R. As shown in Fig. <xref rid="Fig1" ref-type="fig">1</xref>, our implementation of the linear regression demonstrates high reproducibility.<fig id="Fig1"><label>Fig. 1</label><caption><p>Comparisons of the first 1000 CpG-transcript pair linear regression analyses results between tecpg and lm() function in the stats package in R for a simulated dataset generated by sampling with replacement (n = 1000 samples). Simulated patient data was generated from real patient data in the Grady Trauma Project</p></caption><graphic xlink:href="12859_2024_5670_Fig1_HTML" id="MO1"/></fig></p>
    <p id="Par32">For tecpg benchmarking, we evaluated eQTM mapping using the CPU and GPU implementation in tecgp for 300 patients from the GTP patient dataset (422,442 methylation loci and 17,653 genes). Across the mapping modalities, the GPU outperformed the CPU analysis by up to 18x. Our implementation of the <italic>cis-</italic>eCpG mapping was 1.4 × faster on the GPU than that of the CPU (Fig. <xref rid="Fig2" ref-type="fig">2</xref>A). For <italic>distal-</italic>eCpG mapping, our implementation was 5 × faster on the GPU (Fig. <xref rid="Fig2" ref-type="fig">2</xref>B). Finally, for <italic>trans</italic>-eCpG mapping, our implementation was 18 × faster on the GPU (Fig. <xref rid="Fig2" ref-type="fig">2</xref>C). In terms of tecpg using additional cores, we found that major incremental improvements were realized by increasing the CPU core count up to 8, after which the gains were minimal (Fig. <xref rid="Fig3" ref-type="fig">3</xref>). Although the CPU performance did improve with additional cores, the GPU implementation was still 2 × faster than the 24-core CPU implementation.<fig id="Fig2"><label>Fig. 2</label><caption><p>Performance of GPU implementations for eQTM mapping. Comparison of runtimes for tecpg analyses on CPU and GPU for <bold>A</bold>
<italic>cis</italic>-eCpG, <bold>B</bold>
<italic>distal</italic>-eCpG, and <bold>C</bold>
<italic>trans</italic>-eCpG. The analyses evaluated 340 patients from the Grady Trauma Project dataset and included 422,442 methylation loci and 17,653 genes</p></caption><graphic xlink:href="12859_2024_5670_Fig2_HTML" id="MO2"/></fig><fig id="Fig3"><label>Fig. 3</label><caption><p>CPU runtimes for tecpg using 1, 2, 4, 8, 16, and 24 CPU cores. The analyses evaluated 340 patients from the Grady Trauma Project dataset and included 422,442 methylation loci and 17,653 genes</p></caption><graphic xlink:href="12859_2024_5670_Fig3_HTML" id="MO3"/></fig></p>
    <p id="Par33">We found tecpg scales linearly across a wide range of methylation loci for a reasonably large sample size (n = 1000 patients) (Fig. <xref rid="Fig4" ref-type="fig">4</xref>). In addition, the total time to evaluate 1000 patients for whole transcriptome (2 × 10<sup>4</sup> genes) and whole methylome array data (8.5 × 10<sup>5</sup>) was &lt; 15 h. The short time needed to evaluate a dataset sized to the largest currently available methylation array (i.e., Infinium MethylationEPIC) highlights the utility of this tool to evaluate eQTM mapping of dataset of realistic size. The linear scaling demonstrates the memory efficiency of the chunking of genes and CpG loci for analysis and is concordant with the embarrassingly parallel nature of this analysis (i.e., all gene × CpG loci comparisons are independent). This efficiency and scaling suggest the tool will be useful for larger datasets in the future (e.g., &gt; 10,000 patients) (Table <xref rid="Tab1" ref-type="table">1</xref>, Fig. <xref rid="Fig5" ref-type="fig">5</xref>) and is accessible to perform on smaller hardware setups (i.e., GPUs with smaller memory specifications). <fig id="Fig4"><label>Fig. 4</label><caption><p>GPU runtime of tecpg for 1000 simulated patient samples for 20,000 genes and 20 × 10<sup>3</sup>, 100 × 10<sup>3</sup>, 250 × 10<sup>3</sup>, 450 × 10<sup>3</sup> and 850 × 10<sup>3</sup> CpG loci. Simulated patient data was generated from real patient data in the Grady Trauma Project. Data chunking was performed using 100 genes and 100,000 CpGs using 6.2 GB of GPU memory</p></caption><graphic xlink:href="12859_2024_5670_Fig4_HTML" id="MO5"/></fig><table-wrap id="Tab1"><label>Table 1</label><caption><p>Runtime performance of Torch eCpG GPU implementation for the indicated number of samples, CpG loci, and gene expression loci. Data are plotted in Fig. <xref rid="Fig5" ref-type="fig">5</xref></p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left">Number of samples</th><th align="left">Number of CpG loci</th><th align="left">Number of genes</th><th align="left">Runtime (minutes)</th></tr></thead><tbody><tr><td align="left">100</td><td align="left">25,000</td><td char="," align="char">40,000</td><td char="." align="char">6.29</td></tr><tr><td align="left">100</td><td align="left">500,000</td><td char="," align="char">40,000</td><td char="." align="char">121.42</td></tr><tr><td align="left">100</td><td align="left">1,000,000</td><td char="," align="char">40,000</td><td char="." align="char">241.24</td></tr><tr><td align="left">100</td><td align="left">25,000</td><td char="," align="char">20,000</td><td char="." align="char">3.06</td></tr><tr><td align="left">100</td><td align="left">500,000</td><td char="," align="char">20,000</td><td char="." align="char">62.04</td></tr><tr><td align="left">100</td><td align="left">1,000,000</td><td char="," align="char">20,000</td><td char="." align="char">123.80</td></tr><tr><td align="left">1000</td><td align="left">25,000</td><td char="," align="char">40,000</td><td char="." align="char">16.48</td></tr><tr><td align="left">1000</td><td align="left">500,000</td><td char="," align="char">40,000</td><td char="." align="char">327.85</td></tr><tr><td align="left">1000</td><td align="left">1,000,000</td><td char="," align="char">40,000</td><td char="." align="char">654.57</td></tr><tr><td align="left">1000</td><td align="left">25,000</td><td char="," align="char">20,000</td><td char="." align="char">8.35</td></tr><tr><td align="left">1000</td><td align="left">500,000</td><td char="," align="char">20,000</td><td char="." align="char">167.03</td></tr><tr><td align="left">1000</td><td align="left">1,000,000</td><td char="," align="char">20,000</td><td char="." align="char">334.29</td></tr><tr><td align="left">10,000</td><td align="left">25,000</td><td char="," align="char">40,000</td><td char="." align="char">147.18</td></tr><tr><td align="left">10,000</td><td align="left">500,000</td><td char="," align="char">40,000</td><td char="." align="char">2926.99</td></tr><tr><td align="left">10,000</td><td align="left">1,000,000</td><td char="," align="char">40,000</td><td char="." align="char">5892.98</td></tr><tr><td align="left">10,000</td><td align="left">25,000</td><td char="," align="char">20,000</td><td char="." align="char">73.57</td></tr><tr><td align="left">10,000</td><td align="left">500,000</td><td char="," align="char">20,000</td><td char="." align="char">1470.24</td></tr><tr><td align="left">10,000</td><td align="left">1,000,000</td><td char="," align="char">20,000</td><td char="." align="char">2937.30</td></tr></tbody></table></table-wrap><fig id="Fig5"><label>Fig. 5</label><caption><p>Runtime performance of Torch eCpG GPU implementation for the indicated number of samples, CpG loci, and gene expression loci. <bold>A</bold> n = 100 and n = 1000 samples. <bold>B</bold> n = 100, n = 1000, n = 10,000 samples. Simulated patient data was generated from real patient data in the Grady Trauma Project</p></caption><graphic xlink:href="12859_2024_5670_Fig5_HTML" id="MO4"/></fig></p>
    <p id="Par34">Given the increased availability of whole genome bisulfite sequencing (WGBS) data, we fit a linear model to the range of methylation loci shown in Fig. <xref rid="Fig4" ref-type="fig">4</xref> to estimate the time it would take to map larger datasets. With this model, we estimate it would take 6.35 days (9146.04 min) to complete an analysis of 28 million CpG loci for 20,000 genes from 10,000 patients. To evaluate this estimate empirically, we simulated a dataset of 28 million CpG loci for 20,000 genes from 10,000 patients. The major resource limitation to the analysis was the size of the input data, which is limited by the available CPU memory. The maximum resident set size of dataset with 100,000 and 1 million CpGs was approximately 4.8 GB and 20 GB of RAM, respectively. Larger CpG datasets (e.g., all 28 million CpGs) required memory resources outside the assumptions of a reasonably sized workstation (i.e., &gt; 32 GB RAM). To manage the CPU memory usage to store the datasets in memory prior to analysis, the total dataset was split into smaller pieces, with each split of data using approximately 20 GB of RAM to load. To manage the GPU memory during analysis, we set the chunking sizes of 100 genes and 100,000 CpGs. The GPU memory usage was 6.2 GB. With this approach, the analysis of a simulated WGBS dataset completed in 6.75 days, similar to our estimated time for completion.</p>
  </sec>
  <sec id="Sec6">
    <title>Conclusions</title>
    <p id="Par35">Torch-eCpG is the first freely available open-source tool to perform eQTM mapping. It provides a scalable and high-performance implementation that supports GPU enabled systems. By reducing computing time the tool offers cost-savings on shared systems (e.g., clusters) or cloud-based computing resources that charge by units of time. This tool allows for individual research labs with limited computational resources to perform analyses on affordable computer equipment or cloud-based virtual machines.</p>
    <sec id="Sec7">
      <title>Availability and requirements</title>
      <p id="Par36">
        <list list-type="bullet">
          <list-item>
            <p id="Par37">Project name: Torch-eCpG</p>
          </list-item>
          <list-item>
            <p id="Par38">Project home page: <ext-link ext-link-type="uri" xlink:href="http://www.github.com/kordk/torch-ecpg">http://www.github.com/kordk/torch-ecpg</ext-link></p>
          </list-item>
          <list-item>
            <p id="Par39">Operating system(s): Platform independent</p>
          </list-item>
          <list-item>
            <p id="Par40">Programming language: Python 3.10 or higher</p>
          </list-item>
          <list-item>
            <p id="Par41">Other requirements: click ~= 8.0.3, colorama ~= 0.4.4, matplotlib ~= 3.5.1, numpy ~= 1.24.1, pandas ~= 1.3.5, psutil ~= 5.9.4, requests ~  = 2.26.0, scipy ~= 1.10.0, setuptools ~= 63.3.0, torch ~= 1.13.1 + cu116</p>
          </list-item>
          <list-item>
            <p id="Par42">License: BSD-3-Clause</p>
          </list-item>
          <list-item>
            <p id="Par43">Any restrictions to use by non-academics: license needed.</p>
          </list-item>
        </list>
      </p>
    </sec>
  </sec>
</body>
<back>
  <glossary>
    <title>Abbreviations</title>
    <def-list>
      <def-item>
        <term>BED</term>
        <def>
          <p id="Par4">Browser extensible data</p>
        </def>
      </def-item>
      <def-item>
        <term>CDF</term>
        <def>
          <p id="Par5">Cumulative distribution function</p>
        </def>
      </def-item>
      <def-item>
        <term>CpG</term>
        <def>
          <p id="Par6">Cytosine phosphate guanine</p>
        </def>
      </def-item>
      <def-item>
        <term>CPU</term>
        <def>
          <p id="Par7">Central processing unit</p>
        </def>
      </def-item>
      <def-item>
        <term>CSV</term>
        <def>
          <p id="Par8">Comma separated value</p>
        </def>
      </def-item>
      <def-item>
        <term>DNA</term>
        <def>
          <p id="Par9">Deoxyribonucleic acid</p>
        </def>
      </def-item>
      <def-item>
        <term>eCpG</term>
        <def>
          <p id="Par10">Expression associated CpG</p>
        </def>
      </def-item>
      <def-item>
        <term>eQTM</term>
        <def>
          <p id="Par11">Expression quantitative trait methylation</p>
        </def>
      </def-item>
      <def-item>
        <term>GEO</term>
        <def>
          <p id="Par12">Gene expression omnibus</p>
        </def>
      </def-item>
      <def-item>
        <term>GB</term>
        <def>
          <p id="Par13">Gigabyte</p>
        </def>
      </def-item>
      <def-item>
        <term>GHz</term>
        <def>
          <p id="Par14">Gigahertz</p>
        </def>
      </def-item>
      <def-item>
        <term>GPU</term>
        <def>
          <p id="Par15">Graphical processing unit</p>
        </def>
      </def-item>
      <def-item>
        <term>GTP</term>
        <def>
          <p id="Par16">Grady trauma project</p>
        </def>
      </def-item>
    </def-list>
  </glossary>
  <fn-group>
    <fn>
      <p>
        <bold>Publisher's Note</bold>
      </p>
      <p>Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p>
    </fn>
  </fn-group>
  <ack>
    <title>Acknowledgements</title>
    <p>Not applicable.</p>
  </ack>
  <notes notes-type="author-contribution">
    <title>Author contributions</title>
    <p>KMK originated the idea and developed the initial project plan. KMK and LB outlined and planned the tool development. LB and KMK developed the Torch-eCpG tool. All authors were involved in the planning and testing of Torch-eCpG. RR ran the simulations. KMK and RR prepared and reviewed the tables and figures. KMK prepared and reviewed the manuscript. All authors reviewed and edited the manuscript.</p>
  </notes>
  <notes notes-type="funding-information">
    <title>Funding</title>
    <p>This work was partially supported by an NIH NCI MERIT award (R37, CA233774, PI: Kober) and Cancer Center Support Grant (P30, CA082103, Co-I: Olshen).</p>
  </notes>
  <notes notes-type="data-availability">
    <title>Availability of data and materials</title>
    <p>The datasets analyzed in this study are publicly available in the Gene Expression Omnibus repository (<ext-link ext-link-type="uri" xlink:href="https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE72680">https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE72680</ext-link> and <ext-link ext-link-type="uri" xlink:href="https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE58137">https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE58137</ext-link>).</p>
  </notes>
  <notes>
    <title>Declarations</title>
    <notes id="FPar1">
      <title>Ethics approval and consent to participate</title>
      <p id="Par44">Not applicable.</p>
    </notes>
    <notes id="FPar2">
      <title>Consent for publication</title>
      <p id="Par45">Not applicable.</p>
    </notes>
    <notes id="FPar3" notes-type="COI-statement">
      <title>Competing interests</title>
      <p id="Par46">The authors have no competing interests.</p>
    </notes>
  </notes>
  <ref-list id="Bib1">
    <title>References</title>
    <ref id="CR1">
      <label>1.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Feinberg</surname>
            <given-names>AP</given-names>
          </name>
        </person-group>
        <article-title>The key role of epigenetics in human disease prevention and mitigation</article-title>
        <source>N Engl J Med</source>
        <year>2018</year>
        <volume>378</volume>
        <issue>14</issue>
        <fpage>1323</fpage>
        <lpage>1334</lpage>
        <pub-id pub-id-type="doi">10.1056/NEJMra1402513</pub-id>
        <?supplied-pmid 29617578?>
        <pub-id pub-id-type="pmid">29617578</pub-id>
      </element-citation>
    </ref>
    <ref id="CR2">
      <label>2.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lappalainen</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Greally</surname>
            <given-names>JM</given-names>
          </name>
        </person-group>
        <article-title>Associating cellular epigenetic models with human phenotypes</article-title>
        <source>Nat Rev Genet</source>
        <year>2017</year>
        <volume>18</volume>
        <issue>7</issue>
        <fpage>441</fpage>
        <lpage>451</lpage>
        <pub-id pub-id-type="doi">10.1038/nrg.2017.32</pub-id>
        <?supplied-pmid 28555657?>
        <pub-id pub-id-type="pmid">28555657</pub-id>
      </element-citation>
    </ref>
    <ref id="CR3">
      <label>3.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kennedy</surname>
            <given-names>EM</given-names>
          </name>
          <name>
            <surname>Goehring</surname>
            <given-names>GN</given-names>
          </name>
          <name>
            <surname>Nichols</surname>
            <given-names>MH</given-names>
          </name>
          <name>
            <surname>Robins</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Mehta</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Klengel</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Eskin</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Smith</surname>
            <given-names>AK</given-names>
          </name>
          <name>
            <surname>Conneely</surname>
            <given-names>KN</given-names>
          </name>
        </person-group>
        <article-title>An integrated -omics analysis of the epigenetic landscape of gene expression in human blood cells</article-title>
        <source>BMC Genomics</source>
        <year>2018</year>
        <volume>19</volume>
        <issue>1</issue>
        <fpage>476</fpage>
        <pub-id pub-id-type="doi">10.1186/s12864-018-4842-3</pub-id>
        <?supplied-pmid 29914364?>
        <pub-id pub-id-type="pmid">29914364</pub-id>
      </element-citation>
    </ref>
    <ref id="CR4">
      <label>4.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ruiz-Arenas</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Hernandez-Ferrer</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Vives-Usano</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Mari</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Quintela</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Mason</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Cadiou</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Casas</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Andrusaityte</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Gutzkow</surname>
            <given-names>KB</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Identification of autosomal cis expression quantitative trait methylation (cis eQTMs) in children's blood</article-title>
        <source>Elife</source>
        <year>2022</year>
        <volume>11</volume>
        <fpage>e65310</fpage>
        <pub-id pub-id-type="doi">10.7554/eLife.65310</pub-id>
        <?supplied-pmid 35302492?>
        <pub-id pub-id-type="pmid">35302492</pub-id>
      </element-citation>
    </ref>
    <ref id="CR5">
      <label>5.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kim</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Forno</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Park</surname>
            <given-names>HJ</given-names>
          </name>
          <name>
            <surname>Xu</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Yan</surname>
            <given-names>Q</given-names>
          </name>
          <name>
            <surname>Boutaoui</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Acosta-Perez</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Canino</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>W</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Expression quantitative trait methylation analysis reveals methylomic associations with gene expression in childhood asthma</article-title>
        <source>Chest</source>
        <year>2020</year>
        <volume>158</volume>
        <issue>5</issue>
        <fpage>1841</fpage>
        <lpage>1856</lpage>
        <pub-id pub-id-type="doi">10.1016/j.chest.2020.05.601</pub-id>
        <?supplied-pmid 32569636?>
        <pub-id pub-id-type="pmid">32569636</pub-id>
      </element-citation>
    </ref>
    <ref id="CR6">
      <label>6.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Taylor</surname>
            <given-names>DL</given-names>
          </name>
          <name>
            <surname>Jackson</surname>
            <given-names>AU</given-names>
          </name>
          <name>
            <surname>Narisu</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Hemani</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Erdos</surname>
            <given-names>MR</given-names>
          </name>
          <name>
            <surname>Chines</surname>
            <given-names>PS</given-names>
          </name>
          <name>
            <surname>Swift</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Idol</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Didion</surname>
            <given-names>JP</given-names>
          </name>
          <name>
            <surname>Welch</surname>
            <given-names>RP</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Integrative analysis of gene expression, DNA methylation, physiological traits, and genetic variation in human skeletal muscle</article-title>
        <source>Proc Natl Acad Sci U S A</source>
        <year>2019</year>
        <volume>116</volume>
        <issue>22</issue>
        <fpage>10883</fpage>
        <lpage>10888</lpage>
        <pub-id pub-id-type="doi">10.1073/pnas.1814263116</pub-id>
        <?supplied-pmid 31076557?>
        <pub-id pub-id-type="pmid">31076557</pub-id>
      </element-citation>
    </ref>
    <ref id="CR7">
      <label>7.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Yu</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Cen</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>YA</given-names>
          </name>
          <name>
            <surname>Markowitz</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Shaw</surname>
            <given-names>TI</given-names>
          </name>
          <name>
            <surname>Tsai</surname>
            <given-names>KY</given-names>
          </name>
          <name>
            <surname>Conejo-Garcia</surname>
            <given-names>JR</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>X</given-names>
          </name>
        </person-group>
        <article-title>Tumor expression quantitative trait methylation screening reveals distinct CpG panels for deconvolving cancer immune signatures</article-title>
        <source>Cancer Res</source>
        <year>2022</year>
        <volume>82</volume>
        <issue>9</issue>
        <fpage>1724</fpage>
        <lpage>1735</lpage>
        <pub-id pub-id-type="doi">10.1158/0008-5472.CAN-21-3113</pub-id>
        <?supplied-pmid 35176128?>
        <pub-id pub-id-type="pmid">35176128</pub-id>
      </element-citation>
    </ref>
    <ref id="CR8">
      <label>8.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Komaki</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Shiwa</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Furukawa</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Hachiya</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Ohmomo</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Otomo</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Satoh</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Hitomi</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Sobue</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Sasaki</surname>
            <given-names>M</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>iMETHYL: an integrative database of human DNA methylation, gene expression, and genomic variation</article-title>
        <source>Hum Genome Var</source>
        <year>2018</year>
        <volume>5</volume>
        <fpage>18008</fpage>
        <pub-id pub-id-type="doi">10.1038/hgv.2018.8</pub-id>
        <?supplied-pmid 29619235?>
        <pub-id pub-id-type="pmid">29619235</pub-id>
      </element-citation>
    </ref>
    <ref id="CR9">
      <label>9.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Koppad</surname>
            <given-names>S</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Cloud computing enabled big multi-omics data analytics</article-title>
        <source>Bioinform Biol Insights</source>
        <year>2021</year>
        <volume>15</volume>
        <fpage>11779322211035921</fpage>
        <pub-id pub-id-type="doi">10.1177/11779322211035921</pub-id>
        <?supplied-pmid 34376975?>
        <pub-id pub-id-type="pmid">34376975</pub-id>
      </element-citation>
    </ref>
    <ref id="CR10">
      <label>10.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Nobile</surname>
            <given-names>MS</given-names>
          </name>
          <name>
            <surname>Cazzaniga</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Tangherloni</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Besozzi</surname>
            <given-names>D</given-names>
          </name>
        </person-group>
        <article-title>Graphics processing units in bioinformatics, computational biology and systems biology</article-title>
        <source>Brief Bioinform</source>
        <year>2017</year>
        <volume>18</volume>
        <issue>5</issue>
        <fpage>870</fpage>
        <lpage>885</lpage>
        <?supplied-pmid 27402792?>
        <pub-id pub-id-type="pmid">27402792</pub-id>
      </element-citation>
    </ref>
    <ref id="CR11">
      <label>11.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Taylor-Weiner</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Aguet</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Haradhvala</surname>
            <given-names>NJ</given-names>
          </name>
          <name>
            <surname>Gosai</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Anand</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Kim</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Ardlie</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Van Allen</surname>
            <given-names>EM</given-names>
          </name>
          <name>
            <surname>Getz</surname>
            <given-names>G</given-names>
          </name>
        </person-group>
        <article-title>Scaling computational genomics to millions of individuals with GPUs</article-title>
        <source>Genome Biol</source>
        <year>2019</year>
        <volume>20</volume>
        <issue>1</issue>
        <fpage>228</fpage>
        <pub-id pub-id-type="doi">10.1186/s13059-019-1836-7</pub-id>
        <?supplied-pmid 31675989?>
        <pub-id pub-id-type="pmid">31675989</pub-id>
      </element-citation>
    </ref>
    <ref id="CR12">
      <label>12.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hanson</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Cairns</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Sinha</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>Principled multi-omic analysis reveals gene regulatory mechanisms of phenotype variation</article-title>
        <source>Genome Res</source>
        <year>2018</year>
        <volume>28</volume>
        <issue>8</issue>
        <fpage>1207</fpage>
        <lpage>1216</lpage>
        <pub-id pub-id-type="doi">10.1101/gr.227066.117</pub-id>
        <?supplied-pmid 29898900?>
        <pub-id pub-id-type="pmid">29898900</pub-id>
      </element-citation>
    </ref>
    <ref id="CR13">
      <label>13.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kent</surname>
            <given-names>WJ</given-names>
          </name>
          <name>
            <surname>Sugnet</surname>
            <given-names>CW</given-names>
          </name>
          <name>
            <surname>Furey</surname>
            <given-names>TS</given-names>
          </name>
          <name>
            <surname>Roskin</surname>
            <given-names>KM</given-names>
          </name>
          <name>
            <surname>Pringle</surname>
            <given-names>TH</given-names>
          </name>
          <name>
            <surname>Zahler</surname>
            <given-names>AM</given-names>
          </name>
          <name>
            <surname>Haussler</surname>
            <given-names>D</given-names>
          </name>
        </person-group>
        <article-title>The human genome browser at UCSC</article-title>
        <source>Genome Res</source>
        <year>2002</year>
        <volume>12</volume>
        <issue>6</issue>
        <fpage>996</fpage>
        <lpage>1006</lpage>
        <pub-id pub-id-type="doi">10.1101/gr.229102</pub-id>
        <?supplied-pmid 12045153?>
        <pub-id pub-id-type="pmid">12045153</pub-id>
      </element-citation>
    </ref>
  </ref-list>
</back>
