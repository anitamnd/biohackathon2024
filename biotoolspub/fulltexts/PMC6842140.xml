<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName A++V2.4.dtd?>
<?SourceDTD.Version 2.4?>
<?ConverterInfo.XSLTName springer2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">BMC Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">BMC Bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>BMC Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="epub">1471-2105</issn>
    <publisher>
      <publisher-name>BioMed Central</publisher-name>
      <publisher-loc>London</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">6842140</article-id>
    <article-id pub-id-type="publisher-id">3182</article-id>
    <article-id pub-id-type="doi">10.1186/s12859-019-3182-x</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Software</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>VARUS: sampling complementary RNA reads from the sequence read archive</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0001-8696-0384</contrib-id>
        <name>
          <surname>Stanke</surname>
          <given-names>Mario</given-names>
        </name>
        <address>
          <email>mario.stanke@uni-greifswald.de</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Bruhn</surname>
          <given-names>Willy</given-names>
        </name>
        <address>
          <email>willy.bruhn@gmx.de</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Becker</surname>
          <given-names>Felix</given-names>
        </name>
        <address>
          <email>felix.becker@uni-greifswald.de</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Hoff</surname>
          <given-names>Katharina J.</given-names>
        </name>
        <address>
          <email>katharina.hoff@uni-greifswald.de</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <aff id="Aff1"><label>1</label><institution-wrap><institution-id institution-id-type="GRID">grid.5603.0</institution-id><institution>Institute for Mathematics and Computer Science, University of Greifswald, </institution></institution-wrap>Walther-Rathenau-Str. 47, Greifswald, 17489 Germany </aff>
      <aff id="Aff2"><label>2</label><institution-wrap><institution-id institution-id-type="GRID">grid.5603.0</institution-id><institution>Center for Functional Genomics of Microbes, University of Greifswald, </institution></institution-wrap>Felix-Hausdorff-Str. 8, Greifswald, 17489 Germany </aff>
    </contrib-group>
    <pub-date pub-type="epub">
      <day>8</day>
      <month>11</month>
      <year>2019</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>8</day>
      <month>11</month>
      <year>2019</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2019</year>
    </pub-date>
    <volume>20</volume>
    <elocation-id>558</elocation-id>
    <history>
      <date date-type="received">
        <day>18</day>
        <month>4</month>
        <year>2019</year>
      </date>
      <date date-type="accepted">
        <day>30</day>
        <month>10</month>
        <year>2019</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2019</copyright-statement>
      <license license-type="OpenAccess">
        <license-p><bold>Open Access</bold> This article is distributed under the terms of the Creative Commons Attribution 4.0 International License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted use, distribution, and reproduction in any medium, provided you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons license, and indicate if changes were made. The Creative Commons Public Domain Dedication waiver (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/publicdomain/zero/1.0/">http://creativecommons.org/publicdomain/zero/1.0/</ext-link>) applies to the data made available in this article, unless otherwise stated.</license-p>
      </license>
    </permissions>
    <abstract id="Abs1">
      <sec>
        <title>Background</title>
        <p id="Par1">Vast amounts of next generation sequencing RNA data has been deposited in archives, accompanying very diverse original studies. The data is readily available also for other purposes such as genome annotation or transcriptome assembly. However, selecting a subset of available experiments, sequencing runs and reads for this purpose is a nontrivial task and complicated by the inhomogeneity of the data.</p>
      </sec>
      <sec>
        <title>Results</title>
        <p id="Par2">This article presents the software VARUS that selects, downloads and aligns reads from NCBI’s Sequence Read Archive, given only the species’ binomial name and genome. VARUS automatically chooses runs from among all archived runs to randomly select subsets of reads. The objective of its online algorithm is to cover a large number of transcripts adequately when network bandwidth and computing resources are limited. For most tested species VARUS achieved both a higher sensitivity and specificity with a lower number of downloaded reads than when runs were manually selected. At the example of twelve eukaryotic genomes, we show that RNA-Seq that was sampled with VARUS is well-suited for fully-automatic genome annotation with BRAKER.</p>
      </sec>
      <sec>
        <title>Conclusions</title>
        <p id="Par3">With VARUS, genome annotation can be automatized to the extent that not even the selection and quality control of RNA-Seq has to be done manually. This introduces the possibility to have fully automatized genome annotation loops over potentially many species without incurring a loss of accuracy over a manually supervised annotation process.</p>
      </sec>
    </abstract>
    <kwd-group xml:lang="en">
      <title>Keywords</title>
      <kwd>Sample</kwd>
      <kwd>RNA-Seq</kwd>
      <kwd>Online algorithm</kwd>
      <kwd>Genome annotation</kwd>
    </kwd-group>
    <custom-meta-group>
      <custom-meta>
        <meta-name>issue-copyright-statement</meta-name>
        <meta-value>© The Author(s) 2019</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec id="Sec1">
    <title>Background</title>
    <p>A very large amount of next generation sequencing data is being deposited in public databases such as the sequence read archive (SRA) of the National Center for Biotechnology Information (NCBI) [<xref ref-type="bibr" rid="CR1">1</xref>] and the European nucleotide archive [<xref ref-type="bibr" rid="CR2">2</xref>]. At the time of writing, in March 2019, the SRA stored about 2.7·10<sup>16</sup> bp of raw sequencing data [<xref ref-type="bibr" rid="CR3">3</xref>]. This archived data provides experimental support for a very large number of manifold individual studies with very specific purposes for diverse species.</p>
    <p>A large fraction of this next generation sequencing data is RNA-Seq. In many studies, RNA has been sequenced from many replicates to draw statistical conclusions about the expression of transcripts [<xref ref-type="bibr" rid="CR4">4</xref>, <xref ref-type="bibr" rid="CR5">5</xref>]. Besides being a requirement for the reproducability of the original studies, a large value of the repository lies in the possibility to use the data for further studies including such with very different purposes than the original studies. One important reason to repurpose or use RNA-Seq is structural genome (re)annotation. Often a genome is annotated only after several transcriptomic studies of the same species have been conducted. There are many reasons for structural genome <italic>re</italic>annotation as well, e.g. the assembly has been improved, the genomes of further strains have been sequenced, to apply newer more accurate annotation methods, or annotate a large number of species’ genomes consistently.</p>
    <p>Taking <italic>all</italic> available RNA-Seq data for a species is often not feasible or counterproductive due to issues of the quality of data or alignments. The available data can be very abundant and redundant. For example, there are more than 30,000 RNA-Seq sequencing runs for <italic>Drosophila melanogaster</italic> (Table <xref rid="Tab1" ref-type="table">1</xref>) totaling to more than 41 tera base pairs. Further, quality control of sequencing runs is necessary as some genomic libraries are mislabeled as transcriptomic, contain adapter sequences or simply have low quality or alignability (see Table <xref rid="Tab1" ref-type="table">1</xref>). Therefore, it is sensible to choose a <italic>subset</italic> of all available reads for genome annotation. In doing this, the <italic>complementarity</italic> of chosen reads should be the aim in order to cover a large fraction of all transcripts of the organism, while keeping the burden on computation and data throughput manageable. Due to tissue- or condition-specific expression it may be necessary to use reads from many different sequencing runs from a diverse set of tissues or conditions. The meta data that the uploaders entered includes often an abstract of the study. The ’manual’ scan of these abstracts is tedious, is not always conclusive on tissue and condition and – even if so – does not allow to conclude which fraction of the transcripts may be expressed that have not yet been covered by other choices of sequencing runs. Further, the meta data could be incorrect.
<table-wrap id="Tab1"><label>Table 1</label><caption><p>Transcriptomic sequencing runs</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left">Species</th><th align="left">Transcriptomic runs in SRA</th><th align="left">≤ 5% of reads align uniquely</th></tr></thead><tbody><tr><td align="left"><italic>Anopheles gambiae</italic></td><td align="justify">597</td><td align="justify">15.5%</td></tr><tr><td align="left"><italic>Bombus terrestris</italic></td><td align="justify">357</td><td align="justify">6.4%</td></tr><tr><td align="left"><italic>Chlamydomonas reinhardtii</italic></td><td align="justify">1250</td><td align="justify">7.1%</td></tr><tr><td align="left"><italic>Cucumis sativus</italic></td><td align="justify">685</td><td align="justify">21.2%</td></tr><tr><td align="left"><italic>Drosophila melanogaster</italic></td><td align="justify">30207</td><td align="justify">22.8%</td></tr><tr><td align="left"><italic>Fragaria vesca</italic></td><td align="justify">170</td><td align="justify">10.6%</td></tr><tr><td align="left"><italic>Hymenolepis microstoma</italic></td><td align="justify">31</td><td align="justify">32.2%</td></tr><tr><td align="left"><italic>Medicago truncatula</italic></td><td align="justify">1252</td><td align="justify">9.2%</td></tr><tr><td align="left"><italic>Parasteatoda tepidariorum</italic></td><td align="justify">80</td><td align="justify">16.3%</td></tr><tr><td align="left"><italic>Prunus persica</italic></td><td align="justify">268</td><td align="justify">13.2%</td></tr><tr><td align="left"><italic>Saccharomyces cerevisiae</italic></td><td align="justify">16139</td><td align="justify">30.5%</td></tr><tr><td align="left"><italic>Verticillium dahliae</italic></td><td align="justify">30</td><td align="justify">40.0%</td></tr></tbody></table><table-wrap-foot><p>The second column shows the total number of RNA runs in SRA for the studied species. The last column shows the percentage of runs that were sampled by VARUS of which the first batch exhibited very low unique alignability, more specifically, at least 95% of reads aligned either not at all or multiple times using HISAT2. Such runs are subsequently ignored by VARUS</p></table-wrap-foot></table-wrap>
</p>
    <p>Ohta, Nakazato and Bono performed a large-scale assessment of reported read qualities in SRA, but did not align the reads at all [<xref ref-type="bibr" rid="CR6">6</xref>]. To our knowledge no previous software existed for automatically sampling reads from SRA from a maximal set of transcripts. A trivial random sampling from all libraries is not optimal as there may be large biases on the tissues or conditions that are represented in the archive.</p>
    <p>We present the new tool VARUS [<xref ref-type="bibr" rid="CR7">7</xref>] that automatically samples, downloads and aligns reads from all runs available on SRA for a given species. It implements an online algorithm that iteratively downloads small random samples from sequencing runs and thereby selects such runs for download of further samples that were estimated to complement best the previously downloaded reads and that have a relatively high percentage of reads or reads pairs that align uniquely to the genome. We tested VARUS on twelve genomes and compared the introns suggested by spliced alignments to those of the reference annotations. Compared with a manual selection of sequencing runs, VARUS achieves for most species a higher accuracy with a smaller number of downloaded reads than the manual selection.</p>
  </sec>
  <sec id="Sec2">
    <title>Implementation</title>
    <p>VARUS takes as input binomial (Latin) species names and corresponding genome FASTA files (see Fig. <xref rid="Fig1" ref-type="fig">1</xref>). A script (RunListRetriever.pl) queries the SRA for a list of IDs of all sequencing runs of molecule type <italic>RNA</italic> for the given species. The output, a ’run list’, is then used by VARUS to choose, download and align samples of RNA-Seq reads. The alignment is performed automatically, either with HISAT2 [<xref ref-type="bibr" rid="CR8">8</xref>] or STAR [<xref ref-type="bibr" rid="CR9">9</xref>]. For each species a single BAM formatted file with spliced alignments is output.
<fig id="Fig1"><label>Fig. 1</label><caption><p>VARUS flowchart. VARUS itself outputs a file VARUS.bam with all spliced alignments for each species in the input list. In this study, these alignments were used to annotate the genomes with BRAKER [<xref ref-type="bibr" rid="CR11">11</xref>]</p></caption><graphic xlink:href="12859_2019_3182_Fig1_HTML" id="MO1"/></fig>
</p>
    <p>The objective of VARUS is to collect samples of RNA-Seq reads from all available sequencing runs that together adequately cover as many transcribed RNAs as possible. We neither make prior assumptions on the expression profiles of runs nor do we require an (assembled) transcriptome as input. <italic>Adequate coverage</italic> is a vague formulation and certainly depends on the downstream application. We use the VARUS output for genome annotation, where we expect that the accuracy, with which an individual gene structure can be annotated, increases with its coverage when it is lowly covered, but the expected accuracy returns are diminishing with increasing coverage. Formally, our objective is to maximize a score
<disp-formula id="Equ1"><label>1</label><alternatives><tex-math id="M1">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$ S(\mathbf{c}) := \sum_{j=1}^{T} \ln(1+c_{j}) \to \max.   $$ \end{document}</tex-math><mml:math id="M2"><mml:mi>S</mml:mi><mml:mo>(</mml:mo><mml:mi mathvariant="bold">c</mml:mi><mml:mo>)</mml:mo><mml:mo>:</mml:mo><mml:mo>=</mml:mo><mml:munderover><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:munderover><mml:mo>ln</mml:mo><mml:mo>(</mml:mo><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo><mml:mo>→</mml:mo><mml:mo>max</mml:mo><mml:mi>.</mml:mi></mml:math><graphic xlink:href="12859_2019_3182_Article_Equ1.gif" position="anchor"/></alternatives></disp-formula></p>
    <p>Here, the <italic>transcribed units</italic> are numbered from 1 to <italic>T</italic>, <italic>c</italic><sub><italic>j</italic></sub> is the count of aligned reads or read pairs from transcribed unit <italic>j</italic> and <bold>c</bold>=(<italic>c</italic><sub>1</sub>,…,<italic>c</italic><sub><italic>T</italic></sub>). The logarithm was chosen to reflect diminishing returns of additional coverage for genome annotation accuracy. As we do not know the set of all transcribed RNAs themselves in our application setting, we use genome tiles (of default size 5Kb) as proxy for transcribed units. Admittedly, such tiles may not be expressed at all or may contain multiple genes. However, the idea is that the similarity of expression profiles from different runs is approximated sufficiently using whole-genome tile coverages for purposes of annotation.</p>
    <p>VARUS implements a heuristic online algorithm to approximate above goal step by step. If <bold>c</bold> is the current vector of read counts for all transcribed units, the next batch of <italic>b</italic> reads (default <italic>b</italic>=50,000) to download and align are chosen from run
<disp-formula id="Equ2"><label>2</label><alternatives><tex-math id="M3">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$ r^{*} = \underset{1\le r\le R}{\text{argmax}} \; S(\mathbf{c} + b\cdot \hat{q}_{r} \hat{\mathbf{p}}_{r}).   $$ \end{document}</tex-math><mml:math id="M4"><mml:msup><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:munder><mml:mrow><mml:mtext>argmax</mml:mtext></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>≤</mml:mo><mml:mi>r</mml:mi><mml:mo>≤</mml:mo><mml:mi>R</mml:mi></mml:mrow></mml:munder><mml:mspace width="2.77626pt"/><mml:mi>S</mml:mi><mml:mo>(</mml:mo><mml:mi mathvariant="bold">c</mml:mi><mml:mo>+</mml:mo><mml:mi>b</mml:mi><mml:mo>·</mml:mo><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>q</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold">p</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo><mml:mi>.</mml:mi></mml:math><graphic xlink:href="12859_2019_3182_Article_Equ2.gif" position="anchor"/></alternatives></disp-formula></p>
    <p>Here, the available runs are numbered from 1 to <italic>R</italic>, <inline-formula id="IEq1"><alternatives><tex-math id="M5">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\hat {\mathbf {p}}_{r} \in [0,1]^{T}$\end{document}</tex-math><mml:math id="M6"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold">p</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mo>∈</mml:mo><mml:msup><mml:mrow><mml:mo>[</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo>]</mml:mo></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msup></mml:math><inline-graphic xlink:href="12859_2019_3182_Article_IEq1.gif"/></alternatives></inline-formula> is the parameter vector of a multinomial distribution that is an estimate of the distribution on 1..<italic>T</italic> of a randomly drawn read from the <italic>r</italic>-th run. <inline-formula id="IEq2"><alternatives><tex-math id="M7">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\hat {q}_{r}$\end{document}</tex-math><mml:math id="M8"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>q</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12859_2019_3182_Article_IEq2.gif"/></alternatives></inline-formula> is an estimate of alignment quality, a weighted sum of the fraction of uniquely alignable and spliced reads. Ties occur – in particular for all runs of which no reads have been downloaded yet at all – and are broken randomly with a bias towards longer average read lengths. In (<xref rid="Equ2" ref-type="">2</xref>) the next batch is chosen greedily from a run so as to maximize the score of the expected count vector after the choice, <inline-formula id="IEq3"><alternatives><tex-math id="M9">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\mathbf {c} + b\cdot \hat {q}_{r} \hat {\mathbf {p}}_{r}$\end{document}</tex-math><mml:math id="M10"><mml:mi mathvariant="bold">c</mml:mi><mml:mo>+</mml:mo><mml:mi>b</mml:mi><mml:mo>·</mml:mo><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>q</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold">p</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12859_2019_3182_Article_IEq3.gif"/></alternatives></inline-formula>.</p>
    <p>The distribution <inline-formula id="IEq4"><alternatives><tex-math id="M11">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\hat {\mathbf {p}}_{r}$\end{document}</tex-math><mml:math id="M12"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold">p</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12859_2019_3182_Article_IEq4.gif"/></alternatives></inline-formula> over transcribed units is estimated from values <inline-formula id="IEq5"><alternatives><tex-math id="M13">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$c_{j}^{r}$\end{document}</tex-math><mml:math id="M14"><mml:msubsup><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="12859_2019_3182_Article_IEq5.gif"/></alternatives></inline-formula>, the current count of aligned reads or read pairs from run <italic>r</italic> mapping to transcribed unit <italic>j</italic>. Naturally, this estimate is not possible or accurate when the number of reads sampled from run <italic>r</italic> is 0 or small. Therefore, we add pseudocounts and use the estimate
<disp-formula id="Equ3"><label>3</label><alternatives><tex-math id="M15">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$ \hat{p}_{r}[j] \propto c_{j}^{r} + \lambda \cdot T \cdot \bar{p} [j] + a.  $$ \end{document}</tex-math><mml:math id="M16"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mo>[</mml:mo><mml:mi>j</mml:mi><mml:mo>]</mml:mo><mml:mo>∝</mml:mo><mml:msubsup><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msubsup><mml:mo>+</mml:mo><mml:mi>λ</mml:mi><mml:mo>·</mml:mo><mml:mi>T</mml:mi><mml:mo>·</mml:mo><mml:mover accent="true"><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mo>¯</mml:mo></mml:mover><mml:mo>[</mml:mo><mml:mi>j</mml:mi><mml:mo>]</mml:mo><mml:mo>+</mml:mo><mml:mi>a.</mml:mi></mml:math><graphic xlink:href="12859_2019_3182_Article_Equ3.gif" position="anchor"/></alternatives></disp-formula></p>
    <p>Here, <italic>a</italic> is a general pseudocount, chosen as 1 by default, the weight <italic>λ</italic> was chosen as 10 and <inline-formula id="IEq6"><alternatives><tex-math id="M17">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\bar {p} [j] = \sum _{r} c_{j}^{r} / \sum _{r,i} c_{i}^{r}$\end{document}</tex-math><mml:math id="M18"><mml:mover accent="true"><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mo>¯</mml:mo></mml:mover><mml:mo>[</mml:mo><mml:mi>j</mml:mi><mml:mo>]</mml:mo><mml:mo>=</mml:mo><mml:munder><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:munder><mml:msubsup><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msubsup><mml:mo>/</mml:mo><mml:munder><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>r</mml:mi><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:munder><mml:msubsup><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="12859_2019_3182_Article_IEq6.gif"/></alternatives></inline-formula> is the relative frequency of transcript unit <italic>j</italic><italic>over all sampled batches</italic>. Note that VARUS does not obtain samples from all runs when maxBatches&lt;<italic>R</italic>. The distribution estimates for the runs yet unsampled is similar to the overall observed relative frequency <inline-formula id="IEq7"><alternatives><tex-math id="M19">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\bar {\mathbf {p}}$\end{document}</tex-math><mml:math id="M20"><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold">p</mml:mi></mml:mrow><mml:mo>¯</mml:mo></mml:mover></mml:math><inline-graphic xlink:href="12859_2019_3182_Article_IEq7.gif"/></alternatives></inline-formula> if <italic>λ</italic>≫<italic>a</italic>. <inline-formula id="IEq8"><alternatives><tex-math id="M21">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\hat {p}_{r}$\end{document}</tex-math><mml:math id="M22"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12859_2019_3182_Article_IEq8.gif"/></alternatives></inline-formula> is normalized, so that <inline-formula id="IEq9"><alternatives><tex-math id="M23">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\sum _{j}\hat {p}_{r}[j]=1$\end{document}</tex-math><mml:math id="M24"><mml:munder><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:munder><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mo>[</mml:mo><mml:mi>j</mml:mi><mml:mo>]</mml:mo><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:math><inline-graphic xlink:href="12859_2019_3182_Article_IEq9.gif"/></alternatives></inline-formula>.</p>
    <p>When a run for downloading the next batch of reads has been chosen, VARUS calls fastq-dump which allows to download a range of consecutive ’spots’ from a specified run. VARUS keeps track of the set of all batches of a run that have been downloaded previously, so that eventually all reads would be downloaded exactly once. However, VARUS downloads (at most) only a fixed number of batches (here mostly maxBatches=1000).</p>
  </sec>
  <sec id="Sec3" sec-type="results">
    <title>Results</title>
    <sec id="Sec4">
      <title>Data sets</title>
      <p>We tested VARUS on the twelve species listed in Table <xref rid="Tab1" ref-type="table">1</xref>, which include model organisms with much data as well as other organisms with relatively little data. Table <xref rid="Tab1" ref-type="table">1</xref> also shows that 6%-40% of sequencing runs do not satisfy our requirements for quality: At least 5% of reads needed to align uniquely to the genome using HISAT2. Paired libraries were thereby handled accordingly. For command lines see Additional file <xref rid="MOESM1" ref-type="media">1</xref>. The reasons for failing even these weak criteria are diverse. They include the insufficiency of the alignment program for the sequencing platform, but also inappropriate data for that purpose such as miRNA sequencing runs, a mislabeled source species and very short reads. An example of the latter is <italic>S. cerevisiae</italic>, where 13% of the sampled runs had at least one out of two (’paired’) sequence files with an average read length of ≤10 base pairs. Further we found cases where genomic libraries were clearly mislabeled as transcriptomic.</p>
      <p>We compared VARUS to a selection procedure in which a person browses the SRA archive and selects and chooses sequencing runs for download. We refer to this as the <italic>manual</italic> selection method. Afterwards the alignment against the genome is performed in the same way as in VARUS. Sequencing runs that appeared to be of low alignability were discarded and not counted towards the number of downloaded reads. This is to the benefit of the manual method as all downloaded reads are counted in the VARUS analysis. The manual selection gave preference to long paired reads from the Illumina platform (e.g. 2×150 bp) that were from different experiments and different tissues. The interpretation of the natural language description of the experiment in the meta data can be difficult and a manual classification to tissue or condition would not be highly repeatable. In Fig. <xref rid="Fig2" ref-type="fig">2</xref> we show as an example, a visualization of expression diversity with a tissue subset (<italic>Drosophila</italic> gut) highlighted. A systematic approach to select maximally complementary sets of tissue types or conditions from meta data alone does not seem possible. Rather the data itself needs to be examined.
<fig id="Fig2"><label>Fig. 2</label><caption><p>Expression diversity. Multidimensional scaling plot of the expression profiles of 1000 runs sampled from <italic>Drosophila melanogaster</italic> from SRA. The red dots mark those runs, whose meta data description included the search string “gut”. The plot was created with edgeR [<xref ref-type="bibr" rid="CR5">5</xref>]</p></caption><graphic xlink:href="12859_2019_3182_Fig2_HTML" id="MO2"/></fig>
</p>
    </sec>
    <sec id="Sec5">
      <title>Accuracy</title>
      <p>To evaluate and compare the performance of the read selection methods, we measured the accuracy with which the <italic>introns</italic> of a reference annotation (see Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S2, reference annotations were pre-processed with GenomeTools [<xref ref-type="bibr" rid="CR10">10</xref>]) are found with spliced alignments of the selected reads. This intron accuracy measure is a proxy to the relative performances that could be achieved when using the alignments for genome annotation. The intron accuracy measure does not depend on any genome annotation method that ought to be evaluated and is therefore a more direct performance measure. As a reference, we take for each genome the set of introns in the protein-coding regions of genes. The annotation of such ’coding’ introns is usually more reliable than that of introns in untranslated regions or non-coding genes. As a prediction, we take the set of introns <italic>induced by the spliced alignments</italic> of the selected reads. In this context an intron is a pair of genome coordinates and each intron is counted only once, i.e. the sets are defined in the usual mathematical sense. The <italic>sensitivity</italic> and <italic>specificity</italic> are defined as usual in the genome annotation context: The (intron) <italic>sensitivity</italic> is the percentage of reference introns that were also predicted. The (intron) <italic>specificity</italic> is the percentage of predicted introns that were also in the reference set.</p>
      <p>Figure <xref rid="Fig3" ref-type="fig">3</xref> shows for the examples of <italic>Drosophila melanogaster</italic> and <italic>Fragaria vesca</italic> how the sensitivity grows and the specificity changes as the number of reads or read pairs (<italic>spots</italic> in the language of SRA) grows. A relatively ’small’ number of spots, 3 million, is in all twelve species sufficient to cover with VARUS at least half of the introns (data not shown). For both species, VARUS achieves the same sensitivity as the manual selection with fewer spots, in the case of strawberry even with a small fraction of the spot number. Further, when the sensitivity of VARUS and manual selection are equal, the specificity of VARUS is much higher than the specificity of the manual selection. As can be expected, the intron sensitivity initially grows fast and eventually saturates. When the number of aligned reads grows, false positive introns are accumulated at an increasingly higher rate than true positives. They can include alignment errors and very minor nonfunctional splice forms and could deteriorate annotation accuracy if left unfiltered.
<fig id="Fig3"><label>Fig. 3</label><caption><p>Intron Accuracy. VARUS’ sensitivity (green curve) and specificity (red curve) as a function of the downloaded number of spots (= reads or read pairs), in order of download. The manual selection method (green and red dot) has a fixed number of reads and horizontal dashed lines at manual sensitivity and specificity are drawn to facilitate comparisons</p></caption><graphic xlink:href="12859_2019_3182_Fig3_HTML" id="MO3"/></fig>
</p>
      <p>Table <xref rid="Tab2" ref-type="table">2</xref> shows the accuracies and download numbers for all examined species. The sensitivity and specificity curves for the remaining species (like in Fig. <xref rid="Fig3" ref-type="fig">3</xref>) are included in the Additional file <xref rid="MOESM1" ref-type="media">1</xref>. For all species but <italic>Verticillium dahliae</italic> VARUS achieved both a higher sensitivity and specificity with a lower number of downloaded reads or read pairs than the manual selection of whole runs. For <italic>Chlamydomonas reinhardtii</italic>, <italic>Cucumis sativus</italic>, <italic>Drosophila melanogaster</italic>, <italic>Fragaria vesca</italic>, <italic>Parasteatoda tepidariorum</italic> and <italic>Saccharomyces cerevisiae</italic> this can be seen directly from Table <xref rid="Tab2" ref-type="table">2</xref>. For <italic>Anopheles gambiae</italic>, <italic>Bombus terrestris</italic>, <italic>Hymenolepis microstoma</italic>, <italic>Prunus persica</italic> VARUS downloaded more reads or read pairs than the manual methods, but the curves of sensitivity and specificity as a function of cumulatively downloaded reads (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S1) show that VARUS had a higher specificity and a lower number of downloaded reads or read pairs when the sensitivity first surpassed that of the manual method (horizontal dashed line through ’manual sn’). For <italic>Verticillium dahliae</italic> the two methods are not objectively comparable unless one weights computational resources against accuracy. When the sensitivities of the two methods were equal (66.2%), VARUS’ specificity was slightly lower than that of the manual selection (31.5% versus 33.6%), but it had downloaded less than one third of the number of spots (25.5 million versus 81.9 million).
<table-wrap id="Tab2"><label>Table 2</label><caption><p>Intron accuracy</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left"/><th align="left"/><th align="left" colspan="2">Intron</th><th align="left">#spots</th><th align="left"># seq.</th></tr><tr><th align="left"/><th align="left"/><th align="left">sn</th><th align="left">sp</th><th align="left">[M]</th><th align="left">runs</th></tr></thead><tbody><tr><td align="left"><italic>Anopheles gambiae</italic></td><td align="left">VARUS</td><td align="left"><bold>.805</bold></td><td align="left"><bold>0.23</bold></td><td align="left">50</td><td align="left">566</td></tr><tr><td align="left"/><td align="left">manual</td><td align="left">.269</td><td align="left">.179</td><td align="left"><bold>18.4</bold></td><td align="left">5</td></tr><tr><td align="left"><italic>Bombus</italic></td><td align="left">VARUS</td><td align="left"><bold>.918</bold></td><td align="left">.365</td><td align="left">50</td><td align="left">357</td></tr><tr><td align="left"><italic>terrestris</italic></td><td align="left">manual</td><td align="left">.666</td><td align="left"><bold>.623</bold></td><td align="left"><bold>29.1</bold></td><td align="left">3</td></tr><tr><td align="left"><italic>Chlamydomonas</italic></td><td align="left">VARUS</td><td align="left"><bold>.687</bold></td><td align="left"><bold>.37</bold></td><td align="left"><bold>50</bold></td><td align="left">618</td></tr><tr><td align="left"><italic>reinhardtii</italic></td><td align="left">manual</td><td align="left">.68</td><td align="left">.26</td><td align="left">88</td><td align="left">5</td></tr><tr><td align="left"><italic>Cucumis</italic></td><td align="left">VARUS</td><td align="left"><bold>.96</bold></td><td align="left"><bold>.414</bold></td><td align="left"><bold>50</bold></td><td align="left">643</td></tr><tr><td align="left"><italic>sativus</italic></td><td align="left">manual</td><td align="left">.91</td><td align="left">.262</td><td align="left">126.6</td><td align="left">7</td></tr><tr><td align="left"><italic>Drosophila</italic></td><td align="left">VARUS</td><td align="left"><bold>.935</bold></td><td align="left"><bold>.359</bold></td><td align="left"><bold>50</bold></td><td align="left">758</td></tr><tr><td align="left"><italic>melanogaster</italic></td><td align="left">manual</td><td align="left">.896</td><td align="left">.264</td><td align="left">58.5</td><td align="left">5</td></tr><tr><td align="left"><italic>Fragaria</italic></td><td align="left">VARUS</td><td align="left"><bold>.915</bold></td><td align="left"><bold>.475</bold></td><td align="left"><bold>50</bold></td><td align="left">170</td></tr><tr><td align="left"><italic>vesca</italic></td><td align="left">manual</td><td align="left">.823</td><td align="left">.322</td><td align="left">71.9</td><td align="left">7</td></tr><tr><td align="left"><italic>Hymenolepis</italic></td><td align="left">VARUS</td><td align="left"><bold>.886</bold></td><td align="left">.237</td><td align="left">50</td><td align="left">31</td></tr><tr><td align="left"><italic>microstoma</italic></td><td align="left">manual</td><td align="left">.778</td><td align="left"><bold>.391</bold></td><td align="left"><bold>15.7</bold></td><td align="left">2</td></tr><tr><td align="left"><italic>Medicago</italic></td><td align="left">VARUS</td><td align="left">.717</td><td align="left"><bold>.386</bold></td><td align="left"><bold>50</bold></td><td align="left">403</td></tr><tr><td align="left"><italic>truncatula</italic></td><td align="left">manual</td><td align="left"><bold>.723</bold></td><td align="left">.21</td><td align="left">214.9</td><td align="left">6</td></tr><tr><td align="left"><italic>Parasteatoda</italic></td><td align="left">VARUS</td><td align="left"><bold>.869</bold></td><td align="left"><bold>.469</bold></td><td align="left"><bold>50</bold></td><td align="left">80</td></tr><tr><td align="left"><italic>tepidariorum</italic></td><td align="left">manual</td><td align="left">.83</td><td align="left">.352</td><td align="left">71.9</td><td align="left">6</td></tr><tr><td align="left"><italic>Prunus</italic></td><td align="left">VARUS</td><td align="left"><bold>.945</bold></td><td align="left"><bold>.188</bold></td><td align="left">400</td><td align="left">266</td></tr><tr><td align="left"><italic>persica</italic></td><td align="left">manual</td><td align="left">.942</td><td align="left">.138</td><td align="left"><bold>328.8</bold></td><td align="left">6</td></tr><tr><td align="left"><italic>Saccharomyces</italic></td><td align="left">VARUS</td><td align="left"><bold>.864</bold></td><td align="left"><bold>.004</bold></td><td align="left"><bold>50</bold></td><td align="left">983</td></tr><tr><td align="left"><italic>cerevisiae</italic></td><td align="left">manual</td><td align="left">.85</td><td align="left">.002</td><td align="left">99.8</td><td align="left">5</td></tr><tr><td align="left"><italic>Verticillium</italic></td><td align="left">VARUS</td><td align="left"><bold>.681</bold></td><td align="left">.222</td><td align="left"><bold>50</bold></td><td align="left">30</td></tr><tr><td align="left"><italic>dahliae</italic></td><td align="left">manual</td><td align="left">.662</td><td align="left"><bold>.336</bold></td><td align="left">81.9</td><td align="left">3</td></tr></tbody></table><table-wrap-foot><p>The sensitivity (sn) and specificity (sp) with which VARUS and the manual method find introns in the reference genome annotation. The last two columns shows the number of reads or read pairs (spots) in millions that have been downloaded from SRA and from how many different runs they stem. Better values are typeset in boldface</p></table-wrap-foot></table-wrap>
</p>
    </sec>
    <sec id="Sec6">
      <title>Whole-Genome annotation</title>
      <p>We used the selected RNA reads for genome annotation and examined their relative influence on accuracy. For this we used the fully automatic genome annotation pipeline BRAKER [<xref ref-type="bibr" rid="CR11">11</xref>]. BRAKER obtained as input only the intron candidates derived from the spliced alignments of the reads against the genome as ’hints’ and the repeat-masked genome. No other input or previous parameters are used by BRAKER. The BRAKER pipeline uses the hints to compile a training set of gene structures with GeneMark-ET [<xref ref-type="bibr" rid="CR12">12</xref>] and then AUGUSTUS [<xref ref-type="bibr" rid="CR13">13</xref>, <xref ref-type="bibr" rid="CR14">14</xref>] to structurally annotate the whole genome using again the intron hints.</p>
      <p>Figure <xref rid="Fig4" ref-type="fig">4</xref> shows a comparison between the gene prediction accuracies of BRAKER (obtained with Eval [<xref ref-type="bibr" rid="CR15">15</xref>]) when either the manually selected runs were used or the reads selected by VARUS. On average, VARUS downloaded fewer reads (Fig. <xref rid="Fig4" ref-type="fig">4</xref>, left) than were downloaded manually. Yet, with VARUS the whole-genome annotation accuracy tends to be rather higher than with the manual selection. As can be seen at the right side of Fig. <xref rid="Fig4" ref-type="fig">4</xref>, in 8 of the species, the results with VARUS are better than with the manual selection, in the remaining 4 species the manual selection is better. However, the clear advantage of VARUS in terms of intron accuracy does not carry over to a clear annotation accuracy advantage with BRAKER. This suggests that BRAKER may not be fully exploiting the additional accuracy or that most of the additional true positive introns would have been found anyway and that most of the false positive introns would have been filtered out anyway. We conclude that VARUS automatizes a task that hitherto needed manual work at even a small average benefit to the accuracy of genome annotation.
<fig id="Fig4"><label>Fig. 4</label><caption><p>Relative Annotation Accuracy. The right side shows the difference in whole-genome annotation accuracy in percent. The F1-measure of coding exon accuracy (the harmonic mean of sensitivity and specificity) was used, whereby either annotation was compared to the respective reference annotation (see Supplementary Table 2). The left shows the corresponding input data set sizes. The average and mean number of spots chosen by the manual method are 100 and 77 million, respectively, and larger than the 50 million spots downloaded by VARUS. Averaging over the species, the F1 accuracy of BRAKER is 0.62% higher when RNA-Seq is selected by VARUS rather than manual</p></caption><graphic xlink:href="12859_2019_3182_Fig4_HTML" id="MO4"/></fig>
</p>
    </sec>
  </sec>
  <sec id="Sec7" sec-type="discussion">
    <title>Discussion</title>
    <p>VARUS provides a convenient way to sample RNA-Seq data from a given species. Even a trivial independent sampling of a random subset of many or all sequencing runs can be very useful, e.g. to estimate and compare library qualities on the basis of the actual data. Such a trivial sampling can be done with VARUS with the option –loadAllOnce with which a single batch from each run will be downloaded once. VARUS – even if used in such a trivial way – can decrease the risk that a manual sample of a small number of (complete) sequencing runs bears. It could be an <italic>unlucky</italic> choice of libraries or conditions or tissues that leaves a relatively large fraction of transcripts or major splice forms insufficiently represented.</p>
    <p>When more data is available than can be handled reasonably, VARUS allows to achieve a near optimal sensitivity with a small fraction of data. For example, the alignments found by VARUS covered 96.7% of all annotated <italic>Drosophila melanogaster</italic> introns with less than 1/2000 of the total spots available (200 million out of 433 billion spots).</p>
    <p>VARUS makes it possible to annotate a large number of species on the basis of RNA-Seq in a loop. To demonstrate this, we used the BRAKER pipeline, that can be trained and run automatically with RNA-Seq and a genome only. The annotation loop does not require manual work, except for compiling a list of species names and genome files as shown in Fig. <xref rid="Fig1" ref-type="fig">1</xref>. Nevertheless, the overall performance of VARUS+BRAKER appears to be on par or rather better than when reads are selected manually.</p>
    <p>We think that VARUS could be useful for transcriptome assembly as well, whether genome-guided transcriptome reconstruction or even de novo transcriptome assembly methods. Like genome annotation, these tasks also seek to construct a set of transcripts that is as complete as possible. On the other hand, subsetting the data may be a necessity and the complementarity of the subset is desirable. In addition, Pertea et al. identify large variations in expression levels as a problem for transcriptome assembly [<xref ref-type="bibr" rid="CR16">16</xref>], while the objective (<xref rid="Equ1" ref-type="">1</xref>) of VARUS gives a relative disincentive to collect more data from transcript units that are already highly represented. For this reason we plan to allow VARUS to make unspliced alignments as well as a future development.</p>
  </sec>
  <sec id="Sec8" sec-type="conclusion">
    <title>Conclusions</title>
    <p>We introduced the software VARUS to efficiently and automatically collect samples from SRA to cover a large set of transcripts. VARUS makes it easy to repurpose SRA resources for genome annotation without requiring that meta data on the experiments is manually read or automatically mined. We expect that a lot can be gained by even more automatization towards a more continuous process of genome annotation. Annotations could be updated when a new assembly or significantly more RNA-Seq becomes available or when annotation methods are substantially improved. In this context, it should be stressed that while most genome annotation pipelines heavily rely on RNA-Seq data, they often also use other data, such as protein sequences from related species. It can therefore be advisable to update an annotation of one species because of a change in the available data or gene structures of another species.</p>
    <p>At the moment, the methods with which the current assemblies of eukaryotic genomes were annotated are quite diverse, e.g. in terms of programs but also in usages and versions of the same program. Such an inhomogeneity can be very relevant for questions of comparative genomics in which the (often rare) <italic>differences</italic> between the genomes are in the focus. Then spurious differences from inhomogeneous annotation methods can dominate the reported differences. For such comparative purposes, the consistent reannotation of all genomes is desirable but may only be practically feasible when no manual work is required for each species.</p>
  </sec>
  <sec id="Sec9">
    <title>Availability and requirements</title>
    <p><bold>Project name:</bold> VARUS</p>
    <p>
      <bold>Project home page:</bold>
      <ext-link ext-link-type="uri" xlink:href="https://github.com/Gaius-Augustus/VARUS">https://github.com/Gaius-Augustus/VARUS</ext-link>
    </p>
    <p><bold>Operating system(s):</bold> Linux</p>
    <p><bold>Programming language:</bold> C++, Perl</p>
    <p><bold>Other requirements:</bold> samtools [<xref ref-type="bibr" rid="CR17">17</xref>], fastq-dump, HISAT2 or STAR, filterIntronsFindStrand.pl (BRAKER)</p>
    <p><bold>License:</bold> GPLv3</p>
    <p>No restrictions to use by non-academics</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary information</title>
    <sec id="Sec10">
      <p>
        <supplementary-material content-type="local-data" id="MOESM1">
          <media xlink:href="12859_2019_3182_MOESM1_ESM.pdf">
            <caption>
              <p><bold>Additional file 1</bold> The supplementary material includes command lines and additional figures.</p>
            </caption>
          </media>
        </supplementary-material>
      </p>
    </sec>
  </sec>
</body>
<back>
  <glossary>
    <title>Abbreviations</title>
    <def-list>
      <def-item>
        <term>SRA</term>
        <def>
          <p>sequence read archive</p>
        </def>
      </def-item>
    </def-list>
  </glossary>
  <fn-group>
    <fn>
      <p>
        <bold>Publisher’s Note</bold>
      </p>
      <p>Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p>
    </fn>
  </fn-group>
  <sec>
    <title>Supplementary information</title>
    <p><bold>Supplementary information</bold> accompanies this paper at 10.1186/s12859-019-3182-x.</p>
  </sec>
  <ack>
    <p>None</p>
  </ack>
  <notes notes-type="author-contribution">
    <title>Authors’ contributions</title>
    <p>MS conceived the problem and algorithm, implemented VARUS, performed VARUS experiments and wrote the manuscript. WB implemented VARUS and performed VARUS experiments. FB performed the manual selection and download of sequencing runs. KJH performed alignments of manually selected libraries, ran BRAKER and wrote the manuscript. All authors read and approved the final manuscript.</p>
  </notes>
  <notes notes-type="funding-information">
    <title>Funding</title>
    <p>The research was supported by the Deutsche Forschungsgemeinschaft (DFG) grant number STA 1009/12-1 to MS and by the US National Institutes of Health grant GM128145 to MS. The funding bodies participated neither in the design of the study nor in collecting, analyzing or interpreting data, nor in manuscript writing.</p>
  </notes>
  <notes>
    <title>Ethics approval and consent to participate</title>
    <p>Not applicable.</p>
  </notes>
  <notes>
    <title>Consent for publication</title>
    <p>Not applicable</p>
  </notes>
  <notes notes-type="COI-statement">
    <title>Competing interests</title>
    <p>The authors declare that they have no competing interests.</p>
  </notes>
  <ref-list id="Bib1">
    <title>References</title>
    <ref id="CR1">
      <label>1</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Leinonen</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Sugawara</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Shumway</surname>
            <given-names>M</given-names>
          </name>
          <collab>International Nucleotide Sequence Database Collaboration</collab>
        </person-group>
        <article-title>The sequence read archive</article-title>
        <source>Nucleic Acids Res</source>
        <year>2010</year>
        <volume>39</volume>
        <issue>suppl_1</issue>
        <fpage>19</fpage>
        <lpage>21</lpage>
        <pub-id pub-id-type="pmid">20805242</pub-id>
      </element-citation>
    </ref>
    <ref id="CR2">
      <label>2</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Leinonen</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Akhtar</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Birney</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Bower</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Cerdeno-Tárraga</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Cheng</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Cleland</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Faruque</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Goodgame</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Gibson</surname>
            <given-names>R</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>The european nucleotide archive</article-title>
        <source>Nucleic Acids Res</source>
        <year>2010</year>
        <volume>39</volume>
        <issue>suppl_1</issue>
        <fpage>28</fpage>
        <lpage>31</lpage>
      </element-citation>
    </ref>
    <ref id="CR3">
      <label>3</label>
      <mixed-citation publication-type="other">Sequence Read Archive Growth. <ext-link ext-link-type="uri" xlink:href="https://www.ncbi.nlm.nih.gov/sra/docs/sragrowth/">https://www.ncbi.nlm.nih.gov/sra/docs/sragrowth/</ext-link>. Accessed 2 Nov 2019.</mixed-citation>
    </ref>
    <ref id="CR4">
      <label>4</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Costa-Silva</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Domingues</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Lopes</surname>
            <given-names>FM</given-names>
          </name>
        </person-group>
        <article-title>RNA-Seq differential expression analysis: An extended review and a software tool</article-title>
        <source>PloS ONE</source>
        <year>2017</year>
        <volume>12</volume>
        <issue>12</issue>
        <fpage>0190152</fpage>
        <pub-id pub-id-type="doi">10.1371/journal.pone.0190152</pub-id>
      </element-citation>
    </ref>
    <ref id="CR5">
      <label>5</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Robinson</surname>
            <given-names>MD</given-names>
          </name>
          <name>
            <surname>McCarthy</surname>
            <given-names>DJ</given-names>
          </name>
          <name>
            <surname>Smyth</surname>
            <given-names>GK</given-names>
          </name>
        </person-group>
        <article-title>edgeR: a Bioconductor package for differential expression analysis of digital gene expression data</article-title>
        <source>Bioinformatics</source>
        <year>2010</year>
        <volume>26</volume>
        <issue>1</issue>
        <fpage>139</fpage>
        <lpage>40</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btp616</pub-id>
        <pub-id pub-id-type="pmid">19910308</pub-id>
      </element-citation>
    </ref>
    <ref id="CR6">
      <label>6</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ohta</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Nakazato</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Bono</surname>
            <given-names>H</given-names>
          </name>
        </person-group>
        <article-title>Calculating the quality of public high-throughput sequencing data to obtain a suitable subset for reanalysis from the Sequence Read Archive</article-title>
        <source>GigaScience</source>
        <year>2017</year>
        <volume>6</volume>
        <issue>6</issue>
        <fpage>029</fpage>
        <pub-id pub-id-type="doi">10.1093/gigascience/gix029</pub-id>
      </element-citation>
    </ref>
    <ref id="CR7">
      <label>7</label>
      <mixed-citation publication-type="other">VARUS source code. <ext-link ext-link-type="uri" xlink:href="https://github.com/Gaius-Augustus/VARUS">https://github.com/Gaius-Augustus/VARUS</ext-link>. 10.5281/zenodo.2638797. Accessed 2 Nov 2019.</mixed-citation>
    </ref>
    <ref id="CR8">
      <label>8</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kim</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Langmead</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Salzberg</surname>
            <given-names>SL</given-names>
          </name>
        </person-group>
        <article-title>HISAT: a fast spliced aligner with low memory requirements</article-title>
        <source>Nat Methods</source>
        <year>2015</year>
        <volume>12</volume>
        <issue>4</issue>
        <fpage>357</fpage>
        <pub-id pub-id-type="doi">10.1038/nmeth.3317</pub-id>
        <pub-id pub-id-type="pmid">25751142</pub-id>
      </element-citation>
    </ref>
    <ref id="CR9">
      <label>9</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Dobin</surname>
            <given-names>Alexander</given-names>
          </name>
          <name>
            <surname>Davis</surname>
            <given-names>Carrie A.</given-names>
          </name>
          <name>
            <surname>Schlesinger</surname>
            <given-names>Felix</given-names>
          </name>
          <name>
            <surname>Drenkow</surname>
            <given-names>Jorg</given-names>
          </name>
          <name>
            <surname>Zaleski</surname>
            <given-names>Chris</given-names>
          </name>
          <name>
            <surname>Jha</surname>
            <given-names>Sonali</given-names>
          </name>
          <name>
            <surname>Batut</surname>
            <given-names>Philippe</given-names>
          </name>
          <name>
            <surname>Chaisson</surname>
            <given-names>Mark</given-names>
          </name>
          <name>
            <surname>Gingeras</surname>
            <given-names>Thomas R.</given-names>
          </name>
        </person-group>
        <article-title>STAR: ultrafast universal RNA-seq aligner</article-title>
        <source>Bioinformatics</source>
        <year>2012</year>
        <volume>29</volume>
        <issue>1</issue>
        <fpage>15</fpage>
        <lpage>21</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/bts635</pub-id>
        <pub-id pub-id-type="pmid">23104886</pub-id>
      </element-citation>
    </ref>
    <ref id="CR10">
      <label>10</label>
      <mixed-citation publication-type="other">Gremme G, Steinbiss S, Kurtz S. IEEE/ACM Transactions on Computational Biology and Bioinformatics (TCBB). 2013; 10(3):645–56.</mixed-citation>
    </ref>
    <ref id="CR11">
      <label>11</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hoff</surname>
            <given-names>K. J</given-names>
          </name>
          <name>
            <surname>Lange</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Lomsadze</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Borodovsky</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Stanke</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>BRAKER1: unsupervised RNA-Seq-based genome annotation with GeneMark-ET and AUGUSTUS</article-title>
        <source>Bioinformatics</source>
        <year>2016</year>
        <volume>32</volume>
        <issue>5</issue>
        <fpage>767</fpage>
        <lpage>9</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btv661</pub-id>
        <pub-id pub-id-type="pmid">26559507</pub-id>
      </element-citation>
    </ref>
    <ref id="CR12">
      <label>12</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lomsadze</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Burns</surname>
            <given-names>PD</given-names>
          </name>
          <name>
            <surname>Borodovsky</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>Integration of mapped RNA-Seq reads into automatic training of eukaryotic gene finding algorithm</article-title>
        <source>Nucleic Acids Res</source>
        <year>2014</year>
        <volume>42</volume>
        <issue>15</issue>
        <fpage>119</fpage>
        <pub-id pub-id-type="doi">10.1093/nar/gku557</pub-id>
      </element-citation>
    </ref>
    <ref id="CR13">
      <label>13</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Stanke</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Diekhans</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Baertsch</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Haussler</surname>
            <given-names>D</given-names>
          </name>
        </person-group>
        <article-title>Using native and syntenically mapped cDNA alignments to improve de novo gene finding</article-title>
        <source>Bioinformatics</source>
        <year>2008</year>
        <volume>24</volume>
        <issue>5</issue>
        <fpage>637</fpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btn013</pub-id>
        <pub-id pub-id-type="pmid">18218656</pub-id>
      </element-citation>
    </ref>
    <ref id="CR14">
      <label>14</label>
      <mixed-citation publication-type="other">Hoff K. J, Stanke M. Predicting genes in single genomes with augustus. Curr Protoc Bioinforma. 2019; 65(1):57. 10.1002/cpbi.57.</mixed-citation>
    </ref>
    <ref id="CR15">
      <label>15</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Keibler</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Brent</surname>
            <given-names>MR</given-names>
          </name>
        </person-group>
        <article-title>Eval: a software package for analysis of genome annotations</article-title>
        <source>BMC Bioinformatics</source>
        <year>2003</year>
        <volume>4</volume>
        <issue>1</issue>
        <fpage>50</fpage>
        <pub-id pub-id-type="doi">10.1186/1471-2105-4-50</pub-id>
        <pub-id pub-id-type="pmid">14565849</pub-id>
      </element-citation>
    </ref>
    <ref id="CR16">
      <label>16</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Pertea</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Pertea</surname>
            <given-names>GM</given-names>
          </name>
          <name>
            <surname>Antonescu</surname>
            <given-names>CM</given-names>
          </name>
          <name>
            <surname>Chang</surname>
            <given-names>T-C</given-names>
          </name>
          <name>
            <surname>Mendell</surname>
            <given-names>JT</given-names>
          </name>
          <name>
            <surname>Salzberg</surname>
            <given-names>SL</given-names>
          </name>
        </person-group>
        <article-title>StringTie enables improved reconstruction of a transcriptome from RNA-seq reads</article-title>
        <source>Nat Biotechnol</source>
        <year>2015</year>
        <volume>33</volume>
        <issue>3</issue>
        <fpage>290</fpage>
        <pub-id pub-id-type="doi">10.1038/nbt.3122</pub-id>
        <pub-id pub-id-type="pmid">25690850</pub-id>
      </element-citation>
    </ref>
    <ref id="CR17">
      <label>17</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Li</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Handsaker</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Wysoker</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Fennell</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Ruan</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Homer</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Marth</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Abecasis</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Durbin</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>The sequence alignment/map format and SAMtools</article-title>
        <source>Bioinformatics</source>
        <year>2009</year>
        <volume>25</volume>
        <issue>16</issue>
        <fpage>2078</fpage>
        <lpage>9</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btp352</pub-id>
        <pub-id pub-id-type="pmid">19505943</pub-id>
      </element-citation>
    </ref>
  </ref-list>
</back>
