<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName A++V2.4.dtd?>
<?SourceDTD.Version 2.4?>
<?ConverterInfo.XSLTName springer2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Genome Biol</journal-id>
    <journal-id journal-id-type="iso-abbrev">Genome Biol</journal-id>
    <journal-title-group>
      <journal-title>Genome Biology</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1474-7596</issn>
    <issn pub-type="epub">1474-760X</issn>
    <publisher>
      <publisher-name>BioMed Central</publisher-name>
      <publisher-loc>London</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">10416524</article-id>
    <article-id pub-id-type="pmid">37563669</article-id>
    <article-id pub-id-type="publisher-id">3030</article-id>
    <article-id pub-id-type="doi">10.1186/s13059-023-03030-8</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Software</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Maast: genotyping thousands of microbial strains efficiently</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Shi</surname>
          <given-names>Zhou Jason</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Nayfach</surname>
          <given-names>Stephen</given-names>
        </name>
        <xref ref-type="aff" rid="Aff3">3</xref>
        <xref ref-type="aff" rid="Aff4">4</xref>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-9870-6196</contrib-id>
        <name>
          <surname>Pollard</surname>
          <given-names>Katherine S.</given-names>
        </name>
        <address>
          <email>kpollard@gladstone.ucsf.edu</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff2">2</xref>
        <xref ref-type="aff" rid="Aff5">5</xref>
      </contrib>
      <aff id="Aff1"><label>1</label><institution-wrap><institution-id institution-id-type="ROR">https://ror.org/00knt4f32</institution-id><institution-id institution-id-type="GRID">grid.499295.a</institution-id><institution-id institution-id-type="ISNI">0000 0004 9234 0175</institution-id><institution>Chan Zuckerberg Biohub, </institution></institution-wrap>San Francisco, CA USA </aff>
      <aff id="Aff2"><label>2</label><institution-wrap><institution-id institution-id-type="GRID">grid.249878.8</institution-id><institution-id institution-id-type="ISNI">0000 0004 0572 7110</institution-id><institution>Gladstone Institutes of Data Science and Biotechnology, </institution></institution-wrap>San Francisco, CA USA </aff>
      <aff id="Aff3"><label>3</label><institution-wrap><institution-id institution-id-type="ROR">https://ror.org/04xm1d337</institution-id><institution-id institution-id-type="GRID">grid.451309.a</institution-id><institution-id institution-id-type="ISNI">0000 0004 0449 479X</institution-id><institution>Joint Genome Institute, Department of Energy, </institution></institution-wrap>Walnut Creek, CA USA </aff>
      <aff id="Aff4"><label>4</label><institution-wrap><institution-id institution-id-type="ROR">https://ror.org/02jbv0t02</institution-id><institution-id institution-id-type="GRID">grid.184769.5</institution-id><institution-id institution-id-type="ISNI">0000 0001 2231 4551</institution-id><institution>Environmental Genomics and Systems Biology Division, Lawrence Berkeley National Laboratory, </institution></institution-wrap>Berkeley, CA USA </aff>
      <aff id="Aff5"><label>5</label><institution-wrap><institution-id institution-id-type="ROR">https://ror.org/043mz5j54</institution-id><institution-id institution-id-type="GRID">grid.266102.1</institution-id><institution-id institution-id-type="ISNI">0000 0001 2297 6811</institution-id><institution>Department of Epidemiology and Biostatistics, </institution><institution>University of California San Francisco, </institution></institution-wrap>San Francisco, CA USA </aff>
    </contrib-group>
    <pub-date pub-type="epub">
      <day>10</day>
      <month>8</month>
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>10</day>
      <month>8</month>
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2023</year>
    </pub-date>
    <volume>24</volume>
    <elocation-id>186</elocation-id>
    <history>
      <date date-type="received">
        <day>7</day>
        <month>7</month>
        <year>2022</year>
      </date>
      <date date-type="accepted">
        <day>31</day>
        <month>7</month>
        <year>2023</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2023</copyright-statement>
      <license>
        <ali:license_ref specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p><bold>Open Access</bold> This article is licensed under a Creative Commons Attribution 4.0 International License, which permits use, sharing, adaptation, distribution and reproduction in any medium or format, as long as you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons licence, and indicate if changes were made. The images or other third party material in this article are included in the article's Creative Commons licence, unless indicated otherwise in a credit line to the material. If material is not included in the article's Creative Commons licence and your intended use is not permitted by statutory regulation or exceeds the permitted use, you will need to obtain permission directly from the copyright holder. To view a copy of this licence, visit <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>. The Creative Commons Public Domain Dedication waiver (<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/publicdomain/zero/1.0/">http://creativecommons.org/publicdomain/zero/1.0/</ext-link>) applies to the data made available in this article, unless otherwise stated in a credit line to the data.</license-p>
      </license>
    </permissions>
    <abstract id="Abs1">
      <p id="Par1">Existing single nucleotide polymorphism (SNP) genotyping algorithms do not scale for species with thousands of sequenced strains, nor do they account for conspecific redundancy. Here we present a bioinformatics tool, Maast, which empowers population genetic meta-analysis of microbes at an unrivaled scale. Maast implements a novel algorithm to heuristically identify a minimal set of diverse conspecific genomes, then constructs a reliable SNP panel for each species, and enables rapid and accurate genotyping using a hybrid of whole-genome alignment and k-mer exact matching. We demonstrate Maast’s utility by genotyping thousands of <italic>Helicobacter pylori</italic> strains and tracking SARS-CoV-2 diversification.</p>
      <sec>
        <title>Supplementary Information</title>
        <p>The online version contains supplementary material available at 10.1186/s13059-023-03030-8.</p>
      </sec>
    </abstract>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100014989</institution-id>
            <institution>Chan Zuckerberg Initiative</institution>
          </institution-wrap>
        </funding-source>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution>Chan Zuckerberg Biohub</institution>
        </funding-source>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100008072</institution-id>
            <institution>Gladstone Institutes</institution>
          </institution-wrap>
        </funding-source>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100000050</institution-id>
            <institution>National Heart, Lung, and Blood Institute</institution>
          </institution-wrap>
        </funding-source>
        <award-id>HL160862</award-id>
        <principal-award-recipient>
          <name>
            <surname>Pollard</surname>
            <given-names>Katherine S.</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
    </funding-group>
    <custom-meta-group>
      <custom-meta>
        <meta-name>issue-copyright-statement</meta-name>
        <meta-value>© BioMed Central Ltd., part of Springer Nature 2023</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec id="Sec1">
    <title>Background</title>
    <p id="Par2">Many bacterial and viral species now have thousands of sequenced genomes in public databases, and these numbers are rapidly increasing, fueled by technologies such as metagenome assembly, high-throughput culturing, and single-cell genome sequencing. For many species, genome collections harbor immense genetic variation [<xref ref-type="bibr" rid="CR1">1</xref>, <xref ref-type="bibr" rid="CR2">2</xref>]. Single nucleotide polymorphisms (SNPs) are genomic positions that vary between genomes of the same species with a minimum minor allele frequency (e.g., 1%). Vertically inherited SNPs in conserved genes are commonly used to reconstruct phylogenies and study biogeography [<xref ref-type="bibr" rid="CR3">3</xref>, <xref ref-type="bibr" rid="CR4">4</xref>], while SNPs in pathogenicity loci and antibiotic resistance genes are leveraged for surveillance of medically important strains [<xref ref-type="bibr" rid="CR5">5</xref>–<xref ref-type="bibr" rid="CR7">7</xref>]. Compared to multilocus sequence typing methods, whole-genome SNP genotyping generally enables greater phylogenetic resolution [<xref ref-type="bibr" rid="CR8">8</xref>]. Comparing genomes based on a pre-defined set of SNPs is also more computationally scalable than using whole-genome nucleotide identity [<xref ref-type="bibr" rid="CR9">9</xref>] and thus especially well-suited for the analysis of large genome collections.</p>
    <p id="Par3">SNPs are often identified from whole genome sequences. For example, Parsnp [<xref ref-type="bibr" rid="CR10">10</xref>] constructs multiple sequence alignments of high-quality genome assemblies and identifies variable positions directly from the alignments. An alternative method is to call SNPs from sequencing reads without genome assembly. For example, Snippy (<ext-link ext-link-type="uri" xlink:href="https://github.com/tseemann/snippy">https://github.com/tseemann/snippy</ext-link>) identifies SNPs from the alignment of short reads to a reference genome and kSNP [<xref ref-type="bibr" rid="CR11">11</xref>] identifies SNPs using informative k-mers found on short reads, contigs, or genome assemblies. Assembly-free genotyping and k-mer matching are usually faster but less accurate than genotyping SNPs from whole-genome alignments [<xref ref-type="bibr" rid="CR12">12</xref>]. With all of these strategies, SNPs of interest can be extracted using thresholds on the minor allele frequency (MAF), site prevalence, or protein-coding change across a set of strains.</p>
    <p id="Par4">Despite the variety of SNP genotyping methods, a rapid increase in the number of sequenced microbial genomes presents a computational challenge for existing tools. Sequence alignment is the major obstacle to analyzing so many genomes, though kSNP also remain largely untested with thousands of strains. A second challenge is the fact that many species have a high level of genome redundancy [<xref ref-type="bibr" rid="CR13">13</xref>], especially when a biased sample of clonally related genomes has been sequenced, which is common for clinically important pathogens that are under intensive surveillance (e.g., PulseNet [<xref ref-type="bibr" rid="CR14">14</xref>] and NCBI Pathogen Detection). This redundancy masks the diversity of unevenly sampled species, and it means that strains from poorly sampled lineages contribute little to the discovery of SNPs, especially when a relatively high MAF threshold is used. Redundancy also alters the meaning of MAF and site prevalence; frequency in the sampled genomes is not a good estimate of frequency in the population. Together, these two challenges limit the utility of SNP genotyping methods for many microbial species.</p>
    <p id="Par5">To address this gap, we present Maast (Microbial agile accurate SNP Typer) for accurate genotyping of orders of magnitude more microbial strains than other state-of-the-art methods. Our key innovation is an algorithm to pick a minimal set of maximally diverse genomes. Only these genomes are used for SNP discovery which reduces genomic redundancy and computational cost. We also implement a hybrid method combining whole-genome alignment and optimized k-mer exact match for genotyping SNPs in either assembled genomes or unassembled whole-genome sequencing (WGS) libraries. Maast performs SNP genotyping faster and more accurately than existing methods but sometimes misses rare variants present in genomes not selected for SNP discovery. We apply Maast to a large collection of previously sequenced <italic>Helicobacter pylori</italic> (<italic>H. pylori</italic>) strains and summarize the biogeographic patterns of this species across the globe. We also show that Maast can efficiently track the evolution of SARS-CoV-2 during the COVID-19 outbreak. Maast is available as open-source software with both source code and documentation freely accessible on GitHub (<ext-link ext-link-type="uri" xlink:href="https://github.com/zjshi/Maast">https://github.com/zjshi/Maast</ext-link>).</p>
  </sec>
  <sec id="Sec2">
    <title>Results</title>
    <sec id="Sec3">
      <title>The Maast SNP genotyping pipeline</title>
      <p id="Par6">Maast is an open-source bioinformatics pipeline written in Python and C +  + that fully automates SNP calling and genotyping for microbial species. Maast has two components: (1) constructing a reference panel of SNPs for a microbial species using a reduced set of non-redundant genomes (Fig. <xref rid="Fig1" ref-type="fig">1</xref>a and b, Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S1), and (2) ultra-fast, in silico genotyping of reference SNPs from large scale genome collections. Genotyping can be performed using draft genome assemblies or unassembled short or long reads (Fig. <xref rid="Fig1" ref-type="fig">1</xref>c, d and Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S2) and can be applied to any microbial species, such as bacteria, archaea, viruses, or microbial eukaryotes.<fig id="Fig1"><label>Fig. 1</label><caption><p>Schematic design of Maast. Maast consists of four major components. <bold>a</bold> Tag genomes and centroid genomes are selected based on Mash distances. A novel algorithm, called DynaCC, is used to automatically choose the genome clustering threshold based on each species’ level of genomic redundancy (see the “<xref rid="Sec10" ref-type="sec">Methods</xref>” section). <bold>b</bold> A panel of common SNPs is constructed for each species using multiple whole-genome alignment. <bold>c</bold> SNPs in non-tag genomes or other input genomes are genotyped using single whole-genome alignment. <bold>d</bold> SNPs in short reads are genotyped using k-mer exact matching</p></caption><graphic xlink:href="13059_2023_3030_Fig1_HTML" id="MO1"/></fig></p>
      <p id="Par7">In the first step of the pipeline, Maast rapidly builds a reference SNP panel from a diverse, non-redundant subset of input genome assemblies using MUMmer. The genome subset is identified using pairwise genetic distances and a dynamic graph algorithm that we developed and called DynaCC (Dynamic Connected Component search; Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S3). DynaCC aims to identify a minimal set of genomes that captures the maximum number of common SNPs with MAF above a user-specified value. It does this heuristically in order to accelerate the computation, and hence the resulting “tag” genomes are not provably a minimal set. From the tag genomes, Maast selects one centroid tag genome to be used as a species reference. Maast then aligns all other tag genomes to the reference using MUMmer, constructs a multiple sequence alignment (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S2), and uses a standard SNP calling workflow (“Methods”) to generate the SNP panel at the user-specified MAF and prevalence (% of genomes containing either SNP allele).</p>
      <p id="Par8">We assessed whether the Maast strategy of subsampling reduced our power to detect SNPs on a benchmark dataset of 146 common bacterial species from the human gut, each with at least 200 high-quality genomes (Additional file <xref rid="MOESM2" ref-type="media">2</xref>: Table S1). These species have different levels of intraspecific diversity (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S4), genomic redundancy (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S5a), and SNP density (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S5b). Overall, we found that the number of SNPs identified with Maast tag genomes (&gt; 1% MAF) was equal to or greater than the number of SNPs identified using the full set of genomes (Fig. <xref rid="Fig2" ref-type="fig">2</xref>a, b), with high overlap between the approaches (median = 87.9%, Fig. <xref rid="Fig2" ref-type="fig">2</xref>c). Our results demonstrate that more genomes do not necessarily lead to the discovery of more common SNPs (&gt; 1% MAF). The presence of many highly related genomes also leads to biased estimation of SNP frequencies in the overall population and may reduce SNPs discovered at a given MAF threshold (Fig. <xref rid="Fig2" ref-type="fig">2</xref>d, e, f, <xref rid="MOESM1" ref-type="media">S6</xref>). These analyses highlight that the Maast strategy of subsampling captures the most common genetic variation and successfully represents genomes from poorly sampled lineages (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S7, S8). Users also have the option to run Maast with all genomes rather than tag genomes, which may enable more of the SNPs present in pairwise genome comparisons to be included in the SNP panel, especially for rare SNPs present in less divergent pairs of genomes (Fig. <xref rid="Fig2" ref-type="fig">2</xref>d, Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S8), but at the cost of greater computational requirements. Maast, run using either tag genomes or all genomes, misses many variable sites between pairs of genomes (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S7, S8), because these are largely rare variants whereas Maast was designed to capture common SNPs above a MAF threshold.<fig id="Fig2"><label>Fig. 2</label><caption><p>SNP genotyping of 146 human gut bacterial species using tag genomes. <bold>a</bold> and <bold>b</bold> SNP discovery comparison of Maast with all genomes (gray), only tag genomes (green), and a random set of genomes equal in number to the tag genomes (brown) shows that more genomes do not lead to the discovery of more SNPs. Each box in <bold>a</bold> summarizes the number of SNPs across 146 species. Each point in <bold>b</bold> represents a species, with black lines connecting the data for the same species. For computational efficiency, only the 1000 highest quality genomes were included for species with &gt; 1000 genomes. <bold>c</bold> Comparison of SNPs discovered by Maast with all genomes versus only tag genomes. Each bar represents a species, with the height of a bar showing the number of SNPs discovered exclusively with all genomes (gray), exclusively with tag genomes (green), or by both approaches (beige). Arrows point to eight example species (from left to right): <italic>Faecalibacterium prausnitzii_K</italic> (species id: 101300), <italic>Akkermansia muciniphila</italic> (102454), <italic>Akkermansia muciniphila_B</italic> (102453), <italic>Succinivibrio sp000431835</italic> (100412), <italic>Sutterella wadsworthensis_B</italic> (101361), <italic>Phascolarctobacterium faecium</italic> (103439), <italic>Alistipes shahii</italic> (100003), and <italic>Anaerotignum sp000436415</italic> (100177). Species label color indicates whether this species has a high (red) or low (blue) level of tag-only SNPs, which is estimated as a fraction of all SNPs that are discovered with tag genomes and not with all genomes. <bold>d</bold> SNP sites missing from a small percentage of genome assemblies as they fall below the user-specified prevalence threshold due to being absent in a group of redundant genomes. Connected dots represent example species in <bold>c</bold> with a high proportion of tag-only SNPs. The proportion of tag-only SNPs drops if the MAF cutoff for calling SNPs with all genomes is lowered from 0.01 (orange) to 0.001 (green). Most of the SNPs only discovered with tag genomes (tag-only SNPs) are due to MAFs below the 1% threshold in all genomes. <bold>e</bold> For each of the four species where tag genomes and all genomes called different numbers of SNPs (<italic>Faecalibacterium prausnitzii_K</italic>, <italic>Phascolarctobacterium faecium</italic>, <italic>Alistipes shahii</italic>, and <italic>Akkermansia muciniphila_B</italic>), we further investigated the source of this discrepancy by defining a set of true population SNPs. To do so, we built a phylogenetic tree and used it to sample genomes so that they covered the species diversity but came from different subpopulations (essentially removing bias from over-sampling of subpopulations with redundant genomes). SNPs called using this set of genomes were defined as the true SNPs for the population. We ran Maast on each species using tag genomes or using all genomes to call SNPs with a 1% MAF threshold. For each species, tag genomes capture a higher number of the true SNPs than do all genomes, suggesting that redundant genomes bias MAF estimation and reduce SNP calling sensitivity. <bold>f</bold> The single largest genome cluster is larger for species with many tag-only SNPs compared to those with fewer. The largest genome clusters were compared between species from <bold>c</bold> with high (red axis tick) and low (blue axis tick) levels of tag-only SNPs. For three of four species with more SNPs discovered in the tag-only analysis, the largest cluster contains more than half of all genomes, implying a high level of genome redundancy that biases MAF estimation and leads to an undercount of SNPs. Height of bars shows the total number of genomes in a species and the proportion colored in purple indicates the size of the single largest genome cluster of that species. Every two adjacent species have a similar total number of genomes</p></caption><graphic xlink:href="13059_2023_3030_Fig2_HTML" id="MO2"/></fig></p>
      <p id="Par9">In the second step of the pipeline, Maast performs reference based in silico genotyping of common, bi-allelic SNPs in genomes, which may be non-tag genomes from the initial reference collection or totally new genomes. Like other methods that genotype using a single reference genome, Maast cannot genotype sites that are absent from the reference genome, and in its current implementation, Maast also does not aim to genotype rare SNPs or SNPs with more than two alleles. The workflow can be executed using genome assemblies or unassembled WGS reads. For genome assemblies, Maast aligns each query genome to the centroid genome for that species using MUMmer and directly genotypes alleles for each of the reference SNPs. For WGS reads, Maast performs exact matching between k-mers extracted from the sequencing reads and a database of k-mers covering each SNP in the reference panel that has been curated to only include k-mers that do not occur anywhere else in the entire reference genome collection of tag and non-tag genomes (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S2). The algorithm leverages the fact that most query k-mers have no chance to match sck-mers in the database. It screens subsequences of colex-ordered k-mers up front, which is faster and more RAM-efficient than using a hash table (“Methods”). This strategy is an extension of our previous method GT-Pro [<xref ref-type="bibr" rid="CR15">15</xref>] for genotyping SNPs in metagenomic sequencing libraries, specifically optimized for WGS of microbial isolates.</p>
    </sec>
    <sec id="Sec4">
      <title>Maast is orders of magnitude faster than existing tools</title>
      <p id="Par10">We evaluated the computational performance of Maast with kSNP3 and Parsnp, two other commonly used methods for microbial SNP calling. All methods were run for a single bacterial species, <italic>Agathobacter rectalis</italic> (Additional file <xref rid="MOESM3" ref-type="media">3</xref>: Table S2)<italic>,</italic> using 500, 1000, or 5000 randomly sampled genome sequences (Methods). Only SNP calling was benchmarked, and not downstream steps such as tree building. Surprisingly, both kSNP3 and Parsnp failed to run through all the <italic>A. rectalis</italic> genomes. kSNP3 was manually terminated after running for a maximum allowed time (48 h) and consuming more than 1 TB disk space, while Parsnp failed to run even for 1,000 genomes, apparently due to high intraspecific genetic diversity. To check that these results were not specific to <italic>A. rectalis</italic>, we ran both tools on two other human gut species (Additional file <xref rid="MOESM3" ref-type="media">3</xref>: Table S2): <italic>Alistipes putredinis</italic> (<italic>n</italic> = 3646) and <italic>Bacteroides_B dorei</italic> (<italic>n</italic> = 3170) and obtained the same result. We conclude that, to our knowledge, Maast is the only tool able to call SNPs in species with thousands of diverse genomes.</p>
      <p id="Par11">To evaluate computational performance when genomic divergence is more limited and in the absence of structural variation, we simulated 5000 whole genome sequences of <italic>A. rectalis</italic> by randomly introducing SNPs across a representative genome (“Methods”). While Parsnp ran to completion, kSNP3 again exceeded our 48-h maximum time window. Overall, Maast was 6.3 to &gt; 127-fold faster than Parsnp and 31 to &gt; 127 fold faster than kSNP3 (Fig. <xref rid="Fig3" ref-type="fig">3</xref>a). In addition, Maast required only 7.2 GB of RAM to process the 5,000 genomes, which was substantially less than what Parsnp used to process 100 genomes and similar to what kSNP3 used to process 1000 genomes (Additional file <xref rid="MOESM4" ref-type="media">4</xref>: Table S3). Maast also only used a moderate amount (~ 1.2 GB) of disk space. We attribute Maast’s high speed and RAM efficiency mainly to the strategy of subsampling genomes for SNP discovery. Other factors included compact data structures and parallel processing. These results demonstrate that Maast can easily run on a personal computer.<fig id="Fig3"><label>Fig. 3</label><caption><p>Evaluation of Maast computational performance and accuracy. <bold>a</bold> Comparison of genome genotyping speed between Maast, Maast without redundancy collapsing (Maast + NRC), kSNP3, and Parsnp. All methods were run on 500, 1000, and 5000 simulated <italic>A. rectalis</italic> genomes. <bold>b</bold> Comparison of short-reads genotyping speed between Maast, Snippy, and SPAdes. All three methods were run on 63 strains of <italic>B. uniformis</italic>, whose whole genome sequencing reads (~ 150 million) were downloaded from the Culturable Genome Reference (CGR) study. The <italic>y</italic>-axis of both <bold>a</bold> and <bold>b</bold> indicates elapsed seconds of running in log scale. Fewer elapsed seconds indicate better performance (faster processing speed). <bold>c</bold>–<bold>f</bold> Comparison of Maast and Snippy genotyping accuracy at non-reference alleles of SNPs in the Maast SNP panel, based on short reads <bold>c</bold>, <bold>d</bold> simulated from isolate genomes with sequencing error (15 x coverage) and <bold>e</bold>,<bold> f</bold> downloaded from isolate whole-genome sequencing projects. Both Maast and Snippy were run with default settings. <bold>c</bold>, <bold>e</bold> Positive predictive value (PPV; 1- false discovery rate) comparison, where false discoveries are genotype calls that do not match the genome. <bold>d</bold>, <bold>e</bold> Sensitivity from the simulations in <bold>c</bold> and downloaded reads in <bold>e</bold>. Sensitivity is the probability of detecting genotypes present in the genome. Color of points in <bold>c</bold>–<bold>f</bold> indicates whether the data comes from tag genomes (black) or not (red). Samples colored in red are regarded as novel to Maast databases. <bold>g</bold>, <bold>h</bold> Maast genotype concordance between <bold>g</bold> genome and short reads or <bold>h</bold> genome and long reads. In <bold>g</bold>, strain population structure of <italic>H. pylori</italic> was reconstructed using SNPs from 473 strains. Each strain has a whole genome sequence (WG) and a short read sample (SRA) as indicated in the stacked color rings. In <bold>h</bold>, the population structure of <italic>H. pylori</italic> was reconstructed from 4 strains with whole genome sequence (WG) and long reads (SRA). * kSNP3 and Parsnp runs &gt; 48 h on 5000 genomes and were manually terminated, and we plot a runtime of 48 h with the note that no output was produced</p></caption><graphic xlink:href="13059_2023_3030_Fig3_HTML" id="MO3"/></fig></p>
      <p id="Par12">We also evaluated the computational performance of Maast when calling SNPs in WGS reads. As a benchmark, we selected 63 whole genome sequencing samples of <italic>Bacteroides uniformis</italic> from the Culturable Genome Reference (CGR) study (“Methods”, Additional file <xref rid="MOESM5" ref-type="media">5</xref>: Table S4, mean = 2.38 million reads per sample). Performance was compared with Snippy as well as an assembly-based strategy using a combination of SPAdes and MUMmer. Maast was ~ 19–24 fold faster than these methods (Fig. <xref rid="Fig3" ref-type="fig">3</xref>b, d) taking &lt; 2 s to process each WGS sample and requiring 11.8 GB RAM. Altogether, we conclude that Maast greatly accelerates SNP genotyping in both assemblies and short reads and is friendly to personal computing devices.</p>
    </sec>
    <sec id="Sec5">
      <title>Maast SNP genotypes are highly accurate</title>
      <p id="Par13">To validate the accuracy of Maast SNP genotypes, we first compared Maast to Parsnp and kSNP on 1000 <italic>A. rectalis</italic> genomes with simulated SNPs (“Methods”). Erroneous alignments can in theory produce both incorrect genotypes (false positives) and missing genotypes (false negatives). False positives were only observed for kSNP (Additional file <xref rid="MOESM6" ref-type="media">6</xref>: Table S5) while false negatives were very low for Maast (<italic>n</italic> = 1) and Parsnp (<italic>n</italic> = 4) but much higher for kSNP (<italic>n</italic> = 5073). These results suggest that Maast is at least as accurate as currently available methods.</p>
      <p id="Par14">To evaluate the genotyping accuracy of Maast on short reads, we compared Maast to Snippy by running both tools with their default settings on Illumina short reads simulated from 45 isolate genomes of a single species (<italic>B. uniformis</italic>, Additional file <xref rid="MOESM5" ref-type="media">5</xref>: Table S4, 15 x coverage per genome). For each method, predicted genotypes were compared to a set of ground truth genotypes determined from whole-genome alignment of the 45 isolate genomes to the Maast reference genome. Across simulations from the 45 isolates, the median SNP positive predictive value (PPV) was very high for both methods (Maast median = 99.72%, Snippy median = 99.38%; Fig. <xref rid="Fig3" ref-type="fig">3</xref>c and Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S9a). Meanwhile, the sensitivity of Maast was consistently higher (median = 93.2%) compared to Snippy (median = 54.3%) (Fig. <xref rid="Fig3" ref-type="fig">3</xref>d, Additional file <xref rid="MOESM1" ref-type="media">1</xref>: S9c and S10), since Maast is less subject to false negatives due to reference bias [<xref ref-type="bibr" rid="CR13">13</xref>] and coverage filtering (i.e., minimum 1 × by default compared to minimum 10 × for Snippy). Because simulated reads may capture less contamination and sequencing errors than real WGS data, we repeated the evaluation with 63 short read libraries of the same species downloaded from the CGR study (<italic>B. uniformis</italic>, Additional file <xref rid="MOESM5" ref-type="media">5</xref>: Table S4). Compared to Snippy, Maast had slightly higher PPV (Maast median = 99.74%, Snippy median = 98.65%) and much higher sensitivity (Maast median = 93.3%, Snippy median = 61.7%) (Fig. <xref rid="Fig3" ref-type="fig">3</xref>e, f, Additional file <xref rid="MOESM1" ref-type="media">1</xref>: S9b, d, and S11). Higher sequencing coverage (100 x) or using paired-end reads only resulted in minor changes to the genotyping accuracy of both Maast and Snippy (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S11, 12, and 13). We conclude that Maast is a more accurate and sensitive tool compared to Snippy, reflecting the advantages of 31-mer exact matching over read alignment for SNP genotyping, especially for sequencing data with relatively more contamination or sequencing errors.</p>
      <p id="Par15">In addition, we compared Maast to a powerful pangenome SNP calling method, Cortex [<xref ref-type="bibr" rid="CR16">16</xref>], with the 45 <italic>B. uniformis</italic> strains. We used the Maast reference genome plus four additional, randomly selected genomes to generate the Cortex index. We observed that Cortex calls ~ 2.5 times more variants than does Maast. However, the runtime of Cortex was 250 times longer than Maast. We also found that genotyping results generated by Maast and Cortex were highly concordant: &gt; 93% of the SNPs called by Maast were also called by Cortex. Thus, more SNPs can be discovered with pangenome methods compared to methods like Maast that use a single reference genome. But this additional power for SNP discovery comes at a large computational cost that prohibits applications to genotyping thousands of strains.</p>
    </sec>
    <sec id="Sec6">
      <title>Maast reveals global genetic structure of 3178 <italic>H. pylori</italic> isolates</title>
      <p id="Par16">To demonstrate its scalability and utility, we leveraged Maast to analyze 3178 <italic>H. pylori</italic> whole-genome sequences from 39 countries across six continents (Fig. <xref rid="Fig4" ref-type="fig">4</xref>a, Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S8, Additional file <xref rid="MOESM7" ref-type="media">7</xref>: Table S6, Additional file <xref rid="MOESM8" ref-type="media">8</xref>: Table S7). These included isolates from five animal species in addition to humans (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S14). Overall, we identified 74,962 common SNPs in the core genome of <italic>H. pylori</italic> using Maast (“Methods”), which was &gt; 10 times more than a recent study [<xref ref-type="bibr" rid="CR17">17</xref>]. Using these genotypes, we measured genetic distance between strains across continents and by host species, sex, and disease status (Fig. <xref rid="Fig4" ref-type="fig">4</xref>b, Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S15, S16). We observed clear associations between <italic>H. pylori</italic> genotypes and geography (Fig. <xref rid="Fig4" ref-type="fig">4</xref>b and c) which supported the finding that <italic>H. pylori</italic> has distinct populations across the globe [<xref ref-type="bibr" rid="CR18">18</xref>]. Within the same continent, <italic>H. pylori</italic> strains from the same host species were more similar than those from the different host species (<italic>p</italic>-value &lt; 2.2e − 16, Wilcoxon rank sum test). Interestingly, we observed <italic>H. pylori</italic> strains from different host species but the same continent were more similar than those from human hosts living in different continents (Fig. <xref rid="Fig4" ref-type="fig">4</xref>e). This is likely due to <italic>H. pylori</italic> populations being highly heterogenized across continents, suggesting geography is a transcending factor over host species. We also observed that genetic distances between <italic>H. pylori</italic> strains were on average lower (<italic>p</italic>-value = 2.27e − 13) between pairs of healthy human hosts compared to diseased pairs (Fig. <xref rid="Fig4" ref-type="fig">4</xref>f and Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S17), implying greater genomic commonality between non-pathogenic <italic>H. pylori</italic> strains.<fig id="Fig4"><label>Fig. 4</label><caption><p>Global genetic structure of <italic>H. pylori</italic> genomes. <bold>a</bold> Geographic distribution of 3068 <italic>H. pylori</italic> strains across 39 countries with color indicating the number of strains from each country. <bold>b</bold> Strain population structure of <italic>H. pylori</italic> strains reconstructed from their Maast SNP genotypes. Stacked color rings indicate the host species (inner), continent (middle), and human host disease status (outer). <bold>c</bold>–<bold>f</bold> Comparison of genetic distances between pairs of strains from <bold>c</bold> same versus different continent, <bold>d</bold> same versus different host species within the same continents, <bold>e</bold> human versus other host species, and <bold>f</bold> control vs diseased human hosts. In <bold>e</bold>, genetic distances are calculated between pairs of strains from the same continent where one is from a human host and the other is from the indicated host species (left) or between pairs of strains from human hosts from different continents (blue box at right). The <italic>H. pylori</italic> strains that infected Rhesus monkeys were inoculated [<xref ref-type="bibr" rid="CR19">19</xref>] and thus excluded</p></caption><graphic xlink:href="13059_2023_3030_Fig4_HTML" id="MO4"/></fig></p>
      <p id="Par17">Next, we analyzed 478 <italic>H. pylori</italic> isolates downloaded from NCBI (Additional file <xref rid="MOESM9" ref-type="media">9</xref>: Table S8) to assess whether we would obtain the same results using Maast with unassembled sequencing reads instead of whole genome sequences (“Methods”). For these strains, we observed the expected similarity between isolates and their unassembled WGS reads, except for a few highly similar isolates which cannot be distinguished based on common SNPs (Fig. <xref rid="Fig3" ref-type="fig">3</xref>g and Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S18). Next, we extended this analysis to four distinct <italic>H. pylori</italic> strains that had both whole genome assembly and long-read data. We found perfect clustering of assemblies with the long-read data from the same strain (Fig. <xref rid="Fig3" ref-type="fig">3</xref>h). Altogether our evaluation suggests that the two Maast genotyping workflows, although using distinct algorithms, are highly concordant. This means that genomic data from different sources can be pooled for analysis with Maast without assembly or other preprocessing.</p>
    </sec>
    <sec id="Sec7">
      <title>Maast enables fast tracking of SARS-CoV-2 variants</title>
      <p id="Par18">To apply Maast for global pathogen surveillance, we analyzed 37,096 SARS-CoV-2 (SC2) strains, including 8734 isolate genome assemblies and 28,362 WGS read samples, collected from 60 countries over a span of ~ 200 days (downloaded from NCBI on July 19, 2020, Additional file <xref rid="MOESM10" ref-type="media">10</xref>: Table S9, Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S19, S20). Maast was able to process the data in &lt; 9 h with 36 threads and a peak RAM use of 20 GB on an AWS EC2 instance (r5.16xlarge). Analyzing patterns in these genotypes, we first observed a clear divergence of SC2 strains relative to strain NC_045512 which was one of the first sequenced SC2 strains (Fig. <xref rid="Fig5" ref-type="fig">5</xref>a). Furthermore, we found that genetic distance between SC2 strains was slightly lower within countries than between countries (Figure <xref rid="MOESM1" ref-type="media">S21</xref>). Within-country genetic distance differed across countries, likely due to differences in temporal adjacency of samples (Fig. <xref rid="Fig5" ref-type="fig">5</xref>b and Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S22). However, we also observed exceptions where geographically adjacent countries with similar temporal sampling patterns had different levels of within-country genetic distance, such as Poland and Germany (Fig. <xref rid="Fig5" ref-type="fig">5</xref>b and Additional file <xref rid="MOESM1" ref-type="media">1</xref>: S22), suggesting other underlying factors such as single versus multiple introduction sources. To track the differentiation of SC2 strains, we next used SC2 SNPs to perform dimension reduction and observed changing subspecies genetic structure over time with the emergence and fading of SC2 strain clusters (Fig. <xref rid="Fig5" ref-type="fig">5</xref>f). These results suggest that Maast is computationally efficient and accurate enough to be used to monitor the dynamics of the genetic structure of emerging pathogens at a global scale.<fig id="Fig5"><label>Fig. 5</label><caption><p>Application of Maast to track <italic>SARS-CoV-2</italic> diversification from Dec 2019 to July 2020. <bold>a</bold> Genetic distances of SARS-CoV-2 strains over time compared to one of the earliest <italic>SARS-CoV-2</italic> strains (Accession #: NC_045512). <bold>b</bold> Median genetic distance of <italic>SARS-CoV-2</italic> in a country is strongly correlated with average sampling day gap. <bold>c</bold> Subspecies structure of <italic>SARS-CoV-2</italic> over time. Each dot is a <italic>SARS-CoV-2</italic> strain, colored by sampling month with other time points in gray. Dimension reduction and visualization were performed with UMAP. Nearby samples in UMAP space have similar genotypes</p></caption><graphic xlink:href="13059_2023_3030_Fig5_HTML" id="MO5"/></fig></p>
    </sec>
  </sec>
  <sec id="Sec8">
    <title>Discussion</title>
    <p id="Par19">In this study, we present Maast, a new software tool for discovering SNPs in conspecific genomes that also includes pipelines for genotyping the panel of discovered SNPs in sequencing reads (long or short) and genome assemblies. In terms of SNP discovery, Maast is faster than existing methods due to our DynCC algorithm that identifies a subset of diverse genomes that can be used for the computationally intensive step of comparing all pairs of genomes without losing sensitivity. In fact, using these tag genomes improves our ability to identify SNPs at a given MAF and prevalence in the broader population by reducing bias due to uneven sampling of sequenced genomes. In terms of SNP genotyping, Maast uses less RAM and disk than existing methods while being about two orders of magnitude faster due to a combination of efficient data structures and novel genotyping algorithms for both genomes and unassembled reads.</p>
    <p id="Par20">The computational efficiency and accuracy of Maast enables a broad array of potential applications. In this study, we demonstrated how Maast could be used to study the genetic structure of <italic>H. pylori</italic>, a bacterial species with strong biogeographic patterns. We also used the early months of the SARS-CoV-2 pandemic as a case study to illustrate that Maast could be applied to emerging viral pathogens. Maast’s ability to process thousands of genomes makes it a useful tool for tracking microbial evolution in real time. By constructing and maintaining a SNP panel and k-mer database for any medically important species over time, Maast can be applied to rapidly genotype thousands of new samples without the need for genome assembly, enabling new variants to be monitored as they spread. Beyond these applications, Maast is also ideally suited for population genetic investigations of any species with many assembled or unassembled genome sequences. Its genotypes can be utilized to measure rates and patterns of selection, recombination, drift, and migration among lineages of a species.</p>
    <p id="Par21">Despite its advantages, Maast has several limitations. One challenge for SNP discovery is that Maast, like Parsnp and other methods requiring whole genome sequences, cannot be applied to species with very few high-quality assembled genomes. This is a common scenario for uncultured prokaryotic species plus many eukaryotes and viruses beyond the best-studied pathogens, although metagenome-assembled genomes and single-cell sequencing methods are closing this gap [<xref ref-type="bibr" rid="CR20">20</xref>–<xref ref-type="bibr" rid="CR22">22</xref>]. The main trade-off of Maast’s genotyping algorithm is that it uses SNPs discovered in an initial collection of assembled genomes and hence may fail to detect novel variants in short reads or genomes, including rare variants and SNPs that are common in lineages not well-represented in the SNP panel. This can be problematic in some settings, such as tracking the evolution of closely related pathogenic strains. Pangenome methods [<xref ref-type="bibr" rid="CR16">16</xref>, <xref ref-type="bibr" rid="CR23">23</xref>] have the potential to overcome this limitation, because they utilize more of the accessory genome. However, our benchmark using the Cortex algorithm demonstrated that the computing requirements of current pangenome implementations do not permit analysis with datasets of the scale explored in this study. Accelerating these algorithms is an exciting area for future research. In the meantime, Maast enables large-scale applications to uncover the vast genetic structure of Earth’s microbiomes using common SNPs.</p>
  </sec>
  <sec id="Sec9">
    <title>Conclusions</title>
    <p id="Par22">Maast is an open-source software tool that provides a highly efficient method for discovering and genotyping common, bi-allelic SNPs using either whole-genome sequences or unassembled sequencing reads. It includes a novel algorithm that dynamically collapses thousands of genomes into a diverse, representative set of tag genomes that can be used to discover the most common SNPs with reduced computational resources and less bias than using all genomes for a species. This SNP discovery method is combined with a genotyping strategy that is a hybrid of whole-genome alignment and k-mer exact matching. Maast’s genotyping method achieves higher speed and accuracy than existing tools, scaling up population genetic analysis to an unrivaled number of strains compared to state-of-the-art methods. We have demonstrated that Maast could efficiently reconstruct the genetic structure of <italic>H. pylori</italic> and track SARS-CoV-2 variants during the COVID-19 outbreak, applications that involved thousands of strains across the globe. As the number of species with multiple high-quality, near-complete genome sequences continues to grow, Maast is poised to catalog this vast genetic variation.</p>
  </sec>
  <sec id="Sec10">
    <title>Methods</title>
    <sec id="Sec11">
      <title>Maast overview</title>
      <p id="Par23">Maast is an open-source bioinformatics tool for fast and accurate SNP genotyping from conspecific genome assemblies and sequencing reads. The development of Maast is motivated by the following observations: (1) redundant genomes are common in genome databases and these contribute little to SNP discovery while imposing a computational burden, (2) the level and pattern of redundancy vary across species, (3) the choice of reference genome affects SNP discovery, and (4) for sequencing reads, genotyping by assembly first or read alignment does not scale with increasing amounts of data.</p>
      <p id="Par24">Maast implements a catalog-first-genotype-later scheme. It was designed in order to enable genotyping to be scaled up for very large populations. Maast also synchronizes microbial genotyping for both genome assemblies and sequencing reads. The key innovations of Maast are its efficiency and novel workflow. We note that the underlying algorithms in this workflow leverage previously existing methods for whole genome alignment and k-mer exact matching.</p>
      <p id="Par25">Maast takes a set of intraspecific genomes as input and has the following major steps per species: (1) estimates the pairwise genomic distance between genomes and identifies genome clusters, (2) collapses clusters to a single tag genome per cluster, (3) picks a centroid genome as reference genome, (4) performs multiple whole-genome alignment, constructs consensus genome and calls SNPs to generate a SNP panel, and (5) leverages the SNP panel to perform in silico genotyping for genome assemblies or sequencing reads.</p>
    </sec>
    <sec id="Sec12">
      <title>Pairwise genomic distance calculation</title>
      <p id="Par26">Maast estimates the genomic distance between a pair of genomes using Mash [<xref ref-type="bibr" rid="CR24">24</xref>] (version 2.2). Mash distance can be used to approximate whole-genome average nucleotide identity (ANI) between similar genomes (e.g., conspecific genomes). For input genomes, Maast first builds 20-mer profiles or Mash sketches using its “sketch” subcommand with default parameter except for option “-s 5000” (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S1). Next, Maast calls the “dist” subcommand in Mash with default options to compute pairwise genomic distances.</p>
    </sec>
    <sec id="Sec13">
      <title>Identify genome clusters and tag genomes</title>
      <p id="Par27">Maast automatically determines the number of genome clusters (n) based on the user-defined minor allele frequency (MAF): n = 1/MAF. By default, SNPs are defined as genomic sites with MAF &gt; 1%. In this case, at least 100 genomes are required to enable an effective resolution of 1%, that is 1 in 100 genomes has the minor allele. With higher MAF thresholds, fewer genomes are needed, and vice versa.</p>
      <p id="Par28">We implemented a dynamic graph algorithm (Dynamic Connected Component search (DynaCC)) in Maast to identify tag genomes based on pairwise Mash distances. The goal is to identify a minimal set of genomes that captures as much genetic variation as possible through a heuristic search. DynaCC starts with a complete graph where nodes are genomes and edges are weighted by distance. The algorithm applies a distance cutoff (d-cut) strategy to prune edges, where pairs of genomes (edges) with a distance higher than a d-cut are deemed sufficiently dissimilar and removed. By applying a stringent d-cut, many edges are deleted, which reduces the complete genome graph to connected components and isolated nodes. By doing so, Maast avoids loading a complete connected graph into RAM as well as performing operations on it, which would be computationally expensive when the number of genomes is large. A connected component here is analogous to a genome cluster which is defined as a maximum set of nodes in which a path exists between every pair of nodes, and a path is a sequence of edges which joins a pair of nodes. The algorithm identifies tag genomes as a union of hub genomes from connected components and all isolated nodes, and by default, it chooses a hub genome as the genome with the most edges in a connected component (i.e., the highest degree centrality after filtering out edges below the distance cutoff). Maast also allows users to identify hub genomes using weighted edges through the flag “–edge-weighted” as well as more sophisticated node centrality estimation methods (such as eigenvector centrality, closeness, information, betweenness, and load centrality) through the flag “–tag-centrality”. Users can also run Maast using all genomes, rather than with tag genomes, as long as they have sufficient computing power given the number of genomes.</p>
      <p id="Par29">Next, we sought to implement an algorithm that solves the problem of identifying ~ n tag genomes from N genomes, where N &gt; n. Since the level and pattern of redundancy within species vary, an identical d-cut can result in detected n (n′) drastically different across species. When n′ is lower than the target n, SNPs are called with a de facto higher MAF, resulting in a lower sensitivity for detecting SNPs. When n′ is much higher, the benefit of computing efficiency will diminish. It is also unrealistic to predict a static d-cut per species, due to the unknown diversity of input genomes. Here DynaCC searches and determines an optimal d-cut per species dynamically with respect to the input genomes. It first uses a range factor (rf; default 1.2) designating a critical range of n (n to n*rf) that is acceptable, since the exact n may never exist in the search space. It then applies an initial d-cut (default 0.01) and if n′ is lower than n, it searches the lower bound of d-cut with an exponential decay by a factor of 10 until an n′ higher than n is found or a hard bound (default 0.000001) is reached. Between the initial d-cut and lower bound, the algorithm performs a binary search until an n′ falling in the critical range is found or the maximum searching step (default 10) runs out. When no optimal n′ is found, the algorithm settles with a suboptimal n′ which is both higher than and nearest to n. The resulting n′ tag genomes are used for the downstream workflow.</p>
      <p id="Par30">DynaCC presents two advantages for clustering whole genome sequences compared to other clustering tools, such as CD-HIT, vsearch, and MMSeqs2. First, DynaCC leverages a fast approximation of ANI, making it better suited for processing a large number of whole genome sequences. For example, we ran DynaCC, CD-HIT, vsearch (UCLUST equivalent), and MMSeqs2 on 3,646 whole genomes of <italic>Alistipes putredinis</italic> (Species ID: 101302). All programs were run in an identical computing environment (AWS EC2 r5.16xlarge) for a maximum of 48 h. DynaCC successfully divided these genomes into 110 clusters in ~ 3 min, while the same task took MMSeqs2 ~ 4 h. Both CD-HIT and vsearch ultimately did not run through the task: the CD-HIT main program was terminated by signal 11 (reached 498 GB RAM cap) and vsearch did not complete within 48 h. Second, DynaCC is more efficient at dividing whole genome sequences into a fixed number of clusters. Other algorithms will usually take one single distance (or similarity) cutoff as input and use this same cutoff across all species to divide genome sequences into a smaller untargeted number of clusters. DynaCC automatically searches a large space of cutoffs around a target minimum number of clusters (i.e., tag genomes) and finds an  optimal cutoff per species to generate at least the targeted number of clusters. For example, DynaCC automatically divided genomes of <italic>A. putredinis</italic> (<italic>n</italic> = 3646) and <italic>A. rectalis</italic> (<italic>n</italic> = 5214), two example species in Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S5, into ~ 100 clusters (110 clusters for <italic>A. putredinis</italic> and 106 for <italic>A. rectalis</italic>), while using a static genomic distance cutoff of 0.01 resulted in 46 genome clusters for <italic>A. putredinis</italic> and 2650 clusters for <italic>A. rectalis</italic>. In contrast, MMSeqs2 by default generated 3646 <italic>A. putredinis</italic> clusters and 5214 <italic>A. rectalis</italic> clusters, barely collapsing any redundant genomes. Thus, DynaCC rapidly prunes a large set of genomes to a fairly consistent target size across diverse and heterogeneous species. We implemented a method with this behavior because we found that it enabled efficient downstream SNP calling.</p>
    </sec>
    <sec id="Sec14">
      <title>Identify the centroid of tag genomes</title>
      <p id="Par31">The choice of reference genome is important to SNP discovery. Maast objectively picks a reference genome for each species as the centroid of tag genomes. Maast calculates all pairwise genomic distances between tag genomes using Mash. For simplicity, the tag genome with the lowest average L-1 distance to all other tag genomes is selected as the centroid genome for the species. Maast also allows users to select the centroid genome using L-2 and L-Inf distance. By default, Maast uses the centroid genome as the reference genome for multiple sequence alignments as well as SNP calling. Unless otherwise mentioned, we used the centroid genome for each SNP analysis in this study.</p>
    </sec>
    <sec id="Sec15">
      <title>Multiple sequence alignment and SNP calling</title>
      <p id="Par32">For each species, we performed whole-genome alignment by aligning each intraspecific genome to the centroid or otherwise specified reference genome using MUMmer [<xref ref-type="bibr" rid="CR25">25</xref>] (version 4.0.0beta2) with the default parameters. Unreliable and repeat-induced alignments were removed using the delta-filter program from MUMmer with options ‘-q -r’ and the remaining alignments were then extracted using the show-coords program with default parameters. To promote the quality of multiple whole-genome alignment, we removed regions that are overly short (&lt; 500 bp) or poorly aligned (alignment ANI &lt; 95% of whole-genome ANI). Maast horizontally concatenates all qualified alignments and calls SNPs as sites with the following characteristics: 1) two or more nucleotides, 2) present in at least a user-supplied percentage of genomes (prevalence threshold, default ≥ 90%), and 3) minor allele frequency greater than a user-supplied value (default ≥ 1%). Finally, Maast organizes the called SNPs into a panel and outputs it in a standard VCF format. We note that Maast does not identify insertion and deletion variants (INDELs) or structural variants, even though it produces a multiple sequence alignment in a multi-FASTA format.</p>
    </sec>
    <sec id="Sec16">
      <title>Maast in silico genotyping of SNPs</title>
      <p id="Par33">For genome assemblies, Maast leverages the SNP panel from upstream steps to perform genotyping. Maast aligns each query genome, which could be non-tag genomes from SNP discovery or other additional input genomes, to the centroid genome using MUMmer (version 4.0.0beta2) with consistent quality control steps and parameters identical to those used in SNP calling. For each SNP in the panel, Maast then searches all best alignments to locate the genomic position of the SNP. If the genomic position of a SNP is found in an alignment, Maast reads and reports the allele on the query genome; otherwise, Maast reports the SNP as missing.</p>
      <p id="Par34">For sequencing reads, Maast uses a k-mer exact matching algorithm for efficient and accurate genotyping. Maast leverages the SNP panel to extract short unique genomic regions (k-mers) as probes for detecting alleles that distinguish highly similar genomes and uses these k-mers to rapidly genotype reads. For k-mer extraction, Maast identifies any 31-base SNP-covering k-mers (sck-mers) that cover (in any of the 31 bases) each of the SNP alleles. We chose 31 for k based on analyses in our previous study. For each SNP, Maast first extracts all possible 31-mers containing the SNP site from the representative genome (sck-mers for reference allele). Next, Maast extracts sck-mers by sliding a fixed-size window along the multiple sequence alignment. At any given position, the window allows extraction of n sck-mers, where n equals the number of rows in the multiple sequence alignment (i.e., the number of aligned genomes). Next, Maast reduces these n sck-mers to m unique sck-mers (m <inline-formula id="IEq1"><alternatives><tex-math id="M1">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\le$$\end{document}</tex-math><mml:math id="M2"><mml:mo>≤</mml:mo></mml:math><inline-graphic xlink:href="13059_2023_3030_Article_IEq1.gif"/></alternatives></inline-formula> n) and selects the one from these m with the highest frequency across the n genomes. INDELs near (within 30 bp of) a SNP could affect the number of sck-mers extracted. Maast accounts for three scenarios: no INDELs, INDELs at one side of a SNP site, and INDELs at both sides of a SNP site. When no INDELs are present, all 31 sck-mers will be extracted (note that the SNP site can be at any base on a 31-mer). When INDELs only occur at one side of a SNP site, 1 to 30 sck-mers will be extracted, depending on the location of the nearest INDEL to the SNP site. In rare cases where two or more INDELs flank a SNP site, no sck-mers will be extracted. To exclude sck-mers from repetitive genomic regions, Maast searches every candidate sck-mer in all input genomes, not only tag genomes, and removes those that occur anywhere else in any genome. We retrieved the reverse complements of all sck-mers. In this way, for every SNP site, there will be up to 62 sck-mers targeting the reference or alternative allele.</p>
      <p id="Par35">To facilitate efficient storage and match of sck-mers, we use 64-bit integers to represent the sck-mers with 00 for “A,” 01 for “C,” 10 for “G,”and 11 for “T”and discarded the sck-mers with wildcards (e.g. “N”). We sort sck-mers in colex order which is essentially a reflection of lexicographic order that reads a sequence from the right to the left (versus left to the right). For example, given a set of unsorted sequences, {“214”, “123”, “134”, “125”}, the corresponding lexicographic order is {“123”, “125”, “134”, “214”} and the colex order is {“123”, “214”, “134”, “125”}. Colex order enables fast matching of suffixes, because related suffixes are near each other in a list. Specifically, we build an <italic>l-</italic>index to quickly locate all sck-mers that share a given suffix by simply pointing to the first and last entries for each suffix. This is possible because sck-mers that end with a suffix <italic>s</italic> of length <italic>l</italic> will occupy consecutive entries in the colex sorted list. We empirically selected <italic>l</italic> = 36 as default. For each input read, Maast first breaks it down into 31-mers and encodes them into 64-bit integers. Our goal is to find exact matches of these 31-mers with sck-mers and the following exact-match algorithm is implemented: (1) look up query suffix in the <italic>l-mer</italic> index, if found, (2) examine all sck-mer entries identified by the <italic>l-mer</italic> index one by one and report exact matches. After generating all k-mers in each metagenomic sequencing read, Maast recruits an L-bit index (L-index; last L bits/suffix of encoded k-mer) to locate a bucket of pre-sorted sck-mers in the database containing all possible exact matches to the full k-mer. The algorithm invokes a sequential search for exact matches between the full k-mer and only the sck-mers in this bucket. We note that both alleles may be detected for one SNP site due to the presence of more than one strain, de novo mutations, or sequencing errors in the sample. In the default output of Maast, if multiple alleles are detected, the counts of both alleles will be reported. Further processing of the alleles is delegated to downstream analysis. Throughout this study, we assumed there was only one dominant strain per sample and when multiple alleles were detected for a SNP site within one sample, we proceeded with the major allele (allele frequency &gt; 0.5) and ignored the minor allele for all analyses unless otherwise mentioned. The count of reads matching an allele will be incremented by one as long as at least one k-mer was detected in the read being processed.</p>
      <p id="Par36">The output format of in silico genotyping is similar for both genome assemblies and sequencing reads. It uses a concise table-shaped format for its output, in which every row represents a bi-allelic SNP site. Each row has exactly 8 fields: species, SNP ID, contig, contig position, allele 1, allele 2, and coverage of allele 1 and coverage of allele 2. Currently, the algorithm only supports bi-allelic SNPs which are the vast majority of the SNPs.</p>
    </sec>
    <sec id="Sec17">
      <title>UHGG whole genome sequences and species</title>
      <p id="Par37">We downloaded genome sequences from the Unified Human Gastrointestinal Genomes [<xref ref-type="bibr" rid="CR2">2</xref>] (UHGG) at <ext-link ext-link-type="uri" xlink:href="http://ftp.ebi.ac.uk/pub/databases/metagenomics/mgnify_genomes">http://ftp.ebi.ac.uk/pub/databases/metagenomics/mgnify_genomes</ext-link> as of September 2019. The UHGG database is a very large collection of gut microbial whole genome sequences, which are originally from both isolate assemblies and metagenome-assembled genomes (MAGs). The inclusion of MAGs from diverse human populations and geographic locations is critical for capturing natural genetic variation within human gut species. From the UHGG database, we selected 146 species, each with 200 or more high-quality (completeness &gt;  = 90% and contamination rate &lt;  = 5%) whole genome sequences, which accounted for a total of 109,365 genomes. Twenty-nine of them had more than 1000 genomes, and <italic>Escherichia coli_D</italic> (species id: 102506) had the most genomes (<italic>n</italic> = 6645).</p>
    </sec>
    <sec id="Sec18">
      <title>Comparing Maast to related methods</title>
      <p id="Par38">We compared Maast to several other methods in a series of simulations and data analyses designed to evaluate different aspects of computational performance and accuracy. For SNP calling in whole genome sequences, we included two methods, Parsnp and kSNP, which represented two distinct methods. Parsnp reports SNPs in the coordinates of the specified reference genome, and kSNP does not. We selected ParSNP as opposed to other methods for calling SNPs through multiple whole genome alignment, such as Mugsy [<xref ref-type="bibr" rid="CR26">26</xref>] and Mauve [<xref ref-type="bibr" rid="CR27">27</xref>], due to its improved computing performance and similar accuracy [<xref ref-type="bibr" rid="CR10">10</xref>]. For SNP calling in short reads, we included Snippy, a representative of a widely used three-step workflow: short reads first are aligned to reference genomes (read mapping), mapped reads are then piled up for counting coverage per site (pile-up), and SNPs are called from site coverage profiles (SNP calling). Specifically, Snippy (<ext-link ext-link-type="uri" xlink:href="https://github.com/tseemann/snippy">https://github.com/tseemann/snippy</ext-link>; June 2020) uses BWA mem [<xref ref-type="bibr" rid="CR28">28</xref>] (version 0.7.17-r1188) for read mapping, samtools [<xref ref-type="bibr" rid="CR29">29</xref>] (version 1.12) to sort and filter BAM files, and freebayes [<xref ref-type="bibr" rid="CR30">30</xref>] (version v1.3.5) for pile-up and SNP calling. Here, we chose Snippy for comparisons and analyses as it was recently reported to be the best method overall among methods that follow a similar strategy [<xref ref-type="bibr" rid="CR31">31</xref>]. To control for possible biases in using the Maast tag genomes as representative genomes, we instead used the UHGG representative genomes with all methods unless otherwise specified.</p>
      <p id="Par39">In all comparisons, we ran Maast, Parsnp, kSNP, and Snippy with default parameters except for a flag of “-c” for Parsnp to indicate all genomes are from the same species. For all paired-end samples, we processed only forward reads (fastq 1) for the simplicity of comparison and analysis. We skipped a sample if it did not have a forward read sample as extracted from a SRA file using fastq-dump in the SRA toolkit. However, we note that using the reads of both directions can effectively increase the coverage, which thus should be recommended especially for species with low abundance.</p>
    </sec>
    <sec id="Sec19">
      <title>Computing performance evaluations</title>
      <p id="Par40">We compared Maast with kSNP3 and Parsnp to evaluate its computing performance on SNP calling with whole genome sequences. We downloaded a total of 5214 high-quality genomes for one of the most well-sequenced bacterial species, <italic>Agathobacter rectali</italic>, from UHGG genome colletion (Additional file <xref rid="MOESM3" ref-type="media">3</xref>: Table S2). We randomly sampled 500, 1000, or 5000 genome sequences and ran all three methods on these genome sequences to assess the scalability of these methods. Since both kSNP3 and Parsnp failed to run through all the <italic>A. rectalis</italic> genomes, we downloaded high-quality genomes from UHGG for two other well-sequenced species, i.e., 3646 genomes for <italic>Alistipes putredinis</italic> and 3170 genomes for <italic>Bacteroides_B dorei</italic> (Additional file <xref rid="MOESM3" ref-type="media">3</xref>: Table S2), and repeated the evaluation with both species to ensure the observed issue was not limited to a single species. To enable the comparison between Maast, Parsnp, and kSNP as well as the performance evaluation of each method, we simulated genomes to control the level of genomic divergence within a species. For the simulation, we took a random genome (UHGG id: GUT_GENOME143713) from <italic>Agathobacter rectalis</italic> as a simulation template and randomly selected 10,000 genomic positions on the template to be SNP sites. For each simulated genome, 10% of the SNP sites (1000 SNPs) were randomly selected to be non-reference alleles, which we inserted in silico. For simplicity, we only simulated bi-allelic SNPs. To evaluate the scalability of the methods, we used three levels of input size (500, 1000, and 5000 genomes).</p>
      <p id="Par41">To evaluate SNP genotyping in short reads, we downloaded a total of 63 samples of short reads for an arbitrary species (<italic>Bacteroides uniformis</italic>) from the Culturable Genome Reference (CGR) study [<xref ref-type="bibr" rid="CR32">32</xref>]. Each sample provided a distinct sequenced strain of that species. Altogether these samples accounted for a total of ~ 150 million reads.</p>
      <p id="Par42">We evaluated the computing performance of Maast and other tools on an AWS EC2 instance with the following specifications: AWS r5.16xlarge, 32 physical CPU cores (64 vCPU), Intel 8175 M CPU @ 2.50 GHz, 512 GB RAM and EBS gp2 RAID array providing 13,600 Mbps bandwidth. We measured both speed and peak RAM consumption using the GNU time (version 1.7) command with option “-v”.</p>
      <p id="Par43">To ensure a fair comparison between different methods, all methods were run on all of the input data with the same reference genome whenever one was used. Only the step of SNP calling was evaluated; if a method had downstream steps such as SNP tree-building we did not benchmark these. Each method was run using all cores of an environment whenever possible.</p>
      <p id="Par44">We manually terminated the running of any tool after both tools had been running over a designated maximum running time window (48 h) and had not finished. When terminated, we estimated the speed of Parsnp and kSNP with the maximum time use of 48 h and projected peak RAM use linearly as a function of the number of genomes.</p>
      <p id="Par45">For the example species of <italic>Bacteroides uniformis</italic>, the end-to-end runtime breakdown of Maast is ~ 7 min for picking tag genomes and generating SNP panel, ~ 13 min for building sck-mer database, and ~ 19 min for genotyping 2746 whole-genome assemblies or ~ 90 s for genotyping 63 samples of whole-genome sequencing short reads.</p>
    </sec>
    <sec id="Sec20">
      <title>Accuracy evaluation of SNPs from simulated and downloaded reads</title>
      <p id="Par46">To evaluate the accuracy of SNP genotyping by Maast in short reads and to compare it to Snippy, we simulated reads from whole genome sequences. For these simulations, we downloaded a total of 45 isolate genomes for a species (<italic>Bacteroides uniformis</italic>) from the CGR study. These genomes were cultivated from fecal samples of healthy humans and characterized as non-redundant and high-quality draft genomes. We used InSilicoSeq [<xref ref-type="bibr" rid="CR33">33</xref>] (version 1.4.2) with the options “–model HiSeq” to simulate up to 5.3 million reads per genome with Illumina length and error characteristics. This generated two paired-end read files each containing ~ 1 million 126 bp-long reads from each genome. For simplicity, we proceeded only the forward reads. We used genome coverage of 15 x for simulations by randomly drawing reads from the simulated metagenomes. The number of reads required for a level of coverage c was estimated by the following formula: number of reads = c × genome length / 126. For example, to provide a 15 x coverage for a genome with a size of 6 M bp, a rough number of 714,285 (15 × 5,000,000/126) 126-bp reads are needed. To complement the simulations above, we extended the accuracy analyses to the reads simulated from the same genomes at 100 × coverage as well as the 63 samples of short reads used in the computing performance evaluation. For these analyses, the reads were processed as both paired-end reads, in which forward and reverse reads were both supplied and aligned as pairs, and as single-end reads, in which forward and reverse reads were merged and supplied as a single file.</p>
      <p id="Par47">To ensure a fair comparison, we ran Maast and Snippy on both the simulated and downloaded reads with default parameters and the same high-quality reference genome (i.e., UHGG species representative genome) which was arbitrarily selected. We did not use the centroid genome as the reference genome here to control possible biases. Our evaluations focused on the correct identification of SNPs and on the accuracy of the alleles in the typed SNPs. For each strain, ground truth genotypes were determined by aligning the whole sequence of that strain to the reference genome. We focused our evaluations on the SNPs that were potentially able to be genotyped by both Maast and Snippy, i.e., SNPs in the Maast panel. True positives (TP) and false positives (FP) were the correct and incorrect genotypes compared to ground truth; false negatives (FN) were sites with no genotype or an incorrect genotype. In this way, we conveniently calculated the Positive predictive value (PPV) as the ratio between the sum of TP sites and the sum of all reported sites and the sensitivity as TP/(TP + FN) or the ratio of TP sites to the total number of sites in the Maast SNP panel. These values were calculated for each method on non-reference sites only as Snippy only reported them.</p>
    </sec>
    <sec id="Sec21">
      <title>Reconstruction of genetic structure of<italic> H. pylori</italic></title>
      <p id="Par48">To show Maast is powerful for exploring genetic structure within microbial species, we downloaded a total of 3524 whole genome sequences of <italic>H. pylori</italic> from NCBI and PATRIC [<xref ref-type="bibr" rid="CR34">34</xref>] websites as of March 2021. We kept 3428 high-quality genomes (completeness &gt;  = 90% and contamination rate &lt;  = 5%) as determined using checkM, which included 1672 and 1756 genomes from NCBI and PATRIC, respectively (Additional file <xref rid="MOESM7" ref-type="media">7</xref>: Table S6). We ran the SNP calling module of Maast with default parameters (site prevalence &gt; 0.9 and MAF &gt; 0.01) on the whole genome sequences, resulting in 107 tag genomes and a panel of 275,116 SNPs. We then ran the database building module of Maast with default settings and generated a sck-mer database with 3,566,180 sck-mers and 74,962 SNPs that were covered by at least one sck-mer.</p>
      <p id="Par49">Next, we sought to determine whether the common SNPs discovered and typed by Maast could be used for biogeographic analyses of diverged <italic>H. pylori</italic> strains. To maximize the number of strains in this analysis, we downloaded an additional 1522 short-read samples from NCBI SRA as of April 2021, each representing a distinct strain. We then combined these short-read samples together with 1756 PATRIC genomes to form one of the largest <italic>H. pylori</italic> strain collections (<italic>n</italic> = 3178) to date with diverse host and geographic information (Additional file <xref rid="MOESM8" ref-type="media">8</xref>: Table S7). We did not include NCBI whole genome sequences due to less richness in metadata. We ran Maast on these strains and used the RAxML [<xref ref-type="bibr" rid="CR35">35</xref>] algorithm to calculate pairwise genetic distance as well as construct a phylogenetic tree based on concatenated alleles of SNP sites genotyped. We uploaded the resulting RAxML tree file to the iTol [<xref ref-type="bibr" rid="CR36">36</xref>] website for visualization. To account for possible bias due to less covered SNPs, we applied two filters to both the SNPs and strains: (1) we excluded a SNP from this analysis if it was present in fewer than 5 strains, and (2) we excluded a strain if it had &lt; 1000 genotyped SNPs or &lt; 50% of total SNPs genotyped.</p>
      <p id="Par50">To further validate consistency between Maast SNP genotyping of whole genome sequences and short reads, we identified 478 <italic>H. pylori</italic> strains that had both raw whole-genome sequencing reads and assembled genomes available in NCBI records (Additional file <xref rid="MOESM9" ref-type="media">9</xref>: Table S8). We used similar steps to run Maast on these strains and reconstructed a phylogenetic tree.</p>
    </sec>
    <sec id="Sec22">
      <title>Tracking early outbreak of SARS-CoV-2</title>
      <p id="Par51">We analyzed SARS-CoV-2 strains from the early outbreak. In contrast to the long evolutionary history of <italic>H. pylori</italic>, genomic tracking of SARS-CoV-2 was quite recent and extensive, which provided a good example to evaluate how well Maast could be used to track the genetics of a burst of highly similar genomes. We downloaded a total of 37,096 SARS-CoV-2 strains from diverse geographic regions (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S19), including 8734 whole genome sequences from the NCBI <italic>SARS-CoV-2</italic> Data Hub as well as 28,362 short read samples available from the NCBI SRA as of July 2020 (Additional file <xref rid="MOESM10" ref-type="media">10</xref>: Table S9). As expected, the Mash distances between SARS-CoV-2 genomes were extremely low due to the short evolution history (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S20). To effectively differentiate these strains, we included rare SNPs in this application by running Maast with site prevalence &gt; 0.95 and MAF &gt; 0.001 on the whole genome sequences of SARS-CoV-2, which resulted in 1077 tag genomes and a panel of 1114 SNPs. With Maast, we built a sck-mer database, which included 128,416 sck-mers and 1045 SNPs that were covered by at least one sck-mer. Then, we genotyped SNPs for the rest of the strains with Maast and computed SNP-based genetic distance and a RAxML tree as in the <italic>H. pylori</italic> analysis.</p>
      <p id="Par52">To visually track the genetic change of SARS-CoV-2 over time, we identified the major allele (allele with the highest frequency across strains) of each SNP, generated a binary matrix of major allele presence/absence per strain, and performed dimension reduction on this matrix with UMAP (umap package version 0.2.3.1) in R. We plotted all strains in the resulting UMAP coordinates. We visually identified 1,073 outliers (&lt; 3% of total strains) and removed them from the plot. To account for possible bias due to less covered SNPs, we applied two filters to both genomes and metagenomes: (1) we excluded a SNP in both genomes and metagenomes if it was present in fewer than 5 metagenomes, and (2) we excluded a metagenome if it had &lt; 1000 genotyped SNPs or &lt; 50% of total SNPs genotyped.</p>
    </sec>
  </sec>
  <sec sec-type="supplementary-material">
    <sec id="Sec23">
      <title>Supplementary Information</title>
      <p>
        <supplementary-material content-type="local-data" id="MOESM1">
          <media xlink:href="13059_2023_3030_MOESM1_ESM.docx">
            <caption>
              <p><bold>Additional file 1.</bold> Supplementary Figures S1 to S22.</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM2">
          <media xlink:href="13059_2023_3030_MOESM2_ESM.xlsx">
            <caption>
              <p><bold>Additional file 2: Supplementary Tables S1.</bold> Summary of intra-specific genomes and common SNPs for 146 microbial species associated with the human gut.</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM3">
          <media xlink:href="13059_2023_3030_MOESM3_ESM.xlsx">
            <caption>
              <p><bold>Additional file 3: Supplementary Tables S2.</bold> List of UHGG genomes for 3 CGR species that were used for evaluating the computational performance of Maast.</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM4">
          <media xlink:href="13059_2023_3030_MOESM4_ESM.xlsx">
            <caption>
              <p><bold>Additional file 4: Supplementary Tables S3.</bold> Detailed computational performance of Maast, Parsnp and kSNP based on running each tool on 500, 1000 and 5000 genomes.</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM5">
          <media xlink:href="13059_2023_3030_MOESM5_ESM.xlsx">
            <caption>
              <p><bold>Additional file 5: Supplementary Tables S4.</bold> List of accession numbers for the whole genome assemblies and sequencing reads of <italic>B. uniformis</italic>.</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM6">
          <media xlink:href="13059_2023_3030_MOESM6_ESM.xlsx">
            <caption>
              <p><bold>Additional file 6: Supplementary Tables S5.</bold> Detailed comparison of SNP calling accuracy between Maast, Maast + NRC, kSNP and Parsnp.</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM7">
          <media xlink:href="13059_2023_3030_MOESM7_ESM.xlsx">
            <caption>
              <p><bold>Additional file 7: Supplementary Tables S6.</bold> List of accession numbers for 3,428 whole genome assemblies of <italic>H. pylori</italic>.</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM8">
          <media xlink:href="13059_2023_3030_MOESM8_ESM.xlsx">
            <caption>
              <p><bold>Additional file 8: Supplementary Tables S7.</bold> Accession numbers and metadata of 3,178 <italic>H. pylori</italic> strains.</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM9">
          <media xlink:href="13059_2023_3030_MOESM9_ESM.xlsx">
            <caption>
              <p><bold>Additional file 9: Supplementary Tables S8.</bold> List of 475 <italic>H. pylori</italic> strains with paired whole genome assemblies and sequencing reads.</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM10">
          <media xlink:href="13059_2023_3030_MOESM10_ESM.xlsx">
            <caption>
              <p><bold>Additional file 10: Supplementary Tables S9.</bold> Accession numbers and metadata of 37,096 SARS-CoV-2 strains downloaded from the NCBI <italic>SARS-CoV-2</italic> Data Hub and SRA.</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM11">
          <media xlink:href="13059_2023_3030_MOESM11_ESM.docx">
            <caption>
              <p><bold>Additional file 11.</bold> Review history.</p>
            </caption>
          </media>
        </supplementary-material>
      </p>
    </sec>
  </sec>
</body>
<back>
  <fn-group>
    <fn>
      <p>
        <bold>Publisher's Note</bold>
      </p>
      <p>Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p>
    </fn>
  </fn-group>
  <notes notes-type="author-contribution">
    <title>Authors’ contributions</title>
    <p>ZJS conceived the project, developed the method, designed and performed the computational experiments, interpreted the results, wrote the software, made figures and tables, and drafted the manuscript. SN provided feedback and tested the software. KSP supervised the project, designed the computational experiments, interpreted the results, and provided feedback, funding, and computing resources. SN and KSP revised the manuscript. All authors read and approved the final manuscript.</p>
    <sec id="FPar1">
      <title>Review history</title>
      <p id="Par53">The review history is available as Additional file <xref rid="MOESM11" ref-type="media">11</xref>.</p>
    </sec>
    <sec id="FPar2">
      <title>Peer review information</title>
      <p id="Par54">Kevin Pang was the primary editor of this article and managed its editorial process and peer review in collaboration with the rest of the editorial team.</p>
    </sec>
  </notes>
  <notes notes-type="funding-information">
    <title>Funding</title>
    <p>This work was funded by the Chan Zuckerberg Biohub, Gladstone Institutes, NSF grant #1563159, and NHLBI grant #HL160862. The work conducted by the US Department of Energy Joint Genome Institute was supported by the Office of Science of the US Department of Energy under contract no. DE-AC02-05CH11231.</p>
  </notes>
  <notes notes-type="data-availability">
    <title>Availability of data and materials</title>
    <p>All described datasets are publicly available through the corresponding repositories. Genome assemblies and whole genome sequencing samples are available at UHGG, NCBI, and PATRIC database with accession numbers in supplementary tables: genome assemblies for <italic>Alistipes putredinis</italic>, <italic>Bacteroides_B dorei</italic>, and <italic>Agathobacter rectalis</italic> (Additional file <xref rid="MOESM3" ref-type="media">3</xref>: Table S2), and both genome assemblies and whole genome sequencing samples for <italic>Bacteroides uniformis</italic> (Additional file <xref rid="MOESM5" ref-type="media">5</xref>: Table S4), <italic>Helicobacter pylori</italic> (Additional files <xref rid="MOESM7" ref-type="media">7</xref>, <xref rid="MOESM8" ref-type="media">8</xref> and <xref rid="MOESM9" ref-type="media">9</xref>: Table S6, S7, and S8) and SARS-CoV-2 (Additional file <xref rid="MOESM10" ref-type="media">10</xref>: Table S9).</p>
    <p>Maast is written in C +  + and Python, and it is released as open-source software under the MIT license. The source code and documentation of Maast is available on Zenodo and GitHub (<ext-link ext-link-type="uri" xlink:href="https://github.com/zjshi/Maast">https://github.com/zjshi/Maast</ext-link> [<xref ref-type="bibr" rid="CR37">37</xref>, <xref ref-type="bibr" rid="CR38">38</xref>]).</p>
  </notes>
  <notes>
    <title>Declarations</title>
    <notes id="FPar3">
      <title>Ethics approval</title>
      <p id="Par55">Not applicable.</p>
    </notes>
    <notes id="FPar4" notes-type="COI-statement">
      <title>Competing interests</title>
      <p id="Par56">The authors declare that they have no competing interests.</p>
    </notes>
  </notes>
  <ref-list id="Bib1">
    <title>References</title>
    <ref id="CR1">
      <label>1.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Jain</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Rodriguez-R</surname>
            <given-names>LM</given-names>
          </name>
          <name>
            <surname>Phillippy</surname>
            <given-names>AM</given-names>
          </name>
          <name>
            <surname>Konstantinidis</surname>
            <given-names>KT</given-names>
          </name>
          <name>
            <surname>Aluru</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>High throughput ANI analysis of 90K prokaryotic genomes reveals clear species boundaries</article-title>
        <source>Nat Commun</source>
        <year>2018</year>
        <volume>9</volume>
        <fpage>5114</fpage>
        <pub-id pub-id-type="doi">10.1038/s41467-018-07641-9</pub-id>
        <?supplied-pmid 30504855?>
        <pub-id pub-id-type="pmid">30504855</pub-id>
      </element-citation>
    </ref>
    <ref id="CR2">
      <label>2.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Almeida</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Nayfach</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Boland</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Strozzi</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Beracochea</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Shi</surname>
            <given-names>ZJ</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>A unified catalog of 204,938 reference genomes from the human gut microbiome</article-title>
        <source>Nat Biotechnol</source>
        <year>2021</year>
        <volume>39</volume>
        <fpage>105</fpage>
        <lpage>114</lpage>
        <pub-id pub-id-type="doi">10.1038/s41587-020-0603-3</pub-id>
        <?supplied-pmid 32690973?>
        <pub-id pub-id-type="pmid">32690973</pub-id>
      </element-citation>
    </ref>
    <ref id="CR3">
      <label>3.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Pearce</surname>
            <given-names>ME</given-names>
          </name>
          <name>
            <surname>Alikhan</surname>
            <given-names>N-F</given-names>
          </name>
          <name>
            <surname>Dallman</surname>
            <given-names>TJ</given-names>
          </name>
          <name>
            <surname>Zhou</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Grant</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Maiden</surname>
            <given-names>MCJ</given-names>
          </name>
        </person-group>
        <article-title>Comparative analysis of core genome MLST and SNP typing within a European Salmonella serovar Enteritidis outbreak</article-title>
        <source>Int J Food Microbiol</source>
        <year>2018</year>
        <volume>274</volume>
        <fpage>1</fpage>
        <lpage>11</lpage>
        <pub-id pub-id-type="doi">10.1016/j.ijfoodmicro.2018.02.023</pub-id>
        <?supplied-pmid 29574242?>
        <pub-id pub-id-type="pmid">29574242</pub-id>
      </element-citation>
    </ref>
    <ref id="CR4">
      <label>4.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Leaché</surname>
            <given-names>AD</given-names>
          </name>
          <name>
            <surname>Oaks</surname>
            <given-names>JR</given-names>
          </name>
        </person-group>
        <article-title>The Utility of Single Nucleotide Polymorphism (SNP) Data in Phylogenetics</article-title>
        <source>Annu Rev Ecol Evol Syst</source>
        <year>2017</year>
        <volume>48</volume>
        <fpage>69</fpage>
        <lpage>84</lpage>
        <pub-id pub-id-type="doi">10.1146/annurev-ecolsys-110316-022645</pub-id>
      </element-citation>
    </ref>
    <ref id="CR5">
      <label>5.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Freschi</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Vargas</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Husain</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Kamal</surname>
            <given-names>SMM</given-names>
          </name>
          <name>
            <surname>Skrahina</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Tahseen</surname>
            <given-names>S</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Population structure, biogeography and transmissibility of Mycobacterium tuberculosis</article-title>
        <source>Nat Commun</source>
        <year>2021</year>
        <volume>12</volume>
        <fpage>6099</fpage>
        <pub-id pub-id-type="doi">10.1038/s41467-021-26248-1</pub-id>
        <?supplied-pmid 34671035?>
        <pub-id pub-id-type="pmid">34671035</pub-id>
      </element-citation>
    </ref>
    <ref id="CR6">
      <label>6.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Figueroa</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Castro</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Lagos</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Cartes</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Isla</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Yáñez</surname>
            <given-names>AJ</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Analysis of single nucleotide polymorphisms (SNPs) associated with antibiotic resistance genes in Chilean Piscirickettsia salmonis strains</article-title>
        <source>J Fish Dis</source>
        <year>2019</year>
        <volume>42</volume>
        <fpage>1645</fpage>
        <lpage>1655</lpage>
        <pub-id pub-id-type="doi">10.1111/jfd.13089</pub-id>
        <?supplied-pmid 31591746?>
        <pub-id pub-id-type="pmid">31591746</pub-id>
      </element-citation>
    </ref>
    <ref id="CR7">
      <label>7.</label>
      <mixed-citation publication-type="other">Cooper AL, Low AJ, Koziol AG, Thomas MC, Leclair D, Tamber S, et al. Systematic Evaluation of Whole Genome Sequence-Based Predictions of Salmonella Serotype and Antimicrobial Resistance. Front Microbiol. 2020;11:549.</mixed-citation>
    </ref>
    <ref id="CR8">
      <label>8.</label>
      <mixed-citation publication-type="other">Maiden Martin C. J., Bygraves Jane A., Feil Edward, Morelli Giovanna, Russell Joanne E., Urwin Rachel, et al. Multilocus sequence typing: a portable approach to the identification of clones within populations of pathogenic microorganisms. Proc Natl Acad Sci. 1998;95:3140–5.</mixed-citation>
    </ref>
    <ref id="CR9">
      <label>9.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Gardner</surname>
            <given-names>SN</given-names>
          </name>
          <name>
            <surname>Hall</surname>
            <given-names>BG</given-names>
          </name>
        </person-group>
        <article-title>When whole-genome alignments just won’t work: kSNP v2 software for alignment-free SNP discovery and phylogenetics of hundreds of microbial genomes</article-title>
        <source>PLoS ONE</source>
        <year>2013</year>
        <volume>8</volume>
        <fpage>e81760</fpage>
        <pub-id pub-id-type="doi">10.1371/journal.pone.0081760</pub-id>
        <?supplied-pmid 24349125?>
        <pub-id pub-id-type="pmid">24349125</pub-id>
      </element-citation>
    </ref>
    <ref id="CR10">
      <label>10.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Treangen</surname>
            <given-names>TJ</given-names>
          </name>
          <name>
            <surname>Ondov</surname>
            <given-names>BD</given-names>
          </name>
          <name>
            <surname>Koren</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Phillippy</surname>
            <given-names>AM</given-names>
          </name>
        </person-group>
        <article-title>The Harvest suite for rapid core-genome alignment and visualization of thousands of intraspecific microbial genomes</article-title>
        <source>Genome Biol</source>
        <year>2014</year>
        <volume>15</volume>
        <fpage>524</fpage>
        <pub-id pub-id-type="doi">10.1186/s13059-014-0524-x</pub-id>
        <?supplied-pmid 25410596?>
        <pub-id pub-id-type="pmid">25410596</pub-id>
      </element-citation>
    </ref>
    <ref id="CR11">
      <label>11.</label>
      <mixed-citation publication-type="other">Gardner SN, Slezak T, Hall BG. kSNP3.0: SNP detection and phylogenetic analysis of genomes without genome alignment or reference genome. Bioinformatics. 2015;31:2877–8.</mixed-citation>
    </ref>
    <ref id="CR12">
      <label>12.</label>
      <mixed-citation publication-type="other">Ghazi AR, Münch PC, Chen D, Jensen J, Huttenhower C. Strain identification and quantitative analysis in microbial communities. J Mol Biol. 2022;434:167582.</mixed-citation>
    </ref>
    <ref id="CR13">
      <label>13.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zhao</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Shi</surname>
            <given-names>ZJ</given-names>
          </name>
          <name>
            <surname>Pollard</surname>
            <given-names>KS</given-names>
          </name>
        </person-group>
        <article-title>Pitfalls of genotyping microbial communities with rapidly growing genome collections</article-title>
        <source>Cell Syst</source>
        <year>2023</year>
        <volume>14</volume>
        <fpage>160</fpage>
        <lpage>176.e3</lpage>
        <pub-id pub-id-type="doi">10.1016/j.cels.2022.12.007</pub-id>
        <?supplied-pmid 36657438?>
        <pub-id pub-id-type="pmid">36657438</pub-id>
      </element-citation>
    </ref>
    <ref id="CR14">
      <label>14.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Tolar</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Joseph</surname>
            <given-names>LA</given-names>
          </name>
          <name>
            <surname>Schroeder</surname>
            <given-names>MN</given-names>
          </name>
          <name>
            <surname>Stroika</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Ribot</surname>
            <given-names>EM</given-names>
          </name>
          <name>
            <surname>Hise</surname>
            <given-names>KB</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>An overview of PulseNet USA databases</article-title>
        <source>Foodborne Pathog Dis</source>
        <year>2019</year>
        <volume>16</volume>
        <fpage>457</fpage>
        <lpage>462</lpage>
        <pub-id pub-id-type="doi">10.1089/fpd.2019.2637</pub-id>
        <?supplied-pmid 31066584?>
        <pub-id pub-id-type="pmid">31066584</pub-id>
      </element-citation>
    </ref>
    <ref id="CR15">
      <label>15.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Shi</surname>
            <given-names>ZJ</given-names>
          </name>
          <name>
            <surname>Dimitrov</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Zhao</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Nayfach</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Pollard</surname>
            <given-names>KS</given-names>
          </name>
        </person-group>
        <article-title>Fast and accurate metagenotyping of the human gut microbiome with GT-Pro</article-title>
        <source>Nat Biotechnol</source>
        <year>2022</year>
        <volume>40</volume>
        <fpage>507</fpage>
        <lpage>516</lpage>
        <pub-id pub-id-type="doi">10.1038/s41587-021-01102-3</pub-id>
        <?supplied-pmid 34949778?>
        <pub-id pub-id-type="pmid">34949778</pub-id>
      </element-citation>
    </ref>
    <ref id="CR16">
      <label>16.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Iqbal</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Turner</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>McVean</surname>
            <given-names>G</given-names>
          </name>
        </person-group>
        <article-title>High-throughput microbial population genomics using the Cortex variation assembler</article-title>
        <source>Bioinformatics</source>
        <year>2013</year>
        <volume>29</volume>
        <fpage>275</fpage>
        <lpage>276</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/bts673</pub-id>
        <?supplied-pmid 23172865?>
        <pub-id pub-id-type="pmid">23172865</pub-id>
      </element-citation>
    </ref>
    <ref id="CR17">
      <label>17.</label>
      <mixed-citation publication-type="other">Jiang X, Xu Z, Zhang T, Li Y, Li W, Tan H. Whole-genome-based helicobacter pylori geographic surveillance: a visualized and expandable webtool. Front Microbiol. 2021;12:687259.</mixed-citation>
    </ref>
    <ref id="CR18">
      <label>18.</label>
      <mixed-citation publication-type="other">Moodley Yoshan, Brunelli Andrea, Ghirotto Silvia, Klyubin Andrey, Maady Ayas S., Tyne William, et al. Helicobacter pylori’s historical journey through Siberia and the Americas. Proc Natl Acad Sci. 2021;118:e2015523118.</mixed-citation>
    </ref>
    <ref id="CR19">
      <label>19.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Linz</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Windsor</surname>
            <given-names>HM</given-names>
          </name>
          <name>
            <surname>McGraw</surname>
            <given-names>JJ</given-names>
          </name>
          <name>
            <surname>Hansen</surname>
            <given-names>LM</given-names>
          </name>
          <name>
            <surname>Gajewski</surname>
            <given-names>JP</given-names>
          </name>
          <name>
            <surname>Tomsho</surname>
            <given-names>LP</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>A mutation burst during the acute phase of Helicobacter pylori infection in humans and rhesus macaques</article-title>
        <source>Nat Commun</source>
        <year>2014</year>
        <volume>5</volume>
        <fpage>4165</fpage>
        <pub-id pub-id-type="doi">10.1038/ncomms5165</pub-id>
        <?supplied-pmid 24924186?>
        <pub-id pub-id-type="pmid">24924186</pub-id>
      </element-citation>
    </ref>
    <ref id="CR20">
      <label>20.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bishara</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Moss</surname>
            <given-names>EL</given-names>
          </name>
          <name>
            <surname>Kolmogorov</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Parada</surname>
            <given-names>AE</given-names>
          </name>
          <name>
            <surname>Weng</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Sidow</surname>
            <given-names>A</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>High-quality genome sequences of uncultured microbes by assembly of read clouds</article-title>
        <source>Nat Biotechnol</source>
        <year>2018</year>
        <volume>36</volume>
        <fpage>1067</fpage>
        <lpage>1075</lpage>
        <pub-id pub-id-type="doi">10.1038/nbt.4266</pub-id>
      </element-citation>
    </ref>
    <ref id="CR21">
      <label>21.</label>
      <mixed-citation publication-type="other">Zheng Wenshan, Zhao Shijie, Yin Yehang, Zhang Huidan, Needham David M., Evans Ethan D., et al. High-throughput, single-microbe genomics with strain resolution, applied to a human gut microbiome. Science. 2022;376:eabm1483.</mixed-citation>
    </ref>
    <ref id="CR22">
      <label>22.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Nayfach</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Páez-Espino</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Call</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Low</surname>
            <given-names>SJ</given-names>
          </name>
          <name>
            <surname>Sberro</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Ivanova</surname>
            <given-names>NN</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Metagenomic compendium of 189,680 DNA viruses from the human gut microbiome</article-title>
        <source>Nat Microbiol</source>
        <year>2021</year>
        <volume>6</volume>
        <fpage>960</fpage>
        <lpage>970</lpage>
        <pub-id pub-id-type="doi">10.1038/s41564-021-00928-6</pub-id>
        <?supplied-pmid 34168315?>
        <pub-id pub-id-type="pmid">34168315</pub-id>
      </element-citation>
    </ref>
    <ref id="CR23">
      <label>23.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Turner</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Garimella</surname>
            <given-names>KV</given-names>
          </name>
          <name>
            <surname>Iqbal</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>McVean</surname>
            <given-names>G</given-names>
          </name>
        </person-group>
        <article-title>Integrating long-range connectivity information into de Bruijn graphs</article-title>
        <source>Bioinformatics</source>
        <year>2018</year>
        <volume>34</volume>
        <fpage>2556</fpage>
        <lpage>2565</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/bty157</pub-id>
        <?supplied-pmid 29554215?>
        <pub-id pub-id-type="pmid">29554215</pub-id>
      </element-citation>
    </ref>
    <ref id="CR24">
      <label>24.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ondov</surname>
            <given-names>BD</given-names>
          </name>
          <name>
            <surname>Treangen</surname>
            <given-names>TJ</given-names>
          </name>
          <name>
            <surname>Melsted</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Mallonee</surname>
            <given-names>AB</given-names>
          </name>
          <name>
            <surname>Bergman</surname>
            <given-names>NH</given-names>
          </name>
          <name>
            <surname>Koren</surname>
            <given-names>S</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Mash: fast genome and metagenome distance estimation using MinHash</article-title>
        <source>Genome Biol</source>
        <year>2016</year>
        <volume>17</volume>
        <fpage>132</fpage>
        <pub-id pub-id-type="doi">10.1186/s13059-016-0997-x</pub-id>
        <?supplied-pmid 27323842?>
        <pub-id pub-id-type="pmid">27323842</pub-id>
      </element-citation>
    </ref>
    <ref id="CR25">
      <label>25.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Marçais</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Delcher</surname>
            <given-names>AL</given-names>
          </name>
          <name>
            <surname>Phillippy</surname>
            <given-names>AM</given-names>
          </name>
          <name>
            <surname>Coston</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Salzberg</surname>
            <given-names>SL</given-names>
          </name>
          <name>
            <surname>Zimin</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>MUMmer4: A fast and versatile genome alignment system</article-title>
        <source>PLoS Comput Biol</source>
        <year>2018</year>
        <volume>14</volume>
        <fpage>e1005944</fpage>
        <pub-id pub-id-type="doi">10.1371/journal.pcbi.1005944</pub-id>
        <?supplied-pmid 29373581?>
        <pub-id pub-id-type="pmid">29373581</pub-id>
      </element-citation>
    </ref>
    <ref id="CR26">
      <label>26.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Angiuoli</surname>
            <given-names>SV</given-names>
          </name>
          <name>
            <surname>Salzberg</surname>
            <given-names>SL</given-names>
          </name>
        </person-group>
        <article-title>Mugsy: fast multiple alignment of closely related whole genomes</article-title>
        <source>Bioinformatics</source>
        <year>2011</year>
        <volume>27</volume>
        <fpage>334</fpage>
        <lpage>342</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btq665</pub-id>
        <?supplied-pmid 21148543?>
        <pub-id pub-id-type="pmid">21148543</pub-id>
      </element-citation>
    </ref>
    <ref id="CR27">
      <label>27.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Darling</surname>
            <given-names>ACE</given-names>
          </name>
          <name>
            <surname>Mau</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Blattner</surname>
            <given-names>FR</given-names>
          </name>
          <name>
            <surname>Perna</surname>
            <given-names>NT</given-names>
          </name>
        </person-group>
        <article-title>Mauve: multiple alignment of conserved genomic sequence with rearrangements</article-title>
        <source>Genome Res</source>
        <year>2004</year>
        <volume>14</volume>
        <fpage>1394</fpage>
        <lpage>1403</lpage>
        <pub-id pub-id-type="doi">10.1101/gr.2289704</pub-id>
        <?supplied-pmid 15231754?>
        <pub-id pub-id-type="pmid">15231754</pub-id>
      </element-citation>
    </ref>
    <ref id="CR28">
      <label>28.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Li</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Durbin</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>Fast and accurate short read alignment with Burrows-Wheeler transform</article-title>
        <source>Bioinformatics</source>
        <year>2009</year>
        <volume>25</volume>
        <fpage>1754</fpage>
        <lpage>1760</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btp324</pub-id>
        <?supplied-pmid 19451168?>
        <pub-id pub-id-type="pmid">19451168</pub-id>
      </element-citation>
    </ref>
    <ref id="CR29">
      <label>29.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Li</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Handsaker</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Wysoker</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Fennell</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Ruan</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Homer</surname>
            <given-names>N</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>The sequence alignment/map format and SAMtools</article-title>
        <source>Bioinformatics</source>
        <year>2009</year>
        <volume>25</volume>
        <fpage>2078</fpage>
        <lpage>2079</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btp352</pub-id>
        <?supplied-pmid 19505943?>
        <pub-id pub-id-type="pmid">19505943</pub-id>
      </element-citation>
    </ref>
    <ref id="CR30">
      <label>30.</label>
      <mixed-citation publication-type="other">Garrison E, Marth G. Haplotype-based variant detection from short-read sequencing. arXiv preprint arXiv:12073907. 2012.</mixed-citation>
    </ref>
    <ref id="CR31">
      <label>31.</label>
      <mixed-citation publication-type="other">Bush SJ, Foster D, Eyre DW, Clark EL, De Maio N, Shaw LP, et al. Genomic diversity affects the accuracy of bacterial single-nucleotide polymorphism–calling pipelines. GigaScience. 2020;9:giaa007.</mixed-citation>
    </ref>
    <ref id="CR32">
      <label>32.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zou</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Xue</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Luo</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Deng</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Qin</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Guo</surname>
            <given-names>R</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>1,520 reference genomes from cultivated human gut bacteria enable functional microbiome analyses</article-title>
        <source>Nat Biotechnol</source>
        <year>2019</year>
        <volume>37</volume>
        <fpage>179</fpage>
        <lpage>185</lpage>
        <pub-id pub-id-type="doi">10.1038/s41587-018-0008-8</pub-id>
        <?supplied-pmid 30718868?>
        <pub-id pub-id-type="pmid">30718868</pub-id>
      </element-citation>
    </ref>
    <ref id="CR33">
      <label>33.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Gourlé</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Karlsson-Lindsjö</surname>
            <given-names>O</given-names>
          </name>
          <name>
            <surname>Hayer</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Bongcam-Rudloff</surname>
            <given-names>E</given-names>
          </name>
        </person-group>
        <article-title>Simulating Illumina metagenomic data with InSilicoSeq</article-title>
        <source>Bioinformatics</source>
        <year>2018</year>
        <volume>35</volume>
        <fpage>521</fpage>
        <lpage>522</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/bty630</pub-id>
      </element-citation>
    </ref>
    <ref id="CR34">
      <label>34.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wattam</surname>
            <given-names>AR</given-names>
          </name>
          <name>
            <surname>Abraham</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Dalay</surname>
            <given-names>O</given-names>
          </name>
          <name>
            <surname>Disz</surname>
            <given-names>TL</given-names>
          </name>
          <name>
            <surname>Driscoll</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Gabbard</surname>
            <given-names>JL</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>PATRIC, the bacterial bioinformatics database and analysis resource</article-title>
        <source>Nucleic Acids Res</source>
        <year>2014</year>
        <volume>42</volume>
        <fpage>D581</fpage>
        <lpage>D591</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/gkt1099</pub-id>
        <?supplied-pmid 24225323?>
        <pub-id pub-id-type="pmid">24225323</pub-id>
      </element-citation>
    </ref>
    <ref id="CR35">
      <label>35.</label>
      <mixed-citation publication-type="other">Stamatakis A. RAxML version 8: a tool for phylogenetic analysis and post-analysis of large phylogenies. Bioinformatics. 2014/01/21 ed. 2014;30:1312–3.</mixed-citation>
    </ref>
    <ref id="CR36">
      <label>36.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Letunic</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Bork</surname>
            <given-names>P</given-names>
          </name>
        </person-group>
        <article-title>Interactive Tree Of Life (iTOL) v4: recent updates and new developments</article-title>
        <source>Nucleic Acids Res</source>
        <year>2019</year>
        <volume>47</volume>
        <fpage>W256</fpage>
        <lpage>W259</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/gkz239</pub-id>
        <?supplied-pmid 30931475?>
        <pub-id pub-id-type="pmid">30931475</pub-id>
      </element-citation>
    </ref>
    <ref id="CR37">
      <label>37.</label>
      <mixed-citation publication-type="other">Shi ZJ, Nayfach S, Pollard KS. Maast: genotyping thousands of microbial strains efficiently. Zenodo; 2022. 10.5281/zenodo.8200643.</mixed-citation>
    </ref>
    <ref id="CR38">
      <label>38.</label>
      <mixed-citation publication-type="other">Shi ZJ, Nayfach S, Pollard KS. Maast: genotyping thousands of microbial strains efficiently. GitHub; 2022. Available from: <ext-link ext-link-type="uri" xlink:href="https://github.com/zjshi/Maast">https://github.com/zjshi/Maast</ext-link>.</mixed-citation>
    </ref>
  </ref-list>
</back>
<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName A++V2.4.dtd?>
<?SourceDTD.Version 2.4?>
<?ConverterInfo.XSLTName springer2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Genome Biol</journal-id>
    <journal-id journal-id-type="iso-abbrev">Genome Biol</journal-id>
    <journal-title-group>
      <journal-title>Genome Biology</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1474-7596</issn>
    <issn pub-type="epub">1474-760X</issn>
    <publisher>
      <publisher-name>BioMed Central</publisher-name>
      <publisher-loc>London</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">10416524</article-id>
    <article-id pub-id-type="pmid">37563669</article-id>
    <article-id pub-id-type="publisher-id">3030</article-id>
    <article-id pub-id-type="doi">10.1186/s13059-023-03030-8</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Software</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Maast: genotyping thousands of microbial strains efficiently</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Shi</surname>
          <given-names>Zhou Jason</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Nayfach</surname>
          <given-names>Stephen</given-names>
        </name>
        <xref ref-type="aff" rid="Aff3">3</xref>
        <xref ref-type="aff" rid="Aff4">4</xref>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-9870-6196</contrib-id>
        <name>
          <surname>Pollard</surname>
          <given-names>Katherine S.</given-names>
        </name>
        <address>
          <email>kpollard@gladstone.ucsf.edu</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff2">2</xref>
        <xref ref-type="aff" rid="Aff5">5</xref>
      </contrib>
      <aff id="Aff1"><label>1</label><institution-wrap><institution-id institution-id-type="ROR">https://ror.org/00knt4f32</institution-id><institution-id institution-id-type="GRID">grid.499295.a</institution-id><institution-id institution-id-type="ISNI">0000 0004 9234 0175</institution-id><institution>Chan Zuckerberg Biohub, </institution></institution-wrap>San Francisco, CA USA </aff>
      <aff id="Aff2"><label>2</label><institution-wrap><institution-id institution-id-type="GRID">grid.249878.8</institution-id><institution-id institution-id-type="ISNI">0000 0004 0572 7110</institution-id><institution>Gladstone Institutes of Data Science and Biotechnology, </institution></institution-wrap>San Francisco, CA USA </aff>
      <aff id="Aff3"><label>3</label><institution-wrap><institution-id institution-id-type="ROR">https://ror.org/04xm1d337</institution-id><institution-id institution-id-type="GRID">grid.451309.a</institution-id><institution-id institution-id-type="ISNI">0000 0004 0449 479X</institution-id><institution>Joint Genome Institute, Department of Energy, </institution></institution-wrap>Walnut Creek, CA USA </aff>
      <aff id="Aff4"><label>4</label><institution-wrap><institution-id institution-id-type="ROR">https://ror.org/02jbv0t02</institution-id><institution-id institution-id-type="GRID">grid.184769.5</institution-id><institution-id institution-id-type="ISNI">0000 0001 2231 4551</institution-id><institution>Environmental Genomics and Systems Biology Division, Lawrence Berkeley National Laboratory, </institution></institution-wrap>Berkeley, CA USA </aff>
      <aff id="Aff5"><label>5</label><institution-wrap><institution-id institution-id-type="ROR">https://ror.org/043mz5j54</institution-id><institution-id institution-id-type="GRID">grid.266102.1</institution-id><institution-id institution-id-type="ISNI">0000 0001 2297 6811</institution-id><institution>Department of Epidemiology and Biostatistics, </institution><institution>University of California San Francisco, </institution></institution-wrap>San Francisco, CA USA </aff>
    </contrib-group>
    <pub-date pub-type="epub">
      <day>10</day>
      <month>8</month>
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>10</day>
      <month>8</month>
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2023</year>
    </pub-date>
    <volume>24</volume>
    <elocation-id>186</elocation-id>
    <history>
      <date date-type="received">
        <day>7</day>
        <month>7</month>
        <year>2022</year>
      </date>
      <date date-type="accepted">
        <day>31</day>
        <month>7</month>
        <year>2023</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2023</copyright-statement>
      <license>
        <ali:license_ref specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p><bold>Open Access</bold> This article is licensed under a Creative Commons Attribution 4.0 International License, which permits use, sharing, adaptation, distribution and reproduction in any medium or format, as long as you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons licence, and indicate if changes were made. The images or other third party material in this article are included in the article's Creative Commons licence, unless indicated otherwise in a credit line to the material. If material is not included in the article's Creative Commons licence and your intended use is not permitted by statutory regulation or exceeds the permitted use, you will need to obtain permission directly from the copyright holder. To view a copy of this licence, visit <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>. The Creative Commons Public Domain Dedication waiver (<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/publicdomain/zero/1.0/">http://creativecommons.org/publicdomain/zero/1.0/</ext-link>) applies to the data made available in this article, unless otherwise stated in a credit line to the data.</license-p>
      </license>
    </permissions>
    <abstract id="Abs1">
      <p id="Par1">Existing single nucleotide polymorphism (SNP) genotyping algorithms do not scale for species with thousands of sequenced strains, nor do they account for conspecific redundancy. Here we present a bioinformatics tool, Maast, which empowers population genetic meta-analysis of microbes at an unrivaled scale. Maast implements a novel algorithm to heuristically identify a minimal set of diverse conspecific genomes, then constructs a reliable SNP panel for each species, and enables rapid and accurate genotyping using a hybrid of whole-genome alignment and k-mer exact matching. We demonstrate Maast’s utility by genotyping thousands of <italic>Helicobacter pylori</italic> strains and tracking SARS-CoV-2 diversification.</p>
      <sec>
        <title>Supplementary Information</title>
        <p>The online version contains supplementary material available at 10.1186/s13059-023-03030-8.</p>
      </sec>
    </abstract>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100014989</institution-id>
            <institution>Chan Zuckerberg Initiative</institution>
          </institution-wrap>
        </funding-source>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution>Chan Zuckerberg Biohub</institution>
        </funding-source>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100008072</institution-id>
            <institution>Gladstone Institutes</institution>
          </institution-wrap>
        </funding-source>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100000050</institution-id>
            <institution>National Heart, Lung, and Blood Institute</institution>
          </institution-wrap>
        </funding-source>
        <award-id>HL160862</award-id>
        <principal-award-recipient>
          <name>
            <surname>Pollard</surname>
            <given-names>Katherine S.</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
    </funding-group>
    <custom-meta-group>
      <custom-meta>
        <meta-name>issue-copyright-statement</meta-name>
        <meta-value>© BioMed Central Ltd., part of Springer Nature 2023</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec id="Sec1">
    <title>Background</title>
    <p id="Par2">Many bacterial and viral species now have thousands of sequenced genomes in public databases, and these numbers are rapidly increasing, fueled by technologies such as metagenome assembly, high-throughput culturing, and single-cell genome sequencing. For many species, genome collections harbor immense genetic variation [<xref ref-type="bibr" rid="CR1">1</xref>, <xref ref-type="bibr" rid="CR2">2</xref>]. Single nucleotide polymorphisms (SNPs) are genomic positions that vary between genomes of the same species with a minimum minor allele frequency (e.g., 1%). Vertically inherited SNPs in conserved genes are commonly used to reconstruct phylogenies and study biogeography [<xref ref-type="bibr" rid="CR3">3</xref>, <xref ref-type="bibr" rid="CR4">4</xref>], while SNPs in pathogenicity loci and antibiotic resistance genes are leveraged for surveillance of medically important strains [<xref ref-type="bibr" rid="CR5">5</xref>–<xref ref-type="bibr" rid="CR7">7</xref>]. Compared to multilocus sequence typing methods, whole-genome SNP genotyping generally enables greater phylogenetic resolution [<xref ref-type="bibr" rid="CR8">8</xref>]. Comparing genomes based on a pre-defined set of SNPs is also more computationally scalable than using whole-genome nucleotide identity [<xref ref-type="bibr" rid="CR9">9</xref>] and thus especially well-suited for the analysis of large genome collections.</p>
    <p id="Par3">SNPs are often identified from whole genome sequences. For example, Parsnp [<xref ref-type="bibr" rid="CR10">10</xref>] constructs multiple sequence alignments of high-quality genome assemblies and identifies variable positions directly from the alignments. An alternative method is to call SNPs from sequencing reads without genome assembly. For example, Snippy (<ext-link ext-link-type="uri" xlink:href="https://github.com/tseemann/snippy">https://github.com/tseemann/snippy</ext-link>) identifies SNPs from the alignment of short reads to a reference genome and kSNP [<xref ref-type="bibr" rid="CR11">11</xref>] identifies SNPs using informative k-mers found on short reads, contigs, or genome assemblies. Assembly-free genotyping and k-mer matching are usually faster but less accurate than genotyping SNPs from whole-genome alignments [<xref ref-type="bibr" rid="CR12">12</xref>]. With all of these strategies, SNPs of interest can be extracted using thresholds on the minor allele frequency (MAF), site prevalence, or protein-coding change across a set of strains.</p>
    <p id="Par4">Despite the variety of SNP genotyping methods, a rapid increase in the number of sequenced microbial genomes presents a computational challenge for existing tools. Sequence alignment is the major obstacle to analyzing so many genomes, though kSNP also remain largely untested with thousands of strains. A second challenge is the fact that many species have a high level of genome redundancy [<xref ref-type="bibr" rid="CR13">13</xref>], especially when a biased sample of clonally related genomes has been sequenced, which is common for clinically important pathogens that are under intensive surveillance (e.g., PulseNet [<xref ref-type="bibr" rid="CR14">14</xref>] and NCBI Pathogen Detection). This redundancy masks the diversity of unevenly sampled species, and it means that strains from poorly sampled lineages contribute little to the discovery of SNPs, especially when a relatively high MAF threshold is used. Redundancy also alters the meaning of MAF and site prevalence; frequency in the sampled genomes is not a good estimate of frequency in the population. Together, these two challenges limit the utility of SNP genotyping methods for many microbial species.</p>
    <p id="Par5">To address this gap, we present Maast (Microbial agile accurate SNP Typer) for accurate genotyping of orders of magnitude more microbial strains than other state-of-the-art methods. Our key innovation is an algorithm to pick a minimal set of maximally diverse genomes. Only these genomes are used for SNP discovery which reduces genomic redundancy and computational cost. We also implement a hybrid method combining whole-genome alignment and optimized k-mer exact match for genotyping SNPs in either assembled genomes or unassembled whole-genome sequencing (WGS) libraries. Maast performs SNP genotyping faster and more accurately than existing methods but sometimes misses rare variants present in genomes not selected for SNP discovery. We apply Maast to a large collection of previously sequenced <italic>Helicobacter pylori</italic> (<italic>H. pylori</italic>) strains and summarize the biogeographic patterns of this species across the globe. We also show that Maast can efficiently track the evolution of SARS-CoV-2 during the COVID-19 outbreak. Maast is available as open-source software with both source code and documentation freely accessible on GitHub (<ext-link ext-link-type="uri" xlink:href="https://github.com/zjshi/Maast">https://github.com/zjshi/Maast</ext-link>).</p>
  </sec>
  <sec id="Sec2">
    <title>Results</title>
    <sec id="Sec3">
      <title>The Maast SNP genotyping pipeline</title>
      <p id="Par6">Maast is an open-source bioinformatics pipeline written in Python and C +  + that fully automates SNP calling and genotyping for microbial species. Maast has two components: (1) constructing a reference panel of SNPs for a microbial species using a reduced set of non-redundant genomes (Fig. <xref rid="Fig1" ref-type="fig">1</xref>a and b, Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S1), and (2) ultra-fast, in silico genotyping of reference SNPs from large scale genome collections. Genotyping can be performed using draft genome assemblies or unassembled short or long reads (Fig. <xref rid="Fig1" ref-type="fig">1</xref>c, d and Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S2) and can be applied to any microbial species, such as bacteria, archaea, viruses, or microbial eukaryotes.<fig id="Fig1"><label>Fig. 1</label><caption><p>Schematic design of Maast. Maast consists of four major components. <bold>a</bold> Tag genomes and centroid genomes are selected based on Mash distances. A novel algorithm, called DynaCC, is used to automatically choose the genome clustering threshold based on each species’ level of genomic redundancy (see the “<xref rid="Sec10" ref-type="sec">Methods</xref>” section). <bold>b</bold> A panel of common SNPs is constructed for each species using multiple whole-genome alignment. <bold>c</bold> SNPs in non-tag genomes or other input genomes are genotyped using single whole-genome alignment. <bold>d</bold> SNPs in short reads are genotyped using k-mer exact matching</p></caption><graphic xlink:href="13059_2023_3030_Fig1_HTML" id="MO1"/></fig></p>
      <p id="Par7">In the first step of the pipeline, Maast rapidly builds a reference SNP panel from a diverse, non-redundant subset of input genome assemblies using MUMmer. The genome subset is identified using pairwise genetic distances and a dynamic graph algorithm that we developed and called DynaCC (Dynamic Connected Component search; Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S3). DynaCC aims to identify a minimal set of genomes that captures the maximum number of common SNPs with MAF above a user-specified value. It does this heuristically in order to accelerate the computation, and hence the resulting “tag” genomes are not provably a minimal set. From the tag genomes, Maast selects one centroid tag genome to be used as a species reference. Maast then aligns all other tag genomes to the reference using MUMmer, constructs a multiple sequence alignment (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S2), and uses a standard SNP calling workflow (“Methods”) to generate the SNP panel at the user-specified MAF and prevalence (% of genomes containing either SNP allele).</p>
      <p id="Par8">We assessed whether the Maast strategy of subsampling reduced our power to detect SNPs on a benchmark dataset of 146 common bacterial species from the human gut, each with at least 200 high-quality genomes (Additional file <xref rid="MOESM2" ref-type="media">2</xref>: Table S1). These species have different levels of intraspecific diversity (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S4), genomic redundancy (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S5a), and SNP density (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S5b). Overall, we found that the number of SNPs identified with Maast tag genomes (&gt; 1% MAF) was equal to or greater than the number of SNPs identified using the full set of genomes (Fig. <xref rid="Fig2" ref-type="fig">2</xref>a, b), with high overlap between the approaches (median = 87.9%, Fig. <xref rid="Fig2" ref-type="fig">2</xref>c). Our results demonstrate that more genomes do not necessarily lead to the discovery of more common SNPs (&gt; 1% MAF). The presence of many highly related genomes also leads to biased estimation of SNP frequencies in the overall population and may reduce SNPs discovered at a given MAF threshold (Fig. <xref rid="Fig2" ref-type="fig">2</xref>d, e, f, <xref rid="MOESM1" ref-type="media">S6</xref>). These analyses highlight that the Maast strategy of subsampling captures the most common genetic variation and successfully represents genomes from poorly sampled lineages (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S7, S8). Users also have the option to run Maast with all genomes rather than tag genomes, which may enable more of the SNPs present in pairwise genome comparisons to be included in the SNP panel, especially for rare SNPs present in less divergent pairs of genomes (Fig. <xref rid="Fig2" ref-type="fig">2</xref>d, Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S8), but at the cost of greater computational requirements. Maast, run using either tag genomes or all genomes, misses many variable sites between pairs of genomes (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S7, S8), because these are largely rare variants whereas Maast was designed to capture common SNPs above a MAF threshold.<fig id="Fig2"><label>Fig. 2</label><caption><p>SNP genotyping of 146 human gut bacterial species using tag genomes. <bold>a</bold> and <bold>b</bold> SNP discovery comparison of Maast with all genomes (gray), only tag genomes (green), and a random set of genomes equal in number to the tag genomes (brown) shows that more genomes do not lead to the discovery of more SNPs. Each box in <bold>a</bold> summarizes the number of SNPs across 146 species. Each point in <bold>b</bold> represents a species, with black lines connecting the data for the same species. For computational efficiency, only the 1000 highest quality genomes were included for species with &gt; 1000 genomes. <bold>c</bold> Comparison of SNPs discovered by Maast with all genomes versus only tag genomes. Each bar represents a species, with the height of a bar showing the number of SNPs discovered exclusively with all genomes (gray), exclusively with tag genomes (green), or by both approaches (beige). Arrows point to eight example species (from left to right): <italic>Faecalibacterium prausnitzii_K</italic> (species id: 101300), <italic>Akkermansia muciniphila</italic> (102454), <italic>Akkermansia muciniphila_B</italic> (102453), <italic>Succinivibrio sp000431835</italic> (100412), <italic>Sutterella wadsworthensis_B</italic> (101361), <italic>Phascolarctobacterium faecium</italic> (103439), <italic>Alistipes shahii</italic> (100003), and <italic>Anaerotignum sp000436415</italic> (100177). Species label color indicates whether this species has a high (red) or low (blue) level of tag-only SNPs, which is estimated as a fraction of all SNPs that are discovered with tag genomes and not with all genomes. <bold>d</bold> SNP sites missing from a small percentage of genome assemblies as they fall below the user-specified prevalence threshold due to being absent in a group of redundant genomes. Connected dots represent example species in <bold>c</bold> with a high proportion of tag-only SNPs. The proportion of tag-only SNPs drops if the MAF cutoff for calling SNPs with all genomes is lowered from 0.01 (orange) to 0.001 (green). Most of the SNPs only discovered with tag genomes (tag-only SNPs) are due to MAFs below the 1% threshold in all genomes. <bold>e</bold> For each of the four species where tag genomes and all genomes called different numbers of SNPs (<italic>Faecalibacterium prausnitzii_K</italic>, <italic>Phascolarctobacterium faecium</italic>, <italic>Alistipes shahii</italic>, and <italic>Akkermansia muciniphila_B</italic>), we further investigated the source of this discrepancy by defining a set of true population SNPs. To do so, we built a phylogenetic tree and used it to sample genomes so that they covered the species diversity but came from different subpopulations (essentially removing bias from over-sampling of subpopulations with redundant genomes). SNPs called using this set of genomes were defined as the true SNPs for the population. We ran Maast on each species using tag genomes or using all genomes to call SNPs with a 1% MAF threshold. For each species, tag genomes capture a higher number of the true SNPs than do all genomes, suggesting that redundant genomes bias MAF estimation and reduce SNP calling sensitivity. <bold>f</bold> The single largest genome cluster is larger for species with many tag-only SNPs compared to those with fewer. The largest genome clusters were compared between species from <bold>c</bold> with high (red axis tick) and low (blue axis tick) levels of tag-only SNPs. For three of four species with more SNPs discovered in the tag-only analysis, the largest cluster contains more than half of all genomes, implying a high level of genome redundancy that biases MAF estimation and leads to an undercount of SNPs. Height of bars shows the total number of genomes in a species and the proportion colored in purple indicates the size of the single largest genome cluster of that species. Every two adjacent species have a similar total number of genomes</p></caption><graphic xlink:href="13059_2023_3030_Fig2_HTML" id="MO2"/></fig></p>
      <p id="Par9">In the second step of the pipeline, Maast performs reference based in silico genotyping of common, bi-allelic SNPs in genomes, which may be non-tag genomes from the initial reference collection or totally new genomes. Like other methods that genotype using a single reference genome, Maast cannot genotype sites that are absent from the reference genome, and in its current implementation, Maast also does not aim to genotype rare SNPs or SNPs with more than two alleles. The workflow can be executed using genome assemblies or unassembled WGS reads. For genome assemblies, Maast aligns each query genome to the centroid genome for that species using MUMmer and directly genotypes alleles for each of the reference SNPs. For WGS reads, Maast performs exact matching between k-mers extracted from the sequencing reads and a database of k-mers covering each SNP in the reference panel that has been curated to only include k-mers that do not occur anywhere else in the entire reference genome collection of tag and non-tag genomes (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S2). The algorithm leverages the fact that most query k-mers have no chance to match sck-mers in the database. It screens subsequences of colex-ordered k-mers up front, which is faster and more RAM-efficient than using a hash table (“Methods”). This strategy is an extension of our previous method GT-Pro [<xref ref-type="bibr" rid="CR15">15</xref>] for genotyping SNPs in metagenomic sequencing libraries, specifically optimized for WGS of microbial isolates.</p>
    </sec>
    <sec id="Sec4">
      <title>Maast is orders of magnitude faster than existing tools</title>
      <p id="Par10">We evaluated the computational performance of Maast with kSNP3 and Parsnp, two other commonly used methods for microbial SNP calling. All methods were run for a single bacterial species, <italic>Agathobacter rectalis</italic> (Additional file <xref rid="MOESM3" ref-type="media">3</xref>: Table S2)<italic>,</italic> using 500, 1000, or 5000 randomly sampled genome sequences (Methods). Only SNP calling was benchmarked, and not downstream steps such as tree building. Surprisingly, both kSNP3 and Parsnp failed to run through all the <italic>A. rectalis</italic> genomes. kSNP3 was manually terminated after running for a maximum allowed time (48 h) and consuming more than 1 TB disk space, while Parsnp failed to run even for 1,000 genomes, apparently due to high intraspecific genetic diversity. To check that these results were not specific to <italic>A. rectalis</italic>, we ran both tools on two other human gut species (Additional file <xref rid="MOESM3" ref-type="media">3</xref>: Table S2): <italic>Alistipes putredinis</italic> (<italic>n</italic> = 3646) and <italic>Bacteroides_B dorei</italic> (<italic>n</italic> = 3170) and obtained the same result. We conclude that, to our knowledge, Maast is the only tool able to call SNPs in species with thousands of diverse genomes.</p>
      <p id="Par11">To evaluate computational performance when genomic divergence is more limited and in the absence of structural variation, we simulated 5000 whole genome sequences of <italic>A. rectalis</italic> by randomly introducing SNPs across a representative genome (“Methods”). While Parsnp ran to completion, kSNP3 again exceeded our 48-h maximum time window. Overall, Maast was 6.3 to &gt; 127-fold faster than Parsnp and 31 to &gt; 127 fold faster than kSNP3 (Fig. <xref rid="Fig3" ref-type="fig">3</xref>a). In addition, Maast required only 7.2 GB of RAM to process the 5,000 genomes, which was substantially less than what Parsnp used to process 100 genomes and similar to what kSNP3 used to process 1000 genomes (Additional file <xref rid="MOESM4" ref-type="media">4</xref>: Table S3). Maast also only used a moderate amount (~ 1.2 GB) of disk space. We attribute Maast’s high speed and RAM efficiency mainly to the strategy of subsampling genomes for SNP discovery. Other factors included compact data structures and parallel processing. These results demonstrate that Maast can easily run on a personal computer.<fig id="Fig3"><label>Fig. 3</label><caption><p>Evaluation of Maast computational performance and accuracy. <bold>a</bold> Comparison of genome genotyping speed between Maast, Maast without redundancy collapsing (Maast + NRC), kSNP3, and Parsnp. All methods were run on 500, 1000, and 5000 simulated <italic>A. rectalis</italic> genomes. <bold>b</bold> Comparison of short-reads genotyping speed between Maast, Snippy, and SPAdes. All three methods were run on 63 strains of <italic>B. uniformis</italic>, whose whole genome sequencing reads (~ 150 million) were downloaded from the Culturable Genome Reference (CGR) study. The <italic>y</italic>-axis of both <bold>a</bold> and <bold>b</bold> indicates elapsed seconds of running in log scale. Fewer elapsed seconds indicate better performance (faster processing speed). <bold>c</bold>–<bold>f</bold> Comparison of Maast and Snippy genotyping accuracy at non-reference alleles of SNPs in the Maast SNP panel, based on short reads <bold>c</bold>, <bold>d</bold> simulated from isolate genomes with sequencing error (15 x coverage) and <bold>e</bold>,<bold> f</bold> downloaded from isolate whole-genome sequencing projects. Both Maast and Snippy were run with default settings. <bold>c</bold>, <bold>e</bold> Positive predictive value (PPV; 1- false discovery rate) comparison, where false discoveries are genotype calls that do not match the genome. <bold>d</bold>, <bold>e</bold> Sensitivity from the simulations in <bold>c</bold> and downloaded reads in <bold>e</bold>. Sensitivity is the probability of detecting genotypes present in the genome. Color of points in <bold>c</bold>–<bold>f</bold> indicates whether the data comes from tag genomes (black) or not (red). Samples colored in red are regarded as novel to Maast databases. <bold>g</bold>, <bold>h</bold> Maast genotype concordance between <bold>g</bold> genome and short reads or <bold>h</bold> genome and long reads. In <bold>g</bold>, strain population structure of <italic>H. pylori</italic> was reconstructed using SNPs from 473 strains. Each strain has a whole genome sequence (WG) and a short read sample (SRA) as indicated in the stacked color rings. In <bold>h</bold>, the population structure of <italic>H. pylori</italic> was reconstructed from 4 strains with whole genome sequence (WG) and long reads (SRA). * kSNP3 and Parsnp runs &gt; 48 h on 5000 genomes and were manually terminated, and we plot a runtime of 48 h with the note that no output was produced</p></caption><graphic xlink:href="13059_2023_3030_Fig3_HTML" id="MO3"/></fig></p>
      <p id="Par12">We also evaluated the computational performance of Maast when calling SNPs in WGS reads. As a benchmark, we selected 63 whole genome sequencing samples of <italic>Bacteroides uniformis</italic> from the Culturable Genome Reference (CGR) study (“Methods”, Additional file <xref rid="MOESM5" ref-type="media">5</xref>: Table S4, mean = 2.38 million reads per sample). Performance was compared with Snippy as well as an assembly-based strategy using a combination of SPAdes and MUMmer. Maast was ~ 19–24 fold faster than these methods (Fig. <xref rid="Fig3" ref-type="fig">3</xref>b, d) taking &lt; 2 s to process each WGS sample and requiring 11.8 GB RAM. Altogether, we conclude that Maast greatly accelerates SNP genotyping in both assemblies and short reads and is friendly to personal computing devices.</p>
    </sec>
    <sec id="Sec5">
      <title>Maast SNP genotypes are highly accurate</title>
      <p id="Par13">To validate the accuracy of Maast SNP genotypes, we first compared Maast to Parsnp and kSNP on 1000 <italic>A. rectalis</italic> genomes with simulated SNPs (“Methods”). Erroneous alignments can in theory produce both incorrect genotypes (false positives) and missing genotypes (false negatives). False positives were only observed for kSNP (Additional file <xref rid="MOESM6" ref-type="media">6</xref>: Table S5) while false negatives were very low for Maast (<italic>n</italic> = 1) and Parsnp (<italic>n</italic> = 4) but much higher for kSNP (<italic>n</italic> = 5073). These results suggest that Maast is at least as accurate as currently available methods.</p>
      <p id="Par14">To evaluate the genotyping accuracy of Maast on short reads, we compared Maast to Snippy by running both tools with their default settings on Illumina short reads simulated from 45 isolate genomes of a single species (<italic>B. uniformis</italic>, Additional file <xref rid="MOESM5" ref-type="media">5</xref>: Table S4, 15 x coverage per genome). For each method, predicted genotypes were compared to a set of ground truth genotypes determined from whole-genome alignment of the 45 isolate genomes to the Maast reference genome. Across simulations from the 45 isolates, the median SNP positive predictive value (PPV) was very high for both methods (Maast median = 99.72%, Snippy median = 99.38%; Fig. <xref rid="Fig3" ref-type="fig">3</xref>c and Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S9a). Meanwhile, the sensitivity of Maast was consistently higher (median = 93.2%) compared to Snippy (median = 54.3%) (Fig. <xref rid="Fig3" ref-type="fig">3</xref>d, Additional file <xref rid="MOESM1" ref-type="media">1</xref>: S9c and S10), since Maast is less subject to false negatives due to reference bias [<xref ref-type="bibr" rid="CR13">13</xref>] and coverage filtering (i.e., minimum 1 × by default compared to minimum 10 × for Snippy). Because simulated reads may capture less contamination and sequencing errors than real WGS data, we repeated the evaluation with 63 short read libraries of the same species downloaded from the CGR study (<italic>B. uniformis</italic>, Additional file <xref rid="MOESM5" ref-type="media">5</xref>: Table S4). Compared to Snippy, Maast had slightly higher PPV (Maast median = 99.74%, Snippy median = 98.65%) and much higher sensitivity (Maast median = 93.3%, Snippy median = 61.7%) (Fig. <xref rid="Fig3" ref-type="fig">3</xref>e, f, Additional file <xref rid="MOESM1" ref-type="media">1</xref>: S9b, d, and S11). Higher sequencing coverage (100 x) or using paired-end reads only resulted in minor changes to the genotyping accuracy of both Maast and Snippy (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S11, 12, and 13). We conclude that Maast is a more accurate and sensitive tool compared to Snippy, reflecting the advantages of 31-mer exact matching over read alignment for SNP genotyping, especially for sequencing data with relatively more contamination or sequencing errors.</p>
      <p id="Par15">In addition, we compared Maast to a powerful pangenome SNP calling method, Cortex [<xref ref-type="bibr" rid="CR16">16</xref>], with the 45 <italic>B. uniformis</italic> strains. We used the Maast reference genome plus four additional, randomly selected genomes to generate the Cortex index. We observed that Cortex calls ~ 2.5 times more variants than does Maast. However, the runtime of Cortex was 250 times longer than Maast. We also found that genotyping results generated by Maast and Cortex were highly concordant: &gt; 93% of the SNPs called by Maast were also called by Cortex. Thus, more SNPs can be discovered with pangenome methods compared to methods like Maast that use a single reference genome. But this additional power for SNP discovery comes at a large computational cost that prohibits applications to genotyping thousands of strains.</p>
    </sec>
    <sec id="Sec6">
      <title>Maast reveals global genetic structure of 3178 <italic>H. pylori</italic> isolates</title>
      <p id="Par16">To demonstrate its scalability and utility, we leveraged Maast to analyze 3178 <italic>H. pylori</italic> whole-genome sequences from 39 countries across six continents (Fig. <xref rid="Fig4" ref-type="fig">4</xref>a, Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S8, Additional file <xref rid="MOESM7" ref-type="media">7</xref>: Table S6, Additional file <xref rid="MOESM8" ref-type="media">8</xref>: Table S7). These included isolates from five animal species in addition to humans (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S14). Overall, we identified 74,962 common SNPs in the core genome of <italic>H. pylori</italic> using Maast (“Methods”), which was &gt; 10 times more than a recent study [<xref ref-type="bibr" rid="CR17">17</xref>]. Using these genotypes, we measured genetic distance between strains across continents and by host species, sex, and disease status (Fig. <xref rid="Fig4" ref-type="fig">4</xref>b, Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S15, S16). We observed clear associations between <italic>H. pylori</italic> genotypes and geography (Fig. <xref rid="Fig4" ref-type="fig">4</xref>b and c) which supported the finding that <italic>H. pylori</italic> has distinct populations across the globe [<xref ref-type="bibr" rid="CR18">18</xref>]. Within the same continent, <italic>H. pylori</italic> strains from the same host species were more similar than those from the different host species (<italic>p</italic>-value &lt; 2.2e − 16, Wilcoxon rank sum test). Interestingly, we observed <italic>H. pylori</italic> strains from different host species but the same continent were more similar than those from human hosts living in different continents (Fig. <xref rid="Fig4" ref-type="fig">4</xref>e). This is likely due to <italic>H. pylori</italic> populations being highly heterogenized across continents, suggesting geography is a transcending factor over host species. We also observed that genetic distances between <italic>H. pylori</italic> strains were on average lower (<italic>p</italic>-value = 2.27e − 13) between pairs of healthy human hosts compared to diseased pairs (Fig. <xref rid="Fig4" ref-type="fig">4</xref>f and Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S17), implying greater genomic commonality between non-pathogenic <italic>H. pylori</italic> strains.<fig id="Fig4"><label>Fig. 4</label><caption><p>Global genetic structure of <italic>H. pylori</italic> genomes. <bold>a</bold> Geographic distribution of 3068 <italic>H. pylori</italic> strains across 39 countries with color indicating the number of strains from each country. <bold>b</bold> Strain population structure of <italic>H. pylori</italic> strains reconstructed from their Maast SNP genotypes. Stacked color rings indicate the host species (inner), continent (middle), and human host disease status (outer). <bold>c</bold>–<bold>f</bold> Comparison of genetic distances between pairs of strains from <bold>c</bold> same versus different continent, <bold>d</bold> same versus different host species within the same continents, <bold>e</bold> human versus other host species, and <bold>f</bold> control vs diseased human hosts. In <bold>e</bold>, genetic distances are calculated between pairs of strains from the same continent where one is from a human host and the other is from the indicated host species (left) or between pairs of strains from human hosts from different continents (blue box at right). The <italic>H. pylori</italic> strains that infected Rhesus monkeys were inoculated [<xref ref-type="bibr" rid="CR19">19</xref>] and thus excluded</p></caption><graphic xlink:href="13059_2023_3030_Fig4_HTML" id="MO4"/></fig></p>
      <p id="Par17">Next, we analyzed 478 <italic>H. pylori</italic> isolates downloaded from NCBI (Additional file <xref rid="MOESM9" ref-type="media">9</xref>: Table S8) to assess whether we would obtain the same results using Maast with unassembled sequencing reads instead of whole genome sequences (“Methods”). For these strains, we observed the expected similarity between isolates and their unassembled WGS reads, except for a few highly similar isolates which cannot be distinguished based on common SNPs (Fig. <xref rid="Fig3" ref-type="fig">3</xref>g and Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S18). Next, we extended this analysis to four distinct <italic>H. pylori</italic> strains that had both whole genome assembly and long-read data. We found perfect clustering of assemblies with the long-read data from the same strain (Fig. <xref rid="Fig3" ref-type="fig">3</xref>h). Altogether our evaluation suggests that the two Maast genotyping workflows, although using distinct algorithms, are highly concordant. This means that genomic data from different sources can be pooled for analysis with Maast without assembly or other preprocessing.</p>
    </sec>
    <sec id="Sec7">
      <title>Maast enables fast tracking of SARS-CoV-2 variants</title>
      <p id="Par18">To apply Maast for global pathogen surveillance, we analyzed 37,096 SARS-CoV-2 (SC2) strains, including 8734 isolate genome assemblies and 28,362 WGS read samples, collected from 60 countries over a span of ~ 200 days (downloaded from NCBI on July 19, 2020, Additional file <xref rid="MOESM10" ref-type="media">10</xref>: Table S9, Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S19, S20). Maast was able to process the data in &lt; 9 h with 36 threads and a peak RAM use of 20 GB on an AWS EC2 instance (r5.16xlarge). Analyzing patterns in these genotypes, we first observed a clear divergence of SC2 strains relative to strain NC_045512 which was one of the first sequenced SC2 strains (Fig. <xref rid="Fig5" ref-type="fig">5</xref>a). Furthermore, we found that genetic distance between SC2 strains was slightly lower within countries than between countries (Figure <xref rid="MOESM1" ref-type="media">S21</xref>). Within-country genetic distance differed across countries, likely due to differences in temporal adjacency of samples (Fig. <xref rid="Fig5" ref-type="fig">5</xref>b and Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S22). However, we also observed exceptions where geographically adjacent countries with similar temporal sampling patterns had different levels of within-country genetic distance, such as Poland and Germany (Fig. <xref rid="Fig5" ref-type="fig">5</xref>b and Additional file <xref rid="MOESM1" ref-type="media">1</xref>: S22), suggesting other underlying factors such as single versus multiple introduction sources. To track the differentiation of SC2 strains, we next used SC2 SNPs to perform dimension reduction and observed changing subspecies genetic structure over time with the emergence and fading of SC2 strain clusters (Fig. <xref rid="Fig5" ref-type="fig">5</xref>f). These results suggest that Maast is computationally efficient and accurate enough to be used to monitor the dynamics of the genetic structure of emerging pathogens at a global scale.<fig id="Fig5"><label>Fig. 5</label><caption><p>Application of Maast to track <italic>SARS-CoV-2</italic> diversification from Dec 2019 to July 2020. <bold>a</bold> Genetic distances of SARS-CoV-2 strains over time compared to one of the earliest <italic>SARS-CoV-2</italic> strains (Accession #: NC_045512). <bold>b</bold> Median genetic distance of <italic>SARS-CoV-2</italic> in a country is strongly correlated with average sampling day gap. <bold>c</bold> Subspecies structure of <italic>SARS-CoV-2</italic> over time. Each dot is a <italic>SARS-CoV-2</italic> strain, colored by sampling month with other time points in gray. Dimension reduction and visualization were performed with UMAP. Nearby samples in UMAP space have similar genotypes</p></caption><graphic xlink:href="13059_2023_3030_Fig5_HTML" id="MO5"/></fig></p>
    </sec>
  </sec>
  <sec id="Sec8">
    <title>Discussion</title>
    <p id="Par19">In this study, we present Maast, a new software tool for discovering SNPs in conspecific genomes that also includes pipelines for genotyping the panel of discovered SNPs in sequencing reads (long or short) and genome assemblies. In terms of SNP discovery, Maast is faster than existing methods due to our DynCC algorithm that identifies a subset of diverse genomes that can be used for the computationally intensive step of comparing all pairs of genomes without losing sensitivity. In fact, using these tag genomes improves our ability to identify SNPs at a given MAF and prevalence in the broader population by reducing bias due to uneven sampling of sequenced genomes. In terms of SNP genotyping, Maast uses less RAM and disk than existing methods while being about two orders of magnitude faster due to a combination of efficient data structures and novel genotyping algorithms for both genomes and unassembled reads.</p>
    <p id="Par20">The computational efficiency and accuracy of Maast enables a broad array of potential applications. In this study, we demonstrated how Maast could be used to study the genetic structure of <italic>H. pylori</italic>, a bacterial species with strong biogeographic patterns. We also used the early months of the SARS-CoV-2 pandemic as a case study to illustrate that Maast could be applied to emerging viral pathogens. Maast’s ability to process thousands of genomes makes it a useful tool for tracking microbial evolution in real time. By constructing and maintaining a SNP panel and k-mer database for any medically important species over time, Maast can be applied to rapidly genotype thousands of new samples without the need for genome assembly, enabling new variants to be monitored as they spread. Beyond these applications, Maast is also ideally suited for population genetic investigations of any species with many assembled or unassembled genome sequences. Its genotypes can be utilized to measure rates and patterns of selection, recombination, drift, and migration among lineages of a species.</p>
    <p id="Par21">Despite its advantages, Maast has several limitations. One challenge for SNP discovery is that Maast, like Parsnp and other methods requiring whole genome sequences, cannot be applied to species with very few high-quality assembled genomes. This is a common scenario for uncultured prokaryotic species plus many eukaryotes and viruses beyond the best-studied pathogens, although metagenome-assembled genomes and single-cell sequencing methods are closing this gap [<xref ref-type="bibr" rid="CR20">20</xref>–<xref ref-type="bibr" rid="CR22">22</xref>]. The main trade-off of Maast’s genotyping algorithm is that it uses SNPs discovered in an initial collection of assembled genomes and hence may fail to detect novel variants in short reads or genomes, including rare variants and SNPs that are common in lineages not well-represented in the SNP panel. This can be problematic in some settings, such as tracking the evolution of closely related pathogenic strains. Pangenome methods [<xref ref-type="bibr" rid="CR16">16</xref>, <xref ref-type="bibr" rid="CR23">23</xref>] have the potential to overcome this limitation, because they utilize more of the accessory genome. However, our benchmark using the Cortex algorithm demonstrated that the computing requirements of current pangenome implementations do not permit analysis with datasets of the scale explored in this study. Accelerating these algorithms is an exciting area for future research. In the meantime, Maast enables large-scale applications to uncover the vast genetic structure of Earth’s microbiomes using common SNPs.</p>
  </sec>
  <sec id="Sec9">
    <title>Conclusions</title>
    <p id="Par22">Maast is an open-source software tool that provides a highly efficient method for discovering and genotyping common, bi-allelic SNPs using either whole-genome sequences or unassembled sequencing reads. It includes a novel algorithm that dynamically collapses thousands of genomes into a diverse, representative set of tag genomes that can be used to discover the most common SNPs with reduced computational resources and less bias than using all genomes for a species. This SNP discovery method is combined with a genotyping strategy that is a hybrid of whole-genome alignment and k-mer exact matching. Maast’s genotyping method achieves higher speed and accuracy than existing tools, scaling up population genetic analysis to an unrivaled number of strains compared to state-of-the-art methods. We have demonstrated that Maast could efficiently reconstruct the genetic structure of <italic>H. pylori</italic> and track SARS-CoV-2 variants during the COVID-19 outbreak, applications that involved thousands of strains across the globe. As the number of species with multiple high-quality, near-complete genome sequences continues to grow, Maast is poised to catalog this vast genetic variation.</p>
  </sec>
  <sec id="Sec10">
    <title>Methods</title>
    <sec id="Sec11">
      <title>Maast overview</title>
      <p id="Par23">Maast is an open-source bioinformatics tool for fast and accurate SNP genotyping from conspecific genome assemblies and sequencing reads. The development of Maast is motivated by the following observations: (1) redundant genomes are common in genome databases and these contribute little to SNP discovery while imposing a computational burden, (2) the level and pattern of redundancy vary across species, (3) the choice of reference genome affects SNP discovery, and (4) for sequencing reads, genotyping by assembly first or read alignment does not scale with increasing amounts of data.</p>
      <p id="Par24">Maast implements a catalog-first-genotype-later scheme. It was designed in order to enable genotyping to be scaled up for very large populations. Maast also synchronizes microbial genotyping for both genome assemblies and sequencing reads. The key innovations of Maast are its efficiency and novel workflow. We note that the underlying algorithms in this workflow leverage previously existing methods for whole genome alignment and k-mer exact matching.</p>
      <p id="Par25">Maast takes a set of intraspecific genomes as input and has the following major steps per species: (1) estimates the pairwise genomic distance between genomes and identifies genome clusters, (2) collapses clusters to a single tag genome per cluster, (3) picks a centroid genome as reference genome, (4) performs multiple whole-genome alignment, constructs consensus genome and calls SNPs to generate a SNP panel, and (5) leverages the SNP panel to perform in silico genotyping for genome assemblies or sequencing reads.</p>
    </sec>
    <sec id="Sec12">
      <title>Pairwise genomic distance calculation</title>
      <p id="Par26">Maast estimates the genomic distance between a pair of genomes using Mash [<xref ref-type="bibr" rid="CR24">24</xref>] (version 2.2). Mash distance can be used to approximate whole-genome average nucleotide identity (ANI) between similar genomes (e.g., conspecific genomes). For input genomes, Maast first builds 20-mer profiles or Mash sketches using its “sketch” subcommand with default parameter except for option “-s 5000” (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S1). Next, Maast calls the “dist” subcommand in Mash with default options to compute pairwise genomic distances.</p>
    </sec>
    <sec id="Sec13">
      <title>Identify genome clusters and tag genomes</title>
      <p id="Par27">Maast automatically determines the number of genome clusters (n) based on the user-defined minor allele frequency (MAF): n = 1/MAF. By default, SNPs are defined as genomic sites with MAF &gt; 1%. In this case, at least 100 genomes are required to enable an effective resolution of 1%, that is 1 in 100 genomes has the minor allele. With higher MAF thresholds, fewer genomes are needed, and vice versa.</p>
      <p id="Par28">We implemented a dynamic graph algorithm (Dynamic Connected Component search (DynaCC)) in Maast to identify tag genomes based on pairwise Mash distances. The goal is to identify a minimal set of genomes that captures as much genetic variation as possible through a heuristic search. DynaCC starts with a complete graph where nodes are genomes and edges are weighted by distance. The algorithm applies a distance cutoff (d-cut) strategy to prune edges, where pairs of genomes (edges) with a distance higher than a d-cut are deemed sufficiently dissimilar and removed. By applying a stringent d-cut, many edges are deleted, which reduces the complete genome graph to connected components and isolated nodes. By doing so, Maast avoids loading a complete connected graph into RAM as well as performing operations on it, which would be computationally expensive when the number of genomes is large. A connected component here is analogous to a genome cluster which is defined as a maximum set of nodes in which a path exists between every pair of nodes, and a path is a sequence of edges which joins a pair of nodes. The algorithm identifies tag genomes as a union of hub genomes from connected components and all isolated nodes, and by default, it chooses a hub genome as the genome with the most edges in a connected component (i.e., the highest degree centrality after filtering out edges below the distance cutoff). Maast also allows users to identify hub genomes using weighted edges through the flag “–edge-weighted” as well as more sophisticated node centrality estimation methods (such as eigenvector centrality, closeness, information, betweenness, and load centrality) through the flag “–tag-centrality”. Users can also run Maast using all genomes, rather than with tag genomes, as long as they have sufficient computing power given the number of genomes.</p>
      <p id="Par29">Next, we sought to implement an algorithm that solves the problem of identifying ~ n tag genomes from N genomes, where N &gt; n. Since the level and pattern of redundancy within species vary, an identical d-cut can result in detected n (n′) drastically different across species. When n′ is lower than the target n, SNPs are called with a de facto higher MAF, resulting in a lower sensitivity for detecting SNPs. When n′ is much higher, the benefit of computing efficiency will diminish. It is also unrealistic to predict a static d-cut per species, due to the unknown diversity of input genomes. Here DynaCC searches and determines an optimal d-cut per species dynamically with respect to the input genomes. It first uses a range factor (rf; default 1.2) designating a critical range of n (n to n*rf) that is acceptable, since the exact n may never exist in the search space. It then applies an initial d-cut (default 0.01) and if n′ is lower than n, it searches the lower bound of d-cut with an exponential decay by a factor of 10 until an n′ higher than n is found or a hard bound (default 0.000001) is reached. Between the initial d-cut and lower bound, the algorithm performs a binary search until an n′ falling in the critical range is found or the maximum searching step (default 10) runs out. When no optimal n′ is found, the algorithm settles with a suboptimal n′ which is both higher than and nearest to n. The resulting n′ tag genomes are used for the downstream workflow.</p>
      <p id="Par30">DynaCC presents two advantages for clustering whole genome sequences compared to other clustering tools, such as CD-HIT, vsearch, and MMSeqs2. First, DynaCC leverages a fast approximation of ANI, making it better suited for processing a large number of whole genome sequences. For example, we ran DynaCC, CD-HIT, vsearch (UCLUST equivalent), and MMSeqs2 on 3,646 whole genomes of <italic>Alistipes putredinis</italic> (Species ID: 101302). All programs were run in an identical computing environment (AWS EC2 r5.16xlarge) for a maximum of 48 h. DynaCC successfully divided these genomes into 110 clusters in ~ 3 min, while the same task took MMSeqs2 ~ 4 h. Both CD-HIT and vsearch ultimately did not run through the task: the CD-HIT main program was terminated by signal 11 (reached 498 GB RAM cap) and vsearch did not complete within 48 h. Second, DynaCC is more efficient at dividing whole genome sequences into a fixed number of clusters. Other algorithms will usually take one single distance (or similarity) cutoff as input and use this same cutoff across all species to divide genome sequences into a smaller untargeted number of clusters. DynaCC automatically searches a large space of cutoffs around a target minimum number of clusters (i.e., tag genomes) and finds an  optimal cutoff per species to generate at least the targeted number of clusters. For example, DynaCC automatically divided genomes of <italic>A. putredinis</italic> (<italic>n</italic> = 3646) and <italic>A. rectalis</italic> (<italic>n</italic> = 5214), two example species in Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S5, into ~ 100 clusters (110 clusters for <italic>A. putredinis</italic> and 106 for <italic>A. rectalis</italic>), while using a static genomic distance cutoff of 0.01 resulted in 46 genome clusters for <italic>A. putredinis</italic> and 2650 clusters for <italic>A. rectalis</italic>. In contrast, MMSeqs2 by default generated 3646 <italic>A. putredinis</italic> clusters and 5214 <italic>A. rectalis</italic> clusters, barely collapsing any redundant genomes. Thus, DynaCC rapidly prunes a large set of genomes to a fairly consistent target size across diverse and heterogeneous species. We implemented a method with this behavior because we found that it enabled efficient downstream SNP calling.</p>
    </sec>
    <sec id="Sec14">
      <title>Identify the centroid of tag genomes</title>
      <p id="Par31">The choice of reference genome is important to SNP discovery. Maast objectively picks a reference genome for each species as the centroid of tag genomes. Maast calculates all pairwise genomic distances between tag genomes using Mash. For simplicity, the tag genome with the lowest average L-1 distance to all other tag genomes is selected as the centroid genome for the species. Maast also allows users to select the centroid genome using L-2 and L-Inf distance. By default, Maast uses the centroid genome as the reference genome for multiple sequence alignments as well as SNP calling. Unless otherwise mentioned, we used the centroid genome for each SNP analysis in this study.</p>
    </sec>
    <sec id="Sec15">
      <title>Multiple sequence alignment and SNP calling</title>
      <p id="Par32">For each species, we performed whole-genome alignment by aligning each intraspecific genome to the centroid or otherwise specified reference genome using MUMmer [<xref ref-type="bibr" rid="CR25">25</xref>] (version 4.0.0beta2) with the default parameters. Unreliable and repeat-induced alignments were removed using the delta-filter program from MUMmer with options ‘-q -r’ and the remaining alignments were then extracted using the show-coords program with default parameters. To promote the quality of multiple whole-genome alignment, we removed regions that are overly short (&lt; 500 bp) or poorly aligned (alignment ANI &lt; 95% of whole-genome ANI). Maast horizontally concatenates all qualified alignments and calls SNPs as sites with the following characteristics: 1) two or more nucleotides, 2) present in at least a user-supplied percentage of genomes (prevalence threshold, default ≥ 90%), and 3) minor allele frequency greater than a user-supplied value (default ≥ 1%). Finally, Maast organizes the called SNPs into a panel and outputs it in a standard VCF format. We note that Maast does not identify insertion and deletion variants (INDELs) or structural variants, even though it produces a multiple sequence alignment in a multi-FASTA format.</p>
    </sec>
    <sec id="Sec16">
      <title>Maast in silico genotyping of SNPs</title>
      <p id="Par33">For genome assemblies, Maast leverages the SNP panel from upstream steps to perform genotyping. Maast aligns each query genome, which could be non-tag genomes from SNP discovery or other additional input genomes, to the centroid genome using MUMmer (version 4.0.0beta2) with consistent quality control steps and parameters identical to those used in SNP calling. For each SNP in the panel, Maast then searches all best alignments to locate the genomic position of the SNP. If the genomic position of a SNP is found in an alignment, Maast reads and reports the allele on the query genome; otherwise, Maast reports the SNP as missing.</p>
      <p id="Par34">For sequencing reads, Maast uses a k-mer exact matching algorithm for efficient and accurate genotyping. Maast leverages the SNP panel to extract short unique genomic regions (k-mers) as probes for detecting alleles that distinguish highly similar genomes and uses these k-mers to rapidly genotype reads. For k-mer extraction, Maast identifies any 31-base SNP-covering k-mers (sck-mers) that cover (in any of the 31 bases) each of the SNP alleles. We chose 31 for k based on analyses in our previous study. For each SNP, Maast first extracts all possible 31-mers containing the SNP site from the representative genome (sck-mers for reference allele). Next, Maast extracts sck-mers by sliding a fixed-size window along the multiple sequence alignment. At any given position, the window allows extraction of n sck-mers, where n equals the number of rows in the multiple sequence alignment (i.e., the number of aligned genomes). Next, Maast reduces these n sck-mers to m unique sck-mers (m <inline-formula id="IEq1"><alternatives><tex-math id="M1">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\le$$\end{document}</tex-math><mml:math id="M2"><mml:mo>≤</mml:mo></mml:math><inline-graphic xlink:href="13059_2023_3030_Article_IEq1.gif"/></alternatives></inline-formula> n) and selects the one from these m with the highest frequency across the n genomes. INDELs near (within 30 bp of) a SNP could affect the number of sck-mers extracted. Maast accounts for three scenarios: no INDELs, INDELs at one side of a SNP site, and INDELs at both sides of a SNP site. When no INDELs are present, all 31 sck-mers will be extracted (note that the SNP site can be at any base on a 31-mer). When INDELs only occur at one side of a SNP site, 1 to 30 sck-mers will be extracted, depending on the location of the nearest INDEL to the SNP site. In rare cases where two or more INDELs flank a SNP site, no sck-mers will be extracted. To exclude sck-mers from repetitive genomic regions, Maast searches every candidate sck-mer in all input genomes, not only tag genomes, and removes those that occur anywhere else in any genome. We retrieved the reverse complements of all sck-mers. In this way, for every SNP site, there will be up to 62 sck-mers targeting the reference or alternative allele.</p>
      <p id="Par35">To facilitate efficient storage and match of sck-mers, we use 64-bit integers to represent the sck-mers with 00 for “A,” 01 for “C,” 10 for “G,”and 11 for “T”and discarded the sck-mers with wildcards (e.g. “N”). We sort sck-mers in colex order which is essentially a reflection of lexicographic order that reads a sequence from the right to the left (versus left to the right). For example, given a set of unsorted sequences, {“214”, “123”, “134”, “125”}, the corresponding lexicographic order is {“123”, “125”, “134”, “214”} and the colex order is {“123”, “214”, “134”, “125”}. Colex order enables fast matching of suffixes, because related suffixes are near each other in a list. Specifically, we build an <italic>l-</italic>index to quickly locate all sck-mers that share a given suffix by simply pointing to the first and last entries for each suffix. This is possible because sck-mers that end with a suffix <italic>s</italic> of length <italic>l</italic> will occupy consecutive entries in the colex sorted list. We empirically selected <italic>l</italic> = 36 as default. For each input read, Maast first breaks it down into 31-mers and encodes them into 64-bit integers. Our goal is to find exact matches of these 31-mers with sck-mers and the following exact-match algorithm is implemented: (1) look up query suffix in the <italic>l-mer</italic> index, if found, (2) examine all sck-mer entries identified by the <italic>l-mer</italic> index one by one and report exact matches. After generating all k-mers in each metagenomic sequencing read, Maast recruits an L-bit index (L-index; last L bits/suffix of encoded k-mer) to locate a bucket of pre-sorted sck-mers in the database containing all possible exact matches to the full k-mer. The algorithm invokes a sequential search for exact matches between the full k-mer and only the sck-mers in this bucket. We note that both alleles may be detected for one SNP site due to the presence of more than one strain, de novo mutations, or sequencing errors in the sample. In the default output of Maast, if multiple alleles are detected, the counts of both alleles will be reported. Further processing of the alleles is delegated to downstream analysis. Throughout this study, we assumed there was only one dominant strain per sample and when multiple alleles were detected for a SNP site within one sample, we proceeded with the major allele (allele frequency &gt; 0.5) and ignored the minor allele for all analyses unless otherwise mentioned. The count of reads matching an allele will be incremented by one as long as at least one k-mer was detected in the read being processed.</p>
      <p id="Par36">The output format of in silico genotyping is similar for both genome assemblies and sequencing reads. It uses a concise table-shaped format for its output, in which every row represents a bi-allelic SNP site. Each row has exactly 8 fields: species, SNP ID, contig, contig position, allele 1, allele 2, and coverage of allele 1 and coverage of allele 2. Currently, the algorithm only supports bi-allelic SNPs which are the vast majority of the SNPs.</p>
    </sec>
    <sec id="Sec17">
      <title>UHGG whole genome sequences and species</title>
      <p id="Par37">We downloaded genome sequences from the Unified Human Gastrointestinal Genomes [<xref ref-type="bibr" rid="CR2">2</xref>] (UHGG) at <ext-link ext-link-type="uri" xlink:href="http://ftp.ebi.ac.uk/pub/databases/metagenomics/mgnify_genomes">http://ftp.ebi.ac.uk/pub/databases/metagenomics/mgnify_genomes</ext-link> as of September 2019. The UHGG database is a very large collection of gut microbial whole genome sequences, which are originally from both isolate assemblies and metagenome-assembled genomes (MAGs). The inclusion of MAGs from diverse human populations and geographic locations is critical for capturing natural genetic variation within human gut species. From the UHGG database, we selected 146 species, each with 200 or more high-quality (completeness &gt;  = 90% and contamination rate &lt;  = 5%) whole genome sequences, which accounted for a total of 109,365 genomes. Twenty-nine of them had more than 1000 genomes, and <italic>Escherichia coli_D</italic> (species id: 102506) had the most genomes (<italic>n</italic> = 6645).</p>
    </sec>
    <sec id="Sec18">
      <title>Comparing Maast to related methods</title>
      <p id="Par38">We compared Maast to several other methods in a series of simulations and data analyses designed to evaluate different aspects of computational performance and accuracy. For SNP calling in whole genome sequences, we included two methods, Parsnp and kSNP, which represented two distinct methods. Parsnp reports SNPs in the coordinates of the specified reference genome, and kSNP does not. We selected ParSNP as opposed to other methods for calling SNPs through multiple whole genome alignment, such as Mugsy [<xref ref-type="bibr" rid="CR26">26</xref>] and Mauve [<xref ref-type="bibr" rid="CR27">27</xref>], due to its improved computing performance and similar accuracy [<xref ref-type="bibr" rid="CR10">10</xref>]. For SNP calling in short reads, we included Snippy, a representative of a widely used three-step workflow: short reads first are aligned to reference genomes (read mapping), mapped reads are then piled up for counting coverage per site (pile-up), and SNPs are called from site coverage profiles (SNP calling). Specifically, Snippy (<ext-link ext-link-type="uri" xlink:href="https://github.com/tseemann/snippy">https://github.com/tseemann/snippy</ext-link>; June 2020) uses BWA mem [<xref ref-type="bibr" rid="CR28">28</xref>] (version 0.7.17-r1188) for read mapping, samtools [<xref ref-type="bibr" rid="CR29">29</xref>] (version 1.12) to sort and filter BAM files, and freebayes [<xref ref-type="bibr" rid="CR30">30</xref>] (version v1.3.5) for pile-up and SNP calling. Here, we chose Snippy for comparisons and analyses as it was recently reported to be the best method overall among methods that follow a similar strategy [<xref ref-type="bibr" rid="CR31">31</xref>]. To control for possible biases in using the Maast tag genomes as representative genomes, we instead used the UHGG representative genomes with all methods unless otherwise specified.</p>
      <p id="Par39">In all comparisons, we ran Maast, Parsnp, kSNP, and Snippy with default parameters except for a flag of “-c” for Parsnp to indicate all genomes are from the same species. For all paired-end samples, we processed only forward reads (fastq 1) for the simplicity of comparison and analysis. We skipped a sample if it did not have a forward read sample as extracted from a SRA file using fastq-dump in the SRA toolkit. However, we note that using the reads of both directions can effectively increase the coverage, which thus should be recommended especially for species with low abundance.</p>
    </sec>
    <sec id="Sec19">
      <title>Computing performance evaluations</title>
      <p id="Par40">We compared Maast with kSNP3 and Parsnp to evaluate its computing performance on SNP calling with whole genome sequences. We downloaded a total of 5214 high-quality genomes for one of the most well-sequenced bacterial species, <italic>Agathobacter rectali</italic>, from UHGG genome colletion (Additional file <xref rid="MOESM3" ref-type="media">3</xref>: Table S2). We randomly sampled 500, 1000, or 5000 genome sequences and ran all three methods on these genome sequences to assess the scalability of these methods. Since both kSNP3 and Parsnp failed to run through all the <italic>A. rectalis</italic> genomes, we downloaded high-quality genomes from UHGG for two other well-sequenced species, i.e., 3646 genomes for <italic>Alistipes putredinis</italic> and 3170 genomes for <italic>Bacteroides_B dorei</italic> (Additional file <xref rid="MOESM3" ref-type="media">3</xref>: Table S2), and repeated the evaluation with both species to ensure the observed issue was not limited to a single species. To enable the comparison between Maast, Parsnp, and kSNP as well as the performance evaluation of each method, we simulated genomes to control the level of genomic divergence within a species. For the simulation, we took a random genome (UHGG id: GUT_GENOME143713) from <italic>Agathobacter rectalis</italic> as a simulation template and randomly selected 10,000 genomic positions on the template to be SNP sites. For each simulated genome, 10% of the SNP sites (1000 SNPs) were randomly selected to be non-reference alleles, which we inserted in silico. For simplicity, we only simulated bi-allelic SNPs. To evaluate the scalability of the methods, we used three levels of input size (500, 1000, and 5000 genomes).</p>
      <p id="Par41">To evaluate SNP genotyping in short reads, we downloaded a total of 63 samples of short reads for an arbitrary species (<italic>Bacteroides uniformis</italic>) from the Culturable Genome Reference (CGR) study [<xref ref-type="bibr" rid="CR32">32</xref>]. Each sample provided a distinct sequenced strain of that species. Altogether these samples accounted for a total of ~ 150 million reads.</p>
      <p id="Par42">We evaluated the computing performance of Maast and other tools on an AWS EC2 instance with the following specifications: AWS r5.16xlarge, 32 physical CPU cores (64 vCPU), Intel 8175 M CPU @ 2.50 GHz, 512 GB RAM and EBS gp2 RAID array providing 13,600 Mbps bandwidth. We measured both speed and peak RAM consumption using the GNU time (version 1.7) command with option “-v”.</p>
      <p id="Par43">To ensure a fair comparison between different methods, all methods were run on all of the input data with the same reference genome whenever one was used. Only the step of SNP calling was evaluated; if a method had downstream steps such as SNP tree-building we did not benchmark these. Each method was run using all cores of an environment whenever possible.</p>
      <p id="Par44">We manually terminated the running of any tool after both tools had been running over a designated maximum running time window (48 h) and had not finished. When terminated, we estimated the speed of Parsnp and kSNP with the maximum time use of 48 h and projected peak RAM use linearly as a function of the number of genomes.</p>
      <p id="Par45">For the example species of <italic>Bacteroides uniformis</italic>, the end-to-end runtime breakdown of Maast is ~ 7 min for picking tag genomes and generating SNP panel, ~ 13 min for building sck-mer database, and ~ 19 min for genotyping 2746 whole-genome assemblies or ~ 90 s for genotyping 63 samples of whole-genome sequencing short reads.</p>
    </sec>
    <sec id="Sec20">
      <title>Accuracy evaluation of SNPs from simulated and downloaded reads</title>
      <p id="Par46">To evaluate the accuracy of SNP genotyping by Maast in short reads and to compare it to Snippy, we simulated reads from whole genome sequences. For these simulations, we downloaded a total of 45 isolate genomes for a species (<italic>Bacteroides uniformis</italic>) from the CGR study. These genomes were cultivated from fecal samples of healthy humans and characterized as non-redundant and high-quality draft genomes. We used InSilicoSeq [<xref ref-type="bibr" rid="CR33">33</xref>] (version 1.4.2) with the options “–model HiSeq” to simulate up to 5.3 million reads per genome with Illumina length and error characteristics. This generated two paired-end read files each containing ~ 1 million 126 bp-long reads from each genome. For simplicity, we proceeded only the forward reads. We used genome coverage of 15 x for simulations by randomly drawing reads from the simulated metagenomes. The number of reads required for a level of coverage c was estimated by the following formula: number of reads = c × genome length / 126. For example, to provide a 15 x coverage for a genome with a size of 6 M bp, a rough number of 714,285 (15 × 5,000,000/126) 126-bp reads are needed. To complement the simulations above, we extended the accuracy analyses to the reads simulated from the same genomes at 100 × coverage as well as the 63 samples of short reads used in the computing performance evaluation. For these analyses, the reads were processed as both paired-end reads, in which forward and reverse reads were both supplied and aligned as pairs, and as single-end reads, in which forward and reverse reads were merged and supplied as a single file.</p>
      <p id="Par47">To ensure a fair comparison, we ran Maast and Snippy on both the simulated and downloaded reads with default parameters and the same high-quality reference genome (i.e., UHGG species representative genome) which was arbitrarily selected. We did not use the centroid genome as the reference genome here to control possible biases. Our evaluations focused on the correct identification of SNPs and on the accuracy of the alleles in the typed SNPs. For each strain, ground truth genotypes were determined by aligning the whole sequence of that strain to the reference genome. We focused our evaluations on the SNPs that were potentially able to be genotyped by both Maast and Snippy, i.e., SNPs in the Maast panel. True positives (TP) and false positives (FP) were the correct and incorrect genotypes compared to ground truth; false negatives (FN) were sites with no genotype or an incorrect genotype. In this way, we conveniently calculated the Positive predictive value (PPV) as the ratio between the sum of TP sites and the sum of all reported sites and the sensitivity as TP/(TP + FN) or the ratio of TP sites to the total number of sites in the Maast SNP panel. These values were calculated for each method on non-reference sites only as Snippy only reported them.</p>
    </sec>
    <sec id="Sec21">
      <title>Reconstruction of genetic structure of<italic> H. pylori</italic></title>
      <p id="Par48">To show Maast is powerful for exploring genetic structure within microbial species, we downloaded a total of 3524 whole genome sequences of <italic>H. pylori</italic> from NCBI and PATRIC [<xref ref-type="bibr" rid="CR34">34</xref>] websites as of March 2021. We kept 3428 high-quality genomes (completeness &gt;  = 90% and contamination rate &lt;  = 5%) as determined using checkM, which included 1672 and 1756 genomes from NCBI and PATRIC, respectively (Additional file <xref rid="MOESM7" ref-type="media">7</xref>: Table S6). We ran the SNP calling module of Maast with default parameters (site prevalence &gt; 0.9 and MAF &gt; 0.01) on the whole genome sequences, resulting in 107 tag genomes and a panel of 275,116 SNPs. We then ran the database building module of Maast with default settings and generated a sck-mer database with 3,566,180 sck-mers and 74,962 SNPs that were covered by at least one sck-mer.</p>
      <p id="Par49">Next, we sought to determine whether the common SNPs discovered and typed by Maast could be used for biogeographic analyses of diverged <italic>H. pylori</italic> strains. To maximize the number of strains in this analysis, we downloaded an additional 1522 short-read samples from NCBI SRA as of April 2021, each representing a distinct strain. We then combined these short-read samples together with 1756 PATRIC genomes to form one of the largest <italic>H. pylori</italic> strain collections (<italic>n</italic> = 3178) to date with diverse host and geographic information (Additional file <xref rid="MOESM8" ref-type="media">8</xref>: Table S7). We did not include NCBI whole genome sequences due to less richness in metadata. We ran Maast on these strains and used the RAxML [<xref ref-type="bibr" rid="CR35">35</xref>] algorithm to calculate pairwise genetic distance as well as construct a phylogenetic tree based on concatenated alleles of SNP sites genotyped. We uploaded the resulting RAxML tree file to the iTol [<xref ref-type="bibr" rid="CR36">36</xref>] website for visualization. To account for possible bias due to less covered SNPs, we applied two filters to both the SNPs and strains: (1) we excluded a SNP from this analysis if it was present in fewer than 5 strains, and (2) we excluded a strain if it had &lt; 1000 genotyped SNPs or &lt; 50% of total SNPs genotyped.</p>
      <p id="Par50">To further validate consistency between Maast SNP genotyping of whole genome sequences and short reads, we identified 478 <italic>H. pylori</italic> strains that had both raw whole-genome sequencing reads and assembled genomes available in NCBI records (Additional file <xref rid="MOESM9" ref-type="media">9</xref>: Table S8). We used similar steps to run Maast on these strains and reconstructed a phylogenetic tree.</p>
    </sec>
    <sec id="Sec22">
      <title>Tracking early outbreak of SARS-CoV-2</title>
      <p id="Par51">We analyzed SARS-CoV-2 strains from the early outbreak. In contrast to the long evolutionary history of <italic>H. pylori</italic>, genomic tracking of SARS-CoV-2 was quite recent and extensive, which provided a good example to evaluate how well Maast could be used to track the genetics of a burst of highly similar genomes. We downloaded a total of 37,096 SARS-CoV-2 strains from diverse geographic regions (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S19), including 8734 whole genome sequences from the NCBI <italic>SARS-CoV-2</italic> Data Hub as well as 28,362 short read samples available from the NCBI SRA as of July 2020 (Additional file <xref rid="MOESM10" ref-type="media">10</xref>: Table S9). As expected, the Mash distances between SARS-CoV-2 genomes were extremely low due to the short evolution history (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S20). To effectively differentiate these strains, we included rare SNPs in this application by running Maast with site prevalence &gt; 0.95 and MAF &gt; 0.001 on the whole genome sequences of SARS-CoV-2, which resulted in 1077 tag genomes and a panel of 1114 SNPs. With Maast, we built a sck-mer database, which included 128,416 sck-mers and 1045 SNPs that were covered by at least one sck-mer. Then, we genotyped SNPs for the rest of the strains with Maast and computed SNP-based genetic distance and a RAxML tree as in the <italic>H. pylori</italic> analysis.</p>
      <p id="Par52">To visually track the genetic change of SARS-CoV-2 over time, we identified the major allele (allele with the highest frequency across strains) of each SNP, generated a binary matrix of major allele presence/absence per strain, and performed dimension reduction on this matrix with UMAP (umap package version 0.2.3.1) in R. We plotted all strains in the resulting UMAP coordinates. We visually identified 1,073 outliers (&lt; 3% of total strains) and removed them from the plot. To account for possible bias due to less covered SNPs, we applied two filters to both genomes and metagenomes: (1) we excluded a SNP in both genomes and metagenomes if it was present in fewer than 5 metagenomes, and (2) we excluded a metagenome if it had &lt; 1000 genotyped SNPs or &lt; 50% of total SNPs genotyped.</p>
    </sec>
  </sec>
  <sec sec-type="supplementary-material">
    <sec id="Sec23">
      <title>Supplementary Information</title>
      <p>
        <supplementary-material content-type="local-data" id="MOESM1">
          <media xlink:href="13059_2023_3030_MOESM1_ESM.docx">
            <caption>
              <p><bold>Additional file 1.</bold> Supplementary Figures S1 to S22.</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM2">
          <media xlink:href="13059_2023_3030_MOESM2_ESM.xlsx">
            <caption>
              <p><bold>Additional file 2: Supplementary Tables S1.</bold> Summary of intra-specific genomes and common SNPs for 146 microbial species associated with the human gut.</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM3">
          <media xlink:href="13059_2023_3030_MOESM3_ESM.xlsx">
            <caption>
              <p><bold>Additional file 3: Supplementary Tables S2.</bold> List of UHGG genomes for 3 CGR species that were used for evaluating the computational performance of Maast.</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM4">
          <media xlink:href="13059_2023_3030_MOESM4_ESM.xlsx">
            <caption>
              <p><bold>Additional file 4: Supplementary Tables S3.</bold> Detailed computational performance of Maast, Parsnp and kSNP based on running each tool on 500, 1000 and 5000 genomes.</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM5">
          <media xlink:href="13059_2023_3030_MOESM5_ESM.xlsx">
            <caption>
              <p><bold>Additional file 5: Supplementary Tables S4.</bold> List of accession numbers for the whole genome assemblies and sequencing reads of <italic>B. uniformis</italic>.</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM6">
          <media xlink:href="13059_2023_3030_MOESM6_ESM.xlsx">
            <caption>
              <p><bold>Additional file 6: Supplementary Tables S5.</bold> Detailed comparison of SNP calling accuracy between Maast, Maast + NRC, kSNP and Parsnp.</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM7">
          <media xlink:href="13059_2023_3030_MOESM7_ESM.xlsx">
            <caption>
              <p><bold>Additional file 7: Supplementary Tables S6.</bold> List of accession numbers for 3,428 whole genome assemblies of <italic>H. pylori</italic>.</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM8">
          <media xlink:href="13059_2023_3030_MOESM8_ESM.xlsx">
            <caption>
              <p><bold>Additional file 8: Supplementary Tables S7.</bold> Accession numbers and metadata of 3,178 <italic>H. pylori</italic> strains.</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM9">
          <media xlink:href="13059_2023_3030_MOESM9_ESM.xlsx">
            <caption>
              <p><bold>Additional file 9: Supplementary Tables S8.</bold> List of 475 <italic>H. pylori</italic> strains with paired whole genome assemblies and sequencing reads.</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM10">
          <media xlink:href="13059_2023_3030_MOESM10_ESM.xlsx">
            <caption>
              <p><bold>Additional file 10: Supplementary Tables S9.</bold> Accession numbers and metadata of 37,096 SARS-CoV-2 strains downloaded from the NCBI <italic>SARS-CoV-2</italic> Data Hub and SRA.</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM11">
          <media xlink:href="13059_2023_3030_MOESM11_ESM.docx">
            <caption>
              <p><bold>Additional file 11.</bold> Review history.</p>
            </caption>
          </media>
        </supplementary-material>
      </p>
    </sec>
  </sec>
</body>
<back>
  <fn-group>
    <fn>
      <p>
        <bold>Publisher's Note</bold>
      </p>
      <p>Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p>
    </fn>
  </fn-group>
  <notes notes-type="author-contribution">
    <title>Authors’ contributions</title>
    <p>ZJS conceived the project, developed the method, designed and performed the computational experiments, interpreted the results, wrote the software, made figures and tables, and drafted the manuscript. SN provided feedback and tested the software. KSP supervised the project, designed the computational experiments, interpreted the results, and provided feedback, funding, and computing resources. SN and KSP revised the manuscript. All authors read and approved the final manuscript.</p>
    <sec id="FPar1">
      <title>Review history</title>
      <p id="Par53">The review history is available as Additional file <xref rid="MOESM11" ref-type="media">11</xref>.</p>
    </sec>
    <sec id="FPar2">
      <title>Peer review information</title>
      <p id="Par54">Kevin Pang was the primary editor of this article and managed its editorial process and peer review in collaboration with the rest of the editorial team.</p>
    </sec>
  </notes>
  <notes notes-type="funding-information">
    <title>Funding</title>
    <p>This work was funded by the Chan Zuckerberg Biohub, Gladstone Institutes, NSF grant #1563159, and NHLBI grant #HL160862. The work conducted by the US Department of Energy Joint Genome Institute was supported by the Office of Science of the US Department of Energy under contract no. DE-AC02-05CH11231.</p>
  </notes>
  <notes notes-type="data-availability">
    <title>Availability of data and materials</title>
    <p>All described datasets are publicly available through the corresponding repositories. Genome assemblies and whole genome sequencing samples are available at UHGG, NCBI, and PATRIC database with accession numbers in supplementary tables: genome assemblies for <italic>Alistipes putredinis</italic>, <italic>Bacteroides_B dorei</italic>, and <italic>Agathobacter rectalis</italic> (Additional file <xref rid="MOESM3" ref-type="media">3</xref>: Table S2), and both genome assemblies and whole genome sequencing samples for <italic>Bacteroides uniformis</italic> (Additional file <xref rid="MOESM5" ref-type="media">5</xref>: Table S4), <italic>Helicobacter pylori</italic> (Additional files <xref rid="MOESM7" ref-type="media">7</xref>, <xref rid="MOESM8" ref-type="media">8</xref> and <xref rid="MOESM9" ref-type="media">9</xref>: Table S6, S7, and S8) and SARS-CoV-2 (Additional file <xref rid="MOESM10" ref-type="media">10</xref>: Table S9).</p>
    <p>Maast is written in C +  + and Python, and it is released as open-source software under the MIT license. The source code and documentation of Maast is available on Zenodo and GitHub (<ext-link ext-link-type="uri" xlink:href="https://github.com/zjshi/Maast">https://github.com/zjshi/Maast</ext-link> [<xref ref-type="bibr" rid="CR37">37</xref>, <xref ref-type="bibr" rid="CR38">38</xref>]).</p>
  </notes>
  <notes>
    <title>Declarations</title>
    <notes id="FPar3">
      <title>Ethics approval</title>
      <p id="Par55">Not applicable.</p>
    </notes>
    <notes id="FPar4" notes-type="COI-statement">
      <title>Competing interests</title>
      <p id="Par56">The authors declare that they have no competing interests.</p>
    </notes>
  </notes>
  <ref-list id="Bib1">
    <title>References</title>
    <ref id="CR1">
      <label>1.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Jain</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Rodriguez-R</surname>
            <given-names>LM</given-names>
          </name>
          <name>
            <surname>Phillippy</surname>
            <given-names>AM</given-names>
          </name>
          <name>
            <surname>Konstantinidis</surname>
            <given-names>KT</given-names>
          </name>
          <name>
            <surname>Aluru</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>High throughput ANI analysis of 90K prokaryotic genomes reveals clear species boundaries</article-title>
        <source>Nat Commun</source>
        <year>2018</year>
        <volume>9</volume>
        <fpage>5114</fpage>
        <pub-id pub-id-type="doi">10.1038/s41467-018-07641-9</pub-id>
        <?supplied-pmid 30504855?>
        <pub-id pub-id-type="pmid">30504855</pub-id>
      </element-citation>
    </ref>
    <ref id="CR2">
      <label>2.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Almeida</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Nayfach</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Boland</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Strozzi</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Beracochea</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Shi</surname>
            <given-names>ZJ</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>A unified catalog of 204,938 reference genomes from the human gut microbiome</article-title>
        <source>Nat Biotechnol</source>
        <year>2021</year>
        <volume>39</volume>
        <fpage>105</fpage>
        <lpage>114</lpage>
        <pub-id pub-id-type="doi">10.1038/s41587-020-0603-3</pub-id>
        <?supplied-pmid 32690973?>
        <pub-id pub-id-type="pmid">32690973</pub-id>
      </element-citation>
    </ref>
    <ref id="CR3">
      <label>3.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Pearce</surname>
            <given-names>ME</given-names>
          </name>
          <name>
            <surname>Alikhan</surname>
            <given-names>N-F</given-names>
          </name>
          <name>
            <surname>Dallman</surname>
            <given-names>TJ</given-names>
          </name>
          <name>
            <surname>Zhou</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Grant</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Maiden</surname>
            <given-names>MCJ</given-names>
          </name>
        </person-group>
        <article-title>Comparative analysis of core genome MLST and SNP typing within a European Salmonella serovar Enteritidis outbreak</article-title>
        <source>Int J Food Microbiol</source>
        <year>2018</year>
        <volume>274</volume>
        <fpage>1</fpage>
        <lpage>11</lpage>
        <pub-id pub-id-type="doi">10.1016/j.ijfoodmicro.2018.02.023</pub-id>
        <?supplied-pmid 29574242?>
        <pub-id pub-id-type="pmid">29574242</pub-id>
      </element-citation>
    </ref>
    <ref id="CR4">
      <label>4.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Leaché</surname>
            <given-names>AD</given-names>
          </name>
          <name>
            <surname>Oaks</surname>
            <given-names>JR</given-names>
          </name>
        </person-group>
        <article-title>The Utility of Single Nucleotide Polymorphism (SNP) Data in Phylogenetics</article-title>
        <source>Annu Rev Ecol Evol Syst</source>
        <year>2017</year>
        <volume>48</volume>
        <fpage>69</fpage>
        <lpage>84</lpage>
        <pub-id pub-id-type="doi">10.1146/annurev-ecolsys-110316-022645</pub-id>
      </element-citation>
    </ref>
    <ref id="CR5">
      <label>5.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Freschi</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Vargas</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Husain</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Kamal</surname>
            <given-names>SMM</given-names>
          </name>
          <name>
            <surname>Skrahina</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Tahseen</surname>
            <given-names>S</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Population structure, biogeography and transmissibility of Mycobacterium tuberculosis</article-title>
        <source>Nat Commun</source>
        <year>2021</year>
        <volume>12</volume>
        <fpage>6099</fpage>
        <pub-id pub-id-type="doi">10.1038/s41467-021-26248-1</pub-id>
        <?supplied-pmid 34671035?>
        <pub-id pub-id-type="pmid">34671035</pub-id>
      </element-citation>
    </ref>
    <ref id="CR6">
      <label>6.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Figueroa</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Castro</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Lagos</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Cartes</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Isla</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Yáñez</surname>
            <given-names>AJ</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Analysis of single nucleotide polymorphisms (SNPs) associated with antibiotic resistance genes in Chilean Piscirickettsia salmonis strains</article-title>
        <source>J Fish Dis</source>
        <year>2019</year>
        <volume>42</volume>
        <fpage>1645</fpage>
        <lpage>1655</lpage>
        <pub-id pub-id-type="doi">10.1111/jfd.13089</pub-id>
        <?supplied-pmid 31591746?>
        <pub-id pub-id-type="pmid">31591746</pub-id>
      </element-citation>
    </ref>
    <ref id="CR7">
      <label>7.</label>
      <mixed-citation publication-type="other">Cooper AL, Low AJ, Koziol AG, Thomas MC, Leclair D, Tamber S, et al. Systematic Evaluation of Whole Genome Sequence-Based Predictions of Salmonella Serotype and Antimicrobial Resistance. Front Microbiol. 2020;11:549.</mixed-citation>
    </ref>
    <ref id="CR8">
      <label>8.</label>
      <mixed-citation publication-type="other">Maiden Martin C. J., Bygraves Jane A., Feil Edward, Morelli Giovanna, Russell Joanne E., Urwin Rachel, et al. Multilocus sequence typing: a portable approach to the identification of clones within populations of pathogenic microorganisms. Proc Natl Acad Sci. 1998;95:3140–5.</mixed-citation>
    </ref>
    <ref id="CR9">
      <label>9.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Gardner</surname>
            <given-names>SN</given-names>
          </name>
          <name>
            <surname>Hall</surname>
            <given-names>BG</given-names>
          </name>
        </person-group>
        <article-title>When whole-genome alignments just won’t work: kSNP v2 software for alignment-free SNP discovery and phylogenetics of hundreds of microbial genomes</article-title>
        <source>PLoS ONE</source>
        <year>2013</year>
        <volume>8</volume>
        <fpage>e81760</fpage>
        <pub-id pub-id-type="doi">10.1371/journal.pone.0081760</pub-id>
        <?supplied-pmid 24349125?>
        <pub-id pub-id-type="pmid">24349125</pub-id>
      </element-citation>
    </ref>
    <ref id="CR10">
      <label>10.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Treangen</surname>
            <given-names>TJ</given-names>
          </name>
          <name>
            <surname>Ondov</surname>
            <given-names>BD</given-names>
          </name>
          <name>
            <surname>Koren</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Phillippy</surname>
            <given-names>AM</given-names>
          </name>
        </person-group>
        <article-title>The Harvest suite for rapid core-genome alignment and visualization of thousands of intraspecific microbial genomes</article-title>
        <source>Genome Biol</source>
        <year>2014</year>
        <volume>15</volume>
        <fpage>524</fpage>
        <pub-id pub-id-type="doi">10.1186/s13059-014-0524-x</pub-id>
        <?supplied-pmid 25410596?>
        <pub-id pub-id-type="pmid">25410596</pub-id>
      </element-citation>
    </ref>
    <ref id="CR11">
      <label>11.</label>
      <mixed-citation publication-type="other">Gardner SN, Slezak T, Hall BG. kSNP3.0: SNP detection and phylogenetic analysis of genomes without genome alignment or reference genome. Bioinformatics. 2015;31:2877–8.</mixed-citation>
    </ref>
    <ref id="CR12">
      <label>12.</label>
      <mixed-citation publication-type="other">Ghazi AR, Münch PC, Chen D, Jensen J, Huttenhower C. Strain identification and quantitative analysis in microbial communities. J Mol Biol. 2022;434:167582.</mixed-citation>
    </ref>
    <ref id="CR13">
      <label>13.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zhao</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Shi</surname>
            <given-names>ZJ</given-names>
          </name>
          <name>
            <surname>Pollard</surname>
            <given-names>KS</given-names>
          </name>
        </person-group>
        <article-title>Pitfalls of genotyping microbial communities with rapidly growing genome collections</article-title>
        <source>Cell Syst</source>
        <year>2023</year>
        <volume>14</volume>
        <fpage>160</fpage>
        <lpage>176.e3</lpage>
        <pub-id pub-id-type="doi">10.1016/j.cels.2022.12.007</pub-id>
        <?supplied-pmid 36657438?>
        <pub-id pub-id-type="pmid">36657438</pub-id>
      </element-citation>
    </ref>
    <ref id="CR14">
      <label>14.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Tolar</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Joseph</surname>
            <given-names>LA</given-names>
          </name>
          <name>
            <surname>Schroeder</surname>
            <given-names>MN</given-names>
          </name>
          <name>
            <surname>Stroika</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Ribot</surname>
            <given-names>EM</given-names>
          </name>
          <name>
            <surname>Hise</surname>
            <given-names>KB</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>An overview of PulseNet USA databases</article-title>
        <source>Foodborne Pathog Dis</source>
        <year>2019</year>
        <volume>16</volume>
        <fpage>457</fpage>
        <lpage>462</lpage>
        <pub-id pub-id-type="doi">10.1089/fpd.2019.2637</pub-id>
        <?supplied-pmid 31066584?>
        <pub-id pub-id-type="pmid">31066584</pub-id>
      </element-citation>
    </ref>
    <ref id="CR15">
      <label>15.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Shi</surname>
            <given-names>ZJ</given-names>
          </name>
          <name>
            <surname>Dimitrov</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Zhao</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Nayfach</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Pollard</surname>
            <given-names>KS</given-names>
          </name>
        </person-group>
        <article-title>Fast and accurate metagenotyping of the human gut microbiome with GT-Pro</article-title>
        <source>Nat Biotechnol</source>
        <year>2022</year>
        <volume>40</volume>
        <fpage>507</fpage>
        <lpage>516</lpage>
        <pub-id pub-id-type="doi">10.1038/s41587-021-01102-3</pub-id>
        <?supplied-pmid 34949778?>
        <pub-id pub-id-type="pmid">34949778</pub-id>
      </element-citation>
    </ref>
    <ref id="CR16">
      <label>16.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Iqbal</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Turner</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>McVean</surname>
            <given-names>G</given-names>
          </name>
        </person-group>
        <article-title>High-throughput microbial population genomics using the Cortex variation assembler</article-title>
        <source>Bioinformatics</source>
        <year>2013</year>
        <volume>29</volume>
        <fpage>275</fpage>
        <lpage>276</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/bts673</pub-id>
        <?supplied-pmid 23172865?>
        <pub-id pub-id-type="pmid">23172865</pub-id>
      </element-citation>
    </ref>
    <ref id="CR17">
      <label>17.</label>
      <mixed-citation publication-type="other">Jiang X, Xu Z, Zhang T, Li Y, Li W, Tan H. Whole-genome-based helicobacter pylori geographic surveillance: a visualized and expandable webtool. Front Microbiol. 2021;12:687259.</mixed-citation>
    </ref>
    <ref id="CR18">
      <label>18.</label>
      <mixed-citation publication-type="other">Moodley Yoshan, Brunelli Andrea, Ghirotto Silvia, Klyubin Andrey, Maady Ayas S., Tyne William, et al. Helicobacter pylori’s historical journey through Siberia and the Americas. Proc Natl Acad Sci. 2021;118:e2015523118.</mixed-citation>
    </ref>
    <ref id="CR19">
      <label>19.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Linz</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Windsor</surname>
            <given-names>HM</given-names>
          </name>
          <name>
            <surname>McGraw</surname>
            <given-names>JJ</given-names>
          </name>
          <name>
            <surname>Hansen</surname>
            <given-names>LM</given-names>
          </name>
          <name>
            <surname>Gajewski</surname>
            <given-names>JP</given-names>
          </name>
          <name>
            <surname>Tomsho</surname>
            <given-names>LP</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>A mutation burst during the acute phase of Helicobacter pylori infection in humans and rhesus macaques</article-title>
        <source>Nat Commun</source>
        <year>2014</year>
        <volume>5</volume>
        <fpage>4165</fpage>
        <pub-id pub-id-type="doi">10.1038/ncomms5165</pub-id>
        <?supplied-pmid 24924186?>
        <pub-id pub-id-type="pmid">24924186</pub-id>
      </element-citation>
    </ref>
    <ref id="CR20">
      <label>20.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bishara</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Moss</surname>
            <given-names>EL</given-names>
          </name>
          <name>
            <surname>Kolmogorov</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Parada</surname>
            <given-names>AE</given-names>
          </name>
          <name>
            <surname>Weng</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Sidow</surname>
            <given-names>A</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>High-quality genome sequences of uncultured microbes by assembly of read clouds</article-title>
        <source>Nat Biotechnol</source>
        <year>2018</year>
        <volume>36</volume>
        <fpage>1067</fpage>
        <lpage>1075</lpage>
        <pub-id pub-id-type="doi">10.1038/nbt.4266</pub-id>
      </element-citation>
    </ref>
    <ref id="CR21">
      <label>21.</label>
      <mixed-citation publication-type="other">Zheng Wenshan, Zhao Shijie, Yin Yehang, Zhang Huidan, Needham David M., Evans Ethan D., et al. High-throughput, single-microbe genomics with strain resolution, applied to a human gut microbiome. Science. 2022;376:eabm1483.</mixed-citation>
    </ref>
    <ref id="CR22">
      <label>22.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Nayfach</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Páez-Espino</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Call</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Low</surname>
            <given-names>SJ</given-names>
          </name>
          <name>
            <surname>Sberro</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Ivanova</surname>
            <given-names>NN</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Metagenomic compendium of 189,680 DNA viruses from the human gut microbiome</article-title>
        <source>Nat Microbiol</source>
        <year>2021</year>
        <volume>6</volume>
        <fpage>960</fpage>
        <lpage>970</lpage>
        <pub-id pub-id-type="doi">10.1038/s41564-021-00928-6</pub-id>
        <?supplied-pmid 34168315?>
        <pub-id pub-id-type="pmid">34168315</pub-id>
      </element-citation>
    </ref>
    <ref id="CR23">
      <label>23.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Turner</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Garimella</surname>
            <given-names>KV</given-names>
          </name>
          <name>
            <surname>Iqbal</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>McVean</surname>
            <given-names>G</given-names>
          </name>
        </person-group>
        <article-title>Integrating long-range connectivity information into de Bruijn graphs</article-title>
        <source>Bioinformatics</source>
        <year>2018</year>
        <volume>34</volume>
        <fpage>2556</fpage>
        <lpage>2565</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/bty157</pub-id>
        <?supplied-pmid 29554215?>
        <pub-id pub-id-type="pmid">29554215</pub-id>
      </element-citation>
    </ref>
    <ref id="CR24">
      <label>24.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ondov</surname>
            <given-names>BD</given-names>
          </name>
          <name>
            <surname>Treangen</surname>
            <given-names>TJ</given-names>
          </name>
          <name>
            <surname>Melsted</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Mallonee</surname>
            <given-names>AB</given-names>
          </name>
          <name>
            <surname>Bergman</surname>
            <given-names>NH</given-names>
          </name>
          <name>
            <surname>Koren</surname>
            <given-names>S</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Mash: fast genome and metagenome distance estimation using MinHash</article-title>
        <source>Genome Biol</source>
        <year>2016</year>
        <volume>17</volume>
        <fpage>132</fpage>
        <pub-id pub-id-type="doi">10.1186/s13059-016-0997-x</pub-id>
        <?supplied-pmid 27323842?>
        <pub-id pub-id-type="pmid">27323842</pub-id>
      </element-citation>
    </ref>
    <ref id="CR25">
      <label>25.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Marçais</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Delcher</surname>
            <given-names>AL</given-names>
          </name>
          <name>
            <surname>Phillippy</surname>
            <given-names>AM</given-names>
          </name>
          <name>
            <surname>Coston</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Salzberg</surname>
            <given-names>SL</given-names>
          </name>
          <name>
            <surname>Zimin</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>MUMmer4: A fast and versatile genome alignment system</article-title>
        <source>PLoS Comput Biol</source>
        <year>2018</year>
        <volume>14</volume>
        <fpage>e1005944</fpage>
        <pub-id pub-id-type="doi">10.1371/journal.pcbi.1005944</pub-id>
        <?supplied-pmid 29373581?>
        <pub-id pub-id-type="pmid">29373581</pub-id>
      </element-citation>
    </ref>
    <ref id="CR26">
      <label>26.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Angiuoli</surname>
            <given-names>SV</given-names>
          </name>
          <name>
            <surname>Salzberg</surname>
            <given-names>SL</given-names>
          </name>
        </person-group>
        <article-title>Mugsy: fast multiple alignment of closely related whole genomes</article-title>
        <source>Bioinformatics</source>
        <year>2011</year>
        <volume>27</volume>
        <fpage>334</fpage>
        <lpage>342</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btq665</pub-id>
        <?supplied-pmid 21148543?>
        <pub-id pub-id-type="pmid">21148543</pub-id>
      </element-citation>
    </ref>
    <ref id="CR27">
      <label>27.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Darling</surname>
            <given-names>ACE</given-names>
          </name>
          <name>
            <surname>Mau</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Blattner</surname>
            <given-names>FR</given-names>
          </name>
          <name>
            <surname>Perna</surname>
            <given-names>NT</given-names>
          </name>
        </person-group>
        <article-title>Mauve: multiple alignment of conserved genomic sequence with rearrangements</article-title>
        <source>Genome Res</source>
        <year>2004</year>
        <volume>14</volume>
        <fpage>1394</fpage>
        <lpage>1403</lpage>
        <pub-id pub-id-type="doi">10.1101/gr.2289704</pub-id>
        <?supplied-pmid 15231754?>
        <pub-id pub-id-type="pmid">15231754</pub-id>
      </element-citation>
    </ref>
    <ref id="CR28">
      <label>28.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Li</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Durbin</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>Fast and accurate short read alignment with Burrows-Wheeler transform</article-title>
        <source>Bioinformatics</source>
        <year>2009</year>
        <volume>25</volume>
        <fpage>1754</fpage>
        <lpage>1760</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btp324</pub-id>
        <?supplied-pmid 19451168?>
        <pub-id pub-id-type="pmid">19451168</pub-id>
      </element-citation>
    </ref>
    <ref id="CR29">
      <label>29.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Li</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Handsaker</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Wysoker</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Fennell</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Ruan</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Homer</surname>
            <given-names>N</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>The sequence alignment/map format and SAMtools</article-title>
        <source>Bioinformatics</source>
        <year>2009</year>
        <volume>25</volume>
        <fpage>2078</fpage>
        <lpage>2079</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btp352</pub-id>
        <?supplied-pmid 19505943?>
        <pub-id pub-id-type="pmid">19505943</pub-id>
      </element-citation>
    </ref>
    <ref id="CR30">
      <label>30.</label>
      <mixed-citation publication-type="other">Garrison E, Marth G. Haplotype-based variant detection from short-read sequencing. arXiv preprint arXiv:12073907. 2012.</mixed-citation>
    </ref>
    <ref id="CR31">
      <label>31.</label>
      <mixed-citation publication-type="other">Bush SJ, Foster D, Eyre DW, Clark EL, De Maio N, Shaw LP, et al. Genomic diversity affects the accuracy of bacterial single-nucleotide polymorphism–calling pipelines. GigaScience. 2020;9:giaa007.</mixed-citation>
    </ref>
    <ref id="CR32">
      <label>32.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zou</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Xue</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Luo</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Deng</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Qin</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Guo</surname>
            <given-names>R</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>1,520 reference genomes from cultivated human gut bacteria enable functional microbiome analyses</article-title>
        <source>Nat Biotechnol</source>
        <year>2019</year>
        <volume>37</volume>
        <fpage>179</fpage>
        <lpage>185</lpage>
        <pub-id pub-id-type="doi">10.1038/s41587-018-0008-8</pub-id>
        <?supplied-pmid 30718868?>
        <pub-id pub-id-type="pmid">30718868</pub-id>
      </element-citation>
    </ref>
    <ref id="CR33">
      <label>33.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Gourlé</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Karlsson-Lindsjö</surname>
            <given-names>O</given-names>
          </name>
          <name>
            <surname>Hayer</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Bongcam-Rudloff</surname>
            <given-names>E</given-names>
          </name>
        </person-group>
        <article-title>Simulating Illumina metagenomic data with InSilicoSeq</article-title>
        <source>Bioinformatics</source>
        <year>2018</year>
        <volume>35</volume>
        <fpage>521</fpage>
        <lpage>522</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/bty630</pub-id>
      </element-citation>
    </ref>
    <ref id="CR34">
      <label>34.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wattam</surname>
            <given-names>AR</given-names>
          </name>
          <name>
            <surname>Abraham</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Dalay</surname>
            <given-names>O</given-names>
          </name>
          <name>
            <surname>Disz</surname>
            <given-names>TL</given-names>
          </name>
          <name>
            <surname>Driscoll</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Gabbard</surname>
            <given-names>JL</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>PATRIC, the bacterial bioinformatics database and analysis resource</article-title>
        <source>Nucleic Acids Res</source>
        <year>2014</year>
        <volume>42</volume>
        <fpage>D581</fpage>
        <lpage>D591</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/gkt1099</pub-id>
        <?supplied-pmid 24225323?>
        <pub-id pub-id-type="pmid">24225323</pub-id>
      </element-citation>
    </ref>
    <ref id="CR35">
      <label>35.</label>
      <mixed-citation publication-type="other">Stamatakis A. RAxML version 8: a tool for phylogenetic analysis and post-analysis of large phylogenies. Bioinformatics. 2014/01/21 ed. 2014;30:1312–3.</mixed-citation>
    </ref>
    <ref id="CR36">
      <label>36.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Letunic</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Bork</surname>
            <given-names>P</given-names>
          </name>
        </person-group>
        <article-title>Interactive Tree Of Life (iTOL) v4: recent updates and new developments</article-title>
        <source>Nucleic Acids Res</source>
        <year>2019</year>
        <volume>47</volume>
        <fpage>W256</fpage>
        <lpage>W259</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/gkz239</pub-id>
        <?supplied-pmid 30931475?>
        <pub-id pub-id-type="pmid">30931475</pub-id>
      </element-citation>
    </ref>
    <ref id="CR37">
      <label>37.</label>
      <mixed-citation publication-type="other">Shi ZJ, Nayfach S, Pollard KS. Maast: genotyping thousands of microbial strains efficiently. Zenodo; 2022. 10.5281/zenodo.8200643.</mixed-citation>
    </ref>
    <ref id="CR38">
      <label>38.</label>
      <mixed-citation publication-type="other">Shi ZJ, Nayfach S, Pollard KS. Maast: genotyping thousands of microbial strains efficiently. GitHub; 2022. Available from: <ext-link ext-link-type="uri" xlink:href="https://github.com/zjshi/Maast">https://github.com/zjshi/Maast</ext-link>.</mixed-citation>
    </ref>
  </ref-list>
</back>
