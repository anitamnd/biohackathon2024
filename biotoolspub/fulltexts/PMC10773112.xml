<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName A++V2.4.dtd?>
<?SourceDTD.Version 2.4?>
<?ConverterInfo.XSLTName springer2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Genome Med</journal-id>
    <journal-id journal-id-type="iso-abbrev">Genome Med</journal-id>
    <journal-title-group>
      <journal-title>Genome Medicine</journal-title>
    </journal-title-group>
    <issn pub-type="epub">1756-994X</issn>
    <publisher>
      <publisher-name>BioMed Central</publisher-name>
      <publisher-loc>London</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">10773112</article-id>
    <article-id pub-id-type="pmid">38185709</article-id>
    <article-id pub-id-type="publisher-id">1274</article-id>
    <article-id pub-id-type="doi">10.1186/s13073-023-01274-4</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Method</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>MAGPIE: accurate pathogenic prediction for multiple variant types using machine learning approach</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author" equal-contrib="yes">
        <name>
          <surname>Liu</surname>
          <given-names>Yicheng</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <contrib contrib-type="author" equal-contrib="yes">
        <name>
          <surname>Zhang</surname>
          <given-names>Tianyun</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>You</surname>
          <given-names>Ningyuan</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <name>
          <surname>Wu</surname>
          <given-names>Sai</given-names>
        </name>
        <address>
          <email>wusai@zju.edu.cn</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0003-4709-3374</contrib-id>
        <name>
          <surname>Shen</surname>
          <given-names>Ning</given-names>
        </name>
        <address>
          <email>shenningzju@zju.edu.cn</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <aff id="Aff1"><label>1</label><institution-wrap><institution-id institution-id-type="GRID">grid.13402.34</institution-id><institution-id institution-id-type="ISNI">0000 0004 1759 700X</institution-id><institution>Department of Hepatobiliary and Pancreatic Surgery, First Affiliated &gt; Hospital &amp; Liangzhu Laboratory, </institution><institution>Zhejiang University School of Medicine, </institution></institution-wrap>Hangzhou, 311121 China </aff>
      <aff id="Aff2"><label>2</label><institution-wrap><institution-id institution-id-type="ROR">https://ror.org/00a2xv884</institution-id><institution-id institution-id-type="GRID">grid.13402.34</institution-id><institution-id institution-id-type="ISNI">0000 0004 1759 700X</institution-id><institution>College of Computer Science, </institution><institution>Zhejiang University, </institution></institution-wrap>Yuquan Campus, Zhejiang University, Rd Zheda 38, Xihu District, Hangzhou, 310007 China </aff>
    </contrib-group>
    <pub-date pub-type="epub">
      <day>8</day>
      <month>1</month>
      <year>2024</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>8</day>
      <month>1</month>
      <year>2024</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2024</year>
    </pub-date>
    <volume>16</volume>
    <elocation-id>3</elocation-id>
    <history>
      <date date-type="received">
        <day>14</day>
        <month>8</month>
        <year>2023</year>
      </date>
      <date date-type="accepted">
        <day>12</day>
        <month>12</month>
        <year>2023</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2023, corrected publication 2024</copyright-statement>
      <license>
        <ali:license_ref specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p><bold>Open Access</bold> This article is licensed under a Creative Commons Attribution 4.0 International License, which permits use, sharing, adaptation, distribution and reproduction in any medium or format, as long as you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons licence, and indicate if changes were made. The images or other third party material in this article are included in the article's Creative Commons licence, unless indicated otherwise in a credit line to the material. If material is not included in the article's Creative Commons licence and your intended use is not permitted by statutory regulation or exceeds the permitted use, you will need to obtain permission directly from the copyright holder. To view a copy of this licence, visit <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>. The Creative Commons Public Domain Dedication waiver (<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/publicdomain/zero/1.0/">http://creativecommons.org/publicdomain/zero/1.0/</ext-link>) applies to the data made available in this article, unless otherwise stated in a credit line to the data.</license-p>
      </license>
    </permissions>
    <abstract id="Abs1">
      <p id="Par1">Identifying pathogenic variants from the vast majority of nucleotide variation remains a challenge. We present a method named Multimodal Annotation Generated Pathogenic Impact Evaluator (MAGPIE) that predicts the pathogenicity of multi-type variants. MAGPIE uses the ClinVar dataset for training and demonstrates superior performance in both the independent test set and multiple orthogonal validation datasets, accurately predicting variant pathogenicity. Notably, MAGPIE performs best in predicting the pathogenicity of rare variants and highly imbalanced datasets. Overall, results underline the robustness of MAGPIE as a valuable tool for predicting pathogenicity in various types of human genome variations. MAGPIE is available at <ext-link ext-link-type="uri" xlink:href="https://github.com/shenlab-genomics/magpie">https://github.com/shenlab-genomics/magpie</ext-link>.</p>
      <sec>
        <title>Supplementary Information</title>
        <p>The online version contains supplementary material available at 10.1186/s13073-023-01274-4.</p>
      </sec>
    </abstract>
    <kwd-group xml:lang="en">
      <title>Keywords</title>
      <kwd>Pathogenic prediction</kwd>
      <kwd>Multimodal annotation</kwd>
      <kwd>Machine learning</kwd>
      <kwd>Genomic variation</kwd>
    </kwd-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution>Liangzhu Laboratory</institution>
        </funding-source>
      </award-group>
    </funding-group>
    <custom-meta-group>
      <custom-meta>
        <meta-name>issue-copyright-statement</meta-name>
        <meta-value>© BioMed Central Ltd., part of Springer Nature 2024</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec id="Sec1">
    <title>Background</title>
    <p id="Par57">The rapid accumulation of the whole genome sequencing (WGS) and the whole exome sequencing (WES) data has led to the discovery of a tremendous number of genetic variations, both pathogenic and non-pathogenic. To aid the assessment and understanding of these variations, population databases such as gnomAD [<xref ref-type="bibr" rid="CR1">1</xref>], ExAC [<xref ref-type="bibr" rid="CR2">2</xref>], and ChinaMap [<xref ref-type="bibr" rid="CR3">3</xref>] have been established. Additionally, genetic disease databases, e.g., ClinVar [<xref ref-type="bibr" rid="CR4">4</xref>], OMIM [<xref ref-type="bibr" rid="CR5">5</xref>], and HGMD [<xref ref-type="bibr" rid="CR6">6</xref>], have also amassed a large amount of information on known pathogenic or benign genetic variations. These databases have been widely used as references in the genetic diagnosis of Mendelian diseases.</p>
    <p id="Par58">Pathogenic mutations that cause Mendelian diseases are known to function through various biological mechanisms and thus have been categorized and studied in different aspects. For instance, exonic mutations based on the protein sequence alterations are categorized into synonymous, missense, stop-gain, stop-loss, frameshift, etc. Synonymous mutations do not alter protein sequence, whereas missense mutations result in different amino acids being encoded. Since missense mutation-associated changes in protein sequence may potentially be pathogenic, various studies have focused on predicting the pathogenic impact of missense variants [<xref ref-type="bibr" rid="CR7">7</xref>–<xref ref-type="bibr" rid="CR17">17</xref>]. On the other hand, some mutations are pathogenic at the RNA level through splicing alterations, and these mutations are often located in the splicing donor, acceptor, and intronic regions. Consequently, splicing alterations have also been considered for the pathogenicity evaluation of mutations [<xref ref-type="bibr" rid="CR18">18</xref>, <xref ref-type="bibr" rid="CR19">19</xref>]. However, in clinical practice of genetic diagnosis using WES, different types of mutations and mechanisms should be considered simultaneously to identify the pathogenic mutation.</p>
    <p id="Par59">With the development of machine learning (ML) and deep learning (DL), many computational methods using ML or DL have been developed for predicting mutation disruption or pathogenicity. Some methods were developed based on specific biological mechanisms or data types. For example, SpliceAI employs a deep neural network to learn information about splicing codes of the genome and predict whether a mutation affects splicing [<xref ref-type="bibr" rid="CR19">19</xref>]. Frazer et al. proposed the evolutionary model of variant effect (EVE) based on a deep generation model of evolutionary data to predict the pathogenicity of human missense variants [<xref ref-type="bibr" rid="CR16">16</xref>]. On the other hand, some algorithms consider ensemble features from multiple aspects and build on top of existing pathogenicity prediction. For example, the Combined Annotation-Dependent Depletion (CADD) implements a support vector machine with annotation features in conservation metrics, regulatory information, transcript information, and so on [<xref ref-type="bibr" rid="CR20">20</xref>]. Daniel et al. proposed DANN, which uses the same features as CADD but integrates them into a deep neural network for better performance [<xref ref-type="bibr" rid="CR21">21</xref>]. REVEL is another approach proposed by Nilah et al. that uses a logistic regression model and relies on multiple pathogenicity prediction tools, including MutPred [<xref ref-type="bibr" rid="CR22">22</xref>], VEST [<xref ref-type="bibr" rid="CR14">14</xref>], PROVEAN [<xref ref-type="bibr" rid="CR9">9</xref>], Mutation Assessor [<xref ref-type="bibr" rid="CR11">11</xref>], and phastCons [<xref ref-type="bibr" rid="CR23">23</xref>]. Although the aforementioned methods are widely used or developed with state-of-the-art methods, they only apply to specific cases or depend on multiple prediction tools, leaving many genetic variants unpredictable in real-world prediction tasks.</p>
    <p id="Par60">In this study, we present MAGPIE (Multimodal Annotation Generated Pathogenic Impact Evaluator), a pathogenicity prediction tool for all nonsynonymous exonic variants. MAGPIE employs multimodal annotation to annotate all exonic variants to cope with various mutation types and pathogenic mechanisms. The idea is that from the user’s perspective, the pathogenicity of a variant should be jointly evaluated on multiple scopes, and MAGPIE can help automate this process by leveraging the modern machine learning methodologies. We benchmarked MAGPIE against 14 previously published methods and found that MAGPIE outperformed all other methods in both independent test set and several imbalanced orthogonal validation sets. Notably, MAGPIE was able to make predictions on multiple types of exonic mutations, fulfilling 5–60% of unapplicable missing values based on previous methods. Most importantly, the superior performance of MAGPIE in highly imbalanced validation dataset, as well as variants with low population allele frequency highlights its advantage in clinically relevant applications of interpreting VUS for individual patients, where the model is typically applied to identify less than 5% pathogenic variants from tens of thousands of candidate variants. We envision that MAGPIE will be a valuable tool and widely adopted for pathogenicity prediction in the field. MAGPIE is available as an online server at <ext-link ext-link-type="uri" xlink:href="http://tools.shenlab-genomics.org/tools/MAGPIE">http://tools.shenlab-genomics.org/tools/MAGPIE</ext-link>.</p>
  </sec>
  <sec id="Sec2">
    <title>Methods</title>
    <sec id="Sec3">
      <title>Data preparation</title>
      <p id="Par61">We ensemble several germline mutation databases as the source of our datasets. Germline mutations are changes to DNA that individuals inherit from the egg and sperm cells during conception. ClinVar database (<ext-link ext-link-type="uri" xlink:href="https://ftp.ncbi.nlm.nih.gov/pub/clinvar/">https://ftp.ncbi.nlm.nih.gov/pub/clinvar/</ext-link>, accessed 2022.6.24) was downloaded and included nonsynonymous SNV (missense variants), stop-gain variants, start-loss variants, frameshift mutations, nonframeshift mutations, and stop-loss variants [<xref ref-type="bibr" rid="CR4">4</xref>]. Variants were categorized as benign, including Likely_benign, Benign, and Benign/Likely_benign labels, and pathogenic, including Likely_pathogenic, Pathogenic, and Pathogenic/Likely_pathogenic, which were selected as true negative (benign) and true positive (pathogenic) labels respectively. All variants with conflicting interpretations and unknown labels were removed. After filtering, we initially identified 78,089 mutations from ClinVar.</p>
      <p id="Par62">To improve the model performance in classifying rare variants, we considered adding rare benign variants to the training dataset as a trade-off between preserving the importance of allele frequency information and helping identify rare pathogenic variants from rare benign variants. We selected ultra-rare benign variants with allele frequency between <inline-formula id="IEq1"><alternatives><tex-math id="M1">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$1{e}^{-5}$$\end{document}</tex-math><mml:math id="M2"><mml:mrow><mml:mn>1</mml:mn><mml:msup><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mn>5</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math><inline-graphic xlink:href="13073_2023_1274_Article_IEq1.gif"/></alternatives></inline-formula> and <inline-formula id="IEq2"><alternatives><tex-math id="M3">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$1{e}^{-3}$$\end{document}</tex-math><mml:math id="M4"><mml:mrow><mml:mn>1</mml:mn><mml:msup><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math><inline-graphic xlink:href="13073_2023_1274_Article_IEq2.gif"/></alternatives></inline-formula> based on the gnomAD database (<ext-link ext-link-type="uri" xlink:href="https://gnomad.broadinstitute.org/downloads/">https://gnomad.broadinstitute.org/downloads/</ext-link>, accessed 2022.09.14) [<xref ref-type="bibr" rid="CR1">1</xref>]. For most chromosomes, there existed about 500,000 available variants. Secondly, we randomly choose 5000 per chromosome. Thirdly, we filtered out variants without enough information after annotating by ANNOVAR (ANNOtate VARition). Finally, we randomly chose again and just retained 500 variants per chromosome. For chr11 and chrY, which did not contain enough variants, we kept them all and randomly used qualified ones in other chromosomes to fill the gap. In total, we incorporated 11,998 variants from gnomAD, and these variants were split into two subsets based on the proportion of the number of variants in ClinVar to that in SwissProt [<xref ref-type="bibr" rid="CR23">23</xref>] for further training and evaluation. We aim to enhance the model’s ability to deal with rare benign variants; thus, it is crucial to minimize the false positive rate influenced by the allele frequency to identify pathogenic variants in the clinical scenario.</p>
      <p id="Par63">We constructed an orthogonal validation set to evaluate the performance of our model. The orthogonal test set was constructed from SwissProt (<ext-link ext-link-type="uri" xlink:href="https://ftp.uniprot.org/pub/databases/uniprot/">https://ftp.uniprot.org/pub/databases/uniprot/</ext-link>, accessed 2022.7.10) [<xref ref-type="bibr" rid="CR23">23</xref>], which contains over 70,000 variants with validated pathogenicity labels. We selected exonic mutations, filtered out variants labeled as US (uncertain significance), and applied the filtering and transformation process to remove all synonymous SNVs, following the same steps used in the ClinVar training and test datasets.</p>
      <p id="Par64">We obtained the ACMG-guided dataset (10.1016/j.gim.2021.11.018, accessed 2023.05.22), which includes a total of 1270 mutations, from the official website as another orthogonal test panel. We first removed 328 mutations without clear clinical significance labeled as uncertain significance—insufficient evidence or uncertain significance—conflicting evidence, 93 variants whose position cannot be mapped from HGVS ID, 358 intronic, 3′ UTR, and 5′ UTR variants, splice sites, and synonymous SNVs, etc., to ensure a fair comparison with other methods (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S3). After filtering, a final dataset of 491 missense mutations was used to compare MAGPIE and other model performances.</p>
      <p id="Par65">Gene-level features encapsulate characteristics that are relevant to genes and are shared across variants within the same gene. As we used gene-level features, variants in the same gene share identical scores for these gene-level features, and it would cause some potential biases and label leakage. Therefore, we performed a random split according to genes. Let <inline-formula id="IEq3"><alternatives><tex-math id="M5">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$D$$\end{document}</tex-math><mml:math id="M6"><mml:mi>D</mml:mi></mml:math><inline-graphic xlink:href="13073_2023_1274_Article_IEq3.gif"/></alternatives></inline-formula> as the dataset to be split; <inline-formula id="IEq4"><alternatives><tex-math id="M7">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$A$$\end{document}</tex-math><mml:math id="M8"><mml:mi>A</mml:mi></mml:math><inline-graphic xlink:href="13073_2023_1274_Article_IEq4.gif"/></alternatives></inline-formula> and <inline-formula id="IEq5"><alternatives><tex-math id="M9">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$B$$\end{document}</tex-math><mml:math id="M10"><mml:mi>B</mml:mi></mml:math><inline-graphic xlink:href="13073_2023_1274_Article_IEq5.gif"/></alternatives></inline-formula> are datasets after splitting; <inline-formula id="IEq6"><alternatives><tex-math id="M11">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${L}_{A}$$\end{document}</tex-math><mml:math id="M12"><mml:msub><mml:mi>L</mml:mi><mml:mi>A</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13073_2023_1274_Article_IEq6.gif"/></alternatives></inline-formula>, <inline-formula id="IEq7"><alternatives><tex-math id="M13">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${L}_{B}$$\end{document}</tex-math><mml:math id="M14"><mml:msub><mml:mi>L</mml:mi><mml:mi>B</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13073_2023_1274_Article_IEq7.gif"/></alternatives></inline-formula>, and <inline-formula id="IEq8"><alternatives><tex-math id="M15">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${L}_{D}$$\end{document}</tex-math><mml:math id="M16"><mml:msub><mml:mi>L</mml:mi><mml:mi>D</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13073_2023_1274_Article_IEq8.gif"/></alternatives></inline-formula> are lists containing genes for datasets <inline-formula id="IEq9"><alternatives><tex-math id="M17">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$A$$\end{document}</tex-math><mml:math id="M18"><mml:mi>A</mml:mi></mml:math><inline-graphic xlink:href="13073_2023_1274_Article_IEq9.gif"/></alternatives></inline-formula> and <inline-formula id="IEq10"><alternatives><tex-math id="M19">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$B$$\end{document}</tex-math><mml:math id="M20"><mml:mi>B</mml:mi></mml:math><inline-graphic xlink:href="13073_2023_1274_Article_IEq10.gif"/></alternatives></inline-formula>; and let <inline-formula id="IEq11"><alternatives><tex-math id="M21">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$D$$\end{document}</tex-math><mml:math id="M22"><mml:mi>D</mml:mi></mml:math><inline-graphic xlink:href="13073_2023_1274_Article_IEq11.gif"/></alternatives></inline-formula> and <inline-formula id="IEq12"><alternatives><tex-math id="M23">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$N$$\end{document}</tex-math><mml:math id="M24"><mml:mi>N</mml:mi></mml:math><inline-graphic xlink:href="13073_2023_1274_Article_IEq12.gif"/></alternatives></inline-formula> as the proportion threshold of variants that should be added to <inline-formula id="IEq13"><alternatives><tex-math id="M25">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$A$$\end{document}</tex-math><mml:math id="M26"><mml:mi>A</mml:mi></mml:math><inline-graphic xlink:href="13073_2023_1274_Article_IEq13.gif"/></alternatives></inline-formula> and <inline-formula id="IEq14"><alternatives><tex-math id="M27">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${n}_{A}$$\end{document}</tex-math><mml:math id="M28"><mml:msub><mml:mi>n</mml:mi><mml:mi>A</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13073_2023_1274_Article_IEq14.gif"/></alternatives></inline-formula> as the realtime proportion of <inline-formula id="IEq15"><alternatives><tex-math id="M29">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$A$$\end{document}</tex-math><mml:math id="M30"><mml:mi>A</mml:mi></mml:math><inline-graphic xlink:href="13073_2023_1274_Article_IEq15.gif"/></alternatives></inline-formula> accounts for <inline-formula id="IEq16"><alternatives><tex-math id="M31">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$D$$\end{document}</tex-math><mml:math id="M32"><mml:mi>D</mml:mi></mml:math><inline-graphic xlink:href="13073_2023_1274_Article_IEq16.gif"/></alternatives></inline-formula>. After completing these steps, the resulting datasets would be as follows: <inline-formula id="IEq17"><alternatives><tex-math id="M33">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${L}_{A}$$\end{document}</tex-math><mml:math id="M34"><mml:msub><mml:mi>L</mml:mi><mml:mi>A</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13073_2023_1274_Article_IEq17.gif"/></alternatives></inline-formula> contains the randomly selected genes from <inline-formula id="IEq18"><alternatives><tex-math id="M35">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${L}_{D}$$\end{document}</tex-math><mml:math id="M36"><mml:msub><mml:mi>L</mml:mi><mml:mi>D</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13073_2023_1274_Article_IEq18.gif"/></alternatives></inline-formula>. <inline-formula id="IEq19"><alternatives><tex-math id="M37">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${L}_{B}$$\end{document}</tex-math><mml:math id="M38"><mml:msub><mml:mi>L</mml:mi><mml:mi>B</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13073_2023_1274_Article_IEq19.gif"/></alternatives></inline-formula> is the remaining genes in <inline-formula id="IEq20"><alternatives><tex-math id="M39">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${L}_{D}$$\end{document}</tex-math><mml:math id="M40"><mml:msub><mml:mi>L</mml:mi><mml:mi>D</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13073_2023_1274_Article_IEq20.gif"/></alternatives></inline-formula> after removing the selected genes. Datasets <inline-formula id="IEq21"><alternatives><tex-math id="M41">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$A$$\end{document}</tex-math><mml:math id="M42"><mml:mi>A</mml:mi></mml:math><inline-graphic xlink:href="13073_2023_1274_Article_IEq21.gif"/></alternatives></inline-formula> and <inline-formula id="IEq22"><alternatives><tex-math id="M43">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$B$$\end{document}</tex-math><mml:math id="M44"><mml:mi>B</mml:mi></mml:math><inline-graphic xlink:href="13073_2023_1274_Article_IEq22.gif"/></alternatives></inline-formula> consist of mutations occurring in genes belonging to categories <inline-formula id="IEq23"><alternatives><tex-math id="M45">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${L}_{A}$$\end{document}</tex-math><mml:math id="M46"><mml:msub><mml:mi>L</mml:mi><mml:mi>A</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13073_2023_1274_Article_IEq23.gif"/></alternatives></inline-formula> and <inline-formula id="IEq24"><alternatives><tex-math id="M47">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${L}_{B}$$\end{document}</tex-math><mml:math id="M48"><mml:msub><mml:mi>L</mml:mi><mml:mi>B</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13073_2023_1274_Article_IEq24.gif"/></alternatives></inline-formula> within dataset <inline-formula id="IEq25"><alternatives><tex-math id="M49">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$D$$\end{document}</tex-math><mml:math id="M50"><mml:mi>D</mml:mi></mml:math><inline-graphic xlink:href="13073_2023_1274_Article_IEq25.gif"/></alternatives></inline-formula>, respectively. We defined the splitting process in Algorithm 1:<fig position="anchor" id="Figa"><caption><p><bold>Algorithm 1.</bold> Dataset split</p></caption><graphic position="anchor" xlink:href="13073_2023_1274_Figa_HTML" id="MO1"/></fig></p>
      <p id="Par66">First, to further enhance the robustness of MAGPIE and ensure a fair comparison, we split the gnomAD dataset. Let <inline-formula id="IEq26"><alternatives><tex-math id="M51">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${n}_{ClinVar}$$\end{document}</tex-math><mml:math id="M52"><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi mathvariant="italic">ClinVar</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13073_2023_1274_Article_IEq26.gif"/></alternatives></inline-formula>, <inline-formula id="IEq27"><alternatives><tex-math id="M53">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${n}_{SwissProt}$$\end{document}</tex-math><mml:math id="M54"><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi mathvariant="italic">SwissProt</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13073_2023_1274_Article_IEq27.gif"/></alternatives></inline-formula>, and <inline-formula id="IEq28"><alternatives><tex-math id="M55">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${n}_{gnomAD}$$\end{document}</tex-math><mml:math id="M56"><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi mathvariant="italic">gnomAD</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13073_2023_1274_Article_IEq28.gif"/></alternatives></inline-formula> denote the number of variants in ClinVar, SwissProt, and gnomAD, respectively. We define dataset <inline-formula id="IEq29"><alternatives><tex-math id="M57">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$D$$\end{document}</tex-math><mml:math id="M58"><mml:mi>D</mml:mi></mml:math><inline-graphic xlink:href="13073_2023_1274_Article_IEq29.gif"/></alternatives></inline-formula> as gnomAD, threshold <inline-formula id="IEq30"><alternatives><tex-math id="M59">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$N$$\end{document}</tex-math><mml:math id="M60"><mml:mi>N</mml:mi></mml:math><inline-graphic xlink:href="13073_2023_1274_Article_IEq30.gif"/></alternatives></inline-formula> as <inline-formula id="IEq31"><alternatives><tex-math id="M61">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${n}_{ClinVar}/\left({n}_{ClinVar}+{n}_{SwissProt}\right)*{n}_{gnomAD}$$\end{document}</tex-math><mml:math id="M62"><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi mathvariant="italic">ClinVar</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">/</mml:mo><mml:mfenced close=")" open="("><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi mathvariant="italic">ClinVar</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi mathvariant="italic">SwissProt</mml:mi></mml:mrow></mml:msub></mml:mfenced><mml:mrow/><mml:mo>∗</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi mathvariant="italic">gnomAD</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="13073_2023_1274_Article_IEq31.gif"/></alternatives></inline-formula>, and randomly split <inline-formula id="IEq32"><alternatives><tex-math id="M63">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$D$$\end{document}</tex-math><mml:math id="M64"><mml:mi>D</mml:mi></mml:math><inline-graphic xlink:href="13073_2023_1274_Article_IEq32.gif"/></alternatives></inline-formula> into <inline-formula id="IEq33"><alternatives><tex-math id="M65">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$A$$\end{document}</tex-math><mml:math id="M66"><mml:mi>A</mml:mi></mml:math><inline-graphic xlink:href="13073_2023_1274_Article_IEq33.gif"/></alternatives></inline-formula> and <inline-formula id="IEq34"><alternatives><tex-math id="M67">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$B$$\end{document}</tex-math><mml:math id="M68"><mml:mi>B</mml:mi></mml:math><inline-graphic xlink:href="13073_2023_1274_Article_IEq34.gif"/></alternatives></inline-formula> which are then added to ClinVar and SwissProt, respectively. We named these two datasets as ClinVar_gnomAD and SwissProt_gnomAD. Second, we defined dataset <inline-formula id="IEq35"><alternatives><tex-math id="M69">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$D$$\end{document}</tex-math><mml:math id="M70"><mml:mi>D</mml:mi></mml:math><inline-graphic xlink:href="13073_2023_1274_Article_IEq35.gif"/></alternatives></inline-formula> as <inline-formula id="IEq36"><alternatives><tex-math id="M71">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ClinVar_{gnomAD}$$\end{document}</tex-math><mml:math id="M72"><mml:mrow><mml:mi>C</mml:mi><mml:mi>l</mml:mi><mml:mi>i</mml:mi><mml:mi>n</mml:mi><mml:mi>V</mml:mi><mml:mi>a</mml:mi><mml:msub><mml:mi>r</mml:mi><mml:mrow><mml:mi mathvariant="italic">gnomAD</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="13073_2023_1274_Article_IEq36.gif"/></alternatives></inline-formula>, threshold <inline-formula id="IEq37"><alternatives><tex-math id="M73">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$N$$\end{document}</tex-math><mml:math id="M74"><mml:mi>N</mml:mi></mml:math><inline-graphic xlink:href="13073_2023_1274_Article_IEq37.gif"/></alternatives></inline-formula> as <inline-formula id="IEq38"><alternatives><tex-math id="M75">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\left({n}_{ClinVar}+{n}_{ClinVar}/\left({n}_{ClinVar}+{n}_{SwissProt}\right)*{n}_{gnomAD}\right)*10\%$$\end{document}</tex-math><mml:math id="M76"><mml:mrow><mml:mfenced close=")" open="("><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi mathvariant="italic">ClinVar</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi mathvariant="italic">ClinVar</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">/</mml:mo><mml:mfenced close=")" open="("><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi mathvariant="italic">ClinVar</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi mathvariant="italic">SwissProt</mml:mi></mml:mrow></mml:msub></mml:mfenced><mml:mrow/><mml:mo>∗</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi mathvariant="italic">gnomAD</mml:mi></mml:mrow></mml:msub></mml:mfenced><mml:mrow/><mml:mo>∗</mml:mo><mml:mn>10</mml:mn><mml:mo>%</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="13073_2023_1274_Article_IEq38.gif"/></alternatives></inline-formula> and randomly split <inline-formula id="IEq39"><alternatives><tex-math id="M77">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$D$$\end{document}</tex-math><mml:math id="M78"><mml:mi>D</mml:mi></mml:math><inline-graphic xlink:href="13073_2023_1274_Article_IEq39.gif"/></alternatives></inline-formula> into <inline-formula id="IEq40"><alternatives><tex-math id="M79">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$A$$\end{document}</tex-math><mml:math id="M80"><mml:mi>A</mml:mi></mml:math><inline-graphic xlink:href="13073_2023_1274_Article_IEq40.gif"/></alternatives></inline-formula> and <inline-formula id="IEq41"><alternatives><tex-math id="M81">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$B$$\end{document}</tex-math><mml:math id="M82"><mml:mi>B</mml:mi></mml:math><inline-graphic xlink:href="13073_2023_1274_Article_IEq41.gif"/></alternatives></inline-formula>, namely training and independent test set respectively. Finally, we excluded all variants in <inline-formula id="IEq42"><alternatives><tex-math id="M83">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$SwissProt_{gnomAD}$$\end{document}</tex-math><mml:math id="M84"><mml:mrow><mml:mi>S</mml:mi><mml:mi>w</mml:mi><mml:mi>i</mml:mi><mml:mi>s</mml:mi><mml:mi>s</mml:mi><mml:mi>P</mml:mi><mml:mi>r</mml:mi><mml:mi>o</mml:mi><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi mathvariant="italic">gnomAD</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="13073_2023_1274_Article_IEq42.gif"/></alternatives></inline-formula> located on genes that appear in ClinVarTraining and defined it as an orthogonal validation set.</p>
    </sec>
    <sec id="Sec4">
      <title>MAGPIE framework</title>
      <p id="Par67">The machine learning component of MAGPIE is based on a gradient-boosting tree-based model of classifying pathogenic and benign variants, which includes three steps. First, we annotated candidate SNVs to obtain information needed for model training. Second, we used automated feature engineering to pull out meaningful features from the datasets, and then we designed a feature selection strategy to obtain the optimal combination of features to feed the model. Finally, we trained the model using the processed dataset with step-wise tuning to make the process controllable and avoid overfitting.</p>
      <p id="Par68">The whole framework in this paper was mainly implemented in Python (v3.7) [<xref ref-type="bibr" rid="CR24">24</xref>] and MATLAB [<xref ref-type="bibr" rid="CR25">25</xref>], and other models were built using the sklearn (v0.21.3) package [<xref ref-type="bibr" rid="CR26">26</xref>].</p>
    </sec>
    <sec id="Sec5">
      <title>Feature annotation</title>
      <p id="Par69">We annotated candidate SNVs with ANNOVAR (24 October 2019, latest version) [<xref ref-type="bibr" rid="CR27">27</xref>] and included predicted scores provided by SpliceAI [<xref ref-type="bibr" rid="CR19">19</xref>].</p>
      <p id="Par70">As for feature selection, we used ANNOVAR, SpliceAI, and the ChromHMM [<xref ref-type="bibr" rid="CR28">28</xref>] model to annotate candidate variants and ended up with 132 features. To narrow down the number of features, we applied several models on the ClinVar dataset with all these features and kept the models that satisfied over 95% accuracy on the validation set. Then, we calculated feature importance of all input features based on these models and filtered out features whose contribution to the models is less than <inline-formula id="IEq43"><alternatives><tex-math id="M85">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$1{e}^{-3}$$\end{document}</tex-math><mml:math id="M86"><mml:mrow><mml:mn>1</mml:mn><mml:msup><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math><inline-graphic xlink:href="13073_2023_1274_Article_IEq43.gif"/></alternatives></inline-formula>. The number of features was reduced to 60 and below. We will describe these features in detail (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S4-S5).</p>
      <p id="Par71">For further training, we included six different types of variant classifications, namely nonsynonymous SNV (missense), startloss, stopgain, stoploss, frameshift, and non-frameshift. For each type of variant, 60 features were retrieved from the annotated datasets, including six categories: (1) epigenomics, (2) functional effects, (3) splicing effects, (4) population-based features, (5) biochemical properties, and (6) conservation (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S4-S5). And in our model, we excluded all predicted scores from variant pathogenicity prediction tools to minimize the effects of prior bias.</p>
      <p id="Par72">Epigenomics of each variant was annotated by the 15-state ChromHMM model across nine different cell lines in order to capture the significant combinatorial interactions between different chromatin marks in their spatial context (chromatin states). Functional effects included the gene damage index (GDI), residual variation intolerance score (RVIS), gene intolerance scores based on the loss of function tool (LoFtool), variant types, and annotations from the OMIM database. We use variant types as features including missense, frameshift, nonframeshift, startloss, stopgain, and stoploss. We use the OMIM database to annotate the mutation inheritance pattern, which is categorized into five distinct types: autosomal recessive, autosomal dominant, X-linked recessive, X-linked dominant, and others. Epigenomics features, variant type features, and mutation inheritance pattern features are one-hot encoded and fed into the model for training.</p>
      <p id="Par73">SpliceAI annotated each variant with its predicted effect on splicing. The delta score of the variant represents the probability of the variant being splice-altering as acceptor gain (DS_AG), acceptor loss (DS_AL), donor gain (DS_DG), and donor loss (DS_DL). Furthermore, we also obtained information about the location where splicing changes relative to the variant position, which included the delta position of acceptor gain (DP_AG), acceptor loss (DP_AL), donor gain (DP_DG), and donor loss (DP_DL). SpliceAI does not annotate variants if they are close to chromosome ends or too long reference sequences. We use 0 to fill in missing values of SpliceAI prediction.</p>
      <p id="Par74">Population-based features represented the incidence of an allele in a population, including 12 different types of allele frequencies (AF). We retrieved AF in various populations: all exome, raw allele frequency (AF_raw), African (AF_afr), Latino/Admixed American (AF_amr), Ashkenazi Jewish (AF_asj), East Asian (AF_eas), Finnish in Finland (AF_fin), Non-Finnish European (AF_nfe), and other (AF_oth). Besides, allele frequencies in different genders were also obtained from annotated information.</p>
      <p id="Par75">Biochemical properties contain the effects of amino acid changes before and after mutations. We first checked whether the mutation causes an amino acid change, and if not, we assigned 0 to all relevant features. Amino acid change (AAchange) was used as the basis for subsequent annotation. We stored the physicochemical properties of each amino acid, including molecular weight, equipotential point, dissociation constant, hydrophilicity, polarity, acid–base, etc., in a matrix, in which the characteristics of Boolean type were represented by 1/0. We obtained the corresponding properties of the amino acids by querying the matrix and took the delta value between the properties before and after the mutation as the features of the mutation. We then employed different strategies for different types of variants since some variants cause multiple amino acid changes, which require specific handling. When a mutation affects more than one amino acid, we calculate the average value before and after the change, respectively, to ensure that the feature selection process is comprehensively representative. We also used the information obtained from the BLOSUM100 matrix as a feature to demonstrate the conservation and similarity of amino acid substitutions.</p>
      <p id="Par76">Conservation scores included phastCons 20way mammalian, 30way mammalian, 100way mammalian, 100way vertebrate; phyloP 20way mammalian, 30way mammalian, 100way vertebrate; and odds ratios of SiPhy 29way mammalian.</p>
      <p id="Par77">We use the Bayesian PCA-based missing value estimation method by Oba et al. [<xref ref-type="bibr" rid="CR29">29</xref>] to impute missing values for several features in preparing the next steps, and any outliers that may arise from extensive imputation are carefully removed from our analysis.</p>
    </sec>
    <sec id="Sec6">
      <title>Feature engineering and selection</title>
      <p id="Par78">We applied automated feature engineering on our training dataset to generate tens of thousands of candidate features to capture potential non-linear and more complex relationships within the data.</p>
      <p id="Par79">We first generate new features based on mathematical transformations of the existing numerical features. AutoFE (automatically feature engineering) applied operations such as logarithms, square roots, and exponentials to the original features. Next, we created new categorical features by grouping the original features based on their values. For example, we grouped conservation scores into categories by binning. These categorical features could capture relationships that might not be easily captured by the original numerical ones. We use the openFE [<xref ref-type="bibr" rid="CR30">30</xref>] package to perform autoFE.</p>
      <p id="Par80">After generating these new features, we used the default method defined in openFE to perform feature selection to remove any redundant or irrelevant features. OpenFE evaluated the importance of each feature and removed those that did not contribute significantly to the model’s predictive power. Even though the dataset still contains over 3000 features for each variant, which could lead to over-fitting. So, we stepped further based on openFE to perform separated feature selection (SFS).</p>
      <p id="Par81">In our study, we segregated all features into two categories, namely a core set and an add-on set. The former included features related to pathogenicity with validated evidence, such as population-based features, conservation, and functional effects. These features were retained during the training phase. The latter comprised additional features, including biochemical properties, splicing effects, epigenomics, and automated feature-engineered features. We then employed a feature selection process to determine the most important ones for feeding our model. We initially trained a simplified tree-based model for less than 50 rounds to reduce the features to 200 or less. Subsequently, after each round, we evaluated the importance of each feature and discarded those with relative importance scores lower than <inline-formula id="IEq44"><alternatives><tex-math id="M87">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$1{e}^{-3}$$\end{document}</tex-math><mml:math id="M88"><mml:mrow><mml:mn>1</mml:mn><mml:msup><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math><inline-graphic xlink:href="13073_2023_1274_Article_IEq44.gif"/></alternatives></inline-formula>.</p>
      <p id="Par82">After analysis, we observed that the core features exhibited prominent significance compared to the entire set of features. To further enhance the performance of our model, we conducted training using feature combinations, as described in Algorithm 2, to attain the optimal amalgamation of features that would yield superior performance on the test set.<fig position="anchor" id="Figb"><caption><p><bold>Algorithm 2.</bold> Separated feature selection</p></caption><graphic position="anchor" xlink:href="13073_2023_1274_Figb_HTML" id="MO2"/></fig></p>
    </sec>
    <sec id="Sec7">
      <title>Model training</title>
      <p id="Par83">MAGPIE was based on a LightGBM (LGBM) model for predicting pathogenicity. LightGBM has a faster training speed and lower memory consumption than other tree-based models. To better learn from data and avoid over-fitting problems, especially as a tree-based model, we defined five rounds to train the model with 5-fold cross-validation in each round.</p>
      <p id="Par84">We first set the initialization parameters of the model, where boosting type is set to gbdt, and the learning rate was set to 0.1. The purpose of the first round was to improve the accuracy, so in this round, we mainly searched for the depth of trees (3–8) and the maximum number of leaf nodes per tree (5–100). Meanwhile, we set early-stopping to 50 to minimize the magnitude of overfitting. The next four rounds of tuning were to make a trade-off between reducing the overfitting and ensuring accuracy after the first round of tuning. In the second round, we adjusted <italic>max_bin</italic>, the number of segments in the histogram algorithm, to discretize the eigenvalues. The value of <italic>min_data_in_leaf</italic> depended on the number of sample trees and <italic>num_leaves</italic> in the training data. Setting it larger can avoid generating a too-deep tree. The third round of adjusting the focus on <italic>feature_fraction</italic> and <italic>bagging_fraction</italic> was to specify a certain percentage of samples from all data for training, which can reduce the variance at the cost of increasing the bias. So, in this step, we tried to reduce the sampling proportion as much as possible while ensuring accuracy. In the fourth round of adjustment, <italic>lambda_l1</italic> and <italic>lambda_l2</italic> were tuned, representing the L1 and L2 regularization terms, respectively, which were used to filter the features and control their influence in the model to prevent some features from greatly affecting the whole model. Finally, we adjusted <italic>min_split_gain</italic>, which means that node splitting will only be performed when the gain is more significant than our given threshold, which will greatly limit the growth of trees. Upon completing the training process, we observed no substantial decrease in accuracy and classification performance measures. This outcome indicates the generalization ability of the model extends far beyond the boundaries of the training dataset, thereby mitigating the issue of learning bias commonly associated within datasets.</p>
    </sec>
    <sec id="Sec8">
      <title>Evaluate and compare models by multiple metrics</title>
      <p id="Par85">To quantitatively evaluate model performance, we compared MAGPIE with 14 other predicted tools including ClinPred [<xref ref-type="bibr" rid="CR31">31</xref>], REVEL [<xref ref-type="bibr" rid="CR17">17</xref>], MetaSVM [<xref ref-type="bibr" rid="CR13">13</xref>], MetaLR [<xref ref-type="bibr" rid="CR13">13</xref>], VEST4 [<xref ref-type="bibr" rid="CR14">14</xref>], M-CAP [<xref ref-type="bibr" rid="CR32">32</xref>], MutationAssessor [<xref ref-type="bibr" rid="CR11">11</xref>], PrimateAI [<xref ref-type="bibr" rid="CR33">33</xref>], SIFT4G [<xref ref-type="bibr" rid="CR34">34</xref>], LIST-S2 [<xref ref-type="bibr" rid="CR35">35</xref>], DANN [<xref ref-type="bibr" rid="CR21">21</xref>], MutationTaster [<xref ref-type="bibr" rid="CR36">36</xref>], VARITY [<xref ref-type="bibr" rid="CR16">16</xref>], and MutPred [<xref ref-type="bibr" rid="CR22">22</xref>]. SIFT4G score less than 0.05 is putatively pathogenic according to the authors’ recommendation. For other tools that predict continuous values or probabilities of pathogenicity, we utilized the threshold recommended by the authors in the corresponding article to distinguish between the pathogenic and benign variants. 0.025 is used for M-CAP, 0.8 for Mutation Assessor and PrimateAI, 0.85 for LIST-S2, 0.3 for MutationTaster, 0.79 for MutPred, and 0.5 as the threshold for other prediction tools. Variants with scores greater than or equal to the threshold in the prediction results of each tool possessed to be pathogenic, and those less than the threshold were benign.</p>
      <p id="Par86">Due to the different distribution of pathogenic and benign mutations in both the balanced test set and the imbalanced orthogonal set, we used several different metrics to assess the predictive performance of the model, including accuracy, precision, recall, specificity, F1-score, G-mean, Matthew’s correlation coefficient (MCC). Compared with accuracy and F1-score, MCC, which considers all components in the confusion matrices, can be used even if datasets are very imbalanced. We illustrated curves and computed the area under the receiver operating characteristic (ROC) curve (AUC).<disp-formula id="Equa"><alternatives><tex-math id="M89">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\text{accuracy}}=\frac{TP+TN}{TP+FP+TN+FN}$$\end{document}</tex-math><mml:math id="M90" display="block"><mml:mrow><mml:mtext>accuracy</mml:mtext><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi>T</mml:mi><mml:mi>P</mml:mi><mml:mo>+</mml:mo><mml:mi>T</mml:mi><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mi>T</mml:mi><mml:mi>P</mml:mi><mml:mo>+</mml:mo><mml:mi>F</mml:mi><mml:mi>P</mml:mi><mml:mo>+</mml:mo><mml:mi>T</mml:mi><mml:mi>N</mml:mi><mml:mo>+</mml:mo><mml:mi>F</mml:mi><mml:mi>N</mml:mi></mml:mrow></mml:mfrac></mml:mrow></mml:math><graphic xlink:href="13073_2023_1274_Article_Equa.gif" position="anchor"/></alternatives></disp-formula><disp-formula id="Equb"><alternatives><tex-math id="M91">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\text{precision}}=\frac{TP}{TP+FP}$$\end{document}</tex-math><mml:math id="M92" display="block"><mml:mrow><mml:mtext>precision</mml:mtext><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi mathvariant="italic">TP</mml:mi></mml:mrow><mml:mrow><mml:mi>T</mml:mi><mml:mi>P</mml:mi><mml:mo>+</mml:mo><mml:mi>F</mml:mi><mml:mi>P</mml:mi></mml:mrow></mml:mfrac></mml:mrow></mml:math><graphic xlink:href="13073_2023_1274_Article_Equb.gif" position="anchor"/></alternatives></disp-formula><disp-formula id="Equc"><alternatives><tex-math id="M93">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\text{recall}}=\frac{TP}{TP+FN}$$\end{document}</tex-math><mml:math id="M94" display="block"><mml:mrow><mml:mtext>recall</mml:mtext><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi mathvariant="italic">TP</mml:mi></mml:mrow><mml:mrow><mml:mi>T</mml:mi><mml:mi>P</mml:mi><mml:mo>+</mml:mo><mml:mi>F</mml:mi><mml:mi>N</mml:mi></mml:mrow></mml:mfrac></mml:mrow></mml:math><graphic xlink:href="13073_2023_1274_Article_Equc.gif" position="anchor"/></alternatives></disp-formula><disp-formula id="Equd"><alternatives><tex-math id="M95">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\text{specificity}}=\frac{TN}{TN+FP}$$\end{document}</tex-math><mml:math id="M96" display="block"><mml:mrow><mml:mtext>specificity</mml:mtext><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi mathvariant="italic">TN</mml:mi></mml:mrow><mml:mrow><mml:mi>T</mml:mi><mml:mi>N</mml:mi><mml:mo>+</mml:mo><mml:mi>F</mml:mi><mml:mi>P</mml:mi></mml:mrow></mml:mfrac></mml:mrow></mml:math><graphic xlink:href="13073_2023_1274_Article_Equd.gif" position="anchor"/></alternatives></disp-formula><disp-formula id="Eque"><alternatives><tex-math id="M97">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\text{Fbeta}}-{\text{score}}=\frac{(1+{{\text{beta}}}^{2})({\text{recall}}\times {\text{precision}})}{{\text{recall}}+{\text{precision}}\times {{\text{beta}}}^{2}}$$\end{document}</tex-math><mml:math id="M98" display="block"><mml:mrow><mml:mtext>Fbeta</mml:mtext><mml:mo>-</mml:mo><mml:mtext>score</mml:mtext><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:msup><mml:mrow><mml:mtext>beta</mml:mtext></mml:mrow><mml:mn>2</mml:mn></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mtext>recall</mml:mtext><mml:mo>×</mml:mo><mml:mtext>precision</mml:mtext><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mtext>recall</mml:mtext><mml:mo>+</mml:mo><mml:mtext>precision</mml:mtext><mml:mo>×</mml:mo><mml:msup><mml:mrow><mml:mtext>beta</mml:mtext></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mfrac></mml:mrow></mml:math><graphic xlink:href="13073_2023_1274_Article_Eque.gif" position="anchor"/></alternatives></disp-formula><disp-formula id="Equf"><alternatives><tex-math id="M99">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$g-{\text{mean}}=\sqrt{{\text{recall}}\times {\text{specificity}}}$$\end{document}</tex-math><mml:math id="M100" display="block"><mml:mrow><mml:mi>g</mml:mi><mml:mo>-</mml:mo><mml:mtext>mean</mml:mtext><mml:mo>=</mml:mo><mml:msqrt><mml:mrow><mml:mtext>recall</mml:mtext><mml:mo>×</mml:mo><mml:mtext>specificity</mml:mtext></mml:mrow></mml:msqrt></mml:mrow></mml:math><graphic xlink:href="13073_2023_1274_Article_Equf.gif" position="anchor"/></alternatives></disp-formula><disp-formula id="Equg"><alternatives><tex-math id="M101">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$mcc=\frac{TP\times TN-FP\times FN}{\sqrt{(TP+FP)(TP+FN)(TN+FP)(TN+FN)}}$$\end{document}</tex-math><mml:math id="M102" display="block"><mml:mrow><mml:mi>m</mml:mi><mml:mi>c</mml:mi><mml:mi>c</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi>T</mml:mi><mml:mi>P</mml:mi><mml:mo>×</mml:mo><mml:mi>T</mml:mi><mml:mi>N</mml:mi><mml:mo>-</mml:mo><mml:mi>F</mml:mi><mml:mi>P</mml:mi><mml:mo>×</mml:mo><mml:mi>F</mml:mi><mml:mi>N</mml:mi></mml:mrow><mml:msqrt><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>T</mml:mi><mml:mi>P</mml:mi><mml:mo>+</mml:mo><mml:mi>F</mml:mi><mml:mi>P</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>T</mml:mi><mml:mi>P</mml:mi><mml:mo>+</mml:mo><mml:mi>F</mml:mi><mml:mi>N</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>T</mml:mi><mml:mi>N</mml:mi><mml:mo>+</mml:mo><mml:mi>F</mml:mi><mml:mi>P</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>T</mml:mi><mml:mi>N</mml:mi><mml:mo>+</mml:mo><mml:mi>F</mml:mi><mml:mi>N</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msqrt></mml:mfrac></mml:mrow></mml:math><graphic xlink:href="13073_2023_1274_Article_Equg.gif" position="anchor"/></alternatives></disp-formula><disp-formula id="Equh"><alternatives><tex-math id="M103">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\text{AUC}}=\frac{{\sum }_{i=1}^{n}{\text{Ran}}{k}_{i}-\frac{n\left(n+1\right)}{2}}{{n}_{{\text{positive}}}\times {n}_{{\text{negative}}}}$$\end{document}</tex-math><mml:math id="M104" display="block"><mml:mrow><mml:mtext>AUC</mml:mtext><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>n</mml:mi></mml:msubsup><mml:mtext>Ran</mml:mtext><mml:msub><mml:mi>k</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>-</mml:mo><mml:mfrac><mml:mrow><mml:mi>n</mml:mi><mml:mfenced close=")" open="("><mml:mi>n</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mfenced></mml:mrow><mml:mn>2</mml:mn></mml:mfrac></mml:mrow><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mtext>positive</mml:mtext></mml:msub><mml:mo>×</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mtext>negative</mml:mtext></mml:msub></mml:mrow></mml:mfrac></mml:mrow></mml:math><graphic xlink:href="13073_2023_1274_Article_Equh.gif" position="anchor"/></alternatives></disp-formula></p>
      <p id="Par87">Here, <inline-formula id="IEq45"><alternatives><tex-math id="M105">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$n$$\end{document}</tex-math><mml:math id="M106"><mml:mi>n</mml:mi></mml:math><inline-graphic xlink:href="13073_2023_1274_Article_IEq45.gif"/></alternatives></inline-formula> is the total number of samples, <inline-formula id="IEq46"><alternatives><tex-math id="M107">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${n}_{positive}$$\end{document}</tex-math><mml:math id="M108"><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi mathvariant="italic">positive</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13073_2023_1274_Article_IEq46.gif"/></alternatives></inline-formula> is the number of positive samples, <inline-formula id="IEq47"><alternatives><tex-math id="M109">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${n}_{negative}$$\end{document}</tex-math><mml:math id="M110"><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi mathvariant="italic">negative</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13073_2023_1274_Article_IEq47.gif"/></alternatives></inline-formula> is the number of negative samples, and <inline-formula id="IEq48"><alternatives><tex-math id="M111">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$Ran{k}_{i}$$\end{document}</tex-math><mml:math id="M112"><mml:mrow><mml:mi>R</mml:mi><mml:mi>a</mml:mi><mml:mi>n</mml:mi><mml:msub><mml:mi>k</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="13073_2023_1274_Article_IEq48.gif"/></alternatives></inline-formula> is the rank of the <inline-formula id="IEq49"><alternatives><tex-math id="M113">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$i$$\end{document}</tex-math><mml:math id="M114"><mml:mi>i</mml:mi></mml:math><inline-graphic xlink:href="13073_2023_1274_Article_IEq49.gif"/></alternatives></inline-formula>-th sample’s predicted value among all samples. For samples with the same predicted value, their ranks are averaged.</p>
      <p id="Par88">Most models are designed to handle specific variant types or rely heavily on crucial information such as protein structure predictions. As a result, if a variant falls outside the model’s scope or crucial information is unavailable, the pathogenicity prediction becomes challenging. To assess the performance of these prediction tools, we excluded variants without available results for each tool and generated a confusion matrix using the true labels to derive relevant metrics. In addition, we also compared the performance of these tools on unpredictable variants by classifying the variants without predicted results as benign.</p>
    </sec>
    <sec id="Sec9">
      <title>Feature importance</title>
      <p id="Par89">The utilization of autoFE has facilitated the incorporation of numerous novel features, which are the culmination of distinct amalgamations of two distinct features or the distribution of one specific feature. In the case of the original features, the importance is derived from LightGBM. As for the combined features, which were hard to interpret in biology, we employ an average importance metric based on the number of contributing features, which is subsequently added to the original features. Ultimately, we determine the importance of each original feature, followed by the comparison and analysis.</p>
    </sec>
    <sec id="Sec10">
      <title>Website</title>
      <p id="Par90">The accompanying web services of MAGPIE have been developed as shown in Additional file <xref rid="MOESM2" ref-type="media">2</xref>: Fig. S1. The tool provides online search functionality for pathogenicity scores by entering information on possible single-nucleotide variants (SNVs). Additionally, users can register and request analysis for non-SNV mutations. The development of MAGPIE was initiated to enhance the precision and convenience of mutation pathogenicity prediction, providing comprehensive support to researchers and clinicians within the biomedical field.</p>
      <p id="Par91">Users of the MAGPIE tool can input mutation information in the chr:start–end-ref-alt format via the website to obtain pathogenicity scores. For bulk variant prediction, users can submit tasks by uploading a csv file. A task ID will be generated upon successful submission, enabling users to obtain pathogenicity annotations from the download page once the prediction process is complete. The tool aims to contribute to advancing research and treatment in this area.</p>
    </sec>
  </sec>
  <sec id="Sec11">
    <title>Results</title>
    <sec id="Sec12">
      <title>MAGPIE overview</title>
      <p id="Par92">MAGPIE is a computational method to predict the pathogenicity of multiple variant types using a gradient-boosting machine learning framework (Fig. <xref rid="Fig1" ref-type="fig">1</xref>). To prepare data used for modeling, we collected all mutations with a pathogenic interpretation in the ClinVar database and selected mutations labeled as pathogenic (including likely pathogenic) and benign (including likely benign). We then randomly selected 90% of the dataset to use as training data, rendering a total of 39,893 pathogenic and 38,125 benign variants to feed into the model.<fig id="Fig1"><label>Fig. 1</label><caption><p>Framework of MAGPIE. The model was trained to predict pathogenic scores of multi-type variants and included three steps. First, candidate variants were annotated with high-dimensional features covering six different modalities. Second, automatic feature engineering and separated feature selection were undertaken step by step. Finally, a gradient boosting method with controllable tuning was implemented to train the model and obtain predictions for the pathogenicity of variants</p></caption><graphic xlink:href="13073_2023_1274_Fig1_HTML" id="MO3"/></fig></p>
      <p id="Par93">The MAGPIE framework is composed of 3 steps (Fig. <xref rid="Fig1" ref-type="fig">1</xref>). First, for a given variant, MAGPIE annotates the variant with high dimensional features covering six different modalities, including epigenomics, functional effects, splicing effects, population-based features, biochemical properties, and conservation. In the second step, we use automatic feature engineering followed by feature selection to create candidate features based on the training dataset. Automatic feature engineering aims to create multiple new combinations of features based on input features automatically to capture as much information as possible. After that, feature selection is used to pull out meaningful features. Lastly, using 5-fold cross-validation and step-wise parameter tuning, we trained an interpretable gradient-boosting model (GBM) based on ensemble trees [<xref ref-type="bibr" rid="CR37">37</xref>] and predicted the probability of pathogenicity in candidate variants. The gradient-boosting model, namely LightGBM, uses algorithms like gradient-based one-side sampling (GOSS) and exclusive feature bundling (EFB) to accelerate the training process while assuring accuracy. The output of MAGPIE is a score of pathogenicity defined over the interval between 0 and 1, in which 0 refers to benign variants and 1 represents the most pathogenic. To understand how MAGPIE achieves satisfying performance with multiple modalities, we performed an ablation study to investigate the effects of the training dataset, feature selection, and LightGBM on MAGPIE. Moreover, the ablation study indicated that the MAGPIE integrating a series of modules achieved the best performance improvement in pathogenic prediction (Additional file <xref rid="MOESM2" ref-type="media">2</xref>: Fig. S2). A more detailed description of the MAGPIE framework is included in the “<xref rid="Sec3" ref-type="sec">Methods</xref>” section. Additionally, we made MAGPIE available through an online website to facilitate access and use of the tool at <ext-link ext-link-type="uri" xlink:href="http://tools.shenlab-genomics.org/tools/MAGPIE">http://tools.shenlab-genomics.org/tools/MAGPIE</ext-link> (Additional file <xref rid="MOESM2" ref-type="media">2</xref>: Fig. S1).</p>
    </sec>
    <sec id="Sec13">
      <title>MAGPIE is interpretable</title>
      <p id="Par94">The application of the gradient boosting approach makes MAGPIE an interpretable machine-learning model. To better understand the learned representation, we calculated the importance of different feature modalities and presented them in a network view (Fig. <xref rid="Fig2" ref-type="fig">2</xref>B). The feature importance in MAGPIE indicates the degree to which each feature contributes to the model and reflects their information gains. During the classification process, MAGPIE ensembled six modalities of features. Among them, the most important feature group is the functional effect, which includes measures such as the loss of function score (LoF_score), human gene damage index (GDI), and so on (Fig. <xref rid="Fig2" ref-type="fig">2</xref>A, B, Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S4-S5). Loss-of-function mutations have a greater likelihood of causing disease [<xref ref-type="bibr" rid="CR38">38</xref>]. As previous studies have shown, we found that pathogenic variants predicted by MAGPIE have significantly lower LoF scores than benign variants (Additional file <xref rid="MOESM2" ref-type="media">2</xref>: Fig. S3A). GDI is the accumulated mutational damage of each protein-coding human gene, and variants in highly damaged genes are less likely to be disease-causing. We observed a high weight assigned to the GDI feature, indicating that genes with a lower GDI tended to have higher MAGPIE prediction scores and were more likely to be pathogenic (Additional file <xref rid="MOESM2" ref-type="media">2</xref>: Fig. S3B), consistent with previously published studies [<xref ref-type="bibr" rid="CR26">26</xref>]. The second most important feature modality is population-based, which is correlated inversely to the pathogenicity in test datasets. The third most significant feature modality is conservation, which has been considered in many previous methods such as CADD, SIFT [<xref ref-type="bibr" rid="CR7">7</xref>], PolyPhen [<xref ref-type="bibr" rid="CR8">8</xref>], and VARITY [<xref ref-type="bibr" rid="CR16">16</xref>]. The importance of conservation is expected and indicates the validity of MAGPIE’s learned representations. Additionally, we observed that features within each modality are correlated, while features from different modality groups are more likely to be independent (Fig. <xref rid="Fig2" ref-type="fig">2</xref>A). This suggests that MAGPIE is capable of learning multiple-dimensional information from different feature classes. In other words, the learned representations were discriminative to help MAGPIE for classification.<fig id="Fig2"><label>Fig. 2</label><caption><p>Feature importance and correlation. <bold>A</bold> Correlation between features used to train MAGPIE. <bold>B</bold> A captivating hierarchical relationship diagram is presented, displaying the intricate relationship between features and the categories they belong to. Each dot in the outermost layer represents a distinct feature, while the size of the dots indicates their importance. The second layer depicts feature categories, with the size reflecting the sum of importance of the subordinate features. <bold>C</bold> The bar plot illustrates feature importance, which shows the contribution of each feature after feature selection. Part of the add-on features is automatically removed during the training process</p></caption><graphic xlink:href="13073_2023_1274_Fig2_HTML" id="MO4"/></fig></p>
    </sec>
    <sec id="Sec14">
      <title>MAGPIE outperforms existing methods across multiple conditions</title>
      <p id="Par95">We evaluated the performance of MAGPIE together with 14 previously published pathogenicity prediction methods including MutationAssessor, MetaSVM, MetaLR, VARITY, VEST4, REVEL, MutPred, DANN, ClinPred, PrimateAI, LIST-S2, M-CAP, MutationTaster, and SIFT4G [<xref ref-type="bibr" rid="CR11">11</xref>, <xref ref-type="bibr" rid="CR13">13</xref>, <xref ref-type="bibr" rid="CR14">14</xref>, <xref ref-type="bibr" rid="CR16">16</xref>, <xref ref-type="bibr" rid="CR17">17</xref>, <xref ref-type="bibr" rid="CR21">21</xref>, <xref ref-type="bibr" rid="CR22">22</xref>, <xref ref-type="bibr" rid="CR31">31</xref>–<xref ref-type="bibr" rid="CR36">36</xref>]. For benchmark purposes, we applied MAGPIE on the ClinVar training dataset as described in methods, and its independent split dataset, labeled as ClinVarTest hereafter, was used for evaluating all models, including MAGPIE performances (Fig. <xref rid="Fig3" ref-type="fig">3</xref>A). The ClinVarTest dataset contains 4356 pathogenic and 4310 benign mutations. Since we split datasets based on gene symbols, these variants and their corresponding gene-level features were not seen by the models in the training dataset (Fig. <xref rid="Fig3" ref-type="fig">3</xref>A, Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S1). To fairly compare MAGPIE with other methods, pathogenicity classifications were set according to the thresholds recommended by the authors. Nevertheless, MAGPIE outperformed all other classifiers on the benchmark with the highest AUC score of 0.995 and AUPRC of 0.995 (Fig. <xref rid="Fig3" ref-type="fig">3</xref>B, C, Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S6-S8). In comparison, other methods, i.e., MutationTaster, DANN, LIST-S2, SIFT4G, PrimateAI, M-CAP, and MutationAssessor achieved AUC from 0.61 to 0.91. The performance evaluation suggested that MAGPIE is a reliable tool for pathogenic prediction.<fig id="Fig3"><label>Fig. 3</label><caption><p>MAGPIE makes accurate predictions. <bold>A</bold> The pie chart showed the proportion of pathogenic and benign variants in the independent test set, and the bar plot illustrated the percentages of multi-type variants in the dataset. <bold>B</bold> The receiver operating characteristic curve of MAGPIE and 14 other predicted tools in the independent test set. The area under the curve (AUC) scores were shown in the bar plot. <bold>C</bold> Precision-recall curve of MAGPIE and 14 other predicted tools in the ClinVarTest dataset were illustrated. <bold>D</bold> Missing rate comparison of MAGPIE and 14 other predicted tools in the independent test set. The higher missing rate represented that the prediction tools cannot predict pathogenic scores on the larger number of candidate variants. <bold>E</bold> AUC comparison of MAGPIE and 14 other predicted tools in the ClinVarRare, which only included variants with AF &lt; 0.01. <bold>F</bold> AUBPRC comparison of MAGPIE and 14 other predicted tools in the ClinVarRare which only included variants with AF &lt; 0.01. <bold>G</bold> Percentages of predictable variants across different variant types in various tools. <bold>H</bold> Violin plots illustrated distributions of pathogenic scores. And bar plots showed the precisions in each category of pathogenic variants and benign variants</p></caption><graphic xlink:href="13073_2023_1274_Fig3_HTML" id="MO5"/></fig></p>
      <p id="Par96">Of note, existing pathogenic prediction tools mostly predicted a limited number of mutations, which indicated a lack of generalization of previous methods. For example, for published classifiers, i.e., ClinPred, REVEL, MetaSVM, MetaLR, MutationAssessor, PrimateAI, SIFT4G, LIST-S2, and M-CAP, 30–60% of candidate mutations were unpredictable by these methods (Fig. <xref rid="Fig3" ref-type="fig">3</xref>D), which leads to 30–60% of variants’ output as missing. These missing values were generated due to variant types not being predictable by specific prediction tools. In contrast, MAGPIE succeeded in predicting the pathogenicity of all variants in the dataset, fulfilling 3–60% of missing values predicted by other methods (Fig. <xref rid="Fig3" ref-type="fig">3</xref>C). In other words, for all the exonic variants assessed covering various mutation types other than synonymous mutation, the missing rate of MAGPIE is zero. In summary, MAGPIE outperformed all previously published machine learning methods as well as the state-of-the-art deep learning methods on this benchmark.</p>
      <p id="Par97">Finally, we constructed a rare mutation test set (ClinVarRare) to evaluate the ability of MAGPIE to identify pathogenic variants from rare benign variants, which is one of the major challenges in real-world analysis for genetic diagnosis of disease. The ClinVarRare test set included rare pathogenic ClinVar variants (AF &lt; 0.01) and rare benign variants from gnomAD (AF &lt; 0.01), which is more similar to the real whole-exome sequencing datasets. For the rare mutation test set, MAGPIE achieved the best performance with an AUC equal to 0.992, followed by REVEL, ClinPred, and MutPred. Previous computational tools predicted a proportion of variants within the whole dataset, and the rest of the variants were unpredictable because these tools were designed to classify specific types of variants. Consequently, we examined that MAGPIE predicted all 4881 variants in the ClinVarRare test set with the highest accuracy of 0.95 (Fig. <xref rid="Fig3" ref-type="fig">3</xref>E). In summary, MAGPIE outperforms all previously published machine learning methods and the state-of-the-art deep learning methods on both the ClinVarTest dataset and the ClinVarRare test dataset.</p>
    </sec>
    <sec id="Sec15">
      <title>MAGPIE achieves high performance in multiple mutation types</title>
      <p id="Par98">An important characteristic of MAGPIE is the ability to make pathogenic predictions on multiple types of mutations. The ClinVarTest dataset contains a total of 6 types of mutations: missense variants (or nonsynonymous SNV), stop-gain variants, start-loss variants, frameshift mutations, nonframeshift mutations, and stop-loss variants. MAGPIE was predictive of clinical significance for all labeled variants across various mutation types, while many available methods only applied to certain mutation types (Fig. <xref rid="Fig3" ref-type="fig">3</xref>G). Besides, the performance of our methods was robust to different variant types, suggesting the generalizability of our method (Fig. <xref rid="Fig3" ref-type="fig">3</xref>H).</p>
      <p id="Par99">We further analyzed the distribution of pathogenic scores across mutation types to evaluate the classification capability of MAGPIE. To visualize the distribution of MAGPIE-predicted pathogenic probability, we plotted the MAGPIE score distributions for different types of pathogenic and benign variants (Fig. <xref rid="Fig3" ref-type="fig">3</xref>H). For pathogenic variants, MAGPIE scores were highly concentrated around 1, and for benign variants, scores were near 0 across six types of variants. This suggested that our model can separate pathogenic and benign variants well. We further analyzed the ability of classification quantitatively and evaluated how accurately our model can predict pathogenicity. The average precision of all types of variants was 0.98, suggesting that 98% of predicted pathogenic variants were consistent with their true labels. And the average false predictive value was 0.8, meaning 80% of predicted benign mutations were true negatives. In particular, MAGPIE identified pathogenic and benign variants successfully in the imbalanced datasets of stop-loss and stop-gain mutations. As shown in Fig. <xref rid="Fig3" ref-type="fig">3</xref>G, MAGPIE detected pathogenic mutations in stop-loss and stop-gain mutations and minimized false positives (average precision of 1.0). Therefore, MAGPIE can accurately differentiate pathogenic and benign mutations across various mutation types.</p>
    </sec>
    <sec id="Sec16">
      <title>MAGPIE achieves the best performance on additional orthogonal datasets</title>
      <p id="Par100">We used the annotated variants from the SwissProt database as an orthogonal dataset to further benchmark MAGPIE against other methods. SwissProt contains 80,840 labeled variants, with 71,400 explicitly labeled as pathogenic or benign. Only variants with unique reference SNP ID mapping, in the exonic region, excluding synonymous SNVs, were retained. To ensure the independence of the orthogonal dataset, we further removed variants located on genes reported in the ClinVarTrain dataset. We also made the orthogonal dataset closer to the real scenario and evaluate the performance of MAGPIE in the imbalanced dataset with less than 10% positive samples. After filtering, the number of pathogenic and benign mutations became highly imbalanced. The number of benign variants was 12,075, while the number of pathogenic ones was only 1308, about 9.8% of the total number of variants to be tested (Fig. <xref rid="Fig4" ref-type="fig">4</xref>A, Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S2). We also conducted an ablation study in this imbalanced orthogonal dataset and found that the full model was much superior to other model variations of MAGPIE (Additional file <xref rid="MOESM2" ref-type="media">2</xref>: Fig. S2).<fig id="Fig4"><label>Fig. 4</label><caption><p>MAGPIE outperforms other models in orthogonal validation set and ACMG-guided dataset. <bold>A</bold> The pie chart showed the proportion of pathogenic and benign variants in the orthogonal validation set and the bar plot illustrated the percentages of multi-type variants in the dataset. <bold>B</bold> The receiver operating characteristic curve of MAGPIE and 14 other predicted tools in the orthogonal validation set. <bold>C</bold> The precision-recall curve of MAGPIE and 14 other predicted tools in the orthogonal validation set were illustrated. <bold>D</bold> Missing rate comparison of MAGPIE and 14 other predicted tools in the orthogonal validation set. The higher missing rate represented that the prediction tools cannot predict pathogenic scores on the larger number of candidate variants. <bold>E</bold> AUC comparison of MAGPIE and 14 other predicted tools in the SwissProtRare which only included variants with AF &lt; 0.01. <bold>F</bold> AUBPRC comparison of MAGPIE and 14 other predicted tools in the SwissProtRare which only included variants with AF &lt; 0.01. <bold>G</bold> The pie chart showed the proportion of pathogenic and benign variants in the ACMG-guided dataset, and the bar plot illustrated the percentages of multi-type variants in the dataset. <bold>H</bold> Performance comparison of MAGPIE and 14 other predicted tools in the ACMG-guided dataset. <bold>I</bold> The precision-recall curve of MAGPIE and 14 other predicted tools in the ACMG-guided dataset were illustrated</p></caption><graphic xlink:href="13073_2023_1274_Fig4_HTML" id="MO6"/></fig></p>
      <p id="Par101">Again, the performance of MAGPIE was superior to other machine learning and deep learning methods on this benchmark. MAGPIE outcompeted other tools with the best AUC of 0.97 and AUPRC of 0.88 (Fig. <xref rid="Fig4" ref-type="fig">4</xref>B, Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S6-S8). Furthermore, MAGPIE computed the pathogenic probability for all filtered variants without missing values (Fig. <xref rid="Fig4" ref-type="fig">4</xref>C), whereas VEST4, DANN, MutationTaster, and MetaSVM were the closest competitor with about 5% missing rate (Fig. <xref rid="Fig4" ref-type="fig">4</xref>C, Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S6-S8). As for M-CAP and MutPred, more than 40% variants were unpredictable. Hence, on this benchmark, MAGPIE was better than other methods in predicting novel pathogenic mutations.</p>
      <p id="Par102">To evaluate the performance of MAGPIE in the imbalanced test dataset with rare variants, we constructed a rare SwissProt test set (SwissProtRare) where all variants had AF less than 0.01. The dataset included 9% of rare pathogenic SwissProt variants and 91% of rare benign variants from gnomAD, an extreme case of an imbalanced rare variant dataset. MAGPIE outperformed all competitors with an AUC equal to 0.95, followed by REVEL (AUC = 0.92) and MutPred (AUC = 0.91) (Fig. <xref rid="Fig4" ref-type="fig">4</xref>E). In general, MAGPIE outperformed other competitors.</p>
      <p id="Par103">Three types of variants were included in the SwissProt dataset, and MAGPIE was able to differentiate well between pathogenic and benign variants across all variant types in the orthogonal dataset as well (Additional file <xref rid="MOESM2" ref-type="media">2</xref>: Fig. S4A). Additionally, we found that MAGPIE scores of pathogenic variants were concentrated close to 1. In contrast, the probabilities of benign variants were near 0, which will further support the reliability of our method (Additional file <xref rid="MOESM2" ref-type="media">2</xref>: Fig. S4B). Precision of pathogenic variants was higher than 0.85, suggesting that MAGPIE achieved accurate pathogenic variants prediction (Additional file <xref rid="MOESM2" ref-type="media">2</xref>: Fig. S4B). Consistent with the results in the ClinVarTest dataset, for start-loss and stop-gain variants, MAGPIE achieved higher precision than the precision of nonsynonymous SNVs (precisions of 0.95 and 1, respectively) (Additional file <xref rid="MOESM2" ref-type="media">2</xref>: Fig. S4B). The false predictive values of stop-loss and stop-gain variants were slightly lower than the false predictive values of nonsynonymous SNVs and start-loss variants. However, the average false predictive value achieved 0.8 (Additional file <xref rid="MOESM2" ref-type="media">2</xref>: Fig. S4B). Thus, MAGPIE could successfully predict new pathogenic variants among different variant types.</p>
      <p id="Par104">Furthermore, we assessed the performance of MAGPIE and other models on an additional validation set from ACMG test panel. We obtained the ACMG guided test panel (2023.05.22), which includes a total of 1270 mutations, from the official website. After filtering, a final dataset of 491 mutations was used to compare MAGPIE and other model performances. In contrast to the SwissProt dataset, in the imbalanced ACMG dataset, there were 82% of pathogenic variants and 18% of benign variants. Again, MAGPIE achieved the highest AUC and AUPRC among all methods (Additional file <xref rid="MOESM2" ref-type="media">2</xref>: Fig. S5-S6, Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S6-S8), illustrating that MAGPIE could classify pathogenic and benign in imbalanced datasets.</p>
    </sec>
    <sec id="Sec17">
      <title>Assessing MAGPIE performance with varying threshold</title>
      <p id="Par105">Different thresholds may affect the model performance, especially in imbalanced data. In the real-world clinical applications of pathogenic prediction tools to interpret VUS in individual patients, only a few pathogenic mutations should be identified out of tens of thousands of candidate variants called from WES data. Thus, the pathogenic prediction tasks are presumably assigned to handle highly imbalanced datasets. Therefore, we investigated the optimal threshold of MAGPIE under various data balance scenarios. The default parameter of our model is 0.5 in balanced datasets such as the ClinVarTest dataset. We found that with the predicted probabilities between 0.4 and 0.7, both the accuracy and F1-score were stable (Additional file <xref rid="MOESM2" ref-type="media">2</xref>: Fig. S7-S8). Besides, Matthew’s correlation coefficient (MCC), a measure of association for two binary variables, in the ClinVarTest dataset confirmed that 0.5 was a reliable threshold for this benchmark (Additional file <xref rid="MOESM2" ref-type="media">2</xref>: Fig. S7-S8).</p>
      <p id="Par106">To examine the effects of different ratios between the number of pathogenic and benign variants, the ClinVarTest dataset was randomly divided into a series of subsets with various combinations. We randomly added different proportions of pathogenic variants to all benign variants from the ClinVarTest dataset to construct independent test subsets. We can see that in such cases, the optimal thresholds had dropped from 0.95 to 0.72 (Additional file <xref rid="MOESM2" ref-type="media">2</xref>: Fig. S7). However, MCC, accuracy, and F1-score were relatively stable in these subsets, which illustrated that performances of MAGPIE had less impact caused by the different thresholds (Additional file <xref rid="MOESM2" ref-type="media">2</xref>: Fig. S7). Furthermore, we added various percentages of benign variants to all pathogenic variants. We also found similar results (Additional file <xref rid="MOESM2" ref-type="media">2</xref>: Fig. S8).</p>
      <p id="Par107">We next studied the orthogonal SwissProt dataset, which was highly imbalanced with only 9.8% pathogenic mutations, and the ACMG dataset, which only included 18% benign variants. The SwissProt dataset is more similar to real applied scenarios than the ClinVarTest dataset and has clear labels of pathogenicity. Therefore, a precision-recall curve can help us to evaluate the influence of classifier performance with different thresholds. We found that the optimal threshold in this dataset was 0.71 (Additional file <xref rid="MOESM2" ref-type="media">2</xref>: Fig. S9A). We analyzed the performance matrix in the dataset with the default threshold and the optimal threshold. Our findings showed that the performance of MAGPIE became better with stricter thresholds. MCC and F1-score increased by 2% and 3%, respectively (Additional file <xref rid="MOESM2" ref-type="media">2</xref>: Fig. S9A). Similarly, we observed that the optimal threshold of the ACMG dataset was 0.34 (Additional file <xref rid="MOESM2" ref-type="media">2</xref>: Fig. S9B). MCC and F1-score had been slightly improved. However, if there is no precise estimate of the compositions of the dataset, MAGPIE with the default parameter still outperformed other methods. Therefore, using a default threshold can also achieve accurate prediction on both imbalanced and balanced datasets as shown before.</p>
    </sec>
    <sec id="Sec18">
      <title>MAGPIE prediction on gene mutations that cause Mendelian diseases</title>
      <p id="Par108">Next, we applied MAGPIE to four genes curated with a large number of known pathogenic mutations causing different Mendelian diseases (Methods). For all the four genes tested, i.e., ATP7B, CFTR, FBN1, and LMNA, MAGPIE was able to recover the largest number of known pathogenic mutations compared to other methods with default parameters (Fig. <xref rid="Fig5" ref-type="fig">5</xref>A). On average, MAGPIE recovered 96% of known pathogenic variants. For instance, for FBN1, the gene mutated in Marfan syndrome [<xref ref-type="bibr" rid="CR39">39</xref>] and included 1621 pathogenic mutations. MAGPIE predicted 1450 (87%) candidate variants as pathogenic, and MAGPIE scores of 95% pathogenic variants were close to 1 (Fig. <xref rid="Fig5" ref-type="fig">5</xref>B). All other tools correctly classified a smaller fraction of variants, which was lower than 70%. For CFTR (which is associated with cystic fibrosis), MAGPIE predicted 164 (95%) variants to be pathogenic. Compared to MutationTaster, VEST4, and other tools, MAGPIE scores were concentrated about 1 (Fig. <xref rid="Fig5" ref-type="fig">5</xref>B). Moreover, the performance of our classifier on ATP7B and FBN1 was better than other methods, indicating a stable performance for evaluating pathogenicity despite using entirely different disease-associated genes (Fig. <xref rid="Fig5" ref-type="fig">5</xref>A, B). Thus, MAGPIE performs better in identifying pathogenic mutations that cause Mendelian diseases.<fig id="Fig5"><label>Fig. 5</label><caption><p>MAGPIE detects most variants in pathogenic genes. <bold>A</bold> Comparison of the number of detected pathogenic variants in four well-known pathogenic genes between MAGPIE and 14 other prediction tools. <bold>B</bold> Density plots illustrated distributions of pathogenic scores predicted by MAGPIE, MutationTaster, and VEST4. Moreover, the pie charts showed the proportion of predictable and unpredictable variants of each tool</p></caption><graphic xlink:href="13073_2023_1274_Fig5_HTML" id="MO7"/></fig></p>
    </sec>
  </sec>
  <sec id="Sec19">
    <title>Discussion</title>
    <p id="Par109">The next-generation sequencing has revealed tremendous amount of genetic variations in the human population. However, it has raised another challenge: the difficulty of identifying the actual disease-causing mutation from the millions of normal variations. The current computation tools have enabled to predict one or several specific types of mutations. For example, M-CAP, MutationTaster, and PrimateAI focus on missense variants. However, specific types of variants have been filtered out due to the models’ scope. Various types of mutations present the challenge of the generalization ability for computational methods to predict pathogenic scores among mutations. Therefore, it is critical to train a generalized classifier foremost to expand predictable variant types.</p>
    <p id="Par110">To address this challenge, we report a computational classifier named MAGPIE, which focuses on classifying multiple types of mutations of uncertain significance for Mendelian diseases. The novelty of this work comes from a combination of data preparation, feature extraction, feature engineering, and model selection. The overall idea is that from the users’ perspective, the pathogenicity of a variant should be jointly evaluated on multiple scopes, which corresponds to features derived from six modalities in MAGPIE. Therefore, the machine learning components of MAGPIE are designed to maximize the models’ learning on multimodal data.</p>
    <p id="Par111">The machine learning component of MAGPIE mainly included autoFE and LightGBM, both of which we think contributes to the novelty of the method. In the pathogenicity prediction task, the pathogenicity of variants may be caused by multiple types of features. To enhance the model’s performance, we aimed to integrate these multimodal features. By incorporating the autoFE component, MAGPIE has the capability to handle the complexity of the features and effectively capture the underlying relationships. This enables us to extract valuable information from the features and improve the overall performance of our model. This process involves applying certain transformations to the features, allowing for a better representation of their performance in predicting mutation pathogenicity, such as through Group-By operations. Of note, MAGPIE employs separated feature selection and step-wise training approaches during the autoFE process to avoid overfitting. In our updated ablation study, the inclusion of the autoFE component enhances the performance of MAGPIE (Additional file <xref rid="MOESM2" ref-type="media">2</xref>: Fig. S2).</p>
    <p id="Par112">The input data for pathogenicity prediction in MAGPIE is in tabular format, which makes it suitable for tree-based models. Among the tree-based models, LightGBM stands out as one of the most efficient models in terms of both prediction accuracy and computational time. LightGBM is based on the gradient boosting framework and incorporates a number of advanced techniques such as histogram-based binning, leaf-wise tree growth, and gradient-based one-side sampling. These techniques improve model performance and enables faster training and inference times compared to other tree-based models or machine learning models. Consistently, in the ablation study for MAGPIE, we found that the computational time required for SVM with an identical training process was approximately 10 times longer than LightGBM. By incorporating LightGBM in MAGPIE, we are able to leverage its efficiency and accuracy to achieve accurate and timely pathogenicity predictions (Additional file <xref rid="MOESM2" ref-type="media">2</xref>: Fig. S10). Moreover, we can easily calculate feature importance from the LightGBM model, which enables the interpretability of MAGPIE.</p>
    <p id="Par113">Another novel aspect of MAGPIE design is the ability to make accurate prediction for rare variants, which is highly clinically relevant but not naturally well represented in ClinVar database as training source. In real-world pathogenicity prediction and diagnosis scenarios, it is common to encounter rare benign variants. Therefore, we aimed to include rare benign variants in the training of MAGPIE to enhance its ability to detect pathogenic variants in clinical settings. However, in large mutation datasets like ClinVar, rare benign variants make up a very small proportion of the dataset. To address this issue, we incorporated rare benign variants from gnomAD into the training set. By including rare benign variants from gnomAD, we were able to overcome the lack of features associated with rare benign variants in ClinVar. This inclusion of a more diverse dataset, encompassing rare benign variants, led to better generalization of the MAGPIE model. Ablation study also proves this crucial role of relevant cross-dataset working in improving model performance (Additional file <xref rid="MOESM2" ref-type="media">2</xref>: Fig. S2). In the ablation study, we find that removing the data from gnomAD in the training set has a significant impact on the performance of the MAGPIE model. Particularly in the pathogenicity prediction task for rare mutations, adding gnomAD mutations to the training set significantly increases the probability of correctly classifying rare benign mutations (Additional file <xref rid="MOESM2" ref-type="media">2</xref>: Fig. S2).</p>
    <p id="Par114">On the ClinVarTest dataset and the orthogonal datasets, our approach accurately classified multi-type variants, respectively, whereas most tools can only predict one or two types of variants. However, the total numbers of variants across variant types in the ClinVar dataset were different. Compared with the number of missense variants, other types of variants, such as stopgain, stoploss, and so on, had less number of records. Thus, the small sample size in these variant types might limit, to some extent, the performance of MAGPIE and cause some biases.</p>
    <p id="Par115">Many previous studies have demonstrated outstanding performance in accurately predicting pathogenic mutations and have paved the way for subsequent work. The design of MAGPIE draws inspiration from many previous work, such as utilizing the AUBPRC metric defined in VARITY to assess the performance of imbalanced datasets. However, we showed here that the state-of-the-art methods included missing value because their predictions are concentrated on one or several specific mutation types. In the clinical application for genetic diagnosis, these unpredictable variants would be filtered out and often be treated as non-pathogenic ones (Additional file <xref rid="MOESM2" ref-type="media">2</xref>: Fig. S11).</p>
    <p id="Par116">Detection of pathogenic variants using MAGPIE may suffer from several limitations. First, we evaluated the running time of our method and found that the annotation tools cost the most time in the MAGPIE pipeline since the running time of MAGPIE was limited by the necessary file I/O in annotation tools (Additional file <xref rid="MOESM2" ref-type="media">2</xref>: Fig. S11). Also, our approach does not address the influences of a combination of variants. Human diseases may be associated with multiple causative mutations. However, our method focuses on predicting the pathogenicity of a single variant. Another potential limitation is that this approach is designed to obtain information from genetic annotations without any phenotype-related annotations. Future methods development may consider features including phenotype-related annotations to build a more direct connection between diseases and genetic variants. Currently, the clinical work of genetic diagnosis rate is still limited. It was reported that using WES data, the genetic diagnosis rate can be up to 40%, suggesting a large space of improvement remains for practical clinical work. Several reasons lead to this result, one of which is that most of the human genome is non-coding, while most algorithms can only predict a subset of the coding region. Admittedly, computational predictions focusing on exonic mutations other than synonymous mutations like MAGPIE are necessary but still insufficient to address all the clinical diagnosis challenges. MAGPIE cannot provide reliable predictions for intronic and intergenic variants due to the scarcity of annotation information in existing databases and the lack of training sources. As we move forward, we will endeavor to acquire essential information about these types of mutations.</p>
  </sec>
  <sec id="Sec20">
    <title>Conclusions</title>
    <p id="Par117">In this study, we introduce a computational framework named MAGPIE, which generates pathogenicity scores for multi-type variants and simplifies pathogenicity classification for millions of candidate genomic variants. Moreover, MAGPIE is independent of any other pathogenic prediction tools, thereby avoiding introducing biases and circularity. Our approach yields superior performance and low missing rates for various types of exonic variants in both balanced and imbalanced datasets. Besides, MAGPIE also provided an accurate prediction of multi-type rare variants. Furthermore, MAGPIE performance remained robust, recovering known pathogenic variants across different Mendelian diseases. In conclusion, with improved prediction accuracy, MAGPIE provides a more accessible and accurate prediction of multi-type exonic variants for Mendelian disease studies.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <sec id="Sec21">
      <title>Supplementary Information</title>
      <p>
        <supplementary-material content-type="local-data" id="MOESM1">
          <media xlink:href="13073_2023_1274_MOESM1_ESM.xlsx">
            <caption>
              <p><bold>Additional file 1: Table S1.</bold> Category and proportion of variants in independent test set. <bold>Table S2.</bold> Category and proportion of variants in orthogonal validation set. <bold>Table S3.</bold> Category and proportion of variants in ACMG guided dataset. <bold>Table S4.</bold> Feature name and description. <bold>Table S5.</bold> Feature importance of MAGPIE. <bold>Table S6.</bold> Performance metrics in independent test set. <bold>Table S7.</bold> Performance metrics in orthogonal validation set. <bold>Table S8.</bold> Performance metrics in ACMG guided dataset.</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM2">
          <media xlink:href="13073_2023_1274_MOESM2_ESM.pdf">
            <caption>
              <p><bold>Additional file 2: Fig. S1.</bold> Web tool of MAGPIE. <bold>Fig. S2.</bold> Ablation study of MAGPIE. <bold>Fig. S3.</bold> Significance test on independent test set. <bold>Fig. S4.</bold> Performance of each variant type on orthogonal validation set. <bold>Fig. S5.</bold> Performance evaluation on ACMG guided dataset. <bold>Fig. S6.</bold> Performance of each variant type on ACMG guided dataset. <bold>Fig. S7.</bold> Threshold test of MAGPIE on independent test set when number of pathogenic variants is less than benign ones. <bold>Fig. S8.</bold> Threshold test of MAGPIE on orthogonal validation set when the number of pathogenic variants is less than benign. <bold>Fig. S9.</bold> Performance comparison before and after threshold adjustment according to FPR control. <bold>Fig. S10.</bold> MAGPIE running time. <bold>Fig. S11.</bold> Performance comparison in real-world diagnosis.</p>
            </caption>
          </media>
        </supplementary-material>
      </p>
    </sec>
  </sec>
</body>
<back>
  <glossary>
    <title>Abbreviations</title>
    <def-list>
      <def-item>
        <term>MAGPIE</term>
        <def>
          <p id="Par2">Multimodal Annotation Generated Pathogenic Impact Evaluator</p>
        </def>
      </def-item>
      <def-item>
        <term>ClinVar</term>
        <def>
          <p id="Par3">Clinical variation</p>
        </def>
      </def-item>
      <def-item>
        <term>AUC</term>
        <def>
          <p id="Par4">Area under curve</p>
        </def>
      </def-item>
      <def-item>
        <term>WGS</term>
        <def>
          <p id="Par5">Whole genome sequencing</p>
        </def>
      </def-item>
      <def-item>
        <term>WES</term>
        <def>
          <p id="Par6">Whole exome sequencing</p>
        </def>
      </def-item>
      <def-item>
        <term>gnomAD</term>
        <def>
          <p id="Par7">Genome Aggregation Database</p>
        </def>
      </def-item>
      <def-item>
        <term>ExAC</term>
        <def>
          <p id="Par8">Exome Aggregation Consortium</p>
        </def>
      </def-item>
      <def-item>
        <term>ML</term>
        <def>
          <p id="Par9">Machine learning</p>
        </def>
      </def-item>
      <def-item>
        <term>DL</term>
        <def>
          <p id="Par10">Deep learning</p>
        </def>
      </def-item>
      <def-item>
        <term>OMIM</term>
        <def>
          <p id="Par11">Online Mendelian Inheritance in Man</p>
        </def>
      </def-item>
      <def-item>
        <term>HGMD</term>
        <def>
          <p id="Par12">Human Gene Mutation Database</p>
        </def>
      </def-item>
      <def-item>
        <term>RNA</term>
        <def>
          <p id="Par13">Ribonucleic acid</p>
        </def>
      </def-item>
      <def-item>
        <term>SpliceAI</term>
        <def>
          <p id="Par14">Splice artificial intelligence</p>
        </def>
      </def-item>
      <def-item>
        <term>EVE</term>
        <def>
          <p id="Par15">Evolutionary model of variant effect</p>
        </def>
      </def-item>
      <def-item>
        <term>CADD</term>
        <def>
          <p id="Par16">Combined Annotation-Dependent Depletion</p>
        </def>
      </def-item>
      <def-item>
        <term>DANN</term>
        <def>
          <p id="Par17">Deleterious Annotation of Genetic Variants using Neural Networks</p>
        </def>
      </def-item>
      <def-item>
        <term>REVEL</term>
        <def>
          <p id="Par18">Rare Exome Variant Ensemble Learner</p>
        </def>
      </def-item>
      <def-item>
        <term>MutPred</term>
        <def>
          <p id="Par19">Mutation predictor</p>
        </def>
      </def-item>
      <def-item>
        <term>VEST</term>
        <def>
          <p id="Par20">Variant effect scoring tool</p>
        </def>
      </def-item>
      <def-item>
        <term>PROVEAN</term>
        <def>
          <p id="Par21">Protein Variation Effect Analyzer</p>
        </def>
      </def-item>
      <def-item>
        <term>PhastCons</term>
        <def>
          <p id="Par22">Phylogenetic Analysis with Space/Time Models for Conservation of Evolutionary Significant Sequences</p>
        </def>
      </def-item>
      <def-item>
        <term>GBM</term>
        <def>
          <p id="Par23">Gradient-boosting model</p>
        </def>
      </def-item>
      <def-item>
        <term>GOSS</term>
        <def>
          <p id="Par24">Gradient-based one-side sampling</p>
        </def>
      </def-item>
      <def-item>
        <term>EFB</term>
        <def>
          <p id="Par25">Exclusive feature bundling</p>
        </def>
      </def-item>
      <def-item>
        <term>GDI</term>
        <def>
          <p id="Par26">Gene damage index</p>
        </def>
      </def-item>
      <def-item>
        <term>LoF</term>
        <def>
          <p id="Par27">Loss of function</p>
        </def>
      </def-item>
      <def-item>
        <term>SIFT</term>
        <def>
          <p id="Par28">Sorting Intolerant From Tolerant</p>
        </def>
      </def-item>
      <def-item>
        <term>PolyPhen</term>
        <def>
          <p id="Par29">Polymorphism phenotyping</p>
        </def>
      </def-item>
      <def-item>
        <term>MetaSVM</term>
        <def>
          <p id="Par30">Meta-learner support vector machine</p>
        </def>
      </def-item>
      <def-item>
        <term>MetaLR</term>
        <def>
          <p id="Par31">Meta-logistic regression</p>
        </def>
      </def-item>
      <def-item>
        <term>ClinPred</term>
        <def>
          <p id="Par32">Clinical variant prediction</p>
        </def>
      </def-item>
      <def-item>
        <term>PrimateAI</term>
        <def>
          <p id="Par33">Primate artificial intelligence</p>
        </def>
      </def-item>
      <def-item>
        <term>LIST-S2</term>
        <def>
          <p id="Par34">Local Identity and Shared Taxa—S2</p>
        </def>
      </def-item>
      <def-item>
        <term>M-CAP</term>
        <def>
          <p id="Par35">Mendelian Clinically Applicable Pathogenicity</p>
        </def>
      </def-item>
      <def-item>
        <term>SIFT4G</term>
        <def>
          <p id="Par36">Sorting Intolerant From Tolerant for Genomes</p>
        </def>
      </def-item>
      <def-item>
        <term>SNV</term>
        <def>
          <p id="Par37">Single-nucleotide variant</p>
        </def>
      </def-item>
      <def-item>
        <term>AUPRC</term>
        <def>
          <p id="Par38">Area under the precision-recall curve</p>
        </def>
      </def-item>
      <def-item>
        <term>AUBPRC</term>
        <def>
          <p id="Par39">Area under the balanced precision-recall curve</p>
        </def>
      </def-item>
      <def-item>
        <term>MCC</term>
        <def>
          <p id="Par40">Matthews correlation coefficient</p>
        </def>
      </def-item>
      <def-item>
        <term>GWAS</term>
        <def>
          <p id="Par41">Genome-wide association study</p>
        </def>
      </def-item>
      <def-item>
        <term>ANNOVAR</term>
        <def>
          <p id="Par42">Annotation of variants from next-generation sequencing data using a reference genome</p>
        </def>
      </def-item>
      <def-item>
        <term>RVIS</term>
        <def>
          <p id="Par43">Residual variation intolerance score</p>
        </def>
      </def-item>
      <def-item>
        <term>LoFtool</term>
        <def>
          <p id="Par44">Loss of function tool</p>
        </def>
      </def-item>
      <def-item>
        <term>DS</term>
        <def>
          <p id="Par45">Delta score</p>
        </def>
      </def-item>
      <def-item>
        <term>AG</term>
        <def>
          <p id="Par46">Acceptor gain</p>
        </def>
      </def-item>
      <def-item>
        <term>AL</term>
        <def>
          <p id="Par47">Acceptor loss</p>
        </def>
      </def-item>
      <def-item>
        <term>DG</term>
        <def>
          <p id="Par48">Donor gain</p>
        </def>
      </def-item>
      <def-item>
        <term>DL</term>
        <def>
          <p id="Par49">Donor loss</p>
        </def>
      </def-item>
      <def-item>
        <term>DP</term>
        <def>
          <p id="Par50">Delta position</p>
        </def>
      </def-item>
      <def-item>
        <term>AF</term>
        <def>
          <p id="Par51">Allele frequency</p>
        </def>
      </def-item>
      <def-item>
        <term>phyloP</term>
        <def>
          <p id="Par52">Phylogenetic <italic>P</italic>-values</p>
        </def>
      </def-item>
      <def-item>
        <term>SiPhy</term>
        <def>
          <p id="Par53">SIte-specific PHYlogenetic analysis</p>
        </def>
      </def-item>
      <def-item>
        <term>AutoFE</term>
        <def>
          <p id="Par54">Automatic feature engineering</p>
        </def>
      </def-item>
      <def-item>
        <term>SFS</term>
        <def>
          <p id="Par55">Separated feature selection</p>
        </def>
      </def-item>
      <def-item>
        <term>ROC</term>
        <def>
          <p id="Par56">Receiver operating characteristic</p>
        </def>
      </def-item>
    </def-list>
  </glossary>
  <fn-group>
    <fn>
      <p>This article has been updated to amend affiliations 1 &amp; 2 and the funding section.</p>
    </fn>
    <fn>
      <p>
        <bold>Publisher’s Note</bold>
      </p>
      <p>Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p>
    </fn>
    <fn>
      <p>Yicheng Liu and Tianyun Zhang contributed equally to this work.</p>
    </fn>
    <fn>
      <p>
        <bold>Change history</bold>
      </p>
      <p>5/14/2024</p>
      <p>A Correction to this paper has been published: 10.1186/s13073-024-01343-2</p>
    </fn>
  </fn-group>
  <ack>
    <title>Acknowledgements</title>
    <p>We thank Jinzhao Liang, Xiaoyang Zhao, and Hanying Jia for providing important suggestions on data analysis. We thank Dandan Hu, Lin Lv, Asif Ashan, Hanying Jia, Xilu Yuan, and Yuxin Gu for providing helpful suggestions for manuscript. We thank Dr. Shanshan Pei for helping us come up with the name of the tool. We are also thankful for the Core Facilities of Liangzhu Laboratory.</p>
  </ack>
  <notes notes-type="author-contribution">
    <title>Authors’ contributions</title>
    <p>N.S. conceived the project. N.S., S.W., and Y.L. designed the experiment. Y.L. processed the data and performed the experiments. N.S., Y.L., and T.Z. devised the data analysis. N.S. and S.W. supervised the study. N.Y. and Y.L. built the MAGPIE tool website. T.Z., N.S., Y.L. S.W. wrote the manuscript. All authors read and approved the final manuscript.</p>
  </notes>
  <notes notes-type="funding-information">
    <title>Funding</title>
    <p>This work was supported by the Key R&amp;D Program of Zhejiang (No.2024SSYS0022), the Leading Innovative and Entrepreneur Team Introduction Program of Zhejiang (No. 2021R01012).</p>
  </notes>
  <notes notes-type="data-availability">
    <title>Availability of data and materials</title>
    <p>Datasets generated and/or analyzed during the current study are publicly available in the ClinVar (<ext-link ext-link-type="uri" xlink:href="https://ftp.ncbi.nlm.nih.gov/pub/clinvar/">https://ftp.ncbi.nlm.nih.gov/pub/clinvar/</ext-link>) [<xref ref-type="bibr" rid="CR4">4</xref>], SwissProt (<ext-link ext-link-type="uri" xlink:href="https://ftp.uniprot.org/pub/databases/uniprot/">https://ftp.uniprot.org/pub/databases/uniprot/</ext-link>) [<xref ref-type="bibr" rid="CR40">40</xref>], gnomAD (<ext-link ext-link-type="uri" xlink:href="https://gnomad.broadinstitute.org/downloads/">https://gnomad.broadinstitute.org/downloads/</ext-link>) [<xref ref-type="bibr" rid="CR1">1</xref>], and ACMG guided dataset (10.1016/j.gim.2021.11.018) [<xref ref-type="bibr" rid="CR41">41</xref>]. The datasets supporting the conclusions of this article are included within the article and its additional files. MAGPIE web-based prediction tool for all nonsynonymous exonic variants is available at <ext-link ext-link-type="uri" xlink:href="http://tools.shenlab-genomics.org/tools/MAGPIE">http://tools.shenlab-genomics.org/tools/MAGPIE</ext-link>.</p>
  </notes>
  <notes>
    <title>Declarations</title>
    <notes id="FPar1">
      <title>Ethics approval and consent to participate</title>
      <p id="Par118">Not applicable.</p>
    </notes>
    <notes id="FPar2">
      <title>Consent for publication</title>
      <p id="Par119">Not applicable.</p>
    </notes>
    <notes id="FPar3" notes-type="COI-statement">
      <title>Competing interests</title>
      <p id="Par120">The authors have submitted a patent application for the method. Other than this, the authors declare that they do not have any competing interests.</p>
    </notes>
  </notes>
  <ref-list id="Bib1">
    <title>References</title>
    <ref id="CR1">
      <label>1.</label>
      <mixed-citation publication-type="other">Karczewski KJ, Francioli LC, Tiao G, Cummings BB, Alfoldi J, Wang Q, ... MacArthur DG. The mutational constraint spectrum quantified from variation in 141,456 humans. Nature. 2020;581(7809):434–443.</mixed-citation>
    </ref>
    <ref id="CR2">
      <label>2.</label>
      <mixed-citation publication-type="other">Lek M, Karczewski KJ, Minikel EV, Samocha KE, Banks E, Fennell T, ... Exome Aggregation Consortium. Analysis of protein-coding genetic variation in 60,706 humans. Nature. 2016;536(7616):285-291</mixed-citation>
    </ref>
    <ref id="CR3">
      <label>3.</label>
      <mixed-citation publication-type="other">Cao Y, Li L, Xu M, Feng Z, Sun X, Lu J, ... Wang W. The ChinaMAP analytics of deep whole genome sequences in 10,588 individuals. Cell Res. 2020;30(9):717–731.</mixed-citation>
    </ref>
    <ref id="CR4">
      <label>4.</label>
      <mixed-citation publication-type="other">Landrum MJ, Lee JM, Benson M, Brown G, Chao C, Chitipiralla S, ... Maglott DR. ClinVar: public archive of interpretations of clinically relevant variants. Nucleic Acids Res. 2016;44(D1), D862-D868.</mixed-citation>
    </ref>
    <ref id="CR5">
      <label>5.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Amberger</surname>
            <given-names>JS</given-names>
          </name>
          <name>
            <surname>Bocchini</surname>
            <given-names>CA</given-names>
          </name>
          <name>
            <surname>Schiettecatte</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Scott</surname>
            <given-names>AF</given-names>
          </name>
          <name>
            <surname>Hamosh</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>OMIM. org: Online Mendelian Inheritance in Man (OMIM®), an online catalog of human genes and genetic disorders</article-title>
        <source>Nucleic Acids Res.</source>
        <year>2015</year>
        <volume>43</volume>
        <issue>D1</issue>
        <fpage>D789</fpage>
        <lpage>D798</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/gku1205</pub-id>
        <?supplied-pmid 25428349?>
        <pub-id pub-id-type="pmid">25428349</pub-id>
      </element-citation>
    </ref>
    <ref id="CR6">
      <label>6.</label>
      <mixed-citation publication-type="other">Stenson PD, Mort M, Ball EV, Evans K, Hayden M, Heywood S, ... Cooper DN. The Human Gene Mutation Database: towards a comprehensive repository of inherited mutation data for medical research, genetic diagnosis and next-generation sequencing studies. Hum Genet. 2017;136:665–677.</mixed-citation>
    </ref>
    <ref id="CR7">
      <label>7.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ng</surname>
            <given-names>PC</given-names>
          </name>
          <name>
            <surname>Henikoff</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>SIFT: predicting amino acid changes that affect protein function</article-title>
        <source>Nucleic Acids Res</source>
        <year>2003</year>
        <volume>31</volume>
        <issue>13</issue>
        <fpage>3812</fpage>
        <lpage>3814</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/gkg509</pub-id>
        <?supplied-pmid 12824425?>
        <pub-id pub-id-type="pmid">12824425</pub-id>
      </element-citation>
    </ref>
    <ref id="CR8">
      <label>8.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Adzhubei</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Jordan</surname>
            <given-names>DM</given-names>
          </name>
          <name>
            <surname>Sunyaev</surname>
            <given-names>SR</given-names>
          </name>
        </person-group>
        <article-title>Predicting functional effect of human missense mutations using PolyPhen-2</article-title>
        <source>Curr Protoc Hum Genet</source>
        <year>2013</year>
        <volume>76</volume>
        <issue>1</issue>
        <fpage>7</fpage>
        <lpage>20</lpage>
      </element-citation>
    </ref>
    <ref id="CR9">
      <label>9.</label>
      <mixed-citation publication-type="other">Choi Y, Sims GE, Murphy S, Miller JR, Chan AP. Predicting the functional effect of amino acid substitutions and indels. 2012.</mixed-citation>
    </ref>
    <ref id="CR10">
      <label>10.</label>
      <mixed-citation publication-type="other">Li B, Krishnan VG, Mort ME, Xin F, Kamati KK, Cooper DN, ... Radivojac P. Automated inference of molecular mechanisms of disease from amino acid substitutions. Bioinformatics. 2009;25(21):2744–2750.</mixed-citation>
    </ref>
    <ref id="CR11">
      <label>11.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Reva</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Antipin</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Sander</surname>
            <given-names>C</given-names>
          </name>
        </person-group>
        <article-title>Predicting the functional impact of protein mutations: application to cancer genomics</article-title>
        <source>Nucleic Acids Res</source>
        <year>2011</year>
        <volume>39</volume>
        <issue>17</issue>
        <fpage>e118</fpage>
        <lpage>e118</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/gkr407</pub-id>
        <?supplied-pmid 21727090?>
        <pub-id pub-id-type="pmid">21727090</pub-id>
      </element-citation>
    </ref>
    <ref id="CR12">
      <label>12.</label>
      <mixed-citation publication-type="other">Shihab HA, Rogers MF, Gough J, Mort M, Cooper DN, Day IN, ... Campbell C. An integrative approach to predicting the functional effects of non-coding and coding sequence variation. Bioinformatics. 2015;31(10):1536–1543.</mixed-citation>
    </ref>
    <ref id="CR13">
      <label>13.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Dong</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Wei</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Jian</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Gibbs</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Boerwinkle</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Liu</surname>
            <given-names>X</given-names>
          </name>
        </person-group>
        <article-title>Comparison and integration of deleteriousness prediction methods for nonsynonymous SNVs in whole exome sequencing studies</article-title>
        <source>Hum Mol Genet</source>
        <year>2015</year>
        <volume>24</volume>
        <issue>8</issue>
        <fpage>2125</fpage>
        <lpage>2137</lpage>
        <pub-id pub-id-type="doi">10.1093/hmg/ddu733</pub-id>
        <?supplied-pmid 25552646?>
        <pub-id pub-id-type="pmid">25552646</pub-id>
      </element-citation>
    </ref>
    <ref id="CR14">
      <label>14.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Carter</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Douville</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Stenson</surname>
            <given-names>PD</given-names>
          </name>
          <name>
            <surname>Cooper</surname>
            <given-names>DN</given-names>
          </name>
          <name>
            <surname>Karchin</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>Identifying Mendelian disease genes with the variant effect scoring tool</article-title>
        <source>BMC Genomics</source>
        <year>2013</year>
        <volume>14</volume>
        <issue>3</issue>
        <fpage>1</fpage>
        <lpage>16</lpage>
        <pub-id pub-id-type="pmid">23323973</pub-id>
      </element-citation>
    </ref>
    <ref id="CR15">
      <label>15.</label>
      <mixed-citation publication-type="other">Frazer J, Notin P, Dias M, Gomez A, Min JK, Brock K, ... Marks DS. Disease variant prediction with deep generative models of evolutionary data. Nature. 2021;599(7883):91–95.</mixed-citation>
    </ref>
    <ref id="CR16">
      <label>16.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wu</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Liu</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Sun</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Weile</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Roth</surname>
            <given-names>FP</given-names>
          </name>
        </person-group>
        <article-title>Improved pathogenicity prediction for rare human missense variants</article-title>
        <source>Am J Hum Genet</source>
        <year>2021</year>
        <volume>108</volume>
        <issue>10</issue>
        <fpage>1891</fpage>
        <lpage>1906</lpage>
        <pub-id pub-id-type="doi">10.1016/j.ajhg.2021.08.012</pub-id>
        <?supplied-pmid 34551312?>
        <pub-id pub-id-type="pmid">34551312</pub-id>
      </element-citation>
    </ref>
    <ref id="CR17">
      <label>17.</label>
      <mixed-citation publication-type="other">Ioannidis NM, Rothstein JH, Pejaver V, Middha S, McDonnell SK, Baheti S, ... Sieh W. REVEL: an ensemble method for predicting the pathogenicity of rare missense variants. Am J Hum Genet. 2016;99(4):877–885.</mixed-citation>
    </ref>
    <ref id="CR18">
      <label>18.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Cheng</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Nguyen</surname>
            <given-names>TYD</given-names>
          </name>
          <name>
            <surname>Cygan</surname>
            <given-names>KJ</given-names>
          </name>
          <name>
            <surname>Çelik</surname>
            <given-names>MH</given-names>
          </name>
          <name>
            <surname>Fairbrother</surname>
            <given-names>WG</given-names>
          </name>
          <name>
            <surname>Gagneur</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>MMSplice: modular modeling improves the predictions of genetic variant effects on splicing</article-title>
        <source>Genome Biol</source>
        <year>2019</year>
        <volume>20</volume>
        <issue>1</issue>
        <fpage>1</fpage>
        <lpage>15</lpage>
        <pub-id pub-id-type="doi">10.1186/s13059-019-1653-z</pub-id>
        <pub-id pub-id-type="pmid">30606230</pub-id>
      </element-citation>
    </ref>
    <ref id="CR19">
      <label>19.</label>
      <mixed-citation publication-type="other">Jaganathan K, Panagiotopoulou SK, McRae JF, Darbandi SF, Knowles D, Li YI, ... Farh KKH. Predicting splicing from primary sequence with deep learning. Cell. 2019;176(3):535–548.</mixed-citation>
    </ref>
    <ref id="CR20">
      <label>20.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Rentzsch</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Witten</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Cooper</surname>
            <given-names>GM</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>CADD: predicting the deleteriousness of variants throughout the human genome</article-title>
        <source>Nucleic Acids Res</source>
        <year>2019</year>
        <volume>47</volume>
        <issue>D1</issue>
        <fpage>D886</fpage>
        <lpage>D894</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/gky1016</pub-id>
        <?supplied-pmid 30371827?>
        <pub-id pub-id-type="pmid">30371827</pub-id>
      </element-citation>
    </ref>
    <ref id="CR21">
      <label>21.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Quang</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Xie</surname>
            <given-names>X</given-names>
          </name>
        </person-group>
        <article-title>DANN: a deep learning approach for annotating the pathogenicity of genetic variants</article-title>
        <source>Bioinformatics</source>
        <year>2015</year>
        <volume>31</volume>
        <issue>5</issue>
        <fpage>761</fpage>
        <lpage>763</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btu703</pub-id>
        <?supplied-pmid 25338716?>
        <pub-id pub-id-type="pmid">25338716</pub-id>
      </element-citation>
    </ref>
    <ref id="CR22">
      <label>22.</label>
      <mixed-citation publication-type="other">Pejaver V, Urresti J, Lugo-Martinez J, Pagel KA, Lin GN, Nam HJ, ... Radivojac P. Inferring the molecular and phenotypic impact of amino acid variants with MutPred2. Nat Commun. 2020;11(1):5918.</mixed-citation>
    </ref>
    <ref id="CR23">
      <label>23.</label>
      <mixed-citation publication-type="other">Siepel A, Bejerano G, Pedersen JS, Hinrichs AS, Hou M, Rosenbloom K, ... Haussler D. Evolutionarily conserved elements in vertebrate, insect, worm, and yeast genomes. Genome Res. 2005;15(8):1034–1050.</mixed-citation>
    </ref>
    <ref id="CR24">
      <label>24.</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Van Rossum</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Drake</surname>
            <given-names>FL</given-names>
          </name>
        </person-group>
        <source>Python reference manual (Vol. 111)</source>
        <year>1995</year>
        <publisher-loc>Amsterdam</publisher-loc>
        <publisher-name>Centrum voor Wiskunde en Informatica</publisher-name>
        <fpage>1</fpage>
        <lpage>52</lpage>
      </element-citation>
    </ref>
    <ref id="CR25">
      <label>25.</label>
      <mixed-citation publication-type="other">The MathWorks Inc. MATLAB version: 9.13.0 (R2022b), Natick, Massachusetts: The MathWorks Inc; 2022. <ext-link ext-link-type="uri" xlink:href="https://www.mathworks.com">https://www.mathworks.com</ext-link>.</mixed-citation>
    </ref>
    <ref id="CR26">
      <label>26.</label>
      <mixed-citation publication-type="other">Pedregosa F, Varoquaux G, Gramfort A, Michel V, Thirion B, Grisel O, ... Duchesnay É. Scikit-learn: machine learning in Python. J Mach Learn Res. 2011;12:2825–2830.</mixed-citation>
    </ref>
    <ref id="CR27">
      <label>27.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wang</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Hakonarson</surname>
            <given-names>H</given-names>
          </name>
        </person-group>
        <article-title>ANNOVAR: functional annotation of genetic variants from high-throughput sequencing data</article-title>
        <source>Nucleic Acids Res</source>
        <year>2010</year>
        <volume>38</volume>
        <issue>16</issue>
        <fpage>e164</fpage>
        <lpage>e164</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/gkq603</pub-id>
        <?supplied-pmid 20601685?>
        <pub-id pub-id-type="pmid">20601685</pub-id>
      </element-citation>
    </ref>
    <ref id="CR28">
      <label>28.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ernst</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Kellis</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>ChromHMM: automating chromatin-state discovery and characterization</article-title>
        <source>Nat Methods</source>
        <year>2012</year>
        <volume>9</volume>
        <issue>3</issue>
        <fpage>215</fpage>
        <lpage>216</lpage>
        <pub-id pub-id-type="doi">10.1038/nmeth.1906</pub-id>
        <?supplied-pmid 22373907?>
        <pub-id pub-id-type="pmid">22373907</pub-id>
      </element-citation>
    </ref>
    <ref id="CR29">
      <label>29.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Nounou</surname>
            <given-names>MN</given-names>
          </name>
          <name>
            <surname>Bakshi</surname>
            <given-names>BR</given-names>
          </name>
          <name>
            <surname>Goel</surname>
            <given-names>PK</given-names>
          </name>
          <name>
            <surname>Shen</surname>
            <given-names>X</given-names>
          </name>
        </person-group>
        <article-title>Bayesian principal component analysis</article-title>
        <source>J Chemom</source>
        <year>2002</year>
        <volume>16</volume>
        <issue>11</issue>
        <fpage>576</fpage>
        <lpage>595</lpage>
        <pub-id pub-id-type="doi">10.1002/cem.759</pub-id>
      </element-citation>
    </ref>
    <ref id="CR30">
      <label>30.</label>
      <mixed-citation publication-type="other">Zhang T, Zhang Z, Fan Z, Luo H, Liu F, Cao W, Li J. OpenFE: automated feature generation beyond expert-level performance. 2022. arXiv preprint <ext-link ext-link-type="uri" xlink:href="http://arxiv.org/abs/2211.12507">arXiv:2211.12507</ext-link>.</mixed-citation>
    </ref>
    <ref id="CR31">
      <label>31.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Alirezaie</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Kernohan</surname>
            <given-names>KD</given-names>
          </name>
          <name>
            <surname>Hartley</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Majewski</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Hocking</surname>
            <given-names>TD</given-names>
          </name>
        </person-group>
        <article-title>ClinPred: prediction tool to identify disease-relevant nonsynonymous single-nucleotide variants</article-title>
        <source>Am J Hum Genet</source>
        <year>2018</year>
        <volume>103</volume>
        <issue>4</issue>
        <fpage>474</fpage>
        <lpage>483</lpage>
        <pub-id pub-id-type="doi">10.1016/j.ajhg.2018.08.005</pub-id>
        <?supplied-pmid 30220433?>
        <pub-id pub-id-type="pmid">30220433</pub-id>
      </element-citation>
    </ref>
    <ref id="CR32">
      <label>32.</label>
      <mixed-citation publication-type="other">Jagadeesh KA, Wenger AM, Berger MJ, Guturu H, Stenson PD, Cooper DN, ... Bejerano G. M-CAP eliminates a majority of variants of uncertain significance in clinical exomes at high sensitivity. Nat Genet. 2016;48(12):1581–1586.</mixed-citation>
    </ref>
    <ref id="CR33">
      <label>33.</label>
      <mixed-citation publication-type="other">Sundaram L, Gao H, Padigepati SR, McRae JF, Li Y, Kosmicki JA, ... Farh KKH. Predicting the clinical impact of human mutation with deep neural networks. Nat Genet. 2018;50(8):1161–1170.</mixed-citation>
    </ref>
    <ref id="CR34">
      <label>34.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Vaser</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Adusumalli</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Leng</surname>
            <given-names>SN</given-names>
          </name>
          <name>
            <surname>Sikic</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Ng</surname>
            <given-names>PC</given-names>
          </name>
        </person-group>
        <article-title>SIFT missense predictions for genomes</article-title>
        <source>Nat Protoc</source>
        <year>2016</year>
        <volume>11</volume>
        <issue>1</issue>
        <fpage>1</fpage>
        <lpage>9</lpage>
        <pub-id pub-id-type="doi">10.1038/nprot.2015.123</pub-id>
        <?supplied-pmid 26633127?>
        <pub-id pub-id-type="pmid">26633127</pub-id>
      </element-citation>
    </ref>
    <ref id="CR35">
      <label>35.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Malhis</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Jacobson</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Jones</surname>
            <given-names>SJ</given-names>
          </name>
          <name>
            <surname>Gsponer</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>LIST-S2: taxonomy based sorting of deleterious missense mutations across species</article-title>
        <source>Nucleic Acids Res</source>
        <year>2020</year>
        <volume>48</volume>
        <issue>W1</issue>
        <fpage>W154</fpage>
        <lpage>W161</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/gkaa288</pub-id>
        <?supplied-pmid 32352516?>
        <pub-id pub-id-type="pmid">32352516</pub-id>
      </element-citation>
    </ref>
    <ref id="CR36">
      <label>36.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Schwarz</surname>
            <given-names>JM</given-names>
          </name>
          <name>
            <surname>Cooper</surname>
            <given-names>DN</given-names>
          </name>
          <name>
            <surname>Schuelke</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Seelow</surname>
            <given-names>D</given-names>
          </name>
        </person-group>
        <article-title>MutationTaster2: mutation prediction for the deep-sequencing age</article-title>
        <source>Nat Methods</source>
        <year>2014</year>
        <volume>11</volume>
        <issue>4</issue>
        <fpage>361</fpage>
        <lpage>362</lpage>
        <pub-id pub-id-type="doi">10.1038/nmeth.2890</pub-id>
        <?supplied-pmid 24681721?>
        <pub-id pub-id-type="pmid">24681721</pub-id>
      </element-citation>
    </ref>
    <ref id="CR37">
      <label>37.</label>
      <mixed-citation publication-type="other">Ke G, Meng Q, Finley T, Wang T, Chen W, Ma W, ... Liu TY. LightGBM: a highly efficient gradient boosting decision tree. Adv Neural Inform Process Syst. 2017;30.</mixed-citation>
    </ref>
    <ref id="CR38">
      <label>38.</label>
      <mixed-citation publication-type="other">Itan Y, Shang L, Boisson B, Patin E, Bolze A, Moncada-Vélez M, ... Casanova JL. The human gene damage index as a gene-level approach to prioritizing exome variants. Proc Natl Acad Sci. 2015;112(44):13615–13620.</mixed-citation>
    </ref>
    <ref id="CR39">
      <label>39.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Dietz</surname>
            <given-names>HC</given-names>
          </name>
          <name>
            <surname>Pyeritz</surname>
            <given-names>RE</given-names>
          </name>
        </person-group>
        <article-title>Mutations in the human gene for fibrillin-1 (FBN1) in the Marfan syndrome and related disorders</article-title>
        <source>Hum Mol Genet</source>
        <year>1995</year>
        <volume>4</volume>
        <issue>suppl_1</issue>
        <fpage>1799</fpage>
        <lpage>1809</lpage>
        <pub-id pub-id-type="doi">10.1093/hmg/4.suppl_1.1799</pub-id>
        <?supplied-pmid 8541880?>
        <pub-id pub-id-type="pmid">8541880</pub-id>
      </element-citation>
    </ref>
    <ref id="CR40">
      <label>40.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bairoch</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Apweiler</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>The SWISS-PROT protein sequence database and its supplement TrEMBL in 2000</article-title>
        <source>Nucleic Acids Res</source>
        <year>2000</year>
        <volume>28</volume>
        <issue>1</issue>
        <fpage>45</fpage>
        <lpage>48</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/28.1.45</pub-id>
        <?supplied-pmid 10592178?>
        <pub-id pub-id-type="pmid">10592178</pub-id>
      </element-citation>
    </ref>
    <ref id="CR41">
      <label>41.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wilcox</surname>
            <given-names>EH</given-names>
          </name>
          <name>
            <surname>Sarmady</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Wulf</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Wright</surname>
            <given-names>MW</given-names>
          </name>
          <name>
            <surname>Rehm</surname>
            <given-names>HL</given-names>
          </name>
          <name>
            <surname>Biesecker</surname>
            <given-names>LG</given-names>
          </name>
          <name>
            <surname>Abou Tayoun</surname>
            <given-names>AN</given-names>
          </name>
        </person-group>
        <article-title>Evaluating the impact of in silico predictors on clinical variant classification</article-title>
        <source>Genet Med</source>
        <year>2022</year>
        <volume>24</volume>
        <issue>4</issue>
        <fpage>924</fpage>
        <lpage>930</lpage>
        <pub-id pub-id-type="doi">10.1016/j.gim.2021.11.018</pub-id>
        <?supplied-pmid 34955381?>
        <pub-id pub-id-type="pmid">34955381</pub-id>
      </element-citation>
    </ref>
  </ref-list>
</back>
<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName A++V2.4.dtd?>
<?SourceDTD.Version 2.4?>
<?ConverterInfo.XSLTName springer2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Genome Med</journal-id>
    <journal-id journal-id-type="iso-abbrev">Genome Med</journal-id>
    <journal-title-group>
      <journal-title>Genome Medicine</journal-title>
    </journal-title-group>
    <issn pub-type="epub">1756-994X</issn>
    <publisher>
      <publisher-name>BioMed Central</publisher-name>
      <publisher-loc>London</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">10773112</article-id>
    <article-id pub-id-type="pmid">38185709</article-id>
    <article-id pub-id-type="publisher-id">1274</article-id>
    <article-id pub-id-type="doi">10.1186/s13073-023-01274-4</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Method</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>MAGPIE: accurate pathogenic prediction for multiple variant types using machine learning approach</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author" equal-contrib="yes">
        <name>
          <surname>Liu</surname>
          <given-names>Yicheng</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <contrib contrib-type="author" equal-contrib="yes">
        <name>
          <surname>Zhang</surname>
          <given-names>Tianyun</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>You</surname>
          <given-names>Ningyuan</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <name>
          <surname>Wu</surname>
          <given-names>Sai</given-names>
        </name>
        <address>
          <email>wusai@zju.edu.cn</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0003-4709-3374</contrib-id>
        <name>
          <surname>Shen</surname>
          <given-names>Ning</given-names>
        </name>
        <address>
          <email>shenningzju@zju.edu.cn</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <aff id="Aff1"><label>1</label><institution-wrap><institution-id institution-id-type="GRID">grid.13402.34</institution-id><institution-id institution-id-type="ISNI">0000 0004 1759 700X</institution-id><institution>Department of Hepatobiliary and Pancreatic Surgery, First Affiliated &gt; Hospital &amp; Liangzhu Laboratory, </institution><institution>Zhejiang University School of Medicine, </institution></institution-wrap>Hangzhou, 311121 China </aff>
      <aff id="Aff2"><label>2</label><institution-wrap><institution-id institution-id-type="ROR">https://ror.org/00a2xv884</institution-id><institution-id institution-id-type="GRID">grid.13402.34</institution-id><institution-id institution-id-type="ISNI">0000 0004 1759 700X</institution-id><institution>College of Computer Science, </institution><institution>Zhejiang University, </institution></institution-wrap>Yuquan Campus, Zhejiang University, Rd Zheda 38, Xihu District, Hangzhou, 310007 China </aff>
    </contrib-group>
    <pub-date pub-type="epub">
      <day>8</day>
      <month>1</month>
      <year>2024</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>8</day>
      <month>1</month>
      <year>2024</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2024</year>
    </pub-date>
    <volume>16</volume>
    <elocation-id>3</elocation-id>
    <history>
      <date date-type="received">
        <day>14</day>
        <month>8</month>
        <year>2023</year>
      </date>
      <date date-type="accepted">
        <day>12</day>
        <month>12</month>
        <year>2023</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2023, corrected publication 2024</copyright-statement>
      <license>
        <ali:license_ref specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p><bold>Open Access</bold> This article is licensed under a Creative Commons Attribution 4.0 International License, which permits use, sharing, adaptation, distribution and reproduction in any medium or format, as long as you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons licence, and indicate if changes were made. The images or other third party material in this article are included in the article's Creative Commons licence, unless indicated otherwise in a credit line to the material. If material is not included in the article's Creative Commons licence and your intended use is not permitted by statutory regulation or exceeds the permitted use, you will need to obtain permission directly from the copyright holder. To view a copy of this licence, visit <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>. The Creative Commons Public Domain Dedication waiver (<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/publicdomain/zero/1.0/">http://creativecommons.org/publicdomain/zero/1.0/</ext-link>) applies to the data made available in this article, unless otherwise stated in a credit line to the data.</license-p>
      </license>
    </permissions>
    <abstract id="Abs1">
      <p id="Par1">Identifying pathogenic variants from the vast majority of nucleotide variation remains a challenge. We present a method named Multimodal Annotation Generated Pathogenic Impact Evaluator (MAGPIE) that predicts the pathogenicity of multi-type variants. MAGPIE uses the ClinVar dataset for training and demonstrates superior performance in both the independent test set and multiple orthogonal validation datasets, accurately predicting variant pathogenicity. Notably, MAGPIE performs best in predicting the pathogenicity of rare variants and highly imbalanced datasets. Overall, results underline the robustness of MAGPIE as a valuable tool for predicting pathogenicity in various types of human genome variations. MAGPIE is available at <ext-link ext-link-type="uri" xlink:href="https://github.com/shenlab-genomics/magpie">https://github.com/shenlab-genomics/magpie</ext-link>.</p>
      <sec>
        <title>Supplementary Information</title>
        <p>The online version contains supplementary material available at 10.1186/s13073-023-01274-4.</p>
      </sec>
    </abstract>
    <kwd-group xml:lang="en">
      <title>Keywords</title>
      <kwd>Pathogenic prediction</kwd>
      <kwd>Multimodal annotation</kwd>
      <kwd>Machine learning</kwd>
      <kwd>Genomic variation</kwd>
    </kwd-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution>Liangzhu Laboratory</institution>
        </funding-source>
      </award-group>
    </funding-group>
    <custom-meta-group>
      <custom-meta>
        <meta-name>issue-copyright-statement</meta-name>
        <meta-value>© BioMed Central Ltd., part of Springer Nature 2024</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec id="Sec1">
    <title>Background</title>
    <p id="Par57">The rapid accumulation of the whole genome sequencing (WGS) and the whole exome sequencing (WES) data has led to the discovery of a tremendous number of genetic variations, both pathogenic and non-pathogenic. To aid the assessment and understanding of these variations, population databases such as gnomAD [<xref ref-type="bibr" rid="CR1">1</xref>], ExAC [<xref ref-type="bibr" rid="CR2">2</xref>], and ChinaMap [<xref ref-type="bibr" rid="CR3">3</xref>] have been established. Additionally, genetic disease databases, e.g., ClinVar [<xref ref-type="bibr" rid="CR4">4</xref>], OMIM [<xref ref-type="bibr" rid="CR5">5</xref>], and HGMD [<xref ref-type="bibr" rid="CR6">6</xref>], have also amassed a large amount of information on known pathogenic or benign genetic variations. These databases have been widely used as references in the genetic diagnosis of Mendelian diseases.</p>
    <p id="Par58">Pathogenic mutations that cause Mendelian diseases are known to function through various biological mechanisms and thus have been categorized and studied in different aspects. For instance, exonic mutations based on the protein sequence alterations are categorized into synonymous, missense, stop-gain, stop-loss, frameshift, etc. Synonymous mutations do not alter protein sequence, whereas missense mutations result in different amino acids being encoded. Since missense mutation-associated changes in protein sequence may potentially be pathogenic, various studies have focused on predicting the pathogenic impact of missense variants [<xref ref-type="bibr" rid="CR7">7</xref>–<xref ref-type="bibr" rid="CR17">17</xref>]. On the other hand, some mutations are pathogenic at the RNA level through splicing alterations, and these mutations are often located in the splicing donor, acceptor, and intronic regions. Consequently, splicing alterations have also been considered for the pathogenicity evaluation of mutations [<xref ref-type="bibr" rid="CR18">18</xref>, <xref ref-type="bibr" rid="CR19">19</xref>]. However, in clinical practice of genetic diagnosis using WES, different types of mutations and mechanisms should be considered simultaneously to identify the pathogenic mutation.</p>
    <p id="Par59">With the development of machine learning (ML) and deep learning (DL), many computational methods using ML or DL have been developed for predicting mutation disruption or pathogenicity. Some methods were developed based on specific biological mechanisms or data types. For example, SpliceAI employs a deep neural network to learn information about splicing codes of the genome and predict whether a mutation affects splicing [<xref ref-type="bibr" rid="CR19">19</xref>]. Frazer et al. proposed the evolutionary model of variant effect (EVE) based on a deep generation model of evolutionary data to predict the pathogenicity of human missense variants [<xref ref-type="bibr" rid="CR16">16</xref>]. On the other hand, some algorithms consider ensemble features from multiple aspects and build on top of existing pathogenicity prediction. For example, the Combined Annotation-Dependent Depletion (CADD) implements a support vector machine with annotation features in conservation metrics, regulatory information, transcript information, and so on [<xref ref-type="bibr" rid="CR20">20</xref>]. Daniel et al. proposed DANN, which uses the same features as CADD but integrates them into a deep neural network for better performance [<xref ref-type="bibr" rid="CR21">21</xref>]. REVEL is another approach proposed by Nilah et al. that uses a logistic regression model and relies on multiple pathogenicity prediction tools, including MutPred [<xref ref-type="bibr" rid="CR22">22</xref>], VEST [<xref ref-type="bibr" rid="CR14">14</xref>], PROVEAN [<xref ref-type="bibr" rid="CR9">9</xref>], Mutation Assessor [<xref ref-type="bibr" rid="CR11">11</xref>], and phastCons [<xref ref-type="bibr" rid="CR23">23</xref>]. Although the aforementioned methods are widely used or developed with state-of-the-art methods, they only apply to specific cases or depend on multiple prediction tools, leaving many genetic variants unpredictable in real-world prediction tasks.</p>
    <p id="Par60">In this study, we present MAGPIE (Multimodal Annotation Generated Pathogenic Impact Evaluator), a pathogenicity prediction tool for all nonsynonymous exonic variants. MAGPIE employs multimodal annotation to annotate all exonic variants to cope with various mutation types and pathogenic mechanisms. The idea is that from the user’s perspective, the pathogenicity of a variant should be jointly evaluated on multiple scopes, and MAGPIE can help automate this process by leveraging the modern machine learning methodologies. We benchmarked MAGPIE against 14 previously published methods and found that MAGPIE outperformed all other methods in both independent test set and several imbalanced orthogonal validation sets. Notably, MAGPIE was able to make predictions on multiple types of exonic mutations, fulfilling 5–60% of unapplicable missing values based on previous methods. Most importantly, the superior performance of MAGPIE in highly imbalanced validation dataset, as well as variants with low population allele frequency highlights its advantage in clinically relevant applications of interpreting VUS for individual patients, where the model is typically applied to identify less than 5% pathogenic variants from tens of thousands of candidate variants. We envision that MAGPIE will be a valuable tool and widely adopted for pathogenicity prediction in the field. MAGPIE is available as an online server at <ext-link ext-link-type="uri" xlink:href="http://tools.shenlab-genomics.org/tools/MAGPIE">http://tools.shenlab-genomics.org/tools/MAGPIE</ext-link>.</p>
  </sec>
  <sec id="Sec2">
    <title>Methods</title>
    <sec id="Sec3">
      <title>Data preparation</title>
      <p id="Par61">We ensemble several germline mutation databases as the source of our datasets. Germline mutations are changes to DNA that individuals inherit from the egg and sperm cells during conception. ClinVar database (<ext-link ext-link-type="uri" xlink:href="https://ftp.ncbi.nlm.nih.gov/pub/clinvar/">https://ftp.ncbi.nlm.nih.gov/pub/clinvar/</ext-link>, accessed 2022.6.24) was downloaded and included nonsynonymous SNV (missense variants), stop-gain variants, start-loss variants, frameshift mutations, nonframeshift mutations, and stop-loss variants [<xref ref-type="bibr" rid="CR4">4</xref>]. Variants were categorized as benign, including Likely_benign, Benign, and Benign/Likely_benign labels, and pathogenic, including Likely_pathogenic, Pathogenic, and Pathogenic/Likely_pathogenic, which were selected as true negative (benign) and true positive (pathogenic) labels respectively. All variants with conflicting interpretations and unknown labels were removed. After filtering, we initially identified 78,089 mutations from ClinVar.</p>
      <p id="Par62">To improve the model performance in classifying rare variants, we considered adding rare benign variants to the training dataset as a trade-off between preserving the importance of allele frequency information and helping identify rare pathogenic variants from rare benign variants. We selected ultra-rare benign variants with allele frequency between <inline-formula id="IEq1"><alternatives><tex-math id="M1">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$1{e}^{-5}$$\end{document}</tex-math><mml:math id="M2"><mml:mrow><mml:mn>1</mml:mn><mml:msup><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mn>5</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math><inline-graphic xlink:href="13073_2023_1274_Article_IEq1.gif"/></alternatives></inline-formula> and <inline-formula id="IEq2"><alternatives><tex-math id="M3">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$1{e}^{-3}$$\end{document}</tex-math><mml:math id="M4"><mml:mrow><mml:mn>1</mml:mn><mml:msup><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math><inline-graphic xlink:href="13073_2023_1274_Article_IEq2.gif"/></alternatives></inline-formula> based on the gnomAD database (<ext-link ext-link-type="uri" xlink:href="https://gnomad.broadinstitute.org/downloads/">https://gnomad.broadinstitute.org/downloads/</ext-link>, accessed 2022.09.14) [<xref ref-type="bibr" rid="CR1">1</xref>]. For most chromosomes, there existed about 500,000 available variants. Secondly, we randomly choose 5000 per chromosome. Thirdly, we filtered out variants without enough information after annotating by ANNOVAR (ANNOtate VARition). Finally, we randomly chose again and just retained 500 variants per chromosome. For chr11 and chrY, which did not contain enough variants, we kept them all and randomly used qualified ones in other chromosomes to fill the gap. In total, we incorporated 11,998 variants from gnomAD, and these variants were split into two subsets based on the proportion of the number of variants in ClinVar to that in SwissProt [<xref ref-type="bibr" rid="CR23">23</xref>] for further training and evaluation. We aim to enhance the model’s ability to deal with rare benign variants; thus, it is crucial to minimize the false positive rate influenced by the allele frequency to identify pathogenic variants in the clinical scenario.</p>
      <p id="Par63">We constructed an orthogonal validation set to evaluate the performance of our model. The orthogonal test set was constructed from SwissProt (<ext-link ext-link-type="uri" xlink:href="https://ftp.uniprot.org/pub/databases/uniprot/">https://ftp.uniprot.org/pub/databases/uniprot/</ext-link>, accessed 2022.7.10) [<xref ref-type="bibr" rid="CR23">23</xref>], which contains over 70,000 variants with validated pathogenicity labels. We selected exonic mutations, filtered out variants labeled as US (uncertain significance), and applied the filtering and transformation process to remove all synonymous SNVs, following the same steps used in the ClinVar training and test datasets.</p>
      <p id="Par64">We obtained the ACMG-guided dataset (10.1016/j.gim.2021.11.018, accessed 2023.05.22), which includes a total of 1270 mutations, from the official website as another orthogonal test panel. We first removed 328 mutations without clear clinical significance labeled as uncertain significance—insufficient evidence or uncertain significance—conflicting evidence, 93 variants whose position cannot be mapped from HGVS ID, 358 intronic, 3′ UTR, and 5′ UTR variants, splice sites, and synonymous SNVs, etc., to ensure a fair comparison with other methods (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S3). After filtering, a final dataset of 491 missense mutations was used to compare MAGPIE and other model performances.</p>
      <p id="Par65">Gene-level features encapsulate characteristics that are relevant to genes and are shared across variants within the same gene. As we used gene-level features, variants in the same gene share identical scores for these gene-level features, and it would cause some potential biases and label leakage. Therefore, we performed a random split according to genes. Let <inline-formula id="IEq3"><alternatives><tex-math id="M5">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$D$$\end{document}</tex-math><mml:math id="M6"><mml:mi>D</mml:mi></mml:math><inline-graphic xlink:href="13073_2023_1274_Article_IEq3.gif"/></alternatives></inline-formula> as the dataset to be split; <inline-formula id="IEq4"><alternatives><tex-math id="M7">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$A$$\end{document}</tex-math><mml:math id="M8"><mml:mi>A</mml:mi></mml:math><inline-graphic xlink:href="13073_2023_1274_Article_IEq4.gif"/></alternatives></inline-formula> and <inline-formula id="IEq5"><alternatives><tex-math id="M9">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$B$$\end{document}</tex-math><mml:math id="M10"><mml:mi>B</mml:mi></mml:math><inline-graphic xlink:href="13073_2023_1274_Article_IEq5.gif"/></alternatives></inline-formula> are datasets after splitting; <inline-formula id="IEq6"><alternatives><tex-math id="M11">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${L}_{A}$$\end{document}</tex-math><mml:math id="M12"><mml:msub><mml:mi>L</mml:mi><mml:mi>A</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13073_2023_1274_Article_IEq6.gif"/></alternatives></inline-formula>, <inline-formula id="IEq7"><alternatives><tex-math id="M13">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${L}_{B}$$\end{document}</tex-math><mml:math id="M14"><mml:msub><mml:mi>L</mml:mi><mml:mi>B</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13073_2023_1274_Article_IEq7.gif"/></alternatives></inline-formula>, and <inline-formula id="IEq8"><alternatives><tex-math id="M15">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${L}_{D}$$\end{document}</tex-math><mml:math id="M16"><mml:msub><mml:mi>L</mml:mi><mml:mi>D</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13073_2023_1274_Article_IEq8.gif"/></alternatives></inline-formula> are lists containing genes for datasets <inline-formula id="IEq9"><alternatives><tex-math id="M17">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$A$$\end{document}</tex-math><mml:math id="M18"><mml:mi>A</mml:mi></mml:math><inline-graphic xlink:href="13073_2023_1274_Article_IEq9.gif"/></alternatives></inline-formula> and <inline-formula id="IEq10"><alternatives><tex-math id="M19">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$B$$\end{document}</tex-math><mml:math id="M20"><mml:mi>B</mml:mi></mml:math><inline-graphic xlink:href="13073_2023_1274_Article_IEq10.gif"/></alternatives></inline-formula>; and let <inline-formula id="IEq11"><alternatives><tex-math id="M21">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$D$$\end{document}</tex-math><mml:math id="M22"><mml:mi>D</mml:mi></mml:math><inline-graphic xlink:href="13073_2023_1274_Article_IEq11.gif"/></alternatives></inline-formula> and <inline-formula id="IEq12"><alternatives><tex-math id="M23">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$N$$\end{document}</tex-math><mml:math id="M24"><mml:mi>N</mml:mi></mml:math><inline-graphic xlink:href="13073_2023_1274_Article_IEq12.gif"/></alternatives></inline-formula> as the proportion threshold of variants that should be added to <inline-formula id="IEq13"><alternatives><tex-math id="M25">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$A$$\end{document}</tex-math><mml:math id="M26"><mml:mi>A</mml:mi></mml:math><inline-graphic xlink:href="13073_2023_1274_Article_IEq13.gif"/></alternatives></inline-formula> and <inline-formula id="IEq14"><alternatives><tex-math id="M27">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${n}_{A}$$\end{document}</tex-math><mml:math id="M28"><mml:msub><mml:mi>n</mml:mi><mml:mi>A</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13073_2023_1274_Article_IEq14.gif"/></alternatives></inline-formula> as the realtime proportion of <inline-formula id="IEq15"><alternatives><tex-math id="M29">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$A$$\end{document}</tex-math><mml:math id="M30"><mml:mi>A</mml:mi></mml:math><inline-graphic xlink:href="13073_2023_1274_Article_IEq15.gif"/></alternatives></inline-formula> accounts for <inline-formula id="IEq16"><alternatives><tex-math id="M31">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$D$$\end{document}</tex-math><mml:math id="M32"><mml:mi>D</mml:mi></mml:math><inline-graphic xlink:href="13073_2023_1274_Article_IEq16.gif"/></alternatives></inline-formula>. After completing these steps, the resulting datasets would be as follows: <inline-formula id="IEq17"><alternatives><tex-math id="M33">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${L}_{A}$$\end{document}</tex-math><mml:math id="M34"><mml:msub><mml:mi>L</mml:mi><mml:mi>A</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13073_2023_1274_Article_IEq17.gif"/></alternatives></inline-formula> contains the randomly selected genes from <inline-formula id="IEq18"><alternatives><tex-math id="M35">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${L}_{D}$$\end{document}</tex-math><mml:math id="M36"><mml:msub><mml:mi>L</mml:mi><mml:mi>D</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13073_2023_1274_Article_IEq18.gif"/></alternatives></inline-formula>. <inline-formula id="IEq19"><alternatives><tex-math id="M37">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${L}_{B}$$\end{document}</tex-math><mml:math id="M38"><mml:msub><mml:mi>L</mml:mi><mml:mi>B</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13073_2023_1274_Article_IEq19.gif"/></alternatives></inline-formula> is the remaining genes in <inline-formula id="IEq20"><alternatives><tex-math id="M39">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${L}_{D}$$\end{document}</tex-math><mml:math id="M40"><mml:msub><mml:mi>L</mml:mi><mml:mi>D</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13073_2023_1274_Article_IEq20.gif"/></alternatives></inline-formula> after removing the selected genes. Datasets <inline-formula id="IEq21"><alternatives><tex-math id="M41">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$A$$\end{document}</tex-math><mml:math id="M42"><mml:mi>A</mml:mi></mml:math><inline-graphic xlink:href="13073_2023_1274_Article_IEq21.gif"/></alternatives></inline-formula> and <inline-formula id="IEq22"><alternatives><tex-math id="M43">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$B$$\end{document}</tex-math><mml:math id="M44"><mml:mi>B</mml:mi></mml:math><inline-graphic xlink:href="13073_2023_1274_Article_IEq22.gif"/></alternatives></inline-formula> consist of mutations occurring in genes belonging to categories <inline-formula id="IEq23"><alternatives><tex-math id="M45">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${L}_{A}$$\end{document}</tex-math><mml:math id="M46"><mml:msub><mml:mi>L</mml:mi><mml:mi>A</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13073_2023_1274_Article_IEq23.gif"/></alternatives></inline-formula> and <inline-formula id="IEq24"><alternatives><tex-math id="M47">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${L}_{B}$$\end{document}</tex-math><mml:math id="M48"><mml:msub><mml:mi>L</mml:mi><mml:mi>B</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13073_2023_1274_Article_IEq24.gif"/></alternatives></inline-formula> within dataset <inline-formula id="IEq25"><alternatives><tex-math id="M49">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$D$$\end{document}</tex-math><mml:math id="M50"><mml:mi>D</mml:mi></mml:math><inline-graphic xlink:href="13073_2023_1274_Article_IEq25.gif"/></alternatives></inline-formula>, respectively. We defined the splitting process in Algorithm 1:<fig position="anchor" id="Figa"><caption><p><bold>Algorithm 1.</bold> Dataset split</p></caption><graphic position="anchor" xlink:href="13073_2023_1274_Figa_HTML" id="MO1"/></fig></p>
      <p id="Par66">First, to further enhance the robustness of MAGPIE and ensure a fair comparison, we split the gnomAD dataset. Let <inline-formula id="IEq26"><alternatives><tex-math id="M51">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${n}_{ClinVar}$$\end{document}</tex-math><mml:math id="M52"><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi mathvariant="italic">ClinVar</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13073_2023_1274_Article_IEq26.gif"/></alternatives></inline-formula>, <inline-formula id="IEq27"><alternatives><tex-math id="M53">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${n}_{SwissProt}$$\end{document}</tex-math><mml:math id="M54"><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi mathvariant="italic">SwissProt</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13073_2023_1274_Article_IEq27.gif"/></alternatives></inline-formula>, and <inline-formula id="IEq28"><alternatives><tex-math id="M55">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${n}_{gnomAD}$$\end{document}</tex-math><mml:math id="M56"><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi mathvariant="italic">gnomAD</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13073_2023_1274_Article_IEq28.gif"/></alternatives></inline-formula> denote the number of variants in ClinVar, SwissProt, and gnomAD, respectively. We define dataset <inline-formula id="IEq29"><alternatives><tex-math id="M57">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$D$$\end{document}</tex-math><mml:math id="M58"><mml:mi>D</mml:mi></mml:math><inline-graphic xlink:href="13073_2023_1274_Article_IEq29.gif"/></alternatives></inline-formula> as gnomAD, threshold <inline-formula id="IEq30"><alternatives><tex-math id="M59">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$N$$\end{document}</tex-math><mml:math id="M60"><mml:mi>N</mml:mi></mml:math><inline-graphic xlink:href="13073_2023_1274_Article_IEq30.gif"/></alternatives></inline-formula> as <inline-formula id="IEq31"><alternatives><tex-math id="M61">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${n}_{ClinVar}/\left({n}_{ClinVar}+{n}_{SwissProt}\right)*{n}_{gnomAD}$$\end{document}</tex-math><mml:math id="M62"><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi mathvariant="italic">ClinVar</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">/</mml:mo><mml:mfenced close=")" open="("><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi mathvariant="italic">ClinVar</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi mathvariant="italic">SwissProt</mml:mi></mml:mrow></mml:msub></mml:mfenced><mml:mrow/><mml:mo>∗</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi mathvariant="italic">gnomAD</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="13073_2023_1274_Article_IEq31.gif"/></alternatives></inline-formula>, and randomly split <inline-formula id="IEq32"><alternatives><tex-math id="M63">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$D$$\end{document}</tex-math><mml:math id="M64"><mml:mi>D</mml:mi></mml:math><inline-graphic xlink:href="13073_2023_1274_Article_IEq32.gif"/></alternatives></inline-formula> into <inline-formula id="IEq33"><alternatives><tex-math id="M65">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$A$$\end{document}</tex-math><mml:math id="M66"><mml:mi>A</mml:mi></mml:math><inline-graphic xlink:href="13073_2023_1274_Article_IEq33.gif"/></alternatives></inline-formula> and <inline-formula id="IEq34"><alternatives><tex-math id="M67">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$B$$\end{document}</tex-math><mml:math id="M68"><mml:mi>B</mml:mi></mml:math><inline-graphic xlink:href="13073_2023_1274_Article_IEq34.gif"/></alternatives></inline-formula> which are then added to ClinVar and SwissProt, respectively. We named these two datasets as ClinVar_gnomAD and SwissProt_gnomAD. Second, we defined dataset <inline-formula id="IEq35"><alternatives><tex-math id="M69">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$D$$\end{document}</tex-math><mml:math id="M70"><mml:mi>D</mml:mi></mml:math><inline-graphic xlink:href="13073_2023_1274_Article_IEq35.gif"/></alternatives></inline-formula> as <inline-formula id="IEq36"><alternatives><tex-math id="M71">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ClinVar_{gnomAD}$$\end{document}</tex-math><mml:math id="M72"><mml:mrow><mml:mi>C</mml:mi><mml:mi>l</mml:mi><mml:mi>i</mml:mi><mml:mi>n</mml:mi><mml:mi>V</mml:mi><mml:mi>a</mml:mi><mml:msub><mml:mi>r</mml:mi><mml:mrow><mml:mi mathvariant="italic">gnomAD</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="13073_2023_1274_Article_IEq36.gif"/></alternatives></inline-formula>, threshold <inline-formula id="IEq37"><alternatives><tex-math id="M73">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$N$$\end{document}</tex-math><mml:math id="M74"><mml:mi>N</mml:mi></mml:math><inline-graphic xlink:href="13073_2023_1274_Article_IEq37.gif"/></alternatives></inline-formula> as <inline-formula id="IEq38"><alternatives><tex-math id="M75">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\left({n}_{ClinVar}+{n}_{ClinVar}/\left({n}_{ClinVar}+{n}_{SwissProt}\right)*{n}_{gnomAD}\right)*10\%$$\end{document}</tex-math><mml:math id="M76"><mml:mrow><mml:mfenced close=")" open="("><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi mathvariant="italic">ClinVar</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi mathvariant="italic">ClinVar</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">/</mml:mo><mml:mfenced close=")" open="("><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi mathvariant="italic">ClinVar</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi mathvariant="italic">SwissProt</mml:mi></mml:mrow></mml:msub></mml:mfenced><mml:mrow/><mml:mo>∗</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi mathvariant="italic">gnomAD</mml:mi></mml:mrow></mml:msub></mml:mfenced><mml:mrow/><mml:mo>∗</mml:mo><mml:mn>10</mml:mn><mml:mo>%</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="13073_2023_1274_Article_IEq38.gif"/></alternatives></inline-formula> and randomly split <inline-formula id="IEq39"><alternatives><tex-math id="M77">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$D$$\end{document}</tex-math><mml:math id="M78"><mml:mi>D</mml:mi></mml:math><inline-graphic xlink:href="13073_2023_1274_Article_IEq39.gif"/></alternatives></inline-formula> into <inline-formula id="IEq40"><alternatives><tex-math id="M79">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$A$$\end{document}</tex-math><mml:math id="M80"><mml:mi>A</mml:mi></mml:math><inline-graphic xlink:href="13073_2023_1274_Article_IEq40.gif"/></alternatives></inline-formula> and <inline-formula id="IEq41"><alternatives><tex-math id="M81">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$B$$\end{document}</tex-math><mml:math id="M82"><mml:mi>B</mml:mi></mml:math><inline-graphic xlink:href="13073_2023_1274_Article_IEq41.gif"/></alternatives></inline-formula>, namely training and independent test set respectively. Finally, we excluded all variants in <inline-formula id="IEq42"><alternatives><tex-math id="M83">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$SwissProt_{gnomAD}$$\end{document}</tex-math><mml:math id="M84"><mml:mrow><mml:mi>S</mml:mi><mml:mi>w</mml:mi><mml:mi>i</mml:mi><mml:mi>s</mml:mi><mml:mi>s</mml:mi><mml:mi>P</mml:mi><mml:mi>r</mml:mi><mml:mi>o</mml:mi><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi mathvariant="italic">gnomAD</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="13073_2023_1274_Article_IEq42.gif"/></alternatives></inline-formula> located on genes that appear in ClinVarTraining and defined it as an orthogonal validation set.</p>
    </sec>
    <sec id="Sec4">
      <title>MAGPIE framework</title>
      <p id="Par67">The machine learning component of MAGPIE is based on a gradient-boosting tree-based model of classifying pathogenic and benign variants, which includes three steps. First, we annotated candidate SNVs to obtain information needed for model training. Second, we used automated feature engineering to pull out meaningful features from the datasets, and then we designed a feature selection strategy to obtain the optimal combination of features to feed the model. Finally, we trained the model using the processed dataset with step-wise tuning to make the process controllable and avoid overfitting.</p>
      <p id="Par68">The whole framework in this paper was mainly implemented in Python (v3.7) [<xref ref-type="bibr" rid="CR24">24</xref>] and MATLAB [<xref ref-type="bibr" rid="CR25">25</xref>], and other models were built using the sklearn (v0.21.3) package [<xref ref-type="bibr" rid="CR26">26</xref>].</p>
    </sec>
    <sec id="Sec5">
      <title>Feature annotation</title>
      <p id="Par69">We annotated candidate SNVs with ANNOVAR (24 October 2019, latest version) [<xref ref-type="bibr" rid="CR27">27</xref>] and included predicted scores provided by SpliceAI [<xref ref-type="bibr" rid="CR19">19</xref>].</p>
      <p id="Par70">As for feature selection, we used ANNOVAR, SpliceAI, and the ChromHMM [<xref ref-type="bibr" rid="CR28">28</xref>] model to annotate candidate variants and ended up with 132 features. To narrow down the number of features, we applied several models on the ClinVar dataset with all these features and kept the models that satisfied over 95% accuracy on the validation set. Then, we calculated feature importance of all input features based on these models and filtered out features whose contribution to the models is less than <inline-formula id="IEq43"><alternatives><tex-math id="M85">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$1{e}^{-3}$$\end{document}</tex-math><mml:math id="M86"><mml:mrow><mml:mn>1</mml:mn><mml:msup><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math><inline-graphic xlink:href="13073_2023_1274_Article_IEq43.gif"/></alternatives></inline-formula>. The number of features was reduced to 60 and below. We will describe these features in detail (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S4-S5).</p>
      <p id="Par71">For further training, we included six different types of variant classifications, namely nonsynonymous SNV (missense), startloss, stopgain, stoploss, frameshift, and non-frameshift. For each type of variant, 60 features were retrieved from the annotated datasets, including six categories: (1) epigenomics, (2) functional effects, (3) splicing effects, (4) population-based features, (5) biochemical properties, and (6) conservation (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S4-S5). And in our model, we excluded all predicted scores from variant pathogenicity prediction tools to minimize the effects of prior bias.</p>
      <p id="Par72">Epigenomics of each variant was annotated by the 15-state ChromHMM model across nine different cell lines in order to capture the significant combinatorial interactions between different chromatin marks in their spatial context (chromatin states). Functional effects included the gene damage index (GDI), residual variation intolerance score (RVIS), gene intolerance scores based on the loss of function tool (LoFtool), variant types, and annotations from the OMIM database. We use variant types as features including missense, frameshift, nonframeshift, startloss, stopgain, and stoploss. We use the OMIM database to annotate the mutation inheritance pattern, which is categorized into five distinct types: autosomal recessive, autosomal dominant, X-linked recessive, X-linked dominant, and others. Epigenomics features, variant type features, and mutation inheritance pattern features are one-hot encoded and fed into the model for training.</p>
      <p id="Par73">SpliceAI annotated each variant with its predicted effect on splicing. The delta score of the variant represents the probability of the variant being splice-altering as acceptor gain (DS_AG), acceptor loss (DS_AL), donor gain (DS_DG), and donor loss (DS_DL). Furthermore, we also obtained information about the location where splicing changes relative to the variant position, which included the delta position of acceptor gain (DP_AG), acceptor loss (DP_AL), donor gain (DP_DG), and donor loss (DP_DL). SpliceAI does not annotate variants if they are close to chromosome ends or too long reference sequences. We use 0 to fill in missing values of SpliceAI prediction.</p>
      <p id="Par74">Population-based features represented the incidence of an allele in a population, including 12 different types of allele frequencies (AF). We retrieved AF in various populations: all exome, raw allele frequency (AF_raw), African (AF_afr), Latino/Admixed American (AF_amr), Ashkenazi Jewish (AF_asj), East Asian (AF_eas), Finnish in Finland (AF_fin), Non-Finnish European (AF_nfe), and other (AF_oth). Besides, allele frequencies in different genders were also obtained from annotated information.</p>
      <p id="Par75">Biochemical properties contain the effects of amino acid changes before and after mutations. We first checked whether the mutation causes an amino acid change, and if not, we assigned 0 to all relevant features. Amino acid change (AAchange) was used as the basis for subsequent annotation. We stored the physicochemical properties of each amino acid, including molecular weight, equipotential point, dissociation constant, hydrophilicity, polarity, acid–base, etc., in a matrix, in which the characteristics of Boolean type were represented by 1/0. We obtained the corresponding properties of the amino acids by querying the matrix and took the delta value between the properties before and after the mutation as the features of the mutation. We then employed different strategies for different types of variants since some variants cause multiple amino acid changes, which require specific handling. When a mutation affects more than one amino acid, we calculate the average value before and after the change, respectively, to ensure that the feature selection process is comprehensively representative. We also used the information obtained from the BLOSUM100 matrix as a feature to demonstrate the conservation and similarity of amino acid substitutions.</p>
      <p id="Par76">Conservation scores included phastCons 20way mammalian, 30way mammalian, 100way mammalian, 100way vertebrate; phyloP 20way mammalian, 30way mammalian, 100way vertebrate; and odds ratios of SiPhy 29way mammalian.</p>
      <p id="Par77">We use the Bayesian PCA-based missing value estimation method by Oba et al. [<xref ref-type="bibr" rid="CR29">29</xref>] to impute missing values for several features in preparing the next steps, and any outliers that may arise from extensive imputation are carefully removed from our analysis.</p>
    </sec>
    <sec id="Sec6">
      <title>Feature engineering and selection</title>
      <p id="Par78">We applied automated feature engineering on our training dataset to generate tens of thousands of candidate features to capture potential non-linear and more complex relationships within the data.</p>
      <p id="Par79">We first generate new features based on mathematical transformations of the existing numerical features. AutoFE (automatically feature engineering) applied operations such as logarithms, square roots, and exponentials to the original features. Next, we created new categorical features by grouping the original features based on their values. For example, we grouped conservation scores into categories by binning. These categorical features could capture relationships that might not be easily captured by the original numerical ones. We use the openFE [<xref ref-type="bibr" rid="CR30">30</xref>] package to perform autoFE.</p>
      <p id="Par80">After generating these new features, we used the default method defined in openFE to perform feature selection to remove any redundant or irrelevant features. OpenFE evaluated the importance of each feature and removed those that did not contribute significantly to the model’s predictive power. Even though the dataset still contains over 3000 features for each variant, which could lead to over-fitting. So, we stepped further based on openFE to perform separated feature selection (SFS).</p>
      <p id="Par81">In our study, we segregated all features into two categories, namely a core set and an add-on set. The former included features related to pathogenicity with validated evidence, such as population-based features, conservation, and functional effects. These features were retained during the training phase. The latter comprised additional features, including biochemical properties, splicing effects, epigenomics, and automated feature-engineered features. We then employed a feature selection process to determine the most important ones for feeding our model. We initially trained a simplified tree-based model for less than 50 rounds to reduce the features to 200 or less. Subsequently, after each round, we evaluated the importance of each feature and discarded those with relative importance scores lower than <inline-formula id="IEq44"><alternatives><tex-math id="M87">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$1{e}^{-3}$$\end{document}</tex-math><mml:math id="M88"><mml:mrow><mml:mn>1</mml:mn><mml:msup><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math><inline-graphic xlink:href="13073_2023_1274_Article_IEq44.gif"/></alternatives></inline-formula>.</p>
      <p id="Par82">After analysis, we observed that the core features exhibited prominent significance compared to the entire set of features. To further enhance the performance of our model, we conducted training using feature combinations, as described in Algorithm 2, to attain the optimal amalgamation of features that would yield superior performance on the test set.<fig position="anchor" id="Figb"><caption><p><bold>Algorithm 2.</bold> Separated feature selection</p></caption><graphic position="anchor" xlink:href="13073_2023_1274_Figb_HTML" id="MO2"/></fig></p>
    </sec>
    <sec id="Sec7">
      <title>Model training</title>
      <p id="Par83">MAGPIE was based on a LightGBM (LGBM) model for predicting pathogenicity. LightGBM has a faster training speed and lower memory consumption than other tree-based models. To better learn from data and avoid over-fitting problems, especially as a tree-based model, we defined five rounds to train the model with 5-fold cross-validation in each round.</p>
      <p id="Par84">We first set the initialization parameters of the model, where boosting type is set to gbdt, and the learning rate was set to 0.1. The purpose of the first round was to improve the accuracy, so in this round, we mainly searched for the depth of trees (3–8) and the maximum number of leaf nodes per tree (5–100). Meanwhile, we set early-stopping to 50 to minimize the magnitude of overfitting. The next four rounds of tuning were to make a trade-off between reducing the overfitting and ensuring accuracy after the first round of tuning. In the second round, we adjusted <italic>max_bin</italic>, the number of segments in the histogram algorithm, to discretize the eigenvalues. The value of <italic>min_data_in_leaf</italic> depended on the number of sample trees and <italic>num_leaves</italic> in the training data. Setting it larger can avoid generating a too-deep tree. The third round of adjusting the focus on <italic>feature_fraction</italic> and <italic>bagging_fraction</italic> was to specify a certain percentage of samples from all data for training, which can reduce the variance at the cost of increasing the bias. So, in this step, we tried to reduce the sampling proportion as much as possible while ensuring accuracy. In the fourth round of adjustment, <italic>lambda_l1</italic> and <italic>lambda_l2</italic> were tuned, representing the L1 and L2 regularization terms, respectively, which were used to filter the features and control their influence in the model to prevent some features from greatly affecting the whole model. Finally, we adjusted <italic>min_split_gain</italic>, which means that node splitting will only be performed when the gain is more significant than our given threshold, which will greatly limit the growth of trees. Upon completing the training process, we observed no substantial decrease in accuracy and classification performance measures. This outcome indicates the generalization ability of the model extends far beyond the boundaries of the training dataset, thereby mitigating the issue of learning bias commonly associated within datasets.</p>
    </sec>
    <sec id="Sec8">
      <title>Evaluate and compare models by multiple metrics</title>
      <p id="Par85">To quantitatively evaluate model performance, we compared MAGPIE with 14 other predicted tools including ClinPred [<xref ref-type="bibr" rid="CR31">31</xref>], REVEL [<xref ref-type="bibr" rid="CR17">17</xref>], MetaSVM [<xref ref-type="bibr" rid="CR13">13</xref>], MetaLR [<xref ref-type="bibr" rid="CR13">13</xref>], VEST4 [<xref ref-type="bibr" rid="CR14">14</xref>], M-CAP [<xref ref-type="bibr" rid="CR32">32</xref>], MutationAssessor [<xref ref-type="bibr" rid="CR11">11</xref>], PrimateAI [<xref ref-type="bibr" rid="CR33">33</xref>], SIFT4G [<xref ref-type="bibr" rid="CR34">34</xref>], LIST-S2 [<xref ref-type="bibr" rid="CR35">35</xref>], DANN [<xref ref-type="bibr" rid="CR21">21</xref>], MutationTaster [<xref ref-type="bibr" rid="CR36">36</xref>], VARITY [<xref ref-type="bibr" rid="CR16">16</xref>], and MutPred [<xref ref-type="bibr" rid="CR22">22</xref>]. SIFT4G score less than 0.05 is putatively pathogenic according to the authors’ recommendation. For other tools that predict continuous values or probabilities of pathogenicity, we utilized the threshold recommended by the authors in the corresponding article to distinguish between the pathogenic and benign variants. 0.025 is used for M-CAP, 0.8 for Mutation Assessor and PrimateAI, 0.85 for LIST-S2, 0.3 for MutationTaster, 0.79 for MutPred, and 0.5 as the threshold for other prediction tools. Variants with scores greater than or equal to the threshold in the prediction results of each tool possessed to be pathogenic, and those less than the threshold were benign.</p>
      <p id="Par86">Due to the different distribution of pathogenic and benign mutations in both the balanced test set and the imbalanced orthogonal set, we used several different metrics to assess the predictive performance of the model, including accuracy, precision, recall, specificity, F1-score, G-mean, Matthew’s correlation coefficient (MCC). Compared with accuracy and F1-score, MCC, which considers all components in the confusion matrices, can be used even if datasets are very imbalanced. We illustrated curves and computed the area under the receiver operating characteristic (ROC) curve (AUC).<disp-formula id="Equa"><alternatives><tex-math id="M89">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\text{accuracy}}=\frac{TP+TN}{TP+FP+TN+FN}$$\end{document}</tex-math><mml:math id="M90" display="block"><mml:mrow><mml:mtext>accuracy</mml:mtext><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi>T</mml:mi><mml:mi>P</mml:mi><mml:mo>+</mml:mo><mml:mi>T</mml:mi><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mi>T</mml:mi><mml:mi>P</mml:mi><mml:mo>+</mml:mo><mml:mi>F</mml:mi><mml:mi>P</mml:mi><mml:mo>+</mml:mo><mml:mi>T</mml:mi><mml:mi>N</mml:mi><mml:mo>+</mml:mo><mml:mi>F</mml:mi><mml:mi>N</mml:mi></mml:mrow></mml:mfrac></mml:mrow></mml:math><graphic xlink:href="13073_2023_1274_Article_Equa.gif" position="anchor"/></alternatives></disp-formula><disp-formula id="Equb"><alternatives><tex-math id="M91">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\text{precision}}=\frac{TP}{TP+FP}$$\end{document}</tex-math><mml:math id="M92" display="block"><mml:mrow><mml:mtext>precision</mml:mtext><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi mathvariant="italic">TP</mml:mi></mml:mrow><mml:mrow><mml:mi>T</mml:mi><mml:mi>P</mml:mi><mml:mo>+</mml:mo><mml:mi>F</mml:mi><mml:mi>P</mml:mi></mml:mrow></mml:mfrac></mml:mrow></mml:math><graphic xlink:href="13073_2023_1274_Article_Equb.gif" position="anchor"/></alternatives></disp-formula><disp-formula id="Equc"><alternatives><tex-math id="M93">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\text{recall}}=\frac{TP}{TP+FN}$$\end{document}</tex-math><mml:math id="M94" display="block"><mml:mrow><mml:mtext>recall</mml:mtext><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi mathvariant="italic">TP</mml:mi></mml:mrow><mml:mrow><mml:mi>T</mml:mi><mml:mi>P</mml:mi><mml:mo>+</mml:mo><mml:mi>F</mml:mi><mml:mi>N</mml:mi></mml:mrow></mml:mfrac></mml:mrow></mml:math><graphic xlink:href="13073_2023_1274_Article_Equc.gif" position="anchor"/></alternatives></disp-formula><disp-formula id="Equd"><alternatives><tex-math id="M95">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\text{specificity}}=\frac{TN}{TN+FP}$$\end{document}</tex-math><mml:math id="M96" display="block"><mml:mrow><mml:mtext>specificity</mml:mtext><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi mathvariant="italic">TN</mml:mi></mml:mrow><mml:mrow><mml:mi>T</mml:mi><mml:mi>N</mml:mi><mml:mo>+</mml:mo><mml:mi>F</mml:mi><mml:mi>P</mml:mi></mml:mrow></mml:mfrac></mml:mrow></mml:math><graphic xlink:href="13073_2023_1274_Article_Equd.gif" position="anchor"/></alternatives></disp-formula><disp-formula id="Eque"><alternatives><tex-math id="M97">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\text{Fbeta}}-{\text{score}}=\frac{(1+{{\text{beta}}}^{2})({\text{recall}}\times {\text{precision}})}{{\text{recall}}+{\text{precision}}\times {{\text{beta}}}^{2}}$$\end{document}</tex-math><mml:math id="M98" display="block"><mml:mrow><mml:mtext>Fbeta</mml:mtext><mml:mo>-</mml:mo><mml:mtext>score</mml:mtext><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:msup><mml:mrow><mml:mtext>beta</mml:mtext></mml:mrow><mml:mn>2</mml:mn></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mtext>recall</mml:mtext><mml:mo>×</mml:mo><mml:mtext>precision</mml:mtext><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mtext>recall</mml:mtext><mml:mo>+</mml:mo><mml:mtext>precision</mml:mtext><mml:mo>×</mml:mo><mml:msup><mml:mrow><mml:mtext>beta</mml:mtext></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mfrac></mml:mrow></mml:math><graphic xlink:href="13073_2023_1274_Article_Eque.gif" position="anchor"/></alternatives></disp-formula><disp-formula id="Equf"><alternatives><tex-math id="M99">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$g-{\text{mean}}=\sqrt{{\text{recall}}\times {\text{specificity}}}$$\end{document}</tex-math><mml:math id="M100" display="block"><mml:mrow><mml:mi>g</mml:mi><mml:mo>-</mml:mo><mml:mtext>mean</mml:mtext><mml:mo>=</mml:mo><mml:msqrt><mml:mrow><mml:mtext>recall</mml:mtext><mml:mo>×</mml:mo><mml:mtext>specificity</mml:mtext></mml:mrow></mml:msqrt></mml:mrow></mml:math><graphic xlink:href="13073_2023_1274_Article_Equf.gif" position="anchor"/></alternatives></disp-formula><disp-formula id="Equg"><alternatives><tex-math id="M101">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$mcc=\frac{TP\times TN-FP\times FN}{\sqrt{(TP+FP)(TP+FN)(TN+FP)(TN+FN)}}$$\end{document}</tex-math><mml:math id="M102" display="block"><mml:mrow><mml:mi>m</mml:mi><mml:mi>c</mml:mi><mml:mi>c</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi>T</mml:mi><mml:mi>P</mml:mi><mml:mo>×</mml:mo><mml:mi>T</mml:mi><mml:mi>N</mml:mi><mml:mo>-</mml:mo><mml:mi>F</mml:mi><mml:mi>P</mml:mi><mml:mo>×</mml:mo><mml:mi>F</mml:mi><mml:mi>N</mml:mi></mml:mrow><mml:msqrt><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>T</mml:mi><mml:mi>P</mml:mi><mml:mo>+</mml:mo><mml:mi>F</mml:mi><mml:mi>P</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>T</mml:mi><mml:mi>P</mml:mi><mml:mo>+</mml:mo><mml:mi>F</mml:mi><mml:mi>N</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>T</mml:mi><mml:mi>N</mml:mi><mml:mo>+</mml:mo><mml:mi>F</mml:mi><mml:mi>P</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>T</mml:mi><mml:mi>N</mml:mi><mml:mo>+</mml:mo><mml:mi>F</mml:mi><mml:mi>N</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msqrt></mml:mfrac></mml:mrow></mml:math><graphic xlink:href="13073_2023_1274_Article_Equg.gif" position="anchor"/></alternatives></disp-formula><disp-formula id="Equh"><alternatives><tex-math id="M103">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\text{AUC}}=\frac{{\sum }_{i=1}^{n}{\text{Ran}}{k}_{i}-\frac{n\left(n+1\right)}{2}}{{n}_{{\text{positive}}}\times {n}_{{\text{negative}}}}$$\end{document}</tex-math><mml:math id="M104" display="block"><mml:mrow><mml:mtext>AUC</mml:mtext><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>n</mml:mi></mml:msubsup><mml:mtext>Ran</mml:mtext><mml:msub><mml:mi>k</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>-</mml:mo><mml:mfrac><mml:mrow><mml:mi>n</mml:mi><mml:mfenced close=")" open="("><mml:mi>n</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mfenced></mml:mrow><mml:mn>2</mml:mn></mml:mfrac></mml:mrow><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mtext>positive</mml:mtext></mml:msub><mml:mo>×</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mtext>negative</mml:mtext></mml:msub></mml:mrow></mml:mfrac></mml:mrow></mml:math><graphic xlink:href="13073_2023_1274_Article_Equh.gif" position="anchor"/></alternatives></disp-formula></p>
      <p id="Par87">Here, <inline-formula id="IEq45"><alternatives><tex-math id="M105">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$n$$\end{document}</tex-math><mml:math id="M106"><mml:mi>n</mml:mi></mml:math><inline-graphic xlink:href="13073_2023_1274_Article_IEq45.gif"/></alternatives></inline-formula> is the total number of samples, <inline-formula id="IEq46"><alternatives><tex-math id="M107">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${n}_{positive}$$\end{document}</tex-math><mml:math id="M108"><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi mathvariant="italic">positive</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13073_2023_1274_Article_IEq46.gif"/></alternatives></inline-formula> is the number of positive samples, <inline-formula id="IEq47"><alternatives><tex-math id="M109">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${n}_{negative}$$\end{document}</tex-math><mml:math id="M110"><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi mathvariant="italic">negative</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13073_2023_1274_Article_IEq47.gif"/></alternatives></inline-formula> is the number of negative samples, and <inline-formula id="IEq48"><alternatives><tex-math id="M111">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$Ran{k}_{i}$$\end{document}</tex-math><mml:math id="M112"><mml:mrow><mml:mi>R</mml:mi><mml:mi>a</mml:mi><mml:mi>n</mml:mi><mml:msub><mml:mi>k</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="13073_2023_1274_Article_IEq48.gif"/></alternatives></inline-formula> is the rank of the <inline-formula id="IEq49"><alternatives><tex-math id="M113">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$i$$\end{document}</tex-math><mml:math id="M114"><mml:mi>i</mml:mi></mml:math><inline-graphic xlink:href="13073_2023_1274_Article_IEq49.gif"/></alternatives></inline-formula>-th sample’s predicted value among all samples. For samples with the same predicted value, their ranks are averaged.</p>
      <p id="Par88">Most models are designed to handle specific variant types or rely heavily on crucial information such as protein structure predictions. As a result, if a variant falls outside the model’s scope or crucial information is unavailable, the pathogenicity prediction becomes challenging. To assess the performance of these prediction tools, we excluded variants without available results for each tool and generated a confusion matrix using the true labels to derive relevant metrics. In addition, we also compared the performance of these tools on unpredictable variants by classifying the variants without predicted results as benign.</p>
    </sec>
    <sec id="Sec9">
      <title>Feature importance</title>
      <p id="Par89">The utilization of autoFE has facilitated the incorporation of numerous novel features, which are the culmination of distinct amalgamations of two distinct features or the distribution of one specific feature. In the case of the original features, the importance is derived from LightGBM. As for the combined features, which were hard to interpret in biology, we employ an average importance metric based on the number of contributing features, which is subsequently added to the original features. Ultimately, we determine the importance of each original feature, followed by the comparison and analysis.</p>
    </sec>
    <sec id="Sec10">
      <title>Website</title>
      <p id="Par90">The accompanying web services of MAGPIE have been developed as shown in Additional file <xref rid="MOESM2" ref-type="media">2</xref>: Fig. S1. The tool provides online search functionality for pathogenicity scores by entering information on possible single-nucleotide variants (SNVs). Additionally, users can register and request analysis for non-SNV mutations. The development of MAGPIE was initiated to enhance the precision and convenience of mutation pathogenicity prediction, providing comprehensive support to researchers and clinicians within the biomedical field.</p>
      <p id="Par91">Users of the MAGPIE tool can input mutation information in the chr:start–end-ref-alt format via the website to obtain pathogenicity scores. For bulk variant prediction, users can submit tasks by uploading a csv file. A task ID will be generated upon successful submission, enabling users to obtain pathogenicity annotations from the download page once the prediction process is complete. The tool aims to contribute to advancing research and treatment in this area.</p>
    </sec>
  </sec>
  <sec id="Sec11">
    <title>Results</title>
    <sec id="Sec12">
      <title>MAGPIE overview</title>
      <p id="Par92">MAGPIE is a computational method to predict the pathogenicity of multiple variant types using a gradient-boosting machine learning framework (Fig. <xref rid="Fig1" ref-type="fig">1</xref>). To prepare data used for modeling, we collected all mutations with a pathogenic interpretation in the ClinVar database and selected mutations labeled as pathogenic (including likely pathogenic) and benign (including likely benign). We then randomly selected 90% of the dataset to use as training data, rendering a total of 39,893 pathogenic and 38,125 benign variants to feed into the model.<fig id="Fig1"><label>Fig. 1</label><caption><p>Framework of MAGPIE. The model was trained to predict pathogenic scores of multi-type variants and included three steps. First, candidate variants were annotated with high-dimensional features covering six different modalities. Second, automatic feature engineering and separated feature selection were undertaken step by step. Finally, a gradient boosting method with controllable tuning was implemented to train the model and obtain predictions for the pathogenicity of variants</p></caption><graphic xlink:href="13073_2023_1274_Fig1_HTML" id="MO3"/></fig></p>
      <p id="Par93">The MAGPIE framework is composed of 3 steps (Fig. <xref rid="Fig1" ref-type="fig">1</xref>). First, for a given variant, MAGPIE annotates the variant with high dimensional features covering six different modalities, including epigenomics, functional effects, splicing effects, population-based features, biochemical properties, and conservation. In the second step, we use automatic feature engineering followed by feature selection to create candidate features based on the training dataset. Automatic feature engineering aims to create multiple new combinations of features based on input features automatically to capture as much information as possible. After that, feature selection is used to pull out meaningful features. Lastly, using 5-fold cross-validation and step-wise parameter tuning, we trained an interpretable gradient-boosting model (GBM) based on ensemble trees [<xref ref-type="bibr" rid="CR37">37</xref>] and predicted the probability of pathogenicity in candidate variants. The gradient-boosting model, namely LightGBM, uses algorithms like gradient-based one-side sampling (GOSS) and exclusive feature bundling (EFB) to accelerate the training process while assuring accuracy. The output of MAGPIE is a score of pathogenicity defined over the interval between 0 and 1, in which 0 refers to benign variants and 1 represents the most pathogenic. To understand how MAGPIE achieves satisfying performance with multiple modalities, we performed an ablation study to investigate the effects of the training dataset, feature selection, and LightGBM on MAGPIE. Moreover, the ablation study indicated that the MAGPIE integrating a series of modules achieved the best performance improvement in pathogenic prediction (Additional file <xref rid="MOESM2" ref-type="media">2</xref>: Fig. S2). A more detailed description of the MAGPIE framework is included in the “<xref rid="Sec3" ref-type="sec">Methods</xref>” section. Additionally, we made MAGPIE available through an online website to facilitate access and use of the tool at <ext-link ext-link-type="uri" xlink:href="http://tools.shenlab-genomics.org/tools/MAGPIE">http://tools.shenlab-genomics.org/tools/MAGPIE</ext-link> (Additional file <xref rid="MOESM2" ref-type="media">2</xref>: Fig. S1).</p>
    </sec>
    <sec id="Sec13">
      <title>MAGPIE is interpretable</title>
      <p id="Par94">The application of the gradient boosting approach makes MAGPIE an interpretable machine-learning model. To better understand the learned representation, we calculated the importance of different feature modalities and presented them in a network view (Fig. <xref rid="Fig2" ref-type="fig">2</xref>B). The feature importance in MAGPIE indicates the degree to which each feature contributes to the model and reflects their information gains. During the classification process, MAGPIE ensembled six modalities of features. Among them, the most important feature group is the functional effect, which includes measures such as the loss of function score (LoF_score), human gene damage index (GDI), and so on (Fig. <xref rid="Fig2" ref-type="fig">2</xref>A, B, Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S4-S5). Loss-of-function mutations have a greater likelihood of causing disease [<xref ref-type="bibr" rid="CR38">38</xref>]. As previous studies have shown, we found that pathogenic variants predicted by MAGPIE have significantly lower LoF scores than benign variants (Additional file <xref rid="MOESM2" ref-type="media">2</xref>: Fig. S3A). GDI is the accumulated mutational damage of each protein-coding human gene, and variants in highly damaged genes are less likely to be disease-causing. We observed a high weight assigned to the GDI feature, indicating that genes with a lower GDI tended to have higher MAGPIE prediction scores and were more likely to be pathogenic (Additional file <xref rid="MOESM2" ref-type="media">2</xref>: Fig. S3B), consistent with previously published studies [<xref ref-type="bibr" rid="CR26">26</xref>]. The second most important feature modality is population-based, which is correlated inversely to the pathogenicity in test datasets. The third most significant feature modality is conservation, which has been considered in many previous methods such as CADD, SIFT [<xref ref-type="bibr" rid="CR7">7</xref>], PolyPhen [<xref ref-type="bibr" rid="CR8">8</xref>], and VARITY [<xref ref-type="bibr" rid="CR16">16</xref>]. The importance of conservation is expected and indicates the validity of MAGPIE’s learned representations. Additionally, we observed that features within each modality are correlated, while features from different modality groups are more likely to be independent (Fig. <xref rid="Fig2" ref-type="fig">2</xref>A). This suggests that MAGPIE is capable of learning multiple-dimensional information from different feature classes. In other words, the learned representations were discriminative to help MAGPIE for classification.<fig id="Fig2"><label>Fig. 2</label><caption><p>Feature importance and correlation. <bold>A</bold> Correlation between features used to train MAGPIE. <bold>B</bold> A captivating hierarchical relationship diagram is presented, displaying the intricate relationship between features and the categories they belong to. Each dot in the outermost layer represents a distinct feature, while the size of the dots indicates their importance. The second layer depicts feature categories, with the size reflecting the sum of importance of the subordinate features. <bold>C</bold> The bar plot illustrates feature importance, which shows the contribution of each feature after feature selection. Part of the add-on features is automatically removed during the training process</p></caption><graphic xlink:href="13073_2023_1274_Fig2_HTML" id="MO4"/></fig></p>
    </sec>
    <sec id="Sec14">
      <title>MAGPIE outperforms existing methods across multiple conditions</title>
      <p id="Par95">We evaluated the performance of MAGPIE together with 14 previously published pathogenicity prediction methods including MutationAssessor, MetaSVM, MetaLR, VARITY, VEST4, REVEL, MutPred, DANN, ClinPred, PrimateAI, LIST-S2, M-CAP, MutationTaster, and SIFT4G [<xref ref-type="bibr" rid="CR11">11</xref>, <xref ref-type="bibr" rid="CR13">13</xref>, <xref ref-type="bibr" rid="CR14">14</xref>, <xref ref-type="bibr" rid="CR16">16</xref>, <xref ref-type="bibr" rid="CR17">17</xref>, <xref ref-type="bibr" rid="CR21">21</xref>, <xref ref-type="bibr" rid="CR22">22</xref>, <xref ref-type="bibr" rid="CR31">31</xref>–<xref ref-type="bibr" rid="CR36">36</xref>]. For benchmark purposes, we applied MAGPIE on the ClinVar training dataset as described in methods, and its independent split dataset, labeled as ClinVarTest hereafter, was used for evaluating all models, including MAGPIE performances (Fig. <xref rid="Fig3" ref-type="fig">3</xref>A). The ClinVarTest dataset contains 4356 pathogenic and 4310 benign mutations. Since we split datasets based on gene symbols, these variants and their corresponding gene-level features were not seen by the models in the training dataset (Fig. <xref rid="Fig3" ref-type="fig">3</xref>A, Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S1). To fairly compare MAGPIE with other methods, pathogenicity classifications were set according to the thresholds recommended by the authors. Nevertheless, MAGPIE outperformed all other classifiers on the benchmark with the highest AUC score of 0.995 and AUPRC of 0.995 (Fig. <xref rid="Fig3" ref-type="fig">3</xref>B, C, Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S6-S8). In comparison, other methods, i.e., MutationTaster, DANN, LIST-S2, SIFT4G, PrimateAI, M-CAP, and MutationAssessor achieved AUC from 0.61 to 0.91. The performance evaluation suggested that MAGPIE is a reliable tool for pathogenic prediction.<fig id="Fig3"><label>Fig. 3</label><caption><p>MAGPIE makes accurate predictions. <bold>A</bold> The pie chart showed the proportion of pathogenic and benign variants in the independent test set, and the bar plot illustrated the percentages of multi-type variants in the dataset. <bold>B</bold> The receiver operating characteristic curve of MAGPIE and 14 other predicted tools in the independent test set. The area under the curve (AUC) scores were shown in the bar plot. <bold>C</bold> Precision-recall curve of MAGPIE and 14 other predicted tools in the ClinVarTest dataset were illustrated. <bold>D</bold> Missing rate comparison of MAGPIE and 14 other predicted tools in the independent test set. The higher missing rate represented that the prediction tools cannot predict pathogenic scores on the larger number of candidate variants. <bold>E</bold> AUC comparison of MAGPIE and 14 other predicted tools in the ClinVarRare, which only included variants with AF &lt; 0.01. <bold>F</bold> AUBPRC comparison of MAGPIE and 14 other predicted tools in the ClinVarRare which only included variants with AF &lt; 0.01. <bold>G</bold> Percentages of predictable variants across different variant types in various tools. <bold>H</bold> Violin plots illustrated distributions of pathogenic scores. And bar plots showed the precisions in each category of pathogenic variants and benign variants</p></caption><graphic xlink:href="13073_2023_1274_Fig3_HTML" id="MO5"/></fig></p>
      <p id="Par96">Of note, existing pathogenic prediction tools mostly predicted a limited number of mutations, which indicated a lack of generalization of previous methods. For example, for published classifiers, i.e., ClinPred, REVEL, MetaSVM, MetaLR, MutationAssessor, PrimateAI, SIFT4G, LIST-S2, and M-CAP, 30–60% of candidate mutations were unpredictable by these methods (Fig. <xref rid="Fig3" ref-type="fig">3</xref>D), which leads to 30–60% of variants’ output as missing. These missing values were generated due to variant types not being predictable by specific prediction tools. In contrast, MAGPIE succeeded in predicting the pathogenicity of all variants in the dataset, fulfilling 3–60% of missing values predicted by other methods (Fig. <xref rid="Fig3" ref-type="fig">3</xref>C). In other words, for all the exonic variants assessed covering various mutation types other than synonymous mutation, the missing rate of MAGPIE is zero. In summary, MAGPIE outperformed all previously published machine learning methods as well as the state-of-the-art deep learning methods on this benchmark.</p>
      <p id="Par97">Finally, we constructed a rare mutation test set (ClinVarRare) to evaluate the ability of MAGPIE to identify pathogenic variants from rare benign variants, which is one of the major challenges in real-world analysis for genetic diagnosis of disease. The ClinVarRare test set included rare pathogenic ClinVar variants (AF &lt; 0.01) and rare benign variants from gnomAD (AF &lt; 0.01), which is more similar to the real whole-exome sequencing datasets. For the rare mutation test set, MAGPIE achieved the best performance with an AUC equal to 0.992, followed by REVEL, ClinPred, and MutPred. Previous computational tools predicted a proportion of variants within the whole dataset, and the rest of the variants were unpredictable because these tools were designed to classify specific types of variants. Consequently, we examined that MAGPIE predicted all 4881 variants in the ClinVarRare test set with the highest accuracy of 0.95 (Fig. <xref rid="Fig3" ref-type="fig">3</xref>E). In summary, MAGPIE outperforms all previously published machine learning methods and the state-of-the-art deep learning methods on both the ClinVarTest dataset and the ClinVarRare test dataset.</p>
    </sec>
    <sec id="Sec15">
      <title>MAGPIE achieves high performance in multiple mutation types</title>
      <p id="Par98">An important characteristic of MAGPIE is the ability to make pathogenic predictions on multiple types of mutations. The ClinVarTest dataset contains a total of 6 types of mutations: missense variants (or nonsynonymous SNV), stop-gain variants, start-loss variants, frameshift mutations, nonframeshift mutations, and stop-loss variants. MAGPIE was predictive of clinical significance for all labeled variants across various mutation types, while many available methods only applied to certain mutation types (Fig. <xref rid="Fig3" ref-type="fig">3</xref>G). Besides, the performance of our methods was robust to different variant types, suggesting the generalizability of our method (Fig. <xref rid="Fig3" ref-type="fig">3</xref>H).</p>
      <p id="Par99">We further analyzed the distribution of pathogenic scores across mutation types to evaluate the classification capability of MAGPIE. To visualize the distribution of MAGPIE-predicted pathogenic probability, we plotted the MAGPIE score distributions for different types of pathogenic and benign variants (Fig. <xref rid="Fig3" ref-type="fig">3</xref>H). For pathogenic variants, MAGPIE scores were highly concentrated around 1, and for benign variants, scores were near 0 across six types of variants. This suggested that our model can separate pathogenic and benign variants well. We further analyzed the ability of classification quantitatively and evaluated how accurately our model can predict pathogenicity. The average precision of all types of variants was 0.98, suggesting that 98% of predicted pathogenic variants were consistent with their true labels. And the average false predictive value was 0.8, meaning 80% of predicted benign mutations were true negatives. In particular, MAGPIE identified pathogenic and benign variants successfully in the imbalanced datasets of stop-loss and stop-gain mutations. As shown in Fig. <xref rid="Fig3" ref-type="fig">3</xref>G, MAGPIE detected pathogenic mutations in stop-loss and stop-gain mutations and minimized false positives (average precision of 1.0). Therefore, MAGPIE can accurately differentiate pathogenic and benign mutations across various mutation types.</p>
    </sec>
    <sec id="Sec16">
      <title>MAGPIE achieves the best performance on additional orthogonal datasets</title>
      <p id="Par100">We used the annotated variants from the SwissProt database as an orthogonal dataset to further benchmark MAGPIE against other methods. SwissProt contains 80,840 labeled variants, with 71,400 explicitly labeled as pathogenic or benign. Only variants with unique reference SNP ID mapping, in the exonic region, excluding synonymous SNVs, were retained. To ensure the independence of the orthogonal dataset, we further removed variants located on genes reported in the ClinVarTrain dataset. We also made the orthogonal dataset closer to the real scenario and evaluate the performance of MAGPIE in the imbalanced dataset with less than 10% positive samples. After filtering, the number of pathogenic and benign mutations became highly imbalanced. The number of benign variants was 12,075, while the number of pathogenic ones was only 1308, about 9.8% of the total number of variants to be tested (Fig. <xref rid="Fig4" ref-type="fig">4</xref>A, Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S2). We also conducted an ablation study in this imbalanced orthogonal dataset and found that the full model was much superior to other model variations of MAGPIE (Additional file <xref rid="MOESM2" ref-type="media">2</xref>: Fig. S2).<fig id="Fig4"><label>Fig. 4</label><caption><p>MAGPIE outperforms other models in orthogonal validation set and ACMG-guided dataset. <bold>A</bold> The pie chart showed the proportion of pathogenic and benign variants in the orthogonal validation set and the bar plot illustrated the percentages of multi-type variants in the dataset. <bold>B</bold> The receiver operating characteristic curve of MAGPIE and 14 other predicted tools in the orthogonal validation set. <bold>C</bold> The precision-recall curve of MAGPIE and 14 other predicted tools in the orthogonal validation set were illustrated. <bold>D</bold> Missing rate comparison of MAGPIE and 14 other predicted tools in the orthogonal validation set. The higher missing rate represented that the prediction tools cannot predict pathogenic scores on the larger number of candidate variants. <bold>E</bold> AUC comparison of MAGPIE and 14 other predicted tools in the SwissProtRare which only included variants with AF &lt; 0.01. <bold>F</bold> AUBPRC comparison of MAGPIE and 14 other predicted tools in the SwissProtRare which only included variants with AF &lt; 0.01. <bold>G</bold> The pie chart showed the proportion of pathogenic and benign variants in the ACMG-guided dataset, and the bar plot illustrated the percentages of multi-type variants in the dataset. <bold>H</bold> Performance comparison of MAGPIE and 14 other predicted tools in the ACMG-guided dataset. <bold>I</bold> The precision-recall curve of MAGPIE and 14 other predicted tools in the ACMG-guided dataset were illustrated</p></caption><graphic xlink:href="13073_2023_1274_Fig4_HTML" id="MO6"/></fig></p>
      <p id="Par101">Again, the performance of MAGPIE was superior to other machine learning and deep learning methods on this benchmark. MAGPIE outcompeted other tools with the best AUC of 0.97 and AUPRC of 0.88 (Fig. <xref rid="Fig4" ref-type="fig">4</xref>B, Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S6-S8). Furthermore, MAGPIE computed the pathogenic probability for all filtered variants without missing values (Fig. <xref rid="Fig4" ref-type="fig">4</xref>C), whereas VEST4, DANN, MutationTaster, and MetaSVM were the closest competitor with about 5% missing rate (Fig. <xref rid="Fig4" ref-type="fig">4</xref>C, Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S6-S8). As for M-CAP and MutPred, more than 40% variants were unpredictable. Hence, on this benchmark, MAGPIE was better than other methods in predicting novel pathogenic mutations.</p>
      <p id="Par102">To evaluate the performance of MAGPIE in the imbalanced test dataset with rare variants, we constructed a rare SwissProt test set (SwissProtRare) where all variants had AF less than 0.01. The dataset included 9% of rare pathogenic SwissProt variants and 91% of rare benign variants from gnomAD, an extreme case of an imbalanced rare variant dataset. MAGPIE outperformed all competitors with an AUC equal to 0.95, followed by REVEL (AUC = 0.92) and MutPred (AUC = 0.91) (Fig. <xref rid="Fig4" ref-type="fig">4</xref>E). In general, MAGPIE outperformed other competitors.</p>
      <p id="Par103">Three types of variants were included in the SwissProt dataset, and MAGPIE was able to differentiate well between pathogenic and benign variants across all variant types in the orthogonal dataset as well (Additional file <xref rid="MOESM2" ref-type="media">2</xref>: Fig. S4A). Additionally, we found that MAGPIE scores of pathogenic variants were concentrated close to 1. In contrast, the probabilities of benign variants were near 0, which will further support the reliability of our method (Additional file <xref rid="MOESM2" ref-type="media">2</xref>: Fig. S4B). Precision of pathogenic variants was higher than 0.85, suggesting that MAGPIE achieved accurate pathogenic variants prediction (Additional file <xref rid="MOESM2" ref-type="media">2</xref>: Fig. S4B). Consistent with the results in the ClinVarTest dataset, for start-loss and stop-gain variants, MAGPIE achieved higher precision than the precision of nonsynonymous SNVs (precisions of 0.95 and 1, respectively) (Additional file <xref rid="MOESM2" ref-type="media">2</xref>: Fig. S4B). The false predictive values of stop-loss and stop-gain variants were slightly lower than the false predictive values of nonsynonymous SNVs and start-loss variants. However, the average false predictive value achieved 0.8 (Additional file <xref rid="MOESM2" ref-type="media">2</xref>: Fig. S4B). Thus, MAGPIE could successfully predict new pathogenic variants among different variant types.</p>
      <p id="Par104">Furthermore, we assessed the performance of MAGPIE and other models on an additional validation set from ACMG test panel. We obtained the ACMG guided test panel (2023.05.22), which includes a total of 1270 mutations, from the official website. After filtering, a final dataset of 491 mutations was used to compare MAGPIE and other model performances. In contrast to the SwissProt dataset, in the imbalanced ACMG dataset, there were 82% of pathogenic variants and 18% of benign variants. Again, MAGPIE achieved the highest AUC and AUPRC among all methods (Additional file <xref rid="MOESM2" ref-type="media">2</xref>: Fig. S5-S6, Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S6-S8), illustrating that MAGPIE could classify pathogenic and benign in imbalanced datasets.</p>
    </sec>
    <sec id="Sec17">
      <title>Assessing MAGPIE performance with varying threshold</title>
      <p id="Par105">Different thresholds may affect the model performance, especially in imbalanced data. In the real-world clinical applications of pathogenic prediction tools to interpret VUS in individual patients, only a few pathogenic mutations should be identified out of tens of thousands of candidate variants called from WES data. Thus, the pathogenic prediction tasks are presumably assigned to handle highly imbalanced datasets. Therefore, we investigated the optimal threshold of MAGPIE under various data balance scenarios. The default parameter of our model is 0.5 in balanced datasets such as the ClinVarTest dataset. We found that with the predicted probabilities between 0.4 and 0.7, both the accuracy and F1-score were stable (Additional file <xref rid="MOESM2" ref-type="media">2</xref>: Fig. S7-S8). Besides, Matthew’s correlation coefficient (MCC), a measure of association for two binary variables, in the ClinVarTest dataset confirmed that 0.5 was a reliable threshold for this benchmark (Additional file <xref rid="MOESM2" ref-type="media">2</xref>: Fig. S7-S8).</p>
      <p id="Par106">To examine the effects of different ratios between the number of pathogenic and benign variants, the ClinVarTest dataset was randomly divided into a series of subsets with various combinations. We randomly added different proportions of pathogenic variants to all benign variants from the ClinVarTest dataset to construct independent test subsets. We can see that in such cases, the optimal thresholds had dropped from 0.95 to 0.72 (Additional file <xref rid="MOESM2" ref-type="media">2</xref>: Fig. S7). However, MCC, accuracy, and F1-score were relatively stable in these subsets, which illustrated that performances of MAGPIE had less impact caused by the different thresholds (Additional file <xref rid="MOESM2" ref-type="media">2</xref>: Fig. S7). Furthermore, we added various percentages of benign variants to all pathogenic variants. We also found similar results (Additional file <xref rid="MOESM2" ref-type="media">2</xref>: Fig. S8).</p>
      <p id="Par107">We next studied the orthogonal SwissProt dataset, which was highly imbalanced with only 9.8% pathogenic mutations, and the ACMG dataset, which only included 18% benign variants. The SwissProt dataset is more similar to real applied scenarios than the ClinVarTest dataset and has clear labels of pathogenicity. Therefore, a precision-recall curve can help us to evaluate the influence of classifier performance with different thresholds. We found that the optimal threshold in this dataset was 0.71 (Additional file <xref rid="MOESM2" ref-type="media">2</xref>: Fig. S9A). We analyzed the performance matrix in the dataset with the default threshold and the optimal threshold. Our findings showed that the performance of MAGPIE became better with stricter thresholds. MCC and F1-score increased by 2% and 3%, respectively (Additional file <xref rid="MOESM2" ref-type="media">2</xref>: Fig. S9A). Similarly, we observed that the optimal threshold of the ACMG dataset was 0.34 (Additional file <xref rid="MOESM2" ref-type="media">2</xref>: Fig. S9B). MCC and F1-score had been slightly improved. However, if there is no precise estimate of the compositions of the dataset, MAGPIE with the default parameter still outperformed other methods. Therefore, using a default threshold can also achieve accurate prediction on both imbalanced and balanced datasets as shown before.</p>
    </sec>
    <sec id="Sec18">
      <title>MAGPIE prediction on gene mutations that cause Mendelian diseases</title>
      <p id="Par108">Next, we applied MAGPIE to four genes curated with a large number of known pathogenic mutations causing different Mendelian diseases (Methods). For all the four genes tested, i.e., ATP7B, CFTR, FBN1, and LMNA, MAGPIE was able to recover the largest number of known pathogenic mutations compared to other methods with default parameters (Fig. <xref rid="Fig5" ref-type="fig">5</xref>A). On average, MAGPIE recovered 96% of known pathogenic variants. For instance, for FBN1, the gene mutated in Marfan syndrome [<xref ref-type="bibr" rid="CR39">39</xref>] and included 1621 pathogenic mutations. MAGPIE predicted 1450 (87%) candidate variants as pathogenic, and MAGPIE scores of 95% pathogenic variants were close to 1 (Fig. <xref rid="Fig5" ref-type="fig">5</xref>B). All other tools correctly classified a smaller fraction of variants, which was lower than 70%. For CFTR (which is associated with cystic fibrosis), MAGPIE predicted 164 (95%) variants to be pathogenic. Compared to MutationTaster, VEST4, and other tools, MAGPIE scores were concentrated about 1 (Fig. <xref rid="Fig5" ref-type="fig">5</xref>B). Moreover, the performance of our classifier on ATP7B and FBN1 was better than other methods, indicating a stable performance for evaluating pathogenicity despite using entirely different disease-associated genes (Fig. <xref rid="Fig5" ref-type="fig">5</xref>A, B). Thus, MAGPIE performs better in identifying pathogenic mutations that cause Mendelian diseases.<fig id="Fig5"><label>Fig. 5</label><caption><p>MAGPIE detects most variants in pathogenic genes. <bold>A</bold> Comparison of the number of detected pathogenic variants in four well-known pathogenic genes between MAGPIE and 14 other prediction tools. <bold>B</bold> Density plots illustrated distributions of pathogenic scores predicted by MAGPIE, MutationTaster, and VEST4. Moreover, the pie charts showed the proportion of predictable and unpredictable variants of each tool</p></caption><graphic xlink:href="13073_2023_1274_Fig5_HTML" id="MO7"/></fig></p>
    </sec>
  </sec>
  <sec id="Sec19">
    <title>Discussion</title>
    <p id="Par109">The next-generation sequencing has revealed tremendous amount of genetic variations in the human population. However, it has raised another challenge: the difficulty of identifying the actual disease-causing mutation from the millions of normal variations. The current computation tools have enabled to predict one or several specific types of mutations. For example, M-CAP, MutationTaster, and PrimateAI focus on missense variants. However, specific types of variants have been filtered out due to the models’ scope. Various types of mutations present the challenge of the generalization ability for computational methods to predict pathogenic scores among mutations. Therefore, it is critical to train a generalized classifier foremost to expand predictable variant types.</p>
    <p id="Par110">To address this challenge, we report a computational classifier named MAGPIE, which focuses on classifying multiple types of mutations of uncertain significance for Mendelian diseases. The novelty of this work comes from a combination of data preparation, feature extraction, feature engineering, and model selection. The overall idea is that from the users’ perspective, the pathogenicity of a variant should be jointly evaluated on multiple scopes, which corresponds to features derived from six modalities in MAGPIE. Therefore, the machine learning components of MAGPIE are designed to maximize the models’ learning on multimodal data.</p>
    <p id="Par111">The machine learning component of MAGPIE mainly included autoFE and LightGBM, both of which we think contributes to the novelty of the method. In the pathogenicity prediction task, the pathogenicity of variants may be caused by multiple types of features. To enhance the model’s performance, we aimed to integrate these multimodal features. By incorporating the autoFE component, MAGPIE has the capability to handle the complexity of the features and effectively capture the underlying relationships. This enables us to extract valuable information from the features and improve the overall performance of our model. This process involves applying certain transformations to the features, allowing for a better representation of their performance in predicting mutation pathogenicity, such as through Group-By operations. Of note, MAGPIE employs separated feature selection and step-wise training approaches during the autoFE process to avoid overfitting. In our updated ablation study, the inclusion of the autoFE component enhances the performance of MAGPIE (Additional file <xref rid="MOESM2" ref-type="media">2</xref>: Fig. S2).</p>
    <p id="Par112">The input data for pathogenicity prediction in MAGPIE is in tabular format, which makes it suitable for tree-based models. Among the tree-based models, LightGBM stands out as one of the most efficient models in terms of both prediction accuracy and computational time. LightGBM is based on the gradient boosting framework and incorporates a number of advanced techniques such as histogram-based binning, leaf-wise tree growth, and gradient-based one-side sampling. These techniques improve model performance and enables faster training and inference times compared to other tree-based models or machine learning models. Consistently, in the ablation study for MAGPIE, we found that the computational time required for SVM with an identical training process was approximately 10 times longer than LightGBM. By incorporating LightGBM in MAGPIE, we are able to leverage its efficiency and accuracy to achieve accurate and timely pathogenicity predictions (Additional file <xref rid="MOESM2" ref-type="media">2</xref>: Fig. S10). Moreover, we can easily calculate feature importance from the LightGBM model, which enables the interpretability of MAGPIE.</p>
    <p id="Par113">Another novel aspect of MAGPIE design is the ability to make accurate prediction for rare variants, which is highly clinically relevant but not naturally well represented in ClinVar database as training source. In real-world pathogenicity prediction and diagnosis scenarios, it is common to encounter rare benign variants. Therefore, we aimed to include rare benign variants in the training of MAGPIE to enhance its ability to detect pathogenic variants in clinical settings. However, in large mutation datasets like ClinVar, rare benign variants make up a very small proportion of the dataset. To address this issue, we incorporated rare benign variants from gnomAD into the training set. By including rare benign variants from gnomAD, we were able to overcome the lack of features associated with rare benign variants in ClinVar. This inclusion of a more diverse dataset, encompassing rare benign variants, led to better generalization of the MAGPIE model. Ablation study also proves this crucial role of relevant cross-dataset working in improving model performance (Additional file <xref rid="MOESM2" ref-type="media">2</xref>: Fig. S2). In the ablation study, we find that removing the data from gnomAD in the training set has a significant impact on the performance of the MAGPIE model. Particularly in the pathogenicity prediction task for rare mutations, adding gnomAD mutations to the training set significantly increases the probability of correctly classifying rare benign mutations (Additional file <xref rid="MOESM2" ref-type="media">2</xref>: Fig. S2).</p>
    <p id="Par114">On the ClinVarTest dataset and the orthogonal datasets, our approach accurately classified multi-type variants, respectively, whereas most tools can only predict one or two types of variants. However, the total numbers of variants across variant types in the ClinVar dataset were different. Compared with the number of missense variants, other types of variants, such as stopgain, stoploss, and so on, had less number of records. Thus, the small sample size in these variant types might limit, to some extent, the performance of MAGPIE and cause some biases.</p>
    <p id="Par115">Many previous studies have demonstrated outstanding performance in accurately predicting pathogenic mutations and have paved the way for subsequent work. The design of MAGPIE draws inspiration from many previous work, such as utilizing the AUBPRC metric defined in VARITY to assess the performance of imbalanced datasets. However, we showed here that the state-of-the-art methods included missing value because their predictions are concentrated on one or several specific mutation types. In the clinical application for genetic diagnosis, these unpredictable variants would be filtered out and often be treated as non-pathogenic ones (Additional file <xref rid="MOESM2" ref-type="media">2</xref>: Fig. S11).</p>
    <p id="Par116">Detection of pathogenic variants using MAGPIE may suffer from several limitations. First, we evaluated the running time of our method and found that the annotation tools cost the most time in the MAGPIE pipeline since the running time of MAGPIE was limited by the necessary file I/O in annotation tools (Additional file <xref rid="MOESM2" ref-type="media">2</xref>: Fig. S11). Also, our approach does not address the influences of a combination of variants. Human diseases may be associated with multiple causative mutations. However, our method focuses on predicting the pathogenicity of a single variant. Another potential limitation is that this approach is designed to obtain information from genetic annotations without any phenotype-related annotations. Future methods development may consider features including phenotype-related annotations to build a more direct connection between diseases and genetic variants. Currently, the clinical work of genetic diagnosis rate is still limited. It was reported that using WES data, the genetic diagnosis rate can be up to 40%, suggesting a large space of improvement remains for practical clinical work. Several reasons lead to this result, one of which is that most of the human genome is non-coding, while most algorithms can only predict a subset of the coding region. Admittedly, computational predictions focusing on exonic mutations other than synonymous mutations like MAGPIE are necessary but still insufficient to address all the clinical diagnosis challenges. MAGPIE cannot provide reliable predictions for intronic and intergenic variants due to the scarcity of annotation information in existing databases and the lack of training sources. As we move forward, we will endeavor to acquire essential information about these types of mutations.</p>
  </sec>
  <sec id="Sec20">
    <title>Conclusions</title>
    <p id="Par117">In this study, we introduce a computational framework named MAGPIE, which generates pathogenicity scores for multi-type variants and simplifies pathogenicity classification for millions of candidate genomic variants. Moreover, MAGPIE is independent of any other pathogenic prediction tools, thereby avoiding introducing biases and circularity. Our approach yields superior performance and low missing rates for various types of exonic variants in both balanced and imbalanced datasets. Besides, MAGPIE also provided an accurate prediction of multi-type rare variants. Furthermore, MAGPIE performance remained robust, recovering known pathogenic variants across different Mendelian diseases. In conclusion, with improved prediction accuracy, MAGPIE provides a more accessible and accurate prediction of multi-type exonic variants for Mendelian disease studies.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <sec id="Sec21">
      <title>Supplementary Information</title>
      <p>
        <supplementary-material content-type="local-data" id="MOESM1">
          <media xlink:href="13073_2023_1274_MOESM1_ESM.xlsx">
            <caption>
              <p><bold>Additional file 1: Table S1.</bold> Category and proportion of variants in independent test set. <bold>Table S2.</bold> Category and proportion of variants in orthogonal validation set. <bold>Table S3.</bold> Category and proportion of variants in ACMG guided dataset. <bold>Table S4.</bold> Feature name and description. <bold>Table S5.</bold> Feature importance of MAGPIE. <bold>Table S6.</bold> Performance metrics in independent test set. <bold>Table S7.</bold> Performance metrics in orthogonal validation set. <bold>Table S8.</bold> Performance metrics in ACMG guided dataset.</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM2">
          <media xlink:href="13073_2023_1274_MOESM2_ESM.pdf">
            <caption>
              <p><bold>Additional file 2: Fig. S1.</bold> Web tool of MAGPIE. <bold>Fig. S2.</bold> Ablation study of MAGPIE. <bold>Fig. S3.</bold> Significance test on independent test set. <bold>Fig. S4.</bold> Performance of each variant type on orthogonal validation set. <bold>Fig. S5.</bold> Performance evaluation on ACMG guided dataset. <bold>Fig. S6.</bold> Performance of each variant type on ACMG guided dataset. <bold>Fig. S7.</bold> Threshold test of MAGPIE on independent test set when number of pathogenic variants is less than benign ones. <bold>Fig. S8.</bold> Threshold test of MAGPIE on orthogonal validation set when the number of pathogenic variants is less than benign. <bold>Fig. S9.</bold> Performance comparison before and after threshold adjustment according to FPR control. <bold>Fig. S10.</bold> MAGPIE running time. <bold>Fig. S11.</bold> Performance comparison in real-world diagnosis.</p>
            </caption>
          </media>
        </supplementary-material>
      </p>
    </sec>
  </sec>
</body>
<back>
  <glossary>
    <title>Abbreviations</title>
    <def-list>
      <def-item>
        <term>MAGPIE</term>
        <def>
          <p id="Par2">Multimodal Annotation Generated Pathogenic Impact Evaluator</p>
        </def>
      </def-item>
      <def-item>
        <term>ClinVar</term>
        <def>
          <p id="Par3">Clinical variation</p>
        </def>
      </def-item>
      <def-item>
        <term>AUC</term>
        <def>
          <p id="Par4">Area under curve</p>
        </def>
      </def-item>
      <def-item>
        <term>WGS</term>
        <def>
          <p id="Par5">Whole genome sequencing</p>
        </def>
      </def-item>
      <def-item>
        <term>WES</term>
        <def>
          <p id="Par6">Whole exome sequencing</p>
        </def>
      </def-item>
      <def-item>
        <term>gnomAD</term>
        <def>
          <p id="Par7">Genome Aggregation Database</p>
        </def>
      </def-item>
      <def-item>
        <term>ExAC</term>
        <def>
          <p id="Par8">Exome Aggregation Consortium</p>
        </def>
      </def-item>
      <def-item>
        <term>ML</term>
        <def>
          <p id="Par9">Machine learning</p>
        </def>
      </def-item>
      <def-item>
        <term>DL</term>
        <def>
          <p id="Par10">Deep learning</p>
        </def>
      </def-item>
      <def-item>
        <term>OMIM</term>
        <def>
          <p id="Par11">Online Mendelian Inheritance in Man</p>
        </def>
      </def-item>
      <def-item>
        <term>HGMD</term>
        <def>
          <p id="Par12">Human Gene Mutation Database</p>
        </def>
      </def-item>
      <def-item>
        <term>RNA</term>
        <def>
          <p id="Par13">Ribonucleic acid</p>
        </def>
      </def-item>
      <def-item>
        <term>SpliceAI</term>
        <def>
          <p id="Par14">Splice artificial intelligence</p>
        </def>
      </def-item>
      <def-item>
        <term>EVE</term>
        <def>
          <p id="Par15">Evolutionary model of variant effect</p>
        </def>
      </def-item>
      <def-item>
        <term>CADD</term>
        <def>
          <p id="Par16">Combined Annotation-Dependent Depletion</p>
        </def>
      </def-item>
      <def-item>
        <term>DANN</term>
        <def>
          <p id="Par17">Deleterious Annotation of Genetic Variants using Neural Networks</p>
        </def>
      </def-item>
      <def-item>
        <term>REVEL</term>
        <def>
          <p id="Par18">Rare Exome Variant Ensemble Learner</p>
        </def>
      </def-item>
      <def-item>
        <term>MutPred</term>
        <def>
          <p id="Par19">Mutation predictor</p>
        </def>
      </def-item>
      <def-item>
        <term>VEST</term>
        <def>
          <p id="Par20">Variant effect scoring tool</p>
        </def>
      </def-item>
      <def-item>
        <term>PROVEAN</term>
        <def>
          <p id="Par21">Protein Variation Effect Analyzer</p>
        </def>
      </def-item>
      <def-item>
        <term>PhastCons</term>
        <def>
          <p id="Par22">Phylogenetic Analysis with Space/Time Models for Conservation of Evolutionary Significant Sequences</p>
        </def>
      </def-item>
      <def-item>
        <term>GBM</term>
        <def>
          <p id="Par23">Gradient-boosting model</p>
        </def>
      </def-item>
      <def-item>
        <term>GOSS</term>
        <def>
          <p id="Par24">Gradient-based one-side sampling</p>
        </def>
      </def-item>
      <def-item>
        <term>EFB</term>
        <def>
          <p id="Par25">Exclusive feature bundling</p>
        </def>
      </def-item>
      <def-item>
        <term>GDI</term>
        <def>
          <p id="Par26">Gene damage index</p>
        </def>
      </def-item>
      <def-item>
        <term>LoF</term>
        <def>
          <p id="Par27">Loss of function</p>
        </def>
      </def-item>
      <def-item>
        <term>SIFT</term>
        <def>
          <p id="Par28">Sorting Intolerant From Tolerant</p>
        </def>
      </def-item>
      <def-item>
        <term>PolyPhen</term>
        <def>
          <p id="Par29">Polymorphism phenotyping</p>
        </def>
      </def-item>
      <def-item>
        <term>MetaSVM</term>
        <def>
          <p id="Par30">Meta-learner support vector machine</p>
        </def>
      </def-item>
      <def-item>
        <term>MetaLR</term>
        <def>
          <p id="Par31">Meta-logistic regression</p>
        </def>
      </def-item>
      <def-item>
        <term>ClinPred</term>
        <def>
          <p id="Par32">Clinical variant prediction</p>
        </def>
      </def-item>
      <def-item>
        <term>PrimateAI</term>
        <def>
          <p id="Par33">Primate artificial intelligence</p>
        </def>
      </def-item>
      <def-item>
        <term>LIST-S2</term>
        <def>
          <p id="Par34">Local Identity and Shared Taxa—S2</p>
        </def>
      </def-item>
      <def-item>
        <term>M-CAP</term>
        <def>
          <p id="Par35">Mendelian Clinically Applicable Pathogenicity</p>
        </def>
      </def-item>
      <def-item>
        <term>SIFT4G</term>
        <def>
          <p id="Par36">Sorting Intolerant From Tolerant for Genomes</p>
        </def>
      </def-item>
      <def-item>
        <term>SNV</term>
        <def>
          <p id="Par37">Single-nucleotide variant</p>
        </def>
      </def-item>
      <def-item>
        <term>AUPRC</term>
        <def>
          <p id="Par38">Area under the precision-recall curve</p>
        </def>
      </def-item>
      <def-item>
        <term>AUBPRC</term>
        <def>
          <p id="Par39">Area under the balanced precision-recall curve</p>
        </def>
      </def-item>
      <def-item>
        <term>MCC</term>
        <def>
          <p id="Par40">Matthews correlation coefficient</p>
        </def>
      </def-item>
      <def-item>
        <term>GWAS</term>
        <def>
          <p id="Par41">Genome-wide association study</p>
        </def>
      </def-item>
      <def-item>
        <term>ANNOVAR</term>
        <def>
          <p id="Par42">Annotation of variants from next-generation sequencing data using a reference genome</p>
        </def>
      </def-item>
      <def-item>
        <term>RVIS</term>
        <def>
          <p id="Par43">Residual variation intolerance score</p>
        </def>
      </def-item>
      <def-item>
        <term>LoFtool</term>
        <def>
          <p id="Par44">Loss of function tool</p>
        </def>
      </def-item>
      <def-item>
        <term>DS</term>
        <def>
          <p id="Par45">Delta score</p>
        </def>
      </def-item>
      <def-item>
        <term>AG</term>
        <def>
          <p id="Par46">Acceptor gain</p>
        </def>
      </def-item>
      <def-item>
        <term>AL</term>
        <def>
          <p id="Par47">Acceptor loss</p>
        </def>
      </def-item>
      <def-item>
        <term>DG</term>
        <def>
          <p id="Par48">Donor gain</p>
        </def>
      </def-item>
      <def-item>
        <term>DL</term>
        <def>
          <p id="Par49">Donor loss</p>
        </def>
      </def-item>
      <def-item>
        <term>DP</term>
        <def>
          <p id="Par50">Delta position</p>
        </def>
      </def-item>
      <def-item>
        <term>AF</term>
        <def>
          <p id="Par51">Allele frequency</p>
        </def>
      </def-item>
      <def-item>
        <term>phyloP</term>
        <def>
          <p id="Par52">Phylogenetic <italic>P</italic>-values</p>
        </def>
      </def-item>
      <def-item>
        <term>SiPhy</term>
        <def>
          <p id="Par53">SIte-specific PHYlogenetic analysis</p>
        </def>
      </def-item>
      <def-item>
        <term>AutoFE</term>
        <def>
          <p id="Par54">Automatic feature engineering</p>
        </def>
      </def-item>
      <def-item>
        <term>SFS</term>
        <def>
          <p id="Par55">Separated feature selection</p>
        </def>
      </def-item>
      <def-item>
        <term>ROC</term>
        <def>
          <p id="Par56">Receiver operating characteristic</p>
        </def>
      </def-item>
    </def-list>
  </glossary>
  <fn-group>
    <fn>
      <p>This article has been updated to amend affiliations 1 &amp; 2 and the funding section.</p>
    </fn>
    <fn>
      <p>
        <bold>Publisher’s Note</bold>
      </p>
      <p>Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p>
    </fn>
    <fn>
      <p>Yicheng Liu and Tianyun Zhang contributed equally to this work.</p>
    </fn>
    <fn>
      <p>
        <bold>Change history</bold>
      </p>
      <p>5/14/2024</p>
      <p>A Correction to this paper has been published: 10.1186/s13073-024-01343-2</p>
    </fn>
  </fn-group>
  <ack>
    <title>Acknowledgements</title>
    <p>We thank Jinzhao Liang, Xiaoyang Zhao, and Hanying Jia for providing important suggestions on data analysis. We thank Dandan Hu, Lin Lv, Asif Ashan, Hanying Jia, Xilu Yuan, and Yuxin Gu for providing helpful suggestions for manuscript. We thank Dr. Shanshan Pei for helping us come up with the name of the tool. We are also thankful for the Core Facilities of Liangzhu Laboratory.</p>
  </ack>
  <notes notes-type="author-contribution">
    <title>Authors’ contributions</title>
    <p>N.S. conceived the project. N.S., S.W., and Y.L. designed the experiment. Y.L. processed the data and performed the experiments. N.S., Y.L., and T.Z. devised the data analysis. N.S. and S.W. supervised the study. N.Y. and Y.L. built the MAGPIE tool website. T.Z., N.S., Y.L. S.W. wrote the manuscript. All authors read and approved the final manuscript.</p>
  </notes>
  <notes notes-type="funding-information">
    <title>Funding</title>
    <p>This work was supported by the Key R&amp;D Program of Zhejiang (No.2024SSYS0022), the Leading Innovative and Entrepreneur Team Introduction Program of Zhejiang (No. 2021R01012).</p>
  </notes>
  <notes notes-type="data-availability">
    <title>Availability of data and materials</title>
    <p>Datasets generated and/or analyzed during the current study are publicly available in the ClinVar (<ext-link ext-link-type="uri" xlink:href="https://ftp.ncbi.nlm.nih.gov/pub/clinvar/">https://ftp.ncbi.nlm.nih.gov/pub/clinvar/</ext-link>) [<xref ref-type="bibr" rid="CR4">4</xref>], SwissProt (<ext-link ext-link-type="uri" xlink:href="https://ftp.uniprot.org/pub/databases/uniprot/">https://ftp.uniprot.org/pub/databases/uniprot/</ext-link>) [<xref ref-type="bibr" rid="CR40">40</xref>], gnomAD (<ext-link ext-link-type="uri" xlink:href="https://gnomad.broadinstitute.org/downloads/">https://gnomad.broadinstitute.org/downloads/</ext-link>) [<xref ref-type="bibr" rid="CR1">1</xref>], and ACMG guided dataset (10.1016/j.gim.2021.11.018) [<xref ref-type="bibr" rid="CR41">41</xref>]. The datasets supporting the conclusions of this article are included within the article and its additional files. MAGPIE web-based prediction tool for all nonsynonymous exonic variants is available at <ext-link ext-link-type="uri" xlink:href="http://tools.shenlab-genomics.org/tools/MAGPIE">http://tools.shenlab-genomics.org/tools/MAGPIE</ext-link>.</p>
  </notes>
  <notes>
    <title>Declarations</title>
    <notes id="FPar1">
      <title>Ethics approval and consent to participate</title>
      <p id="Par118">Not applicable.</p>
    </notes>
    <notes id="FPar2">
      <title>Consent for publication</title>
      <p id="Par119">Not applicable.</p>
    </notes>
    <notes id="FPar3" notes-type="COI-statement">
      <title>Competing interests</title>
      <p id="Par120">The authors have submitted a patent application for the method. Other than this, the authors declare that they do not have any competing interests.</p>
    </notes>
  </notes>
  <ref-list id="Bib1">
    <title>References</title>
    <ref id="CR1">
      <label>1.</label>
      <mixed-citation publication-type="other">Karczewski KJ, Francioli LC, Tiao G, Cummings BB, Alfoldi J, Wang Q, ... MacArthur DG. The mutational constraint spectrum quantified from variation in 141,456 humans. Nature. 2020;581(7809):434–443.</mixed-citation>
    </ref>
    <ref id="CR2">
      <label>2.</label>
      <mixed-citation publication-type="other">Lek M, Karczewski KJ, Minikel EV, Samocha KE, Banks E, Fennell T, ... Exome Aggregation Consortium. Analysis of protein-coding genetic variation in 60,706 humans. Nature. 2016;536(7616):285-291</mixed-citation>
    </ref>
    <ref id="CR3">
      <label>3.</label>
      <mixed-citation publication-type="other">Cao Y, Li L, Xu M, Feng Z, Sun X, Lu J, ... Wang W. The ChinaMAP analytics of deep whole genome sequences in 10,588 individuals. Cell Res. 2020;30(9):717–731.</mixed-citation>
    </ref>
    <ref id="CR4">
      <label>4.</label>
      <mixed-citation publication-type="other">Landrum MJ, Lee JM, Benson M, Brown G, Chao C, Chitipiralla S, ... Maglott DR. ClinVar: public archive of interpretations of clinically relevant variants. Nucleic Acids Res. 2016;44(D1), D862-D868.</mixed-citation>
    </ref>
    <ref id="CR5">
      <label>5.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Amberger</surname>
            <given-names>JS</given-names>
          </name>
          <name>
            <surname>Bocchini</surname>
            <given-names>CA</given-names>
          </name>
          <name>
            <surname>Schiettecatte</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Scott</surname>
            <given-names>AF</given-names>
          </name>
          <name>
            <surname>Hamosh</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>OMIM. org: Online Mendelian Inheritance in Man (OMIM®), an online catalog of human genes and genetic disorders</article-title>
        <source>Nucleic Acids Res.</source>
        <year>2015</year>
        <volume>43</volume>
        <issue>D1</issue>
        <fpage>D789</fpage>
        <lpage>D798</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/gku1205</pub-id>
        <?supplied-pmid 25428349?>
        <pub-id pub-id-type="pmid">25428349</pub-id>
      </element-citation>
    </ref>
    <ref id="CR6">
      <label>6.</label>
      <mixed-citation publication-type="other">Stenson PD, Mort M, Ball EV, Evans K, Hayden M, Heywood S, ... Cooper DN. The Human Gene Mutation Database: towards a comprehensive repository of inherited mutation data for medical research, genetic diagnosis and next-generation sequencing studies. Hum Genet. 2017;136:665–677.</mixed-citation>
    </ref>
    <ref id="CR7">
      <label>7.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ng</surname>
            <given-names>PC</given-names>
          </name>
          <name>
            <surname>Henikoff</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>SIFT: predicting amino acid changes that affect protein function</article-title>
        <source>Nucleic Acids Res</source>
        <year>2003</year>
        <volume>31</volume>
        <issue>13</issue>
        <fpage>3812</fpage>
        <lpage>3814</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/gkg509</pub-id>
        <?supplied-pmid 12824425?>
        <pub-id pub-id-type="pmid">12824425</pub-id>
      </element-citation>
    </ref>
    <ref id="CR8">
      <label>8.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Adzhubei</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Jordan</surname>
            <given-names>DM</given-names>
          </name>
          <name>
            <surname>Sunyaev</surname>
            <given-names>SR</given-names>
          </name>
        </person-group>
        <article-title>Predicting functional effect of human missense mutations using PolyPhen-2</article-title>
        <source>Curr Protoc Hum Genet</source>
        <year>2013</year>
        <volume>76</volume>
        <issue>1</issue>
        <fpage>7</fpage>
        <lpage>20</lpage>
      </element-citation>
    </ref>
    <ref id="CR9">
      <label>9.</label>
      <mixed-citation publication-type="other">Choi Y, Sims GE, Murphy S, Miller JR, Chan AP. Predicting the functional effect of amino acid substitutions and indels. 2012.</mixed-citation>
    </ref>
    <ref id="CR10">
      <label>10.</label>
      <mixed-citation publication-type="other">Li B, Krishnan VG, Mort ME, Xin F, Kamati KK, Cooper DN, ... Radivojac P. Automated inference of molecular mechanisms of disease from amino acid substitutions. Bioinformatics. 2009;25(21):2744–2750.</mixed-citation>
    </ref>
    <ref id="CR11">
      <label>11.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Reva</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Antipin</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Sander</surname>
            <given-names>C</given-names>
          </name>
        </person-group>
        <article-title>Predicting the functional impact of protein mutations: application to cancer genomics</article-title>
        <source>Nucleic Acids Res</source>
        <year>2011</year>
        <volume>39</volume>
        <issue>17</issue>
        <fpage>e118</fpage>
        <lpage>e118</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/gkr407</pub-id>
        <?supplied-pmid 21727090?>
        <pub-id pub-id-type="pmid">21727090</pub-id>
      </element-citation>
    </ref>
    <ref id="CR12">
      <label>12.</label>
      <mixed-citation publication-type="other">Shihab HA, Rogers MF, Gough J, Mort M, Cooper DN, Day IN, ... Campbell C. An integrative approach to predicting the functional effects of non-coding and coding sequence variation. Bioinformatics. 2015;31(10):1536–1543.</mixed-citation>
    </ref>
    <ref id="CR13">
      <label>13.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Dong</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Wei</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Jian</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Gibbs</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Boerwinkle</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Liu</surname>
            <given-names>X</given-names>
          </name>
        </person-group>
        <article-title>Comparison and integration of deleteriousness prediction methods for nonsynonymous SNVs in whole exome sequencing studies</article-title>
        <source>Hum Mol Genet</source>
        <year>2015</year>
        <volume>24</volume>
        <issue>8</issue>
        <fpage>2125</fpage>
        <lpage>2137</lpage>
        <pub-id pub-id-type="doi">10.1093/hmg/ddu733</pub-id>
        <?supplied-pmid 25552646?>
        <pub-id pub-id-type="pmid">25552646</pub-id>
      </element-citation>
    </ref>
    <ref id="CR14">
      <label>14.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Carter</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Douville</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Stenson</surname>
            <given-names>PD</given-names>
          </name>
          <name>
            <surname>Cooper</surname>
            <given-names>DN</given-names>
          </name>
          <name>
            <surname>Karchin</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>Identifying Mendelian disease genes with the variant effect scoring tool</article-title>
        <source>BMC Genomics</source>
        <year>2013</year>
        <volume>14</volume>
        <issue>3</issue>
        <fpage>1</fpage>
        <lpage>16</lpage>
        <pub-id pub-id-type="pmid">23323973</pub-id>
      </element-citation>
    </ref>
    <ref id="CR15">
      <label>15.</label>
      <mixed-citation publication-type="other">Frazer J, Notin P, Dias M, Gomez A, Min JK, Brock K, ... Marks DS. Disease variant prediction with deep generative models of evolutionary data. Nature. 2021;599(7883):91–95.</mixed-citation>
    </ref>
    <ref id="CR16">
      <label>16.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wu</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Liu</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Sun</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Weile</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Roth</surname>
            <given-names>FP</given-names>
          </name>
        </person-group>
        <article-title>Improved pathogenicity prediction for rare human missense variants</article-title>
        <source>Am J Hum Genet</source>
        <year>2021</year>
        <volume>108</volume>
        <issue>10</issue>
        <fpage>1891</fpage>
        <lpage>1906</lpage>
        <pub-id pub-id-type="doi">10.1016/j.ajhg.2021.08.012</pub-id>
        <?supplied-pmid 34551312?>
        <pub-id pub-id-type="pmid">34551312</pub-id>
      </element-citation>
    </ref>
    <ref id="CR17">
      <label>17.</label>
      <mixed-citation publication-type="other">Ioannidis NM, Rothstein JH, Pejaver V, Middha S, McDonnell SK, Baheti S, ... Sieh W. REVEL: an ensemble method for predicting the pathogenicity of rare missense variants. Am J Hum Genet. 2016;99(4):877–885.</mixed-citation>
    </ref>
    <ref id="CR18">
      <label>18.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Cheng</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Nguyen</surname>
            <given-names>TYD</given-names>
          </name>
          <name>
            <surname>Cygan</surname>
            <given-names>KJ</given-names>
          </name>
          <name>
            <surname>Çelik</surname>
            <given-names>MH</given-names>
          </name>
          <name>
            <surname>Fairbrother</surname>
            <given-names>WG</given-names>
          </name>
          <name>
            <surname>Gagneur</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>MMSplice: modular modeling improves the predictions of genetic variant effects on splicing</article-title>
        <source>Genome Biol</source>
        <year>2019</year>
        <volume>20</volume>
        <issue>1</issue>
        <fpage>1</fpage>
        <lpage>15</lpage>
        <pub-id pub-id-type="doi">10.1186/s13059-019-1653-z</pub-id>
        <pub-id pub-id-type="pmid">30606230</pub-id>
      </element-citation>
    </ref>
    <ref id="CR19">
      <label>19.</label>
      <mixed-citation publication-type="other">Jaganathan K, Panagiotopoulou SK, McRae JF, Darbandi SF, Knowles D, Li YI, ... Farh KKH. Predicting splicing from primary sequence with deep learning. Cell. 2019;176(3):535–548.</mixed-citation>
    </ref>
    <ref id="CR20">
      <label>20.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Rentzsch</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Witten</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Cooper</surname>
            <given-names>GM</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>CADD: predicting the deleteriousness of variants throughout the human genome</article-title>
        <source>Nucleic Acids Res</source>
        <year>2019</year>
        <volume>47</volume>
        <issue>D1</issue>
        <fpage>D886</fpage>
        <lpage>D894</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/gky1016</pub-id>
        <?supplied-pmid 30371827?>
        <pub-id pub-id-type="pmid">30371827</pub-id>
      </element-citation>
    </ref>
    <ref id="CR21">
      <label>21.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Quang</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Xie</surname>
            <given-names>X</given-names>
          </name>
        </person-group>
        <article-title>DANN: a deep learning approach for annotating the pathogenicity of genetic variants</article-title>
        <source>Bioinformatics</source>
        <year>2015</year>
        <volume>31</volume>
        <issue>5</issue>
        <fpage>761</fpage>
        <lpage>763</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btu703</pub-id>
        <?supplied-pmid 25338716?>
        <pub-id pub-id-type="pmid">25338716</pub-id>
      </element-citation>
    </ref>
    <ref id="CR22">
      <label>22.</label>
      <mixed-citation publication-type="other">Pejaver V, Urresti J, Lugo-Martinez J, Pagel KA, Lin GN, Nam HJ, ... Radivojac P. Inferring the molecular and phenotypic impact of amino acid variants with MutPred2. Nat Commun. 2020;11(1):5918.</mixed-citation>
    </ref>
    <ref id="CR23">
      <label>23.</label>
      <mixed-citation publication-type="other">Siepel A, Bejerano G, Pedersen JS, Hinrichs AS, Hou M, Rosenbloom K, ... Haussler D. Evolutionarily conserved elements in vertebrate, insect, worm, and yeast genomes. Genome Res. 2005;15(8):1034–1050.</mixed-citation>
    </ref>
    <ref id="CR24">
      <label>24.</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Van Rossum</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Drake</surname>
            <given-names>FL</given-names>
          </name>
        </person-group>
        <source>Python reference manual (Vol. 111)</source>
        <year>1995</year>
        <publisher-loc>Amsterdam</publisher-loc>
        <publisher-name>Centrum voor Wiskunde en Informatica</publisher-name>
        <fpage>1</fpage>
        <lpage>52</lpage>
      </element-citation>
    </ref>
    <ref id="CR25">
      <label>25.</label>
      <mixed-citation publication-type="other">The MathWorks Inc. MATLAB version: 9.13.0 (R2022b), Natick, Massachusetts: The MathWorks Inc; 2022. <ext-link ext-link-type="uri" xlink:href="https://www.mathworks.com">https://www.mathworks.com</ext-link>.</mixed-citation>
    </ref>
    <ref id="CR26">
      <label>26.</label>
      <mixed-citation publication-type="other">Pedregosa F, Varoquaux G, Gramfort A, Michel V, Thirion B, Grisel O, ... Duchesnay É. Scikit-learn: machine learning in Python. J Mach Learn Res. 2011;12:2825–2830.</mixed-citation>
    </ref>
    <ref id="CR27">
      <label>27.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wang</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Hakonarson</surname>
            <given-names>H</given-names>
          </name>
        </person-group>
        <article-title>ANNOVAR: functional annotation of genetic variants from high-throughput sequencing data</article-title>
        <source>Nucleic Acids Res</source>
        <year>2010</year>
        <volume>38</volume>
        <issue>16</issue>
        <fpage>e164</fpage>
        <lpage>e164</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/gkq603</pub-id>
        <?supplied-pmid 20601685?>
        <pub-id pub-id-type="pmid">20601685</pub-id>
      </element-citation>
    </ref>
    <ref id="CR28">
      <label>28.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ernst</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Kellis</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>ChromHMM: automating chromatin-state discovery and characterization</article-title>
        <source>Nat Methods</source>
        <year>2012</year>
        <volume>9</volume>
        <issue>3</issue>
        <fpage>215</fpage>
        <lpage>216</lpage>
        <pub-id pub-id-type="doi">10.1038/nmeth.1906</pub-id>
        <?supplied-pmid 22373907?>
        <pub-id pub-id-type="pmid">22373907</pub-id>
      </element-citation>
    </ref>
    <ref id="CR29">
      <label>29.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Nounou</surname>
            <given-names>MN</given-names>
          </name>
          <name>
            <surname>Bakshi</surname>
            <given-names>BR</given-names>
          </name>
          <name>
            <surname>Goel</surname>
            <given-names>PK</given-names>
          </name>
          <name>
            <surname>Shen</surname>
            <given-names>X</given-names>
          </name>
        </person-group>
        <article-title>Bayesian principal component analysis</article-title>
        <source>J Chemom</source>
        <year>2002</year>
        <volume>16</volume>
        <issue>11</issue>
        <fpage>576</fpage>
        <lpage>595</lpage>
        <pub-id pub-id-type="doi">10.1002/cem.759</pub-id>
      </element-citation>
    </ref>
    <ref id="CR30">
      <label>30.</label>
      <mixed-citation publication-type="other">Zhang T, Zhang Z, Fan Z, Luo H, Liu F, Cao W, Li J. OpenFE: automated feature generation beyond expert-level performance. 2022. arXiv preprint <ext-link ext-link-type="uri" xlink:href="http://arxiv.org/abs/2211.12507">arXiv:2211.12507</ext-link>.</mixed-citation>
    </ref>
    <ref id="CR31">
      <label>31.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Alirezaie</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Kernohan</surname>
            <given-names>KD</given-names>
          </name>
          <name>
            <surname>Hartley</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Majewski</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Hocking</surname>
            <given-names>TD</given-names>
          </name>
        </person-group>
        <article-title>ClinPred: prediction tool to identify disease-relevant nonsynonymous single-nucleotide variants</article-title>
        <source>Am J Hum Genet</source>
        <year>2018</year>
        <volume>103</volume>
        <issue>4</issue>
        <fpage>474</fpage>
        <lpage>483</lpage>
        <pub-id pub-id-type="doi">10.1016/j.ajhg.2018.08.005</pub-id>
        <?supplied-pmid 30220433?>
        <pub-id pub-id-type="pmid">30220433</pub-id>
      </element-citation>
    </ref>
    <ref id="CR32">
      <label>32.</label>
      <mixed-citation publication-type="other">Jagadeesh KA, Wenger AM, Berger MJ, Guturu H, Stenson PD, Cooper DN, ... Bejerano G. M-CAP eliminates a majority of variants of uncertain significance in clinical exomes at high sensitivity. Nat Genet. 2016;48(12):1581–1586.</mixed-citation>
    </ref>
    <ref id="CR33">
      <label>33.</label>
      <mixed-citation publication-type="other">Sundaram L, Gao H, Padigepati SR, McRae JF, Li Y, Kosmicki JA, ... Farh KKH. Predicting the clinical impact of human mutation with deep neural networks. Nat Genet. 2018;50(8):1161–1170.</mixed-citation>
    </ref>
    <ref id="CR34">
      <label>34.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Vaser</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Adusumalli</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Leng</surname>
            <given-names>SN</given-names>
          </name>
          <name>
            <surname>Sikic</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Ng</surname>
            <given-names>PC</given-names>
          </name>
        </person-group>
        <article-title>SIFT missense predictions for genomes</article-title>
        <source>Nat Protoc</source>
        <year>2016</year>
        <volume>11</volume>
        <issue>1</issue>
        <fpage>1</fpage>
        <lpage>9</lpage>
        <pub-id pub-id-type="doi">10.1038/nprot.2015.123</pub-id>
        <?supplied-pmid 26633127?>
        <pub-id pub-id-type="pmid">26633127</pub-id>
      </element-citation>
    </ref>
    <ref id="CR35">
      <label>35.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Malhis</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Jacobson</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Jones</surname>
            <given-names>SJ</given-names>
          </name>
          <name>
            <surname>Gsponer</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>LIST-S2: taxonomy based sorting of deleterious missense mutations across species</article-title>
        <source>Nucleic Acids Res</source>
        <year>2020</year>
        <volume>48</volume>
        <issue>W1</issue>
        <fpage>W154</fpage>
        <lpage>W161</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/gkaa288</pub-id>
        <?supplied-pmid 32352516?>
        <pub-id pub-id-type="pmid">32352516</pub-id>
      </element-citation>
    </ref>
    <ref id="CR36">
      <label>36.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Schwarz</surname>
            <given-names>JM</given-names>
          </name>
          <name>
            <surname>Cooper</surname>
            <given-names>DN</given-names>
          </name>
          <name>
            <surname>Schuelke</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Seelow</surname>
            <given-names>D</given-names>
          </name>
        </person-group>
        <article-title>MutationTaster2: mutation prediction for the deep-sequencing age</article-title>
        <source>Nat Methods</source>
        <year>2014</year>
        <volume>11</volume>
        <issue>4</issue>
        <fpage>361</fpage>
        <lpage>362</lpage>
        <pub-id pub-id-type="doi">10.1038/nmeth.2890</pub-id>
        <?supplied-pmid 24681721?>
        <pub-id pub-id-type="pmid">24681721</pub-id>
      </element-citation>
    </ref>
    <ref id="CR37">
      <label>37.</label>
      <mixed-citation publication-type="other">Ke G, Meng Q, Finley T, Wang T, Chen W, Ma W, ... Liu TY. LightGBM: a highly efficient gradient boosting decision tree. Adv Neural Inform Process Syst. 2017;30.</mixed-citation>
    </ref>
    <ref id="CR38">
      <label>38.</label>
      <mixed-citation publication-type="other">Itan Y, Shang L, Boisson B, Patin E, Bolze A, Moncada-Vélez M, ... Casanova JL. The human gene damage index as a gene-level approach to prioritizing exome variants. Proc Natl Acad Sci. 2015;112(44):13615–13620.</mixed-citation>
    </ref>
    <ref id="CR39">
      <label>39.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Dietz</surname>
            <given-names>HC</given-names>
          </name>
          <name>
            <surname>Pyeritz</surname>
            <given-names>RE</given-names>
          </name>
        </person-group>
        <article-title>Mutations in the human gene for fibrillin-1 (FBN1) in the Marfan syndrome and related disorders</article-title>
        <source>Hum Mol Genet</source>
        <year>1995</year>
        <volume>4</volume>
        <issue>suppl_1</issue>
        <fpage>1799</fpage>
        <lpage>1809</lpage>
        <pub-id pub-id-type="doi">10.1093/hmg/4.suppl_1.1799</pub-id>
        <?supplied-pmid 8541880?>
        <pub-id pub-id-type="pmid">8541880</pub-id>
      </element-citation>
    </ref>
    <ref id="CR40">
      <label>40.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bairoch</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Apweiler</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>The SWISS-PROT protein sequence database and its supplement TrEMBL in 2000</article-title>
        <source>Nucleic Acids Res</source>
        <year>2000</year>
        <volume>28</volume>
        <issue>1</issue>
        <fpage>45</fpage>
        <lpage>48</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/28.1.45</pub-id>
        <?supplied-pmid 10592178?>
        <pub-id pub-id-type="pmid">10592178</pub-id>
      </element-citation>
    </ref>
    <ref id="CR41">
      <label>41.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wilcox</surname>
            <given-names>EH</given-names>
          </name>
          <name>
            <surname>Sarmady</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Wulf</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Wright</surname>
            <given-names>MW</given-names>
          </name>
          <name>
            <surname>Rehm</surname>
            <given-names>HL</given-names>
          </name>
          <name>
            <surname>Biesecker</surname>
            <given-names>LG</given-names>
          </name>
          <name>
            <surname>Abou Tayoun</surname>
            <given-names>AN</given-names>
          </name>
        </person-group>
        <article-title>Evaluating the impact of in silico predictors on clinical variant classification</article-title>
        <source>Genet Med</source>
        <year>2022</year>
        <volume>24</volume>
        <issue>4</issue>
        <fpage>924</fpage>
        <lpage>930</lpage>
        <pub-id pub-id-type="doi">10.1016/j.gim.2021.11.018</pub-id>
        <?supplied-pmid 34955381?>
        <pub-id pub-id-type="pmid">34955381</pub-id>
      </element-citation>
    </ref>
  </ref-list>
</back>
<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName A++V2.4.dtd?>
<?SourceDTD.Version 2.4?>
<?ConverterInfo.XSLTName springer2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Genome Med</journal-id>
    <journal-id journal-id-type="iso-abbrev">Genome Med</journal-id>
    <journal-title-group>
      <journal-title>Genome Medicine</journal-title>
    </journal-title-group>
    <issn pub-type="epub">1756-994X</issn>
    <publisher>
      <publisher-name>BioMed Central</publisher-name>
      <publisher-loc>London</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">10773112</article-id>
    <article-id pub-id-type="pmid">38185709</article-id>
    <article-id pub-id-type="publisher-id">1274</article-id>
    <article-id pub-id-type="doi">10.1186/s13073-023-01274-4</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Method</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>MAGPIE: accurate pathogenic prediction for multiple variant types using machine learning approach</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author" equal-contrib="yes">
        <name>
          <surname>Liu</surname>
          <given-names>Yicheng</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <contrib contrib-type="author" equal-contrib="yes">
        <name>
          <surname>Zhang</surname>
          <given-names>Tianyun</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>You</surname>
          <given-names>Ningyuan</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <name>
          <surname>Wu</surname>
          <given-names>Sai</given-names>
        </name>
        <address>
          <email>wusai@zju.edu.cn</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0003-4709-3374</contrib-id>
        <name>
          <surname>Shen</surname>
          <given-names>Ning</given-names>
        </name>
        <address>
          <email>shenningzju@zju.edu.cn</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <aff id="Aff1"><label>1</label><institution-wrap><institution-id institution-id-type="GRID">grid.13402.34</institution-id><institution-id institution-id-type="ISNI">0000 0004 1759 700X</institution-id><institution>Department of Hepatobiliary and Pancreatic Surgery, First Affiliated &gt; Hospital &amp; Liangzhu Laboratory, </institution><institution>Zhejiang University School of Medicine, </institution></institution-wrap>Hangzhou, 311121 China </aff>
      <aff id="Aff2"><label>2</label><institution-wrap><institution-id institution-id-type="ROR">https://ror.org/00a2xv884</institution-id><institution-id institution-id-type="GRID">grid.13402.34</institution-id><institution-id institution-id-type="ISNI">0000 0004 1759 700X</institution-id><institution>College of Computer Science, </institution><institution>Zhejiang University, </institution></institution-wrap>Yuquan Campus, Zhejiang University, Rd Zheda 38, Xihu District, Hangzhou, 310007 China </aff>
    </contrib-group>
    <pub-date pub-type="epub">
      <day>8</day>
      <month>1</month>
      <year>2024</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>8</day>
      <month>1</month>
      <year>2024</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2024</year>
    </pub-date>
    <volume>16</volume>
    <elocation-id>3</elocation-id>
    <history>
      <date date-type="received">
        <day>14</day>
        <month>8</month>
        <year>2023</year>
      </date>
      <date date-type="accepted">
        <day>12</day>
        <month>12</month>
        <year>2023</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2023, corrected publication 2024</copyright-statement>
      <license>
        <ali:license_ref specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p><bold>Open Access</bold> This article is licensed under a Creative Commons Attribution 4.0 International License, which permits use, sharing, adaptation, distribution and reproduction in any medium or format, as long as you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons licence, and indicate if changes were made. The images or other third party material in this article are included in the article's Creative Commons licence, unless indicated otherwise in a credit line to the material. If material is not included in the article's Creative Commons licence and your intended use is not permitted by statutory regulation or exceeds the permitted use, you will need to obtain permission directly from the copyright holder. To view a copy of this licence, visit <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>. The Creative Commons Public Domain Dedication waiver (<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/publicdomain/zero/1.0/">http://creativecommons.org/publicdomain/zero/1.0/</ext-link>) applies to the data made available in this article, unless otherwise stated in a credit line to the data.</license-p>
      </license>
    </permissions>
    <abstract id="Abs1">
      <p id="Par1">Identifying pathogenic variants from the vast majority of nucleotide variation remains a challenge. We present a method named Multimodal Annotation Generated Pathogenic Impact Evaluator (MAGPIE) that predicts the pathogenicity of multi-type variants. MAGPIE uses the ClinVar dataset for training and demonstrates superior performance in both the independent test set and multiple orthogonal validation datasets, accurately predicting variant pathogenicity. Notably, MAGPIE performs best in predicting the pathogenicity of rare variants and highly imbalanced datasets. Overall, results underline the robustness of MAGPIE as a valuable tool for predicting pathogenicity in various types of human genome variations. MAGPIE is available at <ext-link ext-link-type="uri" xlink:href="https://github.com/shenlab-genomics/magpie">https://github.com/shenlab-genomics/magpie</ext-link>.</p>
      <sec>
        <title>Supplementary Information</title>
        <p>The online version contains supplementary material available at 10.1186/s13073-023-01274-4.</p>
      </sec>
    </abstract>
    <kwd-group xml:lang="en">
      <title>Keywords</title>
      <kwd>Pathogenic prediction</kwd>
      <kwd>Multimodal annotation</kwd>
      <kwd>Machine learning</kwd>
      <kwd>Genomic variation</kwd>
    </kwd-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution>Liangzhu Laboratory</institution>
        </funding-source>
      </award-group>
    </funding-group>
    <custom-meta-group>
      <custom-meta>
        <meta-name>issue-copyright-statement</meta-name>
        <meta-value>© BioMed Central Ltd., part of Springer Nature 2024</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec id="Sec1">
    <title>Background</title>
    <p id="Par57">The rapid accumulation of the whole genome sequencing (WGS) and the whole exome sequencing (WES) data has led to the discovery of a tremendous number of genetic variations, both pathogenic and non-pathogenic. To aid the assessment and understanding of these variations, population databases such as gnomAD [<xref ref-type="bibr" rid="CR1">1</xref>], ExAC [<xref ref-type="bibr" rid="CR2">2</xref>], and ChinaMap [<xref ref-type="bibr" rid="CR3">3</xref>] have been established. Additionally, genetic disease databases, e.g., ClinVar [<xref ref-type="bibr" rid="CR4">4</xref>], OMIM [<xref ref-type="bibr" rid="CR5">5</xref>], and HGMD [<xref ref-type="bibr" rid="CR6">6</xref>], have also amassed a large amount of information on known pathogenic or benign genetic variations. These databases have been widely used as references in the genetic diagnosis of Mendelian diseases.</p>
    <p id="Par58">Pathogenic mutations that cause Mendelian diseases are known to function through various biological mechanisms and thus have been categorized and studied in different aspects. For instance, exonic mutations based on the protein sequence alterations are categorized into synonymous, missense, stop-gain, stop-loss, frameshift, etc. Synonymous mutations do not alter protein sequence, whereas missense mutations result in different amino acids being encoded. Since missense mutation-associated changes in protein sequence may potentially be pathogenic, various studies have focused on predicting the pathogenic impact of missense variants [<xref ref-type="bibr" rid="CR7">7</xref>–<xref ref-type="bibr" rid="CR17">17</xref>]. On the other hand, some mutations are pathogenic at the RNA level through splicing alterations, and these mutations are often located in the splicing donor, acceptor, and intronic regions. Consequently, splicing alterations have also been considered for the pathogenicity evaluation of mutations [<xref ref-type="bibr" rid="CR18">18</xref>, <xref ref-type="bibr" rid="CR19">19</xref>]. However, in clinical practice of genetic diagnosis using WES, different types of mutations and mechanisms should be considered simultaneously to identify the pathogenic mutation.</p>
    <p id="Par59">With the development of machine learning (ML) and deep learning (DL), many computational methods using ML or DL have been developed for predicting mutation disruption or pathogenicity. Some methods were developed based on specific biological mechanisms or data types. For example, SpliceAI employs a deep neural network to learn information about splicing codes of the genome and predict whether a mutation affects splicing [<xref ref-type="bibr" rid="CR19">19</xref>]. Frazer et al. proposed the evolutionary model of variant effect (EVE) based on a deep generation model of evolutionary data to predict the pathogenicity of human missense variants [<xref ref-type="bibr" rid="CR16">16</xref>]. On the other hand, some algorithms consider ensemble features from multiple aspects and build on top of existing pathogenicity prediction. For example, the Combined Annotation-Dependent Depletion (CADD) implements a support vector machine with annotation features in conservation metrics, regulatory information, transcript information, and so on [<xref ref-type="bibr" rid="CR20">20</xref>]. Daniel et al. proposed DANN, which uses the same features as CADD but integrates them into a deep neural network for better performance [<xref ref-type="bibr" rid="CR21">21</xref>]. REVEL is another approach proposed by Nilah et al. that uses a logistic regression model and relies on multiple pathogenicity prediction tools, including MutPred [<xref ref-type="bibr" rid="CR22">22</xref>], VEST [<xref ref-type="bibr" rid="CR14">14</xref>], PROVEAN [<xref ref-type="bibr" rid="CR9">9</xref>], Mutation Assessor [<xref ref-type="bibr" rid="CR11">11</xref>], and phastCons [<xref ref-type="bibr" rid="CR23">23</xref>]. Although the aforementioned methods are widely used or developed with state-of-the-art methods, they only apply to specific cases or depend on multiple prediction tools, leaving many genetic variants unpredictable in real-world prediction tasks.</p>
    <p id="Par60">In this study, we present MAGPIE (Multimodal Annotation Generated Pathogenic Impact Evaluator), a pathogenicity prediction tool for all nonsynonymous exonic variants. MAGPIE employs multimodal annotation to annotate all exonic variants to cope with various mutation types and pathogenic mechanisms. The idea is that from the user’s perspective, the pathogenicity of a variant should be jointly evaluated on multiple scopes, and MAGPIE can help automate this process by leveraging the modern machine learning methodologies. We benchmarked MAGPIE against 14 previously published methods and found that MAGPIE outperformed all other methods in both independent test set and several imbalanced orthogonal validation sets. Notably, MAGPIE was able to make predictions on multiple types of exonic mutations, fulfilling 5–60% of unapplicable missing values based on previous methods. Most importantly, the superior performance of MAGPIE in highly imbalanced validation dataset, as well as variants with low population allele frequency highlights its advantage in clinically relevant applications of interpreting VUS for individual patients, where the model is typically applied to identify less than 5% pathogenic variants from tens of thousands of candidate variants. We envision that MAGPIE will be a valuable tool and widely adopted for pathogenicity prediction in the field. MAGPIE is available as an online server at <ext-link ext-link-type="uri" xlink:href="http://tools.shenlab-genomics.org/tools/MAGPIE">http://tools.shenlab-genomics.org/tools/MAGPIE</ext-link>.</p>
  </sec>
  <sec id="Sec2">
    <title>Methods</title>
    <sec id="Sec3">
      <title>Data preparation</title>
      <p id="Par61">We ensemble several germline mutation databases as the source of our datasets. Germline mutations are changes to DNA that individuals inherit from the egg and sperm cells during conception. ClinVar database (<ext-link ext-link-type="uri" xlink:href="https://ftp.ncbi.nlm.nih.gov/pub/clinvar/">https://ftp.ncbi.nlm.nih.gov/pub/clinvar/</ext-link>, accessed 2022.6.24) was downloaded and included nonsynonymous SNV (missense variants), stop-gain variants, start-loss variants, frameshift mutations, nonframeshift mutations, and stop-loss variants [<xref ref-type="bibr" rid="CR4">4</xref>]. Variants were categorized as benign, including Likely_benign, Benign, and Benign/Likely_benign labels, and pathogenic, including Likely_pathogenic, Pathogenic, and Pathogenic/Likely_pathogenic, which were selected as true negative (benign) and true positive (pathogenic) labels respectively. All variants with conflicting interpretations and unknown labels were removed. After filtering, we initially identified 78,089 mutations from ClinVar.</p>
      <p id="Par62">To improve the model performance in classifying rare variants, we considered adding rare benign variants to the training dataset as a trade-off between preserving the importance of allele frequency information and helping identify rare pathogenic variants from rare benign variants. We selected ultra-rare benign variants with allele frequency between <inline-formula id="IEq1"><alternatives><tex-math id="M1">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$1{e}^{-5}$$\end{document}</tex-math><mml:math id="M2"><mml:mrow><mml:mn>1</mml:mn><mml:msup><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mn>5</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math><inline-graphic xlink:href="13073_2023_1274_Article_IEq1.gif"/></alternatives></inline-formula> and <inline-formula id="IEq2"><alternatives><tex-math id="M3">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$1{e}^{-3}$$\end{document}</tex-math><mml:math id="M4"><mml:mrow><mml:mn>1</mml:mn><mml:msup><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math><inline-graphic xlink:href="13073_2023_1274_Article_IEq2.gif"/></alternatives></inline-formula> based on the gnomAD database (<ext-link ext-link-type="uri" xlink:href="https://gnomad.broadinstitute.org/downloads/">https://gnomad.broadinstitute.org/downloads/</ext-link>, accessed 2022.09.14) [<xref ref-type="bibr" rid="CR1">1</xref>]. For most chromosomes, there existed about 500,000 available variants. Secondly, we randomly choose 5000 per chromosome. Thirdly, we filtered out variants without enough information after annotating by ANNOVAR (ANNOtate VARition). Finally, we randomly chose again and just retained 500 variants per chromosome. For chr11 and chrY, which did not contain enough variants, we kept them all and randomly used qualified ones in other chromosomes to fill the gap. In total, we incorporated 11,998 variants from gnomAD, and these variants were split into two subsets based on the proportion of the number of variants in ClinVar to that in SwissProt [<xref ref-type="bibr" rid="CR23">23</xref>] for further training and evaluation. We aim to enhance the model’s ability to deal with rare benign variants; thus, it is crucial to minimize the false positive rate influenced by the allele frequency to identify pathogenic variants in the clinical scenario.</p>
      <p id="Par63">We constructed an orthogonal validation set to evaluate the performance of our model. The orthogonal test set was constructed from SwissProt (<ext-link ext-link-type="uri" xlink:href="https://ftp.uniprot.org/pub/databases/uniprot/">https://ftp.uniprot.org/pub/databases/uniprot/</ext-link>, accessed 2022.7.10) [<xref ref-type="bibr" rid="CR23">23</xref>], which contains over 70,000 variants with validated pathogenicity labels. We selected exonic mutations, filtered out variants labeled as US (uncertain significance), and applied the filtering and transformation process to remove all synonymous SNVs, following the same steps used in the ClinVar training and test datasets.</p>
      <p id="Par64">We obtained the ACMG-guided dataset (10.1016/j.gim.2021.11.018, accessed 2023.05.22), which includes a total of 1270 mutations, from the official website as another orthogonal test panel. We first removed 328 mutations without clear clinical significance labeled as uncertain significance—insufficient evidence or uncertain significance—conflicting evidence, 93 variants whose position cannot be mapped from HGVS ID, 358 intronic, 3′ UTR, and 5′ UTR variants, splice sites, and synonymous SNVs, etc., to ensure a fair comparison with other methods (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S3). After filtering, a final dataset of 491 missense mutations was used to compare MAGPIE and other model performances.</p>
      <p id="Par65">Gene-level features encapsulate characteristics that are relevant to genes and are shared across variants within the same gene. As we used gene-level features, variants in the same gene share identical scores for these gene-level features, and it would cause some potential biases and label leakage. Therefore, we performed a random split according to genes. Let <inline-formula id="IEq3"><alternatives><tex-math id="M5">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$D$$\end{document}</tex-math><mml:math id="M6"><mml:mi>D</mml:mi></mml:math><inline-graphic xlink:href="13073_2023_1274_Article_IEq3.gif"/></alternatives></inline-formula> as the dataset to be split; <inline-formula id="IEq4"><alternatives><tex-math id="M7">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$A$$\end{document}</tex-math><mml:math id="M8"><mml:mi>A</mml:mi></mml:math><inline-graphic xlink:href="13073_2023_1274_Article_IEq4.gif"/></alternatives></inline-formula> and <inline-formula id="IEq5"><alternatives><tex-math id="M9">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$B$$\end{document}</tex-math><mml:math id="M10"><mml:mi>B</mml:mi></mml:math><inline-graphic xlink:href="13073_2023_1274_Article_IEq5.gif"/></alternatives></inline-formula> are datasets after splitting; <inline-formula id="IEq6"><alternatives><tex-math id="M11">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${L}_{A}$$\end{document}</tex-math><mml:math id="M12"><mml:msub><mml:mi>L</mml:mi><mml:mi>A</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13073_2023_1274_Article_IEq6.gif"/></alternatives></inline-formula>, <inline-formula id="IEq7"><alternatives><tex-math id="M13">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${L}_{B}$$\end{document}</tex-math><mml:math id="M14"><mml:msub><mml:mi>L</mml:mi><mml:mi>B</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13073_2023_1274_Article_IEq7.gif"/></alternatives></inline-formula>, and <inline-formula id="IEq8"><alternatives><tex-math id="M15">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${L}_{D}$$\end{document}</tex-math><mml:math id="M16"><mml:msub><mml:mi>L</mml:mi><mml:mi>D</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13073_2023_1274_Article_IEq8.gif"/></alternatives></inline-formula> are lists containing genes for datasets <inline-formula id="IEq9"><alternatives><tex-math id="M17">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$A$$\end{document}</tex-math><mml:math id="M18"><mml:mi>A</mml:mi></mml:math><inline-graphic xlink:href="13073_2023_1274_Article_IEq9.gif"/></alternatives></inline-formula> and <inline-formula id="IEq10"><alternatives><tex-math id="M19">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$B$$\end{document}</tex-math><mml:math id="M20"><mml:mi>B</mml:mi></mml:math><inline-graphic xlink:href="13073_2023_1274_Article_IEq10.gif"/></alternatives></inline-formula>; and let <inline-formula id="IEq11"><alternatives><tex-math id="M21">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$D$$\end{document}</tex-math><mml:math id="M22"><mml:mi>D</mml:mi></mml:math><inline-graphic xlink:href="13073_2023_1274_Article_IEq11.gif"/></alternatives></inline-formula> and <inline-formula id="IEq12"><alternatives><tex-math id="M23">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$N$$\end{document}</tex-math><mml:math id="M24"><mml:mi>N</mml:mi></mml:math><inline-graphic xlink:href="13073_2023_1274_Article_IEq12.gif"/></alternatives></inline-formula> as the proportion threshold of variants that should be added to <inline-formula id="IEq13"><alternatives><tex-math id="M25">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$A$$\end{document}</tex-math><mml:math id="M26"><mml:mi>A</mml:mi></mml:math><inline-graphic xlink:href="13073_2023_1274_Article_IEq13.gif"/></alternatives></inline-formula> and <inline-formula id="IEq14"><alternatives><tex-math id="M27">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${n}_{A}$$\end{document}</tex-math><mml:math id="M28"><mml:msub><mml:mi>n</mml:mi><mml:mi>A</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13073_2023_1274_Article_IEq14.gif"/></alternatives></inline-formula> as the realtime proportion of <inline-formula id="IEq15"><alternatives><tex-math id="M29">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$A$$\end{document}</tex-math><mml:math id="M30"><mml:mi>A</mml:mi></mml:math><inline-graphic xlink:href="13073_2023_1274_Article_IEq15.gif"/></alternatives></inline-formula> accounts for <inline-formula id="IEq16"><alternatives><tex-math id="M31">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$D$$\end{document}</tex-math><mml:math id="M32"><mml:mi>D</mml:mi></mml:math><inline-graphic xlink:href="13073_2023_1274_Article_IEq16.gif"/></alternatives></inline-formula>. After completing these steps, the resulting datasets would be as follows: <inline-formula id="IEq17"><alternatives><tex-math id="M33">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${L}_{A}$$\end{document}</tex-math><mml:math id="M34"><mml:msub><mml:mi>L</mml:mi><mml:mi>A</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13073_2023_1274_Article_IEq17.gif"/></alternatives></inline-formula> contains the randomly selected genes from <inline-formula id="IEq18"><alternatives><tex-math id="M35">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${L}_{D}$$\end{document}</tex-math><mml:math id="M36"><mml:msub><mml:mi>L</mml:mi><mml:mi>D</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13073_2023_1274_Article_IEq18.gif"/></alternatives></inline-formula>. <inline-formula id="IEq19"><alternatives><tex-math id="M37">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${L}_{B}$$\end{document}</tex-math><mml:math id="M38"><mml:msub><mml:mi>L</mml:mi><mml:mi>B</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13073_2023_1274_Article_IEq19.gif"/></alternatives></inline-formula> is the remaining genes in <inline-formula id="IEq20"><alternatives><tex-math id="M39">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${L}_{D}$$\end{document}</tex-math><mml:math id="M40"><mml:msub><mml:mi>L</mml:mi><mml:mi>D</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13073_2023_1274_Article_IEq20.gif"/></alternatives></inline-formula> after removing the selected genes. Datasets <inline-formula id="IEq21"><alternatives><tex-math id="M41">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$A$$\end{document}</tex-math><mml:math id="M42"><mml:mi>A</mml:mi></mml:math><inline-graphic xlink:href="13073_2023_1274_Article_IEq21.gif"/></alternatives></inline-formula> and <inline-formula id="IEq22"><alternatives><tex-math id="M43">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$B$$\end{document}</tex-math><mml:math id="M44"><mml:mi>B</mml:mi></mml:math><inline-graphic xlink:href="13073_2023_1274_Article_IEq22.gif"/></alternatives></inline-formula> consist of mutations occurring in genes belonging to categories <inline-formula id="IEq23"><alternatives><tex-math id="M45">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${L}_{A}$$\end{document}</tex-math><mml:math id="M46"><mml:msub><mml:mi>L</mml:mi><mml:mi>A</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13073_2023_1274_Article_IEq23.gif"/></alternatives></inline-formula> and <inline-formula id="IEq24"><alternatives><tex-math id="M47">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${L}_{B}$$\end{document}</tex-math><mml:math id="M48"><mml:msub><mml:mi>L</mml:mi><mml:mi>B</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13073_2023_1274_Article_IEq24.gif"/></alternatives></inline-formula> within dataset <inline-formula id="IEq25"><alternatives><tex-math id="M49">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$D$$\end{document}</tex-math><mml:math id="M50"><mml:mi>D</mml:mi></mml:math><inline-graphic xlink:href="13073_2023_1274_Article_IEq25.gif"/></alternatives></inline-formula>, respectively. We defined the splitting process in Algorithm 1:<fig position="anchor" id="Figa"><caption><p><bold>Algorithm 1.</bold> Dataset split</p></caption><graphic position="anchor" xlink:href="13073_2023_1274_Figa_HTML" id="MO1"/></fig></p>
      <p id="Par66">First, to further enhance the robustness of MAGPIE and ensure a fair comparison, we split the gnomAD dataset. Let <inline-formula id="IEq26"><alternatives><tex-math id="M51">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${n}_{ClinVar}$$\end{document}</tex-math><mml:math id="M52"><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi mathvariant="italic">ClinVar</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13073_2023_1274_Article_IEq26.gif"/></alternatives></inline-formula>, <inline-formula id="IEq27"><alternatives><tex-math id="M53">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${n}_{SwissProt}$$\end{document}</tex-math><mml:math id="M54"><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi mathvariant="italic">SwissProt</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13073_2023_1274_Article_IEq27.gif"/></alternatives></inline-formula>, and <inline-formula id="IEq28"><alternatives><tex-math id="M55">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${n}_{gnomAD}$$\end{document}</tex-math><mml:math id="M56"><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi mathvariant="italic">gnomAD</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13073_2023_1274_Article_IEq28.gif"/></alternatives></inline-formula> denote the number of variants in ClinVar, SwissProt, and gnomAD, respectively. We define dataset <inline-formula id="IEq29"><alternatives><tex-math id="M57">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$D$$\end{document}</tex-math><mml:math id="M58"><mml:mi>D</mml:mi></mml:math><inline-graphic xlink:href="13073_2023_1274_Article_IEq29.gif"/></alternatives></inline-formula> as gnomAD, threshold <inline-formula id="IEq30"><alternatives><tex-math id="M59">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$N$$\end{document}</tex-math><mml:math id="M60"><mml:mi>N</mml:mi></mml:math><inline-graphic xlink:href="13073_2023_1274_Article_IEq30.gif"/></alternatives></inline-formula> as <inline-formula id="IEq31"><alternatives><tex-math id="M61">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${n}_{ClinVar}/\left({n}_{ClinVar}+{n}_{SwissProt}\right)*{n}_{gnomAD}$$\end{document}</tex-math><mml:math id="M62"><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi mathvariant="italic">ClinVar</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">/</mml:mo><mml:mfenced close=")" open="("><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi mathvariant="italic">ClinVar</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi mathvariant="italic">SwissProt</mml:mi></mml:mrow></mml:msub></mml:mfenced><mml:mrow/><mml:mo>∗</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi mathvariant="italic">gnomAD</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="13073_2023_1274_Article_IEq31.gif"/></alternatives></inline-formula>, and randomly split <inline-formula id="IEq32"><alternatives><tex-math id="M63">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$D$$\end{document}</tex-math><mml:math id="M64"><mml:mi>D</mml:mi></mml:math><inline-graphic xlink:href="13073_2023_1274_Article_IEq32.gif"/></alternatives></inline-formula> into <inline-formula id="IEq33"><alternatives><tex-math id="M65">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$A$$\end{document}</tex-math><mml:math id="M66"><mml:mi>A</mml:mi></mml:math><inline-graphic xlink:href="13073_2023_1274_Article_IEq33.gif"/></alternatives></inline-formula> and <inline-formula id="IEq34"><alternatives><tex-math id="M67">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$B$$\end{document}</tex-math><mml:math id="M68"><mml:mi>B</mml:mi></mml:math><inline-graphic xlink:href="13073_2023_1274_Article_IEq34.gif"/></alternatives></inline-formula> which are then added to ClinVar and SwissProt, respectively. We named these two datasets as ClinVar_gnomAD and SwissProt_gnomAD. Second, we defined dataset <inline-formula id="IEq35"><alternatives><tex-math id="M69">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$D$$\end{document}</tex-math><mml:math id="M70"><mml:mi>D</mml:mi></mml:math><inline-graphic xlink:href="13073_2023_1274_Article_IEq35.gif"/></alternatives></inline-formula> as <inline-formula id="IEq36"><alternatives><tex-math id="M71">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ClinVar_{gnomAD}$$\end{document}</tex-math><mml:math id="M72"><mml:mrow><mml:mi>C</mml:mi><mml:mi>l</mml:mi><mml:mi>i</mml:mi><mml:mi>n</mml:mi><mml:mi>V</mml:mi><mml:mi>a</mml:mi><mml:msub><mml:mi>r</mml:mi><mml:mrow><mml:mi mathvariant="italic">gnomAD</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="13073_2023_1274_Article_IEq36.gif"/></alternatives></inline-formula>, threshold <inline-formula id="IEq37"><alternatives><tex-math id="M73">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$N$$\end{document}</tex-math><mml:math id="M74"><mml:mi>N</mml:mi></mml:math><inline-graphic xlink:href="13073_2023_1274_Article_IEq37.gif"/></alternatives></inline-formula> as <inline-formula id="IEq38"><alternatives><tex-math id="M75">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\left({n}_{ClinVar}+{n}_{ClinVar}/\left({n}_{ClinVar}+{n}_{SwissProt}\right)*{n}_{gnomAD}\right)*10\%$$\end{document}</tex-math><mml:math id="M76"><mml:mrow><mml:mfenced close=")" open="("><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi mathvariant="italic">ClinVar</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi mathvariant="italic">ClinVar</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">/</mml:mo><mml:mfenced close=")" open="("><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi mathvariant="italic">ClinVar</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi mathvariant="italic">SwissProt</mml:mi></mml:mrow></mml:msub></mml:mfenced><mml:mrow/><mml:mo>∗</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi mathvariant="italic">gnomAD</mml:mi></mml:mrow></mml:msub></mml:mfenced><mml:mrow/><mml:mo>∗</mml:mo><mml:mn>10</mml:mn><mml:mo>%</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="13073_2023_1274_Article_IEq38.gif"/></alternatives></inline-formula> and randomly split <inline-formula id="IEq39"><alternatives><tex-math id="M77">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$D$$\end{document}</tex-math><mml:math id="M78"><mml:mi>D</mml:mi></mml:math><inline-graphic xlink:href="13073_2023_1274_Article_IEq39.gif"/></alternatives></inline-formula> into <inline-formula id="IEq40"><alternatives><tex-math id="M79">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$A$$\end{document}</tex-math><mml:math id="M80"><mml:mi>A</mml:mi></mml:math><inline-graphic xlink:href="13073_2023_1274_Article_IEq40.gif"/></alternatives></inline-formula> and <inline-formula id="IEq41"><alternatives><tex-math id="M81">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$B$$\end{document}</tex-math><mml:math id="M82"><mml:mi>B</mml:mi></mml:math><inline-graphic xlink:href="13073_2023_1274_Article_IEq41.gif"/></alternatives></inline-formula>, namely training and independent test set respectively. Finally, we excluded all variants in <inline-formula id="IEq42"><alternatives><tex-math id="M83">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$SwissProt_{gnomAD}$$\end{document}</tex-math><mml:math id="M84"><mml:mrow><mml:mi>S</mml:mi><mml:mi>w</mml:mi><mml:mi>i</mml:mi><mml:mi>s</mml:mi><mml:mi>s</mml:mi><mml:mi>P</mml:mi><mml:mi>r</mml:mi><mml:mi>o</mml:mi><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi mathvariant="italic">gnomAD</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="13073_2023_1274_Article_IEq42.gif"/></alternatives></inline-formula> located on genes that appear in ClinVarTraining and defined it as an orthogonal validation set.</p>
    </sec>
    <sec id="Sec4">
      <title>MAGPIE framework</title>
      <p id="Par67">The machine learning component of MAGPIE is based on a gradient-boosting tree-based model of classifying pathogenic and benign variants, which includes three steps. First, we annotated candidate SNVs to obtain information needed for model training. Second, we used automated feature engineering to pull out meaningful features from the datasets, and then we designed a feature selection strategy to obtain the optimal combination of features to feed the model. Finally, we trained the model using the processed dataset with step-wise tuning to make the process controllable and avoid overfitting.</p>
      <p id="Par68">The whole framework in this paper was mainly implemented in Python (v3.7) [<xref ref-type="bibr" rid="CR24">24</xref>] and MATLAB [<xref ref-type="bibr" rid="CR25">25</xref>], and other models were built using the sklearn (v0.21.3) package [<xref ref-type="bibr" rid="CR26">26</xref>].</p>
    </sec>
    <sec id="Sec5">
      <title>Feature annotation</title>
      <p id="Par69">We annotated candidate SNVs with ANNOVAR (24 October 2019, latest version) [<xref ref-type="bibr" rid="CR27">27</xref>] and included predicted scores provided by SpliceAI [<xref ref-type="bibr" rid="CR19">19</xref>].</p>
      <p id="Par70">As for feature selection, we used ANNOVAR, SpliceAI, and the ChromHMM [<xref ref-type="bibr" rid="CR28">28</xref>] model to annotate candidate variants and ended up with 132 features. To narrow down the number of features, we applied several models on the ClinVar dataset with all these features and kept the models that satisfied over 95% accuracy on the validation set. Then, we calculated feature importance of all input features based on these models and filtered out features whose contribution to the models is less than <inline-formula id="IEq43"><alternatives><tex-math id="M85">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$1{e}^{-3}$$\end{document}</tex-math><mml:math id="M86"><mml:mrow><mml:mn>1</mml:mn><mml:msup><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math><inline-graphic xlink:href="13073_2023_1274_Article_IEq43.gif"/></alternatives></inline-formula>. The number of features was reduced to 60 and below. We will describe these features in detail (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S4-S5).</p>
      <p id="Par71">For further training, we included six different types of variant classifications, namely nonsynonymous SNV (missense), startloss, stopgain, stoploss, frameshift, and non-frameshift. For each type of variant, 60 features were retrieved from the annotated datasets, including six categories: (1) epigenomics, (2) functional effects, (3) splicing effects, (4) population-based features, (5) biochemical properties, and (6) conservation (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S4-S5). And in our model, we excluded all predicted scores from variant pathogenicity prediction tools to minimize the effects of prior bias.</p>
      <p id="Par72">Epigenomics of each variant was annotated by the 15-state ChromHMM model across nine different cell lines in order to capture the significant combinatorial interactions between different chromatin marks in their spatial context (chromatin states). Functional effects included the gene damage index (GDI), residual variation intolerance score (RVIS), gene intolerance scores based on the loss of function tool (LoFtool), variant types, and annotations from the OMIM database. We use variant types as features including missense, frameshift, nonframeshift, startloss, stopgain, and stoploss. We use the OMIM database to annotate the mutation inheritance pattern, which is categorized into five distinct types: autosomal recessive, autosomal dominant, X-linked recessive, X-linked dominant, and others. Epigenomics features, variant type features, and mutation inheritance pattern features are one-hot encoded and fed into the model for training.</p>
      <p id="Par73">SpliceAI annotated each variant with its predicted effect on splicing. The delta score of the variant represents the probability of the variant being splice-altering as acceptor gain (DS_AG), acceptor loss (DS_AL), donor gain (DS_DG), and donor loss (DS_DL). Furthermore, we also obtained information about the location where splicing changes relative to the variant position, which included the delta position of acceptor gain (DP_AG), acceptor loss (DP_AL), donor gain (DP_DG), and donor loss (DP_DL). SpliceAI does not annotate variants if they are close to chromosome ends or too long reference sequences. We use 0 to fill in missing values of SpliceAI prediction.</p>
      <p id="Par74">Population-based features represented the incidence of an allele in a population, including 12 different types of allele frequencies (AF). We retrieved AF in various populations: all exome, raw allele frequency (AF_raw), African (AF_afr), Latino/Admixed American (AF_amr), Ashkenazi Jewish (AF_asj), East Asian (AF_eas), Finnish in Finland (AF_fin), Non-Finnish European (AF_nfe), and other (AF_oth). Besides, allele frequencies in different genders were also obtained from annotated information.</p>
      <p id="Par75">Biochemical properties contain the effects of amino acid changes before and after mutations. We first checked whether the mutation causes an amino acid change, and if not, we assigned 0 to all relevant features. Amino acid change (AAchange) was used as the basis for subsequent annotation. We stored the physicochemical properties of each amino acid, including molecular weight, equipotential point, dissociation constant, hydrophilicity, polarity, acid–base, etc., in a matrix, in which the characteristics of Boolean type were represented by 1/0. We obtained the corresponding properties of the amino acids by querying the matrix and took the delta value between the properties before and after the mutation as the features of the mutation. We then employed different strategies for different types of variants since some variants cause multiple amino acid changes, which require specific handling. When a mutation affects more than one amino acid, we calculate the average value before and after the change, respectively, to ensure that the feature selection process is comprehensively representative. We also used the information obtained from the BLOSUM100 matrix as a feature to demonstrate the conservation and similarity of amino acid substitutions.</p>
      <p id="Par76">Conservation scores included phastCons 20way mammalian, 30way mammalian, 100way mammalian, 100way vertebrate; phyloP 20way mammalian, 30way mammalian, 100way vertebrate; and odds ratios of SiPhy 29way mammalian.</p>
      <p id="Par77">We use the Bayesian PCA-based missing value estimation method by Oba et al. [<xref ref-type="bibr" rid="CR29">29</xref>] to impute missing values for several features in preparing the next steps, and any outliers that may arise from extensive imputation are carefully removed from our analysis.</p>
    </sec>
    <sec id="Sec6">
      <title>Feature engineering and selection</title>
      <p id="Par78">We applied automated feature engineering on our training dataset to generate tens of thousands of candidate features to capture potential non-linear and more complex relationships within the data.</p>
      <p id="Par79">We first generate new features based on mathematical transformations of the existing numerical features. AutoFE (automatically feature engineering) applied operations such as logarithms, square roots, and exponentials to the original features. Next, we created new categorical features by grouping the original features based on their values. For example, we grouped conservation scores into categories by binning. These categorical features could capture relationships that might not be easily captured by the original numerical ones. We use the openFE [<xref ref-type="bibr" rid="CR30">30</xref>] package to perform autoFE.</p>
      <p id="Par80">After generating these new features, we used the default method defined in openFE to perform feature selection to remove any redundant or irrelevant features. OpenFE evaluated the importance of each feature and removed those that did not contribute significantly to the model’s predictive power. Even though the dataset still contains over 3000 features for each variant, which could lead to over-fitting. So, we stepped further based on openFE to perform separated feature selection (SFS).</p>
      <p id="Par81">In our study, we segregated all features into two categories, namely a core set and an add-on set. The former included features related to pathogenicity with validated evidence, such as population-based features, conservation, and functional effects. These features were retained during the training phase. The latter comprised additional features, including biochemical properties, splicing effects, epigenomics, and automated feature-engineered features. We then employed a feature selection process to determine the most important ones for feeding our model. We initially trained a simplified tree-based model for less than 50 rounds to reduce the features to 200 or less. Subsequently, after each round, we evaluated the importance of each feature and discarded those with relative importance scores lower than <inline-formula id="IEq44"><alternatives><tex-math id="M87">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$1{e}^{-3}$$\end{document}</tex-math><mml:math id="M88"><mml:mrow><mml:mn>1</mml:mn><mml:msup><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math><inline-graphic xlink:href="13073_2023_1274_Article_IEq44.gif"/></alternatives></inline-formula>.</p>
      <p id="Par82">After analysis, we observed that the core features exhibited prominent significance compared to the entire set of features. To further enhance the performance of our model, we conducted training using feature combinations, as described in Algorithm 2, to attain the optimal amalgamation of features that would yield superior performance on the test set.<fig position="anchor" id="Figb"><caption><p><bold>Algorithm 2.</bold> Separated feature selection</p></caption><graphic position="anchor" xlink:href="13073_2023_1274_Figb_HTML" id="MO2"/></fig></p>
    </sec>
    <sec id="Sec7">
      <title>Model training</title>
      <p id="Par83">MAGPIE was based on a LightGBM (LGBM) model for predicting pathogenicity. LightGBM has a faster training speed and lower memory consumption than other tree-based models. To better learn from data and avoid over-fitting problems, especially as a tree-based model, we defined five rounds to train the model with 5-fold cross-validation in each round.</p>
      <p id="Par84">We first set the initialization parameters of the model, where boosting type is set to gbdt, and the learning rate was set to 0.1. The purpose of the first round was to improve the accuracy, so in this round, we mainly searched for the depth of trees (3–8) and the maximum number of leaf nodes per tree (5–100). Meanwhile, we set early-stopping to 50 to minimize the magnitude of overfitting. The next four rounds of tuning were to make a trade-off between reducing the overfitting and ensuring accuracy after the first round of tuning. In the second round, we adjusted <italic>max_bin</italic>, the number of segments in the histogram algorithm, to discretize the eigenvalues. The value of <italic>min_data_in_leaf</italic> depended on the number of sample trees and <italic>num_leaves</italic> in the training data. Setting it larger can avoid generating a too-deep tree. The third round of adjusting the focus on <italic>feature_fraction</italic> and <italic>bagging_fraction</italic> was to specify a certain percentage of samples from all data for training, which can reduce the variance at the cost of increasing the bias. So, in this step, we tried to reduce the sampling proportion as much as possible while ensuring accuracy. In the fourth round of adjustment, <italic>lambda_l1</italic> and <italic>lambda_l2</italic> were tuned, representing the L1 and L2 regularization terms, respectively, which were used to filter the features and control their influence in the model to prevent some features from greatly affecting the whole model. Finally, we adjusted <italic>min_split_gain</italic>, which means that node splitting will only be performed when the gain is more significant than our given threshold, which will greatly limit the growth of trees. Upon completing the training process, we observed no substantial decrease in accuracy and classification performance measures. This outcome indicates the generalization ability of the model extends far beyond the boundaries of the training dataset, thereby mitigating the issue of learning bias commonly associated within datasets.</p>
    </sec>
    <sec id="Sec8">
      <title>Evaluate and compare models by multiple metrics</title>
      <p id="Par85">To quantitatively evaluate model performance, we compared MAGPIE with 14 other predicted tools including ClinPred [<xref ref-type="bibr" rid="CR31">31</xref>], REVEL [<xref ref-type="bibr" rid="CR17">17</xref>], MetaSVM [<xref ref-type="bibr" rid="CR13">13</xref>], MetaLR [<xref ref-type="bibr" rid="CR13">13</xref>], VEST4 [<xref ref-type="bibr" rid="CR14">14</xref>], M-CAP [<xref ref-type="bibr" rid="CR32">32</xref>], MutationAssessor [<xref ref-type="bibr" rid="CR11">11</xref>], PrimateAI [<xref ref-type="bibr" rid="CR33">33</xref>], SIFT4G [<xref ref-type="bibr" rid="CR34">34</xref>], LIST-S2 [<xref ref-type="bibr" rid="CR35">35</xref>], DANN [<xref ref-type="bibr" rid="CR21">21</xref>], MutationTaster [<xref ref-type="bibr" rid="CR36">36</xref>], VARITY [<xref ref-type="bibr" rid="CR16">16</xref>], and MutPred [<xref ref-type="bibr" rid="CR22">22</xref>]. SIFT4G score less than 0.05 is putatively pathogenic according to the authors’ recommendation. For other tools that predict continuous values or probabilities of pathogenicity, we utilized the threshold recommended by the authors in the corresponding article to distinguish between the pathogenic and benign variants. 0.025 is used for M-CAP, 0.8 for Mutation Assessor and PrimateAI, 0.85 for LIST-S2, 0.3 for MutationTaster, 0.79 for MutPred, and 0.5 as the threshold for other prediction tools. Variants with scores greater than or equal to the threshold in the prediction results of each tool possessed to be pathogenic, and those less than the threshold were benign.</p>
      <p id="Par86">Due to the different distribution of pathogenic and benign mutations in both the balanced test set and the imbalanced orthogonal set, we used several different metrics to assess the predictive performance of the model, including accuracy, precision, recall, specificity, F1-score, G-mean, Matthew’s correlation coefficient (MCC). Compared with accuracy and F1-score, MCC, which considers all components in the confusion matrices, can be used even if datasets are very imbalanced. We illustrated curves and computed the area under the receiver operating characteristic (ROC) curve (AUC).<disp-formula id="Equa"><alternatives><tex-math id="M89">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\text{accuracy}}=\frac{TP+TN}{TP+FP+TN+FN}$$\end{document}</tex-math><mml:math id="M90" display="block"><mml:mrow><mml:mtext>accuracy</mml:mtext><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi>T</mml:mi><mml:mi>P</mml:mi><mml:mo>+</mml:mo><mml:mi>T</mml:mi><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mi>T</mml:mi><mml:mi>P</mml:mi><mml:mo>+</mml:mo><mml:mi>F</mml:mi><mml:mi>P</mml:mi><mml:mo>+</mml:mo><mml:mi>T</mml:mi><mml:mi>N</mml:mi><mml:mo>+</mml:mo><mml:mi>F</mml:mi><mml:mi>N</mml:mi></mml:mrow></mml:mfrac></mml:mrow></mml:math><graphic xlink:href="13073_2023_1274_Article_Equa.gif" position="anchor"/></alternatives></disp-formula><disp-formula id="Equb"><alternatives><tex-math id="M91">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\text{precision}}=\frac{TP}{TP+FP}$$\end{document}</tex-math><mml:math id="M92" display="block"><mml:mrow><mml:mtext>precision</mml:mtext><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi mathvariant="italic">TP</mml:mi></mml:mrow><mml:mrow><mml:mi>T</mml:mi><mml:mi>P</mml:mi><mml:mo>+</mml:mo><mml:mi>F</mml:mi><mml:mi>P</mml:mi></mml:mrow></mml:mfrac></mml:mrow></mml:math><graphic xlink:href="13073_2023_1274_Article_Equb.gif" position="anchor"/></alternatives></disp-formula><disp-formula id="Equc"><alternatives><tex-math id="M93">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\text{recall}}=\frac{TP}{TP+FN}$$\end{document}</tex-math><mml:math id="M94" display="block"><mml:mrow><mml:mtext>recall</mml:mtext><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi mathvariant="italic">TP</mml:mi></mml:mrow><mml:mrow><mml:mi>T</mml:mi><mml:mi>P</mml:mi><mml:mo>+</mml:mo><mml:mi>F</mml:mi><mml:mi>N</mml:mi></mml:mrow></mml:mfrac></mml:mrow></mml:math><graphic xlink:href="13073_2023_1274_Article_Equc.gif" position="anchor"/></alternatives></disp-formula><disp-formula id="Equd"><alternatives><tex-math id="M95">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\text{specificity}}=\frac{TN}{TN+FP}$$\end{document}</tex-math><mml:math id="M96" display="block"><mml:mrow><mml:mtext>specificity</mml:mtext><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi mathvariant="italic">TN</mml:mi></mml:mrow><mml:mrow><mml:mi>T</mml:mi><mml:mi>N</mml:mi><mml:mo>+</mml:mo><mml:mi>F</mml:mi><mml:mi>P</mml:mi></mml:mrow></mml:mfrac></mml:mrow></mml:math><graphic xlink:href="13073_2023_1274_Article_Equd.gif" position="anchor"/></alternatives></disp-formula><disp-formula id="Eque"><alternatives><tex-math id="M97">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\text{Fbeta}}-{\text{score}}=\frac{(1+{{\text{beta}}}^{2})({\text{recall}}\times {\text{precision}})}{{\text{recall}}+{\text{precision}}\times {{\text{beta}}}^{2}}$$\end{document}</tex-math><mml:math id="M98" display="block"><mml:mrow><mml:mtext>Fbeta</mml:mtext><mml:mo>-</mml:mo><mml:mtext>score</mml:mtext><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:msup><mml:mrow><mml:mtext>beta</mml:mtext></mml:mrow><mml:mn>2</mml:mn></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mtext>recall</mml:mtext><mml:mo>×</mml:mo><mml:mtext>precision</mml:mtext><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mtext>recall</mml:mtext><mml:mo>+</mml:mo><mml:mtext>precision</mml:mtext><mml:mo>×</mml:mo><mml:msup><mml:mrow><mml:mtext>beta</mml:mtext></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mfrac></mml:mrow></mml:math><graphic xlink:href="13073_2023_1274_Article_Eque.gif" position="anchor"/></alternatives></disp-formula><disp-formula id="Equf"><alternatives><tex-math id="M99">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$g-{\text{mean}}=\sqrt{{\text{recall}}\times {\text{specificity}}}$$\end{document}</tex-math><mml:math id="M100" display="block"><mml:mrow><mml:mi>g</mml:mi><mml:mo>-</mml:mo><mml:mtext>mean</mml:mtext><mml:mo>=</mml:mo><mml:msqrt><mml:mrow><mml:mtext>recall</mml:mtext><mml:mo>×</mml:mo><mml:mtext>specificity</mml:mtext></mml:mrow></mml:msqrt></mml:mrow></mml:math><graphic xlink:href="13073_2023_1274_Article_Equf.gif" position="anchor"/></alternatives></disp-formula><disp-formula id="Equg"><alternatives><tex-math id="M101">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$mcc=\frac{TP\times TN-FP\times FN}{\sqrt{(TP+FP)(TP+FN)(TN+FP)(TN+FN)}}$$\end{document}</tex-math><mml:math id="M102" display="block"><mml:mrow><mml:mi>m</mml:mi><mml:mi>c</mml:mi><mml:mi>c</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi>T</mml:mi><mml:mi>P</mml:mi><mml:mo>×</mml:mo><mml:mi>T</mml:mi><mml:mi>N</mml:mi><mml:mo>-</mml:mo><mml:mi>F</mml:mi><mml:mi>P</mml:mi><mml:mo>×</mml:mo><mml:mi>F</mml:mi><mml:mi>N</mml:mi></mml:mrow><mml:msqrt><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>T</mml:mi><mml:mi>P</mml:mi><mml:mo>+</mml:mo><mml:mi>F</mml:mi><mml:mi>P</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>T</mml:mi><mml:mi>P</mml:mi><mml:mo>+</mml:mo><mml:mi>F</mml:mi><mml:mi>N</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>T</mml:mi><mml:mi>N</mml:mi><mml:mo>+</mml:mo><mml:mi>F</mml:mi><mml:mi>P</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>T</mml:mi><mml:mi>N</mml:mi><mml:mo>+</mml:mo><mml:mi>F</mml:mi><mml:mi>N</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msqrt></mml:mfrac></mml:mrow></mml:math><graphic xlink:href="13073_2023_1274_Article_Equg.gif" position="anchor"/></alternatives></disp-formula><disp-formula id="Equh"><alternatives><tex-math id="M103">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\text{AUC}}=\frac{{\sum }_{i=1}^{n}{\text{Ran}}{k}_{i}-\frac{n\left(n+1\right)}{2}}{{n}_{{\text{positive}}}\times {n}_{{\text{negative}}}}$$\end{document}</tex-math><mml:math id="M104" display="block"><mml:mrow><mml:mtext>AUC</mml:mtext><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>n</mml:mi></mml:msubsup><mml:mtext>Ran</mml:mtext><mml:msub><mml:mi>k</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>-</mml:mo><mml:mfrac><mml:mrow><mml:mi>n</mml:mi><mml:mfenced close=")" open="("><mml:mi>n</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mfenced></mml:mrow><mml:mn>2</mml:mn></mml:mfrac></mml:mrow><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mtext>positive</mml:mtext></mml:msub><mml:mo>×</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mtext>negative</mml:mtext></mml:msub></mml:mrow></mml:mfrac></mml:mrow></mml:math><graphic xlink:href="13073_2023_1274_Article_Equh.gif" position="anchor"/></alternatives></disp-formula></p>
      <p id="Par87">Here, <inline-formula id="IEq45"><alternatives><tex-math id="M105">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$n$$\end{document}</tex-math><mml:math id="M106"><mml:mi>n</mml:mi></mml:math><inline-graphic xlink:href="13073_2023_1274_Article_IEq45.gif"/></alternatives></inline-formula> is the total number of samples, <inline-formula id="IEq46"><alternatives><tex-math id="M107">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${n}_{positive}$$\end{document}</tex-math><mml:math id="M108"><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi mathvariant="italic">positive</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13073_2023_1274_Article_IEq46.gif"/></alternatives></inline-formula> is the number of positive samples, <inline-formula id="IEq47"><alternatives><tex-math id="M109">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${n}_{negative}$$\end{document}</tex-math><mml:math id="M110"><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi mathvariant="italic">negative</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13073_2023_1274_Article_IEq47.gif"/></alternatives></inline-formula> is the number of negative samples, and <inline-formula id="IEq48"><alternatives><tex-math id="M111">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$Ran{k}_{i}$$\end{document}</tex-math><mml:math id="M112"><mml:mrow><mml:mi>R</mml:mi><mml:mi>a</mml:mi><mml:mi>n</mml:mi><mml:msub><mml:mi>k</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="13073_2023_1274_Article_IEq48.gif"/></alternatives></inline-formula> is the rank of the <inline-formula id="IEq49"><alternatives><tex-math id="M113">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$i$$\end{document}</tex-math><mml:math id="M114"><mml:mi>i</mml:mi></mml:math><inline-graphic xlink:href="13073_2023_1274_Article_IEq49.gif"/></alternatives></inline-formula>-th sample’s predicted value among all samples. For samples with the same predicted value, their ranks are averaged.</p>
      <p id="Par88">Most models are designed to handle specific variant types or rely heavily on crucial information such as protein structure predictions. As a result, if a variant falls outside the model’s scope or crucial information is unavailable, the pathogenicity prediction becomes challenging. To assess the performance of these prediction tools, we excluded variants without available results for each tool and generated a confusion matrix using the true labels to derive relevant metrics. In addition, we also compared the performance of these tools on unpredictable variants by classifying the variants without predicted results as benign.</p>
    </sec>
    <sec id="Sec9">
      <title>Feature importance</title>
      <p id="Par89">The utilization of autoFE has facilitated the incorporation of numerous novel features, which are the culmination of distinct amalgamations of two distinct features or the distribution of one specific feature. In the case of the original features, the importance is derived from LightGBM. As for the combined features, which were hard to interpret in biology, we employ an average importance metric based on the number of contributing features, which is subsequently added to the original features. Ultimately, we determine the importance of each original feature, followed by the comparison and analysis.</p>
    </sec>
    <sec id="Sec10">
      <title>Website</title>
      <p id="Par90">The accompanying web services of MAGPIE have been developed as shown in Additional file <xref rid="MOESM2" ref-type="media">2</xref>: Fig. S1. The tool provides online search functionality for pathogenicity scores by entering information on possible single-nucleotide variants (SNVs). Additionally, users can register and request analysis for non-SNV mutations. The development of MAGPIE was initiated to enhance the precision and convenience of mutation pathogenicity prediction, providing comprehensive support to researchers and clinicians within the biomedical field.</p>
      <p id="Par91">Users of the MAGPIE tool can input mutation information in the chr:start–end-ref-alt format via the website to obtain pathogenicity scores. For bulk variant prediction, users can submit tasks by uploading a csv file. A task ID will be generated upon successful submission, enabling users to obtain pathogenicity annotations from the download page once the prediction process is complete. The tool aims to contribute to advancing research and treatment in this area.</p>
    </sec>
  </sec>
  <sec id="Sec11">
    <title>Results</title>
    <sec id="Sec12">
      <title>MAGPIE overview</title>
      <p id="Par92">MAGPIE is a computational method to predict the pathogenicity of multiple variant types using a gradient-boosting machine learning framework (Fig. <xref rid="Fig1" ref-type="fig">1</xref>). To prepare data used for modeling, we collected all mutations with a pathogenic interpretation in the ClinVar database and selected mutations labeled as pathogenic (including likely pathogenic) and benign (including likely benign). We then randomly selected 90% of the dataset to use as training data, rendering a total of 39,893 pathogenic and 38,125 benign variants to feed into the model.<fig id="Fig1"><label>Fig. 1</label><caption><p>Framework of MAGPIE. The model was trained to predict pathogenic scores of multi-type variants and included three steps. First, candidate variants were annotated with high-dimensional features covering six different modalities. Second, automatic feature engineering and separated feature selection were undertaken step by step. Finally, a gradient boosting method with controllable tuning was implemented to train the model and obtain predictions for the pathogenicity of variants</p></caption><graphic xlink:href="13073_2023_1274_Fig1_HTML" id="MO3"/></fig></p>
      <p id="Par93">The MAGPIE framework is composed of 3 steps (Fig. <xref rid="Fig1" ref-type="fig">1</xref>). First, for a given variant, MAGPIE annotates the variant with high dimensional features covering six different modalities, including epigenomics, functional effects, splicing effects, population-based features, biochemical properties, and conservation. In the second step, we use automatic feature engineering followed by feature selection to create candidate features based on the training dataset. Automatic feature engineering aims to create multiple new combinations of features based on input features automatically to capture as much information as possible. After that, feature selection is used to pull out meaningful features. Lastly, using 5-fold cross-validation and step-wise parameter tuning, we trained an interpretable gradient-boosting model (GBM) based on ensemble trees [<xref ref-type="bibr" rid="CR37">37</xref>] and predicted the probability of pathogenicity in candidate variants. The gradient-boosting model, namely LightGBM, uses algorithms like gradient-based one-side sampling (GOSS) and exclusive feature bundling (EFB) to accelerate the training process while assuring accuracy. The output of MAGPIE is a score of pathogenicity defined over the interval between 0 and 1, in which 0 refers to benign variants and 1 represents the most pathogenic. To understand how MAGPIE achieves satisfying performance with multiple modalities, we performed an ablation study to investigate the effects of the training dataset, feature selection, and LightGBM on MAGPIE. Moreover, the ablation study indicated that the MAGPIE integrating a series of modules achieved the best performance improvement in pathogenic prediction (Additional file <xref rid="MOESM2" ref-type="media">2</xref>: Fig. S2). A more detailed description of the MAGPIE framework is included in the “<xref rid="Sec3" ref-type="sec">Methods</xref>” section. Additionally, we made MAGPIE available through an online website to facilitate access and use of the tool at <ext-link ext-link-type="uri" xlink:href="http://tools.shenlab-genomics.org/tools/MAGPIE">http://tools.shenlab-genomics.org/tools/MAGPIE</ext-link> (Additional file <xref rid="MOESM2" ref-type="media">2</xref>: Fig. S1).</p>
    </sec>
    <sec id="Sec13">
      <title>MAGPIE is interpretable</title>
      <p id="Par94">The application of the gradient boosting approach makes MAGPIE an interpretable machine-learning model. To better understand the learned representation, we calculated the importance of different feature modalities and presented them in a network view (Fig. <xref rid="Fig2" ref-type="fig">2</xref>B). The feature importance in MAGPIE indicates the degree to which each feature contributes to the model and reflects their information gains. During the classification process, MAGPIE ensembled six modalities of features. Among them, the most important feature group is the functional effect, which includes measures such as the loss of function score (LoF_score), human gene damage index (GDI), and so on (Fig. <xref rid="Fig2" ref-type="fig">2</xref>A, B, Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S4-S5). Loss-of-function mutations have a greater likelihood of causing disease [<xref ref-type="bibr" rid="CR38">38</xref>]. As previous studies have shown, we found that pathogenic variants predicted by MAGPIE have significantly lower LoF scores than benign variants (Additional file <xref rid="MOESM2" ref-type="media">2</xref>: Fig. S3A). GDI is the accumulated mutational damage of each protein-coding human gene, and variants in highly damaged genes are less likely to be disease-causing. We observed a high weight assigned to the GDI feature, indicating that genes with a lower GDI tended to have higher MAGPIE prediction scores and were more likely to be pathogenic (Additional file <xref rid="MOESM2" ref-type="media">2</xref>: Fig. S3B), consistent with previously published studies [<xref ref-type="bibr" rid="CR26">26</xref>]. The second most important feature modality is population-based, which is correlated inversely to the pathogenicity in test datasets. The third most significant feature modality is conservation, which has been considered in many previous methods such as CADD, SIFT [<xref ref-type="bibr" rid="CR7">7</xref>], PolyPhen [<xref ref-type="bibr" rid="CR8">8</xref>], and VARITY [<xref ref-type="bibr" rid="CR16">16</xref>]. The importance of conservation is expected and indicates the validity of MAGPIE’s learned representations. Additionally, we observed that features within each modality are correlated, while features from different modality groups are more likely to be independent (Fig. <xref rid="Fig2" ref-type="fig">2</xref>A). This suggests that MAGPIE is capable of learning multiple-dimensional information from different feature classes. In other words, the learned representations were discriminative to help MAGPIE for classification.<fig id="Fig2"><label>Fig. 2</label><caption><p>Feature importance and correlation. <bold>A</bold> Correlation between features used to train MAGPIE. <bold>B</bold> A captivating hierarchical relationship diagram is presented, displaying the intricate relationship between features and the categories they belong to. Each dot in the outermost layer represents a distinct feature, while the size of the dots indicates their importance. The second layer depicts feature categories, with the size reflecting the sum of importance of the subordinate features. <bold>C</bold> The bar plot illustrates feature importance, which shows the contribution of each feature after feature selection. Part of the add-on features is automatically removed during the training process</p></caption><graphic xlink:href="13073_2023_1274_Fig2_HTML" id="MO4"/></fig></p>
    </sec>
    <sec id="Sec14">
      <title>MAGPIE outperforms existing methods across multiple conditions</title>
      <p id="Par95">We evaluated the performance of MAGPIE together with 14 previously published pathogenicity prediction methods including MutationAssessor, MetaSVM, MetaLR, VARITY, VEST4, REVEL, MutPred, DANN, ClinPred, PrimateAI, LIST-S2, M-CAP, MutationTaster, and SIFT4G [<xref ref-type="bibr" rid="CR11">11</xref>, <xref ref-type="bibr" rid="CR13">13</xref>, <xref ref-type="bibr" rid="CR14">14</xref>, <xref ref-type="bibr" rid="CR16">16</xref>, <xref ref-type="bibr" rid="CR17">17</xref>, <xref ref-type="bibr" rid="CR21">21</xref>, <xref ref-type="bibr" rid="CR22">22</xref>, <xref ref-type="bibr" rid="CR31">31</xref>–<xref ref-type="bibr" rid="CR36">36</xref>]. For benchmark purposes, we applied MAGPIE on the ClinVar training dataset as described in methods, and its independent split dataset, labeled as ClinVarTest hereafter, was used for evaluating all models, including MAGPIE performances (Fig. <xref rid="Fig3" ref-type="fig">3</xref>A). The ClinVarTest dataset contains 4356 pathogenic and 4310 benign mutations. Since we split datasets based on gene symbols, these variants and their corresponding gene-level features were not seen by the models in the training dataset (Fig. <xref rid="Fig3" ref-type="fig">3</xref>A, Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S1). To fairly compare MAGPIE with other methods, pathogenicity classifications were set according to the thresholds recommended by the authors. Nevertheless, MAGPIE outperformed all other classifiers on the benchmark with the highest AUC score of 0.995 and AUPRC of 0.995 (Fig. <xref rid="Fig3" ref-type="fig">3</xref>B, C, Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S6-S8). In comparison, other methods, i.e., MutationTaster, DANN, LIST-S2, SIFT4G, PrimateAI, M-CAP, and MutationAssessor achieved AUC from 0.61 to 0.91. The performance evaluation suggested that MAGPIE is a reliable tool for pathogenic prediction.<fig id="Fig3"><label>Fig. 3</label><caption><p>MAGPIE makes accurate predictions. <bold>A</bold> The pie chart showed the proportion of pathogenic and benign variants in the independent test set, and the bar plot illustrated the percentages of multi-type variants in the dataset. <bold>B</bold> The receiver operating characteristic curve of MAGPIE and 14 other predicted tools in the independent test set. The area under the curve (AUC) scores were shown in the bar plot. <bold>C</bold> Precision-recall curve of MAGPIE and 14 other predicted tools in the ClinVarTest dataset were illustrated. <bold>D</bold> Missing rate comparison of MAGPIE and 14 other predicted tools in the independent test set. The higher missing rate represented that the prediction tools cannot predict pathogenic scores on the larger number of candidate variants. <bold>E</bold> AUC comparison of MAGPIE and 14 other predicted tools in the ClinVarRare, which only included variants with AF &lt; 0.01. <bold>F</bold> AUBPRC comparison of MAGPIE and 14 other predicted tools in the ClinVarRare which only included variants with AF &lt; 0.01. <bold>G</bold> Percentages of predictable variants across different variant types in various tools. <bold>H</bold> Violin plots illustrated distributions of pathogenic scores. And bar plots showed the precisions in each category of pathogenic variants and benign variants</p></caption><graphic xlink:href="13073_2023_1274_Fig3_HTML" id="MO5"/></fig></p>
      <p id="Par96">Of note, existing pathogenic prediction tools mostly predicted a limited number of mutations, which indicated a lack of generalization of previous methods. For example, for published classifiers, i.e., ClinPred, REVEL, MetaSVM, MetaLR, MutationAssessor, PrimateAI, SIFT4G, LIST-S2, and M-CAP, 30–60% of candidate mutations were unpredictable by these methods (Fig. <xref rid="Fig3" ref-type="fig">3</xref>D), which leads to 30–60% of variants’ output as missing. These missing values were generated due to variant types not being predictable by specific prediction tools. In contrast, MAGPIE succeeded in predicting the pathogenicity of all variants in the dataset, fulfilling 3–60% of missing values predicted by other methods (Fig. <xref rid="Fig3" ref-type="fig">3</xref>C). In other words, for all the exonic variants assessed covering various mutation types other than synonymous mutation, the missing rate of MAGPIE is zero. In summary, MAGPIE outperformed all previously published machine learning methods as well as the state-of-the-art deep learning methods on this benchmark.</p>
      <p id="Par97">Finally, we constructed a rare mutation test set (ClinVarRare) to evaluate the ability of MAGPIE to identify pathogenic variants from rare benign variants, which is one of the major challenges in real-world analysis for genetic diagnosis of disease. The ClinVarRare test set included rare pathogenic ClinVar variants (AF &lt; 0.01) and rare benign variants from gnomAD (AF &lt; 0.01), which is more similar to the real whole-exome sequencing datasets. For the rare mutation test set, MAGPIE achieved the best performance with an AUC equal to 0.992, followed by REVEL, ClinPred, and MutPred. Previous computational tools predicted a proportion of variants within the whole dataset, and the rest of the variants were unpredictable because these tools were designed to classify specific types of variants. Consequently, we examined that MAGPIE predicted all 4881 variants in the ClinVarRare test set with the highest accuracy of 0.95 (Fig. <xref rid="Fig3" ref-type="fig">3</xref>E). In summary, MAGPIE outperforms all previously published machine learning methods and the state-of-the-art deep learning methods on both the ClinVarTest dataset and the ClinVarRare test dataset.</p>
    </sec>
    <sec id="Sec15">
      <title>MAGPIE achieves high performance in multiple mutation types</title>
      <p id="Par98">An important characteristic of MAGPIE is the ability to make pathogenic predictions on multiple types of mutations. The ClinVarTest dataset contains a total of 6 types of mutations: missense variants (or nonsynonymous SNV), stop-gain variants, start-loss variants, frameshift mutations, nonframeshift mutations, and stop-loss variants. MAGPIE was predictive of clinical significance for all labeled variants across various mutation types, while many available methods only applied to certain mutation types (Fig. <xref rid="Fig3" ref-type="fig">3</xref>G). Besides, the performance of our methods was robust to different variant types, suggesting the generalizability of our method (Fig. <xref rid="Fig3" ref-type="fig">3</xref>H).</p>
      <p id="Par99">We further analyzed the distribution of pathogenic scores across mutation types to evaluate the classification capability of MAGPIE. To visualize the distribution of MAGPIE-predicted pathogenic probability, we plotted the MAGPIE score distributions for different types of pathogenic and benign variants (Fig. <xref rid="Fig3" ref-type="fig">3</xref>H). For pathogenic variants, MAGPIE scores were highly concentrated around 1, and for benign variants, scores were near 0 across six types of variants. This suggested that our model can separate pathogenic and benign variants well. We further analyzed the ability of classification quantitatively and evaluated how accurately our model can predict pathogenicity. The average precision of all types of variants was 0.98, suggesting that 98% of predicted pathogenic variants were consistent with their true labels. And the average false predictive value was 0.8, meaning 80% of predicted benign mutations were true negatives. In particular, MAGPIE identified pathogenic and benign variants successfully in the imbalanced datasets of stop-loss and stop-gain mutations. As shown in Fig. <xref rid="Fig3" ref-type="fig">3</xref>G, MAGPIE detected pathogenic mutations in stop-loss and stop-gain mutations and minimized false positives (average precision of 1.0). Therefore, MAGPIE can accurately differentiate pathogenic and benign mutations across various mutation types.</p>
    </sec>
    <sec id="Sec16">
      <title>MAGPIE achieves the best performance on additional orthogonal datasets</title>
      <p id="Par100">We used the annotated variants from the SwissProt database as an orthogonal dataset to further benchmark MAGPIE against other methods. SwissProt contains 80,840 labeled variants, with 71,400 explicitly labeled as pathogenic or benign. Only variants with unique reference SNP ID mapping, in the exonic region, excluding synonymous SNVs, were retained. To ensure the independence of the orthogonal dataset, we further removed variants located on genes reported in the ClinVarTrain dataset. We also made the orthogonal dataset closer to the real scenario and evaluate the performance of MAGPIE in the imbalanced dataset with less than 10% positive samples. After filtering, the number of pathogenic and benign mutations became highly imbalanced. The number of benign variants was 12,075, while the number of pathogenic ones was only 1308, about 9.8% of the total number of variants to be tested (Fig. <xref rid="Fig4" ref-type="fig">4</xref>A, Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S2). We also conducted an ablation study in this imbalanced orthogonal dataset and found that the full model was much superior to other model variations of MAGPIE (Additional file <xref rid="MOESM2" ref-type="media">2</xref>: Fig. S2).<fig id="Fig4"><label>Fig. 4</label><caption><p>MAGPIE outperforms other models in orthogonal validation set and ACMG-guided dataset. <bold>A</bold> The pie chart showed the proportion of pathogenic and benign variants in the orthogonal validation set and the bar plot illustrated the percentages of multi-type variants in the dataset. <bold>B</bold> The receiver operating characteristic curve of MAGPIE and 14 other predicted tools in the orthogonal validation set. <bold>C</bold> The precision-recall curve of MAGPIE and 14 other predicted tools in the orthogonal validation set were illustrated. <bold>D</bold> Missing rate comparison of MAGPIE and 14 other predicted tools in the orthogonal validation set. The higher missing rate represented that the prediction tools cannot predict pathogenic scores on the larger number of candidate variants. <bold>E</bold> AUC comparison of MAGPIE and 14 other predicted tools in the SwissProtRare which only included variants with AF &lt; 0.01. <bold>F</bold> AUBPRC comparison of MAGPIE and 14 other predicted tools in the SwissProtRare which only included variants with AF &lt; 0.01. <bold>G</bold> The pie chart showed the proportion of pathogenic and benign variants in the ACMG-guided dataset, and the bar plot illustrated the percentages of multi-type variants in the dataset. <bold>H</bold> Performance comparison of MAGPIE and 14 other predicted tools in the ACMG-guided dataset. <bold>I</bold> The precision-recall curve of MAGPIE and 14 other predicted tools in the ACMG-guided dataset were illustrated</p></caption><graphic xlink:href="13073_2023_1274_Fig4_HTML" id="MO6"/></fig></p>
      <p id="Par101">Again, the performance of MAGPIE was superior to other machine learning and deep learning methods on this benchmark. MAGPIE outcompeted other tools with the best AUC of 0.97 and AUPRC of 0.88 (Fig. <xref rid="Fig4" ref-type="fig">4</xref>B, Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S6-S8). Furthermore, MAGPIE computed the pathogenic probability for all filtered variants without missing values (Fig. <xref rid="Fig4" ref-type="fig">4</xref>C), whereas VEST4, DANN, MutationTaster, and MetaSVM were the closest competitor with about 5% missing rate (Fig. <xref rid="Fig4" ref-type="fig">4</xref>C, Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S6-S8). As for M-CAP and MutPred, more than 40% variants were unpredictable. Hence, on this benchmark, MAGPIE was better than other methods in predicting novel pathogenic mutations.</p>
      <p id="Par102">To evaluate the performance of MAGPIE in the imbalanced test dataset with rare variants, we constructed a rare SwissProt test set (SwissProtRare) where all variants had AF less than 0.01. The dataset included 9% of rare pathogenic SwissProt variants and 91% of rare benign variants from gnomAD, an extreme case of an imbalanced rare variant dataset. MAGPIE outperformed all competitors with an AUC equal to 0.95, followed by REVEL (AUC = 0.92) and MutPred (AUC = 0.91) (Fig. <xref rid="Fig4" ref-type="fig">4</xref>E). In general, MAGPIE outperformed other competitors.</p>
      <p id="Par103">Three types of variants were included in the SwissProt dataset, and MAGPIE was able to differentiate well between pathogenic and benign variants across all variant types in the orthogonal dataset as well (Additional file <xref rid="MOESM2" ref-type="media">2</xref>: Fig. S4A). Additionally, we found that MAGPIE scores of pathogenic variants were concentrated close to 1. In contrast, the probabilities of benign variants were near 0, which will further support the reliability of our method (Additional file <xref rid="MOESM2" ref-type="media">2</xref>: Fig. S4B). Precision of pathogenic variants was higher than 0.85, suggesting that MAGPIE achieved accurate pathogenic variants prediction (Additional file <xref rid="MOESM2" ref-type="media">2</xref>: Fig. S4B). Consistent with the results in the ClinVarTest dataset, for start-loss and stop-gain variants, MAGPIE achieved higher precision than the precision of nonsynonymous SNVs (precisions of 0.95 and 1, respectively) (Additional file <xref rid="MOESM2" ref-type="media">2</xref>: Fig. S4B). The false predictive values of stop-loss and stop-gain variants were slightly lower than the false predictive values of nonsynonymous SNVs and start-loss variants. However, the average false predictive value achieved 0.8 (Additional file <xref rid="MOESM2" ref-type="media">2</xref>: Fig. S4B). Thus, MAGPIE could successfully predict new pathogenic variants among different variant types.</p>
      <p id="Par104">Furthermore, we assessed the performance of MAGPIE and other models on an additional validation set from ACMG test panel. We obtained the ACMG guided test panel (2023.05.22), which includes a total of 1270 mutations, from the official website. After filtering, a final dataset of 491 mutations was used to compare MAGPIE and other model performances. In contrast to the SwissProt dataset, in the imbalanced ACMG dataset, there were 82% of pathogenic variants and 18% of benign variants. Again, MAGPIE achieved the highest AUC and AUPRC among all methods (Additional file <xref rid="MOESM2" ref-type="media">2</xref>: Fig. S5-S6, Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S6-S8), illustrating that MAGPIE could classify pathogenic and benign in imbalanced datasets.</p>
    </sec>
    <sec id="Sec17">
      <title>Assessing MAGPIE performance with varying threshold</title>
      <p id="Par105">Different thresholds may affect the model performance, especially in imbalanced data. In the real-world clinical applications of pathogenic prediction tools to interpret VUS in individual patients, only a few pathogenic mutations should be identified out of tens of thousands of candidate variants called from WES data. Thus, the pathogenic prediction tasks are presumably assigned to handle highly imbalanced datasets. Therefore, we investigated the optimal threshold of MAGPIE under various data balance scenarios. The default parameter of our model is 0.5 in balanced datasets such as the ClinVarTest dataset. We found that with the predicted probabilities between 0.4 and 0.7, both the accuracy and F1-score were stable (Additional file <xref rid="MOESM2" ref-type="media">2</xref>: Fig. S7-S8). Besides, Matthew’s correlation coefficient (MCC), a measure of association for two binary variables, in the ClinVarTest dataset confirmed that 0.5 was a reliable threshold for this benchmark (Additional file <xref rid="MOESM2" ref-type="media">2</xref>: Fig. S7-S8).</p>
      <p id="Par106">To examine the effects of different ratios between the number of pathogenic and benign variants, the ClinVarTest dataset was randomly divided into a series of subsets with various combinations. We randomly added different proportions of pathogenic variants to all benign variants from the ClinVarTest dataset to construct independent test subsets. We can see that in such cases, the optimal thresholds had dropped from 0.95 to 0.72 (Additional file <xref rid="MOESM2" ref-type="media">2</xref>: Fig. S7). However, MCC, accuracy, and F1-score were relatively stable in these subsets, which illustrated that performances of MAGPIE had less impact caused by the different thresholds (Additional file <xref rid="MOESM2" ref-type="media">2</xref>: Fig. S7). Furthermore, we added various percentages of benign variants to all pathogenic variants. We also found similar results (Additional file <xref rid="MOESM2" ref-type="media">2</xref>: Fig. S8).</p>
      <p id="Par107">We next studied the orthogonal SwissProt dataset, which was highly imbalanced with only 9.8% pathogenic mutations, and the ACMG dataset, which only included 18% benign variants. The SwissProt dataset is more similar to real applied scenarios than the ClinVarTest dataset and has clear labels of pathogenicity. Therefore, a precision-recall curve can help us to evaluate the influence of classifier performance with different thresholds. We found that the optimal threshold in this dataset was 0.71 (Additional file <xref rid="MOESM2" ref-type="media">2</xref>: Fig. S9A). We analyzed the performance matrix in the dataset with the default threshold and the optimal threshold. Our findings showed that the performance of MAGPIE became better with stricter thresholds. MCC and F1-score increased by 2% and 3%, respectively (Additional file <xref rid="MOESM2" ref-type="media">2</xref>: Fig. S9A). Similarly, we observed that the optimal threshold of the ACMG dataset was 0.34 (Additional file <xref rid="MOESM2" ref-type="media">2</xref>: Fig. S9B). MCC and F1-score had been slightly improved. However, if there is no precise estimate of the compositions of the dataset, MAGPIE with the default parameter still outperformed other methods. Therefore, using a default threshold can also achieve accurate prediction on both imbalanced and balanced datasets as shown before.</p>
    </sec>
    <sec id="Sec18">
      <title>MAGPIE prediction on gene mutations that cause Mendelian diseases</title>
      <p id="Par108">Next, we applied MAGPIE to four genes curated with a large number of known pathogenic mutations causing different Mendelian diseases (Methods). For all the four genes tested, i.e., ATP7B, CFTR, FBN1, and LMNA, MAGPIE was able to recover the largest number of known pathogenic mutations compared to other methods with default parameters (Fig. <xref rid="Fig5" ref-type="fig">5</xref>A). On average, MAGPIE recovered 96% of known pathogenic variants. For instance, for FBN1, the gene mutated in Marfan syndrome [<xref ref-type="bibr" rid="CR39">39</xref>] and included 1621 pathogenic mutations. MAGPIE predicted 1450 (87%) candidate variants as pathogenic, and MAGPIE scores of 95% pathogenic variants were close to 1 (Fig. <xref rid="Fig5" ref-type="fig">5</xref>B). All other tools correctly classified a smaller fraction of variants, which was lower than 70%. For CFTR (which is associated with cystic fibrosis), MAGPIE predicted 164 (95%) variants to be pathogenic. Compared to MutationTaster, VEST4, and other tools, MAGPIE scores were concentrated about 1 (Fig. <xref rid="Fig5" ref-type="fig">5</xref>B). Moreover, the performance of our classifier on ATP7B and FBN1 was better than other methods, indicating a stable performance for evaluating pathogenicity despite using entirely different disease-associated genes (Fig. <xref rid="Fig5" ref-type="fig">5</xref>A, B). Thus, MAGPIE performs better in identifying pathogenic mutations that cause Mendelian diseases.<fig id="Fig5"><label>Fig. 5</label><caption><p>MAGPIE detects most variants in pathogenic genes. <bold>A</bold> Comparison of the number of detected pathogenic variants in four well-known pathogenic genes between MAGPIE and 14 other prediction tools. <bold>B</bold> Density plots illustrated distributions of pathogenic scores predicted by MAGPIE, MutationTaster, and VEST4. Moreover, the pie charts showed the proportion of predictable and unpredictable variants of each tool</p></caption><graphic xlink:href="13073_2023_1274_Fig5_HTML" id="MO7"/></fig></p>
    </sec>
  </sec>
  <sec id="Sec19">
    <title>Discussion</title>
    <p id="Par109">The next-generation sequencing has revealed tremendous amount of genetic variations in the human population. However, it has raised another challenge: the difficulty of identifying the actual disease-causing mutation from the millions of normal variations. The current computation tools have enabled to predict one or several specific types of mutations. For example, M-CAP, MutationTaster, and PrimateAI focus on missense variants. However, specific types of variants have been filtered out due to the models’ scope. Various types of mutations present the challenge of the generalization ability for computational methods to predict pathogenic scores among mutations. Therefore, it is critical to train a generalized classifier foremost to expand predictable variant types.</p>
    <p id="Par110">To address this challenge, we report a computational classifier named MAGPIE, which focuses on classifying multiple types of mutations of uncertain significance for Mendelian diseases. The novelty of this work comes from a combination of data preparation, feature extraction, feature engineering, and model selection. The overall idea is that from the users’ perspective, the pathogenicity of a variant should be jointly evaluated on multiple scopes, which corresponds to features derived from six modalities in MAGPIE. Therefore, the machine learning components of MAGPIE are designed to maximize the models’ learning on multimodal data.</p>
    <p id="Par111">The machine learning component of MAGPIE mainly included autoFE and LightGBM, both of which we think contributes to the novelty of the method. In the pathogenicity prediction task, the pathogenicity of variants may be caused by multiple types of features. To enhance the model’s performance, we aimed to integrate these multimodal features. By incorporating the autoFE component, MAGPIE has the capability to handle the complexity of the features and effectively capture the underlying relationships. This enables us to extract valuable information from the features and improve the overall performance of our model. This process involves applying certain transformations to the features, allowing for a better representation of their performance in predicting mutation pathogenicity, such as through Group-By operations. Of note, MAGPIE employs separated feature selection and step-wise training approaches during the autoFE process to avoid overfitting. In our updated ablation study, the inclusion of the autoFE component enhances the performance of MAGPIE (Additional file <xref rid="MOESM2" ref-type="media">2</xref>: Fig. S2).</p>
    <p id="Par112">The input data for pathogenicity prediction in MAGPIE is in tabular format, which makes it suitable for tree-based models. Among the tree-based models, LightGBM stands out as one of the most efficient models in terms of both prediction accuracy and computational time. LightGBM is based on the gradient boosting framework and incorporates a number of advanced techniques such as histogram-based binning, leaf-wise tree growth, and gradient-based one-side sampling. These techniques improve model performance and enables faster training and inference times compared to other tree-based models or machine learning models. Consistently, in the ablation study for MAGPIE, we found that the computational time required for SVM with an identical training process was approximately 10 times longer than LightGBM. By incorporating LightGBM in MAGPIE, we are able to leverage its efficiency and accuracy to achieve accurate and timely pathogenicity predictions (Additional file <xref rid="MOESM2" ref-type="media">2</xref>: Fig. S10). Moreover, we can easily calculate feature importance from the LightGBM model, which enables the interpretability of MAGPIE.</p>
    <p id="Par113">Another novel aspect of MAGPIE design is the ability to make accurate prediction for rare variants, which is highly clinically relevant but not naturally well represented in ClinVar database as training source. In real-world pathogenicity prediction and diagnosis scenarios, it is common to encounter rare benign variants. Therefore, we aimed to include rare benign variants in the training of MAGPIE to enhance its ability to detect pathogenic variants in clinical settings. However, in large mutation datasets like ClinVar, rare benign variants make up a very small proportion of the dataset. To address this issue, we incorporated rare benign variants from gnomAD into the training set. By including rare benign variants from gnomAD, we were able to overcome the lack of features associated with rare benign variants in ClinVar. This inclusion of a more diverse dataset, encompassing rare benign variants, led to better generalization of the MAGPIE model. Ablation study also proves this crucial role of relevant cross-dataset working in improving model performance (Additional file <xref rid="MOESM2" ref-type="media">2</xref>: Fig. S2). In the ablation study, we find that removing the data from gnomAD in the training set has a significant impact on the performance of the MAGPIE model. Particularly in the pathogenicity prediction task for rare mutations, adding gnomAD mutations to the training set significantly increases the probability of correctly classifying rare benign mutations (Additional file <xref rid="MOESM2" ref-type="media">2</xref>: Fig. S2).</p>
    <p id="Par114">On the ClinVarTest dataset and the orthogonal datasets, our approach accurately classified multi-type variants, respectively, whereas most tools can only predict one or two types of variants. However, the total numbers of variants across variant types in the ClinVar dataset were different. Compared with the number of missense variants, other types of variants, such as stopgain, stoploss, and so on, had less number of records. Thus, the small sample size in these variant types might limit, to some extent, the performance of MAGPIE and cause some biases.</p>
    <p id="Par115">Many previous studies have demonstrated outstanding performance in accurately predicting pathogenic mutations and have paved the way for subsequent work. The design of MAGPIE draws inspiration from many previous work, such as utilizing the AUBPRC metric defined in VARITY to assess the performance of imbalanced datasets. However, we showed here that the state-of-the-art methods included missing value because their predictions are concentrated on one or several specific mutation types. In the clinical application for genetic diagnosis, these unpredictable variants would be filtered out and often be treated as non-pathogenic ones (Additional file <xref rid="MOESM2" ref-type="media">2</xref>: Fig. S11).</p>
    <p id="Par116">Detection of pathogenic variants using MAGPIE may suffer from several limitations. First, we evaluated the running time of our method and found that the annotation tools cost the most time in the MAGPIE pipeline since the running time of MAGPIE was limited by the necessary file I/O in annotation tools (Additional file <xref rid="MOESM2" ref-type="media">2</xref>: Fig. S11). Also, our approach does not address the influences of a combination of variants. Human diseases may be associated with multiple causative mutations. However, our method focuses on predicting the pathogenicity of a single variant. Another potential limitation is that this approach is designed to obtain information from genetic annotations without any phenotype-related annotations. Future methods development may consider features including phenotype-related annotations to build a more direct connection between diseases and genetic variants. Currently, the clinical work of genetic diagnosis rate is still limited. It was reported that using WES data, the genetic diagnosis rate can be up to 40%, suggesting a large space of improvement remains for practical clinical work. Several reasons lead to this result, one of which is that most of the human genome is non-coding, while most algorithms can only predict a subset of the coding region. Admittedly, computational predictions focusing on exonic mutations other than synonymous mutations like MAGPIE are necessary but still insufficient to address all the clinical diagnosis challenges. MAGPIE cannot provide reliable predictions for intronic and intergenic variants due to the scarcity of annotation information in existing databases and the lack of training sources. As we move forward, we will endeavor to acquire essential information about these types of mutations.</p>
  </sec>
  <sec id="Sec20">
    <title>Conclusions</title>
    <p id="Par117">In this study, we introduce a computational framework named MAGPIE, which generates pathogenicity scores for multi-type variants and simplifies pathogenicity classification for millions of candidate genomic variants. Moreover, MAGPIE is independent of any other pathogenic prediction tools, thereby avoiding introducing biases and circularity. Our approach yields superior performance and low missing rates for various types of exonic variants in both balanced and imbalanced datasets. Besides, MAGPIE also provided an accurate prediction of multi-type rare variants. Furthermore, MAGPIE performance remained robust, recovering known pathogenic variants across different Mendelian diseases. In conclusion, with improved prediction accuracy, MAGPIE provides a more accessible and accurate prediction of multi-type exonic variants for Mendelian disease studies.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <sec id="Sec21">
      <title>Supplementary Information</title>
      <p>
        <supplementary-material content-type="local-data" id="MOESM1">
          <media xlink:href="13073_2023_1274_MOESM1_ESM.xlsx">
            <caption>
              <p><bold>Additional file 1: Table S1.</bold> Category and proportion of variants in independent test set. <bold>Table S2.</bold> Category and proportion of variants in orthogonal validation set. <bold>Table S3.</bold> Category and proportion of variants in ACMG guided dataset. <bold>Table S4.</bold> Feature name and description. <bold>Table S5.</bold> Feature importance of MAGPIE. <bold>Table S6.</bold> Performance metrics in independent test set. <bold>Table S7.</bold> Performance metrics in orthogonal validation set. <bold>Table S8.</bold> Performance metrics in ACMG guided dataset.</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM2">
          <media xlink:href="13073_2023_1274_MOESM2_ESM.pdf">
            <caption>
              <p><bold>Additional file 2: Fig. S1.</bold> Web tool of MAGPIE. <bold>Fig. S2.</bold> Ablation study of MAGPIE. <bold>Fig. S3.</bold> Significance test on independent test set. <bold>Fig. S4.</bold> Performance of each variant type on orthogonal validation set. <bold>Fig. S5.</bold> Performance evaluation on ACMG guided dataset. <bold>Fig. S6.</bold> Performance of each variant type on ACMG guided dataset. <bold>Fig. S7.</bold> Threshold test of MAGPIE on independent test set when number of pathogenic variants is less than benign ones. <bold>Fig. S8.</bold> Threshold test of MAGPIE on orthogonal validation set when the number of pathogenic variants is less than benign. <bold>Fig. S9.</bold> Performance comparison before and after threshold adjustment according to FPR control. <bold>Fig. S10.</bold> MAGPIE running time. <bold>Fig. S11.</bold> Performance comparison in real-world diagnosis.</p>
            </caption>
          </media>
        </supplementary-material>
      </p>
    </sec>
  </sec>
</body>
<back>
  <glossary>
    <title>Abbreviations</title>
    <def-list>
      <def-item>
        <term>MAGPIE</term>
        <def>
          <p id="Par2">Multimodal Annotation Generated Pathogenic Impact Evaluator</p>
        </def>
      </def-item>
      <def-item>
        <term>ClinVar</term>
        <def>
          <p id="Par3">Clinical variation</p>
        </def>
      </def-item>
      <def-item>
        <term>AUC</term>
        <def>
          <p id="Par4">Area under curve</p>
        </def>
      </def-item>
      <def-item>
        <term>WGS</term>
        <def>
          <p id="Par5">Whole genome sequencing</p>
        </def>
      </def-item>
      <def-item>
        <term>WES</term>
        <def>
          <p id="Par6">Whole exome sequencing</p>
        </def>
      </def-item>
      <def-item>
        <term>gnomAD</term>
        <def>
          <p id="Par7">Genome Aggregation Database</p>
        </def>
      </def-item>
      <def-item>
        <term>ExAC</term>
        <def>
          <p id="Par8">Exome Aggregation Consortium</p>
        </def>
      </def-item>
      <def-item>
        <term>ML</term>
        <def>
          <p id="Par9">Machine learning</p>
        </def>
      </def-item>
      <def-item>
        <term>DL</term>
        <def>
          <p id="Par10">Deep learning</p>
        </def>
      </def-item>
      <def-item>
        <term>OMIM</term>
        <def>
          <p id="Par11">Online Mendelian Inheritance in Man</p>
        </def>
      </def-item>
      <def-item>
        <term>HGMD</term>
        <def>
          <p id="Par12">Human Gene Mutation Database</p>
        </def>
      </def-item>
      <def-item>
        <term>RNA</term>
        <def>
          <p id="Par13">Ribonucleic acid</p>
        </def>
      </def-item>
      <def-item>
        <term>SpliceAI</term>
        <def>
          <p id="Par14">Splice artificial intelligence</p>
        </def>
      </def-item>
      <def-item>
        <term>EVE</term>
        <def>
          <p id="Par15">Evolutionary model of variant effect</p>
        </def>
      </def-item>
      <def-item>
        <term>CADD</term>
        <def>
          <p id="Par16">Combined Annotation-Dependent Depletion</p>
        </def>
      </def-item>
      <def-item>
        <term>DANN</term>
        <def>
          <p id="Par17">Deleterious Annotation of Genetic Variants using Neural Networks</p>
        </def>
      </def-item>
      <def-item>
        <term>REVEL</term>
        <def>
          <p id="Par18">Rare Exome Variant Ensemble Learner</p>
        </def>
      </def-item>
      <def-item>
        <term>MutPred</term>
        <def>
          <p id="Par19">Mutation predictor</p>
        </def>
      </def-item>
      <def-item>
        <term>VEST</term>
        <def>
          <p id="Par20">Variant effect scoring tool</p>
        </def>
      </def-item>
      <def-item>
        <term>PROVEAN</term>
        <def>
          <p id="Par21">Protein Variation Effect Analyzer</p>
        </def>
      </def-item>
      <def-item>
        <term>PhastCons</term>
        <def>
          <p id="Par22">Phylogenetic Analysis with Space/Time Models for Conservation of Evolutionary Significant Sequences</p>
        </def>
      </def-item>
      <def-item>
        <term>GBM</term>
        <def>
          <p id="Par23">Gradient-boosting model</p>
        </def>
      </def-item>
      <def-item>
        <term>GOSS</term>
        <def>
          <p id="Par24">Gradient-based one-side sampling</p>
        </def>
      </def-item>
      <def-item>
        <term>EFB</term>
        <def>
          <p id="Par25">Exclusive feature bundling</p>
        </def>
      </def-item>
      <def-item>
        <term>GDI</term>
        <def>
          <p id="Par26">Gene damage index</p>
        </def>
      </def-item>
      <def-item>
        <term>LoF</term>
        <def>
          <p id="Par27">Loss of function</p>
        </def>
      </def-item>
      <def-item>
        <term>SIFT</term>
        <def>
          <p id="Par28">Sorting Intolerant From Tolerant</p>
        </def>
      </def-item>
      <def-item>
        <term>PolyPhen</term>
        <def>
          <p id="Par29">Polymorphism phenotyping</p>
        </def>
      </def-item>
      <def-item>
        <term>MetaSVM</term>
        <def>
          <p id="Par30">Meta-learner support vector machine</p>
        </def>
      </def-item>
      <def-item>
        <term>MetaLR</term>
        <def>
          <p id="Par31">Meta-logistic regression</p>
        </def>
      </def-item>
      <def-item>
        <term>ClinPred</term>
        <def>
          <p id="Par32">Clinical variant prediction</p>
        </def>
      </def-item>
      <def-item>
        <term>PrimateAI</term>
        <def>
          <p id="Par33">Primate artificial intelligence</p>
        </def>
      </def-item>
      <def-item>
        <term>LIST-S2</term>
        <def>
          <p id="Par34">Local Identity and Shared Taxa—S2</p>
        </def>
      </def-item>
      <def-item>
        <term>M-CAP</term>
        <def>
          <p id="Par35">Mendelian Clinically Applicable Pathogenicity</p>
        </def>
      </def-item>
      <def-item>
        <term>SIFT4G</term>
        <def>
          <p id="Par36">Sorting Intolerant From Tolerant for Genomes</p>
        </def>
      </def-item>
      <def-item>
        <term>SNV</term>
        <def>
          <p id="Par37">Single-nucleotide variant</p>
        </def>
      </def-item>
      <def-item>
        <term>AUPRC</term>
        <def>
          <p id="Par38">Area under the precision-recall curve</p>
        </def>
      </def-item>
      <def-item>
        <term>AUBPRC</term>
        <def>
          <p id="Par39">Area under the balanced precision-recall curve</p>
        </def>
      </def-item>
      <def-item>
        <term>MCC</term>
        <def>
          <p id="Par40">Matthews correlation coefficient</p>
        </def>
      </def-item>
      <def-item>
        <term>GWAS</term>
        <def>
          <p id="Par41">Genome-wide association study</p>
        </def>
      </def-item>
      <def-item>
        <term>ANNOVAR</term>
        <def>
          <p id="Par42">Annotation of variants from next-generation sequencing data using a reference genome</p>
        </def>
      </def-item>
      <def-item>
        <term>RVIS</term>
        <def>
          <p id="Par43">Residual variation intolerance score</p>
        </def>
      </def-item>
      <def-item>
        <term>LoFtool</term>
        <def>
          <p id="Par44">Loss of function tool</p>
        </def>
      </def-item>
      <def-item>
        <term>DS</term>
        <def>
          <p id="Par45">Delta score</p>
        </def>
      </def-item>
      <def-item>
        <term>AG</term>
        <def>
          <p id="Par46">Acceptor gain</p>
        </def>
      </def-item>
      <def-item>
        <term>AL</term>
        <def>
          <p id="Par47">Acceptor loss</p>
        </def>
      </def-item>
      <def-item>
        <term>DG</term>
        <def>
          <p id="Par48">Donor gain</p>
        </def>
      </def-item>
      <def-item>
        <term>DL</term>
        <def>
          <p id="Par49">Donor loss</p>
        </def>
      </def-item>
      <def-item>
        <term>DP</term>
        <def>
          <p id="Par50">Delta position</p>
        </def>
      </def-item>
      <def-item>
        <term>AF</term>
        <def>
          <p id="Par51">Allele frequency</p>
        </def>
      </def-item>
      <def-item>
        <term>phyloP</term>
        <def>
          <p id="Par52">Phylogenetic <italic>P</italic>-values</p>
        </def>
      </def-item>
      <def-item>
        <term>SiPhy</term>
        <def>
          <p id="Par53">SIte-specific PHYlogenetic analysis</p>
        </def>
      </def-item>
      <def-item>
        <term>AutoFE</term>
        <def>
          <p id="Par54">Automatic feature engineering</p>
        </def>
      </def-item>
      <def-item>
        <term>SFS</term>
        <def>
          <p id="Par55">Separated feature selection</p>
        </def>
      </def-item>
      <def-item>
        <term>ROC</term>
        <def>
          <p id="Par56">Receiver operating characteristic</p>
        </def>
      </def-item>
    </def-list>
  </glossary>
  <fn-group>
    <fn>
      <p>This article has been updated to amend affiliations 1 &amp; 2 and the funding section.</p>
    </fn>
    <fn>
      <p>
        <bold>Publisher’s Note</bold>
      </p>
      <p>Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p>
    </fn>
    <fn>
      <p>Yicheng Liu and Tianyun Zhang contributed equally to this work.</p>
    </fn>
    <fn>
      <p>
        <bold>Change history</bold>
      </p>
      <p>5/14/2024</p>
      <p>A Correction to this paper has been published: 10.1186/s13073-024-01343-2</p>
    </fn>
  </fn-group>
  <ack>
    <title>Acknowledgements</title>
    <p>We thank Jinzhao Liang, Xiaoyang Zhao, and Hanying Jia for providing important suggestions on data analysis. We thank Dandan Hu, Lin Lv, Asif Ashan, Hanying Jia, Xilu Yuan, and Yuxin Gu for providing helpful suggestions for manuscript. We thank Dr. Shanshan Pei for helping us come up with the name of the tool. We are also thankful for the Core Facilities of Liangzhu Laboratory.</p>
  </ack>
  <notes notes-type="author-contribution">
    <title>Authors’ contributions</title>
    <p>N.S. conceived the project. N.S., S.W., and Y.L. designed the experiment. Y.L. processed the data and performed the experiments. N.S., Y.L., and T.Z. devised the data analysis. N.S. and S.W. supervised the study. N.Y. and Y.L. built the MAGPIE tool website. T.Z., N.S., Y.L. S.W. wrote the manuscript. All authors read and approved the final manuscript.</p>
  </notes>
  <notes notes-type="funding-information">
    <title>Funding</title>
    <p>This work was supported by the Key R&amp;D Program of Zhejiang (No.2024SSYS0022), the Leading Innovative and Entrepreneur Team Introduction Program of Zhejiang (No. 2021R01012).</p>
  </notes>
  <notes notes-type="data-availability">
    <title>Availability of data and materials</title>
    <p>Datasets generated and/or analyzed during the current study are publicly available in the ClinVar (<ext-link ext-link-type="uri" xlink:href="https://ftp.ncbi.nlm.nih.gov/pub/clinvar/">https://ftp.ncbi.nlm.nih.gov/pub/clinvar/</ext-link>) [<xref ref-type="bibr" rid="CR4">4</xref>], SwissProt (<ext-link ext-link-type="uri" xlink:href="https://ftp.uniprot.org/pub/databases/uniprot/">https://ftp.uniprot.org/pub/databases/uniprot/</ext-link>) [<xref ref-type="bibr" rid="CR40">40</xref>], gnomAD (<ext-link ext-link-type="uri" xlink:href="https://gnomad.broadinstitute.org/downloads/">https://gnomad.broadinstitute.org/downloads/</ext-link>) [<xref ref-type="bibr" rid="CR1">1</xref>], and ACMG guided dataset (10.1016/j.gim.2021.11.018) [<xref ref-type="bibr" rid="CR41">41</xref>]. The datasets supporting the conclusions of this article are included within the article and its additional files. MAGPIE web-based prediction tool for all nonsynonymous exonic variants is available at <ext-link ext-link-type="uri" xlink:href="http://tools.shenlab-genomics.org/tools/MAGPIE">http://tools.shenlab-genomics.org/tools/MAGPIE</ext-link>.</p>
  </notes>
  <notes>
    <title>Declarations</title>
    <notes id="FPar1">
      <title>Ethics approval and consent to participate</title>
      <p id="Par118">Not applicable.</p>
    </notes>
    <notes id="FPar2">
      <title>Consent for publication</title>
      <p id="Par119">Not applicable.</p>
    </notes>
    <notes id="FPar3" notes-type="COI-statement">
      <title>Competing interests</title>
      <p id="Par120">The authors have submitted a patent application for the method. Other than this, the authors declare that they do not have any competing interests.</p>
    </notes>
  </notes>
  <ref-list id="Bib1">
    <title>References</title>
    <ref id="CR1">
      <label>1.</label>
      <mixed-citation publication-type="other">Karczewski KJ, Francioli LC, Tiao G, Cummings BB, Alfoldi J, Wang Q, ... MacArthur DG. The mutational constraint spectrum quantified from variation in 141,456 humans. Nature. 2020;581(7809):434–443.</mixed-citation>
    </ref>
    <ref id="CR2">
      <label>2.</label>
      <mixed-citation publication-type="other">Lek M, Karczewski KJ, Minikel EV, Samocha KE, Banks E, Fennell T, ... Exome Aggregation Consortium. Analysis of protein-coding genetic variation in 60,706 humans. Nature. 2016;536(7616):285-291</mixed-citation>
    </ref>
    <ref id="CR3">
      <label>3.</label>
      <mixed-citation publication-type="other">Cao Y, Li L, Xu M, Feng Z, Sun X, Lu J, ... Wang W. The ChinaMAP analytics of deep whole genome sequences in 10,588 individuals. Cell Res. 2020;30(9):717–731.</mixed-citation>
    </ref>
    <ref id="CR4">
      <label>4.</label>
      <mixed-citation publication-type="other">Landrum MJ, Lee JM, Benson M, Brown G, Chao C, Chitipiralla S, ... Maglott DR. ClinVar: public archive of interpretations of clinically relevant variants. Nucleic Acids Res. 2016;44(D1), D862-D868.</mixed-citation>
    </ref>
    <ref id="CR5">
      <label>5.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Amberger</surname>
            <given-names>JS</given-names>
          </name>
          <name>
            <surname>Bocchini</surname>
            <given-names>CA</given-names>
          </name>
          <name>
            <surname>Schiettecatte</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Scott</surname>
            <given-names>AF</given-names>
          </name>
          <name>
            <surname>Hamosh</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>OMIM. org: Online Mendelian Inheritance in Man (OMIM®), an online catalog of human genes and genetic disorders</article-title>
        <source>Nucleic Acids Res.</source>
        <year>2015</year>
        <volume>43</volume>
        <issue>D1</issue>
        <fpage>D789</fpage>
        <lpage>D798</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/gku1205</pub-id>
        <?supplied-pmid 25428349?>
        <pub-id pub-id-type="pmid">25428349</pub-id>
      </element-citation>
    </ref>
    <ref id="CR6">
      <label>6.</label>
      <mixed-citation publication-type="other">Stenson PD, Mort M, Ball EV, Evans K, Hayden M, Heywood S, ... Cooper DN. The Human Gene Mutation Database: towards a comprehensive repository of inherited mutation data for medical research, genetic diagnosis and next-generation sequencing studies. Hum Genet. 2017;136:665–677.</mixed-citation>
    </ref>
    <ref id="CR7">
      <label>7.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ng</surname>
            <given-names>PC</given-names>
          </name>
          <name>
            <surname>Henikoff</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>SIFT: predicting amino acid changes that affect protein function</article-title>
        <source>Nucleic Acids Res</source>
        <year>2003</year>
        <volume>31</volume>
        <issue>13</issue>
        <fpage>3812</fpage>
        <lpage>3814</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/gkg509</pub-id>
        <?supplied-pmid 12824425?>
        <pub-id pub-id-type="pmid">12824425</pub-id>
      </element-citation>
    </ref>
    <ref id="CR8">
      <label>8.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Adzhubei</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Jordan</surname>
            <given-names>DM</given-names>
          </name>
          <name>
            <surname>Sunyaev</surname>
            <given-names>SR</given-names>
          </name>
        </person-group>
        <article-title>Predicting functional effect of human missense mutations using PolyPhen-2</article-title>
        <source>Curr Protoc Hum Genet</source>
        <year>2013</year>
        <volume>76</volume>
        <issue>1</issue>
        <fpage>7</fpage>
        <lpage>20</lpage>
      </element-citation>
    </ref>
    <ref id="CR9">
      <label>9.</label>
      <mixed-citation publication-type="other">Choi Y, Sims GE, Murphy S, Miller JR, Chan AP. Predicting the functional effect of amino acid substitutions and indels. 2012.</mixed-citation>
    </ref>
    <ref id="CR10">
      <label>10.</label>
      <mixed-citation publication-type="other">Li B, Krishnan VG, Mort ME, Xin F, Kamati KK, Cooper DN, ... Radivojac P. Automated inference of molecular mechanisms of disease from amino acid substitutions. Bioinformatics. 2009;25(21):2744–2750.</mixed-citation>
    </ref>
    <ref id="CR11">
      <label>11.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Reva</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Antipin</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Sander</surname>
            <given-names>C</given-names>
          </name>
        </person-group>
        <article-title>Predicting the functional impact of protein mutations: application to cancer genomics</article-title>
        <source>Nucleic Acids Res</source>
        <year>2011</year>
        <volume>39</volume>
        <issue>17</issue>
        <fpage>e118</fpage>
        <lpage>e118</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/gkr407</pub-id>
        <?supplied-pmid 21727090?>
        <pub-id pub-id-type="pmid">21727090</pub-id>
      </element-citation>
    </ref>
    <ref id="CR12">
      <label>12.</label>
      <mixed-citation publication-type="other">Shihab HA, Rogers MF, Gough J, Mort M, Cooper DN, Day IN, ... Campbell C. An integrative approach to predicting the functional effects of non-coding and coding sequence variation. Bioinformatics. 2015;31(10):1536–1543.</mixed-citation>
    </ref>
    <ref id="CR13">
      <label>13.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Dong</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Wei</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Jian</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Gibbs</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Boerwinkle</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Liu</surname>
            <given-names>X</given-names>
          </name>
        </person-group>
        <article-title>Comparison and integration of deleteriousness prediction methods for nonsynonymous SNVs in whole exome sequencing studies</article-title>
        <source>Hum Mol Genet</source>
        <year>2015</year>
        <volume>24</volume>
        <issue>8</issue>
        <fpage>2125</fpage>
        <lpage>2137</lpage>
        <pub-id pub-id-type="doi">10.1093/hmg/ddu733</pub-id>
        <?supplied-pmid 25552646?>
        <pub-id pub-id-type="pmid">25552646</pub-id>
      </element-citation>
    </ref>
    <ref id="CR14">
      <label>14.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Carter</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Douville</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Stenson</surname>
            <given-names>PD</given-names>
          </name>
          <name>
            <surname>Cooper</surname>
            <given-names>DN</given-names>
          </name>
          <name>
            <surname>Karchin</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>Identifying Mendelian disease genes with the variant effect scoring tool</article-title>
        <source>BMC Genomics</source>
        <year>2013</year>
        <volume>14</volume>
        <issue>3</issue>
        <fpage>1</fpage>
        <lpage>16</lpage>
        <pub-id pub-id-type="pmid">23323973</pub-id>
      </element-citation>
    </ref>
    <ref id="CR15">
      <label>15.</label>
      <mixed-citation publication-type="other">Frazer J, Notin P, Dias M, Gomez A, Min JK, Brock K, ... Marks DS. Disease variant prediction with deep generative models of evolutionary data. Nature. 2021;599(7883):91–95.</mixed-citation>
    </ref>
    <ref id="CR16">
      <label>16.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wu</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Liu</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Sun</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Weile</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Roth</surname>
            <given-names>FP</given-names>
          </name>
        </person-group>
        <article-title>Improved pathogenicity prediction for rare human missense variants</article-title>
        <source>Am J Hum Genet</source>
        <year>2021</year>
        <volume>108</volume>
        <issue>10</issue>
        <fpage>1891</fpage>
        <lpage>1906</lpage>
        <pub-id pub-id-type="doi">10.1016/j.ajhg.2021.08.012</pub-id>
        <?supplied-pmid 34551312?>
        <pub-id pub-id-type="pmid">34551312</pub-id>
      </element-citation>
    </ref>
    <ref id="CR17">
      <label>17.</label>
      <mixed-citation publication-type="other">Ioannidis NM, Rothstein JH, Pejaver V, Middha S, McDonnell SK, Baheti S, ... Sieh W. REVEL: an ensemble method for predicting the pathogenicity of rare missense variants. Am J Hum Genet. 2016;99(4):877–885.</mixed-citation>
    </ref>
    <ref id="CR18">
      <label>18.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Cheng</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Nguyen</surname>
            <given-names>TYD</given-names>
          </name>
          <name>
            <surname>Cygan</surname>
            <given-names>KJ</given-names>
          </name>
          <name>
            <surname>Çelik</surname>
            <given-names>MH</given-names>
          </name>
          <name>
            <surname>Fairbrother</surname>
            <given-names>WG</given-names>
          </name>
          <name>
            <surname>Gagneur</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>MMSplice: modular modeling improves the predictions of genetic variant effects on splicing</article-title>
        <source>Genome Biol</source>
        <year>2019</year>
        <volume>20</volume>
        <issue>1</issue>
        <fpage>1</fpage>
        <lpage>15</lpage>
        <pub-id pub-id-type="doi">10.1186/s13059-019-1653-z</pub-id>
        <pub-id pub-id-type="pmid">30606230</pub-id>
      </element-citation>
    </ref>
    <ref id="CR19">
      <label>19.</label>
      <mixed-citation publication-type="other">Jaganathan K, Panagiotopoulou SK, McRae JF, Darbandi SF, Knowles D, Li YI, ... Farh KKH. Predicting splicing from primary sequence with deep learning. Cell. 2019;176(3):535–548.</mixed-citation>
    </ref>
    <ref id="CR20">
      <label>20.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Rentzsch</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Witten</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Cooper</surname>
            <given-names>GM</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>CADD: predicting the deleteriousness of variants throughout the human genome</article-title>
        <source>Nucleic Acids Res</source>
        <year>2019</year>
        <volume>47</volume>
        <issue>D1</issue>
        <fpage>D886</fpage>
        <lpage>D894</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/gky1016</pub-id>
        <?supplied-pmid 30371827?>
        <pub-id pub-id-type="pmid">30371827</pub-id>
      </element-citation>
    </ref>
    <ref id="CR21">
      <label>21.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Quang</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Xie</surname>
            <given-names>X</given-names>
          </name>
        </person-group>
        <article-title>DANN: a deep learning approach for annotating the pathogenicity of genetic variants</article-title>
        <source>Bioinformatics</source>
        <year>2015</year>
        <volume>31</volume>
        <issue>5</issue>
        <fpage>761</fpage>
        <lpage>763</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btu703</pub-id>
        <?supplied-pmid 25338716?>
        <pub-id pub-id-type="pmid">25338716</pub-id>
      </element-citation>
    </ref>
    <ref id="CR22">
      <label>22.</label>
      <mixed-citation publication-type="other">Pejaver V, Urresti J, Lugo-Martinez J, Pagel KA, Lin GN, Nam HJ, ... Radivojac P. Inferring the molecular and phenotypic impact of amino acid variants with MutPred2. Nat Commun. 2020;11(1):5918.</mixed-citation>
    </ref>
    <ref id="CR23">
      <label>23.</label>
      <mixed-citation publication-type="other">Siepel A, Bejerano G, Pedersen JS, Hinrichs AS, Hou M, Rosenbloom K, ... Haussler D. Evolutionarily conserved elements in vertebrate, insect, worm, and yeast genomes. Genome Res. 2005;15(8):1034–1050.</mixed-citation>
    </ref>
    <ref id="CR24">
      <label>24.</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Van Rossum</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Drake</surname>
            <given-names>FL</given-names>
          </name>
        </person-group>
        <source>Python reference manual (Vol. 111)</source>
        <year>1995</year>
        <publisher-loc>Amsterdam</publisher-loc>
        <publisher-name>Centrum voor Wiskunde en Informatica</publisher-name>
        <fpage>1</fpage>
        <lpage>52</lpage>
      </element-citation>
    </ref>
    <ref id="CR25">
      <label>25.</label>
      <mixed-citation publication-type="other">The MathWorks Inc. MATLAB version: 9.13.0 (R2022b), Natick, Massachusetts: The MathWorks Inc; 2022. <ext-link ext-link-type="uri" xlink:href="https://www.mathworks.com">https://www.mathworks.com</ext-link>.</mixed-citation>
    </ref>
    <ref id="CR26">
      <label>26.</label>
      <mixed-citation publication-type="other">Pedregosa F, Varoquaux G, Gramfort A, Michel V, Thirion B, Grisel O, ... Duchesnay É. Scikit-learn: machine learning in Python. J Mach Learn Res. 2011;12:2825–2830.</mixed-citation>
    </ref>
    <ref id="CR27">
      <label>27.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wang</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Hakonarson</surname>
            <given-names>H</given-names>
          </name>
        </person-group>
        <article-title>ANNOVAR: functional annotation of genetic variants from high-throughput sequencing data</article-title>
        <source>Nucleic Acids Res</source>
        <year>2010</year>
        <volume>38</volume>
        <issue>16</issue>
        <fpage>e164</fpage>
        <lpage>e164</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/gkq603</pub-id>
        <?supplied-pmid 20601685?>
        <pub-id pub-id-type="pmid">20601685</pub-id>
      </element-citation>
    </ref>
    <ref id="CR28">
      <label>28.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ernst</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Kellis</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>ChromHMM: automating chromatin-state discovery and characterization</article-title>
        <source>Nat Methods</source>
        <year>2012</year>
        <volume>9</volume>
        <issue>3</issue>
        <fpage>215</fpage>
        <lpage>216</lpage>
        <pub-id pub-id-type="doi">10.1038/nmeth.1906</pub-id>
        <?supplied-pmid 22373907?>
        <pub-id pub-id-type="pmid">22373907</pub-id>
      </element-citation>
    </ref>
    <ref id="CR29">
      <label>29.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Nounou</surname>
            <given-names>MN</given-names>
          </name>
          <name>
            <surname>Bakshi</surname>
            <given-names>BR</given-names>
          </name>
          <name>
            <surname>Goel</surname>
            <given-names>PK</given-names>
          </name>
          <name>
            <surname>Shen</surname>
            <given-names>X</given-names>
          </name>
        </person-group>
        <article-title>Bayesian principal component analysis</article-title>
        <source>J Chemom</source>
        <year>2002</year>
        <volume>16</volume>
        <issue>11</issue>
        <fpage>576</fpage>
        <lpage>595</lpage>
        <pub-id pub-id-type="doi">10.1002/cem.759</pub-id>
      </element-citation>
    </ref>
    <ref id="CR30">
      <label>30.</label>
      <mixed-citation publication-type="other">Zhang T, Zhang Z, Fan Z, Luo H, Liu F, Cao W, Li J. OpenFE: automated feature generation beyond expert-level performance. 2022. arXiv preprint <ext-link ext-link-type="uri" xlink:href="http://arxiv.org/abs/2211.12507">arXiv:2211.12507</ext-link>.</mixed-citation>
    </ref>
    <ref id="CR31">
      <label>31.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Alirezaie</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Kernohan</surname>
            <given-names>KD</given-names>
          </name>
          <name>
            <surname>Hartley</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Majewski</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Hocking</surname>
            <given-names>TD</given-names>
          </name>
        </person-group>
        <article-title>ClinPred: prediction tool to identify disease-relevant nonsynonymous single-nucleotide variants</article-title>
        <source>Am J Hum Genet</source>
        <year>2018</year>
        <volume>103</volume>
        <issue>4</issue>
        <fpage>474</fpage>
        <lpage>483</lpage>
        <pub-id pub-id-type="doi">10.1016/j.ajhg.2018.08.005</pub-id>
        <?supplied-pmid 30220433?>
        <pub-id pub-id-type="pmid">30220433</pub-id>
      </element-citation>
    </ref>
    <ref id="CR32">
      <label>32.</label>
      <mixed-citation publication-type="other">Jagadeesh KA, Wenger AM, Berger MJ, Guturu H, Stenson PD, Cooper DN, ... Bejerano G. M-CAP eliminates a majority of variants of uncertain significance in clinical exomes at high sensitivity. Nat Genet. 2016;48(12):1581–1586.</mixed-citation>
    </ref>
    <ref id="CR33">
      <label>33.</label>
      <mixed-citation publication-type="other">Sundaram L, Gao H, Padigepati SR, McRae JF, Li Y, Kosmicki JA, ... Farh KKH. Predicting the clinical impact of human mutation with deep neural networks. Nat Genet. 2018;50(8):1161–1170.</mixed-citation>
    </ref>
    <ref id="CR34">
      <label>34.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Vaser</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Adusumalli</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Leng</surname>
            <given-names>SN</given-names>
          </name>
          <name>
            <surname>Sikic</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Ng</surname>
            <given-names>PC</given-names>
          </name>
        </person-group>
        <article-title>SIFT missense predictions for genomes</article-title>
        <source>Nat Protoc</source>
        <year>2016</year>
        <volume>11</volume>
        <issue>1</issue>
        <fpage>1</fpage>
        <lpage>9</lpage>
        <pub-id pub-id-type="doi">10.1038/nprot.2015.123</pub-id>
        <?supplied-pmid 26633127?>
        <pub-id pub-id-type="pmid">26633127</pub-id>
      </element-citation>
    </ref>
    <ref id="CR35">
      <label>35.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Malhis</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Jacobson</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Jones</surname>
            <given-names>SJ</given-names>
          </name>
          <name>
            <surname>Gsponer</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>LIST-S2: taxonomy based sorting of deleterious missense mutations across species</article-title>
        <source>Nucleic Acids Res</source>
        <year>2020</year>
        <volume>48</volume>
        <issue>W1</issue>
        <fpage>W154</fpage>
        <lpage>W161</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/gkaa288</pub-id>
        <?supplied-pmid 32352516?>
        <pub-id pub-id-type="pmid">32352516</pub-id>
      </element-citation>
    </ref>
    <ref id="CR36">
      <label>36.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Schwarz</surname>
            <given-names>JM</given-names>
          </name>
          <name>
            <surname>Cooper</surname>
            <given-names>DN</given-names>
          </name>
          <name>
            <surname>Schuelke</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Seelow</surname>
            <given-names>D</given-names>
          </name>
        </person-group>
        <article-title>MutationTaster2: mutation prediction for the deep-sequencing age</article-title>
        <source>Nat Methods</source>
        <year>2014</year>
        <volume>11</volume>
        <issue>4</issue>
        <fpage>361</fpage>
        <lpage>362</lpage>
        <pub-id pub-id-type="doi">10.1038/nmeth.2890</pub-id>
        <?supplied-pmid 24681721?>
        <pub-id pub-id-type="pmid">24681721</pub-id>
      </element-citation>
    </ref>
    <ref id="CR37">
      <label>37.</label>
      <mixed-citation publication-type="other">Ke G, Meng Q, Finley T, Wang T, Chen W, Ma W, ... Liu TY. LightGBM: a highly efficient gradient boosting decision tree. Adv Neural Inform Process Syst. 2017;30.</mixed-citation>
    </ref>
    <ref id="CR38">
      <label>38.</label>
      <mixed-citation publication-type="other">Itan Y, Shang L, Boisson B, Patin E, Bolze A, Moncada-Vélez M, ... Casanova JL. The human gene damage index as a gene-level approach to prioritizing exome variants. Proc Natl Acad Sci. 2015;112(44):13615–13620.</mixed-citation>
    </ref>
    <ref id="CR39">
      <label>39.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Dietz</surname>
            <given-names>HC</given-names>
          </name>
          <name>
            <surname>Pyeritz</surname>
            <given-names>RE</given-names>
          </name>
        </person-group>
        <article-title>Mutations in the human gene for fibrillin-1 (FBN1) in the Marfan syndrome and related disorders</article-title>
        <source>Hum Mol Genet</source>
        <year>1995</year>
        <volume>4</volume>
        <issue>suppl_1</issue>
        <fpage>1799</fpage>
        <lpage>1809</lpage>
        <pub-id pub-id-type="doi">10.1093/hmg/4.suppl_1.1799</pub-id>
        <?supplied-pmid 8541880?>
        <pub-id pub-id-type="pmid">8541880</pub-id>
      </element-citation>
    </ref>
    <ref id="CR40">
      <label>40.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bairoch</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Apweiler</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>The SWISS-PROT protein sequence database and its supplement TrEMBL in 2000</article-title>
        <source>Nucleic Acids Res</source>
        <year>2000</year>
        <volume>28</volume>
        <issue>1</issue>
        <fpage>45</fpage>
        <lpage>48</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/28.1.45</pub-id>
        <?supplied-pmid 10592178?>
        <pub-id pub-id-type="pmid">10592178</pub-id>
      </element-citation>
    </ref>
    <ref id="CR41">
      <label>41.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wilcox</surname>
            <given-names>EH</given-names>
          </name>
          <name>
            <surname>Sarmady</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Wulf</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Wright</surname>
            <given-names>MW</given-names>
          </name>
          <name>
            <surname>Rehm</surname>
            <given-names>HL</given-names>
          </name>
          <name>
            <surname>Biesecker</surname>
            <given-names>LG</given-names>
          </name>
          <name>
            <surname>Abou Tayoun</surname>
            <given-names>AN</given-names>
          </name>
        </person-group>
        <article-title>Evaluating the impact of in silico predictors on clinical variant classification</article-title>
        <source>Genet Med</source>
        <year>2022</year>
        <volume>24</volume>
        <issue>4</issue>
        <fpage>924</fpage>
        <lpage>930</lpage>
        <pub-id pub-id-type="doi">10.1016/j.gim.2021.11.018</pub-id>
        <?supplied-pmid 34955381?>
        <pub-id pub-id-type="pmid">34955381</pub-id>
      </element-citation>
    </ref>
  </ref-list>
</back>
